VERSION A02

PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* NTB, MCR=NO, PLM=3, CTI=6, IND=4, MCI, SDI=6, DCI=4, ENU=0, ECU=0 , CCC */
        7        7        /*M* TEST ROUTINE FOR TCP */
        8        8        FTPUSER: PROC MAIN ALTRET;
        9        9        %INCLUDE CP_6;
       10       90        %INCLUDE NK_VFC_C;
       11      164        %INCLUDE TCP_HEP_M;
       12      219        %INCLUDE TCP_HEP_E;
       13      296        %INCLUDE TCT_TELNET_E;
       14      351        %INCLUDE XSL_SOCKET_M;
       15     1112            %XSL_SOCKINIT( FPTN=TCF_SOCKINIT, STCLASS="CONSTANT SYMDEF",
       16     1113                MAXSOCK=3, NWSOCKS=1, MAXRDS=3, MAXBUF=0, BUFSIZE=4096);
       17     1236
       18     1237        %TCP$SOCKET (NAME=CMD_FS, STCLASS="STATIC SYMDEF");
       19     1245        %TCP$SOCKET (NAME=CMD_LS, STCLASS="STATIC SYMDEF");
       20     1253
       21     1254    1   DCL CMD_LCN SBIN(36) STATIC SYMDEF INIT(-1);
       22     1255    1   DCL DATA_LCN UBIN(36) STATIC SYMDEF;
       23     1256    1   DCL CMD_BUFFER CHAR(4100) STATIC SYMDEF;
       24     1257    1   DCL 1 B_VERSION SYMREF,
       25     1258    1             2 L UBIN(9) UNAL,
       26     1259    1             2 T CHAR(B_VERSION.L);
       27     1260    1   DCL M$LO DCB;
       28     1261    1   DCL M$DO DCB;
       29     1262    1   DCL LINK_UP BIT(1) STATIC SYMDEF  INIT('0'B);
       30     1263    1   DCL MSG_HELLO CHAR(0) CONSTANT INIT('CP-6 FTP Version ');
       31     1264    1   DCL FTPCMD ENTRY ALTRET;
       32     1265    1   DCL FTPCMD_INIT ENTRY ALTRET;
       33     1266    1   DCL XSL$SOCKINIT ENTRY(1) ALTRET;
       34     1267
       35     1268    1   DCL ADDR_BUF CHAR(60);
       36     1269
       37     1270
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:2    
       38     1271        %FPT_DEVICE (STCLASS=CONSTANT, DCB=M$LO, DVFC=%VFC_TRANSITION1);
       39     1289        %FPT_WRITE (FPTN=WRITE_LO, STCLASS=STATIC SYMDEF, TRANS=YES,
       40     1290                DCB=M$LO);
       41     1321
       42     1322
       43     1323    1   DCL RUNNING BIT(1) STATIC SYMDEF INIT('1'B);
       44     1324
       45     1325    1      CALL XSL$SOCKINIT( TCF_SOCKINIT);
       46     1326    2      CALL FTPCMD_INIT WHENALTRETURN DO;
       47     1327    2          CALL M$XXX;
       48     1328    2          END;
       49     1329    1      CALL INSERT(CMD_BUFFER,0,SIZEC(MSG_HELLO)+10,MSG_HELLO,B_VERSION.T);
       50     1330    1      WRITE_LO.BUF_=VECTOR(SUBSTR(CMD_BUFFER,0,SIZEC(MSG_HELLO)+B_VERSION.L));
       51     1331    1      CALL M$WRITE (WRITE_LO);
       52     1332    1      CALL M$DEVICE (FPT_DEVICE);
       53     1333
       54     1334    2      DO WHILE (RUNNING);
       55     1335    2          CALL FTPCMD;
       56     1336    2          END;
       57     1337
       58     1338    1      RETURN;
       59     1339    1   END FTPUSER;
       60     1340        %EOD;

PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:3    
--  Include file information  --

   XSL_SOCKET_M.:TCA2TOU  is referenced.
   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   NK_VFC_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FTPUSER.

   Procedure FTPUSER requires 43 words for executable code.
   Procedure FTPUSER requires 18 words of local(AUTO) storage.

PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:4    

 Object Unit name= FTPUSER                                    File name= TCF$FTP.:TCA2TOU
 UTS= NOV 16 '97 14:09:37.40 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     22     26  FTPUSER
    2   Data  even  none  1045   2025  FTPUSER
    3   DCB   even  none     0      0  M$LO
    4   DCB   even  none     0      0  M$DO
    5   Proc  even  none    43     53  FTPUSER
    6  RoData even  none     2      2  FTPUSER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Main       0  FTPUSER

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  TCF_SOCKINIT                       2      0  CMD_FS
    2      2  CMD_LS                             2      4  CMD_LCN
    2      5  DATA_LCN                           2      6  CMD_BUFFER
    2   2007  LINK_UP                            2   2010  WRITE_LO
    2   2024  RUNNING
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:5    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 XSL$SOCKINIT
 yes     yes           Std       0 FTPCMD
 yes     yes           Std       0 FTPCMD_INIT
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VERSION                             M$LO
     M$DO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:6    


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /*X* NTB, MCR=NO, PLM=3, CTI=6, IND=4, MCI, SDI=6, DCI=4, ENU=0, ECU=0 , CCC */
        7        7        /*M* TEST ROUTINE FOR TCP */
        8        8        FTPUSER: PROC MAIN ALTRET;

      8  5 000000   000000 700200 xent  FTPUSER      TSX0  ! X66_MAUTO
         5 000001   000022 000000                    ZERO    18,0

        9        9        %INCLUDE CP_6;
       10       90        %INCLUDE NK_VFC_C;
       11      164        %INCLUDE TCP_HEP_M;
       12      219        %INCLUDE TCP_HEP_E;
       13      296        %INCLUDE TCT_TELNET_E;
       14      351        %INCLUDE XSL_SOCKET_M;
       15     1112            %XSL_SOCKINIT( FPTN=TCF_SOCKINIT, STCLASS="CONSTANT SYMDEF",
       16     1113                MAXSOCK=3, NWSOCKS=1, MAXRDS=3, MAXBUF=0, BUFSIZE=4096);
       17     1236
       18     1237        %TCP$SOCKET (NAME=CMD_FS, STCLASS="STATIC SYMDEF");
       19     1245        %TCP$SOCKET (NAME=CMD_LS, STCLASS="STATIC SYMDEF");
       20     1253
       21     1254    1   DCL CMD_LCN SBIN(36) STATIC SYMDEF INIT(-1);
       22     1255    1   DCL DATA_LCN UBIN(36) STATIC SYMDEF;
       23     1256    1   DCL CMD_BUFFER CHAR(4100) STATIC SYMDEF;
       24     1257    1   DCL 1 B_VERSION SYMREF,
       25     1258    1             2 L UBIN(9) UNAL,
       26     1259    1             2 T CHAR(B_VERSION.L);
       27     1260    1   DCL M$LO DCB;
       28     1261    1   DCL M$DO DCB;
       29     1262    1   DCL LINK_UP BIT(1) STATIC SYMDEF  INIT('0'B);
       30     1263    1   DCL MSG_HELLO CHAR(0) CONSTANT INIT('CP-6 FTP Version ');
       31     1264    1   DCL FTPCMD ENTRY ALTRET;
       32     1265    1   DCL FTPCMD_INIT ENTRY ALTRET;
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:7    
       33     1266    1   DCL XSL$SOCKINIT ENTRY(1) ALTRET;
       34     1267
       35     1268    1   DCL ADDR_BUF CHAR(60);
       36     1269
       37     1270
       38     1271        %FPT_DEVICE (STCLASS=CONSTANT, DCB=M$LO, DVFC=%VFC_TRANSITION1);
       39     1289        %FPT_WRITE (FPTN=WRITE_LO, STCLASS=STATIC SYMDEF, TRANS=YES,
       40     1290                DCB=M$LO);
       41     1321
       42     1322
       43     1323    1   DCL RUNNING BIT(1) STATIC SYMDEF INIT('1'B);
       44     1324
       45     1325    1      CALL XSL$SOCKINIT( TCF_SOCKINIT);

   1325  5 000002   000000 630400 6                  EPPR0   0
         5 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000004   000000 701000 xent               TSX1    XSL$SOCKINIT
         5 000005   000000 011000                    NOP     0

       46     1326    2      CALL FTPCMD_INIT WHENALTRETURN DO;

   1326  5 000006   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000007   000000 701000 xent               TSX1    FTPCMD_INIT
         5 000010   000012 702000 5                  TSX2    s:1327
         5 000011   000014 710000 5                  TRA     s:1329

       47     1327    2          CALL M$XXX;

   1327  5 000012   000003 713400                    CLIMB   3
         5 000013   000000 401760                    pmme    nvectors=0

       48     1328    2          END;

       49     1329    1      CALL INSERT(CMD_BUFFER,0,SIZEC(MSG_HELLO)+10,MSG_HELLO,B_VERSION.T);

   1329  5 000014   000000 236000 xsym               LDQ     B_VERSION
         5 000015   000033 772000                    QRL     27
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:8    
         5 000016   040000 100400                    MLR     fill='040'O
         5 000017   000006 000021 1                  ADSC9   MSG_HELLO                cn=0,n=17
         5 000020   000006 000021 2                  ADSC9   CMD_BUFFER               cn=0,n=17
         5 000021   000000 620006                    EAX0    0,QL
         5 000022   040000 100440                    MLR     fill='040'O
         5 000023   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         5 000024   000012 200012 2                  ADSC9   CMD_BUFFER+4             cn=1,n=10

       50     1330    1      WRITE_LO.BUF_=VECTOR(SUBSTR(CMD_BUFFER,0,SIZEC(MSG_HELLO)+B_VERSION.L));

   1330  5 000025   000000 236000 xsym               LDQ     B_VERSION
         5 000026   000033 772000                    QRL     27
         5 000027   000021 620006                    EAX0    17,QL
         5 000030   000000 635010                    EAA     0,X0
         5 000031   000002 771000                    ARL     2
         5 000032   000140 135007                    SBLA    96,DL
         5 000033   000001 236000 6                  LDQ     1
         5 000034   002014 757000 2                  STAQ    WRITE_LO+4

       51     1331    1      CALL M$WRITE (WRITE_LO);

   1331  5 000035   002010 630400 2                  EPPR0   WRITE_LO
         5 000036   040001 713400                    CLIMB   write
         5 000037   401400 401760                    pmme    nvectors=4

       52     1332    1      CALL M$DEVICE (FPT_DEVICE);

   1332  5 000040   000014 630400 1                  EPPR0   FPT_DEVICE
         5 000041   050006 713400                    CLIMB   20486
         5 000042   401000 401760                    pmme    nvectors=3

       53     1333
       54     1334    2      DO WHILE (RUNNING);

   1334  5 000043   002024 234000 2                  SZN     RUNNING
         5 000044   000052 605000 5                  TPL     s:1338

PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:9    
       55     1335    2          CALL FTPCMD;

   1335  5 000045   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000046   000000 701000 xent               TSX1    FTPCMD
         5 000047   000000 011000                    NOP     0

       56     1336    2          END;

   1336  5 000050   002024 234000 2                  SZN     RUNNING
         5 000051   000045 604000 5                  TMI     s:1335

       57     1337
       58     1338    1      RETURN;

   1338  5 000052   000000 702200 xent               TSX2  ! X66_MARET

TCF_SOCKINIT
 Sect OctLoc
   1     000   000000 000003   000000 000001   000000 010000   000000 006014    ................
   1     004   000000 000000   000003 000000                                    ........

MSG_HELLO
 Sect OctLoc
   1     006   103120 055066   040106 124120   040126 145162   163151 157156    CP-6 FTP Version
   1     012   040*** ******                                                     ...

FPT_DEVICE
 Sect OctLoc
   1     014   000003 777640   000022 006000   000000 177640   000000 006014    ................
   1     020   000000 177640   000000 006014   000000 200111   040040 040040    ...........I
   1     024   037000 000000   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................
   2     004*  777777 777777   ****** ******                                    ........

PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:10   
CMD_BUFFER
 Sect OctLoc
   2     006   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
   2    2007   0***** ******                                                    ....

WRITE_LO
 Sect OctLoc
   2    2010   000003 777640   002020 006000   000000 177640   000000 006014    ................
   2    2014   000000 177640   000000 006014   000000 177640   000000 006014    ................
   2    2020   000000 400400   000000 000000   000000 000000   020000 000000    ................

RUNNING
 Sect OctLoc
   2    2024   4***** ******                                                    ....

(unnamed)
 Sect OctLoc
   6     000   000000 006000   000006 006000                                    ........
       59     1339    1   END FTPUSER;
       60     1340        %EOD;

PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:11   
--  Include file information  --

   XSL_SOCKET_M.:TCA2TOU  is referenced.
   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   NK_VFC_C.:LIBRARY  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure FTPUSER.
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:12   

 **** Variables and constants ****

  ****  Section 001 RoData FTPUSER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/d STRC(360)   r     1 FPT_DEVICE                 6-0-0/c CHAR(17)    r     1 MSG_HELLO
     0-0-0/w STRC(216)   r     1 TCF_SOCKINIT

  ****  Section 002  Data  FTPUSER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/c CHAR(4100)  r     1 CMD_BUFFER              2024-0-0/b BIT         r     1 RUNNING
  2010-0-0/d STRC(432)   r     1 WRITE_LO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 B_VERSION

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$LO


   Procedure FTPUSER requires 43 words for executable code.
   Procedure FTPUSER requires 18 words of local(AUTO) storage.
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:13   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:14   
          MINI XREF LISTING

B_VERSION.L
      1258**DCL      1259--IMP-SIZ  1329>>CALLBLT  1330>>ASSIGN
B_VERSION.T
      1259**DCL      1329>>CALLBLT
CMD_BUFFER
      1256**DCL      1329<<CALLBLT  1330--ASSIGN
FPT_DEVICE
      1282**DCL      1332<>CALL
FPT_DEVICE.V
      1283**DCL      1282--DCLINIT
FTPCMD
      1264**DCL-ENT  1335--CALL
FTPCMD_INIT
      1265**DCL-ENT  1326--CALL
M$DEVICE
        22**DCL-ENT  1332--CALL
M$WRITE
        19**DCL-ENT  1331--CALL
M$XXX
        30**DCL-ENT  1327--CALL
MSG_HELLO
      1263**DCL      1329--CALLBLT  1329>>CALLBLT  1330--ASSIGN
RUNNING
      1323**DCL      1334>>DOWHILE
TCF_SOCKINIT
      1130**DCL      1325<>CALL
WRITE_LO
      1307**DCL      1331<>CALL
WRITE_LO.BUF_
      1307**DCL      1330<<ASSIGN
WRITE_LO.STATION_
      1309**DCL      1309--REDEF
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:15   
WRITE_LO.V
      1310**DCL      1307--DCLINIT
WRITE_LO.V.DVBYTE.VFC#
      1316**DCL      1316--REDEF
XSL$SOCKINIT
      1266**DCL-ENT  1325--CALL
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:16   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:17   
              MINI UREF LISTING

ADDR_BUF    1268**DCL
CMD_FS    1239**DCL
CMD_LCN    1254**DCL
CMD_LS    1247**DCL
DATA_LCN    1255**DCL
FTPUSER       8**PROC
LINK_UP    1262**DCL
M$ACCT      35**DCL-ENT
M$ACTIVATE      38**DCL-ENT
M$ALIB      31**DCL-ENT
M$ASUSER      33**DCL-ENT
M$ATTACH      40**DCL-ENT
M$BADPP      58**DCL-ENT
M$CGCTL      39**DCL-ENT
M$CGINFO      39**DCL-ENT
M$CHECK      20**DCL-ENT
M$CHGUNIT      78**DCL-ENT
M$CLOSE      18**DCL-ENT
M$CLRSTK      76**DCL-ENT
M$CMDVAR      87**DCL-ENT
M$CONFIG      48**DCL-ENT
M$CORRES      23**DCL-ENT
M$CPEXIT      32**DCL-ENT
M$CVM      56**DCL-ENT
M$CVOL      21**DCL-ENT
M$DCLFLD      48**DCL-ENT
M$DEACTIVATE      38**DCL-ENT
M$DELREC      20**DCL-ENT
M$DEQ      85**DCL-ENT
M$DETACH      40**DCL-ENT
M$DISPLAY      85**DCL-ENT
M$DISPRES      25**DCL-ENT
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:18   
M$DLIB      31**DCL-ENT
M$DO    1261**DCL
M$DRIBBLE      48**DCL-ENT
M$DRTN      76**DCL-ENT
M$DSUSER      33**DCL-ENT
M$ENQ      84**DCL-ENT
M$EOM      43**DCL-ENT
M$ERASE      49**DCL-ENT
M$ERR      30**DCL-ENT
M$ERRMSG      81**DCL-ENT
M$EVENT      73**DCL-ENT
M$EXHUME      82**DCL-ENT
M$EXIT      30**DCL-ENT
M$EXTEND      22**DCL-ENT
M$FDP      54**DCL-ENT
M$FDS      53**DCL-ENT
M$FEBOOT      46**DCL-ENT
M$FECTL      47**DCL-ENT
M$FEDUMP      46**DCL-ENT
M$FID      81**DCL-ENT
M$FINDPROC      35**DCL-ENT
M$FSUSER      33**DCL-ENT
M$FVP      55**DCL-ENT
M$FWCG      39**DCL-ENT
M$GBPL      59**DCL-ENT
M$GDDL      55**DCL-ENT
M$GDP      54**DCL-ENT
M$GDS      53**DCL-ENT
M$GETDCB      24**DCL-ENT
M$GETMOUSE      64**DCL-ENT
M$GETPM      65**DCL-ENT
M$GJOB      83**DCL-ENT
M$GLINEATTR      43**DCL-ENT
M$GOODPP      58**DCL-ENT
M$GPLATEN      51**DCL-ENT
M$GPROMPT      50**DCL-ENT
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:19   
M$GTRMATTR      44**DCL-ENT
M$GTRMCTL      42**DCL-ENT
M$GTRMTAB      45**DCL-ENT
M$GVP      54**DCL-ENT
M$HELP      81**DCL-ENT
M$INT      73**DCL-ENT
M$INTRTN      34**DCL-ENT
M$IOQ      69**DCL-ENT
M$JOBSTATS      83**DCL-ENT
M$KEYIN      23**DCL-ENT
M$LDEV      18**DCL-ENT
M$LDTRC      31**DCL-ENT
M$LIMIT      24**DCL-ENT
M$LINES      23**DCL-ENT
M$LINK      30**DCL-ENT
M$LO    1260**DCL
M$MADMUCK      26**DCL-ENT
M$MAKUSER      57**DCL-ENT
M$MBS      25**DCL-ENT
M$MDFFLD      49**DCL-ENT
M$MERC      74**DCL-ENT
M$MERCS      75**DCL-ENT
M$MIRROR      69**DCL-ENT
M$MONINFO      86**DCL-ENT
M$MPL      59**DCL-ENT
M$NODEINFO      50**DCL-ENT
M$NXTUSR      84**DCL-ENT
M$OCMSG      82**DCL-ENT
M$OLAY      30**DCL-ENT
M$OPEN      18**DCL-ENT
M$PAS      59**DCL-ENT
M$PATHCON      82**DCL-ENT
M$PDS      53**DCL-ENT
M$PFIL      20**DCL-ENT
M$PLATEN      44**DCL-ENT
M$PRECORD      22**DCL-ENT
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:20   
M$PROCNAME      35**DCL-ENT
M$PROFILE      46**DCL-ENT
M$PROMPT      42**DCL-ENT
M$RACST      26**DCL-ENT
M$RDSYSLOG      67**DCL-ENT
M$READ      19**DCL-ENT
M$RELDCB      24**DCL-ENT
M$RELRES      25**DCL-ENT
M$RELSTARF      27**DCL-ENT
M$REM      27**DCL-ENT
M$RENV      74**DCL-ENT
M$REQUIRE      26**DCL-ENT
M$RETRY      75**DCL-ENT
M$RETRYS      75**DCL-ENT
M$REW      21**DCL-ENT
M$RLSFLD      49**DCL-ENT
M$RPRIV      77**DCL-ENT
M$RSPP      56**DCL-ENT
M$RSWITCH      78**DCL-ENT
M$RUE      84**DCL-ENT
M$SAD      57**DCL-ENT
M$SAVE      33**DCL-ENT
M$SCON      34**DCL-ENT
M$SCREECH      32**DCL-ENT
M$SENV      74**DCL-ENT
M$SETFMA      18**DCL-ENT
M$SETFP      47**DCL-ENT
M$SINPUT      45**DCL-ENT
M$SLCFLD      50**DCL-ENT
M$SMOUSE      64**DCL-ENT
M$SMPRT      56**DCL-ENT
M$SPRIV      77**DCL-ENT
M$SSC      57**DCL-ENT
M$SSWITCH      77**DCL-ENT
M$STATE      86**DCL-ENT
M$STD      58**DCL-ENT
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:21   
M$STIMER      72**DCL-ENT
M$STLPP      55**DCL-ENT
M$STRAP      72**DCL-ENT
M$STRMATTR      44**DCL-ENT
M$STRMCTL      42**DCL-ENT
M$STRMTAB      45**DCL-ENT
M$SYMBIO      83**DCL-ENT
M$SYSCON      69**DCL-ENT
M$SYSID      87**DCL-ENT
M$TDCLOSE      68**DCL-ENT
M$TDIO      68**DCL-ENT
M$TDOPEN      67**DCL-ENT
M$TDREQCPU      68**DCL-ENT
M$TEMPWROC      62**DCL-ENT
M$TIME      85**DCL-ENT
M$TRAP      72**DCL-ENT
M$TRMISC      47**DCL-ENT
M$TRMPRG      43**DCL-ENT
M$TRTN      76**DCL-ENT
M$TRUNC      19**DCL-ENT
M$TTIMER      72**DCL-ENT
M$UC      42**DCL
M$UMPL      59**DCL-ENT
M$UNFID      81**DCL-ENT
M$UNLATCH      38**DCL-ENT
M$UNSHARE      35**DCL-ENT
M$USRFIELD      78**DCL-ENT
M$VIRTUAL      53**DCL-ENT
M$WAIT      76**DCL-ENT
M$WEOF      21**DCL-ENT
M$WRSYSLOG      67**DCL-ENT
M$XCON      73**DCL-ENT
M$XCONRTN      34**DCL-ENT
M$XEQTIME      86**DCL-ENT
M$XFLUSH      27**DCL-ENT
M$XMOUSE      64**DCL-ENT
PL6.E3A0      #001=FTPUSER File=TCF$FTP.:TCA2TSI                                 SUN 11/16/97 14:09 Page:22   
M$YC      32**DCL-ENT
TCP_ERR_CODE     200**DCL
TCP_MON_ERR     200**DCL

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:23   
       61        1        /*T***********************************************************/
       62        2        /*T*                                                         */
       63        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       64        4        /*T*                                                         */
       65        5        /*T***********************************************************/
       66        6
       67        7        GET_CONNECTED: PROC(OUT$BLK) ALTRET;
       68        8        %INCLUDE CP_6;
       69       89        %INCLUDE TCP_HEP_M;
       70      144        %INCLUDE TCP_HEP_E;
       71      221        %INCLUDE TCT_TELNET_E;
       72      276        %INCLUDE TCF_FTP_E;
       73      331        %INCLUDE XU_MACRO_C;
       74     3437        %INCLUDE XSL_SOCKET_E;
       75     3695
       76     3696        %PARSE$OUT (STCLASS=PARAM);
       77     3741        %PARSE$SYM (STCLASS="BASED(TXT$)");
       78     3779    1   DCL TXT$ PTR;
       79     3780    1   DCL TCP$OPEN ENTRY(6) ALTRET;
       80     3781    1   DCL TCP$READ_NW ENTRY(3) ALTRET;
       81     3782    1   DCL TCP$READ ENTRY(3) ALTRET;
       82     3783    1   DCL IP$WAIT ENTRY(2);
       83     3784    1   DCL TCP$WRITE_D ENTRY(4) ALTRET;
       84     3785    1   DCL TCP$WRITE ENTRY(4) ALTRET;
       85     3786    1   DCL NET$ADDR2IP ENTRY(2);
       86     3787    1   DCL NET$IP2ADDR ENTRY(2) ALTRET;
       87     3788    1   DCL NET$NAME2ADDR ENTRY(2) ALTRET;
       88     3789    1   DCL XSL$QSETSOCKOPT ENTRY(6) ALTRET;
       89     3790        %RCODE (STCLASS=SYMREF);
       90     3793    1   DCL VERBOSE BIT(36) SYMREF;
       91     3794        %FPT_TRMCTL (TRMCTL=VLP_TRMCTL);
       92     3821        %VLP_TRMCTL;
       93     3861    1   DCL FLAG BIT(1);
       94     3862        %TCP$CB (NAME=CB, STCLASS=STATIC);
       95     3865        %FPT_PROMPT;
       96     3893        %FPT_READ (FPTN=READ_SI,
       97     3894                DCB=M$UC,
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:24   
       98     3895                BUF=SI_BUF);
       99     3934
      100     3935    1   DCL SI_BUF CHAR(140) STATIC;
      101     3936    1   DCL CMD_LCN UBIN(36) SYMREF;
      102     3937    1   DCL CMD_BUFFER CHAR(1600) SYMREF;
      103     3938    1   DCL MSG_USER_ID CHAR(0) CONSTANT INIT('User id:');
      104     3939    1   DCL MSG_PASSWORD CHAR(0) CONSTANT INIT('Password:');
      105     3940    1   DCL MSG_ACCOUNT CHAR(0) CONSTANT INIT('Account:');
      106     3941        %TCP$SOCKET (NAME=CMD_LS, STCLASS=SYMREF);
      107     3949        %TCP$SOCKET (NAME=CMD_FS, STCLASS=SYMREF);
      108     3957    1   DCL REMOTE_ADMIN ENTRY(1);
      109     3958    1   DCL GET_RESPONSE ENTRY(3) ALTRET;
      110     3959    1   DCL TELNET_EOL ENTRY(1) ALTRET;
      111     3960    1   DCL CMD_TEXT CHAR(5);
      112     3961        %F$DCB;
      113     4018
      114     4019    1   DCL CHARN CHAR(CHARNLEN) BASED;
      115     4020    1   DCL CHARNLEN UBIN(36);
      116     4021        %XUG_GETCMD (STCLASS=SYMREF);
      117     4359    1   DCL M$SI$ PTR;
      118     4360    1   DCL M$UC$ PTR;
      119     4361    1   DCL TBUF CHAR(60);
      120     4362    1   DCL 1 TEXTC BASED,
      121     4363    1             2 L UBIN(9) UNAL,
      122     4364    1             2 C CHAR(TEXTC.L);
      123     4365
      124     4366    1      TXT$ = OUT$BLK.SUBLK$(0);
      125     4367    1      TBUF = OUT$SYM.TEXT;
      126     4368    2      CALL NET$IP2ADDR(CMD_FS.ADDRESS, TBUF) WHENALTRETURN DO;
      127     4369    2          CALL NET$NAME2ADDR(CMD_FS.ADDRESS, OUT$SYM.TEXTC$->TEXTC)
      128     4370    3          WHENALTRETURN DO;
      129     4371    3   RETALT:    ;
      130     4372    3              ALTRETURN;
      131     4373    3              END;
      132     4374    2          END;
      133     4375
      134     4376    1      CMD_LS='0'B;
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:25   
      135     4377    1      IF OUT$BLK.NSUBLKS = 1 THEN CMD_FS.PORT = %TCP$WKS$FTP;
      136     4378    2      ELSE DO;
      137     4379    2          CALL CHARBIN(CHARNLEN, OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);
      138     4380    2          CMD_FS.PORT = CHARNLEN;
      139     4381    2          END;
      140     4382    1      CALL TCP$OPEN (CMD_LCN, CMD_LS, CMD_FS, %TCP_ACTIVE, , CMD_LS)
      141     4383    1            ALTRET(RETALT);
      142     4384
      143     4385    1      CALL TCP$READ (CMD_LCN, VECTOR(CMD_BUFFER), CB) ALTRET(RETALT);
      144     4386
      145     4387    1      IF NOT (CB.ADMIN) THEN GOTO RETALT;
      146     4388    1      CALL REMOTE_ADMIN(ADDR(CMD_BUFFER));
      147     4389    1      CALL XSL$QSETSOCKOPT (CHARNLEN, CMD_LCN,
      148     4390    1            %XSL_SOL_SOCKET, %XSL_SO_NWREADS, 0, 4);
      149     4391
      150     4392    1   AGAIN:
      151     4393                                                /* Get hello message */
      152     4394    1      CALL GET_RESPONSE(CMD_LCN,RCODE,VERBOSE) ALTRET(RETALT);
      153     4395
      154     4396    1      IF RCODE.A = '1' THEN GOTO AGAIN;
      155     4397    1      ELSE IF RCODE.A ~= '2' THEN ALTRETURN;
      156     4398    1      OUT$BLK.NSUBLKS = 0;
      157     4399
      158     4400    1   GET_USER: ENTRY(OUT$BLK) ALTRET;
      159     4401
      160     4402    1      M$SI$ = DCBADDR(XUG_GETCMD.INDCB#);
      161     4403    1      M$UC$ = DCBADDR(DCBNUM(M$UC));
      162     4404
      163     4405    2      IF OUT$BLK.NSUBLKS = 0 THEN DO;
      164     4406                                                /* Prompt user for user id */
      165     4407    2          IF NOT M$SI$->F$DCB.DDEV.IC# OR M$SI$->F$DCB.DDEV.XEQ# THEN RETURN;
      166     4408    2          FPT_PROMPT.PROMPT_ = VECTOR(MSG_USER_ID);
      167     4409    2          CALL M$PROMPT (FPT_PROMPT);
      168     4410    3          CALL M$READ (READ_SI) WHENALTRETURN DO;
      169     4411    3              RETURN;
      170     4412    3              END;
      171     4413    2          CHARNLEN = M$UC$->F$DCB.ARS#;
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:26   
      172     4414    2          END;
      173     4415    2      ELSE DO;
      174     4416    2          SI_BUF = OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
      175     4417    2          CHARNLEN = OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT;
      176     4418    2          END;
      177     4419    1      IF CHARNLEN = 0 THEN RETURN;
      178     4420    1      CMD_TEXT = 'USER';
      179     4421    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(CMD_TEXT));
      180     4422    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(ADDR(SI_BUF)->CHARN));
      181     4423    1      CALL TELNET_EOL(CMD_LCN);
      182     4424
      183     4425                                                /* Get response to user command */
      184     4426    1      CALL GET_RESPONSE(CMD_LCN, RCODE, VERBOSE) ALTRET(RETALT);
      185     4427
      186     4428    1      IF RCODE.A ~= '3' THEN RETURN;
      187     4429
      188     4430                                                /* Password required, get it */
      189     4431
      190     4432    2      IF OUT$BLK.NSUBLKS < 2 THEN DO;
      191     4433                                                /* Prompt user for password id */
      192     4434    2          IF NOT M$SI$->F$DCB.DDEV.IC# OR M$SI$->F$DCB.DDEV.XEQ# THEN RETURN;
      193     4435    3          CALL M$GTRMCTL(FPT_TRMCTL) WHENRETURN DO;
      194     4436    3              FLAG = VLP_TRMCTL.DISPINPUT#;
      195     4437    3              END;
      196     4438    3          WHENALTRETURN DO;
      197     4439    3              FLAG='0'B;
      198     4440    3              END;
      199     4441    2          IF FLAG
      200     4442    3          THEN DO;
      201     4443    3              VLP_TRMCTL.DISPINPUT# = '0'B;
      202     4444    3              CALL M$STRMCTL (FPT_TRMCTL);
      203     4445    3              END;
      204     4446    2          FPT_PROMPT.PROMPT_ = VECTOR(MSG_PASSWORD);
      205     4447    2          CALL M$PROMPT (FPT_PROMPT);
      206     4448    3          CALL M$READ (READ_SI) WHENALTRETURN DO;
      207     4449    3              RETURN;
      208     4450    3              END;
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:27   
      209     4451    2          IF FLAG
      210     4452    3          THEN DO;
      211     4453    3              VLP_TRMCTL.DISPINPUT# = '1'B;
      212     4454    3              CALL M$STRMCTL (FPT_TRMCTL);
      213     4455    3              END;
      214     4456    2          CHARNLEN = M$UC$->F$DCB.ARS#;
      215     4457    2          END;
      216     4458    2      ELSE DO;
      217     4459    2          SI_BUF = OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT;
      218     4460    2          CHARNLEN = OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT;
      219     4461    2          END;
      220     4462    1      IF CHARNLEN = 0 THEN RETURN;
      221     4463    1      CMD_TEXT = 'PASS';
      222     4464    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(CMD_TEXT));
      223     4465    1      CALL TCP$WRITE (CMD_LCN, VECTOR(ADDR(SI_BUF)->CHARN));
      224     4466    1      CALL TELNET_EOL(CMD_LCN);
      225     4467
      226     4468                                                /* Get response to password command */
      227     4469    1      CALL GET_RESPONSE(CMD_LCN, RCODE,VERBOSE) ALTRET(RETALT);
      228     4470
      229     4471    1      IF RCODE.A ~= '3' THEN RETURN;
      230     4472
      231     4473                                                /* Acct required, get it */
      232     4474    2      IF OUT$BLK.NSUBLKS < 3 THEN DO;
      233     4475                                                /* Prompt user for acct id */
      234     4476    2          IF NOT M$SI$->F$DCB.DDEV.IC# OR M$SI$->F$DCB.DDEV.XEQ# THEN RETURN;
      235     4477    2          FPT_PROMPT.PROMPT_ = VECTOR(MSG_ACCOUNT);
      236     4478    2          CALL M$PROMPT (FPT_PROMPT);
      237     4479    3          CALL M$READ (READ_SI) WHENALTRETURN DO;
      238     4480    3              RETURN;
      239     4481    3              END;
      240     4482    2          CHARNLEN = M$UC$->F$DCB.ARS#;
      241     4483    2          END;
      242     4484    2      ELSE DO;
      243     4485    2          SI_BUF = OUT$BLK.SUBLK$(2) -> OUT$SYM.TEXT;
      244     4486    2          CHARNLEN = OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT;
      245     4487    2          END;
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:28   
      246     4488    1      IF CHARNLEN = 0 THEN RETURN;
      247     4489    1      CMD_TEXT = 'ACCT';
      248     4490    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(CMD_TEXT));
      249     4491    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(ADDR(SI_BUF)->CHARN));
      250     4492    1      CALL TELNET_EOL(CMD_LCN);
      251     4493
      252     4494                                                /* Get response to account command */
      253     4495    1      CALL GET_RESPONSE(CMD_LCN, RCODE,VERBOSE) ALTRET(RETALT);
      254     4496
      255     4497    1      RETURN;
      256     4498
      257     4499    1   END GET_CONNECTED;
      258     4500
      259     4501        %EOD;

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:29   
--  Include file information  --

   XSL_SOCKET_E.:TCA2TOU  is referenced.
   XU_MACRO_C.:LIBRARY  is referenced.
   TCF_FTP_E.:TCA2TOU  is referenced.
   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GET_CONNECTED.

   Procedure GET_CONNECTED requires 383 words for executable code.
   Procedure GET_CONNECTED requires 32 words of local(AUTO) storage.

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:30   

 Object Unit name= GET_CONNECTED                              File name= TCF$FTP.:TCA2TOU
 UTS= NOV 16 '97 14:10:11.04 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    77    115  GET_CONNECTED
    2  RoData even  UTS     10     12  GET_CONNECTED
    3   Proc  even  none   383    577  GET_CONNECTED
    4  RoData even  none    30     36  GET_CONNECTED

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  GET_CONNECTED
     3    152          yes     yes      Std        1  GET_USER
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:31   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 NET$IP2ADDR
 yes     yes           Std       6 TCP$OPEN
 yes     yes           Std       1 TELNET_EOL
 yes     yes           Std       3 TCP$READ
         yes           Std       1 REMOTE_ADMIN
 yes     yes           Std       2 NET$NAME2ADDR
 yes     yes           Std       3 GET_RESPONSE
 yes     yes           Std       4 TCP$WRITE
 yes     yes           Std       4 TCP$WRITE_D
 yes     yes           Std       6 XSL$QSETSOCKOPT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  RCODE                                 VERBOSE
     CMD_LCN                               CMD_BUFFER                            CMD_LS
     CMD_FS                                XUG_GETCMD                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:32   


       61        1        /*T***********************************************************/
       62        2        /*T*                                                         */
       63        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       64        4        /*T*                                                         */
       65        5        /*T***********************************************************/
       66        6
       67        7        GET_CONNECTED: PROC(OUT$BLK) ALTRET;

      7  3 000000   000000 700200 xent  GET_CONNECT* TSX0  ! X66_AUTO_1
         3 000001   000040 000001                    ZERO    32,1

       68        8        %INCLUDE CP_6;
       69       89        %INCLUDE TCP_HEP_M;
       70      144        %INCLUDE TCP_HEP_E;
       71      221        %INCLUDE TCT_TELNET_E;
       72      276        %INCLUDE TCF_FTP_E;
       73      331        %INCLUDE XU_MACRO_C;
       74     3437        %INCLUDE XSL_SOCKET_E;
       75     3695
       76     3696        %PARSE$OUT (STCLASS=PARAM);
       77     3741        %PARSE$SYM (STCLASS="BASED(TXT$)");
       78     3779    1   DCL TXT$ PTR;
       79     3780    1   DCL TCP$OPEN ENTRY(6) ALTRET;
       80     3781    1   DCL TCP$READ_NW ENTRY(3) ALTRET;
       81     3782    1   DCL TCP$READ ENTRY(3) ALTRET;
       82     3783    1   DCL IP$WAIT ENTRY(2);
       83     3784    1   DCL TCP$WRITE_D ENTRY(4) ALTRET;
       84     3785    1   DCL TCP$WRITE ENTRY(4) ALTRET;
       85     3786    1   DCL NET$ADDR2IP ENTRY(2);
       86     3787    1   DCL NET$IP2ADDR ENTRY(2) ALTRET;
       87     3788    1   DCL NET$NAME2ADDR ENTRY(2) ALTRET;
       88     3789    1   DCL XSL$QSETSOCKOPT ENTRY(6) ALTRET;
       89     3790        %RCODE (STCLASS=SYMREF);
       90     3793    1   DCL VERBOSE BIT(36) SYMREF;
       91     3794        %FPT_TRMCTL (TRMCTL=VLP_TRMCTL);
       92     3821        %VLP_TRMCTL;
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:33   
       93     3861    1   DCL FLAG BIT(1);
       94     3862        %TCP$CB (NAME=CB, STCLASS=STATIC);
       95     3865        %FPT_PROMPT;
       96     3893        %FPT_READ (FPTN=READ_SI,
       97     3894                DCB=M$UC,
       98     3895                BUF=SI_BUF);
       99     3934
      100     3935    1   DCL SI_BUF CHAR(140) STATIC;
      101     3936    1   DCL CMD_LCN UBIN(36) SYMREF;
      102     3937    1   DCL CMD_BUFFER CHAR(1600) SYMREF;
      103     3938    1   DCL MSG_USER_ID CHAR(0) CONSTANT INIT('User id:');
      104     3939    1   DCL MSG_PASSWORD CHAR(0) CONSTANT INIT('Password:');
      105     3940    1   DCL MSG_ACCOUNT CHAR(0) CONSTANT INIT('Account:');
      106     3941        %TCP$SOCKET (NAME=CMD_LS, STCLASS=SYMREF);
      107     3949        %TCP$SOCKET (NAME=CMD_FS, STCLASS=SYMREF);
      108     3957    1   DCL REMOTE_ADMIN ENTRY(1);
      109     3958    1   DCL GET_RESPONSE ENTRY(3) ALTRET;
      110     3959    1   DCL TELNET_EOL ENTRY(1) ALTRET;
      111     3960    1   DCL CMD_TEXT CHAR(5);
      112     3961        %F$DCB;
      113     4018
      114     4019    1   DCL CHARN CHAR(CHARNLEN) BASED;
      115     4020    1   DCL CHARNLEN UBIN(36);
      116     4021        %XUG_GETCMD (STCLASS=SYMREF);
      117     4359    1   DCL M$SI$ PTR;
      118     4360    1   DCL M$UC$ PTR;
      119     4361    1   DCL TBUF CHAR(60);
      120     4362    1   DCL 1 TEXTC BASED,
      121     4363    1             2 L UBIN(9) UNAL,
      122     4364    1             2 C CHAR(TEXTC.L);
      123     4365
      124     4366    1      TXT$ = OUT$BLK.SUBLK$(0);

   4366  3 000002   200003 470500                    LDP0    @OUT$BLK,,AUTO
         3 000003   000003 236100                    LDQ     3,,PR0
         3 000004   200004 756100                    STQ     TXT$,,AUTO

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:34   
      125     4367    1      TBUF = OUT$SYM.TEXT;

   4367  3 000005   200004 471500                    LDP1    TXT$,,AUTO
         3 000006   100004 236100                    LDQ     4,,PR1
         3 000007   000033 772000                    QRL     27
         3 000010   000000 620006                    EAX0    0,QL
         3 000011   040100 100540                    MLR     fill='040'O
         3 000012   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 000013   200013 000074                    ADSC9   TBUF,,AUTO               cn=0,n=60

      126     4368    2      CALL NET$IP2ADDR(CMD_FS.ADDRESS, TBUF) WHENALTRETURN DO;

   4368  3 000014   200013 633500                    EPPR3   TBUF,,AUTO
         3 000015   200033 453500                    STP3    TBUF+16,,AUTO
         3 000016   000000 236000 4                  LDQ     0
         3 000017   200032 756100                    STQ     TBUF+15,,AUTO
         3 000020   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000021   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000022   000000 701000 xent               TSX1    NET$IP2ADDR
         3 000023   000025 702000 3                  TSX2    s:4369
         3 000024   000040 710000 3                  TRA     s:4376

      127     4369    2          CALL NET$NAME2ADDR(CMD_FS.ADDRESS, OUT$SYM.TEXTC$->TEXTC)

   4369  3 000025   200004 470500                    LDP0    TXT$,,AUTO
         3 000026   000003 471500                    LDP1    3,,PR0
         3 000027   200033 451500                    STP1    TBUF+16,,AUTO
         3 000030   000000 236000 4                  LDQ     0
         3 000031   200032 756100                    STQ     TBUF+15,,AUTO
         3 000032   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000034   000000 701000 xent               TSX1    NET$NAME2ADDR
         3 000035   000037 702000 3                  TSX2    RETALT
         3 000036   000040 710000 3                  TRA     s:4376

      128     4370    3          WHENALTRETURN DO;

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:35   
      129     4371    3   RETALT:    ;

   4371  3 000037                       RETALT       null
      130     4372    3              ALTRETURN;

   4372  3 000037   000000 702200 xent               TSX2  ! X66_AALT

      131     4373    3              END;
      132     4374    2          END;

      133     4375
      134     4376    1      CMD_LS='0'B;

   4376  3 000040   000000 450000 xsym               STZ     CMD_LS
         3 000041   000001 450000 xsym               STZ     CMD_LS+1

      135     4377    1      IF OUT$BLK.NSUBLKS = 1 THEN CMD_FS.PORT = %TCP$WKS$FTP;

   4377  3 000042   200003 470500                    LDP0    @OUT$BLK,,AUTO
         3 000043   000001 220100                    LDX0    1,,PR0
         3 000044   000001 100003                    CMPX0   1,DU
         3 000045   000051 601000 3                  TNZ     s:4379

   4377  3 000046   000124 236003                    LDQ     84,DU
         3 000047   000001 756000 xsym               STQ     CMD_FS+1
         3 000050   000064 710000 3                  TRA     s:4382

      136     4378    2      ELSE DO;

      137     4379    2          CALL CHARBIN(CHARNLEN, OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT);

   4379  3 000051   000004 471500                    LDP1    4,,PR0
         3 000052   100004 236100                    LDQ     4,,PR1
         3 000053   000033 772000                    QRL     27
         3 000054   000000 621006                    EAX1    0,QL
         3 000055   000100 305540                    DTB
         3 000056   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:36   
         3 000057   200032 000010                    NDSC9   TBUF+15,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         3 000060   200033 235100                    LDA     TBUF+16,,AUTO
         3 000061   200010 755100                    STA     CHARNLEN,,AUTO

      138     4380    2          CMD_FS.PORT = CHARNLEN;

   4380  3 000062   000024 735000                    ALS     20
         3 000063   000001 755000 xsym               STA     CMD_FS+1

      139     4381    2          END;

      140     4382    1      CALL TCP$OPEN (CMD_LCN, CMD_LS, CMD_FS, %TCP_ACTIVE, , CMD_LS)

   4382  3 000064   000001 236000 4                  LDQ     1
         3 000065   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000066   200036 757100                    STAQ    TBUF+19,,AUTO
         3 000067   000002 237000 4                  LDAQ    2
         3 000070   200034 757100                    STAQ    TBUF+17,,AUTO
         3 000071   000004 237000 4                  LDAQ    4
         3 000072   200032 757100                    STAQ    TBUF+15,,AUTO
         3 000073   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000074   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000075   000000 701000 xent               TSX1    TCP$OPEN
         3 000076   000037 702000 3                  TSX2    RETALT

      141     4383    1            ALTRET(RETALT);
      142     4384
      143     4385    1      CALL TCP$READ (CMD_LCN, VECTOR(CMD_BUFFER), CB) ALTRET(RETALT);

   4385  3 000077   000010 630400 4                  EPPR0   8
         3 000100   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000101   000000 701000 xent               TSX1    TCP$READ
         3 000102   000037 702000 3                  TSX2    RETALT

      144     4386
      145     4387    1      IF NOT (CB.ADMIN) THEN GOTO RETALT;

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:37   
   4387  3 000103   000014 234000 1                  SZN     CB
         3 000104   000037 605000 3                  TPL     RETALT

      146     4388    1      CALL REMOTE_ADMIN(ADDR(CMD_BUFFER));

   4388  3 000105   000007 236000 4                  LDQ     7
         3 000106   200032 756100                    STQ     TBUF+15,,AUTO
         3 000107   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000110   200033 450500                    STP0    TBUF+16,,AUTO
         3 000111   200033 630500                    EPPR0   TBUF+16,,AUTO
         3 000112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000113   000000 701000 xent               TSX1    REMOTE_ADMIN
         3 000114   000000 011000                    NOP     0

      147     4389    1      CALL XSL$QSETSOCKOPT (CHARNLEN, CMD_LCN,

   4389  3 000115   000014 237000 4                  LDAQ    12
         3 000116   200036 757100                    STAQ    TBUF+19,,AUTO
         3 000117   000016 237000 4                  LDAQ    14
         3 000120   200034 757100                    STAQ    TBUF+17,,AUTO
         3 000121   000004 236000 4                  LDQ     4
         3 000122   200033 756100                    STQ     TBUF+16,,AUTO
         3 000123   200010 630500                    EPPR0   CHARNLEN,,AUTO
         3 000124   200032 450500                    STP0    TBUF+15,,AUTO
         3 000125   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000126   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000127   000000 701000 xent               TSX1    XSL$QSETSOCKOPT
         3 000130   000000 011000                    NOP     0

      148     4390    1            %XSL_SOL_SOCKET, %XSL_SO_NWREADS, 0, 4);
      149     4391
      150     4392    1   AGAIN:
      151     4393                                                /* Get hello message */
      152     4394    1      CALL GET_RESPONSE(CMD_LCN,RCODE,VERBOSE) ALTRET(RETALT);

   4394  3 000131   000020 630400 4     AGAIN        EPPR0   16
         3 000132   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:38   
         3 000133   000000 701000 xent               TSX1    GET_RESPONSE
         3 000134   000037 702000 3                  TSX2    RETALT

      153     4395
      154     4396    1      IF RCODE.A = '1' THEN GOTO AGAIN;

   4396  3 000135   000000 236000 xsym               LDQ     RCODE
         3 000136   777000 376003                    ANQ     -512,DU
         3 000137   061000 116003                    CMPQ    25088,DU
         3 000140   000131 600000 3                  TZE     AGAIN

      155     4397    1      ELSE IF RCODE.A ~= '2' THEN ALTRETURN;

   4397  3 000141   000000 236000 xsym               LDQ     RCODE
         3 000142   777000 376003                    ANQ     -512,DU
         3 000143   062000 116003                    CMPQ    25600,DU
         3 000144   000146 600000 3                  TZE     s:4398

   4397  3 000145   000000 702200 xent               TSX2  ! X66_AALT

      156     4398    1      OUT$BLK.NSUBLKS = 0;

   4398  3 000146   000000 220003                    LDX0    0,DU
         3 000147   200003 470500                    LDP0    @OUT$BLK,,AUTO
         3 000150   000001 740100                    STX0    1,,PR0
         3 000151   000154 710000 3                  TRA     s:4402

      157     4399
      158     4400    1   GET_USER: ENTRY(OUT$BLK) ALTRET;

   4400  3 000152   000000 700200 xent  GET_USER     TSX0  ! X66_AUTO_1
         3 000153   000040 000001                    ZERO    32,1

      159     4401
      160     4402    1      M$SI$ = DCBADDR(XUG_GETCMD.INDCB#);

   4402  3 000154   000023 470400 4                  LDP0    19
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:39   
         3 000155   000000 471500                    LDP1    0,,PR0
         3 000156   000012 720000 xsym               LXL0    XUG_GETCMD+10
         3 000157   100000 236110                    LDQ     0,X0,PR1
         3 000160   200011 756100                    STQ     M$SI$,,AUTO

      161     4403    1      M$UC$ = DCBADDR(DCBNUM(M$UC));

   4403  3 000161   000000 236007 xsym               LDQ     M$UC,DL
         3 000162   100000 236106                    LDQ     0,QL,PR1
         3 000163   200012 756100                    STQ     M$UC$,,AUTO

      162     4404
      163     4405    2      IF OUT$BLK.NSUBLKS = 0 THEN DO;

   4405  3 000164   200003 473500                    LDP3    @OUT$BLK,,AUTO
         3 000165   300001 221100                    LDX1    1,,PR3
         3 000166   000215 601000 3                  TNZ     s:4416

      164     4406                                                /* Prompt user for user id */
      165     4407    2          IF NOT M$SI$->F$DCB.DDEV.IC# OR M$SI$->F$DCB.DDEV.XEQ# THEN RETURN;

   4407  3 000167   200011 474500                    LDP4    M$SI$,,AUTO
         3 000170   400004 236100                    LDQ     4,,PR4
         3 000171   100000 316007                    CANQ    32768,DL
         3 000172   000175 600000 3                  TZE     s:4407+6
         3 000173   040000 316007                    CANQ    16384,DL
         3 000174   000176 600000 3                  TZE     s:4408

   4407  3 000175   000000 702200 xent               TSX2  ! X66_ARET

      166     4408    2          FPT_PROMPT.PROMPT_ = VECTOR(MSG_USER_ID);

   4408  3 000176   000024 237000 4                  LDAQ    20
         3 000177   000026 757000 1                  STAQ    FPT_PROMPT+4

      167     4409    2          CALL M$PROMPT (FPT_PROMPT);

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:40   
   4409  3 000200   000022 630400 1                  EPPR0   FPT_PROMPT
         3 000201   160002 713400                    CLIMB   57346
         3 000202   401000 401760                    pmme    nvectors=3

      168     4410    3          CALL M$READ (READ_SI) WHENALTRETURN DO;

   4410  3 000203   000034 630400 1                  EPPR0   READ_SI
         3 000204   440000 713400                    CLIMB   alt,read
         3 000205   401400 401760                    pmme    nvectors=4
         3 000206   000210 702000 3                  TSX2    s:4411
         3 000207   000211 710000 3                  TRA     s:4413

      169     4411    3              RETURN;

   4411  3 000210   000000 702200 xent               TSX2  ! X66_ARET

      170     4412    3              END;
      171     4413    2          CHARNLEN = M$UC$->F$DCB.ARS#;

   4413  3 000211   200012 470500                    LDP0    M$UC$,,AUTO
         3 000212   000000 235100                    LDA     0,,PR0
         3 000213   200010 755100                    STA     CHARNLEN,,AUTO

      172     4414    2          END;

   4414  3 000214   000230 710000 3                  TRA     s:4419

      173     4415    2      ELSE DO;

      174     4416    2          SI_BUF = OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

   4416  3 000215   300003 474500                    LDP4    3,,PR3
         3 000216   400004 236100                    LDQ     4,,PR4
         3 000217   000033 772000                    QRL     27
         3 000220   000000 622006                    EAX2    0,QL
         3 000221   040000 100540                    MLR     fill='040'O
         3 000222   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:41   
         3 000223   000052 000214 1                  ADSC9   SI_BUF                   cn=0,n=140

      175     4417    2          CHARNLEN = OUT$BLK.SUBLK$(0) -> OUT$SYM.COUNT;

   4417  3 000224   300003 474500                    LDP4    3,,PR3
         3 000225   400004 236100                    LDQ     4,,PR4
         3 000226   000033 772000                    QRL     27
         3 000227   200010 756100                    STQ     CHARNLEN,,AUTO

      176     4418    2          END;

      177     4419    1      IF CHARNLEN = 0 THEN RETURN;

   4419  3 000230   200010 235100                    LDA     CHARNLEN,,AUTO
         3 000231   000233 601000 3                  TNZ     s:4420

   4419  3 000232   000000 702200 xent               TSX2  ! X66_ARET

      178     4420    1      CMD_TEXT = 'USER';

   4420  3 000233   040100 100400                    MLR     fill='040'O
         3 000234   000007 000004 2                  ADSC9   MSG_ACCOUNT+2            cn=0,n=4
         3 000235   200006 000005                    ADSC9   CMD_TEXT,,AUTO           cn=0,n=5

      179     4421    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(CMD_TEXT));

   4421  3 000236   000026 235000 4                  LDA     22
         3 000237   200032 452500                    STP2    TBUF+15,,AUTO
         3 000240   200032 236100                    LDQ     TBUF+15,,AUTO
         3 000241   000006 036003                    ADLQ    6,DU
         3 000242   200034 757100                    STAQ    TBUF+17,,AUTO
         3 000243   200034 630500                    EPPR0   TBUF+17,,AUTO
         3 000244   200037 450500                    STP0    TBUF+20,,AUTO
         3 000245   000004 236000 4                  LDQ     4
         3 000246   200036 756100                    STQ     TBUF+19,,AUTO
         3 000247   200036 630500                    EPPR0   TBUF+19,,AUTO
         3 000250   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:42   
         3 000251   000000 701000 xent               TSX1    TCP$WRITE_D
         3 000252   000000 011000                    NOP     0

      180     4422    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(ADDR(SI_BUF)->CHARN));

   4422  3 000253   200010 235100                    LDA     CHARNLEN,,AUTO
         3 000254   000020 735000                    ALS     16
         3 000255   000140 135007                    SBLA    96,DL
         3 000256   000027 236000 4                  LDQ     23
         3 000257   200032 757100                    STAQ    TBUF+15,,AUTO
         3 000260   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000261   200035 450500                    STP0    TBUF+18,,AUTO
         3 000262   000004 236000 4                  LDQ     4
         3 000263   200034 756100                    STQ     TBUF+17,,AUTO
         3 000264   200034 630500                    EPPR0   TBUF+17,,AUTO
         3 000265   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000266   000000 701000 xent               TSX1    TCP$WRITE_D
         3 000267   000000 011000                    NOP     0

      181     4423    1      CALL TELNET_EOL(CMD_LCN);

   4423  3 000270   000004 630400 4                  EPPR0   4
         3 000271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000272   000000 701000 xent               TSX1    TELNET_EOL
         3 000273   000000 011000                    NOP     0

      182     4424
      183     4425                                                /* Get response to user command */
      184     4426    1      CALL GET_RESPONSE(CMD_LCN, RCODE, VERBOSE) ALTRET(RETALT);

   4426  3 000274   000020 630400 4                  EPPR0   16
         3 000275   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000276   000000 701000 xent               TSX1    GET_RESPONSE
         3 000277   000037 702000 3                  TSX2    RETALT

      185     4427
      186     4428    1      IF RCODE.A ~= '3' THEN RETURN;
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:43   

   4428  3 000300   000000 236000 xsym               LDQ     RCODE
         3 000301   777000 376003                    ANQ     -512,DU
         3 000302   063000 116003                    CMPQ    26112,DU
         3 000303   000305 600000 3                  TZE     s:4432

   4428  3 000304   000000 702200 xent               TSX2  ! X66_ARET

      187     4429
      188     4430                                                /* Password required, get it */
      189     4431
      190     4432    2      IF OUT$BLK.NSUBLKS < 2 THEN DO;

   4432  3 000305   200003 470500                    LDP0    @OUT$BLK,,AUTO
         3 000306   000001 220100                    LDX0    1,,PR0
         3 000307   000002 100003                    CMPX0   2,DU
         3 000310   000371 603000 3                  TRC     s:4459

      191     4433                                                /* Prompt user for password id */
      192     4434    2          IF NOT M$SI$->F$DCB.DDEV.IC# OR M$SI$->F$DCB.DDEV.XEQ# THEN RETURN;

   4434  3 000311   200011 471500                    LDP1    M$SI$,,AUTO
         3 000312   100004 236100                    LDQ     4,,PR1
         3 000313   100000 316007                    CANQ    32768,DL
         3 000314   000317 600000 3                  TZE     s:4434+6
         3 000315   040000 316007                    CANQ    16384,DL
         3 000316   000320 600000 3                  TZE     s:4435

   4434  3 000317   000000 702200 xent               TSX2  ! X66_ARET

      193     4435    3          CALL M$GTRMCTL(FPT_TRMCTL) WHENRETURN DO;

   4435  3 000320   000000 630400 1                  EPPR0   FPT_TRMCTL
         3 000321   560001 713400                    CLIMB   alt,+57345
         3 000322   401000 401760                    pmme    nvectors=3
         3 000323   000331 702000 3                  TSX2    s:4439

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:44   
      194     4436    3              FLAG = VLP_TRMCTL.DISPINPUT#;

   4436  3 000324   000010 236000 1                  LDQ     VLP_TRMCTL
         3 000325   000012 736000                    QLS     10
         3 000326   400000 376003                    ANQ     -131072,DU
         3 000327   200005 756100                    STQ     FLAG,,AUTO

      195     4437    3              END;

   4437  3 000330   000332 710000 3                  TRA     s:4441

      196     4438    3          WHENALTRETURN DO;

      197     4439    3              FLAG='0'B;

   4439  3 000331   200005 450100                    STZ     FLAG,,AUTO

      198     4440    3              END;

      199     4441    2          IF FLAG

   4441  3 000332   200005 234100                    SZN     FLAG,,AUTO
         3 000333   000341 605000 3                  TPL     s:4446

      200     4442    3          THEN DO;

      201     4443    3              VLP_TRMCTL.DISPINPUT# = '0'B;

   4443  3 000334   000030 236000 4                  LDQ     24
         3 000335   000010 356000 1                  ANSQ    VLP_TRMCTL

      202     4444    3              CALL M$STRMCTL (FPT_TRMCTL);

   4444  3 000336   000000 630400 1                  EPPR0   FPT_TRMCTL
         3 000337   160000 713400                    CLIMB   57344
         3 000340   401000 401760                    pmme    nvectors=3

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:45   
      203     4445    3              END;

      204     4446    2          FPT_PROMPT.PROMPT_ = VECTOR(MSG_PASSWORD);

   4446  3 000341   000032 237000 4                  LDAQ    26
         3 000342   000026 757000 1                  STAQ    FPT_PROMPT+4

      205     4447    2          CALL M$PROMPT (FPT_PROMPT);

   4447  3 000343   000022 630400 1                  EPPR0   FPT_PROMPT
         3 000344   160002 713400                    CLIMB   57346
         3 000345   401000 401760                    pmme    nvectors=3

      206     4448    3          CALL M$READ (READ_SI) WHENALTRETURN DO;

   4448  3 000346   000034 630400 1                  EPPR0   READ_SI
         3 000347   440000 713400                    CLIMB   alt,read
         3 000350   401400 401760                    pmme    nvectors=4
         3 000351   000353 702000 3                  TSX2    s:4449
         3 000352   000354 710000 3                  TRA     s:4451

      207     4449    3              RETURN;

   4449  3 000353   000000 702200 xent               TSX2  ! X66_ARET

      208     4450    3              END;
      209     4451    2          IF FLAG

   4451  3 000354   200005 234100                    SZN     FLAG,,AUTO
         3 000355   000365 605000 3                  TPL     s:4456

      210     4452    3          THEN DO;

      211     4453    3              VLP_TRMCTL.DISPINPUT# = '1'B;

   4453  3 000356   000010 236000 1                  LDQ     VLP_TRMCTL
         3 000357   000030 376000 4                  ANQ     24
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:46   
         3 000360   000200 276003                    ORQ     128,DU
         3 000361   000010 756000 1                  STQ     VLP_TRMCTL

      212     4454    3              CALL M$STRMCTL (FPT_TRMCTL);

   4454  3 000362   000000 630400 1                  EPPR0   FPT_TRMCTL
         3 000363   160000 713400                    CLIMB   57344
         3 000364   401000 401760                    pmme    nvectors=3

      213     4455    3              END;

      214     4456    2          CHARNLEN = M$UC$->F$DCB.ARS#;

   4456  3 000365   200012 470500                    LDP0    M$UC$,,AUTO
         3 000366   000000 235100                    LDA     0,,PR0
         3 000367   200010 755100                    STA     CHARNLEN,,AUTO

      215     4457    2          END;

   4457  3 000370   000404 710000 3                  TRA     s:4462

      216     4458    2      ELSE DO;

      217     4459    2          SI_BUF = OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT;

   4459  3 000371   000004 471500                    LDP1    4,,PR0
         3 000372   100004 236100                    LDQ     4,,PR1
         3 000373   000033 772000                    QRL     27
         3 000374   000000 621006                    EAX1    0,QL
         3 000375   040000 100540                    MLR     fill='040'O
         3 000376   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         3 000377   000052 000214 1                  ADSC9   SI_BUF                   cn=0,n=140

      218     4460    2          CHARNLEN = OUT$BLK.SUBLK$(1) -> OUT$SYM.COUNT;

   4460  3 000400   000004 471500                    LDP1    4,,PR0
         3 000401   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:47   
         3 000402   000033 772000                    QRL     27
         3 000403   200010 756100                    STQ     CHARNLEN,,AUTO

      219     4461    2          END;

      220     4462    1      IF CHARNLEN = 0 THEN RETURN;

   4462  3 000404   200010 235100                    LDA     CHARNLEN,,AUTO
         3 000405   000407 601000 3                  TNZ     s:4463

   4462  3 000406   000000 702200 xent               TSX2  ! X66_ARET

      221     4463    1      CMD_TEXT = 'PASS';

   4463  3 000407   040100 100400                    MLR     fill='040'O
         3 000410   000010 000004 2                  ADSC9   MSG_ACCOUNT+3            cn=0,n=4
         3 000411   200006 000005                    ADSC9   CMD_TEXT,,AUTO           cn=0,n=5

      222     4464    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(CMD_TEXT));

   4464  3 000412   000026 235000 4                  LDA     22
         3 000413   200032 452500                    STP2    TBUF+15,,AUTO
         3 000414   200032 236100                    LDQ     TBUF+15,,AUTO
         3 000415   000006 036003                    ADLQ    6,DU
         3 000416   200034 757100                    STAQ    TBUF+17,,AUTO
         3 000417   200034 630500                    EPPR0   TBUF+17,,AUTO
         3 000420   200037 450500                    STP0    TBUF+20,,AUTO
         3 000421   000004 236000 4                  LDQ     4
         3 000422   200036 756100                    STQ     TBUF+19,,AUTO
         3 000423   200036 630500                    EPPR0   TBUF+19,,AUTO
         3 000424   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000425   000000 701000 xent               TSX1    TCP$WRITE_D
         3 000426   000000 011000                    NOP     0

      223     4465    1      CALL TCP$WRITE (CMD_LCN, VECTOR(ADDR(SI_BUF)->CHARN));

   4465  3 000427   200010 235100                    LDA     CHARNLEN,,AUTO
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:48   
         3 000430   000020 735000                    ALS     16
         3 000431   000140 135007                    SBLA    96,DL
         3 000432   000027 236000 4                  LDQ     23
         3 000433   200032 757100                    STAQ    TBUF+15,,AUTO
         3 000434   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000435   200035 450500                    STP0    TBUF+18,,AUTO
         3 000436   000004 236000 4                  LDQ     4
         3 000437   200034 756100                    STQ     TBUF+17,,AUTO
         3 000440   200034 630500                    EPPR0   TBUF+17,,AUTO
         3 000441   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000442   000000 701000 xent               TSX1    TCP$WRITE
         3 000443   000000 011000                    NOP     0

      224     4466    1      CALL TELNET_EOL(CMD_LCN);

   4466  3 000444   000004 630400 4                  EPPR0   4
         3 000445   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000446   000000 701000 xent               TSX1    TELNET_EOL
         3 000447   000000 011000                    NOP     0

      225     4467
      226     4468                                                /* Get response to password command */
      227     4469    1      CALL GET_RESPONSE(CMD_LCN, RCODE,VERBOSE) ALTRET(RETALT);

   4469  3 000450   000020 630400 4                  EPPR0   16
         3 000451   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000452   000000 701000 xent               TSX1    GET_RESPONSE
         3 000453   000037 702000 3                  TSX2    RETALT

      228     4470
      229     4471    1      IF RCODE.A ~= '3' THEN RETURN;

   4471  3 000454   000000 236000 xsym               LDQ     RCODE
         3 000455   777000 376003                    ANQ     -512,DU
         3 000456   063000 116003                    CMPQ    26112,DU
         3 000457   000461 600000 3                  TZE     s:4474

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:49   
   4471  3 000460   000000 702200 xent               TSX2  ! X66_ARET

      230     4472
      231     4473                                                /* Acct required, get it */
      232     4474    2      IF OUT$BLK.NSUBLKS < 3 THEN DO;

   4474  3 000461   200003 470500                    LDP0    @OUT$BLK,,AUTO
         3 000462   000001 220100                    LDX0    1,,PR0
         3 000463   000003 100003                    CMPX0   3,DU
         3 000464   000513 603000 3                  TRC     s:4485

      233     4475                                                /* Prompt user for acct id */
      234     4476    2          IF NOT M$SI$->F$DCB.DDEV.IC# OR M$SI$->F$DCB.DDEV.XEQ# THEN RETURN;

   4476  3 000465   200011 471500                    LDP1    M$SI$,,AUTO
         3 000466   100004 236100                    LDQ     4,,PR1
         3 000467   100000 316007                    CANQ    32768,DL
         3 000470   000473 600000 3                  TZE     s:4476+6
         3 000471   040000 316007                    CANQ    16384,DL
         3 000472   000474 600000 3                  TZE     s:4477

   4476  3 000473   000000 702200 xent               TSX2  ! X66_ARET

      235     4477    2          FPT_PROMPT.PROMPT_ = VECTOR(MSG_ACCOUNT);

   4477  3 000474   000034 237000 4                  LDAQ    28
         3 000475   000026 757000 1                  STAQ    FPT_PROMPT+4

      236     4478    2          CALL M$PROMPT (FPT_PROMPT);

   4478  3 000476   000022 630400 1                  EPPR0   FPT_PROMPT
         3 000477   160002 713400                    CLIMB   57346
         3 000500   401000 401760                    pmme    nvectors=3

      237     4479    3          CALL M$READ (READ_SI) WHENALTRETURN DO;

   4479  3 000501   000034 630400 1                  EPPR0   READ_SI
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:50   
         3 000502   440000 713400                    CLIMB   alt,read
         3 000503   401400 401760                    pmme    nvectors=4
         3 000504   000506 702000 3                  TSX2    s:4480
         3 000505   000507 710000 3                  TRA     s:4482

      238     4480    3              RETURN;

   4480  3 000506   000000 702200 xent               TSX2  ! X66_ARET

      239     4481    3              END;
      240     4482    2          CHARNLEN = M$UC$->F$DCB.ARS#;

   4482  3 000507   200012 470500                    LDP0    M$UC$,,AUTO
         3 000510   000000 235100                    LDA     0,,PR0
         3 000511   200010 755100                    STA     CHARNLEN,,AUTO

      241     4483    2          END;

   4483  3 000512   000526 710000 3                  TRA     s:4488

      242     4484    2      ELSE DO;

      243     4485    2          SI_BUF = OUT$BLK.SUBLK$(2) -> OUT$SYM.TEXT;

   4485  3 000513   000005 471500                    LDP1    5,,PR0
         3 000514   100004 236100                    LDQ     4,,PR1
         3 000515   000033 772000                    QRL     27
         3 000516   000000 621006                    EAX1    0,QL
         3 000517   040000 100540                    MLR     fill='040'O
         3 000520   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         3 000521   000052 000214 1                  ADSC9   SI_BUF                   cn=0,n=140

      244     4486    2          CHARNLEN = OUT$BLK.SUBLK$(2) -> OUT$SYM.COUNT;

   4486  3 000522   000005 471500                    LDP1    5,,PR0
         3 000523   100004 236100                    LDQ     4,,PR1
         3 000524   000033 772000                    QRL     27
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:51   
         3 000525   200010 756100                    STQ     CHARNLEN,,AUTO

      245     4487    2          END;

      246     4488    1      IF CHARNLEN = 0 THEN RETURN;

   4488  3 000526   200010 235100                    LDA     CHARNLEN,,AUTO
         3 000527   000531 601000 3                  TNZ     s:4489

   4488  3 000530   000000 702200 xent               TSX2  ! X66_ARET

      247     4489    1      CMD_TEXT = 'ACCT';

   4489  3 000531   040100 100400                    MLR     fill='040'O
         3 000532   000011 000004 2                  ADSC9   MSG_ACCOUNT+4            cn=0,n=4
         3 000533   200006 000005                    ADSC9   CMD_TEXT,,AUTO           cn=0,n=5

      248     4490    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(CMD_TEXT));

   4490  3 000534   000026 235000 4                  LDA     22
         3 000535   200032 452500                    STP2    TBUF+15,,AUTO
         3 000536   200032 236100                    LDQ     TBUF+15,,AUTO
         3 000537   000006 036003                    ADLQ    6,DU
         3 000540   200034 757100                    STAQ    TBUF+17,,AUTO
         3 000541   200034 630500                    EPPR0   TBUF+17,,AUTO
         3 000542   200037 450500                    STP0    TBUF+20,,AUTO
         3 000543   000004 236000 4                  LDQ     4
         3 000544   200036 756100                    STQ     TBUF+19,,AUTO
         3 000545   200036 630500                    EPPR0   TBUF+19,,AUTO
         3 000546   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000547   000000 701000 xent               TSX1    TCP$WRITE_D
         3 000550   000000 011000                    NOP     0

      249     4491    1      CALL TCP$WRITE_D (CMD_LCN, VECTOR(ADDR(SI_BUF)->CHARN));

   4491  3 000551   200010 235100                    LDA     CHARNLEN,,AUTO
         3 000552   000020 735000                    ALS     16
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:52   
         3 000553   000140 135007                    SBLA    96,DL
         3 000554   000027 236000 4                  LDQ     23
         3 000555   200032 757100                    STAQ    TBUF+15,,AUTO
         3 000556   200032 630500                    EPPR0   TBUF+15,,AUTO
         3 000557   200035 450500                    STP0    TBUF+18,,AUTO
         3 000560   000004 236000 4                  LDQ     4
         3 000561   200034 756100                    STQ     TBUF+17,,AUTO
         3 000562   200034 630500                    EPPR0   TBUF+17,,AUTO
         3 000563   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000564   000000 701000 xent               TSX1    TCP$WRITE_D
         3 000565   000000 011000                    NOP     0

      250     4492    1      CALL TELNET_EOL(CMD_LCN);

   4492  3 000566   000004 630400 4                  EPPR0   4
         3 000567   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000570   000000 701000 xent               TSX1    TELNET_EOL
         3 000571   000000 011000                    NOP     0

      251     4493
      252     4494                                                /* Get response to account command */
      253     4495    1      CALL GET_RESPONSE(CMD_LCN, RCODE,VERBOSE) ALTRET(RETALT);

   4495  3 000572   000020 630400 4                  EPPR0   16
         3 000573   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000574   000000 701000 xent               TSX1    GET_RESPONSE
         3 000575   000037 702000 3                  TSX2    RETALT

      254     4496
      255     4497    1      RETURN;

   4497  3 000576   000000 702200 xent               TSX2  ! X66_ARET

FPT_TRMCTL
 Sect OctLoc
   1     000   000001 777640   000006 006000   000000 177640   000000 006014    ................
   1     004   000003 777640   000010 006000   000000 000000   000000 000000    ................
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:53   

VLP_TRMCTL
 Sect OctLoc
   1     010   125125 125125   125125 377377   125157 377377   377377 125177    UUUUUU..Uo....U.

CB
 Sect OctLoc
   1     014   0***** ******   ****** ******   ****** ******   ****** ******    ................
   1     020   ****** ******                                                    ....

FPT_PROMPT
 Sect OctLoc
   1     022   000003 777640   000030 006000   000000 177640   000000 006014    ................
   1     026   000000 177640   000000 006014   000000 000000   000000 000000    ................
   1     032   000000 000000   000000 000000                                    ........

READ_SI
 Sect OctLoc
   1     034   000005 777640   000044 006000   000000 177640   000000 006014    .....$..........
   1     040   000042 777640   000052 006000   000000 177640   000000 006014    ."...*..........
   1     044   000000 400000   000000 000000   000000 000000   000000 000000    ................
   1     050   000000 000000   000000 000000                                    ........

SI_BUF
 Sect OctLoc
   1     052   ****** ******   ****** ******   ****** ******   ****** ******    ................

MSG_USER_ID
 Sect OctLoc
   2     000   125163 145162   040151 144072                                    User id:

MSG_PASSWORD
 Sect OctLoc
   2     002   120141 163163   167157 162144   072*** ******                    Password:...

MSG_ACCOUNT
 Sect OctLoc
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:54   
   2     005   101143 143157   165156 164072                                    Account:

(unnamed)
 Sect OctLoc
   2     007   125123 105122   120101 123123   101103 103124                    USERPASSACCT

(unnamed)
 Sect OctLoc
   4     000   000000 006000   000000 006000   000000 006000   000003 006000    ................
   4     004   000000 006000   000000 006000   000617 777640   000000 006000    ................
   4     010   000000 006000   000006 006000   000014 006000   000000 020002    ................
   4     014   000002 006000   000006 006000   000027 006000   000013 006000    ................
   4     020   000000 006000   000000 006000   000000 006000   000000 006003    ................
   4     024   000001 777640   000000 006000   000001 177640   000052 006000    .............*..
   4     030   777477 777777   000000 000000   000002 177640   000002 006000    ................
   4     034   000001 777640   000005 006000                                    ........
      256     4498
      257     4499    1   END GET_CONNECTED;
      258     4500
      259     4501        %EOD;

PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:55   
--  Include file information  --

   XSL_SOCKET_E.:TCA2TOU  is referenced.
   XU_MACRO_C.:LIBRARY  is referenced.
   TCF_FTP_E.:TCA2TOU  is referenced.
   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GET_CONNECTED.
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:56   

 **** Variables and constants ****

  ****  Section 001  Data  GET_CONNECTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/w STRC(180)   r     1 CB                        22-0-0/d STRC(360)   r     1 FPT_PROMPT
     0-0-0/d STRC(288)   r     1 FPT_TRMCTL                34-0-0/d STRC(504)   r     1 READ_SI
    52-0-0/c CHAR(140)   r     1 SI_BUF                    10-0-0/d STRC(144)   r     1 VLP_TRMCTL

  ****  Section 002 RoData GET_CONNECTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/c CHAR(8)     r     1 MSG_ACCOUNT                2-0-0/c CHAR(9)     r     1 MSG_PASSWORD
     0-0-0/c CHAR(8)     r     1 MSG_USER_ID

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @OUT$BLK                  10-0-0/w UBIN        r     1 CHARNLEN
     6-0-0/c CHAR(5)     r     1 CMD_TEXT                   5-0-0/b BIT         r     1 FLAG
    11-0-0/w PTR         r     1 M$SI$                     12-0-0/w PTR         r     1 M$UC$
    *0-0-0/w STRC(144)   r     1 OUT$BLK                   13-0-0/c CHAR(60)    r     1 TBUF
     4-0-0/w PTR         r     1 TXT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(1600)  r     1 CMD_BUFFER                 0-0-0/w STRC(72)    r     1 CMD_FS
     0-0-0/w UBIN        r     1 CMD_LCN                    0-0-0/w STRC(72)    r     1 CMD_LS
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:57   
     0-0-0/c STRC(27)    r     1 RCODE                      0-0-0/b BIT         r     1 VERBOSE
     0-0-0/d STRC(1512)  r     1 XUG_GETCMD

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 CHARN                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/c ASTR(9)     r     1 TEXTC


   Procedure GET_CONNECTED requires 383 words for executable code.
   Procedure GET_CONNECTED requires 32 words of local(AUTO) storage.
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:58   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:59   
          MINI XREF LISTING

AGAIN
      4394**LABEL    4396--GOTO
CB
      3863**DCL      4385<>CALL
CB.ADMIN
      3863**DCL      4387>>IF
CHARN
      4019**DCL      4422--CALL     4465--CALL     4491--CALL
CHARNLEN
      4020**DCL      4019--IMP-SIZ  4379<<CALLBLT  4380>>ASSIGN   4389<>CALL     4413<<ASSIGN   4417<<ASSIGN
      4419>>IF       4422>>CALL     4456<<ASSIGN   4460<<ASSIGN   4462>>IF       4465>>CALL     4482<<ASSIGN
      4486<<ASSIGN   4488>>IF       4491>>CALL
CMD_BUFFER
      3937**DCL      4385--CALL     4388--CALL
CMD_FS
      3951**DCL      4382<>CALL
CMD_FS.ADDRESS
      3955**DCL      4368<>CALL     4369<>CALL
CMD_FS.PORT
      3955**DCL      4377<<ASSIGN   4380<<ASSIGN
CMD_LCN
      3936**DCL      4382<>CALL     4385<>CALL     4389<>CALL     4394<>CALL     4421<>CALL     4422<>CALL
      4423<>CALL     4426<>CALL     4464<>CALL     4465<>CALL     4466<>CALL     4469<>CALL     4490<>CALL
      4491<>CALL     4492<>CALL     4495<>CALL
CMD_LS
      3943**DCL      4376<<ASSIGN   4382<>CALL     4382<>CALL
CMD_TEXT
      3960**DCL      4420<<ASSIGN   4421--CALL     4463<<ASSIGN   4464--CALL     4489<<ASSIGN   4490--CALL
F$DCB.ACTPOS
      3994**DCL      3994--REDEF
F$DCB.ARS#
      3968**DCL      3968--REDEF    4413>>ASSIGN   4456>>ASSIGN   4482>>ASSIGN
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:60   
F$DCB.ATTR
      3987**DCL      3988--REDEF
F$DCB.BORROW
      4002**DCL      4002--REDEF    4002--REDEF    4002--REDEF
F$DCB.DCBNAME.L
      4016**DCL      4016--IMP-SIZ
F$DCB.DDEV.IC#
      3974**DCL      4407>>IF       4434>>IF       4476>>IF
F$DCB.DDEV.XEQ#
      3975**DCL      4407>>IF       4434>>IF       4476>>IF
F$DCB.EOMCHAR#
      3972**DCL      3972--REDEF
F$DCB.FLDID
      3997**DCL      3997--REDEF
F$DCB.FORM$
      3991**DCL      3991--REDEF
F$DCB.FSECT
      4007**DCL      4007--REDEF
F$DCB.FSN#
      3984**DCL      3984--REDEF    3984--REDEF    3985--REDEF
F$DCB.HEADER$
      3990**DCL      3990--REDEF
F$DCB.IXTNSIZE#
      3988**DCL      3988--REDEF
F$DCB.LASTSTA$
      3977**DCL      3977--REDEF
F$DCB.LVL
      4003**DCL      4003--REDEF
F$DCB.NAME#.C
      3978**DCL      3978--REDEF
F$DCB.NOEOF
      4000**DCL      4000--REDEF
F$DCB.NRECS#
      3989**DCL      3989--REDEF
F$DCB.NRECX
      4008**DCL      4008--REDEF
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:61   
F$DCB.OHDR
      4000**DCL      4000--REDEF
F$DCB.ORG#
      3983**DCL      3983--REDEF
F$DCB.PRECNO
      4006**DCL      4006--REDEF
F$DCB.RCSZ
      4012**DCL      4012--REDEF
F$DCB.RES#
      3979**DCL      3979--REDEF
F$DCB.SETX
      3991**DCL      3991--REDEF
F$DCB.TAB$
      3991**DCL      3991--REDEF
F$DCB.TDA
      4005**DCL      4006--REDEF
F$DCB.WSN#
      3979**DCL      3979--REDEF
FLAG
      3861**DCL      4436<<ASSIGN   4439<<ASSIGN   4441>>IF       4451>>IF
FPT_PROMPT
      3881**DCL      4409<>CALL     4447<>CALL     4478<>CALL
FPT_PROMPT.PROMPT_
      3887**DCL      4408<<ASSIGN   4446<<ASSIGN   4477<<ASSIGN
FPT_PROMPT.V
      3889**DCL      3883--DCLINIT
FPT_TRMCTL
      3810**DCL      4435<>CALL     4444<>CALL     4454<>CALL
FPT_TRMCTL.V
      3818**DCL      3812--DCLINIT
GET_RESPONSE
      3958**DCL-ENT  4394--CALL     4426--CALL     4469--CALL     4495--CALL
M$GTRMCTL
        41**DCL-ENT  4435--CALL
M$PROMPT
        41**DCL-ENT  4409--CALL     4447--CALL     4478--CALL
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:62   
M$READ
        18**DCL-ENT  4410--CALL     4448--CALL     4479--CALL
M$SI$
      4359**DCL      4402<<ASSIGN   4407>>IF       4407>>IF       4434>>IF       4434>>IF       4476>>IF
      4476>>IF
M$STRMCTL
        41**DCL-ENT  4444--CALL     4454--CALL
M$UC
        41**DCL      4403--ASSIGN
M$UC$
      4360**DCL      4403<<ASSIGN   4413>>ASSIGN   4456>>ASSIGN   4482>>ASSIGN
MSG_ACCOUNT
      3940**DCL      4477--ASSIGN
MSG_PASSWORD
      3939**DCL      4446--ASSIGN
MSG_USER_ID
      3938**DCL      4408--ASSIGN
NET$IP2ADDR
      3787**DCL-ENT  4368--CALL
NET$NAME2ADDR
      3788**DCL-ENT  4369--CALL
OUT$BLK
      3702**DCL         7--PROC     4400--ENTRY
OUT$BLK.NSUBLKS
      3714**DCL      4377>>IF       4398<<ASSIGN   4405>>IF       4432>>IF       4474>>IF
OUT$BLK.SUBLK$
      3735**DCL      4366>>ASSIGN   4379>>CALLBLT  4379>>CALLBLT  4416>>ASSIGN   4416>>ASSIGN   4417>>ASSIGN
      4459>>ASSIGN   4459>>ASSIGN   4460>>ASSIGN   4485>>ASSIGN   4485>>ASSIGN   4486>>ASSIGN
OUT$SYM.COUNT
      3771**DCL      3774--IMP-SIZ  4367>>ASSIGN   4379>>CALLBLT  4416>>ASSIGN   4417>>ASSIGN   4459>>ASSIGN
      4460>>ASSIGN   4485>>ASSIGN   4486>>ASSIGN
OUT$SYM.TEXT
      3774**DCL      4367>>ASSIGN   4379>>CALLBLT  4416>>ASSIGN   4459>>ASSIGN   4485>>ASSIGN
OUT$SYM.TEXTC$
      3766**DCL      4369>>CALL     4369>>CALL
RCODE
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:63   
      3791**DCL      4394<>CALL     4426<>CALL     4469<>CALL     4495<>CALL
RCODE.A
      3791**DCL      4396>>IF       4397>>IF       4428>>IF       4471>>IF
READ_SI
      3912**DCL      4410<>CALL     4448<>CALL     4479<>CALL
READ_SI.STATION_
      3915**DCL      3916--REDEF
READ_SI.V
      3916**DCL      3912--DCLINIT
READ_SI.V.DVBYTE.REREAD#
      3927**DCL      3927--REDEF
READ_SI.V.INDX#
      3925**DCL      3925--REDEF
REMOTE_ADMIN
      3957**DCL-ENT  4388--CALL
RETALT
      4371**LABEL    4382--CALLALT  4385--CALLALT  4387--GOTO     4394--CALLALT  4426--CALLALT  4469--CALLALT
      4495--CALLALT
SI_BUF
      3935**DCL      3914--DCLINIT  3915--DCLINIT  4416<<ASSIGN   4422--CALL     4459<<ASSIGN   4465--CALL
      4485<<ASSIGN   4491--CALL
TBUF
      4361**DCL      4367<<ASSIGN   4368<>CALL
TCP$OPEN
      3780**DCL-ENT  4382--CALL
TCP$READ
      3782**DCL-ENT  4385--CALL
TCP$WRITE
      3785**DCL-ENT  4465--CALL
TCP$WRITE_D
      3784**DCL-ENT  4421--CALL     4422--CALL     4464--CALL     4490--CALL     4491--CALL
TELNET_EOL
      3959**DCL-ENT  4423--CALL     4466--CALL     4492--CALL
TEXTC
      4362**DCL      4369<>CALL
TEXTC.L
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:64   
      4363**DCL      4364--IMP-SIZ  4369>>CALL
TXT$
      3779**DCL      3748--IMP-PTR  4366<<ASSIGN   4367>>ASSIGN   4367>>ASSIGN   4369>>CALL     4369>>CALL
VERBOSE
      3793**DCL      4394<>CALL     4426<>CALL     4469<>CALL     4495<>CALL
VLP_TRMCTL
      3838**DCL      3816--DCLINIT
VLP_TRMCTL.BREAKCOUNT
      3849**DCL      3850--REDEF
VLP_TRMCTL.DISPINPUT#
      3840**DCL      4436>>ASSIGN   4443<<ASSIGN   4453<<ASSIGN
XSL$QSETSOCKOPT
      3789**DCL-ENT  4389--CALL
XUG_GETCMD.INDCB#
      4205**DCL      4402--ASSIGN
XUG_GETCMD.OUT$
      4039**DCL      4045--REDEF
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:65   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:66   
              MINI UREF LISTING

GET_CONNECTED       7**PROC
GET_USER    4400**ENTRY
IP$WAIT    3783**DCL-ENT
M$ACCT      34**DCL-ENT
M$ACTIVATE      37**DCL-ENT
M$ALIB      30**DCL-ENT
M$ASUSER      32**DCL-ENT
M$ATTACH      39**DCL-ENT
M$BADPP      57**DCL-ENT
M$CGCTL      38**DCL-ENT
M$CGINFO      38**DCL-ENT
M$CHECK      19**DCL-ENT
M$CHGUNIT      77**DCL-ENT
M$CLOSE      17**DCL-ENT
M$CLRSTK      75**DCL-ENT
M$CMDVAR      86**DCL-ENT
M$CONFIG      47**DCL-ENT
M$CORRES      22**DCL-ENT
M$CPEXIT      31**DCL-ENT
M$CVM      55**DCL-ENT
M$CVOL      20**DCL-ENT
M$DCLFLD      47**DCL-ENT
M$DEACTIVATE      37**DCL-ENT
M$DELREC      19**DCL-ENT
M$DEQ      84**DCL-ENT
M$DETACH      39**DCL-ENT
M$DEVICE      21**DCL-ENT
M$DISPLAY      84**DCL-ENT
M$DISPRES      24**DCL-ENT
M$DLIB      30**DCL-ENT
M$DRIBBLE      47**DCL-ENT
M$DRTN      75**DCL-ENT
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:67   
M$DSUSER      32**DCL-ENT
M$ENQ      83**DCL-ENT
M$EOM      42**DCL-ENT
M$ERASE      48**DCL-ENT
M$ERR      29**DCL-ENT
M$ERRMSG      80**DCL-ENT
M$EVENT      72**DCL-ENT
M$EXHUME      81**DCL-ENT
M$EXIT      29**DCL-ENT
M$EXTEND      21**DCL-ENT
M$FDP      53**DCL-ENT
M$FDS      52**DCL-ENT
M$FEBOOT      45**DCL-ENT
M$FECTL      46**DCL-ENT
M$FEDUMP      45**DCL-ENT
M$FID      80**DCL-ENT
M$FINDPROC      34**DCL-ENT
M$FSUSER      32**DCL-ENT
M$FVP      54**DCL-ENT
M$FWCG      38**DCL-ENT
M$GBPL      58**DCL-ENT
M$GDDL      54**DCL-ENT
M$GDP      53**DCL-ENT
M$GDS      52**DCL-ENT
M$GETDCB      23**DCL-ENT
M$GETMOUSE      63**DCL-ENT
M$GETPM      64**DCL-ENT
M$GJOB      82**DCL-ENT
M$GLINEATTR      42**DCL-ENT
M$GOODPP      57**DCL-ENT
M$GPLATEN      50**DCL-ENT
M$GPROMPT      49**DCL-ENT
M$GTRMATTR      43**DCL-ENT
M$GTRMTAB      44**DCL-ENT
M$GVP      53**DCL-ENT
M$HELP      80**DCL-ENT
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:68   
M$INT      72**DCL-ENT
M$INTRTN      33**DCL-ENT
M$IOQ      68**DCL-ENT
M$JOBSTATS      82**DCL-ENT
M$KEYIN      22**DCL-ENT
M$LDEV      17**DCL-ENT
M$LDTRC      30**DCL-ENT
M$LIMIT      23**DCL-ENT
M$LINES      22**DCL-ENT
M$LINK      29**DCL-ENT
M$MADMUCK      25**DCL-ENT
M$MAKUSER      56**DCL-ENT
M$MBS      24**DCL-ENT
M$MDFFLD      48**DCL-ENT
M$MERC      73**DCL-ENT
M$MERCS      74**DCL-ENT
M$MIRROR      68**DCL-ENT
M$MONINFO      85**DCL-ENT
M$MPL      58**DCL-ENT
M$NODEINFO      49**DCL-ENT
M$NXTUSR      83**DCL-ENT
M$OCMSG      81**DCL-ENT
M$OLAY      29**DCL-ENT
M$OPEN      17**DCL-ENT
M$PAS      58**DCL-ENT
M$PATHCON      81**DCL-ENT
M$PDS      52**DCL-ENT
M$PFIL      19**DCL-ENT
M$PLATEN      43**DCL-ENT
M$PRECORD      21**DCL-ENT
M$PROCNAME      34**DCL-ENT
M$PROFILE      45**DCL-ENT
M$RACST      25**DCL-ENT
M$RDSYSLOG      66**DCL-ENT
M$RELDCB      23**DCL-ENT
M$RELRES      24**DCL-ENT
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:69   
M$RELSTARF      26**DCL-ENT
M$REM      26**DCL-ENT
M$RENV      73**DCL-ENT
M$REQUIRE      25**DCL-ENT
M$RETRY      74**DCL-ENT
M$RETRYS      74**DCL-ENT
M$REW      20**DCL-ENT
M$RLSFLD      48**DCL-ENT
M$RPRIV      76**DCL-ENT
M$RSPP      55**DCL-ENT
M$RSWITCH      77**DCL-ENT
M$RUE      83**DCL-ENT
M$SAD      56**DCL-ENT
M$SAVE      32**DCL-ENT
M$SCON      33**DCL-ENT
M$SCREECH      31**DCL-ENT
M$SENV      73**DCL-ENT
M$SETFMA      17**DCL-ENT
M$SETFP      46**DCL-ENT
M$SINPUT      44**DCL-ENT
M$SLCFLD      49**DCL-ENT
M$SMOUSE      63**DCL-ENT
M$SMPRT      55**DCL-ENT
M$SPRIV      76**DCL-ENT
M$SSC      56**DCL-ENT
M$SSWITCH      76**DCL-ENT
M$STATE      85**DCL-ENT
M$STD      57**DCL-ENT
M$STIMER      71**DCL-ENT
M$STLPP      54**DCL-ENT
M$STRAP      71**DCL-ENT
M$STRMATTR      43**DCL-ENT
M$STRMTAB      44**DCL-ENT
M$SYMBIO      82**DCL-ENT
M$SYSCON      68**DCL-ENT
M$SYSID      86**DCL-ENT
PL6.E3A0      #002=GET_CONNECTED File=TCF$FTP.:TCA2TSI                           SUN 11/16/97 14:10 Page:70   
M$TDCLOSE      67**DCL-ENT
M$TDIO      67**DCL-ENT
M$TDOPEN      66**DCL-ENT
M$TDREQCPU      67**DCL-ENT
M$TEMPWROC      61**DCL-ENT
M$TIME      84**DCL-ENT
M$TRAP      71**DCL-ENT
M$TRMISC      46**DCL-ENT
M$TRMPRG      42**DCL-ENT
M$TRTN      75**DCL-ENT
M$TRUNC      18**DCL-ENT
M$TTIMER      71**DCL-ENT
M$UMPL      58**DCL-ENT
M$UNFID      80**DCL-ENT
M$UNLATCH      37**DCL-ENT
M$UNSHARE      34**DCL-ENT
M$USRFIELD      77**DCL-ENT
M$VIRTUAL      52**DCL-ENT
M$WAIT      75**DCL-ENT
M$WEOF      20**DCL-ENT
M$WRITE      18**DCL-ENT
M$WRSYSLOG      66**DCL-ENT
M$XCON      72**DCL-ENT
M$XCONRTN      33**DCL-ENT
M$XEQTIME      85**DCL-ENT
M$XFLUSH      26**DCL-ENT
M$XMOUSE      63**DCL-ENT
M$XXX      29**DCL-ENT
M$YC      31**DCL-ENT
NET$ADDR2IP    3786**DCL-ENT
TCP$READ_NW    3781**DCL-ENT
TCP_ERR_CODE     125**DCL
TCP_MON_ERR     125**DCL

PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:71   
      260        1        /*T***********************************************************/
      261        2        /*T*                                                         */
      262        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      263        4        /*T*                                                         */
      264        5        /*T***********************************************************/
      265        6        GET_RESPONSE: PROC(LCN, RCODE, PRINTIT) ALTRET;
      266        7           %INCLUDE CP_6;
      267       88        %INCLUDE TCF_FTP_E;
      268      143    1   DCL LCN UBIN(36);
      269      144        %RCODE (STCLASS=ALIGNED);
      270      147        %RCODE (NAME=RCODEB, STCLASS=BASED ALIGNED);
      271      150        %FPT_YC (CMD=LET_FTP_RESPONSE);
      272      167    1   DCL 1 LET_FTP_RESPONSE STATIC,
      273      168    1             2 * CHAR(0) INIT('!LET FTP_RESPONSE='),
      274      169    1             2 VALUE CHAR(3);
      275      170        %FPT_WRITE (FPTN=WRITE_LO, STCLASS=SYMREF);
      276      201    1   DCL PRINTIT BIT(1) ALIGNED;
      277      202    1   DCL VERBOSE BIT(1) SYMREF;
      278      203    1   DCL GET_LINE ENTRY(4) ALTRET;
      279      204    1   DCL LINE_BUF CHAR(256);
      280      205    1   DCL ARS UBIN(36);
      281      206    1   DCL CHARN CHAR(CHARNLEN) BASED;
      282      207    1   DCL CHARNLEN UBIN(36);
      283      208
      284      209    2      DO WHILE '1'B;
      285      210    2          CALL GET_LINE (LCN, VECTOR(LINE_BUF), ARS)
      286      211    3          WHENALTRETURN DO;
      287      212    3              LINE_BUF = '421 Remote server has closed connection.';
      288      213    3              ARS = 42;
      289      214    3              END;
      290      215    2   LINE_HERE: ;
      291      216    2          CHARNLEN = ARS-2;                /* Dont include trailing crlf */
      292      217    2          IF ARS > 2
      293      218    2          THEN WRITE_LO.BUF_ = VECTOR(ADDR(LINE_BUF)->CHARN);
      294      219    2          ELSE WRITE_LO.BUF_ = VECTOR(NIL);
      295      220                                                /* Write the message to the user */
      296      221    2          IF PRINTIT THEN CALL M$WRITE (WRITE_LO);
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:72   
      297      222
      298      223                                                /* Now test for valid response */
      299      224
      300      225    2          IF ARS >= 6 THEN
      301      226    2              IF (SUBSTR(LINE_BUF,0,1) >= '0') AND (SUBSTR(LINE_BUF,0,1) <= '5')
      302      227    2                    AND (SUBSTR(LINE_BUF,1,1) >= '0') AND (SUBSTR(LINE_BUF,1,1) <= '9')
      303      228    2                    AND (SUBSTR(LINE_BUF,2,1) >= '0') AND (SUBSTR(LINE_BUF,2,1) <= '9')
      304      229    2                    AND (SUBSTR(LINE_BUF,3,1) = ' ')
      305      230    3              THEN DO;
      306      231    3                  RCODE = ADDR(LINE_BUF)->RCODEB;
      307      232    3                  IF NOT VERBOSE AND ADDR(PRINTIT) = ADDR(VERBOSE)
      308      233    3                        AND RCODE.A > '3' THEN
      309      234    3                      CALL M$WRITE (WRITE_LO);
      310      235    3                  LET_FTP_RESPONSE.VALUE = LINE_BUF;
      311      236    4                  CALL M$YC (FPT_YC) WHENALTRETURN DO; END;
      312      237    3   RETRET:        RETURN;
      313      238    3                  END;
      314      239    2          END;
      315      240
      316      241    1   GET_RESPONSENW: ENTRY(LCN, RCODE, PRINTIT) ALTRET;
      317      242    1      CALL GET_LINE (LCN, VECTOR(LINE_BUF), ARS, 2) ALTRET(RETRET);
      318      243    1      GOTO LINE_HERE;
      319      244
      320      245    1   END GET_RESPONSE;
      321      246
      322      247        %EOD;

PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:73   
--  Include file information  --

   TCF_FTP_E.:TCA2TOU  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GET_RESPONSE.

   Procedure GET_RESPONSE requires 124 words for executable code.
   Procedure GET_RESPONSE requires 80 words of local(AUTO) storage.

PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:74   

 Object Unit name= GET_RESPONSE                               File name= TCF$FTP.:TCA2TOU
 UTS= NOV 16 '97 14:11:37.60 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    14     16  GET_RESPONSE
    2  RoData even  UTS     10     12  GET_RESPONSE
    3   Proc  even  none   124    174  GET_RESPONSE
    4  RoData even  none     6      6  GET_RESPONSE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        3  GET_RESPONSE
     3    150          yes     yes      Std        3  GET_RESPONSENW

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 GET_LINE
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:75   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  WRITE_LO                              VERBOSE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:76   


      260        1        /*T***********************************************************/
      261        2        /*T*                                                         */
      262        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      263        4        /*T*                                                         */
      264        5        /*T***********************************************************/
      265        6        GET_RESPONSE: PROC(LCN, RCODE, PRINTIT) ALTRET;

      6  3 000000   000000 700200 xent  GET_RESPONSE TSX0  ! X66_AUTO_3
         3 000001   000120 000003                    ZERO    80,3

      266        7           %INCLUDE CP_6;
      267       88        %INCLUDE TCF_FTP_E;
      268      143    1   DCL LCN UBIN(36);
      269      144        %RCODE (STCLASS=ALIGNED);
      270      147        %RCODE (NAME=RCODEB, STCLASS=BASED ALIGNED);
      271      150        %FPT_YC (CMD=LET_FTP_RESPONSE);
      272      167    1   DCL 1 LET_FTP_RESPONSE STATIC,
      273      168    1             2 * CHAR(0) INIT('!LET FTP_RESPONSE='),
      274      169    1             2 VALUE CHAR(3);
      275      170        %FPT_WRITE (FPTN=WRITE_LO, STCLASS=SYMREF);
      276      201    1   DCL PRINTIT BIT(1) ALIGNED;
      277      202    1   DCL VERBOSE BIT(1) SYMREF;
      278      203    1   DCL GET_LINE ENTRY(4) ALTRET;
      279      204    1   DCL LINE_BUF CHAR(256);
      280      205    1   DCL ARS UBIN(36);
      281      206    1   DCL CHARN CHAR(CHARNLEN) BASED;
      282      207    1   DCL CHARNLEN UBIN(36);
      283      208
      284      209    2      DO WHILE '1'B;

      285      210    2          CALL GET_LINE (LCN, VECTOR(LINE_BUF), ARS)

    210  3 000002   000000 235000 4                  LDA     0
         3 000003   200110 452500                    STP2    CHARNLEN+1,,AUTO
         3 000004   200110 236100                    LDQ     CHARNLEN+1,,AUTO
         3 000005   000006 036003                    ADLQ    6,DU
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:77   
         3 000006   200112 757100                    STAQ    CHARNLEN+3,,AUTO
         3 000007   200106 630500                    EPPR0   ARS,,AUTO
         3 000010   200116 450500                    STP0    CHARNLEN+7,,AUTO
         3 000011   200112 631500                    EPPR1   CHARNLEN+3,,AUTO
         3 000012   200115 451500                    STP1    CHARNLEN+6,,AUTO
         3 000013   200003 236100                    LDQ     @LCN,,AUTO
         3 000014   200114 756100                    STQ     CHARNLEN+5,,AUTO
         3 000015   200114 630500                    EPPR0   CHARNLEN+5,,AUTO
         3 000016   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000017   000000 701000 xent               TSX1    GET_LINE
         3 000020   000022 702000 3                  TSX2    s:212
         3 000021   000027 710000 3                  TRA     LINE_HERE

      286      211    3          WHENALTRETURN DO;

      287      212    3              LINE_BUF = '421 Remote server has closed connection.';

    212  3 000022   040100 100400                    MLR     fill='040'O
         3 000023   000000 000050 2                  ADSC9   0                        cn=0,n=40
         3 000024   200006 000400                    ADSC9   LINE_BUF,,AUTO           cn=0,n=256

      288      213    3              ARS = 42;

    213  3 000025   000052 235007                    LDA     42,DL
         3 000026   200106 755100                    STA     ARS,,AUTO

      289      214    3              END;

    210  3 000027                       LINE_HERE    null
      290      215    2   LINE_HERE: ;
      291      216    2          CHARNLEN = ARS-2;                /* Dont include trailing crlf */

    216  3 000027   200106 235100                    LDA     ARS,,AUTO
         3 000030   000002 135007                    SBLA    2,DL
         3 000031   200107 755100                    STA     CHARNLEN,,AUTO

      292      217    2          IF ARS > 2
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:78   

    217  3 000032   200106 236100                    LDQ     ARS,,AUTO
         3 000033   000003 116007                    CMPQ    3,DL
         3 000034   000044 602000 3                  TNC     s:219

      293      218    2          THEN WRITE_LO.BUF_ = VECTOR(ADDR(LINE_BUF)->CHARN);

    218  3 000035   000020 735000                    ALS     16
         3 000036   000140 135007                    SBLA    96,DL
         3 000037   200110 452500                    STP2    CHARNLEN+1,,AUTO
         3 000040   200110 236100                    LDQ     CHARNLEN+1,,AUTO
         3 000041   000006 036003                    ADLQ    6,DU
         3 000042   000004 757000 xsym               STAQ    WRITE_LO+4
         3 000043   000046 710000 3                  TRA     s:221

      294      219    2          ELSE WRITE_LO.BUF_ = VECTOR(NIL);

    219  3 000044   000002 237000 4                  LDAQ    2
         3 000045   000004 757000 xsym               STAQ    WRITE_LO+4

      295      220                                                /* Write the message to the user */
      296      221    2          IF PRINTIT THEN CALL M$WRITE (WRITE_LO);

    221  3 000046   200005 470500                    LDP0    @PRINTIT,,AUTO
         3 000047   000000 234100                    SZN     0,,PR0
         3 000050   000054 605000 3                  TPL     s:225

    221  3 000051   000000 630400 xsym               EPPR0   WRITE_LO
         3 000052   040001 713400                    CLIMB   write
         3 000053   401400 401760                    pmme    nvectors=4

      297      222
      298      223                                                /* Now test for valid response */
      299      224
      300      225    2          IF ARS >= 6 THEN

    225  3 000054   200106 235100                    LDA     ARS,,AUTO
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:79   
         3 000055   000006 115007                    CMPA    6,DL
         3 000056   000002 602000 3                  TNC     s:210

      301      226    2              IF (SUBSTR(LINE_BUF,0,1) >= '0') AND (SUBSTR(LINE_BUF,0,1) <= '5')

    226  3 000057   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000060   777000 376003                    ANQ     -512,DU
         3 000061   060000 116003                    CMPQ    24576,DU
         3 000062   000002 602000 3                  TNC     s:210
         3 000063   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000064   777000 376003                    ANQ     -512,DU
         3 000065   065000 116003                    CMPQ    27136,DU
         3 000066   000070 600000 3                  TZE     s:226+9
         3 000067   000002 603000 3                  TRC     s:210
         3 000070   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000071   000777 376003                    ANQ     511,DU
         3 000072   000060 116003                    CMPQ    48,DU
         3 000073   000002 602000 3                  TNC     s:210
         3 000074   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000075   000777 376003                    ANQ     511,DU
         3 000076   000071 116003                    CMPQ    57,DU
         3 000077   000101 600000 3                  TZE     s:226+18
         3 000100   000002 603000 3                  TRC     s:210
         3 000101   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000102   777000 376007                    ANQ     -512,DL
         3 000103   060000 116007                    CMPQ    24576,DL
         3 000104   000002 602000 3                  TNC     s:210
         3 000105   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000106   777000 376007                    ANQ     -512,DL
         3 000107   071000 116007                    CMPQ    29184,DL
         3 000110   000112 600000 3                  TZE     s:226+27
         3 000111   000002 603000 3                  TRC     s:210
         3 000112   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000113   000777 376007                    ANQ     511,DL
         3 000114   000040 116007                    CMPQ    32,DL
         3 000115   000002 601000 3                  TNZ     s:210

PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:80   
      302      227    2                   AND (SUBSTR(LINE_BUF,1,1) >= '0') AND (SUBSTR(LINE_BUF,1,1) <= '9')
      303      228    2                   AND (SUBSTR(LINE_BUF,2,1) >= '0') AND (SUBSTR(LINE_BUF,2,1) <= '9')
      304      229    2                    AND (SUBSTR(LINE_BUF,3,1) = ' ')
      305      230    3              THEN DO;

      306      231    3                  RCODE = ADDR(LINE_BUF)->RCODEB;

    231  3 000116   200006 236100                    LDQ     LINE_BUF,,AUTO
         3 000117   000001 376000 4                  ANQ     1
         3 000120   200004 470500                    LDP0    @RCODE,,AUTO
         3 000121   000000 756100                    STQ     0,,PR0

      307      232    3                  IF NOT VERBOSE AND ADDR(PRINTIT) = ADDR(VERBOSE)

    232  3 000122   000000 234000 xsym               SZN     VERBOSE
         3 000123   000137 604000 3                  TMI     s:235
         3 000124   000004 236000 4                  LDQ     4
         3 000125   200005 116100                    CMPQ    @PRINTIT,,AUTO
         3 000126   000137 601000 3                  TNZ     s:235
         3 000127   000000 236100                    LDQ     0,,PR0
         3 000130   777000 376003                    ANQ     -512,DU
         3 000131   063000 116003                    CMPQ    26112,DU
         3 000132   000137 602000 3                  TNC     s:235
         3 000133   000137 600000 3                  TZE     s:235

      308      233    3                        AND RCODE.A > '3' THEN
      309      234    3                      CALL M$WRITE (WRITE_LO);

    234  3 000134   000000 630400 xsym               EPPR0   WRITE_LO
         3 000135   040001 713400                    CLIMB   write
         3 000136   401400 401760                    pmme    nvectors=4

      310      235    3                  LET_FTP_RESPONSE.VALUE = LINE_BUF;

    235  3 000137   040000 100500                    MLR     fill='040'O
         3 000140   200006 000003                    ADSC9   LINE_BUF,,AUTO           cn=0,n=3
         3 000141   000014 400003 1                  ADSC9   LET_FTP_RESPONSE+4       cn=2,n=3
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:81   

      311      236    4                  CALL M$YC (FPT_YC) WHENALTRETURN DO; END;

    236  3 000142   000000 630400 1                  EPPR0   FPT_YC
         3 000143   400011 713400                    CLIMB   alt,+9
         3 000144   401000 401760                    pmme    nvectors=3
         3 000145   000147 702000 3                  TSX2    RETRET
         3 000146   000147 710000 3                  TRA     RETRET

      312      237    3   RETRET:        RETURN;

    237  3 000147   000000 702200 xent  RETRET       TSX2  ! X66_ARET

      313      238    3                  END;
      314      239    2          END;

      315      240
      316      241    1   GET_RESPONSENW: ENTRY(LCN, RCODE, PRINTIT) ALTRET;

    241  3 000150   000000 700200 xent  GET_RESPONS* TSX0  ! X66_AUTO_3
         3 000151   000120 000003                    ZERO    80,3

      317      242    1      CALL GET_LINE (LCN, VECTOR(LINE_BUF), ARS, 2) ALTRET(RETRET);

    242  3 000152   000000 235000 4                  LDA     0
         3 000153   200110 452500                    STP2    CHARNLEN+1,,AUTO
         3 000154   200110 236100                    LDQ     CHARNLEN+1,,AUTO
         3 000155   000006 036003                    ADLQ    6,DU
         3 000156   200112 757100                    STAQ    CHARNLEN+3,,AUTO
         3 000157   000005 236000 4                  LDQ     5
         3 000160   200117 756100                    STQ     CHARNLEN+8,,AUTO
         3 000161   200106 630500                    EPPR0   ARS,,AUTO
         3 000162   200116 450500                    STP0    CHARNLEN+7,,AUTO
         3 000163   200112 631500                    EPPR1   CHARNLEN+3,,AUTO
         3 000164   200115 451500                    STP1    CHARNLEN+6,,AUTO
         3 000165   200003 236100                    LDQ     @LCN,,AUTO
         3 000166   200114 756100                    STQ     CHARNLEN+5,,AUTO
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:82   
         3 000167   200114 630500                    EPPR0   CHARNLEN+5,,AUTO
         3 000170   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000171   000000 701000 xent               TSX1    GET_LINE
         3 000172   000147 702000 3                  TSX2    RETRET

      318      243    1      GOTO LINE_HERE;

    243  3 000173   000027 710000 3                  TRA     LINE_HERE

FPT_YC
 Sect OctLoc
   1     000   000005 177640   000010 006000   000001 777640   000006 006000    ................
   1     004   000000 177640   000000 006014   000000 000000   0***** ******    ................

LET_FTP_RESPONSE
 Sect OctLoc
   1     010   041114 105124   040106 124120   137122 105123   120117 116123    !LET FTP_RESPONS
   1     014   105075 ******   ****** ******                                    E=......

(unnamed)
 Sect OctLoc
   2     000   064062 061040   122145 155157   164145 040163   145162 166145    421 Remote serve
   2     004   162040 150141   163040 143154   157163 145144   040143 157156    r has closed con
   2     010   156145 143164   151157 156056                                    nection.

(unnamed)
 Sect OctLoc
   4     000   000077 777640   777777 777000   000000 177640   000000 006014    .?..............
   4     004   000000 006000   000004 006000                                    ........
      319      244
      320      245    1   END GET_RESPONSE;
      321      246
      322      247        %EOD;

PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:83   
--  Include file information  --

   TCF_FTP_E.:TCA2TOU  is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GET_RESPONSE.
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:84   

 **** Variables and constants ****

  ****  Section 001  Data  GET_RESPONSE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(288)   r     1 FPT_YC                    10-0-0/c STRC(189)   r     1 LET_FTP_RESPONSE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @LCN                       5-0-0/w PTR         r     1 @PRINTIT
     4-0-0/w PTR         r     1 @RCODE                   106-0-0/w UBIN        r     1 ARS
   107-0-0/w UBIN        r     1 CHARNLEN                  *0-0-0/w UBIN        r     1 LCN
     6-0-0/c CHAR(256)   r     1 LINE_BUF                  *0-0-0/w BIT         r     1 PRINTIT
    *0-0-0/w STRC(27)    r     1 RCODE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 VERBOSE                    0-0-0/d STRC(432)   r     1 WRITE_LO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 CHARN                      0-0-0/w STRC(27)    r     1 RCODEB


   Procedure GET_RESPONSE requires 124 words for executable code.
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:85   
   Procedure GET_RESPONSE requires 80 words of local(AUTO) storage.
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:86   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:87   
          MINI XREF LISTING

ARS
       205**DCL       210<>CALL      213<<ASSIGN    216>>ASSIGN    217>>IF        225>>IF        242<>CALL
CHARN
       206**DCL       218--ASSIGN
CHARNLEN
       207**DCL       206--IMP-SIZ   216<<ASSIGN    218>>ASSIGN
FPT_YC
       163**DCL       236<>CALL
FPT_YC.V
       164**DCL       163--DCLINIT
GET_LINE
       203**DCL-ENT   210--CALL      242--CALL
LCN
       143**DCL         6--PROC      210<>CALL      241--ENTRY     242<>CALL
LET_FTP_RESPONSE
       167**DCL       163--DCLINIT
LET_FTP_RESPONSE.VALUE
       169**DCL       235<<ASSIGN
LINE_BUF
       204**DCL       210--CALL      212<<ASSIGN    218--ASSIGN    226>>IF        226>>IF        226>>IF
       226>>IF        226>>IF        226>>IF        226>>IF        231--ASSIGN    235>>ASSIGN    242--CALL
LINE_HERE
       210**LABEL     243--GOTO
M$WRITE
        17**DCL-ENT   221--CALL      234--CALL
M$YC
        30**DCL-ENT   236--CALL
PRINTIT
       201**DCL         6--PROC      221>>IF        232--IF        241--ENTRY
RCODE
       145**DCL         6--PROC      231<<ASSIGN    241--ENTRY
RCODE.A
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:88   
       145**DCL       232>>IF
RCODEB
       148**DCL       231>>ASSIGN
RETRET
       237**LABEL     242--CALLALT
VERBOSE
       202**DCL       232>>IF        232--IF
WRITE_LO
       187**DCL       221<>CALL      234<>CALL
WRITE_LO.BUF_
       187**DCL       218<<ASSIGN    219<<ASSIGN
WRITE_LO.STATION_
       189**DCL       189--REDEF
WRITE_LO.V.DVBYTE.VFC#
       196**DCL       196--REDEF
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:89   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:90   
              MINI UREF LISTING

GET_RESPONSE       6**PROC
GET_RESPONSENW     241**ENTRY
M$ACCT      33**DCL-ENT
M$ACTIVATE      36**DCL-ENT
M$ALIB      29**DCL-ENT
M$ASUSER      31**DCL-ENT
M$ATTACH      38**DCL-ENT
M$BADPP      56**DCL-ENT
M$CGCTL      37**DCL-ENT
M$CGINFO      37**DCL-ENT
M$CHECK      18**DCL-ENT
M$CHGUNIT      76**DCL-ENT
M$CLOSE      16**DCL-ENT
M$CLRSTK      74**DCL-ENT
M$CMDVAR      85**DCL-ENT
M$CONFIG      46**DCL-ENT
M$CORRES      21**DCL-ENT
M$CPEXIT      30**DCL-ENT
M$CVM      54**DCL-ENT
M$CVOL      19**DCL-ENT
M$DCLFLD      46**DCL-ENT
M$DEACTIVATE      36**DCL-ENT
M$DELREC      18**DCL-ENT
M$DEQ      83**DCL-ENT
M$DETACH      38**DCL-ENT
M$DEVICE      20**DCL-ENT
M$DISPLAY      83**DCL-ENT
M$DISPRES      23**DCL-ENT
M$DLIB      29**DCL-ENT
M$DRIBBLE      46**DCL-ENT
M$DRTN      74**DCL-ENT
M$DSUSER      31**DCL-ENT
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:91   
M$ENQ      82**DCL-ENT
M$EOM      41**DCL-ENT
M$ERASE      47**DCL-ENT
M$ERR      28**DCL-ENT
M$ERRMSG      79**DCL-ENT
M$EVENT      71**DCL-ENT
M$EXHUME      80**DCL-ENT
M$EXIT      28**DCL-ENT
M$EXTEND      20**DCL-ENT
M$FDP      52**DCL-ENT
M$FDS      51**DCL-ENT
M$FEBOOT      44**DCL-ENT
M$FECTL      45**DCL-ENT
M$FEDUMP      44**DCL-ENT
M$FID      79**DCL-ENT
M$FINDPROC      33**DCL-ENT
M$FSUSER      31**DCL-ENT
M$FVP      53**DCL-ENT
M$FWCG      37**DCL-ENT
M$GBPL      57**DCL-ENT
M$GDDL      53**DCL-ENT
M$GDP      52**DCL-ENT
M$GDS      51**DCL-ENT
M$GETDCB      22**DCL-ENT
M$GETMOUSE      62**DCL-ENT
M$GETPM      63**DCL-ENT
M$GJOB      81**DCL-ENT
M$GLINEATTR      41**DCL-ENT
M$GOODPP      56**DCL-ENT
M$GPLATEN      49**DCL-ENT
M$GPROMPT      48**DCL-ENT
M$GTRMATTR      42**DCL-ENT
M$GTRMCTL      40**DCL-ENT
M$GTRMTAB      43**DCL-ENT
M$GVP      52**DCL-ENT
M$HELP      79**DCL-ENT
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:92   
M$INT      71**DCL-ENT
M$INTRTN      32**DCL-ENT
M$IOQ      67**DCL-ENT
M$JOBSTATS      81**DCL-ENT
M$KEYIN      21**DCL-ENT
M$LDEV      16**DCL-ENT
M$LDTRC      29**DCL-ENT
M$LIMIT      22**DCL-ENT
M$LINES      21**DCL-ENT
M$LINK      28**DCL-ENT
M$MADMUCK      24**DCL-ENT
M$MAKUSER      55**DCL-ENT
M$MBS      23**DCL-ENT
M$MDFFLD      47**DCL-ENT
M$MERC      72**DCL-ENT
M$MERCS      73**DCL-ENT
M$MIRROR      67**DCL-ENT
M$MONINFO      84**DCL-ENT
M$MPL      57**DCL-ENT
M$NODEINFO      48**DCL-ENT
M$NXTUSR      82**DCL-ENT
M$OCMSG      80**DCL-ENT
M$OLAY      28**DCL-ENT
M$OPEN      16**DCL-ENT
M$PAS      57**DCL-ENT
M$PATHCON      80**DCL-ENT
M$PDS      51**DCL-ENT
M$PFIL      18**DCL-ENT
M$PLATEN      42**DCL-ENT
M$PRECORD      20**DCL-ENT
M$PROCNAME      33**DCL-ENT
M$PROFILE      44**DCL-ENT
M$PROMPT      40**DCL-ENT
M$RACST      24**DCL-ENT
M$RDSYSLOG      65**DCL-ENT
M$READ      17**DCL-ENT
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:93   
M$RELDCB      22**DCL-ENT
M$RELRES      23**DCL-ENT
M$RELSTARF      25**DCL-ENT
M$REM      25**DCL-ENT
M$RENV      72**DCL-ENT
M$REQUIRE      24**DCL-ENT
M$RETRY      73**DCL-ENT
M$RETRYS      73**DCL-ENT
M$REW      19**DCL-ENT
M$RLSFLD      47**DCL-ENT
M$RPRIV      75**DCL-ENT
M$RSPP      54**DCL-ENT
M$RSWITCH      76**DCL-ENT
M$RUE      82**DCL-ENT
M$SAD      55**DCL-ENT
M$SAVE      31**DCL-ENT
M$SCON      32**DCL-ENT
M$SCREECH      30**DCL-ENT
M$SENV      72**DCL-ENT
M$SETFMA      16**DCL-ENT
M$SETFP      45**DCL-ENT
M$SINPUT      43**DCL-ENT
M$SLCFLD      48**DCL-ENT
M$SMOUSE      62**DCL-ENT
M$SMPRT      54**DCL-ENT
M$SPRIV      75**DCL-ENT
M$SSC      55**DCL-ENT
M$SSWITCH      75**DCL-ENT
M$STATE      84**DCL-ENT
M$STD      56**DCL-ENT
M$STIMER      70**DCL-ENT
M$STLPP      53**DCL-ENT
M$STRAP      70**DCL-ENT
M$STRMATTR      42**DCL-ENT
M$STRMCTL      40**DCL-ENT
M$STRMTAB      43**DCL-ENT
PL6.E3A0      #003=GET_RESPONSE File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:11 Page:94   
M$SYMBIO      81**DCL-ENT
M$SYSCON      67**DCL-ENT
M$SYSID      85**DCL-ENT
M$TDCLOSE      66**DCL-ENT
M$TDIO      66**DCL-ENT
M$TDOPEN      65**DCL-ENT
M$TDREQCPU      66**DCL-ENT
M$TEMPWROC      60**DCL-ENT
M$TIME      83**DCL-ENT
M$TRAP      70**DCL-ENT
M$TRMISC      45**DCL-ENT
M$TRMPRG      41**DCL-ENT
M$TRTN      74**DCL-ENT
M$TRUNC      17**DCL-ENT
M$TTIMER      70**DCL-ENT
M$UC      40**DCL
M$UMPL      57**DCL-ENT
M$UNFID      79**DCL-ENT
M$UNLATCH      36**DCL-ENT
M$UNSHARE      33**DCL-ENT
M$USRFIELD      76**DCL-ENT
M$VIRTUAL      51**DCL-ENT
M$WAIT      74**DCL-ENT
M$WEOF      19**DCL-ENT
M$WRSYSLOG      65**DCL-ENT
M$XCON      71**DCL-ENT
M$XCONRTN      32**DCL-ENT
M$XEQTIME      84**DCL-ENT
M$XFLUSH      25**DCL-ENT
M$XMOUSE      62**DCL-ENT
M$XXX      28**DCL-ENT

PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:95   
      323        1        /*T***********************************************************/
      324        2        /*T*                                                         */
      325        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      326        4        /*T*                                                         */
      327        5        /*T***********************************************************/
      328        6
      329        7        GET_LINE: PROC(LCN, BUF_, ARS,  TIMEOUT) ALTRET;
      330        8        %INCLUDE CP_6;
      331       89        %INCLUDE TCP_HEP_M;
      332      144        %INCLUDE TCP_HEP_E;
      333      221        %INCLUDE TCT_TELNET_E;
      334      276
      335      277    1   DCL LCN UBIN(36);
      336      278    1   DCL BUF_ VECTOR;
      337      279    1   DCL ARS UBIN(36);
      338      280    1   DCL TIMEOUT UBIN(36);
      339      281    1   DCL C CHAR(1) BASED;
      340      282    1   DCL TCP$READ ENTRY(3) ALTRET;
      341      283    1   DCL TCP$READ_NW ENTRY(3) ALTRET;
      342      284    1   DCL IP$WAIT ENTRY(2);
      343      285        %TCP$CB (NAME=CB, STCLASS=STATIC);
      344      288    1   DCL REMOTE_IAC BIT(1) STATIC INIT('0'B);
      345      289    1   DCL REMOTE_OPTION BIT(1) STATIC INIT('0'B);
      346      290    1   DCL TELNET_INBUF CHAR(1600) STATIC;
      347      291    1   DCL BUFLCN UBIN STATIC INIT(0);
      348      292    1   DCL BUFX SBIN STATIC INIT(0);
      349      293    1   DCL BUFL SBIN STATIC INIT(0);
      350      294    1   DCL TO_USER$ PTR;
      351      295    1   DCL CRFLAG BIT(1) STATIC INIT('0'B);
      352      296    1   DCL UBUFX SBIN;
      353      297    1   DCL MAX_BYTES UBIN(36) STATIC;
      354      298
      355      299    1      TO_USER$ = VBASE(BUF_);
      356      300    1      MAX_BYTES = VBOUND(BUF_)+1;
      357      301
      358      302    1      UBUFX = 0;
      359      303    2      IF LCN~=BUFLCN THEN DO;
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:96   
      360      304    2          BUFLCN = LCN;
      361      305    2          BUFL = 0;
      362      306    2          CRFLAG = '0'B;
      363      307    2          REMOTE_IAC = '0'B;
      364      308    2          REMOTE_OPTION = '0'B;
      365      309    2          END;
      366      310    2      IF CRFLAG THEN DO; /* Put cr in this buffer, since we took it out before */
      367      311    2          TO_USER$->C = %CP6_CR;
      368      312    2          UBUFX = 1;
      369      313    2          END;
      370      314
      371      315    2      DO WHILE UBUFX<MAX_BYTES;
      372      316    2          IF BUFL<=BUFX
      373      317    3          THEN DO;
      374      318    4              IF ADDR(TIMEOUT) ~= ADDR(NIL) AND TIMEOUT > 0 THEN DO;
      375      319    4                  CALL TCP$READ_NW (BUFLCN, VECTOR(TELNET_INBUF), CB) ALTRET(RETALT);
      376      320    4                  CALL IP$WAIT (TIMEOUT);
      377      321    4                  IF NOT CB.READ_COMPLETE THEN GOTO RETALT;
      378      322    4                  END;
      379      323    4              ELSE CALL TCP$READ (BUFLCN, VECTOR(TELNET_INBUF), CB) WHENALTRETURN DO;
      380      324    4   RETALT:            ARS = 0;
      381      325    4                      ALTRETURN;
      382      326    4                      END;
      383      327    4              IF CB.ADMIN THEN DO;
      384      328        /*             Call REMOTE_ADMIN(ADDR(TELNET_INBUF)); */
      385      329    4                  IF UBUFX=0 THEN ALTRETURN;
      386      330    4                  SUBSTR(TELNET_INBUF,0,2) = %CONCAT (CP6_CR, CP6_LF);
      387      331    4                  REMOTE_IAC = '0'B;
      388      332    4                  REMOTE_OPTION = '0'B;
      389      333    4                  CB.ARS = 2;
      390      334    4                  END;
      391      335    3              BUFX = 0;
      392      336    3              BUFL = CB.ARS;
      393      337    3              END;
      394      338
      395      339    3          IF REMOTE_IAC THEN DO;
      396      340    3              REMOTE_IAC = '0'B;
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:97   
      397      341    4              DO SELECT (SUBSTR(TELNET_INBUF,BUFX,1));
      398      342    4                  SELECT (%TELNET_IAC);
      399      343    4                  GOTO COPY_CHAR;
      400      344    4                  SELECT (%TELNET_WILL, %TELNET_WONT, %TELNET_DO, %TELNET_DONT);
      401      345    4                  REMOTE_OPTION = '1'B;
      402      346    4                  END;                     /* Ignore commands */
      403      347    3              END;
      404      348    2          ELSE IF REMOTE_OPTION
      405      349    2              THEN REMOTE_OPTION = '0'B;   /* Ignore options */
      406      350    2              ELSE IF SUBSTR(TELNET_INBUF,BUFX,1) = %TELNET_IAC
      407      351    2                  THEN REMOTE_IAC = '1'B;
      408      352    3                  ELSE DO;
      409      353    4                      IF CRFLAG THEN DO;
      410      354    4                          IF SUBSTR(TELNET_INBUF,BUFX,1) = BINASC(0)
      411      355    4                          THEN GOTO SKIP_CHAR;
      412      356    4                          IF SUBSTR(TELNET_INBUF,BUFX,1) = %CP6_LF
      413      357    4                          THEN MAX_BYTES = 0;
      414      358    4                          END;
      415      359    3                      IF SUBSTR(TELNET_INBUF,BUFX,1) = %CP6_CR THEN CRFLAG='1'B;
      416      360    3                      ELSE CRFLAG='0'B;
      417      361    3   COPY_CHAR:         PINCRC(TO_USER$, UBUFX)->C = SUBSTR(TELNET_INBUF,BUFX,1);
      418      362    3                      UBUFX = UBUFX + 1;
      419      363    3                      END;
      420      364    2   SKIP_CHAR: ;
      421      365    2          BUFX = BUFX + 1;
      422      366    2          END;
      423      367    1      IF MAX_BYTES>0 THEN UBUFX = UBUFX+2; /* Indicate failure to terminate */
      424      368    1      IF CRFLAG THEN UBUFX = UBUFX-1; /* Don't end with a cr, wait for next call */
      425      369    1      ARS = UBUFX;
      426      370
      427      371    1      RETURN;
      428      372    1   END GET_LINE;
      429      373
      430      374        %EOD;

PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:98   
--  Include file information  --

   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GET_LINE.

   Procedure GET_LINE requires 160 words for executable code.
   Procedure GET_LINE requires 10 words of local(AUTO) storage.

PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:99   

 Object Unit name= GET_LINE                                   File name= TCF$FTP.:TCA2TOU
 UTS= NOV 16 '97 14:12:09.88 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   412    634  GET_LINE
    2  RoData even  UTS      1      1  GET_LINE
    3   Proc  even  none   160    240  GET_LINE
    4  RoData even  none    13     15  GET_LINE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        4  GET_LINE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 TCP$READ_NW
         yes           Std       2 IP$WAIT
 yes     yes           Std       3 TCP$READ
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:100  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:101  


      323        1        /*T***********************************************************/
      324        2        /*T*                                                         */
      325        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      326        4        /*T*                                                         */
      327        5        /*T***********************************************************/
      328        6
      329        7        GET_LINE: PROC(LCN, BUF_, ARS,  TIMEOUT) ALTRET;

      7  3 000000   000000 700200 xent  GET_LINE     TSX0  ! X66_AUTO_4
         3 000001   000012 000004                    ZERO    10,4

      330        8        %INCLUDE CP_6;
      331       89        %INCLUDE TCP_HEP_M;
      332      144        %INCLUDE TCP_HEP_E;
      333      221        %INCLUDE TCT_TELNET_E;
      334      276
      335      277    1   DCL LCN UBIN(36);
      336      278    1   DCL BUF_ VECTOR;
      337      279    1   DCL ARS UBIN(36);
      338      280    1   DCL TIMEOUT UBIN(36);
      339      281    1   DCL C CHAR(1) BASED;
      340      282    1   DCL TCP$READ ENTRY(3) ALTRET;
      341      283    1   DCL TCP$READ_NW ENTRY(3) ALTRET;
      342      284    1   DCL IP$WAIT ENTRY(2);
      343      285        %TCP$CB (NAME=CB, STCLASS=STATIC);
      344      288    1   DCL REMOTE_IAC BIT(1) STATIC INIT('0'B);
      345      289    1   DCL REMOTE_OPTION BIT(1) STATIC INIT('0'B);
      346      290    1   DCL TELNET_INBUF CHAR(1600) STATIC;
      347      291    1   DCL BUFLCN UBIN STATIC INIT(0);
      348      292    1   DCL BUFX SBIN STATIC INIT(0);
      349      293    1   DCL BUFL SBIN STATIC INIT(0);
      350      294    1   DCL TO_USER$ PTR;
      351      295    1   DCL CRFLAG BIT(1) STATIC INIT('0'B);
      352      296    1   DCL UBUFX SBIN;
      353      297    1   DCL MAX_BYTES UBIN(36) STATIC;
      354      298
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:102  
      355      299    1      TO_USER$ = VBASE(BUF_);

    299  3 000002   200004 470500                    LDP0    @BUF_,,AUTO
         3 000003   000001 236100                    LDQ     1,,PR0
         3 000004   200007 756100                    STQ     TO_USER$,,AUTO

      356      300    1      MAX_BYTES = VBOUND(BUF_)+1;

    300  3 000005   000000 236100                    LDQ     0,,PR0
         3 000006   000020 772000                    QRL     16
         3 000007   000001 036007                    ADLQ    1,DL
         3 000010   000633 756000 1                  STQ     MAX_BYTES

      357      301
      358      302    1      UBUFX = 0;

    302  3 000011   200010 450100                    STZ     UBUFX,,AUTO

      359      303    2      IF LCN~=BUFLCN THEN DO;

    303  3 000012   200003 471500                    LDP1    @LCN,,AUTO
         3 000013   100000 236100                    LDQ     0,,PR1
         3 000014   000627 116000 1                  CMPQ    BUFLCN
         3 000015   000023 600000 3                  TZE     s:310

      360      304    2          BUFLCN = LCN;

    304  3 000016   000627 756000 1                  STQ     BUFLCN

      361      305    2          BUFL = 0;

    305  3 000017   000631 450000 1                  STZ     BUFL

      362      306    2          CRFLAG = '0'B;

    306  3 000020   000632 450000 1                  STZ     CRFLAG

PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:103  
      363      307    2          REMOTE_IAC = '0'B;

    307  3 000021   000005 450000 1                  STZ     REMOTE_IAC

      364      308    2          REMOTE_OPTION = '0'B;

    308  3 000022   000006 450000 1                  STZ     REMOTE_OPTION

      365      309    2          END;

      366      310    2      IF CRFLAG THEN DO; /* Put cr in this buffer, since we took it out before */

    310  3 000023   000632 234000 1                  SZN     CRFLAG
         3 000024   000033 605000 3                  TPL     s:315

      367      311    2          TO_USER$->C = %CP6_CR;

    311  3 000025   200007 473500                    LDP3    TO_USER$,,AUTO
         3 000026   040100 100400                    MLR     fill='040'O
         3 000027   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000030   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

      368      312    2          UBUFX = 1;

    312  3 000031   000001 235007                    LDA     1,DL
         3 000032   200010 755100                    STA     UBUFX,,AUTO

      369      313    2          END;

      370      314
      371      315    2      DO WHILE UBUFX<MAX_BYTES;

    315  3 000033   200010 236100                    LDQ     UBUFX,,AUTO
         3 000034   000037 604000 3                  TMI     s:316
         3 000035   000633 116000 1                  CMPQ    MAX_BYTES
         3 000036   000224 603000 3                  TRC     s:367

PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:104  
      372      316    2          IF BUFL<=BUFX

    316  3 000037   000631 236000 1                  LDQ     BUFL
         3 000040   000630 116000 1                  CMPQ    BUFX
         3 000041   000111 605400 3                  TPNZ    s:339

      373      317    3          THEN DO;

      374      318    4              IF ADDR(TIMEOUT) ~= ADDR(NIL) AND TIMEOUT > 0 THEN DO;

    318  3 000042   200006 236100                    LDQ     @TIMEOUT,,AUTO
         3 000043   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000044   000063 600000 3                  TZE     s:323
         3 000045   200006 470500                    LDP0    @TIMEOUT,,AUTO
         3 000046   000000 235100                    LDA     0,,PR0
         3 000047   000063 600000 3                  TZE     s:323

      375      319    4                  CALL TCP$READ_NW (BUFLCN, VECTOR(TELNET_INBUF), CB) ALTRET(RETALT);

    319  3 000050   000004 630400 4                  EPPR0   4
         3 000051   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000052   000000 701000 xent               TSX1    TCP$READ_NW
         3 000053   000070 702000 3                  TSX2    RETALT

      376      320    4                  CALL IP$WAIT (TIMEOUT);

    320  3 000054   200006 630500                    EPPR0   @TIMEOUT,,AUTO
         3 000055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000056   000000 701000 xent               TSX1    IP$WAIT
         3 000057   000000 011000                    NOP     0

      377      321    4                  IF NOT CB.READ_COMPLETE THEN GOTO RETALT;

    321  3 000060   000003 234000 1                  SZN     CB+3
         3 000061   000070 605000 3                  TPL     RETALT

      378      322    4                  END;
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:105  

    322  3 000062   000073 710000 3                  TRA     s:327

      379      323    4              ELSE CALL TCP$READ (BUFLCN, VECTOR(TELNET_INBUF), CB) WHENALTRETURN DO;

    323  3 000063   000004 630400 4                  EPPR0   4
         3 000064   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000065   000000 701000 xent               TSX1    TCP$READ
         3 000066   000070 702000 3                  TSX2    RETALT
         3 000067   000073 710000 3                  TRA     s:327

      380      324    4   RETALT:            ARS = 0;

    324  3 000070   200005 470500       RETALT       LDP0    @ARS,,AUTO
         3 000071   000000 450100                    STZ     0,,PR0

      381      325    4                      ALTRETURN;

    325  3 000072   000000 702200 xent               TSX2  ! X66_AALT

      382      326    4                      END;
      383      327    4              IF CB.ADMIN THEN DO;

    327  3 000073   000000 234000 1                  SZN     CB
         3 000074   000106 605000 3                  TPL     s:335

      384      328        /*             Call REMOTE_ADMIN(ADDR(TELNET_INBUF)); */
      385      329    4                  IF UBUFX=0 THEN ALTRETURN;

    329  3 000075   200010 235100                    LDA     UBUFX,,AUTO
         3 000076   000100 601000 3                  TNZ     s:330

    329  3 000077   000000 702200 xent               TSX2  ! X66_AALT

      386      330    4                  SUBSTR(TELNET_INBUF,0,2) = %CONCAT (CP6_CR, CP6_LF);

    330  3 000100   000000 220000 2                  LDX0    0
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:106  
         3 000101   000007 740000 1                  STX0    TELNET_INBUF

      387      331    4                  REMOTE_IAC = '0'B;

    331  3 000102   000005 450000 1                  STZ     REMOTE_IAC

      388      332    4                  REMOTE_OPTION = '0'B;

    332  3 000103   000006 450000 1                  STZ     REMOTE_OPTION

      389      333    4                  CB.ARS = 2;

    333  3 000104   000002 236007                    LDQ     2,DL
         3 000105   000001 756000 1                  STQ     CB+1

      390      334    4                  END;

      391      335    3              BUFX = 0;

    335  3 000106   000630 450000 1                  STZ     BUFX

      392      336    3              BUFL = CB.ARS;

    336  3 000107   000001 235000 1                  LDA     CB+1
         3 000110   000631 755000 1                  STA     BUFL

      393      337    3              END;

      394      338
      395      339    3          IF REMOTE_IAC THEN DO;

    339  3 000111   000005 234000 1                  SZN     REMOTE_IAC
         3 000112   000152 605000 3                  TPL     s:348

      396      340    3              REMOTE_IAC = '0'B;

    340  3 000113   000005 450000 1                  STZ     REMOTE_IAC
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:107  

      397      341    4              DO SELECT (SUBSTR(TELNET_INBUF,BUFX,1));

    341  3 000114   000630 235000 1                  LDA     BUFX
         3 000115   040000 106405                    CMPC    fill='040'O
         3 000116   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000117   000001 000001 4                  ADSC9   1                        cn=0,n=1
         3 000120   000141 602000 3                  TNC     s:341+21
         3 000121   000147 600000 3                  TZE     s:345
         3 000122   040000 106405                    CMPC    fill='040'O
         3 000123   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000124   000007 000001 4                  ADSC9   7                        cn=0,n=1
         3 000125   000134 602000 3                  TNC     s:341+16
         3 000126   000147 600000 3                  TZE     s:345
         3 000127   040000 106405                    CMPC    fill='040'O
         3 000130   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000131   000010 000001 4                  ADSC9   8                        cn=0,n=1
         3 000132   000217 601000 3                  TNZ     SKIP_CHAR
         3 000133   000146 710000 3                  TRA     s:343
         3 000134   040000 106405                    CMPC    fill='040'O
         3 000135   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000136   000011 000001 4                  ADSC9   9                        cn=0,n=1
         3 000137   000217 601000 3                  TNZ     SKIP_CHAR
         3 000140   000147 710000 3                  TRA     s:345
         3 000141   040000 106405                    CMPC    fill='040'O
         3 000142   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000143   000012 000001 4                  ADSC9   10                       cn=0,n=1
         3 000144   000217 601000 3                  TNZ     SKIP_CHAR
         3 000145   000147 710000 3                  TRA     s:345

      398      342    4                  SELECT (%TELNET_IAC);

      399      343    4                  GOTO COPY_CHAR;

    343  3 000146   000211 710000 3                  TRA     COPY_CHAR

      400      344    4                  SELECT (%TELNET_WILL, %TELNET_WONT, %TELNET_DO, %TELNET_DONT);
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:108  

      401      345    4                  REMOTE_OPTION = '1'B;

    345  3 000147   400000 236003                    LDQ     -131072,DU
         3 000150   000006 756000 1                  STQ     REMOTE_OPTION

      402      346    4                  END;                     /* Ignore commands */

      403      347    3              END;

    347  3 000151   000217 710000 3                  TRA     SKIP_CHAR

      404      348    2          ELSE IF REMOTE_OPTION

    348  3 000152   000006 234000 1                  SZN     REMOTE_OPTION
         3 000153   000156 605000 3                  TPL     s:350

      405      349    2              THEN REMOTE_OPTION = '0'B;   /* Ignore options */

    349  3 000154   000006 450000 1                  STZ     REMOTE_OPTION
         3 000155   000217 710000 3                  TRA     SKIP_CHAR

      406      350    2              ELSE IF SUBSTR(TELNET_INBUF,BUFX,1) = %TELNET_IAC

    350  3 000156   000630 235000 1                  LDA     BUFX
         3 000157   040000 106405                    CMPC    fill='040'O
         3 000160   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000161   000010 000001 4                  ADSC9   8                        cn=0,n=1
         3 000162   000166 601000 3                  TNZ     s:353

      407      351    2                  THEN REMOTE_IAC = '1'B;

    351  3 000163   400000 236003                    LDQ     -131072,DU
         3 000164   000005 756000 1                  STQ     REMOTE_IAC
         3 000165   000217 710000 3                  TRA     SKIP_CHAR

      408      352    3                  ELSE DO;
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:109  

      409      353    4                      IF CRFLAG THEN DO;

    353  3 000166   000632 234000 1                  SZN     CRFLAG
         3 000167   000201 605000 3                  TPL     s:359

      410      354    4                          IF SUBSTR(TELNET_INBUF,BUFX,1) = BINASC(0)

    354  3 000170   040000 106405                    CMPC    fill='040'O
         3 000171   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000172   000013 000001 4                  ADSC9   11                       cn=0,n=1
         3 000173   000217 600000 3                  TZE     SKIP_CHAR

      411      355    4                          THEN GOTO SKIP_CHAR;
      412      356    4                          IF SUBSTR(TELNET_INBUF,BUFX,1) = %CP6_LF

    356  3 000174   040000 106405                    CMPC    fill='040'O
         3 000175   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000176   000014 000001 4                  ADSC9   12                       cn=0,n=1
         3 000177   000201 601000 3                  TNZ     s:359

      413      357    4                          THEN MAX_BYTES = 0;

    357  3 000200   000633 450000 1                  STZ     MAX_BYTES

      414      358    4                          END;

      415      359    3                      IF SUBSTR(TELNET_INBUF,BUFX,1) = %CP6_CR THEN CRFLAG='1'B;

    359  3 000201   040000 106405                    CMPC    fill='040'O
         3 000202   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000203   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000204   000210 601000 3                  TNZ     s:360

    359  3 000205   400000 236003                    LDQ     -131072,DU
         3 000206   000632 756000 1                  STQ     CRFLAG
         3 000207   000211 710000 3                  TRA     COPY_CHAR
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:110  

      416      360    3                      ELSE CRFLAG='0'B;

    360  3 000210   000632 450000 1                  STZ     CRFLAG

      417      361    3   COPY_CHAR:         PINCRC(TO_USER$, UBUFX)->C = SUBSTR(TELNET_INBUF,BUFX,1);

    361  3 000211   200007 470500       COPY_CHAR    LDP0    TO_USER$,,AUTO
         3 000212   200010 236100                    LDQ     UBUFX,,AUTO
         3 000213   040106 100405                    MLR     fill='040'O
         3 000214   000007 000001 1                  ADSC9   TELNET_INBUF,A           cn=0,n=1
         3 000215   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

      418      362    3                      UBUFX = UBUFX + 1;

    362  3 000216   200010 054100                    AOS     UBUFX,,AUTO

      419      363    3                      END;

    361  3 000217                       SKIP_CHAR    null
      420      364    2   SKIP_CHAR: ;
      421      365    2          BUFX = BUFX + 1;

    365  3 000217   000630 054000 1                  AOS     BUFX

      422      366    2          END;

    366  3 000220   200010 236100                    LDQ     UBUFX,,AUTO
         3 000221   000037 604000 3                  TMI     s:316
         3 000222   000633 116000 1                  CMPQ    MAX_BYTES
         3 000223   000037 602000 3                  TNC     s:316

      423      367    1      IF MAX_BYTES>0 THEN UBUFX = UBUFX+2; /* Indicate failure to terminate */

    367  3 000224   000633 235000 1                  LDA     MAX_BYTES
         3 000225   000230 600000 3                  TZE     s:368

PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:111  
    367  3 000226   000002 236007                    LDQ     2,DL
         3 000227   200010 056100                    ASQ     UBUFX,,AUTO

      424      368    1      IF CRFLAG THEN UBUFX = UBUFX-1; /* Don't end with a cr, wait for next call */

    368  3 000230   000632 234000 1                  SZN     CRFLAG
         3 000231   000234 605000 3                  TPL     s:369

    368  3 000232   000001 336007                    LCQ     1,DL
         3 000233   200010 056100                    ASQ     UBUFX,,AUTO

      425      369    1      ARS = UBUFX;

    369  3 000234   200010 236100                    LDQ     UBUFX,,AUTO
         3 000235   200005 470500                    LDP0    @ARS,,AUTO
         3 000236   000000 756100                    STQ     0,,PR0

      426      370
      427      371    1      RETURN;

    371  3 000237   000000 702200 xent               TSX2  ! X66_ARET

CB
 Sect OctLoc
   1     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

REMOTE_IAC
 Sect OctLoc
   1     005   0***** ******                                                    ....

REMOTE_OPTION
 Sect OctLoc
   1     006   0***** ******                                                    ....

TELNET_INBUF
 Sect OctLoc
   1     007   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:112  

BUFLCN
 Sect OctLoc
   1     627   000000 000000                                                    ....

BUFX
 Sect OctLoc
   1     630   000000 000000                                                    ....

BUFL
 Sect OctLoc
   1     631   000000 000000                                                    ....

CRFLAG
 Sect OctLoc
   1     632   0***** ******                                                    ....

(unnamed)
 Sect OctLoc
   2     000   015012 040040                                                    ..

(unnamed)
 Sect OctLoc
   4     000   015040 040040   374040 040040   000617 777640   000007 006000    .   .   ........
   4     004   000627 006000   000002 006000   000000 006000   376040 040040    .............
   4     010   377040 040040   375040 040040   373040 040040   000040 040040    .   .   .   .
   4     014   012040 040040                                                    .
      428      372    1   END GET_LINE;
      429      373
      430      374        %EOD;

PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:113  
--  Include file information  --

   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GET_LINE.
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:114  

 **** Variables and constants ****

  ****  Section 001  Data  GET_LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   631-0-0/w SBIN        r     1 BUFL                     627-0-0/w UBIN        r     1 BUFLCN
   630-0-0/w SBIN        r     1 BUFX                       0-0-0/w STRC(180)   r     1 CB
   632-0-0/b BIT         r     1 CRFLAG                   633-0-0/w UBIN        r     1 MAX_BYTES
     5-0-0/b BIT         r     1 REMOTE_IAC                 6-0-0/b BIT         r     1 REMOTE_OPTION
     7-0-0/c CHAR(1600)  r     1 TELNET_INBUF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ARS                       4-0-0/w PTR         r     1 @BUF_
     3-0-0/w PTR         r     1 @LCN                       6-0-0/w PTR         r     1 @TIMEOUT
    *0-0-0/w UBIN        r     1 ARS                       *0-0-0/d VECT        r     1 BUF_
    *0-0-0/w UBIN        r     1 LCN                       *0-0-0/w UBIN        r     1 TIMEOUT
     7-0-0/w PTR         r     1 TO_USER$                  10-0-0/w SBIN        r     1 UBUFX

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 C


   Procedure GET_LINE requires 160 words for executable code.
   Procedure GET_LINE requires 10 words of local(AUTO) storage.
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:115  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:116  
          MINI XREF LISTING

ARS
       279**DCL         7--PROC      324<<ASSIGN    369<<ASSIGN
BUFL
       293**DCL       305<<ASSIGN    316>>IF        336<<ASSIGN
BUFLCN
       291**DCL       303>>IF        304<<ASSIGN    319<>CALL      323<>CALL
BUFX
       292**DCL       316>>IF        335<<ASSIGN    341>>DOSELCT   350>>IF        354>>IF        356>>IF
       359>>IF        361>>ASSIGN    365<<ASSIGN    365>>ASSIGN
BUF_
       278**DCL         7--PROC      299>>ASSIGN    300>>ASSIGN
C
       281**DCL       311<<ASSIGN    361<<ASSIGN
CB
       286**DCL       319<>CALL      323<>CALL
CB.ADMIN
       286**DCL       327>>IF
CB.ARS
       286**DCL       333<<ASSIGN    336>>ASSIGN
CB.READ_COMPLETE
       286**DCL       321>>IF
COPY_CHAR
       361**LABEL     343--GOTO
CRFLAG
       295**DCL       306<<ASSIGN    310>>IF        353>>IF        359<<ASSIGN    360<<ASSIGN    368>>IF
IP$WAIT
       284**DCL-ENT   320--CALL
LCN
       277**DCL         7--PROC      303>>IF        304>>ASSIGN
MAX_BYTES
       297**DCL       300<<ASSIGN    315>>DOWHILE   357<<ASSIGN    367>>IF
REMOTE_IAC
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:117  
       288**DCL       307<<ASSIGN    331<<ASSIGN    339>>IF        340<<ASSIGN    351<<ASSIGN
REMOTE_OPTION
       289**DCL       308<<ASSIGN    332<<ASSIGN    345<<ASSIGN    348>>IF        349<<ASSIGN
RETALT
       324**LABEL     319--CALLALT   321--GOTO
SKIP_CHAR
       361**LABEL     355--GOTO
TCP$READ
       282**DCL-ENT   323--CALL
TCP$READ_NW
       283**DCL-ENT   319--CALL
TELNET_INBUF
       290**DCL       319--CALL      323--CALL      330<<ASSIGN    341>>DOSELCT   350>>IF        354>>IF
       356>>IF        359>>IF        361>>ASSIGN
TIMEOUT
       280**DCL         7--PROC      318--IF        318>>IF        320<>CALL
TO_USER$
       294**DCL       299<<ASSIGN    311>>ASSIGN    361>>ASSIGN
UBUFX
       296**DCL       302<<ASSIGN    312<<ASSIGN    315>>DOWHILE   329>>IF        361>>ASSIGN    362<<ASSIGN
       362>>ASSIGN    367<<ASSIGN    367>>ASSIGN    368<<ASSIGN    368>>ASSIGN    369>>ASSIGN
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:118  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:119  
              MINI UREF LISTING

GET_LINE       7**PROC
M$ACCT      34**DCL-ENT
M$ACTIVATE      37**DCL-ENT
M$ALIB      30**DCL-ENT
M$ASUSER      32**DCL-ENT
M$ATTACH      39**DCL-ENT
M$BADPP      57**DCL-ENT
M$CGCTL      38**DCL-ENT
M$CGINFO      38**DCL-ENT
M$CHECK      19**DCL-ENT
M$CHGUNIT      77**DCL-ENT
M$CLOSE      17**DCL-ENT
M$CLRSTK      75**DCL-ENT
M$CMDVAR      86**DCL-ENT
M$CONFIG      47**DCL-ENT
M$CORRES      22**DCL-ENT
M$CPEXIT      31**DCL-ENT
M$CVM      55**DCL-ENT
M$CVOL      20**DCL-ENT
M$DCLFLD      47**DCL-ENT
M$DEACTIVATE      37**DCL-ENT
M$DELREC      19**DCL-ENT
M$DEQ      84**DCL-ENT
M$DETACH      39**DCL-ENT
M$DEVICE      21**DCL-ENT
M$DISPLAY      84**DCL-ENT
M$DISPRES      24**DCL-ENT
M$DLIB      30**DCL-ENT
M$DRIBBLE      47**DCL-ENT
M$DRTN      75**DCL-ENT
M$DSUSER      32**DCL-ENT
M$ENQ      83**DCL-ENT
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:120  
M$EOM      42**DCL-ENT
M$ERASE      48**DCL-ENT
M$ERR      29**DCL-ENT
M$ERRMSG      80**DCL-ENT
M$EVENT      72**DCL-ENT
M$EXHUME      81**DCL-ENT
M$EXIT      29**DCL-ENT
M$EXTEND      21**DCL-ENT
M$FDP      53**DCL-ENT
M$FDS      52**DCL-ENT
M$FEBOOT      45**DCL-ENT
M$FECTL      46**DCL-ENT
M$FEDUMP      45**DCL-ENT
M$FID      80**DCL-ENT
M$FINDPROC      34**DCL-ENT
M$FSUSER      32**DCL-ENT
M$FVP      54**DCL-ENT
M$FWCG      38**DCL-ENT
M$GBPL      58**DCL-ENT
M$GDDL      54**DCL-ENT
M$GDP      53**DCL-ENT
M$GDS      52**DCL-ENT
M$GETDCB      23**DCL-ENT
M$GETMOUSE      63**DCL-ENT
M$GETPM      64**DCL-ENT
M$GJOB      82**DCL-ENT
M$GLINEATTR      42**DCL-ENT
M$GOODPP      57**DCL-ENT
M$GPLATEN      50**DCL-ENT
M$GPROMPT      49**DCL-ENT
M$GTRMATTR      43**DCL-ENT
M$GTRMCTL      41**DCL-ENT
M$GTRMTAB      44**DCL-ENT
M$GVP      53**DCL-ENT
M$HELP      80**DCL-ENT
M$INT      72**DCL-ENT
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:121  
M$INTRTN      33**DCL-ENT
M$IOQ      68**DCL-ENT
M$JOBSTATS      82**DCL-ENT
M$KEYIN      22**DCL-ENT
M$LDEV      17**DCL-ENT
M$LDTRC      30**DCL-ENT
M$LIMIT      23**DCL-ENT
M$LINES      22**DCL-ENT
M$LINK      29**DCL-ENT
M$MADMUCK      25**DCL-ENT
M$MAKUSER      56**DCL-ENT
M$MBS      24**DCL-ENT
M$MDFFLD      48**DCL-ENT
M$MERC      73**DCL-ENT
M$MERCS      74**DCL-ENT
M$MIRROR      68**DCL-ENT
M$MONINFO      85**DCL-ENT
M$MPL      58**DCL-ENT
M$NODEINFO      49**DCL-ENT
M$NXTUSR      83**DCL-ENT
M$OCMSG      81**DCL-ENT
M$OLAY      29**DCL-ENT
M$OPEN      17**DCL-ENT
M$PAS      58**DCL-ENT
M$PATHCON      81**DCL-ENT
M$PDS      52**DCL-ENT
M$PFIL      19**DCL-ENT
M$PLATEN      43**DCL-ENT
M$PRECORD      21**DCL-ENT
M$PROCNAME      34**DCL-ENT
M$PROFILE      45**DCL-ENT
M$PROMPT      41**DCL-ENT
M$RACST      25**DCL-ENT
M$RDSYSLOG      66**DCL-ENT
M$READ      18**DCL-ENT
M$RELDCB      23**DCL-ENT
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:122  
M$RELRES      24**DCL-ENT
M$RELSTARF      26**DCL-ENT
M$REM      26**DCL-ENT
M$RENV      73**DCL-ENT
M$REQUIRE      25**DCL-ENT
M$RETRY      74**DCL-ENT
M$RETRYS      74**DCL-ENT
M$REW      20**DCL-ENT
M$RLSFLD      48**DCL-ENT
M$RPRIV      76**DCL-ENT
M$RSPP      55**DCL-ENT
M$RSWITCH      77**DCL-ENT
M$RUE      83**DCL-ENT
M$SAD      56**DCL-ENT
M$SAVE      32**DCL-ENT
M$SCON      33**DCL-ENT
M$SCREECH      31**DCL-ENT
M$SENV      73**DCL-ENT
M$SETFMA      17**DCL-ENT
M$SETFP      46**DCL-ENT
M$SINPUT      44**DCL-ENT
M$SLCFLD      49**DCL-ENT
M$SMOUSE      63**DCL-ENT
M$SMPRT      55**DCL-ENT
M$SPRIV      76**DCL-ENT
M$SSC      56**DCL-ENT
M$SSWITCH      76**DCL-ENT
M$STATE      85**DCL-ENT
M$STD      57**DCL-ENT
M$STIMER      71**DCL-ENT
M$STLPP      54**DCL-ENT
M$STRAP      71**DCL-ENT
M$STRMATTR      43**DCL-ENT
M$STRMCTL      41**DCL-ENT
M$STRMTAB      44**DCL-ENT
M$SYMBIO      82**DCL-ENT
PL6.E3A0      #004=GET_LINE File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:12 Page:123  
M$SYSCON      68**DCL-ENT
M$SYSID      86**DCL-ENT
M$TDCLOSE      67**DCL-ENT
M$TDIO      67**DCL-ENT
M$TDOPEN      66**DCL-ENT
M$TDREQCPU      67**DCL-ENT
M$TEMPWROC      61**DCL-ENT
M$TIME      84**DCL-ENT
M$TRAP      71**DCL-ENT
M$TRMISC      46**DCL-ENT
M$TRMPRG      42**DCL-ENT
M$TRTN      75**DCL-ENT
M$TRUNC      18**DCL-ENT
M$TTIMER      71**DCL-ENT
M$UC      41**DCL
M$UMPL      58**DCL-ENT
M$UNFID      80**DCL-ENT
M$UNLATCH      37**DCL-ENT
M$UNSHARE      34**DCL-ENT
M$USRFIELD      77**DCL-ENT
M$VIRTUAL      52**DCL-ENT
M$WAIT      75**DCL-ENT
M$WEOF      20**DCL-ENT
M$WRITE      18**DCL-ENT
M$WRSYSLOG      66**DCL-ENT
M$XCON      72**DCL-ENT
M$XCONRTN      33**DCL-ENT
M$XEQTIME      85**DCL-ENT
M$XFLUSH      26**DCL-ENT
M$XMOUSE      63**DCL-ENT
M$XXX      29**DCL-ENT
M$YC      31**DCL-ENT
TCP_ERR_CODE     125**DCL
TCP_MON_ERR     125**DCL

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:124  
      431        1        /*T***********************************************************/
      432        2        /*T*                                                         */
      433        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      434        4        /*T*                                                         */
      435        5        /*T***********************************************************/
      436        6        REMOTE_ADMIN: PROC(BUF$);
      437        7    1   DCL BUF$ PTR;
      438        8        %INCLUDE CP_6;
      439       89        %INCLUDE TCP_HEP_M;
      440      144        %INCLUDE TCP_HEP_E;
      441      221        %INCLUDE TCT_TELNET_E;
      442      276
      443      277        %TCP$ADMIN (STCLASS="BASED(BUF$)");
      444      298    1   DCL BLANK_LINE CHAR(1) STATIC INIT(' ');
      445      299        %VLP_NAME (FPTN=NAME, L=32, STCLASS=STATIC);
      446      326        %FPT_WRITE (FPTN=WRITE_DO, DCB=M$DO);
      447      357    1   DCL M$DO DCB;
      448      358    1   DCL MSG_RESET CHAR(0) CONSTANT INIT('Connection Reset');
      449      359    1   DCL MSG_EST CHAR(0) CONSTANT INIT('Connection Established');
      450      360    1   DCL MSG_CLOSED CHAR(0) CONSTANT INIT('Connection Closed');
      451      361    1   DCL MSG_CLOSING CHAR(0) CONSTANT INIT('Connection Closing');
      452      362    1   DCL MSG_CLOSED_REMOTE CHAR(0) CONSTANT INIT('Connection Closed by Remote Host');
      453      363    1   DCL MSG_LISTEN_RESPONSE CHAR(0) CONSTANT INIT('Listen Response');
      454      364    1   DCL VERBOSE BIT(36) SYMREF;
      455      365    1   DCL LINK_UP BIT(1) SYMREF;
      456      366    1   DCL NET$ADDR2IP ENTRY(2);
      457      367
      458      368    1      WRITE_DO.BUF_ = VECTOR(BLANK_LINE);
      459      369    1      IF VERBOSE THEN CALL M$WRITE (WRITE_DO);
      460      370    2      DO SELECT (TCP$ADMIN.CMD);
      461      371
      462      372    2          SELECT(%TCP_ADMINMSG_RESET);
      463      373    2          WRITE_DO.BUF_ = VECTOR(MSG_RESET);
      464      374    2          LINK_UP='0'B;
      465      375
      466      376    2          SELECT (%TCP_ADMINMSG_ESTABLISHED);
      467      377    2          WRITE_DO.BUF_ = VECTOR(MSG_EST);
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:125  
      468      378
      469      379    2          SELECT (%TCP_ADMINMSG_CLOSING);
      470      380    2          WRITE_DO.BUF_ = VECTOR(MSG_CLOSING);
      471      381    2          LINK_UP='0'B;
      472      382
      473      383    2          SELECT (%TCP_ADMINMSG_CLOSE_WAIT);
      474      384    2          WRITE_DO.BUF_ = VECTOR(MSG_CLOSED_REMOTE);
      475      385    2          LINK_UP='0'B;
      476      386
      477      387    2          SELECT(%TCP_ADMINMSG_LISTEN_RESPONSE);
      478      388    2          WRITE_DO.BUF_ = VECTOR(MSG_LISTEN_RESPONSE);
      479      389    2          IF VERBOSE THEN CALL M$WRITE (WRITE_DO);
      480      390    2          CALL NET$ADDR2IP(NAME,TCP$ADMIN.FS);
      481      391    2          WRITE_DO.BUF_ = VECTOR(NAME.NAME#);
      482      392    2          SELECT(%TCP_ADMINMSG_CLOSED);
      483      393    2          WRITE_DO.BUF_ = VECTOR(MSG_CLOSED);
      484      394    2          LINK_UP='0'B;
      485      395    2          SELECT (ELSE);
      486      396    2      CALL M$XXX;
      487      397
      488      398    2          END;
      489      399
      490      400
      491      401    1      IF VERBOSE THEN CALL M$WRITE (WRITE_DO);
      492      402
      493      403    1   END REMOTE_ADMIN;
      494      404
      495      405        %EOD;

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:126  
--  Include file information  --

   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure REMOTE_ADMIN.

   Procedure REMOTE_ADMIN requires 78 words for executable code.
   Procedure REMOTE_ADMIN requires 6 words of local(AUTO) storage.

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:127  

 Object Unit name= REMOTE_ADMIN                               File name= TCF$FTP.:TCA2TOU
 UTS= NOV 16 '97 14:13:02.32 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    22     26  REMOTE_ADMIN
    2   DCB   even  none     0      0  M$DO
    3  RoData even  UTS     32     40  REMOTE_ADMIN
    4   Proc  even  none    78    116  REMOTE_ADMIN
    5  RoData even  none    18     22  REMOTE_ADMIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  REMOTE_ADMIN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 NET$ADDR2IP
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:128  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DO                                  VERBOSE
     LINK_UP                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:129  


      431        1        /*T***********************************************************/
      432        2        /*T*                                                         */
      433        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      434        4        /*T*                                                         */
      435        5        /*T***********************************************************/
      436        6        REMOTE_ADMIN: PROC(BUF$);

      6  4 000000   000000 700200 xent  REMOTE_ADMIN TSX0  ! X66_AUTO_1
         4 000001   000006 000001                    ZERO    6,1

      437        7    1   DCL BUF$ PTR;
      438        8        %INCLUDE CP_6;
      439       89        %INCLUDE TCP_HEP_M;
      440      144        %INCLUDE TCP_HEP_E;
      441      221        %INCLUDE TCT_TELNET_E;
      442      276
      443      277        %TCP$ADMIN (STCLASS="BASED(BUF$)");
      444      298    1   DCL BLANK_LINE CHAR(1) STATIC INIT(' ');
      445      299        %VLP_NAME (FPTN=NAME, L=32, STCLASS=STATIC);
      446      326        %FPT_WRITE (FPTN=WRITE_DO, DCB=M$DO);
      447      357    1   DCL M$DO DCB;
      448      358    1   DCL MSG_RESET CHAR(0) CONSTANT INIT('Connection Reset');
      449      359    1   DCL MSG_EST CHAR(0) CONSTANT INIT('Connection Established');
      450      360    1   DCL MSG_CLOSED CHAR(0) CONSTANT INIT('Connection Closed');
      451      361    1   DCL MSG_CLOSING CHAR(0) CONSTANT INIT('Connection Closing');
      452      362    1   DCL MSG_CLOSED_REMOTE CHAR(0) CONSTANT INIT('Connection Closed by Remote Host');
      453      363    1   DCL MSG_LISTEN_RESPONSE CHAR(0) CONSTANT INIT('Listen Response');
      454      364    1   DCL VERBOSE BIT(36) SYMREF;
      455      365    1   DCL LINK_UP BIT(1) SYMREF;
      456      366    1   DCL NET$ADDR2IP ENTRY(2);
      457      367
      458      368    1      WRITE_DO.BUF_ = VECTOR(BLANK_LINE);

    368  4 000002   000000 237000 5                  LDAQ    0
         4 000003   000016 757000 1                  STAQ    WRITE_DO+4

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:130  
      459      369    1      IF VERBOSE THEN CALL M$WRITE (WRITE_DO);

    369  4 000004   000000 235000 xsym               LDA     VERBOSE
         4 000005   000011 600000 4                  TZE     s:370

    369  4 000006   000012 630400 1                  EPPR0   WRITE_DO
         4 000007   040001 713400                    CLIMB   write
         4 000010   401400 401760                    pmme    nvectors=4

      460      370    2      DO SELECT (TCP$ADMIN.CMD);

    370  4 000011   200003 470500                    LDP0    @BUF$,,AUTO
         4 000012   000000 471500                    LDP1    0,,PR0
         4 000013   100000 236100                    LDQ     0,,PR1
         4 000014   000003 116007                    CMPQ    3,DL
         4 000015   000030 602000 4                  TNC     s:370+15
         4 000016   000043 600000 4                  TZE     s:377
         4 000017   000006 116007                    CMPQ    6,DL
         4 000020   000025 602000 4                  TNC     s:370+12
         4 000021   000052 600000 4                  TZE     s:384
         4 000022   000007 116007                    CMPQ    7,DL
         4 000023   000106 601000 4                  TNZ     s:396
         4 000024   000102 710000 4                  TRA     s:393
         4 000025   000005 116007                    CMPQ    5,DL
         4 000026   000106 601000 4                  TNZ     s:396
         4 000027   000046 710000 4                  TRA     s:380
         4 000030   000002 116007                    CMPQ    2,DL
         4 000031   000034 602000 4                  TNC     s:370+19
         4 000032   000037 600000 4                  TZE     s:373
         4 000033   000106 710000 4                  TRA     s:396
         4 000034   000001 116007                    CMPQ    1,DL
         4 000035   000106 601000 4                  TNZ     s:396
         4 000036   000056 710000 4                  TRA     s:388

      461      371
      462      372    2          SELECT(%TCP_ADMINMSG_RESET);

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:131  
      463      373    2          WRITE_DO.BUF_ = VECTOR(MSG_RESET);

    373  4 000037   000002 237000 5                  LDAQ    2
         4 000040   000016 757000 1                  STAQ    WRITE_DO+4

      464      374    2          LINK_UP='0'B;

    374  4 000041   000000 450000 xsym               STZ     LINK_UP
         4 000042   000110 710000 4                  TRA     s:401

      465      375
      466      376    2          SELECT (%TCP_ADMINMSG_ESTABLISHED);

      467      377    2          WRITE_DO.BUF_ = VECTOR(MSG_EST);

    377  4 000043   000004 237000 5                  LDAQ    4
         4 000044   000016 757000 1                  STAQ    WRITE_DO+4
         4 000045   000110 710000 4                  TRA     s:401

      468      378
      469      379    2          SELECT (%TCP_ADMINMSG_CLOSING);

      470      380    2          WRITE_DO.BUF_ = VECTOR(MSG_CLOSING);

    380  4 000046   000006 237000 5                  LDAQ    6
         4 000047   000016 757000 1                  STAQ    WRITE_DO+4

      471      381    2          LINK_UP='0'B;

    381  4 000050   000000 450000 xsym               STZ     LINK_UP
         4 000051   000110 710000 4                  TRA     s:401

      472      382
      473      383    2          SELECT (%TCP_ADMINMSG_CLOSE_WAIT);

      474      384    2          WRITE_DO.BUF_ = VECTOR(MSG_CLOSED_REMOTE);

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:132  
    384  4 000052   000010 237000 5                  LDAQ    8
         4 000053   000016 757000 1                  STAQ    WRITE_DO+4

      475      385    2          LINK_UP='0'B;

    385  4 000054   000000 450000 xsym               STZ     LINK_UP
         4 000055   000110 710000 4                  TRA     s:401

      476      386
      477      387    2          SELECT(%TCP_ADMINMSG_LISTEN_RESPONSE);

      478      388    2          WRITE_DO.BUF_ = VECTOR(MSG_LISTEN_RESPONSE);

    388  4 000056   000012 237000 5                  LDAQ    10
         4 000057   000016 757000 1                  STAQ    WRITE_DO+4

      479      389    2          IF VERBOSE THEN CALL M$WRITE (WRITE_DO);

    389  4 000060   000000 235000 xsym               LDA     VERBOSE
         4 000061   000065 600000 4                  TZE     s:390

    389  4 000062   000012 630400 1                  EPPR0   WRITE_DO
         4 000063   040001 713400                    CLIMB   write
         4 000064   401400 401760                    pmme    nvectors=4

      480      390    2          CALL NET$ADDR2IP(NAME,TCP$ADMIN.FS);

    390  4 000065   200003 470500                    LDP0    @BUF$,,AUTO
         4 000066   000000 471500                    LDP1    0,,PR0
         4 000067   100012 633500                    EPPR3   10,,PR1
         4 000070   200005 453500                    STP3    @BUF$+2,,AUTO
         4 000071   000014 236000 5                  LDQ     12
         4 000072   200004 756100                    STQ     @BUF$+1,,AUTO
         4 000073   200004 630500                    EPPR0   @BUF$+1,,AUTO
         4 000074   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000075   000000 701000 xent               TSX1    NET$ADDR2IP
         4 000076   000000 011000                    NOP     0
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:133  

      481      391    2          WRITE_DO.BUF_ = VECTOR(NAME.NAME#);

    391  4 000077   000016 237000 5                  LDAQ    14
         4 000100   000016 757000 1                  STAQ    WRITE_DO+4
         4 000101   000110 710000 4                  TRA     s:401

      482      392    2          SELECT(%TCP_ADMINMSG_CLOSED);

      483      393    2          WRITE_DO.BUF_ = VECTOR(MSG_CLOSED);

    393  4 000102   000020 237000 5                  LDAQ    16
         4 000103   000016 757000 1                  STAQ    WRITE_DO+4

      484      394    2          LINK_UP='0'B;

    394  4 000104   000000 450000 xsym               STZ     LINK_UP
         4 000105   000110 710000 4                  TRA     s:401

      485      395    2          SELECT (ELSE);

      486      396    2      CALL M$XXX;

    396  4 000106   000003 713400                    CLIMB   3
         4 000107   000000 401760                    pmme    nvectors=0

      487      397
      488      398    2          END;

      489      399
      490      400
      491      401    1      IF VERBOSE THEN CALL M$WRITE (WRITE_DO);

    401  4 000110   000000 235000 xsym               LDA     VERBOSE
         4 000111   000115 600000 4                  TZE     s:403

    401  4 000112   000012 630400 1                  EPPR0   WRITE_DO
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:134  
         4 000113   040001 713400                    CLIMB   write
         4 000114   401400 401760                    pmme    nvectors=4

      492      402
      493      403    1   END REMOTE_ADMIN;

    403  4 000115   000000 702200 xent               TSX2  ! X66_ARET

BLANK_LINE
 Sect OctLoc
   1     000   040*** ******                                                     ...

NAME
 Sect OctLoc
   1     001   040040 040040   040040 040040   040040 040040   040040 040040
   1     005   040040 040040   040040 040040   040040 040040   040040 040040

WRITE_DO
 Sect OctLoc
   1     012   000003 777640   000022 006000   000000 177640   000000 006014    ................
   1     016   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     022   000000 400400   000000 000000   000000 000000   000000 000000    ................

MSG_RESET
 Sect OctLoc
   3     000   103157 156156   145143 164151   157156 040122   145163 145164    Connection Reset

MSG_EST
 Sect OctLoc
   3     004   103157 156156   145143 164151   157156 040105   163164 141142    Connection Estab
   3     010   154151 163150   145144 ******                                    lished..

MSG_CLOSED
 Sect OctLoc
   3     012   103157 156156   145143 164151   157156 040103   154157 163145    Connection Close
   3     016   144*** ******                                                    d...

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:135  
MSG_CLOSING
 Sect OctLoc
   3     017   103157 156156   145143 164151   157156 040103   154157 163151    Connection Closi
   3     023   156147 ******                                                    ng..

MSG_CLOSED_REMOTE
 Sect OctLoc
   3     024   103157 156156   145143 164151   157156 040103   154157 163145    Connection Close
   3     030   144040 142171   040122 145155   157164 145040   110157 163164    d by Remote Host

MSG_LISTEN_RESPONSE
 Sect OctLoc
   3     034   114151 163164   145156 040122   145163 160157   156163 145***    Listen Response.

(unnamed)
 Sect OctLoc
   5     000   000000 177640   000000 006000   000003 777640   000000 006000    ................
   5     004   000005 377640   000004 006000   000004 377640   000017 006000    ................
   5     010   000007 777640   000024 006000   000003 577640   000034 006000    ................
   5     014   000001 006000   000000 000000   000007 577640   000001 206000    ................
   5     020   000004 177640   000012 006000                                    ........
      494      404
      495      405        %EOD;

PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:136  
--  Include file information  --

   TCT_TELNET_E.:TCA2TOU  is referenced.
   TCP_HEP_E.:TCA2TOU  is referenced.
   TCP_HEP_M.:TCA2TOU  cannot be made into a system file and is referenced.
   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure REMOTE_ADMIN.
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:137  

 **** Variables and constants ****

  ****  Section 001  Data  REMOTE_ADMIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 BLANK_LINE                 1-0-0/c STRC(288)   r     1 NAME
    12-0-0/d STRC(432)   r     1 WRITE_DO

  ****  Section 003 RoData REMOTE_ADMIN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/c CHAR(17)    r     1 MSG_CLOSED                24-0-0/c CHAR(32)    r     1 MSG_CLOSED_REMOTE
    17-0-0/c CHAR(18)    r     1 MSG_CLOSING                4-0-0/c CHAR(22)    r     1 MSG_EST
    34-0-0/c CHAR(15)    r     1 MSG_LISTEN_RESPONSE        0-0-0/c CHAR(16)    r     1 MSG_RESET

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUF$                     *0-0-0/w PTR         r     1 BUF$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 LINK_UP                    0-0-0/b BIT         r     1 VERBOSE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:138  

     0-0-0N  NULL        r     1 M$DO                       0-0-0/w STRC(432)   r     1 TCP$ADMIN


   Procedure REMOTE_ADMIN requires 78 words for executable code.
   Procedure REMOTE_ADMIN requires 6 words of local(AUTO) storage.
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:139  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:140  
          MINI XREF LISTING

BLANK_LINE
       298**DCL       368--ASSIGN
BUF$
         7**DCL         6--PROC      278--IMP-PTR   370>>DOSELCT   390>>CALL
LINK_UP
       365**DCL       374<<ASSIGN    381<<ASSIGN    385<<ASSIGN    394<<ASSIGN
M$WRITE
        18**DCL-ENT   369--CALL      389--CALL      401--CALL
M$XXX
        29**DCL-ENT   396--CALL
MSG_CLOSED
       360**DCL       393--ASSIGN
MSG_CLOSED_REMOTE
       362**DCL       384--ASSIGN
MSG_CLOSING
       361**DCL       380--ASSIGN
MSG_EST
       359**DCL       377--ASSIGN
MSG_LISTEN_RESPONSE
       363**DCL       388--ASSIGN
MSG_RESET
       358**DCL       373--ASSIGN
NAME
       324**DCL       390<>CALL
NAME.NAME#
       324**DCL       391--ASSIGN
NET$ADDR2IP
       366**DCL-ENT   390--CALL
TCP$ADMIN.CMD
       278**DCL       370>>DOSELCT
TCP$ADMIN.FS
       293**DCL       390<>CALL
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:141  
TCP$ADMIN.GHST_LCN
       279**DCL       279--REDEF
TCP$ADMIN.USER_LCN
       278**DCL       279--REDEF
VERBOSE
       364**DCL       369>>IF        389>>IF        401>>IF
WRITE_DO
       343**DCL       369<>CALL      389<>CALL      401<>CALL
WRITE_DO.BUF_
       343**DCL       368<<ASSIGN    373<<ASSIGN    377<<ASSIGN    380<<ASSIGN    384<<ASSIGN    388<<ASSIGN
       391<<ASSIGN    393<<ASSIGN
WRITE_DO.STATION_
       345**DCL       345--REDEF
WRITE_DO.V
       346**DCL       343--DCLINIT
WRITE_DO.V.DVBYTE.VFC#
       352**DCL       352--REDEF
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:142  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:143  
              MINI UREF LISTING

M$ACCT      34**DCL-ENT
M$ACTIVATE      37**DCL-ENT
M$ALIB      30**DCL-ENT
M$ASUSER      32**DCL-ENT
M$ATTACH      39**DCL-ENT
M$BADPP      57**DCL-ENT
M$CGCTL      38**DCL-ENT
M$CGINFO      38**DCL-ENT
M$CHECK      19**DCL-ENT
M$CHGUNIT      77**DCL-ENT
M$CLOSE      17**DCL-ENT
M$CLRSTK      75**DCL-ENT
M$CMDVAR      86**DCL-ENT
M$CONFIG      47**DCL-ENT
M$CORRES      22**DCL-ENT
M$CPEXIT      31**DCL-ENT
M$CVM      55**DCL-ENT
M$CVOL      20**DCL-ENT
M$DCLFLD      47**DCL-ENT
M$DEACTIVATE      37**DCL-ENT
M$DELREC      19**DCL-ENT
M$DEQ      84**DCL-ENT
M$DETACH      39**DCL-ENT
M$DEVICE      21**DCL-ENT
M$DISPLAY      84**DCL-ENT
M$DISPRES      24**DCL-ENT
M$DLIB      30**DCL-ENT
M$DO     357**DCL
M$DRIBBLE      47**DCL-ENT
M$DRTN      75**DCL-ENT
M$DSUSER      32**DCL-ENT
M$ENQ      83**DCL-ENT
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:144  
M$EOM      42**DCL-ENT
M$ERASE      48**DCL-ENT
M$ERR      29**DCL-ENT
M$ERRMSG      80**DCL-ENT
M$EVENT      72**DCL-ENT
M$EXHUME      81**DCL-ENT
M$EXIT      29**DCL-ENT
M$EXTEND      21**DCL-ENT
M$FDP      53**DCL-ENT
M$FDS      52**DCL-ENT
M$FEBOOT      45**DCL-ENT
M$FECTL      46**DCL-ENT
M$FEDUMP      45**DCL-ENT
M$FID      80**DCL-ENT
M$FINDPROC      34**DCL-ENT
M$FSUSER      32**DCL-ENT
M$FVP      54**DCL-ENT
M$FWCG      38**DCL-ENT
M$GBPL      58**DCL-ENT
M$GDDL      54**DCL-ENT
M$GDP      53**DCL-ENT
M$GDS      52**DCL-ENT
M$GETDCB      23**DCL-ENT
M$GETMOUSE      63**DCL-ENT
M$GETPM      64**DCL-ENT
M$GJOB      82**DCL-ENT
M$GLINEATTR      42**DCL-ENT
M$GOODPP      57**DCL-ENT
M$GPLATEN      50**DCL-ENT
M$GPROMPT      49**DCL-ENT
M$GTRMATTR      43**DCL-ENT
M$GTRMCTL      41**DCL-ENT
M$GTRMTAB      44**DCL-ENT
M$GVP      53**DCL-ENT
M$HELP      80**DCL-ENT
M$INT      72**DCL-ENT
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:145  
M$INTRTN      33**DCL-ENT
M$IOQ      68**DCL-ENT
M$JOBSTATS      82**DCL-ENT
M$KEYIN      22**DCL-ENT
M$LDEV      17**DCL-ENT
M$LDTRC      30**DCL-ENT
M$LIMIT      23**DCL-ENT
M$LINES      22**DCL-ENT
M$LINK      29**DCL-ENT
M$MADMUCK      25**DCL-ENT
M$MAKUSER      56**DCL-ENT
M$MBS      24**DCL-ENT
M$MDFFLD      48**DCL-ENT
M$MERC      73**DCL-ENT
M$MERCS      74**DCL-ENT
M$MIRROR      68**DCL-ENT
M$MONINFO      85**DCL-ENT
M$MPL      58**DCL-ENT
M$NODEINFO      49**DCL-ENT
M$NXTUSR      83**DCL-ENT
M$OCMSG      81**DCL-ENT
M$OLAY      29**DCL-ENT
M$OPEN      17**DCL-ENT
M$PAS      58**DCL-ENT
M$PATHCON      81**DCL-ENT
M$PDS      52**DCL-ENT
M$PFIL      19**DCL-ENT
M$PLATEN      43**DCL-ENT
M$PRECORD      21**DCL-ENT
M$PROCNAME      34**DCL-ENT
M$PROFILE      45**DCL-ENT
M$PROMPT      41**DCL-ENT
M$RACST      25**DCL-ENT
M$RDSYSLOG      66**DCL-ENT
M$READ      18**DCL-ENT
M$RELDCB      23**DCL-ENT
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:146  
M$RELRES      24**DCL-ENT
M$RELSTARF      26**DCL-ENT
M$REM      26**DCL-ENT
M$RENV      73**DCL-ENT
M$REQUIRE      25**DCL-ENT
M$RETRY      74**DCL-ENT
M$RETRYS      74**DCL-ENT
M$REW      20**DCL-ENT
M$RLSFLD      48**DCL-ENT
M$RPRIV      76**DCL-ENT
M$RSPP      55**DCL-ENT
M$RSWITCH      77**DCL-ENT
M$RUE      83**DCL-ENT
M$SAD      56**DCL-ENT
M$SAVE      32**DCL-ENT
M$SCON      33**DCL-ENT
M$SCREECH      31**DCL-ENT
M$SENV      73**DCL-ENT
M$SETFMA      17**DCL-ENT
M$SETFP      46**DCL-ENT
M$SINPUT      44**DCL-ENT
M$SLCFLD      49**DCL-ENT
M$SMOUSE      63**DCL-ENT
M$SMPRT      55**DCL-ENT
M$SPRIV      76**DCL-ENT
M$SSC      56**DCL-ENT
M$SSWITCH      76**DCL-ENT
M$STATE      85**DCL-ENT
M$STD      57**DCL-ENT
M$STIMER      71**DCL-ENT
M$STLPP      54**DCL-ENT
M$STRAP      71**DCL-ENT
M$STRMATTR      43**DCL-ENT
M$STRMCTL      41**DCL-ENT
M$STRMTAB      44**DCL-ENT
M$SYMBIO      82**DCL-ENT
PL6.E3A0      #005=REMOTE_ADMIN File=TCF$FTP.:TCA2TSI                            SUN 11/16/97 14:13 Page:147  
M$SYSCON      68**DCL-ENT
M$SYSID      86**DCL-ENT
M$TDCLOSE      67**DCL-ENT
M$TDIO      67**DCL-ENT
M$TDOPEN      66**DCL-ENT
M$TDREQCPU      67**DCL-ENT
M$TEMPWROC      61**DCL-ENT
M$TIME      84**DCL-ENT
M$TRAP      71**DCL-ENT
M$TRMISC      46**DCL-ENT
M$TRMPRG      42**DCL-ENT
M$TRTN      75**DCL-ENT
M$TRUNC      18**DCL-ENT
M$TTIMER      71**DCL-ENT
M$UC      41**DCL
M$UMPL      58**DCL-ENT
M$UNFID      80**DCL-ENT
M$UNLATCH      37**DCL-ENT
M$UNSHARE      34**DCL-ENT
M$USRFIELD      77**DCL-ENT
M$VIRTUAL      52**DCL-ENT
M$WAIT      75**DCL-ENT
M$WEOF      20**DCL-ENT
M$WRSYSLOG      66**DCL-ENT
M$XCON      72**DCL-ENT
M$XCONRTN      33**DCL-ENT
M$XEQTIME      85**DCL-ENT
M$XFLUSH      26**DCL-ENT
M$XMOUSE      63**DCL-ENT
M$YC      31**DCL-ENT
REMOTE_ADMIN       6**PROC
TCP_ERR_CODE     125**DCL
TCP_MON_ERR     125**DCL

PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:148  
      496        1        /*T***********************************************************/
      497        2        /*T*                                                         */
      498        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      499        4        /*T*                                                         */
      500        5        /*T***********************************************************/
      501        6        PARSE_SF: PROC(PARM);
      502        7        %INCLUDE XU_MACRO_C;
      503     3113        %PARSE$PARAM (NAME=PARM);
      504     3194        %PARSE$SYM (STCLASS=BASED);
      505     3232
      506     3233    1      IF PARM.OUT$->OUT$SYM.COUNT=0 THEN PARM.REJECT = '1'B;
      507     3234    1      RETURN;
      508     3235    1   END PARSE_SF;
      509     3236        %EOD;

PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:149  
--  Include file information  --

   XU_MACRO_C.:LIBRARY  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure PARSE_SF.

   Procedure PARSE_SF requires 10 words for executable code.
   Procedure PARSE_SF requires 4 words of local(AUTO) storage.

PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:150  

 Object Unit name= PARSE_SF                                   File name= TCF$FTP.:TCA2TOU
 UTS= NOV 16 '97 14:13:29.88 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    10     12  PARSE_SF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  PARSE_SF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:151  


      496        1        /*T***********************************************************/
      497        2        /*T*                                                         */
      498        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      499        4        /*T*                                                         */
      500        5        /*T***********************************************************/
      501        6        PARSE_SF: PROC(PARM);

      6  0 000000   000000 700200 xent  PARSE_SF     TSX0  ! X66_AUTO_1
         0 000001   000004 000001                    ZERO    4,1

      502        7        %INCLUDE XU_MACRO_C;
      503     3113        %PARSE$PARAM (NAME=PARM);
      504     3194        %PARSE$SYM (STCLASS=BASED);
      505     3232
      506     3233    1      IF PARM.OUT$->OUT$SYM.COUNT=0 THEN PARM.REJECT = '1'B;

   3233  0 000002   200003 470500                    LDP0    @PARM,,AUTO
         0 000003   000002 471500                    LDP1    2,,PR0
         0 000004   100004 236100                    LDQ     4,,PR1
         0 000005   777000 316003                    CANQ    -512,DU
         0 000006   000011 601000 0                  TNZ     s:3234

   3233  0 000007   000200 236003                    LDQ     128,DU
         0 000010   000000 256100                    ORSQ    0,,PR0

      507     3234    1      RETURN;

   3234  0 000011   000000 702200 xent               TSX2  ! X66_ARET
      508     3235    1   END PARSE_SF;
      509     3236        %EOD;

PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:152  
--  Include file information  --

   XU_MACRO_C.:LIBRARY  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure PARSE_SF.
PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:153  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @PARM                     *0-0-0/w STRC(270)   r     1 PARM

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure PARSE_SF requires 10 words for executable code.
   Procedure PARSE_SF requires 4 words of local(AUTO) storage.
PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:154  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:155  
          MINI XREF LISTING

OUT$SYM.COUNT
      3224**DCL      3227--IMP-SIZ  3233>>IF
PARM
      3132**DCL         6--PROC
PARM.OUT$
      3162**DCL      3233>>IF
PARM.REJECT
      3144**DCL      3233<<ASSIGN
PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:156  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #006=PARSE_SF File=TCF$FTP.:TCA2TSI                                SUN 11/16/97 14:13 Page:157  
              MINI UREF LISTING

PARSE_SF       6**PROC

PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:158  
      510        1        /*T***********************************************************/
      511        2        /*T*                                                         */
      512        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      513        4        /*T*                                                         */
      514        5        /*T***********************************************************/
      515        6        /* Diagnostic write, also write buffer to user */
      516        7        TCP$WRITE_D: PROC (LCN, BUF_, PUSH, URGENT) ALTRET;
      517        8
      518        9    1   DCL LCN UBIN(36);
      519       10    1   DCL BUF_ VECTOR;
      520       11    1   DCL PUSH BIT(1) UNAL;
      521       12    1   DCL URGENT BIT(1) UNAL;
      522       13
      523       14        %INCLUDE CP_6;
      524       95        %FPT_WRITE (FPTN=WRITE_DO,
      525       96                DCB=M$DO);
      526      127    1   DCL M$DO DCB;
      527      128    1   DCL DOBUF CHAR(140) STATIC INIT('  ->');
      528      129    1   DCL DONDX SBIN STATIC INIT(4);
      529      130    1   DCL 1 CRLF CONSTANT SYMDEF,
      530      131    1             2 * CHAR(1) INIT (BINASC(13)),
      531      132    1             2 * CHAR(1) INIT (BINASC(10));
      532      133    1   DCL CHARN CHAR(CHARNLEN) BASED;
      533      134    1   DCL CHARNLEN UBIN(36) STATIC;
      534      135
      535      136    1   DCL DEBUG BIT(36) SYMREF;
      536      137    1   DCL TCP$WRITE ENTRY(4) ALTRET;
      537      138
      538      139
      539      140    2      IF DEBUG THEN DO;
      540      141    2          CHARNLEN = VBOUND(BUF_)+1;
      541      142    2          SUBSTR (DOBUF, DONDX, CHARNLEN) = VBASE(BUF_)->CHARN;
      542      143    2          DONDX = CHARNLEN+DONDX;
      543      144    2          END;
      544      145
      545      146    2      CALL TCP$WRITE(LCN,BUF_,PUSH,URGENT) WHENALTRETURN DO;
      546      147    2          ALTRETURN;
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:159  
      547      148    2          END;
      548      149    1      RETURN;
      549      150
      550      151    1   TELNET_EOL: ENTRY (LCN) ALTRET;
      551      152
      552      153    2      IF DEBUG AND DONDX > 4 THEN DO;
      553      154    2          WRITE_DO.BUF_ = VECTOR(SUBSTR(DOBUF,0,DONDX));
      554      155    2          CALL M$WRITE (WRITE_DO);
      555      156    2          DONDX = 4;
      556      157    2          END;
      557      158    1      CALL TCP$WRITE (LCN, VECTOR(CRLF), '1'B/*Push*/ );
      558      159    1      RETURN;
      559      160    1   END TCP$WRITE_D;
      560      161

PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:160  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCP$WRITE_D.

   Procedure TCP$WRITE_D requires 52 words for executable code.
   Procedure TCP$WRITE_D requires 12 words of local(AUTO) storage.

    No errors detected in file TCF$FTP.:TCA2TSI    .

PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:161  

 Object Unit name= TCP$WRITE_D                                File name= TCF$FTP.:TCA2TOU
 UTS= NOV 16 '97 14:13:49.48 SUN                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    49     61  TCP$WRITE_D
    2   DCB   even  none     0      0  M$DO
    3  RoData even  UTS      1      1  TCP$WRITE_D
    4   Proc  even  none    52     64  TCP$WRITE_D
    5  RoData even  none     6      6  TCP$WRITE_D

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        4  TCP$WRITE_D
     4     31          yes     yes      Std        1  TELNET_EOL

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    3      0  CRLF
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:162  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 TCP$WRITE
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$DO                                  DEBUG
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:163  


      510        1        /*T***********************************************************/
      511        2        /*T*                                                         */
      512        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      513        4        /*T*                                                         */
      514        5        /*T***********************************************************/
      515        6        /* Diagnostic write, also write buffer to user */
      516        7        TCP$WRITE_D: PROC (LCN, BUF_, PUSH, URGENT) ALTRET;

      7  4 000000   000000 700200 xent  TCP$WRITE_D  TSX0  ! X66_AUTO_4
         4 000001   000014 000004                    ZERO    12,4

      517        8
      518        9    1   DCL LCN UBIN(36);
      519       10    1   DCL BUF_ VECTOR;
      520       11    1   DCL PUSH BIT(1) UNAL;
      521       12    1   DCL URGENT BIT(1) UNAL;
      522       13
      523       14        %INCLUDE CP_6;
      524       95        %FPT_WRITE (FPTN=WRITE_DO,
      525       96                DCB=M$DO);
      526      127    1   DCL M$DO DCB;
      527      128    1   DCL DOBUF CHAR(140) STATIC INIT('  ->');
      528      129    1   DCL DONDX SBIN STATIC INIT(4);
      529      130    1   DCL 1 CRLF CONSTANT SYMDEF,
      530      131    1             2 * CHAR(1) INIT (BINASC(13)),
      531      132    1             2 * CHAR(1) INIT (BINASC(10));
      532      133    1   DCL CHARN CHAR(CHARNLEN) BASED;
      533      134    1   DCL CHARNLEN UBIN(36) STATIC;
      534      135
      535      136    1   DCL DEBUG BIT(36) SYMREF;
      536      137    1   DCL TCP$WRITE ENTRY(4) ALTRET;
      537      138
      538      139
      539      140    2      IF DEBUG THEN DO;

    140  4 000002   000000 235000 xsym               LDA     DEBUG
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:164  
         4 000003   000022 600000 4                  TZE     s:146

      540      141    2          CHARNLEN = VBOUND(BUF_)+1;

    141  4 000004   200004 470500                    LDP0    @BUF_,,AUTO
         4 000005   000000 236100                    LDQ     0,,PR0
         4 000006   000020 772000                    QRL     16
         4 000007   000001 036007                    ADLQ    1,DL
         4 000010   000060 756000 1                  STQ     CHARNLEN

      541      142    2          SUBSTR (DOBUF, DONDX, CHARNLEN) = VBASE(BUF_)->CHARN;

    142  4 000011   000001 471500                    LDP1    1,,PR0
         4 000012   000000 620006                    EAX0    0,QL
         4 000013   000060 721000 1                  LXL1    CHARNLEN
         4 000014   000057 236000 1                  LDQ     DONDX
         4 000015   040046 100540                    MLR     fill='040'O
         4 000016   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         4 000017   000014 000011 1                  ADSC9   DOBUF,Q                  cn=0,n=*X1

      542      143    2          DONDX = CHARNLEN+DONDX;

    143  4 000020   000060 036000 1                  ADLQ    CHARNLEN
         4 000021   000057 756000 1                  STQ     DONDX

      543      144    2          END;

      544      145
      545      146    2      CALL TCP$WRITE(LCN,BUF_,PUSH,URGENT) WHENALTRETURN DO;

    146  4 000022   200003 630500                    EPPR0   @LCN,,AUTO
         4 000023   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000024   000000 701000 xent               TSX1    TCP$WRITE
         4 000025   000027 702000 4                  TSX2    s:147
         4 000026   000030 710000 4                  TRA     s:149

      546      147    2          ALTRETURN;
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:165  

    147  4 000027   000000 702200 xent               TSX2  ! X66_AALT

      547      148    2          END;
      548      149    1      RETURN;

    149  4 000030   000000 702200 xent               TSX2  ! X66_ARET

      549      150
      550      151    1   TELNET_EOL: ENTRY (LCN) ALTRET;

    151  4 000031   000000 700200 xent  TELNET_EOL   TSX0  ! X66_AUTO_4
         4 000032   000014 000004                    ZERO    12,4

      551      152
      552      153    2      IF DEBUG AND DONDX > 4 THEN DO;

    153  4 000033   000000 235000 xsym               LDA     DEBUG
         4 000034   000052 600000 4                  TZE     s:158
         4 000035   000057 236000 1                  LDQ     DONDX
         4 000036   000004 116007                    CMPQ    4,DL
         4 000037   000052 604400 4                  TMOZ    s:158

      553      154    2          WRITE_DO.BUF_ = VECTOR(SUBSTR(DOBUF,0,DONDX));

    154  4 000040   000057 235000 1                  LDA     DONDX
         4 000041   000020 735000                    ALS     16
         4 000042   000140 135007                    SBLA    96,DL
         4 000043   000000 236000 5                  LDQ     0
         4 000044   000004 757000 1                  STAQ    WRITE_DO+4

      554      155    2          CALL M$WRITE (WRITE_DO);

    155  4 000045   000000 630400 1                  EPPR0   WRITE_DO
         4 000046   040001 713400                    CLIMB   write
         4 000047   401400 401760                    pmme    nvectors=4

PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:166  
      555      156    2          DONDX = 4;

    156  4 000050   000004 235007                    LDA     4,DL
         4 000051   000057 755000 1                  STA     DONDX

      556      157    2          END;

      557      158    1      CALL TCP$WRITE (LCN, VECTOR(CRLF), '1'B/*Push*/ );

    158  4 000052   000004 236000 5                  LDQ     4
         4 000053   200012 756100                    STQ     @URGENT+4,,AUTO
         4 000054   000005 236000 5                  LDQ     5
         4 000055   200003 235100                    LDA     @LCN,,AUTO
         4 000056   200010 757100                    STAQ    @URGENT+2,,AUTO
         4 000057   200010 630500                    EPPR0   @URGENT+2,,AUTO
         4 000060   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000061   000000 701000 xent               TSX1    TCP$WRITE
         4 000062   000000 011000                    NOP     0

      558      159    1      RETURN;

    159  4 000063   000000 702200 xent               TSX2  ! X66_ARET

WRITE_DO
 Sect OctLoc
   1     000   000003 777640   000010 006000   000000 177640   000000 006014    ................
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     010   000000 400400   000000 000000   000000 000000   000000 000000    ................

DOBUF
 Sect OctLoc
   1     014   040040 055076   040040 040040   040040 040040   040040 040040      ->
   1     020   040040 040040   040040 040040   040040 040040   040040 040040
   1     054*  040040 040040   040040 040040   040040 040040

DONDX
 Sect OctLoc
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:167  
   1     057   000000 000004                                                    ....

CRLF
 Sect OctLoc
   3     000   015012 ******                                                    ....

(unnamed)
 Sect OctLoc
   5     000   000014 006000   000000 000000   000000 377640   000000 006000    ................
   5     004   000030 006000   000002 006000                                    ........
      559      160    1   END TCP$WRITE_D;
      560      161

PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:168  
--  Include file information  --

   CP_6.:LIBRARY  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure TCP$WRITE_D.
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:169  

 **** Variables and constants ****

  ****  Section 001  Data  TCP$WRITE_D

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    60-0-0/w UBIN        r     1 CHARNLEN                  14-0-0/c CHAR(140)   r     1 DOBUF
    57-0-0/w SBIN        r     1 DONDX                      0-0-0/d STRC(432)   r     1 WRITE_DO

  ****  Section 003 RoData TCP$WRITE_D

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(18)    r     1 CRLF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BUF_                      3-0-0/w PTR         r     1 @LCN
     5-0-0/w PTR         r     1 @PUSH                      6-0-0/w PTR         r     1 @URGENT
    *0-0-0/d VECT        r     1 BUF_                      *0-0-0/w UBIN        r     1 LCN
    *0-0-0/b BIT         r     1 PUSH                      *0-0-0/b BIT         r     1 URGENT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 DEBUG

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:170  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 CHARN                      0-0-0N  NULL        r     1 M$DO


   Procedure TCP$WRITE_D requires 52 words for executable code.
   Procedure TCP$WRITE_D requires 12 words of local(AUTO) storage.

    No errors detected in file TCF$FTP.:TCA2TSI    .
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:171  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:172  
          MINI XREF LISTING

BUF_
        10**DCL         7--PROC      141>>ASSIGN    142>>ASSIGN    146<>CALL
CHARN
       133**DCL       142>>ASSIGN
CHARNLEN
       134**DCL       133--IMP-SIZ   141<<ASSIGN    142>>ASSIGN    142>>ASSIGN    143>>ASSIGN
CRLF
       130**DCL       158--CALL
DEBUG
       136**DCL       140>>IF        153>>IF
DOBUF
       128**DCL       142<<ASSIGN    154--ASSIGN
DONDX
       129**DCL       142>>ASSIGN    143<<ASSIGN    143>>ASSIGN    153>>IF        154>>ASSIGN    156<<ASSIGN
LCN
         9**DCL         7--PROC      146<>CALL      151--ENTRY     158<>CALL
M$WRITE
        24**DCL-ENT   155--CALL
PUSH
        11**DCL         7--PROC      146<>CALL
TCP$WRITE
       137**DCL-ENT   146--CALL      158--CALL
URGENT
        12**DCL         7--PROC      146<>CALL
WRITE_DO
       113**DCL       155<>CALL
WRITE_DO.BUF_
       113**DCL       154<<ASSIGN
WRITE_DO.STATION_
       115**DCL       115--REDEF
WRITE_DO.V
       116**DCL       113--DCLINIT
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:173  
WRITE_DO.V.DVBYTE.VFC#
       122**DCL       122--REDEF
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:174  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:175  
              MINI UREF LISTING

M$ACCT      40**DCL-ENT
M$ACTIVATE      43**DCL-ENT
M$ALIB      36**DCL-ENT
M$ASUSER      38**DCL-ENT
M$ATTACH      45**DCL-ENT
M$BADPP      63**DCL-ENT
M$CGCTL      44**DCL-ENT
M$CGINFO      44**DCL-ENT
M$CHECK      25**DCL-ENT
M$CHGUNIT      83**DCL-ENT
M$CLOSE      23**DCL-ENT
M$CLRSTK      81**DCL-ENT
M$CMDVAR      92**DCL-ENT
M$CONFIG      53**DCL-ENT
M$CORRES      28**DCL-ENT
M$CPEXIT      37**DCL-ENT
M$CVM      61**DCL-ENT
M$CVOL      26**DCL-ENT
M$DCLFLD      53**DCL-ENT
M$DEACTIVATE      43**DCL-ENT
M$DELREC      25**DCL-ENT
M$DEQ      90**DCL-ENT
M$DETACH      45**DCL-ENT
M$DEVICE      27**DCL-ENT
M$DISPLAY      90**DCL-ENT
M$DISPRES      30**DCL-ENT
M$DLIB      36**DCL-ENT
M$DO     127**DCL
M$DRIBBLE      53**DCL-ENT
M$DRTN      81**DCL-ENT
M$DSUSER      38**DCL-ENT
M$ENQ      89**DCL-ENT
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:176  
M$EOM      48**DCL-ENT
M$ERASE      54**DCL-ENT
M$ERR      35**DCL-ENT
M$ERRMSG      86**DCL-ENT
M$EVENT      78**DCL-ENT
M$EXHUME      87**DCL-ENT
M$EXIT      35**DCL-ENT
M$EXTEND      27**DCL-ENT
M$FDP      59**DCL-ENT
M$FDS      58**DCL-ENT
M$FEBOOT      51**DCL-ENT
M$FECTL      52**DCL-ENT
M$FEDUMP      51**DCL-ENT
M$FID      86**DCL-ENT
M$FINDPROC      40**DCL-ENT
M$FSUSER      38**DCL-ENT
M$FVP      60**DCL-ENT
M$FWCG      44**DCL-ENT
M$GBPL      64**DCL-ENT
M$GDDL      60**DCL-ENT
M$GDP      59**DCL-ENT
M$GDS      58**DCL-ENT
M$GETDCB      29**DCL-ENT
M$GETMOUSE      69**DCL-ENT
M$GETPM      70**DCL-ENT
M$GJOB      88**DCL-ENT
M$GLINEATTR      48**DCL-ENT
M$GOODPP      63**DCL-ENT
M$GPLATEN      56**DCL-ENT
M$GPROMPT      55**DCL-ENT
M$GTRMATTR      49**DCL-ENT
M$GTRMCTL      47**DCL-ENT
M$GTRMTAB      50**DCL-ENT
M$GVP      59**DCL-ENT
M$HELP      86**DCL-ENT
M$INT      78**DCL-ENT
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:177  
M$INTRTN      39**DCL-ENT
M$IOQ      74**DCL-ENT
M$JOBSTATS      88**DCL-ENT
M$KEYIN      28**DCL-ENT
M$LDEV      23**DCL-ENT
M$LDTRC      36**DCL-ENT
M$LIMIT      29**DCL-ENT
M$LINES      28**DCL-ENT
M$LINK      35**DCL-ENT
M$MADMUCK      31**DCL-ENT
M$MAKUSER      62**DCL-ENT
M$MBS      30**DCL-ENT
M$MDFFLD      54**DCL-ENT
M$MERC      79**DCL-ENT
M$MERCS      80**DCL-ENT
M$MIRROR      74**DCL-ENT
M$MONINFO      91**DCL-ENT
M$MPL      64**DCL-ENT
M$NODEINFO      55**DCL-ENT
M$NXTUSR      89**DCL-ENT
M$OCMSG      87**DCL-ENT
M$OLAY      35**DCL-ENT
M$OPEN      23**DCL-ENT
M$PAS      64**DCL-ENT
M$PATHCON      87**DCL-ENT
M$PDS      58**DCL-ENT
M$PFIL      25**DCL-ENT
M$PLATEN      49**DCL-ENT
M$PRECORD      27**DCL-ENT
M$PROCNAME      40**DCL-ENT
M$PROFILE      51**DCL-ENT
M$PROMPT      47**DCL-ENT
M$RACST      31**DCL-ENT
M$RDSYSLOG      72**DCL-ENT
M$READ      24**DCL-ENT
M$RELDCB      29**DCL-ENT
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:178  
M$RELRES      30**DCL-ENT
M$RELSTARF      32**DCL-ENT
M$REM      32**DCL-ENT
M$RENV      79**DCL-ENT
M$REQUIRE      31**DCL-ENT
M$RETRY      80**DCL-ENT
M$RETRYS      80**DCL-ENT
M$REW      26**DCL-ENT
M$RLSFLD      54**DCL-ENT
M$RPRIV      82**DCL-ENT
M$RSPP      61**DCL-ENT
M$RSWITCH      83**DCL-ENT
M$RUE      89**DCL-ENT
M$SAD      62**DCL-ENT
M$SAVE      38**DCL-ENT
M$SCON      39**DCL-ENT
M$SCREECH      37**DCL-ENT
M$SENV      79**DCL-ENT
M$SETFMA      23**DCL-ENT
M$SETFP      52**DCL-ENT
M$SINPUT      50**DCL-ENT
M$SLCFLD      55**DCL-ENT
M$SMOUSE      69**DCL-ENT
M$SMPRT      61**DCL-ENT
M$SPRIV      82**DCL-ENT
M$SSC      62**DCL-ENT
M$SSWITCH      82**DCL-ENT
M$STATE      91**DCL-ENT
M$STD      63**DCL-ENT
M$STIMER      77**DCL-ENT
M$STLPP      60**DCL-ENT
M$STRAP      77**DCL-ENT
M$STRMATTR      49**DCL-ENT
M$STRMCTL      47**DCL-ENT
M$STRMTAB      50**DCL-ENT
M$SYMBIO      88**DCL-ENT
PL6.E3A0      #007=TCP$WRITE_D File=TCF$FTP.:TCA2TSI                             SUN 11/16/97 14:13 Page:179  
M$SYSCON      74**DCL-ENT
M$SYSID      92**DCL-ENT
M$TDCLOSE      73**DCL-ENT
M$TDIO      73**DCL-ENT
M$TDOPEN      72**DCL-ENT
M$TDREQCPU      73**DCL-ENT
M$TEMPWROC      67**DCL-ENT
M$TIME      90**DCL-ENT
M$TRAP      77**DCL-ENT
M$TRMISC      52**DCL-ENT
M$TRMPRG      48**DCL-ENT
M$TRTN      81**DCL-ENT
M$TRUNC      24**DCL-ENT
M$TTIMER      77**DCL-ENT
M$UC      47**DCL
M$UMPL      64**DCL-ENT
M$UNFID      86**DCL-ENT
M$UNLATCH      43**DCL-ENT
M$UNSHARE      40**DCL-ENT
M$USRFIELD      83**DCL-ENT
M$VIRTUAL      58**DCL-ENT
M$WAIT      81**DCL-ENT
M$WEOF      26**DCL-ENT
M$WRSYSLOG      72**DCL-ENT
M$XCON      78**DCL-ENT
M$XCONRTN      39**DCL-ENT
M$XEQTIME      91**DCL-ENT
M$XFLUSH      32**DCL-ENT
M$XMOUSE      69**DCL-ENT
M$XXX      35**DCL-ENT
M$YC      37**DCL-ENT
TCP$WRITE_D       7**PROC
TELNET_EOL     151**ENTRY
