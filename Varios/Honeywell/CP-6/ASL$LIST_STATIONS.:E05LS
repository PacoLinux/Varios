VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:1    
        1        1        /*M* ASL$LIST_ALL_STATIONS:  routine to handle LIST STATION cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_STATIONS: PROC;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_STATIONS
       13       13             CALL:     CALL ASL$LIST_ALL_STATIONS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_STATIONS is a subroutine to handle
       17       17                           the LIST STATION command for SUPER.
       18       18                           This routine will read the 'TERM' record from
       19       19                           :HLP into data segemnt 1.  It will then cycle
       20       20                           through the 'TERM' record looking for matches
       21       21                           to the selection criteria as input in the
       22       22                           LIST/DISPLAY command.  If a match is found, it
       23       23                           will attempt to validate the station.  If the
       24       24                           station is valid, this routine will do either
       25       25                           of two things.  It will call the display routine
       26       26                           if the command was a DISPLAY command, or it will
       27       27                           put the vector framing the station name into the
       28       28                           formatter vector list.  If the station is found
       29       29                           to be invalid, this routine will set a flag so
       30       30                           that after it is done processing all stations it
       31       31                           will rewrite the TERM record.
       32       32
       33       33                  MEMORY REQUIREMENTS:
       34       34                           For all of the routines that deal with listing/
       35       35                           displaying stations:
       36       36
       37       37                            ASL$LIST_ALL_STATIONS
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:2    
       38       38                            ASL$DISP_ONE_STATION
       39       39                            ASV$VALIDATE_STATION
       40       40
       41       41                            The 'TERM' record from :HLP will be read into
       42       42                            data segment 1.  It will be used in
       43       43                            ASL$LIST_ALL_STATIONS, and possibly will be
       44       44                            updated in ASV$VALIDATE_STATION.
       45       45                            The 'TWSNxxxx' record from :HLP will be read
       46       46                            into data segment 2 by the validation routine.
       47       47                            It will be used by the DISP_ONE_STATION routine
       48       48                            as well.  The 'xxxxxxxxSTATION' record from :HLP
       49       49                            will be read into AUTO by the validation routine.
       50       50                            The individual device records, 'xxxxxxxx*', from
       51       51                            :HLP will be read into AUTO by the
       52       52                            ASL$DISP_ONE_STATION routine.
       53       53        */
       54       54        /********************************************************************/
       55       55        /*   Include files   include files   include files   include files  */
       56       56        /********************************************************************/
       57       57        %INCLUDE AS_PERR_C;
       58      659        %INCLUDE AS_SUPER_C;
       59     1094        %INCLUDE AS_SUBS_C;
       60     2508        %INCLUDE AS_MAC_C;
       61     2588        %INCLUDE AS_ENTRIES_M;
       62     3638        %INCLUDE AS_SSUBS_C;
       63     3730        %INCLUDE B_ERRORS_C;
       64     4857        %INCLUDE CP_6_SUBS;
       65     5397        %INCLUDE KL_MACRO_C;
       66     8749        %INCLUDE KL_SUPER_C;
       67    11651        %INCLUDE XU_MACRO_C;
       68    14757        %INCLUDE XU_FORMAT_C;
       69    14919        %INCLUDE AS_SUPER_R;
       70    17935        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:3    
       71    17936        /********************************************************************/
       72    17937        /*   Static data     static data     static data     static data    */
       73    17938        /********************************************************************/
       74    17939    1   DCL WSNCVT$         PTR STATIC;
       75    17940        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:4    
       76    17941        /********************************************************************/
       77    17942        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       78    17943        /********************************************************************/
       79    17944        %ASV$VALIDATE_STATION ;
       80    17947        %ASB$ENQ_HLP ;
       81    17950        %ASB$DEQ_HLP ;
       82    17953        %ASB$READ_HLP ;
       83    17956        %ASB$WRITE_HLP ;
       84    17959        %ASH$ERROR ;
       85    17962        %ASH$WARN ;
       86    17965        %ASH$INFO ;
       87    17968        %ASL$DISP_ONE_STATION;
       88    17971        %ASB$WILD_MATCH ;
       89    17974        %ASA$ERROR ;
       90    17977    1   DCL X$FORMAT ENTRY(1) ;
       91    17978        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:5    
       92    17979        /********************************************************************/
       93    17980        /*   Local based     local based     local based     local based    */
       94    17981        /********************************************************************/
       95    17982        %KL_WSNCVT ( NAME = KL$WSNCVT,STCLASS="BASED(WSNCVT$)");
       96    17989        %PARSE$OUT ( NAME=P$B, STCLASS="BASED(NODE$)",
       97    17990                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       98    18035        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       99    18073        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:6    
      100    18074        /********************************************************************/
      101    18075        /*   Auto data       auto data       auto data       auto data      */
      102    18076        /********************************************************************/
      103    18077    1   DCL ALL_STATIONS      BIT(1);
      104    18078    1   DCL CHANGE            BIT(1);
      105    18079    1   DCL CODE2             UBIN;
      106    18080    1   DCL CURRENT_STATION   CHAR(8);
      107    18081    1   DCL DISP              BIT(1);
      108    18082    1   DCL DISP_STATIONS     SBIN;
      109    18083    1   DCL FOUND             BIT(1);
      110    18084    1   DCL I                 UBIN;
      111    18085    1   DCL J                 UBIN;
      112    18086    1   DCL JCL               BIT(1);
      113    18087    1   DCL K                 UBIN;
      114    18088    1   DCL STAT_ARS          UBIN;
      115    18089    1   DCL TEMP_CHANGE       BIT(1);
      116    18090    1   DCL 1 TNAME ,
      117    18091    1          2 COUNT        UBIN BYTE,
      118    18092    1          2 TEXT         CHAR(8);
      119    18093    1   DCL WILD_CARD         BIT(1);
      120    18094        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:7    
      121    18095        /********************************************************************/
      122    18096        /*   Constant data   constant data   constant data   constant data  */
      123    18097        /********************************************************************/
      124    18098    1   DCL STATION_STR    CHAR(0) CONSTANT INIT('station');
      125    18099    1   DCL STATIONS_STR   CHAR(0) CONSTANT INIT('stations');
      126    18100    1   DCL DISPLAY_STR    CHAR(0) CONSTANT INIT (' displayed.');
      127    18101    1   DCL LIST_STR       CHAR(0) CONSTANT INIT (' listed.');
      128    18102        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:8    
      129    18103        /********************************************************************/
      130    18104        /*   Procedure       procedure       procedure       procedure      */
      131    18105        /********************************************************************/
      132    18106    1   CHANGE = %NO#;
      133    18107        /*
      134    18108          Setup and get the 'TERM' record from :HLP
      135    18109        */
      136    18110    1   WSNCVT$ = DSEG1$;
      137    18111    1   USERS_KEY.COUNT = 4;
      138    18112    1   USERS_KEY.TW.NAME = 'TERM';
      139    18113    1   STAT_ARS = DSEG1SIZE;
      140    18114    1   CALL ASB$ENQ_HLP;
      141    18115    2   CALL ASB$READ_HLP(WSNCVT$ ,STAT_ARS, 1 ) WHENALTRETURN DO;
      142    18116    2      CALL ASA$ERROR ( USERS_KEY, E$UNABLE_TO_READ_HLP);
      143    18117    2      CALL ASB$DEQ_HLP;
      144    18118    2      RETURN;
      145    18119    2      END;
      146    18120        /*
      147    18121          More setup and decode the nodes
      148    18122        */
      149    18123    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      150    18124    1   JCL = %NO#;
      151    18125    1   WILD_CARD = %NO#;
      152    18126    1   TNAME.TEXT = ' ';
      153    18127    1   TNAME.COUNT = 0;
      154    18128    1   DISP_STATIONS = 0;
      155    18129
      156    18130    2   DO SELECT (CODE);
      157    18131
      158    18132    2      SELECT (%LIST_ALL_VAL);
      159    18133
      160    18134    2      DISP = %NO#;
      161    18135
      162    18136    2      SELECT (%DISPLAY_ALL_VAL);
      163    18137
      164    18138    2      DISP = %YES#;
      165    18139    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:9    
      166    18140    2         JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      167    18141    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN
      168    18142    2            JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);
      169    18143
      170    18144    2      SELECT (%LIST_STATION_VAL);
      171    18145
      172    18146    2      DISP = %NO#;
      173    18147    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      174    18148    3         TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      175    18149    3         TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      176    18150    3         END; /*  Number of sublocks > 1  */
      177    18151
      178    18152    2      SELECT (%DISPLAY_STATION_VAL);
      179    18153
      180    18154    2      DISP = %YES#;
      181    18155    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      182    18156    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      183    18157
      184    18158    4         DO SELECT (CODE2);
      185    18159
      186    18160    4            SELECT (%STATION_NAME_WILD_VAL);
      187    18161
      188    18162    4            TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      189    18163    4            TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      190    18164
      191    18165    4            SELECT (%JCL_VAL);
      192    18166
      193    18167    4            JCL = %YES#;
      194    18168
      195    18169    4            END;  /* Do case (CODE2) */
      196    18170
      197    18171    3         END;  /*  Do i  */
      198    18172
      199    18173    2      END;  /*  Do case (code)  */
      200    18174
      201    18175    1   IF TNAME.COUNT = 0 THEN
      202    18176    1      ALL_STATIONS = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:10   
      203    18177    1   ELSE IF TNAME.TEXT = '?' THEN
      204    18178    1         ALL_STATIONS = %YES#;
      205    18179    2      ELSE DO;
      206    18180    2         ALL_STATIONS = %NO#;
      207    18181    2         CALL INDEX (J,'?',TNAME.TEXT)
      208    18182    3         WHENRETURN DO;
      209    18183    3            WILD_CARD = %YES#;
      210    18184    3            END; /*  Whenreturn from index  */
      211    18185    3         WHENALTRETURN DO;
      212    18186    3            WILD_CARD = %NO#;
      213    18187    3            END; /* Whenaltreturn  */
      214    18188    2         END;  /*  Else  */
      215    18189
      216    18190    1   FDS.NVECS# = 0;
      217    18191    1   FDS.WRAPTAB# = 1;
      218    18192    2   IF JCL THEN DO;
      219    18193    2      CALL CONCAT (FMT_BUF, '%1/"', STATIONS_STR, '%1/');
      220    18194    2      FDS.FMT_.BOUND = LENGTHC (STATIONS_STR) + 6;
      221    18195    2      END;   /*  Jcl  */
      222    18196    2   ELSE DO;
      223    18197    2      CALL CONCAT (FMT_BUF, '%1/', STATIONS_STR, '%1/');
      224    18198    2      FDS.FMT_.BOUND = LENGTHC (STATIONS_STR) + 5;
      225    18199    2      END;  /*  Not jcl  */
      226    18200    1   FDS.TABDFLT# = 10;
      227    18201    1   CALL X$FORMAT (FDS);
      228    18202
      229    18203    1   FDS.NVECS# = 0;
      230    18204    1   STATION_LOOP:
      231    18205    2   DO I = 0 TO KL$WSNCVT.LTWSN;
      232    18206    2      FOUND = %NO#;
      233    18207    2      CALL INDEX (J,' ',KL$WSNCVT.WSN(I));
      234    18208    2      IF J=0 THEN J=1;
      235    18209    2      IF ALL_STATIONS THEN
      236    18210    2         IF KL$WSNCVT.WSN(I) = ' ' THEN
      237    18211    2            FOUND = %NO#;
      238    18212    2         ELSE
      239    18213    2            FOUND = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:11   
      240    18214    3      ELSE IF WILD_CARD THEN DO;
      241    18215    3            K = TNAME.COUNT;
      242    18216    3            CALL ASB$WILD_MATCH (J, KL$WSNCVT.WSN(I), K, TNAME.TEXT)
      243    18217    4            WHENRETURN DO;
      244    18218    4               FOUND = %YES#;
      245    18219    4               END; /*  Whenreturn  */
      246    18220    3            END; /*  If WILD_CARD  */
      247    18221    2         ELSE
      248    18222    2            IF KL$WSNCVT.WSN(I) = TNAME.TEXT THEN
      249    18223    2               FOUND = %YES#;
      250    18224
      251    18225    2      IF FOUND THEN
      252    18226    2         CALL ASV$VALIDATE_STATION (KL$WSNCVT.WSN(I), I)
      253    18227    3         WHENRETURN DO;
      254    18228    3            IF DISP THEN
      255    18229    4            DO;
      256    18230    4               CALL ASL$DISP_ONE_STATION (I, JCL);
      257    18231    4               END; /*  If disp  */
      258    18232    4            ELSE DO;
      259    18233    5               IF DISP_STATIONS = 0 THEN DO;
      260    18234    5                  CALL CONCAT (FMT_BUF, '%\', SUBSTR(KL$WSNCVT.WSN(I),0,J));
      261    18235    5                  FDS.FMT_.BOUND = J + 1;
      262    18236    5                  END; /*  DISP_STATIONS = 0  */
      263    18237    5               ELSE DO;
      264    18238    5                  CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(KL$WSNCVT.WSN(I),0,J));
      265    18239    5                  FDS.FMT_.BOUND = J + 7;
      266    18240    5                  END; /*  Else  */
      267    18241    4               CALL X$FORMAT (FDS);
      268    18242    4               END; /*  Else  disp  */
      269    18243    3            DISP_STATIONS = DISP_STATIONS + 1;
      270    18244    3            END; /*  Whenreturn  */
      271    18245    3         WHENALTRETURN DO;
      272    18246    3            CHANGE = %YES#;
      273    18247    3            END; /* Whenaltreturn  */
      274    18248    2      IF FOUND AND NOT WILD_CARD AND NOT ALL_STATIONS THEN
      275    18249    2         EXIT STATION_LOOP;    /*  Single station  */
      276    18250    2      END;  /*  Loop thru stations */
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:12   
      277    18251    1   IF NOT ALL_STATIONS AND NOT WILD_CARD AND NOT FOUND
      278    18252    2   THEN DO;
      279    18253    2      AS_FIELD1.COUNT = TNAME.COUNT;
      280    18254    2      AS_FIELD1.TEXT = TNAME.TEXT;
      281    18255           %SCREAM (ERR# = E$STAT_NO_EXIST, LEVEL=ERROR, MID = 'A');
      282    18270    2      END; /* if not all stations and not wild card and not found */
      283    18271    1   IF CHANGE THEN
      284    18272    2   DO;
      285    18273    2      USERS_KEY.COUNT = 4;
      286    18274    2      USERS_KEY.TXTC  = 'TERM';
      287    18275    2      CALL ASB$WRITE_HLP( WSNCVT$, STAT_ARS );
      288    18276    2      END; /*  If change  */
      289    18277    1   CALL ASB$DEQ_HLP;
      290    18278
      291    18279    2   IF NOT DISP THEN DO;
      292    18280    2      FMT_BUF = '%\%/';
      293    18281    2      FDS.FMT_.BOUND = 3;
      294    18282    2      FDS.NVECS# = 0;
      295    18283    2      CALL X$FORMAT(FDS);
      296    18284    2      END; /*  If not disp  */
      297    18285    2   IF NOT JCL THEN DO;
      298    18286    2      FMT_VEC(0) = VECTOR (DISP_STATIONS);
      299    18287    2      IF DISP_STATIONS = 1 THEN
      300    18288    3      DO;
      301    18289    3         FMT_VEC(1) = VECTOR (STATION_STR);
      302    18290    3         END; /*  DISP_STATIONS = 1  */
      303    18291    3      ELSE DO;
      304    18292    3         FMT_VEC(1) = VECTOR (STATIONS_STR);
      305    18293    3         END; /*  DISP_STATIONS ~= 1  */
      306    18294    2      IF DISP THEN
      307    18295    3      DO;
      308    18296    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      309    18297    3         END; /*  If disp  */
      310    18298    3      ELSE DO;
      311    18299    3         FMT_VEC(2) = VECTOR (LIST_STR);
      312    18300    3         END; /*  If ~ disp  */
      313    18301    2      FDS.NVECS# = 3;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:13   
      314    18302    2      FMT_BUF = '   %5D %A %A.';
      315    18303    2      FDS.FMT_.BOUND = 12;
      316    18304    2      CALL X$FORMAT(FDS);
      317    18305    2      END; /*  Not jcl  */
      318    18306    1   FDS.WRAPTAB# = 4;
      319    18307    1   RETURN;
      320    18308    1   END ASL$LIST_ALL_STATIONS;
      321    18309        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:14   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_STATIONS.

   Procedure ASL$LIST_ALL_STATIONS requires 434 words for executable code.
   Procedure ASL$LIST_ALL_STATIONS requires 26 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:15   

 Object Unit name= ASL$LIST_ALL_STATIONS                      File name= ASL$LIST_STATIONS.:E05TOU
 UTS= JUL 29 '97 10:20:00.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   Data  even  none     1      1  ASL$LIST_ALL_STATIONS
    2  RoData even  UTS     20     24  ASL$LIST_ALL_STATIONS
    3   Proc  even  none   434    662  ASL$LIST_ALL_STATIONS
    4  RoData even  none    22     26  ASL$LIST_ALL_STATIONS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  ASL$LIST_ALL_STATIONS
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:16   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASL$DISP_ONE_STATION
 yes     yes           Std       2 ASB$WRITE_HLP
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       1 X$FORMAT
         yes           Std       3 ASA$ERROR
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       0 ASB$DEQ_HLP
         yes           Std       2 ASH$ERROR
 yes     yes           Std       2 ASV$VALIDATE_STATION
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:17   


        1        1        /*M* ASL$LIST_ALL_STATIONS:  routine to handle LIST STATION cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_STATIONS: PROC;

      9  3 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         3 000001   000032 000000                    ZERO    26,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_STATIONS
       13       13             CALL:     CALL ASL$LIST_ALL_STATIONS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_STATIONS is a subroutine to handle
       17       17                           the LIST STATION command for SUPER.
       18       18                           This routine will read the 'TERM' record from
       19       19                           :HLP into data segemnt 1.  It will then cycle
       20       20                           through the 'TERM' record looking for matches
       21       21                           to the selection criteria as input in the
       22       22                           LIST/DISPLAY command.  If a match is found, it
       23       23                           will attempt to validate the station.  If the
       24       24                           station is valid, this routine will do either
       25       25                           of two things.  It will call the display routine
       26       26                           if the command was a DISPLAY command, or it will
       27       27                           put the vector framing the station name into the
       28       28                           formatter vector list.  If the station is found
       29       29                           to be invalid, this routine will set a flag so
       30       30                           that after it is done processing all stations it
       31       31                           will rewrite the TERM record.
       32       32
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:18   
       33       33                  MEMORY REQUIREMENTS:
       34       34                           For all of the routines that deal with listing/
       35       35                           displaying stations:
       36       36
       37       37                            ASL$LIST_ALL_STATIONS
       38       38                            ASL$DISP_ONE_STATION
       39       39                            ASV$VALIDATE_STATION
       40       40
       41       41                            The 'TERM' record from :HLP will be read into
       42       42                            data segment 1.  It will be used in
       43       43                            ASL$LIST_ALL_STATIONS, and possibly will be
       44       44                            updated in ASV$VALIDATE_STATION.
       45       45                            The 'TWSNxxxx' record from :HLP will be read
       46       46                            into data segment 2 by the validation routine.
       47       47                            It will be used by the DISP_ONE_STATION routine
       48       48                            as well.  The 'xxxxxxxxSTATION' record from :HLP
       49       49                            will be read into AUTO by the validation routine.
       50       50                            The individual device records, 'xxxxxxxx*', from
       51       51                            :HLP will be read into AUTO by the
       52       52                            ASL$DISP_ONE_STATION routine.
       53       53        */
       54       54        /********************************************************************/
       55       55        /*   Include files   include files   include files   include files  */
       56       56        /********************************************************************/
       57       57        %INCLUDE AS_PERR_C;
       58      659        %INCLUDE AS_SUPER_C;
       59     1094        %INCLUDE AS_SUBS_C;
       60     2508        %INCLUDE AS_MAC_C;
       61     2588        %INCLUDE AS_ENTRIES_M;
       62     3638        %INCLUDE AS_SSUBS_C;
       63     3730        %INCLUDE B_ERRORS_C;
       64     4857        %INCLUDE CP_6_SUBS;
       65     5397        %INCLUDE KL_MACRO_C;
       66     8749        %INCLUDE KL_SUPER_C;
       67    11651        %INCLUDE XU_MACRO_C;
       68    14757        %INCLUDE XU_FORMAT_C;
       69    14919        %INCLUDE AS_SUPER_R;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:19   
       70    17935        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:20   
       71    17936        /********************************************************************/
       72    17937        /*   Static data     static data     static data     static data    */
       73    17938        /********************************************************************/
       74    17939    1   DCL WSNCVT$         PTR STATIC;
       75    17940        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:21   
       76    17941        /********************************************************************/
       77    17942        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       78    17943        /********************************************************************/
       79    17944        %ASV$VALIDATE_STATION ;
       80    17947        %ASB$ENQ_HLP ;
       81    17950        %ASB$DEQ_HLP ;
       82    17953        %ASB$READ_HLP ;
       83    17956        %ASB$WRITE_HLP ;
       84    17959        %ASH$ERROR ;
       85    17962        %ASH$WARN ;
       86    17965        %ASH$INFO ;
       87    17968        %ASL$DISP_ONE_STATION;
       88    17971        %ASB$WILD_MATCH ;
       89    17974        %ASA$ERROR ;
       90    17977    1   DCL X$FORMAT ENTRY(1) ;
       91    17978        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:22   
       92    17979        /********************************************************************/
       93    17980        /*   Local based     local based     local based     local based    */
       94    17981        /********************************************************************/
       95    17982        %KL_WSNCVT ( NAME = KL$WSNCVT,STCLASS="BASED(WSNCVT$)");
       96    17989        %PARSE$OUT ( NAME=P$B, STCLASS="BASED(NODE$)",
       97    17990                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       98    18035        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       99    18073        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:23   
      100    18074        /********************************************************************/
      101    18075        /*   Auto data       auto data       auto data       auto data      */
      102    18076        /********************************************************************/
      103    18077    1   DCL ALL_STATIONS      BIT(1);
      104    18078    1   DCL CHANGE            BIT(1);
      105    18079    1   DCL CODE2             UBIN;
      106    18080    1   DCL CURRENT_STATION   CHAR(8);
      107    18081    1   DCL DISP              BIT(1);
      108    18082    1   DCL DISP_STATIONS     SBIN;
      109    18083    1   DCL FOUND             BIT(1);
      110    18084    1   DCL I                 UBIN;
      111    18085    1   DCL J                 UBIN;
      112    18086    1   DCL JCL               BIT(1);
      113    18087    1   DCL K                 UBIN;
      114    18088    1   DCL STAT_ARS          UBIN;
      115    18089    1   DCL TEMP_CHANGE       BIT(1);
      116    18090    1   DCL 1 TNAME ,
      117    18091    1          2 COUNT        UBIN BYTE,
      118    18092    1          2 TEXT         CHAR(8);
      119    18093    1   DCL WILD_CARD         BIT(1);
      120    18094        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:24   
      121    18095        /********************************************************************/
      122    18096        /*   Constant data   constant data   constant data   constant data  */
      123    18097        /********************************************************************/
      124    18098    1   DCL STATION_STR    CHAR(0) CONSTANT INIT('station');
      125    18099    1   DCL STATIONS_STR   CHAR(0) CONSTANT INIT('stations');
      126    18100    1   DCL DISPLAY_STR    CHAR(0) CONSTANT INIT (' displayed.');
      127    18101    1   DCL LIST_STR       CHAR(0) CONSTANT INIT (' listed.');
      128    18102        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:25   
      129    18103        /********************************************************************/
      130    18104        /*   Procedure       procedure       procedure       procedure      */
      131    18105        /********************************************************************/
      132    18106    1   CHANGE = %NO#;

  18106  3 000002   200004 450100                    STZ     CHANGE,,AUTO

      133    18107        /*
      134    18108          Setup and get the 'TERM' record from :HLP
      135    18109        */
      136    18110    1   WSNCVT$ = DSEG1$;

  18110  3 000003   000000 236000 xsym               LDQ     DSEG1$
         3 000004   000000 756000 1                  STQ     WSNCVT$

      137    18111    1   USERS_KEY.COUNT = 4;

  18111  3 000005   004000 236003                    LDQ     2048,DU
         3 000006   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      138    18112    1   USERS_KEY.TW.NAME = 'TERM';

  18112  3 000007   040000 100400                    MLR     fill='040'O
         3 000010   000011 000004 2                  ADSC9   LIST_STR+2               cn=0,n=4
         3 000011   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4

      139    18113    1   STAT_ARS = DSEG1SIZE;

  18113  3 000012   000000 235000 xsym               LDA     DSEG1SIZE
         3 000013   200017 755100                    STA     STAT_ARS,,AUTO

      140    18114    1   CALL ASB$ENQ_HLP;

  18114  3 000014   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000015   000000 701000 xent               TSX1    ASB$ENQ_HLP
         3 000016   000000 011000                    NOP     0

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:26   
      141    18115    2   CALL ASB$READ_HLP(WSNCVT$ ,STAT_ARS, 1 ) WHENALTRETURN DO;

  18115  3 000017   000000 236000 4                  LDQ     0
         3 000020   200030 756100                    STQ     WILD_CARD+4,,AUTO
         3 000021   200017 630500                    EPPR0   STAT_ARS,,AUTO
         3 000022   200027 450500                    STP0    WILD_CARD+3,,AUTO
         3 000023   000001 236000 4                  LDQ     1
         3 000024   200026 756100                    STQ     WILD_CARD+2,,AUTO
         3 000025   200026 630500                    EPPR0   WILD_CARD+2,,AUTO
         3 000026   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000027   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000030   000032 702000 3                  TSX2    s:18116
         3 000031   000042 710000 3                  TRA     s:18123

      142    18116    2      CALL ASA$ERROR ( USERS_KEY, E$UNABLE_TO_READ_HLP);

  18116  3 000032   000003 630400 4                  EPPR0   3
         3 000033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000034   000000 701000 xent               TSX1    ASA$ERROR
         3 000035   000000 011000                    NOP     0

      143    18117    2      CALL ASB$DEQ_HLP;

  18117  3 000036   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000037   000000 701000 xent               TSX1    ASB$DEQ_HLP
         3 000040   000000 011000                    NOP     0

      144    18118    2      RETURN;

  18118  3 000041   000000 702200 xent               TSX2  ! X66_ARET

      145    18119    2      END;
      146    18120        /*
      147    18121          More setup and decode the nodes
      148    18122        */
      149    18123    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:27   
  18123  3 000042   000003 470400 xsym               LDP0    P_PCB+3
         3 000043   000003 471500                    LDP1    3,,PR0
         3 000044   100000 236100                    LDQ     0,,PR1
         3 000045   777777 376007                    ANQ     -1,DL
         3 000046   000000 756000 xsym               STQ     CODE

      150    18124    1   JCL = %NO#;

  18124  3 000047   200015 450100                    STZ     JCL,,AUTO

      151    18125    1   WILD_CARD = %NO#;

  18125  3 000050   200024 450100                    STZ     WILD_CARD,,AUTO

      152    18126    1   TNAME.TEXT = ' ';

  18126  3 000051   000035 235000 xsym               LDA     B_VECTNIL+29
         3 000052   000035 236000 xsym               LDQ     B_VECTNIL+29
         3 000053   200022 757100                    STAQ    TNAME+1,,AUTO

      153    18127    1   TNAME.COUNT = 0;

  18127  3 000054   200021 450100                    STZ     TNAME,,AUTO

      154    18128    1   DISP_STATIONS = 0;

  18128  3 000055   200011 450100                    STZ     DISP_STATIONS,,AUTO

      155    18129
      156    18130    2   DO SELECT (CODE);

  18130  3 000056   000000 236000 xsym               LDQ     CODE
         3 000057   000025 116007                    CMPQ    21,DL
         3 000060   000071 602000 3                  TNC     s:18130+11
         3 000061   000130 600000 3                  TZE     s:18146
         3 000062   000144 116007                    CMPQ    100,DL
         3 000063   000066 602000 3                  TNC     s:18130+8
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:28   
         3 000064   000076 600000 3                  TZE     s:18138
         3 000065   000222 710000 3                  TRA     s:18175
         3 000066   000134 116007                    CMPQ    92,DL
         3 000067   000222 601000 3                  TNZ     s:18175
         3 000070   000151 710000 3                  TRA     s:18154
         3 000071   000022 116007                    CMPQ    18,DL
         3 000072   000222 601000 3                  TNZ     s:18175
         3 000073   000074 710000 3                  TRA     s:18134

      157    18131
      158    18132    2      SELECT (%LIST_ALL_VAL);

      159    18133
      160    18134    2      DISP = %NO#;

  18134  3 000074   200010 450100                    STZ     DISP,,AUTO
         3 000075   000222 710000 3                  TRA     s:18175

      161    18135
      162    18136    2      SELECT (%DISPLAY_ALL_VAL);

      163    18137
      164    18138    2      DISP = %YES#;

  18138  3 000076   400000 236003                    LDQ     -131072,DU
         3 000077   200010 756100                    STQ     DISP,,AUTO

      165    18139    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN

  18139  3 000100   000003 471500                    LDP1    3,,PR0
         3 000101   100001 220100                    LDX0    1,,PR1
         3 000102   000002 100003                    CMPX0   2,DU
         3 000103   000115 601000 3                  TNZ     s:18141

      166    18140    2         JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

  18140  3 000104   100004 473500                    LDP3    4,,PR1
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:29   
         3 000105   400000 221003                    LDX1    -131072,DU
         3 000106   300000 722100                    LXL2    0,,PR3
         3 000107   000001 102003                    CMPX2   1,DU
         3 000110   000112 600000 3                  TZE     s:18140+6
         3 000111   000000 221003                    LDX1    0,DU
         3 000112   000000 636011                    EAQ     0,X1
         3 000113   200015 756100                    STQ     JCL,,AUTO
         3 000114   000222 710000 3                  TRA     s:18175

      167    18141    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN

  18141  3 000115   000000 100003                    CMPX0   0,DU
         3 000116   000222 600000 3                  TZE     s:18175

      168    18142    2            JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);

  18142  3 000117   100003 473500                    LDP3    3,,PR1
         3 000120   400000 221003                    LDX1    -131072,DU
         3 000121   300000 722100                    LXL2    0,,PR3
         3 000122   000001 102003                    CMPX2   1,DU
         3 000123   000125 600000 3                  TZE     s:18142+6
         3 000124   000000 221003                    LDX1    0,DU
         3 000125   000000 636011                    EAQ     0,X1
         3 000126   200015 756100                    STQ     JCL,,AUTO
         3 000127   000222 710000 3                  TRA     s:18175

      169    18143
      170    18144    2      SELECT (%LIST_STATION_VAL);

      171    18145
      172    18146    2      DISP = %NO#;

  18146  3 000130   200010 450100                    STZ     DISP,,AUTO

      173    18147    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  18147  3 000131   000001 220100                    LDX0    1,,PR0
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:30   
         3 000132   000002 100003                    CMPX0   2,DU
         3 000133   000222 602000 3                  TNC     s:18175

      174    18148    3         TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  18148  3 000134   000004 471500                    LDP1    4,,PR0
         3 000135   100004 236100                    LDQ     4,,PR1
         3 000136   000033 772000                    QRL     27
         3 000137   000000 621006                    EAX1    0,QL
         3 000140   040100 100540                    MLR     fill='040'O
         3 000141   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         3 000142   200022 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8

      175    18149    3         TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  18149  3 000143   000004 471500                    LDP1    4,,PR0
         3 000144   100004 236100                    LDQ     4,,PR1
         3 000145   000033 772000                    QRL     27
         3 000146   000033 736000                    QLS     27
         3 000147   200021 756100                    STQ     TNAME,,AUTO

      176    18150    3         END; /*  Number of sublocks > 1  */

  18150  3 000150   000222 710000 3                  TRA     s:18175

      177    18151
      178    18152    2      SELECT (%DISPLAY_STATION_VAL);

      179    18153
      180    18154    2      DISP = %YES#;

  18154  3 000151   400000 236003                    LDQ     -131072,DU
         3 000152   200010 756100                    STQ     DISP,,AUTO

      181    18155    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  18155  3 000153   000001 235007                    LDA     1,DL
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:31   
         3 000154   200013 755100                    STA     I,,AUTO
         3 000155   000215 710000 3                  TRA     s:18171+3

      182    18156    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  18156  3 000156   000003 470400 xsym               LDP0    P_PCB+3
         3 000157   200013 720100                    LXL0    I,,AUTO
         3 000160   000003 471510                    LDP1    3,X0,PR0
         3 000161   100000 236100                    LDQ     0,,PR1
         3 000162   777777 376007                    ANQ     -1,DL
         3 000163   200005 756100                    STQ     CODE2,,AUTO

      183    18157
      184    18158    4         DO SELECT (CODE2);

  18158  3 000164   000311 116007                    CMPQ    201,DL
         3 000165   000170 602000 3                  TNC     s:18158+4
         3 000166   000173 600000 3                  TZE     s:18162
         3 000167   000212 710000 3                  TRA     s:18171
         3 000170   000001 116007                    CMPQ    1,DL
         3 000171   000212 601000 3                  TNZ     s:18171
         3 000172   000210 710000 3                  TRA     s:18167

      185    18159
      186    18160    4            SELECT (%STATION_NAME_WILD_VAL);

      187    18161
      188    18162    4            TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  18162  3 000173   000004 473500                    LDP3    4,,PR0
         3 000174   300004 236100                    LDQ     4,,PR3
         3 000175   000033 772000                    QRL     27
         3 000176   000000 621006                    EAX1    0,QL
         3 000177   040100 100540                    MLR     fill='040'O
         3 000200   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         3 000201   200022 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:32   
      189    18163    4            TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  18163  3 000202   000004 471500                    LDP1    4,,PR0
         3 000203   100004 236100                    LDQ     4,,PR1
         3 000204   000033 772000                    QRL     27
         3 000205   000033 736000                    QLS     27
         3 000206   200021 756100                    STQ     TNAME,,AUTO
         3 000207   000212 710000 3                  TRA     s:18171

      190    18164
      191    18165    4            SELECT (%JCL_VAL);

      192    18166
      193    18167    4            JCL = %YES#;

  18167  3 000210   400000 236003                    LDQ     -131072,DU
         3 000211   200015 756100                    STQ     JCL,,AUTO

      194    18168
      195    18169    4            END;  /* Do case (CODE2) */

      196    18170
      197    18171    3         END;  /*  Do i  */

  18171  3 000212   200013 235100                    LDA     I,,AUTO
         3 000213   000001 035007                    ADLA    1,DL
         3 000214   200013 755100                    STA     I,,AUTO
         3 000215   000001 236100                    LDQ     1,,PR0
         3 000216   000022 772000                    QRL     18
         3 000217   200013 116100                    CMPQ    I,,AUTO
         3 000220   000222 600000 3                  TZE     s:18175
         3 000221   000156 603000 3                  TRC     s:18156

      198    18172
      199    18173    2      END;  /*  Do case (code)  */

      200    18174
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:33   
      201    18175    1   IF TNAME.COUNT = 0 THEN

  18175  3 000222   200021 236100                    LDQ     TNAME,,AUTO
         3 000223   777000 316003                    CANQ    -512,DU
         3 000224   000230 601000 3                  TNZ     s:18177

      202    18176    1      ALL_STATIONS = %YES#;

  18176  3 000225   400000 236003                    LDQ     -131072,DU
         3 000226   200003 756100                    STQ     ALL_STATIONS,,AUTO
         3 000227   000250 710000 3                  TRA     s:18190

      203    18177    1   ELSE IF TNAME.TEXT = '?' THEN

  18177  3 000230   200022 237100                    LDAQ    TNAME+1,,AUTO
         3 000231   000006 117000 4                  CMPAQ   6
         3 000232   000236 601000 3                  TNZ     s:18180

      204    18178    1         ALL_STATIONS = %YES#;

  18178  3 000233   400000 236003                    LDQ     -131072,DU
         3 000234   200003 756100                    STQ     ALL_STATIONS,,AUTO
         3 000235   000250 710000 3                  TRA     s:18190

      205    18179    2      ELSE DO;

      206    18180    2         ALL_STATIONS = %NO#;

  18180  3 000236   200003 450100                    STZ     ALL_STATIONS,,AUTO

      207    18181    2         CALL INDEX (J,'?',TNAME.TEXT)

  18181  3 000237   000000 124500                    SCM     mask='000'O
         3 000240   200022 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8
         3 000241   000006 000001 4                  ADSC9   6                        cn=0,n=1
         3 000242   200014 000100                    ARG     J,,AUTO
         3 000243   000247 606400 3                  TTN     s:18186
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:34   

      208    18182    3         WHENRETURN DO;

      209    18183    3            WILD_CARD = %YES#;

  18183  3 000244   400000 236003                    LDQ     -131072,DU
         3 000245   200024 756100                    STQ     WILD_CARD,,AUTO

      210    18184    3            END; /*  Whenreturn from index  */

  18184  3 000246   000250 710000 3                  TRA     s:18190

      211    18185    3         WHENALTRETURN DO;

      212    18186    3            WILD_CARD = %NO#;

  18186  3 000247   200024 450100                    STZ     WILD_CARD,,AUTO

      213    18187    3            END; /* Whenaltreturn  */

      214    18188    2         END;  /*  Else  */

      215    18189
      216    18190    1   FDS.NVECS# = 0;

  18190  3 000250   000011 450000 xsym               STZ     FDS+9

      217    18191    1   FDS.WRAPTAB# = 1;

  18191  3 000251   000001 235007                    LDA     1,DL
         3 000252   000016 755000 xsym               STA     FDS+14

      218    18192    2   IF JCL THEN DO;

  18192  3 000253   200015 234100                    SZN     JCL,,AUTO
         3 000254   000272 605000 3                  TPL     s:18197

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:35   
      219    18193    2      CALL CONCAT (FMT_BUF, '%1/"', STATIONS_STR, '%1/');

  18193  3 000255   000012 236000 2                  LDQ     LIST_STR+3
         3 000256   000000 756000 xsym               STQ     FMT_BUF
         3 000257   000002 237000 2                  LDAQ    STATIONS_STR
         3 000260   000001 755000 xsym               STA     FMT_BUF+1
         3 000261   000002 756000 xsym               STQ     FMT_BUF+2
         3 000262   040000 100400                    MLR     fill='040'O
         3 000263   000012 000003 2                  ADSC9   LIST_STR+3               cn=0,n=3
         3 000264   000003 000363 xsym               ADSC9   FMT_BUF+3                cn=0,n=243

      220    18194    2      FDS.FMT_.BOUND = LENGTHC (STATIONS_STR) + 6;

  18194  3 000265   000000 236000 xsym               LDQ     FDS
         3 000266   177777 376007                    ANQ     65535,DL
         3 000267   000010 276000 4                  ORQ     8
         3 000270   000000 756000 xsym               STQ     FDS

      221    18195    2      END;   /*  Jcl  */

  18195  3 000271   000310 710000 3                  TRA     s:18200

      222    18196    2   ELSE DO;

      223    18197    2      CALL CONCAT (FMT_BUF, '%1/', STATIONS_STR, '%1/');

  18197  3 000272   000012 236000 2                  LDQ     LIST_STR+3
         3 000273   000011 376000 4                  ANQ     9
         3 000274   000040 276007                    ORQ     32,DL
         3 000275   000000 756000 xsym               STQ     FMT_BUF
         3 000276   040000 100400                    MLR     fill='040'O
         3 000277   000002 000010 2                  ADSC9   STATIONS_STR             cn=0,n=8
         3 000300   000000 600010 xsym               ADSC9   FMT_BUF                  cn=3,n=8
         3 000301   040000 100400                    MLR     fill='040'O
         3 000302   000012 000003 2                  ADSC9   LIST_STR+3               cn=0,n=3
         3 000303   000002 600364 xsym               ADSC9   FMT_BUF+2                cn=3,n=244

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:36   
      224    18198    2      FDS.FMT_.BOUND = LENGTHC (STATIONS_STR) + 5;

  18198  3 000304   000000 236000 xsym               LDQ     FDS
         3 000305   177777 376007                    ANQ     65535,DL
         3 000306   000012 276000 4                  ORQ     10
         3 000307   000000 756000 xsym               STQ     FDS

      225    18199    2      END;  /*  Not jcl  */

      226    18200    1   FDS.TABDFLT# = 10;

  18200  3 000310   000012 235007                    LDA     10,DL
         3 000311   000017 755000 xsym               STA     FDS+15

      227    18201    1   CALL X$FORMAT (FDS);

  18201  3 000312   000013 630400 4                  EPPR0   11
         3 000313   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000314   000000 701000 xent               TSX1    X$FORMAT
         3 000315   000000 011000                    NOP     0

      228    18202
      229    18203    1   FDS.NVECS# = 0;

  18203  3 000316   000011 450000 xsym               STZ     FDS+9

      230    18204    1   STATION_LOOP:
      231    18205    2   DO I = 0 TO KL$WSNCVT.LTWSN;

  18205  3 000317   200013 450100       STATION_LOOP STZ     I,,AUTO
         3 000320   000524 710000 3                  TRA     s:18250+3

      232    18206    2      FOUND = %NO#;

  18206  3 000321   200012 450100                    STZ     FOUND,,AUTO

      233    18207    2      CALL INDEX (J,' ',KL$WSNCVT.WSN(I));
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:37   

  18207  3 000322   200013 235100                    LDA     I,,AUTO
         3 000323   000003 735000                    ALS     3
         3 000324   000000 470400 1                  LDP0    WSNCVT$
         3 000325   000000 124505                    SCM     mask='000'O
         3 000326   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         3 000327   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000330   200014 000100                    ARG     J,,AUTO

      234    18208    2      IF J=0 THEN J=1;

  18208  3 000331   200014 236100                    LDQ     J,,AUTO
         3 000332   000335 601000 3                  TNZ     s:18209

  18208  3 000333   000001 235007                    LDA     1,DL
         3 000334   200014 755100                    STA     J,,AUTO

      235    18209    2      IF ALL_STATIONS THEN

  18209  3 000335   200003 234100                    SZN     ALL_STATIONS,,AUTO
         3 000336   000352 605000 3                  TPL     s:18214

      236    18210    2         IF KL$WSNCVT.WSN(I) = ' ' THEN

  18210  3 000337   200013 235100                    LDA     I,,AUTO
         3 000340   000003 735000                    ALS     3
         3 000341   040000 106505                    CMPC    fill='040'O
         3 000342   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         3 000343   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000344   000347 601000 3                  TNZ     s:18213

      237    18211    2            FOUND = %NO#;

  18211  3 000345   200012 450100                    STZ     FOUND,,AUTO
         3 000346   000411 710000 3                  TRA     s:18225

      238    18212    2         ELSE
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:38   
      239    18213    2            FOUND = %YES#;

  18213  3 000347   400000 236003                    LDQ     -131072,DU
         3 000350   200012 756100                    STQ     FOUND,,AUTO
         3 000351   000411 710000 3                  TRA     s:18225

      240    18214    3      ELSE IF WILD_CARD THEN DO;

  18214  3 000352   200024 234100                    SZN     WILD_CARD,,AUTO
         3 000353   000401 605000 3                  TPL     s:18222

      241    18215    3            K = TNAME.COUNT;

  18215  3 000354   200021 236100                    LDQ     TNAME,,AUTO
         3 000355   000033 772000                    QRL     27
         3 000356   200016 756100                    STQ     K,,AUTO

      242    18216    3            CALL ASB$WILD_MATCH (J, KL$WSNCVT.WSN(I), K, TNAME.TEXT)

  18216  3 000357   200022 631500                    EPPR1   TNAME+1,,AUTO
         3 000360   200031 451500                    STP1    WILD_CARD+5,,AUTO
         3 000361   200016 633500                    EPPR3   K,,AUTO
         3 000362   200030 453500                    STP3    WILD_CARD+4,,AUTO
         3 000363   200013 236100                    LDQ     I,,AUTO
         3 000364   000023 736000                    QLS     19
         3 000365   000002 036003                    ADLQ    2,DU
         3 000366   000000 036000 1                  ADLQ    WSNCVT$
         3 000367   200027 756100                    STQ     WILD_CARD+3,,AUTO
         3 000370   200014 634500                    EPPR4   J,,AUTO
         3 000371   200026 454500                    STP4    WILD_CARD+2,,AUTO
         3 000372   200026 630500                    EPPR0   WILD_CARD+2,,AUTO
         3 000373   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000374   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 000375   000400 702000 3                  TSX2    s:18220

      243    18217    4            WHENRETURN DO;

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:39   
      244    18218    4               FOUND = %YES#;

  18218  3 000376   400000 236003                    LDQ     -131072,DU
         3 000377   200012 756100                    STQ     FOUND,,AUTO

      245    18219    4               END; /*  Whenreturn  */

      246    18220    3            END; /*  If WILD_CARD  */

  18220  3 000400   000411 710000 3                  TRA     s:18225

      247    18221    2         ELSE
      248    18222    2            IF KL$WSNCVT.WSN(I) = TNAME.TEXT THEN

  18222  3 000401   200013 235100                    LDA     I,,AUTO
         3 000402   000003 735000                    ALS     3
         3 000403   040100 106505                    CMPC    fill='040'O
         3 000404   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         3 000405   200022 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8
         3 000406   000411 601000 3                  TNZ     s:18225

      249    18223    2               FOUND = %YES#;

  18223  3 000407   400000 236003                    LDQ     -131072,DU
         3 000410   200012 756100                    STQ     FOUND,,AUTO

      250    18224
      251    18225    2      IF FOUND THEN

  18225  3 000411   200012 234100                    SZN     FOUND,,AUTO
         3 000412   000513 605000 3                  TPL     s:18248

      252    18226    2         CALL ASV$VALIDATE_STATION (KL$WSNCVT.WSN(I), I)

  18226  3 000413   200013 630500                    EPPR0   I,,AUTO
         3 000414   200027 450500                    STP0    WILD_CARD+3,,AUTO
         3 000415   200013 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:40   
         3 000416   000023 736000                    QLS     19
         3 000417   000002 036003                    ADLQ    2,DU
         3 000420   000000 036000 1                  ADLQ    WSNCVT$
         3 000421   200026 756100                    STQ     WILD_CARD+2,,AUTO
         3 000422   200026 630500                    EPPR0   WILD_CARD+2,,AUTO
         3 000423   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000424   000000 701000 xent               TSX1    ASV$VALIDATE_STATION
         3 000425   000511 702000 3                  TSX2    s:18246

      253    18227    3         WHENRETURN DO;

      254    18228    3            IF DISP THEN

  18228  3 000426   200010 234100                    SZN     DISP,,AUTO
         3 000427   000441 605000 3                  TPL     s:18233

      255    18229    4            DO;

      256    18230    4               CALL ASL$DISP_ONE_STATION (I, JCL);

  18230  3 000430   200015 630500                    EPPR0   JCL,,AUTO
         3 000431   200027 450500                    STP0    WILD_CARD+3,,AUTO
         3 000432   200013 631500                    EPPR1   I,,AUTO
         3 000433   200026 451500                    STP1    WILD_CARD+2,,AUTO
         3 000434   200026 630500                    EPPR0   WILD_CARD+2,,AUTO
         3 000435   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000436   000000 701000 xent               TSX1    ASL$DISP_ONE_STATION
         3 000437   000000 011000                    NOP     0

      257    18231    4               END; /*  If disp  */

  18231  3 000440   000507 710000 3                  TRA     s:18243

      258    18232    4            ELSE DO;

      259    18233    5               IF DISP_STATIONS = 0 THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:41   
  18233  3 000441   200011 235100                    LDA     DISP_STATIONS,,AUTO
         3 000442   000463 601000 3                  TNZ     s:18238

      260    18234    5                  CALL CONCAT (FMT_BUF, '%\', SUBSTR(KL$WSNCVT.WSN(I),0,J));

  18234  3 000443   000013 220000 2                  LDX0    LIST_STR+4
         3 000444   000000 740000 xsym               STX0    FMT_BUF
         3 000445   200013 236100                    LDQ     I,,AUTO
         3 000446   000003 736000                    QLS     3
         3 000447   000000 470400 1                  LDP0    WSNCVT$
         3 000450   200014 721100                    LXL1    J,,AUTO
         3 000451   040000 100546                    MLR     fill='040'O
         3 000452   000002 000011                    ADSC9   2,Q,PR0                  cn=0,n=*X1
         3 000453   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      261    18235    5                  FDS.FMT_.BOUND = J + 1;

  18235  3 000454   200014 236100                    LDQ     J,,AUTO
         3 000455   000001 036007                    ADLQ    1,DL
         3 000456   000020 736000                    QLS     16
         3 000457   000000 676000 xsym               ERQ     FDS
         3 000460   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000461   000000 656000 xsym               ERSQ    FDS

      262    18236    5                  END; /*  DISP_STATIONS = 0  */

  18236  3 000462   000503 710000 3                  TRA     s:18241

      263    18237    5               ELSE DO;

      264    18238    5                  CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(KL$WSNCVT.WSN(I),0,J));

  18238  3 000463   000014 237000 2                  LDAQ    LIST_STR+5
         3 000464   000000 755000 xsym               STA     FMT_BUF
         3 000465   000001 756000 xsym               STQ     FMT_BUF+1
         3 000466   200013 235100                    LDA     I,,AUTO
         3 000467   000003 735000                    ALS     3
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:42   
         3 000470   000000 470400 1                  LDP0    WSNCVT$
         3 000471   200014 720100                    LXL0    J,,AUTO
         3 000472   040000 100545                    MLR     fill='040'O
         3 000473   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=*X0
         3 000474   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      265    18239    5                  FDS.FMT_.BOUND = J + 7;

  18239  3 000475   200014 236100                    LDQ     J,,AUTO
         3 000476   000007 036007                    ADLQ    7,DL
         3 000477   000020 736000                    QLS     16
         3 000500   000000 676000 xsym               ERQ     FDS
         3 000501   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000502   000000 656000 xsym               ERSQ    FDS

      266    18240    5                  END; /*  Else  */

      267    18241    4               CALL X$FORMAT (FDS);

  18241  3 000503   000013 630400 4                  EPPR0   11
         3 000504   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000505   000000 701000 xent               TSX1    X$FORMAT
         3 000506   000000 011000                    NOP     0

      268    18242    4               END; /*  Else  disp  */

      269    18243    3            DISP_STATIONS = DISP_STATIONS + 1;

  18243  3 000507   200011 054100                    AOS     DISP_STATIONS,,AUTO

      270    18244    3            END; /*  Whenreturn  */

  18244  3 000510   000513 710000 3                  TRA     s:18248

      271    18245    3         WHENALTRETURN DO;

      272    18246    3            CHANGE = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:43   

  18246  3 000511   400000 236003                    LDQ     -131072,DU
         3 000512   200004 756100                    STQ     CHANGE,,AUTO

      273    18247    3            END; /* Whenaltreturn  */

      274    18248    2      IF FOUND AND NOT WILD_CARD AND NOT ALL_STATIONS THEN

  18248  3 000513   200012 234100                    SZN     FOUND,,AUTO
         3 000514   000521 605000 3                  TPL     s:18250
         3 000515   200024 234100                    SZN     WILD_CARD,,AUTO
         3 000516   000521 604000 3                  TMI     s:18250
         3 000517   200003 234100                    SZN     ALL_STATIONS,,AUTO
         3 000520   000530 605000 3                  TPL     s:18251

      275    18249    2         EXIT STATION_LOOP;    /*  Single station  */
      276    18250    2      END;  /*  Loop thru stations */

  18250  3 000521   200013 235100                    LDA     I,,AUTO
         3 000522   000001 035007                    ADLA    1,DL
         3 000523   200013 755100                    STA     I,,AUTO
         3 000524   000000 470400 1                  LDP0    WSNCVT$
         3 000525   000001 236100                    LDQ     1,,PR0
         3 000526   200013 116100                    CMPQ    I,,AUTO
         3 000527   000321 603000 3                  TRC     s:18206

      277    18251    1   IF NOT ALL_STATIONS AND NOT WILD_CARD AND NOT FOUND

  18251  3 000530   200003 234100                    SZN     ALL_STATIONS,,AUTO
         3 000531   000547 604000 3                  TMI     s:18271
         3 000532   200024 234100                    SZN     WILD_CARD,,AUTO
         3 000533   000547 604000 3                  TMI     s:18271
         3 000534   200012 234100                    SZN     FOUND,,AUTO
         3 000535   000547 604000 3                  TMI     s:18271

      278    18252    2   THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:44   
      279    18253    2      AS_FIELD1.COUNT = TNAME.COUNT;

  18253  3 000536   200021 236100                    LDQ     TNAME,,AUTO
         3 000537   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      280    18254    2      AS_FIELD1.TEXT = TNAME.TEXT;

  18254  3 000540   040000 100500                    MLR     fill='040'O
         3 000541   200022 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8
         3 000542   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      281    18255           %SCREAM (ERR# = E$STAT_NO_EXIST, LEVEL=ERROR, MID = 'A');

  18267  3 000543   000014 630400 4                  EPPR0   12
         3 000544   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000545   000000 701000 xent               TSX1    ASH$ERROR
         3 000546   000000 011000                    NOP     0

      282    18270    2      END; /* if not all stations and not wild card and not found */

      283    18271    1   IF CHANGE THEN

  18271  3 000547   200004 234100                    SZN     CHANGE,,AUTO
         3 000550   000566 605000 3                  TPL     s:18277

      284    18272    2   DO;

      285    18273    2      USERS_KEY.COUNT = 4;

  18273  3 000551   004000 236003                    LDQ     2048,DU
         3 000552   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      286    18274    2      USERS_KEY.TXTC  = 'TERM';

  18274  3 000553   040000 100400                    MLR     fill='040'O
         3 000554   000011 000004 2                  ADSC9   LIST_STR+2               cn=0,n=4
         3 000555   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:45   

      287    18275    2      CALL ASB$WRITE_HLP( WSNCVT$, STAT_ARS );

  18275  3 000556   200017 630500                    EPPR0   STAT_ARS,,AUTO
         3 000557   200027 450500                    STP0    WILD_CARD+3,,AUTO
         3 000560   000001 236000 4                  LDQ     1
         3 000561   200026 756100                    STQ     WILD_CARD+2,,AUTO
         3 000562   200026 630500                    EPPR0   WILD_CARD+2,,AUTO
         3 000563   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000564   000000 701000 xent               TSX1    ASB$WRITE_HLP
         3 000565   000000 011000                    NOP     0

      288    18276    2      END; /*  If change  */

      289    18277    1   CALL ASB$DEQ_HLP;

  18277  3 000566   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000567   000000 701000 xent               TSX1    ASB$DEQ_HLP
         3 000570   000000 011000                    NOP     0

      290    18278
      291    18279    2   IF NOT DISP THEN DO;

  18279  3 000571   200010 234100                    SZN     DISP,,AUTO
         3 000572   000607 604000 3                  TMI     s:18285

      292    18280    2      FMT_BUF = '%\%/';

  18280  3 000573   040000 100400                    MLR     fill='040'O
         3 000574   000017 000004 2                  ADSC9   LIST_STR+8               cn=0,n=4
         3 000575   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      293    18281    2      FDS.FMT_.BOUND = 3;

  18281  3 000576   000000 236000 xsym               LDQ     FDS
         3 000577   177777 376007                    ANQ     65535,DL
         3 000600   600000 276007                    ORQ     -65536,DL
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:46   
         3 000601   000000 756000 xsym               STQ     FDS

      294    18282    2      FDS.NVECS# = 0;

  18282  3 000602   000011 450000 xsym               STZ     FDS+9

      295    18283    2      CALL X$FORMAT(FDS);

  18283  3 000603   000013 630400 4                  EPPR0   11
         3 000604   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000605   000000 701000 xent               TSX1    X$FORMAT
         3 000606   000000 011000                    NOP     0

      296    18284    2      END; /*  If not disp  */

      297    18285    2   IF NOT JCL THEN DO;

  18285  3 000607   200015 234100                    SZN     JCL,,AUTO
         3 000610   000657 604000 3                  TMI     s:18306

      298    18286    2      FMT_VEC(0) = VECTOR (DISP_STATIONS);

  18286  3 000611   777640 235007                    LDA     -96,DL
         3 000612   200026 452500                    STP2    WILD_CARD+2,,AUTO
         3 000613   200026 236100                    LDQ     WILD_CARD+2,,AUTO
         3 000614   000011 036003                    ADLQ    9,DU
         3 000615   000000 755000 xsym               STA     FMT_VEC
         3 000616   000001 756000 xsym               STQ     FMT_VEC+1

      299    18287    2      IF DISP_STATIONS = 1 THEN

  18287  3 000617   200011 235100                    LDA     DISP_STATIONS,,AUTO
         3 000620   000001 115007                    CMPA    1,DL
         3 000621   000626 601000 3                  TNZ     s:18292

      300    18288    3      DO;

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:47   
      301    18289    3         FMT_VEC(1) = VECTOR (STATION_STR);

  18289  3 000622   000016 237000 4                  LDAQ    14
         3 000623   000002 755000 xsym               STA     FMT_VEC+2
         3 000624   000003 756000 xsym               STQ     FMT_VEC+3

      302    18290    3         END; /*  DISP_STATIONS = 1  */

  18290  3 000625   000631 710000 3                  TRA     s:18294

      303    18291    3      ELSE DO;

      304    18292    3         FMT_VEC(1) = VECTOR (STATIONS_STR);

  18292  3 000626   000020 237000 4                  LDAQ    16
         3 000627   000002 755000 xsym               STA     FMT_VEC+2
         3 000630   000003 756000 xsym               STQ     FMT_VEC+3

      305    18293    3         END; /*  DISP_STATIONS ~= 1  */

      306    18294    2      IF DISP THEN

  18294  3 000631   200010 234100                    SZN     DISP,,AUTO
         3 000632   000637 605000 3                  TPL     s:18299

      307    18295    3      DO;

      308    18296    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  18296  3 000633   000022 237000 4                  LDAQ    18
         3 000634   000004 755000 xsym               STA     FMT_VEC+4
         3 000635   000005 756000 xsym               STQ     FMT_VEC+5

      309    18297    3         END; /*  If disp  */

  18297  3 000636   000642 710000 3                  TRA     s:18301

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:48   
      310    18298    3      ELSE DO;

      311    18299    3         FMT_VEC(2) = VECTOR (LIST_STR);

  18299  3 000637   000024 237000 4                  LDAQ    20
         3 000640   000004 755000 xsym               STA     FMT_VEC+4
         3 000641   000005 756000 xsym               STQ     FMT_VEC+5

      312    18300    3         END; /*  If ~ disp  */

      313    18301    2      FDS.NVECS# = 3;

  18301  3 000642   000003 235007                    LDA     3,DL
         3 000643   000011 755000 xsym               STA     FDS+9

      314    18302    2      FMT_BUF = '   %5D %A %A.';

  18302  3 000644   040000 100400                    MLR     fill='040'O
         3 000645   000020 000015 2                  ADSC9   LIST_STR+9               cn=0,n=13
         3 000646   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      315    18303    2      FDS.FMT_.BOUND = 12;

  18303  3 000647   000000 236000 xsym               LDQ     FDS
         3 000650   177777 376007                    ANQ     65535,DL
         3 000651   000003 276003                    ORQ     3,DU
         3 000652   000000 756000 xsym               STQ     FDS

      316    18304    2      CALL X$FORMAT(FDS);

  18304  3 000653   000013 630400 4                  EPPR0   11
         3 000654   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000655   000000 701000 xent               TSX1    X$FORMAT
         3 000656   000000 011000                    NOP     0

      317    18305    2      END; /*  Not jcl  */

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:49   
      318    18306    1   FDS.WRAPTAB# = 4;

  18306  3 000657   000004 235007                    LDA     4,DL
         3 000660   000016 755000 xsym               STA     FDS+14

      319    18307    1   RETURN;

  18307  3 000661   000000 702200 xent               TSX2  ! X66_ARET
      320    18308    1   END ASL$LIST_ALL_STATIONS;
      321    18309        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:50   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_STATIONS.
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:51   

 **** Variables and constants ****

  ****  Section 001  Data  ASL$LIST_ALL_STATIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 WSNCVT$

  ****  Section 002 RoData ASL$LIST_ALL_STATIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/c CHAR(11)    r     1 DISPLAY_STR                7-0-0/c CHAR(8)     r     1 LIST_STR
     2-0-0/c CHAR(8)     r     1 STATIONS_STR               0-0-0/c CHAR(7)     r     1 STATION_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_STATIONS               4-0-0/b BIT         r     1 CHANGE
     5-0-0/w UBIN        r     1 CODE2                     10-0-0/b BIT         r     1 DISP
    11-0-0/w SBIN        r     1 DISP_STATIONS             12-0-0/b BIT         r     1 FOUND
    13-0-0/w UBIN        r     1 I                         14-0-0/w UBIN        r     1 J
    15-0-0/b BIT         r     1 JCL                       16-0-0/w UBIN        r     1 K
    17-0-0/w UBIN        r     1 STAT_ARS                  21-0-0/w STRC(108)   r     1 TNAME
    24-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:52   
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)              0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 KL$WSNCVT                  0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_STATIONS requires 434 words for executable code.
   Procedure ASL$LIST_ALL_STATIONS requires 26 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:53   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:54   
          MINI XREF LISTING

ALL_STATIONS
     18077**DCL     18176<<ASSIGN  18178<<ASSIGN  18180<<ASSIGN  18209>>IF      18248>>IF      18251>>IF
ASA$ERROR
     17975**DCL-ENT 18116--CALL
ASA_BRKS_LOC
     15083**DCL     15083--REDEF
ASB$DEQ_HLP
     17951**DCL-ENT 18117--CALL    18277--CALL
ASB$ENQ_HLP
     17948**DCL-ENT 18114--CALL
ASB$READ_HLP
     17954**DCL-ENT 18115--CALL
ASB$WILD_MATCH
     17972**DCL-ENT 18216--CALL
ASB$WRITE_HLP
     17957**DCL-ENT 18275--CALL
ASH$ERROR
     17960**DCL-ENT 18267--CALL
ASL$DISP_ONE_STATION
     17969**DCL-ENT 18230--CALL
ASV$VALIDATE_STATION
     17945**DCL-ENT 18226--CALL
AS_DEFAULT.BANNER_PERM
     15776**DCL     15777--REDEF
AS_DEFAULT.BUDGET.MACCT
     15681**DCL     15685--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     15694**DCL     15697--REDEF
AS_DEFAULT.BUDGET.PACCUM
     15677**DCL     15679--REDEF
AS_DEFAULT.BUDGET.PMAXC
     15672**DCL     15674--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:55   
AS_DEFAULT.SETUP_CHRA.TXT
     15792**DCL     15793--REDEF   15794--REDEF
AS_DEFAULT_DREC.PASSWORD
     17046**DCL     17050--REDEF
AS_DEFAULT_DREC.RENAME
     17069**DCL     17070--REDEF
AS_DFLT.BANNER_PERM
     15598**DCL     15599--REDEF
AS_DFLT.BUDGET.MACCT
     15503**DCL     15507--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     15516**DCL     15519--REDEF
AS_DFLT.BUDGET.PACCUM
     15499**DCL     15501--REDEF
AS_DFLT.BUDGET.PMAXC
     15494**DCL     15496--REDEF
AS_DFLT.SETUP_CHRA.TXT
     15614**DCL     15615--REDEF   15616--REDEF
AS_FE_MODE
     14949**DCL     14950--REDEF
AS_FIELD1.COUNT
     15080**DCL     18253<<ASSIGN
AS_FIELD1.TEXT
     15080**DCL     18254<<ASSIGN
AS_MODE
     14946**DCL     14948--REDEF
AS_MOD_USER.ACCESS
     17811**DCL     17812--REDEF
AS_MOD_USER.BANNER
     17798**DCL     17799--REDEF
AS_MOD_USER.BANNER_PERM
     17800**DCL     17801--REDEF
AS_MOD_USER.BILL
     17806**DCL     17807--REDEF
AS_MOD_USER.CPROC
     17802**DCL     17803--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:56   
AS_MOD_USER.FEBILL
     17882**DCL     17883--REDEF
AS_MOD_USER.FECXTMEM
     17899**DCL     17900--REDEF
AS_MOD_USER.FEMINTS
     17884**DCL     17885--REDEF
AS_MOD_USER.FEMMEM
     17895**DCL     17896--REDEF
AS_MOD_USER.FEMTIME
     17893**DCL     17894--REDEF
AS_MOD_USER.FEPPRIV
     17890**DCL     17892--REDEF
AS_MOD_USER.FEPRIV
     17887**DCL     17889--REDEF
AS_MOD_USER.FORCE_BIT
     17796**DCL     17797--REDEF
AS_MOD_USER.KEY
     17878**DCL     17880--REDEF
AS_MOD_USER.LASTCPROC
     17804**DCL     17805--REDEF
AS_MOD_USER.LIMITS.DO_
     17852**DCL     17853--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     17868**DCL     17869--REDEF
AS_MOD_USER.LIMITS.LO
     17848**DCL     17849--REDEF
AS_MOD_USER.LIMITS.MEM
     17844**DCL     17845--REDEF
AS_MOD_USER.LIMITS.MPRIO
     17872**DCL     17873--REDEF
AS_MOD_USER.LIMITS.PDIS
     17860**DCL     17861--REDEF
AS_MOD_USER.LIMITS.PO
     17856**DCL     17857--REDEF
AS_MOD_USER.LIMITS.TDIS
     17864**DCL     17865--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:57   
AS_MOD_USER.LIMITS.TIME
     17840**DCL     17841--REDEF
AS_MOD_USER.MAXENQ
     17821**DCL     17822--REDEF
AS_MOD_USER.PERM_BIT
     17794**DCL     17795--REDEF
AS_MOD_USER.PPRIV
     17816**DCL     17818--REDEF
AS_MOD_USER.PRIOB
     17823**DCL     17824--REDEF
AS_MOD_USER.PRIV
     17813**DCL     17815--REDEF
AS_MOD_USER.QUAN
     17819**DCL     17820--REDEF
AS_MOD_USER.SETUP
     17792**DCL     17793--REDEF
AS_PROJECT.BANNER_PERM
     16132**DCL     16133--REDEF
AS_PROJECT.BUDGET.MACCT
     16037**DCL     16041--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     16050**DCL     16053--REDEF
AS_PROJECT.BUDGET.PACCUM
     16033**DCL     16035--REDEF
AS_PROJECT.BUDGET.PMAXC
     16028**DCL     16030--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     16148**DCL     16149--REDEF   16150--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     16310**DCL     16311--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     16215**DCL     16219--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     16228**DCL     16231--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     16211**DCL     16213--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:58   
AS_PROJECT_DFLT.BUDGET.PMAXC
     16206**DCL     16208--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     16326**DCL     16327--REDEF   16328--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     17532**DCL     17536--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     17555**DCL     17556--REDEF
AS_PROJECT_DREC.PASSWORD
     17370**DCL     17374--REDEF
AS_PROJECT_DREC.RENAME
     17393**DCL     17394--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     15954**DCL     15955--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     15859**DCL     15863--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     15872**DCL     15875--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     15855**DCL     15857--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     15850**DCL     15852--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     15970**DCL     15971--REDEF   15972--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     17208**DCL     17212--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     17231**DCL     17232--REDEF
AS_USERS.BANNER_PERM
     15420**DCL     15421--REDEF
AS_USERS.BUDGET.MACCT
     15325**DCL     15329--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     15338**DCL     15341--REDEF
AS_USERS.BUDGET.PACCUM
     15321**DCL     15323--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:59   
AS_USERS.BUDGET.PMAXC
     15316**DCL     15318--REDEF
AS_USERS.SETUP_CHRA.TXT
     15436**DCL     15437--REDEF   15438--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     16488**DCL     16489--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     16393**DCL     16397--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     16406**DCL     16409--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     16389**DCL     16391--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     16384**DCL     16386--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     16504**DCL     16505--REDEF   16506--REDEF
CHANGE
     18078**DCL     18106<<ASSIGN  18246<<ASSIGN  18271>>IF
CODE
     15076**DCL     18123<<ASSIGN  18130>>DOSELCT
CODE2
     18079**DCL     18156<<ASSIGN  18158>>DOSELCT
DISP
     18081**DCL     18134<<ASSIGN  18138<<ASSIGN  18146<<ASSIGN  18154<<ASSIGN  18228>>IF      18279>>IF
     18294>>IF
DISPLAY_STR
     18100**DCL     18296--ASSIGN
DISP_STATIONS
     18082**DCL     18128<<ASSIGN  18233>>IF      18243<<ASSIGN  18243>>ASSIGN  18286--ASSIGN  18287>>IF
DSEG1$
     15084**DCL     18110>>ASSIGN
DSEG1SIZE
     15085**DCL     18113>>ASSIGN
ERR_CODE
     15078**DCL     15079--REDEF
FDS
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:60   
     14975**DCL     18201<>CALL    18241<>CALL    18283<>CALL    18304<>CALL
FDS.FMT_.BOUND
     14980**DCL     18194<<ASSIGN  18198<<ASSIGN  18235<<ASSIGN  18239<<ASSIGN  18281<<ASSIGN  18303<<ASSIGN
FDS.NVECS#
     15003**DCL     18190<<ASSIGN  18203<<ASSIGN  18282<<ASSIGN  18301<<ASSIGN
FDS.TABDFLT#
     15041**DCL     18200<<ASSIGN
FDS.WRAPTAB#
     15038**DCL     18191<<ASSIGN  18306<<ASSIGN
FMT_BUF
     15074**DCL     18193<<CALLBLT 18197<<CALLBLT 18234<<CALLBLT 18238<<CALLBLT 18280<<ASSIGN  18302<<ASSIGN
FMT_VEC
     15074**DCL     18286<<ASSIGN  18289<<ASSIGN  18292<<ASSIGN  18296<<ASSIGN  18299<<ASSIGN
FOUND
     18083**DCL     18206<<ASSIGN  18211<<ASSIGN  18213<<ASSIGN  18218<<ASSIGN  18223<<ASSIGN  18225>>IF
     18248>>IF      18251>>IF
I
     18084**DCL     18155<<DOINDEX 18156>>ASSIGN  18205<<DOINDEX 18207>>CALLBLT 18210>>IF      18216>>CALL
     18222>>IF      18226>>CALL    18226<>CALL    18230<>CALL    18234>>CALLBLT 18238>>CALLBLT
J
     18085**DCL     18181<<CALLBLT 18207<<CALLBLT 18208>>IF      18208<<ASSIGN  18216<>CALL    18234>>CALLBLT
     18235>>ASSIGN  18238>>CALLBLT 18239>>ASSIGN
JCL
     18086**DCL     18124<<ASSIGN  18140<<ASSIGN  18142<<ASSIGN  18167<<ASSIGN  18192>>IF      18230<>CALL
     18285>>IF
K
     18087**DCL     18215<<ASSIGN  18216<>CALL
KL$WSNCVT.LTWSN
     17986**DCL     18205>>DOINDEX
KL$WSNCVT.WSN
     17987**DCL     18207>>CALLBLT 18210>>IF      18216<>CALL    18222>>IF      18226<>CALL    18234>>CALLBLT
     18238>>CALLBLT
KL_DEFAULT.PASSWORD
     17694**DCL     17698--REDEF
KL_DEFAULT.RENAME
     17717**DCL     17718--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:61   
KL_DFLT.PASSWORD
     16884**DCL     16888--REDEF
KL_DFLT.RENAME
     16907**DCL     16908--REDEF
KL_DREC.PASSWORD
     16722**DCL     16726--REDEF
KL_DREC.RENAME
     16745**DCL     16746--REDEF
KL_DREC_CNT.PASSWORD
     16609**DCL     16613--REDEF
KL_DREC_CNT.RENAME
     16632**DCL     16633--REDEF
LIST_STR
     18101**DCL     18299--ASSIGN
NODE$
     15076**DCL     17996--IMP-PTR
P$B.CODE
     18004**DCL     18123>>ASSIGN  18140>>ASSIGN  18142>>ASSIGN  18156>>ASSIGN
P$B.NSUBLKS
     18008**DCL     18139>>IF      18141>>IF      18147>>IF      18155>>DOINDEX
P$B.SUBLK$
     18029**DCL     18123>>ASSIGN  18139>>IF      18140>>ASSIGN  18140>>ASSIGN  18141>>IF      18142>>ASSIGN
     18142>>ASSIGN  18148>>ASSIGN  18148>>ASSIGN  18149>>ASSIGN  18156>>ASSIGN  18162>>ASSIGN  18162>>ASSIGN
     18163>>ASSIGN
P$S.COUNT
     18065**DCL     18068--IMP-SIZ 18148>>ASSIGN  18149>>ASSIGN  18162>>ASSIGN  18163>>ASSIGN
P$S.TEXT
     18068**DCL     18148>>ASSIGN  18162>>ASSIGN
PROJ_KEY.TEXT
     14956**DCL     14956--REDEF
PROJ_KEY.TXT.PROJECT
     14956**DCL     14956--REDEF
P_PCB.OUT$
     15124**DCL     18123>>ASSIGN  18139>>IF      18140>>ASSIGN  18141>>IF      18142>>ASSIGN  18147>>IF
     18148>>ASSIGN  18148>>ASSIGN  18149>>ASSIGN  18155>>DOINDEX 18156>>ASSIGN  18162>>ASSIGN  18162>>ASSIGN
     18163>>ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_STATIONS File=ASL$LIST_STATIONS.:E05TSI          TUE 07/29/97 10:20 Page:62   
REMEM_VAR
     15082**DCL     15082--REDEF
REM_FCMD
     15082**DCL     15083--REDEF
STATIONS_STR
     18099**DCL     18193>>CALLBLT 18194--ASSIGN  18197>>CALLBLT 18198--ASSIGN  18292--ASSIGN
STATION_LOOP
     18205**LABEL   18249--EXIT
STATION_STR
     18098**DCL     18289--ASSIGN
STAT_ARS
     18088**DCL     18113<<ASSIGN  18115<>CALL    18275<>CALL
TNAME.COUNT
     18091**DCL     18127<<ASSIGN  18149<<ASSIGN  18163<<ASSIGN  18175>>IF      18215>>ASSIGN  18253>>ASSIGN
TNAME.TEXT
     18092**DCL     18126<<ASSIGN  18148<<ASSIGN  18162<<ASSIGN  18177>>IF      18181>>CALLBLT 18216<>CALL
     18222>>IF      18254>>ASSIGN
USERS_KEY
     14953**DCL     18116<>CALL
USERS_KEY.COUNT
     14953**DCL     18111<<ASSIGN  18273<<ASSIGN
USERS_KEY.TEXT
     14953**DCL     14954--REDEF   14954--REDEF   14954--REDEF   14955--REDEF
USERS_KEY.TW.NAME
     14954**DCL     18112<<ASSIGN
USERS_KEY.TXTC
     14954**DCL     18274<<ASSIGN
WILD_CARD
     18093**DCL     18125<<ASSIGN  18183<<ASSIGN  18186<<ASSIGN  18214>>IF      18248>>IF      18251>>IF
WSNCVT$
     17939**DCL     17983--IMP-PTR 18110<<ASSIGN  18115<>CALL    18205>>DOINDEX 18207>>CALLBLT 18210>>IF
     18216>>CALL    18222>>IF      18226>>CALL    18234>>CALLBLT 18238>>CALLBLT 18275<>CALL
X$FORMAT
     17977**DCL-ENT 18201--CALL    18241--CALL    18283--CALL    18304--CALL

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:63   
      322        1        /*T***********************************************************/
      323        2        /*T*                                                         */
      324        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      325        4        /*T*                                                         */
      326        5        /*T***********************************************************/
      327        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:64   
      328        7        /*M* ASL$DISP_ONE_STATION: routine to handle DISP STATION cmd  */
      329        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      330        9              ECU=3,CSU=3,SDI=3                                           */
      331       10        ASL$DISP_ONE_STATION: PROC (TWSN_NUMBER, JCL) ;
      332       11        /**********************************************************/
      333       12
      334       13        /*D* NAME:     ASL$DISP_ONE_STATION
      335       14             CALL:     CALL ASL$DISP_ONE_STATION (TWSN_NUMBER, JCL)
      336       15             INPUT:    TWSN_NUMBER - the number of the TWSN record
      337       16                                      corresponding to the indicated STATION.
      338       17                       JCL - bit set if JCL option was specified on command.
      339       18             OUTPUT:   Nothing is returned.
      340       19             DESCRIPTION:  ASL$DISP_ONE_STATION is a subroutine to handle
      341       20                           the DISP STATION command for SUPER.
      342       21                           ASL$DISP_ONE_STATION will display the station
      343       22                           name and any devices hooked to it.
      344       23                           The TERM record is already in data segment 1.
      345       24                           The TWSNxxxx record is already in data segment 2.
      346       25                           The xxxxxxxxSTATION record doesn't have to be read
      347       26                           because it is a vanilla KL_DREC structure that was
      348       27                           written to :HLP just to let SLUG know that the
      349       28                           station has been defined and can logon?  There are
      350       29                           no options for stations and therefore nothing
      351       30                           to changes between station records except the name.
      352       31                           Any device records that need to be read by this
      353       32                           routine will be read into AUTO storage.
      354       33        */
      355       34        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:65   
      356       35        /********************************************************************/
      357       36        /*   Include files   include files   include files   include files  */
      358       37        /********************************************************************/
      359       38        %INCLUDE AS_PERR_C;
      360      640        %INCLUDE AS_SUPER_C;
      361     1075        %INCLUDE AS_SUBS_C;
      362     2489        %INCLUDE AS_MAC_C;
      363     2569        %INCLUDE AS_ENTRIES_M;
      364     3619        %INCLUDE AS_SSUBS_C;
      365     3711        %INCLUDE KC$CGBLK ;
      366     3759        %INCLUDE CP_6;
      367     3840        %INCLUDE B_ERRORS_C;
      368     4967        %INCLUDE KL_SUPER_C;
      369     7869        %INCLUDE XU_MACRO_C;
      370    10975        %INCLUDE XU_FORMAT_C;
      371    11137        %INCLUDE AS_SUPER_R;
      372    14153        %INCLUDE KL_CONFIG_M;
      373    14915        %INCLUDE KL_MACRO_C;
      374    18267        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:66   
      375    18268        /********************************************************************/
      376    18269        /*   Parameters     parameters     parameters     parameters        */
      377    18270        /********************************************************************/
      378    18271    1   DCL TWSN_NUMBER   UBIN;
      379    18272    1   DCL JCL           BIT(1) ;
      380    18273        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:67   
      381    18274        /********************************************************************/
      382    18275        /*   Static data     static data     static data     static data    */
      383    18276        /********************************************************************/
      384    18277        %KL$CONFIG_KEY ( NAME = CONFIG_KEY, STCLASS = STATIC);
      385    18324    1   DCL LINCNFG_BUF   (0:49)    UBIN WORD STATIC INIT(0*0);
      386    18325    1   DCL LINCNFG$                PTR STATIC INIT(ADDR(LINCNFG_BUF));
      387    18326        %KL$LINCNFG ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
      388    18484        %KL_SS;
      389    18519    1   DCL 1 TWSN_KEY STATIC,
      390    18520    1          2 *         UBIN BYTE UNAL INIT(8),
      391    18521    1          2 *         CHAR(4) INIT('TWSN'),
      392    18522    1          2 TWSN      CHAR(4);
      393    18523        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:68   
      394    18524        /********************************************************************/
      395    18525        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      396    18526        /********************************************************************/
      397    18527        %ASB$READ_HLP ;
      398    18530        %ASB$WRITE_HLP ;
      399    18533        %ASB$ENQ_HLP ;
      400    18536        %ASB$DEQ_HLP ;
      401    18539        %ASB$WRITE_LO ;
      402    18542        %ASA$ERROR ;
      403    18545        %ASB$READ_NETCON ;
      404    18548    1   DCL X$FORMAT ENTRY(1) ;
      405    18549        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:69   
      406    18550        /********************************************************************/
      407    18551        /*   Local based     local based     local based     local based    */
      408    18552        /********************************************************************/
      409    18553    1   DCL 1 TEXT$C BASED ALIGNED,
      410    18554    1          2 CNT       UBIN(9) UNAL ,
      411    18555    1          2 TEXT      CHAR(TEXT$C.CNT) UNAL;
      412    18556        %KL_TWSNREC ( NAME = KL$TWSNREC, STCLASS = "BASED(DSEG2$)");
      413    18581        %KL_DREC ( NAME = KL$DREC, PRO = ' ', LAST = ",", STCLASS = AUTO );
      414    18694        %KL_FEBLK ( NAME = KL$DREC$FEBLK, LVL = 2, RCNT = 31, STCLASS = AUTO );
      415    18743        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:70   
      416    18744        /********************************************************************/
      417    18745        /*   Auto data       auto data       auto data       auto data      */
      418    18746        /********************************************************************/
      419    18747    1   DCL J              SBIN;
      420    18748    1   DCL I              SBIN;
      421    18749    1   DCL DEVNUM         UBIN;
      422    18750    1   DCL DRECSZ         UBIN WORD;
      423    18751    1   DCL TWSN_ARS       UBIN;
      424    18752        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:71   
      425    18753        /********************************************************************/
      426    18754        /*   Constant data   constant data   constant data   constant data  */
      427    18755        /********************************************************************/
      428    18756    1   DCL BL_STR         CHAR(0) CONSTANT INIT(' ');
      429    18757    1   DCL STATION_STR    CHAR(0) CONSTANT INIT('STATION');
      430    18758    1   DCL INOUT_STR      CHAR(0) CONSTANT INIT('INOUT');
      431    18759    1   DCL IN_STR         CHAR(0) CONSTANT INIT('IN');
      432    18760    1   DCL OUT_STR        CHAR(0) CONSTANT INIT('OUT');
      433    18761    1   DCL NONE_STR       CHAR(0) CONSTANT INIT('NONE');
      434    18762    1   DCL NA_STR         CHAR(0) CONSTANT INIT('(NA)');
      435    18763    1   DCL YES_STR        CHAR(0) CONSTANT INIT('YES');
      436    18764    1   DCL NO_STR         CHAR(0) CONSTANT INIT('NO');
      437    18765    1   DCL DEV_STR        CHAR(0) CONSTANT INIT('DEVICE');
      438    18766    1   DCL TDEV_STR       CHAR(0) CONSTANT INIT('TDEVICE');
      439    18767    1   DCL IOM_STR        CHAR(0) CONSTANT INIT('IOM');
      440    18768    1   DCL STAT_HDR_FMT   CHAR(0) CONSTANT INIT('%>A %>A%/');
      441    18769    1   DCL STAT_DEV_HDR   CHAR(0) CONSTANT INIT
      442    18770    1           ('       NAME      IO       PROFILE      PASSWORD  CONNECT   TERMINAL');
      443    18771    1   DCL STAT_DEV_FMT   CHAR(0) CONSTANT INIT
      444    18772    1           ('%3-%A%A%9-%A%19-%A%28-%>A%41-%A%51-%A%61-%A');
      445    18773        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:72   
      446    18774        /********************************************************************/
      447    18775        /*   Procedure       procedure       procedure       procedure      */
      448    18776        /********************************************************************/
      449    18777
      450    18778    2   IF JCL THEN DO;
      451    18779    2      FMT_VEC (0) = VECTOR (KL$TWSNREC.STATION);
      452    18780    2      FDS.NVECS# = 1;
      453    18781    2      FMT_BUF = 'CREATE STATION %A%2/';
      454    18782    2      FDS.FMT_.BOUND = 19;
      455    18783    2      CALL X$FORMAT (FDS);
      456    18784    2      RETURN ;
      457    18785    2      END; /*  Jcl  */
      458    18786    1   FMT_VEC(0) = VECTOR(STATION_STR);
      459    18787    1   FMT_VEC(1) = VECTOR(KL$TWSNREC.STATION);
      460    18788    1   FMT_BUF = STAT_HDR_FMT;
      461    18789    1   FDS.FMT_.BOUND = SIZEC(STAT_HDR_FMT)-1;
      462    18790    1   FDS.NVECS# = 2;
      463    18791    1   CALL X$FORMAT(FDS);
      464    18792    1   CALL ASB$WRITE_LO(STAT_DEV_HDR,SIZEC(STAT_DEV_HDR));
      465    18793    1   FDS.NVECS# = 8;
      466    18794    1   FMT_BUF = STAT_DEV_FMT;
      467    18795    1   FDS.FMT_.BOUND = SIZEC(STAT_DEV_FMT)-1;
      468    18796    1   DEVNUM = 1;
      469    18797    2   DO I=0 TO KL$TWSNREC.NDEV-1;
      470    18798    2      FMT_VEC(0) = VECTOR(KL$TWSNREC.DEVS.TYP(I));
      471    18799    2      FMT_VEC(1) = VECTOR(KL$TWSNREC.DEVS.NUM(I));
      472    18800    2      IF KL$TWSNREC.DEVS.IO.INPUT(I)
      473    18801    2      THEN
      474    18802    2         IF KL$TWSNREC.DEVS.IO.OUTPUT(I)
      475    18803    2         THEN
      476    18804    2            FMT_VEC(3) = VECTOR(INOUT_STR);
      477    18805    2         ELSE
      478    18806    2            FMT_VEC(3) = VECTOR(IN_STR);
      479    18807    2      ELSE
      480    18808    2         IF KL$TWSNREC.DEVS.IO.OUTPUT(I)
      481    18809    2         THEN
      482    18810    2            FMT_VEC(3) = VECTOR(OUT_STR);
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:73   
      483    18811    2         ELSE
      484    18812    2            FMT_VEC(3) = VECTOR(NONE_STR);
      485    18813    2      IF KL$TWSNREC.DEVS.TDEV(I)
      486    18814    3      THEN DO;                    /* A tdev                             */
      487    18815    3         CONFIG_KEY.TERMID.TERM.TERM_NAME = KL$TWSNREC.DEVS.TERM(I) ;
      488    18816    3         CONFIG_KEY.TERMID.LEV = 2 ;
      489    18817    3         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(0) = DEVNUM/256;
      490    18818    3         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(1) = MOD(DEVNUM,256);
      491    18819    3         DEVNUM = DEVNUM + 1;
      492    18820    3         CALL ASB$READ_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG_BUF))
      493    18821    4         WHENRETURN DO;
      494    18822    4            KL_SS.SGN_R = LINCNFG.LGN.LGNSTRING;
      495    18823    4            END;  /*  Whenreturn from ASB$READ_NETCON  */
      496    18824    4         WHENALTRETURN DO;
      497    18825    4            KL_SS.SGN_R = ' ';
      498    18826    4            END;  /*  Whenaltreturn from ASB$READ_NETCON  */
      499    18827    3         FMT_VEC(2) = VECTOR(BL_STR);
      500    18828    3         FMT_VEC(4) = VECTOR(KL_SS.SGN.PNAME);
      501    18829    3         FMT_VEC(5) = VECTOR(NA_STR);
      502    18830    3         FMT_VEC(6) = VECTOR(TDEV_STR);
      503    18831    3         FMT_VEC(7) = VECTOR(KL$TWSNREC.DEVS.TERM(I));
      504    18832    3         END;  /*  A terminal device  */
      505    18833    3      ELSE DO;                    /* Not a tdev                         */
      506    18834    3         FMT_VEC(2) = VECTOR(KL$TWSNREC.DEVS.ACCT(I));
      507    18835    3         IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I)
      508    18836    4         THEN DO;  /*  Not iom connected  */
      509    18837    4            USERS_KEY.COUNT = 9;
      510    18838    4            CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      511    18839    4            DRECSZ = SIZEC(KL$DREC);
      512    18840    4            CALL ASB$ENQ_HLP;
      513    18841    4            CALL ASB$READ_HLP(ADDR(KL$DREC),DRECSZ)
      514    18842    5            WHENALTRETURN DO;
      515    18843    6               DO SELECT( MERR_CODE.CODE );
      516    18844
      517    18845    6                  SELECT( %E$NOKEY );
      518    18846    7                  DO J = I TO KL$TWSNREC.NDEV-2;
      519    18847    7                     KL$TWSNREC.DEVS(J) = KL$TWSNREC.DEVS(J+1);
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:74   
      520    18848    7                     END;  /*  Move devices back one  */
      521    18849    6                  KL$TWSNREC.NDEV = KL$TWSNREC.NDEV - 1;
      522    18850    6                  TWSN_ARS = TWSN_ARS - LENGTHC(KL$TWSNREC.DEVS(0));
      523    18851    6                  CALL BINCHAR (TWSN_KEY.TWSN, TWSN_NUMBER);
      524    18852    6                  USERS_KEY = TWSN_KEY;
      525    18853    6                  CALL ASB$WRITE_HLP( DSEG2$, TWSN_ARS );
      526    18854
      527    18855    6                  SELECT( ELSE );
      528    18856    6               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      529    18857    6                  END;  /*  Do case MERR_CODE.CODE  */
      530    18858    5               END ;  /*  Whenaltreturn from ASB$READ_HLP  */
      531    18859    4            CALL ASB$DEQ_HLP;
      532    18860    4            FMT_VEC(4) = VECTOR(KL$DREC.PNAME.TXT);
      533    18861    4            IF KL$DREC.PASSWORD = BLANK_PASS
      534    18862    4            THEN
      535    18863    4               FMT_VEC(5) = VECTOR(NO_STR);
      536    18864    4            ELSE
      537    18865    4               FMT_VEC(5) = VECTOR(YES_STR);
      538    18866    4            FMT_VEC(6) = VECTOR(DEV_STR);
      539    18867    4            FMT_VEC(7) = VECTOR(AS_BLANK);
      540    18868    4            END;   /*  Not iom connected  */
      541    18869    4         ELSE DO;                 /* Iom connected                      */
      542    18870    4            FMT_VEC(4) = VECTOR(NA_STR);
      543    18871    4            FMT_VEC(5) = VECTOR(NA_STR);
      544    18872    4            FMT_VEC(6) = VECTOR(IOM_STR);
      545    18873    4            FMT_VEC(7) = VECTOR(AS_BLANK);
      546    18874    4            END;  /*  Iom connected  */
      547    18875    3         END;  /*  Not a terminal device  */
      548    18876    2      CALL X$FORMAT(FDS);
      549    18877    2      END; /*  Loop through twsn device array  */
      550    18878    1   CALL ASB$WRITE_LO(' ',1);
      551    18879    1   RETURN;
      552    18880    1   END ASL$DISP_ONE_STATION;

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:75   
--  Include file information  --

   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_STATION.

   Procedure ASL$DISP_ONE_STATION requires 321 words for executable code.
   Procedure ASL$DISP_ONE_STATION requires 184 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_STATIONS.:E05TSI    .

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:76   

 Object Unit name= ASL$DISP_ONE_STATION                       File name= ASL$LIST_STATIONS.:E05TOU
 UTS= JUL 29 '97 10:22:30.88 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    66    102  ASL$DISP_ONE_STATION
    3  RoData even  UTS     52     64  ASL$DISP_ONE_STATION
    4   Proc  even  none   321    501  ASL$DISP_ONE_STATION
    5  RoData even  none    50     62  ASL$DISP_ONE_STATION

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        2  ASL$DISP_ONE_STATION
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:77   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       2 ASB$WRITE_HLP
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_NETCON
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$DEQ_HLP
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_MODE
r    AS_FE_MODE                            M$LO                                  USERS_KEY
     FDS                                   FMT_BUF                               FMT_VEC
     BLANK_PASS                            ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG2$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:78   


      322        1        /*T***********************************************************/
      323        2        /*T*                                                         */
      324        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      325        4        /*T*                                                         */
      326        5        /*T***********************************************************/
      327        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:79   
      328        7        /*M* ASL$DISP_ONE_STATION: routine to handle DISP STATION cmd  */
      329        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      330        9              ECU=3,CSU=3,SDI=3                                           */
      331       10        ASL$DISP_ONE_STATION: PROC (TWSN_NUMBER, JCL) ;

     10  4 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_2
         4 000001   000270 000002                    ZERO    184,2

      332       11        /**********************************************************/
      333       12
      334       13        /*D* NAME:     ASL$DISP_ONE_STATION
      335       14             CALL:     CALL ASL$DISP_ONE_STATION (TWSN_NUMBER, JCL)
      336       15             INPUT:    TWSN_NUMBER - the number of the TWSN record
      337       16                                      corresponding to the indicated STATION.
      338       17                       JCL - bit set if JCL option was specified on command.
      339       18             OUTPUT:   Nothing is returned.
      340       19             DESCRIPTION:  ASL$DISP_ONE_STATION is a subroutine to handle
      341       20                           the DISP STATION command for SUPER.
      342       21                           ASL$DISP_ONE_STATION will display the station
      343       22                           name and any devices hooked to it.
      344       23                           The TERM record is already in data segment 1.
      345       24                           The TWSNxxxx record is already in data segment 2.
      346       25                           The xxxxxxxxSTATION record doesn't have to be read
      347       26                           because it is a vanilla KL_DREC structure that was
      348       27                           written to :HLP just to let SLUG know that the
      349       28                           station has been defined and can logon?  There are
      350       29                           no options for stations and therefore nothing
      351       30                           to changes between station records except the name.
      352       31                           Any device records that need to be read by this
      353       32                           routine will be read into AUTO storage.
      354       33        */
      355       34        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:80   
      356       35        /********************************************************************/
      357       36        /*   Include files   include files   include files   include files  */
      358       37        /********************************************************************/
      359       38        %INCLUDE AS_PERR_C;
      360      640        %INCLUDE AS_SUPER_C;
      361     1075        %INCLUDE AS_SUBS_C;
      362     2489        %INCLUDE AS_MAC_C;
      363     2569        %INCLUDE AS_ENTRIES_M;
      364     3619        %INCLUDE AS_SSUBS_C;
      365     3711        %INCLUDE KC$CGBLK ;
      366     3759        %INCLUDE CP_6;
      367     3840        %INCLUDE B_ERRORS_C;
      368     4967        %INCLUDE KL_SUPER_C;
      369     7869        %INCLUDE XU_MACRO_C;
      370    10975        %INCLUDE XU_FORMAT_C;
      371    11137        %INCLUDE AS_SUPER_R;
      372    14153        %INCLUDE KL_CONFIG_M;
      373    14915        %INCLUDE KL_MACRO_C;
      374    18267        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:81   
      375    18268        /********************************************************************/
      376    18269        /*   Parameters     parameters     parameters     parameters        */
      377    18270        /********************************************************************/
      378    18271    1   DCL TWSN_NUMBER   UBIN;
      379    18272    1   DCL JCL           BIT(1) ;
      380    18273        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:82   
      381    18274        /********************************************************************/
      382    18275        /*   Static data     static data     static data     static data    */
      383    18276        /********************************************************************/
      384    18277        %KL$CONFIG_KEY ( NAME = CONFIG_KEY, STCLASS = STATIC);
      385    18324    1   DCL LINCNFG_BUF   (0:49)    UBIN WORD STATIC INIT(0*0);
      386    18325    1   DCL LINCNFG$                PTR STATIC INIT(ADDR(LINCNFG_BUF));
      387    18326        %KL$LINCNFG ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
      388    18484        %KL_SS;
      389    18519    1   DCL 1 TWSN_KEY STATIC,
      390    18520    1          2 *         UBIN BYTE UNAL INIT(8),
      391    18521    1          2 *         CHAR(4) INIT('TWSN'),
      392    18522    1          2 TWSN      CHAR(4);
      393    18523        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:83   
      394    18524        /********************************************************************/
      395    18525        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      396    18526        /********************************************************************/
      397    18527        %ASB$READ_HLP ;
      398    18530        %ASB$WRITE_HLP ;
      399    18533        %ASB$ENQ_HLP ;
      400    18536        %ASB$DEQ_HLP ;
      401    18539        %ASB$WRITE_LO ;
      402    18542        %ASA$ERROR ;
      403    18545        %ASB$READ_NETCON ;
      404    18548    1   DCL X$FORMAT ENTRY(1) ;
      405    18549        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:84   
      406    18550        /********************************************************************/
      407    18551        /*   Local based     local based     local based     local based    */
      408    18552        /********************************************************************/
      409    18553    1   DCL 1 TEXT$C BASED ALIGNED,
      410    18554    1          2 CNT       UBIN(9) UNAL ,
      411    18555    1          2 TEXT      CHAR(TEXT$C.CNT) UNAL;
      412    18556        %KL_TWSNREC ( NAME = KL$TWSNREC, STCLASS = "BASED(DSEG2$)");
      413    18581        %KL_DREC ( NAME = KL$DREC, PRO = ' ', LAST = ",", STCLASS = AUTO );
      414    18694        %KL_FEBLK ( NAME = KL$DREC$FEBLK, LVL = 2, RCNT = 31, STCLASS = AUTO );
      415    18743        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:85   
      416    18744        /********************************************************************/
      417    18745        /*   Auto data       auto data       auto data       auto data      */
      418    18746        /********************************************************************/
      419    18747    1   DCL J              SBIN;
      420    18748    1   DCL I              SBIN;
      421    18749    1   DCL DEVNUM         UBIN;
      422    18750    1   DCL DRECSZ         UBIN WORD;
      423    18751    1   DCL TWSN_ARS       UBIN;
      424    18752        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:86   
      425    18753        /********************************************************************/
      426    18754        /*   Constant data   constant data   constant data   constant data  */
      427    18755        /********************************************************************/
      428    18756    1   DCL BL_STR         CHAR(0) CONSTANT INIT(' ');
      429    18757    1   DCL STATION_STR    CHAR(0) CONSTANT INIT('STATION');
      430    18758    1   DCL INOUT_STR      CHAR(0) CONSTANT INIT('INOUT');
      431    18759    1   DCL IN_STR         CHAR(0) CONSTANT INIT('IN');
      432    18760    1   DCL OUT_STR        CHAR(0) CONSTANT INIT('OUT');
      433    18761    1   DCL NONE_STR       CHAR(0) CONSTANT INIT('NONE');
      434    18762    1   DCL NA_STR         CHAR(0) CONSTANT INIT('(NA)');
      435    18763    1   DCL YES_STR        CHAR(0) CONSTANT INIT('YES');
      436    18764    1   DCL NO_STR         CHAR(0) CONSTANT INIT('NO');
      437    18765    1   DCL DEV_STR        CHAR(0) CONSTANT INIT('DEVICE');
      438    18766    1   DCL TDEV_STR       CHAR(0) CONSTANT INIT('TDEVICE');
      439    18767    1   DCL IOM_STR        CHAR(0) CONSTANT INIT('IOM');
      440    18768    1   DCL STAT_HDR_FMT   CHAR(0) CONSTANT INIT('%>A %>A%/');
      441    18769    1   DCL STAT_DEV_HDR   CHAR(0) CONSTANT INIT
      442    18770    1           ('       NAME      IO       PROFILE      PASSWORD  CONNECT   TERMINAL');
      443    18771    1   DCL STAT_DEV_FMT   CHAR(0) CONSTANT INIT
      444    18772    1           ('%3-%A%A%9-%A%19-%A%28-%>A%41-%A%51-%A%61-%A');
      445    18773        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:87   
      446    18774        /********************************************************************/
      447    18775        /*   Procedure       procedure       procedure       procedure      */
      448    18776        /********************************************************************/
      449    18777
      450    18778    2   IF JCL THEN DO;

  18778  4 000002   200004 470500                    LDP0    @JCL,,AUTO
         4 000003   000000 066500                    CMPB    filb='0'B
         4 000004   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         4 000005   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000006   000032 600000 4                  TZE     s:18786

      451    18779    2      FMT_VEC (0) = VECTOR (KL$TWSNREC.STATION);

  18779  4 000007   000000 235000 5                  LDA     0
         4 000010   000000 236000 xsym               LDQ     DSEG2$
         4 000011   000002 036003                    ADLQ    2,DU
         4 000012   000000 755000 xsym               STA     FMT_VEC
         4 000013   000001 756000 xsym               STQ     FMT_VEC+1

      452    18780    2      FDS.NVECS# = 1;

  18780  4 000014   000001 235007                    LDA     1,DL
         4 000015   000011 755000 xsym               STA     FDS+9

      453    18781    2      FMT_BUF = 'CREATE STATION %A%2/';

  18781  4 000016   040000 100400                    MLR     fill='040'O
         4 000017   000057 000024 3                  ADSC9   STAT_DEV_FMT+11          cn=0,n=20
         4 000020   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      454    18782    2      FDS.FMT_.BOUND = 19;

  18782  4 000021   000000 236000 xsym               LDQ     FDS
         4 000022   177777 376007                    ANQ     65535,DL
         4 000023   000001 276000 5                  ORQ     1
         4 000024   000000 756000 xsym               STQ     FDS
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:88   

      455    18783    2      CALL X$FORMAT (FDS);

  18783  4 000025   000002 630400 5                  EPPR0   2
         4 000026   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000027   000000 701000 xent               TSX1    X$FORMAT
         4 000030   000000 011000                    NOP     0

      456    18784    2      RETURN ;

  18784  4 000031   000000 702200 xent               TSX2  ! X66_ARET

      457    18785    2      END; /*  Jcl  */
      458    18786    1   FMT_VEC(0) = VECTOR(STATION_STR);

  18786  4 000032   000004 237000 5                  LDAQ    4
         4 000033   000000 755000 xsym               STA     FMT_VEC
         4 000034   000001 756000 xsym               STQ     FMT_VEC+1

      459    18787    1   FMT_VEC(1) = VECTOR(KL$TWSNREC.STATION);

  18787  4 000035   000000 235000 5                  LDA     0
         4 000036   000000 236000 xsym               LDQ     DSEG2$
         4 000037   000002 036003                    ADLQ    2,DU
         4 000040   000002 755000 xsym               STA     FMT_VEC+2
         4 000041   000003 756000 xsym               STQ     FMT_VEC+3

      460    18788    1   FMT_BUF = STAT_HDR_FMT;

  18788  4 000042   040000 100400                    MLR     fill='040'O
         4 000043   000020 000011 3                  ADSC9   STAT_HDR_FMT             cn=0,n=9
         4 000044   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      461    18789    1   FDS.FMT_.BOUND = SIZEC(STAT_HDR_FMT)-1;

  18789  4 000045   000000 236000 xsym               LDQ     FDS
         4 000046   177777 376007                    ANQ     65535,DL
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:89   
         4 000047   000002 276003                    ORQ     2,DU
         4 000050   000000 756000 xsym               STQ     FDS

      462    18790    1   FDS.NVECS# = 2;

  18790  4 000051   000002 235007                    LDA     2,DL
         4 000052   000011 755000 xsym               STA     FDS+9

      463    18791    1   CALL X$FORMAT(FDS);

  18791  4 000053   000002 630400 5                  EPPR0   2
         4 000054   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000055   000000 701000 xent               TSX1    X$FORMAT
         4 000056   000000 011000                    NOP     0

      464    18792    1   CALL ASB$WRITE_LO(STAT_DEV_HDR,SIZEC(STAT_DEV_HDR));

  18792  4 000057   000007 630400 5                  EPPR0   7
         4 000060   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000061   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000062   000000 011000                    NOP     0

      465    18793    1   FDS.NVECS# = 8;

  18793  4 000063   000010 235007                    LDA     8,DL
         4 000064   000011 755000 xsym               STA     FDS+9

      466    18794    1   FMT_BUF = STAT_DEV_FMT;

  18794  4 000065   040000 100400                    MLR     fill='040'O
         4 000066   000044 000053 3                  ADSC9   STAT_DEV_FMT             cn=0,n=43
         4 000067   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      467    18795    1   FDS.FMT_.BOUND = SIZEC(STAT_DEV_FMT)-1;

  18795  4 000070   000000 236000 xsym               LDQ     FDS
         4 000071   177777 376007                    ANQ     65535,DL
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:90   
         4 000072   000011 276000 5                  ORQ     9
         4 000073   000000 756000 xsym               STQ     FDS

      468    18796    1   DEVNUM = 1;

  18796  4 000074   000001 235007                    LDA     1,DL
         4 000075   200260 755100                    STA     DEVNUM,,AUTO

      469    18797    2   DO I=0 TO KL$TWSNREC.NDEV-1;

  18797  4 000076   200257 450100                    STZ     I,,AUTO
         4 000077   000467 710000 4                  TRA     s:18877+1

      470    18798    2      FMT_VEC(0) = VECTOR(KL$TWSNREC.DEVS.TYP(I));

  18798  4 000100   377640 235007                    LDA     130976,DL
         4 000101   200257 236100                    LDQ     I,,AUTO
         4 000102   200264 755100                    STA     TWSN_ARS+2,,AUTO
         4 000103   000013 402003                    MPY     11,DU
         4 000104   000005 036003                    ADLQ    5,DU
         4 000105   000000 036000 xsym               ADLQ    DSEG2$
         4 000106   200264 235100                    LDA     TWSN_ARS+2,,AUTO
         4 000107   000000 755000 xsym               STA     FMT_VEC
         4 000110   000001 756000 xsym               STQ     FMT_VEC+1

      471    18799    2      FMT_VEC(1) = VECTOR(KL$TWSNREC.DEVS.NUM(I));

  18799  4 000111   377640 235007                    LDA     130976,DL
         4 000112   200257 236100                    LDQ     I,,AUTO
         4 000113   200264 755100                    STA     TWSN_ARS+2,,AUTO
         4 000114   000013 402003                    MPY     11,DU
         4 000115   000012 036000 5                  ADLQ    10
         4 000116   000000 036000 xsym               ADLQ    DSEG2$
         4 000117   200264 235100                    LDA     TWSN_ARS+2,,AUTO
         4 000120   000002 755000 xsym               STA     FMT_VEC+2
         4 000121   000003 756000 xsym               STQ     FMT_VEC+3

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:91   
      472    18800    2      IF KL$TWSNREC.DEVS.IO.INPUT(I)

  18800  4 000122   200257 236100                    LDQ     I,,AUTO
         4 000123   000013 402007                    MPY     11,DL
         4 000124   000000 470400 xsym               LDP0    DSEG2$
         4 000125   000006 236106                    LDQ     6,QL,PR0
         4 000126   000400 316007                    CANQ    256,DL
         4 000127   000145 600000 4                  TZE     s:18808

      473    18801    2      THEN
      474    18802    2         IF KL$TWSNREC.DEVS.IO.OUTPUT(I)

  18802  4 000130   200257 236100                    LDQ     I,,AUTO
         4 000131   000013 402007                    MPY     11,DL
         4 000132   000006 236106                    LDQ     6,QL,PR0
         4 000133   000200 316007                    CANQ    128,DL
         4 000134   000141 600000 4                  TZE     s:18806

      475    18803    2         THEN
      476    18804    2            FMT_VEC(3) = VECTOR(INOUT_STR);

  18804  4 000135   000014 237000 5                  LDAQ    12
         4 000136   000006 755000 xsym               STA     FMT_VEC+6
         4 000137   000007 756000 xsym               STQ     FMT_VEC+7
         4 000140   000161 710000 4                  TRA     s:18813

      477    18805    2         ELSE
      478    18806    2            FMT_VEC(3) = VECTOR(IN_STR);

  18806  4 000141   000016 237000 5                  LDAQ    14
         4 000142   000006 755000 xsym               STA     FMT_VEC+6
         4 000143   000007 756000 xsym               STQ     FMT_VEC+7
         4 000144   000161 710000 4                  TRA     s:18813

      479    18807    2      ELSE
      480    18808    2         IF KL$TWSNREC.DEVS.IO.OUTPUT(I)

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:92   
  18808  4 000145   200257 236100                    LDQ     I,,AUTO
         4 000146   000013 402007                    MPY     11,DL
         4 000147   000006 236106                    LDQ     6,QL,PR0
         4 000150   000200 316007                    CANQ    128,DL
         4 000151   000156 600000 4                  TZE     s:18812

      481    18809    2         THEN
      482    18810    2            FMT_VEC(3) = VECTOR(OUT_STR);

  18810  4 000152   000020 237000 5                  LDAQ    16
         4 000153   000006 755000 xsym               STA     FMT_VEC+6
         4 000154   000007 756000 xsym               STQ     FMT_VEC+7
         4 000155   000161 710000 4                  TRA     s:18813

      483    18811    2         ELSE
      484    18812    2            FMT_VEC(3) = VECTOR(NONE_STR);

  18812  4 000156   000022 237000 5                  LDAQ    18
         4 000157   000006 755000 xsym               STA     FMT_VEC+6
         4 000160   000007 756000 xsym               STQ     FMT_VEC+7

      485    18813    2      IF KL$TWSNREC.DEVS.TDEV(I)

  18813  4 000161   200257 236100                    LDQ     I,,AUTO
         4 000162   000013 402007                    MPY     11,DL
         4 000163   000006 236106                    LDQ     6,QL,PR0
         4 000164   000100 316007                    CANQ    64,DL
         4 000165   000261 600000 4                  TZE     s:18834

      486    18814    3      THEN DO;                    /* A tdev                             */

      487    18815    3         CONFIG_KEY.TERMID.TERM.TERM_NAME = KL$TWSNREC.DEVS.TERM(I) ;

  18815  4 000166   200257 236100                    LDQ     I,,AUTO
         4 000167   000054 402007                    MPY     44,DL
         4 000170   040000 100506                    MLR     fill='040'O
         4 000171   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:93   
         4 000172   000002 600010 2                  ADSC9   CONFIG_KEY+2             cn=3,n=8

      488    18816    3         CONFIG_KEY.TERMID.LEV = 2 ;

  18816  4 000173   002000 236003                    LDQ     1024,DU
         4 000174   000001 552040 2                  STBQ    CONFIG_KEY+1,'40'O

      489    18817    3         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(0) = DEVNUM/256;

  18817  4 000175   200260 236100                    LDQ     DEVNUM,,AUTO
         4 000176   000010 772000                    QRL     8
         4 000177   000001 676000 2                  ERQ     CONFIG_KEY+1
         4 000200   000377 376007                    ANQ     255,DL
         4 000201   000001 656000 2                  ERSQ    CONFIG_KEY+1

      490    18818    3         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(1) = MOD(DEVNUM,256);

  18818  4 000202   200260 236100                    LDQ     DEVNUM,,AUTO
         4 000203   000377 376007                    ANQ     255,DL
         4 000204   000033 736000                    QLS     27
         4 000205   000002 676000 2                  ERQ     CONFIG_KEY+2
         4 000206   377000 376003                    ANQ     130560,DU
         4 000207   000002 656000 2                  ERSQ    CONFIG_KEY+2

      491    18819    3         DEVNUM = DEVNUM + 1;

  18819  4 000210   200260 235100                    LDA     DEVNUM,,AUTO
         4 000211   000001 035007                    ADLA    1,DL
         4 000212   200260 755100                    STA     DEVNUM,,AUTO

      492    18820    3         CALL ASB$READ_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG_BUF))

  18820  4 000213   000030 630400 5                  EPPR0   24
         4 000214   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000215   000000 701000 xent               TSX1    ASB$READ_NETCON
         4 000216   000230 702000 4                  TSX2    s:18825

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:94   
      493    18821    4         WHENRETURN DO;

      494    18822    4            KL_SS.SGN_R = LINCNFG.LGN.LGNSTRING;

  18822  4 000217   000067 470400 2                  LDP0    LINCNFG$
         4 000220   000012 236100                    LDQ     10,,PR0
         4 000221   000011 772000                    QRL     9
         4 000222   000777 376007                    ANQ     511,DL
         4 000223   000000 620006                    EAX0    0,QL
         4 000224   040000 100540                    MLR     fill='040'O
         4 000225   000012 600010                    ADSC9   10,,PR0                  cn=3,n=*X0
         4 000226   000070 200032 2                  ADSC9   KL_SS                    cn=1,n=26

      495    18823    4            END;  /*  Whenreturn from ASB$READ_NETCON  */

  18823  4 000227   000233 710000 4                  TRA     s:18827

      496    18824    4         WHENALTRETURN DO;

      497    18825    4            KL_SS.SGN_R = ' ';

  18825  4 000230   040000 100400                    MLR     fill='040'O
         4 000231   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000232   000070 200032 2                  ADSC9   KL_SS                    cn=1,n=26

      498    18826    4            END;  /*  Whenaltreturn from ASB$READ_NETCON  */

      499    18827    3         FMT_VEC(2) = VECTOR(BL_STR);

  18827  4 000233   000032 237000 5                  LDAQ    26
         4 000234   000004 755000 xsym               STA     FMT_VEC+4
         4 000235   000005 756000 xsym               STQ     FMT_VEC+5

      500    18828    3         FMT_VEC(4) = VECTOR(KL_SS.SGN.PNAME);

  18828  4 000236   000034 237000 5                  LDAQ    28
         4 000237   000010 755000 xsym               STA     FMT_VEC+8
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:95   
         4 000240   000011 756000 xsym               STQ     FMT_VEC+9

      501    18829    3         FMT_VEC(5) = VECTOR(NA_STR);

  18829  4 000241   000036 237000 5                  LDAQ    30
         4 000242   000012 755000 xsym               STA     FMT_VEC+10
         4 000243   000013 756000 xsym               STQ     FMT_VEC+11

      502    18830    3         FMT_VEC(6) = VECTOR(TDEV_STR);

  18830  4 000244   000040 237000 5                  LDAQ    32
         4 000245   000014 755000 xsym               STA     FMT_VEC+12
         4 000246   000015 756000 xsym               STQ     FMT_VEC+13

      503    18831    3         FMT_VEC(7) = VECTOR(KL$TWSNREC.DEVS.TERM(I));

  18831  4 000247   000000 235000 5                  LDA     0
         4 000250   200257 236100                    LDQ     I,,AUTO
         4 000251   200264 755100                    STA     TWSN_ARS+2,,AUTO
         4 000252   000013 402003                    MPY     11,DU
         4 000253   000013 036003                    ADLQ    11,DU
         4 000254   000000 036000 xsym               ADLQ    DSEG2$
         4 000255   200264 235100                    LDA     TWSN_ARS+2,,AUTO
         4 000256   000016 755000 xsym               STA     FMT_VEC+14
         4 000257   000017 756000 xsym               STQ     FMT_VEC+15

      504    18832    3         END;  /*  A terminal device  */

  18832  4 000260   000462 710000 4                  TRA     s:18876

      505    18833    3      ELSE DO;                    /* Not a tdev                         */

      506    18834    3         FMT_VEC(2) = VECTOR(KL$TWSNREC.DEVS.ACCT(I));

  18834  4 000261   000000 235000 5                  LDA     0
         4 000262   200257 236100                    LDQ     I,,AUTO
         4 000263   200264 755100                    STA     TWSN_ARS+2,,AUTO
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:96   
         4 000264   000013 402003                    MPY     11,DU
         4 000265   000011 036003                    ADLQ    9,DU
         4 000266   000000 036000 xsym               ADLQ    DSEG2$
         4 000267   200264 235100                    LDA     TWSN_ARS+2,,AUTO
         4 000270   000004 755000 xsym               STA     FMT_VEC+4
         4 000271   000005 756000 xsym               STQ     FMT_VEC+5

      507    18835    3         IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I)

  18835  4 000272   200257 236100                    LDQ     I,,AUTO
         4 000273   000013 402007                    MPY     11,DL
         4 000274   000006 236106                    LDQ     6,QL,PR0
         4 000275   000036 736000                    QLS     30
         4 000276   400000 376003                    ANQ     -131072,DU
         4 000277   400000 676003                    ERQ     -131072,DU
         4 000300   000446 600000 4                  TZE     s:18870

      508    18836    4         THEN DO;  /*  Not iom connected  */

      509    18837    4            USERS_KEY.COUNT = 9;

  18837  4 000301   011000 236003                    LDQ     4608,DU
         4 000302   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      510    18838    4            CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  18838  4 000303   200257 236100                    LDQ     I,,AUTO
         4 000304   000054 402007                    MPY     44,DL
         4 000305   040000 100506                    MLR     fill='040'O
         4 000306   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 000307   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 000310   000052 236003                    LDQ     42,DU
         4 000311   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      511    18839    4            DRECSZ = SIZEC(KL$DREC);

  18839  4 000312   001244 235007                    LDA     676,DL
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:97   
         4 000313   200261 755100                    STA     DRECSZ,,AUTO

      512    18840    4            CALL ASB$ENQ_HLP;

  18840  4 000314   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000315   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000316   000000 011000                    NOP     0

      513    18841    4            CALL ASB$READ_HLP(ADDR(KL$DREC),DRECSZ)

  18841  4 000317   200005 630500                    EPPR0   KL$DREC,,AUTO
         4 000320   200264 450500                    STP0    TWSN_ARS+2,,AUTO
         4 000321   200261 631500                    EPPR1   DRECSZ,,AUTO
         4 000322   200267 451500                    STP1    TWSN_ARS+5,,AUTO
         4 000323   200264 633500                    EPPR3   TWSN_ARS+2,,AUTO
         4 000324   200266 453500                    STP3    TWSN_ARS+4,,AUTO
         4 000325   200266 630500                    EPPR0   TWSN_ARS+4,,AUTO
         4 000326   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000327   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000330   000332 702000 4                  TSX2    s:18843
         4 000331   000413 710000 4                  TRA     s:18859

      514    18842    5            WHENALTRETURN DO;

      515    18843    6               DO SELECT( MERR_CODE.CODE );

  18843  4 000332   000000 236000 xsym               LDQ     ERR_CODE
         4 000333   377770 376007                    ANQ     131064,DL
         4 000334   001020 116007                    CMPQ    528,DL
         4 000335   000407 601000 4                  TNZ     s:18856
         4 000336   000337 710000 4                  TRA     s:18846

      516    18844
      517    18845    6                  SELECT( %E$NOKEY );

      518    18846    7                  DO J = I TO KL$TWSNREC.NDEV-2;

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:98   
  18846  4 000337   200257 235100                    LDA     I,,AUTO
         4 000340   200256 755100                    STA     J,,AUTO
         4 000341   000351 710000 4                  TRA     s:18848+1

      519    18847    7                     KL$TWSNREC.DEVS(J) = KL$TWSNREC.DEVS(J+1);

  18847  4 000342   200256 236100                    LDQ     J,,AUTO
         4 000343   000054 402007                    MPY     44,DL
         4 000344   000000 470400 xsym               LDP0    DSEG2$
         4 000345   000106 100506                    MLR     fill='000'O
         4 000346   000020 000054                    ADSC9   16,Q,PR0                 cn=0,n=44
         4 000347   000005 000054                    ADSC9   5,Q,PR0                  cn=0,n=44

      520    18848    7                     END;  /*  Move devices back one  */

  18848  4 000350   200256 054100                    AOS     J,,AUTO
         4 000351   000000 470400 xsym               LDP0    DSEG2$
         4 000352   000004 236100                    LDQ     4,,PR0
         4 000353   000002 136007                    SBLQ    2,DL
         4 000354   200256 116100                    CMPQ    J,,AUTO
         4 000355   000342 605000 4                  TPL     s:18847

      521    18849    6                  KL$TWSNREC.NDEV = KL$TWSNREC.NDEV - 1;

  18849  4 000356   000004 235100                    LDA     4,,PR0
         4 000357   000001 135007                    SBLA    1,DL
         4 000360   000004 755100                    STA     4,,PR0

      522    18850    6                  TWSN_ARS = TWSN_ARS - LENGTHC(KL$TWSNREC.DEVS(0));

  18850  4 000361   200262 236100                    LDQ     TWSN_ARS,,AUTO
         4 000362   000054 136007                    SBLQ    44,DL
         4 000363   200262 756100                    STQ     TWSN_ARS,,AUTO

      523    18851    6                  CALL BINCHAR (TWSN_KEY.TWSN, TWSN_NUMBER);

  18851  4 000364   200003 471500                    LDP1    @TWSN_NUMBER,,AUTO
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:99   
         4 000365   100000 235100                    LDA     0,,PR1
         4 000366   000044 773000                    LRL     36
         4 000367   200264 757100                    STAQ    TWSN_ARS+2,,AUTO
         4 000370   000000 301500                    BTD
         4 000371   200264 000010                    NDSC9   TWSN_ARS+2,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         4 000372   000100 230004 2                  NDSC9   TWSN_KEY+1               cn=1,s=nosgn,sf=0,n=4

      524    18852    6                  USERS_KEY = TWSN_KEY;

  18852  4 000373   000000 100400                    MLR     fill='000'O
         4 000374   000077 000011 2                  ADSC9   TWSN_KEY                 cn=0,n=9
         4 000375   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      525    18853    6                  CALL ASB$WRITE_HLP( DSEG2$, TWSN_ARS );

  18853  4 000376   200262 633500                    EPPR3   TWSN_ARS,,AUTO
         4 000377   200265 453500                    STP3    TWSN_ARS+3,,AUTO
         4 000400   000013 236000 5                  LDQ     11
         4 000401   200264 756100                    STQ     TWSN_ARS+2,,AUTO
         4 000402   200264 630500                    EPPR0   TWSN_ARS+2,,AUTO
         4 000403   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000404   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000405   000000 011000                    NOP     0
         4 000406   000413 710000 4                  TRA     s:18859

      526    18854
      527    18855    6                  SELECT( ELSE );

      528    18856    6               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  18856  4 000407   000043 630400 5                  EPPR0   35
         4 000410   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000411   000000 701000 xent               TSX1    ASA$ERROR
         4 000412   000000 011000                    NOP     0

      529    18857    6                  END;  /*  Do case MERR_CODE.CODE  */

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:100  
      530    18858    5               END ;  /*  Whenaltreturn from ASB$READ_HLP  */

      531    18859    4            CALL ASB$DEQ_HLP;

  18859  4 000413   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000414   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 000415   000000 011000                    NOP     0

      532    18860    4            FMT_VEC(4) = VECTOR(KL$DREC.PNAME.TXT);

  18860  4 000416   000034 235000 5                  LDA     28
         4 000417   200264 452500                    STP2    TWSN_ARS+2,,AUTO
         4 000420   200264 236100                    LDQ     TWSN_ARS+2,,AUTO
         4 000421   000045 036000 5                  ADLQ    37
         4 000422   000010 755000 xsym               STA     FMT_VEC+8
         4 000423   000011 756000 xsym               STQ     FMT_VEC+9

      533    18861    4            IF KL$DREC.PASSWORD = BLANK_PASS

  18861  4 000424   040000 106500                    CMPC    fill='040'O
         4 000425   200007 000010                    ADSC9   KL$DREC+2,,AUTO          cn=0,n=8
         4 000426   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         4 000427   000434 601000 4                  TNZ     s:18865

      534    18862    4            THEN
      535    18863    4               FMT_VEC(5) = VECTOR(NO_STR);

  18863  4 000430   000046 237000 5                  LDAQ    38
         4 000431   000012 755000 xsym               STA     FMT_VEC+10
         4 000432   000013 756000 xsym               STQ     FMT_VEC+11
         4 000433   000437 710000 4                  TRA     s:18866

      536    18864    4            ELSE
      537    18865    4               FMT_VEC(5) = VECTOR(YES_STR);

  18865  4 000434   000050 237000 5                  LDAQ    40
         4 000435   000012 755000 xsym               STA     FMT_VEC+10
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:101  
         4 000436   000013 756000 xsym               STQ     FMT_VEC+11

      538    18866    4            FMT_VEC(6) = VECTOR(DEV_STR);

  18866  4 000437   000052 237000 5                  LDAQ    42
         4 000440   000014 755000 xsym               STA     FMT_VEC+12
         4 000441   000015 756000 xsym               STQ     FMT_VEC+13

      539    18867    4            FMT_VEC(7) = VECTOR(AS_BLANK);

  18867  4 000442   000054 237000 5                  LDAQ    44
         4 000443   000016 755000 xsym               STA     FMT_VEC+14
         4 000444   000017 756000 xsym               STQ     FMT_VEC+15

      540    18868    4            END;   /*  Not iom connected  */

  18868  4 000445   000462 710000 4                  TRA     s:18876

      541    18869    4         ELSE DO;                 /* Iom connected                      */

      542    18870    4            FMT_VEC(4) = VECTOR(NA_STR);

  18870  4 000446   000036 237000 5                  LDAQ    30
         4 000447   000010 755000 xsym               STA     FMT_VEC+8
         4 000450   000011 756000 xsym               STQ     FMT_VEC+9

      543    18871    4            FMT_VEC(5) = VECTOR(NA_STR);

  18871  4 000451   000036 237000 5                  LDAQ    30
         4 000452   000012 755000 xsym               STA     FMT_VEC+10
         4 000453   000013 756000 xsym               STQ     FMT_VEC+11

      544    18872    4            FMT_VEC(6) = VECTOR(IOM_STR);

  18872  4 000454   000056 237000 5                  LDAQ    46
         4 000455   000014 755000 xsym               STA     FMT_VEC+12
         4 000456   000015 756000 xsym               STQ     FMT_VEC+13
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:102  

      545    18873    4            FMT_VEC(7) = VECTOR(AS_BLANK);

  18873  4 000457   000054 237000 5                  LDAQ    44
         4 000460   000016 755000 xsym               STA     FMT_VEC+14
         4 000461   000017 756000 xsym               STQ     FMT_VEC+15

      546    18874    4            END;  /*  Iom connected  */

      547    18875    3         END;  /*  Not a terminal device  */

      548    18876    2      CALL X$FORMAT(FDS);

  18876  4 000462   000002 630400 5                  EPPR0   2
         4 000463   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000464   000000 701000 xent               TSX1    X$FORMAT
         4 000465   000000 011000                    NOP     0

      549    18877    2      END; /*  Loop through twsn device array  */

  18877  4 000466   200257 054100                    AOS     I,,AUTO
         4 000467   000000 470400 xsym               LDP0    DSEG2$
         4 000470   200257 236100                    LDQ     I,,AUTO
         4 000471   000100 604000 4                  TMI     s:18798
         4 000472   000004 116100                    CMPQ    4,,PR0
         4 000473   000100 602000 4                  TNC     s:18798

      550    18878    1   CALL ASB$WRITE_LO(' ',1);

  18878  4 000474   000060 630400 5                  EPPR0   48
         4 000475   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000476   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000477   000000 011000                    NOP     0

      551    18879    1   RETURN;

  18879  4 000500   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:103  
      552    18880    1   END ASL$DISP_ONE_STATION;

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:104  
--  Include file information  --

   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_STATION.
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:105  

 **** Variables and constants ****

  ****  Section 002  Data  ASL$DISP_ONE_STATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(171)   r     1 CONFIG_KEY                70-0-0/c STRC(243)   r     1 KL_SS
    67-0-0/w PTR         r     1 LINCNFG$
     5-0-0/w UBIN        r     1 LINCNFG_BUF(0:49)
    77-0-0/c STRC(81)    r     1 TWSN_KEY

  ****  Section 003 RoData ASL$DISP_ONE_STATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 BL_STR                    13-0-0/c CHAR(6)     r     1 DEV_STR
     3-0-0/c CHAR(5)     r     1 INOUT_STR                  5-0-0/c CHAR(2)     r     1 IN_STR
    17-0-0/c CHAR(3)     r     1 IOM_STR                   10-0-0/c CHAR(4)     r     1 NA_STR
     7-0-0/c CHAR(4)     r     1 NONE_STR                  12-0-0/c CHAR(2)     r     1 NO_STR
     6-0-0/c CHAR(3)     r     1 OUT_STR                    1-0-0/c CHAR(7)     r     1 STATION_STR
    44-0-0/c CHAR(43)    r     1 STAT_DEV_FMT              23-0-0/c CHAR(67)    r     1 STAT_DEV_HDR
    20-0-0/c CHAR(9)     r     1 STAT_HDR_FMT              15-0-0/c CHAR(7)     r     1 TDEV_STR
    11-0-0/c CHAR(3)     r     1 YES_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @JCL                       3-0-0/w PTR         r     1 @TWSN_NUMBER
   260-0-0/w UBIN        r     1 DEVNUM                   261-0-0/w UBIN        r     1 DRECSZ
   257-0-0/w SBIN        r     1 I                        256-0-0/w SBIN        r     1 J
    *0-0-0/b BIT         r     1 JCL                        5-0-0/w STRC(6084)  r     1 KL$DREC
   262-0-0/w UBIN        r     1 TWSN_ARS                  *0-0-0/w UBIN        r     1 TWSN_NUMBER

PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:106  
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/c CHAR(8)     r     1 BLANK_PASS
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)              0-0-0/b STRC        r     1 MERR_CODE
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w ASTR(387)   r     1 LINCNFG
     0-0-0/w ASTR(9)     r     1 TEXT$C


   Procedure ASL$DISP_ONE_STATION requires 321 words for executable code.
   Procedure ASL$DISP_ONE_STATION requires 184 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_STATIONS.:E05TSI    .
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:107  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:108  
          MINI XREF LISTING

ASA$ERROR
     18543**DCL-ENT 18856--CALL
ASA_BRKS_LOC
     11301**DCL     11301--REDEF
ASB$DEQ_HLP
     18537**DCL-ENT 18859--CALL
ASB$ENQ_HLP
     18534**DCL-ENT 18840--CALL
ASB$READ_HLP
     18528**DCL-ENT 18841--CALL
ASB$READ_NETCON
     18546**DCL-ENT 18820--CALL
ASB$WRITE_HLP
     18531**DCL-ENT 18853--CALL
ASB$WRITE_LO
     18540**DCL-ENT 18792--CALL    18878--CALL
AS_BLANK
     11161**DCL     18867--ASSIGN  18873--ASSIGN
AS_DEFAULT.BANNER_PERM
     11994**DCL     11995--REDEF
AS_DEFAULT.BUDGET.MACCT
     11899**DCL     11903--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11912**DCL     11915--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11895**DCL     11897--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11890**DCL     11892--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12010**DCL     12011--REDEF   12012--REDEF
AS_DEFAULT_DREC.PASSWORD
     13264**DCL     13268--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:109  
AS_DEFAULT_DREC.RENAME
     13287**DCL     13288--REDEF
AS_DFLT.BANNER_PERM
     11816**DCL     11817--REDEF
AS_DFLT.BUDGET.MACCT
     11721**DCL     11725--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11734**DCL     11737--REDEF
AS_DFLT.BUDGET.PACCUM
     11717**DCL     11719--REDEF
AS_DFLT.BUDGET.PMAXC
     11712**DCL     11714--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11832**DCL     11833--REDEF   11834--REDEF
AS_FE_MODE
     11167**DCL     11168--REDEF
AS_MODE
     11164**DCL     11166--REDEF
AS_MOD_USER.ACCESS
     14029**DCL     14030--REDEF
AS_MOD_USER.BANNER
     14016**DCL     14017--REDEF
AS_MOD_USER.BANNER_PERM
     14018**DCL     14019--REDEF
AS_MOD_USER.BILL
     14024**DCL     14025--REDEF
AS_MOD_USER.CPROC
     14020**DCL     14021--REDEF
AS_MOD_USER.FEBILL
     14100**DCL     14101--REDEF
AS_MOD_USER.FECXTMEM
     14117**DCL     14118--REDEF
AS_MOD_USER.FEMINTS
     14102**DCL     14103--REDEF
AS_MOD_USER.FEMMEM
     14113**DCL     14114--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:110  
AS_MOD_USER.FEMTIME
     14111**DCL     14112--REDEF
AS_MOD_USER.FEPPRIV
     14108**DCL     14110--REDEF
AS_MOD_USER.FEPRIV
     14105**DCL     14107--REDEF
AS_MOD_USER.FORCE_BIT
     14014**DCL     14015--REDEF
AS_MOD_USER.KEY
     14096**DCL     14098--REDEF
AS_MOD_USER.LASTCPROC
     14022**DCL     14023--REDEF
AS_MOD_USER.LIMITS.DO_
     14070**DCL     14071--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14086**DCL     14087--REDEF
AS_MOD_USER.LIMITS.LO
     14066**DCL     14067--REDEF
AS_MOD_USER.LIMITS.MEM
     14062**DCL     14063--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14090**DCL     14091--REDEF
AS_MOD_USER.LIMITS.PDIS
     14078**DCL     14079--REDEF
AS_MOD_USER.LIMITS.PO
     14074**DCL     14075--REDEF
AS_MOD_USER.LIMITS.TDIS
     14082**DCL     14083--REDEF
AS_MOD_USER.LIMITS.TIME
     14058**DCL     14059--REDEF
AS_MOD_USER.MAXENQ
     14039**DCL     14040--REDEF
AS_MOD_USER.PERM_BIT
     14012**DCL     14013--REDEF
AS_MOD_USER.PPRIV
     14034**DCL     14036--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:111  
AS_MOD_USER.PRIOB
     14041**DCL     14042--REDEF
AS_MOD_USER.PRIV
     14031**DCL     14033--REDEF
AS_MOD_USER.QUAN
     14037**DCL     14038--REDEF
AS_MOD_USER.SETUP
     14010**DCL     14011--REDEF
AS_PROJECT.BANNER_PERM
     12350**DCL     12351--REDEF
AS_PROJECT.BUDGET.MACCT
     12255**DCL     12259--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12268**DCL     12271--REDEF
AS_PROJECT.BUDGET.PACCUM
     12251**DCL     12253--REDEF
AS_PROJECT.BUDGET.PMAXC
     12246**DCL     12248--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12366**DCL     12367--REDEF   12368--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12528**DCL     12529--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12433**DCL     12437--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12446**DCL     12449--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12429**DCL     12431--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12424**DCL     12426--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12544**DCL     12545--REDEF   12546--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13750**DCL     13754--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13773**DCL     13774--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:112  
AS_PROJECT_DREC.PASSWORD
     13588**DCL     13592--REDEF
AS_PROJECT_DREC.RENAME
     13611**DCL     13612--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12172**DCL     12173--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12077**DCL     12081--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12090**DCL     12093--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12073**DCL     12075--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12068**DCL     12070--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12188**DCL     12189--REDEF   12190--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13426**DCL     13430--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13449**DCL     13450--REDEF
AS_USERS.BANNER_PERM
     11638**DCL     11639--REDEF
AS_USERS.BUDGET.MACCT
     11543**DCL     11547--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11556**DCL     11559--REDEF
AS_USERS.BUDGET.PACCUM
     11539**DCL     11541--REDEF
AS_USERS.BUDGET.PMAXC
     11534**DCL     11536--REDEF
AS_USERS.SETUP_CHRA.TXT
     11654**DCL     11655--REDEF   11656--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12706**DCL     12707--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12611**DCL     12615--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:113  
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12624**DCL     12627--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12607**DCL     12609--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12602**DCL     12604--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12722**DCL     12723--REDEF   12724--REDEF
BLANK_PASS
     11292**DCL     18861>>IF
BL_STR
     18756**DCL     18827--ASSIGN
CONFIG_KEY
     18290**DCL     18820--CALL
CONFIG_KEY.TERMID.LEV
     18312**DCL     18816<<ASSIGN
CONFIG_KEY.TERMID.TERM
     18312**DCL     18321--REDEF
CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT
     18315**DCL     18817<<ASSIGN  18818<<ASSIGN
CONFIG_KEY.TERMID.TERM.TERM_NAME
     18321**DCL     18815<<ASSIGN
DEVNUM
     18749**DCL     18796<<ASSIGN  18817>>ASSIGN  18818>>ASSIGN  18819<<ASSIGN  18819>>ASSIGN
DEV_STR
     18765**DCL     18866--ASSIGN
DRECSZ
     18750**DCL     18839<<ASSIGN  18841<>CALL
DSEG2$
     11303**DCL     18557--IMP-PTR 18779>>ASSIGN  18787>>ASSIGN  18797>>DOINDEX 18798>>ASSIGN  18799>>ASSIGN
     18800>>IF      18802>>IF      18808>>IF      18813>>IF      18815>>ASSIGN  18831>>ASSIGN  18834>>ASSIGN
     18835>>IF      18838>>CALLBLT 18846>>DOINDEX 18847>>ASSIGN  18847>>ASSIGN  18849>>ASSIGN  18849>>ASSIGN
     18853<>CALL
ERR_CODE
     11296**DCL     11297--REDEF
FDS
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:114  
     11193**DCL     18783<>CALL    18791<>CALL    18876<>CALL
FDS.FMT_.BOUND
     11198**DCL     18782<<ASSIGN  18789<<ASSIGN  18795<<ASSIGN
FDS.NVECS#
     11221**DCL     18780<<ASSIGN  18790<<ASSIGN  18793<<ASSIGN
FMT_BUF
     11292**DCL     18781<<ASSIGN  18788<<ASSIGN  18794<<ASSIGN
FMT_VEC
     11292**DCL     18779<<ASSIGN  18786<<ASSIGN  18787<<ASSIGN  18798<<ASSIGN  18799<<ASSIGN  18804<<ASSIGN
     18806<<ASSIGN  18810<<ASSIGN  18812<<ASSIGN  18827<<ASSIGN  18828<<ASSIGN  18829<<ASSIGN  18830<<ASSIGN
     18831<<ASSIGN  18834<<ASSIGN  18860<<ASSIGN  18863<<ASSIGN  18865<<ASSIGN  18866<<ASSIGN  18867<<ASSIGN
     18870<<ASSIGN  18871<<ASSIGN  18872<<ASSIGN  18873<<ASSIGN
I
     18748**DCL     18797<<DOINDEX 18798>>ASSIGN  18799>>ASSIGN  18800>>IF      18802>>IF      18808>>IF
     18813>>IF      18815>>ASSIGN  18831>>ASSIGN  18834>>ASSIGN  18835>>IF      18838>>CALLBLT 18846>>DOINDEX
INOUT_STR
     18758**DCL     18804--ASSIGN
IN_STR
     18759**DCL     18806--ASSIGN
IOM_STR
     18767**DCL     18872--ASSIGN
J
     18747**DCL     18846<<DOINDEX 18847>>ASSIGN  18847>>ASSIGN
JCL
     18272**DCL        10--PROC    18778>>IF
KL$DREC
     18594**DCL     18839--ASSIGN  18841--CALL
KL$DREC.PASSWORD
     18652**DCL     18656--REDEF   18861>>IF
KL$DREC.PNAME.TXT
     18669**DCL     18860--ASSIGN
KL$DREC.RENAME
     18675**DCL     18676--REDEF
KL$TWSNREC.DEVS
     18561**DCL     18847<<ASSIGN  18847>>ASSIGN  18850--ASSIGN
KL$TWSNREC.DEVS.ACCT
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:115  
     18575**DCL     18834--ASSIGN  18838>>CALLBLT
KL$TWSNREC.DEVS.IO.INPUT
     18567**DCL     18800>>IF
KL$TWSNREC.DEVS.IO.OUTPUT
     18568**DCL     18802>>IF      18808>>IF
KL$TWSNREC.DEVS.IOM_CONNECTED
     18570**DCL     18835>>IF
KL$TWSNREC.DEVS.NUM
     18563**DCL     18799--ASSIGN
KL$TWSNREC.DEVS.TDEV
     18569**DCL     18813>>IF
KL$TWSNREC.DEVS.TERM
     18576**DCL     18815>>ASSIGN  18831--ASSIGN
KL$TWSNREC.DEVS.TYP
     18562**DCL     18798--ASSIGN
KL$TWSNREC.NDEV
     18560**DCL     18797>>DOINDEX 18846>>DOINDEX 18849<<ASSIGN  18849>>ASSIGN
KL$TWSNREC.STATION
     18559**DCL     18779--ASSIGN  18787--ASSIGN
KL_DEFAULT.PASSWORD
     13912**DCL     13916--REDEF
KL_DEFAULT.RENAME
     13935**DCL     13936--REDEF
KL_DFLT.PASSWORD
     13102**DCL     13106--REDEF
KL_DFLT.RENAME
     13125**DCL     13126--REDEF
KL_DREC.PASSWORD
     12940**DCL     12944--REDEF
KL_DREC.RENAME
     12963**DCL     12964--REDEF
KL_DREC_CNT.PASSWORD
     12827**DCL     12831--REDEF
KL_DREC_CNT.RENAME
     12850**DCL     12851--REDEF
KL_SS.SGN
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:116  
     18508**DCL     18517--REDEF
KL_SS.SGN.PNAME
     18516**DCL     18828--ASSIGN
KL_SS.SGN_R
     18517**DCL     18822<<ASSIGN  18825<<ASSIGN
LINCNFG.LGN.LGNSIZE
     18481**DCL     18482--IMP-SIZ 18822>>ASSIGN
LINCNFG.LGN.LGNSTRING
     18482**DCL     18822>>ASSIGN
LINCNFG$
     18325**DCL     18344--IMP-PTR 18822>>ASSIGN  18822>>ASSIGN
LINCNFG_BUF
     18324**DCL     18325--DCLINIT 18820--CALL
MERR_CODE.CODE
     11297**DCL     18843>>DOSELCT
NA_STR
     18762**DCL     18829--ASSIGN  18870--ASSIGN  18871--ASSIGN
NONE_STR
     18761**DCL     18812--ASSIGN
NO_STR
     18764**DCL     18863--ASSIGN
OUT_STR
     18760**DCL     18810--ASSIGN
PROJ_KEY.TEXT
     11174**DCL     11174--REDEF
PROJ_KEY.TXT.PROJECT
     11174**DCL     11174--REDEF
REMEM_VAR
     11300**DCL     11300--REDEF
REM_FCMD
     11300**DCL     11301--REDEF
STATION_STR
     18757**DCL     18786--ASSIGN
STAT_DEV_FMT
     18771**DCL     18794>>ASSIGN  18795--ASSIGN
STAT_DEV_HDR
PL6.E3A0      #002=ASL$DISP_ONE_STATION File=ASL$LIST_STATIONS.:E05TSI           TUE 07/29/97 10:22 Page:117  
     18769**DCL     18792<>CALL    18792--CALL
STAT_HDR_FMT
     18768**DCL     18788>>ASSIGN  18789--ASSIGN
TDEV_STR
     18766**DCL     18830--ASSIGN
TEXT$C.CNT
     18554**DCL     18555--IMP-SIZ
TWSN_ARS
     18751**DCL     18850<<ASSIGN  18850>>ASSIGN  18853<>CALL
TWSN_KEY
     18519**DCL     18852>>ASSIGN
TWSN_KEY.TWSN
     18522**DCL     18851<<CALLBLT
TWSN_NUMBER
     18271**DCL        10--PROC    18851>>CALLBLT
USERS_KEY
     11171**DCL     18852<<ASSIGN  18856<>CALL
USERS_KEY.COUNT
     11171**DCL     18837<<ASSIGN
USERS_KEY.TEXT
     11171**DCL     11172--REDEF   11172--REDEF   11172--REDEF   11173--REDEF
USERS_KEY.TXTC
     11172**DCL     18838<<CALLBLT
X$FORMAT
     18548**DCL-ENT 18783--CALL    18791--CALL    18876--CALL
YES_STR
     18763**DCL     18865--ASSIGN
