
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:1    
        1        1        /*M* ZIO$INIT - 'CP-6 IDS/II' initialization.           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIO$INIT: PROC ALTRET
        8        8         /* USE($PR5 FOR GLOBAL$) */
        9        9               AVOID($PR5,$PR6,$PR7,$X7);
       10       10    1   DCL B$TCB$ PTR SYMREF;
       11       11    1   DCL M$DO DCB;
       12       12    1   DCL FPT$ PTR;
       13       13    1   DCL 1 FPT REDEF FPT$,
       14       14    1         2 PAGES UBIN(8) UNAL,
       15       15    1         2 WORDS UBIN(10) UNAL,
       16       16    1         2 * UBIN(18) UNAL;
       17       17    1   DCL J SBIN;
       18       18    1   DCL NEEDBUFS SBIN;
       19       19    1   DCL ZITSSSSIZ SBIN SYMREF;
       20       20    1   DCL SSORG UBIN SYMREF;
       21       21    1   DCL SSORG$ CONSTANT PTR INIT( ADDR(SSORG) );
       22       22    1   DCL SSS_CNTXT CHAR(ZITSSSSIZ) BASED(SSORG$);
       23       23    1   DCL SSS$CNTXT CHAR(ZITSSSSIZ) BASED(FPT$);
       24       24    1   DCL ZIO$EVENT ENTRY ASYNC;
       25       25    1   DCL ZIB$FIXPR5 ENTRY;
       26       26    1   DCL ZIB$SEGSIZE ENTRY(2);
       27       27    1   DCL ZIO$GETSEG ENTRY (3) ALTRET;
       28       28    1   DCL ZIO$ADDBUF ENTRY(1);
       29       29    1   DCL ZID$STATS ENTRY;
       30       30    1   DCL ZIB$ICALT ENTRY;
       31       31    1   DCL ZIO$DFLTOPN ENTRY(1) ALTRET;
       32       32    1   DCL ZIB$ICALT_EPTR EPTR INIT(ENTADDR(ZIB$ICALT)) CONSTANT;
       33       33    1   DCL 1 ZIB$ICALT_REDEF REDEF ZIB$ICALT_EPTR,
       34       34    1         2 HW1 UBIN(18) UNAL,
       35       35    1         2 HW2 UBIN(18) UNAL;
       36       36    1   DCL SIZE UBIN(36);
       37       37    1   DCL 1 SEGMENT BASED,
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:2    
       38       38    1         2 * CHAR(SIZE);
       39       39    1   DCL 1 SHALL CONSTANT,
       40       40    1         2 * UBIN(9) INIT(5) UNAL,
       41       41    1         2 * CHAR(5) INIT('SHALL');
       42       42    1   DCL 1 RINDEX CONSTANT,
       43       43    1         2 * UBIN(9) INIT(5) UNAL,
       44       44    1         2 * CHAR(5) INIT('INDEX');
       45       45        %INCLUDE ZI$GLOBAL;
       46      531        %GLOBALS;
       47      839        %BUFFERS;
       48      854        %SUB BUF#MIN=6; /* Minumum entries in buffer pool */
       49      855        %SUB INIT#SPC=10240; /* 6K Buffers.  4K Global */
       50      856        %INCLUDE CP_6_SUBS;
       51     1396        %INCLUDE CP_6;
       52     1477         %B$TCB;
       53     1480         %B$ALT;
       54     1488         %VLP_SCODE (FPTN=SC775, STCLASS=CONSTANT,
       55     1489         FCG='ZI', MID='M', MON=NO, CODE=775,
       56     1490         ASLSEG=YES, CFUS=YES, CUSR=YES, DDSEG=YES, ENQ=YES,
       57     1491         FMBUF=YES, ISEG=YES, ROSEG=YES, PPUT=YES);
       58     1552        %F$DCB;
       59     1609        %FPT_WAIT(STCLASS="CONSTANT SYMDEF",
       60     1610         UNITS=1);
       61     1624        %FPT_OPEN (STCLASS=CONSTANT,
       62     1625         XONLY=YES);
       63     1734        %FPT_GETDCB (STCLASS=CONSTANT);
       64     1749        %FPT_RELDCB (STCLASS=CONSTANT);
       65     1763        %FPT_READ(STCLASS=CONSTANT);
       66     1802        %FPT_WRITE(STCLASS=CONSTANT);
       67     1833         %FPT_PRECORD(STCLASS=CONSTANT);
       68     1854        %FPT_DELREC (STCLASS=CONSTANT);
       69     1873        %FPT_CLOSE (STCLASS=CONSTANT,
       70     1874         REBLD=NO,
       71     1875         DISP=SAVE);
       72     1917        %FPT_CHECK (STCLASS=CONSTANT);
       73     1931        %FPT_GDS (STCLASS=CONSTANT);
       74     1947        %FPT_GDS (FPTN=FPT_GETGLBL,
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:3    
       75     1948         STCLASS=CONSTANT,
       76     1949         SEGSIZE=INIT#SPC,
       77     1950         COMMON=YES);
       78     1966        %FPT_FDS (STCLASS=CONSTANT);
       79     1981        %FPT_ENQ(STCLASS=CONSTANT,
       80     1982         WAIT=YES);
       81     2000        %FPT_DEQ(STCLASS=CONSTANT,
       82     2001         RELRES=YES);
       83     2018        %FPT_EVENT (STCLASS=CONSTANT,
       84     2019         UENTRY=ZIO$EVENT);
       85     2033        %FPT_XCON (STCLASS=CONSTANT,
       86     2034         UENTRY=ZIO$EVENT);
       87     2048        %FPT_INT(STCLASS=CONSTANT,
       88     2049         UENTRY=ZIO$EVENT);
       89     2063        %FPT_TRAP(STCLASS=CONSTANT,
       90     2064         PROGRAMMED=ZIO$EVENT,
       91     2065         DERAIL=TRAP,
       92     2066         ERRORS=ZIO$EVENT,
       93     2067         SECURITY_1=TRAP,
       94     2068         MEMORY=TRAP,
       95     2069         IPR=TRAP,
       96     2070         MISSING_SEG=TRAP,
       97     2071         MISSING_PAGE=TRAP,
       98     2072         SECURITY_2=TRAP);
       99     2095        %FPT_TIME(STCLASS=CONSTANT,SOURCE=CLOCK,DEST=UTS);
      100     2114        %FPT_TRUNC(STCLASS=CONSTANT);
      101     2128        %FPT_PFIL (STCLASS=CONSTANT);
      102     2143        %FPT_ERRMSG(STCLASS=CONSTANT,
      103     2144         VFC='a',
      104     2145         TYC=YES);
      105     2172        %FPT_TRTN(STCLASS=CONSTANT);
      106     2189        %FPT_SCREECH(STCLASS=CONSTANT,SCODE=SC775);
      107     2203        %VLP_VECTOR (STCLASS=CONSTANT);
      108     2218         %FPT_KEYIN(STCLASS=CONSTANT,OCTYPE=SYSTEM,WSN='LOCAL');
      109     2237         %FPT_MONINFO(STCLASS=CONSTANT);
      110     2252        %FPT_ERR(STCLASS="CONSTANT SYMDEF",STEPCC=ABORT);
      111     2267        %FPT_OPEN (FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:4    
      112     2376        %FPT_OPEN (FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      113     2485        %FPT_OPEN (FPTN=FPT$OPNSCRB,STCLASS="BASED(FPT$)");
      114     2594        %FPT_OPEN(FPTN=FPT$REOPEN,STCLASS="BASED(FPT$)");
      115     2703        %FPT_GETDCB (FPTN=FPT$GETDCB,STCLASS="BASED(FPT$)");
      116     2718        %FPT_RELDCB (FPTN=FPT$RELDCB,STCLASS="BASED(FPT$)");
      117     2732        %FPT_READ (FPTN=FPT$READD,STCLASS="BASED(FPT$)");
      118     2771        %FPT_READ (FPTN=FPT$READI,STCLASS="BASED(FPT$)");
      119     2810        %FPT_READ (FPTN=FPT$READK,STCLASS="BASED(FPT$)");
      120     2849         %FPT_READ(FPTN=FPT$READJ,STCLASS="BASED(FPT$)");
      121     2888        %FPT_WRITE (FPTN=FPT$WRTD,STCLASS="BASED(FPT$)");
      122     2919        %FPT_WRITE (FPTN=FPT$WRTI,STCLASS="BASED(FPT$)");
      123     2950        %FPT_WRITE (FPTN=FPT$WRTK,STCLASS="BASED(FPT$)");
      124     2981        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS="BASED(FPT$)");
      125     3012         %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(FPT$)");
      126     3043        %FPT_WRITE(FPTN=FPT$WRTC,STCLASS="BASED(FPT$)");
      127     3074        %FPT_PRECORD (FPTN=FPT$PREC,STCLASS="BASED(FPT$)");
      128     3095         %FPT_PRECORD(FPTN=FPT$PRECJ,STCLASS="BASED(FPT$)");
      129     3116         %FPT_PRECORD(FPTN=FPT$PRECI,STCLASS="BASED(FPT$)");
      130     3137        %FPT_DELREC (FPTN=FPT$DELR,STCLASS="BASED(FPT$)");
      131     3156         %FPT_DELREC(FPTN=FPT$DELI,STCLASS="BASED(FPT$)");
      132     3175        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS="BASED(FPT$)");
      133     3217        %FPT_CHECK (FPTN=FPT$CHECK,STCLASS="BASED(FPT$)");
      134     3231        %FPT_GDS (FPTN=FPT$GDS,STCLASS="BASED(FPT$)");
      135     3247        %FPT_FDS (FPTN=FPT$FDS,STCLASS="BASED(FPT$)");
      136     3262        %FPT_ENQ (FPTN=FPT$ENQ,STCLASS="BASED(FPT$)");
      137     3280        %FPT_ENQ(FPTN=FPT$ENQS,STCLASS="BASED(FPT$)");
      138     3298        %FPT_ENQ(FPTN=FPT$ENQI,STCLASS="BASED(FPT$)");
      139     3316        %FPT_DEQ(FPTN=FPT$DEQ,STCLASS="BASED(FPT$)");
      140     3333        %FPT_DEQ(FPTN=FPT$DEQI,STCLASS="BASED(FPT$)");
      141     3350        %FPT_DEQ(FPTN=FPT$DEQALL,STCLASS="BASED(FPT$)");
      142     3367        %FPT_TIME(FPTN=FPT$TIME,STCLASS="BASED(FPT$)");
      143     3386        %FPT_TIME(FPTN=FPT$TIMEC,STCLASS="BASED(FPT$)");
      144     3405        %FPT_TRUNC(FPTN=FPT$TRUNC,STCLASS="BASED(FPT$)");
      145     3419        %FPT_PFIL (FPTN=FPT$PFIL,STCLASS="BASED(FPT$)");
      146     3434        %FPT_ERRMSG(FPTN=FPT$ERRMSG,STCLASS="BASED(FPT$)");
      147     3461        %FPT_TRTN(FPTN=FPT$TRTN,STCLASS="BASED(FPT$)");
      148     3478        %FPT_SCREECH(FPTN=FPT$SCREECH,STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:5    
      149     3492         %FPT_KEYIN(FPTN=FPT$KEYIN,STCLASS="BASED(FPT$)");
      150     3511         %FPT_MONINFO(FPTN=FPT$MONINFO,STCLASS="BASED(FPT$)");
      151     3526        %VLP_ALTKEYS(FPTN=VLP$ALTKEYS,N=21,STCLASS="BASED(FPT$)");
      152     3541        %VLP_VECTOR (FPTN=VLP$VECTOR,STCLASS="BASED");
      153     3556        /*       Declare all symdef'ed constant variables here */
      154     3557    1   DCL ZI_FPTCHKR BIT(1) CONSTANT SYMDEF INIT(%YES#);
      155     3558    1   DCL ZI_FPTCHKR_DUMP BIT(1) CONSTANT SYMDEF INIT(%NO#);
      156     3559    1   DCL ZI_TEST BIT(1) CONSTANT SYMDEF INIT(%NO#);
      157     3560    1   DCL ZI_USER BIT(1) CONSTANT SYMDEF INIT(%NO#);
      158     3561    1   DCL ZI_WAITIO BIT(1) CONSTANT SYMDEF INIT (%NO#);
      159     3562    1   DCL ZI_TJNAME CHAR(4) CONSTANT SYMDEF INIT('*I  ');
      160     3563    1   DCL ZI_MAXKEY(0:255) CHAR(1) UNAL CONSTANT SYMDEF INIT(BITASC('777'O) * 256);
      161     3564        %EJECT;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:6    
      162     3565        /*
      163     3566            Get space for global region.
      164     3567                                                                   */
      165     3568    1       CALL M$GDS(FPT_GETGLBL) ALTRET (INIT_ERR);
      166     3569    1       CALL ZIB$FIXPR5;
      167     3570        /*
      168     3571            Initialize database information in the global region.
      169     3572                                                                   */
      170     3573    1       SIZE=INIT#SPC*4; /* Into bytes */
      171     3574    1       GLOBAL$->SEGMENT='0'B;
      172     3575    2       DO J = 1 TO DB#MAX;
      173     3576    2           GLOBAL.DB.SSS$(J) = ADDR(NIL);
      174     3577    2           GLOBAL.DB.DBCB$(J) = ADDR(NIL);
      175     3578    2           END;
      176     3579    1       GLOBAL.ACTIVE.SSS$=ADDR(NIL);
      177     3580    1       GLOBAL.ACTIVE.DBCB$=ADDR(NIL);
      178     3581    1       GLOBAL.RNAME.LENGTH=4;
      179     3582    1       FPT$ = ADDR(GLOBAL.FPTBASE);
      180     3583        /*
      181     3584                 VLP area for alternate keys
      182     3585        */
      183     3586    1       GLOBAL.ALTKEYS$=FPT$;
      184     3587    1       VLP$ALTKEYS.SIZ#=0;
      185     3588    1       FPT$=PINCRW(FPT$,SIZEW(VLP$ALTKEYS));
      186     3589        /*
      187     3590                          Fpt to perform an actual open.
      188     3591                                                                   */
      189     3592    1       GLOBAL.OPEN$ = FPT$;
      190     3593    1       FPT$OPEN = FPT_OPEN;
      191     3594    1       FPT$OPEN.V_ = VECTOR(FPT$OPEN.V);
      192     3595    1       FPT$OPEN.V.INITZ.REASSIGN#=%YES#;
      193     3596    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$OPEN));
      194     3597        /*
      195     3598                          Fpt to perform an default open (setdcb=yes).
      196     3599                                                                   */
      197     3600    1       GLOBAL.OPNDFLT$ = FPT$;
      198     3601    1       FPT$OPNDFLT = FPT_OPEN;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:7    
      199     3602    1       FPT$OPNDFLT.V_ = VECTOR(FPT$OPNDFLT.V);
      200     3603    1       FPT$OPNDFLT.NAME_=VECTOR(GLOBAL.FILENAME);
      201     3604    1       FPT$OPNDFLT.ACCT_=VECTOR(GLOBAL.ACCT);
      202     3605    1       FPT$OPNDFLT.V.SETDCB# = %YES#;
      203     3606    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$OPNDFLT));
      204     3607        /*
      205     3608                          Fpt to do a scrubed open
      206     3609                                                                     */
      207     3610    1       GLOBAL.OPNSCRB$=FPT$;
      208     3611    1       FPT$OPNSCRB=FPT_OPEN;
      209     3612    1       FPT$OPNSCRB.V_=VECTOR(FPT$OPNSCRB.V);
      210     3613    1       FPT$OPNSCRB.NAME_=VECTOR(GLOBAL.FILENAME);
      211     3614    1       FPT$OPNSCRB.ACCT_=VECTOR(GLOBAL.ACCT);
      212     3615    1       FPT$OPNSCRB.V.ASN#=%FILE#;
      213     3616    1       FPT$OPNSCRB.V.INITZ.SCRUB#=%YES#;
      214     3617    1       FPT$=PINCRW(FPT$,SIZEW(FPT$OPNSCRB));
      215     3618        /*
      216     3619                          Fpt to reopen a DCB without changing anything.
      217     3620                                                                     */
      218     3621    1       GLOBAL.REOPEN$=FPT$;
      219     3622    1       FPT$REOPEN=FPT_OPEN;
      220     3623    1       FPT$REOPEN.V_=VECTOR(FPT$REOPEN.V);
      221     3624    1       FPT$=PINCRW(FPT$,SIZEW(FPT$REOPEN));
      222     3625        /*
      223     3626                          Fpt to perform a M$GETDCB operation.
      224     3627                                                                   */
      225     3628    1       GLOBAL.GETDCB$ = FPT$;
      226     3629    1       FPT$GETDCB = FPT_GETDCB;
      227     3630    1       FPT$GETDCB.V_ = VECTOR(FPT$GETDCB.V);
      228     3631    1       FPT$GETDCB.DCBNAME_ = VECTOR(GLOBAL.DCBNAME);
      229     3632    1       FPT$GETDCB.DCBNUM_ = VECTOR(GLOBAL.DCBNUMBER);
      230     3633    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$GETDCB));
      231     3634        /*
      232     3635                          Fpt to perform a M$RELDCB operation.
      233     3636                                                                   */
      234     3637    1       GLOBAL.RELDCB$ = FPT$;
      235     3638    1       FPT$RELDCB = FPT_RELDCB;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:8    
      236     3639    1       FPT$RELDCB.V_ = VECTOR(FPT$RELDCB.V);
      237     3640    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$RELDCB));
      238     3641        /*
      239     3642                          Fpt to read a data-base block (ids org).
      240     3643                                                                   */
      241     3644    1       GLOBAL.READD$ = FPT$;
      242     3645    1       FPT$READD = FPT_READ;
      243     3646    1       FPT$READD.V_ = VECTOR(FPT$READD.V);
      244     3647    1       FPT$READD.KEY_ = VECTOR(GLOBAL.GRANULE);
      245     3648    1       FPT$READD.BUF_.BOUND = SIZEV(BLOCK);
      246     3649    1       FPT$READD.V.FULL#=%YES#;
      247     3650    1       FPT$READD.V.KEYS#=%YES#;
      248     3651    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$READD));
      249     3652        /*
      250     3653                          Fpt to write a data-base block (ids org).
      251     3654                                                                   */
      252     3655    1       GLOBAL.WRTD$ = FPT$;
      253     3656    1       FPT$WRTD = FPT_WRITE;
      254     3657    1       FPT$WRTD.V_ = VECTOR(FPT$WRTD.V);
      255     3658    1       FPT$WRTD.KEY_ = VECTOR(GLOBAL.GRANULE);
      256     3659    1       FPT$WRTD.BUF_.BOUND = SIZEV(BLOCK);
      257     3660    1       IF ZI_WAITIO THEN
      258     3661    1           FPT$WRTD.V.WAIT# = %YES#;
      259     3662    1       ELSE
      260     3663    1           FPT$WRTD.V.WAIT# = %NO#;
      261     3664    1       FPT$WRTD.V.FULL#=%YES#;
      262     3665    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$WRTD));
      263     3666        /*
      264     3667                          Fpt to read a data-base record (indexed org).
      265     3668                                                                   */
      266     3669        /* NOTE: For indexed keys there is no length but it is easier to
      267     3670                 manage them internaly if a length is used.  Therefore
      268     3671                 although a length is in GLOBAL.KEY.LENGTH  the vector
      269     3672                 skips over that byte.  DBACS builds the key descriptors
      270     3673                 using a one byte offset and that is why KEYPA is correct
      271     3674                 for INDEXED files also.
      272     3675        */
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:9    
      273     3676    1       GLOBAL.READI$ = FPT$;
      274     3677    1       FPT$READI = FPT_READ;
      275     3678    1       FPT$READI.V_ = VECTOR(FPT$READI.V);
      276     3679    1       FPT$READI.STATION_=VECTOR(GLOBAL.KEYID);
      277     3680    1       FPT$READI.KEY_=VECTOR(GLOBAL.KEY.VALUE);
      278     3681    1       FPT$READI.V.ID#=%YES#;
      279     3682    1       FPT$READI.V.IDS#=%YES#;
      280     3683    1       FPT$READI.V.KEYS#=%YES#;
      281     3684    1       FPT$READI.V.KEYR#=%YES#;
      282     3685    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$READI));
      283     3686        /*
      284     3687                          Fpt to write a data-base record (indexed org).
      285     3688                                                                   */
      286     3689    1       GLOBAL.WRTI$ = FPT$;
      287     3690    1       FPT$WRTI = FPT_WRITE;
      288     3691    1       FPT$WRTI.V_ = VECTOR(FPT$WRTI.V);
      289     3692    1       FPT$WRTI.STATION_=VECTOR(GLOBAL.KEYID);
      290     3693    1       FPT$WRTI.V.ID#=%YES#;
      291     3694    1       FPT$WRTI.V.NEWKEY#=%YES#;
      292     3695    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$WRTI));
      293     3696        /*
      294     3697                    FPT to position in an indexed file by index number
      295     3698        */
      296     3699    1       GLOBAL.PRECI$=FPT$;
      297     3700    1       FPT$PRECI=FPT_PRECORD;
      298     3701    1       FPT$PRECI.V_=VECTOR(FPT$PRECI.V);
      299     3702    1       FPT$PRECI.KEY_=VECTOR(GLOBAL.KEY.VALUE);
      300     3703    1       FPT$PRECI.IDBUF_=VECTOR(GLOBAL.KEYID);
      301     3704    1       FPT$PRECI.V.ID#=%YES#;
      302     3705    1       FPT$PRECI.V.KEYS#=%YES#;
      303     3706    1       FPT$PRECI.V.KEYR#=%YES#;
      304     3707    1       FPT$=PINCRW(FPT$,SIZEW(FPT$PRECI));
      305     3708        /*
      306     3709                    FPT to delete an indexed record
      307     3710        */
      308     3711    1       GLOBAL.DELI$=FPT$;
      309     3712    1       FPT$DELI=FPT_DELREC;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:10   
      310     3713    1       FPT$DELI.V_=VECTOR(FPT$DELI.V);
      311     3714    1       FPT$DELI.KEY_=VECTOR(GLOBAL.KEY.VALUE);
      312     3715    1       FPT$DELI.V.INDX#=1;
      313     3716    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DELI));
      314     3717        /*
      315     3718                       Fpt's for writing 'print' records.
      316     3719                                                                   */
      317     3720    1       GLOBAL.WRITE$=FPT$;
      318     3721    1       FPT$WRITE=FPT_WRITE;
      319     3722    1       FPT$WRITE.V_=VECTOR(FPT$WRITE.V);
      320     3723    1       FPT$WRITE.BUF_=VECTOR(GLOBAL.PRINTBUF);
      321     3724    1       FPT$WRITE.V.DVBYTE.VFC#=%YES#;
      322     3725    1       FPT$=PINCRW(FPT$,SIZEW(FPT$WRITE));
      323     3726        /*
      324     3727                    FPT for reading from a journal
      325     3728        */
      326     3729    1       GLOBAL.READJ$=FPT$;
      327     3730    1       FPT$READJ=FPT_READ;
      328     3731    1       FPT$READJ.V_=VECTOR(FPT$READJ.V);
      329     3732    1       FPT$READJ.BUF_=VECTOR(GLOBAL.JRECORD);
      330     3733    1       FPT$=PINCRW(FPT$,SIZEW(FPT$READJ));
      331     3734        /*
      332     3735                    FPT for writting a journal
      333     3736        */
      334     3737    1       GLOBAL.WRTJ$=FPT$;
      335     3738    1       FPT$WRTJ=FPT_WRITE;
      336     3739    1       FPT$WRTJ.V_=VECTOR(FPT$WRTJ.V);
      337     3740    1       FPT$WRTJ.BUF_=VECTOR(GLOBAL.JRECORD);
      338     3741    1       FPT$=PINCRW(FPT$,SIZEW(FPT$WRTJ));
      339     3742        /*
      340     3743                    FPT for position in a journal
      341     3744        */
      342     3745    1       GLOBAL.PRECJ$=FPT$;
      343     3746    1       FPT$PRECJ=FPT_PRECORD;
      344     3747    1       FPT$PRECJ.V_=VECTOR(FPT$PRECJ.V);
      345     3748    1       FPT$PRECJ.V.N#=-1;
      346     3749    1       FPT$=PINCRW(FPT$,SIZEW(FPT$PRECJ));
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:11   
      347     3750        /*
      348     3751                          Fpt to read from a keyed file (keyed org).
      349     3752                                                                   */
      350     3753    1       GLOBAL.READK$ = FPT$;
      351     3754    1       FPT$READK = FPT_READ;
      352     3755    1       FPT$READK.V_ = VECTOR(FPT$READK.V);
      353     3756    1       FPT$READK.KEY_ = VECTOR(GLOBAL.KEY);
      354     3757    1       FPT$READK.V.KEYS#=%YES#;
      355     3758    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$READK));
      356     3759        /*
      357     3760                          Fpt for writing to a keyed file (keyed org).     *
      358     3761                                                                   */
      359     3762    1       GLOBAL.WRTK$ = FPT$;
      360     3763    1       FPT$WRTK = FPT_WRITE;
      361     3764    1       FPT$WRTK.V_ = VECTOR(FPT$WRTK.V);
      362     3765    1       FPT$WRTK.KEY_ = VECTOR(GLOBAL.KEY);
      363     3766    1       FPT$WRTK.V.NEWKEY#=%YES#;
      364     3767    1       FPT$WRTK.V.ONEWKEY#=%NO#;
      365     3768    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$WRTK));
      366     3769        /*
      367     3770                         Fpt to position a keyed file
      368     3771                                                              */
      369     3772    1       GLOBAL.PREC$=FPT$;
      370     3773    1       FPT$PREC=FPT_PRECORD;
      371     3774    1       FPT$PREC.V_=VECTOR(FPT$PREC.V);
      372     3775    1       FPT$PREC.KEY_=VECTOR(GLOBAL.SKEY);
      373     3776    1       FPT$PREC.V.KEYS#=%YES#;
      374     3777    1       FPT$PREC.V.KEYR#=%YES#;
      375     3778    1       FPT$=PINCRW(FPT$,SIZEW(FPT$PREC));
      376     3779        /*
      377     3780                         Fpt to delete a record in a keyed file
      378     3781                                                                */
      379     3782    1       GLOBAL.DELR$=FPT$;
      380     3783    1       FPT$DELR=FPT_DELREC;
      381     3784    1       FPT$DELR.V_=VECTOR(FPT$DELR.V);
      382     3785    1       FPT$DELR.KEY_=VECTOR(GLOBAL.SKEY);
      383     3786    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DELR));
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:12   
      384     3787        /*
      385     3788                          Fpt to perform a M$CLOSE operation.
      386     3789                                                                   */
      387     3790    1       GLOBAL.CLOSE$ = FPT$;
      388     3791    1       FPT$CLOSE = FPT_CLOSE;
      389     3792    1       FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);
      390     3793    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$CLOSE));
      391     3794        /*
      392     3795                          Vector location pointer (results from M$GDS, M$FDS calls).
      393     3796                                                                   */
      394     3797    1       GLOBAL.CHECK$ = FPT$;
      395     3798    1       FPT$CHECK = FPT_CHECK;
      396     3799    1       FPT$CHECK.V_ = VECTOR(FPT$CHECK.V);
      397     3800        /*
      398     3801                          Fpt to perform an actual open.
      399     3802                                                                   */
      400     3803    1       GLOBAL.VLP$ = PINCRW(FPT$,SIZEW(FPT$CHECK));
      401     3804    1       FPT$ = PINCRW(GLOBAL.VLP$,SIZEW(VLP$VECTOR));
      402     3805        /*
      403     3806                          Fpt to perform a M$GDS operation.
      404     3807                                                                   */
      405     3808    1       GLOBAL.GDS$ = FPT$;
      406     3809    1       FPT$GDS = FPT_GDS;
      407     3810    1       FPT$GDS.V_ = VECTOR(FPT$GDS.V);
      408     3811    1       FPT$GDS.RESULTS_ = VECTOR(GLOBAL.VLP$->VLP$VECTOR);
      409     3812    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$GDS));
      410     3813        /*
      411     3814                          Fpt to perform a M$FDS operation.
      412     3815                                                                   */
      413     3816    1       GLOBAL.FDS$ = FPT$;
      414     3817    1       FPT$FDS = FPT_FDS;
      415     3818    1       FPT$FDS.V_ = VECTOR(FPT$FDS.V);
      416     3819    1       FPT$FDS.RESULTS_=VECTOR(GLOBAL.VLP$->VLP$VECTOR);
      417     3820    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$FDS));
      418     3821        /*
      419     3822                          Fpt to perform a M$ENQ operation.
      420     3823                                                                   */
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:13   
      421     3824    1       GLOBAL.ENQ$ = FPT$;
      422     3825    1       FPT$ENQ = FPT_ENQ;
      423     3826    1       FPT$ENQ.V_ = VECTOR(FPT$ENQ.V);
      424     3827    1       FPT$ENQ.RNAME_=VECTOR(GLOBAL.RNAME);
      425     3828    1       FPT$ENQ.V.NO_DOWNGRADE#=%YES#;
      426     3829    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$ENQ));
      427     3830        /*
      428     3831                       Fpt to perform a M$ENQ for SHANY
      429     3832                                                                 */
      430     3833    1       GLOBAL.ENQS$=FPT$;
      431     3834    1       FPT$ENQS=FPT_ENQ;
      432     3835    1       FPT$ENQS.V_=VECTOR(FPT$ENQS.V);
      433     3836    1       FPT$ENQS.RNAME_=VECTOR(SHALL);
      434     3837    1       FPT$ENQS.V.EVENT#=1;
      435     3838    1       FPT$ENQS.V.WAIT_TIME#=0;
      436     3839    1       FPT$=PINCRW(FPT$,SIZEW(FPT$ENQS));
      437     3840        /*
      438     3841                       FPT to perform an M$ENQ to coordinate indexed
      439     3842        */
      440     3843    1       GLOBAL.ENQI$=FPT$;
      441     3844    1       FPT$ENQI=FPT_ENQ;
      442     3845    1       FPT$ENQI.V_=VECTOR(FPT$ENQI.V);
      443     3846    1       FPT$ENQI.RNAME_=VECTOR(RINDEX);
      444     3847    1       FPT$ENQI.V.SHARE#=%NONE#;
      445     3848    1       FPT$=PINCRW(FPT$,SIZEW(FPT$ENQI));
      446     3849        /*
      447     3850              FPT TO PERFORM M$DEQ OF ONE PARTICULAR RESOURCE
      448     3851        */
      449     3852    1       GLOBAL.DEQ$=FPT$;
      450     3853    1       FPT$DEQ=FPT_DEQ;
      451     3854    1       FPT$DEQ.V_=VECTOR(FPT$DEQ.V);
      452     3855    1       FPT$DEQ.RNAME_=VECTOR(GLOBAL.RNAME);
      453     3856    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DEQ));
      454     3857        /*
      455     3858                       FPT to perform an M$DEQ to coordinate indexed
      456     3859        */
      457     3860    1       GLOBAL.DEQI$=FPT$;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:14   
      458     3861    1       FPT$DEQI=FPT_DEQ;
      459     3862    1       FPT$DEQI.V_=VECTOR(FPT$DEQI.V);
      460     3863    1       FPT$DEQI.RNAME_=VECTOR(RINDEX);
      461     3864    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DEQI));
      462     3865        /*
      463     3866                       FPT to deq all resources
      464     3867        */
      465     3868    1       GLOBAL.DEQALL$=FPT$;
      466     3869    1       FPT$DEQALL=FPT_DEQ;
      467     3870    1       FPT$DEQALL.V_=VECTOR(FPT$DEQALL.V);
      468     3871    1       FPT$DEQALL.V.SELECTIVE#=%YES#;
      469     3872    1       FPT$DEQALL.V.SELECT_ID#=0;
      470     3873    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DEQALL));
      471     3874        /*
      472     3875                          Fpt to perform a M$PFIL operation
      473     3876                                                                     */
      474     3877    1       GLOBAL.PFIL$=FPT$;
      475     3878    1       FPT$PFIL = FPT_PFIL;
      476     3879    1       FPT$PFIL.V_ = VECTOR(FPT$PFIL.V);
      477     3880    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$PFIL));
      478     3881        /*
      479     3882                    Fpt to perform an M$TIME
      480     3883        */
      481     3884    1       GLOBAL.TIME$=FPT$;
      482     3885    1       FPT$TIME=FPT_TIME;
      483     3886    1       FPT$TIME.V_=VECTOR(FPT$TIME.V);
      484     3887    1       FPT$TIME.TSTAMP_=VECTOR(GLOBAL.TIME.TSTAMP);
      485     3888    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TIME));
      486     3889        /*
      487     3890                    Fpt to convert UTS to EXTERNAL format
      488     3891        */
      489     3892    1       GLOBAL.TIMEC$=FPT$;
      490     3893    1       FPT$TIMEC=FPT_TIME;
      491     3894    1       FPT$TIMEC.V_=VECTOR(FPT$TIMEC.V);
      492     3895    1       FPT$TIMEC.TSTAMP_=VECTOR(GLOBAL.TIME.TSTAMP);
      493     3896    1       FPT$TIMEC.DATE_=VECTOR(GLOBAL.TIME.DATE);
      494     3897    1       FPT$TIMEC.TIME_=VECTOR(GLOBAL.TIME.TIME);
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:15   
      495     3898    1       FPT$TIMEC.DAY_=VECTOR(GLOBAL.TIME.DAY);
      496     3899    1       FPT$TIMEC.V.SOURCE#=%UTS#;
      497     3900    1       FPT$TIMEC.V.DEST#=%EXT#;
      498     3901    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TIMEC));
      499     3902        /*
      500     3903                    Fpt to truncate buffers
      501     3904        */
      502     3905    1       GLOBAL.TRUNC$=FPT$;
      503     3906    1       FPT$TRUNC=FPT_TRUNC;
      504     3907    1       FPT$TRUNC.V_=VECTOR(FPT$TRUNC.V);
      505     3908    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TRUNC));
      506     3909        /*
      507     3910                    Fpt to perform M$ERRMSG
      508     3911        */
      509     3912    1       GLOBAL.ERRMSG$=FPT$;
      510     3913    1       FPT$ERRMSG=FPT_ERRMSG;
      511     3914    1       FPT$ERRMSG.V_=VECTOR(FPT$ERRMSG.V);
      512     3915    1       FPT$ERRMSG.BUF_=VECTOR(GLOBAL.PRINTBUF);
      513     3916    1       FPT$ERRMSG.CODE_=VECTOR(GLOBAL.RET.SYSERR#);
      514     3917    1       FPT$ERRMSG.FIELD1_=VECTOR(GLOBAL.ERRFIELD_INSERT(0));
      515     3918    1       FPT$ERRMSG.FIELD2_=VECTOR(GLOBAL.ERRFIELD_INSERT(1));
      516     3919    1       FPT$ERRMSG.FIELD3_=VECTOR(GLOBAL.ERRFIELD_INSERT(2));
      517     3920    1       FPT$ERRMSG.V.OUTDCB1#=DCBNUM(M$DO);
      518     3921    1       FPT$=PINCRW(FPT$,SIZEW(FPT$ERRMSG));
      519     3922        /*
      520     3923                    Fpt to perform trap return
      521     3924        */
      522     3925    1       GLOBAL.TRTN$=FPT$;
      523     3926    1       FPT$TRTN=FPT_TRTN;
      524     3927    1       FPT$TRTN.V_=VECTOR(FPT$TRTN.V);
      525     3928    1       FPT$TRTN.V.IC#=ZIB$ICALT_REDEF.HW1;
      526     3929    1       FPT$TRTN.V.SETIR#=%YES#;
      527     3930    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TRTN));
      528     3931        /*
      529     3932                    Fpt to perform a snap
      530     3933        */
      531     3934    1       GLOBAL.SCREECH$=FPT$;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:16   
      532     3935    1       FPT$SCREECH=FPT_SCREECH;
      533     3936    1       FPT$SCREECH.JERR_=VECTOR(GLOBAL.RET.SYSERR#);
      534     3937    1       FPT$SCREECH.SCREECHID_=VECTOR(GLOBAL.FILENAME);
      535     3938    1       FPT$=PINCRW(FPT$,SIZEW(FPT$SCREECH));
      536     3939        /*
      537     3940                    FPT to perform a KEYIN
      538     3941        */
      539     3942    1       GLOBAL.KEYIN$=FPT$;
      540     3943    1       FPT$KEYIN=FPT_KEYIN;
      541     3944    1       FPT$KEYIN.V_=VECTOR(FPT$KEYIN.V);
      542     3945    1       FPT$KEYIN.MESS_=VECTOR(GLOBAL.PRINTBUF);
      543     3946    1       FPT$=PINCRW(FPT$,SIZEW(FPT$KEYIN));
      544     3947        /*
      545     3948                    Fpt to perform a monitor info call
      546     3949        */
      547     3950    1       GLOBAL.MONINFO$=FPT$;
      548     3951    1       FPT$MONINFO=FPT_MONINFO;
      549     3952    1       FPT$MONINFO.STYPE_=VECTOR(GLOBAL.STYPE);
      550     3953    1       FPT$=PINCRW(FPT$,SIZEW(FPT$MONINFO));
      551     3954        %EJECT;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:17   
      552     3955        /*
      553     3956            Move canned schema sub-set into global for schema file access.
      554     3957                                                                   */
      555     3958    1       SSS$CNTXT =SSS_CNTXT;
      556     3959    1       GLOBAL.CANSSS$ = FPT$; /* set pointer to schema sub-set in global */
      557     3960        /*       Point to last used word */
      558     3961    1       FPT$=PINCRW(FPT$,SIZEW(SSS$CNTXT)-1);
      559     3962        /*       Initialize the buffer pool */
      560     3963    1       GLOBAL.BCB.LASTP$=PINCRW(FPT$,-FPT.WORDS);
      561     3964        /*       COUNT and TAIL already ZERO */
      562     3965    1       GLOBAL.BCB.HEAD=1;
      563     3966    1       NEEDBUFS=BUF#MIN-(INIT#SPC/1024-1-FPT.PAGES);
      564     3967    1       IF NEEDBUFS>0 THEN
      565     3968    1           CALL ZIO$GETSEG(GLOBAL$,1024*NEEDBUFS) ALTRET(INIT_ERR);
      566     3969    1       CALL ZIO$ADDBUF(BUF#MIN);
      567     3970         /* Put queue stuff after last addr
      568     3971            in global */
      569     3972        /*          Init ENQ tables. */
      570     3973    1       GLOBAL.ENQ.LIST.BASE$=ADDR(NIL);
      571     3974    1       GLOBAL.ENQ.INDXMAP.BASE$=ADDR(NIL);
      572     3975    1       CALL ZID$STATS;
      573     3976        /*       Take exceptional condition control */
      574     3977    1       CALL M$INT(FPT_INT) ALTRET(INIT_ERR);
      575     3978    1       CALL M$XCON(FPT_XCON) ALTRET(INIT_ERR);
      576     3979    1       CALL M$EVENT(FPT_EVENT) ALTRET(INIT_ERR);
      577     3980    1       CALL M$TRAP(FPT_TRAP) ALTRET(INIT_ERR);
      578     3981    1       GLOBAL.DCBNAME.TEXT='TRACE';
      579     3982    1       GLOBAL.DCBNAME.LENGTH=5;
      580     3983    1       CALL ZIO$DFLTOPN('LO  ') ALTRET(NO_TRACE);
      581     3984    1       GLOBAL.PARAN.TRACE.DCB#=GLOBAL.DCBNUMBER;
      582     3985    2       DO J=1 TO 5; /* CHECK UOPT */
      583     3986    2           IF DCBADDR(GLOBAL.DCBNUMBER)->F$DCB.UOPT#(0) OR
      584     3987    2              DCBADDR(GLOBAL.DCBNUMBER)->F$DCB.UOPT#(J) THEN
      585     3988    2               GLOBAL.PARAN.TRACE.UOPT(J-1)=%YES#;
      586     3989    2           END;
      587     3990    1   NO_TRACE: ;
      588     3991    1       RETURN;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:18   
      589     3992        %EJECT;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:19   
      590     3993        /*  Can't perform initialization, give alternate return     */
      591     3994    1   INIT_ERR:
      592     3995    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      593     3996    1       ALTRETURN;
      594     3997    1   END ZIO$INIT;

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:20   
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIO$INIT.

   Procedure ZIO$INIT requires 830 words for executable code.
   Procedure ZIO$INIT requires 12 words of local(AUTO) storage.

    No errors detected in file ZIM$INIT.:ZIC0TSI    .

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:21   

 Object Unit name= ZIO$INIT                                   File name= ZIM$INIT.:ZIC0TOU
 UTS= SEP 05 '97 12:58:17.08 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$DO
    1  RoData even  UTS    391    607  ZIO$INIT
    2   DCB   even  none     0      0  M$UC
    3   Proc  even  none   830   1476  ZIO$INIT
    4  RoData even  none    31     37  ZIO$INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      XStd       0  ZIO$INIT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     10  FPT_WAIT                           1    470  FPT_ERR
    1    476  ZI_FPTCHKR                         1    477  ZI_FPTCHKR_DUMP
    1    500  ZI_TEST                            1    501  ZI_USER
    1    502  ZI_WAITIO                          1    503  ZI_TJNAME
    1    504  ZI_MAXKEY
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:22   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIB$ICALT
         yes          XAsync     0 ZIO$EVENT
         yes           XStd      0 ZID$STATS
 yes     yes           XStd      3 ZIO$GETSEG
 yes     yes           XStd      1 ZIO$DFLTOPN
         yes           XStd      0 ZIB$FIXPR5
         yes           XStd      1 ZIO$ADDBUF
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$TCB$                                M$DO                                  ZITSSSSIZ
     SSORG                            r    GLOBAL$                               M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:23   


        1        1        /*M* ZIO$INIT - 'CP-6 IDS/II' initialization.           */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        ZIO$INIT: PROC ALTRET

      7  3 000000   000000 700200 xent  ZIO$INIT     TSX0  ! X66_AUTO_0
         3 000001   000014 000000                    ZERO    12,0

        8        8         /* USE($PR5 FOR GLOBAL$) */
        9        9               AVOID($PR5,$PR6,$PR7,$X7);
       10       10    1   DCL B$TCB$ PTR SYMREF;
       11       11    1   DCL M$DO DCB;
       12       12    1   DCL FPT$ PTR;
       13       13    1   DCL 1 FPT REDEF FPT$,
       14       14    1         2 PAGES UBIN(8) UNAL,
       15       15    1         2 WORDS UBIN(10) UNAL,
       16       16    1         2 * UBIN(18) UNAL;
       17       17    1   DCL J SBIN;
       18       18    1   DCL NEEDBUFS SBIN;
       19       19    1   DCL ZITSSSSIZ SBIN SYMREF;
       20       20    1   DCL SSORG UBIN SYMREF;
       21       21    1   DCL SSORG$ CONSTANT PTR INIT( ADDR(SSORG) );
       22       22    1   DCL SSS_CNTXT CHAR(ZITSSSSIZ) BASED(SSORG$);
       23       23    1   DCL SSS$CNTXT CHAR(ZITSSSSIZ) BASED(FPT$);
       24       24    1   DCL ZIO$EVENT ENTRY ASYNC;
       25       25    1   DCL ZIB$FIXPR5 ENTRY;
       26       26    1   DCL ZIB$SEGSIZE ENTRY(2);
       27       27    1   DCL ZIO$GETSEG ENTRY (3) ALTRET;
       28       28    1   DCL ZIO$ADDBUF ENTRY(1);
       29       29    1   DCL ZID$STATS ENTRY;
       30       30    1   DCL ZIB$ICALT ENTRY;
       31       31    1   DCL ZIO$DFLTOPN ENTRY(1) ALTRET;
       32       32    1   DCL ZIB$ICALT_EPTR EPTR INIT(ENTADDR(ZIB$ICALT)) CONSTANT;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:24   
       33       33    1   DCL 1 ZIB$ICALT_REDEF REDEF ZIB$ICALT_EPTR,
       34       34    1         2 HW1 UBIN(18) UNAL,
       35       35    1         2 HW2 UBIN(18) UNAL;
       36       36    1   DCL SIZE UBIN(36);
       37       37    1   DCL 1 SEGMENT BASED,
       38       38    1         2 * CHAR(SIZE);
       39       39    1   DCL 1 SHALL CONSTANT,
       40       40    1         2 * UBIN(9) INIT(5) UNAL,
       41       41    1         2 * CHAR(5) INIT('SHALL');
       42       42    1   DCL 1 RINDEX CONSTANT,
       43       43    1         2 * UBIN(9) INIT(5) UNAL,
       44       44    1         2 * CHAR(5) INIT('INDEX');
       45       45        %INCLUDE ZI$GLOBAL;
       46      531        %GLOBALS;
       47      839        %BUFFERS;
       48      854        %SUB BUF#MIN=6; /* Minumum entries in buffer pool */
       49      855        %SUB INIT#SPC=10240; /* 6K Buffers.  4K Global */
       50      856        %INCLUDE CP_6_SUBS;
       51     1396        %INCLUDE CP_6;
       52     1477         %B$TCB;
       53     1480         %B$ALT;
       54     1488         %VLP_SCODE (FPTN=SC775, STCLASS=CONSTANT,
       55     1489         FCG='ZI', MID='M', MON=NO, CODE=775,
       56     1490         ASLSEG=YES, CFUS=YES, CUSR=YES, DDSEG=YES, ENQ=YES,
       57     1491         FMBUF=YES, ISEG=YES, ROSEG=YES, PPUT=YES);
       58     1552        %F$DCB;
       59     1609        %FPT_WAIT(STCLASS="CONSTANT SYMDEF",
       60     1610         UNITS=1);
       61     1624        %FPT_OPEN (STCLASS=CONSTANT,
       62     1625         XONLY=YES);
       63     1734        %FPT_GETDCB (STCLASS=CONSTANT);
       64     1749        %FPT_RELDCB (STCLASS=CONSTANT);
       65     1763        %FPT_READ(STCLASS=CONSTANT);
       66     1802        %FPT_WRITE(STCLASS=CONSTANT);
       67     1833         %FPT_PRECORD(STCLASS=CONSTANT);
       68     1854        %FPT_DELREC (STCLASS=CONSTANT);
       69     1873        %FPT_CLOSE (STCLASS=CONSTANT,
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:25   
       70     1874         REBLD=NO,
       71     1875         DISP=SAVE);
       72     1917        %FPT_CHECK (STCLASS=CONSTANT);
       73     1931        %FPT_GDS (STCLASS=CONSTANT);
       74     1947        %FPT_GDS (FPTN=FPT_GETGLBL,
       75     1948         STCLASS=CONSTANT,
       76     1949         SEGSIZE=INIT#SPC,
       77     1950         COMMON=YES);
       78     1966        %FPT_FDS (STCLASS=CONSTANT);
       79     1981        %FPT_ENQ(STCLASS=CONSTANT,
       80     1982         WAIT=YES);
       81     2000        %FPT_DEQ(STCLASS=CONSTANT,
       82     2001         RELRES=YES);
       83     2018        %FPT_EVENT (STCLASS=CONSTANT,
       84     2019         UENTRY=ZIO$EVENT);
       85     2033        %FPT_XCON (STCLASS=CONSTANT,
       86     2034         UENTRY=ZIO$EVENT);
       87     2048        %FPT_INT(STCLASS=CONSTANT,
       88     2049         UENTRY=ZIO$EVENT);
       89     2063        %FPT_TRAP(STCLASS=CONSTANT,
       90     2064         PROGRAMMED=ZIO$EVENT,
       91     2065         DERAIL=TRAP,
       92     2066         ERRORS=ZIO$EVENT,
       93     2067         SECURITY_1=TRAP,
       94     2068         MEMORY=TRAP,
       95     2069         IPR=TRAP,
       96     2070         MISSING_SEG=TRAP,
       97     2071         MISSING_PAGE=TRAP,
       98     2072         SECURITY_2=TRAP);
       99     2095        %FPT_TIME(STCLASS=CONSTANT,SOURCE=CLOCK,DEST=UTS);
      100     2114        %FPT_TRUNC(STCLASS=CONSTANT);
      101     2128        %FPT_PFIL (STCLASS=CONSTANT);
      102     2143        %FPT_ERRMSG(STCLASS=CONSTANT,
      103     2144         VFC='a',
      104     2145         TYC=YES);
      105     2172        %FPT_TRTN(STCLASS=CONSTANT);
      106     2189        %FPT_SCREECH(STCLASS=CONSTANT,SCODE=SC775);
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:26   
      107     2203        %VLP_VECTOR (STCLASS=CONSTANT);
      108     2218         %FPT_KEYIN(STCLASS=CONSTANT,OCTYPE=SYSTEM,WSN='LOCAL');
      109     2237         %FPT_MONINFO(STCLASS=CONSTANT);
      110     2252        %FPT_ERR(STCLASS="CONSTANT SYMDEF",STEPCC=ABORT);
      111     2267        %FPT_OPEN (FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
      112     2376        %FPT_OPEN (FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      113     2485        %FPT_OPEN (FPTN=FPT$OPNSCRB,STCLASS="BASED(FPT$)");
      114     2594        %FPT_OPEN(FPTN=FPT$REOPEN,STCLASS="BASED(FPT$)");
      115     2703        %FPT_GETDCB (FPTN=FPT$GETDCB,STCLASS="BASED(FPT$)");
      116     2718        %FPT_RELDCB (FPTN=FPT$RELDCB,STCLASS="BASED(FPT$)");
      117     2732        %FPT_READ (FPTN=FPT$READD,STCLASS="BASED(FPT$)");
      118     2771        %FPT_READ (FPTN=FPT$READI,STCLASS="BASED(FPT$)");
      119     2810        %FPT_READ (FPTN=FPT$READK,STCLASS="BASED(FPT$)");
      120     2849         %FPT_READ(FPTN=FPT$READJ,STCLASS="BASED(FPT$)");
      121     2888        %FPT_WRITE (FPTN=FPT$WRTD,STCLASS="BASED(FPT$)");
      122     2919        %FPT_WRITE (FPTN=FPT$WRTI,STCLASS="BASED(FPT$)");
      123     2950        %FPT_WRITE (FPTN=FPT$WRTK,STCLASS="BASED(FPT$)");
      124     2981        %FPT_WRITE(FPTN=FPT$WRITE,STCLASS="BASED(FPT$)");
      125     3012         %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(FPT$)");
      126     3043        %FPT_WRITE(FPTN=FPT$WRTC,STCLASS="BASED(FPT$)");
      127     3074        %FPT_PRECORD (FPTN=FPT$PREC,STCLASS="BASED(FPT$)");
      128     3095         %FPT_PRECORD(FPTN=FPT$PRECJ,STCLASS="BASED(FPT$)");
      129     3116         %FPT_PRECORD(FPTN=FPT$PRECI,STCLASS="BASED(FPT$)");
      130     3137        %FPT_DELREC (FPTN=FPT$DELR,STCLASS="BASED(FPT$)");
      131     3156         %FPT_DELREC(FPTN=FPT$DELI,STCLASS="BASED(FPT$)");
      132     3175        %FPT_CLOSE (FPTN=FPT$CLOSE,STCLASS="BASED(FPT$)");
      133     3217        %FPT_CHECK (FPTN=FPT$CHECK,STCLASS="BASED(FPT$)");
      134     3231        %FPT_GDS (FPTN=FPT$GDS,STCLASS="BASED(FPT$)");
      135     3247        %FPT_FDS (FPTN=FPT$FDS,STCLASS="BASED(FPT$)");
      136     3262        %FPT_ENQ (FPTN=FPT$ENQ,STCLASS="BASED(FPT$)");
      137     3280        %FPT_ENQ(FPTN=FPT$ENQS,STCLASS="BASED(FPT$)");
      138     3298        %FPT_ENQ(FPTN=FPT$ENQI,STCLASS="BASED(FPT$)");
      139     3316        %FPT_DEQ(FPTN=FPT$DEQ,STCLASS="BASED(FPT$)");
      140     3333        %FPT_DEQ(FPTN=FPT$DEQI,STCLASS="BASED(FPT$)");
      141     3350        %FPT_DEQ(FPTN=FPT$DEQALL,STCLASS="BASED(FPT$)");
      142     3367        %FPT_TIME(FPTN=FPT$TIME,STCLASS="BASED(FPT$)");
      143     3386        %FPT_TIME(FPTN=FPT$TIMEC,STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:27   
      144     3405        %FPT_TRUNC(FPTN=FPT$TRUNC,STCLASS="BASED(FPT$)");
      145     3419        %FPT_PFIL (FPTN=FPT$PFIL,STCLASS="BASED(FPT$)");
      146     3434        %FPT_ERRMSG(FPTN=FPT$ERRMSG,STCLASS="BASED(FPT$)");
      147     3461        %FPT_TRTN(FPTN=FPT$TRTN,STCLASS="BASED(FPT$)");
      148     3478        %FPT_SCREECH(FPTN=FPT$SCREECH,STCLASS="BASED(FPT$)");
      149     3492         %FPT_KEYIN(FPTN=FPT$KEYIN,STCLASS="BASED(FPT$)");
      150     3511         %FPT_MONINFO(FPTN=FPT$MONINFO,STCLASS="BASED(FPT$)");
      151     3526        %VLP_ALTKEYS(FPTN=VLP$ALTKEYS,N=21,STCLASS="BASED(FPT$)");
      152     3541        %VLP_VECTOR (FPTN=VLP$VECTOR,STCLASS="BASED");
      153     3556        /*       Declare all symdef'ed constant variables here */
      154     3557    1   DCL ZI_FPTCHKR BIT(1) CONSTANT SYMDEF INIT(%YES#);
      155     3558    1   DCL ZI_FPTCHKR_DUMP BIT(1) CONSTANT SYMDEF INIT(%NO#);
      156     3559    1   DCL ZI_TEST BIT(1) CONSTANT SYMDEF INIT(%NO#);
      157     3560    1   DCL ZI_USER BIT(1) CONSTANT SYMDEF INIT(%NO#);
      158     3561    1   DCL ZI_WAITIO BIT(1) CONSTANT SYMDEF INIT (%NO#);
      159     3562    1   DCL ZI_TJNAME CHAR(4) CONSTANT SYMDEF INIT('*I  ');
      160     3563    1   DCL ZI_MAXKEY(0:255) CHAR(1) UNAL CONSTANT SYMDEF INIT(BITASC('777'O) * 256);
      161     3564        %EJECT;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:28   
      162     3565        /*
      163     3566            Get space for global region.
      164     3567                                                                   */
      165     3568    1       CALL M$GDS(FPT_GETGLBL) ALTRET (INIT_ERR);

   3568  3 000002   000252 630400 1                  EPPR0   FPT_GETGLBL
         3 000003   430001 713400                    CLIMB   alt,gds
         3 000004   400400 401760                    pmme    nvectors=2
         3 000005   001470 702000 3                  TSX2    INIT_ERR

      166     3569    1       CALL ZIB$FIXPR5;

   3569  3 000006   000000 631400 4                  EPPR1   0
         3 000007   000000 701000 xent               TSX1    ZIB$FIXPR5
         3 000010   000000 011000                    NOP     0

      167     3570        /*
      168     3571            Initialize database information in the global region.
      169     3572                                                                   */
      170     3573    1       SIZE=INIT#SPC*4; /* Into bytes */

   3573  3 000011   120000 235007                    LDA     40960,DL
         3 000012   200006 755100                    STA     SIZE,,AUTO

      171     3574    1       GLOBAL$->SEGMENT='0'B;

   3574  3 000013   000000 470400 xsym               LDP0    GLOBAL$
         3 000014   000000 620005                    EAX0    0,AL
         3 000015   000140 100400                    MLR     fill='000'O
         3 000016   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000017   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      172     3575    2       DO J = 1 TO DB#MAX;

   3575  3 000020   000001 235007                    LDA     1,DL
         3 000021   200004 755100                    STA     J,,AUTO
         3 000022   000032 710000 3                  TRA     s:3578+1
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:29   

      173     3576    2           GLOBAL.DB.SSS$(J) = ADDR(NIL);

   3576  3 000023   000001 236000 4                  LDQ     1
         3 000024   000000 470400 xsym               LDP0    GLOBAL$
         3 000025   200004 720100                    LXL0    J,,AUTO
         3 000026   000153 756110                    STQ     107,X0,PR0

      174     3577    2           GLOBAL.DB.DBCB$(J) = ADDR(NIL);

   3577  3 000027   000001 236000 4                  LDQ     1
         3 000030   000161 756110                    STQ     113,X0,PR0

      175     3578    2           END;

   3578  3 000031   200004 054100                    AOS     J,,AUTO
         3 000032   200004 235100                    LDA     J,,AUTO
         3 000033   000005 115007                    CMPA    5,DL
         3 000034   000023 604400 3                  TMOZ    s:3576

      176     3579    1       GLOBAL.ACTIVE.SSS$=ADDR(NIL);

   3579  3 000035   000001 236000 4                  LDQ     1
         3 000036   000000 756100                    STQ     0,,PR0

      177     3580    1       GLOBAL.ACTIVE.DBCB$=ADDR(NIL);

   3580  3 000037   000001 236000 4                  LDQ     1
         3 000040   000001 756100                    STQ     1,,PR0

      178     3581    1       GLOBAL.RNAME.LENGTH=4;

   3581  3 000041   004000 236003                    LDQ     2048,DU
         3 000042   004776 552140                    STBQ    2558,'40'O,PR0

      179     3582    1       FPT$ = ADDR(GLOBAL.FPTBASE);

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:30   
   3582  3 000043   000000 236000 xsym               LDQ     GLOBAL$
         3 000044   005152 036003                    ADLQ    2666,DU
         3 000045   200003 756100                    STQ     FPT$,,AUTO

      180     3583        /*
      181     3584                 VLP area for alternate keys
      182     3585        */
      183     3586    1       GLOBAL.ALTKEYS$=FPT$;

   3586  3 000046   005134 756100                    STQ     2652,,PR0

      184     3587    1       VLP$ALTKEYS.SIZ#=0;

   3587  3 000047   200003 471500                    LDP1    FPT$,,AUTO
         3 000050   100000 450100                    STZ     0,,PR1

      185     3588    1       FPT$=PINCRW(FPT$,SIZEW(VLP$ALTKEYS));

   3588  3 000051   000026 036003                    ADLQ    22,DU
         3 000052   200003 756100                    STQ     FPT$,,AUTO

      186     3589        /*
      187     3590                          Fpt to perform an actual open.
      188     3591                                                                   */
      189     3592    1       GLOBAL.OPEN$ = FPT$;

   3592  3 000053   005066 756100                    STQ     2614,,PR0

      190     3593    1       FPT$OPEN = FPT_OPEN;

   3593  3 000054   200003 471500                    LDP1    FPT$,,AUTO
         3 000055   000100 100400                    MLR     fill='000'O
         3 000056   000016 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         3 000057   100000 000350                    ADSC9   0,,PR1                   cn=0,n=232

      191     3594    1       FPT$OPEN.V_ = VECTOR(FPT$OPEN.V);

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:31   
   3594  3 000060   000002 235000 4                  LDA     2
         3 000061   000044 036003                    ADLQ    36,DU
         3 000062   100000 757100                    STAQ    0,,PR1

      192     3595    1       FPT$OPEN.V.INITZ.REASSIGN#=%YES#;

   3595  3 000063   200000 236007                    LDQ     65536,DL
         3 000064   100044 256100                    ORSQ    36,,PR1

      193     3596    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$OPEN));

   3596  3 000065   200003 236100                    LDQ     FPT$,,AUTO
         3 000066   000072 036003                    ADLQ    58,DU
         3 000067   200003 756100                    STQ     FPT$,,AUTO

      194     3597        /*
      195     3598                          Fpt to perform an default open (setdcb=yes).
      196     3599                                                                   */
      197     3600    1       GLOBAL.OPNDFLT$ = FPT$;

   3600  3 000070   005067 756100                    STQ     2615,,PR0

      198     3601    1       FPT$OPNDFLT = FPT_OPEN;

   3601  3 000071   200003 471500                    LDP1    FPT$,,AUTO
         3 000072   000100 100400                    MLR     fill='000'O
         3 000073   000016 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         3 000074   100000 000350                    ADSC9   0,,PR1                   cn=0,n=232

      199     3602    1       FPT$OPNDFLT.V_ = VECTOR(FPT$OPNDFLT.V);

   3602  3 000075   000002 235000 4                  LDA     2
         3 000076   000044 036003                    ADLQ    36,DU
         3 000077   100000 757100                    STAQ    0,,PR1

      200     3603    1       FPT$OPNDFLT.NAME_=VECTOR(GLOBAL.FILENAME);

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:32   
   3603  3 000100   000003 235000 4                  LDA     3
         3 000101   000000 236000 xsym               LDQ     GLOBAL$
         3 000102   004724 036003                    ADLQ    2516,DU
         3 000103   100006 757100                    STAQ    6,,PR1

      201     3604    1       FPT$OPNDFLT.ACCT_=VECTOR(GLOBAL.ACCT);

   3604  3 000104   000004 235000 4                  LDA     4
         3 000105   000000 236000 xsym               LDQ     GLOBAL$
         3 000106   004744 036003                    ADLQ    2532,DU
         3 000107   100024 757100                    STAQ    20,,PR1

      202     3605    1       FPT$OPNDFLT.V.SETDCB# = %YES#;

   3605  3 000110   100000 236007                    LDQ     32768,DL
         3 000111   100044 256100                    ORSQ    36,,PR1

      203     3606    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$OPNDFLT));

   3606  3 000112   200003 236100                    LDQ     FPT$,,AUTO
         3 000113   000072 036003                    ADLQ    58,DU
         3 000114   200003 756100                    STQ     FPT$,,AUTO

      204     3607        /*
      205     3608                          Fpt to do a scrubed open
      206     3609                                                                     */
      207     3610    1       GLOBAL.OPNSCRB$=FPT$;

   3610  3 000115   005070 756100                    STQ     2616,,PR0

      208     3611    1       FPT$OPNSCRB=FPT_OPEN;

   3611  3 000116   200003 471500                    LDP1    FPT$,,AUTO
         3 000117   000100 100400                    MLR     fill='000'O
         3 000120   000016 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         3 000121   100000 000350                    ADSC9   0,,PR1                   cn=0,n=232

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:33   
      209     3612    1       FPT$OPNSCRB.V_=VECTOR(FPT$OPNSCRB.V);

   3612  3 000122   000002 235000 4                  LDA     2
         3 000123   000044 036003                    ADLQ    36,DU
         3 000124   100000 757100                    STAQ    0,,PR1

      210     3613    1       FPT$OPNSCRB.NAME_=VECTOR(GLOBAL.FILENAME);

   3613  3 000125   000003 235000 4                  LDA     3
         3 000126   000000 236000 xsym               LDQ     GLOBAL$
         3 000127   004724 036003                    ADLQ    2516,DU
         3 000130   100006 757100                    STAQ    6,,PR1

      211     3614    1       FPT$OPNSCRB.ACCT_=VECTOR(GLOBAL.ACCT);

   3614  3 000131   000004 235000 4                  LDA     4
         3 000132   000000 236000 xsym               LDQ     GLOBAL$
         3 000133   004744 036003                    ADLQ    2532,DU
         3 000134   100024 757100                    STAQ    20,,PR1

      212     3615    1       FPT$OPNSCRB.V.ASN#=%FILE#;

   3615  3 000135   000001 236007                    LDQ     1,DL
         3 000136   100045 552104                    STBQ    37,'04'O,PR1

      213     3616    1       FPT$OPNSCRB.V.INITZ.SCRUB#=%YES#;

   3616  3 000137   400000 236007                    LDQ     -131072,DL
         3 000140   100044 256100                    ORSQ    36,,PR1

      214     3617    1       FPT$=PINCRW(FPT$,SIZEW(FPT$OPNSCRB));

   3617  3 000141   200003 236100                    LDQ     FPT$,,AUTO
         3 000142   000072 036003                    ADLQ    58,DU
         3 000143   200003 756100                    STQ     FPT$,,AUTO

      215     3618        /*
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:34   
      216     3619                          Fpt to reopen a DCB without changing anything.
      217     3620                                                                     */
      218     3621    1       GLOBAL.REOPEN$=FPT$;

   3621  3 000144   005071 756100                    STQ     2617,,PR0

      219     3622    1       FPT$REOPEN=FPT_OPEN;

   3622  3 000145   200003 471500                    LDP1    FPT$,,AUTO
         3 000146   000100 100400                    MLR     fill='000'O
         3 000147   000016 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         3 000150   100000 000350                    ADSC9   0,,PR1                   cn=0,n=232

      220     3623    1       FPT$REOPEN.V_=VECTOR(FPT$REOPEN.V);

   3623  3 000151   000002 235000 4                  LDA     2
         3 000152   000044 036003                    ADLQ    36,DU
         3 000153   100000 757100                    STAQ    0,,PR1

      221     3624    1       FPT$=PINCRW(FPT$,SIZEW(FPT$REOPEN));

   3624  3 000154   200003 236100                    LDQ     FPT$,,AUTO
         3 000155   000072 036003                    ADLQ    58,DU
         3 000156   200003 756100                    STQ     FPT$,,AUTO

      222     3625        /*
      223     3626                          Fpt to perform a M$GETDCB operation.
      224     3627                                                                   */
      225     3628    1       GLOBAL.GETDCB$ = FPT$;

   3628  3 000157   005104 756100                    STQ     2628,,PR0

      226     3629    1       FPT$GETDCB = FPT_GETDCB;

   3629  3 000160   200003 471500                    LDP1    FPT$,,AUTO
         3 000161   000100 100400                    MLR     fill='000'O
         3 000162   000110 000040 1                  ADSC9   FPT_GETDCB               cn=0,n=32
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:35   
         3 000163   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      227     3630    1       FPT$GETDCB.V_ = VECTOR(FPT$GETDCB.V);

   3630  3 000164   000004 235000 4                  LDA     4
         3 000165   000006 036003                    ADLQ    6,DU
         3 000166   100000 757100                    STAQ    0,,PR1

      228     3631    1       FPT$GETDCB.DCBNAME_ = VECTOR(GLOBAL.DCBNAME);

   3631  3 000167   000003 235000 4                  LDA     3
         3 000170   000000 236000 xsym               LDQ     GLOBAL$
         3 000171   004734 036003                    ADLQ    2524,DU
         3 000172   100002 757100                    STAQ    2,,PR1

      229     3632    1       FPT$GETDCB.DCBNUM_ = VECTOR(GLOBAL.DCBNUMBER);

   3632  3 000173   777640 235007                    LDA     -96,DL
         3 000174   000000 236000 xsym               LDQ     GLOBAL$
         3 000175   004623 036003                    ADLQ    2451,DU
         3 000176   100004 757100                    STAQ    4,,PR1

      230     3633    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$GETDCB));

   3633  3 000177   200003 236100                    LDQ     FPT$,,AUTO
         3 000200   000010 036003                    ADLQ    8,DU
         3 000201   200003 756100                    STQ     FPT$,,AUTO

      231     3634        /*
      232     3635                          Fpt to perform a M$RELDCB operation.
      233     3636                                                                   */
      234     3637    1       GLOBAL.RELDCB$ = FPT$;

   3637  3 000202   005105 756100                    STQ     2629,,PR0

      235     3638    1       FPT$RELDCB = FPT_RELDCB;

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:36   
   3638  3 000203   200003 471500                    LDP1    FPT$,,AUTO
         3 000204   000100 100400                    MLR     fill='000'O
         3 000205   000120 000020 1                  ADSC9   FPT_RELDCB               cn=0,n=16
         3 000206   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16

      236     3639    1       FPT$RELDCB.V_ = VECTOR(FPT$RELDCB.V);

   3639  3 000207   000004 235000 4                  LDA     4
         3 000210   000002 036003                    ADLQ    2,DU
         3 000211   100000 757100                    STAQ    0,,PR1

      237     3640    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$RELDCB));

   3640  3 000212   200003 236100                    LDQ     FPT$,,AUTO
         3 000213   000004 036003                    ADLQ    4,DU
         3 000214   200003 756100                    STQ     FPT$,,AUTO

      238     3641        /*
      239     3642                          Fpt to read a data-base block (ids org).
      240     3643                                                                   */
      241     3644    1       GLOBAL.READD$ = FPT$;

   3644  3 000215   005073 756100                    STQ     2619,,PR0

      242     3645    1       FPT$READD = FPT_READ;

   3645  3 000216   200003 471500                    LDP1    FPT$,,AUTO
         3 000217   000100 100400                    MLR     fill='000'O
         3 000220   000124 000070 1                  ADSC9   FPT_READ                 cn=0,n=56
         3 000221   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

      243     3646    1       FPT$READD.V_ = VECTOR(FPT$READD.V);

   3646  3 000222   000005 235000 4                  LDA     5
         3 000223   000010 036003                    ADLQ    8,DU
         3 000224   100000 757100                    STAQ    0,,PR1

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:37   
      244     3647    1       FPT$READD.KEY_ = VECTOR(GLOBAL.GRANULE);

   3647  3 000225   777640 235007                    LDA     -96,DL
         3 000226   000000 236000 xsym               LDQ     GLOBAL$
         3 000227   004622 036003                    ADLQ    2450,DU
         3 000230   100002 757100                    STAQ    2,,PR1

      245     3648    1       FPT$READD.BUF_.BOUND = SIZEV(BLOCK);

   3648  3 000231   100004 236100                    LDQ     4,,PR1
         3 000232   177777 376007                    ANQ     65535,DL
         3 000233   000006 276000 4                  ORQ     6
         3 000234   100004 756100                    STQ     4,,PR1

      246     3649    1       FPT$READD.V.FULL#=%YES#;

   3649  3 000235   010000 236007                    LDQ     4096,DL
         3 000236   100010 256100                    ORSQ    8,,PR1

      247     3650    1       FPT$READD.V.KEYS#=%YES#;

   3650  3 000237   200000 236007                    LDQ     65536,DL
         3 000240   100010 256100                    ORSQ    8,,PR1

      248     3651    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$READD));

   3651  3 000241   200003 236100                    LDQ     FPT$,,AUTO
         3 000242   000016 036003                    ADLQ    14,DU
         3 000243   200003 756100                    STQ     FPT$,,AUTO

      249     3652        /*
      250     3653                          Fpt to write a data-base block (ids org).
      251     3654                                                                   */
      252     3655    1       GLOBAL.WRTD$ = FPT$;

   3655  3 000244   005074 756100                    STQ     2620,,PR0

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:38   
      253     3656    1       FPT$WRTD = FPT_WRITE;

   3656  3 000245   200003 471500                    LDP1    FPT$,,AUTO
         3 000246   000100 100400                    MLR     fill='000'O
         3 000247   000142 000060 1                  ADSC9   FPT_WRITE                cn=0,n=48
         3 000250   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      254     3657    1       FPT$WRTD.V_ = VECTOR(FPT$WRTD.V);

   3657  3 000251   000007 235000 4                  LDA     7
         3 000252   000010 036003                    ADLQ    8,DU
         3 000253   100000 757100                    STAQ    0,,PR1

      255     3658    1       FPT$WRTD.KEY_ = VECTOR(GLOBAL.GRANULE);

   3658  3 000254   777640 235007                    LDA     -96,DL
         3 000255   000000 236000 xsym               LDQ     GLOBAL$
         3 000256   004622 036003                    ADLQ    2450,DU
         3 000257   100002 757100                    STAQ    2,,PR1

      256     3659    1       FPT$WRTD.BUF_.BOUND = SIZEV(BLOCK);

   3659  3 000260   100004 236100                    LDQ     4,,PR1
         3 000261   177777 376007                    ANQ     65535,DL
         3 000262   000006 276000 4                  ORQ     6
         3 000263   100004 756100                    STQ     4,,PR1

      257     3660    1       IF ZI_WAITIO THEN

   3660  3 000264   000502 234000 1                  SZN     ZI_WAITIO
         3 000265   000271 605000 3                  TPL     s:3663

      258     3661    1           FPT$WRTD.V.WAIT# = %YES#;

   3661  3 000266   400000 236007                    LDQ     -131072,DL
         3 000267   100010 256100                    ORSQ    8,,PR1
         3 000270   000273 710000 3                  TRA     s:3664
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:39   

      259     3662    1       ELSE
      260     3663    1           FPT$WRTD.V.WAIT# = %NO#;

   3663  3 000271   000010 236000 4                  LDQ     8
         3 000272   100010 356100                    ANSQ    8,,PR1

      261     3664    1       FPT$WRTD.V.FULL#=%YES#;

   3664  3 000273   010000 236007                    LDQ     4096,DL
         3 000274   100010 256100                    ORSQ    8,,PR1

      262     3665    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$WRTD));

   3665  3 000275   200003 236100                    LDQ     FPT$,,AUTO
         3 000276   000014 036003                    ADLQ    12,DU
         3 000277   200003 756100                    STQ     FPT$,,AUTO

      263     3666        /*
      264     3667                          Fpt to read a data-base record (indexed org).
      265     3668                                                                   */
      266     3669        /* NOTE: For indexed keys there is no length but it is easier to
      267     3670                 manage them internaly if a length is used.  Therefore
      268     3671                 although a length is in GLOBAL.KEY.LENGTH  the vector
      269     3672                 skips over that byte.  DBACS builds the key descriptors
      270     3673                 using a one byte offset and that is why KEYPA is correct
      271     3674                 for INDEXED files also.
      272     3675        */
      273     3676    1       GLOBAL.READI$ = FPT$;

   3676  3 000300   005075 756100                    STQ     2621,,PR0

      274     3677    1       FPT$READI = FPT_READ;

   3677  3 000301   200003 471500                    LDP1    FPT$,,AUTO
         3 000302   000100 100400                    MLR     fill='000'O
         3 000303   000124 000070 1                  ADSC9   FPT_READ                 cn=0,n=56
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:40   
         3 000304   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

      275     3678    1       FPT$READI.V_ = VECTOR(FPT$READI.V);

   3678  3 000305   000005 235000 4                  LDA     5
         3 000306   000010 036003                    ADLQ    8,DU
         3 000307   100000 757100                    STAQ    0,,PR1

      276     3679    1       FPT$READI.STATION_=VECTOR(GLOBAL.KEYID);

   3679  3 000310   000004 235000 4                  LDA     4
         3 000311   000000 236000 xsym               LDQ     GLOBAL$
         3 000312   005011 036003                    ADLQ    2569,DU
         3 000313   100006 757100                    STAQ    6,,PR1

      277     3680    1       FPT$READI.KEY_=VECTOR(GLOBAL.KEY.VALUE);

   3680  3 000314   000011 235000 4                  LDA     9
         3 000315   000000 236000 xsym               LDQ     GLOBAL$
         3 000316   000012 036000 4                  ADLQ    10
         3 000317   100002 757100                    STAQ    2,,PR1

      278     3681    1       FPT$READI.V.ID#=%YES#;

   3681  3 000320   040000 236007                    LDQ     16384,DL
         3 000321   100010 256100                    ORSQ    8,,PR1

      279     3682    1       FPT$READI.V.IDS#=%YES#;

   3682  3 000322   004000 236007                    LDQ     2048,DL
         3 000323   100010 256100                    ORSQ    8,,PR1

      280     3683    1       FPT$READI.V.KEYS#=%YES#;

   3683  3 000324   200000 236007                    LDQ     65536,DL
         3 000325   100010 256100                    ORSQ    8,,PR1

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:41   
      281     3684    1       FPT$READI.V.KEYR#=%YES#;

   3684  3 000326   100000 236007                    LDQ     32768,DL
         3 000327   100010 256100                    ORSQ    8,,PR1

      282     3685    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$READI));

   3685  3 000330   200003 236100                    LDQ     FPT$,,AUTO
         3 000331   000016 036003                    ADLQ    14,DU
         3 000332   200003 756100                    STQ     FPT$,,AUTO

      283     3686        /*
      284     3687                          Fpt to write a data-base record (indexed org).
      285     3688                                                                   */
      286     3689    1       GLOBAL.WRTI$ = FPT$;

   3689  3 000333   005076 756100                    STQ     2622,,PR0

      287     3690    1       FPT$WRTI = FPT_WRITE;

   3690  3 000334   200003 471500                    LDP1    FPT$,,AUTO
         3 000335   000100 100400                    MLR     fill='000'O
         3 000336   000142 000060 1                  ADSC9   FPT_WRITE                cn=0,n=48
         3 000337   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      288     3691    1       FPT$WRTI.V_ = VECTOR(FPT$WRTI.V);

   3691  3 000340   000007 235000 4                  LDA     7
         3 000341   000010 036003                    ADLQ    8,DU
         3 000342   100000 757100                    STAQ    0,,PR1

      289     3692    1       FPT$WRTI.STATION_=VECTOR(GLOBAL.KEYID);

   3692  3 000343   000004 235000 4                  LDA     4
         3 000344   000000 236000 xsym               LDQ     GLOBAL$
         3 000345   005011 036003                    ADLQ    2569,DU
         3 000346   100006 757100                    STAQ    6,,PR1
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:42   

      290     3693    1       FPT$WRTI.V.ID#=%YES#;

   3693  3 000347   040000 236007                    LDQ     16384,DL
         3 000350   100010 256100                    ORSQ    8,,PR1

      291     3694    1       FPT$WRTI.V.NEWKEY#=%YES#;

   3694  3 000351   000200 236007                    LDQ     128,DL
         3 000352   100010 256100                    ORSQ    8,,PR1

      292     3695    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$WRTI));

   3695  3 000353   200003 236100                    LDQ     FPT$,,AUTO
         3 000354   000014 036003                    ADLQ    12,DU
         3 000355   200003 756100                    STQ     FPT$,,AUTO

      293     3696        /*
      294     3697                    FPT to position in an indexed file by index number
      295     3698        */
      296     3699    1       GLOBAL.PRECI$=FPT$;

   3699  3 000356   005131 756100                    STQ     2649,,PR0

      297     3700    1       FPT$PRECI=FPT_PRECORD;

   3700  3 000357   200003 471500                    LDP1    FPT$,,AUTO
         3 000360   000100 100400                    MLR     fill='000'O
         3 000361   000156 000050 1                  ADSC9   FPT_PRECORD              cn=0,n=40
         3 000362   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      298     3701    1       FPT$PRECI.V_=VECTOR(FPT$PRECI.V);

   3701  3 000363   000007 235000 4                  LDA     7
         3 000364   000006 036003                    ADLQ    6,DU
         3 000365   100000 757100                    STAQ    0,,PR1

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:43   
      299     3702    1       FPT$PRECI.KEY_=VECTOR(GLOBAL.KEY.VALUE);

   3702  3 000366   000011 235000 4                  LDA     9
         3 000367   000000 236000 xsym               LDQ     GLOBAL$
         3 000370   000012 036000 4                  ADLQ    10
         3 000371   100002 757100                    STAQ    2,,PR1

      300     3703    1       FPT$PRECI.IDBUF_=VECTOR(GLOBAL.KEYID);

   3703  3 000372   000004 235000 4                  LDA     4
         3 000373   000000 236000 xsym               LDQ     GLOBAL$
         3 000374   005011 036003                    ADLQ    2569,DU
         3 000375   100004 757100                    STAQ    4,,PR1

      301     3704    1       FPT$PRECI.V.ID#=%YES#;

   3704  3 000376   100000 236007                    LDQ     32768,DL
         3 000377   100006 256100                    ORSQ    6,,PR1

      302     3705    1       FPT$PRECI.V.KEYS#=%YES#;

   3705  3 000400   400000 236007                    LDQ     -131072,DL
         3 000401   100006 256100                    ORSQ    6,,PR1

      303     3706    1       FPT$PRECI.V.KEYR#=%YES#;

   3706  3 000402   200000 236007                    LDQ     65536,DL
         3 000403   100006 256100                    ORSQ    6,,PR1

      304     3707    1       FPT$=PINCRW(FPT$,SIZEW(FPT$PRECI));

   3707  3 000404   200003 236100                    LDQ     FPT$,,AUTO
         3 000405   000012 036003                    ADLQ    10,DU
         3 000406   200003 756100                    STQ     FPT$,,AUTO

      305     3708        /*
      306     3709                    FPT to delete an indexed record
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:44   
      307     3710        */
      308     3711    1       GLOBAL.DELI$=FPT$;

   3711  3 000407   005132 756100                    STQ     2650,,PR0

      309     3712    1       FPT$DELI=FPT_DELREC;

   3712  3 000410   200003 471500                    LDP1    FPT$,,AUTO
         3 000411   000100 100400                    MLR     fill='000'O
         3 000412   000170 000050 1                  ADSC9   FPT_DELREC               cn=0,n=40
         3 000413   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      310     3713    1       FPT$DELI.V_=VECTOR(FPT$DELI.V);

   3713  3 000414   000004 235000 4                  LDA     4
         3 000415   000010 036003                    ADLQ    8,DU
         3 000416   100000 757100                    STAQ    0,,PR1

      311     3714    1       FPT$DELI.KEY_=VECTOR(GLOBAL.KEY.VALUE);

   3714  3 000417   000011 235000 4                  LDA     9
         3 000420   000000 236000 xsym               LDQ     GLOBAL$
         3 000421   000012 036000 4                  ADLQ    10
         3 000422   100002 757100                    STAQ    2,,PR1

      312     3715    1       FPT$DELI.V.INDX#=1;

   3715  3 000423   000001 236007                    LDQ     1,DL
         3 000424   100010 552104                    STBQ    8,'04'O,PR1

      313     3716    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DELI));

   3716  3 000425   200003 236100                    LDQ     FPT$,,AUTO
         3 000426   000012 036003                    ADLQ    10,DU
         3 000427   200003 756100                    STQ     FPT$,,AUTO

      314     3717        /*
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:45   
      315     3718                       Fpt's for writing 'print' records.
      316     3719                                                                   */
      317     3720    1       GLOBAL.WRITE$=FPT$;

   3720  3 000430   005113 756100                    STQ     2635,,PR0

      318     3721    1       FPT$WRITE=FPT_WRITE;

   3721  3 000431   200003 471500                    LDP1    FPT$,,AUTO
         3 000432   000100 100400                    MLR     fill='000'O
         3 000433   000142 000060 1                  ADSC9   FPT_WRITE                cn=0,n=48
         3 000434   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      319     3722    1       FPT$WRITE.V_=VECTOR(FPT$WRITE.V);

   3722  3 000435   000007 235000 4                  LDA     7
         3 000436   000010 036003                    ADLQ    8,DU
         3 000437   100000 757100                    STAQ    0,,PR1

      320     3723    1       FPT$WRITE.BUF_=VECTOR(GLOBAL.PRINTBUF);

   3723  3 000440   000013 235000 4                  LDA     11
         3 000441   000000 236000 xsym               LDQ     GLOBAL$
         3 000442   005025 036003                    ADLQ    2581,DU
         3 000443   100004 757100                    STAQ    4,,PR1

      321     3724    1       FPT$WRITE.V.DVBYTE.VFC#=%YES#;

   3724  3 000444   100000 236003                    LDQ     32768,DU
         3 000445   100013 256100                    ORSQ    11,,PR1

      322     3725    1       FPT$=PINCRW(FPT$,SIZEW(FPT$WRITE));

   3725  3 000446   200003 236100                    LDQ     FPT$,,AUTO
         3 000447   000014 036003                    ADLQ    12,DU
         3 000450   200003 756100                    STQ     FPT$,,AUTO

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:46   
      323     3726        /*
      324     3727                    FPT for reading from a journal
      325     3728        */
      326     3729    1       GLOBAL.READJ$=FPT$;

   3729  3 000451   005116 756100                    STQ     2638,,PR0

      327     3730    1       FPT$READJ=FPT_READ;

   3730  3 000452   200003 471500                    LDP1    FPT$,,AUTO
         3 000453   000100 100400                    MLR     fill='000'O
         3 000454   000124 000070 1                  ADSC9   FPT_READ                 cn=0,n=56
         3 000455   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

      328     3731    1       FPT$READJ.V_=VECTOR(FPT$READJ.V);

   3731  3 000456   000005 235000 4                  LDA     5
         3 000457   000010 036003                    ADLQ    8,DU
         3 000460   100000 757100                    STAQ    0,,PR1

      329     3732    1       FPT$READJ.BUF_=VECTOR(GLOBAL.JRECORD);

   3732  3 000461   000014 235000 4                  LDA     12
         3 000462   000000 236000 xsym               LDQ     GLOBAL$
         3 000463   002622 036003                    ADLQ    1426,DU
         3 000464   100004 757100                    STAQ    4,,PR1

      330     3733    1       FPT$=PINCRW(FPT$,SIZEW(FPT$READJ));

   3733  3 000465   200003 236100                    LDQ     FPT$,,AUTO
         3 000466   000016 036003                    ADLQ    14,DU
         3 000467   200003 756100                    STQ     FPT$,,AUTO

      331     3734        /*
      332     3735                    FPT for writting a journal
      333     3736        */
      334     3737    1       GLOBAL.WRTJ$=FPT$;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:47   

   3737  3 000470   005115 756100                    STQ     2637,,PR0

      335     3738    1       FPT$WRTJ=FPT_WRITE;

   3738  3 000471   200003 471500                    LDP1    FPT$,,AUTO
         3 000472   000100 100400                    MLR     fill='000'O
         3 000473   000142 000060 1                  ADSC9   FPT_WRITE                cn=0,n=48
         3 000474   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      336     3739    1       FPT$WRTJ.V_=VECTOR(FPT$WRTJ.V);

   3739  3 000475   000007 235000 4                  LDA     7
         3 000476   000010 036003                    ADLQ    8,DU
         3 000477   100000 757100                    STAQ    0,,PR1

      337     3740    1       FPT$WRTJ.BUF_=VECTOR(GLOBAL.JRECORD);

   3740  3 000500   000014 235000 4                  LDA     12
         3 000501   000000 236000 xsym               LDQ     GLOBAL$
         3 000502   002622 036003                    ADLQ    1426,DU
         3 000503   100004 757100                    STAQ    4,,PR1

      338     3741    1       FPT$=PINCRW(FPT$,SIZEW(FPT$WRTJ));

   3741  3 000504   200003 236100                    LDQ     FPT$,,AUTO
         3 000505   000014 036003                    ADLQ    12,DU
         3 000506   200003 756100                    STQ     FPT$,,AUTO

      339     3742        /*
      340     3743                    FPT for position in a journal
      341     3744        */
      342     3745    1       GLOBAL.PRECJ$=FPT$;

   3745  3 000507   005124 756100                    STQ     2644,,PR0

      343     3746    1       FPT$PRECJ=FPT_PRECORD;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:48   

   3746  3 000510   200003 471500                    LDP1    FPT$,,AUTO
         3 000511   000100 100400                    MLR     fill='000'O
         3 000512   000156 000050 1                  ADSC9   FPT_PRECORD              cn=0,n=40
         3 000513   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      344     3747    1       FPT$PRECJ.V_=VECTOR(FPT$PRECJ.V);

   3747  3 000514   000007 235000 4                  LDA     7
         3 000515   000006 036003                    ADLQ    6,DU
         3 000516   100000 757100                    STAQ    0,,PR1

      345     3748    1       FPT$PRECJ.V.N#=-1;

   3748  3 000517   000001 335007                    LCA     1,DL
         3 000520   100007 755100                    STA     7,,PR1

      346     3749    1       FPT$=PINCRW(FPT$,SIZEW(FPT$PRECJ));

   3749  3 000521   200003 236100                    LDQ     FPT$,,AUTO
         3 000522   000012 036003                    ADLQ    10,DU
         3 000523   200003 756100                    STQ     FPT$,,AUTO

      347     3750        /*
      348     3751                          Fpt to read from a keyed file (keyed org).
      349     3752                                                                   */
      350     3753    1       GLOBAL.READK$ = FPT$;

   3753  3 000524   005077 756100                    STQ     2623,,PR0

      351     3754    1       FPT$READK = FPT_READ;

   3754  3 000525   200003 471500                    LDP1    FPT$,,AUTO
         3 000526   000100 100400                    MLR     fill='000'O
         3 000527   000124 000070 1                  ADSC9   FPT_READ                 cn=0,n=56
         3 000530   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:49   
      352     3755    1       FPT$READK.V_ = VECTOR(FPT$READK.V);

   3755  3 000531   000005 235000 4                  LDA     5
         3 000532   000010 036003                    ADLQ    8,DU
         3 000533   100000 757100                    STAQ    0,,PR1

      353     3756    1       FPT$READK.KEY_ = VECTOR(GLOBAL.KEY);

   3756  3 000534   000015 235000 4                  LDA     13
         3 000535   000000 236000 xsym               LDQ     GLOBAL$
         3 000536   004624 036003                    ADLQ    2452,DU
         3 000537   100002 757100                    STAQ    2,,PR1

      354     3757    1       FPT$READK.V.KEYS#=%YES#;

   3757  3 000540   200000 236007                    LDQ     65536,DL
         3 000541   100010 256100                    ORSQ    8,,PR1

      355     3758    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$READK));

   3758  3 000542   200003 236100                    LDQ     FPT$,,AUTO
         3 000543   000016 036003                    ADLQ    14,DU
         3 000544   200003 756100                    STQ     FPT$,,AUTO

      356     3759        /*
      357     3760                          Fpt for writing to a keyed file (keyed org).     *
      358     3761                                                                   */
      359     3762    1       GLOBAL.WRTK$ = FPT$;

   3762  3 000545   005100 756100                    STQ     2624,,PR0

      360     3763    1       FPT$WRTK = FPT_WRITE;

   3763  3 000546   200003 471500                    LDP1    FPT$,,AUTO
         3 000547   000100 100400                    MLR     fill='000'O
         3 000550   000142 000060 1                  ADSC9   FPT_WRITE                cn=0,n=48
         3 000551   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:50   

      361     3764    1       FPT$WRTK.V_ = VECTOR(FPT$WRTK.V);

   3764  3 000552   000007 235000 4                  LDA     7
         3 000553   000010 036003                    ADLQ    8,DU
         3 000554   100000 757100                    STAQ    0,,PR1

      362     3765    1       FPT$WRTK.KEY_ = VECTOR(GLOBAL.KEY);

   3765  3 000555   000015 235000 4                  LDA     13
         3 000556   000000 236000 xsym               LDQ     GLOBAL$
         3 000557   004624 036003                    ADLQ    2452,DU
         3 000560   100002 757100                    STAQ    2,,PR1

      363     3766    1       FPT$WRTK.V.NEWKEY#=%YES#;

   3766  3 000561   000200 236007                    LDQ     128,DL
         3 000562   100010 256100                    ORSQ    8,,PR1

      364     3767    1       FPT$WRTK.V.ONEWKEY#=%NO#;

   3767  3 000563   000016 236000 4                  LDQ     14
         3 000564   100010 356100                    ANSQ    8,,PR1

      365     3768    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$WRTK));

   3768  3 000565   200003 236100                    LDQ     FPT$,,AUTO
         3 000566   000014 036003                    ADLQ    12,DU
         3 000567   200003 756100                    STQ     FPT$,,AUTO

      366     3769        /*
      367     3770                         Fpt to position a keyed file
      368     3771                                                              */
      369     3772    1       GLOBAL.PREC$=FPT$;

   3772  3 000570   005102 756100                    STQ     2626,,PR0

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:51   
      370     3773    1       FPT$PREC=FPT_PRECORD;

   3773  3 000571   200003 471500                    LDP1    FPT$,,AUTO
         3 000572   000100 100400                    MLR     fill='000'O
         3 000573   000156 000050 1                  ADSC9   FPT_PRECORD              cn=0,n=40
         3 000574   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      371     3774    1       FPT$PREC.V_=VECTOR(FPT$PREC.V);

   3774  3 000575   000007 235000 4                  LDA     7
         3 000576   000006 036003                    ADLQ    6,DU
         3 000577   100000 757100                    STAQ    0,,PR1

      372     3775    1       FPT$PREC.KEY_=VECTOR(GLOBAL.SKEY);

   3775  3 000600   000015 235000 4                  LDA     13
         3 000601   000000 236000 xsym               LDQ     GLOBAL$
         3 000602   004624 036003                    ADLQ    2452,DU
         3 000603   100002 757100                    STAQ    2,,PR1

      373     3776    1       FPT$PREC.V.KEYS#=%YES#;

   3776  3 000604   400000 236007                    LDQ     -131072,DL
         3 000605   100006 256100                    ORSQ    6,,PR1

      374     3777    1       FPT$PREC.V.KEYR#=%YES#;

   3777  3 000606   200000 236007                    LDQ     65536,DL
         3 000607   100006 256100                    ORSQ    6,,PR1

      375     3778    1       FPT$=PINCRW(FPT$,SIZEW(FPT$PREC));

   3778  3 000610   200003 236100                    LDQ     FPT$,,AUTO
         3 000611   000012 036003                    ADLQ    10,DU
         3 000612   200003 756100                    STQ     FPT$,,AUTO

      376     3779        /*
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:52   
      377     3780                         Fpt to delete a record in a keyed file
      378     3781                                                                */
      379     3782    1       GLOBAL.DELR$=FPT$;

   3782  3 000613   005101 756100                    STQ     2625,,PR0

      380     3783    1       FPT$DELR=FPT_DELREC;

   3783  3 000614   200003 471500                    LDP1    FPT$,,AUTO
         3 000615   000100 100400                    MLR     fill='000'O
         3 000616   000170 000050 1                  ADSC9   FPT_DELREC               cn=0,n=40
         3 000617   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      381     3784    1       FPT$DELR.V_=VECTOR(FPT$DELR.V);

   3784  3 000620   000004 235000 4                  LDA     4
         3 000621   000010 036003                    ADLQ    8,DU
         3 000622   100000 757100                    STAQ    0,,PR1

      382     3785    1       FPT$DELR.KEY_=VECTOR(GLOBAL.SKEY);

   3785  3 000623   000015 235000 4                  LDA     13
         3 000624   000000 236000 xsym               LDQ     GLOBAL$
         3 000625   004624 036003                    ADLQ    2452,DU
         3 000626   100002 757100                    STAQ    2,,PR1

      383     3786    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DELR));

   3786  3 000627   200003 236100                    LDQ     FPT$,,AUTO
         3 000630   000012 036003                    ADLQ    10,DU
         3 000631   200003 756100                    STQ     FPT$,,AUTO

      384     3787        /*
      385     3788                          Fpt to perform a M$CLOSE operation.
      386     3789                                                                   */
      387     3790    1       GLOBAL.CLOSE$ = FPT$;

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:53   
   3790  3 000632   005072 756100                    STQ     2618,,PR0

      388     3791    1       FPT$CLOSE = FPT_CLOSE;

   3791  3 000633   200003 471500                    LDP1    FPT$,,AUTO
         3 000634   000100 100400                    MLR     fill='000'O
         3 000635   000202 000170 1                  ADSC9   FPT_CLOSE                cn=0,n=120
         3 000636   100000 000170                    ADSC9   0,,PR1                   cn=0,n=120

      389     3792    1       FPT$CLOSE.V_ = VECTOR(FPT$CLOSE.V);

   3792  3 000637   000007 235000 4                  LDA     7
         3 000640   000032 036003                    ADLQ    26,DU
         3 000641   100000 757100                    STAQ    0,,PR1

      390     3793    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$CLOSE));

   3793  3 000642   200003 236100                    LDQ     FPT$,,AUTO
         3 000643   000036 036003                    ADLQ    30,DU
         3 000644   200003 756100                    STQ     FPT$,,AUTO

      391     3794        /*
      392     3795                          Vector location pointer (results from M$GDS, M$FDS calls).
      393     3796                                                                   */
      394     3797    1       GLOBAL.CHECK$ = FPT$;

   3797  3 000645   005103 756100                    STQ     2627,,PR0

      395     3798    1       FPT$CHECK = FPT_CHECK;

   3798  3 000646   200003 471500                    LDP1    FPT$,,AUTO
         3 000647   000100 100400                    MLR     fill='000'O
         3 000650   000240 000020 1                  ADSC9   FPT_CHECK                cn=0,n=16
         3 000651   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16

      396     3799    1       FPT$CHECK.V_ = VECTOR(FPT$CHECK.V);

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:54   
   3799  3 000652   000004 235000 4                  LDA     4
         3 000653   000002 036003                    ADLQ    2,DU
         3 000654   100000 757100                    STAQ    0,,PR1

      397     3800        /*
      398     3801                          Fpt to perform an actual open.
      399     3802                                                                   */
      400     3803    1       GLOBAL.VLP$ = PINCRW(FPT$,SIZEW(FPT$CHECK));

   3803  3 000655   200003 236100                    LDQ     FPT$,,AUTO
         3 000656   000004 036003                    ADLQ    4,DU
         3 000657   005112 756100                    STQ     2634,,PR0

      401     3804    1       FPT$ = PINCRW(GLOBAL.VLP$,SIZEW(VLP$VECTOR));

   3804  3 000660   000002 036003                    ADLQ    2,DU
         3 000661   200003 756100                    STQ     FPT$,,AUTO

      402     3805        /*
      403     3806                          Fpt to perform a M$GDS operation.
      404     3807                                                                   */
      405     3808    1       GLOBAL.GDS$ = FPT$;

   3808  3 000662   005106 756100                    STQ     2630,,PR0

      406     3809    1       FPT$GDS = FPT_GDS;

   3809  3 000663   200003 471500                    LDP1    FPT$,,AUTO
         3 000664   000100 100400                    MLR     fill='000'O
         3 000665   000244 000030 1                  ADSC9   FPT_GDS                  cn=0,n=24
         3 000666   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24

      407     3810    1       FPT$GDS.V_ = VECTOR(FPT$GDS.V);

   3810  3 000667   000004 235000 4                  LDA     4
         3 000670   000004 036003                    ADLQ    4,DU
         3 000671   100000 757100                    STAQ    0,,PR1
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:55   

      408     3811    1       FPT$GDS.RESULTS_ = VECTOR(GLOBAL.VLP$->VLP$VECTOR);

   3811  3 000672   005112 473500                    LDP3    2634,,PR0
         3 000673   000004 235000 4                  LDA     4
         3 000674   200010 453500                    STP3    SIZE+2,,AUTO
         3 000675   200010 236100                    LDQ     SIZE+2,,AUTO
         3 000676   100002 757100                    STAQ    2,,PR1

      409     3812    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$GDS));

   3812  3 000677   200003 236100                    LDQ     FPT$,,AUTO
         3 000700   000006 036003                    ADLQ    6,DU
         3 000701   200003 756100                    STQ     FPT$,,AUTO

      410     3813        /*
      411     3814                          Fpt to perform a M$FDS operation.
      412     3815                                                                   */
      413     3816    1       GLOBAL.FDS$ = FPT$;

   3816  3 000702   005107 756100                    STQ     2631,,PR0

      414     3817    1       FPT$FDS = FPT_FDS;

   3817  3 000703   200003 471500                    LDP1    FPT$,,AUTO
         3 000704   000100 100400                    MLR     fill='000'O
         3 000705   000260 000030 1                  ADSC9   FPT_FDS                  cn=0,n=24
         3 000706   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24

      415     3818    1       FPT$FDS.V_ = VECTOR(FPT$FDS.V);

   3818  3 000707   000004 235000 4                  LDA     4
         3 000710   000004 036003                    ADLQ    4,DU
         3 000711   100000 757100                    STAQ    0,,PR1

      416     3819    1       FPT$FDS.RESULTS_=VECTOR(GLOBAL.VLP$->VLP$VECTOR);

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:56   
   3819  3 000712   005112 473500                    LDP3    2634,,PR0
         3 000713   000004 235000 4                  LDA     4
         3 000714   200010 453500                    STP3    SIZE+2,,AUTO
         3 000715   200010 236100                    LDQ     SIZE+2,,AUTO
         3 000716   100002 757100                    STAQ    2,,PR1

      417     3820    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$FDS));

   3820  3 000717   200003 236100                    LDQ     FPT$,,AUTO
         3 000720   000006 036003                    ADLQ    6,DU
         3 000721   200003 756100                    STQ     FPT$,,AUTO

      418     3821        /*
      419     3822                          Fpt to perform a M$ENQ operation.
      420     3823                                                                   */
      421     3824    1       GLOBAL.ENQ$ = FPT$;

   3824  3 000722   005110 756100                    STQ     2632,,PR0

      422     3825    1       FPT$ENQ = FPT_ENQ;

   3825  3 000723   200003 471500                    LDP1    FPT$,,AUTO
         3 000724   000100 100400                    MLR     fill='000'O
         3 000725   000266 000050 1                  ADSC9   FPT_ENQ                  cn=0,n=40
         3 000726   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      423     3826    1       FPT$ENQ.V_ = VECTOR(FPT$ENQ.V);

   3826  3 000727   000007 235000 4                  LDA     7
         3 000730   000006 036003                    ADLQ    6,DU
         3 000731   100000 757100                    STAQ    0,,PR1

      424     3827    1       FPT$ENQ.RNAME_=VECTOR(GLOBAL.RNAME);

   3827  3 000732   000004 235000 4                  LDA     4
         3 000733   000000 236000 xsym               LDQ     GLOBAL$
         3 000734   004776 036003                    ADLQ    2558,DU
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:57   
         3 000735   100002 757100                    STAQ    2,,PR1

      425     3828    1       FPT$ENQ.V.NO_DOWNGRADE#=%YES#;

   3828  3 000736   200000 236007                    LDQ     65536,DL
         3 000737   100006 256100                    ORSQ    6,,PR1

      426     3829    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$ENQ));

   3829  3 000740   200003 236100                    LDQ     FPT$,,AUTO
         3 000741   000012 036003                    ADLQ    10,DU
         3 000742   200003 756100                    STQ     FPT$,,AUTO

      427     3830        /*
      428     3831                       Fpt to perform a M$ENQ for SHANY
      429     3832                                                                 */
      430     3833    1       GLOBAL.ENQS$=FPT$;

   3833  3 000743   005123 756100                    STQ     2643,,PR0

      431     3834    1       FPT$ENQS=FPT_ENQ;

   3834  3 000744   200003 471500                    LDP1    FPT$,,AUTO
         3 000745   000100 100400                    MLR     fill='000'O
         3 000746   000266 000050 1                  ADSC9   FPT_ENQ                  cn=0,n=40
         3 000747   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      432     3835    1       FPT$ENQS.V_=VECTOR(FPT$ENQS.V);

   3835  3 000750   000007 235000 4                  LDA     7
         3 000751   000006 036003                    ADLQ    6,DU
         3 000752   100000 757100                    STAQ    0,,PR1

      433     3836    1       FPT$ENQS.RNAME_=VECTOR(SHALL);

   3836  3 000753   000020 237000 4                  LDAQ    16
         3 000754   100002 757100                    STAQ    2,,PR1
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:58   

      434     3837    1       FPT$ENQS.V.EVENT#=1;

   3837  3 000755   000001 235007                    LDA     1,DL
         3 000756   100010 755100                    STA     8,,PR1

      435     3838    1       FPT$ENQS.V.WAIT_TIME#=0;

   3838  3 000757   100007 450100                    STZ     7,,PR1

      436     3839    1       FPT$=PINCRW(FPT$,SIZEW(FPT$ENQS));

   3839  3 000760   200003 236100                    LDQ     FPT$,,AUTO
         3 000761   000012 036003                    ADLQ    10,DU
         3 000762   200003 756100                    STQ     FPT$,,AUTO

      437     3840        /*
      438     3841                       FPT to perform an M$ENQ to coordinate indexed
      439     3842        */
      440     3843    1       GLOBAL.ENQI$=FPT$;

   3843  3 000763   005136 756100                    STQ     2654,,PR0

      441     3844    1       FPT$ENQI=FPT_ENQ;

   3844  3 000764   200003 471500                    LDP1    FPT$,,AUTO
         3 000765   000100 100400                    MLR     fill='000'O
         3 000766   000266 000050 1                  ADSC9   FPT_ENQ                  cn=0,n=40
         3 000767   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      442     3845    1       FPT$ENQI.V_=VECTOR(FPT$ENQI.V);

   3845  3 000770   000007 235000 4                  LDA     7
         3 000771   000006 036003                    ADLQ    6,DU
         3 000772   100000 757100                    STAQ    0,,PR1

      443     3846    1       FPT$ENQI.RNAME_=VECTOR(RINDEX);
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:59   

   3846  3 000773   000022 237000 4                  LDAQ    18
         3 000774   100002 757100                    STAQ    2,,PR1

      444     3847    1       FPT$ENQI.V.SHARE#=%NONE#;

   3847  3 000775   140000 236007                    LDQ     49152,DL
         3 000776   100006 256100                    ORSQ    6,,PR1

      445     3848    1       FPT$=PINCRW(FPT$,SIZEW(FPT$ENQI));

   3848  3 000777   200003 236100                    LDQ     FPT$,,AUTO
         3 001000   000012 036003                    ADLQ    10,DU
         3 001001   200003 756100                    STQ     FPT$,,AUTO

      446     3849        /*
      447     3850              FPT TO PERFORM M$DEQ OF ONE PARTICULAR RESOURCE
      448     3851        */
      449     3852    1       GLOBAL.DEQ$=FPT$;

   3852  3 001002   005137 756100                    STQ     2655,,PR0

      450     3853    1       FPT$DEQ=FPT_DEQ;

   3853  3 001003   200003 471500                    LDP1    FPT$,,AUTO
         3 001004   000100 100400                    MLR     fill='000'O
         3 001005   000300 000040 1                  ADSC9   FPT_DEQ                  cn=0,n=32
         3 001006   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      451     3854    1       FPT$DEQ.V_=VECTOR(FPT$DEQ.V);

   3854  3 001007   000004 235000 4                  LDA     4
         3 001010   000006 036003                    ADLQ    6,DU
         3 001011   100000 757100                    STAQ    0,,PR1

      452     3855    1       FPT$DEQ.RNAME_=VECTOR(GLOBAL.RNAME);

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:60   
   3855  3 001012   000004 235000 4                  LDA     4
         3 001013   000000 236000 xsym               LDQ     GLOBAL$
         3 001014   004776 036003                    ADLQ    2558,DU
         3 001015   100002 757100                    STAQ    2,,PR1

      453     3856    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DEQ));

   3856  3 001016   200003 236100                    LDQ     FPT$,,AUTO
         3 001017   000010 036003                    ADLQ    8,DU
         3 001020   200003 756100                    STQ     FPT$,,AUTO

      454     3857        /*
      455     3858                       FPT to perform an M$DEQ to coordinate indexed
      456     3859        */
      457     3860    1       GLOBAL.DEQI$=FPT$;

   3860  3 001021   005135 756100                    STQ     2653,,PR0

      458     3861    1       FPT$DEQI=FPT_DEQ;

   3861  3 001022   200003 471500                    LDP1    FPT$,,AUTO
         3 001023   000100 100400                    MLR     fill='000'O
         3 001024   000300 000040 1                  ADSC9   FPT_DEQ                  cn=0,n=32
         3 001025   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      459     3862    1       FPT$DEQI.V_=VECTOR(FPT$DEQI.V);

   3862  3 001026   000004 235000 4                  LDA     4
         3 001027   000006 036003                    ADLQ    6,DU
         3 001030   100000 757100                    STAQ    0,,PR1

      460     3863    1       FPT$DEQI.RNAME_=VECTOR(RINDEX);

   3863  3 001031   000022 237000 4                  LDAQ    18
         3 001032   100002 757100                    STAQ    2,,PR1

      461     3864    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DEQI));
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:61   

   3864  3 001033   200003 236100                    LDQ     FPT$,,AUTO
         3 001034   000010 036003                    ADLQ    8,DU
         3 001035   200003 756100                    STQ     FPT$,,AUTO

      462     3865        /*
      463     3866                       FPT to deq all resources
      464     3867        */
      465     3868    1       GLOBAL.DEQALL$=FPT$;

   3868  3 001036   005111 756100                    STQ     2633,,PR0

      466     3869    1       FPT$DEQALL=FPT_DEQ;

   3869  3 001037   200003 471500                    LDP1    FPT$,,AUTO
         3 001040   000100 100400                    MLR     fill='000'O
         3 001041   000300 000040 1                  ADSC9   FPT_DEQ                  cn=0,n=32
         3 001042   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      467     3870    1       FPT$DEQALL.V_=VECTOR(FPT$DEQALL.V);

   3870  3 001043   000004 235000 4                  LDA     4
         3 001044   000006 036003                    ADLQ    6,DU
         3 001045   100000 757100                    STAQ    0,,PR1

      468     3871    1       FPT$DEQALL.V.SELECTIVE#=%YES#;

   3871  3 001046   100000 236007                    LDQ     32768,DL
         3 001047   100006 256100                    ORSQ    6,,PR1

      469     3872    1       FPT$DEQALL.V.SELECT_ID#=0;

   3872  3 001050   000000 220003                    LDX0    0,DU
         3 001051   100007 740100                    STX0    7,,PR1

      470     3873    1       FPT$=PINCRW(FPT$,SIZEW(FPT$DEQALL));

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:62   
   3873  3 001052   200003 236100                    LDQ     FPT$,,AUTO
         3 001053   000010 036003                    ADLQ    8,DU
         3 001054   200003 756100                    STQ     FPT$,,AUTO

      471     3874        /*
      472     3875                          Fpt to perform a M$PFIL operation
      473     3876                                                                     */
      474     3877    1       GLOBAL.PFIL$=FPT$;

   3877  3 001055   005114 756100                    STQ     2636,,PR0

      475     3878    1       FPT$PFIL = FPT_PFIL;

   3878  3 001056   200003 471500                    LDP1    FPT$,,AUTO
         3 001057   000100 100400                    MLR     fill='000'O
         3 001060   000360 000020 1                  ADSC9   FPT_PFIL                 cn=0,n=16
         3 001061   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16

      476     3879    1       FPT$PFIL.V_ = VECTOR(FPT$PFIL.V);

   3879  3 001062   000004 235000 4                  LDA     4
         3 001063   000002 036003                    ADLQ    2,DU
         3 001064   100000 757100                    STAQ    0,,PR1

      477     3880    1       FPT$ = PINCRW(FPT$,SIZEW(FPT$PFIL));

   3880  3 001065   200003 236100                    LDQ     FPT$,,AUTO
         3 001066   000004 036003                    ADLQ    4,DU
         3 001067   200003 756100                    STQ     FPT$,,AUTO

      478     3881        /*
      479     3882                    Fpt to perform an M$TIME
      480     3883        */
      481     3884    1       GLOBAL.TIME$=FPT$;

   3884  3 001070   005117 756100                    STQ     2639,,PR0

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:63   
      482     3885    1       FPT$TIME=FPT_TIME;

   3885  3 001071   200003 471500                    LDP1    FPT$,,AUTO
         3 001072   000100 100400                    MLR     fill='000'O
         3 001073   000340 000060 1                  ADSC9   FPT_TIME                 cn=0,n=48
         3 001074   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      483     3886    1       FPT$TIME.V_=VECTOR(FPT$TIME.V);

   3886  3 001075   000004 235000 4                  LDA     4
         3 001076   000012 036003                    ADLQ    10,DU
         3 001077   100000 757100                    STAQ    0,,PR1

      484     3887    1       FPT$TIME.TSTAMP_=VECTOR(GLOBAL.TIME.TSTAMP);

   3887  3 001100   777640 235007                    LDA     -96,DL
         3 001101   000000 236000 xsym               LDQ     GLOBAL$
         3 001102   005001 036003                    ADLQ    2561,DU
         3 001103   100010 757100                    STAQ    8,,PR1

      485     3888    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TIME));

   3888  3 001104   200003 236100                    LDQ     FPT$,,AUTO
         3 001105   000014 036003                    ADLQ    12,DU
         3 001106   200003 756100                    STQ     FPT$,,AUTO

      486     3889        /*
      487     3890                    Fpt to convert UTS to EXTERNAL format
      488     3891        */
      489     3892    1       GLOBAL.TIMEC$=FPT$;

   3892  3 001107   005120 756100                    STQ     2640,,PR0

      490     3893    1       FPT$TIMEC=FPT_TIME;

   3893  3 001110   200003 471500                    LDP1    FPT$,,AUTO
         3 001111   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:64   
         3 001112   000340 000060 1                  ADSC9   FPT_TIME                 cn=0,n=48
         3 001113   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      491     3894    1       FPT$TIMEC.V_=VECTOR(FPT$TIMEC.V);

   3894  3 001114   000004 235000 4                  LDA     4
         3 001115   000012 036003                    ADLQ    10,DU
         3 001116   100000 757100                    STAQ    0,,PR1

      492     3895    1       FPT$TIMEC.TSTAMP_=VECTOR(GLOBAL.TIME.TSTAMP);

   3895  3 001117   777640 235007                    LDA     -96,DL
         3 001120   000000 236000 xsym               LDQ     GLOBAL$
         3 001121   005001 036003                    ADLQ    2561,DU
         3 001122   100010 757100                    STAQ    8,,PR1

      493     3896    1       FPT$TIMEC.DATE_=VECTOR(GLOBAL.TIME.DATE);

   3896  3 001123   000017 235000 4                  LDA     15
         3 001124   000000 236000 xsym               LDQ     GLOBAL$
         3 001125   005002 036003                    ADLQ    2562,DU
         3 001126   100002 757100                    STAQ    2,,PR1

      494     3897    1       FPT$TIMEC.TIME_=VECTOR(GLOBAL.TIME.TIME);

   3897  3 001127   000024 235000 4                  LDA     20
         3 001130   000000 236000 xsym               LDQ     GLOBAL$
         3 001131   000025 036000 4                  ADLQ    21
         3 001132   100004 757100                    STAQ    4,,PR1

      495     3898    1       FPT$TIMEC.DAY_=VECTOR(GLOBAL.TIME.DAY);

   3898  3 001133   577640 235007                    LDA     -65632,DL
         3 001134   000000 236000 xsym               LDQ     GLOBAL$
         3 001135   000026 036000 4                  ADLQ    22
         3 001136   100006 757100                    STAQ    6,,PR1

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:65   
      496     3899    1       FPT$TIMEC.V.SOURCE#=%UTS#;

   3899  3 001137   004000 236003                    LDQ     2048,DU
         3 001140   100012 552140                    STBQ    10,'40'O,PR1

      497     3900    1       FPT$TIMEC.V.DEST#=%EXT#;

   3900  3 001141   000001 236003                    LDQ     1,DU
         3 001142   100012 552120                    STBQ    10,'20'O,PR1

      498     3901    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TIMEC));

   3901  3 001143   200003 236100                    LDQ     FPT$,,AUTO
         3 001144   000014 036003                    ADLQ    12,DU
         3 001145   200003 756100                    STQ     FPT$,,AUTO

      499     3902        /*
      500     3903                    Fpt to truncate buffers
      501     3904        */
      502     3905    1       GLOBAL.TRUNC$=FPT$;

   3905  3 001146   005121 756100                    STQ     2641,,PR0

      503     3906    1       FPT$TRUNC=FPT_TRUNC;

   3906  3 001147   200003 471500                    LDP1    FPT$,,AUTO
         3 001150   000100 100400                    MLR     fill='000'O
         3 001151   000354 000020 1                  ADSC9   FPT_TRUNC                cn=0,n=16
         3 001152   100000 000020                    ADSC9   0,,PR1                   cn=0,n=16

      504     3907    1       FPT$TRUNC.V_=VECTOR(FPT$TRUNC.V);

   3907  3 001153   000004 235000 4                  LDA     4
         3 001154   000002 036003                    ADLQ    2,DU
         3 001155   100000 757100                    STAQ    0,,PR1

      505     3908    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TRUNC));
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:66   

   3908  3 001156   200003 236100                    LDQ     FPT$,,AUTO
         3 001157   000004 036003                    ADLQ    4,DU
         3 001160   200003 756100                    STQ     FPT$,,AUTO

      506     3909        /*
      507     3910                    Fpt to perform M$ERRMSG
      508     3911        */
      509     3912    1       GLOBAL.ERRMSG$=FPT$;

   3912  3 001161   005122 756100                    STQ     2642,,PR0

      510     3913    1       FPT$ERRMSG=FPT_ERRMSG;

   3913  3 001162   200003 471500                    LDP1    FPT$,,AUTO
         3 001163   000100 100400                    MLR     fill='000'O
         3 001164   000364 000150 1                  ADSC9   FPT_ERRMSG               cn=0,n=104
         3 001165   100000 000150                    ADSC9   0,,PR1                   cn=0,n=104

      511     3914    1       FPT$ERRMSG.V_=VECTOR(FPT$ERRMSG.V);

   3914  3 001166   000007 235000 4                  LDA     7
         3 001167   000026 036003                    ADLQ    22,DU
         3 001170   100000 757100                    STAQ    0,,PR1

      512     3915    1       FPT$ERRMSG.BUF_=VECTOR(GLOBAL.PRINTBUF);

   3915  3 001171   000013 235000 4                  LDA     11
         3 001172   000000 236000 xsym               LDQ     GLOBAL$
         3 001173   005025 036003                    ADLQ    2581,DU
         3 001174   100004 757100                    STAQ    4,,PR1

      513     3916    1       FPT$ERRMSG.CODE_=VECTOR(GLOBAL.RET.SYSERR#);

   3916  3 001175   777640 235007                    LDA     -96,DL
         3 001176   000000 236000 xsym               LDQ     GLOBAL$
         3 001177   000007 036003                    ADLQ    7,DU
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:67   
         3 001200   100002 757100                    STAQ    2,,PR1

      514     3917    1       FPT$ERRMSG.FIELD1_=VECTOR(GLOBAL.ERRFIELD_INSERT(0));

   3917  3 001201   000003 235000 4                  LDA     3
         3 001202   000000 236000 xsym               LDQ     GLOBAL$
         3 001203   004746 036003                    ADLQ    2534,DU
         3 001204   100014 757100                    STAQ    12,,PR1

      515     3918    1       FPT$ERRMSG.FIELD2_=VECTOR(GLOBAL.ERRFIELD_INSERT(1));

   3918  3 001205   000003 235000 4                  LDA     3
         3 001206   000000 236000 xsym               LDQ     GLOBAL$
         3 001207   004756 036003                    ADLQ    2542,DU
         3 001210   100016 757100                    STAQ    14,,PR1

      516     3919    1       FPT$ERRMSG.FIELD3_=VECTOR(GLOBAL.ERRFIELD_INSERT(2));

   3919  3 001211   000003 235000 4                  LDA     3
         3 001212   000000 236000 xsym               LDQ     GLOBAL$
         3 001213   004766 036003                    ADLQ    2550,DU
         3 001214   100020 757100                    STAQ    16,,PR1

      517     3920    1       FPT$ERRMSG.V.OUTDCB1#=DCBNUM(M$DO);

   3920  3 001215   000000 236007 xsym               LDQ     M$DO,DL
         3 001216   000000 621006                    EAX1    0,QL
         3 001217   100026 441100                    SXL1    22,,PR1

      518     3921    1       FPT$=PINCRW(FPT$,SIZEW(FPT$ERRMSG));

   3921  3 001220   200003 236100                    LDQ     FPT$,,AUTO
         3 001221   000032 036003                    ADLQ    26,DU
         3 001222   200003 756100                    STQ     FPT$,,AUTO

      519     3922        /*
      520     3923                    Fpt to perform trap return
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:68   
      521     3924        */
      522     3925    1       GLOBAL.TRTN$=FPT$;

   3925  3 001223   005127 756100                    STQ     2647,,PR0

      523     3926    1       FPT$TRTN=FPT_TRTN;

   3926  3 001224   200003 471500                    LDP1    FPT$,,AUTO
         3 001225   000100 100400                    MLR     fill='000'O
         3 001226   000416 000040 1                  ADSC9   FPT_TRTN                 cn=0,n=32
         3 001227   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      524     3927    1       FPT$TRTN.V_=VECTOR(FPT$TRTN.V);

   3927  3 001230   000004 235000 4                  LDA     4
         3 001231   000006 036003                    ADLQ    6,DU
         3 001232   100004 757100                    STAQ    4,,PR1

      525     3928    1       FPT$TRTN.V.IC#=ZIB$ICALT_REDEF.HW1;

   3928  3 001233   000001 221000 1                  LDX1    ZIB$ICALT_EPTR
         3 001234   100006 741100                    STX1    6,,PR1

      526     3929    1       FPT$TRTN.V.SETIR#=%YES#;

   3929  3 001235   400000 236003                    LDQ     -131072,DU
         3 001236   100007 256100                    ORSQ    7,,PR1

      527     3930    1       FPT$=PINCRW(FPT$,SIZEW(FPT$TRTN));

   3930  3 001237   200003 236100                    LDQ     FPT$,,AUTO
         3 001240   000010 036003                    ADLQ    8,DU
         3 001241   200003 756100                    STQ     FPT$,,AUTO

      528     3931        /*
      529     3932                    Fpt to perform a snap
      530     3933        */
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:69   
      531     3934    1       GLOBAL.SCREECH$=FPT$;

   3934  3 001242   005130 756100                    STQ     2648,,PR0

      532     3935    1       FPT$SCREECH=FPT_SCREECH;

   3935  3 001243   200003 471500                    LDP1    FPT$,,AUTO
         3 001244   000100 100400                    MLR     fill='000'O
         3 001245   000426 000030 1                  ADSC9   FPT_SCREECH              cn=0,n=24
         3 001246   100000 000030                    ADSC9   0,,PR1                   cn=0,n=24

      533     3936    1       FPT$SCREECH.JERR_=VECTOR(GLOBAL.RET.SYSERR#);

   3936  3 001247   777640 235007                    LDA     -96,DL
         3 001250   000000 236000 xsym               LDQ     GLOBAL$
         3 001251   000007 036003                    ADLQ    7,DU
         3 001252   100002 757100                    STAQ    2,,PR1

      534     3937    1       FPT$SCREECH.SCREECHID_=VECTOR(GLOBAL.FILENAME);

   3937  3 001253   000003 235000 4                  LDA     3
         3 001254   000000 236000 xsym               LDQ     GLOBAL$
         3 001255   004724 036003                    ADLQ    2516,DU
         3 001256   100004 757100                    STAQ    4,,PR1

      535     3938    1       FPT$=PINCRW(FPT$,SIZEW(FPT$SCREECH));

   3938  3 001257   200003 236100                    LDQ     FPT$,,AUTO
         3 001260   000006 036003                    ADLQ    6,DU
         3 001261   200003 756100                    STQ     FPT$,,AUTO

      536     3939        /*
      537     3940                    FPT to perform a KEYIN
      538     3941        */
      539     3942    1       GLOBAL.KEYIN$=FPT$;

   3942  3 001262   005125 756100                    STQ     2645,,PR0
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:70   

      540     3943    1       FPT$KEYIN=FPT_KEYIN;

   3943  3 001263   200003 471500                    LDP1    FPT$,,AUTO
         3 001264   000100 100400                    MLR     fill='000'O
         3 001265   000436 000070 1                  ADSC9   FPT_KEYIN                cn=0,n=56
         3 001266   100000 000070                    ADSC9   0,,PR1                   cn=0,n=56

      541     3944    1       FPT$KEYIN.V_=VECTOR(FPT$KEYIN.V);

   3944  3 001267   000005 235000 4                  LDA     5
         3 001270   000010 036003                    ADLQ    8,DU
         3 001271   100000 757100                    STAQ    0,,PR1

      542     3945    1       FPT$KEYIN.MESS_=VECTOR(GLOBAL.PRINTBUF);

   3945  3 001272   000013 235000 4                  LDA     11
         3 001273   000000 236000 xsym               LDQ     GLOBAL$
         3 001274   005025 036003                    ADLQ    2581,DU
         3 001275   100002 757100                    STAQ    2,,PR1

      543     3946    1       FPT$=PINCRW(FPT$,SIZEW(FPT$KEYIN));

   3946  3 001276   200003 236100                    LDQ     FPT$,,AUTO
         3 001277   000016 036003                    ADLQ    14,DU
         3 001300   200003 756100                    STQ     FPT$,,AUTO

      544     3947        /*
      545     3948                    Fpt to perform a monitor info call
      546     3949        */
      547     3950    1       GLOBAL.MONINFO$=FPT$;

   3950  3 001301   005126 756100                    STQ     2646,,PR0

      548     3951    1       FPT$MONINFO=FPT_MONINFO;

   3951  3 001302   200003 471500                    LDP1    FPT$,,AUTO
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:71   
         3 001303   000100 100400                    MLR     fill='000'O
         3 001304   000454 000060 1                  ADSC9   FPT_MONINFO              cn=0,n=48
         3 001305   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      549     3952    1       FPT$MONINFO.STYPE_=VECTOR(GLOBAL.STYPE);

   3952  3 001306   777640 235007                    LDA     -96,DL
         3 001307   000000 236000 xsym               LDQ     GLOBAL$
         3 001310   005010 036003                    ADLQ    2568,DU
         3 001311   100010 757100                    STAQ    8,,PR1

      550     3953    1       FPT$=PINCRW(FPT$,SIZEW(FPT$MONINFO));

   3953  3 001312   200003 236100                    LDQ     FPT$,,AUTO
         3 001313   000014 036003                    ADLQ    12,DU
         3 001314   200003 756100                    STQ     FPT$,,AUTO

      551     3954        %EJECT;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:72   
      552     3955        /*
      553     3956            Move canned schema sub-set into global for schema file access.
      554     3957                                                                   */
      555     3958    1       SSS$CNTXT =SSS_CNTXT;

   3958  3 001315   000000 471400 1                  LDP1    SSORG$
         3 001316   000000 722000 xsym               LXL2    ZITSSSSIZ
         3 001317   200003 473500                    LDP3    FPT$,,AUTO
         3 001320   040140 100540                    MLR     fill='040'O
         3 001321   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
         3 001322   300000 000012                    ADSC9   0,,PR3                   cn=0,n=*X2

      556     3959    1       GLOBAL.CANSSS$ = FPT$; /* set pointer to schema sub-set in global */

   3959  3 001323   000003 756100                    STQ     3,,PR0

      557     3960        /*       Point to last used word */
      558     3961    1       FPT$=PINCRW(FPT$,SIZEW(SSS$CNTXT)-1);

   3961  3 001324   000000 236000 xsym               LDQ     ZITSSSSIZ
         3 001325   000011 402007                    MPY     9,DL
         3 001326   000043 036007                    ADLQ    35,DL
         3 001327   000044 506007                    DIV     36,DL
         3 001330   000022 736000                    QLS     18
         3 001331   000001 136003                    SBLQ    1,DU
         3 001332   200003 036100                    ADLQ    FPT$,,AUTO
         3 001333   200003 756100                    STQ     FPT$,,AUTO

      559     3962        /*       Initialize the buffer pool */
      560     3963    1       GLOBAL.BCB.LASTP$=PINCRW(FPT$,-FPT.WORDS);

   3963  3 001334   200003 222100                    LDX2    FPT$,,AUTO
         3 001335   001777 362003                    ANX2    1023,DU
         3 001336   777777 636012                    EAQ     -1,X2
         3 001337   777777 676003                    ERQ     -1,DU
         3 001340   200003 036100                    ADLQ    FPT$,,AUTO
         3 001341   000201 756100                    STQ     129,,PR0
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:73   

      561     3964        /*       COUNT and TAIL already ZERO */
      562     3965    1       GLOBAL.BCB.HEAD=1;

   3965  3 001342   000001 235007                    LDA     1,DL
         3 001343   000175 755100                    STA     125,,PR0

      563     3966    1       NEEDBUFS=BUF#MIN-(INIT#SPC/1024-1-FPT.PAGES);

   3966  3 001344   200003 236100                    LDQ     FPT$,,AUTO
         3 001345   000034 772000                    QRL     28
         3 001346   000003 136007                    SBLQ    3,DL
         3 001347   200005 756100                    STQ     NEEDBUFS,,AUTO

      564     3967    1       IF NEEDBUFS>0 THEN

   3967  3 001350   001364 604400 3                  TMOZ    s:3969

      565     3968    1           CALL ZIO$GETSEG(GLOBAL$,1024*NEEDBUFS) ALTRET(INIT_ERR);

   3968  3 001351   200005 235100                    LDA     NEEDBUFS,,AUTO
         3 001352   000012 735000                    ALS     10
         3 001353   200010 755100                    STA     SIZE+2,,AUTO
         3 001354   200010 633500                    EPPR3   SIZE+2,,AUTO
         3 001355   200013 453500                    STP3    SIZE+5,,AUTO
         3 001356   000030 236000 4                  LDQ     24
         3 001357   200012 756100                    STQ     SIZE+4,,AUTO
         3 001360   200012 630500                    EPPR0   SIZE+4,,AUTO
         3 001361   000027 631400 4                  EPPR1   23
         3 001362   000000 701000 xent               TSX1    ZIO$GETSEG
         3 001363   001470 702000 3                  TSX2    INIT_ERR

      566     3969    1       CALL ZIO$ADDBUF(BUF#MIN);

   3969  3 001364   000033 630400 4                  EPPR0   27
         3 001365   000031 631400 4                  EPPR1   25
         3 001366   000000 701000 xent               TSX1    ZIO$ADDBUF
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:74   
         3 001367   000000 011000                    NOP     0

      567     3970         /* Put queue stuff after last addr
      568     3971            in global */
      569     3972        /*          Init ENQ tables. */
      570     3973    1       GLOBAL.ENQ.LIST.BASE$=ADDR(NIL);

   3973  3 001370   000001 236000 4                  LDQ     1
         3 001371   000000 470400 xsym               LDP0    GLOBAL$
         3 001372   001411 756100                    STQ     777,,PR0

      571     3974    1       GLOBAL.ENQ.INDXMAP.BASE$=ADDR(NIL);

   3974  3 001373   001415 756100                    STQ     781,,PR0

      572     3975    1       CALL ZID$STATS;

   3975  3 001374   000000 631400 4                  EPPR1   0
         3 001375   000000 701000 xent               TSX1    ZID$STATS
         3 001376   000000 011000                    NOP     0

      573     3976        /*       Take exceptional condition control */
      574     3977    1       CALL M$INT(FPT_INT) ALTRET(INIT_ERR);

   3977  3 001377   000322 630400 1                  EPPR0   FPT_INT
         3 001400   410002 713400                    CLIMB   alt,+4098
         3 001401   400000 401760                    pmme    nvectors=1
         3 001402   001470 702000 3                  TSX2    INIT_ERR

      575     3978    1       CALL M$XCON(FPT_XCON) ALTRET(INIT_ERR);

   3978  3 001403   000314 630400 1                  EPPR0   FPT_XCON
         3 001404   410003 713400                    CLIMB   alt,+4099
         3 001405   400400 401760                    pmme    nvectors=2
         3 001406   001470 702000 3                  TSX2    INIT_ERR

      576     3979    1       CALL M$EVENT(FPT_EVENT) ALTRET(INIT_ERR);
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:75   

   3979  3 001407   000310 630400 1                  EPPR0   FPT_EVENT
         3 001410   410001 713400                    CLIMB   alt,+4097
         3 001411   400000 401760                    pmme    nvectors=1
         3 001412   001470 702000 3                  TSX2    INIT_ERR

      577     3980    1       CALL M$TRAP(FPT_TRAP) ALTRET(INIT_ERR);

   3980  3 001413   000326 630400 1                  EPPR0   FPT_TRAP
         3 001414   410004 713400                    CLIMB   alt,+4100
         3 001415   400400 401760                    pmme    nvectors=2
         3 001416   001470 702000 3                  TSX2    INIT_ERR

      578     3981    1       GLOBAL.DCBNAME.TEXT='TRACE';

   3981  3 001417   000000 470400 xsym               LDP0    GLOBAL$
         3 001420   040100 100400                    MLR     fill='040'O
         3 001421   000604 000005 1                  ADSC9   ZI_MAXKEY+64             cn=0,n=5
         3 001422   004734 200037                    ADSC9   2524,,PR0                cn=1,n=31

      579     3982    1       GLOBAL.DCBNAME.LENGTH=5;

   3982  3 001423   005000 236003                    LDQ     2560,DU
         3 001424   004734 552140                    STBQ    2524,'40'O,PR0

      580     3983    1       CALL ZIO$DFLTOPN('LO  ') ALTRET(NO_TRACE);

   3983  3 001425   000034 630400 4                  EPPR0   28
         3 001426   000031 631400 4                  EPPR1   25
         3 001427   000000 701000 xent               TSX1    ZIO$DFLTOPN
         3 001430   001467 702000 3                  TSX2    NO_TRACE

      581     3984    1       GLOBAL.PARAN.TRACE.DCB#=GLOBAL.DCBNUMBER;

   3984  3 001431   000000 470400 xsym               LDP0    GLOBAL$
         3 001432   004623 235100                    LDA     2451,,PR0
         3 001433   000045 755100                    STA     37,,PR0
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:76   

      582     3985    2       DO J=1 TO 5; /* CHECK UOPT */

   3985  3 001434   000001 236007                    LDQ     1,DL
         3 001435   200004 756100                    STQ     J,,AUTO

      583     3986    2           IF DCBADDR(GLOBAL.DCBNUMBER)->F$DCB.UOPT#(0) OR

   3986  3 001436   000035 470400 4                  LDP0    29
         3 001437   000000 471500                    LDP1    0,,PR0
         3 001440   000000 473400 xsym               LDP3    GLOBAL$
         3 001441   304623 720100                    LXL0    2451,,PR3
         3 001442   100000 474510                    LDP4    0,X0,PR1
         3 001443   400031 236100                    LDQ     25,,PR4
         3 001444   000400 316003                    CANQ    256,DU
         3 001445   001455 601000 3                  TNZ     s:3988
         3 001446   200004 235100                    LDA     J,,AUTO
         3 001447   001451 605000 3                  TPL     s:3986+11
         3 001450   000044 035003                    ADLA    36,DU
         3 001451   000000 066505                    CMPB    filb='0'B
         3 001452   400031 200001                    BDSC    25,A,PR4                 by=1,bit=0,n=1
         3 001453   000000 000022 4                  BDSC    0                        by=0,bit=0,n=18
         3 001454   001463 600000 3                  TZE     s:3989

      584     3987    2              DCBADDR(GLOBAL.DCBNUMBER)->F$DCB.UOPT#(J) THEN
      585     3988    2               GLOBAL.PARAN.TRACE.UOPT(J-1)=%YES#;

   3988  3 001455   200004 235100                    LDA     J,,AUTO
         3 001456   001460 605000 3                  TPL     s:3988+3
         3 001457   000044 035003                    ADLA    36,DU
         3 001460   003105 060400                    CSL     bolr='003'O
         3 001461   000036 000001 4                  BDSC    30                       by=0,bit=0,n=1
         3 001462   300060 700001                    BDSC    48,A,PR3                 by=3,bit=8,n=1

      586     3989    2           END;

   3989  3 001463   200004 054100                    AOS     J,,AUTO
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:77   
         3 001464   200004 235100                    LDA     J,,AUTO
         3 001465   000005 115007                    CMPA    5,DL
         3 001466   001436 604400 3                  TMOZ    s:3986

      587     3990    1   NO_TRACE: ;

   3990  3 001467                       NO_TRACE     null
      588     3991    1       RETURN;

   3991  3 001467   000000 702200 xent               TSX2  ! X66_ARET

      589     3992        %EJECT;
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:78   
      590     3993        /*  Can't perform initialization, give alternate return     */
      591     3994    1   INIT_ERR:
      592     3995    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3995  3 001470   000000 470400 xsym  INIT_ERR     LDP0    B$TCB$
         3 001471   000000 471500                    LDP1    0,,PR0
         3 001472   100102 236100                    LDQ     66,,PR1
         3 001473   000000 473400 xsym               LDP3    GLOBAL$
         3 001474   300007 756100                    STQ     7,,PR3

      593     3996    1       ALTRETURN;

   3996  3 001475   000000 702200 xent               TSX2  ! X66_AALT

SSORG$
 Sect OctLoc
   1     000   000000 006000                                                    ....

ZIB$ICALT_EPTR
 Sect OctLoc
   1     001   000000 000000                                                    ....

SHALL
 Sect OctLoc
   1     002   005123 110101   114114 ******                                    .SHALL..

RINDEX
 Sect OctLoc
   1     004   005111 116104   105130 ******                                    .INDEX..

SC775
 Sect OctLoc
   1     006   321115 014075   240400 103640                                    .M.=..C.

FPT_WAIT
 Sect OctLoc
   1     010   000001 777640   000014 006000   000000 177640   000000 006014    ................
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:79   
   1     014   000000 000001   000000 000001                                    ........

FPT_OPEN
 Sect OctLoc
   1     016   000025 777640   000062 006000   000000 177640   000000 006014    .....2..........
   1     022   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     062*  000000 000042   000000 000000   252525 000000   000040 252520    ..."......... ..
   1     066   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     072   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     076   255000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     102   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     106   000000 000000   ****** ******                                    ........

FPT_GETDCB
 Sect OctLoc
   1     110   000001 777640   000116 006000   000000 177640   000000 006014    .....N..........
   1     114   000000 177640   000000 006014   000000 000000   000000 000000    ................

FPT_RELDCB
 Sect OctLoc
   1     120   000001 777640   000122 006000   000000 000000   000000 000000    .....R..........

FPT_READ
 Sect OctLoc
   1     124   000005 777640   000134 006000   000000 177640   000000 006014    .....\..........
   1     130   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     134   000000 400000   000000 000000   000000 000000   000000 000000    ................
   1     140   000000 000000   000000 000000                                    ........

FPT_WRITE
 Sect OctLoc
   1     142   000003 777640   000152 006000   000000 177640   000000 006014    .....j..........
   1     146   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     152   000000 400400   000000 000000   000000 000000   000000 000000    ................

FPT_PRECORD
 Sect OctLoc
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:80   
   1     156   000003 777640   000164 006000   000000 177640   000000 006014    .....t..........
   1     162   000000 177640   000000 006014   000000 000000   000000 000000    ................
   1     166   000000 000000   0***** ******                                    ........

FPT_DELREC
 Sect OctLoc
   1     170   000001 777640   000200 006000   000000 177640   000000 006014    ................
   1     174   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     200   000000 000000   000000 000000                                    ........

FPT_CLOSE
 Sect OctLoc
   1     202   000003 777640   000234 006000   000000 177640   000000 006014    ................
   1     206   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     232*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     236   000220 000000   000000 000000                                    ........

FPT_CHECK
 Sect OctLoc
   1     240   000001 777640   000242 006000   000000 000000   000000 000000    ................

FPT_GDS
 Sect OctLoc
   1     244   000001 777640   000250 006000   000000 177640   000000 006014    ................
   1     250   000600 000000   ****** ******                                    ........

FPT_GETGLBL
 Sect OctLoc
   1     252   000001 777640   000256 006000   000000 177640   000000 006014    ................
   1     256   200600 024000   ****** ******                                    ........

FPT_FDS
 Sect OctLoc
   1     260   000001 777640   000264 006000   000000 177640   000000 006014    ................
   1     264   000000 000000   ****** ******                                    ........

FPT_ENQ
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:81   
 Sect OctLoc
   1     266   000003 777640   000274 006000   000000 177640   000000 006014    ................
   1     272   000000 177640   000000 006014   000000 400000   777777 777777    ................
   1     276   000000 000000   000000 000000                                    ........

FPT_DEQ
 Sect OctLoc
   1     300   000001 777640   000306 006000   000000 177640   000000 006014    ................
   1     304   000000 177640   000000 006014   000000 400000   000000 000000    ................

FPT_EVENT
 Sect OctLoc
   1     310   000001 777640   000312 006000   000000 000000   000000 000000    ................

FPT_XCON
 Sect OctLoc
   1     314   000001 777640   000320 006000   000000 177640   000000 006014    ................
   1     320   000000 000000   000000 000000                                    ........

FPT_INT
 Sect OctLoc
   1     322   000001 777640   000324 006000   000000 000000   000000 000000    ................

FPT_TRAP
 Sect OctLoc
   1     326   000005 777640   000332 006000   000000 177640   000000 006014    ................
   1     332   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     336   775462 575257   000000 000000                                    ........

FPT_TIME
 Sect OctLoc
   1     340   000001 777640   000352 006000   000000 177640   000000 006014    ................
   1     344   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     350   000000 177640   000000 006014   000004 000000   ****** ******    ................

FPT_TRUNC
 Sect OctLoc
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:82   
   1     354   000001 777640   000356 006000   000000 000000   000000 000000    ................

FPT_PFIL
 Sect OctLoc
   1     360   000001 777640   000362 006000   000000 000000   000000 000000    ................

FPT_ERRMSG
 Sect OctLoc
   1     364   000003 777640   000412 006000   000000 177640   000000 006014    ................
   1     370   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     410*  000000 177640   000000 006014   000000 000000   000000 000141    ...............a
   1     414   377000 030001   040000 000000                                    .... ...

FPT_TRTN
 Sect OctLoc
   1     416   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     422   000001 777640   000424 006000   000000 000000   000000 000000    ................

FPT_SCREECH
 Sect OctLoc
   1     426   000001 777640   000006 006000   000000 177640   000000 006014    ................
   1     432   000000 177640   000000 006014                                    ........

VLP_VECTOR
 Sect OctLoc
   1     434   000000 177640   000000 006014                                    ........

FPT_KEYIN
 Sect OctLoc
   1     436   000005 777640   000446 006000   000000 17764*   000000 006014    ................
   1     442   000000 17764*   000000 006014   000000 177640   000000 006014    ................
   1     446   114117 103101   114040 040040   000000 000000   401000 000000    LOCAL   ........
   1     452   000000 000000   000000 000000                                    ........

FPT_MONINFO
 Sect OctLoc
   1     454   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:83   
   1     464*  000000 177640   000000 006014   000000 177640   000000 006014    ................

FPT_ERR
 Sect OctLoc
   1     470   000001 777640   000474 006000   000000 177640   000000 006014    ................
   1     474   006000 000000   000000 000000                                    ........

ZI_FPTCHKR
 Sect OctLoc
   1     476   4***** ******                                                    ....

ZI_FPTCHKR_DUMP
 Sect OctLoc
   1     477   0***** ******                                                    ....

ZI_TEST
 Sect OctLoc
   1     500   0***** ******                                                    ....

ZI_USER
 Sect OctLoc
   1     501   0***** ******                                                    ....

ZI_WAITIO
 Sect OctLoc
   1     502   0***** ******                                                    ....

ZI_TJNAME
 Sect OctLoc
   1     503   052111 040040                                                    *I

ZI_MAXKEY
 Sect OctLoc
   1     504   777777 777777   777777 777777   777777 777777   777777 777777    ................
   1     600*  777777 777777   777777 777777   777777 777777   777777 777777    ................

(unnamed)
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:84   
 Sect OctLoc
   1     604   124122 101103   105040 040040   114117 040040                    TRACE   LO

(unnamed)
 Sect OctLoc
   4     000   000000 000000   000000 006014   000025 777640   000007 777640    ................
   4     004   000001 777640   000005 777640   001777 600000   000003 777640    ................
   4     010   777777 377777   000077 577640   004624 200000   000040 777640    .....?....... ..
   4     014   001777 777640   000077 777640   777777 777377   000002 377640    .....?..........
   4     020   000001 377640   000002 006000   000001 377640   000004 006000    ................
   4     024   000002 577640   005004 400000   005007 200000   000002 000000    ................
   4     030   000000 006000   000001 000000   000000 000006   000032 006000    ................
   4     034   000606 006000   000000 006003   400000 000000                    ............
      594     3997    1   END ZIO$INIT;

PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:85   
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIO$INIT.

   Procedure ZIO$INIT requires 830 words for executable code.
   Procedure ZIO$INIT requires 12 words of local(AUTO) storage.

    No errors detected in file ZIM$INIT.:ZIC0TSI    .
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:86   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:87   
          MINI XREF LISTING

B$ALT.CODE
      1482**DCL      1482--REDEF    1483--REDEF    1483--REDEF
B$ALT.ERR
      1483**DCL      3995>>ASSIGN
B$ALT.ERR.ERR#
      1484**DCL      1484--REDEF
B$ALT.EVID
      1483**DCL      1483--REDEF    1483--REDEF
B$TCB.ALT$
      1478**DCL      3995>>ASSIGN
B$TCB$
        10**DCL      3995>>ASSIGN
BLOCK
       843**DCL      3648--ASSIGN   3659--ASSIGN
F$DCB.ACTPOS
      1585**DCL      1585--REDEF
F$DCB.ARS#
      1559**DCL      1559--REDEF
F$DCB.ATTR
      1578**DCL      1579--REDEF
F$DCB.BORROW
      1593**DCL      1593--REDEF    1593--REDEF    1593--REDEF
F$DCB.DCBNAME.L
      1607**DCL      1607--IMP-SIZ
F$DCB.EOMCHAR#
      1563**DCL      1563--REDEF
F$DCB.FLDID
      1588**DCL      1588--REDEF
F$DCB.FORM$
      1582**DCL      1582--REDEF
F$DCB.FSECT
      1598**DCL      1598--REDEF
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:88   
F$DCB.FSN#
      1575**DCL      1575--REDEF    1575--REDEF    1576--REDEF
F$DCB.HEADER$
      1581**DCL      1581--REDEF
F$DCB.IXTNSIZE#
      1579**DCL      1579--REDEF
F$DCB.LASTSTA$
      1568**DCL      1568--REDEF
F$DCB.LVL
      1594**DCL      1594--REDEF
F$DCB.NAME#.C
      1569**DCL      1569--REDEF
F$DCB.NOEOF
      1591**DCL      1591--REDEF
F$DCB.NRECS#
      1580**DCL      1580--REDEF
F$DCB.NRECX
      1599**DCL      1599--REDEF
F$DCB.OHDR
      1591**DCL      1591--REDEF
F$DCB.ORG#
      1574**DCL      1574--REDEF
F$DCB.PRECNO
      1597**DCL      1597--REDEF
F$DCB.RCSZ
      1603**DCL      1603--REDEF
F$DCB.RES#
      1570**DCL      1570--REDEF
F$DCB.SETX
      1582**DCL      1582--REDEF
F$DCB.TAB$
      1582**DCL      1582--REDEF
F$DCB.TDA
      1596**DCL      1597--REDEF
F$DCB.UOPT#
      1572**DCL      3986>>IF       3986>>IF
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:89   
F$DCB.WSN#
      1570**DCL      1570--REDEF
FPT.PAGES
        14**DCL      3966>>ASSIGN
FPT.WORDS
        15**DCL      3963>>ASSIGN
FPT$
        12**DCL        13--REDEF      23--IMP-PTR  2332--IMP-PTR  2441--IMP-PTR  2550--IMP-PTR  2659--IMP-PTR
      2714--IMP-PTR  2729--IMP-PTR  2749--IMP-PTR  2788--IMP-PTR  2827--IMP-PTR  2866--IMP-PTR  2905--IMP-PTR
      2936--IMP-PTR  2967--IMP-PTR  2998--IMP-PTR  3029--IMP-PTR  3060--IMP-PTR  3085--IMP-PTR  3106--IMP-PTR
      3127--IMP-PTR  3148--IMP-PTR  3167--IMP-PTR  3198--IMP-PTR  3228--IMP-PTR  3242--IMP-PTR  3258--IMP-PTR
      3273--IMP-PTR  3291--IMP-PTR  3309--IMP-PTR  3327--IMP-PTR  3344--IMP-PTR  3361--IMP-PTR  3378--IMP-PTR
      3397--IMP-PTR  3416--IMP-PTR  3430--IMP-PTR  3445--IMP-PTR  3472--IMP-PTR  3489--IMP-PTR  3503--IMP-PTR
      3522--IMP-PTR  3537--IMP-PTR  3582<<ASSIGN   3586>>ASSIGN   3587>>ASSIGN   3588<<ASSIGN   3588>>ASSIGN
      3592>>ASSIGN   3593>>ASSIGN   3594>>ASSIGN   3594>>ASSIGN   3595>>ASSIGN   3596<<ASSIGN   3596>>ASSIGN
      3600>>ASSIGN   3601>>ASSIGN   3602>>ASSIGN   3602>>ASSIGN   3603>>ASSIGN   3604>>ASSIGN   3605>>ASSIGN
      3606<<ASSIGN   3606>>ASSIGN   3610>>ASSIGN   3611>>ASSIGN   3612>>ASSIGN   3612>>ASSIGN   3613>>ASSIGN
      3614>>ASSIGN   3615>>ASSIGN   3616>>ASSIGN   3617<<ASSIGN   3617>>ASSIGN   3621>>ASSIGN   3622>>ASSIGN
      3623>>ASSIGN   3623>>ASSIGN   3624<<ASSIGN   3624>>ASSIGN   3628>>ASSIGN   3629>>ASSIGN   3630>>ASSIGN
      3630>>ASSIGN   3631>>ASSIGN   3632>>ASSIGN   3633<<ASSIGN   3633>>ASSIGN   3637>>ASSIGN   3638>>ASSIGN
      3639>>ASSIGN   3639>>ASSIGN   3640<<ASSIGN   3640>>ASSIGN   3644>>ASSIGN   3645>>ASSIGN   3646>>ASSIGN
      3646>>ASSIGN   3647>>ASSIGN   3648>>ASSIGN   3649>>ASSIGN   3650>>ASSIGN   3651<<ASSIGN   3651>>ASSIGN
      3655>>ASSIGN   3656>>ASSIGN   3657>>ASSIGN   3657>>ASSIGN   3658>>ASSIGN   3659>>ASSIGN   3661>>ASSIGN
      3663>>ASSIGN   3664>>ASSIGN   3665<<ASSIGN   3665>>ASSIGN   3676>>ASSIGN   3677>>ASSIGN   3678>>ASSIGN
      3678>>ASSIGN   3679>>ASSIGN   3680>>ASSIGN   3681>>ASSIGN   3682>>ASSIGN   3683>>ASSIGN   3684>>ASSIGN
      3685<<ASSIGN   3685>>ASSIGN   3689>>ASSIGN   3690>>ASSIGN   3691>>ASSIGN   3691>>ASSIGN   3692>>ASSIGN
      3693>>ASSIGN   3694>>ASSIGN   3695<<ASSIGN   3695>>ASSIGN   3699>>ASSIGN   3700>>ASSIGN   3701>>ASSIGN
      3701>>ASSIGN   3702>>ASSIGN   3703>>ASSIGN   3704>>ASSIGN   3705>>ASSIGN   3706>>ASSIGN   3707<<ASSIGN
      3707>>ASSIGN   3711>>ASSIGN   3712>>ASSIGN   3713>>ASSIGN   3713>>ASSIGN   3714>>ASSIGN   3715>>ASSIGN
      3716<<ASSIGN   3716>>ASSIGN   3720>>ASSIGN   3721>>ASSIGN   3722>>ASSIGN   3722>>ASSIGN   3723>>ASSIGN
      3724>>ASSIGN   3725<<ASSIGN   3725>>ASSIGN   3729>>ASSIGN   3730>>ASSIGN   3731>>ASSIGN   3731>>ASSIGN
      3732>>ASSIGN   3733<<ASSIGN   3733>>ASSIGN   3737>>ASSIGN   3738>>ASSIGN   3739>>ASSIGN   3739>>ASSIGN
      3740>>ASSIGN   3741<<ASSIGN   3741>>ASSIGN   3745>>ASSIGN   3746>>ASSIGN   3747>>ASSIGN   3747>>ASSIGN
      3748>>ASSIGN   3749<<ASSIGN   3749>>ASSIGN   3753>>ASSIGN   3754>>ASSIGN   3755>>ASSIGN   3755>>ASSIGN
      3756>>ASSIGN   3757>>ASSIGN   3758<<ASSIGN   3758>>ASSIGN   3762>>ASSIGN   3763>>ASSIGN   3764>>ASSIGN
      3764>>ASSIGN   3765>>ASSIGN   3766>>ASSIGN   3767>>ASSIGN   3768<<ASSIGN   3768>>ASSIGN   3772>>ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:90   
      3773>>ASSIGN   3774>>ASSIGN   3774>>ASSIGN   3775>>ASSIGN   3776>>ASSIGN   3777>>ASSIGN   3778<<ASSIGN
      3778>>ASSIGN   3782>>ASSIGN   3783>>ASSIGN   3784>>ASSIGN   3784>>ASSIGN   3785>>ASSIGN   3786<<ASSIGN
      3786>>ASSIGN   3790>>ASSIGN   3791>>ASSIGN   3792>>ASSIGN   3792>>ASSIGN   3793<<ASSIGN   3793>>ASSIGN
      3797>>ASSIGN   3798>>ASSIGN   3799>>ASSIGN   3799>>ASSIGN   3803>>ASSIGN   3804<<ASSIGN   3808>>ASSIGN
      3809>>ASSIGN   3810>>ASSIGN   3810>>ASSIGN   3811>>ASSIGN   3812<<ASSIGN   3812>>ASSIGN   3816>>ASSIGN
      3817>>ASSIGN   3818>>ASSIGN   3818>>ASSIGN   3819>>ASSIGN   3820<<ASSIGN   3820>>ASSIGN   3824>>ASSIGN
      3825>>ASSIGN   3826>>ASSIGN   3826>>ASSIGN   3827>>ASSIGN   3828>>ASSIGN   3829<<ASSIGN   3829>>ASSIGN
      3833>>ASSIGN   3834>>ASSIGN   3835>>ASSIGN   3835>>ASSIGN   3836>>ASSIGN   3837>>ASSIGN   3838>>ASSIGN
      3839<<ASSIGN   3839>>ASSIGN   3843>>ASSIGN   3844>>ASSIGN   3845>>ASSIGN   3845>>ASSIGN   3846>>ASSIGN
      3847>>ASSIGN   3848<<ASSIGN   3848>>ASSIGN   3852>>ASSIGN   3853>>ASSIGN   3854>>ASSIGN   3854>>ASSIGN
      3855>>ASSIGN   3856<<ASSIGN   3856>>ASSIGN   3860>>ASSIGN   3861>>ASSIGN   3862>>ASSIGN   3862>>ASSIGN
      3863>>ASSIGN   3864<<ASSIGN   3864>>ASSIGN   3868>>ASSIGN   3869>>ASSIGN   3870>>ASSIGN   3870>>ASSIGN
      3871>>ASSIGN   3872>>ASSIGN   3873<<ASSIGN   3873>>ASSIGN   3877>>ASSIGN   3878>>ASSIGN   3879>>ASSIGN
      3879>>ASSIGN   3880<<ASSIGN   3880>>ASSIGN   3884>>ASSIGN   3885>>ASSIGN   3886>>ASSIGN   3886>>ASSIGN
      3887>>ASSIGN   3888<<ASSIGN   3888>>ASSIGN   3892>>ASSIGN   3893>>ASSIGN   3894>>ASSIGN   3894>>ASSIGN
      3895>>ASSIGN   3896>>ASSIGN   3897>>ASSIGN   3898>>ASSIGN   3899>>ASSIGN   3900>>ASSIGN   3901<<ASSIGN
      3901>>ASSIGN   3905>>ASSIGN   3906>>ASSIGN   3907>>ASSIGN   3907>>ASSIGN   3908<<ASSIGN   3908>>ASSIGN
      3912>>ASSIGN   3913>>ASSIGN   3914>>ASSIGN   3914>>ASSIGN   3915>>ASSIGN   3916>>ASSIGN   3917>>ASSIGN
      3918>>ASSIGN   3919>>ASSIGN   3920>>ASSIGN   3921<<ASSIGN   3921>>ASSIGN   3925>>ASSIGN   3926>>ASSIGN
      3927>>ASSIGN   3927>>ASSIGN   3928>>ASSIGN   3929>>ASSIGN   3930<<ASSIGN   3930>>ASSIGN   3934>>ASSIGN
      3935>>ASSIGN   3936>>ASSIGN   3937>>ASSIGN   3938<<ASSIGN   3938>>ASSIGN   3942>>ASSIGN   3943>>ASSIGN
      3944>>ASSIGN   3944>>ASSIGN   3945>>ASSIGN   3946<<ASSIGN   3946>>ASSIGN   3950>>ASSIGN   3951>>ASSIGN
      3952>>ASSIGN   3953<<ASSIGN   3953>>ASSIGN   3958>>ASSIGN   3959>>ASSIGN   3961<<ASSIGN   3961>>ASSIGN
      3963>>ASSIGN
FPT$CHECK
      3228**DCL      3798<<ASSIGN   3803--ASSIGN
FPT$CHECK.V
      3228**DCL      3799--ASSIGN
FPT$CHECK.V_
      3228**DCL      3799<<ASSIGN
FPT$CLOSE
      3198**DCL      3791<<ASSIGN   3793--ASSIGN
FPT$CLOSE.SN_
      3198**DCL      3198--REDEF
FPT$CLOSE.UTL_
      3199**DCL      3199--REDEF
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:91   
FPT$CLOSE.V
      3203**DCL      3792--ASSIGN
FPT$CLOSE.V.EXPIRE#
      3213**DCL      3213--REDEF
FPT$CLOSE.V.TYPE#
      3211**DCL      3211--REDEF
FPT$CLOSE.V.XTNSIZE#
      3208**DCL      3208--REDEF    3210--REDEF
FPT$CLOSE.V_
      3198**DCL      3792<<ASSIGN
FPT$DELI
      3167**DCL      3712<<ASSIGN   3716--ASSIGN
FPT$DELI.KEY_
      3167**DCL      3714<<ASSIGN
FPT$DELI.V
      3170**DCL      3713--ASSIGN
FPT$DELI.V.INDX#
      3171**DCL      3715<<ASSIGN
FPT$DELI.V_
      3167**DCL      3713<<ASSIGN
FPT$DELR
      3148**DCL      3783<<ASSIGN   3786--ASSIGN
FPT$DELR.KEY_
      3148**DCL      3785<<ASSIGN
FPT$DELR.V
      3151**DCL      3784--ASSIGN
FPT$DELR.V_
      3148**DCL      3784<<ASSIGN
FPT$DEQ
      3327**DCL      3853<<ASSIGN   3856--ASSIGN
FPT$DEQ.RNAME_
      3327**DCL      3855<<ASSIGN
FPT$DEQ.V
      3328**DCL      3854--ASSIGN
FPT$DEQ.V_
      3327**DCL      3854<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:92   
FPT$DEQALL
      3361**DCL      3869<<ASSIGN   3873--ASSIGN
FPT$DEQALL.V
      3362**DCL      3870--ASSIGN
FPT$DEQALL.V.SELECTIVE#
      3363**DCL      3871<<ASSIGN
FPT$DEQALL.V.SELECT_ID#
      3364**DCL      3872<<ASSIGN
FPT$DEQALL.V_
      3361**DCL      3870<<ASSIGN
FPT$DEQI
      3344**DCL      3861<<ASSIGN   3864--ASSIGN
FPT$DEQI.RNAME_
      3344**DCL      3863<<ASSIGN
FPT$DEQI.V
      3345**DCL      3862--ASSIGN
FPT$DEQI.V_
      3344**DCL      3862<<ASSIGN
FPT$ENQ
      3273**DCL      3825<<ASSIGN   3829--ASSIGN
FPT$ENQ.RNAME_
      3273**DCL      3827<<ASSIGN
FPT$ENQ.V
      3274**DCL      3826--ASSIGN
FPT$ENQ.V.NO_DOWNGRADE#
      3275**DCL      3828<<ASSIGN
FPT$ENQ.V_
      3273**DCL      3826<<ASSIGN
FPT$ENQI
      3309**DCL      3844<<ASSIGN   3848--ASSIGN
FPT$ENQI.RNAME_
      3309**DCL      3846<<ASSIGN
FPT$ENQI.V
      3310**DCL      3845--ASSIGN
FPT$ENQI.V.SHARE#
      3311**DCL      3847<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:93   
FPT$ENQI.V_
      3309**DCL      3845<<ASSIGN
FPT$ENQS
      3291**DCL      3834<<ASSIGN   3839--ASSIGN
FPT$ENQS.RNAME_
      3291**DCL      3836<<ASSIGN
FPT$ENQS.V
      3292**DCL      3835--ASSIGN
FPT$ENQS.V.EVENT#
      3295**DCL      3837<<ASSIGN
FPT$ENQS.V.WAIT_TIME#
      3295**DCL      3838<<ASSIGN
FPT$ENQS.V_
      3291**DCL      3835<<ASSIGN
FPT$ERRMSG
      3445**DCL      3913<<ASSIGN   3921--ASSIGN
FPT$ERRMSG.BUF_
      3445**DCL      3915<<ASSIGN
FPT$ERRMSG.CODE_
      3445**DCL      3916<<ASSIGN
FPT$ERRMSG.FIELD1_
      3447**DCL      3917<<ASSIGN
FPT$ERRMSG.FIELD2_
      3448**DCL      3918<<ASSIGN
FPT$ERRMSG.FIELD3_
      3448**DCL      3919<<ASSIGN
FPT$ERRMSG.V
      3449**DCL      3914--ASSIGN
FPT$ERRMSG.V.OUTDCB1#
      3450**DCL      3920<<ASSIGN
FPT$ERRMSG.V_
      3445**DCL      3914<<ASSIGN
FPT$FDS
      3258**DCL      3817<<ASSIGN   3820--ASSIGN
FPT$FDS.RESULTS_
      3258**DCL      3819<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:94   
FPT$FDS.V
      3258**DCL      3818--ASSIGN
FPT$FDS.V_
      3258**DCL      3818<<ASSIGN
FPT$GDS
      3242**DCL      3809<<ASSIGN   3812--ASSIGN
FPT$GDS.RESULTS_
      3242**DCL      3811<<ASSIGN
FPT$GDS.V
      3242**DCL      3810--ASSIGN
FPT$GDS.V_
      3242**DCL      3810<<ASSIGN
FPT$GETDCB
      2714**DCL      3629<<ASSIGN   3633--ASSIGN
FPT$GETDCB.DCBNAME_
      2714**DCL      3631<<ASSIGN
FPT$GETDCB.DCBNUM_
      2714**DCL      3632<<ASSIGN
FPT$GETDCB.V
      2715**DCL      3630--ASSIGN
FPT$GETDCB.V_
      2714**DCL      3630<<ASSIGN
FPT$KEYIN
      3503**DCL      3943<<ASSIGN   3946--ASSIGN
FPT$KEYIN.MESS_
      3503**DCL      3945<<ASSIGN
FPT$KEYIN.V
      3506**DCL      3944--ASSIGN
FPT$KEYIN.V_
      3503**DCL      3944<<ASSIGN
FPT$MONINFO
      3522**DCL      3951<<ASSIGN   3953--ASSIGN
FPT$MONINFO.STYPE_
      3524**DCL      3952<<ASSIGN
FPT$OPEN
      2332**DCL      3593<<ASSIGN   3596--ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:95   
FPT$OPEN.ACSVEH_
      2334**DCL      2335--REDEF
FPT$OPEN.ALTKEYS_
      2340**DCL      2341--REDEF    2341--REDEF
FPT$OPEN.HDR_
      2339**DCL      2340--REDEF
FPT$OPEN.TAB_
      2338**DCL      2339--REDEF
FPT$OPEN.UHL_
      2332**DCL      2333--REDEF    2333--REDEF
FPT$OPEN.V
      2341**DCL      3594--ASSIGN
FPT$OPEN.V.FSN#
      2372**DCL      2372--REDEF    2372--REDEF
FPT$OPEN.V.INITZ.REASSIGN#
      2342**DCL      3595<<ASSIGN
FPT$OPEN.V_
      2332**DCL      3594<<ASSIGN
FPT$OPEN.WSN_
      2338**DCL      2338--REDEF
FPT$OPNDFLT
      2441**DCL      3601<<ASSIGN   3606--ASSIGN
FPT$OPNDFLT.ACCT_
      2445**DCL      3604<<ASSIGN
FPT$OPNDFLT.ACSVEH_
      2443**DCL      2444--REDEF
FPT$OPNDFLT.ALTKEYS_
      2449**DCL      2450--REDEF    2450--REDEF
FPT$OPNDFLT.HDR_
      2448**DCL      2449--REDEF
FPT$OPNDFLT.NAME_
      2442**DCL      3603<<ASSIGN
FPT$OPNDFLT.TAB_
      2447**DCL      2448--REDEF
FPT$OPNDFLT.UHL_
      2441**DCL      2442--REDEF    2442--REDEF
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:96   
FPT$OPNDFLT.V
      2450**DCL      3602--ASSIGN
FPT$OPNDFLT.V.FSN#
      2481**DCL      2481--REDEF    2481--REDEF
FPT$OPNDFLT.V.SETDCB#
      2451**DCL      3605<<ASSIGN
FPT$OPNDFLT.V_
      2441**DCL      3602<<ASSIGN
FPT$OPNDFLT.WSN_
      2447**DCL      2447--REDEF
FPT$OPNSCRB
      2550**DCL      3611<<ASSIGN   3617--ASSIGN
FPT$OPNSCRB.ACCT_
      2554**DCL      3614<<ASSIGN
FPT$OPNSCRB.ACSVEH_
      2552**DCL      2553--REDEF
FPT$OPNSCRB.ALTKEYS_
      2558**DCL      2559--REDEF    2559--REDEF
FPT$OPNSCRB.HDR_
      2557**DCL      2558--REDEF
FPT$OPNSCRB.NAME_
      2551**DCL      3613<<ASSIGN
FPT$OPNSCRB.TAB_
      2556**DCL      2557--REDEF
FPT$OPNSCRB.UHL_
      2550**DCL      2551--REDEF    2551--REDEF
FPT$OPNSCRB.V
      2559**DCL      3612--ASSIGN
FPT$OPNSCRB.V.ASN#
      2569**DCL      3615<<ASSIGN
FPT$OPNSCRB.V.FSN#
      2590**DCL      2590--REDEF    2590--REDEF
FPT$OPNSCRB.V.INITZ.SCRUB#
      2560**DCL      3616<<ASSIGN
FPT$OPNSCRB.V_
      2550**DCL      3612<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:97   
FPT$OPNSCRB.WSN_
      2556**DCL      2556--REDEF
FPT$PFIL
      3430**DCL      3878<<ASSIGN   3880--ASSIGN
FPT$PFIL.V
      3430**DCL      3879--ASSIGN
FPT$PFIL.V_
      3430**DCL      3879<<ASSIGN
FPT$PREC
      3085**DCL      3773<<ASSIGN   3778--ASSIGN
FPT$PREC.KEY_
      3085**DCL      3775<<ASSIGN
FPT$PREC.V
      3087**DCL      3774--ASSIGN
FPT$PREC.V.KEYR#
      3088**DCL      3777<<ASSIGN
FPT$PREC.V.KEYS#
      3088**DCL      3776<<ASSIGN
FPT$PREC.V_
      3085**DCL      3774<<ASSIGN
FPT$PRECI
      3127**DCL      3700<<ASSIGN   3707--ASSIGN
FPT$PRECI.IDBUF_
      3129**DCL      3703<<ASSIGN
FPT$PRECI.KEY_
      3127**DCL      3702<<ASSIGN
FPT$PRECI.V
      3129**DCL      3701--ASSIGN
FPT$PRECI.V.ID#
      3130**DCL      3704<<ASSIGN
FPT$PRECI.V.KEYR#
      3130**DCL      3706<<ASSIGN
FPT$PRECI.V.KEYS#
      3130**DCL      3705<<ASSIGN
FPT$PRECI.V_
      3127**DCL      3701<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:98   
FPT$PRECJ
      3106**DCL      3746<<ASSIGN   3749--ASSIGN
FPT$PRECJ.V
      3108**DCL      3747--ASSIGN
FPT$PRECJ.V.N#
      3112**DCL      3748<<ASSIGN
FPT$PRECJ.V_
      3106**DCL      3747<<ASSIGN
FPT$READD
      2749**DCL      3645<<ASSIGN   3651--ASSIGN
FPT$READD.BUF_.BOUND
      2751**DCL      3648<<ASSIGN
FPT$READD.KEY_
      2749**DCL      3647<<ASSIGN
FPT$READD.STATION_
      2752**DCL      2753--REDEF
FPT$READD.V
      2753**DCL      3646--ASSIGN
FPT$READD.V.DVBYTE.REREAD#
      2764**DCL      2764--REDEF
FPT$READD.V.FULL#
      2755**DCL      3649<<ASSIGN
FPT$READD.V.INDX#
      2762**DCL      2762--REDEF
FPT$READD.V.KEYS#
      2754**DCL      3650<<ASSIGN
FPT$READD.V_
      2749**DCL      3646<<ASSIGN
FPT$READI
      2788**DCL      3677<<ASSIGN   3685--ASSIGN
FPT$READI.KEY_
      2788**DCL      3680<<ASSIGN
FPT$READI.STATION_
      2791**DCL      2792--REDEF    3679<<ASSIGN
FPT$READI.V
      2792**DCL      3678--ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:99   
FPT$READI.V.DVBYTE.REREAD#
      2803**DCL      2803--REDEF
FPT$READI.V.ID#
      2793**DCL      3681<<ASSIGN
FPT$READI.V.IDS#
      2794**DCL      3682<<ASSIGN
FPT$READI.V.INDX#
      2801**DCL      2801--REDEF
FPT$READI.V.KEYR#
      2793**DCL      3684<<ASSIGN
FPT$READI.V.KEYS#
      2793**DCL      3683<<ASSIGN
FPT$READI.V_
      2788**DCL      3678<<ASSIGN
FPT$READJ
      2866**DCL      3730<<ASSIGN   3733--ASSIGN
FPT$READJ.BUF_
      2868**DCL      3732<<ASSIGN
FPT$READJ.STATION_
      2869**DCL      2870--REDEF
FPT$READJ.V
      2870**DCL      3731--ASSIGN
FPT$READJ.V.DVBYTE.REREAD#
      2881**DCL      2881--REDEF
FPT$READJ.V.INDX#
      2879**DCL      2879--REDEF
FPT$READJ.V_
      2866**DCL      3731<<ASSIGN
FPT$READK
      2827**DCL      3754<<ASSIGN   3758--ASSIGN
FPT$READK.KEY_
      2827**DCL      3756<<ASSIGN
FPT$READK.STATION_
      2830**DCL      2831--REDEF
FPT$READK.V
      2831**DCL      3755--ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:100  
FPT$READK.V.DVBYTE.REREAD#
      2842**DCL      2842--REDEF
FPT$READK.V.INDX#
      2840**DCL      2840--REDEF
FPT$READK.V.KEYS#
      2832**DCL      3757<<ASSIGN
FPT$READK.V_
      2827**DCL      3755<<ASSIGN
FPT$RELDCB
      2729**DCL      3638<<ASSIGN   3640--ASSIGN
FPT$RELDCB.V
      2729**DCL      3639--ASSIGN
FPT$RELDCB.V_
      2729**DCL      3639<<ASSIGN
FPT$REOPEN
      2659**DCL      3622<<ASSIGN   3624--ASSIGN
FPT$REOPEN.ACSVEH_
      2661**DCL      2662--REDEF
FPT$REOPEN.ALTKEYS_
      2667**DCL      2668--REDEF    2668--REDEF
FPT$REOPEN.HDR_
      2666**DCL      2667--REDEF
FPT$REOPEN.TAB_
      2665**DCL      2666--REDEF
FPT$REOPEN.UHL_
      2659**DCL      2660--REDEF    2660--REDEF
FPT$REOPEN.V
      2668**DCL      3623--ASSIGN
FPT$REOPEN.V.FSN#
      2699**DCL      2699--REDEF    2699--REDEF
FPT$REOPEN.V_
      2659**DCL      3623<<ASSIGN
FPT$REOPEN.WSN_
      2665**DCL      2665--REDEF
FPT$SCREECH
      3489**DCL      3935<<ASSIGN   3938--ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:101  
FPT$SCREECH.JERR_
      3489**DCL      3936<<ASSIGN
FPT$SCREECH.SCREECHID_
      3490**DCL      3937<<ASSIGN
FPT$TIME
      3378**DCL      3885<<ASSIGN   3888--ASSIGN
FPT$TIME.TSTAMP_
      3381**DCL      3887<<ASSIGN
FPT$TIME.V
      3382**DCL      3886--ASSIGN
FPT$TIME.V_
      3378**DCL      3886<<ASSIGN
FPT$TIMEC
      3397**DCL      3893<<ASSIGN   3901--ASSIGN
FPT$TIMEC.DATE_
      3397**DCL      3896<<ASSIGN
FPT$TIMEC.DAY_
      3400**DCL      3898<<ASSIGN
FPT$TIMEC.TIME_
      3399**DCL      3897<<ASSIGN
FPT$TIMEC.TSTAMP_
      3400**DCL      3895<<ASSIGN
FPT$TIMEC.V
      3401**DCL      3894--ASSIGN
FPT$TIMEC.V.DEST#
      3401**DCL      3900<<ASSIGN
FPT$TIMEC.V.SOURCE#
      3401**DCL      3899<<ASSIGN
FPT$TIMEC.V_
      3397**DCL      3894<<ASSIGN
FPT$TRTN
      3472**DCL      3926<<ASSIGN   3930--ASSIGN
FPT$TRTN.V
      3473**DCL      3927--ASSIGN
FPT$TRTN.V.IC#
      3473**DCL      3928<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:102  
FPT$TRTN.V.IR#
      3473**DCL      3474--REDEF
FPT$TRTN.V.SETIR#
      3475**DCL      3929<<ASSIGN
FPT$TRTN.V_
      3472**DCL      3927<<ASSIGN
FPT$TRUNC
      3416**DCL      3906<<ASSIGN   3908--ASSIGN
FPT$TRUNC.V
      3416**DCL      3907--ASSIGN
FPT$TRUNC.V_
      3416**DCL      3907<<ASSIGN
FPT$WRITE
      2998**DCL      3721<<ASSIGN   3725--ASSIGN
FPT$WRITE.BUF_
      2998**DCL      3723<<ASSIGN
FPT$WRITE.STATION_
      3000**DCL      3000--REDEF
FPT$WRITE.V
      3001**DCL      3722--ASSIGN
FPT$WRITE.V.DVBYTE.VFC#
      3007**DCL      3007--REDEF    3724<<ASSIGN
FPT$WRITE.V_
      2998**DCL      3722<<ASSIGN
FPT$WRTC.STATION_
      3062**DCL      3062--REDEF
FPT$WRTC.V.DVBYTE.VFC#
      3069**DCL      3069--REDEF
FPT$WRTD
      2905**DCL      3656<<ASSIGN   3665--ASSIGN
FPT$WRTD.BUF_.BOUND
      2905**DCL      3659<<ASSIGN
FPT$WRTD.KEY_
      2905**DCL      3658<<ASSIGN
FPT$WRTD.STATION_
      2907**DCL      2907--REDEF
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:103  
FPT$WRTD.V
      2908**DCL      3657--ASSIGN
FPT$WRTD.V.DVBYTE.VFC#
      2914**DCL      2914--REDEF
FPT$WRTD.V.FULL#
      2910**DCL      3664<<ASSIGN
FPT$WRTD.V.WAIT#
      2908**DCL      3661<<ASSIGN   3663<<ASSIGN
FPT$WRTD.V_
      2905**DCL      3657<<ASSIGN
FPT$WRTI
      2936**DCL      3690<<ASSIGN   3695--ASSIGN
FPT$WRTI.STATION_
      2938**DCL      2938--REDEF    3692<<ASSIGN
FPT$WRTI.V
      2939**DCL      3691--ASSIGN
FPT$WRTI.V.DVBYTE.VFC#
      2945**DCL      2945--REDEF
FPT$WRTI.V.ID#
      2940**DCL      3693<<ASSIGN
FPT$WRTI.V.NEWKEY#
      2942**DCL      3694<<ASSIGN
FPT$WRTI.V_
      2936**DCL      3691<<ASSIGN
FPT$WRTJ
      3029**DCL      3738<<ASSIGN   3741--ASSIGN
FPT$WRTJ.BUF_
      3029**DCL      3740<<ASSIGN
FPT$WRTJ.STATION_
      3031**DCL      3031--REDEF
FPT$WRTJ.V
      3032**DCL      3739--ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      3038**DCL      3038--REDEF
FPT$WRTJ.V_
      3029**DCL      3739<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:104  
FPT$WRTK
      2967**DCL      3763<<ASSIGN   3768--ASSIGN
FPT$WRTK.KEY_
      2967**DCL      3765<<ASSIGN
FPT$WRTK.STATION_
      2969**DCL      2969--REDEF
FPT$WRTK.V
      2970**DCL      3764--ASSIGN
FPT$WRTK.V.DVBYTE.VFC#
      2976**DCL      2976--REDEF
FPT$WRTK.V.NEWKEY#
      2973**DCL      3766<<ASSIGN
FPT$WRTK.V.ONEWKEY#
      2972**DCL      3767<<ASSIGN
FPT$WRTK.V_
      2967**DCL      3764<<ASSIGN
FPT_CHECK
      1928**DCL      3798>>ASSIGN
FPT_CHECK.V
      1928**DCL      1928--DCLINIT
FPT_CLOSE
      1898**DCL      3791>>ASSIGN
FPT_CLOSE.SN_
      1898**DCL      1898--REDEF
FPT_CLOSE.UTL_
      1899**DCL      1899--REDEF
FPT_CLOSE.V
      1903**DCL      1898--DCLINIT
FPT_CLOSE.V.EXPIRE#
      1913**DCL      1913--REDEF
FPT_CLOSE.V.TYPE#
      1911**DCL      1911--REDEF
FPT_CLOSE.V.XTNSIZE#
      1908**DCL      1908--REDEF    1910--REDEF
FPT_DELREC
      1865**DCL      3712>>ASSIGN   3783>>ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:105  
FPT_DELREC.V
      1868**DCL      1865--DCLINIT
FPT_DEQ
      2012**DCL      3853>>ASSIGN   3861>>ASSIGN   3869>>ASSIGN
FPT_DEQ.V
      2013**DCL      2012--DCLINIT
FPT_ENQ
      1993**DCL      3825>>ASSIGN   3834>>ASSIGN   3844>>ASSIGN
FPT_ENQ.V
      1994**DCL      1993--DCLINIT
FPT_ERR.V
      2263**DCL      2263--DCLINIT
FPT_ERR.V.STEPCC#
      2264**DCL      2264--REDEF
FPT_ERRMSG
      2156**DCL      3913>>ASSIGN
FPT_ERRMSG.V
      2160**DCL      2156--DCLINIT
FPT_EVENT
      2030**DCL      3979<>CALL
FPT_EVENT.V
      2030**DCL      2030--DCLINIT
FPT_FDS
      1977**DCL      3817>>ASSIGN
FPT_FDS.V
      1977**DCL      1977--DCLINIT
FPT_GDS
      1942**DCL      3809>>ASSIGN
FPT_GDS.V
      1942**DCL      1942--DCLINIT
FPT_GETDCB
      1745**DCL      3629>>ASSIGN
FPT_GETDCB.V
      1746**DCL      1745--DCLINIT
FPT_GETGLBL
      1961**DCL      3568<>CALL
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:106  
FPT_GETGLBL.V
      1961**DCL      1961--DCLINIT
FPT_INT
      2060**DCL      3977<>CALL
FPT_INT.V
      2060**DCL      2060--DCLINIT
FPT_KEYIN
      2229**DCL      3943>>ASSIGN
FPT_KEYIN.V
      2232**DCL      2229--DCLINIT
FPT_MONINFO
      2248**DCL      3951>>ASSIGN
FPT_OPEN
      1690**DCL      3593>>ASSIGN   3601>>ASSIGN   3611>>ASSIGN   3622>>ASSIGN
FPT_OPEN.ACSVEH_
      1692**DCL      1693--REDEF
FPT_OPEN.ALTKEYS_
      1698**DCL      1699--REDEF    1699--REDEF
FPT_OPEN.HDR_
      1697**DCL      1698--REDEF
FPT_OPEN.TAB_
      1696**DCL      1697--REDEF
FPT_OPEN.UHL_
      1690**DCL      1691--REDEF    1691--REDEF
FPT_OPEN.V
      1699**DCL      1690--DCLINIT
FPT_OPEN.V.FSN#
      1730**DCL      1730--REDEF    1730--REDEF
FPT_OPEN.WSN_
      1696**DCL      1696--REDEF
FPT_PFIL
      2139**DCL      3878>>ASSIGN
FPT_PFIL.V
      2139**DCL      2139--DCLINIT
FPT_PRECORD
      1844**DCL      3700>>ASSIGN   3746>>ASSIGN   3773>>ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:107  
FPT_PRECORD.V
      1846**DCL      1844--DCLINIT
FPT_READ
      1780**DCL      3645>>ASSIGN   3677>>ASSIGN   3730>>ASSIGN   3754>>ASSIGN
FPT_READ.STATION_
      1783**DCL      1784--REDEF
FPT_READ.V
      1784**DCL      1780--DCLINIT
FPT_READ.V.DVBYTE.REREAD#
      1795**DCL      1795--REDEF
FPT_READ.V.INDX#
      1793**DCL      1793--REDEF
FPT_RELDCB
      1760**DCL      3638>>ASSIGN
FPT_RELDCB.V
      1760**DCL      1760--DCLINIT
FPT_SCREECH
      2200**DCL      3935>>ASSIGN
FPT_TIME
      2106**DCL      3885>>ASSIGN   3893>>ASSIGN
FPT_TIME.V
      2110**DCL      2106--DCLINIT
FPT_TRAP
      2083**DCL      3980<>CALL
FPT_TRAP.V
      2083**DCL      2083--DCLINIT
FPT_TRTN
      2183**DCL      3926>>ASSIGN
FPT_TRTN.V
      2184**DCL      2184--DCLINIT
FPT_TRTN.V.IR#
      2184**DCL      2185--REDEF
FPT_TRUNC
      2125**DCL      3906>>ASSIGN
FPT_TRUNC.V
      2125**DCL      2125--DCLINIT
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:108  
FPT_WAIT.V
      1622**DCL      1621--DCLINIT
FPT_WRITE
      1819**DCL      3656>>ASSIGN   3690>>ASSIGN   3721>>ASSIGN   3738>>ASSIGN   3763>>ASSIGN
FPT_WRITE.STATION_
      1821**DCL      1821--REDEF
FPT_WRITE.V
      1822**DCL      1819--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      1828**DCL      1828--REDEF
FPT_XCON
      2045**DCL      3978<>CALL
FPT_XCON.V
      2046**DCL      2045--DCLINIT
GLOBAL.ACCT
       755**DCL      3604--ASSIGN   3614--ASSIGN
GLOBAL.ACTIVE.DBCB$
       538**DCL       539--REDEF    3580<<ASSIGN
GLOBAL.ACTIVE.SSS$
       534**DCL       535--REDEF    3579<<ASSIGN
GLOBAL.ALTKEYS$
       827**DCL      3586<<ASSIGN
GLOBAL.BCB.HEAD
       639**DCL      3965<<ASSIGN
GLOBAL.BCB.LASTP$
       643**DCL      3963<<ASSIGN
GLOBAL.CANSSS$
       543**DCL      3959<<ASSIGN
GLOBAL.CHECK$
       802**DCL      3797<<ASSIGN
GLOBAL.CLOSE$
       793**DCL      3790<<ASSIGN
GLOBAL.DB.DBCB$
       632**DCL      3577<<ASSIGN
GLOBAL.DB.SSS$
       631**DCL      3575--DOINDEX  3575--DOINDEX  3576<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:109  
GLOBAL.DCBNAME
       752**DCL      3631--ASSIGN
GLOBAL.DCBNAME.LENGTH
       753**DCL      3982<<ASSIGN
GLOBAL.DCBNAME.TEXT
       754**DCL      3981<<ASSIGN
GLOBAL.DCBNUMBER
       741**DCL      3632--ASSIGN   3984>>ASSIGN   3986--IF       3986--IF
GLOBAL.DELI$
       825**DCL      3711<<ASSIGN
GLOBAL.DELR$
       800**DCL      3782<<ASSIGN
GLOBAL.DEQ$
       830**DCL      3852<<ASSIGN
GLOBAL.DEQALL$
       808**DCL      3868<<ASSIGN
GLOBAL.DEQI$
       828**DCL      3860<<ASSIGN
GLOBAL.ENQ.INDXMAP.BASE$
       685**DCL      3974<<ASSIGN
GLOBAL.ENQ.LIST.BASE$
       670**DCL      3973<<ASSIGN
GLOBAL.ENQ$
       807**DCL      3824<<ASSIGN
GLOBAL.ENQI$
       829**DCL      3843<<ASSIGN
GLOBAL.ENQS$
       818**DCL      3833<<ASSIGN
GLOBAL.ERRFIELD_INSERT
       756**DCL      3917--ASSIGN   3918--ASSIGN   3919--ASSIGN
GLOBAL.ERRMSG$
       817**DCL      3912<<ASSIGN
GLOBAL.FDS$
       806**DCL      3816<<ASSIGN
GLOBAL.FILENAME
       749**DCL      3603--ASSIGN   3613--ASSIGN   3937--ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:110  
GLOBAL.FPTBASE
       833**DCL      3582--ASSIGN
GLOBAL.GDS$
       805**DCL      3808<<ASSIGN
GLOBAL.GETDCB$
       803**DCL      3628<<ASSIGN
GLOBAL.GRANULE
       740**DCL      3647--ASSIGN   3658--ASSIGN
GLOBAL.JRECORD
       737**DCL      3732--ASSIGN   3740--ASSIGN
GLOBAL.KEY
       742**DCL       745--REDEF    3756--ASSIGN   3765--ASSIGN
GLOBAL.KEY.VALUE
       744**DCL      3680--ASSIGN   3702--ASSIGN   3714--ASSIGN
GLOBAL.KEYID
       770**DCL      3679--ASSIGN   3692--ASSIGN   3703--ASSIGN
GLOBAL.KEYIN$
       820**DCL      3942<<ASSIGN
GLOBAL.MONINFO$
       821**DCL      3950<<ASSIGN
GLOBAL.OPEN$
       789**DCL      3592<<ASSIGN
GLOBAL.OPNDFLT$
       790**DCL      3600<<ASSIGN
GLOBAL.OPNSCRB$
       791**DCL      3610<<ASSIGN
GLOBAL.PARAN.TRACE.DCB#
       610**DCL      3984<<ASSIGN
GLOBAL.PARAN.TRACE.MODE
       617**DCL       624--REDEF
GLOBAL.PARAN.TRACE.UOPT
       624**DCL      3988<<ASSIGN
GLOBAL.PFIL$
       811**DCL      3877<<ASSIGN
GLOBAL.PREC$
       801**DCL      3772<<ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:111  
GLOBAL.PRECI$
       824**DCL      3699<<ASSIGN
GLOBAL.PRECJ$
       819**DCL      3745<<ASSIGN
GLOBAL.PRINTBUF
       775**DCL      3723--ASSIGN   3915--ASSIGN   3945--ASSIGN
GLOBAL.PRINTBUF.BUFFER
       776**DCL       777--REDEF     778--REDEF     779--REDEF
GLOBAL.PRINTBUF.ERR.V
       781**DCL       784--REDEF     785--REDEF     786--REDEF
GLOBAL.READD$
       794**DCL      3644<<ASSIGN
GLOBAL.READI$
       796**DCL      3676<<ASSIGN
GLOBAL.READJ$
       813**DCL      3729<<ASSIGN
GLOBAL.READK$
       798**DCL      3753<<ASSIGN
GLOBAL.RELDCB$
       804**DCL      3637<<ASSIGN
GLOBAL.REOPEN$
       792**DCL      3621<<ASSIGN
GLOBAL.RET.SYSERR#
       553**DCL      3916--ASSIGN   3936--ASSIGN   3995<<ASSIGN
GLOBAL.RNAME
       759**DCL      3827--ASSIGN   3855--ASSIGN
GLOBAL.RNAME.LENGTH
       760**DCL      3581<<ASSIGN
GLOBAL.SCREECH$
       823**DCL      3934<<ASSIGN
GLOBAL.SKEY
       745**DCL      3775--ASSIGN   3785--ASSIGN
GLOBAL.STYPE
       769**DCL      3952--ASSIGN
GLOBAL.TIME.DATE
       766**DCL      3896--ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:112  
GLOBAL.TIME.DAY
       768**DCL      3898--ASSIGN
GLOBAL.TIME.TIME
       767**DCL      3897--ASSIGN
GLOBAL.TIME.TSTAMP
       765**DCL      3887--ASSIGN   3895--ASSIGN
GLOBAL.TIME$
       814**DCL      3884<<ASSIGN
GLOBAL.TIMEC$
       815**DCL      3892<<ASSIGN
GLOBAL.TRTN$
       822**DCL      3925<<ASSIGN
GLOBAL.TRUNC$
       816**DCL      3905<<ASSIGN
GLOBAL.VLP$
       809**DCL      3803<<ASSIGN   3804>>ASSIGN   3811>>ASSIGN   3819>>ASSIGN
GLOBAL.WRITE$
       810**DCL      3720<<ASSIGN
GLOBAL.WRTD$
       795**DCL      3655<<ASSIGN
GLOBAL.WRTI$
       797**DCL      3689<<ASSIGN
GLOBAL.WRTJ$
       812**DCL      3737<<ASSIGN
GLOBAL.WRTK$
       799**DCL      3762<<ASSIGN
GLOBAL$
       836**DCL       532--IMP-PTR  3574>>ASSIGN   3576>>ASSIGN   3577>>ASSIGN   3579>>ASSIGN   3580>>ASSIGN
      3581>>ASSIGN   3582>>ASSIGN   3586>>ASSIGN   3592>>ASSIGN   3600>>ASSIGN   3603>>ASSIGN   3604>>ASSIGN
      3610>>ASSIGN   3613>>ASSIGN   3614>>ASSIGN   3621>>ASSIGN   3628>>ASSIGN   3631>>ASSIGN   3632>>ASSIGN
      3637>>ASSIGN   3644>>ASSIGN   3647>>ASSIGN   3655>>ASSIGN   3658>>ASSIGN   3676>>ASSIGN   3679>>ASSIGN
      3680>>ASSIGN   3689>>ASSIGN   3692>>ASSIGN   3699>>ASSIGN   3702>>ASSIGN   3703>>ASSIGN   3711>>ASSIGN
      3714>>ASSIGN   3720>>ASSIGN   3723>>ASSIGN   3729>>ASSIGN   3732>>ASSIGN   3737>>ASSIGN   3740>>ASSIGN
      3745>>ASSIGN   3753>>ASSIGN   3756>>ASSIGN   3762>>ASSIGN   3765>>ASSIGN   3772>>ASSIGN   3775>>ASSIGN
      3782>>ASSIGN   3785>>ASSIGN   3790>>ASSIGN   3797>>ASSIGN   3803>>ASSIGN   3804>>ASSIGN   3808>>ASSIGN
      3811>>ASSIGN   3816>>ASSIGN   3819>>ASSIGN   3824>>ASSIGN   3827>>ASSIGN   3833>>ASSIGN   3843>>ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:113  
      3852>>ASSIGN   3855>>ASSIGN   3860>>ASSIGN   3868>>ASSIGN   3877>>ASSIGN   3884>>ASSIGN   3887>>ASSIGN
      3892>>ASSIGN   3895>>ASSIGN   3896>>ASSIGN   3897>>ASSIGN   3898>>ASSIGN   3905>>ASSIGN   3912>>ASSIGN
      3915>>ASSIGN   3916>>ASSIGN   3917>>ASSIGN   3918>>ASSIGN   3919>>ASSIGN   3925>>ASSIGN   3934>>ASSIGN
      3936>>ASSIGN   3937>>ASSIGN   3942>>ASSIGN   3945>>ASSIGN   3950>>ASSIGN   3952>>ASSIGN   3959>>ASSIGN
      3963>>ASSIGN   3965>>ASSIGN   3968<>CALL     3973>>ASSIGN   3974>>ASSIGN   3981>>ASSIGN   3982>>ASSIGN
      3984>>ASSIGN   3984>>ASSIGN   3986>>IF       3986>>IF       3988>>ASSIGN   3995>>ASSIGN
INIT_ERR
      3995**LABEL    3568--CALLALT  3968--CALLALT  3977--CALLALT  3978--CALLALT  3979--CALLALT  3980--CALLALT
J
        17**DCL      3575<<DOINDEX  3576>>ASSIGN   3577>>ASSIGN   3985<<DOINDEX  3986>>IF       3988>>ASSIGN
M$DO
        11**DCL      3920>>ASSIGN
M$EVENT
      1460**DCL-ENT  3979--CALL
M$GDS
      1440**DCL-ENT  3568--CALL
M$INT
      1460**DCL-ENT  3977--CALL
M$TRAP
      1459**DCL-ENT  3980--CALL
M$XCON
      1460**DCL-ENT  3978--CALL
NEEDBUFS
        18**DCL      3966<<ASSIGN   3967>>IF       3968>>CALL
NO_TRACE
      3990**LABEL    3983--CALLALT
RINDEX
        42**DCL      3846--ASSIGN   3863--ASSIGN
SC775
      1506**DCL      2200--DCLINIT
SEGMENT
        37**DCL      3574<<ASSIGN
SHALL
        39**DCL      3836--ASSIGN
SIZE
        36**DCL        38--IMP-SIZ  3573<<ASSIGN   3574>>ASSIGN
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:114  
SSORG
        20**DCL        21--DCLINIT
SSORG$
        21**DCL        22--IMP-PTR  3958>>ASSIGN
SSS$CNTXT
        23**DCL      3958<<ASSIGN   3961--ASSIGN
SSS_CNTXT
        22**DCL      3958>>ASSIGN
VLP$ALTKEYS
      3537**DCL      3588--ASSIGN
VLP$ALTKEYS.SIZ#
      3537**DCL      3587<<ASSIGN
VLP$VECTOR
      3552**DCL      3804--ASSIGN   3811--ASSIGN   3819--ASSIGN
VLP$VECTOR.W2
      3553**DCL      3554--REDEF
VLP_VECTOR.W2
      2215**DCL      2216--REDEF
ZIB$FIXPR5
        25**DCL-ENT  3569--CALL
ZIB$ICALT
        30**DCL-ENT    32--DCLINIT
ZIB$ICALT_EPTR
        32**DCL        33--REDEF
ZIB$ICALT_REDEF.HW1
        34**DCL      3928>>ASSIGN
ZID$STATS
        29**DCL-ENT  3975--CALL
ZIO$ADDBUF
        28**DCL-ENT  3969--CALL
ZIO$DFLTOPN
        31**DCL-ENT  3983--CALL
ZIO$EVENT
        24**DCL-ENT  2030--DCLINIT  2046--DCLINIT  2060--DCLINIT  2085--DCLINIT  2085--DCLINIT
ZIO$GETSEG
        27**DCL-ENT  3968--CALL
PL6.E3A0      #001=ZIO$INIT File=ZIM$INIT.:ZIC0TSI                               FRI 09/05/97 12:58 Page:115  
ZITSSSSIZ
        19**DCL        22--IMP-SIZ    23--IMP-SIZ  3958>>ASSIGN   3958>>ASSIGN   3961>>ASSIGN
ZI_WAITIO
      3561**DCL      3660>>IF
