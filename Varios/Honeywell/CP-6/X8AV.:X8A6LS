VERSION A06

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:1    
        1        1        /*M* X8AV$VALID_DATA - Validates data for the accept statement      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: X8AV$VALID_DATA
        9        9             PURPOSE:
       10       10                 To take the input data as given and attempt to fit this
       11       11                 data to the form expected by the receiving feild.
       12       12        */
       13       13        X8AV$VALID_DATA: PROC ( RESULT$, RES_DSC ) ALTRET;
       14       14
       15       15            %INCLUDE X8A_LIBCOM;
       16      235            %INCLUDE X8A_ERRCOM;
       17      324            %INCLUDE X8A_MACROS;
       18      581            %INCLUDE X9A_MACROS;
       19      612            %INCLUDE X9A_TYPES;
       20     4161            %INCLUDE Z8E_WINDOW;
       21     6231            %INCLUDE X8A_TABLES;
       22     6322            %EQU STOP_SCAN = 1;
       23     6323
       24     6324    1       DCL X9MV                  ENTRY(4) ALTRET;
       25     6325    1       DCL X8AV$CREATE_NUM_DESC  ENTRY(3) ALTRET;
       26     6326    1       DCL X8ER$ERROR            ENTRY(3);
       27     6327
       28     6328    1       DCL RESULT$               PTR;
       29     6329    1       DCL RESULT                CHAR(RES_DSC.D_WORD.DES_W.NDSC.N) BASED(RESULT$);
       30     6330    1       DCL 1 RES_DSC         ALIGNED,
       31     6331                  %DCL_RT_DESC;
       32     6353            %DCL_NUM_DESC_LIB(@NAME=DSC);
       33     6364    1       DCL CHAR_EXP              CHAR(1) ALIGNED;
       34     6365    1       DCL 1 NUMERIC_EXP REDEF   CHAR_EXP  ALIGNED,
       35     6366    1            2 *                  BIT(1)    UNAL,
       36     6367    1            2 EXP                SBIN(8)   UNAL;
       37     6368    1       DCL SEND_EXP              SBIN WORD;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:2    
       38     6369    1       DCL SEND_FLD              CHAR(65);
       39     6370    1       DCL SEND_LEN              SBIN WORD;
       40     6371    1       DCL OVP_SIGN              CHAR(1);
       41     6372    1       DCL TRAIL_SIGN            CHAR(1);
       42     6373    1       DCL TRAIL_COL             SBIN WORD;
       43     6374    1       DCL OVPNUM               CHAR(1);
       44     6375    1       DCL 1 SEND_DESC           ALIGNED,
       45     6376                  %DESCRIPTOR(ENDING=YES);
       46     6404    1       DCL 1 REC_DESC            ALIGNED,
       47     6405                  %DESCRIPTOR(ENDING=YES);
       48     6433    1       DCL OPUNCH_SCAN_TABLE(0:511)  UBIN(9) UNAL CONSTANT INIT(
       49     6434    1           0 * 65,
       50     6435    1           %STOP_SCAN * 18,             /* A-R */
       51     6436    1           0 * 14,
       52     6437    1           %STOP_SCAN * 18,             /* a-r */
       53     6438    1           0 * 8,
       54     6439    1           %STOP_SCAN,                  /* left brace */
       55     6440    1           0,
       56     6441    1           %STOP_SCAN,                  /* right brace */
       57     6442    1           0 * 386);
       58     6443    1       DCL SIGN_SCAN_TABLE(0:511) UBIN(9) UNAL CONSTANT INIT(
       59     6444    1           0 * 43,
       60     6445    1           %STOP_SCAN,           /* + */
       61     6446    1           0,
       62     6447    1           %STOP_SCAN,           /* - */
       63     6448    1           0 * 466      );
       64     6449    1       DCL COL       SBIN;
       65     6450    1       DCL CLASS     SBIN;
       66     6451    1       DCL LAST_COL  SBIN;
       67     6452    1       DCL LENGTH    SBIN WORD;
       68     6453    1       DCL SYMBOL    CHAR(80);
       69     6454    1       DCL SIGN_TYPE BIT(2) ALIGNED;
       70     6455
       71     6456
       72     6457    2       DO CASE ( RES_DSC.D_WORD.DES_W.TYPE );
       73     6458
       74     6459    2         CASE ( %UNPACK_FIXED_NO_SIGN, %UNPACK_FIXED_LEAD_SIGN,
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:3    
       75     6460    2                %UNPACK_FLOAT_LEAD_SIGN, %PACK_FIXED_NO_SIGN,
       76     6461    2                %PACK_FIXED_LEAD_SIGN_EBCDIC,
       77     6462    2                %PACK_FLOAT_LEAD_SIGN, %PACK_FIXED_LEAD_SIGN );
       78     6463
       79     6464    2           CALL BUILD_NUM
       80     6465    2           WHENALTRETURN
       81     6466    3             DO;
       82     6467    3               ALTRETURN;
       83     6468    3             END;
       84     6469        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:4    
       85     6470    2         CASE ( %UNPACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN,
       86     6471    2                %PACK_FIXED_TRAIL_SIGN_EBCDIC );
       87     6472
       88     6473        /*      scan off the trailing sign if it exists.                  */
       89     6474
       90     6475    2          LAST_COL = 0;
       91     6476               %SCAN_SEARCH( TABLE = SIGN_SCAN_TABLE, SYMBOL = IN_TEMP );
       92     6483    2          IF  COL < 80
       93     6484    2          AND SUBSTR( IN_TEMP, COL+1, 1 ) = ' ' THEN
       94     6485    3            DO;
       95     6486    3              TRAIL_SIGN = SUBSTR( IN_TEMP, COL, 1 );
       96     6487    3              TRAIL_COL = COL;
       97     6488    3              LAST_COL  = 0;
       98     6489    3              SYMBOL = IN_TEMP;
       99     6490                   %SKIP_LEADING_SPACES;
      100     6523    3              CALL CONCAT( IN_TEMP, TRAIL_SIGN,
      101     6524    3                   SUBSTR( SYMBOL,  COL, TRAIL_COL - COL ) );
      102     6525    3            END;
      103     6526
      104     6527    2         CALL BUILD_NUM
      105     6528    2           WHENALTRETURN
      106     6529    3             DO;
      107     6530    3               ALTRETURN;
      108     6531    3             END;
      109     6532        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:5    
      110     6533    2         CASE( %UNPACK_FIXED_LEAD_OPUNCH_SIGN,
      111     6534    2               %UNPACK_FIXED_TRAIL_OPUNCH_SIGN );
      112     6535
      113     6536        /*
      114     6537             Remove overpunched sign from input data(if it exists).
      115     6538        */
      116     6539    2           LAST_COL = 0;
      117     6540                %SCAN_SEARCH ( TABLE=OPUNCH_SCAN_TABLE, SYMBOL = IN_TEMP );
      118     6547    2           IF COL < 80 THEN
      119     6548    3             DO;
      120     6549    3               IF COL > 0 THEN     /* check position of overpunch */
      121     6550    3                 IF SUBSTR( IN_TEMP,COL+1,1 ) = ' '
      122     6551    3                 OR SUBSTR( IN_TEMP,COL-1,1 ) = ' '
      123     6552    3                 OR ( COL = 1 AND SUBSTR( IN_TEMP,COL-1,1 ) = '.' )
      124     6553    3                 OR ( COL > 1 AND SUBSTR( IN_TEMP,COL-2,2 ) = ' .' ) THEN;
      125     6554    3                 ELSE  /* overpunch was in the middle */
      126     6555    4                   DO;
      127     6556    4                     CALL X8ER$ERROR( %NO_DATA );
      128     6557    4                     ALTRETURN;
      129     6558    4                   END;
      130     6559                    %REMOVE_OVP( @OVRCHR = "SUBSTR( IN_TEMP,COL,1 )");
      131     6601    3               SUBSTR( IN_TEMP,COL,1 ) = OVPNUM;
      132     6602                    %SCAN_SEARCH( TABLE = SIGN_SCAN_TABLE, SYMBOL = IN_TEMP );
      133     6609    3               IF COL < 80 THEN
      134     6610    4                 DO;
      135     6611    4                   CALL X8ER$ERROR( %OVERPUNCH_ERROR );
      136     6612    4                   ALTRETURN;
      137     6613    4                 END;
      138     6614    3             END;
      139     6615    2           ELSE
      140     6616    2             OVP_SIGN = ' ';
      141     6617
      142     6618        /*
      143     6619             Treat as normal number from here on
      144     6620        */
      145     6621    2        CALL BUILD_NUM
      146     6622    2        WHENALTRETURN
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:6    
      147     6623    3          DO;
      148     6624    3            ALTRETURN;
      149     6625    3          END;
      150     6626        /*
      151     6627                Add the overpunch character back into the number.
      152     6628        */
      153     6629    2           IF OVP_SIGN = ' ' THEN
      154     6630    2             OVP_SIGN =DSC.MANTISSA_SIGN;
      155     6631    2           IF RES_DSC.D_WORD.DES_W.TYPE = %UNPACK_FIXED_LEAD_OPUNCH_SIGN THEN
      156     6632                  %ADD_OVP( @OVRCHR = "SUBSTR(RESULT,0,1)");
      157     6648    2           ELSE
      158     6649                  %ADD_OVP( @OVRCHR = "SUBSTR(RESULT,RES_DSC.D_WORD.DES_W.NDSC.N -1,1)");
      159     6665
      160     6666    2       END ;  /* case result_desc.type */
      161     6667        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:7    
      162     6668    1     BUILD_NUM: PROC ALTRET;
      163     6669
      164     6670    2       SEND_EXP = 0;
      165     6671
      166     6672    2           CALL X8AV$CREATE_NUM_DESC( IN_TEMP, 80, DSC )
      167     6673    2           WHENALTRETURN
      168     6674    3             DO;
      169     6675    3               CALL X8ER$ERROR( %NO_DATA );
      170     6676    3               ALTRETURN;
      171     6677    3             END;
      172     6678
      173     6679    2           SUBSTR( SEND_FLD,0,1 ) = DSC.MANTISSA_SIGN;
      174     6680
      175     6681    2           SUBSTR( SEND_FLD,1,DSC.DIGITS_LEFT ) =
      176     6682    2              SUBSTR( IN_TEMP,DSC.LEFT_POS,DSC.DIGITS_LEFT );
      177     6683    2           SUBSTR( SEND_FLD,DSC.DIGITS_LEFT + 1, DSC.DIGITS_RIGHT ) =
      178     6684    2              SUBSTR( IN_TEMP,DSC.RIGHT_POS,DSC.DIGITS_RIGHT );
      179     6685
      180     6686    2           IF DSC.DIGITS_EXP > 0 THEN
      181     6687    3             DO;
      182     6688    3               CALL CHARBIN( SEND_EXP, SUBSTR( IN_TEMP,DSC.EXP_POS,DSC.DIGITS_EXP ));
      183     6689    3               IF DSC.EXP_SIGN = %MINUS_SIGN  THEN
      184     6690    3                 SEND_EXP = SEND_EXP * -1;
      185     6691    3             END;
      186     6692    2           SEND_EXP = SEND_EXP - DSC.DIGITS_RIGHT;
      187     6693    2           IF SEND_EXP > 127 THEN
      188     6694    3             DO;
      189     6695    3               SEND_EXP = 127;
      190     6696    3               CALL X8ER$ERROR( %EXP_TOO_BIG );
      191     6697    3             END;
      192     6698    2           ELSE
      193     6699    2             IF SEND_EXP < -128 THEN
      194     6700    3               DO;
      195     6701    3                 SEND_EXP = -128;
      196     6702    3                 CALL X8ER$ERROR( %EXP_TOO_SMALL );
      197     6703    3               END;
      198     6704    2           NUMERIC_EXP.EXP = SEND_EXP;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:8    
      199     6705    2           SEND_LEN = DSC.DIGITS_RIGHT + DSC.DIGITS_LEFT + 1;
      200     6706    2           IF SEND_LEN = 1 THEN
      201     6707    3             DO;                    /* no digits were entered */
      202     6708    3               CALL X8ER$ERROR( %NO_DATA );
      203     6709    3               ALTRETURN;
      204     6710    3             END;
      205     6711    2           SUBSTR( SEND_FLD, SEND_LEN, 1 ) = CHAR_EXP;
      206     6712    2           SEND_LEN = SEND_LEN + 1;
      207     6713
      208     6714        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:9    
      209     6715        /*
      210     6716                   Build sending and receiving EIS descriptors for the mvn.
      211     6717        */
      212     6718
      213     6719                %PACK_NDSC ( @DESC       = SEND_DESC,
      214     6720                             @SA         = 0,
      215     6721                             @LENGTH     = "SEND_LEN - 2",
      216     6722                             @CN         = 0,
      217     6723                             @TN         = %NDSC9,
      218     6724                             @SIGN       = %FLOATING_POINT_LEADING_SIGN,
      219     6725                             @SCALE      = 0          );
      220     6774
      221     6775    2           REC_DESC = SEND_DESC;
      222     6776    2           REC_DESC.NDSC.N = RES_DSC.D_WORD.DES_W.NDSC.N ;
      223     6777    2           CALL GET_SIGN_TYPE( RES_DSC.D_WORD.DES_W.TYPE, SIGN_TYPE );
      224     6778    2           REC_DESC.NDSC.S = SIGN_TYPE;
      225     6779    2           REC_DESC.NDSC.SF = RES_DSC.D_WORD.DES_W.NDSC.SF;
      226     6780
      227     6781    2           CALL X9MV ( SEND_DESC, REC_DESC, RESULT$, ADDR( SEND_FLD ) )
      228     6782    2           WHENALTRETURN
      229     6783    3             DO;
      230     6784    3               CALL X8ER$ERROR( %OVERFLOW_TRUNCATION );
      231     6785    3             END;
      232     6786    2     END BUILD_NUM; /* proc */
      233     6787        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:10   
      234     6788    1     GET_SIGN_TYPE: PROC( TYPE, SIGN );
      235     6789
      236     6790    2       DCL TYPE UBIN(18);
      237     6791    2       DCL SIGN BIT(2) ALIGNED;
      238     6792
      239     6793    3       DO CASE( TYPE );
      240     6794
      241     6795    3         CASE ( %UNPACK_FIXED_LEAD_SIGN, %PACK_FIXED_LEAD_SIGN );
      242     6796    3           SIGN = %LEADING_SIGN;
      243     6797
      244     6798    3         CASE ( %UNPACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN,
      245     6799    3                %PACK_FIXED_TRAIL_SIGN_EBCDIC );
      246     6800    3           SIGN = %TRAILING_SIGN;
      247     6801
      248     6802    3         CASE ( %UNPACK_FLOAT_LEAD_SIGN, %PACK_FLOAT_LEAD_SIGN );
      249     6803    3           SIGN = %FLOATING_POINT_LEADING_SIGN;
      250     6804
      251     6805    3         CASE ( %UNPACK_FIXED_NO_SIGN, %UNPACK_FIXED_LEAD_OPUNCH_SIGN,
      252     6806    3                %UNPACK_FIXED_TRAIL_OPUNCH_SIGN, %PACK_FIXED_NO_SIGN );
      253     6807    3           SIGN = %NO_SIGN;
      254     6808
      255     6809    3         CASE ( ELSE );
      256     6810    3           CALL X8ER$ERROR( %UNEXPECTED_CASE, 'X8AV:GET_SIGN_TYPE', 18 );
      257     6811
      258     6812    3       END; /* case type */
      259     6813    2     END GET_SIGN_TYPE;  /* proc */
      260     6814    1   END X8AV$VALID_DATA;
      261     6815        %EOD;

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:11   
--  Include file information  --

   X8A_TABLES.:X8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   B$OBJECT_C.:LIB_E04  is referenced.
   X9A_TYPES.:X8A6TOU  is referenced.
   X9A_MACROS.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X8AV$VALID_DATA.

   Procedure X8AV$VALID_DATA requires 930 words for executable code.
   Procedure X8AV$VALID_DATA requires 132 words of local(AUTO) storage.

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:12   

 Object Unit name= X8AV$VALID_DATA                            File name= X8AV.:X8A6TOU
 UTS= AUG 09 '97 10:43:29.48 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none    20     24  LIBCOM
    1  LblCom even  none     1      1  DEC_OR_COMMA
    2  LblCom even  none    20     24  IN_TEMP
    3  LblCom even  none     1      1  OVRCHR
    4  LblCom even  none     1      1  SELECT_TIME
    5  LblCom even  none     1      1  NO_ADVANCE_OFFSET
    6  LblCom even  none    18     22  DSPLY_SAVE
    7  LblCom even  none     3      3  D_DATE
    8  LblCom even  none     3      3  D_TIME
    9  LblCom even  none     1      1  D_DAY
   10  LblCom even  none     2      2  C_DATE
   11  LblCom even  none     2      2  C_TIME
   12  LblCom even  none     2      2  C_DAY
   13  LblCom even  none     1      1  RTHOLD2
   14  LblCom even  none     1      1  LTHOLD2
   15  LblCom even  none     1      1  NDX2
   16  LblCom even  none     1      1  IN_LEN
   17  RoData even  UTS    520   1010  X8AV$VALID_DATA
   18   Proc  even  none   930   1642  X8AV$VALID_DATA
   19  RoData even  none    83    123  X8AV$VALID_DATA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    18      0   yes    yes     yes      Std        2  X8AV$VALID_DATA
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 X8ER$ERROR
 yes     yes           Std       3 X8AV$CREATE_NUM_DESC
 yes     yes           Std       4 X9MV
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:14   


        1        1        /*M* X8AV$VALID_DATA - Validates data for the accept statement      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: X8AV$VALID_DATA
        9        9             PURPOSE:
       10       10                 To take the input data as given and attempt to fit this
       11       11                 data to the form expected by the receiving feild.
       12       12        */
       13       13        X8AV$VALID_DATA: PROC ( RESULT$, RES_DSC ) ALTRET;

     13 18 000000   000000 700200 xent  X8AV$VALID_* TSX0  ! X66_AUTO_2
        18 000001   000204 000002                    ZERO    132,2

       14       14
       15       15            %INCLUDE X8A_LIBCOM;
       16      235            %INCLUDE X8A_ERRCOM;
       17      324            %INCLUDE X8A_MACROS;
       18      581            %INCLUDE X9A_MACROS;
       19      612            %INCLUDE X9A_TYPES;
       20     4161            %INCLUDE Z8E_WINDOW;
       21     6231            %INCLUDE X8A_TABLES;
       22     6322            %EQU STOP_SCAN = 1;
       23     6323
       24     6324    1       DCL X9MV                  ENTRY(4) ALTRET;
       25     6325    1       DCL X8AV$CREATE_NUM_DESC  ENTRY(3) ALTRET;
       26     6326    1       DCL X8ER$ERROR            ENTRY(3);
       27     6327
       28     6328    1       DCL RESULT$               PTR;
       29     6329    1       DCL RESULT                CHAR(RES_DSC.D_WORD.DES_W.NDSC.N) BASED(RESULT$);
       30     6330    1       DCL 1 RES_DSC         ALIGNED,
       31     6331                  %DCL_RT_DESC;
       32     6353            %DCL_NUM_DESC_LIB(@NAME=DSC);
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:15   
       33     6364    1       DCL CHAR_EXP              CHAR(1) ALIGNED;
       34     6365    1       DCL 1 NUMERIC_EXP REDEF   CHAR_EXP  ALIGNED,
       35     6366    1            2 *                  BIT(1)    UNAL,
       36     6367    1            2 EXP                SBIN(8)   UNAL;
       37     6368    1       DCL SEND_EXP              SBIN WORD;
       38     6369    1       DCL SEND_FLD              CHAR(65);
       39     6370    1       DCL SEND_LEN              SBIN WORD;
       40     6371    1       DCL OVP_SIGN              CHAR(1);
       41     6372    1       DCL TRAIL_SIGN            CHAR(1);
       42     6373    1       DCL TRAIL_COL             SBIN WORD;
       43     6374    1       DCL OVPNUM               CHAR(1);
       44     6375    1       DCL 1 SEND_DESC           ALIGNED,
       45     6376                  %DESCRIPTOR(ENDING=YES);
       46     6404    1       DCL 1 REC_DESC            ALIGNED,
       47     6405                  %DESCRIPTOR(ENDING=YES);
       48     6433    1       DCL OPUNCH_SCAN_TABLE(0:511)  UBIN(9) UNAL CONSTANT INIT(
       49     6434    1           0 * 65,
       50     6435    1           %STOP_SCAN * 18,             /* A-R */
       51     6436    1           0 * 14,
       52     6437    1           %STOP_SCAN * 18,             /* a-r */
       53     6438    1           0 * 8,
       54     6439    1           %STOP_SCAN,                  /* left brace */
       55     6440    1           0,
       56     6441    1           %STOP_SCAN,                  /* right brace */
       57     6442    1           0 * 386);
       58     6443    1       DCL SIGN_SCAN_TABLE(0:511) UBIN(9) UNAL CONSTANT INIT(
       59     6444    1           0 * 43,
       60     6445    1           %STOP_SCAN,           /* + */
       61     6446    1           0,
       62     6447    1           %STOP_SCAN,           /* - */
       63     6448    1           0 * 466      );
       64     6449    1       DCL COL       SBIN;
       65     6450    1       DCL CLASS     SBIN;
       66     6451    1       DCL LAST_COL  SBIN;
       67     6452    1       DCL LENGTH    SBIN WORD;
       68     6453    1       DCL SYMBOL    CHAR(80);
       69     6454    1       DCL SIGN_TYPE BIT(2) ALIGNED;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:16   
       70     6455
       71     6456
       72     6457    2       DO CASE ( RES_DSC.D_WORD.DES_W.TYPE );

   6457 18 000002   200004 470500                    LDP0    @RES_DSC,,AUTO
        18 000003   000001 236100                    LDQ     1,,PR0
        18 000004   000022 772000                    QRL     18
        18 000005   000011 136007                    SBLQ    9,DL
        18 000006   000053 116007                    CMPQ    43,DL
        18 000007   000011 602006 18                 TNC     s:6457+7,QL
        18 000010   001300 710000 18                 TRA     s:6666
        18 000011   000064 710000 18                 TRA     s:6464
        18 000012   000064 710000 18                 TRA     s:6464
        18 000013   001300 710000 18                 TRA     s:6666
        18 000014   001300 710000 18                 TRA     s:6666
        18 000015   001300 710000 18                 TRA     s:6666
        18 000016   001300 710000 18                 TRA     s:6666
        18 000017   001300 710000 18                 TRA     s:6666
        18 000020   001300 710000 18                 TRA     s:6666
        18 000021   001300 710000 18                 TRA     s:6666
        18 000022   001300 710000 18                 TRA     s:6666
        18 000023   001300 710000 18                 TRA     s:6666
        18 000024   001300 710000 18                 TRA     s:6666
        18 000025   001300 710000 18                 TRA     s:6666
        18 000026   001300 710000 18                 TRA     s:6666
        18 000027   001300 710000 18                 TRA     s:6666
        18 000030   001300 710000 18                 TRA     s:6666
        18 000031   000071 710000 18                 TRA     s:6475
        18 000032   001300 710000 18                 TRA     s:6666
        18 000033   001300 710000 18                 TRA     s:6666
        18 000034   001300 710000 18                 TRA     s:6666
        18 000035   001300 710000 18                 TRA     s:6666
        18 000036   001300 710000 18                 TRA     s:6666
        18 000037   000071 710000 18                 TRA     s:6475
        18 000040   001300 710000 18                 TRA     s:6666
        18 000041   001300 710000 18                 TRA     s:6666
        18 000042   001300 710000 18                 TRA     s:6666
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:17   
        18 000043   001300 710000 18                 TRA     s:6666
        18 000044   001300 710000 18                 TRA     s:6666
        18 000045   001300 710000 18                 TRA     s:6666
        18 000046   001300 710000 18                 TRA     s:6666
        18 000047   001300 710000 18                 TRA     s:6666
        18 000050   000064 710000 18                 TRA     s:6464
        18 000051   000064 710000 18                 TRA     s:6464
        18 000052   000064 710000 18                 TRA     s:6464
        18 000053   000071 710000 18                 TRA     s:6475
        18 000054   000212 710000 18                 TRA     s:6539
        18 000055   000212 710000 18                 TRA     s:6539
        18 000056   001300 710000 18                 TRA     s:6666
        18 000057   001300 710000 18                 TRA     s:6666
        18 000060   001300 710000 18                 TRA     s:6666
        18 000061   001300 710000 18                 TRA     s:6666
        18 000062   000064 710000 18                 TRA     s:6464
        18 000063   000064 710000 18                 TRA     s:6464

       73     6458
       74     6459    2         CASE ( %UNPACK_FIXED_NO_SIGN, %UNPACK_FIXED_LEAD_SIGN,

       75     6460    2                %UNPACK_FLOAT_LEAD_SIGN, %PACK_FIXED_NO_SIGN,
       76     6461    2                %PACK_FIXED_LEAD_SIGN_EBCDIC,
       77     6462    2                %PACK_FLOAT_LEAD_SIGN, %PACK_FIXED_LEAD_SIGN );
       78     6463
       79     6464    2           CALL BUILD_NUM

   6464 18 000064   001301 701000 18                 TSX1    BUILD_NUM
        18 000065   000067 702000 18                 TSX2    s:6467
        18 000066   000070 710000 18                 TRA     s:6467+1

       80     6465    2           WHENALTRETURN
       81     6466    3             DO;

       82     6467    3               ALTRETURN;

   6467 18 000067   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:18   
        18 000070   001300 710000 18                 TRA     s:6666

       83     6468    3             END;
       84     6469        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:19   
       85     6470    2         CASE ( %UNPACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN,

       86     6471    2                %PACK_FIXED_TRAIL_SIGN_EBCDIC );
       87     6472
       88     6473        /*      scan off the trailing sign if it exists.                  */
       89     6474
       90     6475    2          LAST_COL = 0;

   6475 18 000071   200141 450100                    STZ     LAST_COL,,AUTO

       91     6476               %SCAN_SEARCH( TABLE = SIGN_SCAN_TABLE, SYMBOL = IN_TEMP );

   6477 18 000072   200141 720100                    LXL0    LAST_COL,,AUTO
        18 000073   777657 620010                    EAX0    -81,X0
        18 000074   777777 660003                    ERX0    -1,DU
        18 000075   200141 236100                    LDQ     LAST_COL,,AUTO
        18 000076   000000 164446                    TCT
        18 000077   000000 000010 2                  ADSC9   IN_TEMP,Q                cn=0,n=*X0
        18 000100   000600 000000 17                 ARG     SIGN_SCAN_TABLE
        18 000101   200137 000100                    ARG     COL,,AUTO
        18 000102   200137 235100                    LDA     COL,,AUTO
        18 000103   000033 771000                    ARL     27
        18 000104   200140 755100                    STA     CLASS,,AUTO
        18 000105   200137 551140                    STBA    COL,'40'O,AUTO
        18 000106   200137 056100                    ASQ     COL,,AUTO

       92     6483    2          IF  COL < 80

   6483 18 000107   200137 235100                    LDA     COL,,AUTO
        18 000110   000120 115007                    CMPA    80,DL
        18 000111   000205 605000 18                 TPL     s:6527
        18 000112   040000 106405                    CMPC    fill='040'O
        18 000113   000000 200001 2                  ADSC9   IN_TEMP,A                cn=1,n=1
        18 000114   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000115   000205 601000 18                 TNZ     s:6527

       93     6484    2          AND SUBSTR( IN_TEMP, COL+1, 1 ) = ' ' THEN
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:20   
       94     6485    3            DO;

       95     6486    3              TRAIL_SIGN = SUBSTR( IN_TEMP, COL, 1 );

   6486 18 000116   040100 100405                    MLR     fill='040'O
        18 000117   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000120   200132 000001                    ADSC9   TRAIL_SIGN,,AUTO         cn=0,n=1

       96     6487    3              TRAIL_COL = COL;

   6487 18 000121   200133 755100                    STA     TRAIL_COL,,AUTO

       97     6488    3              LAST_COL  = 0;

   6488 18 000122   200141 450100                    STZ     LAST_COL,,AUTO

       98     6489    3              SYMBOL = IN_TEMP;

   6489 18 000123   040100 100400                    MLR     fill='040'O
        18 000124   000000 000120 2                  ADSC9   IN_TEMP                  cn=0,n=80
        18 000125   200143 000120                    ADSC9   SYMBOL,,AUTO             cn=0,n=80

       99     6490                   %SKIP_LEADING_SPACES;

   6493 18 000126   200141 720100                    LXL0    LAST_COL,,AUTO
        18 000127   777657 620010                    EAX0    -81,X0
        18 000130   777777 660003                    ERX0    -1,DU
        18 000131   200141 236100                    LDQ     LAST_COL,,AUTO
        18 000132   000000 164546                    TCT
        18 000133   200143 000010                    ADSC9   SYMBOL,Q,AUTO            cn=0,n=*X0
        18 000134   000000 000000 17                 ARG     ASCII_SEARCH_TABLE
        18 000135   200137 000100                    ARG     COL,,AUTO
        18 000136   200137 235100                    LDA     COL,,AUTO
        18 000137   000033 771000                    ARL     27
        18 000140   200140 755100                    STA     CLASS,,AUTO
        18 000141   200137 551140                    STBA    COL,'40'O,AUTO
        18 000142   200137 056100                    ASQ     COL,,AUTO
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:21   

   6499 18 000143   000042 115007                    CMPA    34,DL
        18 000144   000171 601000 18                 TNZ     s:6523

   6502 18 000145   200137 054100                    AOS     COL,,AUTO

   6505 18 000146   200137 236100                    LDQ     COL,,AUTO
        18 000147   200142 116100                    CMPQ    LENGTH,,AUTO
        18 000150   000153 605000 18                 TPL     s:6508

   6506 18 000151   200141 756100                    STQ     LAST_COL,,AUTO
        18 000152   000154 710000 18                 TRA     s:6512

   6508 18 000153   000000 702200 xent               TSX2  ! X66_ARET

   6512 18 000154   777657 620006                    EAX0    -81,QL
        18 000155   777777 660003                    ERX0    -1,DU
        18 000156   000000 164546                    TCT
        18 000157   200143 000010                    ADSC9   SYMBOL,Q,AUTO            cn=0,n=*X0
        18 000160   000000 000000 17                 ARG     ASCII_SEARCH_TABLE
        18 000161   200137 000100                    ARG     COL,,AUTO
        18 000162   200137 235100                    LDA     COL,,AUTO
        18 000163   000033 771000                    ARL     27
        18 000164   200140 755100                    STA     CLASS,,AUTO
        18 000165   200137 551140                    STBA    COL,'40'O,AUTO
        18 000166   200137 056100                    ASQ     COL,,AUTO

   6520 18 000167   000042 115007                    CMPA    34,DL
        18 000170   000145 600000 18                 TZE     s:6502

      100     6523    3              CALL CONCAT( IN_TEMP, TRAIL_SIGN,

   6523 18 000171   200133 236100                    LDQ     TRAIL_COL,,AUTO
        18 000172   200137 136100                    SBLQ    COL,,AUTO
        18 000173   200176 756100                    STQ     @SIGN+2,,AUTO
        18 000174   200132 236100                    LDQ     TRAIL_SIGN,,AUTO
        18 000175   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:22   
        18 000176   000001 276000 19                 ORQ     1
        18 000177   000000 756000 2                  STQ     IN_TEMP
        18 000200   200176 721100                    LXL1    @SIGN+2,,AUTO
        18 000201   200137 235100                    LDA     COL,,AUTO
        18 000202   040000 100545                    MLR     fill='040'O
        18 000203   200143 000011                    ADSC9   SYMBOL,A,AUTO            cn=0,n=*X1
        18 000204   000000 200117 2                  ADSC9   IN_TEMP                  cn=1,n=79

      101     6524    3                   SUBSTR( SYMBOL,  COL, TRAIL_COL - COL ) );
      102     6525    3            END;

      103     6526
      104     6527    2         CALL BUILD_NUM

   6527 18 000205   001301 701000 18                 TSX1    BUILD_NUM
        18 000206   000210 702000 18                 TSX2    s:6530
        18 000207   000211 710000 18                 TRA     s:6530+1

      105     6528    2           WHENALTRETURN
      106     6529    3             DO;

      107     6530    3               ALTRETURN;

   6530 18 000210   000000 702200 xent               TSX2  ! X66_AALT
        18 000211   001300 710000 18                 TRA     s:6666

      108     6531    3             END;
      109     6532        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:23   
      110     6533    2         CASE( %UNPACK_FIXED_LEAD_OPUNCH_SIGN,

      111     6534    2               %UNPACK_FIXED_TRAIL_OPUNCH_SIGN );
      112     6535
      113     6536        /*
      114     6537             Remove overpunched sign from input data(if it exists).
      115     6538        */
      116     6539    2           LAST_COL = 0;

   6539 18 000212   200141 450100                    STZ     LAST_COL,,AUTO

      117     6540                %SCAN_SEARCH ( TABLE=OPUNCH_SCAN_TABLE, SYMBOL = IN_TEMP );

   6541 18 000213   200141 720100                    LXL0    LAST_COL,,AUTO
        18 000214   777657 620010                    EAX0    -81,X0
        18 000215   777777 660003                    ERX0    -1,DU
        18 000216   200141 236100                    LDQ     LAST_COL,,AUTO
        18 000217   000000 164446                    TCT
        18 000220   000000 000010 2                  ADSC9   IN_TEMP,Q                cn=0,n=*X0
        18 000221   000400 000000 17                 ARG     OPUNCH_SCAN_TABLE
        18 000222   200137 000100                    ARG     COL,,AUTO
        18 000223   200137 235100                    LDA     COL,,AUTO
        18 000224   000033 771000                    ARL     27
        18 000225   200140 755100                    STA     CLASS,,AUTO
        18 000226   200137 551140                    STBA    COL,'40'O,AUTO
        18 000227   200137 056100                    ASQ     COL,,AUTO

      118     6547    2           IF COL < 80 THEN

   6547 18 000230   200137 235100                    LDA     COL,,AUTO
        18 000231   000120 115007                    CMPA    80,DL
        18 000232   000731 605000 18                 TPL     s:6616

      119     6548    3             DO;

      120     6549    3               IF COL > 0 THEN     /* check position of overpunch */

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:24   
   6549 18 000233   000000 115003                    CMPA    0,DU
        18 000234   000266 604400 18                 TMOZ    s:6560

      121     6550    3                 IF SUBSTR( IN_TEMP,COL+1,1 ) = ' '

   6550 18 000235   040000 106405                    CMPC    fill='040'O
        18 000236   000000 200001 2                  ADSC9   IN_TEMP,A                cn=1,n=1
        18 000237   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000240   000266 600000 18                 TZE     s:6560
        18 000241   040000 106405                    CMPC    fill='040'O
        18 000242   777777 600001 2                  ADSC9   IN_TEMP-1,A              cn=3,n=1
        18 000243   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000244   000266 600000 18                 TZE     s:6560
        18 000245   000001 115007                    CMPA    1,DL
        18 000246   000253 601000 18                 TNZ     s:6550+14
        18 000247   040000 106405                    CMPC    fill='040'O
        18 000250   777777 600001 2                  ADSC9   IN_TEMP-1,A              cn=3,n=1
        18 000251   000002 000001 19                 ADSC9   2                        cn=0,n=1
        18 000252   000266 600000 18                 TZE     s:6560
        18 000253   000001 115007                    CMPA    1,DL
        18 000254   000261 604400 18                 TMOZ    s:6556
        18 000255   040000 106405                    CMPC    fill='040'O
        18 000256   777777 400002 2                  ADSC9   IN_TEMP-1,A              cn=2,n=2
        18 000257   001000 000002 17                 ADSC9   SIGN_SCAN_TABLE+128      cn=0,n=2
        18 000260   000266 600000 18                 TZE     s:6560

      122     6551    3                 OR SUBSTR( IN_TEMP,COL-1,1 ) = ' '
      123     6552    3                 OR ( COL = 1 AND SUBSTR( IN_TEMP,COL-1,1 ) = '.' )
      124     6553    3                 OR ( COL > 1 AND SUBSTR( IN_TEMP,COL-2,2 ) = ' .' ) THEN;
      125     6554    3                 ELSE  /* overpunch was in the middle */
      126     6555    4                   DO;

      127     6556    4                     CALL X8ER$ERROR( %NO_DATA );

   6556 18 000261   000005 630400 19                 EPPR0   5
        18 000262   000003 631400 19                 EPPR1   3
        18 000263   000000 701000 xent               TSX1    X8ER$ERROR
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:25   
        18 000264   000000 011000                    NOP     0

      128     6557    4                     ALTRETURN;

   6557 18 000265   000000 702200 xent               TSX2  ! X66_AALT

      129     6558    4                   END;
      130     6559                    %REMOVE_OVP( @OVRCHR = "SUBSTR( IN_TEMP,COL,1 )");

   6560 18 000266   040000 106405                    CMPC    fill='040'O
        18 000267   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000270   000006 000001 19                 ADSC9   6                        cn=0,n=1
        18 000271   000420 602000 18                 TNC     s:6560+90
        18 000272   000626 600000 18                 TZE     s:6576
        18 000273   040000 106405                    CMPC    fill='040'O
        18 000274   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000275   000007 000001 19                 ADSC9   7                        cn=0,n=1
        18 000276   000355 602000 18                 TNC     s:6560+55
        18 000277   000654 600000 18                 TZE     s:6583
        18 000300   040000 106405                    CMPC    fill='040'O
        18 000301   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000302   000010 000001 19                 ADSC9   8                        cn=0,n=1
        18 000303   000336 602000 18                 TNC     s:6560+40
        18 000304   000654 600000 18                 TZE     s:6583
        18 000305   040000 106405                    CMPC    fill='040'O
        18 000306   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000307   000011 000001 19                 ADSC9   9                        cn=0,n=1
        18 000310   000331 602000 18                 TNC     s:6560+35
        18 000311   000654 600000 18                 TZE     s:6583
        18 000312   040000 106405                    CMPC    fill='040'O
        18 000313   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000314   000012 000001 19                 ADSC9   10                       cn=0,n=1
        18 000315   000324 602000 18                 TNC     s:6560+30
        18 000316   000667 600000 18                 TZE     s:6586
        18 000317   040000 106405                    CMPC    fill='040'O
        18 000320   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000321   000013 000001 19                 ADSC9   11                       cn=0,n=1
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:26   
        18 000322   000701 601000 18                 TNZ     s:6592
        18 000323   000674 710000 18                 TRA     s:6589
        18 000324   040000 106405                    CMPC    fill='040'O
        18 000325   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000326   000014 000001 19                 ADSC9   12                       cn=0,n=1
        18 000327   000701 601000 18                 TNZ     s:6592
        18 000330   000654 710000 18                 TRA     s:6583
        18 000331   040000 106405                    CMPC    fill='040'O
        18 000332   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000333   000015 000001 19                 ADSC9   13                       cn=0,n=1
        18 000334   000701 601000 18                 TNZ     s:6592
        18 000335   000654 710000 18                 TRA     s:6583
        18 000336   040000 106405                    CMPC    fill='040'O
        18 000337   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000340   000016 000001 19                 ADSC9   14                       cn=0,n=1
        18 000341   000350 602000 18                 TNC     s:6560+50
        18 000342   000654 600000 18                 TZE     s:6583
        18 000343   040000 106405                    CMPC    fill='040'O
        18 000344   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000345   000017 000001 19                 ADSC9   15                       cn=0,n=1
        18 000346   000701 601000 18                 TNZ     s:6592
        18 000347   000654 710000 18                 TRA     s:6583
        18 000350   040000 106405                    CMPC    fill='040'O
        18 000351   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000352   000020 000001 19                 ADSC9   16                       cn=0,n=1
        18 000353   000701 601000 18                 TNZ     s:6592
        18 000354   000654 710000 18                 TRA     s:6583
        18 000355   040000 106405                    CMPC    fill='040'O
        18 000356   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000357   000021 000001 19                 ADSC9   17                       cn=0,n=1
        18 000360   000401 602000 18                 TNC     s:6560+75
        18 000361   000626 600000 18                 TZE     s:6576
        18 000362   040000 106405                    CMPC    fill='040'O
        18 000363   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000364   000022 000001 19                 ADSC9   18                       cn=0,n=1
        18 000365   000374 602000 18                 TNC     s:6560+70
        18 000366   000626 600000 18                 TZE     s:6576
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:27   
        18 000367   040000 106405                    CMPC    fill='040'O
        18 000370   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000371   000023 000001 19                 ADSC9   19                       cn=0,n=1
        18 000372   000701 601000 18                 TNZ     s:6592
        18 000373   000654 710000 18                 TRA     s:6583
        18 000374   040000 106405                    CMPC    fill='040'O
        18 000375   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000376   000024 000001 19                 ADSC9   20                       cn=0,n=1
        18 000377   000701 601000 18                 TNZ     s:6592
        18 000400   000626 710000 18                 TRA     s:6576
        18 000401   040000 106405                    CMPC    fill='040'O
        18 000402   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000403   000025 000001 19                 ADSC9   21                       cn=0,n=1
        18 000404   000413 602000 18                 TNC     s:6560+85
        18 000405   000626 600000 18                 TZE     s:6576
        18 000406   040000 106405                    CMPC    fill='040'O
        18 000407   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000410   000026 000001 19                 ADSC9   22                       cn=0,n=1
        18 000411   000701 601000 18                 TNZ     s:6592
        18 000412   000626 710000 18                 TRA     s:6576
        18 000413   040000 106405                    CMPC    fill='040'O
        18 000414   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000415   000027 000001 19                 ADSC9   23                       cn=0,n=1
        18 000416   000701 601000 18                 TNZ     s:6592
        18 000417   000626 710000 18                 TRA     s:6576
        18 000420   040000 106405                    CMPC    fill='040'O
        18 000421   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000422   000030 000001 19                 ADSC9   24                       cn=0,n=1
        18 000423   000511 602000 18                 TNC     s:6560+147
        18 000424   000641 600000 18                 TZE     s:6580
        18 000425   040000 106405                    CMPC    fill='040'O
        18 000426   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000427   000031 000001 19                 ADSC9   25                       cn=0,n=1
        18 000430   000456 602000 18                 TNC     s:6560+120
        18 000431   000641 600000 18                 TZE     s:6580
        18 000432   040000 106405                    CMPC    fill='040'O
        18 000433   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:28   
        18 000434   000032 000001 19                 ADSC9   26                       cn=0,n=1
        18 000435   000444 602000 18                 TNC     s:6560+110
        18 000436   000626 600000 18                 TZE     s:6576
        18 000437   040000 106405                    CMPC    fill='040'O
        18 000440   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000441   000033 000001 19                 ADSC9   27                       cn=0,n=1
        18 000442   000701 601000 18                 TNZ     s:6592
        18 000443   000626 710000 18                 TRA     s:6576
        18 000444   040000 106405                    CMPC    fill='040'O
        18 000445   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000446   000034 000001 19                 ADSC9   28                       cn=0,n=1
        18 000447   000701 602000 18                 TNC     s:6592
        18 000450   000641 600000 18                 TZE     s:6580
        18 000451   040000 106405                    CMPC    fill='040'O
        18 000452   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000453   000035 000001 19                 ADSC9   29                       cn=0,n=1
        18 000454   000701 601000 18                 TNZ     s:6592
        18 000455   000674 710000 18                 TRA     s:6589
        18 000456   040000 106405                    CMPC    fill='040'O
        18 000457   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000460   000036 000001 19                 ADSC9   30                       cn=0,n=1
        18 000461   000476 602000 18                 TNC     s:6560+136
        18 000462   000641 600000 18                 TZE     s:6580
        18 000463   040000 106405                    CMPC    fill='040'O
        18 000464   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000465   000037 000001 19                 ADSC9   31                       cn=0,n=1
        18 000466   000471 602000 18                 TNC     s:6560+131
        18 000467   000641 600000 18                 TZE     s:6580
        18 000470   000701 710000 18                 TRA     s:6592
        18 000471   040000 106405                    CMPC    fill='040'O
        18 000472   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000473   000040 000001 19                 ADSC9   32                       cn=0,n=1
        18 000474   000701 601000 18                 TNZ     s:6592
        18 000475   000641 710000 18                 TRA     s:6580
        18 000476   040000 106405                    CMPC    fill='040'O
        18 000477   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000500   000041 000001 19                 ADSC9   33                       cn=0,n=1
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:29   
        18 000501   000504 602000 18                 TNC     s:6560+142
        18 000502   000641 600000 18                 TZE     s:6580
        18 000503   000701 710000 18                 TRA     s:6592
        18 000504   040000 106405                    CMPC    fill='040'O
        18 000505   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000506   000042 000001 19                 ADSC9   34                       cn=0,n=1
        18 000507   000701 601000 18                 TNZ     s:6592
        18 000510   000641 710000 18                 TRA     s:6580
        18 000511   040000 106405                    CMPC    fill='040'O
        18 000512   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000513   000043 000001 19                 ADSC9   35                       cn=0,n=1
        18 000514   000555 602000 18                 TNC     s:6560+183
        18 000515   000613 600000 18                 TZE     s:6573
        18 000516   040000 106405                    CMPC    fill='040'O
        18 000517   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000520   000044 000001 19                 ADSC9   36                       cn=0,n=1
        18 000521   000536 602000 18                 TNC     s:6560+168
        18 000522   000613 600000 18                 TZE     s:6573
        18 000523   040000 106405                    CMPC    fill='040'O
        18 000524   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000525   000045 000001 19                 ADSC9   37                       cn=0,n=1
        18 000526   000531 602000 18                 TNC     s:6560+163
        18 000527   000641 600000 18                 TZE     s:6580
        18 000530   000701 710000 18                 TRA     s:6592
        18 000531   040000 106405                    CMPC    fill='040'O
        18 000532   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000533   000046 000001 19                 ADSC9   38                       cn=0,n=1
        18 000534   000701 601000 18                 TNZ     s:6592
        18 000535   000613 710000 18                 TRA     s:6573
        18 000536   040000 106405                    CMPC    fill='040'O
        18 000537   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000540   000047 000001 19                 ADSC9   39                       cn=0,n=1
        18 000541   000550 602000 18                 TNC     s:6560+178
        18 000542   000613 600000 18                 TZE     s:6573
        18 000543   040000 106405                    CMPC    fill='040'O
        18 000544   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000545   000050 000001 19                 ADSC9   40                       cn=0,n=1
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:30   
        18 000546   000701 601000 18                 TNZ     s:6592
        18 000547   000613 710000 18                 TRA     s:6573
        18 000550   040000 106405                    CMPC    fill='040'O
        18 000551   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000552   000051 000001 19                 ADSC9   41                       cn=0,n=1
        18 000553   000701 601000 18                 TNZ     s:6592
        18 000554   000613 710000 18                 TRA     s:6573
        18 000555   040000 106405                    CMPC    fill='040'O
        18 000556   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000557   000052 000001 19                 ADSC9   42                       cn=0,n=1
        18 000560   000574 602000 18                 TNC     s:6560+198
        18 000561   000613 600000 18                 TZE     s:6573
        18 000562   040000 106405                    CMPC    fill='040'O
        18 000563   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000564   000053 000001 19                 ADSC9   43                       cn=0,n=1
        18 000565   000701 602000 18                 TNC     s:6592
        18 000566   000613 600000 18                 TZE     s:6573
        18 000567   040000 106405                    CMPC    fill='040'O
        18 000570   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000571   000054 000001 19                 ADSC9   44                       cn=0,n=1
        18 000572   000701 601000 18                 TNZ     s:6592
        18 000573   000613 710000 18                 TRA     s:6573
        18 000574   040000 106405                    CMPC    fill='040'O
        18 000575   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000576   000055 000001 19                 ADSC9   45                       cn=0,n=1
        18 000577   000606 602000 18                 TNC     s:6560+208
        18 000600   000667 600000 18                 TZE     s:6586
        18 000601   040000 106405                    CMPC    fill='040'O
        18 000602   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000603   000056 000001 19                 ADSC9   46                       cn=0,n=1
        18 000604   000701 601000 18                 TNZ     s:6592
        18 000605   000674 710000 18                 TRA     s:6589
        18 000606   040000 106405                    CMPC    fill='040'O
        18 000607   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000610   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000611   000701 601000 18                 TNZ     s:6592
        18 000612   000667 710000 18                 TRA     s:6586
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:31   

   6573 18 000613   000100 101405                    MRL     fill='000'O
        18 000614   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000615   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 000616   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 000617   000020 136007                    SBLQ    16,DL
        18 000620   000033 736000                    QLS     27
        18 000621   000001 276000 19                 ORQ     1
        18 000622   200134 756100                    STQ     OVPNUM,,AUTO

   6574 18 000623   053000 236003                    LDQ     22016,DU
        18 000624   200131 756100                    STQ     OVP_SIGN,,AUTO
        18 000625   000704 710000 18                 TRA     s:6601

   6576 18 000626   000100 101405                    MRL     fill='000'O
        18 000627   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000630   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 000631   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 000632   000060 136007                    SBLQ    48,DL
        18 000633   000033 736000                    QLS     27
        18 000634   000001 276000 19                 ORQ     1
        18 000635   200134 756100                    STQ     OVPNUM,,AUTO

   6577 18 000636   053000 236003                    LDQ     22016,DU
        18 000637   200131 756100                    STQ     OVP_SIGN,,AUTO
        18 000640   000704 710000 18                 TRA     s:6601

   6580 18 000641   000100 101405                    MRL     fill='000'O
        18 000642   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000643   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 000644   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 000645   000031 136007                    SBLQ    25,DL
        18 000646   000033 736000                    QLS     27
        18 000647   000001 276000 19                 ORQ     1
        18 000650   200134 756100                    STQ     OVPNUM,,AUTO

   6581 18 000651   055000 236003                    LDQ     23040,DU
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:32   
        18 000652   200131 756100                    STQ     OVP_SIGN,,AUTO
        18 000653   000704 710000 18                 TRA     s:6601

   6583 18 000654   000100 101405                    MRL     fill='000'O
        18 000655   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1
        18 000656   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 000657   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 000660   000071 136007                    SBLQ    57,DL
        18 000661   000033 736000                    QLS     27
        18 000662   000001 276000 19                 ORQ     1
        18 000663   200134 756100                    STQ     OVPNUM,,AUTO

   6584 18 000664   055000 236003                    LDQ     23040,DU
        18 000665   200131 756100                    STQ     OVP_SIGN,,AUTO
        18 000666   000704 710000 18                 TRA     s:6601

   6586 18 000667   060000 236003                    LDQ     24576,DU
        18 000670   200134 756100                    STQ     OVPNUM,,AUTO

   6587 18 000671   053000 236003                    LDQ     22016,DU
        18 000672   200131 756100                    STQ     OVP_SIGN,,AUTO
        18 000673   000704 710000 18                 TRA     s:6601

   6589 18 000674   060000 236003                    LDQ     24576,DU
        18 000675   200134 756100                    STQ     OVPNUM,,AUTO

   6590 18 000676   055000 236003                    LDQ     23040,DU
        18 000677   200131 756100                    STQ     OVP_SIGN,,AUTO
        18 000700   000704 710000 18                 TRA     s:6601

   6592 18 000701   040000 236003                    LDQ     16384,DU
        18 000702   200134 756100                    STQ     OVPNUM,,AUTO

   6593 18 000703   200131 756100                    STQ     OVP_SIGN,,AUTO

      131     6601    3               SUBSTR( IN_TEMP,COL,1 ) = OVPNUM;

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:33   
   6601 18 000704   040005 100500                    MLR     fill='040'O
        18 000705   200134 000001                    ADSC9   OVPNUM,,AUTO             cn=0,n=1
        18 000706   000000 000001 2                  ADSC9   IN_TEMP,A                cn=0,n=1

      132     6602                    %SCAN_SEARCH( TABLE = SIGN_SCAN_TABLE, SYMBOL = IN_TEMP );

   6603 18 000707   200141 236100                    LDQ     LAST_COL,,AUTO
        18 000710   000000 164446                    TCT
        18 000711   000000 000010 2                  ADSC9   IN_TEMP,Q                cn=0,n=*X0
        18 000712   000600 000000 17                 ARG     SIGN_SCAN_TABLE
        18 000713   200137 000100                    ARG     COL,,AUTO
        18 000714   200137 235100                    LDA     COL,,AUTO
        18 000715   000033 771000                    ARL     27
        18 000716   200140 755100                    STA     CLASS,,AUTO
        18 000717   200137 551140                    STBA    COL,'40'O,AUTO
        18 000720   200137 056100                    ASQ     COL,,AUTO

      133     6609    3               IF COL < 80 THEN

   6609 18 000721   200137 235100                    LDA     COL,,AUTO
        18 000722   000120 115007                    CMPA    80,DL
        18 000723   000733 605000 18                 TPL     s:6621

      134     6610    4                 DO;

      135     6611    4                   CALL X8ER$ERROR( %OVERPUNCH_ERROR );

   6611 18 000724   000060 630400 19                 EPPR0   48
        18 000725   000003 631400 19                 EPPR1   3
        18 000726   000000 701000 xent               TSX1    X8ER$ERROR
        18 000727   000000 011000                    NOP     0

      136     6612    4                   ALTRETURN;

   6612 18 000730   000000 702200 xent               TSX2  ! X66_AALT

      137     6613    4                 END;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:34   
      138     6614    3             END;
      139     6615    2           ELSE
      140     6616    2             OVP_SIGN = ' ';

   6616 18 000731   040000 236003                    LDQ     16384,DU
        18 000732   200131 756100                    STQ     OVP_SIGN,,AUTO

      141     6617
      142     6618        /*
      143     6619             Treat as normal number from here on
      144     6620        */
      145     6621    2        CALL BUILD_NUM

   6621 18 000733   001301 701000 18                 TSX1    BUILD_NUM
        18 000734   000736 702000 18                 TSX2    s:6624
        18 000735   000737 710000 18                 TRA     s:6629

      146     6622    2        WHENALTRETURN
      147     6623    3          DO;

      148     6624    3            ALTRETURN;

   6624 18 000736   000000 702200 xent               TSX2  ! X66_AALT

      149     6625    3          END;
      150     6626        /*
      151     6627                Add the overpunch character back into the number.
      152     6628        */
      153     6629    2           IF OVP_SIGN = ' ' THEN

   6629 18 000737   200131 236100                    LDQ     OVP_SIGN,,AUTO
        18 000740   777000 376003                    ANQ     -512,DU
        18 000741   040000 116003                    CMPQ    16384,DU
        18 000742   000747 601000 18                 TNZ     s:6631

      154     6630    2             OVP_SIGN =DSC.MANTISSA_SIGN;

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:35   
   6630 18 000743   200104 236100                    LDQ     DSC+6,,AUTO
        18 000744   777000 376003                    ANQ     -512,DU
        18 000745   000001 276000 19                 ORQ     1
        18 000746   200131 756100                    STQ     OVP_SIGN,,AUTO

      155     6631    2           IF RES_DSC.D_WORD.DES_W.TYPE = %UNPACK_FIXED_LEAD_OPUNCH_SIGN THEN

   6631 18 000747   200004 470500                    LDP0    @RES_DSC,,AUTO
        18 000750   000001 220100                    LDX0    1,,PR0
        18 000751   000054 100003                    CMPX0   44,DU
        18 000752   001117 601000 18                 TNZ     s:6650

      156     6632                  %ADD_OVP( @OVRCHR = "SUBSTR(RESULT,0,1)");

   6633 18 000753   200003 471500                    LDP1    @RESULT$,,AUTO
        18 000754   100000 473500                    LDP3    0,,PR1
        18 000755   000001 721100                    LXL1    1,,PR0
        18 000756   000077 361003                    ANX1    63,DU
        18 000757   040000 106500                    CMPC    fill='040'O
        18 000760   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 000761   000061 000001 19                 ADSC9   49                       cn=0,n=1
        18 000762   001015 602000 18                 TNC     s:6633+34
        18 000763   001042 600000 18                 TZE     s:6635
        18 000764   040000 106500                    CMPC    fill='040'O
        18 000765   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 000766   000062 000001 19                 ADSC9   50                       cn=0,n=1
        18 000767   001010 602000 18                 TNC     s:6633+29
        18 000770   001042 600000 18                 TZE     s:6635
        18 000771   040000 106500                    CMPC    fill='040'O
        18 000772   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 000773   000063 000001 19                 ADSC9   51                       cn=0,n=1
        18 000774   001003 602000 18                 TNC     s:6633+24
        18 000775   001042 600000 18                 TZE     s:6635
        18 000776   040000 106500                    CMPC    fill='040'O
        18 000777   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001000   000064 000001 19                 ADSC9   52                       cn=0,n=1
        18 001001   001112 601000 18                 TNZ     s:6645
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:36   
        18 001002   001042 710000 18                 TRA     s:6635
        18 001003   040000 106500                    CMPC    fill='040'O
        18 001004   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001005   000065 000001 19                 ADSC9   53                       cn=0,n=1
        18 001006   001112 601000 18                 TNZ     s:6645
        18 001007   001042 710000 18                 TRA     s:6635
        18 001010   040000 106500                    CMPC    fill='040'O
        18 001011   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001012   000066 000001 19                 ADSC9   54                       cn=0,n=1
        18 001013   001112 601000 18                 TNZ     s:6645
        18 001014   001042 710000 18                 TRA     s:6635
        18 001015   040000 106500                    CMPC    fill='040'O
        18 001016   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001017   000067 000001 19                 ADSC9   55                       cn=0,n=1
        18 001020   001027 602000 18                 TNC     s:6633+44
        18 001021   001042 600000 18                 TZE     s:6635
        18 001022   040000 106500                    CMPC    fill='040'O
        18 001023   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001024   000070 000001 19                 ADSC9   56                       cn=0,n=1
        18 001025   001112 601000 18                 TNZ     s:6645
        18 001026   001042 710000 18                 TRA     s:6635
        18 001027   040000 106500                    CMPC    fill='040'O
        18 001030   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001031   000071 000001 19                 ADSC9   57                       cn=0,n=1
        18 001032   001035 602000 18                 TNC     s:6633+50
        18 001033   001042 600000 18                 TZE     s:6635
        18 001034   001112 710000 18                 TRA     s:6645
        18 001035   040000 106500                    CMPC    fill='040'O
        18 001036   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001037   000072 000001 19                 ADSC9   58                       cn=0,n=1
        18 001040   001112 601000 18                 TNZ     s:6645
        18 001041   001076 710000 18                 TRA     s:6640

   6635 18 001042   200131 236100                    LDQ     OVP_SIGN,,AUTO
        18 001043   777000 376003                    ANQ     -512,DU
        18 001044   055000 116003                    CMPQ    23040,DU
        18 001045   001062 601000 18                 TNZ     s:6638
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:37   

   6636 18 001046   000100 101500                    MRL     fill='000'O
        18 001047   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001050   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 001051   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 001052   000031 036007                    ADLQ    25,DL
        18 001053   000033 736000                    QLS     27
        18 001054   000001 276000 19                 ORQ     1
        18 001055   200177 756100                    STQ     @SIGN+3,,AUTO
        18 001056   040100 100500                    MLR     fill='040'O
        18 001057   200177 000004                    ADSC9   @SIGN+3,,AUTO            cn=0,n=4
        18 001060   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001061   001300 710000 18                 TRA     s:6666

   6638 18 001062   000100 101500                    MRL     fill='000'O
        18 001063   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001064   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 001065   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 001066   000020 036007                    ADLQ    16,DL
        18 001067   000033 736000                    QLS     27
        18 001070   000001 276000 19                 ORQ     1
        18 001071   200177 756100                    STQ     @SIGN+3,,AUTO
        18 001072   040100 100500                    MLR     fill='040'O
        18 001073   200177 000004                    ADSC9   @SIGN+3,,AUTO            cn=0,n=4
        18 001074   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001075   001300 710000 18                 TRA     s:6666

   6640 18 001076   200131 236100                    LDQ     OVP_SIGN,,AUTO
        18 001077   777000 376003                    ANQ     -512,DU
        18 001100   055000 116003                    CMPQ    23040,DU
        18 001101   001106 601000 18                 TNZ     s:6643

   6641 18 001102   040100 100400                    MLR     fill='040'O
        18 001103   000013 000001 19                 ADSC9   11                       cn=0,n=1
        18 001104   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001105   001300 710000 18                 TRA     s:6666

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:38   
   6643 18 001106   040100 100400                    MLR     fill='040'O
        18 001107   000012 000001 19                 ADSC9   10                       cn=0,n=1
        18 001110   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        18 001111   001300 710000 18                 TRA     s:6666

   6645 18 001112   000076 630400 19                 EPPR0   62
        18 001113   000073 631400 19                 EPPR1   59
        18 001114   000000 701000 xent               TSX1    X8ER$ERROR
        18 001115   000000 011000                    NOP     0

   6646 18 001116   001300 710000 18                 TRA     s:6666

      157     6648    2           ELSE
      158     6649                  %ADD_OVP( @OVRCHR = "SUBSTR(RESULT,RES_DSC.D_WORD.DES_W.NDSC.N -1,1)");

   6650 18 001117   200003 471500                    LDP1    @RESULT$,,AUTO
        18 001120   100000 473500                    LDP3    0,,PR1
        18 001121   000001 721100                    LXL1    1,,PR0
        18 001122   000077 361003                    ANX1    63,DU
        18 001123   000001 236100                    LDQ     1,,PR0
        18 001124   000077 376007                    ANQ     63,DL
        18 001125   040000 106506                    CMPC    fill='040'O
        18 001126   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001127   000061 000001 19                 ADSC9   49                       cn=0,n=1
        18 001130   001163 602000 18                 TNC     s:6650+36
        18 001131   001210 600000 18                 TZE     s:6652
        18 001132   040000 106506                    CMPC    fill='040'O
        18 001133   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001134   000062 000001 19                 ADSC9   50                       cn=0,n=1
        18 001135   001156 602000 18                 TNC     s:6650+31
        18 001136   001210 600000 18                 TZE     s:6652
        18 001137   040000 106506                    CMPC    fill='040'O
        18 001140   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001141   000063 000001 19                 ADSC9   51                       cn=0,n=1
        18 001142   001151 602000 18                 TNC     s:6650+26
        18 001143   001210 600000 18                 TZE     s:6652
        18 001144   040000 106506                    CMPC    fill='040'O
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:39   
        18 001145   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001146   000064 000001 19                 ADSC9   52                       cn=0,n=1
        18 001147   001274 601000 18                 TNZ     s:6662
        18 001150   001210 710000 18                 TRA     s:6652
        18 001151   040000 106506                    CMPC    fill='040'O
        18 001152   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001153   000065 000001 19                 ADSC9   53                       cn=0,n=1
        18 001154   001274 601000 18                 TNZ     s:6662
        18 001155   001210 710000 18                 TRA     s:6652
        18 001156   040000 106506                    CMPC    fill='040'O
        18 001157   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001160   000066 000001 19                 ADSC9   54                       cn=0,n=1
        18 001161   001274 601000 18                 TNZ     s:6662
        18 001162   001210 710000 18                 TRA     s:6652
        18 001163   040000 106506                    CMPC    fill='040'O
        18 001164   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001165   000067 000001 19                 ADSC9   55                       cn=0,n=1
        18 001166   001175 602000 18                 TNC     s:6650+46
        18 001167   001210 600000 18                 TZE     s:6652
        18 001170   040000 106506                    CMPC    fill='040'O
        18 001171   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001172   000070 000001 19                 ADSC9   56                       cn=0,n=1
        18 001173   001274 601000 18                 TNZ     s:6662
        18 001174   001210 710000 18                 TRA     s:6652
        18 001175   040000 106506                    CMPC    fill='040'O
        18 001176   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001177   000071 000001 19                 ADSC9   57                       cn=0,n=1
        18 001200   001203 602000 18                 TNC     s:6650+52
        18 001201   001210 600000 18                 TZE     s:6652
        18 001202   001274 710000 18                 TRA     s:6662
        18 001203   040000 106506                    CMPC    fill='040'O
        18 001204   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001205   000072 000001 19                 ADSC9   58                       cn=0,n=1
        18 001206   001274 601000 18                 TNZ     s:6662
        18 001207   001254 710000 18                 TRA     s:6657

   6652 18 001210   200131 236100                    LDQ     OVP_SIGN,,AUTO
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:40   
        18 001211   777000 376003                    ANQ     -512,DU
        18 001212   055000 116003                    CMPQ    23040,DU
        18 001213   001234 601000 18                 TNZ     s:6655

   6653 18 001214   000001 236100                    LDQ     1,,PR0
        18 001215   000077 376007                    ANQ     63,DL
        18 001216   000100 101506                    MRL     fill='000'O
        18 001217   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001220   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 001221   200177 756100                    STQ     @SIGN+3,,AUTO
        18 001222   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 001223   000031 036007                    ADLQ    25,DL
        18 001224   000033 736000                    QLS     27
        18 001225   000001 276000 19                 ORQ     1
        18 001226   200200 756100                    STQ     @SIGN+4,,AUTO
        18 001227   200177 235100                    LDA     @SIGN+3,,AUTO
        18 001230   040105 100500                    MLR     fill='040'O
        18 001231   200200 000004                    ADSC9   @SIGN+4,,AUTO            cn=0,n=4
        18 001232   377777 600001                    ADSC9   -1,A,PR3                 cn=3,n=1
        18 001233   001300 710000 18                 TRA     s:6666

   6655 18 001234   000001 236100                    LDQ     1,,PR0
        18 001235   000077 376007                    ANQ     63,DL
        18 001236   000100 101506                    MRL     fill='000'O
        18 001237   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001240   200176 000004                    ADSC9   @SIGN+2,,AUTO            cn=0,n=4
        18 001241   200177 756100                    STQ     @SIGN+3,,AUTO
        18 001242   200176 236100                    LDQ     @SIGN+2,,AUTO
        18 001243   000020 036007                    ADLQ    16,DL
        18 001244   000033 736000                    QLS     27
        18 001245   000001 276000 19                 ORQ     1
        18 001246   200200 756100                    STQ     @SIGN+4,,AUTO
        18 001247   200177 235100                    LDA     @SIGN+3,,AUTO
        18 001250   040105 100500                    MLR     fill='040'O
        18 001251   200200 000004                    ADSC9   @SIGN+4,,AUTO            cn=0,n=4
        18 001252   377777 600001                    ADSC9   -1,A,PR3                 cn=3,n=1
        18 001253   001300 710000 18                 TRA     s:6666
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:41   

   6657 18 001254   200131 236100                    LDQ     OVP_SIGN,,AUTO
        18 001255   777000 376003                    ANQ     -512,DU
        18 001256   055000 116003                    CMPQ    23040,DU
        18 001257   001266 601000 18                 TNZ     s:6660

   6658 18 001260   000001 236100                    LDQ     1,,PR0
        18 001261   000077 376007                    ANQ     63,DL
        18 001262   040106 100400                    MLR     fill='040'O
        18 001263   000013 000001 19                 ADSC9   11                       cn=0,n=1
        18 001264   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001265   001300 710000 18                 TRA     s:6666

   6660 18 001266   000001 236100                    LDQ     1,,PR0
        18 001267   000077 376007                    ANQ     63,DL
        18 001270   040106 100400                    MLR     fill='040'O
        18 001271   000012 000001 19                 ADSC9   10                       cn=0,n=1
        18 001272   377777 600001                    ADSC9   -1,Q,PR3                 cn=3,n=1
        18 001273   001300 710000 18                 TRA     s:6666

   6662 18 001274   000076 630400 19                 EPPR0   62
        18 001275   000073 631400 19                 EPPR1   59
        18 001276   000000 701000 xent               TSX1    X8ER$ERROR
        18 001277   000000 011000                    NOP     0

      159     6665
      160     6666    2       END ;  /* case result_desc.type */

   6666 18 001300   001641 710000 18                 TRA     s:6814

      161     6667        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:42   
      162     6668    1     BUILD_NUM: PROC ALTRET;

   6668 18 001301   200170 741300       BUILD_NUM    STX1  ! SIGN_TYPE+1,,AUTO

      163     6669
      164     6670    2       SEND_EXP = 0;

   6670 18 001302   200106 450100                    STZ     SEND_EXP,,AUTO

      165     6671
      166     6672    2           CALL X8AV$CREATE_NUM_DESC( IN_TEMP, 80, DSC )

   6672 18 001303   200076 630500                    EPPR0   DSC,,AUTO
        18 001304   200200 450500                    STP0    @SIGN+4,,AUTO
        18 001305   000102 237000 19                 LDAQ    66
        18 001306   200176 757100                    STAQ    @SIGN+2,,AUTO
        18 001307   200176 630500                    EPPR0   @SIGN+2,,AUTO
        18 001310   000073 631400 19                 EPPR1   59
        18 001311   000000 701000 xent               TSX1    X8AV$CREATE_NUM_DESC
        18 001312   001314 702000 18                 TSX2    s:6675
        18 001313   001322 710000 18                 TRA     s:6679

      167     6673    2           WHENALTRETURN
      168     6674    3             DO;

      169     6675    3               CALL X8ER$ERROR( %NO_DATA );

   6675 18 001314   000005 630400 19                 EPPR0   5
        18 001315   000003 631400 19                 EPPR1   3
        18 001316   000000 701000 xent               TSX1    X8ER$ERROR
        18 001317   000000 011000                    NOP     0

      170     6676    3               ALTRETURN;

   6676 18 001320   200170 221300                    LDX1  ! SIGN_TYPE+1,,AUTO
        18 001321   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:43   
      171     6677    3             END;
      172     6678
      173     6679    2           SUBSTR( SEND_FLD,0,1 ) = DSC.MANTISSA_SIGN;

   6679 18 001322   200104 236100                    LDQ     DSC+6,,AUTO
        18 001323   200107 552140                    STBQ    SEND_FLD,'40'O,AUTO

      174     6680
      175     6681    2           SUBSTR( SEND_FLD,1,DSC.DIGITS_LEFT ) =

   6681 18 001324   200076 720100                    LXL0    DSC,,AUTO
        18 001325   200077 235100                    LDA     DSC+1,,AUTO
        18 001326   040140 100445                    MLR     fill='040'O
        18 001327   000000 000010 2                  ADSC9   IN_TEMP,A                cn=0,n=*X0
        18 001330   200107 200010                    ADSC9   SEND_FLD,,AUTO           cn=1,n=*X0

      176     6682    2              SUBSTR( IN_TEMP,DSC.LEFT_POS,DSC.DIGITS_LEFT );
      177     6683    2           SUBSTR( SEND_FLD,DSC.DIGITS_LEFT + 1, DSC.DIGITS_RIGHT ) =

   6683 18 001331   200100 721100                    LXL1    DSC+2,,AUTO
        18 001332   200101 235100                    LDA     DSC+3,,AUTO
        18 001333   200076 236100                    LDQ     DSC,,AUTO
        18 001334   040146 100445                    MLR     fill='040'O
        18 001335   000000 000011 2                  ADSC9   IN_TEMP,A                cn=0,n=*X1
        18 001336   200107 200011                    ADSC9   SEND_FLD,Q,AUTO          cn=1,n=*X1

      178     6684    2              SUBSTR( IN_TEMP,DSC.RIGHT_POS,DSC.DIGITS_RIGHT );
      179     6685
      180     6686    2           IF DSC.DIGITS_EXP > 0 THEN

   6686 18 001337   200102 235100                    LDA     DSC+4,,AUTO
        18 001340   001354 604400 18                 TMOZ    s:6692

      181     6687    3             DO;

      182     6688    3               CALL CHARBIN( SEND_EXP, SUBSTR( IN_TEMP,DSC.EXP_POS,DSC.DIGITS_EXP ));

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:44   
   6688 18 001341   000000 620005                    EAX0    0,AL
        18 001342   200103 235100                    LDA     DSC+5,,AUTO
        18 001343   000100 305445                    DTB
        18 001344   000000 030010 2                  NDSC9   IN_TEMP,A                cn=0,s=nosgn,sf=0,n=*X0
        18 001345   200106 000004                    NDSC9   SEND_EXP,,AUTO           cn=0,s=lsgnf,sf=0,n=4

      183     6689    3               IF DSC.EXP_SIGN = %MINUS_SIGN  THEN

   6689 18 001346   200104 236100                    LDQ     DSC+6,,AUTO
        18 001347   000777 376003                    ANQ     511,DU
        18 001350   000055 116003                    CMPQ    45,DU
        18 001351   001354 601000 18                 TNZ     s:6692

      184     6690    3                 SEND_EXP = SEND_EXP * -1;

   6690 18 001352   200106 336100                    LCQ     SEND_EXP,,AUTO
        18 001353   200106 756100                    STQ     SEND_EXP,,AUTO

      185     6691    3             END;

      186     6692    2           SEND_EXP = SEND_EXP - DSC.DIGITS_RIGHT;

   6692 18 001354   200106 236100                    LDQ     SEND_EXP,,AUTO
        18 001355   200100 136100                    SBLQ    DSC+2,,AUTO
        18 001356   200106 756100                    STQ     SEND_EXP,,AUTO

      187     6693    2           IF SEND_EXP > 127 THEN

   6693 18 001357   000177 116007                    CMPQ    127,DL
        18 001360   001370 604400 18                 TMOZ    s:6699

      188     6694    3             DO;

      189     6695    3               SEND_EXP = 127;

   6695 18 001361   000177 235007                    LDA     127,DL
        18 001362   200106 755100                    STA     SEND_EXP,,AUTO
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:45   

      190     6696    3               CALL X8ER$ERROR( %EXP_TOO_BIG );

   6696 18 001363   000105 630400 19                 EPPR0   69
        18 001364   000003 631400 19                 EPPR1   3
        18 001365   000000 701000 xent               TSX1    X8ER$ERROR
        18 001366   000000 011000                    NOP     0

      191     6697    3             END;

   6697 18 001367   001400 710000 18                 TRA     s:6704

      192     6698    2           ELSE
      193     6699    2             IF SEND_EXP < -128 THEN

   6699 18 001370   000106 116000 19                 CMPQ    70
        18 001371   001400 605000 18                 TPL     s:6704

      194     6700    3               DO;

      195     6701    3                 SEND_EXP = -128;

   6701 18 001372   000200 335007                    LCA     128,DL
        18 001373   200106 755100                    STA     SEND_EXP,,AUTO

      196     6702    3                 CALL X8ER$ERROR( %EXP_TOO_SMALL );

   6702 18 001374   000110 630400 19                 EPPR0   72
        18 001375   000003 631400 19                 EPPR1   3
        18 001376   000000 701000 xent               TSX1    X8ER$ERROR
        18 001377   000000 011000                    NOP     0

      197     6703    3               END;

      198     6704    2           NUMERIC_EXP.EXP = SEND_EXP;

   6704 18 001400   200106 236100                    LDQ     SEND_EXP,,AUTO
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:46   
        18 001401   000033 736000                    QLS     27
        18 001402   200105 676100                    ERQ     CHAR_EXP,,AUTO
        18 001403   377000 376003                    ANQ     130560,DU
        18 001404   200105 656100                    ERSQ    CHAR_EXP,,AUTO

      199     6705    2           SEND_LEN = DSC.DIGITS_RIGHT + DSC.DIGITS_LEFT + 1;

   6705 18 001405   200100 236100                    LDQ     DSC+2,,AUTO
        18 001406   200076 036100                    ADLQ    DSC,,AUTO
        18 001407   000001 036007                    ADLQ    1,DL
        18 001410   200130 756100                    STQ     SEND_LEN,,AUTO

      200     6706    2           IF SEND_LEN = 1 THEN

   6706 18 001411   000001 116007                    CMPQ    1,DL
        18 001412   001421 601000 18                 TNZ     s:6711

      201     6707    3             DO;                    /* no digits were entered */

      202     6708    3               CALL X8ER$ERROR( %NO_DATA );

   6708 18 001413   000005 630400 19                 EPPR0   5
        18 001414   000003 631400 19                 EPPR1   3
        18 001415   000000 701000 xent               TSX1    X8ER$ERROR
        18 001416   000000 011000                    NOP     0

      203     6709    3               ALTRETURN;

   6709 18 001417   200170 221300                    LDX1  ! SIGN_TYPE+1,,AUTO
        18 001420   000000 702211                    TSX2  ! 0,X1

      204     6710    3             END;
      205     6711    2           SUBSTR( SEND_FLD, SEND_LEN, 1 ) = CHAR_EXP;

   6711 18 001421   040106 100500                    MLR     fill='040'O
        18 001422   200105 000001                    ADSC9   CHAR_EXP,,AUTO           cn=0,n=1
        18 001423   200107 000001                    ADSC9   SEND_FLD,Q,AUTO          cn=0,n=1
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:47   

      206     6712    2           SEND_LEN = SEND_LEN + 1;

   6712 18 001424   200130 054100                    AOS     SEND_LEN,,AUTO

      207     6713
      208     6714        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:48   
      209     6715        /*
      210     6716                   Build sending and receiving EIS descriptors for the mvn.
      211     6717        */
      212     6718
      213     6719                %PACK_NDSC ( @DESC       = SEND_DESC,
      214     6720                             @SA         = 0,
      215     6721                             @LENGTH     = "SEND_LEN - 2",
      216     6722                             @CN         = 0,
      217     6723                             @TN         = %NDSC9,
      218     6724                             @SIGN       = %FLOATING_POINT_LEADING_SIGN,
      219     6725                             @SCALE      = 0          );

   6730 18 001425   000000 220003                    LDX0    0,DU
        18 001426   200135 740100                    STX0    SEND_DESC,,AUTO

   6731 18 001427   000111 236000 19                 LDQ     73
        18 001430   200135 356100                    ANSQ    SEND_DESC,,AUTO

   6732 18 001431   000112 236000 19                 LDQ     74
        18 001432   200135 356100                    ANSQ    SEND_DESC,,AUTO

   6733 18 001433   000113 236000 19                 LDQ     75
        18 001434   200135 356100                    ANSQ    SEND_DESC,,AUTO

   6734 18 001435   000000 236003                    LDQ     0,DU
        18 001436   200135 752102                    STCQ    SEND_DESC,'02'O,AUTO

   6735 18 001437   000000 235003                    LDA     0,DU
        18 001440   000004 115007                    CMPA    4,DL
        18 001441   001443 602005 18                 TNC     s:6735+4,AL
        18 001442   001461 710000 18                 TRA     s:6775
        18 001443   001457 710000 18                 TRA     s:6766
        18 001444   001453 710000 18                 TRA     s:6742
        18 001445   001453 710000 18                 TRA     s:6742
        18 001446   001447 710000 18                 TRA     s:6737

   6737 18 001447   200130 236100                    LDQ     SEND_LEN,,AUTO
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:49   
        18 001450   000002 136007                    SBLQ    2,DL
        18 001451   200135 752101                    STCQ    SEND_DESC,'01'O,AUTO
        18 001452   001461 710000 18                 TRA     s:6775

   6742 18 001453   200130 236100                    LDQ     SEND_LEN,,AUTO
        18 001454   000001 136007                    SBLQ    1,DL
        18 001455   200135 752101                    STCQ    SEND_DESC,'01'O,AUTO
        18 001456   001461 710000 18                 TRA     s:6775

   6766 18 001457   200130 236100                    LDQ     SEND_LEN,,AUTO
        18 001460   200135 752101                    STCQ    SEND_DESC,'01'O,AUTO

      220     6774
      221     6775    2           REC_DESC = SEND_DESC;

   6775 18 001461   200135 236100                    LDQ     SEND_DESC,,AUTO
        18 001462   200136 756100                    STQ     REC_DESC,,AUTO

      222     6776    2           REC_DESC.NDSC.N = RES_DSC.D_WORD.DES_W.NDSC.N ;

   6776 18 001463   200004 470500                    LDP0    @RES_DSC,,AUTO
        18 001464   000001 236100                    LDQ     1,,PR0
        18 001465   200136 752101                    STCQ    REC_DESC,'01'O,AUTO

      223     6777    2           CALL GET_SIGN_TYPE( RES_DSC.D_WORD.DES_W.TYPE, SIGN_TYPE );

   6777 18 001466   200167 631500                    EPPR1   SIGN_TYPE,,AUTO
        18 001467   200174 451500                    STP1    @TYPE+1,,AUTO
        18 001470   200004 236100                    LDQ     @RES_DSC,,AUTO
        18 001471   000001 036003                    ADLQ    1,DU
        18 001472   200173 756100                    STQ     SIGN_TYPE+4,,AUTO
        18 001473   001532 701000 18                 TSX1    GET_SIGN_TYPE
        18 001474   000000 011000                    NOP     0

      224     6778    2           REC_DESC.NDSC.S = SIGN_TYPE;

   6778 18 001475   200167 236100                    LDQ     SIGN_TYPE,,AUTO
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:50   
        18 001476   000026 772000                    QRL     22
        18 001477   200136 676100                    ERQ     REC_DESC,,AUTO
        18 001500   030000 376007                    ANQ     12288,DL
        18 001501   200136 656100                    ERSQ    REC_DESC,,AUTO

      225     6779    2           REC_DESC.NDSC.SF = RES_DSC.D_WORD.DES_W.NDSC.SF;

   6779 18 001502   200004 470500                    LDP0    @RES_DSC,,AUTO
        18 001503   000001 236100                    LDQ     1,,PR0
        18 001504   200136 752102                    STCQ    REC_DESC,'02'O,AUTO

      226     6780
      227     6781    2           CALL X9MV ( SEND_DESC, REC_DESC, RESULT$, ADDR( SEND_FLD ) )

   6781 18 001505   200107 631500                    EPPR1   SEND_FLD,,AUTO
        18 001506   200176 451500                    STP1    @SIGN+2,,AUTO
        18 001507   200176 633500                    EPPR3   @SIGN+2,,AUTO
        18 001510   200203 453500                    STP3    @SIGN+7,,AUTO
        18 001511   200003 236100                    LDQ     @RESULT$,,AUTO
        18 001512   200202 756100                    STQ     @SIGN+6,,AUTO
        18 001513   200136 634500                    EPPR4   REC_DESC,,AUTO
        18 001514   200201 454500                    STP4    @SIGN+5,,AUTO
        18 001515   200135 635500                    EPPR5   SEND_DESC,,AUTO
        18 001516   200200 455500                    STP5    @SIGN+4,,AUTO
        18 001517   200200 630500                    EPPR0   @SIGN+4,,AUTO
        18 001520   000114 631400 19                 EPPR1   76
        18 001521   000000 701000 xent               TSX1    X9MV
        18 001522   001524 702000 18                 TSX2    s:6784
        18 001523   001530 710000 18                 TRA     s:6786

      228     6782    2           WHENALTRETURN
      229     6783    3             DO;

      230     6784    3               CALL X8ER$ERROR( %OVERFLOW_TRUNCATION );

   6784 18 001524   000116 630400 19                 EPPR0   78
        18 001525   000003 631400 19                 EPPR1   3
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:51   
        18 001526   000000 701000 xent               TSX1    X8ER$ERROR
        18 001527   000000 011000                    NOP     0

      231     6785    3             END;

      232     6786    2     END BUILD_NUM; /* proc */

   6786 18 001530   200170 221300                    LDX1  ! SIGN_TYPE+1,,AUTO
        18 001531   000001 702211                    TSX2  ! 1,X1

      233     6787        %EJECT;
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:52   
      234     6788    1     GET_SIGN_TYPE: PROC( TYPE, SIGN );

   6788 18 001532   200172 741300       GET_SIGN_TY* STX1  ! SIGN_TYPE+3,,AUTO

      235     6789
      236     6790    2       DCL TYPE UBIN(18);
      237     6791    2       DCL SIGN BIT(2) ALIGNED;
      238     6792
      239     6793    3       DO CASE( TYPE );

   6793 18 001533   200173 470500                    LDP0    @TYPE,,AUTO
        18 001534   000000 236100                    LDQ     0,,PR0
        18 001535   000022 772000                    QRL     18
        18 001536   000011 136007                    SBLQ    9,DL
        18 001537   000052 116007                    CMPQ    42,DL
        18 001540   001542 602006 18                 TNC     s:6793+7,QL
        18 001541   001633 710000 18                 TRA     s:6810
        18 001542   001614 710000 18                 TRA     s:6796
        18 001543   001624 710000 18                 TRA     s:6803
        18 001544   001633 710000 18                 TRA     s:6810
        18 001545   001633 710000 18                 TRA     s:6810
        18 001546   001633 710000 18                 TRA     s:6810
        18 001547   001633 710000 18                 TRA     s:6810
        18 001550   001633 710000 18                 TRA     s:6810
        18 001551   001633 710000 18                 TRA     s:6810
        18 001552   001633 710000 18                 TRA     s:6810
        18 001553   001633 710000 18                 TRA     s:6810
        18 001554   001633 710000 18                 TRA     s:6810
        18 001555   001633 710000 18                 TRA     s:6810
        18 001556   001633 710000 18                 TRA     s:6810
        18 001557   001633 710000 18                 TRA     s:6810
        18 001560   001633 710000 18                 TRA     s:6810
        18 001561   001633 710000 18                 TRA     s:6810
        18 001562   001620 710000 18                 TRA     s:6800
        18 001563   001633 710000 18                 TRA     s:6810
        18 001564   001633 710000 18                 TRA     s:6810
        18 001565   001633 710000 18                 TRA     s:6810
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:53   
        18 001566   001633 710000 18                 TRA     s:6810
        18 001567   001633 710000 18                 TRA     s:6810
        18 001570   001620 710000 18                 TRA     s:6800
        18 001571   001633 710000 18                 TRA     s:6810
        18 001572   001633 710000 18                 TRA     s:6810
        18 001573   001633 710000 18                 TRA     s:6810
        18 001574   001633 710000 18                 TRA     s:6810
        18 001575   001633 710000 18                 TRA     s:6810
        18 001576   001633 710000 18                 TRA     s:6810
        18 001577   001633 710000 18                 TRA     s:6810
        18 001600   001633 710000 18                 TRA     s:6810
        18 001601   001627 710000 18                 TRA     s:6807
        18 001602   001627 710000 18                 TRA     s:6807
        18 001603   001614 710000 18                 TRA     s:6796
        18 001604   001620 710000 18                 TRA     s:6800
        18 001605   001627 710000 18                 TRA     s:6807
        18 001606   001627 710000 18                 TRA     s:6807
        18 001607   001633 710000 18                 TRA     s:6810
        18 001610   001633 710000 18                 TRA     s:6810
        18 001611   001633 710000 18                 TRA     s:6810
        18 001612   001633 710000 18                 TRA     s:6810
        18 001613   001624 710000 18                 TRA     s:6803

      240     6794
      241     6795    3         CASE ( %UNPACK_FIXED_LEAD_SIGN, %PACK_FIXED_LEAD_SIGN );

      242     6796    3           SIGN = %LEADING_SIGN;

   6796 18 001614   200000 236003                    LDQ     65536,DU
        18 001615   200174 471500                    LDP1    @SIGN,,AUTO
        18 001616   100000 756100                    STQ     0,,PR1
        18 001617   001637 710000 18                 TRA     s:6813

      243     6797
      244     6798    3         CASE ( %UNPACK_FIXED_TRAIL_SIGN, %PACK_FIXED_TRAIL_SIGN,

      245     6799    3                %PACK_FIXED_TRAIL_SIGN_EBCDIC );
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:54   
      246     6800    3           SIGN = %TRAILING_SIGN;

   6800 18 001620   400000 236003                    LDQ     -131072,DU
        18 001621   200174 471500                    LDP1    @SIGN,,AUTO
        18 001622   100000 756100                    STQ     0,,PR1
        18 001623   001637 710000 18                 TRA     s:6813

      247     6801
      248     6802    3         CASE ( %UNPACK_FLOAT_LEAD_SIGN, %PACK_FLOAT_LEAD_SIGN );

      249     6803    3           SIGN = %FLOATING_POINT_LEADING_SIGN;

   6803 18 001624   200174 471500                    LDP1    @SIGN,,AUTO
        18 001625   100000 450100                    STZ     0,,PR1
        18 001626   001637 710000 18                 TRA     s:6813

      250     6804
      251     6805    3         CASE ( %UNPACK_FIXED_NO_SIGN, %UNPACK_FIXED_LEAD_OPUNCH_SIGN,

      252     6806    3                %UNPACK_FIXED_TRAIL_OPUNCH_SIGN, %PACK_FIXED_NO_SIGN );
      253     6807    3           SIGN = %NO_SIGN;

   6807 18 001627   600000 236003                    LDQ     -65536,DU
        18 001630   200174 471500                    LDP1    @SIGN,,AUTO
        18 001631   100000 756100                    STQ     0,,PR1
        18 001632   001637 710000 18                 TRA     s:6813

      254     6808
      255     6809    3         CASE ( ELSE );

      256     6810    3           CALL X8ER$ERROR( %UNEXPECTED_CASE, 'X8AV:GET_SIGN_TYPE', 18 );

   6810 18 001633   000120 630400 19                 EPPR0   80
        18 001634   000073 631400 19                 EPPR1   59
        18 001635   000000 701000 xent               TSX1    X8ER$ERROR
        18 001636   000000 011000                    NOP     0

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:55   
      257     6811
      258     6812    3       END; /* case type */

      259     6813    2     END GET_SIGN_TYPE;  /* proc */

   6813 18 001637   200172 221300                    LDX1  ! SIGN_TYPE+3,,AUTO
        18 001640   000001 702211                    TSX2  ! 1,X1

      260     6814    1   END X8AV$VALID_DATA;

   6814 18 001641   000000 702200 xent               TSX2  ! X66_ARET
      261     6815        %EOD;

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:56   
--  Include file information  --

   X8A_TABLES.:X8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
   B$OBJECT_C.:LIB_E04  is referenced.
   X9A_TYPES.:X8A6TOU  is referenced.
   X9A_MACROS.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure X8AV$VALID_DATA.
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:57   

 **** Variables and constants ****

  ****  Section 000 LblCom LIBCOM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(720)         1 LIBCOM

  ****  Section 001 LblCom DEC_OR_COMMA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 DEC_OR_COMMA

  ****  Section 002 LblCom IN_TEMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)    r     1 IN_TEMP

  ****  Section 003 LblCom OVRCHR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 OVRCHR

  ****  Section 004 LblCom SELECT_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 SELECT_TIME

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:58   
  ****  Section 005 LblCom NO_ADVANCE_OFFSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 NO_ADVANCE_OFFSET

  ****  Section 006 LblCom DSPLY_SAVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)          1 DSPLY_SAVE

  ****  Section 007 LblCom D_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)          1 D_DATE

  ****  Section 008 LblCom D_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(11)          1 D_TIME

  ****  Section 009 LblCom D_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)           1 D_DAY

  ****  Section 010 LblCom C_DATE

PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:59   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)           1 C_DATE

  ****  Section 011 LblCom C_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)           1 C_TIME

  ****  Section 012 LblCom C_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)           1 C_DAY

  ****  Section 013 LblCom RTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 RTHOLD2

  ****  Section 014 LblCom LTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTHOLD2

  ****  Section 015 LblCom NDX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:60   

     0-0-0/w SBIN              1 NDX2

  ****  Section 016 LblCom IN_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 IN_LEN

  ****  Section 017 RoData X8AV$VALID_DATA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b UBIN(9)     r     1 ASCII_SEARCH_TABLE(0:511)
   200-0-0/b UBIN(9)           1 DIGIT_SCAN_TABLE(0:511)
   400-0-0/b UBIN(9)     r     1 OPUNCH_SCAN_TABLE(0:511)
   600-0-0/b UBIN(9)     r     1 SIGN_SCAN_TABLE(0:511)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @RESULT$                   4-0-0/w PTR         r     1 @RES_DSC
   174-0-0/w PTR         r     1 @SIGN                    173-0-0/w PTR         r     1 @TYPE
   105-0-0/w CHAR        r     1 CHAR_EXP                 140-0-0/w SBIN        r     1 CLASS
   137-0-0/w SBIN        r     1 COL                       76-0-0/w STRC(234)   r     1 DSC
   141-0-0/w SBIN        r     1 LAST_COL                 142-0-0/w SBIN        r     1 LENGTH
     5-0-0/w SBIN              1 LT                         6-0-0/c CHAR(65)          1 LTHOLD
    50-0-0/w SBIN              1 NDX                       51-0-0/w SBIN              1 NDX3
   105-0-0/w STRC(9)     r     1 NUMERIC_EXP              134-0-0/c CHAR        r     1 OVPNUM
   131-0-0/c CHAR        r     1 OVP_SIGN                 136-0-0/w STRC        r     1 REC_DESC
    *0-0-0/w PTR         r     1 RESULT$                   *0-0-0/w STRC(72)    r     1 RES_DSC
    27-0-0/c CHAR(65)          1 RTHOLD                   135-0-0/w STRC        r     1 SEND_DESC
   106-0-0/w SBIN        r     1 SEND_EXP                 107-0-0/c CHAR(65)    r     1 SEND_FLD
PL6.E3A0      #001=X8AV$VALID_DATA File=X8AV.:X8A6TSI                            SAT 08/09/97 10:43 Page:61   
   130-0-0/w SBIN        r     1 SEND_LEN                  *0-0-0/w BIT (2)     r     1 SIGN
   167-0-0/w BIT (2)     r     1 SIGN_TYPE                 52-0-0/c CHAR(80)          1 SPECIAL_ERR_MSG
   143-0-0/c CHAR(80)    r     1 SYMBOL                   133-0-0/w SBIN        r     1 TRAIL_COL
   132-0-0/c CHAR        r     1 TRAIL_SIGN                *0-0-0/w UBIN(18)    r     1 TYPE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 RESULT


   Procedure X8AV$VALID_DATA requires 930 words for executable code.
   Procedure X8AV$VALID_DATA requires 132 words of local(AUTO) storage.

PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:62   
      262        1        /*T***********************************************************/
      263        2        /*T*                                                         */
      264        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      265        4        /*T*                                                         */
      266        5        /*T***********************************************************/
      267        6        X8AV$CREATE_NUM_DESC:  PROC ( SYMBOL, LENGTH, NUM_DESC) ALTRET;
      268        7
      269        8            %INCLUDE Z8E_WINDOW;
      270     2078            %INCLUDE X8A_TABLES;
      271     2169            %INCLUDE X8A_LIBCOM;
      272     2389            %INCLUDE X8A_MACROS;
      273     2646            %INCLUDE X9A_MACROS;
      274     2677            %INCLUDE X8A_ERRCOM;
      275     2766    1       DCL SYMBOL             CHAR(LENGTH);
      276     2767    1       DCL LENGTH             SBIN WORD;
      277     2768            %DCL_NUM_DESC_LIB(@NAME=NUM_DESC);
      278     2779         /*           The following structure is declared
      279     2780                   DCL 1 NUM_DESC,
      280     2781                         2 DIGITS_LEFT             SBIN WORD,
      281     2782                         2 LEFT_POS                SBIN WORD,
      282     2783                         2 DIGITS_RIGHT            SBIN WORD,
      283     2784                         2 RIGHT_POS               SBIN WORD,
      284     2785                         2 DIGITS_EXP         SBIN WORD,
      285     2786                         2 EXP_POS                 SBIN WORD,
      286     2787                         2 MANTISSA_SIGN     CHAR(1),
      287     2788                         2 EXP_SIGN          CHAR(1);
      288     2789        */
      289     2790
      290     2791    1       DCL COL      SBIN;
      291     2792    1       DCL CLASS    SBIN;
      292     2793    1       DCL LAST_COL SBIN;
      293     2794
      294     2795    1       DCL X8ER$ERROR           ENTRY(3);
      295     2796        %EJECT;
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:63   
      296     2797
      297     2798
      298     2799            /* Start of procedure body */
      299     2800
      300     2801    1       IF SYMBOL = ' ' THEN
      301     2802    1         ALTRETURN;           /* no data was entered */
      302     2803    1       NUM_DESC.DIGITS_LEFT          = 0;
      303     2804    1       NUM_DESC.DIGITS_RIGHT         = 0;
      304     2805    1       NUM_DESC.DIGITS_EXP      = 0;
      305     2806    1       NUM_DESC.MANTISSA_SIGN  = '+';
      306     2807    1       NUM_DESC.EXP_SIGN  = '+';
      307     2808
      308     2809    1       LAST_COL = 0;
      309     2810            %SKIP_LEADING_SPACES;
      310     2843
      311     2844            /* Get sign */
      312     2845    2       DO SELECT(CLASS);
      313     2846
      314     2847    2         SELECT(%PLUS);
      315     2848    2           NUM_DESC.MANTISSA_SIGN = '+';
      316     2849                %ADV_COL;
      317     2869
      318     2870    2         SELECT(%MINUS);
      319     2871    2           NUM_DESC.MANTISSA_SIGN = '-';
      320     2872                %ADV_COL;
      321     2892
      322     2893    2       END;
      323     2894
      324     2895            /* Get leading digits */
      325     2896    1       IF CLASS = %DIGIT THEN
      326     2897    2         DO;
      327     2898    2           NUM_DESC.LEFT_POS = COL;
      328     2899                %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      329     2906    2           NUM_DESC.DIGITS_LEFT = COL - LAST_COL;
      330     2907                %CHECK_EOT;
      331     2915    2         END;
      332     2916
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:64   
      333     2917            /* Check decimal point */
      334     2918    1       IF CLASS = %PERIOD
      335     2919    1       OR ( CLASS = %COMMA AND LIBCOM.COMMA_DECIMAL ) THEN
      336     2920    2         DO;
      337     2921
      338     2922
      339     2923                %ADV_COL;
      340     2943
      341     2944                /* Fractional digits */
      342     2945    2           IF CLASS = %DIGIT THEN
      343     2946    3             DO;
      344     2947    3               NUM_DESC.RIGHT_POS = COL;
      345     2948                    %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      346     2955    3               NUM_DESC.DIGITS_RIGHT = COL - LAST_COL;
      347     2956                    %CHECK_EOT;
      348     2964    3             END;
      349     2965    2         END;
      350     2966         %EJECT;
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:65   
      351     2967                /* Exponent */
      352     2968    1           IF CLASS = %LETTER_E THEN
      353     2969    2             DO;
      354     2970    2               IF NUM_DESC.DIGITS_RIGHT + NUM_DESC.DIGITS_LEFT = 0 THEN
      355     2971    2                 ALTRETURN;
      356     2972    2               ELSE
      357     2973                      %ADV_COL;
      358     2993
      359     2994                    /* Sign on exponent */
      360     2995    3               DO SELECT (CLASS);
      361     2996
      362     2997    3                 SELECT(%PLUS);
      363     2998    3                   NUM_DESC.EXP_SIGN = '+' ;
      364     2999                        %ADV_COL;
      365     3019
      366     3020    3                 SELECT(%MINUS);
      367     3021    3                   NUM_DESC.EXP_SIGN = '-' ;
      368     3022                        %ADV_COL;
      369     3042
      370     3043    3               END;
      371     3044
      372     3045                    /* Exponent digits */
      373     3046    2               IF CLASS = %DIGIT THEN
      374     3047    3                 DO;
      375     3048    3                   NUM_DESC.EXP_POS = COL;
      376     3049                        %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);
      377     3056    3                   NUM_DESC.DIGITS_EXP = COL - LAST_COL;
      378     3057                        %CHECK_EOT;
      379     3065    3                 END;
      380     3066    2               IF NUM_DESC.DIGITS_EXP = 0 THEN
      381     3067    2                 ALTRETURN;
      382     3068
      383     3069    2             END;
      384     3070
      385     3071            /* If we got here, there was an error in the NUMERIC_LITERAL */
      386     3072    1       IF CLASS = %SPACE THEN
      387     3073    1         RETURN;
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:66   
      388     3074    1       ELSE
      389     3075    1         ALTRETURN;
      390     3076
      391     3077    1   END X8AV$CREATE_NUM_DESC;
      392     3078        %EJECT;
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:67   

PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:68   
--  Include file information  --

   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_MACROS.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_TABLES.:X8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure X8AV$CREATE_NUM_DESC.

   Procedure X8AV$CREATE_NUM_DESC requires 292 words for executable code.
   Procedure X8AV$CREATE_NUM_DESC requires 66 words of local(AUTO) storage.

    No errors detected in file X8AV.:X8A6TSI    .

PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:69   

 Object Unit name= X8AV$CREATE_NUM_DESC                       File name= X8AV.:X8A6TOU
 UTS= AUG 09 '97 10:46:26.64 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS    256    400  X8AV$CREATE_NUM_DESC
    1  LblCom even  none    20     24  LIBCOM
    2  LblCom even  none     1      1  DEC_OR_COMMA
    3  LblCom even  none    20     24  IN_TEMP
    4  LblCom even  none     1      1  OVRCHR
    5  LblCom even  none     1      1  SELECT_TIME
    6  LblCom even  none     1      1  NO_ADVANCE_OFFSET
    7  LblCom even  none    18     22  DSPLY_SAVE
    8  LblCom even  none     3      3  D_DATE
    9  LblCom even  none     3      3  D_TIME
   10  LblCom even  none     1      1  D_DAY
   11  LblCom even  none     2      2  C_DATE
   12  LblCom even  none     2      2  C_TIME
   13  LblCom even  none     2      2  C_DAY
   14  LblCom even  none     1      1  RTHOLD2
   15  LblCom even  none     1      1  LTHOLD2
   16  LblCom even  none     1      1  NDX2
   17  LblCom even  none     1      1  IN_LEN
   18   Proc  even  none   292    444  X8AV$CREATE_NUM_DESC
   19  RoData even  none     1      1  X8AV$CREATE_NUM_DESC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    18      0   yes    yes     yes      Std        3  X8AV$CREATE_NUM_DESC
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:70   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:71   


      262        1        /*T***********************************************************/
      263        2        /*T*                                                         */
      264        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      265        4        /*T*                                                         */
      266        5        /*T***********************************************************/
      267        6        X8AV$CREATE_NUM_DESC:  PROC ( SYMBOL, LENGTH, NUM_DESC) ALTRET;

      6 18 000000   000000 700200 xent  X8AV$CREATE* TSX0  ! X66_AUTO_3
        18 000001   000102 000003                    ZERO    66,3

      268        7
      269        8            %INCLUDE Z8E_WINDOW;
      270     2078            %INCLUDE X8A_TABLES;
      271     2169            %INCLUDE X8A_LIBCOM;
      272     2389            %INCLUDE X8A_MACROS;
      273     2646            %INCLUDE X9A_MACROS;
      274     2677            %INCLUDE X8A_ERRCOM;
      275     2766    1       DCL SYMBOL             CHAR(LENGTH);
      276     2767    1       DCL LENGTH             SBIN WORD;
      277     2768            %DCL_NUM_DESC_LIB(@NAME=NUM_DESC);
      278     2779         /*           The following structure is declared
      279     2780                   DCL 1 NUM_DESC,
      280     2781                         2 DIGITS_LEFT             SBIN WORD,
      281     2782                         2 LEFT_POS                SBIN WORD,
      282     2783                         2 DIGITS_RIGHT            SBIN WORD,
      283     2784                         2 RIGHT_POS               SBIN WORD,
      284     2785                         2 DIGITS_EXP         SBIN WORD,
      285     2786                         2 EXP_POS                 SBIN WORD,
      286     2787                         2 MANTISSA_SIGN     CHAR(1),
      287     2788                         2 EXP_SIGN          CHAR(1);
      288     2789        */
      289     2790
      290     2791    1       DCL COL      SBIN;
      291     2792    1       DCL CLASS    SBIN;
      292     2793    1       DCL LAST_COL SBIN;
      293     2794
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:72   
      294     2795    1       DCL X8ER$ERROR           ENTRY(3);
      295     2796        %EJECT;
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:73   
      296     2797
      297     2798
      298     2799            /* Start of procedure body */
      299     2800
      300     2801    1       IF SYMBOL = ' ' THEN

   2801 18 000002   200004 470500                    LDP0    @LENGTH,,AUTO
        18 000003   000000 720100                    LXL0    0,,PR0
        18 000004   200003 471500                    LDP1    @SYMBOL,,AUTO
        18 000005   040000 106540                    CMPC    fill='040'O
        18 000006   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        18 000007   000000 000001 19                 ADSC9   0                        cn=0,n=1
        18 000010   000012 601000 18                 TNZ     s:2803

      301     2802    1         ALTRETURN;           /* no data was entered */

   2802 18 000011   000000 702200 xent               TSX2  ! X66_AALT

      302     2803    1       NUM_DESC.DIGITS_LEFT          = 0;

   2803 18 000012   200005 473500                    LDP3    @NUM_DESC,,AUTO
        18 000013   300000 450100                    STZ     0,,PR3

      303     2804    1       NUM_DESC.DIGITS_RIGHT         = 0;

   2804 18 000014   300002 450100                    STZ     2,,PR3

      304     2805    1       NUM_DESC.DIGITS_EXP      = 0;

   2805 18 000015   300004 450100                    STZ     4,,PR3

      305     2806    1       NUM_DESC.MANTISSA_SIGN  = '+';

   2806 18 000016   053000 236003                    LDQ     22016,DU
        18 000017   300006 552140                    STBQ    6,'40'O,PR3

      306     2807    1       NUM_DESC.EXP_SIGN  = '+';
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:74   

   2807 18 000020   000053 236003                    LDQ     43,DU
        18 000021   300006 552120                    STBQ    6,'20'O,PR3

      307     2808
      308     2809    1       LAST_COL = 0;

   2809 18 000022   200101 450100                    STZ     LAST_COL,,AUTO

      309     2810            %SKIP_LEADING_SPACES;

   2813 18 000023   000000 720100                    LXL0    0,,PR0
        18 000024   200101 721100                    LXL1    LAST_COL,,AUTO
        18 000025   777657 621011                    EAX1    -81,X1
        18 000026   777777 661003                    ERX1    -1,DU
        18 000027   200101 236100                    LDQ     LAST_COL,,AUTO
        18 000030   000000 164546                    TCT
        18 000031   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000032   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000033   200077 000100                    ARG     COL,,AUTO
        18 000034   200077 235100                    LDA     COL,,AUTO
        18 000035   000033 771000                    ARL     27
        18 000036   200100 755100                    STA     CLASS,,AUTO
        18 000037   200077 551140                    STBA    COL,'40'O,AUTO
        18 000040   200077 056100                    ASQ     COL,,AUTO

   2819 18 000041   000042 115007                    CMPA    34,DL
        18 000042   000072 601000 18                 TNZ     s:2845

   2822 18 000043   200077 054100                    AOS     COL,,AUTO

   2825 18 000044   200004 470500                    LDP0    @LENGTH,,AUTO
        18 000045   200077 236100                    LDQ     COL,,AUTO
        18 000046   000000 116100                    CMPQ    0,,PR0
        18 000047   000052 605000 18                 TPL     s:2828

   2826 18 000050   200101 756100                    STQ     LAST_COL,,AUTO
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:75   
        18 000051   000053 710000 18                 TRA     s:2832

   2828 18 000052   000000 702200 xent               TSX2  ! X66_ARET

   2832 18 000053   000000 720100                    LXL0    0,,PR0
        18 000054   777657 621006                    EAX1    -81,QL
        18 000055   777777 661003                    ERX1    -1,DU
        18 000056   200003 471500                    LDP1    @SYMBOL,,AUTO
        18 000057   000000 164546                    TCT
        18 000060   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000061   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000062   200077 000100                    ARG     COL,,AUTO
        18 000063   200077 235100                    LDA     COL,,AUTO
        18 000064   000033 771000                    ARL     27
        18 000065   200100 755100                    STA     CLASS,,AUTO
        18 000066   200077 551140                    STBA    COL,'40'O,AUTO
        18 000067   200077 056100                    ASQ     COL,,AUTO

   2840 18 000070   000042 115007                    CMPA    34,DL
        18 000071   000043 600000 18                 TZE     s:2822

      310     2843
      311     2844            /* Get sign */
      312     2845    2       DO SELECT(CLASS);

   2845 18 000072   200100 236100                    LDQ     CLASS,,AUTO
        18 000073   000012 116007                    CMPQ    10,DL
        18 000074   000156 604000 18                 TMI     s:2896
        18 000075   000101 600000 18                 TZE     s:2848
        18 000076   000013 116007                    CMPQ    11,DL
        18 000077   000156 601000 18                 TNZ     s:2896
        18 000100   000130 710000 18                 TRA     s:2871

      313     2846
      314     2847    2         SELECT(%PLUS);

      315     2848    2           NUM_DESC.MANTISSA_SIGN = '+';
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:76   

   2848 18 000101   200005 473500                    LDP3    @NUM_DESC,,AUTO
        18 000102   053000 236003                    LDQ     22016,DU
        18 000103   300006 552140                    STBQ    6,'40'O,PR3

      316     2849                %ADV_COL;

   2851 18 000104   200077 054100                    AOS     COL,,AUTO

   2854 18 000105   200077 236100                    LDQ     COL,,AUTO
        18 000106   000000 116100                    CMPQ    0,,PR0
        18 000107   000112 605000 18                 TPL     s:2857

   2855 18 000110   200101 756100                    STQ     LAST_COL,,AUTO
        18 000111   000113 710000 18                 TRA     s:2861

   2857 18 000112   000000 702200 xent               TSX2  ! X66_ARET

   2861 18 000113   000000 720100                    LXL0    0,,PR0
        18 000114   777657 621006                    EAX1    -81,QL
        18 000115   777777 661003                    ERX1    -1,DU
        18 000116   000000 164546                    TCT
        18 000117   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000120   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000121   200077 000100                    ARG     COL,,AUTO
        18 000122   200077 235100                    LDA     COL,,AUTO
        18 000123   000033 771000                    ARL     27
        18 000124   200100 755100                    STA     CLASS,,AUTO
        18 000125   200077 551140                    STBA    COL,'40'O,AUTO
        18 000126   200077 056100                    ASQ     COL,,AUTO

   2867 18 000127   000156 710000 18                 TRA     s:2896

      317     2869
      318     2870    2         SELECT(%MINUS);

      319     2871    2           NUM_DESC.MANTISSA_SIGN = '-';
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:77   

   2871 18 000130   200005 473500                    LDP3    @NUM_DESC,,AUTO
        18 000131   055000 236003                    LDQ     23040,DU
        18 000132   300006 552140                    STBQ    6,'40'O,PR3

      320     2872                %ADV_COL;

   2874 18 000133   200077 054100                    AOS     COL,,AUTO

   2877 18 000134   200077 236100                    LDQ     COL,,AUTO
        18 000135   000000 116100                    CMPQ    0,,PR0
        18 000136   000141 605000 18                 TPL     s:2880

   2878 18 000137   200101 756100                    STQ     LAST_COL,,AUTO
        18 000140   000142 710000 18                 TRA     s:2884

   2880 18 000141   000000 702200 xent               TSX2  ! X66_ARET

   2884 18 000142   000000 720100                    LXL0    0,,PR0
        18 000143   777657 621006                    EAX1    -81,QL
        18 000144   777777 661003                    ERX1    -1,DU
        18 000145   000000 164546                    TCT
        18 000146   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000147   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000150   200077 000100                    ARG     COL,,AUTO
        18 000151   200077 235100                    LDA     COL,,AUTO
        18 000152   000033 771000                    ARL     27
        18 000153   200100 755100                    STA     CLASS,,AUTO
        18 000154   200077 551140                    STBA    COL,'40'O,AUTO
        18 000155   200077 056100                    ASQ     COL,,AUTO

      321     2892
      322     2893    2       END;

      323     2894
      324     2895            /* Get leading digits */
      325     2896    1       IF CLASS = %DIGIT THEN
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:78   

   2896 18 000156   000002 115007                    CMPA    2,DL
        18 000157   000207 601000 18                 TNZ     s:2918

      326     2897    2         DO;

      327     2898    2           NUM_DESC.LEFT_POS = COL;

   2898 18 000160   200005 473500                    LDP3    @NUM_DESC,,AUTO
        18 000161   200077 236100                    LDQ     COL,,AUTO
        18 000162   300001 756100                    STQ     1,,PR3

      328     2899                %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);

   2900 18 000163   000000 720100                    LXL0    0,,PR0
        18 000164   200101 236100                    LDQ     LAST_COL,,AUTO
        18 000165   000000 164546                    TCT
        18 000166   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000167   000200 000000 0                  ARG     DIGIT_SCAN_TABLE
        18 000170   200077 000100                    ARG     COL,,AUTO
        18 000171   200077 235100                    LDA     COL,,AUTO
        18 000172   000033 771000                    ARL     27
        18 000173   200100 755100                    STA     CLASS,,AUTO
        18 000174   200077 551140                    STBA    COL,'40'O,AUTO
        18 000175   200077 056100                    ASQ     COL,,AUTO

      329     2906    2           NUM_DESC.DIGITS_LEFT = COL - LAST_COL;

   2906 18 000176   200077 236100                    LDQ     COL,,AUTO
        18 000177   200101 136100                    SBLQ    LAST_COL,,AUTO
        18 000200   300000 756100                    STQ     0,,PR3

      330     2907                %CHECK_EOT;

   2909 18 000201   200077 236100                    LDQ     COL,,AUTO
        18 000202   000000 116100                    CMPQ    0,,PR0
        18 000203   000206 605000 18                 TPL     s:2912
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:79   

   2910 18 000204   200101 756100                    STQ     LAST_COL,,AUTO
        18 000205   000207 710000 18                 TRA     s:2918

   2912 18 000206   000000 702200 xent               TSX2  ! X66_ARET

      331     2915    2         END;
      332     2916
      333     2917            /* Check decimal point */
      334     2918    1       IF CLASS = %PERIOD

   2918 18 000207   000014 115007                    CMPA    12,DL
        18 000210   000215 600000 18                 TZE     s:2925
        18 000211   000035 115007                    CMPA    29,DL
        18 000212   000270 601000 18                 TNZ     s:2968
        18 000213   000007 234000 1                  SZN     LIBCOM+7
        18 000214   000270 605000 18                 TPL     s:2968

      335     2919    1       OR ( CLASS = %COMMA AND LIBCOM.COMMA_DECIMAL ) THEN
      336     2920    2         DO;

      337     2921
      338     2922
      339     2923                %ADV_COL;

   2925 18 000215   200077 054100                    AOS     COL,,AUTO

   2928 18 000216   200077 236100                    LDQ     COL,,AUTO
        18 000217   000000 116100                    CMPQ    0,,PR0
        18 000220   000223 605000 18                 TPL     s:2931

   2929 18 000221   200101 756100                    STQ     LAST_COL,,AUTO
        18 000222   000224 710000 18                 TRA     s:2935

   2931 18 000223   000000 702200 xent               TSX2  ! X66_ARET

   2935 18 000224   000000 720100                    LXL0    0,,PR0
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:80   
        18 000225   777657 621006                    EAX1    -81,QL
        18 000226   777777 661003                    ERX1    -1,DU
        18 000227   000000 164546                    TCT
        18 000230   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000231   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000232   200077 000100                    ARG     COL,,AUTO
        18 000233   200077 235100                    LDA     COL,,AUTO
        18 000234   000033 771000                    ARL     27
        18 000235   200100 755100                    STA     CLASS,,AUTO
        18 000236   200077 551140                    STBA    COL,'40'O,AUTO
        18 000237   200077 056100                    ASQ     COL,,AUTO

      340     2943
      341     2944                /* Fractional digits */
      342     2945    2           IF CLASS = %DIGIT THEN

   2945 18 000240   000002 115007                    CMPA    2,DL
        18 000241   000270 601000 18                 TNZ     s:2968

      343     2946    3             DO;

      344     2947    3               NUM_DESC.RIGHT_POS = COL;

   2947 18 000242   200005 473500                    LDP3    @NUM_DESC,,AUTO
        18 000243   200077 235100                    LDA     COL,,AUTO
        18 000244   300003 755100                    STA     3,,PR3

      345     2948                    %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);

   2949 18 000245   000000 720100                    LXL0    0,,PR0
        18 000246   000000 164546                    TCT
        18 000247   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000250   000200 000000 0                  ARG     DIGIT_SCAN_TABLE
        18 000251   200077 000100                    ARG     COL,,AUTO
        18 000252   200077 235100                    LDA     COL,,AUTO
        18 000253   000033 771000                    ARL     27
        18 000254   200100 755100                    STA     CLASS,,AUTO
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:81   
        18 000255   200077 551140                    STBA    COL,'40'O,AUTO
        18 000256   200077 056100                    ASQ     COL,,AUTO

      346     2955    3               NUM_DESC.DIGITS_RIGHT = COL - LAST_COL;

   2955 18 000257   200077 236100                    LDQ     COL,,AUTO
        18 000260   200101 136100                    SBLQ    LAST_COL,,AUTO
        18 000261   300002 756100                    STQ     2,,PR3

      347     2956                    %CHECK_EOT;

   2958 18 000262   200077 236100                    LDQ     COL,,AUTO
        18 000263   000000 116100                    CMPQ    0,,PR0
        18 000264   000267 605000 18                 TPL     s:2961

   2959 18 000265   200101 756100                    STQ     LAST_COL,,AUTO
        18 000266   000270 710000 18                 TRA     s:2968

   2961 18 000267   000000 702200 xent               TSX2  ! X66_ARET

      348     2964    3             END;
      349     2965    2         END;
      350     2966         %EJECT;
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:82   
      351     2967                /* Exponent */
      352     2968    1           IF CLASS = %LETTER_E THEN

   2968 18 000270   000041 115007                    CMPA    33,DL
        18 000271   000437 601000 18                 TNZ     s:3072

      353     2969    2             DO;

      354     2970    2               IF NUM_DESC.DIGITS_RIGHT + NUM_DESC.DIGITS_LEFT = 0 THEN

   2970 18 000272   200005 473500                    LDP3    @NUM_DESC,,AUTO
        18 000273   300002 236100                    LDQ     2,,PR3
        18 000274   300000 036100                    ADLQ    0,,PR3
        18 000275   000277 601000 18                 TNZ     s:2975

      355     2971    2                 ALTRETURN;

   2971 18 000276   000000 702200 xent               TSX2  ! X66_AALT

      356     2972    2               ELSE
      357     2973                      %ADV_COL;

   2975 18 000277   200077 054100                    AOS     COL,,AUTO

   2978 18 000300   200077 236100                    LDQ     COL,,AUTO
        18 000301   000000 116100                    CMPQ    0,,PR0
        18 000302   000305 605000 18                 TPL     s:2981

   2979 18 000303   200101 756100                    STQ     LAST_COL,,AUTO
        18 000304   000306 710000 18                 TRA     s:2985

   2981 18 000305   000000 702200 xent               TSX2  ! X66_ARET

   2985 18 000306   000000 720100                    LXL0    0,,PR0
        18 000307   777657 621006                    EAX1    -81,QL
        18 000310   777777 661003                    ERX1    -1,DU
        18 000311   000000 164546                    TCT
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:83   
        18 000312   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000313   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000314   200077 000100                    ARG     COL,,AUTO
        18 000315   200077 235100                    LDA     COL,,AUTO
        18 000316   000033 771000                    ARL     27
        18 000317   200100 755100                    STA     CLASS,,AUTO
        18 000320   200077 551140                    STBA    COL,'40'O,AUTO
        18 000321   200077 056100                    ASQ     COL,,AUTO

      358     2993
      359     2994                    /* Sign on exponent */
      360     2995    3               DO SELECT (CLASS);

   2995 18 000322   200100 236100                    LDQ     CLASS,,AUTO
        18 000323   000012 116007                    CMPQ    10,DL
        18 000324   000404 604000 18                 TMI     s:3046
        18 000325   000331 600000 18                 TZE     s:2998
        18 000326   000013 116007                    CMPQ    11,DL
        18 000327   000404 601000 18                 TNZ     s:3046
        18 000330   000357 710000 18                 TRA     s:3021

      361     2996
      362     2997    3                 SELECT(%PLUS);

      363     2998    3                   NUM_DESC.EXP_SIGN = '+' ;

   2998 18 000331   000053 236003                    LDQ     43,DU
        18 000332   300006 552120                    STBQ    6,'20'O,PR3

      364     2999                        %ADV_COL;

   3001 18 000333   200077 054100                    AOS     COL,,AUTO

   3004 18 000334   200077 236100                    LDQ     COL,,AUTO
        18 000335   000000 116100                    CMPQ    0,,PR0
        18 000336   000341 605000 18                 TPL     s:3007

PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:84   
   3005 18 000337   200101 756100                    STQ     LAST_COL,,AUTO
        18 000340   000342 710000 18                 TRA     s:3011

   3007 18 000341   000000 702200 xent               TSX2  ! X66_ARET

   3011 18 000342   000000 720100                    LXL0    0,,PR0
        18 000343   777657 621006                    EAX1    -81,QL
        18 000344   777777 661003                    ERX1    -1,DU
        18 000345   000000 164546                    TCT
        18 000346   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000347   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000350   200077 000100                    ARG     COL,,AUTO
        18 000351   200077 235100                    LDA     COL,,AUTO
        18 000352   000033 771000                    ARL     27
        18 000353   200100 755100                    STA     CLASS,,AUTO
        18 000354   200077 551140                    STBA    COL,'40'O,AUTO
        18 000355   200077 056100                    ASQ     COL,,AUTO

   3017 18 000356   000404 710000 18                 TRA     s:3046

      365     3019
      366     3020    3                 SELECT(%MINUS);

      367     3021    3                   NUM_DESC.EXP_SIGN = '-' ;

   3021 18 000357   000055 236003                    LDQ     45,DU
        18 000360   300006 552120                    STBQ    6,'20'O,PR3

      368     3022                        %ADV_COL;

   3024 18 000361   200077 054100                    AOS     COL,,AUTO

   3027 18 000362   200077 236100                    LDQ     COL,,AUTO
        18 000363   000000 116100                    CMPQ    0,,PR0
        18 000364   000367 605000 18                 TPL     s:3030

   3028 18 000365   200101 756100                    STQ     LAST_COL,,AUTO
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:85   
        18 000366   000370 710000 18                 TRA     s:3034

   3030 18 000367   000000 702200 xent               TSX2  ! X66_ARET

   3034 18 000370   000000 720100                    LXL0    0,,PR0
        18 000371   777657 621006                    EAX1    -81,QL
        18 000372   777777 661003                    ERX1    -1,DU
        18 000373   000000 164546                    TCT
        18 000374   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000375   000000 000000 0                  ARG     ASCII_SEARCH_TABLE
        18 000376   200077 000100                    ARG     COL,,AUTO
        18 000377   200077 235100                    LDA     COL,,AUTO
        18 000400   000033 771000                    ARL     27
        18 000401   200100 755100                    STA     CLASS,,AUTO
        18 000402   200077 551140                    STBA    COL,'40'O,AUTO
        18 000403   200077 056100                    ASQ     COL,,AUTO

      369     3042
      370     3043    3               END;

      371     3044
      372     3045                    /* Exponent digits */
      373     3046    2               IF CLASS = %DIGIT THEN

   3046 18 000404   000002 115007                    CMPA    2,DL
        18 000405   000434 601000 18                 TNZ     s:3066

      374     3047    3                 DO;

      375     3048    3                   NUM_DESC.EXP_POS = COL;

   3048 18 000406   200077 236100                    LDQ     COL,,AUTO
        18 000407   300005 756100                    STQ     5,,PR3

      376     3049                        %SCAN_SEARCH(TABLE=DIGIT_SCAN_TABLE);

   3050 18 000410   000000 720100                    LXL0    0,,PR0
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:86   
        18 000411   200101 236100                    LDQ     LAST_COL,,AUTO
        18 000412   000000 164546                    TCT
        18 000413   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1
        18 000414   000200 000000 0                  ARG     DIGIT_SCAN_TABLE
        18 000415   200077 000100                    ARG     COL,,AUTO
        18 000416   200077 235100                    LDA     COL,,AUTO
        18 000417   000033 771000                    ARL     27
        18 000420   200100 755100                    STA     CLASS,,AUTO
        18 000421   200077 551140                    STBA    COL,'40'O,AUTO
        18 000422   200077 056100                    ASQ     COL,,AUTO

      377     3056    3                   NUM_DESC.DIGITS_EXP = COL - LAST_COL;

   3056 18 000423   200077 236100                    LDQ     COL,,AUTO
        18 000424   200101 136100                    SBLQ    LAST_COL,,AUTO
        18 000425   300004 756100                    STQ     4,,PR3

      378     3057                        %CHECK_EOT;

   3059 18 000426   200077 236100                    LDQ     COL,,AUTO
        18 000427   000000 116100                    CMPQ    0,,PR0
        18 000430   000433 605000 18                 TPL     s:3062

   3060 18 000431   200101 756100                    STQ     LAST_COL,,AUTO
        18 000432   000434 710000 18                 TRA     s:3066

   3062 18 000433   000000 702200 xent               TSX2  ! X66_ARET

      379     3065    3                 END;
      380     3066    2               IF NUM_DESC.DIGITS_EXP = 0 THEN

   3066 18 000434   300004 235100                    LDA     4,,PR3
        18 000435   000437 601000 18                 TNZ     s:3072

      381     3067    2                 ALTRETURN;

   3067 18 000436   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:87   

      382     3068
      383     3069    2             END;
      384     3070
      385     3071            /* If we got here, there was an error in the NUMERIC_LITERAL */
      386     3072    1       IF CLASS = %SPACE THEN

   3072 18 000437   200100 235100                    LDA     CLASS,,AUTO
        18 000440   000042 115007                    CMPA    34,DL
        18 000441   000443 601000 18                 TNZ     s:3075

      387     3073    1         RETURN;

   3073 18 000442   000000 702200 xent               TSX2  ! X66_ARET

      388     3074    1       ELSE
      389     3075    1         ALTRETURN;

   3075 18 000443   000000 702200 xent               TSX2  ! X66_AALT
      390     3076
      391     3077    1   END X8AV$CREATE_NUM_DESC;
      392     3078        %EJECT;
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:88   

PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:89   
--  Include file information  --

   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_MACROS.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_TABLES.:X8A6TOU  cannot be made into a system file and is referenced.
   Z8E_WINDOW.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure X8AV$CREATE_NUM_DESC.
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:90   

 **** Variables and constants ****

  ****  Section 000 RoData X8AV$CREATE_NUM_DESC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b UBIN(9)     r     1 ASCII_SEARCH_TABLE(0:511)
   200-0-0/b UBIN(9)     r     1 DIGIT_SCAN_TABLE(0:511)

  ****  Section 001 LblCom LIBCOM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(720)   r     1 LIBCOM

  ****  Section 002 LblCom DEC_OR_COMMA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 DEC_OR_COMMA

  ****  Section 003 LblCom IN_TEMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)          1 IN_TEMP

  ****  Section 004 LblCom OVRCHR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 OVRCHR
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:91   

  ****  Section 005 LblCom SELECT_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 SELECT_TIME

  ****  Section 006 LblCom NO_ADVANCE_OFFSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 NO_ADVANCE_OFFSET

  ****  Section 007 LblCom DSPLY_SAVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)          1 DSPLY_SAVE

  ****  Section 008 LblCom D_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)          1 D_DATE

  ****  Section 009 LblCom D_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(11)          1 D_TIME

  ****  Section 010 LblCom D_DAY
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:92   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)           1 D_DAY

  ****  Section 011 LblCom C_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)           1 C_DATE

  ****  Section 012 LblCom C_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)           1 C_TIME

  ****  Section 013 LblCom C_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)           1 C_DAY

  ****  Section 014 LblCom RTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 RTHOLD2

  ****  Section 015 LblCom LTHOLD2

  ****  Scalars and arrays  ****
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:93   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTHOLD2

  ****  Section 016 LblCom NDX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 NDX2

  ****  Section 017 LblCom IN_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 IN_LEN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @LENGTH                    5-0-0/w PTR         r     1 @NUM_DESC
     3-0-0/w PTR         r     1 @SYMBOL                  100-0-0/w SBIN        r     1 CLASS
    77-0-0/w SBIN        r     1 COL                      101-0-0/w SBIN        r     1 LAST_COL
    *0-0-0/w SBIN        r     1 LENGTH                     6-0-0/w SBIN              1 LT
     7-0-0/c CHAR(65)          1 LTHOLD                    51-0-0/w SBIN              1 NDX
    52-0-0/w SBIN              1 NDX3                      *0-0-0/w STRC(234)   r     1 NUM_DESC
    30-0-0/c CHAR(65)          1 RTHOLD                    53-0-0/c CHAR(80)          1 SPECIAL_ERR_MSG
    *0-0-0/c ACHR        r     1 SYMBOL


   Procedure X8AV$CREATE_NUM_DESC requires 292 words for executable code.
   Procedure X8AV$CREATE_NUM_DESC requires 66 words of local(AUTO) storage.
PL6.E3A0      #002=X8AV$CREATE_NUM_DESC File=X8AV.:X8A6TSI                       SAT 08/09/97 10:46 Page:94   

    No errors detected in file X8AV.:X8A6TSI    .
