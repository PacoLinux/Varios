VERSION E05

PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:1    
        1        1        /*M*    VEX$WRITE_REC - WRITE SPECIFIED TO SPECIFIED KEY IN EDIT FILE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        VEX$WRITE_REC: PROC(DCB#,WRITEKEY) ALTRET;
        9        9        /**/
       10       10        /**/
       11       11        /*F*     NAME:     VEX$WRITE_REC
       12       12                 PURPOSE:  TO WRITE A RECORD TO AN EDIT FILE      */
       13       13        /**/
       14       14        /*D*     NAME:     VEX$WRITE_REC
       15       15                 PARAMETERS: DCB# - DCB TO WRITE THE RECORD THROUGH
       16       16                           WRITEKEY - KEY OF THE RECORD TO BE WRITTEN
       17       17                 DESCRIPTION: THE DCB# AND WRITEKEY ARE SET INTO THE FPT AND
       18       18                           A CARRIAGE RETURN IS ADDED TO THE TEXT OF THE RECORD
       19       19                           IF 'CR ON' IS SET. M$WRITE IS CALLED TO WRITE THE
       20       20                           RECORD FROM REC_BUF. ANY ERROR CAUSES AN ALTRETURN
       21       21                           ELSE VEX$WRITE_REC RETURNS NORMALLY      */
       22       22        /**********************************************************************/
       23       23        /*   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   */
       24       24        /**********************************************************************/
       25       25    1   DCL DCB# UBIN(36);
       26       26    1   DCL WRITEKEY CHAR(64);
       27       27    1   DCL 1 WRITEKEY_U REDEF WRITEKEY ,
       28       28    1          2 KEY UBIN WORD ,
       29       29    1          2 * CHAR(60) ;
       30       30        /**/
       31       31        %INCLUDE VE_SUBS_C;
       32      225        /*****************************************************************/
       33      226        /*   AUTO DATA   AUTO DATA   AUTO DATA   AUTO DATA   AUTO DATA   */
       34      227        /*****************************************************************/
       35      228    1   DCL TEMP_STRING CHAR(PC_RECSIZE#) AUTO;
       36      229    1   DCL I UBIN WORD AUTO;
       37      230    1   DCL J SBIN WORD AUTO;
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:2    
       38      231    1   DCL TAB_INDEX UBIN WORD AUTO;
       39      232    1   DCL REC_POSIT UBIN WORD AUTO;
       40      233        /**/
       41      234        /***************************************************************************/
       42      235        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       43      236        /***************************************************************************/
       44      237    1   DCL WRITE_KEY CHAR(64) STATIC SYMDEF;
       45      238    1   DCL 1 WRITE_KEY_U REDEF WRITE_KEY ,
       46      239    1          2 KEY UBIN(36) ,
       47      240    1          2 * CHAR(60) ;
       48      241    1   DCL DVBYTE BIT(36) SYMREF ;
       49      242        /**/
       50      243        /********************************************************************/
       51      244        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       52      245        /********************************************************************/
       53      246        %INCLUDE VE_PERR_C;
       54      463        %INCLUDE CP_6;
       55      544        %FPT_WRITE    (FPTN = WRITE_REC_FPT,
       56      545                      BUF = REC_BUF) ;
       57      576        /*****************************************************************/
       58      577        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
       59      578        /*****************************************************************/
       60      579        /**/
       61      580        %INCLUDE VE_FLAGS_R;
       62      631        %INCLUDE B$TABLES_C;
       63      739        %B$SR_NON_BLANK;
       64      743        /**/
       65      744    1   DCL FILE_TYP UBIN WORD SYMREF ;
       66      745    1   DCL 1 REC_BUF CHAR(PC_RECSIZE#) SYMREF;
       67      746    1   DCL 1 REC_BUF_ARRAY(0:PC_RECMAX#) REDEF REC_BUF CHAR(1) CALIGNED;
       68      747    1   DCL CRET CHAR(1) SYMREF;
       69      748    1   DCL REC_SIZE UBIN(36) SYMREF;
       70      749    1   DCL RP_REC_SIZE UBIN WORD SYMREF;
       71      750    1   DCL TRNC_COUNT UBIN WORD SYMREF;
       72      751    1   DCL CMD_CODE UBIN WORD SYMREF;
       73      752    1   DCL M$FILE_NUM UBIN(36) SYMREF;
       74      753    1   DCL SEED BIT(36) SYMREF;
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:3    
       75      754    1   DCL NUM_TABS UBIN WORD SYMREF;
       76      755    1   DCL BSPACECHAR CHAR(1) SYMREF;
       77      756    1   DCL TABCHAR CHAR(1) SYMREF;
       78      757    1   DCL TRTBL (0:511) BIT(9) SYMREF ;
       79      758    1   DCL Y003 UBIN WORD SYMREF;
       80      759        /**/
       81      760        %VLP_TAB (FPTN=TAB_VLP,
       82      761                  STCLASS = SYMREF);
       83      775        /**/
       84      776    1   DCL VEX$ERROR ENTRY(2) ALTRET;
       85      777        /*****************************************************************************/
       86      778        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
       87      779        /*****************************************************************************/
       88      780    1        IF (FLAGS.CONSEC_MODE)AND(DCB#=M$FILE_NUM)AND(CMD_CODE ~= APCMD)AND
       89      781    1           (CMD_CODE ~= INCMD)AND(CMD_CODE ~= ISCMD) THEN
       90      782    1           WRITE_REC_FPT.V.REWRITE# = '1'B;
       91      783    1        ELSE WRITE_REC_FPT.V.REWRITE# = '0'B;
       92      784        /**/
       93      785    1        WRITE_REC_FPT.V.SEED# = SEED;      /* ENCRYPTION*/
       94      786        /**/
       95      787    1        WRITE_REC_FPT.V.DCB# = DCB#;
       96      788        /**/
       97      789    1        WRITE_REC_FPT.KEY_ = VECTOR(WRITE_KEY) ;
       98      790        /**/
       99      791    1        IF (FLAGS.REL_MODE)AND(DCB# = M$FILE_NUM) THEN WRITE_KEY_U.KEY = (WRITEKEY_U.
               791                 KEY - Y003)/1000;
      100      792    1        ELSE WRITE_KEY = WRITEKEY;
      101      793        /**/
      102      794    1        I = 0;
      103      795    1        REC_POSIT = 0;
      104      796        /**/
      105      797    1   NEXT_TAB:
      106      798    2        IF (FLAGS.TABCFLAG) THEN DO WHILE(I <= REC_SIZE);
      107      799    2           IF (SUBSTR(REC_BUF,I,1) = BSPACECHAR) THEN REC_POSIT = REC_POSIT - 1;
      108      800    2           ELSE REC_POSIT = REC_POSIT + 1;
      109      801        /**/
      110      802    3           DO TAB_INDEX = 0 TO NUM_TABS-1;
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:4    
      111      803    3              IF (TAB_VLP.TABS#(TAB_INDEX)=REC_POSIT + 1) THEN GOTO GOT_TAB;
      112      804    3              END;
      113      805    2           I = I + 1;
      114      806    2           END;
      115      807        /**/
      116      808    1        CALL SEARCHR (REC_SIZE , I , B$SR_NON_BLANK , SUBSTR(REC_BUF,,REC_SIZE)) ALTRET
               808                 (ALL_BLANK);
      117      809    2        DO WHILE ('0'B);
      118      810    2   ALL_BLANK: REC_SIZE = 0;
      119      811    2           END;
      120      812    2        IF (FLAGS.RPFLAG) THEN DO;
      121      813    2           IF (REC_SIZE >= RP_REC_SIZE) THEN TRNC_COUNT = TRNC_COUNT + 1;
      122      814    2           ELSE SUBSTR(REC_BUF , REC_SIZE+1) = ' ';
      123      815    2           IF RP_REC_SIZE = 0
      124      816    2           THEN GOTO NOTHING_TO_WRITE ;
      125      817    2           ELSE REC_SIZE = RP_REC_SIZE - 1;
      126      818    2           END;
      127      819        /**/
      128      820    2        IF ((FLAGS.CRFLAG) AND (REC_BUF_ARRAY(REC_SIZE)~= CRET)) THEN DO;
      129      821    2           REC_SIZE = REC_SIZE+1;
      130      822    2           IF CMD_CODE = BUILDCMD
      131      823    2           THEN RP_REC_SIZE = RP_REC_SIZE+1;
      132      824    2           REC_BUF_ARRAY(REC_SIZE) = CRET;
      133      825    2           END;
      134      826        /**/
      135      827    1        WRITE_REC_FPT.BUF_.BOUND = REC_SIZE ;
      136      828    1        WRITE_REC_FPT.V.DVBYTE = DVBYTE ;
      137      829    1        CALL M$WRITE (WRITE_REC_FPT) ALTRET (WRITE_REC_ALT);
      138      830    1   NOTHING_TO_WRITE:
      139      831    1        REC_SIZE = REC_SIZE + 1;
      140      832    1        RETURN;
      141      833        /**/
      142      834    1   GOT_TAB:
      143      835    2        IF (SUBSTR(REC_BUF,I,1) ~= ' ') THEN DO;
      144      836    2           I = I+1;                        /* NO BLANKS TO COMPRESS              */
      145      837    2           GOTO NEXT_TAB;
      146      838    2           END;
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:5    
      147      839        /**/
      148      840    1        J = I;
      149      841    2        DO WHILE ((J >= 0)AND(SUBSTR(REC_BUF,J,1) = ' '));
      150      842    2           J = J-1;
      151      843    2           END;
      152      844    1        J = J+1;
      153      845    1        TEMP_STRING = SUBSTR(REC_BUF,I+1,REC_SIZE-(I+1));
      154      846    1        CALL INSERT(REC_BUF,J,,TABCHAR,TEMP_STRING);
      155      847    1        REC_SIZE = REC_SIZE - (I-J);
      156      848    1        I = J+1;
      157      849    1        GOTO NEXT_TAB;
      158      850        /**/
      159      851    1   WRITE_REC_ALT:
      160      852    1        CALL VEX$ERROR(0,3);
      161      853    1        ALTRETURN;
      162      854    1   END;

PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:6    
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   VE_FLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEX$WRITE_REC.

   Procedure VEX$WRITE_REC requires 213 words for executable code.
   Procedure VEX$WRITE_REC requires 268 words of local(AUTO) storage.

    No errors detected in file VEX$WRITE_REC.:E05TSI    .

PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:7    

 Object Unit name= VEX$WRITE_REC                              File name= VEX$WRITE_REC.:E05TOU
 UTS= JUL 30 '97 07:17:29.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    28     34  VEX$WRITE_REC
    1   DCB   even  none     0      0  M$UC
    2   Proc  even  none   213    325  VEX$WRITE_REC
    3  RoData even  none     6      6  VEX$WRITE_REC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  VEX$WRITE_REC

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  WRITE_KEY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       2 VEX$ERROR
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:8    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DVBYTE                                M$UC                                  FLAGS
r    B$SR_NON_BLANK$                       REC_BUF                               CRET
     REC_SIZE                              RP_REC_SIZE                           TRNC_COUNT
     CMD_CODE                              M$FILE_NUM                            SEED
     NUM_TABS                              BSPACECHAR                            TABCHAR
     Y003                                  TAB_VLP                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:9    


        1        1        /*M*    VEX$WRITE_REC - WRITE SPECIFIED TO SPECIFIED KEY IN EDIT FILE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=3,CTI=3,SDI=3,MCL=10,CSI=0,ECI=0 */
        8        8        VEX$WRITE_REC: PROC(DCB#,WRITEKEY) ALTRET;

      8  2 000000   000000 700200 xent  VEX$WRITE_R* TSX0  ! X66_AUTO_2
         2 000001   000414 000002                    ZERO    268,2

        9        9        /**/
       10       10        /**/
       11       11        /*F*     NAME:     VEX$WRITE_REC
       12       12                 PURPOSE:  TO WRITE A RECORD TO AN EDIT FILE      */
       13       13        /**/
       14       14        /*D*     NAME:     VEX$WRITE_REC
       15       15                 PARAMETERS: DCB# - DCB TO WRITE THE RECORD THROUGH
       16       16                           WRITEKEY - KEY OF THE RECORD TO BE WRITTEN
       17       17                 DESCRIPTION: THE DCB# AND WRITEKEY ARE SET INTO THE FPT AND
       18       18                           A CARRIAGE RETURN IS ADDED TO THE TEXT OF THE RECORD
       19       19                           IF 'CR ON' IS SET. M$WRITE IS CALLED TO WRITE THE
       20       20                           RECORD FROM REC_BUF. ANY ERROR CAUSES AN ALTRETURN
       21       21                           ELSE VEX$WRITE_REC RETURNS NORMALLY      */
       22       22        /**********************************************************************/
       23       23        /*   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   PARAMETERS   */
       24       24        /**********************************************************************/
       25       25    1   DCL DCB# UBIN(36);
       26       26    1   DCL WRITEKEY CHAR(64);
       27       27    1   DCL 1 WRITEKEY_U REDEF WRITEKEY ,
       28       28    1          2 KEY UBIN WORD ,
       29       29    1          2 * CHAR(60) ;
       30       30        /**/
       31       31        %INCLUDE VE_SUBS_C;
       32      225        /*****************************************************************/
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:10   
       33      226        /*   AUTO DATA   AUTO DATA   AUTO DATA   AUTO DATA   AUTO DATA   */
       34      227        /*****************************************************************/
       35      228    1   DCL TEMP_STRING CHAR(PC_RECSIZE#) AUTO;
       36      229    1   DCL I UBIN WORD AUTO;
       37      230    1   DCL J SBIN WORD AUTO;
       38      231    1   DCL TAB_INDEX UBIN WORD AUTO;
       39      232    1   DCL REC_POSIT UBIN WORD AUTO;
       40      233        /**/
       41      234        /***************************************************************************/
       42      235        /*   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   STATIC DATA   */
       43      236        /***************************************************************************/
       44      237    1   DCL WRITE_KEY CHAR(64) STATIC SYMDEF;
       45      238    1   DCL 1 WRITE_KEY_U REDEF WRITE_KEY ,
       46      239    1          2 KEY UBIN(36) ,
       47      240    1          2 * CHAR(60) ;
       48      241    1   DCL DVBYTE BIT(36) SYMREF ;
       49      242        /**/
       50      243        /********************************************************************/
       51      244        /*   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   FPTS   */
       52      245        /********************************************************************/
       53      246        %INCLUDE VE_PERR_C;
       54      463        %INCLUDE CP_6;
       55      544        %FPT_WRITE    (FPTN = WRITE_REC_FPT,
       56      545                      BUF = REC_BUF) ;
       57      576        /*****************************************************************/
       58      577        /*   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   SYMREFS   */
       59      578        /*****************************************************************/
       60      579        /**/
       61      580        %INCLUDE VE_FLAGS_R;
       62      631        %INCLUDE B$TABLES_C;
       63      739        %B$SR_NON_BLANK;
       64      743        /**/
       65      744    1   DCL FILE_TYP UBIN WORD SYMREF ;
       66      745    1   DCL 1 REC_BUF CHAR(PC_RECSIZE#) SYMREF;
       67      746    1   DCL 1 REC_BUF_ARRAY(0:PC_RECMAX#) REDEF REC_BUF CHAR(1) CALIGNED;
       68      747    1   DCL CRET CHAR(1) SYMREF;
       69      748    1   DCL REC_SIZE UBIN(36) SYMREF;
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:11   
       70      749    1   DCL RP_REC_SIZE UBIN WORD SYMREF;
       71      750    1   DCL TRNC_COUNT UBIN WORD SYMREF;
       72      751    1   DCL CMD_CODE UBIN WORD SYMREF;
       73      752    1   DCL M$FILE_NUM UBIN(36) SYMREF;
       74      753    1   DCL SEED BIT(36) SYMREF;
       75      754    1   DCL NUM_TABS UBIN WORD SYMREF;
       76      755    1   DCL BSPACECHAR CHAR(1) SYMREF;
       77      756    1   DCL TABCHAR CHAR(1) SYMREF;
       78      757    1   DCL TRTBL (0:511) BIT(9) SYMREF ;
       79      758    1   DCL Y003 UBIN WORD SYMREF;
       80      759        /**/
       81      760        %VLP_TAB (FPTN=TAB_VLP,
       82      761                  STCLASS = SYMREF);
       83      775        /**/
       84      776    1   DCL VEX$ERROR ENTRY(2) ALTRET;
       85      777        /*****************************************************************************/
       86      778        /*   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   PROCEDURE   */
       87      779        /*****************************************************************************/
       88      780    1        IF (FLAGS.CONSEC_MODE)AND(DCB#=M$FILE_NUM)AND(CMD_CODE ~= APCMD)AND

    780  2 000002   000000 236000 xsym               LDQ     FLAGS
         2 000003   002000 316003                    CANQ    1024,DU
         2 000004   000023 600000 2                  TZE     s:783
         2 000005   200003 470500                    LDP0    @DCB#,,AUTO
         2 000006   000000 236100                    LDQ     0,,PR0
         2 000007   000000 116000 xsym               CMPQ    M$FILE_NUM
         2 000010   000023 601000 2                  TNZ     s:783
         2 000011   000000 235000 xsym               LDA     CMD_CODE
         2 000012   000053 115007                    CMPA    43,DL
         2 000013   000023 600000 2                  TZE     s:783
         2 000014   000046 115007                    CMPA    38,DL
         2 000015   000023 600000 2                  TZE     s:783
         2 000016   000050 115007                    CMPA    40,DL
         2 000017   000023 600000 2                  TZE     s:783

       89      781    1           (CMD_CODE ~= INCMD)AND(CMD_CODE ~= ISCMD) THEN
       90      782    1           WRITE_REC_FPT.V.REWRITE# = '1'B;
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:12   

    782  2 000020   000100 236007                    LDQ     64,DL
         2 000021   000030 256000 0                  ORSQ    WRITE_REC_FPT+8
         2 000022   000025 710000 2                  TRA     s:785

       91      783    1        ELSE WRITE_REC_FPT.V.REWRITE# = '0'B;

    783  2 000023   000000 236000 3                  LDQ     0
         2 000024   000030 356000 0                  ANSQ    WRITE_REC_FPT+8

       92      784        /**/
       93      785    1        WRITE_REC_FPT.V.SEED# = SEED;      /* ENCRYPTION*/

    785  2 000025   000000 236000 xsym               LDQ     SEED
         2 000026   000032 756000 0                  STQ     WRITE_REC_FPT+10

       94      786        /**/
       95      787    1        WRITE_REC_FPT.V.DCB# = DCB#;

    787  2 000027   200003 470500                    LDP0    @DCB#,,AUTO
         2 000030   000000 720100                    LXL0    0,,PR0
         2 000031   000030 740000 0                  STX0    WRITE_REC_FPT+8

       96      788        /**/
       97      789    1        WRITE_REC_FPT.KEY_ = VECTOR(WRITE_KEY) ;

    789  2 000032   000002 237000 3                  LDAQ    2
         2 000033   000022 757000 0                  STAQ    WRITE_REC_FPT+2

       98      790        /**/
       99      791    1        IF (FLAGS.REL_MODE)AND(DCB# = M$FILE_NUM) THEN WRITE_KEY_U.KEY = (WRITEKEY_U.
               791                 KEY - Y003)/1000;

    791  2 000034   000000 236000 xsym               LDQ     FLAGS
         2 000035   400000 316007                    CANQ    -131072,DL
         2 000036   000050 600000 2                  TZE     s:792
         2 000037   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:13   
         2 000040   000000 116000 xsym               CMPQ    M$FILE_NUM
         2 000041   000050 601000 2                  TNZ     s:792

    791  2 000042   200004 471500                    LDP1    @WRITEKEY,,AUTO
         2 000043   100000 236100                    LDQ     0,,PR1
         2 000044   000000 136000 xsym               SBLQ    Y003
         2 000045   001750 506007                    DIV     1000,DL
         2 000046   000000 756000 0                  STQ     WRITE_KEY
         2 000047   000054 710000 2                  TRA     s:794

      100      792    1        ELSE WRITE_KEY = WRITEKEY;

    792  2 000050   200004 471500                    LDP1    @WRITEKEY,,AUTO
         2 000051   040000 100500                    MLR     fill='040'O
         2 000052   100000 000100                    ADSC9   0,,PR1                   cn=0,n=64
         2 000053   000000 000100 0                  ADSC9   WRITE_KEY                cn=0,n=64

      101      793        /**/
      102      794    1        I = 0;

    794  2 000054   200405 450100                    STZ     I,,AUTO

      103      795    1        REC_POSIT = 0;

    795  2 000055   200410 450100                    STZ     REC_POSIT,,AUTO

      104      796        /**/
      105      797    1   NEXT_TAB:
      106      798    2        IF (FLAGS.TABCFLAG) THEN DO WHILE(I <= REC_SIZE);

    798  2 000056   000000 236000 xsym  NEXT_TAB     LDQ     FLAGS
         2 000057   000001 316003                    CANQ    1,DU
         2 000060   000130 600000 2                  TZE     s:808

    798  2 000061   000000 236000 xsym               LDQ     REC_SIZE
         2 000062   200405 116100                    CMPQ    I,,AUTO
         2 000063   000130 602000 2                  TNC     s:808
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:14   

      107      799    2           IF (SUBSTR(REC_BUF,I,1) = BSPACECHAR) THEN REC_POSIT = REC_POSIT - 1;

    799  2 000064   200405 235100                    LDA     I,,AUTO
         2 000065   040000 106405                    CMPC    fill='040'O
         2 000066   000000 000001 xsym               ADSC9   REC_BUF,A                cn=0,n=1
         2 000067   000000 000001 xsym               ADSC9   BSPACECHAR               cn=0,n=1
         2 000070   000075 601000 2                  TNZ     s:800

    799  2 000071   200410 236100                    LDQ     REC_POSIT,,AUTO
         2 000072   000001 136007                    SBLQ    1,DL
         2 000073   200410 756100                    STQ     REC_POSIT,,AUTO
         2 000074   000100 710000 2                  TRA     s:802

      108      800    2           ELSE REC_POSIT = REC_POSIT + 1;

    800  2 000075   200410 236100                    LDQ     REC_POSIT,,AUTO
         2 000076   000001 036007                    ADLQ    1,DL
         2 000077   200410 756100                    STQ     REC_POSIT,,AUTO

      109      801        /**/
      110      802    3           DO TAB_INDEX = 0 TO NUM_TABS-1;

    802  2 000100   200407 450100                    STZ     TAB_INDEX,,AUTO
         2 000101   000117 710000 2                  TRA     s:804+3

      111      803    3              IF (TAB_VLP.TABS#(TAB_INDEX)=REC_POSIT + 1) THEN GOTO GOT_TAB;

    803  2 000102   200410 235100                    LDA     REC_POSIT,,AUTO
         2 000103   000001 035007                    ADLA    1,DL
         2 000104   200412 755100                    STA     REC_POSIT+2,,AUTO
         2 000105   200407 236100                    LDQ     TAB_INDEX,,AUTO
         2 000106   000100 101406                    MRL     fill='000'O
         2 000107   000000 200001 xsym               ADSC9   TAB_VLP,Q                cn=1,n=1
         2 000110   200413 000004                    ADSC9   REC_POSIT+3,,AUTO        cn=0,n=4
         2 000111   200413 236100                    LDQ     REC_POSIT+3,,AUTO
         2 000112   200412 116100                    CMPQ    REC_POSIT+2,,AUTO
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:15   
         2 000113   000236 600000 2                  TZE     GOT_TAB

      112      804    3              END;

    804  2 000114   200407 236100                    LDQ     TAB_INDEX,,AUTO
         2 000115   000001 036007                    ADLQ    1,DL
         2 000116   200407 756100                    STQ     TAB_INDEX,,AUTO
         2 000117   200407 236100                    LDQ     TAB_INDEX,,AUTO
         2 000120   000000 116000 xsym               CMPQ    NUM_TABS
         2 000121   000102 602000 2                  TNC     s:803

      113      805    2           I = I + 1;

    805  2 000122   200405 235100                    LDA     I,,AUTO
         2 000123   000001 035007                    ADLA    1,DL
         2 000124   200405 755100                    STA     I,,AUTO

      114      806    2           END;

    806  2 000125   000000 236000 xsym               LDQ     REC_SIZE
         2 000126   200405 116100                    CMPQ    I,,AUTO
         2 000127   000064 603000 2                  TRC     s:799

      115      807        /**/
      116      808    1       CALL SEARCHR (REC_SIZE , I , B$SR_NON_BLANK , SUBSTR(REC_BUF,,REC_SIZE)) ALTRET
               808                 (ALL_BLANK);

    808  2 000130   000000 236000 xsym               LDQ     REC_SIZE
         2 000131   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
         2 000132   000000 620006                    EAX0    0,QL
         2 000133   000000 165440                    TCTR
         2 000134   000000 000010 xsym               ADSC9   REC_BUF                  cn=0,n=*X0
         2 000135   000000 000100                    ARG     0,,PR0
         2 000136   000000 000000 xsym               ARG     REC_SIZE
         2 000137   000000 235000 xsym               LDA     REC_SIZE
         2 000140   000033 771000                    ARL     27
         2 000141   200405 755100                    STA     I,,AUTO
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:16   
         2 000142   000000 551040 xsym               STBA    REC_SIZE,'40'O
         2 000143   000147 606400 2                  TTN     ALL_BLANK
         2 000144   000000 054000 xsym               AOS     REC_SIZE
         2 000145   000000 156000 xsym               SSQ     REC_SIZE

      117      809    2        DO WHILE ('0'B);

    809  2 000146   000150 710000 2                  TRA     s:812

      118      810    2   ALL_BLANK: REC_SIZE = 0;

    810  2 000147   000000 450000 xsym  ALL_BLANK    STZ     REC_SIZE

      119      811    2           END;

      120      812    2        IF (FLAGS.RPFLAG) THEN DO;

    812  2 000150   000000 236000 xsym               LDQ     FLAGS
         2 000151   000200 316003                    CANQ    128,DU
         2 000152   000173 600000 2                  TZE     s:820

      121      813    2           IF (REC_SIZE >= RP_REC_SIZE) THEN TRNC_COUNT = TRNC_COUNT + 1;

    813  2 000153   000000 236000 xsym               LDQ     REC_SIZE
         2 000154   000000 116000 xsym               CMPQ    RP_REC_SIZE
         2 000155   000162 602000 2                  TNC     s:814

    813  2 000156   000000 235000 xsym               LDA     TRNC_COUNT
         2 000157   000001 035007                    ADLA    1,DL
         2 000160   000000 755000 xsym               STA     TRNC_COUNT
         2 000161   000167 710000 2                  TRA     s:815

      122      814    2           ELSE SUBSTR(REC_BUF , REC_SIZE+1) = ' ';

    814  2 000162   776000 620006                    EAX0    -1024,QL
         2 000163   777777 660003                    ERX0    -1,DU
         2 000164   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:17   
         2 000165   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000166   000000 200010 xsym               ADSC9   REC_BUF,Q                cn=1,n=*X0

      123      815    2           IF RP_REC_SIZE = 0

    815  2 000167   000000 235000 xsym               LDA     RP_REC_SIZE
         2 000170   000232 600000 2                  TZE     NOTHING_TO_WRITE

      124      816    2           THEN GOTO NOTHING_TO_WRITE ;
      125      817    2           ELSE REC_SIZE = RP_REC_SIZE - 1;

    817  2 000171   000001 135007                    SBLA    1,DL
         2 000172   000000 755000 xsym               STA     REC_SIZE

      126      818    2           END;

      127      819        /**/
      128      820    2        IF ((FLAGS.CRFLAG) AND (REC_BUF_ARRAY(REC_SIZE)~= CRET)) THEN DO;

    820  2 000173   000000 236000 xsym               LDQ     FLAGS
         2 000174   000400 316003                    CANQ    256,DU
         2 000175   000217 600000 2                  TZE     s:827
         2 000176   000000 235000 xsym               LDA     REC_SIZE
         2 000177   040000 106405                    CMPC    fill='040'O
         2 000200   000000 000001 xsym               ADSC9   REC_BUF,A                cn=0,n=1
         2 000201   000000 000001 xsym               ADSC9   CRET                     cn=0,n=1
         2 000202   000217 600000 2                  TZE     s:827

      129      821    2           REC_SIZE = REC_SIZE+1;

    821  2 000203   000001 035007                    ADLA    1,DL
         2 000204   000000 755000 xsym               STA     REC_SIZE

      130      822    2           IF CMD_CODE = BUILDCMD

    822  2 000205   000000 235000 xsym               LDA     CMD_CODE
         2 000206   000027 115007                    CMPA    23,DL
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:18   
         2 000207   000213 601000 2                  TNZ     s:824

      131      823    2           THEN RP_REC_SIZE = RP_REC_SIZE+1;

    823  2 000210   000000 235000 xsym               LDA     RP_REC_SIZE
         2 000211   000001 035007                    ADLA    1,DL
         2 000212   000000 755000 xsym               STA     RP_REC_SIZE

      132      824    2           REC_BUF_ARRAY(REC_SIZE) = CRET;

    824  2 000213   000000 235000 xsym               LDA     REC_SIZE
         2 000214   040005 100400                    MLR     fill='040'O
         2 000215   000000 000001 xsym               ADSC9   CRET                     cn=0,n=1
         2 000216   000000 000001 xsym               ADSC9   REC_BUF,A                cn=0,n=1

      133      825    2           END;

      134      826        /**/
      135      827    1        WRITE_REC_FPT.BUF_.BOUND = REC_SIZE ;

    827  2 000217   000000 236000 xsym               LDQ     REC_SIZE
         2 000220   000020 736000                    QLS     16
         2 000221   000024 676000 0                  ERQ     WRITE_REC_FPT+4
         2 000222   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000223   000024 656000 0                  ERSQ    WRITE_REC_FPT+4

      136      828    1        WRITE_REC_FPT.V.DVBYTE = DVBYTE ;

    828  2 000224   000000 236000 xsym               LDQ     DVBYTE
         2 000225   000033 552040 0                  STBQ    WRITE_REC_FPT+11,'40'O

      137      829    1        CALL M$WRITE (WRITE_REC_FPT) ALTRET (WRITE_REC_ALT);

    829  2 000226   000020 630400 0                  EPPR0   WRITE_REC_FPT
         2 000227   440001 713400                    CLIMB   alt,write
         2 000230   401400 401760                    pmme    nvectors=4
         2 000231   000320 702000 2                  TSX2    WRITE_REC_ALT
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:19   

      138      830    1   NOTHING_TO_WRITE:
      139      831    1        REC_SIZE = REC_SIZE + 1;

    831  2 000232   000000 235000 xsym  NOTHING_TO_* LDA     REC_SIZE
         2 000233   000001 035007                    ADLA    1,DL
         2 000234   000000 755000 xsym               STA     REC_SIZE

      140      832    1        RETURN;

    832  2 000235   000000 702200 xent               TSX2  ! X66_ARET

      141      833        /**/
      142      834    1   GOT_TAB:
      143      835    2        IF (SUBSTR(REC_BUF,I,1) ~= ' ') THEN DO;

    835  2 000236   200405 235100       GOT_TAB      LDA     I,,AUTO
         2 000237   040000 106405                    CMPC    fill='040'O
         2 000240   000000 000001 xsym               ADSC9   REC_BUF,A                cn=0,n=1
         2 000241   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000242   000246 600000 2                  TZE     s:840

      144      836    2           I = I+1;                        /* NO BLANKS TO COMPRESS              */

    836  2 000243   000001 035007                    ADLA    1,DL
         2 000244   200405 755100                    STA     I,,AUTO

      145      837    2           GOTO NEXT_TAB;

    837  2 000245   000056 710000 2                  TRA     NEXT_TAB

      146      838    2           END;
      147      839        /**/
      148      840    1        J = I;

    840  2 000246   200406 755100                    STA     J,,AUTO

PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:20   
      149      841    2        DO WHILE ((J >= 0)AND(SUBSTR(REC_BUF,J,1) = ' '));

    841  2 000247   000252 710000 2                  TRA     s:843

      150      842    2           J = J-1;

    842  2 000250   000001 336007                    LCQ     1,DL
         2 000251   200406 056100                    ASQ     J,,AUTO

      151      843    2           END;

    843  2 000252   200406 235100                    LDA     J,,AUTO
         2 000253   000260 604000 2                  TMI     s:844
         2 000254   040000 106405                    CMPC    fill='040'O
         2 000255   000000 000001 xsym               ADSC9   REC_BUF,A                cn=0,n=1
         2 000256   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000257   000250 600000 2                  TZE     s:842

      152      844    1        J = J+1;

    844  2 000260   200406 054100                    AOS     J,,AUTO

      153      845    1        TEMP_STRING = SUBSTR(REC_BUF,I+1,REC_SIZE-(I+1));

    845  2 000261   000000 236000 xsym               LDQ     REC_SIZE
         2 000262   200405 136100                    SBLQ    I,,AUTO
         2 000263   777777 620006                    EAX0    -1,QL
         2 000264   200405 235100                    LDA     I,,AUTO
         2 000265   040100 100445                    MLR     fill='040'O
         2 000266   000000 200010 xsym               ADSC9   REC_BUF,A                cn=1,n=*X0
         2 000267   200005 002000                    ADSC9   TEMP_STRING,,AUTO        cn=0,n=1024

      154      846    1        CALL INSERT(REC_BUF,J,,TABCHAR,TEMP_STRING);

    846  2 000270   200406 720100                    LXL0    J,,AUTO
         2 000271   775777 620010                    EAX0    -1025,X0
         2 000272   777777 660003                    ERX0    -1,DU
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:21   
         2 000273   200406 236100                    LDQ     J,,AUTO
         2 000274   040046 100400                    MLR     fill='040'O
         2 000275   000000 000001 xsym               ADSC9   TABCHAR                  cn=0,n=1
         2 000276   000000 000010 xsym               ADSC9   REC_BUF,Q                cn=0,n=*X0
         2 000277   001777 116007                    CMPQ    1023,DL
         2 000300   000306 605000 2                  TPL     s:847
         2 000301   776000 621006                    EAX1    -1024,QL
         2 000302   777777 661003                    ERX1    -1,DU
         2 000303   040046 100500                    MLR     fill='040'O
         2 000304   200005 002000                    ADSC9   TEMP_STRING,,AUTO        cn=0,n=1024
         2 000305   000000 200011 xsym               ADSC9   REC_BUF,Q                cn=1,n=*X1

      155      847    1        REC_SIZE = REC_SIZE - (I-J);

    847  2 000306   200405 236100                    LDQ     I,,AUTO
         2 000307   200406 136100                    SBLQ    J,,AUTO
         2 000310   200412 756100                    STQ     REC_POSIT+2,,AUTO
         2 000311   000000 236000 xsym               LDQ     REC_SIZE
         2 000312   200412 136100                    SBLQ    REC_POSIT+2,,AUTO
         2 000313   000000 756000 xsym               STQ     REC_SIZE

      156      848    1        I = J+1;

    848  2 000314   200406 235100                    LDA     J,,AUTO
         2 000315   000001 035007                    ADLA    1,DL
         2 000316   200405 755100                    STA     I,,AUTO

      157      849    1        GOTO NEXT_TAB;

    849  2 000317   000056 710000 2                  TRA     NEXT_TAB

      158      850        /**/
      159      851    1   WRITE_REC_ALT:
      160      852    1        CALL VEX$ERROR(0,3);

    852  2 000320   000004 630400 3     WRITE_REC_A* EPPR0   4
         2 000321   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:22   
         2 000322   000000 701000 xent               TSX1    VEX$ERROR
         2 000323   000000 011000                    NOP     0

      161      853    1        ALTRETURN;

    853  2 000324   000000 702200 xent               TSX2  ! X66_AALT
      162      854    1   END;

PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:23   
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   VE_FLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VE_PERR_C.:E05TOU  is referenced.
   VE_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VEX$WRITE_REC.
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:24   

 **** Variables and constants ****

  ****  Section 000  Data  VEX$WRITE_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w CHAR(64)    r     1 WRITE_KEY                  0-0-0/w STRC(576)   r     1 WRITE_KEY_U
    20-0-0/d STRC(432)   r     1 WRITE_REC_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DCB#                      4-0-0/w PTR         r     1 @WRITEKEY
    *0-0-0/w UBIN        r     1 DCB#                     405-0-0/w UBIN        r     1 I
   406-0-0/w SBIN        r     1 J                        410-0-0/w UBIN        r     1 REC_POSIT
   407-0-0/w UBIN        r     1 TAB_INDEX                  5-0-0/c CHAR(1024)  r     1 TEMP_STRING
    *0-0-0/w CHAR(64)    r     1 WRITEKEY                  *0-0-0/w STRC(576)   r     1 WRITEKEY_U

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$SR_NON_BLANK$            0-0-0/c CHAR        r     1 BSPACECHAR
     0-0-0/w UBIN        r     1 CMD_CODE                   0-0-0/c CHAR        r     1 CRET
     0-0-0/b BIT         r     1 DVBYTE                     0-0-0/b STRC(72)    r     1 FLAGS
     0-0-0/w UBIN        r     1 M$FILE_NUM                 0-0-0/w UBIN        r     1 NUM_TABS
     0-0-0/c CHAR(1024)  r     1 REC_BUF
     0-0-0/c CHAR        r     1 REC_BUF_ARRAY(0:1023)
     0-0-0/w UBIN        r     1 REC_SIZE                   0-0-0/w UBIN        r     1 RP_REC_SIZE
     0-0-0/b BIT         r     1 SEED                       0-0-0/c CHAR        r     1 TABCHAR
     0-0-0/w STRC(288)   r     1 TAB_VLP                    0-0-0/w UBIN        r     1 TRNC_COUNT
     0-0-0/w UBIN        r     1 Y003

PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:25   
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4608)  r     1 B$SR_NON_BLANK


   Procedure VEX$WRITE_REC requires 213 words for executable code.
   Procedure VEX$WRITE_REC requires 268 words of local(AUTO) storage.

    No errors detected in file VEX$WRITE_REC.:E05TSI    .
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:26   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:27   
          MINI XREF LISTING

ALL_BLANK
       810**LABEL     808--CALLALT
B$SR_NON_BLANK
       741**DCL       808>>CALLBLT
B$SR_NON_BLANK$
       740**DCL       741--IMP-PTR   808>>CALLBLT
BSPACECHAR
       755**DCL       799>>IF
CMD_CODE
       751**DCL       780>>IF        780>>IF        780>>IF        822>>IF
CRET
       747**DCL       820>>IF        824>>ASSIGN
DCB#
        25**DCL         8--PROC      780>>IF        787>>ASSIGN    791>>IF
DVBYTE
       241**DCL       828>>ASSIGN
FLAGS.CONSEC_MODE
       596**DCL       780>>IF
FLAGS.CRFLAG
       598**DCL       820>>IF
FLAGS.REL_MODE
       607**DCL       791>>IF
FLAGS.RPFLAG
       599**DCL       812>>IF
FLAGS.TABCFLAG
       606**DCL       798>>IF
GOT_TAB
       835**LABEL     803--GOTO
I
       229**DCL       794<<ASSIGN    798>>DOWHILE   799>>IF        805<<ASSIGN    805>>ASSIGN    808<<CALLBLT
       835>>IF        836<<ASSIGN    836>>ASSIGN    840>>ASSIGN    845>>ASSIGN    845>>ASSIGN    847>>ASSIGN
       848<<ASSIGN
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:28   
J
       230**DCL       840<<ASSIGN    841>>DOWHILE   841>>DOWHILE   842<<ASSIGN    842>>ASSIGN    844<<ASSIGN
       844>>ASSIGN    846>>CALLBLT   847>>ASSIGN    848>>ASSIGN
M$FILE_NUM
       752**DCL       780>>IF        791>>IF
M$WRITE
       473**DCL-ENT   829--CALL
NEXT_TAB
       798**LABEL     837--GOTO      849--GOTO
NOTHING_TO_WRITE
       831**LABEL     816--GOTO
NUM_TABS
       754**DCL       802>>DOINDEX
REC_BUF
       745**DCL       563--DCLINIT   564--DCLINIT   746--REDEF     799>>IF        808>>CALLBLT   814<<ASSIGN
       835>>IF        841>>DOWHILE   845>>ASSIGN    846<<CALLBLT
REC_BUF_ARRAY
       746**DCL       820>>IF        824<<ASSIGN
REC_POSIT
       232**DCL       795<<ASSIGN    799<<ASSIGN    799>>ASSIGN    800<<ASSIGN    800>>ASSIGN    803>>IF
REC_SIZE
       748**DCL       798>>DOWHILE   808<<CALLBLT   808>>CALLBLT   810<<ASSIGN    813>>IF        814>>ASSIGN
       817<<ASSIGN    820>>IF        821<<ASSIGN    821>>ASSIGN    824>>ASSIGN    827>>ASSIGN    831<<ASSIGN
       831>>ASSIGN    845>>ASSIGN    847<<ASSIGN    847>>ASSIGN
RP_REC_SIZE
       749**DCL       813>>IF        815>>IF        817>>ASSIGN    823<<ASSIGN    823>>ASSIGN
SEED
       753**DCL       785>>ASSIGN
TABCHAR
       756**DCL       846>>CALLBLT
TAB_INDEX
       231**DCL       802<<DOINDEX   803>>IF
TAB_VLP.TABS#
       772**DCL       803>>IF
TEMP_STRING
       228**DCL       845<<ASSIGN    846>>CALLBLT
PL6.E3A0      #001=VEX$WRITE_REC File=VEX$WRITE_REC.:E05TSI                      WED 07/30/97 07:17 Page:29   
TRNC_COUNT
       750**DCL       813<<ASSIGN    813>>ASSIGN
VEX$ERROR
       776**DCL-ENT   852--CALL
WRITEKEY
        26**DCL         8--PROC       27--REDEF     792>>ASSIGN
WRITEKEY_U.KEY
        28**DCL       791>>ASSIGN
WRITE_KEY
       237**DCL       238--REDEF     789--ASSIGN    792<<ASSIGN
WRITE_KEY_U.KEY
       239**DCL       791<<ASSIGN
WRITE_REC_ALT
       852**LABEL     829--CALLALT
WRITE_REC_FPT
       562**DCL       829<>CALL
WRITE_REC_FPT.BUF_.BOUND
       562**DCL       827<<ASSIGN
WRITE_REC_FPT.KEY_
       562**DCL       789<<ASSIGN
WRITE_REC_FPT.STATION_
       564**DCL       564--REDEF
WRITE_REC_FPT.V
       565**DCL       562--DCLINIT
WRITE_REC_FPT.V.DCB#
       565**DCL       787<<ASSIGN
WRITE_REC_FPT.V.DVBYTE
       570**DCL       828<<ASSIGN
WRITE_REC_FPT.V.DVBYTE.VFC#
       571**DCL       571--REDEF
WRITE_REC_FPT.V.REWRITE#
       568**DCL       782<<ASSIGN    783<<ASSIGN
WRITE_REC_FPT.V.SEED#
       570**DCL       785<<ASSIGN
Y003
       758**DCL       791>>ASSIGN
