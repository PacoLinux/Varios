VERSION E05

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:1    
        1        1        /*M* ASA$PROJ - ROUTINE TO HANDLE PROJECT COMMAND. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        /*   ASA$PROJ : This module consists of procedures:
       11       11                             ASA$PROJECT
       12       12                             ASA$PACKSET_OPTS                      */
       13       13        /*M* ASA$PROJECT - external procedure for CREATE/MODIFY PROJECT options */
       14       14                                                              /**/
       15       15        /********************************************************************/
       16       16        /*                                                                   */
       17       17        /*                   ASA$PROJECT         proc                        */
       18       18        /*                                                                   */
       19       19        /*********************************************************************/
       20       20                                                              /**/
       21       21        ASA$PROJECT: PROC( CR_MOD_KEY );
       22       22                                                              /**/
       23       23        %SET LISTSUB = '1'B ;
       24       24        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:2    
       25       25        /********************************************************************/
       26       26        /*   Parameters      parameters      parameters      parameters      */
       27       27        /*********************************************************************/
       28       28                                                              /**/
       29       29    1   DCL 1 CR_MOD_KEY ALIGNED ,
       30       30    1          2 CNT UBIN(9) UNAL ,
       31       31    1          2 TEXT CHAR(20) UNAL ;
       32       32                                                              /**/
       33       33        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:3    
       34       34        /********************************************************************/
       35       35        /*   Include files   include files   include files   include files   */
       36       36        /*********************************************************************/
       37       37                                                              /**/
       38       38        %INCLUDE AS_ENTRIES_M ;
       39     1088        %INCLUDE AS_SUBS_C    ;
       40     2502        %INCLUDE AS_PERR_C    ;
       41     3104        %INCLUDE AS_MAC_C     ;
       42     3184        %INCLUDE AS_SUPER_C   ;
       43     3619        %INCLUDE XU_MACRO_C   ;
       44     6725        %INCLUDE XU_FORMAT_C  ;
       45     6887        %INCLUDE KL_SUPER_C   ;
       46     9789        %INCLUDE AS_SUPER_R   ;
       47    12805        %INCLUDE CP_6         ;
       48    12886        %INCLUDE B_ERRORS_C   ;
       49    14013                                                              /**/
       50    14014        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:4    
       51    14015        /********************************************************************/
       52    14016        /*   Constant & static data          constant & statc data           */
       53    14017        /*********************************************************************/
       54    14018                                                              /**/
       55    14019    1   DCL MORE BIT(1) STATIC ;
       56    14020                                                              /**/
       57    14021        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:5    
       58    14022        /********************************************************************/
       59    14023        /*   Local based     local based     local based     local based     */
       60    14024        /*********************************************************************/
       61    14025                                                              /**/
       62    14026        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       63    14027                    NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       64    14072        %PARSE$SYM( NAME = OUT$SYM ,
       65    14073                    STCLASS="BASED(BLK$)") ;
       66    14111    1   DCL 1 VARY$STR BASED(STR$) ALIGNED ,
       67    14112    1          2 CNT UBIN(9) UNAL ,
       68    14113    1          2 TEXT CHAR(VARY$STR.CNT) ;
       69    14114                                                              /**/
       70    14115        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:6    
       71    14116        /********************************************************************/
       72    14117        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       73    14118        /*********************************************************************/
       74    14119                                                              /**/
       75    14120    1   DCL X$PARSE ENTRY(1) ALTRET ;
       76    14121        %ASB$READ_SI ;
       77    14124        %ASB$SET_PROMPT ;
       78    14127        %ASB$WRITE_LO ;
       79    14130        %ASC$CM_OPTS ;
       80    14133        %ASH$HELP ;
       81    14136        %ASH$DQUEST ;
       82    14139        %ASH$QUEST ;
       83    14142        %ASH$ERROR ;
       84    14145        %ASH$WARN ;
       85    14148        %ASB$READ_PROJ ;
       86    14151        %ASB$PREC_PROJ ;
       87    14154        %ASB$DELREC_PROJ ;
       88    14157        %ASA$KEYCONV ;
       89    14160        %ASB$GETSEG ;
       90    14163        %ASA$PACKSET_OPTS ;
       91    14166        %ASB$ENQ_USERS ;
       92    14169        %ASB$READ_USERS ;
       93    14172        %ASB$WRITE_USERS ;
       94    14175        %ASA$ERROR ;
       95    14178                                                              /**/
       96    14179                                                              /**/
       97    14180        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:7    
       98    14181        /********************************************************************/
       99    14182        /*   Auto data       auto data       auto data       auto data       */
      100    14183        /*********************************************************************/
      101    14184                                                              /**/
      102    14185    1   DCL ARS SBIN ;
      103    14186    1   DCL DELTA SBIN;
      104    14187    1   DCL VAL SBIN ;
      105    14188    1   DCL UBIN_VAL UBIN;
      106    14189    1   DCL DOLLAR SBIN;
      107    14190    1   DCL CENTS  SBIN;
      108    14191    1   DCL SIGN SBIN;
      109    14192    1   DCL PRIO UBIN WORD ;
      110    14193    1   DCL SUBNODES SBIN ;
      111    14194    1   DCL SUBND$ PTR ;
      112    14195    1   DCL BLK$ PTR ;
      113    14196    1   DCL STR$ PTR ;
      114    14197    1   DCL I SBIN ;
      115    14198    1   DCL J SBIN ;
      116    14199    1   DCL 1 PACKSET,
      117    14200    1          2 CNT UBIN BYTE UNAL,
      118    14201    1          2 TXT CHAR(6) UNAL;
      119    14202        %AS$PROJ_HEADER( NAME=PROJ_HEADER, STCLASS=AUTO );
      120    14231                                                              /**/
      121    14232        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:8    
      122    14233        /********************************************************************/
      123    14234        /*   Procedure       procedure       procedure       procedure       */
      124    14235        /*********************************************************************/
      125    14236                                                              /**/
      126    14237        /*
      127    14238            ***            Begin procedure                    ***
      128    14239        */
      129    14240    1   MORE = AS_TRUE ;
      130    14241                                                              /**/
      131    14242    1   CM_LOOP: ;
      132    14243    2   DO WHILE (MORE) ;
      133    14244    2      REMEMBER CM_LOOP IN REMEM_VAR ;
      134    14245    2      P_PCB.ROOT$ = ADDR(CR_MOD_PROJ_OPTS);
      135    14246                                                                  /*  Set prompt  */
      136    14247    2      CALL ASB$SET_PROMPT ( %PROMPT_PROJ ) ;
      137    14248                                                                  /**/
      138    14249    2      CALL ASB$READ_SI(IN_BUF,ARS) ;             /* Read option line */
      139    14250    2      P_PCB.NCHARS = ARS ;
      140    14251    2      CALL X$PARSE(P_PCB) ALTRET (OPTION_ERR) ;
      141    14252                                                              /**/
      142    14253    2      NODE$ = P_PCB.OUT$ ;
      143    14254                                                              /**/
      144    14255                                                              /**/
      145    14256    2      CODE = P$NODE.CODE ;
      146    14257    2      SUBNODES = P$NODE.SUBNODES ;
      147    14258                                                              /**/
      148    14259    3      DO I = 0 TO SUBNODES-1 ;
      149    14260    3         SUBND$ = P$NODE.SUBLK$(I) ;
      150    14261    3         CODE = SUBND$ -> P$NODE.CODE ;
      151    14262                                                              /**/
      152    14263    4         DO SELECT (CODE) ;
      153    14264                                                              /**/
      154    14265    4            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */) ;
      155    14266    4            USERS_KEY = CR_MOD_KEY;         /* End or blank input */
      156    14267    4            IF CR_MOD_KEY.TEXT = 'DEFAULTP' THEN RETURN;
      157    14268    4            PROJ_KEY.TXT.PROJECT = CR_MOD_KEY.TEXT;
      158    14269    4            PROJ_KEY.TXT.PACKSET = AS_PROJECT.HPSN;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:9    
      159    14270    4            CALL INDEX( J, AS_BLANK, AS_PROJECT.HPSN );
      160    14271    4            PROJ_KEY.COUNT = 20 + J;
      161    14272    4            J = SIZEC(PROJ_HEADER);
      162    14273    4            CALL ASB$READ_PROJ(ADDR(PROJ_HEADER),J) ALTRET(READ_PROJ_ERR);
      163    14274    4            IF AS_PROJECT.HPSN = AS_PROJECT_DFLT.HPSN THEN RETURN;
      164    14275    4            PROJ_KEY.TXT.PACKSET = AS_PROJECT_DFLT.HPSN;
      165    14276    4            CALL INDEX( J, AS_BLANK, AS_PROJECT_DFLT.HPSN );
      166    14277    4            PROJ_KEY.COUNT = 20 + J;
      167    14278    4            J = SIZEC(PROJ_HEADER);
      168    14279    4            CALL ASB$READ_PROJ(ADDR(PROJ_HEADER),J) ALTRET(READ_PROJ_ERR);
      169    14280    4            RETURN;
      170    14281    4   READ_PROJ_ERR:
      171    14282    4            AS_FIELD1.COUNT = PROJ_KEY.COUNT - 20;
      172    14283    4            AS_FIELD1.TEXT = PROJ_KEY.TXT.PACKSET;
      173    14284    5            IF PROJ_KEY.TXT.PACKSET = AS_PROJECT.HPSN THEN DO;
      174    14285        /*E*  ERROR:  ASA-E$MISSING_PACKSET1-C
      175    14286        MESSAGE: The home packset for the project administrator of this project is DP#%U1.
      176    14287                 PACKSET = DP#%U1 must be specified for this project.
      177    14288        MESSAGE1: You must specify a PACKSET option for the packset that was
      178    14289                  specified as the home packset for the project administrator
      179    14290                  of this project.
      180    14291        */
      181    14292                    %SCREAM( ERR#=E$MISSING_PACKSET1, LEVEL=ERROR,MID='A' );
      182    14307    5               END;
      183    14308    5            ELSE DO;
      184    14309        /*E*  ERROR:  ASA-E$MISSING_PACKSET2-C
      185    14310        MESSAGE: The default home packset for users in this project is DP#%U1.
      186    14311                 PACKSET = DP#%U1 must be specified for this project.
      187    14312        MESSAGE1: You must specify a PACKSET option for the packset that was
      188    14313                  specified as the default home packset for users in the project.
      189    14314        */
      190    14315                    %SCREAM( ERR#=E$MISSING_PACKSET2, LEVEL=ERROR, MID='A' );
      191    14330    5               END;
      192    14331                                                              /**/
      193    14332    4            SELECT(302 /* HELP_VAL */) ;
      194    14333    4            CALL ASH$HELP ;
      195    14334                                                              /**/
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:10   
      196    14335    4            SELECT(300 /* DQUESTION_VAL */) ;
      197    14336    4            CALL ASH$DQUEST ;
      198    14337                                                              /**/
      199    14338    4            SELECT(301 /* QUESTION_VAL */) ;
      200    14339    4            CALL ASH$QUEST ;
      201    14340                                                              /**/
      202    14341    4            SELECT( 1 /* PROJ_ADMIN_VAL */ );
      203    14342    4            AS_USERS = AS_PROJECT;
      204    14343    4            KL_DREC  = AS_PROJECT_DREC;
      205    14344    4            IF AS_CR_MOD_PROJ > 0
      206    14345    5            THEN DO;
      207    14346    5               AS_CR_MOD_PROJ = %CR_PROJECT;
      208    14347    5               AS_DFLT = AS_PROJ_ADMIN;
      209    14348    5               KL_DFLT = AS_PROJ_ADMIN_DREC;
      210    14349    5               END;
      211    14350    4            ELSE AS_CR_MOD_PROJ = - %CR_PROJECT;
      212    14351    4            CALL ASC$CM_OPTS( CR_MOD_KEY );
      213    14352    4            AS_PROJECT = AS_USERS;
      214    14353    4            AS_PROJECT_DREC = KL_DREC;
      215    14354                                                              /**/
      216    14355    4            SELECT( 2 /* PROJ_DFLT_VAL */ );
      217    14356    4            AS_USERS = AS_PROJECT_DFLT;
      218    14357    4            KL_DREC  = AS_PROJECT_DFLT_DREC;
      219    14358    4            IF AS_CR_MOD_PROJ > 0
      220    14359    5            THEN DO;
      221    14360    5               AS_CR_MOD_PROJ = %CR_PROJ_DEFAULT;
      222    14361    5               AS_DFLT = AS_DEFAULT;
      223    14362    5               KL_DFLT = AS_DEFAULT_DREC;
      224    14363    5               END;
      225    14364    4            ELSE AS_CR_MOD_PROJ = - %CR_PROJ_DEFAULT;
      226    14365    4            CALL ASC$CM_OPTS( CR_MOD_KEY );
      227    14366    4            AS_PROJECT_DFLT = AS_USERS;
      228    14367    4            AS_PROJECT_DFLT_DREC = KL_DREC;
      229    14368                                                              /**/
      230    14369    4            SELECT( 5 /* PROJ_CHARGES_VAL */ );
      231    14370                                                              /**/
      232    14371        /*
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:11   
      233    14372            If the value input on the mcharges option line has a sign
      234    14373            associated with it,  the value is treated relative to the
      235    14374            current maxc value, or the default maxc value.  If the input
      236    14375            value does not have a sign it is treated as an absolute
      237    14376            replacement value for either the current maxc, if there is
      238    14377            one, or it replaces the default maxc.
      239    14378        */
      240    14379    4            IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 7   /*  NONE_VAL  */
      241    14380    5            THEN DO;
      242    14381    5               AS_PROJECT.BUDGET.PMAXC = -1;
      243    14382    5               END;
      244    14383    5            ELSE DO;
      245    14384    6               IF SUBND$ -> P$NODE.SUBNODES = 1 THEN DO;
      246    14385    6                  SIGN = 0; /*  no sign on the input  */
      247    14386    6                  BLK$ = SUBND$ -> P$NODE.SUBLK$(0);
      248    14387    6                  END;
      249    14388    6               ELSE DO; /*  we have a sign  */
      250    14389    6                  BLK$ = SUBND$ -> P$NODE.SUBLK$(1); /* pts to mcharges value node */
      251    14390    6                  IF SUBND$-> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1
             14390                           /* MINUS_VAL */
      252    14391    6                  THEN SIGN = -1;
      253    14392    6                  ELSE SIGN = 1;
      254    14393    6                  END;
      255    14394    5               CALL CHARBIN( DOLLAR, BLK$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );
      256    14395    5               IF BLK$ -> P$NODE.SUBNODES = 1 THEN
      257    14396    5                  CENTS = 0;
      258    14397    6               ELSE DO;
      259    14398    6                  IF BLK$->P$NODE.SUBLK$(1)->OUT$SYM.COUNT = 1
      260    14399    7                  THEN DO;
      261    14400    7                     CALL CHARBIN( CENTS, BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT);
      262    14401    7                     CENTS = CENTS * 10;
      263    14402    7                     END;
      264    14403    6                  ELSE
      265    14404    6                     CALL CHARBIN(CENTS,SUBSTR(BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT,0,2
             14404                              ));
      266    14405    6                  END;
      267    14406    5               UBIN_VAL = DOLLAR * 10000 + CENTS * 100 ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:12   
      268    14407    5               IF SIGN ~= 0 THEN
      269    14408    6                  IF UBIN_VAL > 34359738300 THEN DO;
      270    14409    7                     IF SIGN = -1 THEN DO;
      271    14410        /*E*   ERROR: ASA-E$MCHARGES_TOO_SML-C
      272    14411             MESSAGE: Mcharges too small.
      273    14412             MESSAGE1: Mcharges cannot be less than -3435973.83.
      274    14413        */
      275    14414                             %SCREAM( ERR#=E$MCHARGES_TOO_SML, LEVEL=ERROR, MID='A' );
      276    14429    7                        END;
      277    14430    7                     ELSE DO;
      278    14431        /*E*   ERROR: ASA-E$MCHARGES_TOO_BIG-C
      279    14432             MESSAGE: Mcharges too large.
      280    14433             MESSAGE1: Mcharges cannot be greater than 3435973.83.
      281    14434        */
      282    14435                             %SCREAM( ERR#=E$MCHARGES_TOO_BIG, LEVEL=ERROR, MID='A' );
      283    14450    7                        END;
      284    14451    6                     GOTO CM_LOOP;
      285    14452    6                     END;
      286    14453    5               IF AS_PROJECT.BUDGET.PMAXC = -1 AND SIGN = -1
      287    14454    6               THEN DO;
      288    14455        /*E* ERROR: ASA-E$MCHARGES_ILL_VAL-C
      289    14456             MESSAGE: MCHARGES cannot be negative.
      290    14457             MESSAGE1: MCHARGES cannot be negative when previously set to NONE.
      291    14458        */
      292    14459                       %SCREAM( ERR#=E$MCHARGES_ILL_VAL,LEVEL=ERROR,MID='A');
      293    14474    6                  GOTO CM_LOOP;
      294    14475    6                  END;
      295    14476    5               IF SIGN = 0 THEN
      296    14477    5                  AS_PROJECT.BUDGET.PMAXC = UBIN_VAL ;
      297    14478    5               IF AS_PROJECT.BUDGET.PMAXC = -1 AND SIGN = 1
      298    14479    5               THEN AS_PROJECT.BUDGET.PMAXC = UBIN_VAL;
      299    14480    6               ELSE DO;
      300    14481    6                  VAL = (SIGN * UBIN_VAL) + AS_PROJECT.BUDGET.PMAXC ;
      301    14482    6                  IF VAL >= 0 THEN
      302    14483    6                     AS_PROJECT.BUDGET.PMAXC = VAL ;
      303    14484    7                  ELSE DO;
      304    14485        /*E*  ERROR: ASA-E$MCHARGES_NEG_VAL-C
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:13   
      305    14486              MESSAGE: MCHARGES is a negative value.
      306    14487              MESSAGE1: MCHARGES cannot have a negative value.
      307    14488        */
      308    14489                          %SCREAM(ERR#=E$MCHARGES_NEG_VAL,LEVEL=ERROR,MID='A') ;
      309    14504    7                     END;
      310    14505    6                  END;
      311    14506    5               END;
      312    14507
      313    14508        /*
      314    14509        If AS_CR_MOD_PROJ > 0  and  AS_DFLT.BUDGET.MAXC > 0
      315    14510        then
      316    14511           if AS_PROJECT.BUDGET.PMAXC > AS_DFLT.BUDGET.MAXC
      317    14512           then do;
      318    14513        */
      319    14514        /*E* ERROR:   ASA-E$MCHARGES_TOO_LARGE-C
      320    14515             MESSAGE: MCHARGES greater than the maximum allowed for a %U1 you create.
      321    14516             MESSAGE1: MCHARGES = %U2.%U3 is the maximum allowed for a %U1 you create.
      322    14517                       Setting MCHARGE to %U2.%U3.
      323    14518        */
      324    14519        /*
      325    14520              AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      326    14521              dollar = AS_DFLT.BUDGET.MAXC / 10000;
      327    14522              cents = mod( AS_DFLT.BUDGET.MAXC, 10000 ) / 100;
      328    14523              %NUMBER( NUM2="DOLLAR", NUM3="CENTS" );
      329    14524              if AS_FIELD3.COUNT = 1
      330    14525              then do;
      331    14526                 AS_FIELD3.COUNT = 2;
      332    14527                 call insert( AS_FIELD3.TEXT, 1, 1, '0' );
      333    14528                 end;
      334    14529              %SCREAM( ERR#=E$MCHARGES_TOO_LARGE, level=error, mid='a' );
      335    14530              AS_PROJECT.BUDGET.PMAXC = AS_DFLT.BUDGET.MAXC;
      336    14531              end;
      337    14532
      338    14533        */
      339    14534    4            SELECT( 7 /* PROJECT ACHARGES */ );
      340    14535    5            IF NOT SUPERAUTH THEN DO;
      341    14536        /*E* ERROR:   ASA-E$ACHARGES_NOT_ALLOWED-C
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:14   
      342    14537        MESSAGE: The SUPERAUTH pprivilege is required to use the ACHARGES option.
      343    14538        */
      344    14539                    %SCREAM( ERR#=E$ACHARGES_NOT_ALLOWED,LEVEL=ERROR,MID='A');
      345    14554    5               GOTO CM_LOOP;
      346    14555    5               END;
      347    14556    5            IF SUBND$ -> P$NODE.SUBNODES = 1 THEN DO;
      348    14557    5               SIGN = 1;
      349    14558    5               BLK$ = SUBND$ -> P$NODE.SUBLK$(0);
      350    14559    5               END;
      351    14560    5            ELSE DO;
      352    14561    5               IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1
             14561                        /* MINUS_VAL */
      353    14562    5               THEN SIGN = -1;
      354    14563    5               ELSE SIGN = 1;
      355    14564    5               BLK$ = SUBND$ -> P$NODE.SUBLK$(1);
      356    14565    5               END;
      357    14566    4            CALL CHARBIN( DOLLAR, BLK$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );
      358    14567    4            IF BLK$ -> P$NODE.SUBNODES = 1 THEN
      359    14568    4               CENTS = 0;
      360    14569    5            ELSE DO;
      361    14570    5               IF BLK$->P$NODE.SUBLK$(1)->OUT$SYM.COUNT = 1
      362    14571    6               THEN DO;
      363    14572    6                  CALL CHARBIN( CENTS, BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT);
      364    14573    6                  CENTS = CENTS * 10;
      365    14574    6                  END;
      366    14575    5               ELSE
      367    14576    5                  CALL CHARBIN( CENTS, SUBSTR(BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT,0,2)
             14576                           );
      368    14577    5               END;
      369    14578    4            UBIN_VAL = DOLLAR * 10000 + CENTS * 100 ;
      370    14579    5            IF UBIN_VAL > 34359738300 THEN DO;
      371    14580    6               IF SIGN = -1 THEN DO;
      372    14581        /*   ERROR: ASC-E$ACCUM_TOO_SMALL-C
      373    14582             MESSAGE: Acharges too small.
      374    14583             MESSAGE1: Acharges cannot be less than -3435973.83.
      375    14584        */
      376    14585                       %SCREAM( ERR#=E$ACCUM_TOO_SMALL, LEVEL=ERROR, MID='C' );
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:15   
      377    14600    6                  END;
      378    14601    6               ELSE DO;
      379    14602        /*   ERROR: ASC-E$ACCUM_TOO_BIG-C
      380    14603             MESSAGE: Acharges too large.
      381    14604             MESSAGE1: Acharges cannot be greater than 3435973.83.
      382    14605        */
      383    14606                       %SCREAM( ERR#=E$ACCUM_TOO_BIG, LEVEL=ERROR, MID='C' );
      384    14621    6                  END;
      385    14622    5               GOTO CM_LOOP;
      386    14623    5               END;
      387    14624    4            VAL = SIGN * UBIN_VAL;
      388    14625    4            DELTA = VAL - AS_PROJECT.BUDGET.PACCUM;
      389    14626    4            AS_PROJECT.BUDGET.PACCUM = VAL;
      390    14627    4            AS_USERS = AS_PROJECT;
      391    14628    5            DO WHILE(AS_USERS.BUDGET.PCHARGES AND AS_USERS.BUDGET.MACCT ~= AS_NONE);
      392    14629    5               USERS_KEY = AS_USERS.BUDGET.MACCT;
      393    14630    5               CALL ASB$ENQ_USERS ALTRET(ENQ_ERR);
      394    14631    5               CALL ASB$READ_USERS( AS_USERS ) ALTRET(READ_ERR);
      395    14632    5               AS_USERS.BUDGET.PACCUM = AS_USERS.BUDGET.PACCUM + DELTA;
      396    14633    5               CALL ASB$WRITE_USERS( AS_USERS );
      397    14634    5               END;
      398    14635    5            DO WHILE( '0'B );
      399    14636    5   READ_ERR:
      400    14637    5               CALL ASA$ERROR( USERS_KEY, 307 /* UNABLE TO READ :USERS */ );
      401    14638    5               END;
      402    14639    5            DO WHILE( '0'B );
      403    14640    5   ENQ_ERR:
      404    14641    5               CALL ASH$ERROR( ERR_CODE );
      405    14642    5               END;
      406    14643                                                              /**/
      407    14644    4            SELECT( 3 /* PROJ_ACCTS_VAL */ );
      408    14645    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );
      409    14646    4            IF CR_MOD_FLG  AND  VAL < AS_PROJECT_DFLT.BUDGET.PROJ_CREATED
      410    14647    5            THEN DO;
      411    14648        /*E* ERROR: ASA-E$P_ACCTS_TOO_SMALL-C
      412    14649        MESSAGE: ACCOUNTS cannot be set less than the number of accounts already
      413    14650                 accumulated by this project.  Setting ACCOUNTS to %U1.
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:16   
      414    14651        MESSAGE1: %U1 accounts have already been accumulated by this project.
      415    14652                  You cannot set ACCOUNTS to a value which is less than the number of
      416    14653                  accounts already accumulated by the project.  ACCOUNTS is set to %U1.
      417    14654        */
      418    14655    5               VAL = AS_PROJECT_DFLT.BUDGET.PROJ_CREATED;
      419    14656                    %NUMBER( NUM1=VAL );
             14664    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );
      420    14686                    %SCREAM( ERR#=E$P_ACCTS_TOO_SMALL, MID='A', LEVEL=ERROR );
      421    14701    5               END;
      422    14702    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
      423    14703    5               IF AS_PROJECT_DFLT.BUDGET.PMAXC > 0 THEN
      424    14704    5                  DELTA = VAL - AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED;
      425    14705    5               ELSE
      426    14706    5                  DELTA = VAL;
      427    14707    5               IF AS_DEFAULT.BUDGET.PROJ_CREATED + DELTA > AS_DEFAULT.BUDGET.
             14707                        PROJ_ALLOWED
      428    14708    6               THEN DO;
      429    14709        /*E* ERROR: ASA-E$TOO_MANY_P_ACCTS-C
      430    14710        MESSAGE: Maximum number of accounts exceeded for project %U1.
      431    14711                 ACCOUNTS = %U2 is the most that can be specified.
      432    14712        */
      433    14713    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );
      434    14714    6                  CALL CONCAT( AS_FIELD1.TEXT,
      435    14715    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      436    14716    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
      437    14717    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;
      438    14718    6                  DELTA = AS_DEFAULT.BUDGET.PROJ_ALLOWED - AS_DEFAULT.BUDGET.
             14718                           PROJ_CREATED + AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED;
      439    14719                       %NUMBER( NUM2=DELTA );
             14735    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, DELTA );
      440    14749                       %SCREAM( ERR#=E$TOO_MANY_P_ACCTS,MID='A',LEVEL=ERROR);
      441    14764    6                  GOTO CM_LOOP;
      442    14765    6                  END;
      443    14766    5               AS_DEFAULT.BUDGET.PROJ_CREATED = AS_DEFAULT.BUDGET.PROJ_CREATED + DELTA;
      444    14767    5               END;
      445    14768    4            AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = VAL;
      446    14769                                                              /**/
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:17   
      447    14770    4            SELECT( 4 /* PROJ_PACK_VAL */ );
      448    14771                                                      /*  Get packset name */
      449    14772    4            BLK$ = SUBND$ -> P$NODE.SUBLK$(0);
      450    14773    4            PACKSET.TXT = OUT$SYM.TEXT;
      451    14774    4            PACKSET.CNT = OUT$SYM.COUNT;
      452    14775                                                      /*  Process packset options */
      453    14776    4            CALL ASA$PACKSET_OPTS( CR_MOD_KEY, PACKSET );
      454    14777    4            GOTO CM_LOOP;
      455    14778                                                              /**/
      456    14779    4            SELECT( 8 /* REMOVE PACKSET */ );
      457    14780                                                      /*  Get packset name */
      458    14781    4            BLK$ = SUBND$ -> P$NODE.SUBLK$(0);
      459    14782    4            PACKSET.TXT = OUT$SYM.TEXT;
      460    14783    4            PACKSET.CNT = OUT$SYM.COUNT;
      461    14784                                                      /* See if :PROJ record exists */
      462    14785    4            PROJ_KEY.COUNT = PACKSET.CNT + 20;
      463    14786    4            CALL CONCAT( PROJ_KEY.TEXT, CR_MOD_KEY.TEXT, PACKSET.TXT );
      464    14787    4            CALL ASB$PREC_PROJ ALTRET(PACK_NO_EXIST);
      465    14788    5            DO WHILE( '0'B );
      466    14789        /*E*  ERROR:  ASA-E$PACK_NO_EXIST_FOR_PROJ-C
      467    14790              MESSAGE: Packset DP#%U1 does not exist for project "%U2".
      468    14791        */
      469    14792    5   PACK_NO_EXIST: AS_FIELD1 = PACKSET;
      470    14793    5               CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );
      471    14794                    %SCREAM(ERR#=E$PACK_NO_EXIST_FOR_PROJ,LEVEL=ERROR,MID='A');
      472    14809    5               GOTO CM_LOOP;
      473    14810    5               END;
      474    14811                                                          /* Read the :PROJ record */
      475    14812    4            I = SIZEC(PROJ_HEADER);
      476    14813    4            CALL ASB$READ_PROJ( ADDR(PROJ_HEADER), I ) ALTRET(PROJ_READ_ERR);
      477    14814    5            DO WHILE( '0'B );
      478    14815    5   PROJ_READ_ERR: CALL ASH$ERROR( ERR_CODE );
      479    14816    5               GOTO CM_LOOP;
      480    14817    5               END;
      481    14818    5            IF PROJ_HEADER.NUM_ACCTS > 0 THEN DO;
      482    14819        /*E*  ERROR:  ASA-E$ACCTS_STILL_ON_PACK-C
      483    14820              MESSAGE: Accounts still exist on packset DP#%U1.
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:18   
      484    14821              MESSAGE1: Packset DP#%U1 cannot be removed while there are still
      485    14822                        accounts on it for project "%U2".
      486    14823        */
      487    14824    5               AS_FIELD1 = PACKSET;
      488    14825    5               CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );
      489    14826                    %SCREAM( ERR#=E$ACCTS_STILL_ON_PACK,LEVEL=ERROR,MID='A' );
      490    14841    5               GOTO CM_LOOP;
      491    14842    5               END;
      492    14843    5            IF PROJ_HEADER.SUB_PROJ_ACCTS > 0 THEN DO;
      493    14844        /*E*  ERROR:  ASA-E$STILL_SUB_PROJS_ON_PACK-C
      494    14845              MESSAGE: Sub-projects accounts are still allocated on DP#%U1.
      495    14846              MESSAGE1: Packset DP#%U1 cannot removed while accounts are still
      496    14847                        allocated for sub-projects of project "%U2".
      497    14848        */
      498    14849    5               AS_FIELD1 = PACKSET;
      499    14850    5               CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );
      500    14851    5               GOTO CM_LOOP;
      501    14852    5               END;
      502    14853                                                          /* Delete the :PROJ record */
      503    14854    4            CALL ASB$DELREC_PROJ;
      504    14855
      505    14856    4            SELECT( 6 /* PROJ_PROJ_OPT_VAL */ );
      506    14857    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );
      507    14858    4            IF CR_MOD_FLG  AND  VAL < AS_PROJECT_DFLT.BUDGET.SUB_PROJS
      508    14859    5            THEN DO;
      509    14860        /*E* ERROR: ASA-E$P_PROJ_TOO_SMALL-C
      510    14861        MESSAGE: PROJECTS cannot be set less than the number of projects already
      511    14862                 accumulated by this project.  Setting PROJECTS to %U1.
      512    14863        MESSAGE1: %U1 sub-projects have already been accumulated by this project.
      513    14864                  You cannot set PROJECTS to a value which is less than the number of
      514    14865                  sub-projects already accumulated by the project.
      515    14866                  PROJECTS is set to %U1.
      516    14867        */
      517    14868    5               VAL = AS_PROJECT_DFLT.BUDGET.SUB_PROJS;
      518    14869                    %NUMBER( NUM1=VAL );
             14877    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );
      519    14899                    %SCREAM( ERR#=E$P_PROJ_TOO_SMALL, MID='A', LEVEL=ERROR );
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:19   
      520    14914    5               END;
      521    14915    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
      522    14916    5               IF AS_PROJECT.BUDGET.MAX_PROJECTS > 0 THEN
      523    14917    5                  DELTA = VAL - AS_PROJECT.BUDGET.MAX_PROJECTS;
      524    14918    5               ELSE
      525    14919    5                  DELTA = VAL;
      526    14920    5               IF AS_DEFAULT.BUDGET.SUB_PROJS + DELTA > AS_PROJ_ADMIN.BUDGET.
             14920                        MAX_PROJECTS
      527    14921    6               THEN DO;
      528    14922        /*E* ERROR: ASA-E$TOO_MANY_P_PROJS-C
      529    14923        MESSAGE: Maximum number of projects exceeded for project %U1.
      530    14924                 PROJECTS = %U2 is the most that can be specified.
      531    14925        */
      532    14926    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );
      533    14927    6                  CALL CONCAT( AS_FIELD1.TEXT,
      534    14928    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      535    14929    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
      536    14930    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;
      537    14931    6                  DELTA = AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS - AS_DEFAULT.BUDGET.
             14931                           SUB_PROJS + AS_PROJECT.BUDGET.MAX_PROJECTS;
      538    14932                       %NUMBER( NUM2=DELTA );
             14948    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, DELTA );
      539    14962                       %SCREAM( ERR#=E$TOO_MANY_P_PROJS,MID='A',LEVEL=ERROR);
      540    14977    6                  GOTO CM_LOOP;
      541    14978    6                  END;
      542    14979    5               AS_DEFAULT.BUDGET.SUB_PROJS = AS_DEFAULT.BUDGET.SUB_PROJS + DELTA;
      543    14980    5               END;
      544    14981    4            AS_PROJECT.BUDGET.MAX_PROJECTS = VAL;
      545    14982    4            END;          /* Do case(code); */
      546    14983    3         END;            /* Do i = 0 to SUBNODES-1; */
      547    14984    2      END;                /* Do while(more); */
      548    14985    1   OPTION_ERR: ;
      549    14986    1   CALL ASH$ERROR( P_PCB.ERROR );
      550    14987    1   GOTO CM_LOOP;
      551    14988                                                              /**/
      552    14989
      553    14990    1   END ASA$PROJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:20   
      554    14991        %EOD;

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:21   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$PROJECT.

   Procedure ASA$PROJECT requires 834 words for executable code.
   Procedure ASA$PROJECT requires 36 words of local(AUTO) storage.

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:22   

 Object Unit name= ASA$PROJECT                                File name= ASA$PROJ.:E05TOU
 UTS= JUL 29 '97 08:41:28.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$UC
    2   Data  even  none     1      1  ASA$PROJECT
    3  RoData even  UTS     17     21  ASA$PROJECT
    4   Proc  even  none   834   1502  ASA$PROJECT
    5  RoData even  none    35     43  ASA$PROJECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        1  ASA$PROJECT
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:23   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
         yes           Std       1 ASC$CM_OPTS
 yes     yes           Std       0 ASB$ENQ_USERS
 yes     yes           Std       1 ASB$WRITE_USERS
         yes           Std       4 ASB$BINCHAR
 yes     yes           Std       1 ASB$READ_USERS
 yes     yes           Std       0 ASB$PREC_PROJ
 yes     yes           Std       0 ASB$DELREC_PROJ
 yes     yes           Std       3 ASB$SET_PROMPT
 yes     yes           Std       3 ASB$READ_PROJ
         yes           Std       0 ASH$HELP
         yes           Std       2 ASH$ERROR
         yes           Std       0 ASH$QUEST
         yes           Std       2 ASA$PACKSET_OPTS
         yes           Std       3 ASA$ERROR
         yes           Std       2 ASA$KEYCONV
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:24   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     CR_MOD_PROJ_OPTS                 r    AS_BLANK                         r    AS_TRUE
r    AS_NONE                          r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             PROJ_KEY
     IN_BUF                                NODE$                                 CODE
     SUPERAUTH                             ERR_CODE                              AS_FIELD1
     AS_FIELD2                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          AS_PROJECT_ADMIN                      AS_CR_MOD_PROJ
     CR_MOD_FLG                            P_PCB                                 AS_USERS
     AS_DFLT                               AS_DEFAULT                            AS_PROJ_ADMIN
     AS_PROJECT                            AS_PROJECT_DFLT                       KL_DREC
     KL_DFLT                               AS_DEFAULT_DREC                       AS_PROJ_ADMIN_DREC
     AS_PROJECT_DREC                       AS_PROJECT_DFLT_DREC                  M$UC
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:25   


        1        1        /*M* ASA$PROJ - ROUTINE TO HANDLE PROJECT COMMAND. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        /*   ASA$PROJ : This module consists of procedures:
       11       11                             ASA$PROJECT
       12       12                             ASA$PACKSET_OPTS                      */
       13       13        /*M* ASA$PROJECT - external procedure for CREATE/MODIFY PROJECT options */
       14       14                                                              /**/
       15       15        /********************************************************************/
       16       16        /*                                                                   */
       17       17        /*                   ASA$PROJECT         proc                        */
       18       18        /*                                                                   */
       19       19        /*********************************************************************/
       20       20                                                              /**/
       21       21        ASA$PROJECT: PROC( CR_MOD_KEY );

     21  4 000000   000000 700200 xent  ASA$PROJECT  TSX0  ! X66_AUTO_1
         4 000001   000044 000001                    ZERO    36,1

       22       22                                                              /**/
       23       23        %SET LISTSUB = '1'B ;
       24       24        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:26   
       25       25        /********************************************************************/
       26       26        /*   Parameters      parameters      parameters      parameters      */
       27       27        /*********************************************************************/
       28       28                                                              /**/
       29       29    1   DCL 1 CR_MOD_KEY ALIGNED ,
       30       30    1          2 CNT UBIN(9) UNAL ,
       31       31    1          2 TEXT CHAR(20) UNAL ;
       32       32                                                              /**/
       33       33        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:27   
       34       34        /********************************************************************/
       35       35        /*   Include files   include files   include files   include files   */
       36       36        /*********************************************************************/
       37       37                                                              /**/
       38       38        %INCLUDE AS_ENTRIES_M ;
       39     1088        %INCLUDE AS_SUBS_C    ;
       40     2502        %INCLUDE AS_PERR_C    ;
       41     3104        %INCLUDE AS_MAC_C     ;
       42     3184        %INCLUDE AS_SUPER_C   ;
       43     3619        %INCLUDE XU_MACRO_C   ;
       44     6725        %INCLUDE XU_FORMAT_C  ;
       45     6887        %INCLUDE KL_SUPER_C   ;
       46     9789        %INCLUDE AS_SUPER_R   ;
       47    12805        %INCLUDE CP_6         ;
       48    12886        %INCLUDE B_ERRORS_C   ;
       49    14013                                                              /**/
       50    14014        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:28   
       51    14015        /********************************************************************/
       52    14016        /*   Constant & static data          constant & statc data           */
       53    14017        /*********************************************************************/
       54    14018                                                              /**/
       55    14019    1   DCL MORE BIT(1) STATIC ;
       56    14020                                                              /**/
       57    14021        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:29   
       58    14022        /********************************************************************/
       59    14023        /*   Local based     local based     local based     local based     */
       60    14024        /*********************************************************************/
       61    14025                                                              /**/
       62    14026        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       63    14027                    NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       64    14072        %PARSE$SYM( NAME = OUT$SYM ,
       65    14073                    STCLASS="BASED(BLK$)") ;
       66    14111    1   DCL 1 VARY$STR BASED(STR$) ALIGNED ,
       67    14112    1          2 CNT UBIN(9) UNAL ,
       68    14113    1          2 TEXT CHAR(VARY$STR.CNT) ;
       69    14114                                                              /**/
       70    14115        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:30   
       71    14116        /********************************************************************/
       72    14117        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       73    14118        /*********************************************************************/
       74    14119                                                              /**/
       75    14120    1   DCL X$PARSE ENTRY(1) ALTRET ;
       76    14121        %ASB$READ_SI ;
       77    14124        %ASB$SET_PROMPT ;
       78    14127        %ASB$WRITE_LO ;
       79    14130        %ASC$CM_OPTS ;
       80    14133        %ASH$HELP ;
       81    14136        %ASH$DQUEST ;
       82    14139        %ASH$QUEST ;
       83    14142        %ASH$ERROR ;
       84    14145        %ASH$WARN ;
       85    14148        %ASB$READ_PROJ ;
       86    14151        %ASB$PREC_PROJ ;
       87    14154        %ASB$DELREC_PROJ ;
       88    14157        %ASA$KEYCONV ;
       89    14160        %ASB$GETSEG ;
       90    14163        %ASA$PACKSET_OPTS ;
       91    14166        %ASB$ENQ_USERS ;
       92    14169        %ASB$READ_USERS ;
       93    14172        %ASB$WRITE_USERS ;
       94    14175        %ASA$ERROR ;
       95    14178                                                              /**/
       96    14179                                                              /**/
       97    14180        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:31   
       98    14181        /********************************************************************/
       99    14182        /*   Auto data       auto data       auto data       auto data       */
      100    14183        /*********************************************************************/
      101    14184                                                              /**/
      102    14185    1   DCL ARS SBIN ;
      103    14186    1   DCL DELTA SBIN;
      104    14187    1   DCL VAL SBIN ;
      105    14188    1   DCL UBIN_VAL UBIN;
      106    14189    1   DCL DOLLAR SBIN;
      107    14190    1   DCL CENTS  SBIN;
      108    14191    1   DCL SIGN SBIN;
      109    14192    1   DCL PRIO UBIN WORD ;
      110    14193    1   DCL SUBNODES SBIN ;
      111    14194    1   DCL SUBND$ PTR ;
      112    14195    1   DCL BLK$ PTR ;
      113    14196    1   DCL STR$ PTR ;
      114    14197    1   DCL I SBIN ;
      115    14198    1   DCL J SBIN ;
      116    14199    1   DCL 1 PACKSET,
      117    14200    1          2 CNT UBIN BYTE UNAL,
      118    14201    1          2 TXT CHAR(6) UNAL;
      119    14202        %AS$PROJ_HEADER( NAME=PROJ_HEADER, STCLASS=AUTO );
      120    14231                                                              /**/
      121    14232        %EJECT ;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:32   
      122    14233        /********************************************************************/
      123    14234        /*   Procedure       procedure       procedure       procedure       */
      124    14235        /*********************************************************************/
      125    14236                                                              /**/
      126    14237        /*
      127    14238            ***            Begin procedure                    ***
      128    14239        */
      129    14240    1   MORE = AS_TRUE ;

  14240  4 000002   000000 236000 xsym               LDQ     AS_TRUE
         4 000003   400000 376003                    ANQ     -131072,DU
         4 000004   000000 756000 2                  STQ     MORE

  14240  4 000005                       CM_LOOP      null
      130    14241                                                              /**/
      131    14242    1   CM_LOOP: ;
      132    14243    2   DO WHILE (MORE) ;

  14243  4 000005   000000 234000 2                  SZN     MORE
         4 000006   001475 605000 4                  TPL     OPTION_ERR

      133    14244    2      REMEMBER CM_LOOP IN REMEM_VAR ;

  14244  4 000007   000005 635000 4                  EAA     CM_LOOP
         4 000010   000000 452400 xsym               STP2    REMEM_VAR
         4 000011   000001 755000 xsym               STA     REMEM_VAR+1

      134    14245    2      P_PCB.ROOT$ = ADDR(CR_MOD_PROJ_OPTS);

  14245  4 000012   000000 236000 5                  LDQ     0
         4 000013   000001 756000 xsym               STQ     P_PCB+1

      135    14246                                                                  /*  Set prompt  */
      136    14247    2      CALL ASB$SET_PROMPT ( %PROMPT_PROJ ) ;

  14247  4 000014   000001 630400 5                  EPPR0   1
         4 000015   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:33   
         4 000016   000000 701000 xent               TSX1    ASB$SET_PROMPT
         4 000017   000000 011000                    NOP     0

      137    14248                                                                  /**/
      138    14249    2      CALL ASB$READ_SI(IN_BUF,ARS) ;             /* Read option line */

  14249  4 000020   200004 630500                    EPPR0   ARS,,AUTO
         4 000021   200041 450500                    STP0    PROJ_HEADER+13,,AUTO
         4 000022   000002 236000 5                  LDQ     2
         4 000023   200040 756100                    STQ     PROJ_HEADER+12,,AUTO
         4 000024   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 000025   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000026   000000 701000 xent               TSX1    ASB$READ_SI
         4 000027   000000 011000                    NOP     0

      139    14250    2      P_PCB.NCHARS = ARS ;

  14250  4 000030   200004 235100                    LDA     ARS,,AUTO
         4 000031   000011 755000 xsym               STA     P_PCB+9

      140    14251    2      CALL X$PARSE(P_PCB) ALTRET (OPTION_ERR) ;

  14251  4 000032   000003 630400 5                  EPPR0   3
         4 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000034   000000 701000 xent               TSX1    X$PARSE
         4 000035   001475 702000 4                  TSX2    OPTION_ERR

      141    14252                                                              /**/
      142    14253    2      NODE$ = P_PCB.OUT$ ;

  14253  4 000036   000003 236000 xsym               LDQ     P_PCB+3
         4 000037   000000 756000 xsym               STQ     NODE$

      143    14254                                                              /**/
      144    14255                                                              /**/
      145    14256    2      CODE = P$NODE.CODE ;

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:34   
  14256  4 000040   000000 470400 xsym               LDP0    NODE$
         4 000041   000000 236100                    LDQ     0,,PR0
         4 000042   777777 376007                    ANQ     -1,DL
         4 000043   000000 756000 xsym               STQ     CODE

      146    14257    2      SUBNODES = P$NODE.SUBNODES ;

  14257  4 000044   000001 236100                    LDQ     1,,PR0
         4 000045   000022 772000                    QRL     18
         4 000046   200014 756100                    STQ     SUBNODES,,AUTO

      147    14258                                                              /**/
      148    14259    3      DO I = 0 TO SUBNODES-1 ;

  14259  4 000047   200020 450100                    STZ     I,,AUTO
         4 000050   001470 710000 4                  TRA     s:14983+1

      149    14260    3         SUBND$ = P$NODE.SUBLK$(I) ;

  14260  4 000051   000000 470400 xsym               LDP0    NODE$
         4 000052   200020 720100                    LXL0    I,,AUTO
         4 000053   000003 236110                    LDQ     3,X0,PR0
         4 000054   200015 756100                    STQ     SUBND$,,AUTO

      150    14261    3         CODE = SUBND$ -> P$NODE.CODE ;

  14261  4 000055   200015 471500                    LDP1    SUBND$,,AUTO
         4 000056   100000 236100                    LDQ     0,,PR1
         4 000057   777777 376007                    ANQ     -1,DL
         4 000060   000000 756000 xsym               STQ     CODE

      151    14262                                                              /**/
      152    14263    4         DO SELECT (CODE) ;

  14263  4 000061   000005 116007                    CMPQ    5,DL
         4 000062   000115 602000 4                  TNC     s:14263+28
         4 000063   000367 600000 4                  TZE     s:14379
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:35   
         4 000064   000032 116007                    CMPQ    26,DL
         4 000065   000100 602000 4                  TNC     s:14263+15
         4 000066   000131 600000 4                  TZE     s:14266
         4 000067   000455 116007                    CMPQ    301,DL
         4 000070   000075 602000 4                  TNC     s:14263+12
         4 000071   000267 600000 4                  TZE     s:14339
         4 000072   000456 116007                    CMPQ    302,DL
         4 000073   001467 601000 4                  TNZ     s:14983
         4 000074   000257 710000 4                  TRA     s:14333
         4 000075   000454 116007                    CMPQ    300,DL
         4 000076   001467 601000 4                  TNZ     s:14983
         4 000077   000263 710000 4                  TRA     s:14336
         4 000100   000010 116007                    CMPQ    8,DL
         4 000101   000106 602000 4                  TNC     s:14263+21
         4 000102   001133 600000 4                  TZE     s:14781
         4 000103   000014 116007                    CMPQ    12,DL
         4 000104   001467 601000 4                  TNZ     s:14983
         4 000105   000131 710000 4                  TRA     s:14266
         4 000106   000007 116007                    CMPQ    7,DL
         4 000107   000112 602000 4                  TNC     s:14263+25
         4 000110   000547 600000 4                  TZE     s:14535
         4 000111   001467 710000 4                  TRA     s:14983
         4 000112   000006 116007                    CMPQ    6,DL
         4 000113   001467 601000 4                  TNZ     s:14983
         4 000114   001271 710000 4                  TRA     s:14857
         4 000115   000002 116007                    CMPQ    2,DL
         4 000116   000126 602000 4                  TNC     s:14263+37
         4 000117   000331 600000 4                  TZE     s:14356
         4 000120   000003 116007                    CMPQ    3,DL
         4 000121   001467 602000 4                  TNC     s:14983
         4 000122   000744 600000 4                  TZE     s:14645
         4 000123   000004 116007                    CMPQ    4,DL
         4 000124   001467 601000 4                  TNZ     s:14983
         4 000125   001107 710000 4                  TRA     s:14772
         4 000126   000001 116007                    CMPQ    1,DL
         4 000127   001467 601000 4                  TNZ     s:14983
         4 000130   000273 710000 4                  TRA     s:14342
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:36   

      153    14264                                                              /**/
      154    14265    4            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */) ;

      155    14266    4            USERS_KEY = CR_MOD_KEY;         /* End or blank input */

  14266  4 000131   200003 473500                    LDP3    @CR_MOD_KEY,,AUTO
         4 000132   000000 100500                    MLR     fill='000'O
         4 000133   300000 000025                    ADSC9   0,,PR3                   cn=0,n=21
         4 000134   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      156    14267    4            IF CR_MOD_KEY.TEXT = 'DEFAULTP' THEN RETURN;

  14267  4 000135   040000 106500                    CMPC    fill='040'O
         4 000136   300000 200024                    ADSC9   0,,PR3                   cn=1,n=20
         4 000137   000000 000010 3                  ADSC9   0                        cn=0,n=8
         4 000140   000142 601000 4                  TNZ     s:14268

  14267  4 000141   000000 702200 xent               TSX2  ! X66_ARET

      157    14268    4            PROJ_KEY.TXT.PROJECT = CR_MOD_KEY.TEXT;

  14268  4 000142   040000 100500                    MLR     fill='040'O
         4 000143   300000 200024                    ADSC9   0,,PR3                   cn=1,n=20
         4 000144   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

      158    14269    4            PROJ_KEY.TXT.PACKSET = AS_PROJECT.HPSN;

  14269  4 000145   040000 100400                    MLR     fill='040'O
         4 000146   000123 000006 xsym               ADSC9   AS_PROJECT+83            cn=0,n=6
         4 000147   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      159    14270    4            CALL INDEX( J, AS_BLANK, AS_PROJECT.HPSN );

  14270  4 000150   000000 124400                    SCM     mask='000'O
         4 000151   000123 000006 xsym               ADSC9   AS_PROJECT+83            cn=0,n=6
         4 000152   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:37   
         4 000153   200021 000100                    ARG     J,,AUTO

      160    14271    4            PROJ_KEY.COUNT = 20 + J;

  14271  4 000154   200021 236100                    LDQ     J,,AUTO
         4 000155   000024 036007                    ADLQ    20,DL
         4 000156   000033 736000                    QLS     27
         4 000157   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      161    14272    4            J = SIZEC(PROJ_HEADER);

  14272  4 000160   000060 235007                    LDA     48,DL
         4 000161   200021 755100                    STA     J,,AUTO

      162    14273    4            CALL ASB$READ_PROJ(ADDR(PROJ_HEADER),J) ALTRET(READ_PROJ_ERR);

  14273  4 000162   200024 634500                    EPPR4   PROJ_HEADER,,AUTO
         4 000163   200040 454500                    STP4    PROJ_HEADER+12,,AUTO
         4 000164   200021 635500                    EPPR5   J,,AUTO
         4 000165   200043 455500                    STP5    PROJ_HEADER+15,,AUTO
         4 000166   200040 636500                    EPPR6   PROJ_HEADER+12,,AUTO
         4 000167   200042 456500                    STP6    PROJ_HEADER+14,,AUTO
         4 000170   200042 630500                    EPPR0   PROJ_HEADER+14,,AUTO
         4 000171   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000172   000000 701000 xent               TSX1    ASB$READ_PROJ
         4 000173   000231 702000 4                  TSX2    READ_PROJ_ERR

      163    14274    4            IF AS_PROJECT.HPSN = AS_PROJECT_DFLT.HPSN THEN RETURN;

  14274  4 000174   040000 106400                    CMPC    fill='040'O
         4 000175   000123 000006 xsym               ADSC9   AS_PROJECT+83            cn=0,n=6
         4 000176   000123 000006 xsym               ADSC9   AS_PROJECT_DFLT+83       cn=0,n=6
         4 000177   000201 601000 4                  TNZ     s:14275

  14274  4 000200   000000 702200 xent               TSX2  ! X66_ARET

      164    14275    4            PROJ_KEY.TXT.PACKSET = AS_PROJECT_DFLT.HPSN;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:38   

  14275  4 000201   040000 100400                    MLR     fill='040'O
         4 000202   000123 000006 xsym               ADSC9   AS_PROJECT_DFLT+83       cn=0,n=6
         4 000203   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      165    14276    4            CALL INDEX( J, AS_BLANK, AS_PROJECT_DFLT.HPSN );

  14276  4 000204   000000 124400                    SCM     mask='000'O
         4 000205   000123 000006 xsym               ADSC9   AS_PROJECT_DFLT+83       cn=0,n=6
         4 000206   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000207   200021 000100                    ARG     J,,AUTO

      166    14277    4            PROJ_KEY.COUNT = 20 + J;

  14277  4 000210   200021 236100                    LDQ     J,,AUTO
         4 000211   000024 036007                    ADLQ    20,DL
         4 000212   000033 736000                    QLS     27
         4 000213   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      167    14278    4            J = SIZEC(PROJ_HEADER);

  14278  4 000214   000060 235007                    LDA     48,DL
         4 000215   200021 755100                    STA     J,,AUTO

      168    14279    4            CALL ASB$READ_PROJ(ADDR(PROJ_HEADER),J) ALTRET(READ_PROJ_ERR);

  14279  4 000216   200024 630500                    EPPR0   PROJ_HEADER,,AUTO
         4 000217   200040 450500                    STP0    PROJ_HEADER+12,,AUTO
         4 000220   200021 631500                    EPPR1   J,,AUTO
         4 000221   200043 451500                    STP1    PROJ_HEADER+15,,AUTO
         4 000222   200040 633500                    EPPR3   PROJ_HEADER+12,,AUTO
         4 000223   200042 453500                    STP3    PROJ_HEADER+14,,AUTO
         4 000224   200042 630500                    EPPR0   PROJ_HEADER+14,,AUTO
         4 000225   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000226   000000 701000 xent               TSX1    ASB$READ_PROJ
         4 000227   000231 702000 4                  TSX2    READ_PROJ_ERR

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:39   
      169    14280    4            RETURN;

  14280  4 000230   000000 702200 xent               TSX2  ! X66_ARET

      170    14281    4   READ_PROJ_ERR:
      171    14282    4            AS_FIELD1.COUNT = PROJ_KEY.COUNT - 20;

  14282  4 000231   000000 236000 xsym  READ_PROJ_E* LDQ     PROJ_KEY
         4 000232   000033 772000                    QRL     27
         4 000233   000024 136007                    SBLQ    20,DL
         4 000234   000033 736000                    QLS     27
         4 000235   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      172    14283    4            AS_FIELD1.TEXT = PROJ_KEY.TXT.PACKSET;

  14283  4 000236   040000 100400                    MLR     fill='040'O
         4 000237   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 000240   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      173    14284    5            IF PROJ_KEY.TXT.PACKSET = AS_PROJECT.HPSN THEN DO;

  14284  4 000241   040000 106400                    CMPC    fill='040'O
         4 000242   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         4 000243   000123 000006 xsym               ADSC9   AS_PROJECT+83            cn=0,n=6
         4 000244   000252 601000 4                  TNZ     s:14327

      174    14285        /*E*  ERROR:  ASA-E$MISSING_PACKSET1-C
      175    14286        MESSAGE: The home packset for the project administrator of this project is DP#%U1.
      176    14287                 PACKSET = DP#%U1 must be specified for this project.
      177    14288        MESSAGE1: You must specify a PACKSET option for the packset that was
      178    14289                  specified as the home packset for the project administrator
      179    14290                  of this project.
      180    14291        */
      181    14292                    %SCREAM( ERR#=E$MISSING_PACKSET1, LEVEL=ERROR,MID='A' );

  14304  4 000245   000004 630400 5                  EPPR0   4
         4 000246   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:40   
         4 000247   000000 701000 xent               TSX1    ASH$ERROR
         4 000250   000000 011000                    NOP     0

      182    14307    5               END;

  14307  4 000251   001467 710000 4                  TRA     s:14983

      183    14308    5            ELSE DO;

      184    14309        /*E*  ERROR:  ASA-E$MISSING_PACKSET2-C
      185    14310        MESSAGE: The default home packset for users in this project is DP#%U1.
      186    14311                 PACKSET = DP#%U1 must be specified for this project.
      187    14312        MESSAGE1: You must specify a PACKSET option for the packset that was
      188    14313                  specified as the default home packset for users in the project.
      189    14314        */
      190    14315                    %SCREAM( ERR#=E$MISSING_PACKSET2, LEVEL=ERROR, MID='A' );

  14327  4 000252   000005 630400 5                  EPPR0   5
         4 000253   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000254   000000 701000 xent               TSX1    ASH$ERROR
         4 000255   000000 011000                    NOP     0

      191    14330    5               END;

  14330  4 000256   001467 710000 4                  TRA     s:14983

      192    14331                                                              /**/
      193    14332    4            SELECT(302 /* HELP_VAL */) ;

      194    14333    4            CALL ASH$HELP ;

  14333  4 000257   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000260   000000 701000 xent               TSX1    ASH$HELP
         4 000261   000000 011000                    NOP     0
         4 000262   001467 710000 4                  TRA     s:14983

      195    14334                                                              /**/
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:41   
      196    14335    4            SELECT(300 /* DQUESTION_VAL */) ;

      197    14336    4            CALL ASH$DQUEST ;

  14336  4 000263   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000264   000000 701000 xent               TSX1    ASH$DQUEST
         4 000265   000000 011000                    NOP     0
         4 000266   001467 710000 4                  TRA     s:14983

      198    14337                                                              /**/
      199    14338    4            SELECT(301 /* QUESTION_VAL */) ;

      200    14339    4            CALL ASH$QUEST ;

  14339  4 000267   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000270   000000 701000 xent               TSX1    ASH$QUEST
         4 000271   000000 011000                    NOP     0
         4 000272   001467 710000 4                  TRA     s:14983

      201    14340                                                              /**/
      202    14341    4            SELECT( 1 /* PROJ_ADMIN_VAL */ );

      203    14342    4            AS_USERS = AS_PROJECT;

  14342  4 000273   000000 100400                    MLR     fill='000'O
         4 000274   000000 004020 xsym               ADSC9   AS_PROJECT               cn=0,n=2064
         4 000275   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

      204    14343    4            KL_DREC  = AS_PROJECT_DREC;

  14343  4 000276   000000 100400                    MLR     fill='000'O
         4 000277   000000 001244 xsym               ADSC9   AS_PROJECT_DREC          cn=0,n=676
         4 000300   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676

      205    14344    4            IF AS_CR_MOD_PROJ > 0

  14344  4 000301   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:42   
         4 000302   000314 604400 4                  TMOZ    s:14350

      206    14345    5            THEN DO;

      207    14346    5               AS_CR_MOD_PROJ = %CR_PROJECT;

  14346  4 000303   000002 235007                    LDA     2,DL
         4 000304   000000 755000 xsym               STA     AS_CR_MOD_PROJ

      208    14347    5               AS_DFLT = AS_PROJ_ADMIN;

  14347  4 000305   000000 100400                    MLR     fill='000'O
         4 000306   000000 004020 xsym               ADSC9   AS_PROJ_ADMIN            cn=0,n=2064
         4 000307   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064

      209    14348    5               KL_DFLT = AS_PROJ_ADMIN_DREC;

  14348  4 000310   000000 100400                    MLR     fill='000'O
         4 000311   000000 001244 xsym               ADSC9   AS_PROJ_ADMIN_DREC       cn=0,n=676
         4 000312   000000 001244 xsym               ADSC9   KL_DFLT                  cn=0,n=676

      210    14349    5               END;

  14349  4 000313   000316 710000 4                  TRA     s:14351

      211    14350    4            ELSE AS_CR_MOD_PROJ = - %CR_PROJECT;

  14350  4 000314   000002 335007                    LCA     2,DL
         4 000315   000000 755000 xsym               STA     AS_CR_MOD_PROJ

      212    14351    4            CALL ASC$CM_OPTS( CR_MOD_KEY );

  14351  4 000316   200003 630500                    EPPR0   @CR_MOD_KEY,,AUTO
         4 000317   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000320   000000 701000 xent               TSX1    ASC$CM_OPTS
         4 000321   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:43   
      213    14352    4            AS_PROJECT = AS_USERS;

  14352  4 000322   000000 100400                    MLR     fill='000'O
         4 000323   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064
         4 000324   000000 004020 xsym               ADSC9   AS_PROJECT               cn=0,n=2064

      214    14353    4            AS_PROJECT_DREC = KL_DREC;

  14353  4 000325   000000 100400                    MLR     fill='000'O
         4 000326   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676
         4 000327   000000 001244 xsym               ADSC9   AS_PROJECT_DREC          cn=0,n=676
         4 000330   001467 710000 4                  TRA     s:14983

      215    14354                                                              /**/
      216    14355    4            SELECT( 2 /* PROJ_DFLT_VAL */ );

      217    14356    4            AS_USERS = AS_PROJECT_DFLT;

  14356  4 000331   000000 100400                    MLR     fill='000'O
         4 000332   000000 004020 xsym               ADSC9   AS_PROJECT_DFLT          cn=0,n=2064
         4 000333   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

      218    14357    4            KL_DREC  = AS_PROJECT_DFLT_DREC;

  14357  4 000334   000000 100400                    MLR     fill='000'O
         4 000335   000000 001244 xsym               ADSC9   AS_PROJECT_DFLT_DREC     cn=0,n=676
         4 000336   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676

      219    14358    4            IF AS_CR_MOD_PROJ > 0

  14358  4 000337   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 000340   000352 604400 4                  TMOZ    s:14364

      220    14359    5            THEN DO;

      221    14360    5               AS_CR_MOD_PROJ = %CR_PROJ_DEFAULT;

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:44   
  14360  4 000341   000003 235007                    LDA     3,DL
         4 000342   000000 755000 xsym               STA     AS_CR_MOD_PROJ

      222    14361    5               AS_DFLT = AS_DEFAULT;

  14361  4 000343   000000 100400                    MLR     fill='000'O
         4 000344   000000 004020 xsym               ADSC9   AS_DEFAULT               cn=0,n=2064
         4 000345   000000 004020 xsym               ADSC9   AS_DFLT                  cn=0,n=2064

      223    14362    5               KL_DFLT = AS_DEFAULT_DREC;

  14362  4 000346   000000 100400                    MLR     fill='000'O
         4 000347   000000 001244 xsym               ADSC9   AS_DEFAULT_DREC          cn=0,n=676
         4 000350   000000 001244 xsym               ADSC9   KL_DFLT                  cn=0,n=676

      224    14363    5               END;

  14363  4 000351   000354 710000 4                  TRA     s:14365

      225    14364    4            ELSE AS_CR_MOD_PROJ = - %CR_PROJ_DEFAULT;

  14364  4 000352   000003 335007                    LCA     3,DL
         4 000353   000000 755000 xsym               STA     AS_CR_MOD_PROJ

      226    14365    4            CALL ASC$CM_OPTS( CR_MOD_KEY );

  14365  4 000354   200003 630500                    EPPR0   @CR_MOD_KEY,,AUTO
         4 000355   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000356   000000 701000 xent               TSX1    ASC$CM_OPTS
         4 000357   000000 011000                    NOP     0

      227    14366    4            AS_PROJECT_DFLT = AS_USERS;

  14366  4 000360   000000 100400                    MLR     fill='000'O
         4 000361   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064
         4 000362   000000 004020 xsym               ADSC9   AS_PROJECT_DFLT          cn=0,n=2064

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:45   
      228    14367    4            AS_PROJECT_DFLT_DREC = KL_DREC;

  14367  4 000363   000000 100400                    MLR     fill='000'O
         4 000364   000000 001244 xsym               ADSC9   KL_DREC                  cn=0,n=676
         4 000365   000000 001244 xsym               ADSC9   AS_PROJECT_DFLT_DREC     cn=0,n=676
         4 000366   001467 710000 4                  TRA     s:14983

      229    14368                                                              /**/
      230    14369    4            SELECT( 5 /* PROJ_CHARGES_VAL */ );

      231    14370                                                              /**/
      232    14371        /*
      233    14372            If the value input on the mcharges option line has a sign
      234    14373            associated with it,  the value is treated relative to the
      235    14374            current maxc value, or the default maxc value.  If the input
      236    14375            value does not have a sign it is treated as an absolute
      237    14376            replacement value for either the current maxc, if there is
      238    14377            one, or it replaces the default maxc.
      239    14378        */
      240    14379    4            IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 7   /*  NONE_VAL  */

  14379  4 000367   100003 473500                    LDP3    3,,PR1
         4 000370   300000 721100                    LXL1    0,,PR3
         4 000371   000007 101003                    CMPX1   7,DU
         4 000372   000376 601000 4                  TNZ     s:14384

      241    14380    5            THEN DO;

      242    14381    5               AS_PROJECT.BUDGET.PMAXC = -1;

  14381  4 000373   000001 335007                    LCA     1,DL
         4 000374   000010 755000 xsym               STA     AS_PROJECT+8

      243    14382    5               END;

  14382  4 000375   001467 710000 4                  TRA     s:14983

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:46   
      244    14383    5            ELSE DO;

      245    14384    6               IF SUBND$ -> P$NODE.SUBNODES = 1 THEN DO;

  14384  4 000376   100001 222100                    LDX2    1,,PR1
         4 000377   000001 102003                    CMPX2   1,DU
         4 000400   000405 601000 4                  TNZ     s:14389

      246    14385    6                  SIGN = 0; /*  no sign on the input  */

  14385  4 000401   200012 450100                    STZ     SIGN,,AUTO

      247    14386    6                  BLK$ = SUBND$ -> P$NODE.SUBLK$(0);

  14386  4 000402   100003 236100                    LDQ     3,,PR1
         4 000403   200016 756100                    STQ     BLK$,,AUTO

      248    14387    6                  END;

  14387  4 000404   000420 710000 4                  TRA     s:14394

      249    14388    6               ELSE DO; /*  we have a sign  */

      250    14389    6                  BLK$ = SUBND$ -> P$NODE.SUBLK$(1); /* pts to mcharges value node */

  14389  4 000405   100004 236100                    LDQ     4,,PR1
         4 000406   200016 756100                    STQ     BLK$,,AUTO

      251    14390    6                  IF SUBND$-> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1
             14390                           /* MINUS_VAL */

  14390  4 000407   300003 474500                    LDP4    3,,PR3
         4 000410   400000 723100                    LXL3    0,,PR4
         4 000411   000001 103003                    CMPX3   1,DU
         4 000412   000416 601000 4                  TNZ     s:14392

      252    14391    6                  THEN SIGN = -1;
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:47   

  14391  4 000413   000001 335007                    LCA     1,DL
         4 000414   200012 755100                    STA     SIGN,,AUTO
         4 000415   000420 710000 4                  TRA     s:14394

      253    14392    6                  ELSE SIGN = 1;

  14392  4 000416   000001 235007                    LDA     1,DL
         4 000417   200012 755100                    STA     SIGN,,AUTO

      254    14393    6                  END;

      255    14394    5               CALL CHARBIN( DOLLAR, BLK$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );

  14394  4 000420   200016 474500                    LDP4    BLK$,,AUTO
         4 000421   400003 475500                    LDP5    3,,PR4
         4 000422   500004 236100                    LDQ     4,,PR5
         4 000423   000033 772000                    QRL     27
         4 000424   000000 623006                    EAX3    0,QL
         4 000425   000100 305540                    DTB
         4 000426   500004 230013                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X3
         4 000427   200010 000004                    NDSC9   DOLLAR,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      256    14395    5               IF BLK$ -> P$NODE.SUBNODES = 1 THEN

  14395  4 000430   400001 224100                    LDX4    1,,PR4
         4 000431   000001 104003                    CMPX4   1,DU
         4 000432   000435 601000 4                  TNZ     s:14398

      257    14396    5                  CENTS = 0;

  14396  4 000433   200011 450100                    STZ     CENTS,,AUTO
         4 000434   000461 710000 4                  TRA     s:14406

      258    14397    6               ELSE DO;

      259    14398    6                  IF BLK$->P$NODE.SUBLK$(1)->OUT$SYM.COUNT = 1
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:48   

  14398  4 000435   400004 476500                    LDP6    4,,PR4
         4 000436   600004 236100                    LDQ     4,,PR6
         4 000437   777000 376003                    ANQ     -512,DU
         4 000440   001000 116003                    CMPQ    512,DU
         4 000441   000454 601000 4                  TNZ     s:14404

      260    14399    7                  THEN DO;

      261    14400    7                     CALL CHARBIN( CENTS, BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT);

  14400  4 000442   600004 236100                    LDQ     4,,PR6
         4 000443   000033 772000                    QRL     27
         4 000444   000000 625006                    EAX5    0,QL
         4 000445   000100 305540                    DTB
         4 000446   600004 230015                    NDSC9   4,,PR6                   cn=1,s=nosgn,sf=0,n=*X5
         4 000447   200011 000004                    NDSC9   CENTS,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      262    14401    7                     CENTS = CENTS * 10;

  14401  4 000450   200011 236100                    LDQ     CENTS,,AUTO
         4 000451   000012 402007                    MPY     10,DL
         4 000452   200011 756100                    STQ     CENTS,,AUTO

      263    14402    7                     END;

  14402  4 000453   000461 710000 4                  TRA     s:14406

      264    14403    6                  ELSE
      265    14404    6                    CALL CHARBIN(CENTS,SUBSTR(BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT,0,2
             14404                              ));

  14404  4 000454   600004 236100                    LDQ     4,,PR6
         4 000455   000033 772000                    QRL     27
         4 000456   000100 305500                    DTB
         4 000457   600004 230002                    NDSC9   4,,PR6                   cn=1,s=nosgn,sf=0,n=2
         4 000460   200011 000004                    NDSC9   CENTS,,AUTO              cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:49   

      266    14405    6                  END;

      267    14406    5               UBIN_VAL = DOLLAR * 10000 + CENTS * 100 ;

  14406  4 000461   200010 236100                    LDQ     DOLLAR,,AUTO
         4 000462   000144 402007                    MPY     100,DL
         4 000463   200011 036100                    ADLQ    CENTS,,AUTO
         4 000464   000144 402007                    MPY     100,DL
         4 000465   200007 756100                    STQ     UBIN_VAL,,AUTO

      268    14407    5               IF SIGN ~= 0 THEN

  14407  4 000466   200012 235100                    LDA     SIGN,,AUTO
         4 000467   000506 600000 4                  TZE     s:14453

      269    14408    6                  IF UBIN_VAL > 34359738300 THEN DO;

  14408  4 000470   000006 116000 5                  CMPQ    6
         4 000471   000506 602000 4                  TNC     s:14453

      270    14409    7                     IF SIGN = -1 THEN DO;

  14409  4 000472   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000473   000501 601000 4                  TNZ     s:14447

      271    14410        /*E*   ERROR: ASA-E$MCHARGES_TOO_SML-C
      272    14411             MESSAGE: Mcharges too small.
      273    14412             MESSAGE1: Mcharges cannot be less than -3435973.83.
      274    14413        */
      275    14414                             %SCREAM( ERR#=E$MCHARGES_TOO_SML, LEVEL=ERROR, MID='A' );

  14426  4 000474   000007 630400 5                  EPPR0   7
         4 000475   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000476   000000 701000 xent               TSX1    ASH$ERROR
         4 000477   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:50   
      276    14429    7                        END;

  14429  4 000500   000505 710000 4                  TRA     s:14451

      277    14430    7                     ELSE DO;

      278    14431        /*E*   ERROR: ASA-E$MCHARGES_TOO_BIG-C
      279    14432             MESSAGE: Mcharges too large.
      280    14433             MESSAGE1: Mcharges cannot be greater than 3435973.83.
      281    14434        */
      282    14435                             %SCREAM( ERR#=E$MCHARGES_TOO_BIG, LEVEL=ERROR, MID='A' );

  14447  4 000501   000010 630400 5                  EPPR0   8
         4 000502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000503   000000 701000 xent               TSX1    ASH$ERROR
         4 000504   000000 011000                    NOP     0

      283    14450    7                        END;

      284    14451    6                     GOTO CM_LOOP;

  14451  4 000505   000005 710000 4                  TRA     CM_LOOP

      285    14452    6                     END;
      286    14453    5               IF AS_PROJECT.BUDGET.PMAXC = -1 AND SIGN = -1

  14453  4 000506   000010 235000 xsym               LDA     AS_PROJECT+8
         4 000507   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000510   000521 601000 4                  TNZ     s:14476
         4 000511   200012 235100                    LDA     SIGN,,AUTO
         4 000512   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000513   000521 601000 4                  TNZ     s:14476

      287    14454    6               THEN DO;

      288    14455        /*E* ERROR: ASA-E$MCHARGES_ILL_VAL-C
      289    14456             MESSAGE: MCHARGES cannot be negative.
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:51   
      290    14457             MESSAGE1: MCHARGES cannot be negative when previously set to NONE.
      291    14458        */
      292    14459                       %SCREAM( ERR#=E$MCHARGES_ILL_VAL,LEVEL=ERROR,MID='A');

  14471  4 000514   000011 630400 5                  EPPR0   9
         4 000515   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000516   000000 701000 xent               TSX1    ASH$ERROR
         4 000517   000000 011000                    NOP     0

      293    14474    6                  GOTO CM_LOOP;

  14474  4 000520   000005 710000 4                  TRA     CM_LOOP

      294    14475    6                  END;
      295    14476    5               IF SIGN = 0 THEN

  14476  4 000521   200012 235100                    LDA     SIGN,,AUTO
         4 000522   000524 601000 4                  TNZ     s:14478

      296    14477    5                  AS_PROJECT.BUDGET.PMAXC = UBIN_VAL ;

  14477  4 000523   000010 756000 xsym               STQ     AS_PROJECT+8

      297    14478    5               IF AS_PROJECT.BUDGET.PMAXC = -1 AND SIGN = 1

  14478  4 000524   000010 235000 xsym               LDA     AS_PROJECT+8
         4 000525   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000526   000534 601000 4                  TNZ     s:14481
         4 000527   200012 235100                    LDA     SIGN,,AUTO
         4 000530   000001 115007                    CMPA    1,DL
         4 000531   000534 601000 4                  TNZ     s:14481

      298    14479    5               THEN AS_PROJECT.BUDGET.PMAXC = UBIN_VAL;

  14479  4 000532   000010 756000 xsym               STQ     AS_PROJECT+8
         4 000533   001467 710000 4                  TRA     s:14983

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:52   
      299    14480    6               ELSE DO;

      300    14481    6                  VAL = (SIGN * UBIN_VAL) + AS_PROJECT.BUDGET.PMAXC ;

  14481  4 000534   200012 402100                    MPY     SIGN,,AUTO
         4 000535   000010 036000 xsym               ADLQ    AS_PROJECT+8
         4 000536   200006 756100                    STQ     VAL,,AUTO

      301    14482    6                  IF VAL >= 0 THEN

  14482  4 000537   000542 604000 4                  TMI     s:14501

      302    14483    6                     AS_PROJECT.BUDGET.PMAXC = VAL ;

  14483  4 000540   000010 756000 xsym               STQ     AS_PROJECT+8
         4 000541   001467 710000 4                  TRA     s:14983

      303    14484    7                  ELSE DO;

      304    14485        /*E*  ERROR: ASA-E$MCHARGES_NEG_VAL-C
      305    14486              MESSAGE: MCHARGES is a negative value.
      306    14487              MESSAGE1: MCHARGES cannot have a negative value.
      307    14488        */
      308    14489                          %SCREAM(ERR#=E$MCHARGES_NEG_VAL,LEVEL=ERROR,MID='A') ;

  14501  4 000542   000012 630400 5                  EPPR0   10
         4 000543   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000544   000000 701000 xent               TSX1    ASH$ERROR
         4 000545   000000 011000                    NOP     0

      309    14504    7                     END;

      310    14505    6                  END;

      311    14506    5               END;

  14506  4 000546   001467 710000 4                  TRA     s:14983
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:53   

      312    14507
      313    14508        /*
      314    14509        If AS_CR_MOD_PROJ > 0  and  AS_DFLT.BUDGET.MAXC > 0
      315    14510        then
      316    14511           if AS_PROJECT.BUDGET.PMAXC > AS_DFLT.BUDGET.MAXC
      317    14512           then do;
      318    14513        */
      319    14514        /*E* ERROR:   ASA-E$MCHARGES_TOO_LARGE-C
      320    14515             MESSAGE: MCHARGES greater than the maximum allowed for a %U1 you create.
      321    14516             MESSAGE1: MCHARGES = %U2.%U3 is the maximum allowed for a %U1 you create.
      322    14517                       Setting MCHARGE to %U2.%U3.
      323    14518        */
      324    14519        /*
      325    14520              AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      326    14521              dollar = AS_DFLT.BUDGET.MAXC / 10000;
      327    14522              cents = mod( AS_DFLT.BUDGET.MAXC, 10000 ) / 100;
      328    14523              %NUMBER( NUM2="DOLLAR", NUM3="CENTS" );
      329    14524              if AS_FIELD3.COUNT = 1
      330    14525              then do;
      331    14526                 AS_FIELD3.COUNT = 2;
      332    14527                 call insert( AS_FIELD3.TEXT, 1, 1, '0' );
      333    14528                 end;
      334    14529              %SCREAM( ERR#=E$MCHARGES_TOO_LARGE, level=error, mid='a' );
      335    14530              AS_PROJECT.BUDGET.PMAXC = AS_DFLT.BUDGET.MAXC;
      336    14531              end;
      337    14532
      338    14533        */
      339    14534    4            SELECT( 7 /* PROJECT ACHARGES */ );

      340    14535    5            IF NOT SUPERAUTH THEN DO;

  14535  4 000547   000000 234000 xsym               SZN     SUPERAUTH
         4 000550   000556 604000 4                  TMI     s:14556

      341    14536        /*E* ERROR:   ASA-E$ACHARGES_NOT_ALLOWED-C
      342    14537        MESSAGE: The SUPERAUTH pprivilege is required to use the ACHARGES option.
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:54   
      343    14538        */
      344    14539                    %SCREAM( ERR#=E$ACHARGES_NOT_ALLOWED,LEVEL=ERROR,MID='A');

  14551  4 000551   000013 630400 5                  EPPR0   11
         4 000552   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000553   000000 701000 xent               TSX1    ASH$ERROR
         4 000554   000000 011000                    NOP     0

      345    14554    5               GOTO CM_LOOP;

  14554  4 000555   000005 710000 4                  TRA     CM_LOOP

      346    14555    5               END;
      347    14556    5            IF SUBND$ -> P$NODE.SUBNODES = 1 THEN DO;

  14556  4 000556   100001 221100                    LDX1    1,,PR1
         4 000557   000001 101003                    CMPX1   1,DU
         4 000560   000566 601000 4                  TNZ     s:14561

      348    14557    5               SIGN = 1;

  14557  4 000561   000001 235007                    LDA     1,DL
         4 000562   200012 755100                    STA     SIGN,,AUTO

      349    14558    5               BLK$ = SUBND$ -> P$NODE.SUBLK$(0);

  14558  4 000563   100003 236100                    LDQ     3,,PR1
         4 000564   200016 756100                    STQ     BLK$,,AUTO

      350    14559    5               END;

  14559  4 000565   000602 710000 4                  TRA     s:14566

      351    14560    5            ELSE DO;

      352    14561    5               IF SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) -> P$NODE.CODE = 1
             14561                        /* MINUS_VAL */
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:55   

  14561  4 000566   100003 473500                    LDP3    3,,PR1
         4 000567   300003 474500                    LDP4    3,,PR3
         4 000570   400000 722100                    LXL2    0,,PR4
         4 000571   000001 102003                    CMPX2   1,DU
         4 000572   000576 601000 4                  TNZ     s:14563

      353    14562    5               THEN SIGN = -1;

  14562  4 000573   000001 335007                    LCA     1,DL
         4 000574   200012 755100                    STA     SIGN,,AUTO
         4 000575   000600 710000 4                  TRA     s:14564

      354    14563    5               ELSE SIGN = 1;

  14563  4 000576   000001 235007                    LDA     1,DL
         4 000577   200012 755100                    STA     SIGN,,AUTO

      355    14564    5               BLK$ = SUBND$ -> P$NODE.SUBLK$(1);

  14564  4 000600   100004 236100                    LDQ     4,,PR1
         4 000601   200016 756100                    STQ     BLK$,,AUTO

      356    14565    5               END;

      357    14566    4            CALL CHARBIN( DOLLAR, BLK$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );

  14566  4 000602   200016 473500                    LDP3    BLK$,,AUTO
         4 000603   300003 474500                    LDP4    3,,PR3
         4 000604   400004 236100                    LDQ     4,,PR4
         4 000605   000033 772000                    QRL     27
         4 000606   000000 622006                    EAX2    0,QL
         4 000607   000100 305540                    DTB
         4 000610   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         4 000611   200010 000004                    NDSC9   DOLLAR,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      358    14567    4            IF BLK$ -> P$NODE.SUBNODES = 1 THEN
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:56   

  14567  4 000612   300001 223100                    LDX3    1,,PR3
         4 000613   000001 103003                    CMPX3   1,DU
         4 000614   000617 601000 4                  TNZ     s:14570

      359    14568    4               CENTS = 0;

  14568  4 000615   200011 450100                    STZ     CENTS,,AUTO
         4 000616   000643 710000 4                  TRA     s:14578

      360    14569    5            ELSE DO;

      361    14570    5               IF BLK$->P$NODE.SUBLK$(1)->OUT$SYM.COUNT = 1

  14570  4 000617   300004 475500                    LDP5    4,,PR3
         4 000620   500004 236100                    LDQ     4,,PR5
         4 000621   777000 376003                    ANQ     -512,DU
         4 000622   001000 116003                    CMPQ    512,DU
         4 000623   000636 601000 4                  TNZ     s:14576

      362    14571    6               THEN DO;

      363    14572    6                  CALL CHARBIN( CENTS, BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT);

  14572  4 000624   500004 236100                    LDQ     4,,PR5
         4 000625   000033 772000                    QRL     27
         4 000626   000000 624006                    EAX4    0,QL
         4 000627   000100 305540                    DTB
         4 000630   500004 230014                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X4
         4 000631   200011 000004                    NDSC9   CENTS,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      364    14573    6                  CENTS = CENTS * 10;

  14573  4 000632   200011 236100                    LDQ     CENTS,,AUTO
         4 000633   000012 402007                    MPY     10,DL
         4 000634   200011 756100                    STQ     CENTS,,AUTO

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:57   
      365    14574    6                  END;

  14574  4 000635   000643 710000 4                  TRA     s:14578

      366    14575    5               ELSE
      367    14576    5                 CALL CHARBIN( CENTS, SUBSTR(BLK$->P$NODE.SUBLK$(1)->OUT$SYM.TEXT,0,2)
             14576                           );

  14576  4 000636   500004 236100                    LDQ     4,,PR5
         4 000637   000033 772000                    QRL     27
         4 000640   000100 305500                    DTB
         4 000641   500004 230002                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=2
         4 000642   200011 000004                    NDSC9   CENTS,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      368    14577    5               END;

      369    14578    4            UBIN_VAL = DOLLAR * 10000 + CENTS * 100 ;

  14578  4 000643   200010 236100                    LDQ     DOLLAR,,AUTO
         4 000644   000144 402007                    MPY     100,DL
         4 000645   200011 036100                    ADLQ    CENTS,,AUTO
         4 000646   000144 402007                    MPY     100,DL
         4 000647   200007 756100                    STQ     UBIN_VAL,,AUTO

      370    14579    5            IF UBIN_VAL > 34359738300 THEN DO;

  14579  4 000650   000006 116000 5                  CMPQ    6
         4 000651   000667 602000 4                  TNC     s:14624

      371    14580    6               IF SIGN = -1 THEN DO;

  14580  4 000652   200012 235100                    LDA     SIGN,,AUTO
         4 000653   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000654   000662 601000 4                  TNZ     s:14618

      372    14581        /*   ERROR: ASC-E$ACCUM_TOO_SMALL-C
      373    14582             MESSAGE: Acharges too small.
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:58   
      374    14583             MESSAGE1: Acharges cannot be less than -3435973.83.
      375    14584        */
      376    14585                       %SCREAM( ERR#=E$ACCUM_TOO_SMALL, LEVEL=ERROR, MID='C' );

  14597  4 000655   000014 630400 5                  EPPR0   12
         4 000656   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000657   000000 701000 xent               TSX1    ASH$ERROR
         4 000660   000000 011000                    NOP     0

      377    14600    6                  END;

  14600  4 000661   000666 710000 4                  TRA     s:14622

      378    14601    6               ELSE DO;

      379    14602        /*   ERROR: ASC-E$ACCUM_TOO_BIG-C
      380    14603             MESSAGE: Acharges too large.
      381    14604             MESSAGE1: Acharges cannot be greater than 3435973.83.
      382    14605        */
      383    14606                       %SCREAM( ERR#=E$ACCUM_TOO_BIG, LEVEL=ERROR, MID='C' );

  14618  4 000662   000015 630400 5                  EPPR0   13
         4 000663   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000664   000000 701000 xent               TSX1    ASH$ERROR
         4 000665   000000 011000                    NOP     0

      384    14621    6                  END;

      385    14622    5               GOTO CM_LOOP;

  14622  4 000666   000005 710000 4                  TRA     CM_LOOP

      386    14623    5               END;
      387    14624    4            VAL = SIGN * UBIN_VAL;

  14624  4 000667   200012 402100                    MPY     SIGN,,AUTO
         4 000670   200006 756100                    STQ     VAL,,AUTO
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:59   

      388    14625    4            DELTA = VAL - AS_PROJECT.BUDGET.PACCUM;

  14625  4 000671   000011 136000 xsym               SBLQ    AS_PROJECT+9
         4 000672   200005 756100                    STQ     DELTA,,AUTO

      389    14626    4            AS_PROJECT.BUDGET.PACCUM = VAL;

  14626  4 000673   200006 235100                    LDA     VAL,,AUTO
         4 000674   000011 755000 xsym               STA     AS_PROJECT+9

      390    14627    4            AS_USERS = AS_PROJECT;

  14627  4 000675   000000 100400                    MLR     fill='000'O
         4 000676   000000 004020 xsym               ADSC9   AS_PROJECT               cn=0,n=2064
         4 000677   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064

      391    14628    5            DO WHILE(AS_USERS.BUDGET.PCHARGES AND AS_USERS.BUDGET.MACCT ~= AS_NONE);

  14628  4 000700   000722 710000 4                  TRA     s:14634

      392    14629    5               USERS_KEY = AS_USERS.BUDGET.MACCT;

  14629  4 000701   000000 100400                    MLR     fill='000'O
         4 000702   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 000703   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      393    14630    5               CALL ASB$ENQ_USERS ALTRET(ENQ_ERR);

  14630  4 000704   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000705   000000 701000 xent               TSX1    ASB$ENQ_USERS
         4 000706   000737 702000 4                  TSX2    ENQ_ERR

      394    14631    5               CALL ASB$READ_USERS( AS_USERS ) ALTRET(READ_ERR);

  14631  4 000707   000016 630400 5                  EPPR0   14
         4 000710   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:60   
         4 000711   000000 701000 xent               TSX1    ASB$READ_USERS
         4 000712   000732 702000 4                  TSX2    READ_ERR

      395    14632    5               AS_USERS.BUDGET.PACCUM = AS_USERS.BUDGET.PACCUM + DELTA;

  14632  4 000713   000011 236000 xsym               LDQ     AS_USERS+9
         4 000714   200005 036100                    ADLQ    DELTA,,AUTO
         4 000715   000011 756000 xsym               STQ     AS_USERS+9

      396    14633    5               CALL ASB$WRITE_USERS( AS_USERS );

  14633  4 000716   000016 630400 5                  EPPR0   14
         4 000717   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000720   000000 701000 xent               TSX1    ASB$WRITE_USERS
         4 000721   000000 011000                    NOP     0

      397    14634    5               END;

  14634  4 000722   000017 236000 xsym               LDQ     AS_USERS+15
         4 000723   000100 316003                    CANQ    64,DU
         4 000724   000731 600000 4                  TZE     s:14635
         4 000725   000000 106400                    CMPC    fill='000'O
         4 000726   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         4 000727   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         4 000730   000701 601000 4                  TNZ     s:14629

      398    14635    5            DO WHILE( '0'B );

  14635  4 000731   000736 710000 4                  TRA     s:14639

      399    14636    5   READ_ERR:
      400    14637    5               CALL ASA$ERROR( USERS_KEY, 307 /* UNABLE TO READ :USERS */ );

  14637  4 000732   000020 630400 5     READ_ERR     EPPR0   16
         4 000733   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000734   000000 701000 xent               TSX1    ASA$ERROR
         4 000735   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:61   

      401    14638    5               END;

      402    14639    5            DO WHILE( '0'B );

  14639  4 000736   001467 710000 4                  TRA     s:14983

      403    14640    5   ENQ_ERR:
      404    14641    5               CALL ASH$ERROR( ERR_CODE );

  14641  4 000737   000022 630400 5     ENQ_ERR      EPPR0   18
         4 000740   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000741   000000 701000 xent               TSX1    ASH$ERROR
         4 000742   000000 011000                    NOP     0

      405    14642    5               END;

  14642  4 000743   001467 710000 4                  TRA     s:14983

      406    14643                                                              /**/
      407    14644    4            SELECT( 3 /* PROJ_ACCTS_VAL */ );

      408    14645    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );

  14645  4 000744   100003 473500                    LDP3    3,,PR1
         4 000745   300004 236100                    LDQ     4,,PR3
         4 000746   000033 772000                    QRL     27
         4 000747   000000 621006                    EAX1    0,QL
         4 000750   000100 305540                    DTB
         4 000751   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 000752   200006 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      409    14646    4            IF CR_MOD_FLG  AND  VAL < AS_PROJECT_DFLT.BUDGET.PROJ_CREATED

  14646  4 000753   000000 234000 xsym               SZN     CR_MOD_FLG
         4 000754   001000 605000 4                  TPL     s:14702
         4 000755   200006 236100                    LDQ     VAL,,AUTO
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:62   
         4 000756   000011 116000 xsym               CMPQ    AS_PROJECT_DFLT+9
         4 000757   001000 605000 4                  TPL     s:14702

      410    14647    5            THEN DO;

      411    14648        /*E* ERROR: ASA-E$P_ACCTS_TOO_SMALL-C
      412    14649        MESSAGE: ACCOUNTS cannot be set less than the number of accounts already
      413    14650                 accumulated by this project.  Setting ACCOUNTS to %U1.
      414    14651        MESSAGE1: %U1 accounts have already been accumulated by this project.
      415    14652                  You cannot set ACCOUNTS to a value which is less than the number of
      416    14653                  accounts already accumulated by the project.  ACCOUNTS is set to %U1.
      417    14654        */
      418    14655    5               VAL = AS_PROJECT_DFLT.BUDGET.PROJ_CREATED;

  14655  4 000760   000011 235000 xsym               LDA     AS_PROJECT_DFLT+9
         4 000761   200006 755100                    STA     VAL,,AUTO

      419    14656                    %NUMBER( NUM1=VAL );
             14664    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );

  14664  4 000762   200006 633500                    EPPR3   VAL,,AUTO
         4 000763   200043 453500                    STP3    PROJ_HEADER+15,,AUTO
         4 000764   000023 236000 5                  LDQ     19
         4 000765   200042 756100                    STQ     PROJ_HEADER+14,,AUTO
         4 000766   000024 237000 5                  LDAQ    20
         4 000767   200040 757100                    STAQ    PROJ_HEADER+12,,AUTO
         4 000770   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 000771   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000772   000000 701000 xent               TSX1    ASB$BINCHAR
         4 000773   000000 011000                    NOP     0

      420    14686                    %SCREAM( ERR#=E$P_ACCTS_TOO_SMALL, MID='A', LEVEL=ERROR );

  14698  4 000774   000026 630400 5                  EPPR0   22
         4 000775   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000776   000000 701000 xent               TSX1    ASH$ERROR
         4 000777   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:63   

      421    14701    5               END;

      422    14702    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  14702  4 001000   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 001001   001104 604400 4                  TMOZ    s:14768

      423    14703    5               IF AS_PROJECT_DFLT.BUDGET.PMAXC > 0 THEN

  14703  4 001002   000010 236000 xsym               LDQ     AS_PROJECT_DFLT+8
         4 001003   001010 604400 4                  TMOZ    s:14706

      424    14704    5                  DELTA = VAL - AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED;

  14704  4 001004   200006 236100                    LDQ     VAL,,AUTO
         4 001005   000010 136000 xsym               SBLQ    AS_PROJECT_DFLT+8
         4 001006   200005 756100                    STQ     DELTA,,AUTO
         4 001007   001012 710000 4                  TRA     s:14707

      425    14705    5               ELSE
      426    14706    5                  DELTA = VAL;

  14706  4 001010   200006 235100                    LDA     VAL,,AUTO
         4 001011   200005 755100                    STA     DELTA,,AUTO

      427    14707    5               IF AS_DEFAULT.BUDGET.PROJ_CREATED + DELTA > AS_DEFAULT.BUDGET.
             14707                        PROJ_ALLOWED

  14707  4 001012   000011 236000 xsym               LDQ     AS_DEFAULT+9
         4 001013   200005 036100                    ADLQ    DELTA,,AUTO
         4 001014   000010 116000 xsym               CMPQ    AS_DEFAULT+8
         4 001015   001101 604400 4                  TMOZ    s:14766

      428    14708    6               THEN DO;

      429    14709        /*E* ERROR: ASA-E$TOO_MANY_P_ACCTS-C
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:64   
      430    14710        MESSAGE: Maximum number of accounts exceeded for project %U1.
      431    14711                 ACCOUNTS = %U2 is the most that can be specified.
      432    14712        */
      433    14713    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );

  14713  4 001016   000000 124400                    SCM     mask='000'O
         4 001017   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 001020   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001021   200021 000100                    ARG     J,,AUTO

      434    14714    6                  CALL CONCAT( AS_FIELD1.TEXT,

  14714  4 001022   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         4 001023   000033 772000                    QRL     27
         4 001024   777770 620006                    EAX0    -8,QL
         4 001025   200021 721100                    LXL1    J,,AUTO
         4 001026   040000 100440                    MLR     fill='040'O
         4 001027   000000 200011 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X1
         4 001030   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 001031   200021 236100                    LDQ     J,,AUTO
         4 001032   000050 116007                    CMPQ    40,DL
         4 001033   001050 605000 4                  TPL     s:14717
         4 001034   777727 622006                    EAX2    -41,QL
         4 001035   777777 662003                    ERX2    -1,DU
         4 001036   040046 100400                    MLR     fill='040'O
         4 001037   000027 000001 5                  ADSC9   23                       cn=0,n=1
         4 001040   000000 200012 xsym               ADSC9   AS_FIELD1,Q              cn=1,n=*X2
         4 001041   000047 116007                    CMPQ    39,DL
         4 001042   001050 605000 4                  TPL     s:14717
         4 001043   777730 623006                    EAX3    -40,QL
         4 001044   777777 663003                    ERX3    -1,DU
         4 001045   040046 100440                    MLR     fill='040'O
         4 001046   000002 200010 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=*X0
         4 001047   000000 400013 xsym               ADSC9   AS_FIELD1,Q              cn=2,n=*X3

      435    14715    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      436    14716    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:65   
      437    14717    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;

  14717  4 001050   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         4 001051   000033 772000                    QRL     27
         4 001052   200021 036100                    ADLQ    J,,AUTO
         4 001053   000007 136007                    SBLQ    7,DL
         4 001054   000033 736000                    QLS     27
         4 001055   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      438    14718    6                  DELTA = AS_DEFAULT.BUDGET.PROJ_ALLOWED - AS_DEFAULT.BUDGET.
             14718                           PROJ_CREATED + AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED;

  14718  4 001056   000010 236000 xsym               LDQ     AS_DEFAULT+8
         4 001057   000011 136000 xsym               SBLQ    AS_DEFAULT+9
         4 001060   000010 036000 xsym               ADLQ    AS_PROJECT_DFLT+8
         4 001061   200005 756100                    STQ     DELTA,,AUTO

      439    14719                       %NUMBER( NUM2=DELTA );
             14735    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, DELTA );

  14735  4 001062   200005 630500                    EPPR0   DELTA,,AUTO
         4 001063   200043 450500                    STP0    PROJ_HEADER+15,,AUTO
         4 001064   000031 236000 5                  LDQ     25
         4 001065   200042 756100                    STQ     PROJ_HEADER+14,,AUTO
         4 001066   000032 237000 5                  LDAQ    26
         4 001067   200040 757100                    STAQ    PROJ_HEADER+12,,AUTO
         4 001070   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 001071   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001072   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001073   000000 011000                    NOP     0

      440    14749                       %SCREAM( ERR#=E$TOO_MANY_P_ACCTS,MID='A',LEVEL=ERROR);

  14761  4 001074   000034 630400 5                  EPPR0   28
         4 001075   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001076   000000 701000 xent               TSX1    ASH$ERROR
         4 001077   000000 011000                    NOP     0
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:66   

      441    14764    6                  GOTO CM_LOOP;

  14764  4 001100   000005 710000 4                  TRA     CM_LOOP

      442    14765    6                  END;
      443    14766    5              AS_DEFAULT.BUDGET.PROJ_CREATED = AS_DEFAULT.BUDGET.PROJ_CREATED + DELTA;

  14766  4 001101   000011 236000 xsym               LDQ     AS_DEFAULT+9
         4 001102   200005 036100                    ADLQ    DELTA,,AUTO
         4 001103   000011 756000 xsym               STQ     AS_DEFAULT+9

      444    14767    5               END;

      445    14768    4            AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED = VAL;

  14768  4 001104   200006 235100                    LDA     VAL,,AUTO
         4 001105   000010 755000 xsym               STA     AS_PROJECT_DFLT+8
         4 001106   001467 710000 4                  TRA     s:14983

      446    14769                                                              /**/
      447    14770    4            SELECT( 4 /* PROJ_PACK_VAL */ );

      448    14771                                                      /*  Get packset name */
      449    14772    4            BLK$ = SUBND$ -> P$NODE.SUBLK$(0);

  14772  4 001107   100003 236100                    LDQ     3,,PR1
         4 001110   200016 756100                    STQ     BLK$,,AUTO

      450    14773    4            PACKSET.TXT = OUT$SYM.TEXT;

  14773  4 001111   200016 473500                    LDP3    BLK$,,AUTO
         4 001112   300004 236100                    LDQ     4,,PR3
         4 001113   000033 772000                    QRL     27
         4 001114   000000 621006                    EAX1    0,QL
         4 001115   040100 100540                    MLR     fill='040'O
         4 001116   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:67   
         4 001117   200022 200006                    ADSC9   PACKSET,,AUTO            cn=1,n=6

      451    14774    4            PACKSET.CNT = OUT$SYM.COUNT;

  14774  4 001120   300004 236100                    LDQ     4,,PR3
         4 001121   200022 552140                    STBQ    PACKSET,'40'O,AUTO

      452    14775                                                      /*  Process packset options */
      453    14776    4            CALL ASA$PACKSET_OPTS( CR_MOD_KEY, PACKSET );

  14776  4 001122   200022 634500                    EPPR4   PACKSET,,AUTO
         4 001123   200041 454500                    STP4    PROJ_HEADER+13,,AUTO
         4 001124   200003 236100                    LDQ     @CR_MOD_KEY,,AUTO
         4 001125   200040 756100                    STQ     PROJ_HEADER+12,,AUTO
         4 001126   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 001127   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001130   000000 701000 xent               TSX1    ASA$PACKSET_OPTS
         4 001131   000000 011000                    NOP     0

      454    14777    4            GOTO CM_LOOP;

  14777  4 001132   000005 710000 4                  TRA     CM_LOOP

      455    14778                                                              /**/
      456    14779    4            SELECT( 8 /* REMOVE PACKSET */ );

      457    14780                                                      /*  Get packset name */
      458    14781    4            BLK$ = SUBND$ -> P$NODE.SUBLK$(0);

  14781  4 001133   100003 236100                    LDQ     3,,PR1
         4 001134   200016 756100                    STQ     BLK$,,AUTO

      459    14782    4            PACKSET.TXT = OUT$SYM.TEXT;

  14782  4 001135   200016 473500                    LDP3    BLK$,,AUTO
         4 001136   300004 236100                    LDQ     4,,PR3
         4 001137   000033 772000                    QRL     27
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:68   
         4 001140   000000 621006                    EAX1    0,QL
         4 001141   040100 100540                    MLR     fill='040'O
         4 001142   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         4 001143   200022 200006                    ADSC9   PACKSET,,AUTO            cn=1,n=6

      460    14783    4            PACKSET.CNT = OUT$SYM.COUNT;

  14783  4 001144   300004 236100                    LDQ     4,,PR3
         4 001145   200022 552140                    STBQ    PACKSET,'40'O,AUTO

      461    14784                                                      /* See if :PROJ record exists */
      462    14785    4            PROJ_KEY.COUNT = PACKSET.CNT + 20;

  14785  4 001146   200022 236100                    LDQ     PACKSET,,AUTO
         4 001147   000033 772000                    QRL     27
         4 001150   000024 036007                    ADLQ    20,DL
         4 001151   000033 736000                    QLS     27
         4 001152   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      463    14786    4            CALL CONCAT( PROJ_KEY.TEXT, CR_MOD_KEY.TEXT, PACKSET.TXT );

  14786  4 001153   200003 474500                    LDP4    @CR_MOD_KEY,,AUTO
         4 001154   040000 100500                    MLR     fill='040'O
         4 001155   400000 200024                    ADSC9   0,,PR4                   cn=1,n=20
         4 001156   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20
         4 001157   040000 100500                    MLR     fill='040'O
         4 001160   200022 200006                    ADSC9   PACKSET,,AUTO            cn=1,n=6
         4 001161   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      464    14787    4            CALL ASB$PREC_PROJ ALTRET(PACK_NO_EXIST);

  14787  4 001162   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001163   000000 701000 xent               TSX1    ASB$PREC_PROJ
         4 001164   001166 702000 4                  TSX2    PACK_NO_EXIST

      465    14788    5            DO WHILE( '0'B );

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:69   
  14788  4 001165   001205 710000 4                  TRA     s:14812

      466    14789        /*E*  ERROR:  ASA-E$PACK_NO_EXIST_FOR_PROJ-C
      467    14790              MESSAGE: Packset DP#%U1 does not exist for project "%U2".
      468    14791        */
      469    14792    5   PACK_NO_EXIST: AS_FIELD1 = PACKSET;

  14792  4 001166   000000 100500       PACK_NO_EXI* MLR     fill='000'O
         4 001167   200022 000007                    ADSC9   PACKSET,,AUTO            cn=0,n=7
         4 001170   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      470    14793    5               CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );

  14793  4 001171   000035 236000 5                  LDQ     29
         4 001172   200003 235100                    LDA     @CR_MOD_KEY,,AUTO
         4 001173   200040 757100                    STAQ    PROJ_HEADER+12,,AUTO
         4 001174   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 001175   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001176   000000 701000 xent               TSX1    ASA$KEYCONV
         4 001177   000000 011000                    NOP     0

      471    14794                    %SCREAM(ERR#=E$PACK_NO_EXIST_FOR_PROJ,LEVEL=ERROR,MID='A');

  14806  4 001200   000036 630400 5                  EPPR0   30
         4 001201   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001202   000000 701000 xent               TSX1    ASH$ERROR
         4 001203   000000 011000                    NOP     0

      472    14809    5               GOTO CM_LOOP;

  14809  4 001204   000005 710000 4                  TRA     CM_LOOP

      473    14810    5               END;

      474    14811                                                          /* Read the :PROJ record */
      475    14812    4            I = SIZEC(PROJ_HEADER);

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:70   
  14812  4 001205   000060 235007                    LDA     48,DL
         4 001206   200020 755100                    STA     I,,AUTO

      476    14813    4            CALL ASB$READ_PROJ( ADDR(PROJ_HEADER), I ) ALTRET(PROJ_READ_ERR);

  14813  4 001207   200024 630500                    EPPR0   PROJ_HEADER,,AUTO
         4 001210   200040 450500                    STP0    PROJ_HEADER+12,,AUTO
         4 001211   200020 631500                    EPPR1   I,,AUTO
         4 001212   200043 451500                    STP1    PROJ_HEADER+15,,AUTO
         4 001213   200040 633500                    EPPR3   PROJ_HEADER+12,,AUTO
         4 001214   200042 453500                    STP3    PROJ_HEADER+14,,AUTO
         4 001215   200042 630500                    EPPR0   PROJ_HEADER+14,,AUTO
         4 001216   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001217   000000 701000 xent               TSX1    ASB$READ_PROJ
         4 001220   001222 702000 4                  TSX2    PROJ_READ_ERR

      477    14814    5            DO WHILE( '0'B );

  14814  4 001221   001227 710000 4                  TRA     s:14818

      478    14815    5   PROJ_READ_ERR: CALL ASH$ERROR( ERR_CODE );

  14815  4 001222   000022 630400 5     PROJ_READ_E* EPPR0   18
         4 001223   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001224   000000 701000 xent               TSX1    ASH$ERROR
         4 001225   000000 011000                    NOP     0

      479    14816    5               GOTO CM_LOOP;

  14816  4 001226   000005 710000 4                  TRA     CM_LOOP

      480    14817    5               END;

      481    14818    5            IF PROJ_HEADER.NUM_ACCTS > 0 THEN DO;

  14818  4 001227   200037 235100                    LDA     PROJ_HEADER+11,,AUTO
         4 001230   001250 604400 4                  TMOZ    s:14843
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:71   

      482    14819        /*E*  ERROR:  ASA-E$ACCTS_STILL_ON_PACK-C
      483    14820              MESSAGE: Accounts still exist on packset DP#%U1.
      484    14821              MESSAGE1: Packset DP#%U1 cannot be removed while there are still
      485    14822                        accounts on it for project "%U2".
      486    14823        */
      487    14824    5               AS_FIELD1 = PACKSET;

  14824  4 001231   000000 100500                    MLR     fill='000'O
         4 001232   200022 000007                    ADSC9   PACKSET,,AUTO            cn=0,n=7
         4 001233   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      488    14825    5               CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );

  14825  4 001234   000035 236000 5                  LDQ     29
         4 001235   200003 235100                    LDA     @CR_MOD_KEY,,AUTO
         4 001236   200040 757100                    STAQ    PROJ_HEADER+12,,AUTO
         4 001237   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 001240   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001241   000000 701000 xent               TSX1    ASA$KEYCONV
         4 001242   000000 011000                    NOP     0

      489    14826                    %SCREAM( ERR#=E$ACCTS_STILL_ON_PACK,LEVEL=ERROR,MID='A' );

  14838  4 001243   000037 630400 5                  EPPR0   31
         4 001244   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001245   000000 701000 xent               TSX1    ASH$ERROR
         4 001246   000000 011000                    NOP     0

      490    14841    5               GOTO CM_LOOP;

  14841  4 001247   000005 710000 4                  TRA     CM_LOOP

      491    14842    5               END;
      492    14843    5            IF PROJ_HEADER.SUB_PROJ_ACCTS > 0 THEN DO;

  14843  4 001250   200031 720100                    LXL0    PROJ_HEADER+5,,AUTO
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:72   
         4 001251   001265 600000 4                  TZE     s:14854

      493    14844        /*E*  ERROR:  ASA-E$STILL_SUB_PROJS_ON_PACK-C
      494    14845              MESSAGE: Sub-projects accounts are still allocated on DP#%U1.
      495    14846              MESSAGE1: Packset DP#%U1 cannot removed while accounts are still
      496    14847                        allocated for sub-projects of project "%U2".
      497    14848        */
      498    14849    5               AS_FIELD1 = PACKSET;

  14849  4 001252   000000 100500                    MLR     fill='000'O
         4 001253   200022 000007                    ADSC9   PACKSET,,AUTO            cn=0,n=7
         4 001254   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      499    14850    5               CALL ASA$KEYCONV( CR_MOD_KEY, AS_FIELD2 );

  14850  4 001255   000035 236000 5                  LDQ     29
         4 001256   200003 235100                    LDA     @CR_MOD_KEY,,AUTO
         4 001257   200040 757100                    STAQ    PROJ_HEADER+12,,AUTO
         4 001260   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 001261   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001262   000000 701000 xent               TSX1    ASA$KEYCONV
         4 001263   000000 011000                    NOP     0

      500    14851    5               GOTO CM_LOOP;

  14851  4 001264   000005 710000 4                  TRA     CM_LOOP

      501    14852    5               END;
      502    14853                                                          /* Delete the :PROJ record */
      503    14854    4            CALL ASB$DELREC_PROJ;

  14854  4 001265   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001266   000000 701000 xent               TSX1    ASB$DELREC_PROJ
         4 001267   000000 011000                    NOP     0
         4 001270   001467 710000 4                  TRA     s:14983

      504    14855
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:73   
      505    14856    4            SELECT( 6 /* PROJ_PROJ_OPT_VAL */ );

      506    14857    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );

  14857  4 001271   100003 473500                    LDP3    3,,PR1
         4 001272   300004 236100                    LDQ     4,,PR3
         4 001273   000033 772000                    QRL     27
         4 001274   000000 621006                    EAX1    0,QL
         4 001275   000100 305540                    DTB
         4 001276   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 001277   200006 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      507    14858    4            IF CR_MOD_FLG  AND  VAL < AS_PROJECT_DFLT.BUDGET.SUB_PROJS

  14858  4 001300   000000 234000 xsym               SZN     CR_MOD_FLG
         4 001301   001326 605000 4                  TPL     s:14915
         4 001302   000017 236000 xsym               LDQ     AS_PROJECT_DFLT+15
         4 001303   000022 736000                    QLS     18
         4 001304   000022 732000                    QRS     18
         4 001305   200006 116100                    CMPQ    VAL,,AUTO
         4 001306   001326 604400 4                  TMOZ    s:14915

      508    14859    5            THEN DO;

      509    14860        /*E* ERROR: ASA-E$P_PROJ_TOO_SMALL-C
      510    14861        MESSAGE: PROJECTS cannot be set less than the number of projects already
      511    14862                 accumulated by this project.  Setting PROJECTS to %U1.
      512    14863        MESSAGE1: %U1 sub-projects have already been accumulated by this project.
      513    14864                  You cannot set PROJECTS to a value which is less than the number of
      514    14865                  sub-projects already accumulated by the project.
      515    14866                  PROJECTS is set to %U1.
      516    14867        */
      517    14868    5               VAL = AS_PROJECT_DFLT.BUDGET.SUB_PROJS;

  14868  4 001307   200006 756100                    STQ     VAL,,AUTO

      518    14869                    %NUMBER( NUM1=VAL );
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:74   
             14877    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );

  14877  4 001310   200006 633500                    EPPR3   VAL,,AUTO
         4 001311   200043 453500                    STP3    PROJ_HEADER+15,,AUTO
         4 001312   000023 236000 5                  LDQ     19
         4 001313   200042 756100                    STQ     PROJ_HEADER+14,,AUTO
         4 001314   000024 237000 5                  LDAQ    20
         4 001315   200040 757100                    STAQ    PROJ_HEADER+12,,AUTO
         4 001316   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 001317   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001320   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001321   000000 011000                    NOP     0

      519    14899                    %SCREAM( ERR#=E$P_PROJ_TOO_SMALL, MID='A', LEVEL=ERROR );

  14911  4 001322   000040 630400 5                  EPPR0   32
         4 001323   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001324   000000 701000 xent               TSX1    ASH$ERROR
         4 001325   000000 011000                    NOP     0

      520    14914    5               END;

      521    14915    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  14915  4 001326   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         4 001327   001465 604400 4                  TMOZ    s:14981

      522    14916    5               IF AS_PROJECT.BUDGET.MAX_PROJECTS > 0 THEN

  14916  4 001330   000017 720000 xsym               LXL0    AS_PROJECT+15
         4 001331   001342 604400 4                  TMOZ    s:14919

      523    14917    5                  DELTA = VAL - AS_PROJECT.BUDGET.MAX_PROJECTS;

  14917  4 001332   000017 236000 xsym               LDQ     AS_PROJECT+15
         4 001333   000022 736000                    QLS     18
         4 001334   000022 732000                    QRS     18
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:75   
         4 001335   200040 756100                    STQ     PROJ_HEADER+12,,AUTO
         4 001336   200006 236100                    LDQ     VAL,,AUTO
         4 001337   200040 136100                    SBLQ    PROJ_HEADER+12,,AUTO
         4 001340   200005 756100                    STQ     DELTA,,AUTO
         4 001341   001344 710000 4                  TRA     s:14920

      524    14918    5               ELSE
      525    14919    5                  DELTA = VAL;

  14919  4 001342   200006 236100                    LDQ     VAL,,AUTO
         4 001343   200005 756100                    STQ     DELTA,,AUTO

      526    14920    5               IF AS_DEFAULT.BUDGET.SUB_PROJS + DELTA > AS_PROJ_ADMIN.BUDGET.
             14920                        MAX_PROJECTS

  14920  4 001344   000017 236000 xsym               LDQ     AS_DEFAULT+15
         4 001345   000022 736000                    QLS     18
         4 001346   000022 732000                    QRS     18
         4 001347   200005 036100                    ADLQ    DELTA,,AUTO
         4 001350   200040 756100                    STQ     PROJ_HEADER+12,,AUTO
         4 001351   000017 236000 xsym               LDQ     AS_PROJ_ADMIN+15
         4 001352   000022 736000                    QLS     18
         4 001353   000022 732000                    QRS     18
         4 001354   200041 756100                    STQ     PROJ_HEADER+13,,AUTO
         4 001355   200040 236100                    LDQ     PROJ_HEADER+12,,AUTO
         4 001356   200041 116100                    CMPQ    PROJ_HEADER+13,,AUTO
         4 001357   001457 604400 4                  TMOZ    s:14979

      527    14921    6               THEN DO;

      528    14922        /*E* ERROR: ASA-E$TOO_MANY_P_PROJS-C
      529    14923        MESSAGE: Maximum number of projects exceeded for project %U1.
      530    14924                 PROJECTS = %U2 is the most that can be specified.
      531    14925        */
      532    14926    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );

  14926  4 001360   000000 124400                    SCM     mask='000'O
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:76   
         4 001361   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         4 001362   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 001363   200021 000100                    ARG     J,,AUTO

      533    14927    6                  CALL CONCAT( AS_FIELD1.TEXT,

  14927  4 001364   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         4 001365   000033 772000                    QRL     27
         4 001366   777770 621006                    EAX1    -8,QL
         4 001367   200021 722100                    LXL2    J,,AUTO
         4 001370   040000 100440                    MLR     fill='040'O
         4 001371   000000 200012 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X2
         4 001372   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 001373   200021 236100                    LDQ     J,,AUTO
         4 001374   000050 116007                    CMPQ    40,DL
         4 001375   001412 605000 4                  TPL     s:14930
         4 001376   777727 623006                    EAX3    -41,QL
         4 001377   777777 663003                    ERX3    -1,DU
         4 001400   040046 100400                    MLR     fill='040'O
         4 001401   000027 000001 5                  ADSC9   23                       cn=0,n=1
         4 001402   000000 200013 xsym               ADSC9   AS_FIELD1,Q              cn=1,n=*X3
         4 001403   000047 116007                    CMPQ    39,DL
         4 001404   001412 605000 4                  TPL     s:14930
         4 001405   777730 624006                    EAX4    -40,QL
         4 001406   777777 664003                    ERX4    -1,DU
         4 001407   040046 100440                    MLR     fill='040'O
         4 001410   000002 200011 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=*X1
         4 001411   000000 400014 xsym               ADSC9   AS_FIELD1,Q              cn=2,n=*X4

      534    14928    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      535    14929    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
      536    14930    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;

  14930  4 001412   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         4 001413   000033 772000                    QRL     27
         4 001414   200021 036100                    ADLQ    J,,AUTO
         4 001415   000007 136007                    SBLQ    7,DL
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:77   
         4 001416   000033 736000                    QLS     27
         4 001417   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      537    14931    6                  DELTA = AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS - AS_DEFAULT.BUDGET.
             14931                           SUB_PROJS + AS_PROJECT.BUDGET.MAX_PROJECTS;

  14931  4 001420   000017 236000 xsym               LDQ     AS_DEFAULT+15
         4 001421   000022 736000                    QLS     18
         4 001422   000022 732000                    QRS     18
         4 001423   200040 756100                    STQ     PROJ_HEADER+12,,AUTO
         4 001424   000017 236000 xsym               LDQ     AS_PROJ_ADMIN+15
         4 001425   000022 736000                    QLS     18
         4 001426   000022 732000                    QRS     18
         4 001427   200040 136100                    SBLQ    PROJ_HEADER+12,,AUTO
         4 001430   200041 756100                    STQ     PROJ_HEADER+13,,AUTO
         4 001431   000017 236000 xsym               LDQ     AS_PROJECT+15
         4 001432   000022 736000                    QLS     18
         4 001433   000022 732000                    QRS     18
         4 001434   200042 756100                    STQ     PROJ_HEADER+14,,AUTO
         4 001435   200041 236100                    LDQ     PROJ_HEADER+13,,AUTO
         4 001436   200042 036100                    ADLQ    PROJ_HEADER+14,,AUTO
         4 001437   200005 756100                    STQ     DELTA,,AUTO

      538    14932                       %NUMBER( NUM2=DELTA );
             14948    6         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, DELTA );

  14948  4 001440   200005 630500                    EPPR0   DELTA,,AUTO
         4 001441   200043 450500                    STP0    PROJ_HEADER+15,,AUTO
         4 001442   000031 236000 5                  LDQ     25
         4 001443   200042 756100                    STQ     PROJ_HEADER+14,,AUTO
         4 001444   000032 237000 5                  LDAQ    26
         4 001445   200040 757100                    STAQ    PROJ_HEADER+12,,AUTO
         4 001446   200040 630500                    EPPR0   PROJ_HEADER+12,,AUTO
         4 001447   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001450   000000 701000 xent               TSX1    ASB$BINCHAR
         4 001451   000000 011000                    NOP     0

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:78   
      539    14962                       %SCREAM( ERR#=E$TOO_MANY_P_PROJS,MID='A',LEVEL=ERROR);

  14974  4 001452   000041 630400 5                  EPPR0   33
         4 001453   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001454   000000 701000 xent               TSX1    ASH$ERROR
         4 001455   000000 011000                    NOP     0

      540    14977    6                  GOTO CM_LOOP;

  14977  4 001456   000005 710000 4                  TRA     CM_LOOP

      541    14978    6                  END;
      542    14979    5               AS_DEFAULT.BUDGET.SUB_PROJS = AS_DEFAULT.BUDGET.SUB_PROJS + DELTA;

  14979  4 001457   000017 236000 xsym               LDQ     AS_DEFAULT+15
         4 001460   000022 736000                    QLS     18
         4 001461   000022 732000                    QRS     18
         4 001462   200005 036100                    ADLQ    DELTA,,AUTO
         4 001463   000000 621006                    EAX1    0,QL
         4 001464   000017 441000 xsym               SXL1    AS_DEFAULT+15

      543    14980    5               END;

      544    14981    4            AS_PROJECT.BUDGET.MAX_PROJECTS = VAL;

  14981  4 001465   200006 720100                    LXL0    VAL,,AUTO
         4 001466   000017 440000 xsym               SXL0    AS_PROJECT+15

      545    14982    4            END;          /* Do case(code); */

      546    14983    3         END;            /* Do i = 0 to SUBNODES-1; */

  14983  4 001467   200020 054100                    AOS     I,,AUTO
         4 001470   200020 236100                    LDQ     I,,AUTO
         4 001471   200014 116100                    CMPQ    SUBNODES,,AUTO
         4 001472   000051 604000 4                  TMI     s:14260

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:79   
      547    14984    2      END;                /* Do while(more); */

  14984  4 001473   000000 234000 2                  SZN     MORE
         4 001474   000007 604000 4                  TMI     s:14244

  14948  4 001475                       OPTION_ERR   null
      548    14985    1   OPTION_ERR: ;
      549    14986    1   CALL ASH$ERROR( P_PCB.ERROR );

  14986  4 001475   000042 630400 5                  EPPR0   34
         4 001476   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001477   000000 701000 xent               TSX1    ASH$ERROR
         4 001500   000000 011000                    NOP     0

      550    14987    1   GOTO CM_LOOP;

  14987  4 001501   000005 710000 4                  TRA     CM_LOOP
      551    14988                                                              /**/
      552    14989
      553    14990    1   END ASA$PROJECT ;
      554    14991        %EOD;

PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:80   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$PROJECT.
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:81   

 **** Variables and constants ****

  ****  Section 002  Data  ASA$PROJECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 MORE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CR_MOD_KEY                4-0-0/w SBIN        r     1 ARS
    16-0-0/w PTR         r     1 BLK$                      11-0-0/w SBIN        r     1 CENTS
    *0-0-0/w STRC(189)   r     1 CR_MOD_KEY                 5-0-0/w SBIN        r     1 DELTA
    10-0-0/w SBIN        r     1 DOLLAR                    20-0-0/w SBIN        r     1 I
    21-0-0/w SBIN        r     1 J                         22-0-0/c STRC(63)    r     1 PACKSET
    24-0-0/w STRC(432)   r     1 PROJ_HEADER               12-0-0/w SBIN        r     1 SIGN
    17-0-0/w PTR         r     1 STR$                      15-0-0/w PTR         r     1 SUBND$
    14-0-0/w SBIN        r     1 SUBNODES                   7-0-0/w UBIN        r     1 UBIN_VAL
     6-0-0/w SBIN        r     1 VAL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ
     0-0-0/w STRC(18576) r     1 AS_DEFAULT                 0-0-0/w STRC(6084)  r     1 AS_DEFAULT_DREC
     0-0-0/w STRC(18576) r     1 AS_DFLT                    0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2                  0-0-0/c STRC(189)   r     1 AS_NONE
     0-0-0/w STRC(18576) r     1 AS_PROJECT                 0-0-0/c STRC(189)   r     1 AS_PROJECT_ADMIN
     0-0-0/w STRC(18576) r     1 AS_PROJECT_DFLT            0-0-0/w STRC(6084)  r     1 AS_PROJECT_DFLT_DREC
     0-0-0/w STRC(6084)  r     1 AS_PROJECT_DREC            0-0-0/w STRC(18576) r     1 AS_PROJ_ADMIN
     0-0-0/w STRC(6084)  r     1 AS_PROJ_ADMIN_DREC         0-0-0/b BIT         r     1 AS_TRUE
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:82   
     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/w UBIN        r     1 CODE
     0-0-0/b BIT         r     1 CR_MOD_FLG                 0-0-0/w SBIN        r     1 CR_MOD_PROJ_OPTS
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c CHAR(255)   r     1 IN_BUF
     0-0-0/w STRC(6084)  r     1 KL_DFLT                    0-0-0/w STRC(6084)  r     1 KL_DREC
     0-0-0/w PTR         r     1 NODE$                      0-0-0/c STRC(243)   r     1 PROJ_KEY
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/d REMB        r     1 REMEM_VAR
     0-0-0/b BIT         r     1 SUPERAUTH                  0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(144)   r     1 P$NODE
     0-0-0/w ASTR(9)     r     1 VARY$STR


   Procedure ASA$PROJECT requires 834 words for executable code.
   Procedure ASA$PROJECT requires 36 words of local(AUTO) storage.
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:84   
          MINI XREF LISTING

ARS
     14185**DCL     14249<>CALL    14250>>ASSIGN
ASA$ERROR
     14176**DCL-ENT 14637--CALL
ASA$KEYCONV
     14158**DCL-ENT 14793--CALL    14825--CALL    14850--CALL
ASA$PACKSET_OPTS
     14164**DCL-ENT 14776--CALL
ASA_BRKS_LOC
      9953**DCL      9953--REDEF
ASB$BINCHAR
      3182**DCL-ENT 14664--CALL    14735--CALL    14877--CALL    14948--CALL
ASB$DELREC_PROJ
     14155**DCL-ENT 14854--CALL
ASB$ENQ_USERS
     14167**DCL-ENT 14630--CALL
ASB$PREC_PROJ
     14152**DCL-ENT 14787--CALL
ASB$READ_PROJ
     14149**DCL-ENT 14273--CALL    14279--CALL    14813--CALL
ASB$READ_SI
     14122**DCL-ENT 14249--CALL
ASB$READ_USERS
     14170**DCL-ENT 14631--CALL
ASB$SET_PROMPT
     14125**DCL-ENT 14247--CALL
ASB$WRITE_USERS
     14173**DCL-ENT 14633--CALL
ASC$CM_OPTS
     14131**DCL-ENT 14351--CALL    14365--CALL
ASH$DQUEST
     14137**DCL-ENT 14336--CALL
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:85   
ASH$ERROR
     14143**DCL-ENT 14304--CALL    14327--CALL    14426--CALL    14447--CALL    14471--CALL    14501--CALL
     14551--CALL    14597--CALL    14618--CALL    14641--CALL    14698--CALL    14761--CALL    14806--CALL
     14815--CALL    14838--CALL    14911--CALL    14974--CALL    14986--CALL
ASH$HELP
     14134**DCL-ENT 14333--CALL
ASH$QUEST
     14140**DCL-ENT 14339--CALL
AS_BLANK
      9813**DCL     14270>>CALLBLT 14276>>CALLBLT 14713>>CALLBLT 14926>>CALLBLT
AS_CR_MOD_PROJ
      9961**DCL     14344>>IF      14346<<ASSIGN  14350<<ASSIGN  14358>>IF      14360<<ASSIGN  14364<<ASSIGN
     14702>>IF      14915>>IF
AS_DEFAULT
     10531**DCL     14361>>ASSIGN
AS_DEFAULT.BANNER_PERM
     10646**DCL     10647--REDEF
AS_DEFAULT.BUDGET.MACCT
     10551**DCL     10555--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10564**DCL     10567--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10547**DCL     10549--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10542**DCL     10544--REDEF
AS_DEFAULT.BUDGET.PROJ_ALLOWED
     10544**DCL     14707>>IF      14718>>ASSIGN
AS_DEFAULT.BUDGET.PROJ_CREATED
     10549**DCL     14707>>IF      14718>>ASSIGN  14766<<ASSIGN  14766>>ASSIGN
AS_DEFAULT.BUDGET.SUB_PROJS
     10567**DCL     14920>>IF      14931>>ASSIGN  14979<<ASSIGN  14979>>ASSIGN
AS_DEFAULT.SETUP_CHRA.TXT
     10662**DCL     10663--REDEF   10664--REDEF
AS_DEFAULT_DREC
     11858**DCL     14362>>ASSIGN
AS_DEFAULT_DREC.PASSWORD
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:86   
     11916**DCL     11920--REDEF
AS_DEFAULT_DREC.RENAME
     11939**DCL     11940--REDEF
AS_DFLT
     10353**DCL     14347<<ASSIGN  14361<<ASSIGN
AS_DFLT.BANNER_PERM
     10468**DCL     10469--REDEF
AS_DFLT.BUDGET.MACCT
     10373**DCL     10377--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10386**DCL     10389--REDEF
AS_DFLT.BUDGET.PACCUM
     10369**DCL     10371--REDEF
AS_DFLT.BUDGET.PMAXC
     10364**DCL     10366--REDEF
AS_DFLT.SETUP_CHRA.TXT
     10484**DCL     10485--REDEF   10486--REDEF
AS_FE_MODE
      9819**DCL      9820--REDEF
AS_FIELD1
      9949**DCL     14792<<ASSIGN  14824<<ASSIGN  14849<<ASSIGN
AS_FIELD1.COUNT
      9950**DCL     14282<<ASSIGN  14717<<ASSIGN  14930<<ASSIGN
AS_FIELD1.TEXT
      9950**DCL     14283<<ASSIGN  14664<>CALL    14714<<CALLBLT 14877<>CALL    14927<<CALLBLT
AS_FIELD2
      9950**DCL     14793<>CALL    14825<>CALL    14850<>CALL
AS_FIELD2.TEXT
      9950**DCL     14735<>CALL    14948<>CALL
AS_MODE
      9816**DCL      9818--REDEF
AS_MOD_USER.ACCESS
     12681**DCL     12682--REDEF
AS_MOD_USER.BANNER
     12668**DCL     12669--REDEF
AS_MOD_USER.BANNER_PERM
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:87   
     12670**DCL     12671--REDEF
AS_MOD_USER.BILL
     12676**DCL     12677--REDEF
AS_MOD_USER.CPROC
     12672**DCL     12673--REDEF
AS_MOD_USER.FEBILL
     12752**DCL     12753--REDEF
AS_MOD_USER.FECXTMEM
     12769**DCL     12770--REDEF
AS_MOD_USER.FEMINTS
     12754**DCL     12755--REDEF
AS_MOD_USER.FEMMEM
     12765**DCL     12766--REDEF
AS_MOD_USER.FEMTIME
     12763**DCL     12764--REDEF
AS_MOD_USER.FEPPRIV
     12760**DCL     12762--REDEF
AS_MOD_USER.FEPRIV
     12757**DCL     12759--REDEF
AS_MOD_USER.FORCE_BIT
     12666**DCL     12667--REDEF
AS_MOD_USER.KEY
     12748**DCL     12750--REDEF
AS_MOD_USER.LASTCPROC
     12674**DCL     12675--REDEF
AS_MOD_USER.LIMITS.DO_
     12722**DCL     12723--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12738**DCL     12739--REDEF
AS_MOD_USER.LIMITS.LO
     12718**DCL     12719--REDEF
AS_MOD_USER.LIMITS.MEM
     12714**DCL     12715--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12742**DCL     12743--REDEF
AS_MOD_USER.LIMITS.PDIS
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:88   
     12730**DCL     12731--REDEF
AS_MOD_USER.LIMITS.PO
     12726**DCL     12727--REDEF
AS_MOD_USER.LIMITS.TDIS
     12734**DCL     12735--REDEF
AS_MOD_USER.LIMITS.TIME
     12710**DCL     12711--REDEF
AS_MOD_USER.MAXENQ
     12691**DCL     12692--REDEF
AS_MOD_USER.PERM_BIT
     12664**DCL     12665--REDEF
AS_MOD_USER.PPRIV
     12686**DCL     12688--REDEF
AS_MOD_USER.PRIOB
     12693**DCL     12694--REDEF
AS_MOD_USER.PRIV
     12683**DCL     12685--REDEF
AS_MOD_USER.QUAN
     12689**DCL     12690--REDEF
AS_MOD_USER.SETUP
     12662**DCL     12663--REDEF
AS_NONE
      9814**DCL     14628>>DOWHILE
AS_PROJECT
     10887**DCL     14342>>ASSIGN  14352<<ASSIGN  14627>>ASSIGN
AS_PROJECT.BANNER_PERM
     11002**DCL     11003--REDEF
AS_PROJECT.BUDGET.MACCT
     10907**DCL     10911--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10920**DCL     10923--REDEF   14916>>IF      14917>>ASSIGN  14931>>ASSIGN  14981<<ASSIGN
AS_PROJECT.BUDGET.PACCUM
     10903**DCL     10905--REDEF   14625>>ASSIGN  14626<<ASSIGN
AS_PROJECT.BUDGET.PMAXC
     10898**DCL     10900--REDEF   14381<<ASSIGN  14453>>IF      14477<<ASSIGN  14478>>IF      14479<<ASSIGN
     14481>>ASSIGN  14483<<ASSIGN
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:89   
AS_PROJECT.HPSN
     10952**DCL     14269>>ASSIGN  14270>>CALLBLT 14274>>IF      14284>>IF
AS_PROJECT.SETUP_CHRA.TXT
     11018**DCL     11019--REDEF   11020--REDEF
AS_PROJECT_ADMIN.COUNT
      9957**DCL     14714>>CALLBLT 14717>>ASSIGN  14927>>CALLBLT 14930>>ASSIGN
AS_PROJECT_ADMIN.TEXT
      9957**DCL     14713>>CALLBLT 14714>>CALLBLT 14714>>CALLBLT 14926>>CALLBLT 14927>>CALLBLT 14927>>CALLBLT
AS_PROJECT_DFLT
     11065**DCL     14356>>ASSIGN  14366<<ASSIGN
AS_PROJECT_DFLT.BANNER_PERM
     11180**DCL     11181--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11085**DCL     11089--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11098**DCL     11101--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11081**DCL     11083--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11076**DCL     11078--REDEF   14703>>IF
AS_PROJECT_DFLT.BUDGET.PROJ_ALLOWED
     11078**DCL     14704>>ASSIGN  14718>>ASSIGN  14768<<ASSIGN
AS_PROJECT_DFLT.BUDGET.PROJ_CREATED
     11083**DCL     14646>>IF      14655>>ASSIGN
AS_PROJECT_DFLT.BUDGET.SUB_PROJS
     11101**DCL     14858>>IF      14868>>ASSIGN
AS_PROJECT_DFLT.HPSN
     11130**DCL     14274>>IF      14275>>ASSIGN  14276>>CALLBLT
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11196**DCL     11197--REDEF   11198--REDEF
AS_PROJECT_DFLT_DREC
     12344**DCL     14357>>ASSIGN  14367<<ASSIGN
AS_PROJECT_DFLT_DREC.PASSWORD
     12402**DCL     12406--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12425**DCL     12426--REDEF
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:90   
AS_PROJECT_DREC
     12182**DCL     14343>>ASSIGN  14353<<ASSIGN
AS_PROJECT_DREC.PASSWORD
     12240**DCL     12244--REDEF
AS_PROJECT_DREC.RENAME
     12263**DCL     12264--REDEF
AS_PROJ_ADMIN
     10709**DCL     14347>>ASSIGN
AS_PROJ_ADMIN.BANNER_PERM
     10824**DCL     10825--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10729**DCL     10733--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10742**DCL     10745--REDEF   14920>>IF      14931>>ASSIGN
AS_PROJ_ADMIN.BUDGET.PACCUM
     10725**DCL     10727--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10720**DCL     10722--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10840**DCL     10841--REDEF   10842--REDEF
AS_PROJ_ADMIN_DREC
     12020**DCL     14348>>ASSIGN
AS_PROJ_ADMIN_DREC.PASSWORD
     12078**DCL     12082--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12101**DCL     12102--REDEF
AS_TRUE
      9813**DCL     14240>>ASSIGN
AS_USERS
     10175**DCL     14342<<ASSIGN  14352>>ASSIGN  14356<<ASSIGN  14366>>ASSIGN  14627<<ASSIGN  14631<>CALL
     14633<>CALL
AS_USERS.BANNER_PERM
     10290**DCL     10291--REDEF
AS_USERS.BUDGET.MACCT
     10195**DCL     10199--REDEF   14628>>DOWHILE 14629>>ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:91   
     10208**DCL     10211--REDEF
AS_USERS.BUDGET.PACCUM
     10191**DCL     10193--REDEF   14632<<ASSIGN  14632>>ASSIGN
AS_USERS.BUDGET.PCHARGES
     10204**DCL     14628>>DOWHILE
AS_USERS.BUDGET.PMAXC
     10186**DCL     10188--REDEF
AS_USERS.SETUP_CHRA.TXT
     10306**DCL     10307--REDEF   10308--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11358**DCL     11359--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11263**DCL     11267--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11276**DCL     11279--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11259**DCL     11261--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11254**DCL     11256--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11374**DCL     11375--REDEF   11376--REDEF
BLK$
     14195**DCL     14080--IMP-PTR 14386<<ASSIGN  14389<<ASSIGN  14394>>CALLBLT 14394>>CALLBLT 14395>>IF
     14398>>IF      14400>>CALLBLT 14400>>CALLBLT 14404>>CALLBLT 14404>>CALLBLT 14558<<ASSIGN  14564<<ASSIGN
     14566>>CALLBLT 14566>>CALLBLT 14567>>IF      14570>>IF      14572>>CALLBLT 14572>>CALLBLT 14576>>CALLBLT
     14576>>CALLBLT 14772<<ASSIGN  14773>>ASSIGN  14773>>ASSIGN  14774>>ASSIGN  14781<<ASSIGN  14782>>ASSIGN
     14782>>ASSIGN  14783>>ASSIGN
CENTS
     14190**DCL     14396<<ASSIGN  14400<<CALLBLT 14401<<ASSIGN  14401>>ASSIGN  14404<<CALLBLT 14406>>ASSIGN
     14568<<ASSIGN  14572<<CALLBLT 14573<<ASSIGN  14573>>ASSIGN  14576<<CALLBLT 14578>>ASSIGN
CM_LOOP
     14240**LABEL   14244--REMEMBR 14451--GOTO    14474--GOTO    14554--GOTO    14622--GOTO    14764--GOTO
     14777--GOTO    14809--GOTO    14816--GOTO    14841--GOTO    14851--GOTO    14977--GOTO    14987--GOTO
CODE
      9946**DCL     14256<<ASSIGN  14261<<ASSIGN  14263>>DOSELCT
CR_MOD_FLG
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:92   
      9962**DCL     14646>>IF      14858>>IF
CR_MOD_KEY
        29**DCL        21--PROC    14266>>ASSIGN  14351<>CALL    14365<>CALL    14776<>CALL    14793<>CALL
     14825<>CALL    14850<>CALL
CR_MOD_KEY.TEXT
        31**DCL     14267>>IF      14268>>ASSIGN  14786>>CALLBLT
CR_MOD_PROJ_OPTS
      9805**DCL     14245--ASSIGN
DELTA
     14186**DCL     14625<<ASSIGN  14632>>ASSIGN  14704<<ASSIGN  14706<<ASSIGN  14707>>IF      14718<<ASSIGN
     14735<>CALL    14766>>ASSIGN  14917<<ASSIGN  14919<<ASSIGN  14920>>IF      14931<<ASSIGN  14948<>CALL
     14979>>ASSIGN
DOLLAR
     14189**DCL     14394<<CALLBLT 14406>>ASSIGN  14566<<CALLBLT 14578>>ASSIGN
ENQ_ERR
     14641**LABEL   14630--CALLALT
ERR_CODE
      9948**DCL      9949--REDEF   14641<>CALL    14815<>CALL
I
     14197**DCL     14259<<DOINDEX 14260>>ASSIGN  14812<<ASSIGN  14813<>CALL
IN_BUF
      9944**DCL     14249<>CALL
J
     14198**DCL     14270<<CALLBLT 14271>>ASSIGN  14272<<ASSIGN  14273<>CALL    14276<<CALLBLT 14277>>ASSIGN
     14278<<ASSIGN  14279<>CALL    14713<<CALLBLT 14714>>CALLBLT 14717>>ASSIGN  14926<<CALLBLT 14927>>CALLBLT
     14930>>ASSIGN
KL_DEFAULT.PASSWORD
     12564**DCL     12568--REDEF
KL_DEFAULT.RENAME
     12587**DCL     12588--REDEF
KL_DFLT
     11696**DCL     14348<<ASSIGN  14362<<ASSIGN
KL_DFLT.PASSWORD
     11754**DCL     11758--REDEF
KL_DFLT.RENAME
     11777**DCL     11778--REDEF
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:93   
KL_DREC
     11534**DCL     14343<<ASSIGN  14353>>ASSIGN  14357<<ASSIGN  14367>>ASSIGN
KL_DREC.PASSWORD
     11592**DCL     11596--REDEF
KL_DREC.RENAME
     11615**DCL     11616--REDEF
KL_DREC_CNT.PASSWORD
     11479**DCL     11483--REDEF
KL_DREC_CNT.RENAME
     11502**DCL     11503--REDEF
MORE
     14019**DCL     14240<<ASSIGN  14243>>DOWHILE
NODE$
      9946**DCL     14033--IMP-PTR 14253<<ASSIGN  14256>>ASSIGN  14257>>ASSIGN  14260>>ASSIGN
OPTION_ERR
     14948**LABEL   14251--CALLALT
OUT$SYM.COUNT
     14103**DCL     14106--IMP-SIZ 14394>>CALLBLT 14398>>IF      14400>>CALLBLT 14404>>CALLBLT 14566>>CALLBLT
     14570>>IF      14572>>CALLBLT 14576>>CALLBLT 14645>>CALLBLT 14773>>ASSIGN  14774>>ASSIGN  14782>>ASSIGN
     14783>>ASSIGN  14857>>CALLBLT
OUT$SYM.TEXT
     14106**DCL     14394>>CALLBLT 14400>>CALLBLT 14404>>CALLBLT 14566>>CALLBLT 14572>>CALLBLT 14576>>CALLBLT
     14645>>CALLBLT 14773>>ASSIGN  14782>>ASSIGN  14857>>CALLBLT
P$NODE.CODE
     14041**DCL     14256>>ASSIGN  14261>>ASSIGN  14379>>IF      14390>>IF      14561>>IF
P$NODE.SUBLK$
     14066**DCL     14260>>ASSIGN  14379>>IF      14386>>ASSIGN  14389>>ASSIGN  14390>>IF      14390>>IF
     14394>>CALLBLT 14394>>CALLBLT 14398>>IF      14400>>CALLBLT 14400>>CALLBLT 14404>>CALLBLT 14404>>CALLBLT
     14558>>ASSIGN  14561>>IF      14561>>IF      14564>>ASSIGN  14566>>CALLBLT 14566>>CALLBLT 14570>>IF
     14572>>CALLBLT 14572>>CALLBLT 14576>>CALLBLT 14576>>CALLBLT 14645>>CALLBLT 14645>>CALLBLT 14772>>ASSIGN
     14781>>ASSIGN  14857>>CALLBLT 14857>>CALLBLT
P$NODE.SUBNODES
     14045**DCL     14257>>ASSIGN  14384>>IF      14395>>IF      14556>>IF      14567>>IF
PACKSET
     14199**DCL     14776<>CALL    14792>>ASSIGN  14824>>ASSIGN  14849>>ASSIGN
PACKSET.CNT
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:94   
     14200**DCL     14774<<ASSIGN  14783<<ASSIGN  14785>>ASSIGN
PACKSET.TXT
     14201**DCL     14773<<ASSIGN  14782<<ASSIGN  14786>>CALLBLT
PACK_NO_EXIST
     14792**LABEL   14787--CALLALT
PROJ_HEADER
     14212**DCL     14272--ASSIGN  14273--CALL    14278--ASSIGN  14279--CALL    14812--ASSIGN  14813--CALL
PROJ_HEADER.NUM_ACCTS
     14229**DCL     14818>>IF
PROJ_HEADER.SUB_PROJ_ACCTS
     14219**DCL     14843>>IF
PROJ_KEY.COUNT
      9826**DCL     14271<<ASSIGN  14277<<ASSIGN  14282>>ASSIGN  14785<<ASSIGN
PROJ_KEY.TEXT
      9826**DCL      9826--REDEF   14786<<CALLBLT
PROJ_KEY.TXT.PACKSET
      9827**DCL     14269<<ASSIGN  14275<<ASSIGN  14283>>ASSIGN  14284>>IF
PROJ_KEY.TXT.PROJECT
      9826**DCL      9826--REDEF   14268<<ASSIGN
PROJ_READ_ERR
     14815**LABEL   14813--CALLALT
P_PCB
      9981**DCL     14251<>CALL
P_PCB.ERROR
     10085**DCL     14986<>CALL
P_PCB.NCHARS
     10128**DCL     14250<<ASSIGN
P_PCB.OUT$
      9994**DCL     14253>>ASSIGN
P_PCB.ROOT$
      9986**DCL     14245<<ASSIGN
READ_ERR
     14637**LABEL   14631--CALLALT
READ_PROJ_ERR
     14282**LABEL   14273--CALLALT 14279--CALLALT
REMEM_VAR
PL6.E3A0      #001=ASA$PROJECT File=ASA$PROJ.:E05TSI                             TUE 07/29/97 08:41 Page:95   
      9952**DCL      9952--REDEF   14244<<REMEMBR
REM_FCMD
      9952**DCL      9953--REDEF
SIGN
     14191**DCL     14385<<ASSIGN  14391<<ASSIGN  14392<<ASSIGN  14407>>IF      14409>>IF      14453>>IF
     14476>>IF      14478>>IF      14481>>ASSIGN  14557<<ASSIGN  14562<<ASSIGN  14563<<ASSIGN  14580>>IF
     14624>>ASSIGN
STR$
     14196**DCL     14111--IMP-PTR
SUBND$
     14194**DCL     14260<<ASSIGN  14261>>ASSIGN  14379>>IF      14384>>IF      14386>>ASSIGN  14389>>ASSIGN
     14390>>IF      14556>>IF      14558>>ASSIGN  14561>>IF      14564>>ASSIGN  14645>>CALLBLT 14645>>CALLBLT
     14772>>ASSIGN  14781>>ASSIGN  14857>>CALLBLT 14857>>CALLBLT
SUBNODES
     14193**DCL     14257<<ASSIGN  14259>>DOINDEX
SUPERAUTH
      9947**DCL     14535>>IF
UBIN_VAL
     14188**DCL     14406<<ASSIGN  14408>>IF      14477>>ASSIGN  14479>>ASSIGN  14481>>ASSIGN  14578<<ASSIGN
     14579>>IF      14624>>ASSIGN
USERS_KEY
      9823**DCL     14266<<ASSIGN  14629<<ASSIGN  14637<>CALL
USERS_KEY.TEXT
      9823**DCL      9824--REDEF    9824--REDEF    9824--REDEF    9825--REDEF
VAL
     14187**DCL     14481<<ASSIGN  14482>>IF      14483>>ASSIGN  14624<<ASSIGN  14625>>ASSIGN  14626>>ASSIGN
     14645<<CALLBLT 14646>>IF      14655<<ASSIGN  14664<>CALL    14704>>ASSIGN  14706>>ASSIGN  14768>>ASSIGN
     14857<<CALLBLT 14858>>IF      14868<<ASSIGN  14877<>CALL    14917>>ASSIGN  14919>>ASSIGN  14981>>ASSIGN
VARY$STR.CNT
     14112**DCL     14113--IMP-SIZ
X$PARSE
     14120**DCL-ENT 14251--CALL

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:96   
      555        1        /*T***********************************************************/
      556        2        /*T*                                                         */
      557        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      558        4        /*T*                                                         */
      559        5        /*T***********************************************************/
      560        6        ASA$PACKSET_OPTS: PROC( CR_MOD_KEY, PACKSET ) ;
      561        7
      562        8        /********************************************************************/
      563        9        /*    Parameter      parameter       parameter       parameter       */
      564       10        /*********************************************************************/
      565       11                                                              /**/
      566       12    1   DCL 1 CR_MOD_KEY,
      567       13    1          2 COUNT UBIN BYTE UNAL,
      568       14    1          2 TEXT CHAR(20) UNAL;
      569       15    1   DCL 1 PACKSET,
      570       16    1          2 CNT UBIN BYTE UNAL,
      571       17    1          2 TXT CHAR(6) UNAL;
      572       18                                                              /**/
      573       19        /********************************************************************/
      574       20        /*   Include files   include files   include files   include files   */
      575       21        /*********************************************************************/
      576       22                                                              /**/
      577       23        %INCLUDE AS_ENTRIES_M ;
      578     1073        %INCLUDE AS_SUBS_C    ;
      579     2487        %INCLUDE AS_PERR_C    ;
      580     3089        %INCLUDE AS_MAC_C     ;
      581     3169        %INCLUDE AS_SUPER_C   ;
      582     3604        %INCLUDE XU_MACRO_C   ;
      583     6710        %INCLUDE XU_FORMAT_C  ;
      584     6872        %INCLUDE KL_SUPER_C   ;
      585     9774        %INCLUDE AS_SUPER_R   ;
      586    12790        %INCLUDE CP_6         ;
      587    12871        %INCLUDE B_ERRORS_C   ;
      588    13998                                                              /**/
      589    13999        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:97   
      590    14000        /********************************************************************/
      591    14001        /*   Constant & static data          constant & statc data           */
      592    14002        /*********************************************************************/
      593    14003                                                              /**/
      594    14004                                                              /**/
      595    14005        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:98   
      596    14006        /********************************************************************/
      597    14007        /*   Local based     local based     local based     local based     */
      598    14008        /*********************************************************************/
      599    14009                                                              /**/
      600    14010        %LIST;
      601    14011        %SET LISTSUB='1'B;
      602    14012        %AS$PROJ( STCLASS="BASED(AS_PROJ_HEADER$)" );
             14013        %AS$PROJ_HEADER( NAME=NAME, STCLASS=STCLASS, LAST="," );
             14014        %LSET LISTDIR='0'B;
             14023    1   DCL 1 AS$PROJ BASED(AS_PROJ_HEADER$) ALIGNED,
             14024                                                    /* Creator of project */
             14025    1          2 CREATOR CHAR(20) ALIGNED %INIT (' ') %CHARTEXT('/**/'),
             14026                                                    /* Can modify default attributes */
             14027    1          2 MODIFY_ATTR BIT(1) UNAL %INIT ('1'B) %CHARTEXT('/**/'),
             14028    1          2 PROJ_REMOVED BIT(1) UNAL %INIT ('0'B) %CHARTEXT('/**/'),
             14029    1          2 * BIT(16) UNAL %INIT ('0'B) %CHARTEXT('/**/'),
             14030    1          2 SUB_PROJ_ACCTS UBIN HALF UNAL %INIT (0) %CHARTEXT('/**/'),
             14031                                                    /* Max. num granules this packset */
             14032    1          2 MAX_NUM_GRANS UBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/'),
             14033                                                    /* Granules given to users */
             14034    1          2 GRANS_ACCUM SBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/'),
             14035                                                    /* Skeleton for accounts */
             14036    1          2 SKELETON CHAR(8) %INIT ('?') %CHARTEXT('/**/'),
             14037                                                    /* Max. number of accounts on pack*/
             14038    1          2 MAX_NUM_ACCTS UBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/'),
             14039                                                    /* Number of accounts initialized */
             14040    1          2 NUM_ACCTS SBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/') ,
             14042    1          2 ATTRIBUTES ALIGNED,              /* Default attribute list */
             14043    1             3 COUNT UBIN HALF UNAL,
             14044    1             3 TEXT CHAR(AS$PROJ.ATTRIBUTES.COUNT);
      603    14046        %PLIST;
      604    14047        %AS$PROJ_HEADER;
      605    14076    1   DCL PROJ$ACCT CHAR(PROJ_ACCT_SIZEC) BASED(PROJ_ACCT$) ;
      606    14077        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      607    14078                    NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      608    14123        %PARSE$SYM( NAME = OUT$SYM ,
      609    14124                    STCLASS="BASED(BLK$)") ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:99   
      610    14162    1   DCL 1 VARY$STR BASED(STR$) ALIGNED ,
      611    14163    1          2 CNT UBIN(9) UNAL ,
      612    14164    1          2 TEXT CHAR(VARY$STR.CNT) ;
      613    14165                                                              /**/
      614    14166        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:100  
      615    14167        /********************************************************************/
      616    14168        /*   Auto data       auto data       auto data       auto data       */
      617    14169                                                              /**/
      618    14170    1   DCL ARS SBIN ;
      619    14171    1   DCL SUBNODES SBIN ;
      620    14172    1   DCL SUBND$ PTR ;
      621    14173    1   DCL BLK$ PTR ;
      622    14174    1   DCL STR$ PTR ;
      623    14175    1   DCL ATTR$ PTR;
      624    14176    1   DCL SKELETON CHAR(8);
      625    14177    1   DCL MSKELETON CHAR(8);
      626    14178    1   DCL I SBIN ;
      627    14179    1   DCL J SBIN;
      628    14180    1   DCL SUB_CODE UBIN ;
      629    14181    1   DCL CNT UBIN;
      630    14182    1   DCL NEW_PROJ_REC BIT(1);
      631    14183    1   DCL MORE BIT(1);
      632    14184    1   DCL OLD_PROJ_REC$ PTR;
      633    14185    1   DCL OLD_PROJ_ARS UBIN;
      634    14186    1   DCL PROJ_ACCT$ PTR;
      635    14187    1   DCL PROJ_ACCT_SIZEC UBIN;
      636    14188    1   DCL INITIAL_DSEG2SIZE UBIN;
      637    14189    1   DCL INITIAL_DSEG3SIZE UBIN;
      638    14190    1   DCL ACCTS_ACCUM UBIN;
      639    14191    1   DCL PROJ_REC_SIZEW UBIN;
      640    14192    1   DCL ADMIN_PROJ_ARS UBIN;
      641    14193    1   DCL VAL SBIN;
      642    14194    1   DCL DELTA SBIN;
      643    14195    1   DCL SIZE UBIN;
      644    14196    1   DCL SKELETON_LEN  UBIN;
      645    14197    1   DCL MSKEL_LEN     UBIN;
      646    14198    1   DCL CHANGE  SBIN;
      647    14199    1   DCL PREVIOUS   BIT(1);
      648    14200    1   DCL K       UBIN;
      649    14201    1   DCL L       SBIN;
      650    14202    1   DCL ONE_CHR$  PTR;
      651    14203    1   DCL ONE_CHR CHAR(1) BASED (ONE_CHR$);
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:101  
      652    14204        %LIST;
      653    14205        %SET LISTSUB='1'B;
      654    14206        %SUPER_TO_PIG( STCLASS=AUTO );
             14207    1   DCL 1 SUPER_TO_PIG AUTO ALIGNED ,
             14208    1          2 TYPE UBIN BYTE UNAL ,       /* Type of transaction */
             14209        %IF '1'B='1'B;
             14210        %EQU CREATE_ACCT   = 0;              /* Create an account       */
             14211        %EQU MODIFY_ACCT   = 1;              /* Modify an account       */
             14212        %EQU LIST_ACCT     = 2;              /* List an account         */
             14213        %EQU VALIDATE_ATTR = 3;              /* Validate attribute list */
             14214        %EQU DELETE_ACCT   = 4;              /* Delete an account       */
             14215        %ENDIF;
             14216    1          2 PROJ BIT(1) UNAL,           /* '1'b => project administrator
             14217                                                '0'b => system  adminstrator */
             14218    1          2 WIDTH UBIN(8) UNAL ,       /* Width of output line */
             14219    1          2 SUPER,                      /* Project or system administrator  */
             14220    1             3 ACCT CHAR(8) UNAL ,      /* who is using super. */
             14221    1             3 UNAME CHAR(12) UNAL ,
             14222    1          2 RESUPER REDEF SUPER CHAR(20) ,
             14223    1          2 PROJECT,                    /* Name of project */
             14224    1             3 ACCT CHAR(8) UNAL,
             14225    1             3 UNAME CHAR(12) UNAL,
             14226    1          2 PROJECT_TEXT REDEF PROJECT CHAR(20),
             14227    1          2 PACKSET CHAR(6) UNAL ,      /* Packset name */
             14228    1          2 ACCT CHAR(8) UNAL ,         /* File management account */
             14229    1          2 ATTR,
             14230    1             3 COUNT UBIN HALF UNAL ,   /* Length of attribute list */
             14231        %LSET STR=CONCAT(TEXTCHAR(AUTO),'     ');
             14232        %IF (((SUBSTR(STR,0,5)='BASED') OR SUBSTR(STR,0,1)=' ') AND '1'B='1'B);
             14234        %ELSE;
             14235    1             3 LIST CHAR(4800);         /* Attribute list */
             14236        %ENDIF;
      655    14238        %PLIST;
      656    14239                                                              /**/
      657    14240        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:102  
      658    14241        /********************************************************************/
      659    14242        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      660    14243        /*********************************************************************/
      661    14244                                                              /**/
      662    14245    1   DCL X$PARSE ENTRY(1) ALTRET ;
      663    14246        %ASB$READ_SI ;
      664    14249        %ASB$SET_PROMPT ;
      665    14252        %ASH$HELP ;
      666    14255        %ASH$DQUEST ;
      667    14258        %ASH$QUEST ;
      668    14261        %ASH$ERROR ;
      669    14264        %ASH$WARN ;
      670    14267        %ASH$INFO ;
      671    14270        %ASB$PIG_ACCT_ATTR ;
      672    14273        %ASB$ENQ_PROJ ;
      673    14276        %ASB$DEQ_PROJ ;
      674    14279        %ASB$READ_PROJ ;
      675    14282        %ASB$WRITE_PROJ ;
      676    14285        %ASB$GET_MORE_SEG ;
      677    14288        %ASB$FREE_SEG ;
      678    14291        %ASB$WILD_MATCH ;
      679    14294                                                              /**/
      680    14295                                                              /**/
      681    14296        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:103  
      682    14297        /********************************************************************/
      683    14298        /*   Procedure       procedure       procedure       procedure       */
      684    14299        /*********************************************************************/
      685    14300                                                              /**/
      686    14301        /*
      687    14302            ***            Begin procedure                    ***
      688    14303        */
      689    14304                                                              /**/
      690    14305    1   PROJ_KEY.COUNT = 20 + PACKSET.CNT ;
      691    14306    1   PROJ_KEY.TXT.PACKSET = PACKSET.TXT ;
      692    14307    1   OLD_PROJ_REC$ = DSEG3$;
      693    14308    1   OLD_PROJ_ARS = DSEG3SIZE;
      694    14309    1   PROJ_ACCT_SIZEC = 0;
      695    14310    1   INITIAL_DSEG2SIZE = DSEG2SIZE;
      696    14311    1   INITIAL_DSEG3SIZE = DSEG3SIZE;
      697    14312    1   IF AS_CR_MOD_PROJ > 0
      698    14313    2   THEN DO;                            /* Make sure the project
      699    14314                                                     admin. has this packset */
      700    14315    2      PROJ_KEY.TXT.PROJECT = AS_PROJECT_ADMIN.TEXT;
      701    14316    2      CALL ASB$ENQ_PROJ  ALTRET( ENQ_ERR );
      702    14317    2      ADMIN_PROJ_ARS = DSEG3SIZE;
      703    14318    2      CALL ASB$READ_PROJ(DSEG3$, ADMIN_PROJ_ARS,3) ALTRET(ADMIN_READ_ERROR);
      704    14319    2      OLD_PROJ_REC$ = PINCRC( DSEG3$, ADMIN_PROJ_ARS );
      705    14320    2      OLD_PROJ_ARS = DSEG3SIZE - ADMIN_PROJ_ARS;
      706    14321    3      DO WHILE( '0'B );
      707    14322    3   ADMIN_READ_ERROR:
      708    14323    3         IF MERR_CODE.CODE = %E$NOKEY
      709    14324    4         THEN DO;
      710    14325        /*E* ERROR: ASA-E$CANT_GIVE_PACKSET-C
      711    14326        MESSAGE: You can't specify the packset DP#%U1 for a project you create.
      712    14327        MESSAGE1: The packset DP#%U1 was not specified for your project, so you can't
      713    14328                  specify it for a project you create.
      714    14329        */
      715    14330    4            AS_FIELD1 = PACKSET;
      716    14331                 %SCREAM( ERR#=E$CANT_GIVE_PACKSET, MID='A', LEVEL=ERROR );
      717    14346    4            CALL ASB$DEQ_PROJ;
      718    14347    4            RETURN;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:104  
      719    14348    4            END;
      720    14349    4         ELSE DO;
      721    14350        /*E* ERROR: ASA-E$UNABLE_TO_READ_PROJ-C
      722    14351        MESSAGE: Unable to read the record "%U1" from the :PROJ file.
      723    14352        */
      724    14353    4            CALL ASH$ERROR( ERR_CODE );
      725    14354    4            AS_FIELD1 = PROJ_KEY;
      726    14355                 %SCREAM(ERR#=E$UNABLE_TO_READ_PROJ,MID='A',LEVEL=INFO);
      727    14370    4            CALL ASB$DEQ_PROJ;
      728    14371    4            RETURN;
      729    14372    4            END;
      730    14373    3         END;
      731    14374    2      END;
      732    14375        /*
      733    14376                                  Initialize 'SUPER_TO_PIG'
      734    14377        */
      735    14378    1   SUPER_TO_PIG.TYPE = %VALIDATE_ATTR;
      736    14379    1   SUPER_TO_PIG.PROJ = AS_FALSE;
      737    14380    1   SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;
      738    14381    1   SUPER_TO_PIG.PROJECT_TEXT = CR_MOD_KEY.TEXT;
      739    14382    1   SUPER_TO_PIG.PACKSET = PACKSET.TXT;
      740    14383    1   SUPER_TO_PIG.WIDTH = LO_WIDTH;
      741    14384    1   SUPER_TO_PIG.PACKSET = PACKSET.TXT;
      742    14385    1   SUPER_TO_PIG.ACCT = AS_BLANK;
      743    14386    1   SUPER_TO_PIG.ATTR.COUNT = 0;
      744    14387        /*
      745    14388                                          Try to read the packset record for the project
      746    14389        */
      747    14390    1   PROJ_KEY.TXT.PROJECT = CR_MOD_KEY.TEXT;
      748    14391    1   CALL ASB$ENQ_PROJ   ALTRET(ENQ_ERR);
      749    14392    1   CALL ASB$READ_PROJ( OLD_PROJ_REC$, OLD_PROJ_ARS, 3 ) ALTRET(OLD_READ_ERR);
      750    14393    2   IF OLD_PROJ_REC$->AS$PROJ.PROJ_REMOVED THEN DO;
      751    14394    2      IF OLD_PROJ_REC$->AS$PROJ.NUM_ACCTS = 0 THEN GOTO NEW_PROJ_REC;
      752    14395        /*E* ERROR:   ASA-E$PREV_PROJ_REC-C
      753    14396        MESSAGE: File management accounts still exist on DP#%U1 for a previous
      754    14397                 "%U2" project.  These accounts must be deleted before the
      755    14398                 packset DP#%U1 can be specified for a new "%U2" project.
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:105  
      756    14399        */
      757    14400    2      AS_FIELD1 = PACKSET;
      758    14401    2      CALL INDEX( J, AS_BLANK, SUBSTR(CR_MOD_KEY.TEXT,0,8) );
      759    14402    2      CALL CONCAT( AS_FIELD2.TEXT, SUBSTR(CR_MOD_KEY.TEXT,0,J), ',', SUBSTR(CR_MOD_KEY.
             14402               TEXT,8,CR_MOD_KEY.COUNT-8));
      760    14403    2      AS_FIELD2.COUNT = CR_MOD_KEY.COUNT - 7 + J;
      761    14404           %SCREAM( ERR#=E$PREV_PROJ_REC, LEVEL=ERROR, MID='A' );
      762    14419    2      RETURN;
      763    14420    2      END;
      764    14421    1   PROJ_ACCT_SIZEC = OLD_PROJ_ARS - SIZEC(AS$PROJ_HEADER)
      765    14422    1        - (((OLD_PROJ_REC$->AS$PROJ.ATTRIBUTES.COUNT + 5)/4)*4);
      766    14423    1   PROJ_ACCT$ = PINCRC( OLD_PROJ_REC$, OLD_PROJ_ARS-PROJ_ACCT_SIZEC );
      767    14424    1   NEW_PROJ_REC = AS_FALSE ;
      768    14425    1   AS_PROJ_HEADER$ -> AS$PROJ_HEADER = OLD_PROJ_REC$ -> AS$PROJ_HEADER ;
      769    14426    1   SUPER_TO_PIG.ATTR.COUNT = OLD_PROJ_REC$ -> AS$PROJ.ATTRIBUTES.COUNT;
      770    14427    1   SUPER_TO_PIG.ATTR.LIST  = OLD_PROJ_REC$ -> AS$PROJ.ATTRIBUTES.TEXT;
      771    14428    2   DO WHILE( '0'B );
      772    14429    2   OLD_READ_ERR:
      773    14430    2      IF MERR_CODE.CODE = %E$NOKEY
      774    14431    3      THEN DO;                    /* Initialize the new record */
      775    14432    3   NEW_PROJ_REC:
      776    14433    3         AS_PROJ_HEADER$ -> AS$PROJ_HEADER = AS_CONSTANT_PROJ_HEADER;
      777    14434    4         IF AS_CR_MOD_PROJ > 0 THEN DO;
      778    14435    4            AS$PROJ.CREATOR = AS_PROJECT_ADMIN.TEXT;
      779    14436    4            AS$PROJ.SKELETON = DSEG3$ -> AS$PROJ.SKELETON;
      780    14437    4            SUPER_TO_PIG.ATTR.COUNT = DSEG3$ -> AS$PROJ.ATTRIBUTES.COUNT;
      781    14438    4            SUPER_TO_PIG.ATTR.LIST  = DSEG3$ -> AS$PROJ.ATTRIBUTES.TEXT;
      782    14439    4            END;
      783    14440    3         ELSE
      784    14441    3            AS$PROJ.CREATOR = AS_BLANK;
      785    14442    3         AS$PROJ.ATTRIBUTES.COUNT = 0;
      786    14443    3         NEW_PROJ_REC = AS_TRUE;
      787    14444    3         END;
      788    14445    3      ELSE DO;
      789    14446    3         CALL ASH$ERROR( ERR_CODE );
      790    14447    3         AS_FIELD1 = PROJ_KEY;
      791    14448              %SCREAM( ERR#=E$UNABLE_TO_READ_PROJ,MID='A',LEVEL=INFO);
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:106  
      792    14463    3         CALL ASB$DEQ_PROJ;
      793    14464    3         RETURN;
      794    14465    3         END;
      795    14466    2      END;
      796    14467                                                                      /**/
      797    14468                                                                      /**/
      798    14469    1   MORE = AS_TRUE;
      799    14470    1   REMEMBER PACK_LOOP IN REMEM_VAR;
      800    14471    1   PACK_LOOP:
      801    14472    1   P_PCB.ROOT$ = ADDR(PROJ_PACKSET_LIST);
      802    14473                                                              /*  Set prompt  */
      803    14474    1   CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;
      804    14475    2   DO WHILE ( MORE );
      805    14476    2      CALL ASB$READ_SI(IN_BUF,ARS) ;             /* Read option line */
      806    14477    2      P_PCB.NCHARS = ARS ;
      807    14478    2      CALL X$PARSE(P_PCB) ALTRET (OPTION_ERR) ;
      808    14479                                                              /**/
      809    14480    2      NODE$ = P_PCB.OUT$ ;
      810    14481                                                              /**/
      811    14482                                                              /**/
      812    14483    2      CODE = P$NODE.CODE ;
      813    14484    2      SUBNODES = P$NODE.SUBNODES ;
      814    14485                                                              /**/
      815    14486    3      DO I = 0 TO SUBNODES-1 ;
      816    14487    3         SUBND$ = P$NODE.SUBLK$(I) ;
      817    14488    3         CODE = SUBND$ -> P$NODE.CODE ;
      818    14489                                                              /**/
      819    14490    4         DO SELECT (CODE) ;
      820    14491                                                              /**/
      821    14492    4            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */) ;
      822    14493                                                          /* End or blank input */
      823    14494    4            MORE = AS_FALSE ;
      824    14495                                                              /**/
      825    14496    4            SELECT(302 /* HELP_VAL */) ;
      826    14497    4            CALL ASH$HELP ;
      827    14498                                                              /**/
      828    14499    4            SELECT(300 /* DQUESTION_VAL */) ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:107  
      829    14500    4            CALL ASH$DQUEST ;
      830    14501                                                              /**/
      831    14502    4            SELECT(301 /* QUESTION_VAL */) ;
      832    14503    4            CALL ASH$QUEST ;
      833    14504        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:108  
      834    14505    4            SELECT( 37 /* PROJ MAX GRANS - THIS PACKSET */ ) ;
      835    14506    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );
      836    14507    4            IF NOT NEW_PROJ_REC  AND  VAL < AS$PROJ.GRANS_ACCUM
      837    14508    5            THEN DO;
      838    14509        /*E* ERROR: ASA-E$GRANS_TOO_SMALL-C
      839    14510        MESSAGE: GRANULES cannot be set less than the number of granules already
      840    14511                accumulated on packset DP#%U2 by this project.  Setting GRANULES to %U1.
      841    14512        MESSAGE1: %U1 granules have already been accumulated on packset DP#%U2 by this
      842    14513                  project.  You cannot set GRANULES to a value which is less than the
      843    14514                  then the number of granules already accumulated by the project.
      844    14515                  GRANULES is set to %U1.
      845    14516        */
      846    14517    5               VAL = AS$PROJ.GRANS_ACCUM;
      847    14518                    %NUMBER( NUM1=VAL );
             14526    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );
      848    14548    5               AS_FIELD2 = PACKSET;
      849    14549                    %SCREAM( ERR#=E$GRANS_TOO_SMALL, MID='A', LEVEL=ERROR );
      850    14564    5               END;
      851    14565    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
      852    14566    5               IF NEW_PROJ_REC THEN
      853    14567    5                  DELTA = VAL;
      854    14568    5               ELSE
      855    14569    5                  DELTA = VAL - AS$PROJ.MAX_NUM_GRANS;
      856    14570    5               IF DSEG3$->AS$PROJ.GRANS_ACCUM + DELTA > DSEG3$->AS$PROJ.MAX_NUM_GRANS
      857    14571    6               THEN DO;
      858    14572        /*E* ERROR: ASA-E$TOO_MANY_GRANS-C
      859    14573        MESSAGE: Maximum number of granules exceeded for project %U1 on
      860    14574                 packset DP#%U2.  GRANULES = %U3 is the most that can be specified.
      861    14575        */
      862    14576    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );
      863    14577    6                  CALL CONCAT( AS_FIELD1.TEXT,
      864    14578    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      865    14579    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
      866    14580    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;
      867    14581    6                  AS_FIELD2 = PACKSET;
      868    14582    6                  DELTA = DSEG3$->AS$PROJ.MAX_NUM_GRANS - DSEG3$->AS$PROJ.GRANS_ACCUM +
             14582                           AS$PROJ.MAX_NUM_GRANS;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:109  
      869    14583                       %NUMBER( NUM3=DELTA );
             14607    6         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, DELTA );
      870    14613                       %SCREAM( ERR#=E$TOO_MANY_GRANS,MID='A',LEVEL=ERROR );
      871    14628    6                  GOTO PACK_LOOP_END;
      872    14629    6                  END;
      873    14630    5               DSEG3$->AS$PROJ.GRANS_ACCUM = DSEG3$->AS$PROJ.GRANS_ACCUM + DELTA;
      874    14631    5               END;
      875    14632    4            AS$PROJ.MAX_NUM_GRANS = VAL ;
      876    14633        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:110  
      877    14634    4            SELECT( 38 /* PROJ MAX ACCNTS - THIS PACKSET */ ) ;
      878    14635    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );
      879    14636    4            ACCTS_ACCUM = AS$PROJ.SUB_PROJ_ACCTS + AS$PROJ.NUM_ACCTS;
      880    14637    4            IF NOT NEW_PROJ_REC  AND  VAL < ACCTS_ACCUM
      881    14638    5            THEN DO;
      882    14639        /*E* ERROR: ASA-E$F_ACCTS_TOO_SMALL-C
      883    14640        MESSAGE: ACCOUNTS cannot be set less than the number of accounts already
      884    14641                accumulated on packset DP#%U2 by this project.  Setting ACCOUNTS to %U1.
      885    14642        MESSAGE1: %U1 accounts have already been accumulated on packset DP#%U2
      886    14643                  by this project. You cannot set ACCOUNTS to a value which is less than
      887    14644                  the number of accounts already accumulated by the project.
      888    14645                  ACCOUNTS is set to %U1.
      889    14646        */
      890    14647    5               VAL = ACCTS_ACCUM;
      891    14648                    %NUMBER( NUM1=VAL );
             14656    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );
      892    14678    5               AS_FIELD2 = PACKSET;
      893    14679                    %SCREAM( ERR#=E$F_ACCTS_TOO_SMALL, MID='A', LEVEL=ERROR );
      894    14694    5               END;
      895    14695    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
      896    14696    5               IF NEW_PROJ_REC THEN
      897    14697    5                  DELTA = VAL;
      898    14698    5               ELSE
      899    14699    5                  DELTA = VAL - AS$PROJ.MAX_NUM_ACCTS;
      900    14700    5               ACCTS_ACCUM = DSEG3$->AS$PROJ.SUB_PROJ_ACCTS + DSEG3$->AS$PROJ.NUM_ACCTS
             14700                        ;
      901    14701    5               IF ACCTS_ACCUM + DELTA > DSEG3$->AS$PROJ.MAX_NUM_ACCTS
      902    14702    6               THEN DO;
      903    14703        /*E* ERROR: ASA-E$TOO_MANY_F_ACCTS-C
      904    14704        MESSAGE: Maximum number of accounts exceeded for project %U1 on
      905    14705                 packset DP#%U2.  ACCOUNTS = %U3 is the most that can be specified.
      906    14706        */
      907    14707    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );
      908    14708    6                  CALL CONCAT( AS_FIELD1.TEXT,
      909    14709    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      910    14710    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
      911    14711    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:111  
      912    14712    6                  AS_FIELD2 = PACKSET;
      913    14713    6                  DELTA = DSEG3$->AS$PROJ.MAX_NUM_ACCTS - ACCTS_ACCUM + AS$PROJ.
             14713                           MAX_NUM_ACCTS;
      914    14714                       %NUMBER( NUM3=DELTA );
             14738    6         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, DELTA );
      915    14744                       %SCREAM( ERR#=E$TOO_MANY_F_ACCTS,MID='A',LEVEL=ERROR);
      916    14759    6                  GOTO PACK_LOOP_END;
      917    14760    6                  END;
      918    14761    5               DSEG3$->AS$PROJ.SUB_PROJ_ACCTS = DSEG3$->AS$PROJ.SUB_PROJ_ACCTS + DELTA;
      919    14762    5               END;
      920    14763    4            AS$PROJ.MAX_NUM_ACCTS = VAL ;
      921    14764        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:112  
      922    14765    4            SELECT( 39 /* PROJ ACCNT SKELETON - THIS PACKSET */ ) ;
      923    14766    4            BLK$ = SUBND$ -> P$NODE.SUBLK$(0);
      924    14767    4            MSKELETON = DSEG3$->AS$PROJ.SKELETON;
      925    14768    4            CNT  = OUT$SYM.COUNT;
      926    14769    4            IF CNT > 8
      927    14770    5            THEN DO;
      928    14771        /*E* ERROR:   ASA-E$SKELETON_TOO_LONG-C
      929    14772             MESSAGE: SKELETON too long.
      930    14773             MESSAGE1: SKELETON can be at most 8 characters long.
      931    14774        */
      932    14775                    %SCREAM( ERR#=E$SKELETON_TOO_LONG, LEVEL=ERROR, MID='A' );
      933    14790    5               GOTO PACK_LOOP_END;
      934    14791    5               END;
      935    14792    4            SKELETON = OUT$SYM.TEXT;
      936    14793        /*
      937    14794            find any invalid skeletons
      938    14795        */
      939    14796    4            CHANGE = 0;
      940    14797    4            ONE_CHR$ = ADDR (SKELETON);
      941    14798    4            IF ONE_CHR = '?' THEN
      942    14799    4               PREVIOUS = AS_TRUE;
      943    14800    4            ELSE
      944    14801    4               PREVIOUS = AS_FALSE;
      945    14802    4            CALL INDEX (L, ' ', SKELETON);
      946    14803    5            DO K = 0 TO L - 1;
      947    14804    5               ONE_CHR$ = PINCRC (ONE_CHR$,1);
      948    14805    5               IF ONE_CHR = '?' AND NOT PREVIOUS THEN
      949    14806    6               DO;
      950    14807    6                  PREVIOUS = AS_TRUE;
      951    14808    6                  CHANGE = CHANGE + 1;
      952    14809    6                  END;
      953    14810    5               ELSE
      954    14811    6                  IF ONE_CHR ~= '?' AND PREVIOUS THEN DO;
      955    14812    6                     PREVIOUS = AS_FALSE;
      956    14813    6                     CHANGE = CHANGE + 1;
      957    14814    6                     END;
      958    14815    5               END; /*  Do k  */
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:113  
      959    14816    5            IF CHANGE > 3 THEN DO;
      960    14817        /*E* ERROR:   ASA-E$ILLEGAL_SKELETON-C
      961    14818             MESSAGE: Illegal SKELETON.
      962    14819             MESSAGE1: %U1 is an invalid SKELETON.
      963    14820                       Examples of valid SKELETONs are:  A, A?, A?B, ?A, ?A?, ?
      964    14821        */
      965    14822    5               AS_FIELD1.COUNT = CNT;
      966    14823    5               AS_FIELD1.TEXT  = SKELETON;
      967    14824                    %SCREAM( ERR#=E$ILLEGAL_SKELETON, MID='A', LEVEL=ERROR );
      968    14839    5               GOTO PACK_LOOP_END;
      969    14840    5               END;
      970    14841    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
      971    14842    5               CALL INDEX (SKELETON_LEN, ' ', SKELETON);
      972    14843    5               IF SKELETON_LEN = 0 THEN SKELETON_LEN = 1;
      973    14844    5               CALL INDEX (MSKEL_LEN, ' ', MSKELETON);
      974    14845    5               IF MSKEL_LEN = 0 THEN MSKEL_LEN = 1;
      975    14846    5               CALL ASB$WILD_MATCH(SKELETON_LEN, SKELETON, MSKEL_LEN, MSKELETON )
             14846                        ALTRET(NO_MATCH);
      976    14847    6               IF '0'B THEN DO;
      977    14848        /*E* ERROR:   ASA-E$INCONSIST_SKELETON-C
      978    14849             MESSAGE: "%U1" is inconsistent with the skeleton (%U2) for
      979    14850                      project %U3.
      980    14851        */
      981    14852    6   NO_MATCH:
      982    14853    6                  AS_FIELD1.COUNT = CNT;
      983    14854    6                  AS_FIELD1.TEXT  = SKELETON;
      984    14855    6                  CALL INDEX(J, AS_BLANK, MSKELETON );
      985    14856    6                  AS_FIELD2.COUNT = J;
      986    14857    6                  AS_FIELD2.TEXT  = MSKELETON;
      987    14858    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );
      988    14859    6                  CALL CONCAT( AS_FIELD3.TEXT,
      989    14860    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      990    14861    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8),
      991    14862    6                       ' DP#', PACKSET.TXT );
      992    14863    6                  AS_FIELD3.COUNT = AS_PROJECT_ADMIN.COUNT + PACKSET.CNT + J - 3;
      993    14864                       %SCREAM( ERR#=E$INCONSIST_SKELETON, MID='A', LEVEL=ERROR );
      994    14879    6                  GOTO PACK_LOOP_END;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:114  
      995    14880    6                  END;
      996    14881    5               END;
      997    14882    4            AS$PROJ.SKELETON = SKELETON;
      998    14883        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:115  
      999    14884    4            SELECT( 41 /* CHANGES TO ACCESSES ALLOWED - THIS PACKSET */ ) ;
     1000    14885    4            IF SUBND$ -> P$NODE.SUBNODES = 0
     1001    14886    4            THEN
     1002    14887    4               SUB_CODE = 1   /*  YES_VAL  */ ;
     1003    14888    4            ELSE
     1004    14889    4               SUB_CODE = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;
     1005    14890    4            IF SUB_CODE = 1   /*  YES_VAL  */  AND  AS_CR_MOD_PROJ > 0
     1006    14891    4            THEN
     1007    14892    4               IF NOT DSEG3$->AS$PROJ.MODIFY_ATTR
     1008    14893    5               THEN DO;
     1009    14894        /*E* ERROR:   ASA-E$CHANGE_ILLEGAL-C
     1010    14895        MESSAGE: You can't specify CHANGE = YES for packset DP#%U1.
     1011    14896        MESSAGE1: CHANGE = YES was not specified for packset DP%U1 when the project
     1012    14897                  "%U2" was created.  So you are not allowed to specify CHANGE = YES for
     1013    14898                  DP#%U1 on projects you create.
     1014    14899        */
     1015    14900    5                  AS_FIELD1 = PACKSET;
     1016    14901    5                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );
     1017    14902    5                  CALL CONCAT( AS_FIELD2.TEXT,
     1018    14903    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
     1019    14904    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
     1020    14905    5                  AS_FIELD2.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;
     1021    14906                       %SCREAM( ERR#=E$CHANGE_ILLEGAL, MID='A', LEVEL=ERROR);
     1022    14921    5                  GOTO PACK_LOOP_END;
     1023    14922    5                  END;
     1024    14923    4            AS$PROJ.MODIFY_ATTR = ( SUB_CODE = 1   /*  YES_VAL  */ ) ;
     1025    14924        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:116  
     1026    14925    4            SELECT( 40 /* PROJ ACCESS CONTROLS - THIS PACKSET */ ) ;
     1027    14926    4            IF AS_CR_MOD_PROJ > 0
     1028    14927    4            THEN
     1029    14928    4               IF NOT DSEG3$->AS$PROJ.MODIFY_ATTR
     1030    14929    5               THEN DO;
     1031    14930        /*E* ERROR:   ASA-E$ATTRIB_ILLEGAL-C
     1032    14931        MESSAGE: You can't specify ATTRIBUTES for packset DP#%U1.
     1033    14932        MESSAGE1: CHANGE = YES was not specified for packset DP%U1 when the project
     1034    14933                  "%U2" was created.  So you are not allowed to specify ATTRIBUTES for
     1035    14934                  DP#%U1 on projects you create.
     1036    14935        */
     1037    14936    5                  AS_FIELD1 = PACKSET;
     1038    14937    5                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );
     1039    14938    5                  CALL CONCAT( AS_FIELD2.TEXT,
     1040    14939    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
     1041    14940    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
     1042    14941    5                  AS_FIELD2.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;
     1043    14942                       %SCREAM( ERR#=E$ATTRIB_ILLEGAL, MID='A', LEVEL=ERROR);
     1044    14957    5                  GOTO PACK_LOOP_END;
     1045    14958    5                  END;
     1046    14959    4            CALL ASB$PIG_ACCT_ATTR( SUPER_TO_PIG );
     1047    14960    4            GOTO PACK_LOOP;
     1048    14961                                                              /**/
     1049    14962    4            END;  /* Do case */
     1050    14963    3   PACK_LOOP_END:
     1051    14964    3         END;    /* Do i = 0 to SUBNODES-1; */
     1052    14965    3      DO WHILE( '0'B );
     1053    14966    3   OPTION_ERR:
     1054    14967    3         CALL ASH$ERROR( P_PCB.ERROR );
     1055    14968    3         END;
     1056    14969    2      END;    /* Do while( more ) */
     1057    14970
     1058    14971    1   PROJ_REC_SIZEW = SIZEW(AS$PROJ_HEADER) + (SUPER_TO_PIG.ATTR.COUNT+5)/4;
     1059    14972    1   SIZE = POFFC(AS_PROJ_HEADER$,DSEG2$) + 4*PROJ_REC_SIZEW + PROJ_ACCT_SIZEC;
     1060    14973    1   IF SIZE > DSEG2SIZE
     1061    14974    2   THEN DO;
     1062    14975    2      SIZE = ((SIZE - DSEG2SIZE + 4095) / 4096) * 4096;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:117  
     1063    14976    2      CALL ASB$GET_MORE_SEG( 2, SIZE );
     1064    14977    2      END;
     1065    14978
     1066    14979    1   AS$PROJ.ATTRIBUTES.COUNT = SUPER_TO_PIG.ATTR.COUNT;
     1067    14980    1   AS$PROJ.ATTRIBUTES.TEXT  = SUPER_TO_PIG.ATTR.LIST;
     1068    14981
     1069    14982    1   IF NOT NEW_PROJ_REC AND PROJ_ACCT_SIZEC > 0 THEN
     1070    14983    1      PINCRW(AS_PROJ_HEADER$,PROJ_REC_SIZEW)->PROJ$ACCT = PROJ$ACCT;
     1071    14984        /*
     1072    14985                                                  Write :PROJ record
     1073    14986        */
     1074    14987    1   PROJ_KEY.TXT.PROJECT = CR_MOD_KEY.TEXT ;
     1075    14988    1   ARS = PROJ_REC_SIZEW * 4  +  PROJ_ACCT_SIZEC ;
     1076    14989    1   CALL ASB$WRITE_PROJ( AS_PROJ_HEADER$, ARS )  ALTRET(PROJ_WRITE_ERR);
     1077    14990    1   IF AS_CR_MOD_PROJ > 0
     1078    14991    2   THEN DO;
     1079    14992    2      PROJ_KEY.TXT.PROJECT = AS_PROJECT_ADMIN.TEXT;
     1080    14993    2      CALL ASB$WRITE_PROJ( DSEG3$, ADMIN_PROJ_ARS ) ALTRET( PROJ_WRITE_ERR);
     1081    14994    2      END;
     1082    14995    1   CALL ASB$DEQ_PROJ;
     1083    14996    1   SIZE = DSEG3SIZE - INITIAL_DSEG3SIZE;
     1084    14997    1   IF SIZE > 0 THEN CALL ASB$FREE_SEG( 3, SIZE );
     1085    14998    1   SIZE = DSEG2SIZE - INITIAL_DSEG2SIZE;
     1086    14999    1   IF SIZE > 0 THEN CALL ASB$FREE_SEG( 2, SIZE );
     1087    15000    1   RETURN ;
     1088    15001
     1089    15002
     1090    15003    1   PROJ_WRITE_ERR:;
     1091    15004        /*E* ERROR:   ASA-E$UNABLE_TO_WRITE_PROJ-C
     1092    15005             MESSAGE: Unable to write the record "%U1" to the :PROJ file.
     1093    15006        */
     1094    15007    1   CALL ASH$ERROR( ERR_CODE );
     1095    15008    1   AS_FIELD1 = PROJ_KEY;
     1096    15009        %SCREAM( ERR#=E$UNABLE_TO_WRITE_PROJ, MID='A', LEVEL=INFO );
     1097    15024
     1098    15025    1   ENQ_ERR:
     1099    15026    1   RETURN;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:118  
     1100    15027
     1101    15028    1   END ASA$PACKSET_OPTS;

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:119  
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$PACKSET_OPTS.

   Procedure ASA$PACKSET_OPTS requires 1054 words for executable code.
   Procedure ASA$PACKSET_OPTS requires 1260 words of local(AUTO) storage.

    No errors detected in file ASA$PROJ.:E05TSI    .

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:120  

 Object Unit name= ASA$PACKSET_OPTS                           File name= ASA$PROJ.:E05TOU
 UTS= JUL 29 '97 08:43:42.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1   DCB   even  none     0      0  M$UC
    2  RoData even  UTS     14     16  ASA$PACKSET_OPTS
    3   Proc  even  none  1054   2036  ASA$PACKSET_OPTS
    4  RoData even  none    33     41  ASA$PACKSET_OPTS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        2  ASA$PACKSET_OPTS
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:121  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
         yes           Std       4 ASB$BINCHAR
 yes     yes           Std       0 ASB$ENQ_PROJ
 yes     yes           Std       0 ASB$DEQ_PROJ
         yes           Std       0 ASH$HELP
 yes     yes           Std       3 ASB$READ_PROJ
         yes           Std       2 ASH$INFO
 yes     yes           Std       2 ASB$WRITE_PROJ
         yes           Std       2 ASH$ERROR
         yes           Std       0 ASH$QUEST
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       2 ASB$GET_MORE_SEG
 yes     yes           Std       3 ASB$SET_PROMPT
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
 yes     yes           Std       2 ASB$FREE_SEG
 yes     yes           Std       1 ASB$PIG_ACCT_ATTR
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:122  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_TRUE                          r    AS_FALSE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     PROJ_KEY                              LO_WIDTH                              IN_BUF
     NODE$                                 CODE                                  ERR_CODE
     AS_FIELD1                             AS_FIELD2                             AS_FIELD3
     PROJ_PACKSET_LIST                     REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG2$                                DSEG2SIZE
     DSEG3$                                DSEG3SIZE                             AS_PROJECT_ADMIN
     AS_LOGON_KEY                          AS_PROJ_HEADER$                       AS_CR_MOD_PROJ
     P_PCB                            r    AS_CONSTANT_PROJ_HEADER               M$UC
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:123  


      555        1        /*T***********************************************************/
      556        2        /*T*                                                         */
      557        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      558        4        /*T*                                                         */
      559        5        /*T***********************************************************/
      560        6        ASA$PACKSET_OPTS: PROC( CR_MOD_KEY, PACKSET ) ;

      6  3 000000   000000 700200 xent  ASA$PACKSET* TSX0  ! X66_AUTO_2
         3 000001   002354 000002                    ZERO    1260,2

      561        7
      562        8        /********************************************************************/
      563        9        /*    Parameter      parameter       parameter       parameter       */
      564       10        /*********************************************************************/
      565       11                                                              /**/
      566       12    1   DCL 1 CR_MOD_KEY,
      567       13    1          2 COUNT UBIN BYTE UNAL,
      568       14    1          2 TEXT CHAR(20) UNAL;
      569       15    1   DCL 1 PACKSET,
      570       16    1          2 CNT UBIN BYTE UNAL,
      571       17    1          2 TXT CHAR(6) UNAL;
      572       18                                                              /**/
      573       19        /********************************************************************/
      574       20        /*   Include files   include files   include files   include files   */
      575       21        /*********************************************************************/
      576       22                                                              /**/
      577       23        %INCLUDE AS_ENTRIES_M ;
      578     1073        %INCLUDE AS_SUBS_C    ;
      579     2487        %INCLUDE AS_PERR_C    ;
      580     3089        %INCLUDE AS_MAC_C     ;
      581     3169        %INCLUDE AS_SUPER_C   ;
      582     3604        %INCLUDE XU_MACRO_C   ;
      583     6710        %INCLUDE XU_FORMAT_C  ;
      584     6872        %INCLUDE KL_SUPER_C   ;
      585     9774        %INCLUDE AS_SUPER_R   ;
      586    12790        %INCLUDE CP_6         ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:124  
      587    12871        %INCLUDE B_ERRORS_C   ;
      588    13998                                                              /**/
      589    13999        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:125  
      590    14000        /********************************************************************/
      591    14001        /*   Constant & static data          constant & statc data           */
      592    14002        /*********************************************************************/
      593    14003                                                              /**/
      594    14004                                                              /**/
      595    14005        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:126  
      596    14006        /********************************************************************/
      597    14007        /*   Local based     local based     local based     local based     */
      598    14008        /*********************************************************************/
      599    14009                                                              /**/
      600    14010        %LIST;
      601    14011        %SET LISTSUB='1'B;
      602    14012        %AS$PROJ( STCLASS="BASED(AS_PROJ_HEADER$)" );
             14013        %AS$PROJ_HEADER( NAME=NAME, STCLASS=STCLASS, LAST="," );
             14014        %LSET LISTDIR='0'B;
             14023    1   DCL 1 AS$PROJ BASED(AS_PROJ_HEADER$) ALIGNED,
             14024                                                    /* Creator of project */
             14025    1          2 CREATOR CHAR(20) ALIGNED %INIT (' ') %CHARTEXT('/**/'),
             14026                                                    /* Can modify default attributes */
             14027    1          2 MODIFY_ATTR BIT(1) UNAL %INIT ('1'B) %CHARTEXT('/**/'),
             14028    1          2 PROJ_REMOVED BIT(1) UNAL %INIT ('0'B) %CHARTEXT('/**/'),
             14029    1          2 * BIT(16) UNAL %INIT ('0'B) %CHARTEXT('/**/'),
             14030    1          2 SUB_PROJ_ACCTS UBIN HALF UNAL %INIT (0) %CHARTEXT('/**/'),
             14031                                                    /* Max. num granules this packset */
             14032    1          2 MAX_NUM_GRANS UBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/'),
             14033                                                    /* Granules given to users */
             14034    1          2 GRANS_ACCUM SBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/'),
             14035                                                    /* Skeleton for accounts */
             14036    1          2 SKELETON CHAR(8) %INIT ('?') %CHARTEXT('/**/'),
             14037                                                    /* Max. number of accounts on pack*/
             14038    1          2 MAX_NUM_ACCTS UBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/'),
             14039                                                    /* Number of accounts initialized */
             14040    1          2 NUM_ACCTS SBIN WORD ALIGNED %INIT (0) %CHARTEXT('/**/') ,
             14042    1          2 ATTRIBUTES ALIGNED,              /* Default attribute list */
             14043    1             3 COUNT UBIN HALF UNAL,
             14044    1             3 TEXT CHAR(AS$PROJ.ATTRIBUTES.COUNT);
      603    14046        %PLIST;
      604    14047        %AS$PROJ_HEADER;
      605    14076    1   DCL PROJ$ACCT CHAR(PROJ_ACCT_SIZEC) BASED(PROJ_ACCT$) ;
      606    14077        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
      607    14078                    NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
      608    14123        %PARSE$SYM( NAME = OUT$SYM ,
      609    14124                    STCLASS="BASED(BLK$)") ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:127  
      610    14162    1   DCL 1 VARY$STR BASED(STR$) ALIGNED ,
      611    14163    1          2 CNT UBIN(9) UNAL ,
      612    14164    1          2 TEXT CHAR(VARY$STR.CNT) ;
      613    14165                                                              /**/
      614    14166        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:128  
      615    14167        /********************************************************************/
      616    14168        /*   Auto data       auto data       auto data       auto data       */
      617    14169                                                              /**/
      618    14170    1   DCL ARS SBIN ;
      619    14171    1   DCL SUBNODES SBIN ;
      620    14172    1   DCL SUBND$ PTR ;
      621    14173    1   DCL BLK$ PTR ;
      622    14174    1   DCL STR$ PTR ;
      623    14175    1   DCL ATTR$ PTR;
      624    14176    1   DCL SKELETON CHAR(8);
      625    14177    1   DCL MSKELETON CHAR(8);
      626    14178    1   DCL I SBIN ;
      627    14179    1   DCL J SBIN;
      628    14180    1   DCL SUB_CODE UBIN ;
      629    14181    1   DCL CNT UBIN;
      630    14182    1   DCL NEW_PROJ_REC BIT(1);
      631    14183    1   DCL MORE BIT(1);
      632    14184    1   DCL OLD_PROJ_REC$ PTR;
      633    14185    1   DCL OLD_PROJ_ARS UBIN;
      634    14186    1   DCL PROJ_ACCT$ PTR;
      635    14187    1   DCL PROJ_ACCT_SIZEC UBIN;
      636    14188    1   DCL INITIAL_DSEG2SIZE UBIN;
      637    14189    1   DCL INITIAL_DSEG3SIZE UBIN;
      638    14190    1   DCL ACCTS_ACCUM UBIN;
      639    14191    1   DCL PROJ_REC_SIZEW UBIN;
      640    14192    1   DCL ADMIN_PROJ_ARS UBIN;
      641    14193    1   DCL VAL SBIN;
      642    14194    1   DCL DELTA SBIN;
      643    14195    1   DCL SIZE UBIN;
      644    14196    1   DCL SKELETON_LEN  UBIN;
      645    14197    1   DCL MSKEL_LEN     UBIN;
      646    14198    1   DCL CHANGE  SBIN;
      647    14199    1   DCL PREVIOUS   BIT(1);
      648    14200    1   DCL K       UBIN;
      649    14201    1   DCL L       SBIN;
      650    14202    1   DCL ONE_CHR$  PTR;
      651    14203    1   DCL ONE_CHR CHAR(1) BASED (ONE_CHR$);
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:129  
      652    14204        %LIST;
      653    14205        %SET LISTSUB='1'B;
      654    14206        %SUPER_TO_PIG( STCLASS=AUTO );
             14207    1   DCL 1 SUPER_TO_PIG AUTO ALIGNED ,
             14208    1          2 TYPE UBIN BYTE UNAL ,       /* Type of transaction */
             14209        %IF '1'B='1'B;
             14210        %EQU CREATE_ACCT   = 0;              /* Create an account       */
             14211        %EQU MODIFY_ACCT   = 1;              /* Modify an account       */
             14212        %EQU LIST_ACCT     = 2;              /* List an account         */
             14213        %EQU VALIDATE_ATTR = 3;              /* Validate attribute list */
             14214        %EQU DELETE_ACCT   = 4;              /* Delete an account       */
             14215        %ENDIF;
             14216    1          2 PROJ BIT(1) UNAL,           /* '1'b => project administrator
             14217                                                '0'b => system  adminstrator */
             14218    1          2 WIDTH UBIN(8) UNAL ,       /* Width of output line */
             14219    1          2 SUPER,                      /* Project or system administrator  */
             14220    1             3 ACCT CHAR(8) UNAL ,      /* who is using super. */
             14221    1             3 UNAME CHAR(12) UNAL ,
             14222    1          2 RESUPER REDEF SUPER CHAR(20) ,
             14223    1          2 PROJECT,                    /* Name of project */
             14224    1             3 ACCT CHAR(8) UNAL,
             14225    1             3 UNAME CHAR(12) UNAL,
             14226    1          2 PROJECT_TEXT REDEF PROJECT CHAR(20),
             14227    1          2 PACKSET CHAR(6) UNAL ,      /* Packset name */
             14228    1          2 ACCT CHAR(8) UNAL ,         /* File management account */
             14229    1          2 ATTR,
             14230    1             3 COUNT UBIN HALF UNAL ,   /* Length of attribute list */
             14231        %LSET STR=CONCAT(TEXTCHAR(AUTO),'     ');
             14232        %IF (((SUBSTR(STR,0,5)='BASED') OR SUBSTR(STR,0,1)=' ') AND '1'B='1'B);
             14234        %ELSE;
             14235    1             3 LIST CHAR(4800);         /* Attribute list */
             14236        %ENDIF;
      655    14238        %PLIST;
      656    14239                                                              /**/
      657    14240        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:130  
      658    14241        /********************************************************************/
      659    14242        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
      660    14243        /*********************************************************************/
      661    14244                                                              /**/
      662    14245    1   DCL X$PARSE ENTRY(1) ALTRET ;
      663    14246        %ASB$READ_SI ;
      664    14249        %ASB$SET_PROMPT ;
      665    14252        %ASH$HELP ;
      666    14255        %ASH$DQUEST ;
      667    14258        %ASH$QUEST ;
      668    14261        %ASH$ERROR ;
      669    14264        %ASH$WARN ;
      670    14267        %ASH$INFO ;
      671    14270        %ASB$PIG_ACCT_ATTR ;
      672    14273        %ASB$ENQ_PROJ ;
      673    14276        %ASB$DEQ_PROJ ;
      674    14279        %ASB$READ_PROJ ;
      675    14282        %ASB$WRITE_PROJ ;
      676    14285        %ASB$GET_MORE_SEG ;
      677    14288        %ASB$FREE_SEG ;
      678    14291        %ASB$WILD_MATCH ;
      679    14294                                                              /**/
      680    14295                                                              /**/
      681    14296        %EJECT ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:131  
      682    14297        /********************************************************************/
      683    14298        /*   Procedure       procedure       procedure       procedure       */
      684    14299        /*********************************************************************/
      685    14300                                                              /**/
      686    14301        /*
      687    14302            ***            Begin procedure                    ***
      688    14303        */
      689    14304                                                              /**/
      690    14305    1   PROJ_KEY.COUNT = 20 + PACKSET.CNT ;

  14305  3 000002   200004 470500                    LDP0    @PACKSET,,AUTO
         3 000003   000100 101500                    MRL     fill='000'O
         3 000004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         3 000005   202350 000004                    ADSC9   SUPER_TO_PIG+1216,,AUTO  cn=0,n=4
         3 000006   202350 236100                    LDQ     SUPER_TO_PIG+1216,,AUTO
         3 000007   000024 036007                    ADLQ    20,DL
         3 000010   000033 736000                    QLS     27
         3 000011   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      691    14306    1   PROJ_KEY.TXT.PACKSET = PACKSET.TXT ;

  14306  3 000012   040000 100500                    MLR     fill='040'O
         3 000013   000000 200006                    ADSC9   0,,PR0                   cn=1,n=6
         3 000014   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      692    14307    1   OLD_PROJ_REC$ = DSEG3$;

  14307  3 000015   000000 236000 xsym               LDQ     DSEG3$
         3 000016   200025 756100                    STQ     OLD_PROJ_REC$,,AUTO

      693    14308    1   OLD_PROJ_ARS = DSEG3SIZE;

  14308  3 000017   000000 235000 xsym               LDA     DSEG3SIZE
         3 000020   200026 755100                    STA     OLD_PROJ_ARS,,AUTO

      694    14309    1   PROJ_ACCT_SIZEC = 0;

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:132  
  14309  3 000021   200030 450100                    STZ     PROJ_ACCT_SIZEC,,AUTO

      695    14310    1   INITIAL_DSEG2SIZE = DSEG2SIZE;

  14310  3 000022   000000 235000 xsym               LDA     DSEG2SIZE
         3 000023   200031 755100                    STA     INITIAL_DSEG2SIZE,,AUTO

      696    14311    1   INITIAL_DSEG3SIZE = DSEG3SIZE;

  14311  3 000024   000000 235000 xsym               LDA     DSEG3SIZE
         3 000025   200032 755100                    STA     INITIAL_DSEG3SIZE,,AUTO

      697    14312    1   IF AS_CR_MOD_PROJ > 0

  14312  3 000026   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 000027   000121 604400 3                  TMOZ    s:14378

      698    14313    2   THEN DO;                            /* Make sure the project

      699    14314                                                     admin. has this packset */
      700    14315    2      PROJ_KEY.TXT.PROJECT = AS_PROJECT_ADMIN.TEXT;

  14315  3 000030   040000 100400                    MLR     fill='040'O
         3 000031   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 000032   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

      701    14316    2      CALL ASB$ENQ_PROJ  ALTRET( ENQ_ERR );

  14316  3 000033   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000034   000000 701000 xent               TSX1    ASB$ENQ_PROJ
         3 000035   002035 702000 3                  TSX2    ENQ_ERR

      702    14317    2      ADMIN_PROJ_ARS = DSEG3SIZE;

  14317  3 000036   000000 235000 xsym               LDA     DSEG3SIZE
         3 000037   200035 755100                    STA     ADMIN_PROJ_ARS,,AUTO

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:133  
      703    14318    2      CALL ASB$READ_PROJ(DSEG3$, ADMIN_PROJ_ARS,3) ALTRET(ADMIN_READ_ERROR);

  14318  3 000040   000000 236000 4                  LDQ     0
         3 000041   202352 756100                    STQ     SUPER_TO_PIG+1218,,AUTO
         3 000042   200035 630500                    EPPR0   ADMIN_PROJ_ARS,,AUTO
         3 000043   202351 450500                    STP0    SUPER_TO_PIG+1217,,AUTO
         3 000044   000001 236000 4                  LDQ     1
         3 000045   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 000046   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 000047   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000050   000000 701000 xent               TSX1    ASB$READ_PROJ
         3 000051   000062 702000 3                  TSX2    ADMIN_READ_ERROR

      704    14319    2      OLD_PROJ_REC$ = PINCRC( DSEG3$, ADMIN_PROJ_ARS );

  14319  3 000052   200035 236100                    LDQ     ADMIN_PROJ_ARS,,AUTO
         3 000053   000020 736000                    QLS     16
         3 000054   000000 036000 xsym               ADLQ    DSEG3$
         3 000055   200025 756100                    STQ     OLD_PROJ_REC$,,AUTO

      705    14320    2      OLD_PROJ_ARS = DSEG3SIZE - ADMIN_PROJ_ARS;

  14320  3 000056   000000 236000 xsym               LDQ     DSEG3SIZE
         3 000057   200035 136100                    SBLQ    ADMIN_PROJ_ARS,,AUTO
         3 000060   200026 756100                    STQ     OLD_PROJ_ARS,,AUTO

      706    14321    3      DO WHILE( '0'B );

  14321  3 000061   000121 710000 3                  TRA     s:14378

      707    14322    3   ADMIN_READ_ERROR:
      708    14323    3         IF MERR_CODE.CODE = %E$NOKEY

  14323  3 000062   000000 236000 xsym  ADMIN_READ_* LDQ     ERR_CODE
         3 000063   377770 376007                    ANQ     131064,DL
         3 000064   001020 116007                    CMPQ    528,DL
         3 000065   000102 601000 3                  TNZ     s:14353
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:134  

      709    14324    4         THEN DO;

      710    14325        /*E* ERROR: ASA-E$CANT_GIVE_PACKSET-C
      711    14326        MESSAGE: You can't specify the packset DP#%U1 for a project you create.
      712    14327        MESSAGE1: The packset DP#%U1 was not specified for your project, so you can't
      713    14328                  specify it for a project you create.
      714    14329        */
      715    14330    4            AS_FIELD1 = PACKSET;

  14330  3 000066   200004 470500                    LDP0    @PACKSET,,AUTO
         3 000067   000000 100500                    MLR     fill='000'O
         3 000070   000000 000007                    ADSC9   0,,PR0                   cn=0,n=7
         3 000071   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      716    14331                 %SCREAM( ERR#=E$CANT_GIVE_PACKSET, MID='A', LEVEL=ERROR );

  14343  3 000072   000002 630400 4                  EPPR0   2
         3 000073   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000074   000000 701000 xent               TSX1    ASH$ERROR
         3 000075   000000 011000                    NOP     0

      717    14346    4            CALL ASB$DEQ_PROJ;

  14346  3 000076   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000077   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         3 000100   000000 011000                    NOP     0

      718    14347    4            RETURN;

  14347  3 000101   000000 702200 xent               TSX2  ! X66_ARET

      719    14348    4            END;
      720    14349    4         ELSE DO;

      721    14350        /*E* ERROR: ASA-E$UNABLE_TO_READ_PROJ-C
      722    14351        MESSAGE: Unable to read the record "%U1" from the :PROJ file.
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:135  
      723    14352        */
      724    14353    4            CALL ASH$ERROR( ERR_CODE );

  14353  3 000102   000003 630400 4                  EPPR0   3
         3 000103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000104   000000 701000 xent               TSX1    ASH$ERROR
         3 000105   000000 011000                    NOP     0

      725    14354    4            AS_FIELD1 = PROJ_KEY;

  14354  3 000106   000000 100400                    MLR     fill='000'O
         3 000107   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27
         3 000110   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      726    14355                 %SCREAM(ERR#=E$UNABLE_TO_READ_PROJ,MID='A',LEVEL=INFO);

  14363  3 000111   000004 630400 4                  EPPR0   4
         3 000112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000113   000000 701000 xent               TSX1    ASH$INFO
         3 000114   000000 011000                    NOP     0

      727    14370    4            CALL ASB$DEQ_PROJ;

  14370  3 000115   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000116   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         3 000117   000000 011000                    NOP     0

      728    14371    4            RETURN;

  14371  3 000120   000000 702200 xent               TSX2  ! X66_ARET

      729    14372    4            END;
      730    14373    3         END;

      731    14374    2      END;
      732    14375        /*
      733    14376                                  Initialize 'SUPER_TO_PIG'
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:136  
      734    14377        */
      735    14378    1   SUPER_TO_PIG.TYPE = %VALIDATE_ATTR;

  14378  3 000121   003000 236003                    LDQ     1536,DU
         3 000122   200050 552140                    STBQ    SUPER_TO_PIG,'40'O,AUTO

      736    14379    1   SUPER_TO_PIG.PROJ = AS_FALSE;

  14379  3 000123   000000 236000 xsym               LDQ     AS_FALSE
         3 000124   000011 772000                    QRL     9
         3 000125   200050 676100                    ERQ     SUPER_TO_PIG,,AUTO
         3 000126   000400 376003                    ANQ     256,DU
         3 000127   200050 656100                    ERSQ    SUPER_TO_PIG,,AUTO

      737    14380    1   SUPER_TO_PIG.RESUPER = AS_LOGON_KEY.TEXT;

  14380  3 000130   040100 100400                    MLR     fill='040'O
         3 000131   000000 200024 xsym               ADSC9   AS_LOGON_KEY             cn=1,n=20
         3 000132   200050 400024                    ADSC9   SUPER_TO_PIG,,AUTO       cn=2,n=20

      738    14381    1   SUPER_TO_PIG.PROJECT_TEXT = CR_MOD_KEY.TEXT;

  14381  3 000133   200003 470500                    LDP0    @CR_MOD_KEY,,AUTO
         3 000134   040100 100500                    MLR     fill='040'O
         3 000135   000000 200024                    ADSC9   0,,PR0                   cn=1,n=20
         3 000136   200055 400024                    ADSC9   SUPER_TO_PIG+5,,AUTO     cn=2,n=20

      739    14382    1   SUPER_TO_PIG.PACKSET = PACKSET.TXT;

  14382  3 000137   200004 471500                    LDP1    @PACKSET,,AUTO
         3 000140   040100 100500                    MLR     fill='040'O
         3 000141   100000 200006                    ADSC9   0,,PR1                   cn=1,n=6
         3 000142   200062 400006                    ADSC9   SUPER_TO_PIG+10,,AUTO    cn=2,n=6

      740    14383    1   SUPER_TO_PIG.WIDTH = LO_WIDTH;

  14383  3 000143   000000 236000 xsym               LDQ     LO_WIDTH
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:137  
         3 000144   000022 736000                    QLS     18
         3 000145   200050 676100                    ERQ     SUPER_TO_PIG,,AUTO
         3 000146   000377 376003                    ANQ     255,DU
         3 000147   200050 656100                    ERSQ    SUPER_TO_PIG,,AUTO

      741    14384    1   SUPER_TO_PIG.PACKSET = PACKSET.TXT;

  14384  3 000150   040100 100500                    MLR     fill='040'O
         3 000151   100000 200006                    ADSC9   0,,PR1                   cn=1,n=6
         3 000152   200062 400006                    ADSC9   SUPER_TO_PIG+10,,AUTO    cn=2,n=6

      742    14385    1   SUPER_TO_PIG.ACCT = AS_BLANK;

  14385  3 000153   040100 100400                    MLR     fill='040'O
         3 000154   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000155   200064 000010                    ADSC9   SUPER_TO_PIG+12,,AUTO    cn=0,n=8

      743    14386    1   SUPER_TO_PIG.ATTR.COUNT = 0;

  14386  3 000156   000000 220003                    LDX0    0,DU
         3 000157   200066 740100                    STX0    SUPER_TO_PIG+14,,AUTO

      744    14387        /*
      745    14388                                          Try to read the packset record for the project
      746    14389        */
      747    14390    1   PROJ_KEY.TXT.PROJECT = CR_MOD_KEY.TEXT;

  14390  3 000160   040000 100500                    MLR     fill='040'O
         3 000161   000000 200024                    ADSC9   0,,PR0                   cn=1,n=20
         3 000162   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

      748    14391    1   CALL ASB$ENQ_PROJ   ALTRET(ENQ_ERR);

  14391  3 000163   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000164   000000 701000 xent               TSX1    ASB$ENQ_PROJ
         3 000165   002035 702000 3                  TSX2    ENQ_ERR

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:138  
      749    14392    1   CALL ASB$READ_PROJ( OLD_PROJ_REC$, OLD_PROJ_ARS, 3 ) ALTRET(OLD_READ_ERR);

  14392  3 000166   000000 236000 4                  LDQ     0
         3 000167   202352 756100                    STQ     SUPER_TO_PIG+1218,,AUTO
         3 000170   200026 630500                    EPPR0   OLD_PROJ_ARS,,AUTO
         3 000171   202351 450500                    STP0    SUPER_TO_PIG+1217,,AUTO
         3 000172   200025 631500                    EPPR1   OLD_PROJ_REC$,,AUTO
         3 000173   202350 451500                    STP1    SUPER_TO_PIG+1216,,AUTO
         3 000174   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 000175   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000176   000000 701000 xent               TSX1    ASB$READ_PROJ
         3 000177   000323 702000 3                  TSX2    OLD_READ_ERR

      750    14393    2   IF OLD_PROJ_REC$->AS$PROJ.PROJ_REMOVED THEN DO;

  14393  3 000200   200025 470500                    LDP0    OLD_PROJ_REC$,,AUTO
         3 000201   000005 236100                    LDQ     5,,PR0
         3 000202   200000 316003                    CANQ    65536,DU
         3 000203   000264 600000 3                  TZE     s:14421

      751    14394    2      IF OLD_PROJ_REC$->AS$PROJ.NUM_ACCTS = 0 THEN GOTO NEW_PROJ_REC;

  14394  3 000204   000013 235100                    LDA     11,,PR0
         3 000205   000327 600000 3                  TZE     NEW_PROJ_REC

      752    14395        /*E* ERROR:   ASA-E$PREV_PROJ_REC-C
      753    14396        MESSAGE: File management accounts still exist on DP#%U1 for a previous
      754    14397                 "%U2" project.  These accounts must be deleted before the
      755    14398                 packset DP#%U1 can be specified for a new "%U2" project.
      756    14399        */
      757    14400    2      AS_FIELD1 = PACKSET;

  14400  3 000206   200004 471500                    LDP1    @PACKSET,,AUTO
         3 000207   000000 100500                    MLR     fill='000'O
         3 000210   100000 000007                    ADSC9   0,,PR1                   cn=0,n=7
         3 000211   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:139  
      758    14401    2      CALL INDEX( J, AS_BLANK, SUBSTR(CR_MOD_KEY.TEXT,0,8) );

  14401  3 000212   200003 473500                    LDP3    @CR_MOD_KEY,,AUTO
         3 000213   000000 124500                    SCM     mask='000'O
         3 000214   300000 200010                    ADSC9   0,,PR3                   cn=1,n=8
         3 000215   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000216   200020 000100                    ARG     J,,AUTO

      759    14402    2     CALL CONCAT( AS_FIELD2.TEXT, SUBSTR(CR_MOD_KEY.TEXT,0,J), ',', SUBSTR(CR_MOD_KEY.
             14402               TEXT,8,CR_MOD_KEY.COUNT-8));

  14402  3 000217   000100 101500                    MRL     fill='000'O
         3 000220   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         3 000221   202350 000002                    ADSC9   SUPER_TO_PIG+1216,,AUTO  cn=0,n=2
         3 000222   202350 220100                    LDX0    SUPER_TO_PIG+1216,,AUTO
         3 000223   777770 621010                    EAX1    -8,X0
         3 000224   200020 722100                    LXL2    J,,AUTO
         3 000225   040000 100540                    MLR     fill='040'O
         3 000226   300000 200012                    ADSC9   0,,PR3                   cn=1,n=*X2
         3 000227   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         3 000230   200020 236100                    LDQ     J,,AUTO
         3 000231   000050 116007                    CMPQ    40,DL
         3 000232   000247 605000 3                  TPL     s:14403
         3 000233   777727 623006                    EAX3    -41,QL
         3 000234   777777 663003                    ERX3    -1,DU
         3 000235   040046 100400                    MLR     fill='040'O
         3 000236   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 000237   000000 200013 xsym               ADSC9   AS_FIELD2,Q              cn=1,n=*X3
         3 000240   000047 116007                    CMPQ    39,DL
         3 000241   000247 605000 3                  TPL     s:14403
         3 000242   777730 624006                    EAX4    -40,QL
         3 000243   777777 664003                    ERX4    -1,DU
         3 000244   040046 100540                    MLR     fill='040'O
         3 000245   300002 200011                    ADSC9   2,,PR3                   cn=1,n=*X1
         3 000246   000000 400014 xsym               ADSC9   AS_FIELD2,Q              cn=2,n=*X4

      760    14403    2      AS_FIELD2.COUNT = CR_MOD_KEY.COUNT - 7 + J;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:140  

  14403  3 000247   000100 101500                    MRL     fill='000'O
         3 000250   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         3 000251   202350 000004                    ADSC9   SUPER_TO_PIG+1216,,AUTO  cn=0,n=4
         3 000252   202350 236100                    LDQ     SUPER_TO_PIG+1216,,AUTO
         3 000253   200020 036100                    ADLQ    J,,AUTO
         3 000254   000007 136007                    SBLQ    7,DL
         3 000255   000033 736000                    QLS     27
         3 000256   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      761    14404           %SCREAM( ERR#=E$PREV_PROJ_REC, LEVEL=ERROR, MID='A' );

  14416  3 000257   000006 630400 4                  EPPR0   6
         3 000260   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000261   000000 701000 xent               TSX1    ASH$ERROR
         3 000262   000000 011000                    NOP     0

      762    14419    2      RETURN;

  14419  3 000263   000000 702200 xent               TSX2  ! X66_ARET

      763    14420    2      END;
      764    14421    1   PROJ_ACCT_SIZEC = OLD_PROJ_ARS - SIZEC(AS$PROJ_HEADER)

  14421  3 000264   000014 236100                    LDQ     12,,PR0
         3 000265   000022 772000                    QRL     18
         3 000266   000005 036007                    ADLQ    5,DL
         3 000267   000002 772000                    QRL     2
         3 000270   000002 736000                    QLS     2
         3 000271   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 000272   000001 036007                    ADLQ    1,DL
         3 000273   200026 036100                    ADLQ    OLD_PROJ_ARS,,AUTO
         3 000274   000060 136007                    SBLQ    48,DL
         3 000275   200030 756100                    STQ     PROJ_ACCT_SIZEC,,AUTO

      765    14422    1        - (((OLD_PROJ_REC$->AS$PROJ.ATTRIBUTES.COUNT + 5)/4)*4);
      766    14423    1   PROJ_ACCT$ = PINCRC( OLD_PROJ_REC$, OLD_PROJ_ARS-PROJ_ACCT_SIZEC );
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:141  

  14423  3 000276   200026 236100                    LDQ     OLD_PROJ_ARS,,AUTO
         3 000277   200030 136100                    SBLQ    PROJ_ACCT_SIZEC,,AUTO
         3 000300   000020 736000                    QLS     16
         3 000301   200025 036100                    ADLQ    OLD_PROJ_REC$,,AUTO
         3 000302   200027 756100                    STQ     PROJ_ACCT$,,AUTO

      767    14424    1   NEW_PROJ_REC = AS_FALSE ;

  14424  3 000303   000000 236000 xsym               LDQ     AS_FALSE
         3 000304   400000 376003                    ANQ     -131072,DU
         3 000305   200023 756100                    STQ     NEW_PROJ_REC,,AUTO

      768    14425    1   AS_PROJ_HEADER$ -> AS$PROJ_HEADER = OLD_PROJ_REC$ -> AS$PROJ_HEADER ;

  14425  3 000306   000000 471400 xsym               LDP1    AS_PROJ_HEADER$
         3 000307   000100 100500                    MLR     fill='000'O
         3 000310   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48
         3 000311   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

      769    14426    1   SUPER_TO_PIG.ATTR.COUNT = OLD_PROJ_REC$ -> AS$PROJ.ATTRIBUTES.COUNT;

  14426  3 000312   200025 470500                    LDP0    OLD_PROJ_REC$,,AUTO
         3 000313   000014 220100                    LDX0    12,,PR0
         3 000314   200066 740100                    STX0    SUPER_TO_PIG+14,,AUTO

      770    14427    1   SUPER_TO_PIG.ATTR.LIST  = OLD_PROJ_REC$ -> AS$PROJ.ATTRIBUTES.TEXT;

  14427  3 000315   000014 221100                    LDX1    12,,PR0
         3 000316   011300 222003                    LDX2    4800,DU
         3 000317   040140 100540                    MLR     fill='040'O
         3 000320   000014 400011                    ADSC9   12,,PR0                  cn=2,n=*X1
         3 000321   200066 400012                    ADSC9   SUPER_TO_PIG+14,,AUTO    cn=2,n=*X2

      771    14428    2   DO WHILE( '0'B );

  14428  3 000322   000410 710000 3                  TRA     s:14469
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:142  

      772    14429    2   OLD_READ_ERR:
      773    14430    2      IF MERR_CODE.CODE = %E$NOKEY

  14430  3 000323   000000 236000 xsym  OLD_READ_ERR LDQ     ERR_CODE
         3 000324   377770 376007                    ANQ     131064,DL
         3 000325   001020 116007                    CMPQ    528,DL
         3 000326   000371 601000 3                  TNZ     s:14446

      774    14431    3      THEN DO;                    /* Initialize the new record */

      775    14432    3   NEW_PROJ_REC:
      776    14433    3         AS_PROJ_HEADER$ -> AS$PROJ_HEADER = AS_CONSTANT_PROJ_HEADER;

  14433  3 000327   000000 470400 xsym  NEW_PROJ_REC LDP0    AS_PROJ_HEADER$
         3 000330   000100 100400                    MLR     fill='000'O
         3 000331   000000 000060 xsym               ADSC9   AS_CONSTANT_PROJ_HEADER  cn=0,n=48
         3 000332   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48

      777    14434    4         IF AS_CR_MOD_PROJ > 0 THEN DO;

  14434  3 000333   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 000334   000356 604400 3                  TMOZ    s:14441

      778    14435    4            AS$PROJ.CREATOR = AS_PROJECT_ADMIN.TEXT;

  14435  3 000335   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 000336   040100 100400                    MLR     fill='040'O
         3 000337   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 000340   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      779    14436    4            AS$PROJ.SKELETON = DSEG3$ -> AS$PROJ.SKELETON;

  14436  3 000341   000000 470400 xsym               LDP0    DSEG3$
         3 000342   000000 471400 xsym               LDP1    AS_PROJ_HEADER$
         3 000343   040100 100500                    MLR     fill='040'O
         3 000344   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:143  
         3 000345   100010 000010                    ADSC9   8,,PR1                   cn=0,n=8

      780    14437    4            SUPER_TO_PIG.ATTR.COUNT = DSEG3$ -> AS$PROJ.ATTRIBUTES.COUNT;

  14437  3 000346   000014 220100                    LDX0    12,,PR0
         3 000347   200066 740100                    STX0    SUPER_TO_PIG+14,,AUTO

      781    14438    4            SUPER_TO_PIG.ATTR.LIST  = DSEG3$ -> AS$PROJ.ATTRIBUTES.TEXT;

  14438  3 000350   000014 221100                    LDX1    12,,PR0
         3 000351   011300 222003                    LDX2    4800,DU
         3 000352   040140 100540                    MLR     fill='040'O
         3 000353   000014 400011                    ADSC9   12,,PR0                  cn=2,n=*X1
         3 000354   200066 400012                    ADSC9   SUPER_TO_PIG+14,,AUTO    cn=2,n=*X2

      782    14439    4            END;

  14439  3 000355   000362 710000 3                  TRA     s:14442

      783    14440    3         ELSE
      784    14441    3            AS$PROJ.CREATOR = AS_BLANK;

  14441  3 000356   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 000357   040100 100400                    MLR     fill='040'O
         3 000360   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000361   000000 000024                    ADSC9   0,,PR0                   cn=0,n=20

      785    14442    3         AS$PROJ.ATTRIBUTES.COUNT = 0;

  14442  3 000362   000000 220003                    LDX0    0,DU
         3 000363   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 000364   000014 740100                    STX0    12,,PR0

      786    14443    3         NEW_PROJ_REC = AS_TRUE;

  14443  3 000365   000000 236000 xsym               LDQ     AS_TRUE
         3 000366   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:144  
         3 000367   200023 756100                    STQ     NEW_PROJ_REC,,AUTO

      787    14444    3         END;

  14444  3 000370   000410 710000 3                  TRA     s:14469

      788    14445    3      ELSE DO;

      789    14446    3         CALL ASH$ERROR( ERR_CODE );

  14446  3 000371   000003 630400 4                  EPPR0   3
         3 000372   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000373   000000 701000 xent               TSX1    ASH$ERROR
         3 000374   000000 011000                    NOP     0

      790    14447    3         AS_FIELD1 = PROJ_KEY;

  14447  3 000375   000000 100400                    MLR     fill='000'O
         3 000376   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27
         3 000377   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      791    14448              %SCREAM( ERR#=E$UNABLE_TO_READ_PROJ,MID='A',LEVEL=INFO);

  14456  3 000400   000004 630400 4                  EPPR0   4
         3 000401   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000402   000000 701000 xent               TSX1    ASH$INFO
         3 000403   000000 011000                    NOP     0

      792    14463    3         CALL ASB$DEQ_PROJ;

  14463  3 000404   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000405   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         3 000406   000000 011000                    NOP     0

      793    14464    3         RETURN;

  14464  3 000407   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:145  

      794    14465    3         END;
      795    14466    2      END;

      796    14467                                                                      /**/
      797    14468                                                                      /**/
      798    14469    1   MORE = AS_TRUE;

  14469  3 000410   000000 236000 xsym               LDQ     AS_TRUE
         3 000411   400000 376003                    ANQ     -131072,DU
         3 000412   200024 756100                    STQ     MORE,,AUTO

      799    14470    1   REMEMBER PACK_LOOP IN REMEM_VAR;

  14470  3 000413   000416 635000 3                  EAA     PACK_LOOP
         3 000414   000000 452400 xsym               STP2    REMEM_VAR
         3 000415   000001 755000 xsym               STA     REMEM_VAR+1

      800    14471    1   PACK_LOOP:
      801    14472    1   P_PCB.ROOT$ = ADDR(PROJ_PACKSET_LIST);

  14472  3 000416   000007 236000 4     PACK_LOOP    LDQ     7
         3 000417   000001 756000 xsym               STQ     P_PCB+1

      802    14473                                                              /*  Set prompt  */
      803    14474    1   CALL ASB$SET_PROMPT ( %PROMPT_OPT ) ;

  14474  3 000420   000010 630400 4                  EPPR0   8
         3 000421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000422   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000423   000000 011000                    NOP     0

      804    14475    2   DO WHILE ( MORE );

  14475  3 000424   200024 234100                    SZN     MORE,,AUTO
         3 000425   001644 605000 3                  TPL     s:14971

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:146  
      805    14476    2      CALL ASB$READ_SI(IN_BUF,ARS) ;             /* Read option line */

  14476  3 000426   200005 630500                    EPPR0   ARS,,AUTO
         3 000427   202351 450500                    STP0    SUPER_TO_PIG+1217,,AUTO
         3 000430   000011 236000 4                  LDQ     9
         3 000431   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 000432   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 000433   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000434   000000 701000 xent               TSX1    ASB$READ_SI
         3 000435   000000 011000                    NOP     0

      806    14477    2      P_PCB.NCHARS = ARS ;

  14477  3 000436   200005 235100                    LDA     ARS,,AUTO
         3 000437   000011 755000 xsym               STA     P_PCB+9

      807    14478    2      CALL X$PARSE(P_PCB) ALTRET (OPTION_ERR) ;

  14478  3 000440   000012 630400 4                  EPPR0   10
         3 000441   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000442   000000 701000 xent               TSX1    X$PARSE
         3 000443   001636 702000 3                  TSX2    OPTION_ERR

      808    14479                                                              /**/
      809    14480    2      NODE$ = P_PCB.OUT$ ;

  14480  3 000444   000003 236000 xsym               LDQ     P_PCB+3
         3 000445   000000 756000 xsym               STQ     NODE$

      810    14481                                                              /**/
      811    14482                                                              /**/
      812    14483    2      CODE = P$NODE.CODE ;

  14483  3 000446   000000 470400 xsym               LDP0    NODE$
         3 000447   000000 236100                    LDQ     0,,PR0
         3 000450   777777 376007                    ANQ     -1,DL
         3 000451   000000 756000 xsym               STQ     CODE
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:147  

      813    14484    2      SUBNODES = P$NODE.SUBNODES ;

  14484  3 000452   000001 236100                    LDQ     1,,PR0
         3 000453   000022 772000                    QRL     18
         3 000454   200006 756100                    STQ     SUBNODES,,AUTO

      814    14485                                                              /**/
      815    14486    3      DO I = 0 TO SUBNODES-1 ;

  14486  3 000455   200017 450100                    STZ     I,,AUTO
         3 000456   001632 710000 3                  TRA     PACK_LOOP_END+1

      816    14487    3         SUBND$ = P$NODE.SUBLK$(I) ;

  14487  3 000457   000000 470400 xsym               LDP0    NODE$
         3 000460   200017 720100                    LXL0    I,,AUTO
         3 000461   000003 236110                    LDQ     3,X0,PR0
         3 000462   200007 756100                    STQ     SUBND$,,AUTO

      817    14488    3         CODE = SUBND$ -> P$NODE.CODE ;

  14488  3 000463   200007 471500                    LDP1    SUBND$,,AUTO
         3 000464   100000 236100                    LDQ     0,,PR1
         3 000465   777777 376007                    ANQ     -1,DL
         3 000466   000000 756000 xsym               STQ     CODE

      818    14489                                                              /**/
      819    14490    4         DO SELECT (CODE) ;

  14490  3 000467   000454 116007                    CMPQ    300,DL
         3 000470   000500 602000 3                  TNC     s:14490+9
         3 000471   000535 600000 3                  TZE     s:14500
         3 000472   000455 116007                    CMPQ    301,DL
         3 000473   001631 602000 3                  TNC     PACK_LOOP_END
         3 000474   000541 600000 3                  TZE     s:14503
         3 000475   000456 116007                    CMPQ    302,DL
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:148  
         3 000476   001631 601000 3                  TNZ     PACK_LOOP_END
         3 000477   000531 710000 3                  TRA     s:14497
         3 000500   000046 116007                    CMPQ    38,DL
         3 000501   000514 602000 3                  TNC     s:14490+21
         3 000502   000726 600000 3                  TZE     s:14635
         3 000503   000050 116007                    CMPQ    40,DL
         3 000504   000511 602000 3                  TNC     s:14490+18
         3 000505   001544 600000 3                  TZE     s:14926
         3 000506   000051 116007                    CMPQ    41,DL
         3 000507   001631 601000 3                  TNZ     PACK_LOOP_END
         3 000510   001440 710000 3                  TRA     s:14885
         3 000511   000047 116007                    CMPQ    39,DL
         3 000512   001631 601000 3                  TNZ     PACK_LOOP_END
         3 000513   001121 710000 3                  TRA     s:14766
         3 000514   000032 116007                    CMPQ    26,DL
         3 000515   000522 602000 3                  TNC     s:14490+27
         3 000516   000525 600000 3                  TZE     s:14494
         3 000517   000045 116007                    CMPQ    37,DL
         3 000520   001631 601000 3                  TNZ     PACK_LOOP_END
         3 000521   000545 710000 3                  TRA     s:14506
         3 000522   000014 116007                    CMPQ    12,DL
         3 000523   001631 601000 3                  TNZ     PACK_LOOP_END
         3 000524   000525 710000 3                  TRA     s:14494

      820    14491                                                              /**/
      821    14492    4            SELECT(12   /*  END_VAL  */, 26   /*  BLANK_LINE_VAL */) ;

      822    14493                                                          /* End or blank input */
      823    14494    4            MORE = AS_FALSE ;

  14494  3 000525   000000 236000 xsym               LDQ     AS_FALSE
         3 000526   400000 376003                    ANQ     -131072,DU
         3 000527   200024 756100                    STQ     MORE,,AUTO
         3 000530   001631 710000 3                  TRA     PACK_LOOP_END

      824    14495                                                              /**/
      825    14496    4            SELECT(302 /* HELP_VAL */) ;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:149  

      826    14497    4            CALL ASH$HELP ;

  14497  3 000531   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000532   000000 701000 xent               TSX1    ASH$HELP
         3 000533   000000 011000                    NOP     0
         3 000534   001631 710000 3                  TRA     PACK_LOOP_END

      827    14498                                                              /**/
      828    14499    4            SELECT(300 /* DQUESTION_VAL */) ;

      829    14500    4            CALL ASH$DQUEST ;

  14500  3 000535   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000536   000000 701000 xent               TSX1    ASH$DQUEST
         3 000537   000000 011000                    NOP     0
         3 000540   001631 710000 3                  TRA     PACK_LOOP_END

      830    14501                                                              /**/
      831    14502    4            SELECT(301 /* QUESTION_VAL */) ;

      832    14503    4            CALL ASH$QUEST ;

  14503  3 000541   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000542   000000 701000 xent               TSX1    ASH$QUEST
         3 000543   000000 011000                    NOP     0
         3 000544   001631 710000 3                  TRA     PACK_LOOP_END

      833    14504        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:150  
      834    14505    4            SELECT( 37 /* PROJ MAX GRANS - THIS PACKSET */ ) ;

      835    14506    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );

  14506  3 000545   100003 473500                    LDP3    3,,PR1
         3 000546   300004 236100                    LDQ     4,,PR3
         3 000547   000033 772000                    QRL     27
         3 000550   000000 621006                    EAX1    0,QL
         3 000551   000100 305540                    DTB
         3 000552   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         3 000553   200036 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      836    14507    4            IF NOT NEW_PROJ_REC  AND  VAL < AS$PROJ.GRANS_ACCUM

  14507  3 000554   200023 234100                    SZN     NEW_PROJ_REC,,AUTO
         3 000555   000606 604000 3                  TMI     s:14565
         3 000556   000000 473400 xsym               LDP3    AS_PROJ_HEADER$
         3 000557   200036 236100                    LDQ     VAL,,AUTO
         3 000560   300007 116100                    CMPQ    7,,PR3
         3 000561   000606 605000 3                  TPL     s:14565

      837    14508    5            THEN DO;

      838    14509        /*E* ERROR: ASA-E$GRANS_TOO_SMALL-C
      839    14510        MESSAGE: GRANULES cannot be set less than the number of granules already
      840    14511                accumulated on packset DP#%U2 by this project.  Setting GRANULES to %U1.
      841    14512        MESSAGE1: %U1 granules have already been accumulated on packset DP#%U2 by this
      842    14513                  project.  You cannot set GRANULES to a value which is less than the
      843    14514                  then the number of granules already accumulated by the project.
      844    14515                  GRANULES is set to %U1.
      845    14516        */
      846    14517    5               VAL = AS$PROJ.GRANS_ACCUM;

  14517  3 000562   300007 235100                    LDA     7,,PR3
         3 000563   200036 755100                    STA     VAL,,AUTO

      847    14518                    %NUMBER( NUM1=VAL );
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:151  
             14526    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );

  14526  3 000564   200036 634500                    EPPR4   VAL,,AUTO
         3 000565   202353 454500                    STP4    SUPER_TO_PIG+1219,,AUTO
         3 000566   000013 236000 4                  LDQ     11
         3 000567   202352 756100                    STQ     SUPER_TO_PIG+1218,,AUTO
         3 000570   000014 237000 4                  LDAQ    12
         3 000571   202350 757100                    STAQ    SUPER_TO_PIG+1216,,AUTO
         3 000572   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 000573   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000574   000000 701000 xent               TSX1    ASB$BINCHAR
         3 000575   000000 011000                    NOP     0

      848    14548    5               AS_FIELD2 = PACKSET;

  14548  3 000576   200004 470500                    LDP0    @PACKSET,,AUTO
         3 000577   000000 100500                    MLR     fill='000'O
         3 000600   000000 000007                    ADSC9   0,,PR0                   cn=0,n=7
         3 000601   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

      849    14549                    %SCREAM( ERR#=E$GRANS_TOO_SMALL, MID='A', LEVEL=ERROR );

  14561  3 000602   000016 630400 4                  EPPR0   14
         3 000603   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000604   000000 701000 xent               TSX1    ASH$ERROR
         3 000605   000000 011000                    NOP     0

      850    14564    5               END;

      851    14565    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  14565  3 000606   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 000607   000722 604400 3                  TMOZ    s:14632

      852    14566    5               IF NEW_PROJ_REC THEN

  14566  3 000610   200023 234100                    SZN     NEW_PROJ_REC,,AUTO
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:152  
         3 000611   000615 605000 3                  TPL     s:14569

      853    14567    5                  DELTA = VAL;

  14567  3 000612   200036 236100                    LDQ     VAL,,AUTO
         3 000613   200037 756100                    STQ     DELTA,,AUTO
         3 000614   000621 710000 3                  TRA     s:14570

      854    14568    5               ELSE
      855    14569    5                  DELTA = VAL - AS$PROJ.MAX_NUM_GRANS;

  14569  3 000615   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 000616   200036 236100                    LDQ     VAL,,AUTO
         3 000617   000006 136100                    SBLQ    6,,PR0
         3 000620   200037 756100                    STQ     DELTA,,AUTO

      856    14570    5               IF DSEG3$->AS$PROJ.GRANS_ACCUM + DELTA > DSEG3$->AS$PROJ.MAX_NUM_GRANS

  14570  3 000621   000000 470400 xsym               LDP0    DSEG3$
         3 000622   000007 036100                    ADLQ    7,,PR0
         3 000623   000717 604000 3                  TMI     s:14630
         3 000624   000006 116100                    CMPQ    6,,PR0
         3 000625   000717 602000 3                  TNC     s:14630
         3 000626   000717 600000 3                  TZE     s:14630

      857    14571    6               THEN DO;

      858    14572        /*E* ERROR: ASA-E$TOO_MANY_GRANS-C
      859    14573        MESSAGE: Maximum number of granules exceeded for project %U1 on
      860    14574                 packset DP#%U2.  GRANULES = %U3 is the most that can be specified.
      861    14575        */
      862    14576    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );

  14576  3 000627   000000 124400                    SCM     mask='000'O
         3 000630   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 000631   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000632   200020 000100                    ARG     J,,AUTO
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:153  

      863    14577    6                  CALL CONCAT( AS_FIELD1.TEXT,

  14577  3 000633   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 000634   000033 772000                    QRL     27
         3 000635   777770 620006                    EAX0    -8,QL
         3 000636   200020 721100                    LXL1    J,,AUTO
         3 000637   040000 100440                    MLR     fill='040'O
         3 000640   000000 200011 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X1
         3 000641   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         3 000642   200020 236100                    LDQ     J,,AUTO
         3 000643   000050 116007                    CMPQ    40,DL
         3 000644   000661 605000 3                  TPL     s:14580
         3 000645   777727 622006                    EAX2    -41,QL
         3 000646   777777 662003                    ERX2    -1,DU
         3 000647   040046 100400                    MLR     fill='040'O
         3 000650   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 000651   000000 200012 xsym               ADSC9   AS_FIELD1,Q              cn=1,n=*X2
         3 000652   000047 116007                    CMPQ    39,DL
         3 000653   000661 605000 3                  TPL     s:14580
         3 000654   777730 623006                    EAX3    -40,QL
         3 000655   777777 663003                    ERX3    -1,DU
         3 000656   040046 100440                    MLR     fill='040'O
         3 000657   000002 200010 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=*X0
         3 000660   000000 400013 xsym               ADSC9   AS_FIELD1,Q              cn=2,n=*X3

      864    14578    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      865    14579    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
      866    14580    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;

  14580  3 000661   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 000662   000033 772000                    QRL     27
         3 000663   200020 036100                    ADLQ    J,,AUTO
         3 000664   000007 136007                    SBLQ    7,DL
         3 000665   000033 736000                    QLS     27
         3 000666   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:154  
      867    14581    6                  AS_FIELD2 = PACKSET;

  14581  3 000667   200004 471500                    LDP1    @PACKSET,,AUTO
         3 000670   000000 100500                    MLR     fill='000'O
         3 000671   100000 000007                    ADSC9   0,,PR1                   cn=0,n=7
         3 000672   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

      868    14582    6                 DELTA = DSEG3$->AS$PROJ.MAX_NUM_GRANS - DSEG3$->AS$PROJ.GRANS_ACCUM +
             14582                           AS$PROJ.MAX_NUM_GRANS;

  14582  3 000673   000006 236100                    LDQ     6,,PR0
         3 000674   000007 136100                    SBLQ    7,,PR0
         3 000675   000000 473400 xsym               LDP3    AS_PROJ_HEADER$
         3 000676   300006 036100                    ADLQ    6,,PR3
         3 000677   200037 756100                    STQ     DELTA,,AUTO

      869    14583                       %NUMBER( NUM3=DELTA );
             14607    6         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, DELTA );

  14607  3 000700   200037 634500                    EPPR4   DELTA,,AUTO
         3 000701   202353 454500                    STP4    SUPER_TO_PIG+1219,,AUTO
         3 000702   000020 236000 4                  LDQ     16
         3 000703   202352 756100                    STQ     SUPER_TO_PIG+1218,,AUTO
         3 000704   000022 237000 4                  LDAQ    18
         3 000705   202350 757100                    STAQ    SUPER_TO_PIG+1216,,AUTO
         3 000706   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 000707   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000710   000000 701000 xent               TSX1    ASB$BINCHAR
         3 000711   000000 011000                    NOP     0

      870    14613                       %SCREAM( ERR#=E$TOO_MANY_GRANS,MID='A',LEVEL=ERROR );

  14625  3 000712   000024 630400 4                  EPPR0   20
         3 000713   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000714   000000 701000 xent               TSX1    ASH$ERROR
         3 000715   000000 011000                    NOP     0

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:155  
      871    14628    6                  GOTO PACK_LOOP_END;

  14628  3 000716   001631 710000 3                  TRA     PACK_LOOP_END

      872    14629    6                  END;
      873    14630    5               DSEG3$->AS$PROJ.GRANS_ACCUM = DSEG3$->AS$PROJ.GRANS_ACCUM + DELTA;

  14630  3 000717   000007 236100                    LDQ     7,,PR0
         3 000720   200037 036100                    ADLQ    DELTA,,AUTO
         3 000721   000007 756100                    STQ     7,,PR0

      874    14631    5               END;

      875    14632    4            AS$PROJ.MAX_NUM_GRANS = VAL ;

  14632  3 000722   200036 236100                    LDQ     VAL,,AUTO
         3 000723   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 000724   000006 756100                    STQ     6,,PR0
         3 000725   001631 710000 3                  TRA     PACK_LOOP_END

      876    14633        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:156  
      877    14634    4            SELECT( 38 /* PROJ MAX ACCNTS - THIS PACKSET */ ) ;

      878    14635    4            CALL CHARBIN( VAL, SUBND$->P$NODE.SUBLK$(0)->OUT$SYM.TEXT );

  14635  3 000726   100003 473500                    LDP3    3,,PR1
         3 000727   300004 236100                    LDQ     4,,PR3
         3 000730   000033 772000                    QRL     27
         3 000731   000000 621006                    EAX1    0,QL
         3 000732   000100 305540                    DTB
         3 000733   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         3 000734   200036 000004                    NDSC9   VAL,,AUTO                cn=0,s=lsgnf,sf=0,n=4

      879    14636    4            ACCTS_ACCUM = AS$PROJ.SUB_PROJ_ACCTS + AS$PROJ.NUM_ACCTS;

  14636  3 000735   000000 473400 xsym               LDP3    AS_PROJ_HEADER$
         3 000736   300005 236100                    LDQ     5,,PR3
         3 000737   777777 376007                    ANQ     -1,DL
         3 000740   300013 036100                    ADLQ    11,,PR3
         3 000741   200033 756100                    STQ     ACCTS_ACCUM,,AUTO

      880    14637    4            IF NOT NEW_PROJ_REC  AND  VAL < ACCTS_ACCUM

  14637  3 000742   200023 234100                    SZN     NEW_PROJ_REC,,AUTO
         3 000743   000773 604000 3                  TMI     s:14695
         3 000744   000000 116003                    CMPQ    0,DU
         3 000745   000750 604000 3                  TMI     s:14647
         3 000746   200036 116100                    CMPQ    VAL,,AUTO
         3 000747   000773 604400 3                  TMOZ    s:14695

      881    14638    5            THEN DO;

      882    14639        /*E* ERROR: ASA-E$F_ACCTS_TOO_SMALL-C
      883    14640        MESSAGE: ACCOUNTS cannot be set less than the number of accounts already
      884    14641                accumulated on packset DP#%U2 by this project.  Setting ACCOUNTS to %U1.
      885    14642        MESSAGE1: %U1 accounts have already been accumulated on packset DP#%U2
      886    14643                  by this project. You cannot set ACCOUNTS to a value which is less than
      887    14644                  the number of accounts already accumulated by the project.
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:157  
      888    14645                  ACCOUNTS is set to %U1.
      889    14646        */
      890    14647    5               VAL = ACCTS_ACCUM;

  14647  3 000750   200036 756100                    STQ     VAL,,AUTO

      891    14648                    %NUMBER( NUM1=VAL );
             14656    5         CALL ASB$BINCHAR( AS_FIELD1.TEXT, 0, -1, VAL );

  14656  3 000751   200036 634500                    EPPR4   VAL,,AUTO
         3 000752   202353 454500                    STP4    SUPER_TO_PIG+1219,,AUTO
         3 000753   000013 236000 4                  LDQ     11
         3 000754   202352 756100                    STQ     SUPER_TO_PIG+1218,,AUTO
         3 000755   000014 237000 4                  LDAQ    12
         3 000756   202350 757100                    STAQ    SUPER_TO_PIG+1216,,AUTO
         3 000757   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 000760   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000761   000000 701000 xent               TSX1    ASB$BINCHAR
         3 000762   000000 011000                    NOP     0

      892    14678    5               AS_FIELD2 = PACKSET;

  14678  3 000763   200004 470500                    LDP0    @PACKSET,,AUTO
         3 000764   000000 100500                    MLR     fill='000'O
         3 000765   000000 000007                    ADSC9   0,,PR0                   cn=0,n=7
         3 000766   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

      893    14679                    %SCREAM( ERR#=E$F_ACCTS_TOO_SMALL, MID='A', LEVEL=ERROR );

  14691  3 000767   000025 630400 4                  EPPR0   21
         3 000770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000771   000000 701000 xent               TSX1    ASH$ERROR
         3 000772   000000 011000                    NOP     0

      894    14694    5               END;

      895    14695    5            IF AS_CR_MOD_PROJ > 0 THEN DO;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:158  

  14695  3 000773   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 000774   001115 604400 3                  TMOZ    s:14763

      896    14696    5               IF NEW_PROJ_REC THEN

  14696  3 000775   200023 234100                    SZN     NEW_PROJ_REC,,AUTO
         3 000776   001002 605000 3                  TPL     s:14699

      897    14697    5                  DELTA = VAL;

  14697  3 000777   200036 236100                    LDQ     VAL,,AUTO
         3 001000   200037 756100                    STQ     DELTA,,AUTO
         3 001001   001006 710000 3                  TRA     s:14700

      898    14698    5               ELSE
      899    14699    5                  DELTA = VAL - AS$PROJ.MAX_NUM_ACCTS;

  14699  3 001002   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 001003   200036 236100                    LDQ     VAL,,AUTO
         3 001004   000012 136100                    SBLQ    10,,PR0
         3 001005   200037 756100                    STQ     DELTA,,AUTO

      900    14700    5              ACCTS_ACCUM = DSEG3$->AS$PROJ.SUB_PROJ_ACCTS + DSEG3$->AS$PROJ.NUM_ACCTS
             14700                        ;

  14700  3 001006   000000 470400 xsym               LDP0    DSEG3$
         3 001007   000005 236100                    LDQ     5,,PR0
         3 001010   777777 376007                    ANQ     -1,DL
         3 001011   000013 036100                    ADLQ    11,,PR0
         3 001012   200033 756100                    STQ     ACCTS_ACCUM,,AUTO

      901    14701    5               IF ACCTS_ACCUM + DELTA > DSEG3$->AS$PROJ.MAX_NUM_ACCTS

  14701  3 001013   200037 036100                    ADLQ    DELTA,,AUTO
         3 001014   001110 604000 3                  TMI     s:14761
         3 001015   000012 116100                    CMPQ    10,,PR0
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:159  
         3 001016   001110 602000 3                  TNC     s:14761
         3 001017   001110 600000 3                  TZE     s:14761

      902    14702    6               THEN DO;

      903    14703        /*E* ERROR: ASA-E$TOO_MANY_F_ACCTS-C
      904    14704        MESSAGE: Maximum number of accounts exceeded for project %U1 on
      905    14705                 packset DP#%U2.  ACCOUNTS = %U3 is the most that can be specified.
      906    14706        */
      907    14707    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );

  14707  3 001020   000000 124400                    SCM     mask='000'O
         3 001021   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 001022   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001023   200020 000100                    ARG     J,,AUTO

      908    14708    6                  CALL CONCAT( AS_FIELD1.TEXT,

  14708  3 001024   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 001025   000033 772000                    QRL     27
         3 001026   777770 620006                    EAX0    -8,QL
         3 001027   200020 721100                    LXL1    J,,AUTO
         3 001030   040000 100440                    MLR     fill='040'O
         3 001031   000000 200011 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X1
         3 001032   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         3 001033   200020 236100                    LDQ     J,,AUTO
         3 001034   000050 116007                    CMPQ    40,DL
         3 001035   001052 605000 3                  TPL     s:14711
         3 001036   777727 622006                    EAX2    -41,QL
         3 001037   777777 662003                    ERX2    -1,DU
         3 001040   040046 100400                    MLR     fill='040'O
         3 001041   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 001042   000000 200012 xsym               ADSC9   AS_FIELD1,Q              cn=1,n=*X2
         3 001043   000047 116007                    CMPQ    39,DL
         3 001044   001052 605000 3                  TPL     s:14711
         3 001045   777730 623006                    EAX3    -40,QL
         3 001046   777777 663003                    ERX3    -1,DU
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:160  
         3 001047   040046 100440                    MLR     fill='040'O
         3 001050   000002 200010 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=*X0
         3 001051   000000 400013 xsym               ADSC9   AS_FIELD1,Q              cn=2,n=*X3

      909    14709    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      910    14710    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
      911    14711    6                  AS_FIELD1.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;

  14711  3 001052   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 001053   000033 772000                    QRL     27
         3 001054   200020 036100                    ADLQ    J,,AUTO
         3 001055   000007 136007                    SBLQ    7,DL
         3 001056   000033 736000                    QLS     27
         3 001057   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      912    14712    6                  AS_FIELD2 = PACKSET;

  14712  3 001060   200004 471500                    LDP1    @PACKSET,,AUTO
         3 001061   000000 100500                    MLR     fill='000'O
         3 001062   100000 000007                    ADSC9   0,,PR1                   cn=0,n=7
         3 001063   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

      913    14713    6                  DELTA = DSEG3$->AS$PROJ.MAX_NUM_ACCTS - ACCTS_ACCUM + AS$PROJ.
             14713                           MAX_NUM_ACCTS;

  14713  3 001064   000012 236100                    LDQ     10,,PR0
         3 001065   200033 136100                    SBLQ    ACCTS_ACCUM,,AUTO
         3 001066   000000 473400 xsym               LDP3    AS_PROJ_HEADER$
         3 001067   300012 036100                    ADLQ    10,,PR3
         3 001070   200037 756100                    STQ     DELTA,,AUTO

      914    14714                       %NUMBER( NUM3=DELTA );
             14738    6         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, DELTA );

  14738  3 001071   200037 634500                    EPPR4   DELTA,,AUTO
         3 001072   202353 454500                    STP4    SUPER_TO_PIG+1219,,AUTO
         3 001073   000020 236000 4                  LDQ     16
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:161  
         3 001074   202352 756100                    STQ     SUPER_TO_PIG+1218,,AUTO
         3 001075   000022 237000 4                  LDAQ    18
         3 001076   202350 757100                    STAQ    SUPER_TO_PIG+1216,,AUTO
         3 001077   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 001100   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001101   000000 701000 xent               TSX1    ASB$BINCHAR
         3 001102   000000 011000                    NOP     0

      915    14744                       %SCREAM( ERR#=E$TOO_MANY_F_ACCTS,MID='A',LEVEL=ERROR);

  14756  3 001103   000026 630400 4                  EPPR0   22
         3 001104   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001105   000000 701000 xent               TSX1    ASH$ERROR
         3 001106   000000 011000                    NOP     0

      916    14759    6                  GOTO PACK_LOOP_END;

  14759  3 001107   001631 710000 3                  TRA     PACK_LOOP_END

      917    14760    6                  END;
      918    14761    5              DSEG3$->AS$PROJ.SUB_PROJ_ACCTS = DSEG3$->AS$PROJ.SUB_PROJ_ACCTS + DELTA;

  14761  3 001110   000005 236100                    LDQ     5,,PR0
         3 001111   777777 376007                    ANQ     -1,DL
         3 001112   200037 036100                    ADLQ    DELTA,,AUTO
         3 001113   000000 620006                    EAX0    0,QL
         3 001114   000005 440100                    SXL0    5,,PR0

      919    14762    5               END;

      920    14763    4            AS$PROJ.MAX_NUM_ACCTS = VAL ;

  14763  3 001115   200036 236100                    LDQ     VAL,,AUTO
         3 001116   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 001117   000012 756100                    STQ     10,,PR0
         3 001120   001631 710000 3                  TRA     PACK_LOOP_END

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:162  
      921    14764        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:163  
      922    14765    4            SELECT( 39 /* PROJ ACCNT SKELETON - THIS PACKSET */ ) ;

      923    14766    4            BLK$ = SUBND$ -> P$NODE.SUBLK$(0);

  14766  3 001121   100003 236100                    LDQ     3,,PR1
         3 001122   200010 756100                    STQ     BLK$,,AUTO

      924    14767    4            MSKELETON = DSEG3$->AS$PROJ.SKELETON;

  14767  3 001123   000000 473400 xsym               LDP3    DSEG3$
         3 001124   040100 100500                    MLR     fill='040'O
         3 001125   300010 000010                    ADSC9   8,,PR3                   cn=0,n=8
         3 001126   200015 000010                    ADSC9   MSKELETON,,AUTO          cn=0,n=8

      925    14768    4            CNT  = OUT$SYM.COUNT;

  14768  3 001127   200010 474500                    LDP4    BLK$,,AUTO
         3 001130   400004 236100                    LDQ     4,,PR4
         3 001131   000033 772000                    QRL     27
         3 001132   200022 756100                    STQ     CNT,,AUTO

      926    14769    4            IF CNT > 8

  14769  3 001133   000011 116007                    CMPQ    9,DL
         3 001134   001142 602000 3                  TNC     s:14792

      927    14770    5            THEN DO;

      928    14771        /*E* ERROR:   ASA-E$SKELETON_TOO_LONG-C
      929    14772             MESSAGE: SKELETON too long.
      930    14773             MESSAGE1: SKELETON can be at most 8 characters long.
      931    14774        */
      932    14775                    %SCREAM( ERR#=E$SKELETON_TOO_LONG, LEVEL=ERROR, MID='A' );

  14787  3 001135   000027 630400 4                  EPPR0   23
         3 001136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001137   000000 701000 xent               TSX1    ASH$ERROR
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:164  
         3 001140   000000 011000                    NOP     0

      933    14790    5               GOTO PACK_LOOP_END;

  14790  3 001141   001631 710000 3                  TRA     PACK_LOOP_END

      934    14791    5               END;
      935    14792    4            SKELETON = OUT$SYM.TEXT;

  14792  3 001142   000000 621006                    EAX1    0,QL
         3 001143   040100 100540                    MLR     fill='040'O
         3 001144   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         3 001145   200013 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8

      936    14793        /*
      937    14794            find any invalid skeletons
      938    14795        */
      939    14796    4            CHANGE = 0;

  14796  3 001146   200043 450100                    STZ     CHANGE,,AUTO

      940    14797    4            ONE_CHR$ = ADDR (SKELETON);

  14797  3 001147   200013 635500                    EPPR5   SKELETON,,AUTO
         3 001150   200047 455500                    STP5    ONE_CHR$,,AUTO

      941    14798    4            IF ONE_CHR = '?' THEN

  14798  3 001151   040000 106500                    CMPC    fill='040'O
         3 001152   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         3 001153   000030 000001 4                  ADSC9   24                       cn=0,n=1
         3 001154   001161 601000 3                  TNZ     s:14801

      942    14799    4               PREVIOUS = AS_TRUE;

  14799  3 001155   000000 236000 xsym               LDQ     AS_TRUE
         3 001156   400000 376003                    ANQ     -131072,DU
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:165  
         3 001157   200044 756100                    STQ     PREVIOUS,,AUTO
         3 001160   001164 710000 3                  TRA     s:14802

      943    14800    4            ELSE
      944    14801    4               PREVIOUS = AS_FALSE;

  14801  3 001161   000000 236000 xsym               LDQ     AS_FALSE
         3 001162   400000 376003                    ANQ     -131072,DU
         3 001163   200044 756100                    STQ     PREVIOUS,,AUTO

      945    14802    4            CALL INDEX (L, ' ', SKELETON);

  14802  3 001164   000000 124500                    SCM     mask='000'O
         3 001165   200013 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         3 001166   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001167   200046 000100                    ARG     L,,AUTO

      946    14803    5            DO K = 0 TO L - 1;

  14803  3 001170   200045 450100                    STZ     K,,AUTO
         3 001171   001226 710000 3                  TRA     s:14815+3

      947    14804    5               ONE_CHR$ = PINCRC (ONE_CHR$,1);

  14804  3 001172   200047 236100                    LDQ     ONE_CHR$,,AUTO
         3 001173   200000 036007                    ADLQ    65536,DL
         3 001174   200047 756100                    STQ     ONE_CHR$,,AUTO

      948    14805    5               IF ONE_CHR = '?' AND NOT PREVIOUS THEN

  14805  3 001175   200047 470500                    LDP0    ONE_CHR$,,AUTO
         3 001176   040000 106500                    CMPC    fill='040'O
         3 001177   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         3 001200   000030 000001 4                  ADSC9   24                       cn=0,n=1
         3 001201   001211 601000 3                  TNZ     s:14811
         3 001202   200044 234100                    SZN     PREVIOUS,,AUTO
         3 001203   001211 604000 3                  TMI     s:14811
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:166  

      949    14806    6               DO;

      950    14807    6                  PREVIOUS = AS_TRUE;

  14807  3 001204   000000 236000 xsym               LDQ     AS_TRUE
         3 001205   400000 376003                    ANQ     -131072,DU
         3 001206   200044 756100                    STQ     PREVIOUS,,AUTO

      951    14808    6                  CHANGE = CHANGE + 1;

  14808  3 001207   200043 054100                    AOS     CHANGE,,AUTO

      952    14809    6                  END;

  14809  3 001210   001223 710000 3                  TRA     s:14815

      953    14810    5               ELSE
      954    14811    6                  IF ONE_CHR ~= '?' AND PREVIOUS THEN DO;

  14811  3 001211   040000 106500                    CMPC    fill='040'O
         3 001212   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         3 001213   000030 000001 4                  ADSC9   24                       cn=0,n=1
         3 001214   001223 600000 3                  TZE     s:14815
         3 001215   200044 234100                    SZN     PREVIOUS,,AUTO
         3 001216   001223 605000 3                  TPL     s:14815

      955    14812    6                     PREVIOUS = AS_FALSE;

  14812  3 001217   000000 236000 xsym               LDQ     AS_FALSE
         3 001220   400000 376003                    ANQ     -131072,DU
         3 001221   200044 756100                    STQ     PREVIOUS,,AUTO

      956    14813    6                     CHANGE = CHANGE + 1;

  14813  3 001222   200043 054100                    AOS     CHANGE,,AUTO

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:167  
      957    14814    6                     END;

      958    14815    5               END; /*  Do k  */

  14815  3 001223   200045 235100                    LDA     K,,AUTO
         3 001224   000001 035007                    ADLA    1,DL
         3 001225   200045 755100                    STA     K,,AUTO
         3 001226   200045 236100                    LDQ     K,,AUTO
         3 001227   001232 604000 3                  TMI     s:14816
         3 001230   200046 116100                    CMPQ    L,,AUTO
         3 001231   001172 604000 3                  TMI     s:14804

      959    14816    5            IF CHANGE > 3 THEN DO;

  14816  3 001232   200043 235100                    LDA     CHANGE,,AUTO
         3 001233   000003 115007                    CMPA    3,DL
         3 001234   001250 604400 3                  TMOZ    s:14841

      960    14817        /*E* ERROR:   ASA-E$ILLEGAL_SKELETON-C
      961    14818             MESSAGE: Illegal SKELETON.
      962    14819             MESSAGE1: %U1 is an invalid SKELETON.
      963    14820                       Examples of valid SKELETONs are:  A, A?, A?B, ?A, ?A?, ?
      964    14821        */
      965    14822    5               AS_FIELD1.COUNT = CNT;

  14822  3 001235   200022 236100                    LDQ     CNT,,AUTO
         3 001236   000033 736000                    QLS     27
         3 001237   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      966    14823    5               AS_FIELD1.TEXT  = SKELETON;

  14823  3 001240   040000 100500                    MLR     fill='040'O
         3 001241   200013 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         3 001242   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      967    14824                    %SCREAM( ERR#=E$ILLEGAL_SKELETON, MID='A', LEVEL=ERROR );

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:168  
  14836  3 001243   000031 630400 4                  EPPR0   25
         3 001244   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001245   000000 701000 xent               TSX1    ASH$ERROR
         3 001246   000000 011000                    NOP     0

      968    14839    5               GOTO PACK_LOOP_END;

  14839  3 001247   001631 710000 3                  TRA     PACK_LOOP_END

      969    14840    5               END;
      970    14841    5            IF AS_CR_MOD_PROJ > 0 THEN DO;

  14841  3 001250   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 001251   001433 604400 3                  TMOZ    s:14882

      971    14842    5               CALL INDEX (SKELETON_LEN, ' ', SKELETON);

  14842  3 001252   000000 124500                    SCM     mask='000'O
         3 001253   200013 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         3 001254   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001255   200041 000100                    ARG     SKELETON_LEN,,AUTO

      972    14843    5               IF SKELETON_LEN = 0 THEN SKELETON_LEN = 1;

  14843  3 001256   200041 235100                    LDA     SKELETON_LEN,,AUTO
         3 001257   001262 601000 3                  TNZ     s:14844

  14843  3 001260   000001 235007                    LDA     1,DL
         3 001261   200041 755100                    STA     SKELETON_LEN,,AUTO

      973    14844    5               CALL INDEX (MSKEL_LEN, ' ', MSKELETON);

  14844  3 001262   000000 124500                    SCM     mask='000'O
         3 001263   200015 000010                    ADSC9   MSKELETON,,AUTO          cn=0,n=8
         3 001264   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001265   200042 000100                    ARG     MSKEL_LEN,,AUTO

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:169  
      974    14845    5               IF MSKEL_LEN = 0 THEN MSKEL_LEN = 1;

  14845  3 001266   200042 235100                    LDA     MSKEL_LEN,,AUTO
         3 001267   001272 601000 3                  TNZ     s:14846

  14845  3 001270   000001 235007                    LDA     1,DL
         3 001271   200042 755100                    STA     MSKEL_LEN,,AUTO

      975    14846    5               CALL ASB$WILD_MATCH(SKELETON_LEN, SKELETON, MSKEL_LEN, MSKELETON )
             14846                        ALTRET(NO_MATCH);

  14846  3 001272   200015 630500                    EPPR0   MSKELETON,,AUTO
         3 001273   202353 450500                    STP0    SUPER_TO_PIG+1219,,AUTO
         3 001274   200042 631500                    EPPR1   MSKEL_LEN,,AUTO
         3 001275   202352 451500                    STP1    SUPER_TO_PIG+1218,,AUTO
         3 001276   200013 633500                    EPPR3   SKELETON,,AUTO
         3 001277   202351 453500                    STP3    SUPER_TO_PIG+1217,,AUTO
         3 001300   200041 634500                    EPPR4   SKELETON_LEN,,AUTO
         3 001301   202350 454500                    STP4    SUPER_TO_PIG+1216,,AUTO
         3 001302   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 001303   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001304   000000 701000 xent               TSX1    ASB$WILD_MATCH
         3 001305   001307 702000 3                  TSX2    NO_MATCH

      976    14847    6               IF '0'B THEN DO;

  14847  3 001306   001433 710000 3                  TRA     s:14882

      977    14848        /*E* ERROR:   ASA-E$INCONSIST_SKELETON-C
      978    14849             MESSAGE: "%U1" is inconsistent with the skeleton (%U2) for
      979    14850                      project %U3.
      980    14851        */
      981    14852    6   NO_MATCH:
      982    14853    6                  AS_FIELD1.COUNT = CNT;

  14853  3 001307   200022 236100       NO_MATCH     LDQ     CNT,,AUTO
         3 001310   000033 736000                    QLS     27
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:170  
         3 001311   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      983    14854    6                  AS_FIELD1.TEXT  = SKELETON;

  14854  3 001312   040000 100500                    MLR     fill='040'O
         3 001313   200013 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         3 001314   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      984    14855    6                  CALL INDEX(J, AS_BLANK, MSKELETON );

  14855  3 001315   000000 124500                    SCM     mask='000'O
         3 001316   200015 000010                    ADSC9   MSKELETON,,AUTO          cn=0,n=8
         3 001317   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001320   200020 000100                    ARG     J,,AUTO

      985    14856    6                  AS_FIELD2.COUNT = J;

  14856  3 001321   200020 236100                    LDQ     J,,AUTO
         3 001322   000033 736000                    QLS     27
         3 001323   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      986    14857    6                  AS_FIELD2.TEXT  = MSKELETON;

  14857  3 001324   040000 100500                    MLR     fill='040'O
         3 001325   200015 000010                    ADSC9   MSKELETON,,AUTO          cn=0,n=8
         3 001326   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      987    14858    6                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );

  14858  3 001327   000000 124400                    SCM     mask='000'O
         3 001330   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 001331   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001332   200020 000100                    ARG     J,,AUTO

      988    14859    6                  CALL CONCAT( AS_FIELD3.TEXT,

  14859  3 001333   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:171  
         3 001334   000033 772000                    QRL     27
         3 001335   777770 620006                    EAX0    -8,QL
         3 001336   200020 721100                    LXL1    J,,AUTO
         3 001337   040000 100440                    MLR     fill='040'O
         3 001340   000000 200011 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X1
         3 001341   000000 200050 xsym               ADSC9   AS_FIELD3                cn=1,n=40
         3 001342   200020 236100                    LDQ     J,,AUTO
         3 001343   000050 116007                    CMPQ    40,DL
         3 001344   001413 605000 3                  TPL     s:14863
         3 001345   777727 622006                    EAX2    -41,QL
         3 001346   777777 662003                    ERX2    -1,DU
         3 001347   040046 100400                    MLR     fill='040'O
         3 001350   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 001351   000000 200012 xsym               ADSC9   AS_FIELD3,Q              cn=1,n=*X2
         3 001352   000047 116007                    CMPQ    39,DL
         3 001353   001413 605000 3                  TPL     s:14863
         3 001354   777730 623006                    EAX3    -40,QL
         3 001355   777777 663003                    ERX3    -1,DU
         3 001356   040046 100440                    MLR     fill='040'O
         3 001357   000002 200010 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=*X0
         3 001360   000000 400013 xsym               ADSC9   AS_FIELD3,Q              cn=2,n=*X3
         3 001361   000000 636010                    EAQ     0,X0
         3 001362   000022 772000                    QRL     18
         3 001363   200020 036100                    ADLQ    J,,AUTO
         3 001364   000047 116007                    CMPQ    39,DL
         3 001365   001413 605000 3                  TPL     s:14863
         3 001366   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 001367   000000 636010                    EAQ     0,X0
         3 001370   000022 772000                    QRL     18
         3 001371   200020 036100                    ADLQ    J,,AUTO
         3 001372   202350 720100                    LXL0    SUPER_TO_PIG+1216,,AUTO
         3 001373   777730 620010                    EAX0    -40,X0
         3 001374   777777 660003                    ERX0    -1,DU
         3 001375   040046 100400                    MLR     fill='040'O
         3 001376   000011 000004 2                  ADSC9   9                        cn=0,n=4
         3 001377   000000 400010 xsym               ADSC9   AS_FIELD3,Q              cn=2,n=*X0
         3 001400   202351 756100                    STQ     SUPER_TO_PIG+1217,,AUTO
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:172  
         3 001401   202350 236100                    LDQ     SUPER_TO_PIG+1216,,AUTO
         3 001402   000043 116007                    CMPQ    35,DL
         3 001403   001413 605000 3                  TPL     s:14863
         3 001404   777734 624006                    EAX4    -36,QL
         3 001405   777777 664003                    ERX4    -1,DU
         3 001406   200004 470500                    LDP0    @PACKSET,,AUTO
         3 001407   202351 235100                    LDA     SUPER_TO_PIG+1217,,AUTO
         3 001410   040045 100500                    MLR     fill='040'O
         3 001411   000000 200006                    ADSC9   0,,PR0                   cn=1,n=6
         3 001412   000001 400014 xsym               ADSC9   AS_FIELD3+1,A            cn=2,n=*X4

      989    14860    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
      990    14861    6                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8),
      991    14862    6                       ' DP#', PACKSET.TXT );
      992    14863    6                  AS_FIELD3.COUNT = AS_PROJECT_ADMIN.COUNT + PACKSET.CNT + J - 3;

  14863  3 001413   200004 470500                    LDP0    @PACKSET,,AUTO
         3 001414   000100 101500                    MRL     fill='000'O
         3 001415   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         3 001416   202350 000004                    ADSC9   SUPER_TO_PIG+1216,,AUTO  cn=0,n=4
         3 001417   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 001420   000033 772000                    QRL     27
         3 001421   202350 036100                    ADLQ    SUPER_TO_PIG+1216,,AUTO
         3 001422   200020 036100                    ADLQ    J,,AUTO
         3 001423   000003 136007                    SBLQ    3,DL
         3 001424   000033 736000                    QLS     27
         3 001425   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

      993    14864                       %SCREAM( ERR#=E$INCONSIST_SKELETON, MID='A', LEVEL=ERROR );

  14876  3 001426   000032 630400 4                  EPPR0   26
         3 001427   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001430   000000 701000 xent               TSX1    ASH$ERROR
         3 001431   000000 011000                    NOP     0

      994    14879    6                  GOTO PACK_LOOP_END;

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:173  
  14879  3 001432   001631 710000 3                  TRA     PACK_LOOP_END

      995    14880    6                  END;
      996    14881    5               END;
      997    14882    4            AS$PROJ.SKELETON = SKELETON;

  14882  3 001433   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 001434   040100 100500                    MLR     fill='040'O
         3 001435   200013 000010                    ADSC9   SKELETON,,AUTO           cn=0,n=8
         3 001436   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         3 001437   001631 710000 3                  TRA     PACK_LOOP_END

      998    14883        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:174  
      999    14884    4            SELECT( 41 /* CHANGES TO ACCESSES ALLOWED - THIS PACKSET */ ) ;

     1000    14885    4            IF SUBND$ -> P$NODE.SUBNODES = 0

  14885  3 001440   100001 221100                    LDX1    1,,PR1
         3 001441   001445 601000 3                  TNZ     s:14889

     1001    14886    4            THEN
     1002    14887    4               SUB_CODE = 1   /*  YES_VAL  */ ;

  14887  3 001442   000001 235007                    LDA     1,DL
         3 001443   200021 755100                    STA     SUB_CODE,,AUTO
         3 001444   001451 710000 3                  TRA     s:14890

     1003    14888    4            ELSE
     1004    14889    4               SUB_CODE = SUBND$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE ;

  14889  3 001445   100003 473500                    LDP3    3,,PR1
         3 001446   300000 236100                    LDQ     0,,PR3
         3 001447   777777 376007                    ANQ     -1,DL
         3 001450   200021 756100                    STQ     SUB_CODE,,AUTO

     1005    14890    4            IF SUB_CODE = 1   /*  YES_VAL  */  AND  AS_CR_MOD_PROJ > 0

  14890  3 001451   200021 235100                    LDA     SUB_CODE,,AUTO
         3 001452   000001 115007                    CMPA    1,DL
         3 001453   001532 601000 3                  TNZ     s:14923
         3 001454   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 001455   001532 604400 3                  TMOZ    s:14923

     1006    14891    4            THEN
     1007    14892    4               IF NOT DSEG3$->AS$PROJ.MODIFY_ATTR

  14892  3 001456   000000 473400 xsym               LDP3    DSEG3$
         3 001457   300005 234100                    SZN     5,,PR3
         3 001460   001532 604000 3                  TMI     s:14923

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:175  
     1008    14893    5               THEN DO;

     1009    14894        /*E* ERROR:   ASA-E$CHANGE_ILLEGAL-C
     1010    14895        MESSAGE: You can't specify CHANGE = YES for packset DP#%U1.
     1011    14896        MESSAGE1: CHANGE = YES was not specified for packset DP%U1 when the project
     1012    14897                  "%U2" was created.  So you are not allowed to specify CHANGE = YES for
     1013    14898                  DP#%U1 on projects you create.
     1014    14899        */
     1015    14900    5                  AS_FIELD1 = PACKSET;

  14900  3 001461   200004 474500                    LDP4    @PACKSET,,AUTO
         3 001462   000000 100500                    MLR     fill='000'O
         3 001463   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         3 001464   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1016    14901    5                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );

  14901  3 001465   000000 124400                    SCM     mask='000'O
         3 001466   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 001467   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001470   200020 000100                    ARG     J,,AUTO

     1017    14902    5                  CALL CONCAT( AS_FIELD2.TEXT,

  14902  3 001471   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 001472   000033 772000                    QRL     27
         3 001473   777770 621006                    EAX1    -8,QL
         3 001474   200020 722100                    LXL2    J,,AUTO
         3 001475   040000 100440                    MLR     fill='040'O
         3 001476   000000 200012 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X2
         3 001477   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         3 001500   200020 236100                    LDQ     J,,AUTO
         3 001501   000050 116007                    CMPQ    40,DL
         3 001502   001517 605000 3                  TPL     s:14905
         3 001503   777727 623006                    EAX3    -41,QL
         3 001504   777777 663003                    ERX3    -1,DU
         3 001505   040046 100400                    MLR     fill='040'O
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:176  
         3 001506   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 001507   000000 200013 xsym               ADSC9   AS_FIELD2,Q              cn=1,n=*X3
         3 001510   000047 116007                    CMPQ    39,DL
         3 001511   001517 605000 3                  TPL     s:14905
         3 001512   777730 624006                    EAX4    -40,QL
         3 001513   777777 664003                    ERX4    -1,DU
         3 001514   040046 100440                    MLR     fill='040'O
         3 001515   000002 200011 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=*X1
         3 001516   000000 400014 xsym               ADSC9   AS_FIELD2,Q              cn=2,n=*X4

     1018    14903    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
     1019    14904    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
     1020    14905    5                  AS_FIELD2.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;

  14905  3 001517   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 001520   000033 772000                    QRL     27
         3 001521   200020 036100                    ADLQ    J,,AUTO
         3 001522   000007 136007                    SBLQ    7,DL
         3 001523   000033 736000                    QLS     27
         3 001524   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

     1021    14906                       %SCREAM( ERR#=E$CHANGE_ILLEGAL, MID='A', LEVEL=ERROR);

  14918  3 001525   000033 630400 4                  EPPR0   27
         3 001526   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001527   000000 701000 xent               TSX1    ASH$ERROR
         3 001530   000000 011000                    NOP     0

     1022    14921    5                  GOTO PACK_LOOP_END;

  14921  3 001531   001631 710000 3                  TRA     PACK_LOOP_END

     1023    14922    5                  END;
     1024    14923    4            AS$PROJ.MODIFY_ATTR = ( SUB_CODE = 1   /*  YES_VAL  */ ) ;

  14923  3 001532   400000 222003                    LDX2    -131072,DU
         3 001533   000001 115007                    CMPA    1,DL
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:177  
         3 001534   001536 600000 3                  TZE     s:14923+4
         3 001535   000000 222003                    LDX2    0,DU
         3 001536   000000 473400 xsym               LDP3    AS_PROJ_HEADER$
         3 001537   000000 636012                    EAQ     0,X2
         3 001540   300005 676100                    ERQ     5,,PR3
         3 001541   400000 376003                    ANQ     -131072,DU
         3 001542   300005 656100                    ERSQ    5,,PR3
         3 001543   001631 710000 3                  TRA     PACK_LOOP_END

     1025    14924        %EJECT;
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:178  
     1026    14925    4            SELECT( 40 /* PROJ ACCESS CONTROLS - THIS PACKSET */ ) ;

     1027    14926    4            IF AS_CR_MOD_PROJ > 0

  14926  3 001544   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 001545   001622 604400 3                  TMOZ    s:14959

     1028    14927    4            THEN
     1029    14928    4               IF NOT DSEG3$->AS$PROJ.MODIFY_ATTR

  14928  3 001546   000000 473400 xsym               LDP3    DSEG3$
         3 001547   300005 234100                    SZN     5,,PR3
         3 001550   001622 604000 3                  TMI     s:14959

     1030    14929    5               THEN DO;

     1031    14930        /*E* ERROR:   ASA-E$ATTRIB_ILLEGAL-C
     1032    14931        MESSAGE: You can't specify ATTRIBUTES for packset DP#%U1.
     1033    14932        MESSAGE1: CHANGE = YES was not specified for packset DP%U1 when the project
     1034    14933                  "%U2" was created.  So you are not allowed to specify ATTRIBUTES for
     1035    14934                  DP#%U1 on projects you create.
     1036    14935        */
     1037    14936    5                  AS_FIELD1 = PACKSET;

  14936  3 001551   200004 474500                    LDP4    @PACKSET,,AUTO
         3 001552   000000 100500                    MLR     fill='000'O
         3 001553   400000 000007                    ADSC9   0,,PR4                   cn=0,n=7
         3 001554   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1038    14937    5                  CALL INDEX( J, AS_BLANK, AS_PROJECT_ADMIN.TEXT );

  14937  3 001555   000000 124400                    SCM     mask='000'O
         3 001556   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 001557   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 001560   200020 000100                    ARG     J,,AUTO

     1039    14938    5                  CALL CONCAT( AS_FIELD2.TEXT,
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:179  

  14938  3 001561   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 001562   000033 772000                    QRL     27
         3 001563   777770 621006                    EAX1    -8,QL
         3 001564   200020 722100                    LXL2    J,,AUTO
         3 001565   040000 100440                    MLR     fill='040'O
         3 001566   000000 200012 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=*X2
         3 001567   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40
         3 001570   200020 236100                    LDQ     J,,AUTO
         3 001571   000050 116007                    CMPQ    40,DL
         3 001572   001607 605000 3                  TPL     s:14941
         3 001573   777727 623006                    EAX3    -41,QL
         3 001574   777777 663003                    ERX3    -1,DU
         3 001575   040046 100400                    MLR     fill='040'O
         3 001576   000005 000001 4                  ADSC9   5                        cn=0,n=1
         3 001577   000000 200013 xsym               ADSC9   AS_FIELD2,Q              cn=1,n=*X3
         3 001600   000047 116007                    CMPQ    39,DL
         3 001601   001607 605000 3                  TPL     s:14941
         3 001602   777730 624006                    EAX4    -40,QL
         3 001603   777777 664003                    ERX4    -1,DU
         3 001604   040046 100440                    MLR     fill='040'O
         3 001605   000002 200011 xsym               ADSC9   AS_PROJECT_ADMIN+2       cn=1,n=*X1
         3 001606   000000 400014 xsym               ADSC9   AS_FIELD2,Q              cn=2,n=*X4

     1040    14939    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,0,J), ',',
     1041    14940    5                       SUBSTR(AS_PROJECT_ADMIN.TEXT,8,AS_PROJECT_ADMIN.COUNT-8) );
     1042    14941    5                  AS_FIELD2.COUNT = AS_PROJECT_ADMIN.COUNT - 7 + J;

  14941  3 001607   000000 236000 xsym               LDQ     AS_PROJECT_ADMIN
         3 001610   000033 772000                    QRL     27
         3 001611   200020 036100                    ADLQ    J,,AUTO
         3 001612   000007 136007                    SBLQ    7,DL
         3 001613   000033 736000                    QLS     27
         3 001614   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

     1043    14942                       %SCREAM( ERR#=E$ATTRIB_ILLEGAL, MID='A', LEVEL=ERROR);

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:180  
  14954  3 001615   000034 630400 4                  EPPR0   28
         3 001616   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001617   000000 701000 xent               TSX1    ASH$ERROR
         3 001620   000000 011000                    NOP     0

     1044    14957    5                  GOTO PACK_LOOP_END;

  14957  3 001621   001631 710000 3                  TRA     PACK_LOOP_END

     1045    14958    5                  END;
     1046    14959    4            CALL ASB$PIG_ACCT_ATTR( SUPER_TO_PIG );

  14959  3 001622   200050 633500                    EPPR3   SUPER_TO_PIG,,AUTO
         3 001623   202350 453500                    STP3    SUPER_TO_PIG+1216,,AUTO
         3 001624   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 001625   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001626   000000 701000 xent               TSX1    ASB$PIG_ACCT_ATTR
         3 001627   000000 011000                    NOP     0

     1047    14960    4            GOTO PACK_LOOP;

  14960  3 001630   000416 710000 3                  TRA     PACK_LOOP

     1048    14961                                                              /**/
     1049    14962    4            END;  /* Do case */

     1050    14963    3   PACK_LOOP_END:
     1051    14964    3         END;    /* Do i = 0 to SUBNODES-1; */

  14964  3 001631   200017 054100       PACK_LOOP_E* AOS     I,,AUTO
         3 001632   200017 236100                    LDQ     I,,AUTO
         3 001633   200006 116100                    CMPQ    SUBNODES,,AUTO
         3 001634   000457 604000 3                  TMI     s:14487

     1052    14965    3      DO WHILE( '0'B );

  14965  3 001635   001642 710000 3                  TRA     s:14969
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:181  

     1053    14966    3   OPTION_ERR:
     1054    14967    3         CALL ASH$ERROR( P_PCB.ERROR );

  14967  3 001636   000035 630400 4     OPTION_ERR   EPPR0   29
         3 001637   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001640   000000 701000 xent               TSX1    ASH$ERROR
         3 001641   000000 011000                    NOP     0

     1055    14968    3         END;

     1056    14969    2      END;    /* Do while( more ) */

  14969  3 001642   200024 234100                    SZN     MORE,,AUTO
         3 001643   000426 604000 3                  TMI     s:14476

     1057    14970
     1058    14971    1   PROJ_REC_SIZEW = SIZEW(AS$PROJ_HEADER) + (SUPER_TO_PIG.ATTR.COUNT+5)/4;

  14971  3 001644   200066 236100                    LDQ     SUPER_TO_PIG+14,,AUTO
         3 001645   000022 772000                    QRL     18
         3 001646   000005 036007                    ADLQ    5,DL
         3 001647   000002 772000                    QRL     2
         3 001650   000014 036007                    ADLQ    12,DL
         3 001651   200034 756100                    STQ     PROJ_REC_SIZEW,,AUTO

     1059    14972    1   SIZE = POFFC(AS_PROJ_HEADER$,DSEG2$) + 4*PROJ_REC_SIZEW + PROJ_ACCT_SIZEC;

  14972  3 001652   000000 236000 xsym               LDQ     DSEG2$
         3 001653   000020 772000                    QRL     16
         3 001654   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 001655   000000 236000 xsym               LDQ     AS_PROJ_HEADER$
         3 001656   000020 772000                    QRL     16
         3 001657   202350 136100                    SBLQ    SUPER_TO_PIG+1216,,AUTO
         3 001660   202351 756100                    STQ     SUPER_TO_PIG+1217,,AUTO
         3 001661   200034 236100                    LDQ     PROJ_REC_SIZEW,,AUTO
         3 001662   000002 736000                    QLS     2
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:182  
         3 001663   202351 036100                    ADLQ    SUPER_TO_PIG+1217,,AUTO
         3 001664   200030 036100                    ADLQ    PROJ_ACCT_SIZEC,,AUTO
         3 001665   200040 756100                    STQ     SIZE,,AUTO

     1060    14973    1   IF SIZE > DSEG2SIZE

  14973  3 001666   000000 116000 xsym               CMPQ    DSEG2SIZE
         3 001667   001706 602000 3                  TNC     s:14979
         3 001670   001706 600000 3                  TZE     s:14979

     1061    14974    2   THEN DO;

     1062    14975    2      SIZE = ((SIZE - DSEG2SIZE + 4095) / 4096) * 4096;

  14975  3 001671   000000 136000 xsym               SBLQ    DSEG2SIZE
         3 001672   007777 036007                    ADLQ    4095,DL
         3 001673   010000 506007                    DIV     4096,DL
         3 001674   000014 736000                    QLS     12
         3 001675   200040 756100                    STQ     SIZE,,AUTO

     1063    14976    2      CALL ASB$GET_MORE_SEG( 2, SIZE );

  14976  3 001676   200040 630500                    EPPR0   SIZE,,AUTO
         3 001677   202351 450500                    STP0    SUPER_TO_PIG+1217,,AUTO
         3 001700   000036 236000 4                  LDQ     30
         3 001701   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 001702   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 001703   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001704   000000 701000 xent               TSX1    ASB$GET_MORE_SEG
         3 001705   000000 011000                    NOP     0

     1064    14977    2      END;

     1065    14978
     1066    14979    1   AS$PROJ.ATTRIBUTES.COUNT = SUPER_TO_PIG.ATTR.COUNT;

  14979  3 001706   200066 220100                    LDX0    SUPER_TO_PIG+14,,AUTO
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:183  
         3 001707   000000 470400 xsym               LDP0    AS_PROJ_HEADER$
         3 001710   000014 740100                    STX0    12,,PR0

     1067    14980    1   AS$PROJ.ATTRIBUTES.TEXT  = SUPER_TO_PIG.ATTR.LIST;

  14980  3 001711   011300 221003                    LDX1    4800,DU
         3 001712   040140 100540                    MLR     fill='040'O
         3 001713   200066 400011                    ADSC9   SUPER_TO_PIG+14,,AUTO    cn=2,n=*X1
         3 001714   000014 400010                    ADSC9   12,,PR0                  cn=2,n=*X0

     1068    14981
     1069    14982    1   IF NOT NEW_PROJ_REC AND PROJ_ACCT_SIZEC > 0 THEN

  14982  3 001715   200023 234100                    SZN     NEW_PROJ_REC,,AUTO
         3 001716   001731 604000 3                  TMI     s:14987
         3 001717   200030 235100                    LDA     PROJ_ACCT_SIZEC,,AUTO
         3 001720   001731 600000 3                  TZE     s:14987

     1070    14983    1      PINCRW(AS_PROJ_HEADER$,PROJ_REC_SIZEW)->PROJ$ACCT = PROJ$ACCT;

  14983  3 001721   200034 236100                    LDQ     PROJ_REC_SIZEW,,AUTO
         3 001722   000002 736000                    QLS     2
         3 001723   200027 471500                    LDP1    PROJ_ACCT$,,AUTO
         3 001724   000000 622005                    EAX2    0,AL
         3 001725   200030 723100                    LXL3    PROJ_ACCT_SIZEC,,AUTO
         3 001726   040146 100540                    MLR     fill='040'O
         3 001727   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
         3 001730   000000 000013                    ADSC9   0,Q,PR0                  cn=0,n=*X3

     1071    14984        /*
     1072    14985                                                  Write :PROJ record
     1073    14986        */
     1074    14987    1   PROJ_KEY.TXT.PROJECT = CR_MOD_KEY.TEXT ;

  14987  3 001731   200003 470500                    LDP0    @CR_MOD_KEY,,AUTO
         3 001732   040000 100500                    MLR     fill='040'O
         3 001733   000000 200024                    ADSC9   0,,PR0                   cn=1,n=20
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:184  
         3 001734   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

     1075    14988    1   ARS = PROJ_REC_SIZEW * 4  +  PROJ_ACCT_SIZEC ;

  14988  3 001735   200034 236100                    LDQ     PROJ_REC_SIZEW,,AUTO
         3 001736   000002 736000                    QLS     2
         3 001737   200030 036100                    ADLQ    PROJ_ACCT_SIZEC,,AUTO
         3 001740   200005 756100                    STQ     ARS,,AUTO

     1076    14989    1   CALL ASB$WRITE_PROJ( AS_PROJ_HEADER$, ARS )  ALTRET(PROJ_WRITE_ERR);

  14989  3 001741   200005 631500                    EPPR1   ARS,,AUTO
         3 001742   202351 451500                    STP1    SUPER_TO_PIG+1217,,AUTO
         3 001743   000037 236000 4                  LDQ     31
         3 001744   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 001745   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 001746   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001747   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         3 001750   002022 702000 3                  TSX2    PROJ_WRITE_ERR

     1077    14990    1   IF AS_CR_MOD_PROJ > 0

  14990  3 001751   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 001752   001766 604400 3                  TMOZ    s:14995

     1078    14991    2   THEN DO;

     1079    14992    2      PROJ_KEY.TXT.PROJECT = AS_PROJECT_ADMIN.TEXT;

  14992  3 001753   040000 100400                    MLR     fill='040'O
         3 001754   000000 200024 xsym               ADSC9   AS_PROJECT_ADMIN         cn=1,n=20
         3 001755   000000 200024 xsym               ADSC9   PROJ_KEY                 cn=1,n=20

     1080    14993    2      CALL ASB$WRITE_PROJ( DSEG3$, ADMIN_PROJ_ARS ) ALTRET( PROJ_WRITE_ERR);

  14993  3 001756   200035 630500                    EPPR0   ADMIN_PROJ_ARS,,AUTO
         3 001757   202351 450500                    STP0    SUPER_TO_PIG+1217,,AUTO
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:185  
         3 001760   000001 236000 4                  LDQ     1
         3 001761   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 001762   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 001763   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001764   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         3 001765   002022 702000 3                  TSX2    PROJ_WRITE_ERR

     1081    14994    2      END;

     1082    14995    1   CALL ASB$DEQ_PROJ;

  14995  3 001766   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001767   000000 701000 xent               TSX1    ASB$DEQ_PROJ
         3 001770   000000 011000                    NOP     0

     1083    14996    1   SIZE = DSEG3SIZE - INITIAL_DSEG3SIZE;

  14996  3 001771   000000 236000 xsym               LDQ     DSEG3SIZE
         3 001772   200032 136100                    SBLQ    INITIAL_DSEG3SIZE,,AUTO
         3 001773   200040 756100                    STQ     SIZE,,AUTO

     1084    14997    1   IF SIZE > 0 THEN CALL ASB$FREE_SEG( 3, SIZE );

  14997  3 001774   002005 600000 3                  TZE     s:14998

  14997  3 001775   200040 630500                    EPPR0   SIZE,,AUTO
         3 001776   202351 450500                    STP0    SUPER_TO_PIG+1217,,AUTO
         3 001777   000000 236000 4                  LDQ     0
         3 002000   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 002001   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 002002   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002003   000000 701000 xent               TSX1    ASB$FREE_SEG
         3 002004   000000 011000                    NOP     0

     1085    14998    1   SIZE = DSEG2SIZE - INITIAL_DSEG2SIZE;

  14998  3 002005   000000 236000 xsym               LDQ     DSEG2SIZE
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:186  
         3 002006   200031 136100                    SBLQ    INITIAL_DSEG2SIZE,,AUTO
         3 002007   200040 756100                    STQ     SIZE,,AUTO

     1086    14999    1   IF SIZE > 0 THEN CALL ASB$FREE_SEG( 2, SIZE );

  14999  3 002010   002021 600000 3                  TZE     s:15000

  14999  3 002011   200040 630500                    EPPR0   SIZE,,AUTO
         3 002012   202351 450500                    STP0    SUPER_TO_PIG+1217,,AUTO
         3 002013   000036 236000 4                  LDQ     30
         3 002014   202350 756100                    STQ     SUPER_TO_PIG+1216,,AUTO
         3 002015   202350 630500                    EPPR0   SUPER_TO_PIG+1216,,AUTO
         3 002016   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 002017   000000 701000 xent               TSX1    ASB$FREE_SEG
         3 002020   000000 011000                    NOP     0

     1087    15000    1   RETURN ;

  15000  3 002021   000000 702200 xent               TSX2  ! X66_ARET

  14999  3 002022                       PROJ_WRITE_* null
     1088    15001
     1089    15002
     1090    15003    1   PROJ_WRITE_ERR:;
     1091    15004        /*E* ERROR:   ASA-E$UNABLE_TO_WRITE_PROJ-C
     1092    15005             MESSAGE: Unable to write the record "%U1" to the :PROJ file.
     1093    15006        */
     1094    15007    1   CALL ASH$ERROR( ERR_CODE );

  15007  3 002022   000003 630400 4                  EPPR0   3
         3 002023   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002024   000000 701000 xent               TSX1    ASH$ERROR
         3 002025   000000 011000                    NOP     0

     1095    15008    1   AS_FIELD1 = PROJ_KEY;

  15008  3 002026   000000 100400                    MLR     fill='000'O
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:187  
         3 002027   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27
         3 002030   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

     1096    15009        %SCREAM( ERR#=E$UNABLE_TO_WRITE_PROJ, MID='A', LEVEL=INFO );

  15017  3 002031   000040 630400 4                  EPPR0   32
         3 002032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 002033   000000 701000 xent               TSX1    ASH$INFO
         3 002034   000000 011000                    NOP     0

     1097    15024
     1098    15025    1   ENQ_ERR:
     1099    15026    1   RETURN;

  15026  3 002035   000000 702200 xent  ENQ_ERR      TSX2  ! X66_ARET
     1100    15027
     1101    15028    1   END ASA$PACKSET_OPTS;

PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:188  
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASA$PACKSET_OPTS.
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:189  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CR_MOD_KEY                4-0-0/w PTR         r     1 @PACKSET
    33-0-0/w UBIN        r     1 ACCTS_ACCUM               35-0-0/w UBIN        r     1 ADMIN_PROJ_ARS
     5-0-0/w SBIN        r     1 ARS                       10-0-0/w PTR         r     1 BLK$
    43-0-0/w SBIN        r     1 CHANGE                    22-0-0/w UBIN        r     1 CNT
    *0-0-0/c STRC(189)   r     1 CR_MOD_KEY                37-0-0/w SBIN        r     1 DELTA
    17-0-0/w SBIN        r     1 I                         31-0-0/w UBIN        r     1 INITIAL_DSEG2SIZE
    32-0-0/w UBIN        r     1 INITIAL_DSEG3SIZE         20-0-0/w SBIN        r     1 J
    45-0-0/w UBIN        r     1 K                         46-0-0/w SBIN        r     1 L
    24-0-0/b BIT         r     1 MORE                      15-0-0/c CHAR(8)     r     1 MSKELETON
    42-0-0/w UBIN        r     1 MSKEL_LEN                 23-0-0/b BIT         r     1 NEW_PROJ_REC
    26-0-0/w UBIN        r     1 OLD_PROJ_ARS              25-0-0/w PTR         r     1 OLD_PROJ_REC$
    47-0-0/w PTR         r     1 ONE_CHR$                  *0-0-0/c STRC(63)    r     1 PACKSET
    44-0-0/b BIT         r     1 PREVIOUS                  27-0-0/w PTR         r     1 PROJ_ACCT$
    30-0-0/w UBIN        r     1 PROJ_ACCT_SIZEC           34-0-0/w UBIN        r     1 PROJ_REC_SIZEW
    40-0-0/w UBIN        r     1 SIZE                      13-0-0/c CHAR(8)     r     1 SKELETON
    41-0-0/w UBIN        r     1 SKELETON_LEN              11-0-0/w PTR         r     1 STR$
     7-0-0/w PTR         r     1 SUBND$                     6-0-0/w SBIN        r     1 SUBNODES
    21-0-0/w UBIN        r     1 SUB_CODE                  50-0-0/w STRC(43722) r     1 SUPER_TO_PIG
    36-0-0/w SBIN        r     1 VAL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK
     0-0-0/w STRC(432)   r     1 AS_CONSTANT_PROJ_HEADER
     0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ             0-0-0/b BIT         r     1 AS_FALSE
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(369)   r     1 AS_FIELD3                  0-0-0/c STRC(189)   r     1 AS_LOGON_KEY
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:190  
     0-0-0/c STRC(189)   r     1 AS_PROJECT_ADMIN           0-0-0/w PTR         r     1 AS_PROJ_HEADER$
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/w PTR         r     1 DSEG3$                     0-0-0/w UBIN        r     1 DSEG3SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c CHAR(255)   r     1 IN_BUF
     0-0-0/w UBIN        r     1 LO_WIDTH                   0-0-0/b STRC        r     1 MERR_CODE
     0-0-0/w PTR         r     1 NODE$                      0-0-0/c STRC(243)   r     1 PROJ_KEY
     0-0-0/w UBIN        r     1 PROJ_PACKSET_LIST          0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/d REMB        r     1 REMEM_VAR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR(468)   r     1 AS$PROJ                    0-0-0/w STRC(432)   r     1 AS$PROJ_HEADER
     0-0-0/c CHAR        r     1 ONE_CHR                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE                     0-0-0/c ACHR        r     1 PROJ$ACCT
     0-0-0/w ASTR(9)     r     1 VARY$STR


   Procedure ASA$PACKSET_OPTS requires 1054 words for executable code.
   Procedure ASA$PACKSET_OPTS requires 1260 words of local(AUTO) storage.

    No errors detected in file ASA$PROJ.:E05TSI    .
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:191  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:192  
          MINI XREF LISTING

ACCTS_ACCUM
     14190**DCL     14636<<ASSIGN  14637>>IF      14647>>ASSIGN  14700<<ASSIGN  14701>>IF      14713>>ASSIGN
ADMIN_PROJ_ARS
     14192**DCL     14317<<ASSIGN  14318<>CALL    14319>>ASSIGN  14320>>ASSIGN  14993<>CALL
ADMIN_READ_ERROR
     14323**LABEL   14318--CALLALT
ARS
     14170**DCL     14476<>CALL    14477>>ASSIGN  14988<<ASSIGN  14989<>CALL
AS$PROJ.ATTRIBUTES.COUNT
     14043**DCL     14044--IMP-SIZ 14421>>ASSIGN  14426>>ASSIGN  14427>>ASSIGN  14437>>ASSIGN  14438>>ASSIGN
     14442<<ASSIGN  14979<<ASSIGN  14980>>ASSIGN
AS$PROJ.ATTRIBUTES.TEXT
     14044**DCL     14427>>ASSIGN  14438>>ASSIGN  14980<<ASSIGN
AS$PROJ.CREATOR
     14025**DCL     14435<<ASSIGN  14441<<ASSIGN
AS$PROJ.GRANS_ACCUM
     14034**DCL     14507>>IF      14517>>ASSIGN  14570>>IF      14582>>ASSIGN  14630<<ASSIGN  14630>>ASSIGN
AS$PROJ.MAX_NUM_ACCTS
     14038**DCL     14699>>ASSIGN  14701>>IF      14713>>ASSIGN  14713>>ASSIGN  14763<<ASSIGN
AS$PROJ.MAX_NUM_GRANS
     14032**DCL     14569>>ASSIGN  14570>>IF      14582>>ASSIGN  14582>>ASSIGN  14632<<ASSIGN
AS$PROJ.MODIFY_ATTR
     14027**DCL     14892>>IF      14923<<ASSIGN  14928>>IF
AS$PROJ.NUM_ACCTS
     14040**DCL     14394>>IF      14636>>ASSIGN  14700>>ASSIGN
AS$PROJ.PROJ_REMOVED
     14028**DCL     14393>>IF
AS$PROJ.SKELETON
     14036**DCL     14436<<ASSIGN  14436>>ASSIGN  14767>>ASSIGN  14882<<ASSIGN
AS$PROJ.SUB_PROJ_ACCTS
     14030**DCL     14636>>ASSIGN  14700>>ASSIGN  14761<<ASSIGN  14761>>ASSIGN
AS$PROJ_HEADER
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:193  
     14057**DCL     14421--ASSIGN  14425<<ASSIGN  14425>>ASSIGN  14433<<ASSIGN  14971--ASSIGN
ASA_BRKS_LOC
      9938**DCL      9938--REDEF
ASB$BINCHAR
      3167**DCL-ENT 14526--CALL    14607--CALL    14656--CALL    14738--CALL
ASB$DEQ_PROJ
     14277**DCL-ENT 14346--CALL    14370--CALL    14463--CALL    14995--CALL
ASB$ENQ_PROJ
     14274**DCL-ENT 14316--CALL    14391--CALL
ASB$FREE_SEG
     14289**DCL-ENT 14997--CALL    14999--CALL
ASB$GET_MORE_SEG
     14286**DCL-ENT 14976--CALL
ASB$PIG_ACCT_ATTR
     14271**DCL-ENT 14959--CALL
ASB$READ_PROJ
     14280**DCL-ENT 14318--CALL    14392--CALL
ASB$READ_SI
     14247**DCL-ENT 14476--CALL
ASB$SET_PROMPT
     14250**DCL-ENT 14474--CALL
ASB$WILD_MATCH
     14292**DCL-ENT 14846--CALL
ASB$WRITE_PROJ
     14283**DCL-ENT 14989--CALL    14993--CALL
ASH$DQUEST
     14256**DCL-ENT 14500--CALL
ASH$ERROR
     14262**DCL-ENT 14343--CALL    14353--CALL    14416--CALL    14446--CALL    14561--CALL    14625--CALL
     14691--CALL    14756--CALL    14787--CALL    14836--CALL    14876--CALL    14918--CALL    14954--CALL
     14967--CALL    15007--CALL
ASH$HELP
     14253**DCL-ENT 14497--CALL
ASH$INFO
     14268**DCL-ENT 14363--CALL    14456--CALL    15017--CALL
ASH$QUEST
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:194  
     14259**DCL-ENT 14503--CALL
AS_BLANK
      9798**DCL     14385>>ASSIGN  14401>>CALLBLT 14441>>ASSIGN  14576>>CALLBLT 14707>>CALLBLT 14855>>CALLBLT
     14858>>CALLBLT 14901>>CALLBLT 14937>>CALLBLT
AS_CONSTANT_PROJ_HEADER
     12771**DCL     14433>>ASSIGN
AS_CR_MOD_PROJ
      9946**DCL     14312>>IF      14434>>IF      14565>>IF      14695>>IF      14841>>IF      14890>>IF
     14926>>IF      14990>>IF
AS_DEFAULT.BANNER_PERM
     10631**DCL     10632--REDEF
AS_DEFAULT.BUDGET.MACCT
     10536**DCL     10540--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10549**DCL     10552--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10532**DCL     10534--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10527**DCL     10529--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10647**DCL     10648--REDEF   10649--REDEF
AS_DEFAULT_DREC.PASSWORD
     11901**DCL     11905--REDEF
AS_DEFAULT_DREC.RENAME
     11924**DCL     11925--REDEF
AS_DFLT.BANNER_PERM
     10453**DCL     10454--REDEF
AS_DFLT.BUDGET.MACCT
     10358**DCL     10362--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10371**DCL     10374--REDEF
AS_DFLT.BUDGET.PACCUM
     10354**DCL     10356--REDEF
AS_DFLT.BUDGET.PMAXC
     10349**DCL     10351--REDEF
AS_DFLT.SETUP_CHRA.TXT
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:195  
     10469**DCL     10470--REDEF   10471--REDEF
AS_FALSE
      9798**DCL     14379>>ASSIGN  14424>>ASSIGN  14494>>ASSIGN  14801>>ASSIGN  14812>>ASSIGN
AS_FE_MODE
      9804**DCL      9805--REDEF
AS_FIELD1
      9934**DCL     14330<<ASSIGN  14354<<ASSIGN  14400<<ASSIGN  14447<<ASSIGN  14900<<ASSIGN  14936<<ASSIGN
     15008<<ASSIGN
AS_FIELD1.COUNT
      9935**DCL     14580<<ASSIGN  14711<<ASSIGN  14822<<ASSIGN  14853<<ASSIGN
AS_FIELD1.TEXT
      9935**DCL     14526<>CALL    14577<<CALLBLT 14656<>CALL    14708<<CALLBLT 14823<<ASSIGN  14854<<ASSIGN
AS_FIELD2
      9935**DCL     14548<<ASSIGN  14581<<ASSIGN  14678<<ASSIGN  14712<<ASSIGN
AS_FIELD2.COUNT
      9935**DCL     14403<<ASSIGN  14856<<ASSIGN  14905<<ASSIGN  14941<<ASSIGN
AS_FIELD2.TEXT
      9935**DCL     14402<<CALLBLT 14857<<ASSIGN  14902<<CALLBLT 14938<<CALLBLT
AS_FIELD3.COUNT
      9936**DCL     14863<<ASSIGN
AS_FIELD3.TEXT
      9936**DCL     14607<>CALL    14738<>CALL    14859<<CALLBLT
AS_LOGON_KEY.TEXT
      9943**DCL     14380>>ASSIGN
AS_MODE
      9801**DCL      9803--REDEF
AS_MOD_USER.ACCESS
     12666**DCL     12667--REDEF
AS_MOD_USER.BANNER
     12653**DCL     12654--REDEF
AS_MOD_USER.BANNER_PERM
     12655**DCL     12656--REDEF
AS_MOD_USER.BILL
     12661**DCL     12662--REDEF
AS_MOD_USER.CPROC
     12657**DCL     12658--REDEF
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:196  
AS_MOD_USER.FEBILL
     12737**DCL     12738--REDEF
AS_MOD_USER.FECXTMEM
     12754**DCL     12755--REDEF
AS_MOD_USER.FEMINTS
     12739**DCL     12740--REDEF
AS_MOD_USER.FEMMEM
     12750**DCL     12751--REDEF
AS_MOD_USER.FEMTIME
     12748**DCL     12749--REDEF
AS_MOD_USER.FEPPRIV
     12745**DCL     12747--REDEF
AS_MOD_USER.FEPRIV
     12742**DCL     12744--REDEF
AS_MOD_USER.FORCE_BIT
     12651**DCL     12652--REDEF
AS_MOD_USER.KEY
     12733**DCL     12735--REDEF
AS_MOD_USER.LASTCPROC
     12659**DCL     12660--REDEF
AS_MOD_USER.LIMITS.DO_
     12707**DCL     12708--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12723**DCL     12724--REDEF
AS_MOD_USER.LIMITS.LO
     12703**DCL     12704--REDEF
AS_MOD_USER.LIMITS.MEM
     12699**DCL     12700--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12727**DCL     12728--REDEF
AS_MOD_USER.LIMITS.PDIS
     12715**DCL     12716--REDEF
AS_MOD_USER.LIMITS.PO
     12711**DCL     12712--REDEF
AS_MOD_USER.LIMITS.TDIS
     12719**DCL     12720--REDEF
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:197  
AS_MOD_USER.LIMITS.TIME
     12695**DCL     12696--REDEF
AS_MOD_USER.MAXENQ
     12676**DCL     12677--REDEF
AS_MOD_USER.PERM_BIT
     12649**DCL     12650--REDEF
AS_MOD_USER.PPRIV
     12671**DCL     12673--REDEF
AS_MOD_USER.PRIOB
     12678**DCL     12679--REDEF
AS_MOD_USER.PRIV
     12668**DCL     12670--REDEF
AS_MOD_USER.QUAN
     12674**DCL     12675--REDEF
AS_MOD_USER.SETUP
     12647**DCL     12648--REDEF
AS_PROJECT.BANNER_PERM
     10987**DCL     10988--REDEF
AS_PROJECT.BUDGET.MACCT
     10892**DCL     10896--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10905**DCL     10908--REDEF
AS_PROJECT.BUDGET.PACCUM
     10888**DCL     10890--REDEF
AS_PROJECT.BUDGET.PMAXC
     10883**DCL     10885--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11003**DCL     11004--REDEF   11005--REDEF
AS_PROJECT_ADMIN.COUNT
      9942**DCL     14577>>CALLBLT 14580>>ASSIGN  14708>>CALLBLT 14711>>ASSIGN  14859>>CALLBLT 14863>>ASSIGN
     14902>>CALLBLT 14905>>ASSIGN  14938>>CALLBLT 14941>>ASSIGN
AS_PROJECT_ADMIN.TEXT
      9942**DCL     14315>>ASSIGN  14435>>ASSIGN  14576>>CALLBLT 14577>>CALLBLT 14577>>CALLBLT 14707>>CALLBLT
     14708>>CALLBLT 14708>>CALLBLT 14858>>CALLBLT 14859>>CALLBLT 14859>>CALLBLT 14901>>CALLBLT 14902>>CALLBLT
     14902>>CALLBLT 14937>>CALLBLT 14938>>CALLBLT 14938>>CALLBLT 14992>>ASSIGN
AS_PROJECT_DFLT.BANNER_PERM
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:198  
     11165**DCL     11166--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11070**DCL     11074--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11083**DCL     11086--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11066**DCL     11068--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11061**DCL     11063--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11181**DCL     11182--REDEF   11183--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12387**DCL     12391--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12410**DCL     12411--REDEF
AS_PROJECT_DREC.PASSWORD
     12225**DCL     12229--REDEF
AS_PROJECT_DREC.RENAME
     12248**DCL     12249--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10809**DCL     10810--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10714**DCL     10718--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10727**DCL     10730--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10710**DCL     10712--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10705**DCL     10707--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10825**DCL     10826--REDEF   10827--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12063**DCL     12067--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12086**DCL     12087--REDEF
AS_PROJ_HEADER$
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:199  
      9944**DCL     14023--IMP-PTR 14425>>ASSIGN  14433>>ASSIGN  14435>>ASSIGN  14436>>ASSIGN  14441>>ASSIGN
     14442>>ASSIGN  14507>>IF      14517>>ASSIGN  14569>>ASSIGN  14582>>ASSIGN  14632>>ASSIGN  14636>>ASSIGN
     14636>>ASSIGN  14699>>ASSIGN  14713>>ASSIGN  14763>>ASSIGN  14882>>ASSIGN  14923>>ASSIGN  14972>>ASSIGN
     14979>>ASSIGN  14980>>ASSIGN  14980>>ASSIGN  14983>>ASSIGN  14989<>CALL
AS_TRUE
      9798**DCL     14443>>ASSIGN  14469>>ASSIGN  14799>>ASSIGN  14807>>ASSIGN
AS_USERS.BANNER_PERM
     10275**DCL     10276--REDEF
AS_USERS.BUDGET.MACCT
     10180**DCL     10184--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     10193**DCL     10196--REDEF
AS_USERS.BUDGET.PACCUM
     10176**DCL     10178--REDEF
AS_USERS.BUDGET.PMAXC
     10171**DCL     10173--REDEF
AS_USERS.SETUP_CHRA.TXT
     10291**DCL     10292--REDEF   10293--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11343**DCL     11344--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11248**DCL     11252--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11261**DCL     11264--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11244**DCL     11246--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11239**DCL     11241--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11359**DCL     11360--REDEF   11361--REDEF
BLK$
     14173**DCL     14131--IMP-PTR 14766<<ASSIGN  14768>>ASSIGN  14792>>ASSIGN  14792>>ASSIGN
CHANGE
     14198**DCL     14796<<ASSIGN  14808<<ASSIGN  14808>>ASSIGN  14813<<ASSIGN  14813>>ASSIGN  14816>>IF
CNT
     14181**DCL     14768<<ASSIGN  14769>>IF      14822>>ASSIGN  14853>>ASSIGN
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:200  
CODE
      9931**DCL     14483<<ASSIGN  14488<<ASSIGN  14490>>DOSELCT
CR_MOD_KEY
        12**DCL         6--PROC
CR_MOD_KEY.COUNT
        13**DCL     14402>>CALLBLT 14403>>ASSIGN
CR_MOD_KEY.TEXT
        14**DCL     14381>>ASSIGN  14390>>ASSIGN  14401>>CALLBLT 14402>>CALLBLT 14402>>CALLBLT 14987>>ASSIGN
DELTA
     14194**DCL     14567<<ASSIGN  14569<<ASSIGN  14570>>IF      14582<<ASSIGN  14607<>CALL    14630>>ASSIGN
     14697<<ASSIGN  14699<<ASSIGN  14701>>IF      14713<<ASSIGN  14738<>CALL    14761>>ASSIGN
DSEG2$
      9940**DCL     14972>>ASSIGN
DSEG2SIZE
      9940**DCL     14310>>ASSIGN  14973>>IF      14975>>ASSIGN  14998>>ASSIGN
DSEG3$
      9940**DCL     14307>>ASSIGN  14318<>CALL    14319>>ASSIGN  14436>>ASSIGN  14437>>ASSIGN  14438>>ASSIGN
     14438>>ASSIGN  14570>>IF      14570>>IF      14582>>ASSIGN  14582>>ASSIGN  14630>>ASSIGN  14630>>ASSIGN
     14700>>ASSIGN  14700>>ASSIGN  14701>>IF      14713>>ASSIGN  14761>>ASSIGN  14761>>ASSIGN  14767>>ASSIGN
     14892>>IF      14928>>IF      14993<>CALL
DSEG3SIZE
      9940**DCL     14308>>ASSIGN  14311>>ASSIGN  14317>>ASSIGN  14320>>ASSIGN  14996>>ASSIGN
ENQ_ERR
     15026**LABEL   14316--CALLALT 14391--CALLALT
ERR_CODE
      9933**DCL      9934--REDEF   14353<>CALL    14446<>CALL    15007<>CALL
I
     14178**DCL     14486<<DOINDEX 14487>>ASSIGN
INITIAL_DSEG2SIZE
     14188**DCL     14310<<ASSIGN  14998>>ASSIGN
INITIAL_DSEG3SIZE
     14189**DCL     14311<<ASSIGN  14996>>ASSIGN
IN_BUF
      9929**DCL     14476<>CALL
J
     14179**DCL     14401<<CALLBLT 14402>>CALLBLT 14403>>ASSIGN  14576<<CALLBLT 14577>>CALLBLT 14580>>ASSIGN
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:201  
     14707<<CALLBLT 14708>>CALLBLT 14711>>ASSIGN  14855<<CALLBLT 14856>>ASSIGN  14858<<CALLBLT 14859>>CALLBLT
     14863>>ASSIGN  14901<<CALLBLT 14902>>CALLBLT 14905>>ASSIGN  14937<<CALLBLT 14938>>CALLBLT 14941>>ASSIGN
K
     14200**DCL     14803<<DOINDEX
KL_DEFAULT.PASSWORD
     12549**DCL     12553--REDEF
KL_DEFAULT.RENAME
     12572**DCL     12573--REDEF
KL_DFLT.PASSWORD
     11739**DCL     11743--REDEF
KL_DFLT.RENAME
     11762**DCL     11763--REDEF
KL_DREC.PASSWORD
     11577**DCL     11581--REDEF
KL_DREC.RENAME
     11600**DCL     11601--REDEF
KL_DREC_CNT.PASSWORD
     11464**DCL     11468--REDEF
KL_DREC_CNT.RENAME
     11487**DCL     11488--REDEF
L
     14201**DCL     14802<<CALLBLT 14803>>DOINDEX
LO_WIDTH
      9815**DCL     14383>>ASSIGN
MERR_CODE.CODE
      9934**DCL     14323>>IF      14430>>IF
MORE
     14183**DCL     14469<<ASSIGN  14475>>DOWHILE 14494<<ASSIGN
MSKELETON
     14177**DCL     14767<<ASSIGN  14844>>CALLBLT 14846<>CALL    14855>>CALLBLT 14857>>ASSIGN
MSKEL_LEN
     14197**DCL     14844<<CALLBLT 14845>>IF      14845<<ASSIGN  14846<>CALL
NEW_PROJ_REC
     14433**LABEL   14394--GOTO    14424<<ASSIGN  14443<<ASSIGN  14507>>IF      14566>>IF      14637>>IF
     14696>>IF      14982>>IF
NODE$
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:202  
      9931**DCL     14084--IMP-PTR 14480<<ASSIGN  14483>>ASSIGN  14484>>ASSIGN  14487>>ASSIGN
NO_MATCH
     14853**LABEL   14846--CALLALT
OLD_PROJ_ARS
     14185**DCL     14308<<ASSIGN  14320<<ASSIGN  14392<>CALL    14421>>ASSIGN  14423>>ASSIGN
OLD_PROJ_REC$
     14184**DCL     14307<<ASSIGN  14319<<ASSIGN  14392<>CALL    14393>>IF      14394>>IF      14421>>ASSIGN
     14423>>ASSIGN  14425>>ASSIGN  14426>>ASSIGN  14427>>ASSIGN  14427>>ASSIGN
OLD_READ_ERR
     14430**LABEL   14392--CALLALT
ONE_CHR
     14203**DCL     14798>>IF      14805>>IF      14811>>IF
ONE_CHR$
     14202**DCL     14203--IMP-PTR 14797<<ASSIGN  14798>>IF      14804<<ASSIGN  14804>>ASSIGN  14805>>IF
     14811>>IF
OPTION_ERR
     14967**LABEL   14478--CALLALT
OUT$SYM.COUNT
     14154**DCL     14157--IMP-SIZ 14506>>CALLBLT 14635>>CALLBLT 14768>>ASSIGN  14792>>ASSIGN
OUT$SYM.TEXT
     14157**DCL     14506>>CALLBLT 14635>>CALLBLT 14792>>ASSIGN
P$NODE.CODE
     14092**DCL     14483>>ASSIGN  14488>>ASSIGN  14889>>ASSIGN
P$NODE.SUBLK$
     14117**DCL     14487>>ASSIGN  14506>>CALLBLT 14506>>CALLBLT 14635>>CALLBLT 14635>>CALLBLT 14766>>ASSIGN
     14889>>ASSIGN
P$NODE.SUBNODES
     14096**DCL     14484>>ASSIGN  14885>>IF
PACKSET
        15**DCL         6--PROC    14330>>ASSIGN  14400>>ASSIGN  14548>>ASSIGN  14581>>ASSIGN  14678>>ASSIGN
     14712>>ASSIGN  14900>>ASSIGN  14936>>ASSIGN
PACKSET.CNT
        16**DCL     14305>>ASSIGN  14863>>ASSIGN
PACKSET.TXT
        17**DCL     14306>>ASSIGN  14382>>ASSIGN  14384>>ASSIGN  14859>>CALLBLT
PACK_LOOP
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:203  
     14472**LABEL   14470--REMEMBR 14960--GOTO
PACK_LOOP_END
     14964**LABEL   14628--GOTO    14759--GOTO    14790--GOTO    14839--GOTO    14879--GOTO    14921--GOTO
     14957--GOTO
PREVIOUS
     14199**DCL     14799<<ASSIGN  14801<<ASSIGN  14805>>IF      14807<<ASSIGN  14811>>IF      14812<<ASSIGN
PROJ$ACCT
     14076**DCL     14983<<ASSIGN  14983>>ASSIGN
PROJ_ACCT$
     14186**DCL     14076--IMP-PTR 14423<<ASSIGN  14983>>ASSIGN
PROJ_ACCT_SIZEC
     14187**DCL     14076--IMP-SIZ 14309<<ASSIGN  14421<<ASSIGN  14423>>ASSIGN  14972>>ASSIGN  14982>>IF
     14983>>ASSIGN  14983>>ASSIGN  14988>>ASSIGN
PROJ_KEY
      9810**DCL     14354>>ASSIGN  14447>>ASSIGN  15008>>ASSIGN
PROJ_KEY.COUNT
      9811**DCL     14305<<ASSIGN
PROJ_KEY.TEXT
      9811**DCL      9811--REDEF
PROJ_KEY.TXT.PACKSET
      9812**DCL     14306<<ASSIGN
PROJ_KEY.TXT.PROJECT
      9811**DCL      9811--REDEF   14315<<ASSIGN  14390<<ASSIGN  14987<<ASSIGN  14992<<ASSIGN
PROJ_PACKSET_LIST
      9937**DCL     14472--ASSIGN
PROJ_REC_SIZEW
     14191**DCL     14971<<ASSIGN  14972>>ASSIGN  14983>>ASSIGN  14988>>ASSIGN
PROJ_WRITE_ERR
     14999**LABEL   14989--CALLALT 14993--CALLALT
P_PCB
      9966**DCL     14478<>CALL
P_PCB.ERROR
     10070**DCL     14967<>CALL
P_PCB.NCHARS
     10113**DCL     14477<<ASSIGN
P_PCB.OUT$
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:204  
      9979**DCL     14480>>ASSIGN
P_PCB.ROOT$
      9971**DCL     14472<<ASSIGN
REMEM_VAR
      9937**DCL      9937--REDEF   14470<<REMEMBR
REM_FCMD
      9937**DCL      9938--REDEF
SIZE
     14195**DCL     14972<<ASSIGN  14973>>IF      14975<<ASSIGN  14975>>ASSIGN  14976<>CALL    14996<<ASSIGN
     14997>>IF      14997<>CALL    14998<<ASSIGN  14999>>IF      14999<>CALL
SKELETON
     14176**DCL     14792<<ASSIGN  14797--ASSIGN  14802>>CALLBLT 14823>>ASSIGN  14842>>CALLBLT 14846<>CALL
     14854>>ASSIGN  14882>>ASSIGN
SKELETON_LEN
     14196**DCL     14842<<CALLBLT 14843>>IF      14843<<ASSIGN  14846<>CALL
STR$
     14174**DCL     14162--IMP-PTR
SUBND$
     14172**DCL     14487<<ASSIGN  14488>>ASSIGN  14506>>CALLBLT 14506>>CALLBLT 14635>>CALLBLT 14635>>CALLBLT
     14766>>ASSIGN  14885>>IF      14889>>ASSIGN
SUBNODES
     14171**DCL     14484<<ASSIGN  14486>>DOINDEX
SUB_CODE
     14180**DCL     14887<<ASSIGN  14889<<ASSIGN  14890>>IF      14923>>ASSIGN
SUPER_TO_PIG
     14207**DCL     14959<>CALL
SUPER_TO_PIG.ACCT
     14228**DCL     14385<<ASSIGN
SUPER_TO_PIG.ATTR.COUNT
     14230**DCL     14386<<ASSIGN  14426<<ASSIGN  14437<<ASSIGN  14971>>ASSIGN  14979>>ASSIGN
SUPER_TO_PIG.ATTR.LIST
     14235**DCL     14427<<ASSIGN  14438<<ASSIGN  14980>>ASSIGN
SUPER_TO_PIG.PACKSET
     14227**DCL     14382<<ASSIGN  14384<<ASSIGN
SUPER_TO_PIG.PROJ
     14216**DCL     14379<<ASSIGN
PL6.E3A0      #002=ASA$PACKSET_OPTS File=ASA$PROJ.:E05TSI                        TUE 07/29/97 08:43 Page:205  
SUPER_TO_PIG.PROJECT
     14223**DCL     14226--REDEF
SUPER_TO_PIG.PROJECT_TEXT
     14226**DCL     14381<<ASSIGN
SUPER_TO_PIG.RESUPER
     14222**DCL     14380<<ASSIGN
SUPER_TO_PIG.SUPER
     14219**DCL     14222--REDEF
SUPER_TO_PIG.TYPE
     14208**DCL     14378<<ASSIGN
SUPER_TO_PIG.WIDTH
     14218**DCL     14383<<ASSIGN
USERS_KEY.TEXT
      9808**DCL      9809--REDEF    9809--REDEF    9809--REDEF    9810--REDEF
VAL
     14193**DCL     14506<<CALLBLT 14507>>IF      14517<<ASSIGN  14526<>CALL    14567>>ASSIGN  14569>>ASSIGN
     14632>>ASSIGN  14635<<CALLBLT 14637>>IF      14647<<ASSIGN  14656<>CALL    14697>>ASSIGN  14699>>ASSIGN
     14763>>ASSIGN
VARY$STR.CNT
     14163**DCL     14164--IMP-SIZ
X$PARSE
     14245**DCL-ENT 14478--CALL
