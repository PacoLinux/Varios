VERSION E05

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:1    
        1        1        /*M* DBD$ROUTE - Display ROUTE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        DBD$ROUTE: PROC(TOP);
        9        9
       10       10        %INCLUDE DB_PERR_C;
       11       28        %INCLUDE KI_CP6;
       12     1124        %INCLUDE KH$CHN;
       13     1246        %INCLUDE KNN_NETWORK_M;
       14     1609        %INCLUDE K_ADDRESS_M;
       15     2112        %INCLUDE G$BOBCAT_M;
       16     2132        %INCLUDE DA_FORMAT_C;
       17     2374        %INCLUDE DA_CMD_C;
       18     2723        %INCLUDE DA_ANLZ_R;
       19     2736        %INCLUDE XU_MACRO_C;
       20     5842
       21     5843        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
       22     5888        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
       23     5933
       24     5934    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       25     5935    1   DCL DAF$WRITE EPTR SYMREF;
       26     5936    1   DCL DAF$INIT ENTRY(1) ALTRET;
       27     5937    1   DCL DBA$EXPRESSION ENTRY(2) ALTRET;
       28     5938    1   DCL DBM$GETBOBCAT ENTRY(1) ALTRET;
       29     5939    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       30     5940    1   DCL DBM$PACK1 ENTRY(2);
       31     5941    1   DCL DBM$PACK2 ENTRY(2);
       32     5942    1   DCL DBM$PACK4 ENTRY(2);
       33     5943
       34     5944        %REPORT (NAME=ROUTERPT,TRUNC=YES,TABDFLT=1,HEADER=NO,TITLE='ROUTEs');
       35     6010        %REPORT (NAME=LINKRPT,TRUNC=YES,TABDFLT=1,HEADER=NO,TITLE='LINKs');
       36     6076
       37     6077
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:2    
       38     6078        %G$BOBCAT (FPTN=G$BOBCAT,STCLASS=AUTO);
       39     6091        %KNN$ROUTE  (STCLASS=AUTO);
       40     6163        %KNN$LINK  (STCLASS=AUTO);
       41     6414    1   DCL NDCT UBIN;
       42     6415    1   DCL ROUTE$$ UBIN;
       43     6416    1   DCL ROUTE$ UBIN;
       44     6417    1   DCL ROUTEX UBIN;
       45     6418    1   DCL LINKX UBIN;
       46     6419    1   DCL NODES UBIN;
       47     6420    1   DCL LINKS UBIN;
       48     6421    1   DCL LINK$$ UBIN;
       49     6422    1   DCL LINK$ UBIN;
       50     6423    1   DCL I SBIN;
       51     6424    1   DCL TX UBIN;
       52     6425
       53     6426    1   DCL 1 ROUTE ALIGNED AUTO,
       54     6427    1         2 NODE UBIN,
       55     6428    1         2 LINK# UBIN,
       56     6429    1         2 CTX$ UBIN,
       57     6430    1         2 CURRENT_QOS UBIN,
       58     6431    1         2 ALT_QOS UBIN,
       59     6432    1         2 HOST_NODE CHAR(4),
       60     6433    1         2 LINK_CONNECTED CHAR(4);
       61     6434
       62     6435    1   DCL 1 ROUTELINK ALIGNED AUTO,
       63     6436    1         2 LINK UBIN,
       64     6437    1         2 QOS UBIN,
       65     6438    1         2 MSGS_IN UBIN,
       66     6439    1         2 MSGS_OUT UBIN;
       67     6440
       68     6441    1   DCL 1 LINK ALIGNED AUTO,
       69     6442    1         2 LINK# UBIN,
       70     6443    1         2 LDCT$ UBIN,
       71     6444    1         2 NODE# UBIN,
       72     6445    1         2 HOST_NODE CHAR(4),
       73     6446    1         2 QOS UBIN,
       74     6447    1         2 MSGS_IN UBIN,
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:3    
       75     6448    1         2 MSGS_OUT UBIN;
       76     6449    1   DCL 1 ROUTEFMT CONSTANT,
       77     6450    1         2 * CHAR(0) INIT('Node:%4D%-'),
       78     6451    1         2 * CHAR(0) INIT('Link#:%4D%-'),
       79     6452    1         2 * CHAR(0) INIT('CTX$: .%5ZH%-'),
       80     6453    1         2 * CHAR(0) INIT('Qos:%4D%-'),
       81     6454    1         2 * CHAR(0) INIT('Aqos:%4D%-'),
       82     6455    1         2 * CHAR(0) INIT('Host: %4A%-'),
       83     6456    1         2 * CHAR(0) INIT('Link: %4A%-');
       84     6457
       85     6458    1   DCL 1 ROUTELINKFMT CONSTANT,
       86     6459    1         2 * CHAR(0) INIT('     Link:%4D%-'),
       87     6460    1         2 * CHAR(0) INIT('Qos:%4D%-'),
       88     6461    1         2 * CHAR(0) INIT('Messages in:%8D%-'),
       89     6462    1         2 * CHAR(0) INIT('Messages out:%8D%-');
       90     6463
       91     6464    1   DCL 1 LINKFMT CONSTANT,
       92     6465    1         2 * CHAR(0) INIT('Link#:%3D%-'),
       93     6466    1         2 * CHAR(0) INIT('LDCT$:.%5ZH%-'),
       94     6467    1         2 * CHAR(0) INIT('Node:%3D%-'),
       95     6468    1         2 * CHAR(0) INIT('Host:%4A%-'),
       96     6469    1         2 * CHAR(0) INIT('Qos:%3D%-'),
       97     6470    1         2 * CHAR(0) INIT('In:%8D%-'),
       98     6471    1         2 * CHAR(0) INIT('Out:%8D%-');
       99     6472        %EJECT;
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:4    
      100     6473
      101     6474    1           CALL DBM$GETBOBCAT(G$BOBCAT);
      102     6475    1           CALL DBM$PACK2(G$BOBCAT.NODES,NODES);
      103     6476    1           CALL DBM$PACK2(G$BOBCAT.LINKS,LINKS);
      104     6477    1           CALL DBM$PACK4(G$BOBCAT.ROUTE$$,ROUTE$$);
      105     6478    1           CALL DBM$PACK4(G$BOBCAT.LINK$$,LINK$$);
      106     6479
      107     6480    2           IF TOP.NSUBLKS=0 THEN DO;
      108     6481    3              DO ROUTEX=0 TO NODES;
      109     6482    3                 CALL DIROUTE;
      110     6483    3                 END;
      111     6484    2              END;
      112     6485    2           ELSE DO;
      113     6486    3              DO TX=0 TO TOP.NSUBLKS-1;
      114     6487    4                 CALL DAA$VALUE(TOP.SUBLK$(TX)->OUT,ROUTEX) WHENRETURN DO;
      115     6488    4                    CALL DIROUTE;
      116     6489    4                    END;
      117     6490    3                 END;
      118     6491    2              END;
      119     6492    1           RETURN;
      120     6493
      121     6494
      122     6495    1   DIROUTE: PROC;
      123     6496
      124     6497    3           CALL DBM$GETMEM(ROUTE$$+ROUTEX*2,ROUTE$,,4,,4) WHENALTRETURN DO;
      125     6498    3              RETURN;
      126     6499    3              END;
      127     6500    2           CALL DAF$INIT(ROUTERPT);
      128     6501    2           CALL DBM$PACK4(ROUTE$,ROUTE$);
      129     6502    3           IF ROUTE$=0 OR ROUTEX>=NODES THEN DO;
      130     6503    4              IF TOP.NSUBLKS>0 THEN DO;
      131     6504    4                 DA_ANLZERR='040204000000'O|%BINBIT(E$DB_NO_ROUTE,33);
      132     6505        /*E*          ERROR:  DBD-E$DB_NO_ROUTE
      133     6506                      MESSAGE: Bad ROUTE index.
      134     6507        */
      135     6508    4                 END;
      136     6509    3              RETURN;
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:5    
      137     6510    3              END;
      138     6511    3           CALL DBM$GETMEM(ROUTE$,KNN$ROUTE,,SIZEC(KNN$ROUTE),,SIZEC(KNN$ROUTE))
              6511                    WHENALTRETURN DO;
      139     6512    3              RETURN;
      140     6513    3              END;
      141     6514
      142     6515    2           ROUTE.NODE = ROUTEX;
      143     6516    2           CALL DBM$PACK2(KNN$ROUTE.CURRENT_QOS,ROUTE.CURRENT_QOS);
      144     6517    2           CALL DBM$PACK2(KNN$ROUTE.ALT_QOS,ROUTE.ALT_QOS);
      145     6518    2           CALL DBM$PACK2(KNN$ROUTE.LINK#,ROUTE.LINK#);
      146     6519    2           IF ROUTE.CURRENT_QOS = 255
      147     6520    2           THEN
      148     6521    2              ROUTE.LINK# = 0;
      149     6522    2           CALL YESNO(KNN$ROUTE.FLAGS.HOST_NODE,ROUTE.HOST_NODE);
      150     6523    2           CALL YESNO(KNN$ROUTE.FLAGS.LINK_CONNECTED,ROUTE.LINK_CONNECTED);
      151     6524    2           CALL DBM$PACK4(KNN$ROUTE.CTX$,ROUTE.CTX$);
      152     6525
      153     6526    2           IF ROUTE.CURRENT_QOS ~= 255 OR TOP.NSUBLKS ~= 0
      154     6527    2           THEN
      155     6528    2              CALL DAF$WRITE(VECTOR(ROUTEFMT),VECTOR(ROUTE));
      156     6529    3              DO I = 0 TO LINKS - 1;
      157     6530    3                 LINK$ = ROUTE$ + POFFC(ADDR(KNN$ROUTE.LINK(I)),ADDR(KNN$ROUTE))/2;
      158     6531    3                 CALL DBM$GETMEM(LINK$,KNN$ROUTE.LINK(0),,SIZEC(KNN$ROUTE.LINK(0)),,
              6531                          SIZEC(KNN$ROUTE.LINK(0)))
      159     6532    4                 WHENRETURN DO;
      160     6533    4                    IF KNN$ROUTE.LINK.ACTIVE(0) AND KNN$ROUTE.LINK.QOS(0) ~= 255
      161     6534    4                   OR (KNN$ROUTE.LINK.MSGS_IN(0) + KNN$ROUTE.LINK.MSGS_OUT(0))~=0
      162     6535    5                    THEN DO;
      163     6536    5                       ROUTELINK.LINK = I;
      164     6537    5                       ROUTELINK.QOS = KNN$ROUTE.LINK.QOS(0);
      165     6538    5                       CALL DBM$PACK4(KNN$ROUTE.LINK.MSGS_IN(0),ROUTELINK.MSGS_IN);
      166     6539    5                       CALL DBM$PACK4(KNN$ROUTE.LINK.MSGS_OUT(0),ROUTELINK.MSGS_OUT);
      167     6540    5                       CALL DAF$WRITE(VECTOR(ROUTELINKFMT),VECTOR(ROUTELINK));
      168     6541    5                       END;
      169     6542    4                    END;
      170     6543    3                 END;
      171     6544
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:6    
      172     6545    2           RETURN;
      173     6546
      174     6547    2   END DIROUTE;
      175     6548    1   DBD$LINK: ENTRY(TOP);
      176     6549    1           CALL DBM$GETBOBCAT(G$BOBCAT);
      177     6550    1           CALL DBM$PACK2(G$BOBCAT.LINKS,LINKS);
      178     6551    1           CALL DBM$PACK4(G$BOBCAT.LINK$$,LINK$$);
      179     6552
      180     6553    2           IF TOP.NSUBLKS=0 THEN DO;
      181     6554    3              DO LINKX=0 TO LINKS;
      182     6555    3                 CALL DILINK;
      183     6556    3                 END;
      184     6557    2              END;
      185     6558    2           ELSE DO;
      186     6559    3              DO TX=0 TO TOP.NSUBLKS-1;
      187     6560    4                 CALL DAA$VALUE(TOP.SUBLK$(TX)->OUT,LINKX) WHENRETURN DO;
      188     6561    4                    CALL DILINK;
      189     6562    4                    END;
      190     6563    3                 END;
      191     6564    2              END;
      192     6565    1           RETURN;
      193     6566
      194     6567
      195     6568    1   DILINK: PROC;
      196     6569
      197     6570    3           CALL DBM$GETMEM(LINK$$+LINKX*2,LINK$,,4,,4) WHENALTRETURN DO;
      198     6571    3              RETURN;
      199     6572    3              END;
      200     6573    2           CALL DAF$INIT(LINKRPT);
      201     6574    2           CALL DBM$PACK4(LINK$,LINK$);
      202     6575    3           IF LINK$=0 OR LINKX>=LINKS THEN DO;
      203     6576    4              IF TOP.NSUBLKS>0 THEN DO;
      204     6577    4                 DA_ANLZERR='040204000000'O|%BINBIT(E$DB_NO_LINK,33);
      205     6578        /*E*          ERROR:  DBD-E$DB_NO_LINK
      206     6579                      MESSAGE: Bad LINK index.
      207     6580        */
      208     6581    4                 END;
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:7    
      209     6582    3              RETURN;
      210     6583    3              END;
      211     6584    3           CALL DBM$GETMEM(LINK$,KNN$LINK,,SIZEC(KNN$LINK),,SIZEC(KNN$LINK))
              6584                    WHENALTRETURN DO;
      212     6585    3              RETURN;
      213     6586    3              END;
      214     6587
      215     6588    2           LINK.LINK#= LINKX;
      216     6589    2           CALL DBM$PACK2(KNN$LINK.QOS,LINK.QOS);
      217     6590    2           CALL DBM$PACK2(KNN$LINK.NODE#,LINK.NODE#);
      218     6591    2           CALL YESNO(KNN$LINK.FLAGS.HOST_NODE,LINK.HOST_NODE);
      219     6592    2           CALL DBM$PACK4(KNN$LINK.LDCT$,LINK.LDCT$);
      220     6593    2           CALL DBM$PACK4(KNN$LINK.MSGS_IN,LINK.MSGS_IN);
      221     6594    2           CALL DBM$PACK4(KNN$LINK.MSGS_OUT,LINK.MSGS_OUT);
      222     6595
      223     6596    2           IF LINK.LDCT$ ~= 0 OR TOP.NSUBLKS ~= 0
      224     6597    2           THEN
      225     6598    2              CALL DAF$WRITE(VECTOR(LINKFMT),VECTOR(LINK));
      226     6599
      227     6600    2           RETURN;
      228     6601
      229     6602    2   END DILINK;
      230     6603
      231     6604    1   YESNO:  PROC(FLAG,TEXT);
      232     6605
      233     6606    2   DCL FLAG BIT(1) UNAL;
      234     6607    2   DCL TEXT CHAR(4);
      235     6608
      236     6609    2           IF FLAG THEN
      237     6610    2              TEXT='Yes';
      238     6611    2           ELSE
      239     6612    2              TEXT='No';
      240     6613    2           RETURN;
      241     6614
      242     6615    2   END YESNO;
      243     6616
      244     6617    1   END DBD$ROUTE;
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:8    

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:9    
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   DB_PERR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DBD$ROUTE.

   Procedure DBD$ROUTE requires 534 words for executable code.
   Procedure DBD$ROUTE requires 126 words of local(AUTO) storage.

    No errors detected in file DBD$ROUTE.:E05TSI    .

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:10   

 Object Unit name= DBD$ROUTE                                  File name= DBD$ROUTE.:E05TOU
 UTS= JUL 29 '97 13:09:15.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    20     24  DBD$ROUTE
    1  RoData even  UTS     57     71  DBD$ROUTE
    2   Proc  even  none   534   1026  DBD$ROUTE
    3  RoData even  none    30     36  DBD$ROUTE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  DBD$ROUTE
     2    474                  yes      Std        1  DBD$LINK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DBM$GETBOBCAT
         yes           Std       2 DBM$PACK2
         yes           Std       2 DBM$PACK4
 yes     yes           Std       3 DAA$VALUE
 yes     yes           Std      10 DBM$GETMEM
 yes     yes           Std       1 DAF$INIT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DA_ANLZERR                            DAF$WRITE                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:12   


        1        1        /*M* DBD$ROUTE - Display ROUTE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        DBD$ROUTE: PROC(TOP);

      8  2 000000   000000 700200 xent  DBD$ROUTE    TSX0  ! X66_AUTO_1
         2 000001   000176 000001                    ZERO    126,1

        9        9
       10       10        %INCLUDE DB_PERR_C;
       11       28        %INCLUDE KI_CP6;
       12     1124        %INCLUDE KH$CHN;
       13     1246        %INCLUDE KNN_NETWORK_M;
       14     1609        %INCLUDE K_ADDRESS_M;
       15     2112        %INCLUDE G$BOBCAT_M;
       16     2132        %INCLUDE DA_FORMAT_C;
       17     2374        %INCLUDE DA_CMD_C;
       18     2723        %INCLUDE DA_ANLZ_R;
       19     2736        %INCLUDE XU_MACRO_C;
       20     5842
       21     5843        %PARSE$OUT (NAME=TOP,STCLASS=PARAM);
       22     5888        %PARSE$OUT (NAME=OUT,STCLASS=BASED);
       23     5933
       24     5934    1   DCL DAA$VALUE ENTRY(3) ALTRET;
       25     5935    1   DCL DAF$WRITE EPTR SYMREF;
       26     5936    1   DCL DAF$INIT ENTRY(1) ALTRET;
       27     5937    1   DCL DBA$EXPRESSION ENTRY(2) ALTRET;
       28     5938    1   DCL DBM$GETBOBCAT ENTRY(1) ALTRET;
       29     5939    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       30     5940    1   DCL DBM$PACK1 ENTRY(2);
       31     5941    1   DCL DBM$PACK2 ENTRY(2);
       32     5942    1   DCL DBM$PACK4 ENTRY(2);
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:13   
       33     5943
       34     5944        %REPORT (NAME=ROUTERPT,TRUNC=YES,TABDFLT=1,HEADER=NO,TITLE='ROUTEs');
       35     6010        %REPORT (NAME=LINKRPT,TRUNC=YES,TABDFLT=1,HEADER=NO,TITLE='LINKs');
       36     6076
       37     6077
       38     6078        %G$BOBCAT (FPTN=G$BOBCAT,STCLASS=AUTO);
       39     6091        %KNN$ROUTE  (STCLASS=AUTO);
       40     6163        %KNN$LINK  (STCLASS=AUTO);
       41     6414    1   DCL NDCT UBIN;
       42     6415    1   DCL ROUTE$$ UBIN;
       43     6416    1   DCL ROUTE$ UBIN;
       44     6417    1   DCL ROUTEX UBIN;
       45     6418    1   DCL LINKX UBIN;
       46     6419    1   DCL NODES UBIN;
       47     6420    1   DCL LINKS UBIN;
       48     6421    1   DCL LINK$$ UBIN;
       49     6422    1   DCL LINK$ UBIN;
       50     6423    1   DCL I SBIN;
       51     6424    1   DCL TX UBIN;
       52     6425
       53     6426    1   DCL 1 ROUTE ALIGNED AUTO,
       54     6427    1         2 NODE UBIN,
       55     6428    1         2 LINK# UBIN,
       56     6429    1         2 CTX$ UBIN,
       57     6430    1         2 CURRENT_QOS UBIN,
       58     6431    1         2 ALT_QOS UBIN,
       59     6432    1         2 HOST_NODE CHAR(4),
       60     6433    1         2 LINK_CONNECTED CHAR(4);
       61     6434
       62     6435    1   DCL 1 ROUTELINK ALIGNED AUTO,
       63     6436    1         2 LINK UBIN,
       64     6437    1         2 QOS UBIN,
       65     6438    1         2 MSGS_IN UBIN,
       66     6439    1         2 MSGS_OUT UBIN;
       67     6440
       68     6441    1   DCL 1 LINK ALIGNED AUTO,
       69     6442    1         2 LINK# UBIN,
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:14   
       70     6443    1         2 LDCT$ UBIN,
       71     6444    1         2 NODE# UBIN,
       72     6445    1         2 HOST_NODE CHAR(4),
       73     6446    1         2 QOS UBIN,
       74     6447    1         2 MSGS_IN UBIN,
       75     6448    1         2 MSGS_OUT UBIN;
       76     6449    1   DCL 1 ROUTEFMT CONSTANT,
       77     6450    1         2 * CHAR(0) INIT('Node:%4D%-'),
       78     6451    1         2 * CHAR(0) INIT('Link#:%4D%-'),
       79     6452    1         2 * CHAR(0) INIT('CTX$: .%5ZH%-'),
       80     6453    1         2 * CHAR(0) INIT('Qos:%4D%-'),
       81     6454    1         2 * CHAR(0) INIT('Aqos:%4D%-'),
       82     6455    1         2 * CHAR(0) INIT('Host: %4A%-'),
       83     6456    1         2 * CHAR(0) INIT('Link: %4A%-');
       84     6457
       85     6458    1   DCL 1 ROUTELINKFMT CONSTANT,
       86     6459    1         2 * CHAR(0) INIT('     Link:%4D%-'),
       87     6460    1         2 * CHAR(0) INIT('Qos:%4D%-'),
       88     6461    1         2 * CHAR(0) INIT('Messages in:%8D%-'),
       89     6462    1         2 * CHAR(0) INIT('Messages out:%8D%-');
       90     6463
       91     6464    1   DCL 1 LINKFMT CONSTANT,
       92     6465    1         2 * CHAR(0) INIT('Link#:%3D%-'),
       93     6466    1         2 * CHAR(0) INIT('LDCT$:.%5ZH%-'),
       94     6467    1         2 * CHAR(0) INIT('Node:%3D%-'),
       95     6468    1         2 * CHAR(0) INIT('Host:%4A%-'),
       96     6469    1         2 * CHAR(0) INIT('Qos:%3D%-'),
       97     6470    1         2 * CHAR(0) INIT('In:%8D%-'),
       98     6471    1         2 * CHAR(0) INIT('Out:%8D%-');
       99     6472        %EJECT;
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:15   
      100     6473
      101     6474    1           CALL DBM$GETBOBCAT(G$BOBCAT);

   6474  2 000002   200004 630500                    EPPR0   G$BOBCAT,,AUTO
         2 000003   200166 450500                    STP0    @TEXT+2,,AUTO
         2 000004   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000005   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000006   000000 701000 xent               TSX1    DBM$GETBOBCAT
         2 000007   000000 011000                    NOP     0

      102     6475    1           CALL DBM$PACK2(G$BOBCAT.NODES,NODES);

   6475  2 000010   200130 630500                    EPPR0   NODES,,AUTO
         2 000011   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000012   200170 452500                    STP2    @TEXT+4,,AUTO
         2 000013   200170 236100                    LDQ     @TEXT+4,,AUTO
         2 000014   000000 036000 3                  ADLQ    0
         2 000015   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000016   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000017   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000020   000000 701000 xent               TSX1    DBM$PACK2
         2 000021   000000 011000                    NOP     0

      103     6476    1           CALL DBM$PACK2(G$BOBCAT.LINKS,LINKS);

   6476  2 000022   200131 630500                    EPPR0   LINKS,,AUTO
         2 000023   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000024   200017 631500                    EPPR1   G$BOBCAT+11,,AUTO
         2 000025   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000026   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000027   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000030   000000 701000 xent               TSX1    DBM$PACK2
         2 000031   000000 011000                    NOP     0

      104     6477    1           CALL DBM$PACK4(G$BOBCAT.ROUTE$$,ROUTE$$);

   6477  2 000032   200124 630500                    EPPR0   ROUTE$$,,AUTO
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:16   
         2 000033   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000034   200034 631500                    EPPR1   G$BOBCAT+24,,AUTO
         2 000035   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000036   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000037   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000040   000000 701000 xent               TSX1    DBM$PACK4
         2 000041   000000 011000                    NOP     0

      105     6478    1           CALL DBM$PACK4(G$BOBCAT.LINK$$,LINK$$);

   6478  2 000042   200132 630500                    EPPR0   LINK$$,,AUTO
         2 000043   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000044   200035 631500                    EPPR1   G$BOBCAT+25,,AUTO
         2 000045   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000046   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000047   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000050   000000 701000 xent               TSX1    DBM$PACK4
         2 000051   000000 011000                    NOP     0

      106     6479
      107     6480    2           IF TOP.NSUBLKS=0 THEN DO;

   6480  2 000052   200003 470500                    LDP0    @TOP,,AUTO
         2 000053   000001 220100                    LDX0    1,,PR0
         2 000054   000070 601000 2                  TNZ     s:6486

      108     6481    3              DO ROUTEX=0 TO NODES;

   6481  2 000055   200126 450100                    STZ     ROUTEX,,AUTO
         2 000056   000064 710000 2                  TRA     s:6483+3

      109     6482    3                 CALL DIROUTE;

   6482  2 000057   000120 701000 2                  TSX1    DIROUTE
         2 000060   000000 011000                    NOP     0

      110     6483    3                 END;
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:17   

   6483  2 000061   200126 235100                    LDA     ROUTEX,,AUTO
         2 000062   000001 035007                    ADLA    1,DL
         2 000063   200126 755100                    STA     ROUTEX,,AUTO
         2 000064   200130 236100                    LDQ     NODES,,AUTO
         2 000065   200126 116100                    CMPQ    ROUTEX,,AUTO
         2 000066   000057 603000 2                  TRC     s:6482

      111     6484    2              END;

   6484  2 000067   000117 710000 2                  TRA     s:6492

      112     6485    2           ELSE DO;

      113     6486    3              DO TX=0 TO TOP.NSUBLKS-1;

   6486  2 000070   200135 450100                    STZ     TX,,AUTO
         2 000071   000111 710000 2                  TRA     s:6490+3

      114     6487    4                 CALL DAA$VALUE(TOP.SUBLK$(TX)->OUT,ROUTEX) WHENRETURN DO;

   6487  2 000072   200003 470500                    LDP0    @TOP,,AUTO
         2 000073   200135 720100                    LXL0    TX,,AUTO
         2 000074   000003 471510                    LDP1    3,X0,PR0
         2 000075   200126 633500                    EPPR3   ROUTEX,,AUTO
         2 000076   200167 453500                    STP3    @TEXT+3,,AUTO
         2 000077   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000100   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000102   000000 701000 xent               TSX1    DAA$VALUE
         2 000103   000106 702000 2                  TSX2    s:6490

      115     6488    4                    CALL DIROUTE;

   6488  2 000104   000120 701000 2                  TSX1    DIROUTE
         2 000105   000000 011000                    NOP     0

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:18   
      116     6489    4                    END;

      117     6490    3                 END;

   6490  2 000106   200135 235100                    LDA     TX,,AUTO
         2 000107   000001 035007                    ADLA    1,DL
         2 000110   200135 755100                    STA     TX,,AUTO
         2 000111   200003 470500                    LDP0    @TOP,,AUTO
         2 000112   000001 236100                    LDQ     1,,PR0
         2 000113   000022 772000                    QRL     18
         2 000114   200135 116100                    CMPQ    TX,,AUTO
         2 000115   000117 600000 2                  TZE     s:6492
         2 000116   000072 603000 2                  TRC     s:6487

      118     6491    2              END;

      119     6492    1           RETURN;

   6492  2 000117   000000 702200 xent               TSX2  ! X66_ARET

      120     6493
      121     6494
      122     6495    1   DIROUTE: PROC;

   6495  2 000120   200160 741300       DIROUTE      STX1  ! LINK+7,,AUTO

      123     6496
      124     6497    3           CALL DBM$GETMEM(ROUTE$$+ROUTEX*2,ROUTE$,,4,,4) WHENALTRETURN DO;

   6497  2 000121   200126 236100                    LDQ     ROUTEX,,AUTO
         2 000122   000001 736000                    QLS     1
         2 000123   200124 036100                    ADLQ    ROUTE$$,,AUTO
         2 000124   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000125   000001 236000 3                  LDQ     1
         2 000126   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000127   200174 757100                    STAQ    @TEXT+8,,AUTO
         2 000130   000001 236000 3                  LDQ     1
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:19   
         2 000131   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000132   200172 757100                    STAQ    @TEXT+6,,AUTO
         2 000133   200125 630500                    EPPR0   ROUTE$,,AUTO
         2 000134   200171 450500                    STP0    @TEXT+5,,AUTO
         2 000135   200166 631500                    EPPR1   @TEXT+2,,AUTO
         2 000136   200170 451500                    STP1    @TEXT+4,,AUTO
         2 000137   200170 630500                    EPPR0   @TEXT+4,,AUTO
         2 000140   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000141   000000 701000 xent               TSX1    DBM$GETMEM
         2 000142   000144 702000 2                  TSX2    s:6498
         2 000143   000146 710000 2                  TRA     s:6500

      125     6498    3              RETURN;

   6498  2 000144   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 000145   000001 702211                    TSX2  ! 1,X1

      126     6499    3              END;
      127     6500    2           CALL DAF$INIT(ROUTERPT);

   6500  2 000146   000002 630400 3                  EPPR0   2
         2 000147   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000150   000000 701000 xent               TSX1    DAF$INIT
         2 000151   000000 011000                    NOP     0

      128     6501    2           CALL DBM$PACK4(ROUTE$,ROUTE$);

   6501  2 000152   200125 630500                    EPPR0   ROUTE$,,AUTO
         2 000153   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000154   200125 631500                    EPPR1   ROUTE$,,AUTO
         2 000155   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000156   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000157   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000160   000000 701000 xent               TSX1    DBM$PACK4
         2 000161   000000 011000                    NOP     0

      129     6502    3           IF ROUTE$=0 OR ROUTEX>=NODES THEN DO;
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:20   

   6502  2 000162   200125 235100                    LDA     ROUTE$,,AUTO
         2 000163   000167 600000 2                  TZE     s:6503
         2 000164   200126 236100                    LDQ     ROUTEX,,AUTO
         2 000165   200130 116100                    CMPQ    NODES,,AUTO
         2 000166   000177 602000 2                  TNC     s:6511

      130     6503    4              IF TOP.NSUBLKS>0 THEN DO;

   6503  2 000167   200003 470500                    LDP0    @TOP,,AUTO
         2 000170   000001 220100                    LDX0    1,,PR0
         2 000171   000175 600000 2                  TZE     s:6509

      131     6504    4                 DA_ANLZERR='040204000000'O|%BINBIT(E$DB_NO_ROUTE,33);

   6504  2 000172   000065 236000 1                  LDQ     LINKFMT+19
         2 000173   000064 276000 1                  ORQ     LINKFMT+18
         2 000174   000000 756000 xsym               STQ     DA_ANLZERR

      132     6505        /*E*          ERROR:  DBD-E$DB_NO_ROUTE
      133     6506                      MESSAGE: Bad ROUTE index.
      134     6507        */
      135     6508    4                 END;

      136     6509    3              RETURN;

   6509  2 000175   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 000176   000001 702211                    TSX2  ! 1,X1

      137     6510    3              END;
      138     6511    3           CALL DBM$GETMEM(ROUTE$,KNN$ROUTE,,SIZEC(KNN$ROUTE),,SIZEC(KNN$ROUTE))
              6511                    WHENALTRETURN DO;

   6511  2 000177   000004 236000 3                  LDQ     4
         2 000200   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000201   200172 757100                    STAQ    @TEXT+6,,AUTO
         2 000202   000004 236000 3                  LDQ     4
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:21   
         2 000203   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000204   200170 757100                    STAQ    @TEXT+4,,AUTO
         2 000205   200071 630500                    EPPR0   KNN$ROUTE,,AUTO
         2 000206   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000207   200125 631500                    EPPR1   ROUTE$,,AUTO
         2 000210   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000211   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000212   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000213   000000 701000 xent               TSX1    DBM$GETMEM
         2 000214   000216 702000 2                  TSX2    s:6512
         2 000215   000220 710000 2                  TRA     s:6515

      139     6512    3              RETURN;

   6512  2 000216   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 000217   000001 702211                    TSX2  ! 1,X1

      140     6513    3              END;
      141     6514
      142     6515    2           ROUTE.NODE = ROUTEX;

   6515  2 000220   200126 235100                    LDA     ROUTEX,,AUTO
         2 000221   200136 755100                    STA     ROUTE,,AUTO

      143     6516    2           CALL DBM$PACK2(KNN$ROUTE.CURRENT_QOS,ROUTE.CURRENT_QOS);

   6516  2 000222   200141 630500                    EPPR0   ROUTE+3,,AUTO
         2 000223   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000224   200170 452500                    STP2    @TEXT+4,,AUTO
         2 000225   200170 236100                    LDQ     @TEXT+4,,AUTO
         2 000226   000005 036000 3                  ADLQ    5
         2 000227   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000230   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000231   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000232   000000 701000 xent               TSX1    DBM$PACK2
         2 000233   000000 011000                    NOP     0

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:22   
      144     6517    2           CALL DBM$PACK2(KNN$ROUTE.ALT_QOS,ROUTE.ALT_QOS);

   6517  2 000234   200142 630500                    EPPR0   ROUTE+4,,AUTO
         2 000235   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000236   200074 631500                    EPPR1   KNN$ROUTE+3,,AUTO
         2 000237   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000240   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000241   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000242   000000 701000 xent               TSX1    DBM$PACK2
         2 000243   000000 011000                    NOP     0

      145     6518    2           CALL DBM$PACK2(KNN$ROUTE.LINK#,ROUTE.LINK#);

   6518  2 000244   200137 630500                    EPPR0   ROUTE+1,,AUTO
         2 000245   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000246   200073 631500                    EPPR1   KNN$ROUTE+2,,AUTO
         2 000247   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000250   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000251   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000252   000000 701000 xent               TSX1    DBM$PACK2
         2 000253   000000 011000                    NOP     0

      146     6519    2           IF ROUTE.CURRENT_QOS = 255

   6519  2 000254   200141 235100                    LDA     ROUTE+3,,AUTO
         2 000255   000377 115007                    CMPA    255,DL
         2 000256   000260 601000 2                  TNZ     s:6522

      147     6520    2           THEN
      148     6521    2              ROUTE.LINK# = 0;

   6521  2 000257   200137 450100                    STZ     ROUTE+1,,AUTO

      149     6522    2           CALL YESNO(KNN$ROUTE.FLAGS.HOST_NODE,ROUTE.HOST_NODE);

   6522  2 000260   200143 630500                    EPPR0   ROUTE+5,,AUTO
         2 000261   200164 450500                    STP0    @FLAG+1,,AUTO
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:23   
         2 000262   200166 452500                    STP2    @TEXT+2,,AUTO
         2 000263   200166 236100                    LDQ     @TEXT+2,,AUTO
         2 000264   000006 036000 3                  ADLQ    6
         2 000265   200163 756100                    STQ     LINK+10,,AUTO
         2 000266   001005 701000 2                  TSX1    YESNO
         2 000267   000000 011000                    NOP     0

      150     6523    2           CALL YESNO(KNN$ROUTE.FLAGS.LINK_CONNECTED,ROUTE.LINK_CONNECTED);

   6523  2 000270   200144 630500                    EPPR0   ROUTE+6,,AUTO
         2 000271   200164 450500                    STP0    @FLAG+1,,AUTO
         2 000272   200166 452500                    STP2    @TEXT+2,,AUTO
         2 000273   200166 236100                    LDQ     @TEXT+2,,AUTO
         2 000274   000007 036000 3                  ADLQ    7
         2 000275   200163 756100                    STQ     LINK+10,,AUTO
         2 000276   001005 701000 2                  TSX1    YESNO
         2 000277   000000 011000                    NOP     0

      151     6524    2           CALL DBM$PACK4(KNN$ROUTE.CTX$,ROUTE.CTX$);

   6524  2 000300   200140 630500                    EPPR0   ROUTE+2,,AUTO
         2 000301   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000302   200072 631500                    EPPR1   KNN$ROUTE+1,,AUTO
         2 000303   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000304   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000305   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000306   000000 701000 xent               TSX1    DBM$PACK4
         2 000307   000000 011000                    NOP     0

      152     6525
      153     6526    2           IF ROUTE.CURRENT_QOS ~= 255 OR TOP.NSUBLKS ~= 0

   6526  2 000310   200141 235100                    LDA     ROUTE+3,,AUTO
         2 000311   000377 115007                    CMPA    255,DL
         2 000312   000316 601000 2                  TNZ     s:6528
         2 000313   200003 470500                    LDP0    @TOP,,AUTO
         2 000314   000001 220100                    LDX0    1,,PR0
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:24   
         2 000315   000334 600000 2                  TZE     s:6529

      154     6527    2           THEN
      155     6528    2              CALL DAF$WRITE(VECTOR(ROUTEFMT),VECTOR(ROUTE));

   6528  2 000316   000012 235000 3                  LDA     10
         2 000317   200166 452500                    STP2    @TEXT+2,,AUTO
         2 000320   200166 236100                    LDQ     @TEXT+2,,AUTO
         2 000321   000136 036003                    ADLQ    94,DU
         2 000322   200170 757100                    STAQ    @TEXT+4,,AUTO
         2 000323   200170 630500                    EPPR0   @TEXT+4,,AUTO
         2 000324   200173 450500                    STP0    @TEXT+7,,AUTO
         2 000325   000013 236000 3                  LDQ     11
         2 000326   200172 756100                    STQ     @TEXT+6,,AUTO
         2 000327   200172 630500                    EPPR0   @TEXT+6,,AUTO
         2 000330   000000 220000 xsym               LDX0    DAF$WRITE
         2 000331   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000332   000000 701010                    TSX1    0,X0
         2 000333   000000 011000                    NOP     0

      156     6529    3              DO I = 0 TO LINKS - 1;

   6529  2 000334   200134 450100                    STZ     I,,AUTO
         2 000335   000466 710000 2                  TRA     s:6543+1

      157     6530    3                 LINK$ = ROUTE$ + POFFC(ADDR(KNN$ROUTE.LINK(I)),ADDR(KNN$ROUTE))/2;

   6530  2 000336   200166 452500                    STP2    @TEXT+2,,AUTO
         2 000337   200166 236100                    LDQ     @TEXT+2,,AUTO
         2 000340   000071 036003                    ADLQ    57,DU
         2 000341   000020 772000                    QRL     16
         2 000342   200167 452500                    STP2    @TEXT+3,,AUTO
         2 000343   200170 756100                    STQ     @TEXT+4,,AUTO
         2 000344   200134 236100                    LDQ     I,,AUTO
         2 000345   000014 402000 3                  MPY     12
         2 000346   000075 036003                    ADLQ    61,DU
         2 000347   200167 036100                    ADLQ    @TEXT+3,,AUTO
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:25   
         2 000350   000020 772000                    QRL     16
         2 000351   200170 136100                    SBLQ    @TEXT+4,,AUTO
         2 000352   000002 506007                    DIV     2,DL
         2 000353   200125 036100                    ADLQ    ROUTE$,,AUTO
         2 000354   200133 756100                    STQ     LINK$,,AUTO

      158     6531    3                 CALL DBM$GETMEM(LINK$,KNN$ROUTE.LINK(0),,SIZEC(KNN$ROUTE.LINK(0)),,
              6531                          SIZEC(KNN$ROUTE.LINK(0)))

   6531  2 000355   000015 236000 3                  LDQ     13
         2 000356   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000357   200172 757100                    STAQ    @TEXT+6,,AUTO
         2 000360   000015 236000 3                  LDQ     13
         2 000361   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000362   200170 757100                    STAQ    @TEXT+4,,AUTO
         2 000363   200075 630500                    EPPR0   KNN$ROUTE+4,,AUTO
         2 000364   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000365   200133 631500                    EPPR1   LINK$,,AUTO
         2 000366   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000367   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000370   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000371   000000 701000 xent               TSX1    DBM$GETMEM
         2 000372   000465 702000 2                  TSX2    s:6543

      159     6532    4                 WHENRETURN DO;

      160     6533    4                    IF KNN$ROUTE.LINK.ACTIVE(0) AND KNN$ROUTE.LINK.QOS(0) ~= 255

   6533  2 000373   200075 236100                    LDQ     KNN$ROUTE+4,,AUTO
         2 000374   200000 316003                    CANQ    65536,DU
         2 000375   000402 600000 2                  TZE     s:6533+7
         2 000376   200075 236100                    LDQ     KNN$ROUTE+4,,AUTO
         2 000377   000777 376003                    ANQ     511,DU
         2 000400   000377 116003                    CMPQ    255,DU
         2 000401   000415 601000 2                  TNZ     s:6536
         2 000402   200076 235100                    LDA     KNN$ROUTE+5,,AUTO
         2 000403   200077 236100                    LDQ     KNN$ROUTE+6,,AUTO
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:26   
         2 000404   000026 773000                    LRL     22
         2 000405   000016 376000 3                  ANQ     14
         2 000406   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000407   200075 235100                    LDA     KNN$ROUTE+4,,AUTO
         2 000410   200076 236100                    LDQ     KNN$ROUTE+5,,AUTO
         2 000411   000026 773000                    LRL     22
         2 000412   000016 376000 3                  ANQ     14
         2 000413   200166 036100                    ADLQ    @TEXT+2,,AUTO
         2 000414   000465 600000 2                  TZE     s:6543

      161     6534    4                   OR (KNN$ROUTE.LINK.MSGS_IN(0) + KNN$ROUTE.LINK.MSGS_OUT(0))~=0
      162     6535    5                    THEN DO;

      163     6536    5                       ROUTELINK.LINK = I;

   6536  2 000415   200134 235100                    LDA     I,,AUTO
         2 000416   200145 755100                    STA     ROUTELINK,,AUTO

      164     6537    5                       ROUTELINK.QOS = KNN$ROUTE.LINK.QOS(0);

   6537  2 000417   200075 236100                    LDQ     KNN$ROUTE+4,,AUTO
         2 000420   000022 772000                    QRL     18
         2 000421   000777 376007                    ANQ     511,DL
         2 000422   200146 756100                    STQ     ROUTELINK+1,,AUTO

      165     6538    5                       CALL DBM$PACK4(KNN$ROUTE.LINK.MSGS_IN(0),ROUTELINK.MSGS_IN);

   6538  2 000423   200147 630500                    EPPR0   ROUTELINK+2,,AUTO
         2 000424   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000425   200170 452500                    STP2    @TEXT+4,,AUTO
         2 000426   200170 236100                    LDQ     @TEXT+4,,AUTO
         2 000427   000017 036000 3                  ADLQ    15
         2 000430   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000431   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000432   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000433   000000 701000 xent               TSX1    DBM$PACK4
         2 000434   000000 011000                    NOP     0
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:27   

      166     6539    5                       CALL DBM$PACK4(KNN$ROUTE.LINK.MSGS_OUT(0),ROUTELINK.MSGS_OUT);

   6539  2 000435   200150 630500                    EPPR0   ROUTELINK+3,,AUTO
         2 000436   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000437   200170 452500                    STP2    @TEXT+4,,AUTO
         2 000440   200170 236100                    LDQ     @TEXT+4,,AUTO
         2 000441   000020 036000 3                  ADLQ    16
         2 000442   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000443   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000444   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000445   000000 701000 xent               TSX1    DBM$PACK4
         2 000446   000000 011000                    NOP     0

      167     6540    5                       CALL DAF$WRITE(VECTOR(ROUTELINKFMT),VECTOR(ROUTELINK));

   6540  2 000447   000021 235000 3                  LDA     17
         2 000450   200166 452500                    STP2    @TEXT+2,,AUTO
         2 000451   200166 236100                    LDQ     @TEXT+2,,AUTO
         2 000452   000145 036003                    ADLQ    101,DU
         2 000453   200170 757100                    STAQ    @TEXT+4,,AUTO
         2 000454   200170 630500                    EPPR0   @TEXT+4,,AUTO
         2 000455   200173 450500                    STP0    @TEXT+7,,AUTO
         2 000456   000024 236000 3                  LDQ     20
         2 000457   200172 756100                    STQ     @TEXT+6,,AUTO
         2 000460   200172 630500                    EPPR0   @TEXT+6,,AUTO
         2 000461   000000 220000 xsym               LDX0    DAF$WRITE
         2 000462   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000463   000000 701010                    TSX1    0,X0
         2 000464   000000 011000                    NOP     0

      168     6541    5                       END;

      169     6542    4                    END;

      170     6543    3                 END;

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:28   
   6543  2 000465   200134 054100                    AOS     I,,AUTO
         2 000466   200134 236100                    LDQ     I,,AUTO
         2 000467   000336 604000 2                  TMI     s:6530
         2 000470   200131 116100                    CMPQ    LINKS,,AUTO
         2 000471   000336 602000 2                  TNC     s:6530

      171     6544
      172     6545    2           RETURN;

   6545  2 000472   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 000473   000001 702211                    TSX2  ! 1,X1

      173     6546
      174     6547    2   END DIROUTE;
      175     6548    1   DBD$LINK: ENTRY(TOP);

   6548  2 000474   000000 700200 xent  DBD$LINK     TSX0  ! X66_AUTO_1
         2 000475   000176 000001                    ZERO    126,1

      176     6549    1           CALL DBM$GETBOBCAT(G$BOBCAT);

   6549  2 000476   200004 630500                    EPPR0   G$BOBCAT,,AUTO
         2 000477   200166 450500                    STP0    @TEXT+2,,AUTO
         2 000500   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000501   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000502   000000 701000 xent               TSX1    DBM$GETBOBCAT
         2 000503   000000 011000                    NOP     0

      177     6550    1           CALL DBM$PACK2(G$BOBCAT.LINKS,LINKS);

   6550  2 000504   200131 630500                    EPPR0   LINKS,,AUTO
         2 000505   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000506   200017 631500                    EPPR1   G$BOBCAT+11,,AUTO
         2 000507   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000510   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000511   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000512   000000 701000 xent               TSX1    DBM$PACK2
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:29   
         2 000513   000000 011000                    NOP     0

      178     6551    1           CALL DBM$PACK4(G$BOBCAT.LINK$$,LINK$$);

   6551  2 000514   200132 630500                    EPPR0   LINK$$,,AUTO
         2 000515   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000516   200035 631500                    EPPR1   G$BOBCAT+25,,AUTO
         2 000517   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000520   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000521   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000522   000000 701000 xent               TSX1    DBM$PACK4
         2 000523   000000 011000                    NOP     0

      179     6552
      180     6553    2           IF TOP.NSUBLKS=0 THEN DO;

   6553  2 000524   200003 470500                    LDP0    @TOP,,AUTO
         2 000525   000001 220100                    LDX0    1,,PR0
         2 000526   000542 601000 2                  TNZ     s:6559

      181     6554    3              DO LINKX=0 TO LINKS;

   6554  2 000527   200127 450100                    STZ     LINKX,,AUTO
         2 000530   000536 710000 2                  TRA     s:6556+3

      182     6555    3                 CALL DILINK;

   6555  2 000531   000572 701000 2                  TSX1    DILINK
         2 000532   000000 011000                    NOP     0

      183     6556    3                 END;

   6556  2 000533   200127 235100                    LDA     LINKX,,AUTO
         2 000534   000001 035007                    ADLA    1,DL
         2 000535   200127 755100                    STA     LINKX,,AUTO
         2 000536   200131 236100                    LDQ     LINKS,,AUTO
         2 000537   200127 116100                    CMPQ    LINKX,,AUTO
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:30   
         2 000540   000531 603000 2                  TRC     s:6555

      184     6557    2              END;

   6557  2 000541   000571 710000 2                  TRA     s:6565

      185     6558    2           ELSE DO;

      186     6559    3              DO TX=0 TO TOP.NSUBLKS-1;

   6559  2 000542   200135 450100                    STZ     TX,,AUTO
         2 000543   000563 710000 2                  TRA     s:6563+3

      187     6560    4                 CALL DAA$VALUE(TOP.SUBLK$(TX)->OUT,LINKX) WHENRETURN DO;

   6560  2 000544   200003 470500                    LDP0    @TOP,,AUTO
         2 000545   200135 720100                    LXL0    TX,,AUTO
         2 000546   000003 471510                    LDP1    3,X0,PR0
         2 000547   200127 633500                    EPPR3   LINKX,,AUTO
         2 000550   200167 453500                    STP3    @TEXT+3,,AUTO
         2 000551   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000552   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000553   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000554   000000 701000 xent               TSX1    DAA$VALUE
         2 000555   000560 702000 2                  TSX2    s:6563

      188     6561    4                    CALL DILINK;

   6561  2 000556   000572 701000 2                  TSX1    DILINK
         2 000557   000000 011000                    NOP     0

      189     6562    4                    END;

      190     6563    3                 END;

   6563  2 000560   200135 235100                    LDA     TX,,AUTO
         2 000561   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:31   
         2 000562   200135 755100                    STA     TX,,AUTO
         2 000563   200003 470500                    LDP0    @TOP,,AUTO
         2 000564   000001 236100                    LDQ     1,,PR0
         2 000565   000022 772000                    QRL     18
         2 000566   200135 116100                    CMPQ    TX,,AUTO
         2 000567   000571 600000 2                  TZE     s:6565
         2 000570   000544 603000 2                  TRC     s:6560

      191     6564    2              END;

      192     6565    1           RETURN;

   6565  2 000571   000000 702200 xent               TSX2  ! X66_ARET

      193     6566
      194     6567
      195     6568    1   DILINK: PROC;

   6568  2 000572   200160 741300       DILINK       STX1  ! LINK+7,,AUTO

      196     6569
      197     6570    3           CALL DBM$GETMEM(LINK$$+LINKX*2,LINK$,,4,,4) WHENALTRETURN DO;

   6570  2 000573   200127 236100                    LDQ     LINKX,,AUTO
         2 000574   000001 736000                    QLS     1
         2 000575   200132 036100                    ADLQ    LINK$$,,AUTO
         2 000576   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000577   000001 236000 3                  LDQ     1
         2 000600   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000601   200174 757100                    STAQ    @TEXT+8,,AUTO
         2 000602   000001 236000 3                  LDQ     1
         2 000603   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000604   200172 757100                    STAQ    @TEXT+6,,AUTO
         2 000605   200133 630500                    EPPR0   LINK$,,AUTO
         2 000606   200171 450500                    STP0    @TEXT+5,,AUTO
         2 000607   200166 631500                    EPPR1   @TEXT+2,,AUTO
         2 000610   200170 451500                    STP1    @TEXT+4,,AUTO
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:32   
         2 000611   200170 630500                    EPPR0   @TEXT+4,,AUTO
         2 000612   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000613   000000 701000 xent               TSX1    DBM$GETMEM
         2 000614   000616 702000 2                  TSX2    s:6571
         2 000615   000620 710000 2                  TRA     s:6573

      198     6571    3              RETURN;

   6571  2 000616   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 000617   000001 702211                    TSX2  ! 1,X1

      199     6572    3              END;
      200     6573    2           CALL DAF$INIT(LINKRPT);

   6573  2 000620   000025 630400 3                  EPPR0   21
         2 000621   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000622   000000 701000 xent               TSX1    DAF$INIT
         2 000623   000000 011000                    NOP     0

      201     6574    2           CALL DBM$PACK4(LINK$,LINK$);

   6574  2 000624   200133 630500                    EPPR0   LINK$,,AUTO
         2 000625   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000626   200133 631500                    EPPR1   LINK$,,AUTO
         2 000627   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000630   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000631   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000632   000000 701000 xent               TSX1    DBM$PACK4
         2 000633   000000 011000                    NOP     0

      202     6575    3           IF LINK$=0 OR LINKX>=LINKS THEN DO;

   6575  2 000634   200133 235100                    LDA     LINK$,,AUTO
         2 000635   000641 600000 2                  TZE     s:6576
         2 000636   200127 236100                    LDQ     LINKX,,AUTO
         2 000637   200131 116100                    CMPQ    LINKS,,AUTO
         2 000640   000651 602000 2                  TNC     s:6584
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:33   

      203     6576    4              IF TOP.NSUBLKS>0 THEN DO;

   6576  2 000641   200003 470500                    LDP0    @TOP,,AUTO
         2 000642   000001 220100                    LDX0    1,,PR0
         2 000643   000647 600000 2                  TZE     s:6582

      204     6577    4                 DA_ANLZERR='040204000000'O|%BINBIT(E$DB_NO_LINK,33);

   6577  2 000644   000066 236000 1                  LDQ     LINKFMT+20
         2 000645   000064 276000 1                  ORQ     LINKFMT+18
         2 000646   000000 756000 xsym               STQ     DA_ANLZERR

      205     6578        /*E*          ERROR:  DBD-E$DB_NO_LINK
      206     6579                      MESSAGE: Bad LINK index.
      207     6580        */
      208     6581    4                 END;

      209     6582    3              RETURN;

   6582  2 000647   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 000650   000001 702211                    TSX2  ! 1,X1

      210     6583    3              END;
      211     6584    3           CALL DBM$GETMEM(LINK$,KNN$LINK,,SIZEC(KNN$LINK),,SIZEC(KNN$LINK))
              6584                    WHENALTRETURN DO;

   6584  2 000651   000027 236000 3                  LDQ     23
         2 000652   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000653   200172 757100                    STAQ    @TEXT+6,,AUTO
         2 000654   000027 236000 3                  LDQ     23
         2 000655   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000656   200170 757100                    STAQ    @TEXT+4,,AUTO
         2 000657   200100 630500                    EPPR0   KNN$LINK,,AUTO
         2 000660   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000661   200133 631500                    EPPR1   LINK$,,AUTO
         2 000662   200166 451500                    STP1    @TEXT+2,,AUTO
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:34   
         2 000663   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000664   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000665   000000 701000 xent               TSX1    DBM$GETMEM
         2 000666   000670 702000 2                  TSX2    s:6585
         2 000667   000672 710000 2                  TRA     s:6588

      212     6585    3              RETURN;

   6585  2 000670   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 000671   000001 702211                    TSX2  ! 1,X1

      213     6586    3              END;
      214     6587
      215     6588    2           LINK.LINK#= LINKX;

   6588  2 000672   200127 235100                    LDA     LINKX,,AUTO
         2 000673   200151 755100                    STA     LINK,,AUTO

      216     6589    2           CALL DBM$PACK2(KNN$LINK.QOS,LINK.QOS);

   6589  2 000674   200155 630500                    EPPR0   LINK+4,,AUTO
         2 000675   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000676   200102 631500                    EPPR1   KNN$LINK+2,,AUTO
         2 000677   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000700   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000701   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000702   000000 701000 xent               TSX1    DBM$PACK2
         2 000703   000000 011000                    NOP     0

      217     6590    2           CALL DBM$PACK2(KNN$LINK.NODE#,LINK.NODE#);

   6590  2 000704   200153 630500                    EPPR0   LINK+2,,AUTO
         2 000705   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000706   200101 631500                    EPPR1   KNN$LINK+1,,AUTO
         2 000707   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000710   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000711   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:35   
         2 000712   000000 701000 xent               TSX1    DBM$PACK2
         2 000713   000000 011000                    NOP     0

      218     6591    2           CALL YESNO(KNN$LINK.FLAGS.HOST_NODE,LINK.HOST_NODE);

   6591  2 000714   200154 630500                    EPPR0   LINK+3,,AUTO
         2 000715   200164 450500                    STP0    @FLAG+1,,AUTO
         2 000716   200166 452500                    STP2    @TEXT+2,,AUTO
         2 000717   200166 236100                    LDQ     @TEXT+2,,AUTO
         2 000720   000030 036000 3                  ADLQ    24
         2 000721   200163 756100                    STQ     LINK+10,,AUTO
         2 000722   001005 701000 2                  TSX1    YESNO
         2 000723   000000 011000                    NOP     0

      219     6592    2           CALL DBM$PACK4(KNN$LINK.LDCT$,LINK.LDCT$);

   6592  2 000724   200152 630500                    EPPR0   LINK+1,,AUTO
         2 000725   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000726   200100 631500                    EPPR1   KNN$LINK,,AUTO
         2 000727   200166 451500                    STP1    @TEXT+2,,AUTO
         2 000730   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000731   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000732   000000 701000 xent               TSX1    DBM$PACK4
         2 000733   000000 011000                    NOP     0

      220     6593    2           CALL DBM$PACK4(KNN$LINK.MSGS_IN,LINK.MSGS_IN);

   6593  2 000734   200156 630500                    EPPR0   LINK+5,,AUTO
         2 000735   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000736   200170 452500                    STP2    @TEXT+4,,AUTO
         2 000737   200170 236100                    LDQ     @TEXT+4,,AUTO
         2 000740   000031 036000 3                  ADLQ    25
         2 000741   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000742   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000743   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000744   000000 701000 xent               TSX1    DBM$PACK4
         2 000745   000000 011000                    NOP     0
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:36   

      221     6594    2           CALL DBM$PACK4(KNN$LINK.MSGS_OUT,LINK.MSGS_OUT);

   6594  2 000746   200157 630500                    EPPR0   LINK+6,,AUTO
         2 000747   200167 450500                    STP0    @TEXT+3,,AUTO
         2 000750   200170 452500                    STP2    @TEXT+4,,AUTO
         2 000751   200170 236100                    LDQ     @TEXT+4,,AUTO
         2 000752   000032 036000 3                  ADLQ    26
         2 000753   200166 756100                    STQ     @TEXT+2,,AUTO
         2 000754   200166 630500                    EPPR0   @TEXT+2,,AUTO
         2 000755   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000756   000000 701000 xent               TSX1    DBM$PACK4
         2 000757   000000 011000                    NOP     0

      222     6595
      223     6596    2           IF LINK.LDCT$ ~= 0 OR TOP.NSUBLKS ~= 0

   6596  2 000760   200152 235100                    LDA     LINK+1,,AUTO
         2 000761   000765 601000 2                  TNZ     s:6598
         2 000762   200003 470500                    LDP0    @TOP,,AUTO
         2 000763   000001 220100                    LDX0    1,,PR0
         2 000764   001003 600000 2                  TZE     s:6600

      224     6597    2           THEN
      225     6598    2              CALL DAF$WRITE(VECTOR(LINKFMT),VECTOR(LINK));

   6598  2 000765   000012 235000 3                  LDA     10
         2 000766   200166 452500                    STP2    @TEXT+2,,AUTO
         2 000767   200166 236100                    LDQ     @TEXT+2,,AUTO
         2 000770   000151 036003                    ADLQ    105,DU
         2 000771   200170 757100                    STAQ    @TEXT+4,,AUTO
         2 000772   200170 630500                    EPPR0   @TEXT+4,,AUTO
         2 000773   200173 450500                    STP0    @TEXT+7,,AUTO
         2 000774   000033 236000 3                  LDQ     27
         2 000775   200172 756100                    STQ     @TEXT+6,,AUTO
         2 000776   200172 630500                    EPPR0   @TEXT+6,,AUTO
         2 000777   000000 220000 xsym               LDX0    DAF$WRITE
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:37   
         2 001000   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001001   000000 701010                    TSX1    0,X0
         2 001002   000000 011000                    NOP     0

      226     6599
      227     6600    2           RETURN;

   6600  2 001003   200160 221300                    LDX1  ! LINK+7,,AUTO
         2 001004   000001 702211                    TSX2  ! 1,X1

      228     6601
      229     6602    2   END DILINK;
      230     6603
      231     6604    1   YESNO:  PROC(FLAG,TEXT);

   6604  2 001005   200162 741300       YESNO        STX1  ! LINK+9,,AUTO

      232     6605
      233     6606    2   DCL FLAG BIT(1) UNAL;
      234     6607    2   DCL TEXT CHAR(4);
      235     6608
      236     6609    2           IF FLAG THEN

   6609  2 001006   200163 470500                    LDP0    @FLAG,,AUTO
         2 001007   000000 066500                    CMPB    filb='0'B
         2 001010   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 001011   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 001012   001020 600000 2                  TZE     s:6612

      237     6610    2              TEXT='Yes';

   6610  2 001013   200164 471500                    LDP1    @TEXT,,AUTO
         2 001014   040100 100400                    MLR     fill='040'O
         2 001015   000067 000003 1                  ADSC9   LINKFMT+21               cn=0,n=3
         2 001016   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         2 001017   001024 710000 2                  TRA     s:6613

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:38   
      238     6611    2           ELSE
      239     6612    2              TEXT='No';

   6612  2 001020   200164 471500                    LDP1    @TEXT,,AUTO
         2 001021   040100 100400                    MLR     fill='040'O
         2 001022   000070 000002 1                  ADSC9   LINKFMT+22               cn=0,n=2
         2 001023   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

      240     6613    2           RETURN;

   6613  2 001024   200162 221300                    LDX1  ! LINK+9,,AUTO
         2 001025   000001 702211                    TSX2  ! 1,X1
      241     6614
      242     6615    2   END YESNO;
      243     6616
      244     6617    1   END DBD$ROUTE;

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:39   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   DB_PERR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DBD$ROUTE.
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:40   

 **** Variables and constants ****

  ****  Section 000  Data  DBD$ROUTE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w STRC(288)   r     1 LINKRPT                   22-0-0/c STRC(54)    r     1 LINKRPTTX00
     0-0-0/w STRC(288)   r     1 ROUTERPT                  10-0-0/c STRC(63)    r     1 ROUTERPTTX00

  ****  Section 001 RoData DBD$ROUTE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    42-0-0/c STRC(630)   r     1 LINKFMT                    0-0-0/c STRC(675)   r     1 ROUTEFMT
    23-0-0/c STRC(531)   r     1 ROUTELINKFMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   163-0-0/w PTR         r     1 @FLAG                    164-0-0/w PTR         r     1 @TEXT
     3-0-0/w PTR         r     1 @TOP                      *0-0-0/b BIT         r     1 FLAG
     4-0-0/w STRC(1908)  r     1 G$BOBCAT                 134-0-0/w SBIN        r     1 I
   100-0-0/c STRC(684)   r     1 KNN$LINK                  71-0-0/w STRC(234)   r     1 KNN$ROUTE
   151-0-0/w STRC(252)   r     1 LINK                     133-0-0/w UBIN        r     1 LINK$
   132-0-0/w UBIN        r     1 LINK$$                   131-0-0/w UBIN        r     1 LINKS
   127-0-0/w UBIN        r     1 LINKX                    130-0-0/w UBIN        r     1 NODES
   136-0-0/w STRC(252)   r     1 ROUTE                    125-0-0/w UBIN        r     1 ROUTE$
   124-0-0/w UBIN        r     1 ROUTE$$                  145-0-0/w STRC(144)   r     1 ROUTELINK
   126-0-0/w UBIN        r     1 ROUTEX                    *0-0-0/c CHAR(4)     r     1 TEXT
    *0-0-0/w STRC(144)   r     1 TOP                      135-0-0/w UBIN        r     1 TX

  ****  SYMREF variables  ****

PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:41   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/w STRC        r     1 DA_ANLZERR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT


   Procedure DBD$ROUTE requires 534 words for executable code.
   Procedure DBD$ROUTE requires 126 words of local(AUTO) storage.

    No errors detected in file DBD$ROUTE.:E05TSI    .
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:42   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:43   
          MINI XREF LISTING

DAA$VALUE
      5934**DCL-ENT  6487--CALL     6560--CALL
DAF$INIT
      5936**DCL-ENT  6500--CALL     6573--CALL
DAF$WRITE
      5935**DCL      6528>>CALL     6540>>CALL     6598>>CALL
DA_ANLZERR
      2731**DCL      6504<<ASSIGN   6577<<ASSIGN
DBM$GETBOBCAT
      5938**DCL-ENT  6474--CALL     6549--CALL
DBM$GETMEM
      5939**DCL-ENT  6497--CALL     6511--CALL     6531--CALL     6570--CALL     6584--CALL
DBM$PACK2
      5941**DCL-ENT  6475--CALL     6476--CALL     6516--CALL     6517--CALL     6518--CALL     6550--CALL
      6589--CALL     6590--CALL
DBM$PACK4
      5942**DCL-ENT  6477--CALL     6478--CALL     6501--CALL     6524--CALL     6538--CALL     6539--CALL
      6551--CALL     6574--CALL     6592--CALL     6593--CALL     6594--CALL
DILINK
      6568**PROC     6555--CALL     6561--CALL
DIROUTE
      6495**PROC     6482--CALL     6488--CALL
FLAG IN PROCEDURE YESNO
      6606**DCL      6604--PROC     6609>>IF
G$BOBCAT
      6079**DCL      6474<>CALL     6549<>CALL
G$BOBCAT.LINK$$
      6085**DCL      6478<>CALL     6551<>CALL
G$BOBCAT.LINKS
      6082**DCL      6476<>CALL     6550<>CALL
G$BOBCAT.NODES
      6082**DCL      6475<>CALL
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:44   
G$BOBCAT.ROUTE$$
      6085**DCL      6477<>CALL
I
      6423**DCL      6529<<DOINDEX  6530>>ASSIGN   6536>>ASSIGN
KNN$LINK
      6164**DCL      6584<>CALL     6584--CALL     6584--CALL
KNN$LINK.DEST.ADDRESS_N
      6351**DCL      6352--REDEF
KNN$LINK.FLAGS.HOST_NODE
      6196**DCL      6591<>CALL
KNN$LINK.LADR.ADDRESS_N
      6294**DCL      6295--REDEF
KNN$LINK.LDCT$
      6165**DCL      6172--REDEF    6592<>CALL
KNN$LINK.MSGS_IN
      6229**DCL      6593<>CALL
KNN$LINK.MSGS_OUT
      6238**DCL      6594<>CALL
KNN$LINK.NODE#
      6178**DCL      6590<>CALL
KNN$LINK.QOS
      6222**DCL      6589<>CALL
KNN$ROUTE
      6092**DCL      6511<>CALL     6511--CALL     6511--CALL     6530--ASSIGN
KNN$ROUTE.ALT_QOS
      6113**DCL      6517<>CALL
KNN$ROUTE.CTX$
      6099**DCL      6524<>CALL
KNN$ROUTE.CURRENT_QOS
      6110**DCL      6516<>CALL
KNN$ROUTE.FLAGS.HOST_NODE
      6120**DCL      6522<>CALL
KNN$ROUTE.FLAGS.LINK_CONNECTED
      6124**DCL      6523<>CALL
KNN$ROUTE.LINK
      6133**DCL      6530--ASSIGN   6531<>CALL     6531--CALL     6531--CALL
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:45   
KNN$ROUTE.LINK.ACTIVE
      6144**DCL      6533>>IF
KNN$ROUTE.LINK.MSGS_IN
      6152**DCL      6533>>IF       6538<>CALL
KNN$ROUTE.LINK.MSGS_OUT
      6157**DCL      6533>>IF       6539<>CALL
KNN$ROUTE.LINK.QOS
      6149**DCL      6533>>IF       6537>>ASSIGN
KNN$ROUTE.LINK#
      6105**DCL      6518<>CALL
LINK
      6441**DCL      6598--CALL
LINK.HOST_NODE
      6445**DCL      6591<>CALL
LINK.LDCT$
      6443**DCL      6592<>CALL     6596>>IF
LINK.LINK#
      6442**DCL      6588<<ASSIGN
LINK.MSGS_IN
      6447**DCL      6593<>CALL
LINK.MSGS_OUT
      6448**DCL      6594<>CALL
LINK.NODE#
      6444**DCL      6590<>CALL
LINK.QOS
      6446**DCL      6589<>CALL
LINK$
      6422**DCL      6530<<ASSIGN   6531<>CALL     6570<>CALL     6574<>CALL     6574<>CALL     6575>>IF
      6584<>CALL
LINK$$
      6421**DCL      6478<>CALL     6551<>CALL     6570>>CALL
LINKFMT
      6464**DCL      6598--CALL
LINKRPT
      6027**DCL      6573<>CALL
LINKRPTTX00
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:46   
      6070**DCL      6057--DCLINIT
LINKS
      6420**DCL      6476<>CALL     6529>>DOINDEX  6550<>CALL     6554>>DOINDEX  6575>>IF
LINKX
      6418**DCL      6554<<DOINDEX  6560<>CALL     6570>>CALL     6575>>IF       6588>>ASSIGN
NODES
      6419**DCL      6475<>CALL     6481>>DOINDEX  6502>>IF
OUT
      5894**DCL      6487<>CALL     6560<>CALL
ROUTE
      6426**DCL      6528--CALL
ROUTE.ALT_QOS
      6431**DCL      6517<>CALL
ROUTE.CTX$
      6429**DCL      6524<>CALL
ROUTE.CURRENT_QOS
      6430**DCL      6516<>CALL     6519>>IF       6526>>IF
ROUTE.HOST_NODE
      6432**DCL      6522<>CALL
ROUTE.LINK#
      6428**DCL      6518<>CALL     6521<<ASSIGN
ROUTE.LINK_CONNECTED
      6433**DCL      6523<>CALL
ROUTE.NODE
      6427**DCL      6515<<ASSIGN
ROUTE$
      6416**DCL      6497<>CALL     6501<>CALL     6501<>CALL     6502>>IF       6511<>CALL     6530>>ASSIGN
ROUTE$$
      6415**DCL      6477<>CALL     6497>>CALL
ROUTEFMT
      6449**DCL      6528--CALL
ROUTELINK
      6435**DCL      6540--CALL
ROUTELINK.LINK
      6436**DCL      6536<<ASSIGN
ROUTELINK.MSGS_IN
PL6.E3A0      #001=DBD$ROUTE File=DBD$ROUTE.:E05TSI                              TUE 07/29/97 13:09 Page:47   
      6438**DCL      6538<>CALL
ROUTELINK.MSGS_OUT
      6439**DCL      6539<>CALL
ROUTELINK.QOS
      6437**DCL      6537<<ASSIGN
ROUTELINKFMT
      6458**DCL      6540--CALL
ROUTERPT
      5961**DCL      6500<>CALL
ROUTERPTTX00
      6004**DCL      5991--DCLINIT
ROUTEX
      6417**DCL      6481<<DOINDEX  6487<>CALL     6497>>CALL     6502>>IF       6515>>ASSIGN
TEXT IN PROCEDURE YESNO
      6607**DCL      6604--PROC     6610<<ASSIGN   6612<<ASSIGN
TOP
      5849**DCL         8--PROC     6548--ENTRY
TOP.NSUBLKS
      5861**DCL      6480>>IF       6486>>DOINDEX  6503>>IF       6526>>IF       6553>>IF       6559>>DOINDEX
      6576>>IF       6596>>IF
TOP.SUBLK$
      5882**DCL      6487>>CALL     6560>>CALL
TX
      6424**DCL      6486<<DOINDEX  6487>>CALL     6559<<DOINDEX  6560>>CALL
YESNO
      6604**PROC     6522--CALL     6523--CALL     6591--CALL
