VERSION E05

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:1    
        1        1        /*M* KQZ$SUBS - General subroutines for comgroups */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=2
                 8        ,IAD=0,PRB */
        9        9        /**/
       10       10        /*P* NAME:             KQZ$SUBS
       11       11             PURPOSE:          General subroutines for comgroups.
       12       12        */
       13       13
       14       14
       15       15        KQZ$LOG: PROC(KQ$CG,TYP,BYT,HW1,HW2,W1,W2,BFR$) ALTRET;
       16       16
       17       17
       18       18        /**/
       19       19        /* Includes */
       20       20        /**/
       21       21        %INCLUDE HF_LOCK_C;
       22       35        %INCLUDE KC$CP6V_C;
       23      155        %INCLUDE KC_CP6;
       24      715        %INCLUDE KQ_MAC_C;
       25     3265        %INCLUDE KQ_DATA_R;
       26     4097        %INCLUDE KQM_MAC_C;
       27     4470
       28     4471
       29     4472        /**/
       30     4473        /* Parameters */
       31     4474        /**/
       32     4475        %KQ_CG (FPTN=KQ$CG,STCLASS=);
       33     5214    1   DCL TYP UBIN;
       34     5215    1   DCL BYT UBIN;
       35     5216    1   DCL HW1 UBIN;
       36     5217    1   DCL HW2 UBIN HALF HALIGNED;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:2    
       37     5218    1   DCL W1 UBIN;
       38     5219    1   DCL W2 UBIN;
       39     5220    1   DCL BFR$ PTR;
       40     5221
       41     5222
       42     5223        /**/
       43     5224        /* Based Structures */
       44     5225        /**/
       45     5226        %KQ_CG (FPTN=KQ$CGB,STCLASS=BASED);
       46     5965        %KQ_LOGENT (FPTN=KQ$LOGENT,STCLASS="BASED(LOG$)");
       47     6007        %KQ_LOGHDR (FPTN=KQ$LOGHDR,STCLASS="BASED(KQ_CURLOG$)");
       48     6028        %KQ_MMSD (FPTN=KQ$MMSD,STCLASS="BASED(KQ_MMSD$)");
       49     6065    1   DCL 1 STK BASED ALIGNED,
       50     6066    1         2 RETADDR UBIN(18) HALIGNED,
       51     6067    1         2 DISP SBIN(18) HALIGNED;
       52     6068    1   DCL 1 CHARSK BASED ALIGNED,
       53     6069    1         2 * CHAR(K);
       54     6070
       55     6071
       56     6072        /**/
       57     6073        /* Auto */
       58     6074        /**/
       59     6075    1   DCL LOG$ PTR;
       60     6076    1   DCL T$ PTR;
       61     6077    1   DCL 1 T REDEF T$,
       62     6078    1         2 DISP UBIN(18) UNAL,
       63     6079    1         2 * BIT(18);
       64     6080    1   DCL BASE$ REDEF T$ PTR;
       65     6081    1   DCL LOG_FLG BIT(1);
       66     6082    1   DCL I UBIN;
       67     6083    1   DCL J UBIN;
       68     6084    1   DCL CUR$ REDEF J PTR;
       69     6085    1   DCL K UBIN;
       70     6086    1   DCL 1 INTRET,
       71     6087    1         2 RET UBIN(18) UNAL,
       72     6088    1         2 X2 UBIN(18) UNAL;
       73     6089
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:3    
       74     6090
       75     6091        /**/
       76     6092        /* External Routines */
       77     6093        /**/
       78     6094    1   DCL FMR$FNDSTK ENTRY(2);
       79     6095    1   DCL KQM$GETB ENTRY(3) ALTRET;
       80     6096    1   DCL KQM$RELB ENTRY(3) ALTRET;
       81     6097    1   DCL KQX$RETADDR ENTRY(1);
       82     6098    1   DCL SSS$CACHE ENTRY;
       83     6099    1   DCL SSS$CACHEBP ENTRY;
       84     6100    1   DCL SSS$SYSTIME ENTRY(1);
       85     6101
       86     6102
       87     6103        /**/
       88     6104        /* EXTERNAL DATA */
       89     6105        /**/
       90     6106    1   DCL KQ_MMSD$ PTR SYMREF READONLY;
       91     6107        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:4    
       92     6108
       93     6109
       94     6110        /*F* NAME:          KQZ$LOG
       95     6111             PURPOSE:       Log an entry in the circular log buffer.
       96     6112        */
       97     6113
       98     6114
       99     6115        /*D* NAME:          KQZ$LOG
      100     6116             CALL:          CALL KQZ$LOG(KQ$CG,TYP,BYT,HW1,HW2,W1,W2,BFR$) ALTRET(LOC);
      101     6117             INPUT:         KQ$CG - Comgroup context block
      102     6118                            TYP - Type of entry (KQLOG_xx)
      103     6119                            BYT - A UBIN WORD, the low order byte will be logged
      104     6120                            HW1 - Low order half-word from a UBIN WORD
      105     6121                            HW2 - A UBIN HALF HALIGNED to be logged
      106     6122                            W1,W2 - Two ALIGNED words to log
      107     6123                            BFR$ - If present, points to a KQ_LOGENT that is
      108     6124                                   to be filled in instead of logging an entry
      109     6125             DESCRIPTION:   A KQ_LOGENT entry is created with the supplied
      110     6126                            information (all but KQ$CG and TYP are optional)
      111     6127                            plus the current time and PLUGH information.
      112     6128                            If BFR$ is present, the entry is not logged but
      113     6129                            is returned to the user.  If not present and
      114     6130                            logging is currently enabled, the entry is placed
      115     6131                            in the circular buffer.
      116     6132                            If this routine is called from an internal procedure,
      117     6133                            the return address from that routine will be placed
      118     6134                            in the PLUGH information is a RETURN statement
      119     6135                            immediately follows the call.
      120     6136                            This routine always ALTRETs.
      121     6137        */
      122     6138
      123     6139        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:5    
      124     6140
      125     6141
      126     6142    1         CALL KQX$RETADDR(INTRET);
      127     6143    1         CALL SSS$CACHEBP;
      128     6144    1         LOG_FLG='0'B;
      129     6145              %LOCK (G=KQ_LOGGATE);
      130     6148    1         T$=ADDR(KQ$CG);
      131     6149    1         IF KQ_LOG AND (T.DISP=KQ_LOGCG OR KQ_LOGCG=0)
      132     6150    2         AND ADDR(BFR$)=ADDR(NIL) THEN DO;
      133     6151    2           CALL GETENT ALTRET(NO_LOG);
      134     6152    2           LOG_FLG='1'B;
      135     6153    2           END;
      136     6154    1         ELSE
      137     6155    1   NO_LOG:
      138     6156    1           IF ADDR(BFR$)=ADDR(NIL) THEN
      139     6157    1             GOTO RET;
      140     6158    1           ELSE
      141     6159    1             LOG$=BFR$;
      142     6160        /**/
      143     6161    1         KQ$LOGENT='0'B;
      144     6162    1         T$=ADDR(KQ$CG);
      145     6163    1         KQ$LOGENT.CGX=T.DISP;
      146     6164    1         CALL SSS$SYSTIME(KQ$LOGENT.TIME);
      147     6165    1         KQ$LOGENT.TYP=TYP;
      148     6166    1         IF ADDR(BYT)~=ADDR(NIL) THEN
      149     6167    1           KQ$LOGENT.BYT=BYT;
      150     6168    1         IF ADDR(HW1)~=ADDR(NIL) THEN
      151     6169    1           KQ$LOGENT.HW1=HW1;
      152     6170    1         IF ADDR(HW2)~=ADDR(NIL) THEN
      153     6171    1           KQ$LOGENT.HW2=HW2;
      154     6172    1         IF ADDR(W1)~=ADDR(NIL) THEN
      155     6173    1           KQ$LOGENT.W1=W1;
      156     6174    1         IF ADDR(W2)~=ADDR(NIL) THEN
      157     6175    1           KQ$LOGENT.W2=W2;
      158     6176    1         CALL FMR$FNDSTK(BASE$,CUR$);
      159     6177    2           DO I=0 TO 3;
      160     6178    2           KQ$LOGENT.PLUGH.RET(I)=CUR$->STK.RETADDR-1;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:6    
      161     6179    2           CUR$=PINCRW(BASE$,-1-CUR$->STK.DISP);
      162     6180    2           END;
      163     6181    1         KQ$LOGENT.PLUGH.X2=INTRET.X2;
      164     6182    1         KQ$LOGENT.PLUGH.INTRET=INTRET.RET;
      165     6183        /**/
      166     6184    1   RET:
      167     6185              %UNLOCK (G=KQ_LOGGATE);
      168     6188    1         CALL SSS$CACHE;
      169     6189    1         ALTRETURN;
      170     6190        /**/
      171     6191        /**/
      172     6192    1   GETENT: PROC ALTRET;
      173     6193        /**/
      174     6194    3         IF KQ_CURLOG$=ADDR(NIL) THEN DO;
      175     6195    3           ALTRETURN;
      176     6196    3           END;
      177     6197    3         IF KQ$LOGHDR.CURX+SIZEW(KQ$LOGENT)>KQ$LOGHDR.SIZ THEN DO;
      178     6198    3           KQ_CURLOG$=KQ$LOGHDR.LINK$;
      179     6199    3           IF KQ_CURLOG$=ADDR(NIL) THEN
      180     6200    3             KQ_CURLOG$=KQ_HDLOG$;
      181     6201    3           KQ$LOGHDR.CURX=SIZEW(KQ$LOGENT);
      182     6202    3           END;
      183     6203    2         LOG$=PINCRW(KQ_CURLOG$,KQ$LOGHDR.CURX);
      184     6204    2         KQ$LOGHDR.CURX=KQ$LOGHDR.CURX+SIZEW(KQ$LOGENT);
      185     6205    2         KQ_LOGCNT=KQ_LOGCNT+1;
      186     6206    2         RETURN;
      187     6207    2   END GETENT;
      188     6208
      189     6209        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:7    
      190     6210
      191     6211
      192     6212        /*F* NAME:       KQZ$STARTLOG
      193     6213             PURPOSE:    To allocate the memory for the circular buffers
      194     6214        */
      195     6215
      196     6216
      197     6217        /*D* NAME:       KQZ$STARTLOG
      198     6218             CALL:       CALL KQZ$STARTLOG;
      199     6219             DESCRIPTION: Enough memory to hold KQ_LOGENT# entries is obtained.
      200     6220                         If enough memory can not be obtained, KQ_LOG is
      201     6221                         cleared and routine exits.
      202     6222                         The appropriate cells are initialized.
      203     6223        */
      204     6224
      205     6225
      206     6226    1   KQZ$STARTLOG: ENTRY ALTRET;  /* Doesn't ALTRET */
      207     6227
      208     6228
      209     6229    1         CALL SSS$CACHEBP;
      210     6230              %LOCK (G=KQ_LOGGATE);
      211     6233    2         IF KQ_CURLOG$~=ADDR(NIL) OR KQ$MMSD.CCXT$=ADDR(NIL) THEN DO;
      212     6234                %UNLOCK(G=KQ_LOGGATE);
      213     6237    2           CALL SSS$CACHE;
      214     6238    2           RETURN;
      215     6239    2           END;
      216     6240    1         KQ_LOGSTRT='1'B;
      217     6241    1         KQ_LOGCNT=0;
      218     6242              %UNLOCK (G=KQ_LOGGATE);
      219     6245    1         I=KQ_LOGENT#;
      220     6246    2           DO WHILE(I~=0);
      221     6247    2           J=SIZEW(KQ$LOGENT)*(I+1);
      222     6248    2           IF J>200 THEN
      223     6249    2             J=200;
      224     6250    2           CALL KQM$GETB(KQ$MMSD.CCXT$->KQ$CGB,LOG$,J) ALTRET(STRT);
      225     6251    2           K=J*4;
      226     6252    2           LOG$->CHARSK='0'B;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:8    
      227     6253    2           CALL SSS$CACHEBP;  /* Just in case it got changed */
      228     6254    2           LOG$->KQ$LOGHDR.LINK$=KQ_HDLOG$;
      229     6255    2           LOG$->KQ$LOGHDR.CURX=SIZEW(KQ$LOGENT);
      230     6256    2           LOG$->KQ$LOGHDR.SIZ=J;
      231     6257    2           KQ_HDLOG$=LOG$;
      232     6258    2           I=I-(J/SIZEW(KQ$LOGENT))+1;
      233     6259    2           END;
      234     6260    1   STRT:
      235     6261    1         KQ_CURLOG$=KQ_HDLOG$;
      236     6262    1         IF KQ_HDLOG$=ADDR(NIL) THEN
      237     6263    1           KQ_LOG='0'B;
      238     6264    1   STRT5:
      239     6265    1         KQ_LOGSTRT='0'B;
      240     6266    1         CALL SSS$CACHE;
      241     6267    1         RETURN;
      242     6268
      243     6269        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:9    
      244     6270
      245     6271
      246     6272        /*F* NAME:           KQZ$STOPLOG
      247     6273             PURPOSE:        To terminate logging
      248     6274        */
      249     6275
      250     6276
      251     6277        /*D* NAME:           KQZ$STOPLOG
      252     6278             CALL:           CALL KQZ$STOPLOG;
      253     6279             DESCRIPTION:    Memory for logging is released.
      254     6280        */
      255     6281
      256     6282
      257     6283    1   KQZ$STOPLOG: ENTRY ALTRET;  /* Doesn't ALTRET */
      258     6284
      259     6285
      260     6286    1         CALL SSS$CACHEBP;
      261     6287              %LOCK(G=KQ_LOGGATE);
      262     6290    2         IF KQ_LOGSTRT OR KQ_HDLOG$=ADDR(NIL) THEN DO;
      263     6291                %UNLOCK (G=KQ_LOGGATE);
      264     6294    2           CALL SSS$CACHE;
      265     6295    2           RETURN;
      266     6296    2           END;
      267     6297    1         KQ_LOGSTRT='1'B;
      268     6298    1         KQ_CURLOG$=ADDR(NIL);  /* Stop logging */
      269     6299    1         LOG$=KQ_HDLOG$;
      270     6300    1         KQ_HDLOG$=ADDR(NIL);
      271     6301              %UNLOCK (G=KQ_LOGGATE);
      272     6304    2           DO WHILE(LOG$~=ADDR(NIL));
      273     6305    2           T$=LOG$->KQ$LOGHDR.LINK$;
      274     6306    2           J=LOG$->KQ$LOGHDR.SIZ;
      275     6307    2           CALL KQM$RELB(KQ$MMSD.CCXT$->KQ$CGB,LOG$,J);
      276     6308    2           LOG$=T$;
      277     6309    2           END;
      278     6310    1         KQ_LOGSTRT='0'B;
      279     6311    1         CALL SSS$CACHE;
      280     6312    1         RETURN;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:10   
      281     6313
      282     6314    1   END KQZ$LOG;

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:11   
--  Include file information  --

   HF_DATA_R.:E05TOU  is referenced.
   KQM_MAC_C.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KQZ$LOG.

   Procedure KQZ$LOG requires 327 words for executable code.
   Procedure KQZ$LOG requires 24 words of local(AUTO) storage.

    No errors detected in file KQZ$SUBS.:E05TSI    .

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:12   

 Object Unit name= KQZ$LOG                                    File name= KQZ$SUBS.:E05TOU
 UTS= JUL 30 '97 01:39:52.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   327    507  KQZ$LOG
    1  RoData even  none     1      1  KQZ$LOG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        8  KQZ$LOG
     0    255          yes     yes      Std        0  KQZ$STARTLOG
     0    412          yes     yes      Std        0  KQZ$STOPLOG
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KQX$RETADDR
         yes           Std       0 SSS$CACHEBP
         yes           Std       2 FMR$FNDSTK
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       3 KQM$GETB
         yes           Std       1 SSS$SYSTIME
         yes           Std       0 SSS$CACHE
         yes           Std       1 HFC$LOCK
 yes     yes           Std       3 KQM$RELB
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KQ_LOGGATE                            KQ_LOG                                KQ_LOGCG
     KQ_LOGCNT                             KQ_LOGENT#                            KQ_HDLOG$
     KQ_CURLOG$                            KQ_LOGSTRT                       r    KQ_MMSD$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:14   


        1        1        /*M* KQZ$SUBS - General subroutines for comgroups */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=2
                 8        ,IAD=0,PRB */
        9        9        /**/
       10       10        /*P* NAME:             KQZ$SUBS
       11       11             PURPOSE:          General subroutines for comgroups.
       12       12        */
       13       13
       14       14
       15       15        KQZ$LOG: PROC(KQ$CG,TYP,BYT,HW1,HW2,W1,W2,BFR$) ALTRET;

     15  0 000000   000000 700200 xent  KQZ$LOG      TSX0  ! X66_AUTO_N
         0 000001   000030 000010                    ZERO    24,8

       16       16
       17       17
       18       18        /**/
       19       19        /* Includes */
       20       20        /**/
       21       21        %INCLUDE HF_LOCK_C;
       22       35        %INCLUDE KC$CP6V_C;
       23      155        %INCLUDE KC_CP6;
       24      715        %INCLUDE KQ_MAC_C;
       25     3265        %INCLUDE KQ_DATA_R;
       26     4097        %INCLUDE KQM_MAC_C;
       27     4470
       28     4471
       29     4472        /**/
       30     4473        /* Parameters */
       31     4474        /**/
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:15   
       32     4475        %KQ_CG (FPTN=KQ$CG,STCLASS=);
       33     5214    1   DCL TYP UBIN;
       34     5215    1   DCL BYT UBIN;
       35     5216    1   DCL HW1 UBIN;
       36     5217    1   DCL HW2 UBIN HALF HALIGNED;
       37     5218    1   DCL W1 UBIN;
       38     5219    1   DCL W2 UBIN;
       39     5220    1   DCL BFR$ PTR;
       40     5221
       41     5222
       42     5223        /**/
       43     5224        /* Based Structures */
       44     5225        /**/
       45     5226        %KQ_CG (FPTN=KQ$CGB,STCLASS=BASED);
       46     5965        %KQ_LOGENT (FPTN=KQ$LOGENT,STCLASS="BASED(LOG$)");
       47     6007        %KQ_LOGHDR (FPTN=KQ$LOGHDR,STCLASS="BASED(KQ_CURLOG$)");
       48     6028        %KQ_MMSD (FPTN=KQ$MMSD,STCLASS="BASED(KQ_MMSD$)");
       49     6065    1   DCL 1 STK BASED ALIGNED,
       50     6066    1         2 RETADDR UBIN(18) HALIGNED,
       51     6067    1         2 DISP SBIN(18) HALIGNED;
       52     6068    1   DCL 1 CHARSK BASED ALIGNED,
       53     6069    1         2 * CHAR(K);
       54     6070
       55     6071
       56     6072        /**/
       57     6073        /* Auto */
       58     6074        /**/
       59     6075    1   DCL LOG$ PTR;
       60     6076    1   DCL T$ PTR;
       61     6077    1   DCL 1 T REDEF T$,
       62     6078    1         2 DISP UBIN(18) UNAL,
       63     6079    1         2 * BIT(18);
       64     6080    1   DCL BASE$ REDEF T$ PTR;
       65     6081    1   DCL LOG_FLG BIT(1);
       66     6082    1   DCL I UBIN;
       67     6083    1   DCL J UBIN;
       68     6084    1   DCL CUR$ REDEF J PTR;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:16   
       69     6085    1   DCL K UBIN;
       70     6086    1   DCL 1 INTRET,
       71     6087    1         2 RET UBIN(18) UNAL,
       72     6088    1         2 X2 UBIN(18) UNAL;
       73     6089
       74     6090
       75     6091        /**/
       76     6092        /* External Routines */
       77     6093        /**/
       78     6094    1   DCL FMR$FNDSTK ENTRY(2);
       79     6095    1   DCL KQM$GETB ENTRY(3) ALTRET;
       80     6096    1   DCL KQM$RELB ENTRY(3) ALTRET;
       81     6097    1   DCL KQX$RETADDR ENTRY(1);
       82     6098    1   DCL SSS$CACHE ENTRY;
       83     6099    1   DCL SSS$CACHEBP ENTRY;
       84     6100    1   DCL SSS$SYSTIME ENTRY(1);
       85     6101
       86     6102
       87     6103        /**/
       88     6104        /* EXTERNAL DATA */
       89     6105        /**/
       90     6106    1   DCL KQ_MMSD$ PTR SYMREF READONLY;
       91     6107        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:17   
       92     6108
       93     6109
       94     6110        /*F* NAME:          KQZ$LOG
       95     6111             PURPOSE:       Log an entry in the circular log buffer.
       96     6112        */
       97     6113
       98     6114
       99     6115        /*D* NAME:          KQZ$LOG
      100     6116             CALL:          CALL KQZ$LOG(KQ$CG,TYP,BYT,HW1,HW2,W1,W2,BFR$) ALTRET(LOC);
      101     6117             INPUT:         KQ$CG - Comgroup context block
      102     6118                            TYP - Type of entry (KQLOG_xx)
      103     6119                            BYT - A UBIN WORD, the low order byte will be logged
      104     6120                            HW1 - Low order half-word from a UBIN WORD
      105     6121                            HW2 - A UBIN HALF HALIGNED to be logged
      106     6122                            W1,W2 - Two ALIGNED words to log
      107     6123                            BFR$ - If present, points to a KQ_LOGENT that is
      108     6124                                   to be filled in instead of logging an entry
      109     6125             DESCRIPTION:   A KQ_LOGENT entry is created with the supplied
      110     6126                            information (all but KQ$CG and TYP are optional)
      111     6127                            plus the current time and PLUGH information.
      112     6128                            If BFR$ is present, the entry is not logged but
      113     6129                            is returned to the user.  If not present and
      114     6130                            logging is currently enabled, the entry is placed
      115     6131                            in the circular buffer.
      116     6132                            If this routine is called from an internal procedure,
      117     6133                            the return address from that routine will be placed
      118     6134                            in the PLUGH information is a RETURN statement
      119     6135                            immediately follows the call.
      120     6136                            This routine always ALTRETs.
      121     6137        */
      122     6138
      123     6139        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:18   
      124     6140
      125     6141
      126     6142    1         CALL KQX$RETADDR(INTRET);

   6142  0 000002   200021 630500                    EPPR0   INTRET,,AUTO
         0 000003   200024 450500                    STP0    INTRET+3,,AUTO
         0 000004   200024 630500                    EPPR0   INTRET+3,,AUTO
         0 000005   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000006   000000 701000 xent               TSX1    KQX$RETADDR
         0 000007   000000 011000                    NOP     0

      127     6143    1         CALL SSS$CACHEBP;

   6143  0 000010   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000011   000000 701000 xent               TSX1    SSS$CACHEBP
         0 000012   000000 011000                    NOP     0

      128     6144    1         LOG_FLG='0'B;

   6144  0 000013   200015 450100                    STZ     LOG_FLG,,AUTO

      129     6145              %LOCK (G=KQ_LOGGATE);

   6146  0 000014   000000 630400 1                  EPPR0   0
         0 000015   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000016   000000 701000 xent               TSX1    HFC$LOCK
         0 000017   000000 011000                    NOP     0

      130     6148    1         T$=ADDR(KQ$CG);

   6148  0 000020   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000021   200014 756100                    STQ     T$,,AUTO

      131     6149    1         IF KQ_LOG AND (T.DISP=KQ_LOGCG OR KQ_LOGCG=0)

   6149  0 000022   000000 235000 xsym               LDA     KQ_LOG
         0 000023   000042 600000 0                  TZE     NO_LOG
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:19   
         0 000024   200014 236100                    LDQ     T$,,AUTO
         0 000025   000022 772000                    QRL     18
         0 000026   000000 116000 xsym               CMPQ    KQ_LOGCG
         0 000027   000032 600000 0                  TZE     s:6149+8
         0 000030   000000 235000 xsym               LDA     KQ_LOGCG
         0 000031   000042 601000 0                  TNZ     NO_LOG
         0 000032   200012 236100                    LDQ     @BFR$,,AUTO
         0 000033   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000034   000042 601000 0                  TNZ     NO_LOG

      132     6150    2         AND ADDR(BFR$)=ADDR(NIL) THEN DO;

      133     6151    2           CALL GETENT ALTRET(NO_LOG);

   6151  0 000035   000217 701000 0                  TSX1    GETENT
         0 000036   000042 702000 0                  TSX2    NO_LOG

      134     6152    2           LOG_FLG='1'B;

   6152  0 000037   400000 236003                    LDQ     -131072,DU
         0 000040   200015 756100                    STQ     LOG_FLG,,AUTO

      135     6153    2           END;

   6153  0 000041   000050 710000 0                  TRA     s:6161

      136     6154    1         ELSE
      137     6155    1   NO_LOG:
      138     6156    1           IF ADDR(BFR$)=ADDR(NIL) THEN

   6156  0 000042   200012 236100       NO_LOG       LDQ     @BFR$,,AUTO
         0 000043   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000044   000207 600000 0                  TZE     RET

      139     6157    1             GOTO RET;
      140     6158    1           ELSE
      141     6159    1             LOG$=BFR$;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:20   

   6159  0 000045   200012 470500                    LDP0    @BFR$,,AUTO
         0 000046   000000 236100                    LDQ     0,,PR0
         0 000047   200013 756100                    STQ     LOG$,,AUTO

      142     6160        /**/
      143     6161    1         KQ$LOGENT='0'B;

   6161  0 000050   200013 470500                    LDP0    LOG$,,AUTO
         0 000051   000100 100400                    MLR     fill='000'O
         0 000052   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         0 000053   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

      144     6162    1         T$=ADDR(KQ$CG);

   6162  0 000054   200003 236100                    LDQ     @KQ$CG,,AUTO
         0 000055   200014 756100                    STQ     T$,,AUTO

      145     6163    1         KQ$LOGENT.CGX=T.DISP;

   6163  0 000056   200014 220100                    LDX0    T$,,AUTO
         0 000057   200013 470500                    LDP0    LOG$,,AUTO
         0 000060   000000 740100                    STX0    0,,PR0

      146     6164    1         CALL SSS$SYSTIME(KQ$LOGENT.TIME);

   6164  0 000061   200013 236100                    LDQ     LOG$,,AUTO
         0 000062   000001 036003                    ADLQ    1,DU
         0 000063   200024 756100                    STQ     INTRET+3,,AUTO
         0 000064   200024 630500                    EPPR0   INTRET+3,,AUTO
         0 000065   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000066   000000 701000 xent               TSX1    SSS$SYSTIME
         0 000067   000000 011000                    NOP     0

      147     6165    1         KQ$LOGENT.TYP=TYP;

   6165  0 000070   200004 470500                    LDP0    @TYP,,AUTO
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:21   
         0 000071   200013 471500                    LDP1    LOG$,,AUTO
         0 000072   000000 236100                    LDQ     0,,PR0
         0 000073   000033 736000                    QLS     27
         0 000074   100002 552140                    STBQ    2,'40'O,PR1

      148     6166    1         IF ADDR(BYT)~=ADDR(NIL) THEN

   6166  0 000075   200005 236100                    LDQ     @BYT,,AUTO
         0 000076   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000077   000105 600000 0                  TZE     s:6168

      149     6167    1           KQ$LOGENT.BYT=BYT;

   6167  0 000100   200005 471500                    LDP1    @BYT,,AUTO
         0 000101   200013 473500                    LDP3    LOG$,,AUTO
         0 000102   100000 236100                    LDQ     0,,PR1
         0 000103   000022 736000                    QLS     18
         0 000104   300002 552120                    STBQ    2,'20'O,PR3

      150     6168    1         IF ADDR(HW1)~=ADDR(NIL) THEN

   6168  0 000105   200006 236100                    LDQ     @HW1,,AUTO
         0 000106   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000107   000114 600000 0                  TZE     s:6170

      151     6169    1           KQ$LOGENT.HW1=HW1;

   6169  0 000110   200006 471500                    LDP1    @HW1,,AUTO
         0 000111   100000 720100                    LXL0    0,,PR1
         0 000112   200013 473500                    LDP3    LOG$,,AUTO
         0 000113   300000 440100                    SXL0    0,,PR3

      152     6170    1         IF ADDR(HW2)~=ADDR(NIL) THEN

   6170  0 000114   200007 236100                    LDQ     @HW2,,AUTO
         0 000115   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000116   000124 600000 0                  TZE     s:6172
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:22   

      153     6171    1           KQ$LOGENT.HW2=HW2;

   6171  0 000117   200007 471500                    LDP1    @HW2,,AUTO
         0 000120   200013 473500                    LDP3    LOG$,,AUTO
         0 000121   000100 100500                    MLR     fill='000'O
         0 000122   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2
         0 000123   300002 400002                    ADSC9   2,,PR3                   cn=2,n=2

      154     6172    1         IF ADDR(W1)~=ADDR(NIL) THEN

   6172  0 000124   200010 236100                    LDQ     @W1,,AUTO
         0 000125   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000126   000133 600000 0                  TZE     s:6174

      155     6173    1           KQ$LOGENT.W1=W1;

   6173  0 000127   200010 471500                    LDP1    @W1,,AUTO
         0 000130   200013 473500                    LDP3    LOG$,,AUTO
         0 000131   100000 235100                    LDA     0,,PR1
         0 000132   300003 755100                    STA     3,,PR3

      156     6174    1         IF ADDR(W2)~=ADDR(NIL) THEN

   6174  0 000133   200011 236100                    LDQ     @W2,,AUTO
         0 000134   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000135   000142 600000 0                  TZE     s:6176

      157     6175    1           KQ$LOGENT.W2=W2;

   6175  0 000136   200011 471500                    LDP1    @W2,,AUTO
         0 000137   200013 473500                    LDP3    LOG$,,AUTO
         0 000140   100000 235100                    LDA     0,,PR1
         0 000141   300004 755100                    STA     4,,PR3

      158     6176    1         CALL FMR$FNDSTK(BASE$,CUR$);

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:23   
   6176  0 000142   200017 631500                    EPPR1   J,,AUTO
         0 000143   200025 451500                    STP1    INTRET+4,,AUTO
         0 000144   200014 633500                    EPPR3   T$,,AUTO
         0 000145   200024 453500                    STP3    INTRET+3,,AUTO
         0 000146   200024 630500                    EPPR0   INTRET+3,,AUTO
         0 000147   000020 631400 xsym               EPPR1   B_VECTNIL+16
         0 000150   000000 701000 xent               TSX1    FMR$FNDSTK
         0 000151   000000 011000                    NOP     0

      159     6177    2           DO I=0 TO 3;

   6177  0 000152   200016 450100                    STZ     I,,AUTO

      160     6178    2           KQ$LOGENT.PLUGH.RET(I)=CUR$->STK.RETADDR-1;

   6178  0 000153   200017 470500                    LDP0    J,,AUTO
         0 000154   000000 236100                    LDQ     0,,PR0
         0 000155   000022 772000                    QRL     18
         0 000156   000001 136007                    SBLQ    1,DL
         0 000157   200024 756100                    STQ     INTRET+3,,AUTO
         0 000160   200016 235100                    LDA     I,,AUTO
         0 000161   000001 735000                    ALS     1
         0 000162   200013 471500                    LDP1    LOG$,,AUTO
         0 000163   000105 101500                    MRL     fill='000'O
         0 000164   200024 000004                    ADSC9   INTRET+3,,AUTO           cn=0,n=4
         0 000165   100005 000002                    ADSC9   5,A,PR1                  cn=0,n=2

      161     6179    2           CUR$=PINCRW(BASE$,-1-CUR$->STK.DISP);

   6179  0 000166   200017 470500                    LDP0    J,,AUTO
         0 000167   000000 720100                    LXL0    0,,PR0
         0 000170   000000 636010                    EAQ     0,X0
         0 000171   777777 676003                    ERQ     -1,DU
         0 000172   200014 036100                    ADLQ    T$,,AUTO
         0 000173   200017 756100                    STQ     J,,AUTO

      162     6180    2           END;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:24   

   6180  0 000174   200016 235100                    LDA     I,,AUTO
         0 000175   000001 035007                    ADLA    1,DL
         0 000176   200016 755100                    STA     I,,AUTO
         0 000177   000004 115007                    CMPA    4,DL
         0 000200   000153 602000 0                  TNC     s:6178

      163     6181    1         KQ$LOGENT.PLUGH.X2=INTRET.X2;

   6181  0 000201   200021 720100                    LXL0    INTRET,,AUTO
         0 000202   200013 470500                    LDP0    LOG$,,AUTO
         0 000203   000007 440100                    SXL0    7,,PR0

      164     6182    1         KQ$LOGENT.PLUGH.INTRET=INTRET.RET;

   6182  0 000204   200021 220100                    LDX0    INTRET,,AUTO
         0 000205   200013 470500                    LDP0    LOG$,,AUTO
         0 000206   000007 740100                    STX0    7,,PR0

      165     6183        /**/
      166     6184    1   RET:
      167     6185              %UNLOCK (G=KQ_LOGGATE);

   6186  0 000207   000000 630400 1     RET          EPPR0   0
         0 000210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000211   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000212   000000 011000                    NOP     0

      168     6188    1         CALL SSS$CACHE;

   6188  0 000213   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000214   000000 701000 xent               TSX1    SSS$CACHE
         0 000215   000000 011000                    NOP     0

      169     6189    1         ALTRETURN;

   6189  0 000216   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:25   

      170     6190        /**/
      171     6191        /**/
      172     6192    1   GETENT: PROC ALTRET;

   6192  0 000217   200022 741300       GETENT       STX1  ! INTRET+1,,AUTO

      173     6193        /**/
      174     6194    3         IF KQ_CURLOG$=ADDR(NIL) THEN DO;

   6194  0 000220   000000 236000 xsym               LDQ     KQ_CURLOG$
         0 000221   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000222   000224 601000 0                  TNZ     s:6197

      175     6195    3           ALTRETURN;

   6195  0 000223   000000 702211                    TSX2  ! 0,X1

      176     6196    3           END;
      177     6197    3         IF KQ$LOGHDR.CURX+SIZEW(KQ$LOGENT)>KQ$LOGHDR.SIZ THEN DO;

   6197  0 000224   000000 470400 xsym               LDP0    KQ_CURLOG$
         0 000225   000001 236100                    LDQ     1,,PR0
         0 000226   000010 036007                    ADLQ    8,DL
         0 000227   000002 116100                    CMPQ    2,,PR0
         0 000230   000243 602000 0                  TNC     s:6203
         0 000231   000243 600000 0                  TZE     s:6203

      178     6198    3           KQ_CURLOG$=KQ$LOGHDR.LINK$;

   6198  0 000232   000000 236100                    LDQ     0,,PR0
         0 000233   000000 756000 xsym               STQ     KQ_CURLOG$

      179     6199    3           IF KQ_CURLOG$=ADDR(NIL) THEN

   6199  0 000234   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000235   000240 601000 0                  TNZ     s:6201
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:26   

      180     6200    3             KQ_CURLOG$=KQ_HDLOG$;

   6200  0 000236   000000 236000 xsym               LDQ     KQ_HDLOG$
         0 000237   000000 756000 xsym               STQ     KQ_CURLOG$

      181     6201    3           KQ$LOGHDR.CURX=SIZEW(KQ$LOGENT);

   6201  0 000240   000010 235007                    LDA     8,DL
         0 000241   000000 470400 xsym               LDP0    KQ_CURLOG$
         0 000242   000001 755100                    STA     1,,PR0

      182     6202    3           END;

      183     6203    2         LOG$=PINCRW(KQ_CURLOG$,KQ$LOGHDR.CURX);

   6203  0 000243   000001 720100                    LXL0    1,,PR0
         0 000244   000000 636010                    EAQ     0,X0
         0 000245   000000 036000 xsym               ADLQ    KQ_CURLOG$
         0 000246   200013 756100                    STQ     LOG$,,AUTO

      184     6204    2         KQ$LOGHDR.CURX=KQ$LOGHDR.CURX+SIZEW(KQ$LOGENT);

   6204  0 000247   000001 235100                    LDA     1,,PR0
         0 000250   000010 035007                    ADLA    8,DL
         0 000251   000001 755100                    STA     1,,PR0

      185     6205    2         KQ_LOGCNT=KQ_LOGCNT+1;

   6205  0 000252   000000 054000 xsym               AOS     KQ_LOGCNT

      186     6206    2         RETURN;

   6206  0 000253   200022 221300                    LDX1  ! INTRET+1,,AUTO
         0 000254   000001 702211                    TSX2  ! 1,X1

      187     6207    2   END GETENT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:27   
      188     6208
      189     6209        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:28   
      190     6210
      191     6211
      192     6212        /*F* NAME:       KQZ$STARTLOG
      193     6213             PURPOSE:    To allocate the memory for the circular buffers
      194     6214        */
      195     6215
      196     6216
      197     6217        /*D* NAME:       KQZ$STARTLOG
      198     6218             CALL:       CALL KQZ$STARTLOG;
      199     6219             DESCRIPTION: Enough memory to hold KQ_LOGENT# entries is obtained.
      200     6220                         If enough memory can not be obtained, KQ_LOG is
      201     6221                         cleared and routine exits.
      202     6222                         The appropriate cells are initialized.
      203     6223        */
      204     6224
      205     6225
      206     6226    1   KQZ$STARTLOG: ENTRY ALTRET;  /* Doesn't ALTRET */

   6226  0 000255   000000 700200 xent  KQZ$STARTLOG TSX0  ! X66_AUTO_N
         0 000256   000030 000010                    ZERO    24,8

      207     6227
      208     6228
      209     6229    1         CALL SSS$CACHEBP;

   6229  0 000257   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000260   000000 701000 xent               TSX1    SSS$CACHEBP
         0 000261   000000 011000                    NOP     0

      210     6230              %LOCK (G=KQ_LOGGATE);

   6231  0 000262   000000 630400 1                  EPPR0   0
         0 000263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000264   000000 701000 xent               TSX1    HFC$LOCK
         0 000265   000000 011000                    NOP     0

      211     6233    2         IF KQ_CURLOG$~=ADDR(NIL) OR KQ$MMSD.CCXT$=ADDR(NIL) THEN DO;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:29   

   6233  0 000266   000000 236000 xsym               LDQ     KQ_CURLOG$
         0 000267   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000270   000275 601000 0                  TNZ     s:6235
         0 000271   000000 470400 xsym               LDP0    KQ_MMSD$
         0 000272   000002 236100                    LDQ     2,,PR0
         0 000273   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000274   000305 601000 0                  TNZ     s:6240

      212     6234                %UNLOCK(G=KQ_LOGGATE);

   6235  0 000275   000000 630400 1                  EPPR0   0
         0 000276   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000277   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000300   000000 011000                    NOP     0

      213     6237    2           CALL SSS$CACHE;

   6237  0 000301   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000302   000000 701000 xent               TSX1    SSS$CACHE
         0 000303   000000 011000                    NOP     0

      214     6238    2           RETURN;

   6238  0 000304   000000 702200 xent               TSX2  ! X66_ARET

      215     6239    2           END;
      216     6240    1         KQ_LOGSTRT='1'B;

   6240  0 000305   400000 236003                    LDQ     -131072,DU
         0 000306   000000 756000 xsym               STQ     KQ_LOGSTRT

      217     6241    1         KQ_LOGCNT=0;

   6241  0 000307   000000 450000 xsym               STZ     KQ_LOGCNT

      218     6242              %UNLOCK (G=KQ_LOGGATE);
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:30   

   6243  0 000310   000000 630400 1                  EPPR0   0
         0 000311   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000312   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000313   000000 011000                    NOP     0

      219     6245    1         I=KQ_LOGENT#;

   6245  0 000314   000000 235000 xsym               LDA     KQ_LOGENT#
         0 000315   200016 755100                    STA     I,,AUTO

      220     6246    2           DO WHILE(I~=0);

   6246  0 000316   000400 600000 0                  TZE     STRT

      221     6247    2           J=SIZEW(KQ$LOGENT)*(I+1);

   6247  0 000317   200016 235100                    LDA     I,,AUTO
         0 000320   000003 735000                    ALS     3
         0 000321   000010 035007                    ADLA    8,DL
         0 000322   200017 755100                    STA     J,,AUTO

      222     6248    2           IF J>200 THEN

   6248  0 000323   000311 115007                    CMPA    201,DL
         0 000324   000327 602000 0                  TNC     s:6250

      223     6249    2             J=200;

   6249  0 000325   000310 236007                    LDQ     200,DL
         0 000326   200017 756100                    STQ     J,,AUTO

      224     6250    2           CALL KQM$GETB(KQ$MMSD.CCXT$->KQ$CGB,LOG$,J) ALTRET(STRT);

   6250  0 000327   000000 470400 xsym               LDP0    KQ_MMSD$
         0 000330   000002 471500                    LDP1    2,,PR0
         0 000331   200017 633500                    EPPR3   J,,AUTO
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:31   
         0 000332   200026 453500                    STP3    INTRET+5,,AUTO
         0 000333   200013 634500                    EPPR4   LOG$,,AUTO
         0 000334   200025 454500                    STP4    INTRET+4,,AUTO
         0 000335   200024 451500                    STP1    INTRET+3,,AUTO
         0 000336   200024 630500                    EPPR0   INTRET+3,,AUTO
         0 000337   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000340   000000 701000 xent               TSX1    KQM$GETB
         0 000341   000400 702000 0                  TSX2    STRT

      225     6251    2           K=J*4;

   6251  0 000342   200017 235100                    LDA     J,,AUTO
         0 000343   000002 735000                    ALS     2
         0 000344   200020 755100                    STA     K,,AUTO

      226     6252    2           LOG$->CHARSK='0'B;

   6252  0 000345   200013 470500                    LDP0    LOG$,,AUTO
         0 000346   000000 620005                    EAX0    0,AL
         0 000347   000140 100400                    MLR     fill='000'O
         0 000350   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         0 000351   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      227     6253    2           CALL SSS$CACHEBP;  /* Just in case it got changed */

   6253  0 000352   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000353   000000 701000 xent               TSX1    SSS$CACHEBP
         0 000354   000000 011000                    NOP     0

      228     6254    2           LOG$->KQ$LOGHDR.LINK$=KQ_HDLOG$;

   6254  0 000355   000000 236000 xsym               LDQ     KQ_HDLOG$
         0 000356   200013 470500                    LDP0    LOG$,,AUTO
         0 000357   000000 756100                    STQ     0,,PR0

      229     6255    2           LOG$->KQ$LOGHDR.CURX=SIZEW(KQ$LOGENT);

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:32   
   6255  0 000360   000010 235007                    LDA     8,DL
         0 000361   200013 470500                    LDP0    LOG$,,AUTO
         0 000362   000001 755100                    STA     1,,PR0

      230     6256    2           LOG$->KQ$LOGHDR.SIZ=J;

   6256  0 000363   200013 470500                    LDP0    LOG$,,AUTO
         0 000364   200017 236100                    LDQ     J,,AUTO
         0 000365   000002 756100                    STQ     2,,PR0

      231     6257    2           KQ_HDLOG$=LOG$;

   6257  0 000366   200013 236100                    LDQ     LOG$,,AUTO
         0 000367   000000 756000 xsym               STQ     KQ_HDLOG$

      232     6258    2           I=I-(J/SIZEW(KQ$LOGENT))+1;

   6258  0 000370   200017 236100                    LDQ     J,,AUTO
         0 000371   000003 772000                    QRL     3
         0 000372   200024 756100                    STQ     INTRET+3,,AUTO
         0 000373   200016 236100                    LDQ     I,,AUTO
         0 000374   200024 136100                    SBLQ    INTRET+3,,AUTO
         0 000375   000001 036007                    ADLQ    1,DL
         0 000376   200016 756100                    STQ     I,,AUTO

      233     6259    2           END;

   6259  0 000377   000317 601000 0                  TNZ     s:6247

      234     6260    1   STRT:
      235     6261    1         KQ_CURLOG$=KQ_HDLOG$;

   6261  0 000400   000000 236000 xsym  STRT         LDQ     KQ_HDLOG$
         0 000401   000000 756000 xsym               STQ     KQ_CURLOG$

      236     6262    1         IF KQ_HDLOG$=ADDR(NIL) THEN

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:33   
   6262  0 000402   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000403   000405 601000 0                  TNZ     STRT5

      237     6263    1           KQ_LOG='0'B;

   6263  0 000404   000000 450000 xsym               STZ     KQ_LOG

      238     6264    1   STRT5:
      239     6265    1         KQ_LOGSTRT='0'B;

   6265  0 000405   000000 450000 xsym  STRT5        STZ     KQ_LOGSTRT

      240     6266    1         CALL SSS$CACHE;

   6266  0 000406   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000407   000000 701000 xent               TSX1    SSS$CACHE
         0 000410   000000 011000                    NOP     0

      241     6267    1         RETURN;

   6267  0 000411   000000 702200 xent               TSX2  ! X66_ARET

      242     6268
      243     6269        %EJECT;
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:34   
      244     6270
      245     6271
      246     6272        /*F* NAME:           KQZ$STOPLOG
      247     6273             PURPOSE:        To terminate logging
      248     6274        */
      249     6275
      250     6276
      251     6277        /*D* NAME:           KQZ$STOPLOG
      252     6278             CALL:           CALL KQZ$STOPLOG;
      253     6279             DESCRIPTION:    Memory for logging is released.
      254     6280        */
      255     6281
      256     6282
      257     6283    1   KQZ$STOPLOG: ENTRY ALTRET;  /* Doesn't ALTRET */

   6283  0 000412   000000 700200 xent  KQZ$STOPLOG  TSX0  ! X66_AUTO_N
         0 000413   000030 000010                    ZERO    24,8

      258     6284
      259     6285
      260     6286    1         CALL SSS$CACHEBP;

   6286  0 000414   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000415   000000 701000 xent               TSX1    SSS$CACHEBP
         0 000416   000000 011000                    NOP     0

      261     6287              %LOCK(G=KQ_LOGGATE);

   6288  0 000417   000000 630400 1                  EPPR0   0
         0 000420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000421   000000 701000 xent               TSX1    HFC$LOCK
         0 000422   000000 011000                    NOP     0

      262     6290    2         IF KQ_LOGSTRT OR KQ_HDLOG$=ADDR(NIL) THEN DO;

   6290  0 000423   000000 234000 xsym               SZN     KQ_LOGSTRT
         0 000424   000430 604000 0                  TMI     s:6292
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:35   
         0 000425   000000 236000 xsym               LDQ     KQ_HDLOG$
         0 000426   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000427   000440 601000 0                  TNZ     s:6297

      263     6291                %UNLOCK (G=KQ_LOGGATE);

   6292  0 000430   000000 630400 1                  EPPR0   0
         0 000431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000432   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000433   000000 011000                    NOP     0

      264     6294    2           CALL SSS$CACHE;

   6294  0 000434   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000435   000000 701000 xent               TSX1    SSS$CACHE
         0 000436   000000 011000                    NOP     0

      265     6295    2           RETURN;

   6295  0 000437   000000 702200 xent               TSX2  ! X66_ARET

      266     6296    2           END;
      267     6297    1         KQ_LOGSTRT='1'B;

   6297  0 000440   400000 236003                    LDQ     -131072,DU
         0 000441   000000 756000 xsym               STQ     KQ_LOGSTRT

      268     6298    1         KQ_CURLOG$=ADDR(NIL);  /* Stop logging */

   6298  0 000442   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000443   000000 756000 xsym               STQ     KQ_CURLOG$

      269     6299    1         LOG$=KQ_HDLOG$;

   6299  0 000444   000000 236000 xsym               LDQ     KQ_HDLOG$
         0 000445   200013 756100                    STQ     LOG$,,AUTO

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:36   
      270     6300    1         KQ_HDLOG$=ADDR(NIL);

   6300  0 000446   000001 236000 xsym               LDQ     B_VECTNIL+1
         0 000447   000000 756000 xsym               STQ     KQ_HDLOG$

      271     6301              %UNLOCK (G=KQ_LOGGATE);

   6302  0 000450   000000 630400 1                  EPPR0   0
         0 000451   000017 631400 xsym               EPPR1   B_VECTNIL+15
         0 000452   000000 701000 xent               TSX1    HFC$UNLOCK
         0 000453   000000 011000                    NOP     0

      272     6304    2           DO WHILE(LOG$~=ADDR(NIL));

   6304  0 000454   000477 710000 0                  TRA     s:6309

      273     6305    2           T$=LOG$->KQ$LOGHDR.LINK$;

   6305  0 000455   200013 470500                    LDP0    LOG$,,AUTO
         0 000456   000000 236100                    LDQ     0,,PR0
         0 000457   200014 756100                    STQ     T$,,AUTO

      274     6306    2           J=LOG$->KQ$LOGHDR.SIZ;

   6306  0 000460   000002 235100                    LDA     2,,PR0
         0 000461   200017 755100                    STA     J,,AUTO

      275     6307    2           CALL KQM$RELB(KQ$MMSD.CCXT$->KQ$CGB,LOG$,J);

   6307  0 000462   000000 471400 xsym               LDP1    KQ_MMSD$
         0 000463   100002 473500                    LDP3    2,,PR1
         0 000464   200017 634500                    EPPR4   J,,AUTO
         0 000465   200026 454500                    STP4    INTRET+5,,AUTO
         0 000466   200013 635500                    EPPR5   LOG$,,AUTO
         0 000467   200025 455500                    STP5    INTRET+4,,AUTO
         0 000470   200024 453500                    STP3    INTRET+3,,AUTO
         0 000471   200024 630500                    EPPR0   INTRET+3,,AUTO
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:37   
         0 000472   000021 631400 xsym               EPPR1   B_VECTNIL+17
         0 000473   000000 701000 xent               TSX1    KQM$RELB
         0 000474   000000 011000                    NOP     0

      276     6308    2           LOG$=T$;

   6308  0 000475   200014 236100                    LDQ     T$,,AUTO
         0 000476   200013 756100                    STQ     LOG$,,AUTO

      277     6309    2           END;

   6309  0 000477   200013 236100                    LDQ     LOG$,,AUTO
         0 000500   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000501   000455 601000 0                  TNZ     s:6305

      278     6310    1         KQ_LOGSTRT='0'B;

   6310  0 000502   000000 450000 xsym               STZ     KQ_LOGSTRT

      279     6311    1         CALL SSS$CACHE;

   6311  0 000503   000002 631400 xsym               EPPR1   B_VECTNIL+2
         0 000504   000000 701000 xent               TSX1    SSS$CACHE
         0 000505   000000 011000                    NOP     0

      280     6312    1         RETURN;

   6312  0 000506   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000000 006000                                                    ....
      281     6313
      282     6314    1   END KQZ$LOG;

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:38   
--  Include file information  --

   HF_DATA_R.:E05TOU  is referenced.
   KQM_MAC_C.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KC_CP6.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KQZ$LOG.
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:39   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w PTR         r     1 @BFR$                      5-0-0/w PTR         r     1 @BYT
     6-0-0/w PTR         r     1 @HW1                       7-0-0/w PTR         r     1 @HW2
     3-0-0/w PTR         r     1 @KQ$CG                     4-0-0/w PTR         r     1 @TYP
    10-0-0/w PTR         r     1 @W1                       11-0-0/w PTR         r     1 @W2
    14-0-0/w PTR         r     1 BASE$                     *0-0-0/w PTR         r     1 BFR$
    *0-0-0/w UBIN        r     1 BYT                       17-0-0/w PTR         r     1 CUR$
    *0-0-0/w UBIN        r     1 HW1                       *0-0-0/h UBIN(18)    r     1 HW2
    16-0-0/w UBIN        r     1 I                         21-0-0/b STRC        r     1 INTRET
    17-0-0/w UBIN        r     1 J                         20-0-0/w UBIN        r     1 K
    *0-0-0/d STRC(6516)  r     1 KQ$CG                     13-0-0/w PTR         r     1 LOG$
    15-0-0/b BIT         r     1 LOG_FLG                   14-0-0/w STRC        r     1 T
    14-0-0/w PTR         r     1 T$                        *0-0-0/w UBIN        r     1 TYP
    *0-0-0/w UBIN        r     1 W1                        *0-0-0/w UBIN        r     1 W2

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KQ_CURLOG$                 0-0-0/w PTR         r     1 KQ_HDLOG$
     0-0-0/b STRC        r     1 KQ_LOG                     0-0-0/w UBIN        r     1 KQ_LOGCG
     0-0-0/w SBIN        r     1 KQ_LOGCNT                  0-0-0/w UBIN        r     1 KQ_LOGENT#
     0-0-0/b BIT (72)    r     1 KQ_LOGGATE                 0-0-0/b BIT         r     1 KQ_LOGSTRT
     0-0-0/w PTR         r     1 KQ_MMSD$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:40   
     0-0-0/w ASTR(0)     r     1 CHARSK                     0-0-0/d STRC(6516)  r     1 KQ$CGB
     0-0-0/w STRC(288)   r     1 KQ$LOGENT                  0-0-0/w STRC(108)   r     1 KQ$LOGHDR
     0-0-0/d STRC(288)   r     1 KQ$MMSD                    0-0-0/w STRC        r     1 STK


   Procedure KQZ$LOG requires 327 words for executable code.
   Procedure KQZ$LOG requires 24 words of local(AUTO) storage.

    No errors detected in file KQZ$SUBS.:E05TSI    .
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:41   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:42   
          MINI XREF LISTING

BASE$
      6080**DCL      6176<>CALL     6179>>ASSIGN
BFR$
      5220**DCL        15--PROC     6149--IF       6156--IF       6159>>ASSIGN
BYT
      5215**DCL        15--PROC     6166--IF       6167>>ASSIGN
CHARSK
      6068**DCL      6252<<ASSIGN
CUR$
      6084**DCL      6176<>CALL     6178>>ASSIGN   6179<<ASSIGN   6179>>ASSIGN
FMR$FNDSTK
      6094**DCL-ENT  6176--CALL
GETENT
      6192**PROC     6151--CALL
HFC$LOCK
        34**DCL-ENT  6146--CALL     6231--CALL     6288--CALL
HFC$UNLOCK
        34**DCL-ENT  6186--CALL     6235--CALL     6243--CALL     6292--CALL     6302--CALL
HW1
      5216**DCL        15--PROC     6168--IF       6169>>ASSIGN
HW2
      5217**DCL        15--PROC     6170--IF       6171>>ASSIGN
I
      6082**DCL      6177<<DOINDEX  6178>>ASSIGN   6245<<ASSIGN   6246>>DOWHILE  6247>>ASSIGN   6258<<ASSIGN
      6258>>ASSIGN
INTRET
      6086**DCL      6142<>CALL
INTRET.RET
      6087**DCL      6182>>ASSIGN
INTRET.X2
      6088**DCL      6181>>ASSIGN
J
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:43   
      6083**DCL      6084--REDEF    6247<<ASSIGN   6248>>IF       6249<<ASSIGN   6250<>CALL     6251>>ASSIGN
      6256>>ASSIGN   6258>>ASSIGN   6306<<ASSIGN   6307<>CALL
K
      6085**DCL      6069--IMP-SIZ  6251<<ASSIGN   6252>>ASSIGN
KQ$CG
      4490**DCL        15--PROC     6148--ASSIGN   6162--ASSIGN
KQ$CG.AUCTL.DVBYTE.REREAD
      4933**DCL      4934--REDEF
KQ$CGB
      5241**DCL      6250<>CALL     6307<>CALL
KQ$CGB.AUCTL.DVBYTE.REREAD
      5684**DCL      5685--REDEF
KQ$LOGENT
      5979**DCL      6161<<ASSIGN   6197--IF       6201--ASSIGN   6204--ASSIGN   6247--ASSIGN   6255--ASSIGN
      6258--ASSIGN
KQ$LOGENT.BYT
      5992**DCL      6167<<ASSIGN
KQ$LOGENT.CGX
      5984**DCL      6163<<ASSIGN
KQ$LOGENT.HW1
      5986**DCL      6169<<ASSIGN
KQ$LOGENT.HW2
      5994**DCL      6171<<ASSIGN
KQ$LOGENT.PLUGH.INTRET
      6003**DCL      6182<<ASSIGN
KQ$LOGENT.PLUGH.RET
      6001**DCL      6178<<ASSIGN
KQ$LOGENT.PLUGH.X2
      6005**DCL      6181<<ASSIGN
KQ$LOGENT.TIME
      5988**DCL      6164<>CALL
KQ$LOGENT.TYP
      5990**DCL      6165<<ASSIGN
KQ$LOGENT.W1
      5996**DCL      6173<<ASSIGN
KQ$LOGENT.W2
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:44   
      5998**DCL      6175<<ASSIGN
KQ$LOGHDR.CURX
      6023**DCL      6197>>IF       6201<<ASSIGN   6203>>ASSIGN   6204<<ASSIGN   6204>>ASSIGN   6255<<ASSIGN
KQ$LOGHDR.LINK$
      6021**DCL      6198>>ASSIGN   6254<<ASSIGN   6305>>ASSIGN
KQ$LOGHDR.SIZ
      6025**DCL      6197>>IF       6256<<ASSIGN   6306>>ASSIGN
KQ$MMSD.CCXT$
      6049**DCL      6233>>IF       6250>>CALL     6307>>CALL
KQM$GETB
      6095**DCL-ENT  6250--CALL
KQM$RELB
      6096**DCL-ENT  6307--CALL
KQX$RETADDR
      6097**DCL-ENT  6142--CALL
KQ_CURLOG$
      3305**DCL      6020--IMP-PTR  6194>>IF       6197>>IF       6197>>IF       6198<<ASSIGN   6198>>ASSIGN
      6199>>IF       6200<<ASSIGN   6201>>ASSIGN   6203>>ASSIGN   6203>>ASSIGN   6204>>ASSIGN   6204>>ASSIGN
      6233>>IF       6261<<ASSIGN   6298<<ASSIGN
KQ_HDLOG$
      3304**DCL      6200>>ASSIGN   6254>>ASSIGN   6257<<ASSIGN   6261>>ASSIGN   6262>>IF       6290>>IF
      6299>>ASSIGN   6300<<ASSIGN
KQ_IMBLK.DVE.EOMCHAR
      3939**DCL      3941--REDEF
KQ_IMBLK.KEY1
      3865**DCL      3867--REDEF
KQ_IMBLK.KEY2
      3874**DCL      3892--REDEF
KQ_IMBLK.LNK$
      3839**DCL      3841--REDEF    3847--REDEF    3851--REDEF
KQ_IMBLK.TYC
      3988**DCL      3990--REDEF
KQ_IMBLK.XSP.MREQ$
      3894**DCL      3898--REDEF
KQ_IRBLK.BUF$
      3443**DCL      3445--REDEF
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:45   
KQ_IRBLK.CNACTD
      3357**DCL      3366--REDEF
KQ_IRBLK.DBLKX
      3463**DCL      3467--REDEF
KQ_IRBLK.EOFNONE
      3335**DCL      3338--REDEF
KQ_IRBLK.FROMQ
      3341**DCL      3344--REDEF
KQ_IRBLK.KEY1R
      3382**DCL      3383--REDEF
KQ_IRBLK.KEY2R
      3387**DCL      3388--REDEF
KQ_IRBLK.LATCH
      3330**DCL      3332--REDEF
KQ_IRBLK.LWRITES$
      3474**DCL      3478--REDEF
KQ_IRBLKT.CNACTD
      3543**DCL      3552--REDEF
KQ_IRBLKT.DBLK$
      3606**DCL      3610--REDEF    3613--REDEF
KQ_IRBLKT.EOFNONE
      3521**DCL      3524--REDEF
KQ_IRBLKT.FROMQ
      3527**DCL      3530--REDEF
KQ_IRBLKT.KEY1R
      3568**DCL      3569--REDEF
KQ_IRBLKT.KEY2R
      3573**DCL      3574--REDEF
KQ_IRBLKT.LATCH
      3516**DCL      3518--REDEF
KQ_LOG
      3290**DCL      6149>>IF       6263<<ASSIGN
KQ_LOGCG
      3301**DCL      6149>>IF       6149>>IF
KQ_LOGCNT
      3302**DCL      6205<<ASSIGN   6205>>ASSIGN   6241<<ASSIGN
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:46   
KQ_LOGENT#
      3303**DCL      6245>>ASSIGN
KQ_LOGGATE
      3289**DCL      6146<>CALL     6186<>CALL     6231<>CALL     6235<>CALL     6243<>CALL     6288<>CALL
      6292<>CALL     6302<>CALL
KQ_LOGSTRT
      3306**DCL      6240<<ASSIGN   6265<<ASSIGN   6290>>IF       6297<<ASSIGN   6310<<ASSIGN
KQ_MMSD$
      6106**DCL      6041--IMP-PTR  6233>>IF       6250>>CALL     6307>>CALL
LOG$
      6075**DCL      5979--IMP-PTR  6159<<ASSIGN   6161>>ASSIGN   6163>>ASSIGN   6164>>CALL     6165>>ASSIGN
      6167>>ASSIGN   6169>>ASSIGN   6171>>ASSIGN   6173>>ASSIGN   6175>>ASSIGN   6178>>ASSIGN   6181>>ASSIGN
      6182>>ASSIGN   6203<<ASSIGN   6250<>CALL     6252>>ASSIGN   6254>>ASSIGN   6255>>ASSIGN   6256>>ASSIGN
      6257>>ASSIGN   6299<<ASSIGN   6304>>DOWHILE  6305>>ASSIGN   6306>>ASSIGN   6307<>CALL     6308<<ASSIGN
LOG_FLG
      6081**DCL      6144<<ASSIGN   6152<<ASSIGN
NO_LOG
      6156**LABEL    6151--CALLALT
RET
      6186**LABEL    6157--GOTO
SSS$CACHE
      6098**DCL-ENT  6188--CALL     6237--CALL     6266--CALL     6294--CALL     6311--CALL
SSS$CACHEBP
      6099**DCL-ENT  6143--CALL     6229--CALL     6253--CALL     6286--CALL
SSS$SYSTIME
      6100**DCL-ENT  6164--CALL
STK.DISP
      6067**DCL      6179>>ASSIGN
STK.RETADDR
      6066**DCL      6178>>ASSIGN
STRT
      6261**LABEL    6250--CALLALT
T.DISP
      6078**DCL      6149>>IF       6163>>ASSIGN
T$
      6076**DCL      6077--REDEF    6080--REDEF    6148<<ASSIGN   6162<<ASSIGN   6305<<ASSIGN   6308>>ASSIGN
PL6.E3A0      #001=KQZ$LOG File=KQZ$SUBS.:E05TSI                                 WED 07/30/97 01:39 Page:47   
TYP
      5214**DCL        15--PROC     6165>>ASSIGN
W1
      5218**DCL        15--PROC     6172--IF       6173>>ASSIGN
W2
      5219**DCL        15--PROC     6174--IF       6175>>ASSIGN
