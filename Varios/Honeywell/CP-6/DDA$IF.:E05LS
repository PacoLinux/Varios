VERSION E05

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:1    
        1        1        /*M* DDA$IF DO IF ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*D*  NAME:    DDA$IF
       10       10              CALL:    CALL DDA$IF(NOGO_BIT)
       11       11             INTERFACE: GETVAL - INTERNAL ROUTINE
       12       12                          DDK$GETADDR
       13       13                          DDK$GETMVAL
       14       14                          DDK$GETSPEC
       15       15                          DDK$GETVAL
       16       16                          DDK$SEXTEND
       17       17              INPUT:   S_D.DO$ - POINTS TO COMMAND FRAME
       18       18                       S_D.D$  - POINTS PAST END OF COMMAND FRAME, AT THE
       19       19                                 IF$CONST FRAME IF PRESENT.
       20       20              OUTPUT:  S_D.D$ - POINTS BEYOND THE IF DATA DESCRIPTOR IF
       21       21                                ONE IS PRESENT, OTHEWISE IT IS UNTOUCHED.
       22       22                       NOGO_BIT - RESULT OF IF COMPARISON.
       23       23              DESCRIPTION: IF THE COND FIELD OF THE COMMAND FRAME IS NON-ZERO,
       24       24                  THE CONSTANT AND THE VALUE OF THE VARIABLE ARE COMPARED
       25       25                  AS SPECIFIED IN THE CTYPE FIELD OF THE COMMAND FRAME.
       26       26                  THE NOGO_BIT IS RESET ('0'B) IF:
       27       27                       1) THE IF CLAUSE WAS NOT PRESENT IN THIS COMMAND FRAME.
       28       28                       2) THE IF CLAUSE WAS PRESENT, AND THE LOGICAL EXPRESSION
       29       29                          WAS TRUE.
       30       30                       THIS SIGNALS DDA$DO TO PROCEED WITH THIS ATTACHMENT.
       31       31                  THE NOGO_BIT IS SET ('1'B) IF THE IF CLAUSE WAS PRESENT
       32       32                  AND THE LOGICAL EXPRESSION WAS FALSE.  THIS SIGNALS
       33       33                  DDA$DO TO SKIP THIS ATTACHMENT.
       34       34                  ALTRETURN IS TAKEN AND THE ERROR CODE SET IF:
       35       35                       1) THE CONSTANT AND VARIABLE TYPES/LENGTHS ARE NOT
       36       36                          COMPATABLE.
       37       37                       2) THE VARIABLE IS NOT AN EVALUATABLE EXPRESSION.
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:2    
       38       38                       3) THE VARIABLE EXPRESSION IS NOT VALID IN THIS
       39       39                          CONTEXT. */
       40       40                                                /**/
       41       41        DDA$IF: PROC(NOGO_BIT) ALTRET;
       42       42                                                /* Auto */
       43       43    1   DCL NOGO_BIT BIT(1) ALIGNED;
       44       44    1   DCL DESC$ PTR;
       45       45    1   DCL IF$ PTR;
       46       46    1   DCL WHEN$ PTR;
       47       47    1   DCL WHEN BIT(1) ALIGNED;
       48       48    1   DCL TEMP UBIN;
       49       49    1   DCL V_FMT UBIN;
       50       50    1   DCL C_CLASS UBIN;
       51       51        %SUB CHAR_CLASS = 1;
       52       52        %SUB BIT_CLASS = 2;
       53       53        %SUB VALUE_CLASS = 3;
       54       54        %SUB FVALUE_CLASS = 4;
       55       55        %SUB DVALUE_CLASS = 5;
       56       56    1   DCL COMP_FLAG UBIN;
       57       57    1   DCL 1 FLAG REDEF COMP_FLAG,
       58       58    1         2 * BIT(34),
       59       59    1         2 EL UNAL,
       60       60    1           3 L BIT(1) UNAL,
       61       61    1           3 E BIT(1) UNAL;
       62       62                                                /* Value buffer */
       63       63    1   DCL V_CHAR CHAR(63) DALIGNED;
       64       64    1   DCL VC(0:63) REDEF V_CHAR CHAR(1);
       65       65    1   DCL 1 VCU(0:63) REDEF V_CHAR,
       66       66    1         2 * BIT(1) UNAL,
       67       67    1         2 C UBIN(8) UNAL;
       68       68    1   DCL 1 V REDEF V_CHAR,
       69       69    1         2 VALUE,
       70       70    1           3 L SBIN,
       71       71    1           3 R SBIN,
       72       72    1         2 BITS REDEF VALUE BIT(72),
       73       73    1         2 * CHAR(55);
       74       74    1   DCL 1 VALUE_L6,
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:3    
       75       75    1         2 SIZE UBIN,
       76       76    1         2 OPS(0:15) UBIN,
       77       77    1         2 OPSB(0:15) REDEF OPS,
       78       78    1           3 * BIT(20) UNAL,
       79       79    1           3 UH UBIN(8) UNAL,
       80       80    1           3 LH UBIN(8) UNAL;
       81       81    1   DCL ADDRESS UBIN;
       82       82    1   DCL SEG UBIN;
       83       83    1   DCL DESC# UBIN;
       84       84    1   DCL NOT_IS BIT(1);
       85       85    1   DCL EXPR_OP_L6 BIT(1) ALIGNED;
       86       86                                                /**/
       87       87    1   DCL SVALUE SBIN;
       88       88    1   DCL SIZE SBIN;
       89       89    1   DCL RSIZE UBIN;
       90       90    1   DCL INDXX SBIN;
       91       91    1   DCL POINTER UBIN;
       92       92    1   DCL EXPR_VAL SBIN;
       93       93    1   DCL EXPR_OP UBIN;
       94       94    1   DCL ADDR_TYPE UBIN;
       95       95    1   DCL ARRAY_FLAG BIT(1);
       96       96        %INCLUDE DD$BASED;
       97     1399        %INCLUDE DD_PSUBS_C;
       98     1874        %INCLUDE XUH_MACRO_C;
       99     1958        %INCLUDE DD_SD_M;
      100     3294        %S_D;
      101     4612        %INCLUDE DD_SUBS_C;
      102     4883        %INCLUDE DD_ERR_C;
      103     5280        %INCLUDE DD$DITEM;
       12+    5383             %LIST;
       13+    5384    1        DCL SDD$ PTR;
       14+    5385    1        DCL ZITEM$ PTR;
       15+    5386    1        DCL SDD_L6$ PTR;
       16+    5387    1        DCL ZITEM_L6$ PTR;
      104     5961        %DITEM (NAME=ITEM, STCLASS=AUTO);
      105     6041        %ZITEM;
      106     6113        %INCLUDE DD_EIS_C;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:4    
      107     6139    1   DCL MVN(0:2) UBIN CONSTANT INIT(4, 5, 6); /* MVNU_EIS, MVNL_EIS, MVNT_EIS */
      108     6140    1   DCL UMVN(0:2) UBIN CONSTANT INIT(15, 16, 17); /* UMVNU_EIS, UMVNL_EIS, UMVNT_EIS */
      109     6141    1   DCL EIS UBIN;
      110     6142    1   DCL DFLOAT BIT(72) DALIGNED;
      111     6143    1   DCL I UBIN;
      112     6144    1   DCL TSCALE SBIN;
      113     6145    1   DCL VTRUNC BIT(1);
      114     6146    1   DCL CTRUNC BIT(1);
      115     6147    1   DCL VSIZE UBIN;
      116     6148    1   DCL CSIZE UBIN;
      117     6149        %ALL_ATTACH;
      118     6164        %U$SE;
      119     6172        %IF$CONST;
      120     6210        %HOST_REG$VALUES(NAME=REG$VALUES);
      121     6223        %WHEN_FIRST(NAME=WHEN$CMD, STCLASS="BASED(WHEN$)");
      122     6260        /* EXTERNALS */
      123     6261    1   DCL D_XDELTA BIT(1) SYMREF;
      124     6262    1   DCL USE$ PTR SYMREF;
      125     6263    1   DCL DDK$GETADDR ENTRY(9) ALTRET;
      126     6264    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      127     6265    1   DCL DDK$GETSPEC ENTRY(2) ALTRET;
      128     6266    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
      129     6267    1   DCL DDK$SEXTEND ENTRY(2);
      130     6268    1   DCL DDK$CFLT ENTRY(3);
      131     6269    1   DCL DDK$CDFLT ENTRY(3);
      132     6270    1   DCL DDK$CMPDEC ENTRY(5);
      133     6271    1   DCL DDE$ERROR ENTRY;
      134     6272    1   DCL DFK$EVAL_DISP ENTRY(8) ALTRET;
      135     6273                                                /**/
      136     6274                                                /**/
      137     6275    1        IF S_D.DO$->ALL_ATTACH.COND = 0    /* If no IF clause */
      138     6276    1        THEN GOTO TRUE;                    /* then say doit */
      139     6277    1        IF$ = S_D.D$;                      /* Save ptr to IF$CONST */
      140     6278    1        S_D.D$ = PINCRW(S_D.D$,SIZEW(IF$CONST)); /* Point to data descriptor */
      141     6279    1        DESC$ = S_D.D$;                    /* Save it */
      142     6280    1        ZITEM$ = S_D.D$;                   /* Save it */
      143     6281    1        WHEN = '0'B;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:5    
      144     6282    1        GOTO IFCONTINUE;
      145     6283
      146     6284    1   DDA$IF_WHEN: ENTRY(NOGO_BIT) ALTRET;
      147     6285
      148     6286    1        WHEN$ = S_D.DO$;
      149     6287    1        IF$ = PINCRW(S_D.DO$, WHEN$CMD.U.CONST_OFFSET);
      150     6288    1        ZITEM$ = PINCRW(S_D.DO$, SIZEW(WHEN$CMD));
      151     6289    1        DESC$ = ZITEM$;
      152     6290    1        WHEN = '1'B;
      153     6291
      154     6292    1   IFCONTINUE: ;
      155     6293    1        V_FMT = ZITEM.FMT_SPEC;
      156     6294                                                /* Get and convert constant type */
      157     6295    1        IF WHEN
      158     6296    1        THEN TEMP = WHEN$CMD.WCTYPE;
      159     6297    1        ELSE TEMP = S_D.DO$->ALL_ATTACH.CTYPE;
      160     6298    2        DO CASE(TEMP);
      161     6299    2          CASE(%CHAR_FMT);
      162     6300    2             C_CLASS = 1;         /* CHAR_CLASS */
      163     6301    2          CASE(%BIT_FMT,%OBIT_FMT,%PTR_FMT,%X_FMT);
      164     6302    2             C_CLASS = 2;          /* BIT_CLASS */
      165     6303    2          CASE(%SINT_FMT, %UINT_FMT, %OCT_FMT);
      166     6304    2             C_CLASS = 3;        /*VALUE_CLASS*/
      167     6305    2          CASE(%FLOAT_FMT);
      168     6306    2             C_CLASS = 4;       /* FVALUE_CLASS */
      169     6307    2          CASE(%PUP_FMT);
      170     6308    2             C_CLASS = 5;       /* DVALUE_CLASS */
      171     6309    2          CASE(ELSE);
      172     6310    2             S_D.ERROR = 502;         /* E@DELBUG - Bad constant type*/
      173     6311    2             CALL DDE$ERROR;
      174     6312    2             GOTO ERR_RTN;
      175     6313    2          END;                             /* Case C_FMT */
      176     6314                                                /**/
      177     6315    1        CALL GETVAL ALTRET(ERR_RTN);       /* Get variable value, properly aligned,
      178     6316                                                    and ready to compare */
      179     6317                                                /**/
      180     6318        /*  Two comparisions between the actual values are
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:6    
      181     6319            performed, the logical value of all relations are
      182     6320            determined by the results. */
      183     6321    1        S_D.ACCESS = '1'B;
      184     6322    1        REMEMBER IF_TRAP IN S_D.REM_ACCESS;
      185     6323                                                /**/
      186     6324    1        COMP_FLAG = 0;
      187     6325    2        DO CASE(C_CLASS);   /* Perform the comparsions on the proper data type */
      188     6326    2          CASE(1);                /*CHAR_CLASS*/
      189     6327    2             IF V_CHAR = IF$->IF$CONST.TEXT THEN COMP_FLAG = 1;
      190     6328    2             ELSE IF V_CHAR < IF$->IF$CONST.TEXT THEN COMP_FLAG = 2;
      191     6329    2          CASE(2);                 /*BIT_CLASS*/
      192     6330    2             IF V.BITS = IF$->IF$CONST.BITS.TRING THEN COMP_FLAG =1;
      193     6331    2             ELSE IF V.BITS < IF$->IF$CONST.BITS.TRING THEN COMP_FLAG = 2;
      194     6332    2          CASE(3);               /*VALUE_CLASS*/
      195     6333    2             IF V.VALUE.L = IF$->IF$CONST.CONS.TANT THEN COMP_FLAG = 1;
      196     6334    2             ELSE IF V.VALUE.L < IF$->IF$CONST.CONS.TANT THEN COMP_FLAG = 2;
      197     6335    2          CASE(4);              /* FVALUE_CLASS */
      198     6336    2             DFLOAT = IF$ -> IF$CONST.BITS.TRING;
      199     6337    2             IF SIZE = 36
      200     6338    2             THEN CALL DDK$CFLT(DFLOAT, V.VALUE, COMP_FLAG);
      201     6339    2             ELSE CALL DDK$CDFLT(DFLOAT, V.VALUE, COMP_FLAG);
      202     6340    2          CASE(5);              /* DVALUE_CLASS */
      203     6341    2             IF V_FMT ~= %PUP_FMT          /* SINT_FMT */
      204     6342    3             THEN DO;                 /* Convert decimal constant to integer */
      205     6343    3                  TSCALE = IF$ -> IF$CONST.EXP;
      206     6344    3                  CTRUNC = '0'B;
      207     6345    3                  CSIZE = 63;
      208     6346    3                  IF TSCALE < 0
      209     6347    4                  THEN DO;
      210     6348    4                       CSIZE = 63 + TSCALE;
      211     6349    5                       DO I = 0 TO - TSCALE - 1;
      212     6350    5                            IF IF$ -> IF$CONST.TEXTA(62 - I) ~= '0'
      213     6351    5                            THEN CTRUNC = '1'B;
      214     6352    5                          END;
      215     6353    4                     END;
      216     6354    3                  CALL XCHARBIN(SVALUE, SUBSTR(IF$ -> IF$CONST.TEXT,0,CSIZE));
      217     6355    3                  IF V.VALUE.L = SVALUE
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:7    
      218     6356    3                  THEN IF CTRUNC
      219     6357    3                       THEN COMP_FLAG = 2;
      220     6358    3                       ELSE COMP_FLAG = 1;
      221     6359    3                  ELSE IF V.VALUE.L < SVALUE
      222     6360    3                       THEN COMP_FLAG = 2;
      223     6361    3                END;                  /* Convert decimal constant to integer */
      224     6362    3             ELSE DO;                      /* Perform decimal compare */
      225     6363
      226     6364    3                  CTRUNC = '0'B;
      227     6365    3                  VTRUNC = '0'B;
      228     6366    3                  CSIZE = 63;
      229     6367    3                  VSIZE = 63;
      230     6368    3                  TSCALE = ZITEM.PUP.SCALE - IF$ -> IF$CONST.EXP;
      231     6369    3                  IF TSCALE < 0            /* VAR < CONST */
      232     6370    4                  THEN DO;                 /* Truncate variable */
      233     6371    4                       VSIZE = 63 + TSCALE;
      234     6372    5                       DO I = 0 TO -TSCALE - 1;
      235     6373    5                            IF VC(62 - I) ~= '0'
      236     6374    5                            THEN VTRUNC = '1'B;
      237     6375    5                          END;
      238     6376    4                     END;                  /* Truncate variable */
      239     6377    3                  ELSE IF TSCALE > 0
      240     6378    4                       THEN DO;            /* Truncate constant */
      241     6379    4                            CSIZE = 63 - TSCALE;
      242     6380    5                            DO I = 0 TO TSCALE - 1;
      243     6381    5                                 IF IF$ -> IF$CONST.TEXTA(62 - I) ~= '0'
      244     6382    5                                 THEN CTRUNC = '1'B;
      245     6383    5                               END;
      246     6384    4                          END;             /* Truncate constant */
      247     6385    3                  CALL DDK$CMPDEC(CSIZE, IF$ -> IF$CONST.TEXTA, VSIZE, VC, COMP_FLAG);
      248     6386    3                  IF COMP_FLAG = 1         /* Equal */
      249     6387    3                    AND TSCALE ~= 0
      250     6388    3                  THEN IF CTRUNC
      251     6389    3                       THEN COMP_FLAG = 2; /* C_VAL > V_VAL */
      252     6390    3                       ELSE IF VTRUNC
      253     6391    3                            THEN COMP_FLAG = 0; /* C_VAL < V_VAL */
      254     6392    3                END;                       /* Perform decimal compare */
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:8    
      255     6393    2          END;
      256     6394                                                /**/
      257     6395        /*   FLAG.EL.E is set if C_VAL = V_VAL
      258     6396             FLAG.EL.L is set if C_VAL < V_VAL
      259     6397             FLAG.EL will test true if .E or .L is true */
      260     6398    1        S_D.ACCESS = '0'B;
      261     6399    1        IF WHEN
      262     6400    1        THEN TEMP = WHEN$CMD.WCOND;
      263     6401    1        ELSE TEMP = S_D.DO$->ALL_ATTACH.COND;
      264     6402    2        DO CASE (TEMP);
      265     6403                                                /**/
      266     6404    2          CASE(6);                  /* C@EQUALS */
      267     6405    2             IF FLAG.EL.E THEN GOTO TRUE;
      268     6406    2          CASE(2);                    /* C@LESS */
      269     6407    2             IF FLAG.EL.L THEN GOTO TRUE;
      270     6408    2          CASE(4);                  /* C@LESSEQ */
      271     6409    2             IF FLAG.EL THEN GOTO TRUE;
      272     6410    2          CASE(5);                   /* C@NOTEQ */
      273     6411    2             IF NOT FLAG.EL.E THEN GOTO TRUE;
      274     6412    2          CASE(3);                 /* C@GREATEQ (not less than) */
      275     6413    2             IF NOT FLAG.EL.L THEN GOTO TRUE;
      276     6414    2          CASE(1);            /* C@GREATER (not less than or equal to) */
      277     6415    2             IF NOT FLAG.EL THEN GOTO TRUE;
      278     6416    2          END;
      279     6417    1        NOGO_BIT = '1'B; /* "IF" was false, tell DDA$DO to bypass this attachment */
      280     6418    1        RETURN;
      281     6419    1   TRUE: NOGO_BIT = '0'B;        /* "IF" was true, tell DDA$DO to "DO" this one */
      282     6420    1        RETURN;
      283     6421    1   ERR_RTN: ALTRETURN;                     /* Unable to perform comparison */
      284     6422    1   IF_TRAP:
      285     6423    1        S_D.ERROR = 233;             /* E@IF_TRAP  */
      286     6424    1        CALL DDE$ERROR;
      287     6425    1        S_D.ACCESS = '0'B;
      288     6426    1        GOTO TRUE;
      289     6427        %EJECT;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:9    
      290     6428        /*D*  NAME:    GETVAL
      291     6429              DESCRIPTION: DO WHATEVER IT TAKES TO GET A VALUE OUT OF
      292     6430                  THE DATA DESCRIPTOR. ALTRETURN IF WE DON'T HANDLE THAT TYPE
      293     6431                  AND PASS THE BUCK IF THE DDK$GET ROUTINES COMPLAIN.
      294     6432                  */
      295     6433    1   GETVAL: PROC ALTRET;
      296     6434    2        IF C_CLASS = 1            /* CHAR_CLASS */
      297     6435    2        THEN V_CHAR = ' ';
      298     6436    2        ELSE V.BITS = '0'B;
      299     6437    2        IF D_XDELTA
      300     6438    2          AND ZITEM.FLAGS.MDSE.S
      301     6439    2          AND NOT U$SE.CUR
      302     6440    3        THEN DO;
      303     6441    3             S_D.ERROR = 38;   /* E@USE_CONFLICT */
      304     6442    3             ALTRETURN;
      305     6443    3           END;
      306     6444                                                /**/
      307     6445        /*  Get value according to type  */
      308     6446                                                /**/
      309     6447    3        DO CASE(ZITEM.DTYP);
      310     6448    3          CASE(%SIM_DTYP);
      311     6449                                                /* Get address and other good stuff */
      312     6450    3             S_D.DESC$ = DESC$;
      313     6451    3             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      314     6452    4             THEN DO;
      315     6453    4                  CALL DDK$GETADDR(ITEM, SVALUE, SIZE, INDXX, POINTER,
      316     6454    4                    EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG )
      317     6455    4                    ALTRET(VAL_ALTRET);
      318     6456    4                END;
      319     6457    4             ELSE DO;
      320     6458    4                  CALL DFK$EVAL_DISP(VALUE_L6, ADDRESS, SEG, DESC#,
      321     6459    4                    NOT_IS, SIZE, EXPR_OP_L6, '0'B) ALTRET(VAL_ALTRET);
      322     6460    4                  I = VALUE_L6.SIZE;
      323     6461    5                  DO I = 0 TO VALUE_L6.SIZE - 1;
      324     6462    5                       VCU.C(I*2) = VALUE_L6.OPSB.UH(I);
      325     6463    5                       VCU.C((I*2)+1) = VALUE_L6.OPSB.LH(I);
      326     6464    5                     END;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:10   
      327     6465    4                END;
      328     6466                                                /* TEST SIZE-TYPE MATCH */
      329     6467    4             DO CASE(S_D.DO$->ALL_ATTACH.CTYPE);
      330     6468    4               CASE(%PTR_FMT);
      331     6469    4                  IF SIZE ~= 36 THEN GOTO MIS_MATCH;
      332     6470    4               CASE(%CHAR_FMT);
      333     6471    4                  IF MOD(SIZE,9) ~= 0 THEN GOTO MIS_MATCH;
      334     6472    4               CASE(%SINT_FMT, %UINT_FMT, %OCT_FMT );
      335     6473    4                  IF V_FMT ~= %SINT_FMT AND V_FMT ~= %UINT_FMT
      336     6474    4                    AND SIZE ~= 36         /* V_FMT MUST BE SINT_FMT, UINT_FMT OR
      337     6475                                                 HAVE A SIZE OF 36 */
      338     6476    4                  THEN GOTO MIS_MATCH;
      339     6477    4               CASE(%FLOAT_FMT);
      340     6478    4                  IF SIZE ~= 36
      341     6479    4                    AND SIZE ~= 72
      342     6480    4                  THEN GOTO MIS_MATCH;
      343     6481                            /* BIT_FMT AND OBIT_FMT ARE WILD CARDS FOR LION AND MINX */
      344     6482    4               END;                        /* CASE(S_D.DO$->ALL_ATTACH.CTYPE */
      345     6483                                                /* Get value */
      346     6484    3             IF V_FMT = %CHAR_FMT
      347     6485    4             THEN DO;
      348     6486    4                  IF SIZE > 63*9 THEN SIZE = 63*9; /* SIZE IS IN BITS */
      349     6487    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      350     6488    4                  THEN CALL DDK$GETVAL(ADDR(V_CHAR), ITEM, SVALUE, SIZE, SIZE, INDXX,
      351     6489    4                         POINTER, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B)
      352     6490    4                         ALTRET(VAL_ALTRET);
      353     6491    4                END;
      354     6492    4             ELSE DO;
      355     6493    4                  IF V_FMT = %BIT_FMT
      356     6494    4                    OR V_FMT = %SINT_FMT
      357     6495    4                    OR V_FMT = %LOGFORT_FMT
      358     6496    4                  THEN RSIZE = SIZE;       /* Left justify */
      359     6497    5                  ELSE DO;
      360     6498    5                       IF SIZE > 36
      361     6499    5                       THEN RSIZE = 72;
      362     6500    5                       ELSE RSIZE = 36;
      363     6501    5                     END;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:11   
      364     6502    4                  IF EXPR_OP > 0
      365     6503    5                  THEN DO;
      366     6504    5                       SIZE = 36;          /* Force to word */
      367     6505    5                       RSIZE = 36;
      368     6506    5                     END;
      369     6507    4                  EIS = 0;
      370     6508    4                  IF V_FMT = %PUP_FMT
      371     6509    5                  THEN DO;
      372     6510    5                       IF ZITEM.PUP.BITS.SIGNOVER
      373     6511    6                       THEN DO;
      374     6512    6                            S_D.ERROR = 210; /* E@CANTIFOVER */
      375     6513    6                            ALTRETURN;
      376     6514    6                          END;
      377     6515    5                       RSIZE = 63;
      378     6516    5                       IF ZITEM.PUP.BITS.PUB = 1 /* Packed dec */
      379     6517    5                       THEN EIS = MVN(ZITEM.PUP.BITS.SIGNPOS);
      380     6518    6                       ELSE DO;
      381     6519    6                            EIS = UMVN( ZITEM.PUP.BITS.SIGNPOS );
      382     6520    6                            SIZE = SIZE / 9;
      383     6521    6                          END;
      384     6522    5                     END;
      385     6523    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      386     6524    5                  THEN DO;
      387     6525    5                       CALL DDK$GETVAL(ADDR(V_CHAR), ITEM, SVALUE, SIZE, RSIZE,
      388     6526    5                         INDXX, POINTER, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      389     6527    5                         '0'B, EIS) ALTRET(VAL_ALTRET);
      390     6528    5                       IF V_FMT = %SINT_FMT
      391     6529    5                         AND SIZE < 36
      392     6530    5                       THEN CALL DDK$SEXTEND(V.VALUE.L, SIZE);
      393     6531    5                     END;
      394     6532    4                END;
      395     6533    3          CASE(%SPEC_DTYP);
      396     6534    3             ITEM.VALUEB = ZITEM.VALUEB;
      397     6535    4             DO CASE(ITEM.SP.VS.ID);
      398     6536    4               CASE( %A_RTN );
      399     6537    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %HOST
      400     6538    4                  THEN GOTO NOTHOST;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:12   
      401     6539    4                  V.VALUE.L = S_D.UREG$ -> REG$VALUES.A;
      402     6540    4               CASE( %Q_RTN );
      403     6541    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %HOST
      404     6542    4                  THEN GOTO NOTHOST;
      405     6543    4                  V.VALUE.L = S_D.UREG$ -> REG$VALUES.Q;
      406     6544    4               CASE( %X_RTN );
      407     6545    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %HOST
      408     6546    4                  THEN GOTO NOTHOST;
      409     6547    4                  V.VALUE.L = S_D.UREG$ -> REG$VALUES.X(ITEM.SP.VS.SZ);
      410     6548    4                  SIZE = 36;
      411     6549    4               CASE(%CI_RTN, %T_RTN, %S_RTN, %IV_RTN, %Z_RTN,
      412     6550    4                    %ASV_RTN, %R_RTN, %M_RTN);
      413     6551    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %L6
      414     6552    4                  THEN GOTO NOTL6;
      415     6553    4                  CALL DFK$EVAL_DISP(VALUE_L6, ADDRESS, SEG, DESC#,
      416     6554    4                    NOT_IS, SIZE, EXPR_OP_L6, '0'B) ALTRET(VAL_ALTRET);
      417     6555    4               CASE(ELSE);
      418     6556    4                  S_D.ERROR = 4; /* E@INVLD_SPEC - Invalid use of special symbol */
      419     6557    4                  ALTRETURN;
      420     6558    4               END;                        /* DO CASE(ITEM.SP.VS.ID) */
      421     6559    3          CASE(ELSE);
      422     6560    3             S_D.ERROR = 503;         /* E@NOTIMP */
      423     6561    3          END;                             /* CASE(ZITEM.DTYP */
      424     6562    2        S_D.D$ = S_D.DESC$;                /* POINT TO NEXT DESCRIPTOR */
      425     6563    2        RETURN;                            /*With the variable's value in V_CHAR*/
      426     6564    2   VAL_ALTRET: ALTRETURN;        /* Error occured in one of the get routines */
      427     6565    2   MIS_MATCH: S_D.ERROR = 90;     /* E@SIZE_TYPE */
      428     6566    2        ALTRETURN;
      429     6567    2   NOTHOST:
      430     6568    2        S_D.ERROR = 308;           /* E@SYMNOTFEP */
      431     6569    2        ALTRETURN;
      432     6570    2   NOTL6:
      433     6571    2        S_D.ERROR = 304;          /* SYMNOTHOST */
      434     6572    2        ALTRETURN;
      435     6573    2   END GETVAL;
      436     6574    1   END DDA$IF;

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:13   
--  Include file information  --

   DD_EIS_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$IF.

   Procedure DDA$IF requires 822 words for executable code.
   Procedure DDA$IF requires 92 words of local(AUTO) storage.

    No errors detected in file DDA$IF.:E05TSI    .

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:14   

 Object Unit name= DDA$IF                                     File name= DDA$IF.:E05TOU
 UTS= JUL 29 '97 13:29:55.36 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      6      6  DDA$IF
    1   Proc  even  none   822   1466  DDA$IF
    2  RoData even  none     5      5  DDA$IF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  DDA$IF
     1     17          yes     yes      Std        1  DDA$IF_WHEN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 DDE$ERROR
         yes           Std       3 DDK$CFLT
         yes           Std       5 DDK$CMPDEC
         yes           Std       3 DDK$CDFLT
 yes     yes           Std       9 DDK$GETADDR
 yes     yes           Std       8 DFK$EVAL_DISP
         yes           Std       2 DDK$SEXTEND
 yes     yes           Std      13 DDK$GETVAL
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:15   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  D_XDELTA                              USE$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:16   


        1        1        /*M* DDA$IF DO IF ROUTINE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*D*  NAME:    DDA$IF
       10       10              CALL:    CALL DDA$IF(NOGO_BIT)
       11       11             INTERFACE: GETVAL - INTERNAL ROUTINE
       12       12                          DDK$GETADDR
       13       13                          DDK$GETMVAL
       14       14                          DDK$GETSPEC
       15       15                          DDK$GETVAL
       16       16                          DDK$SEXTEND
       17       17              INPUT:   S_D.DO$ - POINTS TO COMMAND FRAME
       18       18                       S_D.D$  - POINTS PAST END OF COMMAND FRAME, AT THE
       19       19                                 IF$CONST FRAME IF PRESENT.
       20       20              OUTPUT:  S_D.D$ - POINTS BEYOND THE IF DATA DESCRIPTOR IF
       21       21                                ONE IS PRESENT, OTHEWISE IT IS UNTOUCHED.
       22       22                       NOGO_BIT - RESULT OF IF COMPARISON.
       23       23              DESCRIPTION: IF THE COND FIELD OF THE COMMAND FRAME IS NON-ZERO,
       24       24                  THE CONSTANT AND THE VALUE OF THE VARIABLE ARE COMPARED
       25       25                  AS SPECIFIED IN THE CTYPE FIELD OF THE COMMAND FRAME.
       26       26                  THE NOGO_BIT IS RESET ('0'B) IF:
       27       27                       1) THE IF CLAUSE WAS NOT PRESENT IN THIS COMMAND FRAME.
       28       28                       2) THE IF CLAUSE WAS PRESENT, AND THE LOGICAL EXPRESSION
       29       29                          WAS TRUE.
       30       30                       THIS SIGNALS DDA$DO TO PROCEED WITH THIS ATTACHMENT.
       31       31                  THE NOGO_BIT IS SET ('1'B) IF THE IF CLAUSE WAS PRESENT
       32       32                  AND THE LOGICAL EXPRESSION WAS FALSE.  THIS SIGNALS
       33       33                  DDA$DO TO SKIP THIS ATTACHMENT.
       34       34                  ALTRETURN IS TAKEN AND THE ERROR CODE SET IF:
       35       35                       1) THE CONSTANT AND VARIABLE TYPES/LENGTHS ARE NOT
       36       36                          COMPATABLE.
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:17   
       37       37                       2) THE VARIABLE IS NOT AN EVALUATABLE EXPRESSION.
       38       38                       3) THE VARIABLE EXPRESSION IS NOT VALID IN THIS
       39       39                          CONTEXT. */
       40       40                                                /**/
       41       41        DDA$IF: PROC(NOGO_BIT) ALTRET;

     41  1 000000   000000 700200 xent  DDA$IF       TSX0  ! X66_AUTO_1
         1 000001   000134 000001                    ZERO    92,1

       42       42                                                /* Auto */
       43       43    1   DCL NOGO_BIT BIT(1) ALIGNED;
       44       44    1   DCL DESC$ PTR;
       45       45    1   DCL IF$ PTR;
       46       46    1   DCL WHEN$ PTR;
       47       47    1   DCL WHEN BIT(1) ALIGNED;
       48       48    1   DCL TEMP UBIN;
       49       49    1   DCL V_FMT UBIN;
       50       50    1   DCL C_CLASS UBIN;
       51       51        %SUB CHAR_CLASS = 1;
       52       52        %SUB BIT_CLASS = 2;
       53       53        %SUB VALUE_CLASS = 3;
       54       54        %SUB FVALUE_CLASS = 4;
       55       55        %SUB DVALUE_CLASS = 5;
       56       56    1   DCL COMP_FLAG UBIN;
       57       57    1   DCL 1 FLAG REDEF COMP_FLAG,
       58       58    1         2 * BIT(34),
       59       59    1         2 EL UNAL,
       60       60    1           3 L BIT(1) UNAL,
       61       61    1           3 E BIT(1) UNAL;
       62       62                                                /* Value buffer */
       63       63    1   DCL V_CHAR CHAR(63) DALIGNED;
       64       64    1   DCL VC(0:63) REDEF V_CHAR CHAR(1);
       65       65    1   DCL 1 VCU(0:63) REDEF V_CHAR,
       66       66    1         2 * BIT(1) UNAL,
       67       67    1         2 C UBIN(8) UNAL;
       68       68    1   DCL 1 V REDEF V_CHAR,
       69       69    1         2 VALUE,
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:18   
       70       70    1           3 L SBIN,
       71       71    1           3 R SBIN,
       72       72    1         2 BITS REDEF VALUE BIT(72),
       73       73    1         2 * CHAR(55);
       74       74    1   DCL 1 VALUE_L6,
       75       75    1         2 SIZE UBIN,
       76       76    1         2 OPS(0:15) UBIN,
       77       77    1         2 OPSB(0:15) REDEF OPS,
       78       78    1           3 * BIT(20) UNAL,
       79       79    1           3 UH UBIN(8) UNAL,
       80       80    1           3 LH UBIN(8) UNAL;
       81       81    1   DCL ADDRESS UBIN;
       82       82    1   DCL SEG UBIN;
       83       83    1   DCL DESC# UBIN;
       84       84    1   DCL NOT_IS BIT(1);
       85       85    1   DCL EXPR_OP_L6 BIT(1) ALIGNED;
       86       86                                                /**/
       87       87    1   DCL SVALUE SBIN;
       88       88    1   DCL SIZE SBIN;
       89       89    1   DCL RSIZE UBIN;
       90       90    1   DCL INDXX SBIN;
       91       91    1   DCL POINTER UBIN;
       92       92    1   DCL EXPR_VAL SBIN;
       93       93    1   DCL EXPR_OP UBIN;
       94       94    1   DCL ADDR_TYPE UBIN;
       95       95    1   DCL ARRAY_FLAG BIT(1);
       96       96        %INCLUDE DD$BASED;
       97     1399        %INCLUDE DD_PSUBS_C;
       98     1874        %INCLUDE XUH_MACRO_C;
       99     1958        %INCLUDE DD_SD_M;
      100     3294        %S_D;
      101     4612        %INCLUDE DD_SUBS_C;
      102     4883        %INCLUDE DD_ERR_C;
      103     5280        %INCLUDE DD$DITEM;
       12+    5383             %LIST;
       13+    5384    1        DCL SDD$ PTR;
       14+    5385    1        DCL ZITEM$ PTR;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:19   
       15+    5386    1        DCL SDD_L6$ PTR;
       16+    5387    1        DCL ZITEM_L6$ PTR;
      104     5961        %DITEM (NAME=ITEM, STCLASS=AUTO);
      105     6041        %ZITEM;
      106     6113        %INCLUDE DD_EIS_C;
      107     6139    1   DCL MVN(0:2) UBIN CONSTANT INIT(4, 5, 6); /* MVNU_EIS, MVNL_EIS, MVNT_EIS */
      108     6140    1   DCL UMVN(0:2) UBIN CONSTANT INIT(15, 16, 17); /* UMVNU_EIS, UMVNL_EIS, UMVNT_EIS */
      109     6141    1   DCL EIS UBIN;
      110     6142    1   DCL DFLOAT BIT(72) DALIGNED;
      111     6143    1   DCL I UBIN;
      112     6144    1   DCL TSCALE SBIN;
      113     6145    1   DCL VTRUNC BIT(1);
      114     6146    1   DCL CTRUNC BIT(1);
      115     6147    1   DCL VSIZE UBIN;
      116     6148    1   DCL CSIZE UBIN;
      117     6149        %ALL_ATTACH;
      118     6164        %U$SE;
      119     6172        %IF$CONST;
      120     6210        %HOST_REG$VALUES(NAME=REG$VALUES);
      121     6223        %WHEN_FIRST(NAME=WHEN$CMD, STCLASS="BASED(WHEN$)");
      122     6260        /* EXTERNALS */
      123     6261    1   DCL D_XDELTA BIT(1) SYMREF;
      124     6262    1   DCL USE$ PTR SYMREF;
      125     6263    1   DCL DDK$GETADDR ENTRY(9) ALTRET;
      126     6264    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      127     6265    1   DCL DDK$GETSPEC ENTRY(2) ALTRET;
      128     6266    1   DCL DDK$GETVAL ENTRY(13) ALTRET;
      129     6267    1   DCL DDK$SEXTEND ENTRY(2);
      130     6268    1   DCL DDK$CFLT ENTRY(3);
      131     6269    1   DCL DDK$CDFLT ENTRY(3);
      132     6270    1   DCL DDK$CMPDEC ENTRY(5);
      133     6271    1   DCL DDE$ERROR ENTRY;
      134     6272    1   DCL DFK$EVAL_DISP ENTRY(8) ALTRET;
      135     6273                                                /**/
      136     6274                                                /**/
      137     6275    1        IF S_D.DO$->ALL_ATTACH.COND = 0    /* If no IF clause */

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:20   
   6275  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   000031 471500                    LDP1    25,,PR0
         1 000004   100001 236100                    LDQ     1,,PR1
         1 000005   000007 316007                    CANQ    7,DL
         1 000006   000565 600000 1                  TZE     TRUE

      138     6276    1        THEN GOTO TRUE;                    /* then say doit */
      139     6277    1        IF$ = S_D.D$;                      /* Save ptr to IF$CONST */

   6277  1 000007   000044 236100                    LDQ     36,,PR0
         1 000010   200005 756100                    STQ     IF$,,AUTO

      140     6278    1        S_D.D$ = PINCRW(S_D.D$,SIZEW(IF$CONST)); /* Point to data descriptor */

   6278  1 000011   000020 036003                    ADLQ    16,DU
         1 000012   000044 756100                    STQ     36,,PR0

      141     6279    1        DESC$ = S_D.D$;                    /* Save it */

   6279  1 000013   200004 756100                    STQ     DESC$,,AUTO

      142     6280    1        ZITEM$ = S_D.D$;                   /* Save it */

   6280  1 000014   200074 756100                    STQ     ZITEM$,,AUTO

      143     6281    1        WHEN = '0'B;

   6281  1 000015   200007 450100                    STZ     WHEN,,AUTO

      144     6282    1        GOTO IFCONTINUE;

   6282  1 000016   000036 710000 1                  TRA     IFCONTINUE

      145     6283
      146     6284    1   DDA$IF_WHEN: ENTRY(NOGO_BIT) ALTRET;

   6284  1 000017   000000 700200 xent  DDA$IF_WHEN  TSX0  ! X66_AUTO_1
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:21   
         1 000020   000134 000001                    ZERO    92,1

      147     6285
      148     6286    1        WHEN$ = S_D.DO$;

   6286  1 000021   000000 470400 xsym               LDP0    S_D$
         1 000022   000031 236100                    LDQ     25,,PR0
         1 000023   200006 756100                    STQ     WHEN$,,AUTO

      149     6287    1        IF$ = PINCRW(S_D.DO$, WHEN$CMD.U.CONST_OFFSET);

   6287  1 000024   200006 471500                    LDP1    WHEN$,,AUTO
         1 000025   100001 220100                    LDX0    1,,PR1
         1 000026   000031 473500                    LDP3    25,,PR0
         1 000027   300000 634510                    EPPR4   0,X0,PR3
         1 000030   200005 454500                    STP4    IF$,,AUTO

      150     6288    1        ZITEM$ = PINCRW(S_D.DO$, SIZEW(WHEN$CMD));

   6288  1 000031   000021 036003                    ADLQ    17,DU
         1 000032   200074 756100                    STQ     ZITEM$,,AUTO

      151     6289    1        DESC$ = ZITEM$;

   6289  1 000033   200004 756100                    STQ     DESC$,,AUTO

      152     6290    1        WHEN = '1'B;

   6290  1 000034   400000 236003                    LDQ     -131072,DU
         1 000035   200007 756100                    STQ     WHEN,,AUTO

   6290  1 000036                       IFCONTINUE   null
      153     6291
      154     6292    1   IFCONTINUE: ;
      155     6293    1        V_FMT = ZITEM.FMT_SPEC;

   6293  1 000036   200074 471500                    LDP1    ZITEM$,,AUTO
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:22   
         1 000037   100006 236100                    LDQ     6,,PR1
         1 000040   000011 772000                    QRL     9
         1 000041   000777 376007                    ANQ     511,DL
         1 000042   200011 756100                    STQ     V_FMT,,AUTO

      156     6294                                                /* Get and convert constant type */
      157     6295    1        IF WHEN

   6295  1 000043   200007 234100                    SZN     WHEN,,AUTO
         1 000044   000051 605000 1                  TPL     s:6297

      158     6296    1        THEN TEMP = WHEN$CMD.WCTYPE;

   6296  1 000045   200006 473500                    LDP3    WHEN$,,AUTO
         1 000046   300010 235100                    LDA     8,,PR3
         1 000047   200010 755100                    STA     TEMP,,AUTO
         1 000050   000056 710000 1                  TRA     s:6298

      159     6297    1        ELSE TEMP = S_D.DO$->ALL_ATTACH.CTYPE;

   6297  1 000051   000031 473500                    LDP3    25,,PR0
         1 000052   300001 236100                    LDQ     1,,PR3
         1 000053   000003 772000                    QRL     3
         1 000054   000037 376007                    ANQ     31,DL
         1 000055   200010 756100                    STQ     TEMP,,AUTO

      160     6298    2        DO CASE(TEMP);

   6298  1 000056   200010 235100                    LDA     TEMP,,AUTO
         1 000057   000036 115007                    CMPA    30,DL
         1 000060   000062 602005 1                  TNC     s:6298+4,AL
         1 000061   000137 710000 1                  TRA     s:6310
         1 000062   000137 710000 1                  TRA     s:6310
         1 000063   000126 710000 1                  TRA     s:6304
         1 000064   000126 710000 1                  TRA     s:6304
         1 000065   000126 710000 1                  TRA     s:6304
         1 000066   000120 710000 1                  TRA     s:6300
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:23   
         1 000067   000123 710000 1                  TRA     s:6302
         1 000070   000137 710000 1                  TRA     s:6310
         1 000071   000123 710000 1                  TRA     s:6302
         1 000072   000137 710000 1                  TRA     s:6310
         1 000073   000137 710000 1                  TRA     s:6310
         1 000074   000137 710000 1                  TRA     s:6310
         1 000075   000137 710000 1                  TRA     s:6310
         1 000076   000137 710000 1                  TRA     s:6310
         1 000077   000123 710000 1                  TRA     s:6302
         1 000100   000123 710000 1                  TRA     s:6302
         1 000101   000137 710000 1                  TRA     s:6310
         1 000102   000131 710000 1                  TRA     s:6306
         1 000103   000137 710000 1                  TRA     s:6310
         1 000104   000137 710000 1                  TRA     s:6310
         1 000105   000137 710000 1                  TRA     s:6310
         1 000106   000137 710000 1                  TRA     s:6310
         1 000107   000137 710000 1                  TRA     s:6310
         1 000110   000137 710000 1                  TRA     s:6310
         1 000111   000137 710000 1                  TRA     s:6310
         1 000112   000137 710000 1                  TRA     s:6310
         1 000113   000137 710000 1                  TRA     s:6310
         1 000114   000137 710000 1                  TRA     s:6310
         1 000115   000137 710000 1                  TRA     s:6310
         1 000116   000137 710000 1                  TRA     s:6310
         1 000117   000134 710000 1                  TRA     s:6308

      161     6299    2          CASE(%CHAR_FMT);

      162     6300    2             C_CLASS = 1;         /* CHAR_CLASS */

   6300  1 000120   000001 236007                    LDQ     1,DL
         1 000121   200012 756100                    STQ     C_CLASS,,AUTO
         1 000122   000145 710000 1                  TRA     s:6315

      163     6301    2          CASE(%BIT_FMT,%OBIT_FMT,%PTR_FMT,%X_FMT);

      164     6302    2             C_CLASS = 2;          /* BIT_CLASS */
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:24   

   6302  1 000123   000002 236007                    LDQ     2,DL
         1 000124   200012 756100                    STQ     C_CLASS,,AUTO
         1 000125   000145 710000 1                  TRA     s:6315

      165     6303    2          CASE(%SINT_FMT, %UINT_FMT, %OCT_FMT);

      166     6304    2             C_CLASS = 3;        /*VALUE_CLASS*/

   6304  1 000126   000003 236007                    LDQ     3,DL
         1 000127   200012 756100                    STQ     C_CLASS,,AUTO
         1 000130   000145 710000 1                  TRA     s:6315

      167     6305    2          CASE(%FLOAT_FMT);

      168     6306    2             C_CLASS = 4;       /* FVALUE_CLASS */

   6306  1 000131   000004 236007                    LDQ     4,DL
         1 000132   200012 756100                    STQ     C_CLASS,,AUTO
         1 000133   000145 710000 1                  TRA     s:6315

      169     6307    2          CASE(%PUP_FMT);

      170     6308    2             C_CLASS = 5;       /* DVALUE_CLASS */

   6308  1 000134   000005 236007                    LDQ     5,DL
         1 000135   200012 756100                    STQ     C_CLASS,,AUTO
         1 000136   000145 710000 1                  TRA     s:6315

      171     6309    2          CASE(ELSE);

      172     6310    2             S_D.ERROR = 502;         /* E@DELBUG - Bad constant type*/

   6310  1 000137   000766 236007                    LDQ     502,DL
         1 000140   000013 756100                    STQ     11,,PR0

      173     6311    2             CALL DDE$ERROR;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:25   

   6311  1 000141   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000142   000000 701000 xent               TSX1    DDE$ERROR
         1 000143   000000 011000                    NOP     0

      174     6312    2             GOTO ERR_RTN;

   6312  1 000144   000570 710000 1                  TRA     ERR_RTN

      175     6313    2          END;                             /* Case C_FMT */

      176     6314                                                /**/
      177     6315    1        CALL GETVAL ALTRET(ERR_RTN);       /* Get variable value, properly aligned,

   6315  1 000145   000602 701000 1                  TSX1    GETVAL
         1 000146   000570 702000 1                  TSX2    ERR_RTN

      178     6316                                                    and ready to compare */
      179     6317                                                /**/
      180     6318        /*  Two comparisions between the actual values are
      181     6319            performed, the logical value of all relations are
      182     6320            determined by the results. */
      183     6321    1        S_D.ACCESS = '1'B;

   6321  1 000147   400000 236003                    LDQ     -131072,DU
         1 000150   000000 470400 xsym               LDP0    S_D$
         1 000151   000016 756100                    STQ     14,,PR0

      184     6322    1        REMEMBER IF_TRAP IN S_D.REM_ACCESS;

   6322  1 000152   000571 635000 1                  EAA     IF_TRAP
         1 000153   000024 452500                    STP2    20,,PR0
         1 000154   000025 755100                    STA     21,,PR0

      185     6323                                                /**/
      186     6324    1        COMP_FLAG = 0;

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:26   
   6324  1 000155   200013 450100                    STZ     COMP_FLAG,,AUTO

      187     6325    2        DO CASE(C_CLASS);   /* Perform the comparsions on the proper data type */

   6325  1 000156   200012 235100                    LDA     C_CLASS,,AUTO
         1 000157   000006 115007                    CMPA    6,DL
         1 000160   000162 602005 1                  TNC     s:6325+4,AL
         1 000161   000503 710000 1                  TRA     s:6398
         1 000162   000503 710000 1                  TRA     s:6398
         1 000163   000170 710000 1                  TRA     s:6327
         1 000164   000204 710000 1                  TRA     s:6330
         1 000165   000220 710000 1                  TRA     s:6333
         1 000166   000233 710000 1                  TRA     s:6336
         1 000167   000270 710000 1                  TRA     s:6341

      188     6326    2          CASE(1);                /*CHAR_CLASS*/

      189     6327    2             IF V_CHAR = IF$->IF$CONST.TEXT THEN COMP_FLAG = 1;

   6327  1 000170   200005 471500                    LDP1    IF$,,AUTO
         1 000171   040100 106500                    CMPC    fill='040'O
         1 000172   200014 000077                    ADSC9   V_CHAR,,AUTO             cn=0,n=63
         1 000173   100000 200077                    ADSC9   0,,PR1                   cn=1,n=63
         1 000174   000200 601000 1                  TNZ     s:6328

   6327  1 000175   000001 235007                    LDA     1,DL
         1 000176   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000177   000503 710000 1                  TRA     s:6398

      190     6328    2             ELSE IF V_CHAR < IF$->IF$CONST.TEXT THEN COMP_FLAG = 2;

   6328  1 000200   000503 603000 1                  TRC     s:6398

   6328  1 000201   000002 235007                    LDA     2,DL
         1 000202   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000203   000503 710000 1                  TRA     s:6398

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:27   
      191     6329    2          CASE(2);                 /*BIT_CLASS*/

      192     6330    2             IF V.BITS = IF$->IF$CONST.BITS.TRING THEN COMP_FLAG =1;

   6330  1 000204   200005 471500                    LDP1    IF$,,AUTO
         1 000205   000100 106500                    CMPC    fill='000'O
         1 000206   200014 000010                    ADSC9   V_CHAR,,AUTO             cn=0,n=8
         1 000207   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000210   000214 601000 1                  TNZ     s:6331

   6330  1 000211   000001 235007                    LDA     1,DL
         1 000212   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000213   000503 710000 1                  TRA     s:6398

      193     6331    2             ELSE IF V.BITS < IF$->IF$CONST.BITS.TRING THEN COMP_FLAG = 2;

   6331  1 000214   000503 603000 1                  TRC     s:6398

   6331  1 000215   000002 235007                    LDA     2,DL
         1 000216   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000217   000503 710000 1                  TRA     s:6398

      194     6332    2          CASE(3);               /*VALUE_CLASS*/

      195     6333    2             IF V.VALUE.L = IF$->IF$CONST.CONS.TANT THEN COMP_FLAG = 1;

   6333  1 000220   200005 471500                    LDP1    IF$,,AUTO
         1 000221   200014 236100                    LDQ     V_CHAR,,AUTO
         1 000222   100001 116100                    CMPQ    1,,PR1
         1 000223   000227 601000 1                  TNZ     s:6334

   6333  1 000224   000001 235007                    LDA     1,DL
         1 000225   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000226   000503 710000 1                  TRA     s:6398

      196     6334    2             ELSE IF V.VALUE.L < IF$->IF$CONST.CONS.TANT THEN COMP_FLAG = 2;

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:28   
   6334  1 000227   000503 605000 1                  TPL     s:6398

   6334  1 000230   000002 235007                    LDA     2,DL
         1 000231   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000232   000503 710000 1                  TRA     s:6398

      197     6335    2          CASE(4);              /* FVALUE_CLASS */

      198     6336    2             DFLOAT = IF$ -> IF$CONST.BITS.TRING;

   6336  1 000233   200005 471500                    LDP1    IF$,,AUTO
         1 000234   000100 100500                    MLR     fill='000'O
         1 000235   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         1 000236   200104 000010                    ADSC9   DFLOAT,,AUTO             cn=0,n=8

      199     6337    2             IF SIZE = 36

   6337  1 000237   200063 235100                    LDA     SIZE,,AUTO
         1 000240   000044 115007                    CMPA    36,DL
         1 000241   000255 601000 1                  TNZ     s:6339

      200     6338    2             THEN CALL DDK$CFLT(DFLOAT, V.VALUE, COMP_FLAG);

   6338  1 000242   200013 633500                    EPPR3   COMP_FLAG,,AUTO
         1 000243   200120 453500                    STP3    CSIZE+5,,AUTO
         1 000244   200014 634500                    EPPR4   V_CHAR,,AUTO
         1 000245   200117 454500                    STP4    CSIZE+4,,AUTO
         1 000246   200104 635500                    EPPR5   DFLOAT,,AUTO
         1 000247   200116 455500                    STP5    CSIZE+3,,AUTO
         1 000250   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 000251   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000252   000000 701000 xent               TSX1    DDK$CFLT
         1 000253   000000 011000                    NOP     0
         1 000254   000503 710000 1                  TRA     s:6398

      201     6339    2             ELSE CALL DDK$CDFLT(DFLOAT, V.VALUE, COMP_FLAG);

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:29   
   6339  1 000255   200013 633500                    EPPR3   COMP_FLAG,,AUTO
         1 000256   200120 453500                    STP3    CSIZE+5,,AUTO
         1 000257   200014 634500                    EPPR4   V_CHAR,,AUTO
         1 000260   200117 454500                    STP4    CSIZE+4,,AUTO
         1 000261   200104 635500                    EPPR5   DFLOAT,,AUTO
         1 000262   200116 455500                    STP5    CSIZE+3,,AUTO
         1 000263   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 000264   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000265   000000 701000 xent               TSX1    DDK$CDFLT
         1 000266   000000 011000                    NOP     0
         1 000267   000503 710000 1                  TRA     s:6398

      202     6340    2          CASE(5);              /* DVALUE_CLASS */

      203     6341    2             IF V_FMT ~= %PUP_FMT          /* SINT_FMT */

   6341  1 000270   200011 235100                    LDA     V_FMT,,AUTO
         1 000271   000035 115007                    CMPA    29,DL
         1 000272   000355 600000 1                  TZE     s:6364

      204     6342    3             THEN DO;                 /* Convert decimal constant to integer */

      205     6343    3                  TSCALE = IF$ -> IF$CONST.EXP;

   6343  1 000273   200005 471500                    LDP1    IF$,,AUTO
         1 000274   100000 236100                    LDQ     0,,PR1
         1 000275   000033 732000                    QRS     27
         1 000276   200107 756100                    STQ     TSCALE,,AUTO

      206     6344    3                  CTRUNC = '0'B;

   6344  1 000277   200111 450100                    STZ     CTRUNC,,AUTO

      207     6345    3                  CSIZE = 63;

   6345  1 000300   000077 235007                    LDA     63,DL
         1 000301   200113 755100                    STA     CSIZE,,AUTO
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:30   

      208     6346    3                  IF TSCALE < 0

   6346  1 000302   000000 116003                    CMPQ    0,DU
         1 000303   000331 605000 1                  TPL     s:6354

      209     6347    4                  THEN DO;

      210     6348    4                       CSIZE = 63 + TSCALE;

   6348  1 000304   000077 036007                    ADLQ    63,DL
         1 000305   200113 756100                    STQ     CSIZE,,AUTO

      211     6349    5                       DO I = 0 TO - TSCALE - 1;

   6349  1 000306   200106 450100                    STZ     I,,AUTO
         1 000307   000324 710000 1                  TRA     s:6352+3

      212     6350    5                            IF IF$ -> IF$CONST.TEXTA(62 - I) ~= '0'

   6350  1 000310   000000 235003                    LDA     0,DU
         1 000311   200106 135100                    SBLA    I,,AUTO
         1 000312   200005 470500                    LDP0    IF$,,AUTO
         1 000313   040000 106505                    CMPC    fill='040'O
         1 000314   000017 600001                    ADSC9   15,A,PR0                 cn=3,n=1
         1 000315   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000316   000321 600000 1                  TZE     s:6352

      213     6351    5                            THEN CTRUNC = '1'B;

   6351  1 000317   400000 236003                    LDQ     -131072,DU
         1 000320   200111 756100                    STQ     CTRUNC,,AUTO

      214     6352    5                          END;

   6352  1 000321   200106 236100                    LDQ     I,,AUTO
         1 000322   000001 036007                    ADLQ    1,DL
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:31   
         1 000323   200106 756100                    STQ     I,,AUTO
         1 000324   200107 336100                    LCQ     TSCALE,,AUTO
         1 000325   000331 604000 1                  TMI     s:6354
         1 000326   200106 116100                    CMPQ    I,,AUTO
         1 000327   000331 600000 1                  TZE     s:6354
         1 000330   000310 603000 1                  TRC     s:6350

      215     6353    4                     END;

      216     6354    3                  CALL XCHARBIN(SVALUE, SUBSTR(IF$ -> IF$CONST.TEXT,0,CSIZE));

   6354  1 000331   200005 470500                    LDP0    IF$,,AUTO
         1 000332   200113 720100                    LXL0    CSIZE,,AUTO
         1 000333   000100 305540                    DTB
         1 000334   000000 210010                    NDSC9   0,,PR0                   cn=1,s=lsgns,sf=0,n=*X0
         1 000335   200062 000004                    NDSC9   SVALUE,,AUTO             cn=0,s=lsgnf,sf=0,n=4

      217     6355    3                  IF V.VALUE.L = SVALUE

   6355  1 000336   200014 236100                    LDQ     V_CHAR,,AUTO
         1 000337   200062 116100                    CMPQ    SVALUE,,AUTO
         1 000340   000351 601000 1                  TNZ     s:6359

      218     6356    3                  THEN IF CTRUNC

   6356  1 000341   200111 234100                    SZN     CTRUNC,,AUTO
         1 000342   000346 605000 1                  TPL     s:6358

      219     6357    3                       THEN COMP_FLAG = 2;

   6357  1 000343   000002 235007                    LDA     2,DL
         1 000344   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000345   000503 710000 1                  TRA     s:6398

      220     6358    3                       ELSE COMP_FLAG = 1;

   6358  1 000346   000001 235007                    LDA     1,DL
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:32   
         1 000347   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000350   000503 710000 1                  TRA     s:6398

      221     6359    3                  ELSE IF V.VALUE.L < SVALUE

   6359  1 000351   000503 605000 1                  TPL     s:6398

      222     6360    3                       THEN COMP_FLAG = 2;

   6360  1 000352   000002 235007                    LDA     2,DL
         1 000353   200013 755100                    STA     COMP_FLAG,,AUTO

      223     6361    3                END;                  /* Convert decimal constant to integer */

   6361  1 000354   000503 710000 1                  TRA     s:6398

      224     6362    3             ELSE DO;                      /* Perform decimal compare */

      225     6363
      226     6364    3                  CTRUNC = '0'B;

   6364  1 000355   200111 450100                    STZ     CTRUNC,,AUTO

      227     6365    3                  VTRUNC = '0'B;

   6365  1 000356   200110 450100                    STZ     VTRUNC,,AUTO

      228     6366    3                  CSIZE = 63;

   6366  1 000357   000077 235007                    LDA     63,DL
         1 000360   200113 755100                    STA     CSIZE,,AUTO

      229     6367    3                  VSIZE = 63;

   6367  1 000361   200112 755100                    STA     VSIZE,,AUTO

      230     6368    3                  TSCALE = ZITEM.PUP.SCALE - IF$ -> IF$CONST.EXP;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:33   

   6368  1 000362   200005 471500                    LDP1    IF$,,AUTO
         1 000363   100000 236100                    LDQ     0,,PR1
         1 000364   000033 732000                    QRS     27
         1 000365   200116 756100                    STQ     CSIZE+3,,AUTO
         1 000366   200074 473500                    LDP3    ZITEM$,,AUTO
         1 000367   300010 236100                    LDQ     8,,PR3
         1 000370   000026 736000                    QLS     22
         1 000371   000034 732000                    QRS     28
         1 000372   200116 136100                    SBLQ    CSIZE+3,,AUTO
         1 000373   200107 756100                    STQ     TSCALE,,AUTO

      231     6369    3                  IF TSCALE < 0            /* VAR < CONST */

   6369  1 000374   000422 605000 1                  TPL     s:6377

      232     6370    4                  THEN DO;                 /* Truncate variable */

      233     6371    4                       VSIZE = 63 + TSCALE;

   6371  1 000375   000077 036007                    ADLQ    63,DL
         1 000376   200112 756100                    STQ     VSIZE,,AUTO

      234     6372    5                       DO I = 0 TO -TSCALE - 1;

   6372  1 000377   200106 450100                    STZ     I,,AUTO
         1 000400   000414 710000 1                  TRA     s:6375+3

      235     6373    5                            IF VC(62 - I) ~= '0'

   6373  1 000401   000000 235003                    LDA     0,DU
         1 000402   200106 135100                    SBLA    I,,AUTO
         1 000403   040000 106505                    CMPC    fill='040'O
         1 000404   200033 400001                    ADSC9   V_CHAR+15,A,AUTO         cn=2,n=1
         1 000405   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000406   000411 600000 1                  TZE     s:6375

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:34   
      236     6374    5                            THEN VTRUNC = '1'B;

   6374  1 000407   400000 236003                    LDQ     -131072,DU
         1 000410   200110 756100                    STQ     VTRUNC,,AUTO

      237     6375    5                          END;

   6375  1 000411   200106 236100                    LDQ     I,,AUTO
         1 000412   000001 036007                    ADLQ    1,DL
         1 000413   200106 756100                    STQ     I,,AUTO
         1 000414   200107 336100                    LCQ     TSCALE,,AUTO
         1 000415   000421 604000 1                  TMI     s:6376
         1 000416   200106 116100                    CMPQ    I,,AUTO
         1 000417   000421 600000 1                  TZE     s:6376
         1 000420   000401 603000 1                  TRC     s:6373

      238     6376    4                     END;                  /* Truncate variable */

   6376  1 000421   000447 710000 1                  TRA     s:6385

      239     6377    3                  ELSE IF TSCALE > 0

   6377  1 000422   000447 604400 1                  TMOZ    s:6385

      240     6378    4                       THEN DO;            /* Truncate constant */

      241     6379    4                            CSIZE = 63 - TSCALE;

   6379  1 000423   200107 135100                    SBLA    TSCALE,,AUTO
         1 000424   200113 755100                    STA     CSIZE,,AUTO

      242     6380    5                            DO I = 0 TO TSCALE - 1;

   6380  1 000425   200106 450100                    STZ     I,,AUTO
         1 000426   000443 710000 1                  TRA     s:6383+3

      243     6381    5                                 IF IF$ -> IF$CONST.TEXTA(62 - I) ~= '0'
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:35   

   6381  1 000427   000000 235003                    LDA     0,DU
         1 000430   200106 135100                    SBLA    I,,AUTO
         1 000431   200005 470500                    LDP0    IF$,,AUTO
         1 000432   040000 106505                    CMPC    fill='040'O
         1 000433   000017 600001                    ADSC9   15,A,PR0                 cn=3,n=1
         1 000434   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000435   000440 600000 1                  TZE     s:6383

      244     6382    5                                 THEN CTRUNC = '1'B;

   6382  1 000436   400000 236003                    LDQ     -131072,DU
         1 000437   200111 756100                    STQ     CTRUNC,,AUTO

      245     6383    5                               END;

   6383  1 000440   200106 236100                    LDQ     I,,AUTO
         1 000441   000001 036007                    ADLQ    1,DL
         1 000442   200106 756100                    STQ     I,,AUTO
         1 000443   200106 236100                    LDQ     I,,AUTO
         1 000444   000447 604000 1                  TMI     s:6385
         1 000445   200107 116100                    CMPQ    TSCALE,,AUTO
         1 000446   000427 604000 1                  TMI     s:6381

      246     6384    4                          END;             /* Truncate constant */

      247     6385    3                  CALL DDK$CMPDEC(CSIZE, IF$ -> IF$CONST.TEXTA, VSIZE, VC, COMP_FLAG);

   6385  1 000447   200013 630500                    EPPR0   COMP_FLAG,,AUTO
         1 000450   200122 450500                    STP0    CSIZE+7,,AUTO
         1 000451   200014 631500                    EPPR1   V_CHAR,,AUTO
         1 000452   200121 451500                    STP1    CSIZE+6,,AUTO
         1 000453   200112 633500                    EPPR3   VSIZE,,AUTO
         1 000454   200120 453500                    STP3    CSIZE+5,,AUTO
         1 000455   200005 236100                    LDQ     IF$,,AUTO
         1 000456   200000 036007                    ADLQ    65536,DL
         1 000457   200117 756100                    STQ     CSIZE+4,,AUTO
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:36   
         1 000460   200113 634500                    EPPR4   CSIZE,,AUTO
         1 000461   200116 454500                    STP4    CSIZE+3,,AUTO
         1 000462   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 000463   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000464   000000 701000 xent               TSX1    DDK$CMPDEC
         1 000465   000000 011000                    NOP     0

      248     6386    3                  IF COMP_FLAG = 1         /* Equal */

   6386  1 000466   200013 235100                    LDA     COMP_FLAG,,AUTO
         1 000467   000001 115007                    CMPA    1,DL
         1 000470   000503 601000 1                  TNZ     s:6398
         1 000471   200107 236100                    LDQ     TSCALE,,AUTO
         1 000472   000503 600000 1                  TZE     s:6398

      249     6387    3                    AND TSCALE ~= 0
      250     6388    3                  THEN IF CTRUNC

   6388  1 000473   200111 234100                    SZN     CTRUNC,,AUTO
         1 000474   000500 605000 1                  TPL     s:6390

      251     6389    3                       THEN COMP_FLAG = 2; /* C_VAL > V_VAL */

   6389  1 000475   000002 235007                    LDA     2,DL
         1 000476   200013 755100                    STA     COMP_FLAG,,AUTO
         1 000477   000503 710000 1                  TRA     s:6398

      252     6390    3                       ELSE IF VTRUNC

   6390  1 000500   200110 234100                    SZN     VTRUNC,,AUTO
         1 000501   000503 605000 1                  TPL     s:6398

      253     6391    3                            THEN COMP_FLAG = 0; /* C_VAL < V_VAL */

   6391  1 000502   200013 450100                    STZ     COMP_FLAG,,AUTO

      254     6392    3                END;                       /* Perform decimal compare */
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:37   

      255     6393    2          END;

      256     6394                                                /**/
      257     6395        /*   FLAG.EL.E is set if C_VAL = V_VAL
      258     6396             FLAG.EL.L is set if C_VAL < V_VAL
      259     6397             FLAG.EL will test true if .E or .L is true */
      260     6398    1        S_D.ACCESS = '0'B;

   6398  1 000503   000000 470400 xsym               LDP0    S_D$
         1 000504   000016 450100                    STZ     14,,PR0

      261     6399    1        IF WHEN

   6399  1 000505   200007 234100                    SZN     WHEN,,AUTO
         1 000506   000513 605000 1                  TPL     s:6401

      262     6400    1        THEN TEMP = WHEN$CMD.WCOND;

   6400  1 000507   200006 471500                    LDP1    WHEN$,,AUTO
         1 000510   100011 235100                    LDA     9,,PR1
         1 000511   200010 755100                    STA     TEMP,,AUTO
         1 000512   000517 710000 1                  TRA     s:6402

      263     6401    1        ELSE TEMP = S_D.DO$->ALL_ATTACH.COND;

   6401  1 000513   000031 471500                    LDP1    25,,PR0
         1 000514   100001 236100                    LDQ     1,,PR1
         1 000515   000007 376007                    ANQ     7,DL
         1 000516   200010 756100                    STQ     TEMP,,AUTO

      264     6402    2        DO CASE (TEMP);

   6402  1 000517   200010 235100                    LDA     TEMP,,AUTO
         1 000520   000007 115007                    CMPA    7,DL
         1 000521   000523 602005 1                  TNC     s:6402+4,AL
         1 000522   000561 710000 1                  TRA     s:6417
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:38   
         1 000523   000561 710000 1                  TRA     s:6417
         1 000524   000556 710000 1                  TRA     s:6415
         1 000525   000536 710000 1                  TRA     s:6407
         1 000526   000552 710000 1                  TRA     s:6413
         1 000527   000542 710000 1                  TRA     s:6409
         1 000530   000546 710000 1                  TRA     s:6411
         1 000531   000532 710000 1                  TRA     s:6405

      265     6403                                                /**/
      266     6404    2          CASE(6);                  /* C@EQUALS */

      267     6405    2             IF FLAG.EL.E THEN GOTO TRUE;

   6405  1 000532   200013 236100                    LDQ     COMP_FLAG,,AUTO
         1 000533   000001 316007                    CANQ    1,DL
         1 000534   000565 601000 1                  TNZ     TRUE
         1 000535   000561 710000 1                  TRA     s:6417

      268     6406    2          CASE(2);                    /* C@LESS */

      269     6407    2             IF FLAG.EL.L THEN GOTO TRUE;

   6407  1 000536   200013 236100                    LDQ     COMP_FLAG,,AUTO
         1 000537   000002 316007                    CANQ    2,DL
         1 000540   000565 601000 1                  TNZ     TRUE
         1 000541   000561 710000 1                  TRA     s:6417

      270     6408    2          CASE(4);                  /* C@LESSEQ */

      271     6409    2             IF FLAG.EL THEN GOTO TRUE;

   6409  1 000542   200013 236100                    LDQ     COMP_FLAG,,AUTO
         1 000543   000003 316007                    CANQ    3,DL
         1 000544   000565 601000 1                  TNZ     TRUE
         1 000545   000561 710000 1                  TRA     s:6417

      272     6410    2          CASE(5);                   /* C@NOTEQ */
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:39   

      273     6411    2             IF NOT FLAG.EL.E THEN GOTO TRUE;

   6411  1 000546   200013 236100                    LDQ     COMP_FLAG,,AUTO
         1 000547   000001 316007                    CANQ    1,DL
         1 000550   000565 600000 1                  TZE     TRUE
         1 000551   000561 710000 1                  TRA     s:6417

      274     6412    2          CASE(3);                 /* C@GREATEQ (not less than) */

      275     6413    2             IF NOT FLAG.EL.L THEN GOTO TRUE;

   6413  1 000552   200013 236100                    LDQ     COMP_FLAG,,AUTO
         1 000553   000002 316007                    CANQ    2,DL
         1 000554   000565 600000 1                  TZE     TRUE
         1 000555   000561 710000 1                  TRA     s:6417

      276     6414    2          CASE(1);            /* C@GREATER (not less than or equal to) */

      277     6415    2             IF NOT FLAG.EL THEN GOTO TRUE;

   6415  1 000556   200013 236100                    LDQ     COMP_FLAG,,AUTO
         1 000557   000003 316007                    CANQ    3,DL
         1 000560   000565 600000 1                  TZE     TRUE

      278     6416    2          END;

      279     6417    1        NOGO_BIT = '1'B; /* "IF" was false, tell DDA$DO to bypass this attachment */

   6417  1 000561   400000 236003                    LDQ     -131072,DU
         1 000562   200003 471500                    LDP1    @NOGO_BIT,,AUTO
         1 000563   100000 756100                    STQ     0,,PR1

      280     6418    1        RETURN;

   6418  1 000564   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:40   
      281     6419    1   TRUE: NOGO_BIT = '0'B;        /* "IF" was true, tell DDA$DO to "DO" this one */

   6419  1 000565   200003 470500       TRUE         LDP0    @NOGO_BIT,,AUTO
         1 000566   000000 450100                    STZ     0,,PR0

      282     6420    1        RETURN;

   6420  1 000567   000000 702200 xent               TSX2  ! X66_ARET

      283     6421    1   ERR_RTN: ALTRETURN;                     /* Unable to perform comparison */

   6421  1 000570   000000 702200 xent  ERR_RTN      TSX2  ! X66_AALT

      284     6422    1   IF_TRAP:
      285     6423    1        S_D.ERROR = 233;             /* E@IF_TRAP  */

   6423  1 000571   000351 235007       IF_TRAP      LDA     233,DL
         1 000572   000000 470400 xsym               LDP0    S_D$
         1 000573   000013 755100                    STA     11,,PR0

      286     6424    1        CALL DDE$ERROR;

   6424  1 000574   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000575   000000 701000 xent               TSX1    DDE$ERROR
         1 000576   000000 011000                    NOP     0

      287     6425    1        S_D.ACCESS = '0'B;

   6425  1 000577   000000 470400 xsym               LDP0    S_D$
         1 000600   000016 450100                    STZ     14,,PR0

      288     6426    1        GOTO TRUE;

   6426  1 000601   000565 710000 1                  TRA     TRUE

      289     6427        %EJECT;
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:41   
      290     6428        /*D*  NAME:    GETVAL
      291     6429              DESCRIPTION: DO WHATEVER IT TAKES TO GET A VALUE OUT OF
      292     6430                  THE DATA DESCRIPTOR. ALTRETURN IF WE DON'T HANDLE THAT TYPE
      293     6431                  AND PASS THE BUCK IF THE DDK$GET ROUTINES COMPLAIN.
      294     6432                  */
      295     6433    1   GETVAL: PROC ALTRET;

   6433  1 000602   200114 741300       GETVAL       STX1  ! CSIZE+1,,AUTO

      296     6434    2        IF C_CLASS = 1            /* CHAR_CLASS */

   6434  1 000603   200012 235100                    LDA     C_CLASS,,AUTO
         1 000604   000001 115007                    CMPA    1,DL
         1 000605   000612 601000 1                  TNZ     s:6436

      297     6435    2        THEN V_CHAR = ' ';

   6435  1 000606   040100 100400                    MLR     fill='040'O
         1 000607   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000610   200014 000077                    ADSC9   V_CHAR,,AUTO             cn=0,n=63
         1 000611   000615 710000 1                  TRA     s:6437

      298     6436    2        ELSE V.BITS = '0'B;

   6436  1 000612   000000 235003                    LDA     0,DU
         1 000613   000000 236003                    LDQ     0,DU
         1 000614   200014 757100                    STAQ    V_CHAR,,AUTO

      299     6437    2        IF D_XDELTA

   6437  1 000615   000000 234000 xsym               SZN     D_XDELTA
         1 000616   000633 605000 1                  TPL     s:6447
         1 000617   200074 470500                    LDP0    ZITEM$,,AUTO
         1 000620   000001 236100                    LDQ     1,,PR0
         1 000621   100000 316003                    CANQ    32768,DU
         1 000622   000633 600000 1                  TZE     s:6447
         1 000623   000000 471400 xsym               LDP1    USE$
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:42   
         1 000624   100000 234100                    SZN     0,,PR1
         1 000625   000633 604000 1                  TMI     s:6447

      300     6438    2          AND ZITEM.FLAGS.MDSE.S
      301     6439    2          AND NOT U$SE.CUR
      302     6440    3        THEN DO;

      303     6441    3             S_D.ERROR = 38;   /* E@USE_CONFLICT */

   6441  1 000626   000046 235007                    LDA     38,DL
         1 000627   000000 473400 xsym               LDP3    S_D$
         1 000630   300013 755100                    STA     11,,PR3

      304     6442    3             ALTRETURN;

   6442  1 000631   200114 221300                    LDX1  ! CSIZE+1,,AUTO
         1 000632   000000 702211                    TSX2  ! 0,X1

      305     6443    3           END;
      306     6444                                                /**/
      307     6445        /*  Get value according to type  */
      308     6446                                                /**/
      309     6447    3        DO CASE(ZITEM.DTYP);

   6447  1 000633   200074 470500                    LDP0    ZITEM$,,AUTO
         1 000634   000001 220100                    LDX0    1,,PR0
         1 000635   000777 360003                    ANX0    511,DU
         1 000636   000004 100003                    CMPX0   4,DU
         1 000637   000641 602010 1                  TNC     s:6447+6,X0
         1 000640   001440 710000 1                  TRA     s:6560
         1 000641   000645 710000 1                  TRA     s:6450
         1 000642   001440 710000 1                  TRA     s:6560
         1 000643   001440 710000 1                  TRA     s:6560
         1 000644   001265 710000 1                  TRA     s:6534

      310     6448    3          CASE(%SIM_DTYP);

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:43   
      311     6449                                                /* Get address and other good stuff */
      312     6450    3             S_D.DESC$ = DESC$;

   6450  1 000645   200004 236100                    LDQ     DESC$,,AUTO
         1 000646   000000 471400 xsym               LDP1    S_D$
         1 000647   100041 756100                    STQ     33,,PR1

      313     6451    3             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   6451  1 000650   106714 235100                    LDA     3532,,PR1
         1 000651   000001 115007                    CMPA    1,DL
         1 000652   000702 601000 1                  TNZ     s:6458

      314     6452    4             THEN DO;

      315     6453    4                  CALL DDK$GETADDR(ITEM, SVALUE, SIZE, INDXX, POINTER,

   6453  1 000653   200072 633500                    EPPR3   ARRAY_FLAG,,AUTO
         1 000654   200126 453500                    STP3    CSIZE+11,,AUTO
         1 000655   200071 634500                    EPPR4   ADDR_TYPE,,AUTO
         1 000656   200125 454500                    STP4    CSIZE+10,,AUTO
         1 000657   200070 635500                    EPPR5   EXPR_OP,,AUTO
         1 000660   200124 455500                    STP5    CSIZE+9,,AUTO
         1 000661   200067 636500                    EPPR6   EXPR_VAL,,AUTO
         1 000662   200123 456500                    STP6    CSIZE+8,,AUTO
         1 000663   200066 637500                    EPPR7   POINTER,,AUTO
         1 000664   200122 457500                    STP7    CSIZE+7,,AUTO
         1 000665   200065 630500                    EPPR0   INDXX,,AUTO
         1 000666   200121 450500                    STP0    CSIZE+6,,AUTO
         1 000667   200063 630500                    EPPR0   SIZE,,AUTO
         1 000670   200120 450500                    STP0    CSIZE+5,,AUTO
         1 000671   200062 630500                    EPPR0   SVALUE,,AUTO
         1 000672   200117 450500                    STP0    CSIZE+4,,AUTO
         1 000673   200077 630500                    EPPR0   ITEM,,AUTO
         1 000674   200116 450500                    STP0    CSIZE+3,,AUTO
         1 000675   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 000676   000001 631400 2                  EPPR1   1
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:44   
         1 000677   000000 701000 xent               TSX1    DDK$GETADDR
         1 000700   001450 702000 1                  TSX2    VAL_ALTRET

      316     6454    4                    EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG )
      317     6455    4                    ALTRET(VAL_ALTRET);
      318     6456    4                END;

   6456  1 000701   000762 710000 1                  TRA     s:6467

      319     6457    4             ELSE DO;

      320     6458    4                  CALL DFK$EVAL_DISP(VALUE_L6, ADDRESS, SEG, DESC#,

   6458  1 000702   000002 236000 2                  LDQ     2
         1 000703   200125 756100                    STQ     CSIZE+10,,AUTO
         1 000704   200061 633500                    EPPR3   EXPR_OP_L6,,AUTO
         1 000705   200124 453500                    STP3    CSIZE+9,,AUTO
         1 000706   200063 634500                    EPPR4   SIZE,,AUTO
         1 000707   200123 454500                    STP4    CSIZE+8,,AUTO
         1 000710   200060 635500                    EPPR5   NOT_IS,,AUTO
         1 000711   200122 455500                    STP5    CSIZE+7,,AUTO
         1 000712   200057 636500                    EPPR6   DESC#,,AUTO
         1 000713   200121 456500                    STP6    CSIZE+6,,AUTO
         1 000714   200056 637500                    EPPR7   SEG,,AUTO
         1 000715   200120 457500                    STP7    CSIZE+5,,AUTO
         1 000716   200055 630500                    EPPR0   ADDRESS,,AUTO
         1 000717   200117 450500                    STP0    CSIZE+4,,AUTO
         1 000720   200034 630500                    EPPR0   VALUE_L6,,AUTO
         1 000721   200116 450500                    STP0    CSIZE+3,,AUTO
         1 000722   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 000723   000026 631400 xsym               EPPR1   B_VECTNIL+22
         1 000724   000000 701000 xent               TSX1    DFK$EVAL_DISP
         1 000725   001450 702000 1                  TSX2    VAL_ALTRET

      321     6459    4                    NOT_IS, SIZE, EXPR_OP_L6, '0'B) ALTRET(VAL_ALTRET);
      322     6460    4                  I = VALUE_L6.SIZE;

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:45   
   6460  1 000726   200034 235100                    LDA     VALUE_L6,,AUTO
         1 000727   200106 755100                    STA     I,,AUTO

      323     6461    5                  DO I = 0 TO VALUE_L6.SIZE - 1;

   6461  1 000730   200106 450100                    STZ     I,,AUTO
         1 000731   000757 710000 1                  TRA     s:6464+3

      324     6462    5                       VCU.C(I*2) = VALUE_L6.OPSB.UH(I);

   6462  1 000732   200106 236100                    LDQ     I,,AUTO
         1 000733   000044 402007                    MPY     36,DL
         1 000734   200116 756100                    STQ     CSIZE+3,,AUTO
         1 000735   200106 236100                    LDQ     I,,AUTO
         1 000736   000022 402007                    MPY     18,DL
         1 000737   200116 235100                    LDA     CSIZE+3,,AUTO
         1 000740   003106 060505                    CSL     bolr='003'O
         1 000741   200035 420010                    BDSC    VALUE_L6+1,A,AUTO        by=2,bit=2,n=8
         1 000742   200014 010010                    BDSC    V_CHAR,Q,AUTO            by=0,bit=1,n=8

      325     6463    5                       VCU.C((I*2)+1) = VALUE_L6.OPSB.LH(I);

   6463  1 000743   200106 236100                    LDQ     I,,AUTO
         1 000744   000044 402007                    MPY     36,DL
         1 000745   200116 756100                    STQ     CSIZE+3,,AUTO
         1 000746   200106 236100                    LDQ     I,,AUTO
         1 000747   000022 402007                    MPY     18,DL
         1 000750   200116 235100                    LDA     CSIZE+3,,AUTO
         1 000751   003106 060505                    CSL     bolr='003'O
         1 000752   200035 610010                    BDSC    VALUE_L6+1,A,AUTO        by=3,bit=1,n=8
         1 000753   200014 210010                    BDSC    V_CHAR,Q,AUTO            by=1,bit=1,n=8

      326     6464    5                     END;

   6464  1 000754   200106 235100                    LDA     I,,AUTO
         1 000755   000001 035007                    ADLA    1,DL
         1 000756   200106 755100                    STA     I,,AUTO
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:46   
         1 000757   200106 236100                    LDQ     I,,AUTO
         1 000760   200034 116100                    CMPQ    VALUE_L6,,AUTO
         1 000761   000732 602000 1                  TNC     s:6462

      327     6465    4                END;

      328     6466                                                /* TEST SIZE-TYPE MATCH */
      329     6467    4             DO CASE(S_D.DO$->ALL_ATTACH.CTYPE);

   6467  1 000762   000000 470400 xsym               LDP0    S_D$
         1 000763   000031 471500                    LDP1    25,,PR0
         1 000764   100001 236100                    LDQ     1,,PR1
         1 000765   000003 772000                    QRL     3
         1 000766   000037 376007                    ANQ     31,DL
         1 000767   000021 116007                    CMPQ    17,DL
         1 000770   000772 602006 1                  TNC     s:6467+8,QL
         1 000771   001043 710000 1                  TRA     s:6484
         1 000772   001043 710000 1                  TRA     s:6484
         1 000773   001025 710000 1                  TRA     s:6473
         1 000774   001025 710000 1                  TRA     s:6473
         1 000775   001025 710000 1                  TRA     s:6473
         1 000776   001017 710000 1                  TRA     s:6471
         1 000777   001043 710000 1                  TRA     s:6484
         1 001000   001043 710000 1                  TRA     s:6484
         1 001001   001013 710000 1                  TRA     s:6469
         1 001002   001043 710000 1                  TRA     s:6484
         1 001003   001043 710000 1                  TRA     s:6484
         1 001004   001043 710000 1                  TRA     s:6484
         1 001005   001043 710000 1                  TRA     s:6484
         1 001006   001043 710000 1                  TRA     s:6484
         1 001007   001043 710000 1                  TRA     s:6484
         1 001010   001043 710000 1                  TRA     s:6484
         1 001011   001043 710000 1                  TRA     s:6484
         1 001012   001036 710000 1                  TRA     s:6478

      330     6468    4               CASE(%PTR_FMT);

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:47   
      331     6469    4                  IF SIZE ~= 36 THEN GOTO MIS_MATCH;

   6469  1 001013   200063 235100                    LDA     SIZE,,AUTO
         1 001014   000044 115007                    CMPA    36,DL
         1 001015   001452 601000 1                  TNZ     MIS_MATCH
         1 001016   001043 710000 1                  TRA     s:6484

      332     6470    4               CASE(%CHAR_FMT);

      333     6471    4                  IF MOD(SIZE,9) ~= 0 THEN GOTO MIS_MATCH;

   6471  1 001017   200063 236100                    LDQ     SIZE,,AUTO
         1 001020   000011 506007                    DIV     9,DL
         1 001021   000044 733000                    LRS     36
         1 001022   000000 116003                    CMPQ    0,DU
         1 001023   001452 601000 1                  TNZ     MIS_MATCH
         1 001024   001043 710000 1                  TRA     s:6484

      334     6472    4               CASE(%SINT_FMT, %UINT_FMT, %OCT_FMT );

      335     6473    4                  IF V_FMT ~= %SINT_FMT AND V_FMT ~= %UINT_FMT

   6473  1 001025   200011 235100                    LDA     V_FMT,,AUTO
         1 001026   000003 115007                    CMPA    3,DL
         1 001027   001035 600000 1                  TZE     s:6473+8
         1 001030   000002 115007                    CMPA    2,DL
         1 001031   001035 600000 1                  TZE     s:6473+8
         1 001032   200063 235100                    LDA     SIZE,,AUTO
         1 001033   000044 115007                    CMPA    36,DL
         1 001034   001452 601000 1                  TNZ     MIS_MATCH
         1 001035   001043 710000 1                  TRA     s:6484

      336     6474    4                    AND SIZE ~= 36         /* V_FMT MUST BE SINT_FMT, UINT_FMT OR
      337     6475                                                 HAVE A SIZE OF 36 */
      338     6476    4                  THEN GOTO MIS_MATCH;
      339     6477    4               CASE(%FLOAT_FMT);

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:48   
      340     6478    4                  IF SIZE ~= 36

   6478  1 001036   200063 235100                    LDA     SIZE,,AUTO
         1 001037   000044 115007                    CMPA    36,DL
         1 001040   001043 600000 1                  TZE     s:6484
         1 001041   000110 115007                    CMPA    72,DL
         1 001042   001452 601000 1                  TNZ     MIS_MATCH

      341     6479    4                    AND SIZE ~= 72
      342     6480    4                  THEN GOTO MIS_MATCH;
      343     6481                            /* BIT_FMT AND OBIT_FMT ARE WILD CARDS FOR LION AND MINX */
      344     6482    4               END;                        /* CASE(S_D.DO$->ALL_ATTACH.CTYPE */

      345     6483                                                /* Get value */
      346     6484    3             IF V_FMT = %CHAR_FMT

   6484  1 001043   200011 235100                    LDA     V_FMT,,AUTO
         1 001044   000004 115007                    CMPA    4,DL
         1 001045   001115 601000 1                  TNZ     s:6493

      347     6485    4             THEN DO;

      348     6486    4                  IF SIZE > 63*9 THEN SIZE = 63*9; /* SIZE IS IN BITS */

   6486  1 001046   200063 236100                    LDQ     SIZE,,AUTO
         1 001047   001067 116007                    CMPQ    567,DL
         1 001050   001053 604400 1                  TMOZ    s:6487

   6486  1 001051   001067 235007                    LDA     567,DL
         1 001052   200063 755100                    STA     SIZE,,AUTO

      349     6487    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   6487  1 001053   006714 235100                    LDA     3532,,PR0
         1 001054   000001 115007                    CMPA    1,DL
         1 001055   001443 601000 1                  TNZ     s:6562

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:49   
      350     6488    4                  THEN CALL DDK$GETVAL(ADDR(V_CHAR), ITEM, SVALUE, SIZE, SIZE, INDXX,

   6488  1 001056   200014 631500                    EPPR1   V_CHAR,,AUTO
         1 001057   200116 451500                    STP1    CSIZE+3,,AUTO
         1 001060   000002 236000 2                  LDQ     2
         1 001061   200133 756100                    STQ     CSIZE+16,,AUTO
         1 001062   200072 633500                    EPPR3   ARRAY_FLAG,,AUTO
         1 001063   200132 453500                    STP3    CSIZE+15,,AUTO
         1 001064   200071 634500                    EPPR4   ADDR_TYPE,,AUTO
         1 001065   200131 454500                    STP4    CSIZE+14,,AUTO
         1 001066   200070 635500                    EPPR5   EXPR_OP,,AUTO
         1 001067   200130 455500                    STP5    CSIZE+13,,AUTO
         1 001070   200067 636500                    EPPR6   EXPR_VAL,,AUTO
         1 001071   200127 456500                    STP6    CSIZE+12,,AUTO
         1 001072   200066 637500                    EPPR7   POINTER,,AUTO
         1 001073   200126 457500                    STP7    CSIZE+11,,AUTO
         1 001074   200065 630500                    EPPR0   INDXX,,AUTO
         1 001075   200125 450500                    STP0    CSIZE+10,,AUTO
         1 001076   200063 630500                    EPPR0   SIZE,,AUTO
         1 001077   200124 450500                    STP0    CSIZE+9,,AUTO
         1 001100   200063 630500                    EPPR0   SIZE,,AUTO
         1 001101   200123 450500                    STP0    CSIZE+8,,AUTO
         1 001102   200062 630500                    EPPR0   SVALUE,,AUTO
         1 001103   200122 450500                    STP0    CSIZE+7,,AUTO
         1 001104   200077 630500                    EPPR0   ITEM,,AUTO
         1 001105   200121 450500                    STP0    CSIZE+6,,AUTO
         1 001106   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 001107   200120 450500                    STP0    CSIZE+5,,AUTO
         1 001110   200120 630500                    EPPR0   CSIZE+5,,AUTO
         1 001111   000003 631400 2                  EPPR1   3
         1 001112   000000 701000 xent               TSX1    DDK$GETVAL
         1 001113   001450 702000 1                  TSX2    VAL_ALTRET

      351     6489    4                         POINTER, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG, '0'B)
      352     6490    4                         ALTRET(VAL_ALTRET);
      353     6491    4                END;

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:50   
   6491  1 001114   001443 710000 1                  TRA     s:6562

      354     6492    4             ELSE DO;

      355     6493    4                  IF V_FMT = %BIT_FMT

   6493  1 001115   000005 115007                    CMPA    5,DL
         1 001116   001123 600000 1                  TZE     s:6496
         1 001117   000003 115007                    CMPA    3,DL
         1 001120   001123 600000 1                  TZE     s:6496
         1 001121   000031 115007                    CMPA    25,DL
         1 001122   001126 601000 1                  TNZ     s:6498

      356     6494    4                    OR V_FMT = %SINT_FMT
      357     6495    4                    OR V_FMT = %LOGFORT_FMT
      358     6496    4                  THEN RSIZE = SIZE;       /* Left justify */

   6496  1 001123   200063 236100                    LDQ     SIZE,,AUTO
         1 001124   200064 756100                    STQ     RSIZE,,AUTO
         1 001125   001136 710000 1                  TRA     s:6502

      359     6497    5                  ELSE DO;

      360     6498    5                       IF SIZE > 36

   6498  1 001126   200063 236100                    LDQ     SIZE,,AUTO
         1 001127   000044 116007                    CMPQ    36,DL
         1 001130   001134 604400 1                  TMOZ    s:6500

      361     6499    5                       THEN RSIZE = 72;

   6499  1 001131   000110 235007                    LDA     72,DL
         1 001132   200064 755100                    STA     RSIZE,,AUTO
         1 001133   001136 710000 1                  TRA     s:6502

      362     6500    5                       ELSE RSIZE = 36;

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:51   
   6500  1 001134   000044 235007                    LDA     36,DL
         1 001135   200064 755100                    STA     RSIZE,,AUTO

      363     6501    5                     END;

      364     6502    4                  IF EXPR_OP > 0

   6502  1 001136   200070 235100                    LDA     EXPR_OP,,AUTO
         1 001137   001143 600000 1                  TZE     s:6507

      365     6503    5                  THEN DO;

      366     6504    5                       SIZE = 36;          /* Force to word */

   6504  1 001140   000044 235007                    LDA     36,DL
         1 001141   200063 755100                    STA     SIZE,,AUTO

      367     6505    5                       RSIZE = 36;

   6505  1 001142   200064 755100                    STA     RSIZE,,AUTO

      368     6506    5                     END;

      369     6507    4                  EIS = 0;

   6507  1 001143   200102 450100                    STZ     EIS,,AUTO

      370     6508    4                  IF V_FMT = %PUP_FMT

   6508  1 001144   200011 235100                    LDA     V_FMT,,AUTO
         1 001145   000035 115007                    CMPA    29,DL
         1 001146   001203 601000 1                  TNZ     s:6523

      371     6509    5                  THEN DO;

      372     6510    5                       IF ZITEM.PUP.BITS.SIGNOVER

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:52   
   6510  1 001147   200074 471500                    LDP1    ZITEM$,,AUTO
         1 001150   100010 236100                    LDQ     8,,PR1
         1 001151   000001 316007                    CANQ    1,DL
         1 001152   001157 600000 1                  TZE     s:6515

      373     6511    6                       THEN DO;

      374     6512    6                            S_D.ERROR = 210; /* E@CANTIFOVER */

   6512  1 001153   000322 235007                    LDA     210,DL
         1 001154   000013 755100                    STA     11,,PR0

      375     6513    6                            ALTRETURN;

   6513  1 001155   200114 221300                    LDX1  ! CSIZE+1,,AUTO
         1 001156   000000 702211                    TSX2  ! 0,X1

      376     6514    6                          END;
      377     6515    5                       RSIZE = 63;

   6515  1 001157   000077 235007                    LDA     63,DL
         1 001160   200064 755100                    STA     RSIZE,,AUTO

      378     6516    5                       IF ZITEM.PUP.BITS.PUB = 1 /* Packed dec */

   6516  1 001161   100010 236100                    LDQ     8,,PR1
         1 001162   000060 376007                    ANQ     48,DL
         1 001163   000020 116007                    CMPQ    16,DL
         1 001164   001173 601000 1                  TNZ     s:6519

      379     6517    5                       THEN EIS = MVN(ZITEM.PUP.BITS.SIGNPOS);

   6517  1 001165   100010 236100                    LDQ     8,,PR1
         1 001166   000002 772000                    QRL     2
         1 001167   000003 376007                    ANQ     3,DL
         1 001170   000000 235006 0                  LDA     MVN,QL
         1 001171   200102 755100                    STA     EIS,,AUTO
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:53   
         1 001172   001203 710000 1                  TRA     s:6523

      380     6518    6                       ELSE DO;

      381     6519    6                            EIS = UMVN( ZITEM.PUP.BITS.SIGNPOS );

   6519  1 001173   100010 236100                    LDQ     8,,PR1
         1 001174   000002 772000                    QRL     2
         1 001175   000003 376007                    ANQ     3,DL
         1 001176   000003 235006 0                  LDA     UMVN,QL
         1 001177   200102 755100                    STA     EIS,,AUTO

      382     6520    6                            SIZE = SIZE / 9;

   6520  1 001200   200063 236100                    LDQ     SIZE,,AUTO
         1 001201   000011 506007                    DIV     9,DL
         1 001202   200063 756100                    STQ     SIZE,,AUTO

      383     6521    6                          END;

      384     6522    5                     END;

      385     6523    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

   6523  1 001203   006714 235100                    LDA     3532,,PR0
         1 001204   000001 115007                    CMPA    1,DL
         1 001205   001443 601000 1                  TNZ     s:6562

      386     6524    5                  THEN DO;

      387     6525    5                       CALL DDK$GETVAL(ADDR(V_CHAR), ITEM, SVALUE, SIZE, RSIZE,

   6525  1 001206   200014 631500                    EPPR1   V_CHAR,,AUTO
         1 001207   200116 451500                    STP1    CSIZE+3,,AUTO
         1 001210   200102 633500                    EPPR3   EIS,,AUTO
         1 001211   200133 453500                    STP3    CSIZE+16,,AUTO
         1 001212   000002 236000 2                  LDQ     2
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:54   
         1 001213   200132 756100                    STQ     CSIZE+15,,AUTO
         1 001214   200072 634500                    EPPR4   ARRAY_FLAG,,AUTO
         1 001215   200131 454500                    STP4    CSIZE+14,,AUTO
         1 001216   200071 635500                    EPPR5   ADDR_TYPE,,AUTO
         1 001217   200130 455500                    STP5    CSIZE+13,,AUTO
         1 001220   200070 636500                    EPPR6   EXPR_OP,,AUTO
         1 001221   200127 456500                    STP6    CSIZE+12,,AUTO
         1 001222   200067 637500                    EPPR7   EXPR_VAL,,AUTO
         1 001223   200126 457500                    STP7    CSIZE+11,,AUTO
         1 001224   200066 630500                    EPPR0   POINTER,,AUTO
         1 001225   200125 450500                    STP0    CSIZE+10,,AUTO
         1 001226   200065 630500                    EPPR0   INDXX,,AUTO
         1 001227   200124 450500                    STP0    CSIZE+9,,AUTO
         1 001230   200064 630500                    EPPR0   RSIZE,,AUTO
         1 001231   200123 450500                    STP0    CSIZE+8,,AUTO
         1 001232   200063 630500                    EPPR0   SIZE,,AUTO
         1 001233   200122 450500                    STP0    CSIZE+7,,AUTO
         1 001234   200062 630500                    EPPR0   SVALUE,,AUTO
         1 001235   200121 450500                    STP0    CSIZE+6,,AUTO
         1 001236   200077 630500                    EPPR0   ITEM,,AUTO
         1 001237   200120 450500                    STP0    CSIZE+5,,AUTO
         1 001240   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 001241   200117 450500                    STP0    CSIZE+4,,AUTO
         1 001242   200117 630500                    EPPR0   CSIZE+4,,AUTO
         1 001243   000004 631400 2                  EPPR1   4
         1 001244   000000 701000 xent               TSX1    DDK$GETVAL
         1 001245   001450 702000 1                  TSX2    VAL_ALTRET

      388     6526    5                         INDXX, POINTER, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      389     6527    5                         '0'B, EIS) ALTRET(VAL_ALTRET);
      390     6528    5                       IF V_FMT = %SINT_FMT

   6528  1 001246   200011 235100                    LDA     V_FMT,,AUTO
         1 001247   000003 115007                    CMPA    3,DL
         1 001250   001443 601000 1                  TNZ     s:6562
         1 001251   200063 236100                    LDQ     SIZE,,AUTO
         1 001252   000044 116007                    CMPQ    36,DL
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:55   
         1 001253   001443 605000 1                  TPL     s:6562

      391     6529    5                         AND SIZE < 36
      392     6530    5                       THEN CALL DDK$SEXTEND(V.VALUE.L, SIZE);

   6530  1 001254   200063 630500                    EPPR0   SIZE,,AUTO
         1 001255   200117 450500                    STP0    CSIZE+4,,AUTO
         1 001256   200014 631500                    EPPR1   V_CHAR,,AUTO
         1 001257   200116 451500                    STP1    CSIZE+3,,AUTO
         1 001260   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 001261   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001262   000000 701000 xent               TSX1    DDK$SEXTEND
         1 001263   000000 011000                    NOP     0

      393     6531    5                     END;

      394     6532    4                END;

   6532  1 001264   001443 710000 1                  TRA     s:6562

      395     6533    3          CASE(%SPEC_DTYP);

      396     6534    3             ITEM.VALUEB = ZITEM.VALUEB;

   6534  1 001265   000007 236100                    LDQ     7,,PR0
         1 001266   200100 756100                    STQ     ITEM+1,,AUTO

      397     6535    4             DO CASE(ITEM.SP.VS.ID);

   6535  1 001267   200100 236100                    LDQ     ITEM+1,,AUTO
         1 001270   000033 772000                    QRL     27
         1 001271   000012 136007                    SBLQ    10,DL
         1 001272   000046 116007                    CMPQ    38,DL
         1 001273   001275 602006 1                  TNC     s:6535+6,QL
         1 001274   001433 710000 1                  TRA     s:6556
         1 001275   001402 710000 1                  TRA     s:6551
         1 001276   001402 710000 1                  TRA     s:6551
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:56   
         1 001277   001402 710000 1                  TRA     s:6551
         1 001300   001433 710000 1                  TRA     s:6556
         1 001301   001433 710000 1                  TRA     s:6556
         1 001302   001433 710000 1                  TRA     s:6556
         1 001303   001343 710000 1                  TRA     s:6537
         1 001304   001353 710000 1                  TRA     s:6541
         1 001305   001433 710000 1                  TRA     s:6556
         1 001306   001433 710000 1                  TRA     s:6556
         1 001307   001433 710000 1                  TRA     s:6556
         1 001310   001433 710000 1                  TRA     s:6556
         1 001311   001433 710000 1                  TRA     s:6556
         1 001312   001433 710000 1                  TRA     s:6556
         1 001313   001433 710000 1                  TRA     s:6556
         1 001314   001363 710000 1                  TRA     s:6545
         1 001315   001433 710000 1                  TRA     s:6556
         1 001316   001433 710000 1                  TRA     s:6556
         1 001317   001433 710000 1                  TRA     s:6556
         1 001320   001433 710000 1                  TRA     s:6556
         1 001321   001433 710000 1                  TRA     s:6556
         1 001322   001433 710000 1                  TRA     s:6556
         1 001323   001433 710000 1                  TRA     s:6556
         1 001324   001433 710000 1                  TRA     s:6556
         1 001325   001433 710000 1                  TRA     s:6556
         1 001326   001433 710000 1                  TRA     s:6556
         1 001327   001433 710000 1                  TRA     s:6556
         1 001330   001433 710000 1                  TRA     s:6556
         1 001331   001433 710000 1                  TRA     s:6556
         1 001332   001433 710000 1                  TRA     s:6556
         1 001333   001433 710000 1                  TRA     s:6556
         1 001334   001433 710000 1                  TRA     s:6556
         1 001335   001433 710000 1                  TRA     s:6556
         1 001336   001402 710000 1                  TRA     s:6551
         1 001337   001402 710000 1                  TRA     s:6551
         1 001340   001402 710000 1                  TRA     s:6551
         1 001341   001402 710000 1                  TRA     s:6551
         1 001342   001402 710000 1                  TRA     s:6551

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:57   
      398     6536    4               CASE( %A_RTN );

      399     6537    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %HOST

   6537  1 001343   000000 471400 xsym               LDP1    S_D$
         1 001344   106714 235100                    LDA     3532,,PR1
         1 001345   000001 115007                    CMPA    1,DL
         1 001346   001456 601000 1                  TNZ     NOTHOST

      400     6538    4                  THEN GOTO NOTHOST;
      401     6539    4                  V.VALUE.L = S_D.UREG$ -> REG$VALUES.A;

   6539  1 001347   100045 473500                    LDP3    37,,PR1
         1 001350   300004 235100                    LDA     4,,PR3
         1 001351   200014 755100                    STA     V_CHAR,,AUTO
         1 001352   001443 710000 1                  TRA     s:6562

      402     6540    4               CASE( %Q_RTN );

      403     6541    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %HOST

   6541  1 001353   000000 471400 xsym               LDP1    S_D$
         1 001354   106714 235100                    LDA     3532,,PR1
         1 001355   000001 115007                    CMPA    1,DL
         1 001356   001456 601000 1                  TNZ     NOTHOST

      404     6542    4                  THEN GOTO NOTHOST;
      405     6543    4                  V.VALUE.L = S_D.UREG$ -> REG$VALUES.Q;

   6543  1 001357   100045 473500                    LDP3    37,,PR1
         1 001360   300005 235100                    LDA     5,,PR3
         1 001361   200014 755100                    STA     V_CHAR,,AUTO
         1 001362   001443 710000 1                  TRA     s:6562

      406     6544    4               CASE( %X_RTN );

      407     6545    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %HOST
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:58   

   6545  1 001363   000000 471400 xsym               LDP1    S_D$
         1 001364   106714 235100                    LDA     3532,,PR1
         1 001365   000001 115007                    CMPA    1,DL
         1 001366   001456 601000 1                  TNZ     NOTHOST

      408     6546    4                  THEN GOTO NOTHOST;
      409     6547    4                  V.VALUE.L = S_D.UREG$ -> REG$VALUES.X(ITEM.SP.VS.SZ);

   6547  1 001367   100045 473500                    LDP3    37,,PR1
         1 001370   200100 236100                    LDQ     ITEM+1,,AUTO
         1 001371   000022 772000                    QRL     18
         1 001372   000777 376007                    ANQ     511,DL
         1 001373   000001 736000                    QLS     1
         1 001374   000100 101506                    MRL     fill='000'O
         1 001375   300000 000002                    ADSC9   0,Q,PR3                  cn=0,n=2
         1 001376   200014 000004                    ADSC9   V_CHAR,,AUTO             cn=0,n=4

      410     6548    4                  SIZE = 36;

   6548  1 001377   000044 236007                    LDQ     36,DL
         1 001400   200063 756100                    STQ     SIZE,,AUTO
         1 001401   001443 710000 1                  TRA     s:6562

      411     6549    4               CASE(%CI_RTN, %T_RTN, %S_RTN, %IV_RTN, %Z_RTN,

      412     6550    4                    %ASV_RTN, %R_RTN, %M_RTN);
      413     6551    4                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN ~= %L6

   6551  1 001402   000000 471400 xsym               LDP1    S_D$
         1 001403   106714 235100                    LDA     3532,,PR1
         1 001404   000002 115007                    CMPA    2,DL
         1 001405   001462 601000 1                  TNZ     NOTL6

      414     6552    4                  THEN GOTO NOTL6;
      415     6553    4                  CALL DFK$EVAL_DISP(VALUE_L6, ADDRESS, SEG, DESC#,

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:59   
   6553  1 001406   000002 236000 2                  LDQ     2
         1 001407   200125 756100                    STQ     CSIZE+10,,AUTO
         1 001410   200061 633500                    EPPR3   EXPR_OP_L6,,AUTO
         1 001411   200124 453500                    STP3    CSIZE+9,,AUTO
         1 001412   200063 634500                    EPPR4   SIZE,,AUTO
         1 001413   200123 454500                    STP4    CSIZE+8,,AUTO
         1 001414   200060 635500                    EPPR5   NOT_IS,,AUTO
         1 001415   200122 455500                    STP5    CSIZE+7,,AUTO
         1 001416   200057 636500                    EPPR6   DESC#,,AUTO
         1 001417   200121 456500                    STP6    CSIZE+6,,AUTO
         1 001420   200056 637500                    EPPR7   SEG,,AUTO
         1 001421   200120 457500                    STP7    CSIZE+5,,AUTO
         1 001422   200055 630500                    EPPR0   ADDRESS,,AUTO
         1 001423   200117 450500                    STP0    CSIZE+4,,AUTO
         1 001424   200034 630500                    EPPR0   VALUE_L6,,AUTO
         1 001425   200116 450500                    STP0    CSIZE+3,,AUTO
         1 001426   200116 630500                    EPPR0   CSIZE+3,,AUTO
         1 001427   000026 631400 xsym               EPPR1   B_VECTNIL+22
         1 001430   000000 701000 xent               TSX1    DFK$EVAL_DISP
         1 001431   001450 702000 1                  TSX2    VAL_ALTRET
         1 001432   001443 710000 1                  TRA     s:6562

      416     6554    4                    NOT_IS, SIZE, EXPR_OP_L6, '0'B) ALTRET(VAL_ALTRET);
      417     6555    4               CASE(ELSE);

      418     6556    4                  S_D.ERROR = 4; /* E@INVLD_SPEC - Invalid use of special symbol */

   6556  1 001433   000004 235007                    LDA     4,DL
         1 001434   000000 471400 xsym               LDP1    S_D$
         1 001435   100013 755100                    STA     11,,PR1

      419     6557    4                  ALTRETURN;

   6557  1 001436   200114 221300                    LDX1  ! CSIZE+1,,AUTO
         1 001437   000000 702211                    TSX2  ! 0,X1

      420     6558    4               END;                        /* DO CASE(ITEM.SP.VS.ID) */
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:60   

      421     6559    3          CASE(ELSE);

      422     6560    3             S_D.ERROR = 503;         /* E@NOTIMP */

   6560  1 001440   000767 235007                    LDA     503,DL
         1 001441   000000 471400 xsym               LDP1    S_D$
         1 001442   100013 755100                    STA     11,,PR1

      423     6561    3          END;                             /* CASE(ZITEM.DTYP */

      424     6562    2        S_D.D$ = S_D.DESC$;                /* POINT TO NEXT DESCRIPTOR */

   6562  1 001443   000000 470400 xsym               LDP0    S_D$
         1 001444   000041 236100                    LDQ     33,,PR0
         1 001445   000044 756100                    STQ     36,,PR0

      425     6563    2        RETURN;                            /*With the variable's value in V_CHAR*/

   6563  1 001446   200114 221300                    LDX1  ! CSIZE+1,,AUTO
         1 001447   000001 702211                    TSX2  ! 1,X1

      426     6564    2   VAL_ALTRET: ALTRETURN;        /* Error occured in one of the get routines */

   6564  1 001450   200114 221300       VAL_ALTRET   LDX1  ! CSIZE+1,,AUTO
         1 001451   000000 702211                    TSX2  ! 0,X1

      427     6565    2   MIS_MATCH: S_D.ERROR = 90;     /* E@SIZE_TYPE */

   6565  1 001452   000132 235007       MIS_MATCH    LDA     90,DL
         1 001453   000013 755100                    STA     11,,PR0

      428     6566    2        ALTRETURN;

   6566  1 001454   200114 221300                    LDX1  ! CSIZE+1,,AUTO
         1 001455   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:61   
      429     6567    2   NOTHOST:
      430     6568    2        S_D.ERROR = 308;           /* E@SYMNOTFEP */

   6568  1 001456   000464 235007       NOTHOST      LDA     308,DL
         1 001457   100013 755100                    STA     11,,PR1

      431     6569    2        ALTRETURN;

   6569  1 001460   200114 221300                    LDX1  ! CSIZE+1,,AUTO
         1 001461   000000 702211                    TSX2  ! 0,X1

      432     6570    2   NOTL6:
      433     6571    2        S_D.ERROR = 304;          /* SYMNOTHOST */

   6571  1 001462   000460 235007       NOTL6        LDA     304,DL
         1 001463   100013 755100                    STA     11,,PR1

      434     6572    2        ALTRETURN;

   6572  1 001464   200114 221300                    LDX1  ! CSIZE+1,,AUTO
         1 001465   000000 702211                    TSX2  ! 0,X1

MVN
 Sect OctLoc
   0     000   000000 000004   000000 000005   000000 000006                    ............

UMVN
 Sect OctLoc
   0     003   000000 000017   000000 000020   000000 000021                    ............

(unnamed)
 Sect OctLoc
   2     000   060040 040040   000011 000000   000002 006000   000014 000000    0   ............
   2     004   000015 000000                                                    ....
      435     6573    2   END GETVAL;
      436     6574    1   END DDA$IF;

PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:62   
--  Include file information  --

   DD_EIS_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDA$IF.

   Procedure DDA$IF requires 822 words for executable code.
   Procedure DDA$IF requires 92 words of local(AUTO) storage.

    No errors detected in file DDA$IF.:E05TSI    .
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:63   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:64   
          MINI XREF LISTING

ADDRESS
        81**DCL      6458<>CALL     6553<>CALL
ADDR_TYPE
        94**DCL      6453<>CALL     6488<>CALL     6525<>CALL
ALL_ATTACH.COND
      6162**DCL      6275>>IF       6401>>ASSIGN
ALL_ATTACH.CTYPE
      6161**DCL      6297>>ASSIGN   6467>>DOCASE
ALL_ATTACH.UNUSED
      6154**DCL      6155--REDEF    6159--REDEF
ARRAY_FLAG
        95**DCL      6453<>CALL     6488<>CALL     6525<>CALL
COMP_FLAG
        56**DCL        57--REDEF    6324<<ASSIGN   6327<<ASSIGN   6328<<ASSIGN   6330<<ASSIGN   6331<<ASSIGN
      6333<<ASSIGN   6334<<ASSIGN   6338<>CALL     6339<>CALL     6357<<ASSIGN   6358<<ASSIGN   6360<<ASSIGN
      6385<>CALL     6386>>IF       6389<<ASSIGN   6391<<ASSIGN
CSIZE
      6148**DCL      6345<<ASSIGN   6348<<ASSIGN   6354>>CALLBLT  6366<<ASSIGN   6379<<ASSIGN   6385<>CALL
CTRUNC
      6146**DCL      6344<<ASSIGN   6351<<ASSIGN   6356>>IF       6364<<ASSIGN   6382<<ASSIGN   6388>>IF
C_CLASS
        50**DCL      6300<<ASSIGN   6302<<ASSIGN   6304<<ASSIGN   6306<<ASSIGN   6308<<ASSIGN   6325>>DOCASE
      6434>>IF
DDE$ERROR
      6271**DCL-ENT  6311--CALL     6424--CALL
DDK$CDFLT
      6269**DCL-ENT  6339--CALL
DDK$CFLT
      6268**DCL-ENT  6338--CALL
DDK$CMPDEC
      6270**DCL-ENT  6385--CALL
DDK$GETADDR
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:65   
      6263**DCL-ENT  6453--CALL
DDK$GETVAL
      6266**DCL-ENT  6488--CALL     6525--CALL
DDK$SEXTEND
      6267**DCL-ENT  6530--CALL
DESC#
        83**DCL      6458<>CALL     6553<>CALL
DESC$
        44**DCL      6279<<ASSIGN   6289<<ASSIGN   6450>>ASSIGN
DFK$EVAL_DISP
      6272**DCL-ENT  6458--CALL     6553--CALL
DFLOAT
      6142**DCL      6336<<ASSIGN   6338<>CALL     6339<>CALL
D_XDELTA
      6261**DCL      6437>>IF
EIS
      6141**DCL      6507<<ASSIGN   6517<<ASSIGN   6519<<ASSIGN   6525<>CALL
ERR_RTN
      6421**LABEL    6312--GOTO     6315--CALLALT
EXPR_OP
        93**DCL      6453<>CALL     6488<>CALL     6502>>IF       6525<>CALL
EXPR_OP_L6
        85**DCL      6458<>CALL     6553<>CALL
EXPR_VAL
        92**DCL      6453<>CALL     6488<>CALL     6525<>CALL
FLAG.EL
        59**DCL      6409>>IF       6415>>IF
FLAG.EL.E
        61**DCL      6405>>IF       6411>>IF
FLAG.EL.L
        60**DCL      6407>>IF       6413>>IF
GETVAL
      6433**PROC     6315--CALL
I
      6143**DCL      6349<<DOINDEX  6350>>IF       6372<<DOINDEX  6373>>IF       6380<<DOINDEX  6381>>IF
      6460<<ASSIGN   6461<<DOINDEX  6462>>ASSIGN   6462>>ASSIGN   6463>>ASSIGN   6463>>ASSIGN
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:66   
IF$
        45**DCL      6277<<ASSIGN   6287<<ASSIGN   6327>>IF       6328>>IF       6330>>IF       6331>>IF
      6333>>IF       6334>>IF       6336>>ASSIGN   6343>>ASSIGN   6350>>IF       6354>>CALLBLT  6368>>ASSIGN
      6381>>IF       6385>>CALL
IF$CONST
      6173**DCL      6278--ASSIGN
IF$CONST.BITS.TRING
      6189**DCL      6330>>IF       6331>>IF       6336>>ASSIGN
IF$CONST.CONS.TANT
      6184**DCL      6185--REDEF    6333>>IF       6334>>IF
IF$CONST.EXP
      6175**DCL      6343>>ASSIGN   6368>>ASSIGN
IF$CONST.P.ADR
      6193**DCL      6197--REDEF
IF$CONST.SIZE
      6174**DCL      6175--REDEF
IF$CONST.TEXT
      6176**DCL      6177--REDEF    6178--REDEF    6182--REDEF    6187--REDEF    6191--REDEF    6204--REDEF
      6327>>IF       6328>>IF       6354>>CALLBLT
IF$CONST.TEXTA
      6177**DCL      6350>>IF       6381>>IF       6385<>CALL
IF$CONST.TEXTA8.BYT
      6180**DCL      6181--REDEF
IFCONTINUE
      6290**LABEL    6282--GOTO
IF_TRAP
      6423**LABEL    6322--REMEMBR
INDXX
        90**DCL      6453<>CALL     6488<>CALL     6525<>CALL
ITEM
      5962**DCL      6453<>CALL     6488<>CALL     6525<>CALL
ITEM.ADDRESS
      5983**DCL      5988--REDEF    5989--REDEF    5990--REDEF
ITEM.SP.VD
      5991**DCL      5995--REDEF    5998--REDEF
ITEM.SP.VS.ID
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:67   
      5999**DCL      6535>>DOCASE
ITEM.SP.VS.SZ
      6000**DCL      6547>>ASSIGN
ITEM.VALUEB
      5989**DCL      6534<<ASSIGN
MIS_MATCH IN PROCEDURE GETVAL
      6565**LABEL    6469--GOTO     6471--GOTO     6476--GOTO     6480--GOTO
MVN
      6139**DCL      6517>>ASSIGN
NOGO_BIT
        43**DCL        41--PROC     6284--ENTRY    6417<<ASSIGN   6419<<ASSIGN
NOTHOST IN PROCEDURE GETVAL
      6568**LABEL    6538--GOTO     6542--GOTO     6546--GOTO
NOTL6 IN PROCEDURE GETVAL
      6571**LABEL    6552--GOTO
NOT_IS
        84**DCL      6458<>CALL     6553<>CALL
POINTER
        91**DCL      6453<>CALL     6488<>CALL     6525<>CALL
REG$VALUES.A
      6213**DCL      6214--REDEF    6539>>ASSIGN
REG$VALUES.Q
      6217**DCL      6218--REDEF    6543>>ASSIGN
REG$VALUES.X
      6212**DCL      6547>>ASSIGN
RSIZE
        89**DCL      6496<<ASSIGN   6499<<ASSIGN   6500<<ASSIGN   6505<<ASSIGN   6515<<ASSIGN   6525<>CALL
SEG
        82**DCL      6458<>CALL     6553<>CALL
SIZE
        88**DCL      6337>>IF       6453<>CALL     6458<>CALL     6469>>IF       6471>>IF       6473>>IF
      6478>>IF       6478>>IF       6486>>IF       6486<<ASSIGN   6488<>CALL     6488<>CALL     6496>>ASSIGN
      6498>>IF       6504<<ASSIGN   6520<<ASSIGN   6520>>ASSIGN   6525<>CALL     6528>>IF       6530<>CALL
      6548<<ASSIGN   6553<>CALL
SVALUE
        87**DCL      6354<<CALLBLT  6355>>IF       6359>>IF       6453<>CALL     6488<>CALL     6525<>CALL
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:68   
S_D.ACCESS
      3333**DCL      6321<<ASSIGN   6398<<ASSIGN   6425<<ASSIGN
S_D.CURRENT_CHANNEL
      4246**DCL      4248--REDEF
S_D.D$
      3384**DCL      6277>>ASSIGN   6278<<ASSIGN   6278>>ASSIGN   6279>>ASSIGN   6280>>ASSIGN   6562<<ASSIGN
S_D.DEBUGA
      3398**DCL      3400--REDEF
S_D.DESC$
      3378**DCL      6450<<ASSIGN   6562>>ASSIGN
S_D.DO$
      3349**DCL      6275>>IF       6286>>ASSIGN   6287>>ASSIGN   6288>>ASSIGN   6297>>ASSIGN   6401>>ASSIGN
      6467>>DOCASE
S_D.EIS
      4356**DCL      4385--REDEF
S_D.ERROR
      3327**DCL      6310<<ASSIGN   6423<<ASSIGN   6441<<ASSIGN   6512<<ASSIGN   6556<<ASSIGN   6560<<ASSIGN
      6565<<ASSIGN   6568<<ASSIGN   6571<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      4289**DCL      4290--REDEF    4304--REDEF
S_D.JDE
      3903**DCL      3904--REDEF
S_D.L$.VALUE
      3456**DCL      3462--REDEF    3470--REDEF    3473--REDEF    3476--REDEF    3479--REDEF
S_D.L$.VALUE.L
      3457**DCL      3458--REDEF    3459--REDEF
S_D.L6_MESSAGE_BUF
      4310**DCL      4312--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      4321**DCL      6451>>IF       6487>>IF       6523>>IF       6537>>IF       6541>>IF       6545>>IF
      6551>>IF
S_D.OUTPUT
      4276**DCL      4278--REDEF
S_D.REMOTE_MSG.FNCC
      4295**DCL      4296--REDEF
S_D.REMOTE_MSG.STXC
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:69   
      4291**DCL      4292--REDEF
S_D.REMOTE_MSG.SUBFNCC
      4299**DCL      4300--REDEF
S_D.REM_ACCESS
      3341**DCL      6322<<REMEMBR
S_D.SV
      3355**DCL      3376--REDEF
S_D.UREG$
      3386**DCL      6539>>ASSIGN   6543>>ASSIGN   6547>>ASSIGN
S_D$
      4607**DCL      3303--IMP-PTR  6275>>IF       6277>>ASSIGN   6278>>ASSIGN   6278>>ASSIGN   6279>>ASSIGN
      6280>>ASSIGN   6286>>ASSIGN   6287>>ASSIGN   6288>>ASSIGN   6297>>ASSIGN   6310>>ASSIGN   6321>>ASSIGN
      6322>>REMEMBR  6398>>ASSIGN   6401>>ASSIGN   6423>>ASSIGN   6425>>ASSIGN   6441>>ASSIGN   6450>>ASSIGN
      6451>>IF       6467>>DOCASE   6487>>IF       6512>>ASSIGN   6523>>IF       6537>>IF       6539>>ASSIGN
      6541>>IF       6543>>ASSIGN   6545>>IF       6547>>ASSIGN   6551>>IF       6556>>ASSIGN   6560>>ASSIGN
      6562>>ASSIGN   6562>>ASSIGN   6565>>ASSIGN   6568>>ASSIGN   6571>>ASSIGN
TEMP
        48**DCL      6296<<ASSIGN   6297<<ASSIGN   6298>>DOCASE   6400<<ASSIGN   6401<<ASSIGN   6402>>DOCASE
TRUE
      6419**LABEL    6276--GOTO     6405--GOTO     6407--GOTO     6409--GOTO     6411--GOTO     6413--GOTO
      6415--GOTO     6426--GOTO
TSCALE
      6144**DCL      6343<<ASSIGN   6346>>IF       6348>>ASSIGN   6349>>DOINDEX  6368<<ASSIGN   6369>>IF
      6371>>ASSIGN   6372>>DOINDEX  6377>>IF       6379>>ASSIGN   6380>>DOINDEX  6386>>IF
U$SE.CUR
      6166**DCL      6437>>IF
UMVN
      6140**DCL      6519>>ASSIGN
USE$
      6262**DCL      6165--IMP-PTR  6437>>IF
V.BITS
        72**DCL      6330>>IF       6331>>IF       6436<<ASSIGN
V.VALUE
        69**DCL        72--REDEF    6338<>CALL     6339<>CALL
V.VALUE.L
        70**DCL      6333>>IF       6334>>IF       6355>>IF       6359>>IF       6530<>CALL     6539<<ASSIGN
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:70   
      6543<<ASSIGN   6547<<ASSIGN
VALUE_L6
        74**DCL      6458<>CALL     6553<>CALL
VALUE_L6.OPS
        76**DCL        77--REDEF
VALUE_L6.OPSB.LH
        80**DCL      6463>>ASSIGN
VALUE_L6.OPSB.UH
        79**DCL      6462>>ASSIGN
VALUE_L6.SIZE
        75**DCL      6460>>ASSIGN   6461>>DOINDEX
VAL_ALTRET IN PROCEDURE GETVAL
      6564**LABEL    6453--CALLALT  6458--CALLALT  6488--CALLALT  6525--CALLALT  6553--CALLALT
VC
        64**DCL      6373>>IF       6385<>CALL
VCU.C
        67**DCL      6462<<ASSIGN   6463<<ASSIGN
VSIZE
      6147**DCL      6367<<ASSIGN   6371<<ASSIGN   6385<>CALL
VTRUNC
      6145**DCL      6365<<ASSIGN   6374<<ASSIGN   6390>>IF
V_CHAR
        63**DCL        64--REDEF      65--REDEF      68--REDEF    6327>>IF       6328>>IF       6435<<ASSIGN
      6488--CALL     6525--CALL
V_FMT
        49**DCL      6293<<ASSIGN   6341>>IF       6473>>IF       6473>>IF       6484>>IF       6493>>IF
      6493>>IF       6493>>IF       6508>>IF       6528>>IF
WHEN
        47**DCL      6281<<ASSIGN   6290<<ASSIGN   6295>>IF       6399>>IF
WHEN$
        46**DCL      6224--IMP-PTR  6286<<ASSIGN   6287>>ASSIGN   6296>>ASSIGN   6400>>ASSIGN
WHEN$CMD
      6224**DCL      6288--ASSIGN
WHEN$CMD.U.APT
      6230**DCL      6231--REDEF
WHEN$CMD.U.CONST_OFFSET
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:71   
      6231**DCL      6287>>ASSIGN
WHEN$CMD.UNUSED
      6228**DCL      6229--REDEF
WHEN$CMD.WCOND
      6250**DCL      6400>>ASSIGN
WHEN$CMD.WCTYPE
      6249**DCL      6296>>ASSIGN
ZITEM.ADDRESS
      6076**DCL      6081--REDEF    6082--REDEF    6083--REDEF
ZITEM.DTYP
      6058**DCL      6447>>DOCASE
ZITEM.FLAGS.MDSE.S
      6051**DCL      6437>>IF
ZITEM.FMT_SPEC
      6072**DCL      6293>>ASSIGN
ZITEM.PUP.BITS.PUB
      6101**DCL      6516>>IF
ZITEM.PUP.BITS.SIGNOVER
      6104**DCL      6510>>IF
ZITEM.PUP.BITS.SIGNPOS
      6102**DCL      6517>>ASSIGN   6519>>ASSIGN
ZITEM.PUP.SCALE
      6099**DCL      6368>>ASSIGN
ZITEM.SP.VD
      6084**DCL      6088--REDEF    6091--REDEF
ZITEM.VALUEB
      6082**DCL      6534>>ASSIGN
ZITEM$
      5385**DCL      6042--IMP-PTR  6280<<ASSIGN   6288<<ASSIGN   6289>>ASSIGN   6293>>ASSIGN   6368>>ASSIGN
      6437>>IF       6447>>DOCASE   6510>>IF       6516>>IF       6517>>ASSIGN   6519>>ASSIGN   6534>>ASSIGN
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:72   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDA$IF File=DDA$IF.:E05TSI                                    TUE 07/29/97 13:29 Page:73   
              MINI UREF LISTING

DDA$IF      41**PROC
DDA$IF_WHEN    6284**ENTRY
DDK$GETMVAL    6264**DCL-ENT
DDK$GETSPEC    6265**DCL-ENT
SDD$    5384**DCL
SDD_L6$    5386**DCL
ZITEM_L6$    5387**DCL
