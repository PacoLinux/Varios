VERSION E05

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:1    
        1        1        /*M* VPH$LISTREV  This module contains routines for the LIST,LISTSTD,
        2        2                          REVIEW, and REVIEWSTD commands.
        3        3        */
        4        4        /*T***********************************************************/
        5        5        /*T*                                                         */
        6        6        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        7        7        /*T*                                                         */
        8        8        /*T***********************************************************/
        9        9        /*X* DTI=1,THI=1 */
       10       10        /* Next available error code = 5 */
       11       11        VPH$LIST: PROC;
       12       12        /*D* NAME: VPH$LIST
       13       13             CALL: CALL VPH$LIST;
       14       14             DESCRIPTION: This procedure drives the LIST command.
       15       15        */
       16       16        %INCLUDE VP_DATA_R;
       17     7003        %INCLUDE F$DCB;
       18     7052        %INCLUDE FM$FIT;
       19     7273        %CODE03;
       20     7280        %B$TCB;
       21     7283        %B$ALT;
       22     7291        %INCLUDE B_ERRORS_C;
       23     8418 S      %INCLUDE B$JIT_C;
       24     8419        %B$JIT0;
       25     8508        %U$JIT1;
       26     8582    1         2 * BIT(1);                       /* Don't need rest of JIT             */
       27     8583        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
       28     8628        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
       29     8666    1   DCL LIS_MSG CHAR(0) CONSTANT INIT('..LISTing');
       30     8667    1   DCL 1 TEXT$C BASED,
       31     8668    1         2 LEN UBIN BYTE UNAL,
       32     8669    1         2 STRING CHAR(TEXT$C.LEN);
       33     8670    1   DCL IDX SBIN WORD;
       34     8671    1   DCL IDX2 SBIN WORD;
       35     8672    1   DCL LIST_HDR_OUT BIT(9);
       36     8673    1   DCL NEXT_SPEC_RET_VAL SBIN WORD;
       37     8674    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:2    
       38     8675    1   DCL I SBIN WORD;
       39     8676    1   DCL 1 EXTEND STATIC,
       40     8677    1         2 LEN UBIN BYTE UNAL,
       41     8678    1         2 * CHAR(1) INIT('@');
       42     8679    1   DCL CR_LF CHAR(1) STATIC INIT('A');     /* VFC to start a new line            */
       43     8680    1   DCL DEFAULT_LIST_CODE SBIN WORD;
       44     8681    1   DCL DEFAULT_LIST_COLS SBIN WORD;
       45     8682    1   DCL PTR$ PTR;
       46     8683    1   DCL OUT$ PTR;
       47     8684    1   DCL OUTSPEC$ PTR;
       48     8685    1   DCL SOURCELIST$ PTR;
       49     8686    1   DCL CLIST_CODE SBIN WORD;
       50     8687    1   DCL LIST_CODE SBIN WORD;
       51     8688    1   DCL 1 BUF_BLOCK BASED(LIST_BUF$) ALIGNED,
       52     8689    1         2 COUNT SBIN WORD,
       53     8690    1         2 BUF_1,
       54     8691    1           3 LEN UBIN BYTE UNAL,
       55     8692    1           3 STRING(0:0) CHAR(4);
       56     8693    1   DCL CUR_GRANS SBIN WORD;
       57     8694    1   DCL LIST_WKSZ SBIN WORD;
       58     8695    1   DCL LIST_WORK$ PTR;
       59     8696    1   DCL REV_RET_VAL SBIN WORD;
       60     8697    1   DCL SUM_IDX SBIN;
       61     8698    1   DCL SUM_LINE_TEXT CHAR(132);
       62     8699    1   DCL 1 SUM_LINE REDEF SUM_LINE_TEXT,
       63     8700    1         2 * CHAR(2),
       64     8701    1         2 FILES CHAR(5),
       65     8702    1         2 REST CHAR(125),
       66     8703    1         2 GRANS REDEF REST,
       67     8704    1           3 * CHAR(7),
       68     8705    1           3 GRANS CHAR(6),
       69     8706    1           3 * CHAR(10),
       70     8707    1           3 RECS CHAR(8),
       71     8708    1           3 * CHAR(94);
       72     8709    1   DCL 1 DEL_TEXT CHAR(36) BASED;
       73     8710    1   DCL 1 DEL REDEF DEL_TEXT,
       74     8711    1         2 * CHAR(1),
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:3    
       75     8712    1         2 FILES CHAR(5),
       76     8713    1         2 * CHAR(7),
       77     8714    1         2 GRANS CHAR(6),
       78     8715    1         2 * CHAR(17);
       79     8716    1   DCL TEMP SBIN WORD;
       80     8717    1   DCL CHAR$1 CHAR(1) BASED;
       81     8718    1   DCL CHAR$72 CHAR(72) BASED;
       82     8719    1   DCL CHAR$132 CHAR(132) BASED;
       83     8720        /**/
       84     8721        /*  ENTRY POINTS  */
       85     8722        /**/
       86     8723    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       87     8724    1   DCL X$PARSE ENTRY(1) ALTRET;
       88     8725        %VP_ENTRIES (OMIT=VPH$LIST);
       89     8933    1   VPH$LISTSTD: ENTRY;
       90     8934    1           GOTO START;
       91     8935    1   VPH$REVIEW: ENTRY;
       92     8936        /*D* NAME: VPH$REVIEW
       93     8937             CALL: CALL VPH$REVIEW;
       94     8938             DESCRIPTION: This is an entry point inside LIST used for the REVIEW
       95     8939                          command.
       96     8940        */
       97     8941    1           IF NOT M$SI$->F$DCB.DDEV.IC
       98     8942    1            THEN
       99     8943    1              CMD_MASK = '000400'O;        /* MAKE REVIEW INTO A LIST IF         */
      100     8944    1           GOTO START;                     /* INPUT NOT FROM A TERMINAL          */
      101     8945    1   VPH$REVIEWSTD: ENTRY;
      102     8946        /*D* NAME: VPH$REVIEWSTD
      103     8947             CALL: CALL VPH$REVIEWSTD;
      104     8948             DESCRIPTION: This is an entry point inside LIST used for the REVIEWSTD
      105     8949                          command.
      106     8950        */
      107     8951    1           IF NOT M$SI$->F$DCB.DDEV.IC
      108     8952    1            THEN
      109     8953    1              CMD_MASK = '000200'O;        /* MAKE REVIEWSTD A LISTSTD CMD       */
      110     8954    1           GOTO START;                     /* IF INPUT NOT FROM A TERMINAL       */
      111     8955    1   START:
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:4    
      112     8956    1           REMEMBER LIST_ABORT IN ABORT_CMD;
      113     8957    1           REMEMBER NEXT_FILE IN ABORT_STEP;
      114     8958    1           REMEMBER FIN_LIST IN BREAK_LOC;
      115     8959    1           LIST_HDR_OUT = '0'B;
      116     8960    1           LIST_IDX = -1;
      117     8961    1           DEFAULT_LIST_CODE = 0;
      118     8962    1           DEFAULT_LIST_COLS = 12;
      119     8963    1           OUTSPEC$ = ADDR(NIL);
      120     8964    1           SOURCELIST$ = ADDR(NIL);
      121     8965    1           DEF_ICB = '0'B;
      122     8966    2           DO IDX=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;
      123     8967    2              PTR$ = PCB.OUT$->OUT$BLK.SUBLK$(IDX);
      124     8968    3              DO CASE(PTR$->OUT$BLK.CODE);
      125     8969    3               CASE(1);                    /* SOURCELIST                         */
      126     8970    3                 SOURCELIST$ = PTR$;
      127     8971    3               CASE(2);                    /* OUTSPEC                            */
      128     8972    3                 OUTSPEC$ = PTR$;
      129     8973    3               CASE(3);                    /* FROM 'FID'                         */
      130     8974    3                 CALL VPF$SET_FROM_INFO(PTR$->OUT$BLK.SUBLK$(0));
      131     8975    3               CASE(4);                    /* LISTSTD 'FID'                      */
      132     8976    3                 CALL VPD$INIT_STD_FILE(PTR$);
      133     8977    3               CASE(5);                    /* DEFAULT LIST OPTION                */
      134     8978    3                 CON_DUP_TBL = '0'B;
      135     8979    3                 ICB = '0'B;
      136     8980    3                 ICB.DEV_MASK = '777'O;
      137     8981    4                 DO IDX2 = 0 TO PTR$ -> OUT$BLK.NSUBLKS -1;
      138     8982    4                    OUT$=PTR$->OUT$BLK.SUBLK$(IDX2);
      139     8983    4                    CALL VPF$PROCESS_INPUT_OPT(OUT$)
      140     8984    5                     WHENALTRETURN DO;
      141     8985    5                        END;
      142     8986    4                    END;
      143     8987    3                 DEF_ICB = ICB;
      144     8988    3               END;                        /* END CASE                           */
      145     8989    2              END;
      146     8990    1           CALL VPC$SETOUT(OUTSPEC$);      /* Setup and open output file         */
      147     8991    1           CALL VPG$SET_UP_WRITE;
      148     8992    1           CALL GET_USABLE_LEN;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:5    
      149     8993    1           EI_KEY.LEN = 0;
      150     8994    1           EI_KEY.LEN = EI_KEY.LEN -1;     /* Insure error on unitialized key WR */
      151     8995    1           CUR_SEQ_NO = 0;
      152     8996    1           CALL VPD$ENLARGE_BUF((MAXIMUM(OCB.RECSIZE.MIN_SIZE,OCB.RECSIZE.MAX_SIZE)+20+
              8996                    4095)/4096);
      153     8997    1           IF CMD_MASK & '000200002'O      /* LISTSTD OR REVIEWSTD               */
      154     8998    1            THEN
      155     8999    2            DO;
      156     9000    2               LIST_WORK$ = PCB.WORK$;
      157     9001    2               LIST_WKSZ = PCB.WKSZ;
      158     9002    2               PCB.U$$ = ENTADDR(NIL);
      159     9003    2   LISTSTD_L:
      160     9004    2               CALL M$READ(FPT_READ_STD) ALTRET(STD_READ_ALT);
      161     9005    2               PCB.NCHARS = M$STD1$->F$DCB.ARS;
      162     9006    2               PCB.ROOT$ = ADDR(TOP_STD_N);
      163     9007    2               PCB.WORK$ = LIST_WORK$;
      164     9008    2               PCB.WKSZ = LIST_WKSZ;
      165     9009    2               CALL X$PARSE(PCB) ALTRET(STD_PARSE_ALT);
      166     9010    2               SOURCELIST$ = PCB.OUT$;
      167     9011    2               END;
      168     9012    1           IF CMD_MASK & '000100002'O      /* IF REVIEW OR REVIEWSTD             */
      169     9013    1            THEN
      170     9014    2            DO;
      171     9015    2               PCB.U$$ = ENTADDR(NIL);
      172     9016    2               PCB.WORK$ = PINCRW(PCB.WORK$,PCB.WK_USED);
      173     9017    2               PCB.WKSZ = PCB.WKSZ-PCB.WK_USED;
      174     9018    2               PCB.ROOT$ = ADDR(TOP_REVIEW_CMD);
      175     9019    2               END;
      176     9020    1           CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,SOURCELIST$);
      177     9021    2           DO WHILE(NEXT_SPEC_RET_VAL~=1);
      178     9022                                                /* WHILE new SOURCELIST remains       */
      179     9023    2              IF NEXT_SPEC_RET_VAL=0       /* IF ALL FINE...                     */
      180     9024    2               THEN
      181     9025    3               DO;
      182     9026    3                  CALL GET_CLIST_CODE_AND_COLS;
      183     9027    3                  IF (CLIST_CODE>2) OR (CMD_MASK & '000100002'O)
      184     9028    3                   THEN
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:6    
      185     9029    3                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,4);
      186     9030                                                /* OPEN WITH FPARAM                   */
      187     9031    3                   ELSE
      188     9032    3                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,2);
      189     9033                                                /* OPEN WITH FPARAM ONLY IF           */
      190     9034                                                /* NEEDED FOR FILE SELECTION          */
      191     9035    4                  DO WHILE(OPEN_NEXT_RET_VAL~=%VPOC_EXHAUSTED#);
      192     9036    4                     IF CLIST_CODE>2
      193     9037    4                       AND OPEN_NEXT_RET_VAL=%VPOC_NOACCESS#
      194     9038    4                      THEN                 /* Access denied                      */
      195     9039    4                        LIST_CODE = 2;
      196     9040    4                      ELSE
      197     9041    4                        LIST_CODE = CLIST_CODE;
      198     9042    4                     IF OPEN_NEXT_RET_VAL = %VPOC_GOTFILE#
      199     9043    4                       AND ICB.DEV_MASK ~= '100'O /* AND not LT                  */
      200     9044    4                       AND LIST_CODE > 2   /* AND attributes                     */
      201     9045    4                      THEN                 /* Tally GRANS                        */
      202     9046    5                      DO;
      203     9047    5                         PTR$ = ADDR(FPARAM_BUF);
      204     9048    5                         CALL XSF$LOCCODP(PTR$,3) ALTRET(NO_GRANS);
      205     9049    5                         CUR_GRANS = PTR$->CODE03.UGRANS+PTR$->CODE03.NGAVAL;
      206     9050    5                         TOT_GRANS(2) = TOT_GRANS(2) + CUR_GRANS;
      207     9051    5                         TOT_RECS=TOT_RECS+PTR$->CODE03.NRECS;
      208     9052    5                         END;
      209     9053    4   NO_GRANS:         ;
      210     9054    4                     TOT_FILES(2) = TOT_FILES(2) +1;
      211     9055    4   RELIST:           ;
      212     9056    4                     CALL VPH$GET_LIST_BUFS(LIST_CODE);
      213     9057    4                     IF TOT_FILES(2) = 1   /* Before printing the first FID      */
      214     9058    4                       AND ~M$EO1$ -> F$DCB.DDEV.IC /* and output isn't terminal */
      215     9059    4                       AND B$JIT$ -> B$JIT.MODE = %M_INT#
      216     9060    4                      THEN                 /* Put out the listing message        */
      217     9061    5                      DO;
      218     9062    5                         FPT_WRITE_ME.BUF_ = VECTOR(LIS_MSG);
      219     9063    5                         FPT_WRITE_ME.V.DVBYTE.VFC# = %NO#;
      220     9064    5                         CALL M$WRITE(FPT_WRITE_ME);
      221     9065    5                         END;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:7    
      222     9066    4                     IF LIST_CODE ~= 1
      223     9067    4                      THEN                 /* L(A) or better, may need header    */
      224     9068    5                      DO;
      225     9069    5                         IF LIST_HDR_OUT ~= ICB.DEV_MASK
      226     9070    5                          THEN             /* New input device, make new header  */
      227     9071    6                          DO;
      228     9072    6                             CALL VPD$FINISH_NLIST; /* Finish any prev no attr L */
      229     9073    6                             CALL OUT_LIST_HDR; /* Print new header              */
      230     9074    6                             LIST_HDR_OUT = ICB.DEV_MASK;
      231     9075    6                             END;
      232     9076    5                         END;
      233     9077    4                      ELSE                 /* No attribute LIST                  */
      234     9078    4                        LIST_HDR_OUT = '0'B; /* Insure header next L(A) or better */
      235     9079    4                     IF LIST_CODE~=1 OR (CMD_MASK & '000100002'O)
      236     9080    4                      THEN
      237     9081    5                      DO;
      238     9082    5                         PTR$ = ADDR(BUF_BLOCK.BUF_1);
      239     9083    6                         DO I=1 TO BUF_BLOCK.COUNT;
      240     9084    6                            IF I=BUF_BLOCK.COUNT AND (CMD_MASK & '000100002'O)
      241     9085    6                             THEN
      242     9086    7                             DO;
      243     9087    7                                EXTEND.LEN = 1;
      244     9088    7                                OCB.VFC = 2;
      245     9089    7                                END;
      246     9090    6                             ELSE
      247     9091    7                             DO;
      248     9092    7                                EXTEND.LEN = 0;
      249     9093    7                                OCB.VFC = 0;
      250     9094    7                                END;
      251     9095    6                            CALL CONCAT(IN_BUF_VECTOR.PTR$->CHAR$132,
      252     9096    6                              ADDR(EXTEND)->TEXT$C.STRING,
      253     9097    6                              PTR$->TEXT$C.STRING);
      254     9098    6                            TEMP = PTR$->TEXT$C.LEN + EXTEND.LEN;
      255     9099    6                            CALL VPG$WRITE_OUT(TEMP,0);
      256     9100    6                            PTR$ = PINCRC(PTR$,PTR$->TEXT$C.LEN+1);
      257     9101    6                            END;
      258     9102    5                         EXTEND.LEN = 0;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:8    
      259     9103    5                         OCB.VFC = 0;
      260     9104    5                         END;
      261     9105    4                      ELSE
      262     9106    5                      DO;
      263     9107    5                         TEMP = ((LIST_IDX+ICB.COLS)/ICB.COLS)*ICB.COLS;
      264     9108    5                         IF TEMP+BUF_BLOCK.BUF_1.LEN>USABLE_LEN AND LIST_IDX>0
      265     9109    5                          THEN
      266     9110    6                          DO;
      267     9111    6                             CALL VPG$WRITE_OUT(LIST_IDX,0);
      268     9112    6                             LIST_IDX = 0;
      269     9113    6                             END;
      270     9114    5                          ELSE
      271     9115    5                            LIST_IDX = TEMP;
      272     9116    5                         PINCRC(IN_BUF_VECTOR.PTR$,LIST_IDX)->CHAR$132 =
      273     9117    5                           ADDR(BUF_BLOCK.BUF_1)->TEXT$C.STRING;
      274     9118    5                         LIST_IDX = LIST_IDX+BUF_BLOCK.BUF_1.LEN;
      275     9119    5                         END;
      276     9120    4                     IF (CMD_MASK & '000100002'O)
      277     9121    5                      THEN DO;             /* A REVIEW type command              */
      278     9122    5                         REMEMBER REV_BRK IN BREAK_LOC; /* Must skip promt fid if */
      279     9123                                                /* break after fid printed            */
      280     9124    5                         CALL REVIEW_CHK(REV_RET_VAL);
      281     9125    5                         REMEMBER SUMMARY IN BREAK_LOC; /* Just summary if break */
      282     9126                                                /* occurs elsewhere                   */
      283     9127    6                         DO CASE(REV_RET_VAL);
      284     9128    6                          CASE(1);         /* JUMP                               */
      285     9129    6                            IF PCB.OUT$->OUT$BLK.NSUBLKS>0
      286     9130    6                             THEN
      287     9131    6                               GOTO JUMP2;
      288     9132    6                             ELSE
      289     9133    6                               GOTO NEXT_SPEC;
      290     9134    6                          CASE(2);         /* END                                */
      291     9135    6                            GOTO SUMMARY;
      292     9136    6   REV_BRK:                                /* Skip a line to avoid overprinting  */
      293     9137                                                /* the REV fid we printed             */
      294     9138    6                            FPT_WRITE_ME.BUF_ = VECTOR(CR_LF);
      295     9139    6                            FPT_WRITE_ME.V.DVBYTE.VFC# = %YES#;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:9    
      296     9140    6                            CALL M$WRITE(FPT_WRITE_ME);
      297     9141    6                            GOTO SUMMARY;
      298     9142    6                          CASE(3);         /* RELIST                             */
      299     9143    6                            IF OPEN_NEXT_RET_VAL=%VPOC_NOACCESS#
      300     9144    6                             THEN          /* Access denied                      */
      301     9145    6                               LIST_CODE = 2;
      302     9146    6                            GOTO RELIST;
      303     9147    6                          END;             /* END CASE                           */
      304     9148    5                         END;
      305     9149    4   NEXT_FILE:
      306     9150    4                     IF M$EI$->F$DCB.FCD
      307     9151    4                      THEN
      308     9152    4                        CALL M$CLOSE(FPT_CLOSE_EI);
      309     9153    4                     THIS_STD_FILE = '0'B;
      310     9154    4                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);
      311     9155    4                     GOTO AROUND_1;
      312     9156    4   JUMP2:            CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,3,
      313     9157    4                       PCB.OUT$->OUT$BLK.SUBLK$(0)->
      314     9158    4                       OUT$SYM.TEXTC$->TEXT$C);
      315     9159    4   AROUND_1:         END;                  /* END WHILE                          */
      316     9160    3                  END;
      317     9161    2   NEXT_SPEC:
      318     9162    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);
      319     9163    2              END;                         /* END WHILE                          */
      320     9164    1           IF (CMD_MASK & '000200002'O/* LISTSTD or REVIEWSTD*/)~='0'B
      321     9165    1            THEN
      322     9166    1              GOTO LISTSTD_L;
      323     9167        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:10   
      324     9168    1   FIN_LIST:
      325     9169    1           IF M$EI$ -> F$DCB.FCD           /* still open 'cause break was hit    */
      326     9170    1            THEN
      327     9171    1              CALL M$CLOSE (FPT_CLOSE_EI);
      328     9172    1           CALL VPD$FINISH_NLIST;          /* Finish any partial LIST line       */
      329     9173    1   SUMMARY:
      330     9174    1           REMEMBER LIST_ABORT IN ABORT_STEP;
      331     9175    1           REMEMBER LIST_ABORT IN BREAK_LOC;
      332     9176    1           IF ((TOT_FILES(2) > 1           /* IF more than one file was listed   */
      333     9177    1             OR TOT_FILES(1) > 0)          /* OR anything was deleted            */
      334     9178    1             AND OCB.SUMMARY = 0)          /* And user didnt say anything        */
      335     9179    1             OR OCB.SUMMARY = 1            /* or SUMMARY specified               */
      336     9180    1             AND OCB.SUMMARY ~= 2          /* unless NSUMMARY specified          */
      337     9181    1            THEN                           /* A summary is in order              */
      338     9182    2            DO;
      339     9183    2               SUM_LINE_TEXT = '..';
      340     9184    2               CALL BINCHAR(SUM_LINE.FILES,TOT_FILES(2));
      341     9185    2               CALL VPD$CLOBBERLZ(VECTOR(SUM_LINE.FILES));
      342     9186    2               IF TOT_GRANS(2)>0
      343     9187    3                THEN DO;
      344     9188    3                   SUM_IDX = 53;
      345     9189    3                   SUM_LINE.REST = ' files,       granules,         records listed';
      346     9190    3                   CALL BINCHAR(SUM_LINE.GRANS.GRANS,TOT_GRANS(2));
      347     9191    3                   CALL VPD$CLOBBERLZ(VECTOR(SUM_LINE.GRANS.GRANS));
      348     9192    3                   CALL BINCHAR(SUM_LINE.GRANS.RECS,TOT_RECS);
      349     9193    3                   CALL VPD$CLOBBERLZ(VECTOR(SUM_LINE.GRANS.RECS));
      350     9194    3                   END;
      351     9195    3                ELSE DO;
      352     9196    3                   SUM_IDX = 20;
      353     9197    3                   SUM_LINE.REST = ' files listed';
      354     9198    3                   END;
      355     9199    2               IF TOT_FILES(1)>0           /* IF anything deleted                */
      356     9200    2                THEN
      357     9201    3                DO;
      358     9202    3                   PTR$ = PINCRC(ADDR(SUM_LINE_TEXT),SUM_IDX);
      359     9203    3                   PTR$->DEL_TEXT = ';      files,       granules deleted';
      360     9204    3                   CALL BINCHAR(PTR$->DEL.FILES,TOT_FILES(1));
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:11   
      361     9205    3                   CALL VPD$CLOBBERLZ(VECTOR(PTR$->DEL.FILES));
      362     9206    3                   CALL BINCHAR(PTR$->DEL.GRANS,TOT_GRANS(1));
      363     9207    3                   CALL VPD$CLOBBERLZ(VECTOR(PTR$->DEL.GRANS));
      364     9208    3                   SUM_IDX = SUM_IDX+36;
      365     9209    3                   END;
      366     9210    2               IN_BUF_VECTOR.PTR$->CHAR$132 = SUM_LINE_TEXT;
      367     9211    2               CALL VPG$WRITE_OUT(SUM_IDX,0);
      368     9212    2               END;
      369     9213    1           IF TOT_FILES(2) = 0             /* IF no files listed                 */
      370     9214    1             AND ~ERR_FLG                  /* AND no errors occured              */
      371     9215    1            THEN                           /* Tell him that no files were LISTed */
      372     9216    1              CALL VPL$ERR_PROC(1,1,'10'O);
      373     9217        /*E* ERROR:   VPH-00001
      374     9218             MESSAGE: Nothing to list
      375     9219            MESSAGE1: No files were acceptable to LIST in that input spec
      376     9220        */
      377     9221    1   LIST_ABORT: IF M$EO1$->F$DCB.FCD
      378     9222    1            THEN
      379     9223    1              CALL VPD$CLOSE_OUT(BITBIN(ERR_FLG)); /* CLOSE with save if no errs */
      380     9224    1           IF M$STD1$->F$DCB.FCD
      381     9225    1            THEN
      382     9226    1              CALL M$CLOSE(FPT_CLOSE_STD) ALTRET(SKIPIT_1);
      383     9227    1   SKIPIT_1: ;
      384     9228    1           IF M$EI$->F$DCB.FCD
      385     9229    1            THEN
      386     9230    1              CALL M$CLOSE(FPT_CLOSE_EI) ALTRET(SKIPIT_2);
      387     9231    1   SKIPIT_2: ;
      388     9232    1           CALL VPD$MINIMIZE_BUF;
      389     9233    1           RETURN;
      390     9234    1   STD_READ_ALT:
      391     9235    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF
      392     9236    1            THEN
      393     9237    1              GOTO FIN_LIST;
      394     9238    1            ELSE
      395     9239    1              CALL VPL$ERR_PROC(3,0);
      396     9240    1   STD_PARSE_ALT:
      397     9241    1           CALL VPL$ERR_PROC(0,0,,PCB.ERROR);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:12   
      398     9242    1           CALL VPL$ERR_PROC(3,3,'10'O);
      399     9243        /*E*   ERROR: VPH-00003
      400     9244             MESSAGE: in STD file.  Command aborts.
      401     9245            MESSAGE1: A record in the STD file has a bad source or option.
      402     9246        */
      403     9247        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:13   
      404     9248    1   GET_CLIST_CODE_AND_COLS: PROC;
      405     9249        /*I* NAME: GET_CLIST_CODE_AND_COLS
      406     9250             PURPOSE: To obtain CLIST_CODE and to set ICB.COLS to a reasonable value.
      407     9251             CALL: CALL GET_CLIST_CODE_AND_COLS;
      408     9252             DESCRIPTION: This procedure sets CLIST_CODE to the correct value as below:
      409     9253                            VALUE              MEANING
      410     9254                            -----              -------
      411     9255                              1                name only list
      412     9256                              2                access denied list
      413     9257                              3                list with attributes
      414     9258                              4                list with extended attributes
      415     9259                              5                list with full attributes
      416     9260                          It also sets ICB.COLS to the default if it is not specified.
      417     9261        */
      418     9262    2           IF ICB.A_EA_C~=0
      419     9263    2            THEN                           /* Explicit LIST options, use 'em     */
      420     9264    2              CLIST_CODE = ICB.A_EA_C;
      421     9265    2            ELSE                           /* No explicit options, try default   */
      422     9266    2              IF DEFAULT_LIST_CODE~=0
      423     9267    2               THEN
      424     9268    2                 CLIST_CODE = DEFAULT_LIST_CODE;
      425     9269    2               ELSE                        /* No defaults, either.  Depend on    */
      426     9270                                                /* type of source specification       */
      427     9271    2                 IF ICB.SPEC_TYPE=1 OR ICB.SPEC_TYPE=7
      428     9272    2                  THEN                     /* (A) OPTION FOR SINGLE FILE LISTS   */
      429     9273    2                    CLIST_CODE = 3;
      430     9274    2                  ELSE
      431     9275    2                    CLIST_CODE = 1;
      432     9276    2           IF ICB.COLS=0
      433     9277    2            THEN
      434     9278    2              ICB.COLS = DEFAULT_LIST_COLS;
      435     9279    2           RETURN;
      436     9280    2   END GET_CLIST_CODE_AND_COLS;
      437     9281        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:14   
      438     9282    1   GET_USABLE_LEN: PROC;
      439     9283        /*I* NAME: GET_USABLE_LEN
      440     9284             PURPOSE: To determine the usable length for a list record.
      441     9285             CALL: CALL GET_USABLE_LEN;
      442     9286             DESCRIPTION: USABLE_LEN is determined from a combination of the options
      443     9287                          KEYS and CS and OUTPUT_PWIDTH from VPG$SET_UP_WRITE. It
      444     9288                          represents the size available for writing the list record.
      445     9289        */
      446     9290    2           IF OCB.CS.SPEC~=0
      447     9291    2            THEN
      448     9292    2              USABLE_LEN = 72;
      449     9293    2            ELSE
      450     9294    3            DO;
      451     9295    3               USABLE_LEN = OUTPUT_PWIDTH;
      452     9296    3               IF OCB.KEYS~=0
      453     9297    3                THEN
      454     9298    3                  USABLE_LEN = USABLE_LEN-9;
      455     9299    3               END;
      456     9300    2           RETURN;
      457     9301    2   END GET_USABLE_LEN;
      458     9302        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:15   
      459     9303    1   OUT_LIST_HDR: PROC;
      460     9304        /*I* NAME: OUT_LIST_HDR
      461     9305             PURPOSE: To put out a header for a list with attributes or eattributes.
      462     9306             CALL: CALL OUT_LIST_HDR;
      463     9307             DESCRIPTION: This procedure puts out a header line containing
      464     9308                          current time and date and files-to-be-listed description
      465     9309                          if a single specification only was entered. In any case,
      466     9310                          it then puts out a header for a list with attributes or
      467     9311                          better.
      468     9312        */
      469     9313    2   DCL CHAR$140 CHAR(140) BASED;
      470     9314    2   DCL CHAR$49 CHAR(49) BASED;
      471     9315    2   DCL DISK_HDR CHAR(49) CONSTANT INIT
      472     9316    2               ('Org TY  Gran  NGAV     Rec   Last modified   Name');
      473     9317    2   DCL TAPE_HDR CHAR(49) CONSTANT INIT
      474     9318    2               ('Org TY  Blkl  Recl     Rec Vol           FSN Name');
      475     9319    2   DCL TEMP SBIN WORD;
      476     9320        /**/
      477     9321    2           IF SINGLE_INSPEC=1 AND CMD_MASK(9)
      478     9322    2             AND NOT(ICB.SPEC_TYPE=1 OR ICB.SPEC_TYPE=7)
      479     9323    2            THEN
      480     9324    3            DO;                            /* PUT OUT EXTENDED HEADER            */
      481     9325    3               CALL VPD$GET_SPEC_BUF(0,1);
      482     9326    3               IN_BUF_VECTOR.PTR$->CHAR$140 = SPEC_BUF.STRING;
      483     9327    3               TEMP = SPEC_BUF.LEN;
      484     9328    3               CALL VPG$WRITE_OUT(TEMP,0);
      485     9329    3               END;
      486     9330    2           IF ICB.DEV_MASK.MAN_TAPE        /*LT*/
      487     9331    2            THEN
      488     9332    2              IN_BUF_VECTOR.PTR$->CHAR$49 = TAPE_HDR;
      489     9333    2            ELSE
      490     9334    2              IN_BUF_VECTOR.PTR$->CHAR$49 = DISK_HDR;
      491     9335    2           CALL VPG$WRITE_OUT(49,0);
      492     9336    2           RETURN;
      493     9337    2   END OUT_LIST_HDR;
      494     9338        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:16   
      495     9339    1   REVIEW_CHK: PROC(RET_VAL);
      496     9340        /*I* NAME: REVIEW_CHK
      497     9341             PURPOSE: To analyze and act upon responses to the REVIEW commands'
      498     9342                      prompts.
      499     9343             CALL: CALL REVIEW_CHK(RET_VAL);
      500     9344             DESCRIPTION: REVIEW_CHK gets an input line from the user after each
      501     9345                          file being reviewed is listed. It then acts upon that input
      502     9346                          as follows:
      503     9347                             o NEXT - does nothing but return
      504     9348                             o DELETE - attempts to delete the file and returns
      505     9349                             o END - returns with a code to end the REVIEW
      506     9350                             o JUMP - returns with a code to JUMP to the next source
      507     9351                             o A - returns with a code to re-LIST with Attributes
      508     9352                             o EA - returns with a code to re-LIST with Extended
      509     9353                                    Attributes.
      510     9354                             o FA - returns with a code to re-LIST with Full
      511     9355                                    Attributes.
      512     9356                             o COPY [n] - copies the first n lines of the file
      513     9357                                          then returns with a code to re-LIST
      514     9358                                          NAME only.
      515     9359        */
      516     9360    2   DCL RET_VAL SBIN WORD;
      517     9361    2   DCL TSEED UBIN;
      518     9362    2   DCL J UBIN;
      519     9363    2   DCL DELETED_BUF CHAR(0) CONSTANT INIT('          ** Deleted **');
      520     9364        %FPT_READ(FPTN = FPT_READ_EI,
      521     9365                  DCB  = M$EI,
      522     9366                  BUF  = REV_BUF,
      523     9367                  STCLASS = STATIC);
      524     9406        %FPT_OPEN  (FPTN=FPT_OPEN_EI_DELETE_IT, STCLASS=AUTO);
      525     9515    2   DCL REV_BUF CHAR(140) STATIC;
      526     9516    2   DCL NUMRECS SBIN WORD;
      527     9517        /**/
      528     9518    2           RET_VAL = 0;                    /* GO ON TO NEXT FILE                 */
      529     9519    2           CALL VPD$GET_INPUT(0);
      530     9520    2           CALL X$PARSE(PCB) ALTRET(PARSE_ALT);
      531     9521    3           DO CASE(PCB.OUT$->OUT$BLK.CODE);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:17   
      532     9522    3            CASE(1);                       /* NEXT                               */
      533     9523    3              ;
      534     9524    3            CASE(5);                       /* DELETE                             */
      535     9525    3              FPT_OPEN_EI_DELETE_IT = FPT_OPEN_EI_SAVE;
      536     9526    3              FPT_OPEN_EI_DELETE_IT.V_ = VECTOR (FPT_OPEN_EI_DELETE_IT.V);
      537     9527    3              FPT_OPEN_EI_DELETE_IT.V.OPER.TEST# = %NO#;
      538     9528    3              FPT_OPEN_EI_DELETE_IT.V.DELETE# = %YES#;
      539     9529    3              CALL M$OPEN(FPT_OPEN_EI_DELETE_IT) ALTRET(DEL_OPEN_ALT);
      540     9530    3              CALL VPD$COUNTER_BUMP(1);
      541     9531    3              FPT_WRITE_ME.BUF_   = VECTOR(DELETED_BUF);
      542     9532    3              FPT_WRITE_ME.V.DVBYTE.VFC# = %NO#;
      543     9533    3              CALL M$WRITE(FPT_WRITE_ME);
      544     9534    3            CASE(3);                       /* JUMP                               */
      545     9535    3              RET_VAL = 1;
      546     9536    3            CASE(4);                       /* END                                */
      547     9537    3              RET_VAL = 2;
      548     9538    3            CASE(2);                       /* ATTRIBS                            */
      549     9539    3              RET_VAL = 3;
      550     9540    3              LIST_CODE = 3;
      551     9541    3            CASE(7);                       /* EATTRIBS                           */
      552     9542    3              RET_VAL = 3;
      553     9543    3              LIST_CODE = 4;
      554     9544    3            CASE(32);                      /* FATTRIBS                           */
      555     9545    3              RET_VAL = 3;
      556     9546    3              LIST_CODE = 5;
      557     9547    3            CASE(6);                       /* COPY                               */
      558     9548    3              TSEED=ICB.CRPT;              /* Default to what user said          */
      559     9549    3              NUMRECS = 1;                 /* Default to 1 record                */
      560     9550    3              IF PCB.OUT$->OUT$BLK.NSUBLKS>0
      561     9551    3               THEN
      562     9552    4               DO J=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;
      563     9553    5                  DO CASE(PCB.OUT$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE);
      564     9554    5                   CASE(0);                /* Decimal number                     */
      565     9555    5                     CALL VPD$TEXTC_CHARBIN(NUMRECS,PCB.OUT$->OUT$BLK.SUBLK$(J)->
      566     9556    5                       OUT$BLK.SUBLK$(0),-1) ALTRET(DEF_1);
      567     9557    5                   CASE(6);                /* Encryption seed                    */
      568     9558    5                     CALL VPD$MNG_CRPT(TSEED,PCB.OUT$->OUT$BLK.SUBLK$(J)->
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:18   
      569     9559    5                       OUT$BLK.SUBLK$(0))
      570     9560    6                      WHENALTRETURN DO; END;
      571     9561    5                   END;
      572     9562    4                  END;
      573     9563    3               ELSE
      574     9564    3   DEF_1:        NUMRECS = 1;
      575     9565    3              FPT_WRITE_ME.BUF_   = VECTOR(REV_BUF);
      576     9566    3              FPT_WRITE_ME.V.DVBYTE.VFC# = %NO#;
      577     9567    3              FPT_READ_EI.V.SEED# = BINBIT(TSEED,36);
      578     9568    4              DO NUMRECS=-NUMRECS TO -1;
      579     9569    4                 CALL M$READ(FPT_READ_EI) ALTRET(EI_READ_ALT);
      580     9570    4   WRITE_IT:     IF M$EI$->F$DCB.ARS = 0
      581     9571    4                  THEN                     /* Null record, clobber it            */
      582     9572    5                  DO;
      583     9573    5                     FPT_WRITE_ME.BUF_ = VECTOR (NIL);
      584     9574    5                     CALL M$WRITE(FPT_WRITE_ME);
      585     9575    5                     FPT_WRITE_ME.BUF_ = VECTOR (REV_BUF); /* Restore output BUF */
      586     9576    5                     END;
      587     9577    4                  ELSE
      588     9578    5                  DO;
      589     9579    5                     FPT_WRITE_ME.BUF_.BOUND = M$EI$->F$DCB.ARS -1;
      590     9580    5                     CALL M$WRITE(FPT_WRITE_ME);
      591     9581    5                     END;
      592     9582    4                 END;
      593     9583    3   CLOSE_EI:  CALL M$CLOSE(FPT_CLOSE_EI);
      594     9584    3              RET_VAL = 3;
      595     9585    3              LIST_CODE = 1;
      596     9586    3            CASE(23);                      /* HELP                               */
      597     9587    3              CALL VPL$HELP;
      598     9588    3              RET_VAL = 3;
      599     9589    3              LIST_CODE = 1;
      600     9590    3            CASE(27);                      /* QUEST                              */
      601     9591    3              CALL VPL$QUEST;
      602     9592    3              RET_VAL = 3;
      603     9593    3              LIST_CODE = 1;
      604     9594    3            END;                           /* END CASE                           */
      605     9595    3           DO WHILE('0'B);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:19   
      606     9596    3   EI_READ_ALT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF
      607     9597    3               THEN
      608     9598    3                 GOTO CLOSE_EI;
      609     9599    3               ELSE
      610     9600    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$LD
      611     9601    3                  THEN
      612     9602    3                    GOTO WRITE_IT;
      613     9603    3                  ELSE
      614     9604    4                  DO;
      615     9605    4                     CALL VPL$ERR_PROC(1,0);
      616     9606    4                     GOTO CLOSE_EI;
      617     9607    4                     END;
      618     9608    3   PARSE_ALT: CALL VPL$ERR_PROC(1,0,,PCB.ERROR);
      619     9609    3   READ_SI_ALT: RET_VAL = 3;
      620     9610    3              LIST_CODE = 1;
      621     9611    4              DO WHILE('0'B);
      622     9612    4   DEL_OPEN_ALT: CALL VPL$ERR_PROC(1,0);
      623     9613    4                 END;
      624     9614    3              END;
      625     9615    2           RETURN;
      626     9616    2   END REVIEW_CHK;
      627     9617    1   END VPH$LIST;
      628     9618        %EOD;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:20   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPH$LIST.

   Procedure VPH$LIST requires 1121 words for executable code.
   Procedure VPH$LIST requires 126 words of local(AUTO) storage.

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:21   

 Object Unit name= VPH$LIST                                   File name= VPH$LISTREV.:E05TOU
 UTS= JUL 30 '97 07:39:32.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10  RoData even  UTS     63     77  VPH$LIST
   11   Data  even  none    51     63  VPH$LIST
   12   Proc  even  none  1121   2141  VPH$LIST
   13  RoData even  none    50     62  VPH$LIST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        0  VPH$LIST
    12      3                  yes      Std        0  VPH$LISTSTD
    12      6                  yes      Std        0  VPH$REVIEW
    12     21                  yes      Std        0  VPH$REVIEWSTD
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:22   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 VPF$SET_FROM_INFO
         yes           Std       1 VPD$INIT_STD_FILE
         yes           Std       1 VPC$SETOUT
         yes           Std       3 VPF$OPEN_NEXT
         yes           Std       8 VPL$ERR_PROC
         yes           Std       1 VPD$CLOSE_OUT
         yes           Std       1 VPH$GET_LIST_BUFS
         yes           Std       1 VPD$ENLARGE_BUF
 yes     yes           Std       2 XSF$LOCCODP
 yes     yes           Std       1 VPF$PROCESS_INPUT_OPT
         yes           Std       0 VPG$SET_UP_WRITE
         yes           Std       2 VPD$FINISH_NLIST
         yes           Std       0 VPD$MINIMIZE_BUF
         yes           Std       2 VPF$GET_NEXT_SPEC
         yes           Std       1 VPD$CLOBBERLZ
 yes     yes           Std       1 X$PARSE
         yes           Std       2 VPG$WRITE_OUT
         yes           Std       2 VPD$GET_SPEC_BUF
         yes           Std       1 VPD$GET_INPUT
         yes           Std       1 VPD$COUNTER_BUMP
         yes           Std       0 VPL$QUEST
 yes     yes           Std       4 VPD$TEXTC_CHARBIN
 yes     yes           Std       2 VPD$MNG_CRPT
         yes           Std       0 VPL$HELP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:23   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PCB                                   ERR_FLG
     ABORT_STEP                            ABORT_CMD                             LIST_IDX
     LIST_BUF$                             CON_DUP_TBL                           THIS_STD_FILE
     BREAK_LOC                             BREAK_MESSAGE_REPORTER                FPARAM_BUF
     CMD_MASK                              OUTPUT_PWIDTH                         TOT_FILES
     TOT_GRANS                             TOT_RECS                              SPEC_BUF
     SINGLE_INSPEC                         USABLE_LEN                            OCB
     IN_RES                                ICB                                   DEF_ICB
     IN_BUF_VECTOR                         EI_KEY                                CUR_SEQ_NO
     M$EI                                  M$EI$                                 M$EO
     M$EO1                                 M$EO1$                                M$ME
     M$SI                                  M$SI$                                 M$READFILE
     M$DO                                  M$STD1                                M$STD1$
     M$SORT1                               B$TCB$                                B$JIT$
     TOP_STD_N                             TOP_REVIEW_CMD                        FPT_OPEN_EI_SAVE
r    FPT_READ_STD                          FPT_WRITE_ME                          FPT_CLOSE_EI
r    FPT_CLOSE_STD                         B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:24   


        1        1        /*M* VPH$LISTREV  This module contains routines for the LIST,LISTSTD,
        2        2                          REVIEW, and REVIEWSTD commands.
        3        3        */
        4        4        /*T***********************************************************/
        5        5        /*T*                                                         */
        6        6        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        7        7        /*T*                                                         */
        8        8        /*T***********************************************************/
        9        9        /*X* DTI=1,THI=1 */
       10       10        /* Next available error code = 5 */
       11       11        VPH$LIST: PROC;

     11 12 000000   000000 700200 xent  VPH$LIST     TSX0  ! X66_AUTO_0
        12 000001   000176 000000                    ZERO    126,0
        12 000002   000005 710000 12                 TRA     s:8934

       12       12        /*D* NAME: VPH$LIST
       13       13             CALL: CALL VPH$LIST;
       14       14             DESCRIPTION: This procedure drives the LIST command.
       15       15        */
       16       16        %INCLUDE VP_DATA_R;
       17     7003        %INCLUDE F$DCB;
       18     7052        %INCLUDE FM$FIT;
       19     7273        %CODE03;
       20     7280        %B$TCB;
       21     7283        %B$ALT;
       22     7291        %INCLUDE B_ERRORS_C;
       23     8418 S      %INCLUDE B$JIT_C;
       24     8419        %B$JIT0;
       25     8508        %U$JIT1;
       26     8582    1         2 * BIT(1);                       /* Don't need rest of JIT             */
       27     8583        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
       28     8628        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
       29     8666    1   DCL LIS_MSG CHAR(0) CONSTANT INIT('..LISTing');
       30     8667    1   DCL 1 TEXT$C BASED,
       31     8668    1         2 LEN UBIN BYTE UNAL,
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:25   
       32     8669    1         2 STRING CHAR(TEXT$C.LEN);
       33     8670    1   DCL IDX SBIN WORD;
       34     8671    1   DCL IDX2 SBIN WORD;
       35     8672    1   DCL LIST_HDR_OUT BIT(9);
       36     8673    1   DCL NEXT_SPEC_RET_VAL SBIN WORD;
       37     8674    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
       38     8675    1   DCL I SBIN WORD;
       39     8676    1   DCL 1 EXTEND STATIC,
       40     8677    1         2 LEN UBIN BYTE UNAL,
       41     8678    1         2 * CHAR(1) INIT('@');
       42     8679    1   DCL CR_LF CHAR(1) STATIC INIT('A');     /* VFC to start a new line            */
       43     8680    1   DCL DEFAULT_LIST_CODE SBIN WORD;
       44     8681    1   DCL DEFAULT_LIST_COLS SBIN WORD;
       45     8682    1   DCL PTR$ PTR;
       46     8683    1   DCL OUT$ PTR;
       47     8684    1   DCL OUTSPEC$ PTR;
       48     8685    1   DCL SOURCELIST$ PTR;
       49     8686    1   DCL CLIST_CODE SBIN WORD;
       50     8687    1   DCL LIST_CODE SBIN WORD;
       51     8688    1   DCL 1 BUF_BLOCK BASED(LIST_BUF$) ALIGNED,
       52     8689    1         2 COUNT SBIN WORD,
       53     8690    1         2 BUF_1,
       54     8691    1           3 LEN UBIN BYTE UNAL,
       55     8692    1           3 STRING(0:0) CHAR(4);
       56     8693    1   DCL CUR_GRANS SBIN WORD;
       57     8694    1   DCL LIST_WKSZ SBIN WORD;
       58     8695    1   DCL LIST_WORK$ PTR;
       59     8696    1   DCL REV_RET_VAL SBIN WORD;
       60     8697    1   DCL SUM_IDX SBIN;
       61     8698    1   DCL SUM_LINE_TEXT CHAR(132);
       62     8699    1   DCL 1 SUM_LINE REDEF SUM_LINE_TEXT,
       63     8700    1         2 * CHAR(2),
       64     8701    1         2 FILES CHAR(5),
       65     8702    1         2 REST CHAR(125),
       66     8703    1         2 GRANS REDEF REST,
       67     8704    1           3 * CHAR(7),
       68     8705    1           3 GRANS CHAR(6),
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:26   
       69     8706    1           3 * CHAR(10),
       70     8707    1           3 RECS CHAR(8),
       71     8708    1           3 * CHAR(94);
       72     8709    1   DCL 1 DEL_TEXT CHAR(36) BASED;
       73     8710    1   DCL 1 DEL REDEF DEL_TEXT,
       74     8711    1         2 * CHAR(1),
       75     8712    1         2 FILES CHAR(5),
       76     8713    1         2 * CHAR(7),
       77     8714    1         2 GRANS CHAR(6),
       78     8715    1         2 * CHAR(17);
       79     8716    1   DCL TEMP SBIN WORD;
       80     8717    1   DCL CHAR$1 CHAR(1) BASED;
       81     8718    1   DCL CHAR$72 CHAR(72) BASED;
       82     8719    1   DCL CHAR$132 CHAR(132) BASED;
       83     8720        /**/
       84     8721        /*  ENTRY POINTS  */
       85     8722        /**/
       86     8723    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
       87     8724    1   DCL X$PARSE ENTRY(1) ALTRET;
       88     8725        %VP_ENTRIES (OMIT=VPH$LIST);
       89     8933    1   VPH$LISTSTD: ENTRY;

   8933 12 000003   000000 700200 xent  VPH$LISTSTD  TSX0  ! X66_AUTO_0
        12 000004   000176 000000                    ZERO    126,0

       90     8934    1           GOTO START;

   8934 12 000005   000034 710000 12                 TRA     START

       91     8935    1   VPH$REVIEW: ENTRY;

   8935 12 000006   000000 700200 xent  VPH$REVIEW   TSX0  ! X66_AUTO_0
        12 000007   000176 000000                    ZERO    126,0

       92     8936        /*D* NAME: VPH$REVIEW
       93     8937             CALL: CALL VPH$REVIEW;
       94     8938             DESCRIPTION: This is an entry point inside LIST used for the REVIEW
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:27   
       95     8939                          command.
       96     8940        */
       97     8941    1           IF NOT M$SI$->F$DCB.DDEV.IC

   8941 12 000010   000000 470400 xsym               LDP0    M$SI$
        12 000011   000004 236100                    LDQ     4,,PR0
        12 000012   100000 316007                    CANQ    32768,DL
        12 000013   000020 601000 12                 TNZ     s:8944

       98     8942    1            THEN
       99     8943    1              CMD_MASK = '000400'O;        /* MAKE REVIEW INTO A LIST IF         */

   8943 12 000014   000400 235003                    LDA     256,DU
        12 000015   000000 236003                    LDQ     0,DU
        12 000016   000000 755000 xsym               STA     CMD_MASK
        12 000017   000001 756000 xsym               STQ     CMD_MASK+1

      100     8944    1           GOTO START;                     /* INPUT NOT FROM A TERMINAL          */

   8944 12 000020   000034 710000 12                 TRA     START

      101     8945    1   VPH$REVIEWSTD: ENTRY;

   8945 12 000021   000000 700200 xent  VPH$REVIEWS* TSX0  ! X66_AUTO_0
        12 000022   000176 000000                    ZERO    126,0

      102     8946        /*D* NAME: VPH$REVIEWSTD
      103     8947             CALL: CALL VPH$REVIEWSTD;
      104     8948             DESCRIPTION: This is an entry point inside LIST used for the REVIEWSTD
      105     8949                          command.
      106     8950        */
      107     8951    1           IF NOT M$SI$->F$DCB.DDEV.IC

   8951 12 000023   000000 470400 xsym               LDP0    M$SI$
        12 000024   000004 236100                    LDQ     4,,PR0
        12 000025   100000 316007                    CANQ    32768,DL
        12 000026   000033 601000 12                 TNZ     s:8954
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:28   

      108     8952    1            THEN
      109     8953    1              CMD_MASK = '000200'O;        /* MAKE REVIEWSTD A LISTSTD CMD       */

   8953 12 000027   000200 235003                    LDA     128,DU
        12 000030   000000 236003                    LDQ     0,DU
        12 000031   000000 755000 xsym               STA     CMD_MASK
        12 000032   000001 756000 xsym               STQ     CMD_MASK+1

      110     8954    1           GOTO START;                     /* IF INPUT NOT FROM A TERMINAL       */

   8954 12 000033   000034 710000 12                 TRA     START

      111     8955    1   START:
      112     8956    1           REMEMBER LIST_ABORT IN ABORT_CMD;

   8956 12 000034   001324 635000 12    START        EAA     LIST_ABORT
        12 000035   000000 452400 xsym               STP2    ABORT_CMD
        12 000036   000001 755000 xsym               STA     ABORT_CMD+1

      113     8957    1           REMEMBER NEXT_FILE IN ABORT_STEP;

   8957 12 000037   001014 635000 12                 EAA     NEXT_FILE
        12 000040   000000 452400 xsym               STP2    ABORT_STEP
        12 000041   000001 755000 xsym               STA     ABORT_STEP+1

      114     8958    1           REMEMBER FIN_LIST IN BREAK_LOC;

   8958 12 000042   001076 635000 12                 EAA     FIN_LIST
        12 000043   000000 452400 xsym               STP2    BREAK_LOC
        12 000044   000001 755000 xsym               STA     BREAK_LOC+1

      115     8959    1           LIST_HDR_OUT = '0'B;

   8959 12 000045   200005 450100                    STZ     LIST_HDR_OUT,,AUTO

      116     8960    1           LIST_IDX = -1;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:29   

   8960 12 000046   000001 336007                    LCQ     1,DL
        12 000047   000000 756000 xsym               STQ     LIST_IDX

      117     8961    1           DEFAULT_LIST_CODE = 0;

   8961 12 000050   200011 450100                    STZ     DEFAULT_LIST_CODE,,AUTO

      118     8962    1           DEFAULT_LIST_COLS = 12;

   8962 12 000051   000014 235007                    LDA     12,DL
        12 000052   200012 755100                    STA     DEFAULT_LIST_COLS,,AUTO

      119     8963    1           OUTSPEC$ = ADDR(NIL);

   8963 12 000053   000001 236000 xsym               LDQ     B_VECTNIL+1
        12 000054   200015 756100                    STQ     OUTSPEC$,,AUTO

      120     8964    1           SOURCELIST$ = ADDR(NIL);

   8964 12 000055   200016 756100                    STQ     SOURCELIST$,,AUTO

      121     8965    1           DEF_ICB = '0'B;

   8965 12 000056   000000 100400                    MLR     fill='000'O
        12 000057   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 000060   000000 001214 xsym               ADSC9   DEF_ICB                  cn=0,n=652

      122     8966    2           DO IDX=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;

   8966 12 000061   200003 450100                    STZ     IDX,,AUTO
        12 000062   000161 710000 12                 TRA     s:8989+1

      123     8967    2              PTR$ = PCB.OUT$->OUT$BLK.SUBLK$(IDX);

   8967 12 000063   000003 470400 xsym               LDP0    PCB+3
        12 000064   200003 720100                    LXL0    IDX,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:30   
        12 000065   000003 236110                    LDQ     3,X0,PR0
        12 000066   200013 756100                    STQ     PTR$,,AUTO

      124     8968    3              DO CASE(PTR$->OUT$BLK.CODE);

   8968 12 000067   200013 471500                    LDP1    PTR$,,AUTO
        12 000070   100000 721100                    LXL1    0,,PR1
        12 000071   000006 101003                    CMPX1   6,DU
        12 000072   000074 602011 12                 TNC     s:8968+5,X1
        12 000073   000160 710000 12                 TRA     s:8989
        12 000074   000160 710000 12                 TRA     s:8989
        12 000075   000102 710000 12                 TRA     s:8970
        12 000076   000104 710000 12                 TRA     s:8972
        12 000077   000106 710000 12                 TRA     s:8974
        12 000100   000115 710000 12                 TRA     s:8976
        12 000101   000124 710000 12                 TRA     s:8978

      125     8969    3               CASE(1);                    /* SOURCELIST                         */

      126     8970    3                 SOURCELIST$ = PTR$;

   8970 12 000102   200016 756100                    STQ     SOURCELIST$,,AUTO
        12 000103   000160 710000 12                 TRA     s:8989

      127     8971    3               CASE(2);                    /* OUTSPEC                            */

      128     8972    3                 OUTSPEC$ = PTR$;

   8972 12 000104   200015 756100                    STQ     OUTSPEC$,,AUTO
        12 000105   000160 710000 12                 TRA     s:8989

      129     8973    3               CASE(3);                    /* FROM 'FID'                         */

      130     8974    3                 CALL VPF$SET_FROM_INFO(PTR$->OUT$BLK.SUBLK$(0));

   8974 12 000106   000003 036003                    ADLQ    3,DU
        12 000107   200170 756100                    STQ     NUMRECS+2,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:31   
        12 000110   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000111   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000112   000000 701000 xent               TSX1    VPF$SET_FROM_INFO
        12 000113   000000 011000                    NOP     0
        12 000114   000160 710000 12                 TRA     s:8989

      131     8975    3               CASE(4);                    /* LISTSTD 'FID'                      */

      132     8976    3                 CALL VPD$INIT_STD_FILE(PTR$);

   8976 12 000115   200013 633500                    EPPR3   PTR$,,AUTO
        12 000116   200170 453500                    STP3    NUMRECS+2,,AUTO
        12 000117   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000120   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000121   000000 701000 xent               TSX1    VPD$INIT_STD_FILE
        12 000122   000000 011000                    NOP     0
        12 000123   000160 710000 12                 TRA     s:8989

      133     8977    3               CASE(5);                    /* DEFAULT LIST OPTION                */

      134     8978    3                 CON_DUP_TBL = '0'B;

   8978 12 000124   000000 450000 xsym               STZ     CON_DUP_TBL

      135     8979    3                 ICB = '0'B;

   8979 12 000125   000000 100400                    MLR     fill='000'O
        12 000126   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        12 000127   000000 001214 xsym               ADSC9   ICB                      cn=0,n=652

      136     8980    3                 ICB.DEV_MASK = '777'O;

   8980 12 000130   777000 236003                    LDQ     -512,DU
        12 000131   000171 756000 xsym               STQ     ICB+121

      137     8981    4                 DO IDX2 = 0 TO PTR$ -> OUT$BLK.NSUBLKS -1;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:32   
   8981 12 000132   200004 450100                    STZ     IDX2,,AUTO
        12 000133   000150 710000 12                 TRA     s:8986+1

      138     8982    4                    OUT$=PTR$->OUT$BLK.SUBLK$(IDX2);

   8982 12 000134   200013 470500                    LDP0    PTR$,,AUTO
        12 000135   200004 720100                    LXL0    IDX2,,AUTO
        12 000136   000003 236110                    LDQ     3,X0,PR0
        12 000137   200014 756100                    STQ     OUT$,,AUTO

      139     8983    4                    CALL VPF$PROCESS_INPUT_OPT(OUT$)

   8983 12 000140   200014 631500                    EPPR1   OUT$,,AUTO
        12 000141   200170 451500                    STP1    NUMRECS+2,,AUTO
        12 000142   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000143   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000144   000000 701000 xent               TSX1    VPF$PROCESS_INPUT_OPT
        12 000145   000147 702000 12                 TSX2    s:8986
        12 000146   000147 710000 12                 TRA     s:8986

      140     8984    5                     WHENALTRETURN DO;

      141     8985    5                        END;

      142     8986    4                    END;

   8986 12 000147   200004 054100                    AOS     IDX2,,AUTO
        12 000150   200013 470500                    LDP0    PTR$,,AUTO
        12 000151   000001 236100                    LDQ     1,,PR0
        12 000152   000022 772000                    QRL     18
        12 000153   200004 116100                    CMPQ    IDX2,,AUTO
        12 000154   000134 605400 12                 TPNZ    s:8982

      143     8987    3                 DEF_ICB = ICB;

   8987 12 000155   000000 100400                    MLR     fill='000'O
        12 000156   000000 001214 xsym               ADSC9   ICB                      cn=0,n=652
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:33   
        12 000157   000000 001214 xsym               ADSC9   DEF_ICB                  cn=0,n=652

      144     8988    3               END;                        /* END CASE                           */

      145     8989    2              END;

   8989 12 000160   200003 054100                    AOS     IDX,,AUTO
        12 000161   000003 470400 xsym               LDP0    PCB+3
        12 000162   000001 236100                    LDQ     1,,PR0
        12 000163   000022 772000                    QRL     18
        12 000164   200003 116100                    CMPQ    IDX,,AUTO
        12 000165   000063 605400 12                 TPNZ    s:8967

      146     8990    1           CALL VPC$SETOUT(OUTSPEC$);      /* Setup and open output file         */

   8990 12 000166   200015 631500                    EPPR1   OUTSPEC$,,AUTO
        12 000167   200170 451500                    STP1    NUMRECS+2,,AUTO
        12 000170   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000171   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000172   000000 701000 xent               TSX1    VPC$SETOUT
        12 000173   000000 011000                    NOP     0

      147     8991    1           CALL VPG$SET_UP_WRITE;

   8991 12 000174   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 000175   000000 701000 xent               TSX1    VPG$SET_UP_WRITE
        12 000176   000000 011000                    NOP     0

      148     8992    1           CALL GET_USABLE_LEN;

   8992 12 000177   001445 701000 12                 TSX1    GET_USABLE_LEN
        12 000200   000000 011000                    NOP     0

      149     8993    1           EI_KEY.LEN = 0;

   8993 12 000201   000000 236003                    LDQ     0,DU
        12 000202   000000 552040 xsym               STBQ    EI_KEY,'40'O
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:34   

      150     8994    1           EI_KEY.LEN = EI_KEY.LEN -1;     /* Insure error on unitialized key WR */

   8994 12 000203   000000 236000 xsym               LDQ     EI_KEY
        12 000204   777000 036003                    ADLQ    -512,DU
        12 000205   000000 552040 xsym               STBQ    EI_KEY,'40'O

      151     8995    1           CUR_SEQ_NO = 0;

   8995 12 000206   000000 450000 xsym               STZ     CUR_SEQ_NO

      152     8996    1          CALL VPD$ENLARGE_BUF((MAXIMUM(OCB.RECSIZE.MIN_SIZE,OCB.RECSIZE.MAX_SIZE)+20+
              8996                    4095)/4096);

   8996 12 000207   000006 236000 xsym               LDQ     OCB+6
        12 000210   000004 116000 xsym               CMPQ    OCB+4
        12 000211   000213 605000 12                 TPL     s:8996+4
        12 000212   000004 236000 xsym               LDQ     OCB+4
        12 000213   010023 036007                    ADLQ    4115,DL
        12 000214   010000 506007                    DIV     4096,DL
        12 000215   200170 756100                    STQ     NUMRECS+2,,AUTO
        12 000216   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000217   200171 450500                    STP0    NUMRECS+3,,AUTO
        12 000220   200171 630500                    EPPR0   NUMRECS+3,,AUTO
        12 000221   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000222   000000 701000 xent               TSX1    VPD$ENLARGE_BUF
        12 000223   000000 011000                    NOP     0

      153     8997    1           IF CMD_MASK & '000200002'O      /* LISTSTD OR REVIEWSTD               */

   8997 12 000224   000043 235000 10                 LDA     DELETED_BUF+6
        12 000225   000000 236003                    LDQ     0,DU
        12 000226   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 000227   000100 100400                    MLR     fill='000'O
        12 000230   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000231   200172 000010                    ADSC9   NUMRECS+4,,AUTO          cn=0,n=8
        12 000232   200172 237100                    LDAQ    NUMRECS+4,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:35   
        12 000233   200170 377100                    ANAQ    NUMRECS+2,,AUTO
        12 000234   000267 600000 12                 TZE     s:9012

      154     8998    1            THEN
      155     8999    2            DO;

      156     9000    2               LIST_WORK$ = PCB.WORK$;

   9000 12 000235   000002 236000 xsym               LDQ     PCB+2
        12 000236   200023 756100                    STQ     LIST_WORK$,,AUTO

      157     9001    2               LIST_WKSZ = PCB.WKSZ;

   9001 12 000237   000005 235000 xsym               LDA     PCB+5
        12 000240   000022 771000                    ARL     18
        12 000241   200022 755100                    STA     LIST_WKSZ,,AUTO

      158     9002    2               PCB.U$$ = ENTADDR(NIL);

   9002 12 000242   000002 236000 xsym               LDQ     B_VECTNIL+2
        12 000243   000004 756000 xsym               STQ     PCB+4

      159     9003    2   LISTSTD_L:
      160     9004    2               CALL M$READ(FPT_READ_STD) ALTRET(STD_READ_ALT);

   9004 12 000244   000000 630400 xsym  LISTSTD_L    EPPR0   FPT_READ_STD
        12 000245   440000 713400                    CLIMB   alt,read
        12 000246   401400 401760                    pmme    nvectors=4
        12 000247   001365 702000 12                 TSX2    STD_READ_ALT

      161     9005    2               PCB.NCHARS = M$STD1$->F$DCB.ARS;

   9005 12 000250   000000 470400 xsym               LDP0    M$STD1$
        12 000251   000000 235100                    LDA     0,,PR0
        12 000252   000011 755000 xsym               STA     PCB+9

      162     9006    2               PCB.ROOT$ = ADDR(TOP_STD_N);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:36   

   9006 12 000253   000000 236000 13                 LDQ     0
        12 000254   000001 756000 xsym               STQ     PCB+1

      163     9007    2               PCB.WORK$ = LIST_WORK$;

   9007 12 000255   200023 236100                    LDQ     LIST_WORK$,,AUTO
        12 000256   000002 756000 xsym               STQ     PCB+2

      164     9008    2               PCB.WKSZ = LIST_WKSZ;

   9008 12 000257   200022 720100                    LXL0    LIST_WKSZ,,AUTO
        12 000260   000005 740000 xsym               STX0    PCB+5

      165     9009    2               CALL X$PARSE(PCB) ALTRET(STD_PARSE_ALT);

   9009 12 000261   000001 630400 13                 EPPR0   1
        12 000262   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000263   000000 701000 xent               TSX1    X$PARSE
        12 000264   001377 702000 12                 TSX2    STD_PARSE_ALT

      166     9010    2               SOURCELIST$ = PCB.OUT$;

   9010 12 000265   000003 236000 xsym               LDQ     PCB+3
        12 000266   200016 756100                    STQ     SOURCELIST$,,AUTO

      167     9011    2               END;

      168     9012    1           IF CMD_MASK & '000100002'O      /* IF REVIEW OR REVIEWSTD             */

   9012 12 000267   000044 235000 10                 LDA     DELETED_BUF+7
        12 000270   000000 236003                    LDQ     0,DU
        12 000271   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 000272   000100 100400                    MLR     fill='000'O
        12 000273   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000274   200172 000010                    ADSC9   NUMRECS+4,,AUTO          cn=0,n=8
        12 000275   200172 237100                    LDAQ    NUMRECS+4,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:37   
        12 000276   200170 377100                    ANAQ    NUMRECS+2,,AUTO
        12 000277   000320 600000 12                 TZE     s:9020

      169     9013    1            THEN
      170     9014    2            DO;

      171     9015    2               PCB.U$$ = ENTADDR(NIL);

   9015 12 000300   000002 236000 xsym               LDQ     B_VECTNIL+2
        12 000301   000004 756000 xsym               STQ     PCB+4

      172     9016    2               PCB.WORK$ = PINCRW(PCB.WORK$,PCB.WK_USED);

   9016 12 000302   000010 236000 xsym               LDQ     PCB+8
        12 000303   777777 376003                    ANQ     -1,DU
        12 000304   000002 036000 xsym               ADLQ    PCB+2
        12 000305   000002 756000 xsym               STQ     PCB+2

      173     9017    2               PCB.WKSZ = PCB.WKSZ-PCB.WK_USED;

   9017 12 000306   000010 235000 xsym               LDA     PCB+8
        12 000307   000022 771000                    ARL     18
        12 000310   200170 755100                    STA     NUMRECS+2,,AUTO
        12 000311   000005 236000 xsym               LDQ     PCB+5
        12 000312   000022 772000                    QRL     18
        12 000313   200170 136100                    SBLQ    NUMRECS+2,,AUTO
        12 000314   000000 620006                    EAX0    0,QL
        12 000315   000005 740000 xsym               STX0    PCB+5

      174     9018    2               PCB.ROOT$ = ADDR(TOP_REVIEW_CMD);

   9018 12 000316   000002 236000 13                 LDQ     2
        12 000317   000001 756000 xsym               STQ     PCB+1

      175     9019    2               END;

      176     9020    1           CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,SOURCELIST$);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:38   

   9020 12 000320   200016 630500                    EPPR0   SOURCELIST$,,AUTO
        12 000321   200171 450500                    STP0    NUMRECS+3,,AUTO
        12 000322   200006 631500                    EPPR1   NEXT_SPEC_RET_VAL,,AUTO
        12 000323   200170 451500                    STP1    NUMRECS+2,,AUTO
        12 000324   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000325   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000326   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        12 000327   000000 011000                    NOP     0

      177     9021    2           DO WHILE(NEXT_SPEC_RET_VAL~=1);

   9021 12 000330   200006 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        12 000331   000001 115007                    CMPA    1,DL
        12 000332   001064 600000 12                 TZE     s:9164

      178     9022                                                /* WHILE new SOURCELIST remains       */
      179     9023    2              IF NEXT_SPEC_RET_VAL=0       /* IF ALL FINE...                     */

   9023 12 000333   200006 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        12 000334   001053 601000 12                 TNZ     NEXT_SPEC

      180     9024    2               THEN
      181     9025    3               DO;

      182     9026    3                  CALL GET_CLIST_CODE_AND_COLS;

   9026 12 000335   001415 701000 12                 TSX1    GET_CLIST_CODE_AND_COLS
        12 000336   000000 011000                    NOP     0

      183     9027    3                  IF (CLIST_CODE>2) OR (CMD_MASK & '000100002'O)

   9027 12 000337   200017 235100                    LDA     CLIST_CODE,,AUTO
        12 000340   000002 115007                    CMPA    2,DL
        12 000341   000354 605400 12                 TPNZ    s:9029
        12 000342   000044 236000 10                 LDQ     DELETED_BUF+7
        12 000343   000044 737000                    LLS     36
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:39   
        12 000344   000000 236003                    LDQ     0,DU
        12 000345   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 000346   000100 100400                    MLR     fill='000'O
        12 000347   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000350   200172 000010                    ADSC9   NUMRECS+4,,AUTO          cn=0,n=8
        12 000351   200172 237100                    LDAQ    NUMRECS+4,,AUTO
        12 000352   200170 377100                    ANAQ    NUMRECS+2,,AUTO
        12 000353   000365 600000 12                 TZE     s:9032

      184     9028    3                   THEN
      185     9029    3                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,4);

   9029 12 000354   000003 236000 13                 LDQ     3
        12 000355   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 000356   200007 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        12 000357   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 000360   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000361   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000362   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        12 000363   000000 011000                    NOP     0
        12 000364   000375 710000 12                 TRA     s:9035

      186     9030                                                /* OPEN WITH FPARAM                   */
      187     9031    3                   ELSE
      188     9032    3                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,2);

   9032 12 000365   000004 236000 13                 LDQ     4
        12 000366   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 000367   200007 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        12 000370   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 000371   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000372   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000373   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        12 000374   000000 011000                    NOP     0

      189     9033                                                /* OPEN WITH FPARAM ONLY IF           */
      190     9034                                                /* NEEDED FOR FILE SELECTION          */
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:40   
      191     9035    4                  DO WHILE(OPEN_NEXT_RET_VAL~=%VPOC_EXHAUSTED#);

   9035 12 000375   200007 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        12 000376   000001 115007                    CMPA    1,DL
        12 000377   001053 600000 12                 TZE     NEXT_SPEC

      192     9036    4                     IF CLIST_CODE>2

   9036 12 000400   200017 235100                    LDA     CLIST_CODE,,AUTO
        12 000401   000002 115007                    CMPA    2,DL
        12 000402   000411 604400 12                 TMOZ    s:9041
        12 000403   200007 236100                    LDQ     OPEN_NEXT_RET_VAL,,AUTO
        12 000404   000002 116007                    CMPQ    2,DL
        12 000405   000411 601000 12                 TNZ     s:9041

      193     9037    4                       AND OPEN_NEXT_RET_VAL=%VPOC_NOACCESS#
      194     9038    4                      THEN                 /* Access denied                      */
      195     9039    4                        LIST_CODE = 2;

   9039 12 000406   000002 235007                    LDA     2,DL
        12 000407   200020 755100                    STA     LIST_CODE,,AUTO
        12 000410   000412 710000 12                 TRA     s:9042

      196     9040    4                      ELSE
      197     9041    4                        LIST_CODE = CLIST_CODE;

   9041 12 000411   200020 755100                    STA     LIST_CODE,,AUTO

      198     9042    4                     IF OPEN_NEXT_RET_VAL = %VPOC_GOTFILE#

   9042 12 000412   200007 236100                    LDQ     OPEN_NEXT_RET_VAL,,AUTO
        12 000413   000451 601000 12                 TNZ     NO_GRANS
        12 000414   000171 236000 xsym               LDQ     ICB+121
        12 000415   777000 376003                    ANQ     -512,DU
        12 000416   100000 116003                    CMPQ    32768,DU
        12 000417   000451 600000 12                 TZE     NO_GRANS
        12 000420   000002 115007                    CMPA    2,DL
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:41   
        12 000421   000451 604400 12                 TMOZ    NO_GRANS

      199     9043    4                       AND ICB.DEV_MASK ~= '100'O /* AND not LT                  */
      200     9044    4                       AND LIST_CODE > 2   /* AND attributes                     */
      201     9045    4                      THEN                 /* Tally GRANS                        */
      202     9046    5                      DO;

      203     9047    5                         PTR$ = ADDR(FPARAM_BUF);

   9047 12 000422   000005 236000 13                 LDQ     5
        12 000423   200013 756100                    STQ     PTR$,,AUTO

      204     9048    5                         CALL XSF$LOCCODP(PTR$,3) ALTRET(NO_GRANS);

   9048 12 000424   000006 236000 13                 LDQ     6
        12 000425   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 000426   200013 630500                    EPPR0   PTR$,,AUTO
        12 000427   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 000430   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000431   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000432   000000 701000 xent               TSX1    XSF$LOCCODP
        12 000433   000451 702000 12                 TSX2    NO_GRANS

      205     9049    5                         CUR_GRANS = PTR$->CODE03.UGRANS+PTR$->CODE03.NGAVAL;

   9049 12 000434   200013 470500                    LDP0    PTR$,,AUTO
        12 000435   000003 236100                    LDQ     3,,PR0
        12 000436   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 000437   200170 756100                    STQ     NUMRECS+2,,AUTO
        12 000440   000000 236100                    LDQ     0,,PR0
        12 000441   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 000442   200170 036100                    ADLQ    NUMRECS+2,,AUTO
        12 000443   200021 756100                    STQ     CUR_GRANS,,AUTO

      206     9050    5                         TOT_GRANS(2) = TOT_GRANS(2) + CUR_GRANS;

   9050 12 000444   000002 036000 xsym               ADLQ    TOT_GRANS+2
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:42   
        12 000445   000002 756000 xsym               STQ     TOT_GRANS+2

      207     9051    5                         TOT_RECS=TOT_RECS+PTR$->CODE03.NRECS;

   9051 12 000446   000000 236000 xsym               LDQ     TOT_RECS
        12 000447   000002 036100                    ADLQ    2,,PR0
        12 000450   000000 756000 xsym               STQ     TOT_RECS

      208     9052    5                         END;

   9050 12 000451                       NO_GRANS     null
      209     9053    4   NO_GRANS:         ;
      210     9054    4                     TOT_FILES(2) = TOT_FILES(2) +1;

   9054 12 000451   000002 054000 xsym               AOS     TOT_FILES+2

   9054 12 000452                       RELIST       null
      211     9055    4   RELIST:           ;
      212     9056    4                     CALL VPH$GET_LIST_BUFS(LIST_CODE);

   9056 12 000452   200020 630500                    EPPR0   LIST_CODE,,AUTO
        12 000453   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 000454   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000455   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000456   000000 701000 xent               TSX1    VPH$GET_LIST_BUFS
        12 000457   000000 011000                    NOP     0

      213     9057    4                     IF TOT_FILES(2) = 1   /* Before printing the first FID      */

   9057 12 000460   000002 235000 xsym               LDA     TOT_FILES+2
        12 000461   000001 115007                    CMPA    1,DL
        12 000462   000505 601000 12                 TNZ     s:9066
        12 000463   000000 470400 xsym               LDP0    M$EO1$
        12 000464   000004 236100                    LDQ     4,,PR0
        12 000465   000024 736000                    QLS     20
        12 000466   400000 376003                    ANQ     -131072,DU
        12 000467   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:43   
        12 000470   000505 600000 12                 TZE     s:9066
        12 000471   000000 471400 xsym               LDP1    B$JIT$
        12 000472   100000 236100                    LDQ     0,,PR1
        12 000473   740000 376003                    ANQ     -16384,DU
        12 000474   140000 116003                    CMPQ    49152,DU
        12 000475   000505 601000 12                 TNZ     s:9066

      214     9058    4                       AND ~M$EO1$ -> F$DCB.DDEV.IC /* and output isn't terminal */
      215     9059    4                       AND B$JIT$ -> B$JIT.MODE = %M_INT#
      216     9060    4                      THEN                 /* Put out the listing message        */
      217     9061    5                      DO;

      218     9062    5                         FPT_WRITE_ME.BUF_ = VECTOR(LIS_MSG);

   9062 12 000476   000010 237000 13                 LDAQ    8
        12 000477   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      219     9063    5                         FPT_WRITE_ME.V.DVBYTE.VFC# = %NO#;

   9063 12 000500   000012 236000 13                 LDQ     10
        12 000501   000013 356000 xsym               ANSQ    FPT_WRITE_ME+11

      220     9064    5                         CALL M$WRITE(FPT_WRITE_ME);

   9064 12 000502   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000503   040001 713400                    CLIMB   write
        12 000504   401400 401760                    pmme    nvectors=4

      221     9065    5                         END;

      222     9066    4                     IF LIST_CODE ~= 1

   9066 12 000505   200020 235100                    LDA     LIST_CODE,,AUTO
        12 000506   000001 115007                    CMPA    1,DL
        12 000507   000525 600000 12                 TZE     s:9078

      223     9067    4                      THEN                 /* L(A) or better, may need header    */
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:44   
      224     9068    5                      DO;

      225     9069    5                         IF LIST_HDR_OUT ~= ICB.DEV_MASK

   9069 12 000510   200005 236100                    LDQ     LIST_HDR_OUT,,AUTO
        12 000511   000171 676000 xsym               ERQ     ICB+121
        12 000512   777000 376003                    ANQ     -512,DU
        12 000513   000526 600000 12                 TZE     s:9079

      226     9070    5                          THEN             /* New input device, make new header  */
      227     9071    6                          DO;

      228     9072    6                             CALL VPD$FINISH_NLIST; /* Finish any prev no attr L */

   9072 12 000514   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 000515   000000 701000 xent               TSX1    VPD$FINISH_NLIST
        12 000516   000000 011000                    NOP     0

      229     9073    6                             CALL OUT_LIST_HDR; /* Print new header              */

   9073 12 000517   001462 701000 12                 TSX1    OUT_LIST_HDR
        12 000520   000000 011000                    NOP     0

      230     9074    6                             LIST_HDR_OUT = ICB.DEV_MASK;

   9074 12 000521   000171 236000 xsym               LDQ     ICB+121
        12 000522   777000 376003                    ANQ     -512,DU
        12 000523   200005 756100                    STQ     LIST_HDR_OUT,,AUTO

      231     9075    6                             END;

      232     9076    5                         END;

   9076 12 000524   000526 710000 12                 TRA     s:9079

      233     9077    4                      ELSE                 /* No attribute LIST                  */
      234     9078    4                        LIST_HDR_OUT = '0'B; /* Insure header next L(A) or better */
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:45   

   9078 12 000525   200005 450100                    STZ     LIST_HDR_OUT,,AUTO

      235     9079    4                     IF LIST_CODE~=1 OR (CMD_MASK & '000100002'O)

   9079 12 000526   200020 235100                    LDA     LIST_CODE,,AUTO
        12 000527   000001 115007                    CMPA    1,DL
        12 000530   000543 601000 12                 TNZ     s:9082
        12 000531   000044 236000 10                 LDQ     DELETED_BUF+7
        12 000532   000044 737000                    LLS     36
        12 000533   000000 236003                    LDQ     0,DU
        12 000534   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 000535   000100 100400                    MLR     fill='000'O
        12 000536   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000537   200172 000010                    ADSC9   NUMRECS+4,,AUTO          cn=0,n=8
        12 000540   200172 237100                    LDAQ    NUMRECS+4,,AUTO
        12 000541   200170 377100                    ANAQ    NUMRECS+2,,AUTO
        12 000542   000673 600000 12                 TZE     s:9107

      236     9080    4                      THEN
      237     9081    5                      DO;

      238     9082    5                         PTR$ = ADDR(BUF_BLOCK.BUF_1);

   9082 12 000543   000000 236000 xsym               LDQ     LIST_BUF$
        12 000544   000001 036003                    ADLQ    1,DU
        12 000545   200013 756100                    STQ     PTR$,,AUTO

      239     9083    6                         DO I=1 TO BUF_BLOCK.COUNT;

   9083 12 000546   000001 235007                    LDA     1,DL
        12 000547   200010 755100                    STA     I,,AUTO
        12 000550   000662 710000 12                 TRA     s:9101+1

      240     9084    6                            IF I=BUF_BLOCK.COUNT AND (CMD_MASK & '000100002'O)

   9084 12 000551   000000 470400 xsym               LDP0    LIST_BUF$
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:46   
        12 000552   200010 236100                    LDQ     I,,AUTO
        12 000553   000000 116100                    CMPQ    0,,PR0
        12 000554   000575 601000 12                 TNZ     s:9092
        12 000555   000044 235000 10                 LDA     DELETED_BUF+7
        12 000556   000000 236003                    LDQ     0,DU
        12 000557   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 000560   000100 100400                    MLR     fill='000'O
        12 000561   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000562   200172 000010                    ADSC9   NUMRECS+4,,AUTO          cn=0,n=8
        12 000563   200172 237100                    LDAQ    NUMRECS+4,,AUTO
        12 000564   200170 377100                    ANAQ    NUMRECS+2,,AUTO
        12 000565   000575 600000 12                 TZE     s:9092

      241     9085    6                             THEN
      242     9086    7                             DO;

      243     9087    7                                EXTEND.LEN = 1;

   9087 12 000566   001000 236003                    LDQ     512,DU
        12 000567   000000 552040 11                 STBQ    EXTEND,'40'O

      244     9088    7                                OCB.VFC = 2;

   9088 12 000570   000024 236000 xsym               LDQ     OCB+20
        12 000571   000013 376000 13                 ANQ     11
        12 000572   400000 276003                    ORQ     -131072,DU
        12 000573   000024 756000 xsym               STQ     OCB+20

      245     9089    7                                END;

   9089 12 000574   000601 710000 12                 TRA     s:9095

      246     9090    6                             ELSE
      247     9091    7                             DO;

      248     9092    7                                EXTEND.LEN = 0;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:47   
   9092 12 000575   000000 236003                    LDQ     0,DU
        12 000576   000000 552040 11                 STBQ    EXTEND,'40'O

      249     9093    7                                OCB.VFC = 0;

   9093 12 000577   000013 236000 13                 LDQ     11
        12 000600   000024 356000 xsym               ANSQ    OCB+20

      250     9094    7                                END;

      251     9095    6                            CALL CONCAT(IN_BUF_VECTOR.PTR$->CHAR$132,

   9095 12 000601   000000 236000 11                 LDQ     EXTEND
        12 000602   000033 772000                    QRL     27
        12 000603   200013 471500                    LDP1    PTR$,,AUTO
        12 000604   000100 101500                    MRL     fill='000'O
        12 000605   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000606   200170 000002                    ADSC9   NUMRECS+2,,AUTO          cn=0,n=2
        12 000607   200170 220100                    LDX0    NUMRECS+2,,AUTO
        12 000610   000000 621006                    EAX1    0,QL
        12 000611   000001 473400 xsym               LDP3    IN_BUF_VECTOR+1
        12 000612   040100 100440                    MLR     fill='040'O
        12 000613   000000 200011 11                 ADSC9   EXTEND                   cn=1,n=*X1
        12 000614   300000 000204                    ADSC9   0,,PR3                   cn=0,n=132
        12 000615   000204 116007                    CMPQ    132,DL
        12 000616   000626 603000 12                 TRC     s:9098
        12 000617   777573 621006                    EAX1    -133,QL
        12 000620   777777 661003                    ERX1    -1,DU
        12 000621   200013 470500                    LDP0    PTR$,,AUTO
        12 000622   000001 471400 xsym               LDP1    IN_BUF_VECTOR+1
        12 000623   040146 100540                    MLR     fill='040'O
        12 000624   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 000625   100000 000011                    ADSC9   0,Q,PR1                  cn=0,n=*X1

      252     9096    6                              ADDR(EXTEND)->TEXT$C.STRING,
      253     9097    6                              PTR$->TEXT$C.STRING);
      254     9098    6                            TEMP = PTR$->TEXT$C.LEN + EXTEND.LEN;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:48   

   9098 12 000626   000000 236000 11                 LDQ     EXTEND
        12 000627   000033 772000                    QRL     27
        12 000630   200170 756100                    STQ     NUMRECS+2,,AUTO
        12 000631   200013 470500                    LDP0    PTR$,,AUTO
        12 000632   000100 101500                    MRL     fill='000'O
        12 000633   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000634   200171 000004                    ADSC9   NUMRECS+3,,AUTO          cn=0,n=4
        12 000635   200171 236100                    LDQ     NUMRECS+3,,AUTO
        12 000636   200170 036100                    ADLQ    NUMRECS+2,,AUTO
        12 000637   200067 756100                    STQ     TEMP,,AUTO

      255     9099    6                            CALL VPG$WRITE_OUT(TEMP,0);

   9099 12 000640   000014 236000 13                 LDQ     12
        12 000641   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 000642   200067 631500                    EPPR1   TEMP,,AUTO
        12 000643   200170 451500                    STP1    NUMRECS+2,,AUTO
        12 000644   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 000645   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000646   000000 701000 xent               TSX1    VPG$WRITE_OUT
        12 000647   000000 011000                    NOP     0

      256     9100    6                            PTR$ = PINCRC(PTR$,PTR$->TEXT$C.LEN+1);

   9100 12 000650   200013 470500                    LDP0    PTR$,,AUTO
        12 000651   000100 101500                    MRL     fill='000'O
        12 000652   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000653   200170 000004                    ADSC9   NUMRECS+2,,AUTO          cn=0,n=4
        12 000654   200170 236100                    LDQ     NUMRECS+2,,AUTO
        12 000655   000020 736000                    QLS     16
        12 000656   200000 036007                    ADLQ    65536,DL
        12 000657   200013 036100                    ADLQ    PTR$,,AUTO
        12 000660   200013 756100                    STQ     PTR$,,AUTO

      257     9101    6                            END;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:49   
   9101 12 000661   200010 054100                    AOS     I,,AUTO
        12 000662   000000 470400 xsym               LDP0    LIST_BUF$
        12 000663   200010 236100                    LDQ     I,,AUTO
        12 000664   000000 116100                    CMPQ    0,,PR0
        12 000665   000551 604400 12                 TMOZ    s:9084

      258     9102    5                         EXTEND.LEN = 0;

   9102 12 000666   000000 236003                    LDQ     0,DU
        12 000667   000000 552040 11                 STBQ    EXTEND,'40'O

      259     9103    5                         OCB.VFC = 0;

   9103 12 000670   000013 236000 13                 LDQ     11
        12 000671   000024 356000 xsym               ANSQ    OCB+20

      260     9104    5                         END;

   9104 12 000672   000736 710000 12                 TRA     s:9120

      261     9105    4                      ELSE
      262     9106    5                      DO;

      263     9107    5                         TEMP = ((LIST_IDX+ICB.COLS)/ICB.COLS)*ICB.COLS;

   9107 12 000673   000000 236000 xsym               LDQ     LIST_IDX
        12 000674   000016 036000 xsym               ADLQ    ICB+14
        12 000675   000016 506000 xsym               DIV     ICB+14
        12 000676   000016 402000 xsym               MPY     ICB+14
        12 000677   200067 756100                    STQ     TEMP,,AUTO

      264     9108    5                         IF TEMP+BUF_BLOCK.BUF_1.LEN>USABLE_LEN AND LIST_IDX>0

   9108 12 000700   000000 470400 xsym               LDP0    LIST_BUF$
        12 000701   000001 236100                    LDQ     1,,PR0
        12 000702   000033 772000                    QRL     27
        12 000703   200067 036100                    ADLQ    TEMP,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:50   
        12 000704   000000 116000 xsym               CMPQ    USABLE_LEN
        12 000705   000716 604400 12                 TMOZ    s:9115
        12 000706   000000 235000 xsym               LDA     LIST_IDX
        12 000707   000716 604400 12                 TMOZ    s:9115

      265     9109    5                          THEN
      266     9110    6                          DO;

      267     9111    6                             CALL VPG$WRITE_OUT(LIST_IDX,0);

   9111 12 000710   000015 630400 13                 EPPR0   13
        12 000711   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000712   000000 701000 xent               TSX1    VPG$WRITE_OUT
        12 000713   000000 011000                    NOP     0

      268     9112    6                             LIST_IDX = 0;

   9112 12 000714   000000 450000 xsym               STZ     LIST_IDX

      269     9113    6                             END;

   9113 12 000715   000720 710000 12                 TRA     s:9116

      270     9114    5                          ELSE
      271     9115    5                            LIST_IDX = TEMP;

   9115 12 000716   200067 235100                    LDA     TEMP,,AUTO
        12 000717   000000 755000 xsym               STA     LIST_IDX

      272     9116    5                         PINCRC(IN_BUF_VECTOR.PTR$,LIST_IDX)->CHAR$132 =

   9116 12 000720   000000 470400 xsym               LDP0    LIST_BUF$
        12 000721   000001 236100                    LDQ     1,,PR0
        12 000722   000033 772000                    QRL     27
        12 000723   000000 620006                    EAX0    0,QL
        12 000724   000001 471400 xsym               LDP1    IN_BUF_VECTOR+1
        12 000725   000000 235000 xsym               LDA     LIST_IDX
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:51   
        12 000726   040105 100540                    MLR     fill='040'O
        12 000727   000001 200010                    ADSC9   1,,PR0                   cn=1,n=*X0
        12 000730   100000 000204                    ADSC9   0,A,PR1                  cn=0,n=132

      273     9117    5                           ADDR(BUF_BLOCK.BUF_1)->TEXT$C.STRING;
      274     9118    5                         LIST_IDX = LIST_IDX+BUF_BLOCK.BUF_1.LEN;

   9118 12 000731   000000 470400 xsym               LDP0    LIST_BUF$
        12 000732   000001 236100                    LDQ     1,,PR0
        12 000733   000033 772000                    QRL     27
        12 000734   000000 036000 xsym               ADLQ    LIST_IDX
        12 000735   000000 756000 xsym               STQ     LIST_IDX

      275     9119    5                         END;

      276     9120    4                     IF (CMD_MASK & '000100002'O)

   9120 12 000736   000044 235000 10                 LDA     DELETED_BUF+7
        12 000737   000000 236003                    LDQ     0,DU
        12 000740   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 000741   000100 100400                    MLR     fill='000'O
        12 000742   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 000743   200172 000010                    ADSC9   NUMRECS+4,,AUTO          cn=0,n=8
        12 000744   200172 237100                    LDAQ    NUMRECS+4,,AUTO
        12 000745   200170 377100                    ANAQ    NUMRECS+2,,AUTO
        12 000746   001014 600000 12                 TZE     NEXT_FILE

      277     9121    5                      THEN DO;             /* A REVIEW type command              */

      278     9122    5                         REMEMBER REV_BRK IN BREAK_LOC; /* Must skip promt fid if */

   9122 12 000747   000776 635000 12                 EAA     REV_BRK
        12 000750   000000 452400 xsym               STP2    BREAK_LOC
        12 000751   000001 755000 xsym               STA     BREAK_LOC+1

      279     9123                                                /* break after fid printed            */
      280     9124    5                         CALL REVIEW_CHK(REV_RET_VAL);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:52   

   9124 12 000752   200024 631500                    EPPR1   REV_RET_VAL,,AUTO
        12 000753   200071 451500                    STP1    TEMP+2,,AUTO
        12 000754   001543 701000 12                 TSX1    REVIEW_CHK
        12 000755   000000 011000                    NOP     0

      281     9125    5                         REMEMBER SUMMARY IN BREAK_LOC; /* Just summary if break */

   9125 12 000756   001110 635000 12                 EAA     SUMMARY
        12 000757   000000 452400 xsym               STP2    BREAK_LOC
        12 000760   000001 755000 xsym               STA     BREAK_LOC+1

      282     9126                                                /* occurs elsewhere                   */
      283     9127    6                         DO CASE(REV_RET_VAL);

   9127 12 000761   200024 236100                    LDQ     REV_RET_VAL,,AUTO
        12 000762   000004 116007                    CMPQ    4,DL
        12 000763   000765 602006 12                 TNC     s:9127+4,QL
        12 000764   001014 710000 12                 TRA     NEXT_FILE
        12 000765   001014 710000 12                 TRA     NEXT_FILE
        12 000766   000771 710000 12                 TRA     s:9129
        12 000767   000775 710000 12                 TRA     s:9135
        12 000770   001006 710000 12                 TRA     s:9143

      284     9128    6                          CASE(1);         /* JUMP                               */

      285     9129    6                            IF PCB.OUT$->OUT$BLK.NSUBLKS>0

   9129 12 000771   000003 470400 xsym               LDP0    PCB+3
        12 000772   000001 220100                    LDX0    1,,PR0
        12 000773   001035 601000 12                 TNZ     JUMP2

      286     9130    6                             THEN
      287     9131    6                               GOTO JUMP2;
      288     9132    6                             ELSE
      289     9133    6                               GOTO NEXT_SPEC;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:53   
   9133 12 000774   001053 710000 12                 TRA     NEXT_SPEC

      290     9134    6                          CASE(2);         /* END                                */

      291     9135    6                            GOTO SUMMARY;

   9135 12 000775   001110 710000 12                 TRA     SUMMARY

      292     9136    6   REV_BRK:                                /* Skip a line to avoid overprinting  */
      293     9137                                                /* the REV fid we printed             */
      294     9138    6                            FPT_WRITE_ME.BUF_ = VECTOR(CR_LF);

   9138 12 000776   000020 237000 13    REV_BRK      LDAQ    16
        12 000777   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      295     9139    6                            FPT_WRITE_ME.V.DVBYTE.VFC# = %YES#;

   9139 12 001000   100000 236003                    LDQ     32768,DU
        12 001001   000013 256000 xsym               ORSQ    FPT_WRITE_ME+11

      296     9140    6                            CALL M$WRITE(FPT_WRITE_ME);

   9140 12 001002   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 001003   040001 713400                    CLIMB   write
        12 001004   401400 401760                    pmme    nvectors=4

      297     9141    6                            GOTO SUMMARY;

   9141 12 001005   001110 710000 12                 TRA     SUMMARY

      298     9142    6                          CASE(3);         /* RELIST                             */

      299     9143    6                            IF OPEN_NEXT_RET_VAL=%VPOC_NOACCESS#

   9143 12 001006   200007 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        12 001007   000002 115007                    CMPA    2,DL
        12 001010   001013 601000 12                 TNZ     s:9146
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:54   

      300     9144    6                             THEN          /* Access denied                      */
      301     9145    6                               LIST_CODE = 2;

   9145 12 001011   000002 235007                    LDA     2,DL
        12 001012   200020 755100                    STA     LIST_CODE,,AUTO

      302     9146    6                            GOTO RELIST;

   9146 12 001013   000452 710000 12                 TRA     RELIST

      303     9147    6                          END;             /* END CASE                           */

      304     9148    5                         END;

      305     9149    4   NEXT_FILE:
      306     9150    4                     IF M$EI$->F$DCB.FCD

   9150 12 001014   000000 470400 xsym  NEXT_FILE    LDP0    M$EI$
        12 001015   000031 236100                    LDQ     25,,PR0
        12 001016   020000 316007                    CANQ    8192,DL
        12 001017   001023 600000 12                 TZE     s:9153

      307     9151    4                      THEN
      308     9152    4                        CALL M$CLOSE(FPT_CLOSE_EI);

   9152 12 001020   000000 630400 xsym               EPPR0   FPT_CLOSE_EI
        12 001021   050001 713400                    CLIMB   close
        12 001022   406000 401760                    pmme    nvectors=13

      309     9153    4                     THIS_STD_FILE = '0'B;

   9153 12 001023   000000 450000 xsym               STZ     THIS_STD_FILE

      310     9154    4                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);

   9154 12 001024   000022 236000 13                 LDQ     18
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:55   
        12 001025   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 001026   200007 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        12 001027   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 001030   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001031   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001032   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        12 001033   000000 011000                    NOP     0

      311     9155    4                     GOTO AROUND_1;

   9155 12 001034   001050 710000 12                 TRA     AROUND_1

      312     9156    4   JUMP2:            CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,3,

   9156 12 001035   000003 471500       JUMP2        LDP1    3,,PR0
        12 001036   100003 473500                    LDP3    3,,PR1
        12 001037   200172 453500                    STP3    NUMRECS+4,,AUTO
        12 001040   000006 236000 13                 LDQ     6
        12 001041   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 001042   200007 631500                    EPPR1   OPEN_NEXT_RET_VAL,,AUTO
        12 001043   200170 451500                    STP1    NUMRECS+2,,AUTO
        12 001044   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001045   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001046   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        12 001047   000000 011000                    NOP     0

      313     9157    4                       PCB.OUT$->OUT$BLK.SUBLK$(0)->
      314     9158    4                       OUT$SYM.TEXTC$->TEXT$C);
      315     9159    4   AROUND_1:         END;                  /* END WHILE                          */

   9159 12 001050   200007 235100       AROUND_1     LDA     OPEN_NEXT_RET_VAL,,AUTO
        12 001051   000001 115007                    CMPA    1,DL
        12 001052   000400 601000 12                 TNZ     s:9036

      316     9160    3                  END;

      317     9161    2   NEXT_SPEC:
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:56   
      318     9162    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);

   9162 12 001053   200006 630500       NEXT_SPEC    EPPR0   NEXT_SPEC_RET_VAL,,AUTO
        12 001054   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 001055   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001056   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001057   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        12 001060   000000 011000                    NOP     0

      319     9163    2              END;                         /* END WHILE                          */

   9163 12 001061   200006 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        12 001062   000001 115007                    CMPA    1,DL
        12 001063   000333 601000 12                 TNZ     s:9023

      320     9164    1           IF (CMD_MASK & '000200002'O/* LISTSTD or REVIEWSTD*/)~='0'B

   9164 12 001064   000043 236000 10                 LDQ     DELETED_BUF+6
        12 001065   000044 737000                    LLS     36
        12 001066   000000 236003                    LDQ     0,DU
        12 001067   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 001070   000100 100400                    MLR     fill='000'O
        12 001071   000000 000010 xsym               ADSC9   CMD_MASK                 cn=0,n=8
        12 001072   200172 000010                    ADSC9   NUMRECS+4,,AUTO          cn=0,n=8
        12 001073   200172 237100                    LDAQ    NUMRECS+4,,AUTO
        12 001074   200170 377100                    ANAQ    NUMRECS+2,,AUTO
        12 001075   000244 601000 12                 TNZ     LISTSTD_L

      321     9165    1            THEN
      322     9166    1              GOTO LISTSTD_L;
      323     9167        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:57   
      324     9168    1   FIN_LIST:
      325     9169    1           IF M$EI$ -> F$DCB.FCD           /* still open 'cause break was hit    */

   9169 12 001076   000000 470400 xsym  FIN_LIST     LDP0    M$EI$
        12 001077   000031 236100                    LDQ     25,,PR0
        12 001100   020000 316007                    CANQ    8192,DL
        12 001101   001105 600000 12                 TZE     s:9172

      326     9170    1            THEN
      327     9171    1              CALL M$CLOSE (FPT_CLOSE_EI);

   9171 12 001102   000000 630400 xsym               EPPR0   FPT_CLOSE_EI
        12 001103   050001 713400                    CLIMB   close
        12 001104   406000 401760                    pmme    nvectors=13

      328     9172    1           CALL VPD$FINISH_NLIST;          /* Finish any partial LIST line       */

   9172 12 001105   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 001106   000000 701000 xent               TSX1    VPD$FINISH_NLIST
        12 001107   000000 011000                    NOP     0

      329     9173    1   SUMMARY:
      330     9174    1           REMEMBER LIST_ABORT IN ABORT_STEP;

   9174 12 001110   001324 635000 12    SUMMARY      EAA     LIST_ABORT
        12 001111   000000 452400 xsym               STP2    ABORT_STEP
        12 001112   000001 755000 xsym               STA     ABORT_STEP+1

      331     9175    1           REMEMBER LIST_ABORT IN BREAK_LOC;

   9175 12 001113   001324 635000 12                 EAA     LIST_ABORT
        12 001114   000000 452400 xsym               STP2    BREAK_LOC
        12 001115   000001 755000 xsym               STA     BREAK_LOC+1

      332     9176    1           IF ((TOT_FILES(2) > 1           /* IF more than one file was listed   */

   9176 12 001116   000002 236000 xsym               LDQ     TOT_FILES+2
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:58   
        12 001117   000001 116007                    CMPQ    1,DL
        12 001120   001123 605400 12                 TPNZ    s:9176+5
        12 001121   000001 235000 xsym               LDA     TOT_FILES+1
        12 001122   001125 604400 12                 TMOZ    s:9176+7
        12 001123   000271 235000 xsym               LDA     OCB+185
        12 001124   001132 600000 12                 TZE     s:9183
        12 001125   000271 235000 xsym               LDA     OCB+185
        12 001126   000001 115007                    CMPA    1,DL
        12 001127   001312 601000 12                 TNZ     s:9213
        12 001130   000002 115007                    CMPA    2,DL
        12 001131   001312 600000 12                 TZE     s:9213

      333     9177    1             OR TOT_FILES(1) > 0)          /* OR anything was deleted            */
      334     9178    1             AND OCB.SUMMARY = 0)          /* And user didnt say anything        */
      335     9179    1             OR OCB.SUMMARY = 1            /* or SUMMARY specified               */
      336     9180    1             AND OCB.SUMMARY ~= 2          /* unless NSUMMARY specified          */
      337     9181    1            THEN                           /* A summary is in order              */
      338     9182    2            DO;

      339     9183    2               SUM_LINE_TEXT = '..';

   9183 12 001132   040100 100400                    MLR     fill='040'O
        12 001133   000045 000002 10                 ADSC9   DELETED_BUF+8            cn=0,n=2
        12 001134   200026 000204                    ADSC9   SUM_LINE_TEXT,,AUTO      cn=0,n=132

      340     9184    2               CALL BINCHAR(SUM_LINE.FILES,TOT_FILES(2));

   9184 12 001135   000100 301400                    BTD
        12 001136   000002 000004 xsym               NDSC9   TOT_FILES+2              cn=0,s=lsgnf,sf=0,n=4
        12 001137   200026 430005                    NDSC9   SUM_LINE_TEXT,,AUTO      cn=2,s=nosgn,sf=0,n=5

      341     9185    2               CALL VPD$CLOBBERLZ(VECTOR(SUM_LINE.FILES));

   9185 12 001140   000023 235000 13                 LDA     19
        12 001141   200170 452500                    STP2    NUMRECS+2,,AUTO
        12 001142   200170 236100                    LDQ     NUMRECS+2,,AUTO
        12 001143   000024 036000 13                 ADLQ    20
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:59   
        12 001144   200172 757100                    STAQ    NUMRECS+4,,AUTO
        12 001145   200172 630500                    EPPR0   NUMRECS+4,,AUTO
        12 001146   200174 450500                    STP0    NUMRECS+6,,AUTO
        12 001147   200174 630500                    EPPR0   NUMRECS+6,,AUTO
        12 001150   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001151   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 001152   000000 011000                    NOP     0

      342     9186    2               IF TOT_GRANS(2)>0

   9186 12 001153   000002 235000 xsym               LDA     TOT_GRANS+2
        12 001154   001217 604400 12                 TMOZ    s:9196

      343     9187    3                THEN DO;

      344     9188    3                   SUM_IDX = 53;

   9188 12 001155   000065 236007                    LDQ     53,DL
        12 001156   200025 756100                    STQ     SUM_IDX,,AUTO

      345     9189    3                   SUM_LINE.REST = ' files,       granules,         records listed';

   9189 12 001157   040100 100400                    MLR     fill='040'O
        12 001160   000046 000056 10                 ADSC9   DELETED_BUF+9            cn=0,n=46
        12 001161   200027 600175                    ADSC9   SUM_LINE_TEXT+1,,AUTO    cn=3,n=125

      346     9190    3                   CALL BINCHAR(SUM_LINE.GRANS.GRANS,TOT_GRANS(2));

   9190 12 001162   000100 301400                    BTD
        12 001163   000002 000004 xsym               NDSC9   TOT_GRANS+2              cn=0,s=lsgnf,sf=0,n=4
        12 001164   200031 430006                    NDSC9   SUM_LINE_TEXT+3,,AUTO    cn=2,s=nosgn,sf=0,n=6

      347     9191    3                   CALL VPD$CLOBBERLZ(VECTOR(SUM_LINE.GRANS.GRANS));

   9191 12 001165   000025 235000 13                 LDA     21
        12 001166   200170 452500                    STP2    NUMRECS+2,,AUTO
        12 001167   200170 236100                    LDQ     NUMRECS+2,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:60   
        12 001170   000026 036000 13                 ADLQ    22
        12 001171   200172 757100                    STAQ    NUMRECS+4,,AUTO
        12 001172   200172 630500                    EPPR0   NUMRECS+4,,AUTO
        12 001173   200174 450500                    STP0    NUMRECS+6,,AUTO
        12 001174   200174 630500                    EPPR0   NUMRECS+6,,AUTO
        12 001175   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001176   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 001177   000000 011000                    NOP     0

      348     9192    3                   CALL BINCHAR(SUM_LINE.GRANS.RECS,TOT_RECS);

   9192 12 001200   000100 301400                    BTD
        12 001201   000000 000004 xsym               NDSC9   TOT_RECS                 cn=0,s=lsgnf,sf=0,n=4
        12 001202   200035 430010                    NDSC9   SUM_LINE_TEXT+7,,AUTO    cn=2,s=nosgn,sf=0,n=8

      349     9193    3                   CALL VPD$CLOBBERLZ(VECTOR(SUM_LINE.GRANS.RECS));

   9193 12 001203   000027 235000 13                 LDA     23
        12 001204   200170 452500                    STP2    NUMRECS+2,,AUTO
        12 001205   200170 236100                    LDQ     NUMRECS+2,,AUTO
        12 001206   000030 036000 13                 ADLQ    24
        12 001207   200172 757100                    STAQ    NUMRECS+4,,AUTO
        12 001210   200172 630500                    EPPR0   NUMRECS+4,,AUTO
        12 001211   200174 450500                    STP0    NUMRECS+6,,AUTO
        12 001212   200174 630500                    EPPR0   NUMRECS+6,,AUTO
        12 001213   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001214   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 001215   000000 011000                    NOP     0

      350     9194    3                   END;

   9194 12 001216   001224 710000 12                 TRA     s:9199

      351     9195    3                ELSE DO;

      352     9196    3                   SUM_IDX = 20;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:61   
   9196 12 001217   000024 236007                    LDQ     20,DL
        12 001220   200025 756100                    STQ     SUM_IDX,,AUTO

      353     9197    3                   SUM_LINE.REST = ' files listed';

   9197 12 001221   040100 100400                    MLR     fill='040'O
        12 001222   000062 000015 10                 ADSC9   DELETED_BUF+21           cn=0,n=13
        12 001223   200027 600175                    ADSC9   SUM_LINE_TEXT+1,,AUTO    cn=3,n=125

      354     9198    3                   END;

      355     9199    2               IF TOT_FILES(1)>0           /* IF anything deleted                */

   9199 12 001224   000001 235000 xsym               LDA     TOT_FILES+1
        12 001225   001276 604400 12                 TMOZ    s:9210

      356     9200    2                THEN
      357     9201    3                DO;

      358     9202    3                   PTR$ = PINCRC(ADDR(SUM_LINE_TEXT),SUM_IDX);

   9202 12 001226   200170 452500                    STP2    NUMRECS+2,,AUTO
        12 001227   200025 236100                    LDQ     SUM_IDX,,AUTO
        12 001230   000020 736000                    QLS     16
        12 001231   000026 036003                    ADLQ    22,DU
        12 001232   200170 036100                    ADLQ    NUMRECS+2,,AUTO
        12 001233   200013 756100                    STQ     PTR$,,AUTO

      359     9203    3                   PTR$->DEL_TEXT = ';      files,       granules deleted';

   9203 12 001234   200013 470500                    LDP0    PTR$,,AUTO
        12 001235   040100 100400                    MLR     fill='040'O
        12 001236   000066 000044 10                 ADSC9   DELETED_BUF+25           cn=0,n=36
        12 001237   000000 000044                    ADSC9   0,,PR0                   cn=0,n=36

      360     9204    3                   CALL BINCHAR(PTR$->DEL.FILES,TOT_FILES(1));

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:62   
   9204 12 001240   200013 470500                    LDP0    PTR$,,AUTO
        12 001241   000100 301400                    BTD
        12 001242   000001 000004 xsym               NDSC9   TOT_FILES+1              cn=0,s=lsgnf,sf=0,n=4
        12 001243   000000 230005                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=5

      361     9205    3                   CALL VPD$CLOBBERLZ(VECTOR(PTR$->DEL.FILES));

   9205 12 001244   000023 235000 13                 LDA     19
        12 001245   200013 236100                    LDQ     PTR$,,AUTO
        12 001246   200000 036007                    ADLQ    65536,DL
        12 001247   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 001250   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001251   200172 450500                    STP0    NUMRECS+4,,AUTO
        12 001252   200172 630500                    EPPR0   NUMRECS+4,,AUTO
        12 001253   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001254   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 001255   000000 011000                    NOP     0

      362     9206    3                   CALL BINCHAR(PTR$->DEL.GRANS,TOT_GRANS(1));

   9206 12 001256   200013 470500                    LDP0    PTR$,,AUTO
        12 001257   000100 301400                    BTD
        12 001260   000001 000004 xsym               NDSC9   TOT_GRANS+1              cn=0,s=lsgnf,sf=0,n=4
        12 001261   000003 230006                    NDSC9   3,,PR0                   cn=1,s=nosgn,sf=0,n=6

      363     9207    3                   CALL VPD$CLOBBERLZ(VECTOR(PTR$->DEL.GRANS));

   9207 12 001262   000025 235000 13                 LDA     21
        12 001263   200013 236100                    LDQ     PTR$,,AUTO
        12 001264   000031 036000 13                 ADLQ    25
        12 001265   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 001266   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001267   200172 450500                    STP0    NUMRECS+4,,AUTO
        12 001270   200172 630500                    EPPR0   NUMRECS+4,,AUTO
        12 001271   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001272   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 001273   000000 011000                    NOP     0
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:63   

      364     9208    3                   SUM_IDX = SUM_IDX+36;

   9208 12 001274   000044 236007                    LDQ     36,DL
        12 001275   200025 056100                    ASQ     SUM_IDX,,AUTO

      365     9209    3                   END;

      366     9210    2               IN_BUF_VECTOR.PTR$->CHAR$132 = SUM_LINE_TEXT;

   9210 12 001276   000001 470400 xsym               LDP0    IN_BUF_VECTOR+1
        12 001277   040100 100500                    MLR     fill='040'O
        12 001300   200026 000204                    ADSC9   SUM_LINE_TEXT,,AUTO      cn=0,n=132
        12 001301   000000 000204                    ADSC9   0,,PR0                   cn=0,n=132

      367     9211    2               CALL VPG$WRITE_OUT(SUM_IDX,0);

   9211 12 001302   000014 236000 13                 LDQ     12
        12 001303   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 001304   200025 630500                    EPPR0   SUM_IDX,,AUTO
        12 001305   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 001306   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001307   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001310   000000 701000 xent               TSX1    VPG$WRITE_OUT
        12 001311   000000 011000                    NOP     0

      368     9212    2               END;

      369     9213    1           IF TOT_FILES(2) = 0             /* IF no files listed                 */

   9213 12 001312   000002 235000 xsym               LDA     TOT_FILES+2
        12 001313   001324 601000 12                 TNZ     LIST_ABORT
        12 001314   000000 236000 xsym               LDQ     ERR_FLG
        12 001315   400000 376003                    ANQ     -131072,DU
        12 001316   400000 676003                    ERQ     -131072,DU
        12 001317   001324 600000 12                 TZE     LIST_ABORT

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:64   
      370     9214    1             AND ~ERR_FLG                  /* AND no errors occured              */
      371     9215    1            THEN                           /* Tell him that no files were LISTed */
      372     9216    1              CALL VPL$ERR_PROC(1,1,'10'O);

   9216 12 001320   000033 630400 13                 EPPR0   27
        12 001321   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001322   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 001323   000000 011000                    NOP     0

      373     9217        /*E* ERROR:   VPH-00001
      374     9218             MESSAGE: Nothing to list
      375     9219            MESSAGE1: No files were acceptable to LIST in that input spec
      376     9220        */
      377     9221    1   LIST_ABORT: IF M$EO1$->F$DCB.FCD

   9221 12 001324   000000 470400 xsym  LIST_ABORT   LDP0    M$EO1$
        12 001325   000031 236100                    LDQ     25,,PR0
        12 001326   020000 316007                    CANQ    8192,DL
        12 001327   001341 600000 12                 TZE     s:9224

      378     9222    1            THEN
      379     9223    1              CALL VPD$CLOSE_OUT(BITBIN(ERR_FLG)); /* CLOSE with save if no errs */

   9223 12 001330   000000 236000 xsym               LDQ     ERR_FLG
        12 001331   000043 772000                    QRL     35
        12 001332   200170 756100                    STQ     NUMRECS+2,,AUTO
        12 001333   200170 631500                    EPPR1   NUMRECS+2,,AUTO
        12 001334   200171 451500                    STP1    NUMRECS+3,,AUTO
        12 001335   200171 630500                    EPPR0   NUMRECS+3,,AUTO
        12 001336   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001337   000000 701000 xent               TSX1    VPD$CLOSE_OUT
        12 001340   000000 011000                    NOP     0

      380     9224    1           IF M$STD1$->F$DCB.FCD

   9224 12 001341   000000 470400 xsym               LDP0    M$STD1$
        12 001342   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:65   
        12 001343   020000 316007                    CANQ    8192,DL
        12 001344   001351 600000 12                 TZE     SKIPIT_1

      381     9225    1            THEN
      382     9226    1              CALL M$CLOSE(FPT_CLOSE_STD) ALTRET(SKIPIT_1);

   9226 12 001345   000000 630400 xsym               EPPR0   FPT_CLOSE_STD
        12 001346   450001 713400                    CLIMB   alt,close
        12 001347   406000 401760                    pmme    nvectors=13
        12 001350   001351 702000 12                 TSX2    SKIPIT_1

   9224 12 001351                       SKIPIT_1     null
      383     9227    1   SKIPIT_1: ;
      384     9228    1           IF M$EI$->F$DCB.FCD

   9228 12 001351   000000 470400 xsym               LDP0    M$EI$
        12 001352   000031 236100                    LDQ     25,,PR0
        12 001353   020000 316007                    CANQ    8192,DL
        12 001354   001361 600000 12                 TZE     SKIPIT_2

      385     9229    1            THEN
      386     9230    1              CALL M$CLOSE(FPT_CLOSE_EI) ALTRET(SKIPIT_2);

   9230 12 001355   000000 630400 xsym               EPPR0   FPT_CLOSE_EI
        12 001356   450001 713400                    CLIMB   alt,close
        12 001357   406000 401760                    pmme    nvectors=13
        12 001360   001361 702000 12                 TSX2    SKIPIT_2

   9228 12 001361                       SKIPIT_2     null
      387     9231    1   SKIPIT_2: ;
      388     9232    1           CALL VPD$MINIMIZE_BUF;

   9232 12 001361   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 001362   000000 701000 xent               TSX1    VPD$MINIMIZE_BUF
        12 001363   000000 011000                    NOP     0

      389     9233    1           RETURN;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:66   

   9233 12 001364   000000 702200 xent               TSX2  ! X66_ARET

      390     9234    1   STD_READ_ALT:
      391     9235    1           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF

   9235 12 001365   000000 470400 xsym  STD_READ_ALT LDP0    B$TCB$
        12 001366   000000 471500                    LDP1    0,,PR0
        12 001367   100102 236100                    LDQ     66,,PR1
        12 001370   377770 376007                    ANQ     131064,DL
        12 001371   000060 116007                    CMPQ    48,DL
        12 001372   001076 600000 12                 TZE     FIN_LIST

      392     9236    1            THEN
      393     9237    1              GOTO FIN_LIST;
      394     9238    1            ELSE
      395     9239    1              CALL VPL$ERR_PROC(3,0);

   9239 12 001373   000006 630400 13                 EPPR0   6
        12 001374   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001375   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 001376   000000 011000                    NOP     0

      396     9240    1   STD_PARSE_ALT:
      397     9241    1           CALL VPL$ERR_PROC(0,0,,PCB.ERROR);

   9241 12 001377   000036 236000 13    STD_PARSE_A* LDQ     30
        12 001400   000001 235000 xsym               LDA     B_VECTNIL+1
        12 001401   200172 757100                    STAQ    NUMRECS+4,,AUTO
        12 001402   000016 237000 13                 LDAQ    14
        12 001403   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 001404   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001405   000022 631400 xsym               EPPR1   B_VECTNIL+18
        12 001406   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 001407   000000 011000                    NOP     0

      398     9242    1           CALL VPL$ERR_PROC(3,3,'10'O);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:67   

   9242 12 001410   000037 630400 13                 EPPR0   31
        12 001411   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001412   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 001413   000000 011000                    NOP     0
        12 001414   002140 710000 12                 TRA     s:9617

      399     9243        /*E*   ERROR: VPH-00003
      400     9244             MESSAGE: in STD file.  Command aborts.
      401     9245            MESSAGE1: A record in the STD file has a bad source or option.
      402     9246        */
      403     9247        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:68   
      404     9248    1   GET_CLIST_CODE_AND_COLS: PROC;

   9248 12 001415   200070 741300       GET_CLIST_C* STX1  ! TEMP+1,,AUTO

      405     9249        /*I* NAME: GET_CLIST_CODE_AND_COLS
      406     9250             PURPOSE: To obtain CLIST_CODE and to set ICB.COLS to a reasonable value.
      407     9251             CALL: CALL GET_CLIST_CODE_AND_COLS;
      408     9252             DESCRIPTION: This procedure sets CLIST_CODE to the correct value as below:
      409     9253                            VALUE              MEANING
      410     9254                            -----              -------
      411     9255                              1                name only list
      412     9256                              2                access denied list
      413     9257                              3                list with attributes
      414     9258                              4                list with extended attributes
      415     9259                              5                list with full attributes
      416     9260                          It also sets ICB.COLS to the default if it is not specified.
      417     9261        */
      418     9262    2           IF ICB.A_EA_C~=0

   9262 12 001416   000014 235000 xsym               LDA     ICB+12
        12 001417   001422 600000 12                 TZE     s:9266

      419     9263    2            THEN                           /* Explicit LIST options, use 'em     */
      420     9264    2              CLIST_CODE = ICB.A_EA_C;

   9264 12 001420   200017 755100                    STA     CLIST_CODE,,AUTO
        12 001421   001440 710000 12                 TRA     s:9276

      421     9265    2            ELSE                           /* No explicit options, try default   */
      422     9266    2              IF DEFAULT_LIST_CODE~=0

   9266 12 001422   200011 236100                    LDQ     DEFAULT_LIST_CODE,,AUTO
        12 001423   001426 600000 12                 TZE     s:9271

      423     9267    2               THEN
      424     9268    2                 CLIST_CODE = DEFAULT_LIST_CODE;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:69   
   9268 12 001424   200017 756100                    STQ     CLIST_CODE,,AUTO
        12 001425   001440 710000 12                 TRA     s:9276

      425     9269    2               ELSE                        /* No defaults, either.  Depend on    */
      426     9270                                                /* type of source specification       */
      427     9271    2                 IF ICB.SPEC_TYPE=1 OR ICB.SPEC_TYPE=7

   9271 12 001426   000017 235000 xsym               LDA     ICB+15
        12 001427   000001 115007                    CMPA    1,DL
        12 001430   001433 600000 12                 TZE     s:9273
        12 001431   000007 115007                    CMPA    7,DL
        12 001432   001436 601000 12                 TNZ     s:9275

      428     9272    2                  THEN                     /* (A) OPTION FOR SINGLE FILE LISTS   */
      429     9273    2                    CLIST_CODE = 3;

   9273 12 001433   000003 235007                    LDA     3,DL
        12 001434   200017 755100                    STA     CLIST_CODE,,AUTO
        12 001435   001440 710000 12                 TRA     s:9276

      430     9274    2                  ELSE
      431     9275    2                    CLIST_CODE = 1;

   9275 12 001436   000001 235007                    LDA     1,DL
        12 001437   200017 755100                    STA     CLIST_CODE,,AUTO

      432     9276    2           IF ICB.COLS=0

   9276 12 001440   000016 235000 xsym               LDA     ICB+14
        12 001441   001444 601000 12                 TNZ     s:9279

      433     9277    2            THEN
      434     9278    2              ICB.COLS = DEFAULT_LIST_COLS;

   9278 12 001442   200012 236100                    LDQ     DEFAULT_LIST_COLS,,AUTO
        12 001443   000016 756000 xsym               STQ     ICB+14

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:70   
      435     9279    2           RETURN;

   9279 12 001444   000001 702211                    TSX2  ! 1,X1

      436     9280    2   END GET_CLIST_CODE_AND_COLS;
      437     9281        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:71   
      438     9282    1   GET_USABLE_LEN: PROC;

   9282 12 001445   200070 741300       GET_USABLE_* STX1  ! TEMP+1,,AUTO

      439     9283        /*I* NAME: GET_USABLE_LEN
      440     9284             PURPOSE: To determine the usable length for a list record.
      441     9285             CALL: CALL GET_USABLE_LEN;
      442     9286             DESCRIPTION: USABLE_LEN is determined from a combination of the options
      443     9287                          KEYS and CS and OUTPUT_PWIDTH from VPG$SET_UP_WRITE. It
      444     9288                          represents the size available for writing the list record.
      445     9289        */
      446     9290    2           IF OCB.CS.SPEC~=0

   9290 12 001446   000007 235000 xsym               LDA     OCB+7
        12 001447   001453 600000 12                 TZE     s:9295

      447     9291    2            THEN
      448     9292    2              USABLE_LEN = 72;

   9292 12 001450   000110 236007                    LDQ     72,DL
        12 001451   000000 756000 xsym               STQ     USABLE_LEN
        12 001452   001461 710000 12                 TRA     s:9300

      449     9293    2            ELSE
      450     9294    3            DO;

      451     9295    3               USABLE_LEN = OUTPUT_PWIDTH;

   9295 12 001453   000000 236000 xsym               LDQ     OUTPUT_PWIDTH
        12 001454   000000 756000 xsym               STQ     USABLE_LEN

      452     9296    3               IF OCB.KEYS~=0

   9296 12 001455   000026 235000 xsym               LDA     OCB+22
        12 001456   001461 600000 12                 TZE     s:9300

      453     9297    3                THEN
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:72   
      454     9298    3                  USABLE_LEN = USABLE_LEN-9;

   9298 12 001457   000011 336007                    LCQ     9,DL
        12 001460   000000 056000 xsym               ASQ     USABLE_LEN

      455     9299    3               END;

      456     9300    2           RETURN;

   9300 12 001461   000001 702211                    TSX2  ! 1,X1

      457     9301    2   END GET_USABLE_LEN;
      458     9302        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:73   
      459     9303    1   OUT_LIST_HDR: PROC;

   9303 12 001462   200070 741300       OUT_LIST_HDR STX1  ! TEMP+1,,AUTO

      460     9304        /*I* NAME: OUT_LIST_HDR
      461     9305             PURPOSE: To put out a header for a list with attributes or eattributes.
      462     9306             CALL: CALL OUT_LIST_HDR;
      463     9307             DESCRIPTION: This procedure puts out a header line containing
      464     9308                          current time and date and files-to-be-listed description
      465     9309                          if a single specification only was entered. In any case,
      466     9310                          it then puts out a header for a list with attributes or
      467     9311                          better.
      468     9312        */
      469     9313    2   DCL CHAR$140 CHAR(140) BASED;
      470     9314    2   DCL CHAR$49 CHAR(49) BASED;
      471     9315    2   DCL DISK_HDR CHAR(49) CONSTANT INIT
      472     9316    2               ('Org TY  Gran  NGAV     Rec   Last modified   Name');
      473     9317    2   DCL TAPE_HDR CHAR(49) CONSTANT INIT
      474     9318    2               ('Org TY  Blkl  Recl     Rec Vol           FSN Name');
      475     9319    2   DCL TEMP SBIN WORD;
      476     9320        /**/
      477     9321    2           IF SINGLE_INSPEC=1 AND CMD_MASK(9)

   9321 12 001463   000000 235000 xsym               LDA     SINGLE_INSPEC
        12 001464   000001 115007                    CMPA    1,DL
        12 001465   001521 601000 12                 TNZ     s:9330
        12 001466   000000 236000 xsym               LDQ     CMD_MASK
        12 001467   000400 316003                    CANQ    256,DU
        12 001470   001521 600000 12                 TZE     s:9330
        12 001471   000017 235000 xsym               LDA     ICB+15
        12 001472   000001 115007                    CMPA    1,DL
        12 001473   001521 600000 12                 TZE     s:9330
        12 001474   000007 115007                    CMPA    7,DL
        12 001475   001521 600000 12                 TZE     s:9330

      478     9322    2             AND NOT(ICB.SPEC_TYPE=1 OR ICB.SPEC_TYPE=7)
      479     9323    2            THEN
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:74   
      480     9324    3            DO;                            /* PUT OUT EXTENDED HEADER            */

      481     9325    3               CALL VPD$GET_SPEC_BUF(0,1);

   9325 12 001476   000042 630400 13                 EPPR0   34
        12 001477   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001500   000000 701000 xent               TSX1    VPD$GET_SPEC_BUF
        12 001501   000000 011000                    NOP     0

      482     9326    3               IN_BUF_VECTOR.PTR$->CHAR$140 = SPEC_BUF.STRING;

   9326 12 001502   000001 470400 xsym               LDP0    IN_BUF_VECTOR+1
        12 001503   040100 100400                    MLR     fill='040'O
        12 001504   000000 200213 xsym               ADSC9   SPEC_BUF                 cn=1,n=139
        12 001505   000000 000214                    ADSC9   0,,PR0                   cn=0,n=140

      483     9327    3               TEMP = SPEC_BUF.LEN;

   9327 12 001506   000000 236000 xsym               LDQ     SPEC_BUF
        12 001507   000033 772000                    QRL     27
        12 001510   200071 756100                    STQ     TEMP,,AUTO

      484     9328    3               CALL VPG$WRITE_OUT(TEMP,0);

   9328 12 001511   000007 236000 13                 LDQ     7
        12 001512   200171 756100                    STQ     NUMRECS+3,,AUTO
        12 001513   200071 630500                    EPPR0   TEMP,,AUTO
        12 001514   200170 450500                    STP0    NUMRECS+2,,AUTO
        12 001515   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001516   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001517   000000 701000 xent               TSX1    VPG$WRITE_OUT
        12 001520   000000 011000                    NOP     0

      485     9329    3               END;

      486     9330    2           IF ICB.DEV_MASK.MAN_TAPE        /*LT*/

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:75   
   9330 12 001521   000171 236000 xsym               LDQ     ICB+121
        12 001522   100000 316003                    CANQ    32768,DU
        12 001523   001531 600000 12                 TZE     s:9334

      487     9331    2            THEN
      488     9332    2              IN_BUF_VECTOR.PTR$->CHAR$49 = TAPE_HDR;

   9332 12 001524   000001 470400 xsym               LDP0    IN_BUF_VECTOR+1
        12 001525   040100 100400                    MLR     fill='040'O
        12 001526   000020 000061 10                 ADSC9   TAPE_HDR                 cn=0,n=49
        12 001527   000000 000061                    ADSC9   0,,PR0                   cn=0,n=49
        12 001530   001535 710000 12                 TRA     s:9335

      489     9333    2            ELSE
      490     9334    2              IN_BUF_VECTOR.PTR$->CHAR$49 = DISK_HDR;

   9334 12 001531   000001 470400 xsym               LDP0    IN_BUF_VECTOR+1
        12 001532   040100 100400                    MLR     fill='040'O
        12 001533   000003 000061 10                 ADSC9   DISK_HDR                 cn=0,n=49
        12 001534   000000 000061                    ADSC9   0,,PR0                   cn=0,n=49

      491     9335    2           CALL VPG$WRITE_OUT(49,0);

   9335 12 001535   000045 630400 13                 EPPR0   37
        12 001536   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001537   000000 701000 xent               TSX1    VPG$WRITE_OUT
        12 001540   000000 011000                    NOP     0

      492     9336    2           RETURN;

   9336 12 001541   200070 221300                    LDX1  ! TEMP+1,,AUTO
        12 001542   000001 702211                    TSX2  ! 1,X1

      493     9337    2   END OUT_LIST_HDR;
      494     9338        %EJECT;
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:76   
      495     9339    1   REVIEW_CHK: PROC(RET_VAL);

   9339 12 001543   200070 741300       REVIEW_CHK   STX1  ! TEMP+1,,AUTO

      496     9340        /*I* NAME: REVIEW_CHK
      497     9341             PURPOSE: To analyze and act upon responses to the REVIEW commands'
      498     9342                      prompts.
      499     9343             CALL: CALL REVIEW_CHK(RET_VAL);
      500     9344             DESCRIPTION: REVIEW_CHK gets an input line from the user after each
      501     9345                          file being reviewed is listed. It then acts upon that input
      502     9346                          as follows:
      503     9347                             o NEXT - does nothing but return
      504     9348                             o DELETE - attempts to delete the file and returns
      505     9349                             o END - returns with a code to end the REVIEW
      506     9350                             o JUMP - returns with a code to JUMP to the next source
      507     9351                             o A - returns with a code to re-LIST with Attributes
      508     9352                             o EA - returns with a code to re-LIST with Extended
      509     9353                                    Attributes.
      510     9354                             o FA - returns with a code to re-LIST with Full
      511     9355                                    Attributes.
      512     9356                             o COPY [n] - copies the first n lines of the file
      513     9357                                          then returns with a code to re-LIST
      514     9358                                          NAME only.
      515     9359        */
      516     9360    2   DCL RET_VAL SBIN WORD;
      517     9361    2   DCL TSEED UBIN;
      518     9362    2   DCL J UBIN;
      519     9363    2   DCL DELETED_BUF CHAR(0) CONSTANT INIT('          ** Deleted **');
      520     9364        %FPT_READ(FPTN = FPT_READ_EI,
      521     9365                  DCB  = M$EI,
      522     9366                  BUF  = REV_BUF,
      523     9367                  STCLASS = STATIC);
      524     9406        %FPT_OPEN  (FPTN=FPT_OPEN_EI_DELETE_IT, STCLASS=AUTO);
      525     9515    2   DCL REV_BUF CHAR(140) STATIC;
      526     9516    2   DCL NUMRECS SBIN WORD;
      527     9517        /**/
      528     9518    2           RET_VAL = 0;                    /* GO ON TO NEXT FILE                 */
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:77   

   9518 12 001544   200071 470500                    LDP0    @RET_VAL,,AUTO
        12 001545   000000 450100                    STZ     0,,PR0

      529     9519    2           CALL VPD$GET_INPUT(0);

   9519 12 001546   000007 630400 13                 EPPR0   7
        12 001547   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001550   000000 701000 xent               TSX1    VPD$GET_INPUT
        12 001551   000000 011000                    NOP     0

      530     9520    2           CALL X$PARSE(PCB) ALTRET(PARSE_ALT);

   9520 12 001552   000001 630400 13                 EPPR0   1
        12 001553   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001554   000000 701000 xent               TSX1    X$PARSE
        12 001555   002113 702000 12                 TSX2    PARSE_ALT

      531     9521    3           DO CASE(PCB.OUT$->OUT$BLK.CODE);

   9521 12 001556   000003 470400 xsym               LDP0    PCB+3
        12 001557   000000 720100                    LXL0    0,,PR0
        12 001560   000041 100003                    CMPX0   33,DU
        12 001561   001563 602010 12                 TNC     s:9521+5,X0
        12 001562   002075 710000 12                 TRA     s:9595
        12 001563   002075 710000 12                 TRA     s:9595
        12 001564   002075 710000 12                 TRA     s:9595
        12 001565   001670 710000 12                 TRA     s:9539
        12 001566   001660 710000 12                 TRA     s:9535
        12 001567   001664 710000 12                 TRA     s:9537
        12 001570   001624 710000 12                 TRA     s:9525
        12 001571   001711 710000 12                 TRA     s:9548
        12 001572   001675 710000 12                 TRA     s:9542
        12 001573   002075 710000 12                 TRA     s:9595
        12 001574   002075 710000 12                 TRA     s:9595
        12 001575   002075 710000 12                 TRA     s:9595
        12 001576   002075 710000 12                 TRA     s:9595
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:78   
        12 001577   002075 710000 12                 TRA     s:9595
        12 001600   002075 710000 12                 TRA     s:9595
        12 001601   002075 710000 12                 TRA     s:9595
        12 001602   002075 710000 12                 TRA     s:9595
        12 001603   002075 710000 12                 TRA     s:9595
        12 001604   002075 710000 12                 TRA     s:9595
        12 001605   002075 710000 12                 TRA     s:9595
        12 001606   002075 710000 12                 TRA     s:9595
        12 001607   002075 710000 12                 TRA     s:9595
        12 001610   002075 710000 12                 TRA     s:9595
        12 001611   002075 710000 12                 TRA     s:9595
        12 001612   002054 710000 12                 TRA     s:9587
        12 001613   002075 710000 12                 TRA     s:9595
        12 001614   002075 710000 12                 TRA     s:9595
        12 001615   002075 710000 12                 TRA     s:9595
        12 001616   002065 710000 12                 TRA     s:9591
        12 001617   002075 710000 12                 TRA     s:9595
        12 001620   002075 710000 12                 TRA     s:9595
        12 001621   002075 710000 12                 TRA     s:9595
        12 001622   002075 710000 12                 TRA     s:9595
        12 001623   001703 710000 12                 TRA     s:9545

      532     9522    3            CASE(1);                       /* NEXT                               */

      533     9523    3              ;
      534     9524    3            CASE(5);                       /* DELETE                             */

      535     9525    3              FPT_OPEN_EI_DELETE_IT = FPT_OPEN_EI_SAVE;

   9525 12 001624   000100 100400                    MLR     fill='000'O
        12 001625   000000 000350 xsym               ADSC9   FPT_OPEN_EI_SAVE         cn=0,n=232
        12 001626   200074 000350                    ADSC9   FPT_OPEN_EI_DELETE_IT,,AUTO cn=0,n=232

      536     9526    3              FPT_OPEN_EI_DELETE_IT.V_ = VECTOR (FPT_OPEN_EI_DELETE_IT.V);

   9526 12 001627   000047 235000 13                 LDA     39
        12 001630   200170 452500                    STP2    NUMRECS+2,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:79   
        12 001631   200170 236100                    LDQ     NUMRECS+2,,AUTO
        12 001632   000140 036003                    ADLQ    96,DU
        12 001633   200074 757100                    STAQ    FPT_OPEN_EI_DELETE_IT,,AUTO

      537     9527    3              FPT_OPEN_EI_DELETE_IT.V.OPER.TEST# = %NO#;

   9527 12 001634   000050 236000 13                 LDQ     40
        12 001635   200140 356100                    ANSQ    FPT_OPEN_EI_DELETE_IT+36,,AUTO

      538     9528    3              FPT_OPEN_EI_DELETE_IT.V.DELETE# = %YES#;

   9528 12 001636   040000 236007                    LDQ     16384,DL
        12 001637   200140 256100                    ORSQ    FPT_OPEN_EI_DELETE_IT+36,,AUTO

      539     9529    3              CALL M$OPEN(FPT_OPEN_EI_DELETE_IT) ALTRET(DEL_OPEN_ALT);

   9529 12 001640   200074 630500                    EPPR0   FPT_OPEN_EI_DELETE_IT,,AUTO
        12 001641   450000 713400                    CLIMB   alt,open
        12 001642   410400 401760                    pmme    nvectors=18
        12 001643   002132 702000 12                 TSX2    DEL_OPEN_ALT

      540     9530    3              CALL VPD$COUNTER_BUMP(1);

   9530 12 001644   000022 630400 13                 EPPR0   18
        12 001645   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001646   000000 701000 xent               TSX1    VPD$COUNTER_BUMP
        12 001647   000000 011000                    NOP     0

      541     9531    3              FPT_WRITE_ME.BUF_   = VECTOR(DELETED_BUF);

   9531 12 001650   000052 237000 13                 LDAQ    42
        12 001651   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      542     9532    3              FPT_WRITE_ME.V.DVBYTE.VFC# = %NO#;

   9532 12 001652   000012 236000 13                 LDQ     10
        12 001653   000013 356000 xsym               ANSQ    FPT_WRITE_ME+11
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:80   

      543     9533    3              CALL M$WRITE(FPT_WRITE_ME);

   9533 12 001654   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 001655   040001 713400                    CLIMB   write
        12 001656   401400 401760                    pmme    nvectors=4
        12 001657   002075 710000 12                 TRA     s:9595

      544     9534    3            CASE(3);                       /* JUMP                               */

      545     9535    3              RET_VAL = 1;

   9535 12 001660   000001 235007                    LDA     1,DL
        12 001661   200071 471500                    LDP1    @RET_VAL,,AUTO
        12 001662   100000 755100                    STA     0,,PR1
        12 001663   002075 710000 12                 TRA     s:9595

      546     9536    3            CASE(4);                       /* END                                */

      547     9537    3              RET_VAL = 2;

   9537 12 001664   000002 235007                    LDA     2,DL
        12 001665   200071 471500                    LDP1    @RET_VAL,,AUTO
        12 001666   100000 755100                    STA     0,,PR1
        12 001667   002075 710000 12                 TRA     s:9595

      548     9538    3            CASE(2);                       /* ATTRIBS                            */

      549     9539    3              RET_VAL = 3;

   9539 12 001670   000003 235007                    LDA     3,DL
        12 001671   200071 471500                    LDP1    @RET_VAL,,AUTO
        12 001672   100000 755100                    STA     0,,PR1

      550     9540    3              LIST_CODE = 3;

   9540 12 001673   200020 755100                    STA     LIST_CODE,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:81   
        12 001674   002075 710000 12                 TRA     s:9595

      551     9541    3            CASE(7);                       /* EATTRIBS                           */

      552     9542    3              RET_VAL = 3;

   9542 12 001675   000003 235007                    LDA     3,DL
        12 001676   200071 471500                    LDP1    @RET_VAL,,AUTO
        12 001677   100000 755100                    STA     0,,PR1

      553     9543    3              LIST_CODE = 4;

   9543 12 001700   000004 236007                    LDQ     4,DL
        12 001701   200020 756100                    STQ     LIST_CODE,,AUTO
        12 001702   002075 710000 12                 TRA     s:9595

      554     9544    3            CASE(32);                      /* FATTRIBS                           */

      555     9545    3              RET_VAL = 3;

   9545 12 001703   000003 235007                    LDA     3,DL
        12 001704   200071 471500                    LDP1    @RET_VAL,,AUTO
        12 001705   100000 755100                    STA     0,,PR1

      556     9546    3              LIST_CODE = 5;

   9546 12 001706   000005 236007                    LDQ     5,DL
        12 001707   200020 756100                    STQ     LIST_CODE,,AUTO
        12 001710   002075 710000 12                 TRA     s:9595

      557     9547    3            CASE(6);                       /* COPY                               */

      558     9548    3              TSEED=ICB.CRPT;              /* Default to what user said          */

   9548 12 001711   000007 235000 xsym               LDA     ICB+7
        12 001712   200072 755100                    STA     TSEED,,AUTO

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:82   
      559     9549    3              NUMRECS = 1;                 /* Default to 1 record                */

   9549 12 001713   000001 236007                    LDQ     1,DL
        12 001714   200166 756100                    STQ     NUMRECS,,AUTO

      560     9550    3              IF PCB.OUT$->OUT$BLK.NSUBLKS>0

   9550 12 001715   000001 220100                    LDX0    1,,PR0
        12 001716   001775 600000 12                 TZE     DEF_1

      561     9551    3               THEN
      562     9552    4               DO J=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;

   9552 12 001717   200073 450100                    STZ     J,,AUTO
        12 001720   001766 710000 12                 TRA     s:9562+3

      563     9553    5                  DO CASE(PCB.OUT$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE);

   9553 12 001721   000003 470400 xsym               LDP0    PCB+3
        12 001722   200073 720100                    LXL0    J,,AUTO
        12 001723   000003 471510                    LDP1    3,X0,PR0
        12 001724   100000 721100                    LXL1    0,,PR1
        12 001725   000007 101003                    CMPX1   7,DU
        12 001726   001730 602011 12                 TNC     s:9553+7,X1
        12 001727   001763 710000 12                 TRA     s:9562
        12 001730   001737 710000 12                 TRA     s:9555
        12 001731   001763 710000 12                 TRA     s:9562
        12 001732   001763 710000 12                 TRA     s:9562
        12 001733   001763 710000 12                 TRA     s:9562
        12 001734   001763 710000 12                 TRA     s:9562
        12 001735   001763 710000 12                 TRA     s:9562
        12 001736   001752 710000 12                 TRA     s:9558

      564     9554    5                   CASE(0);                /* Decimal number                     */

      565     9555    5                     CALL VPD$TEXTC_CHARBIN(NUMRECS,PCB.OUT$->OUT$BLK.SUBLK$(J)->

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:83   
   9555 12 001737   000051 236000 13                 LDQ     41
        12 001740   200172 756100                    STQ     NUMRECS+4,,AUTO
        12 001741   100003 633500                    EPPR3   3,,PR1
        12 001742   200171 453500                    STP3    NUMRECS+3,,AUTO
        12 001743   200166 631500                    EPPR1   NUMRECS,,AUTO
        12 001744   200170 451500                    STP1    NUMRECS+2,,AUTO
        12 001745   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001746   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001747   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        12 001750   001775 702000 12                 TSX2    DEF_1
        12 001751   001763 710000 12                 TRA     s:9562

      566     9556    5                       OUT$BLK.SUBLK$(0),-1) ALTRET(DEF_1);
      567     9557    5                   CASE(6);                /* Encryption seed                    */

      568     9558    5                     CALL VPD$MNG_CRPT(TSEED,PCB.OUT$->OUT$BLK.SUBLK$(J)->

   9558 12 001752   100003 633500                    EPPR3   3,,PR1
        12 001753   200171 453500                    STP3    NUMRECS+3,,AUTO
        12 001754   200072 631500                    EPPR1   TSEED,,AUTO
        12 001755   200170 451500                    STP1    NUMRECS+2,,AUTO
        12 001756   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 001757   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001760   000000 701000 xent               TSX1    VPD$MNG_CRPT
        12 001761   001763 702000 12                 TSX2    s:9562
        12 001762   001763 710000 12                 TRA     s:9562

      569     9559    5                       OUT$BLK.SUBLK$(0))
      570     9560    6                      WHENALTRETURN DO; END;

      571     9561    5                   END;

      572     9562    4                  END;

   9562 12 001763   200073 235100                    LDA     J,,AUTO
        12 001764   000001 035007                    ADLA    1,DL
        12 001765   200073 755100                    STA     J,,AUTO
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:84   
        12 001766   000003 470400 xsym               LDP0    PCB+3
        12 001767   000001 236100                    LDQ     1,,PR0
        12 001770   000022 772000                    QRL     18
        12 001771   200073 116100                    CMPQ    J,,AUTO
        12 001772   001774 600000 12                 TZE     s:9562+9
        12 001773   001721 603000 12                 TRC     s:9553
        12 001774   001777 710000 12                 TRA     s:9565

      573     9563    3               ELSE
      574     9564    3   DEF_1:        NUMRECS = 1;

   9564 12 001775   000001 235007       DEF_1        LDA     1,DL
        12 001776   200166 755100                    STA     NUMRECS,,AUTO

      575     9565    3              FPT_WRITE_ME.BUF_   = VECTOR(REV_BUF);

   9565 12 001777   000054 237000 13                 LDAQ    44
        12 002000   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      576     9566    3              FPT_WRITE_ME.V.DVBYTE.VFC# = %NO#;

   9566 12 002001   000012 236000 13                 LDQ     10
        12 002002   000013 356000 xsym               ANSQ    FPT_WRITE_ME+11

      577     9567    3              FPT_READ_EI.V.SEED# = BINBIT(TSEED,36);

   9567 12 002003   200072 236100                    LDQ     TSEED,,AUTO
        12 002004   000014 756000 11                 STQ     FPT_READ_EI+10

      578     9568    4              DO NUMRECS=-NUMRECS TO -1;

   9568 12 002005   200166 335100                    LCA     NUMRECS,,AUTO
        12 002006   200166 755100                    STA     NUMRECS,,AUTO
        12 002007   002041 710000 12                 TRA     s:9582+1

      579     9569    4                 CALL M$READ(FPT_READ_EI) ALTRET(EI_READ_ALT);

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:85   
   9569 12 002010   000002 630400 11                 EPPR0   FPT_READ_EI
        12 002011   440000 713400                    CLIMB   alt,read
        12 002012   401400 401760                    pmme    nvectors=4
        12 002013   002076 702000 12                 TSX2    EI_READ_ALT

      580     9570    4   WRITE_IT:     IF M$EI$->F$DCB.ARS = 0

   9570 12 002014   000000 470400 xsym  WRITE_IT     LDP0    M$EI$
        12 002015   000000 235100                    LDA     0,,PR0
        12 002016   002027 601000 12                 TNZ     s:9579

      581     9571    4                  THEN                     /* Null record, clobber it            */
      582     9572    5                  DO;

      583     9573    5                     FPT_WRITE_ME.BUF_ = VECTOR (NIL);

   9573 12 002017   000056 237000 13                 LDAQ    46
        12 002020   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      584     9574    5                     CALL M$WRITE(FPT_WRITE_ME);

   9574 12 002021   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 002022   040001 713400                    CLIMB   write
        12 002023   401400 401760                    pmme    nvectors=4

      585     9575    5                     FPT_WRITE_ME.BUF_ = VECTOR (REV_BUF); /* Restore output BUF */

   9575 12 002024   000054 237000 13                 LDAQ    44
        12 002025   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      586     9576    5                     END;

   9576 12 002026   002040 710000 12                 TRA     s:9582

      587     9577    4                  ELSE
      588     9578    5                  DO;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:86   
      589     9579    5                     FPT_WRITE_ME.BUF_.BOUND = M$EI$->F$DCB.ARS -1;

   9579 12 002027   000000 236100                    LDQ     0,,PR0
        12 002030   000001 136007                    SBLQ    1,DL
        12 002031   000020 736000                    QLS     16
        12 002032   000004 676000 xsym               ERQ     FPT_WRITE_ME+4
        12 002033   000034 376000 xsym               ANQ     B_VECTNIL+28
        12 002034   000004 656000 xsym               ERSQ    FPT_WRITE_ME+4

      590     9580    5                     CALL M$WRITE(FPT_WRITE_ME);

   9580 12 002035   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 002036   040001 713400                    CLIMB   write
        12 002037   401400 401760                    pmme    nvectors=4

      591     9581    5                     END;

      592     9582    4                 END;

   9582 12 002040   200166 054100                    AOS     NUMRECS,,AUTO
        12 002041   200166 235100                    LDA     NUMRECS,,AUTO
        12 002042   002010 604000 12                 TMI     s:9569

      593     9583    3   CLOSE_EI:  CALL M$CLOSE(FPT_CLOSE_EI);

   9583 12 002043   000000 630400 xsym  CLOSE_EI     EPPR0   FPT_CLOSE_EI
        12 002044   050001 713400                    CLIMB   close
        12 002045   406000 401760                    pmme    nvectors=13

      594     9584    3              RET_VAL = 3;

   9584 12 002046   000003 235007                    LDA     3,DL
        12 002047   200071 470500                    LDP0    @RET_VAL,,AUTO
        12 002050   000000 755100                    STA     0,,PR0

      595     9585    3              LIST_CODE = 1;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:87   
   9585 12 002051   000001 236007                    LDQ     1,DL
        12 002052   200020 756100                    STQ     LIST_CODE,,AUTO
        12 002053   002075 710000 12                 TRA     s:9595

      596     9586    3            CASE(23);                      /* HELP                               */

      597     9587    3              CALL VPL$HELP;

   9587 12 002054   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 002055   000000 701000 xent               TSX1    VPL$HELP
        12 002056   000000 011000                    NOP     0

      598     9588    3              RET_VAL = 3;

   9588 12 002057   000003 235007                    LDA     3,DL
        12 002060   200071 470500                    LDP0    @RET_VAL,,AUTO
        12 002061   000000 755100                    STA     0,,PR0

      599     9589    3              LIST_CODE = 1;

   9589 12 002062   000001 236007                    LDQ     1,DL
        12 002063   200020 756100                    STQ     LIST_CODE,,AUTO
        12 002064   002075 710000 12                 TRA     s:9595

      600     9590    3            CASE(27);                      /* QUEST                              */

      601     9591    3              CALL VPL$QUEST;

   9591 12 002065   000002 631400 xsym               EPPR1   B_VECTNIL+2
        12 002066   000000 701000 xent               TSX1    VPL$QUEST
        12 002067   000000 011000                    NOP     0

      602     9592    3              RET_VAL = 3;

   9592 12 002070   000003 235007                    LDA     3,DL
        12 002071   200071 470500                    LDP0    @RET_VAL,,AUTO
        12 002072   000000 755100                    STA     0,,PR0
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:88   

      603     9593    3              LIST_CODE = 1;

   9593 12 002073   000001 236007                    LDQ     1,DL
        12 002074   200020 756100                    STQ     LIST_CODE,,AUTO

      604     9594    3            END;                           /* END CASE                           */

      605     9595    3           DO WHILE('0'B);

   9595 12 002075   002136 710000 12                 TRA     s:9615

      606     9596    3   EI_READ_ALT: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$EOF

   9596 12 002076   000000 470400 xsym  EI_READ_ALT  LDP0    B$TCB$
        12 002077   000000 471500                    LDP1    0,,PR0
        12 002100   100102 236100                    LDQ     66,,PR1
        12 002101   377770 376007                    ANQ     131064,DL
        12 002102   000060 116007                    CMPQ    48,DL
        12 002103   002043 600000 12                 TZE     CLOSE_EI

      607     9597    3               THEN
      608     9598    3                 GOTO CLOSE_EI;
      609     9599    3               ELSE
      610     9600    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE=%E$LD

   9600 12 002104   000070 116007                    CMPQ    56,DL
        12 002105   002014 600000 12                 TZE     WRITE_IT

      611     9601    3                  THEN
      612     9602    3                    GOTO WRITE_IT;
      613     9603    3                  ELSE
      614     9604    4                  DO;

      615     9605    4                     CALL VPL$ERR_PROC(1,0);

   9605 12 002106   000060 630400 13                 EPPR0   48
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:89   
        12 002107   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002110   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 002111   000000 011000                    NOP     0

      616     9606    4                     GOTO CLOSE_EI;

   9606 12 002112   002043 710000 12                 TRA     CLOSE_EI

      617     9607    4                     END;
      618     9608    3   PARSE_ALT: CALL VPL$ERR_PROC(1,0,,PCB.ERROR);

   9608 12 002113   000036 236000 13    PARSE_ALT    LDQ     30
        12 002114   000001 235000 xsym               LDA     B_VECTNIL+1
        12 002115   200172 757100                    STAQ    NUMRECS+4,,AUTO
        12 002116   000060 237000 13                 LDAQ    48
        12 002117   200170 757100                    STAQ    NUMRECS+2,,AUTO
        12 002120   200170 630500                    EPPR0   NUMRECS+2,,AUTO
        12 002121   000022 631400 xsym               EPPR1   B_VECTNIL+18
        12 002122   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 002123   000000 011000                    NOP     0

      619     9609    3   READ_SI_ALT: RET_VAL = 3;

   9609 12 002124   000003 235007       READ_SI_ALT  LDA     3,DL
        12 002125   200071 470500                    LDP0    @RET_VAL,,AUTO
        12 002126   000000 755100                    STA     0,,PR0

      620     9610    3              LIST_CODE = 1;

   9610 12 002127   000001 236007                    LDQ     1,DL
        12 002130   200020 756100                    STQ     LIST_CODE,,AUTO

      621     9611    4              DO WHILE('0'B);

   9611 12 002131   002136 710000 12                 TRA     s:9615

      622     9612    4   DEL_OPEN_ALT: CALL VPL$ERR_PROC(1,0);
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:90   

   9612 12 002132   000060 630400 13    DEL_OPEN_ALT EPPR0   48
        12 002133   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002134   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 002135   000000 011000                    NOP     0

      623     9613    4                 END;

      624     9614    3              END;

      625     9615    2           RETURN;

   9615 12 002136   200070 221300                    LDX1  ! TEMP+1,,AUTO
        12 002137   000001 702211                    TSX2  ! 1,X1

      626     9616    2   END REVIEW_CHK;
      627     9617    1   END VPH$LIST;

   9617 12 002140   000000 702200 xent               TSX2  ! X66_ARET
      628     9618        %EOD;

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:91   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPH$LIST.
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:92   

 **** Variables and constants ****

  ****  Section 010 RoData VPH$LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    35-0-0/c CHAR(23)    r     1 DELETED_BUF                3-0-0/c CHAR(49)    r     1 DISK_HDR
     0-0-0/c CHAR(9)     r     1 LIS_MSG                   20-0-0/c CHAR(49)    r     1 TAPE_HDR

  ****  Section 011  Data  VPH$LIST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR        r     1 CR_LF                      0-0-0/c STRC(18)    r     1 EXTEND
     2-0-0/d STRC(504)   r     1 FPT_READ_EI               20-0-0/c CHAR(140)   r     1 REV_BUF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    71-0-0/w PTR         r     1 @RET_VAL                  17-0-0/w SBIN        r     1 CLIST_CODE
    21-0-0/w SBIN        r     1 CUR_GRANS                 11-0-0/w SBIN        r     1 DEFAULT_LIST_CODE
    12-0-0/w SBIN        r     1 DEFAULT_LIST_COLS
    74-0-0/d STRC(2088)  r     1 FPT_OPEN_EI_DELETE_IT
    10-0-0/w SBIN        r     1 I                          3-0-0/w SBIN        r     1 IDX
     4-0-0/w SBIN        r     1 IDX2                      73-0-0/w UBIN        r     1 J
    20-0-0/w SBIN        r     1 LIST_CODE                  5-0-0/b BIT (9)     r     1 LIST_HDR_OUT
    22-0-0/w SBIN        r     1 LIST_WKSZ                 23-0-0/w PTR         r     1 LIST_WORK$
     6-0-0/w SBIN        r     1 NEXT_SPEC_RET_VAL        166-0-0/w SBIN        r     1 NUMRECS
     7-0-0/w SBIN        r     1 OPEN_NEXT_RET_VAL         14-0-0/w PTR         r     1 OUT$
    15-0-0/w PTR         r     1 OUTSPEC$                  13-0-0/w PTR         r     1 PTR$
    *0-0-0/w SBIN        r     1 RET_VAL                   24-0-0/w SBIN        r     1 REV_RET_VAL
    16-0-0/w PTR         r     1 SOURCELIST$               25-0-0/w SBIN        r     1 SUM_IDX
    26-0-0/c STRC(1188)  r     1 SUM_LINE                  26-0-0/c CHAR(132)   r     1 SUM_LINE_TEXT
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:93   
    67-0-0/w SBIN        r     1 TEMP                      71-0-0/w SBIN        r     1 TEMP
    72-0-0/w UBIN        r     1 TSEED

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ABORT_CMD                  0-0-0/d REMB        r     1 ABORT_STEP
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d REMB        r     1 BREAK_LOC
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/b BIT         r     1 CMD_MASK(0:71)
     0-0-0/b BIT         r     1 CON_DUP_TBL(0:35)
     0-0-0/w SBIN        r     1 CUR_SEQ_NO                 0-0-0/d STRC(5868)  r     1 DEF_ICB
     0-0-0/c STRC(4608)  r     1 EI_KEY                     0-0-0/w BIT         r     1 ERR_FLG
     0-0-0/d SBIN        r     1 FPARAM_BUF(0:1023)
     0-0-0/d STRC(1080)  r     1 FPT_CLOSE_EI               0-0-0/d STRC(1080)  r     1 FPT_CLOSE_STD
     0-0-0/d STRC(2088)  r     1 FPT_OPEN_EI_SAVE           0-0-0/d STRC(504)   r     1 FPT_READ_STD
     0-0-0/d STRC(432)   r     1 FPT_WRITE_ME               0-0-0/d STRC(5868)  r     1 ICB
     0-0-0/d STRC(72)    r     1 IN_BUF_VECTOR              0-0-0/w PTR         r     1 LIST_BUF$
     0-0-0/w SBIN        r     1 LIST_IDX                   0-0-0/w PTR         r     1 M$EI$
     0-0-0/w PTR         r     1 M$EO1$                     0-0-0/w PTR         r     1 M$SI$
     0-0-0/w PTR         r     1 M$STD1$                    0-0-0/d STRC(6840)  r     1 OCB
     0-0-0/w SBIN        r     1 OUTPUT_PWIDTH              0-0-0/w STRC(504)   r     1 PCB
     0-0-0/w SBIN        r     1 SINGLE_INSPEC              0-0-0/c STRC(1260)  r     1 SPEC_BUF
     0-0-0/b BIT         r     1 THIS_STD_FILE              0-0-0/b BIT         r     1 TOP_REVIEW_CMD
     0-0-0/b BIT         r     1 TOP_STD_N
     0-0-0/w SBIN        r     1 TOT_FILES(0:4)
     0-0-0/w SBIN        r     1 TOT_GRANS(0:4)
     0-0-0/w SBIN        r     1 TOT_RECS                   0-0-0/w SBIN        r     1 USABLE_LEN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:94   
     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(4537)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(81)    r     1 BUF_BLOCK
     0-0-0/c CHAR(132)   r     1 CHAR$132                   0-0-0/c CHAR(140)   r     1 CHAR$140
     0-0-0/c CHAR(49)    r     1 CHAR$49                    0-0-0/w STRC(324)   r     1 CODE03
     0-0-0/c STRC(324)   r     1 DEL                        0-0-0/c CHAR        r     1 DEL_TEXT
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$EI
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/c ASTR(9)     r     1 TEXT$C


   Procedure VPH$LIST requires 1121 words for executable code.
   Procedure VPH$LIST requires 126 words of local(AUTO) storage.
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:95   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:96   
          MINI XREF LISTING

ABORT_CMD
      5188**DCL      8956<<REMEMBR
ABORT_STEP
      5187**DCL      8957<<REMEMBR  9174<<REMEMBR
AROUND_1
      9159**LABEL    9155--GOTO
B$ALT.CODE
      7285**DCL      7285--REDEF    7286--REDEF    7286--REDEF
B$ALT.ERR.CODE
      7287**DCL      9235>>IF       9596>>IF       9600>>IF
B$ALT.ERR.ERR#
      7287**DCL      7287--REDEF
B$ALT.EVID
      7286**DCL      7286--REDEF    7286--REDEF
B$JIT.CPFLAGS1.SLEAZE
      8519**DCL      8519--REDEF
B$JIT.ERR.MID
      8426**DCL      8426--REDEF
B$JIT.MODE
      8420**DCL      9057>>IF
B$JIT$
      5988**DCL      8420--IMP-PTR  9057>>IF
B$TCB.ALT$
      7281**DCL      9235>>IF       9596>>IF       9600>>IF
B$TCB$
      5988**DCL      9235>>IF       9596>>IF       9600>>IF
BREAK_LOC
      5223**DCL      5223--REDEF    8958<<REMEMBR  9122<<REMEMBR  9125<<REMEMBR  9175<<REMEMBR
BUF_BLOCK.BUF_1
      8690**DCL      9082--ASSIGN   9116--ASSIGN   9116--ASSIGN
BUF_BLOCK.BUF_1.LEN
      8691**DCL      9108>>IF       9118>>ASSIGN
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:97   
BUF_BLOCK.COUNT
      8689**DCL      9083>>DOINDEX  9084>>IF
CHAR$132
      8719**DCL      9095<<CALLBLT  9116<<ASSIGN   9210<<ASSIGN
CHAR$140 IN PROCEDURE OUT_LIST_HDR
      9313**DCL      9326<<ASSIGN
CHAR$49 IN PROCEDURE OUT_LIST_HDR
      9314**DCL      9332<<ASSIGN   9334<<ASSIGN
CLIST_CODE
      8686**DCL      9027>>IF       9036>>IF       9041>>ASSIGN   9264<<ASSIGN   9268<<ASSIGN   9273<<ASSIGN
      9275<<ASSIGN
CLOSE_EI IN PROCEDURE REVIEW_CHK
      9583**LABEL    9598--GOTO     9606--GOTO
CMD_MASK
      5225**DCL      8943<<ASSIGN   8953<<ASSIGN   8997>>IF       9012>>IF       9027>>IF       9079>>IF
      9084>>IF       9120>>IF       9164>>IF       9321>>IF
CODE03.NGAVAL
      7276**DCL      9049>>ASSIGN
CODE03.NRECS
      7276**DCL      9051>>ASSIGN
CODE03.UGRANS
      7274**DCL      9049>>ASSIGN
CON_DUP_TBL
      5221**DCL      8978<<ASSIGN
CR_LF
      8679**DCL      9138--ASSIGN
CUR_GRANS
      8693**DCL      9049<<ASSIGN   9050>>ASSIGN
CUR_SEQ_NO
      5920**DCL      8995<<ASSIGN
DEFAULT_LIST_CODE
      8680**DCL      8961<<ASSIGN   9266>>IF       9268>>ASSIGN
DEFAULT_LIST_COLS
      8681**DCL      8962<<ASSIGN   9278>>ASSIGN
DEF_1 IN PROCEDURE REVIEW_CHK
      9564**LABEL    9555--CALLALT
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:98   
DEF_ICB
      5802**DCL      8965<<ASSIGN   8987<<ASSIGN
DEF_ICB.FID.STRING
      5821**DCL      5822--REDEF
DEL.FILES
      8712**DCL      9204<<CALLBLT  9205--CALL
DEL.GRANS
      8714**DCL      9206<<CALLBLT  9207--CALL
DELETED_BUF IN PROCEDURE REVIEW_CHK
      9363**DCL      9531--ASSIGN
DEL_OPEN_ALT IN PROCEDURE REVIEW_CHK
      9612**LABEL    9529--CALLALT
DEL_TEXT
      8709**DCL      8710--REDEF    9203<<ASSIGN
DEV_ICB.FID.STRING
      5707**DCL      5708--REDEF
DISK_HDR IN PROCEDURE OUT_LIST_HDR
      9315**DCL      9334>>ASSIGN
EI_KEY.KEY
      5919**DCL      5919--REDEF    5919--REDEF    5919--REDEF
EI_KEY.LEN
      5919**DCL      8993<<ASSIGN   8994<<ASSIGN   8994>>ASSIGN
EI_READ_ALT IN PROCEDURE REVIEW_CHK
      9596**LABEL    9569--CALLALT
EO_OCB.TYPE
      5419**DCL      5420--REDEF
ERR_FLG
      5186**DCL      9213>>IF       9223<>CALL
EXTEND
      8676**DCL      9095--CALLBLT  9095--CALLBLT
EXTEND.LEN
      8677**DCL      9087<<ASSIGN   9092<<ASSIGN   9098>>ASSIGN   9102<<ASSIGN
F$DCB.ACTPOS
      7029**DCL      7029--REDEF
F$DCB.ARS
      7004**DCL      7004--REDEF    9005>>ASSIGN   9570>>IF       9579>>ASSIGN
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:99   
F$DCB.ATTR
      7022**DCL      7023--REDEF
F$DCB.BORROW
      7037**DCL      7037--REDEF    7037--REDEF    7037--REDEF
F$DCB.DCBNAME.L
      7051**DCL      7051--IMP-SIZ
F$DCB.DDEV.IC
      7010**DCL      8941>>IF       8951>>IF       9057>>IF
F$DCB.EOMCHAR
      7008**DCL      7008--REDEF
F$DCB.FCD
      7017**DCL      9150>>IF       9169>>IF       9221>>IF       9224>>IF       9228>>IF
F$DCB.FLDID
      7032**DCL      7032--REDEF
F$DCB.FORM$
      7026**DCL      7026--REDEF
F$DCB.FSECT
      7042**DCL      7042--REDEF
F$DCB.FSN
      7019**DCL      7019--REDEF    7019--REDEF    7020--REDEF
F$DCB.HEADER$
      7025**DCL      7025--REDEF
F$DCB.IXTNSIZE
      7023**DCL      7023--REDEF
F$DCB.LASTSTA$
      7013**DCL      7013--REDEF
F$DCB.LVL
      7038**DCL      7038--REDEF
F$DCB.NAME.C
      7013**DCL      7013--REDEF
F$DCB.NOEOF
      7034**DCL      7034--REDEF
F$DCB.NRECS
      7024**DCL      7024--REDEF
F$DCB.NRECX
      7043**DCL      7043--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:100  
F$DCB.OHDR
      7035**DCL      7035--REDEF
F$DCB.ORG
      7018**DCL      7018--REDEF
F$DCB.PRECNO
      7041**DCL      7041--REDEF
F$DCB.RCSZ
      7046**DCL      7046--REDEF
F$DCB.RES
      7014**DCL      7014--REDEF
F$DCB.SETX
      7026**DCL      7026--REDEF
F$DCB.TAB$
      7025**DCL      7026--REDEF
F$DCB.TDA
      7040**DCL      7040--REDEF
F$DCB.WSN
      7015**DCL      7015--REDEF
FIN_LIST
      9169**LABEL    8958--REMEMBR  9237--GOTO
FPARAM_BUF
      5224**DCL      9047--ASSIGN
FPT_CLOSE_EI
      6760**DCL      9152<>CALL     9171<>CALL     9230<>CALL     9583<>CALL
FPT_CLOSE_EI.SN_
      6760**DCL      6760--REDEF
FPT_CLOSE_EI.UTL_
      6761**DCL      6761--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6775**DCL      6775--REDEF
FPT_CLOSE_EI.V.TYPE#
      6773**DCL      6773--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6770**DCL      6770--REDEF    6772--REDEF
FPT_CLOSE_PTL.SN_
      6886**DCL      6886--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:101  
FPT_CLOSE_PTL.UTL_
      6887**DCL      6887--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6901**DCL      6901--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6899**DCL      6899--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6896**DCL      6896--REDEF    6898--REDEF
FPT_CLOSE_READ.SN_
      6802**DCL      6802--REDEF
FPT_CLOSE_READ.UTL_
      6803**DCL      6803--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6817**DCL      6817--REDEF
FPT_CLOSE_READ.V.TYPE#
      6815**DCL      6815--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6812**DCL      6812--REDEF    6814--REDEF
FPT_CLOSE_SI.SN_
      6970**DCL      6970--REDEF
FPT_CLOSE_SI.UTL_
      6971**DCL      6971--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6985**DCL      6985--REDEF
FPT_CLOSE_SI.V.TYPE#
      6983**DCL      6983--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6980**DCL      6980--REDEF    6982--REDEF
FPT_CLOSE_STD
      6928**DCL      9226<>CALL
FPT_CLOSE_STD.SN_
      6928**DCL      6928--REDEF
FPT_CLOSE_STD.UTL_
      6929**DCL      6929--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6943**DCL      6943--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:102  
FPT_CLOSE_STD.V.TYPE#
      6941**DCL      6941--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6938**DCL      6938--REDEF    6940--REDEF
FPT_CLSEI_FT.SN_
      6844**DCL      6844--REDEF
FPT_CLSEI_FT.UTL_
      6845**DCL      6845--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6859**DCL      6859--REDEF
FPT_CLSEI_FT.V.TYPE#
      6857**DCL      6857--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6854**DCL      6854--REDEF    6856--REDEF
FPT_OPEN_EI.ACSVEH_
      6415**DCL      6416--REDEF
FPT_OPEN_EI.ALTKEYS_
      6421**DCL      6422--REDEF    6422--REDEF
FPT_OPEN_EI.HDR_
      6420**DCL      6421--REDEF
FPT_OPEN_EI.TAB_
      6419**DCL      6420--REDEF
FPT_OPEN_EI.UHL_
      6413**DCL      6414--REDEF    6414--REDEF
FPT_OPEN_EI.V.FSN#
      6453**DCL      6453--REDEF    6453--REDEF
FPT_OPEN_EI.WSN_
      6419**DCL      6419--REDEF
FPT_OPEN_EI_DELETE_IT IN PROCEDURE REVIEW_CHK
      9471**DCL      9525<<ASSIGN   9529<>CALL
FPT_OPEN_EI_DELETE_IT.ACSVEH_ IN PROCEDURE REVIEW_CHK
      9473**DCL      9474--REDEF
FPT_OPEN_EI_DELETE_IT.ALTKEYS_ IN PROCEDURE REVIEW_CHK
      9479**DCL      9480--REDEF    9480--REDEF
FPT_OPEN_EI_DELETE_IT.HDR_ IN PROCEDURE REVIEW_CHK
      9478**DCL      9479--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:103  
FPT_OPEN_EI_DELETE_IT.TAB_ IN PROCEDURE REVIEW_CHK
      9477**DCL      9478--REDEF
FPT_OPEN_EI_DELETE_IT.UHL_ IN PROCEDURE REVIEW_CHK
      9471**DCL      9472--REDEF    9472--REDEF
FPT_OPEN_EI_DELETE_IT.V IN PROCEDURE REVIEW_CHK
      9480**DCL      9526--ASSIGN
FPT_OPEN_EI_DELETE_IT.V.DELETE# IN PROCEDURE REVIEW_CHK
      9482**DCL      9528<<ASSIGN
FPT_OPEN_EI_DELETE_IT.V.FSN# IN PROCEDURE REVIEW_CHK
      9511**DCL      9511--REDEF    9511--REDEF
FPT_OPEN_EI_DELETE_IT.V.OPER.TEST# IN PROCEDURE REVIEW_CHK
      9482**DCL      9527<<ASSIGN
FPT_OPEN_EI_DELETE_IT.V_ IN PROCEDURE REVIEW_CHK
      9471**DCL      9526<<ASSIGN
FPT_OPEN_EI_DELETE_IT.WSN_ IN PROCEDURE REVIEW_CHK
      9477**DCL      9477--REDEF
FPT_OPEN_EI_SAVE
      6522**DCL      9525>>ASSIGN
FPT_OPEN_EI_SAVE.ACSVEH_
      6524**DCL      6525--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6530**DCL      6531--REDEF    6531--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6529**DCL      6530--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6528**DCL      6529--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6522**DCL      6523--REDEF    6523--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6562**DCL      6562--REDEF    6562--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6528**DCL      6528--REDEF
FPT_OPEN_OUT.ACSVEH_
      6306**DCL      6307--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6312**DCL      6313--REDEF    6313--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:104  
FPT_OPEN_OUT.HDR_
      6311**DCL      6312--REDEF
FPT_OPEN_OUT.TAB_
      6310**DCL      6311--REDEF
FPT_OPEN_OUT.UHL_
      6304**DCL      6305--REDEF    6305--REDEF
FPT_OPEN_OUT.V.FSN#
      6344**DCL      6344--REDEF    6344--REDEF
FPT_OPEN_OUT.WSN_
      6310**DCL      6310--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6197**DCL      6198--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6203**DCL      6204--REDEF    6204--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6202**DCL      6203--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6201**DCL      6202--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6195**DCL      6196--REDEF    6196--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6235**DCL      6235--REDEF    6235--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6201**DCL      6201--REDEF
FPT_READ_EI IN PROCEDURE REVIEW_CHK
      9384**DCL      9569<>CALL
FPT_READ_EI.STATION_ IN PROCEDURE REVIEW_CHK
      9387**DCL      9388--REDEF
FPT_READ_EI.V IN PROCEDURE REVIEW_CHK
      9388**DCL      9384--DCLINIT
FPT_READ_EI.V.DVBYTE.REREAD# IN PROCEDURE REVIEW_CHK
      9399**DCL      9399--REDEF
FPT_READ_EI.V.INDX# IN PROCEDURE REVIEW_CHK
      9397**DCL      9397--REDEF
FPT_READ_EI.V.SEED# IN PROCEDURE REVIEW_CHK
      9398**DCL      9567<<ASSIGN
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:105  
FPT_READ_STD
      6622**DCL      9004<>CALL
FPT_READ_STD.STATION_
      6625**DCL      6626--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6637**DCL      6637--REDEF
FPT_READ_STD.V.INDX#
      6635**DCL      6635--REDEF
FPT_READ_UC.STATION_
      6586**DCL      6587--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6598**DCL      6598--REDEF
FPT_READ_UC.V.INDX#
      6596**DCL      6596--REDEF
FPT_WRITE_ME
      6692**DCL      9064<>CALL     9140<>CALL     9533<>CALL     9574<>CALL     9580<>CALL
FPT_WRITE_ME.BUF_
      6692**DCL      9062<<ASSIGN   9138<<ASSIGN   9531<<ASSIGN   9565<<ASSIGN   9573<<ASSIGN   9575<<ASSIGN
FPT_WRITE_ME.BUF_.BOUND
      6692**DCL      9579<<ASSIGN
FPT_WRITE_ME.STATION_
      6694**DCL      6694--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6701**DCL      6701--REDEF    9063<<ASSIGN   9139<<ASSIGN   9532<<ASSIGN   9566<<ASSIGN
FPT_WRITE_OUT.STATION_
      6725**DCL      6725--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6732**DCL      6732--REDEF
FPT_WRITE_UC.STATION_
      6663**DCL      6663--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6670**DCL      6670--REDEF
FROM_SN.SN
      5569**DCL      5570--REDEF
GETCMD.OUT$
      4776**DCL      4782--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:106  
GET_CLIST_CODE_AND_COLS
      9248**PROC     9026--CALL
GET_USABLE_LEN
      9282**PROC     8992--CALL
I
      8675**DCL      9083<<DOINDEX  9084>>IF
ICB
      5574**DCL      8979<<ASSIGN   8987>>ASSIGN
ICB.A_EA_C
      5587**DCL      9262>>IF       9264>>ASSIGN
ICB.COLS
      5589**DCL      9107>>ASSIGN   9107>>ASSIGN   9107>>ASSIGN   9276>>IF       9278<<ASSIGN
ICB.CRPT
      5582**DCL      9548>>ASSIGN
ICB.DEV_MASK
      5643**DCL      8980<<ASSIGN   9042>>IF       9069>>IF       9074>>ASSIGN
ICB.DEV_MASK.MAN_TAPE
      5646**DCL      9330>>IF
ICB.FID.STRING
      5593**DCL      5594--REDEF
ICB.SPEC_TYPE
      5590**DCL      9271>>IF       9271>>IF       9321>>IF       9321>>IF
IDX
      8670**DCL      8966<<DOINDEX  8967>>ASSIGN
IDX2
      8671**DCL      8981<<DOINDEX  8982>>ASSIGN
IFSFA_PARAM.EOMCHAR#
      5948**DCL      5949--REDEF
IFSFA_PARAM.SIG1
      5942**DCL      5942--REDEF
IFSFA_PARAM.SIG2
      5942**DCL      5943--REDEF
IN_BUF_VECTOR.PTR$
      5918**DCL      9095>>CALLBLT  9116>>ASSIGN   9210>>ASSIGN   9326>>ASSIGN   9332>>ASSIGN   9334>>ASSIGN
IN_RES
      5515**DCL      5515--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:107  
IN_SN.SN
      5531**DCL      5532--REDEF
J IN PROCEDURE REVIEW_CHK
      9362**DCL      9552<<DOINDEX  9553>>DOCASE   9555>>CALL     9558>>CALL
JUMP2
      9156**LABEL    9131--GOTO
LISTSTD_L
      9004**LABEL    9166--GOTO
LIST_ABORT
      9221**LABEL    8956--REMEMBR  9174--REMEMBR  9175--REMEMBR
LIST_BUF$
      5220**DCL      8688--IMP-PTR  9082>>ASSIGN   9083>>DOINDEX  9084>>IF       9108>>IF       9116>>ASSIGN
      9116>>ASSIGN   9118>>ASSIGN
LIST_CODE
      8687**DCL      9039<<ASSIGN   9041<<ASSIGN   9042>>IF       9056<>CALL     9066>>IF       9079>>IF
      9145<<ASSIGN   9540<<ASSIGN   9543<<ASSIGN   9546<<ASSIGN   9585<<ASSIGN   9589<<ASSIGN   9593<<ASSIGN
      9610<<ASSIGN
LIST_HDR_OUT
      8672**DCL      8959<<ASSIGN   9069>>IF       9074<<ASSIGN   9078<<ASSIGN
LIST_IDX
      5220**DCL      8960<<ASSIGN   9107>>ASSIGN   9108>>IF       9111<>CALL     9112<<ASSIGN   9115<<ASSIGN
      9116>>ASSIGN   9118<<ASSIGN   9118>>ASSIGN
LIST_WKSZ
      8694**DCL      9001<<ASSIGN   9008>>ASSIGN
LIST_WORK$
      8695**DCL      9000<<ASSIGN   9007>>ASSIGN
LIS_MSG
      8666**DCL      9062--ASSIGN
M$CLOSE
        33**DCL-ENT  9152--CALL     9171--CALL     9226--CALL     9230--CALL     9583--CALL
M$EI$
      5984**DCL      9150>>IF       9169>>IF       9228>>IF       9570>>IF       9579>>ASSIGN
M$EO1$
      5985**DCL      9057>>IF       9221>>IF
M$OPEN
        33**DCL-ENT  9529--CALL
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:108  
M$READ
        34**DCL-ENT  9004--CALL     9569--CALL
M$SI$
      5985**DCL      8941>>IF       8951>>IF
M$STD1$
      5987**DCL      9005>>ASSIGN   9224>>IF
M$WRITE
        34**DCL-ENT  9064--CALL     9140--CALL     9533--CALL     9574--CALL     9580--CALL
NEXT_FILE
      9150**LABEL    8957--REMEMBR
NEXT_SPEC
      9162**LABEL    9133--GOTO
NEXT_SPEC_RET_VAL
      8673**DCL      9020<>CALL     9021>>DOWHILE  9023>>IF       9162<>CALL
NO_GRANS
      9050**LABEL    9048--CALLALT
NUMRECS IN PROCEDURE REVIEW_CHK
      9516**DCL      9549<<ASSIGN   9555<>CALL     9564<<ASSIGN   9568<<DOINDEX  9568>>DOINDEX
OCB.CS.SPEC
      5241**DCL      9290>>IF
OCB.KEYS
      5259**DCL      9296>>IF
OCB.RECSIZE.MAX_SIZE
      5239**DCL      8996>>CALL
OCB.RECSIZE.MIN_SIZE
      5237**DCL      8996>>CALL
OCB.SUMMARY
      5366**DCL      9176>>IF       9176>>IF       9176>>IF
OCB.TYPE
      5277**DCL      5278--REDEF
OCB.VFC
      5256**DCL      9088<<ASSIGN   9093<<ASSIGN   9103<<ASSIGN
OFSFA_PARAM.EOMCHAR#
      5978**DCL      5979--REDEF
OFSFA_PARAM.SIG1
      5972**DCL      5972--REDEF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:109  
OFSFA_PARAM.SIG2
      5972**DCL      5973--REDEF
OPEN_NEXT_RET_VAL
      8674**DCL      9029<>CALL     9032<>CALL     9035>>DOWHILE  9036>>IF       9042>>IF       9143>>IF
      9154<>CALL     9156<>CALL
OUT$
      8683**DCL      8982<<ASSIGN   8983<>CALL
OUT$BLK.CODE
      8597**DCL      8968>>DOCASE   9521>>DOCASE   9553>>DOCASE
OUT$BLK.NSUBLKS
      8601**DCL      8966>>DOINDEX  8981>>DOINDEX  9129>>IF       9550>>IF       9552>>DOINDEX
OUT$BLK.SUBLK$
      8622**DCL      8967>>ASSIGN   8974<>CALL     8982>>ASSIGN   9156>>CALL     9156>>CALL     9553>>DOCASE
      9555>>CALL     9555<>CALL     9558>>CALL     9558<>CALL
OUT$SYM.COUNT
      8658**DCL      8661--IMP-SIZ
OUT$SYM.TEXTC$
      8653**DCL      9156>>CALL     9156>>CALL
OUTPUT_PWIDTH
      5226**DCL      9295>>ASSIGN
OUTSPEC$
      8684**DCL      8963<<ASSIGN   8972<<ASSIGN   8990<>CALL
OUT_LIST_HDR
      9303**PROC     9073--CALL
OUT_SN.SN
      5549**DCL      5550--REDEF
PARSE_ALT IN PROCEDURE REVIEW_CHK
      9608**LABEL    9520--CALLALT
PCB
      4577**DCL      9009<>CALL     9520<>CALL
PCB.ERROR
      4681**DCL      9241<>CALL     9608<>CALL
PCB.NCHARS
      4724**DCL      9005<<ASSIGN
PCB.OUT$
      4590**DCL      8966>>DOINDEX  8967>>ASSIGN   9010>>ASSIGN   9129>>IF       9156>>CALL     9156>>CALL
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:110  
      9521>>DOCASE   9550>>IF       9552>>DOINDEX  9553>>DOCASE   9555>>CALL     9558>>CALL
PCB.ROOT$
      4582**DCL      9006<<ASSIGN   9018<<ASSIGN
PCB.U$$
      4595**DCL      9002<<ASSIGN   9015<<ASSIGN
PCB.WKSZ
      4607**DCL      9001>>ASSIGN   9008<<ASSIGN   9017<<ASSIGN   9017>>ASSIGN
PCB.WK_USED
      4710**DCL      9016>>ASSIGN   9017>>ASSIGN
PCB.WORK$
      4586**DCL      9000>>ASSIGN   9007<<ASSIGN   9016<<ASSIGN   9016>>ASSIGN
PTR$
      8682**DCL      8967<<ASSIGN   8968>>DOCASE   8970>>ASSIGN   8972>>ASSIGN   8974>>CALL     8976<>CALL
      8981>>DOINDEX  8982>>ASSIGN   9047<<ASSIGN   9048<>CALL     9049>>ASSIGN   9049>>ASSIGN   9051>>ASSIGN
      9082<<ASSIGN   9095>>CALLBLT  9095>>CALLBLT  9098>>ASSIGN   9100<<ASSIGN   9100>>ASSIGN   9100>>ASSIGN
      9202<<ASSIGN   9203>>ASSIGN   9204>>CALLBLT  9205>>CALL     9206>>CALLBLT  9207>>CALL
RELIST
      9054**LABEL    9146--GOTO
RET_VAL IN PROCEDURE REVIEW_CHK
      9360**DCL      9339--PROC     9518<<ASSIGN   9535<<ASSIGN   9537<<ASSIGN   9539<<ASSIGN   9542<<ASSIGN
      9545<<ASSIGN   9584<<ASSIGN   9588<<ASSIGN   9592<<ASSIGN   9609<<ASSIGN
REVIEW_CHK
      9339**PROC     9124--CALL
REV_BRK
      9138**LABEL    9122--REMEMBR
REV_BUF IN PROCEDURE REVIEW_CHK
      9515**DCL      9386--DCLINIT  9387--DCLINIT  9565--ASSIGN   9575--ASSIGN
REV_RET_VAL
      8696**DCL      9124<>CALL     9127>>DOCASE
SINGLE_INSPEC
      5229**DCL      9321>>IF
SKIPIT_1
      9224**LABEL    9226--CALLALT
SKIPIT_2
      9228**LABEL    9230--CALLALT
SOURCELIST$
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:111  
      8685**DCL      8964<<ASSIGN   8970<<ASSIGN   9010<<ASSIGN   9020<>CALL
SPEC_BUF
      5227**DCL      5227--REDEF
SPEC_BUF.LEN
      5227**DCL      9327>>ASSIGN
SPEC_BUF.STRING
      5227**DCL      9326>>ASSIGN
START
      8956**LABEL    8934--GOTO     8944--GOTO     8954--GOTO
STD_PARSE_ALT
      9241**LABEL    9009--CALLALT
STD_READ_ALT
      9235**LABEL    9004--CALLALT
SUMMARY
      9174**LABEL    9125--REMEMBR  9135--GOTO     9141--GOTO
SUM_IDX
      8697**DCL      9188<<ASSIGN   9196<<ASSIGN   9202>>ASSIGN   9208<<ASSIGN   9208>>ASSIGN   9211<>CALL
SUM_LINE.FILES
      8701**DCL      9184<<CALLBLT  9185--CALL
SUM_LINE.GRANS.GRANS
      8705**DCL      9190<<CALLBLT  9191--CALL
SUM_LINE.GRANS.RECS
      8707**DCL      9192<<CALLBLT  9193--CALL
SUM_LINE.REST
      8702**DCL      8703--REDEF    9189<<ASSIGN   9197<<ASSIGN
SUM_LINE_TEXT
      8698**DCL      8699--REDEF    9183<<ASSIGN   9202--ASSIGN   9210>>ASSIGN
TAPE_HDR IN PROCEDURE OUT_LIST_HDR
      9317**DCL      9332>>ASSIGN
TEMP
      8716**DCL      9098<<ASSIGN   9099<>CALL     9107<<ASSIGN   9108>>IF       9115>>ASSIGN
TEMP IN PROCEDURE OUT_LIST_HDR
      9319**DCL      9327<<ASSIGN   9328<>CALL
TEXT$C
      8667**DCL      9156<>CALL
TEXT$C.LEN
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:112  
      8668**DCL      8669--IMP-SIZ  9095>>CALLBLT  9095>>CALLBLT  9098>>ASSIGN   9100>>ASSIGN   9116>>ASSIGN
      9156>>CALL
TEXT$C.STRING
      8669**DCL      9095>>CALLBLT  9095>>CALLBLT  9116>>ASSIGN
THIS_STD_FILE
      5221**DCL      9153<<ASSIGN
TOP_REVIEW_CMD
      5989**DCL      9018--ASSIGN
TOP_STD_N
      5989**DCL      9006--ASSIGN
TOT_FILES
      5226**DCL      9054<<ASSIGN   9054>>ASSIGN   9057>>IF       9176>>IF       9176>>IF       9184>>CALLBLT
      9199>>IF       9204>>CALLBLT  9213>>IF
TOT_GRANS
      5226**DCL      9050<<ASSIGN   9050>>ASSIGN   9186>>IF       9190>>CALLBLT  9206>>CALLBLT
TOT_RECS
      5227**DCL      9051<<ASSIGN   9051>>ASSIGN   9192>>CALLBLT
TSEED IN PROCEDURE REVIEW_CHK
      9361**DCL      9548<<ASSIGN   9558<>CALL     9567>>ASSIGN
USABLE_LEN
      5229**DCL      9108>>IF       9292<<ASSIGN   9295<<ASSIGN   9298<<ASSIGN   9298>>ASSIGN
VPC$SETOUT
      8735**DCL-ENT  8990--CALL
VPD$CLOBBERLZ
      8753**DCL-ENT  9185--CALL     9191--CALL     9193--CALL     9205--CALL     9207--CALL
VPD$CLOSE_OUT
      8750**DCL-ENT  9223--CALL
VPD$COUNTER_BUMP
      8756**DCL-ENT  9530--CALL
VPD$ENLARGE_BUF
      8760**DCL-ENT  8996--CALL
VPD$FINISH_NLIST
      8768**DCL-ENT  9072--CALL     9172--CALL
VPD$GET_INPUT
      8776**DCL-ENT  9519--CALL
VPD$GET_SPEC_BUF
PL6.E3A0      #001=VPH$LIST File=VPH$LISTREV.:E05TSI                             WED 07/30/97 07:39 Page:113  
      8788**DCL-ENT  9325--CALL
VPD$INIT_STD_FILE
      8794**DCL-ENT  8976--CALL
VPD$MINIMIZE_BUF
      8762**DCL-ENT  9232--CALL
VPD$MNG_CRPT
      8918**DCL-ENT  9558--CALL
VPD$TEXTC_CHARBIN
      8807**DCL-ENT  9555--CALL
VPF$GET_NEXT_SPEC
      8836**DCL-ENT  9020--CALL     9162--CALL
VPF$OPEN_NEXT
      8839**DCL-ENT  9029--CALL     9032--CALL     9154--CALL     9156--CALL
VPF$PROCESS_INPUT_OPT
      8842**DCL-ENT  8983--CALL
VPF$SET_FROM_INFO
      8845**DCL-ENT  8974--CALL
VPG$SET_UP_WRITE
      8848**DCL-ENT  8991--CALL
VPG$WRITE_OUT
      8851**DCL-ENT  9099--CALL     9111--CALL     9211--CALL     9328--CALL     9335--CALL
VPH$GET_LIST_BUFS
      8854**DCL-ENT  9056--CALL
VPL$ERR_PROC
      8907**DCL-ENT  9216--CALL     9239--CALL     9241--CALL     9242--CALL     9605--CALL     9608--CALL
      9612--CALL
VPL$HELP
      8912**DCL-ENT  9587--CALL
VPL$QUEST
      8909**DCL-ENT  9591--CALL
WRITE_IT IN PROCEDURE REVIEW_CHK
      9570**LABEL    9602--GOTO
X$PARSE
      8724**DCL-ENT  9009--CALL     9520--CALL
XSF$LOCCODP
      8723**DCL-ENT  9048--CALL

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:114  
      629        1        /*T***********************************************************/
      630        2        /*T*                                                         */
      631        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      632        4        /*T*                                                         */
      633        5        /*T***********************************************************/
      634        6        VPH$GET_LIST_BUFS: PROC(LIST_CODE);
      635        7        /*D* NAME: VPH$GET_LIST_BUFS
      636        8             CALL: CALL VPH$GET_LIST_BUFS(LIST_CODE);
      637        9             DESCRIPTION: This procedure gets a page if not already allocated
      638       10                          and fills it with one or more buffers in TEXTC format
      639       11                          reflecting a list of the file in M$EI in the format
      640       12                          specified by LIST_CODE.
      641       13                          BUF_BLOCK is a structure containing COUNT, an sbin word,
      642       14                          and COUNT textc buffers immediately following COUNT in
      643       15                          the structure. As BUF_BLOCK is filled in with the
      644       16                          information on field definitions, CHECK_BUF is called
      645       17                          to extend BUF_BLOCK if it is not large enough.
      646       18                          VPD$INIT_COMMANDS will release these pages (pointed
      647       19                          to by LIST_BUF$) when the next command is started.
      648       20                          LIST_CODE values have the following meanings:
      649       21                            VALUE         MEANING
      650       22                            -----         -------
      651       23                              1           name only list format
      652       24                              2           access denied list format
      653       25                              3           attributes list format
      654       26                              4           extended attributes list format
      655       27        */
      656       28        /**/
      657       29        /*  INCLUDE FILES  */
      658       30        /**/
      659       31        %INCLUDE VP_DATA_R;
      660     7018        %INCLUDE B_ERRORS_C;
      661     8145        %INCLUDE FM$FIT;
      662     8366        %INCLUDE FM_FIELD_C;
      663     8407        %INCLUDE B$OBJECT_C;
      664    11837        /**/
      665    11838        /*   UTS EXTENSION */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:115  
      666    11839        /**/
      667    11840        %INCLUDE XUD_UTS_M;
      668    11922        %XUD$UTS_ENTRIES;
      669    11954        %XUD_UTS_EQU;
      670    11965        /**/
      671    11966        /*  BASED STRUCTURES  */
      672    11967        /**/
      673    11968        %FM$FIT;
      674    11971        %CODE02;
      675    11975        %CODE03;
      676    11982        %CODE04;
      677    11990        %CODE05;
      678    11993        %CODE06;
      679    11997        %FITALTKEYS;                            /* CODE08                             */
      680    12003        %CODE09;
      681    12007        %CODE10;
      682    12011        %CODE15;
      683    12014        %CODE16;
      684    12022        %CODE18;
      685    12026        %CODE19;
      686    12029        %CODE21;
      687    12032        %VREBL_DATATYPES;                       /* FOR IREL FILES                     */
      688    12107    1   DCL LEN_WRDS UBIN;
      689    12108    1   DCL TWRDS CHAR(4);
      690    12109    1   DCL LEN_BYTES UBIN;
      691    12110    1   DCL TBYTES CHAR(1);
      692    12111    1   DCL LEN_BITS UBIN;
      693    12112    1   DCL TBITS CHAR(1);
      694    12113    1   DCL TFIELD1 CHAR(3);
      695    12114    1   DCL TFIELD2 CHAR(3);
      696    12115    1   DCL F$ PTR;
      697    12116    1   DCL P$ PTR;
      698    12117    1   DCL K UBIN;
      699    12118    1   DCL DONT_PRINT BIT(1);
      700    12119    1   DCL TEMP SBIN;
      701    12120    1   DCL BASED_CHAR CHAR(1) BASED;
      702    12121    1   DCL B$UBIN1 UBIN BYTE BASED UNAL;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:116  
      703    12122        %FM$FIELD_START(STCLASS="BASED");
      704    12144        %INCLUDE F$DCB;
      705    12193        %B$TCB;
      706    12196        %B$ALT;
      707    12204    1   DCL B$ROS$ PTR SYMREF;
      708    12205    1   DCL 1 TEXT$C BASED,
      709    12206    1         2 LEN UBIN BYTE UNAL,
      710    12207    1         2 STRING CHAR(TEXT$C.LEN);
      711    12208    1   DCL 1 TEXT$C_ARY BASED,
      712    12209    1         2 LEN UBIN BYTE UNAL,
      713    12210    1         2 STRING(0:0) CHAR(1);
      714    12211    1   DCL ZERO SBIN WORD STATIC INIT(0);
      715    12212    1   DCL INCONSIST_BUF CHAR(0) CONSTANT INIT
      716    12213    1               ('  **  File inconsistency may exist  **');
      717    12214    1   DCL TIMEWARP_BUF CHAR(0) CONSTANT INIT
      718    12215    1               ('  **  WARNING:  old file from DUAL packset  **');
      719    12216    1   DCL LIST_CODE SBIN WORD;
      720    12217    1   DCL 1 BUF_BLOCK BASED(LIST_BUF$) ALIGNED,
      721    12218    1         2 COUNT SBIN WORD,
      722    12219    1         2 BUF_1,
      723    12220    1           3 LEN UBIN BYTE UNAL,
      724    12221    1           3 INFO_FIELD CHAR(45),
      725    12222    1           3 INFO REDEF INFO_FIELD,
      726    12223    1             4 ORG CHAR(3),
      727    12224    1             4 * CHAR(1),
      728    12225    1             4 TY CHAR(2),
      729    12226    1             4 GRAN CHAR(6),
      730    12227    1             4 NGAV CHAR(6),
      731    12228    1             4 RECS CHAR(8),
      732    12229    1             4 * CHAR(1),
      733    12230    1             4 DP,
      734    12231    1               5 TIME CHAR(5),
      735    12232    1               5 * CHAR(1),
      736    12233    1               5 DATE CHAR(10),
      737    12234    1               5 * CHAR(1),
      738    12235    1             4 LT REDEF DP,
      739    12236    1               5 VOL CHAR(6),
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:117  
      740    12237    1               5 * CHAR(6),
      741    12238    1               5 FSN CHAR(5),
      742    12239    1             4 * CHAR(1),
      743    12240    1           3 NAME CHAR(31),
      744    12241    1         2 *(0:0) CHAR(4);                 /* for variable part of LIST          */
      745    12242    1   DCL 1 TEXT_C,
      746    12243    1         2 C UBIN BYTE CALIGNED,
      747    12244    1         2 TEXT CHAR(31);
      748    12245        %FPT_PRECORD(FPTN = FPT_PRECORD,
      749    12246                     DCB  = M$EI,
      750    12247                     N    ="BITBIN('377777777777'O)",
      751    12248                     STCLASS = CONSTANT);
      752    12269        %FPT_TIME(FPTN = FPT_TIME,
      753    12270                  TIME = TIME_BUF,
      754    12271                  DATE = DATE_BUF,
      755    12272                  SOURCE = UTS,
      756    12273                  DEST = EXT);
      757    12292    1   DCL ON_BUF CHAR(9) STATIC INIT('  on    #');
      758    12293    1   DCL 1 ON_BUF_RDF REDEF ON_BUF,
      759    12294    1         2 * CHAR(6),
      760    12295    1         2 DP_LT CHAR(2),
      761    12296    1         2 * CHAR(1);
      762    12297    1   DCL DATE_BUF CHAR(10) STATIC;
      763    12298    1   DCL 1 TIME_BUF STATIC,
      764    12299    1         2 HH_MM CHAR(5),
      765    12300    1         2 * CHAR(6);
      766    12301    1   DCL 1 CNTL_NAME_TBL CONSTANT,
      767    12302    1         2 LEN(0:17) UBIN BYTE UNAL INIT(5*3,4,5,
      768    12303    1           7*2,5,7,3,
      769    12304    1           5*8),
      770    12305    1         2 TEXT(0:17) CHAR(7) INIT(',read',',delr',',wnew',',upd',',delf',
      771    12306    1           ',nolist',',reattr',',exec',',create',',au',
      772    12307    1           ',aurd',',tctl',',BUG!'*3,
      773    12308    1           ',BUG!'*3);
      774    12309    1   DCL TRUTH (0:1) CHAR(3) CONSTANT INIT(
      775    12310    1       ' no',
      776    12311    1       'yes' );
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:118  
      777    12312    1   DCL UNITS (0:4) CHAR(8) CONSTANT INIT(
      778    12313    1       '!BUG!   ',
      779    12314    1       'bits    ',
      780    12315    1       'nibbles ',
      781    12316    1       'bytes   ',
      782    12317    1       'elements' );
      783    12318    1   DCL 1 TYPE_ARY (0:62) CONSTANT,
      784    12319    1         2 NAME CHAR(8) CALIGNED INIT(
      785    12320    1              'NO      ',                  /* 00                                 */
      786    12321    1              'SBIN    ',                  /* 01                                 */
      787    12322    1              'DFIX    ',                  /* 02                                 */
      788    12323    1              'SFLT    ',                  /* 03                                 */
      789    12324    1              'DFLT    ',                  /* 04                                 */
      790    12325    1              'SCFIX   ',                  /* 05                                 */
      791    12326    1              'DCFIX   ',                  /* 06                                 */
      792    12327    1              'COMPLEX ',                  /* 07                                 */
      793    12328    1              'DCOMPLEX',                  /* 08                                 */
      794    12329    1              'PDLA    ',                  /* 09                                 */
      795    12330    1              'PDFLT   ',                  /* 10                                 */
      796    12331    1              'PDCLA   ',                  /* 11                                 */
      797    12332    1              'PDCFLT  ',                  /* 12                                 */
      798    12333    1              'POINTER ',                  /* 13                                 */
      799    12334    1              'OFFSET  ',                  /* 14                                 */
      800    12335    1              'LABEL   ',                  /* 15                                 */
      801    12336    1              'ENTRY   ',                  /* 16                                 */
      802    12337    1              'STRUCTUR',                  /* 17                                 */
      803    12338    1              'AREA    ',                  /* 18                                 */
      804    12339    1              'BIT     ',                  /* 19                                 */
      805    12340    1              'VBIT    ',                  /* 20                                 */
      806    12341    1              'CHAR    ',                  /* 21                                 */
      807    12342    1              'TEXTC   ',                  /* 22                                 */
      808    12343    1              'FILE    ',                  /* 23                                 */
      809    12344    1              'UBIN    ',                  /* 24                                 */
      810    12345    1              'PDTA    ',                  /* 25                                 */
      811    12346    1              'ACHAR   ',                  /* 26                                 */
      812    12347    1              'ABIT    ',                  /* 27                                 */
      813    12348    1              'EPTR    ',                  /* 28                                 */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:119  
      814    12349    1              'COMP1   ',                  /* 29                                 */
      815    12350    1              'COMP2   ',                  /* 30                                 */
      816    12351    1              'PDTE    ',                  /* 31                                 */
      817    12352    1              'INDEX1  ',                  /* 32                                 */
      818    12353    1              'INDEX2  ',                  /* 33                                 */
      819    12354    1              'FEVERY  ',                  /* 34                                 */
      820    12355    1              'FLOGICAL',                  /* 35                                 */
      821    12356    1              'FANY    ',                  /* 36                                 */
      822    12357    1              'FLABEL  ',                  /* 37                                 */
      823    12358    1              'FUCB    ',                  /* 38                                 */
      824    12359    1              'INTCNST ',                  /* 39                                 */
      825    12360    1              'PDNS    ',                  /* 40                                 */
      826    12361    1              'UDNS    ',                  /* 41                                 */
      827    12362    1              'UDLS    ',                  /* 42                                 */
      828    12363    1              'UDTS    ',                  /* 43                                 */
      829    12364    1              'UDLO    ',                  /* 44                                 */
      830    12365    1              'UDTO    ',                  /* 45                                 */
      831    12366    1              'ASTRUCTR',                  /* 46                                 */
      832    12367    1              'LIST    ',                  /* 47                                 */
      833    12368    1              'VLIST   ',                  /* 48                                 */
      834    12369    1              'DSCR    ',                  /* 49                                 */
      835    12370    1              'UDFLT   ',                  /* 50                                 */
      836    12371    1              'PDLE    ',                  /* 51                                 */
      837    12372    1              'ENUMTYPE',                  /* 52                                 */
      838    12373    1              'SET     ',                  /* 53                                 */
      839    12374    1              'DATE    ',                  /* 54                                 */
      840    12375    1              'UTS     ',                  /* 55                                 */
      841    12376    1              'TEXTH   ',                  /* 56                                 */
      842    12377    1              'TIME    ',                  /* 57                                 */
      843    12378    1              '        ',                  /* 58                                 */
      844    12379    1              '        ',                  /* 59                                 */
      845    12380    1              'NULL    ',                  /* 60                                 */
      846    12381    1              'VIRT ARY',                  /* 61                                 */
      847    12382    1              'REAL ARY'),                 /* 62                                 */
      848    12383    1         2 CODE UBIN BYTE CALIGNED INIT(
      849    12384    1              %NO_DATATYPE,                /* 00                                 */
      850    12385    1              %SBIN_DATATYPE,              /* 01                                 */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:120  
      851    12386    1              %DFIX_DATATYPE,              /* 02                                 */
      852    12387    1              %SFLT_DATATYPE,              /* 03                                 */
      853    12388    1              %DFLT_DATATYPE,              /* 04                                 */
      854    12389    1              %SCFIX_DATATYPE,             /* 05                                 */
      855    12390    1              %DCFIX_DATATYPE,             /* 06                                 */
      856    12391    1              %COMPLEX_DATATYPE,           /* 07                                 */
      857    12392    1              %DCOMPLEX_DATATYPE,          /* 08                                 */
      858    12393    1              %PDLA_DATATYPE,              /* 09                                 */
      859    12394    1              %PDFLT_DATATYPE,             /* 10                                 */
      860    12395    1              %PDCLA_DATATYPE,             /* 11                                 */
      861    12396    1              %PDCFLT_DATATYPE,            /* 12                                 */
      862    12397    1              %POINTER_DATATYPE,           /* 13                                 */
      863    12398    1              %OFFSET_DATATYPE,            /* 14                                 */
      864    12399    1              %LABEL_DATATYPE,             /* 15                                 */
      865    12400    1              %ENTRY_DATATYPE,             /* 16                                 */
      866    12401    1              %STRUCTURE_DATATYPE,         /* 17                                 */
      867    12402    1              %AREA_DATATYPE,              /* 18                                 */
      868    12403    1              %BIT_DATATYPE,               /* 19                                 */
      869    12404    1              %VBIT_DATATYPE,              /* 20                                 */
      870    12405    1              %CHAR_DATATYPE,              /* 21                                 */
      871    12406    1              %VCHAR_DATATYPE,             /* 22                                 */
      872    12407    1              %FILE_DATATYPE,              /* 23                                 */
      873    12408    1              %UBIN_DATATYPE,              /* 24                                 */
      874    12409    1              %PDTA_DATATYPE,              /* 25                                 */
      875    12410    1              %ACHAR_DATATYPE,             /* 26                                 */
      876    12411    1              %ABIT_DATATYPE,              /* 27                                 */
      877    12412    1              %EPTR_DATATYPE,              /* 28                                 */
      878    12413    1              %COMP1_DATATYPE,             /* 29                                 */
      879    12414    1              %COMP2_DATATYPE,             /* 30                                 */
      880    12415    1              %PDTE_DATATYPE,              /* 31                                 */
      881    12416    1              %INDEX1_DATATYPE,            /* 32                                 */
      882    12417    1              %INDEX2_DATATYPE,            /* 33                                 */
      883    12418    1              %FEVERY_DATATYPE,            /* 34                                 */
      884    12419    1              %FLOGICAL_DATATYPE,          /* 35                                 */
      885    12420    1              %FANY_DATATYPE,              /* 36                                 */
      886    12421    1              %FLABEL_DATATYPE,            /* 37                                 */
      887    12422    1              %FUCB_DATATYPE,              /* 38                                 */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:121  
      888    12423    1              %INTCNST_DATATYPE,           /* 39                                 */
      889    12424    1              %PDNS_DATATYPE,              /* 40                                 */
      890    12425    1              %UDNS_DATATYPE,              /* 41                                 */
      891    12426    1              %UDLS_DATATYPE,              /* 42                                 */
      892    12427    1              %UDTS_DATATYPE,              /* 43                                 */
      893    12428    1              %UDLO_DATATYPE,              /* 44                                 */
      894    12429    1              %UDTO_DATATYPE,              /* 45                                 */
      895    12430    1              %ASTRUCTURE_DATATYPE,        /* 46                                 */
      896    12431    1              %VECTOR_DATATYPE,            /* 47                                 */
      897    12432    1              %VARVECTOR_DATATYPE,         /* 48                                 */
      898    12433    1              %DSCR_DATATYPE,              /* 49                                 */
      899    12434    1              %UDFLT_DATATYPE,             /* 50                                 */
      900    12435    1              %PDLE_DATATYPE,              /* 51                                 */
      901    12436    1              %ENUMTYPE_DATATYPE,          /* 52                                 */
      902    12437    1              %SET_DATATYPE,               /* 53                                 */
      903    12438    1              %DATE_DATATYPE,              /* 54                                 */
      904    12439    1              %UTS_DATATYPE,               /* 55                                 */
      905    12440    1              %TEXTH_DATATYPE,             /* 56                                 */
      906    12441    1              %TIME_DATATYPE,              /* 57                                 */
      907    12442    1              0,                           /* 58                                 */
      908    12443    1              0,                           /* 59                                 */
      909    12444    1              %NULL_DATATYPE,              /* 60                                 */
      910    12445    1              %VIRTUAL_ARRAY_DATATYPE,     /* 61                                 */
      911    12446    1              %REAL_ARRAY_DATATYPE),       /* 62                                 */
      912    12447    1         2 CLASS UBIN BYTE CALIGNED INIT(
      913    12448    1              1,                           /* %NO_DATATYPE,       00             */
      914    12449    1              1,                           /* %SBIN_DATATYPE,     01             */
      915    12450    1              4,                           /* %DFIX_DATATYPE,     02             */
      916    12451    1              1,                           /* %SFLT_DATATYPE,     03             */
      917    12452    1              1,                           /* %DFLT_DATATYPE,     04             */
      918    12453    1              4,                           /* %SCFIX_DATATYPE,    05             */
      919    12454    1              4,                           /* %DCFIX_DATATYPE,    06             */
      920    12455    1              4,                           /* %COMPLEX_DATATYPE,  07             */
      921    12456    1              4,                           /* %DCOMPLEX_DATATYPE, 08             */
      922    12457    1              2,                           /* %PDLA_DATATYPE,     09             */
      923    12458    1              2,                           /* %PDFLT_DATATYPE,    10             */
      924    12459    1              4,                           /* %PDCLA_DATATYPE,    11             */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:122  
      925    12460    1              4,                           /* %PDCFLT_DATATYPE,   12             */
      926    12461    1              4,                           /* %POINTER_DATATYPE,  13             */
      927    12462    1              4,                           /* %OFFSET_DATATYPE,   14             */
      928    12463    1              4,                           /* %LABEL_DATATYPE,    15             */
      929    12464    1              4,                           /* %ENTRY_DATATYPE,    16             */
      930    12465    1              4,                           /* %STRUCTURE_DATATYPE,17             */
      931    12466    1              4,                           /* %AREA_DATATYPE,     18             */
      932    12467    1              4,                           /* %BIT_DATATYPE,      19             */
      933    12468    1              4,                           /* %VBIT_DATATYPE,     20             */
      934    12469    1              1,                           /* %CHAR_DATATYPE,     21             */
      935    12470    1              1,                           /* %VCHAR_DATATYPE,    22             */
      936    12471    1              4,                           /* %FILE_DATATYPE,     23             */
      937    12472    1              1,                           /* %UBIN_DATATYPE,     24             */
      938    12473    1              2,                           /* %PDTA_DATATYPE,     25             */
      939    12474    1              4,                           /* %ACHAR_DATATYPE,    26             */
      940    12475    1              4,                           /* %ABIT_DATATYPE,     27             */
      941    12476    1              4,                           /* %EPTR_DATATYPE,     28             */
      942    12477    1              4,                           /* %COMP1_DATATYPE,    29             */
      943    12478    1              4,                           /* %COMP2_DATATYPE,    30             */
      944    12479    1              2,                           /* %PDTE_DATATYPE,     31             */
      945    12480    1              4,                           /* %INDEX1_DATATYPE,   32             */
      946    12481    1              4,                           /* %INDEX2_DATATYPE,   33             */
      947    12482    1              4,                           /* %FEVERY_DATATYPE,   34             */
      948    12483    1              4,                           /* %FLOGICAL_DATATYPE, 35             */
      949    12484    1              4,                           /* %FANY_DATATYPE,     36             */
      950    12485    1              4,                           /* %FLABEL_DATATYPE,   37             */
      951    12486    1              4,                           /* %FUCB_DATATYPE,     38             */
      952    12487    1              4,                           /* %INTCNST_DATATYPE,  39             */
      953    12488    1              2,                           /* %PDNS_DATATYPE,     40             */
      954    12489    1              2,                           /* %UDNS_DATATYPE,     41             */
      955    12490    1              2,                           /* %UDLS_DATATYPE,     42             */
      956    12491    1              2,                           /* %UDTS_DATATYPE,     43             */
      957    12492    1              2,                           /* %UDLO_DATATYPE,     44             */
      958    12493    1              2,                           /* %UDTO_DATATYPE,     45             */
      959    12494    1              4,                           /* %ASTRUCTURE_DATATYPE,46            */
      960    12495    1              3,                           /* %VECTOR_DATATYPE,   47             */
      961    12496    1              5,                           /* %VARVECTOR_DATATYPE,48             */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:123  
      962    12497    1              4,                           /* %DSCR_DATATYPE,     49             */
      963    12498    1              2,                           /* %UDFLT_DATATYPE,    50             */
      964    12499    1              2,                           /* %PDLE_DATATYPE,     51             */
      965    12500    1              4,                           /* %ENUMTYPE_DATATYPE, 52             */
      966    12501    1              4,                           /* %SET_DATATYPE,      53             */
      967    12502    1              2,                           /* %DATE_DATATYPE,     54             */
      968    12503    1              1,                           /* %UTS_DATATYPE,      55             */
      969    12504    1              1,                           /* %TEXTH_DATATYPE,    56             */
      970    12505    1              2,                           /* %TIME_DATATYPE,     57             */
      971    12506    1              0,                           /* --,   58                           */
      972    12507    1              0,                           /* --,   59                           */
      973    12508    1              4,                           /* %NULL_DATATYPE,     60             */
      974    12509    1              4,                           /* %VIRTUAL_ARRAY_DATATYPE,61         */
      975    12510    1              4),                          /* %REAL_ARRAY_DATATYPE,62            */
      976    12511    1         2 UNITS UBIN BYTE CALIGNED INIT(
      977    12512    1              3,                           /* %NO_DATATYPE,       00             */
      978    12513    1              1,                           /* %SBIN_DATATYPE,     01             */
      979    12514    1              0,                           /* %DFIX_DATATYPE,     02             */
      980    12515    1              3,                           /* %SFLT_DATATYPE,     03             */
      981    12516    1              3,                           /* %DFLT_DATATYPE,     04             */
      982    12517    1              0,                           /* %SCFIX_DATATYPE,    05             */
      983    12518    1              0,                           /* %DCFIX_DATATYPE,    06             */
      984    12519    1              0,                           /* %COMPLEX_DATATYPE,  07             */
      985    12520    1              0,                           /* %DCOMPLEX_DATATYPE, 08             */
      986    12521    1              2,                           /* %PDLA_DATATYPE,     09             */
      987    12522    1              2,                           /* %PDFLT_DATATYPE,    10             */
      988    12523    1              0,                           /* %PDCLA_DATATYPE,    11             */
      989    12524    1              0,                           /* %PDCFLT_DATATYPE,   12             */
      990    12525    1              0,                           /* %POINTER_DATATYPE,  13             */
      991    12526    1              0,                           /* %OFFSET_DATATYPE,   14             */
      992    12527    1              0,                           /* %LABEL_DATATYPE,    15             */
      993    12528    1              0,                           /* %ENTRY_DATATYPE,    16             */
      994    12529    1              0,                           /* %STRUCTURE_DATATYPE,17             */
      995    12530    1              0,                           /* %AREA_DATATYPE,     18             */
      996    12531    1              0,                           /* %BIT_DATATYPE,      19             */
      997    12532    1              0,                           /* %VBIT_DATATYPE,     20             */
      998    12533    1              3,                           /* %CHAR_DATATYPE,     21             */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:124  
      999    12534    1              3,                           /* %VCHAR_DATATYPE,    22             */
     1000    12535    1              0,                           /* %FILE_DATATYPE,     23             */
     1001    12536    1              1,                           /* %UBIN_DATATYPE,     24             */
     1002    12537    1              2,                           /* %PDTA_DATATYPE,     25             */
     1003    12538    1              0,                           /* %ACHAR_DATATYPE,    26             */
     1004    12539    1              0,                           /* %ABIT_DATATYPE,     27             */
     1005    12540    1              0,                           /* %EPTR_DATATYPE,     28             */
     1006    12541    1              0,                           /* %COMP1_DATATYPE,    29             */
     1007    12542    1              0,                           /* %COMP2_DATATYPE,    30             */
     1008    12543    1              2,                           /* %PDTE_DATATYPE,     31             */
     1009    12544    1              0,                           /* %INDEX1_DATATYPE,   32             */
     1010    12545    1              0,                           /* %INDEX2_DATATYPE,   33             */
     1011    12546    1              0,                           /* %FEVERY_DATATYPE,   34             */
     1012    12547    1              0,                           /* %FLOGICAL_DATATYPE, 35             */
     1013    12548    1              0,                           /* %FANY_DATATYPE,     36             */
     1014    12549    1              0,                           /* %FLABEL_DATATYPE,   37             */
     1015    12550    1              0,                           /* %FUCB_DATATYPE,     38             */
     1016    12551    1              0,                           /* %INTCNST_DATATYPE,  39             */
     1017    12552    1              2,                           /* %PDNS_DATATYPE,     40             */
     1018    12553    1              3,                           /* %UDNS_DATATYPE,     41             */
     1019    12554    1              3,                           /* %UDLS_DATATYPE,     42             */
     1020    12555    1              3,                           /* %UDTS_DATATYPE,     43             */
     1021    12556    1              3,                           /* %UDLO_DATATYPE,     44             */
     1022    12557    1              3,                           /* %UDTO_DATATYPE,     45             */
     1023    12558    1              0,                           /* %ASTRUCTURE_DATATYPE,46            */
     1024    12559    1              4,                           /* %VECTOR_DATATYPE,   47             */
     1025    12560    1              4,                           /* %VARVECTOR_DATATYPE,48             */
     1026    12561    1              0,                           /* %DSCR_DATATYPE,     49             */
     1027    12562    1              3,                           /* %UDFLT_DATATYPE,    50             */
     1028    12563    1              2,                           /* %PDLE_DATATYPE,     51             */
     1029    12564    1              0,                           /* %ENUMTYPE_DATATYPE, 52             */
     1030    12565    1              0,                           /* %SET_DATATYPE,      53             */
     1031    12566    1              2,                           /* %DATE_DATATYPE,     54             */
     1032    12567    1              1,                           /* %UTS_DATATYPE,      55             */
     1033    12568    1              3,                           /* %TEXTH_DATATYPE,    56             */
     1034    12569    1              2,                           /* %TIME_DATATYPE,     57             */
     1035    12570    1              0,                           /* --,   58                           */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:125  
     1036    12571    1              0,                           /* --,   59                           */
     1037    12572    1              0,                           /* %NULL_DATATYPE,     60             */
     1038    12573    1              0,                           /* %VIRTUAL_ARRAY_DATATYPE,61         */
     1039    12574    1              0);                          /* %REAL_ARRAY_DATATYPE,62            */
     1040    12575    1   DCL CODE SBIN WORD;
     1041    12576    1   DCL CODE$ PTR;
     1042    12577    1   DCL CODES_IDX SBIN WORD;
     1043    12578    1   DCL BIT$ARY(0:0) BIT(1) BASED;
     1044    12579    1   DCL CHAR$7 CHAR(7) BASED;
     1045    12580    1   DCL CHAR$1 CHAR(1) BASED;
     1046    12581    1   DCL 1 NUM$ARY BASED,
     1047    12582    1         2 * UBIN BYTE UNAL,
     1048    12583    1         2 N(0:0),
     1049    12584    1           3 * CHAR(13),
     1050    12585    1           3 NUM CHAR(5);
     1051    12586    1   DCL 1 COL$ARY BASED,
     1052    12587    1         2 * UBIN BYTE UNAL,
     1053    12588    1         2 N(0:0),
     1054    12589    1           3 * CHAR(2),
     1055    12590    1           3 TXT CHAR(8);
     1056    12591    1   DCL I SBIN WORD;
     1057    12592    1   DCL J SBIN WORD;
     1058    12593    1   DCL PTR$ PTR;
     1059    12594    1   DCL EQ_IDX SBIN;
     1060    12595    1   DCL BYTE_IDX SBIN WORD;
     1061    12596    1   DCL NUM_BYTES SBIN WORD;
     1062    12597    1   DCL EXP_TIME SBIN WORD;
     1063    12598    1   DCL CREATE_TIME UBIN WORD;
     1064    12599    1   DCL UTS_TMP UBIN WORD;
     1065    12600    1   DCL EXP_INTERVAL_DAYS SBIN WORD;
     1066    12601    1   DCL CONV_BUF CHAR(6);
     1067    12602    1   DCL OLD_BUF$ PTR;
     1068    12603    1   DCL NEW_BUF$ PTR;
     1069    12604    1   DCL TCODE$ PTR;
     1070    12605    1   DCL DENS_STR CHAR(5);
     1071    12606        /**/
     1072    12607        /*  ENTRY DCLS  */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:126  
     1073    12608        /**/
     1074    12609        %VP_ENTRIES (OMIT=VPH$GET_LIST_BUFS);
     1075    12817    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
     1076    12818    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
     1077    12819        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:127  
     1078    12820    2           IF LIST_BUF$=ADDR(NIL) THEN DO; /* Do we have a buffer for this       */
     1079    12821    2               CALL VPD$GET_BUF(LIST_BUF$,1024) /* nope - go get a page          */
     1080    12822    3                WHENALTRETURN DO;
     1081    12823    3                   CALL VPL$ERR_PROC(3,0); /* Sigh                               */
     1082    12824    3                   END;
     1083    12825    2               LIST_SIZE=1024;             /* remember how much we have          */
     1084    12826    2               END;
     1085    12827    1           BUF_BLOCK.COUNT = 1;
     1086    12828    1           IF LIST_CODE=1
     1087    12829    1            THEN                           /* NAME only LIST                     */
     1088    12830    2            DO;
     1089    12831    3               IF ICB.FFID THEN DO;
     1090    12832    3                   CALL GET_FULL_FID(PINCRC(ADDR(BUF_BLOCK.BUF_1),1),LEN_BYTES);
     1091    12833    3                   ADDR(BUF_BLOCK.BUF_1)->B$UBIN1 = LEN_BYTES;
     1092    12834    3                   END;
     1093    12835    2                ELSE
     1094    12836    2                  BUF_BLOCK.BUF_1 = DIN_NAME;
     1095    12837    2               RETURN;
     1096    12838    2               END;
     1097    12839    2           IF ICB.FFID THEN DO;
     1098    12840    2               CALL GET_FULL_FID(ADDR(BUF_BLOCK.BUF_1.NAME),LEN_BYTES);
     1099    12841    2               END;
     1100    12842    2            ELSE DO;
     1101    12843    2               BUF_BLOCK.BUF_1.NAME = ADDR(DIN_NAME) -> TEXT$C.STRING;
     1102    12844    2               LEN_BYTES = DIN_NAME.LEN;
     1103    12845    2               END;
     1104    12846    1           BUF_BLOCK.BUF_1.LEN = SIZEC(BUF_BLOCK.BUF_1.INFO_FIELD) + LEN_BYTES;
     1105    12847    1           IF LIST_CODE = 2
     1106    12848    1            THEN                           /* ACCESS DENIED on a L(A) or better  */
     1107    12849    2            DO;
     1108    12850    2               BUF_BLOCK.BUF_1.INFO_FIELD = '*** Access denied ***';
     1109    12851    2               RETURN;
     1110    12852    2               END;
     1111    12853        /******************************************************************************/
     1112    12854        /*                                                                            */
     1113    12855        /*  The remaining code is for L(A) or better                                  */
     1114    12856        /*                                                                            */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:128  
     1115    12857        /******************************************************************************/
     1116    12858    1           BUF_BLOCK.BUF_1.INFO_FIELD = ' ';
     1117    12859    1           IF M$EI$->F$DCB.DESC.DELF
     1118    12860    1            THEN
     1119    12861    1              IF M$EI$->F$DCB.DESC.ARCHIVE
     1120    12862    1               THEN
     1121    12863    2               DO;
     1122    12864    2                  BUF_BLOCK.BUF_1.INFO_FIELD = '*** Stowed File ***';
     1123    12865    2                  GOTO DONT_ORG;
     1124    12866    2                  END;
     1125    12867    1               ELSE
     1126    12868    2               DO;
     1127    12869    2                  BUF_BLOCK.BUF_1.INFO_FIELD = '*** Deleted File ***';
     1128    12870    2                  RETURN;
     1129    12871    2                  END;
     1130    12872    1           I = %MAX_ORG#;
     1131    12873    2           DO WHILE (I > 0 AND M$EI$->F$DCB.ORG~=ORG_TBL.ORG_MON(I));
     1132    12874    2              I = I -1;
     1133    12875    2              END;
     1134    12876    1           BUF_BLOCK.BUF_1.INFO.ORG = ORG_TBL.ABBR(I);
     1135    12877    1           BUF_BLOCK.BUF_1.INFO.TY  = M$EI$->F$DCB.TYPE;
     1136    12878        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:129  
     1137    12879    1   DONT_ORG:
     1138    12880    1           IF ICB.DEV_MASK='100'O
     1139    12881    1            THEN                           /* L(A) or better for LT              */
     1140    12882    2            DO;
     1141    12883    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.GRAN,M$EI$->F$DCB.BLKL);
     1142    12884    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.NGAV,M$EI$->F$DCB.RECL);
     1143    12885    2               BUF_BLOCK.BUF_1.INFO.LT.VOL = M$EI$->F$DCB.PSN;
     1144    12886    2               CALL M$PRECORD(FPT_PRECORD) ALTRET(PREC_ALT);
     1145    12887    3               DO WHILE('0'B);
     1146    12888    3   PREC_ALT:      IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$EOF
     1147    12889    3                   THEN
     1148    12890    3                     CALL VPL$ERR_PROC(3,0);
     1149    12891    3                  END;
     1150    12892    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.RECS,M$EI$->F$DCB.ARS);
     1151    12893    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.LT.FSN,M$EI$->F$DCB.FSN);
     1152    12894    2               CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.LT.FSN));
     1153    12895    2               CALL M$CLOSE(FPT_CLOSE_EI);
     1154    12896    2               END;
     1155    12897        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:130  
     1156    12898    1            ELSE                           /* L(A) or better, non-LT             */
     1157    12899    2            DO;
     1158    12900                                                /* CODE04: MODIFICATION time          */
     1159    12901    2               CODE$ = FPARAM$;
     1160    12902    2               CALL XSF$LOCCODP(CODE$,4) ALTRET(NO_CODE_4);
     1161    12903    2               IF TEST_MODE=1
     1162    12904    2                THEN
     1163    12905    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);
     1164    12906    2                ELSE
     1165    12907    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE04.MODIFY.TIME);
     1166    12908    2               CALL M$TIME(FPT_TIME);
     1167    12909    2               BUF_BLOCK.BUF_1.INFO.DP.TIME = TIME_BUF.HH_MM;
     1168    12910    2               BUF_BLOCK.BUF_1.INFO.DP.DATE = DATE_BUF;
     1169    12911    2   NO_CODE_4:
     1170    12912                                                /* CODE03: GRANS, NGAVAL, RECS        */
     1171    12913    2               CODE$ = FPARAM$;
     1172    12914    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_CODE_3);
     1173    12915    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.GRAN,CODE$->CODE03.UGRANS);
     1174    12916    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.NGAV,CODE$->CODE03.NGAVAL);
     1175    12917    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.RECS,CODE$->CODE03.NRECS);
     1176    12918    2               END;
     1177    12919                                                /* L(A) or better for ANY file        */
     1178    12920    1           CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.GRAN));
     1179    12921    1           CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.NGAV));
     1180    12922    1           CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.RECS));
     1181    12923    1   NO_CODE_3:
     1182    12924        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:131  
     1183    12925    1           OLD_BUF$ = ADDR(BUF_BLOCK.BUF_1.LEN);
     1184    12926                                                /* CODE09: ACCount controls           */
     1185    12927                                                /* CODE09: ACSvehicle controls        */
     1186    12928    2           DO CODE=9 TO 10;
     1187    12929    2              CODE$ = FPARAM$;
     1188    12930    2              CODES_IDX = CODE;
     1189    12931    2              CALL XSF$LOCCODE(CODE$,CODES_IDX) ALTRET(LOOP_END);
     1190    12932    2              NUM_BYTES = FPARAM$->FM$FIT.CODES.NDW(CODES_IDX)*4;
     1191    12933    2              BYTE_IDX = 0;
     1192    12934    3              DO WHILE((BYTE_IDX+3<NUM_BYTES AND CODE=10) /* ACS specs left      */
     1193    12935    3                OR (BYTE_IDX+9<NUM_BYTES AND CODE=9)); /* ACC specs left         */
     1194    12936    3                 NEW_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1195    12937    3                 TCODE$ = PINCRC(CODE$,BYTE_IDX);
     1196    12938    3                 IF CODE=9
     1197    12939    4                  THEN DO;                 /* ACCT ACCESS CONTROLS               */
     1198    12940    4                     BYTE_IDX = BYTE_IDX+10;
     1199    12941    4                     CALL INDEX(I,' ',TCODE$->CODE09.ACCT);
     1200    12942    4                     NEW_BUF$->TEXT$C.LEN = I + 5;
     1201    12943    4                     CALL CONCAT(NEW_BUF$->TEXT$C.STRING,
     1202    12944    4                       '  ',
     1203    12945    4                       SUBSTR(TCODE$->CODE09.ACCT,0,I),
     1204    12946    4                       '<A>');
     1205    12947    4                     END;
     1206    12948    4                  ELSE DO;                 /* VEHICLE ACCESS CONTROLS            */
     1207    12949    4                     BYTE_IDX = BYTE_IDX+TCODE$->CODE10.ACSVEH.C+3;
     1208    12950    4                     NEW_BUF$->TEXT$C.LEN = TCODE$->CODE10.ACSVEH.C + 5;
     1209    12951    4                     CALL CONCAT(NEW_BUF$->TEXT$C.STRING,
     1210    12952    4                       '  ',
     1211    12953    4                       TCODE$->CODE10.ACSVEH.T,
     1212    12954    4                       '<P>');
     1213    12955    4                     END;
     1214    12956    3                 EQ_IDX = NEW_BUF$->TEXT$C.LEN+1;
     1215    12957    4                 DO I=0 TO 17;             /* REPORT CONTROLS                    */
     1216    12958    4                    IF TCODE$->BIT$ARY(I)
     1217    12959    4                     THEN
     1218    12960    5                     DO;
     1219    12961    5                        PINCRC(NEW_BUF$,NEW_BUF$->TEXT$C.LEN+1)->CHAR$7 =
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:132  
     1220    12962    5                          CNTL_NAME_TBL.TEXT(I);
     1221    12963    5                        NEW_BUF$->TEXT$C.LEN = NEW_BUF$->TEXT$C.LEN+CNTL_NAME_TBL.LEN(I
             12963                                 );
     1222    12964    5                        END;
     1223    12965    4                    END;
     1224    12966    3                 IF EQ_IDX>NEW_BUF$->TEXT$C.LEN
     1225    12967    3                  THEN
     1226    12968    3                    NEW_BUF$->TEXT$C.LEN = EQ_IDX;
     1227    12969                                                /* Insure that the '=' gets out       */
     1228    12970                                                /* even on cntls='0'B                 */
     1229    12971    3                 PINCRC(NEW_BUF$,EQ_IDX)->CHAR$1 = '=';
     1230    12972    3                 IF OLD_BUF$->TEXT$C.LEN+NEW_BUF$->TEXT$C.LEN>=USABLE_LEN
     1231    12973    3                  THEN
     1232    12974    4                  DO;                      /* MAKE TWO BUFFERS                   */
     1233    12975    4                     BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1234    12976    4                     OLD_BUF$ = NEW_BUF$;
     1235    12977    4                     END;
     1236    12978    3                  ELSE
     1237    12979    4                  DO;                      /* KEEP AS ONE BUFFER                 */
     1238    12980    4                     OLD_BUF$->TEXT$C.LEN = OLD_BUF$->TEXT$C.LEN+
     1239    12981    4                       NEW_BUF$->TEXT$C.LEN+1;
     1240    12982    4                     NEW_BUF$->TEXT$C.LEN = ASCBIN(' ');
     1241    12983    4                     END;
     1242    12984    3                 END;
     1243    12985    2   LOOP_END:  END;
     1244    12986                                                /* CODE03: FILE INCONS and NBUF bits  */
     1245    12987    1           CODE$ = FPARAM$;
     1246    12988    1           CALL XSF$LOCCODP(CODE$,3) ALTRET(EA_TIME);
     1247    12989    1           IF CODE$->CODE03.DESC.BAD
     1248    12990    1            THEN
     1249    12991    2            DO;
     1250    12992    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1251    12993    2               OLD_BUF$->TEXT$C.LEN = SIZEC(INCONSIST_BUF);
     1252    12994    2               OLD_BUF$->TEXT$C.STRING = INCONSIST_BUF;
     1253    12995    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1254    12996    2               END;
     1255    12997    1           IF CODE$->CODE03.DESC.NBUF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:133  
     1256    12998    1            THEN
     1257    12999    2            DO;
     1258    13000    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1259    13001    2               OLD_BUF$->TEXT$C.LEN = SIZEC(TIMEWARP_BUF);
     1260    13002    2               OLD_BUF$->TEXT$C.STRING = TIMEWARP_BUF;
     1261    13003    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1262    13004    2               END;
     1263    13005        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:134  
     1264    13006    1   EA_TIME: ;
     1265    13007    1           IF LIST_CODE < 4
     1266    13008    1            THEN
     1267    13009    1              RETURN;
     1268    13010        /******************************************************************************/
     1269    13011        /*                                                                            */
     1270    13012        /* The remaining code is for L(EA) or better.                                 */
     1271    13013        /*                                                                            */
     1272    13014        /******************************************************************************/
     1273    13015    1           IF ICB.DEV_MASK.MAN_TAPE        /* LT                                 */
     1274    13016    1            THEN                           /* L(EA) for LT                       */
     1275    13017    2            DO;
     1276    13018        /*****************************************************************
     1277    13019        /++++++++++++++++++++
     1278    13020        /++++++++++++++++++++  EXPIRATION DATE WILL GO HERE
     1279    13021        /++++++++++++++++++++
     1280    13022         ****************************************************************/
     1281    13023    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1282    13024    2               OLD_BUF$->TEXT$C.LEN = 29;
     1283    13025    3               DO CASE(M$EI$->F$DCB.DENSITY);
     1284    13026    3                CASE(%D800#);
     1285    13027    3                  DENS_STR = '800';
     1286    13028    3                CASE(%D1600#);
     1287    13029    3                  DENS_STR = '1600';
     1288    13030    3                CASE(%D6250#);
     1289    13031    3                  DENS_STR = '6250';
     1290    13032    3                CASE(%D38000#);
     1291    13033    3                  DENS_STR = '38000';
     1292    13034    3                END;                       /* END CASE                           */
     1293    13035    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,
     1294    13036    2                 '    Recording density = ',
     1295    13037    2                 DENS_STR);
     1296    13038    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1297    13039    2               END;
     1298    13040    1            ELSE                           /* L(EA) non-LT                       */
     1299    13041    2            DO;
     1300    13042                                                /* CODE04:  ACCESS time               */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:135  
     1301    13043    2               CODE$ = FPARAM$;
     1302    13044    2               CALL XSF$LOCCODP(CODE$,4) ALTRET(NO_CODE_4_AGAIN);
     1303    13045    2               IF TEST_MODE=1
     1304    13046    2                THEN
     1305    13047    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);
     1306    13048    2                ELSE
     1307    13049    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE04.ACCESS.TIME);
     1308    13050    2               CALL M$TIME(FPT_TIME) ALTRET(NO_CODE_4_AGAIN);
     1309    13051    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1310    13052    2               OLD_BUF$->TEXT$C.LEN = 33;
     1311    13053    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,
     1312    13054    2                 '    Last access  ',
     1313    13055    2                 TIME_BUF.HH_MM,
     1314    13056    2                 ' ',
     1315    13057    2                 DATE_BUF);
     1316    13058    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1317    13059                                                /* CODE03: EXPIRE interval            */
     1318    13060    2               CREATE_TIME = CODE$ -> CODE04.CREATION.TIME;
     1319    13061    2               CODE$ = FPARAM$;
     1320    13062    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NEVER_EXPIRE);
     1321    13063    2               IF CODE$->CODE03.EXPIRE = -1
     1322    13064    2                THEN                       /* EXPIRE IS NEVER                    */
     1323    13065    2                  GOTO NEVER_EXPIRE;
     1324    13066                                 /*  Compute days between creation and UTS rollover.  */
     1325    13067    2               CALL XUD$UTS_ADJ_25TH (UTS_TMP,0,(CODE$->CODE03.EXPIRE * %UTS_25TH_DAY#)
             13067                        )
     1326    13068    3                WHENRETURN DO;
     1327    13069    3                   CALL XUD$UTS_ADJ_25TH (EXP_TIME,CREATE_TIME,(CODE$->CODE03.EXPIRE *
             13069                            %UTS_25TH_DAY#));
     1328    13070
     1329    13071    3                   IF TEST_MODE=1
     1330    13072    3                    THEN
     1331    13073    3                      EXP_TIME = 0;
     1332    13074    3                   FPT_TIME.TSTAMP_ = VECTOR(EXP_TIME);
     1333    13075    3                   CALL M$TIME(FPT_TIME) ALTRET (NEVER_EXPIRE);
     1334    13076    3                   OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1335    13077    3                   OLD_BUF$->TEXT$C.LEN = 33;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:136  
     1336    13078    3                   CALL CONCAT(OLD_BUF$->TEXT$C.STRING,
     1337    13079    3                     '    Will expire  ',
     1338    13080    3                     TIME_BUF.HH_MM,
     1339    13081    3                     ' ',
     1340    13082    3                     DATE_BUF);
     1341    13083    3                   BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1342    13084    3                   END;
     1343    13085    3                WHENALTRETURN DO;
     1344    13086    3                   IF TEST_MODE = 1
     1345    13087    3                    THEN
     1346    13088    3                      CALL BINCHAR(CONV_BUF,0);
     1347    13089    3                    ELSE
     1348    13090    3                      CALL BINCHAR(CONV_BUF,CODE$ -> CODE03.EXPIRE);
     1349    13091    3                   CALL VPD$CLOBBERLZ(VECTOR(CONV_BUF));
     1350    13092    3                   OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$ -> TEXT$C.LEN +1);
     1351    13093    3                   OLD_BUF$ -> TEXT$C.LEN = 42;
     1352    13094    3                   CALL CONCAT(OLD_BUF$ -> TEXT$C.STRING,
     1353    13095    3                     '    Will expire  ',
     1354    13096    3                     CONV_BUF,
     1355    13097    3                     ' days from creation');
     1356    13098    3                   BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1357    13099    3                   END;
     1358    13100    2   NEVER_EXPIRE: ;
     1359    13101    2   NO_CODE_4_AGAIN:
     1360    13102                                                /* CODE03: TAPE/DISC backup bit       */
     1361    13103    2               CODE$ = FPARAM$;
     1362    13104    2               ON_BUF_RDF.DP_LT = ' ';
     1363    13105    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_DP_LT);
     1364    13106    2               IF CODE$->CODE03.DESC.TPB
     1365    13107    2                THEN
     1366    13108    2                  ON_BUF_RDF.DP_LT = 'LT';
     1367    13109    2                ELSE
     1368    13110    2                  ON_BUF_RDF.DP_LT = 'DP';
     1369    13111    2   NO_DP_LT:
     1370    13112                                                /* CODE05: BACKUP time and reel no.   */
     1371    13113    2               CODE$ = FPARAM$;
     1372    13114    2               CALL XSF$LOCCODP(CODE$,5) ALTRET(NO_CODE_5);
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:137  
     1373    13115    2               IF CODE$->CODE05.BACKUP.TIME=0
     1374    13116    2                THEN
     1375    13117    2                  GOTO NO_CODE_5;
     1376    13118    2               IF TEST_MODE=1
     1377    13119    2                THEN
     1378    13120    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);
     1379    13121    2                ELSE
     1380    13122    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE05.BACKUP.TIME);
     1381    13123    2               CALL M$TIME(FPT_TIME) ALTRET(NO_CODE_5);
     1382    13124    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1383    13125    2               OLD_BUF$->TEXT$C.LEN = 48;
     1384    13126    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,
     1385    13127    2                 '    Backed up    ',
     1386    13128    2                 TIME_BUF.HH_MM,
     1387    13129    2                 ' ',
     1388    13130    2                 DATE_BUF,
     1389    13131    2                 ON_BUF,
     1390    13132    2                 CODE$->CODE05.BACKUP.REEL);
     1391    13133    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1392    13134    2   NO_CODE_5:
     1393    13135                                                /* CODE06: STOW time and location     */
     1394    13136    2               ON_BUF_RDF.DP_LT = 'LT';
     1395    13137    2               CODE$ = FPARAM$;
     1396    13138    2               CALL XSF$LOCCODP(CODE$,6) ALTRET(NO_CODE_6);
     1397    13139    2               IF CODE$->CODE06.STOW.TIME=0
     1398    13140    2                THEN
     1399    13141    2                  GOTO NO_CODE_6;
     1400    13142    2               IF TEST_MODE=1
     1401    13143    2                THEN
     1402    13144    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);
     1403    13145    2                ELSE
     1404    13146    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE06.STOW.TIME);
     1405    13147    2               CALL M$TIME(FPT_TIME) ALTRET(NO_CODE_6);
     1406    13148    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1407    13149    2               OLD_BUF$->TEXT$C.LEN = 48;
     1408    13150    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,
     1409    13151    2                 '    Stowed       ',
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:138  
     1410    13152    2                 TIME_BUF.HH_MM,
     1411    13153    2                 ' ',
     1412    13154    2                 DATE_BUF,
     1413    13155    2                 ON_BUF,
     1414    13156    2                 CODE$->CODE06.STOW.REEL);
     1415    13157    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1416    13158    2   NO_CODE_6:
     1417    13159                                                /* CODE03: XTNSIZE, RECLEN            */
     1418    13160    2               CODE$ = FPARAM$;
     1419    13161    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_CODE_3_AGAIN);
     1420    13162    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1421    13163    2               OLD_BUF$->TEXT$C.LEN = 36;
     1422    13164    2               OLD_BUF$->TEXT$C.STRING = '    XTNsize =         Reclen =';
     1423    13165    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE03.XTNSIZE);
     1424    13166    2               IF M$EI$->F$DCB.ORG=%RELATIVE# /* RECL VALID FOR RELATIVE FILES   */
     1425    13167    2                THEN                       /* ONLY                               */
     1426    13168    3                DO;
     1427    13169    3                   CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE03.RECL);
     1428    13170    3                   CALL FINISH_NUMARY_BUF(2);
     1429    13171    3                   END;
     1430    13172    2                ELSE
     1431    13173    3                DO;
     1432    13174    3                   OLD_BUF$->TEXT$C.LEN = 18;
     1433    13175    3                   CALL FINISH_NUMARY_BUF(1);
     1434    13176    3                   END;
     1435    13177                                                /* CODE03: GHSTACS code               */
     1436    13178    2               IF CODE$->CODE03.GHSTACS~=0 AND CODE$->CODE03.GHSTACS~=%NONE#
     1437    13179    2                THEN
     1438    13180    3                DO;
     1439    13181    3                   OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1440    13182    3                   IF CODE$->CODE03.GHSTACS=%JRNLOPN#
     1441    13183    3                    THEN
     1442    13184    4                    DO;
     1443    13185    4                       PINCRC(OLD_BUF$,15)->CHAR$7 = 'JRNLOPN';
     1444    13186    4                       OLD_BUF$->TEXT$C.LEN = 21;
     1445    13187    4                       BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1446    13188    4                       END;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:139  
     1447    13189    3                    ELSE
     1448    13190    4                    DO;
     1449    13191    4                       CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE03.GHSTACS);
     1450    13192    4                       CALL FINISH_NUMARY_BUF(1);
     1451    13193    4                       OLD_BUF$->TEXT$C.LEN = 18;
     1452    13194    4                       END;
     1453    13195    3                   SUBSTR(OLD_BUF$->TEXT$C.STRING,0,14) = '    GHSTACS = ';
     1454    13196    3                   END;
     1455    13197    2   NO_CODE_3_AGAIN:
     1456    13198                                                /* CODE15: CGORG                      */
     1457    13199    2               CODE$ = FPARAM$;
     1458    13200    2               CALL XSF$LOCCODP(CODE$,15) ALTRET(NO_CODE_15);
     1459    13201    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1460    13202    2               OLD_BUF$->TEXT$C.LEN = 15;
     1461    13203    2               I = %MAX_ORG#;
     1462    13204    3               DO WHILE (I > 0 AND M$EI$->F$DCB.ORG~=ORG_TBL.ORG_MON(I));
     1463    13205    3                  I = I -1;
     1464    13206    3                  END;
     1465    13207    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,'    CGorg =',
     1466    13208    2                 ORG_TBL.ABBR(I));
     1467    13209    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1468    13210    2   NO_CODE_15:
     1469    13211    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1470    13212    2               OLD_BUF$->TEXT$C.LEN = 18;
     1471    13213    2               OLD_BUF$->TEXT$C.STRING = '    FITsize =';
     1472    13214    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),FPARAM$->FM$FIT.CODES.NAW(0));
     1473    13215    2               CALL FINISH_NUMARY_BUF(1);
     1474    13216    2               END;
     1475    13217                                                /* L(EA) for any file                 */
     1476    13218                                                /* CODE04:  CREATION time             */
     1477    13219    1           CODE$ = FPARAM$;
     1478    13220    1           CALL XSF$LOCCODP(CODE$,4) ALTRET(NO_CREATION);
     1479    13221    1           IF TEST_MODE=1
     1480    13222    1            THEN
     1481    13223    1              FPT_TIME.TSTAMP_ = VECTOR(ZERO);
     1482    13224    1            ELSE
     1483    13225    1              FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE04.CREATION.TIME);
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:140  
     1484    13226    1           CALL M$TIME(FPT_TIME) ALTRET(NO_CREATION);
     1485    13227    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1486    13228    1           OLD_BUF$->TEXT$C.LEN = 33;
     1487    13229    1           CALL CONCAT(OLD_BUF$->TEXT$C.STRING,
     1488    13230    1             '    Created      ',
     1489    13231    1             TIME_BUF.HH_MM,
     1490    13232    1             ' ',
     1491    13233    1             DATE_BUF);
     1492    13234    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1493    13235    1   NO_CREATION: ;
     1494    13236                                                /* CODE02: LSLIDE,                    */
     1495    13237                                                /* SLIDE, LRDL0, TDALVL, SPARE        */
     1496    13238    1           CODE$ = FPARAM$;
     1497    13239    1           CALL XSF$LOCCODP(CODE$,2) ALTRET(NO_CODE_2);
     1498    13240    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1499    13241    1           OLD_BUF$->TEXT$C.LEN = 36;
     1500    13242    1           OLD_BUF$->TEXT$C.STRING = '    Lslide  =         Slide   =';
     1501    13243    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE02.LSLIDE);
     1502    13244    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE02.SLIDE);
     1503    13245    1           CALL FINISH_NUMARY_BUF(2);
     1504    13246    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1505    13247    1           OLD_BUF$->TEXT$C.LEN = 54;
     1506    13248    1           OLD_BUF$->TEXT$C.STRING =
     1507    13249    1             '    LRDL0   =         TDALVL  =         Spare   =';
     1508    13250    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE02.LRDL0);
     1509    13251    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE02.TDALVL);
     1510    13252    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(2),CODE$->CODE02.SPARE);
     1511    13253    1           CALL FINISH_NUMARY_BUF(3);
     1512    13254    1   NO_CODE_2:
     1513    13255        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:141  
     1514    13256                                                /* CODE16: LINES, WIDTH, PAGENO,      */
     1515    13257                                                /* LINENO, FORM, DVFC                 */
     1516    13258    1           CODE$ = FPARAM$;
     1517    13259    1           CALL XSF$LOCCODP(CODE$,16) ALTRET(NO_UR_INFO);
     1518    13260    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1519    13261    1           OLD_BUF$->TEXT$C.LEN = 36;
     1520    13262    1           OLD_BUF$->TEXT$C.STRING = '    Ln/page =         Width   =';
     1521    13263    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE16.LINES);
     1522    13264    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE16.WIDTH);
     1523    13265    1           CALL FINISH_NUMARY_BUF(2);
     1524    13266    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1525    13267    1           OLD_BUF$->TEXT$C.LEN = 36;
     1526    13268    1           OLD_BUF$->TEXT$C.STRING = '    Pages   =         Lines   =';
     1527    13269    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE16.PAGENO);
     1528    13270    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE16.LINENO);
     1529    13271    1           CALL FINISH_NUMARY_BUF(2);
     1530    13272    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1531    13273    1           OLD_BUF$ -> TEXT$C.LEN = 40;
     1532    13274    1           CALL CONCAT(OLD_BUF$ -> TEXT$C.STRING,
     1533    13275    1             '    DVFC    =  ''',
     1534    13276    1             CODE$->CODE16.DVFC,
     1535    13277    1             '''    Form    = ''',
     1536    13278    1             CODE$->CODE16.FORM,
     1537    13279    1             '''');
     1538    13280    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT + 1;
     1539    13281    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1540    13282    1           OLD_BUF$ -> TEXT$C.LEN = 36;
     1541    13283    1           OLD_BUF$ ->TEXT$C.STRING = '    Copies  = ';
     1542    13284    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE16.COPIES);
     1543    13285    1           CALL FINISH_NUMARY_BUF(1);
     1544    13286    1   NO_UR_INFO: ;
     1545    13287        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:142  
     1546    13288                                                /* File CREATOR (IFF FMSEC is on)     */
     1547    13289    1           CALL VPD$FETCH_CREATOR(TEXT_C) ALTRET(CREATOR_DONE);
     1548    13290    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1549    13291    1           OLD_BUF$->TEXT$C.LEN = 15 + TEXT_C.C;
     1550    13292    1           CALL CONCAT(OLD_BUF$->TEXT$C.STRING,'    Created by ',TEXT_C.TEXT);
     1551    13293    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1552    13294    1   CREATOR_DONE: ;
     1553    13295        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:143  
     1554    13296        /******************************************************************************/
     1555    13297        /*                                                                            */
     1556    13298        /* The remaining code for L(EA) produces one or more lines built from the     */
     1557    13299        /* textual names of some significant bits                                     */
     1558    13300        /*                                                                            */
     1559    13301        /******************************************************************************/
     1560    13302    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1561    13303    1           OLD_BUF$->TEXT$C.LEN = 0;       /* Variable length field              */
     1562    13304    1           IF ICB.DEV_MASK.MAN_TAPE        /*LT*/
     1563    13305    1            THEN
     1564    13306    2            DO;
     1565    13307    2               CALL XTEND_BUF(3*2 + BITBIN(M$EI$->F$DCB.BLOCKED));
     1566    13308    2               CALL XTEND_BUF(4*2 + BITBIN(M$EI$->F$DCB.SPANNED));
     1567    13309    2               END;
     1568    13310    1            ELSE
     1569    13311    2            DO;
     1570    13312    2               CODE$ = FPARAM$;
     1571    13313    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_LAST_CODE_3);
     1572    13314    2               CALL XTEND_BUF(0*2 + BITBIN(CODE$->CODE03.DESC.BUPM));
     1573    13315    2               CALL XTEND_BUF(1*2 + BITBIN(CODE$->CODE03.COMP));
     1574    13316    2               IF CODE$->CODE03.DESC.QS
     1575    13317    2                THEN                       /* EFT will be doing something        */
     1576    13318    3                DO;
     1577    13319    3                   CALL XTEND_BUF(2*2 + BITBIN(CODE$->CODE03.DESC.FETCH));
     1578    13320    3                   IF NOT CODE$->CODE03.DESC.FETCH THEN
     1579    13321    3                      CALL XTEND_BUF(6*2 + BITBIN(CODE$->CODE03.DESC.ACTIVE));
     1580    13322    3                   END;
     1581    13323    2   NO_LAST_CODE_3:
     1582    13324    2               CODE$ = FPARAM$;
     1583    13325    2               CALL XSF$LOCCODP(CODE$,15) ALTRET(FIN_TEXT);
     1584    13326    2               CALL XTEND_BUF(5*2 + BITBIN(CODE$->CODE15.QISS));
     1585    13327    2               END;
     1586    13328    1   FIN_TEXT:
     1587    13329    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1588    13330        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:144  
     1589    13331        /******************************************************************************/
     1590    13332        /*                                                                            */
     1591    13333        /*  The remaining code is for L(FA) or better.                                */
     1592    13334        /*                                                                            */
     1593    13335        /******************************************************************************/
     1594    13336    1           IF LIST_CODE < 5
     1595    13337    1            THEN
     1596    13338    1              RETURN;
     1597    13339    1           IF M$EI$->F$DCB.ORG=%INDEXED#
     1598    13340    1            THEN
     1599    13341    2            DO;
     1600    13342                                                /* CODE02:  KEYX, KEYL                */
     1601    13343    2               CODE$ = FPARAM$;
     1602    13344    2               CALL XSF$LOCCODP(CODE$,2) ALTRET(NO_CODE_2_AGAIN);
     1603    13345    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1604    13346    2               OLD_BUF$->TEXT$C.LEN = 36;
     1605    13347    2               OLD_BUF$->TEXT$C.STRING = '    Keyx    =         Keylen  =';
     1606    13348    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE02.KEYX);
     1607    13349    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE02.KEYL);
     1608    13350    2               CALL FINISH_NUMARY_BUF(2);
     1609    13351    2   NO_CODE_2_AGAIN: ;
     1610    13352                                                /* CODE08: alternate index            */
     1611    13353    2               CODE$ = FPARAM$;
     1612    13354    2               CALL XSF$LOCCODP(CODE$,08) ALTRET(NO_ALT_IDX);
     1613    13355    2               IF CODE$ -> FITALTKEYS.NUMENTS = 0
     1614    13356    2                THEN
     1615    13357    2                  GOTO NO_ALT_IDX;
     1616    13358    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1617    13359    2               OLD_BUF$ -> TEXT$C.LEN = 30;
     1618    13360    2               OLD_BUF$->TEXT$C.STRING = '    ----- Alternate keys -----';
     1619    13361    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1620    13362    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1621    13363    2               OLD_BUF$ -> TEXT$C.LEN = 39;
     1622    13364    2               OLD_BUF$->TEXT$C.STRING = '      Keyno      Keyx    Keylen  Unique';
     1623    13365    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1624    13366    3               DO I = 1 TO (CODE$ -> FITALTKEYS.NUMENTS -1);
     1625    13367    3                  OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:145  
     1626    13368    3                  OLD_BUF$ -> TEXT$C.LEN = 41;
     1627    13369    3                  OLD_BUF$ -> TEXT$C.STRING = ' ';
     1628    13370    3                  CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(0),I+1);
     1629    13371    3                  CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(1),CODE$->FITALTKEYS.K.KEYX(I));
     1630    13372    3                  CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(2),CODE$->FITALTKEYS.K.KEYL(I));
     1631    13373    3                  OLD_BUF$->COL$ARY.N.TXT(3) = TRUTH(BITBIN(CODE$->FITALTKEYS.K.UNIQUE(
             13373                           I)));
     1632    13374    3                  CALL FINISH_COLARY_BUF(3);
     1633    13375    3                  END;
     1634    13376    2   NO_ALT_IDX: ;
     1635    13377    2               END;
     1636    13378        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:146  
     1637    13379                                                /* CODE18: Field definitions          */
     1638    13380    1           CODE$ = FPARAM$;
     1639    13381    1           CALL XSF$LOCCODP(CODE$,18) ALTRET(NO_CODE18);
     1640    13382    1           IF CODE$ -> CODE18.NFIELDS = 0
     1641    13383    1            THEN
     1642    13384    1              GOTO NO_CODE18;
     1643    13385    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1644    13386    1           OLD_BUF$ -> TEXT$C.LEN = 33;
     1645    13387    1           OLD_BUF$->TEXT$C.STRING = '    ----- Field definitions -----';
     1646    13388    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1647    13389    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1648    13390    1           OLD_BUF$ -> TEXT$C.LEN = 61;
     1649    13391    1           DONT_PRINT=%NO#;
     1650    13392    1           TCODE$=FPARAM$;
     1651    13393    1           K=21;
     1652    13394    1           CALL XSF$LOCCODP(TCODE$,K)
     1653    13395    2            WHENALTRETURN DO;
     1654    13396    2               TCODE$=ADDR(NIL);
     1655    13397    2               END;
     1656    13398    1           OLD_BUF$->TEXT$C.STRING =
             13398                    '   Fieldno  Type         Start    Length  Units        Scale';
     1657    13399    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1658    13400    1           OLD_BUF$=PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1659    13401    1           OLD_BUF$->TEXT$C.LEN=61;
     1660    13402    1           OLD_BUF$->TEXT$C.STRING=' ';
     1661    13403    1           OLD_BUF$ -> COL$ARY.N.TXT(0)=' Phy Log';
     1662    13404    1           OLD_BUF$ -> COL$ARY.N.TXT(2)='   w-c-b';
     1663    13405    1           BUF_BLOCK.COUNT=BUF_BLOCK.COUNT+1;
     1664    13406    2           DO I = 0 TO CODE$ -> CODE18.NFIELDS -1;
     1665    13407    2              J = 0;
     1666    13408    3              DO WHILE (J < 63
     1667    13409    3                AND TYPE_ARY.CODE(J) ~= CODE$ -> CODE18.FIELD.TYPE(I));
     1668    13410    3                 J = J +1;
     1669    13411    3                 END;
     1670    13412    2              OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1671    13413    2              CALL CHECK_BUF(OLD_BUF$,61);
     1672    13414    2              OLD_BUF$ -> TEXT$C.LEN = 61;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:147  
     1673    13415    2              OLD_BUF$ -> TEXT$C.STRING = ' ';
     1674    13416    2              CALL BINCHAR(TFIELD1,I);
     1675    13417    2              CALL VPD$CLOBBERLZ (VECTOR(TFIELD1));
     1676    13418    2              TFIELD2=' ';
     1677    13419    3              IF TCODE$~=ADDR(NIL) THEN DO;
     1678    13420    3                  K=0;
     1679    13421    4                  DO WHILE (K<TCODE$->CODE21.NFIELDS AND TCODE$->CODE21.FIELDN(K)~=I);
     1680    13422    4                     K=K+1;
     1681    13423    4                     END;
     1682    13424    4                  IF K~=TCODE$->CODE21.NFIELDS THEN DO;
     1683    13425    4                      CALL BINCHAR(TFIELD2,K);
     1684    13426    4                      CALL VPD$CLOBBERLZ(VECTOR(TFIELD2));
     1685    13427    4                      END;
     1686    13428    3                  END;
     1687    13429    2              CALL CONCAT(OLD_BUF$->COL$ARY.N.TXT(0),' ',TFIELD1,' ',TFIELD2);
     1688    13430    2              OLD_BUF$->COL$ARY.N.TXT(1) = TYPE_ARY.NAME(J);
     1689    13431    2              OLD_BUF$->COL$ARY.N.TXT(4) = UNITS(TYPE_ARY.UNITS(J));
     1690    13432    3              IF DONT_PRINT THEN DO;
     1691    13433    3                  DONT_PRINT=%NO#;
     1692    13434    3                  OLD_BUF$->COL$ARY.N.TXT(0)=' ';
     1693    13435    3                  END;
     1694    13436    2              F$=PINCRW(B$ROS$,M$EI$->F$DCB.STARTX);
     1695    13437    2              LEN_WRDS=F$->FM$FIELD_START.OFFSET(I)/36; /* compute length in words */
     1696    13438    2              CALL BINCHAR(TWRDS,LEN_WRDS);
     1697    13439    2              CALL VPD$CLOBBERLZ(VECTOR(TWRDS));
     1698    13440    2              LEN_BYTES=(F$->FM$FIELD_START.OFFSET(I)-LEN_WRDS*36)/9;
     1699    13441    2              CALL BINCHAR(TBYTES,LEN_BYTES);
     1700    13442    2              LEN_BITS=F$->FM$FIELD_START.OFFSET(I)-(LEN_WRDS*36+LEN_BYTES*9);
     1701    13443    2              CALL BINCHAR(TBITS,LEN_BITS);
     1702    13444    2              CALL CONCAT(OLD_BUF$->COL$ARY.N.TXT(2),TWRDS,'-',TBYTES,'-',TBITS);
     1703    13445    3              DO CASE (TYPE_ARY.CLASS(J));
     1704    13446    3               CASE(0);                    /* Currently unused                   */
     1705    13447    3                 ;
     1706    13448    3               CASE(1);                    /* FIELD                              */
     1707    13449    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.FIELD.LEN(I));
     1708    13450    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));
     1709    13451    3                 OLD_BUF$->COL$ARY.N.TXT(5)='     N/A';
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:148  
     1710    13452    3               CASE(2);                    /* DECFIELD                           */
     1711    13453    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.DECFIELD.LEN(I))
             13453                          ;
     1712    13454    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));
     1713    13455    3                 TEMP=CODE$->CODE18.DECFIELD.SCALE(I);
     1714    13456    3                 IF TEMP<0 THEN
     1715    13457    3                    CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(5),-TEMP);
     1716    13458    3                  ELSE
     1717    13459    3                    CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(5),TEMP);
     1718    13460    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(5)));
     1719    13461    4                 IF TEMP<0 THEN DO;
     1720    13462    4                     P$=PINCRW(ADDR(OLD_BUF$->COL$ARY.N(5)),2);
             13462                              /* Columns are two words long */
     1721    13463    5                     DO WHILE P$->BASED_CHAR~=' ';
     1722    13464    5                        P$=PINCRC(P$,-1);  /* Back up one char                   */
     1723    13465    5                        END;
     1724    13466    4                     P$->BASED_CHAR='-';   /* Let user know scale is neg.        */
     1725    13467    4                     END;
     1726    13468    3               CASE(3);                    /* LIST                               */
     1727    13469    3                 DONT_PRINT=%YES#;
     1728    13470    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.FIELD.LEN(I));
     1729    13471    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));
     1730    13472    3                 OLD_BUF$->COL$ARY.N.TXT(5)='     N/A';
     1731    13473    3               CASE(4);                    /* Unknown format                     */
     1732    13474    3                 ;
     1733    13475    3               CASE(5);                    /* VLIST format                       */
     1734    13476    3                 DONT_PRINT=%YES#;
     1735    13477    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.FIELD.LEN(I));
     1736    13478    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));
     1737    13479    3                 SUBSTR(OLD_BUF$->COL$ARY.N.TXT(3),0,3)='  @';
     1738    13480    3                 OLD_BUF$->COL$ARY.N.TXT(5)='     N/A';
     1739    13481    3               END;                        /* END CASE                           */
     1740    13482    2              BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1741    13483    2              END;                         /* END INDEX                          */
     1742    13484    1   NO_CODE18: ;
     1743    13485        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:149  
     1744    13486                                                /* CODE19: Key definitions            */
     1745    13487    1           CODE$ = FPARAM$;
     1746    13488    1           CALL XSF$LOCCODP(CODE$,19) ALTRET(NO_CODE19);
     1747    13489    1           IF CODE$ -> CODE19.NKEYS = 0
     1748    13490    1            THEN
     1749    13491    1              GOTO NO_CODE19;
     1750    13492    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1751    13493    1           OLD_BUF$ -> TEXT$C.LEN = 31;
     1752    13494    1           OLD_BUF$->TEXT$C.STRING = '    ----- Key definitions -----';
     1753    13495    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1754    13496    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1755    13497    1           OLD_BUF$ -> TEXT$C.LEN = 28;
     1756    13498    1           OLD_BUF$->TEXT$C.STRING = '       Keyno   Unique Fields';
     1757    13499    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1758    13500    1           J = 0;                          /* Index into fragment array          */
     1759    13501    2           DO I = 0 TO CODE$ -> CODE19.NKEYS -1;
     1760    13502    2              OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);
     1761    13503    2              CALL CHECK_BUF(OLD_BUF$,51);
     1762    13504    2              OLD_BUF$ -> TEXT$C.LEN = 51;
     1763    13505    2              OLD_BUF$ -> TEXT$C.STRING = ' ';
     1764    13506    2              CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(0),I);
     1765    13507    2              CALL VPD$CLOBBERLZ (VECTOR(OLD_BUF$->COL$ARY.N.TXT(0)));
     1766    13508    2              CALL CONCAT(OLD_BUF$->COL$ARY.N.TXT(1),
     1767    13509    2                '    ',TRUTH(BITBIN(CODE$->CODE19.K.UNIQUE(J))));
     1768    13510    2              PTR$ = ADDR(OLD_BUF$->COL$ARY.N.TXT(2));
     1769    13511    3              DO UNTIL (CODE$->CODE19.K.KEYEND(J-1));
     1770    13512    3                 CALL BINCHAR(CONV_BUF,CODE$->CODE19.K.FIELDN(J));
     1771    13513    3                 BYTE_IDX = 0;
     1772    13514    4                 DO WHILE (BYTE_IDX < SIZEC(CONV_BUF)-1
     1773    13515    4                   AND SUBSTR(CONV_BUF,BYTE_IDX,1) = '0');
     1774    13516    4                    BYTE_IDX = BYTE_IDX +1;
     1775    13517    4                    END;                   /* END WHILE                          */
     1776    13518    3                 CALL CONCAT(PTR$ -> CHAR$7,SUBSTR(CONV_BUF,BYTE_IDX),'-');
     1777    13519    3                 PTR$ = PINCRC(PTR$,SIZEC(CONV_BUF)-BYTE_IDX+1);
     1778    13520    3                 J = J +1;                 /* Next fraggie                       */
     1779    13521    3                 END;                      /* END UNTIL                          */
     1780    13522    2              PINCRC(PTR$,-1) -> CHAR$1 = ' '; /* Stomp trailing sep.            */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:150  
     1781    13523    2              BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;
     1782    13524    2              END;                         /* END INDEX                          */
     1783    13525    1   NO_CODE19: ;
     1784    13526        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:151  
     1785    13527        /******************************************************************************/
     1786    13528        /*                                                                            */
     1787    13529        /*  There is nothing left to do for LIST!                                     */
     1788    13530        /*                                                                            */
     1789    13531        /******************************************************************************/
     1790    13532    1           RETURN;
     1791    13533        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:152  
     1792    13534    1   CHECK_BUF: PROC(PTR$,LEN);
     1793    13535        /*I* NAME: CHECK_BUF;
     1794    13536             CALL CHECK_BUF(PTR$,LEN);
     1795    13537             DESCRIPTION: This procedure determines whether or not LEN more
     1796    13538                          characters will fit in the list buffer described by
     1797    13539                          LIST_BUF$ and LIST_SIZE.  PTR$ is the current point
     1798    13540                          in that buffer where we will be putting stuff.  If
     1799    13541                          there is not enough room, then the buffer will be
     1800    13542                          enlarged by a page and LIST_SIZE updated.
     1801    13543        */
     1802    13544    2   DCL PTR$ PTR;
     1803    13545    2   DCL LEN UBIN;
     1804    13546
     1805    13547    2           IF PINCRC(PTR$,LEN) < PINCRW(LIST_BUF$,LIST_SIZE) THEN RETURN;
     1806    13548    2           CALL VPD$GET_BUF(LIST_BUF$,1024)
     1807    13549    3            WHENALTRETURN DO;
     1808    13550    3               CALL VPL$ERR_PROC(3,0);
     1809    13551    3               END;
     1810    13552    2           LIST_SIZE=LIST_SIZE+1024;
     1811    13553    2           RETURN;
     1812    13554    2   END CHECK_BUF;
     1813    13555        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:153  
     1814    13556    1   FINISH_NUMARY_BUF: PROC(COUNT);
     1815    13557        /*I* NAME: FINISH_NUMARY_BUF;
     1816    13558             CALL:  CALL FINISH_NUMARY_BUF;
     1817    13559             DESCRIPTION: This procedure removes leading zeroes from the first
     1818    13560                          COUNT numbers in NUM$ARY located by OLD_BUF$. It
     1819    13561                          then bumps BUF_BLOCK.COUNT and returns.
     1820    13562        */
     1821    13563    2   DCL COUNT SBIN WORD;
     1822    13564    2   DCL I SBIN WORD;
     1823    13565    3           DO I=0 TO COUNT-1;
     1824    13566    3              CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->NUM$ARY.N.NUM(I)));
     1825    13567    3              END;
     1826    13568    2           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1827    13569    2           RETURN;
     1828    13570    2   END FINISH_NUMARY_BUF;
     1829    13571        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:154  
     1830    13572    1   FINISH_COLARY_BUF: PROC(COUNT);
     1831    13573        /*I* NAME: FINISH_COLARY_BUF;
     1832    13574             CALL:  CALL FINISH_COLARY_BUF(n);
     1833    13575             DESCRIPTION: This procedure removes leading zeroes from the first
     1834    13576                          COUNT numbers in COL$ARY located by OLD_BUF$. It
     1835    13577                          then bumps BUF_BLOCK.COUNT and returns.
     1836    13578        */
     1837    13579    2   DCL COUNT SBIN WORD;
     1838    13580    2   DCL I SBIN WORD;
     1839    13581    3           DO I=0 TO COUNT-1;
     1840    13582    3              IF OLD_BUF$->COL$ARY.N.TXT(I) ~= ' '
     1841    13583    3               THEN                        /* Presumed numeric                   */
     1842    13584    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(I)));
     1843    13585    3              END;
     1844    13586    2           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;
     1845    13587    2           RETURN;
     1846    13588    2   END FINISH_COLARY_BUF;
     1847    13589        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:155  
     1848    13590    1   XTEND_BUF: PROC(IDX);
     1849    13591        /*I* NAME: XTEND_BUF
     1850    13592             CALL: CALL XTEND_BUF(IDX);
     1851    13593             DESCRIPTION: This procedure extends the buffer pointed to by OLD_BUF$
     1852    13594                          by the string, XTEND_STRINGS.STRING(IDX).
     1853    13595        */
     1854    13596    2   DCL IDX SBIN WORD;
     1855    13597    2   DCL 1 XTEND_STRINGS(0:13) CONSTANT,
     1856    13598    2         2 LEN UBIN BYTE UNAL INIT(
     1857    13599    2             12,10,                        /* NOBACKUP, BACKUP                   */
     1858    13600    2             00,11,                        /* NOCOMPRESS, COMPRESSED             */
     1859    13601    2             19,20,                        /* QUEUED RETREIVE, QUEUED FETCH      */
     1860    13602    2             12,11,                        /* NOBLOCKED, BLOCKED                 */
     1861    13603    2             09,08,                        /* NOSPANNED, SPANNED                 */
     1862    13604    2             00,05,                        /* NOQISS, QISS                       */
     1863    13605    2             03,03),                       /* INACTIVE, ACTIVE                   */
     1864    13606    2         2 STRING CHAR(26) INIT
     1865    13607    2           ('    Nobackup',                /* IDX = 0                            */
     1866    13608    2           '    Backup',                   /* IDX = 1                            */
     1867    13609    2           ' ',                            /* IDX = 2                            */
     1868    13610    2           ',compressed',                  /* IDX = 3                            */
     1869    13611    2           ',queued for archive',          /* IDX = 4                            */
     1870    13612    2           ',queued for retrieve',         /* IDX = 5                            */
     1871    13613    2           '    nblocked',                 /* IDX = 6                            */
     1872    13614    2           '    blocked',                  /* IDX = 7                            */
     1873    13615    2           ',nspanned',                    /* IDX = 8                            */
     1874    13616    2           ',spanned',                     /* IDX = 9                            */
     1875    13617    2           ' ',                            /* IDX = 10                           */
     1876    13618    2           ',QISS',                        /* IDX = 11                           */
     1877    13619    2           '(I)',                          /* IDX = 12                           */
     1878    13620    2           '(A)');                         /* IDX = 13                           */
     1879    13621    2   DCL CHAR$26 CHAR(26) BASED;
     1880    13622    2           PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1)->CHAR$26 =
     1881    13623    2             XTEND_STRINGS.STRING(IDX);
     1882    13624    2           OLD_BUF$->TEXT$C.LEN = OLD_BUF$->TEXT$C.LEN + XTEND_STRINGS.LEN(IDX);
     1883    13625    2           RETURN;
     1884    13626    2   END XTEND_BUF;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:156  
     1885    13627        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:157  
     1886    13628    1   GET_FULL_FID: PROC(NAME$,LEN);
     1887    13629        /*I* NAME: GET_FULL_FID
     1888    13630             CALL: CALL GET_FULL_FID(NAME$,LEN);
     1889    13631             DESCRIPTION: Does an M$UNFID on M$EI to obtain all the parts
     1890    13632                          of a FID, and formats them into where NAME$ locates.
     1891    13633                          It returns the length of the fid in LEN.
     1892    13634        */
     1893    13635
     1894    13636    2   DCL NAME$ PTR;
     1895    13637    2   DCL LEN UBIN;
     1896    13638    2   DCL LENGTH UBIN STATIC;
     1897    13639    2   DCL B$VECTOR BASED VECTOR;
     1898    13640        %FPT_UNFID(FPTN=FPT_UNFID_EI,DCB=M$EI,LEN=LENGTH);
     1899    13658    2           VBASE(ADDR(FPT_UNFID_EI.TEXTFID_)->B$VECTOR) = NAME$;
     1900    13659    2           VBOUND(ADDR(FPT_UNFID_EI.TEXTFID_)->B$VECTOR) = 52;
     1901    13660    2           CALL M$UNFID(FPT_UNFID_EI)
     1902    13661    3            WHENALTRETURN DO;
     1903    13662    3               CALL VPL$ERR_PROC(3,0);
     1904    13663    3               END;
     1905    13664    2           LEN = LENGTH;
     1906    13665    2           RETURN;
     1907    13666    2   END GET_FULL_FID;
     1908    13667    1   END VPH$GET_LIST_BUFS;

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:158  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPH$GET_LIST_BUFS.

   Procedure VPH$GET_LIST_BUFS requires 2927 words for executable code.
   Procedure VPH$GET_LIST_BUFS requires 64 words of local(AUTO) storage.

    No errors detected in file VPH$LISTREV.:E05TSI    .

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:159  

 Object Unit name= VPH$GET_LIST_BUFS                          File name= VPH$LISTREV.:E05TOU
 UTS= JUL 30 '97 07:42:07.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none    46     56  VPH$GET_LIST_BUFS
   11  RoData even  UTS    557   1055  VPH$GET_LIST_BUFS
   12   Proc  even  none  2927   5557  VPH$GET_LIST_BUFS
   13  RoData even  none    64    100  VPH$GET_LIST_BUFS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        1  VPH$GET_LIST_BUFS
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:160  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 VPD$GET_BUF
         yes           Std       8 VPL$ERR_PROC
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
 yes     yes           Std       2 XSF$LOCCODP
         yes           Std       1 VPD$CLOBBERLZ
 yes     yes           Std       2 XSF$LOCCODE
 yes     yes           Std       1 VPD$FETCH_CREATOR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  LIST_BUF$                             LIST_SIZE
     TEST_MODE                             BREAK_LOC                             BREAK_MESSAGE_REPORTER
     FPARAM$                               SPEC_BUF                              USABLE_LEN
     DIN_NAME                              IN_RES                                ICB
r    ORG_TBL                               M$EI                                  M$EI$
     M$EO                                  M$EO1                                 M$ME
     M$SI                                  M$READFILE                            M$DO
     M$STD1                                M$SORT1                               B$TCB$
     FPT_CLOSE_EI                          B$ROS$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:161  


      629        1        /*T***********************************************************/
      630        2        /*T*                                                         */
      631        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      632        4        /*T*                                                         */
      633        5        /*T***********************************************************/
      634        6        VPH$GET_LIST_BUFS: PROC(LIST_CODE);

      6 12 000000   000000 700200 xent  VPH$GET_LIS* TSX0  ! X66_AUTO_1
        12 000001   000100 000001                    ZERO    64,1

      635        7        /*D* NAME: VPH$GET_LIST_BUFS
      636        8             CALL: CALL VPH$GET_LIST_BUFS(LIST_CODE);
      637        9             DESCRIPTION: This procedure gets a page if not already allocated
      638       10                          and fills it with one or more buffers in TEXTC format
      639       11                          reflecting a list of the file in M$EI in the format
      640       12                          specified by LIST_CODE.
      641       13                          BUF_BLOCK is a structure containing COUNT, an sbin word,
      642       14                          and COUNT textc buffers immediately following COUNT in
      643       15                          the structure. As BUF_BLOCK is filled in with the
      644       16                          information on field definitions, CHECK_BUF is called
      645       17                          to extend BUF_BLOCK if it is not large enough.
      646       18                          VPD$INIT_COMMANDS will release these pages (pointed
      647       19                          to by LIST_BUF$) when the next command is started.
      648       20                          LIST_CODE values have the following meanings:
      649       21                            VALUE         MEANING
      650       22                            -----         -------
      651       23                              1           name only list format
      652       24                              2           access denied list format
      653       25                              3           attributes list format
      654       26                              4           extended attributes list format
      655       27        */
      656       28        /**/
      657       29        /*  INCLUDE FILES  */
      658       30        /**/
      659       31        %INCLUDE VP_DATA_R;
      660     7018        %INCLUDE B_ERRORS_C;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:162  
      661     8145        %INCLUDE FM$FIT;
      662     8366        %INCLUDE FM_FIELD_C;
      663     8407        %INCLUDE B$OBJECT_C;
      664    11837        /**/
      665    11838        /*   UTS EXTENSION */
      666    11839        /**/
      667    11840        %INCLUDE XUD_UTS_M;
      668    11922        %XUD$UTS_ENTRIES;
      669    11954        %XUD_UTS_EQU;
      670    11965        /**/
      671    11966        /*  BASED STRUCTURES  */
      672    11967        /**/
      673    11968        %FM$FIT;
      674    11971        %CODE02;
      675    11975        %CODE03;
      676    11982        %CODE04;
      677    11990        %CODE05;
      678    11993        %CODE06;
      679    11997        %FITALTKEYS;                            /* CODE08                             */
      680    12003        %CODE09;
      681    12007        %CODE10;
      682    12011        %CODE15;
      683    12014        %CODE16;
      684    12022        %CODE18;
      685    12026        %CODE19;
      686    12029        %CODE21;
      687    12032        %VREBL_DATATYPES;                       /* FOR IREL FILES                     */
      688    12107    1   DCL LEN_WRDS UBIN;
      689    12108    1   DCL TWRDS CHAR(4);
      690    12109    1   DCL LEN_BYTES UBIN;
      691    12110    1   DCL TBYTES CHAR(1);
      692    12111    1   DCL LEN_BITS UBIN;
      693    12112    1   DCL TBITS CHAR(1);
      694    12113    1   DCL TFIELD1 CHAR(3);
      695    12114    1   DCL TFIELD2 CHAR(3);
      696    12115    1   DCL F$ PTR;
      697    12116    1   DCL P$ PTR;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:163  
      698    12117    1   DCL K UBIN;
      699    12118    1   DCL DONT_PRINT BIT(1);
      700    12119    1   DCL TEMP SBIN;
      701    12120    1   DCL BASED_CHAR CHAR(1) BASED;
      702    12121    1   DCL B$UBIN1 UBIN BYTE BASED UNAL;
      703    12122        %FM$FIELD_START(STCLASS="BASED");
      704    12144        %INCLUDE F$DCB;
      705    12193        %B$TCB;
      706    12196        %B$ALT;
      707    12204    1   DCL B$ROS$ PTR SYMREF;
      708    12205    1   DCL 1 TEXT$C BASED,
      709    12206    1         2 LEN UBIN BYTE UNAL,
      710    12207    1         2 STRING CHAR(TEXT$C.LEN);
      711    12208    1   DCL 1 TEXT$C_ARY BASED,
      712    12209    1         2 LEN UBIN BYTE UNAL,
      713    12210    1         2 STRING(0:0) CHAR(1);
      714    12211    1   DCL ZERO SBIN WORD STATIC INIT(0);
      715    12212    1   DCL INCONSIST_BUF CHAR(0) CONSTANT INIT
      716    12213    1               ('  **  File inconsistency may exist  **');
      717    12214    1   DCL TIMEWARP_BUF CHAR(0) CONSTANT INIT
      718    12215    1               ('  **  WARNING:  old file from DUAL packset  **');
      719    12216    1   DCL LIST_CODE SBIN WORD;
      720    12217    1   DCL 1 BUF_BLOCK BASED(LIST_BUF$) ALIGNED,
      721    12218    1         2 COUNT SBIN WORD,
      722    12219    1         2 BUF_1,
      723    12220    1           3 LEN UBIN BYTE UNAL,
      724    12221    1           3 INFO_FIELD CHAR(45),
      725    12222    1           3 INFO REDEF INFO_FIELD,
      726    12223    1             4 ORG CHAR(3),
      727    12224    1             4 * CHAR(1),
      728    12225    1             4 TY CHAR(2),
      729    12226    1             4 GRAN CHAR(6),
      730    12227    1             4 NGAV CHAR(6),
      731    12228    1             4 RECS CHAR(8),
      732    12229    1             4 * CHAR(1),
      733    12230    1             4 DP,
      734    12231    1               5 TIME CHAR(5),
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:164  
      735    12232    1               5 * CHAR(1),
      736    12233    1               5 DATE CHAR(10),
      737    12234    1               5 * CHAR(1),
      738    12235    1             4 LT REDEF DP,
      739    12236    1               5 VOL CHAR(6),
      740    12237    1               5 * CHAR(6),
      741    12238    1               5 FSN CHAR(5),
      742    12239    1             4 * CHAR(1),
      743    12240    1           3 NAME CHAR(31),
      744    12241    1         2 *(0:0) CHAR(4);                 /* for variable part of LIST          */
      745    12242    1   DCL 1 TEXT_C,
      746    12243    1         2 C UBIN BYTE CALIGNED,
      747    12244    1         2 TEXT CHAR(31);
      748    12245        %FPT_PRECORD(FPTN = FPT_PRECORD,
      749    12246                     DCB  = M$EI,
      750    12247                     N    ="BITBIN('377777777777'O)",
      751    12248                     STCLASS = CONSTANT);
      752    12269        %FPT_TIME(FPTN = FPT_TIME,
      753    12270                  TIME = TIME_BUF,
      754    12271                  DATE = DATE_BUF,
      755    12272                  SOURCE = UTS,
      756    12273                  DEST = EXT);
      757    12292    1   DCL ON_BUF CHAR(9) STATIC INIT('  on    #');
      758    12293    1   DCL 1 ON_BUF_RDF REDEF ON_BUF,
      759    12294    1         2 * CHAR(6),
      760    12295    1         2 DP_LT CHAR(2),
      761    12296    1         2 * CHAR(1);
      762    12297    1   DCL DATE_BUF CHAR(10) STATIC;
      763    12298    1   DCL 1 TIME_BUF STATIC,
      764    12299    1         2 HH_MM CHAR(5),
      765    12300    1         2 * CHAR(6);
      766    12301    1   DCL 1 CNTL_NAME_TBL CONSTANT,
      767    12302    1         2 LEN(0:17) UBIN BYTE UNAL INIT(5*3,4,5,
      768    12303    1           7*2,5,7,3,
      769    12304    1           5*8),
      770    12305    1         2 TEXT(0:17) CHAR(7) INIT(',read',',delr',',wnew',',upd',',delf',
      771    12306    1           ',nolist',',reattr',',exec',',create',',au',
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:165  
      772    12307    1           ',aurd',',tctl',',BUG!'*3,
      773    12308    1           ',BUG!'*3);
      774    12309    1   DCL TRUTH (0:1) CHAR(3) CONSTANT INIT(
      775    12310    1       ' no',
      776    12311    1       'yes' );
      777    12312    1   DCL UNITS (0:4) CHAR(8) CONSTANT INIT(
      778    12313    1       '!BUG!   ',
      779    12314    1       'bits    ',
      780    12315    1       'nibbles ',
      781    12316    1       'bytes   ',
      782    12317    1       'elements' );
      783    12318    1   DCL 1 TYPE_ARY (0:62) CONSTANT,
      784    12319    1         2 NAME CHAR(8) CALIGNED INIT(
      785    12320    1              'NO      ',                  /* 00                                 */
      786    12321    1              'SBIN    ',                  /* 01                                 */
      787    12322    1              'DFIX    ',                  /* 02                                 */
      788    12323    1              'SFLT    ',                  /* 03                                 */
      789    12324    1              'DFLT    ',                  /* 04                                 */
      790    12325    1              'SCFIX   ',                  /* 05                                 */
      791    12326    1              'DCFIX   ',                  /* 06                                 */
      792    12327    1              'COMPLEX ',                  /* 07                                 */
      793    12328    1              'DCOMPLEX',                  /* 08                                 */
      794    12329    1              'PDLA    ',                  /* 09                                 */
      795    12330    1              'PDFLT   ',                  /* 10                                 */
      796    12331    1              'PDCLA   ',                  /* 11                                 */
      797    12332    1              'PDCFLT  ',                  /* 12                                 */
      798    12333    1              'POINTER ',                  /* 13                                 */
      799    12334    1              'OFFSET  ',                  /* 14                                 */
      800    12335    1              'LABEL   ',                  /* 15                                 */
      801    12336    1              'ENTRY   ',                  /* 16                                 */
      802    12337    1              'STRUCTUR',                  /* 17                                 */
      803    12338    1              'AREA    ',                  /* 18                                 */
      804    12339    1              'BIT     ',                  /* 19                                 */
      805    12340    1              'VBIT    ',                  /* 20                                 */
      806    12341    1              'CHAR    ',                  /* 21                                 */
      807    12342    1              'TEXTC   ',                  /* 22                                 */
      808    12343    1              'FILE    ',                  /* 23                                 */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:166  
      809    12344    1              'UBIN    ',                  /* 24                                 */
      810    12345    1              'PDTA    ',                  /* 25                                 */
      811    12346    1              'ACHAR   ',                  /* 26                                 */
      812    12347    1              'ABIT    ',                  /* 27                                 */
      813    12348    1              'EPTR    ',                  /* 28                                 */
      814    12349    1              'COMP1   ',                  /* 29                                 */
      815    12350    1              'COMP2   ',                  /* 30                                 */
      816    12351    1              'PDTE    ',                  /* 31                                 */
      817    12352    1              'INDEX1  ',                  /* 32                                 */
      818    12353    1              'INDEX2  ',                  /* 33                                 */
      819    12354    1              'FEVERY  ',                  /* 34                                 */
      820    12355    1              'FLOGICAL',                  /* 35                                 */
      821    12356    1              'FANY    ',                  /* 36                                 */
      822    12357    1              'FLABEL  ',                  /* 37                                 */
      823    12358    1              'FUCB    ',                  /* 38                                 */
      824    12359    1              'INTCNST ',                  /* 39                                 */
      825    12360    1              'PDNS    ',                  /* 40                                 */
      826    12361    1              'UDNS    ',                  /* 41                                 */
      827    12362    1              'UDLS    ',                  /* 42                                 */
      828    12363    1              'UDTS    ',                  /* 43                                 */
      829    12364    1              'UDLO    ',                  /* 44                                 */
      830    12365    1              'UDTO    ',                  /* 45                                 */
      831    12366    1              'ASTRUCTR',                  /* 46                                 */
      832    12367    1              'LIST    ',                  /* 47                                 */
      833    12368    1              'VLIST   ',                  /* 48                                 */
      834    12369    1              'DSCR    ',                  /* 49                                 */
      835    12370    1              'UDFLT   ',                  /* 50                                 */
      836    12371    1              'PDLE    ',                  /* 51                                 */
      837    12372    1              'ENUMTYPE',                  /* 52                                 */
      838    12373    1              'SET     ',                  /* 53                                 */
      839    12374    1              'DATE    ',                  /* 54                                 */
      840    12375    1              'UTS     ',                  /* 55                                 */
      841    12376    1              'TEXTH   ',                  /* 56                                 */
      842    12377    1              'TIME    ',                  /* 57                                 */
      843    12378    1              '        ',                  /* 58                                 */
      844    12379    1              '        ',                  /* 59                                 */
      845    12380    1              'NULL    ',                  /* 60                                 */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:167  
      846    12381    1              'VIRT ARY',                  /* 61                                 */
      847    12382    1              'REAL ARY'),                 /* 62                                 */
      848    12383    1         2 CODE UBIN BYTE CALIGNED INIT(
      849    12384    1              %NO_DATATYPE,                /* 00                                 */
      850    12385    1              %SBIN_DATATYPE,              /* 01                                 */
      851    12386    1              %DFIX_DATATYPE,              /* 02                                 */
      852    12387    1              %SFLT_DATATYPE,              /* 03                                 */
      853    12388    1              %DFLT_DATATYPE,              /* 04                                 */
      854    12389    1              %SCFIX_DATATYPE,             /* 05                                 */
      855    12390    1              %DCFIX_DATATYPE,             /* 06                                 */
      856    12391    1              %COMPLEX_DATATYPE,           /* 07                                 */
      857    12392    1              %DCOMPLEX_DATATYPE,          /* 08                                 */
      858    12393    1              %PDLA_DATATYPE,              /* 09                                 */
      859    12394    1              %PDFLT_DATATYPE,             /* 10                                 */
      860    12395    1              %PDCLA_DATATYPE,             /* 11                                 */
      861    12396    1              %PDCFLT_DATATYPE,            /* 12                                 */
      862    12397    1              %POINTER_DATATYPE,           /* 13                                 */
      863    12398    1              %OFFSET_DATATYPE,            /* 14                                 */
      864    12399    1              %LABEL_DATATYPE,             /* 15                                 */
      865    12400    1              %ENTRY_DATATYPE,             /* 16                                 */
      866    12401    1              %STRUCTURE_DATATYPE,         /* 17                                 */
      867    12402    1              %AREA_DATATYPE,              /* 18                                 */
      868    12403    1              %BIT_DATATYPE,               /* 19                                 */
      869    12404    1              %VBIT_DATATYPE,              /* 20                                 */
      870    12405    1              %CHAR_DATATYPE,              /* 21                                 */
      871    12406    1              %VCHAR_DATATYPE,             /* 22                                 */
      872    12407    1              %FILE_DATATYPE,              /* 23                                 */
      873    12408    1              %UBIN_DATATYPE,              /* 24                                 */
      874    12409    1              %PDTA_DATATYPE,              /* 25                                 */
      875    12410    1              %ACHAR_DATATYPE,             /* 26                                 */
      876    12411    1              %ABIT_DATATYPE,              /* 27                                 */
      877    12412    1              %EPTR_DATATYPE,              /* 28                                 */
      878    12413    1              %COMP1_DATATYPE,             /* 29                                 */
      879    12414    1              %COMP2_DATATYPE,             /* 30                                 */
      880    12415    1              %PDTE_DATATYPE,              /* 31                                 */
      881    12416    1              %INDEX1_DATATYPE,            /* 32                                 */
      882    12417    1              %INDEX2_DATATYPE,            /* 33                                 */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:168  
      883    12418    1              %FEVERY_DATATYPE,            /* 34                                 */
      884    12419    1              %FLOGICAL_DATATYPE,          /* 35                                 */
      885    12420    1              %FANY_DATATYPE,              /* 36                                 */
      886    12421    1              %FLABEL_DATATYPE,            /* 37                                 */
      887    12422    1              %FUCB_DATATYPE,              /* 38                                 */
      888    12423    1              %INTCNST_DATATYPE,           /* 39                                 */
      889    12424    1              %PDNS_DATATYPE,              /* 40                                 */
      890    12425    1              %UDNS_DATATYPE,              /* 41                                 */
      891    12426    1              %UDLS_DATATYPE,              /* 42                                 */
      892    12427    1              %UDTS_DATATYPE,              /* 43                                 */
      893    12428    1              %UDLO_DATATYPE,              /* 44                                 */
      894    12429    1              %UDTO_DATATYPE,              /* 45                                 */
      895    12430    1              %ASTRUCTURE_DATATYPE,        /* 46                                 */
      896    12431    1              %VECTOR_DATATYPE,            /* 47                                 */
      897    12432    1              %VARVECTOR_DATATYPE,         /* 48                                 */
      898    12433    1              %DSCR_DATATYPE,              /* 49                                 */
      899    12434    1              %UDFLT_DATATYPE,             /* 50                                 */
      900    12435    1              %PDLE_DATATYPE,              /* 51                                 */
      901    12436    1              %ENUMTYPE_DATATYPE,          /* 52                                 */
      902    12437    1              %SET_DATATYPE,               /* 53                                 */
      903    12438    1              %DATE_DATATYPE,              /* 54                                 */
      904    12439    1              %UTS_DATATYPE,               /* 55                                 */
      905    12440    1              %TEXTH_DATATYPE,             /* 56                                 */
      906    12441    1              %TIME_DATATYPE,              /* 57                                 */
      907    12442    1              0,                           /* 58                                 */
      908    12443    1              0,                           /* 59                                 */
      909    12444    1              %NULL_DATATYPE,              /* 60                                 */
      910    12445    1              %VIRTUAL_ARRAY_DATATYPE,     /* 61                                 */
      911    12446    1              %REAL_ARRAY_DATATYPE),       /* 62                                 */
      912    12447    1         2 CLASS UBIN BYTE CALIGNED INIT(
      913    12448    1              1,                           /* %NO_DATATYPE,       00             */
      914    12449    1              1,                           /* %SBIN_DATATYPE,     01             */
      915    12450    1              4,                           /* %DFIX_DATATYPE,     02             */
      916    12451    1              1,                           /* %SFLT_DATATYPE,     03             */
      917    12452    1              1,                           /* %DFLT_DATATYPE,     04             */
      918    12453    1              4,                           /* %SCFIX_DATATYPE,    05             */
      919    12454    1              4,                           /* %DCFIX_DATATYPE,    06             */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:169  
      920    12455    1              4,                           /* %COMPLEX_DATATYPE,  07             */
      921    12456    1              4,                           /* %DCOMPLEX_DATATYPE, 08             */
      922    12457    1              2,                           /* %PDLA_DATATYPE,     09             */
      923    12458    1              2,                           /* %PDFLT_DATATYPE,    10             */
      924    12459    1              4,                           /* %PDCLA_DATATYPE,    11             */
      925    12460    1              4,                           /* %PDCFLT_DATATYPE,   12             */
      926    12461    1              4,                           /* %POINTER_DATATYPE,  13             */
      927    12462    1              4,                           /* %OFFSET_DATATYPE,   14             */
      928    12463    1              4,                           /* %LABEL_DATATYPE,    15             */
      929    12464    1              4,                           /* %ENTRY_DATATYPE,    16             */
      930    12465    1              4,                           /* %STRUCTURE_DATATYPE,17             */
      931    12466    1              4,                           /* %AREA_DATATYPE,     18             */
      932    12467    1              4,                           /* %BIT_DATATYPE,      19             */
      933    12468    1              4,                           /* %VBIT_DATATYPE,     20             */
      934    12469    1              1,                           /* %CHAR_DATATYPE,     21             */
      935    12470    1              1,                           /* %VCHAR_DATATYPE,    22             */
      936    12471    1              4,                           /* %FILE_DATATYPE,     23             */
      937    12472    1              1,                           /* %UBIN_DATATYPE,     24             */
      938    12473    1              2,                           /* %PDTA_DATATYPE,     25             */
      939    12474    1              4,                           /* %ACHAR_DATATYPE,    26             */
      940    12475    1              4,                           /* %ABIT_DATATYPE,     27             */
      941    12476    1              4,                           /* %EPTR_DATATYPE,     28             */
      942    12477    1              4,                           /* %COMP1_DATATYPE,    29             */
      943    12478    1              4,                           /* %COMP2_DATATYPE,    30             */
      944    12479    1              2,                           /* %PDTE_DATATYPE,     31             */
      945    12480    1              4,                           /* %INDEX1_DATATYPE,   32             */
      946    12481    1              4,                           /* %INDEX2_DATATYPE,   33             */
      947    12482    1              4,                           /* %FEVERY_DATATYPE,   34             */
      948    12483    1              4,                           /* %FLOGICAL_DATATYPE, 35             */
      949    12484    1              4,                           /* %FANY_DATATYPE,     36             */
      950    12485    1              4,                           /* %FLABEL_DATATYPE,   37             */
      951    12486    1              4,                           /* %FUCB_DATATYPE,     38             */
      952    12487    1              4,                           /* %INTCNST_DATATYPE,  39             */
      953    12488    1              2,                           /* %PDNS_DATATYPE,     40             */
      954    12489    1              2,                           /* %UDNS_DATATYPE,     41             */
      955    12490    1              2,                           /* %UDLS_DATATYPE,     42             */
      956    12491    1              2,                           /* %UDTS_DATATYPE,     43             */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:170  
      957    12492    1              2,                           /* %UDLO_DATATYPE,     44             */
      958    12493    1              2,                           /* %UDTO_DATATYPE,     45             */
      959    12494    1              4,                           /* %ASTRUCTURE_DATATYPE,46            */
      960    12495    1              3,                           /* %VECTOR_DATATYPE,   47             */
      961    12496    1              5,                           /* %VARVECTOR_DATATYPE,48             */
      962    12497    1              4,                           /* %DSCR_DATATYPE,     49             */
      963    12498    1              2,                           /* %UDFLT_DATATYPE,    50             */
      964    12499    1              2,                           /* %PDLE_DATATYPE,     51             */
      965    12500    1              4,                           /* %ENUMTYPE_DATATYPE, 52             */
      966    12501    1              4,                           /* %SET_DATATYPE,      53             */
      967    12502    1              2,                           /* %DATE_DATATYPE,     54             */
      968    12503    1              1,                           /* %UTS_DATATYPE,      55             */
      969    12504    1              1,                           /* %TEXTH_DATATYPE,    56             */
      970    12505    1              2,                           /* %TIME_DATATYPE,     57             */
      971    12506    1              0,                           /* --,   58                           */
      972    12507    1              0,                           /* --,   59                           */
      973    12508    1              4,                           /* %NULL_DATATYPE,     60             */
      974    12509    1              4,                           /* %VIRTUAL_ARRAY_DATATYPE,61         */
      975    12510    1              4),                          /* %REAL_ARRAY_DATATYPE,62            */
      976    12511    1         2 UNITS UBIN BYTE CALIGNED INIT(
      977    12512    1              3,                           /* %NO_DATATYPE,       00             */
      978    12513    1              1,                           /* %SBIN_DATATYPE,     01             */
      979    12514    1              0,                           /* %DFIX_DATATYPE,     02             */
      980    12515    1              3,                           /* %SFLT_DATATYPE,     03             */
      981    12516    1              3,                           /* %DFLT_DATATYPE,     04             */
      982    12517    1              0,                           /* %SCFIX_DATATYPE,    05             */
      983    12518    1              0,                           /* %DCFIX_DATATYPE,    06             */
      984    12519    1              0,                           /* %COMPLEX_DATATYPE,  07             */
      985    12520    1              0,                           /* %DCOMPLEX_DATATYPE, 08             */
      986    12521    1              2,                           /* %PDLA_DATATYPE,     09             */
      987    12522    1              2,                           /* %PDFLT_DATATYPE,    10             */
      988    12523    1              0,                           /* %PDCLA_DATATYPE,    11             */
      989    12524    1              0,                           /* %PDCFLT_DATATYPE,   12             */
      990    12525    1              0,                           /* %POINTER_DATATYPE,  13             */
      991    12526    1              0,                           /* %OFFSET_DATATYPE,   14             */
      992    12527    1              0,                           /* %LABEL_DATATYPE,    15             */
      993    12528    1              0,                           /* %ENTRY_DATATYPE,    16             */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:171  
      994    12529    1              0,                           /* %STRUCTURE_DATATYPE,17             */
      995    12530    1              0,                           /* %AREA_DATATYPE,     18             */
      996    12531    1              0,                           /* %BIT_DATATYPE,      19             */
      997    12532    1              0,                           /* %VBIT_DATATYPE,     20             */
      998    12533    1              3,                           /* %CHAR_DATATYPE,     21             */
      999    12534    1              3,                           /* %VCHAR_DATATYPE,    22             */
     1000    12535    1              0,                           /* %FILE_DATATYPE,     23             */
     1001    12536    1              1,                           /* %UBIN_DATATYPE,     24             */
     1002    12537    1              2,                           /* %PDTA_DATATYPE,     25             */
     1003    12538    1              0,                           /* %ACHAR_DATATYPE,    26             */
     1004    12539    1              0,                           /* %ABIT_DATATYPE,     27             */
     1005    12540    1              0,                           /* %EPTR_DATATYPE,     28             */
     1006    12541    1              0,                           /* %COMP1_DATATYPE,    29             */
     1007    12542    1              0,                           /* %COMP2_DATATYPE,    30             */
     1008    12543    1              2,                           /* %PDTE_DATATYPE,     31             */
     1009    12544    1              0,                           /* %INDEX1_DATATYPE,   32             */
     1010    12545    1              0,                           /* %INDEX2_DATATYPE,   33             */
     1011    12546    1              0,                           /* %FEVERY_DATATYPE,   34             */
     1012    12547    1              0,                           /* %FLOGICAL_DATATYPE, 35             */
     1013    12548    1              0,                           /* %FANY_DATATYPE,     36             */
     1014    12549    1              0,                           /* %FLABEL_DATATYPE,   37             */
     1015    12550    1              0,                           /* %FUCB_DATATYPE,     38             */
     1016    12551    1              0,                           /* %INTCNST_DATATYPE,  39             */
     1017    12552    1              2,                           /* %PDNS_DATATYPE,     40             */
     1018    12553    1              3,                           /* %UDNS_DATATYPE,     41             */
     1019    12554    1              3,                           /* %UDLS_DATATYPE,     42             */
     1020    12555    1              3,                           /* %UDTS_DATATYPE,     43             */
     1021    12556    1              3,                           /* %UDLO_DATATYPE,     44             */
     1022    12557    1              3,                           /* %UDTO_DATATYPE,     45             */
     1023    12558    1              0,                           /* %ASTRUCTURE_DATATYPE,46            */
     1024    12559    1              4,                           /* %VECTOR_DATATYPE,   47             */
     1025    12560    1              4,                           /* %VARVECTOR_DATATYPE,48             */
     1026    12561    1              0,                           /* %DSCR_DATATYPE,     49             */
     1027    12562    1              3,                           /* %UDFLT_DATATYPE,    50             */
     1028    12563    1              2,                           /* %PDLE_DATATYPE,     51             */
     1029    12564    1              0,                           /* %ENUMTYPE_DATATYPE, 52             */
     1030    12565    1              0,                           /* %SET_DATATYPE,      53             */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:172  
     1031    12566    1              2,                           /* %DATE_DATATYPE,     54             */
     1032    12567    1              1,                           /* %UTS_DATATYPE,      55             */
     1033    12568    1              3,                           /* %TEXTH_DATATYPE,    56             */
     1034    12569    1              2,                           /* %TIME_DATATYPE,     57             */
     1035    12570    1              0,                           /* --,   58                           */
     1036    12571    1              0,                           /* --,   59                           */
     1037    12572    1              0,                           /* %NULL_DATATYPE,     60             */
     1038    12573    1              0,                           /* %VIRTUAL_ARRAY_DATATYPE,61         */
     1039    12574    1              0);                          /* %REAL_ARRAY_DATATYPE,62            */
     1040    12575    1   DCL CODE SBIN WORD;
     1041    12576    1   DCL CODE$ PTR;
     1042    12577    1   DCL CODES_IDX SBIN WORD;
     1043    12578    1   DCL BIT$ARY(0:0) BIT(1) BASED;
     1044    12579    1   DCL CHAR$7 CHAR(7) BASED;
     1045    12580    1   DCL CHAR$1 CHAR(1) BASED;
     1046    12581    1   DCL 1 NUM$ARY BASED,
     1047    12582    1         2 * UBIN BYTE UNAL,
     1048    12583    1         2 N(0:0),
     1049    12584    1           3 * CHAR(13),
     1050    12585    1           3 NUM CHAR(5);
     1051    12586    1   DCL 1 COL$ARY BASED,
     1052    12587    1         2 * UBIN BYTE UNAL,
     1053    12588    1         2 N(0:0),
     1054    12589    1           3 * CHAR(2),
     1055    12590    1           3 TXT CHAR(8);
     1056    12591    1   DCL I SBIN WORD;
     1057    12592    1   DCL J SBIN WORD;
     1058    12593    1   DCL PTR$ PTR;
     1059    12594    1   DCL EQ_IDX SBIN;
     1060    12595    1   DCL BYTE_IDX SBIN WORD;
     1061    12596    1   DCL NUM_BYTES SBIN WORD;
     1062    12597    1   DCL EXP_TIME SBIN WORD;
     1063    12598    1   DCL CREATE_TIME UBIN WORD;
     1064    12599    1   DCL UTS_TMP UBIN WORD;
     1065    12600    1   DCL EXP_INTERVAL_DAYS SBIN WORD;
     1066    12601    1   DCL CONV_BUF CHAR(6);
     1067    12602    1   DCL OLD_BUF$ PTR;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:173  
     1068    12603    1   DCL NEW_BUF$ PTR;
     1069    12604    1   DCL TCODE$ PTR;
     1070    12605    1   DCL DENS_STR CHAR(5);
     1071    12606        /**/
     1072    12607        /*  ENTRY DCLS  */
     1073    12608        /**/
     1074    12609        %VP_ENTRIES (OMIT=VPH$GET_LIST_BUFS);
     1075    12817    1   DCL XSF$LOCCODE ENTRY(2) ALTRET;
     1076    12818    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
     1077    12819        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:174  
     1078    12820    2           IF LIST_BUF$=ADDR(NIL) THEN DO; /* Do we have a buffer for this       */

  12820 12 000002   000000 236000 xsym               LDQ     LIST_BUF$
        12 000003   000001 116000 xsym               CMPQ    B_VECTNIL+1
        12 000004   000020 601000 12                 TNZ     s:12827

     1079    12821    2               CALL VPD$GET_BUF(LIST_BUF$,1024) /* nope - go get a page          */

  12821 12 000005   000001 630400 13                 EPPR0   1
        12 000006   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000007   000000 701000 xent               TSX1    VPD$GET_BUF
        12 000010   000012 702000 12                 TSX2    s:12823
        12 000011   000016 710000 12                 TRA     s:12825

     1080    12822    3                WHENALTRETURN DO;

     1081    12823    3                   CALL VPL$ERR_PROC(3,0); /* Sigh                               */

  12823 12 000012   000003 630400 13                 EPPR0   3
        12 000013   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000014   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000015   000000 011000                    NOP     0

     1082    12824    3                   END;

     1083    12825    2               LIST_SIZE=1024;             /* remember how much we have          */

  12825 12 000016   002000 235007                    LDA     1024,DL
        12 000017   000000 755000 xsym               STA     LIST_SIZE

     1084    12826    2               END;

     1085    12827    1           BUF_BLOCK.COUNT = 1;

  12827 12 000020   000001 235007                    LDA     1,DL
        12 000021   000000 470400 xsym               LDP0    LIST_BUF$
        12 000022   000000 755100                    STA     0,,PR0
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:175  

     1086    12828    1           IF LIST_CODE=1

  12828 12 000023   200003 470500                    LDP0    @LIST_CODE,,AUTO
        12 000024   000000 235100                    LDA     0,,PR0
        12 000025   000001 115007                    CMPA    1,DL
        12 000026   000054 601000 12                 TNZ     s:12839

     1087    12829    1            THEN                           /* NAME only LIST                     */
     1088    12830    2            DO;

     1089    12831    3               IF ICB.FFID THEN DO;

  12831 12 000027   000137 234000 xsym               SZN     ICB+95
        12 000030   000047 605000 12                 TPL     s:12836

     1090    12832    3                   CALL GET_FULL_FID(PINCRC(ADDR(BUF_BLOCK.BUF_1),1),LEN_BYTES);

  12832 12 000031   000000 236000 xsym               LDQ     LIST_BUF$
        12 000032   000005 036000 13                 ADLQ    5
        12 000033   200067 756100                    STQ     @LEN+7,,AUTO
        12 000034   200006 631500                    EPPR1   LEN_BYTES,,AUTO
        12 000035   200060 451500                    STP1    @NAME$+1,,AUTO
        12 000036   200067 633500                    EPPR3   @LEN+7,,AUTO
        12 000037   200057 453500                    STP3    DENS_STR+4,,AUTO
        12 000040   005531 701000 12                 TSX1    GET_FULL_FID
        12 000041   000000 011000                    NOP     0

     1091    12833    3                   ADDR(BUF_BLOCK.BUF_1)->B$UBIN1 = LEN_BYTES;

  12833 12 000042   000000 470400 xsym               LDP0    LIST_BUF$
        12 000043   200006 236100                    LDQ     LEN_BYTES,,AUTO
        12 000044   000033 736000                    QLS     27
        12 000045   000001 552140                    STBQ    1,'40'O,PR0

     1092    12834    3                   END;

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:176  
  12834 12 000046   000053 710000 12                 TRA     s:12837

     1093    12835    2                ELSE
     1094    12836    2                  BUF_BLOCK.BUF_1 = DIN_NAME;

  12836 12 000047   000000 471400 xsym               LDP1    LIST_BUF$
        12 000050   000100 100400                    MLR     fill='000'O
        12 000051   000000 000040 xsym               ADSC9   DIN_NAME                 cn=0,n=32
        12 000052   100001 000115                    ADSC9   1,,PR1                   cn=0,n=77

     1095    12837    2               RETURN;

  12837 12 000053   000000 702200 xent               TSX2  ! X66_ARET

     1096    12838    2               END;
     1097    12839    2           IF ICB.FFID THEN DO;

  12839 12 000054   000137 234000 xsym               SZN     ICB+95
        12 000055   000070 605000 12                 TPL     s:12843

     1098    12840    2               CALL GET_FULL_FID(ADDR(BUF_BLOCK.BUF_1.NAME),LEN_BYTES);

  12840 12 000056   000000 236000 xsym               LDQ     LIST_BUF$
        12 000057   000006 036000 13                 ADLQ    6
        12 000060   200070 756100                    STQ     @LEN+8,,AUTO
        12 000061   200006 631500                    EPPR1   LEN_BYTES,,AUTO
        12 000062   200060 451500                    STP1    @NAME$+1,,AUTO
        12 000063   200070 633500                    EPPR3   @LEN+8,,AUTO
        12 000064   200057 453500                    STP3    DENS_STR+4,,AUTO
        12 000065   005531 701000 12                 TSX1    GET_FULL_FID
        12 000066   000000 011000                    NOP     0

     1099    12841    2               END;

  12841 12 000067   000100 710000 12                 TRA     s:12846

     1100    12842    2            ELSE DO;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:177  

     1101    12843    2               BUF_BLOCK.BUF_1.NAME = ADDR(DIN_NAME) -> TEXT$C.STRING;

  12843 12 000070   000000 236000 xsym               LDQ     DIN_NAME
        12 000071   000033 772000                    QRL     27
        12 000072   000000 620006                    EAX0    0,QL
        12 000073   000000 471400 xsym               LDP1    LIST_BUF$
        12 000074   040100 100440                    MLR     fill='040'O
        12 000075   000000 200010 xsym               ADSC9   DIN_NAME                 cn=1,n=*X0
        12 000076   100014 400037                    ADSC9   12,,PR1                  cn=2,n=31

     1102    12844    2               LEN_BYTES = DIN_NAME.LEN;

  12844 12 000077   200006 756100                    STQ     LEN_BYTES,,AUTO

     1103    12845    2               END;

     1104    12846    1           BUF_BLOCK.BUF_1.LEN = SIZEC(BUF_BLOCK.BUF_1.INFO_FIELD) + LEN_BYTES;

  12846 12 000100   000000 470400 xsym               LDP0    LIST_BUF$
        12 000101   200006 236100                    LDQ     LEN_BYTES,,AUTO
        12 000102   000055 036007                    ADLQ    45,DL
        12 000103   000033 736000                    QLS     27
        12 000104   000001 552140                    STBQ    1,'40'O,PR0

     1105    12847    1           IF LIST_CODE = 2

  12847 12 000105   200003 471500                    LDP1    @LIST_CODE,,AUTO
        12 000106   100000 235100                    LDA     0,,PR1
        12 000107   000002 115007                    CMPA    2,DL
        12 000110   000115 601000 12                 TNZ     s:12858

     1106    12848    1            THEN                           /* ACCESS DENIED on a L(A) or better  */
     1107    12849    2            DO;

     1108    12850    2               BUF_BLOCK.BUF_1.INFO_FIELD = '*** Access denied ***';

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:178  
  12850 12 000111   040100 100400                    MLR     fill='040'O
        12 000112   000535 000025 11                 ADSC9   XTEND_STRINGS+95         cn=0,n=21
        12 000113   000001 200055                    ADSC9   1,,PR0                   cn=1,n=45

     1109    12851    2               RETURN;

  12851 12 000114   000000 702200 xent               TSX2  ! X66_ARET

     1110    12852    2               END;
     1111    12853        /******************************************************************************/
     1112    12854        /*                                                                            */
     1113    12855        /*  The remaining code is for L(A) or better                                  */
     1114    12856        /*                                                                            */
     1115    12857        /******************************************************************************/
     1116    12858    1           BUF_BLOCK.BUF_1.INFO_FIELD = ' ';

  12858 12 000115   040100 100400                    MLR     fill='040'O
        12 000116   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 000117   000001 200055                    ADSC9   1,,PR0                   cn=1,n=45

     1117    12859    1           IF M$EI$->F$DCB.DESC.DELF

  12859 12 000120   000000 473400 xsym               LDP3    M$EI$
        12 000121   300005 236100                    LDQ     5,,PR3
        12 000122   400000 316007                    CANQ    -131072,DL
        12 000123   000136 600000 12                 TZE     s:12872

     1118    12860    1            THEN
     1119    12861    1              IF M$EI$->F$DCB.DESC.ARCHIVE

  12861 12 000124   001000 316007                    CANQ    512,DL
        12 000125   000132 600000 12                 TZE     s:12869

     1120    12862    1               THEN
     1121    12863    2               DO;

     1122    12864    2                  BUF_BLOCK.BUF_1.INFO_FIELD = '*** Stowed File ***';
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:179  

  12864 12 000126   040100 100400                    MLR     fill='040'O
        12 000127   000543 000023 11                 ADSC9   XTEND_STRINGS+101        cn=0,n=19
        12 000130   000001 200055                    ADSC9   1,,PR0                   cn=1,n=45

     1123    12865    2                  GOTO DONT_ORG;

  12865 12 000131   000171 710000 12                 TRA     DONT_ORG

     1124    12866    2                  END;
     1125    12867    1               ELSE
     1126    12868    2               DO;

     1127    12869    2                  BUF_BLOCK.BUF_1.INFO_FIELD = '*** Deleted File ***';

  12869 12 000132   040100 100400                    MLR     fill='040'O
        12 000133   000550 000024 11                 ADSC9   XTEND_STRINGS+106        cn=0,n=20
        12 000134   000001 200055                    ADSC9   1,,PR0                   cn=1,n=45

     1128    12870    2                  RETURN;

  12870 12 000135   000000 702200 xent               TSX2  ! X66_ARET

     1129    12871    2                  END;
     1130    12872    1           I = %MAX_ORG#;

  12872 12 000136   000032 235007                    LDA     26,DL
        12 000137   200034 755100                    STA     I,,AUTO

     1131    12873    2           DO WHILE (I > 0 AND M$EI$->F$DCB.ORG~=ORG_TBL.ORG_MON(I));

  12873 12 000140   000143 710000 12                 TRA     s:12875

     1132    12874    2              I = I -1;

  12874 12 000141   000001 336007                    LCQ     1,DL
        12 000142   200034 056100                    ASQ     I,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:180  

     1133    12875    2              END;

  12875 12 000143   200034 235100                    LDA     I,,AUTO
        12 000144   000157 604400 12                 TMOZ    s:12876
        12 000145   200034 236100                    LDQ     I,,AUTO
        12 000146   000022 402007                    MPY     18,DL
        12 000147   000100 101406                    MRL     fill='000'O
        12 000150   000000 000001 xsym               ADSC9   ORG_TBL,Q                cn=0,n=1
        12 000151   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000152   000000 470400 xsym               LDP0    M$EI$
        12 000153   000032 236100                    LDQ     26,,PR0
        12 000154   000033 772000                    QRL     27
        12 000155   200062 116100                    CMPQ    @LEN+2,,AUTO
        12 000156   000141 601000 12                 TNZ     s:12874

     1134    12876    1           BUF_BLOCK.BUF_1.INFO.ORG = ORG_TBL.ABBR(I);

  12876 12 000157   200034 236100                    LDQ     I,,AUTO
        12 000160   000022 402007                    MPY     18,DL
        12 000161   000000 470400 xsym               LDP0    LIST_BUF$
        12 000162   040100 100406                    MLR     fill='040'O
        12 000163   000003 200003 xsym               ADSC9   ORG_TBL+3,Q              cn=1,n=3
        12 000164   000001 200003                    ADSC9   1,,PR0                   cn=1,n=3

     1135    12877    1           BUF_BLOCK.BUF_1.INFO.TY  = M$EI$->F$DCB.TYPE;

  12877 12 000165   000000 471400 xsym               LDP1    M$EI$
        12 000166   100025 236100                    LDQ     21,,PR1
        12 000167   000011 736000                    QLS     9
        12 000170   000002 552130                    STBQ    2,'30'O,PR0

     1136    12878        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:181  
     1137    12879    1   DONT_ORG:
     1138    12880    1           IF ICB.DEV_MASK='100'O

  12880 12 000171   000171 236000 xsym  DONT_ORG     LDQ     ICB+121
        12 000172   777000 376003                    ANQ     -512,DU
        12 000173   100000 116003                    CMPQ    32768,DU
        12 000174   000270 601000 12                 TNZ     s:12901

     1139    12881    1            THEN                           /* L(A) or better for LT              */
     1140    12882    2            DO;

     1141    12883    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.GRAN,M$EI$->F$DCB.BLKL);

  12883 12 000175   000000 471400 xsym               LDP1    M$EI$
        12 000176   100033 236100                    LDQ     27,,PR1
        12 000177   000022 772000                    QRL     18
        12 000200   000000 235003                    LDA     0,DU
        12 000201   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000202   000100 301500                    BTD
        12 000203   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 000204   000002 630006                    NDSC9   2,,PR0                   cn=3,s=nosgn,sf=0,n=6

     1142    12884    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.NGAV,M$EI$->F$DCB.RECL);

  12884 12 000205   100033 236100                    LDQ     27,,PR1
        12 000206   777777 376007                    ANQ     -1,DL
        12 000207   000000 235003                    LDA     0,DU
        12 000210   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000211   000100 301500                    BTD
        12 000212   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 000213   000004 230006                    NDSC9   4,,PR0                   cn=1,s=nosgn,sf=0,n=6

     1143    12885    2               BUF_BLOCK.BUF_1.INFO.LT.VOL = M$EI$->F$DCB.PSN;

  12885 12 000214   040100 100500                    MLR     fill='040'O
        12 000215   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
        12 000216   000010 000006                    ADSC9   8,,PR0                   cn=0,n=6
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:182  

     1144    12886    2               CALL M$PRECORD(FPT_PRECORD) ALTRET(PREC_ALT);

  12886 12 000217   000026 630400 11                 EPPR0   FPT_PRECORD
        12 000220   440003 713400                    CLIMB   alt,+16387
        12 000221   401000 401760                    pmme    nvectors=3
        12 000222   000224 702000 12                 TSX2    PREC_ALT

     1145    12887    3               DO WHILE('0'B);

  12887 12 000223   000236 710000 12                 TRA     s:12892

     1146    12888    3   PREC_ALT:      IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$EOF

  12888 12 000224   000000 470400 xsym  PREC_ALT     LDP0    B$TCB$
        12 000225   000000 471500                    LDP1    0,,PR0
        12 000226   100102 236100                    LDQ     66,,PR1
        12 000227   377770 376007                    ANQ     131064,DL
        12 000230   000060 116007                    CMPQ    48,DL
        12 000231   000236 600000 12                 TZE     s:12892

     1147    12889    3                   THEN
     1148    12890    3                     CALL VPL$ERR_PROC(3,0);

  12890 12 000232   000003 630400 13                 EPPR0   3
        12 000233   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000234   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000235   000000 011000                    NOP     0

     1149    12891    3                  END;

     1150    12892    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.RECS,M$EI$->F$DCB.ARS);

  12892 12 000236   000000 470400 xsym               LDP0    M$EI$
        12 000237   000000 471400 xsym               LDP1    LIST_BUF$
        12 000240   000100 301500                    BTD
        12 000241   000000 000004                    NDSC9   0,,PR0                   cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:183  
        12 000242   100005 630010                    NDSC9   5,,PR1                   cn=3,s=nosgn,sf=0,n=8

     1151    12893    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.LT.FSN,M$EI$->F$DCB.FSN);

  12893 12 000243   000034 236100                    LDQ     28,,PR0
        12 000244   000022 772000                    QRL     18
        12 000245   000000 235003                    LDA     0,DU
        12 000246   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000247   000100 301500                    BTD
        12 000250   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 000251   100013 030005                    NDSC9   11,,PR1                  cn=0,s=nosgn,sf=0,n=5

     1152    12894    2               CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.LT.FSN));

  12894 12 000252   000007 235000 13                 LDA     7
        12 000253   000000 236000 xsym               LDQ     LIST_BUF$
        12 000254   000013 036003                    ADLQ    11,DU
        12 000255   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000256   200062 633500                    EPPR3   @LEN+2,,AUTO
        12 000257   200064 453500                    STP3    @LEN+4,,AUTO
        12 000260   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 000261   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000262   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 000263   000000 011000                    NOP     0

     1153    12895    2               CALL M$CLOSE(FPT_CLOSE_EI);

  12895 12 000264   000000 630400 xsym               EPPR0   FPT_CLOSE_EI
        12 000265   050001 713400                    CLIMB   close
        12 000266   406000 401760                    pmme    nvectors=13

     1154    12896    2               END;

  12896 12 000267   000365 710000 12                 TRA     s:12920

     1155    12897        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:184  
     1156    12898    1            ELSE                           /* L(A) or better, non-LT             */
     1157    12899    2            DO;

     1158    12900                                                /* CODE04: MODIFICATION time          */
     1159    12901    2               CODE$ = FPARAM$;

  12901 12 000270   000000 236000 xsym               LDQ     FPARAM$
        12 000271   200032 756100                    STQ     CODE$,,AUTO

     1160    12902    2               CALL XSF$LOCCODP(CODE$,4) ALTRET(NO_CODE_4);

  12902 12 000272   000010 236000 13                 LDQ     8
        12 000273   200063 756100                    STQ     @LEN+3,,AUTO
        12 000274   200032 631500                    EPPR1   CODE$,,AUTO
        12 000275   200062 451500                    STP1    @LEN+2,,AUTO
        12 000276   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 000277   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000300   000000 701000 xent               TSX1    XSF$LOCCODP
        12 000301   000326 702000 12                 TSX2    NO_CODE_4

     1161    12903    2               IF TEST_MODE=1

  12903 12 000302   000000 235000 xsym               LDA     TEST_MODE
        12 000303   000001 115007                    CMPA    1,DL
        12 000304   000310 601000 12                 TNZ     s:12907

     1162    12904    2                THEN
     1163    12905    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);

  12905 12 000305   000012 237000 13                 LDAQ    10
        12 000306   000012 757000 10                 STAQ    FPT_TIME+8
        12 000307   000314 710000 12                 TRA     s:12908

     1164    12906    2                ELSE
     1165    12907    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE04.MODIFY.TIME);

  12907 12 000310   777640 235007                    LDA     -96,DL
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:185  
        12 000311   200032 236100                    LDQ     CODE$,,AUTO
        12 000312   000001 036003                    ADLQ    1,DU
        12 000313   000012 757000 10                 STAQ    FPT_TIME+8

     1166    12908    2               CALL M$TIME(FPT_TIME);

  12908 12 000314   000002 630400 10                 EPPR0   FPT_TIME
        12 000315   020004 713400                    CLIMB   8196
        12 000316   402000 401760                    pmme    nvectors=5

     1167    12909    2               BUF_BLOCK.BUF_1.INFO.DP.TIME = TIME_BUF.HH_MM;

  12909 12 000317   000000 470400 xsym               LDP0    LIST_BUF$
        12 000320   040100 100400                    MLR     fill='040'O
        12 000321   000024 000005 10                 ADSC9   TIME_BUF                 cn=0,n=5
        12 000322   000010 000005                    ADSC9   8,,PR0                   cn=0,n=5

     1168    12910    2               BUF_BLOCK.BUF_1.INFO.DP.DATE = DATE_BUF;

  12910 12 000323   040100 100400                    MLR     fill='040'O
        12 000324   000021 000012 10                 ADSC9   DATE_BUF                 cn=0,n=10
        12 000325   000011 400012                    ADSC9   9,,PR0                   cn=2,n=10

     1169    12911    2   NO_CODE_4:
     1170    12912                                                /* CODE03: GRANS, NGAVAL, RECS        */
     1171    12913    2               CODE$ = FPARAM$;

  12913 12 000326   000000 236000 xsym  NO_CODE_4    LDQ     FPARAM$
        12 000327   200032 756100                    STQ     CODE$,,AUTO

     1172    12914    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_CODE_3);

  12914 12 000330   000003 236000 13                 LDQ     3
        12 000331   200063 756100                    STQ     @LEN+3,,AUTO
        12 000332   200032 630500                    EPPR0   CODE$,,AUTO
        12 000333   200062 450500                    STP0    @LEN+2,,AUTO
        12 000334   200062 630500                    EPPR0   @LEN+2,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:186  
        12 000335   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000336   000000 701000 xent               TSX1    XSF$LOCCODP
        12 000337   000423 702000 12                 TSX2    NO_CODE_3

     1173    12915    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.GRAN,CODE$->CODE03.UGRANS);

  12915 12 000340   200032 470500                    LDP0    CODE$,,AUTO
        12 000341   000000 236100                    LDQ     0,,PR0
        12 000342   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 000343   000000 235003                    LDA     0,DU
        12 000344   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000345   000000 471400 xsym               LDP1    LIST_BUF$
        12 000346   000100 301500                    BTD
        12 000347   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 000350   100002 630006                    NDSC9   2,,PR1                   cn=3,s=nosgn,sf=0,n=6

     1174    12916    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.NGAV,CODE$->CODE03.NGAVAL);

  12916 12 000351   200032 470500                    LDP0    CODE$,,AUTO
        12 000352   000003 236100                    LDQ     3,,PR0
        12 000353   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 000354   000000 235003                    LDA     0,DU
        12 000355   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000356   000100 301500                    BTD
        12 000357   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 000360   100004 230006                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=6

     1175    12917    2               CALL BINCHAR(BUF_BLOCK.BUF_1.INFO.RECS,CODE$->CODE03.NRECS);

  12917 12 000361   200032 470500                    LDP0    CODE$,,AUTO
        12 000362   000100 301500                    BTD
        12 000363   000002 000004                    NDSC9   2,,PR0                   cn=0,s=lsgnf,sf=0,n=4
        12 000364   100005 630010                    NDSC9   5,,PR1                   cn=3,s=nosgn,sf=0,n=8

     1176    12918    2               END;

     1177    12919                                                /* L(A) or better for ANY file        */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:187  
     1178    12920    1           CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.GRAN));

  12920 12 000365   000014 235000 13                 LDA     12
        12 000366   000000 236000 xsym               LDQ     LIST_BUF$
        12 000367   000015 036000 13                 ADLQ    13
        12 000370   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000371   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 000372   200064 450500                    STP0    @LEN+4,,AUTO
        12 000373   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 000374   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000375   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 000376   000000 011000                    NOP     0

     1179    12921    1           CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.NGAV));

  12921 12 000377   000014 235000 13                 LDA     12
        12 000400   000000 236000 xsym               LDQ     LIST_BUF$
        12 000401   000016 036000 13                 ADLQ    14
        12 000402   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000403   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 000404   200064 450500                    STP0    @LEN+4,,AUTO
        12 000405   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 000406   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000407   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 000410   000000 011000                    NOP     0

     1180    12922    1           CALL VPD$CLOBBERLZ(VECTOR(BUF_BLOCK.BUF_1.INFO.RECS));

  12922 12 000411   000017 235000 13                 LDA     15
        12 000412   000000 236000 xsym               LDQ     LIST_BUF$
        12 000413   000020 036000 13                 ADLQ    16
        12 000414   200062 757100                    STAQ    @LEN+2,,AUTO
        12 000415   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 000416   200064 450500                    STP0    @LEN+4,,AUTO
        12 000417   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 000420   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000421   000000 701000 xent               TSX1    VPD$CLOBBERLZ
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:188  
        12 000422   000000 011000                    NOP     0

     1181    12923    1   NO_CODE_3:
     1182    12924        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:189  
     1183    12925    1           OLD_BUF$ = ADDR(BUF_BLOCK.BUF_1.LEN);

  12925 12 000423   000000 236000 xsym  NO_CODE_3    LDQ     LIST_BUF$
        12 000424   000001 036003                    ADLQ    1,DU
        12 000425   200050 756100                    STQ     OLD_BUF$,,AUTO

     1184    12926                                                /* CODE09: ACCount controls           */
     1185    12927                                                /* CODE09: ACSvehicle controls        */
     1186    12928    2           DO CODE=9 TO 10;

  12928 12 000426   000011 235007                    LDA     9,DL
        12 000427   200031 755100                    STA     CODE,,AUTO

     1187    12929    2              CODE$ = FPARAM$;

  12929 12 000430   000000 236000 xsym               LDQ     FPARAM$
        12 000431   200032 756100                    STQ     CODE$,,AUTO

     1188    12930    2              CODES_IDX = CODE;

  12930 12 000432   200031 235100                    LDA     CODE,,AUTO
        12 000433   200033 755100                    STA     CODES_IDX,,AUTO

     1189    12931    2              CALL XSF$LOCCODE(CODE$,CODES_IDX) ALTRET(LOOP_END);

  12931 12 000434   200033 630500                    EPPR0   CODES_IDX,,AUTO
        12 000435   200063 450500                    STP0    @LEN+3,,AUTO
        12 000436   200032 631500                    EPPR1   CODE$,,AUTO
        12 000437   200062 451500                    STP1    @LEN+2,,AUTO
        12 000440   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 000441   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000442   000000 701000 xent               TSX1    XSF$LOCCODE
        12 000443   001004 702000 12                 TSX2    LOOP_END

     1190    12932    2              NUM_BYTES = FPARAM$->FM$FIT.CODES.NDW(CODES_IDX)*4;

  12932 12 000444   000000 470400 xsym               LDP0    FPARAM$
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:190  
        12 000445   200033 720100                    LXL0    CODES_IDX,,AUTO
        12 000446   000000 236110                    LDQ     0,X0,PR0
        12 000447   000010 772000                    QRL     8
        12 000450   007774 376007                    ANQ     4092,DL
        12 000451   200041 756100                    STQ     NUM_BYTES,,AUTO

     1191    12933    2              BYTE_IDX = 0;

  12933 12 000452   200040 450100                    STZ     BYTE_IDX,,AUTO

     1192    12934    3              DO WHILE((BYTE_IDX+3<NUM_BYTES AND CODE=10) /* ACS specs left      */

  12934 12 000453   000766 710000 12                 TRA     s:12984

     1193    12935    3                OR (BYTE_IDX+9<NUM_BYTES AND CODE=9)); /* ACC specs left         */
     1194    12936    3                 NEW_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  12936 12 000454   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 000455   000100 101500                    MRL     fill='000'O
        12 000456   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000457   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000460   200062 236100                    LDQ     @LEN+2,,AUTO
        12 000461   000020 736000                    QLS     16
        12 000462   200000 036007                    ADLQ    65536,DL
        12 000463   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 000464   200051 756100                    STQ     NEW_BUF$,,AUTO

     1195    12937    3                 TCODE$ = PINCRC(CODE$,BYTE_IDX);

  12937 12 000465   200040 236100                    LDQ     BYTE_IDX,,AUTO
        12 000466   000020 736000                    QLS     16
        12 000467   200032 036100                    ADLQ    CODE$,,AUTO
        12 000470   200052 756100                    STQ     TCODE$,,AUTO

     1196    12938    3                 IF CODE=9

  12938 12 000471   200031 235100                    LDA     CODE,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:191  
        12 000472   000011 115007                    CMPA    9,DL
        12 000473   000546 601000 12                 TNZ     s:12949

     1197    12939    4                  THEN DO;                 /* ACCT ACCESS CONTROLS               */

     1198    12940    4                     BYTE_IDX = BYTE_IDX+10;

  12940 12 000474   000012 236007                    LDQ     10,DL
        12 000475   200040 056100                    ASQ     BYTE_IDX,,AUTO

     1199    12941    4                     CALL INDEX(I,' ',TCODE$->CODE09.ACCT);

  12941 12 000476   200052 471500                    LDP1    TCODE$,,AUTO
        12 000477   000000 124500                    SCM     mask='000'O
        12 000500   100000 400010                    ADSC9   0,,PR1                   cn=2,n=8
        12 000501   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 000502   200034 000100                    ARG     I,,AUTO

     1200    12942    4                     NEW_BUF$->TEXT$C.LEN = I + 5;

  12942 12 000503   200034 236100                    LDQ     I,,AUTO
        12 000504   000005 036007                    ADLQ    5,DL
        12 000505   200062 756100                    STQ     @LEN+2,,AUTO
        12 000506   200051 473500                    LDP3    NEW_BUF$,,AUTO
        12 000507   000100 101500                    MRL     fill='000'O
        12 000510   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000511   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

     1201    12943    4                     CALL CONCAT(NEW_BUF$->TEXT$C.STRING,

  12943 12 000512   000100 101500                    MRL     fill='000'O
        12 000513   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 000514   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 000515   200062 220100                    LDX0    @LEN+2,,AUTO
        12 000516   040140 100400                    MLR     fill='040'O
        12 000517   000555 000002 11                 ADSC9   XTEND_STRINGS+111        cn=0,n=2
        12 000520   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:192  
        12 000521   000000 636010                    EAQ     0,X0
        12 000522   000022 772000                    QRL     18
        12 000523   000003 116007                    CMPQ    3,DL
        12 000524   000545 602000 12                 TNC     s:12947
        12 000525   777776 621010                    EAX1    -2,X0
        12 000526   200052 470500                    LDP0    TCODE$,,AUTO
        12 000527   200034 722100                    LXL2    I,,AUTO
        12 000530   040140 100540                    MLR     fill='040'O
        12 000531   000000 400012                    ADSC9   0,,PR0                   cn=2,n=*X2
        12 000532   300000 600011                    ADSC9   0,,PR3                   cn=3,n=*X1
        12 000533   000000 636010                    EAQ     0,X0
        12 000534   000022 772000                    QRL     18
        12 000535   200034 136100                    SBLQ    I,,AUTO
        12 000536   000002 116007                    CMPQ    2,DL
        12 000537   000545 604400 12                 TMOZ    s:12947
        12 000540   777776 621006                    EAX1    -2,QL
        12 000541   200034 236100                    LDQ     I,,AUTO
        12 000542   040146 100400                    MLR     fill='040'O
        12 000543   000556 000003 11                 ADSC9   XTEND_STRINGS+112        cn=0,n=3
        12 000544   300000 600011                    ADSC9   0,Q,PR3                  cn=3,n=*X1

     1202    12944    4                       '  ',
     1203    12945    4                       SUBSTR(TCODE$->CODE09.ACCT,0,I),
     1204    12946    4                       '<A>');
     1205    12947    4                     END;

  12947 12 000545   000633 710000 12                 TRA     s:12956

     1206    12948    4                  ELSE DO;                 /* VEHICLE ACCESS CONTROLS            */

     1207    12949    4                     BYTE_IDX = BYTE_IDX+TCODE$->CODE10.ACSVEH.C+3;

  12949 12 000546   200052 471500                    LDP1    TCODE$,,AUTO
        12 000547   000100 101500                    MRL     fill='000'O
        12 000550   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1
        12 000551   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000552   200062 236100                    LDQ     @LEN+2,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:193  
        12 000553   200040 036100                    ADLQ    BYTE_IDX,,AUTO
        12 000554   000003 036007                    ADLQ    3,DL
        12 000555   200040 756100                    STQ     BYTE_IDX,,AUTO

     1208    12950    4                     NEW_BUF$->TEXT$C.LEN = TCODE$->CODE10.ACSVEH.C + 5;

  12950 12 000556   000100 101500                    MRL     fill='000'O
        12 000557   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1
        12 000560   200063 000004                    ADSC9   @LEN+3,,AUTO             cn=0,n=4
        12 000561   200063 236100                    LDQ     @LEN+3,,AUTO
        12 000562   000005 036007                    ADLQ    5,DL
        12 000563   200062 756100                    STQ     @LEN+2,,AUTO
        12 000564   200051 473500                    LDP3    NEW_BUF$,,AUTO
        12 000565   000100 101500                    MRL     fill='000'O
        12 000566   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000567   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1

     1209    12951    4                     CALL CONCAT(NEW_BUF$->TEXT$C.STRING,

  12951 12 000570   000100 101500                    MRL     fill='000'O
        12 000571   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 000572   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 000573   200062 220100                    LDX0    @LEN+2,,AUTO
        12 000574   200052 470500                    LDP0    TCODE$,,AUTO
        12 000575   000100 101500                    MRL     fill='000'O
        12 000576   000000 400001                    ADSC9   0,,PR0                   cn=2,n=1
        12 000577   200063 000002                    ADSC9   @LEN+3,,AUTO             cn=0,n=2
        12 000600   200063 221100                    LDX1    @LEN+3,,AUTO
        12 000601   040140 100400                    MLR     fill='040'O
        12 000602   000555 000002 11                 ADSC9   XTEND_STRINGS+111        cn=0,n=2
        12 000603   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
        12 000604   000000 636010                    EAQ     0,X0
        12 000605   000022 772000                    QRL     18
        12 000606   000003 116007                    CMPQ    3,DL
        12 000607   000633 602000 12                 TNC     s:12956
        12 000610   777776 622010                    EAX2    -2,X0
        12 000611   200052 470500                    LDP0    TCODE$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:194  
        12 000612   040140 100540                    MLR     fill='040'O
        12 000613   000000 600011                    ADSC9   0,,PR0                   cn=3,n=*X1
        12 000614   300000 600012                    ADSC9   0,,PR3                   cn=3,n=*X2
        12 000615   000000 636011                    EAQ     0,X1
        12 000616   000022 772000                    QRL     18
        12 000617   200064 756100                    STQ     @LEN+4,,AUTO
        12 000620   000000 636010                    EAQ     0,X0
        12 000621   000022 772000                    QRL     18
        12 000622   200064 136100                    SBLQ    @LEN+4,,AUTO
        12 000623   000002 116007                    CMPQ    2,DL
        12 000624   000633 604400 12                 TMOZ    s:12956
        12 000625   777776 622006                    EAX2    -2,QL
        12 000626   000000 636011                    EAQ     0,X1
        12 000627   000022 772000                    QRL     18
        12 000630   040146 100400                    MLR     fill='040'O
        12 000631   000557 000003 11                 ADSC9   XTEND_STRINGS+113        cn=0,n=3
        12 000632   300000 600012                    ADSC9   0,Q,PR3                  cn=3,n=*X2

     1210    12952    4                       '  ',
     1211    12953    4                       TCODE$->CODE10.ACSVEH.T,
     1212    12954    4                       '<P>');
     1213    12955    4                     END;

     1214    12956    3                 EQ_IDX = NEW_BUF$->TEXT$C.LEN+1;

  12956 12 000633   000100 101500                    MRL     fill='000'O
        12 000634   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 000635   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000636   200062 236100                    LDQ     @LEN+2,,AUTO
        12 000637   000001 036007                    ADLQ    1,DL
        12 000640   200037 756100                    STQ     EQ_IDX,,AUTO

     1215    12957    4                 DO I=0 TO 17;             /* REPORT CONTROLS                    */

  12957 12 000641   200034 450100                    STZ     I,,AUTO

     1216    12958    4                    IF TCODE$->BIT$ARY(I)
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:195  

  12958 12 000642   200034 235100                    LDA     I,,AUTO
        12 000643   000645 605000 12                 TPL     s:12958+3
        12 000644   000044 035003                    ADLA    36,DU
        12 000645   200052 470500                    LDP0    TCODE$,,AUTO
        12 000646   000000 066505                    CMPB    filb='0'B
        12 000647   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
        12 000650   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        12 000651   000703 600000 12                 TZE     s:12965

     1217    12959    4                     THEN
     1218    12960    5                     DO;

     1219    12961    5                        PINCRC(NEW_BUF$,NEW_BUF$->TEXT$C.LEN+1)->CHAR$7 =

  12961 12 000652   200051 471500                    LDP1    NEW_BUF$,,AUTO
        12 000653   000100 101500                    MRL     fill='000'O
        12 000654   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000655   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000656   200062 236100                    LDQ     @LEN+2,,AUTO
        12 000657   200063 756100                    STQ     @LEN+3,,AUTO
        12 000660   200034 236100                    LDQ     I,,AUTO
        12 000661   000007 402007                    MPY     7,DL
        12 000662   200063 235100                    LDA     @LEN+3,,AUTO
        12 000663   040105 100406                    MLR     fill='040'O
        12 000664   000044 400007 11                 ADSC9   CNTL_NAME_TBL+4,Q        cn=2,n=7
        12 000665   100000 200007                    ADSC9   0,A,PR1                  cn=1,n=7

     1220    12962    5                          CNTL_NAME_TBL.TEXT(I);
     1221    12963    5                       NEW_BUF$->TEXT$C.LEN = NEW_BUF$->TEXT$C.LEN+CNTL_NAME_TBL.LEN(I
             12963                                 );

  12963 12 000666   200034 235100                    LDA     I,,AUTO
        12 000667   000100 101405                    MRL     fill='000'O
        12 000670   000040 000001 11                 ADSC9   CNTL_NAME_TBL,A          cn=0,n=1
        12 000671   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000672   000100 101500                    MRL     fill='000'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:196  
        12 000673   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000674   200063 000004                    ADSC9   @LEN+3,,AUTO             cn=0,n=4
        12 000675   200063 236100                    LDQ     @LEN+3,,AUTO
        12 000676   200062 036100                    ADLQ    @LEN+2,,AUTO
        12 000677   200064 756100                    STQ     @LEN+4,,AUTO
        12 000700   000100 101500                    MRL     fill='000'O
        12 000701   200064 000004                    ADSC9   @LEN+4,,AUTO             cn=0,n=4
        12 000702   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1222    12964    5                        END;

     1223    12965    4                    END;

  12965 12 000703   200034 054100                    AOS     I,,AUTO
        12 000704   200034 235100                    LDA     I,,AUTO
        12 000705   000021 115007                    CMPA    17,DL
        12 000706   000642 604400 12                 TMOZ    s:12958

     1224    12966    3                 IF EQ_IDX>NEW_BUF$->TEXT$C.LEN

  12966 12 000707   200051 470500                    LDP0    NEW_BUF$,,AUTO
        12 000710   000100 101500                    MRL     fill='000'O
        12 000711   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000712   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000713   200062 236100                    LDQ     @LEN+2,,AUTO
        12 000714   200037 116100                    CMPQ    EQ_IDX,,AUTO
        12 000715   000721 605000 12                 TPL     s:12971

     1225    12967    3                  THEN
     1226    12968    3                    NEW_BUF$->TEXT$C.LEN = EQ_IDX;

  12968 12 000716   000100 101500                    MRL     fill='000'O
        12 000717   200037 000004                    ADSC9   EQ_IDX,,AUTO             cn=0,n=4
        12 000720   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1227    12969                                                /* Insure that the '=' gets out       */
     1228    12970                                                /* even on cntls='0'B                 */
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:197  
     1229    12971    3                 PINCRC(NEW_BUF$,EQ_IDX)->CHAR$1 = '=';

  12971 12 000721   200037 236100                    LDQ     EQ_IDX,,AUTO
        12 000722   040106 100400                    MLR     fill='040'O
        12 000723   000021 000001 13                 ADSC9   17                       cn=0,n=1
        12 000724   000000 000001                    ADSC9   0,Q,PR0                  cn=0,n=1

     1230    12972    3                 IF OLD_BUF$->TEXT$C.LEN+NEW_BUF$->TEXT$C.LEN>=USABLE_LEN

  12972 12 000725   000100 101500                    MRL     fill='000'O
        12 000726   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000727   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000730   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 000731   000100 101500                    MRL     fill='000'O
        12 000732   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000733   200063 000004                    ADSC9   @LEN+3,,AUTO             cn=0,n=4
        12 000734   200063 236100                    LDQ     @LEN+3,,AUTO
        12 000735   200062 036100                    ADLQ    @LEN+2,,AUTO
        12 000736   000741 604000 12                 TMI     s:12975
        12 000737   000000 116000 xsym               CMPQ    USABLE_LEN
        12 000740   000746 604000 12                 TMI     s:12980

     1231    12973    3                  THEN
     1232    12974    4                  DO;                      /* MAKE TWO BUFFERS                   */

     1233    12975    4                     BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  12975 12 000741   000000 473400 xsym               LDP3    LIST_BUF$
        12 000742   300000 054100                    AOS     0,,PR3

     1234    12976    4                     OLD_BUF$ = NEW_BUF$;

  12976 12 000743   200051 236100                    LDQ     NEW_BUF$,,AUTO
        12 000744   200050 756100                    STQ     OLD_BUF$,,AUTO

     1235    12977    4                     END;

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:198  
  12977 12 000745   000766 710000 12                 TRA     s:12984

     1236    12978    3                  ELSE
     1237    12979    4                  DO;                      /* KEEP AS ONE BUFFER                 */

     1238    12980    4                     OLD_BUF$->TEXT$C.LEN = OLD_BUF$->TEXT$C.LEN+

  12980 12 000746   000100 101500                    MRL     fill='000'O
        12 000747   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 000750   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 000751   000100 101500                    MRL     fill='000'O
        12 000752   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 000753   200063 000004                    ADSC9   @LEN+3,,AUTO             cn=0,n=4
        12 000754   200063 236100                    LDQ     @LEN+3,,AUTO
        12 000755   200062 036100                    ADLQ    @LEN+2,,AUTO
        12 000756   000001 036007                    ADLQ    1,DL
        12 000757   200064 756100                    STQ     @LEN+4,,AUTO
        12 000760   000100 101500                    MRL     fill='000'O
        12 000761   200064 000004                    ADSC9   @LEN+4,,AUTO             cn=0,n=4
        12 000762   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1239    12981    4                       NEW_BUF$->TEXT$C.LEN+1;
     1240    12982    4                     NEW_BUF$->TEXT$C.LEN = ASCBIN(' ');

  12982 12 000763   000100 101400                    MRL     fill='000'O
        12 000764   000022 000004 13                 ADSC9   18                       cn=0,n=4
        12 000765   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1241    12983    4                     END;

     1242    12984    3                 END;

  12984 12 000766   200040 236100                    LDQ     BYTE_IDX,,AUTO
        12 000767   000003 036007                    ADLQ    3,DL
        12 000770   200041 116100                    CMPQ    NUM_BYTES,,AUTO
        12 000771   000775 605000 12                 TPL     s:12984+7
        12 000772   200031 235100                    LDA     CODE,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:199  
        12 000773   000012 115007                    CMPA    10,DL
        12 000774   000454 600000 12                 TZE     s:12936
        12 000775   200040 236100                    LDQ     BYTE_IDX,,AUTO
        12 000776   000011 036007                    ADLQ    9,DL
        12 000777   200041 116100                    CMPQ    NUM_BYTES,,AUTO
        12 001000   001004 605000 12                 TPL     LOOP_END
        12 001001   200031 235100                    LDA     CODE,,AUTO
        12 001002   000011 115007                    CMPA    9,DL
        12 001003   000454 600000 12                 TZE     s:12936

     1243    12985    2   LOOP_END:  END;

  12985 12 001004   200031 054100       LOOP_END     AOS     CODE,,AUTO
        12 001005   200031 235100                    LDA     CODE,,AUTO
        12 001006   000012 115007                    CMPA    10,DL
        12 001007   000430 604400 12                 TMOZ    s:12929

     1244    12986                                                /* CODE03: FILE INCONS and NBUF bits  */
     1245    12987    1           CODE$ = FPARAM$;

  12987 12 001010   000000 236000 xsym               LDQ     FPARAM$
        12 001011   200032 756100                    STQ     CODE$,,AUTO

     1246    12988    1           CALL XSF$LOCCODP(CODE$,3) ALTRET(EA_TIME);

  12988 12 001012   000003 236000 13                 LDQ     3
        12 001013   200063 756100                    STQ     @LEN+3,,AUTO
        12 001014   200032 630500                    EPPR0   CODE$,,AUTO
        12 001015   200062 450500                    STP0    @LEN+2,,AUTO
        12 001016   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 001017   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001020   000000 701000 xent               TSX1    XSF$LOCCODP
        12 001021   001110 702000 12                 TSX2    EA_TIME

     1247    12989    1           IF CODE$->CODE03.DESC.BAD

  12989 12 001022   200032 470500                    LDP0    CODE$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:200  
        12 001023   000001 236100                    LDQ     1,,PR0
        12 001024   020000 316003                    CANQ    8192,DU
        12 001025   001055 600000 12                 TZE     s:12997

     1248    12990    1            THEN
     1249    12991    2            DO;

     1250    12992    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  12992 12 001026   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001027   000100 101500                    MRL     fill='000'O
        12 001030   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 001031   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 001032   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001033   000020 736000                    QLS     16
        12 001034   200000 036007                    ADLQ    65536,DL
        12 001035   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 001036   200050 756100                    STQ     OLD_BUF$,,AUTO

     1251    12993    2               OLD_BUF$->TEXT$C.LEN = SIZEC(INCONSIST_BUF);

  12993 12 001037   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001040   000100 101400                    MRL     fill='000'O
        12 001041   000023 000004 13                 ADSC9   19                       cn=0,n=4
        12 001042   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1252    12994    2               OLD_BUF$->TEXT$C.STRING = INCONSIST_BUF;

  12994 12 001043   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001044   000100 101500                    MRL     fill='000'O
        12 001045   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001046   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 001047   200062 220100                    LDX0    @LEN+2,,AUTO
        12 001050   040140 100400                    MLR     fill='040'O
        12 001051   000000 000046 11                 ADSC9   INCONSIST_BUF            cn=0,n=38
        12 001052   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:201  
     1253    12995    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  12995 12 001053   000000 470400 xsym               LDP0    LIST_BUF$
        12 001054   000000 054100                    AOS     0,,PR0

     1254    12996    2               END;

     1255    12997    1           IF CODE$->CODE03.DESC.NBUF

  12997 12 001055   200032 470500                    LDP0    CODE$,,AUTO
        12 001056   000001 236100                    LDQ     1,,PR0
        12 001057   000200 316003                    CANQ    128,DU
        12 001060   001110 600000 12                 TZE     EA_TIME

     1256    12998    1            THEN
     1257    12999    2            DO;

     1258    13000    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13000 12 001061   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001062   000100 101500                    MRL     fill='000'O
        12 001063   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 001064   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 001065   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001066   000020 736000                    QLS     16
        12 001067   200000 036007                    ADLQ    65536,DL
        12 001070   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 001071   200050 756100                    STQ     OLD_BUF$,,AUTO

     1259    13001    2               OLD_BUF$->TEXT$C.LEN = SIZEC(TIMEWARP_BUF);

  13001 12 001072   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001073   000100 101400                    MRL     fill='000'O
        12 001074   000024 000004 13                 ADSC9   20                       cn=0,n=4
        12 001075   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1260    13002    2               OLD_BUF$->TEXT$C.STRING = TIMEWARP_BUF;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:202  

  13002 12 001076   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001077   000100 101500                    MRL     fill='000'O
        12 001100   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001101   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 001102   200062 220100                    LDX0    @LEN+2,,AUTO
        12 001103   040140 100400                    MLR     fill='040'O
        12 001104   000012 000056 11                 ADSC9   TIMEWARP_BUF             cn=0,n=46
        12 001105   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1261    13003    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13003 12 001106   000000 470400 xsym               LDP0    LIST_BUF$
        12 001107   000000 054100                    AOS     0,,PR0

     1262    13004    2               END;

  13003 12 001110                       EA_TIME      null
     1263    13005        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:203  
     1264    13006    1   EA_TIME: ;
     1265    13007    1           IF LIST_CODE < 4

  13007 12 001110   200003 470500                    LDP0    @LIST_CODE,,AUTO
        12 001111   000000 235100                    LDA     0,,PR0
        12 001112   000004 115007                    CMPA    4,DL
        12 001113   001115 605000 12                 TPL     s:13015

     1266    13008    1            THEN
     1267    13009    1              RETURN;

  13009 12 001114   000000 702200 xent               TSX2  ! X66_ARET

     1268    13010        /******************************************************************************/
     1269    13011        /*                                                                            */
     1270    13012        /* The remaining code is for L(EA) or better.                                 */
     1271    13013        /*                                                                            */
     1272    13014        /******************************************************************************/
     1273    13015    1           IF ICB.DEV_MASK.MAN_TAPE        /* LT                                 */

  13015 12 001115   000171 236000 xsym               LDQ     ICB+121
        12 001116   100000 316003                    CANQ    32768,DU
        12 001117   001214 600000 12                 TZE     s:13043

     1274    13016    1            THEN                           /* L(EA) for LT                       */
     1275    13017    2            DO;

     1276    13018        /*****************************************************************
     1277    13019        /++++++++++++++++++++
     1278    13020        /++++++++++++++++++++  EXPIRATION DATE WILL GO HERE
     1279    13021        /++++++++++++++++++++
     1280    13022         ****************************************************************/
     1281    13023    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13023 12 001120   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001121   000100 101500                    MRL     fill='000'O
        12 001122   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:204  
        12 001123   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 001124   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001125   000020 736000                    QLS     16
        12 001126   200000 036007                    ADLQ    65536,DL
        12 001127   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 001130   200050 756100                    STQ     OLD_BUF$,,AUTO

     1282    13024    2               OLD_BUF$->TEXT$C.LEN = 29;

  13024 12 001131   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001132   000100 101400                    MRL     fill='000'O
        12 001133   000025 000004 13                 ADSC9   21                       cn=0,n=4
        12 001134   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1283    13025    3               DO CASE(M$EI$->F$DCB.DENSITY);

  13025 12 001135   000000 471400 xsym               LDP1    M$EI$
        12 001136   100043 720100                    LXL0    35,,PR1
        12 001137   000777 360003                    ANX0    511,DU
        12 001140   000006 100003                    CMPX0   6,DU
        12 001141   001143 602010 12                 TNC     s:13025+6,X0
        12 001142   001170 710000 12                 TRA     s:13035
        12 001143   001170 710000 12                 TRA     s:13035
        12 001144   001170 710000 12                 TRA     s:13035
        12 001145   001151 710000 12                 TRA     s:13027
        12 001146   001155 710000 12                 TRA     s:13029
        12 001147   001161 710000 12                 TRA     s:13031
        12 001150   001165 710000 12                 TRA     s:13033

     1284    13026    3                CASE(%D800#);

     1285    13027    3                  DENS_STR = '800';

  13027 12 001151   040100 100400                    MLR     fill='040'O
        12 001152   000560 000003 11                 ADSC9   XTEND_STRINGS+114        cn=0,n=3
        12 001153   200053 000005                    ADSC9   DENS_STR,,AUTO           cn=0,n=5
        12 001154   001170 710000 12                 TRA     s:13035
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:205  

     1286    13028    3                CASE(%D1600#);

     1287    13029    3                  DENS_STR = '1600';

  13029 12 001155   040100 100400                    MLR     fill='040'O
        12 001156   000561 000004 11                 ADSC9   XTEND_STRINGS+115        cn=0,n=4
        12 001157   200053 000005                    ADSC9   DENS_STR,,AUTO           cn=0,n=5
        12 001160   001170 710000 12                 TRA     s:13035

     1288    13030    3                CASE(%D6250#);

     1289    13031    3                  DENS_STR = '6250';

  13031 12 001161   040100 100400                    MLR     fill='040'O
        12 001162   000562 000004 11                 ADSC9   XTEND_STRINGS+116        cn=0,n=4
        12 001163   200053 000005                    ADSC9   DENS_STR,,AUTO           cn=0,n=5
        12 001164   001170 710000 12                 TRA     s:13035

     1290    13032    3                CASE(%D38000#);

     1291    13033    3                  DENS_STR = '38000';

  13033 12 001165   040100 100400                    MLR     fill='040'O
        12 001166   000563 000005 11                 ADSC9   XTEND_STRINGS+117        cn=0,n=5
        12 001167   200053 000005                    ADSC9   DENS_STR,,AUTO           cn=0,n=5

     1292    13034    3                END;                       /* END CASE                           */

     1293    13035    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,

  13035 12 001170   200050 473500                    LDP3    OLD_BUF$,,AUTO
        12 001171   000100 101500                    MRL     fill='000'O
        12 001172   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        12 001173   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 001174   200062 220100                    LDX0    @LEN+2,,AUTO
        12 001175   040140 100400                    MLR     fill='040'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:206  
        12 001176   000565 000030 11                 ADSC9   XTEND_STRINGS+119        cn=0,n=24
        12 001177   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
        12 001200   000000 636010                    EAQ     0,X0
        12 001201   000022 772000                    QRL     18
        12 001202   000031 116007                    CMPQ    25,DL
        12 001203   001211 602000 12                 TNC     s:13038
        12 001204   777750 621010                    EAX1    -24,X0
        12 001205   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001206   040140 100500                    MLR     fill='040'O
        12 001207   200053 000005                    ADSC9   DENS_STR,,AUTO           cn=0,n=5
        12 001210   100006 200011                    ADSC9   6,,PR1                   cn=1,n=*X1

     1294    13036    2                 '    Recording density = ',
     1295    13037    2                 DENS_STR);
     1296    13038    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13038 12 001211   000000 471400 xsym               LDP1    LIST_BUF$
        12 001212   100000 054100                    AOS     0,,PR1

     1297    13039    2               END;

  13039 12 001213   002466 710000 12                 TRA     s:13219

     1298    13040    1            ELSE                           /* L(EA) non-LT                       */
     1299    13041    2            DO;

     1300    13042                                                /* CODE04:  ACCESS time               */
     1301    13043    2               CODE$ = FPARAM$;

  13043 12 001214   000000 236000 xsym               LDQ     FPARAM$
        12 001215   200032 756100                    STQ     CODE$,,AUTO

     1302    13044    2               CALL XSF$LOCCODP(CODE$,4) ALTRET(NO_CODE_4_AGAIN);

  13044 12 001216   000010 236000 13                 LDQ     8
        12 001217   200063 756100                    STQ     @LEN+3,,AUTO
        12 001220   200032 631500                    EPPR1   CODE$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:207  
        12 001221   200062 451500                    STP1    @LEN+2,,AUTO
        12 001222   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 001223   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001224   000000 701000 xent               TSX1    XSF$LOCCODP
        12 001225   001605 702000 12                 TSX2    NEVER_EXPIRE

     1303    13045    2               IF TEST_MODE=1

  13045 12 001226   000000 235000 xsym               LDA     TEST_MODE
        12 001227   000001 115007                    CMPA    1,DL
        12 001230   001234 601000 12                 TNZ     s:13049

     1304    13046    2                THEN
     1305    13047    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);

  13047 12 001231   000012 237000 13                 LDAQ    10
        12 001232   000012 757000 10                 STAQ    FPT_TIME+8
        12 001233   001237 710000 12                 TRA     s:13050

     1306    13048    2                ELSE
     1307    13049    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE04.ACCESS.TIME);

  13049 12 001234   777640 235007                    LDA     -96,DL
        12 001235   200032 236100                    LDQ     CODE$,,AUTO
        12 001236   000012 757000 10                 STAQ    FPT_TIME+8

     1308    13050    2               CALL M$TIME(FPT_TIME) ALTRET(NO_CODE_4_AGAIN);

  13050 12 001237   000002 630400 10                 EPPR0   FPT_TIME
        12 001240   420004 713400                    CLIMB   alt,+8196
        12 001241   402000 401760                    pmme    nvectors=5
        12 001242   001605 702000 12                 TSX2    NEVER_EXPIRE

     1309    13051    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13051 12 001243   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001244   000100 101500                    MRL     fill='000'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:208  
        12 001245   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001246   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 001247   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001250   000020 736000                    QLS     16
        12 001251   200000 036007                    ADLQ    65536,DL
        12 001252   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 001253   200050 756100                    STQ     OLD_BUF$,,AUTO

     1310    13052    2               OLD_BUF$->TEXT$C.LEN = 33;

  13052 12 001254   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001255   000100 101400                    MRL     fill='000'O
        12 001256   000026 000004 13                 ADSC9   22                       cn=0,n=4
        12 001257   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1311    13053    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,

  13053 12 001260   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001261   000100 101500                    MRL     fill='000'O
        12 001262   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001263   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 001264   200062 220100                    LDX0    @LEN+2,,AUTO
        12 001265   040140 100400                    MLR     fill='040'O
        12 001266   000573 000021 11                 ADSC9   XTEND_STRINGS+125        cn=0,n=17
        12 001267   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 001270   000000 636010                    EAQ     0,X0
        12 001271   000022 772000                    QRL     18
        12 001272   000022 116007                    CMPQ    18,DL
        12 001273   001323 602000 12                 TNC     s:13058
        12 001274   777757 621010                    EAX1    -17,X0
        12 001275   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001276   040140 100400                    MLR     fill='040'O
        12 001277   000024 000005 10                 ADSC9   TIME_BUF                 cn=0,n=5
        12 001300   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1
        12 001301   000000 636010                    EAQ     0,X0
        12 001302   000022 772000                    QRL     18
        12 001303   000027 116007                    CMPQ    23,DL
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:209  
        12 001304   001323 602000 12                 TNC     s:13058
        12 001305   777752 621010                    EAX1    -22,X0
        12 001306   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001307   040140 100400                    MLR     fill='040'O
        12 001310   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 001311   000005 600011                    ADSC9   5,,PR0                   cn=3,n=*X1
        12 001312   000000 636010                    EAQ     0,X0
        12 001313   000022 772000                    QRL     18
        12 001314   000030 116007                    CMPQ    24,DL
        12 001315   001323 602000 12                 TNC     s:13058
        12 001316   777751 621010                    EAX1    -23,X0
        12 001317   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001320   040140 100400                    MLR     fill='040'O
        12 001321   000021 000012 10                 ADSC9   DATE_BUF                 cn=0,n=10
        12 001322   000006 000011                    ADSC9   6,,PR0                   cn=0,n=*X1

     1312    13054    2                 '    Last access  ',
     1313    13055    2                 TIME_BUF.HH_MM,
     1314    13056    2                 ' ',
     1315    13057    2                 DATE_BUF);
     1316    13058    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13058 12 001323   000000 470400 xsym               LDP0    LIST_BUF$
        12 001324   000000 054100                    AOS     0,,PR0

     1317    13059                                                /* CODE03: EXPIRE interval            */
     1318    13060    2               CREATE_TIME = CODE$ -> CODE04.CREATION.TIME;

  13060 12 001325   200032 470500                    LDP0    CODE$,,AUTO
        12 001326   000002 235100                    LDA     2,,PR0
        12 001327   200043 755100                    STA     CREATE_TIME,,AUTO

     1319    13061    2               CODE$ = FPARAM$;

  13061 12 001330   000000 236000 xsym               LDQ     FPARAM$
        12 001331   200032 756100                    STQ     CODE$,,AUTO

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:210  
     1320    13062    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NEVER_EXPIRE);

  13062 12 001332   000003 236000 13                 LDQ     3
        12 001333   200063 756100                    STQ     @LEN+3,,AUTO
        12 001334   200032 630500                    EPPR0   CODE$,,AUTO
        12 001335   200062 450500                    STP0    @LEN+2,,AUTO
        12 001336   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 001337   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001340   000000 701000 xent               TSX1    XSF$LOCCODP
        12 001341   001605 702000 12                 TSX2    NEVER_EXPIRE

     1321    13063    2               IF CODE$->CODE03.EXPIRE = -1

  13063 12 001342   200032 470500                    LDP0    CODE$,,AUTO
        12 001343   000007 220100                    LDX0    7,,PR0
        12 001344   777777 100003                    CMPX0   -1,DU
        12 001345   001605 600000 12                 TZE     NEVER_EXPIRE

     1322    13064    2                THEN                       /* EXPIRE IS NEVER                    */
     1323    13065    2                  GOTO NEVER_EXPIRE;
     1324    13066                                 /*  Compute days between creation and UTS rollover.  */
     1325    13067    2              CALL XUD$UTS_ADJ_25TH (UTS_TMP,0,(CODE$->CODE03.EXPIRE * %UTS_25TH_DAY#)
             13067                        )

  13067 12 001346   000007 236100                    LDQ     7,,PR0
        12 001347   000022 732000                    QRS     18
        12 001350   000027 402000 13                 MPY     23
        12 001351   200062 756100                    STQ     @LEN+2,,AUTO
        12 001352   200062 631500                    EPPR1   @LEN+2,,AUTO
        12 001353   200065 451500                    STP1    @LEN+5,,AUTO
        12 001354   000004 236000 13                 LDQ     4
        12 001355   200064 756100                    STQ     @LEN+4,,AUTO
        12 001356   200044 633500                    EPPR3   UTS_TMP,,AUTO
        12 001357   200063 453500                    STP3    @LEN+3,,AUTO
        12 001360   200063 630500                    EPPR0   @LEN+3,,AUTO
        12 001361   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001362   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:211  
        12 001363   001503 702000 12                 TSX2    s:13086

     1326    13068    3                WHENRETURN DO;

     1327    13069    3                   CALL XUD$UTS_ADJ_25TH (EXP_TIME,CREATE_TIME,(CODE$->CODE03.EXPIRE *
             13069                            %UTS_25TH_DAY#));

  13069 12 001364   200032 470500                    LDP0    CODE$,,AUTO
        12 001365   000007 236100                    LDQ     7,,PR0
        12 001366   000022 732000                    QRS     18
        12 001367   000027 402000 13                 MPY     23
        12 001370   200062 756100                    STQ     @LEN+2,,AUTO
        12 001371   200062 631500                    EPPR1   @LEN+2,,AUTO
        12 001372   200065 451500                    STP1    @LEN+5,,AUTO
        12 001373   200043 633500                    EPPR3   CREATE_TIME,,AUTO
        12 001374   200064 453500                    STP3    @LEN+4,,AUTO
        12 001375   200042 634500                    EPPR4   EXP_TIME,,AUTO
        12 001376   200063 454500                    STP4    @LEN+3,,AUTO
        12 001377   200063 630500                    EPPR0   @LEN+3,,AUTO
        12 001400   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 001401   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
        12 001402   000000 011000                    NOP     0

     1328    13070
     1329    13071    3                   IF TEST_MODE=1

  13071 12 001403   000000 235000 xsym               LDA     TEST_MODE
        12 001404   000001 115007                    CMPA    1,DL
        12 001405   001407 601000 12                 TNZ     s:13074

     1330    13072    3                    THEN
     1331    13073    3                      EXP_TIME = 0;

  13073 12 001406   200042 450100                    STZ     EXP_TIME,,AUTO

     1332    13074    3                   FPT_TIME.TSTAMP_ = VECTOR(EXP_TIME);

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:212  
  13074 12 001407   777640 235007                    LDA     -96,DL
        12 001410   200062 452500                    STP2    @LEN+2,,AUTO
        12 001411   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001412   000042 036003                    ADLQ    34,DU
        12 001413   000012 757000 10                 STAQ    FPT_TIME+8

     1333    13075    3                   CALL M$TIME(FPT_TIME) ALTRET (NEVER_EXPIRE);

  13075 12 001414   000002 630400 10                 EPPR0   FPT_TIME
        12 001415   420004 713400                    CLIMB   alt,+8196
        12 001416   402000 401760                    pmme    nvectors=5
        12 001417   001605 702000 12                 TSX2    NEVER_EXPIRE

     1334    13076    3                   OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13076 12 001420   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001421   000100 101500                    MRL     fill='000'O
        12 001422   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001423   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 001424   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001425   000020 736000                    QLS     16
        12 001426   200000 036007                    ADLQ    65536,DL
        12 001427   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 001430   200050 756100                    STQ     OLD_BUF$,,AUTO

     1335    13077    3                   OLD_BUF$->TEXT$C.LEN = 33;

  13077 12 001431   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001432   000100 101400                    MRL     fill='000'O
        12 001433   000026 000004 13                 ADSC9   22                       cn=0,n=4
        12 001434   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1336    13078    3                   CALL CONCAT(OLD_BUF$->TEXT$C.STRING,

  13078 12 001435   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001436   000100 101500                    MRL     fill='000'O
        12 001437   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:213  
        12 001440   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 001441   200062 220100                    LDX0    @LEN+2,,AUTO
        12 001442   040140 100400                    MLR     fill='040'O
        12 001443   000600 000021 11                 ADSC9   XTEND_STRINGS+130        cn=0,n=17
        12 001444   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 001445   000000 636010                    EAQ     0,X0
        12 001446   000022 772000                    QRL     18
        12 001447   000022 116007                    CMPQ    18,DL
        12 001450   001500 602000 12                 TNC     s:13083
        12 001451   777757 621010                    EAX1    -17,X0
        12 001452   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001453   040140 100400                    MLR     fill='040'O
        12 001454   000024 000005 10                 ADSC9   TIME_BUF                 cn=0,n=5
        12 001455   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1
        12 001456   000000 636010                    EAQ     0,X0
        12 001457   000022 772000                    QRL     18
        12 001460   000027 116007                    CMPQ    23,DL
        12 001461   001500 602000 12                 TNC     s:13083
        12 001462   777752 621010                    EAX1    -22,X0
        12 001463   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001464   040140 100400                    MLR     fill='040'O
        12 001465   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 001466   000005 600011                    ADSC9   5,,PR0                   cn=3,n=*X1
        12 001467   000000 636010                    EAQ     0,X0
        12 001470   000022 772000                    QRL     18
        12 001471   000030 116007                    CMPQ    24,DL
        12 001472   001500 602000 12                 TNC     s:13083
        12 001473   777751 621010                    EAX1    -23,X0
        12 001474   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001475   040140 100400                    MLR     fill='040'O
        12 001476   000021 000012 10                 ADSC9   DATE_BUF                 cn=0,n=10
        12 001477   000006 000011                    ADSC9   6,,PR0                   cn=0,n=*X1

     1337    13079    3                     '    Will expire  ',
     1338    13080    3                     TIME_BUF.HH_MM,
     1339    13081    3                     ' ',
     1340    13082    3                     DATE_BUF);
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:214  
     1341    13083    3                   BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13083 12 001500   000000 470400 xsym               LDP0    LIST_BUF$
        12 001501   000000 054100                    AOS     0,,PR0

     1342    13084    3                   END;

  13084 12 001502   001605 710000 12                 TRA     NEVER_EXPIRE

     1343    13085    3                WHENALTRETURN DO;

     1344    13086    3                   IF TEST_MODE = 1

  13086 12 001503   000000 235000 xsym               LDA     TEST_MODE
        12 001504   000001 115007                    CMPA    1,DL
        12 001505   001515 601000 12                 TNZ     s:13090

     1345    13087    3                    THEN
     1346    13088    3                      CALL BINCHAR(CONV_BUF,0);

  13088 12 001506   000000 236003                    LDQ     0,DU
        12 001507   000000 235003                    LDA     0,DU
        12 001510   200062 757100                    STAQ    @LEN+2,,AUTO
        12 001511   000100 301500                    BTD
        12 001512   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 001513   200046 030006                    NDSC9   CONV_BUF,,AUTO           cn=0,s=nosgn,sf=0,n=6
        12 001514   001521 710000 12                 TRA     s:13091

     1347    13089    3                    ELSE
     1348    13090    3                      CALL BINCHAR(CONV_BUF,CODE$ -> CODE03.EXPIRE);

  13090 12 001515   200032 470500                    LDP0    CODE$,,AUTO
        12 001516   000100 301500                    BTD
        12 001517   000007 000002                    NDSC9   7,,PR0                   cn=0,s=lsgnf,sf=0,n=2
        12 001520   200046 030006                    NDSC9   CONV_BUF,,AUTO           cn=0,s=nosgn,sf=0,n=6

     1349    13091    3                   CALL VPD$CLOBBERLZ(VECTOR(CONV_BUF));
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:215  

  13091 12 001521   000014 235000 13                 LDA     12
        12 001522   200062 452500                    STP2    @LEN+2,,AUTO
        12 001523   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001524   000046 036003                    ADLQ    38,DU
        12 001525   200064 757100                    STAQ    @LEN+4,,AUTO
        12 001526   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 001527   200066 450500                    STP0    @LEN+6,,AUTO
        12 001530   200066 630500                    EPPR0   @LEN+6,,AUTO
        12 001531   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 001532   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 001533   000000 011000                    NOP     0

     1350    13092    3                   OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$ -> TEXT$C.LEN +1);

  13092 12 001534   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001535   000100 101500                    MRL     fill='000'O
        12 001536   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001537   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 001540   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001541   000020 736000                    QLS     16
        12 001542   200000 036007                    ADLQ    65536,DL
        12 001543   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 001544   200050 756100                    STQ     OLD_BUF$,,AUTO

     1351    13093    3                   OLD_BUF$ -> TEXT$C.LEN = 42;

  13093 12 001545   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001546   000100 101400                    MRL     fill='000'O
        12 001547   000030 000004 13                 ADSC9   24                       cn=0,n=4
        12 001550   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1352    13094    3                   CALL CONCAT(OLD_BUF$ -> TEXT$C.STRING,

  13094 12 001551   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001552   000100 101500                    MRL     fill='000'O
        12 001553   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:216  
        12 001554   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 001555   200062 220100                    LDX0    @LEN+2,,AUTO
        12 001556   040140 100400                    MLR     fill='040'O
        12 001557   000600 000021 11                 ADSC9   XTEND_STRINGS+130        cn=0,n=17
        12 001560   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 001561   000000 636010                    EAQ     0,X0
        12 001562   000022 772000                    QRL     18
        12 001563   000022 116007                    CMPQ    18,DL
        12 001564   001603 602000 12                 TNC     s:13098
        12 001565   777757 621010                    EAX1    -17,X0
        12 001566   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001567   040140 100500                    MLR     fill='040'O
        12 001570   200046 000006                    ADSC9   CONV_BUF,,AUTO           cn=0,n=6
        12 001571   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1
        12 001572   000000 636010                    EAQ     0,X0
        12 001573   000022 772000                    QRL     18
        12 001574   000030 116007                    CMPQ    24,DL
        12 001575   001603 602000 12                 TNC     s:13098
        12 001576   777751 621010                    EAX1    -23,X0
        12 001577   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001600   040140 100400                    MLR     fill='040'O
        12 001601   000605 000023 11                 ADSC9   XTEND_STRINGS+135        cn=0,n=19
        12 001602   000006 000011                    ADSC9   6,,PR0                   cn=0,n=*X1

     1353    13095    3                     '    Will expire  ',
     1354    13096    3                     CONV_BUF,
     1355    13097    3                     ' days from creation');
     1356    13098    3                   BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13098 12 001603   000000 470400 xsym               LDP0    LIST_BUF$
        12 001604   000000 054100                    AOS     0,,PR0

     1357    13099    3                   END;

  13095 12 001605                       NEVER_EXPIRE null
     1358    13100    2   NEVER_EXPIRE: ;
     1359    13101    2   NO_CODE_4_AGAIN:
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:217  
     1360    13102                                                /* CODE03: TAPE/DISC backup bit       */
     1361    13103    2               CODE$ = FPARAM$;

  13103 12 001605   000000 236000 xsym  NO_CODE_4_A* LDQ     FPARAM$
        12 001606   200032 756100                    STQ     CODE$,,AUTO

     1362    13104    2               ON_BUF_RDF.DP_LT = ' ';

  13104 12 001607   040040 220003                    LDX0    16416,DU
        12 001610   000017 440000 10                 SXL0    ON_BUF+1

     1363    13105    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_DP_LT);

  13105 12 001611   000003 236000 13                 LDQ     3
        12 001612   200063 756100                    STQ     @LEN+3,,AUTO
        12 001613   200032 630500                    EPPR0   CODE$,,AUTO
        12 001614   200062 450500                    STP0    @LEN+2,,AUTO
        12 001615   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 001616   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001617   000000 701000 xent               TSX1    XSF$LOCCODP
        12 001620   001632 702000 12                 TSX2    NO_DP_LT

     1364    13106    2               IF CODE$->CODE03.DESC.TPB

  13106 12 001621   200032 470500                    LDP0    CODE$,,AUTO
        12 001622   000001 236100                    LDQ     1,,PR0
        12 001623   000040 316003                    CANQ    32,DU
        12 001624   001630 600000 12                 TZE     s:13110

     1365    13107    2                THEN
     1366    13108    2                  ON_BUF_RDF.DP_LT = 'LT';

  13108 12 001625   000612 220000 11                 LDX0    XTEND_STRINGS+140
        12 001626   000017 440000 10                 SXL0    ON_BUF+1
        12 001627   001632 710000 12                 TRA     NO_DP_LT

     1367    13109    2                ELSE
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:218  
     1368    13110    2                  ON_BUF_RDF.DP_LT = 'DP';

  13110 12 001630   000613 220000 11                 LDX0    XTEND_STRINGS+141
        12 001631   000017 440000 10                 SXL0    ON_BUF+1

     1369    13111    2   NO_DP_LT:
     1370    13112                                                /* CODE05: BACKUP time and reel no.   */
     1371    13113    2               CODE$ = FPARAM$;

  13113 12 001632   000000 236000 xsym  NO_DP_LT     LDQ     FPARAM$
        12 001633   200032 756100                    STQ     CODE$,,AUTO

     1372    13114    2               CALL XSF$LOCCODP(CODE$,5) ALTRET(NO_CODE_5);

  13114 12 001634   000031 236000 13                 LDQ     25
        12 001635   200063 756100                    STQ     @LEN+3,,AUTO
        12 001636   200032 630500                    EPPR0   CODE$,,AUTO
        12 001637   200062 450500                    STP0    @LEN+2,,AUTO
        12 001640   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 001641   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 001642   000000 701000 xent               TSX1    XSF$LOCCODP
        12 001643   001771 702000 12                 TSX2    NO_CODE_5

     1373    13115    2               IF CODE$->CODE05.BACKUP.TIME=0

  13115 12 001644   200032 470500                    LDP0    CODE$,,AUTO
        12 001645   000000 235100                    LDA     0,,PR0
        12 001646   001771 600000 12                 TZE     NO_CODE_5

     1374    13116    2                THEN
     1375    13117    2                  GOTO NO_CODE_5;
     1376    13118    2               IF TEST_MODE=1

  13118 12 001647   000000 236000 xsym               LDQ     TEST_MODE
        12 001650   000001 116007                    CMPQ    1,DL
        12 001651   001655 601000 12                 TNZ     s:13122

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:219  
     1377    13119    2                THEN
     1378    13120    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);

  13120 12 001652   000012 237000 13                 LDAQ    10
        12 001653   000012 757000 10                 STAQ    FPT_TIME+8
        12 001654   001660 710000 12                 TRA     s:13123

     1379    13121    2                ELSE
     1380    13122    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE05.BACKUP.TIME);

  13122 12 001655   777640 235007                    LDA     -96,DL
        12 001656   200032 236100                    LDQ     CODE$,,AUTO
        12 001657   000012 757000 10                 STAQ    FPT_TIME+8

     1381    13123    2               CALL M$TIME(FPT_TIME) ALTRET(NO_CODE_5);

  13123 12 001660   000002 630400 10                 EPPR0   FPT_TIME
        12 001661   420004 713400                    CLIMB   alt,+8196
        12 001662   402000 401760                    pmme    nvectors=5
        12 001663   001771 702000 12                 TSX2    NO_CODE_5

     1382    13124    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13124 12 001664   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001665   000100 101500                    MRL     fill='000'O
        12 001666   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001667   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 001670   200062 236100                    LDQ     @LEN+2,,AUTO
        12 001671   000020 736000                    QLS     16
        12 001672   200000 036007                    ADLQ    65536,DL
        12 001673   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 001674   200050 756100                    STQ     OLD_BUF$,,AUTO

     1383    13125    2               OLD_BUF$->TEXT$C.LEN = 48;

  13125 12 001675   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001676   000100 101400                    MRL     fill='000'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:220  
        12 001677   000032 000004 13                 ADSC9   26                       cn=0,n=4
        12 001700   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1384    13126    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,

  13126 12 001701   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001702   000100 101500                    MRL     fill='000'O
        12 001703   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 001704   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 001705   200062 220100                    LDX0    @LEN+2,,AUTO
        12 001706   040140 100400                    MLR     fill='040'O
        12 001707   000614 000021 11                 ADSC9   XTEND_STRINGS+142        cn=0,n=17
        12 001710   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 001711   000000 636010                    EAQ     0,X0
        12 001712   000022 772000                    QRL     18
        12 001713   000022 116007                    CMPQ    18,DL
        12 001714   001767 602000 12                 TNC     s:13133
        12 001715   777757 621010                    EAX1    -17,X0
        12 001716   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001717   040140 100400                    MLR     fill='040'O
        12 001720   000024 000005 10                 ADSC9   TIME_BUF                 cn=0,n=5
        12 001721   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1
        12 001722   000000 636010                    EAQ     0,X0
        12 001723   000022 772000                    QRL     18
        12 001724   000027 116007                    CMPQ    23,DL
        12 001725   001767 602000 12                 TNC     s:13133
        12 001726   777752 621010                    EAX1    -22,X0
        12 001727   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001730   040140 100400                    MLR     fill='040'O
        12 001731   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 001732   000005 600011                    ADSC9   5,,PR0                   cn=3,n=*X1
        12 001733   000000 636010                    EAQ     0,X0
        12 001734   000022 772000                    QRL     18
        12 001735   000030 116007                    CMPQ    24,DL
        12 001736   001767 602000 12                 TNC     s:13133
        12 001737   777751 621010                    EAX1    -23,X0
        12 001740   200050 470500                    LDP0    OLD_BUF$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:221  
        12 001741   040140 100400                    MLR     fill='040'O
        12 001742   000021 000012 10                 ADSC9   DATE_BUF                 cn=0,n=10
        12 001743   000006 000011                    ADSC9   6,,PR0                   cn=0,n=*X1
        12 001744   000000 636010                    EAQ     0,X0
        12 001745   000022 772000                    QRL     18
        12 001746   000042 116007                    CMPQ    34,DL
        12 001747   001767 602000 12                 TNC     s:13133
        12 001750   777737 621010                    EAX1    -33,X0
        12 001751   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 001752   040140 100400                    MLR     fill='040'O
        12 001753   000016 000011 10                 ADSC9   ON_BUF                   cn=0,n=9
        12 001754   000010 400011                    ADSC9   8,,PR0                   cn=2,n=*X1
        12 001755   000000 636010                    EAQ     0,X0
        12 001756   000022 772000                    QRL     18
        12 001757   000053 116007                    CMPQ    43,DL
        12 001760   001767 602000 12                 TNC     s:13133
        12 001761   777726 621010                    EAX1    -42,X0
        12 001762   200032 470500                    LDP0    CODE$,,AUTO
        12 001763   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 001764   040140 100500                    MLR     fill='040'O
        12 001765   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
        12 001766   100012 600011                    ADSC9   10,,PR1                  cn=3,n=*X1

     1385    13127    2                 '    Backed up    ',
     1386    13128    2                 TIME_BUF.HH_MM,
     1387    13129    2                 ' ',
     1388    13130    2                 DATE_BUF,
     1389    13131    2                 ON_BUF,
     1390    13132    2                 CODE$->CODE05.BACKUP.REEL);
     1391    13133    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13133 12 001767   000000 470400 xsym               LDP0    LIST_BUF$
        12 001770   000000 054100                    AOS     0,,PR0

     1392    13134    2   NO_CODE_5:
     1393    13135                                                /* CODE06: STOW time and location     */
     1394    13136    2               ON_BUF_RDF.DP_LT = 'LT';
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:222  

  13136 12 001771   000612 220000 11    NO_CODE_5    LDX0    XTEND_STRINGS+140
        12 001772   000017 440000 10                 SXL0    ON_BUF+1

     1395    13137    2               CODE$ = FPARAM$;

  13137 12 001773   000000 236000 xsym               LDQ     FPARAM$
        12 001774   200032 756100                    STQ     CODE$,,AUTO

     1396    13138    2               CALL XSF$LOCCODP(CODE$,6) ALTRET(NO_CODE_6);

  13138 12 001775   000033 236000 13                 LDQ     27
        12 001776   200063 756100                    STQ     @LEN+3,,AUTO
        12 001777   200032 630500                    EPPR0   CODE$,,AUTO
        12 002000   200062 450500                    STP0    @LEN+2,,AUTO
        12 002001   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 002002   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002003   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002004   002132 702000 12                 TSX2    NO_CODE_6

     1397    13139    2               IF CODE$->CODE06.STOW.TIME=0

  13139 12 002005   200032 470500                    LDP0    CODE$,,AUTO
        12 002006   000000 235100                    LDA     0,,PR0
        12 002007   002132 600000 12                 TZE     NO_CODE_6

     1398    13140    2                THEN
     1399    13141    2                  GOTO NO_CODE_6;
     1400    13142    2               IF TEST_MODE=1

  13142 12 002010   000000 236000 xsym               LDQ     TEST_MODE
        12 002011   000001 116007                    CMPQ    1,DL
        12 002012   002016 601000 12                 TNZ     s:13146

     1401    13143    2                THEN
     1402    13144    2                  FPT_TIME.TSTAMP_ = VECTOR(ZERO);

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:223  
  13144 12 002013   000012 237000 13                 LDAQ    10
        12 002014   000012 757000 10                 STAQ    FPT_TIME+8
        12 002015   002021 710000 12                 TRA     s:13147

     1403    13145    2                ELSE
     1404    13146    2                  FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE06.STOW.TIME);

  13146 12 002016   777640 235007                    LDA     -96,DL
        12 002017   200032 236100                    LDQ     CODE$,,AUTO
        12 002020   000012 757000 10                 STAQ    FPT_TIME+8

     1405    13147    2               CALL M$TIME(FPT_TIME) ALTRET(NO_CODE_6);

  13147 12 002021   000002 630400 10                 EPPR0   FPT_TIME
        12 002022   420004 713400                    CLIMB   alt,+8196
        12 002023   402000 401760                    pmme    nvectors=5
        12 002024   002132 702000 12                 TSX2    NO_CODE_6

     1406    13148    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13148 12 002025   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002026   000100 101500                    MRL     fill='000'O
        12 002027   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002030   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002031   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002032   000020 736000                    QLS     16
        12 002033   200000 036007                    ADLQ    65536,DL
        12 002034   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002035   200050 756100                    STQ     OLD_BUF$,,AUTO

     1407    13149    2               OLD_BUF$->TEXT$C.LEN = 48;

  13149 12 002036   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002037   000100 101400                    MRL     fill='000'O
        12 002040   000032 000004 13                 ADSC9   26                       cn=0,n=4
        12 002041   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:224  
     1408    13150    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,

  13150 12 002042   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002043   000100 101500                    MRL     fill='000'O
        12 002044   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002045   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 002046   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002047   040140 100400                    MLR     fill='040'O
        12 002050   000621 000021 11                 ADSC9   XTEND_STRINGS+147        cn=0,n=17
        12 002051   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 002052   000000 636010                    EAQ     0,X0
        12 002053   000022 772000                    QRL     18
        12 002054   000022 116007                    CMPQ    18,DL
        12 002055   002130 602000 12                 TNC     s:13157
        12 002056   777757 621010                    EAX1    -17,X0
        12 002057   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002060   040140 100400                    MLR     fill='040'O
        12 002061   000024 000005 10                 ADSC9   TIME_BUF                 cn=0,n=5
        12 002062   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1
        12 002063   000000 636010                    EAQ     0,X0
        12 002064   000022 772000                    QRL     18
        12 002065   000027 116007                    CMPQ    23,DL
        12 002066   002130 602000 12                 TNC     s:13157
        12 002067   777752 621010                    EAX1    -22,X0
        12 002070   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002071   040140 100400                    MLR     fill='040'O
        12 002072   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 002073   000005 600011                    ADSC9   5,,PR0                   cn=3,n=*X1
        12 002074   000000 636010                    EAQ     0,X0
        12 002075   000022 772000                    QRL     18
        12 002076   000030 116007                    CMPQ    24,DL
        12 002077   002130 602000 12                 TNC     s:13157
        12 002100   777751 621010                    EAX1    -23,X0
        12 002101   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002102   040140 100400                    MLR     fill='040'O
        12 002103   000021 000012 10                 ADSC9   DATE_BUF                 cn=0,n=10
        12 002104   000006 000011                    ADSC9   6,,PR0                   cn=0,n=*X1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:225  
        12 002105   000000 636010                    EAQ     0,X0
        12 002106   000022 772000                    QRL     18
        12 002107   000042 116007                    CMPQ    34,DL
        12 002110   002130 602000 12                 TNC     s:13157
        12 002111   777737 621010                    EAX1    -33,X0
        12 002112   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002113   040140 100400                    MLR     fill='040'O
        12 002114   000016 000011 10                 ADSC9   ON_BUF                   cn=0,n=9
        12 002115   000010 400011                    ADSC9   8,,PR0                   cn=2,n=*X1
        12 002116   000000 636010                    EAQ     0,X0
        12 002117   000022 772000                    QRL     18
        12 002120   000053 116007                    CMPQ    43,DL
        12 002121   002130 602000 12                 TNC     s:13157
        12 002122   777726 621010                    EAX1    -42,X0
        12 002123   200032 470500                    LDP0    CODE$,,AUTO
        12 002124   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002125   040140 100500                    MLR     fill='040'O
        12 002126   000001 000006                    ADSC9   1,,PR0                   cn=0,n=6
        12 002127   100012 600011                    ADSC9   10,,PR1                  cn=3,n=*X1

     1409    13151    2                 '    Stowed       ',
     1410    13152    2                 TIME_BUF.HH_MM,
     1411    13153    2                 ' ',
     1412    13154    2                 DATE_BUF,
     1413    13155    2                 ON_BUF,
     1414    13156    2                 CODE$->CODE06.STOW.REEL);
     1415    13157    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13157 12 002130   000000 470400 xsym               LDP0    LIST_BUF$
        12 002131   000000 054100                    AOS     0,,PR0

     1416    13158    2   NO_CODE_6:
     1417    13159                                                /* CODE03: XTNSIZE, RECLEN            */
     1418    13160    2               CODE$ = FPARAM$;

  13160 12 002132   000000 236000 xsym  NO_CODE_6    LDQ     FPARAM$
        12 002133   200032 756100                    STQ     CODE$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:226  

     1419    13161    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_CODE_3_AGAIN);

  13161 12 002134   000003 236000 13                 LDQ     3
        12 002135   200063 756100                    STQ     @LEN+3,,AUTO
        12 002136   200032 630500                    EPPR0   CODE$,,AUTO
        12 002137   200062 450500                    STP0    @LEN+2,,AUTO
        12 002140   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 002141   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002142   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002143   002326 702000 12                 TSX2    NO_CODE_3_AGAIN

     1420    13162    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13162 12 002144   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002145   000100 101500                    MRL     fill='000'O
        12 002146   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002147   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002150   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002151   000020 736000                    QLS     16
        12 002152   200000 036007                    ADLQ    65536,DL
        12 002153   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002154   200050 756100                    STQ     OLD_BUF$,,AUTO

     1421    13163    2               OLD_BUF$->TEXT$C.LEN = 36;

  13163 12 002155   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002156   000100 101400                    MRL     fill='000'O
        12 002157   000034 000004 13                 ADSC9   28                       cn=0,n=4
        12 002160   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1422    13164    2               OLD_BUF$->TEXT$C.STRING = '    XTNsize =         Reclen =';

  13164 12 002161   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002162   000100 101500                    MRL     fill='000'O
        12 002163   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002164   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:227  
        12 002165   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002166   040140 100400                    MLR     fill='040'O
        12 002167   000626 000036 11                 ADSC9   XTEND_STRINGS+152        cn=0,n=30
        12 002170   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1423    13165    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE03.XTNSIZE);

  13165 12 002171   200032 470500                    LDP0    CODE$,,AUTO
        12 002172   000005 236100                    LDQ     5,,PR0
        12 002173   000022 772000                    QRL     18
        12 002174   000000 235003                    LDA     0,DU
        12 002175   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002176   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002177   000100 301500                    BTD
        12 002200   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002201   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1424    13166    2               IF M$EI$->F$DCB.ORG=%RELATIVE# /* RECL VALID FOR RELATIVE FILES   */

  13166 12 002202   000000 470400 xsym               LDP0    M$EI$
        12 002203   000032 236100                    LDQ     26,,PR0
        12 002204   777000 376003                    ANQ     -512,DU
        12 002205   005000 116003                    CMPQ    2560,DU
        12 002206   002225 601000 12                 TNZ     s:13174

     1425    13167    2                THEN                       /* ONLY                               */
     1426    13168    3                DO;

     1427    13169    3                   CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE03.RECL);

  13169 12 002207   200032 471500                    LDP1    CODE$,,AUTO
        12 002210   100005 236100                    LDQ     5,,PR1
        12 002211   777777 376007                    ANQ     -1,DL
        12 002212   000000 235003                    LDA     0,DU
        12 002213   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002214   200050 473500                    LDP3    OLD_BUF$,,AUTO
        12 002215   000100 301500                    BTD
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:228  
        12 002216   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002217   300010 030005                    NDSC9   8,,PR3                   cn=0,s=nosgn,sf=0,n=5

     1428    13170    3                   CALL FINISH_NUMARY_BUF(2);

  13170 12 002220   000035 236000 13                 LDQ     29
        12 002221   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 002222   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 002223   000000 011000                    NOP     0

     1429    13171    3                   END;

  13171 12 002224   002235 710000 12                 TRA     s:13178

     1430    13172    2                ELSE
     1431    13173    3                DO;

     1432    13174    3                   OLD_BUF$->TEXT$C.LEN = 18;

  13174 12 002225   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002226   000100 101400                    MRL     fill='000'O
        12 002227   000036 000004 13                 ADSC9   30                       cn=0,n=4
        12 002230   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1433    13175    3                   CALL FINISH_NUMARY_BUF(1);

  13175 12 002231   000037 236000 13                 LDQ     31
        12 002232   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 002233   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 002234   000000 011000                    NOP     0

     1434    13176    3                   END;

     1435    13177                                                /* CODE03: GHSTACS code               */
     1436    13178    2               IF CODE$->CODE03.GHSTACS~=0 AND CODE$->CODE03.GHSTACS~=%NONE#

  13178 12 002235   200032 470500                    LDP0    CODE$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:229  
        12 002236   000004 236100                    LDQ     4,,PR0
        12 002237   017000 316003                    CANQ    7680,DU
        12 002240   002326 600000 12                 TZE     NO_CODE_3_AGAIN
        12 002241   000004 236100                    LDQ     4,,PR0
        12 002242   017000 376003                    ANQ     7680,DU
        12 002243   003000 116003                    CMPQ    1536,DU
        12 002244   002326 600000 12                 TZE     NO_CODE_3_AGAIN

     1437    13179    2                THEN
     1438    13180    3                DO;

     1439    13181    3                   OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13181 12 002245   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002246   000100 101500                    MRL     fill='000'O
        12 002247   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 002250   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002251   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002252   000020 736000                    QLS     16
        12 002253   200000 036007                    ADLQ    65536,DL
        12 002254   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002255   200050 756100                    STQ     OLD_BUF$,,AUTO

     1440    13182    3                   IF CODE$->CODE03.GHSTACS=%JRNLOPN#

  13182 12 002256   000004 236100                    LDQ     4,,PR0
        12 002257   017000 376003                    ANQ     7680,DU
        12 002260   002000 116003                    CMPQ    1024,DU
        12 002261   002275 601000 12                 TNZ     s:13191

     1441    13183    3                    THEN
     1442    13184    4                    DO;

     1443    13185    4                       PINCRC(OLD_BUF$,15)->CHAR$7 = 'JRNLOPN';

  13185 12 002262   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002263   040100 100400                    MLR     fill='040'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:230  
        12 002264   000636 000007 11                 ADSC9   XTEND_STRINGS+160        cn=0,n=7
        12 002265   100003 600007                    ADSC9   3,,PR1                   cn=3,n=7

     1444    13186    4                       OLD_BUF$->TEXT$C.LEN = 21;

  13186 12 002266   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002267   000100 101400                    MRL     fill='000'O
        12 002270   000040 000004 13                 ADSC9   32                       cn=0,n=4
        12 002271   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1445    13187    4                       BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13187 12 002272   000000 470400 xsym               LDP0    LIST_BUF$
        12 002273   000000 054100                    AOS     0,,PR0

     1446    13188    4                       END;

  13188 12 002274   002316 710000 12                 TRA     s:13195

     1447    13189    3                    ELSE
     1448    13190    4                    DO;

     1449    13191    4                       CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE03.GHSTACS);

  13191 12 002275   000004 236100                    LDQ     4,,PR0
        12 002276   000033 772000                    QRL     27
        12 002277   000017 376007                    ANQ     15,DL
        12 002300   000000 235003                    LDA     0,DU
        12 002301   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002302   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002303   000100 301500                    BTD
        12 002304   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002305   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1450    13192    4                       CALL FINISH_NUMARY_BUF(1);

  13192 12 002306   000037 236000 13                 LDQ     31
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:231  
        12 002307   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 002310   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 002311   000000 011000                    NOP     0

     1451    13193    4                       OLD_BUF$->TEXT$C.LEN = 18;

  13193 12 002312   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002313   000100 101400                    MRL     fill='000'O
        12 002314   000036 000004 13                 ADSC9   30                       cn=0,n=4
        12 002315   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1452    13194    4                       END;

     1453    13195    3                   SUBSTR(OLD_BUF$->TEXT$C.STRING,0,14) = '    GHSTACS = ';

  13195 12 002316   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002317   000100 101500                    MRL     fill='000'O
        12 002320   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002321   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 002322   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002323   040100 100400                    MLR     fill='040'O
        12 002324   000640 000016 11                 ADSC9   XTEND_STRINGS+162        cn=0,n=14
        12 002325   000000 200016                    ADSC9   0,,PR0                   cn=1,n=14

     1454    13196    3                   END;

     1455    13197    2   NO_CODE_3_AGAIN:
     1456    13198                                                /* CODE15: CGORG                      */
     1457    13199    2               CODE$ = FPARAM$;

  13199 12 002326   000000 236000 xsym  NO_CODE_3_A* LDQ     FPARAM$
        12 002327   200032 756100                    STQ     CODE$,,AUTO

     1458    13200    2               CALL XSF$LOCCODP(CODE$,15) ALTRET(NO_CODE_15);

  13200 12 002330   000042 236000 13                 LDQ     34
        12 002331   200063 756100                    STQ     @LEN+3,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:232  
        12 002332   200032 630500                    EPPR0   CODE$,,AUTO
        12 002333   200062 450500                    STP0    @LEN+2,,AUTO
        12 002334   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 002335   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002336   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002337   002423 702000 12                 TSX2    NO_CODE_15

     1459    13201    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13201 12 002340   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002341   000100 101500                    MRL     fill='000'O
        12 002342   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002343   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002344   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002345   000020 736000                    QLS     16
        12 002346   200000 036007                    ADLQ    65536,DL
        12 002347   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002350   200050 756100                    STQ     OLD_BUF$,,AUTO

     1460    13202    2               OLD_BUF$->TEXT$C.LEN = 15;

  13202 12 002351   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002352   000100 101400                    MRL     fill='000'O
        12 002353   000041 000004 13                 ADSC9   33                       cn=0,n=4
        12 002354   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1461    13203    2               I = %MAX_ORG#;

  13203 12 002355   000032 235007                    LDA     26,DL
        12 002356   200034 755100                    STA     I,,AUTO

     1462    13204    3               DO WHILE (I > 0 AND M$EI$->F$DCB.ORG~=ORG_TBL.ORG_MON(I));

  13204 12 002357   002362 710000 12                 TRA     s:13206

     1463    13205    3                  I = I -1;

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:233  
  13205 12 002360   000001 336007                    LCQ     1,DL
        12 002361   200034 056100                    ASQ     I,,AUTO

     1464    13206    3                  END;

  13206 12 002362   200034 235100                    LDA     I,,AUTO
        12 002363   002376 604400 12                 TMOZ    s:13207
        12 002364   200034 236100                    LDQ     I,,AUTO
        12 002365   000022 402007                    MPY     18,DL
        12 002366   000100 101406                    MRL     fill='000'O
        12 002367   000000 000001 xsym               ADSC9   ORG_TBL,Q                cn=0,n=1
        12 002370   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002371   000000 470400 xsym               LDP0    M$EI$
        12 002372   000032 236100                    LDQ     26,,PR0
        12 002373   000033 772000                    QRL     27
        12 002374   200062 116100                    CMPQ    @LEN+2,,AUTO
        12 002375   002360 601000 12                 TNZ     s:13205

     1465    13207    2               CALL CONCAT(OLD_BUF$->TEXT$C.STRING,'    CGorg =',

  13207 12 002376   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002377   000100 101500                    MRL     fill='000'O
        12 002400   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002401   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 002402   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002403   040140 100400                    MLR     fill='040'O
        12 002404   000644 000013 11                 ADSC9   XTEND_STRINGS+166        cn=0,n=11
        12 002405   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 002406   000000 636010                    EAQ     0,X0
        12 002407   000022 772000                    QRL     18
        12 002410   000014 116007                    CMPQ    12,DL
        12 002411   002421 602000 12                 TNC     s:13209
        12 002412   200034 236100                    LDQ     I,,AUTO
        12 002413   000022 402007                    MPY     18,DL
        12 002414   777765 621010                    EAX1    -11,X0
        12 002415   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002416   040140 100406                    MLR     fill='040'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:234  
        12 002417   000003 200003 xsym               ADSC9   ORG_TBL+3,Q              cn=1,n=3
        12 002420   000003 000011                    ADSC9   3,,PR0                   cn=0,n=*X1

     1466    13208    2                 ORG_TBL.ABBR(I));
     1467    13209    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13209 12 002421   000000 470400 xsym               LDP0    LIST_BUF$
        12 002422   000000 054100                    AOS     0,,PR0

     1468    13210    2   NO_CODE_15:
     1469    13211    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13211 12 002423   200050 470500       NO_CODE_15   LDP0    OLD_BUF$,,AUTO
        12 002424   000100 101500                    MRL     fill='000'O
        12 002425   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002426   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002427   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002430   000020 736000                    QLS     16
        12 002431   200000 036007                    ADLQ    65536,DL
        12 002432   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002433   200050 756100                    STQ     OLD_BUF$,,AUTO

     1470    13212    2               OLD_BUF$->TEXT$C.LEN = 18;

  13212 12 002434   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002435   000100 101400                    MRL     fill='000'O
        12 002436   000036 000004 13                 ADSC9   30                       cn=0,n=4
        12 002437   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1471    13213    2               OLD_BUF$->TEXT$C.STRING = '    FITsize =';

  13213 12 002440   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002441   000100 101500                    MRL     fill='000'O
        12 002442   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002443   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 002444   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002445   040140 100400                    MLR     fill='040'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:235  
        12 002446   000647 000015 11                 ADSC9   XTEND_STRINGS+169        cn=0,n=13
        12 002447   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1472    13214    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),FPARAM$->FM$FIT.CODES.NAW(0));

  13214 12 002450   000000 470400 xsym               LDP0    FPARAM$
        12 002451   000000 236100                    LDQ     0,,PR0
        12 002452   000024 772000                    QRL     20
        12 002453   001777 376007                    ANQ     1023,DL
        12 002454   000000 235003                    LDA     0,DU
        12 002455   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002456   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002457   000100 301500                    BTD
        12 002460   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002461   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1473    13215    2               CALL FINISH_NUMARY_BUF(1);

  13215 12 002462   000037 236000 13                 LDQ     31
        12 002463   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 002464   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 002465   000000 011000                    NOP     0

     1474    13216    2               END;

     1475    13217                                                /* L(EA) for any file                 */
     1476    13218                                                /* CODE04:  CREATION time             */
     1477    13219    1           CODE$ = FPARAM$;

  13219 12 002466   000000 236000 xsym               LDQ     FPARAM$
        12 002467   200032 756100                    STQ     CODE$,,AUTO

     1478    13220    1           CALL XSF$LOCCODP(CODE$,4) ALTRET(NO_CREATION);

  13220 12 002470   000010 236000 13                 LDQ     8
        12 002471   200063 756100                    STQ     @LEN+3,,AUTO
        12 002472   200032 630500                    EPPR0   CODE$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:236  
        12 002473   200062 450500                    STP0    @LEN+2,,AUTO
        12 002474   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 002475   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002476   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002477   002600 702000 12                 TSX2    NO_CREATION

     1479    13221    1           IF TEST_MODE=1

  13221 12 002500   000000 235000 xsym               LDA     TEST_MODE
        12 002501   000001 115007                    CMPA    1,DL
        12 002502   002506 601000 12                 TNZ     s:13225

     1480    13222    1            THEN
     1481    13223    1              FPT_TIME.TSTAMP_ = VECTOR(ZERO);

  13223 12 002503   000012 237000 13                 LDAQ    10
        12 002504   000012 757000 10                 STAQ    FPT_TIME+8
        12 002505   002512 710000 12                 TRA     s:13226

     1482    13224    1            ELSE
     1483    13225    1              FPT_TIME.TSTAMP_ = VECTOR(CODE$->CODE04.CREATION.TIME);

  13225 12 002506   777640 235007                    LDA     -96,DL
        12 002507   200032 236100                    LDQ     CODE$,,AUTO
        12 002510   000002 036003                    ADLQ    2,DU
        12 002511   000012 757000 10                 STAQ    FPT_TIME+8

     1484    13226    1           CALL M$TIME(FPT_TIME) ALTRET(NO_CREATION);

  13226 12 002512   000002 630400 10                 EPPR0   FPT_TIME
        12 002513   420004 713400                    CLIMB   alt,+8196
        12 002514   402000 401760                    pmme    nvectors=5
        12 002515   002600 702000 12                 TSX2    NO_CREATION

     1485    13227    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13227 12 002516   200050 470500                    LDP0    OLD_BUF$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:237  
        12 002517   000100 101500                    MRL     fill='000'O
        12 002520   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002521   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002522   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002523   000020 736000                    QLS     16
        12 002524   200000 036007                    ADLQ    65536,DL
        12 002525   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002526   200050 756100                    STQ     OLD_BUF$,,AUTO

     1486    13228    1           OLD_BUF$->TEXT$C.LEN = 33;

  13228 12 002527   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002530   000100 101400                    MRL     fill='000'O
        12 002531   000026 000004 13                 ADSC9   22                       cn=0,n=4
        12 002532   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1487    13229    1           CALL CONCAT(OLD_BUF$->TEXT$C.STRING,

  13229 12 002533   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002534   000100 101500                    MRL     fill='000'O
        12 002535   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002536   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 002537   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002540   040140 100400                    MLR     fill='040'O
        12 002541   000653 000021 11                 ADSC9   XTEND_STRINGS+173        cn=0,n=17
        12 002542   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 002543   000000 636010                    EAQ     0,X0
        12 002544   000022 772000                    QRL     18
        12 002545   000022 116007                    CMPQ    18,DL
        12 002546   002576 602000 12                 TNC     s:13234
        12 002547   777757 621010                    EAX1    -17,X0
        12 002550   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002551   040140 100400                    MLR     fill='040'O
        12 002552   000024 000005 10                 ADSC9   TIME_BUF                 cn=0,n=5
        12 002553   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1
        12 002554   000000 636010                    EAQ     0,X0
        12 002555   000022 772000                    QRL     18
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:238  
        12 002556   000027 116007                    CMPQ    23,DL
        12 002557   002576 602000 12                 TNC     s:13234
        12 002560   777752 621010                    EAX1    -22,X0
        12 002561   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002562   040140 100400                    MLR     fill='040'O
        12 002563   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 002564   000005 600011                    ADSC9   5,,PR0                   cn=3,n=*X1
        12 002565   000000 636010                    EAQ     0,X0
        12 002566   000022 772000                    QRL     18
        12 002567   000030 116007                    CMPQ    24,DL
        12 002570   002576 602000 12                 TNC     s:13234
        12 002571   777751 621010                    EAX1    -23,X0
        12 002572   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002573   040140 100400                    MLR     fill='040'O
        12 002574   000021 000012 10                 ADSC9   DATE_BUF                 cn=0,n=10
        12 002575   000006 000011                    ADSC9   6,,PR0                   cn=0,n=*X1

     1488    13230    1             '    Created      ',
     1489    13231    1             TIME_BUF.HH_MM,
     1490    13232    1             ' ',
     1491    13233    1             DATE_BUF);
     1492    13234    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13234 12 002576   000000 470400 xsym               LDP0    LIST_BUF$
        12 002577   000000 054100                    AOS     0,,PR0

  13234 12 002600                       NO_CREATION  null
     1493    13235    1   NO_CREATION: ;
     1494    13236                                                /* CODE02: LSLIDE,                    */
     1495    13237                                                /* SLIDE, LRDL0, TDALVL, SPARE        */
     1496    13238    1           CODE$ = FPARAM$;

  13238 12 002600   000000 236000 xsym               LDQ     FPARAM$
        12 002601   200032 756100                    STQ     CODE$,,AUTO

     1497    13239    1           CALL XSF$LOCCODP(CODE$,2) ALTRET(NO_CODE_2);

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:239  
  13239 12 002602   000035 236000 13                 LDQ     29
        12 002603   200063 756100                    STQ     @LEN+3,,AUTO
        12 002604   200032 630500                    EPPR0   CODE$,,AUTO
        12 002605   200062 450500                    STP0    @LEN+2,,AUTO
        12 002606   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 002607   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002610   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002611   002753 702000 12                 TSX2    NO_CODE_2

     1498    13240    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13240 12 002612   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002613   000100 101500                    MRL     fill='000'O
        12 002614   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002615   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002616   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002617   000020 736000                    QLS     16
        12 002620   200000 036007                    ADLQ    65536,DL
        12 002621   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002622   200050 756100                    STQ     OLD_BUF$,,AUTO

     1499    13241    1           OLD_BUF$->TEXT$C.LEN = 36;

  13241 12 002623   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002624   000100 101400                    MRL     fill='000'O
        12 002625   000034 000004 13                 ADSC9   28                       cn=0,n=4
        12 002626   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1500    13242    1           OLD_BUF$->TEXT$C.STRING = '    Lslide  =         Slide   =';

  13242 12 002627   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002630   000100 101500                    MRL     fill='000'O
        12 002631   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002632   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 002633   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002634   040140 100400                    MLR     fill='040'O
        12 002635   000660 000037 11                 ADSC9   XTEND_STRINGS+178        cn=0,n=31
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:240  
        12 002636   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1501    13243    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE02.LSLIDE);

  13243 12 002637   200032 470500                    LDP0    CODE$,,AUTO
        12 002640   000000 236100                    LDQ     0,,PR0
        12 002641   000033 772000                    QRL     27
        12 002642   000000 235003                    LDA     0,DU
        12 002643   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002644   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002645   000100 301500                    BTD
        12 002646   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002647   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1502    13244    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE02.SLIDE);

  13244 12 002650   200032 470500                    LDP0    CODE$,,AUTO
        12 002651   000000 236100                    LDQ     0,,PR0
        12 002652   000777 376007                    ANQ     511,DL
        12 002653   000000 235003                    LDA     0,DU
        12 002654   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002655   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002656   000100 301500                    BTD
        12 002657   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002660   100010 030005                    NDSC9   8,,PR1                   cn=0,s=nosgn,sf=0,n=5

     1503    13245    1           CALL FINISH_NUMARY_BUF(2);

  13245 12 002661   000035 236000 13                 LDQ     29
        12 002662   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 002663   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 002664   000000 011000                    NOP     0

     1504    13246    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13246 12 002665   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002666   000100 101500                    MRL     fill='000'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:241  
        12 002667   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002670   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002671   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002672   000020 736000                    QLS     16
        12 002673   200000 036007                    ADLQ    65536,DL
        12 002674   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002675   200050 756100                    STQ     OLD_BUF$,,AUTO

     1505    13247    1           OLD_BUF$->TEXT$C.LEN = 54;

  13247 12 002676   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002677   000100 101400                    MRL     fill='000'O
        12 002700   000043 000004 13                 ADSC9   35                       cn=0,n=4
        12 002701   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1506    13248    1           OLD_BUF$->TEXT$C.STRING =

  13248 12 002702   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002703   000100 101500                    MRL     fill='000'O
        12 002704   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002705   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 002706   200062 220100                    LDX0    @LEN+2,,AUTO
        12 002707   040140 100400                    MLR     fill='040'O
        12 002710   000670 000061 11                 ADSC9   XTEND_STRINGS+186        cn=0,n=49
        12 002711   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1507    13249    1             '    LRDL0   =         TDALVL  =         Spare   =';
     1508    13250    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE02.LRDL0);

  13250 12 002712   200032 470500                    LDP0    CODE$,,AUTO
        12 002713   000000 236100                    LDQ     0,,PR0
        12 002714   000022 772000                    QRL     18
        12 002715   000777 376007                    ANQ     511,DL
        12 002716   000000 235003                    LDA     0,DU
        12 002717   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002720   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002721   000100 301500                    BTD
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:242  
        12 002722   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002723   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1509    13251    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE02.TDALVL);

  13251 12 002724   200032 470500                    LDP0    CODE$,,AUTO
        12 002725   000001 236100                    LDQ     1,,PR0
        12 002726   000033 772000                    QRL     27
        12 002727   000000 235003                    LDA     0,DU
        12 002730   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002731   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002732   000100 301500                    BTD
        12 002733   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002734   100010 030005                    NDSC9   8,,PR1                   cn=0,s=nosgn,sf=0,n=5

     1510    13252    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(2),CODE$->CODE02.SPARE);

  13252 12 002735   200032 470500                    LDP0    CODE$,,AUTO
        12 002736   000000 236100                    LDQ     0,,PR0
        12 002737   000011 772000                    QRL     9
        12 002740   000777 376007                    ANQ     511,DL
        12 002741   000000 235003                    LDA     0,DU
        12 002742   200062 757100                    STAQ    @LEN+2,,AUTO
        12 002743   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 002744   000100 301500                    BTD
        12 002745   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 002746   100014 430005                    NDSC9   12,,PR1                  cn=2,s=nosgn,sf=0,n=5

     1511    13253    1           CALL FINISH_NUMARY_BUF(3);

  13253 12 002747   000003 236000 13                 LDQ     3
        12 002750   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 002751   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 002752   000000 011000                    NOP     0

     1512    13254    1   NO_CODE_2:
     1513    13255        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:243  
     1514    13256                                                /* CODE16: LINES, WIDTH, PAGENO,      */
     1515    13257                                                /* LINENO, FORM, DVFC                 */
     1516    13258    1           CODE$ = FPARAM$;

  13258 12 002753   000000 236000 xsym  NO_CODE_2    LDQ     FPARAM$
        12 002754   200032 756100                    STQ     CODE$,,AUTO

     1517    13259    1           CALL XSF$LOCCODP(CODE$,16) ALTRET(NO_UR_INFO);

  13259 12 002755   000045 236000 13                 LDQ     37
        12 002756   200063 756100                    STQ     @LEN+3,,AUTO
        12 002757   200032 630500                    EPPR0   CODE$,,AUTO
        12 002760   200062 450500                    STP0    @LEN+2,,AUTO
        12 002761   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 002762   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 002763   000000 701000 xent               TSX1    XSF$LOCCODP
        12 002764   003254 702000 12                 TSX2    NO_UR_INFO

     1518    13260    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13260 12 002765   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002766   000100 101500                    MRL     fill='000'O
        12 002767   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 002770   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 002771   200062 236100                    LDQ     @LEN+2,,AUTO
        12 002772   000020 736000                    QLS     16
        12 002773   200000 036007                    ADLQ    65536,DL
        12 002774   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 002775   200050 756100                    STQ     OLD_BUF$,,AUTO

     1519    13261    1           OLD_BUF$->TEXT$C.LEN = 36;

  13261 12 002776   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 002777   000100 101400                    MRL     fill='000'O
        12 003000   000034 000004 13                 ADSC9   28                       cn=0,n=4
        12 003001   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:244  
     1520    13262    1           OLD_BUF$->TEXT$C.STRING = '    Ln/page =         Width   =';

  13262 12 003002   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003003   000100 101500                    MRL     fill='000'O
        12 003004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003005   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003006   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003007   040140 100400                    MLR     fill='040'O
        12 003010   000705 000037 11                 ADSC9   XTEND_STRINGS+199        cn=0,n=31
        12 003011   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1521    13263    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE16.LINES);

  13263 12 003012   200032 470500                    LDP0    CODE$,,AUTO
        12 003013   000006 236100                    LDQ     6,,PR0
        12 003014   777777 376007                    ANQ     -1,DL
        12 003015   000000 235003                    LDA     0,DU
        12 003016   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003017   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003020   000100 301500                    BTD
        12 003021   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003022   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1522    13264    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE16.WIDTH);

  13264 12 003023   200032 470500                    LDP0    CODE$,,AUTO
        12 003024   000026 236100                    LDQ     22,,PR0
        12 003025   000022 772000                    QRL     18
        12 003026   000777 376007                    ANQ     511,DL
        12 003027   000000 235003                    LDA     0,DU
        12 003030   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003031   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003032   000100 301500                    BTD
        12 003033   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003034   100010 030005                    NDSC9   8,,PR1                   cn=0,s=nosgn,sf=0,n=5

     1523    13265    1           CALL FINISH_NUMARY_BUF(2);
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:245  

  13265 12 003035   000035 236000 13                 LDQ     29
        12 003036   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 003037   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 003040   000000 011000                    NOP     0

     1524    13266    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13266 12 003041   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003042   000100 101500                    MRL     fill='000'O
        12 003043   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003044   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003045   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003046   000020 736000                    QLS     16
        12 003047   200000 036007                    ADLQ    65536,DL
        12 003050   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003051   200050 756100                    STQ     OLD_BUF$,,AUTO

     1525    13267    1           OLD_BUF$->TEXT$C.LEN = 36;

  13267 12 003052   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003053   000100 101400                    MRL     fill='000'O
        12 003054   000034 000004 13                 ADSC9   28                       cn=0,n=4
        12 003055   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1526    13268    1           OLD_BUF$->TEXT$C.STRING = '    Pages   =         Lines   =';

  13268 12 003056   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003057   000100 101500                    MRL     fill='000'O
        12 003060   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003061   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003062   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003063   040140 100400                    MLR     fill='040'O
        12 003064   000715 000037 11                 ADSC9   XTEND_STRINGS+207        cn=0,n=31
        12 003065   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1527    13269    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE16.PAGENO);
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:246  

  13269 12 003066   200032 470500                    LDP0    CODE$,,AUTO
        12 003067   000005 236100                    LDQ     5,,PR0
        12 003070   000022 772000                    QRL     18
        12 003071   000000 235003                    LDA     0,DU
        12 003072   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003073   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003074   000100 301500                    BTD
        12 003075   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003076   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1528    13270    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE16.LINENO);

  13270 12 003077   200032 470500                    LDP0    CODE$,,AUTO
        12 003100   000005 236100                    LDQ     5,,PR0
        12 003101   777777 376007                    ANQ     -1,DL
        12 003102   000000 235003                    LDA     0,DU
        12 003103   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003104   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003105   000100 301500                    BTD
        12 003106   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003107   100010 030005                    NDSC9   8,,PR1                   cn=0,s=nosgn,sf=0,n=5

     1529    13271    1           CALL FINISH_NUMARY_BUF(2);

  13271 12 003110   000035 236000 13                 LDQ     29
        12 003111   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 003112   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 003113   000000 011000                    NOP     0

     1530    13272    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13272 12 003114   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003115   000100 101500                    MRL     fill='000'O
        12 003116   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003117   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003120   200062 236100                    LDQ     @LEN+2,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:247  
        12 003121   000020 736000                    QLS     16
        12 003122   200000 036007                    ADLQ    65536,DL
        12 003123   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003124   200050 756100                    STQ     OLD_BUF$,,AUTO

     1531    13273    1           OLD_BUF$ -> TEXT$C.LEN = 40;

  13273 12 003125   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003126   000100 101400                    MRL     fill='000'O
        12 003127   000046 000004 13                 ADSC9   38                       cn=0,n=4
        12 003130   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1532    13274    1           CALL CONCAT(OLD_BUF$ -> TEXT$C.STRING,

  13274 12 003131   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003132   000100 101500                    MRL     fill='000'O
        12 003133   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003134   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003135   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003136   040140 100400                    MLR     fill='040'O
        12 003137   000725 000020 11                 ADSC9   XTEND_STRINGS+215        cn=0,n=16
        12 003140   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 003141   000000 636010                    EAQ     0,X0
        12 003142   000022 772000                    QRL     18
        12 003143   000021 116007                    CMPQ    17,DL
        12 003144   003207 602000 12                 TNC     s:13280
        12 003145   777760 621010                    EAX1    -16,X0
        12 003146   200032 470500                    LDP0    CODE$,,AUTO
        12 003147   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003150   040140 100500                    MLR     fill='040'O
        12 003151   000026 000001                    ADSC9   22,,PR0                  cn=0,n=1
        12 003152   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        12 003153   000000 636010                    EAQ     0,X0
        12 003154   000022 772000                    QRL     18
        12 003155   000022 116007                    CMPQ    18,DL
        12 003156   003207 602000 12                 TNC     s:13280
        12 003157   777757 621010                    EAX1    -17,X0
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:248  
        12 003160   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003161   040140 100400                    MLR     fill='040'O
        12 003162   000731 000020 11                 ADSC9   XTEND_STRINGS+219        cn=0,n=16
        12 003163   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1
        12 003164   000000 636010                    EAQ     0,X0
        12 003165   000022 772000                    QRL     18
        12 003166   000042 116007                    CMPQ    34,DL
        12 003167   003207 602000 12                 TNC     s:13280
        12 003170   777737 621010                    EAX1    -33,X0
        12 003171   200032 470500                    LDP0    CODE$,,AUTO
        12 003172   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003173   040140 100500                    MLR     fill='040'O
        12 003174   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
        12 003175   100010 400011                    ADSC9   8,,PR1                   cn=2,n=*X1
        12 003176   000000 636010                    EAQ     0,X0
        12 003177   000022 772000                    QRL     18
        12 003200   000050 116007                    CMPQ    40,DL
        12 003201   003207 602000 12                 TNC     s:13280
        12 003202   777731 621010                    EAX1    -39,X0
        12 003203   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003204   040140 100400                    MLR     fill='040'O
        12 003205   000047 000001 13                 ADSC9   39                       cn=0,n=1
        12 003206   000012 000011                    ADSC9   10,,PR0                  cn=0,n=*X1

     1533    13275    1             '    DVFC    =  ''',
     1534    13276    1             CODE$->CODE16.DVFC,
     1535    13277    1             '''    Form    = ''',
     1536    13278    1             CODE$->CODE16.FORM,
     1537    13279    1             '''');
     1538    13280    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT + 1;

  13280 12 003207   000000 470400 xsym               LDP0    LIST_BUF$
        12 003210   000000 054100                    AOS     0,,PR0

     1539    13281    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13281 12 003211   200050 470500                    LDP0    OLD_BUF$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:249  
        12 003212   000100 101500                    MRL     fill='000'O
        12 003213   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003214   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003215   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003216   000020 736000                    QLS     16
        12 003217   200000 036007                    ADLQ    65536,DL
        12 003220   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003221   200050 756100                    STQ     OLD_BUF$,,AUTO

     1540    13282    1           OLD_BUF$ -> TEXT$C.LEN = 36;

  13282 12 003222   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003223   000100 101400                    MRL     fill='000'O
        12 003224   000034 000004 13                 ADSC9   28                       cn=0,n=4
        12 003225   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1541    13283    1           OLD_BUF$ ->TEXT$C.STRING = '    Copies  = ';

  13283 12 003226   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003227   000100 101500                    MRL     fill='000'O
        12 003230   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003231   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003232   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003233   040140 100400                    MLR     fill='040'O
        12 003234   000735 000016 11                 ADSC9   XTEND_STRINGS+223        cn=0,n=14
        12 003235   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1542    13284    1           CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE16.COPIES);

  13284 12 003236   200032 470500                    LDP0    CODE$,,AUTO
        12 003237   000007 236100                    LDQ     7,,PR0
        12 003240   000022 772000                    QRL     18
        12 003241   000777 376007                    ANQ     511,DL
        12 003242   000000 235003                    LDA     0,DU
        12 003243   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003244   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003245   000100 301500                    BTD
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:250  
        12 003246   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003247   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1543    13285    1           CALL FINISH_NUMARY_BUF(1);

  13285 12 003250   000037 236000 13                 LDQ     31
        12 003251   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 003252   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 003253   000000 011000                    NOP     0

  13284 12 003254                       NO_UR_INFO   null
     1544    13286    1   NO_UR_INFO: ;
     1545    13287        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:251  
     1546    13288                                                /* File CREATOR (IFF FMSEC is on)     */
     1547    13289    1           CALL VPD$FETCH_CREATOR(TEXT_C) ALTRET(CREATOR_DONE);

  13289 12 003254   200021 630500                    EPPR0   TEXT_C,,AUTO
        12 003255   200062 450500                    STP0    @LEN+2,,AUTO
        12 003256   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 003257   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 003260   000000 701000 xent               TSX1    VPD$FETCH_CREATOR
        12 003261   003326 702000 12                 TSX2    CREATOR_DONE

     1548    13290    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13290 12 003262   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003263   000100 101500                    MRL     fill='000'O
        12 003264   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003265   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003266   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003267   000020 736000                    QLS     16
        12 003270   200000 036007                    ADLQ    65536,DL
        12 003271   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003272   200050 756100                    STQ     OLD_BUF$,,AUTO

     1549    13291    1           OLD_BUF$->TEXT$C.LEN = 15 + TEXT_C.C;

  13291 12 003273   200021 236100                    LDQ     TEXT_C,,AUTO
        12 003274   000033 772000                    QRL     27
        12 003275   000017 036007                    ADLQ    15,DL
        12 003276   200062 756100                    STQ     @LEN+2,,AUTO
        12 003277   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003300   000100 101500                    MRL     fill='000'O
        12 003301   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003302   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1550    13292    1           CALL CONCAT(OLD_BUF$->TEXT$C.STRING,'    Created by ',TEXT_C.TEXT);

  13292 12 003303   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003304   000100 101500                    MRL     fill='000'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:252  
        12 003305   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003306   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003307   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003310   040140 100400                    MLR     fill='040'O
        12 003311   000741 000017 11                 ADSC9   XTEND_STRINGS+227        cn=0,n=15
        12 003312   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        12 003313   000000 636010                    EAQ     0,X0
        12 003314   000022 772000                    QRL     18
        12 003315   000020 116007                    CMPQ    16,DL
        12 003316   003324 602000 12                 TNC     s:13293
        12 003317   777761 621010                    EAX1    -15,X0
        12 003320   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003321   040140 100500                    MLR     fill='040'O
        12 003322   200021 200037                    ADSC9   TEXT_C,,AUTO             cn=1,n=31
        12 003323   000004 000011                    ADSC9   4,,PR0                   cn=0,n=*X1

     1551    13293    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13293 12 003324   000000 470400 xsym               LDP0    LIST_BUF$
        12 003325   000000 054100                    AOS     0,,PR0

  13293 12 003326                       CREATOR_DONE null
     1552    13294    1   CREATOR_DONE: ;
     1553    13295        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:253  
     1554    13296        /******************************************************************************/
     1555    13297        /*                                                                            */
     1556    13298        /* The remaining code for L(EA) produces one or more lines built from the     */
     1557    13299        /* textual names of some significant bits                                     */
     1558    13300        /*                                                                            */
     1559    13301        /******************************************************************************/
     1560    13302    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13302 12 003326   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003327   000100 101500                    MRL     fill='000'O
        12 003330   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003331   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003332   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003333   000020 736000                    QLS     16
        12 003334   200000 036007                    ADLQ    65536,DL
        12 003335   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003336   200050 756100                    STQ     OLD_BUF$,,AUTO

     1561    13303    1           OLD_BUF$->TEXT$C.LEN = 0;       /* Variable length field              */

  13303 12 003337   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003340   000100 101400                    MRL     fill='000'O
        12 003341   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
        12 003342   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1562    13304    1           IF ICB.DEV_MASK.MAN_TAPE        /*LT*/

  13304 12 003343   000171 236000 xsym               LDQ     ICB+121
        12 003344   100000 316003                    CANQ    32768,DU
        12 003345   003373 600000 12                 TZE     s:13312

     1563    13305    1            THEN
     1564    13306    2            DO;

     1565    13307    2               CALL XTEND_BUF(3*2 + BITBIN(M$EI$->F$DCB.BLOCKED));

  13307 12 003346   000000 470400 xsym               LDP0    M$EI$
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:254  
        12 003347   000031 236100                    LDQ     25,,PR0
        12 003350   000003 772000                    QRL     3
        12 003351   000001 376007                    ANQ     1,DL
        12 003352   000006 036007                    ADLQ    6,DL
        12 003353   200071 756100                    STQ     @LEN+9,,AUTO
        12 003354   200071 631500                    EPPR1   @LEN+9,,AUTO
        12 003355   200057 451500                    STP1    DENS_STR+4,,AUTO
        12 003356   005472 701000 12                 TSX1    XTEND_BUF
        12 003357   000000 011000                    NOP     0

     1566    13308    2               CALL XTEND_BUF(4*2 + BITBIN(M$EI$->F$DCB.SPANNED));

  13308 12 003360   000000 470400 xsym               LDP0    M$EI$
        12 003361   000031 236100                    LDQ     25,,PR0
        12 003362   000002 772000                    QRL     2
        12 003363   000001 376007                    ANQ     1,DL
        12 003364   000010 036007                    ADLQ    8,DL
        12 003365   200072 756100                    STQ     @LEN+10,,AUTO
        12 003366   200072 631500                    EPPR1   @LEN+10,,AUTO
        12 003367   200057 451500                    STP1    DENS_STR+4,,AUTO
        12 003370   005472 701000 12                 TSX1    XTEND_BUF
        12 003371   000000 011000                    NOP     0

     1567    13309    2               END;

  13309 12 003372   003505 710000 12                 TRA     FIN_TEXT

     1568    13310    1            ELSE
     1569    13311    2            DO;

     1570    13312    2               CODE$ = FPARAM$;

  13312 12 003373   000000 236000 xsym               LDQ     FPARAM$
        12 003374   200032 756100                    STQ     CODE$,,AUTO

     1571    13313    2               CALL XSF$LOCCODP(CODE$,3) ALTRET(NO_LAST_CODE_3);

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:255  
  13313 12 003375   000003 236000 13                 LDQ     3
        12 003376   200063 756100                    STQ     @LEN+3,,AUTO
        12 003377   200032 630500                    EPPR0   CODE$,,AUTO
        12 003400   200062 450500                    STP0    @LEN+2,,AUTO
        12 003401   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 003402   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 003403   000000 701000 xent               TSX1    XSF$LOCCODP
        12 003404   003461 702000 12                 TSX2    NO_LAST_CODE_3

     1572    13314    2               CALL XTEND_BUF(0*2 + BITBIN(CODE$->CODE03.DESC.BUPM));

  13314 12 003405   200032 470500                    LDP0    CODE$,,AUTO
        12 003406   000001 236100                    LDQ     1,,PR0
        12 003407   000032 772000                    QRL     26
        12 003410   000001 376007                    ANQ     1,DL
        12 003411   200073 756100                    STQ     @LEN+11,,AUTO
        12 003412   200073 631500                    EPPR1   @LEN+11,,AUTO
        12 003413   200057 451500                    STP1    DENS_STR+4,,AUTO
        12 003414   005472 701000 12                 TSX1    XTEND_BUF
        12 003415   000000 011000                    NOP     0

     1573    13315    2               CALL XTEND_BUF(1*2 + BITBIN(CODE$->CODE03.COMP));

  13315 12 003416   200032 470500                    LDP0    CODE$,,AUTO
        12 003417   000004 236100                    LDQ     4,,PR0
        12 003420   000043 772000                    QRL     35
        12 003421   000002 036007                    ADLQ    2,DL
        12 003422   200074 756100                    STQ     @LEN+12,,AUTO
        12 003423   200074 631500                    EPPR1   @LEN+12,,AUTO
        12 003424   200057 451500                    STP1    DENS_STR+4,,AUTO
        12 003425   005472 701000 12                 TSX1    XTEND_BUF
        12 003426   000000 011000                    NOP     0

     1574    13316    2               IF CODE$->CODE03.DESC.QS

  13316 12 003427   200032 470500                    LDP0    CODE$,,AUTO
        12 003430   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:256  
        12 003431   010000 316003                    CANQ    4096,DU
        12 003432   003461 600000 12                 TZE     NO_LAST_CODE_3

     1575    13317    2                THEN                       /* EFT will be doing something        */
     1576    13318    3                DO;

     1577    13319    3                   CALL XTEND_BUF(2*2 + BITBIN(CODE$->CODE03.DESC.FETCH));

  13319 12 003433   000001 236100                    LDQ     1,,PR0
        12 003434   000025 772000                    QRL     21
        12 003435   000001 376007                    ANQ     1,DL
        12 003436   000004 036007                    ADLQ    4,DL
        12 003437   200075 756100                    STQ     @LEN+13,,AUTO
        12 003440   200075 631500                    EPPR1   @LEN+13,,AUTO
        12 003441   200057 451500                    STP1    DENS_STR+4,,AUTO
        12 003442   005472 701000 12                 TSX1    XTEND_BUF
        12 003443   000000 011000                    NOP     0

     1578    13320    3                   IF NOT CODE$->CODE03.DESC.FETCH THEN

  13320 12 003444   200032 470500                    LDP0    CODE$,,AUTO
        12 003445   000001 236100                    LDQ     1,,PR0
        12 003446   000010 316003                    CANQ    8,DU
        12 003447   003461 601000 12                 TNZ     NO_LAST_CODE_3

     1579    13321    3                      CALL XTEND_BUF(6*2 + BITBIN(CODE$->CODE03.DESC.ACTIVE));

  13321 12 003450   000001 236100                    LDQ     1,,PR0
        12 003451   000030 772000                    QRL     24
        12 003452   000001 376007                    ANQ     1,DL
        12 003453   000014 036007                    ADLQ    12,DL
        12 003454   200076 756100                    STQ     @LEN+14,,AUTO
        12 003455   200076 631500                    EPPR1   @LEN+14,,AUTO
        12 003456   200057 451500                    STP1    DENS_STR+4,,AUTO
        12 003457   005472 701000 12                 TSX1    XTEND_BUF
        12 003460   000000 011000                    NOP     0

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:257  
     1580    13322    3                   END;

     1581    13323    2   NO_LAST_CODE_3:
     1582    13324    2               CODE$ = FPARAM$;

  13324 12 003461   000000 236000 xsym  NO_LAST_COD* LDQ     FPARAM$
        12 003462   200032 756100                    STQ     CODE$,,AUTO

     1583    13325    2               CALL XSF$LOCCODP(CODE$,15) ALTRET(FIN_TEXT);

  13325 12 003463   000042 236000 13                 LDQ     34
        12 003464   200063 756100                    STQ     @LEN+3,,AUTO
        12 003465   200032 630500                    EPPR0   CODE$,,AUTO
        12 003466   200062 450500                    STP0    @LEN+2,,AUTO
        12 003467   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 003470   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 003471   000000 701000 xent               TSX1    XSF$LOCCODP
        12 003472   003505 702000 12                 TSX2    FIN_TEXT

     1584    13326    2               CALL XTEND_BUF(5*2 + BITBIN(CODE$->CODE15.QISS));

  13326 12 003473   200032 470500                    LDP0    CODE$,,AUTO
        12 003474   000000 236100                    LDQ     0,,PR0
        12 003475   000032 772000                    QRL     26
        12 003476   000001 376007                    ANQ     1,DL
        12 003477   000012 036007                    ADLQ    10,DL
        12 003500   200077 756100                    STQ     @LEN+15,,AUTO
        12 003501   200077 631500                    EPPR1   @LEN+15,,AUTO
        12 003502   200057 451500                    STP1    DENS_STR+4,,AUTO
        12 003503   005472 701000 12                 TSX1    XTEND_BUF
        12 003504   000000 011000                    NOP     0

     1585    13327    2               END;

     1586    13328    1   FIN_TEXT:
     1587    13329    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:258  
  13329 12 003505   000000 470400 xsym  FIN_TEXT     LDP0    LIST_BUF$
        12 003506   000000 054100                    AOS     0,,PR0

     1588    13330        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:259  
     1589    13331        /******************************************************************************/
     1590    13332        /*                                                                            */
     1591    13333        /*  The remaining code is for L(FA) or better.                                */
     1592    13334        /*                                                                            */
     1593    13335        /******************************************************************************/
     1594    13336    1           IF LIST_CODE < 5

  13336 12 003507   200003 470500                    LDP0    @LIST_CODE,,AUTO
        12 003510   000000 235100                    LDA     0,,PR0
        12 003511   000005 115007                    CMPA    5,DL
        12 003512   003514 605000 12                 TPL     s:13339

     1595    13337    1            THEN
     1596    13338    1              RETURN;

  13338 12 003513   000000 702200 xent               TSX2  ! X66_ARET

     1597    13339    1           IF M$EI$->F$DCB.ORG=%INDEXED#

  13339 12 003514   000000 471400 xsym               LDP1    M$EI$
        12 003515   100032 236100                    LDQ     26,,PR1
        12 003516   777000 376003                    ANQ     -512,DU
        12 003517   006000 116003                    CMPQ    3072,DU
        12 003520   004016 601000 12                 TNZ     NO_ALT_IDX

     1598    13340    1            THEN
     1599    13341    2            DO;

     1600    13342                                                /* CODE02:  KEYX, KEYL                */
     1601    13343    2               CODE$ = FPARAM$;

  13343 12 003521   000000 236000 xsym               LDQ     FPARAM$
        12 003522   200032 756100                    STQ     CODE$,,AUTO

     1602    13344    2               CALL XSF$LOCCODP(CODE$,2) ALTRET(NO_CODE_2_AGAIN);

  13344 12 003523   000035 236000 13                 LDQ     29
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:260  
        12 003524   200063 756100                    STQ     @LEN+3,,AUTO
        12 003525   200032 633500                    EPPR3   CODE$,,AUTO
        12 003526   200062 453500                    STP3    @LEN+2,,AUTO
        12 003527   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 003530   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 003531   000000 701000 xent               TSX1    XSF$LOCCODP
        12 003532   003607 702000 12                 TSX2    NO_CODE_2_AGAIN

     1603    13345    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13345 12 003533   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003534   000100 101500                    MRL     fill='000'O
        12 003535   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003536   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003537   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003540   000020 736000                    QLS     16
        12 003541   200000 036007                    ADLQ    65536,DL
        12 003542   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003543   200050 756100                    STQ     OLD_BUF$,,AUTO

     1604    13346    2               OLD_BUF$->TEXT$C.LEN = 36;

  13346 12 003544   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003545   000100 101400                    MRL     fill='000'O
        12 003546   000034 000004 13                 ADSC9   28                       cn=0,n=4
        12 003547   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1605    13347    2               OLD_BUF$->TEXT$C.STRING = '    Keyx    =         Keylen  =';

  13347 12 003550   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003551   000100 101500                    MRL     fill='000'O
        12 003552   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003553   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003554   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003555   040140 100400                    MLR     fill='040'O
        12 003556   000745 000037 11                 ADSC9   XTEND_STRINGS+231        cn=0,n=31
        12 003557   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:261  

     1606    13348    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(0),CODE$->CODE02.KEYX);

  13348 12 003560   200032 470500                    LDP0    CODE$,,AUTO
        12 003561   000003 236100                    LDQ     3,,PR0
        12 003562   000022 772000                    QRL     18
        12 003563   000000 235003                    LDA     0,DU
        12 003564   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003565   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003566   000100 301500                    BTD
        12 003567   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003570   100003 430005                    NDSC9   3,,PR1                   cn=2,s=nosgn,sf=0,n=5

     1607    13349    2               CALL BINCHAR(OLD_BUF$->NUM$ARY.N.NUM(1),CODE$->CODE02.KEYL);

  13349 12 003571   200032 470500                    LDP0    CODE$,,AUTO
        12 003572   000003 236100                    LDQ     3,,PR0
        12 003573   000011 772000                    QRL     9
        12 003574   000777 376007                    ANQ     511,DL
        12 003575   000000 235003                    LDA     0,DU
        12 003576   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003577   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003600   000100 301500                    BTD
        12 003601   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003602   100010 030005                    NDSC9   8,,PR1                   cn=0,s=nosgn,sf=0,n=5

     1608    13350    2               CALL FINISH_NUMARY_BUF(2);

  13350 12 003603   000035 236000 13                 LDQ     29
        12 003604   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 003605   005377 701000 12                 TSX1    FINISH_NUMARY_BUF
        12 003606   000000 011000                    NOP     0

  13349 12 003607                       NO_CODE_2_A* null
     1609    13351    2   NO_CODE_2_AGAIN: ;
     1610    13352                                                /* CODE08: alternate index            */
     1611    13353    2               CODE$ = FPARAM$;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:262  

  13353 12 003607   000000 236000 xsym               LDQ     FPARAM$
        12 003610   200032 756100                    STQ     CODE$,,AUTO

     1612    13354    2               CALL XSF$LOCCODP(CODE$,08) ALTRET(NO_ALT_IDX);

  13354 12 003611   000050 236000 13                 LDQ     40
        12 003612   200063 756100                    STQ     @LEN+3,,AUTO
        12 003613   200032 630500                    EPPR0   CODE$,,AUTO
        12 003614   200062 450500                    STP0    @LEN+2,,AUTO
        12 003615   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 003616   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 003617   000000 701000 xent               TSX1    XSF$LOCCODP
        12 003620   004016 702000 12                 TSX2    NO_ALT_IDX

     1613    13355    2               IF CODE$ -> FITALTKEYS.NUMENTS = 0

  13355 12 003621   200032 470500                    LDP0    CODE$,,AUTO
        12 003622   000000 236100                    LDQ     0,,PR0
        12 003623   000377 316003                    CANQ    255,DU
        12 003624   004016 600000 12                 TZE     NO_ALT_IDX

     1614    13356    2                THEN
     1615    13357    2                  GOTO NO_ALT_IDX;
     1616    13358    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13358 12 003625   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003626   000100 101500                    MRL     fill='000'O
        12 003627   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 003630   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003631   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003632   000020 736000                    QLS     16
        12 003633   200000 036007                    ADLQ    65536,DL
        12 003634   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003635   200050 756100                    STQ     OLD_BUF$,,AUTO

     1617    13359    2               OLD_BUF$ -> TEXT$C.LEN = 30;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:263  

  13359 12 003636   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003637   000100 101400                    MRL     fill='000'O
        12 003640   000051 000004 13                 ADSC9   41                       cn=0,n=4
        12 003641   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1618    13360    2               OLD_BUF$->TEXT$C.STRING = '    ----- Alternate keys -----';

  13360 12 003642   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003643   000100 101500                    MRL     fill='000'O
        12 003644   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003645   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003646   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003647   040140 100400                    MLR     fill='040'O
        12 003650   000755 000036 11                 ADSC9   XTEND_STRINGS+239        cn=0,n=30
        12 003651   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1619    13361    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13361 12 003652   000000 470400 xsym               LDP0    LIST_BUF$
        12 003653   000000 054100                    AOS     0,,PR0

     1620    13362    2               OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13362 12 003654   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003655   000100 101500                    MRL     fill='000'O
        12 003656   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003657   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003660   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003661   000020 736000                    QLS     16
        12 003662   200000 036007                    ADLQ    65536,DL
        12 003663   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003664   200050 756100                    STQ     OLD_BUF$,,AUTO

     1621    13363    2               OLD_BUF$ -> TEXT$C.LEN = 39;

  13363 12 003665   200050 470500                    LDP0    OLD_BUF$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:264  
        12 003666   000100 101400                    MRL     fill='000'O
        12 003667   000052 000004 13                 ADSC9   42                       cn=0,n=4
        12 003670   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1622    13364    2               OLD_BUF$->TEXT$C.STRING = '      Keyno      Keyx    Keylen  Unique';

  13364 12 003671   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003672   000100 101500                    MRL     fill='000'O
        12 003673   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003674   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003675   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003676   040140 100400                    MLR     fill='040'O
        12 003677   000765 000047 11                 ADSC9   XTEND_STRINGS+247        cn=0,n=39
        12 003700   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1623    13365    2               BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13365 12 003701   000000 470400 xsym               LDP0    LIST_BUF$
        12 003702   000000 054100                    AOS     0,,PR0

     1624    13366    3               DO I = 1 TO (CODE$ -> FITALTKEYS.NUMENTS -1);

  13366 12 003703   000001 235007                    LDA     1,DL
        12 003704   200034 755100                    STA     I,,AUTO
        12 003705   004010 710000 12                 TRA     s:13375+1

     1625    13367    3                  OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13367 12 003706   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003707   000100 101500                    MRL     fill='000'O
        12 003710   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003711   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 003712   200062 236100                    LDQ     @LEN+2,,AUTO
        12 003713   000020 736000                    QLS     16
        12 003714   200000 036007                    ADLQ    65536,DL
        12 003715   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 003716   200050 756100                    STQ     OLD_BUF$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:265  

     1626    13368    3                  OLD_BUF$ -> TEXT$C.LEN = 41;

  13368 12 003717   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003720   000100 101400                    MRL     fill='000'O
        12 003721   000053 000004 13                 ADSC9   43                       cn=0,n=4
        12 003722   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1627    13369    3                  OLD_BUF$ -> TEXT$C.STRING = ' ';

  13369 12 003723   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003724   000100 101500                    MRL     fill='000'O
        12 003725   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 003726   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 003727   200062 220100                    LDX0    @LEN+2,,AUTO
        12 003730   040140 100400                    MLR     fill='040'O
        12 003731   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 003732   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1628    13370    3                  CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(0),I+1);

  13370 12 003733   200034 235100                    LDA     I,,AUTO
        12 003734   000001 035007                    ADLA    1,DL
        12 003735   200062 755100                    STA     @LEN+2,,AUTO
        12 003736   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 003737   000100 301500                    BTD
        12 003740   200062 000004                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
        12 003741   000000 630010                    NDSC9   0,,PR0                   cn=3,s=nosgn,sf=0,n=8

     1629    13371    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(1),CODE$->FITALTKEYS.K.KEYX(I));

  13371 12 003742   200034 236100                    LDQ     I,,AUTO
        12 003743   000006 402007                    MPY     6,DL
        12 003744   200032 470500                    LDP0    CODE$,,AUTO
        12 003745   000003 236106                    LDQ     3,QL,PR0
        12 003746   777777 376007                    ANQ     -1,DL
        12 003747   000000 235003                    LDA     0,DU
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:266  
        12 003750   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003751   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003752   000100 301500                    BTD
        12 003753   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003754   100003 230010                    NDSC9   3,,PR1                   cn=1,s=nosgn,sf=0,n=8

     1630    13372    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(2),CODE$->FITALTKEYS.K.KEYL(I));

  13372 12 003755   200034 236100                    LDQ     I,,AUTO
        12 003756   000006 402007                    MPY     6,DL
        12 003757   200032 470500                    LDP0    CODE$,,AUTO
        12 003760   000001 236106                    LDQ     1,QL,PR0
        12 003761   000033 772000                    QRL     27
        12 003762   000000 235003                    LDA     0,DU
        12 003763   200062 757100                    STAQ    @LEN+2,,AUTO
        12 003764   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 003765   000100 301500                    BTD
        12 003766   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 003767   100005 630010                    NDSC9   5,,PR1                   cn=3,s=nosgn,sf=0,n=8

     1631    13373    3                 OLD_BUF$->COL$ARY.N.TXT(3) = TRUTH(BITBIN(CODE$->FITALTKEYS.K.UNIQUE(
             13373                           I)));

  13373 12 003770   200034 236100                    LDQ     I,,AUTO
        12 003771   000006 402007                    MPY     6,DL
        12 003772   200032 470500                    LDP0    CODE$,,AUTO
        12 003773   000004 236106                    LDQ     4,QL,PR0
        12 003774   000032 772000                    QRL     26
        12 003775   000001 376007                    ANQ     1,DL
        12 003776   000003 402007                    MPY     3,DL
        12 003777   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004000   040100 100406                    MLR     fill='040'O
        12 004001   000104 000003 11                 ADSC9   TRUTH,Q                  cn=0,n=3
        12 004002   100010 200010                    ADSC9   8,,PR1                   cn=1,n=8

     1632    13374    3                  CALL FINISH_COLARY_BUF(3);

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:267  
  13374 12 004003   000003 236000 13                 LDQ     3
        12 004004   200057 756100                    STQ     DENS_STR+4,,AUTO
        12 004005   005431 701000 12                 TSX1    FINISH_COLARY_BUF
        12 004006   000000 011000                    NOP     0

     1633    13375    3                  END;

  13375 12 004007   200034 054100                    AOS     I,,AUTO
        12 004010   200032 470500                    LDP0    CODE$,,AUTO
        12 004011   000000 236100                    LDQ     0,,PR0
        12 004012   000022 772000                    QRL     18
        12 004013   000377 376007                    ANQ     255,DL
        12 004014   200034 116100                    CMPQ    I,,AUTO
        12 004015   003706 605400 12                 TPNZ    s:13367

  13373 12 004016                       NO_ALT_IDX   null
     1634    13376    2   NO_ALT_IDX: ;
     1635    13377    2               END;

     1636    13378        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:268  
     1637    13379                                                /* CODE18: Field definitions          */
     1638    13380    1           CODE$ = FPARAM$;

  13380 12 004016   000000 236000 xsym               LDQ     FPARAM$
        12 004017   200032 756100                    STQ     CODE$,,AUTO

     1639    13381    1           CALL XSF$LOCCODP(CODE$,18) ALTRET(NO_CODE18);

  13381 12 004020   000054 236000 13                 LDQ     44
        12 004021   200063 756100                    STQ     @LEN+3,,AUTO
        12 004022   200032 630500                    EPPR0   CODE$,,AUTO
        12 004023   200062 450500                    STP0    @LEN+2,,AUTO
        12 004024   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 004025   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 004026   000000 701000 xent               TSX1    XSF$LOCCODP
        12 004027   005041 702000 12                 TSX2    NO_CODE18

     1640    13382    1           IF CODE$ -> CODE18.NFIELDS = 0

  13382 12 004030   200032 470500                    LDP0    CODE$,,AUTO
        12 004031   000000 236100                    LDQ     0,,PR0
        12 004032   000032 316000 xsym               CANQ    B_VECTNIL+26
        12 004033   005041 600000 12                 TZE     NO_CODE18

     1641    13383    1            THEN
     1642    13384    1              GOTO NO_CODE18;
     1643    13385    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13385 12 004034   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004035   000100 101500                    MRL     fill='000'O
        12 004036   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 004037   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 004040   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004041   000020 736000                    QLS     16
        12 004042   200000 036007                    ADLQ    65536,DL
        12 004043   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 004044   200050 756100                    STQ     OLD_BUF$,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:269  

     1644    13386    1           OLD_BUF$ -> TEXT$C.LEN = 33;

  13386 12 004045   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004046   000100 101400                    MRL     fill='000'O
        12 004047   000026 000004 13                 ADSC9   22                       cn=0,n=4
        12 004050   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1645    13387    1           OLD_BUF$->TEXT$C.STRING = '    ----- Field definitions -----';

  13387 12 004051   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004052   000100 101500                    MRL     fill='000'O
        12 004053   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004054   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 004055   200062 220100                    LDX0    @LEN+2,,AUTO
        12 004056   040140 100400                    MLR     fill='040'O
        12 004057   000777 000041 11                 ADSC9   XTEND_STRINGS+257        cn=0,n=33
        12 004060   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1646    13388    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13388 12 004061   000000 470400 xsym               LDP0    LIST_BUF$
        12 004062   000000 054100                    AOS     0,,PR0

     1647    13389    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13389 12 004063   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004064   000100 101500                    MRL     fill='000'O
        12 004065   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004066   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 004067   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004070   000020 736000                    QLS     16
        12 004071   200000 036007                    ADLQ    65536,DL
        12 004072   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 004073   200050 756100                    STQ     OLD_BUF$,,AUTO

     1648    13390    1           OLD_BUF$ -> TEXT$C.LEN = 61;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:270  

  13390 12 004074   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004075   000100 101400                    MRL     fill='000'O
        12 004076   000055 000004 13                 ADSC9   45                       cn=0,n=4
        12 004077   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1649    13391    1           DONT_PRINT=%NO#;

  13391 12 004100   200017 450100                    STZ     DONT_PRINT,,AUTO

     1650    13392    1           TCODE$=FPARAM$;

  13392 12 004101   000000 236000 xsym               LDQ     FPARAM$
        12 004102   200052 756100                    STQ     TCODE$,,AUTO

     1651    13393    1           K=21;

  13393 12 004103   000025 235007                    LDA     21,DL
        12 004104   200016 755100                    STA     K,,AUTO

     1652    13394    1           CALL XSF$LOCCODP(TCODE$,K)

  13394 12 004105   200016 630500                    EPPR0   K,,AUTO
        12 004106   200063 450500                    STP0    @LEN+3,,AUTO
        12 004107   200052 631500                    EPPR1   TCODE$,,AUTO
        12 004110   200062 451500                    STP1    @LEN+2,,AUTO
        12 004111   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 004112   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 004113   000000 701000 xent               TSX1    XSF$LOCCODP
        12 004114   004116 702000 12                 TSX2    s:13396
        12 004115   004120 710000 12                 TRA     s:13398

     1653    13395    2            WHENALTRETURN DO;

     1654    13396    2               TCODE$=ADDR(NIL);

  13396 12 004116   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:271  
        12 004117   200052 756100                    STQ     TCODE$,,AUTO

     1655    13397    2               END;

     1656    13398    1           OLD_BUF$->TEXT$C.STRING =
             13398                    '   Fieldno  Type         Start    Length  Units        Scale';

  13398 12 004120   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004121   000100 101500                    MRL     fill='000'O
        12 004122   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004123   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 004124   200062 220100                    LDX0    @LEN+2,,AUTO
        12 004125   040140 100400                    MLR     fill='040'O
        12 004126   001010 000074 11                 ADSC9   XTEND_STRINGS+266        cn=0,n=60
        12 004127   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1657    13399    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13399 12 004130   000000 470400 xsym               LDP0    LIST_BUF$
        12 004131   000000 054100                    AOS     0,,PR0

     1658    13400    1           OLD_BUF$=PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13400 12 004132   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004133   000100 101500                    MRL     fill='000'O
        12 004134   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004135   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 004136   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004137   000020 736000                    QLS     16
        12 004140   200000 036007                    ADLQ    65536,DL
        12 004141   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 004142   200050 756100                    STQ     OLD_BUF$,,AUTO

     1659    13401    1           OLD_BUF$->TEXT$C.LEN=61;

  13401 12 004143   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004144   000100 101400                    MRL     fill='000'O
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:272  
        12 004145   000055 000004 13                 ADSC9   45                       cn=0,n=4
        12 004146   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1660    13402    1           OLD_BUF$->TEXT$C.STRING=' ';

  13402 12 004147   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004150   000100 101500                    MRL     fill='000'O
        12 004151   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004152   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 004153   200062 220100                    LDX0    @LEN+2,,AUTO
        12 004154   040140 100400                    MLR     fill='040'O
        12 004155   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 004156   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1661    13403    1           OLD_BUF$ -> COL$ARY.N.TXT(0)=' Phy Log';

  13403 12 004157   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004160   040100 100400                    MLR     fill='040'O
        12 004161   001027 000010 11                 ADSC9   XTEND_STRINGS+281        cn=0,n=8
        12 004162   000000 600010                    ADSC9   0,,PR0                   cn=3,n=8

     1662    13404    1           OLD_BUF$ -> COL$ARY.N.TXT(2)='   w-c-b';

  13404 12 004163   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004164   040100 100400                    MLR     fill='040'O
        12 004165   001031 000010 11                 ADSC9   XTEND_STRINGS+283        cn=0,n=8
        12 004166   000005 600010                    ADSC9   5,,PR0                   cn=3,n=8

     1663    13405    1           BUF_BLOCK.COUNT=BUF_BLOCK.COUNT+1;

  13405 12 004167   000000 470400 xsym               LDP0    LIST_BUF$
        12 004170   000000 054100                    AOS     0,,PR0

     1664    13406    2           DO I = 0 TO CODE$ -> CODE18.NFIELDS -1;

  13406 12 004171   200034 450100                    STZ     I,,AUTO
        12 004172   005034 710000 12                 TRA     s:13483+1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:273  

     1665    13407    2              J = 0;

  13407 12 004173   200035 450100                    STZ     J,,AUTO

     1666    13408    3              DO WHILE (J < 63

  13408 12 004174   004176 710000 12                 TRA     s:13411

     1667    13409    3                AND TYPE_ARY.CODE(J) ~= CODE$ -> CODE18.FIELD.TYPE(I));
     1668    13410    3                 J = J +1;

  13410 12 004175   200035 054100                    AOS     J,,AUTO

     1669    13411    3                 END;

  13411 12 004176   200035 235100                    LDA     J,,AUTO
        12 004177   000077 115007                    CMPA    63,DL
        12 004200   004222 605000 12                 TPL     s:13412
        12 004201   200034 236100                    LDQ     I,,AUTO
        12 004202   000003 402007                    MPY     3,DL
        12 004203   000000 116003                    CMPQ    0,DU
        12 004204   004206 605000 12                 TPL     s:13411+8
        12 004205   000006 036003                    ADLQ    6,DU
        12 004206   200032 470500                    LDP0    CODE$,,AUTO
        12 004207   000100 101506                    MRL     fill='000'O
        12 004210   000001 020001                    ADSC6   1,Q,PR0                  cn=0,n=1
        12 004211   200062 020006                    ADSC6   @LEN+2,,AUTO             cn=0,n=6
        12 004212   200035 236100                    LDQ     J,,AUTO
        12 004213   000013 402007                    MPY     11,DL
        12 004214   000100 101406                    MRL     fill='000'O
        12 004215   000122 000001 11                 ADSC9   TYPE_ARY+2,Q             cn=0,n=1
        12 004216   200063 000004                    ADSC9   @LEN+3,,AUTO             cn=0,n=4
        12 004217   200063 236100                    LDQ     @LEN+3,,AUTO
        12 004220   200062 116100                    CMPQ    @LEN+2,,AUTO
        12 004221   004175 601000 12                 TNZ     s:13410

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:274  
     1670    13412    2              OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13412 12 004222   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004223   000100 101500                    MRL     fill='000'O
        12 004224   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004225   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 004226   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004227   000020 736000                    QLS     16
        12 004230   200000 036007                    ADLQ    65536,DL
        12 004231   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 004232   200050 756100                    STQ     OLD_BUF$,,AUTO

     1671    13413    2              CALL CHECK_BUF(OLD_BUF$,61);

  13413 12 004233   000056 236000 13                 LDQ     46
        12 004234   200060 756100                    STQ     @NAME$+1,,AUTO
        12 004235   200050 630500                    EPPR0   OLD_BUF$,,AUTO
        12 004236   200057 450500                    STP0    DENS_STR+4,,AUTO
        12 004237   005337 701000 12                 TSX1    CHECK_BUF
        12 004240   000000 011000                    NOP     0

     1672    13414    2              OLD_BUF$ -> TEXT$C.LEN = 61;

  13414 12 004241   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004242   000100 101400                    MRL     fill='000'O
        12 004243   000055 000004 13                 ADSC9   45                       cn=0,n=4
        12 004244   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1673    13415    2              OLD_BUF$ -> TEXT$C.STRING = ' ';

  13415 12 004245   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004246   000100 101500                    MRL     fill='000'O
        12 004247   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004250   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 004251   200062 220100                    LDX0    @LEN+2,,AUTO
        12 004252   040140 100400                    MLR     fill='040'O
        12 004253   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:275  
        12 004254   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1674    13416    2              CALL BINCHAR(TFIELD1,I);

  13416 12 004255   000100 301500                    BTD
        12 004256   200034 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
        12 004257   200012 030003                    NDSC9   TFIELD1,,AUTO            cn=0,s=nosgn,sf=0,n=3

     1675    13417    2              CALL VPD$CLOBBERLZ (VECTOR(TFIELD1));

  13417 12 004260   577640 235007                    LDA     -65632,DL
        12 004261   200062 452500                    STP2    @LEN+2,,AUTO
        12 004262   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004263   000012 036003                    ADLQ    10,DU
        12 004264   200064 757100                    STAQ    @LEN+4,,AUTO
        12 004265   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 004266   200066 450500                    STP0    @LEN+6,,AUTO
        12 004267   200066 630500                    EPPR0   @LEN+6,,AUTO
        12 004270   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 004271   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 004272   000000 011000                    NOP     0

     1676    13418    2              TFIELD2=' ';

  13418 12 004273   000057 236000 13                 LDQ     47
        12 004274   200013 756100                    STQ     TFIELD2,,AUTO

     1677    13419    3              IF TCODE$~=ADDR(NIL) THEN DO;

  13419 12 004275   200052 236100                    LDQ     TCODE$,,AUTO
        12 004276   000001 116000 xsym               CMPQ    B_VECTNIL+1
        12 004277   004347 600000 12                 TZE     s:13429

     1678    13420    3                  K=0;

  13420 12 004300   200016 450100                    STZ     K,,AUTO

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:276  
     1679    13421    4                  DO WHILE (K<TCODE$->CODE21.NFIELDS AND TCODE$->CODE21.FIELDN(K)~=I);

  13421 12 004301   004305 710000 12                 TRA     s:13423

     1680    13422    4                     K=K+1;

  13422 12 004302   200016 235100                    LDA     K,,AUTO
        12 004303   000001 035007                    ADLA    1,DL
        12 004304   200016 755100                    STA     K,,AUTO

     1681    13423    4                     END;

  13423 12 004305   200052 470500                    LDP0    TCODE$,,AUTO
        12 004306   000000 236100                    LDQ     0,,PR0
        12 004307   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 004310   200016 116100                    CMPQ    K,,AUTO
        12 004311   004322 602000 12                 TNC     s:13424
        12 004312   004322 600000 12                 TZE     s:13424
        12 004313   200016 235100                    LDA     K,,AUTO
        12 004314   000100 101505                    MRL     fill='000'O
        12 004315   000001 000001                    ADSC9   1,A,PR0                  cn=0,n=1
        12 004316   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 004317   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004320   200034 116100                    CMPQ    I,,AUTO
        12 004321   004302 601000 12                 TNZ     s:13422

     1682    13424    4                  IF K~=TCODE$->CODE21.NFIELDS THEN DO;

  13424 12 004322   000000 236100                    LDQ     0,,PR0
        12 004323   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 004324   200016 116100                    CMPQ    K,,AUTO
        12 004325   004347 600000 12                 TZE     s:13429

     1683    13425    4                      CALL BINCHAR(TFIELD2,K);

  13425 12 004326   200016 235100                    LDA     K,,AUTO
        12 004327   000044 773000                    LRL     36
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:277  
        12 004330   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004331   000100 301500                    BTD
        12 004332   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 004333   200013 030003                    NDSC9   TFIELD2,,AUTO            cn=0,s=nosgn,sf=0,n=3

     1684    13426    4                      CALL VPD$CLOBBERLZ(VECTOR(TFIELD2));

  13426 12 004334   577640 235007                    LDA     -65632,DL
        12 004335   200062 452500                    STP2    @LEN+2,,AUTO
        12 004336   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004337   000013 036003                    ADLQ    11,DU
        12 004340   200064 757100                    STAQ    @LEN+4,,AUTO
        12 004341   200064 631500                    EPPR1   @LEN+4,,AUTO
        12 004342   200066 451500                    STP1    @LEN+6,,AUTO
        12 004343   200066 630500                    EPPR0   @LEN+6,,AUTO
        12 004344   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 004345   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 004346   000000 011000                    NOP     0

     1685    13427    4                      END;

     1686    13428    3                  END;

     1687    13429    2              CALL CONCAT(OLD_BUF$->COL$ARY.N.TXT(0),' ',TFIELD1,' ',TFIELD2);

  13429 12 004347   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004350   040100 100400                    MLR     fill='040'O
        12 004351   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 004352   000000 600001                    ADSC9   0,,PR0                   cn=3,n=1
        12 004353   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004354   040100 100500                    MLR     fill='040'O
        12 004355   200012 000003                    ADSC9   TFIELD1,,AUTO            cn=0,n=3
        12 004356   000001 000003                    ADSC9   1,,PR0                   cn=0,n=3
        12 004357   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004360   040100 100400                    MLR     fill='040'O
        12 004361   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 004362   000001 600001                    ADSC9   1,,PR0                   cn=3,n=1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:278  
        12 004363   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004364   040100 100500                    MLR     fill='040'O
        12 004365   200013 000003                    ADSC9   TFIELD2,,AUTO            cn=0,n=3
        12 004366   000002 000003                    ADSC9   2,,PR0                   cn=0,n=3

     1688    13430    2              OLD_BUF$->COL$ARY.N.TXT(1) = TYPE_ARY.NAME(J);

  13430 12 004367   200035 236100                    LDQ     J,,AUTO
        12 004370   000013 402007                    MPY     11,DL
        12 004371   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004372   040100 100406                    MLR     fill='040'O
        12 004373   000120 000010 11                 ADSC9   TYPE_ARY,Q               cn=0,n=8
        12 004374   000003 200010                    ADSC9   3,,PR0                   cn=1,n=8

     1689    13431    2              OLD_BUF$->COL$ARY.N.TXT(4) = UNITS(TYPE_ARY.UNITS(J));

  13431 12 004375   000100 101406                    MRL     fill='000'O
        12 004376   000122 400001 11                 ADSC9   TYPE_ARY+2,Q             cn=2,n=1
        12 004377   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 004400   200062 220100                    LDX0    @LEN+2,,AUTO
        12 004401   000000 635010                    EAA     0,X0
        12 004402   000017 771000                    ARL     15
        12 004403   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004404   040100 100405                    MLR     fill='040'O
        12 004405   000106 000010 11                 ADSC9   UNITS,A                  cn=0,n=8
        12 004406   000012 600010                    ADSC9   10,,PR0                  cn=3,n=8

     1690    13432    3              IF DONT_PRINT THEN DO;

  13432 12 004407   200017 234100                    SZN     DONT_PRINT,,AUTO
        12 004410   004416 605000 12                 TPL     s:13436

     1691    13433    3                  DONT_PRINT=%NO#;

  13433 12 004411   200017 450100                    STZ     DONT_PRINT,,AUTO

     1692    13434    3                  OLD_BUF$->COL$ARY.N.TXT(0)=' ';
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:279  

  13434 12 004412   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004413   040100 100400                    MLR     fill='040'O
        12 004414   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 004415   000000 600010                    ADSC9   0,,PR0                   cn=3,n=8

     1693    13435    3                  END;

     1694    13436    2              F$=PINCRW(B$ROS$,M$EI$->F$DCB.STARTX);

  13436 12 004416   000000 470400 xsym               LDP0    M$EI$
        12 004417   000057 220100                    LDX0    47,,PR0
        12 004420   000000 636010                    EAQ     0,X0
        12 004421   000000 036000 xsym               ADLQ    B$ROS$
        12 004422   200014 756100                    STQ     F$,,AUTO

     1695    13437    2              LEN_WRDS=F$->FM$FIELD_START.OFFSET(I)/36; /* compute length in words */

  13437 12 004423   200014 471500                    LDP1    F$,,AUTO
        12 004424   200034 721100                    LXL1    I,,AUTO
        12 004425   100001 236111                    LDQ     1,X1,PR1
        12 004426   000044 506007                    DIV     36,DL
        12 004427   200004 756100                    STQ     LEN_WRDS,,AUTO

     1696    13438    2              CALL BINCHAR(TWRDS,LEN_WRDS);

  13438 12 004430   000000 235003                    LDA     0,DU
        12 004431   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004432   000100 301500                    BTD
        12 004433   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 004434   200005 030004                    NDSC9   TWRDS,,AUTO              cn=0,s=nosgn,sf=0,n=4

     1697    13439    2              CALL VPD$CLOBBERLZ(VECTOR(TWRDS));

  13439 12 004435   777640 235007                    LDA     -96,DL
        12 004436   200062 452500                    STP2    @LEN+2,,AUTO
        12 004437   200062 236100                    LDQ     @LEN+2,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:280  
        12 004440   000005 036003                    ADLQ    5,DU
        12 004441   200064 757100                    STAQ    @LEN+4,,AUTO
        12 004442   200064 633500                    EPPR3   @LEN+4,,AUTO
        12 004443   200066 453500                    STP3    @LEN+6,,AUTO
        12 004444   200066 630500                    EPPR0   @LEN+6,,AUTO
        12 004445   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 004446   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 004447   000000 011000                    NOP     0

     1698    13440    2              LEN_BYTES=(F$->FM$FIELD_START.OFFSET(I)-LEN_WRDS*36)/9;

  13440 12 004450   200014 470500                    LDP0    F$,,AUTO
        12 004451   200034 720100                    LXL0    I,,AUTO
        12 004452   000000 236003                    LDQ     0,DU
        12 004453   200004 136100                    SBLQ    LEN_WRDS,,AUTO
        12 004454   000044 402007                    MPY     36,DL
        12 004455   000001 036110                    ADLQ    1,X0,PR0
        12 004456   000011 506007                    DIV     9,DL
        12 004457   200006 756100                    STQ     LEN_BYTES,,AUTO

     1699    13441    2              CALL BINCHAR(TBYTES,LEN_BYTES);

  13441 12 004460   000000 235003                    LDA     0,DU
        12 004461   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004462   000100 301500                    BTD
        12 004463   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 004464   200007 030001                    NDSC9   TBYTES,,AUTO             cn=0,s=nosgn,sf=0,n=1

     1700    13442    2              LEN_BITS=F$->FM$FIELD_START.OFFSET(I)-(LEN_WRDS*36+LEN_BYTES*9);

  13442 12 004465   200004 236100                    LDQ     LEN_WRDS,,AUTO
        12 004466   000002 736000                    QLS     2
        12 004467   200006 036100                    ADLQ    LEN_BYTES,,AUTO
        12 004470   000060 402000 13                 MPY     48
        12 004471   000001 036110                    ADLQ    1,X0,PR0
        12 004472   200010 756100                    STQ     LEN_BITS,,AUTO

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:281  
     1701    13443    2              CALL BINCHAR(TBITS,LEN_BITS);

  13443 12 004473   000000 235003                    LDA     0,DU
        12 004474   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004475   000100 301500                    BTD
        12 004476   200062 000010                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 004477   200011 030001                    NDSC9   TBITS,,AUTO              cn=0,s=nosgn,sf=0,n=1

     1702    13444    2              CALL CONCAT(OLD_BUF$->COL$ARY.N.TXT(2),TWRDS,'-',TBYTES,'-',TBITS);

  13444 12 004500   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004501   040100 100500                    MLR     fill='040'O
        12 004502   200005 000004                    ADSC9   TWRDS,,AUTO              cn=0,n=4
        12 004503   100005 600004                    ADSC9   5,,PR1                   cn=3,n=4
        12 004504   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004505   040100 100400                    MLR     fill='040'O
        12 004506   000061 000001 13                 ADSC9   49                       cn=0,n=1
        12 004507   100006 600001                    ADSC9   6,,PR1                   cn=3,n=1
        12 004510   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004511   040100 100500                    MLR     fill='040'O
        12 004512   200007 000001                    ADSC9   TBYTES,,AUTO             cn=0,n=1
        12 004513   100007 000001                    ADSC9   7,,PR1                   cn=0,n=1
        12 004514   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004515   040100 100400                    MLR     fill='040'O
        12 004516   000061 000001 13                 ADSC9   49                       cn=0,n=1
        12 004517   100007 200001                    ADSC9   7,,PR1                   cn=1,n=1
        12 004520   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004521   040100 100500                    MLR     fill='040'O
        12 004522   200011 000001                    ADSC9   TBITS,,AUTO              cn=0,n=1
        12 004523   100007 400001                    ADSC9   7,,PR1                   cn=2,n=1

     1703    13445    3              DO CASE (TYPE_ARY.CLASS(J));

  13445 12 004524   200035 236100                    LDQ     J,,AUTO
        12 004525   000013 402007                    MPY     11,DL
        12 004526   000100 101406                    MRL     fill='000'O
        12 004527   000122 200001 11                 ADSC9   TYPE_ARY+2,Q             cn=1,n=1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:282  
        12 004530   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 004531   200062 220100                    LDX0    @LEN+2,,AUTO
        12 004532   000006 100003                    CMPX0   6,DU
        12 004533   004535 602010 12                 TNC     s:13445+9,X0
        12 004534   005031 710000 12                 TRA     s:13482
        12 004535   005031 710000 12                 TRA     s:13482
        12 004536   004543 710000 12                 TRA     s:13449
        12 004537   004602 710000 12                 TRA     s:13453
        12 004540   004724 710000 12                 TRA     s:13469
        12 004541   005031 710000 12                 TRA     s:13482
        12 004542   004765 710000 12                 TRA     s:13476

     1704    13446    3               CASE(0);                    /* Currently unused                   */

     1705    13447    3                 ;
     1706    13448    3               CASE(1);                    /* FIELD                              */

     1707    13449    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.FIELD.LEN(I));

  13449 12 004543   200034 236100                    LDQ     I,,AUTO
        12 004544   000003 402007                    MPY     3,DL
        12 004545   000000 116003                    CMPQ    0,DU
        12 004546   004550 605000 12                 TPL     s:13449+5
        12 004547   000006 036003                    ADLQ    6,DU
        12 004550   200032 470500                    LDP0    CODE$,,AUTO
        12 004551   000100 101506                    MRL     fill='000'O
        12 004552   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
        12 004553   200062 020006                    ADSC6   @LEN+2,,AUTO             cn=0,n=6
        12 004554   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004555   000000 235003                    LDA     0,DU
        12 004556   200064 757100                    STAQ    @LEN+4,,AUTO
        12 004557   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004560   000100 301500                    BTD
        12 004561   200064 000010                    NDSC9   @LEN+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 004562   100010 230010                    NDSC9   8,,PR1                   cn=1,s=nosgn,sf=0,n=8

     1708    13450    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:283  

  13450 12 004563   000017 235000 13                 LDA     15
        12 004564   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 004565   000062 036000 13                 ADLQ    50
        12 004566   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004567   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 004570   200064 450500                    STP0    @LEN+4,,AUTO
        12 004571   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 004572   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 004573   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 004574   000000 011000                    NOP     0

     1709    13451    3                 OLD_BUF$->COL$ARY.N.TXT(5)='     N/A';

  13451 12 004575   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004576   040100 100400                    MLR     fill='040'O
        12 004577   001033 000010 11                 ADSC9   XTEND_STRINGS+285        cn=0,n=8
        12 004600   000015 200010                    ADSC9   13,,PR0                  cn=1,n=8
        12 004601   005031 710000 12                 TRA     s:13482

     1710    13452    3               CASE(2);                    /* DECFIELD                           */

     1711    13453    3                CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.DECFIELD.LEN(I))
             13453                          ;

  13453 12 004602   200034 236100                    LDQ     I,,AUTO
        12 004603   000003 402007                    MPY     3,DL
        12 004604   000000 116003                    CMPQ    0,DU
        12 004605   004607 605000 12                 TPL     s:13453+5
        12 004606   000006 036003                    ADLQ    6,DU
        12 004607   200032 470500                    LDP0    CODE$,,AUTO
        12 004610   000100 101506                    MRL     fill='000'O
        12 004611   000001 120001                    ADSC6   1,Q,PR0                  cn=1,n=1
        12 004612   200062 020006                    ADSC6   @LEN+2,,AUTO             cn=0,n=6
        12 004613   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004614   000000 235003                    LDA     0,DU
        12 004615   200064 757100                    STAQ    @LEN+4,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:284  
        12 004616   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004617   000100 301500                    BTD
        12 004620   200064 000010                    NDSC9   @LEN+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 004621   100010 230010                    NDSC9   8,,PR1                   cn=1,s=nosgn,sf=0,n=8

     1712    13454    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));

  13454 12 004622   000017 235000 13                 LDA     15
        12 004623   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 004624   000062 036000 13                 ADLQ    50
        12 004625   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004626   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 004627   200064 450500                    STP0    @LEN+4,,AUTO
        12 004630   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 004631   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 004632   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 004633   000000 011000                    NOP     0

     1713    13455    3                 TEMP=CODE$->CODE18.DECFIELD.SCALE(I);

  13455 12 004634   200034 236100                    LDQ     I,,AUTO
        12 004635   000003 402007                    MPY     3,DL
        12 004636   000000 116003                    CMPQ    0,DU
        12 004637   004641 605000 12                 TPL     s:13455+5
        12 004640   000006 036003                    ADLQ    6,DU
        12 004641   200032 470500                    LDP0    CODE$,,AUTO
        12 004642   000100 100506                    MLR     fill='000'O
        12 004643   000001 220001                    ADSC6   1,Q,PR0                  cn=2,n=1
        12 004644   200062 020006                    ADSC6   @LEN+2,,AUTO             cn=0,n=6
        12 004645   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004646   000036 732000                    QRS     30
        12 004647   200020 756100                    STQ     TEMP,,AUTO

     1714    13456    3                 IF TEMP<0 THEN

  13456 12 004650   004660 605000 12                 TPL     s:13459

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:285  
     1715    13457    3                    CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(5),-TEMP);

  13457 12 004651   200020 335100                    LCA     TEMP,,AUTO
        12 004652   200062 755100                    STA     @LEN+2,,AUTO
        12 004653   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004654   000100 301500                    BTD
        12 004655   200062 000004                    NDSC9   @LEN+2,,AUTO             cn=0,s=lsgnf,sf=0,n=4
        12 004656   100015 230010                    NDSC9   13,,PR1                  cn=1,s=nosgn,sf=0,n=8
        12 004657   004664 710000 12                 TRA     s:13460

     1716    13458    3                  ELSE
     1717    13459    3                    CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(5),TEMP);

  13459 12 004660   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004661   000100 301500                    BTD
        12 004662   200020 000004                    NDSC9   TEMP,,AUTO               cn=0,s=lsgnf,sf=0,n=4
        12 004663   100015 230010                    NDSC9   13,,PR1                  cn=1,s=nosgn,sf=0,n=8

     1718    13460    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(5)));

  13460 12 004664   000017 235000 13                 LDA     15
        12 004665   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 004666   000063 036000 13                 ADLQ    51
        12 004667   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004670   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 004671   200064 450500                    STP0    @LEN+4,,AUTO
        12 004672   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 004673   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 004674   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 004675   000000 011000                    NOP     0

     1719    13461    4                 IF TEMP<0 THEN DO;

  13461 12 004676   200020 235100                    LDA     TEMP,,AUTO
        12 004677   005031 605000 12                 TPL     s:13482

     1720    13462    4                     P$=PINCRW(ADDR(OLD_BUF$->COL$ARY.N(5)),2);
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:286  
             13462                              /* Columns are two words long */

  13462 12 004700   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 004701   000064 036000 13                 ADLQ    52
        12 004702   200015 756100                    STQ     P$,,AUTO

     1721    13463    5                     DO WHILE P$->BASED_CHAR~=' ';

  13463 12 004703   200015 470500                    LDP0    P$,,AUTO
        12 004704   040000 106500                    CMPC    fill='040'O
        12 004705   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004706   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 004707   004720 600000 12                 TZE     s:13466

     1722    13464    5                        P$=PINCRC(P$,-1);  /* Back up one char                   */

  13464 12 004710   200015 236100                    LDQ     P$,,AUTO
        12 004711   000034 036000 xsym               ADLQ    B_VECTNIL+28
        12 004712   200015 756100                    STQ     P$,,AUTO

     1723    13465    5                        END;

  13465 12 004713   200015 470500                    LDP0    P$,,AUTO
        12 004714   040000 106500                    CMPC    fill='040'O
        12 004715   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 004716   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 004717   004710 601000 12                 TNZ     s:13464

     1724    13466    4                     P$->BASED_CHAR='-';   /* Let user know scale is neg.        */

  13466 12 004720   040100 100400                    MLR     fill='040'O
        12 004721   000061 000001 13                 ADSC9   49                       cn=0,n=1
        12 004722   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1725    13467    4                     END;

  13467 12 004723   005031 710000 12                 TRA     s:13482
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:287  

     1726    13468    3               CASE(3);                    /* LIST                               */

     1727    13469    3                 DONT_PRINT=%YES#;

  13469 12 004724   400000 236003                    LDQ     -131072,DU
        12 004725   200017 756100                    STQ     DONT_PRINT,,AUTO

     1728    13470    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.FIELD.LEN(I));

  13470 12 004726   200034 236100                    LDQ     I,,AUTO
        12 004727   000003 402007                    MPY     3,DL
        12 004730   000000 116003                    CMPQ    0,DU
        12 004731   004733 605000 12                 TPL     s:13470+5
        12 004732   000006 036003                    ADLQ    6,DU
        12 004733   200032 470500                    LDP0    CODE$,,AUTO
        12 004734   000100 101506                    MRL     fill='000'O
        12 004735   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
        12 004736   200062 020006                    ADSC6   @LEN+2,,AUTO             cn=0,n=6
        12 004737   200062 236100                    LDQ     @LEN+2,,AUTO
        12 004740   000000 235003                    LDA     0,DU
        12 004741   200064 757100                    STAQ    @LEN+4,,AUTO
        12 004742   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 004743   000100 301500                    BTD
        12 004744   200064 000010                    NDSC9   @LEN+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 004745   100010 230010                    NDSC9   8,,PR1                   cn=1,s=nosgn,sf=0,n=8

     1729    13471    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));

  13471 12 004746   000017 235000 13                 LDA     15
        12 004747   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 004750   000062 036000 13                 ADLQ    50
        12 004751   200062 757100                    STAQ    @LEN+2,,AUTO
        12 004752   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 004753   200064 450500                    STP0    @LEN+4,,AUTO
        12 004754   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 004755   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:288  
        12 004756   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 004757   000000 011000                    NOP     0

     1730    13472    3                 OLD_BUF$->COL$ARY.N.TXT(5)='     N/A';

  13472 12 004760   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 004761   040100 100400                    MLR     fill='040'O
        12 004762   001033 000010 11                 ADSC9   XTEND_STRINGS+285        cn=0,n=8
        12 004763   000015 200010                    ADSC9   13,,PR0                  cn=1,n=8
        12 004764   005031 710000 12                 TRA     s:13482

     1731    13473    3               CASE(4);                    /* Unknown format                     */

     1732    13474    3                 ;
     1733    13475    3               CASE(5);                    /* VLIST format                       */

     1734    13476    3                 DONT_PRINT=%YES#;

  13476 12 004765   400000 236003                    LDQ     -131072,DU
        12 004766   200017 756100                    STQ     DONT_PRINT,,AUTO

     1735    13477    3                 CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(3),CODE$->CODE18.FIELD.LEN(I));

  13477 12 004767   200034 236100                    LDQ     I,,AUTO
        12 004770   000003 402007                    MPY     3,DL
        12 004771   000000 116003                    CMPQ    0,DU
        12 004772   004774 605000 12                 TPL     s:13477+5
        12 004773   000006 036003                    ADLQ    6,DU
        12 004774   200032 470500                    LDP0    CODE$,,AUTO
        12 004775   000100 101506                    MRL     fill='000'O
        12 004776   000001 120002                    ADSC6   1,Q,PR0                  cn=1,n=2
        12 004777   200062 020006                    ADSC6   @LEN+2,,AUTO             cn=0,n=6
        12 005000   200062 236100                    LDQ     @LEN+2,,AUTO
        12 005001   000000 235003                    LDA     0,DU
        12 005002   200064 757100                    STAQ    @LEN+4,,AUTO
        12 005003   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 005004   000100 301500                    BTD
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:289  
        12 005005   200064 000010                    NDSC9   @LEN+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 005006   100010 230010                    NDSC9   8,,PR1                   cn=1,s=nosgn,sf=0,n=8

     1736    13478    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(3)));

  13478 12 005007   000017 235000 13                 LDA     15
        12 005010   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 005011   000062 036000 13                 ADLQ    50
        12 005012   200062 757100                    STAQ    @LEN+2,,AUTO
        12 005013   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 005014   200064 450500                    STP0    @LEN+4,,AUTO
        12 005015   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 005016   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 005017   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 005020   000000 011000                    NOP     0

     1737    13479    3                 SUBSTR(OLD_BUF$->COL$ARY.N.TXT(3),0,3)='  @';

  13479 12 005021   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005022   040100 100400                    MLR     fill='040'O
        12 005023   001035 000003 11                 ADSC9   XTEND_STRINGS+287        cn=0,n=3
        12 005024   000010 200003                    ADSC9   8,,PR0                   cn=1,n=3

     1738    13480    3                 OLD_BUF$->COL$ARY.N.TXT(5)='     N/A';

  13480 12 005025   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005026   040100 100400                    MLR     fill='040'O
        12 005027   001033 000010 11                 ADSC9   XTEND_STRINGS+285        cn=0,n=8
        12 005030   000015 200010                    ADSC9   13,,PR0                  cn=1,n=8

     1739    13481    3               END;                        /* END CASE                           */

     1740    13482    2              BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13482 12 005031   000000 470400 xsym               LDP0    LIST_BUF$
        12 005032   000000 054100                    AOS     0,,PR0

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:290  
     1741    13483    2              END;                         /* END INDEX                          */

  13483 12 005033   200034 054100                    AOS     I,,AUTO
        12 005034   200032 470500                    LDP0    CODE$,,AUTO
        12 005035   000000 236100                    LDQ     0,,PR0
        12 005036   000032 376000 xsym               ANQ     B_VECTNIL+26
        12 005037   200034 116100                    CMPQ    I,,AUTO
        12 005040   004173 605400 12                 TPNZ    s:13407

  13479 12 005041                       NO_CODE18    null
     1742    13484    1   NO_CODE18: ;
     1743    13485        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:291  
     1744    13486                                                /* CODE19: Key definitions            */
     1745    13487    1           CODE$ = FPARAM$;

  13487 12 005041   000000 236000 xsym               LDQ     FPARAM$
        12 005042   200032 756100                    STQ     CODE$,,AUTO

     1746    13488    1           CALL XSF$LOCCODP(CODE$,19) ALTRET(NO_CODE19);

  13488 12 005043   000066 236000 13                 LDQ     54
        12 005044   200063 756100                    STQ     @LEN+3,,AUTO
        12 005045   200032 630500                    EPPR0   CODE$,,AUTO
        12 005046   200062 450500                    STP0    @LEN+2,,AUTO
        12 005047   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 005050   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 005051   000000 701000 xent               TSX1    XSF$LOCCODP
        12 005052   005336 702000 12                 TSX2    NO_CODE19

     1747    13489    1           IF CODE$ -> CODE19.NKEYS = 0

  13489 12 005053   200032 470500                    LDP0    CODE$,,AUTO
        12 005054   000000 235100                    LDA     0,,PR0
        12 005055   005336 600000 12                 TZE     NO_CODE19

     1748    13490    1            THEN
     1749    13491    1              GOTO NO_CODE19;
     1750    13492    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13492 12 005056   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 005057   000100 101500                    MRL     fill='000'O
        12 005060   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        12 005061   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 005062   200062 236100                    LDQ     @LEN+2,,AUTO
        12 005063   000020 736000                    QLS     16
        12 005064   200000 036007                    ADLQ    65536,DL
        12 005065   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 005066   200050 756100                    STQ     OLD_BUF$,,AUTO

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:292  
     1751    13493    1           OLD_BUF$ -> TEXT$C.LEN = 31;

  13493 12 005067   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 005070   000100 101400                    MRL     fill='000'O
        12 005071   000067 000004 13                 ADSC9   55                       cn=0,n=4
        12 005072   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1752    13494    1           OLD_BUF$->TEXT$C.STRING = '    ----- Key definitions -----';

  13494 12 005073   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005074   000100 101500                    MRL     fill='000'O
        12 005075   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 005076   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 005077   200062 220100                    LDX0    @LEN+2,,AUTO
        12 005100   040140 100400                    MLR     fill='040'O
        12 005101   001036 000037 11                 ADSC9   XTEND_STRINGS+288        cn=0,n=31
        12 005102   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1753    13495    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13495 12 005103   000000 470400 xsym               LDP0    LIST_BUF$
        12 005104   000000 054100                    AOS     0,,PR0

     1754    13496    1           OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13496 12 005105   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005106   000100 101500                    MRL     fill='000'O
        12 005107   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 005110   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 005111   200062 236100                    LDQ     @LEN+2,,AUTO
        12 005112   000020 736000                    QLS     16
        12 005113   200000 036007                    ADLQ    65536,DL
        12 005114   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 005115   200050 756100                    STQ     OLD_BUF$,,AUTO

     1755    13497    1           OLD_BUF$ -> TEXT$C.LEN = 28;

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:293  
  13497 12 005116   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005117   000100 101400                    MRL     fill='000'O
        12 005120   000070 000004 13                 ADSC9   56                       cn=0,n=4
        12 005121   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1756    13498    1           OLD_BUF$->TEXT$C.STRING = '       Keyno   Unique Fields';

  13498 12 005122   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005123   000100 101500                    MRL     fill='000'O
        12 005124   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 005125   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 005126   200062 220100                    LDX0    @LEN+2,,AUTO
        12 005127   040140 100400                    MLR     fill='040'O
        12 005130   001046 000034 11                 ADSC9   XTEND_STRINGS+296        cn=0,n=28
        12 005131   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1757    13499    1           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13499 12 005132   000000 470400 xsym               LDP0    LIST_BUF$
        12 005133   000000 054100                    AOS     0,,PR0

     1758    13500    1           J = 0;                          /* Index into fragment array          */

  13500 12 005134   200035 450100                    STZ     J,,AUTO

     1759    13501    2           DO I = 0 TO CODE$ -> CODE19.NKEYS -1;

  13501 12 005135   200034 450100                    STZ     I,,AUTO
        12 005136   005331 710000 12                 TRA     s:13524+1

     1760    13502    2              OLD_BUF$ = PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1);

  13502 12 005137   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005140   000100 101500                    MRL     fill='000'O
        12 005141   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 005142   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 005143   200062 236100                    LDQ     @LEN+2,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:294  
        12 005144   000020 736000                    QLS     16
        12 005145   200000 036007                    ADLQ    65536,DL
        12 005146   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 005147   200050 756100                    STQ     OLD_BUF$,,AUTO

     1761    13503    2              CALL CHECK_BUF(OLD_BUF$,51);

  13503 12 005150   000072 236000 13                 LDQ     58
        12 005151   200060 756100                    STQ     @NAME$+1,,AUTO
        12 005152   200050 630500                    EPPR0   OLD_BUF$,,AUTO
        12 005153   200057 450500                    STP0    DENS_STR+4,,AUTO
        12 005154   005337 701000 12                 TSX1    CHECK_BUF
        12 005155   000000 011000                    NOP     0

     1762    13504    2              OLD_BUF$ -> TEXT$C.LEN = 51;

  13504 12 005156   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005157   000100 101400                    MRL     fill='000'O
        12 005160   000071 000004 13                 ADSC9   57                       cn=0,n=4
        12 005161   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1763    13505    2              OLD_BUF$ -> TEXT$C.STRING = ' ';

  13505 12 005162   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005163   000100 101500                    MRL     fill='000'O
        12 005164   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 005165   200062 000002                    ADSC9   @LEN+2,,AUTO             cn=0,n=2
        12 005166   200062 220100                    LDX0    @LEN+2,,AUTO
        12 005167   040140 100400                    MLR     fill='040'O
        12 005170   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 005171   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

     1764    13506    2              CALL BINCHAR(OLD_BUF$->COL$ARY.N.TXT(0),I);

  13506 12 005172   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005173   000100 301500                    BTD
        12 005174   200034 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:295  
        12 005175   000000 630010                    NDSC9   0,,PR0                   cn=3,s=nosgn,sf=0,n=8

     1765    13507    2              CALL VPD$CLOBBERLZ (VECTOR(OLD_BUF$->COL$ARY.N.TXT(0)));

  13507 12 005176   000017 235000 13                 LDA     15
        12 005177   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 005200   600000 036007                    ADLQ    -65536,DL
        12 005201   200062 757100                    STAQ    @LEN+2,,AUTO
        12 005202   200062 630500                    EPPR0   @LEN+2,,AUTO
        12 005203   200064 450500                    STP0    @LEN+4,,AUTO
        12 005204   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 005205   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 005206   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 005207   000000 011000                    NOP     0

     1766    13508    2              CALL CONCAT(OLD_BUF$->COL$ARY.N.TXT(1),

  13508 12 005210   200035 236100                    LDQ     J,,AUTO
        12 005211   000022 402007                    MPY     18,DL
        12 005212   000000 116003                    CMPQ    0,DU
        12 005213   005215 605000 12                 TPL     s:13508+5
        12 005214   000044 036003                    ADLQ    36,DU
        12 005215   200032 470500                    LDP0    CODE$,,AUTO
        12 005216   003100 061506                    CSR     bolr='003'O
        12 005217   000001 010001                    BDSC    1,Q,PR0                  by=0,bit=1,n=1
        12 005220   200062 000044                    BDSC    @LEN+2,,AUTO             by=0,bit=0,n=36
        12 005221   200062 236100                    LDQ     @LEN+2,,AUTO
        12 005222   200050 471500                    LDP1    OLD_BUF$,,AUTO
        12 005223   040100 100400                    MLR     fill='040'O
        12 005224   001046 000004 11                 ADSC9   XTEND_STRINGS+296        cn=0,n=4
        12 005225   100003 200004                    ADSC9   3,,PR1                   cn=1,n=4
        12 005226   000003 402007                    MPY     3,DL
        12 005227   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005230   040100 100406                    MLR     fill='040'O
        12 005231   000104 000003 11                 ADSC9   TRUTH,Q                  cn=0,n=3
        12 005232   000004 200004                    ADSC9   4,,PR0                   cn=1,n=4

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:296  
     1767    13509    2                '    ',TRUTH(BITBIN(CODE$->CODE19.K.UNIQUE(J))));
     1768    13510    2              PTR$ = ADDR(OLD_BUF$->COL$ARY.N.TXT(2));

  13510 12 005233   200050 236100                    LDQ     OLD_BUF$,,AUTO
        12 005234   000020 036000 13                 ADLQ    16
        12 005235   200036 756100                    STQ     PTR$,,AUTO

     1769    13511    3              DO UNTIL (CODE$->CODE19.K.KEYEND(J-1));

     1770    13512    3                 CALL BINCHAR(CONV_BUF,CODE$->CODE19.K.FIELDN(J));

  13512 12 005236   200035 235100                    LDA     J,,AUTO
        12 005237   000001 735000                    ALS     1
        12 005240   200032 470500                    LDP0    CODE$,,AUTO
        12 005241   000100 101505                    MRL     fill='000'O
        12 005242   000001 200001                    ADSC9   1,A,PR0                  cn=1,n=1
        12 005243   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 005244   200062 236100                    LDQ     @LEN+2,,AUTO
        12 005245   000000 235003                    LDA     0,DU
        12 005246   200064 757100                    STAQ    @LEN+4,,AUTO
        12 005247   000100 301500                    BTD
        12 005250   200064 000010                    NDSC9   @LEN+4,,AUTO             cn=0,s=lsgnf,sf=0,n=8
        12 005251   200046 030006                    NDSC9   CONV_BUF,,AUTO           cn=0,s=nosgn,sf=0,n=6

     1771    13513    3                 BYTE_IDX = 0;

  13513 12 005252   200040 450100                    STZ     BYTE_IDX,,AUTO

     1772    13514    4                 DO WHILE (BYTE_IDX < SIZEC(CONV_BUF)-1

  13514 12 005253   005255 710000 12                 TRA     s:13517

     1773    13515    4                   AND SUBSTR(CONV_BUF,BYTE_IDX,1) = '0');
     1774    13516    4                    BYTE_IDX = BYTE_IDX +1;

  13516 12 005254   200040 054100                    AOS     BYTE_IDX,,AUTO

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:297  
     1775    13517    4                    END;                   /* END WHILE                          */

  13517 12 005255   200040 235100                    LDA     BYTE_IDX,,AUTO
        12 005256   000005 115007                    CMPA    5,DL
        12 005257   005264 605000 12                 TPL     s:13518
        12 005260   040000 106505                    CMPC    fill='040'O
        12 005261   200046 000001                    ADSC9   CONV_BUF,A,AUTO          cn=0,n=1
        12 005262   000073 000001 13                 ADSC9   59                       cn=0,n=1
        12 005263   005254 600000 12                 TZE     s:13516

     1776    13518    3                 CALL CONCAT(PTR$ -> CHAR$7,SUBSTR(CONV_BUF,BYTE_IDX),'-');

  13518 12 005264   777771 620005                    EAX0    -7,AL
        12 005265   777777 660003                    ERX0    -1,DU
        12 005266   200036 470500                    LDP0    PTR$,,AUTO
        12 005267   040100 100545                    MLR     fill='040'O
        12 005270   200046 000010                    ADSC9   CONV_BUF,A,AUTO          cn=0,n=*X0
        12 005271   000000 000007                    ADSC9   0,,PR0                   cn=0,n=7
        12 005272   200040 236100                    LDQ     BYTE_IDX,,AUTO
        12 005273   000027 116000 xsym               CMPQ    B_VECTNIL+23
        12 005274   005302 604400 12                 TMOZ    s:13519
        12 005275   000001 621006                    EAX1    1,QL
        12 005276   000000 531000                    NEG     0
        12 005277   040145 100400                    MLR     fill='040'O
        12 005300   000061 000001 13                 ADSC9   49                       cn=0,n=1
        12 005301   000001 400011                    ADSC9   1,A,PR0                  cn=2,n=*X1

     1777    13519    3                 PTR$ = PINCRC(PTR$,SIZEC(CONV_BUF)-BYTE_IDX+1);

  13519 12 005302   000020 736000                    QLS     16
        12 005303   000027 676000 xsym               ERQ     B_VECTNIL+23
        12 005304   000074 036000 13                 ADLQ    60
        12 005305   200036 036100                    ADLQ    PTR$,,AUTO
        12 005306   200036 756100                    STQ     PTR$,,AUTO

     1778    13520    3                 J = J +1;                 /* Next fraggie                       */

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:298  
  13520 12 005307   200035 054100                    AOS     J,,AUTO

     1779    13521    3                 END;                      /* END UNTIL                          */

  13521 12 005310   200035 236100                    LDQ     J,,AUTO
        12 005311   000022 402007                    MPY     18,DL
        12 005312   000000 116003                    CMPQ    0,DU
        12 005313   005315 605000 12                 TPL     s:13521+5
        12 005314   000044 036003                    ADLQ    36,DU
        12 005315   200032 470500                    LDP0    CODE$,,AUTO
        12 005316   000000 066506                    CMPB    filb='0'B
        12 005317   000000 400001                    BDSC    0,Q,PR0                  by=2,bit=0,n=1
        12 005320   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
        12 005321   005236 600000 12                 TZE     s:13512

     1780    13522    2              PINCRC(PTR$,-1) -> CHAR$1 = ' '; /* Stomp trailing sep.            */

  13522 12 005322   200036 471500                    LDP1    PTR$,,AUTO
        12 005323   040100 100400                    MLR     fill='040'O
        12 005324   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 005325   177777 600001                    ADSC9   -1,,PR1                  cn=3,n=1

     1781    13523    2              BUF_BLOCK.COUNT = BUF_BLOCK.COUNT +1;

  13523 12 005326   000000 470400 xsym               LDP0    LIST_BUF$
        12 005327   000000 054100                    AOS     0,,PR0

     1782    13524    2              END;                         /* END INDEX                          */

  13524 12 005330   200034 054100                    AOS     I,,AUTO
        12 005331   200032 470500                    LDP0    CODE$,,AUTO
        12 005332   200034 236100                    LDQ     I,,AUTO
        12 005333   005137 604000 12                 TMI     s:13502
        12 005334   000000 116100                    CMPQ    0,,PR0
        12 005335   005137 602000 12                 TNC     s:13502

  13523 12 005336                       NO_CODE19    null
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:299  
     1783    13525    1   NO_CODE19: ;
     1784    13526        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:300  
     1785    13527        /******************************************************************************/
     1786    13528        /*                                                                            */
     1787    13529        /*  There is nothing left to do for LIST!                                     */
     1788    13530        /*                                                                            */
     1789    13531        /******************************************************************************/
     1790    13532    1           RETURN;

  13532 12 005336   000000 702200 xent               TSX2  ! X66_ARET

     1791    13533        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:301  
     1792    13534    1   CHECK_BUF: PROC(PTR$,LEN);

  13534 12 005337   200056 741300       CHECK_BUF    STX1  ! DENS_STR+3,,AUTO

     1793    13535        /*I* NAME: CHECK_BUF;
     1794    13536             CALL CHECK_BUF(PTR$,LEN);
     1795    13537             DESCRIPTION: This procedure determines whether or not LEN more
     1796    13538                          characters will fit in the list buffer described by
     1797    13539                          LIST_BUF$ and LIST_SIZE.  PTR$ is the current point
     1798    13540                          in that buffer where we will be putting stuff.  If
     1799    13541                          there is not enough room, then the buffer will be
     1800    13542                          enlarged by a page and LIST_SIZE updated.
     1801    13543        */
     1802    13544    2   DCL PTR$ PTR;
     1803    13545    2   DCL LEN UBIN;
     1804    13546
     1805    13547    2           IF PINCRC(PTR$,LEN) < PINCRW(LIST_BUF$,LIST_SIZE) THEN RETURN;

  13547 12 005340   200060 470500                    LDP0    @LEN,,AUTO
        12 005341   000000 236100                    LDQ     0,,PR0
        12 005342   200057 471500                    LDP1    @PTR$,,AUTO
        12 005343   100000 473500                    LDP3    0,,PR1
        12 005344   200062 756100                    STQ     @LEN+2,,AUTO
        12 005345   000000 236000 xsym               LDQ     LIST_SIZE
        12 005346   000022 736000                    QLS     18
        12 005347   000000 036000 xsym               ADLQ    LIST_BUF$
        12 005350   200063 756100                    STQ     @LEN+3,,AUTO
        12 005351   200062 236100                    LDQ     @LEN+2,,AUTO
        12 005352   000011 402007                    MPY     9,DL
        12 005353   300000 503506                    ABD     0,QL,PR3
        12 005354   200064 453500                    STP3    @LEN+4,,AUTO
        12 005355   200064 236100                    LDQ     @LEN+4,,AUTO
        12 005356   200063 116100                    CMPQ    @LEN+3,,AUTO
        12 005357   005361 603000 12                 TRC     s:13548

  13547 12 005360   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:302  
     1806    13548    2           CALL VPD$GET_BUF(LIST_BUF$,1024)

  13548 12 005361   000001 630400 13                 EPPR0   1
        12 005362   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 005363   000000 701000 xent               TSX1    VPD$GET_BUF
        12 005364   005366 702000 12                 TSX2    s:13550
        12 005365   005372 710000 12                 TRA     s:13552

     1807    13549    3            WHENALTRETURN DO;

     1808    13550    3               CALL VPL$ERR_PROC(3,0);

  13550 12 005366   000003 630400 13                 EPPR0   3
        12 005367   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 005370   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 005371   000000 011000                    NOP     0

     1809    13551    3               END;

     1810    13552    2           LIST_SIZE=LIST_SIZE+1024;

  13552 12 005372   000000 235000 xsym               LDA     LIST_SIZE
        12 005373   002000 035007                    ADLA    1024,DL
        12 005374   000000 755000 xsym               STA     LIST_SIZE

     1811    13553    2           RETURN;

  13553 12 005375   200056 221300                    LDX1  ! DENS_STR+3,,AUTO
        12 005376   000001 702211                    TSX2  ! 1,X1

     1812    13554    2   END CHECK_BUF;
     1813    13555        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:303  
     1814    13556    1   FINISH_NUMARY_BUF: PROC(COUNT);

  13556 12 005377   200056 741300       FINISH_NUMA* STX1  ! DENS_STR+3,,AUTO

     1815    13557        /*I* NAME: FINISH_NUMARY_BUF;
     1816    13558             CALL:  CALL FINISH_NUMARY_BUF;
     1817    13559             DESCRIPTION: This procedure removes leading zeroes from the first
     1818    13560                          COUNT numbers in NUM$ARY located by OLD_BUF$. It
     1819    13561                          then bumps BUF_BLOCK.COUNT and returns.
     1820    13562        */
     1821    13563    2   DCL COUNT SBIN WORD;
     1822    13564    2   DCL I SBIN WORD;
     1823    13565    3           DO I=0 TO COUNT-1;

  13565 12 005400   200060 450100                    STZ     I,,AUTO
        12 005401   005421 710000 12                 TRA     s:13567+1

     1824    13566    3              CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->NUM$ARY.N.NUM(I)));

  13566 12 005402   000007 235000 13                 LDA     7
        12 005403   200060 236100                    LDQ     I,,AUTO
        12 005404   200062 755100                    STA     @LEN+2,,AUTO
        12 005405   000075 402000 13                 MPY     61
        12 005406   000076 036000 13                 ADLQ    62
        12 005407   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 005410   200062 235100                    LDA     @LEN+2,,AUTO
        12 005411   200064 757100                    STAQ    @LEN+4,,AUTO
        12 005412   200064 630500                    EPPR0   @LEN+4,,AUTO
        12 005413   200066 450500                    STP0    @LEN+6,,AUTO
        12 005414   200066 630500                    EPPR0   @LEN+6,,AUTO
        12 005415   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 005416   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 005417   000000 011000                    NOP     0

     1825    13567    3              END;

  13567 12 005420   200060 054100                    AOS     I,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:304  
        12 005421   200057 470500                    LDP0    @COUNT,,AUTO
        12 005422   200060 236100                    LDQ     I,,AUTO
        12 005423   000000 116100                    CMPQ    0,,PR0
        12 005424   005402 604000 12                 TMI     s:13566

     1826    13568    2           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13568 12 005425   000000 471400 xsym               LDP1    LIST_BUF$
        12 005426   100000 054100                    AOS     0,,PR1

     1827    13569    2           RETURN;

  13569 12 005427   200056 221300                    LDX1  ! DENS_STR+3,,AUTO
        12 005430   000001 702211                    TSX2  ! 1,X1

     1828    13570    2   END FINISH_NUMARY_BUF;
     1829    13571        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:305  
     1830    13572    1   FINISH_COLARY_BUF: PROC(COUNT);

  13572 12 005431   200056 741300       FINISH_COLA* STX1  ! DENS_STR+3,,AUTO

     1831    13573        /*I* NAME: FINISH_COLARY_BUF;
     1832    13574             CALL:  CALL FINISH_COLARY_BUF(n);
     1833    13575             DESCRIPTION: This procedure removes leading zeroes from the first
     1834    13576                          COUNT numbers in COL$ARY located by OLD_BUF$. It
     1835    13577                          then bumps BUF_BLOCK.COUNT and returns.
     1836    13578        */
     1837    13579    2   DCL COUNT SBIN WORD;
     1838    13580    2   DCL I SBIN WORD;
     1839    13581    3           DO I=0 TO COUNT-1;

  13581 12 005432   200060 450100                    STZ     I,,AUTO
        12 005433   005462 710000 12                 TRA     s:13585+1

     1840    13582    3              IF OLD_BUF$->COL$ARY.N.TXT(I) ~= ' '

  13582 12 005434   200060 236100                    LDQ     I,,AUTO
        12 005435   000012 402007                    MPY     10,DL
        12 005436   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005437   040000 106506                    CMPC    fill='040'O
        12 005440   000000 600010                    ADSC9   0,Q,PR0                  cn=3,n=8
        12 005441   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        12 005442   005461 600000 12                 TZE     s:13585

     1841    13583    3               THEN                        /* Presumed numeric                   */
     1842    13584    3                 CALL VPD$CLOBBERLZ(VECTOR(OLD_BUF$->COL$ARY.N.TXT(I)));

  13584 12 005443   000017 235000 13                 LDA     15
        12 005444   200060 236100                    LDQ     I,,AUTO
        12 005445   200062 755100                    STA     @LEN+2,,AUTO
        12 005446   000077 402000 13                 MPY     63
        12 005447   600000 036007                    ADLQ    -65536,DL
        12 005450   200050 036100                    ADLQ    OLD_BUF$,,AUTO
        12 005451   200062 235100                    LDA     @LEN+2,,AUTO
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:306  
        12 005452   200064 757100                    STAQ    @LEN+4,,AUTO
        12 005453   200064 631500                    EPPR1   @LEN+4,,AUTO
        12 005454   200066 451500                    STP1    @LEN+6,,AUTO
        12 005455   200066 630500                    EPPR0   @LEN+6,,AUTO
        12 005456   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 005457   000000 701000 xent               TSX1    VPD$CLOBBERLZ
        12 005460   000000 011000                    NOP     0

     1843    13585    3              END;

  13585 12 005461   200060 054100                    AOS     I,,AUTO
        12 005462   200057 470500                    LDP0    @COUNT,,AUTO
        12 005463   200060 236100                    LDQ     I,,AUTO
        12 005464   000000 116100                    CMPQ    0,,PR0
        12 005465   005434 604000 12                 TMI     s:13582

     1844    13586    2           BUF_BLOCK.COUNT = BUF_BLOCK.COUNT+1;

  13586 12 005466   000000 471400 xsym               LDP1    LIST_BUF$
        12 005467   100000 054100                    AOS     0,,PR1

     1845    13587    2           RETURN;

  13587 12 005470   200056 221300                    LDX1  ! DENS_STR+3,,AUTO
        12 005471   000001 702211                    TSX2  ! 1,X1

     1846    13588    2   END FINISH_COLARY_BUF;
     1847    13589        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:307  
     1848    13590    1   XTEND_BUF: PROC(IDX);

  13590 12 005472   200056 741300       XTEND_BUF    STX1  ! DENS_STR+3,,AUTO

     1849    13591        /*I* NAME: XTEND_BUF
     1850    13592             CALL: CALL XTEND_BUF(IDX);
     1851    13593             DESCRIPTION: This procedure extends the buffer pointed to by OLD_BUF$
     1852    13594                          by the string, XTEND_STRINGS.STRING(IDX).
     1853    13595        */
     1854    13596    2   DCL IDX SBIN WORD;
     1855    13597    2   DCL 1 XTEND_STRINGS(0:13) CONSTANT,
     1856    13598    2         2 LEN UBIN BYTE UNAL INIT(
     1857    13599    2             12,10,                        /* NOBACKUP, BACKUP                   */
     1858    13600    2             00,11,                        /* NOCOMPRESS, COMPRESSED             */
     1859    13601    2             19,20,                        /* QUEUED RETREIVE, QUEUED FETCH      */
     1860    13602    2             12,11,                        /* NOBLOCKED, BLOCKED                 */
     1861    13603    2             09,08,                        /* NOSPANNED, SPANNED                 */
     1862    13604    2             00,05,                        /* NOQISS, QISS                       */
     1863    13605    2             03,03),                       /* INACTIVE, ACTIVE                   */
     1864    13606    2         2 STRING CHAR(26) INIT
     1865    13607    2           ('    Nobackup',                /* IDX = 0                            */
     1866    13608    2           '    Backup',                   /* IDX = 1                            */
     1867    13609    2           ' ',                            /* IDX = 2                            */
     1868    13610    2           ',compressed',                  /* IDX = 3                            */
     1869    13611    2           ',queued for archive',          /* IDX = 4                            */
     1870    13612    2           ',queued for retrieve',         /* IDX = 5                            */
     1871    13613    2           '    nblocked',                 /* IDX = 6                            */
     1872    13614    2           '    blocked',                  /* IDX = 7                            */
     1873    13615    2           ',nspanned',                    /* IDX = 8                            */
     1874    13616    2           ',spanned',                     /* IDX = 9                            */
     1875    13617    2           ' ',                            /* IDX = 10                           */
     1876    13618    2           ',QISS',                        /* IDX = 11                           */
     1877    13619    2           '(I)',                          /* IDX = 12                           */
     1878    13620    2           '(A)');                         /* IDX = 13                           */
     1879    13621    2   DCL CHAR$26 CHAR(26) BASED;
     1880    13622    2           PINCRC(OLD_BUF$,OLD_BUF$->TEXT$C.LEN+1)->CHAR$26 =

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:308  
  13622 12 005473   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005474   000100 101500                    MRL     fill='000'O
        12 005475   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 005476   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 005477   200062 236100                    LDQ     @LEN+2,,AUTO
        12 005500   200057 471500                    LDP1    @IDX,,AUTO
        12 005501   200063 756100                    STQ     @LEN+3,,AUTO
        12 005502   100000 236100                    LDQ     0,,PR1
        12 005503   000033 402007                    MPY     27,DL
        12 005504   200063 235100                    LDA     @LEN+3,,AUTO
        12 005505   040105 100406                    MLR     fill='040'O
        12 005506   000376 200032 11                 ADSC9   XTEND_STRINGS,Q          cn=1,n=26
        12 005507   000000 200032                    ADSC9   0,A,PR0                  cn=1,n=26

     1881    13623    2             XTEND_STRINGS.STRING(IDX);
     1882    13624    2           OLD_BUF$->TEXT$C.LEN = OLD_BUF$->TEXT$C.LEN + XTEND_STRINGS.LEN(IDX);

  13624 12 005510   100000 236100                    LDQ     0,,PR1
        12 005511   000033 402007                    MPY     27,DL
        12 005512   000100 101406                    MRL     fill='000'O
        12 005513   000376 000001 11                 ADSC9   XTEND_STRINGS,Q          cn=0,n=1
        12 005514   200062 000004                    ADSC9   @LEN+2,,AUTO             cn=0,n=4
        12 005515   200050 470500                    LDP0    OLD_BUF$,,AUTO
        12 005516   000100 101500                    MRL     fill='000'O
        12 005517   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        12 005520   200063 000004                    ADSC9   @LEN+3,,AUTO             cn=0,n=4
        12 005521   200063 236100                    LDQ     @LEN+3,,AUTO
        12 005522   200062 036100                    ADLQ    @LEN+2,,AUTO
        12 005523   200064 756100                    STQ     @LEN+4,,AUTO
        12 005524   000100 101500                    MRL     fill='000'O
        12 005525   200064 000004                    ADSC9   @LEN+4,,AUTO             cn=0,n=4
        12 005526   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1883    13625    2           RETURN;

  13625 12 005527   200056 221300                    LDX1  ! DENS_STR+3,,AUTO
        12 005530   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:309  

     1884    13626    2   END XTEND_BUF;
     1885    13627        %EJECT;
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:310  
     1886    13628    1   GET_FULL_FID: PROC(NAME$,LEN);

  13628 12 005531   200056 741300       GET_FULL_FID STX1  ! DENS_STR+3,,AUTO

     1887    13629        /*I* NAME: GET_FULL_FID
     1888    13630             CALL: CALL GET_FULL_FID(NAME$,LEN);
     1889    13631             DESCRIPTION: Does an M$UNFID on M$EI to obtain all the parts
     1890    13632                          of a FID, and formats them into where NAME$ locates.
     1891    13633                          It returns the length of the fid in LEN.
     1892    13634        */
     1893    13635
     1894    13636    2   DCL NAME$ PTR;
     1895    13637    2   DCL LEN UBIN;
     1896    13638    2   DCL LENGTH UBIN STATIC;
     1897    13639    2   DCL B$VECTOR BASED VECTOR;
     1898    13640        %FPT_UNFID(FPTN=FPT_UNFID_EI,DCB=M$EI,LEN=LENGTH);
     1899    13658    2           VBASE(ADDR(FPT_UNFID_EI.TEXTFID_)->B$VECTOR) = NAME$;

  13658 12 005532   200057 470500                    LDP0    @NAME$,,AUTO
        12 005533   000000 236100                    LDQ     0,,PR0
        12 005534   000033 756000 10                 STQ     FPT_UNFID_EI+3

     1900    13659    2           VBOUND(ADDR(FPT_UNFID_EI.TEXTFID_)->B$VECTOR) = 52;

  13659 12 005535   000032 236000 10                 LDQ     FPT_UNFID_EI+2
        12 005536   177777 376007                    ANQ     65535,DL
        12 005537   000015 276003                    ORQ     13,DU
        12 005540   000032 756000 10                 STQ     FPT_UNFID_EI+2

     1901    13660    2           CALL M$UNFID(FPT_UNFID_EI)

  13660 12 005541   000030 630400 10                 EPPR0   FPT_UNFID_EI
        12 005542   420021 713400                    CLIMB   alt,+8209
        12 005543   404400 401760                    pmme    nvectors=10
        12 005544   005546 702000 12                 TSX2    s:13662
        12 005545   005552 710000 12                 TRA     s:13664

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:311  
     1902    13661    3            WHENALTRETURN DO;

     1903    13662    3               CALL VPL$ERR_PROC(3,0);

  13662 12 005546   000003 630400 13                 EPPR0   3
        12 005547   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 005550   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 005551   000000 011000                    NOP     0

     1904    13663    3               END;

     1905    13664    2           LEN = LENGTH;

  13664 12 005552   200060 470500                    LDP0    @LEN,,AUTO
        12 005553   000027 235000 10                 LDA     LENGTH
        12 005554   000000 755100                    STA     0,,PR0

     1906    13665    2           RETURN;

  13665 12 005555   200056 221300                    LDX1  ! DENS_STR+3,,AUTO
        12 005556   000001 702211                    TSX2  ! 1,X1
     1907    13666    2   END GET_FULL_FID;
     1908    13667    1   END VPH$GET_LIST_BUFS;

PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:312  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XUD_UTS_M.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   FM_FIELD_C.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPH$GET_LIST_BUFS.
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:313  

 **** Variables and constants ****

  ****  Section 010  Data  VPH$GET_LIST_BUFS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    21-0-0/c CHAR(10)    r     1 DATE_BUF                   2-0-0/d STRC(432)   r     1 FPT_TIME
    30-0-0/d STRC(792)   r     1 FPT_UNFID_EI              27-0-0/w UBIN        r     1 LENGTH
    16-0-0/c CHAR(9)     r     1 ON_BUF                    16-0-0/c STRC(81)    r     1 ON_BUF_RDF
    24-0-0/c STRC(99)    r     1 TIME_BUF                   0-0-0/w SBIN        r     1 ZERO

  ****  Section 011 RoData VPH$GET_LIST_BUFS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    40-0-0/c STRC(1296)  r     1 CNTL_NAME_TBL             26-0-0/d STRC(360)   r     1 FPT_PRECORD
     0-0-0/c CHAR(38)    r     1 INCONSIST_BUF             12-0-0/c CHAR(46)    r     1 TIMEWARP_BUF
   104-0-0/c CHAR(3)     r     1 TRUTH(0:1)
   120-0-0/c STRC(99)    r     1 TYPE_ARY(0:62)
   106-0-0/c CHAR(8)     r     1 UNITS(0:4)
   376-0-0/c STRC(243)   r     1 XTEND_STRINGS(0:13)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    57-0-0/w PTR         r     1 @COUNT                    57-0-0/w PTR         r     1 @COUNT
    57-0-0/w PTR         r     1 @IDX                      60-0-0/w PTR         r     1 @LEN
    60-0-0/w PTR         r     1 @LEN                       3-0-0/w PTR         r     1 @LIST_CODE
    57-0-0/w PTR         r     1 @NAME$                    57-0-0/w PTR         r     1 @PTR$
    40-0-0/w SBIN        r     1 BYTE_IDX                  31-0-0/w SBIN        r     1 CODE
    32-0-0/w PTR         r     1 CODE$                     33-0-0/w SBIN        r     1 CODES_IDX
    46-0-0/c CHAR(6)     r     1 CONV_BUF                  *0-0-0/w SBIN        r     1 COUNT
    *0-0-0/w SBIN        r     1 COUNT                     43-0-0/w UBIN        r     1 CREATE_TIME
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:314  
    53-0-0/c CHAR(5)     r     1 DENS_STR                  17-0-0/b BIT         r     1 DONT_PRINT
    37-0-0/w SBIN        r     1 EQ_IDX                    42-0-0/w SBIN        r     1 EXP_TIME
    14-0-0/w PTR         r     1 F$                        34-0-0/w SBIN        r     1 I
    60-0-0/w SBIN        r     1 I                         60-0-0/w SBIN        r     1 I
    *0-0-0/w SBIN        r     1 IDX                       35-0-0/w SBIN        r     1 J
    16-0-0/w UBIN        r     1 K                         *0-0-0/w UBIN        r     1 LEN
    *0-0-0/w UBIN        r     1 LEN                       10-0-0/w UBIN        r     1 LEN_BITS
     6-0-0/w UBIN        r     1 LEN_BYTES                  4-0-0/w UBIN        r     1 LEN_WRDS
    *0-0-0/w SBIN        r     1 LIST_CODE                 *0-0-0/w PTR         r     1 NAME$
    51-0-0/w PTR         r     1 NEW_BUF$                  41-0-0/w SBIN        r     1 NUM_BYTES
    50-0-0/w PTR         r     1 OLD_BUF$                  15-0-0/w PTR         r     1 P$
    36-0-0/w PTR         r     1 PTR$                      *0-0-0/w PTR         r     1 PTR$
    11-0-0/c CHAR        r     1 TBITS                      7-0-0/c CHAR        r     1 TBYTES
    52-0-0/w PTR         r     1 TCODE$                    20-0-0/w SBIN        r     1 TEMP
    21-0-0/c STRC(288)   r     1 TEXT_C                    12-0-0/c CHAR(3)     r     1 TFIELD1
    13-0-0/c CHAR(3)     r     1 TFIELD2                    5-0-0/c CHAR(4)     r     1 TWRDS
    44-0-0/w UBIN        r     1 UTS_TMP

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$ROS$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/c STRC(288)   r     1 DIN_NAME                   0-0-0/w PTR         r     1 FPARAM$
     0-0-0/d STRC(1080)  r     1 FPT_CLOSE_EI               0-0-0/d STRC(5868)  r     1 ICB
     0-0-0/w PTR         r     1 LIST_BUF$                  0-0-0/w UBIN        r     1 LIST_SIZE
     0-0-0/w PTR         r     1 M$EI$                      0-0-0/c STRC(162)   r     1 ORG_TBL(0:8191)
     0-0-0/w SBIN        r     1 TEST_MODE                  0-0-0/w SBIN        r     1 USABLE_LEN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:315  
     0-0-0/b UBIN(9)     r     1 B$UBIN1                    0-0-0/d VECT        r     1 B$VECTOR
     0-0-0/c CHAR        r     1 BASED_CHAR
     0-0-0/b BIT         r     1 BIT$ARY(0:0)
     0-0-0/w STRC(765)   r     1 BUF_BLOCK                  0-0-0/c CHAR        r     1 CHAR$1
     0-0-0/c CHAR(26)    r     1 CHAR$26                    0-0-0/c CHAR(7)     r     1 CHAR$7
     0-0-0/w STRC(135)   r     1 CODE02                     0-0-0/w STRC(324)   r     1 CODE03
     0-0-0/w STRC(396)   r     1 CODE04                     0-0-0/w STRC(108)   r     1 CODE05
     0-0-0/w STRC(108)   r     1 CODE06                     0-0-0/c STRC(90)    r     1 CODE09
     0-0-0/c ASTR(27)    r     1 CODE10                     0-0-0/w STRC(144)   r     1 CODE15
     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/w STRC(54)    r     1 CODE18
     0-0-0/w STRC(54)    r     1 CODE19                     0-0-0/w STRC(45)    r     1 CODE21
     0-0-0/c STRC(99)    r     1 COL$ARY                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(4572)  r     1 FITALTKEYS                 0-0-0/w STRC(72)    r     1 FM$FIELD_START
     0-0-0/w STRC(1116)  r     1 FM$FIT                     0-0-0N  NULL        r     1 M$EI
     0-0-0/c STRC(171)   r     1 NUM$ARY                    0-0-0/c ASTR(9)     r     1 TEXT$C


   Procedure VPH$GET_LIST_BUFS requires 2927 words for executable code.
   Procedure VPH$GET_LIST_BUFS requires 64 words of local(AUTO) storage.

    No errors detected in file VPH$LISTREV.:E05TSI    .
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:316  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:317  
          MINI XREF LISTING

B$ALT.CODE
     12198**DCL     12198--REDEF   12199--REDEF   12199--REDEF
B$ALT.ERR.CODE
     12200**DCL     12888>>IF
B$ALT.ERR.ERR#
     12200**DCL     12200--REDEF
B$ALT.EVID
     12199**DCL     12199--REDEF   12199--REDEF
B$ROS$
     12204**DCL     13436>>ASSIGN
B$TCB.ALT$
     12194**DCL     12888>>IF
B$TCB$
      6003**DCL     12888>>IF
B$UBIN1
     12121**DCL     12833<<ASSIGN
B$VECTOR IN PROCEDURE GET_FULL_FID
     13639**DCL     13658<<ASSIGN  13659<<ASSIGN
BASED_CHAR
     12120**DCL     13463>>DOWHILE 13466<<ASSIGN
BIT$ARY
     12578**DCL     12958>>IF
BREAK_LOC
      5238**DCL      5238--REDEF
BUF_BLOCK.BUF_1
     12219**DCL     12832--CALL    12833--ASSIGN  12836<<ASSIGN
BUF_BLOCK.BUF_1.INFO.DP
     12230**DCL     12235--REDEF
BUF_BLOCK.BUF_1.INFO.DP.DATE
     12233**DCL     12910<<ASSIGN
BUF_BLOCK.BUF_1.INFO.DP.TIME
     12231**DCL     12909<<ASSIGN
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:318  
BUF_BLOCK.BUF_1.INFO.GRAN
     12226**DCL     12883<<CALLBLT 12915<<CALLBLT 12920--CALL
BUF_BLOCK.BUF_1.INFO.LT.FSN
     12238**DCL     12893<<CALLBLT 12894--CALL
BUF_BLOCK.BUF_1.INFO.LT.VOL
     12236**DCL     12885<<ASSIGN
BUF_BLOCK.BUF_1.INFO.NGAV
     12227**DCL     12884<<CALLBLT 12916<<CALLBLT 12921--CALL
BUF_BLOCK.BUF_1.INFO.ORG
     12223**DCL     12876<<ASSIGN
BUF_BLOCK.BUF_1.INFO.RECS
     12228**DCL     12892<<CALLBLT 12917<<CALLBLT 12922--CALL
BUF_BLOCK.BUF_1.INFO.TY
     12225**DCL     12877<<ASSIGN
BUF_BLOCK.BUF_1.INFO_FIELD
     12221**DCL     12222--REDEF   12846--ASSIGN  12850<<ASSIGN  12858<<ASSIGN  12864<<ASSIGN  12869<<ASSIGN
BUF_BLOCK.BUF_1.LEN
     12220**DCL     12846<<ASSIGN  12925--ASSIGN
BUF_BLOCK.BUF_1.NAME
     12240**DCL     12840--CALL    12843<<ASSIGN
BUF_BLOCK.COUNT
     12218**DCL     12827<<ASSIGN  12975<<ASSIGN  12975>>ASSIGN  12995<<ASSIGN  12995>>ASSIGN  13003<<ASSIGN
     13003>>ASSIGN  13038<<ASSIGN  13038>>ASSIGN  13058<<ASSIGN  13058>>ASSIGN  13083<<ASSIGN  13083>>ASSIGN
     13098<<ASSIGN  13098>>ASSIGN  13133<<ASSIGN  13133>>ASSIGN  13157<<ASSIGN  13157>>ASSIGN  13187<<ASSIGN
     13187>>ASSIGN  13209<<ASSIGN  13209>>ASSIGN  13234<<ASSIGN  13234>>ASSIGN  13280<<ASSIGN  13280>>ASSIGN
     13293<<ASSIGN  13293>>ASSIGN  13329<<ASSIGN  13329>>ASSIGN  13361<<ASSIGN  13361>>ASSIGN  13365<<ASSIGN
     13365>>ASSIGN  13388<<ASSIGN  13388>>ASSIGN  13399<<ASSIGN  13399>>ASSIGN  13405<<ASSIGN  13405>>ASSIGN
     13482<<ASSIGN  13482>>ASSIGN  13495<<ASSIGN  13495>>ASSIGN  13499<<ASSIGN  13499>>ASSIGN  13523<<ASSIGN
     13523>>ASSIGN  13568<<ASSIGN  13568>>ASSIGN  13586<<ASSIGN  13586>>ASSIGN
BYTE_IDX
     12595**DCL     12933<<ASSIGN  12934>>DOWHILE 12934>>DOWHILE 12937>>ASSIGN  12940<<ASSIGN  12940>>ASSIGN
     12949<<ASSIGN  12949>>ASSIGN  13513<<ASSIGN  13514>>DOWHILE 13514>>DOWHILE 13516<<ASSIGN  13516>>ASSIGN
     13518>>CALLBLT 13519>>ASSIGN
CHAR$1
     12580**DCL     12971<<ASSIGN  13522<<ASSIGN
CHAR$26 IN PROCEDURE XTEND_BUF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:319  
     13621**DCL     13622<<ASSIGN
CHAR$7
     12579**DCL     12961<<ASSIGN  13185<<ASSIGN  13518<<CALLBLT
CHECK_BUF
     13534**PROC    13413--CALL    13503--CALL
CNTL_NAME_TBL.LEN
     12302**DCL     12963>>ASSIGN
CNTL_NAME_TBL.TEXT
     12305**DCL     12961>>ASSIGN
CODE
     12575**DCL     12928<<DOINDEX 12930>>ASSIGN  12934>>DOWHILE 12934>>DOWHILE 12938>>IF
CODE$
     12576**DCL     12901<<ASSIGN  12902<>CALL    12907>>ASSIGN  12913<<ASSIGN  12914<>CALL    12915>>CALLBLT
     12916>>CALLBLT 12917>>CALLBLT 12929<<ASSIGN  12931<>CALL    12937>>ASSIGN  12987<<ASSIGN  12988<>CALL
     12989>>IF      12997>>IF      13043<<ASSIGN  13044<>CALL    13049>>ASSIGN  13060>>ASSIGN  13061<<ASSIGN
     13062<>CALL    13063>>IF      13067>>CALL    13069>>CALL    13090>>CALLBLT 13103<<ASSIGN  13105<>CALL
     13106>>IF      13113<<ASSIGN  13114<>CALL    13115>>IF      13122>>ASSIGN  13126>>CALLBLT 13137<<ASSIGN
     13138<>CALL    13139>>IF      13146>>ASSIGN  13150>>CALLBLT 13160<<ASSIGN  13161<>CALL    13165>>CALLBLT
     13169>>CALLBLT 13178>>IF      13178>>IF      13182>>IF      13191>>CALLBLT 13199<<ASSIGN  13200<>CALL
     13219<<ASSIGN  13220<>CALL    13225>>ASSIGN  13238<<ASSIGN  13239<>CALL    13243>>CALLBLT 13244>>CALLBLT
     13250>>CALLBLT 13251>>CALLBLT 13252>>CALLBLT 13258<<ASSIGN  13259<>CALL    13263>>CALLBLT 13264>>CALLBLT
     13269>>CALLBLT 13270>>CALLBLT 13274>>CALLBLT 13274>>CALLBLT 13284>>CALLBLT 13312<<ASSIGN  13313<>CALL
     13314>>CALL    13315>>CALL    13316>>IF      13319>>CALL    13320>>IF      13321>>CALL    13324<<ASSIGN
     13325<>CALL    13326>>CALL    13343<<ASSIGN  13344<>CALL    13348>>CALLBLT 13349>>CALLBLT 13353<<ASSIGN
     13354<>CALL    13355>>IF      13366>>DOINDEX 13371>>CALLBLT 13372>>CALLBLT 13373>>ASSIGN  13380<<ASSIGN
     13381<>CALL    13382>>IF      13406>>DOINDEX 13408>>DOWHILE 13449>>CALLBLT 13453>>CALLBLT 13455>>ASSIGN
     13470>>CALLBLT 13477>>CALLBLT 13487<<ASSIGN  13488<>CALL    13489>>IF      13501>>DOINDEX 13508>>CALLBLT
     13511>>DOUNTIL 13512>>CALLBLT
CODE02.KEYL
     11973**DCL     13349>>CALLBLT
CODE02.KEYX
     11973**DCL     13348>>CALLBLT
CODE02.LRDL0
     11972**DCL     13250>>CALLBLT
CODE02.LSLIDE
     11972**DCL     13243>>CALLBLT
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:320  
CODE02.SLIDE
     11972**DCL     13244>>CALLBLT
CODE02.SPARE
     11972**DCL     13252>>CALLBLT
CODE02.TDALVL
     11972**DCL     13251>>CALLBLT
CODE03.COMP
     11978**DCL     13315>>CALL
CODE03.DESC.ACTIVE
     11977**DCL     13321>>CALL
CODE03.DESC.BAD
     11977**DCL     12989>>IF
CODE03.DESC.BUPM
     11977**DCL     13314>>CALL
CODE03.DESC.FETCH
     11978**DCL     13319>>CALL    13320>>IF
CODE03.DESC.NBUF
     11977**DCL     12997>>IF
CODE03.DESC.QS
     11977**DCL     13316>>IF
CODE03.DESC.TPB
     11977**DCL     13106>>IF
CODE03.EXPIRE
     11979**DCL     13063>>IF      13067>>CALL    13069>>CALL    13090>>CALLBLT
CODE03.GHSTACS
     11978**DCL     13178>>IF      13178>>IF      13182>>IF      13191>>CALLBLT
CODE03.NGAVAL
     11978**DCL     12916>>CALLBLT
CODE03.NRECS
     11978**DCL     12917>>CALLBLT
CODE03.RECL
     11979**DCL     13169>>CALLBLT
CODE03.UGRANS
     11976**DCL     12915>>CALLBLT
CODE03.XTNSIZE
     11979**DCL     13165>>CALLBLT
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:321  
CODE04.ACCESS.TIME
     11987**DCL     13049--ASSIGN
CODE04.CREATION.TIME
     11987**DCL     13060>>ASSIGN  13225--ASSIGN
CODE04.MODIFY.TIME
     11987**DCL     12907--ASSIGN
CODE05.BACKUP.REEL
     11991**DCL     13126>>CALLBLT
CODE05.BACKUP.TIME
     11991**DCL     13115>>IF      13122--ASSIGN
CODE06.STOW.EFT
     11994**DCL     11995--REDEF
CODE06.STOW.REEL
     11994**DCL     13150>>CALLBLT
CODE06.STOW.TIME
     11994**DCL     13139>>IF      13146--ASSIGN
CODE09.ACCT
     12005**DCL     12941>>CALLBLT 12943>>CALLBLT
CODE10.ACSVEH.C
     12009**DCL     12009--IMP-SIZ 12949>>ASSIGN  12950>>ASSIGN  12951>>CALLBLT
CODE10.ACSVEH.T
     12009**DCL     12951>>CALLBLT
CODE15.QISS
     12012**DCL     13326>>CALL
CODE16.COPIES
     12017**DCL     13284>>CALLBLT
CODE16.DVFC
     12019**DCL     13274>>CALLBLT
CODE16.FORM
     12015**DCL     13274>>CALLBLT
CODE16.LINENO
     12016**DCL     13270>>CALLBLT
CODE16.LINES
     12016**DCL     13263>>CALLBLT
CODE16.PAGENO
     12015**DCL     13269>>CALLBLT
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:322  
CODE16.WIDTH
     12019**DCL     13264>>CALLBLT
CODE18.DECFIELD
     12023**DCL     12024--REDEF
CODE18.DECFIELD.LEN
     12023**DCL     13453>>CALLBLT
CODE18.DECFIELD.SCALE
     12023**DCL     13455>>ASSIGN
CODE18.FIELD.LEN
     12024**DCL     13449>>CALLBLT 13470>>CALLBLT 13477>>CALLBLT
CODE18.FIELD.TYPE
     12024**DCL     13408>>DOWHILE
CODE18.NFIELDS
     12023**DCL     13382>>IF      13406>>DOINDEX
CODE19.K.FIELDN
     12027**DCL     13512>>CALLBLT
CODE19.K.KEYEND
     12027**DCL     13511>>DOUNTIL
CODE19.K.UNIQUE
     12027**DCL     13508>>CALLBLT
CODE19.NKEYS
     12027**DCL     13489>>IF      13501>>DOINDEX
CODE21.FIELDN
     12030**DCL     13421>>DOWHILE
CODE21.NFIELDS
     12030**DCL     13421>>DOWHILE 13424>>IF
CODES_IDX
     12577**DCL     12930<<ASSIGN  12931<>CALL    12932>>ASSIGN
COL$ARY.N
     12588**DCL     13462--ASSIGN
COL$ARY.N.TXT
     12590**DCL     13370<<CALLBLT 13371<<CALLBLT 13372<<CALLBLT 13373<<ASSIGN  13403<<ASSIGN  13404<<ASSIGN
     13429<<CALLBLT 13430<<ASSIGN  13431<<ASSIGN  13434<<ASSIGN  13444<<CALLBLT 13449<<CALLBLT 13450--CALL
     13451<<ASSIGN  13453<<CALLBLT 13454--CALL    13457<<CALLBLT 13459<<CALLBLT 13460--CALL    13470<<CALLBLT
     13471--CALL    13472<<ASSIGN  13477<<CALLBLT 13478--CALL    13479<<ASSIGN  13480<<ASSIGN  13506<<CALLBLT
     13507--CALL    13508<<CALLBLT 13510--ASSIGN  13582>>IF      13584--CALL
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:323  
CONV_BUF
     12601**DCL     13088<<CALLBLT 13090<<CALLBLT 13091--CALL    13094>>CALLBLT 13512<<CALLBLT 13514--DOWHILE
     13514>>DOWHILE 13518>>CALLBLT 13519--ASSIGN
COUNT IN PROCEDURE FINISH_COLARY_BUF
     13579**DCL     13572--PROC    13581>>DOINDEX
COUNT IN PROCEDURE FINISH_NUMARY_BUF
     13563**DCL     13556--PROC    13565>>DOINDEX
CREATE_TIME
     12598**DCL     13060<<ASSIGN  13069<>CALL
CREATOR_DONE
     13293**LABEL   13289--CALLALT
DATE_BUF
     12297**DCL     12284--DCLINIT 12285--DCLINIT 12910>>ASSIGN  13053>>CALLBLT 13078>>CALLBLT 13126>>CALLBLT
     13150>>CALLBLT 13229>>CALLBLT
DEF_ICB.FID.STRING
      5836**DCL      5837--REDEF
DENS_STR
     12605**DCL     13027<<ASSIGN  13029<<ASSIGN  13031<<ASSIGN  13033<<ASSIGN  13035>>CALLBLT
DEV_ICB.FID.STRING
      5722**DCL      5723--REDEF
DIN_NAME
      5529**DCL     12836>>ASSIGN  12843--ASSIGN  12843--ASSIGN
DIN_NAME.LEN
      5529**DCL     12844>>ASSIGN
DONT_ORG
     12880**LABEL   12865--GOTO
DONT_PRINT
     12118**DCL     13391<<ASSIGN  13432>>IF      13433<<ASSIGN  13469<<ASSIGN  13476<<ASSIGN
EA_TIME
     13003**LABEL   12988--CALLALT
EI_KEY.KEY
      5934**DCL      5934--REDEF    5934--REDEF    5934--REDEF
EO_OCB.TYPE
      5434**DCL      5435--REDEF
EQ_IDX
     12594**DCL     12956<<ASSIGN  12966>>IF      12968>>ASSIGN  12971>>ASSIGN
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:324  
EXP_TIME
     12597**DCL     13069<>CALL    13073<<ASSIGN  13074--ASSIGN
F$
     12115**DCL     13436<<ASSIGN  13437>>ASSIGN  13440>>ASSIGN  13442>>ASSIGN
F$DCB.ACTPOS
     12170**DCL     12170--REDEF
F$DCB.ARS
     12145**DCL     12145--REDEF   12892>>CALLBLT
F$DCB.ATTR
     12163**DCL     12164--REDEF
F$DCB.BLKL
     12160**DCL     12883>>CALLBLT
F$DCB.BLOCKED
     12159**DCL     13307>>CALL
F$DCB.BORROW
     12178**DCL     12178--REDEF   12178--REDEF   12178--REDEF
F$DCB.DCBNAME.L
     12192**DCL     12192--IMP-SIZ
F$DCB.DENSITY
     12165**DCL     13025>>DOCASE
F$DCB.DESC.ARCHIVE
     12153**DCL     12861>>IF
F$DCB.DESC.DELF
     12152**DCL     12859>>IF
F$DCB.EOMCHAR
     12149**DCL     12149--REDEF
F$DCB.FLDID
     12173**DCL     12173--REDEF
F$DCB.FORM$
     12167**DCL     12167--REDEF
F$DCB.FSECT
     12183**DCL     12183--REDEF
F$DCB.FSN
     12160**DCL     12160--REDEF   12160--REDEF   12161--REDEF   12893>>CALLBLT
F$DCB.HEADER$
     12166**DCL     12166--REDEF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:325  
F$DCB.IXTNSIZE
     12164**DCL     12164--REDEF
F$DCB.LASTSTA$
     12154**DCL     12154--REDEF
F$DCB.LVL
     12179**DCL     12179--REDEF
F$DCB.NAME.C
     12154**DCL     12154--REDEF
F$DCB.NOEOF
     12175**DCL     12175--REDEF
F$DCB.NRECS
     12165**DCL     12165--REDEF
F$DCB.NRECX
     12184**DCL     12184--REDEF
F$DCB.OHDR
     12176**DCL     12176--REDEF
F$DCB.ORG
     12159**DCL     12159--REDEF   12873>>DOWHILE 13166>>IF      13204>>DOWHILE 13339>>IF
F$DCB.PRECNO
     12182**DCL     12182--REDEF
F$DCB.PSN
     12155**DCL     12885>>ASSIGN
F$DCB.RCSZ
     12187**DCL     12187--REDEF
F$DCB.RECL
     12160**DCL     12884>>CALLBLT
F$DCB.RES
     12155**DCL     12155--REDEF
F$DCB.SETX
     12167**DCL     12167--REDEF
F$DCB.SPANNED
     12159**DCL     13308>>CALL
F$DCB.STARTX
     12170**DCL     13436>>ASSIGN
F$DCB.TAB$
     12166**DCL     12167--REDEF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:326  
F$DCB.TDA
     12181**DCL     12181--REDEF
F$DCB.TYPE
     12155**DCL     12877>>ASSIGN
F$DCB.WSN
     12156**DCL     12156--REDEF
FINISH_COLARY_BUF
     13572**PROC    13374--CALL
FINISH_NUMARY_BUF
     13556**PROC    13170--CALL    13175--CALL    13192--CALL    13215--CALL    13245--CALL    13253--CALL
     13265--CALL    13271--CALL    13285--CALL    13350--CALL
FIN_TEXT
     13329**LABEL   13325--CALLALT
FITALTKEYS.K.KEYL
     11999**DCL     13372>>CALLBLT
FITALTKEYS.K.KEYX
     11999**DCL     13371>>CALLBLT
FITALTKEYS.K.UNIQUE
     12000**DCL     13373>>ASSIGN
FITALTKEYS.NUMENTS
     11998**DCL     13355>>IF      13366>>DOINDEX
FM$FIELD_START.OFFSET
     12138**DCL     13437>>ASSIGN  13440>>ASSIGN  13442>>ASSIGN
FM$FIT.CODES.NAW
     11969**DCL     13214>>CALLBLT
FM$FIT.CODES.NDW
     11969**DCL     12932>>ASSIGN
FPARAM$
      5239**DCL     12901>>ASSIGN  12913>>ASSIGN  12929>>ASSIGN  12932>>ASSIGN  12987>>ASSIGN  13043>>ASSIGN
     13061>>ASSIGN  13103>>ASSIGN  13113>>ASSIGN  13137>>ASSIGN  13160>>ASSIGN  13199>>ASSIGN  13214>>CALLBLT
     13219>>ASSIGN  13238>>ASSIGN  13258>>ASSIGN  13312>>ASSIGN  13324>>ASSIGN  13343>>ASSIGN  13353>>ASSIGN
     13380>>ASSIGN  13392>>ASSIGN  13487>>ASSIGN
FPT_CLOSE_EI
      6775**DCL     12895<>CALL
FPT_CLOSE_EI.SN_
      6775**DCL      6775--REDEF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:327  
FPT_CLOSE_EI.UTL_
      6776**DCL      6776--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6790**DCL      6790--REDEF
FPT_CLOSE_EI.V.TYPE#
      6788**DCL      6788--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6785**DCL      6785--REDEF    6787--REDEF
FPT_CLOSE_PTL.SN_
      6901**DCL      6901--REDEF
FPT_CLOSE_PTL.UTL_
      6902**DCL      6902--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6916**DCL      6916--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6914**DCL      6914--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6911**DCL      6911--REDEF    6913--REDEF
FPT_CLOSE_READ.SN_
      6817**DCL      6817--REDEF
FPT_CLOSE_READ.UTL_
      6818**DCL      6818--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6832**DCL      6832--REDEF
FPT_CLOSE_READ.V.TYPE#
      6830**DCL      6830--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6827**DCL      6827--REDEF    6829--REDEF
FPT_CLOSE_SI.SN_
      6985**DCL      6985--REDEF
FPT_CLOSE_SI.UTL_
      6986**DCL      6986--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      7000**DCL      7000--REDEF
FPT_CLOSE_SI.V.TYPE#
      6998**DCL      6998--REDEF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:328  
FPT_CLOSE_SI.V.XTNSIZE#
      6995**DCL      6995--REDEF    6997--REDEF
FPT_CLOSE_STD.SN_
      6943**DCL      6943--REDEF
FPT_CLOSE_STD.UTL_
      6944**DCL      6944--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6958**DCL      6958--REDEF
FPT_CLOSE_STD.V.TYPE#
      6956**DCL      6956--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6953**DCL      6953--REDEF    6955--REDEF
FPT_CLSEI_FT.SN_
      6859**DCL      6859--REDEF
FPT_CLSEI_FT.UTL_
      6860**DCL      6860--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6874**DCL      6874--REDEF
FPT_CLSEI_FT.V.TYPE#
      6872**DCL      6872--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6869**DCL      6869--REDEF    6871--REDEF
FPT_OPEN_EI.ACSVEH_
      6430**DCL      6431--REDEF
FPT_OPEN_EI.ALTKEYS_
      6436**DCL      6437--REDEF    6437--REDEF
FPT_OPEN_EI.HDR_
      6435**DCL      6436--REDEF
FPT_OPEN_EI.TAB_
      6434**DCL      6435--REDEF
FPT_OPEN_EI.UHL_
      6428**DCL      6429--REDEF    6429--REDEF
FPT_OPEN_EI.V.FSN#
      6468**DCL      6468--REDEF    6468--REDEF
FPT_OPEN_EI.WSN_
      6434**DCL      6434--REDEF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:329  
FPT_OPEN_EI_SAVE.ACSVEH_
      6539**DCL      6540--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6545**DCL      6546--REDEF    6546--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6544**DCL      6545--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6543**DCL      6544--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6537**DCL      6538--REDEF    6538--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6577**DCL      6577--REDEF    6577--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6543**DCL      6543--REDEF
FPT_OPEN_OUT.ACSVEH_
      6321**DCL      6322--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6327**DCL      6328--REDEF    6328--REDEF
FPT_OPEN_OUT.HDR_
      6326**DCL      6327--REDEF
FPT_OPEN_OUT.TAB_
      6325**DCL      6326--REDEF
FPT_OPEN_OUT.UHL_
      6319**DCL      6320--REDEF    6320--REDEF
FPT_OPEN_OUT.V.FSN#
      6359**DCL      6359--REDEF    6359--REDEF
FPT_OPEN_OUT.WSN_
      6325**DCL      6325--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6212**DCL      6213--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6218**DCL      6219--REDEF    6219--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6217**DCL      6218--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6216**DCL      6217--REDEF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:330  
FPT_OPEN_OUT_SAVE.UHL_
      6210**DCL      6211--REDEF    6211--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6250**DCL      6250--REDEF    6250--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6216**DCL      6216--REDEF
FPT_PRECORD
     12259**DCL     12886<>CALL
FPT_PRECORD.V
     12261**DCL     12259--DCLINIT
FPT_READ_STD.STATION_
      6640**DCL      6641--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6652**DCL      6652--REDEF
FPT_READ_STD.V.INDX#
      6650**DCL      6650--REDEF
FPT_READ_UC.STATION_
      6601**DCL      6602--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6613**DCL      6613--REDEF
FPT_READ_UC.V.INDX#
      6611**DCL      6611--REDEF
FPT_TIME
     12284**DCL     12908<>CALL    13050<>CALL    13075<>CALL    13123<>CALL    13147<>CALL    13226<>CALL
FPT_TIME.TSTAMP_
     12287**DCL     12905<<ASSIGN  12907<<ASSIGN  13047<<ASSIGN  13049<<ASSIGN  13074<<ASSIGN  13120<<ASSIGN
     13122<<ASSIGN  13144<<ASSIGN  13146<<ASSIGN  13223<<ASSIGN  13225<<ASSIGN
FPT_TIME.V
     12288**DCL     12284--DCLINIT
FPT_UNFID_EI IN PROCEDURE GET_FULL_FID
     13651**DCL     13660<>CALL
FPT_UNFID_EI.TEXTFID_ IN PROCEDURE GET_FULL_FID
     13651**DCL     13658--ASSIGN  13659--ASSIGN
FPT_UNFID_EI.V IN PROCEDURE GET_FULL_FID
     13655**DCL     13651--DCLINIT
FPT_WRITE_ME.STATION_
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:331  
      6709**DCL      6709--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6716**DCL      6716--REDEF
FPT_WRITE_OUT.STATION_
      6740**DCL      6740--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6747**DCL      6747--REDEF
FPT_WRITE_UC.STATION_
      6678**DCL      6678--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6685**DCL      6685--REDEF
FROM_SN.SN
      5584**DCL      5585--REDEF
GETCMD.OUT$
      4791**DCL      4797--REDEF
GET_FULL_FID
     13628**PROC    12832--CALL    12840--CALL
I
     12591**DCL     12872<<ASSIGN  12873>>DOWHILE 12873>>DOWHILE 12874<<ASSIGN  12874>>ASSIGN  12876>>ASSIGN
     12941<<CALLBLT 12942>>ASSIGN  12943>>CALLBLT 12957<<DOINDEX 12958>>IF      12961>>ASSIGN  12963>>ASSIGN
     13203<<ASSIGN  13204>>DOWHILE 13204>>DOWHILE 13205<<ASSIGN  13205>>ASSIGN  13207>>CALLBLT 13366<<DOINDEX
     13370>>CALLBLT 13371>>CALLBLT 13372>>CALLBLT 13373>>ASSIGN  13406<<DOINDEX 13408>>DOWHILE 13416>>CALLBLT
     13421>>DOWHILE 13437>>ASSIGN  13440>>ASSIGN  13442>>ASSIGN  13449>>CALLBLT 13453>>CALLBLT 13455>>ASSIGN
     13470>>CALLBLT 13477>>CALLBLT 13501<<DOINDEX 13506>>CALLBLT
I IN PROCEDURE FINISH_COLARY_BUF
     13580**DCL     13581<<DOINDEX 13582>>IF      13584>>CALL
I IN PROCEDURE FINISH_NUMARY_BUF
     13564**DCL     13565<<DOINDEX 13566>>CALL
ICB.DEV_MASK
      5658**DCL     12880>>IF
ICB.DEV_MASK.MAN_TAPE
      5661**DCL     13015>>IF      13304>>IF
ICB.FFID
      5630**DCL     12831>>IF      12839>>IF
ICB.FID.STRING
      5608**DCL      5609--REDEF
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:332  
IDX IN PROCEDURE XTEND_BUF
     13596**DCL     13590--PROC    13622>>ASSIGN  13624>>ASSIGN
IFSFA_PARAM.EOMCHAR#
      5963**DCL      5964--REDEF
IFSFA_PARAM.SIG1
      5957**DCL      5957--REDEF
IFSFA_PARAM.SIG2
      5957**DCL      5958--REDEF
INCONSIST_BUF
     12212**DCL     12993--ASSIGN  12994>>ASSIGN
IN_RES
      5530**DCL      5530--REDEF
IN_SN.SN
      5546**DCL      5547--REDEF
J
     12592**DCL     13407<<ASSIGN  13408>>DOWHILE 13408>>DOWHILE 13410<<ASSIGN  13410>>ASSIGN  13430>>ASSIGN
     13431>>ASSIGN  13445>>DOCASE  13500<<ASSIGN  13508>>CALLBLT 13511>>DOUNTIL 13512>>CALLBLT 13520<<ASSIGN
     13520>>ASSIGN
K
     12117**DCL     13393<<ASSIGN  13394<>CALL    13420<<ASSIGN  13421>>DOWHILE 13421>>DOWHILE 13422<<ASSIGN
     13422>>ASSIGN  13424>>IF      13425>>CALLBLT
LEN IN PROCEDURE CHECK_BUF
     13545**DCL     13534--PROC    13547>>IF
LEN IN PROCEDURE GET_FULL_FID
     13637**DCL     13628--PROC    13664<<ASSIGN
LENGTH IN PROCEDURE GET_FULL_FID
     13638**DCL     13655--DCLINIT 13664>>ASSIGN
LEN_BITS
     12111**DCL     13442<<ASSIGN  13443>>CALLBLT
LEN_BYTES
     12109**DCL     12832<>CALL    12833>>ASSIGN  12840<>CALL    12844<<ASSIGN  12846>>ASSIGN  13440<<ASSIGN
     13441>>CALLBLT 13442>>ASSIGN
LEN_WRDS
     12107**DCL     13437<<ASSIGN  13438>>CALLBLT 13440>>ASSIGN  13442>>ASSIGN
LIST_BUF$
      5235**DCL     12217--IMP-PTR 12820>>IF      12821<>CALL    12827>>ASSIGN  12832>>CALL    12833>>ASSIGN
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:333  
     12836>>ASSIGN  12840>>CALL    12843>>ASSIGN  12846>>ASSIGN  12850>>ASSIGN  12858>>ASSIGN  12864>>ASSIGN
     12869>>ASSIGN  12876>>ASSIGN  12877>>ASSIGN  12883>>CALLBLT 12884>>CALLBLT 12885>>ASSIGN  12892>>CALLBLT
     12893>>CALLBLT 12894>>CALL    12909>>ASSIGN  12910>>ASSIGN  12915>>CALLBLT 12916>>CALLBLT 12917>>CALLBLT
     12920>>CALL    12921>>CALL    12922>>CALL    12925>>ASSIGN  12975>>ASSIGN  12975>>ASSIGN  12995>>ASSIGN
     12995>>ASSIGN  13003>>ASSIGN  13003>>ASSIGN  13038>>ASSIGN  13038>>ASSIGN  13058>>ASSIGN  13058>>ASSIGN
     13083>>ASSIGN  13083>>ASSIGN  13098>>ASSIGN  13098>>ASSIGN  13133>>ASSIGN  13133>>ASSIGN  13157>>ASSIGN
     13157>>ASSIGN  13187>>ASSIGN  13187>>ASSIGN  13209>>ASSIGN  13209>>ASSIGN  13234>>ASSIGN  13234>>ASSIGN
     13280>>ASSIGN  13280>>ASSIGN  13293>>ASSIGN  13293>>ASSIGN  13329>>ASSIGN  13329>>ASSIGN  13361>>ASSIGN
     13361>>ASSIGN  13365>>ASSIGN  13365>>ASSIGN  13388>>ASSIGN  13388>>ASSIGN  13399>>ASSIGN  13399>>ASSIGN
     13405>>ASSIGN  13405>>ASSIGN  13482>>ASSIGN  13482>>ASSIGN  13495>>ASSIGN  13495>>ASSIGN  13499>>ASSIGN
     13499>>ASSIGN  13523>>ASSIGN  13523>>ASSIGN  13547>>IF      13548<>CALL    13568>>ASSIGN  13568>>ASSIGN
     13586>>ASSIGN  13586>>ASSIGN
LIST_CODE
     12216**DCL         6--PROC    12828>>IF      12847>>IF      13007>>IF      13336>>IF
LIST_SIZE
      5235**DCL     12825<<ASSIGN  13547>>IF      13552<<ASSIGN  13552>>ASSIGN
LOOP_END
     12985**LABEL   12931--CALLALT
M$CLOSE
        48**DCL-ENT 12895--CALL
M$EI$
      5999**DCL     12859>>IF      12861>>IF      12873>>DOWHILE 12877>>ASSIGN  12883>>CALLBLT 12884>>CALLBLT
     12885>>ASSIGN  12892>>CALLBLT 12893>>CALLBLT 13025>>DOCASE  13166>>IF      13204>>DOWHILE 13307>>CALL
     13308>>CALL    13339>>IF      13436>>ASSIGN
M$PRECORD
        52**DCL-ENT 12886--CALL
M$TIME
       115**DCL-ENT 12908--CALL    13050--CALL    13075--CALL    13123--CALL    13147--CALL    13226--CALL
M$UNFID
       111**DCL-ENT 13660--CALL
NAME$ IN PROCEDURE GET_FULL_FID
     13636**DCL     13628--PROC    13658>>ASSIGN
NEVER_EXPIRE
     13095**LABEL   13062--CALLALT 13065--GOTO    13075--CALLALT
NEW_BUF$
     12603**DCL     12936<<ASSIGN  12942>>ASSIGN  12943>>CALLBLT 12943>>CALLBLT 12950>>ASSIGN  12951>>CALLBLT
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:334  
     12951>>CALLBLT 12956>>ASSIGN  12961>>ASSIGN  12961>>ASSIGN  12963>>ASSIGN  12963>>ASSIGN  12966>>IF
     12968>>ASSIGN  12971>>ASSIGN  12972>>IF      12976>>ASSIGN  12980>>ASSIGN  12982>>ASSIGN
NO_ALT_IDX
     13373**LABEL   13354--CALLALT 13357--GOTO
NO_CODE18
     13479**LABEL   13381--CALLALT 13384--GOTO
NO_CODE19
     13523**LABEL   13488--CALLALT 13491--GOTO
NO_CODE_15
     13211**LABEL   13200--CALLALT
NO_CODE_2
     13258**LABEL   13239--CALLALT
NO_CODE_2_AGAIN
     13349**LABEL   13344--CALLALT
NO_CODE_3
     12925**LABEL   12914--CALLALT
NO_CODE_3_AGAIN
     13199**LABEL   13161--CALLALT
NO_CODE_4
     12913**LABEL   12902--CALLALT
NO_CODE_4_AGAIN
     13103**LABEL   13044--CALLALT 13050--CALLALT
NO_CODE_5
     13136**LABEL   13114--CALLALT 13117--GOTO    13123--CALLALT
NO_CODE_6
     13160**LABEL   13138--CALLALT 13141--GOTO    13147--CALLALT
NO_CREATION
     13234**LABEL   13220--CALLALT 13226--CALLALT
NO_DP_LT
     13113**LABEL   13105--CALLALT
NO_LAST_CODE_3
     13324**LABEL   13313--CALLALT
NO_UR_INFO
     13284**LABEL   13259--CALLALT
NUM$ARY.N.NUM
     12585**DCL     13165<<CALLBLT 13169<<CALLBLT 13191<<CALLBLT 13214<<CALLBLT 13243<<CALLBLT 13244<<CALLBLT
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:335  
     13250<<CALLBLT 13251<<CALLBLT 13252<<CALLBLT 13263<<CALLBLT 13264<<CALLBLT 13269<<CALLBLT 13270<<CALLBLT
     13284<<CALLBLT 13348<<CALLBLT 13349<<CALLBLT 13566--CALL
NUM_BYTES
     12596**DCL     12932<<ASSIGN  12934>>DOWHILE 12934>>DOWHILE
OCB.TYPE
      5292**DCL      5293--REDEF
OFSFA_PARAM.EOMCHAR#
      5993**DCL      5994--REDEF
OFSFA_PARAM.SIG1
      5987**DCL      5987--REDEF
OFSFA_PARAM.SIG2
      5987**DCL      5988--REDEF
OLD_BUF$
     12602**DCL     12925<<ASSIGN  12936>>ASSIGN  12936>>ASSIGN  12972>>IF      12976<<ASSIGN  12980>>ASSIGN
     12980>>ASSIGN  12992<<ASSIGN  12992>>ASSIGN  12992>>ASSIGN  12993>>ASSIGN  12994>>ASSIGN  12994>>ASSIGN
     13000<<ASSIGN  13000>>ASSIGN  13000>>ASSIGN  13001>>ASSIGN  13002>>ASSIGN  13002>>ASSIGN  13023<<ASSIGN
     13023>>ASSIGN  13023>>ASSIGN  13024>>ASSIGN  13035>>CALLBLT 13035>>CALLBLT 13051<<ASSIGN  13051>>ASSIGN
     13051>>ASSIGN  13052>>ASSIGN  13053>>CALLBLT 13053>>CALLBLT 13076<<ASSIGN  13076>>ASSIGN  13076>>ASSIGN
     13077>>ASSIGN  13078>>CALLBLT 13078>>CALLBLT 13092<<ASSIGN  13092>>ASSIGN  13092>>ASSIGN  13093>>ASSIGN
     13094>>CALLBLT 13094>>CALLBLT 13124<<ASSIGN  13124>>ASSIGN  13124>>ASSIGN  13125>>ASSIGN  13126>>CALLBLT
     13126>>CALLBLT 13148<<ASSIGN  13148>>ASSIGN  13148>>ASSIGN  13149>>ASSIGN  13150>>CALLBLT 13150>>CALLBLT
     13162<<ASSIGN  13162>>ASSIGN  13162>>ASSIGN  13163>>ASSIGN  13164>>ASSIGN  13164>>ASSIGN  13165>>CALLBLT
     13169>>CALLBLT 13174>>ASSIGN  13181<<ASSIGN  13181>>ASSIGN  13181>>ASSIGN  13185>>ASSIGN  13186>>ASSIGN
     13191>>CALLBLT 13193>>ASSIGN  13195>>ASSIGN  13195>>ASSIGN  13201<<ASSIGN  13201>>ASSIGN  13201>>ASSIGN
     13202>>ASSIGN  13207>>CALLBLT 13207>>CALLBLT 13211<<ASSIGN  13211>>ASSIGN  13211>>ASSIGN  13212>>ASSIGN
     13213>>ASSIGN  13213>>ASSIGN  13214>>CALLBLT 13227<<ASSIGN  13227>>ASSIGN  13227>>ASSIGN  13228>>ASSIGN
     13229>>CALLBLT 13229>>CALLBLT 13240<<ASSIGN  13240>>ASSIGN  13240>>ASSIGN  13241>>ASSIGN  13242>>ASSIGN
     13242>>ASSIGN  13243>>CALLBLT 13244>>CALLBLT 13246<<ASSIGN  13246>>ASSIGN  13246>>ASSIGN  13247>>ASSIGN
     13248>>ASSIGN  13248>>ASSIGN  13250>>CALLBLT 13251>>CALLBLT 13252>>CALLBLT 13260<<ASSIGN  13260>>ASSIGN
     13260>>ASSIGN  13261>>ASSIGN  13262>>ASSIGN  13262>>ASSIGN  13263>>CALLBLT 13264>>CALLBLT 13266<<ASSIGN
     13266>>ASSIGN  13266>>ASSIGN  13267>>ASSIGN  13268>>ASSIGN  13268>>ASSIGN  13269>>CALLBLT 13270>>CALLBLT
     13272<<ASSIGN  13272>>ASSIGN  13272>>ASSIGN  13273>>ASSIGN  13274>>CALLBLT 13274>>CALLBLT 13281<<ASSIGN
     13281>>ASSIGN  13281>>ASSIGN  13282>>ASSIGN  13283>>ASSIGN  13283>>ASSIGN  13284>>CALLBLT 13290<<ASSIGN
     13290>>ASSIGN  13290>>ASSIGN  13291>>ASSIGN  13292>>CALLBLT 13292>>CALLBLT 13302<<ASSIGN  13302>>ASSIGN
     13302>>ASSIGN  13303>>ASSIGN  13345<<ASSIGN  13345>>ASSIGN  13345>>ASSIGN  13346>>ASSIGN  13347>>ASSIGN
     13347>>ASSIGN  13348>>CALLBLT 13349>>CALLBLT 13358<<ASSIGN  13358>>ASSIGN  13358>>ASSIGN  13359>>ASSIGN
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:336  
     13360>>ASSIGN  13360>>ASSIGN  13362<<ASSIGN  13362>>ASSIGN  13362>>ASSIGN  13363>>ASSIGN  13364>>ASSIGN
     13364>>ASSIGN  13367<<ASSIGN  13367>>ASSIGN  13367>>ASSIGN  13368>>ASSIGN  13369>>ASSIGN  13369>>ASSIGN
     13370>>CALLBLT 13371>>CALLBLT 13372>>CALLBLT 13373>>ASSIGN  13385<<ASSIGN  13385>>ASSIGN  13385>>ASSIGN
     13386>>ASSIGN  13387>>ASSIGN  13387>>ASSIGN  13389<<ASSIGN  13389>>ASSIGN  13389>>ASSIGN  13390>>ASSIGN
     13398>>ASSIGN  13398>>ASSIGN  13400<<ASSIGN  13400>>ASSIGN  13400>>ASSIGN  13401>>ASSIGN  13402>>ASSIGN
     13402>>ASSIGN  13403>>ASSIGN  13404>>ASSIGN  13412<<ASSIGN  13412>>ASSIGN  13412>>ASSIGN  13413<>CALL
     13414>>ASSIGN  13415>>ASSIGN  13415>>ASSIGN  13429>>CALLBLT 13430>>ASSIGN  13431>>ASSIGN  13434>>ASSIGN
     13444>>CALLBLT 13449>>CALLBLT 13450>>CALL    13451>>ASSIGN  13453>>CALLBLT 13454>>CALL    13457>>CALLBLT
     13459>>CALLBLT 13460>>CALL    13462>>ASSIGN  13470>>CALLBLT 13471>>CALL    13472>>ASSIGN  13477>>CALLBLT
     13478>>CALL    13479>>ASSIGN  13480>>ASSIGN  13492<<ASSIGN  13492>>ASSIGN  13492>>ASSIGN  13493>>ASSIGN
     13494>>ASSIGN  13494>>ASSIGN  13496<<ASSIGN  13496>>ASSIGN  13496>>ASSIGN  13497>>ASSIGN  13498>>ASSIGN
     13498>>ASSIGN  13502<<ASSIGN  13502>>ASSIGN  13502>>ASSIGN  13503<>CALL    13504>>ASSIGN  13505>>ASSIGN
     13505>>ASSIGN  13506>>CALLBLT 13507>>CALL    13508>>CALLBLT 13510>>ASSIGN  13566>>CALL    13582>>IF
     13584>>CALL    13622>>ASSIGN  13622>>ASSIGN  13624>>ASSIGN  13624>>ASSIGN
ON_BUF
     12292**DCL     12293--REDEF   13126>>CALLBLT 13150>>CALLBLT
ON_BUF_RDF.DP_LT
     12295**DCL     13104<<ASSIGN  13108<<ASSIGN  13110<<ASSIGN  13136<<ASSIGN
ORG_TBL.ABBR
      5930**DCL     12876>>ASSIGN  13207>>CALLBLT
ORG_TBL.ORG_MON
      5930**DCL     12873>>DOWHILE 13204>>DOWHILE
OUT_SN.SN
      5564**DCL      5565--REDEF
P$
     12116**DCL     13462<<ASSIGN  13463>>DOWHILE 13464<<ASSIGN  13464>>ASSIGN  13466>>ASSIGN
PREC_ALT
     12888**LABEL   12886--CALLALT
PTR$
     12593**DCL     13510<<ASSIGN  13518>>CALLBLT 13519<<ASSIGN  13519>>ASSIGN  13522>>ASSIGN
PTR$ IN PROCEDURE CHECK_BUF
     13544**DCL     13534--PROC    13547>>IF
SPEC_BUF
      5242**DCL      5242--REDEF
TBITS
     12112**DCL     13443<<CALLBLT 13444>>CALLBLT
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:337  
TBYTES
     12110**DCL     13441<<CALLBLT 13444>>CALLBLT
TCODE$
     12604**DCL     12937<<ASSIGN  12941>>CALLBLT 12943>>CALLBLT 12949>>ASSIGN  12950>>ASSIGN  12951>>CALLBLT
     12951>>CALLBLT 12958>>IF      13392<<ASSIGN  13394<>CALL    13396<<ASSIGN  13419>>IF      13421>>DOWHILE
     13421>>DOWHILE 13424>>IF
TEMP
     12119**DCL     13455<<ASSIGN  13456>>IF      13457>>CALLBLT 13459>>CALLBLT 13461>>IF
TEST_MODE
      5237**DCL     12903>>IF      13045>>IF      13071>>IF      13086>>IF      13118>>IF      13142>>IF
     13221>>IF
TEXT$C.LEN
     12206**DCL     12207--IMP-SIZ 12843>>ASSIGN  12936>>ASSIGN  12942<<ASSIGN  12943>>CALLBLT 12950<<ASSIGN
     12951>>CALLBLT 12956>>ASSIGN  12961>>ASSIGN  12963<<ASSIGN  12963>>ASSIGN  12966>>IF      12968<<ASSIGN
     12972>>IF      12972>>IF      12980<<ASSIGN  12980>>ASSIGN  12980>>ASSIGN  12982<<ASSIGN  12992>>ASSIGN
     12993<<ASSIGN  12994>>ASSIGN  13000>>ASSIGN  13001<<ASSIGN  13002>>ASSIGN  13023>>ASSIGN  13024<<ASSIGN
     13035>>CALLBLT 13051>>ASSIGN  13052<<ASSIGN  13053>>CALLBLT 13076>>ASSIGN  13077<<ASSIGN  13078>>CALLBLT
     13092>>ASSIGN  13093<<ASSIGN  13094>>CALLBLT 13124>>ASSIGN  13125<<ASSIGN  13126>>CALLBLT 13148>>ASSIGN
     13149<<ASSIGN  13150>>CALLBLT 13162>>ASSIGN  13163<<ASSIGN  13164>>ASSIGN  13174<<ASSIGN  13181>>ASSIGN
     13186<<ASSIGN  13193<<ASSIGN  13195>>ASSIGN  13201>>ASSIGN  13202<<ASSIGN  13207>>CALLBLT 13211>>ASSIGN
     13212<<ASSIGN  13213>>ASSIGN  13227>>ASSIGN  13228<<ASSIGN  13229>>CALLBLT 13240>>ASSIGN  13241<<ASSIGN
     13242>>ASSIGN  13246>>ASSIGN  13247<<ASSIGN  13248>>ASSIGN  13260>>ASSIGN  13261<<ASSIGN  13262>>ASSIGN
     13266>>ASSIGN  13267<<ASSIGN  13268>>ASSIGN  13272>>ASSIGN  13273<<ASSIGN  13274>>CALLBLT 13281>>ASSIGN
     13282<<ASSIGN  13283>>ASSIGN  13290>>ASSIGN  13291<<ASSIGN  13292>>CALLBLT 13302>>ASSIGN  13303<<ASSIGN
     13345>>ASSIGN  13346<<ASSIGN  13347>>ASSIGN  13358>>ASSIGN  13359<<ASSIGN  13360>>ASSIGN  13362>>ASSIGN
     13363<<ASSIGN  13364>>ASSIGN  13367>>ASSIGN  13368<<ASSIGN  13369>>ASSIGN  13385>>ASSIGN  13386<<ASSIGN
     13387>>ASSIGN  13389>>ASSIGN  13390<<ASSIGN  13398>>ASSIGN  13400>>ASSIGN  13401<<ASSIGN  13402>>ASSIGN
     13412>>ASSIGN  13414<<ASSIGN  13415>>ASSIGN  13492>>ASSIGN  13493<<ASSIGN  13494>>ASSIGN  13496>>ASSIGN
     13497<<ASSIGN  13498>>ASSIGN  13502>>ASSIGN  13504<<ASSIGN  13505>>ASSIGN  13622>>ASSIGN  13624<<ASSIGN
     13624>>ASSIGN
TEXT$C.STRING
     12207**DCL     12843>>ASSIGN  12943<<CALLBLT 12951<<CALLBLT 12994<<ASSIGN  13002<<ASSIGN  13035<<CALLBLT
     13053<<CALLBLT 13078<<CALLBLT 13094<<CALLBLT 13126<<CALLBLT 13150<<CALLBLT 13164<<ASSIGN  13195<<ASSIGN
     13207<<CALLBLT 13213<<ASSIGN  13229<<CALLBLT 13242<<ASSIGN  13248<<ASSIGN  13262<<ASSIGN  13268<<ASSIGN
     13274<<CALLBLT 13283<<ASSIGN  13292<<CALLBLT 13347<<ASSIGN  13360<<ASSIGN  13364<<ASSIGN  13369<<ASSIGN
     13387<<ASSIGN  13398<<ASSIGN  13402<<ASSIGN  13415<<ASSIGN  13494<<ASSIGN  13498<<ASSIGN  13505<<ASSIGN
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:338  
TEXT_C
     12242**DCL     13289<>CALL
TEXT_C.C
     12243**DCL     13291>>ASSIGN
TEXT_C.TEXT
     12244**DCL     13292>>CALLBLT
TFIELD1
     12113**DCL     13416<<CALLBLT 13417--CALL    13429>>CALLBLT
TFIELD2
     12114**DCL     13418<<ASSIGN  13425<<CALLBLT 13426--CALL    13429>>CALLBLT
TIMEWARP_BUF
     12214**DCL     13001--ASSIGN  13002>>ASSIGN
TIME_BUF
     12298**DCL     12286--DCLINIT 12287--DCLINIT
TIME_BUF.HH_MM
     12299**DCL     12909>>ASSIGN  13053>>CALLBLT 13078>>CALLBLT 13126>>CALLBLT 13150>>CALLBLT 13229>>CALLBLT
TRUTH
     12309**DCL     13373>>ASSIGN  13508>>CALLBLT
TWRDS
     12108**DCL     13438<<CALLBLT 13439--CALL    13444>>CALLBLT
TYPE_ARY.CLASS
     12447**DCL     13445>>DOCASE
TYPE_ARY.CODE
     12383**DCL     13408>>DOWHILE
TYPE_ARY.NAME
     12319**DCL     13430>>ASSIGN
TYPE_ARY.UNITS
     12511**DCL     13431>>ASSIGN
UNITS
     12312**DCL     13431>>ASSIGN
USABLE_LEN
      5244**DCL     12972>>IF
UTS_TMP
     12599**DCL     13067<>CALL
VPD$CLOBBERLZ
     12637**DCL-ENT 12894--CALL    12920--CALL    12921--CALL    12922--CALL    13091--CALL    13417--CALL
PL6.E3A0      #002=VPH$GET_LIST_BUFS File=VPH$LISTREV.:E05TSI                    WED 07/30/97 07:42 Page:339  
     13426--CALL    13439--CALL    13450--CALL    13454--CALL    13460--CALL    13471--CALL    13478--CALL
     13507--CALL    13566--CALL    13584--CALL
VPD$FETCH_CREATOR
     12811**DCL-ENT 13289--CALL
VPD$GET_BUF
     12656**DCL-ENT 12821--CALL    13548--CALL
VPL$ERR_PROC
     12791**DCL-ENT 12823--CALL    12890--CALL    13550--CALL    13662--CALL
XSF$LOCCODE
     12817**DCL-ENT 12931--CALL
XSF$LOCCODP
     12818**DCL-ENT 12902--CALL    12914--CALL    12988--CALL    13044--CALL    13062--CALL    13105--CALL
     13114--CALL    13138--CALL    13161--CALL    13200--CALL    13220--CALL    13239--CALL    13259--CALL
     13313--CALL    13325--CALL    13344--CALL    13354--CALL    13381--CALL    13394--CALL    13488--CALL
XTEND_BUF
     13590**PROC    13307--CALL    13308--CALL    13314--CALL    13315--CALL    13319--CALL    13321--CALL
     13326--CALL
XTEND_STRINGS.LEN IN PROCEDURE XTEND_BUF
     13598**DCL     13624>>ASSIGN
XTEND_STRINGS.STRING IN PROCEDURE XTEND_BUF
     13606**DCL     13622>>ASSIGN
XUD$UTS_ADJ_25TH
     11947**DCL-ENT 13067--CALL    13069--CALL
ZERO
     12211**DCL     12905--ASSIGN  13047--ASSIGN  13120--ASSIGN  13144--ASSIGN  13223--ASSIGN
