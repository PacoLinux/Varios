            
 
 
 
 
 
             MMMMM  M   M  M      M            MMMMM  MMMMM       M             XXXXX  X   X  X      X            XXXXX  XXXXX       X
             M   M  M   M  M      M            M      M   M       M             X   X  X   X  X      X            X      X   X       X
             MMMM   M   M  M      M            M      MMMMM  MMM  MMMMM             XXXX   X   X  X      X            X      XXXXX  XXX  XXXXX
             M   M  M   M  M      M            M      M           M   M             X   X  X   X  X      X            X      X           X   X
             MMMMM  MMMMM  MMMMM  MMMMM        MMMMM  M           MMMMM             XXXXX  XXXXX  XXXXX  XXXXX        XXXXX  X           XXXXX
 
               MMMMM  MMMMM  MMMMM  MMMMM  M   M    M    MMMMM  MMMMM               XXXXX  XXXXX  XXXXX  XXXXX  X   X    X    XXXXX  XXXXX
               M      M   M  M        M    M   M   M M   M   M  M               X      X   X  X        X    X   X   X X   X   X  X
               MMMMM  M   M  MMM      M    M M M  MMMMM  MMMMM  MMM               XXXXX  X   X  XXX      X    X X X  XXXXX  XXXXX  XXX
                   M  M   M  M        M    MM MM  M   M  M  M   M                   X  X   X  X        X    XX XX  X   X  X  X   X
               MMMMM  MMMMM  M        M    MM MM  M   M  M   M  MMMMM               XXXXX  XXXXX  X        X    XX XX  X   X  X   X  XXXXX
 
                  MMMMM  MMMMM  M      MMMMM    M    MMMMM  MMMMM                  XXXXX  XXXXX  X      XXXXX    X    XXXXX  XXXXX
                  M   M  M      M      M       M M   M      M                  X   X  X      X      X       X X   X      X
                  MMMMM  MMM    M      MMM    MMMMM  MMMMM  MMM                  XXXXX  XXX    X      XXX    XXXXX  XXXXX  XXX
                  M  M   M      M      M      M   M      M  M                  X  X   X      X      X      X   X      X  X
                  M   M  MMMMM  MMMMM  MMMMM  M   M  MMMMM  MMMMM                  X   X  XXXXX  XXXXX  XXXXX  X   X  XXXXX  XXXXX
 
               MMMMM  M   M  M      M      MMMMM  MMMMM  MMMMM  MM  M               XXXXX  X   X  X      X      XXXXX  XXXXX  XXXXX  XX  X
               M   M  M   M  M      M      M        M      M    MMM M               X   X  X   X  X      X      X        X      X    XXX X
               MMMM   M   M  M      M      MMM      M      M    M MMM               XXXX   X   X  X      X      XXX      X      X    X XXX
               M   M  M   M  M      M      M        M      M    M  MM               X   X  X   X  X      X      X        X      X    X  XX
               MMMMM  MMMMM  MMMMM  MMMMM  MMMMM    M    MMMMM  M  MM               XXXXX  XXXXX  XXXXX  XXXXX  XXXXX    X    XXXXX  X  XX
 
 
 
 
 
 
                                    Mirrored Disks
 
 
                              PRODUCT NUMBER RPQ SQ5560
 
 
                                       Jan 1998
 
 
       COPYRIGHT (c) BULL HN INFORMATION SYSTEMS INC., 1990, 1991, 1992, 1994,
                                         1998
 
 
 
 
 
 
                                      MMMMMMMMMM                                      XXXXXXXXXX
                                     M          M                                     X          X
                                     M MMMMMMM                                     X XXXXXXX
                                     M M      M                                     X X      X
                                     M M M MMM                                     X X X XXX
                                     M M M                                     X X X
                                     M M MMMM                                     X X XXXX
                                     M M M   M                                     X X X   X
                                     M M  MMM                                     X X  XXX
                                     M          M                                     X          X
                                      MMMMMMMMMM                                      XXXXXXXXXX
            
 
 
 
 
 
             MMMMM  M   M  M      M            MMMMM  MMMMM       M             XXXXX  X   X  X      X            XXXXX  XXXXX       X
             M   M  M   M  M      M            M      M   M       M             X   X  X   X  X      X            X      X   X       X
             MMMM   M   M  M      M            M      MMMMM  MMM  MMMMM             XXXX   X   X  X      X            X      XXXXX  XXX  XXXXX
             M   M  M   M  M      M            M      M           M   M             X   X  X   X  X      X            X      X           X   X
             MMMMM  MMMMM  MMMMM  MMMMM        MMMMM  M           MMMMM             XXXXX  XXXXX  XXXXX  XXXXX        XXXXX  X           XXXXX
 
               MMMMM  MMMMM  MMMMM  MMMMM  M   M    M    MMMMM  MMMMM               XXXXX  XXXXX  XXXXX  XXXXX  X   X    X    XXXXX  XXXXX
               M      M   M  M        M    M   M   M M   M   M  M               X      X   X  X        X    X   X   X X   X   X  X
               MMMMM  M   M  MMM      M    M M M  MMMMM  MMMMM  MMM               XXXXX  X   X  XXX      X    X X X  XXXXX  XXXXX  XXX
                   M  M   M  M        M    MM MM  M   M  M  M   M                   X  X   X  X        X    XX XX  X   X  X  X   X
               MMMMM  MMMMM  M        M    MM MM  M   M  M   M  MMMMM               XXXXX  XXXXX  X        X    XX XX  X   X  X   X  XXXXX
 
                  MMMMM  MMMMM  M      MMMMM    M    MMMMM  MMMMM                  XXXXX  XXXXX  X      XXXXX    X    XXXXX  XXXXX
                  M   M  M      M      M       M M   M      M                  X   X  X      X      X       X X   X      X
                  MMMMM  MMM    M      MMM    MMMMM  MMMMM  MMM                  XXXXX  XXX    X      XXX    XXXXX  XXXXX  XXX
                  M  M   M      M      M      M   M      M  M                  X  X   X      X      X      X   X      X  X
                  M   M  MMMMM  MMMMM  MMMMM  M   M  MMMMM  MMMMM                  X   X  XXXXX  XXXXX  XXXXX  X   X  XXXXX  XXXXX
 
               MMMMM  M   M  M      M      MMMMM  MMMMM  MMMMM  MM  M               XXXXX  X   X  X      X      XXXXX  XXXXX  XXXXX  XX  X
               M   M  M   M  M      M      M        M      M    MMM M               X   X  X   X  X      X      X        X      X    XXX X
               MMMM   M   M  M      M      MMM      M      M    M MMM               XXXX   X   X  X      X      XXX      X      X    X XXX
               M   M  M   M  M      M      M        M      M    M  MM               X   X  X   X  X      X      X        X      X    X  XX
               MMMMM  MMMMM  MMMMM  MMMMM  MMMMM    M    MMMMM  M  MM               XXXXX  XXXXX  XXXXX  XXXXX  XXXXX    X    XXXXX  X  XX
 
 
 
 
 
 
                                    Mirrored Disks
 
 
                              PRODUCT NUMBER RPQ SQ5560
 
 
                                       Jan 1998
 
 
       COPYRIGHT (c) BULL HN INFORMATION SYSTEMS INC., 1990, 1991, 1992, 1994,
                                         1998
 
 
 
 
 
 
                                      MMMMMMMMMM                                      XXXXXXXXXX
                                     M          M                                     X          X
                                     M MMMMMMM                                     X XXXXXXX
                                     M M      M                                     X X      X
                                     M M M MMM                                     X X X XXX
                                     M M M                                     X X X
                                     M M MMMM                                     X X XXXX
                                     M M M   M                                     X X X   X
                                     M M  MMM                                     X X  XXX
                                     M          M                                     X          X
                                      MMMMMMMMMM                                      XXXXXXXXXX
       
 
 
 
 
 
 
 
 
 
                                       CONTENTS
 
 
                                                                           Page
 
 
        Section 1  Introduction . . . . . . . . . . . . . . . . . . . . .   1-1
           Description of Mirrored Disks. . . . . . . . . . . . . . . . .   1-1
           Overview of Mirrored Disks . . . . . . . . . . . . . . . . . .   1-3
             Preparation of Mirrored Disks. . . . . . . . . . . . . . . .   1-3
             Designation of Mirrored Disks. . . . . . . . . . . . . . . .   1-4
             Initialization of Mirrored Disks . . . . . . . . . . . . . .   1-4
             Operation of Mirrored Disks. . . . . . . . . . . . . . . . .   1-4
             Repair of Mirrored Disks . . . . . . . . . . . . . . . . . .   1-5
             Return of Mirrored Disks . . . . . . . . . . . . . . . . . .   1-6
           Compatibility Considerations . . . . . . . . . . . . . . . . .   1-6
 
        Section 2  Product Summary. . . . . . . . . . . . . . . . . . . .   2-1
           Release Contents . . . . . . . . . . . . . . . . . . . . . . .   2-1
           Supporting Documentation . . . . . . . . . . . . . . . . . . .   2-1
           Conversion Notes . . . . . . . . . . . . . . . . . . . . . . .   2-2
           Problems Fixed in this Release . . . . . . . . . . . . . . . .   2-2
 
        Section 3  New Features . . . . . . . . . . . . . . . . . . . . .   3-1
           Processing Enhancements. . . . . . . . . . . . . . . . . . . .   3-1
             AVR Processing . . . . . . . . . . . . . . . . . . . . . . .   3-1
             Recovery Processing. . . . . . . . . . . . . . . . . . . . .   3-2
           Processor Enhancements . . . . . . . . . . . . . . . . . . . .   3-3
             ANLZ . . . . . . . . . . . . . . . . . . . . . . . . . . . .   3-3
             ELAN . . . . . . . . . . . . . . . . . . . . . . . . . . . .   3-3
             GHOST1 . . . . . . . . . . . . . . . . . . . . . . . . . . .   3-4
             MIRROR . . . . . . . . . . . . . . . . . . . . . . . . . . .   3-4
             PIG. . . . . . . . . . . . . . . . . . . . . . . . . . . . .   3-4
             VOLINIT. . . . . . . . . . . . . . . . . . . . . . . . . . .   3-5
           Host Monitor Services Enhancements . . . . . . . . . . . . . .   3-6
             M$IOQ. . . . . . . . . . . . . . . . . . . . . . . . . . . .   3-6
             M$SYSCON . . . . . . . . . . . . . . . . . . . . . . . . . .   3-7
           New processor:  MIRROR . . . . . . . . . . . . . . . . . . . .   3-7
             Commands . . . . . . . . . . . . . . . . . . . . . . . . . .   3-8
               COMPARE Command. . . . . . . . . . . . . . . . . . . . . .   3-8
               COPY Command . . . . . . . . . . . . . . . . . . . . . . .   3-11
               DATE Command . . . . . . . . . . . . . . . . . . . . . . .   3-13
               DISPLAY Command. . . . . . . . . . . . . . . . . . . . . .   3-14
               DIRECTORY Command. . . . . . . . . . . . . . . . . . . . .   3-15
               DO Command . . . . . . . . . . . . . . . . . . . . . . . .   3-16
               DONT MIRROR Command. . . . . . . . . . . . . . . . . . . .   3-17
               END Command. . . . . . . . . . . . . . . . . . . . . . . .   3-18
               ENTER Command. . . . . . . . . . . . . . . . . . . . . . .   3-18
               ERASE Command. . . . . . . . . . . . . . . . . . . . . . .   3-19
               FAIL Command . . . . . . . . . . . . . . . . . . . . . . .   3-20
               HELP Command . . . . . . . . . . . . . . . . . . . . . . .   3-21
               LOCK Command . . . . . . . . . . . . . . . . . . . . . . .   3-22
               MIRROR Command . . . . . . . . . . . . . . . . . . . . . .   3-23
               OUTPUT Command . . . . . . . . . . . . . . . . . . . . . .   3-24
       
 
 
                                   CONTENTS (cont)
 
 
                                                                           Page
 
 
               PRINT Command. . . . . . . . . . . . . . . . . . . . . . .   3-25
               SWITCH Command . . . . . . . . . . . . . . . . . . . . . .   3-26
               UNLOCK Command . . . . . . . . . . . . . . . . . . . . . .   3-27
             Options. . . . . . . . . . . . . . . . . . . . . . . . . . .   3-28
               GRANS Option . . . . . . . . . . . . . . . . . . . . . . .   3-28
               MXDIFF Option. . . . . . . . . . . . . . . . . . . . . . .   3-29
               NREPORT / REPORT Options . . . . . . . . . . . . . . . . .   3-30
               PAUSE Option . . . . . . . . . . . . . . . . . . . . . . .   3-31
 
        Section 4  Installation Procedures. . . . . . . . . . . . . . . .   4-1
 
        Section 5  Mirrored Disk Procedures . . . . . . . . . . . . . . .   5-1
           Initial Setup of Mirrored Disks. . . . . . . . . . . . . . . .   5-1
             Partition the devices. . . . . . . . . . . . . . . . . . . .   5-1
             Prepare the media. . . . . . . . . . . . . . . . . . . . . .   5-2
             Initialize the devices . . . . . . . . . . . . . . . . . . .   5-2
             Return the devices . . . . . . . . . . . . . . . . . . . . .   5-2
             Create the Mirrored Disk devices . . . . . . . . . . . . . .   5-2
             Build packsets on primary device . . . . . . . . . . . . . .   5-3
             Restore/build accounts and files . . . . . . . . . . . . . .   5-3
           Addition of a Mirrored Disk. . . . . . . . . . . . . . . . . .   5-3
             Partition the secondary device . . . . . . . . . . . . . . .   5-4
             Prepare the media. . . . . . . . . . . . . . . . . . . . . .   5-4
             Initialize the secondary device. . . . . . . . . . . . . . .   5-4
             Return the secondary device. . . . . . . . . . . . . . . . .   5-4
             Create the Mirrored Disk devices . . . . . . . . . . . . . .   5-5
           Terminate Mirrored Disk Devices. . . . . . . . . . . . . . . .   5-5
             Terminate the Mirrored Disk Operation. . . . . . . . . . . .   5-5
           Repair of a failed Mirrored Disk device. . . . . . . . . . . .   5-6
             Terminate Mirrored Disk Pair . . . . . . . . . . . . . . . .   5-6
             Partition the failed device. . . . . . . . . . . . . . . . .   5-6
             Repair the failed device . . . . . . . . . . . . . . . . . .   5-7
             Return the repaired device . . . . . . . . . . . . . . . . .   5-7
 
           Index. . . . . . . . . . . . . . . . . . . . . . . . . . . . .   i-1
       
 
 
 
 
 
                                                                      SECTION 1
 
 
                                                                   INTRODUCTION
 
 
 
 
 
 
       This Software Release Bulletin (SRB) documents the Mirrored Disk
       facility. This facility, developed by the Los Angeles Development Center
       of Bull HN under RPQ 5560, is now bundled with the HOST for the AR5.0
       release of the CP-6 operating system.
 
       The CP-6 monitor, monitor services, and processors were enhanced to
       support the Mirrored Disk facility.  In addition, a new CP-6 host
       processor, MIRROR, was created to support Mirrored Disks.
 
       This SRB documents the installation and operating procedures for
       Mirrored Disks and summarizes the interface to the CP-6 host processors
       and monitor services.  The paragraph "Supporting Documentation" in
       Section 2 includes a list of the CP-6 manuals in which the details of
       the host processor and Monitor Service enhancements are documented.
 
 
 
 
       _____________________________       DESCRIPTION OF MIRRORED DISKS
 
 
 
       A Mirrored Disk facility has been implemented within the CP-6 operating
       system.  For customer selected critical disk units, backup disk units
       may be designated using the new MIRROR processor to create Mirrored Disk
       pairs.
 
       In normal operation, the CP-6 I/O system maintains both disk units of a
       Mirrored Disk pair such that the disks are written with data
       identically, and will yield the same data when the same device relative
       addresses of the disks are read by the I/O system on behalf of
       requesting user programs and data base managers.  If I/O errors occur
       when accessing one disk of a Mirrored Disk pair, the CP-6 I/O system
       continues operations using the backup disk, and decides whether the
       errors are transitory, or so persistent as to warrant discontinuing
       further attempts to use the failed/failing disk and to terminate
       Mirrored Disk operations.  If the errors are deemed transitory,
       operations with the Mirrored Disk pair simply continue.  If the errors
       result in termination of the Mirrored Disk operation, then the customer
       may call for repairs or replacement of the effected disk and restore it
 
 
 
 
 
       SRB_MD                Description of Mirrored Disks                  1-1
       
 
 
       to Mirrored Disk operation at his/her convenience.  The operatorless
       requirement dictates that some types of recovery actions which can be
       performed only by a human operator will result in termination of the
       Mirrored Disk operation.  This recovery action will require the
       reestablishment of the Mirrored Disk pair when the system is attended.
 
       Disk restore operations to the repaired/replaced and returned disk of a
       Mirrored Disk pair are designed to operate concurrently with normal user
       I/O operations to the operational member of the pair.  The restore
       function uses the contents of the operational disk member to bring the
       returned disk member back to normal Mirrored Disk operation.
 
       This facility is available for all disk types supported by CP-6.  A disk
       actuator is the smallest unit that can become a member of a Mirrored
       Disk pair, and must be paired with another actuator of equivalent type
       and size.  In addition, the Defective Track Table (DTT) of both devices
       in a Mirrored Disk pair must be identical on each member of a Mirrored
       Disk pair because the same information must be stored at the same device
       relative address on each device.
 
       The linkage between Mirrored Disk devices is done through the Volume
       Serial Number (VSN).  The VSN is established when the device is
       initialized using VOLINIT or PIG.  The VSN is used as the link to allow
       Mirrored Disk devices to function properly even if the media is
       removable and it is moved to another device, or even if the device name
       is changed in the TIGR commands.  The same VSN is used on both devices
       to allow the PIG CATALOG to function properly.
 
       The manipulation of Mirrored Disk devices is done using the new
       processor MIRROR.  The MIRROR processor is used to create, terminate,
       and display Mirrored Disk devices.
 
       This facility does not provide a means to mirror the unmanaged portion
       of the system disk (DP#CP-6'S). A mirrored copy of DP#CP-6'S is not a
       functional copy of the unmanaged portion of the system disk.  The device
       number and probably/possibly the IOM number and channel numbers are
       (probably) incorrect.
 
       If a device containing the booted copy DP#CP-6'S is a Mirrored Disk
       device and it fails, the system will probably not go through recovery
       correctly.  The mirrored copy of DP#CP-6'S could then be used to restore
       system operation by doing a Reconfig Boot (MXT) to the Mirrored Disk
       device.
 
       This facility is not designed to replace existing disaster recovery
       techniques.  Those are still available for Mirrored Disk pairs and
       should be used in the event of any other types of failures which may
       require restoring data to both members of a Mirrored Disk pair.
 
 
 
 
 
 
 
 
 
 
       SRB_MD                Description of Mirrored Disks                  1-2
       
 
 
       __________________________       OVERVIEW OF MIRRORED DISKS
 
 
 
       The following subsections present an overview of Mirrored Disks.  A
       thorough understanding of this overview is necessary for the successful
       installation and operation of the Mirrored Disk facility.
 
 
 
 
       _____________________________       Preparation of Mirrored Disks
 
 
 
       The Mirrored Disk media are prepared by using TOLTS to format the
       device.  For FIPS and MDS devices, the TOLTS formatting utility
       automatically assigns alternate tracks for flawed tracks.  For Mirrored
       Disks on MSU0451 and MSU0501 devices, the TOLTS utility has to be
       instructed to assign alternate tracks for flawed tracks.
 
       Alternate tracks are used on Mirrored Disks because the Defective Track
       Tables (DTTs) must match.  The DTTs must match because I/O done to
       Mirrored Disks must use the same device relative address to access the
       same data.
 
       Alternate tracks are used on Mirrored Disks to allow easy replacement of
       a failed Mirrored Disk device while the other Mirrored Disk device
       continues to operate normally.  If the alternate tracks are not used,
       the replacement Mirrored Disk device must have a DTT that is a subset of
       the operating disk device.  This requirement could make the replacement
       of Mirrored Disk devices difficult, if not impossible.  If alternate
       tracks are not used, different disk devices must be examined in an
       attempt to find a device whose DTT is a subset of the remaining
       operational disk device.  Then the DTT of that device must be manually
       updated to be identical to the remaining operational disk device.
 
       After the Mirrored Disk media has been formatted using TOLTS, the media
       is initialized using VOLINIT.  For MUS0451 and MSU0501 disk devices that
       have had alternate tracks assigned, the VOLINIT NOFORMAT and ALT options
       are required.  If no alternate tracks were assigned by TOLTS, no special
       options are required.  However, the user has to manually make the DTTs
       identical.  This could require VOLINITing the disk devices more than
       once.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                Preparation of Mirrored Disks                  1-3
       
 
 
       _____________________________       Designation of Mirrored Disks
 
 
 
       Mirrored Disks are designated by using a new processor called MIRROR.
       MIRROR determines that both Mirrored Disk devices have the identical
       VSNs, identical Defective Track Tables, and the same sizes before making
       the devices into Mirrored Disk devices.
 
       Ensuring that the devices are the same size is sufficient.  There a
       several different disk model numbers that have the same size.  These
       different disk model numbers with the same size are FIPS disks.  If the
       size of these devices are the same they can be used as Mirrored Disk
       devices.
 
 
 
 
       ________________________________       Initialization of Mirrored Disks
 
 
 
       Once the Mirrored Disk devices have been designated, the devices are
       initialized.  This initialization is done by using either PIG (to
       SCRATCH and BUILD packsets on the primary Mirrored Disk device) or by
       using EFT (to TRANSPORT, TRANSFER, or RESTORE accounts and files to the
       primary Mirrored Disk device).
 
 
 
 
       ___________________________       Operation of Mirrored Disks
 
 
 
       Mirrored Disk operation is invisible to user programs and to most system
       processors.  Writes to operational Mirrored Disks are done to both
       devices.  Reads from operational Mirrored Disks are done from the
       primary device.
 
       One of the Mirrored Disk devices is referred to as the primary Mirrored
       Disk device.  The other Mirrored Disk device is referred to as the
       secondary Mirrored Disk device.  Any Mirrored Disk device can be either
       a primary or a secondary device.  The choice of primary and secondary
       will be made either by the operating system (AVR processing) when
       recognizing Mirrored Disk devices or by the MIRROR processor when
       creating Mirrored Disk devices.
 
       The primary Mirrored Disk device is the device to which all other system
       tables refer.  None of the system tables (except the DCTs) know of the
       secondary Mirrored Disk device.  The primary Mirrored Disk device
       remains the primary Mirror Disk device until the next time the Mirrored
       Disk devices go through the AVR processing.
 
 
 
 
 
       SRB_MD                 Operation of Mirrored Disks                   1-4
       
 
 
       The concept of a primary Mirrored Disk device is necessary to support
       several features of Mirrored Disks.  This concept allows the comparison
       of operational Mirrored Disk devices.  Since normal system I/O is always
       done to the primary Mirrored Disk device first, a comparison can be done
       on operational Mirrored Disks by doing the reads, locks, and unlocks of
       the primary and secondary Mirrored Disk devices in the proper order.
 
       The concept of a primary Mirrored Disk device allows the dissolution of
       a Mirrored Disk pair.  The primary device becomes a normal disk device.
       The secondary device becomes a disk that is not recognized by CP-6
       (i.e., PIG).
 
       Normal system I/O requests are always directed to the primary Mirrored
       Disk.  The I/O system handles the redirecting of the I/O requests to the
       appropriate device or devices.  If both the primary and secondary
       Mirrored Disk are operational, write requests are done to both devices,
       and reads are done from the primary device.  If one Mirrored Disk is not
       operational, all I/O requests are done to the remaining operational
       device.
 
       If an I/O error is detected on a Mirrored Disk device, the I/O is
       retried on that device.  If the I/O retry count is exhausted and if the
       other Mirrored Disk device is operational, the Mirrored Disk operation
       is terminated: the operational Mirrored Disk device becomes a normal
       CP-6 disk device and the Mirrored Disk device that had the irrecoverable
       I/O error is no longer recognized by CP-6.
 
       If the I/O retry count is exhausted and if the other Mirrored Disk
       device is not operational, the I/O error is processed according to
       current CP-6 I/O error handling methods.
 
 
 
 
       ________________________       Repair of Mirrored Disks
 
 
 
       After a Mirrored Disk pair is terminated, the failing device is removed
       from operation by PARTITIONing it.  The device can then be turned over
       to CSO for repair.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                  Repair of Mirrored Disks                     1-5
       
 
 
       ________________________       Return of Mirrored Disks
 
 
 
       Once the failed device has been repaired, it can be returned to service.
       If the repair damaged or destroyed the format or data on the device, the
       device must be reformatted using TOLTS and reinitialized using VOLINIT.
       The MIRROR processor is then used to reestablish the Mirrored Disk pair
       between the currently operating device and the repaired device.
 
 
 
 
       ____________________________       COMPATIBILITY CONSIDERATIONS
 
 
 
       The Mirrored Disks facility requires that the E05 release of the CP-6
       operating system be installed prior to installing the Mirrored Disk
       software.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                Compatibility Considerations                   1-6
       
 
 
 
 
 
                                                                      SECTION 2
 
 
                                                                PRODUCT SUMMARY
 
 
 
 
 
 
 
 
 
       ________________       RELEASE CONTENTS
 
 
       The following files make up the Mirrored Disk software.  These files
       reside in the :SYS account except for the SRB which is in :SRB account.
 
       File Name        Account      Description
       ---------        -------      -----------
       :NMERRMSG        :SYS         MIRROR error message file.
       HELP:MIRROR:     :SYS         Help file for MIRROR processor.
       MIRROR           :SYS         New processor to handle Mirrored Disks.
       :NME5_MIRROR     :SRB         Mirrored Disk SRB.
 
 
 
 
       ________________________       SUPPORTING DOCUMENTATION
 
 
 
       The following CP-6 manuals document CP-6 processor and monitor service
       enhancements implemented to support the Mirrored Disks facility.
       Descriptions of the enhancements are summarized under the heading "New
       Features" in the next section.
 
       CP-6 Host Manuals Documenting Mirrored Disk Features
       ----------------------------------------------------
 
       Manual Title                        Publication Number
       ------------                        ------------------
 
       CP-6 Operations Reference           CE34-05
       CP-6 Systems Support Reference      HA20-01, HA21-01, HA22-01
            (Volumes I through III)
       CP-6 Host Monitor Services          CE74-01, CE75-01
 
 
 
 
 
 
 
       SRB_MD                  Supporting Documentation                     2-1
       
 
 
            (Volumes I and II)
       CP-6 Host Monitor Services          CE58-01
            Error Messages
       CP-6 Software Release Bulletin      :E05_HOST
            CP-6 Host
 
 
 
 
       ________________       CONVERSION NOTES
 
 
 
       When converting MSU0451 and MSU0501 disk devices to be used as Mirrored
       Disks, they should be labeled as to whether or not alternate tracks were
       assigned.  This will prevent confusion when setting up Mirrored Disk
       devices from various different devices and when returning devices to
       non-Mirrored Disk use.
 
 
 
 
       ______________________________       PROBLEMS FIXED IN THIS RELEASE
 
 
 
       The following is a list of problems corrected for the E05 release of
       MIRROR:
 
           41644      Tries to unlock disk that it didn't lock.
           42835      TDM-M00181-7 @TDM$MIRFAIL+.46
           42837      Inconsistent state after off-line/on-line
           #q
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD               Problems Fixed in this Release                  2-2
       
 
 
 
 
 
                                                                      SECTION 3
 
 
                                                                   NEW FEATURES
 
 
 
 
 
 
 
 
 
       _______________________       PROCESSING ENHANCEMENTS
 
 
 
       The following CP-6 processing features (documented in the CP-6 System
       Support Reference Manual set) have been enhanced to support Mirrored
       Disks.
 
 
 
 
       ______________       AVR Processing
 
 
 
       Automatic Volume Recognition (AVR) processing for disks at boot time,
       during recovery, and when returning a disk drive via SYSCON has been
       updated to handle Mirrored Disks.  The AVR processing has been updated
       to read the VIDs of all spinning, nonpartitioned disks to locate all
       Mirrored Disk devices.  Once all of the Mirrored Disk devices are
       located, the DCTs for these devices are updated with the Mirrored Disk
       information.
 
       The Mirrored Disk information is obtained by reading the VIDs of any
       spinning, nonpartitioned disks.  The AVR processing determines which, if
       any, disk devices are part of Mirrored Disk pairs.  Note that both VIDs
       must be read because the UTS values would have to be compared to
       determine which Mirrored Disk device contains the most recent status
       information.
 
       If the UTS values in the VIDs match, the state of both devices can be
       set from the values in either VID.  If the UTS values in the VIDs do not
       match, then the state of both devices is set from the values in the VID
       with the latest UTS value.
 
 
 
 
 
 
 
 
       SRB_MD                       AVR Processing                          3-1
       
 
 
       If only one Mirrored Disk device of a Mirrored Disk pair is found and
       the VID of the Mirrored Disk device indicates that both Mirrored Disk
       devices were operational, the AVR process will print a message on the
       console and wait for either an operator keyin, a user command, or the
       other Mirrored Disk device being made ready.
 
       The AVR Processing would also establish the primary Mirrored Disk
       device.  If both Mirrored Disk devices are operational, either device
       could be chosen as the primary Mirrored Disk device.  If only one
       Mirrored Disk device is operational, that Mirrored Disk device must be
       chosen as the primary Mirrored Disk device.
 
 
 
 
       ___________________       Recovery Processing
 
 
 
       Recovery Processing has been updated to complete Mirrored Disk I/O
       correctly during a recovery.
 
       If a Mirrored Disk I/O request completes without an I/O error, if the
       other Mirrored Disk I/O is to be done, and if the other Mirrored Disk
       device is OPERational then the I/O request is also done on the other
       Mirrored Disk device.
 
       If a Mirrored Disk I/O request completes with an I/O error, and if the
       other Mirrored Disk device is OPERational, then the current Mirrored
       Disk is marked as PARTITIONed, and a message output to the console.  If
       the I/O is to be done on the other Mirrored Disk device, and if the
       other Mirrored Disk device is OPERational, then the I/O is done on the
       other Mirrored Disk device.  Otherwise, the Mirrored Disk I/O request
       would use normal CP-6 I/O recovery techniques.
 
       If a Mirrored Disk device is marked as being PARTITIONed, the device
       will appear to be partitioned when recovery completes.  This will
       prevent this device from being used as a Mirrored Disk after recovery is
       completed.  It cannot be used as a Mirrored Disk device because it no
       longer matches the other device in the Mirrored Disk device pair.  The
       DONT MIRROR keyin or command must be used to terminate the Mirrored Disk
       operation on the remaining Mirrored Disk device.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                     Recovery Processing                       3-2
       
 
 
       ______________________       PROCESSOR ENHANCEMENTS
 
 
 
       The following CP-6 system support processors (documented in the CP-6
       System Support Reference Manual set) have been enhanced to support
       Mirrored Disks.
 
 
 
 
       ____       ANLZ
 
 
 
       ANLZ has been enhanced to display Mirrored Disk information from the
       system tables.
 
       The ANLZ IOQ command has been modified to display the Mirrored Disk
       information in the IOQ structures.  In addition, the IOQ command has
       been modified to display the Mirrored Disk locked queue (LQ$) as well as
       the forward (SQ$) and backwards queues (BQ$).
 
       The MDCT command has been added to ANLZ to display the same items as the
       MIRROR DCT command.  This command provides an alternate way to display
       the Mirrored Disk information on the running system.  This command
       provides the only way to display the Mirrored Disk information from dump
       files.
 
 
 
 
       ____       ELAN
 
 
 
       A new error log entry type (MIRROR) was added for Mirrored Disks.  This
       error log entry is made every time a Mirrored Disk device changes state
       (e.g., FAILed, OPERational, RESToring, WAITing).
 
       ELAN has been enhanced to display these Mirrored Disk error log entries.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                            ELAN                               3-3
       
 
 
       ______       GHOST1
 
 
 
       The GHOST1 processor has been modified to find and establish Mirrored
       Disk pairs.  If both devices of a Mirrored Disk pair could not be found,
       GHOST1 would ask if a DONT MIRROR command should be done for the
       Mirrored Disk device that was found.  This keyin may be answered with a
       Y(es), N(o), or Q(uit).  This keyin would timeout (to allow unattended
       recoveries to succeed).
 
 
 
 
       ______       MIRROR
 
 
 
       MIRROR is a new system support processor that was written to support
       Mirrored Disks.  The MIRROR processor is described later in this
       section.
 
 
 
 
       ___       PIG
 
 
 
       PIG has been updated to not output the "Not a CP-6 pack" message merely
       because a disk device has the same VSN.  This message is now used only
       if the VSN is the same and the VID indicates this device is not a
       Mirrored Disk device.
 
       PIG has been updated to rewrite the VID for Mirrored Disk devices when
       the I/O system determines that a Mirrored Disk device changed state.
 
       The PIG BUILD and SCRATCH commands have been updated so that they are
       not accepted for a secondary Mirrored Disk.  Rather, these commands are
       accepted only for a primary Mirrored Disk if the disk device is a
       Mirrored Disk.  This is necessary so that the I/O is done to the primary
       Mirrored Disk before it is done to the secondary Mirrored Disk device.
       This is a requirement for proper operation of Mirrored Disks.
 
       The PIG DISPLAY command has been updated so that it will display
       additional information about Mirrored Disk devices:
 
           DISPLAY DPnn
 
       The PIG DISPLAY command has been modified to display additional
       information for the primary Mirrored Disk device:
 
            ___           !PIG
 
 
 
 
 
       SRB_MD                             PIG                               3-4
       
 
 
           Pig E05 here
            ____________           *display DP80
           DP80 has #338180, mirrored on DP81
           DP80 has #338180A, volume 1 of set #CP-6'S, reserved for CP6
           DP80 has #338180B, volume 1 of set #SYS, shared
           DP80 has E338180C, volume 1 of set #MDTEST, shared
            ___           *end
 
       The PIG DISPLAY command has been modified to display additional
       information for the secondary Mirrored Disk device:
 
            ___           !PIG
           Pig E05 here
            ____________           *display DP81
           DP81 has #338180, mirrored on DP80
            ___           *end
 
 
 
 
       _______       VOLINIT
 
 
 
       VOLINIT has been modified to set the FPT_IOQ.V.BPMIR# bit before all
       calls to M$IOQ to initialize a disk pack.  This is to prevent the
       formatting I/O from formatting the other device of a Mirrored Disk pair
       (which may be currently operational).
 
       VOLINIT has been modified to accept the ALT and NOALT options on the
       VOLINIT command.  The ALT option will be accepted only on the VOLINIT of
       MSU0451 and MSU0501 disks.  The ALT option is used to indicate that
       Alternate Tracks have been assigned using TOLTS and that the device is
       not to be formatted again (i.e., ALT forces the NOFORMAT option).  ALT
       would also cause VOLINIT to add the alternate cylinder(s) to the
       defective track table.  For an MSU0451, the alternate cylinders are 811
       through 813.  For an MSU0501, the alternate cylinder is 840.  (This is
       to prevent dual allocation of these tracks.  These tracks are the
       alternate tracks used for defective tracks found by TOLTS.)  The default
       would be NOALT (i.e., VOLINIT functions as it currently does and uses
       the alternate tracks as data tracks).
 
       VOLINIT has been modified to always set the VID to indicate that the
       device is not a Mirrored Disk device before (re)writing the VID on a
       disk device.  This is to prevent a user from modifying the DTT after a
       Mirrored Disk has been established.  The DTT is checked by MIRROR only
       when establishing a Mirrored Disk device pair.  With the VID set to
       indicate that the device is not a Mirrored Disk device, the device
       cannot be used as a Mirrored Disk until MIRROR has checked the DTT
       before establishing a Mirrored Disk device pair.
 
 
 
 
 
 
 
 
       SRB_MD                           VOLINIT                             3-5
       
 
 
       __________________________________       HOST MONITOR SERVICES ENHANCEMENTS
 
 
 
       The following monitor services have been enhanced to support Mirrored
       Disks.  For more information, refer to the CP-6 Host Monitor Services
       Reference Manual, Volumes I and II (CE74-01 and CE75-01).
 
 
 
 
       _____       M$IOQ
 
 
 
       The M$IOQ monitor service is a privileged PMME that is used to direct
       I/O requests.  This monitor has been enhanced to properly process the
       modified FPT_IOQ structure that is required to support Mirrored Disks.
 
       The FPT_IOQ MACRO is used to generate the structure that is used when
       calling the M$IOQ monitor service.  This structure has been enhanced to
       support Mirrored Disks by adding the BPMIR option.
 
           BPMIR={YES|NO}
 
               This parameter is used to specify whether or not the M$IOQ
               request is to ByPass MIRrored Disk processing.  The value from
               this parameter will be used to set the value of the
               FPT_IOQ.V.BPMIR# variable.  The default for this parameter is
               NO.
 
           FPT_IOQ.V.BPMIR#
 
               This BIT(1) variable has been added to the FPT_IOQ structure to
               specify whether ('1'B) or not ('0'B) this I/O request is to
               bypass normal Mirrored Disk I/O processing.  If this bit is set
               and this I/O request is to a Mirrored Disk, then the I/O request
               will be done only to the requested device.  If this bit is reset
               and this I/O request is to a Mirrored Disk, then the I/O request
               will be done to both Mirrored Disks if it is a write request or
               will be done to either Mirrored Disk if it is a read request.
               If this I/O request is not to a Mirrored Disk, this bit will be
               ignored.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                            M$IOQ                              3-6
       
 
 
       ________       M$SYSCON
 
 
 
       The M$SYSCON monitor service has been modified to handle the
       partitioning and returning of Mirrored Disk devices.
 
       M$SYSCON has been modified to allow the partitioning of Mirrored Disk
       devices.  If all packsets on the primary device are dismounted, both the
       primary and secondary Mirrored Disk devices are partitioned immediately.
       If all packsets on the primary are not dismounted, then both the primary
       and secondary Mirrored Disk devices will be marked for delayed
       partitioning and will not actually be partitioned at this time.
 
       No changes have been made to M$SYSCON for returning Mirrored Disk
       devices.  The AVR processing (that M$SYSCON calls when returning a
       device) will handle the returned device as indicated in the previous
       subsection entitled "AVR Processing".
 
 
 
 
       ______________________       NEW PROCESSOR:  MIRROR
 
 
 
       A new system processor, MIRROR, has been created to support Mirrored
       Disk devices.  This new processor is used to establish and terminate
       Mirrored Disk device pairs.  This new processor is also used to copy an
       active Mirrored Disk device onto a repaired Mirrored Disk device and to
       compare the contents of a Mirrored Disk pair.
 
       MIRROR is used via:
 
            ______           !MIRROR
           MIRROR E05 here
           <Mirror>
 
       MIRROR uses XUG$GETCMD to read commands through M$SI (DCB#1).  Listed
       output is written through M$LO (DCB#4).  Diagnostic output is written
       through M$DO.  The first Mirrored Disk device specified is read through
       M$EI.  The second Mirrored Disk device specified is read/written through
       M$EO.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                   New processor:  MIRROR                      3-7
       
 
 
       ________       Commands
 
 
 
       The commands accepted by MIRROR are:
 
           COMPARE         Compare Mirrored Disk pair.
           COPY            Copy operational Mirrored Disk to other Mirrored Disk.
           DATE            Display the current date and time.
           DIRECTORY       Change the default account and packset.
           DISPLAY         Display Mirrored Disk device information.
           DO              Allow the user to execute an IBEX command
                           without exiting the MIRROR processor.
           DONT MIRROR     Terminate Mirrored Disk pair.
           END             Exit MIRROR.
           ENTER           Invoke a CP-6 ADAPT dialog.
           ERASE           Delete the accumulated output for a logical device.
           FAIL            Change Mirrored Disk state to FAILed.
           HELP            Print a processor HELP file to the screen.
           LOCK            Lock Mirrored Disk device.
           MIRROR          Create Mirrored Disk device pair.
           OUTPUT          Send output to a specified file.
           PRINT           Direct output to its desintation.
           SWITCH          Switch primary Mirrored Disk device.
           UNLOCK          Unlock Mirrored Disk device.
 
 
 
 
       COMPARE COMMAND
 
 
 
 
 
       Syntax:
 
 
       COMPARE DPxx WITH DPyy [ ( options ) ]
 
 
 
       Parameters:
 
 
       DPxx  specifies the primary Mirrored Disk device that is to be compared.
 
       DPyy specifies the secondary Mirrored Disk device that is to be
           compared.  DPyy must be the secondary Mirrored Disk device for DPxx.
 
 
 
 
 
 
 
 
 
       SRB_MD                       COMPARE Command                         3-8
           
 
 
       options  are one or more of the following separated by commas:
 
               {GRANS|GRANULES} = nn
               MXDIFF = nnnnnn
               NREPORT
               PAUSE = tttttt [ { SECONDS | MS } ]
               REPORT [ = nn ]
 
           The description of these options is given in the "Options"
           subsection.
 
 
 
       Description:
 
 
       The COMPARE command is used to compare the contents of a Mirrored Disk
       pair.  Both Mirrored Disk devices must be OPERational.  DPxx must be a
       primary Mirrored Mirrored Disk device.  DPyy must be a mirror of DPxx.
 
       Once these test have been successfully completed, MIRROR starts
       comparing the contents of the Mirrored Disk pair.  The comparison starts
       with granule DRZERO.  The comparison continues until either the maximum
       number of differences specified by the MXDIFF option are found or the
       entire device has been compared.
 
       If the comparison finds no differences, the STEPCC is set to zero (if no
       other errors are detected by MIRROR).  If the comparison does find
       differences, the STEPCC is set to five (5).
 
 
 
       Usage Notes:
 
       1.  DRZERO for each Mirrored Disk is established when the Mirrored Disk
           pair is linked together.  Normally, DRZERO is 0 for all Mirrored
           Disk pairs.  However, if the first packset on the Mirrored Disk
           devices is DP#CP-6'S, then DRZERO is set to the beginning of the
           second volume (usually DP#SYS).
 
       2.  The VID in granule 0 can be different for each Mirrored Disk device.
           But when both Mirrored Disks are OPERational, the VIDs of the
           devices should be identical.
 
 
 
       Operation:
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                       COMPARE Command                         3-9
               
 
 
       MIRROR uses monitor services to read and compare the contents of device
       DPxx to DPyy.  MIRROR uses the following steps in a loop to perform the
       compare:
 
           1.  LOCK DPxx
 
               LOCK device DPxx.  This prevents I/Os being done on DPxx for
               other users.  Check to make sure that the state of DPxx is still
               unchanged.  (It can be changed by errors on system I/O done to
               the device.)  If it is not, abort the COMPARE command.
 
           2.  READ DPxx
 
                                                         ___                             Use the M$IOQ PMME to read up to the next nnn granules from
               DPxx.  FPT_IOQ.V.BPMIR# will be set.
 
           3.  LOCK DPyy
 
               LOCK device DPyy.  This makes sure previous I/Os to DPyy are
               completed.  Check to make sure the state of DPyy is unchanged.
               (It can be changed by errors on system I/O done to the device.)
               If it is not, abort the COMPARE command.
 
           4.  UNLOCK DPxx
 
               UNLOCK device DPxx.  This allows other I/Os to continue.
 
           5.  READ DPyy
 
                                                         ___                             Use the M$IOQ PMME to read up to the next nnn granules from
               DPyy.  FPT_IOQ.V.BPMIR# will be set.
 
           6.  UNLOCK DPyy
 
               UNLOCK device DPxx.  This allows other I/Os to continue.
 
           7.  COMPARE
 
               Compare the data read from DPxx and DPyy.  If the data is
               different, output the granule numbers of the differing granules.
 
           8.  WAIT
 
               Use the M$WAIT PMME to wait for the requested amount of time.
               This allows other I/O users to run.
 
       This loop is repeated until either all granules on device DPxx have been
       compared to the corresponding granules on device DPyy or the maximum
       number of differences (MXDIFF) has been exceeded.
 
       If an I/O error, BREAK, or CTRL-Y occurs during the execution of a
       COMPARE command, MIRROR UNLOCKs both DPxx and DPyy, prints an error
       message, and reads the next command from the user.
 
 
 
 
 
       SRB_MD                       COMPARE Command                        3-10
       
 
 
 
 
 
       COPY COMMAND
 
 
 
 
 
       Syntax:
 
 
       COPY DPxx OVER DPyy [ ( options ) ]
 
 
 
       Parameters:
 
 
       DPxx specifies a Mirrored Disk device that is to be copied from. DPxx
           must be an OPERational Mirrored Disk device.
 
       DPyy specifies a Mirrored Disk device that will be copied to. DPyy must
           be a FAILed Mirrored Disk device.
 
       options  are one or more of the following separated by commas:
 
               {GRANS|GRANULES} = nn
               NREPORT
               PAUSE = tttttt [ { SECONDS | MS } ]
               REPORT [ = nn ]
 
           The description of these options is given in the "Options"
           subsection.
 
 
 
       Description:
 
 
       The COPY command is used to copy the contents of an OPERational Mirrored
       Disk device over a FAILed Mirrored Disk device.  The COPY command can be
       used only on an existing Mirrored Disk pair.  (The MIRROR command can be
       used to create a Mirrored Disk pair.)
 
       Once these tests have been successfully completed, MIRROR changes the
       state of DPyy to RESToring.  The VID of DPyy is not updated at this
       time.
 
       MIRROR then starts copying DPxx over DPyy.  The copy is done GRANS
       granules per read/write.  There is a pause of PAUSE seconds/milliseconds
       at the end of the read/write loop.
 
 
 
 
 
 
       SRB_MD                        COPY Command                          3-11
       
 
 
       When the copy successfully completes, MIRROR changes the state of DPyy
       to OPERational.  The VID of DPyy is updated at this time.
 
       MIRROR uses monitor services to copy device DPxx over device DPyy.  The
       copying starts with granule one (i.e., the first granule after the VID).
       The copying always starts with granule one even if DRZERO is greater
       than one.  This allows a Mirrored Disk device that contains DP#CP-6'S to
       be used after a reconfiguration (i.e., MXT) boot in case of a device
       failure.  Starting the copy at granule one copies DP#CP-6'S.  If
       DP#CP-6'S is not copied, the mirrored copy can not be booted to in case
       of a device failure.
 
 
 
       Operation:
 
 
       MIRROR uses the following loop to do the copy operation:
 
           1.  LOCK DPxx
 
               LOCK device DPxx.  This prevents I/Os being done on DPxx for
               other users.
 
           2.  READ DPxx
 
                                                         ___                             Use the M$IOQ PMME to read up to the next nnn granules from
               DPxx.  FPT_IOQ.V.BPMIR# will be set.
 
           3.  LOCK DPyy
 
               LOCK device DPyy.  This makes sure previous I/Os to DPyy are
               completed.  Check the state of DPyy to make sure it is still
               RESToring.  (It can be changed by errors on system I/O done to
               the device.)  If it is not, abort the COPY command.
 
           4.  UNLOCK DPxx
 
               UNLOCK device DPxx.  This allows other I/Os to continue.
 
           5.  WRITE DPyy
 
               Use the M$IOQ PMME to write the granules read from DPxx to DPyy.
               FPT_IOQ.V.BPMIR# will be set.
 
           6.  UNLOCK DPyy
 
               UNLOCK device DPyy.  This allows other I/Os to continue.
 
           7.  WAIT
 
               Use the M$WAIT PMME to wait for the requested amount of time.
               This allows other I/O users to run.
 
 
 
 
 
       SRB_MD                        COPY Command                          3-12
       
 
 
       This loop is repeated until all granules (except granule 0) on device
       DPxx have been copied to device DPyy.
 
       When the loop is completed, MIRROR updates the VIDs for DPxx and DPyy
       making DPyy OPERational.  MIRROR changes the state of DPyy to
       OPERational.
 
       If an I/O error, BREAK, or CTRL-Y occurs during the execution of a COPY
       command, MIRROR UNLOCKs both DPyy and DPxx, sets the state of DPyy to
       FAIL, prints an error message, and reads the next user command.
 
 
 
       Usage Notes:
 
 
       The COPY command can be used only after a FAIL command has been used to
       change the state of a Mirrored Disk device to FAILed.
 
       The COPY command cannot be used after a Mirrored Disk pair has been
       terminated either through an irrecoverable I/O error or through the use
       of the DONT MIRROR command.  In either of these cases, the MIRROR
       command must be used to reestablished a Mirrored Disk pair.
 
 
 
 
       DATE COMMAND
 
 
 
 
 
       Syntax:
 
 
       {DATE|TIME}
 
 
 
       Description:
 
 
       DATE (and its synonym TIME) displays the current date and time.  The
       format for the display is:
 
       mmm dd 'yy hh:mm   (month)(day)(year)(hours)(minutes)
 
 
 
       Examples:
 
 
 
 
 
 
 
       SRB_MD                        DATE Command                          3-13
       
 
 
       *DATE
 
       requests a display of the current data and time.  A sample display is:
 
       AUG 10  '88  11:03
 
 
 
 
       DISPLAY COMMAND
 
 
 
 
 
       Syntax:
 
 
       DISPLAY [ ALL | DPxx [, DPyy, ... ]
 
 
 
       Parameters:
 
 
       ALL  specifies all disk devices on the system.
 
       DPxx, DPyy, ...  specifies a list of disk devices to be displayed.
 
 
 
       Description:
 
 
       The DISPLAY command is used to display the Mirrored Disk information for
       either all or specified disk devices on the system.
 
 
 
       Example:
 
 
       Device control table item headers are as follows:
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                       DISPLAY Command                        3-14
       
 
 
 
 
 
 
 
       ,----------------------------------------------------------------------,
         Header         Description
       +----------------------------------------------------------------------+
         DCTX           Device control table (DCT) index.
         DEVNAME        Device name.
         MIR            Mirrored Disk indicator. If not YES, then remainder of
                        entries are not valid.
         MDCTX          DCTX of mirror for this device.
         STATE          Mirrored Disk state for this device.
         UTS            Mirrored Disk creation time.
         LOCK           Mirrored Disk lock indicator U# and LQ$ are valid only
                        if LOCK is YES.
         U#             User who locked this Mirrored Disk.
         LQ$            Pointer to Mirrored Disk locked queue.
         DRZERO         Minimum granule number actually mirrored on this device.
       `----------------------------------------------------------------------`
 
 
 
 
 
       DIRECTORY COMMAND
 
 
 
 
 
       Syntax:
 
 
       {DIR|DIRECTORY} [fid|R[ESET]]
 
 
 
       Parameters:
 
 
       fid  specifies the new default account fid, and may consist of an
           account or a packset name and an account.
 
       RESET  specifies that the default account is to be reset to the running
           account.
 
 
 
       Description:
 
 
 
 
 
 
                                  DIRECTORY Command                        3-15
       
 
 
 
 
 
 
       This command changes the default account and packset.  The default
       account and packset are the account and associated packset that are
       selected if an account is not supplied as part of a disk file fid
       specification.  Initially, the default account is the logon or running
       account and the packset name is nil.  When used without parameters,
       DIRECTORY displays the current directory pointer.
 
 
 
       Examples:
 
 
       <MIRROR> DIRECTORY .SYSLIB
           This command directs that subsequent fids that do not include an
           account are to default to the .SYSLIB account and the packset
           associated with that account.
 
       <MIRROR> DIRECTORY DP#UTIL.Y
           This command specifies that subsequent fids that do not include an
           account are to default to the Y account on the packset named UTIL.
 
       <MIRROR> DIRECTORY RESET
           This command re-establishes the running account and its associated
           packset as the default.
 
 
 
 
       DO COMMAND
 
 
 
 
 
       Syntax:
 
 
       {DO|!} IBEX-command
 
 
 
       Parameters:
 
 
       IBEX-command  any legal IBEX command.  See the CP-6 Programmer Reference
           Manual (CE40).
 
 
 
       Description:
 
 
 
                                      DO Command                           3-16
       
 
 
 
 
 
 
       The DO command allows the user to execute an IBEX command without
       exiting the current processor.
 
       Note:  The ! (exclamation point) may be used instead of the word DO.  It
       should be noted however that if the ! is used in an XEQ file, it will
       terminate the current processor session unless preceded by at least one
       blank, or by a double ! (!!).
 
 
 
       Examples:
 
 
       <MIRROR> DO DI
           means display the current system status.
 
       <MIRROR> !LDEV LP09 TITLE='report title',PAGE=100,COPIES=3
           means set up a title and page number for a report destination.
 
 
 
 
       DONT MIRROR COMMAND
 
 
 
 
 
       Syntax:
 
 
       DONT MIRROR DPxx
 
 
 
       Parameter:
 
 
       DPxx specifies a Mirrored Disk device. DPxx must be in either the
           OPERational or WAIT state.
 
 
 
       Description:
 
 
       The DONT MIRROR command is used to terminate Mirrored Disk operation for
       a Mirrored Disk device.  This command will be accepted only for Mirrored
       Disk devices in either the OPERational or WAIT states.
 
 
 
 
                                 DONT MIRROR Command                       3-17
       
 
 
 
 
 
 
       If DPxx is a Mirrored Disk device that is OPERational, DPxx would
       continue to be used by the system as a nonmirrored disk device.  The
       mirror of DPxx would become a single volume scratch pack and would not
       be recognized by the system as a CP-6 pack.
 
       If DPxx is a Mirrored Disk device that is WAITing for its mirror device
       to be found, DPxx may or may not be used by the system.  If the VSN of
       the device is unique, DPxx will be used by the system as a nonmirrored
       disk device.  If the VSN of the device is not unique, DPxx will not be
       recognized by the system as a CP-6 pack.
 
 
 
 
       END COMMAND
 
 
 
 
 
       Syntax:
 
 
       { END | QUIT | XIT }
 
 
 
       Description:
 
 
       The END command is used to terminate the MIRROR program.
 
 
 
 
       ENTER COMMAND
 
 
 
 
 
       Syntax:
 
 
       ENTER [script_fid] [,frame_name] [initial_input]
 
 
 
       Parameters:
 
 
 
 
                                    ENTER Command                          3-18
           
 
 
 
 
 
 
       script_fid  is the file identifier for the script to be executed.
 
       frame_name  is the first frame of the script to execute.
 
       initial_input  supplies responses to the initial prompts for the dialog.
 
 
       Description:
 
 
       The ENTER command invokes a CP-6 ADAPT dialog that permits use of
       precompiled, menu-driven user interfaces called compiled scripts.
       script_fid identifies the file containing the compiled script for the
       dialog.  See the CP-6 ADAPT Reference Manual (HA12) for more information
       on using ADAPT dialogs.
 
 
 
 
       ERASE COMMAND
 
 
 
 
 
       Syntax:
 
 
       ERASE [ALL|ldevlist]
 
 
 
       Parameters:
 
 
       ALL  specifies that the accumulated output for all logical devices is to
           be deleted.  This is the default.
 
       ldevlist  specifies that the accumulated output for the specified
           logical device or devices is to be deleted.  The list is entered in
           the format
 
               ldevname[,ldevname]...
 
           ldevname is a logical device name established through the LDEV
           command.
 
 
 
       Description:
 
 
 
                                    ERASE Command                          3-19
       
 
 
 
 
 
 
       ERASE deletes the accumulated output for logical devices.
 
 
 
       Examples:
 
 
       <MIRROR> ERASE ALL
           deletes all output accumulated for all logical devices
           defined for the session or job.
 
 
 
 
       FAIL COMMAND
 
 
 
 
 
       Syntax:
 
 
       FAIL DPxx
 
 
 
       Parameter:
 
 
       DPxx  specifies a Mirrored Disk device.
 
 
 
       Description:
 
 
       The FAIL command is used to change the state of a Mirrored Disk device
       to FAILed.  This command is accepted only for a Mirrored Disk device
       whose mirror is OPERational.
 
 
 
       Usage Note:
 
 
       The FAIL command is used to force a Mirrored Disk into the FAILed state.
       This is usually done after the COMPARE command showed that the contents
       of the two Mirrored Disk devices were different.  The user selects one
       of the two Mirrored Disk devices to FAIL, and then uses the COPY command
       to restore both devices to normal Mirrored Disk operation.
 
 
                                     FAIL Command                          3-20
       
 
 
 
 
 
 
 
 
 
       HELP COMMAND
 
 
 
 
 
       Syntax:
 
 
       HELP [(processor)] [TOPICS] [keyword1] [-] [keyword2]
 
 
 
       Parameters:
 
 
       processor  specifies a program or processor that has an associated
           helpfile in the form HELP:processor:[.[account][.password]].  The
           default is the processor currently under control.
 
       TOPICS  specifies that only a list of available topics (message names)
           is required.  The range of topics is determined by keyword1 or
           keyword2.
 
       keyword1  specifies the name of the message to be printed.
 
 
       keyword2  if a range is specified (by including a dash "-"), keyword2 is
           the upper limit of the range.  If a range is not specified, keyword2
           is a submessage, or category within a message.
 
 
 
       Description:
 
 
       HELP prints information.
 
       HELP messages have levels.  Once the initial level has been printed,
       typing a question mark prints the next level, usually containing greater
       detail.  Typing two question marks prints the entire message.
 
       Any standard HELP file (even those for other processors) can be accessed
       with the HELP command.
 
 
 
 
 
 
                                     HELP Command                          3-21
       
 
 
 
 
 
 
       Examples:
 
 
       <MIRROR> HELP COMPARE
 
 
 
 
 
       LOCK COMMAND
 
 
 
 
 
       Syntax:
 
 
       LOCK DPxx
 
 
 
       Parameter:
 
 
       DPxx specifies a Mirrored Disk device.
 
 
 
       Description:
 
 
       The LOCK command is used to lock a Mirrored Disk device.  Only the user
       who locked a Mirrored Disk device can do I/O to that device.  All other
       users have their I/Os held by the system until the Mirrored Disk device
       is unlocked.
 
 
 
       Usage Note:
 
 
       This command should be used only in testing the MIRROR program or
       Mirrored Disk devices.  Locking a Mirrored Disk device prevents other
       users from doing I/O to the locked device.  Preventing users from doing
       I/O to a Mirrored Disk device can cause these users to appear to be hung
       SIOW.
 
 
 
 
 
 
                                     LOCK Command                          3-22
       
 
 
 
 
 
 
       MIRROR COMMAND
 
 
 
 
 
       Syntax:
 
 
       MIRROR DPxx OVER DPyy [ ( options ) ]
 
 
 
       Parameters:
 
 
       DPxx  specifies a nonmirrored disk device.
 
       DPyy  specifies a nonmirrored disk device.
 
       options  are one or more of the following separated by commas:
 
               {GRANS|GRANULES} = nn
               NREPORT
               PAUSE = tttttt [ { SECONDS | MS } ]
               REPORT [ = nn ]
 
           The description of these options is given in the "Options"
           subsection.
 
 
 
       Description:
 
 
       The MIRROR command is used to create a Mirrored Disk pair.  The devices
       used to create a Mirrored Disk pair must not currently be Mirrored Disk
       devices.  The VSN, DTT, and size of the devices used to create a
       Mirrored Disk pair must be identical.
 
       If both devices contain a single scratch volume with the same VSN, then
       both devices are made OPERational immediately.
 
       If DPxx is not a single scratch volume, then DPyy must be a single
       scratch volume with the same VSN.  If DPyy is not a single scratch
       volume with the same VSN, the MIRROR command prints an error message and
       aborts the execution of the command.
 
 
 
 
 
 
                                    MIRROR Command                         3-23
       
 
 
 
 
 
 
       If DPxx is not a single scratch volume and DPyy is a single scratch
       volume with the same VSN, then DPxx is made OPERational and DPyy is made
       FAILed.  The MIRROR command then executes the COPY command to copy DPxx
       over DPyy.  When the COPY command completes successfully, DPyy is made
       OPERational.
 
 
 
 
       OUTPUT COMMAND
 
 
 
 
 
       Syntax:
 
 
                [[ON  ] LP[@location]]
       OU[TPUT] [[OVER] fid          ] [(option[,option]...[)]]
                [[INTO] ME           ]
                [[TO  ]              ]
 
 
 
       Parameters:
 
 
       {ON|TO|OVER|INTO}  directs file output processing.  OVER causes an
           existing file to be overwritten.  INTO causes file extension.  ON
           and TO are synonyms used to create a new file.  If the file exists,
           an error will occur.  The default is ON.
 
       fid  any valid CP-6 file identifier.
 
       LP  directs output to the default line printer.  @location identifies a
           specific line printer.
 
       ME  redirects output to the user's terminal.
 
       option  is one of the following:
 
           F[ORM]={formname|'formname'}   Applies to unit record files and unit
               record devices and specifies the name of a form to be mounted on
               a unit record device. formname is a 1-6 character string, which
               can be quoted.  The name must have been defined to the system by
               the system manager (via the Form Definition File). The default
               is blank, which means the default form for a unit record device
               and form 'STDLP' for unit record files.
 
 
 
 
                                    OUTPUT Command                         3-24
               
 
 
 
 
 
 
           I[XTNSIZE]=value   Specifies an initial disk storage allocation (in
               blocks) for the output file.  value must be in the range of 1
               through 134217727.  The default is 2.
 
           O[RGANIZATION={C[ONSECUTIVE]|U[NIT]R[ECORD]}   Specifies the
               organization of the output file as either CONSECUTIVE or UNIT
               RECORD.  If this option is not specified, the output file is
               created as a UR file.
 
           X[TNSIZE]=value   Use of this option causes an automatic M$EXTEND
               when needed. value specifies a secondary disk storage allocation
               (in blocks) for the output file, and must be in the range 1
               through 32000.  The default is 2.
 
 
 
       Description:
 
 
       This command sends subsequent output to the specified file.
 
 
 
       Examples:
 
 
       <MIRROR> OUTPUT ON OUTPUTFILE
       <MIRROR> OUTPUT ON ME
 
 
 
 
       PRINT COMMAND
 
 
 
 
 
       Syntax:
 
 
       PRINT [ALL|ldevlist]
 
 
 
       Parameters:
 
 
       ALL  specifies that the accumulated outputs for all logical devices are
           to be sent to their destinations immediately.  This is the default.
 
 
 
                                    PRINT Command                          3-25
           
 
 
 
 
 
 
       ldevlist  specifies that the accumulated outputs for the specified
           logical device or devices are to be sent to their destination(s)
           immediately.  The list is entered in the format
 
               ldevname[,ldevname]...
 
           ldevname is a logical device name established through the LDEV
           command.
 
 
 
       Description:
 
 
       PRINT directs that output accumulated for logical devices be sent to its
       destination immediately.
 
 
 
       Examples:
 
 
       <MIRROR> PRINT LP01,LP02
 
       The above example causes the accumulated output associated with logical
       devices LP01 and LP02 to be sent immediately to the associated
       destinations.
 
 
 
 
       SWITCH COMMAND
 
 
 
 
 
       Syntax:
 
 
       SWITCH [ PRIMARY TO ] DPyy
 
 
 
       Parameter:
 
 
       DPyy  specifies a secondary Mirrored Disk device that is OPERational.
 
 
 
 
 
                                    SWITCH Command                         3-26
       
 
 
 
 
 
 
       Description:
 
 
       The SWITCH command is used to switch the primary Mirrored Disk device to
       the specified device.  This command is accepted only for a secondary
       Mirrored Disk device that is OPERational.
 
 
 
 
       UNLOCK COMMAND
 
 
 
 
 
       Syntax:
 
 
       UNLOCK DPxx
 
 
 
       Parameter:
 
 
       DPxx specifies a Mirrored Disk device.
 
 
 
       Description:
 
 
       The UNLOCK command is used to unlock a Mirrored Disk device.
 
 
 
       Usage Note:
 
 
       This command should be used only with the LOCK command in testing the
       MIRROR program and Mirrored Disk devices.
 
 
 
 
 
 
 
 
 
 
 
                                    UNLOCK Command                         3-27
       
 
 
 
 
 
 
       _______       Options
 
 
 
       The MIRROR COMPARE, COPY, and MIRROR commands accept options.  The
       options are enclosed in parenthesis and separated by commas.  The
       following is a list of options accepted by these commands:
 
           {GRANS|GRANULES} = nn
           MXDIFF = nnnnnn
           NREPORT
           PAUSE = tttttt [ { SECONDS | MS } ]
           REPORT [ = nn ]
 
       Not all options are accepted by each command.  The following sections
       describe each option in detail.
 
 
 
 
       GRANS OPTION
 
 
 
 
 
       Syntax:
 
 
       { GRANS | GRANULES } =  nnn
 
 
 
       Parameter:
 
 
                                               ___       nnn  specifies the number of granules.  nnn
            must be between 1 and 255.  The default is 64.
 
 
 
       Description:
 
 
       The GRANS option specifies the maximum number of granules to be read for
       each read and written on each write.
 
                        ___                                                          Larger values of nnn make the command run faster, but also increase the
                                                         ___                        I/O wait time for other users.  Smaller values of nnn make the command
       run slower, but also limit the increase in I/O wait time for other
       users.
 
 
                                     GRANS Option                          3-28
       
 
 
 
 
 
 
 
 
       Usage Note:
 
 
       This option is accepted by the COMPARE, COPY, and MIRROR commands.
 
 
 
 
       MXDIFF OPTION
 
 
 
 
 
       Syntax:
 
 
       MXDIFF = nnnnnn
 
 
 
       Parameter:
 
 
                                                           ______                    nnnnnn specifies the maximum number of differences. nnnnnn is a decimal
           integer from 1 to 999999.  The default is 1,000,000 (so that the
           entire device will be compared before termination).
 
 
 
       Description:
 
 
       The MXDIFF option specifies the maximum number of differences that the
       COMPARE command will accept before terminating the comparison.
 
 
 
       Usage Note:
 
 
       This option is accepted only by the COMPARE command.
 
 
 
 
 
 
 
 
 
                                    MXDIFF Option                          3-29
       
 
 
 
 
 
 
       NREPORT / REPORT OPTIONS
 
 
 
 
 
       Syntax:
 
 
       {NREPORT|REPORT [ = nn ] }
 
 
 
       Parameters:
 
 
       nn  specifies the percentage completion interval to be used to generate
                        __                                              the report.  nn is a decimal integer from 1 to 99.
 
 
 
       Description:
 
 
       The NREPORT option specifies that no report is to be displayed as the
       command executes.
 
       The REPORT option specifies that the percentage completion message is to
       be displayed as the command executes.  The display is done every time
       the percentage of completion increases by the percentage specified.
       Because of the number of granules specified on the GRAN option, the
       reporting may not occur exactly on the percentage specified.
 
       The default is REPORT = 10 (i.e., report the percentage completion every
       10 percent).
 
 
 
       Usage Note:
 
 
       These options are accepted by the COMPARE, COPY, and MIRROR commands.
 
 
 
 
 
 
 
 
 
 
 
                               NREPORT / REPORT Options                    3-30
       
 
 
 
 
 
 
       PAUSE OPTION
 
 
 
 
 
       Syntax:
 
 
       PAUSE =  ttttt [ { SECONDS | MS } ]
 
 
 
       Parameters:
 
 
                                                               ______               tttttt specifies the number of seconds or milliseconds. tttttt must be
           between 0 and 999999.
 
                               ______                      SECONDS  specifies that tttttt is in seconds.
 
                          ______                           MS  specifies that tttttt is in milliseconds.
 
           The default is 0 SECONDS.
 
 
 
       Description:
 
 
       The PAUSE option specifies the amount of time to wait at the end of the
       COMPARE or COPY loop.  This pause is available to prevent the MIRROR
       program from degrading system performance for other users too severely.
 
                        _____                                                        Larger values of ttttt make the command run slower, and allow other I/O
                                                                 _____                users a greater opportunity to do I/O.  Smaller values of ttttt make the
       command run faster, but also reduces the opportunity for other users to
       do I/O.
 
 
 
       Usage Note:
 
 
       1.  This option is accepted by the COMPARE, COPY, and MIRROR commands.
 
       2.  When a PAUSE in millisections (MS) is supplied, it is rounded up to
           the next centisecond value. That is, if 1MS through 9MS is
           specified, the value actually used is 10MS. If 11MS through 19MS is
           specified, 20MS is actually used. Etc.
 
 
 
                                     PAUSE Option                          3-31
       
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
                                     PAUSE Option                          3-32
       
 
 
 
 
 
                                                                      SECTION 4
 
 
                                                        INSTALLATION PROCEDURES
 
 
 
 
 
 
       * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 
       NOTE:  If this SRB is enclosed with an entire CP-6 system release for a
              new customer, Steps 1-8 of this section should be disregarded,
              and the CP-6 system installation instructions in the CP-6 HOST
              SRB should be followed.  The processors will be installed as part
              of the installation of the entire CP-6 system.
 
              Any processor-specific instructions not contained in the HOST SRB
              are found after Step 8.
 
       * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 
       The tape(s) in this package constitute a processor update release of the
       processors shown on the enclosed order form.  The tape(s) enclosed are a
       PCL labeled tape set.  It is assumed that recipients of this tape have
       already installed a running CP-6 system.
 
       For this processor update release, there are some files which must be
       DEFed onto the customer's P.O. tape set in order to allow for future
       patching, and there are some files that need to be copied into accounts
       other than .:SYS.
 
       To install this processor update release tape follow the steps below:
 
       1.   Logon through a timesharing terminal under an account which is
            authorized with PIGC and SPIDERC processor privileges, FMSEC
            privilege, and the use of at least one tape drive in timesharing
            mode.  The installation instruction example JCL assumes that you
            normally perform your DEFs from the account .:SYSGEN.  If the
            accounts .:SRB, .:QUAC and .:DOCUM already exist, it is assumed
            that these accounts are empty (there should be no files in these
            accounts).  If you have not created these accounts, use the
            following commands:
 
                 !PIG
                 *CR DP#SYS.:SYSGEN GR=15000
                 *MADADD #SYS.:SYSGEN
                 *CR DP#SYS.:SRB GR=1000
                 *MADADD #SYS.:SRB
 
 
 
 
 
       SRB_MD                   Installation Procedures                     4-1
            
 
 
                 *CR DP#SYS.:DOCUM GR=6000
                 *MADADD #SYS.:DOCUM
                 *CR DP#SYS.:QUAC GR=3000
                 *MADADD #SYS.:QUAC
                 *END
 
 
       2.   Now, you should copy your existing processors into the .:SYSGEN
            account with these commands:
 
                 !PRIV ALL
                 !ORES MEM=256
                 !PCL
                 <COPYALL LT#CP6PO1#CP6PO2#CP6PO3 OVER .:SYSGEN
                 <REM LT#CP6PO3
                 <END
 
       3.   Mount the processor update release tape. This tape is a CP-6 PCL
            tape with a label that is PCL01 (possibly PCL02 also). To get the
            new processors (and their associated files) into your DEF account,
            use these commands:
 
                 !PCL
                 <COPYALL LT#PCL01[#PCL02 ...] OVER .:SYSGEN
                 <REM LT#PCL01[#PCL02 ...]
                 <END
 
       4.   Now the Software Release Bulletins (SRBs) and the manuals for
            the new products should be printed.
 
 
            To move the necessary files from the DEF account (.:SYSGEN) into
            the .:SRB and .:DOCUM accounts in preparation for formatting and
            printing, issue the following command:
 
                 !XEQ $XTAPEINSTALL.:SYSGEN SRB=YES,DOCUM=YES
 
            After that job has run, the :SRB and :DOCUM accounts will contain
            the SRBs and manuals (respectively) for this release.
 
            To format the SRBs and manuals for LONG form (8 1/2 by 11), issue
            the following commands:
 
                 !XEQ $XTEXTALL_SRBS.:SRB
                 !XEQ $XCOPYALL_MANUALS.:DOCUM
 
            The LONG, WIDE, and STDLP forms are created by XEQing $XFORM.  This
            is described in the HOST SRB, Section 5, Installing the Tools Tape.
 
 
 
 
 
 
 
 
 
 
       SRB_MD                   Installation Procedures                     4-2
            
 
 
       5.   The remainder of the files must be moved to the appropriate
            accounts.  Products moved into the .:SYS account will have patches
            applied automatically.  To do this, perform the following command:
 
                 !XEQ $XTAPEINSTALL.:SYSGEN SYS=YES[,DELL=YES]
 
            DELL will delete unnecessary files from :SYSGEN.  It is NOT
            recommended that you install these processors with names other than
            their primary names.
 
            If you choose to install these processors with modified RU names
            for parallel testing, you MUST also change the $XRUMORDER file in
            the :SYSGEN account accordingly.
 
            CAUTION: $XRUMORDER MUST be merged into the site's PATCH DECK
            as-is, to insure the proper operation of the AUTOMATIC patch update
            procedures.
 
       6.   A set of patches for these new products is on this processor update
            tape and will be in the file $XRUMORDER.:SYSGEN.  These patches
            should be merged into the site's patch deck (RUM section) prior to
            creating a new P.O. tape set.  You should now be ready to re-DEF a
            full P.O. tape set.  Modify the !DEFAULT lines of the
            $XDEF_FULL.SUPPORT file to provide the proper SITE_ID and SITE_NAME
            and boot density.  When the patches have merged, execute the
            following to create a new P.O. set:
 
                 !BATCH $XDEF_FULL.SUPPORT
 
            Note, by the time you receive and install this tape, you may be
            several weeks behind in patch releases.  Be sure to pick up all
            patches in the succeeding weekly patch files that pertain to these
            products.
 
 
       7.   When the P.O. tape set created as a result of this job is booted,
            the installation of this processor and its associated files will be
            complete.
 
       8.   Two types of tests exist in the :QUAC account, both of which
            perform some form of elementary existence checking.  Tests of the
            first type are named with the prefix ORDR and the suffix SI; these
            check to see that every element of the products you ordered is
            included in your system.  The output from these tests must be
            checked for a STEPCC of 0.  If the STEPCC for any of these tests is
            greater than 0, you are missing some component(s).  The missing
            components will be listed in the line(s) just above the line
            reporting the name of the test and the STEPCC.
 
            Tests of the second type have names of the form xx_name_GT4.  These
            tests check to see that each of the processors ordered responds
            properly when invoked; in some cases they check the performance of
            basic features.  These, too, should report a STEPCC of 0.
 
 
 
 
 
       SRB_MD                   Installation Procedures                     4-3
            
 
 
            To run the tests --
 
            After installing the new processors, log on to an account which has
            SUPERA and PIGC processor privileges, then execute the following
            job:
 
                 !SET M$LO LP
                 !XEQ $XSETUP.:QUAC
                 !R
 
            Note the first and third commands above are optional.  This job
            creates a few pages of printing and the process will be much faster
            to print the output on a printer versus a console.
 
 
            Keyin ON BA 1 at the system console to permit batch jobs.
 
            When the QUAC tests are finished, you will have a file called
            $RESULTS.:QUACRUN (this file is also copied to the printer at the
            end of all the tests) which consists of lines reporting the ATITLE
            and STEPCC of each test.  All of the STEPCCs should be zero.  After
            testing is complete, use SUPER to remove the testing account:
 
                !SUPER
                CMD*REM :QUACRUN,107TESTING
                CMD*END
 
           Delete all files in the :QUAC account:
 
                !DEL ?.:QUAC
                YES$
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                   Installation Procedures                     4-4
       
 
 
 
 
 
                                                                      SECTION 5
 
 
                                                       MIRRORED DISK PROCEDURES
 
 
 
 
 
 
       The following sections describe procedures to setup and use Mirrored
       Disks.  Unless otherwise noted, DPxx is used to refer to the primary
       Mirrored Disk device, and DPyy is used to refer to the secondary
       Mirrored Disk device.
 
 
 
 
       _______________________________       INITIAL SETUP OF MIRRORED DISKS
 
 
 
       This procedure goes through the initial setup of a Mirrored Disk devices
       from two new or unused disk devices.
 
 
 
 
       _____________________       Partition the devices
 
 
 
       Use SYSCON to PARTITION the devices if they are not already PARTITIONed
       or marked DOWN in the TIGR deck.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                    Partition the devices                      5-1
       
 
 
       _________________       Prepare the media
 
 
 
       Use TOLTS to format the media on the primary and secondary Mirrored Disk
       devices.  Alternate tracks must be assigned to provide for easy matching
       of Defective Track Tables (DTTs) and to allow for easy replacement of a
       failed device.
 
 
 
 
       ______________________       Initialize the devices
 
 
 
       Use VOLINIT to initialize the primary and secondary devices.  The same
       VSN must be given to both the primary and secondary devices.  If
       alternate tracks were assigned on an MSU0451 or MSU0501, use the VOLINIT
       command with the NOFORMAT and ALT options.  Otherwise, no special
       options are required on the VOLINIT command.
 
       If alternate tracks are not assigned on a MUS0451 or MSU0501 device, you
       must manually make the DTTs of the primary and secondary device
       identical.  This may require VOLINITing the primary and secondary device
       more than once and manually entering the defective tracks in DTT.
 
 
 
 
       __________________       Return the devices
 
 
 
       Use SYSCON to RETURN the primary and secondary devices.
 
 
 
 
       ________________________________       Create the Mirrored Disk devices
 
 
 
       Use the MIRROR processor to create the Mirrored Disk devices:
 
            ______           !MIRROR
           MIRROR E05 here
                   _____________________           <Mirror>MIRROR DPxx OVER DPyy
                   ___           <Mirror>END
 
       MIRROR makes both DPxx and DPyy operational.  DPxx is operational
       because it is the primary Mirrored Disk device.  DPyy is operational
       because both DPxx and DPyy are scratch packs.
 
 
 
 
 
       SRB_MD              Create the Mirrored Disk devices                 5-2
       
 
 
 
 
 
       ________________________________       Build packsets on primary device
 
 
 
       Use PIG to SCRATCH and BUILD packsets on the primary device.  I/O to the
       primary device is mirrored on the secondary device.
 
       Mirrored Disk devices may contain either whole or partial packsets.
       There is no requirement that all volumes of a packset on a Mirrored Disk
       device be on Mirrored Disk devices.
 
 
 
 
       ________________________________       Restore/build accounts and files
 
 
 
       Either use EFT to restore accounts and files to packset(s) built on the
       primary device, or use PIG to CREATE accounts on the packsets on the
       primary device.  I/O to the primary device is mirrored on the secondary
       device.
 
 
 
 
       ___________________________       ADDITION OF A MIRRORED DISK
 
 
 
       The following steps are required to add a Mirrored Disk device to an
       existing non-Mirrored Disk device.  The existing non-Mirrored Disk
       device can be any disk device currently in use on the system that is not
       already a part of a Mirrored Disk pair.  The additional device can be
       any unused single volume scratch device.  Therefore, this procedure is
       used both to add a Mirrored Disk device to a currently operating disk
       device or to return a repaired disk device to what was once a Mirrored
       Disk pair.
 
       The existing non-Mirrored Disk device is referred to as the primary
       Mirrored Disk device or (DPxx).  The device that is added is referred to
       as the secondary Mirrored Disk device or (DPyy).
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                 Addition of a Mirrored Disk                   5-3
       
 
 
       ______________________________       Partition the secondary device
 
 
 
       Use SYSCON to PARTITION the secondary device if it is not already
       PARTITIONed or marked DOWN in the TIGR deck.
 
 
 
 
       _________________       Prepare the media
 
 
 
       Use TOLTS to format the media on the secondary Mirrored Disk device.
       Alternate tracks must be assigned if the primary Mirrored Disk device
       was prepared with alternate tracks assigned.  If the primary Mirrored
       Disk device was not prepared using alternate tracks, the Defective Track
       Table (DTT) of the secondary device manually must be made identical to
       the DTT of the primary device.
 
 
 
 
       _______________________________       Initialize the secondary device
 
 
 
       Use VOLINIT to initialize the secondary device.  The VSN of the
       secondary device must be the same as the VSN of the primary device.  If
       alternate tracks were assigned on an MSU0451 or MSU0501, use the VOLINIT
       command NOFORMAT and ALT options.  Otherwise, no special options are
       required on the VOLINIT command.
 
 
 
 
       ___________________________       Return the secondary device
 
 
 
       Use SYSCON to RETURN the secondary device.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                 Return the secondary device                   5-4
       
 
 
       ________________________________       Create the Mirrored Disk devices
 
 
 
       Use the MIRROR processor to create the link between the Mirrored Disk
       devices:
 
            ______           !MIRROR
           MIRROR E05 here
                   _____________________           <Mirror>MIRROR DPxx OVER DPyy
                   ___           <Mirror>END
 
       MIRROR makes DPxx operational and DPyy failed.  DPxx is operational
       because it is the primary Mirrored Disk device.  DPyy is failed because
       DPxx is not a scratch pack and DPyy is scratch pack.  MIRROR then copies
       DPxx over DPyy.  When that is successfully completed, MIRROR makes DPyy
       operational.
 
 
 
 
       _______________________________       TERMINATE MIRRORED DISK DEVICES
 
 
 
       The following steps are required to terminate Mirrored Disk operation
       between two Mirrored Disk devices.  The Mirrored Disk device for which
       Mirrored Disk operation is to be terminated must be OPERational.
 
 
 
 
       _____________________________________       Terminate the Mirrored Disk Operation
 
 
 
       Use MIRROR to terminate the Mirrored Disk operation between the devices:
 
           MIRROR E05 here
            ______           !MIRROR
                   ________________           <Mirror>DONT MIRROR DPxx
                   ___           <Mirror>END
 
       DPxx continues operating as a non-Mirrored Disk device.  DPyy is not
       recognized as a CP-6 pack.  DPyy will have to be given a unique VSN
       using PIG or VOLINIT before it can be used as a CP-6 pack again.
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD            Terminate the Mirrored Disk Operation              5-5
       
 
 
       _______________________________________       REPAIR OF A FAILED MIRRORED DISK DEVICE
 
 
 
       The following steps are required to repair a failed Mirrored Disk
       device.  If a Mirrored Disk device failed because of an irrecoverable
       I/O error, the Mirrored Disk pair is terminated:  the operational
       Mirrored Disk devices becomes a non-Mirrored Disk device and the failing
       Mirrored Disk device is no longer recognized by CP-6.  If the Mirrored
       Disk device failed because of the MIRROR FAIL command, the Mirrored Disk
       pair must be terminated using the MIRROR DONT MIRROR command before the
       device can be repaired.
 
 
 
 
       ____________________________       Terminate Mirrored Disk Pair
 
 
 
       If the failing Mirrored Disk device has been marked failed, but the
       Mirrored Disk pair has not been terminated, terminate the Mirrored Disk
       pair using the MIRROR DONT MIRROR command.  If the Mirrored Disk pair
       has already been terminated, this step can be skipped.
 
            ______           !MIRROR
           MIRROR E05 here
                   ________________           <Mirror>DONT MIRROR DPxx
                   ___           <Mirror>END
 
 
 
 
       ___________________________       Partition the failed device
 
 
 
       Use SYSCON to PARTITION the failed device.  Since the device is no
       longer recognized by CP-6 as a CP-6 pack, it definitely can be
       partitioned.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                 Partition the failed device                   5-6
       
 
 
       ________________________       Repair the failed device
 
 
 
       Turn the failed device over to a CSO representative for hardware
       repairs.  Hardware repairs may or may not destroy the CP-6 format or
       data on the failed device.
 
 
 
 
       __________________________       Return the repaired device
 
 
 
       After the device has been repaired by CSO, follow the steps in the
       previous section entitled "Addition of a Mirrored Disk" to return the
       repaired device as a Mirrored Disk device.  The repaired device will
       become the mirror of the currently operating device.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                 Return the repaired device                    5-7
       
 
 
 
 
 
                                                                               
 
 
                                                                          INDEX
 
 
 
 
 
       Note: Index references indicate the page on which the paragraph
       containing the index term actually ends.  Should the paragraph straddle
       two pages, the actual indexed term might be on the first page, while the
       index reference is to the second page.
 
 
       A
 
         Addition of a Mirrored Disk - 5-3
         ANLZ - 3-3
         AVR Processing - 3-1
 
 
       B
 
         Build packsets on primary device - 5-3
 
 
       C
 
         Commands - 3-8
         COMPARE Command - 3-8
         Compatibility Considerations - 1-6
         Conversion Notes - 2-2
         COPY Command - 3-11
         Create the Mirrored Disk devices - 5-2 5-5
 
 
       D
 
         DATE Command - 3-13
         Description of Mirrored Disks - 1-1
         Designation of Mirrored Disks - 1-4
         DIRECTORY Command - 3-15
         DISPLAY Command - 3-14
         DO Command - 3-16
         DONT MIRROR Command - 3-17
 
 
 
 
 
 
 
 
 
       SRB_MD                            Index                              i-1
       
 
 
       E
 
         ELAN - 3-3
         END Command - 3-18
         ENTER Command - 3-18
         ERASE Command - 3-19
 
 
       F
 
         FAIL Command - 3-20
 
 
       G
 
         GHOST1 - 3-4
         GRANS Option - 3-28
 
 
       H
 
         HELP Command - 3-21
         Host Monitor Services Enhancements - 3-6
 
 
       I
 
         Initial Setup of Mirrored Disks - 5-1
         Initialization of Mirrored Disks - 1-4
         Initialize the devices - 5-2
         Initialize the secondary device - 5-4
 
 
       L
 
         LOCK Command - 3-22
 
 
       M
 
         M$IOQ - 3-6
         M$SYSCON - 3-7
         MIRROR - 3-4
         MIRROR Command - 3-23
         MXDIFF Option - 3-29
 
 
       N
 
         New processor:  MIRROR - 3-7
         NREPORT / REPORT Options - 3-30
 
 
 
 
 
 
 
       SRB_MD                            Index                              i-2
       
 
 
       O
 
         Operation of Mirrored Disks - 1-4
         Options - 3-28
         OUTPUT Command - 3-24
         Overview of Mirrored Disks - 1-3
 
 
       P
 
         Partition the devices - 5-1
         Partition the failed device - 5-6
         Partition the secondary device - 5-4
         PAUSE Option - 3-31
         PIG - 3-4
         Preparation of Mirrored Disks - 1-3
         Prepare the media - 5-2 5-4
         PRINT Command - 3-25
         Problems Fixed in this Release - 2-2
         Processing Enhancements - 3-1
         Processor Enhancements - 3-3
 
 
       R
 
         Recovery Processing - 3-2
         Release Contents - 2-1
         Repair of a failed Mirrored Disk device - 5-6
         Repair of Mirrored Disks - 1-5
         Repair the failed device - 5-7
         Restore/build accounts and files - 5-3
         Return of Mirrored Disks - 1-6
         Return the devices - 5-2
         Return the repaired device - 5-7
         Return the secondary device - 5-4
 
 
       S
 
         Supporting Documentation - 2-1
         SWITCH Command - 3-26
 
 
       T
 
         Terminate Mirrored Disk Devices - 5-5
         Terminate Mirrored Disk Pair - 5-6
         Terminate the Mirrored Disk Operation - 5-5
 
 
       U
 
         UNLOCK Command - 3-27
 
 
 
 
 
       SRB_MD                            Index                              i-3
       
 
 
       V
 
         VOLINIT - 3-5
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
       SRB_MD                            Index                              i-4

