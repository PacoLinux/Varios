VERSION E05

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:1    
        1        1        /*M* VPK$CMDS  MODULE TO CONTAIN CODE FOR VARIOUS SHORT COMMANDS FOR PCL      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=1,THI=1    */
        8        8        /* NEXT AVAIL ERROR CODE = 130 (BY 10'S) */
        9        9        /* ALSO AVAILABLE = NONE */
       10       10        VPK$DELREC: PROC;
       11       11        /*D* NAME: VPK$DELREC
       12       12             CALL: CALL VPK$DELREC
       13       13             DESCRIPTION: This routine drives the DELREC command.
       14       14        */
       15       15        %INCLUDE VP_DATA_R;
       16     7002        %INCLUDE F$DCB;
       17     7051        %INCLUDE B_ERRORS_C;
       18     8178        %B$TCB;
       19     8181        %B$ALT;
       20     8189
       21     8190        %FPT_OPEN(DCB=M$EI, FUN=UPDATE, STCLASS=STATIC);
       22     8299        %FPT_PFIL (FPTN=FPT_PFIL_EI,DCB=M$EI,BOF=YES);
       23     8314        %FPT_PRECORD (FPTN=FPT_PRECORD_EI,DCB=M$EI,BRK=YES);
       24     8335        %PARSE$OUT(NAME=OUT$BLK,STCLASS=BASED);
       25     8380
       26     8381        %VP_ENTRIES(OMIT=VPK$DELREC);
       27     8589    1   DCL 1 TEXT$C BASED,
       28     8590    1         2 LEN UBIN BYTE CALIGNED,
       29     8591    1         2 STRING CHAR(TEXT$C.LEN) CALIGNED;
       30     8592    1   DCL P$ PTR;
       31     8593    1   DCL I UBIN;
       32     8594    1   DCL J SBIN;
       33     8595    1   DCL SOURCELIST$ PTR;
       34     8596    1   DCL NEXT_SPEC_RET_VAL UBIN;
       35     8597    1   DCL OPEN_NEXT_RET_VAL UBIN;
       36     8598
       37     8599    1           REMEMBER DELREC_ABORT IN ABORT_CMD;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:2    
       38     8600    1           SOURCELIST$=ADDR(NIL);
       39     8601    2           DO I=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;
       40     8602    2              P$=PCB.OUT$->OUT$BLK.SUBLK$(I);
       41     8603    3              DO CASE(P$->OUT$BLK.CODE);
       42     8604    3               CASE(1);                    /* SOURCELIST                         */
       43     8605    3                 SOURCELIST$=P$;
       44     8606    3               CASE(3);                    /* FROM FID                           */
       45     8607    3                 CALL VPF$SET_FROM_INFO(P$->OUT$BLK.SUBLK$(0));
       46     8608    3               END;
       47     8609    2              END;
       48     8610
       49     8611    1           CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,SOURCELIST$);
       50     8612    2           DO WHILE (NEXT_SPEC_RET_VAL~=1);
       51     8613    2              IF NEXT_SPEC_RET_VAL=0 THEN
       52     8614    3               DO;
       53     8615    3                  CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,4);
       54     8616    3                  IF OPEN_NEXT_RET_VAL = %VPOC_EXHAUSTED# THEN
       55     8617    3                     CALL VPL$ERR_PROC(1,70,'13'O);
       56     8618        /*E*   ERROR: VPK-00070
       57     8619             MESSAGE: Nothing from which to delete records.
       58     8620            MESSAGE1: No files were acceptable to DELREC in that input spec.
       59     8621        */
       60     8622    3                  IF ICB.SPEC_TYPE ~=1 THEN /* If not a single fid               */
       61     8623    3                     CALL VPL$ERR_PROC(3,110,'13'O);
       62     8624        /*E*   ERROR: VPK-00110
       63     8625             MESSAGE: Single named fid must be given.
       64     8626         MESSAGE1: You may not use a wildcard or other multiple-file specification with this
              8626         command.
       65     8627        */
       66     8628    4                  DO WHILE(OPEN_NEXT_RET_VAL ~= %VPOC_EXHAUSTED#);
       67     8629    4                     CALL MUNGE_RANGES
       68     8630    5                      WHENALTRETURN DO;
       69     8631    5                         CALL VPL$ERR_PROC(2,120,'13'O);
       70     8632    5                         END;
       71     8633        /*E*   ERROR: VPK-00120
       72     8634             MESSAGE: No record selection specifications given.
       73     8635            MESSAGE1: DELREC requires that a record selection be provided.
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:3    
       74     8636        */
       75     8637    4                     CALL M$CLOSE(FPT_CLOSE_EI);
       76     8638    5                     CALL M$OPEN(FPT_OPEN) WHENALTRETURN DO;
       77     8639    5                         CALL VPL$ERR_PROC (3,0,,,,,M$EI#);
       78     8640    5                         END;
       79     8641    4                     CALL DELETE_RECORDS;
       80     8642    4                     CALL M$CLOSE(FPT_CLOSE_EI);
       81     8643    4                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);
       82     8644    4                     END;
       83     8645    3                  END;
       84     8646    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);
       85     8647    2              END;
       86     8648    1   DELREC_ABORT:
       87     8649    2           CALL M$CLOSE(FPT_CLOSE_EI) WHENALTRETURN DO; END;
       88     8650    1   MUNGE_RANGES: PROC ALTRET;
       89     8651        /*I* NAME: MUNGE_RANGES
       90     8652             PURPOSE: To make the record ranges in ICB.REC_SEL usable to DELREC
       91     8653            CALL: CALL MUNGE_RANGES ALTRET(NO_RECORD_SELECTIONS);
       92     8654            DESCRIPTION: This routine sorts the record ranges and ensures that
       93     8655                         the ranges are mutually exclusive.  Also, if the keys
       94     8656                         of the file are known, any logical record selections
       95     8657                         will be replaced by the actual key values.
       96     8658        */
       97     8659    2   DCL 1 T_SPEC,                           /* Used for sorting ICB.REC_SEL.SPEC  */
       98     8660    2         2 * CHAR(99);
       99     8661    2   DCL ISTART UBIN;
      100     8662    2   DCL JSTART UBIN;
      101     8663    2   DCL IFINISH UBIN;
      102     8664    2   DCL JFINISH UBIN;
      103     8665    2   DCL ISTART$ PTR;
      104     8666    2   DCL JSTART$ PTR;
      105     8667    2   DCL IFINISH$ PTR;
      106     8668    2   DCL JFINISH$ PTR;
      107     8669    2   DCL B$VECTOR VECTOR BASED;
      108     8670
      109     8671
      110     8672
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:4    
      111     8673    2           IF ICB.REC_SEL.CNT = 0 THEN ALTRETURN;
      112     8674    2           IF ICB.FLAVOR.KNOWKEY = '1'B THEN
      113     8675    3            DO;
      114     8676    4               DO I=0 TO ICB.REC_SEL.CNT-1;
      115     8677    4                  IF ICB.REC_SEL.SPEC.TYPE(I)=1 THEN /* LOGICAL SELECTION        */
      116     8678    5                   DO;
      117     8679    5                      ICB.REC_SEL.SPEC.TYPE(I)=2;
      118     8680    5                      FPT_PFIL_EI.V.BOF# = %YES#;
      119     8681    5                      VBASE(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=KEY_AREA$;
      120     8682    5                      ICB.REC_SEL.SPEC.START.KEY$(I)=KEY_AREA$;
      121     8683    5                      VBOUND(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=511;
      122     8684    5                      FPT_PRECORD_EI.V.KEYS#= %NO#;
      123     8685    5                      FPT_PRECORD_EI.V.KEYR#= %YES#;
      124     8686    5                      FPT_PRECORD_EI.V.N#=ICB.REC_SEL.SPEC.START.SEQ(I)-1;
      125     8687    5                      CALL M$PFIL(FPT_PFIL_EI);
      126     8688    5   PREC1:             CALL M$PRECORD(FPT_PRECORD_EI)
      127     8689    6                       WHENALTRETURN DO;
      128     8690    7                          IF %VPSZ_ERR# = %E$PMMEINT THEN DO;
      129     8691    7                              FPT_PRECORD_EI.V.N# = FPT_PRECORD_EI.V.N# - M$EI$->F$DCB.
              8691                                       ARS;
      130     8692    7                              GOTO PREC1;
      131     8693    7                              END;
      132     8694    6                          CALL VPL$ERR_PROC(3,0,,,,,M$EI#);
      133     8695    6                          END;
      134     8696    5                      KEY_AREA$=PINCRC(KEY_AREA$,KEY_AREA$->TEXT$C.LEN+1);
      135     8697    5                      VBASE(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=KEY_AREA$;
      136     8698    5                      VBOUND(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=511;
      137     8699    5                      IF ICB.REC_SEL.SPEC.FINISH.SEQ(I)=0 THEN
      138     8700    6                       DO;
      139     8701    6                          FPT_PFIL_EI.V.BOF# = %NO#;
      140     8702    6                          FPT_PRECORD_EI.V.N# = -1;
      141     8703    6                          END;
      142     8704    5                       ELSE
      143     8705    6                       DO;
      144     8706    6                          FPT_PFIL_EI.V.BOF# = %YES#;
      145     8707    6                          FPT_PRECORD_EI.V.N#=ICB.REC_SEL.SPEC.FINISH.SEQ(I)-1;
      146     8708    6                          END;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:5    
      147     8709    5                      CALL M$PFIL(FPT_PFIL_EI);
      148     8710    5   PREC2:             CALL M$PRECORD(FPT_PRECORD_EI)
      149     8711    6                       WHENALTRETURN DO;
      150     8712    7                          IF %VPSZ_ERR# = %E$PMMEINT THEN DO;
      151     8713    7                              FPT_PRECORD_EI.V.N# = FPT_PRECORD_EI.V.N# - M$EI$->F$DCB.
              8713                                       ARS;
      152     8714    7                              GOTO PREC2;
      153     8715    7                              END;
      154     8716    6                          CALL VPL$ERR_PROC(3,0,,,,,M$EI#);
      155     8717    6                          END;
      156     8718    5                      ICB.REC_SEL.SPEC.FINISH.KEY$(I)=KEY_AREA$;
      157     8719    5                      KEY_AREA$=PINCRC(KEY_AREA$,KEY_AREA$->TEXT$C.LEN+1);
      158     8720    5                      END;
      159     8721    4                   ELSE
      160     8722    5                   DO;
      161     8723    5                      IF ICB.REC_SEL.SPEC.FINISH.KEY$(I)=ADDR(NIL) THEN
      162     8724    6                       DO;
      163     8725    6                          FPT_PFIL_EI.V.BOF# = %NO#;
      164     8726    6                          FPT_PRECORD_EI.V.KEYR# = %YES#;
      165     8727    6                          KEY_AREA$ -> TEXT$C.LEN = 511;
      166     8728    6                          FPT_PRECORD_EI.KEY_ = VECTOR(KEY_AREA$->TEXT$C);
      167     8729    6                          FPT_PRECORD_EI.V.N# = -1;
      168     8730    6                          CALL M$PFIL(FPT_PFIL_EI);
      169     8731    6                          CALL M$PRECORD(FPT_PRECORD_EI)
      170     8732    7                           WHENALTRETURN DO;
      171     8733    7                              CALL VPL$ERR_PROC(3,0,,,,,M$EI#);
      172     8734    7                              END;
      173     8735    6                          ICB.REC_SEL.SPEC.FINISH.KEY$(I)=KEY_AREA$;
      174     8736    6                          KEY_AREA$=PINCRC(KEY_AREA$,KEY_AREA$->TEXT$C.LEN+1);
      175     8737    6                          END;
      176     8738    5                      END;
      177     8739    4                  END;
      178     8740    3               IF ICB.REC_SEL.CNT=1 THEN RETURN; /* Dont have to sort only one   */
      179     8741    4               DO I=0 TO ICB.REC_SEL.CNT-1;
      180     8742    5                  DO J=I+1 TO ICB.REC_SEL.CNT-1;
      181     8743    5                     IF ICB.REC_SEL.SPEC.START.KEY$(I)->TEXT$C.STRING
      182     8744    5                       < ICB.REC_SEL.SPEC.START.KEY$(J)->TEXT$C.STRING THEN
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:6    
      183     8745    6                      DO;
      184     8746    6                         T_SPEC=ICB.REC_SEL.SPEC(I);
      185     8747    6                         ICB.REC_SEL.SPEC(I)=ICB.REC_SEL.SPEC(J);
      186     8748    6                         ICB.REC_SEL.SPEC(J)=T_SPEC;
      187     8749    6                         END;
      188     8750    5                     END;
      189     8751    4                  END;
      190     8752    3               END;
      191     8753    2            ELSE
      192     8754    3            DO;
      193     8755    3               IF ICB.REC_SEL.CNT=1 THEN RETURN; /* No need to sort              */
      194     8756    4               DO I=0 TO ICB.REC_SEL.CNT-1;
      195     8757    5                  DO J=I+1 TO ICB.REC_SEL.CNT-1;
      196     8758    5                     IF ICB.REC_SEL.SPEC.START.SEQ(I)<ICB.REC_SEL.SPEC.START.SEQ(J)
              8758                              THEN
      197     8759    6                      DO;
      198     8760    6                         T_SPEC = ICB.REC_SEL.SPEC(I);
      199     8761    6                         ICB.REC_SEL.SPEC(I)=ICB.REC_SEL.SPEC(J);
      200     8762    6                         ICB.REC_SEL.SPEC(J)=T_SPEC;
      201     8763    6                         END;
      202     8764    5                     END;
      203     8765    4                  END;
      204     8766    3               END;
      205     8767                                           /* Now get rid of over-lapping ranges.     */
      206     8768    3           DO I=ICB.REC_SEL.CNT-1 DOWNTO 1;
      207     8769    4              DO J=I-1 DOWNTO 0;
      208     8770    4                 IF ICB.REC_SEL.SPEC.TYPE(I)=0 THEN EXIT; /* This spec was removed */
      209     8771    5                 DO CASE(ICB.REC_SEL.SPEC.TYPE(I));
      210     8772    5                  CASE(1);                 /* LOGICAL RECORD SELECTION           */
      211     8773    5                    ISTART=ICB.REC_SEL.SPEC.START.SEQ(I);
      212     8774    5                    JSTART=ICB.REC_SEL.SPEC.START.SEQ(J);
      213     8775    5                    IFINISH=ICB.REC_SEL.SPEC.FINISH.SEQ(I);
      214     8776    5                    JFINISH=ICB.REC_SEL.SPEC.FINISH.SEQ(J);
      215     8777    5                    IF ISTART<=JSTART AND IFINISH>=JFINISH THEN
      216     8778    6                     DO;                   /* J IS WITHIN I                      */
      217     8779    6                        ICB.REC_SEL.SPEC.TYPE(J)=0; /* Remove inner range        */
      218     8780    6                        END;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:7    
      219     8781    5                     ELSE IF ISTART<JSTART AND IFINISH<JFINISH AND JSTART<=IFINISH THEN
      220     8782    6                        DO;
      221     8783    6                           ICB.REC_SEL.SPEC.FINISH.SEQ(I)=ICB.REC_SEL.SPEC.FINISH.SEQ(J
              8783                                    );
      222     8784    6                           ICB.REC_SEL.SPEC.TYPE(J)=0;
      223     8785    6                           END;
      224     8786    5                  CASE(2);                 /* KEYED RECORD SELECTION             */
      225     8787    5                    ISTART$=ICB.REC_SEL.SPEC.START.KEY$(I);
      226     8788    5                    JSTART$=ICB.REC_SEL.SPEC.START.KEY$(J);
      227     8789    5                    IFINISH$=ICB.REC_SEL.SPEC.FINISH.KEY$(I);
      228     8790    5                    JFINISH$=ICB.REC_SEL.SPEC.FINISH.KEY$(J);
      229     8791    5                    IF ISTART$->TEXT$C.STRING<=JSTART$->TEXT$C.STRING AND IFINISH$->
              8791                             TEXT$C.STRING>=JFINISH$->TEXT$C.STRING THEN
      230     8792    6                     DO;                   /* J IS WITHIN I                      */
      231     8793    6                        ICB.REC_SEL.SPEC.TYPE(J)=0; /* Remove inner range        */
      232     8794    6                        END;
      233     8795    5                     ELSE IF ISTART$->TEXT$C.STRING<JSTART$->TEXT$C.STRING
      234     8796    5                         AND IFINISH$->TEXT$C.STRING<JFINISH$->TEXT$C.STRING
      235     8797    5                         AND JSTART$->TEXT$C.STRING<=IFINISH$->TEXT$C.STRING THEN
      236     8798    6                        DO;
      237     8799    6                           ICB.REC_SEL.SPEC.FINISH(I)=ICB.REC_SEL.SPEC.FINISH(J);
      238     8800    6                           ICB.REC_SEL.SPEC.TYPE(J)=0;
      239     8801    6                           END;
      240     8802    5                  END;
      241     8803    4                 END;
      242     8804    3              END;
      243     8805    2   END MUNGE_RANGES;
      244     8806        %EJECT;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:8    
      245     8807    1   DELETE_RECORDS: PROC;
      246     8808        /*I*  NAME: DELETE_RECORDS
      247     8809              PURPOSE: To delete the records specified by ICB.REC_SEL
      248     8810              CALL:  CALL DELETE_RECORDS;
      249     8811              DESCRIPTION: This routine deletes the records indicated by
      250     8812                           ICB.REC_SEL.  The TYPE field of that structure
      251     8813                           determines how the records should be deleted.
      252     8814                           TYPE    ACTION
      253     8815                           ----    ------
      254     8816                             0      None - The record range lies within another
      255     8817                             1      Delete the records one at a time by positioning
      256     8818                                    to the first, calling M$DELREC, advancing
      257     8819                                    one record and deleting it until all records
      258     8820                                    in the range have bee deleted.
      259     8821                             2      Delete using KEY and LKEY in M$DELREC
      260     8822        */
      261     8823    2   DCL TYPE_FLAG UBIN;
      262     8824    2   DCL RANGE_END UBIN;
      263     8825        %FPT_DELREC(FPTN=FPT_DELREC_EI,DCB=M$EI,BRK=YES);
      264     8844    3           DO I=0 TO ICB.REC_SEL.CNT-1;
      265     8845    3              TYPE_FLAG = ICB.REC_SEL.SPEC.TYPE(I);
      266     8846    3              IF M$EI$->F$DCB.ORG = %RELATIVE# THEN
      267     8847    3                 TYPE_FLAG=2;    /* We can use KEY and LKEY for RELATIVE files   */
      268     8848    4              DO CASE(TYPE_FLAG);
      269     8849    4               CASE(1);
      270     8850    4                 FPT_PFIL_EI.V.BOF# = %YES#;
      271     8851    4                 CALL M$PFIL(FPT_PFIL_EI);
      272     8852    4                 FPT_PRECORD_EI.V.N#=ICB.REC_SEL.SPEC.START.SEQ(I)-1;
      273     8853    4                 FPT_DELREC_EI.KEY_=VECTOR(NIL);
      274     8854    4                 FPT_DELREC_EI.LKEY_=VECTOR(NIL);
      275     8855    4                 IF ICB.REC_SEL.SPEC.FINISH.SEQ(I)=0 THEN
      276     8856    4                    RANGE_END=BITBIN('777777777777'O);
      277     8857    4                  ELSE
      278     8858    4                    RANGE_END=ICB.REC_SEL.SPEC.FINISH.SEQ(I);
      279     8859    5                 DO J=ICB.REC_SEL.SPEC.START.SEQ(I) TO RANGE_END;
      280     8860    5   PREC3:           CALL M$PRECORD(FPT_PRECORD_EI)
      281     8861    6                     WHENALTRETURN DO;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:9    
      282     8862    7                        IF %VPSZ_ERR# = %E$PMMEINT THEN DO;
      283     8863    7                            FPT_PRECORD_EI.V.N# = FPT_PRECORD_EI.V.N# - M$EI$->F$DCB.
              8863                                     ARS;
      284     8864    7                            GOTO PREC3;
      285     8865    7                            END;
      286     8866    6                        CALL VPL$ERR_PROC(3,0,,,,,M$EI#);
      287     8867    6                        END;
      288     8868    5                    CALL M$DELREC(FPT_DELREC_EI)
      289     8869    6                     WHENALTRETURN DO;
      290     8870    6                        IF %VPSZ_ERR# = %E$EOF
      291     8871    6                          AND ICB.REC_SEL.SPEC.FINISH.SEQ(I)=0 THEN
      292     8872    6                           ;          /* Ignore this error - we deleted to EOF   */
      293     8873    6                         ELSE
      294     8874    6                           CALL VPL$ERR_PROC(3,0,,,,,M$EI#);
      295     8875    6                        END;
      296     8876    5                    FPT_PRECORD_EI.V.N#=0;
      297     8877    5                    END;
      298     8878    4               CASE(2);
      299     8879    4                 IF M$EI$->F$DCB.ORG = %IREL# OR
      300     8880    5                   M$EI$->F$DCB.ORG = %INDEXED# THEN DO;
      301     8881    5                     FPT_DELREC_EI.KEY_=VECTOR(SUBSTR(ICB.REC_SEL.SPEC.START.KEY$(I)->
              8881                              TEXT$C.STRING,0,M$EI$->F$DCB.KEYL));
      302     8882    5                     FPT_DELREC_EI.LKEY_=VECTOR(SUBSTR(ICB.REC_SEL.SPEC.FINISH.KEY$(I)
              8882                              ->TEXT$C.STRING,0,M$EI$->F$DCB.KEYL));
      303     8883    5                     END;
      304     8884    5                  ELSE DO;
      305     8885    5                     FPT_DELREC_EI.KEY_=VECTOR(ICB.REC_SEL.SPEC.START.KEY$(I)->TEXT$C);
      306     8886    5                     FPT_DELREC_EI.LKEY_=VECTOR(ICB.REC_SEL.SPEC.FINISH.KEY$(I)->TEXT$C
              8886                              );
      307     8887    5                     END;
      308     8888    4                 IF ICB.REC_SEL.SPEC.START.KEY$(I)->TEXT$C.STRING=ICB.REC_SEL.SPEC.
              8888                          FINISH.KEY$(I)->TEXT$C.STRING THEN
      309     8889    4                    FPT_DELREC_EI.LKEY_ = VECTOR(NIL);
              8889                             /* Allow error if single key not found */
      310     8890    4   DELREC1:      CALL M$DELREC(FPT_DELREC_EI)
      311     8891    5                  WHENALTRETURN DO;
      312     8892    5                     IF %VPSZ_ERR# = %E$PMMEINT THEN GOTO DELREC1;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:10   
      313     8893    5                     CALL VPL$ERR_PROC(3,0,,,,,M$EI#);
      314     8894    5                     END;
      315     8895    4               END;
      316     8896    3              END;
      317     8897    2   END DELETE_RECORDS;
      318     8898    1   END VPK$DELREC;
      319     8899        %EOD;

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:11   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$DELREC.

   Procedure VPK$DELREC requires 852 words for executable code.
   Procedure VPK$DELREC requires 52 words of local(AUTO) storage.

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:12   

 Object Unit name= VPK$DELREC                                 File name= VPK$CMDS.:E05TOU
 UTS= JUL 30 '97 07:50:46.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none    82    122  VPK$DELREC
   11   Proc  even  none   852   1524  VPK$DELREC
   12  RoData even  none    24     30  VPK$DELREC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        0  VPK$DELREC
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:13   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 VPF$SET_FROM_INFO
         yes           Std       2 VPF$GET_NEXT_SPEC
         yes           Std       3 VPF$OPEN_NEXT
         yes           Std       8 VPL$ERR_PROC
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PCB                                   ABORT_CMD
     BREAK_LOC                             BREAK_MESSAGE_REPORTER                SPEC_BUF
     IN_RES                                ICB                                   KEY_AREA$
     M$EI                                  M$EI$                                 M$EI#
     M$EO                                  M$EO1                                 M$ME
     M$SI                                  M$READFILE                            M$DO
     M$STD1                                M$SORT1                               B$TCB$
     FPT_CLOSE_EI                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:14   


        1        1        /*M* VPK$CMDS  MODULE TO CONTAIN CODE FOR VARIOUS SHORT COMMANDS FOR PCL      */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=1,THI=1    */
        8        8        /* NEXT AVAIL ERROR CODE = 130 (BY 10'S) */
        9        9        /* ALSO AVAILABLE = NONE */
       10       10        VPK$DELREC: PROC;

     10 11 000000   000000 700200 xent  VPK$DELREC   TSX0  ! X66_AUTO_0
        11 000001   000064 000000                    ZERO    52,0

       11       11        /*D* NAME: VPK$DELREC
       12       12             CALL: CALL VPK$DELREC
       13       13             DESCRIPTION: This routine drives the DELREC command.
       14       14        */
       15       15        %INCLUDE VP_DATA_R;
       16     7002        %INCLUDE F$DCB;
       17     7051        %INCLUDE B_ERRORS_C;
       18     8178        %B$TCB;
       19     8181        %B$ALT;
       20     8189
       21     8190        %FPT_OPEN(DCB=M$EI, FUN=UPDATE, STCLASS=STATIC);
       22     8299        %FPT_PFIL (FPTN=FPT_PFIL_EI,DCB=M$EI,BOF=YES);
       23     8314        %FPT_PRECORD (FPTN=FPT_PRECORD_EI,DCB=M$EI,BRK=YES);
       24     8335        %PARSE$OUT(NAME=OUT$BLK,STCLASS=BASED);
       25     8380
       26     8381        %VP_ENTRIES(OMIT=VPK$DELREC);
       27     8589    1   DCL 1 TEXT$C BASED,
       28     8590    1         2 LEN UBIN BYTE CALIGNED,
       29     8591    1         2 STRING CHAR(TEXT$C.LEN) CALIGNED;
       30     8592    1   DCL P$ PTR;
       31     8593    1   DCL I UBIN;
       32     8594    1   DCL J SBIN;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:15   
       33     8595    1   DCL SOURCELIST$ PTR;
       34     8596    1   DCL NEXT_SPEC_RET_VAL UBIN;
       35     8597    1   DCL OPEN_NEXT_RET_VAL UBIN;
       36     8598
       37     8599    1           REMEMBER DELREC_ABORT IN ABORT_CMD;

   8599 11 000002   000203 635000 11                 EAA     DELREC_ABORT
        11 000003   000000 452400 xsym               STP2    ABORT_CMD
        11 000004   000001 755000 xsym               STA     ABORT_CMD+1

       38     8600    1           SOURCELIST$=ADDR(NIL);

   8600 11 000005   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000006   200006 756100                    STQ     SOURCELIST$,,AUTO

       39     8601    2           DO I=0 TO PCB.OUT$->OUT$BLK.NSUBLKS-1;

   8601 11 000007   200004 450100                    STZ     I,,AUTO
        11 000010   000041 710000 11                 TRA     s:8609+3

       40     8602    2              P$=PCB.OUT$->OUT$BLK.SUBLK$(I);

   8602 11 000011   000003 470400 xsym               LDP0    PCB+3
        11 000012   200004 720100                    LXL0    I,,AUTO
        11 000013   000003 236110                    LDQ     3,X0,PR0
        11 000014   200003 756100                    STQ     P$,,AUTO

       41     8603    3              DO CASE(P$->OUT$BLK.CODE);

   8603 11 000015   200003 471500                    LDP1    P$,,AUTO
        11 000016   100000 721100                    LXL1    0,,PR1
        11 000017   000004 101003                    CMPX1   4,DU
        11 000020   000022 602011 11                 TNC     s:8603+5,X1
        11 000021   000036 710000 11                 TRA     s:8609
        11 000022   000036 710000 11                 TRA     s:8609
        11 000023   000026 710000 11                 TRA     s:8605
        11 000024   000036 710000 11                 TRA     s:8609
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:16   
        11 000025   000030 710000 11                 TRA     s:8607

       42     8604    3               CASE(1);                    /* SOURCELIST                         */

       43     8605    3                 SOURCELIST$=P$;

   8605 11 000026   200006 756100                    STQ     SOURCELIST$,,AUTO
        11 000027   000036 710000 11                 TRA     s:8609

       44     8606    3               CASE(3);                    /* FROM FID                           */

       45     8607    3                 CALL VPF$SET_FROM_INFO(P$->OUT$BLK.SUBLK$(0));

   8607 11 000030   000003 036003                    ADLQ    3,DU
        11 000031   200054 756100                    STQ     JFINISH$+1,,AUTO
        11 000032   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000033   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000034   000000 701000 xent               TSX1    VPF$SET_FROM_INFO
        11 000035   000000 011000                    NOP     0

       46     8608    3               END;

       47     8609    2              END;

   8609 11 000036   200004 235100                    LDA     I,,AUTO
        11 000037   000001 035007                    ADLA    1,DL
        11 000040   200004 755100                    STA     I,,AUTO
        11 000041   000003 470400 xsym               LDP0    PCB+3
        11 000042   000001 236100                    LDQ     1,,PR0
        11 000043   000022 772000                    QRL     18
        11 000044   200004 116100                    CMPQ    I,,AUTO
        11 000045   000047 600000 11                 TZE     s:8611
        11 000046   000011 603000 11                 TRC     s:8602

       48     8610
       49     8611    1           CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,SOURCELIST$);

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:17   
   8611 11 000047   200006 631500                    EPPR1   SOURCELIST$,,AUTO
        11 000050   200055 451500                    STP1    JFINISH$+2,,AUTO
        11 000051   200007 633500                    EPPR3   NEXT_SPEC_RET_VAL,,AUTO
        11 000052   200054 453500                    STP3    JFINISH$+1,,AUTO
        11 000053   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000054   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000055   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        11 000056   000000 011000                    NOP     0

       50     8612    2           DO WHILE (NEXT_SPEC_RET_VAL~=1);

   8612 11 000057   200007 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        11 000060   000001 115007                    CMPA    1,DL
        11 000061   000203 600000 11                 TZE     DELREC_ABORT

       51     8613    2              IF NEXT_SPEC_RET_VAL=0 THEN

   8613 11 000062   200007 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        11 000063   000172 601000 11                 TNZ     s:8646

       52     8614    3               DO;

       53     8615    3                  CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,4);

   8615 11 000064   000000 236000 12                 LDQ     0
        11 000065   200055 756100                    STQ     JFINISH$+2,,AUTO
        11 000066   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        11 000067   200054 450500                    STP0    JFINISH$+1,,AUTO
        11 000070   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000071   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000072   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        11 000073   000000 011000                    NOP     0

       54     8616    3                  IF OPEN_NEXT_RET_VAL = %VPOC_EXHAUSTED# THEN

   8616 11 000074   200010 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        11 000075   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:18   
        11 000076   000103 601000 11                 TNZ     s:8622

       55     8617    3                     CALL VPL$ERR_PROC(1,70,'13'O);

   8617 11 000077   000003 630400 12                 EPPR0   3
        11 000100   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000101   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000102   000000 011000                    NOP     0

       56     8618        /*E*   ERROR: VPK-00070
       57     8619             MESSAGE: Nothing from which to delete records.
       58     8620            MESSAGE1: No files were acceptable to DELREC in that input spec.
       59     8621        */
       60     8622    3                  IF ICB.SPEC_TYPE ~=1 THEN /* If not a single fid               */

   8622 11 000103   000017 235000 xsym               LDA     ICB+15
        11 000104   000001 115007                    CMPA    1,DL
        11 000105   000112 600000 11                 TZE     s:8628

       61     8623    3                     CALL VPL$ERR_PROC(3,110,'13'O);

   8623 11 000106   000007 630400 12                 EPPR0   7
        11 000107   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000110   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000111   000000 011000                    NOP     0

       62     8624        /*E*   ERROR: VPK-00110
       63     8625             MESSAGE: Single named fid must be given.
       64     8626        MESSAGE1: You may not use a wildcard or other multiple-file specification with this
              8626         command.
       65     8627        */
       66     8628    4                  DO WHILE(OPEN_NEXT_RET_VAL ~= %VPOC_EXHAUSTED#);

   8628 11 000112   200010 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        11 000113   000001 115007                    CMPA    1,DL
        11 000114   000172 600000 11                 TZE     s:8646

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:19   
       67     8629    4                     CALL MUNGE_RANGES

   8629 11 000115   000211 701000 11                 TSX1    MUNGE_RANGES
        11 000116   000120 702000 11                 TSX2    s:8631
        11 000117   000124 710000 11                 TRA     s:8637

       68     8630    5                      WHENALTRETURN DO;

       69     8631    5                         CALL VPL$ERR_PROC(2,120,'13'O);

   8631 11 000120   000013 630400 12                 EPPR0   11
        11 000121   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000122   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000123   000000 011000                    NOP     0

       70     8632    5                         END;

       71     8633        /*E*   ERROR: VPK-00120
       72     8634             MESSAGE: No record selection specifications given.
       73     8635            MESSAGE1: DELREC requires that a record selection be provided.
       74     8636        */
       75     8637    4                     CALL M$CLOSE(FPT_CLOSE_EI);

   8637 11 000124   000000 630400 xsym               EPPR0   FPT_CLOSE_EI
        11 000125   050001 713400                    CLIMB   close
        11 000126   406000 401760                    pmme    nvectors=13

       76     8638    5                     CALL M$OPEN(FPT_OPEN) WHENALTRETURN DO;

   8638 11 000127   000000 630400 10                 EPPR0   FPT_OPEN
        11 000130   450000 713400                    CLIMB   alt,open
        11 000131   410400 401760                    pmme    nvectors=18
        11 000132   000134 702000 11                 TSX2    s:8639
        11 000133   000152 710000 11                 TRA     s:8641

       77     8639    5                         CALL VPL$ERR_PROC (3,0,,,,,M$EI#);

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:20   
   8639 11 000134   000016 236000 12                 LDQ     14
        11 000135   200062 756100                    STQ     JFINISH$+7,,AUTO
        11 000136   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000137   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000140   200060 757100                    STAQ    JFINISH$+5,,AUTO
        11 000141   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000142   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000143   200056 757100                    STAQ    JFINISH$+3,,AUTO
        11 000144   000020 237000 12                 LDAQ    16
        11 000145   200054 757100                    STAQ    JFINISH$+1,,AUTO
        11 000146   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000147   000025 631400 xsym               EPPR1   B_VECTNIL+21
        11 000150   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000151   000000 011000                    NOP     0

       78     8640    5                         END;

       79     8641    4                     CALL DELETE_RECORDS;

   8641 11 000152   001157 701000 11                 TSX1    DELETE_RECORDS
        11 000153   000000 011000                    NOP     0

       80     8642    4                     CALL M$CLOSE(FPT_CLOSE_EI);

   8642 11 000154   000000 630400 xsym               EPPR0   FPT_CLOSE_EI
        11 000155   050001 713400                    CLIMB   close
        11 000156   406000 401760                    pmme    nvectors=13

       81     8643    4                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);

   8643 11 000157   000003 236000 12                 LDQ     3
        11 000160   200055 756100                    STQ     JFINISH$+2,,AUTO
        11 000161   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        11 000162   200054 450500                    STP0    JFINISH$+1,,AUTO
        11 000163   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000164   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000165   000000 701000 xent               TSX1    VPF$OPEN_NEXT
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:21   
        11 000166   000000 011000                    NOP     0

       82     8644    4                     END;

   8644 11 000167   200010 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        11 000170   000001 115007                    CMPA    1,DL
        11 000171   000115 601000 11                 TNZ     s:8629

       83     8645    3                  END;

       84     8646    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);

   8646 11 000172   200007 630500                    EPPR0   NEXT_SPEC_RET_VAL,,AUTO
        11 000173   200054 450500                    STP0    JFINISH$+1,,AUTO
        11 000174   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000175   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000176   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        11 000177   000000 011000                    NOP     0

       85     8647    2              END;

   8647 11 000200   200007 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        11 000201   000001 115007                    CMPA    1,DL
        11 000202   000062 601000 11                 TNZ     s:8613

       86     8648    1   DELREC_ABORT:
       87     8649    2           CALL M$CLOSE(FPT_CLOSE_EI) WHENALTRETURN DO; END;

   8649 11 000203   000000 630400 xsym  DELREC_ABORT EPPR0   FPT_CLOSE_EI
        11 000204   450001 713400                    CLIMB   alt,close
        11 000205   406000 401760                    pmme    nvectors=13
        11 000206   000210 702000 11                 TSX2    s:8649
        11 000207   000210 710000 11                 TRA     s:8649

   8649 11 000210   001523 710000 11                 TRA     s:8898

       88     8650    1   MUNGE_RANGES: PROC ALTRET;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:22   

   8650 11 000211   200012 741300       MUNGE_RANGES STX1  ! OPEN_NEXT_RET_VAL+2,,AUTO

       89     8651        /*I* NAME: MUNGE_RANGES
       90     8652             PURPOSE: To make the record ranges in ICB.REC_SEL usable to DELREC
       91     8653            CALL: CALL MUNGE_RANGES ALTRET(NO_RECORD_SELECTIONS);
       92     8654            DESCRIPTION: This routine sorts the record ranges and ensures that
       93     8655                         the ranges are mutually exclusive.  Also, if the keys
       94     8656                         of the file are known, any logical record selections
       95     8657                         will be replaced by the actual key values.
       96     8658        */
       97     8659    2   DCL 1 T_SPEC,                           /* Used for sorting ICB.REC_SEL.SPEC  */
       98     8660    2         2 * CHAR(99);
       99     8661    2   DCL ISTART UBIN;
      100     8662    2   DCL JSTART UBIN;
      101     8663    2   DCL IFINISH UBIN;
      102     8664    2   DCL JFINISH UBIN;
      103     8665    2   DCL ISTART$ PTR;
      104     8666    2   DCL JSTART$ PTR;
      105     8667    2   DCL IFINISH$ PTR;
      106     8668    2   DCL JFINISH$ PTR;
      107     8669    2   DCL B$VECTOR VECTOR BASED;
      108     8670
      109     8671
      110     8672
      111     8673    2           IF ICB.REC_SEL.CNT = 0 THEN ALTRETURN;

   8673 11 000212   000047 235000 xsym               LDA     ICB+39
        11 000213   000215 601000 11                 TNZ     s:8674

   8673 11 000214   000000 702211                    TSX2  ! 0,X1

      112     8674    2           IF ICB.FLAVOR.KNOWKEY = '1'B THEN

   8674 11 000215   000172 430000 xsym               FSZN    ICB+122
        11 000216   000632 605000 11                 TPL     s:8755

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:23   
      113     8675    3            DO;

      114     8676    4               DO I=0 TO ICB.REC_SEL.CNT-1;

   8676 11 000217   200004 450100                    STZ     I,,AUTO
        11 000220   000532 710000 11                 TRA     s:8739+3

      115     8677    4                  IF ICB.REC_SEL.SPEC.TYPE(I)=1 THEN /* LOGICAL SELECTION        */

   8677 11 000221   200004 236100                    LDQ     I,,AUTO
        11 000222   000005 402007                    MPY     5,DL
        11 000223   000050 235006 xsym               LDA     ICB+40,QL
        11 000224   000001 115007                    CMPA    1,DL
        11 000225   000433 601000 11                 TNZ     s:8723

      116     8678    5                   DO;

      117     8679    5                      ICB.REC_SEL.SPEC.TYPE(I)=2;

   8679 11 000226   000002 235007                    LDA     2,DL
        11 000227   000050 755006 xsym               STA     ICB+40,QL

      118     8680    5                      FPT_PFIL_EI.V.BOF# = %YES#;

   8680 11 000230   400000 236007                    LDQ     -131072,DL
        11 000231   000074 256000 10                 ORSQ    FPT_PFIL_EI+2

      119     8681    5                      VBASE(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=KEY_AREA$;

   8681 11 000232   000000 236000 xsym               LDQ     KEY_AREA$
        11 000233   000101 756000 10                 STQ     FPT_PRECORD_EI+3

      120     8682    5                      ICB.REC_SEL.SPEC.START.KEY$(I)=KEY_AREA$;

   8682 11 000234   200004 236100                    LDQ     I,,AUTO
        11 000235   000005 402007                    MPY     5,DL
        11 000236   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:24   
        11 000237   000000 236000 xsym               LDQ     KEY_AREA$
        11 000240   000051 756010 xsym               STQ     ICB+41,X0

      121     8683    5                      VBOUND(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=511;

   8683 11 000241   000100 236000 10                 LDQ     FPT_PRECORD_EI+2
        11 000242   177777 376007                    ANQ     65535,DL
        11 000243   000022 276000 12                 ORQ     18
        11 000244   000100 756000 10                 STQ     FPT_PRECORD_EI+2

      122     8684    5                      FPT_PRECORD_EI.V.KEYS#= %NO#;

   8684 11 000245   000023 236000 12                 LDQ     19
        11 000246   000104 356000 10                 ANSQ    FPT_PRECORD_EI+6

      123     8685    5                      FPT_PRECORD_EI.V.KEYR#= %YES#;

   8685 11 000247   200000 236007                    LDQ     65536,DL
        11 000250   000104 256000 10                 ORSQ    FPT_PRECORD_EI+6

      124     8686    5                      FPT_PRECORD_EI.V.N#=ICB.REC_SEL.SPEC.START.SEQ(I)-1;

   8686 11 000251   000052 235010 xsym               LDA     ICB+42,X0
        11 000252   000001 135007                    SBLA    1,DL
        11 000253   000105 755000 10                 STA     FPT_PRECORD_EI+7

      125     8687    5                      CALL M$PFIL(FPT_PFIL_EI);

   8687 11 000254   000072 630400 10                 EPPR0   FPT_PFIL_EI
        11 000255   040004 713400                    CLIMB   16388
        11 000256   400000 401760                    pmme    nvectors=1

      126     8688    5   PREC1:             CALL M$PRECORD(FPT_PRECORD_EI)

   8688 11 000257   000076 630400 10    PREC1        EPPR0   FPT_PRECORD_EI
        11 000260   440003 713400                    CLIMB   alt,+16387
        11 000261   401000 401760                    pmme    nvectors=3
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:25   
        11 000262   000264 702000 11                 TSX2    s:8690
        11 000263   000315 710000 11                 TRA     s:8696

      127     8689    6                       WHENALTRETURN DO;

      128     8690    7                          IF %VPSZ_ERR# = %E$PMMEINT THEN DO;

   8690 11 000264   000000 470400 xsym               LDP0    B$TCB$
        11 000265   000000 471500                    LDP1    0,,PR0
        11 000266   100102 236100                    LDQ     66,,PR1
        11 000267   377770 376007                    ANQ     131064,DL
        11 000270   001230 116007                    CMPQ    664,DL
        11 000271   000277 601000 11                 TNZ     s:8694

      129     8691    7                             FPT_PRECORD_EI.V.N# = FPT_PRECORD_EI.V.N# - M$EI$->F$DCB.
              8691                                       ARS;

   8691 11 000272   000000 473400 xsym               LDP3    M$EI$
        11 000273   000105 236000 10                 LDQ     FPT_PRECORD_EI+7
        11 000274   300000 136100                    SBLQ    0,,PR3
        11 000275   000105 756000 10                 STQ     FPT_PRECORD_EI+7

      130     8692    7                              GOTO PREC1;

   8692 11 000276   000257 710000 11                 TRA     PREC1

      131     8693    7                              END;
      132     8694    6                          CALL VPL$ERR_PROC(3,0,,,,,M$EI#);

   8694 11 000277   000016 236000 12                 LDQ     14
        11 000300   200062 756100                    STQ     JFINISH$+7,,AUTO
        11 000301   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000302   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000303   200060 757100                    STAQ    JFINISH$+5,,AUTO
        11 000304   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000305   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000306   200056 757100                    STAQ    JFINISH$+3,,AUTO
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:26   
        11 000307   000020 237000 12                 LDAQ    16
        11 000310   200054 757100                    STAQ    JFINISH$+1,,AUTO
        11 000311   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000312   000025 631400 xsym               EPPR1   B_VECTNIL+21
        11 000313   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000314   000000 011000                    NOP     0

      133     8695    6                          END;

      134     8696    5                      KEY_AREA$=PINCRC(KEY_AREA$,KEY_AREA$->TEXT$C.LEN+1);

   8696 11 000315   000000 470400 xsym               LDP0    KEY_AREA$
        11 000316   000100 101500                    MRL     fill='000'O
        11 000317   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 000320   200054 000004                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=4
        11 000321   200054 236100                    LDQ     JFINISH$+1,,AUTO
        11 000322   000020 736000                    QLS     16
        11 000323   200000 036007                    ADLQ    65536,DL
        11 000324   000000 036000 xsym               ADLQ    KEY_AREA$
        11 000325   000000 756000 xsym               STQ     KEY_AREA$

      135     8697    5                      VBASE(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=KEY_AREA$;

   8697 11 000326   000101 756000 10                 STQ     FPT_PRECORD_EI+3

      136     8698    5                      VBOUND(ADDR(FPT_PRECORD_EI.KEY_)->B$VECTOR)=511;

   8698 11 000327   000100 236000 10                 LDQ     FPT_PRECORD_EI+2
        11 000330   177777 376007                    ANQ     65535,DL
        11 000331   000022 276000 12                 ORQ     18
        11 000332   000100 756000 10                 STQ     FPT_PRECORD_EI+2

      137     8699    5                      IF ICB.REC_SEL.SPEC.FINISH.SEQ(I)=0 THEN

   8699 11 000333   200004 236100                    LDQ     I,,AUTO
        11 000334   000005 402007                    MPY     5,DL
        11 000335   000054 235006 xsym               LDA     ICB+44,QL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:27   
        11 000336   000344 601000 11                 TNZ     s:8706

      138     8700    6                       DO;

      139     8701    6                          FPT_PFIL_EI.V.BOF# = %NO#;

   8701 11 000337   000023 236000 12                 LDQ     19
        11 000340   000074 356000 10                 ANSQ    FPT_PFIL_EI+2

      140     8702    6                          FPT_PRECORD_EI.V.N# = -1;

   8702 11 000341   000001 335007                    LCA     1,DL
        11 000342   000105 755000 10                 STA     FPT_PRECORD_EI+7

      141     8703    6                          END;

   8703 11 000343   000353 710000 11                 TRA     s:8709

      142     8704    5                       ELSE
      143     8705    6                       DO;

      144     8706    6                          FPT_PFIL_EI.V.BOF# = %YES#;

   8706 11 000344   400000 236007                    LDQ     -131072,DL
        11 000345   000074 256000 10                 ORSQ    FPT_PFIL_EI+2

      145     8707    6                          FPT_PRECORD_EI.V.N#=ICB.REC_SEL.SPEC.FINISH.SEQ(I)-1;

   8707 11 000346   200004 236100                    LDQ     I,,AUTO
        11 000347   000005 402007                    MPY     5,DL
        11 000350   000054 235006 xsym               LDA     ICB+44,QL
        11 000351   000001 135007                    SBLA    1,DL
        11 000352   000105 755000 10                 STA     FPT_PRECORD_EI+7

      146     8708    6                          END;

      147     8709    5                      CALL M$PFIL(FPT_PFIL_EI);
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:28   

   8709 11 000353   000072 630400 10                 EPPR0   FPT_PFIL_EI
        11 000354   040004 713400                    CLIMB   16388
        11 000355   400000 401760                    pmme    nvectors=1

      148     8710    5   PREC2:             CALL M$PRECORD(FPT_PRECORD_EI)

   8710 11 000356   000076 630400 10    PREC2        EPPR0   FPT_PRECORD_EI
        11 000357   440003 713400                    CLIMB   alt,+16387
        11 000360   401000 401760                    pmme    nvectors=3
        11 000361   000363 702000 11                 TSX2    s:8712
        11 000362   000414 710000 11                 TRA     s:8718

      149     8711    6                       WHENALTRETURN DO;

      150     8712    7                          IF %VPSZ_ERR# = %E$PMMEINT THEN DO;

   8712 11 000363   000000 470400 xsym               LDP0    B$TCB$
        11 000364   000000 471500                    LDP1    0,,PR0
        11 000365   100102 236100                    LDQ     66,,PR1
        11 000366   377770 376007                    ANQ     131064,DL
        11 000367   001230 116007                    CMPQ    664,DL
        11 000370   000376 601000 11                 TNZ     s:8716

      151     8713    7                             FPT_PRECORD_EI.V.N# = FPT_PRECORD_EI.V.N# - M$EI$->F$DCB.
              8713                                       ARS;

   8713 11 000371   000000 473400 xsym               LDP3    M$EI$
        11 000372   000105 236000 10                 LDQ     FPT_PRECORD_EI+7
        11 000373   300000 136100                    SBLQ    0,,PR3
        11 000374   000105 756000 10                 STQ     FPT_PRECORD_EI+7

      152     8714    7                              GOTO PREC2;

   8714 11 000375   000356 710000 11                 TRA     PREC2

      153     8715    7                              END;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:29   
      154     8716    6                          CALL VPL$ERR_PROC(3,0,,,,,M$EI#);

   8716 11 000376   000016 236000 12                 LDQ     14
        11 000377   200062 756100                    STQ     JFINISH$+7,,AUTO
        11 000400   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000401   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000402   200060 757100                    STAQ    JFINISH$+5,,AUTO
        11 000403   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000404   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000405   200056 757100                    STAQ    JFINISH$+3,,AUTO
        11 000406   000020 237000 12                 LDAQ    16
        11 000407   200054 757100                    STAQ    JFINISH$+1,,AUTO
        11 000410   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000411   000025 631400 xsym               EPPR1   B_VECTNIL+21
        11 000412   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000413   000000 011000                    NOP     0

      155     8717    6                          END;

      156     8718    5                      ICB.REC_SEL.SPEC.FINISH.KEY$(I)=KEY_AREA$;

   8718 11 000414   200004 236100                    LDQ     I,,AUTO
        11 000415   000005 402007                    MPY     5,DL
        11 000416   000000 620006                    EAX0    0,QL
        11 000417   000000 236000 xsym               LDQ     KEY_AREA$
        11 000420   000053 756010 xsym               STQ     ICB+43,X0

      157     8719    5                      KEY_AREA$=PINCRC(KEY_AREA$,KEY_AREA$->TEXT$C.LEN+1);

   8719 11 000421   000000 470400 xsym               LDP0    KEY_AREA$
        11 000422   000100 101500                    MRL     fill='000'O
        11 000423   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 000424   200054 000004                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=4
        11 000425   200054 236100                    LDQ     JFINISH$+1,,AUTO
        11 000426   000020 736000                    QLS     16
        11 000427   200000 036007                    ADLQ    65536,DL
        11 000430   000000 036000 xsym               ADLQ    KEY_AREA$
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:30   
        11 000431   000000 756000 xsym               STQ     KEY_AREA$

      158     8720    5                      END;

   8720 11 000432   000527 710000 11                 TRA     s:8739

      159     8721    4                   ELSE
      160     8722    5                   DO;

      161     8723    5                      IF ICB.REC_SEL.SPEC.FINISH.KEY$(I)=ADDR(NIL) THEN

   8723 11 000433   000053 236006 xsym               LDQ     ICB+43,QL
        11 000434   000001 116000 xsym               CMPQ    B_VECTNIL+1
        11 000435   000527 601000 11                 TNZ     s:8739

      162     8724    6                       DO;

      163     8725    6                          FPT_PFIL_EI.V.BOF# = %NO#;

   8725 11 000436   000023 236000 12                 LDQ     19
        11 000437   000074 356000 10                 ANSQ    FPT_PFIL_EI+2

      164     8726    6                          FPT_PRECORD_EI.V.KEYR# = %YES#;

   8726 11 000440   200000 236007                    LDQ     65536,DL
        11 000441   000104 256000 10                 ORSQ    FPT_PRECORD_EI+6

      165     8727    6                          KEY_AREA$ -> TEXT$C.LEN = 511;

   8727 11 000442   000000 470400 xsym               LDP0    KEY_AREA$
        11 000443   000100 101400                    MRL     fill='000'O
        11 000444   000024 000004 12                 ADSC9   20                       cn=0,n=4
        11 000445   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      166     8728    6                          FPT_PRECORD_EI.KEY_ = VECTOR(KEY_AREA$->TEXT$C);

   8728 11 000446   000000 470400 xsym               LDP0    KEY_AREA$
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:31   
        11 000447   000100 101500                    MRL     fill='000'O
        11 000450   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 000451   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 000452   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 000453   000001 621010                    EAX1    1,X0
        11 000454   000000 635011                    EAA     0,X1
        11 000455   000002 771000                    ARL     2
        11 000456   000140 135007                    SBLA    96,DL
        11 000457   000000 236000 xsym               LDQ     KEY_AREA$
        11 000460   000100 757000 10                 STAQ    FPT_PRECORD_EI+2

      167     8729    6                          FPT_PRECORD_EI.V.N# = -1;

   8729 11 000461   000001 335007                    LCA     1,DL
        11 000462   000105 755000 10                 STA     FPT_PRECORD_EI+7

      168     8730    6                          CALL M$PFIL(FPT_PFIL_EI);

   8730 11 000463   000072 630400 10                 EPPR0   FPT_PFIL_EI
        11 000464   040004 713400                    CLIMB   16388
        11 000465   400000 401760                    pmme    nvectors=1

      169     8731    6                          CALL M$PRECORD(FPT_PRECORD_EI)

   8731 11 000466   000076 630400 10                 EPPR0   FPT_PRECORD_EI
        11 000467   440003 713400                    CLIMB   alt,+16387
        11 000470   401000 401760                    pmme    nvectors=3
        11 000471   000473 702000 11                 TSX2    s:8733
        11 000472   000511 710000 11                 TRA     s:8735

      170     8732    7                           WHENALTRETURN DO;

      171     8733    7                              CALL VPL$ERR_PROC(3,0,,,,,M$EI#);

   8733 11 000473   000016 236000 12                 LDQ     14
        11 000474   200062 756100                    STQ     JFINISH$+7,,AUTO
        11 000475   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:32   
        11 000476   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000477   200060 757100                    STAQ    JFINISH$+5,,AUTO
        11 000500   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 000501   000001 235000 xsym               LDA     B_VECTNIL+1
        11 000502   200056 757100                    STAQ    JFINISH$+3,,AUTO
        11 000503   000020 237000 12                 LDAQ    16
        11 000504   200054 757100                    STAQ    JFINISH$+1,,AUTO
        11 000505   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 000506   000025 631400 xsym               EPPR1   B_VECTNIL+21
        11 000507   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000510   000000 011000                    NOP     0

      172     8734    7                              END;

      173     8735    6                          ICB.REC_SEL.SPEC.FINISH.KEY$(I)=KEY_AREA$;

   8735 11 000511   200004 236100                    LDQ     I,,AUTO
        11 000512   000005 402007                    MPY     5,DL
        11 000513   000000 620006                    EAX0    0,QL
        11 000514   000000 236000 xsym               LDQ     KEY_AREA$
        11 000515   000053 756010 xsym               STQ     ICB+43,X0

      174     8736    6                          KEY_AREA$=PINCRC(KEY_AREA$,KEY_AREA$->TEXT$C.LEN+1);

   8736 11 000516   000000 470400 xsym               LDP0    KEY_AREA$
        11 000517   000100 101500                    MRL     fill='000'O
        11 000520   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 000521   200054 000004                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=4
        11 000522   200054 236100                    LDQ     JFINISH$+1,,AUTO
        11 000523   000020 736000                    QLS     16
        11 000524   200000 036007                    ADLQ    65536,DL
        11 000525   000000 036000 xsym               ADLQ    KEY_AREA$
        11 000526   000000 756000 xsym               STQ     KEY_AREA$

      175     8737    6                          END;

      176     8738    5                      END;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:33   

      177     8739    4                  END;

   8739 11 000527   200004 235100                    LDA     I,,AUTO
        11 000530   000001 035007                    ADLA    1,DL
        11 000531   200004 755100                    STA     I,,AUTO
        11 000532   200004 236100                    LDQ     I,,AUTO
        11 000533   000536 604000 11                 TMI     s:8740
        11 000534   000047 116000 xsym               CMPQ    ICB+39
        11 000535   000221 604000 11                 TMI     s:8677

      178     8740    3               IF ICB.REC_SEL.CNT=1 THEN RETURN; /* Dont have to sort only one   */

   8740 11 000536   000047 235000 xsym               LDA     ICB+39
        11 000537   000001 115007                    CMPA    1,DL
        11 000540   000543 601000 11                 TNZ     s:8741

   8740 11 000541   200012 221300                    LDX1  ! OPEN_NEXT_RET_VAL+2,,AUTO
        11 000542   000001 702211                    TSX2  ! 1,X1

      179     8741    4               DO I=0 TO ICB.REC_SEL.CNT-1;

   8741 11 000543   200004 450100                    STZ     I,,AUTO
        11 000544   000625 710000 11                 TRA     s:8751+3

      180     8742    5                  DO J=I+1 TO ICB.REC_SEL.CNT-1;

   8742 11 000545   200004 235100                    LDA     I,,AUTO
        11 000546   000001 035007                    ADLA    1,DL
        11 000547   200005 755100                    STA     J,,AUTO
        11 000550   000617 710000 11                 TRA     s:8750+1

      181     8743    5                     IF ICB.REC_SEL.SPEC.START.KEY$(I)->TEXT$C.STRING

   8743 11 000551   200004 236100                    LDQ     I,,AUTO
        11 000552   000005 402007                    MPY     5,DL
        11 000553   000051 470406 xsym               LDP0    ICB+41,QL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:34   
        11 000554   000100 101500                    MRL     fill='000'O
        11 000555   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 000556   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 000557   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 000560   200005 236100                    LDQ     J,,AUTO
        11 000561   000005 402007                    MPY     5,DL
        11 000562   000051 471406 xsym               LDP1    ICB+41,QL
        11 000563   000100 101500                    MRL     fill='000'O
        11 000564   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 000565   200055 000002                    ADSC9   JFINISH$+2,,AUTO         cn=0,n=2
        11 000566   200055 221100                    LDX1    JFINISH$+2,,AUTO
        11 000567   040140 106540                    CMPC    fill='040'O
        11 000570   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        11 000571   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        11 000572   000616 603000 11                 TRC     s:8750

      182     8744    5                       < ICB.REC_SEL.SPEC.START.KEY$(J)->TEXT$C.STRING THEN
      183     8745    6                      DO;

      184     8746    6                         T_SPEC=ICB.REC_SEL.SPEC(I);

   8746 11 000573   200004 236100                    LDQ     I,,AUTO
        11 000574   000024 402007                    MPY     20,DL
        11 000575   000100 100406                    MLR     fill='000'O
        11 000576   000050 000024 xsym               ADSC9   ICB+40,Q                 cn=0,n=20
        11 000577   200013 000143                    ADSC9   T_SPEC,,AUTO             cn=0,n=99

      185     8747    6                         ICB.REC_SEL.SPEC(I)=ICB.REC_SEL.SPEC(J);

   8747 11 000600   200005 236100                    LDQ     J,,AUTO
        11 000601   000024 402007                    MPY     20,DL
        11 000602   200054 756100                    STQ     JFINISH$+1,,AUTO
        11 000603   200004 236100                    LDQ     I,,AUTO
        11 000604   000024 402007                    MPY     20,DL
        11 000605   200054 235100                    LDA     JFINISH$+1,,AUTO
        11 000606   000006 100405                    MLR     fill='000'O
        11 000607   000050 000024 xsym               ADSC9   ICB+40,A                 cn=0,n=20
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:35   
        11 000610   000050 000024 xsym               ADSC9   ICB+40,Q                 cn=0,n=20

      186     8748    6                         ICB.REC_SEL.SPEC(J)=T_SPEC;

   8748 11 000611   200005 236100                    LDQ     J,,AUTO
        11 000612   000024 402007                    MPY     20,DL
        11 000613   000006 100500                    MLR     fill='000'O
        11 000614   200013 000024                    ADSC9   T_SPEC,,AUTO             cn=0,n=20
        11 000615   000050 000024 xsym               ADSC9   ICB+40,Q                 cn=0,n=20

      187     8749    6                         END;

      188     8750    5                     END;

   8750 11 000616   200005 054100                    AOS     J,,AUTO
        11 000617   200005 236100                    LDQ     J,,AUTO
        11 000620   000047 116000 xsym               CMPQ    ICB+39
        11 000621   000551 604000 11                 TMI     s:8743

      189     8751    4                  END;

   8751 11 000622   200004 235100                    LDA     I,,AUTO
        11 000623   000001 035007                    ADLA    1,DL
        11 000624   200004 755100                    STA     I,,AUTO
        11 000625   200004 236100                    LDQ     I,,AUTO
        11 000626   000631 604000 11                 TMI     s:8752
        11 000627   000047 116000 xsym               CMPQ    ICB+39
        11 000630   000545 604000 11                 TMI     s:8742

      190     8752    3               END;

   8752 11 000631   000711 710000 11                 TRA     s:8768

      191     8753    2            ELSE
      192     8754    3            DO;

      193     8755    3               IF ICB.REC_SEL.CNT=1 THEN RETURN; /* No need to sort              */
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:36   

   8755 11 000632   000001 115007                    CMPA    1,DL
        11 000633   000635 601000 11                 TNZ     s:8756

   8755 11 000634   000001 702211                    TSX2  ! 1,X1

      194     8756    4               DO I=0 TO ICB.REC_SEL.CNT-1;

   8756 11 000635   200004 450100                    STZ     I,,AUTO
        11 000636   000705 710000 11                 TRA     s:8765+3

      195     8757    5                  DO J=I+1 TO ICB.REC_SEL.CNT-1;

   8757 11 000637   200004 235100                    LDA     I,,AUTO
        11 000640   000001 035007                    ADLA    1,DL
        11 000641   200005 755100                    STA     J,,AUTO
        11 000642   000677 710000 11                 TRA     s:8764+1

      196     8758    5                     IF ICB.REC_SEL.SPEC.START.SEQ(I)<ICB.REC_SEL.SPEC.START.SEQ(J)
              8758                              THEN

   8758 11 000643   200005 236100                    LDQ     J,,AUTO
        11 000644   000005 402007                    MPY     5,DL
        11 000645   000000 620006                    EAX0    0,QL
        11 000646   200004 236100                    LDQ     I,,AUTO
        11 000647   000005 402007                    MPY     5,DL
        11 000650   000052 236006 xsym               LDQ     ICB+42,QL
        11 000651   000052 116010 xsym               CMPQ    ICB+42,X0
        11 000652   000676 603000 11                 TRC     s:8764

      197     8759    6                      DO;

      198     8760    6                         T_SPEC = ICB.REC_SEL.SPEC(I);

   8760 11 000653   200004 236100                    LDQ     I,,AUTO
        11 000654   000024 402007                    MPY     20,DL
        11 000655   000100 100406                    MLR     fill='000'O
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:37   
        11 000656   000050 000024 xsym               ADSC9   ICB+40,Q                 cn=0,n=20
        11 000657   200013 000143                    ADSC9   T_SPEC,,AUTO             cn=0,n=99

      199     8761    6                         ICB.REC_SEL.SPEC(I)=ICB.REC_SEL.SPEC(J);

   8761 11 000660   200005 236100                    LDQ     J,,AUTO
        11 000661   000024 402007                    MPY     20,DL
        11 000662   200054 756100                    STQ     JFINISH$+1,,AUTO
        11 000663   200004 236100                    LDQ     I,,AUTO
        11 000664   000024 402007                    MPY     20,DL
        11 000665   200054 235100                    LDA     JFINISH$+1,,AUTO
        11 000666   000006 100405                    MLR     fill='000'O
        11 000667   000050 000024 xsym               ADSC9   ICB+40,A                 cn=0,n=20
        11 000670   000050 000024 xsym               ADSC9   ICB+40,Q                 cn=0,n=20

      200     8762    6                         ICB.REC_SEL.SPEC(J)=T_SPEC;

   8762 11 000671   200005 236100                    LDQ     J,,AUTO
        11 000672   000024 402007                    MPY     20,DL
        11 000673   000006 100500                    MLR     fill='000'O
        11 000674   200013 000024                    ADSC9   T_SPEC,,AUTO             cn=0,n=20
        11 000675   000050 000024 xsym               ADSC9   ICB+40,Q                 cn=0,n=20

      201     8763    6                         END;

      202     8764    5                     END;

   8764 11 000676   200005 054100                    AOS     J,,AUTO
        11 000677   200005 236100                    LDQ     J,,AUTO
        11 000700   000047 116000 xsym               CMPQ    ICB+39
        11 000701   000643 604000 11                 TMI     s:8758

      203     8765    4                  END;

   8765 11 000702   200004 235100                    LDA     I,,AUTO
        11 000703   000001 035007                    ADLA    1,DL
        11 000704   200004 755100                    STA     I,,AUTO
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:38   
        11 000705   200004 236100                    LDQ     I,,AUTO
        11 000706   000711 604000 11                 TMI     s:8768
        11 000707   000047 116000 xsym               CMPQ    ICB+39
        11 000710   000637 604000 11                 TMI     s:8757

      204     8766    3               END;

      205     8767                                           /* Now get rid of over-lapping ranges.     */
      206     8768    3           DO I=ICB.REC_SEL.CNT-1 DOWNTO 1;

   8768 11 000711   000047 235000 xsym               LDA     ICB+39
        11 000712   000001 135007                    SBLA    1,DL
        11 000713   200004 755100                    STA     I,,AUTO
        11 000714   001154 710000 11                 TRA     s:8804+3

      207     8769    4              DO J=I-1 DOWNTO 0;

   8769 11 000715   200004 235100                    LDA     I,,AUTO
        11 000716   000001 135007                    SBLA    1,DL
        11 000717   200005 755100                    STA     J,,AUTO
        11 000720   001147 710000 11                 TRA     s:8803+2

      208     8770    4                 IF ICB.REC_SEL.SPEC.TYPE(I)=0 THEN EXIT; /* This spec was removed */

   8770 11 000721   200004 236100                    LDQ     I,,AUTO
        11 000722   000005 402007                    MPY     5,DL
        11 000723   000050 235006 xsym               LDA     ICB+40,QL
        11 000724   001151 600000 11                 TZE     s:8804

      209     8771    5                 DO CASE(ICB.REC_SEL.SPEC.TYPE(I));

   8771 11 000725   000003 115007                    CMPA    3,DL
        11 000726   000730 602005 11                 TNC     s:8771+3,AL
        11 000727   001145 710000 11                 TRA     s:8803
        11 000730   001145 710000 11                 TRA     s:8803
        11 000731   000733 710000 11                 TRA     s:8773
        11 000732   001004 710000 11                 TRA     s:8787
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:39   

      210     8772    5                  CASE(1);                 /* LOGICAL RECORD SELECTION           */

      211     8773    5                    ISTART=ICB.REC_SEL.SPEC.START.SEQ(I);

   8773 11 000733   000052 235006 xsym               LDA     ICB+42,QL
        11 000734   200044 755100                    STA     ISTART,,AUTO

      212     8774    5                    JSTART=ICB.REC_SEL.SPEC.START.SEQ(J);

   8774 11 000735   200005 236100                    LDQ     J,,AUTO
        11 000736   000005 402007                    MPY     5,DL
        11 000737   000052 235006 xsym               LDA     ICB+42,QL
        11 000740   200045 755100                    STA     JSTART,,AUTO

      213     8775    5                    IFINISH=ICB.REC_SEL.SPEC.FINISH.SEQ(I);

   8775 11 000741   200004 236100                    LDQ     I,,AUTO
        11 000742   000005 402007                    MPY     5,DL
        11 000743   000054 235006 xsym               LDA     ICB+44,QL
        11 000744   200046 755100                    STA     IFINISH,,AUTO

      214     8776    5                    JFINISH=ICB.REC_SEL.SPEC.FINISH.SEQ(J);

   8776 11 000745   200005 236100                    LDQ     J,,AUTO
        11 000746   000005 402007                    MPY     5,DL
        11 000747   000054 235006 xsym               LDA     ICB+44,QL
        11 000750   200047 755100                    STA     JFINISH,,AUTO

      215     8777    5                    IF ISTART<=JSTART AND IFINISH>=JFINISH THEN

   8777 11 000751   200045 236100                    LDQ     JSTART,,AUTO
        11 000752   200044 116100                    CMPQ    ISTART,,AUTO
        11 000753   000763 602000 11                 TNC     s:8781
        11 000754   200046 236100                    LDQ     IFINISH,,AUTO
        11 000755   200047 116100                    CMPQ    JFINISH,,AUTO
        11 000756   000763 602000 11                 TNC     s:8781
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:40   

      216     8778    6                     DO;                   /* J IS WITHIN I                      */

      217     8779    6                        ICB.REC_SEL.SPEC.TYPE(J)=0; /* Remove inner range        */

   8779 11 000757   200005 236100                    LDQ     J,,AUTO
        11 000760   000005 402007                    MPY     5,DL
        11 000761   000050 450006 xsym               STZ     ICB+40,QL

      218     8780    6                        END;

   8780 11 000762   001145 710000 11                 TRA     s:8803

      219     8781    5                    ELSE IF ISTART<JSTART AND IFINISH<JFINISH AND JSTART<=IFINISH THEN

   8781 11 000763   200044 236100                    LDQ     ISTART,,AUTO
        11 000764   200045 116100                    CMPQ    JSTART,,AUTO
        11 000765   001145 603000 11                 TRC     s:8803
        11 000766   200046 236100                    LDQ     IFINISH,,AUTO
        11 000767   200047 116100                    CMPQ    JFINISH,,AUTO
        11 000770   001145 603000 11                 TRC     s:8803
        11 000771   200045 116100                    CMPQ    JSTART,,AUTO
        11 000772   001145 602000 11                 TNC     s:8803

      220     8782    6                        DO;

      221     8783    6                          ICB.REC_SEL.SPEC.FINISH.SEQ(I)=ICB.REC_SEL.SPEC.FINISH.SEQ(J
              8783                                    );

   8783 11 000773   200004 236100                    LDQ     I,,AUTO
        11 000774   000005 402007                    MPY     5,DL
        11 000775   000000 620006                    EAX0    0,QL
        11 000776   200005 236100                    LDQ     J,,AUTO
        11 000777   000005 402007                    MPY     5,DL
        11 001000   000054 235006 xsym               LDA     ICB+44,QL
        11 001001   000054 755010 xsym               STA     ICB+44,X0

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:41   
      222     8784    6                           ICB.REC_SEL.SPEC.TYPE(J)=0;

   8784 11 001002   000050 450006 xsym               STZ     ICB+40,QL

      223     8785    6                           END;

   8785 11 001003   001145 710000 11                 TRA     s:8803

      224     8786    5                  CASE(2);                 /* KEYED RECORD SELECTION             */

      225     8787    5                    ISTART$=ICB.REC_SEL.SPEC.START.KEY$(I);

   8787 11 001004   000051 236006 xsym               LDQ     ICB+41,QL
        11 001005   200050 756100                    STQ     ISTART$,,AUTO

      226     8788    5                    JSTART$=ICB.REC_SEL.SPEC.START.KEY$(J);

   8788 11 001006   200005 236100                    LDQ     J,,AUTO
        11 001007   000005 402007                    MPY     5,DL
        11 001010   000051 236006 xsym               LDQ     ICB+41,QL
        11 001011   200051 756100                    STQ     JSTART$,,AUTO

      227     8789    5                    IFINISH$=ICB.REC_SEL.SPEC.FINISH.KEY$(I);

   8789 11 001012   200004 236100                    LDQ     I,,AUTO
        11 001013   000005 402007                    MPY     5,DL
        11 001014   000053 236006 xsym               LDQ     ICB+43,QL
        11 001015   200052 756100                    STQ     IFINISH$,,AUTO

      228     8790    5                    JFINISH$=ICB.REC_SEL.SPEC.FINISH.KEY$(J);

   8790 11 001016   200005 236100                    LDQ     J,,AUTO
        11 001017   000005 402007                    MPY     5,DL
        11 001020   000053 236006 xsym               LDQ     ICB+43,QL
        11 001021   200053 756100                    STQ     JFINISH$,,AUTO

      229     8791    5                    IF ISTART$->TEXT$C.STRING<=JSTART$->TEXT$C.STRING AND IFINISH$->
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:42   
              8791                             TEXT$C.STRING>=JFINISH$->TEXT$C.STRING THEN

   8791 11 001022   200050 470500                    LDP0    ISTART$,,AUTO
        11 001023   000100 101500                    MRL     fill='000'O
        11 001024   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 001025   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 001026   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 001027   200051 471500                    LDP1    JSTART$,,AUTO
        11 001030   000100 101500                    MRL     fill='000'O
        11 001031   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 001032   200055 000002                    ADSC9   JFINISH$+2,,AUTO         cn=0,n=2
        11 001033   200055 221100                    LDX1    JFINISH$+2,,AUTO
        11 001034   040140 106540                    CMPC    fill='040'O
        11 001035   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        11 001036   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        11 001037   001062 602000 11                 TNC     s:8795
        11 001040   200052 473500                    LDP3    IFINISH$,,AUTO
        11 001041   000100 101500                    MRL     fill='000'O
        11 001042   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        11 001043   200056 000002                    ADSC9   JFINISH$+3,,AUTO         cn=0,n=2
        11 001044   200056 222100                    LDX2    JFINISH$+3,,AUTO
        11 001045   200053 474500                    LDP4    JFINISH$,,AUTO
        11 001046   000100 101500                    MRL     fill='000'O
        11 001047   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        11 001050   200057 000002                    ADSC9   JFINISH$+4,,AUTO         cn=0,n=2
        11 001051   200057 223100                    LDX3    JFINISH$+4,,AUTO
        11 001052   040140 106540                    CMPC    fill='040'O
        11 001053   300000 200012                    ADSC9   0,,PR3                   cn=1,n=*X2
        11 001054   400000 200013                    ADSC9   0,,PR4                   cn=1,n=*X3
        11 001055   001062 602000 11                 TNC     s:8795

      230     8792    6                     DO;                   /* J IS WITHIN I                      */

      231     8793    6                        ICB.REC_SEL.SPEC.TYPE(J)=0; /* Remove inner range        */

   8793 11 001056   200005 236100                    LDQ     J,,AUTO
        11 001057   000005 402007                    MPY     5,DL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:43   
        11 001060   000050 450006 xsym               STZ     ICB+40,QL

      232     8794    6                        END;

   8794 11 001061   001145 710000 11                 TRA     s:8803

      233     8795    5                     ELSE IF ISTART$->TEXT$C.STRING<JSTART$->TEXT$C.STRING

   8795 11 001062   000100 101500                    MRL     fill='000'O
        11 001063   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        11 001064   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 001065   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 001066   000100 101500                    MRL     fill='000'O
        11 001067   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 001070   200055 000002                    ADSC9   JFINISH$+2,,AUTO         cn=0,n=2
        11 001071   200055 221100                    LDX1    JFINISH$+2,,AUTO
        11 001072   040140 106540                    CMPC    fill='040'O
        11 001073   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
        11 001074   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        11 001075   001145 603000 11                 TRC     s:8803
        11 001076   200052 473500                    LDP3    IFINISH$,,AUTO
        11 001077   000100 101500                    MRL     fill='000'O
        11 001100   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        11 001101   200056 000002                    ADSC9   JFINISH$+3,,AUTO         cn=0,n=2
        11 001102   200056 222100                    LDX2    JFINISH$+3,,AUTO
        11 001103   200053 474500                    LDP4    JFINISH$,,AUTO
        11 001104   000100 101500                    MRL     fill='000'O
        11 001105   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        11 001106   200057 000002                    ADSC9   JFINISH$+4,,AUTO         cn=0,n=2
        11 001107   200057 223100                    LDX3    JFINISH$+4,,AUTO
        11 001110   040140 106540                    CMPC    fill='040'O
        11 001111   300000 200012                    ADSC9   0,,PR3                   cn=1,n=*X2
        11 001112   400000 200013                    ADSC9   0,,PR4                   cn=1,n=*X3
        11 001113   001145 603000 11                 TRC     s:8803
        11 001114   000100 101500                    MRL     fill='000'O
        11 001115   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 001116   200060 000002                    ADSC9   JFINISH$+5,,AUTO         cn=0,n=2
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:44   
        11 001117   200060 224100                    LDX4    JFINISH$+5,,AUTO
        11 001120   000100 101500                    MRL     fill='000'O
        11 001121   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        11 001122   200061 000002                    ADSC9   JFINISH$+6,,AUTO         cn=0,n=2
        11 001123   200061 225100                    LDX5    JFINISH$+6,,AUTO
        11 001124   040140 106540                    CMPC    fill='040'O
        11 001125   300000 200015                    ADSC9   0,,PR3                   cn=1,n=*X5
        11 001126   100000 200014                    ADSC9   0,,PR1                   cn=1,n=*X4
        11 001127   001145 602000 11                 TNC     s:8803

      234     8796    5                         AND IFINISH$->TEXT$C.STRING<JFINISH$->TEXT$C.STRING
      235     8797    5                         AND JSTART$->TEXT$C.STRING<=IFINISH$->TEXT$C.STRING THEN
      236     8798    6                        DO;

      237     8799    6                           ICB.REC_SEL.SPEC.FINISH(I)=ICB.REC_SEL.SPEC.FINISH(J);

   8799 11 001130   200004 236100                    LDQ     I,,AUTO
        11 001131   000005 402007                    MPY     5,DL
        11 001132   000000 620006                    EAX0    0,QL
        11 001133   200005 236100                    LDQ     J,,AUTO
        11 001134   000024 402007                    MPY     20,DL
        11 001135   000000 635010                    EAA     0,X0
        11 001136   000020 771000                    ARL     16
        11 001137   000005 100406                    MLR     fill='000'O
        11 001140   000053 000010 xsym               ADSC9   ICB+43,Q                 cn=0,n=8
        11 001141   000053 000010 xsym               ADSC9   ICB+43,A                 cn=0,n=8

      238     8800    6                           ICB.REC_SEL.SPEC.TYPE(J)=0;

   8800 11 001142   200005 236100                    LDQ     J,,AUTO
        11 001143   000005 402007                    MPY     5,DL
        11 001144   000050 450006 xsym               STZ     ICB+40,QL

      239     8801    6                           END;

      240     8802    5                  END;

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:45   
      241     8803    4                 END;

   8803 11 001145   000001 336007                    LCQ     1,DL
        11 001146   200005 056100                    ASQ     J,,AUTO
        11 001147   200005 235100                    LDA     J,,AUTO
        11 001150   000721 605000 11                 TPL     s:8770

      242     8804    3              END;

   8804 11 001151   200004 235100                    LDA     I,,AUTO
        11 001152   000001 135007                    SBLA    1,DL
        11 001153   200004 755100                    STA     I,,AUTO
        11 001154   000715 601000 11                 TNZ     s:8769

      243     8805    2   END MUNGE_RANGES;

   8805 11 001155   200012 221300                    LDX1  ! OPEN_NEXT_RET_VAL+2,,AUTO
        11 001156   000001 702211                    TSX2  ! 1,X1

      244     8806        %EJECT;
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:46   
      245     8807    1   DELETE_RECORDS: PROC;

   8807 11 001157   200012 741300       DELETE_RECO* STX1  ! OPEN_NEXT_RET_VAL+2,,AUTO

      246     8808        /*I*  NAME: DELETE_RECORDS
      247     8809              PURPOSE: To delete the records specified by ICB.REC_SEL
      248     8810              CALL:  CALL DELETE_RECORDS;
      249     8811              DESCRIPTION: This routine deletes the records indicated by
      250     8812                           ICB.REC_SEL.  The TYPE field of that structure
      251     8813                           determines how the records should be deleted.
      252     8814                           TYPE    ACTION
      253     8815                           ----    ------
      254     8816                             0      None - The record range lies within another
      255     8817                             1      Delete the records one at a time by positioning
      256     8818                                    to the first, calling M$DELREC, advancing
      257     8819                                    one record and deleting it until all records
      258     8820                                    in the range have bee deleted.
      259     8821                             2      Delete using KEY and LKEY in M$DELREC
      260     8822        */
      261     8823    2   DCL TYPE_FLAG UBIN;
      262     8824    2   DCL RANGE_END UBIN;
      263     8825        %FPT_DELREC(FPTN=FPT_DELREC_EI,DCB=M$EI,BRK=YES);
      264     8844    3           DO I=0 TO ICB.REC_SEL.CNT-1;

   8844 11 001160   200004 450100                    STZ     I,,AUTO
        11 001161   001515 710000 11                 TRA     s:8896+3

      265     8845    3              TYPE_FLAG = ICB.REC_SEL.SPEC.TYPE(I);

   8845 11 001162   200004 236100                    LDQ     I,,AUTO
        11 001163   000005 402007                    MPY     5,DL
        11 001164   000050 235006 xsym               LDA     ICB+40,QL
        11 001165   200013 755100                    STA     TYPE_FLAG,,AUTO

      266     8846    3              IF M$EI$->F$DCB.ORG = %RELATIVE# THEN

   8846 11 001166   000000 470400 xsym               LDP0    M$EI$
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:47   
        11 001167   000032 236100                    LDQ     26,,PR0
        11 001170   777000 376003                    ANQ     -512,DU
        11 001171   005000 116003                    CMPQ    2560,DU
        11 001172   001175 601000 11                 TNZ     s:8848

      267     8847    3                 TYPE_FLAG=2;    /* We can use KEY and LKEY for RELATIVE files   */

   8847 11 001173   000002 235007                    LDA     2,DL
        11 001174   200013 755100                    STA     TYPE_FLAG,,AUTO

      268     8848    4              DO CASE(TYPE_FLAG);

   8848 11 001175   000003 115007                    CMPA    3,DL
        11 001176   001200 602005 11                 TNC     s:8848+3,AL
        11 001177   001512 710000 11                 TRA     s:8896
        11 001200   001512 710000 11                 TRA     s:8896
        11 001201   001203 710000 11                 TRA     s:8850
        11 001202   001336 710000 11                 TRA     s:8879

      269     8849    4               CASE(1);

      270     8850    4                 FPT_PFIL_EI.V.BOF# = %YES#;

   8850 11 001203   400000 236007                    LDQ     -131072,DL
        11 001204   000074 256000 10                 ORSQ    FPT_PFIL_EI+2

      271     8851    4                 CALL M$PFIL(FPT_PFIL_EI);

   8851 11 001205   000072 630400 10                 EPPR0   FPT_PFIL_EI
        11 001206   040004 713400                    CLIMB   16388
        11 001207   400000 401760                    pmme    nvectors=1

      272     8852    4                 FPT_PRECORD_EI.V.N#=ICB.REC_SEL.SPEC.START.SEQ(I)-1;

   8852 11 001210   200004 236100                    LDQ     I,,AUTO
        11 001211   000005 402007                    MPY     5,DL
        11 001212   000052 235006 xsym               LDA     ICB+42,QL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:48   
        11 001213   000001 135007                    SBLA    1,DL
        11 001214   000105 755000 10                 STA     FPT_PRECORD_EI+7

      273     8853    4                 FPT_DELREC_EI.KEY_=VECTOR(NIL);

   8853 11 001215   000026 237000 12                 LDAQ    22
        11 001216   000112 757000 10                 STAQ    FPT_DELREC_EI+2

      274     8854    4                 FPT_DELREC_EI.LKEY_=VECTOR(NIL);

   8854 11 001217   000026 237000 12                 LDAQ    22
        11 001220   000114 757000 10                 STAQ    FPT_DELREC_EI+4

      275     8855    4                 IF ICB.REC_SEL.SPEC.FINISH.SEQ(I)=0 THEN

   8855 11 001221   200004 236100                    LDQ     I,,AUTO
        11 001222   000005 402007                    MPY     5,DL
        11 001223   000054 235006 xsym               LDA     ICB+44,QL
        11 001224   001230 601000 11                 TNZ     s:8858

      276     8856    4                    RANGE_END=BITBIN('777777777777'O);

   8856 11 001225   000027 235000 xsym               LDA     B_VECTNIL+23
        11 001226   200014 755100                    STA     RANGE_END,,AUTO
        11 001227   001231 710000 11                 TRA     s:8859

      277     8857    4                  ELSE
      278     8858    4                    RANGE_END=ICB.REC_SEL.SPEC.FINISH.SEQ(I);

   8858 11 001230   200014 755100                    STA     RANGE_END,,AUTO

      279     8859    5                 DO J=ICB.REC_SEL.SPEC.START.SEQ(I) TO RANGE_END;

   8859 11 001231   000052 235006 xsym               LDA     ICB+42,QL
        11 001232   200005 755100                    STA     J,,AUTO
        11 001233   001331 710000 11                 TRA     s:8877+1

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:49   
      280     8860    5   PREC3:           CALL M$PRECORD(FPT_PRECORD_EI)

   8860 11 001234   000076 630400 10    PREC3        EPPR0   FPT_PRECORD_EI
        11 001235   440003 713400                    CLIMB   alt,+16387
        11 001236   401000 401760                    pmme    nvectors=3
        11 001237   001241 702000 11                 TSX2    s:8862
        11 001240   001272 710000 11                 TRA     s:8868

      281     8861    6                     WHENALTRETURN DO;

      282     8862    7                        IF %VPSZ_ERR# = %E$PMMEINT THEN DO;

   8862 11 001241   000000 470400 xsym               LDP0    B$TCB$
        11 001242   000000 471500                    LDP1    0,,PR0
        11 001243   100102 236100                    LDQ     66,,PR1
        11 001244   377770 376007                    ANQ     131064,DL
        11 001245   001230 116007                    CMPQ    664,DL
        11 001246   001254 601000 11                 TNZ     s:8866

      283     8863    7                            FPT_PRECORD_EI.V.N# = FPT_PRECORD_EI.V.N# - M$EI$->F$DCB.
              8863                                     ARS;

   8863 11 001247   000000 473400 xsym               LDP3    M$EI$
        11 001250   000105 236000 10                 LDQ     FPT_PRECORD_EI+7
        11 001251   300000 136100                    SBLQ    0,,PR3
        11 001252   000105 756000 10                 STQ     FPT_PRECORD_EI+7

      284     8864    7                            GOTO PREC3;

   8864 11 001253   001234 710000 11                 TRA     PREC3

      285     8865    7                            END;
      286     8866    6                        CALL VPL$ERR_PROC(3,0,,,,,M$EI#);

   8866 11 001254   000016 236000 12                 LDQ     14
        11 001255   200062 756100                    STQ     JFINISH$+7,,AUTO
        11 001256   000001 236000 xsym               LDQ     B_VECTNIL+1
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:50   
        11 001257   000001 235000 xsym               LDA     B_VECTNIL+1
        11 001260   200060 757100                    STAQ    JFINISH$+5,,AUTO
        11 001261   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 001262   000001 235000 xsym               LDA     B_VECTNIL+1
        11 001263   200056 757100                    STAQ    JFINISH$+3,,AUTO
        11 001264   000020 237000 12                 LDAQ    16
        11 001265   200054 757100                    STAQ    JFINISH$+1,,AUTO
        11 001266   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 001267   000025 631400 xsym               EPPR1   B_VECTNIL+21
        11 001270   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 001271   000000 011000                    NOP     0

      287     8867    6                        END;

      288     8868    5                    CALL M$DELREC(FPT_DELREC_EI)

   8868 11 001272   000110 630400 10                 EPPR0   FPT_DELREC_EI
        11 001273   440002 713400                    CLIMB   alt,+16386
        11 001274   401400 401760                    pmme    nvectors=4
        11 001275   001277 702000 11                 TSX2    s:8870
        11 001276   001327 710000 11                 TRA     s:8876

      289     8869    6                     WHENALTRETURN DO;

      290     8870    6                        IF %VPSZ_ERR# = %E$EOF

   8870 11 001277   000000 470400 xsym               LDP0    B$TCB$
        11 001300   000000 471500                    LDP1    0,,PR0
        11 001301   100102 236100                    LDQ     66,,PR1
        11 001302   377770 376007                    ANQ     131064,DL
        11 001303   000060 116007                    CMPQ    48,DL
        11 001304   001311 601000 11                 TNZ     s:8874
        11 001305   200004 236100                    LDQ     I,,AUTO
        11 001306   000005 402007                    MPY     5,DL
        11 001307   000054 235006 xsym               LDA     ICB+44,QL
        11 001310   001327 600000 11                 TZE     s:8876

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:51   
      291     8871    6                          AND ICB.REC_SEL.SPEC.FINISH.SEQ(I)=0 THEN
      292     8872    6                           ;          /* Ignore this error - we deleted to EOF   */
      293     8873    6                         ELSE
      294     8874    6                           CALL VPL$ERR_PROC(3,0,,,,,M$EI#);

   8874 11 001311   000016 236000 12                 LDQ     14
        11 001312   200062 756100                    STQ     JFINISH$+7,,AUTO
        11 001313   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 001314   000001 235000 xsym               LDA     B_VECTNIL+1
        11 001315   200060 757100                    STAQ    JFINISH$+5,,AUTO
        11 001316   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 001317   000001 235000 xsym               LDA     B_VECTNIL+1
        11 001320   200056 757100                    STAQ    JFINISH$+3,,AUTO
        11 001321   000020 237000 12                 LDAQ    16
        11 001322   200054 757100                    STAQ    JFINISH$+1,,AUTO
        11 001323   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 001324   000025 631400 xsym               EPPR1   B_VECTNIL+21
        11 001325   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 001326   000000 011000                    NOP     0

      295     8875    6                        END;

      296     8876    5                    FPT_PRECORD_EI.V.N#=0;

   8876 11 001327   000105 450000 10                 STZ     FPT_PRECORD_EI+7

      297     8877    5                    END;

   8877 11 001330   200005 054100                    AOS     J,,AUTO
        11 001331   200014 236100                    LDQ     RANGE_END,,AUTO
        11 001332   001234 604000 11                 TMI     PREC3
        11 001333   200005 116100                    CMPQ    J,,AUTO
        11 001334   001234 605000 11                 TPL     PREC3
        11 001335   001512 710000 11                 TRA     s:8896

      298     8878    4               CASE(2);

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:52   
      299     8879    4                 IF M$EI$->F$DCB.ORG = %IREL# OR

   8879 11 001336   015000 116003                    CMPQ    6656,DU
        11 001337   001342 600000 11                 TZE     s:8881
        11 001340   006000 116003                    CMPQ    3072,DU
        11 001341   001403 601000 11                 TNZ     s:8885

      300     8880    5                   M$EI$->F$DCB.ORG = %INDEXED# THEN DO;

      301     8881    5                     FPT_DELREC_EI.KEY_=VECTOR(SUBSTR(ICB.REC_SEL.SPEC.START.KEY$(I)->
              8881                              TEXT$C.STRING,0,M$EI$->F$DCB.KEYL));

   8881 11 001342   200004 236100                    LDQ     I,,AUTO
        11 001343   000005 402007                    MPY     5,DL
        11 001344   000051 471406 xsym               LDP1    ICB+41,QL
        11 001345   000100 101500                    MRL     fill='000'O
        11 001346   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 001347   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 001350   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 001351   000036 236100                    LDQ     30,,PR0
        11 001352   000011 772000                    QRL     9
        11 001353   000777 376007                    ANQ     511,DL
        11 001354   000064 737000                    LLS     52
        11 001355   000140 135007                    SBLA    96,DL
        11 001356   200055 451500                    STP1    JFINISH$+2,,AUTO
        11 001357   200055 236100                    LDQ     JFINISH$+2,,AUTO
        11 001360   200000 036007                    ADLQ    65536,DL
        11 001361   000112 757000 10                 STAQ    FPT_DELREC_EI+2

      302     8882    5                     FPT_DELREC_EI.LKEY_=VECTOR(SUBSTR(ICB.REC_SEL.SPEC.FINISH.KEY$(I)
              8882                              ->TEXT$C.STRING,0,M$EI$->F$DCB.KEYL));

   8882 11 001362   200004 236100                    LDQ     I,,AUTO
        11 001363   000005 402007                    MPY     5,DL
        11 001364   000053 471406 xsym               LDP1    ICB+43,QL
        11 001365   000100 101500                    MRL     fill='000'O
        11 001366   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:53   
        11 001367   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 001370   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 001371   000036 236100                    LDQ     30,,PR0
        11 001372   000011 772000                    QRL     9
        11 001373   000777 376007                    ANQ     511,DL
        11 001374   000064 737000                    LLS     52
        11 001375   000140 135007                    SBLA    96,DL
        11 001376   200055 451500                    STP1    JFINISH$+2,,AUTO
        11 001377   200055 236100                    LDQ     JFINISH$+2,,AUTO
        11 001400   200000 036007                    ADLQ    65536,DL
        11 001401   000114 757000 10                 STAQ    FPT_DELREC_EI+4

      303     8883    5                     END;

   8883 11 001402   001437 710000 11                 TRA     s:8888

      304     8884    5                  ELSE DO;

      305     8885    5                    FPT_DELREC_EI.KEY_=VECTOR(ICB.REC_SEL.SPEC.START.KEY$(I)->TEXT$C);

   8885 11 001403   200004 236100                    LDQ     I,,AUTO
        11 001404   000005 402007                    MPY     5,DL
        11 001405   000051 471406 xsym               LDP1    ICB+41,QL
        11 001406   000100 101500                    MRL     fill='000'O
        11 001407   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 001410   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 001411   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 001412   000001 621010                    EAX1    1,X0
        11 001413   000000 635011                    EAA     0,X1
        11 001414   000002 771000                    ARL     2
        11 001415   000140 135007                    SBLA    96,DL
        11 001416   200055 451500                    STP1    JFINISH$+2,,AUTO
        11 001417   200055 236100                    LDQ     JFINISH$+2,,AUTO
        11 001420   000112 757000 10                 STAQ    FPT_DELREC_EI+2

      306     8886    5                    FPT_DELREC_EI.LKEY_=VECTOR(ICB.REC_SEL.SPEC.FINISH.KEY$(I)->TEXT$C
              8886                              );
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:54   

   8886 11 001421   200004 236100                    LDQ     I,,AUTO
        11 001422   000005 402007                    MPY     5,DL
        11 001423   000053 471406 xsym               LDP1    ICB+43,QL
        11 001424   000100 101500                    MRL     fill='000'O
        11 001425   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 001426   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 001427   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 001430   000001 621010                    EAX1    1,X0
        11 001431   000000 635011                    EAA     0,X1
        11 001432   000002 771000                    ARL     2
        11 001433   000140 135007                    SBLA    96,DL
        11 001434   200055 451500                    STP1    JFINISH$+2,,AUTO
        11 001435   200055 236100                    LDQ     JFINISH$+2,,AUTO
        11 001436   000114 757000 10                 STAQ    FPT_DELREC_EI+4

      307     8887    5                     END;

      308     8888    4                 IF ICB.REC_SEL.SPEC.START.KEY$(I)->TEXT$C.STRING=ICB.REC_SEL.SPEC.
              8888                          FINISH.KEY$(I)->TEXT$C.STRING THEN

   8888 11 001437   200004 236100                    LDQ     I,,AUTO
        11 001440   000005 402007                    MPY     5,DL
        11 001441   000051 471406 xsym               LDP1    ICB+41,QL
        11 001442   000100 101500                    MRL     fill='000'O
        11 001443   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        11 001444   200054 000002                    ADSC9   JFINISH$+1,,AUTO         cn=0,n=2
        11 001445   200054 220100                    LDX0    JFINISH$+1,,AUTO
        11 001446   000053 473406 xsym               LDP3    ICB+43,QL
        11 001447   000100 101500                    MRL     fill='000'O
        11 001450   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        11 001451   200055 000002                    ADSC9   JFINISH$+2,,AUTO         cn=0,n=2
        11 001452   200055 221100                    LDX1    JFINISH$+2,,AUTO
        11 001453   040140 106540                    CMPC    fill='040'O
        11 001454   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        11 001455   300000 200011                    ADSC9   0,,PR3                   cn=1,n=*X1
        11 001456   001461 601000 11                 TNZ     DELREC1
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:55   

      309     8889    4                    FPT_DELREC_EI.LKEY_ = VECTOR(NIL);
              8889                             /* Allow error if single key not found */

   8889 11 001457   000026 237000 12                 LDAQ    22
        11 001460   000114 757000 10                 STAQ    FPT_DELREC_EI+4

      310     8890    4   DELREC1:      CALL M$DELREC(FPT_DELREC_EI)

   8890 11 001461   000110 630400 10    DELREC1      EPPR0   FPT_DELREC_EI
        11 001462   440002 713400                    CLIMB   alt,+16386
        11 001463   401400 401760                    pmme    nvectors=4
        11 001464   001466 702000 11                 TSX2    s:8892
        11 001465   001512 710000 11                 TRA     s:8896

      311     8891    5                  WHENALTRETURN DO;

      312     8892    5                     IF %VPSZ_ERR# = %E$PMMEINT THEN GOTO DELREC1;

   8892 11 001466   000000 470400 xsym               LDP0    B$TCB$
        11 001467   000000 471500                    LDP1    0,,PR0
        11 001470   100102 236100                    LDQ     66,,PR1
        11 001471   377770 376007                    ANQ     131064,DL
        11 001472   001230 116007                    CMPQ    664,DL
        11 001473   001461 600000 11                 TZE     DELREC1

      313     8893    5                     CALL VPL$ERR_PROC(3,0,,,,,M$EI#);

   8893 11 001474   000016 236000 12                 LDQ     14
        11 001475   200062 756100                    STQ     JFINISH$+7,,AUTO
        11 001476   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 001477   000001 235000 xsym               LDA     B_VECTNIL+1
        11 001500   200060 757100                    STAQ    JFINISH$+5,,AUTO
        11 001501   000001 236000 xsym               LDQ     B_VECTNIL+1
        11 001502   000001 235000 xsym               LDA     B_VECTNIL+1
        11 001503   200056 757100                    STAQ    JFINISH$+3,,AUTO
        11 001504   000020 237000 12                 LDAQ    16
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:56   
        11 001505   200054 757100                    STAQ    JFINISH$+1,,AUTO
        11 001506   200054 630500                    EPPR0   JFINISH$+1,,AUTO
        11 001507   000025 631400 xsym               EPPR1   B_VECTNIL+21
        11 001510   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 001511   000000 011000                    NOP     0

      314     8894    5                     END;

      315     8895    4               END;

      316     8896    3              END;

   8896 11 001512   200004 235100                    LDA     I,,AUTO
        11 001513   000001 035007                    ADLA    1,DL
        11 001514   200004 755100                    STA     I,,AUTO
        11 001515   200004 236100                    LDQ     I,,AUTO
        11 001516   001521 604000 11                 TMI     s:8897
        11 001517   000047 116000 xsym               CMPQ    ICB+39
        11 001520   001162 604000 11                 TMI     s:8845

      317     8897    2   END DELETE_RECORDS;

   8897 11 001521   200012 221300                    LDX1  ! OPEN_NEXT_RET_VAL+2,,AUTO
        11 001522   000001 702211                    TSX2  ! 1,X1

      318     8898    1   END VPK$DELREC;

   8898 11 001523   000000 702200 xent               TSX2  ! X66_ARET
      319     8899        %EOD;

PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:57   
--  Include file information  --

   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$DELREC.
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:58   

 **** Variables and constants ****

  ****  Section 010  Data  VPK$DELREC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   110-0-0/d STRC(360)   r     1 FPT_DELREC_EI              0-0-0/d STRC(2088)  r     1 FPT_OPEN
    72-0-0/d STRC(144)   r     1 FPT_PFIL_EI               76-0-0/d STRC(360)   r     1 FPT_PRECORD_EI

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w UBIN        r     1 I                         46-0-0/w UBIN        r     1 IFINISH
    52-0-0/w PTR         r     1 IFINISH$                  44-0-0/w UBIN        r     1 ISTART
    50-0-0/w PTR         r     1 ISTART$                    5-0-0/w SBIN        r     1 J
    47-0-0/w UBIN        r     1 JFINISH                   53-0-0/w PTR         r     1 JFINISH$
    45-0-0/w UBIN        r     1 JSTART                    51-0-0/w PTR         r     1 JSTART$
     7-0-0/w UBIN        r     1 NEXT_SPEC_RET_VAL         10-0-0/w UBIN        r     1 OPEN_NEXT_RET_VAL
     3-0-0/w PTR         r     1 P$                        14-0-0/w UBIN        r     1 RANGE_END
     6-0-0/w PTR         r     1 SOURCELIST$               13-0-0/w UBIN        r     1 TYPE_FLAG
    13-0-0/c STRC(891)   r     1 T_SPEC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ABORT_CMD                  0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/d STRC(1080)  r     1 FPT_CLOSE_EI               0-0-0/d STRC(5868)  r     1 ICB
     0-0-0/w PTR         r     1 KEY_AREA$                  0-0-0/w SBIN        r     1 M$EI#
     0-0-0/w PTR         r     1 M$EI$                      0-0-0/w STRC(504)   r     1 PCB

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:59   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d VECT        r     1 B$VECTOR                   0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$EI                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/c ASTR(9)     r     1 TEXT$C


   Procedure VPK$DELREC requires 852 words for executable code.
   Procedure VPK$DELREC requires 52 words of local(AUTO) storage.
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:60   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:61   
          MINI XREF LISTING

ABORT_CMD
      5187**DCL      8599<<REMEMBR
B$ALT.CODE
      8183**DCL      8183--REDEF    8184--REDEF    8184--REDEF
B$ALT.ERR.ERR#
      8185**DCL      8185--REDEF    8690>>IF       8712>>IF       8862>>IF       8870>>IF       8892>>IF
B$ALT.EVID
      8184**DCL      8184--REDEF    8184--REDEF
B$TCB.ALT$
      8179**DCL      8690>>IF       8712>>IF       8862>>IF       8870>>IF       8892>>IF
B$TCB$
      5987**DCL      8690>>IF       8712>>IF       8862>>IF       8870>>IF       8892>>IF
B$VECTOR IN PROCEDURE MUNGE_RANGES
      8669**DCL      8681<<ASSIGN   8683<<ASSIGN   8697<<ASSIGN   8698<<ASSIGN
BREAK_LOC
      5222**DCL      5222--REDEF
DEF_ICB.FID.STRING
      5820**DCL      5821--REDEF
DELETE_RECORDS
      8807**PROC     8641--CALL
DELREC1 IN PROCEDURE DELETE_RECORDS
      8890**LABEL    8892--GOTO
DELREC_ABORT
      8649**LABEL    8599--REMEMBR
DEV_ICB.FID.STRING
      5706**DCL      5707--REDEF
EI_KEY.KEY
      5918**DCL      5918--REDEF    5918--REDEF    5918--REDEF
EO_OCB.TYPE
      5418**DCL      5419--REDEF
F$DCB.ACTPOS
      7028**DCL      7028--REDEF
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:62   
F$DCB.ARS
      7003**DCL      7003--REDEF    8691>>ASSIGN   8713>>ASSIGN   8863>>ASSIGN
F$DCB.ATTR
      7021**DCL      7022--REDEF
F$DCB.BORROW
      7036**DCL      7036--REDEF    7036--REDEF    7036--REDEF
F$DCB.DCBNAME.L
      7050**DCL      7050--IMP-SIZ
F$DCB.EOMCHAR
      7007**DCL      7007--REDEF
F$DCB.FLDID
      7031**DCL      7031--REDEF
F$DCB.FORM$
      7025**DCL      7025--REDEF
F$DCB.FSECT
      7041**DCL      7041--REDEF
F$DCB.FSN
      7018**DCL      7018--REDEF    7018--REDEF    7019--REDEF
F$DCB.HEADER$
      7024**DCL      7024--REDEF
F$DCB.IXTNSIZE
      7022**DCL      7022--REDEF
F$DCB.KEYL
      7020**DCL      8881>>ASSIGN   8882>>ASSIGN
F$DCB.LASTSTA$
      7012**DCL      7012--REDEF
F$DCB.LVL
      7037**DCL      7037--REDEF
F$DCB.NAME.C
      7012**DCL      7012--REDEF
F$DCB.NOEOF
      7033**DCL      7033--REDEF
F$DCB.NRECS
      7023**DCL      7023--REDEF
F$DCB.NRECX
      7042**DCL      7042--REDEF
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:63   
F$DCB.OHDR
      7034**DCL      7034--REDEF
F$DCB.ORG
      7017**DCL      7017--REDEF    8846>>IF       8879>>IF       8879>>IF
F$DCB.PRECNO
      7040**DCL      7040--REDEF
F$DCB.RCSZ
      7045**DCL      7045--REDEF
F$DCB.RES
      7013**DCL      7013--REDEF
F$DCB.SETX
      7025**DCL      7025--REDEF
F$DCB.TAB$
      7024**DCL      7025--REDEF
F$DCB.TDA
      7039**DCL      7039--REDEF
F$DCB.WSN
      7014**DCL      7014--REDEF
FPT_CLOSE_EI
      6759**DCL      8637<>CALL     8642<>CALL     8649<>CALL
FPT_CLOSE_EI.SN_
      6759**DCL      6759--REDEF
FPT_CLOSE_EI.UTL_
      6760**DCL      6760--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6774**DCL      6774--REDEF
FPT_CLOSE_EI.V.TYPE#
      6772**DCL      6772--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6769**DCL      6769--REDEF    6771--REDEF
FPT_CLOSE_PTL.SN_
      6885**DCL      6885--REDEF
FPT_CLOSE_PTL.UTL_
      6886**DCL      6886--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6900**DCL      6900--REDEF
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:64   
FPT_CLOSE_PTL.V.TYPE#
      6898**DCL      6898--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6895**DCL      6895--REDEF    6897--REDEF
FPT_CLOSE_READ.SN_
      6801**DCL      6801--REDEF
FPT_CLOSE_READ.UTL_
      6802**DCL      6802--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6816**DCL      6816--REDEF
FPT_CLOSE_READ.V.TYPE#
      6814**DCL      6814--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6811**DCL      6811--REDEF    6813--REDEF
FPT_CLOSE_SI.SN_
      6969**DCL      6969--REDEF
FPT_CLOSE_SI.UTL_
      6970**DCL      6970--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6984**DCL      6984--REDEF
FPT_CLOSE_SI.V.TYPE#
      6982**DCL      6982--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6979**DCL      6979--REDEF    6981--REDEF
FPT_CLOSE_STD.SN_
      6927**DCL      6927--REDEF
FPT_CLOSE_STD.UTL_
      6928**DCL      6928--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6942**DCL      6942--REDEF
FPT_CLOSE_STD.V.TYPE#
      6940**DCL      6940--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6937**DCL      6937--REDEF    6939--REDEF
FPT_CLSEI_FT.SN_
      6843**DCL      6843--REDEF
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:65   
FPT_CLSEI_FT.UTL_
      6844**DCL      6844--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6858**DCL      6858--REDEF
FPT_CLSEI_FT.V.TYPE#
      6856**DCL      6856--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6853**DCL      6853--REDEF    6855--REDEF
FPT_DELREC_EI IN PROCEDURE DELETE_RECORDS
      8836**DCL      8868<>CALL     8890<>CALL
FPT_DELREC_EI.KEY_ IN PROCEDURE DELETE_RECORDS
      8836**DCL      8853<<ASSIGN   8881<<ASSIGN   8885<<ASSIGN
FPT_DELREC_EI.LKEY_ IN PROCEDURE DELETE_RECORDS
      8838**DCL      8854<<ASSIGN   8882<<ASSIGN   8886<<ASSIGN   8889<<ASSIGN
FPT_DELREC_EI.V IN PROCEDURE DELETE_RECORDS
      8839**DCL      8836--DCLINIT
FPT_OPEN
      8255**DCL      8638<>CALL
FPT_OPEN.ACSVEH_
      8257**DCL      8258--REDEF
FPT_OPEN.ALTKEYS_
      8263**DCL      8264--REDEF    8264--REDEF
FPT_OPEN.HDR_
      8262**DCL      8263--REDEF
FPT_OPEN.TAB_
      8261**DCL      8262--REDEF
FPT_OPEN.UHL_
      8255**DCL      8256--REDEF    8256--REDEF
FPT_OPEN.V
      8264**DCL      8255--DCLINIT
FPT_OPEN.V.FSN#
      8295**DCL      8295--REDEF    8295--REDEF
FPT_OPEN.WSN_
      8261**DCL      8261--REDEF
FPT_OPEN_EI.ACSVEH_
      6414**DCL      6415--REDEF
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:66   
FPT_OPEN_EI.ALTKEYS_
      6420**DCL      6421--REDEF    6421--REDEF
FPT_OPEN_EI.HDR_
      6419**DCL      6420--REDEF
FPT_OPEN_EI.TAB_
      6418**DCL      6419--REDEF
FPT_OPEN_EI.UHL_
      6412**DCL      6413--REDEF    6413--REDEF
FPT_OPEN_EI.V.FSN#
      6452**DCL      6452--REDEF    6452--REDEF
FPT_OPEN_EI.WSN_
      6418**DCL      6418--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6523**DCL      6524--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6529**DCL      6530--REDEF    6530--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6528**DCL      6529--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6527**DCL      6528--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6521**DCL      6522--REDEF    6522--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6561**DCL      6561--REDEF    6561--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6527**DCL      6527--REDEF
FPT_OPEN_OUT.ACSVEH_
      6305**DCL      6306--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6311**DCL      6312--REDEF    6312--REDEF
FPT_OPEN_OUT.HDR_
      6310**DCL      6311--REDEF
FPT_OPEN_OUT.TAB_
      6309**DCL      6310--REDEF
FPT_OPEN_OUT.UHL_
      6303**DCL      6304--REDEF    6304--REDEF
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:67   
FPT_OPEN_OUT.V.FSN#
      6343**DCL      6343--REDEF    6343--REDEF
FPT_OPEN_OUT.WSN_
      6309**DCL      6309--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6196**DCL      6197--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6202**DCL      6203--REDEF    6203--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6201**DCL      6202--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6200**DCL      6201--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6194**DCL      6195--REDEF    6195--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6234**DCL      6234--REDEF    6234--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6200**DCL      6200--REDEF
FPT_PFIL_EI
      8310**DCL      8687<>CALL     8709<>CALL     8730<>CALL     8851<>CALL
FPT_PFIL_EI.V
      8310**DCL      8310--DCLINIT
FPT_PFIL_EI.V.BOF#
      8311**DCL      8680<<ASSIGN   8701<<ASSIGN   8706<<ASSIGN   8725<<ASSIGN   8850<<ASSIGN
FPT_PRECORD_EI
      8325**DCL      8688<>CALL     8710<>CALL     8731<>CALL     8860<>CALL
FPT_PRECORD_EI.KEY_
      8325**DCL      8681--ASSIGN   8683--ASSIGN   8697--ASSIGN   8698--ASSIGN   8728<<ASSIGN
FPT_PRECORD_EI.V
      8327**DCL      8325--DCLINIT
FPT_PRECORD_EI.V.KEYR#
      8328**DCL      8685<<ASSIGN   8726<<ASSIGN
FPT_PRECORD_EI.V.KEYS#
      8328**DCL      8684<<ASSIGN
FPT_PRECORD_EI.V.N#
      8331**DCL      8686<<ASSIGN   8691<<ASSIGN   8691>>ASSIGN   8702<<ASSIGN   8707<<ASSIGN   8713<<ASSIGN
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:68   
      8713>>ASSIGN   8729<<ASSIGN   8852<<ASSIGN   8863<<ASSIGN   8863>>ASSIGN   8876<<ASSIGN
FPT_READ_STD.STATION_
      6624**DCL      6625--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6636**DCL      6636--REDEF
FPT_READ_STD.V.INDX#
      6634**DCL      6634--REDEF
FPT_READ_UC.STATION_
      6585**DCL      6586--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6597**DCL      6597--REDEF
FPT_READ_UC.V.INDX#
      6595**DCL      6595--REDEF
FPT_WRITE_ME.STATION_
      6693**DCL      6693--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6700**DCL      6700--REDEF
FPT_WRITE_OUT.STATION_
      6724**DCL      6724--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6731**DCL      6731--REDEF
FPT_WRITE_UC.STATION_
      6662**DCL      6662--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6669**DCL      6669--REDEF
FROM_SN.SN
      5568**DCL      5569--REDEF
GETCMD.OUT$
      4775**DCL      4781--REDEF
I
      8593**DCL      8601<<DOINDEX  8602>>ASSIGN   8676<<DOINDEX  8677>>IF       8679>>ASSIGN   8682>>ASSIGN
      8686>>ASSIGN   8699>>IF       8707>>ASSIGN   8718>>ASSIGN   8723>>IF       8735>>ASSIGN   8741<<DOINDEX
      8742>>DOINDEX  8743>>IF       8743>>IF       8746>>ASSIGN   8747>>ASSIGN   8756<<DOINDEX  8757>>DOINDEX
      8758>>IF       8760>>ASSIGN   8761>>ASSIGN   8768<<DOINDEX  8769>>DOINDEX  8770>>IF       8771>>DOCASE
      8773>>ASSIGN   8775>>ASSIGN   8783>>ASSIGN   8787>>ASSIGN   8789>>ASSIGN   8799>>ASSIGN   8844<<DOINDEX
      8845>>ASSIGN   8852>>ASSIGN   8855>>IF       8858>>ASSIGN   8859>>DOINDEX  8870>>IF       8881>>ASSIGN
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:69   
      8881>>ASSIGN   8882>>ASSIGN   8882>>ASSIGN   8885>>ASSIGN   8885>>ASSIGN   8886>>ASSIGN   8886>>ASSIGN
      8888>>IF       8888>>IF       8888>>IF       8888>>IF
ICB.FID.STRING
      5592**DCL      5593--REDEF
ICB.FLAVOR.KNOWKEY
      5651**DCL      8674>>IF
ICB.REC_SEL.CNT
      5600**DCL      8673>>IF       8676>>DOINDEX  8740>>IF       8741>>DOINDEX  8742>>DOINDEX  8755>>IF
      8756>>DOINDEX  8757>>DOINDEX  8768>>DOINDEX  8844>>DOINDEX
ICB.REC_SEL.SPEC
      5601**DCL      8746>>ASSIGN   8747<<ASSIGN   8747>>ASSIGN   8748<<ASSIGN   8760>>ASSIGN   8761<<ASSIGN
      8761>>ASSIGN   8762<<ASSIGN
ICB.REC_SEL.SPEC.FINISH
      5606**DCL      8799<<ASSIGN   8799>>ASSIGN
ICB.REC_SEL.SPEC.FINISH.KEY$
      5607**DCL      8718<<ASSIGN   8723>>IF       8735<<ASSIGN   8789>>ASSIGN   8790>>ASSIGN   8882>>ASSIGN
      8882>>ASSIGN   8886>>ASSIGN   8886>>ASSIGN   8888>>IF       8888>>IF
ICB.REC_SEL.SPEC.FINISH.SEQ
      5608**DCL      8699>>IF       8707>>ASSIGN   8775>>ASSIGN   8776>>ASSIGN   8783<<ASSIGN   8783>>ASSIGN
      8855>>IF       8858>>ASSIGN   8870>>IF
ICB.REC_SEL.SPEC.START.KEY$
      5604**DCL      8682<<ASSIGN   8743>>IF       8743>>IF       8743>>IF       8743>>IF       8787>>ASSIGN
      8788>>ASSIGN   8881>>ASSIGN   8881>>ASSIGN   8885>>ASSIGN   8885>>ASSIGN   8888>>IF       8888>>IF
ICB.REC_SEL.SPEC.START.SEQ
      5605**DCL      8686>>ASSIGN   8758>>IF       8758>>IF       8773>>ASSIGN   8774>>ASSIGN   8852>>ASSIGN
      8859>>DOINDEX
ICB.REC_SEL.SPEC.TYPE
      5602**DCL      8677>>IF       8679<<ASSIGN   8770>>IF       8771>>DOCASE   8779<<ASSIGN   8784<<ASSIGN
      8793<<ASSIGN   8800<<ASSIGN   8845>>ASSIGN
ICB.SPEC_TYPE
      5589**DCL      8622>>IF
IFINISH IN PROCEDURE MUNGE_RANGES
      8663**DCL      8775<<ASSIGN   8777>>IF       8781>>IF       8781>>IF
IFINISH$ IN PROCEDURE MUNGE_RANGES
      8667**DCL      8789<<ASSIGN   8791>>IF       8791>>IF       8795>>IF       8795>>IF       8795>>IF
      8795>>IF
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:70   
IFSFA_PARAM.EOMCHAR#
      5947**DCL      5948--REDEF
IFSFA_PARAM.SIG1
      5941**DCL      5941--REDEF
IFSFA_PARAM.SIG2
      5941**DCL      5942--REDEF
IN_RES
      5514**DCL      5514--REDEF
IN_SN.SN
      5530**DCL      5531--REDEF
ISTART IN PROCEDURE MUNGE_RANGES
      8661**DCL      8773<<ASSIGN   8777>>IF       8781>>IF
ISTART$ IN PROCEDURE MUNGE_RANGES
      8665**DCL      8787<<ASSIGN   8791>>IF       8791>>IF       8795>>IF       8795>>IF
J
      8594**DCL      8742<<DOINDEX  8743>>IF       8743>>IF       8747>>ASSIGN   8748>>ASSIGN   8757<<DOINDEX
      8758>>IF       8761>>ASSIGN   8762>>ASSIGN   8769<<DOINDEX  8774>>ASSIGN   8776>>ASSIGN   8779>>ASSIGN
      8783>>ASSIGN   8784>>ASSIGN   8788>>ASSIGN   8790>>ASSIGN   8793>>ASSIGN   8799>>ASSIGN   8800>>ASSIGN
      8859<<DOINDEX
JFINISH IN PROCEDURE MUNGE_RANGES
      8664**DCL      8776<<ASSIGN   8777>>IF       8781>>IF
JFINISH$ IN PROCEDURE MUNGE_RANGES
      8668**DCL      8790<<ASSIGN   8791>>IF       8791>>IF       8795>>IF       8795>>IF
JSTART IN PROCEDURE MUNGE_RANGES
      8662**DCL      8774<<ASSIGN   8777>>IF       8781>>IF       8781>>IF
JSTART$ IN PROCEDURE MUNGE_RANGES
      8666**DCL      8788<<ASSIGN   8791>>IF       8791>>IF       8795>>IF       8795>>IF       8795>>IF
      8795>>IF
KEY_AREA$
      5919**DCL      8681>>ASSIGN   8682>>ASSIGN   8696<<ASSIGN   8696>>ASSIGN   8696>>ASSIGN   8697>>ASSIGN
      8718>>ASSIGN   8719<<ASSIGN   8719>>ASSIGN   8719>>ASSIGN   8727>>ASSIGN   8728>>ASSIGN   8728>>ASSIGN
      8735>>ASSIGN   8736<<ASSIGN   8736>>ASSIGN   8736>>ASSIGN
M$CLOSE
        32**DCL-ENT  8637--CALL     8642--CALL     8649--CALL
M$DELREC
        34**DCL-ENT  8868--CALL     8890--CALL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:71   
M$EI#
      5983**DCL      8639<>CALL     8694<>CALL     8716<>CALL     8733<>CALL     8866<>CALL     8874<>CALL
      8893<>CALL
M$EI$
      5983**DCL      8691>>ASSIGN   8713>>ASSIGN   8846>>IF       8863>>ASSIGN   8879>>IF       8879>>IF
      8881>>ASSIGN   8882>>ASSIGN
M$OPEN
        32**DCL-ENT  8638--CALL
M$PFIL
        34**DCL-ENT  8687--CALL     8709--CALL     8730--CALL     8851--CALL
M$PRECORD
        36**DCL-ENT  8688--CALL     8710--CALL     8731--CALL     8860--CALL
MUNGE_RANGES
      8650**PROC     8629--CALL
NEXT_SPEC_RET_VAL
      8596**DCL      8611<>CALL     8612>>DOWHILE  8613>>IF       8646<>CALL
OCB.TYPE
      5276**DCL      5277--REDEF
OFSFA_PARAM.EOMCHAR#
      5977**DCL      5978--REDEF
OFSFA_PARAM.SIG1
      5971**DCL      5971--REDEF
OFSFA_PARAM.SIG2
      5971**DCL      5972--REDEF
OPEN_NEXT_RET_VAL
      8597**DCL      8615<>CALL     8616>>IF       8628>>DOWHILE  8643<>CALL
OUT$BLK.CODE
      8349**DCL      8603>>DOCASE
OUT$BLK.NSUBLKS
      8353**DCL      8601>>DOINDEX
OUT$BLK.SUBLK$
      8374**DCL      8602>>ASSIGN   8607<>CALL
OUT_SN.SN
      5548**DCL      5549--REDEF
P$
      8592**DCL      8602<<ASSIGN   8603>>DOCASE   8605>>ASSIGN   8607>>CALL
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:72   
PCB.OUT$
      4589**DCL      8601>>DOINDEX  8602>>ASSIGN
PREC1 IN PROCEDURE MUNGE_RANGES
      8688**LABEL    8692--GOTO
PREC2 IN PROCEDURE MUNGE_RANGES
      8710**LABEL    8714--GOTO
PREC3 IN PROCEDURE DELETE_RECORDS
      8860**LABEL    8864--GOTO
RANGE_END IN PROCEDURE DELETE_RECORDS
      8824**DCL      8856<<ASSIGN   8858<<ASSIGN   8859>>DOINDEX
SOURCELIST$
      8595**DCL      8600<<ASSIGN   8605<<ASSIGN   8611<>CALL
SPEC_BUF
      5226**DCL      5226--REDEF
TEXT$C
      8589**DCL      8728--ASSIGN   8885--ASSIGN   8886--ASSIGN
TEXT$C.LEN
      8590**DCL      8591--IMP-SIZ  8696>>ASSIGN   8719>>ASSIGN   8727<<ASSIGN   8728>>ASSIGN   8736>>ASSIGN
      8743>>IF       8743>>IF       8791>>IF       8791>>IF       8791>>IF       8791>>IF       8795>>IF
      8795>>IF       8795>>IF       8795>>IF       8795>>IF       8795>>IF       8881>>ASSIGN   8882>>ASSIGN
      8885>>ASSIGN   8886>>ASSIGN   8888>>IF       8888>>IF
TEXT$C.STRING
      8591**DCL      8743>>IF       8743>>IF       8791>>IF       8791>>IF       8791>>IF       8791>>IF
      8795>>IF       8795>>IF       8795>>IF       8795>>IF       8795>>IF       8795>>IF       8881--ASSIGN
      8882--ASSIGN   8888>>IF       8888>>IF
TYPE_FLAG IN PROCEDURE DELETE_RECORDS
      8823**DCL      8845<<ASSIGN   8847<<ASSIGN   8848>>DOCASE
T_SPEC IN PROCEDURE MUNGE_RANGES
      8659**DCL      8746<<ASSIGN   8748>>ASSIGN   8760<<ASSIGN   8762>>ASSIGN
VPF$GET_NEXT_SPEC
      8492**DCL-ENT  8611--CALL     8646--CALL
VPF$OPEN_NEXT
      8495**DCL-ENT  8615--CALL     8643--CALL
VPF$SET_FROM_INFO
      8501**DCL-ENT  8607--CALL
VPL$ERR_PROC
PL6.E3A0      #001=VPK$DELREC File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:50 Page:73   
      8563**DCL-ENT  8617--CALL     8623--CALL     8631--CALL     8639--CALL     8694--CALL     8716--CALL
      8733--CALL     8866--CALL     8874--CALL     8893--CALL

PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:74   
      320        1        /*T***********************************************************/
      321        2        /*T*                                                         */
      322        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      323        4        /*T*                                                         */
      324        5        /*T***********************************************************/
      325        6        VPK$LINK: PROC;
      326        7        /*D* NAME: VPK$LINK
      327        8             CALL: CALL VPK$LINK
      328        9             DESCRIPTION: This proc drives PCL's LINK command.
      329       10        */
      330       11        %INCLUDE VP_DATA_R;
      331     6998 S      %INCLUDE B$JIT_C;
      332     6999        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      333     7044        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      334     7082    1   DCL 1 CC_BUF STATIC,
      335     7083    1         2 COUNT UBIN(9) UNAL,
      336     7084    1         2 TEXT CHAR(120) UNAL;
      337     7085        %FPT_FID(FPTN = FPT_FID,
      338     7086                 ASN = RETURN_ASN,
      339     7087                 SN = RETURN_SN,
      340     7088                 ACCT = RETURN_ACCT,
      341     7089                 NAME = RETURN_NAME,
      342     7090                 PASS = RETURN_PASS,
      343     7091                 RES = RETURN_RES,
      344     7092                 WSN = RETURN_TRASH,
      345     7093                 TEXTFID = FID_BUF,
      346     7094                 RESULTS = RESULTS);
      347     7117        %VLR_FID(FPTN = RESULTS);
      348     7136        %B$JIT0;
      349     7225        %U$JIT1;
      350     7299    1           2 * BIT(1);                     /* Rest of JIT not needed             */
      351     7300        /**/
      352     7301        /*  ENTRY DCLS  */
      353     7302        /**/
      354     7303        %VP_ENTRIES (OMIT=VPK$LINK);
      355     7511    1   DCL FID_BUF CHAR(33) STATIC;
      356     7512        %FPT_LINK(FPTN = FPT_LINK,
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:75   
      357     7513                  NAME = RETURN_NAME,
      358     7514                  ACCT = RETURN_ACCT);
      359     7532    1   DCL RETURN_ASN UBIN(9) STATIC;
      360     7533        %VLP_SN(FPTN = RETURN_SN, STCLASS = STATIC);
      361     7546        %VLP_NAME(FPTN = RETURN_NAME, STCLASS = STATIC);
      362     7573    1   DCL RETURN_ACCT CHAR(8) STATIC;
      363     7574    1   DCL RETURN_PASS CHAR(8) STATIC;
      364     7575    1   DCL RETURN_RES CHAR(4) STATIC;
      365     7576        %VLP_NAME(FPTN = RETURN_TRASH, STCLASS = STATIC);
      366     7603    1           FID_BUF = PCB.OUT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      367     7604    1           CALL VPD$FID (FPT_FID);
      368     7605    1           IF RESULTS.PASS
      369     7606    1            THEN
      370     7607    1              FPT_LINK.PASS_ = VECTOR(RETURN_PASS);
      371     7608    1            ELSE
      372     7609    1              FPT_LINK.PASS_ = VECTOR(NIL);
      373     7610    1           IF ~RESULTS.ACCT
      374     7611    1            THEN
      375     7612    1              RETURN_ACCT = ':SYS';
      376     7613    1           IF RESULTS.SN
      377     7614    1            THEN
      378     7615    1              FPT_LINK.PSID_ = VECTOR(RETURN_SN.SN#(0));
      379     7616    1            ELSE
      380     7617    1              FPT_LINK.PSID_ = VECTOR(NIL);
      381     7618    1           IF PCB.OUT$->OUT$BLK.NSUBLKS = 2
      382     7619    1            THEN
      383     7620    2            DO;
      384     7621    2               CC_BUF.TEXT = PCB.OUT$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;
      385     7622    2               CC_BUF.COUNT = PCB.OUT$->OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT;
      386     7623    2               FPT_LINK.CMD_ = VECTOR(CC_BUF);
      387     7624    2               END;
      388     7625    1            ELSE
      389     7626    1              FPT_LINK.CMD_ = VECTOR(NIL);
      390     7627    1           CALL M$LINK (FPT_LINK) ALTRET (LINK_ALT);
      391     7628    1           RETURN;
      392     7629
      393     7630    1   LINK_ALT:
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:76   
      394     7631    1           IF (B$JIT$ -> B$JIT.CPFLAGS1 & %CP_EXIT#)
      395     7632    1            THEN                           /* LINK target exited 'normally'      */
      396     7633    1              CALL VPL$ERR_NO_PRINT(0,0);  /* Set up for '?'                     */
      397     7634    1            ELSE                           /* LINK target ALTRETURNed to PCL     */
      398     7635    1              CALL VPL$ERR_PROC(3,0);      /* Gripe bitterly                     */
      399     7636    1           RETURN;
      400     7637
      401     7638    1   END VPK$LINK;
      402     7639        %EOD;

PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:77   
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$LINK.

   Procedure VPK$LINK requires 77 words for executable code.
   Procedure VPK$LINK requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:78   

 Object Unit name= VPK$LINK                                   File name= VPK$CMDS.:E05TOU
 UTS= JUL 30 '97 07:53:31.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none   119    167  VPK$LINK
   11  RoData even  UTS      2      2  VPK$LINK
   12   Proc  even  none    77    115  VPK$LINK
   13  RoData even  none    14     16  VPK$LINK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        0  VPK$LINK
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:79   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 VPD$FID
         yes           Std       8 VPL$ERR_NO_PRINT
         yes           Std       8 VPL$ERR_PROC
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PCB                                   BREAK_LOC
     BREAK_MESSAGE_REPORTER                SPEC_BUF                              IN_RES
     M$EI                                  M$EO                                  M$EO1
     M$ME                                  M$SI                                  M$READFILE
     M$DO                                  M$STD1                                M$SORT1
     B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:80   


      320        1        /*T***********************************************************/
      321        2        /*T*                                                         */
      322        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      323        4        /*T*                                                         */
      324        5        /*T***********************************************************/
      325        6        VPK$LINK: PROC;

      6 12 000000   000000 700200 xent  VPK$LINK     TSX0  ! X66_AUTO_0
        12 000001   000004 000000                    ZERO    4,0

      326        7        /*D* NAME: VPK$LINK
      327        8             CALL: CALL VPK$LINK
      328        9             DESCRIPTION: This proc drives PCL's LINK command.
      329       10        */
      330       11        %INCLUDE VP_DATA_R;
      331     6998 S      %INCLUDE B$JIT_C;
      332     6999        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      333     7044        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      334     7082    1   DCL 1 CC_BUF STATIC,
      335     7083    1         2 COUNT UBIN(9) UNAL,
      336     7084    1         2 TEXT CHAR(120) UNAL;
      337     7085        %FPT_FID(FPTN = FPT_FID,
      338     7086                 ASN = RETURN_ASN,
      339     7087                 SN = RETURN_SN,
      340     7088                 ACCT = RETURN_ACCT,
      341     7089                 NAME = RETURN_NAME,
      342     7090                 PASS = RETURN_PASS,
      343     7091                 RES = RETURN_RES,
      344     7092                 WSN = RETURN_TRASH,
      345     7093                 TEXTFID = FID_BUF,
      346     7094                 RESULTS = RESULTS);
      347     7117        %VLR_FID(FPTN = RESULTS);
      348     7136        %B$JIT0;
      349     7225        %U$JIT1;
      350     7299    1           2 * BIT(1);                     /* Rest of JIT not needed             */
      351     7300        /**/
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:81   
      352     7301        /*  ENTRY DCLS  */
      353     7302        /**/
      354     7303        %VP_ENTRIES (OMIT=VPK$LINK);
      355     7511    1   DCL FID_BUF CHAR(33) STATIC;
      356     7512        %FPT_LINK(FPTN = FPT_LINK,
      357     7513                  NAME = RETURN_NAME,
      358     7514                  ACCT = RETURN_ACCT);
      359     7532    1   DCL RETURN_ASN UBIN(9) STATIC;
      360     7533        %VLP_SN(FPTN = RETURN_SN, STCLASS = STATIC);
      361     7546        %VLP_NAME(FPTN = RETURN_NAME, STCLASS = STATIC);
      362     7573    1   DCL RETURN_ACCT CHAR(8) STATIC;
      363     7574    1   DCL RETURN_PASS CHAR(8) STATIC;
      364     7575    1   DCL RETURN_RES CHAR(4) STATIC;
      365     7576        %VLP_NAME(FPTN = RETURN_TRASH, STCLASS = STATIC);
      366     7603    1           FID_BUF = PCB.OUT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

   7603 12 000002   000003 470400 xsym               LDP0    PCB+3
        12 000003   000003 471500                    LDP1    3,,PR0
        12 000004   100004 236100                    LDQ     4,,PR1
        12 000005   000033 772000                    QRL     27
        12 000006   000000 620006                    EAX0    0,QL
        12 000007   040000 100540                    MLR     fill='040'O
        12 000010   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        12 000011   000102 000041 10                 ADSC9   FID_BUF                  cn=0,n=33

      367     7604    1           CALL VPD$FID (FPT_FID);

   7604 12 000012   000000 630400 13                 EPPR0   0
        12 000013   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000014   000000 701000 xent               TSX1    VPD$FID
        12 000015   000000 011000                    NOP     0

      368     7605    1           IF RESULTS.PASS

   7605 12 000016   000070 236000 10                 LDQ     RESULTS
        12 000017   100000 316003                    CANQ    32768,DU
        12 000020   000024 600000 12                 TZE     s:7609
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:82   

      369     7606    1            THEN
      370     7607    1              FPT_LINK.PASS_ = VECTOR(RETURN_PASS);

   7607 12 000021   000002 237000 13                 LDAQ    2
        12 000022   000120 757000 10                 STAQ    FPT_LINK+4
        12 000023   000026 710000 12                 TRA     s:7610

      371     7608    1            ELSE
      372     7609    1              FPT_LINK.PASS_ = VECTOR(NIL);

   7609 12 000024   000004 237000 13                 LDAQ    4
        12 000025   000120 757000 10                 STAQ    FPT_LINK+4

      373     7610    1           IF ~RESULTS.ACCT

   7610 12 000026   000070 236000 10                 LDQ     RESULTS
        12 000027   000001 736000                    QLS     1
        12 000030   400000 376003                    ANQ     -131072,DU
        12 000031   400000 676003                    ERQ     -131072,DU
        12 000032   000037 600000 12                 TZE     s:7613

      374     7611    1            THEN
      375     7612    1              RETURN_ACCT = ':SYS';

   7612 12 000033   000000 236000 11                 LDQ     0
        12 000034   000044 737000                    LLS     36
        12 000035   000035 236000 xsym               LDQ     B_VECTNIL+29
        12 000036   000152 757000 10                 STAQ    RETURN_ACCT

      376     7613    1           IF RESULTS.SN

   7613 12 000037   000070 236000 10                 LDQ     RESULTS
        12 000040   040000 316003                    CANQ    16384,DU
        12 000041   000045 600000 12                 TZE     s:7617

      377     7614    1            THEN
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:83   
      378     7615    1              FPT_LINK.PSID_ = VECTOR(RETURN_SN.SN#(0));

   7615 12 000042   000006 237000 13                 LDAQ    6
        12 000043   000122 757000 10                 STAQ    FPT_LINK+6
        12 000044   000047 710000 12                 TRA     s:7618

      379     7616    1            ELSE
      380     7617    1              FPT_LINK.PSID_ = VECTOR(NIL);

   7617 12 000045   000004 237000 13                 LDAQ    4
        12 000046   000122 757000 10                 STAQ    FPT_LINK+6

      381     7618    1           IF PCB.OUT$->OUT$BLK.NSUBLKS = 2

   7618 12 000047   000003 470400 xsym               LDP0    PCB+3
        12 000050   000001 220100                    LDX0    1,,PR0
        12 000051   000002 100003                    CMPX0   2,DU
        12 000052   000070 601000 12                 TNZ     s:7626

      382     7619    1            THEN
      383     7620    2            DO;

      384     7621    2               CC_BUF.TEXT = PCB.OUT$->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT;

   7621 12 000053   000004 471500                    LDP1    4,,PR0
        12 000054   100004 236100                    LDQ     4,,PR1
        12 000055   000033 772000                    QRL     27
        12 000056   000000 621006                    EAX1    0,QL
        12 000057   040000 100540                    MLR     fill='040'O
        12 000060   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        12 000061   000000 200170 10                 ADSC9   CC_BUF                   cn=1,n=120

      385     7622    2               CC_BUF.COUNT = PCB.OUT$->OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT;

   7622 12 000062   000004 471500                    LDP1    4,,PR0
        12 000063   100004 236100                    LDQ     4,,PR1
        12 000064   000000 552040 10                 STBQ    CC_BUF,'40'O
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:84   

      386     7623    2               FPT_LINK.CMD_ = VECTOR(CC_BUF);

   7623 12 000065   000010 237000 13                 LDAQ    8
        12 000066   000124 757000 10                 STAQ    FPT_LINK+8

      387     7624    2               END;

   7624 12 000067   000072 710000 12                 TRA     s:7627

      388     7625    1            ELSE
      389     7626    1              FPT_LINK.CMD_ = VECTOR(NIL);

   7626 12 000070   000004 237000 13                 LDAQ    4
        12 000071   000124 757000 10                 STAQ    FPT_LINK+8

      390     7627    1           CALL M$LINK (FPT_LINK) ALTRET (LINK_ALT);

   7627 12 000072   000114 630400 10                 EPPR0   FPT_LINK
        12 000073   400005 713400                    CLIMB   alt,+5
        12 000074   403000 401760                    pmme    nvectors=7
        12 000075   000077 702000 12                 TSX2    LINK_ALT

      391     7628    1           RETURN;

   7628 12 000076   000000 702200 xent               TSX2  ! X66_ARET

      392     7629
      393     7630    1   LINK_ALT:
      394     7631    1           IF (B$JIT$ -> B$JIT.CPFLAGS1 & %CP_EXIT#)

   7631 12 000077   000000 470400 xsym  LINK_ALT     LDP0    B$JIT$
        12 000100   000143 236100                    LDQ     99,,PR0
        12 000101   000001 376000 11                 ANQ     1
        12 000102   000110 600000 12                 TZE     s:7635

      395     7632    1            THEN                           /* LINK target exited 'normally'      */
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:85   
      396     7633    1              CALL VPL$ERR_NO_PRINT(0,0);  /* Set up for '?'                     */

   7633 12 000103   000012 630400 13                 EPPR0   10
        12 000104   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000105   000000 701000 xent               TSX1    VPL$ERR_NO_PRINT
        12 000106   000000 011000                    NOP     0
        12 000107   000114 710000 12                 TRA     s:7636

      397     7634    1            ELSE                           /* LINK target ALTRETURNed to PCL     */
      398     7635    1              CALL VPL$ERR_PROC(3,0);      /* Gripe bitterly                     */

   7635 12 000110   000014 630400 13                 EPPR0   12
        12 000111   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000112   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000113   000000 011000                    NOP     0

      399     7636    1           RETURN;

   7636 12 000114   000000 702200 xent               TSX2  ! X66_ARET
      400     7637
      401     7638    1   END VPK$LINK;
      402     7639        %EOD;

PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:86   
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$LINK.
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:87   

 **** Variables and constants ****

  ****  Section 010  Data  VPK$LINK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(1089)  r     1 CC_BUF                   102-0-0/c CHAR(33)    r     1 FID_BUF
    40-0-0/d STRC(864)   r     1 FPT_FID                  114-0-0/d STRC(576)   r     1 FPT_LINK
    70-0-0/d STRC(324)   r     1 RESULTS                  152-0-0/c CHAR(8)     r     1 RETURN_ACCT
   134-0-0/w UBIN(9)     r     1 RETURN_ASN               142-0-0/c STRC(288)   r     1 RETURN_NAME
   154-0-0/c CHAR(8)     r     1 RETURN_PASS              156-0-0/c CHAR(4)     r     1 RETURN_RES
   136-0-0/d STRC(90)    r     1 RETURN_SN                157-0-0/c STRC(288)   r     1 RETURN_TRASH

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/w STRC(504)   r     1 PCB

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4537)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure VPK$LINK requires 77 words for executable code.
   Procedure VPK$LINK requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:88   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:89   
          MINI XREF LISTING

B$JIT.CPFLAGS1
      7231**DCL      7631>>IF
B$JIT.CPFLAGS1.SLEAZE
      7236**DCL      7236--REDEF
B$JIT.ERR.MID
      7143**DCL      7143--REDEF
B$JIT$
      5983**DCL      7137--IMP-PTR  7631>>IF
BREAK_LOC
      5218**DCL      5218--REDEF
CC_BUF
      7082**DCL      7623--ASSIGN
CC_BUF.COUNT
      7083**DCL      7622<<ASSIGN
CC_BUF.TEXT
      7084**DCL      7621<<ASSIGN
DEF_ICB.FID.STRING
      5816**DCL      5817--REDEF
DEV_ICB.FID.STRING
      5702**DCL      5703--REDEF
EI_KEY.KEY
      5914**DCL      5914--REDEF    5914--REDEF    5914--REDEF
EO_OCB.TYPE
      5414**DCL      5415--REDEF
FID_BUF
      7511**DCL      7105--DCLINIT  7603<<ASSIGN
FPT_CLOSE_EI.SN_
      6755**DCL      6755--REDEF
FPT_CLOSE_EI.UTL_
      6756**DCL      6756--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6770**DCL      6770--REDEF
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:90   
FPT_CLOSE_EI.V.TYPE#
      6768**DCL      6768--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6765**DCL      6765--REDEF    6767--REDEF
FPT_CLOSE_PTL.SN_
      6881**DCL      6881--REDEF
FPT_CLOSE_PTL.UTL_
      6882**DCL      6882--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6896**DCL      6896--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6894**DCL      6894--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6891**DCL      6891--REDEF    6893--REDEF
FPT_CLOSE_READ.SN_
      6797**DCL      6797--REDEF
FPT_CLOSE_READ.UTL_
      6798**DCL      6798--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6812**DCL      6812--REDEF
FPT_CLOSE_READ.V.TYPE#
      6810**DCL      6810--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6807**DCL      6807--REDEF    6809--REDEF
FPT_CLOSE_SI.SN_
      6965**DCL      6965--REDEF
FPT_CLOSE_SI.UTL_
      6966**DCL      6966--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6980**DCL      6980--REDEF
FPT_CLOSE_SI.V.TYPE#
      6978**DCL      6978--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6975**DCL      6975--REDEF    6977--REDEF
FPT_CLOSE_STD.SN_
      6923**DCL      6923--REDEF
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:91   
FPT_CLOSE_STD.UTL_
      6924**DCL      6924--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6938**DCL      6938--REDEF
FPT_CLOSE_STD.V.TYPE#
      6936**DCL      6936--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6933**DCL      6933--REDEF    6935--REDEF
FPT_CLSEI_FT.SN_
      6839**DCL      6839--REDEF
FPT_CLSEI_FT.UTL_
      6840**DCL      6840--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6854**DCL      6854--REDEF
FPT_CLSEI_FT.V.TYPE#
      6852**DCL      6852--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6849**DCL      6849--REDEF    6851--REDEF
FPT_FID
      7105**DCL      7604<>CALL
FPT_FID.V
      7109**DCL      7105--DCLINIT
FPT_LINK
      7527**DCL      7627<>CALL
FPT_LINK.CMD_
      7528**DCL      7623<<ASSIGN   7626<<ASSIGN
FPT_LINK.PASS_
      7527**DCL      7607<<ASSIGN   7609<<ASSIGN
FPT_LINK.PSID_
      7528**DCL      7615<<ASSIGN   7617<<ASSIGN
FPT_LINK.V
      7529**DCL      7529--DCLINIT
FPT_OPEN_EI.ACSVEH_
      6410**DCL      6411--REDEF
FPT_OPEN_EI.ALTKEYS_
      6416**DCL      6417--REDEF    6417--REDEF
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:92   
FPT_OPEN_EI.HDR_
      6415**DCL      6416--REDEF
FPT_OPEN_EI.TAB_
      6414**DCL      6415--REDEF
FPT_OPEN_EI.UHL_
      6408**DCL      6409--REDEF    6409--REDEF
FPT_OPEN_EI.V.FSN#
      6448**DCL      6448--REDEF    6448--REDEF
FPT_OPEN_EI.WSN_
      6414**DCL      6414--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6519**DCL      6520--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6525**DCL      6526--REDEF    6526--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6524**DCL      6525--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6523**DCL      6524--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6517**DCL      6518--REDEF    6518--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6557**DCL      6557--REDEF    6557--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6523**DCL      6523--REDEF
FPT_OPEN_OUT.ACSVEH_
      6301**DCL      6302--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6307**DCL      6308--REDEF    6308--REDEF
FPT_OPEN_OUT.HDR_
      6306**DCL      6307--REDEF
FPT_OPEN_OUT.TAB_
      6305**DCL      6306--REDEF
FPT_OPEN_OUT.UHL_
      6299**DCL      6300--REDEF    6300--REDEF
FPT_OPEN_OUT.V.FSN#
      6339**DCL      6339--REDEF    6339--REDEF
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:93   
FPT_OPEN_OUT.WSN_
      6305**DCL      6305--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6192**DCL      6193--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6198**DCL      6199--REDEF    6199--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6197**DCL      6198--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6196**DCL      6197--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6190**DCL      6191--REDEF    6191--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6230**DCL      6230--REDEF    6230--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6196**DCL      6196--REDEF
FPT_READ_STD.STATION_
      6620**DCL      6621--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6632**DCL      6632--REDEF
FPT_READ_STD.V.INDX#
      6630**DCL      6630--REDEF
FPT_READ_UC.STATION_
      6581**DCL      6582--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6593**DCL      6593--REDEF
FPT_READ_UC.V.INDX#
      6591**DCL      6591--REDEF
FPT_WRITE_ME.STATION_
      6689**DCL      6689--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6696**DCL      6696--REDEF
FPT_WRITE_OUT.STATION_
      6720**DCL      6720--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6727**DCL      6727--REDEF
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:94   
FPT_WRITE_UC.STATION_
      6658**DCL      6658--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6665**DCL      6665--REDEF
FROM_SN.SN
      5564**DCL      5565--REDEF
GETCMD.OUT$
      4771**DCL      4777--REDEF
ICB.FID.STRING
      5588**DCL      5589--REDEF
IFSFA_PARAM.EOMCHAR#
      5943**DCL      5944--REDEF
IFSFA_PARAM.SIG1
      5937**DCL      5937--REDEF
IFSFA_PARAM.SIG2
      5937**DCL      5938--REDEF
IN_RES
      5510**DCL      5510--REDEF
IN_SN.SN
      5526**DCL      5527--REDEF
LINK_ALT
      7631**LABEL    7627--CALLALT
M$LINK
        40**DCL-ENT  7627--CALL
OCB.TYPE
      5272**DCL      5273--REDEF
OFSFA_PARAM.EOMCHAR#
      5973**DCL      5974--REDEF
OFSFA_PARAM.SIG1
      5967**DCL      5967--REDEF
OFSFA_PARAM.SIG2
      5967**DCL      5968--REDEF
OUT$BLK.NSUBLKS
      7017**DCL      7618>>IF
OUT$BLK.SUBLK$
      7038**DCL      7603>>ASSIGN   7603>>ASSIGN   7621>>ASSIGN   7621>>ASSIGN   7622>>ASSIGN
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:95   
OUT$SYM.COUNT
      7074**DCL      7077--IMP-SIZ  7603>>ASSIGN   7621>>ASSIGN   7622>>ASSIGN
OUT$SYM.TEXT
      7077**DCL      7603>>ASSIGN   7621>>ASSIGN
OUT_SN.SN
      5544**DCL      5545--REDEF
PCB.OUT$
      4585**DCL      7603>>ASSIGN   7603>>ASSIGN   7618>>IF       7621>>ASSIGN   7621>>ASSIGN   7622>>ASSIGN
RESULTS
      7128**DCL      7109--DCLINIT
RESULTS.ACCT
      7128**DCL      7610>>IF
RESULTS.PASS
      7128**DCL      7605>>IF
RESULTS.SN
      7128**DCL      7613>>IF
RETURN_ACCT
      7573**DCL      7106--DCLINIT  7527--DCLINIT  7612<<ASSIGN
RETURN_ASN
      7532**DCL      7108--DCLINIT
RETURN_NAME
      7571**DCL      7106--DCLINIT  7527--DCLINIT
RETURN_PASS
      7574**DCL      7107--DCLINIT  7607--ASSIGN
RETURN_RES
      7575**DCL      7108--DCLINIT
RETURN_SN
      7544**DCL      7107--DCLINIT
RETURN_SN.SN#
      7544**DCL      7615--ASSIGN
RETURN_TRASH
      7601**DCL      7107--DCLINIT
SPEC_BUF
      5222**DCL      5222--REDEF
VPD$FID
      7343**DCL-ENT  7604--CALL
PL6.E3A0      #002=VPK$LINK File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:53 Page:96   
VPL$ERR_NO_PRINT
      7484**DCL-ENT  7633--CALL
VPL$ERR_PROC
      7485**DCL-ENT  7635--CALL

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:97   
      403        1        /*T***********************************************************/
      404        2        /*T*                                                         */
      405        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      406        4        /*T*                                                         */
      407        5        /*T***********************************************************/
      408        6        VPK$MODIFY: PROC;
      409        7        /*D* NAME: VPK$MODIFY
      410        8             CALL: CALL VPK$MODIFY
      411        9             DESCRIPTION: This proc drives the MODIFY command.
      412       10        */
      413       11        %INCLUDE VP_DATA_R;
      414     6998        %INCLUDE F$DCB;
      415     7047        %INCLUDE B_ERRORS_C;
      416     8174        %B$TCB;
      417     8177        %B$ALT;
      418     8185        /**/
      419     8186        /*  CONSTANT  */
      420     8187        /**/
      421     8188        %FPT_OPEN(DCB = M$EI,
      422     8189                  FUN = UPDATE,
      423     8190                  STCLASS = STATIC);
      424     8299        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      425     8344        /**/
      426     8345        /*  ENTRY DCLS  */
      427     8346        /**/
      428     8347        %VP_ENTRIES (OMIT=VPK$MODIFY);
      429     8555        %INCLUDE XUG_ENTRY;
      430     8586        /**/
      431     8587        /*  LOCAL AUTO  */
      432     8588        /**/
      433     8589    1   DCL OPERAND SBIN WORD;
      434     8590    1   DCL OPERANDS$ PTR;
      435     8591    1   DCL BLOCKI SBIN WORD;
      436     8592    1   DCL NEXT_SPEC_RET_VAL SBIN WORD;
      437     8593    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
      438     8594        %EJECT;
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:98   
      439     8595        /**/
      440     8596        /*  Find out what's on the command line  */
      441     8597        /**/
      442     8598    2           DO BLOCKI = 0 TO PCB.OUT$ -> OUT$BLK.NSUBLKS-1;
      443     8599    3              DO CASE(PCB.OUT$ -> OUT$BLK.SUBLK$(BLOCKI) -> OUT$BLK.CODE);
      444     8600    3               CASE(3);                    /* 'FROM' INFO                        */
      445     8601    3                 CALL VPF$SET_FROM_INFO(PCB.OUT$ ->
      446     8602    3                   OUT$BLK.SUBLK$(BLOCKI) -> OUT$BLK.SUBLK$(0));
      447     8603    3               CASE(1);                    /* MOD PARAMETERS                     */
      448     8604    3                 OPERANDS$ = PCB.OUT$ -> OUT$BLK.SUBLK$(BLOCKI);
      449     8605    3               END;
      450     8606    2              END;
      451     8607        /**/
      452     8608        /*  Assorted setup.  */
      453     8609        /**/
      454     8610    1           REMEMBER NEXT_FILE IN ABORT_STEP;
      455     8611    1           REMEMBER END_MOD IN BREAK_LOC;
      456     8612        %EJECT;
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:99   
      457     8613        /**/
      458     8614        /*  MOD the operands, one set at a time.  */
      459     8615        /**/
      460     8616    2           DO OPERAND=0 TO OPERANDS$->OUT$BLK.NSUBLKS-1;
      461     8617    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,
      462     8618    2                OPERANDS$->OUT$BLK.SUBLK$(OPERAND)->OUT$BLK.SUBLK$(0));
      463     8619    3              DO WHILE(NEXT_SPEC_RET_VAL~=1);
      464     8620    3                 IF NEXT_SPEC_RET_VAL=0
      465     8621    3                  THEN
      466     8622    4                  DO;
      467     8623    4                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,4);
      468     8624    4                     IF OPEN_NEXT_RET_VAL = %VPOC_EXHAUSTED#
      469     8625    4                      THEN
      470     8626    4                        CALL VPL$ERR_PROC(1,90,'13'O);
      471     8627        /*E*   ERROR:VPK-00090
      472     8628               MESSAGE: Nothing to modify.
      473     8629              MESSAGE1: No files were acceptable to MODIFY/RENAME in that input spec
      474     8630        */
      475     8631    5                     DO WHILE(OPEN_NEXT_RET_VAL~=%VPOC_EXHAUSTED#);
      476     8632    5                        CALL VPC$SETMOD(OPERANDS$ -> OUT$BLK.SUBLK$(OPERAND) ->
      477     8633    5                          OUT$BLK.SUBLK$(1));
      478     8634    5                        IF ICB.SHARE = %ALL# /* Determine SHAREability           */
      479     8635    5                         THEN         /* SHARE inopt specified, open file SHARED */
      480     8636    5                           FPT_OPEN.V.SHARE# = %ALL#;
      481     8637    5                         ELSE /* SHARE inopt not specified, default to the file  */
      482     8638    5                           FPT_OPEN.V.SHARE# = %NONE#; /* being opened SHARE=NONE */
      483     8639    5                        FPT_OPEN.V.ACS#=0; /* Use default ACS for first try      */
      484     8640    5                        CALL XUG$DISABLE (GETCMD);
      485     8641    5                        CALL M$OPEN(FPT_OPEN)
      486     8642    6                         WHENALTRETURN DO;
      487     8643    6                            IF %VPSZ_ERR#=%E$NOSHRDS /* Was this a Shared DS     */
      488     8644    6                             THEN
      489     8645    7                             DO;
      490     8646    7                                FPT_OPEN.V.ACS#=11;
              8646                                         /* Use DS8 to aviod future conflict */
      491     8647    7                                CALL M$OPEN(FPT_OPEN) ALTRET(ALT); /* and try again */
      492     8648    7                                END;
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:100  
      493     8649    6                             ELSE
      494     8650    6                               GOTO ALT;   /* Different problem - report it      */
      495     8651    6                            END;           /* WHENALTRETURN                      */
      496     8652    5                        CALL VPD$CLOSE_OUT(0);
      497     8653    5                        CALL VPD$OUT_NAMES(DIN_NAME,OCB.MOD_NAME);
      498     8654    5                        CALL XUG$ENABLE (GETCMD);
      499     8655    5   NEXT_FILE:           CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);
      500     8656                                                /* Probably a T-OPEN, depending on    */
      501     8657                                                /* FPT_OPEN_EI.V.OPER.TEST# which is  */
      502     8658                                                /* set elsewhere (VPF$OPEN_NEXT       */
      503     8659    5                        END;
      504     8660    4                     END;
      505     8661    3                 CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);
      506     8662    3                 END;
      507     8663    2              END;
      508     8664    1   END_MOD: ;
      509     8665    1           CALL VPD$FINISH_NLIST;          /* Finish dangling name list          */
      510     8666    1           RETURN;
      511     8667    1   ALT:    CALL VPL$ERR_PROC(2,0);
      512     8668    1   END VPK$MODIFY;
      513     8669        %EOD;

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:101  
--  Include file information  --

   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$MODIFY.

   Procedure VPK$MODIFY requires 162 words for executable code.
   Procedure VPK$MODIFY requires 10 words of local(AUTO) storage.

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:102  

 Object Unit name= VPK$MODIFY                                 File name= VPK$CMDS.:E05TOU
 UTS= JUL 30 '97 07:55:29.28 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none    58     72  VPK$MODIFY
   11   Proc  even  none   162    242  VPK$MODIFY
   12  RoData even  none    13     15  VPK$MODIFY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        0  VPK$MODIFY
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:103  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 VPF$SET_FROM_INFO
         yes           Std       2 VPF$GET_NEXT_SPEC
         yes           Std       3 VPF$OPEN_NEXT
         yes           Std       8 VPL$ERR_PROC
         yes           Std       1 VPD$CLOSE_OUT
         yes           Std       1 VPC$SETMOD
         yes           Std       2 VPD$OUT_NAMES
         yes           Std       2 VPD$FINISH_NLIST
         yes           Std       1 XUG$DISABLE
         yes           Std       1 XUG$ENABLE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PCB                                   GETCMD
     ABORT_STEP                            BREAK_LOC                             BREAK_MESSAGE_REPORTER
     SPEC_BUF                              OCB                                   DIN_NAME
     IN_RES                                ICB                                   M$EI
     M$EO                                  M$EO1                                 M$ME
     M$SI                                  M$READFILE                            M$DO
     M$STD1                                M$SORT1                               B$TCB$
     B_VECTNIL
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:104  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:105  


      403        1        /*T***********************************************************/
      404        2        /*T*                                                         */
      405        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      406        4        /*T*                                                         */
      407        5        /*T***********************************************************/
      408        6        VPK$MODIFY: PROC;

      6 11 000000   000000 700200 xent  VPK$MODIFY   TSX0  ! X66_AUTO_0
        11 000001   000012 000000                    ZERO    10,0

      409        7        /*D* NAME: VPK$MODIFY
      410        8             CALL: CALL VPK$MODIFY
      411        9             DESCRIPTION: This proc drives the MODIFY command.
      412       10        */
      413       11        %INCLUDE VP_DATA_R;
      414     6998        %INCLUDE F$DCB;
      415     7047        %INCLUDE B_ERRORS_C;
      416     8174        %B$TCB;
      417     8177        %B$ALT;
      418     8185        /**/
      419     8186        /*  CONSTANT  */
      420     8187        /**/
      421     8188        %FPT_OPEN(DCB = M$EI,
      422     8189                  FUN = UPDATE,
      423     8190                  STCLASS = STATIC);
      424     8299        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      425     8344        /**/
      426     8345        /*  ENTRY DCLS  */
      427     8346        /**/
      428     8347        %VP_ENTRIES (OMIT=VPK$MODIFY);
      429     8555        %INCLUDE XUG_ENTRY;
      430     8586        /**/
      431     8587        /*  LOCAL AUTO  */
      432     8588        /**/
      433     8589    1   DCL OPERAND SBIN WORD;
      434     8590    1   DCL OPERANDS$ PTR;
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:106  
      435     8591    1   DCL BLOCKI SBIN WORD;
      436     8592    1   DCL NEXT_SPEC_RET_VAL SBIN WORD;
      437     8593    1   DCL OPEN_NEXT_RET_VAL SBIN WORD;
      438     8594        %EJECT;
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:107  
      439     8595        /**/
      440     8596        /*  Find out what's on the command line  */
      441     8597        /**/
      442     8598    2           DO BLOCKI = 0 TO PCB.OUT$ -> OUT$BLK.NSUBLKS-1;

   8598 11 000002   200005 450100                    STZ     BLOCKI,,AUTO
        11 000003   000031 710000 11                 TRA     s:8606+1

      443     8599    3              DO CASE(PCB.OUT$ -> OUT$BLK.SUBLK$(BLOCKI) -> OUT$BLK.CODE);

   8599 11 000004   000003 470400 xsym               LDP0    PCB+3
        11 000005   200005 720100                    LXL0    BLOCKI,,AUTO
        11 000006   000003 471510                    LDP1    3,X0,PR0
        11 000007   100000 721100                    LXL1    0,,PR1
        11 000010   000004 101003                    CMPX1   4,DU
        11 000011   000013 602011 11                 TNC     s:8599+7,X1
        11 000012   000030 710000 11                 TRA     s:8606
        11 000013   000030 710000 11                 TRA     s:8606
        11 000014   000026 710000 11                 TRA     s:8604
        11 000015   000030 710000 11                 TRA     s:8606
        11 000016   000017 710000 11                 TRA     s:8601

      444     8600    3               CASE(3);                    /* 'FROM' INFO                        */

      445     8601    3                 CALL VPF$SET_FROM_INFO(PCB.OUT$ ->

   8601 11 000017   100003 633500                    EPPR3   3,,PR1
        11 000020   200010 453500                    STP3    OPEN_NEXT_RET_VAL+1,,AUTO
        11 000021   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL+1,,AUTO
        11 000022   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000023   000000 701000 xent               TSX1    VPF$SET_FROM_INFO
        11 000024   000000 011000                    NOP     0
        11 000025   000030 710000 11                 TRA     s:8606

      446     8602    3                   OUT$BLK.SUBLK$(BLOCKI) -> OUT$BLK.SUBLK$(0));
      447     8603    3               CASE(1);                    /* MOD PARAMETERS                     */

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:108  
      448     8604    3                 OPERANDS$ = PCB.OUT$ -> OUT$BLK.SUBLK$(BLOCKI);

   8604 11 000026   000003 236110                    LDQ     3,X0,PR0
        11 000027   200004 756100                    STQ     OPERANDS$,,AUTO

      449     8605    3               END;

      450     8606    2              END;

   8606 11 000030   200005 054100                    AOS     BLOCKI,,AUTO
        11 000031   000003 470400 xsym               LDP0    PCB+3
        11 000032   000001 236100                    LDQ     1,,PR0
        11 000033   000022 772000                    QRL     18
        11 000034   200005 116100                    CMPQ    BLOCKI,,AUTO
        11 000035   000004 605400 11                 TPNZ    s:8599

      451     8607        /**/
      452     8608        /*  Assorted setup.  */
      453     8609        /**/
      454     8610    1           REMEMBER NEXT_FILE IN ABORT_STEP;

   8610 11 000036   000177 635000 11                 EAA     NEXT_FILE
        11 000037   000000 452400 xsym               STP2    ABORT_STEP
        11 000040   000001 755000 xsym               STA     ABORT_STEP+1

      455     8611    1           REMEMBER END_MOD IN BREAK_LOC;

   8611 11 000041   000231 635000 11                 EAA     END_MOD
        11 000042   000000 452400 xsym               STP2    BREAK_LOC
        11 000043   000001 755000 xsym               STA     BREAK_LOC+1

      456     8612        %EJECT;
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:109  
      457     8613        /**/
      458     8614        /*  MOD the operands, one set at a time.  */
      459     8615        /**/
      460     8616    2           DO OPERAND=0 TO OPERANDS$->OUT$BLK.NSUBLKS-1;

   8616 11 000044   200003 450100                    STZ     OPERAND,,AUTO
        11 000045   000224 710000 11                 TRA     s:8663+1

      461     8617    2              CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL,

   8617 11 000046   200004 470500                    LDP0    OPERANDS$,,AUTO
        11 000047   200003 720100                    LXL0    OPERAND,,AUTO
        11 000050   000003 471510                    LDP1    3,X0,PR0
        11 000051   100003 633500                    EPPR3   3,,PR1
        11 000052   200011 453500                    STP3    OPEN_NEXT_RET_VAL+2,,AUTO
        11 000053   200006 631500                    EPPR1   NEXT_SPEC_RET_VAL,,AUTO
        11 000054   200010 451500                    STP1    OPEN_NEXT_RET_VAL+1,,AUTO
        11 000055   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL+1,,AUTO
        11 000056   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000057   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        11 000060   000000 011000                    NOP     0

      462     8618    2                OPERANDS$->OUT$BLK.SUBLK$(OPERAND)->OUT$BLK.SUBLK$(0));
      463     8619    3              DO WHILE(NEXT_SPEC_RET_VAL~=1);

   8619 11 000061   200006 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        11 000062   000001 115007                    CMPA    1,DL
        11 000063   000223 600000 11                 TZE     s:8663

      464     8620    3                 IF NEXT_SPEC_RET_VAL=0

   8620 11 000064   200006 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        11 000065   000212 601000 11                 TNZ     s:8661

      465     8621    3                  THEN
      466     8622    4                  DO;

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:110  
      467     8623    4                     CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,4);

   8623 11 000066   000000 236000 12                 LDQ     0
        11 000067   200011 756100                    STQ     OPEN_NEXT_RET_VAL+2,,AUTO
        11 000070   200007 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        11 000071   200010 450500                    STP0    OPEN_NEXT_RET_VAL+1,,AUTO
        11 000072   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL+1,,AUTO
        11 000073   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000074   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        11 000075   000000 011000                    NOP     0

      468     8624    4                     IF OPEN_NEXT_RET_VAL = %VPOC_EXHAUSTED#

   8624 11 000076   200007 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        11 000077   000001 115007                    CMPA    1,DL
        11 000100   000105 601000 11                 TNZ     s:8631

      469     8625    4                      THEN
      470     8626    4                        CALL VPL$ERR_PROC(1,90,'13'O);

   8626 11 000101   000003 630400 12                 EPPR0   3
        11 000102   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000103   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000104   000000 011000                    NOP     0

      471     8627        /*E*   ERROR:VPK-00090
      472     8628               MESSAGE: Nothing to modify.
      473     8629              MESSAGE1: No files were acceptable to MODIFY/RENAME in that input spec
      474     8630        */
      475     8631    5                     DO WHILE(OPEN_NEXT_RET_VAL~=%VPOC_EXHAUSTED#);

   8631 11 000105   200007 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        11 000106   000001 115007                    CMPA    1,DL
        11 000107   000212 600000 11                 TZE     s:8661

      476     8632    5                        CALL VPC$SETMOD(OPERANDS$ -> OUT$BLK.SUBLK$(OPERAND) ->

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:111  
   8632 11 000110   200004 470500                    LDP0    OPERANDS$,,AUTO
        11 000111   200003 720100                    LXL0    OPERAND,,AUTO
        11 000112   000003 471510                    LDP1    3,X0,PR0
        11 000113   100004 633500                    EPPR3   4,,PR1
        11 000114   200010 453500                    STP3    OPEN_NEXT_RET_VAL+1,,AUTO
        11 000115   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL+1,,AUTO
        11 000116   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000117   000000 701000 xent               TSX1    VPC$SETMOD
        11 000120   000000 011000                    NOP     0

      477     8633    5                          OUT$BLK.SUBLK$(1));
      478     8634    5                        IF ICB.SHARE = %ALL# /* Determine SHAREability           */

   8634 11 000121   000006 235000 xsym               LDA     ICB+6
        11 000122   000001 115007                    CMPA    1,DL
        11 000123   000131 601000 11                 TNZ     s:8638

      479     8635    5                         THEN         /* SHARE inopt specified, open file SHARED */
      480     8636    5                           FPT_OPEN.V.SHARE# = %ALL#;

   8636 11 000124   000044 236000 10                 LDQ     FPT_OPEN+36
        11 000125   000006 376000 12                 ANQ     6
        11 000126   000010 276007                    ORQ     8,DL
        11 000127   000044 756000 10                 STQ     FPT_OPEN+36
        11 000130   000133 710000 11                 TRA     s:8639

      481     8637    5                         ELSE /* SHARE inopt not specified, default to the file  */
      482     8638    5                           FPT_OPEN.V.SHARE# = %NONE#; /* being opened SHARE=NONE */

   8638 11 000131   000030 236007                    LDQ     24,DL
        11 000132   000044 256000 10                 ORSQ    FPT_OPEN+36

      483     8639    5                        FPT_OPEN.V.ACS#=0; /* Use default ACS for first try      */

   8639 11 000133   000000 236003                    LDQ     0,DU
        11 000134   000046 552004 10                 STBQ    FPT_OPEN+38,'04'O

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:112  
      484     8640    5                        CALL XUG$DISABLE (GETCMD);

   8640 11 000135   000007 630400 12                 EPPR0   7
        11 000136   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000137   000000 701000 xent               TSX1    XUG$DISABLE
        11 000140   000000 011000                    NOP     0

      485     8641    5                        CALL M$OPEN(FPT_OPEN)

   8641 11 000141   000000 630400 10                 EPPR0   FPT_OPEN
        11 000142   450000 713400                    CLIMB   alt,open
        11 000143   410400 401760                    pmme    nvectors=18
        11 000144   000146 702000 11                 TSX2    s:8643
        11 000145   000163 710000 11                 TRA     s:8652

      486     8642    6                         WHENALTRETURN DO;

      487     8643    6                            IF %VPSZ_ERR#=%E$NOSHRDS /* Was this a Shared DS     */

   8643 11 000146   000000 470400 xsym               LDP0    B$TCB$
        11 000147   000000 471500                    LDP1    0,,PR0
        11 000150   100102 236100                    LDQ     66,,PR1
        11 000151   377770 376007                    ANQ     131064,DL
        11 000152   001740 116007                    CMPQ    992,DL
        11 000153   000235 601000 11                 TNZ     ALT

      488     8644    6                             THEN
      489     8645    7                             DO;

      490     8646    7                                FPT_OPEN.V.ACS#=11;
              8646                                         /* Use DS8 to aviod future conflict */

   8646 11 000154   000013 236007                    LDQ     11,DL
        11 000155   000046 552004 10                 STBQ    FPT_OPEN+38,'04'O

      491     8647    7                                CALL M$OPEN(FPT_OPEN) ALTRET(ALT); /* and try again */

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:113  
   8647 11 000156   000000 630400 10                 EPPR0   FPT_OPEN
        11 000157   450000 713400                    CLIMB   alt,open
        11 000160   410400 401760                    pmme    nvectors=18
        11 000161   000235 702000 11                 TSX2    ALT

      492     8648    7                                END;

   8648 11 000162   000163 710000 11                 TRA     s:8652

      493     8649    6                             ELSE
      494     8650    6                               GOTO ALT;   /* Different problem - report it      */
      495     8651    6                            END;           /* WHENALTRETURN                      */
      496     8652    5                        CALL VPD$CLOSE_OUT(0);

   8652 11 000163   000010 630400 12                 EPPR0   8
        11 000164   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000165   000000 701000 xent               TSX1    VPD$CLOSE_OUT
        11 000166   000000 011000                    NOP     0

      497     8653    5                        CALL VPD$OUT_NAMES(DIN_NAME,OCB.MOD_NAME);

   8653 11 000167   000011 630400 12                 EPPR0   9
        11 000170   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000171   000000 701000 xent               TSX1    VPD$OUT_NAMES
        11 000172   000000 011000                    NOP     0

      498     8654    5                        CALL XUG$ENABLE (GETCMD);

   8654 11 000173   000007 630400 12                 EPPR0   7
        11 000174   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000175   000000 701000 xent               TSX1    XUG$ENABLE
        11 000176   000000 011000                    NOP     0

      499     8655    5   NEXT_FILE:           CALL VPF$OPEN_NEXT(OPEN_NEXT_RET_VAL,1);

   8655 11 000177   000003 236000 12    NEXT_FILE    LDQ     3
        11 000200   200011 756100                    STQ     OPEN_NEXT_RET_VAL+2,,AUTO
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:114  
        11 000201   200007 630500                    EPPR0   OPEN_NEXT_RET_VAL,,AUTO
        11 000202   200010 450500                    STP0    OPEN_NEXT_RET_VAL+1,,AUTO
        11 000203   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL+1,,AUTO
        11 000204   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000205   000000 701000 xent               TSX1    VPF$OPEN_NEXT
        11 000206   000000 011000                    NOP     0

      500     8656                                                /* Probably a T-OPEN, depending on    */
      501     8657                                                /* FPT_OPEN_EI.V.OPER.TEST# which is  */
      502     8658                                                /* set elsewhere (VPF$OPEN_NEXT       */
      503     8659    5                        END;

   8659 11 000207   200007 235100                    LDA     OPEN_NEXT_RET_VAL,,AUTO
        11 000210   000001 115007                    CMPA    1,DL
        11 000211   000110 601000 11                 TNZ     s:8632

      504     8660    4                     END;

      505     8661    3                 CALL VPF$GET_NEXT_SPEC(NEXT_SPEC_RET_VAL);

   8661 11 000212   200006 630500                    EPPR0   NEXT_SPEC_RET_VAL,,AUTO
        11 000213   200010 450500                    STP0    OPEN_NEXT_RET_VAL+1,,AUTO
        11 000214   200010 630500                    EPPR0   OPEN_NEXT_RET_VAL+1,,AUTO
        11 000215   000017 631400 xsym               EPPR1   B_VECTNIL+15
        11 000216   000000 701000 xent               TSX1    VPF$GET_NEXT_SPEC
        11 000217   000000 011000                    NOP     0

      506     8662    3                 END;

   8662 11 000220   200006 235100                    LDA     NEXT_SPEC_RET_VAL,,AUTO
        11 000221   000001 115007                    CMPA    1,DL
        11 000222   000064 601000 11                 TNZ     s:8620

      507     8663    2              END;

   8663 11 000223   200003 054100                    AOS     OPERAND,,AUTO
        11 000224   200004 470500                    LDP0    OPERANDS$,,AUTO
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:115  
        11 000225   000001 236100                    LDQ     1,,PR0
        11 000226   000022 772000                    QRL     18
        11 000227   200003 116100                    CMPQ    OPERAND,,AUTO
        11 000230   000046 605400 11                 TPNZ    s:8617

   8655 11 000231                       END_MOD      null
      508     8664    1   END_MOD: ;
      509     8665    1           CALL VPD$FINISH_NLIST;          /* Finish dangling name list          */

   8665 11 000231   000002 631400 xsym               EPPR1   B_VECTNIL+2
        11 000232   000000 701000 xent               TSX1    VPD$FINISH_NLIST
        11 000233   000000 011000                    NOP     0

      510     8666    1           RETURN;

   8666 11 000234   000000 702200 xent               TSX2  ! X66_ARET

      511     8667    1   ALT:    CALL VPL$ERR_PROC(2,0);

   8667 11 000235   000013 630400 12    ALT          EPPR0   11
        11 000236   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000237   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000240   000000 011000                    NOP     0

      512     8668    1   END VPK$MODIFY;

   8668 11 000241   000000 702200 xent               TSX2  ! X66_ARET
      513     8669        %EOD;

PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:116  
--  Include file information  --

   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$MODIFY.
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:117  

 **** Variables and constants ****

  ****  Section 010  Data  VPK$MODIFY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 FPT_OPEN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w SBIN        r     1 BLOCKI                     6-0-0/w SBIN        r     1 NEXT_SPEC_RET_VAL
     7-0-0/w SBIN        r     1 OPEN_NEXT_RET_VAL          3-0-0/w SBIN        r     1 OPERAND
     4-0-0/w PTR         r     1 OPERANDS$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ABORT_STEP                 0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d REMB        r     1 BREAK_LOC
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/c STRC(288)   r     1 DIN_NAME                   0-0-0/d STRC(1512)  r     1 GETCMD
     0-0-0/d STRC(5868)  r     1 ICB                        0-0-0/d STRC(6840)  r     1 OCB
     0-0-0/w STRC(504)   r     1 PCB

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$EI
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:118  
     0-0-0/w STRC(144)   r     1 OUT$BLK


   Procedure VPK$MODIFY requires 162 words for executable code.
   Procedure VPK$MODIFY requires 10 words of local(AUTO) storage.
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:119  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:120  
          MINI XREF LISTING

ABORT_STEP
      5182**DCL      8610<<REMEMBR
ALT
      8667**LABEL    8647--CALLALT  8650--GOTO
B$ALT.CODE
      8179**DCL      8179--REDEF    8180--REDEF    8180--REDEF
B$ALT.ERR.ERR#
      8181**DCL      8181--REDEF    8643>>IF
B$ALT.EVID
      8180**DCL      8180--REDEF    8180--REDEF
B$TCB.ALT$
      8175**DCL      8643>>IF
B$TCB$
      5983**DCL      8643>>IF
BLOCKI
      8591**DCL      8598<<DOINDEX  8599>>DOCASE   8601>>CALL     8604>>ASSIGN
BREAK_LOC
      5218**DCL      5218--REDEF    8611<<REMEMBR
DEF_ICB.FID.STRING
      5816**DCL      5817--REDEF
DEV_ICB.FID.STRING
      5702**DCL      5703--REDEF
DIN_NAME
      5509**DCL      8653<>CALL
EI_KEY.KEY
      5914**DCL      5914--REDEF    5914--REDEF    5914--REDEF
END_MOD
      8655**LABEL    8611--REMEMBR
EO_OCB.TYPE
      5414**DCL      5415--REDEF
F$DCB.ACTPOS
      7024**DCL      7024--REDEF
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:121  
F$DCB.ARS
      6999**DCL      6999--REDEF
F$DCB.ATTR
      7017**DCL      7018--REDEF
F$DCB.BORROW
      7032**DCL      7032--REDEF    7032--REDEF    7032--REDEF
F$DCB.DCBNAME.L
      7046**DCL      7046--IMP-SIZ
F$DCB.EOMCHAR
      7003**DCL      7003--REDEF
F$DCB.FLDID
      7027**DCL      7027--REDEF
F$DCB.FORM$
      7021**DCL      7021--REDEF
F$DCB.FSECT
      7037**DCL      7037--REDEF
F$DCB.FSN
      7014**DCL      7014--REDEF    7014--REDEF    7015--REDEF
F$DCB.HEADER$
      7020**DCL      7020--REDEF
F$DCB.IXTNSIZE
      7018**DCL      7018--REDEF
F$DCB.LASTSTA$
      7008**DCL      7008--REDEF
F$DCB.LVL
      7033**DCL      7033--REDEF
F$DCB.NAME.C
      7008**DCL      7008--REDEF
F$DCB.NOEOF
      7029**DCL      7029--REDEF
F$DCB.NRECS
      7019**DCL      7019--REDEF
F$DCB.NRECX
      7038**DCL      7038--REDEF
F$DCB.OHDR
      7030**DCL      7030--REDEF
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:122  
F$DCB.ORG
      7013**DCL      7013--REDEF
F$DCB.PRECNO
      7036**DCL      7036--REDEF
F$DCB.RCSZ
      7041**DCL      7041--REDEF
F$DCB.RES
      7009**DCL      7009--REDEF
F$DCB.SETX
      7021**DCL      7021--REDEF
F$DCB.TAB$
      7020**DCL      7021--REDEF
F$DCB.TDA
      7035**DCL      7035--REDEF
F$DCB.WSN
      7010**DCL      7010--REDEF
FPT_CLOSE_EI.SN_
      6755**DCL      6755--REDEF
FPT_CLOSE_EI.UTL_
      6756**DCL      6756--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6770**DCL      6770--REDEF
FPT_CLOSE_EI.V.TYPE#
      6768**DCL      6768--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6765**DCL      6765--REDEF    6767--REDEF
FPT_CLOSE_PTL.SN_
      6881**DCL      6881--REDEF
FPT_CLOSE_PTL.UTL_
      6882**DCL      6882--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6896**DCL      6896--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6894**DCL      6894--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6891**DCL      6891--REDEF    6893--REDEF
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:123  
FPT_CLOSE_READ.SN_
      6797**DCL      6797--REDEF
FPT_CLOSE_READ.UTL_
      6798**DCL      6798--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6812**DCL      6812--REDEF
FPT_CLOSE_READ.V.TYPE#
      6810**DCL      6810--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6807**DCL      6807--REDEF    6809--REDEF
FPT_CLOSE_SI.SN_
      6965**DCL      6965--REDEF
FPT_CLOSE_SI.UTL_
      6966**DCL      6966--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6980**DCL      6980--REDEF
FPT_CLOSE_SI.V.TYPE#
      6978**DCL      6978--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6975**DCL      6975--REDEF    6977--REDEF
FPT_CLOSE_STD.SN_
      6923**DCL      6923--REDEF
FPT_CLOSE_STD.UTL_
      6924**DCL      6924--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6938**DCL      6938--REDEF
FPT_CLOSE_STD.V.TYPE#
      6936**DCL      6936--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6933**DCL      6933--REDEF    6935--REDEF
FPT_CLSEI_FT.SN_
      6839**DCL      6839--REDEF
FPT_CLSEI_FT.UTL_
      6840**DCL      6840--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6854**DCL      6854--REDEF
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:124  
FPT_CLSEI_FT.V.TYPE#
      6852**DCL      6852--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6849**DCL      6849--REDEF    6851--REDEF
FPT_OPEN
      8255**DCL      8641<>CALL     8647<>CALL
FPT_OPEN.ACSVEH_
      8257**DCL      8258--REDEF
FPT_OPEN.ALTKEYS_
      8263**DCL      8264--REDEF    8264--REDEF
FPT_OPEN.HDR_
      8262**DCL      8263--REDEF
FPT_OPEN.TAB_
      8261**DCL      8262--REDEF
FPT_OPEN.UHL_
      8255**DCL      8256--REDEF    8256--REDEF
FPT_OPEN.V
      8264**DCL      8255--DCLINIT
FPT_OPEN.V.ACS#
      8275**DCL      8639<<ASSIGN   8646<<ASSIGN
FPT_OPEN.V.FSN#
      8295**DCL      8295--REDEF    8295--REDEF
FPT_OPEN.V.SHARE#
      8269**DCL      8636<<ASSIGN   8638<<ASSIGN
FPT_OPEN.WSN_
      8261**DCL      8261--REDEF
FPT_OPEN_EI.ACSVEH_
      6410**DCL      6411--REDEF
FPT_OPEN_EI.ALTKEYS_
      6416**DCL      6417--REDEF    6417--REDEF
FPT_OPEN_EI.HDR_
      6415**DCL      6416--REDEF
FPT_OPEN_EI.TAB_
      6414**DCL      6415--REDEF
FPT_OPEN_EI.UHL_
      6408**DCL      6409--REDEF    6409--REDEF
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:125  
FPT_OPEN_EI.V.FSN#
      6448**DCL      6448--REDEF    6448--REDEF
FPT_OPEN_EI.WSN_
      6414**DCL      6414--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6519**DCL      6520--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6525**DCL      6526--REDEF    6526--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6524**DCL      6525--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6523**DCL      6524--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6517**DCL      6518--REDEF    6518--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6557**DCL      6557--REDEF    6557--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6523**DCL      6523--REDEF
FPT_OPEN_OUT.ACSVEH_
      6301**DCL      6302--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6307**DCL      6308--REDEF    6308--REDEF
FPT_OPEN_OUT.HDR_
      6306**DCL      6307--REDEF
FPT_OPEN_OUT.TAB_
      6305**DCL      6306--REDEF
FPT_OPEN_OUT.UHL_
      6299**DCL      6300--REDEF    6300--REDEF
FPT_OPEN_OUT.V.FSN#
      6339**DCL      6339--REDEF    6339--REDEF
FPT_OPEN_OUT.WSN_
      6305**DCL      6305--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6192**DCL      6193--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6198**DCL      6199--REDEF    6199--REDEF
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:126  
FPT_OPEN_OUT_SAVE.HDR_
      6197**DCL      6198--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6196**DCL      6197--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6190**DCL      6191--REDEF    6191--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6230**DCL      6230--REDEF    6230--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6196**DCL      6196--REDEF
FPT_READ_STD.STATION_
      6620**DCL      6621--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6632**DCL      6632--REDEF
FPT_READ_STD.V.INDX#
      6630**DCL      6630--REDEF
FPT_READ_UC.STATION_
      6581**DCL      6582--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6593**DCL      6593--REDEF
FPT_READ_UC.V.INDX#
      6591**DCL      6591--REDEF
FPT_WRITE_ME.STATION_
      6689**DCL      6689--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6696**DCL      6696--REDEF
FPT_WRITE_OUT.STATION_
      6720**DCL      6720--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6727**DCL      6727--REDEF
FPT_WRITE_UC.STATION_
      6658**DCL      6658--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6665**DCL      6665--REDEF
FROM_SN.SN
      5564**DCL      5565--REDEF
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:127  
GETCMD
      4766**DCL      8640<>CALL     8654<>CALL
GETCMD.OUT$
      4771**DCL      4777--REDEF
ICB.FID.STRING
      5588**DCL      5589--REDEF
ICB.SHARE
      5576**DCL      8634>>IF
IFSFA_PARAM.EOMCHAR#
      5943**DCL      5944--REDEF
IFSFA_PARAM.SIG1
      5937**DCL      5937--REDEF
IFSFA_PARAM.SIG2
      5937**DCL      5938--REDEF
IN_RES
      5510**DCL      5510--REDEF
IN_SN.SN
      5526**DCL      5527--REDEF
M$OPEN
        28**DCL-ENT  8641--CALL     8647--CALL
NEXT_FILE
      8655**LABEL    8610--REMEMBR
NEXT_SPEC_RET_VAL
      8592**DCL      8617<>CALL     8619>>DOWHILE  8620>>IF       8661<>CALL
OCB.MOD_NAME
      5293**DCL      8653<>CALL
OCB.TYPE
      5272**DCL      5273--REDEF
OFSFA_PARAM.EOMCHAR#
      5973**DCL      5974--REDEF
OFSFA_PARAM.SIG1
      5967**DCL      5967--REDEF
OFSFA_PARAM.SIG2
      5967**DCL      5968--REDEF
OPEN_NEXT_RET_VAL
      8593**DCL      8623<>CALL     8624>>IF       8631>>DOWHILE  8655<>CALL
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:128  
OPERAND
      8589**DCL      8616<<DOINDEX  8617>>CALL     8632>>CALL
OPERANDS$
      8590**DCL      8604<<ASSIGN   8616>>DOINDEX  8617>>CALL     8632>>CALL
OUT$BLK.CODE
      8313**DCL      8599>>DOCASE
OUT$BLK.NSUBLKS
      8317**DCL      8598>>DOINDEX  8616>>DOINDEX
OUT$BLK.SUBLK$
      8338**DCL      8599>>DOCASE   8601>>CALL     8601<>CALL     8604>>ASSIGN   8617>>CALL     8617<>CALL
      8632>>CALL     8632<>CALL
OUT_SN.SN
      5544**DCL      5545--REDEF
PCB.OUT$
      4585**DCL      8598>>DOINDEX  8599>>DOCASE   8601>>CALL     8604>>ASSIGN
SPEC_BUF
      5222**DCL      5222--REDEF
VPC$SETMOD
      8356**DCL-ENT  8632--CALL
VPD$CLOSE_OUT
      8372**DCL-ENT  8652--CALL
VPD$FINISH_NLIST
      8390**DCL-ENT  8665--CALL
VPD$OUT_NAMES
      8391**DCL-ENT  8653--CALL
VPF$GET_NEXT_SPEC
      8458**DCL-ENT  8617--CALL     8661--CALL
VPF$OPEN_NEXT
      8461**DCL-ENT  8623--CALL     8655--CALL
VPF$SET_FROM_INFO
      8467**DCL-ENT  8601--CALL
VPL$ERR_PROC
      8529**DCL-ENT  8626--CALL     8667--CALL
XUG$DISABLE
      8573**DCL-ENT  8640--CALL
XUG$ENABLE
PL6.E3A0      #003=VPK$MODIFY File=VPK$CMDS.:E05TSI                              WED 07/30/97 07:55 Page:129  
      8574**DCL-ENT  8654--CALL

PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:130  
      514        1        /*T***********************************************************/
      515        2        /*T*                                                         */
      516        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      517        4        /*T*                                                         */
      518        5        /*T***********************************************************/
      519        6        VPK$PCL_INVOCATION: PROC;
      520        7        /*D* NAME: VPK$PCL_INVOCATION
      521        8             CALL: CALL VPK$PCL_INVOCATION
      522        9             DESCRIPTION: This proc takes care of two tasks:
      523       10                          1)  To inform the user that they have entered the 'PCL' invo-
      524       11                              cation statement from within PCL.
      525       12                          2)  To handle the commands necessary for the debugging of PCL.
      526       13        */
      527       14        %INCLUDE VP_DATA_R;
      528     7001 S      %INCLUDE B$JIT_C;
      529     7002        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      530     7047        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      531     7085        %FPT_YC(FPTN = FPT_YC,
      532     7086                CMD = CC_BUF.TEXT);
      533     7103    1   DCL CMD$ PTR STATIC;
      534     7104    1   DCL 1 CC_BUF STATIC,
      535     7105    1         2 COUNT UBIN(9) UNAL,
      536     7106    1         2 TEXT CHAR(120) UNAL;
      537     7107        %FPT_MONINFO(FPTN = FPT_MONINFO,
      538     7108                     STCLASS = STATIC,
      539     7109                     SITEINFO = SITE_INFO);
      540     7124        %FPT_FID(FPTN = FPT_FID,
      541     7125                 ASN = RETURN_ASN,
      542     7126                 SN = RETURN_SN,
      543     7127                 ACCT = RETURN_ACCT,
      544     7128                 NAME = RETURN_NAME,
      545     7129                 PASS = RETURN_PASS,
      546     7130                 RES = RETURN_RES,
      547     7131                 WSN = RETURN_TRASH,
      548     7132                 TEXTFID = FID_BUF,
      549     7133                 RESULTS = RESULTS);
      550     7156        %VLR_FID(FPTN = RESULTS);
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:131  
      551     7175        %FPT_UNFID(FPTN = FPT_UNFID,
      552     7176                   TEXTFID = FID_BUF,
      553     7177                   NAME = ERRMSG_NAME,
      554     7178                   ACCT = ERRMSG_ACCT,
      555     7179                   PASS = ERRMSG_PASS,
      556     7180                   ASN = ERRMSG_ASN,
      557     7181                   STCLASS = STATIC);
      558     7199    1   DCL ERRMSG_ASN UBIN BYTE CONSTANT INIT(%FILE#);
      559     7200    1   DCL B_VERSION CHAR(1) SYMREF;           /*  LINKER-supplied Version Id        */
      560     7201    1   DCL 1 TEXT$C  BASED,
      561     7202    1         2 COUNT UBIN(9) UNAL,
      562     7203    1         2 TEXT CHAR(TEXT$C.COUNT) UNAL;
      563     7204    1   DCL ME_BUF CHAR(80) STATIC;             /* Use VFC for space 1 after print    */
      564     7205    1   DCL CONV_BUF CHAR(2) STATIC;
      565     7206        %B$JIT0;
      566     7295        %U$JIT1;
      567     7369        %M$JIT2;
      568     7379        %F$JIT3;
      569     7384        %S$JIT4;
      570     7390        %J$JIT5;
      571     7478    1         2 * BIT(1);                       /* Rest of JIT not needed             */
      572     7479        %VLR_SITEINFO(FPTN = SITE_INFO);
      573     7498        /**/
      574     7499        /*  ENTRY DCLS  */
      575     7500        /**/
      576     7501        %VP_ENTRIES (OMIT=VPK$PCL_INVOCATION);
      577     7709        %INCLUDE XUG_ENTRY;
      578     7740    1   DCL FID_BUF CHAR(33) STATIC;
      579     7741    1   DCL PS_LEN UBIN WORD STATIC;
      580     7742        %FPT_LINK(FPTN = FPT_LINK,
      581     7743                  NAME = RETURN_NAME,
      582     7744                  ACCT = RETURN_ACCT);
      583     7762    1   DCL RETURN_ASN UBIN(9) STATIC;
      584     7763        %VLP_SN(FPTN = RETURN_SN, STCLASS = STATIC);
      585     7776        %VLP_NAME(FPTN = RETURN_NAME, LEN = 31, STCLASS = STATIC);
      586     7803    1   DCL RETURN_ACCT CHAR(8) STATIC;
      587     7804    1   DCL RETURN_PASS CHAR(8) STATIC;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:132  
      588     7805    1   DCL RETURN_RES CHAR(4) STATIC;
      589     7806        %VLP_NAME(FPTN = RETURN_TRASH, LEN = 31, STCLASS = STATIC);
      590     7833    1           IF PCB.OUT$ -> OUT$BLK.NSUBLKS = 0 OR
      591     7834    1             PCB.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = 0
      592     7835    2            THEN DO;                  /* User is already inside PCL, the FOOL!   */
      593     7836    2               CALL VPL$ERR_PROC(0,80,'13'O);
      594     7837        /*E* ERROR: VPK-00080
      595     7838           MESSAGE: You are already in PCL!!!
      596     7839        */
      597     7840    2               RETURN;
      598     7841    2               END;
      599     7842                                      /* User trying to access PCL's debugging mode   */
      600     7843    1           FPT_WRITE_ME.BUF_ = VECTOR(ME_BUF);
      601     7844    1           FPT_WRITE_ME.V.DVBYTE.VFC# = %YES#;
      602     7845    1           CMD$ = PCB.OUT$->OUT$BLK.SUBLK$(0);
      603     7846    1           CALL M$MONINFO(FPT_MONINFO) ALTRET (ALT);
      604     7847    1           IF (B$JIT.SWITCH & '777777777000'O) ~= TEST_PATTERN
      605     7848    1            THEN
      606     7849    1              CALL VPL$ERR_PROC(3,60,'13'O);
      607     7850        /*E* ERROR: VPK-00060
      608     7851           MESSAGE: Unauthorized of PRIVILEDGED PCL commands NOT allowed!!!
      609     7852        */
      610     7853    2           DO CASE (CMD$->OUT$BLK.CODE);   /* Select which special command & do  */
      611     7854        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:133  
      612     7855    2            CASE (10);
      613     7856    2   PCL_VER:   CALL CONCAT(ME_BUF,'ACP-6 version ',SITE_INFO.VERSION#);
      614     7857    2              CALL M$WRITE(FPT_WRITE_ME);
      615     7858    2              CALL CONCAT(ME_BUF,'APCL ',ADDR(B_VERSION)->TEXT$C.TEXT,', ',PCL_VER_DAT)
              7858                       ;
      616     7859    2              CALL M$WRITE(FPT_WRITE_ME);
      617     7860    2              IF FROM_SYS
      618     7861    2               THEN
      619     7862    2                 ME_BUF = 'ARunning as a processor.';
      620     7863    2               ELSE
      621     7864    2                 ME_BUF = 'ANot running as a processor.';
      622     7865    2              CALL M$WRITE(FPT_WRITE_ME);
      623     7866    2              CALL CONCAT (ME_BUF,'ASite ',SITE_INFO.SITE_NAME#.C);
      624     7867    2              CALL M$WRITE(FPT_WRITE_ME);
      625     7868    2              CALL CONCAT(ME_BUF,'AInvocation line:  ',B$JIT$ ->
      626     7869    2                B$JIT.CCBUF);
      627     7870    2              CALL M$WRITE(FPT_WRITE_ME);
      628     7871    2              CALL BINCHAR(CONV_BUF,B$JIT$ -> B$JIT.LNKCNT);
      629     7872    2              CALL CONCAT(ME_BUF,'AM$LINK level = ',CONV_BUF);
      630     7873    2              CALL M$WRITE(FPT_WRITE_ME);
      631     7874    2              CALL M$UNFID (FPT_UNFID);
      632     7875    2              CALL CONCAT(ME_BUF,'AERRMSG file = ',FID_BUF);
      633     7876    2              CALL M$WRITE(FPT_WRITE_ME);
      634     7877        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:134  
      635     7878    2            CASE (11);
      636     7879    2   PCL_TEST:  ;                            /* SET or RESET TEST MODE             */
      637     7880    2              TEST_MODE = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;
      638     7881    2            CASE (12);
      639     7882    2   PCL_SHOT:  ;                            /* SET or RESET ONE SHOT              */
      640     7883    2              ONE_TIME = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;
      641     7884        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:135  
      642     7885    2            CASE (13);
      643     7886        /*  CODE NUMBER 5 IS UNUSED */
      644     7887        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:136  
      645     7888    2            CASE (14);
      646     7889    2   PCL_FCG:   ;                            /* SET or RESET FCG display on errors */
      647     7890    2              FPT_ERRMSG.V.INCLCODE# = BINBIT(CMD$ ->
      648     7891    2                OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE,1);
      649     7892
      650     7893    2            CASE (15);
      651     7894    2   PCL_MESS:  ;                            /* Set M$ERRMSG file                  */
      652     7895    2              FID_BUF = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
      653     7896    2              CALL VPD$FID (FPT_FID);
      654     7897    2              IF RESULTS.NAME
      655     7898    2               THEN
      656     7899    2                 ERRMSG_NAME = RETURN_NAME;
      657     7900    2               ELSE
      658     7901    2                 ERRMSG_NAME.LEN = 0;
      659     7902    2              IF RESULTS.ACCT
      660     7903    2               THEN
      661     7904    2                 ERRMSG_ACCT = RETURN_ACCT;
      662     7905    2               ELSE
      663     7906    2                 ERRMSG_ACCT = ' ';
      664     7907    2              IF RESULTS.PASS
      665     7908    2               THEN
      666     7909    2                 ERRMSG_PASS = RETURN_PASS;
      667     7910    2               ELSE
      668     7911    2                 ERRMSG_PASS = ' ';
      669     7912    2              GETCMD.ERRMFID$ = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXTC$;
      670     7913    2              CALL XUG$SETERRMSG (GETCMD);
      671     7914    2            END;                           /* END CASE                           */
      672     7915
      673     7916    1           RETURN;
      674     7917
      675     7918    1   ALT:    CALL VPL$ERR_PROC(3,0);         /* Abort command                      */
      676     7919    1   END VPK$PCL_INVOCATION;
      677     7920        %EOD;

PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:137  
--  Include file information  --

   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$PCL_INVOCATION.

   Procedure VPK$PCL_INVOCATION requires 215 words for executable code.
   Procedure VPK$PCL_INVOCATION requires 6 words of local(AUTO) storage.

PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:138  

 Object Unit name= VPK$PCL_INVOCATION                         File name= VPK$CMDS.:E05TOU
 UTS= JUL 30 '97 07:57:57.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none   245    365  VPK$PCL_INVOCATION
   11  RoData even  UTS     37     45  VPK$PCL_INVOCATION
   12   Proc  even  none   215    327  VPK$PCL_INVOCATION
   13  RoData even  none    16     20  VPK$PCL_INVOCATION

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        0  VPK$PCL_INVOCATION
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:139  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       8 VPL$ERR_PROC
 yes     yes           Std       1 XUG$SETERRMSG
 yes     yes           Std       2 VPD$FID
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PCB                                   GETCMD
     ERRMSG_ACCT                           ERRMSG_PASS                           ERRMSG_NAME
     TEST_PATTERN                          TEST_MODE                             FROM_SYS
     PCL_VER_DAT                           BREAK_LOC                             BREAK_MESSAGE_REPORTER
     SPEC_BUF                              ONE_TIME                              IN_RES
     M$EI                                  M$EO                                  M$EO1
     M$ME                                  M$SI                                  M$READFILE
     M$DO                                  M$STD1                                M$SORT1
     B$JIT$                                FPT_ERRMSG                            FPT_WRITE_ME
     B_VERSION                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:140  


      514        1        /*T***********************************************************/
      515        2        /*T*                                                         */
      516        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      517        4        /*T*                                                         */
      518        5        /*T***********************************************************/
      519        6        VPK$PCL_INVOCATION: PROC;

      6 12 000000   000000 700200 xent  VPK$PCL_INV* TSX0  ! X66_AUTO_0
        12 000001   000006 000000                    ZERO    6,0

      520        7        /*D* NAME: VPK$PCL_INVOCATION
      521        8             CALL: CALL VPK$PCL_INVOCATION
      522        9             DESCRIPTION: This proc takes care of two tasks:
      523       10                          1)  To inform the user that they have entered the 'PCL' invo-
      524       11                              cation statement from within PCL.
      525       12                          2)  To handle the commands necessary for the debugging of PCL.
      526       13        */
      527       14        %INCLUDE VP_DATA_R;
      528     7001 S      %INCLUDE B$JIT_C;
      529     7002        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      530     7047        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      531     7085        %FPT_YC(FPTN = FPT_YC,
      532     7086                CMD = CC_BUF.TEXT);
      533     7103    1   DCL CMD$ PTR STATIC;
      534     7104    1   DCL 1 CC_BUF STATIC,
      535     7105    1         2 COUNT UBIN(9) UNAL,
      536     7106    1         2 TEXT CHAR(120) UNAL;
      537     7107        %FPT_MONINFO(FPTN = FPT_MONINFO,
      538     7108                     STCLASS = STATIC,
      539     7109                     SITEINFO = SITE_INFO);
      540     7124        %FPT_FID(FPTN = FPT_FID,
      541     7125                 ASN = RETURN_ASN,
      542     7126                 SN = RETURN_SN,
      543     7127                 ACCT = RETURN_ACCT,
      544     7128                 NAME = RETURN_NAME,
      545     7129                 PASS = RETURN_PASS,
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:141  
      546     7130                 RES = RETURN_RES,
      547     7131                 WSN = RETURN_TRASH,
      548     7132                 TEXTFID = FID_BUF,
      549     7133                 RESULTS = RESULTS);
      550     7156        %VLR_FID(FPTN = RESULTS);
      551     7175        %FPT_UNFID(FPTN = FPT_UNFID,
      552     7176                   TEXTFID = FID_BUF,
      553     7177                   NAME = ERRMSG_NAME,
      554     7178                   ACCT = ERRMSG_ACCT,
      555     7179                   PASS = ERRMSG_PASS,
      556     7180                   ASN = ERRMSG_ASN,
      557     7181                   STCLASS = STATIC);
      558     7199    1   DCL ERRMSG_ASN UBIN BYTE CONSTANT INIT(%FILE#);
      559     7200    1   DCL B_VERSION CHAR(1) SYMREF;           /*  LINKER-supplied Version Id        */
      560     7201    1   DCL 1 TEXT$C  BASED,
      561     7202    1         2 COUNT UBIN(9) UNAL,
      562     7203    1         2 TEXT CHAR(TEXT$C.COUNT) UNAL;
      563     7204    1   DCL ME_BUF CHAR(80) STATIC;             /* Use VFC for space 1 after print    */
      564     7205    1   DCL CONV_BUF CHAR(2) STATIC;
      565     7206        %B$JIT0;
      566     7295        %U$JIT1;
      567     7369        %M$JIT2;
      568     7379        %F$JIT3;
      569     7384        %S$JIT4;
      570     7390        %J$JIT5;
      571     7478    1         2 * BIT(1);                       /* Rest of JIT not needed             */
      572     7479        %VLR_SITEINFO(FPTN = SITE_INFO);
      573     7498        /**/
      574     7499        /*  ENTRY DCLS  */
      575     7500        /**/
      576     7501        %VP_ENTRIES (OMIT=VPK$PCL_INVOCATION);
      577     7709        %INCLUDE XUG_ENTRY;
      578     7740    1   DCL FID_BUF CHAR(33) STATIC;
      579     7741    1   DCL PS_LEN UBIN WORD STATIC;
      580     7742        %FPT_LINK(FPTN = FPT_LINK,
      581     7743                  NAME = RETURN_NAME,
      582     7744                  ACCT = RETURN_ACCT);
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:142  
      583     7762    1   DCL RETURN_ASN UBIN(9) STATIC;
      584     7763        %VLP_SN(FPTN = RETURN_SN, STCLASS = STATIC);
      585     7776        %VLP_NAME(FPTN = RETURN_NAME, LEN = 31, STCLASS = STATIC);
      586     7803    1   DCL RETURN_ACCT CHAR(8) STATIC;
      587     7804    1   DCL RETURN_PASS CHAR(8) STATIC;
      588     7805    1   DCL RETURN_RES CHAR(4) STATIC;
      589     7806        %VLP_NAME(FPTN = RETURN_TRASH, LEN = 31, STCLASS = STATIC);
      590     7833    1           IF PCB.OUT$ -> OUT$BLK.NSUBLKS = 0 OR

   7833 12 000002   000003 470400 xsym               LDP0    PCB+3
        12 000003   000001 220100                    LDX0    1,,PR0
        12 000004   000010 600000 12                 TZE     s:7836
        12 000005   000003 471500                    LDP1    3,,PR0
        12 000006   100000 721100                    LXL1    0,,PR1
        12 000007   000015 601000 12                 TNZ     s:7843

      591     7834    1             PCB.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE = 0
      592     7835    2            THEN DO;                  /* User is already inside PCL, the FOOL!   */

      593     7836    2               CALL VPL$ERR_PROC(0,80,'13'O);

   7836 12 000010   000002 630400 13                 EPPR0   2
        12 000011   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 000012   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000013   000000 011000                    NOP     0

      594     7837        /*E* ERROR: VPK-00080
      595     7838           MESSAGE: You are already in PCL!!!
      596     7839        */
      597     7840    2               RETURN;

   7840 12 000014   000000 702200 xent               TSX2  ! X66_ARET

      598     7841    2               END;
      599     7842                                      /* User trying to access PCL's debugging mode   */
      600     7843    1           FPT_WRITE_ME.BUF_ = VECTOR(ME_BUF);

PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:143  
   7843 12 000015   000006 237000 13                 LDAQ    6
        12 000016   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      601     7844    1           FPT_WRITE_ME.V.DVBYTE.VFC# = %YES#;

   7844 12 000017   100000 236003                    LDQ     32768,DU
        12 000020   000013 256000 xsym               ORSQ    FPT_WRITE_ME+11

      602     7845    1           CMD$ = PCB.OUT$->OUT$BLK.SUBLK$(0);

   7845 12 000021   000003 236100                    LDQ     3,,PR0
        12 000022   000010 756000 10                 STQ     CMD$

      603     7846    1           CALL M$MONINFO(FPT_MONINFO) ALTRET (ALT);

   7846 12 000023   000050 630400 10                 EPPR0   FPT_MONINFO
        12 000024   420023 713400                    CLIMB   alt,+8211
        12 000025   402400 401760                    pmme    nvectors=6
        12 000026   000322 702000 12                 TSX2    ALT

      604     7847    1           IF (B$JIT.SWITCH & '777777777000'O) ~= TEST_PATTERN

   7847 12 000027   000000 470400 xsym               LDP0    B$JIT$
        12 000030   000031 236100                    LDQ     25,,PR0
        12 000031   000001 376000 11                 ANQ     ERRMSG_ASN+1
        12 000032   000000 116000 xsym               CMPQ    TEST_PATTERN
        12 000033   000040 600000 12                 TZE     s:7853

      605     7848    1            THEN
      606     7849    1              CALL VPL$ERR_PROC(3,60,'13'O);

   7849 12 000034   000011 630400 13                 EPPR0   9
        12 000035   000021 631400 xsym               EPPR1   B_VECTNIL+17
        12 000036   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000037   000000 011000                    NOP     0

      607     7850        /*E* ERROR: VPK-00060
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:144  
      608     7851           MESSAGE: Unauthorized of PRIVILEDGED PCL commands NOT allowed!!!
      609     7852        */
      610     7853    2           DO CASE (CMD$->OUT$BLK.CODE);   /* Select which special command & do  */

   7853 12 000040   000010 470400 10                 LDP0    CMD$
        12 000041   000000 236100                    LDQ     0,,PR0
        12 000042   777777 376007                    ANQ     -1,DL
        12 000043   000012 136007                    SBLQ    10,DL
        12 000044   000006 116007                    CMPQ    6,DL
        12 000045   000047 602006 12                 TNC     s:7853+7,QL
        12 000046   000321 710000 12                 TRA     s:7916
        12 000047   000055 710000 12                 TRA     PCL_VER
        12 000050   000215 710000 12                 TRA     PCL_TEST
        12 000051   000222 710000 12                 TRA     PCL_SHOT
        12 000052   000321 710000 12                 TRA     s:7916
        12 000053   000227 710000 12                 TRA     PCL_FCG
        12 000054   000240 710000 12                 TRA     PCL_MESS

      611     7854        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:145  
      612     7855    2            CASE (10);

      613     7856    2   PCL_VER:   CALL CONCAT(ME_BUF,'ACP-6 version ',SITE_INFO.VERSION#);

   7856 12 000055   040000 100400       PCL_VER      MLR     fill='040'O
        12 000056   000002 000016 11                 ADSC9   ERRMSG_ASN+2             cn=0,n=14
        12 000057   000154 000016 10                 ADSC9   ME_BUF                   cn=0,n=14
        12 000060   040000 100400                    MLR     fill='040'O
        12 000061   000266 000004 10                 ADSC9   SITE_INFO+52             cn=0,n=4
        12 000062   000157 400102 10                 ADSC9   ME_BUF+3                 cn=2,n=66

      614     7857    2              CALL M$WRITE(FPT_WRITE_ME);

   7857 12 000063   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000064   040001 713400                    CLIMB   write
        12 000065   401400 401760                    pmme    nvectors=4

      615     7858    2             CALL CONCAT(ME_BUF,'APCL ',ADDR(B_VERSION)->TEXT$C.TEXT,', ',PCL_VER_DAT)
              7858                       ;

   7858 12 000066   000000 236000 xsym               LDQ     B_VERSION
        12 000067   000033 772000                    QRL     27
        12 000070   040000 100400                    MLR     fill='040'O
        12 000071   000006 000005 11                 ADSC9   ERRMSG_ASN+6             cn=0,n=5
        12 000072   000154 000005 10                 ADSC9   ME_BUF                   cn=0,n=5
        12 000073   000000 620006                    EAX0    0,QL
        12 000074   040000 100440                    MLR     fill='040'O
        12 000075   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
        12 000076   000155 200113 10                 ADSC9   ME_BUF+1                 cn=1,n=75
        12 000077   000113 116007                    CMPQ    75,DL
        12 000100   000115 603000 12                 TRC     s:7859
        12 000101   777664 621006                    EAX1    -76,QL
        12 000102   777777 661003                    ERX1    -1,DU
        12 000103   040046 100400                    MLR     fill='040'O
        12 000104   000010 000002 11                 ADSC9   ERRMSG_ASN+8             cn=0,n=2
        12 000105   000155 200011 10                 ADSC9   ME_BUF+1,Q               cn=1,n=*X1
        12 000106   000111 116007                    CMPQ    73,DL
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:146  
        12 000107   000115 603000 12                 TRC     s:7859
        12 000110   777666 622006                    EAX2    -74,QL
        12 000111   777777 662003                    ERX2    -1,DU
        12 000112   040046 100400                    MLR     fill='040'O
        12 000113   000000 000010 xsym               ADSC9   PCL_VER_DAT              cn=0,n=8
        12 000114   000155 600012 10                 ADSC9   ME_BUF+1,Q               cn=3,n=*X2

      616     7859    2              CALL M$WRITE(FPT_WRITE_ME);

   7859 12 000115   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000116   040001 713400                    CLIMB   write
        12 000117   401400 401760                    pmme    nvectors=4

      617     7860    2              IF FROM_SYS

   7860 12 000120   000000 234000 xsym               SZN     FROM_SYS
        12 000121   000126 605000 12                 TPL     s:7864

      618     7861    2               THEN
      619     7862    2                 ME_BUF = 'ARunning as a processor.';

   7862 12 000122   040000 100400                    MLR     fill='040'O
        12 000123   000011 000030 11                 ADSC9   ERRMSG_ASN+9             cn=0,n=24
        12 000124   000154 000120 10                 ADSC9   ME_BUF                   cn=0,n=80
        12 000125   000131 710000 12                 TRA     s:7865

      620     7863    2               ELSE
      621     7864    2                 ME_BUF = 'ANot running as a processor.';

   7864 12 000126   040000 100400                    MLR     fill='040'O
        12 000127   000017 000034 11                 ADSC9   ERRMSG_ASN+15            cn=0,n=28
        12 000130   000154 000120 10                 ADSC9   ME_BUF                   cn=0,n=80

      622     7865    2              CALL M$WRITE(FPT_WRITE_ME);

   7865 12 000131   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000132   040001 713400                    CLIMB   write
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:147  
        12 000133   401400 401760                    pmme    nvectors=4

      623     7866    2              CALL CONCAT (ME_BUF,'ASite ',SITE_INFO.SITE_NAME#.C);

   7866 12 000134   040000 100400                    MLR     fill='040'O
        12 000135   000026 000006 11                 ADSC9   ERRMSG_ASN+22            cn=0,n=6
        12 000136   000154 000006 10                 ADSC9   ME_BUF                   cn=0,n=6
        12 000137   040000 100400                    MLR     fill='040'O
        12 000140   000203 200112 10                 ADSC9   SITE_INFO+1              cn=1,n=74
        12 000141   000155 400112 10                 ADSC9   ME_BUF+1                 cn=2,n=74

      624     7867    2              CALL M$WRITE(FPT_WRITE_ME);

   7867 12 000142   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000143   040001 713400                    CLIMB   write
        12 000144   401400 401760                    pmme    nvectors=4

      625     7868    2              CALL CONCAT(ME_BUF,'AInvocation line:  ',B$JIT$ ->

   7868 12 000145   040000 100400                    MLR     fill='040'O
        12 000146   000030 000023 11                 ADSC9   ERRMSG_ASN+24            cn=0,n=19
        12 000147   000154 000023 10                 ADSC9   ME_BUF                   cn=0,n=19
        12 000150   000000 470400 xsym               LDP0    B$JIT$
        12 000151   040000 100500                    MLR     fill='040'O
        12 000152   000033 000075                    ADSC9   27,,PR0                  cn=0,n=61
        12 000153   000160 600075 10                 ADSC9   ME_BUF+4                 cn=3,n=61

      626     7869    2                B$JIT.CCBUF);
      627     7870    2              CALL M$WRITE(FPT_WRITE_ME);

   7870 12 000154   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000155   040001 713400                    CLIMB   write
        12 000156   401400 401760                    pmme    nvectors=4

      628     7871    2              CALL BINCHAR(CONV_BUF,B$JIT$ -> B$JIT.LNKCNT);

   7871 12 000157   000000 470400 xsym               LDP0    B$JIT$
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:148  
        12 000160   000314 236100                    LDQ     204,,PR0
        12 000161   000777 376007                    ANQ     511,DL
        12 000162   000000 235003                    LDA     0,DU
        12 000163   200004 757100                    STAQ    4,,AUTO
        12 000164   000000 301500                    BTD
        12 000165   200004 000010                    NDSC9   4,,AUTO                  cn=0,s=lsgnf,sf=0,n=8
        12 000166   000200 030002 10                 NDSC9   CONV_BUF                 cn=0,s=nosgn,sf=0,n=2

      629     7872    2              CALL CONCAT(ME_BUF,'AM$LINK level = ',CONV_BUF);

   7872 12 000167   040000 100400                    MLR     fill='040'O
        12 000170   000035 000020 11                 ADSC9   ERRMSG_ASN+29            cn=0,n=16
        12 000171   000154 000020 10                 ADSC9   ME_BUF                   cn=0,n=16
        12 000172   040000 100400                    MLR     fill='040'O
        12 000173   000200 000002 10                 ADSC9   CONV_BUF                 cn=0,n=2
        12 000174   000160 000100 10                 ADSC9   ME_BUF+4                 cn=0,n=64

      630     7873    2              CALL M$WRITE(FPT_WRITE_ME);

   7873 12 000175   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000176   040001 713400                    CLIMB   write
        12 000177   401400 401760                    pmme    nvectors=4

      631     7874    2              CALL M$UNFID (FPT_UNFID);

   7874 12 000200   000126 630400 10                 EPPR0   FPT_UNFID
        12 000201   020021 713400                    CLIMB   8209
        12 000202   404400 401760                    pmme    nvectors=10

      632     7875    2              CALL CONCAT(ME_BUF,'AERRMSG file = ',FID_BUF);

   7875 12 000203   040000 100400                    MLR     fill='040'O
        12 000204   000041 000017 11                 ADSC9   ERRMSG_ASN+33            cn=0,n=15
        12 000205   000154 000017 10                 ADSC9   ME_BUF                   cn=0,n=15
        12 000206   040000 100400                    MLR     fill='040'O
        12 000207   000300 000041 10                 ADSC9   FID_BUF                  cn=0,n=33
        12 000210   000157 600101 10                 ADSC9   ME_BUF+3                 cn=3,n=65
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:149  

      633     7876    2              CALL M$WRITE(FPT_WRITE_ME);

   7876 12 000211   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000212   040001 713400                    CLIMB   write
        12 000213   401400 401760                    pmme    nvectors=4
        12 000214   000321 710000 12                 TRA     s:7916

      634     7877        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:150  
      635     7878    2            CASE (11);

   7875 12 000215                       PCL_TEST     null
      636     7879    2   PCL_TEST:  ;                            /* SET or RESET TEST MODE             */
      637     7880    2              TEST_MODE = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;

   7880 12 000215   000003 471500                    LDP1    3,,PR0
        12 000216   100000 236100                    LDQ     0,,PR1
        12 000217   777777 376007                    ANQ     -1,DL
        12 000220   000000 756000 xsym               STQ     TEST_MODE
        12 000221   000321 710000 12                 TRA     s:7916

      638     7881    2            CASE (12);

   7880 12 000222                       PCL_SHOT     null
      639     7882    2   PCL_SHOT:  ;                            /* SET or RESET ONE SHOT              */
      640     7883    2              ONE_TIME = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE;

   7883 12 000222   000003 471500                    LDP1    3,,PR0
        12 000223   100000 236100                    LDQ     0,,PR1
        12 000224   777777 376007                    ANQ     -1,DL
        12 000225   000000 756000 xsym               STQ     ONE_TIME
        12 000226   000321 710000 12                 TRA     s:7916

      641     7884        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:151  
      642     7885    2            CASE (13);

      643     7886        /*  CODE NUMBER 5 IS UNUSED */
      644     7887        %EJECT;
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:152  
      645     7888    2            CASE (14);

   7883 12 000227                       PCL_FCG      null
      646     7889    2   PCL_FCG:   ;                            /* SET or RESET FCG display on errors */
      647     7890    2              FPT_ERRMSG.V.INCLCODE# = BINBIT(CMD$ ->

   7890 12 000227   000003 471500                    LDP1    3,,PR0
        12 000230   100000 236100                    LDQ     0,,PR1
        12 000231   777777 376007                    ANQ     -1,DL
        12 000232   000043 736000                    QLS     35
        12 000233   000006 772000                    QRL     6
        12 000234   000030 676000 xsym               ERQ     FPT_ERRMSG+24
        12 000235   004000 376003                    ANQ     2048,DU
        12 000236   000030 656000 xsym               ERSQ    FPT_ERRMSG+24
        12 000237   000321 710000 12                 TRA     s:7916

      648     7891    2                OUT$BLK.SUBLK$(0) -> OUT$BLK.CODE,1);
      649     7892
      650     7893    2            CASE (15);

   7890 12 000240                       PCL_MESS     null
      651     7894    2   PCL_MESS:  ;                            /* Set M$ERRMSG file                  */
      652     7895    2              FID_BUF = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

   7895 12 000240   000003 471500                    LDP1    3,,PR0
        12 000241   100004 236100                    LDQ     4,,PR1
        12 000242   000033 772000                    QRL     27
        12 000243   000000 620006                    EAX0    0,QL
        12 000244   040000 100540                    MLR     fill='040'O
        12 000245   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        12 000246   000300 000041 10                 ADSC9   FID_BUF                  cn=0,n=33

      653     7896    2              CALL VPD$FID (FPT_FID);

   7896 12 000247   000014 630400 13                 EPPR0   12
        12 000250   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000251   000000 701000 xent               TSX1    VPD$FID
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:153  
        12 000252   000000 011000                    NOP     0

      654     7897    2              IF RESULTS.NAME

   7897 12 000253   000114 234000 10                 SZN     RESULTS
        12 000254   000261 605000 12                 TPL     s:7901

      655     7898    2               THEN
      656     7899    2                 ERRMSG_NAME = RETURN_NAME;

   7899 12 000255   000000 100400                    MLR     fill='000'O
        12 000256   000340 000040 10                 ADSC9   RETURN_NAME              cn=0,n=32
        12 000257   000000 000040 xsym               ADSC9   ERRMSG_NAME              cn=0,n=32
        12 000260   000263 710000 12                 TRA     s:7902

      657     7900    2               ELSE
      658     7901    2                 ERRMSG_NAME.LEN = 0;

   7901 12 000261   000000 236003                    LDQ     0,DU
        12 000262   000000 552040 xsym               STBQ    ERRMSG_NAME,'40'O

      659     7902    2              IF RESULTS.ACCT

   7902 12 000263   000114 236000 10                 LDQ     RESULTS
        12 000264   200000 316003                    CANQ    65536,DU
        12 000265   000272 600000 12                 TZE     s:7906

      660     7903    2               THEN
      661     7904    2                 ERRMSG_ACCT = RETURN_ACCT;

   7904 12 000266   000350 237000 10                 LDAQ    RETURN_ACCT
        12 000267   000000 755000 xsym               STA     ERRMSG_ACCT
        12 000270   000001 756000 xsym               STQ     ERRMSG_ACCT+1
        12 000271   000276 710000 12                 TRA     s:7907

      662     7905    2               ELSE
      663     7906    2                 ERRMSG_ACCT = ' ';
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:154  

   7906 12 000272   000035 235000 xsym               LDA     B_VECTNIL+29
        12 000273   000035 236000 xsym               LDQ     B_VECTNIL+29
        12 000274   000000 755000 xsym               STA     ERRMSG_ACCT
        12 000275   000001 756000 xsym               STQ     ERRMSG_ACCT+1

      664     7907    2              IF RESULTS.PASS

   7907 12 000276   000114 236000 10                 LDQ     RESULTS
        12 000277   100000 316003                    CANQ    32768,DU
        12 000300   000305 600000 12                 TZE     s:7911

      665     7908    2               THEN
      666     7909    2                 ERRMSG_PASS = RETURN_PASS;

   7909 12 000301   000352 237000 10                 LDAQ    RETURN_PASS
        12 000302   000000 755000 xsym               STA     ERRMSG_PASS
        12 000303   000001 756000 xsym               STQ     ERRMSG_PASS+1
        12 000304   000311 710000 12                 TRA     s:7912

      667     7910    2               ELSE
      668     7911    2                 ERRMSG_PASS = ' ';

   7911 12 000305   000035 235000 xsym               LDA     B_VECTNIL+29
        12 000306   000035 236000 xsym               LDQ     B_VECTNIL+29
        12 000307   000000 755000 xsym               STA     ERRMSG_PASS
        12 000310   000001 756000 xsym               STQ     ERRMSG_PASS+1

      669     7912    2              GETCMD.ERRMFID$ = CMD$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXTC$;

   7912 12 000311   000010 470400 10                 LDP0    CMD$
        12 000312   000003 471500                    LDP1    3,,PR0
        12 000313   100003 236100                    LDQ     3,,PR1
        12 000314   000002 756000 xsym               STQ     GETCMD+2

      670     7913    2              CALL XUG$SETERRMSG (GETCMD);

PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:155  
   7913 12 000315   000015 630400 13                 EPPR0   13
        12 000316   000017 631400 xsym               EPPR1   B_VECTNIL+15
        12 000317   000000 701000 xent               TSX1    XUG$SETERRMSG
        12 000320   000000 011000                    NOP     0

      671     7914    2            END;                           /* END CASE                           */

      672     7915
      673     7916    1           RETURN;

   7916 12 000321   000000 702200 xent               TSX2  ! X66_ARET

      674     7917
      675     7918    1   ALT:    CALL VPL$ERR_PROC(3,0);         /* Abort command                      */

   7918 12 000322   000016 630400 13    ALT          EPPR0   14
        12 000323   000020 631400 xsym               EPPR1   B_VECTNIL+16
        12 000324   000000 701000 xent               TSX1    VPL$ERR_PROC
        12 000325   000000 011000                    NOP     0

      676     7919    1   END VPK$PCL_INVOCATION;

   7919 12 000326   000000 702200 xent               TSX2  ! X66_ARET
      677     7920        %EOD;

PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:156  
--  Include file information  --

   XUG_ENTRY.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$PCL_INVOCATION.
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:157  

 **** Variables and constants ****

  ****  Section 010  Data  VPK$PCL_INVOCATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/c STRC(1089)  r     1 CC_BUF                    10-0-0/w PTR         r     1 CMD$
   200-0-0/c CHAR(2)     r     1 CONV_BUF                 300-0-0/c CHAR(33)    r     1 FID_BUF
    64-0-0/d STRC(864)   r     1 FPT_FID                  312-0-0/d STRC(576)   r     1 FPT_LINK
    50-0-0/d STRC(432)   r     1 FPT_MONINFO              126-0-0/d STRC(792)   r     1 FPT_UNFID
     0-0-0/d STRC(288)   r     1 FPT_YC                   154-0-0/c CHAR(80)    r     1 ME_BUF
   114-0-0/d STRC(324)   r     1 RESULTS                  350-0-0/c CHAR(8)     r     1 RETURN_ACCT
   332-0-0/w UBIN(9)     r     1 RETURN_ASN               340-0-0/c STRC(288)   r     1 RETURN_NAME
   352-0-0/c CHAR(8)     r     1 RETURN_PASS              354-0-0/c CHAR(4)     r     1 RETURN_RES
   334-0-0/d STRC(90)    r     1 RETURN_SN                355-0-0/c STRC(288)   r     1 RETURN_TRASH
   202-0-0/d STRC(2232)  r     1 SITE_INFO

  ****  Section 011 RoData VPK$PCL_INVOCATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(9)     r     1 ERRMSG_ASN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/c CHAR        r     1 B_VERSION                  0-0-0/c CHAR(8)     r     1 ERRMSG_ACCT
     0-0-0/c STRC(288)   r     1 ERRMSG_NAME                0-0-0/c CHAR(8)     r     1 ERRMSG_PASS
     0-0-0/d STRC(936)   r     1 FPT_ERRMSG                 0-0-0/d STRC(432)   r     1 FPT_WRITE_ME
     0-0-0/b BIT         r     1 FROM_SYS                   0-0-0/d STRC(1512)  r     1 GETCMD
     0-0-0/w SBIN        r     1 ONE_TIME                   0-0-0/w STRC(504)   r     1 PCB
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:158  
     0-0-0/c CHAR(8)     r     1 PCL_VER_DAT                0-0-0/w SBIN        r     1 TEST_MODE
     0-0-0/c STRC        r     1 TEST_PATTERN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(7633)  r     1 B$JIT                      0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/c ASTR(9)     r     1 TEXT$C


   Procedure VPK$PCL_INVOCATION requires 215 words for executable code.
   Procedure VPK$PCL_INVOCATION requires 6 words of local(AUTO) storage.
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:159  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:160  
          MINI XREF LISTING

ALT
      7918**LABEL    7846--CALLALT
B$JIT.CCBUF
      7300**DCL      7868>>CALLBLT
B$JIT.CPFLAGS1.SLEAZE
      7306**DCL      7306--REDEF
B$JIT.ERR.MID
      7213**DCL      7213--REDEF
B$JIT.JRESPEAK
      7374**DCL      7375--REDEF
B$JIT.LNKCNT
      7412**DCL      7871>>CALLBLT
B$JIT.PNR
      7387**DCL      7387--REDEF
B$JIT.SWITCH
      7300**DCL      7847>>IF
B$JIT$
      5986**DCL      7207--IMP-PTR  7847>>IF       7868>>CALLBLT  7871>>CALLBLT
BREAK_LOC
      5221**DCL      5221--REDEF
B_VERSION
      7200**DCL      7858--CALLBLT  7858--CALLBLT
CC_BUF.TEXT
      7106**DCL      7099--DCLINIT
CMD$
      7103**DCL      7845<<ASSIGN   7853>>DOCASE   7880>>ASSIGN   7883>>ASSIGN   7890>>ASSIGN   7895>>ASSIGN
      7895>>ASSIGN   7912>>ASSIGN
CONV_BUF
      7205**DCL      7871<<CALLBLT  7872>>CALLBLT
DEF_ICB.FID.STRING
      5819**DCL      5820--REDEF
DEV_ICB.FID.STRING
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:161  
      5705**DCL      5706--REDEF
EI_KEY.KEY
      5917**DCL      5917--REDEF    5917--REDEF    5917--REDEF
EO_OCB.TYPE
      5417**DCL      5418--REDEF
ERRMSG_ACCT
      5216**DCL      7193--DCLINIT  7904<<ASSIGN   7906<<ASSIGN
ERRMSG_ASN
      7199**DCL      7195--DCLINIT
ERRMSG_NAME
      5216**DCL      7193--DCLINIT  7899<<ASSIGN
ERRMSG_NAME.LEN
      5216**DCL      7901<<ASSIGN
ERRMSG_PASS
      5216**DCL      7194--DCLINIT  7909<<ASSIGN   7911<<ASSIGN
FID_BUF
      7740**DCL      7144--DCLINIT  7192--DCLINIT  7875>>CALLBLT  7895<<ASSIGN
FPT_CLOSE_EI.SN_
      6758**DCL      6758--REDEF
FPT_CLOSE_EI.UTL_
      6759**DCL      6759--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6773**DCL      6773--REDEF
FPT_CLOSE_EI.V.TYPE#
      6771**DCL      6771--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6768**DCL      6768--REDEF    6770--REDEF
FPT_CLOSE_PTL.SN_
      6884**DCL      6884--REDEF
FPT_CLOSE_PTL.UTL_
      6885**DCL      6885--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6899**DCL      6899--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6897**DCL      6897--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:162  
      6894**DCL      6894--REDEF    6896--REDEF
FPT_CLOSE_READ.SN_
      6800**DCL      6800--REDEF
FPT_CLOSE_READ.UTL_
      6801**DCL      6801--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6815**DCL      6815--REDEF
FPT_CLOSE_READ.V.TYPE#
      6813**DCL      6813--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6810**DCL      6810--REDEF    6812--REDEF
FPT_CLOSE_SI.SN_
      6968**DCL      6968--REDEF
FPT_CLOSE_SI.UTL_
      6969**DCL      6969--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6983**DCL      6983--REDEF
FPT_CLOSE_SI.V.TYPE#
      6981**DCL      6981--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6978**DCL      6978--REDEF    6980--REDEF
FPT_CLOSE_STD.SN_
      6926**DCL      6926--REDEF
FPT_CLOSE_STD.UTL_
      6927**DCL      6927--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6941**DCL      6941--REDEF
FPT_CLOSE_STD.V.TYPE#
      6939**DCL      6939--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6936**DCL      6936--REDEF    6938--REDEF
FPT_CLSEI_FT.SN_
      6842**DCL      6842--REDEF
FPT_CLSEI_FT.UTL_
      6843**DCL      6843--REDEF
FPT_CLSEI_FT.V.EXPIRE#
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:163  
      6857**DCL      6857--REDEF
FPT_CLSEI_FT.V.TYPE#
      6855**DCL      6855--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6852**DCL      6852--REDEF    6854--REDEF
FPT_ERRMSG.V.INCLCODE#
      6099**DCL      7890<<ASSIGN
FPT_FID
      7144**DCL      7896<>CALL
FPT_FID.V
      7148**DCL      7144--DCLINIT
FPT_LINK.V
      7759**DCL      7759--DCLINIT
FPT_MONINFO
      7120**DCL      7846<>CALL
FPT_OPEN_EI.ACSVEH_
      6413**DCL      6414--REDEF
FPT_OPEN_EI.ALTKEYS_
      6419**DCL      6420--REDEF    6420--REDEF
FPT_OPEN_EI.HDR_
      6418**DCL      6419--REDEF
FPT_OPEN_EI.TAB_
      6417**DCL      6418--REDEF
FPT_OPEN_EI.UHL_
      6411**DCL      6412--REDEF    6412--REDEF
FPT_OPEN_EI.V.FSN#
      6451**DCL      6451--REDEF    6451--REDEF
FPT_OPEN_EI.WSN_
      6417**DCL      6417--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6522**DCL      6523--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6528**DCL      6529--REDEF    6529--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6527**DCL      6528--REDEF
FPT_OPEN_EI_SAVE.TAB_
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:164  
      6526**DCL      6527--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6520**DCL      6521--REDEF    6521--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6560**DCL      6560--REDEF    6560--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6526**DCL      6526--REDEF
FPT_OPEN_OUT.ACSVEH_
      6304**DCL      6305--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6310**DCL      6311--REDEF    6311--REDEF
FPT_OPEN_OUT.HDR_
      6309**DCL      6310--REDEF
FPT_OPEN_OUT.TAB_
      6308**DCL      6309--REDEF
FPT_OPEN_OUT.UHL_
      6302**DCL      6303--REDEF    6303--REDEF
FPT_OPEN_OUT.V.FSN#
      6342**DCL      6342--REDEF    6342--REDEF
FPT_OPEN_OUT.WSN_
      6308**DCL      6308--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6195**DCL      6196--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6201**DCL      6202--REDEF    6202--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6200**DCL      6201--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6199**DCL      6200--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6193**DCL      6194--REDEF    6194--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6233**DCL      6233--REDEF    6233--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6199**DCL      6199--REDEF
FPT_READ_STD.STATION_
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:165  
      6623**DCL      6624--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6635**DCL      6635--REDEF
FPT_READ_STD.V.INDX#
      6633**DCL      6633--REDEF
FPT_READ_UC.STATION_
      6584**DCL      6585--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6596**DCL      6596--REDEF
FPT_READ_UC.V.INDX#
      6594**DCL      6594--REDEF
FPT_UNFID
      7192**DCL      7874<>CALL
FPT_UNFID.V
      7196**DCL      7192--DCLINIT
FPT_WRITE_ME
      6690**DCL      7857<>CALL     7859<>CALL     7865<>CALL     7867<>CALL     7870<>CALL     7873<>CALL
      7876<>CALL
FPT_WRITE_ME.BUF_
      6690**DCL      7843<<ASSIGN
FPT_WRITE_ME.STATION_
      6692**DCL      6692--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6699**DCL      6699--REDEF    7844<<ASSIGN
FPT_WRITE_OUT.STATION_
      6723**DCL      6723--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6730**DCL      6730--REDEF
FPT_WRITE_UC.STATION_
      6661**DCL      6661--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6668**DCL      6668--REDEF
FPT_YC.V
      7100**DCL      7099--DCLINIT
FROM_SN.SN
      5567**DCL      5568--REDEF
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:166  
FROM_SYS
      5220**DCL      7860>>IF
GETCMD
      4769**DCL      7913<>CALL
GETCMD.ERRMFID$
      4788**DCL      7912<<ASSIGN
GETCMD.OUT$
      4774**DCL      4780--REDEF
ICB.FID.STRING
      5591**DCL      5592--REDEF
IFSFA_PARAM.EOMCHAR#
      5946**DCL      5947--REDEF
IFSFA_PARAM.SIG1
      5940**DCL      5940--REDEF
IFSFA_PARAM.SIG2
      5940**DCL      5941--REDEF
IN_RES
      5513**DCL      5513--REDEF
IN_SN.SN
      5529**DCL      5530--REDEF
M$MONINFO
        99**DCL-ENT  7846--CALL
M$UNFID
        94**DCL-ENT  7874--CALL
M$WRITE
        32**DCL-ENT  7857--CALL     7859--CALL     7865--CALL     7867--CALL     7870--CALL     7873--CALL
      7876--CALL
ME_BUF
      7204**DCL      7843--ASSIGN   7856<<CALLBLT  7858<<CALLBLT  7862<<ASSIGN   7864<<ASSIGN   7866<<CALLBLT
      7868<<CALLBLT  7872<<CALLBLT  7875<<CALLBLT
OCB.TYPE
      5275**DCL      5276--REDEF
OFSFA_PARAM.EOMCHAR#
      5976**DCL      5977--REDEF
OFSFA_PARAM.SIG1
      5970**DCL      5970--REDEF
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:167  
OFSFA_PARAM.SIG2
      5970**DCL      5971--REDEF
ONE_TIME
      5226**DCL      7883<<ASSIGN
OUT$BLK.CODE
      7016**DCL      7833>>IF       7853>>DOCASE   7880>>ASSIGN   7883>>ASSIGN   7890>>ASSIGN
OUT$BLK.NSUBLKS
      7020**DCL      7833>>IF
OUT$BLK.SUBLK$
      7041**DCL      7833>>IF       7845>>ASSIGN   7880>>ASSIGN   7883>>ASSIGN   7890>>ASSIGN   7895>>ASSIGN
      7895>>ASSIGN   7912>>ASSIGN
OUT$SYM.COUNT
      7077**DCL      7080--IMP-SIZ  7895>>ASSIGN
OUT$SYM.TEXT
      7080**DCL      7895>>ASSIGN
OUT$SYM.TEXTC$
      7072**DCL      7912>>ASSIGN
OUT_SN.SN
      5547**DCL      5548--REDEF
PCB.OUT$
      4588**DCL      7833>>IF       7833>>IF       7845>>ASSIGN
PCL_VER_DAT
      5220**DCL      7858>>CALLBLT
RESULTS
      7167**DCL      7148--DCLINIT
RESULTS.ACCT
      7167**DCL      7902>>IF
RESULTS.NAME
      7167**DCL      7897>>IF
RESULTS.PASS
      7167**DCL      7907>>IF
RETURN_ACCT
      7803**DCL      7145--DCLINIT  7757--DCLINIT  7904>>ASSIGN
RETURN_ASN
      7762**DCL      7147--DCLINIT
RETURN_NAME
PL6.E3A0      #004=VPK$PCL_INVOCATION File=VPK$CMDS.:E05TSI                      WED 07/30/97 07:57 Page:168  
      7801**DCL      7145--DCLINIT  7757--DCLINIT  7899>>ASSIGN
RETURN_PASS
      7804**DCL      7146--DCLINIT  7909>>ASSIGN
RETURN_RES
      7805**DCL      7147--DCLINIT
RETURN_SN
      7774**DCL      7146--DCLINIT
RETURN_TRASH
      7831**DCL      7146--DCLINIT
SITE_INFO
      7490**DCL      7120--DCLINIT
SITE_INFO.SITE_NAME#.C
      7491**DCL      7866>>CALLBLT
SITE_INFO.VERSION#
      7493**DCL      7856>>CALLBLT
SPEC_BUF
      5225**DCL      5225--REDEF
TEST_MODE
      5220**DCL      7880<<ASSIGN
TEST_PATTERN
      5217**DCL      7847>>IF
TEXT$C.COUNT
      7202**DCL      7203--IMP-SIZ  7858>>CALLBLT
TEXT$C.TEXT
      7203**DCL      7858>>CALLBLT
VPD$FID
      7541**DCL-ENT  7896--CALL
VPL$ERR_PROC
      7683**DCL-ENT  7836--CALL     7849--CALL     7918--CALL
XUG$SETERRMSG
      7724**DCL-ENT  7913--CALL

PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:169  
      678        1        /*T***********************************************************/
      679        2        /*T*                                                         */
      680        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      681        4        /*T*                                                         */
      682        5        /*T***********************************************************/
      683        6        VPK$READ: PROC;
      684        7        /*D* NAME: VPK$READ
      685        8             CALL: CALL VPK$READ;
      686        9             DESCRIPTION: VPK$READ performs the READ command by processing
      687       10                          the input disk fid and opening it to M$SI.
      688       11        */
      689       12        %INCLUDE VP_DATA_R;
      690     6999        %INCLUDE F$DCB;
      691     7048        %FPT_OPEN(FPTN = FPT_OPEN_READ,
      692     7049                  NAME = IN_NAME,
      693     7050                  ACCT = IN_ACCT,
      694     7051                  PASS = IN_PASS,
      695     7052                  SN = IN_SN,
      696     7053                  SCRUB = YES,
      697     7054                  DCB = M$READFILE,
      698     7055                  FUN = IN,
      699     7056                  ASN = FILE,
      700     7057                  STCLASS = STATIC);
      701     7166        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      702     7204        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      703     7249        %VP_ENTRIES (OMIT=VPK$READ);
      704     7457    1           FPT_FID_IN.TEXTFID_ = VECTOR(PCB.OUT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
      705     7458    1           CALL M$FID(FPT_FID_IN) ALTRET(MONERR);
      706     7459    1           IF IN_ASN ~= %FILE#
      707     7460    1             OR ~RESULTS_FID_IN.NAME
      708     7461    1             OR RESULTS_FID_IN.WSN
      709     7462    1            THEN                           /* Not a decent READ fid              */
      710     7463    1              CALL VPL$ERR_PROC(3,50,'13'O);
      711     7464        /*E* ERROR:   VPK-00050
      712     7465             MESSAGE: READ requires a disk fid
      713     7466        */
      714     7467    1           IF M$READFILE$ -> F$DCB.FCD
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:170  
      715     7468    1            THEN
      716     7469    1              CALL M$CLOSE(FPT_CLOSE_READ) ALTRET(MONERR); /* CLOSE old cmd file */
      717     7470    1           CALL M$OPEN(FPT_OPEN_READ) ALTRET(MONERR); /* OPEN new command stream */
      718     7471    1           READ_FILE = '1'B;
      719     7472    1           RETURN;
      720     7473
      721     7474    1   MONERR:
      722     7475    1           CALL VPL$ERR_PROC(3,0);
      723     7476    1   END VPK$READ;
      724     7477        %EOD;

PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:171  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$READ.

   Procedure VPK$READ requires 51 words for executable code.
   Procedure VPK$READ requires 6 words of local(AUTO) storage.

PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:172  

 Object Unit name= VPK$READ                                   File name= VPK$CMDS.:E05TOU
 UTS= JUL 30 '97 07:59:50.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none    58     72  VPK$READ
   11   Proc  even  none    51     63  VPK$READ
   12  RoData even  none     8     10  VPK$READ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        0  VPK$READ
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:173  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       8 VPL$ERR_PROC
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  READ_FILE                             PCB
     BREAK_LOC                             BREAK_MESSAGE_REPORTER                SPEC_BUF
     IN_NAME                               IN_ACCT                               IN_PASS
     IN_RES                                IN_SN                                 IN_ASN
     M$EI                                  M$EO                                  M$EO1
     M$ME                                  M$SI                                  M$READFILE
     M$READFILE$                           M$DO                                  M$STD1
     M$SORT1                               FPT_FID_IN                            RESULTS_FID_IN
r    FPT_CLOSE_READ                        B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:174  


      678        1        /*T***********************************************************/
      679        2        /*T*                                                         */
      680        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      681        4        /*T*                                                         */
      682        5        /*T***********************************************************/
      683        6        VPK$READ: PROC;

      6 11 000000   000000 700200 xent  VPK$READ     TSX0  ! X66_AUTO_0
        11 000001   000006 000000                    ZERO    6,0

      684        7        /*D* NAME: VPK$READ
      685        8             CALL: CALL VPK$READ;
      686        9             DESCRIPTION: VPK$READ performs the READ command by processing
      687       10                          the input disk fid and opening it to M$SI.
      688       11        */
      689       12        %INCLUDE VP_DATA_R;
      690     6999        %INCLUDE F$DCB;
      691     7048        %FPT_OPEN(FPTN = FPT_OPEN_READ,
      692     7049                  NAME = IN_NAME,
      693     7050                  ACCT = IN_ACCT,
      694     7051                  PASS = IN_PASS,
      695     7052                  SN = IN_SN,
      696     7053                  SCRUB = YES,
      697     7054                  DCB = M$READFILE,
      698     7055                  FUN = IN,
      699     7056                  ASN = FILE,
      700     7057                  STCLASS = STATIC);
      701     7166        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      702     7204        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      703     7249        %VP_ENTRIES (OMIT=VPK$READ);
      704     7457    1           FPT_FID_IN.TEXTFID_ = VECTOR(PCB.OUT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

   7457 11 000002   000003 470400 xsym               LDP0    PCB+3
        11 000003   000003 471500                    LDP1    3,,PR0
        11 000004   100004 236100                    LDQ     4,,PR1
        11 000005   000033 772000                    QRL     27
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:175  
        11 000006   000064 737000                    LLS     52
        11 000007   000140 135007                    SBLA    96,DL
        11 000010   200004 451500                    STP1    4,,AUTO
        11 000011   200004 236100                    LDQ     4,,AUTO
        11 000012   000000 036000 12                 ADLQ    0
        11 000013   000002 757000 xsym               STAQ    FPT_FID_IN+2

      705     7458    1           CALL M$FID(FPT_FID_IN) ALTRET(MONERR);

   7458 11 000014   000000 630400 xsym               EPPR0   FPT_FID_IN
        11 000015   420001 713400                    CLIMB   alt,+8193
        11 000016   404400 401760                    pmme    nvectors=10
        11 000017   000056 702000 11                 TSX2    MONERR

      706     7459    1           IF IN_ASN ~= %FILE#

   7459 11 000020   000000 236000 xsym               LDQ     IN_ASN
        11 000021   777000 376003                    ANQ     -512,DU
        11 000022   001000 116003                    CMPQ    512,DU
        11 000023   000033 601000 11                 TNZ     s:7463
        11 000024   000000 236000 xsym               LDQ     RESULTS_FID_IN
        11 000025   400000 376003                    ANQ     -131072,DU
        11 000026   400000 676003                    ERQ     -131072,DU
        11 000027   000033 601000 11                 TNZ     s:7463
        11 000030   000000 236000 xsym               LDQ     RESULTS_FID_IN
        11 000031   020000 316003                    CANQ    8192,DU
        11 000032   000037 600000 11                 TZE     s:7467

      707     7460    1             OR ~RESULTS_FID_IN.NAME
      708     7461    1             OR RESULTS_FID_IN.WSN
      709     7462    1            THEN                           /* Not a decent READ fid              */
      710     7463    1              CALL VPL$ERR_PROC(3,50,'13'O);

   7463 11 000033   000003 630400 12                 EPPR0   3
        11 000034   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000035   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000036   000000 011000                    NOP     0
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:176  

      711     7464        /*E* ERROR:   VPK-00050
      712     7465             MESSAGE: READ requires a disk fid
      713     7466        */
      714     7467    1           IF M$READFILE$ -> F$DCB.FCD

   7467 11 000037   000000 470400 xsym               LDP0    M$READFILE$
        11 000040   000031 236100                    LDQ     25,,PR0
        11 000041   020000 316007                    CANQ    8192,DL
        11 000042   000047 600000 11                 TZE     s:7470

      715     7468    1            THEN
      716     7469    1              CALL M$CLOSE(FPT_CLOSE_READ) ALTRET(MONERR); /* CLOSE old cmd file */

   7469 11 000043   000000 630400 xsym               EPPR0   FPT_CLOSE_READ
        11 000044   450001 713400                    CLIMB   alt,close
        11 000045   406000 401760                    pmme    nvectors=13
        11 000046   000056 702000 11                 TSX2    MONERR

      717     7470    1           CALL M$OPEN(FPT_OPEN_READ) ALTRET(MONERR); /* OPEN new command stream */

   7470 11 000047   000000 630400 10                 EPPR0   FPT_OPEN_READ
        11 000050   450000 713400                    CLIMB   alt,open
        11 000051   410400 401760                    pmme    nvectors=18
        11 000052   000056 702000 11                 TSX2    MONERR

      718     7471    1           READ_FILE = '1'B;

   7471 11 000053   400000 236003                    LDQ     -131072,DU
        11 000054   000000 756000 xsym               STQ     READ_FILE

      719     7472    1           RETURN;

   7472 11 000055   000000 702200 xent               TSX2  ! X66_ARET

      720     7473
      721     7474    1   MONERR:
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:177  
      722     7475    1           CALL VPL$ERR_PROC(3,0);

   7475 11 000056   000006 630400 12    MONERR       EPPR0   6
        11 000057   000020 631400 xsym               EPPR1   B_VECTNIL+16
        11 000060   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000061   000000 011000                    NOP     0

      723     7476    1   END VPK$READ;

   7476 11 000062   000000 702200 xent               TSX2  ! X66_ARET
      724     7477        %EOD;

PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:178  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$READ.
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:179  

 **** Variables and constants ****

  ****  Section 010  Data  VPK$READ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 FPT_OPEN_READ

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/d STRC(1080)  r     1 FPT_CLOSE_READ             0-0-0/d STRC(864)   r     1 FPT_FID_IN
     0-0-0/c CHAR(8)     r     1 IN_ACCT                    0-0-0/b UBIN(9)     r     1 IN_ASN
     0-0-0/c STRC(288)   r     1 IN_NAME                    0-0-0/c CHAR(8)     r     1 IN_PASS
     0-0-0/w STRC(1116)  r     1 IN_SN                      0-0-0/w PTR         r     1 M$READFILE$
     0-0-0/w STRC(504)   r     1 PCB                        0-0-0/b BIT         r     1 READ_FILE
     0-0-0/d STRC(324)   r     1 RESULTS_FID_IN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$READFILE
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure VPK$READ requires 51 words for executable code.
   Procedure VPK$READ requires 6 words of local(AUTO) storage.
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:180  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:181  
          MINI XREF LISTING

BREAK_LOC
      5219**DCL      5219--REDEF
DEF_ICB.FID.STRING
      5817**DCL      5818--REDEF
DEV_ICB.FID.STRING
      5703**DCL      5704--REDEF
EI_KEY.KEY
      5915**DCL      5915--REDEF    5915--REDEF    5915--REDEF
EO_OCB.TYPE
      5415**DCL      5416--REDEF
F$DCB.ACTPOS
      7025**DCL      7025--REDEF
F$DCB.ARS
      7000**DCL      7000--REDEF
F$DCB.ATTR
      7018**DCL      7019--REDEF
F$DCB.BORROW
      7033**DCL      7033--REDEF    7033--REDEF    7033--REDEF
F$DCB.DCBNAME.L
      7047**DCL      7047--IMP-SIZ
F$DCB.EOMCHAR
      7004**DCL      7004--REDEF
F$DCB.FCD
      7013**DCL      7467>>IF
F$DCB.FLDID
      7028**DCL      7028--REDEF
F$DCB.FORM$
      7022**DCL      7022--REDEF
F$DCB.FSECT
      7038**DCL      7038--REDEF
F$DCB.FSN
      7015**DCL      7015--REDEF    7015--REDEF    7016--REDEF
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:182  
F$DCB.HEADER$
      7021**DCL      7021--REDEF
F$DCB.IXTNSIZE
      7019**DCL      7019--REDEF
F$DCB.LASTSTA$
      7009**DCL      7009--REDEF
F$DCB.LVL
      7034**DCL      7034--REDEF
F$DCB.NAME.C
      7009**DCL      7009--REDEF
F$DCB.NOEOF
      7030**DCL      7030--REDEF
F$DCB.NRECS
      7020**DCL      7020--REDEF
F$DCB.NRECX
      7039**DCL      7039--REDEF
F$DCB.OHDR
      7031**DCL      7031--REDEF
F$DCB.ORG
      7014**DCL      7014--REDEF
F$DCB.PRECNO
      7037**DCL      7037--REDEF
F$DCB.RCSZ
      7042**DCL      7042--REDEF
F$DCB.RES
      7010**DCL      7010--REDEF
F$DCB.SETX
      7022**DCL      7022--REDEF
F$DCB.TAB$
      7021**DCL      7022--REDEF
F$DCB.TDA
      7036**DCL      7036--REDEF
F$DCB.WSN
      7011**DCL      7011--REDEF
FPT_CLOSE_EI.SN_
      6756**DCL      6756--REDEF
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:183  
FPT_CLOSE_EI.UTL_
      6757**DCL      6757--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6771**DCL      6771--REDEF
FPT_CLOSE_EI.V.TYPE#
      6769**DCL      6769--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6766**DCL      6766--REDEF    6768--REDEF
FPT_CLOSE_PTL.SN_
      6882**DCL      6882--REDEF
FPT_CLOSE_PTL.UTL_
      6883**DCL      6883--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6897**DCL      6897--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6895**DCL      6895--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6892**DCL      6892--REDEF    6894--REDEF
FPT_CLOSE_READ
      6798**DCL      7469<>CALL
FPT_CLOSE_READ.SN_
      6798**DCL      6798--REDEF
FPT_CLOSE_READ.UTL_
      6799**DCL      6799--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6813**DCL      6813--REDEF
FPT_CLOSE_READ.V.TYPE#
      6811**DCL      6811--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6808**DCL      6808--REDEF    6810--REDEF
FPT_CLOSE_SI.SN_
      6966**DCL      6966--REDEF
FPT_CLOSE_SI.UTL_
      6967**DCL      6967--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6981**DCL      6981--REDEF
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:184  
FPT_CLOSE_SI.V.TYPE#
      6979**DCL      6979--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6976**DCL      6976--REDEF    6978--REDEF
FPT_CLOSE_STD.SN_
      6924**DCL      6924--REDEF
FPT_CLOSE_STD.UTL_
      6925**DCL      6925--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6939**DCL      6939--REDEF
FPT_CLOSE_STD.V.TYPE#
      6937**DCL      6937--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6934**DCL      6934--REDEF    6936--REDEF
FPT_CLSEI_FT.SN_
      6840**DCL      6840--REDEF
FPT_CLSEI_FT.UTL_
      6841**DCL      6841--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6855**DCL      6855--REDEF
FPT_CLSEI_FT.V.TYPE#
      6853**DCL      6853--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6850**DCL      6850--REDEF    6852--REDEF
FPT_FID_IN
      5998**DCL      7458<>CALL
FPT_FID_IN.TEXTFID_
      5998**DCL      7457<<ASSIGN
FPT_OPEN_EI.ACSVEH_
      6411**DCL      6412--REDEF
FPT_OPEN_EI.ALTKEYS_
      6417**DCL      6418--REDEF    6418--REDEF
FPT_OPEN_EI.HDR_
      6416**DCL      6417--REDEF
FPT_OPEN_EI.TAB_
      6415**DCL      6416--REDEF
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:185  
FPT_OPEN_EI.UHL_
      6409**DCL      6410--REDEF    6410--REDEF
FPT_OPEN_EI.V.FSN#
      6449**DCL      6449--REDEF    6449--REDEF
FPT_OPEN_EI.WSN_
      6415**DCL      6415--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6520**DCL      6521--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6526**DCL      6527--REDEF    6527--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6525**DCL      6526--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6524**DCL      6525--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6518**DCL      6519--REDEF    6519--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6558**DCL      6558--REDEF    6558--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6524**DCL      6524--REDEF
FPT_OPEN_OUT.ACSVEH_
      6302**DCL      6303--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6308**DCL      6309--REDEF    6309--REDEF
FPT_OPEN_OUT.HDR_
      6307**DCL      6308--REDEF
FPT_OPEN_OUT.TAB_
      6306**DCL      6307--REDEF
FPT_OPEN_OUT.UHL_
      6300**DCL      6301--REDEF    6301--REDEF
FPT_OPEN_OUT.V.FSN#
      6340**DCL      6340--REDEF    6340--REDEF
FPT_OPEN_OUT.WSN_
      6306**DCL      6306--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6193**DCL      6194--REDEF
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:186  
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6199**DCL      6200--REDEF    6200--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6198**DCL      6199--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6197**DCL      6198--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6191**DCL      6192--REDEF    6192--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6231**DCL      6231--REDEF    6231--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6197**DCL      6197--REDEF
FPT_OPEN_READ
      7122**DCL      7470<>CALL
FPT_OPEN_READ.ACSVEH_
      7124**DCL      7125--REDEF
FPT_OPEN_READ.ALTKEYS_
      7130**DCL      7131--REDEF    7131--REDEF
FPT_OPEN_READ.HDR_
      7129**DCL      7130--REDEF
FPT_OPEN_READ.TAB_
      7128**DCL      7129--REDEF
FPT_OPEN_READ.UHL_
      7122**DCL      7123--REDEF    7123--REDEF
FPT_OPEN_READ.V
      7131**DCL      7122--DCLINIT
FPT_OPEN_READ.V.FSN#
      7162**DCL      7162--REDEF    7162--REDEF
FPT_OPEN_READ.WSN_
      7128**DCL      7128--REDEF
FPT_READ_STD.STATION_
      6621**DCL      6622--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6633**DCL      6633--REDEF
FPT_READ_STD.V.INDX#
      6631**DCL      6631--REDEF
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:187  
FPT_READ_UC.STATION_
      6582**DCL      6583--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6594**DCL      6594--REDEF
FPT_READ_UC.V.INDX#
      6592**DCL      6592--REDEF
FPT_WRITE_ME.STATION_
      6690**DCL      6690--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6697**DCL      6697--REDEF
FPT_WRITE_OUT.STATION_
      6721**DCL      6721--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6728**DCL      6728--REDEF
FPT_WRITE_UC.STATION_
      6659**DCL      6659--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6666**DCL      6666--REDEF
FROM_SN.SN
      5565**DCL      5566--REDEF
GETCMD.OUT$
      4772**DCL      4778--REDEF
ICB.FID.STRING
      5589**DCL      5590--REDEF
IFSFA_PARAM.EOMCHAR#
      5944**DCL      5945--REDEF
IFSFA_PARAM.SIG1
      5938**DCL      5938--REDEF
IFSFA_PARAM.SIG2
      5938**DCL      5939--REDEF
IN_ACCT
      5510**DCL      7127--DCLINIT
IN_ASN
      5548**DCL      7459>>IF
IN_NAME
      5510**DCL      7123--DCLINIT
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:188  
IN_PASS
      5511**DCL      7124--DCLINIT
IN_RES
      5511**DCL      5511--REDEF
IN_SN
      5522**DCL      7122--DCLINIT
IN_SN.SN
      5527**DCL      5528--REDEF
M$CLOSE
        29**DCL-ENT  7469--CALL
M$FID
        92**DCL-ENT  7458--CALL
M$OPEN
        29**DCL-ENT  7470--CALL
M$READFILE$
      5982**DCL      7467>>IF
MONERR
      7475**LABEL    7458--CALLALT  7469--CALLALT  7470--CALLALT
OCB.TYPE
      5273**DCL      5274--REDEF
OFSFA_PARAM.EOMCHAR#
      5974**DCL      5975--REDEF
OFSFA_PARAM.SIG1
      5968**DCL      5968--REDEF
OFSFA_PARAM.SIG2
      5968**DCL      5969--REDEF
OUT$BLK.SUBLK$
      7243**DCL      7457>>ASSIGN   7457>>ASSIGN
OUT$SYM.COUNT
      7196**DCL      7199--IMP-SIZ  7457>>ASSIGN
OUT$SYM.TEXT
      7199**DCL      7457--ASSIGN
OUT_SN.SN
      5545**DCL      5546--REDEF
PCB.OUT$
      4586**DCL      7457>>ASSIGN   7457>>ASSIGN
PL6.E3A0      #005=VPK$READ File=VPK$CMDS.:E05TSI                                WED 07/30/97 07:59 Page:189  
READ_FILE
      4554**DCL      7471<<ASSIGN
RESULTS_FID_IN.NAME
      6021**DCL      7459>>IF
RESULTS_FID_IN.WSN
      6021**DCL      7459>>IF
SPEC_BUF
      5223**DCL      5223--REDEF
VPL$ERR_PROC
      7431**DCL-ENT  7463--CALL     7475--CALL

PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:190  
      725        1        /*T***********************************************************/
      726        2        /*T*                                                         */
      727        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      728        4        /*T*                                                         */
      729        5        /*T***********************************************************/
      730        6        VPK$STATUS: PROC;
      731        7        /*D* NAME: VPK$STATUS
      732        8             CALL: CALL VPK$STATUS
      733        9             DESCRIPTION: This proc drives the PCL 'STATUS' command.
      734       10        */
      735       11        %INCLUDE VP_DATA_R;
      736     6998        %INCLUDE F$DCB;
      737     7047        %FPT_UNFID(FPTN = FPT_UNFID_EO,
      738     7048                   DCB = M$EO,
      739     7049                   STCLASS = STATIC,
      740     7050                   TEXTFID = TEXT_EO);
      741     7068        %VP_ENTRIES (OMIT=VPK$STATUS);
      742     7276    1   DCL T_COUNT SBIN WORD STATIC;
      743     7277    1   DCL CONV_BUF CHAR(1) STATIC;
      744     7278    1   DCL ME_BUF CHAR(80) STATIC;             /* Use VFC for space 1 after print    */
      745     7279    1   DCL TEXT_EO CHAR(60) STATIC;
      746     7280    1           FPT_WRITE_ME.BUF_ = VECTOR(ME_BUF);
      747     7281    1           FPT_WRITE_ME.V.DVBYTE.VFC# = %YES#;
      748     7282    1           CALL M$UNFID(FPT_UNFID_EO);
      749     7283    1           CALL CONCAT(ME_BUF,'ADefault COPY destination is ',TEXT_EO);
      750     7284    1           CALL M$WRITE(FPT_WRITE_ME);
      751     7285    1           ME_BUF = 'ASeverity ';
      752     7286    1           T_COUNT = 16;                   /* Place to put [N]STEPCC             */
      753     7287    2           DO CASE(ERROR_SEVERITY);
      754     7288    2            CASE(1);                       /* SEVERITY ABORT specified           */
      755     7289    2              CALL INSERT(ME_BUF,10,,'abort');
      756     7290    2            CASE(2);                       /* SEVERITY CONTINUE specified        */
      757     7291    2              CALL INSERT(ME_BUF,10,,'continue');
      758     7292    2              T_COUNT = T_COUNT +3;
      759     7293    2            CASE(3);                       /* SEVERITY ERROR specified           */
      760     7294    2              CALL INSERT(ME_BUF,10,,'error');
      761     7295    2              T_COUNT = T_COUNT + 1;
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:191  
      762     7296    2            END;
      763     7297    1           IF HIGHEST_SEVERITY = -1
      764     7298    1            THEN                           /* NO STEPCC setting requested        */
      765     7299    1              CALL INSERT(ME_BUF,T_COUNT,,'nstepcc');
      766     7300    1            ELSE                           /* STEPCC setting requested           */
      767     7301    2            DO;
      768     7302    2               CALL INSERT(ME_BUF,T_COUNT,,'stepcc');
      769     7303    2               CALL M$WRITE(FPT_WRITE_ME);
      770     7304    2               CALL BINCHAR(CONV_BUF,HIGHEST_SEVERITY);
      771     7305    2               CALL CONCAT(ME_BUF,'AHighest encountered severity was ',CONV_BUF);
      772     7306    2               END;
      773     7307    1           CALL M$WRITE(FPT_WRITE_ME);
      774     7308    1           IF ERR_SAVE_REL = 1
      775     7309    1            THEN                           /* ERRORS SAVE specified              */
      776     7310    1              ME_BUF = 'AErrors save';
      777     7311    1            ELSE                           /* ERRORS RELEASE specified           */
      778     7312    1              ME_BUF = 'AErrors release';
      779     7313    1           CALL M$WRITE (FPT_WRITE_ME);
      780     7314    1           IF ONE_TIME = 1
      781     7315    1            THEN                           /* Tell him that this is a ONE SHOT   */
      782     7316    2            DO;
      783     7317    2               ME_BUF = 'AOne-shot on';
      784     7318    2               CALL M$WRITE (FPT_WRITE_ME);
      785     7319    2               END;
      786     7320    1           IF TEST_MODE = 1
      787     7321    1            THEN                           /* Tell him that TEST MODE is on      */
      788     7322    2            DO;
      789     7323    2               ME_BUF = 'ATest mode on';
      790     7324    2               CALL M$WRITE (FPT_WRITE_ME);
      791     7325    2               END;
      792     7326    1           IF FPT_ERRMSG.V.INCLCODE# = '1'B
      793     7327    1            THEN                           /* Tell him that FCG DISPLAY is on    */
      794     7328    2            DO;
      795     7329    2               ME_BUF = 'AFCG display on';
      796     7330    2               CALL M$WRITE (FPT_WRITE_ME);
      797     7331    2               END;
      798     7332    1           RETURN;
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:192  
      799     7333    1   END VPK$STATUS;
      800     7334        %EOD;

PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:193  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$STATUS.

   Procedure VPK$STATUS requires 119 words for executable code.
   Procedure VPK$STATUS requires 4 words of local(AUTO) storage.

PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:194  

 Object Unit name= VPK$STATUS                                 File name= VPK$CMDS.:E05TOU
 UTS= JUL 30 '97 08:02:06.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10   Data  even  none    59     73  VPK$STATUS
   11  RoData even  UTS     48     60  VPK$STATUS
   12   Proc  even  none   119    167  VPK$STATUS
   13  RoData even  none     2      2  VPK$STATUS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        0  VPK$STATUS
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:195  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  ERROR_SEVERITY                        HIGHEST_SEVERITY
     ERR_SAVE_REL                          TEST_MODE                             BREAK_LOC
     BREAK_MESSAGE_REPORTER                SPEC_BUF                              ONE_TIME
     IN_RES                                M$EI                                  M$EO
     M$EO1                                 M$ME                                  M$SI
     M$READFILE                            M$DO                                  M$STD1
     M$SORT1                               FPT_ERRMSG                            FPT_WRITE_ME
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:196  


      725        1        /*T***********************************************************/
      726        2        /*T*                                                         */
      727        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      728        4        /*T*                                                         */
      729        5        /*T***********************************************************/
      730        6        VPK$STATUS: PROC;

      6 12 000000   000000 700200 xent  VPK$STATUS   TSX0  ! X66_AUTO_0
        12 000001   000004 000000                    ZERO    4,0

      731        7        /*D* NAME: VPK$STATUS
      732        8             CALL: CALL VPK$STATUS
      733        9             DESCRIPTION: This proc drives the PCL 'STATUS' command.
      734       10        */
      735       11        %INCLUDE VP_DATA_R;
      736     6998        %INCLUDE F$DCB;
      737     7047        %FPT_UNFID(FPTN = FPT_UNFID_EO,
      738     7048                   DCB = M$EO,
      739     7049                   STCLASS = STATIC,
      740     7050                   TEXTFID = TEXT_EO);
      741     7068        %VP_ENTRIES (OMIT=VPK$STATUS);
      742     7276    1   DCL T_COUNT SBIN WORD STATIC;
      743     7277    1   DCL CONV_BUF CHAR(1) STATIC;
      744     7278    1   DCL ME_BUF CHAR(80) STATIC;             /* Use VFC for space 1 after print    */
      745     7279    1   DCL TEXT_EO CHAR(60) STATIC;
      746     7280    1           FPT_WRITE_ME.BUF_ = VECTOR(ME_BUF);

   7280 12 000002   000000 237000 13                 LDAQ    0
        12 000003   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      747     7281    1           FPT_WRITE_ME.V.DVBYTE.VFC# = %YES#;

   7281 12 000004   100000 236003                    LDQ     32768,DU
        12 000005   000013 256000 xsym               ORSQ    FPT_WRITE_ME+11

      748     7282    1           CALL M$UNFID(FPT_UNFID_EO);
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:197  

   7282 12 000006   000000 630400 10                 EPPR0   FPT_UNFID_EO
        12 000007   020021 713400                    CLIMB   8209
        12 000010   404400 401760                    pmme    nvectors=10

      749     7283    1           CALL CONCAT(ME_BUF,'ADefault COPY destination is ',TEXT_EO);

   7283 12 000011   040000 100400                    MLR     fill='040'O
        12 000012   000000 000035 11                 ADSC9   0                        cn=0,n=29
        12 000013   000030 000035 10                 ADSC9   ME_BUF                   cn=0,n=29
        12 000014   040000 100400                    MLR     fill='040'O
        12 000015   000054 000063 10                 ADSC9   TEXT_EO                  cn=0,n=51
        12 000016   000037 200063 10                 ADSC9   ME_BUF+7                 cn=1,n=51

      750     7284    1           CALL M$WRITE(FPT_WRITE_ME);

   7284 12 000017   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000020   040001 713400                    CLIMB   write
        12 000021   401400 401760                    pmme    nvectors=4

      751     7285    1           ME_BUF = 'ASeverity ';

   7285 12 000022   040000 100400                    MLR     fill='040'O
        12 000023   000010 000012 11                 ADSC9   8                        cn=0,n=10
        12 000024   000030 000120 10                 ADSC9   ME_BUF                   cn=0,n=80

      752     7286    1           T_COUNT = 16;                   /* Place to put [N]STEPCC             */

   7286 12 000025   000020 235007                    LDA     16,DL
        12 000026   000026 755000 10                 STA     T_COUNT

      753     7287    2           DO CASE(ERROR_SEVERITY);

   7287 12 000027   000000 236000 xsym               LDQ     ERROR_SEVERITY
        12 000030   000004 116007                    CMPQ    4,DL
        12 000031   000033 602006 12                 TNC     s:7287+4,QL
        12 000032   000055 710000 12                 TRA     s:7297
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:198  
        12 000033   000055 710000 12                 TRA     s:7297
        12 000034   000037 710000 12                 TRA     s:7289
        12 000035   000043 710000 12                 TRA     s:7291
        12 000036   000051 710000 12                 TRA     s:7294

      754     7288    2            CASE(1);                       /* SEVERITY ABORT specified           */

      755     7289    2              CALL INSERT(ME_BUF,10,,'abort');

   7289 12 000037   040000 100400                    MLR     fill='040'O
        12 000040   000013 000005 11                 ADSC9   11                       cn=0,n=5
        12 000041   000032 400106 10                 ADSC9   ME_BUF+2                 cn=2,n=70
        12 000042   000055 710000 12                 TRA     s:7297

      756     7290    2            CASE(2);                       /* SEVERITY CONTINUE specified        */

      757     7291    2              CALL INSERT(ME_BUF,10,,'continue');

   7291 12 000043   040000 100400                    MLR     fill='040'O
        12 000044   000015 000010 11                 ADSC9   13                       cn=0,n=8
        12 000045   000032 400106 10                 ADSC9   ME_BUF+2                 cn=2,n=70

      758     7292    2              T_COUNT = T_COUNT +3;

   7292 12 000046   000003 236007                    LDQ     3,DL
        12 000047   000026 056000 10                 ASQ     T_COUNT
        12 000050   000055 710000 12                 TRA     s:7297

      759     7293    2            CASE(3);                       /* SEVERITY ERROR specified           */

      760     7294    2              CALL INSERT(ME_BUF,10,,'error');

   7294 12 000051   040000 100400                    MLR     fill='040'O
        12 000052   000017 000005 11                 ADSC9   15                       cn=0,n=5
        12 000053   000032 400106 10                 ADSC9   ME_BUF+2                 cn=2,n=70

      761     7295    2              T_COUNT = T_COUNT + 1;
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:199  

   7295 12 000054   000026 054000 10                 AOS     T_COUNT

      762     7296    2            END;

      763     7297    1           IF HIGHEST_SEVERITY = -1

   7297 12 000055   000000 236000 xsym               LDQ     HIGHEST_SEVERITY
        12 000056   000027 116000 xsym               CMPQ    B_VECTNIL+23
        12 000057   000070 601000 12                 TNZ     s:7302

      764     7298    1            THEN                           /* NO STEPCC setting requested        */
      765     7299    1              CALL INSERT(ME_BUF,T_COUNT,,'nstepcc');

   7299 12 000060   000026 720000 10                 LXL0    T_COUNT
        12 000061   777657 620010                    EAX0    -81,X0
        12 000062   777777 660003                    ERX0    -1,DU
        12 000063   000026 235000 10                 LDA     T_COUNT
        12 000064   040045 100400                    MLR     fill='040'O
        12 000065   000021 000007 11                 ADSC9   17                       cn=0,n=7
        12 000066   000030 000010 10                 ADSC9   ME_BUF,A                 cn=0,n=*X0
        12 000067   000113 710000 12                 TRA     s:7307

      766     7300    1            ELSE                           /* STEPCC setting requested           */
      767     7301    2            DO;

      768     7302    2               CALL INSERT(ME_BUF,T_COUNT,,'stepcc');

   7302 12 000070   000026 720000 10                 LXL0    T_COUNT
        12 000071   777657 620010                    EAX0    -81,X0
        12 000072   777777 660003                    ERX0    -1,DU
        12 000073   000026 235000 10                 LDA     T_COUNT
        12 000074   040045 100400                    MLR     fill='040'O
        12 000075   000023 000006 11                 ADSC9   19                       cn=0,n=6
        12 000076   000030 000010 10                 ADSC9   ME_BUF,A                 cn=0,n=*X0

      769     7303    2               CALL M$WRITE(FPT_WRITE_ME);
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:200  

   7303 12 000077   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000100   040001 713400                    CLIMB   write
        12 000101   401400 401760                    pmme    nvectors=4

      770     7304    2               CALL BINCHAR(CONV_BUF,HIGHEST_SEVERITY);

   7304 12 000102   000000 301400                    BTD
        12 000103   000000 000004 xsym               NDSC9   HIGHEST_SEVERITY         cn=0,s=lsgnf,sf=0,n=4
        12 000104   000027 030001 10                 NDSC9   CONV_BUF                 cn=0,s=nosgn,sf=0,n=1

      771     7305    2               CALL CONCAT(ME_BUF,'AHighest encountered severity was ',CONV_BUF);

   7305 12 000105   040000 100400                    MLR     fill='040'O
        12 000106   000025 000042 11                 ADSC9   21                       cn=0,n=34
        12 000107   000030 000042 10                 ADSC9   ME_BUF                   cn=0,n=34
        12 000110   040000 100400                    MLR     fill='040'O
        12 000111   000027 000001 10                 ADSC9   CONV_BUF                 cn=0,n=1
        12 000112   000040 400056 10                 ADSC9   ME_BUF+8                 cn=2,n=46

      772     7306    2               END;

      773     7307    1           CALL M$WRITE(FPT_WRITE_ME);

   7307 12 000113   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000114   040001 713400                    CLIMB   write
        12 000115   401400 401760                    pmme    nvectors=4

      774     7308    1           IF ERR_SAVE_REL = 1

   7308 12 000116   000000 235000 xsym               LDA     ERR_SAVE_REL
        12 000117   000001 115007                    CMPA    1,DL
        12 000120   000125 601000 12                 TNZ     s:7312

      775     7309    1            THEN                           /* ERRORS SAVE specified              */
      776     7310    1              ME_BUF = 'AErrors save';

PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:201  
   7310 12 000121   040000 100400                    MLR     fill='040'O
        12 000122   000036 000014 11                 ADSC9   30                       cn=0,n=12
        12 000123   000030 000120 10                 ADSC9   ME_BUF                   cn=0,n=80
        12 000124   000130 710000 12                 TRA     s:7313

      777     7311    1            ELSE                           /* ERRORS RELEASE specified           */
      778     7312    1              ME_BUF = 'AErrors release';

   7312 12 000125   040000 100400                    MLR     fill='040'O
        12 000126   000041 000017 11                 ADSC9   33                       cn=0,n=15
        12 000127   000030 000120 10                 ADSC9   ME_BUF                   cn=0,n=80

      779     7313    1           CALL M$WRITE (FPT_WRITE_ME);

   7313 12 000130   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000131   040001 713400                    CLIMB   write
        12 000132   401400 401760                    pmme    nvectors=4

      780     7314    1           IF ONE_TIME = 1

   7314 12 000133   000000 235000 xsym               LDA     ONE_TIME
        12 000134   000001 115007                    CMPA    1,DL
        12 000135   000144 601000 12                 TNZ     s:7320

      781     7315    1            THEN                           /* Tell him that this is a ONE SHOT   */
      782     7316    2            DO;

      783     7317    2               ME_BUF = 'AOne-shot on';

   7317 12 000136   040000 100400                    MLR     fill='040'O
        12 000137   000045 000014 11                 ADSC9   37                       cn=0,n=12
        12 000140   000030 000120 10                 ADSC9   ME_BUF                   cn=0,n=80

      784     7318    2               CALL M$WRITE (FPT_WRITE_ME);

   7318 12 000141   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000142   040001 713400                    CLIMB   write
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:202  
        12 000143   401400 401760                    pmme    nvectors=4

      785     7319    2               END;

      786     7320    1           IF TEST_MODE = 1

   7320 12 000144   000000 235000 xsym               LDA     TEST_MODE
        12 000145   000001 115007                    CMPA    1,DL
        12 000146   000155 601000 12                 TNZ     s:7326

      787     7321    1            THEN                           /* Tell him that TEST MODE is on      */
      788     7322    2            DO;

      789     7323    2               ME_BUF = 'ATest mode on';

   7323 12 000147   040000 100400                    MLR     fill='040'O
        12 000150   000050 000015 11                 ADSC9   40                       cn=0,n=13
        12 000151   000030 000120 10                 ADSC9   ME_BUF                   cn=0,n=80

      790     7324    2               CALL M$WRITE (FPT_WRITE_ME);

   7324 12 000152   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000153   040001 713400                    CLIMB   write
        12 000154   401400 401760                    pmme    nvectors=4

      791     7325    2               END;

      792     7326    1           IF FPT_ERRMSG.V.INCLCODE# = '1'B

   7326 12 000155   000030 236000 xsym               LDQ     FPT_ERRMSG+24
        12 000156   004000 316003                    CANQ    2048,DU
        12 000157   000166 600000 12                 TZE     s:7332

      793     7327    1            THEN                           /* Tell him that FCG DISPLAY is on    */
      794     7328    2            DO;

      795     7329    2               ME_BUF = 'AFCG display on';
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:203  

   7329 12 000160   040000 100400                    MLR     fill='040'O
        12 000161   000054 000017 11                 ADSC9   44                       cn=0,n=15
        12 000162   000030 000120 10                 ADSC9   ME_BUF                   cn=0,n=80

      796     7330    2               CALL M$WRITE (FPT_WRITE_ME);

   7330 12 000163   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        12 000164   040001 713400                    CLIMB   write
        12 000165   401400 401760                    pmme    nvectors=4

      797     7331    2               END;

      798     7332    1           RETURN;

   7332 12 000166   000000 702200 xent               TSX2  ! X66_ARET
      799     7333    1   END VPK$STATUS;
      800     7334        %EOD;

PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:204  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$STATUS.
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:205  

 **** Variables and constants ****

  ****  Section 010  Data  VPK$STATUS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    27-0-0/c CHAR        r     1 CONV_BUF                   0-0-0/d STRC(792)   r     1 FPT_UNFID_EO
    30-0-0/c CHAR(80)    r     1 ME_BUF                    54-0-0/c CHAR(60)    r     1 TEXT_EO
    26-0-0/w SBIN        r     1 T_COUNT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/w SBIN        r     1 ERROR_SEVERITY             0-0-0/w SBIN        r     1 ERR_SAVE_REL
     0-0-0/d STRC(936)   r     1 FPT_ERRMSG                 0-0-0/d STRC(432)   r     1 FPT_WRITE_ME
     0-0-0/w SBIN        r     1 HIGHEST_SEVERITY           0-0-0/w SBIN        r     1 ONE_TIME
     0-0-0/w SBIN        r     1 TEST_MODE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$EO


   Procedure VPK$STATUS requires 119 words for executable code.
   Procedure VPK$STATUS requires 4 words of local(AUTO) storage.
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:206  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:207  
          MINI XREF LISTING

BREAK_LOC
      5218**DCL      5218--REDEF
CONV_BUF
      7277**DCL      7304<<CALLBLT  7305>>CALLBLT
DEF_ICB.FID.STRING
      5816**DCL      5817--REDEF
DEV_ICB.FID.STRING
      5702**DCL      5703--REDEF
EI_KEY.KEY
      5914**DCL      5914--REDEF    5914--REDEF    5914--REDEF
EO_OCB.TYPE
      5414**DCL      5415--REDEF
ERROR_SEVERITY
      5181**DCL      7287>>DOCASE
ERR_SAVE_REL
      5213**DCL      7308>>IF
F$DCB.ACTPOS
      7024**DCL      7024--REDEF
F$DCB.ARS
      6999**DCL      6999--REDEF
F$DCB.ATTR
      7017**DCL      7018--REDEF
F$DCB.BORROW
      7032**DCL      7032--REDEF    7032--REDEF    7032--REDEF
F$DCB.DCBNAME.L
      7046**DCL      7046--IMP-SIZ
F$DCB.EOMCHAR
      7003**DCL      7003--REDEF
F$DCB.FLDID
      7027**DCL      7027--REDEF
F$DCB.FORM$
      7021**DCL      7021--REDEF
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:208  
F$DCB.FSECT
      7037**DCL      7037--REDEF
F$DCB.FSN
      7014**DCL      7014--REDEF    7014--REDEF    7015--REDEF
F$DCB.HEADER$
      7020**DCL      7020--REDEF
F$DCB.IXTNSIZE
      7018**DCL      7018--REDEF
F$DCB.LASTSTA$
      7008**DCL      7008--REDEF
F$DCB.LVL
      7033**DCL      7033--REDEF
F$DCB.NAME.C
      7008**DCL      7008--REDEF
F$DCB.NOEOF
      7029**DCL      7029--REDEF
F$DCB.NRECS
      7019**DCL      7019--REDEF
F$DCB.NRECX
      7038**DCL      7038--REDEF
F$DCB.OHDR
      7030**DCL      7030--REDEF
F$DCB.ORG
      7013**DCL      7013--REDEF
F$DCB.PRECNO
      7036**DCL      7036--REDEF
F$DCB.RCSZ
      7041**DCL      7041--REDEF
F$DCB.RES
      7009**DCL      7009--REDEF
F$DCB.SETX
      7021**DCL      7021--REDEF
F$DCB.TAB$
      7020**DCL      7021--REDEF
F$DCB.TDA
      7035**DCL      7035--REDEF
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:209  
F$DCB.WSN
      7010**DCL      7010--REDEF
FPT_CLOSE_EI.SN_
      6755**DCL      6755--REDEF
FPT_CLOSE_EI.UTL_
      6756**DCL      6756--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6770**DCL      6770--REDEF
FPT_CLOSE_EI.V.TYPE#
      6768**DCL      6768--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6765**DCL      6765--REDEF    6767--REDEF
FPT_CLOSE_PTL.SN_
      6881**DCL      6881--REDEF
FPT_CLOSE_PTL.UTL_
      6882**DCL      6882--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6896**DCL      6896--REDEF
FPT_CLOSE_PTL.V.TYPE#
      6894**DCL      6894--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6891**DCL      6891--REDEF    6893--REDEF
FPT_CLOSE_READ.SN_
      6797**DCL      6797--REDEF
FPT_CLOSE_READ.UTL_
      6798**DCL      6798--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6812**DCL      6812--REDEF
FPT_CLOSE_READ.V.TYPE#
      6810**DCL      6810--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6807**DCL      6807--REDEF    6809--REDEF
FPT_CLOSE_SI.SN_
      6965**DCL      6965--REDEF
FPT_CLOSE_SI.UTL_
      6966**DCL      6966--REDEF
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:210  
FPT_CLOSE_SI.V.EXPIRE#
      6980**DCL      6980--REDEF
FPT_CLOSE_SI.V.TYPE#
      6978**DCL      6978--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6975**DCL      6975--REDEF    6977--REDEF
FPT_CLOSE_STD.SN_
      6923**DCL      6923--REDEF
FPT_CLOSE_STD.UTL_
      6924**DCL      6924--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6938**DCL      6938--REDEF
FPT_CLOSE_STD.V.TYPE#
      6936**DCL      6936--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6933**DCL      6933--REDEF    6935--REDEF
FPT_CLSEI_FT.SN_
      6839**DCL      6839--REDEF
FPT_CLSEI_FT.UTL_
      6840**DCL      6840--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6854**DCL      6854--REDEF
FPT_CLSEI_FT.V.TYPE#
      6852**DCL      6852--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6849**DCL      6849--REDEF    6851--REDEF
FPT_ERRMSG.V.INCLCODE#
      6096**DCL      7326>>IF
FPT_OPEN_EI.ACSVEH_
      6410**DCL      6411--REDEF
FPT_OPEN_EI.ALTKEYS_
      6416**DCL      6417--REDEF    6417--REDEF
FPT_OPEN_EI.HDR_
      6415**DCL      6416--REDEF
FPT_OPEN_EI.TAB_
      6414**DCL      6415--REDEF
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:211  
FPT_OPEN_EI.UHL_
      6408**DCL      6409--REDEF    6409--REDEF
FPT_OPEN_EI.V.FSN#
      6448**DCL      6448--REDEF    6448--REDEF
FPT_OPEN_EI.WSN_
      6414**DCL      6414--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6519**DCL      6520--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6525**DCL      6526--REDEF    6526--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6524**DCL      6525--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6523**DCL      6524--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6517**DCL      6518--REDEF    6518--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6557**DCL      6557--REDEF    6557--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6523**DCL      6523--REDEF
FPT_OPEN_OUT.ACSVEH_
      6301**DCL      6302--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6307**DCL      6308--REDEF    6308--REDEF
FPT_OPEN_OUT.HDR_
      6306**DCL      6307--REDEF
FPT_OPEN_OUT.TAB_
      6305**DCL      6306--REDEF
FPT_OPEN_OUT.UHL_
      6299**DCL      6300--REDEF    6300--REDEF
FPT_OPEN_OUT.V.FSN#
      6339**DCL      6339--REDEF    6339--REDEF
FPT_OPEN_OUT.WSN_
      6305**DCL      6305--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6192**DCL      6193--REDEF
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:212  
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6198**DCL      6199--REDEF    6199--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6197**DCL      6198--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6196**DCL      6197--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6190**DCL      6191--REDEF    6191--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6230**DCL      6230--REDEF    6230--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6196**DCL      6196--REDEF
FPT_READ_STD.STATION_
      6620**DCL      6621--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6632**DCL      6632--REDEF
FPT_READ_STD.V.INDX#
      6630**DCL      6630--REDEF
FPT_READ_UC.STATION_
      6581**DCL      6582--REDEF
FPT_READ_UC.V.DVBYTE.REREAD#
      6593**DCL      6593--REDEF
FPT_READ_UC.V.INDX#
      6591**DCL      6591--REDEF
FPT_UNFID_EO
      7061**DCL      7282<>CALL
FPT_UNFID_EO.V
      7065**DCL      7061--DCLINIT
FPT_WRITE_ME
      6687**DCL      7284<>CALL     7303<>CALL     7307<>CALL     7313<>CALL     7318<>CALL     7324<>CALL
      7330<>CALL
FPT_WRITE_ME.BUF_
      6687**DCL      7280<<ASSIGN
FPT_WRITE_ME.STATION_
      6689**DCL      6689--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:213  
      6696**DCL      6696--REDEF    7281<<ASSIGN
FPT_WRITE_OUT.STATION_
      6720**DCL      6720--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6727**DCL      6727--REDEF
FPT_WRITE_UC.STATION_
      6658**DCL      6658--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6665**DCL      6665--REDEF
FROM_SN.SN
      5564**DCL      5565--REDEF
GETCMD.OUT$
      4771**DCL      4777--REDEF
HIGHEST_SEVERITY
      5181**DCL      7297>>IF       7304>>CALLBLT
ICB.FID.STRING
      5588**DCL      5589--REDEF
IFSFA_PARAM.EOMCHAR#
      5943**DCL      5944--REDEF
IFSFA_PARAM.SIG1
      5937**DCL      5937--REDEF
IFSFA_PARAM.SIG2
      5937**DCL      5938--REDEF
IN_RES
      5510**DCL      5510--REDEF
IN_SN.SN
      5526**DCL      5527--REDEF
M$UNFID
        91**DCL-ENT  7282--CALL
M$WRITE
        29**DCL-ENT  7284--CALL     7303--CALL     7307--CALL     7313--CALL     7318--CALL     7324--CALL
      7330--CALL
ME_BUF
      7278**DCL      7280--ASSIGN   7283<<CALLBLT  7285<<ASSIGN   7289<<CALLBLT  7291<<CALLBLT  7294<<CALLBLT
      7299<<CALLBLT  7302<<CALLBLT  7305<<CALLBLT  7310<<ASSIGN   7312<<ASSIGN   7317<<ASSIGN   7323<<ASSIGN
      7329<<ASSIGN
PL6.E3A0      #006=VPK$STATUS File=VPK$CMDS.:E05TSI                              WED 07/30/97 08:02 Page:214  
OCB.TYPE
      5272**DCL      5273--REDEF
OFSFA_PARAM.EOMCHAR#
      5973**DCL      5974--REDEF
OFSFA_PARAM.SIG1
      5967**DCL      5967--REDEF
OFSFA_PARAM.SIG2
      5967**DCL      5968--REDEF
ONE_TIME
      5223**DCL      7314>>IF
OUT_SN.SN
      5544**DCL      5545--REDEF
SPEC_BUF
      5222**DCL      5222--REDEF
TEST_MODE
      5217**DCL      7320>>IF
TEXT_EO
      7279**DCL      7061--DCLINIT  7283>>CALLBLT
T_COUNT
      7276**DCL      7286<<ASSIGN   7292<<ASSIGN   7292>>ASSIGN   7295<<ASSIGN   7295>>ASSIGN   7299>>CALLBLT
      7302>>CALLBLT

PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:215  
      801        1        /*T***********************************************************/
      802        2        /*T*                                                         */
      803        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      804        4        /*T*                                                         */
      805        5        /*T***********************************************************/
      806        6        VPK$TX: PROC;
      807        7        /*D* NAME: VPK$TX
      808        8             CALL: CALL VPK$TX;
      809        9             DESCRIPTION: This procedure is used to move the TX command arguments
      810       10                          into TABS, an array used to hold PCL tab stops. The tab stops
      811       11                          are checked for validity as they are stored.
      812       12                      If TX ? was the command, the tab stops are reported instead.
      813       13        */
      814       14        /**/
      815       15        /*  INCLUDE FILES  */
      816       16        /**/
      817       17        %INCLUDE VP_DATA_R;
      818     7004        /**/
      819     7005        /*  BASED DATA  */
      820     7006        /**/
      821     7007        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      822     7052        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      823     7090        /**/
      824     7091        /*  CONSTANT  */
      825     7092        /**/
      826     7093    1   DCL MOP_3_BUF(0:1) BIT(9) CONSTANT INIT(%MVZB2,%MVC1);
      827     7094        /**/
      828     7095        /*  LOCAL AUTO  */
      829     7096        /**/
      830     7097    1   DCL OUT_BUF CHAR(124);
      831     7098    1   DCL 1 OUT_BUF_ARY(0:30) REDEF OUT_BUF,
      832     7099    1         2 COMMA CHAR(1),
      833     7100    1         2 TAB CHAR(3);
      834     7101    1   DCL J SBIN WORD;
      835     7102    1   DCL I SBIN WORD;
      836     7103    1   DCL TWORD UBIN WORD;
      837     7104        /**/
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:216  
      838     7105        /*  ENTRY POINTS  */
      839     7106        /**/
      840     7107        %VP_ENTRIES (OMIT=VPK$TX);
      841     7315        %EJECT;
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:217  
      842     7316    1           REMEMBER TAB_RET IN ABORT_CMD;
      843     7317    1           REMEMBER TAB_RET IN ABORT_STEP;
      844     7318    1           I = PCB.OUT$->OUT$BLK.NSUBLKS;
      845     7319    1           IF I>31
      846     7320    1            THEN
      847     7321    2            DO;
      848     7322    2               CALL VPL$ERR_PROC(1,30,'13'O);
      849     7323        /*E*   ERROR: VPK-00030
      850     7324             MESSAGE: Too many tabs - excess ignored
      851     7325            MESSAGE1: More than 31 tab stops are specified - first 31 used
      852     7326        */
      853     7327    2               I = 31;
      854     7328    2               END;
      855     7329    1           IF I=0 OR (I=1 AND PCB.OUT$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE=2)
      856     7330    2            THEN DO;                       /* REPORT TAB STOPS                   */
      857     7331    2               IF TABS='0'B
      858     7332    2                THEN
      859     7333    2                  OUT_BUF = '  NONE';
      860     7334    2                ELSE
      861     7335    3                DO;
      862     7336    3                   OUT_BUF = ' ';
      863     7337    3                   J = -1;
      864     7338    3                   I = 0;
      865     7339    4                   DO WHILE(J<TABS(I) AND I<31);
      866     7340    4                      OUT_BUF_ARY.COMMA(I) = ',';
      867     7341    4                      CALL BINCHAR(OUT_BUF_ARY.TAB(I),TABS(I));
      868     7342    4                      CALL EDITCHAR(OUT_BUF_ARY.TAB(I),
      869     7343    4                        0,
      870     7344    4                        3,
      871     7345    4                        MOP_3_BUF,
      872     7346    4                        OUT_BUF_ARY.TAB(I));
      873     7347    4                      J = TABS(I);
      874     7348    4                      I = I+1;
      875     7349    4                      END;
      876     7350    3                   OUT_BUF_ARY.COMMA(0) = ' ';
      877     7351    3                   END;
      878     7352    2               FPT_WRITE_ME.BUF_  = VECTOR(OUT_BUF);
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:218  
      879     7353    2               FPT_WRITE_ME.V.DVBYTE.VFC# = '0'B;
      880     7354    2               CALL M$WRITE(FPT_WRITE_ME);
      881     7355    2               RETURN;
      882     7356    2               END;
      883     7357    1           TABS = '0'B;                    /* CLEAR THE TAB TABLE                */
      884     7358    2           DO J=1 TO I;
      885     7359    2              CALL VPD$TEXTC_CHARBIN(TWORD,
      886     7360    2                PCB.OUT$->OUT$BLK.SUBLK$(J-1)->OUT$SYM.TEXTC$,
      887     7361    2                TWORD) ALTRET(BAD_TAB);
      888     7362    2              IF J>1
      889     7363    2               THEN
      890     7364    2                 IF TWORD<=TABS(J-2)
      891     7365    2                  THEN
      892     7366    2                    GOTO BAD_TAB;
      893     7367    2              TABS(J-1) = TWORD;
      894     7368    2              END;
      895     7369    1   TAB_RET: RETURN;
      896     7370    1   BAD_TAB: CALL VPL$ERR_PROC(3,40,'13'O);
      897     7371        /*E*   ERROR: VPK-00040
      898     7372             MESSAGE: Bad tab
      899     7373            MESSAGE1: Tab stop either > 511 or <= previous tab
      900     7374        */
      901     7375    1   END VPK$TX;

PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:219  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$TX.

   Procedure VPK$TX requires 137 words for executable code.
   Procedure VPK$TX requires 42 words of local(AUTO) storage.

    No errors detected in file VPK$CMDS.:E05TSI    .

PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:220  

 Object Unit name= VPK$TX                                     File name= VPK$CMDS.:E05TOU
 UTS= JUL 30 '97 08:02:59.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$EI
    2   DCB   even  none     0      0  M$EO
    3   DCB   even  none     0      0  M$EO1
    4   DCB   even  none     0      0  M$ME
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$READFILE
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$STD1
    9   DCB   even  none     0      0  M$SORT1
   10  RoData even  UTS      3      3  VPK$TX
   11   Proc  even  none   137    211  VPK$TX
   12  RoData even  none    11     13  VPK$TX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    11      0   yes            yes      Std        0  VPK$TX
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:221  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       8 VPL$ERR_PROC
 yes     yes           Std       4 VPD$TEXTC_CHARBIN
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  PCB                                   ABORT_STEP
     ABORT_CMD                             BREAK_LOC                             BREAK_MESSAGE_REPORTER
     SPEC_BUF                              TABS                                  IN_RES
     M$EI                                  M$EO                                  M$EO1
     M$ME                                  M$SI                                  M$READFILE
     M$DO                                  M$STD1                                M$SORT1
     FPT_WRITE_ME                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:222  


      801        1        /*T***********************************************************/
      802        2        /*T*                                                         */
      803        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      804        4        /*T*                                                         */
      805        5        /*T***********************************************************/
      806        6        VPK$TX: PROC;

      6 11 000000   000000 700200 xent  VPK$TX       TSX0  ! X66_AUTO_0
        11 000001   000052 000000                    ZERO    42,0

      807        7        /*D* NAME: VPK$TX
      808        8             CALL: CALL VPK$TX;
      809        9             DESCRIPTION: This procedure is used to move the TX command arguments
      810       10                          into TABS, an array used to hold PCL tab stops. The tab stops
      811       11                          are checked for validity as they are stored.
      812       12                      If TX ? was the command, the tab stops are reported instead.
      813       13        */
      814       14        /**/
      815       15        /*  INCLUDE FILES  */
      816       16        /**/
      817       17        %INCLUDE VP_DATA_R;
      818     7004        /**/
      819     7005        /*  BASED DATA  */
      820     7006        /**/
      821     7007        %PARSE$OUT(NAME = OUT$BLK,STCLASS = BASED);
      822     7052        %PARSE$SYM(NAME = OUT$SYM,STCLASS = BASED);
      823     7090        /**/
      824     7091        /*  CONSTANT  */
      825     7092        /**/
      826     7093    1   DCL MOP_3_BUF(0:1) BIT(9) CONSTANT INIT(%MVZB2,%MVC1);
      827     7094        /**/
      828     7095        /*  LOCAL AUTO  */
      829     7096        /**/
      830     7097    1   DCL OUT_BUF CHAR(124);
      831     7098    1   DCL 1 OUT_BUF_ARY(0:30) REDEF OUT_BUF,
      832     7099    1         2 COMMA CHAR(1),
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:223  
      833     7100    1         2 TAB CHAR(3);
      834     7101    1   DCL J SBIN WORD;
      835     7102    1   DCL I SBIN WORD;
      836     7103    1   DCL TWORD UBIN WORD;
      837     7104        /**/
      838     7105        /*  ENTRY POINTS  */
      839     7106        /**/
      840     7107        %VP_ENTRIES (OMIT=VPK$TX);
      841     7315        %EJECT;
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:224  
      842     7316    1           REMEMBER TAB_RET IN ABORT_CMD;

   7316 11 000002   000203 635000 11                 EAA     TAB_RET
        11 000003   000000 452400 xsym               STP2    ABORT_CMD
        11 000004   000001 755000 xsym               STA     ABORT_CMD+1

      843     7317    1           REMEMBER TAB_RET IN ABORT_STEP;

   7317 11 000005   000203 635000 11                 EAA     TAB_RET
        11 000006   000000 452400 xsym               STP2    ABORT_STEP
        11 000007   000001 755000 xsym               STA     ABORT_STEP+1

      844     7318    1           I = PCB.OUT$->OUT$BLK.NSUBLKS;

   7318 11 000010   000003 470400 xsym               LDP0    PCB+3
        11 000011   000001 236100                    LDQ     1,,PR0
        11 000012   000022 772000                    QRL     18
        11 000013   200043 756100                    STQ     I,,AUTO

      845     7319    1           IF I>31

   7319 11 000014   000037 116007                    CMPQ    31,DL
        11 000015   000024 604400 11                 TMOZ    s:7329

      846     7320    1            THEN
      847     7321    2            DO;

      848     7322    2               CALL VPL$ERR_PROC(1,30,'13'O);

   7322 11 000016   000002 630400 12                 EPPR0   2
        11 000017   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000020   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000021   000000 011000                    NOP     0

      849     7323        /*E*   ERROR: VPK-00030
      850     7324             MESSAGE: Too many tabs - excess ignored
      851     7325            MESSAGE1: More than 31 tab stops are specified - first 31 used
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:225  
      852     7326        */
      853     7327    2               I = 31;

   7327 11 000022   000037 235007                    LDA     31,DL
        11 000023   200043 755100                    STA     I,,AUTO

      854     7328    2               END;

      855     7329    1           IF I=0 OR (I=1 AND PCB.OUT$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE=2)

   7329 11 000024   200043 235100                    LDA     I,,AUTO
        11 000025   000035 600000 11                 TZE     s:7331
        11 000026   000001 115007                    CMPA    1,DL
        11 000027   000140 601000 11                 TNZ     s:7357
        11 000030   000003 470400 xsym               LDP0    PCB+3
        11 000031   000003 471500                    LDP1    3,,PR0
        11 000032   100000 720100                    LXL0    0,,PR1
        11 000033   000002 100003                    CMPX0   2,DU
        11 000034   000140 601000 11                 TNZ     s:7357

      856     7330    2            THEN DO;                       /* REPORT TAB STOPS                   */

      857     7331    2               IF TABS='0'B

   7331 11 000035   000000 106400                    CMPC    fill='000'O
        11 000036   000000 000037 xsym               ADSC9   TABS                     cn=0,n=31
        11 000037   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
        11 000040   000045 601000 11                 TNZ     s:7336

      858     7332    2                THEN
      859     7333    2                  OUT_BUF = '  NONE';

   7333 11 000041   040100 100400                    MLR     fill='040'O
        11 000042   000001 000006 10                 ADSC9   MOP_3_BUF+1              cn=0,n=6
        11 000043   200003 000174                    ADSC9   OUT_BUF,,AUTO            cn=0,n=124
        11 000044   000125 710000 11                 TRA     s:7352

PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:226  
      860     7334    2                ELSE
      861     7335    3                DO;

      862     7336    3                   OUT_BUF = ' ';

   7336 11 000045   040100 100400                    MLR     fill='040'O
        11 000046   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        11 000047   200003 000174                    ADSC9   OUT_BUF,,AUTO            cn=0,n=124

      863     7337    3                   J = -1;

   7337 11 000050   000001 336007                    LCQ     1,DL
        11 000051   200042 756100                    STQ     J,,AUTO

      864     7338    3                   I = 0;

   7338 11 000052   200043 450100                    STZ     I,,AUTO

      865     7339    4                   DO WHILE(J<TABS(I) AND I<31);

   7339 11 000053   000112 710000 11                 TRA     s:7349

      866     7340    4                      OUT_BUF_ARY.COMMA(I) = ',';

   7340 11 000054   200043 720100                    LXL0    I,,AUTO
        11 000055   200003 236110                    LDQ     OUT_BUF,X0,AUTO
        11 000056   000032 376000 xsym               ANQ     B_VECTNIL+26
        11 000057   054000 276003                    ORQ     22528,DU
        11 000060   200003 756110                    STQ     OUT_BUF,X0,AUTO

      867     7341    4                      CALL BINCHAR(OUT_BUF_ARY.TAB(I),TABS(I));

   7341 11 000061   200043 235100                    LDA     I,,AUTO
        11 000062   000002 735000                    ALS     2
        11 000063   200043 236100                    LDQ     I,,AUTO
        11 000064   000100 101406                    MRL     fill='000'O
        11 000065   000000 000001 xsym               ADSC9   TABS,Q                   cn=0,n=1
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:227  
        11 000066   200046 000004                    ADSC9   TWORD+2,,AUTO            cn=0,n=4
        11 000067   200046 236100                    LDQ     TWORD+2,,AUTO
        11 000070   200047 755100                    STA     TWORD+3,,AUTO
        11 000071   000000 235003                    LDA     0,DU
        11 000072   200050 757100                    STAQ    TWORD+4,,AUTO
        11 000073   200047 235100                    LDA     TWORD+3,,AUTO
        11 000074   000105 301500                    BTD
        11 000075   200050 000010                    NDSC9   TWORD+4,,AUTO            cn=0,s=lsgnf,sf=0,n=8
        11 000076   200003 230003                    NDSC9   OUT_BUF,A,AUTO           cn=1,s=nosgn,sf=0,n=3

      868     7342    4                      CALL EDITCHAR(OUT_BUF_ARY.TAB(I),

   7342 11 000077   200043 235100                    LDA     I,,AUTO
        11 000100   000002 735000                    ALS     2
        11 000101   105000 024505                    MVNE
        11 000102   200003 230003                    NDSC9   OUT_BUF,A,AUTO           cn=1,s=nosgn,sf=0,n=3
        11 000103   000000 000002 10                 ADSC9   MOP_3_BUF                cn=0,n=2
        11 000104   200003 200003                    ADSC9   OUT_BUF,A,AUTO           cn=1,n=3

      869     7343    4                        0,
      870     7344    4                        3,
      871     7345    4                        MOP_3_BUF,
      872     7346    4                        OUT_BUF_ARY.TAB(I));
      873     7347    4                      J = TABS(I);

   7347 11 000105   200043 236100                    LDQ     I,,AUTO
        11 000106   000100 101406                    MRL     fill='000'O
        11 000107   000000 000001 xsym               ADSC9   TABS,Q                   cn=0,n=1
        11 000110   200042 000004                    ADSC9   J,,AUTO                  cn=0,n=4

      874     7348    4                      I = I+1;

   7348 11 000111   200043 054100                    AOS     I,,AUTO

      875     7349    4                      END;

   7349 11 000112   200043 235100                    LDA     I,,AUTO
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:228  
        11 000113   000100 101405                    MRL     fill='000'O
        11 000114   000000 000001 xsym               ADSC9   TABS,A                   cn=0,n=1
        11 000115   200046 000004                    ADSC9   TWORD+2,,AUTO            cn=0,n=4
        11 000116   200046 236100                    LDQ     TWORD+2,,AUTO
        11 000117   200042 116100                    CMPQ    J,,AUTO
        11 000120   000123 604400 11                 TMOZ    s:7350
        11 000121   000037 115007                    CMPA    31,DL
        11 000122   000054 604000 11                 TMI     s:7340

      876     7350    3                   OUT_BUF_ARY.COMMA(0) = ' ';

   7350 11 000123   040000 236003                    LDQ     16384,DU
        11 000124   200003 552140                    STBQ    OUT_BUF,'40'O,AUTO

      877     7351    3                   END;

      878     7352    2               FPT_WRITE_ME.BUF_  = VECTOR(OUT_BUF);

   7352 11 000125   000005 235000 12                 LDA     5
        11 000126   200046 452500                    STP2    TWORD+2,,AUTO
        11 000127   200046 236100                    LDQ     TWORD+2,,AUTO
        11 000130   000003 036003                    ADLQ    3,DU
        11 000131   000004 757000 xsym               STAQ    FPT_WRITE_ME+4

      879     7353    2               FPT_WRITE_ME.V.DVBYTE.VFC# = '0'B;

   7353 11 000132   000006 236000 12                 LDQ     6
        11 000133   000013 356000 xsym               ANSQ    FPT_WRITE_ME+11

      880     7354    2               CALL M$WRITE(FPT_WRITE_ME);

   7354 11 000134   000000 630400 xsym               EPPR0   FPT_WRITE_ME
        11 000135   040001 713400                    CLIMB   write
        11 000136   401400 401760                    pmme    nvectors=4

      881     7355    2               RETURN;

PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:229  
   7355 11 000137   000000 702200 xent               TSX2  ! X66_ARET

      882     7356    2               END;
      883     7357    1           TABS = '0'B;                    /* CLEAR THE TAB TABLE                */

   7357 11 000140   000000 100400                    MLR     fill='000'O
        11 000141   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
        11 000142   000000 000037 xsym               ADSC9   TABS                     cn=0,n=31

      884     7358    2           DO J=1 TO I;

   7358 11 000143   000001 236007                    LDQ     1,DL
        11 000144   200042 756100                    STQ     J,,AUTO
        11 000145   000200 710000 11                 TRA     s:7368+1

      885     7359    2              CALL VPD$TEXTC_CHARBIN(TWORD,

   7359 11 000146   000003 470400 xsym               LDP0    PCB+3
        11 000147   200042 720100                    LXL0    J,,AUTO
        11 000150   000002 471510                    LDP1    2,X0,PR0
        11 000151   200044 633500                    EPPR3   TWORD,,AUTO
        11 000152   200050 453500                    STP3    TWORD+4,,AUTO
        11 000153   100003 634500                    EPPR4   3,,PR1
        11 000154   200047 454500                    STP4    TWORD+3,,AUTO
        11 000155   200044 631500                    EPPR1   TWORD,,AUTO
        11 000156   200046 451500                    STP1    TWORD+2,,AUTO
        11 000157   200046 630500                    EPPR0   TWORD+2,,AUTO
        11 000160   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000161   000000 701000 xent               TSX1    VPD$TEXTC_CHARBIN
        11 000162   000204 702000 11                 TSX2    BAD_TAB

      886     7360    2                PCB.OUT$->OUT$BLK.SUBLK$(J-1)->OUT$SYM.TEXTC$,
      887     7361    2                TWORD) ALTRET(BAD_TAB);
      888     7362    2              IF J>1

   7362 11 000163   200042 235100                    LDA     J,,AUTO
        11 000164   000001 115007                    CMPA    1,DL
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:230  
        11 000165   000174 604400 11                 TMOZ    s:7367

      889     7363    2               THEN
      890     7364    2                 IF TWORD<=TABS(J-2)

   7364 11 000166   000100 101405                    MRL     fill='000'O
        11 000167   777777 400001 xsym               ADSC9   TABS-1,A                 cn=2,n=1
        11 000170   200046 000004                    ADSC9   TWORD+2,,AUTO            cn=0,n=4
        11 000171   200046 236100                    LDQ     TWORD+2,,AUTO
        11 000172   200044 116100                    CMPQ    TWORD,,AUTO
        11 000173   000204 603000 11                 TRC     BAD_TAB

      891     7365    2                  THEN
      892     7366    2                    GOTO BAD_TAB;
      893     7367    2              TABS(J-1) = TWORD;

   7367 11 000174   000005 101500                    MRL     fill='000'O
        11 000175   200044 000004                    ADSC9   TWORD,,AUTO              cn=0,n=4
        11 000176   777777 600001 xsym               ADSC9   TABS-1,A                 cn=3,n=1

      894     7368    2              END;

   7368 11 000177   200042 054100                    AOS     J,,AUTO
        11 000200   200042 236100                    LDQ     J,,AUTO
        11 000201   200043 116100                    CMPQ    I,,AUTO
        11 000202   000146 604400 11                 TMOZ    s:7359

      895     7369    1   TAB_RET: RETURN;

   7369 11 000203   000000 702200 xent  TAB_RET      TSX2  ! X66_ARET

      896     7370    1   BAD_TAB: CALL VPL$ERR_PROC(3,40,'13'O);

   7370 11 000204   000010 630400 12    BAD_TAB      EPPR0   8
        11 000205   000021 631400 xsym               EPPR1   B_VECTNIL+17
        11 000206   000000 701000 xent               TSX1    VPL$ERR_PROC
        11 000207   000000 011000                    NOP     0
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:231  

      897     7371        /*E*   ERROR: VPK-00040
      898     7372             MESSAGE: Bad tab
      899     7373            MESSAGE1: Tab stop either > 511 or <= previous tab
      900     7374        */
      901     7375    1   END VPK$TX;

   7375 11 000210   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:232  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VP_MACRO_C.:E05TOU  is referenced.
   XS_MACRO_C.:E05TOU  is referenced.
   VP_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VP_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VPK$TX.
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:233  

 **** Variables and constants ****

  ****  Section 010 RoData VPK$TX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT (9)     r     1 MOP_3_BUF(0:1)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    43-0-0/w SBIN        r     1 I                         42-0-0/w SBIN        r     1 J
     3-0-0/c CHAR(124)   r     1 OUT_BUF
     3-0-0/c STRC        r     1 OUT_BUF_ARY(0:30)
    44-0-0/w UBIN        r     1 TWORD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ABORT_CMD                  0-0-0/d REMB        r     1 ABORT_STEP
     0-0-0/w EPTR        r     1 BREAK_MESSAGE_REPORTER
     0-0-0/d STRC(432)   r     1 FPT_WRITE_ME               0-0-0/w STRC(504)   r     1 PCB
     0-0-0/b UBIN(9)     r     1 TABS(0:30)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM

PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:234  

   Procedure VPK$TX requires 137 words for executable code.
   Procedure VPK$TX requires 42 words of local(AUTO) storage.

    No errors detected in file VPK$CMDS.:E05TSI    .
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:235  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:236  
          MINI XREF LISTING

ABORT_CMD
      5189**DCL      7316<<REMEMBR
ABORT_STEP
      5188**DCL      7317<<REMEMBR
BAD_TAB
      7370**LABEL    7359--CALLALT  7366--GOTO
BREAK_LOC
      5224**DCL      5224--REDEF
DEF_ICB.FID.STRING
      5822**DCL      5823--REDEF
DEV_ICB.FID.STRING
      5708**DCL      5709--REDEF
EI_KEY.KEY
      5920**DCL      5920--REDEF    5920--REDEF    5920--REDEF
EO_OCB.TYPE
      5420**DCL      5421--REDEF
FPT_CLOSE_EI.SN_
      6761**DCL      6761--REDEF
FPT_CLOSE_EI.UTL_
      6762**DCL      6762--REDEF
FPT_CLOSE_EI.V.EXPIRE#
      6776**DCL      6776--REDEF
FPT_CLOSE_EI.V.TYPE#
      6774**DCL      6774--REDEF
FPT_CLOSE_EI.V.XTNSIZE#
      6771**DCL      6771--REDEF    6773--REDEF
FPT_CLOSE_PTL.SN_
      6887**DCL      6887--REDEF
FPT_CLOSE_PTL.UTL_
      6888**DCL      6888--REDEF
FPT_CLOSE_PTL.V.EXPIRE#
      6902**DCL      6902--REDEF
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:237  
FPT_CLOSE_PTL.V.TYPE#
      6900**DCL      6900--REDEF
FPT_CLOSE_PTL.V.XTNSIZE#
      6897**DCL      6897--REDEF    6899--REDEF
FPT_CLOSE_READ.SN_
      6803**DCL      6803--REDEF
FPT_CLOSE_READ.UTL_
      6804**DCL      6804--REDEF
FPT_CLOSE_READ.V.EXPIRE#
      6818**DCL      6818--REDEF
FPT_CLOSE_READ.V.TYPE#
      6816**DCL      6816--REDEF
FPT_CLOSE_READ.V.XTNSIZE#
      6813**DCL      6813--REDEF    6815--REDEF
FPT_CLOSE_SI.SN_
      6971**DCL      6971--REDEF
FPT_CLOSE_SI.UTL_
      6972**DCL      6972--REDEF
FPT_CLOSE_SI.V.EXPIRE#
      6986**DCL      6986--REDEF
FPT_CLOSE_SI.V.TYPE#
      6984**DCL      6984--REDEF
FPT_CLOSE_SI.V.XTNSIZE#
      6981**DCL      6981--REDEF    6983--REDEF
FPT_CLOSE_STD.SN_
      6929**DCL      6929--REDEF
FPT_CLOSE_STD.UTL_
      6930**DCL      6930--REDEF
FPT_CLOSE_STD.V.EXPIRE#
      6944**DCL      6944--REDEF
FPT_CLOSE_STD.V.TYPE#
      6942**DCL      6942--REDEF
FPT_CLOSE_STD.V.XTNSIZE#
      6939**DCL      6939--REDEF    6941--REDEF
FPT_CLSEI_FT.SN_
      6845**DCL      6845--REDEF
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:238  
FPT_CLSEI_FT.UTL_
      6846**DCL      6846--REDEF
FPT_CLSEI_FT.V.EXPIRE#
      6860**DCL      6860--REDEF
FPT_CLSEI_FT.V.TYPE#
      6858**DCL      6858--REDEF
FPT_CLSEI_FT.V.XTNSIZE#
      6855**DCL      6855--REDEF    6857--REDEF
FPT_OPEN_EI.ACSVEH_
      6416**DCL      6417--REDEF
FPT_OPEN_EI.ALTKEYS_
      6422**DCL      6423--REDEF    6423--REDEF
FPT_OPEN_EI.HDR_
      6421**DCL      6422--REDEF
FPT_OPEN_EI.TAB_
      6420**DCL      6421--REDEF
FPT_OPEN_EI.UHL_
      6414**DCL      6415--REDEF    6415--REDEF
FPT_OPEN_EI.V.FSN#
      6454**DCL      6454--REDEF    6454--REDEF
FPT_OPEN_EI.WSN_
      6420**DCL      6420--REDEF
FPT_OPEN_EI_SAVE.ACSVEH_
      6525**DCL      6526--REDEF
FPT_OPEN_EI_SAVE.ALTKEYS_
      6531**DCL      6532--REDEF    6532--REDEF
FPT_OPEN_EI_SAVE.HDR_
      6530**DCL      6531--REDEF
FPT_OPEN_EI_SAVE.TAB_
      6529**DCL      6530--REDEF
FPT_OPEN_EI_SAVE.UHL_
      6523**DCL      6524--REDEF    6524--REDEF
FPT_OPEN_EI_SAVE.V.FSN#
      6563**DCL      6563--REDEF    6563--REDEF
FPT_OPEN_EI_SAVE.WSN_
      6529**DCL      6529--REDEF
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:239  
FPT_OPEN_OUT.ACSVEH_
      6307**DCL      6308--REDEF
FPT_OPEN_OUT.ALTKEYS_
      6313**DCL      6314--REDEF    6314--REDEF
FPT_OPEN_OUT.HDR_
      6312**DCL      6313--REDEF
FPT_OPEN_OUT.TAB_
      6311**DCL      6312--REDEF
FPT_OPEN_OUT.UHL_
      6305**DCL      6306--REDEF    6306--REDEF
FPT_OPEN_OUT.V.FSN#
      6345**DCL      6345--REDEF    6345--REDEF
FPT_OPEN_OUT.WSN_
      6311**DCL      6311--REDEF
FPT_OPEN_OUT_SAVE.ACSVEH_
      6198**DCL      6199--REDEF
FPT_OPEN_OUT_SAVE.ALTKEYS_
      6204**DCL      6205--REDEF    6205--REDEF
FPT_OPEN_OUT_SAVE.HDR_
      6203**DCL      6204--REDEF
FPT_OPEN_OUT_SAVE.TAB_
      6202**DCL      6203--REDEF
FPT_OPEN_OUT_SAVE.UHL_
      6196**DCL      6197--REDEF    6197--REDEF
FPT_OPEN_OUT_SAVE.V.FSN#
      6236**DCL      6236--REDEF    6236--REDEF
FPT_OPEN_OUT_SAVE.WSN_
      6202**DCL      6202--REDEF
FPT_READ_STD.STATION_
      6626**DCL      6627--REDEF
FPT_READ_STD.V.DVBYTE.REREAD#
      6638**DCL      6638--REDEF
FPT_READ_STD.V.INDX#
      6636**DCL      6636--REDEF
FPT_READ_UC.STATION_
      6587**DCL      6588--REDEF
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:240  
FPT_READ_UC.V.DVBYTE.REREAD#
      6599**DCL      6599--REDEF
FPT_READ_UC.V.INDX#
      6597**DCL      6597--REDEF
FPT_WRITE_ME
      6693**DCL      7354<>CALL
FPT_WRITE_ME.BUF_
      6693**DCL      7352<<ASSIGN
FPT_WRITE_ME.STATION_
      6695**DCL      6695--REDEF
FPT_WRITE_ME.V.DVBYTE.VFC#
      6702**DCL      6702--REDEF    7353<<ASSIGN
FPT_WRITE_OUT.STATION_
      6726**DCL      6726--REDEF
FPT_WRITE_OUT.V.DVBYTE.VFC#
      6733**DCL      6733--REDEF
FPT_WRITE_UC.STATION_
      6664**DCL      6664--REDEF
FPT_WRITE_UC.V.DVBYTE.VFC#
      6671**DCL      6671--REDEF
FROM_SN.SN
      5570**DCL      5571--REDEF
GETCMD.OUT$
      4777**DCL      4783--REDEF
I
      7102**DCL      7318<<ASSIGN   7319>>IF       7327<<ASSIGN   7329>>IF       7329>>IF       7338<<ASSIGN
      7339>>DOWHILE  7339>>DOWHILE  7340>>ASSIGN   7341>>CALLBLT  7341>>CALLBLT  7342>>CALLBLT  7342>>CALLBLT
      7347>>ASSIGN   7348<<ASSIGN   7348>>ASSIGN   7358>>DOINDEX
ICB.FID.STRING
      5594**DCL      5595--REDEF
IFSFA_PARAM.EOMCHAR#
      5949**DCL      5950--REDEF
IFSFA_PARAM.SIG1
      5943**DCL      5943--REDEF
IFSFA_PARAM.SIG2
      5943**DCL      5944--REDEF
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:241  
IN_RES
      5516**DCL      5516--REDEF
IN_SN.SN
      5532**DCL      5533--REDEF
J
      7101**DCL      7337<<ASSIGN   7339>>DOWHILE  7347<<ASSIGN   7358<<DOINDEX  7359>>CALL     7362>>IF
      7364>>IF       7367>>ASSIGN
M$WRITE
        35**DCL-ENT  7354--CALL
MOP_3_BUF
      7093**DCL      7342>>CALLBLT
OCB.TYPE
      5278**DCL      5279--REDEF
OFSFA_PARAM.EOMCHAR#
      5979**DCL      5980--REDEF
OFSFA_PARAM.SIG1
      5973**DCL      5973--REDEF
OFSFA_PARAM.SIG2
      5973**DCL      5974--REDEF
OUT$BLK.CODE
      7021**DCL      7329>>IF
OUT$BLK.NSUBLKS
      7025**DCL      7318>>ASSIGN
OUT$BLK.SUBLK$
      7046**DCL      7329>>IF       7359>>CALL
OUT$SYM.COUNT
      7082**DCL      7085--IMP-SIZ
OUT$SYM.TEXTC$
      7077**DCL      7359<>CALL
OUT_BUF
      7097**DCL      7098--REDEF    7333<<ASSIGN   7336<<ASSIGN   7352--ASSIGN
OUT_BUF_ARY.COMMA
      7099**DCL      7340<<ASSIGN   7350<<ASSIGN
OUT_BUF_ARY.TAB
      7100**DCL      7341<<CALLBLT  7342<<CALLBLT  7342>>CALLBLT
OUT_SN.SN
PL6.E3A0      #007=VPK$TX File=VPK$CMDS.:E05TSI                                  WED 07/30/97 08:02 Page:242  
      5550**DCL      5551--REDEF
PCB.OUT$
      4591**DCL      7318>>ASSIGN   7329>>IF       7359>>CALL
SPEC_BUF
      5228**DCL      5228--REDEF
TABS
      5230**DCL      7331>>IF       7339>>DOWHILE  7341>>CALLBLT  7347>>ASSIGN   7357<<ASSIGN   7364>>IF
      7367<<ASSIGN
TAB_RET
      7369**LABEL    7316--REMEMBR  7317--REMEMBR
TWORD
      7103**DCL      7359<>CALL     7359<>CALL     7364>>IF       7367>>ASSIGN
VPD$TEXTC_CHARBIN
      7189**DCL-ENT  7359--CALL
VPL$ERR_PROC
      7289**DCL-ENT  7322--CALL     7370--CALL
