VERSION A06

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:1    
        1        1        /*M* X9WW$?  -- Runtime support of the WRITE and REWRITE statements */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8                 NAME:   X9WW$WRITE_RAND
        9        9
       10       10              PURPOSE: Provides runtime support for the WRITE and REWRITE statements
       11       11                       by interfacing with CP-6 Monitor Service routines which write
       12       12                       logical records to a file.
       13       13
       14       14        */
       15       15        /*D*     NAME:   X9WW$WRITE_RAND
       16       16
       17       17              PURPOSE: Provides runtime support for the WRITE and REWRITE statements
       18       18                       by interfacing with CP-6 Monitor Service routines which
       19       19                       write logical records to a file.
       20       20
       21       21            PARAMETER: FAB      -- File Attribute Block
       22       22                       ALT_RET  -- Altreturn bit for invalid key, at end
       23       23                       REC_LEN  -- Actual length of record to be written
       24       24                       ADV_CODE -- Type of advancing requeted (Before, after...)
       25       25                       ADV_CHAR -- VFC for advancing.
       26       26
       27       27                INPUT: DCB, FAB, REC_LEN, ADV_CODE, ADV_CHAR, ALT_RET
       28       28
       29       29               OUTPUT: FAB
       30       30        */
       31       31        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:2    
       32       32        /*---------------*/
       33       33          X9WW$WRITE_RAND:     PROC (FAB, ALT_RET, REC_LEN, ADV_CODE, ADV_CHAR)  ALTRET;
       34       34        /*---------------*/
       35       35
       36       36            %INCLUDE B_ERRORS_C;
       37     1162            %INCLUDE X8A_SYS_FILE;
       38     7432            %INCLUDE X8A_LIBCOM;
       39     7652            %INCLUDE X8A_ERRCOM;
       40     7741            %INCLUDE X8A_MACROS;
       41     7998            %INCLUDE X9A_FAB;
       42     8185            %INCLUDE X9A_IO;
       43     8335            %INCLUDE X9A_LIB_IO;
       44     8719
       45     8720            %DCL_FAB;
       46     8842            %DCL_SHARED (@STCLASS = "BASED (FAB.SHARED$)");         /*#32658*/
       47     8851
       48     8852            %EQU PAGE_SLEW_BEFORE  =  'P';
       49     8853            %EQU PAGE_SLEW_AFTER   =  '0';
       50     8854        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:3    
       51     8855    1       DCL ADV_CODE       SBIN WORD;
       52     8856    1       DCL 1 ADV_CHAR     ALIGNED,
       53     8857    1            2 VFC#         SBIN WORD,
       54     8858    1            2 VFC  REDEF   VFC#,
       55     8859    1             3 VFC_CHAR    CHAR(1) UNAL,
       56     8860    1             3 *           CHAR(3) UNAL;
       57     8861    1       DCL REC_LEN        SBIN WORD;
       58     8862    1       DCL ALT_RET        BIT(1) ALIGNED;
       59     8863    1       DCL RELATIVE_KEY   UBIN WORD;
       60     8864    1       DCL INDEX_KEY$     PTR;
       61     8865    1       DCL INDEX_KEY      BASED CHAR (FAB.RECORD_KEY_LEN);
       62     8866    1       DCL OLD_INDEX_KEY  BASED (FAB.RECORD_KEY$) CHAR (FAB.RECORD_KEY_LEN);
       63     8867    1       DCL 1 KEYED_KEY    ALIGNED,
       64     8868    1            2 LENGTH      UBIN(9)   UNAL,
       65     8869    1            2 TEXT        CHAR(255) UNAL;
       66     8870    1       DCL KEY_TEXT       CHAR (KEYED_KEY.LENGTH) BASED (FAB.RECORD_KEY$) UNAL;
       67     8871    1       DCL 1 SLEW_CHAR    ALIGNED,
       68     8872    1            2 VFC#        SBIN WORD,
       69     8873    1            2 VFC  REDEF  VFC#,
       70     8874    1             3 VFC_CHAR   CHAR(1) UNAL,
       71     8875    1             3 *          CHAR(3) UNAL;
       72     8876
       73     8877    1       DCL LINAGE_COUNTER   SBIN BASED (FAB.LINAGE_COUNTER$);
       74     8878    1       DCL IO_STATUS        CHAR(2) BASED (FAB.IO_STATUS$);
       75     8879
       76     8880    1       DCL ALT_OFFSET       SBIN WORD;                         /*#32658*/
       77     8881    1       DCL ALT_LENGTH       SBIN WORD;
       78     8882        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:4    
       79     8883    1       DCL AFTER_ADV (0:15) CHAR(1) CONSTANT INIT('`','a','b','c','d','e',
       80     8884    1                                                  'f','g','h','i','j','k',
       81     8885    1                                                  'l','m','n','o');
       82     8886    1       DCL BEFORE_ADV(0:15) CHAR(1) CONSTANT INIT('O','A','B','C','D','E',
       83     8887    1                                                  'F','G','H','I','J','K',
       84     8888    1                                                  'L','M','N','O');
       85     8889
       86     8890    1       DCL AFTER_CHN (0:15) CHAR(1) CONSTANT INIT(' ','1','2','3','4','5',
       87     8891    1                                                  '6','7','8','9',':',';',
       88     8892    1                                                  '<','=','>','?');
       89     8893    1       DCL BEFORE_CHN(0:15) CHAR(1) CONSTANT INIT(' ','Q','R','S','T','U',
       90     8894    1                                                  'V','W','X','Y','Z','[',
       91     8895    1                                                  '\',']','^','_');
       92     8896
       93     8897    1       DCL POST_SLEW      CHAR(1) CONSTANT INIT('O');
       94     8898    1       DCL PRE_SLEW       CHAR(1) CONSTANT INIT('o');  /* lowercase o */
       95     8899    1       DCL TOP_SLEW       CHAR(1);
       96     8900    1       DCL SAVE_VECTOR    BIT(72) DALIGNED;
       97     8901    1       DCL TEMP           SBIN WORD;
       98     8902
       99     8903    1       DCL KEY            UBIN WORD;
      100     8904
      101     8905    1       DCL 1 RDB         DALIGNED  BASED (FAB.BUFFER$),
      102     8906    1             2 RECORD     CHAR (REC_LEN);
      103     8907    1       DCL 1 RDB_VFC     UNAL       BASED (VFC$),
      104     8908    1             2 VFC       CHAR(1) UNAL,
      105     8909    1             2 RECORD    CHAR (REC_LEN);
      106     8910
      107     8911    1       DCL VFC$          PTR;
      108     8912    1       DCL VFC           CHAR(1)  BASED (VFC$);
      109     8913    1       DCL FIRST_PAGE    BIT(1) ALIGNED;
      110     8914        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:5    
      111     8915    1       DCL X9WE$IO_ERROR             ENTRY(2) ALTRET;
      112     8916    1       DCL X9WE$IO_ERROR_STATUS      ENTRY(2) ALTRET;
      113     8917    1       DCL X8ER$ERROR                ENTRY(3);
      114     8918    1       DCL XSA$WRITE                 ENTRY(2) ALTRET;
      115     8919    1       DCL X8CV$CONVERT_TO_INTEGER   ENTRY(3) ALTRET;
      116     8920    1       DCL X9WO$CONVERT_LINAGE       ENTRY(1);
      117     8921    1       DCL X8CV$CONVERT_FROM_INTEGER ENTRY(3) ALTRET;
      118     8922    1       DCL X9WS$REPOS                ENTRY(3);
      119     8923    1       DCL X9WU$WRITE_USER_LABEL     ENTRY(4);
      120     8924
      121     8925            %VLP_ALTKEYS (FPTN=ALT_KEYS, STCLASS="BASED (FAB.ALT_KEY$)");
      122     8940            %FPT_WRITE   (FPTN=WRITE_RAND);
      123     8971            %FPT_WRITE   (FPTN=WRITE_SEQ);
      124     9002            %FPT_WRITE   (FPTN=REWRITE_REC);
      125     9033            %FPT_CVOL    (FPTN=CLOSE_VOLUME);
      126     9048        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:6    
      127     9049        %MACRO SWAP_VOLUME_AND_REWRITE;
      128     9050           DO;
      129     9051             CLOSE_VOLUME.V.DCB# = FAB.DCB_NUM;
      130     9052             %BEFORE_TAPE_SWAP_LABEL_PROC;
      131     9053             IF FAB.B.BEGIN_TAPE_LABEL THEN
      132     9054               CALL X9WU$WRITE_USER_LABEL (FAB, CLOSE_VOLUME.UHL_,
      133     9055                                           %BEGINNING_TAPE_LABEL);
      134     9056             ELSE
      135     9057               CLOSE_VOLUME.UHL_ = VECTOR(NIL);
      136     9058             IF FAB.B.END_TAPE_LABEL THEN
      137     9059               CALL X9WU$WRITE_USER_LABEL (FAB, CLOSE_VOLUME.UTL_,
      138     9060                                           %ENDING_TAPE_LABEL);
      139     9061             ELSE
      140     9062               CLOSE_VOLUME.UTL_ = VECTOR(NIL);
      141     9063
      142     9064             CALL M$CVOL (CLOSE_VOLUME)
      143     9065               WHENALTRETURN
      144     9066                 DO;
      145     9067                   CALL X9WE$IO_ERROR (FAB);
      146     9068                   RETURN;
      147     9069                 END;
      148     9070             %AFTER_TAPE_SWAP_LABEL_PROC;
      149     9071
      150     9072             CALL M$WRITE (WRITE_SEQ) /* Retry write; previous write failed */
      151     9073               WHENALTRETURN
      152     9074                 DO;
      153     9075                   CALL X9WE$IO_ERROR (FAB, ALT_RET)
      154     9076                     WHENALTRETURN
      155     9077                       DO;
      156     9078                         IF FAB.ORG# ~= %CP6_SEQUENTIAL THEN
      157     9079                           ALTRETURN;
      158     9080                       END;
      159     9081                  END;
      160     9082           END;
      161     9083         %MEND;
      162     9084        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:7    
      163     9085            %MACRO PRINTER_VFC (@PRINTER_F (YES='1'B, NO='0'B)='0'B );
      164     9086                        WRITE_SEQ.V.DVBYTE.VFC# = YES#;
      165     9087                        IF FAB.LINAGE_LINES$ = ADDR(NIL) THEN
      166     9088                          DO CASE (ADV_CODE);
      167     9089                            CASE (%AFTER_ONE_LINE);
      168     9090                              %IF ~@PRINTER_F;
      169     9091                                 VFC = AFTER_ADV(1);
      170     9092                              %ENDIF;
      171     9093                              CALL WRITE;
      172     9094
      173     9095                            CASE (%AFTER_PAGE);
      174     9096                              VFC = %PAGE_SLEW_AFTER;
      175     9097                              CALL WRITE;
      176     9098
      177     9099                            CASE (%BEFORE_PAGE);
      178     9100                              VFC = %PAGE_SLEW_BEFORE;
      179     9101                              CALL WRITE;
      180     9102
      181     9103                            CASE (%NO_SLEW);
      182     9104                              VFC = AFTER_ADV(0);
      183     9105                              CALL WRITE;
      184     9106
      185     9107                            CASE (%BEFORE_LITERAL, %AFTER_LITERAL);
      186     9108                              VFC = ADV_CHAR.VFC.VFC_CHAR;
      187     9109                              CALL WRITE;
      188     9110
      189     9111                            CASE (%AFTER_CHANNEL);
      190     9112                              VFC = AFTER_CHN (ADV_CHAR.VFC#);
      191     9113                              CALL WRITE;
      192     9114
      193     9115                            CASE (%BEFORE_CHANNEL);
      194     9116                              VFC = BEFORE_CHN (ADV_CHAR.VFC#);
      195     9117                              CALL WRITE;
      196     9118
      197     9119                            CASE (%BEFORE_LINES);
      198     9120                              SLEW_CHAR = ADV_CHAR;
      199     9121                              CALL BEFORE_LINES;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:8    
      200     9122
      201     9123                            CASE (%AFTER_LINES);
      202     9124                              SLEW_CHAR = ADV_CHAR;
      203     9125                              CALL AFTER_LINES;
      204     9126
      205     9127                            CASE (%AFTER_POS);
      206     9128                              SLEW_CHAR = ADV_CHAR;
      207     9129                              CALL AFTER_POS;
      208     9130
      209     9131                            CASE (ELSE);
      210     9132                              CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW', 4);
      211     9133
      212     9134                          END; /* case adv_code */
      213     9135                        ELSE
      214     9136                          CALL ADD_VFC_LINAGE
      215     9137                            WHENALTRETURN
      216     9138                              DO;
      217     9139                                ALTRETURN;
      218     9140                              END;
      219     9141            %MEND;
      220     9142        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:9    
      221     9143            %MACRO NEW_PAGE (@BEFORE (YES='1'B, NO='0'B)='0'B);
      222     9144              DO;
      223     9145                IF FAB.BOTTOM$ ~= ADDR(NIL) THEN
      224     9146                  SLEW_CHAR.VFC# = SLEW_CHAR.VFC# + FAB.BOTTOM;
      225     9147                CALL X9WO$CONVERT_LINAGE (FAB);
      226     9148                IF FAB.TOP$ ~= ADDR(NIL) THEN
      227     9149                  SLEW_CHAR.VFC# = SLEW_CHAR.VFC# + FAB.TOP;
      228     9150                %IF @BEFORE;
      229     9151                   CALL BEFORE_LINES;
      230     9152                %ELSE;
      231     9153                   CALL AFTER_LINES;
      232     9154                %ENDIF;
      233     9155
      234     9156                LINAGE_COUNTER = 1;
      235     9157                IF ALT_RET THEN
      236     9158                  ALTRETURN;
      237     9159                ELSE
      238     9160                  RETURN;
      239     9161              END;
      240     9162            %MEND;
      241     9163        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:10   
      242     9164        /*--------------\
      243     9165        |  Write Random |
      244     9166        \--------------*/
      245     9167
      246     9168    2       DO CASE (FAB.FILE_STATUS);
      247     9169
      248     9170    2         CASE (%FILE_CLOSED, %FILE_LOCKED, %FILE_NOT_PRESENT,
      249     9171    2               %FILE_NEVER_OPEN);
      250     9172
      251     9173    2           IO_STATUS = %NOT_OPEN_OUTPUT;
      252     9174    2           CALL X9WE$IO_ERROR_STATUS (FAB);
      253     9175    2           RETURN;
      254     9176
      255     9177    2         CASE (%FILE_OPEN);
      256     9178
      257     9179                /* File is open */
      258     9180
      259     9181    2         CASE (ELSE);
      260     9182
      261     9183    2          CALL X8ER$ERROR (%UNEXPECTED_CASE,'X9WW$1',6);
      262     9184    2          RETURN;
      263     9185
      264     9186    2       END; /* case fab.file_status */
      265     9187
      266     9188    1         DCB$ = DCBADDR (FAB.DCB_NUM);
      267     9189    1         FAB.LAST_IO = %WRITE;
      268     9190        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:11   
      269     9191    2         DO CASE (M$XX.FUN#);
      270     9192
      271     9193    2           CASE (%IN);
      272     9194
      273     9195    2             IO_STATUS = %NOT_OPEN_OUTPUT;
      274     9196    2             CALL X9WE$IO_ERROR_STATUS (FAB);
      275     9197    2             RETURN;
      276     9198
      277     9199    2           CASE (%CREATE ,%UPDATE);
      278     9200
      279     9201    2             WRITE_RAND.V.NEWKEY#  = YES#;
      280     9202    2             WRITE_RAND.V.ONEWKEY# =  NO#;
      281     9203
      282     9204    2           CASE (ELSE);
      283     9205
      284     9206    2             CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$2', 6);
      285     9207    2             RETURN;
      286     9208
      287     9209    2         END; /* case m$xx.fun# */
      288     9210
      289     9211    1         CALL BOUNDARY_CHECK
      290     9212    1           WHENALTRETURN
      291     9213    2             DO;
      292     9214    2               RETURN;         /* Write is unsuccessful */
      293     9215    2             END;
      294     9216        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:12   
      295     9217        /*--------------\
      296     9218        |  Write Random |
      297     9219        \--------------*/
      298     9220
      299     9221    1       WRITE_RAND.V.DCB# = FAB.DCB_NUM;
      300     9222    1       WRITE_RAND.BUF_   = VECTOR (RDB);
      301     9223
      302     9224    2       DO CASE (FAB.ORG#);
      303     9225
      304     9226    2         CASE (%CP6_RELATIVE);
      305     9227
      306     9228    2           CALL X8CV$CONVERT_TO_INTEGER (FAB.RELATIVE_KEY$,
      307     9229    2                                         FAB.RELATIVE_DESC, RELATIVE_KEY);
      308     9230    2           WRITE_RAND.KEY_ = VECTOR (RELATIVE_KEY);
      309     9231
      310     9232    2         CASE (%CP6_INDEXED);
      311     9233
      312     9234    2           WRITE_RAND.KEY_ = VECTOR (FAB.RECORD_KEY$-> INDEX_KEY);
      313     9235
      314     9236    2         CASE (%CP6_KEYED);
      315     9237
      316     9238    2           KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;
      317     9239    2           KEYED_KEY.TEXT   = KEY_TEXT;
      318     9240    2           WRITE_RAND.KEY_ = VECTOR (KEYED_KEY);
      319     9241
      320     9242    2       END; /* case m$xx.org# */
      321     9243
      322     9244            %SAVE_POSITION; /* save current file position */
      323     9252        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:13   
      324     9253        /*--------------\
      325     9254        |  Write Random |
      326     9255        \--------------*/
      327     9256
      328     9257    1           IO_STATUS = %SUCCESSFUL;  /* preset to successful */
      329     9258
      330     9259    1           CALL M$WRITE (WRITE_RAND)
      331     9260    1             WHENRETURN
      332     9261    2               DO;
      333     9262                      %REPOSITION;
      334     9270    2               END;
      335     9271    1             WHENALTRETURN
      336     9272    2               DO;
      337     9273    2                 CALL X9WE$IO_ERROR (FAB, ALT_RET)
      338     9274    2                   WHENALTRETURN
      339     9275    3                     DO;
      340     9276    3                       ALTRETURN;
      341     9277    3                     END;
      342     9278    2               END;
      343     9279
      344     9280    1       RETURN;
      345     9281        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:14   
      346     9282        /*------------*/
      347     9283    1   X9WW$WRITE_SEQ:  ENTRY (FAB, ALT_RET, REC_LEN, ADV_CODE, ADV_CHAR) ALTRET;
      348     9284        /*------------*/
      349     9285
      350     9286    2       DO CASE (FAB.FILE_STATUS);
      351     9287
      352     9288    2         CASE (%FILE_CLOSED, %FILE_LOCKED, %FILE_NOT_PRESENT,
      353     9289    2               %FILE_NEVER_OPEN);
      354     9290    2           IO_STATUS = %NOT_OPEN_OUTPUT;
      355     9291    2           CALL X9WE$IO_ERROR_STATUS (FAB);
      356     9292    2           RETURN;
      357     9293
      358     9294    2         CASE (%FILE_OPEN);
      359     9295    2           DCB$ = DCBADDR (FAB.DCB_NUM);
      360     9296    2           IF FAB.LAST_IO = %OPEN THEN
      361     9297    2             FIRST_PAGE = YES#;
      362     9298    2           ELSE
      363     9299    2             FIRST_PAGE = NO#;
      364     9300    2           FAB.LAST_IO = %WRITE;
      365     9301
      366     9302    2         CASE (ELSE);
      367     9303    2            CALL X8ER$ERROR (%UNEXPECTED_CASE,'X9WW$3',6);
      368     9304    2            RETURN;
      369     9305
      370     9306    2       END; /* case fab.file_status */
      371     9307        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:15   
      372     9308    2           DO CASE (M$XX.FUN#);
      373     9309
      374     9310    2            CASE (%UPDATE);                       /*#26489*/ /*#24102*/
      375     9311    2              DCB$ = DCBADDR (FAB.DCB_NUM);       /* Allow seq. writes */
      376     9312    2              IF  M$XX.ASN# ~= %CP6_COMGROUP      /* for comgroups     */
      377     9313    2              AND M$XX.ASN# ~= %CP6_DEVICE THEN   /* and for terminals */
      378     9314    3                DO;
      379     9315    3                  IO_STATUS = %NOT_OPEN_OUTPUT;
      380     9316    3                  CALL X9WE$IO_ERROR_STATUS (FAB);
      381     9317    3                  RETURN;
      382     9318    3                END;
      383     9319
      384     9320    2            CASE (%IN);
      385     9321    2              IO_STATUS = %NOT_OPEN_OUTPUT;
      386     9322    2              CALL X9WE$IO_ERROR_STATUS (FAB);
      387     9323    2              RETURN;
      388     9324
      389     9325    2            CASE (%CREATE);
      390     9326
      391     9327    2          END; /* case m$xx.fun# */
      392     9328        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:16   
      393     9329        /*------------------\
      394     9330        |  Write Sequential |
      395     9331        \------------------*/
      396     9332
      397     9333    1          CALL BOUNDARY_CHECK
      398     9334    1            WHENALTRETURN
      399     9335    2              DO;
      400     9336    2                RETURN;         /* Write is unsuccessful */
      401     9337    2              END;
      402     9338
      403     9339    1           WRITE_SEQ.V.DCB# = FAB.DCB_NUM;
      404     9340
      405     9341    2           DO CASE (FAB.ORG#);
      406     9342
      407     9343    2             CASE (%CP6_RELATIVE);
      408     9344
      409     9345    2               WRITE_SEQ.BUF_ = VECTOR (RDB);
      410     9346    2               WRITE_SEQ.V.DVBYTE.VFC# = NO#;
      411     9347    2               CALL WRITE
      412     9348    2                 WHENALTRETURN
      413     9349    3                   DO;
      414     9350    3                     ALTRETURN;
      415     9351    3                   END;
      416     9352        /*
      417     9353              Update the relative key when KEY phase is specified.
      418     9354        */
      419     9355    2               IF FAB.RELATIVE_KEY$ ~= ADDR(NIL) THEN
      420     9356    3                 DO;
      421     9357    3                   FAB.RELATIVE_KEY = FAB.RELATIVE_KEY + 1;
      422     9358    3                   CALL X8CV$CONVERT_FROM_INTEGER (FAB.RELATIVE_KEY$,
      423     9359    3                        FAB.RELATIVE_DESC, FAB.RELATIVE_KEY);
      424     9360    3                 END;
      425     9361        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:17   
      426     9362    2             CASE (%CP6_INDEXED);
      427     9363
      428     9364    2               WRITE_SEQ.BUF_ = VECTOR (RDB);
      429     9365    2               WRITE_SEQ.V.DVBYTE = NO#;
      430     9366    2               CALL WRITE
      431     9367    2                 WHENALTRETURN
      432     9368    3                   DO;
      433     9369    3                     ALTRETURN;
      434     9370    3                   END;
      435     9371        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:18   
      436     9372    2             CASE (%CP6_KEYED);                                /*#26444*/
      437     9373
      438     9374    2               KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;
      439     9375    2               KEYED_KEY.TEXT   = KEY_TEXT;
      440     9376    2               WRITE_SEQ.KEY_ = VECTOR (KEYED_KEY);
      441     9377    2               WRITE_SEQ.BUF_ = VECTOR (RDB);
      442     9378    2               WRITE_SEQ.V.DVBYTE = NO#;
      443     9379    2               CALL WRITE
      444     9380    2                 WHENALTRETURN
      445     9381    3                   DO;
      446     9382    3                     ALTRETURN;
      447     9383    3                   END;
      448     9384        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:19   
      449     9385        /*------------------\
      450     9386        |  Write Sequential |
      451     9387        \------------------*/
      452     9388
      453     9389    2             CASE (%CP6_SEQUENTIAL, %CP6_UR, %CP6_FIXED);      /*#31542*/
      454     9390
      455     9391    3               DO CASE (FAB.ASSIGN);
      456     9392
      457     9393    3                 CASE (%CP6_PRINTER);
      458     9394    3                   VFC$ = PINCRC (FAB.BUFFER$, -1);
      459     9395    3                   WRITE_SEQ.BUF_ = VECTOR (RDB_VFC);
      460     9396                        %PRINTER_VFC (@PRINTER_F = NO);
      461     9442
      462     9443    3                 CASE (%CP6_PRINTER_F);
      463     9444    3                   VFC$ = FAB.BUFFER$;
      464     9445    3                   WRITE_SEQ.BUF_ = VECTOR (RDB);
      465     9446                        %PRINTER_VFC (@PRINTER_F = YES);
      466     9492
      467     9493    3                 CASE (ELSE);             /* Write without vfc */
      468     9494    3                   WRITE_SEQ.V.DVBYTE.VFC# = NO#;
      469     9495    3                   WRITE_SEQ.BUF_ = VECTOR (RDB);
      470     9496    3                   CALL WRITE
      471     9497    3                     WHENALTRETURN
      472     9498    4                       DO;
      473     9499    4                         ALTRETURN;
      474     9500    4                       END;
      475     9501    3               END;  /* case fab.assign */
      476     9502
      477     9503    2             CASE (ELSE);
      478     9504    2               CALL X8ER$ERROR (%UNEXPECTED_CASE,'X9WW$4',6);
      479     9505    2           END;  /*  case fab.org#  */
      480     9506    1       RETURN;
      481     9507        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:20   
      482     9508        /*------------*/
      483     9509    1     X9WW$REWRITE:        ENTRY (FAB, ALT_RET, REC_LEN) ALTRET;
      484     9510        /*------------*/
      485     9511
      486     9512    2       DO CASE (FAB.FILE_STATUS);
      487     9513
      488     9514    2         CASE (%FILE_CLOSED, %FILE_LOCKED, %FILE_NOT_PRESENT,
      489     9515    2               %FILE_NEVER_OPEN);
      490     9516
      491     9517    2           IO_STATUS = %NOT_OPEN_IO;
      492     9518    2           CALL X9WE$IO_ERROR_STATUS (FAB);
      493     9519    2           RETURN;
      494     9520
      495     9521    2         CASE (%FILE_OPEN);
      496     9522
      497     9523    2           DCB$ = DCBADDR (FAB.DCB_NUM);
      498     9524
      499     9525    3           DO CASE (M$XX.FUN#);
      500     9526
      501     9527    3             CASE (%IN, %CREATE);
      502     9528
      503     9529    3               IO_STATUS = %NOT_OPEN_IO;
      504     9530    3               CALL X9WE$IO_ERROR_STATUS (FAB);
      505     9531    3               RETURN;
      506     9532
      507     9533    3             CASE (%UPDATE);
      508     9534
      509     9535                    /* Continue */
      510     9536    3            END; /* case m$xx.fun# */
      511     9537    2        END; /* case fab.file_status */
      512     9538        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:21   
      513     9539        /*---------\
      514     9540        |  Rewrite |
      515     9541        \---------*/
      516     9542
      517     9543
      518     9544    1       CALL BOUNDARY_CHECK
      519     9545    1         WHENALTRETURN
      520     9546    2           DO;
      521     9547    2             RETURN;         /* Write is unsuccessful */
      522     9548    2           END;
      523     9549
      524     9550    1       REWRITE_REC.V.NEWKEY#  = NO#;
      525     9551    1       REWRITE_REC.V.ONEWKEY# = NO#;
      526     9552    1       REWRITE_REC.V.REWRITE# = YES#;
      527     9553    1       REWRITE_REC.V.DCB# = FAB.DCB_NUM;
      528     9554    1       REWRITE_REC.BUF_   = VECTOR (RDB);
      529     9555
      530     9556    2         DO CASE (FAB.ACS#);
      531     9557        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:22   
      532     9558        /*---------\
      533     9559        |  Rewrite |
      534     9560        \---------*/
      535     9561
      536     9562        /*V*               Rewrite_Lost_Position
      537     9563
      538     9564             M$WRITE perform a REWRITE operation using the primary key
      539     9565             causing the sequential position within an INDEXED file as well
      540     9566             as the INDX number currently in use to be destroyed.  This info
      541     9567             must be saved proir to calling M$WRITE via X9WS$REPOS and
      542     9568             repositioned to after the call to M$WRITE.  COBOL85 has the
      543     9569             additional requirement of finding records rewritten to be the
      544     9570             next sequential record (all keyed file types).  This problem is
      545     9571             also covered by the calls to X9WS$REPOS.
      546     9572        */
      547     9573
      548     9574    2           CASE (%FAB_SEQUENTIAL_ACCESS);
      549     9575    2             IF FAB.LAST_IO = %READ_NEXT
      550     9576    2             AND SUBSTR(IO_STATUS,0,1) = '0' THEN
      551     9577    3               DO;
      552     9578    3                 IF REC_LEN ~= FAB.LENGTH_READ THEN
      553     9579    4                   DO;
      554     9580    4                     IO_STATUS = %BOUNDARY_VIOLATION;
      555     9581    4                     CALL X9WE$IO_ERROR_STATUS (FAB);
      556     9582    4                     RETURN;  /* REWRITE is unsuccessful */
      557     9583    4                   END;
      558     9584
      559     9585    3                 IF  FAB.ORG# = %CP6_INDEXED                   /*#29554*/
      560     9586    3                 AND NOT FAB.B.SHARED_INDEX_ALT THEN           /*#33525*/
      561     9587    3                     CALL X9WS$REPOS (FAB, NO#, -1);
      562     9588
      563     9589    3                 IF FAB.B.SHARED_INDEX_ALT THEN                /*#32658*/
      564     9590    4                   DO;  /* Adjust file position for X9WR$READ_NEXT */
      565     9591    4                     ALT_LENGTH = ALT_KEYS.K.KEYL# (SHARED.INDX);
      566     9592    4                     ALT_OFFSET = ALT_KEYS.K.KEYX# (SHARED.INDX);
      567     9593    4                     IF SUBSTR (SHARED.KEY, 0, ALT_LENGTH) ~=    /*#35929*/
      568     9594    4                        SUBSTR (RDB.RECORD, ALT_OFFSET, ALT_LENGTH) THEN
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:23   
      569     9595    4                       SHARED.RECNUM = SHARED.RECNUM - 1;
      570     9596    4                   END;
      571     9597        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:24   
      572     9598    3                 FAB.LAST_IO = %REWRITE;
      573     9599    3                 REWRITE_REC.KEY_ = VECTOR (NIL);
      574     9600    3                 IO_STATUS = %SUCCESSFUL;
      575     9601    3                 CALL M$WRITE (REWRITE_REC)
      576     9602    3                   WHENRETURN
      577     9603    4                     DO;
      578     9604    4                       IF  FAB.ORG# = %CP6_INDEXED             /*#29554*/
      579     9605    4                       AND NOT FAB.B.SHARED_INDEX_ALT THEN     /*#33525*/
      580     9606    4                         CALL X9WS$REPOS (FAB, YES#, 1);
      581     9607    4                     END;
      582     9608        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:25   
      583     9609        /*---------\
      584     9610        |  Rewrite |
      585     9611        \---------*/
      586     9612
      587     9613    3                   WHENALTRETURN
      588     9614    4                     DO;
      589     9615    4                       CALL X9WE$IO_ERROR (FAB, ALT_RET)
      590     9616    4                         WHENALTRETURN
      591     9617    5                           DO;
      592     9618    5                             ALTRETURN;
      593     9619    5                           END;
      594     9620    4                     END;
      595     9621    3               END;  /* if successful read then do */
      596     9622    2             ELSE
      597     9623    3               DO;
      598     9624    3                 IO_STATUS = %PRIOR_NOT_READ;
      599     9625    3                 CALL X9WE$IO_ERROR_STATUS (FAB);
      600     9626    3               END;
      601     9627        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:26   
      602     9628        /*---------\
      603     9629        |  Rewrite |
      604     9630        \---------*/
      605     9631
      606     9632        /*V*               Rewrite_Lost_Position
      607     9633
      608     9634             Using M$WRITE to perform a REWRITE operation on KEYED, INDEXED,
      609     9635             and RELATIVE files with DYNAMIC access will cause the CP-6 file
      610     9636             I-O system to lose the sequential position within the file.  In
      611     9637             order to recover from this problem, the file's sequential
      612     9638             position is saved by calling X9WS$REPOS before the REWRITE
      613     9639             operation and restored by calling X9WS$REPOS after the REWRITE.
      614     9640        */
      615     9641
      616     9642    2              CASE (%FAB_DYNAMIC_ACCESS, %FAB_RANDOM_ACCESS);
      617     9643
      618     9644    2                IF FAB.B.SHARED_INDEX_ALT THEN                 /*#32658*/
      619     9645    3                  DO;   /* Adjust file position for X9WR$READ_NEXT */
      620     9646    3                    ALT_LENGTH = ALT_KEYS.K.KEYL# (SHARED.INDX);
      621     9647    3                    ALT_OFFSET = ALT_KEYS.K.KEYX# (SHARED.INDX);
      622     9648    3                    IF SUBSTR (SHARED.KEY, 0, ALT_LENGTH) ~=     /*#35929*/
      623     9649    3                       SUBSTR (RDB.RECORD, ALT_OFFSET, ALT_LENGTH) THEN
      624     9650    3                      SHARED.RECNUM = SHARED.RECNUM - 1;
      625     9651    3                  END;
      626     9652    2                ELSE
      627     9653                       %SAVE_POSITION;  /* save the current file position */
      628     9661    2                FAB.LAST_IO = %REWRITE;
      629     9662        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:27   
      630     9663
      631     9664    3                DO CASE (FAB.ORG#);
      632     9665
      633     9666    3                  CASE (%CP6_RELATIVE);
      634     9667    3                    CALL X8CV$CONVERT_TO_INTEGER (FAB.RELATIVE_KEY$,
      635     9668    3                         FAB.RELATIVE_DESC, RELATIVE_KEY);
      636     9669    3                    REWRITE_REC.KEY_ = VECTOR (RELATIVE_KEY);
      637     9670
      638     9671    3                  CASE (%CP6_INDEXED);
      639     9672    3                     REWRITE_REC.KEY_ = VECTOR (FAB.RECORD_KEY$-> INDEX_KEY);
      640     9673
      641     9674    3                   CASE (%CP6_KEYED);
      642     9675    3                     KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;
      643     9676    3                     KEYED_KEY.TEXT   = KEY_TEXT;
      644     9677    3                     REWRITE_REC.KEY_ = VECTOR (KEYED_KEY);
      645     9678
      646     9679    3                 END; /* case m$xx.org# */
      647     9680        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:28   
      648     9681        /*---------\
      649     9682        |  Rewrite |
      650     9683        \---------*/
      651     9684
      652     9685    2                IO_STATUS = %SUCCESSFUL;  /* preset status to successful */
      653     9686    2                CALL M$WRITE (REWRITE_REC)
      654     9687    2                WHENRETURN
      655     9688    3                  DO;
      656     9689    3                    IF ~ FAB.B.SHARED_INDEX_ALT THEN
      657     9690                           %REPOSITION;
      658     9698    3                  END;
      659     9699    2                WHENALTRETURN
      660     9700    3                  DO;
      661     9701    3                    CALL X9WE$IO_ERROR (FAB, ALT_RET)
      662     9702    3                      WHENALTRETURN
      663     9703    4                        DO;
      664     9704    4                          ALTRETURN;
      665     9705    4                        END;
      666     9706    3                  END;
      667     9707    2           END;  /* case */
      668     9708
      669     9709    1       RETURN;
      670     9710        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:29   
      671     9711        /*----------------*/
      672     9712    1       ADD_VFC_LINAGE: PROC ALTRET;
      673     9713        /*----------------*/
      674     9714
      675     9715        /*V*                   Linage_Top_Clause_Check
      676     9716              First a check for the first logical page is made and TOP is
      677     9717              advanced if it was specified.
      678     9718        */
      679     9719
      680     9720    2       IF  FIRST_PAGE
      681     9721    2       AND FAB.TOP$ ~= ADDR(NIL) THEN
      682     9722    3         DO;
      683     9723    3           TEMP = FAB.TOP;
      684     9724    3           SAVE_VECTOR = WRITE_SEQ.BUF_ ;
      685     9725    3           WRITE_SEQ.BUF_ = VECTOR (PRE_SLEW);
      686     9726    4           DO WHILE TEMP > 15;
      687     9727    4             TEMP = TEMP - 15;
      688     9728    4             CALL WRITE;
      689     9729    4           END;
      690     9730    3           TOP_SLEW = AFTER_ADV (TEMP);
      691     9731    3           WRITE_SEQ.BUF_ = VECTOR (TOP_SLEW);
      692     9732    3           CALL WRITE;
      693     9733    3           WRITE_SEQ.BUF_ = SAVE_VECTOR;
      694     9734    3         END;
      695     9735
      696     9736    3       DO CASE (ADV_CODE);
      697     9737
      698     9738    3         CASE (%BEFORE_PAGE);
      699     9739    3           SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER;
      700     9740                %NEW_PAGE (@BEFORE = YES);
      701     9759
      702     9760    3         CASE (%AFTER_PAGE);
      703     9761    3           SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER + 1;
      704     9762                %NEW_PAGE;
      705     9781        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:30   
      706     9782        /*---------------\
      707     9783        |  Linage Clause |
      708     9784        \---------------*/
      709     9785
      710     9786    3         CASE (%AFTER_ONE_LINE);
      711     9787
      712     9788    3           IF LINAGE_COUNTER + 1 <= FAB.LINAGE THEN
      713     9789    4            DO;
      714     9790    4              VFC = AFTER_ADV(1);
      715     9791    4              CALL WRITE;
      716     9792    4              LINAGE_COUNTER = LINAGE_COUNTER + 1;
      717     9793    4              IF FAB.FOOTING$ ~= ADDR(NIL) THEN
      718     9794    4                IF LINAGE_COUNTER >= FAB.FOOTING THEN
      719     9795    4                  ALTRETURN;   /* a page overflow has occured */
      720     9796    4              RETURN;
      721     9797    4            END;
      722     9798    3           ELSE
      723     9799    4             DO;
      724     9800    4               SLEW_CHAR.VFC# = 1;
      725     9801                    %NEW_PAGE;
      726     9820    4             END;
      727     9821        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:31   
      728     9822        /*---------------\
      729     9823        |  Linage Clause |
      730     9824        \---------------*/
      731     9825
      732     9826    3         CASE (%AFTER_LINES);
      733     9827
      734     9828    3           IF LINAGE_COUNTER + ADV_CHAR.VFC# <= FAB.LINAGE THEN
      735     9829    4             DO;
      736     9830    4               SLEW_CHAR = ADV_CHAR;
      737     9831    4               CALL AFTER_LINES;
      738     9832    4               LINAGE_COUNTER = LINAGE_COUNTER + ADV_CHAR.VFC#;
      739     9833    4               IF FAB.FOOTING$ ~= ADDR(NIL) THEN
      740     9834    4                 IF LINAGE_COUNTER >= FAB.FOOTING THEN
      741     9835    4                   ALTRETURN; /* page overflow */
      742     9836    4               RETURN;
      743     9837    4             END;
      744     9838    3           ELSE
      745     9839    4             DO;
      746     9840    4               SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER + 1;
      747     9841                    %NEW_PAGE;
      748     9860    4             END;
      749     9861        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:32   
      750     9862        /*---------------\
      751     9863        |  Linage Clause |
      752     9864        \---------------*/
      753     9865
      754     9866    3         CASE (%BEFORE_LINES);
      755     9867
      756     9868    3           IF LINAGE_COUNTER + ADV_CHAR.VFC# <= FAB.LINAGE THEN
      757     9869    4             DO;
      758     9870    4               SLEW_CHAR = ADV_CHAR;
      759     9871    4               CALL BEFORE_LINES;
      760     9872    4               LINAGE_COUNTER = LINAGE_COUNTER + ADV_CHAR.VFC#;
      761     9873    4               IF FAB.FOOTING$ ~= ADDR(NIL) THEN
      762     9874    4                 IF LINAGE_COUNTER >= FAB.FOOTING THEN
      763     9875    4                   ALTRETURN; /* page overflow */
      764     9876    4               RETURN;
      765     9877    4             END;
      766     9878    3           ELSE
      767     9879    4             DO;
      768     9880    4               SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER + 1;
      769     9881                    %NEW_PAGE (@BEFORE = YES);
      770     9900    4             END;
      771     9901        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:33   
      772     9902        /*---------------\
      773     9903        |  Linage Clause |
      774     9904        \---------------*/
      775     9905
      776     9906    3         CASE (ELSE);
      777     9907    3           CALL X8ER$ERROR (%UNEXPECTED_CASE);
      778     9908    3           RETURN;
      779     9909    3       END;  /* case slew_code */
      780     9910    2     END ADD_VFC_LINAGE;        /* proc */
      781     9911        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:34   
      782     9912        /*-------------*/
      783     9913    1       AFTER_LINES:  PROC;
      784     9914        /*-------------*/
      785     9915
      786     9916    2           SAVE_VECTOR = WRITE_SEQ.BUF_ ;
      787     9917    3           DO WHILE SLEW_CHAR.VFC# > 15;
      788     9918    3             SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - 15;
      789     9919    3             WRITE_SEQ.BUF_ = VECTOR (PRE_SLEW);
      790     9920    3             CALL WRITE;
      791     9921    3           END;
      792     9922    2           WRITE_SEQ.BUF_ = SAVE_VECTOR;
      793     9923    2           VFC = AFTER_ADV (SLEW_CHAR.VFC#);
      794     9924    2           CALL WRITE;
      795     9925
      796     9926    2     END AFTER_LINES;  /* proc */
      797     9927        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:35   
      798     9928        /*--------------*/
      799     9929    1       BEFORE_LINES:  PROC;
      800     9930        /*--------------*/
      801     9931
      802     9932    2           IF SLEW_CHAR.VFC# = 0 THEN
      803     9933    3             DO;
      804     9934    3               VFC = AFTER_ADV(0);     /*  no slew vfc is here */
      805     9935    3               CALL WRITE;
      806     9936    3             END;
      807     9937    2           ELSE
      808     9938    3             DO;
      809     9939    3               VFC = BEFORE_ADV (MOD(SLEW_CHAR.VFC#,15));
      810     9940    3               IF MOD (SLEW_CHAR.VFC#,15) = 0 THEN
      811     9941    3                 SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - 15;
      812     9942    3               ELSE
      813     9943    3                 SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - MOD (SLEW_CHAR.VFC#,15);
      814     9944    3               SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - MOD(SLEW_CHAR.VFC#,15);
      815     9945    3               CALL WRITE;
      816     9946
      817     9947    4               DO WHILE SLEW_CHAR.VFC# >= 15;
      818     9948    4               SAVE_VECTOR = WRITE_SEQ.BUF_ ;
      819     9949    4               WRITE_SEQ.BUF_ = VECTOR (POST_SLEW);
      820     9950    4                 SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - 15 ;
      821     9951    4                 CALL WRITE;
      822     9952    4               END;
      823     9953    3               WRITE_SEQ.BUF_ = SAVE_VECTOR;
      824     9954    3             END;
      825     9955
      826     9956    2     END BEFORE_LINES;  /* proc */
      827     9957        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:36   
      828     9958        /*-----------*/
      829     9959    1       AFTER_POS:  PROC;
      830     9960        /*-----------*/
      831     9961
      832     9962    3           DO SELECT (SLEW_CHAR.VFC.VFC_CHAR);
      833     9963
      834     9964    3             SELECT (' ');
      835     9965    3               VFC = AFTER_ADV (1);   /* single spacing */
      836     9966
      837     9967    3             SELECT ('+');
      838     9968    3               VFC = AFTER_ADV (0);   /* no     spacing */
      839     9969
      840     9970    3             SELECT ('0');
      841     9971    3               VFC = AFTER_ADV (2);   /* double spacing */
      842     9972
      843     9973    3             SELECT ('-');
      844     9974    3               VFC = AFTER_ADV (3);   /* triple spacing */
      845     9975
      846     9976    3             SELECT ('1');
      847     9977    3               VFC = AFTER_CHN (1);
      848     9978
      849     9979    3             SELECT ('2');
      850     9980    3               VFC = AFTER_CHN (2);
      851     9981
      852     9982    3             SELECT ('3');
      853     9983    3               VFC = AFTER_CHN (3);
      854     9984
      855     9985    3             SELECT ('4');
      856     9986    3               VFC = AFTER_CHN (4);
      857     9987
      858     9988    3             SELECT ('5');
      859     9989    3               VFC = AFTER_CHN (5);
      860     9990
      861     9991    3             SELECT ('6');
      862     9992    3               VFC = AFTER_CHN (6);
      863     9993
      864     9994    3             SELECT ('7');
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:37   
      865     9995    3               VFC = AFTER_CHN (7);
      866     9996
      867     9997    3             SELECT ('8');
      868     9998    3               VFC = AFTER_CHN (8);
      869     9999
      870    10000    3             SELECT ('9');
      871    10001    3               VFC = AFTER_CHN (9);
      872    10002
      873    10003    3             SELECT ('A', 'a');
      874    10004    3               VFC = AFTER_CHN (10);
      875    10005
      876    10006    3             SELECT ('B', 'b');
      877    10007    3               VFC = AFTER_CHN (11);
      878    10008
      879    10009    3             SELECT ('C', 'c');
      880    10010    3               VFC = AFTER_CHN (12);
      881    10011
      882    10012    3             SELECT ('D', 'd');
      883    10013    3               VFC = AFTER_CHN (13);
      884    10014
      885    10015    3             SELECT ('E', 'e');
      886    10016    3               VFC = AFTER_CHN (14);
      887    10017
      888    10018    3             SELECT ('F', 'f');
      889    10019    3               VFC = AFTER_CHN (15);
      890    10020
      891    10021    3             SELECT (ELSE);
      892    10022    3               SPECIAL_ERR_MSG = SLEW_CHAR.VFC.VFC_CHAR;
      893    10023    3               CALL X8ER$ERROR (%IO_INVALID_CHANNEL, SPECIAL_ERR_MSG);
      894    10024    3               RETURN;
      895    10025
      896    10026    3           END;  /* select slew_char */
      897    10027
      898    10028    2           CALL WRITE;
      899    10029
      900    10030    2     END AFTER_POS;   /* proc */
      901    10031        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:38   
      902    10032        /*-------*/
      903    10033    1       WRITE:             PROC   ALTRET;
      904    10034        /*-------*/
      905    10035
      906    10036    2       IO_STATUS = %SUCCESSFUL;  /*  Preset IO status  */
      907    10037
      908    10038    2       IF FAB.B.FAST_SEQUENTIAL THEN
      909    10039    2        CALL XSA$WRITE (WRITE_SEQ, FAB.XSA)
      910    10040    2          WHENALTRETURN
      911    10041    3            DO;
      912    10042    3              CALL X9WE$IO_ERROR (FAB, ALT_RET)
      913    10043    3                WHENALTRETURN
      914    10044    4                  DO;
      915    10045    4                    IF FAB.ORG# ~= %CP6_SEQUENTIAL THEN
      916    10046    4                      ALTRETURN;
      917    10047    4                  END;
      918    10048    3             END;
      919    10049    2       ELSE
      920    10050    2        CALL M$WRITE  (WRITE_SEQ)
      921    10051    2          WHENALTRETURN
      922    10052    3            DO;
      923    10053    3              CALL X9WE$IO_ERROR (FAB, ALT_RET)
      924    10054    3                WHENALTRETURN
      925    10055    4                  DO;
      926    10056    4                    IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$EOVOL THEN
      927    10057    5                      DO;
      928    10058                             %SWAP_VOLUME_AND_REWRITE;
      929    10163    5                      END;
      930    10164    4                    ELSE
      931    10165    4                      IF FAB.ORG# ~= %CP6_SEQUENTIAL THEN
      932    10166    4                        ALTRETURN;
      933    10167    4                  END;
      934    10168    3             END;
      935    10169
      936    10170    2     END WRITE;   /*  proc  */
      937    10171        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:39   
      938    10172        /*---------*/
      939    10173    1       VOLSWAP: PROC;
      940    10174        /*---------*/
      941    10175
      942    10176            %FPT_CVOL     (FPTN=FPT_CVOL);
      943    10191
      944    10192        /*N*          Assume there are no user labels for now.
      945    10193        */
      946    10194
      947    10195    2       FPT_CVOL.V.DCB# = FAB.DCB_NUM;
      948    10196    2       FPT_CVOL.UTL_ = VECTOR(NIL);
      949    10197    2       FPT_CVOL.UHL_ = VECTOR(NIL);
      950    10198    2       CALL M$CVOL (FPT_CVOL);
      951    10199
      952    10200    2     END VOLSWAP;  /* proc */
      953    10201        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:40   
      954    10202        /*----------------*/
      955    10203    1       BOUNDARY_CHECK:    PROC   ALTRET;
      956    10204        /*----------------*/
      957    10205
      958    10206        /*V*            Boundary_Violation_Check
      959    10207
      960    10208                If the current record length is larger than the largest
      961    10209                record decription entry for the file or smaller than the
      962    10210                smallest record allowed by the RECORD IS VARYING clause
      963    10211                for the file, then a boundary violation exists.
      964    10212        */
      965    10213
      966    10214    2       IF REC_LEN < FAB.MIN_REC_LEN
      967    10215    2       OR REC_LEN > FAB.MAX_REC_LEN  THEN
      968    10216    3         DO;
      969    10217    3           IO_STATUS = %BOUNDARY_VIOLATION;
      970    10218    3           CALL X9WE$IO_ERROR_STATUS (FAB);
      971    10219    3           ALTRETURN;
      972    10220    3         END;
      973    10221
      974    10222    2       END BOUNDARY_CHECK;  /* check */
      975    10223
      976    10224
      977    10225    1   END X9WW$WRITE_RAND;  /* proc */
      978    10226        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:41   
      979    10227        %EOD;

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:42   
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
      No diagnostics issued in procedure X9WW$WRITE_RAND.

   Procedure X9WW$WRITE_RAND requires 1969 words for executable code.
   Procedure X9WW$WRITE_RAND requires 154 words of local(AUTO) storage.

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:43   

 Object Unit name= X9WW$WRITE_RAND                            File name= X9WW.:X8A6TOU
 UTS= AUG 09 '97 11:12:54.12 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none    20     24  LIBCOM
    2  LblCom even  none     1      1  DEC_OR_COMMA
    3  LblCom even  none    20     24  IN_TEMP
    4  LblCom even  none     1      1  OVRCHR
    5  LblCom even  none     1      1  SELECT_TIME
    6  LblCom even  none     1      1  NO_ADVANCE_OFFSET
    7  LblCom even  none    18     22  DSPLY_SAVE
    8  LblCom even  none     3      3  D_DATE
    9  LblCom even  none     3      3  D_TIME
   10  LblCom even  none     1      1  D_DAY
   11  LblCom even  none     2      2  C_DATE
   12  LblCom even  none     2      2  C_TIME
   13  LblCom even  none     2      2  C_DAY
   14  LblCom even  none     1      1  RTHOLD2
   15  LblCom even  none     1      1  LTHOLD2
   16  LblCom even  none     1      1  NDX2
   17  LblCom even  none     1      1  IN_LEN
   18  RoData even  UTS     31     37  X9WW$WRITE_RAND
   19   Data  even  none    52     64  X9WW$WRITE_RAND
   20   Proc  even  none  1969   3661  X9WW$WRITE_RAND
   21  RoData even  none    53     65  X9WW$WRITE_RAND
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:44   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    20      0   yes    yes     yes      Std        5  X9WW$WRITE_RAND
    20    320          yes     yes      Std        5  X9WW$WRITE_SEQ
    20   1210          yes     yes      Std        3  X9WW$REWRITE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 X9WE$IO_ERROR_STATUS
 yes     yes           Std       3 X8CV$CONVERT_TO_INTEGER
 yes     yes           Std       2 X9WE$IO_ERROR
 yes     yes           Std       3 X8CV$CONVERT_FROM_INTEGER
         yes           Std       3 X8ER$ERROR
         yes           Std       3 X9WS$REPOS
         yes           Std       1 X9WO$CONVERT_LINAGE
 yes     yes           Std       2 XSA$WRITE
         yes           Std       4 X9WU$WRITE_USER_LABEL
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:45   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:46   


        1        1        /*M* X9WW$?  -- Runtime support of the WRITE and REWRITE statements */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8                 NAME:   X9WW$WRITE_RAND
        9        9
       10       10              PURPOSE: Provides runtime support for the WRITE and REWRITE statements
       11       11                       by interfacing with CP-6 Monitor Service routines which write
       12       12                       logical records to a file.
       13       13
       14       14        */
       15       15        /*D*     NAME:   X9WW$WRITE_RAND
       16       16
       17       17              PURPOSE: Provides runtime support for the WRITE and REWRITE statements
       18       18                       by interfacing with CP-6 Monitor Service routines which
       19       19                       write logical records to a file.
       20       20
       21       21            PARAMETER: FAB      -- File Attribute Block
       22       22                       ALT_RET  -- Altreturn bit for invalid key, at end
       23       23                       REC_LEN  -- Actual length of record to be written
       24       24                       ADV_CODE -- Type of advancing requeted (Before, after...)
       25       25                       ADV_CHAR -- VFC for advancing.
       26       26
       27       27                INPUT: DCB, FAB, REC_LEN, ADV_CODE, ADV_CHAR, ALT_RET
       28       28
       29       29               OUTPUT: FAB
       30       30        */
       31       31        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:47   
       32       32        /*---------------*/
       33       33          X9WW$WRITE_RAND:     PROC (FAB, ALT_RET, REC_LEN, ADV_CODE, ADV_CHAR)  ALTRET;

     33 20 000000   000000 700200 xent  X9WW$WRITE_* TSX0  ! X66_AUTO_5
        20 000001   000232 000005                    ZERO    154,5

       34       34        /*---------------*/
       35       35
       36       36            %INCLUDE B_ERRORS_C;
       37     1162            %INCLUDE X8A_SYS_FILE;
       38     7432            %INCLUDE X8A_LIBCOM;
       39     7652            %INCLUDE X8A_ERRCOM;
       40     7741            %INCLUDE X8A_MACROS;
       41     7998            %INCLUDE X9A_FAB;
       42     8185            %INCLUDE X9A_IO;
       43     8335            %INCLUDE X9A_LIB_IO;
       44     8719
       45     8720            %DCL_FAB;
       46     8842            %DCL_SHARED (@STCLASS = "BASED (FAB.SHARED$)");         /*#32658*/
       47     8851
       48     8852            %EQU PAGE_SLEW_BEFORE  =  'P';
       49     8853            %EQU PAGE_SLEW_AFTER   =  '0';
       50     8854        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:48   
       51     8855    1       DCL ADV_CODE       SBIN WORD;
       52     8856    1       DCL 1 ADV_CHAR     ALIGNED,
       53     8857    1            2 VFC#         SBIN WORD,
       54     8858    1            2 VFC  REDEF   VFC#,
       55     8859    1             3 VFC_CHAR    CHAR(1) UNAL,
       56     8860    1             3 *           CHAR(3) UNAL;
       57     8861    1       DCL REC_LEN        SBIN WORD;
       58     8862    1       DCL ALT_RET        BIT(1) ALIGNED;
       59     8863    1       DCL RELATIVE_KEY   UBIN WORD;
       60     8864    1       DCL INDEX_KEY$     PTR;
       61     8865    1       DCL INDEX_KEY      BASED CHAR (FAB.RECORD_KEY_LEN);
       62     8866    1       DCL OLD_INDEX_KEY  BASED (FAB.RECORD_KEY$) CHAR (FAB.RECORD_KEY_LEN);
       63     8867    1       DCL 1 KEYED_KEY    ALIGNED,
       64     8868    1            2 LENGTH      UBIN(9)   UNAL,
       65     8869    1            2 TEXT        CHAR(255) UNAL;
       66     8870    1       DCL KEY_TEXT       CHAR (KEYED_KEY.LENGTH) BASED (FAB.RECORD_KEY$) UNAL;
       67     8871    1       DCL 1 SLEW_CHAR    ALIGNED,
       68     8872    1            2 VFC#        SBIN WORD,
       69     8873    1            2 VFC  REDEF  VFC#,
       70     8874    1             3 VFC_CHAR   CHAR(1) UNAL,
       71     8875    1             3 *          CHAR(3) UNAL;
       72     8876
       73     8877    1       DCL LINAGE_COUNTER   SBIN BASED (FAB.LINAGE_COUNTER$);
       74     8878    1       DCL IO_STATUS        CHAR(2) BASED (FAB.IO_STATUS$);
       75     8879
       76     8880    1       DCL ALT_OFFSET       SBIN WORD;                         /*#32658*/
       77     8881    1       DCL ALT_LENGTH       SBIN WORD;
       78     8882        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:49   
       79     8883    1       DCL AFTER_ADV (0:15) CHAR(1) CONSTANT INIT('`','a','b','c','d','e',
       80     8884    1                                                  'f','g','h','i','j','k',
       81     8885    1                                                  'l','m','n','o');
       82     8886    1       DCL BEFORE_ADV(0:15) CHAR(1) CONSTANT INIT('O','A','B','C','D','E',
       83     8887    1                                                  'F','G','H','I','J','K',
       84     8888    1                                                  'L','M','N','O');
       85     8889
       86     8890    1       DCL AFTER_CHN (0:15) CHAR(1) CONSTANT INIT(' ','1','2','3','4','5',
       87     8891    1                                                  '6','7','8','9',':',';',
       88     8892    1                                                  '<','=','>','?');
       89     8893    1       DCL BEFORE_CHN(0:15) CHAR(1) CONSTANT INIT(' ','Q','R','S','T','U',
       90     8894    1                                                  'V','W','X','Y','Z','[',
       91     8895    1                                                  '\',']','^','_');
       92     8896
       93     8897    1       DCL POST_SLEW      CHAR(1) CONSTANT INIT('O');
       94     8898    1       DCL PRE_SLEW       CHAR(1) CONSTANT INIT('o');  /* lowercase o */
       95     8899    1       DCL TOP_SLEW       CHAR(1);
       96     8900    1       DCL SAVE_VECTOR    BIT(72) DALIGNED;
       97     8901    1       DCL TEMP           SBIN WORD;
       98     8902
       99     8903    1       DCL KEY            UBIN WORD;
      100     8904
      101     8905    1       DCL 1 RDB         DALIGNED  BASED (FAB.BUFFER$),
      102     8906    1             2 RECORD     CHAR (REC_LEN);
      103     8907    1       DCL 1 RDB_VFC     UNAL       BASED (VFC$),
      104     8908    1             2 VFC       CHAR(1) UNAL,
      105     8909    1             2 RECORD    CHAR (REC_LEN);
      106     8910
      107     8911    1       DCL VFC$          PTR;
      108     8912    1       DCL VFC           CHAR(1)  BASED (VFC$);
      109     8913    1       DCL FIRST_PAGE    BIT(1) ALIGNED;
      110     8914        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:50   
      111     8915    1       DCL X9WE$IO_ERROR             ENTRY(2) ALTRET;
      112     8916    1       DCL X9WE$IO_ERROR_STATUS      ENTRY(2) ALTRET;
      113     8917    1       DCL X8ER$ERROR                ENTRY(3);
      114     8918    1       DCL XSA$WRITE                 ENTRY(2) ALTRET;
      115     8919    1       DCL X8CV$CONVERT_TO_INTEGER   ENTRY(3) ALTRET;
      116     8920    1       DCL X9WO$CONVERT_LINAGE       ENTRY(1);
      117     8921    1       DCL X8CV$CONVERT_FROM_INTEGER ENTRY(3) ALTRET;
      118     8922    1       DCL X9WS$REPOS                ENTRY(3);
      119     8923    1       DCL X9WU$WRITE_USER_LABEL     ENTRY(4);
      120     8924
      121     8925            %VLP_ALTKEYS (FPTN=ALT_KEYS, STCLASS="BASED (FAB.ALT_KEY$)");
      122     8940            %FPT_WRITE   (FPTN=WRITE_RAND);
      123     8971            %FPT_WRITE   (FPTN=WRITE_SEQ);
      124     9002            %FPT_WRITE   (FPTN=REWRITE_REC);
      125     9033            %FPT_CVOL    (FPTN=CLOSE_VOLUME);
      126     9048        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:51   
      127     9049        %MACRO SWAP_VOLUME_AND_REWRITE;
      128     9050           DO;
      129     9051             CLOSE_VOLUME.V.DCB# = FAB.DCB_NUM;
      130     9052             %BEFORE_TAPE_SWAP_LABEL_PROC;
      131     9053             IF FAB.B.BEGIN_TAPE_LABEL THEN
      132     9054               CALL X9WU$WRITE_USER_LABEL (FAB, CLOSE_VOLUME.UHL_,
      133     9055                                           %BEGINNING_TAPE_LABEL);
      134     9056             ELSE
      135     9057               CLOSE_VOLUME.UHL_ = VECTOR(NIL);
      136     9058             IF FAB.B.END_TAPE_LABEL THEN
      137     9059               CALL X9WU$WRITE_USER_LABEL (FAB, CLOSE_VOLUME.UTL_,
      138     9060                                           %ENDING_TAPE_LABEL);
      139     9061             ELSE
      140     9062               CLOSE_VOLUME.UTL_ = VECTOR(NIL);
      141     9063
      142     9064             CALL M$CVOL (CLOSE_VOLUME)
      143     9065               WHENALTRETURN
      144     9066                 DO;
      145     9067                   CALL X9WE$IO_ERROR (FAB);
      146     9068                   RETURN;
      147     9069                 END;
      148     9070             %AFTER_TAPE_SWAP_LABEL_PROC;
      149     9071
      150     9072             CALL M$WRITE (WRITE_SEQ) /* Retry write; previous write failed */
      151     9073               WHENALTRETURN
      152     9074                 DO;
      153     9075                   CALL X9WE$IO_ERROR (FAB, ALT_RET)
      154     9076                     WHENALTRETURN
      155     9077                       DO;
      156     9078                         IF FAB.ORG# ~= %CP6_SEQUENTIAL THEN
      157     9079                           ALTRETURN;
      158     9080                       END;
      159     9081                  END;
      160     9082           END;
      161     9083         %MEND;
      162     9084        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:52   
      163     9085            %MACRO PRINTER_VFC (@PRINTER_F (YES='1'B, NO='0'B)='0'B );
      164     9086                        WRITE_SEQ.V.DVBYTE.VFC# = YES#;
      165     9087                        IF FAB.LINAGE_LINES$ = ADDR(NIL) THEN
      166     9088                          DO CASE (ADV_CODE);
      167     9089                            CASE (%AFTER_ONE_LINE);
      168     9090                              %IF ~@PRINTER_F;
      169     9091                                 VFC = AFTER_ADV(1);
      170     9092                              %ENDIF;
      171     9093                              CALL WRITE;
      172     9094
      173     9095                            CASE (%AFTER_PAGE);
      174     9096                              VFC = %PAGE_SLEW_AFTER;
      175     9097                              CALL WRITE;
      176     9098
      177     9099                            CASE (%BEFORE_PAGE);
      178     9100                              VFC = %PAGE_SLEW_BEFORE;
      179     9101                              CALL WRITE;
      180     9102
      181     9103                            CASE (%NO_SLEW);
      182     9104                              VFC = AFTER_ADV(0);
      183     9105                              CALL WRITE;
      184     9106
      185     9107                            CASE (%BEFORE_LITERAL, %AFTER_LITERAL);
      186     9108                              VFC = ADV_CHAR.VFC.VFC_CHAR;
      187     9109                              CALL WRITE;
      188     9110
      189     9111                            CASE (%AFTER_CHANNEL);
      190     9112                              VFC = AFTER_CHN (ADV_CHAR.VFC#);
      191     9113                              CALL WRITE;
      192     9114
      193     9115                            CASE (%BEFORE_CHANNEL);
      194     9116                              VFC = BEFORE_CHN (ADV_CHAR.VFC#);
      195     9117                              CALL WRITE;
      196     9118
      197     9119                            CASE (%BEFORE_LINES);
      198     9120                              SLEW_CHAR = ADV_CHAR;
      199     9121                              CALL BEFORE_LINES;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:53   
      200     9122
      201     9123                            CASE (%AFTER_LINES);
      202     9124                              SLEW_CHAR = ADV_CHAR;
      203     9125                              CALL AFTER_LINES;
      204     9126
      205     9127                            CASE (%AFTER_POS);
      206     9128                              SLEW_CHAR = ADV_CHAR;
      207     9129                              CALL AFTER_POS;
      208     9130
      209     9131                            CASE (ELSE);
      210     9132                              CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW', 4);
      211     9133
      212     9134                          END; /* case adv_code */
      213     9135                        ELSE
      214     9136                          CALL ADD_VFC_LINAGE
      215     9137                            WHENALTRETURN
      216     9138                              DO;
      217     9139                                ALTRETURN;
      218     9140                              END;
      219     9141            %MEND;
      220     9142        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:54   
      221     9143            %MACRO NEW_PAGE (@BEFORE (YES='1'B, NO='0'B)='0'B);
      222     9144              DO;
      223     9145                IF FAB.BOTTOM$ ~= ADDR(NIL) THEN
      224     9146                  SLEW_CHAR.VFC# = SLEW_CHAR.VFC# + FAB.BOTTOM;
      225     9147                CALL X9WO$CONVERT_LINAGE (FAB);
      226     9148                IF FAB.TOP$ ~= ADDR(NIL) THEN
      227     9149                  SLEW_CHAR.VFC# = SLEW_CHAR.VFC# + FAB.TOP;
      228     9150                %IF @BEFORE;
      229     9151                   CALL BEFORE_LINES;
      230     9152                %ELSE;
      231     9153                   CALL AFTER_LINES;
      232     9154                %ENDIF;
      233     9155
      234     9156                LINAGE_COUNTER = 1;
      235     9157                IF ALT_RET THEN
      236     9158                  ALTRETURN;
      237     9159                ELSE
      238     9160                  RETURN;
      239     9161              END;
      240     9162            %MEND;
      241     9163        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:55   
      242     9164        /*--------------\
      243     9165        |  Write Random |
      244     9166        \--------------*/
      245     9167
      246     9168    2       DO CASE (FAB.FILE_STATUS);

   9168 20 000002   200003 470500                    LDP0    @FAB,,AUTO
        20 000003   000026 235100                    LDA     22,,PR0
        20 000004   000006 115007                    CMPA    6,DL
        20 000005   000007 602005 20                 TNC     s:9168+5,AL
        20 000006   000026 710000 20                 TRA     s:9183
        20 000007   000015 710000 20                 TRA     s:9173
        20 000010   000015 710000 20                 TRA     s:9173
        20 000011   000033 710000 20                 TRA     s:9188
        20 000012   000015 710000 20                 TRA     s:9173
        20 000013   000026 710000 20                 TRA     s:9183
        20 000014   000015 710000 20                 TRA     s:9173

      247     9169
      248     9170    2         CASE (%FILE_CLOSED, %FILE_LOCKED, %FILE_NOT_PRESENT,

      249     9171    2               %FILE_NEVER_OPEN);
      250     9172
      251     9173    2           IO_STATUS = %NOT_OPEN_OUTPUT;

   9173 20 000015   000036 471500                    LDP1    30,,PR0
        20 000016   040100 100400                    MLR     fill='040'O
        20 000017   000022 000002 18                 ADSC9   PRE_SLEW+1               cn=0,n=2
        20 000020   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      252     9174    2           CALL X9WE$IO_ERROR_STATUS (FAB);

   9174 20 000021   200003 630500                    EPPR0   @FAB,,AUTO
        20 000022   000000 631400 21                 EPPR1   0
        20 000023   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 000024   000000 011000                    NOP     0

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:56   
      253     9175    2           RETURN;

   9175 20 000025   000000 702200 xent               TSX2  ! X66_ARET

      254     9176
      255     9177    2         CASE (%FILE_OPEN);

      256     9178
      257     9179                /* File is open */
      258     9180
      259     9181    2         CASE (ELSE);

      260     9182
      261     9183    2          CALL X8ER$ERROR (%UNEXPECTED_CASE,'X9WW$1',6);

   9183 20 000026   000004 630400 21                 EPPR0   4
        20 000027   000001 631400 21                 EPPR1   1
        20 000030   000000 701000 xent               TSX1    X8ER$ERROR
        20 000031   000000 011000                    NOP     0

      262     9184    2          RETURN;

   9184 20 000032   000000 702200 xent               TSX2  ! X66_ARET

      263     9185
      264     9186    2       END; /* case fab.file_status */

      265     9187
      266     9188    1         DCB$ = DCBADDR (FAB.DCB_NUM);

   9188 20 000033   000007 471400 21                 LDP1    7
        20 000034   100000 473500                    LDP3    0,,PR1
        20 000035   000034 220100                    LDX0    28,,PR0
        20 000036   300000 236110                    LDQ     0,X0,PR3
        20 000037   200101 756100                    STQ     DCB$,,AUTO

      267     9189    1         FAB.LAST_IO = %WRITE;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:57   

   9189 20 000040   000001 235007                    LDA     1,DL
        20 000041   000025 755100                    STA     21,,PR0

      268     9190        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:58   
      269     9191    2         DO CASE (M$XX.FUN#);

   9191 20 000042   200101 474500                    LDP4    DCB$,,AUTO
        20 000043   400032 221100                    LDX1    26,,PR4
        20 000044   000777 361003                    ANX1    511,DU
        20 000045   000004 101003                    CMPX1   4,DU
        20 000046   000050 602011 20                 TNC     s:9191+6,X1
        20 000047   000072 710000 20                 TRA     s:9206
        20 000050   000072 710000 20                 TRA     s:9206
        20 000051   000065 710000 20                 TRA     s:9201
        20 000052   000054 710000 20                 TRA     s:9195
        20 000053   000065 710000 20                 TRA     s:9201

      270     9192
      271     9193    2           CASE (%IN);

      272     9194
      273     9195    2             IO_STATUS = %NOT_OPEN_OUTPUT;

   9195 20 000054   000036 475500                    LDP5    30,,PR0
        20 000055   040100 100400                    MLR     fill='040'O
        20 000056   000022 000002 18                 ADSC9   PRE_SLEW+1               cn=0,n=2
        20 000057   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2

      274     9196    2             CALL X9WE$IO_ERROR_STATUS (FAB);

   9196 20 000060   200003 630500                    EPPR0   @FAB,,AUTO
        20 000061   000000 631400 21                 EPPR1   0
        20 000062   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 000063   000000 011000                    NOP     0

      275     9197    2             RETURN;

   9197 20 000064   000000 702200 xent               TSX2  ! X66_ARET

      276     9198
      277     9199    2           CASE (%CREATE ,%UPDATE);
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:59   

      278     9200
      279     9201    2             WRITE_RAND.V.NEWKEY#  = YES#;

   9201 20 000065   000200 236007                    LDQ     128,DL
        20 000066   000010 256000 19                 ORSQ    WRITE_RAND+8

      280     9202    2             WRITE_RAND.V.ONEWKEY# =  NO#;

   9202 20 000067   000010 236000 21                 LDQ     8
        20 000070   000010 356000 19                 ANSQ    WRITE_RAND+8
        20 000071   000077 710000 20                 TRA     s:9211

      281     9203
      282     9204    2           CASE (ELSE);

      283     9205
      284     9206    2             CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$2', 6);

   9206 20 000072   000011 630400 21                 EPPR0   9
        20 000073   000001 631400 21                 EPPR1   1
        20 000074   000000 701000 xent               TSX1    X8ER$ERROR
        20 000075   000000 011000                    NOP     0

      285     9207    2             RETURN;

   9207 20 000076   000000 702200 xent               TSX2  ! X66_ARET

      286     9208
      287     9209    2         END; /* case m$xx.fun# */

      288     9210
      289     9211    1         CALL BOUNDARY_CHECK

   9211 20 000077   003636 701000 20                 TSX1    BOUNDARY_CHECK
        20 000100   000102 702000 20                 TSX2    s:9214
        20 000101   000103 710000 20                 TRA     s:9221
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:60   

      290     9212    1           WHENALTRETURN
      291     9213    2             DO;

      292     9214    2               RETURN;         /* Write is unsuccessful */

   9214 20 000102   000000 702200 xent               TSX2  ! X66_ARET

      293     9215    2             END;
      294     9216        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:61   
      295     9217        /*--------------\
      296     9218        |  Write Random |
      297     9219        \--------------*/
      298     9220
      299     9221    1       WRITE_RAND.V.DCB# = FAB.DCB_NUM;

   9221 20 000103   200003 470500                    LDP0    @FAB,,AUTO
        20 000104   000034 220100                    LDX0    28,,PR0
        20 000105   000010 740000 19                 STX0    WRITE_RAND+8

      300     9222    1       WRITE_RAND.BUF_   = VECTOR (RDB);

   9222 20 000106   000052 471500                    LDP1    42,,PR0
        20 000107   200005 473500                    LDP3    @REC_LEN,,AUTO
        20 000110   300000 721100                    LXL1    0,,PR3
        20 000111   000000 635011                    EAA     0,X1
        20 000112   000002 731000                    ARS     2
        20 000113   000140 135007                    SBLA    96,DL
        20 000114   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 000115   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 000116   000004 757000 19                 STAQ    WRITE_RAND+4

      301     9223
      302     9224    2       DO CASE (FAB.ORG#);

   9224 20 000117   000002 235100                    LDA     2,,PR0
        20 000120   000007 115007                    CMPA    7,DL
        20 000121   000123 602005 20                 TNC     s:9224+4,AL
        20 000122   000204 710000 20                 TRA     s:9245
        20 000123   000204 710000 20                 TRA     s:9245
        20 000124   000204 710000 20                 TRA     s:9245
        20 000125   000165 710000 20                 TRA     s:9238
        20 000126   000204 710000 20                 TRA     s:9245
        20 000127   000204 710000 20                 TRA     s:9245
        20 000130   000132 710000 20                 TRA     s:9228
        20 000131   000154 710000 20                 TRA     s:9234

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:62   
      303     9225
      304     9226    2         CASE (%CP6_RELATIVE);

      305     9227
      306     9228    2           CALL X8CV$CONVERT_TO_INTEGER (FAB.RELATIVE_KEY$,

   9228 20 000132   200104 631500                    EPPR1   RELATIVE_KEY,,AUTO
        20 000133   200230 451500                    STP1    FIRST_PAGE+9,,AUTO
        20 000134   200003 236100                    LDQ     @FAB,,AUTO
        20 000135   000030 036003                    ADLQ    24,DU
        20 000136   200227 756100                    STQ     FIRST_PAGE+8,,AUTO
        20 000137   200003 236100                    LDQ     @FAB,,AUTO
        20 000140   000053 036003                    ADLQ    43,DU
        20 000141   200226 756100                    STQ     FIRST_PAGE+7,,AUTO
        20 000142   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 000143   000001 631400 21                 EPPR1   1
        20 000144   000000 701000 xent               TSX1    X8CV$CONVERT_TO_INTEGER
        20 000145   000000 011000                    NOP     0

      307     9229    2                                         FAB.RELATIVE_DESC, RELATIVE_KEY);
      308     9230    2           WRITE_RAND.KEY_ = VECTOR (RELATIVE_KEY);

   9230 20 000146   777640 235007                    LDA     -96,DL
        20 000147   200226 452500                    STP2    FIRST_PAGE+7,,AUTO
        20 000150   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 000151   000104 036003                    ADLQ    68,DU
        20 000152   000002 757000 19                 STAQ    WRITE_RAND+2
        20 000153   000204 710000 20                 TRA     s:9245

      309     9231
      310     9232    2         CASE (%CP6_INDEXED);

      311     9233
      312     9234    2           WRITE_RAND.KEY_ = VECTOR (FAB.RECORD_KEY$-> INDEX_KEY);

   9234 20 000154   000054 471500                    LDP1    44,,PR0
        20 000155   000031 721100                    LXL1    25,,PR0
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:63   
        20 000156   000000 635011                    EAA     0,X1
        20 000157   000002 731000                    ARS     2
        20 000160   000140 135007                    SBLA    96,DL
        20 000161   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 000162   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 000163   000002 757000 19                 STAQ    WRITE_RAND+2
        20 000164   000204 710000 20                 TRA     s:9245

      313     9235
      314     9236    2         CASE (%CP6_KEYED);

      315     9237
      316     9238    2           KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;

   9238 20 000165   000031 236100                    LDQ     25,,PR0
        20 000166   000033 736000                    QLS     27
        20 000167   200106 552140                    STBQ    KEYED_KEY,'40'O,AUTO

      317     9239    2           KEYED_KEY.TEXT   = KEY_TEXT;

   9239 20 000170   000054 471500                    LDP1    44,,PR0
        20 000171   200106 236100                    LDQ     KEYED_KEY,,AUTO
        20 000172   000033 772000                    QRL     27
        20 000173   000000 621006                    EAX1    0,QL
        20 000174   040100 100540                    MLR     fill='040'O
        20 000175   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        20 000176   200106 200377                    ADSC9   KEYED_KEY,,AUTO          cn=1,n=255

      318     9240    2           WRITE_RAND.KEY_ = VECTOR (KEYED_KEY);

   9240 20 000177   000014 235000 21                 LDA     12
        20 000200   200226 452500                    STP2    FIRST_PAGE+7,,AUTO
        20 000201   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 000202   000106 036003                    ADLQ    70,DU
        20 000203   000002 757000 19                 STAQ    WRITE_RAND+2

      319     9241
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:64   
      320     9242    2       END; /* case m$xx.org# */

      321     9243
      322     9244            %SAVE_POSITION; /* save current file position */

   9245 20 000204   200003 470500                    LDP0    @FAB,,AUTO
        20 000205   000004 235100                    LDA     4,,PR0
        20 000206   000002 115007                    CMPA    2,DL
        20 000207   000241 601000 20                 TNZ     s:9257
        20 000210   200101 471500                    LDP1    DCB$,,AUTO
        20 000211   100032 236100                    LDQ     26,,PR1
        20 000212   000777 376003                    ANQ     511,DU
        20 000213   000001 116003                    CMPQ    1,DU
        20 000214   000241 601000 20                 TNZ     s:9257

   9247 20 000215   000000 234000 1                  SZN     LIBCOM
        20 000216   000230 605000 20                 TPL     s:9250

   9248 20 000217   000016 236000 21                 LDQ     14
        20 000220   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 000221   200003 235100                    LDA     @FAB,,AUTO
        20 000222   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 000223   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 000224   000001 631400 21                 EPPR1   1
        20 000225   000000 701000 xent               TSX1    X9WS$REPOS
        20 000226   000000 011000                    NOP     0
        20 000227   000241 710000 20                 TRA     s:9257

   9250 20 000230   000020 236000 21                 LDQ     16
        20 000231   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 000232   000016 236000 21                 LDQ     14
        20 000233   200003 235100                    LDA     @FAB,,AUTO
        20 000234   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 000235   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 000236   000001 631400 21                 EPPR1   1
        20 000237   000000 701000 xent               TSX1    X9WS$REPOS
        20 000240   000000 011000                    NOP     0
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:65   

      323     9252        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:66   
      324     9253        /*--------------\
      325     9254        |  Write Random |
      326     9255        \--------------*/
      327     9256
      328     9257    1           IO_STATUS = %SUCCESSFUL;  /* preset to successful */

   9257 20 000241   200003 470500                    LDP0    @FAB,,AUTO
        20 000242   000036 471500                    LDP1    30,,PR0
        20 000243   040100 100400                    MLR     fill='040'O
        20 000244   000027 000002 18                 ADSC9   PRE_SLEW+6               cn=0,n=2
        20 000245   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      329     9258
      330     9259    1           CALL M$WRITE (WRITE_RAND)

   9259 20 000246   000000 630400 19                 EPPR0   WRITE_RAND
        20 000247   440001 713400                    CLIMB   alt,write
        20 000250   401400 401760                    pmme    nvectors=4
        20 000251   000311 702000 20                 TSX2    s:9273

      331     9260    1             WHENRETURN
      332     9261    2               DO;

      333     9262                      %REPOSITION;

   9263 20 000252   200003 470500                    LDP0    @FAB,,AUTO
        20 000253   000004 235100                    LDA     4,,PR0
        20 000254   000002 115007                    CMPA    2,DL
        20 000255   000310 601000 20                 TNZ     s:9270
        20 000256   200101 471500                    LDP1    DCB$,,AUTO
        20 000257   100032 236100                    LDQ     26,,PR1
        20 000260   000777 376003                    ANQ     511,DU
        20 000261   000001 116003                    CMPQ    1,DU
        20 000262   000310 601000 20                 TNZ     s:9270

   9265 20 000263   000000 234000 1                  SZN     LIBCOM
        20 000264   000277 605000 20                 TPL     s:9268
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:67   

   9266 20 000265   000016 236000 21                 LDQ     14
        20 000266   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 000267   000022 236000 21                 LDQ     18
        20 000270   200003 235100                    LDA     @FAB,,AUTO
        20 000271   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 000272   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 000273   000001 631400 21                 EPPR1   1
        20 000274   000000 701000 xent               TSX1    X9WS$REPOS
        20 000275   000000 011000                    NOP     0
        20 000276   000310 710000 20                 TRA     s:9270

   9268 20 000277   000024 236000 21                 LDQ     20
        20 000300   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 000301   000022 236000 21                 LDQ     18
        20 000302   200003 235100                    LDA     @FAB,,AUTO
        20 000303   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 000304   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 000305   000001 631400 21                 EPPR1   1
        20 000306   000000 701000 xent               TSX1    X9WS$REPOS
        20 000307   000000 011000                    NOP     0

      334     9270    2               END;

   9270 20 000310   000317 710000 20                 TRA     s:9280

      335     9271    1             WHENALTRETURN
      336     9272    2               DO;

      337     9273    2                 CALL X9WE$IO_ERROR (FAB, ALT_RET)

   9273 20 000311   200003 630500                    EPPR0   @FAB,,AUTO
        20 000312   000025 631400 21                 EPPR1   21
        20 000313   000000 701000 xent               TSX1    X9WE$IO_ERROR
        20 000314   000316 702000 20                 TSX2    s:9276
        20 000315   000317 710000 20                 TRA     s:9280

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:68   
      338     9274    2                   WHENALTRETURN
      339     9275    3                     DO;

      340     9276    3                       ALTRETURN;

   9276 20 000316   000000 702200 xent               TSX2  ! X66_AALT

      341     9277    3                     END;
      342     9278    2               END;

      343     9279
      344     9280    1       RETURN;

   9280 20 000317   000000 702200 xent               TSX2  ! X66_ARET

      345     9281        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:69   
      346     9282        /*------------*/
      347     9283    1   X9WW$WRITE_SEQ:  ENTRY (FAB, ALT_RET, REC_LEN, ADV_CODE, ADV_CHAR) ALTRET;

   9283 20 000320   000000 700200 xent  X9WW$WRITE_* TSX0  ! X66_AUTO_5
        20 000321   000232 000005                    ZERO    154,5

      348     9284        /*------------*/
      349     9285
      350     9286    2       DO CASE (FAB.FILE_STATUS);

   9286 20 000322   200003 470500                    LDP0    @FAB,,AUTO
        20 000323   000026 235100                    LDA     22,,PR0
        20 000324   000006 115007                    CMPA    6,DL
        20 000325   000327 602005 20                 TNC     s:9286+5,AL
        20 000326   000365 710000 20                 TRA     s:9303
        20 000327   000335 710000 20                 TRA     s:9290
        20 000330   000335 710000 20                 TRA     s:9290
        20 000331   000346 710000 20                 TRA     s:9295
        20 000332   000335 710000 20                 TRA     s:9290
        20 000333   000365 710000 20                 TRA     s:9303
        20 000334   000335 710000 20                 TRA     s:9290

      351     9287
      352     9288    2         CASE (%FILE_CLOSED, %FILE_LOCKED, %FILE_NOT_PRESENT,

      353     9289    2               %FILE_NEVER_OPEN);
      354     9290    2           IO_STATUS = %NOT_OPEN_OUTPUT;

   9290 20 000335   000036 471500                    LDP1    30,,PR0
        20 000336   040100 100400                    MLR     fill='040'O
        20 000337   000022 000002 18                 ADSC9   PRE_SLEW+1               cn=0,n=2
        20 000340   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      355     9291    2           CALL X9WE$IO_ERROR_STATUS (FAB);

   9291 20 000341   200003 630500                    EPPR0   @FAB,,AUTO
        20 000342   000000 631400 21                 EPPR1   0
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:70   
        20 000343   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 000344   000000 011000                    NOP     0

      356     9292    2           RETURN;

   9292 20 000345   000000 702200 xent               TSX2  ! X66_ARET

      357     9293
      358     9294    2         CASE (%FILE_OPEN);

      359     9295    2           DCB$ = DCBADDR (FAB.DCB_NUM);

   9295 20 000346   000007 471400 21                 LDP1    7
        20 000347   100000 473500                    LDP3    0,,PR1
        20 000350   000034 220100                    LDX0    28,,PR0
        20 000351   300000 236110                    LDQ     0,X0,PR3
        20 000352   200101 756100                    STQ     DCB$,,AUTO

      360     9296    2           IF FAB.LAST_IO = %OPEN THEN

   9296 20 000353   000025 235100                    LDA     21,,PR0
        20 000354   000003 115007                    CMPA    3,DL
        20 000355   000361 601000 20                 TNZ     s:9299

      361     9297    2             FIRST_PAGE = YES#;

   9297 20 000356   400000 236003                    LDQ     -131072,DU
        20 000357   200217 756100                    STQ     FIRST_PAGE,,AUTO
        20 000360   000362 710000 20                 TRA     s:9300

      362     9298    2           ELSE
      363     9299    2             FIRST_PAGE = NO#;

   9299 20 000361   200217 450100                    STZ     FIRST_PAGE,,AUTO

      364     9300    2           FAB.LAST_IO = %WRITE;

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:71   
   9300 20 000362   000001 236007                    LDQ     1,DL
        20 000363   000025 756100                    STQ     21,,PR0
        20 000364   000372 710000 20                 TRA     s:9308

      365     9301
      366     9302    2         CASE (ELSE);

      367     9303    2            CALL X8ER$ERROR (%UNEXPECTED_CASE,'X9WW$3',6);

   9303 20 000365   000026 630400 21                 EPPR0   22
        20 000366   000001 631400 21                 EPPR1   1
        20 000367   000000 701000 xent               TSX1    X8ER$ERROR
        20 000370   000000 011000                    NOP     0

      368     9304    2            RETURN;

   9304 20 000371   000000 702200 xent               TSX2  ! X66_ARET

      369     9305
      370     9306    2       END; /* case fab.file_status */

      371     9307        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:72   
      372     9308    2           DO CASE (M$XX.FUN#);

   9308 20 000372   200101 474500                    LDP4    DCB$,,AUTO
        20 000373   400032 221100                    LDX1    26,,PR4
        20 000374   000777 361003                    ANX1    511,DU
        20 000375   000003 101003                    CMPX1   3,DU
        20 000376   000400 602011 20                 TNC     s:9308+6,X1
        20 000377   000436 710000 20                 TRA     s:9333
        20 000400   000436 710000 20                 TRA     s:9333
        20 000401   000403 710000 20                 TRA     s:9311
        20 000402   000425 710000 20                 TRA     s:9321

      373     9309
      374     9310    2            CASE (%UPDATE);                       /*#26489*/ /*#24102*/

      375     9311    2              DCB$ = DCBADDR (FAB.DCB_NUM);       /* Allow seq. writes */

   9311 20 000403   300000 236110                    LDQ     0,X0,PR3
        20 000404   200101 756100                    STQ     DCB$,,AUTO

      376     9312    2              IF  M$XX.ASN# ~= %CP6_COMGROUP      /* for comgroups     */

   9312 20 000405   200101 474500                    LDP4    DCB$,,AUTO
        20 000406   400032 236100                    LDQ     26,,PR4
        20 000407   777000 376007                    ANQ     -512,DL
        20 000410   004000 116007                    CMPQ    2048,DL
        20 000411   000436 600000 20                 TZE     s:9333
        20 000412   003000 116007                    CMPQ    1536,DL
        20 000413   000436 600000 20                 TZE     s:9333

      377     9313    2              AND M$XX.ASN# ~= %CP6_DEVICE THEN   /* and for terminals */
      378     9314    3                DO;

      379     9315    3                  IO_STATUS = %NOT_OPEN_OUTPUT;

   9315 20 000414   000036 475500                    LDP5    30,,PR0
        20 000415   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:73   
        20 000416   000022 000002 18                 ADSC9   PRE_SLEW+1               cn=0,n=2
        20 000417   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2

      380     9316    3                  CALL X9WE$IO_ERROR_STATUS (FAB);

   9316 20 000420   200003 630500                    EPPR0   @FAB,,AUTO
        20 000421   000000 631400 21                 EPPR1   0
        20 000422   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 000423   000000 011000                    NOP     0

      381     9317    3                  RETURN;

   9317 20 000424   000000 702200 xent               TSX2  ! X66_ARET

      382     9318    3                END;
      383     9319
      384     9320    2            CASE (%IN);

      385     9321    2              IO_STATUS = %NOT_OPEN_OUTPUT;

   9321 20 000425   000036 475500                    LDP5    30,,PR0
        20 000426   040100 100400                    MLR     fill='040'O
        20 000427   000022 000002 18                 ADSC9   PRE_SLEW+1               cn=0,n=2
        20 000430   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2

      386     9322    2              CALL X9WE$IO_ERROR_STATUS (FAB);

   9322 20 000431   200003 630500                    EPPR0   @FAB,,AUTO
        20 000432   000000 631400 21                 EPPR1   0
        20 000433   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 000434   000000 011000                    NOP     0

      387     9323    2              RETURN;

   9323 20 000435   000000 702200 xent               TSX2  ! X66_ARET

      388     9324
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:74   
      389     9325    2            CASE (%CREATE);

      390     9326
      391     9327    2          END; /* case m$xx.fun# */

      392     9328        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:75   
      393     9329        /*------------------\
      394     9330        |  Write Sequential |
      395     9331        \------------------*/
      396     9332
      397     9333    1          CALL BOUNDARY_CHECK

   9333 20 000436   003636 701000 20                 TSX1    BOUNDARY_CHECK
        20 000437   000441 702000 20                 TSX2    s:9336
        20 000440   000442 710000 20                 TRA     s:9339

      398     9334    1            WHENALTRETURN
      399     9335    2              DO;

      400     9336    2                RETURN;         /* Write is unsuccessful */

   9336 20 000441   000000 702200 xent               TSX2  ! X66_ARET

      401     9337    2              END;
      402     9338
      403     9339    1           WRITE_SEQ.V.DCB# = FAB.DCB_NUM;

   9339 20 000442   200003 470500                    LDP0    @FAB,,AUTO
        20 000443   000034 220100                    LDX0    28,,PR0
        20 000444   000024 740000 19                 STX0    WRITE_SEQ+8

      404     9340
      405     9341    2           DO CASE (FAB.ORG#);

   9341 20 000445   000002 235100                    LDA     2,,PR0
        20 000446   000020 115007                    CMPA    16,DL
        20 000447   000451 602005 20                 TNC     s:9341+4,AL
        20 000450   001203 710000 20                 TRA     s:9504
        20 000451   001203 710000 20                 TRA     s:9504
        20 000452   000616 710000 20                 TRA     s:9391
        20 000453   000557 710000 20                 TRA     s:9374
        20 000454   001203 710000 20                 TRA     s:9504
        20 000455   000616 710000 20                 TRA     s:9391
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:76   
        20 000456   000471 710000 20                 TRA     s:9345
        20 000457   000536 710000 20                 TRA     s:9364
        20 000460   001203 710000 20                 TRA     s:9504
        20 000461   001203 710000 20                 TRA     s:9504
        20 000462   001203 710000 20                 TRA     s:9504
        20 000463   001203 710000 20                 TRA     s:9504
        20 000464   001203 710000 20                 TRA     s:9504
        20 000465   001203 710000 20                 TRA     s:9504
        20 000466   001203 710000 20                 TRA     s:9504
        20 000467   001203 710000 20                 TRA     s:9504
        20 000470   000616 710000 20                 TRA     s:9391

      406     9342
      407     9343    2             CASE (%CP6_RELATIVE);

      408     9344
      409     9345    2               WRITE_SEQ.BUF_ = VECTOR (RDB);

   9345 20 000471   000052 471500                    LDP1    42,,PR0
        20 000472   200005 473500                    LDP3    @REC_LEN,,AUTO
        20 000473   300000 721100                    LXL1    0,,PR3
        20 000474   000000 636011                    EAQ     0,X1
        20 000475   000022 732000                    QRS     18
        20 000476   000064 737000                    LLS     52
        20 000477   000140 135007                    SBLA    96,DL
        20 000500   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 000501   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 000502   000020 757000 19                 STAQ    WRITE_SEQ+4

      410     9346    2               WRITE_SEQ.V.DVBYTE.VFC# = NO#;

   9346 20 000503   000031 236000 21                 LDQ     25
        20 000504   000027 356000 19                 ANSQ    WRITE_SEQ+11

      411     9347    2               CALL WRITE

   9347 20 000505   003175 701000 20                 TSX1    WRITE
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:77   
        20 000506   000510 702000 20                 TSX2    s:9350
        20 000507   000511 710000 20                 TRA     s:9355

      412     9348    2                 WHENALTRETURN
      413     9349    3                   DO;

      414     9350    3                     ALTRETURN;

   9350 20 000510   000000 702200 xent               TSX2  ! X66_AALT

      415     9351    3                   END;
      416     9352        /*
      417     9353              Update the relative key when KEY phase is specified.
      418     9354        */
      419     9355    2               IF FAB.RELATIVE_KEY$ ~= ADDR(NIL) THEN

   9355 20 000511   200003 470500                    LDP0    @FAB,,AUTO
        20 000512   000053 236100                    LDQ     43,,PR0
        20 000513   000032 116000 21                 CMPQ    26
        20 000514   001207 600000 20                 TZE     s:9506

      420     9356    3                 DO;

      421     9357    3                   FAB.RELATIVE_KEY = FAB.RELATIVE_KEY + 1;

   9357 20 000515   000027 235100                    LDA     23,,PR0
        20 000516   000001 035007                    ADLA    1,DL
        20 000517   000027 755100                    STA     23,,PR0

      422     9358    3                   CALL X8CV$CONVERT_FROM_INTEGER (FAB.RELATIVE_KEY$,

   9358 20 000520   200003 236100                    LDQ     @FAB,,AUTO
        20 000521   000027 036003                    ADLQ    23,DU
        20 000522   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 000523   200003 236100                    LDQ     @FAB,,AUTO
        20 000524   000030 036003                    ADLQ    24,DU
        20 000525   200227 756100                    STQ     FIRST_PAGE+8,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:78   
        20 000526   200003 236100                    LDQ     @FAB,,AUTO
        20 000527   000053 036003                    ADLQ    43,DU
        20 000530   200226 756100                    STQ     FIRST_PAGE+7,,AUTO
        20 000531   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 000532   000001 631400 21                 EPPR1   1
        20 000533   000000 701000 xent               TSX1    X8CV$CONVERT_FROM_INTEGER
        20 000534   000000 011000                    NOP     0

      423     9359    3                        FAB.RELATIVE_DESC, FAB.RELATIVE_KEY);
      424     9360    3                 END;

   9360 20 000535   001207 710000 20                 TRA     s:9506

      425     9361        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:79   
      426     9362    2             CASE (%CP6_INDEXED);

      427     9363
      428     9364    2               WRITE_SEQ.BUF_ = VECTOR (RDB);

   9364 20 000536   000052 471500                    LDP1    42,,PR0
        20 000537   200005 473500                    LDP3    @REC_LEN,,AUTO
        20 000540   300000 721100                    LXL1    0,,PR3
        20 000541   000000 636011                    EAQ     0,X1
        20 000542   000022 732000                    QRS     18
        20 000543   000064 737000                    LLS     52
        20 000544   000140 135007                    SBLA    96,DL
        20 000545   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 000546   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 000547   000020 757000 19                 STAQ    WRITE_SEQ+4

      429     9365    2               WRITE_SEQ.V.DVBYTE = NO#;

   9365 20 000550   000000 236003                    LDQ     0,DU
        20 000551   000027 552040 19                 STBQ    WRITE_SEQ+11,'40'O

      430     9366    2               CALL WRITE

   9366 20 000552   003175 701000 20                 TSX1    WRITE
        20 000553   000555 702000 20                 TSX2    s:9369
        20 000554   000556 710000 20                 TRA     s:9369+1

      431     9367    2                 WHENALTRETURN
      432     9368    3                   DO;

      433     9369    3                     ALTRETURN;

   9369 20 000555   000000 702200 xent               TSX2  ! X66_AALT
        20 000556   001207 710000 20                 TRA     s:9506

      434     9370    3                   END;
      435     9371        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:80   
      436     9372    2             CASE (%CP6_KEYED);                                /*#26444*/

      437     9373
      438     9374    2               KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;

   9374 20 000557   000031 236100                    LDQ     25,,PR0
        20 000560   000033 736000                    QLS     27
        20 000561   200106 552140                    STBQ    KEYED_KEY,'40'O,AUTO

      439     9375    2               KEYED_KEY.TEXT   = KEY_TEXT;

   9375 20 000562   000054 471500                    LDP1    44,,PR0
        20 000563   200106 236100                    LDQ     KEYED_KEY,,AUTO
        20 000564   000033 772000                    QRL     27
        20 000565   000000 621006                    EAX1    0,QL
        20 000566   040100 100540                    MLR     fill='040'O
        20 000567   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
        20 000570   200106 200377                    ADSC9   KEYED_KEY,,AUTO          cn=1,n=255

      440     9376    2               WRITE_SEQ.KEY_ = VECTOR (KEYED_KEY);

   9376 20 000571   000014 235000 21                 LDA     12
        20 000572   200226 452500                    STP2    FIRST_PAGE+7,,AUTO
        20 000573   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 000574   000106 036003                    ADLQ    70,DU
        20 000575   000016 757000 19                 STAQ    WRITE_SEQ+2

      441     9377    2               WRITE_SEQ.BUF_ = VECTOR (RDB);

   9377 20 000576   000052 471500                    LDP1    42,,PR0
        20 000577   200005 473500                    LDP3    @REC_LEN,,AUTO
        20 000600   300000 722100                    LXL2    0,,PR3
        20 000601   000000 635012                    EAA     0,X2
        20 000602   000002 731000                    ARS     2
        20 000603   000140 135007                    SBLA    96,DL
        20 000604   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 000605   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:81   
        20 000606   000020 757000 19                 STAQ    WRITE_SEQ+4

      442     9378    2               WRITE_SEQ.V.DVBYTE = NO#;

   9378 20 000607   000000 236003                    LDQ     0,DU
        20 000610   000027 552040 19                 STBQ    WRITE_SEQ+11,'40'O

      443     9379    2               CALL WRITE

   9379 20 000611   003175 701000 20                 TSX1    WRITE
        20 000612   000614 702000 20                 TSX2    s:9382
        20 000613   000615 710000 20                 TRA     s:9382+1

      444     9380    2                 WHENALTRETURN
      445     9381    3                   DO;

      446     9382    3                     ALTRETURN;

   9382 20 000614   000000 702200 xent               TSX2  ! X66_AALT
        20 000615   001207 710000 20                 TRA     s:9506

      447     9383    3                   END;
      448     9384        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:82   
      449     9385        /*------------------\
      450     9386        |  Write Sequential |
      451     9387        \------------------*/
      452     9388
      453     9389    2             CASE (%CP6_SEQUENTIAL, %CP6_UR, %CP6_FIXED);      /*#31542*/

      454     9390
      455     9391    3               DO CASE (FAB.ASSIGN);

   9391 20 000616   000000 235100                    LDA     0,,PR0
        20 000617   000002 115007                    CMPA    2,DL
        20 000620   000622 602005 20                 TNC     s:9391+4,AL
        20 000621   001163 710000 20                 TRA     s:9494
        20 000622   000624 710000 20                 TRA     s:9394
        20 000623   001005 710000 20                 TRA     s:9444

      456     9392
      457     9393    3                 CASE (%CP6_PRINTER);

      458     9394    3                   VFC$ = PINCRC (FAB.BUFFER$, -1);

   9394 20 000624   000052 236100                    LDQ     42,,PR0
        20 000625   000033 036000 21                 ADLQ    27
        20 000626   200216 756100                    STQ     VFC$,,AUTO

      459     9395    3                   WRITE_SEQ.BUF_ = VECTOR (RDB_VFC);

   9395 20 000627   200005 471500                    LDP1    @REC_LEN,,AUTO
        20 000630   100000 721100                    LXL1    0,,PR1
        20 000631   000001 622011                    EAX2    1,X1
        20 000632   000000 635012                    EAA     0,X2
        20 000633   000002 731000                    ARS     2
        20 000634   000140 135007                    SBLA    96,DL
        20 000635   000020 757000 19                 STAQ    WRITE_SEQ+4

      460     9396                        %PRINTER_VFC (@PRINTER_F = NO);

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:83   
   9397 20 000636   100000 236003                    LDQ     32768,DU
        20 000637   000027 256000 19                 ORSQ    WRITE_SEQ+11

   9398 20 000640   000045 236100                    LDQ     37,,PR0
        20 000641   000032 116000 21                 CMPQ    26
        20 000642   001000 601000 20                 TNZ     s:9436

   9399 20 000643   200006 473500                    LDP3    @ADV_CODE,,AUTO
        20 000644   300000 235100                    LDA     0,,PR3
        20 000645   000013 115007                    CMPA    11,DL
        20 000646   000650 602005 20                 TNC     s:9399+5,AL
        20 000647   000773 710000 20                 TRA     s:9433
        20 000650   000663 710000 20                 TRA     s:9402
        20 000651   000710 710000 20                 TRA     s:9412
        20 000652   000701 710000 20                 TRA     s:9409
        20 000653   000672 710000 20                 TRA     s:9406
        20 000654   000751 710000 20                 TRA     s:9424
        20 000655   000757 710000 20                 TRA     s:9427
        20 000656   000740 710000 20                 TRA     s:9421
        20 000657   000727 710000 20                 TRA     s:9418
        20 000660   000717 710000 20                 TRA     s:9415
        20 000661   000717 710000 20                 TRA     s:9415
        20 000662   000765 710000 20                 TRA     s:9430

   9402 20 000663   200216 474500                    LDP4    VFC$,,AUTO
        20 000664   040100 100400                    MLR     fill='040'O
        20 000665   000000 200001 18                 ADSC9   AFTER_ADV                cn=1,n=1
        20 000666   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

   9404 20 000667   003175 701000 20                 TSX1    WRITE
        20 000670   000000 011000                    NOP     0
        20 000671   001207 710000 20                 TRA     s:9506

   9406 20 000672   200216 474500                    LDP4    VFC$,,AUTO
        20 000673   040100 100400                    MLR     fill='040'O
        20 000674   000034 000001 21                 ADSC9   28                       cn=0,n=1
        20 000675   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:84   

   9407 20 000676   003175 701000 20                 TSX1    WRITE
        20 000677   000000 011000                    NOP     0
        20 000700   001207 710000 20                 TRA     s:9506

   9409 20 000701   200216 474500                    LDP4    VFC$,,AUTO
        20 000702   040100 100400                    MLR     fill='040'O
        20 000703   000035 000001 21                 ADSC9   29                       cn=0,n=1
        20 000704   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

   9410 20 000705   003175 701000 20                 TSX1    WRITE
        20 000706   000000 011000                    NOP     0
        20 000707   001207 710000 20                 TRA     s:9506

   9412 20 000710   200216 474500                    LDP4    VFC$,,AUTO
        20 000711   040100 100400                    MLR     fill='040'O
        20 000712   000000 000001 18                 ADSC9   AFTER_ADV                cn=0,n=1
        20 000713   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

   9413 20 000714   003175 701000 20                 TSX1    WRITE
        20 000715   000000 011000                    NOP     0
        20 000716   001207 710000 20                 TRA     s:9506

   9415 20 000717   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 000720   200216 475500                    LDP5    VFC$,,AUTO
        20 000721   040100 100500                    MLR     fill='040'O
        20 000722   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        20 000723   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

   9416 20 000724   003175 701000 20                 TSX1    WRITE
        20 000725   000000 011000                    NOP     0
        20 000726   001207 710000 20                 TRA     s:9506

   9418 20 000727   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 000730   400000 235100                    LDA     0,,PR4
        20 000731   200216 475500                    LDP5    VFC$,,AUTO
        20 000732   040100 100405                    MLR     fill='040'O
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:85   
        20 000733   000010 000001 18                 ADSC9   AFTER_CHN,A              cn=0,n=1
        20 000734   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

   9419 20 000735   003175 701000 20                 TSX1    WRITE
        20 000736   000000 011000                    NOP     0
        20 000737   001207 710000 20                 TRA     s:9506

   9421 20 000740   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 000741   400000 235100                    LDA     0,,PR4
        20 000742   200216 475500                    LDP5    VFC$,,AUTO
        20 000743   040100 100405                    MLR     fill='040'O
        20 000744   000014 000001 18                 ADSC9   BEFORE_CHN,A             cn=0,n=1
        20 000745   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

   9422 20 000746   003175 701000 20                 TSX1    WRITE
        20 000747   000000 011000                    NOP     0
        20 000750   001207 710000 20                 TRA     s:9506

   9424 20 000751   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 000752   400000 236100                    LDQ     0,,PR4
        20 000753   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9425 20 000754   002457 701000 20                 TSX1    BEFORE_LINES
        20 000755   000000 011000                    NOP     0
        20 000756   001207 710000 20                 TRA     s:9506

   9427 20 000757   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 000760   400000 236100                    LDQ     0,,PR4
        20 000761   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9428 20 000762   002425 701000 20                 TSX1    AFTER_LINES
        20 000763   000000 011000                    NOP     0
        20 000764   001207 710000 20                 TRA     s:9506

   9430 20 000765   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 000766   400000 236100                    LDQ     0,,PR4
        20 000767   200206 756100                    STQ     SLEW_CHAR,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:86   

   9431 20 000770   002547 701000 20                 TSX1    AFTER_POS
        20 000771   000000 011000                    NOP     0
        20 000772   001207 710000 20                 TRA     s:9506

   9433 20 000773   000037 630400 21                 EPPR0   31
        20 000774   000001 631400 21                 EPPR1   1
        20 000775   000000 701000 xent               TSX1    X8ER$ERROR
        20 000776   000000 011000                    NOP     0

   9434 20 000777   001207 710000 20                 TRA     s:9506

   9436 20 001000   001735 701000 20                 TSX1    ADD_VFC_LINAGE
        20 001001   001003 702000 20                 TSX2    s:9439
        20 001002   001004 710000 20                 TRA     s:9439+1

   9439 20 001003   000000 702200 xent               TSX2  ! X66_AALT
        20 001004   001207 710000 20                 TRA     s:9506

      461     9442
      462     9443    3                 CASE (%CP6_PRINTER_F);

      463     9444    3                   VFC$ = FAB.BUFFER$;

   9444 20 001005   000052 236100                    LDQ     42,,PR0
        20 001006   200216 756100                    STQ     VFC$,,AUTO

      464     9445    3                   WRITE_SEQ.BUF_ = VECTOR (RDB);

   9445 20 001007   000052 471500                    LDP1    42,,PR0
        20 001010   200005 473500                    LDP3    @REC_LEN,,AUTO
        20 001011   300000 721100                    LXL1    0,,PR3
        20 001012   000000 635011                    EAA     0,X1
        20 001013   000002 731000                    ARS     2
        20 001014   000140 135007                    SBLA    96,DL
        20 001015   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 001016   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:87   
        20 001017   000020 757000 19                 STAQ    WRITE_SEQ+4

      465     9446                        %PRINTER_VFC (@PRINTER_F = YES);

   9447 20 001020   100000 236003                    LDQ     32768,DU
        20 001021   000027 256000 19                 ORSQ    WRITE_SEQ+11

   9448 20 001022   000045 236100                    LDQ     37,,PR0
        20 001023   000032 116000 21                 CMPQ    26
        20 001024   001156 601000 20                 TNZ     s:9486

   9449 20 001025   200006 471500                    LDP1    @ADV_CODE,,AUTO
        20 001026   100000 235100                    LDA     0,,PR1
        20 001027   000013 115007                    CMPA    11,DL
        20 001030   001032 602005 20                 TNC     s:9449+5,AL
        20 001031   001151 710000 20                 TRA     s:9483
        20 001032   001045 710000 20                 TRA     s:9454
        20 001033   001066 710000 20                 TRA     s:9462
        20 001034   001057 710000 20                 TRA     s:9459
        20 001035   001050 710000 20                 TRA     s:9456
        20 001036   001127 710000 20                 TRA     s:9474
        20 001037   001135 710000 20                 TRA     s:9477
        20 001040   001116 710000 20                 TRA     s:9471
        20 001041   001105 710000 20                 TRA     s:9468
        20 001042   001075 710000 20                 TRA     s:9465
        20 001043   001075 710000 20                 TRA     s:9465
        20 001044   001143 710000 20                 TRA     s:9480

   9454 20 001045   003175 701000 20                 TSX1    WRITE
        20 001046   000000 011000                    NOP     0
        20 001047   001207 710000 20                 TRA     s:9506

   9456 20 001050   200216 474500                    LDP4    VFC$,,AUTO
        20 001051   040100 100400                    MLR     fill='040'O
        20 001052   000034 000001 21                 ADSC9   28                       cn=0,n=1
        20 001053   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:88   
   9457 20 001054   003175 701000 20                 TSX1    WRITE
        20 001055   000000 011000                    NOP     0
        20 001056   001207 710000 20                 TRA     s:9506

   9459 20 001057   200216 474500                    LDP4    VFC$,,AUTO
        20 001060   040100 100400                    MLR     fill='040'O
        20 001061   000035 000001 21                 ADSC9   29                       cn=0,n=1
        20 001062   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

   9460 20 001063   003175 701000 20                 TSX1    WRITE
        20 001064   000000 011000                    NOP     0
        20 001065   001207 710000 20                 TRA     s:9506

   9462 20 001066   200216 474500                    LDP4    VFC$,,AUTO
        20 001067   040100 100400                    MLR     fill='040'O
        20 001070   000000 000001 18                 ADSC9   AFTER_ADV                cn=0,n=1
        20 001071   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

   9463 20 001072   003175 701000 20                 TSX1    WRITE
        20 001073   000000 011000                    NOP     0
        20 001074   001207 710000 20                 TRA     s:9506

   9465 20 001075   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 001076   200216 475500                    LDP5    VFC$,,AUTO
        20 001077   040100 100500                    MLR     fill='040'O
        20 001100   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
        20 001101   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

   9466 20 001102   003175 701000 20                 TSX1    WRITE
        20 001103   000000 011000                    NOP     0
        20 001104   001207 710000 20                 TRA     s:9506

   9468 20 001105   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 001106   400000 235100                    LDA     0,,PR4
        20 001107   200216 475500                    LDP5    VFC$,,AUTO
        20 001110   040100 100405                    MLR     fill='040'O
        20 001111   000010 000001 18                 ADSC9   AFTER_CHN,A              cn=0,n=1
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:89   
        20 001112   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

   9469 20 001113   003175 701000 20                 TSX1    WRITE
        20 001114   000000 011000                    NOP     0
        20 001115   001207 710000 20                 TRA     s:9506

   9471 20 001116   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 001117   400000 235100                    LDA     0,,PR4
        20 001120   200216 475500                    LDP5    VFC$,,AUTO
        20 001121   040100 100405                    MLR     fill='040'O
        20 001122   000014 000001 18                 ADSC9   BEFORE_CHN,A             cn=0,n=1
        20 001123   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

   9472 20 001124   003175 701000 20                 TSX1    WRITE
        20 001125   000000 011000                    NOP     0
        20 001126   001207 710000 20                 TRA     s:9506

   9474 20 001127   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 001130   400000 236100                    LDQ     0,,PR4
        20 001131   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9475 20 001132   002457 701000 20                 TSX1    BEFORE_LINES
        20 001133   000000 011000                    NOP     0
        20 001134   001207 710000 20                 TRA     s:9506

   9477 20 001135   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 001136   400000 236100                    LDQ     0,,PR4
        20 001137   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9478 20 001140   002425 701000 20                 TSX1    AFTER_LINES
        20 001141   000000 011000                    NOP     0
        20 001142   001207 710000 20                 TRA     s:9506

   9480 20 001143   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 001144   400000 236100                    LDQ     0,,PR4
        20 001145   200206 756100                    STQ     SLEW_CHAR,,AUTO

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:90   
   9481 20 001146   002547 701000 20                 TSX1    AFTER_POS
        20 001147   000000 011000                    NOP     0
        20 001150   001207 710000 20                 TRA     s:9506

   9483 20 001151   000037 630400 21                 EPPR0   31
        20 001152   000001 631400 21                 EPPR1   1
        20 001153   000000 701000 xent               TSX1    X8ER$ERROR
        20 001154   000000 011000                    NOP     0

   9484 20 001155   001207 710000 20                 TRA     s:9506

   9486 20 001156   001735 701000 20                 TSX1    ADD_VFC_LINAGE
        20 001157   001161 702000 20                 TSX2    s:9489
        20 001160   001162 710000 20                 TRA     s:9489+1

   9489 20 001161   000000 702200 xent               TSX2  ! X66_AALT
        20 001162   001207 710000 20                 TRA     s:9506

      466     9492
      467     9493    3                 CASE (ELSE);             /* Write without vfc */

      468     9494    3                   WRITE_SEQ.V.DVBYTE.VFC# = NO#;

   9494 20 001163   000031 236000 21                 LDQ     25
        20 001164   000027 356000 19                 ANSQ    WRITE_SEQ+11

      469     9495    3                   WRITE_SEQ.BUF_ = VECTOR (RDB);

   9495 20 001165   000052 471500                    LDP1    42,,PR0
        20 001166   200005 473500                    LDP3    @REC_LEN,,AUTO
        20 001167   300000 721100                    LXL1    0,,PR3
        20 001170   000000 635011                    EAA     0,X1
        20 001171   000002 731000                    ARS     2
        20 001172   000140 135007                    SBLA    96,DL
        20 001173   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 001174   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 001175   000020 757000 19                 STAQ    WRITE_SEQ+4
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:91   

      470     9496    3                   CALL WRITE

   9496 20 001176   003175 701000 20                 TSX1    WRITE
        20 001177   001201 702000 20                 TSX2    s:9499
        20 001200   001202 710000 20                 TRA     s:9501

      471     9497    3                     WHENALTRETURN
      472     9498    4                       DO;

      473     9499    4                         ALTRETURN;

   9499 20 001201   000000 702200 xent               TSX2  ! X66_AALT

      474     9500    4                       END;
      475     9501    3               END;  /* case fab.assign */

   9501 20 001202   001207 710000 20                 TRA     s:9506

      476     9502
      477     9503    2             CASE (ELSE);

      478     9504    2               CALL X8ER$ERROR (%UNEXPECTED_CASE,'X9WW$4',6);

   9504 20 001203   000042 630400 21                 EPPR0   34
        20 001204   000001 631400 21                 EPPR1   1
        20 001205   000000 701000 xent               TSX1    X8ER$ERROR
        20 001206   000000 011000                    NOP     0

      479     9505    2           END;  /*  case fab.org#  */

      480     9506    1       RETURN;

   9506 20 001207   000000 702200 xent               TSX2  ! X66_ARET

      481     9507        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:92   
      482     9508        /*------------*/
      483     9509    1     X9WW$REWRITE:        ENTRY (FAB, ALT_RET, REC_LEN) ALTRET;

   9509 20 001210   000000 700200 xent  X9WW$REWRITE TSX0  ! X66_AUTO_5
        20 001211   000232 000005                    ZERO    154,5

      484     9510        /*------------*/
      485     9511
      486     9512    2       DO CASE (FAB.FILE_STATUS);

   9512 20 001212   200003 470500                    LDP0    @FAB,,AUTO
        20 001213   000026 235100                    LDA     22,,PR0
        20 001214   000006 115007                    CMPA    6,DL
        20 001215   001217 602005 20                 TNC     s:9512+5,AL
        20 001216   001266 710000 20                 TRA     s:9544
        20 001217   001225 710000 20                 TRA     s:9517
        20 001220   001225 710000 20                 TRA     s:9517
        20 001221   001236 710000 20                 TRA     s:9523
        20 001222   001225 710000 20                 TRA     s:9517
        20 001223   001266 710000 20                 TRA     s:9544
        20 001224   001225 710000 20                 TRA     s:9517

      487     9513
      488     9514    2         CASE (%FILE_CLOSED, %FILE_LOCKED, %FILE_NOT_PRESENT,

      489     9515    2               %FILE_NEVER_OPEN);
      490     9516
      491     9517    2           IO_STATUS = %NOT_OPEN_IO;

   9517 20 001225   000036 471500                    LDP1    30,,PR0
        20 001226   040100 100400                    MLR     fill='040'O
        20 001227   000034 000002 18                 ADSC9   PRE_SLEW+11              cn=0,n=2
        20 001230   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      492     9518    2           CALL X9WE$IO_ERROR_STATUS (FAB);

   9518 20 001231   200003 630500                    EPPR0   @FAB,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:93   
        20 001232   000000 631400 21                 EPPR1   0
        20 001233   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 001234   000000 011000                    NOP     0

      493     9519    2           RETURN;

   9519 20 001235   000000 702200 xent               TSX2  ! X66_ARET

      494     9520
      495     9521    2         CASE (%FILE_OPEN);

      496     9522
      497     9523    2           DCB$ = DCBADDR (FAB.DCB_NUM);

   9523 20 001236   000007 471400 21                 LDP1    7
        20 001237   100000 473500                    LDP3    0,,PR1
        20 001240   000034 220100                    LDX0    28,,PR0
        20 001241   300000 236110                    LDQ     0,X0,PR3
        20 001242   200101 756100                    STQ     DCB$,,AUTO

      498     9524
      499     9525    3           DO CASE (M$XX.FUN#);

   9525 20 001243   200101 474500                    LDP4    DCB$,,AUTO
        20 001244   400032 221100                    LDX1    26,,PR4
        20 001245   000777 361003                    ANX1    511,DU
        20 001246   000004 101003                    CMPX1   4,DU
        20 001247   001251 602011 20                 TNC     s:9525+6,X1
        20 001250   001266 710000 20                 TRA     s:9544
        20 001251   001266 710000 20                 TRA     s:9544
        20 001252   001266 710000 20                 TRA     s:9544
        20 001253   001255 710000 20                 TRA     s:9529
        20 001254   001255 710000 20                 TRA     s:9529

      500     9526
      501     9527    3             CASE (%IN, %CREATE);

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:94   
      502     9528
      503     9529    3               IO_STATUS = %NOT_OPEN_IO;

   9529 20 001255   000036 475500                    LDP5    30,,PR0
        20 001256   040100 100400                    MLR     fill='040'O
        20 001257   000034 000002 18                 ADSC9   PRE_SLEW+11              cn=0,n=2
        20 001260   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2

      504     9530    3               CALL X9WE$IO_ERROR_STATUS (FAB);

   9530 20 001261   200003 630500                    EPPR0   @FAB,,AUTO
        20 001262   000000 631400 21                 EPPR1   0
        20 001263   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 001264   000000 011000                    NOP     0

      505     9531    3               RETURN;

   9531 20 001265   000000 702200 xent               TSX2  ! X66_ARET

      506     9532
      507     9533    3             CASE (%UPDATE);

      508     9534
      509     9535                    /* Continue */
      510     9536    3            END; /* case m$xx.fun# */

      511     9537    2        END; /* case fab.file_status */

      512     9538        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:95   
      513     9539        /*---------\
      514     9540        |  Rewrite |
      515     9541        \---------*/
      516     9542
      517     9543
      518     9544    1       CALL BOUNDARY_CHECK

   9544 20 001266   003636 701000 20                 TSX1    BOUNDARY_CHECK
        20 001267   001271 702000 20                 TSX2    s:9547
        20 001270   001272 710000 20                 TRA     s:9550

      519     9545    1         WHENALTRETURN
      520     9546    2           DO;

      521     9547    2             RETURN;         /* Write is unsuccessful */

   9547 20 001271   000000 702200 xent               TSX2  ! X66_ARET

      522     9548    2           END;
      523     9549
      524     9550    1       REWRITE_REC.V.NEWKEY#  = NO#;

   9550 20 001272   000045 236000 21                 LDQ     37
        20 001273   000040 356000 19                 ANSQ    REWRITE_REC+8

      525     9551    1       REWRITE_REC.V.ONEWKEY# = NO#;

   9551 20 001274   000010 236000 21                 LDQ     8
        20 001275   000040 356000 19                 ANSQ    REWRITE_REC+8

      526     9552    1       REWRITE_REC.V.REWRITE# = YES#;

   9552 20 001276   000100 236007                    LDQ     64,DL
        20 001277   000040 256000 19                 ORSQ    REWRITE_REC+8

      527     9553    1       REWRITE_REC.V.DCB# = FAB.DCB_NUM;

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:96   
   9553 20 001300   200003 470500                    LDP0    @FAB,,AUTO
        20 001301   000034 220100                    LDX0    28,,PR0
        20 001302   000040 740000 19                 STX0    REWRITE_REC+8

      528     9554    1       REWRITE_REC.BUF_   = VECTOR (RDB);

   9554 20 001303   000052 471500                    LDP1    42,,PR0
        20 001304   200005 473500                    LDP3    @REC_LEN,,AUTO
        20 001305   300000 721100                    LXL1    0,,PR3
        20 001306   000000 635011                    EAA     0,X1
        20 001307   000002 731000                    ARS     2
        20 001310   000140 135007                    SBLA    96,DL
        20 001311   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 001312   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 001313   000034 757000 19                 STAQ    REWRITE_REC+4

      529     9555
      530     9556    2         DO CASE (FAB.ACS#);

   9556 20 001314   000004 235100                    LDA     4,,PR0
        20 001315   000004 115007                    CMPA    4,DL
        20 001316   001320 602005 20                 TNC     s:9556+4,AL
        20 001317   001734 710000 20                 TRA     s:9709
        20 001320   001734 710000 20                 TRA     s:9709
        20 001321   001324 710000 20                 TRA     s:9575
        20 001322   001475 710000 20                 TRA     s:9644
        20 001323   001475 710000 20                 TRA     s:9644

      531     9557        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:97   
      532     9558        /*---------\
      533     9559        |  Rewrite |
      534     9560        \---------*/
      535     9561
      536     9562        /*V*               Rewrite_Lost_Position
      537     9563
      538     9564             M$WRITE perform a REWRITE operation using the primary key
      539     9565             causing the sequential position within an INDEXED file as well
      540     9566             as the INDX number currently in use to be destroyed.  This info
      541     9567             must be saved proir to calling M$WRITE via X9WS$REPOS and
      542     9568             repositioned to after the call to M$WRITE.  COBOL85 has the
      543     9569             additional requirement of finding records rewritten to be the
      544     9570             next sequential record (all keyed file types).  This problem is
      545     9571             also covered by the calls to X9WS$REPOS.
      546     9572        */
      547     9573
      548     9574    2           CASE (%FAB_SEQUENTIAL_ACCESS);

      549     9575    2             IF FAB.LAST_IO = %READ_NEXT

   9575 20 001324   000025 235100                    LDA     21,,PR0
        20 001325   000007 115007                    CMPA    7,DL
        20 001326   001464 601000 20                 TNZ     s:9624
        20 001327   000036 471500                    LDP1    30,,PR0
        20 001330   040000 106500                    CMPC    fill='040'O
        20 001331   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        20 001332   000034 000001 21                 ADSC9   28                       cn=0,n=1
        20 001333   001464 601000 20                 TNZ     s:9624

      550     9576    2             AND SUBSTR(IO_STATUS,0,1) = '0' THEN
      551     9577    3               DO;

      552     9578    3                 IF REC_LEN ~= FAB.LENGTH_READ THEN

   9578 20 001334   300000 236100                    LDQ     0,,PR3
        20 001335   001340 604000 20                 TMI     s:9580
        20 001336   000033 116100                    CMPQ    27,,PR0
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:98   
        20 001337   001350 600000 20                 TZE     s:9585

      553     9579    4                   DO;

      554     9580    4                     IO_STATUS = %BOUNDARY_VIOLATION;

   9580 20 001340   040100 100400                    MLR     fill='040'O
        20 001341   000035 000002 18                 ADSC9   PRE_SLEW+12              cn=0,n=2
        20 001342   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      555     9581    4                     CALL X9WE$IO_ERROR_STATUS (FAB);

   9581 20 001343   200003 630500                    EPPR0   @FAB,,AUTO
        20 001344   000000 631400 21                 EPPR1   0
        20 001345   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 001346   000000 011000                    NOP     0

      556     9582    4                     RETURN;  /* REWRITE is unsuccessful */

   9582 20 001347   000000 702200 xent               TSX2  ! X66_ARET

      557     9583    4                   END;
      558     9584
      559     9585    3                 IF  FAB.ORG# = %CP6_INDEXED                   /*#29554*/

   9585 20 001350   000002 235100                    LDA     2,,PR0
        20 001351   000006 115007                    CMPA    6,DL
        20 001352   001367 601000 20                 TNZ     s:9589
        20 001353   000032 236100                    LDQ     26,,PR0
        20 001354   100000 316007                    CANQ    32768,DL
        20 001355   001367 601000 20                 TNZ     s:9589

      560     9586    3                 AND NOT FAB.B.SHARED_INDEX_ALT THEN           /*#33525*/
      561     9587    3                     CALL X9WS$REPOS (FAB, NO#, -1);

   9587 20 001356   000020 236000 21                 LDQ     16
        20 001357   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:99   
        20 001360   000016 236000 21                 LDQ     14
        20 001361   200003 235100                    LDA     @FAB,,AUTO
        20 001362   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 001363   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 001364   000001 631400 21                 EPPR1   1
        20 001365   000000 701000 xent               TSX1    X9WS$REPOS
        20 001366   000000 011000                    NOP     0

      562     9588
      563     9589    3                 IF FAB.B.SHARED_INDEX_ALT THEN                /*#32658*/

   9589 20 001367   200003 470500                    LDP0    @FAB,,AUTO
        20 001370   000032 236100                    LDQ     26,,PR0
        20 001371   100000 316007                    CANQ    32768,DL
        20 001372   001420 600000 20                 TZE     s:9598

      564     9590    4                   DO;  /* Adjust file position for X9WR$READ_NEXT */

      565     9591    4                     ALT_LENGTH = ALT_KEYS.K.KEYL# (SHARED.INDX);

   9591 20 001373   000037 471500                    LDP1    31,,PR0
        20 001374   000055 473500                    LDP3    45,,PR0
        20 001375   100003 720100                    LXL0    3,,PR1
        20 001376   300001 236110                    LDQ     1,X0,PR3
        20 001377   000022 772000                    QRL     18
        20 001400   000777 376007                    ANQ     511,DL
        20 001401   200210 756100                    STQ     ALT_LENGTH,,AUTO

      566     9592    4                     ALT_OFFSET = ALT_KEYS.K.KEYX# (SHARED.INDX);

   9592 20 001402   300001 236110                    LDQ     1,X0,PR3
        20 001403   777777 376007                    ANQ     -1,DL
        20 001404   200207 756100                    STQ     ALT_OFFSET,,AUTO

      567     9593    4                     IF SUBSTR (SHARED.KEY, 0, ALT_LENGTH) ~=    /*#35929*/

   9593 20 001405   000052 474500                    LDP4    42,,PR0
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:100  
        20 001406   200005 475500                    LDP5    @REC_LEN,,AUTO
        20 001407   500000 721100                    LXL1    0,,PR5
        20 001410   200210 722100                    LXL2    ALT_LENGTH,,AUTO
        20 001411   040146 106540                    CMPC    fill='040'O
        20 001412   100004 000012                    ADSC9   4,,PR1                   cn=0,n=*X2
        20 001413   400000 000012                    ADSC9   0,Q,PR4                  cn=0,n=*X2
        20 001414   001420 600000 20                 TZE     s:9598

      568     9594    4                        SUBSTR (RDB.RECORD, ALT_OFFSET, ALT_LENGTH) THEN
      569     9595    4                       SHARED.RECNUM = SHARED.RECNUM - 1;

   9595 20 001415   100002 235100                    LDA     2,,PR1
        20 001416   000001 135007                    SBLA    1,DL
        20 001417   100002 755100                    STA     2,,PR1

      570     9596    4                   END;

      571     9597        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:101  
      572     9598    3                 FAB.LAST_IO = %REWRITE;

   9598 20 001420   000002 235007                    LDA     2,DL
        20 001421   000025 755100                    STA     21,,PR0

      573     9599    3                 REWRITE_REC.KEY_ = VECTOR (NIL);

   9599 20 001422   000046 237000 21                 LDAQ    38
        20 001423   000032 757000 19                 STAQ    REWRITE_REC+2

      574     9600    3                 IO_STATUS = %SUCCESSFUL;

   9600 20 001424   000036 471500                    LDP1    30,,PR0
        20 001425   040100 100400                    MLR     fill='040'O
        20 001426   000027 000002 18                 ADSC9   PRE_SLEW+6               cn=0,n=2
        20 001427   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      575     9601    3                 CALL M$WRITE (REWRITE_REC)

   9601 20 001430   000030 630400 19                 EPPR0   REWRITE_REC
        20 001431   440001 713400                    CLIMB   alt,write
        20 001432   401400 401760                    pmme    nvectors=4
        20 001433   001455 702000 20                 TSX2    s:9615

      576     9602    3                   WHENRETURN
      577     9603    4                     DO;

      578     9604    4                       IF  FAB.ORG# = %CP6_INDEXED             /*#29554*/

   9604 20 001434   200003 470500                    LDP0    @FAB,,AUTO
        20 001435   000002 235100                    LDA     2,,PR0
        20 001436   000006 115007                    CMPA    6,DL
        20 001437   001454 601000 20                 TNZ     s:9607
        20 001440   000032 236100                    LDQ     26,,PR0
        20 001441   100000 316007                    CANQ    32768,DL
        20 001442   001454 601000 20                 TNZ     s:9607

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:102  
      579     9605    4                       AND NOT FAB.B.SHARED_INDEX_ALT THEN     /*#33525*/
      580     9606    4                         CALL X9WS$REPOS (FAB, YES#, 1);

   9606 20 001443   000024 236000 21                 LDQ     20
        20 001444   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 001445   000022 236000 21                 LDQ     18
        20 001446   200003 235100                    LDA     @FAB,,AUTO
        20 001447   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 001450   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 001451   000001 631400 21                 EPPR1   1
        20 001452   000000 701000 xent               TSX1    X9WS$REPOS
        20 001453   000000 011000                    NOP     0

      581     9607    4                     END;

   9607 20 001454   001463 710000 20                 TRA     s:9621

      582     9608        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:103  
      583     9609        /*---------\
      584     9610        |  Rewrite |
      585     9611        \---------*/
      586     9612
      587     9613    3                   WHENALTRETURN
      588     9614    4                     DO;

      589     9615    4                       CALL X9WE$IO_ERROR (FAB, ALT_RET)

   9615 20 001455   200003 630500                    EPPR0   @FAB,,AUTO
        20 001456   000025 631400 21                 EPPR1   21
        20 001457   000000 701000 xent               TSX1    X9WE$IO_ERROR
        20 001460   001462 702000 20                 TSX2    s:9618
        20 001461   001463 710000 20                 TRA     s:9621

      590     9616    4                         WHENALTRETURN
      591     9617    5                           DO;

      592     9618    5                             ALTRETURN;

   9618 20 001462   000000 702200 xent               TSX2  ! X66_AALT

      593     9619    5                           END;
      594     9620    4                     END;

      595     9621    3               END;  /* if successful read then do */

   9621 20 001463   001734 710000 20                 TRA     s:9709

      596     9622    2             ELSE
      597     9623    3               DO;

      598     9624    3                 IO_STATUS = %PRIOR_NOT_READ;

   9624 20 001464   000036 471500                    LDP1    30,,PR0
        20 001465   040100 100400                    MLR     fill='040'O
        20 001466   000036 000002 18                 ADSC9   PRE_SLEW+13              cn=0,n=2
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:104  
        20 001467   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      599     9625    3                 CALL X9WE$IO_ERROR_STATUS (FAB);

   9625 20 001470   200003 630500                    EPPR0   @FAB,,AUTO
        20 001471   000000 631400 21                 EPPR1   0
        20 001472   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 001473   000000 011000                    NOP     0

      600     9626    3               END;

   9626 20 001474   001734 710000 20                 TRA     s:9709

      601     9627        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:105  
      602     9628        /*---------\
      603     9629        |  Rewrite |
      604     9630        \---------*/
      605     9631
      606     9632        /*V*               Rewrite_Lost_Position
      607     9633
      608     9634             Using M$WRITE to perform a REWRITE operation on KEYED, INDEXED,
      609     9635             and RELATIVE files with DYNAMIC access will cause the CP-6 file
      610     9636             I-O system to lose the sequential position within the file.  In
      611     9637             order to recover from this problem, the file's sequential
      612     9638             position is saved by calling X9WS$REPOS before the REWRITE
      613     9639             operation and restored by calling X9WS$REPOS after the REWRITE.
      614     9640        */
      615     9641
      616     9642    2              CASE (%FAB_DYNAMIC_ACCESS, %FAB_RANDOM_ACCESS);

      617     9643
      618     9644    2                IF FAB.B.SHARED_INDEX_ALT THEN                 /*#32658*/

   9644 20 001475   000032 236100                    LDQ     26,,PR0
        20 001476   100000 316007                    CANQ    32768,DL
        20 001477   001525 600000 20                 TZE     s:9654

      619     9645    3                  DO;   /* Adjust file position for X9WR$READ_NEXT */

      620     9646    3                    ALT_LENGTH = ALT_KEYS.K.KEYL# (SHARED.INDX);

   9646 20 001500   000037 471500                    LDP1    31,,PR0
        20 001501   000055 474500                    LDP4    45,,PR0
        20 001502   100003 721100                    LXL1    3,,PR1
        20 001503   400001 236111                    LDQ     1,X1,PR4
        20 001504   000022 772000                    QRL     18
        20 001505   000777 376007                    ANQ     511,DL
        20 001506   200210 756100                    STQ     ALT_LENGTH,,AUTO

      621     9647    3                    ALT_OFFSET = ALT_KEYS.K.KEYX# (SHARED.INDX);

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:106  
   9647 20 001507   400001 236111                    LDQ     1,X1,PR4
        20 001510   777777 376007                    ANQ     -1,DL
        20 001511   200207 756100                    STQ     ALT_OFFSET,,AUTO

      622     9648    3                    IF SUBSTR (SHARED.KEY, 0, ALT_LENGTH) ~=     /*#35929*/

   9648 20 001512   000052 475500                    LDP5    42,,PR0
        20 001513   300000 722100                    LXL2    0,,PR3
        20 001514   200210 723100                    LXL3    ALT_LENGTH,,AUTO
        20 001515   040146 106540                    CMPC    fill='040'O
        20 001516   100004 000013                    ADSC9   4,,PR1                   cn=0,n=*X3
        20 001517   500000 000013                    ADSC9   0,Q,PR5                  cn=0,n=*X3
        20 001520   001560 600000 20                 TZE     s:9661

      623     9649    3                       SUBSTR (RDB.RECORD, ALT_OFFSET, ALT_LENGTH) THEN
      624     9650    3                      SHARED.RECNUM = SHARED.RECNUM - 1;

   9650 20 001521   100002 235100                    LDA     2,,PR1
        20 001522   000001 135007                    SBLA    1,DL
        20 001523   100002 755100                    STA     2,,PR1

      625     9651    3                  END;

   9651 20 001524   001560 710000 20                 TRA     s:9661

      626     9652    2                ELSE
      627     9653                       %SAVE_POSITION;  /* save the current file position */

   9654 20 001525   000002 115007                    CMPA    2,DL
        20 001526   001560 601000 20                 TNZ     s:9661
        20 001527   200101 471500                    LDP1    DCB$,,AUTO
        20 001530   100032 236100                    LDQ     26,,PR1
        20 001531   000777 376003                    ANQ     511,DU
        20 001532   000001 116003                    CMPQ    1,DU
        20 001533   001560 601000 20                 TNZ     s:9661

   9656 20 001534   000000 234000 1                  SZN     LIBCOM
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:107  
        20 001535   001547 605000 20                 TPL     s:9659

   9657 20 001536   000016 236000 21                 LDQ     14
        20 001537   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 001540   200003 235100                    LDA     @FAB,,AUTO
        20 001541   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 001542   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 001543   000001 631400 21                 EPPR1   1
        20 001544   000000 701000 xent               TSX1    X9WS$REPOS
        20 001545   000000 011000                    NOP     0
        20 001546   001560 710000 20                 TRA     s:9661

   9659 20 001547   000020 236000 21                 LDQ     16
        20 001550   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 001551   000016 236000 21                 LDQ     14
        20 001552   200003 235100                    LDA     @FAB,,AUTO
        20 001553   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 001554   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 001555   000001 631400 21                 EPPR1   1
        20 001556   000000 701000 xent               TSX1    X9WS$REPOS
        20 001557   000000 011000                    NOP     0

      628     9661    2                FAB.LAST_IO = %REWRITE;

   9661 20 001560   000002 235007                    LDA     2,DL
        20 001561   200003 470500                    LDP0    @FAB,,AUTO
        20 001562   000025 755100                    STA     21,,PR0

      629     9662        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:108  
      630     9663
      631     9664    3                DO CASE (FAB.ORG#);

   9664 20 001563   000002 235100                    LDA     2,,PR0
        20 001564   000007 115007                    CMPA    7,DL
        20 001565   001567 602005 20                 TNC     s:9664+4,AL
        20 001566   001651 710000 20                 TRA     s:9685
        20 001567   001651 710000 20                 TRA     s:9685
        20 001570   001651 710000 20                 TRA     s:9685
        20 001571   001632 710000 20                 TRA     s:9675
        20 001572   001651 710000 20                 TRA     s:9685
        20 001573   001651 710000 20                 TRA     s:9685
        20 001574   001576 710000 20                 TRA     s:9667
        20 001575   001620 710000 20                 TRA     s:9672

      632     9665
      633     9666    3                  CASE (%CP6_RELATIVE);

      634     9667    3                    CALL X8CV$CONVERT_TO_INTEGER (FAB.RELATIVE_KEY$,

   9667 20 001576   200104 631500                    EPPR1   RELATIVE_KEY,,AUTO
        20 001577   200230 451500                    STP1    FIRST_PAGE+9,,AUTO
        20 001600   200003 236100                    LDQ     @FAB,,AUTO
        20 001601   000030 036003                    ADLQ    24,DU
        20 001602   200227 756100                    STQ     FIRST_PAGE+8,,AUTO
        20 001603   200003 236100                    LDQ     @FAB,,AUTO
        20 001604   000053 036003                    ADLQ    43,DU
        20 001605   200226 756100                    STQ     FIRST_PAGE+7,,AUTO
        20 001606   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 001607   000001 631400 21                 EPPR1   1
        20 001610   000000 701000 xent               TSX1    X8CV$CONVERT_TO_INTEGER
        20 001611   000000 011000                    NOP     0

      635     9668    3                         FAB.RELATIVE_DESC, RELATIVE_KEY);
      636     9669    3                    REWRITE_REC.KEY_ = VECTOR (RELATIVE_KEY);

   9669 20 001612   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:109  
        20 001613   200226 452500                    STP2    FIRST_PAGE+7,,AUTO
        20 001614   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 001615   000104 036003                    ADLQ    68,DU
        20 001616   000032 757000 19                 STAQ    REWRITE_REC+2
        20 001617   001651 710000 20                 TRA     s:9685

      637     9670
      638     9671    3                  CASE (%CP6_INDEXED);

      639     9672    3                     REWRITE_REC.KEY_ = VECTOR (FAB.RECORD_KEY$-> INDEX_KEY);

   9672 20 001620   000054 471500                    LDP1    44,,PR0
        20 001621   000031 720100                    LXL0    25,,PR0
        20 001622   000000 636010                    EAQ     0,X0
        20 001623   000022 732000                    QRS     18
        20 001624   000064 737000                    LLS     52
        20 001625   000140 135007                    SBLA    96,DL
        20 001626   200226 451500                    STP1    FIRST_PAGE+7,,AUTO
        20 001627   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 001630   000032 757000 19                 STAQ    REWRITE_REC+2
        20 001631   001651 710000 20                 TRA     s:9685

      640     9673
      641     9674    3                   CASE (%CP6_KEYED);

      642     9675    3                     KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;

   9675 20 001632   000031 236100                    LDQ     25,,PR0
        20 001633   000033 736000                    QLS     27
        20 001634   200106 552140                    STBQ    KEYED_KEY,'40'O,AUTO

      643     9676    3                     KEYED_KEY.TEXT   = KEY_TEXT;

   9676 20 001635   000054 471500                    LDP1    44,,PR0
        20 001636   200106 236100                    LDQ     KEYED_KEY,,AUTO
        20 001637   000033 772000                    QRL     27
        20 001640   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:110  
        20 001641   040100 100540                    MLR     fill='040'O
        20 001642   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        20 001643   200106 200377                    ADSC9   KEYED_KEY,,AUTO          cn=1,n=255

      644     9677    3                     REWRITE_REC.KEY_ = VECTOR (KEYED_KEY);

   9677 20 001644   000014 235000 21                 LDA     12
        20 001645   200226 452500                    STP2    FIRST_PAGE+7,,AUTO
        20 001646   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 001647   000106 036003                    ADLQ    70,DU
        20 001650   000032 757000 19                 STAQ    REWRITE_REC+2

      645     9678
      646     9679    3                 END; /* case m$xx.org# */

      647     9680        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:111  
      648     9681        /*---------\
      649     9682        |  Rewrite |
      650     9683        \---------*/
      651     9684
      652     9685    2                IO_STATUS = %SUCCESSFUL;  /* preset status to successful */

   9685 20 001651   200003 470500                    LDP0    @FAB,,AUTO
        20 001652   000036 471500                    LDP1    30,,PR0
        20 001653   040100 100400                    MLR     fill='040'O
        20 001654   000027 000002 18                 ADSC9   PRE_SLEW+6               cn=0,n=2
        20 001655   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      653     9686    2                CALL M$WRITE (REWRITE_REC)

   9686 20 001656   000030 630400 19                 EPPR0   REWRITE_REC
        20 001657   440001 713400                    CLIMB   alt,write
        20 001660   401400 401760                    pmme    nvectors=4
        20 001661   001726 702000 20                 TSX2    s:9701

      654     9687    2                WHENRETURN
      655     9688    3                  DO;

      656     9689    3                    IF ~ FAB.B.SHARED_INDEX_ALT THEN

   9689 20 001662   200003 470500                    LDP0    @FAB,,AUTO
        20 001663   000032 236100                    LDQ     26,,PR0
        20 001664   000024 736000                    QLS     20
        20 001665   400000 376003                    ANQ     -131072,DU
        20 001666   400000 676003                    ERQ     -131072,DU
        20 001667   001725 600000 20                 TZE     s:9698

      657     9690                           %REPOSITION;

   9691 20 001670   000004 235100                    LDA     4,,PR0
        20 001671   000002 115007                    CMPA    2,DL
        20 001672   001725 601000 20                 TNZ     s:9698
        20 001673   200101 471500                    LDP1    DCB$,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:112  
        20 001674   100032 236100                    LDQ     26,,PR1
        20 001675   000777 376003                    ANQ     511,DU
        20 001676   000001 116003                    CMPQ    1,DU
        20 001677   001725 601000 20                 TNZ     s:9698

   9693 20 001700   000000 234000 1                  SZN     LIBCOM
        20 001701   001714 605000 20                 TPL     s:9696

   9694 20 001702   000016 236000 21                 LDQ     14
        20 001703   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 001704   000022 236000 21                 LDQ     18
        20 001705   200003 235100                    LDA     @FAB,,AUTO
        20 001706   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 001707   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 001710   000001 631400 21                 EPPR1   1
        20 001711   000000 701000 xent               TSX1    X9WS$REPOS
        20 001712   000000 011000                    NOP     0
        20 001713   001725 710000 20                 TRA     s:9698

   9696 20 001714   000024 236000 21                 LDQ     20
        20 001715   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 001716   000022 236000 21                 LDQ     18
        20 001717   200003 235100                    LDA     @FAB,,AUTO
        20 001720   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 001721   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 001722   000001 631400 21                 EPPR1   1
        20 001723   000000 701000 xent               TSX1    X9WS$REPOS
        20 001724   000000 011000                    NOP     0

      658     9698    3                  END;

   9698 20 001725   001734 710000 20                 TRA     s:9709

      659     9699    2                WHENALTRETURN
      660     9700    3                  DO;

      661     9701    3                    CALL X9WE$IO_ERROR (FAB, ALT_RET)
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:113  

   9701 20 001726   200003 630500                    EPPR0   @FAB,,AUTO
        20 001727   000025 631400 21                 EPPR1   21
        20 001730   000000 701000 xent               TSX1    X9WE$IO_ERROR
        20 001731   001733 702000 20                 TSX2    s:9704
        20 001732   001734 710000 20                 TRA     s:9709

      662     9702    3                      WHENALTRETURN
      663     9703    4                        DO;

      664     9704    4                          ALTRETURN;

   9704 20 001733   000000 702200 xent               TSX2  ! X66_AALT

      665     9705    4                        END;
      666     9706    3                  END;

      667     9707    2           END;  /* case */

      668     9708
      669     9709    1       RETURN;

   9709 20 001734   000000 702200 xent               TSX2  ! X66_ARET

      670     9710        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:114  
      671     9711        /*----------------*/
      672     9712    1       ADD_VFC_LINAGE: PROC ALTRET;

   9712 20 001735   200220 741300       ADD_VFC_LIN* STX1  ! FIRST_PAGE+1,,AUTO

      673     9713        /*----------------*/
      674     9714
      675     9715        /*V*                   Linage_Top_Clause_Check
      676     9716              First a check for the first logical page is made and TOP is
      677     9717              advanced if it was specified.
      678     9718        */
      679     9719
      680     9720    2       IF  FIRST_PAGE

   9720 20 001736   200217 234100                    SZN     FIRST_PAGE,,AUTO
        20 001737   002000 605000 20                 TPL     s:9736
        20 001740   200003 470500                    LDP0    @FAB,,AUTO
        20 001741   000047 236100                    LDQ     39,,PR0
        20 001742   000032 116000 21                 CMPQ    26
        20 001743   002000 600000 20                 TZE     s:9736

      681     9721    2       AND FAB.TOP$ ~= ADDR(NIL) THEN
      682     9722    3         DO;

      683     9723    3           TEMP = FAB.TOP;

   9723 20 001744   000023 235100                    LDA     19,,PR0
        20 001745   200214 755100                    STA     TEMP,,AUTO

      684     9724    3           SAVE_VECTOR = WRITE_SEQ.BUF_ ;

   9724 20 001746   000020 237000 19                 LDAQ    WRITE_SEQ+4
        20 001747   200212 757100                    STAQ    SAVE_VECTOR,,AUTO

      685     9725    3           WRITE_SEQ.BUF_ = VECTOR (PRE_SLEW);

   9725 20 001750   000050 237000 21                 LDAQ    40
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:115  
        20 001751   000020 757000 19                 STAQ    WRITE_SEQ+4

      686     9726    4           DO WHILE TEMP > 15;

   9726 20 001752   200214 235100                    LDA     TEMP,,AUTO
        20 001753   000017 115007                    CMPA    15,DL
        20 001754   001764 604400 20                 TMOZ    s:9730

      687     9727    4             TEMP = TEMP - 15;

   9727 20 001755   000017 336007                    LCQ     15,DL
        20 001756   200214 056100                    ASQ     TEMP,,AUTO

      688     9728    4             CALL WRITE;

   9728 20 001757   003175 701000 20                 TSX1    WRITE
        20 001760   000000 011000                    NOP     0

      689     9729    4           END;

   9729 20 001761   200214 235100                    LDA     TEMP,,AUTO
        20 001762   000017 115007                    CMPA    15,DL
        20 001763   001755 605400 20                 TPNZ    s:9727

      690     9730    3           TOP_SLEW = AFTER_ADV (TEMP);

   9730 20 001764   040100 100405                    MLR     fill='040'O
        20 001765   000000 000001 18                 ADSC9   AFTER_ADV,A              cn=0,n=1
        20 001766   200211 000001                    ADSC9   TOP_SLEW,,AUTO           cn=0,n=1

      691     9731    3           WRITE_SEQ.BUF_ = VECTOR (TOP_SLEW);

   9731 20 001767   177640 235007                    LDA     65440,DL
        20 001770   200226 452500                    STP2    FIRST_PAGE+7,,AUTO
        20 001771   200226 236100                    LDQ     FIRST_PAGE+7,,AUTO
        20 001772   000211 036003                    ADLQ    137,DU
        20 001773   000020 757000 19                 STAQ    WRITE_SEQ+4
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:116  

      692     9732    3           CALL WRITE;

   9732 20 001774   003175 701000 20                 TSX1    WRITE
        20 001775   000000 011000                    NOP     0

      693     9733    3           WRITE_SEQ.BUF_ = SAVE_VECTOR;

   9733 20 001776   200212 237100                    LDAQ    SAVE_VECTOR,,AUTO
        20 001777   000020 757000 19                 STAQ    WRITE_SEQ+4

      694     9734    3         END;

      695     9735
      696     9736    3       DO CASE (ADV_CODE);

   9736 20 002000   200006 470500                    LDP0    @ADV_CODE,,AUTO
        20 002001   000000 235100                    LDA     0,,PR0
        20 002002   000006 115007                    CMPA    6,DL
        20 002003   002005 602005 20                 TNC     s:9736+5,AL
        20 002004   002417 710000 20                 TRA     s:9907
        20 002005   002122 710000 20                 TRA     s:9788
        20 002006   002417 710000 20                 TRA     s:9907
        20 002007   002013 710000 20                 TRA     s:9739
        20 002010   002056 710000 20                 TRA     s:9761
        20 002011   002316 710000 20                 TRA     s:9868
        20 002012   002215 710000 20                 TRA     s:9828

      697     9737
      698     9738    3         CASE (%BEFORE_PAGE);

      699     9739    3           SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER;

   9739 20 002013   200003 471500                    LDP1    @FAB,,AUTO
        20 002014   100051 473500                    LDP3    41,,PR1
        20 002015   100021 236100                    LDQ     17,,PR1
        20 002016   300000 136100                    SBLQ    0,,PR3
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:117  
        20 002017   200206 756100                    STQ     SLEW_CHAR,,AUTO

      700     9740                %NEW_PAGE (@BEFORE = YES);

   9742 20 002020   100050 236100                    LDQ     40,,PR1
        20 002021   000032 116000 21                 CMPQ    26
        20 002022   002026 600000 20                 TZE     s:9744

   9743 20 002023   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002024   100024 036100                    ADLQ    20,,PR1
        20 002025   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9744 20 002026   200003 630500                    EPPR0   @FAB,,AUTO
        20 002027   000000 631400 21                 EPPR1   0
        20 002030   000000 701000 xent               TSX1    X9WO$CONVERT_LINAGE
        20 002031   000000 011000                    NOP     0

   9745 20 002032   200003 470500                    LDP0    @FAB,,AUTO
        20 002033   000047 236100                    LDQ     39,,PR0
        20 002034   000032 116000 21                 CMPQ    26
        20 002035   002041 600000 20                 TZE     s:9748

   9746 20 002036   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002037   000023 036100                    ADLQ    19,,PR0
        20 002040   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9748 20 002041   002457 701000 20                 TSX1    BEFORE_LINES
        20 002042   000000 011000                    NOP     0

   9752 20 002043   200003 470500                    LDP0    @FAB,,AUTO
        20 002044   000051 471500                    LDP1    41,,PR0
        20 002045   000001 235007                    LDA     1,DL
        20 002046   100000 755100                    STA     0,,PR1

   9753 20 002047   200004 471500                    LDP1    @ALT_RET,,AUTO
        20 002050   100000 234100                    SZN     0,,PR1
        20 002051   002054 605000 20                 TPL     s:9756
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:118  

   9754 20 002052   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002053   000000 702211                    TSX2  ! 0,X1

   9756 20 002054   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002055   000001 702211                    TSX2  ! 1,X1

      701     9759
      702     9760    3         CASE (%AFTER_PAGE);

      703     9761    3           SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER + 1;

   9761 20 002056   200003 471500                    LDP1    @FAB,,AUTO
        20 002057   100051 473500                    LDP3    41,,PR1
        20 002060   100021 236100                    LDQ     17,,PR1
        20 002061   300000 136100                    SBLQ    0,,PR3
        20 002062   000001 036007                    ADLQ    1,DL
        20 002063   200206 756100                    STQ     SLEW_CHAR,,AUTO

      704     9762                %NEW_PAGE;

   9764 20 002064   100050 236100                    LDQ     40,,PR1
        20 002065   000032 116000 21                 CMPQ    26
        20 002066   002072 600000 20                 TZE     s:9766

   9765 20 002067   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002070   100024 036100                    ADLQ    20,,PR1
        20 002071   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9766 20 002072   200003 630500                    EPPR0   @FAB,,AUTO
        20 002073   000000 631400 21                 EPPR1   0
        20 002074   000000 701000 xent               TSX1    X9WO$CONVERT_LINAGE
        20 002075   000000 011000                    NOP     0

   9767 20 002076   200003 470500                    LDP0    @FAB,,AUTO
        20 002077   000047 236100                    LDQ     39,,PR0
        20 002100   000032 116000 21                 CMPQ    26
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:119  
        20 002101   002105 600000 20                 TZE     s:9772

   9768 20 002102   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002103   000023 036100                    ADLQ    19,,PR0
        20 002104   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9772 20 002105   002425 701000 20                 TSX1    AFTER_LINES
        20 002106   000000 011000                    NOP     0

   9774 20 002107   200003 470500                    LDP0    @FAB,,AUTO
        20 002110   000051 471500                    LDP1    41,,PR0
        20 002111   000001 235007                    LDA     1,DL
        20 002112   100000 755100                    STA     0,,PR1

   9775 20 002113   200004 471500                    LDP1    @ALT_RET,,AUTO
        20 002114   100000 234100                    SZN     0,,PR1
        20 002115   002120 605000 20                 TPL     s:9778

   9776 20 002116   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002117   000000 702211                    TSX2  ! 0,X1

   9778 20 002120   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002121   000001 702211                    TSX2  ! 1,X1

      705     9781        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:120  
      706     9782        /*---------------\
      707     9783        |  Linage Clause |
      708     9784        \---------------*/
      709     9785
      710     9786    3         CASE (%AFTER_ONE_LINE);

      711     9787
      712     9788    3           IF LINAGE_COUNTER + 1 <= FAB.LINAGE THEN

   9788 20 002122   200003 471500                    LDP1    @FAB,,AUTO
        20 002123   100051 473500                    LDP3    41,,PR1
        20 002124   300000 236100                    LDQ     0,,PR3
        20 002125   002130 604000 20                 TMI     s:9790
        20 002126   100021 116100                    CMPQ    17,,PR1
        20 002127   002155 603000 20                 TRC     s:9800

      713     9789    4            DO;

      714     9790    4              VFC = AFTER_ADV(1);

   9790 20 002130   200216 474500                    LDP4    VFC$,,AUTO
        20 002131   040100 100400                    MLR     fill='040'O
        20 002132   000000 200001 18                 ADSC9   AFTER_ADV                cn=1,n=1
        20 002133   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1

      715     9791    4              CALL WRITE;

   9791 20 002134   003175 701000 20                 TSX1    WRITE
        20 002135   000000 011000                    NOP     0

      716     9792    4              LINAGE_COUNTER = LINAGE_COUNTER + 1;

   9792 20 002136   200003 470500                    LDP0    @FAB,,AUTO
        20 002137   000051 471500                    LDP1    41,,PR0
        20 002140   100000 054100                    AOS     0,,PR1

      717     9793    4              IF FAB.FOOTING$ ~= ADDR(NIL) THEN
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:121  

   9793 20 002141   000046 236100                    LDQ     38,,PR0
        20 002142   000032 116000 21                 CMPQ    26
        20 002143   002153 600000 20                 TZE     s:9796

      718     9794    4                IF LINAGE_COUNTER >= FAB.FOOTING THEN

   9794 20 002144   000051 471500                    LDP1    41,,PR0
        20 002145   100000 236100                    LDQ     0,,PR1
        20 002146   002153 604000 20                 TMI     s:9796
        20 002147   000022 116100                    CMPQ    18,,PR0
        20 002150   002153 602000 20                 TNC     s:9796

      719     9795    4                  ALTRETURN;   /* a page overflow has occured */

   9795 20 002151   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002152   000000 702211                    TSX2  ! 0,X1

      720     9796    4              RETURN;

   9796 20 002153   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002154   000001 702211                    TSX2  ! 1,X1

      721     9797    4            END;
      722     9798    3           ELSE
      723     9799    4             DO;

      724     9800    4               SLEW_CHAR.VFC# = 1;

   9800 20 002155   000001 235007                    LDA     1,DL
        20 002156   200206 755100                    STA     SLEW_CHAR,,AUTO

      725     9801                    %NEW_PAGE;

   9803 20 002157   100050 236100                    LDQ     40,,PR1
        20 002160   000032 116000 21                 CMPQ    26
        20 002161   002165 600000 20                 TZE     s:9805
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:122  

   9804 20 002162   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002163   100024 036100                    ADLQ    20,,PR1
        20 002164   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9805 20 002165   200003 630500                    EPPR0   @FAB,,AUTO
        20 002166   000000 631400 21                 EPPR1   0
        20 002167   000000 701000 xent               TSX1    X9WO$CONVERT_LINAGE
        20 002170   000000 011000                    NOP     0

   9806 20 002171   200003 470500                    LDP0    @FAB,,AUTO
        20 002172   000047 236100                    LDQ     39,,PR0
        20 002173   000032 116000 21                 CMPQ    26
        20 002174   002200 600000 20                 TZE     s:9811

   9807 20 002175   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002176   000023 036100                    ADLQ    19,,PR0
        20 002177   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9811 20 002200   002425 701000 20                 TSX1    AFTER_LINES
        20 002201   000000 011000                    NOP     0

   9813 20 002202   200003 470500                    LDP0    @FAB,,AUTO
        20 002203   000051 471500                    LDP1    41,,PR0
        20 002204   000001 235007                    LDA     1,DL
        20 002205   100000 755100                    STA     0,,PR1

   9814 20 002206   200004 471500                    LDP1    @ALT_RET,,AUTO
        20 002207   100000 234100                    SZN     0,,PR1
        20 002210   002213 605000 20                 TPL     s:9817

   9815 20 002211   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002212   000000 702211                    TSX2  ! 0,X1

   9817 20 002213   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002214   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:123  
      726     9820    4             END;
      727     9821        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:124  
      728     9822        /*---------------\
      729     9823        |  Linage Clause |
      730     9824        \---------------*/
      731     9825
      732     9826    3         CASE (%AFTER_LINES);

      733     9827
      734     9828    3           IF LINAGE_COUNTER + ADV_CHAR.VFC# <= FAB.LINAGE THEN

   9828 20 002215   200003 471500                    LDP1    @FAB,,AUTO
        20 002216   100051 473500                    LDP3    41,,PR1
        20 002217   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 002220   300000 236100                    LDQ     0,,PR3
        20 002221   400000 036100                    ADLQ    0,,PR4
        20 002222   002226 604000 20                 TMI     s:9830
        20 002223   100021 116100                    CMPQ    17,,PR1
        20 002224   002226 600000 20                 TZE     s:9830
        20 002225   002254 603000 20                 TRC     s:9840

      735     9829    4             DO;

      736     9830    4               SLEW_CHAR = ADV_CHAR;

   9830 20 002226   400000 236100                    LDQ     0,,PR4
        20 002227   200206 756100                    STQ     SLEW_CHAR,,AUTO

      737     9831    4               CALL AFTER_LINES;

   9831 20 002230   002425 701000 20                 TSX1    AFTER_LINES
        20 002231   000000 011000                    NOP     0

      738     9832    4               LINAGE_COUNTER = LINAGE_COUNTER + ADV_CHAR.VFC#;

   9832 20 002232   200003 470500                    LDP0    @FAB,,AUTO
        20 002233   000051 471500                    LDP1    41,,PR0
        20 002234   200007 473500                    LDP3    @ADV_CHAR,,AUTO
        20 002235   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:125  
        20 002236   300000 036100                    ADLQ    0,,PR3
        20 002237   100000 756100                    STQ     0,,PR1

      739     9833    4               IF FAB.FOOTING$ ~= ADDR(NIL) THEN

   9833 20 002240   000046 236100                    LDQ     38,,PR0
        20 002241   000032 116000 21                 CMPQ    26
        20 002242   002252 600000 20                 TZE     s:9836

      740     9834    4                 IF LINAGE_COUNTER >= FAB.FOOTING THEN

   9834 20 002243   000051 471500                    LDP1    41,,PR0
        20 002244   100000 236100                    LDQ     0,,PR1
        20 002245   002252 604000 20                 TMI     s:9836
        20 002246   000022 116100                    CMPQ    18,,PR0
        20 002247   002252 602000 20                 TNC     s:9836

      741     9835    4                   ALTRETURN; /* page overflow */

   9835 20 002250   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002251   000000 702211                    TSX2  ! 0,X1

      742     9836    4               RETURN;

   9836 20 002252   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002253   000001 702211                    TSX2  ! 1,X1

      743     9837    4             END;
      744     9838    3           ELSE
      745     9839    4             DO;

      746     9840    4               SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER + 1;

   9840 20 002254   100021 236100                    LDQ     17,,PR1
        20 002255   300000 136100                    SBLQ    0,,PR3
        20 002256   000001 036007                    ADLQ    1,DL
        20 002257   200206 756100                    STQ     SLEW_CHAR,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:126  

      747     9841                    %NEW_PAGE;

   9843 20 002260   100050 236100                    LDQ     40,,PR1
        20 002261   000032 116000 21                 CMPQ    26
        20 002262   002266 600000 20                 TZE     s:9845

   9844 20 002263   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002264   100024 036100                    ADLQ    20,,PR1
        20 002265   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9845 20 002266   200003 630500                    EPPR0   @FAB,,AUTO
        20 002267   000000 631400 21                 EPPR1   0
        20 002270   000000 701000 xent               TSX1    X9WO$CONVERT_LINAGE
        20 002271   000000 011000                    NOP     0

   9846 20 002272   200003 470500                    LDP0    @FAB,,AUTO
        20 002273   000047 236100                    LDQ     39,,PR0
        20 002274   000032 116000 21                 CMPQ    26
        20 002275   002301 600000 20                 TZE     s:9851

   9847 20 002276   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002277   000023 036100                    ADLQ    19,,PR0
        20 002300   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9851 20 002301   002425 701000 20                 TSX1    AFTER_LINES
        20 002302   000000 011000                    NOP     0

   9853 20 002303   200003 470500                    LDP0    @FAB,,AUTO
        20 002304   000051 471500                    LDP1    41,,PR0
        20 002305   000001 235007                    LDA     1,DL
        20 002306   100000 755100                    STA     0,,PR1

   9854 20 002307   200004 471500                    LDP1    @ALT_RET,,AUTO
        20 002310   100000 234100                    SZN     0,,PR1
        20 002311   002314 605000 20                 TPL     s:9857

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:127  
   9855 20 002312   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002313   000000 702211                    TSX2  ! 0,X1

   9857 20 002314   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002315   000001 702211                    TSX2  ! 1,X1

      748     9860    4             END;
      749     9861        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:128  
      750     9862        /*---------------\
      751     9863        |  Linage Clause |
      752     9864        \---------------*/
      753     9865
      754     9866    3         CASE (%BEFORE_LINES);

      755     9867
      756     9868    3           IF LINAGE_COUNTER + ADV_CHAR.VFC# <= FAB.LINAGE THEN

   9868 20 002316   200003 471500                    LDP1    @FAB,,AUTO
        20 002317   100051 473500                    LDP3    41,,PR1
        20 002320   200007 474500                    LDP4    @ADV_CHAR,,AUTO
        20 002321   300000 236100                    LDQ     0,,PR3
        20 002322   400000 036100                    ADLQ    0,,PR4
        20 002323   002327 604000 20                 TMI     s:9870
        20 002324   100021 116100                    CMPQ    17,,PR1
        20 002325   002327 600000 20                 TZE     s:9870
        20 002326   002355 603000 20                 TRC     s:9880

      757     9869    4             DO;

      758     9870    4               SLEW_CHAR = ADV_CHAR;

   9870 20 002327   400000 236100                    LDQ     0,,PR4
        20 002330   200206 756100                    STQ     SLEW_CHAR,,AUTO

      759     9871    4               CALL BEFORE_LINES;

   9871 20 002331   002457 701000 20                 TSX1    BEFORE_LINES
        20 002332   000000 011000                    NOP     0

      760     9872    4               LINAGE_COUNTER = LINAGE_COUNTER + ADV_CHAR.VFC#;

   9872 20 002333   200003 470500                    LDP0    @FAB,,AUTO
        20 002334   000051 471500                    LDP1    41,,PR0
        20 002335   200007 473500                    LDP3    @ADV_CHAR,,AUTO
        20 002336   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:129  
        20 002337   300000 036100                    ADLQ    0,,PR3
        20 002340   100000 756100                    STQ     0,,PR1

      761     9873    4               IF FAB.FOOTING$ ~= ADDR(NIL) THEN

   9873 20 002341   000046 236100                    LDQ     38,,PR0
        20 002342   000032 116000 21                 CMPQ    26
        20 002343   002353 600000 20                 TZE     s:9876

      762     9874    4                 IF LINAGE_COUNTER >= FAB.FOOTING THEN

   9874 20 002344   000051 471500                    LDP1    41,,PR0
        20 002345   100000 236100                    LDQ     0,,PR1
        20 002346   002353 604000 20                 TMI     s:9876
        20 002347   000022 116100                    CMPQ    18,,PR0
        20 002350   002353 602000 20                 TNC     s:9876

      763     9875    4                   ALTRETURN; /* page overflow */

   9875 20 002351   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002352   000000 702211                    TSX2  ! 0,X1

      764     9876    4               RETURN;

   9876 20 002353   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002354   000001 702211                    TSX2  ! 1,X1

      765     9877    4             END;
      766     9878    3           ELSE
      767     9879    4             DO;

      768     9880    4               SLEW_CHAR.VFC# = FAB.LINAGE - LINAGE_COUNTER + 1;

   9880 20 002355   100021 236100                    LDQ     17,,PR1
        20 002356   300000 136100                    SBLQ    0,,PR3
        20 002357   000001 036007                    ADLQ    1,DL
        20 002360   200206 756100                    STQ     SLEW_CHAR,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:130  

      769     9881                    %NEW_PAGE (@BEFORE = YES);

   9883 20 002361   100050 236100                    LDQ     40,,PR1
        20 002362   000032 116000 21                 CMPQ    26
        20 002363   002367 600000 20                 TZE     s:9885

   9884 20 002364   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002365   100024 036100                    ADLQ    20,,PR1
        20 002366   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9885 20 002367   200003 630500                    EPPR0   @FAB,,AUTO
        20 002370   000000 631400 21                 EPPR1   0
        20 002371   000000 701000 xent               TSX1    X9WO$CONVERT_LINAGE
        20 002372   000000 011000                    NOP     0

   9886 20 002373   200003 470500                    LDP0    @FAB,,AUTO
        20 002374   000047 236100                    LDQ     39,,PR0
        20 002375   000032 116000 21                 CMPQ    26
        20 002376   002402 600000 20                 TZE     s:9889

   9887 20 002377   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002400   000023 036100                    ADLQ    19,,PR0
        20 002401   200206 756100                    STQ     SLEW_CHAR,,AUTO

   9889 20 002402   002457 701000 20                 TSX1    BEFORE_LINES
        20 002403   000000 011000                    NOP     0

   9893 20 002404   200003 470500                    LDP0    @FAB,,AUTO
        20 002405   000051 471500                    LDP1    41,,PR0
        20 002406   000001 235007                    LDA     1,DL
        20 002407   100000 755100                    STA     0,,PR1

   9894 20 002410   200004 471500                    LDP1    @ALT_RET,,AUTO
        20 002411   100000 234100                    SZN     0,,PR1
        20 002412   002415 605000 20                 TPL     s:9897

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:131  
   9895 20 002413   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002414   000000 702211                    TSX2  ! 0,X1

   9897 20 002415   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002416   000001 702211                    TSX2  ! 1,X1

      770     9900    4             END;
      771     9901        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:132  
      772     9902        /*---------------\
      773     9903        |  Linage Clause |
      774     9904        \---------------*/
      775     9905
      776     9906    3         CASE (ELSE);

      777     9907    3           CALL X8ER$ERROR (%UNEXPECTED_CASE);

   9907 20 002417   000004 630400 21                 EPPR0   4
        20 002420   000000 631400 21                 EPPR1   0
        20 002421   000000 701000 xent               TSX1    X8ER$ERROR
        20 002422   000000 011000                    NOP     0

      778     9908    3           RETURN;

   9908 20 002423   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 002424   000001 702211                    TSX2  ! 1,X1

      779     9909    3       END;  /* case slew_code */

      780     9910    2     END ADD_VFC_LINAGE;        /* proc */
      781     9911        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:133  
      782     9912        /*-------------*/
      783     9913    1       AFTER_LINES:  PROC;

   9913 20 002425   200222 741300       AFTER_LINES  STX1  ! FIRST_PAGE+3,,AUTO

      784     9914        /*-------------*/
      785     9915
      786     9916    2           SAVE_VECTOR = WRITE_SEQ.BUF_ ;

   9916 20 002426   000020 237000 19                 LDAQ    WRITE_SEQ+4
        20 002427   200212 757100                    STAQ    SAVE_VECTOR,,AUTO

      787     9917    3           DO WHILE SLEW_CHAR.VFC# > 15;

   9917 20 002430   200206 235100                    LDA     SLEW_CHAR,,AUTO
        20 002431   000017 115007                    CMPA    15,DL
        20 002432   002444 604400 20                 TMOZ    s:9922

      788     9918    3             SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - 15;

   9918 20 002433   000017 336007                    LCQ     15,DL
        20 002434   200206 056100                    ASQ     SLEW_CHAR,,AUTO

      789     9919    3             WRITE_SEQ.BUF_ = VECTOR (PRE_SLEW);

   9919 20 002435   000050 237000 21                 LDAQ    40
        20 002436   000020 757000 19                 STAQ    WRITE_SEQ+4

      790     9920    3             CALL WRITE;

   9920 20 002437   003175 701000 20                 TSX1    WRITE
        20 002440   000000 011000                    NOP     0

      791     9921    3           END;

   9921 20 002441   200206 235100                    LDA     SLEW_CHAR,,AUTO
        20 002442   000017 115007                    CMPA    15,DL
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:134  
        20 002443   002433 605400 20                 TPNZ    s:9918

      792     9922    2           WRITE_SEQ.BUF_ = SAVE_VECTOR;

   9922 20 002444   200212 237100                    LDAQ    SAVE_VECTOR,,AUTO
        20 002445   000020 757000 19                 STAQ    WRITE_SEQ+4

      793     9923    2           VFC = AFTER_ADV (SLEW_CHAR.VFC#);

   9923 20 002446   200206 235100                    LDA     SLEW_CHAR,,AUTO
        20 002447   200216 470500                    LDP0    VFC$,,AUTO
        20 002450   040100 100405                    MLR     fill='040'O
        20 002451   000000 000001 18                 ADSC9   AFTER_ADV,A              cn=0,n=1
        20 002452   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      794     9924    2           CALL WRITE;

   9924 20 002453   003175 701000 20                 TSX1    WRITE
        20 002454   000000 011000                    NOP     0

      795     9925
      796     9926    2     END AFTER_LINES;  /* proc */

   9926 20 002455   200222 221300                    LDX1  ! FIRST_PAGE+3,,AUTO
        20 002456   000001 702211                    TSX2  ! 1,X1

      797     9927        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:135  
      798     9928        /*--------------*/
      799     9929    1       BEFORE_LINES:  PROC;

   9929 20 002457   200222 741300       BEFORE_LINES STX1  ! FIRST_PAGE+3,,AUTO

      800     9930        /*--------------*/
      801     9931
      802     9932    2           IF SLEW_CHAR.VFC# = 0 THEN

   9932 20 002460   200206 235100                    LDA     SLEW_CHAR,,AUTO
        20 002461   002471 601000 20                 TNZ     s:9939

      803     9933    3             DO;

      804     9934    3               VFC = AFTER_ADV(0);     /*  no slew vfc is here */

   9934 20 002462   200216 470500                    LDP0    VFC$,,AUTO
        20 002463   040100 100400                    MLR     fill='040'O
        20 002464   000000 000001 18                 ADSC9   AFTER_ADV                cn=0,n=1
        20 002465   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      805     9935    3               CALL WRITE;

   9935 20 002466   003175 701000 20                 TSX1    WRITE
        20 002467   000000 011000                    NOP     0

      806     9936    3             END;

   9936 20 002470   002545 710000 20                 TRA     s:9956

      807     9937    2           ELSE
      808     9938    3             DO;

      809     9939    3               VFC = BEFORE_ADV (MOD(SLEW_CHAR.VFC#,15));

   9939 20 002471   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002472   000017 506007                    DIV     15,DL
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:136  
        20 002473   200216 470500                    LDP0    VFC$,,AUTO
        20 002474   040100 100405                    MLR     fill='040'O
        20 002475   000004 000001 18                 ADSC9   BEFORE_ADV,A             cn=0,n=1
        20 002476   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      810     9940    3               IF MOD (SLEW_CHAR.VFC#,15) = 0 THEN

   9940 20 002477   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002500   000017 506007                    DIV     15,DL
        20 002501   000044 733000                    LRS     36
        20 002502   000000 116003                    CMPQ    0,DU
        20 002503   002507 601000 20                 TNZ     s:9943

      811     9941    3                 SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - 15;

   9941 20 002504   000017 336007                    LCQ     15,DL
        20 002505   200206 056100                    ASQ     SLEW_CHAR,,AUTO
        20 002506   002515 710000 20                 TRA     s:9944

      812     9942    3               ELSE
      813     9943    3                 SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - MOD (SLEW_CHAR.VFC#,15);

   9943 20 002507   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002510   000017 506007                    DIV     15,DL
        20 002511   200226 755100                    STA     FIRST_PAGE+7,,AUTO
        20 002512   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002513   200226 136100                    SBLQ    FIRST_PAGE+7,,AUTO
        20 002514   200206 756100                    STQ     SLEW_CHAR,,AUTO

      814     9944    3               SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - MOD(SLEW_CHAR.VFC#,15);

   9944 20 002515   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002516   000017 506007                    DIV     15,DL
        20 002517   200226 755100                    STA     FIRST_PAGE+7,,AUTO
        20 002520   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002521   200226 136100                    SBLQ    FIRST_PAGE+7,,AUTO
        20 002522   200206 756100                    STQ     SLEW_CHAR,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:137  

      815     9945    3               CALL WRITE;

   9945 20 002523   003175 701000 20                 TSX1    WRITE
        20 002524   000000 011000                    NOP     0

      816     9946
      817     9947    4               DO WHILE SLEW_CHAR.VFC# >= 15;

   9947 20 002525   200206 235100                    LDA     SLEW_CHAR,,AUTO
        20 002526   000017 115007                    CMPA    15,DL
        20 002527   002543 604000 20                 TMI     s:9953

      818     9948    4               SAVE_VECTOR = WRITE_SEQ.BUF_ ;

   9948 20 002530   000020 237000 19                 LDAQ    WRITE_SEQ+4
        20 002531   200212 757100                    STAQ    SAVE_VECTOR,,AUTO

      819     9949    4               WRITE_SEQ.BUF_ = VECTOR (POST_SLEW);

   9949 20 002532   000052 237000 21                 LDAQ    42
        20 002533   000020 757000 19                 STAQ    WRITE_SEQ+4

      820     9950    4                 SLEW_CHAR.VFC# = SLEW_CHAR.VFC# - 15 ;

   9950 20 002534   000017 336007                    LCQ     15,DL
        20 002535   200206 056100                    ASQ     SLEW_CHAR,,AUTO

      821     9951    4                 CALL WRITE;

   9951 20 002536   003175 701000 20                 TSX1    WRITE
        20 002537   000000 011000                    NOP     0

      822     9952    4               END;

   9952 20 002540   200206 235100                    LDA     SLEW_CHAR,,AUTO
        20 002541   000017 115007                    CMPA    15,DL
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:138  
        20 002542   002530 605000 20                 TPL     s:9948

      823     9953    3               WRITE_SEQ.BUF_ = SAVE_VECTOR;

   9953 20 002543   200212 237100                    LDAQ    SAVE_VECTOR,,AUTO
        20 002544   000020 757000 19                 STAQ    WRITE_SEQ+4

      824     9954    3             END;

      825     9955
      826     9956    2     END BEFORE_LINES;  /* proc */

   9956 20 002545   200222 221300                    LDX1  ! FIRST_PAGE+3,,AUTO
        20 002546   000001 702211                    TSX2  ! 1,X1

      827     9957        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:139  
      828     9958        /*-----------*/
      829     9959    1       AFTER_POS:  PROC;

   9959 20 002547   200220 741300       AFTER_POS    STX1  ! FIRST_PAGE+1,,AUTO

      830     9960        /*-----------*/
      831     9961
      832     9962    3           DO SELECT (SLEW_CHAR.VFC.VFC_CHAR);

   9962 20 002550   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002551   777000 376003                    ANQ     -512,DU
        20 002552   102000 116003                    CMPQ    33792,DU
        20 002553   002661 602000 20                 TNC     s:9962+73
        20 002554   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002555   777000 376003                    ANQ     -512,DU
        20 002556   102000 116003                    CMPQ    33792,DU
        20 002557   003123 600000 20                 TZE     s:10007
        20 002560   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002561   777000 376003                    ANQ     -512,DU
        20 002562   141000 116003                    CMPQ    49664,DU
        20 002563   002627 602000 20                 TNC     s:9962+47
        20 002564   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002565   777000 376003                    ANQ     -512,DU
        20 002566   141000 116003                    CMPQ    49664,DU
        20 002567   003116 600000 20                 TZE     s:10004
        20 002570   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002571   777000 376003                    ANQ     -512,DU
        20 002572   143000 116003                    CMPQ    50688,DU
        20 002573   002622 602000 20                 TNC     s:9962+42
        20 002574   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002575   777000 376003                    ANQ     -512,DU
        20 002576   143000 116003                    CMPQ    50688,DU
        20 002577   003130 600000 20                 TZE     s:10010
        20 002600   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002601   777000 376003                    ANQ     -512,DU
        20 002602   145000 116003                    CMPQ    51712,DU
        20 002603   002615 602000 20                 TNC     s:9962+37
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:140  
        20 002604   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002605   777000 376003                    ANQ     -512,DU
        20 002606   145000 116003                    CMPQ    51712,DU
        20 002607   003142 600000 20                 TZE     s:10016
        20 002610   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002611   777000 376003                    ANQ     -512,DU
        20 002612   146000 116003                    CMPQ    52224,DU
        20 002613   003154 601000 20                 TNZ     s:10022
        20 002614   003147 710000 20                 TRA     s:10019
        20 002615   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002616   777000 376003                    ANQ     -512,DU
        20 002617   144000 116003                    CMPQ    51200,DU
        20 002620   003154 601000 20                 TNZ     s:10022
        20 002621   003135 710000 20                 TRA     s:10013
        20 002622   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002623   777000 376003                    ANQ     -512,DU
        20 002624   142000 116003                    CMPQ    50176,DU
        20 002625   003154 601000 20                 TNZ     s:10022
        20 002626   003123 710000 20                 TRA     s:10007
        20 002627   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002630   777000 376003                    ANQ     -512,DU
        20 002631   104000 116003                    CMPQ    34816,DU
        20 002632   002654 602000 20                 TNC     s:9962+68
        20 002633   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002634   777000 376003                    ANQ     -512,DU
        20 002635   104000 116003                    CMPQ    34816,DU
        20 002636   003135 600000 20                 TZE     s:10013
        20 002637   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002640   777000 376003                    ANQ     -512,DU
        20 002641   105000 116003                    CMPQ    35328,DU
        20 002642   003154 602000 20                 TNC     s:10022
        20 002643   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002644   777000 376003                    ANQ     -512,DU
        20 002645   105000 116003                    CMPQ    35328,DU
        20 002646   003142 600000 20                 TZE     s:10016
        20 002647   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002650   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:141  
        20 002651   106000 116003                    CMPQ    35840,DU
        20 002652   003154 601000 20                 TNZ     s:10022
        20 002653   003147 710000 20                 TRA     s:10019
        20 002654   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002655   777000 376003                    ANQ     -512,DU
        20 002656   103000 116003                    CMPQ    34304,DU
        20 002657   003154 601000 20                 TNZ     s:10022
        20 002660   003130 710000 20                 TRA     s:10010
        20 002661   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002662   777000 376003                    ANQ     -512,DU
        20 002663   064000 116003                    CMPQ    26624,DU
        20 002664   002741 602000 20                 TNC     s:9962+121
        20 002665   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002666   777000 376003                    ANQ     -512,DU
        20 002667   064000 116003                    CMPQ    26624,DU
        20 002670   003060 600000 20                 TZE     s:9986
        20 002671   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002672   777000 376003                    ANQ     -512,DU
        20 002673   070000 116003                    CMPQ    28672,DU
        20 002674   002717 602000 20                 TNC     s:9962+103
        20 002675   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002676   777000 376003                    ANQ     -512,DU
        20 002677   070000 116003                    CMPQ    28672,DU
        20 002700   003104 600000 20                 TZE     s:9998
        20 002701   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002702   777000 376003                    ANQ     -512,DU
        20 002703   101000 116003                    CMPQ    33280,DU
        20 002704   002712 602000 20                 TNC     s:9962+98
        20 002705   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002706   777000 376003                    ANQ     -512,DU
        20 002707   101000 116003                    CMPQ    33280,DU
        20 002710   003116 600000 20                 TZE     s:10004
        20 002711   003154 710000 20                 TRA     s:10022
        20 002712   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002713   777000 376003                    ANQ     -512,DU
        20 002714   071000 116003                    CMPQ    29184,DU
        20 002715   003154 601000 20                 TNZ     s:10022
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:142  
        20 002716   003111 710000 20                 TRA     s:10001
        20 002717   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002720   777000 376003                    ANQ     -512,DU
        20 002721   066000 116003                    CMPQ    27648,DU
        20 002722   002734 602000 20                 TNC     s:9962+116
        20 002723   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002724   777000 376003                    ANQ     -512,DU
        20 002725   066000 116003                    CMPQ    27648,DU
        20 002726   003072 600000 20                 TZE     s:9992
        20 002727   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002730   777000 376003                    ANQ     -512,DU
        20 002731   067000 116003                    CMPQ    28160,DU
        20 002732   003154 601000 20                 TNZ     s:10022
        20 002733   003077 710000 20                 TRA     s:9995
        20 002734   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002735   777000 376003                    ANQ     -512,DU
        20 002736   065000 116003                    CMPQ    27136,DU
        20 002737   003154 601000 20                 TNZ     s:10022
        20 002740   003065 710000 20                 TRA     s:9989
        20 002741   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002742   777000 376003                    ANQ     -512,DU
        20 002743   060000 116003                    CMPQ    24576,DU
        20 002744   002773 602000 20                 TNC     s:9962+147
        20 002745   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002746   777000 376003                    ANQ     -512,DU
        20 002747   060000 116003                    CMPQ    24576,DU
        20 002750   003027 600000 20                 TZE     s:9971
        20 002751   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002752   777000 376003                    ANQ     -512,DU
        20 002753   062000 116003                    CMPQ    25600,DU
        20 002754   002766 602000 20                 TNC     s:9962+142
        20 002755   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002756   777000 376003                    ANQ     -512,DU
        20 002757   062000 116003                    CMPQ    25600,DU
        20 002760   003046 600000 20                 TZE     s:9980
        20 002761   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002762   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:143  
        20 002763   063000 116003                    CMPQ    26112,DU
        20 002764   003154 601000 20                 TNZ     s:10022
        20 002765   003053 710000 20                 TRA     s:9983
        20 002766   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002767   777000 376003                    ANQ     -512,DU
        20 002770   061000 116003                    CMPQ    25088,DU
        20 002771   003154 601000 20                 TNZ     s:10022
        20 002772   003041 710000 20                 TRA     s:9977
        20 002773   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 002774   777000 376003                    ANQ     -512,DU
        20 002775   053000 116003                    CMPQ    22016,DU
        20 002776   003010 602000 20                 TNC     s:9962+160
        20 002777   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 003000   777000 376003                    ANQ     -512,DU
        20 003001   053000 116003                    CMPQ    22016,DU
        20 003002   003022 600000 20                 TZE     s:9968
        20 003003   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 003004   777000 376003                    ANQ     -512,DU
        20 003005   055000 116003                    CMPQ    23040,DU
        20 003006   003154 601000 20                 TNZ     s:10022
        20 003007   003034 710000 20                 TRA     s:9974
        20 003010   200206 236100                    LDQ     SLEW_CHAR,,AUTO
        20 003011   777000 376003                    ANQ     -512,DU
        20 003012   040000 116003                    CMPQ    16384,DU
        20 003013   003154 601000 20                 TNZ     s:10022
        20 003014   003015 710000 20                 TRA     s:9965

      833     9963
      834     9964    3             SELECT (' ');

      835     9965    3               VFC = AFTER_ADV (1);   /* single spacing */

   9965 20 003015   200216 470500                    LDP0    VFC$,,AUTO
        20 003016   040100 100400                    MLR     fill='040'O
        20 003017   000000 200001 18                 ADSC9   AFTER_ADV                cn=1,n=1
        20 003020   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003021   003171 710000 20                 TRA     s:10028
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:144  

      836     9966
      837     9967    3             SELECT ('+');

      838     9968    3               VFC = AFTER_ADV (0);   /* no     spacing */

   9968 20 003022   200216 470500                    LDP0    VFC$,,AUTO
        20 003023   040100 100400                    MLR     fill='040'O
        20 003024   000000 000001 18                 ADSC9   AFTER_ADV                cn=0,n=1
        20 003025   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003026   003171 710000 20                 TRA     s:10028

      839     9969
      840     9970    3             SELECT ('0');

      841     9971    3               VFC = AFTER_ADV (2);   /* double spacing */

   9971 20 003027   200216 470500                    LDP0    VFC$,,AUTO
        20 003030   040100 100400                    MLR     fill='040'O
        20 003031   000000 400001 18                 ADSC9   AFTER_ADV                cn=2,n=1
        20 003032   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003033   003171 710000 20                 TRA     s:10028

      842     9972
      843     9973    3             SELECT ('-');

      844     9974    3               VFC = AFTER_ADV (3);   /* triple spacing */

   9974 20 003034   200216 470500                    LDP0    VFC$,,AUTO
        20 003035   040100 100400                    MLR     fill='040'O
        20 003036   000000 600001 18                 ADSC9   AFTER_ADV                cn=3,n=1
        20 003037   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003040   003171 710000 20                 TRA     s:10028

      845     9975
      846     9976    3             SELECT ('1');

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:145  
      847     9977    3               VFC = AFTER_CHN (1);

   9977 20 003041   200216 470500                    LDP0    VFC$,,AUTO
        20 003042   040100 100400                    MLR     fill='040'O
        20 003043   000010 200001 18                 ADSC9   AFTER_CHN                cn=1,n=1
        20 003044   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003045   003171 710000 20                 TRA     s:10028

      848     9978
      849     9979    3             SELECT ('2');

      850     9980    3               VFC = AFTER_CHN (2);

   9980 20 003046   200216 470500                    LDP0    VFC$,,AUTO
        20 003047   040100 100400                    MLR     fill='040'O
        20 003050   000010 400001 18                 ADSC9   AFTER_CHN                cn=2,n=1
        20 003051   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003052   003171 710000 20                 TRA     s:10028

      851     9981
      852     9982    3             SELECT ('3');

      853     9983    3               VFC = AFTER_CHN (3);

   9983 20 003053   200216 470500                    LDP0    VFC$,,AUTO
        20 003054   040100 100400                    MLR     fill='040'O
        20 003055   000010 600001 18                 ADSC9   AFTER_CHN                cn=3,n=1
        20 003056   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003057   003171 710000 20                 TRA     s:10028

      854     9984
      855     9985    3             SELECT ('4');

      856     9986    3               VFC = AFTER_CHN (4);

   9986 20 003060   200216 470500                    LDP0    VFC$,,AUTO
        20 003061   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:146  
        20 003062   000011 000001 18                 ADSC9   AFTER_CHN+1              cn=0,n=1
        20 003063   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003064   003171 710000 20                 TRA     s:10028

      857     9987
      858     9988    3             SELECT ('5');

      859     9989    3               VFC = AFTER_CHN (5);

   9989 20 003065   200216 470500                    LDP0    VFC$,,AUTO
        20 003066   040100 100400                    MLR     fill='040'O
        20 003067   000011 200001 18                 ADSC9   AFTER_CHN+1              cn=1,n=1
        20 003070   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003071   003171 710000 20                 TRA     s:10028

      860     9990
      861     9991    3             SELECT ('6');

      862     9992    3               VFC = AFTER_CHN (6);

   9992 20 003072   200216 470500                    LDP0    VFC$,,AUTO
        20 003073   040100 100400                    MLR     fill='040'O
        20 003074   000011 400001 18                 ADSC9   AFTER_CHN+1              cn=2,n=1
        20 003075   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003076   003171 710000 20                 TRA     s:10028

      863     9993
      864     9994    3             SELECT ('7');

      865     9995    3               VFC = AFTER_CHN (7);

   9995 20 003077   200216 470500                    LDP0    VFC$,,AUTO
        20 003100   040100 100400                    MLR     fill='040'O
        20 003101   000011 600001 18                 ADSC9   AFTER_CHN+1              cn=3,n=1
        20 003102   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003103   003171 710000 20                 TRA     s:10028

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:147  
      866     9996
      867     9997    3             SELECT ('8');

      868     9998    3               VFC = AFTER_CHN (8);

   9998 20 003104   200216 470500                    LDP0    VFC$,,AUTO
        20 003105   040100 100400                    MLR     fill='040'O
        20 003106   000012 000001 18                 ADSC9   AFTER_CHN+2              cn=0,n=1
        20 003107   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003110   003171 710000 20                 TRA     s:10028

      869     9999
      870    10000    3             SELECT ('9');

      871    10001    3               VFC = AFTER_CHN (9);

  10001 20 003111   200216 470500                    LDP0    VFC$,,AUTO
        20 003112   040100 100400                    MLR     fill='040'O
        20 003113   000012 200001 18                 ADSC9   AFTER_CHN+2              cn=1,n=1
        20 003114   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003115   003171 710000 20                 TRA     s:10028

      872    10002
      873    10003    3             SELECT ('A', 'a');

      874    10004    3               VFC = AFTER_CHN (10);

  10004 20 003116   200216 470500                    LDP0    VFC$,,AUTO
        20 003117   040100 100400                    MLR     fill='040'O
        20 003120   000012 400001 18                 ADSC9   AFTER_CHN+2              cn=2,n=1
        20 003121   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003122   003171 710000 20                 TRA     s:10028

      875    10005
      876    10006    3             SELECT ('B', 'b');

      877    10007    3               VFC = AFTER_CHN (11);
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:148  

  10007 20 003123   200216 470500                    LDP0    VFC$,,AUTO
        20 003124   040100 100400                    MLR     fill='040'O
        20 003125   000012 600001 18                 ADSC9   AFTER_CHN+2              cn=3,n=1
        20 003126   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003127   003171 710000 20                 TRA     s:10028

      878    10008
      879    10009    3             SELECT ('C', 'c');

      880    10010    3               VFC = AFTER_CHN (12);

  10010 20 003130   200216 470500                    LDP0    VFC$,,AUTO
        20 003131   040100 100400                    MLR     fill='040'O
        20 003132   000013 000001 18                 ADSC9   AFTER_CHN+3              cn=0,n=1
        20 003133   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003134   003171 710000 20                 TRA     s:10028

      881    10011
      882    10012    3             SELECT ('D', 'd');

      883    10013    3               VFC = AFTER_CHN (13);

  10013 20 003135   200216 470500                    LDP0    VFC$,,AUTO
        20 003136   040100 100400                    MLR     fill='040'O
        20 003137   000013 200001 18                 ADSC9   AFTER_CHN+3              cn=1,n=1
        20 003140   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003141   003171 710000 20                 TRA     s:10028

      884    10014
      885    10015    3             SELECT ('E', 'e');

      886    10016    3               VFC = AFTER_CHN (14);

  10016 20 003142   200216 470500                    LDP0    VFC$,,AUTO
        20 003143   040100 100400                    MLR     fill='040'O
        20 003144   000013 400001 18                 ADSC9   AFTER_CHN+3              cn=2,n=1
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:149  
        20 003145   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003146   003171 710000 20                 TRA     s:10028

      887    10017
      888    10018    3             SELECT ('F', 'f');

      889    10019    3               VFC = AFTER_CHN (15);

  10019 20 003147   200216 470500                    LDP0    VFC$,,AUTO
        20 003150   040100 100400                    MLR     fill='040'O
        20 003151   000013 600001 18                 ADSC9   AFTER_CHN+3              cn=3,n=1
        20 003152   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        20 003153   003171 710000 20                 TRA     s:10028

      890    10020
      891    10021    3             SELECT (ELSE);

      892    10022    3               SPECIAL_ERR_MSG = SLEW_CHAR.VFC.VFC_CHAR;

  10022 20 003154   040100 100500                    MLR     fill='040'O
        20 003155   200206 000001                    ADSC9   SLEW_CHAR,,AUTO          cn=0,n=1
        20 003156   200055 000120                    ADSC9   SPECIAL_ERR_MSG,,AUTO    cn=0,n=80

      893    10023    3               CALL X8ER$ERROR (%IO_INVALID_CHANNEL, SPECIAL_ERR_MSG);

  10023 20 003157   200055 630500                    EPPR0   SPECIAL_ERR_MSG,,AUTO
        20 003160   200227 450500                    STP0    FIRST_PAGE+8,,AUTO
        20 003161   000055 236000 21                 LDQ     45
        20 003162   200226 756100                    STQ     FIRST_PAGE+7,,AUTO
        20 003163   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 003164   000025 631400 21                 EPPR1   21
        20 003165   000000 701000 xent               TSX1    X8ER$ERROR
        20 003166   000000 011000                    NOP     0

      894    10024    3               RETURN;

  10024 20 003167   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:150  
        20 003170   000001 702211                    TSX2  ! 1,X1

      895    10025
      896    10026    3           END;  /* select slew_char */

      897    10027
      898    10028    2           CALL WRITE;

  10028 20 003171   003175 701000 20                 TSX1    WRITE
        20 003172   000000 011000                    NOP     0

      899    10029
      900    10030    2     END AFTER_POS;   /* proc */

  10030 20 003173   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 003174   000001 702211                    TSX2  ! 1,X1

      901    10031        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:151  
      902    10032        /*-------*/
      903    10033    1       WRITE:             PROC   ALTRET;

  10033 20 003175   200224 741300       WRITE        STX1  ! FIRST_PAGE+5,,AUTO

      904    10034        /*-------*/
      905    10035
      906    10036    2       IO_STATUS = %SUCCESSFUL;  /*  Preset IO status  */

  10036 20 003176   200003 470500                    LDP0    @FAB,,AUTO
        20 003177   000036 471500                    LDP1    30,,PR0
        20 003200   040100 100400                    MLR     fill='040'O
        20 003201   000027 000002 18                 ADSC9   PRE_SLEW+6               cn=0,n=2
        20 003202   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      907    10037
      908    10038    2       IF FAB.B.FAST_SEQUENTIAL THEN

  10038 20 003203   000032 236100                    LDQ     26,,PR0
        20 003204   000004 316003                    CANQ    4,DU
        20 003205   003233 600000 20                 TZE     s:10050

      909    10039    2        CALL XSA$WRITE (WRITE_SEQ, FAB.XSA)

  10039 20 003206   200003 236100                    LDQ     @FAB,,AUTO
        20 003207   000060 036003                    ADLQ    48,DU
        20 003210   000056 235000 21                 LDA     46
        20 003211   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 003212   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 003213   000025 631400 21                 EPPR1   21
        20 003214   000000 701000 xent               TSX1    XSA$WRITE
        20 003215   003217 702000 20                 TSX2    s:10042
        20 003216   003232 710000 20                 TRA     s:10048

      910    10040    2          WHENALTRETURN
      911    10041    3            DO;

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:152  
      912    10042    3              CALL X9WE$IO_ERROR (FAB, ALT_RET)

  10042 20 003217   200003 630500                    EPPR0   @FAB,,AUTO
        20 003220   000025 631400 21                 EPPR1   21
        20 003221   000000 701000 xent               TSX1    X9WE$IO_ERROR
        20 003222   003224 702000 20                 TSX2    s:10045
        20 003223   003232 710000 20                 TRA     s:10048

      913    10043    3                WHENALTRETURN
      914    10044    4                  DO;

      915    10045    4                    IF FAB.ORG# ~= %CP6_SEQUENTIAL THEN

  10045 20 003224   200003 470500                    LDP0    @FAB,,AUTO
        20 003225   000002 235100                    LDA     2,,PR0
        20 003226   000001 115007                    CMPA    1,DL
        20 003227   003232 600000 20                 TZE     s:10048

      916    10046    4                      ALTRETURN;

  10046 20 003230   200224 221300                    LDX1  ! FIRST_PAGE+5,,AUTO
        20 003231   000000 702211                    TSX2  ! 0,X1

      917    10047    4                  END;
      918    10048    3             END;

  10048 20 003232   003617 710000 20                 TRA     s:10170

      919    10049    2       ELSE
      920    10050    2        CALL M$WRITE  (WRITE_SEQ)

  10050 20 003233   000014 630400 19                 EPPR0   WRITE_SEQ
        20 003234   440001 713400                    CLIMB   alt,write
        20 003235   401400 401760                    pmme    nvectors=4
        20 003236   003240 702000 20                 TSX2    s:10053
        20 003237   003617 710000 20                 TRA     s:10170

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:153  
      921    10051    2          WHENALTRETURN
      922    10052    3            DO;

      923    10053    3              CALL X9WE$IO_ERROR (FAB, ALT_RET)

  10053 20 003240   200003 630500                    EPPR0   @FAB,,AUTO
        20 003241   000025 631400 21                 EPPR1   21
        20 003242   000000 701000 xent               TSX1    X9WE$IO_ERROR
        20 003243   003245 702000 20                 TSX2    s:10056
        20 003244   003617 710000 20                 TRA     s:10170

      924    10054    3                WHENALTRETURN
      925    10055    4                  DO;

      926    10056    4                    IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR# = %E$EOVOL THEN

  10056 20 003245   000000 470400 xsym               LDP0    B$TCB$
        20 003246   000000 471500                    LDP1    0,,PR0
        20 003247   100102 236100                    LDQ     66,,PR1
        20 003250   377770 376007                    ANQ     131064,DL
        20 003251   013130 116007                    CMPQ    5720,DL
        20 003252   003611 601000 20                 TNZ     s:10165

      927    10057    5                      DO;

      928    10058                             %SWAP_VOLUME_AND_REWRITE;

  10060 20 003253   200003 473500                    LDP3    @FAB,,AUTO
        20 003254   300034 220100                    LDX0    28,,PR3
        20 003255   000052 740000 19                 STX0    CLOSE_VOLUME+6

  10063 20 003256   300040 236100                    LDQ     32,,PR3
        20 003257   000032 116000 21                 CMPQ    26
        20 003260   003375 600000 20                 TZE     s:10098

  10065 20 003261   200102 756100                    STQ     USE$$,,AUTO

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:154  
  10066 20 003262   000007 471400 21                 LDP1    7
        20 003263   100000 474500                    LDP4    0,,PR1
        20 003264   300034 221100                    LDX1    28,,PR3
        20 003265   400000 236111                    LDQ     0,X1,PR4
        20 003266   200101 756100                    STQ     DCB$,,AUTO

  10067 20 003267   200101 475500                    LDP5    DCB$,,AUTO
        20 003270   500032 222100                    LDX2    26,,PR5
        20 003271   000777 362003                    ANX2    511,DU
        20 003272   000004 102003                    CMPX2   4,DU
        20 003273   003275 602012 20                 TNC     s:10067+6,X2
        20 003274   003375 710000 20                 TRA     s:10098
        20 003275   003375 710000 20                 TRA     s:10098
        20 003276   003375 710000 20                 TRA     s:10098
        20 003277   003353 710000 20                 TRA     s:10088
        20 003300   003301 710000 20                 TRA     s:10069

  10069 20 003301   500031 236100                    LDQ     25,,PR5
        20 003302   003000 376007                    ANQ     1536,DL
        20 003303   002000 116007                    CMPQ    1024,DL
        20 003304   003330 601000 20                 TNZ     s:10080

  10071 20 003305   200102 476500                    LDP6    USE$$,,AUTO
        20 003306   600021 236100                    LDQ     17,,PR6
        20 003307   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10072 20 003310   000015 116000 21                 CMPQ    13
        20 003311   003316 600000 20                 TZE     s:10074

  10073 20 003312   200103 223100                    LDX3    USE_ENTRY$,,AUTO
        20 003313   000015 631400 21                 EPPR1   13
        20 003314   000000 701013                    TSX1    0,X3
        20 003315   000000 011000                    NOP     0

  10074 20 003316   200102 470500                    LDP0    USE$$,,AUTO
        20 003317   000016 236100                    LDQ     14,,PR0
        20 003320   200103 756100                    STQ     USE_ENTRY$,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:155  

  10075 20 003321   000015 116000 21                 CMPQ    13
        20 003322   003375 600000 20                 TZE     s:10098

  10076 20 003323   200103 220100                    LDX0    USE_ENTRY$,,AUTO
        20 003324   000015 631400 21                 EPPR1   13
        20 003325   000000 701010                    TSX1    0,X0
        20 003326   000000 011000                    NOP     0

  10077 20 003327   003375 710000 20                 TRA     s:10098

  10080 20 003330   200102 476500                    LDP6    USE$$,,AUTO
        20 003331   600020 236100                    LDQ     16,,PR6
        20 003332   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10081 20 003333   000015 116000 21                 CMPQ    13
        20 003334   003341 600000 20                 TZE     s:10083

  10082 20 003335   200103 223100                    LDX3    USE_ENTRY$,,AUTO
        20 003336   000015 631400 21                 EPPR1   13
        20 003337   000000 701013                    TSX1    0,X3
        20 003340   000000 011000                    NOP     0

  10083 20 003341   200102 470500                    LDP0    USE$$,,AUTO
        20 003342   000015 236100                    LDQ     13,,PR0
        20 003343   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10084 20 003344   000015 116000 21                 CMPQ    13
        20 003345   003375 600000 20                 TZE     s:10098

  10085 20 003346   200103 220100                    LDX0    USE_ENTRY$,,AUTO
        20 003347   000015 631400 21                 EPPR1   13
        20 003350   000000 701010                    TSX1    0,X0
        20 003351   000000 011000                    NOP     0

  10086 20 003352   003375 710000 20                 TRA     s:10098

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:156  
  10088 20 003353   200102 476500                    LDP6    USE$$,,AUTO
        20 003354   600017 236100                    LDQ     15,,PR6
        20 003355   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10089 20 003356   000015 116000 21                 CMPQ    13
        20 003357   003364 600000 20                 TZE     s:10091

  10090 20 003360   200103 223100                    LDX3    USE_ENTRY$,,AUTO
        20 003361   000015 631400 21                 EPPR1   13
        20 003362   000000 701013                    TSX1    0,X3
        20 003363   000000 011000                    NOP     0

  10091 20 003364   200102 470500                    LDP0    USE$$,,AUTO
        20 003365   000014 236100                    LDQ     12,,PR0
        20 003366   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10092 20 003367   000015 116000 21                 CMPQ    13
        20 003370   003375 600000 20                 TZE     s:10098

  10093 20 003371   200103 220100                    LDX0    USE_ENTRY$,,AUTO
        20 003372   000015 631400 21                 EPPR1   13
        20 003373   000000 701010                    TSX1    0,X0
        20 003374   000000 011000                    NOP     0

  10098 20 003375   200003 470500                    LDP0    @FAB,,AUTO
        20 003376   000032 236100                    LDQ     26,,PR0
        20 003377   000100 316003                    CANQ    64,DU
        20 003400   003413 600000 20                 TZE     s:10102

  10099 20 003401   000060 236000 21                 LDQ     48
        20 003402   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 003403   000061 236000 21                 LDQ     49
        20 003404   200003 235100                    LDA     @FAB,,AUTO
        20 003405   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 003406   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 003407   000001 631400 21                 EPPR1   1
        20 003410   000000 701000 xent               TSX1    X9WU$WRITE_USER_LABEL
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:157  
        20 003411   000000 011000                    NOP     0
        20 003412   003415 710000 20                 TRA     s:10103

  10102 20 003413   000046 237000 21                 LDAQ    38
        20 003414   000050 757000 19                 STAQ    CLOSE_VOLUME+4

  10103 20 003415   200003 470500                    LDP0    @FAB,,AUTO
        20 003416   000032 236100                    LDQ     26,,PR0
        20 003417   000020 316003                    CANQ    16,DU
        20 003420   003433 600000 20                 TZE     s:10107

  10104 20 003421   000063 236000 21                 LDQ     51
        20 003422   200230 756100                    STQ     FIRST_PAGE+9,,AUTO
        20 003423   000064 236000 21                 LDQ     52
        20 003424   200003 235100                    LDA     @FAB,,AUTO
        20 003425   200226 757100                    STAQ    FIRST_PAGE+7,,AUTO
        20 003426   200226 630500                    EPPR0   FIRST_PAGE+7,,AUTO
        20 003427   000001 631400 21                 EPPR1   1
        20 003430   000000 701000 xent               TSX1    X9WU$WRITE_USER_LABEL
        20 003431   000000 011000                    NOP     0
        20 003432   003435 710000 20                 TRA     s:10108

  10107 20 003433   000046 237000 21                 LDAQ    38
        20 003434   000046 757000 19                 STAQ    CLOSE_VOLUME+2

  10108 20 003435   000044 630400 19                 EPPR0   CLOSE_VOLUME
        20 003436   450004 713400                    CLIMB   alt,+20484
        20 003437   401000 401760                    pmme    nvectors=3
        20 003440   003442 702000 20                 TSX2    s:10111
        20 003441   003450 710000 20                 TRA     s:10116

  10111 20 003442   200003 630500                    EPPR0   @FAB,,AUTO
        20 003443   000000 631400 21                 EPPR1   0
        20 003444   000000 701000 xent               TSX1    X9WE$IO_ERROR
        20 003445   000000 011000                    NOP     0

  10112 20 003446   200224 221300                    LDX1  ! FIRST_PAGE+5,,AUTO
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:158  
        20 003447   000001 702211                    TSX2  ! 1,X1

  10116 20 003450   200003 470500                    LDP0    @FAB,,AUTO
        20 003451   000040 236100                    LDQ     32,,PR0
        20 003452   000032 116000 21                 CMPQ    26
        20 003453   003570 600000 20                 TZE     s:10151

  10118 20 003454   200102 756100                    STQ     USE$$,,AUTO

  10119 20 003455   000007 471400 21                 LDP1    7
        20 003456   100000 473500                    LDP3    0,,PR1
        20 003457   000034 220100                    LDX0    28,,PR0
        20 003460   300000 236110                    LDQ     0,X0,PR3
        20 003461   200101 756100                    STQ     DCB$,,AUTO

  10120 20 003462   200101 474500                    LDP4    DCB$,,AUTO
        20 003463   400032 221100                    LDX1    26,,PR4
        20 003464   000777 361003                    ANX1    511,DU
        20 003465   000004 101003                    CMPX1   4,DU
        20 003466   003470 602011 20                 TNC     s:10120+6,X1
        20 003467   003570 710000 20                 TRA     s:10151
        20 003470   003570 710000 20                 TRA     s:10151
        20 003471   003570 710000 20                 TRA     s:10151
        20 003472   003546 710000 20                 TRA     s:10141
        20 003473   003474 710000 20                 TRA     s:10122

  10122 20 003474   400031 236100                    LDQ     25,,PR4
        20 003475   003000 376007                    ANQ     1536,DL
        20 003476   002000 116007                    CMPQ    1024,DL
        20 003477   003523 601000 20                 TNZ     s:10133

  10124 20 003500   200102 475500                    LDP5    USE$$,,AUTO
        20 003501   500027 236100                    LDQ     23,,PR5
        20 003502   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10125 20 003503   000015 116000 21                 CMPQ    13
        20 003504   003511 600000 20                 TZE     s:10127
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:159  

  10126 20 003505   200103 222100                    LDX2    USE_ENTRY$,,AUTO
        20 003506   000015 631400 21                 EPPR1   13
        20 003507   000000 701012                    TSX1    0,X2
        20 003510   000000 011000                    NOP     0

  10127 20 003511   200102 470500                    LDP0    USE$$,,AUTO
        20 003512   000024 236100                    LDQ     20,,PR0
        20 003513   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10128 20 003514   000015 116000 21                 CMPQ    13
        20 003515   003570 600000 20                 TZE     s:10151

  10129 20 003516   200103 220100                    LDX0    USE_ENTRY$,,AUTO
        20 003517   000015 631400 21                 EPPR1   13
        20 003520   000000 701010                    TSX1    0,X0
        20 003521   000000 011000                    NOP     0

  10130 20 003522   003570 710000 20                 TRA     s:10151

  10133 20 003523   200102 475500                    LDP5    USE$$,,AUTO
        20 003524   500026 236100                    LDQ     22,,PR5
        20 003525   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10134 20 003526   000015 116000 21                 CMPQ    13
        20 003527   003534 600000 20                 TZE     s:10136

  10135 20 003530   200103 222100                    LDX2    USE_ENTRY$,,AUTO
        20 003531   000015 631400 21                 EPPR1   13
        20 003532   000000 701012                    TSX1    0,X2
        20 003533   000000 011000                    NOP     0

  10136 20 003534   200102 470500                    LDP0    USE$$,,AUTO
        20 003535   000023 236100                    LDQ     19,,PR0
        20 003536   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10137 20 003537   000015 116000 21                 CMPQ    13
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:160  
        20 003540   003570 600000 20                 TZE     s:10151

  10138 20 003541   200103 220100                    LDX0    USE_ENTRY$,,AUTO
        20 003542   000015 631400 21                 EPPR1   13
        20 003543   000000 701010                    TSX1    0,X0
        20 003544   000000 011000                    NOP     0

  10139 20 003545   003570 710000 20                 TRA     s:10151

  10141 20 003546   200102 475500                    LDP5    USE$$,,AUTO
        20 003547   500025 236100                    LDQ     21,,PR5
        20 003550   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10142 20 003551   000015 116000 21                 CMPQ    13
        20 003552   003557 600000 20                 TZE     s:10144

  10143 20 003553   200103 222100                    LDX2    USE_ENTRY$,,AUTO
        20 003554   000015 631400 21                 EPPR1   13
        20 003555   000000 701012                    TSX1    0,X2
        20 003556   000000 011000                    NOP     0

  10144 20 003557   200102 470500                    LDP0    USE$$,,AUTO
        20 003560   000022 236100                    LDQ     18,,PR0
        20 003561   200103 756100                    STQ     USE_ENTRY$,,AUTO

  10145 20 003562   000015 116000 21                 CMPQ    13
        20 003563   003570 600000 20                 TZE     s:10151

  10146 20 003564   200103 220100                    LDX0    USE_ENTRY$,,AUTO
        20 003565   000015 631400 21                 EPPR1   13
        20 003566   000000 701010                    TSX1    0,X0
        20 003567   000000 011000                    NOP     0

  10151 20 003570   000014 630400 19                 EPPR0   WRITE_SEQ
        20 003571   440001 713400                    CLIMB   alt,write
        20 003572   401400 401760                    pmme    nvectors=4
        20 003573   003575 702000 20                 TSX2    s:10154
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:161  
        20 003574   003610 710000 20                 TRA     s:10163

  10154 20 003575   200003 630500                    EPPR0   @FAB,,AUTO
        20 003576   000025 631400 21                 EPPR1   21
        20 003577   000000 701000 xent               TSX1    X9WE$IO_ERROR
        20 003600   003602 702000 20                 TSX2    s:10157
        20 003601   003610 710000 20                 TRA     s:10163

  10157 20 003602   200003 470500                    LDP0    @FAB,,AUTO
        20 003603   000002 235100                    LDA     2,,PR0
        20 003604   000001 115007                    CMPA    1,DL
        20 003605   003610 600000 20                 TZE     s:10163

  10158 20 003606   200224 221300                    LDX1  ! FIRST_PAGE+5,,AUTO
        20 003607   000000 702211                    TSX2  ! 0,X1

      929    10163    5                      END;

  10163 20 003610   003617 710000 20                 TRA     s:10170

      930    10164    4                    ELSE
      931    10165    4                      IF FAB.ORG# ~= %CP6_SEQUENTIAL THEN

  10165 20 003611   200003 473500                    LDP3    @FAB,,AUTO
        20 003612   300002 235100                    LDA     2,,PR3
        20 003613   000001 115007                    CMPA    1,DL
        20 003614   003617 600000 20                 TZE     s:10170

      932    10166    4                        ALTRETURN;

  10166 20 003615   200224 221300                    LDX1  ! FIRST_PAGE+5,,AUTO
        20 003616   000000 702211                    TSX2  ! 0,X1

      933    10167    4                  END;
      934    10168    3             END;

      935    10169
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:162  
      936    10170    2     END WRITE;   /*  proc  */

  10170 20 003617   200224 221300                    LDX1  ! FIRST_PAGE+5,,AUTO
        20 003620   000001 702211                    TSX2  ! 1,X1

      937    10171        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:163  
      938    10172        /*---------*/
      939    10173    1       VOLSWAP: PROC;

  10173 20 003621   200220 741300       VOLSWAP      STX1  ! FIRST_PAGE+1,,AUTO

      940    10174        /*---------*/
      941    10175
      942    10176            %FPT_CVOL     (FPTN=FPT_CVOL);
      943    10191
      944    10192        /*N*          Assume there are no user labels for now.
      945    10193        */
      946    10194
      947    10195    2       FPT_CVOL.V.DCB# = FAB.DCB_NUM;

  10195 20 003622   200003 470500                    LDP0    @FAB,,AUTO
        20 003623   000034 220100                    LDX0    28,,PR0
        20 003624   000062 740000 19                 STX0    FPT_CVOL+6

      948    10196    2       FPT_CVOL.UTL_ = VECTOR(NIL);

  10196 20 003625   000046 237000 21                 LDAQ    38
        20 003626   000056 757000 19                 STAQ    FPT_CVOL+2

      949    10197    2       FPT_CVOL.UHL_ = VECTOR(NIL);

  10197 20 003627   000046 237000 21                 LDAQ    38
        20 003630   000060 757000 19                 STAQ    FPT_CVOL+4

      950    10198    2       CALL M$CVOL (FPT_CVOL);

  10198 20 003631   000054 630400 19                 EPPR0   FPT_CVOL
        20 003632   050004 713400                    CLIMB   20484
        20 003633   401000 401760                    pmme    nvectors=3

      951    10199
      952    10200    2     END VOLSWAP;  /* proc */

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:164  
  10200 20 003634   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 003635   000001 702211                    TSX2  ! 1,X1

      953    10201        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:165  
      954    10202        /*----------------*/
      955    10203    1       BOUNDARY_CHECK:    PROC   ALTRET;

  10203 20 003636   200220 741300       BOUNDARY_CH* STX1  ! FIRST_PAGE+1,,AUTO

      956    10204        /*----------------*/
      957    10205
      958    10206        /*V*            Boundary_Violation_Check
      959    10207
      960    10208                If the current record length is larger than the largest
      961    10209                record decription entry for the file or smaller than the
      962    10210                smallest record allowed by the RECORD IS VARYING clause
      963    10211                for the file, then a boundary violation exists.
      964    10212        */
      965    10213
      966    10214    2       IF REC_LEN < FAB.MIN_REC_LEN

  10214 20 003637   200005 470500                    LDP0    @REC_LEN,,AUTO
        20 003640   200003 471500                    LDP1    @FAB,,AUTO
        20 003641   000000 236100                    LDQ     0,,PR0
        20 003642   100007 116100                    CMPQ    7,,PR1
        20 003643   003646 604000 20                 TMI     s:10217
        20 003644   100010 116100                    CMPQ    8,,PR1
        20 003645   003660 604400 20                 TMOZ    s:10222

      967    10215    2       OR REC_LEN > FAB.MAX_REC_LEN  THEN
      968    10216    3         DO;

      969    10217    3           IO_STATUS = %BOUNDARY_VIOLATION;

  10217 20 003646   100036 473500                    LDP3    30,,PR1
        20 003647   040100 100400                    MLR     fill='040'O
        20 003650   000035 000002 18                 ADSC9   PRE_SLEW+12              cn=0,n=2
        20 003651   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2

      970    10218    3           CALL X9WE$IO_ERROR_STATUS (FAB);

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:166  
  10218 20 003652   200003 630500                    EPPR0   @FAB,,AUTO
        20 003653   000000 631400 21                 EPPR1   0
        20 003654   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
        20 003655   000000 011000                    NOP     0

      971    10219    3           ALTRETURN;

  10219 20 003656   200220 221300                    LDX1  ! FIRST_PAGE+1,,AUTO
        20 003657   000000 702211                    TSX2  ! 0,X1

      972    10220    3         END;
      973    10221
      974    10222    2       END BOUNDARY_CHECK;  /* check */

  10222 20 003660   000001 702211                    TSX2  ! 1,X1
      975    10223
      976    10224
      977    10225    1   END X9WW$WRITE_RAND;  /* proc */
      978    10226        %eject;
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:167  
      979    10227        %EOD;

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:168  
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   X8A_MACROS.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X8A_LIBCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
   B_ERRORS_C.:LIB_E04  is referenced.
      No diagnostics issued in procedure X9WW$WRITE_RAND.
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:169  

 **** Variables and constants ****

  ****  Section 001 LblCom LIBCOM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(720)   r     1 LIBCOM

  ****  Section 002 LblCom DEC_OR_COMMA

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 DEC_OR_COMMA

  ****  Section 003 LblCom IN_TEMP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)          1 IN_TEMP

  ****  Section 004 LblCom OVRCHR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 OVRCHR

  ****  Section 005 LblCom SELECT_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 SELECT_TIME

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:170  
  ****  Section 006 LblCom NO_ADVANCE_OFFSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 NO_ADVANCE_OFFSET

  ****  Section 007 LblCom DSPLY_SAVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)          1 DSPLY_SAVE

  ****  Section 008 LblCom D_DATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(10)          1 D_DATE

  ****  Section 009 LblCom D_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(11)          1 D_TIME

  ****  Section 010 LblCom D_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(3)           1 D_DAY

  ****  Section 011 LblCom C_DATE

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:171  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)           1 C_DATE

  ****  Section 012 LblCom C_TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)           1 C_TIME

  ****  Section 013 LblCom C_DAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(5)           1 C_DAY

  ****  Section 014 LblCom RTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 RTHOLD2

  ****  Section 015 LblCom LTHOLD2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 LTHOLD2

  ****  Section 016 LblCom NDX2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:172  

     0-0-0/w SBIN              1 NDX2

  ****  Section 017 LblCom IN_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 IN_LEN

  ****  Section 018 RoData X9WW$WRITE_RAND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AFTER_ADV(0:15)
    10-0-0/c CHAR        r     1 AFTER_CHN(0:15)
     4-0-0/c CHAR        r     1 BEFORE_ADV(0:15)
    14-0-0/c CHAR        r     1 BEFORE_CHN(0:15)
    20-0-0/c CHAR        r     1 POST_SLEW                 21-0-0/c CHAR        r     1 PRE_SLEW

  ****  Section 019  Data  X9WW$WRITE_RAND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    44-0-0/d STRC(288)   r     1 CLOSE_VOLUME              54-0-0/d STRC(288)   r     1 FPT_CVOL
    30-0-0/d STRC(432)   r     1 REWRITE_REC                0-0-0/d STRC(432)   r     1 WRITE_RAND
    14-0-0/d STRC(432)   r     1 WRITE_SEQ

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @ADV_CHAR                  6-0-0/w PTR         r     1 @ADV_CODE
     4-0-0/w PTR         r     1 @ALT_RET                   3-0-0/w PTR         r     1 @FAB
PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:173  
     5-0-0/w PTR         r     1 @REC_LEN                  *0-0-0/w STRC        r     1 ADV_CHAR
    *0-0-0/w SBIN        r     1 ADV_CODE                 210-0-0/w SBIN        r     1 ALT_LENGTH
   207-0-0/w SBIN        r     1 ALT_OFFSET                *0-0-0/w BIT         r     1 ALT_RET
   101-0-0/w PTR         r     1 DCB$                      *0-0-0/d STRC(2232)  r     1 FAB
   217-0-0/w BIT         r     1 FIRST_PAGE               105-0-0/w PTR               1 INDEX_KEY$
   215-0-0/w UBIN              1 KEY                      106-0-0/w STRC(2304)  r     1 KEYED_KEY
    10-0-0/w SBIN              1 LT                        11-0-0/c CHAR(65)          1 LTHOLD
    53-0-0/w SBIN              1 NDX                       54-0-0/w SBIN              1 NDX3
    *0-0-0/w SBIN        r     1 REC_LEN                  104-0-0/w UBIN        r     1 RELATIVE_KEY
    32-0-0/c CHAR(65)          1 RTHOLD                   212-0-0/d BIT (72)    r     1 SAVE_VECTOR
   206-0-0/w STRC        r     1 SLEW_CHAR                 55-0-0/c CHAR(80)    r     1 SPECIAL_ERR_MSG
   214-0-0/w SBIN        r     1 TEMP                     211-0-0/c CHAR        r     1 TOP_SLEW
   102-0-0/w PTR         r     1 USE$$                    103-0-0/w EPTR        r     1 USE_ENTRY$
   216-0-0/w PTR         r     1 VFC$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(72)    r     1 ALT_KEYS                   0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ACHR        r     1 INDEX_KEY
     0-0-0/c CHAR(2)     r     1 IO_STATUS                  0-0-0/c ACHR        r     1 KEY_TEXT
     0-0-0/w SBIN        r     1 LINAGE_COUNTER             0-0-0N  NULL        r     1 M$UC
     0-0-0/d ASTR(3528)  r     1 M$XX                       0-0-0/c ACHR              1 OLD_INDEX_KEY
     0-0-0/d ASTR(0)     r     1 RDB                        0-0-0/c ASTR(9)     r     1 RDB_VFC
     0-0-0/w STRC(2448)  r     1 SHARED                     0-0-0/w STRC(864)   r     1 USE_PROC
     0-0-0/c CHAR        r     1 VFC

PL6.E3A0      #001=X9WW$WRITE_RAND File=X9WW.:X8A6TSI                            SAT 08/09/97 11:12 Page:174  

   Procedure X9WW$WRITE_RAND requires 1969 words for executable code.
   Procedure X9WW$WRITE_RAND requires 154 words of local(AUTO) storage.

PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:175  
      980        1        /*M* X9WW$WRITE_PAGE --  Supports the terminate statement           */
      981        2        /*T***********************************************************/
      982        3        /*T*                                                         */
      983        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      984        5        /*T*                                                         */
      985        6        /*T***********************************************************/
      986        7        /*P*
      987        8             NAME: X9WW$WRITE_PAGE
      988        9             PURPOSE:
      989       10                   To advance to top of page unless already there.
      990       11
      991       12        */
      992       13
      993       14        /*---------------*/
      994       15          X9WW$WRITE_PAGE:     PROC (FAB);
      995       16        /*---------------*/
      996       17
      997       18            %INCLUDE X8A_SYS_FILE;
      998     6288            %INCLUDE X8A_ERRCOM;
      999     6377            %INCLUDE X9A_FAB;
     1000     6564            %INCLUDE X9A_LIB_IO;
     1001     6948
     1002     6949            %DCL_FAB;
     1003     7071
     1004     7072
     1005     7073    1       DCL REPORT_CODE    CHAR(2) BASED (FAB.BUFFER$);
     1006     7074    1       DCL BUFFER         CHAR(3);
     1007     7075
     1008     7076    1       DCL X8ER$ERROR     ENTRY (3);
     1009     7077    1       DCL X9WE$IO_ERROR  ENTRY (2) ALTRET;
     1010     7078    1       DCL XSA$WRITE      ENTRY (2) ALTRET;
     1011     7079
     1012     7080            %FPT_DEVICE       (FPTN=WRITE_PAGE, PAGE=YES);
     1013     7098            %FPT_WRITE        (FPTN=WRITE_VFC, VFC=YES);
     1014     7129        %eject;
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:176  
     1015     7130    1       DCB$ = DCBADDR (FAB.DCB_NUM);
     1016     7131    1       IF M$XX.DDEV.LP# THEN
     1017     7132    2         DO;
     1018     7133    2           WRITE_PAGE.V.DCB# = FAB.DCB_NUM;
     1019     7134    2           CALL M$DEVICE (WRITE_PAGE)
     1020     7135    2             WHENALTRETURN
     1021     7136    3               DO;
     1022     7137    3                 CALL X9WE$IO_ERROR (FAB, %NO#);
     1023     7138    3                 CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$WRITE_PAGE', 15);
     1024     7139    3               END;
     1025     7140    2         END;
     1026     7141    1       ELSE
     1027     7142    2         DO;
     1028     7143    2           WRITE_VFC.V.DCB# = FAB.DCB_NUM;
     1029     7144    2           CALL CONCAT (BUFFER, 'P', REPORT_CODE);
     1030     7145    2           WRITE_VFC.BUF_ = VECTOR (BUFFER);
     1031     7146    2           IF FAB.B.FAST_SEQUENTIAL THEN
     1032     7147    2             CALL XSA$WRITE (WRITE_VFC, FAB.XSA)
     1033     7148    2               WHENALTRETURN
     1034     7149    3                 DO;
     1035     7150    3                   CALL X9WE$IO_ERROR (FAB, %NO#);
     1036     7151    3                   CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$WRITE_PAGE', 15);
     1037     7152    3                 END;
     1038     7153    2            ELSE
     1039     7154    2              CALL M$WRITE (WRITE_VFC)
     1040     7155    2                WHENALTRETURN
     1041     7156    3                  DO;
     1042     7157    3                    CALL X9WE$IO_ERROR (FAB, %NO#);
     1043     7158    3                    CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$WRITE_PAGE', 15);
     1044     7159    3                  END;
     1045     7160    2          END;
     1046     7161
     1047     7162    1   END X9WW$WRITE_PAGE;  /* proc */
     1048     7163        %eject;
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:177  

PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:178  
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
      No diagnostics issued in procedure X9WW$WRITE_PAGE.

   Procedure X9WW$WRITE_PAGE requires 84 words for executable code.
   Procedure X9WW$WRITE_PAGE requires 30 words of local(AUTO) storage.

    No errors detected in file X9WW.:X8A6TSI    .

PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:179  

 Object Unit name= X9WW$WRITE_PAGE                            File name= X9WW.:X8A6TOU
 UTS= AUG 09 '97 11:16:42.16 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    22     26  X9WW$WRITE_PAGE
    2  RoData even  UTS      4      4  X9WW$WRITE_PAGE
    3   Proc  even  none    84    124  X9WW$WRITE_PAGE
    4  RoData even  none    11     13  X9WW$WRITE_PAGE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  X9WW$WRITE_PAGE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 X9WE$IO_ERROR
         yes           Std       3 X8ER$ERROR
 yes     yes           Std       2 XSA$WRITE
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:180  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:181  


      980        1        /*M* X9WW$WRITE_PAGE --  Supports the terminate statement           */
      981        2        /*T***********************************************************/
      982        3        /*T*                                                         */
      983        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      984        5        /*T*                                                         */
      985        6        /*T***********************************************************/
      986        7        /*P*
      987        8             NAME: X9WW$WRITE_PAGE
      988        9             PURPOSE:
      989       10                   To advance to top of page unless already there.
      990       11
      991       12        */
      992       13
      993       14        /*---------------*/
      994       15          X9WW$WRITE_PAGE:     PROC (FAB);

     15  3 000000   000000 700200 xent  X9WW$WRITE_* TSX0  ! X66_AUTO_1
         3 000001   000036 000001                    ZERO    30,1

      995       16        /*---------------*/
      996       17
      997       18            %INCLUDE X8A_SYS_FILE;
      998     6288            %INCLUDE X8A_ERRCOM;
      999     6377            %INCLUDE X9A_FAB;
     1000     6564            %INCLUDE X9A_LIB_IO;
     1001     6948
     1002     6949            %DCL_FAB;
     1003     7071
     1004     7072
     1005     7073    1       DCL REPORT_CODE    CHAR(2) BASED (FAB.BUFFER$);
     1006     7074    1       DCL BUFFER         CHAR(3);
     1007     7075
     1008     7076    1       DCL X8ER$ERROR     ENTRY (3);
     1009     7077    1       DCL X9WE$IO_ERROR  ENTRY (2) ALTRET;
     1010     7078    1       DCL XSA$WRITE      ENTRY (2) ALTRET;
     1011     7079
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:182  
     1012     7080            %FPT_DEVICE       (FPTN=WRITE_PAGE, PAGE=YES);
     1013     7098            %FPT_WRITE        (FPTN=WRITE_VFC, VFC=YES);
     1014     7129        %eject;
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:183  
     1015     7130    1       DCB$ = DCBADDR (FAB.DCB_NUM);

   7130  3 000002   000000 470400 4                  LDP0    0
         3 000003   000000 471500                    LDP1    0,,PR0
         3 000004   200003 473500                    LDP3    @FAB,,AUTO
         3 000005   300034 220100                    LDX0    28,,PR3
         3 000006   100000 236110                    LDQ     0,X0,PR1
         3 000007   200030 756100                    STQ     DCB$,,AUTO

     1016     7131    1       IF M$XX.DDEV.LP# THEN

   7131  3 000010   200030 474500                    LDP4    DCB$,,AUTO
         3 000011   400004 236100                    LDQ     4,,PR4
         3 000012   400000 316007                    CANQ    -131072,DL
         3 000013   000036 600000 3                  TZE     s:7143

     1017     7132    2         DO;

     1018     7133    2           WRITE_PAGE.V.DCB# = FAB.DCB_NUM;

   7133  3 000014   000006 740000 1                  STX0    WRITE_PAGE+6

     1019     7134    2           CALL M$DEVICE (WRITE_PAGE)

   7134  3 000015   000000 630400 1                  EPPR0   WRITE_PAGE
         3 000016   450006 713400                    CLIMB   alt,+20486
         3 000017   401000 401760                    pmme    nvectors=3
         3 000020   000022 702000 3                  TSX2    s:7137
         3 000021   000035 710000 3                  TRA     s:7140

     1020     7135    2             WHENALTRETURN
     1021     7136    3               DO;

     1022     7137    3                 CALL X9WE$IO_ERROR (FAB, %NO#);

   7137  3 000022   000003 236000 4                  LDQ     3
         3 000023   200003 235100                    LDA     @FAB,,AUTO
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:184  
         3 000024   200034 757100                    STAQ    BUFFER+1,,AUTO
         3 000025   200034 630500                    EPPR0   BUFFER+1,,AUTO
         3 000026   000001 631400 4                  EPPR1   1
         3 000027   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000030   000000 011000                    NOP     0

     1023     7138    3                 CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$WRITE_PAGE', 15);

   7138  3 000031   000007 630400 4                  EPPR0   7
         3 000032   000004 631400 4                  EPPR1   4
         3 000033   000000 701000 xent               TSX1    X8ER$ERROR
         3 000034   000000 011000                    NOP     0

     1024     7139    3               END;

     1025     7140    2         END;

   7140  3 000035   000123 710000 3                  TRA     s:7162

     1026     7141    1       ELSE
     1027     7142    2         DO;

     1028     7143    2           WRITE_VFC.V.DCB# = FAB.DCB_NUM;

   7143  3 000036   000022 740000 1                  STX0    WRITE_VFC+8

     1029     7144    2           CALL CONCAT (BUFFER, 'P', REPORT_CODE);

   7144  3 000037   300052 475500                    LDP5    42,,PR3
         3 000040   120000 236003                    LDQ     40960,DU
         3 000041   200033 756100                    STQ     BUFFER,,AUTO
         3 000042   040100 100500                    MLR     fill='040'O
         3 000043   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2
         3 000044   200033 200002                    ADSC9   BUFFER,,AUTO             cn=1,n=2

     1030     7145    2           WRITE_VFC.BUF_ = VECTOR (BUFFER);

PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:185  
   7145  3 000045   577640 235007                    LDA     -65632,DL
         3 000046   200034 452500                    STP2    BUFFER+1,,AUTO
         3 000047   200034 236100                    LDQ     BUFFER+1,,AUTO
         3 000050   000033 036003                    ADLQ    27,DU
         3 000051   000016 757000 1                  STAQ    WRITE_VFC+4

     1031     7146    2           IF FAB.B.FAST_SEQUENTIAL THEN

   7146  3 000052   200003 470500                    LDP0    @FAB,,AUTO
         3 000053   000032 236100                    LDQ     26,,PR0
         3 000054   000004 316003                    CANQ    4,DU
         3 000055   000103 600000 3                  TZE     s:7154

     1032     7147    2             CALL XSA$WRITE (WRITE_VFC, FAB.XSA)

   7147  3 000056   200003 236100                    LDQ     @FAB,,AUTO
         3 000057   000060 036003                    ADLQ    48,DU
         3 000060   000012 235000 4                  LDA     10
         3 000061   200034 757100                    STAQ    BUFFER+1,,AUTO
         3 000062   200034 630500                    EPPR0   BUFFER+1,,AUTO
         3 000063   000001 631400 4                  EPPR1   1
         3 000064   000000 701000 xent               TSX1    XSA$WRITE
         3 000065   000067 702000 3                  TSX2    s:7150
         3 000066   000102 710000 3                  TRA     s:7152

     1033     7148    2               WHENALTRETURN
     1034     7149    3                 DO;

     1035     7150    3                   CALL X9WE$IO_ERROR (FAB, %NO#);

   7150  3 000067   000003 236000 4                  LDQ     3
         3 000070   200003 235100                    LDA     @FAB,,AUTO
         3 000071   200034 757100                    STAQ    BUFFER+1,,AUTO
         3 000072   200034 630500                    EPPR0   BUFFER+1,,AUTO
         3 000073   000001 631400 4                  EPPR1   1
         3 000074   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000075   000000 011000                    NOP     0
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:186  

     1036     7151    3                   CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$WRITE_PAGE', 15);

   7151  3 000076   000007 630400 4                  EPPR0   7
         3 000077   000004 631400 4                  EPPR1   4
         3 000100   000000 701000 xent               TSX1    X8ER$ERROR
         3 000101   000000 011000                    NOP     0

     1037     7152    3                 END;

   7152  3 000102   000123 710000 3                  TRA     s:7162

     1038     7153    2            ELSE
     1039     7154    2              CALL M$WRITE (WRITE_VFC)

   7154  3 000103   000012 630400 1                  EPPR0   WRITE_VFC
         3 000104   440001 713400                    CLIMB   alt,write
         3 000105   401400 401760                    pmme    nvectors=4
         3 000106   000110 702000 3                  TSX2    s:7157
         3 000107   000123 710000 3                  TRA     s:7162

     1040     7155    2                WHENALTRETURN
     1041     7156    3                  DO;

     1042     7157    3                    CALL X9WE$IO_ERROR (FAB, %NO#);

   7157  3 000110   000003 236000 4                  LDQ     3
         3 000111   200003 235100                    LDA     @FAB,,AUTO
         3 000112   200034 757100                    STAQ    BUFFER+1,,AUTO
         3 000113   200034 630500                    EPPR0   BUFFER+1,,AUTO
         3 000114   000001 631400 4                  EPPR1   1
         3 000115   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000116   000000 011000                    NOP     0

     1043     7158    3                    CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WW$WRITE_PAGE', 15);

   7158  3 000117   000007 630400 4                  EPPR0   7
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:187  
         3 000120   000004 631400 4                  EPPR1   4
         3 000121   000000 701000 xent               TSX1    X8ER$ERROR
         3 000122   000000 011000                    NOP     0

     1044     7159    3                  END;

     1045     7160    2          END;

     1046     7161
     1047     7162    1   END X9WW$WRITE_PAGE;  /* proc */

   7162  3 000123   000000 702200 xent               TSX2  ! X66_ARET
     1048     7163        %eject;
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:188  

PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:189  
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
      No diagnostics issued in procedure X9WW$WRITE_PAGE.
PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:190  

 **** Variables and constants ****

  ****  Section 001  Data  X9WW$WRITE_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(360)   r     1 WRITE_PAGE                12-0-0/d STRC(432)   r     1 WRITE_VFC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FAB                      33-0-0/c CHAR(3)     r     1 BUFFER
    30-0-0/w PTR         r     1 DCB$                      *0-0-0/d STRC(2232)  r     1 FAB
     4-0-0/c CHAR(80)          1 SPECIAL_ERR_MSG           31-0-0/w PTR         r     1 USE$$
    32-0-0/w EPTR        r     1 USE_ENTRY$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)        1 B$ALT                      0-0-0/w STRC(144)         1 B$TCB
     0-0-0N  NULL        r     1 M$UC                       0-0-0/d ASTR(3528)  r     1 M$XX
     0-0-0/c CHAR(2)     r     1 REPORT_CODE                0-0-0/w STRC(864)         1 USE_PROC

PL6.E3A0      #002=X9WW$WRITE_PAGE File=X9WW.:X8A6TSI                            SAT 08/09/97 11:16 Page:191  

   Procedure X9WW$WRITE_PAGE requires 84 words for executable code.
   Procedure X9WW$WRITE_PAGE requires 30 words of local(AUTO) storage.

    No errors detected in file X9WW.:X8A6TSI    .
