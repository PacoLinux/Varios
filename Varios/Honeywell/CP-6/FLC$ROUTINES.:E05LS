VERSION E05

PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:1    
        1        1        /*M* FLC$ROUTINES - EFT tape input routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8
        9        9        FLC$TAPE_IO_INIT: PROC;
       10       10        /*F* NAME: FLC$TAPE_IO_INIT
       11       11             PURPOSE: Initialize for opening tape files.
       12       12        */
       13       13
       14       14        /***
       15       15         *** INCLUDE
       16       16         ***/
       17       17
       18       18        %INCLUDE CP_6;
       19     5577        %INCLUDE CP_6_SUBS;
       20     6117        %INCLUDE FLI_DATA_R;
       21     7531        %INCLUDE FLS_DATA_R;
       22     9331
       23     9332        /***
       24     9333         *** ENTRY
       25     9334         ***/
       26     9335
       27     9336    1   DCL FLI$ALLOC_BUF ENTRY(2);
       28     9337
       29     9338        /***
       30     9339         *** DCB
       31     9340         ***/
       32     9341
       33     9342    1   DCL M$TAPE00 DCB;
       34     9343
       35     9344        /***
       36     9345         *** SYMREF
       37     9346         ***/
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:2    
       38     9347
       39     9348    1   DCL BREAK_DCB# SBIN SYMREF;
       40     9349
       41     9350        /****************************************/
       42     9351
       43     9352        /***
       44     9353         *** Get FIT buffer and buffer for reading tape.  The tape buffer
       45     9354         *** must be the last buffer obtained since it may be expanded by
       46     9355         *** later calls to FLI$ALLOC_BUF to accomodate buffers larger than
       47     9356         *** originally expected.
       48     9357         ***/
       49     9358
       50     9359    1      CALL FLI$ALLOC_BUF( FIT_, 1 );       /* Get FIT buffer                     */
       51     9360
       52     9361    1      CALL FLI$ALLOC_BUF( TAPE_BLOCK_, 4 ); /* Get initial tape buffer           */
       53     9362    1      TAPE_BLOCK_SIZE = 4096 * 4;
       54     9363
       55     9364        /***
       56     9365         *** Ready all tape FPTs.
       57     9366         ***/
       58     9367
       59     9368    1      BREAK_DCB# = DCBNUM(M$TAPE00);
       60     9369
       61     9370    1      TAPE_OPEN.V.DCB# = BREAK_DCB#;
       62     9371    1      TAPE_READ.V.DCB# = BREAK_DCB#;
       63     9372    1      TAPE_CLOSE.V.DCB# = BREAK_DCB#;
       64     9373
       65     9374    1      TAPE_OPEN.V.OPER.NXTF# = %YES#;
       66     9375        /*N*   TAPE_OPEN.FPARAM_ = FIT_; */
       67     9376
       68     9377    1      TAPE_CLOSE.UTL_ = VECTOR(CVOL_UTL);
       69     9378
       70     9379    1      M$TAPE00$ = DCBADDR(BREAK_DCB#);
       71     9380
       72     9381        /***
       73     9382         *** NXTF is always set.  If there's a particular FSN we want to
       74     9383         *** get to, we must set THISF to get there.
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:3    
       75     9384         ***/
       76     9385
       77     9386    1      IF TAPE_OPEN.V.FSN# = 0
       78     9387    1       THEN TAPE_OPEN.V.OPER.THISF# = %NO#;
       79     9388    1       ELSE TAPE_OPEN.V.OPER.THISF# = %YES#;
       80     9389
       81     9390    1      IF TAPE_OPTION.IOERRORC /* Set IOERROK# if continuation after read error   */
       82     9391    1       THEN TAPE_READ.V.IOERROK# = '1'B;
       83     9392    1       ELSE TAPE_READ.V.IOERROK# = '0'B;
       84     9393
       85     9394        /***
       86     9395         *** Initialize other flags and indices.
       87     9396         ***/
       88     9397
       89     9398    1      FILE_FIN = '1'B;
       90     9399    1      CROSSED = ' ';
       91     9400
       92     9401    1      DPLISTX = 0;
       93     9402    1      SPECX = 0;
       94     9403
       95     9404    1      TAPE_BAD = '0'B;
       96     9405
       97     9406    1      RETURN;
       98     9407
       99     9408    1   END FLC$TAPE_IO_INIT;
      100     9409        %EOD;

PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:4    
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$TAPE_IO_INIT.

   Procedure FLC$TAPE_IO_INIT requires 50 words for executable code.
   Procedure FLC$TAPE_IO_INIT requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:5    

 Object Unit name= FLC$TAPE_IO_INIT                           File name= FLC$ROUTINES.:E05TOU
 UTS= JUL 29 '97 15:38:41.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    20     24  FLC$TAPE_IO_INIT
    3   DCB   even  none     0      0  M$TSN_USED
    4   DCB   even  none     0      0  M$STATUS
    5   DCB   even  none     0      0  M$REBUILD
    6   DCB   even  none     0      0  M$ARCHIVE
    7   DCB   even  none     0      0  M$NODATA_LIST
    8   DCB   even  none     0      0  M$TAPE00
    9   Proc  even  none    50     62  FLC$TAPE_IO_INIT
   10  RoData even  none     8     10  FLC$TAPE_IO_INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes            yes      Std        0  FLC$TAPE_IO_INIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 FLI$ALLOC_BUF
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:6    

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         TAPE_OPEN
     TAPE_READ                             TAPE_CLOSE                            SNVECLIST$
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             EFTWORD                               DPLISTX
     SPECX                                 TAPE_OPTION                           M$PRE_RET
     RET_CMDS_NAME                         M$TSN_USED                            M$STATUS
     M$REBUILD                             M$ARCHIVE                             M$NODATA_LIST
     M$TAPE00$                             BLK_TAG$                              BLK_TAG0$
     NBR_BYTES_TO_MOVE                     DISK_GRAN$                            BLOCK_GRAN$
     TAPE_BLOCK_                           TAPE_BLOCK_SIZE                       FIT_
     CROSSED                          r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE
     CVOL_UTL                              FILE_FIN                              TAPE_BAD
     TSN_USED_NAME                         BACKUP_NAME                      r    ARCHIVE_NAME
r    PRIME_FILE                       r    DUAL_FILE                             REBUILD_NAME
     REBUILD_DIR_KEY                       REBUILD_KEY                           NODATA_FILE_NAME
     NODATA_KEY                            M$TAPE00                              BREAK_DCB#
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:7    


        1        1        /*M* FLC$ROUTINES - EFT tape input routines */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* THI=1,PLM=3 */
        8        8
        9        9        FLC$TAPE_IO_INIT: PROC;

      9  9 000000   000000 700200 xent  FLC$TAPE_IO* TSX0  ! X66_AUTO_0
         9 000001   000004 000000                    ZERO    4,0

       10       10        /*F* NAME: FLC$TAPE_IO_INIT
       11       11             PURPOSE: Initialize for opening tape files.
       12       12        */
       13       13
       14       14        /***
       15       15         *** INCLUDE
       16       16         ***/
       17       17
       18       18        %INCLUDE CP_6;
       19     5577        %INCLUDE CP_6_SUBS;
       20     6117        %INCLUDE FLI_DATA_R;
       21     7531        %INCLUDE FLS_DATA_R;
       22     9331
       23     9332        /***
       24     9333         *** ENTRY
       25     9334         ***/
       26     9335
       27     9336    1   DCL FLI$ALLOC_BUF ENTRY(2);
       28     9337
       29     9338        /***
       30     9339         *** DCB
       31     9340         ***/
       32     9341
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:8    
       33     9342    1   DCL M$TAPE00 DCB;
       34     9343
       35     9344        /***
       36     9345         *** SYMREF
       37     9346         ***/
       38     9347
       39     9348    1   DCL BREAK_DCB# SBIN SYMREF;
       40     9349
       41     9350        /****************************************/
       42     9351
       43     9352        /***
       44     9353         *** Get FIT buffer and buffer for reading tape.  The tape buffer
       45     9354         *** must be the last buffer obtained since it may be expanded by
       46     9355         *** later calls to FLI$ALLOC_BUF to accomodate buffers larger than
       47     9356         *** originally expected.
       48     9357         ***/
       49     9358
       50     9359    1      CALL FLI$ALLOC_BUF( FIT_, 1 );       /* Get FIT buffer                     */

   9359  9 000002   000000 630400 10                 EPPR0   0
         9 000003   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000004   000000 701000 xent               TSX1    FLI$ALLOC_BUF
         9 000005   000000 011000                    NOP     0

       51     9360
       52     9361    1      CALL FLI$ALLOC_BUF( TAPE_BLOCK_, 4 ); /* Get initial tape buffer           */

   9361  9 000006   000002 630400 10                 EPPR0   2
         9 000007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000010   000000 701000 xent               TSX1    FLI$ALLOC_BUF
         9 000011   000000 011000                    NOP     0

       53     9362    1      TAPE_BLOCK_SIZE = 4096 * 4;

   9362  9 000012   040000 235007                    LDA     16384,DL
         9 000013   000000 755000 xsym               STA     TAPE_BLOCK_SIZE

PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:9    
       54     9363
       55     9364        /***
       56     9365         *** Ready all tape FPTs.
       57     9366         ***/
       58     9367
       59     9368    1      BREAK_DCB# = DCBNUM(M$TAPE00);

   9368  9 000014   000000 236007 xsym               LDQ     M$TAPE00,DL
         9 000015   000000 756000 xsym               STQ     BREAK_DCB#

       60     9369
       61     9370    1      TAPE_OPEN.V.DCB# = BREAK_DCB#;

   9370  9 000016   000000 620006                    EAX0    0,QL
         9 000017   000044 740000 xsym               STX0    TAPE_OPEN+36

       62     9371    1      TAPE_READ.V.DCB# = BREAK_DCB#;

   9371  9 000020   000000 721000 xsym               LXL1    BREAK_DCB#
         9 000021   000010 741000 xsym               STX1    TAPE_READ+8

       63     9372    1      TAPE_CLOSE.V.DCB# = BREAK_DCB#;

   9372  9 000022   000032 741000 xsym               STX1    TAPE_CLOSE+26

       64     9373
       65     9374    1      TAPE_OPEN.V.OPER.NXTF# = %YES#;

   9374  9 000023   004000 236007                    LDQ     2048,DL
         9 000024   000044 256000 xsym               ORSQ    TAPE_OPEN+36

       66     9375        /*N*   TAPE_OPEN.FPARAM_ = FIT_; */
       67     9376
       68     9377    1      TAPE_CLOSE.UTL_ = VECTOR(CVOL_UTL);

   9377  9 000025   000004 237000 10                 LDAQ    4
         9 000026   000004 757000 xsym               STAQ    TAPE_CLOSE+4
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:10   

       69     9378
       70     9379    1      M$TAPE00$ = DCBADDR(BREAK_DCB#);

   9379  9 000027   000006 470400 10                 LDP0    6
         9 000030   000000 471500                    LDP1    0,,PR0
         9 000031   100000 236111                    LDQ     0,X1,PR1
         9 000032   000000 756000 xsym               STQ     M$TAPE00$

       71     9380
       72     9381        /***
       73     9382         *** NXTF is always set.  If there's a particular FSN we want to
       74     9383         *** get to, we must set THISF to get there.
       75     9384         ***/
       76     9385
       77     9386    1      IF TAPE_OPEN.V.FSN# = 0

   9386  9 000033   000066 222000 xsym               LDX2    TAPE_OPEN+54
         9 000034   000040 601000 9                  TNZ     s:9388

       78     9387    1       THEN TAPE_OPEN.V.OPER.THISF# = %NO#;

   9387  9 000035   000007 236000 10                 LDQ     7
         9 000036   000044 356000 xsym               ANSQ    TAPE_OPEN+36
         9 000037   000042 710000 9                  TRA     s:9390

       79     9388    1       ELSE TAPE_OPEN.V.OPER.THISF# = %YES#;

   9388  9 000040   002000 236007                    LDQ     1024,DL
         9 000041   000044 256000 xsym               ORSQ    TAPE_OPEN+36

       80     9389
       81     9390    1      IF TAPE_OPTION.IOERRORC /* Set IOERROK# if continuation after read error   */

   9390  9 000042   000002 236000 xsym               LDQ     TAPE_OPTION+2
         9 000043   010000 316003                    CANQ    4096,DU
         9 000044   000050 600000 9                  TZE     s:9392
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:11   

       82     9391    1       THEN TAPE_READ.V.IOERROK# = '1'B;

   9391  9 000045   002000 236007                    LDQ     1024,DL
         9 000046   000010 256000 xsym               ORSQ    TAPE_READ+8
         9 000047   000052 710000 9                  TRA     s:9398

       83     9392    1       ELSE TAPE_READ.V.IOERROK# = '0'B;

   9392  9 000050   000007 236000 10                 LDQ     7
         9 000051   000010 356000 xsym               ANSQ    TAPE_READ+8

       84     9393
       85     9394        /***
       86     9395         *** Initialize other flags and indices.
       87     9396         ***/
       88     9397
       89     9398    1      FILE_FIN = '1'B;

   9398  9 000052   400000 236003                    LDQ     -131072,DU
         9 000053   000000 756000 xsym               STQ     FILE_FIN

       90     9399    1      CROSSED = ' ';

   9399  9 000054   040000 236003                    LDQ     16384,DU
         9 000055   000000 756000 xsym               STQ     CROSSED

       91     9400
       92     9401    1      DPLISTX = 0;

   9401  9 000056   000000 450000 xsym               STZ     DPLISTX

       93     9402    1      SPECX = 0;

   9402  9 000057   000000 450000 xsym               STZ     SPECX

       94     9403
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:12   
       95     9404    1      TAPE_BAD = '0'B;

   9404  9 000060   000000 450000 xsym               STZ     TAPE_BAD

       96     9405
       97     9406    1      RETURN;

   9406  9 000061   000000 702200 xent               TSX2  ! X66_ARET
       98     9407
       99     9408    1   END FLC$TAPE_IO_INIT;
      100     9409        %EOD;

PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:13   
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$TAPE_IO_INIT.
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:14   

 **** Variables and constants ****

  ****  Section 002  Data  FLC$TAPE_IO_INIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/d STRC(360)   r     1 DEL_NODATA_REC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/c ASTR(9)     r     1 BACKUP_NAME
     0-0-0/w PTR         r     1 BLK_TAG$                   0-0-0/w PTR         r     1 BLK_TAG0$
     0-0-0/w PTR         r     1 BLOCK_GRAN$                0-0-0/w SBIN        r     1 BREAK_DCB#
     0-0-0/c CHAR        r     1 CROSSED                    0-0-0/d STRC(756)   r     1 CVOL_UTL
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DISK_GRAN$
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w SBIN        r     1 DPLISTX
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/c ASTR(9)     r     1 DUAL_FILE
     0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE              0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE
     0-0-0/b BIT         r     1 FILE_FIN                   0-0-0/d STRC(72)    r     1 FIT_
     0-0-0/w PTR         r     1 M$TAPE00$                  0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE
     0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME           0-0-0/c STRC(369)   r     1 NODATA_KEY
     0-0-0/c ASTR(9)     r     1 PRIME_FILE                 0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_KEY                0-0-0/c ASTR(9)     r     1 REBUILD_NAME
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/w SBIN        r     1 SPECX                      0-0-0/b BIT         r     1 TAPE_BAD
     0-0-0/d STRC(72)    r     1 TAPE_BLOCK_                0-0-0/w SBIN        r     1 TAPE_BLOCK_SIZE
     0-0-0/d STRC(1080)  r     1 TAPE_CLOSE                 0-0-0/w PTR         r     1 TAPE_DCBLIST$
     0-0-0/d STRC(2088)  r     1 TAPE_OPEN                  0-0-0/w STRC(144)   r     1 TAPE_OPTION
     0-0-0/d STRC(504)   r     1 TAPE_READ                  0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:15   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$NODATA_LIST              0-0-0N  NULL        r     1 M$TAPE00


   Procedure FLC$TAPE_IO_INIT requires 50 words for executable code.
   Procedure FLC$TAPE_IO_INIT requires 4 words of local(AUTO) storage.
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:16   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:17   
          MINI XREF LISTING

ARCHIVE_NAME.L#
      8423**DCL      8423--IMP-SIZ
BACKUP_NAME.L#
      8067**DCL      8067--IMP-SIZ
BLK_TAG.NAME
      7559**DCL      7559--REDEF
BLK_TAG$
      7556**DCL      7556--IMP-PTR
BLK_TAG0.NAME
      7565**DCL      7565--REDEF
BLK_TAG0$
      7562**DCL      7562--IMP-PTR
BLOCK_GRAN$
      7569**DCL      7570--IMP-PTR
BREAK_DCB#
      9348**DCL      9368<<ASSIGN   9370>>ASSIGN   9371>>ASSIGN   9372>>ASSIGN   9379--ASSIGN
CLOSE_NODATA_LIST.SN_
      9221**DCL      9221--REDEF
CLOSE_NODATA_LIST.UTL_
      9222**DCL      9222--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
      9236**DCL      9236--REDEF
CLOSE_NODATA_LIST.V.TYPE#
      9234**DCL      9234--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
      9231**DCL      9231--REDEF    9233--REDEF
CLOSE_PRIME_DUAL.SN_
      8698**DCL      8698--REDEF
CLOSE_PRIME_DUAL.UTL_
      8699**DCL      8699--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
      8713**DCL      8713--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:18   
CLOSE_PRIME_DUAL.V.TYPE#
      8711**DCL      8711--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
      8708**DCL      8708--REDEF    8710--REDEF
CLOSE_REBUILD.SN_
      8973**DCL      8973--REDEF
CLOSE_REBUILD.UTL_
      8974**DCL      8974--REDEF
CLOSE_REBUILD.V.EXPIRE#
      8988**DCL      8988--REDEF
CLOSE_REBUILD.V.TYPE#
      8986**DCL      8986--REDEF
CLOSE_REBUILD.V.XTNSIZE#
      8983**DCL      8983--REDEF    8985--REDEF
CLOSE_STATUS.SN_
      8188**DCL      8188--REDEF
CLOSE_STATUS.UTL_
      8189**DCL      8189--REDEF
CLOSE_STATUS.V.EXPIRE#
      8203**DCL      8203--REDEF
CLOSE_STATUS.V.TYPE#
      8201**DCL      8201--REDEF
CLOSE_STATUS.V.XTNSIZE#
      8198**DCL      8198--REDEF    8200--REDEF
CLOSE_TSN_USED.SN_
      7898**DCL      7898--REDEF
CLOSE_TSN_USED.UTL_
      7899**DCL      7899--REDEF
CLOSE_TSN_USED.V.EXPIRE#
      7913**DCL      7913--REDEF
CLOSE_TSN_USED.V.TYPE#
      7911**DCL      7911--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
      7908**DCL      7908--REDEF    7910--REDEF
CON_CLOSE_ARCHIVE.SN_
      8230**DCL      8230--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:19   
CON_CLOSE_ARCHIVE.UTL_
      8231**DCL      8231--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
      8245**DCL      8245--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
      8243**DCL      8243--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
      8240**DCL      8240--REDEF    8242--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
      8317**DCL      8318--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
      8323**DCL      8324--REDEF    8324--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
      8322**DCL      8323--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
      8321**DCL      8322--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
      8315**DCL      8316--REDEF    8316--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
      8355**DCL      8355--REDEF    8355--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
      8321**DCL      8321--REDEF
CON_READ_ARCHIVE_FILE.STATION_
      8379**DCL      8380--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
      8391**DCL      8391--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
      8389**DCL      8389--REDEF
CROSSED
      7591**DCL      9399<<ASSIGN
CVOL_UTL
      7658**DCL      9377--ASSIGN
CVOL_UTL.ULBL#
      7658**DCL      7658--REDEF
DEL_NODATA_REC.V
      9324**DCL      9321--DCLINIT
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:20   
DISK_CLOSE.SN_
      6728**DCL      6728--REDEF
DISK_CLOSE.UTL_
      6729**DCL      6729--REDEF
DISK_CLOSE.V.EXPIRE#
      6743**DCL      6743--REDEF
DISK_CLOSE.V.TYPE#
      6741**DCL      6741--REDEF
DISK_CLOSE.V.XTNSIZE#
      6738**DCL      6738--REDEF    6740--REDEF
DISK_FILE_SPEC.SPEC
      7093**DCL      7095--REDEF
DISK_FILE_SPEC.SPEC.START
      7094**DCL      7094--REDEF
DISK_FILE_SPEC.SPEC.STOP
      7095**DCL      7095--REDEF
DISK_FILE_SPEC$
      7092**DCL      7093--IMP-PTR
DISK_GRAN$
      7569**DCL      7569--IMP-PTR
DISK_OPEN.ACSVEH_
      6593**DCL      6594--REDEF
DISK_OPEN.ALTKEYS_
      6599**DCL      6600--REDEF    6600--REDEF
DISK_OPEN.HDR_
      6598**DCL      6599--REDEF
DISK_OPEN.TAB_
      6597**DCL      6598--REDEF
DISK_OPEN.UHL_
      6591**DCL      6592--REDEF    6592--REDEF
DISK_OPEN.V.FSN#
      6631**DCL      6631--REDEF    6631--REDEF
DISK_OPEN.WSN_
      6597**DCL      6597--REDEF
DISK_READ.STATION_
      6655**DCL      6656--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:21   
DISK_READ.V.DVBYTE.REREAD#
      6667**DCL      6667--REDEF
DISK_READ.V.INDX#
      6665**DCL      6665--REDEF
DISK_WRITE.STATION_
      6693**DCL      6693--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      6700**DCL      6700--REDEF
DPLIST$
      7078**DCL      7090--IMP-PTR
DPLISTX
      7214**DCL      9401<<ASSIGN
DPRESLIST$
      7092**DCL      7092--IMP-PTR
DUAL_FILE.L#
      8494**DCL      8494--IMP-SIZ
EFTWORD
      7213**DCL      7213--REDEF
EFT_CVOL_FILE.L#
      7618**DCL      7618--IMP-SIZ
EFT_RESTRICT_FILE.L#
      7645**DCL      7645--IMP-SIZ
FILE_FIN
      7661**DCL      9398<<ASSIGN
FIT_
      7587**DCL      9359<>CALL
FIT_AREA.W2
      7929**DCL      7930--REDEF
FLI$ALLOC_BUF
      9336**DCL-ENT  9359--CALL     9361--CALL
FPT_EXIT.V.STEPCC#
      6518**DCL      6518--REDEF
M$TAPE00
      9342**DCL      9368>>ASSIGN
M$TAPE00$
      7555**DCL      9379<<ASSIGN
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:22   
NBR_BYTES_TO_MOVE
      7568**DCL      7569--IMP-SIZ  7570--IMP-SIZ
NODATA_FILE_NAME.L#
      9183**DCL      9183--IMP-SIZ
NODATA_KEY
      9329**DCL      9321--DCLINIT  9322--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
      9116**DCL      9117--REDEF
OPEN_NODATA_LIST.ALTKEYS_
      9122**DCL      9123--REDEF    9123--REDEF
OPEN_NODATA_LIST.HDR_
      9121**DCL      9122--REDEF
OPEN_NODATA_LIST.TAB_
      9120**DCL      9121--REDEF
OPEN_NODATA_LIST.UHL_
      9114**DCL      9115--REDEF    9115--REDEF
OPEN_NODATA_LIST.V.FSN#
      9154**DCL      9154--REDEF    9154--REDEF
OPEN_NODATA_LIST.WSN_
      9120**DCL      9120--REDEF
OPEN_PRIME_DUAL.ACSVEH_
      8563**DCL      8564--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
      8569**DCL      8570--REDEF    8570--REDEF
OPEN_PRIME_DUAL.HDR_
      8568**DCL      8569--REDEF
OPEN_PRIME_DUAL.TAB_
      8567**DCL      8568--REDEF
OPEN_PRIME_DUAL.UHL_
      8561**DCL      8562--REDEF    8562--REDEF
OPEN_PRIME_DUAL.V.FSN#
      8601**DCL      8601--REDEF    8601--REDEF
OPEN_PRIME_DUAL.WSN_
      8567**DCL      8567--REDEF
OPEN_REBUILD.ACSVEH_
      8798**DCL      8799--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:23   
OPEN_REBUILD.ALTKEYS_
      8804**DCL      8805--REDEF    8805--REDEF
OPEN_REBUILD.HDR_
      8803**DCL      8804--REDEF
OPEN_REBUILD.TAB_
      8802**DCL      8803--REDEF
OPEN_REBUILD.UHL_
      8796**DCL      8797--REDEF    8797--REDEF
OPEN_REBUILD.V.FSN#
      8836**DCL      8836--REDEF    8836--REDEF
OPEN_REBUILD.WSN_
      8802**DCL      8802--REDEF
OPEN_STATUS.ACSVEH_
      8000**DCL      8001--REDEF
OPEN_STATUS.ALTKEYS_
      8006**DCL      8007--REDEF    8007--REDEF
OPEN_STATUS.HDR_
      8005**DCL      8006--REDEF
OPEN_STATUS.TAB_
      8004**DCL      8005--REDEF
OPEN_STATUS.UHL_
      7998**DCL      7999--REDEF    7999--REDEF
OPEN_STATUS.V.FSN#
      8038**DCL      8038--REDEF    8038--REDEF
OPEN_STATUS.WSN_
      8004**DCL      8004--REDEF
OPEN_TSN_USED.ACSVEH_
      7736**DCL      7737--REDEF
OPEN_TSN_USED.ALTKEYS_
      7742**DCL      7743--REDEF    7743--REDEF
OPEN_TSN_USED.HDR_
      7741**DCL      7742--REDEF
OPEN_TSN_USED.TAB_
      7740**DCL      7741--REDEF
OPEN_TSN_USED.UHL_
      7734**DCL      7735--REDEF    7735--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:24   
OPEN_TSN_USED.V.FSN#
      7774**DCL      7774--REDEF    7774--REDEF
OPEN_TSN_USED.WSN_
      7740**DCL      7740--REDEF
PRE_RET_CLOSE.SN_
      7456**DCL      7456--REDEF
PRE_RET_CLOSE.UTL_
      7457**DCL      7457--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      7471**DCL      7471--REDEF
PRE_RET_CLOSE.V.TYPE#
      7469**DCL      7469--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      7466**DCL      7466--REDEF    7468--REDEF
PRE_RET_OPEN.ACSVEH_
      7391**DCL      7392--REDEF
PRE_RET_OPEN.ALTKEYS_
      7397**DCL      7398--REDEF    7398--REDEF
PRE_RET_OPEN.HDR_
      7396**DCL      7397--REDEF
PRE_RET_OPEN.TAB_
      7395**DCL      7396--REDEF
PRE_RET_OPEN.UHL_
      7389**DCL      7390--REDEF    7390--REDEF
PRE_RET_OPEN.V.FSN#
      7429**DCL      7429--REDEF    7429--REDEF
PRE_RET_OPEN.WSN_
      7395**DCL      7395--REDEF
PRE_RET_READ.STATION_
      7246**DCL      7247--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      7258**DCL      7258--REDEF
PRE_RET_READ.V.INDX#
      7256**DCL      7256--REDEF
PRE_RET_WRITE.STATION_
      7284**DCL      7284--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:25   
PRE_RET_WRITE.V.DVBYTE.VFC#
      7291**DCL      7291--REDEF
PRIME_FILE.L#
      8467**DCL      8467--IMP-SIZ
READ_NODATA_LIST.STATION_
      9260**DCL      9261--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
      9272**DCL      9272--REDEF
READ_NODATA_LIST.V.INDX#
      9270**DCL      9270--REDEF
READ_PRIME_DUAL.STATION_
      8625**DCL      8626--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
      8637**DCL      8637--REDEF
READ_PRIME_DUAL.V.INDX#
      8635**DCL      8635--REDEF
READ_REBUILD.STATION_
      8931**DCL      8932--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
      8943**DCL      8943--REDEF
READ_REBUILD.V.INDX#
      8941**DCL      8941--REDEF
READ_STATUS.STATION_
      8146**DCL      8147--REDEF
READ_STATUS.V.DVBYTE.REREAD#
      8158**DCL      8158--REDEF
READ_STATUS.V.INDX#
      8156**DCL      8156--REDEF
READ_TSN_USED.STATION_
      7856**DCL      7857--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
      7868**DCL      7868--REDEF
READ_TSN_USED.V.INDX#
      7866**DCL      7866--REDEF
REBUILD_DIR_KEY.L#
      9017**DCL      9017--IMP-SIZ
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:26   
REBUILD_KEY.L#
      9044**DCL      9044--IMP-SIZ
REBUILD_NAME.L#
      8865**DCL      8865--IMP-SIZ
RET_CMDS_NAME.L#
      7500**DCL      7500--IMP-SIZ
SNVECLIST$
      7032**DCL      7032--IMP-PTR
SPEC.START
      7096**DCL      7097--REDEF
SPEC.STOP
      7097**DCL      7098--REDEF
SPECCHARS
      7096**DCL      7096--REDEF
SPECX
      7214**DCL      9402<<ASSIGN
TAPE_BAD
      7663**DCL      9404<<ASSIGN
TAPE_BLOCK_
      7583**DCL      9361<>CALL
TAPE_BLOCK_.W2
      7584**DCL      7585--REDEF
TAPE_BLOCK_SIZE
      7587**DCL      9362<<ASSIGN
TAPE_CLOSE.SN_
      6949**DCL      6949--REDEF
TAPE_CLOSE.UTL_
      6950**DCL      6950--REDEF    9377<<ASSIGN
TAPE_CLOSE.V.DCB#
      6955**DCL      9372<<ASSIGN
TAPE_CLOSE.V.EXPIRE#
      6964**DCL      6964--REDEF
TAPE_CLOSE.V.TYPE#
      6962**DCL      6962--REDEF
TAPE_CLOSE.V.XTNSIZE#
      6959**DCL      6959--REDEF    6961--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:27   
TAPE_DCBLIST$
      6505**DCL      6505--IMP-PTR
TAPE_OPEN.ACSVEH_
      6814**DCL      6815--REDEF
TAPE_OPEN.ALTKEYS_
      6820**DCL      6821--REDEF    6821--REDEF
TAPE_OPEN.HDR_
      6819**DCL      6820--REDEF
TAPE_OPEN.TAB_
      6818**DCL      6819--REDEF
TAPE_OPEN.UHL_
      6812**DCL      6813--REDEF    6813--REDEF
TAPE_OPEN.V.DCB#
      6821**DCL      9370<<ASSIGN
TAPE_OPEN.V.FSN#
      6852**DCL      6852--REDEF    6852--REDEF    9386>>IF
TAPE_OPEN.V.OPER.NXTF#
      6824**DCL      9374<<ASSIGN
TAPE_OPEN.V.OPER.THISF#
      6824**DCL      9387<<ASSIGN   9388<<ASSIGN
TAPE_OPEN.WSN_
      6818**DCL      6818--REDEF
TAPE_OPTION.IOERRORC
      7217**DCL      9390>>IF
TAPE_READ.STATION_
      6876**DCL      6877--REDEF
TAPE_READ.V.DCB#
      6877**DCL      9371<<ASSIGN
TAPE_READ.V.DVBYTE.REREAD#
      6888**DCL      6888--REDEF
TAPE_READ.V.INDX#
      6886**DCL      6886--REDEF
TAPE_READ.V.IOERROK#
      6880**DCL      9391<<ASSIGN   9392<<ASSIGN
TAPE_WRITE.STATION_
      6914**DCL      6914--REDEF
PL6.E3A0      #001=FLC$TAPE_IO_INIT File=FLC$ROUTINES.:E05TSI                    TUE 07/29/97 15:38 Page:28   
TAPE_WRITE.V.DVBYTE.VFC#
      6921**DCL      6921--REDEF
TSN_USED_NAME.L#
      7803**DCL      7803--IMP-SIZ
TVECTOR.W2
      7045**DCL      7046--REDEF
WRITE_NODATA_LIST.STATION_
      9298**DCL      9298--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
      9305**DCL      9305--REDEF
WRITE_PRIME_DUAL.STATION_
      8663**DCL      8663--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
      8670**DCL      8670--REDEF
WRITE_REBUILD.STATION_
      8899**DCL      8899--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
      8906**DCL      8906--REDEF
WRITE_STATUS.STATION_
      8114**DCL      8114--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
      8121**DCL      8121--REDEF
WRITE_TSN_USED.STATION_
      7824**DCL      7824--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
      7831**DCL      7831--REDEF

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:29   
      101        1        /*T***********************************************************/
      102        2        /*T*                                                         */
      103        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      104        4        /*T*                                                         */
      105        5        /*T***********************************************************/
      106        6        FLC$TAPE_OPEN_NEXT: PROC( TAPEDCB$, FPARAM_, ERR ) ALTRET;
      107        7        /*F*  NAME: FLC$TAPE_OPEN_NEXT
      108        8              PURPOSE: Opens next logical file on tape.
      109        9        */
      110       10
      111       11    1   DCL TAPEDCB$ PTR;
      112       12    1   DCL 1 FPARAM_ DALIGNED,
      113       13    1         2 * BIT(36),
      114       14    1         2 PTR$ PTR;
      115       15    1   DCL 1 ERR ALIGNED,
      116       16    1         2 * BIT(12) UNAL,
      117       17    1         2 * BIT(6) UNAL,
      118       18    1         2 * BIT(1) UNAL,
      119       19    1         2 CODE UBIN(14) UNAL,
      120       20    1         2 * UBIN(3) UNAL;
      121       21
      122       22        /***
      123       23         *** INCLUDE
      124       24         ***/
      125       25
      126       26        %INCLUDE B_ERRORS_C;
      127     1153        %INCLUDE CP_6;
      128     6712        %INCLUDE CP_6_SUBS;
      129     7252        %INCLUDE FLE_DATA_R;
      130    13203        %INCLUDE FLI_DATA_R;
      131    14617        %INCLUDE FLS_DATA_R;
      132    16417        %INCLUDE FM$FIT;
      133    16638        %INCLUDE FM$GRAN;
      134    16707
      135    16708        /***
      136    16709         *** ENTRY
      137    16710         ***/
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:30   
      138    16711
      139    16712    1   DCL FLC$CRIT_CHECK ENTRY(2) ALTRET;
      140    16713    1   DCL FLC$READ_TAPE_BLOCK ENTRY(1) ALTRET;
      141    16714    1   DCL FLC$TAPE_OPEN ENTRY(1) ALTRET;
      142    16715    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      143    16716    1   DCL FLI$RPT_ERR ENTRY(5);
      144    16717    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      145    16718
      146    16719        /***
      147    16720         *** AUTO
      148    16721         ***/
      149    16722
      150    16723    1   DCL I SBIN AUTO;
      151    16724    1   DCL USE_THIS BIT(1) AUTO;
      152    16725    1   DCL CODE03$ PTR AUTO;
      153    16726    1   DCL FIT_MISSING BIT(1) AUTO;
      154    16727        %VLP_NAME ( FPTN=ACCT_NAME,
      155    16728                    LEN=8,
      156    16729                    STCLASS=AUTO );
      157    16756
      158    16757
      159    16758        /***
      160    16759         *** BASED
      161    16760         ***/
      162    16761
      163    16762        %F$DCB(BASED="BASED(M$TAPE00$)");
      164    16819        %B$TCB( STCLASS="BASED(B$TCB$)" );
      165    16822        %B$ALT;
      166    16830        %CODE03( BASED="BASED(CODE03$)" );
      167    16837        %FM$GRAN;
      168    16841
      169    16842        /****************************************/
      170    16843
      171    16844    1      TAPEDCB$ = EFTFILE_DCB$;
      172    16845    1      FPARAM_ = FIT_;
      173    16846    1      ERR = '0'B;
      174    16847
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:31   
      175    16848    2      DO WHILE('1'B);
      176    16849    2         IF NOT F$DCB.FCD#
      177    16850    2          THEN CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );
             16850                   /* Open the next tape file */
      178    16851
      179    16852    3         DO WHILE( ERR.CODE ~= %E$EOF );
      180    16853
      181    16854    4            DO WHILE( BLK_TAG$ >= TAPE_BLOCK_.PTR$ );
             16854                     /* Find the beginning of the next disk file on tape */
      182    16855    4               IF BLK_TAG.BEG
      183    16856    5                THEN DO;
      184    16857
      185    16858    5                  IF NOT FILE_FIN
      186    16859    6                   THEN DO; /* Say what? The previous file didn't cleanly end    */
      187    16860    6                     ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);
      188    16861    6                     ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;
      189    16862    6                     CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->
      190    16863    6                       F$DCB.NAME#),VECTOR(ACCT_NAME) );
      191    16864    6                     TAPE_BAD = '1'B;
      192    16865    6                     IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      193    16866    6                      THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      194    16867    6                     END;
      195    16868    5                   ELSE FILE_FIN = '0'B;
      196    16869
      197    16870    5                  ERR = '0'B;
      198    16871    5                  CROSSED = ' ';
      199    16872    5                  FIT_MISSING = '0'B;
      200    16873
      201    16874    6                  DO CASE( BLK_TAG.TYPE ); /* ERR setting tells caller what type */
      202    16875    6                   CASE( %FILE_DIR );
      203    16876    6                     ERR.CODE = %E$FDEOF;
      204    16877    6                   CASE( %ACCT_DIR );
      205    16878    6                     ERR.CODE = %E$ADEOF;
      206    16879    6                   CASE( %DEL_ACCT );
      207    16880    6                     ERR.CODE = %E$NOKEY;
      208    16881    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;
      209    16882    6                   CASE( %DEL_FILE );
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:32   
      210    16883    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;
      211    16884    6                   CASE( %CLEANUP_FILE );
      212    16885    6                     ERR.CODE = %E$NOFILE;
      213    16886    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;
      214    16887    6                   CASE( %CLEANUP_ACCT );
      215    16888    6                     ERR.CODE = %E$NOPROC;
      216    16889    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;
      217    16890    6                   END;
      218    16891
      219    16892    6                  DO CASE( BLK_TAG.TYPE ); /* Make sure FIT is physically there  */
      220    16893    6                   CASE( %REG_FILE, %FILE_DIR, %ACCT_DIR, %INACTIVE_FILE, %ACUP_FILE, %
             16893                            IDS_FAST_FILE );
      221    16894    6                     FPARAM_.PTR$ = PINCRC( GRAN_BASE$, BLK_TAG.BEGX );
      222    16895    6                     IF FPARAM_.PTR$ > MAX_FIT$
      223    16896    7                      THEN DO;
      224    16897    7                        CALL FLI$RPT_ERR( E_FIT_NOT_THERE, );
      225    16898    7                        TAPE_BAD = '1'B;
      226    16899    7                        IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      227    16900    7                         THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      228    16901    7                        FIT_MISSING = '1'B;
      229    16902    7                        BLK_TAG.SIZE = 0;
      230    16903    7                        END;
      231    16904    7                      ELSE DO;        /* Skip over FIT to data granules (if any) */
      232    16905    7                        BLK_TAG.BEGX = BLK_TAG.BEGX + 4096;
      233    16906    7                        BLK_TAG.SIZE = BLK_TAG.SIZE - 4096;
      234    16907    7                        END;
      235    16908    6                   END;
      236    16909
      237    16910    5                  FILE_FIN = BLK_TAG.FIN;
      238    16911
      239    16912    5                  IF NOT FIT_MISSING
      240    16913    6                   THEN DO;
      241    16914    6                     EFTFILE_DCB$->F$DCB.VOL# = F$DCB.VOL#;
      242    16915
      243    16916    7                     DO CASE( BLK_TAG.TYPE ); /* Return item if requested        */
      244    16917
      245    16918    7                      CASE( %FILE_DIR );
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:33   
      246    16919    7                        EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG.WHERE.ACCT;
      247    16920    7                        EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG.WHERE.PSN;
      248    16921    7                        CALL FLC_TAPE_ACCT_CHECK
      249    16922    8                         WHENRETURN DO;
      250    16923    8                           IF DISK_OPTION.DIR
      251    16924    8                            THEN RETURN;
      252    16925    8                           END;
      253    16926    8                         WHENALTRETURN DO;
      254    16927    8                           END;
      255    16928
      256    16929    7                      CASE( %DEL_ACCT, %CLEANUP_ACCT );
      257    16930    7                        EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG.WHERE.ACCT;
      258    16931    7                        EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG.WHERE.PSN;
      259    16932    7                        CALL FLC_TAPE_ACCT_CHECK
      260    16933    8                         WHENRETURN DO;
      261    16934    8                           IF DISK_OPTION.DELETED_ACCOUNTS
      262    16935    8                            THEN RETURN;
      263    16936    8                           END;
      264    16937    8                         WHENALTRETURN DO;
      265    16938    8                           END;
      266    16939
      267    16940    7                      CASE( %ACCT_DIR );
      268    16941    7                        EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG.WHERE.ACCT;
      269    16942    7                        EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG.WHERE.PSN;
      270    16943    7                        IF DISK_OPTION.PAD THEN RETURN;
      271    16944
      272    16945    7                      CASE( %INACTIVE_FILE, %REG_FILE, %ACUP_FILE, %DEL_FILE, %
             16945                               CLEANUP_FILE, %IDS_FAST_FILE );
      273    16946    7                        EFTFILE_DCB$->F$DCB.NAME#.C = BLK_TAG.NAME.C;
      274    16947    7                        EFTFILE_DCB$->F$DCB.NAME#.L = BLK_TAG.NAME.L;
      275    16948    7                        EFTFILE_DCB$->F$DCB.DESC = BLK_TAG.DESC;
      276    16949    7                        CALL FLC_TAPE_FILE_CHECK
      277    16950    8                         WHENRETURN DO;
      278    16951    8                           RETURN;
      279    16952    8                           END;
      280    16953    8                         WHENALTRETURN DO;
      281    16954    8                           END;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:34   
      282    16955
      283    16956    7                      END;
      284    16957    6                     END;
      285    16958    5                  END;
      286    16959    4               FILE_FIN = BLK_TAG.FIN;
      287    16960    4               BLK_TAG$ = PINCRW( BLK_TAG$, -SIZEW(BLK_TAG) );
      288    16961    4               END;
      289    16962
      290    16963    3            CALL FLC$READ_TAPE_BLOCK( ERR ) ALTRET( JUSTALT );
      291    16964    3            CALL FLC_TAPE_PSN_CHECK
      292    16965    4             WHENALTRETURN DO;
      293    16966    4               BLK_TAG$ = PINCRW( TAPE_BLOCK_.PTR$, -SIZEW(BLK_TAG) );
      294    16967    4               END;
      295    16968                                      /* Current file might be continued due to CVOL  */
      296    16969    3            END;
      297    16970    2         CALL FLC$TAPE_CLOSE( ERR ) ALTRET( JUSTALT );
      298    16971    2         IF NOT FILE_FIN
      299    16972    2          THEN IF (CVOL_UTL.NUM# <= 0 AND SUBSTR(F$DCB.RES#,0,2) = 'LT')
      300    16973    2              OR SUBSTR(F$DCB.RES#,0,2) = 'OD'
      301    16974    3             THEN DO;
      302    16975    3               FILE_FIN = '1'B;
      303    16976    3               ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);
      304    16977    3               ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;
      305    16978    3               CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.
      306    16979    3                 NAME#),VECTOR(ACCT_NAME) );
      307    16980    3               TAPE_BAD = '1'B;
      308    16981    3               IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      309    16982    3                THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      310    16983    3               END;
      311    16984    2             ELSE CROSSED = '*';
      312    16985    2         END;
      313    16986
      314    16987    1   JUSTALT: ;
      315    16988    1      IF NOT FILE_FIN
      316    16989    2       THEN DO;
      317    16990    2         ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);
      318    16991    2         ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:35   
      319    16992    2         CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.NAME#),
      320    16993    2           VECTOR(ACCT_NAME) );
      321    16994    2         TAPE_BAD = '1'B;
      322    16995    2         IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      323    16996    2          THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      324    16997    2         END;
      325    16998    1      ALTRETURN;
      326    16999
      327    17000    1   FLC_TAPE_ACCT_CHECK: PROC ALTRET;
      328    17001        /*F*  NAME: FLC_TAPE_ACCT_CHECK
      329    17002              PURPOSE: Determine if current account on tape is to be returned.
      330    17003        */
      331    17004
      332    17005        /********************/
      333    17006
      334    17007    2      SPEC.STOP.ACCT.ACCT# = EFTFILE_DCB$->F$DCB.ACCT#;
      335    17008    2      IF SPEC.STOP.ACCT.ACCT# >= DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#(SPECX)
      336    17009    2        AND SPEC.STOP.ACCT.ACCT# <= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(SPECX)
      337    17010    2       THEN RETURN;
      338    17011
      339    17012    3      DO I=0 TO DISK_FILE_SPEC.NBR-1;
      340    17013    3         IF SPEC.STOP.ACCT.ACCT# >= DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#(I)
      341    17014    3           AND SPEC.STOP.ACCT.ACCT# <= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(I)
      342    17015    4          THEN DO;
      343    17016    4            SPECX = I;
      344    17017    4            RETURN;
      345    17018    4            END;
      346    17019    3         END;
      347    17020
      348    17021    2      ALTRETURN;
      349    17022
      350    17023    2   END FLC_TAPE_ACCT_CHECK;
      351    17024
      352    17025
      353    17026    1   FLC_TAPE_PSN_CHECK: PROC ALTRET;
      354    17027        /*F*  NAME: FLC_TAPE_PSN_CHECK
      355    17028              PURPOSE: Determine of current packset on tape is to be returned.
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:36   
      356    17029        */
      357    17030
      358    17031        /********************/
      359    17032
      360    17033    2      IF DPLIST.NUM# <= 0
      361    17034    2       THEN RETURN;    /* No block can contain files from more than one packset  */
      362    17035    2      IF DPLIST.SN#(DPLISTX) = EFTFILE_DCB$->F$DCB.PSN#
      363    17036    2       THEN RETURN;
      364    17037
      365    17038    3      DO I=0 TO DPLIST.NUM#-1;
      366    17039    3         IF DPLIST.SN#(I) = EFTFILE_DCB$->F$DCB.PSN#
      367    17040    4          THEN DO;
      368    17041    4            DPLISTX = I;
      369    17042    4            RETURN;
      370    17043    4            END;
      371    17044    3         END;
      372    17045
      373    17046    2      ALTRETURN;
      374    17047
      375    17048    2   END FLC_TAPE_PSN_CHECK;
      376    17049
      377    17050    1   FLC_TAPE_FILE_CHECK: PROC ALTRET;
      378    17051        /*F*  NAME: FLC_TAPE_FILE_CHECK
      379    17052              PURPOSE: Determine if current file on tape is to be returned.
      380    17053        */
      381    17054
      382    17055        /********************/
      383    17056
      384    17057    2      IF DISK_SRCHCOND.ANYF#
      385    17058    2        OR DISK_SRCHCOND & EFTFILE_DCB$->F$DCB.DESC
      386    17059    2        OR (NOT DISK_SRCHCOND AND NOT EFTFILE_DCB$->F$DCB.DESC.DELF#)
      387    17060    3       THEN DO;
      388    17061    3         IF DISK_FILE_SPEC.NBR > 0
      389    17062    4          THEN DO;
      390    17063    4            SPEC.STOP.ACCT.ACCT# = EFTFILE_DCB$->F$DCB.ACCT#;
      391    17064    4            SPEC.STOP.FILE.L# = EFTFILE_DCB$->F$DCB.NAME#.L;
      392    17065    4            SPEC.STOP.FILE.NAME# = EFTFILE_DCB$->F$DCB.NAME#.C;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:37   
      393    17066    4            IF SPEC.STOP >= DISK_FILE_SPEC.SPEC.START(SPECX)
      394    17067    4              AND SPEC.STOP <= DISK_FILE_SPEC.SPEC.STOP(SPECX)
      395    17068    4             THEN USE_THIS = '1'B;
      396    17069    5             ELSE DO;
      397    17070    5               USE_THIS = '0'B;
      398    17071    6               DO I=0 TO DISK_FILE_SPEC.NBR-1;
      399    17072    6                  IF SPEC.STOP >= DISK_FILE_SPEC.SPEC.START(I)
      400    17073    6                    AND SPEC.STOP <= DISK_FILE_SPEC.SPEC.STOP(I)
      401    17074    7                   THEN DO;
      402    17075    7                     USE_THIS = '1'B;
      403    17076    7                     SPECX = I;
      404    17077    7                     END;
      405    17078    6                  END;
      406    17079    5               END;
      407    17080    4            END;
      408    17081    3          ELSE USE_THIS = '1'B;            /* No spec means all                  */
      409    17082
      410    17083    3         IF USE_THIS
      411    17084    4          THEN DO;
      412    17085    4            EFTFILE_DCB$->F$DCB.ORG# = 0;
      413    17086    4            IF DISK_CRIT.ORG
      414    17087    5             THEN DO;                      /* Must get ORG from CODE03           */
      415    17088    5               IF BLK_TAG.TYPE = %REG_FILE OR BLK_TAG.TYPE = %ACUP_FILE
      416    17089    5                 OR BLK_TAG.TYPE = %IDS_FAST_FILE
      417    17090    6                THEN DO;
      418    17091    6                  CODE03$ = PINCRW( FPARAM_.PTR$, SIZEW(FM$GRAN) );
      419    17092    6                  CALL XSF$LOCCODP( CODE03$, 03 )
      420    17093    7                   WHENRETURN DO;
      421    17094    7                     EFTFILE_DCB$->F$DCB.ORG# = CODE03.ORG;
      422    17095    7                     END;
      423    17096    6                  END;
      424    17097    5               END;
      425    17098    4            CALL FLC$CRIT_CHECK( EFTFILE_DCB$, FPARAM_.PTR$ )
      426    17099    5             WHENRETURN DO;
      427    17100    5               RETURN;
      428    17101    5               END;
      429    17102    4            END;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:38   
      430    17103    3         END;
      431    17104
      432    17105    2      ALTRETURN;
      433    17106
      434    17107    2   END FLC_TAPE_FILE_CHECK;
      435    17108
      436    17109    1   END FLC$TAPE_OPEN_NEXT;
      437    17110        %EOD;

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:39   
--  Include file information  --

   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLC$TAPE_OPEN_NEXT.

   Procedure FLC$TAPE_OPEN_NEXT requires 565 words for executable code.
   Procedure FLC$TAPE_OPEN_NEXT requires 30 words of local(AUTO) storage.

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:40   

 Object Unit name= FLC$TAPE_OPEN_NEXT                         File name= FLC$ROUTINES.:E05TOU
 UTS= JUL 29 '97 15:39:19.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    20     24  FLC$TAPE_OPEN_NEXT
    3   DCB   even  none     0      0  M$TSN_USED
    4   DCB   even  none     0      0  M$STATUS
    5   DCB   even  none     0      0  M$REBUILD
    6   DCB   even  none     0      0  M$ARCHIVE
    7   DCB   even  none     0      0  M$NODATA_LIST
    8  RoData even  UTS      2      2  FLC$TAPE_OPEN_NEXT
    9   Proc  even  none   565   1065  FLC$TAPE_OPEN_NEXT
   10  RoData even  none     7      7  FLC$TAPE_OPEN_NEXT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        3  FLC$TAPE_OPEN_NEXT
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:41   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FLC$TAPE_OPEN
         yes           Std       5 FLI$RPT_ERR
 yes     yes           Std       1 FLC$READ_TAPE_BLOCK
 yes     yes           Std       1 FLC$TAPE_CLOSE
 yes     yes           Std       2 XSF$LOCCODP
 yes     yes           Std       2 FLC$CRIT_CHECK
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    E_PARTIAL_FILE                   r    E_FIT_NOT_THERE
     TAPE_DCBLIST$                         FPT_EXIT                              SNVECLIST$
     B$TCB$                                DPLIST$                               DPRESLIST$
     DISK_FILE_SPEC$                       SPECCHARS                             DISK_SRCHCOND
     DISK_OPTION                           DISK_CRIT                             EFTWORD
     DPLISTX                               SPECX                                 M$PRE_RET
     RET_CMDS_NAME                         M$TSN_USED                            M$STATUS
     M$REBUILD                             M$ARCHIVE                             M$NODATA_LIST
     M$TAPE00$                             BLK_TAG$                              BLK_TAG0$
     NBR_BYTES_TO_MOVE                     DISK_GRAN$                            BLOCK_GRAN$
     TAPE_BLOCK_                           FIT_                                  GRAN_BASE$
     CROSSED                          r    EFTFILE_DCB$                     r    EFT_CVOL_FILE
r    EFT_RESTRICT_FILE                     CVOL_UTL                              FILE_FIN
     MAX_FIT$                              TAPE_BAD                              TSN_USED_NAME
     BACKUP_NAME                      r    ARCHIVE_NAME                     r    PRIME_FILE
r    DUAL_FILE                             REBUILD_NAME                          REBUILD_DIR_KEY
     REBUILD_KEY                           NODATA_FILE_NAME                      NODATA_KEY
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:42   
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:43   


      101        1        /*T***********************************************************/
      102        2        /*T*                                                         */
      103        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      104        4        /*T*                                                         */
      105        5        /*T***********************************************************/
      106        6        FLC$TAPE_OPEN_NEXT: PROC( TAPEDCB$, FPARAM_, ERR ) ALTRET;

      6  9 000000   000000 700200 xent  FLC$TAPE_OP* TSX0  ! X66_AUTO_3
         9 000001   000036 000003                    ZERO    30,3

      107        7        /*F*  NAME: FLC$TAPE_OPEN_NEXT
      108        8              PURPOSE: Opens next logical file on tape.
      109        9        */
      110       10
      111       11    1   DCL TAPEDCB$ PTR;
      112       12    1   DCL 1 FPARAM_ DALIGNED,
      113       13    1         2 * BIT(36),
      114       14    1         2 PTR$ PTR;
      115       15    1   DCL 1 ERR ALIGNED,
      116       16    1         2 * BIT(12) UNAL,
      117       17    1         2 * BIT(6) UNAL,
      118       18    1         2 * BIT(1) UNAL,
      119       19    1         2 CODE UBIN(14) UNAL,
      120       20    1         2 * UBIN(3) UNAL;
      121       21
      122       22        /***
      123       23         *** INCLUDE
      124       24         ***/
      125       25
      126       26        %INCLUDE B_ERRORS_C;
      127     1153        %INCLUDE CP_6;
      128     6712        %INCLUDE CP_6_SUBS;
      129     7252        %INCLUDE FLE_DATA_R;
      130    13203        %INCLUDE FLI_DATA_R;
      131    14617        %INCLUDE FLS_DATA_R;
      132    16417        %INCLUDE FM$FIT;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:44   
      133    16638        %INCLUDE FM$GRAN;
      134    16707
      135    16708        /***
      136    16709         *** ENTRY
      137    16710         ***/
      138    16711
      139    16712    1   DCL FLC$CRIT_CHECK ENTRY(2) ALTRET;
      140    16713    1   DCL FLC$READ_TAPE_BLOCK ENTRY(1) ALTRET;
      141    16714    1   DCL FLC$TAPE_OPEN ENTRY(1) ALTRET;
      142    16715    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      143    16716    1   DCL FLI$RPT_ERR ENTRY(5);
      144    16717    1   DCL XSF$LOCCODP ENTRY(2) ALTRET;
      145    16718
      146    16719        /***
      147    16720         *** AUTO
      148    16721         ***/
      149    16722
      150    16723    1   DCL I SBIN AUTO;
      151    16724    1   DCL USE_THIS BIT(1) AUTO;
      152    16725    1   DCL CODE03$ PTR AUTO;
      153    16726    1   DCL FIT_MISSING BIT(1) AUTO;
      154    16727        %VLP_NAME ( FPTN=ACCT_NAME,
      155    16728                    LEN=8,
      156    16729                    STCLASS=AUTO );
      157    16756
      158    16757
      159    16758        /***
      160    16759         *** BASED
      161    16760         ***/
      162    16761
      163    16762        %F$DCB(BASED="BASED(M$TAPE00$)");
      164    16819        %B$TCB( STCLASS="BASED(B$TCB$)" );
      165    16822        %B$ALT;
      166    16830        %CODE03( BASED="BASED(CODE03$)" );
      167    16837        %FM$GRAN;
      168    16841
      169    16842        /****************************************/
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:45   
      170    16843
      171    16844    1      TAPEDCB$ = EFTFILE_DCB$;

  16844  9 000002   000000 236000 xsym               LDQ     EFTFILE_DCB$
         9 000003   200003 470500                    LDP0    @TAPEDCB$,,AUTO
         9 000004   000000 756100                    STQ     0,,PR0

      172    16845    1      FPARAM_ = FIT_;

  16845  9 000005   000000 237000 xsym               LDAQ    FIT_
         9 000006   200004 471500                    LDP1    @FPARAM_,,AUTO
         9 000007   100000 757100                    STAQ    0,,PR1

      173    16846    1      ERR = '0'B;

  16846  9 000010   200005 473500                    LDP3    @ERR,,AUTO
         9 000011   300000 450100                    STZ     0,,PR3

      174    16847
      175    16848    2      DO WHILE('1'B);

      176    16849    2         IF NOT F$DCB.FCD#

  16849  9 000012   000000 470400 xsym               LDP0    M$TAPE00$
         9 000013   000031 236100                    LDQ     25,,PR0
         9 000014   020000 316007                    CANQ    8192,DL
         9 000015   000022 601000 9                  TNZ     s:16852

      177    16850    2          THEN CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );
             16850                   /* Open the next tape file */

  16850  9 000016   200005 630500                    EPPR0   @ERR,,AUTO
         9 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000020   000000 701000 xent               TSX1    FLC$TAPE_OPEN
         9 000021   000524 702000 9                  TSX2    JUSTALT

      178    16851
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:46   
      179    16852    3         DO WHILE( ERR.CODE ~= %E$EOF );

  16852  9 000022   200005 470500                    LDP0    @ERR,,AUTO
         9 000023   000000 236100                    LDQ     0,,PR0
         9 000024   377770 376007                    ANQ     131064,DL
         9 000025   000060 116007                    CMPQ    48,DL
         9 000026   000430 600000 9                  TZE     s:16970

      180    16853
      181    16854    4            DO WHILE( BLK_TAG$ >= TAPE_BLOCK_.PTR$ );
             16854                     /* Find the beginning of the next disk file on tape */

  16854  9 000027   000000 236000 xsym               LDQ     BLK_TAG$
         9 000030   000001 116000 xsym               CMPQ    TAPE_BLOCK_+1
         9 000031   000411 602000 9                  TNC     s:16963

      182    16855    4               IF BLK_TAG.BEG

  16855  9 000032   000000 470400 xsym               LDP0    BLK_TAG$
         9 000033   000000 236100                    LDQ     0,,PR0
         9 000034   000400 316007                    CANQ    256,DL
         9 000035   000377 600000 9                  TZE     s:16959

      183    16856    5                THEN DO;

      184    16857
      185    16858    5                  IF NOT FILE_FIN

  16858  9 000036   000000 234000 xsym               SZN     FILE_FIN
         9 000037   000107 604000 9                  TMI     s:16868

      186    16859    6                   THEN DO; /* Say what? The previous file didn't cleanly end    */

      187    16860    6                     ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);

  16860  9 000040   010000 236003                    LDQ     4096,DU
         9 000041   200012 552140                    STBQ    ACCT_NAME,'40'O,AUTO
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:47   

      188    16861    6                     ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;

  16861  9 000042   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 000043   040100 100500                    MLR     fill='040'O
         9 000044   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         9 000045   200012 200010                    ADSC9   ACCT_NAME,,AUTO          cn=1,n=8

      189    16862    6                     CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->

  16862  9 000046   000000 235000 10                 LDA     0
         9 000047   000000 236000 xsym               LDQ     EFTFILE_DCB$
         9 000050   000010 036003                    ADLQ    8,DU
         9 000051   200020 757100                    STAQ    ACCT_NAME+6,,AUTO
         9 000052   000001 235000 10                 LDA     1
         9 000053   200022 452500                    STP2    ACCT_NAME+8,,AUTO
         9 000054   200022 236100                    LDQ     ACCT_NAME+8,,AUTO
         9 000055   000012 036003                    ADLQ    10,DU
         9 000056   200026 757100                    STAQ    ACCT_NAME+12,,AUTO
         9 000057   200020 237100                    LDAQ    ACCT_NAME+6,,AUTO
         9 000060   200024 757100                    STAQ    ACCT_NAME+10,,AUTO
         9 000061   200026 237100                    LDAQ    ACCT_NAME+12,,AUTO
         9 000062   200030 757100                    STAQ    ACCT_NAME+14,,AUTO
         9 000063   200030 633500                    EPPR3   ACCT_NAME+14,,AUTO
         9 000064   200035 453500                    STP3    ACCT_NAME+19,,AUTO
         9 000065   200024 634500                    EPPR4   ACCT_NAME+10,,AUTO
         9 000066   200034 454500                    STP4    ACCT_NAME+18,,AUTO
         9 000067   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000070   000002 235000 10                 LDA     2
         9 000071   200032 757100                    STAQ    ACCT_NAME+16,,AUTO
         9 000072   200032 630500                    EPPR0   ACCT_NAME+16,,AUTO
         9 000073   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 000074   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000075   000000 011000                    NOP     0

      190    16863    6                       F$DCB.NAME#),VECTOR(ACCT_NAME) );
      191    16864    6                     TAPE_BAD = '1'B;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:48   

  16864  9 000076   400000 236003                    LDQ     -131072,DU
         9 000077   000000 756000 xsym               STQ     TAPE_BAD

      192    16865    6                     IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16865  9 000100   000004 236000 xsym               LDQ     FPT_EXIT+4
         9 000101   777000 376003                    ANQ     -512,DU
         9 000102   004000 116003                    CMPQ    2048,DU
         9 000103   000110 603000 9                  TRC     s:16870

      193    16866    6                      THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16866  9 000104   004000 236003                    LDQ     2048,DU
         9 000105   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      194    16867    6                     END;

  16867  9 000106   000110 710000 9                  TRA     s:16870

      195    16868    5                   ELSE FILE_FIN = '0'B;

  16868  9 000107   000000 450000 xsym               STZ     FILE_FIN

      196    16869
      197    16870    5                  ERR = '0'B;

  16870  9 000110   200005 470500                    LDP0    @ERR,,AUTO
         9 000111   000000 450100                    STZ     0,,PR0

      198    16871    5                  CROSSED = ' ';

  16871  9 000112   040000 236003                    LDQ     16384,DU
         9 000113   000000 756000 xsym               STQ     CROSSED

      199    16872    5                  FIT_MISSING = '0'B;

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:49   
  16872  9 000114   200011 450100                    STZ     FIT_MISSING,,AUTO

      200    16873
      201    16874    6                  DO CASE( BLK_TAG.TYPE ); /* ERR setting tells caller what type */

  16874  9 000115   000000 471400 xsym               LDP1    BLK_TAG$
         9 000116   100000 720100                    LXL0    0,,PR1
         9 000117   000077 360003                    ANX0    63,DU
         9 000120   000011 100003                    CMPX0   9,DU
         9 000121   000123 602010 9                  TNC     s:16874+6,X0
         9 000122   000204 710000 9                  TRA     s:16892
         9 000123   000204 710000 9                  TRA     s:16892
         9 000124   000157 710000 9                  TRA     s:16883
         9 000125   000204 710000 9                  TRA     s:16892
         9 000126   000204 710000 9                  TRA     s:16892
         9 000127   000134 710000 9                  TRA     s:16876
         9 000130   000141 710000 9                  TRA     s:16878
         9 000131   000146 710000 9                  TRA     s:16880
         9 000132   000174 710000 9                  TRA     s:16888
         9 000133   000163 710000 9                  TRA     s:16885

      202    16875    6                   CASE( %FILE_DIR );

      203    16876    6                     ERR.CODE = %E$FDEOF;

  16876  9 000134   000000 236100                    LDQ     0,,PR0
         9 000135   000003 376000 10                 ANQ     3
         9 000136   001540 276007                    ORQ     864,DL
         9 000137   000000 756100                    STQ     0,,PR0
         9 000140   000204 710000 9                  TRA     s:16892

      204    16877    6                   CASE( %ACCT_DIR );

      205    16878    6                     ERR.CODE = %E$ADEOF;

  16878  9 000141   000000 236100                    LDQ     0,,PR0
         9 000142   000003 376000 10                 ANQ     3
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:50   
         9 000143   001750 276007                    ORQ     1000,DL
         9 000144   000000 756100                    STQ     0,,PR0
         9 000145   000204 710000 9                  TRA     s:16892

      206    16879    6                   CASE( %DEL_ACCT );

      207    16880    6                     ERR.CODE = %E$NOKEY;

  16880  9 000146   000000 236100                    LDQ     0,,PR0
         9 000147   000003 376000 10                 ANQ     3
         9 000150   001020 276007                    ORQ     528,DL
         9 000151   000000 756100                    STQ     0,,PR0

      208    16881    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;

  16881  9 000152   000000 471400 xsym               LDP1    BLK_TAG$
         9 000153   100002 235100                    LDA     2,,PR1
         9 000154   000000 473400 xsym               LDP3    EFTFILE_DCB$
         9 000155   300035 755100                    STA     29,,PR3
         9 000156   000204 710000 9                  TRA     s:16892

      209    16882    6                   CASE( %DEL_FILE );

      210    16883    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;

  16883  9 000157   100002 235100                    LDA     2,,PR1
         9 000160   000000 473400 xsym               LDP3    EFTFILE_DCB$
         9 000161   300035 755100                    STA     29,,PR3
         9 000162   000204 710000 9                  TRA     s:16892

      211    16884    6                   CASE( %CLEANUP_FILE );

      212    16885    6                     ERR.CODE = %E$NOFILE;

  16885  9 000163   000000 236100                    LDQ     0,,PR0
         9 000164   000003 376000 10                 ANQ     3
         9 000165   001610 276007                    ORQ     904,DL
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:51   
         9 000166   000000 756100                    STQ     0,,PR0

      213    16886    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;

  16886  9 000167   000000 471400 xsym               LDP1    BLK_TAG$
         9 000170   100002 235100                    LDA     2,,PR1
         9 000171   000000 473400 xsym               LDP3    EFTFILE_DCB$
         9 000172   300035 755100                    STA     29,,PR3
         9 000173   000204 710000 9                  TRA     s:16892

      214    16887    6                   CASE( %CLEANUP_ACCT );

      215    16888    6                     ERR.CODE = %E$NOPROC;

  16888  9 000174   000000 236100                    LDQ     0,,PR0
         9 000175   000003 376000 10                 ANQ     3
         9 000176   003520 276007                    ORQ     1872,DL
         9 000177   000000 756100                    STQ     0,,PR0

      216    16889    6                     EFTFILE_DCB$->F$DCB.EXPIRE# = BLK_TAG.UTS;

  16889  9 000200   000000 471400 xsym               LDP1    BLK_TAG$
         9 000201   100002 235100                    LDA     2,,PR1
         9 000202   000000 473400 xsym               LDP3    EFTFILE_DCB$
         9 000203   300035 755100                    STA     29,,PR3

      217    16890    6                   END;

      218    16891
      219    16892    6                  DO CASE( BLK_TAG.TYPE ); /* Make sure FIT is physically there  */

  16892  9 000204   000000 471400 xsym               LDP1    BLK_TAG$
         9 000205   100000 720100                    LXL0    0,,PR1
         9 000206   000077 360003                    ANX0    63,DU
         9 000207   000012 100003                    CMPX0   10,DU
         9 000210   000212 602010 9                  TNC     s:16892+6,X0
         9 000211   000266 710000 9                  TRA     s:16910
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:52   
         9 000212   000224 710000 9                  TRA     s:16894
         9 000213   000266 710000 9                  TRA     s:16910
         9 000214   000224 710000 9                  TRA     s:16894
         9 000215   000224 710000 9                  TRA     s:16894
         9 000216   000224 710000 9                  TRA     s:16894
         9 000217   000224 710000 9                  TRA     s:16894
         9 000220   000266 710000 9                  TRA     s:16910
         9 000221   000266 710000 9                  TRA     s:16910
         9 000222   000266 710000 9                  TRA     s:16910
         9 000223   000224 710000 9                  TRA     s:16894

      220    16893    6                  CASE( %REG_FILE, %FILE_DIR, %ACCT_DIR, %INACTIVE_FILE, %ACUP_FILE, %
             16893                            IDS_FAST_FILE );

      221    16894    6                     FPARAM_.PTR$ = PINCRC( GRAN_BASE$, BLK_TAG.BEGX );

  16894  9 000224   100000 236100                    LDQ     0,,PR1
         9 000225   000022 772000                    QRL     18
         9 000226   000020 736000                    QLS     16
         9 000227   000000 036000 xsym               ADLQ    GRAN_BASE$
         9 000230   200004 473500                    LDP3    @FPARAM_,,AUTO
         9 000231   300001 756100                    STQ     1,,PR3

      222    16895    6                     IF FPARAM_.PTR$ > MAX_FIT$

  16895  9 000232   000000 116000 xsym               CMPQ    MAX_FIT$
         9 000233   000257 602000 9                  TNC     s:16905
         9 000234   000257 600000 9                  TZE     s:16905

      223    16896    7                      THEN DO;

      224    16897    7                        CALL FLI$RPT_ERR( E_FIT_NOT_THERE, );

  16897  9 000235   000004 630400 10                 EPPR0   4
         9 000236   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000237   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000240   000000 011000                    NOP     0
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:53   

      225    16898    7                        TAPE_BAD = '1'B;

  16898  9 000241   400000 236003                    LDQ     -131072,DU
         9 000242   000000 756000 xsym               STQ     TAPE_BAD

      226    16899    7                        IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16899  9 000243   000004 236000 xsym               LDQ     FPT_EXIT+4
         9 000244   777000 376003                    ANQ     -512,DU
         9 000245   004000 116003                    CMPQ    2048,DU
         9 000246   000251 603000 9                  TRC     s:16901

      227    16900    7                         THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16900  9 000247   004000 236003                    LDQ     2048,DU
         9 000250   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      228    16901    7                        FIT_MISSING = '1'B;

  16901  9 000251   400000 236003                    LDQ     -131072,DU
         9 000252   200011 756100                    STQ     FIT_MISSING,,AUTO

      229    16902    7                        BLK_TAG.SIZE = 0;

  16902  9 000253   000000 220003                    LDX0    0,DU
         9 000254   000000 470400 xsym               LDP0    BLK_TAG$
         9 000255   000001 740100                    STX0    1,,PR0

      230    16903    7                        END;

  16903  9 000256   000266 710000 9                  TRA     s:16910

      231    16904    7                      ELSE DO;        /* Skip over FIT to data granules (if any) */

      232    16905    7                        BLK_TAG.BEGX = BLK_TAG.BEGX + 4096;

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:54   
  16905  9 000257   100000 220100                    LDX0    0,,PR1
         9 000260   010000 621010                    EAX1    4096,X0
         9 000261   100000 741100                    STX1    0,,PR1

      233    16906    7                        BLK_TAG.SIZE = BLK_TAG.SIZE - 4096;

  16906  9 000262   000000 471400 xsym               LDP1    BLK_TAG$
         9 000263   100001 220100                    LDX0    1,,PR1
         9 000264   770000 621010                    EAX1    -4096,X0
         9 000265   100001 741100                    STX1    1,,PR1

      234    16907    7                        END;

      235    16908    6                   END;

      236    16909
      237    16910    5                  FILE_FIN = BLK_TAG.FIN;

  16910  9 000266   000000 470400 xsym               LDP0    BLK_TAG$
         9 000267   000000 236100                    LDQ     0,,PR0
         9 000270   000034 736000                    QLS     28
         9 000271   400000 376003                    ANQ     -131072,DU
         9 000272   000000 756000 xsym               STQ     FILE_FIN

      238    16911
      239    16912    5                  IF NOT FIT_MISSING

  16912  9 000273   200011 234100                    SZN     FIT_MISSING,,AUTO
         9 000274   000377 604000 9                  TMI     s:16959

      240    16913    6                   THEN DO;

      241    16914    6                     EFTFILE_DCB$->F$DCB.VOL# = F$DCB.VOL#;

  16914  9 000275   000000 471400 xsym               LDP1    M$TAPE00$
         9 000276   000000 473400 xsym               LDP3    EFTFILE_DCB$
         9 000277   100043 236100                    LDQ     35,,PR1
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:55   
         9 000300   300043 552140                    STBQ    35,'40'O,PR3

      242    16915
      243    16916    7                     DO CASE( BLK_TAG.TYPE ); /* Return item if requested        */

  16916  9 000301   000000 720100                    LXL0    0,,PR0
         9 000302   000077 360003                    ANX0    63,DU
         9 000303   000012 100003                    CMPX0   10,DU
         9 000304   000306 602010 9                  TNC     s:16916+5,X0
         9 000305   000377 710000 9                  TRA     s:16959
         9 000306   000365 710000 9                  TRA     s:16946
         9 000307   000365 710000 9                  TRA     s:16946
         9 000310   000365 710000 9                  TRA     s:16946
         9 000311   000365 710000 9                  TRA     s:16946
         9 000312   000320 710000 9                  TRA     s:16919
         9 000313   000353 710000 9                  TRA     s:16941
         9 000314   000335 710000 9                  TRA     s:16930
         9 000315   000335 710000 9                  TRA     s:16930
         9 000316   000365 710000 9                  TRA     s:16946
         9 000317   000365 710000 9                  TRA     s:16946

      244    16917
      245    16918    7                      CASE( %FILE_DIR );

      246    16919    7                        EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG.WHERE.ACCT;

  16919  9 000320   040100 100500                    MLR     fill='040'O
         9 000321   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8
         9 000322   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8

      247    16920    7                        EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG.WHERE.PSN;

  16920  9 000323   040100 100500                    MLR     fill='040'O
         9 000324   000003 000006                    ADSC9   3,,PR0                   cn=0,n=6
         9 000325   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6

      248    16921    7                        CALL FLC_TAPE_ACCT_CHECK
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:56   

  16921  9 000326   000575 701000 9                  TSX1    FLC_TAPE_ACCT_CHECK
         9 000327   000334 702000 9                  TSX2    s:16927

      249    16922    8                         WHENRETURN DO;

      250    16923    8                           IF DISK_OPTION.DIR

  16923  9 000330   000000 234000 xsym               SZN     DISK_OPTION
         9 000331   000333 605000 9                  TPL     s:16924+1

      251    16924    8                            THEN RETURN;

  16924  9 000332   000000 702200 xent               TSX2  ! X66_ARET
         9 000333   000334 710000 9                  TRA     s:16927

      252    16925    8                           END;
      253    16926    8                         WHENALTRETURN DO;

      254    16927    8                           END;

  16927  9 000334   000377 710000 9                  TRA     s:16959

      255    16928
      256    16929    7                      CASE( %DEL_ACCT, %CLEANUP_ACCT );

      257    16930    7                        EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG.WHERE.ACCT;

  16930  9 000335   040100 100500                    MLR     fill='040'O
         9 000336   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8
         9 000337   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8

      258    16931    7                        EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG.WHERE.PSN;

  16931  9 000340   040100 100500                    MLR     fill='040'O
         9 000341   000003 000006                    ADSC9   3,,PR0                   cn=0,n=6
         9 000342   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:57   

      259    16932    7                        CALL FLC_TAPE_ACCT_CHECK

  16932  9 000343   000575 701000 9                  TSX1    FLC_TAPE_ACCT_CHECK
         9 000344   000352 702000 9                  TSX2    s:16938

      260    16933    8                         WHENRETURN DO;

      261    16934    8                           IF DISK_OPTION.DELETED_ACCOUNTS

  16934  9 000345   000000 236000 xsym               LDQ     DISK_OPTION
         9 000346   200000 316003                    CANQ    65536,DU
         9 000347   000351 600000 9                  TZE     s:16935+1

      262    16935    8                            THEN RETURN;

  16935  9 000350   000000 702200 xent               TSX2  ! X66_ARET
         9 000351   000352 710000 9                  TRA     s:16938

      263    16936    8                           END;
      264    16937    8                         WHENALTRETURN DO;

      265    16938    8                           END;

  16938  9 000352   000377 710000 9                  TRA     s:16959

      266    16939
      267    16940    7                      CASE( %ACCT_DIR );

      268    16941    7                        EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG.WHERE.ACCT;

  16941  9 000353   040100 100500                    MLR     fill='040'O
         9 000354   000004 400010                    ADSC9   4,,PR0                   cn=2,n=8
         9 000355   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8

      269    16942    7                        EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG.WHERE.PSN;

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:58   
  16942  9 000356   040100 100500                    MLR     fill='040'O
         9 000357   000003 000006                    ADSC9   3,,PR0                   cn=0,n=6
         9 000360   300024 000006                    ADSC9   20,,PR3                  cn=0,n=6

      270    16943    7                        IF DISK_OPTION.PAD THEN RETURN;

  16943  9 000361   000000 236000 xsym               LDQ     DISK_OPTION
         9 000362   020000 316003                    CANQ    8192,DU
         9 000363   000377 600000 9                  TZE     s:16959

  16943  9 000364   000000 702200 xent               TSX2  ! X66_ARET

      271    16944
      272    16945    7                      CASE( %INACTIVE_FILE, %REG_FILE, %ACUP_FILE, %DEL_FILE, %
             16945                               CLEANUP_FILE, %IDS_FAST_FILE );

      273    16946    7                        EFTFILE_DCB$->F$DCB.NAME#.C = BLK_TAG.NAME.C;

  16946  9 000365   040100 100500                    MLR     fill='040'O
         9 000366   000003 200037                    ADSC9   3,,PR0                   cn=1,n=31
         9 000367   300010 200037                    ADSC9   8,,PR3                   cn=1,n=31

      274    16947    7                        EFTFILE_DCB$->F$DCB.NAME#.L = BLK_TAG.NAME.L;

  16947  9 000370   000003 236100                    LDQ     3,,PR0
         9 000371   300010 552140                    STBQ    8,'40'O,PR3

      275    16948    7                        EFTFILE_DCB$->F$DCB.DESC = BLK_TAG.DESC;

  16948  9 000372   000001 720100                    LXL0    1,,PR0
         9 000373   300005 440100                    SXL0    5,,PR3

      276    16949    7                        CALL FLC_TAPE_FILE_CHECK

  16949  9 000374   000707 701000 9                  TSX1    FLC_TAPE_FILE_CHECK
         9 000375   000377 702000 9                  TSX2    s:16959

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:59   
      277    16950    8                         WHENRETURN DO;

      278    16951    8                           RETURN;

  16951  9 000376   000000 702200 xent               TSX2  ! X66_ARET

      279    16952    8                           END;
      280    16953    8                         WHENALTRETURN DO;

      281    16954    8                           END;

      282    16955
      283    16956    7                      END;

      284    16957    6                     END;

      285    16958    5                  END;

      286    16959    4               FILE_FIN = BLK_TAG.FIN;

  16959  9 000377   000000 470400 xsym               LDP0    BLK_TAG$
         9 000400   000000 236100                    LDQ     0,,PR0
         9 000401   000034 736000                    QLS     28
         9 000402   400000 376003                    ANQ     -131072,DU
         9 000403   000000 756000 xsym               STQ     FILE_FIN

      287    16960    4               BLK_TAG$ = PINCRW( BLK_TAG$, -SIZEW(BLK_TAG) );

  16960  9 000404   000000 236000 xsym               LDQ     BLK_TAG$
         9 000405   777765 036003                    ADLQ    -11,DU
         9 000406   000000 756000 xsym               STQ     BLK_TAG$

      288    16961    4               END;

  16961  9 000407   000001 116000 xsym               CMPQ    TAPE_BLOCK_+1
         9 000410   000032 603000 9                  TRC     s:16855

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:60   
      289    16962
      290    16963    3            CALL FLC$READ_TAPE_BLOCK( ERR ) ALTRET( JUSTALT );

  16963  9 000411   200005 630500                    EPPR0   @ERR,,AUTO
         9 000412   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000413   000000 701000 xent               TSX1    FLC$READ_TAPE_BLOCK
         9 000414   000524 702000 9                  TSX2    JUSTALT

      291    16964    3            CALL FLC_TAPE_PSN_CHECK

  16964  9 000415   000646 701000 9                  TSX1    FLC_TAPE_PSN_CHECK
         9 000416   000420 702000 9                  TSX2    s:16966
         9 000417   000423 710000 9                  TRA     s:16969

      292    16965    4             WHENALTRETURN DO;

      293    16966    4               BLK_TAG$ = PINCRW( TAPE_BLOCK_.PTR$, -SIZEW(BLK_TAG) );

  16966  9 000420   000001 236000 xsym               LDQ     TAPE_BLOCK_+1
         9 000421   777765 036003                    ADLQ    -11,DU
         9 000422   000000 756000 xsym               STQ     BLK_TAG$

      294    16967    4               END;

      295    16968                                      /* Current file might be continued due to CVOL  */
      296    16969    3            END;

  16969  9 000423   200005 470500                    LDP0    @ERR,,AUTO
         9 000424   000000 236100                    LDQ     0,,PR0
         9 000425   377770 376007                    ANQ     131064,DL
         9 000426   000060 116007                    CMPQ    48,DL
         9 000427   000027 601000 9                  TNZ     s:16854

      297    16970    2         CALL FLC$TAPE_CLOSE( ERR ) ALTRET( JUSTALT );

  16970  9 000430   200005 630500                    EPPR0   @ERR,,AUTO
         9 000431   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:61   
         9 000432   000000 701000 xent               TSX1    FLC$TAPE_CLOSE
         9 000433   000524 702000 9                  TSX2    JUSTALT

      298    16971    2         IF NOT FILE_FIN

  16971  9 000434   000000 234000 xsym               SZN     FILE_FIN
         9 000435   000012 604000 9                  TMI     s:16849

      299    16972    2          THEN IF (CVOL_UTL.NUM# <= 0 AND SUBSTR(F$DCB.RES#,0,2) = 'LT')

  16972  9 000436   000000 235000 xsym               LDA     CVOL_UTL
         9 000437   000444 605400 9                  TPNZ    s:16972+6
         9 000440   000000 470400 xsym               LDP0    M$TAPE00$
         9 000441   000026 220100                    LDX0    22,,PR0
         9 000442   000000 100000 8                  CMPX0   0
         9 000443   000450 600000 9                  TZE     s:16975
         9 000444   000000 470400 xsym               LDP0    M$TAPE00$
         9 000445   000026 220100                    LDX0    22,,PR0
         9 000446   000001 100000 8                  CMPX0   1
         9 000447   000521 601000 9                  TNZ     s:16984

      300    16973    2              OR SUBSTR(F$DCB.RES#,0,2) = 'OD'
      301    16974    3             THEN DO;

      302    16975    3               FILE_FIN = '1'B;

  16975  9 000450   400000 236003                    LDQ     -131072,DU
         9 000451   000000 756000 xsym               STQ     FILE_FIN

      303    16976    3               ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);

  16976  9 000452   010000 236003                    LDQ     4096,DU
         9 000453   200012 552140                    STBQ    ACCT_NAME,'40'O,AUTO

      304    16977    3               ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;

  16977  9 000454   000000 471400 xsym               LDP1    EFTFILE_DCB$
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:62   
         9 000455   040100 100500                    MLR     fill='040'O
         9 000456   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         9 000457   200012 200010                    ADSC9   ACCT_NAME,,AUTO          cn=1,n=8

      305    16978    3               CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.

  16978  9 000460   000000 235000 10                 LDA     0
         9 000461   000000 236000 xsym               LDQ     EFTFILE_DCB$
         9 000462   000010 036003                    ADLQ    8,DU
         9 000463   200020 757100                    STAQ    ACCT_NAME+6,,AUTO
         9 000464   000001 235000 10                 LDA     1
         9 000465   200022 452500                    STP2    ACCT_NAME+8,,AUTO
         9 000466   200022 236100                    LDQ     ACCT_NAME+8,,AUTO
         9 000467   000012 036003                    ADLQ    10,DU
         9 000470   200026 757100                    STAQ    ACCT_NAME+12,,AUTO
         9 000471   200020 237100                    LDAQ    ACCT_NAME+6,,AUTO
         9 000472   200024 757100                    STAQ    ACCT_NAME+10,,AUTO
         9 000473   200026 237100                    LDAQ    ACCT_NAME+12,,AUTO
         9 000474   200030 757100                    STAQ    ACCT_NAME+14,,AUTO
         9 000475   200030 633500                    EPPR3   ACCT_NAME+14,,AUTO
         9 000476   200035 453500                    STP3    ACCT_NAME+19,,AUTO
         9 000477   200024 634500                    EPPR4   ACCT_NAME+10,,AUTO
         9 000500   200034 454500                    STP4    ACCT_NAME+18,,AUTO
         9 000501   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000502   000002 235000 10                 LDA     2
         9 000503   200032 757100                    STAQ    ACCT_NAME+16,,AUTO
         9 000504   200032 630500                    EPPR0   ACCT_NAME+16,,AUTO
         9 000505   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 000506   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000507   000000 011000                    NOP     0

      306    16979    3                 NAME#),VECTOR(ACCT_NAME) );
      307    16980    3               TAPE_BAD = '1'B;

  16980  9 000510   400000 236003                    LDQ     -131072,DU
         9 000511   000000 756000 xsym               STQ     TAPE_BAD

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:63   
      308    16981    3               IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16981  9 000512   000004 236000 xsym               LDQ     FPT_EXIT+4
         9 000513   777000 376003                    ANQ     -512,DU
         9 000514   004000 116003                    CMPQ    2048,DU
         9 000515   000012 603000 9                  TRC     s:16849

      309    16982    3                THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16982  9 000516   004000 236003                    LDQ     2048,DU
         9 000517   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      310    16983    3               END;

  16983  9 000520   000012 710000 9                  TRA     s:16849

      311    16984    2             ELSE CROSSED = '*';

  16984  9 000521   052000 236003                    LDQ     21504,DU
         9 000522   000000 756000 xsym               STQ     CROSSED

      312    16985    2         END;

  16985  9 000523   000012 710000 9                  TRA     s:16849

  16982  9 000524                       JUSTALT      null
      313    16986
      314    16987    1   JUSTALT: ;
      315    16988    1      IF NOT FILE_FIN

  16988  9 000524   000000 234000 xsym               SZN     FILE_FIN
         9 000525   000574 604000 9                  TMI     s:16998

      316    16989    2       THEN DO;

      317    16990    2         ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:64   
  16990  9 000526   010000 236003                    LDQ     4096,DU
         9 000527   200012 552140                    STBQ    ACCT_NAME,'40'O,AUTO

      318    16991    2         ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;

  16991  9 000530   000000 470400 xsym               LDP0    EFTFILE_DCB$
         9 000531   040100 100500                    MLR     fill='040'O
         9 000532   000020 000010                    ADSC9   16,,PR0                  cn=0,n=8
         9 000533   200012 200010                    ADSC9   ACCT_NAME,,AUTO          cn=1,n=8

      319    16992    2         CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.NAME#),

  16992  9 000534   000000 235000 10                 LDA     0
         9 000535   000000 236000 xsym               LDQ     EFTFILE_DCB$
         9 000536   000010 036003                    ADLQ    8,DU
         9 000537   200020 757100                    STAQ    ACCT_NAME+6,,AUTO
         9 000540   000001 235000 10                 LDA     1
         9 000541   200022 452500                    STP2    ACCT_NAME+8,,AUTO
         9 000542   200022 236100                    LDQ     ACCT_NAME+8,,AUTO
         9 000543   000012 036003                    ADLQ    10,DU
         9 000544   200026 757100                    STAQ    ACCT_NAME+12,,AUTO
         9 000545   200020 237100                    LDAQ    ACCT_NAME+6,,AUTO
         9 000546   200024 757100                    STAQ    ACCT_NAME+10,,AUTO
         9 000547   200026 237100                    LDAQ    ACCT_NAME+12,,AUTO
         9 000550   200030 757100                    STAQ    ACCT_NAME+14,,AUTO
         9 000551   200030 631500                    EPPR1   ACCT_NAME+14,,AUTO
         9 000552   200035 451500                    STP1    ACCT_NAME+19,,AUTO
         9 000553   200024 633500                    EPPR3   ACCT_NAME+10,,AUTO
         9 000554   200034 453500                    STP3    ACCT_NAME+18,,AUTO
         9 000555   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000556   000002 235000 10                 LDA     2
         9 000557   200032 757100                    STAQ    ACCT_NAME+16,,AUTO
         9 000560   200032 630500                    EPPR0   ACCT_NAME+16,,AUTO
         9 000561   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 000562   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000563   000000 011000                    NOP     0

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:65   
      320    16993    2           VECTOR(ACCT_NAME) );
      321    16994    2         TAPE_BAD = '1'B;

  16994  9 000564   400000 236003                    LDQ     -131072,DU
         9 000565   000000 756000 xsym               STQ     TAPE_BAD

      322    16995    2         IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16995  9 000566   000004 236000 xsym               LDQ     FPT_EXIT+4
         9 000567   777000 376003                    ANQ     -512,DU
         9 000570   004000 116003                    CMPQ    2048,DU
         9 000571   000574 603000 9                  TRC     s:16998

      323    16996    2          THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16996  9 000572   004000 236003                    LDQ     2048,DU
         9 000573   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      324    16997    2         END;

      325    16998    1      ALTRETURN;

  16998  9 000574   000000 702200 xent               TSX2  ! X66_AALT

      326    16999
      327    17000    1   FLC_TAPE_ACCT_CHECK: PROC ALTRET;

  17000  9 000575   200016 741300       FLC_TAPE_AC* STX1  ! ACCT_NAME+4,,AUTO

      328    17001        /*F*  NAME: FLC_TAPE_ACCT_CHECK
      329    17002              PURPOSE: Determine if current account on tape is to be returned.
      330    17003        */
      331    17004
      332    17005        /********************/
      333    17006
      334    17007    2      SPEC.STOP.ACCT.ACCT# = EFTFILE_DCB$->F$DCB.ACCT#;

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:66   
  17007  9 000576   000000 470400 xsym               LDP0    EFTFILE_DCB$
         9 000577   000020 237100                    LDAQ    16,,PR0
         9 000600   000013 755000 xsym               STA     SPECCHARS+11
         9 000601   000014 756000 xsym               STQ     SPECCHARS+12

      335    17008    2      IF SPEC.STOP.ACCT.ACCT# >= DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#(SPECX)

  17008  9 000602   000000 236000 xsym               LDQ     SPECX
         9 000603   000124 402007                    MPY     84,DL
         9 000604   000000 471400 xsym               LDP1    DISK_FILE_SPEC$
         9 000605   040106 106400                    CMPC    fill='040'O
         9 000606   000013 000010 xsym               ADSC9   SPECCHARS+11             cn=0,n=8
         9 000607   100006 000010                    ADSC9   6,Q,PR1                  cn=0,n=8
         9 000610   000616 602000 9                  TNC     s:17012
         9 000611   040000 106506                    CMPC    fill='040'O
         9 000612   100020 000010                    ADSC9   16,Q,PR1                 cn=0,n=8
         9 000613   000013 000010 xsym               ADSC9   SPECCHARS+11             cn=0,n=8
         9 000614   000616 602000 9                  TNC     s:17012

      336    17009    2        AND SPEC.STOP.ACCT.ACCT# <= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(SPECX)
      337    17010    2       THEN RETURN;

  17010  9 000615   000001 702211                    TSX2  ! 1,X1

      338    17011
      339    17012    3      DO I=0 TO DISK_FILE_SPEC.NBR-1;

  17012  9 000616   200006 450100                    STZ     I,,AUTO
         9 000617   000640 710000 9                  TRA     s:17019+1

      340    17013    3         IF SPEC.STOP.ACCT.ACCT# >= DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#(I)

  17013  9 000620   200006 236100                    LDQ     I,,AUTO
         9 000621   000124 402007                    MPY     84,DL
         9 000622   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
         9 000623   040106 106400                    CMPC    fill='040'O
         9 000624   000013 000010 xsym               ADSC9   SPECCHARS+11             cn=0,n=8
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:67   
         9 000625   000006 000010                    ADSC9   6,Q,PR0                  cn=0,n=8
         9 000626   000637 602000 9                  TNC     s:17019
         9 000627   040000 106506                    CMPC    fill='040'O
         9 000630   000020 000010                    ADSC9   16,Q,PR0                 cn=0,n=8
         9 000631   000013 000010 xsym               ADSC9   SPECCHARS+11             cn=0,n=8
         9 000632   000637 602000 9                  TNC     s:17019

      341    17014    3           AND SPEC.STOP.ACCT.ACCT# <= DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#(I)
      342    17015    4          THEN DO;

      343    17016    4            SPECX = I;

  17016  9 000633   200006 235100                    LDA     I,,AUTO
         9 000634   000000 755000 xsym               STA     SPECX

      344    17017    4            RETURN;

  17017  9 000635   200016 221300                    LDX1  ! ACCT_NAME+4,,AUTO
         9 000636   000001 702211                    TSX2  ! 1,X1

      345    17018    4            END;
      346    17019    3         END;

  17019  9 000637   200006 054100                    AOS     I,,AUTO
         9 000640   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
         9 000641   200006 236100                    LDQ     I,,AUTO
         9 000642   000000 116100                    CMPQ    0,,PR0
         9 000643   000620 604000 9                  TMI     s:17013

      347    17020
      348    17021    2      ALTRETURN;

  17021  9 000644   200016 221300                    LDX1  ! ACCT_NAME+4,,AUTO
         9 000645   000000 702211                    TSX2  ! 0,X1

      349    17022
      350    17023    2   END FLC_TAPE_ACCT_CHECK;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:68   
      351    17024
      352    17025
      353    17026    1   FLC_TAPE_PSN_CHECK: PROC ALTRET;

  17026  9 000646   200016 741300       FLC_TAPE_PS* STX1  ! ACCT_NAME+4,,AUTO

      354    17027        /*F*  NAME: FLC_TAPE_PSN_CHECK
      355    17028              PURPOSE: Determine of current packset on tape is to be returned.
      356    17029        */
      357    17030
      358    17031        /********************/
      359    17032
      360    17033    2      IF DPLIST.NUM# <= 0

  17033  9 000647   000000 470400 xsym               LDP0    DPLIST$
         9 000650   000000 235100                    LDA     0,,PR0
         9 000651   000653 605400 9                  TPNZ    s:17035

      361    17034    2       THEN RETURN;    /* No block can contain files from more than one packset  */

  17034  9 000652   000001 702211                    TSX2  ! 1,X1

      362    17035    2      IF DPLIST.SN#(DPLISTX) = EFTFILE_DCB$->F$DCB.PSN#

  17035  9 000653   000000 236000 xsym               LDQ     DPLISTX
         9 000654   000006 402007                    MPY     6,DL
         9 000655   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 000656   040100 106506                    CMPC    fill='040'O
         9 000657   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
         9 000660   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         9 000661   000663 601000 9                  TNZ     s:17038

      363    17036    2       THEN RETURN;

  17036  9 000662   000001 702211                    TSX2  ! 1,X1

      364    17037
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:69   
      365    17038    3      DO I=0 TO DPLIST.NUM#-1;

  17038  9 000663   200006 450100                    STZ     I,,AUTO
         9 000664   000702 710000 9                  TRA     s:17044+1

      366    17039    3         IF DPLIST.SN#(I) = EFTFILE_DCB$->F$DCB.PSN#

  17039  9 000665   200006 236100                    LDQ     I,,AUTO
         9 000666   000006 402007                    MPY     6,DL
         9 000667   000000 470400 xsym               LDP0    DPLIST$
         9 000670   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 000671   040100 106506                    CMPC    fill='040'O
         9 000672   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
         9 000673   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         9 000674   000701 601000 9                  TNZ     s:17044

      367    17040    4          THEN DO;

      368    17041    4            DPLISTX = I;

  17041  9 000675   200006 235100                    LDA     I,,AUTO
         9 000676   000000 755000 xsym               STA     DPLISTX

      369    17042    4            RETURN;

  17042  9 000677   200016 221300                    LDX1  ! ACCT_NAME+4,,AUTO
         9 000700   000001 702211                    TSX2  ! 1,X1

      370    17043    4            END;
      371    17044    3         END;

  17044  9 000701   200006 054100                    AOS     I,,AUTO
         9 000702   200006 236100                    LDQ     I,,AUTO
         9 000703   000000 116100                    CMPQ    0,,PR0
         9 000704   000665 604000 9                  TMI     s:17039

      372    17045
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:70   
      373    17046    2      ALTRETURN;

  17046  9 000705   200016 221300                    LDX1  ! ACCT_NAME+4,,AUTO
         9 000706   000000 702211                    TSX2  ! 0,X1

      374    17047
      375    17048    2   END FLC_TAPE_PSN_CHECK;
      376    17049
      377    17050    1   FLC_TAPE_FILE_CHECK: PROC ALTRET;

  17050  9 000707   200016 741300       FLC_TAPE_FI* STX1  ! ACCT_NAME+4,,AUTO

      378    17051        /*F*  NAME: FLC_TAPE_FILE_CHECK
      379    17052              PURPOSE: Determine if current file on tape is to be returned.
      380    17053        */
      381    17054
      382    17055        /********************/
      383    17056
      384    17057    2      IF DISK_SRCHCOND.ANYF#

  17057  9 000710   000000 236000 xsym               LDQ     DISK_SRCHCOND
         9 000711   000400 316003                    CANQ    256,DU
         9 000712   000724 601000 9                  TNZ     s:17061
         9 000713   000000 470400 xsym               LDP0    EFTFILE_DCB$
         9 000714   000005 720100                    LXL0    5,,PR0
         9 000715   000000 360000 xsym               ANX0    DISK_SRCHCOND
         9 000716   000724 601000 9                  TNZ     s:17061
         9 000717   000000 220000 xsym               LDX0    DISK_SRCHCOND
         9 000720   001063 601000 9                  TNZ     s:17105
         9 000721   000005 236100                    LDQ     5,,PR0
         9 000722   400000 316007                    CANQ    -131072,DL
         9 000723   001063 601000 9                  TNZ     s:17105

      385    17058    2        OR DISK_SRCHCOND & EFTFILE_DCB$->F$DCB.DESC
      386    17059    2        OR (NOT DISK_SRCHCOND AND NOT EFTFILE_DCB$->F$DCB.DESC.DELF#)
      387    17060    3       THEN DO;

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:71   
      388    17061    3         IF DISK_FILE_SPEC.NBR > 0

  17061  9 000724   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
         9 000725   000000 235100                    LDA     0,,PR0
         9 000726   001005 604400 9                  TMOZ    s:17081

      389    17062    4          THEN DO;

      390    17063    4            SPEC.STOP.ACCT.ACCT# = EFTFILE_DCB$->F$DCB.ACCT#;

  17063  9 000727   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 000730   100020 237100                    LDAQ    16,,PR1
         9 000731   000013 755000 xsym               STA     SPECCHARS+11
         9 000732   000014 756000 xsym               STQ     SPECCHARS+12

      391    17064    4            SPEC.STOP.FILE.L# = EFTFILE_DCB$->F$DCB.NAME#.L;

  17064  9 000733   100010 236100                    LDQ     8,,PR1
         9 000734   000033 772000                    QRL     27
         9 000735   000024 552004 xsym               STBQ    SPECCHARS+20,'04'O

      392    17065    4            SPEC.STOP.FILE.NAME# = EFTFILE_DCB$->F$DCB.NAME#.C;

  17065  9 000736   040000 100500                    MLR     fill='040'O
         9 000737   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31
         9 000740   000015 000037 xsym               ADSC9   SPECCHARS+13             cn=0,n=31

      393    17066    4            IF SPEC.STOP >= DISK_FILE_SPEC.SPEC.START(SPECX)

  17066  9 000741   000000 236000 xsym               LDQ     SPECX
         9 000742   000124 402007                    MPY     84,DL
         9 000743   000106 106400                    CMPC    fill='000'O
         9 000744   000013 000050 xsym               ADSC9   SPECCHARS+11             cn=0,n=40
         9 000745   000006 000050                    ADSC9   6,Q,PR0                  cn=0,n=40
         9 000746   000756 602000 9                  TNC     s:17070
         9 000747   000000 106506                    CMPC    fill='000'O
         9 000750   000020 000050                    ADSC9   16,Q,PR0                 cn=0,n=40
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:72   
         9 000751   000013 000050 xsym               ADSC9   SPECCHARS+11             cn=0,n=40
         9 000752   000756 602000 9                  TNC     s:17070

      394    17067    4              AND SPEC.STOP <= DISK_FILE_SPEC.SPEC.STOP(SPECX)
      395    17068    4             THEN USE_THIS = '1'B;

  17068  9 000753   400000 236003                    LDQ     -131072,DU
         9 000754   200007 756100                    STQ     USE_THIS,,AUTO
         9 000755   001007 710000 9                  TRA     s:17083

      396    17069    5             ELSE DO;

      397    17070    5               USE_THIS = '0'B;

  17070  9 000756   200007 450100                    STZ     USE_THIS,,AUTO

      398    17071    6               DO I=0 TO DISK_FILE_SPEC.NBR-1;

  17071  9 000757   200006 450100                    STZ     I,,AUTO
         9 000760   001001 710000 9                  TRA     s:17078+1

      399    17072    6                  IF SPEC.STOP >= DISK_FILE_SPEC.SPEC.START(I)

  17072  9 000761   200006 236100                    LDQ     I,,AUTO
         9 000762   000124 402007                    MPY     84,DL
         9 000763   000000 470400 xsym               LDP0    DISK_FILE_SPEC$
         9 000764   000106 106400                    CMPC    fill='000'O
         9 000765   000013 000050 xsym               ADSC9   SPECCHARS+11             cn=0,n=40
         9 000766   000006 000050                    ADSC9   6,Q,PR0                  cn=0,n=40
         9 000767   001000 602000 9                  TNC     s:17078
         9 000770   000000 106506                    CMPC    fill='000'O
         9 000771   000020 000050                    ADSC9   16,Q,PR0                 cn=0,n=40
         9 000772   000013 000050 xsym               ADSC9   SPECCHARS+11             cn=0,n=40
         9 000773   001000 602000 9                  TNC     s:17078

      400    17073    6                    AND SPEC.STOP <= DISK_FILE_SPEC.SPEC.STOP(I)
      401    17074    7                   THEN DO;
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:73   

      402    17075    7                     USE_THIS = '1'B;

  17075  9 000774   400000 236003                    LDQ     -131072,DU
         9 000775   200007 756100                    STQ     USE_THIS,,AUTO

      403    17076    7                     SPECX = I;

  17076  9 000776   200006 235100                    LDA     I,,AUTO
         9 000777   000000 755000 xsym               STA     SPECX

      404    17077    7                     END;

      405    17078    6                  END;

  17078  9 001000   200006 054100                    AOS     I,,AUTO
         9 001001   200006 236100                    LDQ     I,,AUTO
         9 001002   000000 116100                    CMPQ    0,,PR0
         9 001003   000761 604000 9                  TMI     s:17072

      406    17079    5               END;

      407    17080    4            END;

  17080  9 001004   001007 710000 9                  TRA     s:17083

      408    17081    3          ELSE USE_THIS = '1'B;            /* No spec means all                  */

  17081  9 001005   400000 236003                    LDQ     -131072,DU
         9 001006   200007 756100                    STQ     USE_THIS,,AUTO

      409    17082
      410    17083    3         IF USE_THIS

  17083  9 001007   200007 234100                    SZN     USE_THIS,,AUTO
         9 001010   001063 605000 9                  TPL     s:17105

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:74   
      411    17084    4          THEN DO;

      412    17085    4            EFTFILE_DCB$->F$DCB.ORG# = 0;

  17085  9 001011   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 001012   000000 236003                    LDQ     0,DU
         9 001013   100032 552140                    STBQ    26,'40'O,PR1

      413    17086    4            IF DISK_CRIT.ORG

  17086  9 001014   000000 236000 xsym               LDQ     DISK_CRIT
         9 001015   200000 316003                    CANQ    65536,DU
         9 001016   001051 600000 9                  TZE     s:17098

      414    17087    5             THEN DO;                      /* Must get ORG from CODE03           */

      415    17088    5               IF BLK_TAG.TYPE = %REG_FILE OR BLK_TAG.TYPE = %ACUP_FILE

  17088  9 001017   000000 473400 xsym               LDP3    BLK_TAG$
         9 001020   300000 236100                    LDQ     0,,PR3
         9 001021   000077 316007                    CANQ    63,DL
         9 001022   001031 600000 9                  TZE     s:17091
         9 001023   300000 236100                    LDQ     0,,PR3
         9 001024   000077 376007                    ANQ     63,DL
         9 001025   000003 116007                    CMPQ    3,DL
         9 001026   001031 600000 9                  TZE     s:17091
         9 001027   000011 116007                    CMPQ    9,DL
         9 001030   001051 601000 9                  TNZ     s:17098

      416    17089    5                 OR BLK_TAG.TYPE = %IDS_FAST_FILE
      417    17090    6                THEN DO;

      418    17091    6                  CODE03$ = PINCRW( FPARAM_.PTR$, SIZEW(FM$GRAN) );

  17091  9 001031   200004 474500                    LDP4    @FPARAM_,,AUTO
         9 001032   400001 236100                    LDQ     1,,PR4
         9 001033   000005 036003                    ADLQ    5,DU
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:75   
         9 001034   200010 756100                    STQ     CODE03$,,AUTO

      419    17092    6                  CALL XSF$LOCCODP( CODE03$, 03 )

  17092  9 001035   000005 236000 10                 LDQ     5
         9 001036   200021 756100                    STQ     ACCT_NAME+7,,AUTO
         9 001037   200010 635500                    EPPR5   CODE03$,,AUTO
         9 001040   200020 455500                    STP5    ACCT_NAME+6,,AUTO
         9 001041   200020 630500                    EPPR0   ACCT_NAME+6,,AUTO
         9 001042   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001043   000000 701000 xent               TSX1    XSF$LOCCODP
         9 001044   001051 702000 9                  TSX2    s:17098

      420    17093    7                   WHENRETURN DO;

      421    17094    7                     EFTFILE_DCB$->F$DCB.ORG# = CODE03.ORG;

  17094  9 001045   200010 470500                    LDP0    CODE03$,,AUTO
         9 001046   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 001047   000000 236100                    LDQ     0,,PR0
         9 001050   100032 552140                    STBQ    26,'40'O,PR1

      422    17095    7                     END;

      423    17096    6                  END;

      424    17097    5               END;

      425    17098    4            CALL FLC$CRIT_CHECK( EFTFILE_DCB$, FPARAM_.PTR$ )

  17098  9 001051   200004 236100                    LDQ     @FPARAM_,,AUTO
         9 001052   000001 036003                    ADLQ    1,DU
         9 001053   000006 235000 10                 LDA     6
         9 001054   200020 757100                    STAQ    ACCT_NAME+6,,AUTO
         9 001055   200020 630500                    EPPR0   ACCT_NAME+6,,AUTO
         9 001056   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 001057   000000 701000 xent               TSX1    FLC$CRIT_CHECK
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:76   
         9 001060   001063 702000 9                  TSX2    s:17105

      426    17099    5             WHENRETURN DO;

      427    17100    5               RETURN;

  17100  9 001061   200016 221300                    LDX1  ! ACCT_NAME+4,,AUTO
         9 001062   000001 702211                    TSX2  ! 1,X1

      428    17101    5               END;
      429    17102    4            END;

      430    17103    3         END;

      431    17104
      432    17105    2      ALTRETURN;

  17105  9 001063   200016 221300                    LDX1  ! ACCT_NAME+4,,AUTO
         9 001064   000000 702211                    TSX2  ! 0,X1
      433    17106
      434    17107    2   END FLC_TAPE_FILE_CHECK;
      435    17108
      436    17109    1   END FLC$TAPE_OPEN_NEXT;
      437    17110        %EOD;

PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:77   
--  Include file information  --

   FM$GRAN.:E05TOU  is referenced.
   FM$FIT.:E05TOU  is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLC$TAPE_OPEN_NEXT.
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:78   

 **** Variables and constants ****

  ****  Section 002  Data  FLC$TAPE_OPEN_NEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/d STRC(360)   r     1 DEL_NODATA_REC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ERR                       4-0-0/w PTR         r     1 @FPARAM_
     3-0-0/w PTR         r     1 @TAPEDCB$                 12-0-0/c STRC(81)    r     1 ACCT_NAME
    10-0-0/w PTR         r     1 CODE03$                   *0-0-0/w STRC        r     1 ERR
    11-0-0/b BIT         r     1 FIT_MISSING               *0-0-0/d STRC(72)    r     1 FPARAM_
     6-0-0/w SBIN        r     1 I                         *0-0-0/w PTR         r     1 TAPEDCB$
     7-0-0/b BIT         r     1 USE_THIS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 BACKUP_NAME                0-0-0/w PTR         r     1 BLK_TAG$
     0-0-0/w PTR         r     1 BLK_TAG0$                  0-0-0/w PTR         r     1 BLOCK_GRAN$
     0-0-0/c CHAR        r     1 CROSSED                    0-0-0/d STRC(756)   r     1 CVOL_UTL
     0-0-0/b STRC(3)     r     1 DISK_CRIT                  0-0-0/w PTR         r     1 DISK_FILE_SPEC$
     0-0-0/w PTR         r     1 DISK_GRAN$                 0-0-0/w STRC(145)   r     1 DISK_OPTION
     0-0-0/b STRC(18)    r     1 DISK_SRCHCOND              0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w SBIN        r     1 DPLISTX                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/c ASTR(9)     r     1 DUAL_FILE                  0-0-0/w PTR         r     1 EFTFILE_DCB$
     0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE              0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE
     0-0-0/w STRC        r     1 E_FIT_NOT_THERE            0-0-0/w STRC        r     1 E_PARTIAL_FILE
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:79   
     0-0-0/b BIT         r     1 FILE_FIN                   0-0-0/d STRC(72)    r     1 FIT_
     0-0-0/d STRC(216)   r     1 FPT_EXIT                   0-0-0/w PTR         r     1 GRAN_BASE$
     0-0-0/w PTR         r     1 M$TAPE00$                  0-0-0/w PTR         r     1 MAX_FIT$
     0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE          0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME
     0-0-0/c STRC(369)   r     1 NODATA_KEY                 0-0-0/c ASTR(9)     r     1 PRIME_FILE
     0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY            0-0-0/c ASTR(9)     r     1 REBUILD_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_NAME               0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/w STRC(756)   r     1 SPEC
     0-0-0/w CHAR(84)    r     1 SPECCHARS                  0-0-0/w SBIN        r     1 SPECX
     0-0-0/b BIT         r     1 TAPE_BAD                   0-0-0/d STRC(72)    r     1 TAPE_BLOCK_
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)   r     1 BLK_TAG                    0-0-0/w STRC(324)   r     1 CODE03
     0-0-0/w STRC(936)   r     1 DISK_FILE_SPEC             0-0-0/d STRC(90)    r     1 DPLIST
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(180)   r     1 FM$GRAN
     0-0-0N  NULL        r     1 M$NODATA_LIST


   Procedure FLC$TAPE_OPEN_NEXT requires 565 words for executable code.
   Procedure FLC$TAPE_OPEN_NEXT requires 30 words of local(AUTO) storage.
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:80   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:81   
          MINI XREF LISTING

ACCT_NAME
     16754**DCL     16862--CALL    16978--CALL    16992--CALL
ACCT_NAME.L#
     16754**DCL     16860<<ASSIGN  16976<<ASSIGN  16990<<ASSIGN
ACCT_NAME.NAME#
     16754**DCL     16860--ASSIGN  16861<<ASSIGN  16976--ASSIGN  16977<<ASSIGN  16990--ASSIGN  16991<<ASSIGN
ARCHIVE_NAME.L#
     15509**DCL     15509--IMP-SIZ
B$ALT.CODE
     16824**DCL     16824--REDEF   16825--REDEF   16825--REDEF
B$ALT.ERR.ERR#
     16826**DCL     16826--REDEF
B$ALT.EVID
     16825**DCL     16825--REDEF   16825--REDEF
B$TCB$
     14134**DCL     16820--IMP-PTR
BACKUP_NAME.L#
     15153**DCL     15153--IMP-SIZ
BLK_TAG
     14642**DCL     16960--ASSIGN  16966--ASSIGN
BLK_TAG.BEG
     14644**DCL     16855>>IF
BLK_TAG.BEGX
     14644**DCL     16894>>ASSIGN  16905<<ASSIGN  16905>>ASSIGN
BLK_TAG.DESC
     14644**DCL     16948>>ASSIGN
BLK_TAG.FIN
     14644**DCL     16910>>ASSIGN  16959>>ASSIGN
BLK_TAG.NAME
     14645**DCL     14645--REDEF
BLK_TAG.NAME.C
     14645**DCL     16946>>ASSIGN
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:82   
BLK_TAG.NAME.L
     14645**DCL     16947>>ASSIGN
BLK_TAG.SIZE
     14644**DCL     16902<<ASSIGN  16906<<ASSIGN  16906>>ASSIGN
BLK_TAG.TYPE
     14644**DCL     16874>>DOCASE  16892>>DOCASE  16916>>DOCASE  17088>>IF      17088>>IF      17088>>IF
BLK_TAG.UTS
     14645**DCL     16881>>ASSIGN  16883>>ASSIGN  16886>>ASSIGN  16889>>ASSIGN
BLK_TAG.WHERE.ACCT
     14645**DCL     16919>>ASSIGN  16930>>ASSIGN  16941>>ASSIGN
BLK_TAG.WHERE.PSN
     14645**DCL     16920>>ASSIGN  16931>>ASSIGN  16942>>ASSIGN
BLK_TAG$
     14642**DCL     14642--IMP-PTR 16854>>DOWHILE 16855>>IF      16874>>DOCASE  16881>>ASSIGN  16883>>ASSIGN
     16886>>ASSIGN  16889>>ASSIGN  16892>>DOCASE  16894>>ASSIGN  16902>>ASSIGN  16905>>ASSIGN  16905>>ASSIGN
     16906>>ASSIGN  16906>>ASSIGN  16910>>ASSIGN  16916>>DOCASE  16919>>ASSIGN  16920>>ASSIGN  16930>>ASSIGN
     16931>>ASSIGN  16941>>ASSIGN  16942>>ASSIGN  16946>>ASSIGN  16947>>ASSIGN  16948>>ASSIGN  16959>>ASSIGN
     16960<<ASSIGN  16960>>ASSIGN  16966<<ASSIGN  17088>>IF      17088>>IF      17088>>IF
BLK_TAG0.NAME
     14651**DCL     14651--REDEF
BLK_TAG0$
     14648**DCL     14648--IMP-PTR
BLOCK_GRAN$
     14655**DCL     14656--IMP-PTR
CLOSE_NODATA_LIST.SN_
     16307**DCL     16307--REDEF
CLOSE_NODATA_LIST.UTL_
     16308**DCL     16308--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
     16322**DCL     16322--REDEF
CLOSE_NODATA_LIST.V.TYPE#
     16320**DCL     16320--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
     16317**DCL     16317--REDEF   16319--REDEF
CLOSE_PRIME_DUAL.SN_
     15784**DCL     15784--REDEF
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:83   
CLOSE_PRIME_DUAL.UTL_
     15785**DCL     15785--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
     15799**DCL     15799--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
     15797**DCL     15797--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
     15794**DCL     15794--REDEF   15796--REDEF
CLOSE_REBUILD.SN_
     16059**DCL     16059--REDEF
CLOSE_REBUILD.UTL_
     16060**DCL     16060--REDEF
CLOSE_REBUILD.V.EXPIRE#
     16074**DCL     16074--REDEF
CLOSE_REBUILD.V.TYPE#
     16072**DCL     16072--REDEF
CLOSE_REBUILD.V.XTNSIZE#
     16069**DCL     16069--REDEF   16071--REDEF
CLOSE_STATUS.SN_
     15274**DCL     15274--REDEF
CLOSE_STATUS.UTL_
     15275**DCL     15275--REDEF
CLOSE_STATUS.V.EXPIRE#
     15289**DCL     15289--REDEF
CLOSE_STATUS.V.TYPE#
     15287**DCL     15287--REDEF
CLOSE_STATUS.V.XTNSIZE#
     15284**DCL     15284--REDEF   15286--REDEF
CLOSE_TSN_USED.SN_
     14984**DCL     14984--REDEF
CLOSE_TSN_USED.UTL_
     14985**DCL     14985--REDEF
CLOSE_TSN_USED.V.EXPIRE#
     14999**DCL     14999--REDEF
CLOSE_TSN_USED.V.TYPE#
     14997**DCL     14997--REDEF
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:84   
CLOSE_TSN_USED.V.XTNSIZE#
     14994**DCL     14994--REDEF   14996--REDEF
CODE03.ORG
     16831**DCL     17094>>ASSIGN
CODE03$
     16725**DCL     16831--IMP-PTR 17091<<ASSIGN  17092<>CALL    17094>>ASSIGN
CON_CLOSE_ARCHIVE.SN_
     15316**DCL     15316--REDEF
CON_CLOSE_ARCHIVE.UTL_
     15317**DCL     15317--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
     15331**DCL     15331--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
     15329**DCL     15329--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
     15326**DCL     15326--REDEF   15328--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
     15403**DCL     15404--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
     15409**DCL     15410--REDEF   15410--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
     15408**DCL     15409--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
     15407**DCL     15408--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
     15401**DCL     15402--REDEF   15402--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
     15441**DCL     15441--REDEF   15441--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
     15407**DCL     15407--REDEF
CON_READ_ARCHIVE_FILE.STATION_
     15465**DCL     15466--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
     15477**DCL     15477--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
     15475**DCL     15475--REDEF
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:85   
CROSSED
     14677**DCL     16871<<ASSIGN  16984<<ASSIGN
CVOL_UTL.NUM#
     14744**DCL     16972>>IF
CVOL_UTL.ULBL#
     14744**DCL     14744--REDEF
DEL_NODATA_REC.V
     16410**DCL     16407--DCLINIT
DISK_CLOSE.SN_
     13814**DCL     13814--REDEF
DISK_CLOSE.UTL_
     13815**DCL     13815--REDEF
DISK_CLOSE.V.EXPIRE#
     13829**DCL     13829--REDEF
DISK_CLOSE.V.TYPE#
     13827**DCL     13827--REDEF
DISK_CLOSE.V.XTNSIZE#
     13824**DCL     13824--REDEF   13826--REDEF
DISK_CRIT.ORG
     14197**DCL     17086>>IF
DISK_FILE_SPEC.NBR
     14179**DCL     17012>>DOINDEX 17061>>IF      17071>>DOINDEX
DISK_FILE_SPEC.SPEC
     14179**DCL     14181--REDEF
DISK_FILE_SPEC.SPEC.START
     14180**DCL     14180--REDEF   17066>>IF      17072>>IF
DISK_FILE_SPEC.SPEC.START.ACCT.ACCT#
     14180**DCL     17008>>IF      17013>>IF
DISK_FILE_SPEC.SPEC.STOP
     14181**DCL     14181--REDEF   17066>>IF      17072>>IF
DISK_FILE_SPEC.SPEC.STOP.ACCT.ACCT#
     14181**DCL     17008>>IF      17013>>IF
DISK_FILE_SPEC$
     14178**DCL     14179--IMP-PTR 17008>>IF      17008>>IF      17012>>DOINDEX 17013>>IF      17013>>IF
     17061>>IF      17066>>IF      17066>>IF      17071>>DOINDEX 17072>>IF      17072>>IF
DISK_GRAN$
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:86   
     14655**DCL     14655--IMP-PTR
DISK_OPEN.ACSVEH_
     13679**DCL     13680--REDEF
DISK_OPEN.ALTKEYS_
     13685**DCL     13686--REDEF   13686--REDEF
DISK_OPEN.HDR_
     13684**DCL     13685--REDEF
DISK_OPEN.TAB_
     13683**DCL     13684--REDEF
DISK_OPEN.UHL_
     13677**DCL     13678--REDEF   13678--REDEF
DISK_OPEN.V.FSN#
     13717**DCL     13717--REDEF   13717--REDEF
DISK_OPEN.WSN_
     13683**DCL     13683--REDEF
DISK_OPTION.DELETED_ACCOUNTS
     14191**DCL     16934>>IF
DISK_OPTION.DIR
     14191**DCL     16923>>IF
DISK_OPTION.PAD
     14192**DCL     16943>>IF
DISK_READ.STATION_
     13741**DCL     13742--REDEF
DISK_READ.V.DVBYTE.REREAD#
     13753**DCL     13753--REDEF
DISK_READ.V.INDX#
     13751**DCL     13751--REDEF
DISK_SRCHCOND
     14184**DCL     17057>>IF      17057>>IF
DISK_SRCHCOND.ANYF#
     14185**DCL     17057>>IF
DISK_WRITE.STATION_
     13779**DCL     13779--REDEF
DISK_WRITE.V.DVBYTE.VFC#
     13786**DCL     13786--REDEF
DPLIST.NUM#
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:87   
     14176**DCL     17033>>IF      17038>>DOINDEX
DPLIST.SN#
     14176**DCL     17035>>IF      17039>>IF
DPLIST$
     14164**DCL     14176--IMP-PTR 17033>>IF      17035>>IF      17038>>DOINDEX 17039>>IF
DPLISTX
     14300**DCL     17035>>IF      17041<<ASSIGN
DPRESLIST$
     14178**DCL     14178--IMP-PTR
DUAL_FILE.L#
     15580**DCL     15580--IMP-SIZ
EFTFILE_DCB$
     14677**DCL     16844>>ASSIGN  16861>>ASSIGN  16862>>CALL    16881>>ASSIGN  16883>>ASSIGN  16886>>ASSIGN
     16889>>ASSIGN  16914>>ASSIGN  16919>>ASSIGN  16920>>ASSIGN  16930>>ASSIGN  16931>>ASSIGN  16941>>ASSIGN
     16942>>ASSIGN  16946>>ASSIGN  16947>>ASSIGN  16948>>ASSIGN  16977>>ASSIGN  16978>>CALL    16991>>ASSIGN
     16992>>CALL    17007>>ASSIGN  17035>>IF      17039>>IF      17057>>IF      17057>>IF      17063>>ASSIGN
     17064>>ASSIGN  17065>>ASSIGN  17085>>ASSIGN  17094>>ASSIGN  17098<>CALL
EFTWORD
     14299**DCL     14299--REDEF
EFT_CVOL_FILE.L#
     14704**DCL     14704--IMP-SIZ
EFT_RESTRICT_FILE.L#
     14731**DCL     14731--IMP-SIZ
ERR
        15**DCL         6--PROC    16846<<ASSIGN  16850<>CALL    16870<<ASSIGN  16963<>CALL    16970<>CALL
ERR.CODE
        19**DCL     16852>>DOWHILE 16876<<ASSIGN  16878<<ASSIGN  16880<<ASSIGN  16885<<ASSIGN  16888<<ASSIGN
E_FIT_NOT_THERE
      8849**DCL     16897<>CALL
E_PARTIAL_FILE
      8759**DCL     16862<>CALL    16978<>CALL    16992<>CALL
F$DCB.ACCT#
     16779**DCL     16861>>ASSIGN  16919<<ASSIGN  16930<<ASSIGN  16941<<ASSIGN  16977>>ASSIGN  16991>>ASSIGN
     17007>>ASSIGN  17063>>ASSIGN
F$DCB.ACTPOS
     16795**DCL     16795--REDEF
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:88   
F$DCB.ARS#
     16769**DCL     16769--REDEF
F$DCB.ATTR
     16788**DCL     16789--REDEF
F$DCB.BORROW
     16803**DCL     16803--REDEF   16803--REDEF   16803--REDEF
F$DCB.DCBNAME.L
     16817**DCL     16817--IMP-SIZ
F$DCB.DESC
     16776**DCL     16948<<ASSIGN  17057>>IF
F$DCB.DESC.DELF#
     16776**DCL     17057>>IF
F$DCB.EOMCHAR#
     16773**DCL     16773--REDEF
F$DCB.EXPIRE#
     16786**DCL     16881<<ASSIGN  16883<<ASSIGN  16886<<ASSIGN  16889<<ASSIGN
F$DCB.FCD#
     16782**DCL     16849>>IF
F$DCB.FLDID
     16798**DCL     16798--REDEF
F$DCB.FORM$
     16792**DCL     16792--REDEF
F$DCB.FSECT
     16808**DCL     16808--REDEF
F$DCB.FSN#
     16785**DCL     16785--REDEF   16785--REDEF   16786--REDEF
F$DCB.HEADER$
     16791**DCL     16791--REDEF
F$DCB.IXTNSIZE#
     16789**DCL     16789--REDEF
F$DCB.LASTSTA$
     16778**DCL     16778--REDEF
F$DCB.LVL
     16804**DCL     16804--REDEF
F$DCB.NAME#
     16779**DCL     16862--CALL    16978--CALL    16992--CALL
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:89   
F$DCB.NAME#.C
     16779**DCL     16779--REDEF   16946<<ASSIGN  17065>>ASSIGN
F$DCB.NAME#.L
     16779**DCL     16947<<ASSIGN  17064>>ASSIGN
F$DCB.NOEOF
     16801**DCL     16801--REDEF
F$DCB.NRECS#
     16790**DCL     16790--REDEF
F$DCB.NRECX
     16809**DCL     16809--REDEF
F$DCB.OHDR
     16801**DCL     16801--REDEF
F$DCB.ORG#
     16784**DCL     16784--REDEF   17085<<ASSIGN  17094<<ASSIGN
F$DCB.PRECNO
     16807**DCL     16807--REDEF
F$DCB.PSN#
     16779**DCL     16920<<ASSIGN  16931<<ASSIGN  16942<<ASSIGN  17035>>IF      17039>>IF
F$DCB.RCSZ
     16813**DCL     16813--REDEF
F$DCB.RES#
     16780**DCL     16780--REDEF   16972>>IF      16972>>IF
F$DCB.SETX
     16792**DCL     16792--REDEF
F$DCB.TAB$
     16792**DCL     16792--REDEF
F$DCB.TDA
     16806**DCL     16807--REDEF
F$DCB.VOL#
     16790**DCL     16914<<ASSIGN  16914>>ASSIGN
F$DCB.WSN#
     16780**DCL     16780--REDEF
FILE_FIN
     14747**DCL     16858>>IF      16868<<ASSIGN  16910<<ASSIGN  16959<<ASSIGN  16971>>IF      16975<<ASSIGN
     16988>>IF
FIT_
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:90   
     14673**DCL     16845>>ASSIGN
FIT_AREA.W2
     15015**DCL     15016--REDEF
FIT_MISSING
     16726**DCL     16872<<ASSIGN  16901<<ASSIGN  16912>>IF
FLC$CRIT_CHECK
     16712**DCL-ENT 17098--CALL
FLC$READ_TAPE_BLOCK
     16713**DCL-ENT 16963--CALL
FLC$TAPE_CLOSE
     16715**DCL-ENT 16970--CALL
FLC$TAPE_OPEN
     16714**DCL-ENT 16850--CALL
FLC_TAPE_ACCT_CHECK
     17000**PROC    16921--CALL    16932--CALL
FLC_TAPE_FILE_CHECK
     17050**PROC    16949--CALL
FLC_TAPE_PSN_CHECK
     17026**PROC    16964--CALL
FLI$RPT_ERR
     16716**DCL-ENT 16862--CALL    16897--CALL    16978--CALL    16992--CALL
FM$GRAN
     16838**DCL     17091--ASSIGN
FPARAM_
        12**DCL         6--PROC    16845<<ASSIGN
FPARAM_.PTR$
        14**DCL     16894<<ASSIGN  16895>>IF      17091>>ASSIGN  17098<>CALL
FPT_EXIT.V.STEPCC#
     13604**DCL     13604--REDEF   16865>>IF      16866<<ASSIGN  16899>>IF      16900<<ASSIGN  16981>>IF
     16982<<ASSIGN  16995>>IF      16996<<ASSIGN
GRAN_BASE$
     14673**DCL     16894>>ASSIGN
I
     16723**DCL     17012<<DOINDEX 17013>>IF      17013>>IF      17016>>ASSIGN  17038<<DOINDEX 17039>>IF
     17041>>ASSIGN  17071<<DOINDEX 17072>>IF      17072>>IF      17076>>ASSIGN
JUSTALT
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:91   
     16982**LABEL   16850--CALLALT 16963--CALLALT 16970--CALLALT
M$TAPE00$
     14641**DCL     16763--IMP-PTR 16849>>IF      16914>>ASSIGN  16972>>IF      16972>>IF
MAX_FIT$
     14747**DCL     16895>>IF
NBR_BYTES_TO_MOVE
     14654**DCL     14655--IMP-SIZ 14656--IMP-SIZ
NODATA_FILE_NAME.L#
     16269**DCL     16269--IMP-SIZ
NODATA_KEY
     16415**DCL     16407--DCLINIT 16408--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
     16202**DCL     16203--REDEF
OPEN_NODATA_LIST.ALTKEYS_
     16208**DCL     16209--REDEF   16209--REDEF
OPEN_NODATA_LIST.HDR_
     16207**DCL     16208--REDEF
OPEN_NODATA_LIST.TAB_
     16206**DCL     16207--REDEF
OPEN_NODATA_LIST.UHL_
     16200**DCL     16201--REDEF   16201--REDEF
OPEN_NODATA_LIST.V.FSN#
     16240**DCL     16240--REDEF   16240--REDEF
OPEN_NODATA_LIST.WSN_
     16206**DCL     16206--REDEF
OPEN_PRIME_DUAL.ACSVEH_
     15649**DCL     15650--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
     15655**DCL     15656--REDEF   15656--REDEF
OPEN_PRIME_DUAL.HDR_
     15654**DCL     15655--REDEF
OPEN_PRIME_DUAL.TAB_
     15653**DCL     15654--REDEF
OPEN_PRIME_DUAL.UHL_
     15647**DCL     15648--REDEF   15648--REDEF
OPEN_PRIME_DUAL.V.FSN#
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:92   
     15687**DCL     15687--REDEF   15687--REDEF
OPEN_PRIME_DUAL.WSN_
     15653**DCL     15653--REDEF
OPEN_REBUILD.ACSVEH_
     15884**DCL     15885--REDEF
OPEN_REBUILD.ALTKEYS_
     15890**DCL     15891--REDEF   15891--REDEF
OPEN_REBUILD.HDR_
     15889**DCL     15890--REDEF
OPEN_REBUILD.TAB_
     15888**DCL     15889--REDEF
OPEN_REBUILD.UHL_
     15882**DCL     15883--REDEF   15883--REDEF
OPEN_REBUILD.V.FSN#
     15922**DCL     15922--REDEF   15922--REDEF
OPEN_REBUILD.WSN_
     15888**DCL     15888--REDEF
OPEN_STATUS.ACSVEH_
     15086**DCL     15087--REDEF
OPEN_STATUS.ALTKEYS_
     15092**DCL     15093--REDEF   15093--REDEF
OPEN_STATUS.HDR_
     15091**DCL     15092--REDEF
OPEN_STATUS.TAB_
     15090**DCL     15091--REDEF
OPEN_STATUS.UHL_
     15084**DCL     15085--REDEF   15085--REDEF
OPEN_STATUS.V.FSN#
     15124**DCL     15124--REDEF   15124--REDEF
OPEN_STATUS.WSN_
     15090**DCL     15090--REDEF
OPEN_TSN_USED.ACSVEH_
     14822**DCL     14823--REDEF
OPEN_TSN_USED.ALTKEYS_
     14828**DCL     14829--REDEF   14829--REDEF
OPEN_TSN_USED.HDR_
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:93   
     14827**DCL     14828--REDEF
OPEN_TSN_USED.TAB_
     14826**DCL     14827--REDEF
OPEN_TSN_USED.UHL_
     14820**DCL     14821--REDEF   14821--REDEF
OPEN_TSN_USED.V.FSN#
     14860**DCL     14860--REDEF   14860--REDEF
OPEN_TSN_USED.WSN_
     14826**DCL     14826--REDEF
PRE_RET_CLOSE.SN_
     14542**DCL     14542--REDEF
PRE_RET_CLOSE.UTL_
     14543**DCL     14543--REDEF
PRE_RET_CLOSE.V.EXPIRE#
     14557**DCL     14557--REDEF
PRE_RET_CLOSE.V.TYPE#
     14555**DCL     14555--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
     14552**DCL     14552--REDEF   14554--REDEF
PRE_RET_OPEN.ACSVEH_
     14477**DCL     14478--REDEF
PRE_RET_OPEN.ALTKEYS_
     14483**DCL     14484--REDEF   14484--REDEF
PRE_RET_OPEN.HDR_
     14482**DCL     14483--REDEF
PRE_RET_OPEN.TAB_
     14481**DCL     14482--REDEF
PRE_RET_OPEN.UHL_
     14475**DCL     14476--REDEF   14476--REDEF
PRE_RET_OPEN.V.FSN#
     14515**DCL     14515--REDEF   14515--REDEF
PRE_RET_OPEN.WSN_
     14481**DCL     14481--REDEF
PRE_RET_READ.STATION_
     14332**DCL     14333--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:94   
     14344**DCL     14344--REDEF
PRE_RET_READ.V.INDX#
     14342**DCL     14342--REDEF
PRE_RET_WRITE.STATION_
     14370**DCL     14370--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
     14377**DCL     14377--REDEF
PRIME_FILE.L#
     15553**DCL     15553--IMP-SIZ
READ_NODATA_LIST.STATION_
     16346**DCL     16347--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
     16358**DCL     16358--REDEF
READ_NODATA_LIST.V.INDX#
     16356**DCL     16356--REDEF
READ_PRIME_DUAL.STATION_
     15711**DCL     15712--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
     15723**DCL     15723--REDEF
READ_PRIME_DUAL.V.INDX#
     15721**DCL     15721--REDEF
READ_REBUILD.STATION_
     16017**DCL     16018--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
     16029**DCL     16029--REDEF
READ_REBUILD.V.INDX#
     16027**DCL     16027--REDEF
READ_STATUS.STATION_
     15232**DCL     15233--REDEF
READ_STATUS.V.DVBYTE.REREAD#
     15244**DCL     15244--REDEF
READ_STATUS.V.INDX#
     15242**DCL     15242--REDEF
READ_TSN_USED.STATION_
     14942**DCL     14943--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:95   
     14954**DCL     14954--REDEF
READ_TSN_USED.V.INDX#
     14952**DCL     14952--REDEF
REBUILD_DIR_KEY.L#
     16103**DCL     16103--IMP-SIZ
REBUILD_KEY.L#
     16130**DCL     16130--IMP-SIZ
REBUILD_NAME.L#
     15951**DCL     15951--IMP-SIZ
RET_CMDS_NAME.L#
     14586**DCL     14586--IMP-SIZ
SNVECLIST$
     14118**DCL     14118--IMP-PTR
SPEC.START
     14182**DCL     14183--REDEF
SPEC.STOP
     14183**DCL     14184--REDEF   17066>>IF      17066>>IF      17072>>IF      17072>>IF
SPEC.STOP.ACCT.ACCT#
     14183**DCL     17007<<ASSIGN  17008>>IF      17008>>IF      17013>>IF      17013>>IF      17063<<ASSIGN
SPEC.STOP.FILE.L#
     14184**DCL     17064<<ASSIGN
SPEC.STOP.FILE.NAME#
     14183**DCL     17065<<ASSIGN
SPECCHARS
     14182**DCL     14182--REDEF
SPECX
     14300**DCL     17008>>IF      17008>>IF      17016<<ASSIGN  17066>>IF      17066>>IF      17076<<ASSIGN
TAPEDCB$
        11**DCL         6--PROC    16844<<ASSIGN
TAPE_BAD
     14749**DCL     16864<<ASSIGN  16898<<ASSIGN  16980<<ASSIGN  16994<<ASSIGN
TAPE_BLOCK_.PTR$
     14671**DCL     16854>>DOWHILE 16966>>ASSIGN
TAPE_BLOCK_.W2
     14670**DCL     14671--REDEF
TAPE_CLOSE.SN_
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:96   
     14035**DCL     14035--REDEF
TAPE_CLOSE.UTL_
     14036**DCL     14036--REDEF
TAPE_CLOSE.V.EXPIRE#
     14050**DCL     14050--REDEF
TAPE_CLOSE.V.TYPE#
     14048**DCL     14048--REDEF
TAPE_CLOSE.V.XTNSIZE#
     14045**DCL     14045--REDEF   14047--REDEF
TAPE_DCBLIST$
     13591**DCL     13591--IMP-PTR
TAPE_OPEN.ACSVEH_
     13900**DCL     13901--REDEF
TAPE_OPEN.ALTKEYS_
     13906**DCL     13907--REDEF   13907--REDEF
TAPE_OPEN.HDR_
     13905**DCL     13906--REDEF
TAPE_OPEN.TAB_
     13904**DCL     13905--REDEF
TAPE_OPEN.UHL_
     13898**DCL     13899--REDEF   13899--REDEF
TAPE_OPEN.V.FSN#
     13938**DCL     13938--REDEF   13938--REDEF
TAPE_OPEN.WSN_
     13904**DCL     13904--REDEF
TAPE_READ.STATION_
     13962**DCL     13963--REDEF
TAPE_READ.V.DVBYTE.REREAD#
     13974**DCL     13974--REDEF
TAPE_READ.V.INDX#
     13972**DCL     13972--REDEF
TAPE_WRITE.STATION_
     14000**DCL     14000--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
     14007**DCL     14007--REDEF
TSN_USED_NAME.L#
PL6.E3A0      #002=FLC$TAPE_OPEN_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:39 Page:97   
     14889**DCL     14889--IMP-SIZ
TVECTOR.W2
     14131**DCL     14132--REDEF
USE_THIS
     16724**DCL     17068<<ASSIGN  17070<<ASSIGN  17075<<ASSIGN  17081<<ASSIGN  17083>>IF
WRITE_NODATA_LIST.STATION_
     16384**DCL     16384--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
     16391**DCL     16391--REDEF
WRITE_PRIME_DUAL.STATION_
     15749**DCL     15749--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
     15756**DCL     15756--REDEF
WRITE_REBUILD.STATION_
     15985**DCL     15985--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
     15992**DCL     15992--REDEF
WRITE_STATUS.STATION_
     15200**DCL     15200--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
     15207**DCL     15207--REDEF
WRITE_TSN_USED.STATION_
     14910**DCL     14910--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
     14917**DCL     14917--REDEF
XSF$LOCCODP
     16717**DCL-ENT 17092--CALL

PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:98   
      438        1        /*T***********************************************************/
      439        2        /*T*                                                         */
      440        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      441        4        /*T*                                                         */
      442        5        /*T***********************************************************/
      443        6        FLC$TAPE_READ_NEXT: PROC( BUF_, ARS, ERR ) ALTRET;
      444        7        /*F*  NAME: FLC$TAPE_READ_NEXT
      445        8              PURPOSE: Read next chunk of the current disk file on tape.
      446        9        */
      447       10
      448       11        /***
      449       12         *** Parameters
      450       13         ***/
      451       14
      452       15    1   DCL 1 BUF_ DALIGNED,                    /* Frames returned buffer             */
      453       16    1         2 * BIT(36),
      454       17    1         2 PTR$ PTR;
      455       18    1   DCL ARS SBIN ALIGNED;                   /* Number of bytes returned           */
      456       19    1   DCL 1 ERR ALIGNED,
      457       20    1         2 * BIT(12) UNAL,
      458       21    1         2 * BIT(6) UNAL,
      459       22    1         2 * BIT(1) UNAL,
      460       23    1         2 CODE UBIN(14) UNAL,
      461       24    1         2 * UBIN(3) UNAL;
      462       25
      463       26        /***
      464       27         *** INCLUDE
      465       28         ***/
      466       29
      467       30        %INCLUDE B_ERRORS_C;
      468     1157        %INCLUDE CP_6;
      469     6716        %INCLUDE FLE_DATA_R;
      470    12667        %INCLUDE FLI_DATA_R;
      471    14081        %INCLUDE FLS_DATA_R;
      472    15881
      473    15882        /***
      474    15883         *** ENTRY
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:99   
      475    15884         ***/
      476    15885
      477    15886    1   DCL FLI$RPT_ERR ENTRY(5);
      478    15887    1   DCL FLC$TAPE_OPEN ENTRY(1) ALTRET;
      479    15888    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      480    15889    1   DCL FLC$READ_TAPE_BLOCK ENTRY(1) ALTRET;
      481    15890
      482    15891        /***
      483    15892         *** STATIC
      484    15893         ***/
      485    15894
      486    15895        %VLP_VECTOR( FPTN=INCR_BUF_ );
      487    15910
      488    15911        /***
      489    15912         *** BASED
      490    15913         ***/
      491    15914
      492    15915        %F$DCB(BASED="BASED(M$TAPE00$)");
      493    15972
      494    15973        /***
      495    15974         *** AUTO
      496    15975         ***/
      497    15976
      498    15977        %VLP_NAME ( FPTN=ACCT_NAME,
      499    15978                    LEN=8,
      500    15979                    STCLASS=AUTO );
      501    16006
      502    16007        /****************************************/
      503    16008
      504    16009    1      ERR = '0'B;
      505    16010
      506    16011    2      DO WHILE( '1'B );
      507    16012
      508    16013    3         DO WHILE( ERR.CODE ~= %E$EOF );
      509    16014    4            DO WHILE( BLK_TAG$ >= TAPE_BLOCK_.PTR$ );
      510    16015    4               FILE_FIN = BLK_TAG.FIN;
      511    16016    4               IF BLK_TAG.SIZE > 0
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:100  
      512    16017    5                THEN DO;                   /* Return current chunk               */
      513    16018    5                  ARS = BLK_TAG.SIZE;
      514    16019    5                  INCR_BUF_ = TAPE_BLOCK_;
      515    16020    5                  INCR_BUF_.W1.VSIZE# = ARS - 1;
      516    16021    5                  INCR_BUF_.PTR$ = PINCRC( GRAN_BASE$, BLK_TAG.BEGX );
      517    16022    5                  BUF_ = INCR_BUF_;
      518    16023    5                  BLK_TAG.SIZE = 0;
      519    16024    5                  RETURN;
      520    16025    5                  END;
      521    16026    4               IF FILE_FIN
      522    16027    5                THEN DO;              /* Make sure that we stop on last BLK_TAG  */
      523    16028    5                  ERR.CODE = %E$EOF;
      524    16029    5                  ALTRETURN;
      525    16030    5                  END;
      526    16031    4               BLK_TAG$ = PINCRW( BLK_TAG$, -SIZEW(BLK_TAG) ); /* Next chunk     */
      527    16032    4               END;
      528    16033    3            CALL FLC$READ_TAPE_BLOCK( ERR ) ALTRET( JUSTALT );
      529    16034    3            END;
      530    16035
      531    16036    2         CALL FLC$TAPE_CLOSE ( ERR )
      532    16037    3          WHENALTRETURN DO;
      533    16038    3            IF LAST_TAPE_FSN > 0
      534    16039    3             THEN ALTRETURN;               /* Something is really wrong          */
      535    16040    3            IF FILE_FIN
      536    16041    3             THEN ALTRETURN;
      537    16042    3            END;
      538    16043    2         IF NOT FILE_FIN
      539    16044    2          THEN IF (CVOL_UTL.NUM# <= 0 AND SUBSTR(F$DCB.RES#,0,2) = 'LT')
      540    16045    2              OR SUBSTR(F$DCB.RES#,0,2) = 'OD'
      541    16046    3             THEN DO;
      542    16047    3               FILE_FIN = '1'B;
      543    16048    3               ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);
      544    16049    3               ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;
      545    16050    3               CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.
      546    16051    3                 NAME#),VECTOR(ACCT_NAME));
      547    16052    3               TAPE_BAD = '1'B;
      548    16053    3               IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:101  
      549    16054    3                THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      550    16055    3               END;
      551    16056    2             ELSE CROSSED = '*';
      552    16057    2         CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );
      553    16058
      554    16059    2         END;
      555    16060
      556    16061    1   JUSTALT: ;
      557    16062    1      ALTRETURN;
      558    16063
      559    16064    1   END FLC$TAPE_READ_NEXT;
      560    16065        %EOD;

PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:102  
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLC$TAPE_READ_NEXT.

   Procedure FLC$TAPE_READ_NEXT requires 138 words for executable code.
   Procedure FLC$TAPE_READ_NEXT requires 24 words of local(AUTO) storage.

PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:103  

 Object Unit name= FLC$TAPE_READ_NEXT                         File name= FLC$ROUTINES.:E05TOU
 UTS= JUL 29 '97 15:40:36.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    22     26  FLC$TAPE_READ_NEXT
    3   DCB   even  none     0      0  M$TSN_USED
    4   DCB   even  none     0      0  M$STATUS
    5   DCB   even  none     0      0  M$REBUILD
    6   DCB   even  none     0      0  M$ARCHIVE
    7   DCB   even  none     0      0  M$NODATA_LIST
    8  RoData even  UTS      2      2  FLC$TAPE_READ_NEXT
    9   Proc  even  none   138    212  FLC$TAPE_READ_NEXT
   10  RoData even  none     4      4  FLC$TAPE_READ_NEXT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        3  FLC$TAPE_READ_NEXT
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:104  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FLC$READ_TAPE_BLOCK
 yes     yes           Std       1 FLC$TAPE_CLOSE
         yes           Std       5 FLI$RPT_ERR
 yes     yes           Std       1 FLC$TAPE_OPEN
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    E_PARTIAL_FILE                        TAPE_DCBLIST$
     FPT_EXIT                              SNVECLIST$                            DPLIST$
     DPRESLIST$                            DISK_FILE_SPEC$                       SPECCHARS
     LAST_TAPE_FSN                         EFTWORD                               M$PRE_RET
     RET_CMDS_NAME                         M$TSN_USED                            M$STATUS
     M$REBUILD                             M$ARCHIVE                             M$NODATA_LIST
     M$TAPE00$                             BLK_TAG$                              BLK_TAG0$
     NBR_BYTES_TO_MOVE                     DISK_GRAN$                            BLOCK_GRAN$
     TAPE_BLOCK_                           GRAN_BASE$                            CROSSED
r    EFTFILE_DCB$                     r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE
     CVOL_UTL                              FILE_FIN                              TAPE_BAD
     TSN_USED_NAME                         BACKUP_NAME                      r    ARCHIVE_NAME
r    PRIME_FILE                       r    DUAL_FILE                             REBUILD_NAME
     REBUILD_DIR_KEY                       REBUILD_KEY                           NODATA_FILE_NAME
     NODATA_KEY                            B_VECTNIL
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:105  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:106  


      438        1        /*T***********************************************************/
      439        2        /*T*                                                         */
      440        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      441        4        /*T*                                                         */
      442        5        /*T***********************************************************/
      443        6        FLC$TAPE_READ_NEXT: PROC( BUF_, ARS, ERR ) ALTRET;

      6  9 000000   000000 700200 xent  FLC$TAPE_RE* TSX0  ! X66_AUTO_3
         9 000001   000030 000003                    ZERO    24,3

      444        7        /*F*  NAME: FLC$TAPE_READ_NEXT
      445        8              PURPOSE: Read next chunk of the current disk file on tape.
      446        9        */
      447       10
      448       11        /***
      449       12         *** Parameters
      450       13         ***/
      451       14
      452       15    1   DCL 1 BUF_ DALIGNED,                    /* Frames returned buffer             */
      453       16    1         2 * BIT(36),
      454       17    1         2 PTR$ PTR;
      455       18    1   DCL ARS SBIN ALIGNED;                   /* Number of bytes returned           */
      456       19    1   DCL 1 ERR ALIGNED,
      457       20    1         2 * BIT(12) UNAL,
      458       21    1         2 * BIT(6) UNAL,
      459       22    1         2 * BIT(1) UNAL,
      460       23    1         2 CODE UBIN(14) UNAL,
      461       24    1         2 * UBIN(3) UNAL;
      462       25
      463       26        /***
      464       27         *** INCLUDE
      465       28         ***/
      466       29
      467       30        %INCLUDE B_ERRORS_C;
      468     1157        %INCLUDE CP_6;
      469     6716        %INCLUDE FLE_DATA_R;
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:107  
      470    12667        %INCLUDE FLI_DATA_R;
      471    14081        %INCLUDE FLS_DATA_R;
      472    15881
      473    15882        /***
      474    15883         *** ENTRY
      475    15884         ***/
      476    15885
      477    15886    1   DCL FLI$RPT_ERR ENTRY(5);
      478    15887    1   DCL FLC$TAPE_OPEN ENTRY(1) ALTRET;
      479    15888    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      480    15889    1   DCL FLC$READ_TAPE_BLOCK ENTRY(1) ALTRET;
      481    15890
      482    15891        /***
      483    15892         *** STATIC
      484    15893         ***/
      485    15894
      486    15895        %VLP_VECTOR( FPTN=INCR_BUF_ );
      487    15910
      488    15911        /***
      489    15912         *** BASED
      490    15913         ***/
      491    15914
      492    15915        %F$DCB(BASED="BASED(M$TAPE00$)");
      493    15972
      494    15973        /***
      495    15974         *** AUTO
      496    15975         ***/
      497    15976
      498    15977        %VLP_NAME ( FPTN=ACCT_NAME,
      499    15978                    LEN=8,
      500    15979                    STCLASS=AUTO );
      501    16006
      502    16007        /****************************************/
      503    16008
      504    16009    1      ERR = '0'B;

  16009  9 000002   200005 470500                    LDP0    @ERR,,AUTO
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:108  
         9 000003   000000 450100                    STZ     0,,PR0

      505    16010
      506    16011    2      DO WHILE( '1'B );

      507    16012
      508    16013    3         DO WHILE( ERR.CODE ~= %E$EOF );

  16013  9 000004   200005 470500                    LDP0    @ERR,,AUTO
         9 000005   000000 236100                    LDQ     0,,PR0
         9 000006   377770 376007                    ANQ     131064,DL
         9 000007   000060 116007                    CMPQ    48,DL
         9 000010   000102 600000 9                  TZE     s:16036

      509    16014    4            DO WHILE( BLK_TAG$ >= TAPE_BLOCK_.PTR$ );

  16014  9 000011   000000 236000 xsym               LDQ     BLK_TAG$
         9 000012   000001 116000 xsym               CMPQ    TAPE_BLOCK_+1
         9 000013   000071 602000 9                  TNC     s:16033

      510    16015    4               FILE_FIN = BLK_TAG.FIN;

  16015  9 000014   000000 470400 xsym               LDP0    BLK_TAG$
         9 000015   000000 236100                    LDQ     0,,PR0
         9 000016   000034 736000                    QLS     28
         9 000017   400000 376003                    ANQ     -131072,DU
         9 000020   000000 756000 xsym               STQ     FILE_FIN

      511    16016    4               IF BLK_TAG.SIZE > 0

  16016  9 000021   000001 220100                    LDX0    1,,PR0
         9 000022   000054 600000 9                  TZE     s:16026

      512    16017    5                THEN DO;                   /* Return current chunk               */

      513    16018    5                  ARS = BLK_TAG.SIZE;

PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:109  
  16018  9 000023   000001 236100                    LDQ     1,,PR0
         9 000024   000022 772000                    QRL     18
         9 000025   200004 471500                    LDP1    @ARS,,AUTO
         9 000026   100000 756100                    STQ     0,,PR1

      514    16019    5                  INCR_BUF_ = TAPE_BLOCK_;

  16019  9 000027   000000 237000 xsym               LDAQ    TAPE_BLOCK_
         9 000030   000024 757000 2                  STAQ    INCR_BUF_

      515    16020    5                  INCR_BUF_.W1.VSIZE# = ARS - 1;

  16020  9 000031   100000 236100                    LDQ     0,,PR1
         9 000032   000001 136007                    SBLQ    1,DL
         9 000033   000020 736000                    QLS     16
         9 000034   000024 676000 2                  ERQ     INCR_BUF_
         9 000035   000034 376000 xsym               ANQ     B_VECTNIL+28
         9 000036   000024 656000 2                  ERSQ    INCR_BUF_

      516    16021    5                  INCR_BUF_.PTR$ = PINCRC( GRAN_BASE$, BLK_TAG.BEGX );

  16021  9 000037   000000 470400 xsym               LDP0    BLK_TAG$
         9 000040   000000 236100                    LDQ     0,,PR0
         9 000041   000022 772000                    QRL     18
         9 000042   000020 736000                    QLS     16
         9 000043   000000 036000 xsym               ADLQ    GRAN_BASE$
         9 000044   000025 756000 2                  STQ     INCR_BUF_+1

      517    16022    5                  BUF_ = INCR_BUF_;

  16022  9 000045   000024 237000 2                  LDAQ    INCR_BUF_
         9 000046   200003 473500                    LDP3    @BUF_,,AUTO
         9 000047   300000 757100                    STAQ    0,,PR3

      518    16023    5                  BLK_TAG.SIZE = 0;

  16023  9 000050   000000 220003                    LDX0    0,DU
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:110  
         9 000051   000000 470400 xsym               LDP0    BLK_TAG$
         9 000052   000001 740100                    STX0    1,,PR0

      519    16024    5                  RETURN;

  16024  9 000053   000000 702200 xent               TSX2  ! X66_ARET

      520    16025    5                  END;
      521    16026    4               IF FILE_FIN

  16026  9 000054   000000 234000 xsym               SZN     FILE_FIN
         9 000055   000064 605000 9                  TPL     s:16031

      522    16027    5                THEN DO;              /* Make sure that we stop on last BLK_TAG  */

      523    16028    5                  ERR.CODE = %E$EOF;

  16028  9 000056   200005 471500                    LDP1    @ERR,,AUTO
         9 000057   100000 236100                    LDQ     0,,PR1
         9 000060   000000 376000 10                 ANQ     0
         9 000061   000060 276007                    ORQ     48,DL
         9 000062   100000 756100                    STQ     0,,PR1

      524    16029    5                  ALTRETURN;

  16029  9 000063   000000 702200 xent               TSX2  ! X66_AALT

      525    16030    5                  END;
      526    16031    4               BLK_TAG$ = PINCRW( BLK_TAG$, -SIZEW(BLK_TAG) ); /* Next chunk     */

  16031  9 000064   000000 236000 xsym               LDQ     BLK_TAG$
         9 000065   777765 036003                    ADLQ    -11,DU
         9 000066   000000 756000 xsym               STQ     BLK_TAG$

      527    16032    4               END;

  16032  9 000067   000001 116000 xsym               CMPQ    TAPE_BLOCK_+1
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:111  
         9 000070   000014 603000 9                  TRC     s:16015

      528    16033    3            CALL FLC$READ_TAPE_BLOCK( ERR ) ALTRET( JUSTALT );

  16033  9 000071   200005 630500                    EPPR0   @ERR,,AUTO
         9 000072   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000073   000000 701000 xent               TSX1    FLC$READ_TAPE_BLOCK
         9 000074   000211 702000 9                  TSX2    JUSTALT

      529    16034    3            END;

  16034  9 000075   200005 470500                    LDP0    @ERR,,AUTO
         9 000076   000000 236100                    LDQ     0,,PR0
         9 000077   377770 376007                    ANQ     131064,DL
         9 000100   000060 116007                    CMPQ    48,DL
         9 000101   000011 601000 9                  TNZ     s:16014

      530    16035
      531    16036    2         CALL FLC$TAPE_CLOSE ( ERR )

  16036  9 000102   200005 630500                    EPPR0   @ERR,,AUTO
         9 000103   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000104   000000 701000 xent               TSX1    FLC$TAPE_CLOSE
         9 000105   000107 702000 9                  TSX2    s:16038
         9 000106   000115 710000 9                  TRA     s:16043

      532    16037    3          WHENALTRETURN DO;

      533    16038    3            IF LAST_TAPE_FSN > 0

  16038  9 000107   000000 235000 xsym               LDA     LAST_TAPE_FSN
         9 000110   000112 604400 9                  TMOZ    s:16040

      534    16039    3             THEN ALTRETURN;               /* Something is really wrong          */

  16039  9 000111   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:112  
      535    16040    3            IF FILE_FIN

  16040  9 000112   000000 234000 xsym               SZN     FILE_FIN
         9 000113   000115 605000 9                  TPL     s:16043

      536    16041    3             THEN ALTRETURN;

  16041  9 000114   000000 702200 xent               TSX2  ! X66_AALT

      537    16042    3            END;
      538    16043    2         IF NOT FILE_FIN

  16043  9 000115   000000 234000 xsym               SZN     FILE_FIN
         9 000116   000204 604000 9                  TMI     s:16057

      539    16044    2          THEN IF (CVOL_UTL.NUM# <= 0 AND SUBSTR(F$DCB.RES#,0,2) = 'LT')

  16044  9 000117   000000 235000 xsym               LDA     CVOL_UTL
         9 000120   000125 605400 9                  TPNZ    s:16044+6
         9 000121   000000 470400 xsym               LDP0    M$TAPE00$
         9 000122   000026 220100                    LDX0    22,,PR0
         9 000123   000000 100000 8                  CMPX0   0
         9 000124   000131 600000 9                  TZE     s:16047
         9 000125   000000 470400 xsym               LDP0    M$TAPE00$
         9 000126   000026 220100                    LDX0    22,,PR0
         9 000127   000001 100000 8                  CMPX0   1
         9 000130   000202 601000 9                  TNZ     s:16056

      540    16045    2              OR SUBSTR(F$DCB.RES#,0,2) = 'OD'
      541    16046    3             THEN DO;

      542    16047    3               FILE_FIN = '1'B;

  16047  9 000131   400000 236003                    LDQ     -131072,DU
         9 000132   000000 756000 xsym               STQ     FILE_FIN

      543    16048    3               ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:113  

  16048  9 000133   010000 236003                    LDQ     4096,DU
         9 000134   200006 552140                    STBQ    ACCT_NAME,'40'O,AUTO

      544    16049    3               ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;

  16049  9 000135   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 000136   040100 100500                    MLR     fill='040'O
         9 000137   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         9 000140   200006 200010                    ADSC9   ACCT_NAME,,AUTO          cn=1,n=8

      545    16050    3               CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.

  16050  9 000141   000001 235000 10                 LDA     1
         9 000142   000000 236000 xsym               LDQ     EFTFILE_DCB$
         9 000143   000010 036003                    ADLQ    8,DU
         9 000144   200012 757100                    STAQ    ACCT_NAME+4,,AUTO
         9 000145   000002 235000 10                 LDA     2
         9 000146   200014 452500                    STP2    ACCT_NAME+6,,AUTO
         9 000147   200014 236100                    LDQ     ACCT_NAME+6,,AUTO
         9 000150   000006 036003                    ADLQ    6,DU
         9 000151   200020 757100                    STAQ    ACCT_NAME+10,,AUTO
         9 000152   200012 237100                    LDAQ    ACCT_NAME+4,,AUTO
         9 000153   200016 757100                    STAQ    ACCT_NAME+8,,AUTO
         9 000154   200020 237100                    LDAQ    ACCT_NAME+10,,AUTO
         9 000155   200022 757100                    STAQ    ACCT_NAME+12,,AUTO
         9 000156   200022 633500                    EPPR3   ACCT_NAME+12,,AUTO
         9 000157   200027 453500                    STP3    ACCT_NAME+17,,AUTO
         9 000160   200016 634500                    EPPR4   ACCT_NAME+8,,AUTO
         9 000161   200026 454500                    STP4    ACCT_NAME+16,,AUTO
         9 000162   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000163   000003 235000 10                 LDA     3
         9 000164   200024 757100                    STAQ    ACCT_NAME+14,,AUTO
         9 000165   200024 630500                    EPPR0   ACCT_NAME+14,,AUTO
         9 000166   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 000167   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000170   000000 011000                    NOP     0
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:114  

      546    16051    3                 NAME#),VECTOR(ACCT_NAME));
      547    16052    3               TAPE_BAD = '1'B;

  16052  9 000171   400000 236003                    LDQ     -131072,DU
         9 000172   000000 756000 xsym               STQ     TAPE_BAD

      548    16053    3               IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16053  9 000173   000004 236000 xsym               LDQ     FPT_EXIT+4
         9 000174   777000 376003                    ANQ     -512,DU
         9 000175   004000 116003                    CMPQ    2048,DU
         9 000176   000204 603000 9                  TRC     s:16057

      549    16054    3                THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16054  9 000177   004000 236003                    LDQ     2048,DU
         9 000200   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      550    16055    3               END;

  16055  9 000201   000204 710000 9                  TRA     s:16057

      551    16056    2             ELSE CROSSED = '*';

  16056  9 000202   052000 236003                    LDQ     21504,DU
         9 000203   000000 756000 xsym               STQ     CROSSED

      552    16057    2         CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );

  16057  9 000204   200005 630500                    EPPR0   @ERR,,AUTO
         9 000205   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000206   000000 701000 xent               TSX1    FLC$TAPE_OPEN
         9 000207   000211 702000 9                  TSX2    JUSTALT

      553    16058
      554    16059    2         END;
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:115  

  16059  9 000210   000004 710000 9                  TRA     s:16013

  16055  9 000211                       JUSTALT      null
      555    16060
      556    16061    1   JUSTALT: ;
      557    16062    1      ALTRETURN;

  16062  9 000211   000000 702200 xent               TSX2  ! X66_AALT
      558    16063
      559    16064    1   END FLC$TAPE_READ_NEXT;
      560    16065        %EOD;

PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:116  
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLC$TAPE_READ_NEXT.
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:117  

 **** Variables and constants ****

  ****  Section 002  Data  FLC$TAPE_READ_NEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/d STRC(360)   r     1 DEL_NODATA_REC            24-0-0/d STRC(72)    r     1 INCR_BUF_

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ARS                       3-0-0/w PTR         r     1 @BUF_
     5-0-0/w PTR         r     1 @ERR                       6-0-0/c STRC(81)    r     1 ACCT_NAME
    *0-0-0/w SBIN        r     1 ARS                       *0-0-0/d STRC(72)    r     1 BUF_
    *0-0-0/w STRC        r     1 ERR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/c ASTR(9)     r     1 BACKUP_NAME
     0-0-0/w PTR         r     1 BLK_TAG$                   0-0-0/w PTR         r     1 BLK_TAG0$
     0-0-0/w PTR         r     1 BLOCK_GRAN$                0-0-0/c CHAR        r     1 CROSSED
     0-0-0/d STRC(756)   r     1 CVOL_UTL                   0-0-0/w PTR         r     1 DISK_FILE_SPEC$
     0-0-0/w PTR         r     1 DISK_GRAN$                 0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/c ASTR(9)     r     1 DUAL_FILE
     0-0-0/w PTR         r     1 EFTFILE_DCB$               0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE
     0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE          0-0-0/w STRC        r     1 E_PARTIAL_FILE
     0-0-0/b BIT         r     1 FILE_FIN                   0-0-0/d STRC(216)   r     1 FPT_EXIT
     0-0-0/w PTR         r     1 GRAN_BASE$                 0-0-0/w SBIN        r     1 LAST_TAPE_FSN
     0-0-0/w PTR         r     1 M$TAPE00$                  0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE
     0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME           0-0-0/c STRC(369)   r     1 NODATA_KEY
     0-0-0/c ASTR(9)     r     1 PRIME_FILE                 0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:118  
     0-0-0/c ASTR(9)     r     1 REBUILD_KEY                0-0-0/c ASTR(9)     r     1 REBUILD_NAME
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/b BIT         r     1 TAPE_BAD                   0-0-0/d STRC(72)    r     1 TAPE_BLOCK_
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)   r     1 BLK_TAG                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$NODATA_LIST


   Procedure FLC$TAPE_READ_NEXT requires 138 words for executable code.
   Procedure FLC$TAPE_READ_NEXT requires 24 words of local(AUTO) storage.
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:119  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:120  
          MINI XREF LISTING

ACCT_NAME
     16004**DCL     16050--CALL
ACCT_NAME.L#
     16004**DCL     16048<<ASSIGN
ACCT_NAME.NAME#
     16004**DCL     16048--ASSIGN  16049<<ASSIGN
ARCHIVE_NAME.L#
     14973**DCL     14973--IMP-SIZ
ARS
        18**DCL         6--PROC    16018<<ASSIGN  16020>>ASSIGN
BACKUP_NAME.L#
     14617**DCL     14617--IMP-SIZ
BLK_TAG
     14106**DCL     16031--ASSIGN
BLK_TAG.BEGX
     14108**DCL     16021>>ASSIGN
BLK_TAG.FIN
     14108**DCL     16015>>ASSIGN
BLK_TAG.NAME
     14109**DCL     14109--REDEF
BLK_TAG.SIZE
     14108**DCL     16016>>IF      16018>>ASSIGN  16023<<ASSIGN
BLK_TAG$
     14106**DCL     14106--IMP-PTR 16014>>DOWHILE 16015>>ASSIGN  16016>>IF      16018>>ASSIGN  16021>>ASSIGN
     16023>>ASSIGN  16031<<ASSIGN  16031>>ASSIGN
BLK_TAG0.NAME
     14115**DCL     14115--REDEF
BLK_TAG0$
     14112**DCL     14112--IMP-PTR
BLOCK_GRAN$
     14119**DCL     14120--IMP-PTR
BUF_
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:121  
        15**DCL         6--PROC    16022<<ASSIGN
CLOSE_NODATA_LIST.SN_
     15771**DCL     15771--REDEF
CLOSE_NODATA_LIST.UTL_
     15772**DCL     15772--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
     15786**DCL     15786--REDEF
CLOSE_NODATA_LIST.V.TYPE#
     15784**DCL     15784--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
     15781**DCL     15781--REDEF   15783--REDEF
CLOSE_PRIME_DUAL.SN_
     15248**DCL     15248--REDEF
CLOSE_PRIME_DUAL.UTL_
     15249**DCL     15249--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
     15263**DCL     15263--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
     15261**DCL     15261--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
     15258**DCL     15258--REDEF   15260--REDEF
CLOSE_REBUILD.SN_
     15523**DCL     15523--REDEF
CLOSE_REBUILD.UTL_
     15524**DCL     15524--REDEF
CLOSE_REBUILD.V.EXPIRE#
     15538**DCL     15538--REDEF
CLOSE_REBUILD.V.TYPE#
     15536**DCL     15536--REDEF
CLOSE_REBUILD.V.XTNSIZE#
     15533**DCL     15533--REDEF   15535--REDEF
CLOSE_STATUS.SN_
     14738**DCL     14738--REDEF
CLOSE_STATUS.UTL_
     14739**DCL     14739--REDEF
CLOSE_STATUS.V.EXPIRE#
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:122  
     14753**DCL     14753--REDEF
CLOSE_STATUS.V.TYPE#
     14751**DCL     14751--REDEF
CLOSE_STATUS.V.XTNSIZE#
     14748**DCL     14748--REDEF   14750--REDEF
CLOSE_TSN_USED.SN_
     14448**DCL     14448--REDEF
CLOSE_TSN_USED.UTL_
     14449**DCL     14449--REDEF
CLOSE_TSN_USED.V.EXPIRE#
     14463**DCL     14463--REDEF
CLOSE_TSN_USED.V.TYPE#
     14461**DCL     14461--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
     14458**DCL     14458--REDEF   14460--REDEF
CON_CLOSE_ARCHIVE.SN_
     14780**DCL     14780--REDEF
CON_CLOSE_ARCHIVE.UTL_
     14781**DCL     14781--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
     14795**DCL     14795--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
     14793**DCL     14793--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
     14790**DCL     14790--REDEF   14792--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
     14867**DCL     14868--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
     14873**DCL     14874--REDEF   14874--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
     14872**DCL     14873--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
     14871**DCL     14872--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
     14865**DCL     14866--REDEF   14866--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:123  
     14905**DCL     14905--REDEF   14905--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
     14871**DCL     14871--REDEF
CON_READ_ARCHIVE_FILE.STATION_
     14929**DCL     14930--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
     14941**DCL     14941--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
     14939**DCL     14939--REDEF
CROSSED
     14141**DCL     16056<<ASSIGN
CVOL_UTL.NUM#
     14208**DCL     16044>>IF
CVOL_UTL.ULBL#
     14208**DCL     14208--REDEF
DEL_NODATA_REC.V
     15874**DCL     15871--DCLINIT
DISK_CLOSE.SN_
     13278**DCL     13278--REDEF
DISK_CLOSE.UTL_
     13279**DCL     13279--REDEF
DISK_CLOSE.V.EXPIRE#
     13293**DCL     13293--REDEF
DISK_CLOSE.V.TYPE#
     13291**DCL     13291--REDEF
DISK_CLOSE.V.XTNSIZE#
     13288**DCL     13288--REDEF   13290--REDEF
DISK_FILE_SPEC.SPEC
     13643**DCL     13645--REDEF
DISK_FILE_SPEC.SPEC.START
     13644**DCL     13644--REDEF
DISK_FILE_SPEC.SPEC.STOP
     13645**DCL     13645--REDEF
DISK_FILE_SPEC$
     13642**DCL     13643--IMP-PTR
DISK_GRAN$
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:124  
     14119**DCL     14119--IMP-PTR
DISK_OPEN.ACSVEH_
     13143**DCL     13144--REDEF
DISK_OPEN.ALTKEYS_
     13149**DCL     13150--REDEF   13150--REDEF
DISK_OPEN.HDR_
     13148**DCL     13149--REDEF
DISK_OPEN.TAB_
     13147**DCL     13148--REDEF
DISK_OPEN.UHL_
     13141**DCL     13142--REDEF   13142--REDEF
DISK_OPEN.V.FSN#
     13181**DCL     13181--REDEF   13181--REDEF
DISK_OPEN.WSN_
     13147**DCL     13147--REDEF
DISK_READ.STATION_
     13205**DCL     13206--REDEF
DISK_READ.V.DVBYTE.REREAD#
     13217**DCL     13217--REDEF
DISK_READ.V.INDX#
     13215**DCL     13215--REDEF
DISK_WRITE.STATION_
     13243**DCL     13243--REDEF
DISK_WRITE.V.DVBYTE.VFC#
     13250**DCL     13250--REDEF
DPLIST$
     13628**DCL     13640--IMP-PTR
DPRESLIST$
     13642**DCL     13642--IMP-PTR
DUAL_FILE.L#
     15044**DCL     15044--IMP-SIZ
EFTFILE_DCB$
     14141**DCL     16049>>ASSIGN  16050>>CALL
EFTWORD
     13763**DCL     13763--REDEF
EFT_CVOL_FILE.L#
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:125  
     14168**DCL     14168--IMP-SIZ
EFT_RESTRICT_FILE.L#
     14195**DCL     14195--IMP-SIZ
ERR
        19**DCL         6--PROC    16009<<ASSIGN  16033<>CALL    16036<>CALL    16057<>CALL
ERR.CODE
        23**DCL     16013>>DOWHILE 16028<<ASSIGN
E_PARTIAL_FILE
      8223**DCL     16050<>CALL
F$DCB.ACCT#
     15932**DCL     16049>>ASSIGN
F$DCB.ACTPOS
     15948**DCL     15948--REDEF
F$DCB.ARS#
     15922**DCL     15922--REDEF
F$DCB.ATTR
     15941**DCL     15942--REDEF
F$DCB.BORROW
     15956**DCL     15956--REDEF   15956--REDEF   15956--REDEF
F$DCB.DCBNAME.L
     15970**DCL     15970--IMP-SIZ
F$DCB.EOMCHAR#
     15926**DCL     15926--REDEF
F$DCB.FLDID
     15951**DCL     15951--REDEF
F$DCB.FORM$
     15945**DCL     15945--REDEF
F$DCB.FSECT
     15961**DCL     15961--REDEF
F$DCB.FSN#
     15938**DCL     15938--REDEF   15938--REDEF   15939--REDEF
F$DCB.HEADER$
     15944**DCL     15944--REDEF
F$DCB.IXTNSIZE#
     15942**DCL     15942--REDEF
F$DCB.LASTSTA$
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:126  
     15931**DCL     15931--REDEF
F$DCB.LVL
     15957**DCL     15957--REDEF
F$DCB.NAME#
     15932**DCL     16050--CALL
F$DCB.NAME#.C
     15932**DCL     15932--REDEF
F$DCB.NOEOF
     15954**DCL     15954--REDEF
F$DCB.NRECS#
     15943**DCL     15943--REDEF
F$DCB.NRECX
     15962**DCL     15962--REDEF
F$DCB.OHDR
     15954**DCL     15954--REDEF
F$DCB.ORG#
     15937**DCL     15937--REDEF
F$DCB.PRECNO
     15960**DCL     15960--REDEF
F$DCB.RCSZ
     15966**DCL     15966--REDEF
F$DCB.RES#
     15933**DCL     15933--REDEF   16044>>IF      16044>>IF
F$DCB.SETX
     15945**DCL     15945--REDEF
F$DCB.TAB$
     15945**DCL     15945--REDEF
F$DCB.TDA
     15959**DCL     15960--REDEF
F$DCB.WSN#
     15933**DCL     15933--REDEF
FILE_FIN
     14211**DCL     16015<<ASSIGN  16026>>IF      16040>>IF      16043>>IF      16047<<ASSIGN
FIT_AREA.W2
     14479**DCL     14480--REDEF
FLC$READ_TAPE_BLOCK
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:127  
     15889**DCL-ENT 16033--CALL
FLC$TAPE_CLOSE
     15888**DCL-ENT 16036--CALL
FLC$TAPE_OPEN
     15887**DCL-ENT 16057--CALL
FLI$RPT_ERR
     15886**DCL-ENT 16050--CALL
FPT_EXIT.V.STEPCC#
     13068**DCL     13068--REDEF   16053>>IF      16054<<ASSIGN
GRAN_BASE$
     14137**DCL     16021>>ASSIGN
INCR_BUF_
     15906**DCL     16019<<ASSIGN  16022>>ASSIGN
INCR_BUF_.PTR$
     15908**DCL     16021<<ASSIGN
INCR_BUF_.W1.VSIZE#
     15906**DCL     16020<<ASSIGN
INCR_BUF_.W2
     15907**DCL     15908--REDEF
JUSTALT
     16055**LABEL   16033--CALLALT 16057--CALLALT
LAST_TAPE_FSN
     13762**DCL     16038>>IF
M$TAPE00$
     14105**DCL     15916--IMP-PTR 16044>>IF      16044>>IF
NBR_BYTES_TO_MOVE
     14118**DCL     14119--IMP-SIZ 14120--IMP-SIZ
NODATA_FILE_NAME.L#
     15733**DCL     15733--IMP-SIZ
NODATA_KEY
     15879**DCL     15871--DCLINIT 15872--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
     15666**DCL     15667--REDEF
OPEN_NODATA_LIST.ALTKEYS_
     15672**DCL     15673--REDEF   15673--REDEF
OPEN_NODATA_LIST.HDR_
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:128  
     15671**DCL     15672--REDEF
OPEN_NODATA_LIST.TAB_
     15670**DCL     15671--REDEF
OPEN_NODATA_LIST.UHL_
     15664**DCL     15665--REDEF   15665--REDEF
OPEN_NODATA_LIST.V.FSN#
     15704**DCL     15704--REDEF   15704--REDEF
OPEN_NODATA_LIST.WSN_
     15670**DCL     15670--REDEF
OPEN_PRIME_DUAL.ACSVEH_
     15113**DCL     15114--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
     15119**DCL     15120--REDEF   15120--REDEF
OPEN_PRIME_DUAL.HDR_
     15118**DCL     15119--REDEF
OPEN_PRIME_DUAL.TAB_
     15117**DCL     15118--REDEF
OPEN_PRIME_DUAL.UHL_
     15111**DCL     15112--REDEF   15112--REDEF
OPEN_PRIME_DUAL.V.FSN#
     15151**DCL     15151--REDEF   15151--REDEF
OPEN_PRIME_DUAL.WSN_
     15117**DCL     15117--REDEF
OPEN_REBUILD.ACSVEH_
     15348**DCL     15349--REDEF
OPEN_REBUILD.ALTKEYS_
     15354**DCL     15355--REDEF   15355--REDEF
OPEN_REBUILD.HDR_
     15353**DCL     15354--REDEF
OPEN_REBUILD.TAB_
     15352**DCL     15353--REDEF
OPEN_REBUILD.UHL_
     15346**DCL     15347--REDEF   15347--REDEF
OPEN_REBUILD.V.FSN#
     15386**DCL     15386--REDEF   15386--REDEF
OPEN_REBUILD.WSN_
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:129  
     15352**DCL     15352--REDEF
OPEN_STATUS.ACSVEH_
     14550**DCL     14551--REDEF
OPEN_STATUS.ALTKEYS_
     14556**DCL     14557--REDEF   14557--REDEF
OPEN_STATUS.HDR_
     14555**DCL     14556--REDEF
OPEN_STATUS.TAB_
     14554**DCL     14555--REDEF
OPEN_STATUS.UHL_
     14548**DCL     14549--REDEF   14549--REDEF
OPEN_STATUS.V.FSN#
     14588**DCL     14588--REDEF   14588--REDEF
OPEN_STATUS.WSN_
     14554**DCL     14554--REDEF
OPEN_TSN_USED.ACSVEH_
     14286**DCL     14287--REDEF
OPEN_TSN_USED.ALTKEYS_
     14292**DCL     14293--REDEF   14293--REDEF
OPEN_TSN_USED.HDR_
     14291**DCL     14292--REDEF
OPEN_TSN_USED.TAB_
     14290**DCL     14291--REDEF
OPEN_TSN_USED.UHL_
     14284**DCL     14285--REDEF   14285--REDEF
OPEN_TSN_USED.V.FSN#
     14324**DCL     14324--REDEF   14324--REDEF
OPEN_TSN_USED.WSN_
     14290**DCL     14290--REDEF
PRE_RET_CLOSE.SN_
     14006**DCL     14006--REDEF
PRE_RET_CLOSE.UTL_
     14007**DCL     14007--REDEF
PRE_RET_CLOSE.V.EXPIRE#
     14021**DCL     14021--REDEF
PRE_RET_CLOSE.V.TYPE#
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:130  
     14019**DCL     14019--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
     14016**DCL     14016--REDEF   14018--REDEF
PRE_RET_OPEN.ACSVEH_
     13941**DCL     13942--REDEF
PRE_RET_OPEN.ALTKEYS_
     13947**DCL     13948--REDEF   13948--REDEF
PRE_RET_OPEN.HDR_
     13946**DCL     13947--REDEF
PRE_RET_OPEN.TAB_
     13945**DCL     13946--REDEF
PRE_RET_OPEN.UHL_
     13939**DCL     13940--REDEF   13940--REDEF
PRE_RET_OPEN.V.FSN#
     13979**DCL     13979--REDEF   13979--REDEF
PRE_RET_OPEN.WSN_
     13945**DCL     13945--REDEF
PRE_RET_READ.STATION_
     13796**DCL     13797--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
     13808**DCL     13808--REDEF
PRE_RET_READ.V.INDX#
     13806**DCL     13806--REDEF
PRE_RET_WRITE.STATION_
     13834**DCL     13834--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
     13841**DCL     13841--REDEF
PRIME_FILE.L#
     15017**DCL     15017--IMP-SIZ
READ_NODATA_LIST.STATION_
     15810**DCL     15811--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
     15822**DCL     15822--REDEF
READ_NODATA_LIST.V.INDX#
     15820**DCL     15820--REDEF
READ_PRIME_DUAL.STATION_
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:131  
     15175**DCL     15176--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
     15187**DCL     15187--REDEF
READ_PRIME_DUAL.V.INDX#
     15185**DCL     15185--REDEF
READ_REBUILD.STATION_
     15481**DCL     15482--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
     15493**DCL     15493--REDEF
READ_REBUILD.V.INDX#
     15491**DCL     15491--REDEF
READ_STATUS.STATION_
     14696**DCL     14697--REDEF
READ_STATUS.V.DVBYTE.REREAD#
     14708**DCL     14708--REDEF
READ_STATUS.V.INDX#
     14706**DCL     14706--REDEF
READ_TSN_USED.STATION_
     14406**DCL     14407--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
     14418**DCL     14418--REDEF
READ_TSN_USED.V.INDX#
     14416**DCL     14416--REDEF
REBUILD_DIR_KEY.L#
     15567**DCL     15567--IMP-SIZ
REBUILD_KEY.L#
     15594**DCL     15594--IMP-SIZ
REBUILD_NAME.L#
     15415**DCL     15415--IMP-SIZ
RET_CMDS_NAME.L#
     14050**DCL     14050--IMP-SIZ
SNVECLIST$
     13582**DCL     13582--IMP-PTR
SPEC.START
     13646**DCL     13647--REDEF
SPEC.STOP
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:132  
     13647**DCL     13648--REDEF
SPECCHARS
     13646**DCL     13646--REDEF
TAPE_BAD
     14213**DCL     16052<<ASSIGN
TAPE_BLOCK_
     14133**DCL     16019>>ASSIGN
TAPE_BLOCK_.PTR$
     14135**DCL     16014>>DOWHILE
TAPE_BLOCK_.W2
     14134**DCL     14135--REDEF
TAPE_CLOSE.SN_
     13499**DCL     13499--REDEF
TAPE_CLOSE.UTL_
     13500**DCL     13500--REDEF
TAPE_CLOSE.V.EXPIRE#
     13514**DCL     13514--REDEF
TAPE_CLOSE.V.TYPE#
     13512**DCL     13512--REDEF
TAPE_CLOSE.V.XTNSIZE#
     13509**DCL     13509--REDEF   13511--REDEF
TAPE_DCBLIST$
     13055**DCL     13055--IMP-PTR
TAPE_OPEN.ACSVEH_
     13364**DCL     13365--REDEF
TAPE_OPEN.ALTKEYS_
     13370**DCL     13371--REDEF   13371--REDEF
TAPE_OPEN.HDR_
     13369**DCL     13370--REDEF
TAPE_OPEN.TAB_
     13368**DCL     13369--REDEF
TAPE_OPEN.UHL_
     13362**DCL     13363--REDEF   13363--REDEF
TAPE_OPEN.V.FSN#
     13402**DCL     13402--REDEF   13402--REDEF
TAPE_OPEN.WSN_
PL6.E3A0      #003=FLC$TAPE_READ_NEXT File=FLC$ROUTINES.:E05TSI                  TUE 07/29/97 15:40 Page:133  
     13368**DCL     13368--REDEF
TAPE_READ.STATION_
     13426**DCL     13427--REDEF
TAPE_READ.V.DVBYTE.REREAD#
     13438**DCL     13438--REDEF
TAPE_READ.V.INDX#
     13436**DCL     13436--REDEF
TAPE_WRITE.STATION_
     13464**DCL     13464--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
     13471**DCL     13471--REDEF
TSN_USED_NAME.L#
     14353**DCL     14353--IMP-SIZ
TVECTOR.W2
     13595**DCL     13596--REDEF
WRITE_NODATA_LIST.STATION_
     15848**DCL     15848--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
     15855**DCL     15855--REDEF
WRITE_PRIME_DUAL.STATION_
     15213**DCL     15213--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
     15220**DCL     15220--REDEF
WRITE_REBUILD.STATION_
     15449**DCL     15449--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
     15456**DCL     15456--REDEF
WRITE_STATUS.STATION_
     14664**DCL     14664--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
     14671**DCL     14671--REDEF
WRITE_TSN_USED.STATION_
     14374**DCL     14374--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
     14381**DCL     14381--REDEF

PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:134  
      561        1        /*T***********************************************************/
      562        2        /*T*                                                         */
      563        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      564        4        /*T*                                                         */
      565        5        /*T***********************************************************/
      566        6        FLC$TAPE_CLOSE_NEXT: PROC( ERR ) ALTRET;
      567        7        /*F*  NAME: FLC$TAPE_CLOSE_NEXT
      568        8              PURPOSE: Closes current disk file on tape and positions to its
      569        9                 end if not already there.
      570       10        */
      571       11
      572       12        /***
      573       13         *** Parameters
      574       14         ***/
      575       15
      576       16    1   DCL 1 ERR ALIGNED,
      577       17    1         2 FCG BIT(12) UNAL,
      578       18    1         2 MID BIT(6) UNAL,
      579       19    1         2 MON BIT(1) UNAL,
      580       20    1         2 CODE UBIN(14) UNAL,
      581       21    1         2 SEV UBIN(3) UNAL;
      582       22
      583       23        /***
      584       24         *** INCLUDE
      585       25         ***/
      586       26
      587       27        %INCLUDE B_ERRORS_C;
      588     1154        %INCLUDE CP_6;
      589     6713        %INCLUDE FLE_DATA_R;
      590    12664        %INCLUDE FLS_DATA_R;
      591    14464        %INCLUDE FLI_DATA_R;
      592    15878
      593    15879        /***
      594    15880         *** ENTRY
      595    15881         ***/
      596    15882
      597    15883    1   DCL FLI$RPT_ERR ENTRY(5);
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:135  
      598    15884    1   DCL FLC$TAPE_OPEN ENTRY(1) ALTRET;
      599    15885    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      600    15886    1   DCL FLC$READ_TAPE_BLOCK ENTRY(1) ALTRET;
      601    15887
      602    15888        /***
      603    15889         *** AUTO
      604    15890         ***/
      605    15891
      606    15892        %VLP_NAME ( FPTN=ACCT_NAME,
      607    15893                    LEN=8,
      608    15894                    STCLASS=AUTO );
      609    15921
      610    15922        /***
      611    15923         *** BASED
      612    15924         ***/
      613    15925
      614    15926        %F$DCB(BASED="BASED(M$TAPE00$)");
      615    15983        %B$TCB( STCLASS="BASED(B$TCB$)" );
      616    15986        %B$ALT;
      617    15994
      618    15995        /****************************************/
      619    15996
      620    15997    1      ERR = '0'B;
      621    15998
      622    15999    2      DO WHILE( '1'B );
      623    16000
      624    16001    3         DO WHILE( ERR.CODE ~= %E$EOF );
      625    16002    4            DO WHILE( BLK_TAG$ >= TAPE_BLOCK_.PTR$ );
      626    16003    4               IF BLK_TAG.FIN
      627    16004    5                THEN DO;                   /* Found end of file                  */
      628    16005    5                  FILE_FIN = '1'B;
      629    16006    5                  RETURN;
      630    16007    5                  END;
      631    16008    4               BLK_TAG$ = PINCRW( BLK_TAG$, -SIZEW(BLK_TAG) );
      632    16009    4               END;
      633    16010    3            CALL FLC$READ_TAPE_BLOCK( ERR ) ALTRET( JUSTALT );
      634    16011    3            END;
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:136  
      635    16012
      636    16013    2         CALL FLC$TAPE_CLOSE( ERR ) ALTRET( JUSTALT );
      637    16014    2         IF NOT FILE_FIN
      638    16015    2          THEN IF (CVOL_UTL.NUM# <= 0 AND SUBSTR(F$DCB.RES#,0,2) = 'LT')
      639    16016    2              OR SUBSTR(F$DCB.RES#,0,2) = 'OD'
      640    16017    3             THEN DO;
      641    16018    3               FILE_FIN = '1'B;
      642    16019    3               ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);
      643    16020    3               ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;
      644    16021    3               CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.
      645    16022    3                 NAME#),VECTOR(ACCT_NAME));
      646    16023    3               TAPE_BAD = '1'B;
      647    16024    3               CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );
      648    16025    3               RETURN;
      649    16026    3               END;
      650    16027    2             ELSE CROSSED = '*';
      651    16028    2         CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );
      652    16029
      653    16030    2         END;
      654    16031
      655    16032    1   JUSTALT: ;
      656    16033    1      ALTRETURN;
      657    16034
      658    16035    1   END FLC$TAPE_CLOSE_NEXT;
      659    16036        %EOD;

PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:137  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLC$TAPE_CLOSE_NEXT.

   Procedure FLC$TAPE_CLOSE_NEXT requires 96 words for executable code.
   Procedure FLC$TAPE_CLOSE_NEXT requires 22 words of local(AUTO) storage.

PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:138  

 Object Unit name= FLC$TAPE_CLOSE_NEXT                        File name= FLC$ROUTINES.:E05TOU
 UTS= JUL 29 '97 15:41:33.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$TSN_USED
    2   DCB   even  none     0      0  M$STATUS
    3   DCB   even  none     0      0  M$REBUILD
    4   DCB   even  none     0      0  M$ARCHIVE
    5   DCB   even  none     0      0  M$NODATA_LIST
    6   Data  even  none    20     24  FLC$TAPE_CLOSE_NEXT
    7   DCB   even  none     0      0  M$PRE_RET
    8  RoData even  UTS      2      2  FLC$TAPE_CLOSE_NEXT
    9   Proc  even  none    96    140  FLC$TAPE_CLOSE_NEXT
   10  RoData even  none     3      3  FLC$TAPE_CLOSE_NEXT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        1  FLC$TAPE_CLOSE_NEXT
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:139  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 FLC$READ_TAPE_BLOCK
 yes     yes           Std       1 FLC$TAPE_CLOSE
         yes           Std       5 FLI$RPT_ERR
 yes     yes           Std       1 FLC$TAPE_OPEN
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    E_PARTIAL_FILE                        M$TSN_USED
     M$STATUS                              M$REBUILD                             M$ARCHIVE
     M$NODATA_LIST                         M$TAPE00$                             BLK_TAG$
     BLK_TAG0$                             NBR_BYTES_TO_MOVE                     DISK_GRAN$
     BLOCK_GRAN$                           TAPE_BLOCK_                           CROSSED
r    EFTFILE_DCB$                     r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE
     CVOL_UTL                              FILE_FIN                              TAPE_BAD
     TSN_USED_NAME                         BACKUP_NAME                      r    ARCHIVE_NAME
r    PRIME_FILE                       r    DUAL_FILE                             REBUILD_NAME
     REBUILD_DIR_KEY                       REBUILD_KEY                           NODATA_FILE_NAME
     NODATA_KEY                            TAPE_DCBLIST$                         SNVECLIST$
     B$TCB$                                DPLIST$                               DPRESLIST$
     DISK_FILE_SPEC$                       SPECCHARS                             EFTWORD
     M$PRE_RET                             RET_CMDS_NAME                         B_VECTNIL
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:140  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:141  


      561        1        /*T***********************************************************/
      562        2        /*T*                                                         */
      563        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      564        4        /*T*                                                         */
      565        5        /*T***********************************************************/
      566        6        FLC$TAPE_CLOSE_NEXT: PROC( ERR ) ALTRET;

      6  9 000000   000000 700200 xent  FLC$TAPE_CL* TSX0  ! X66_AUTO_1
         9 000001   000026 000001                    ZERO    22,1

      567        7        /*F*  NAME: FLC$TAPE_CLOSE_NEXT
      568        8              PURPOSE: Closes current disk file on tape and positions to its
      569        9                 end if not already there.
      570       10        */
      571       11
      572       12        /***
      573       13         *** Parameters
      574       14         ***/
      575       15
      576       16    1   DCL 1 ERR ALIGNED,
      577       17    1         2 FCG BIT(12) UNAL,
      578       18    1         2 MID BIT(6) UNAL,
      579       19    1         2 MON BIT(1) UNAL,
      580       20    1         2 CODE UBIN(14) UNAL,
      581       21    1         2 SEV UBIN(3) UNAL;
      582       22
      583       23        /***
      584       24         *** INCLUDE
      585       25         ***/
      586       26
      587       27        %INCLUDE B_ERRORS_C;
      588     1154        %INCLUDE CP_6;
      589     6713        %INCLUDE FLE_DATA_R;
      590    12664        %INCLUDE FLS_DATA_R;
      591    14464        %INCLUDE FLI_DATA_R;
      592    15878
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:142  
      593    15879        /***
      594    15880         *** ENTRY
      595    15881         ***/
      596    15882
      597    15883    1   DCL FLI$RPT_ERR ENTRY(5);
      598    15884    1   DCL FLC$TAPE_OPEN ENTRY(1) ALTRET;
      599    15885    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      600    15886    1   DCL FLC$READ_TAPE_BLOCK ENTRY(1) ALTRET;
      601    15887
      602    15888        /***
      603    15889         *** AUTO
      604    15890         ***/
      605    15891
      606    15892        %VLP_NAME ( FPTN=ACCT_NAME,
      607    15893                    LEN=8,
      608    15894                    STCLASS=AUTO );
      609    15921
      610    15922        /***
      611    15923         *** BASED
      612    15924         ***/
      613    15925
      614    15926        %F$DCB(BASED="BASED(M$TAPE00$)");
      615    15983        %B$TCB( STCLASS="BASED(B$TCB$)" );
      616    15986        %B$ALT;
      617    15994
      618    15995        /****************************************/
      619    15996
      620    15997    1      ERR = '0'B;

  15997  9 000002   200003 470500                    LDP0    @ERR,,AUTO
         9 000003   000000 450100                    STZ     0,,PR0

      621    15998
      622    15999    2      DO WHILE( '1'B );

      623    16000
      624    16001    3         DO WHILE( ERR.CODE ~= %E$EOF );
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:143  

  16001  9 000004   200003 470500                    LDP0    @ERR,,AUTO
         9 000005   000000 236100                    LDQ     0,,PR0
         9 000006   377770 376007                    ANQ     131064,DL
         9 000007   000060 116007                    CMPQ    48,DL
         9 000010   000041 600000 9                  TZE     s:16013

      625    16002    4            DO WHILE( BLK_TAG$ >= TAPE_BLOCK_.PTR$ );

  16002  9 000011   000000 236000 xsym               LDQ     BLK_TAG$
         9 000012   000001 116000 xsym               CMPQ    TAPE_BLOCK_+1
         9 000013   000030 602000 9                  TNC     s:16010

      626    16003    4               IF BLK_TAG.FIN

  16003  9 000014   000000 470400 xsym               LDP0    BLK_TAG$
         9 000015   000000 236100                    LDQ     0,,PR0
         9 000016   000200 316007                    CANQ    128,DL
         9 000017   000023 600000 9                  TZE     s:16008

      627    16004    5                THEN DO;                   /* Found end of file                  */

      628    16005    5                  FILE_FIN = '1'B;

  16005  9 000020   400000 236003                    LDQ     -131072,DU
         9 000021   000000 756000 xsym               STQ     FILE_FIN

      629    16006    5                  RETURN;

  16006  9 000022   000000 702200 xent               TSX2  ! X66_ARET

      630    16007    5                  END;
      631    16008    4               BLK_TAG$ = PINCRW( BLK_TAG$, -SIZEW(BLK_TAG) );

  16008  9 000023   000000 236000 xsym               LDQ     BLK_TAG$
         9 000024   777765 036003                    ADLQ    -11,DU
         9 000025   000000 756000 xsym               STQ     BLK_TAG$
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:144  

      632    16009    4               END;

  16009  9 000026   000001 116000 xsym               CMPQ    TAPE_BLOCK_+1
         9 000027   000014 603000 9                  TRC     s:16003

      633    16010    3            CALL FLC$READ_TAPE_BLOCK( ERR ) ALTRET( JUSTALT );

  16010  9 000030   200003 630500                    EPPR0   @ERR,,AUTO
         9 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000032   000000 701000 xent               TSX1    FLC$READ_TAPE_BLOCK
         9 000033   000137 702000 9                  TSX2    JUSTALT

      634    16011    3            END;

  16011  9 000034   200003 470500                    LDP0    @ERR,,AUTO
         9 000035   000000 236100                    LDQ     0,,PR0
         9 000036   377770 376007                    ANQ     131064,DL
         9 000037   000060 116007                    CMPQ    48,DL
         9 000040   000011 601000 9                  TNZ     s:16002

      635    16012
      636    16013    2         CALL FLC$TAPE_CLOSE( ERR ) ALTRET( JUSTALT );

  16013  9 000041   200003 630500                    EPPR0   @ERR,,AUTO
         9 000042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000043   000000 701000 xent               TSX1    FLC$TAPE_CLOSE
         9 000044   000137 702000 9                  TSX2    JUSTALT

      637    16014    2         IF NOT FILE_FIN

  16014  9 000045   000000 234000 xsym               SZN     FILE_FIN
         9 000046   000132 604000 9                  TMI     s:16028

      638    16015    2          THEN IF (CVOL_UTL.NUM# <= 0 AND SUBSTR(F$DCB.RES#,0,2) = 'LT')

  16015  9 000047   000000 235000 xsym               LDA     CVOL_UTL
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:145  
         9 000050   000055 605400 9                  TPNZ    s:16015+6
         9 000051   000000 470400 xsym               LDP0    M$TAPE00$
         9 000052   000026 220100                    LDX0    22,,PR0
         9 000053   000000 100000 8                  CMPX0   0
         9 000054   000061 600000 9                  TZE     s:16018
         9 000055   000000 470400 xsym               LDP0    M$TAPE00$
         9 000056   000026 220100                    LDX0    22,,PR0
         9 000057   000001 100000 8                  CMPX0   1
         9 000060   000130 601000 9                  TNZ     s:16027

      639    16016    2              OR SUBSTR(F$DCB.RES#,0,2) = 'OD'
      640    16017    3             THEN DO;

      641    16018    3               FILE_FIN = '1'B;

  16018  9 000061   400000 236003                    LDQ     -131072,DU
         9 000062   000000 756000 xsym               STQ     FILE_FIN

      642    16019    3               ACCT_NAME.L# = LENGTHC(ACCT_NAME.NAME#);

  16019  9 000063   010000 236003                    LDQ     4096,DU
         9 000064   200004 552140                    STBQ    ACCT_NAME,'40'O,AUTO

      643    16020    3               ACCT_NAME.NAME# = EFTFILE_DCB$->F$DCB.ACCT#;

  16020  9 000065   000000 471400 xsym               LDP1    EFTFILE_DCB$
         9 000066   040100 100500                    MLR     fill='040'O
         9 000067   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         9 000070   200004 200010                    ADSC9   ACCT_NAME,,AUTO          cn=1,n=8

      644    16021    3               CALL FLI$RPT_ERR( E_PARTIAL_FILE, ,VECTOR(EFTFILE_DCB$->F$DCB.

  16021  9 000071   000000 235000 10                 LDA     0
         9 000072   000000 236000 xsym               LDQ     EFTFILE_DCB$
         9 000073   000010 036003                    ADLQ    8,DU
         9 000074   200010 757100                    STAQ    ACCT_NAME+4,,AUTO
         9 000075   000001 235000 10                 LDA     1
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:146  
         9 000076   200012 452500                    STP2    ACCT_NAME+6,,AUTO
         9 000077   200012 236100                    LDQ     ACCT_NAME+6,,AUTO
         9 000100   000004 036003                    ADLQ    4,DU
         9 000101   200016 757100                    STAQ    ACCT_NAME+10,,AUTO
         9 000102   200010 237100                    LDAQ    ACCT_NAME+4,,AUTO
         9 000103   200014 757100                    STAQ    ACCT_NAME+8,,AUTO
         9 000104   200016 237100                    LDAQ    ACCT_NAME+10,,AUTO
         9 000105   200020 757100                    STAQ    ACCT_NAME+12,,AUTO
         9 000106   200020 633500                    EPPR3   ACCT_NAME+12,,AUTO
         9 000107   200025 453500                    STP3    ACCT_NAME+17,,AUTO
         9 000110   200014 634500                    EPPR4   ACCT_NAME+8,,AUTO
         9 000111   200024 454500                    STP4    ACCT_NAME+16,,AUTO
         9 000112   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000113   000002 235000 10                 LDA     2
         9 000114   200022 757100                    STAQ    ACCT_NAME+14,,AUTO
         9 000115   200022 630500                    EPPR0   ACCT_NAME+14,,AUTO
         9 000116   000022 631400 xsym               EPPR1   B_VECTNIL+18
         9 000117   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000120   000000 011000                    NOP     0

      645    16022    3                 NAME#),VECTOR(ACCT_NAME));
      646    16023    3               TAPE_BAD = '1'B;

  16023  9 000121   400000 236003                    LDQ     -131072,DU
         9 000122   000000 756000 xsym               STQ     TAPE_BAD

      647    16024    3               CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );

  16024  9 000123   200003 630500                    EPPR0   @ERR,,AUTO
         9 000124   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000125   000000 701000 xent               TSX1    FLC$TAPE_OPEN
         9 000126   000137 702000 9                  TSX2    JUSTALT

      648    16025    3               RETURN;

  16025  9 000127   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:147  
      649    16026    3               END;
      650    16027    2             ELSE CROSSED = '*';

  16027  9 000130   052000 236003                    LDQ     21504,DU
         9 000131   000000 756000 xsym               STQ     CROSSED

      651    16028    2         CALL FLC$TAPE_OPEN( ERR ) ALTRET( JUSTALT );

  16028  9 000132   200003 630500                    EPPR0   @ERR,,AUTO
         9 000133   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000134   000000 701000 xent               TSX1    FLC$TAPE_OPEN
         9 000135   000137 702000 9                  TSX2    JUSTALT

      652    16029
      653    16030    2         END;

  16030  9 000136   000004 710000 9                  TRA     s:16001

  16022  9 000137                       JUSTALT      null
      654    16031
      655    16032    1   JUSTALT: ;
      656    16033    1      ALTRETURN;

  16033  9 000137   000000 702200 xent               TSX2  ! X66_AALT
      657    16034
      658    16035    1   END FLC$TAPE_CLOSE_NEXT;
      659    16036        %EOD;

PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:148  
--  Include file information  --

   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FLC$TAPE_CLOSE_NEXT.
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:149  

 **** Variables and constants ****

  ****  Section 006  Data  FLC$TAPE_CLOSE_NEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/d STRC(360)   r     1 DEL_NODATA_REC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ERR                       4-0-0/c STRC(81)    r     1 ACCT_NAME
    *0-0-0/w STRC        r     1 ERR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 BACKUP_NAME                0-0-0/w PTR         r     1 BLK_TAG$
     0-0-0/w PTR         r     1 BLK_TAG0$                  0-0-0/w PTR         r     1 BLOCK_GRAN$
     0-0-0/c CHAR        r     1 CROSSED                    0-0-0/d STRC(756)   r     1 CVOL_UTL
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DISK_GRAN$
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/c ASTR(9)     r     1 DUAL_FILE                  0-0-0/w PTR         r     1 EFTFILE_DCB$
     0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE              0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE
     0-0-0/w STRC        r     1 E_PARTIAL_FILE             0-0-0/b BIT         r     1 FILE_FIN
     0-0-0/w PTR         r     1 M$TAPE00$                  0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE
     0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME           0-0-0/c STRC(369)   r     1 NODATA_KEY
     0-0-0/c ASTR(9)     r     1 PRIME_FILE                 0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_KEY                0-0-0/c ASTR(9)     r     1 REBUILD_NAME
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
     0-0-0/b BIT         r     1 TAPE_BAD                   0-0-0/d STRC(72)    r     1 TAPE_BLOCK_
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:150  
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(396)   r     1 BLK_TAG                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$NODATA_LIST


   Procedure FLC$TAPE_CLOSE_NEXT requires 96 words for executable code.
   Procedure FLC$TAPE_CLOSE_NEXT requires 22 words of local(AUTO) storage.
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:151  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:152  
          MINI XREF LISTING

ACCT_NAME
     15919**DCL     16021--CALL
ACCT_NAME.L#
     15919**DCL     16019<<ASSIGN
ACCT_NAME.NAME#
     15919**DCL     16019--ASSIGN  16020<<ASSIGN
ARCHIVE_NAME.L#
     13556**DCL     13556--IMP-SIZ
B$ALT.CODE
     15988**DCL     15988--REDEF   15989--REDEF   15989--REDEF
B$ALT.ERR.ERR#
     15990**DCL     15990--REDEF
B$ALT.EVID
     15989**DCL     15989--REDEF   15989--REDEF
B$TCB$
     15395**DCL     15984--IMP-PTR
BACKUP_NAME.L#
     13200**DCL     13200--IMP-SIZ
BLK_TAG
     12689**DCL     16008--ASSIGN
BLK_TAG.FIN
     12691**DCL     16003>>IF
BLK_TAG.NAME
     12692**DCL     12692--REDEF
BLK_TAG$
     12689**DCL     12689--IMP-PTR 16002>>DOWHILE 16003>>IF      16008<<ASSIGN  16008>>ASSIGN
BLK_TAG0.NAME
     12698**DCL     12698--REDEF
BLK_TAG0$
     12695**DCL     12695--IMP-PTR
BLOCK_GRAN$
     12702**DCL     12703--IMP-PTR
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:153  
CLOSE_NODATA_LIST.SN_
     14354**DCL     14354--REDEF
CLOSE_NODATA_LIST.UTL_
     14355**DCL     14355--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
     14369**DCL     14369--REDEF
CLOSE_NODATA_LIST.V.TYPE#
     14367**DCL     14367--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
     14364**DCL     14364--REDEF   14366--REDEF
CLOSE_PRIME_DUAL.SN_
     13831**DCL     13831--REDEF
CLOSE_PRIME_DUAL.UTL_
     13832**DCL     13832--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
     13846**DCL     13846--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
     13844**DCL     13844--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
     13841**DCL     13841--REDEF   13843--REDEF
CLOSE_REBUILD.SN_
     14106**DCL     14106--REDEF
CLOSE_REBUILD.UTL_
     14107**DCL     14107--REDEF
CLOSE_REBUILD.V.EXPIRE#
     14121**DCL     14121--REDEF
CLOSE_REBUILD.V.TYPE#
     14119**DCL     14119--REDEF
CLOSE_REBUILD.V.XTNSIZE#
     14116**DCL     14116--REDEF   14118--REDEF
CLOSE_STATUS.SN_
     13321**DCL     13321--REDEF
CLOSE_STATUS.UTL_
     13322**DCL     13322--REDEF
CLOSE_STATUS.V.EXPIRE#
     13336**DCL     13336--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:154  
CLOSE_STATUS.V.TYPE#
     13334**DCL     13334--REDEF
CLOSE_STATUS.V.XTNSIZE#
     13331**DCL     13331--REDEF   13333--REDEF
CLOSE_TSN_USED.SN_
     13031**DCL     13031--REDEF
CLOSE_TSN_USED.UTL_
     13032**DCL     13032--REDEF
CLOSE_TSN_USED.V.EXPIRE#
     13046**DCL     13046--REDEF
CLOSE_TSN_USED.V.TYPE#
     13044**DCL     13044--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
     13041**DCL     13041--REDEF   13043--REDEF
CON_CLOSE_ARCHIVE.SN_
     13363**DCL     13363--REDEF
CON_CLOSE_ARCHIVE.UTL_
     13364**DCL     13364--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
     13378**DCL     13378--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
     13376**DCL     13376--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
     13373**DCL     13373--REDEF   13375--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
     13450**DCL     13451--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
     13456**DCL     13457--REDEF   13457--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
     13455**DCL     13456--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
     13454**DCL     13455--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
     13448**DCL     13449--REDEF   13449--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
     13488**DCL     13488--REDEF   13488--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:155  
CON_OPEN_ARCHIVE_FILE.WSN_
     13454**DCL     13454--REDEF
CON_READ_ARCHIVE_FILE.STATION_
     13512**DCL     13513--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
     13524**DCL     13524--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
     13522**DCL     13522--REDEF
CROSSED
     12724**DCL     16027<<ASSIGN
CVOL_UTL.NUM#
     12791**DCL     16015>>IF
CVOL_UTL.ULBL#
     12791**DCL     12791--REDEF
DEL_NODATA_REC.V
     14457**DCL     14454--DCLINIT
DISK_CLOSE.SN_
     15075**DCL     15075--REDEF
DISK_CLOSE.UTL_
     15076**DCL     15076--REDEF
DISK_CLOSE.V.EXPIRE#
     15090**DCL     15090--REDEF
DISK_CLOSE.V.TYPE#
     15088**DCL     15088--REDEF
DISK_CLOSE.V.XTNSIZE#
     15085**DCL     15085--REDEF   15087--REDEF
DISK_FILE_SPEC.SPEC
     15440**DCL     15442--REDEF
DISK_FILE_SPEC.SPEC.START
     15441**DCL     15441--REDEF
DISK_FILE_SPEC.SPEC.STOP
     15442**DCL     15442--REDEF
DISK_FILE_SPEC$
     15439**DCL     15440--IMP-PTR
DISK_GRAN$
     12702**DCL     12702--IMP-PTR
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:156  
DISK_OPEN.ACSVEH_
     14940**DCL     14941--REDEF
DISK_OPEN.ALTKEYS_
     14946**DCL     14947--REDEF   14947--REDEF
DISK_OPEN.HDR_
     14945**DCL     14946--REDEF
DISK_OPEN.TAB_
     14944**DCL     14945--REDEF
DISK_OPEN.UHL_
     14938**DCL     14939--REDEF   14939--REDEF
DISK_OPEN.V.FSN#
     14978**DCL     14978--REDEF   14978--REDEF
DISK_OPEN.WSN_
     14944**DCL     14944--REDEF
DISK_READ.STATION_
     15002**DCL     15003--REDEF
DISK_READ.V.DVBYTE.REREAD#
     15014**DCL     15014--REDEF
DISK_READ.V.INDX#
     15012**DCL     15012--REDEF
DISK_WRITE.STATION_
     15040**DCL     15040--REDEF
DISK_WRITE.V.DVBYTE.VFC#
     15047**DCL     15047--REDEF
DPLIST$
     15425**DCL     15437--IMP-PTR
DPRESLIST$
     15439**DCL     15439--IMP-PTR
DUAL_FILE.L#
     13627**DCL     13627--IMP-SIZ
EFTFILE_DCB$
     12724**DCL     16020>>ASSIGN  16021>>CALL
EFTWORD
     15560**DCL     15560--REDEF
EFT_CVOL_FILE.L#
     12751**DCL     12751--IMP-SIZ
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:157  
EFT_RESTRICT_FILE.L#
     12778**DCL     12778--IMP-SIZ
ERR
        16**DCL         6--PROC    15997<<ASSIGN  16010<>CALL    16013<>CALL    16024<>CALL    16028<>CALL
ERR.CODE
        20**DCL     16001>>DOWHILE
E_PARTIAL_FILE
      8220**DCL     16021<>CALL
F$DCB.ACCT#
     15943**DCL     16020>>ASSIGN
F$DCB.ACTPOS
     15959**DCL     15959--REDEF
F$DCB.ARS#
     15933**DCL     15933--REDEF
F$DCB.ATTR
     15952**DCL     15953--REDEF
F$DCB.BORROW
     15967**DCL     15967--REDEF   15967--REDEF   15967--REDEF
F$DCB.DCBNAME.L
     15981**DCL     15981--IMP-SIZ
F$DCB.EOMCHAR#
     15937**DCL     15937--REDEF
F$DCB.FLDID
     15962**DCL     15962--REDEF
F$DCB.FORM$
     15956**DCL     15956--REDEF
F$DCB.FSECT
     15972**DCL     15972--REDEF
F$DCB.FSN#
     15949**DCL     15949--REDEF   15949--REDEF   15950--REDEF
F$DCB.HEADER$
     15955**DCL     15955--REDEF
F$DCB.IXTNSIZE#
     15953**DCL     15953--REDEF
F$DCB.LASTSTA$
     15942**DCL     15942--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:158  
F$DCB.LVL
     15968**DCL     15968--REDEF
F$DCB.NAME#
     15943**DCL     16021--CALL
F$DCB.NAME#.C
     15943**DCL     15943--REDEF
F$DCB.NOEOF
     15965**DCL     15965--REDEF
F$DCB.NRECS#
     15954**DCL     15954--REDEF
F$DCB.NRECX
     15973**DCL     15973--REDEF
F$DCB.OHDR
     15965**DCL     15965--REDEF
F$DCB.ORG#
     15948**DCL     15948--REDEF
F$DCB.PRECNO
     15971**DCL     15971--REDEF
F$DCB.RCSZ
     15977**DCL     15977--REDEF
F$DCB.RES#
     15944**DCL     15944--REDEF   16015>>IF      16015>>IF
F$DCB.SETX
     15956**DCL     15956--REDEF
F$DCB.TAB$
     15956**DCL     15956--REDEF
F$DCB.TDA
     15970**DCL     15971--REDEF
F$DCB.WSN#
     15944**DCL     15944--REDEF
FILE_FIN
     12794**DCL     16005<<ASSIGN  16014>>IF      16018<<ASSIGN
FIT_AREA.W2
     13062**DCL     13063--REDEF
FLC$READ_TAPE_BLOCK
     15886**DCL-ENT 16010--CALL
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:159  
FLC$TAPE_CLOSE
     15885**DCL-ENT 16013--CALL
FLC$TAPE_OPEN
     15884**DCL-ENT 16024--CALL    16028--CALL
FLI$RPT_ERR
     15883**DCL-ENT 16021--CALL
FPT_EXIT.V.STEPCC#
     14865**DCL     14865--REDEF
JUSTALT
     16022**LABEL   16010--CALLALT 16013--CALLALT 16024--CALLALT 16028--CALLALT
M$TAPE00$
     12688**DCL     15927--IMP-PTR 16015>>IF      16015>>IF
NBR_BYTES_TO_MOVE
     12701**DCL     12702--IMP-SIZ 12703--IMP-SIZ
NODATA_FILE_NAME.L#
     14316**DCL     14316--IMP-SIZ
NODATA_KEY
     14462**DCL     14454--DCLINIT 14455--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
     14249**DCL     14250--REDEF
OPEN_NODATA_LIST.ALTKEYS_
     14255**DCL     14256--REDEF   14256--REDEF
OPEN_NODATA_LIST.HDR_
     14254**DCL     14255--REDEF
OPEN_NODATA_LIST.TAB_
     14253**DCL     14254--REDEF
OPEN_NODATA_LIST.UHL_
     14247**DCL     14248--REDEF   14248--REDEF
OPEN_NODATA_LIST.V.FSN#
     14287**DCL     14287--REDEF   14287--REDEF
OPEN_NODATA_LIST.WSN_
     14253**DCL     14253--REDEF
OPEN_PRIME_DUAL.ACSVEH_
     13696**DCL     13697--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
     13702**DCL     13703--REDEF   13703--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:160  
OPEN_PRIME_DUAL.HDR_
     13701**DCL     13702--REDEF
OPEN_PRIME_DUAL.TAB_
     13700**DCL     13701--REDEF
OPEN_PRIME_DUAL.UHL_
     13694**DCL     13695--REDEF   13695--REDEF
OPEN_PRIME_DUAL.V.FSN#
     13734**DCL     13734--REDEF   13734--REDEF
OPEN_PRIME_DUAL.WSN_
     13700**DCL     13700--REDEF
OPEN_REBUILD.ACSVEH_
     13931**DCL     13932--REDEF
OPEN_REBUILD.ALTKEYS_
     13937**DCL     13938--REDEF   13938--REDEF
OPEN_REBUILD.HDR_
     13936**DCL     13937--REDEF
OPEN_REBUILD.TAB_
     13935**DCL     13936--REDEF
OPEN_REBUILD.UHL_
     13929**DCL     13930--REDEF   13930--REDEF
OPEN_REBUILD.V.FSN#
     13969**DCL     13969--REDEF   13969--REDEF
OPEN_REBUILD.WSN_
     13935**DCL     13935--REDEF
OPEN_STATUS.ACSVEH_
     13133**DCL     13134--REDEF
OPEN_STATUS.ALTKEYS_
     13139**DCL     13140--REDEF   13140--REDEF
OPEN_STATUS.HDR_
     13138**DCL     13139--REDEF
OPEN_STATUS.TAB_
     13137**DCL     13138--REDEF
OPEN_STATUS.UHL_
     13131**DCL     13132--REDEF   13132--REDEF
OPEN_STATUS.V.FSN#
     13171**DCL     13171--REDEF   13171--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:161  
OPEN_STATUS.WSN_
     13137**DCL     13137--REDEF
OPEN_TSN_USED.ACSVEH_
     12869**DCL     12870--REDEF
OPEN_TSN_USED.ALTKEYS_
     12875**DCL     12876--REDEF   12876--REDEF
OPEN_TSN_USED.HDR_
     12874**DCL     12875--REDEF
OPEN_TSN_USED.TAB_
     12873**DCL     12874--REDEF
OPEN_TSN_USED.UHL_
     12867**DCL     12868--REDEF   12868--REDEF
OPEN_TSN_USED.V.FSN#
     12907**DCL     12907--REDEF   12907--REDEF
OPEN_TSN_USED.WSN_
     12873**DCL     12873--REDEF
PRE_RET_CLOSE.SN_
     15803**DCL     15803--REDEF
PRE_RET_CLOSE.UTL_
     15804**DCL     15804--REDEF
PRE_RET_CLOSE.V.EXPIRE#
     15818**DCL     15818--REDEF
PRE_RET_CLOSE.V.TYPE#
     15816**DCL     15816--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
     15813**DCL     15813--REDEF   15815--REDEF
PRE_RET_OPEN.ACSVEH_
     15738**DCL     15739--REDEF
PRE_RET_OPEN.ALTKEYS_
     15744**DCL     15745--REDEF   15745--REDEF
PRE_RET_OPEN.HDR_
     15743**DCL     15744--REDEF
PRE_RET_OPEN.TAB_
     15742**DCL     15743--REDEF
PRE_RET_OPEN.UHL_
     15736**DCL     15737--REDEF   15737--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:162  
PRE_RET_OPEN.V.FSN#
     15776**DCL     15776--REDEF   15776--REDEF
PRE_RET_OPEN.WSN_
     15742**DCL     15742--REDEF
PRE_RET_READ.STATION_
     15593**DCL     15594--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
     15605**DCL     15605--REDEF
PRE_RET_READ.V.INDX#
     15603**DCL     15603--REDEF
PRE_RET_WRITE.STATION_
     15631**DCL     15631--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
     15638**DCL     15638--REDEF
PRIME_FILE.L#
     13600**DCL     13600--IMP-SIZ
READ_NODATA_LIST.STATION_
     14393**DCL     14394--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
     14405**DCL     14405--REDEF
READ_NODATA_LIST.V.INDX#
     14403**DCL     14403--REDEF
READ_PRIME_DUAL.STATION_
     13758**DCL     13759--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
     13770**DCL     13770--REDEF
READ_PRIME_DUAL.V.INDX#
     13768**DCL     13768--REDEF
READ_REBUILD.STATION_
     14064**DCL     14065--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
     14076**DCL     14076--REDEF
READ_REBUILD.V.INDX#
     14074**DCL     14074--REDEF
READ_STATUS.STATION_
     13279**DCL     13280--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:163  
READ_STATUS.V.DVBYTE.REREAD#
     13291**DCL     13291--REDEF
READ_STATUS.V.INDX#
     13289**DCL     13289--REDEF
READ_TSN_USED.STATION_
     12989**DCL     12990--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
     13001**DCL     13001--REDEF
READ_TSN_USED.V.INDX#
     12999**DCL     12999--REDEF
REBUILD_DIR_KEY.L#
     14150**DCL     14150--IMP-SIZ
REBUILD_KEY.L#
     14177**DCL     14177--IMP-SIZ
REBUILD_NAME.L#
     13998**DCL     13998--IMP-SIZ
RET_CMDS_NAME.L#
     15847**DCL     15847--IMP-SIZ
SNVECLIST$
     15379**DCL     15379--IMP-PTR
SPEC.START
     15443**DCL     15444--REDEF
SPEC.STOP
     15444**DCL     15445--REDEF
SPECCHARS
     15443**DCL     15443--REDEF
TAPE_BAD
     12796**DCL     16023<<ASSIGN
TAPE_BLOCK_.PTR$
     12718**DCL     16002>>DOWHILE
TAPE_BLOCK_.W2
     12717**DCL     12718--REDEF
TAPE_CLOSE.SN_
     15296**DCL     15296--REDEF
TAPE_CLOSE.UTL_
     15297**DCL     15297--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:164  
TAPE_CLOSE.V.EXPIRE#
     15311**DCL     15311--REDEF
TAPE_CLOSE.V.TYPE#
     15309**DCL     15309--REDEF
TAPE_CLOSE.V.XTNSIZE#
     15306**DCL     15306--REDEF   15308--REDEF
TAPE_DCBLIST$
     14852**DCL     14852--IMP-PTR
TAPE_OPEN.ACSVEH_
     15161**DCL     15162--REDEF
TAPE_OPEN.ALTKEYS_
     15167**DCL     15168--REDEF   15168--REDEF
TAPE_OPEN.HDR_
     15166**DCL     15167--REDEF
TAPE_OPEN.TAB_
     15165**DCL     15166--REDEF
TAPE_OPEN.UHL_
     15159**DCL     15160--REDEF   15160--REDEF
TAPE_OPEN.V.FSN#
     15199**DCL     15199--REDEF   15199--REDEF
TAPE_OPEN.WSN_
     15165**DCL     15165--REDEF
TAPE_READ.STATION_
     15223**DCL     15224--REDEF
TAPE_READ.V.DVBYTE.REREAD#
     15235**DCL     15235--REDEF
TAPE_READ.V.INDX#
     15233**DCL     15233--REDEF
TAPE_WRITE.STATION_
     15261**DCL     15261--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
     15268**DCL     15268--REDEF
TSN_USED_NAME.L#
     12936**DCL     12936--IMP-SIZ
TVECTOR.W2
     15392**DCL     15393--REDEF
PL6.E3A0      #004=FLC$TAPE_CLOSE_NEXT File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:41 Page:165  
WRITE_NODATA_LIST.STATION_
     14431**DCL     14431--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
     14438**DCL     14438--REDEF
WRITE_PRIME_DUAL.STATION_
     13796**DCL     13796--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
     13803**DCL     13803--REDEF
WRITE_REBUILD.STATION_
     14032**DCL     14032--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
     14039**DCL     14039--REDEF
WRITE_STATUS.STATION_
     13247**DCL     13247--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
     13254**DCL     13254--REDEF
WRITE_TSN_USED.STATION_
     12957**DCL     12957--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
     12964**DCL     12964--REDEF

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:166  
      660        1        /*T***********************************************************/
      661        2        /*T*                                                         */
      662        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      663        4        /*T*                                                         */
      664        5        /*T***********************************************************/
      665        6        FLC$READ_TAPE_BLOCK: PROC( ERR ) ALTRET;
      666        7        /*F*  NAME: FLC$READ_TAPE_BLOCK
      667        8              PURPOSE: Reads the next tape block and initializes pointers
      668        9                 for continued disk file on tape reading.
      669       10        */
      670       11
      671       12    1   DCL 1 ERR ALIGNED,
      672       13    1         2 * BIT(12) UNAL,
      673       14    1         2 * BIT(6) UNAL,
      674       15    1         2 * BIT(1) UNAL,
      675       16    1         2 CODE UBIN(14) UNAL,
      676       17    1         2 * UBIN(3) UNAL;
      677       18
      678       19        /***
      679       20         *** INCLUDE
      680       21         ***/
      681       22
      682       23        %INCLUDE CP_6;
      683     5582        %INCLUDE FLS_DATA_R;
      684     7382        %INCLUDE FLI_DATA_R;
      685     8796        %INCLUDE B_ERRORS_C;
      686     9923        %INCLUDE FLE_DATA_R;
      687    15874
      688    15875        /***
      689    15876         *** ENTRY
      690    15877         ***/
      691    15878
      692    15879    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      693    15880    1   DCL FLI$RPT_ERR ENTRY(5);
      694    15881
      695    15882        /***
      696    15883         *** BASED
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:167  
      697    15884         ***/
      698    15885
      699    15886        %F$DCB( BASED="BASED(M$TAPE00$)" );
      700    15943        %B$TCB( STCLASS="BASED(B$TCB$)" );
      701    15946        %B$ALT;
      702    15954
      703    15955        /***
      704    15956         *** AUTO
      705    15957         ***/
      706    15958
      707    15959    1   DCL DCB# UBIN WORD AUTO;
      708    15960    1   DCL 1 ERR_IGNORE ALIGNED,
      709    15961    1         2 * BIT(12) UNAL,
      710    15962    1         2 * BIT(6) UNAL,
      711    15963    1         2 * BIT(1) UNAL,
      712    15964    1         2 CODE UBIN(14) UNAL,
      713    15965    1         2 * UBIN(3) UNAL;
      714    15966
      715    15967        /****************************************/
      716    15968
      717    15969    1      CALL M$READ( TAPE_READ )
      718    15970    2       WHENRETURN DO;
      719    15971    2         IF ( F$DCB.TYC.IOERR# AND TAPE_OPEN.V.IOERROK# ) /* Tape I/O err w/cont.? */
      720    15972    3          THEN DO;
      721    15973    3            ERR = E_IO_ERR;
      722    15974    3            DCB# = TAPE_READ.V.DCB#;
      723    15975    3            CALL FLI$RPT_ERR( ERR, DCB# );
      724    15976    3            IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      725    15977    3             THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      726    15978    3            TAPE_BAD = '1'B;
      727    15979    3            CALL FLI$RPT_ERR( E_FILES_SKIPPED );
      728    15980        /***
      729    15981         *** Attempt to read next block - positioning tape past bad spot for next read.
      730    15982         *** If not possible to read past bad spot, hopefully the next open will enable
      731    15983         *** us to skip out to the next EFT_RESTRICT_FILE. A number of logical files may
      732    15984         *** be skipped in the process.
      733    15985        ***/
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:168  
      734    15986    3            CALL M$READ( TAPE_READ )
      735    15987    4             WHENRETURN DO;
      736    15988    4               BLK_TAG0$ = PINCRW( TAPE_BLOCK_.PTR$, TAPE_BLOCK_.PTR$->BLK_TAG.NBR*
             15988                        SIZEW(BLK_TAG) );
      737    15989    4               GRAN_BASE$ = PINCRW( BLK_TAG0$, SIZEW(BLK_TAG0) );
      738    15990    4               BLK_TAG$ = PINCRW( BLK_TAG0$, -SIZEW(BLK_TAG) );
      739    15991    4               MAX_FIT$ = PINCRC( TAPE_BLOCK_.PTR$, F$DCB.ARS# - 4096 );
      740    15992    4               EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG0.WHERE.PSN;
      741    15993    4               EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG0.WHERE.ACCT;
      742    15994    4               ALTRETURN;                  /* Altreturn with I/O error           */
      743    15995    4               END;
      744    15996    4             WHENALTRETURN DO;
      745    15997        /***
      746    15998         *** If blank tape encountered, this indicates no more data on tape and next
      747    15999         *** tape should be mounted and read. Any other error, except EOF, indicates more
      748    16000         *** data exists on the current tape and continued reading is necessary.
      749    16001         ***/
      750    16002    4               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$BLNKTP
      751    16003    5                THEN DO;                   /* No more data on this volume        */
      752    16004    5                  CALL FLC$TAPE_CLOSE ( ERR_IGNORE )
      753    16005    6                   WHENALTRETURN DO;
      754    16006    6                     END;
      755    16007    5                  TAPE_REMOVE.V.PSN# = F$DCB.PSN#;
      756    16008    5                  CALL M$REM( TAPE_REMOVE )
      757    16009    6                   WHENALTRETURN DO;
      758    16010    6                     CALL FLI$RPT_ERR;
      759    16011    6                     END;
      760    16012    5                  TAPE_OPEN.V.VOL# = F$DCB.VOL# + 1; /* Mount nxt vol. on nxt open */
      761    16013    5                  ALTRETURN;
      762    16014    5                  END;
      763    16015    5                ELSE DO;
      764    16016    5                  IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF /* More data on this vol. */
      765    16017    5                   THEN CALL FLI$RPT_ERR;
      766    16018    5                  CALL FLC$TAPE_CLOSE ( ERR_IGNORE )
      767    16019    6                   WHENALTRETURN DO;
      768    16020    6                     END;
      769    16021    5                  ALTRETURN;
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:169  
      770    16022    5                  END;
      771    16023    4               END;
      772    16024    3            END;
      773    16025    2         BLK_TAG0$ = PINCRW( TAPE_BLOCK_.PTR$, TAPE_BLOCK_.PTR$->BLK_TAG.NBR*SIZEW(
             16025                  BLK_TAG) );
      774    16026    2         GRAN_BASE$ = PINCRW( BLK_TAG0$, SIZEW(BLK_TAG0) );
      775    16027    2         BLK_TAG$ = PINCRW( BLK_TAG0$, -SIZEW(BLK_TAG) );
      776    16028    2         MAX_FIT$ = PINCRC( TAPE_BLOCK_.PTR$, F$DCB.ARS# - 4096 );
      777    16029    2         EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG0.WHERE.PSN;
      778    16030    2         EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG0.WHERE.ACCT;
      779    16031    2         END;
      780    16032    2       WHENALTRETURN DO;
      781    16033    2         ERR = B$TCB.ALT$->B$ALT.ERR;
      782    16034    2         IF ERR.CODE ~= %E$EOF
      783    16035    3          THEN DO;                         /* Unexpected error                   */
      784    16036    3            CALL FLI$RPT_ERR;
      785    16037    3            IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      786    16038    3             THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      787    16039    3            TAPE_BAD = '1'B;
      788    16040    3            CALL FLC$TAPE_CLOSE( ERR_IGNORE )
      789    16041    4             WHENALTRETURN DO;
      790    16042    4               END;
      791    16043    3            ALTRETURN;
      792    16044    3            END;
      793    16045    2         END;
      794    16046        /***
      795    16047         *** Detect when a file has crossed disk boundries and set flag. A
      796    16048         *** bit different from tape as files crossing tape boundries are
      797    16049         *** determined by the user trailer label written as a result of CVOL
      798    16050         *** control.
      799    16051         ***/
      800    16052    1      IF (SUBSTR(F$DCB.RES#,0,2) = 'OD' AND TAPE_SN ~= F$DCB.PSN#)
      801    16053    1       THEN CROSSED = '*';
      802    16054    1      RETURN;
      803    16055
      804    16056    1   END FLC$READ_TAPE_BLOCK;
      805    16057        %EOD;
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:170  

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:171  
--  Include file information  --

   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$READ_TAPE_BLOCK.

   Procedure FLC$READ_TAPE_BLOCK requires 179 words for executable code.
   Procedure FLC$READ_TAPE_BLOCK requires 8 words of local(AUTO) storage.

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:172  

 Object Unit name= FLC$READ_TAPE_BLOCK                        File name= FLC$ROUTINES.:E05TOU
 UTS= JUL 29 '97 15:42:28.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$TSN_USED
    2   DCB   even  none     0      0  M$STATUS
    3   DCB   even  none     0      0  M$REBUILD
    4   DCB   even  none     0      0  M$ARCHIVE
    5   DCB   even  none     0      0  M$NODATA_LIST
    6   Data  even  none    20     24  FLC$READ_TAPE_BLOCK
    7   DCB   even  none     0      0  M$PRE_RET
    8  RoData even  UTS      1      1  FLC$READ_TAPE_BLOCK
    9   Proc  even  none   179    263  FLC$READ_TAPE_BLOCK
   10  RoData even  none     1      1  FLC$READ_TAPE_BLOCK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        1  FLC$READ_TAPE_BLOCK
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:173  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
 yes     yes           Std       1 FLC$TAPE_CLOSE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$TSN_USED                            M$STATUS
     M$REBUILD                             M$ARCHIVE                             M$NODATA_LIST
     M$TAPE00$                             BLK_TAG$                              BLK_TAG0$
     NBR_BYTES_TO_MOVE                     DISK_GRAN$                            BLOCK_GRAN$
     TAPE_BLOCK_                           GRAN_BASE$                            CROSSED
r    EFTFILE_DCB$                     r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE
     MAX_FIT$                              TAPE_SN                               TAPE_BAD
     TSN_USED_NAME                         BACKUP_NAME                      r    ARCHIVE_NAME
r    PRIME_FILE                       r    DUAL_FILE                             REBUILD_NAME
     REBUILD_DIR_KEY                       REBUILD_KEY                           NODATA_FILE_NAME
     NODATA_KEY                            TAPE_DCBLIST$                         FPT_EXIT
     TAPE_OPEN                             TAPE_READ                             TAPE_REMOVE
     SNVECLIST$                            B$TCB$                                DPLIST$
     DPRESLIST$                            DISK_FILE_SPEC$                       SPECCHARS
     EFTWORD                               M$PRE_RET                             RET_CMDS_NAME
r    E_IO_ERR                         r    E_FILES_SKIPPED                       B_VECTNIL
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:174  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:175  


      660        1        /*T***********************************************************/
      661        2        /*T*                                                         */
      662        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      663        4        /*T*                                                         */
      664        5        /*T***********************************************************/
      665        6        FLC$READ_TAPE_BLOCK: PROC( ERR ) ALTRET;

      6  9 000000   000000 700200 xent  FLC$READ_TA* TSX0  ! X66_AUTO_1
         9 000001   000010 000001                    ZERO    8,1

      666        7        /*F*  NAME: FLC$READ_TAPE_BLOCK
      667        8              PURPOSE: Reads the next tape block and initializes pointers
      668        9                 for continued disk file on tape reading.
      669       10        */
      670       11
      671       12    1   DCL 1 ERR ALIGNED,
      672       13    1         2 * BIT(12) UNAL,
      673       14    1         2 * BIT(6) UNAL,
      674       15    1         2 * BIT(1) UNAL,
      675       16    1         2 CODE UBIN(14) UNAL,
      676       17    1         2 * UBIN(3) UNAL;
      677       18
      678       19        /***
      679       20         *** INCLUDE
      680       21         ***/
      681       22
      682       23        %INCLUDE CP_6;
      683     5582        %INCLUDE FLS_DATA_R;
      684     7382        %INCLUDE FLI_DATA_R;
      685     8796        %INCLUDE B_ERRORS_C;
      686     9923        %INCLUDE FLE_DATA_R;
      687    15874
      688    15875        /***
      689    15876         *** ENTRY
      690    15877         ***/
      691    15878
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:176  
      692    15879    1   DCL FLC$TAPE_CLOSE ENTRY(1) ALTRET;
      693    15880    1   DCL FLI$RPT_ERR ENTRY(5);
      694    15881
      695    15882        /***
      696    15883         *** BASED
      697    15884         ***/
      698    15885
      699    15886        %F$DCB( BASED="BASED(M$TAPE00$)" );
      700    15943        %B$TCB( STCLASS="BASED(B$TCB$)" );
      701    15946        %B$ALT;
      702    15954
      703    15955        /***
      704    15956         *** AUTO
      705    15957         ***/
      706    15958
      707    15959    1   DCL DCB# UBIN WORD AUTO;
      708    15960    1   DCL 1 ERR_IGNORE ALIGNED,
      709    15961    1         2 * BIT(12) UNAL,
      710    15962    1         2 * BIT(6) UNAL,
      711    15963    1         2 * BIT(1) UNAL,
      712    15964    1         2 CODE UBIN(14) UNAL,
      713    15965    1         2 * UBIN(3) UNAL;
      714    15966
      715    15967        /****************************************/
      716    15968
      717    15969    1      CALL M$READ( TAPE_READ )

  15969  9 000002   000000 630400 xsym               EPPR0   TAPE_READ
         9 000003   440000 713400                    CLIMB   alt,read
         9 000004   401400 401760                    pmme    nvectors=4
         9 000005   000214 702000 9                  TSX2    s:16033

      718    15970    2       WHENRETURN DO;

      719    15971    2         IF ( F$DCB.TYC.IOERR# AND TAPE_OPEN.V.IOERROK# ) /* Tape I/O err w/cont.? */

  15971  9 000006   000000 470400 xsym               LDP0    M$TAPE00$
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:177  
         9 000007   000002 430100                    FSZN    2,,PR0
         9 000010   000162 605000 9                  TPL     s:16025
         9 000011   000060 236000 xsym               LDQ     TAPE_OPEN+48
         9 000012   003000 316003                    CANQ    1536,DU
         9 000013   000162 600000 9                  TZE     s:16025

      720    15972    3          THEN DO;

      721    15973    3            ERR = E_IO_ERR;

  15973  9 000014   000000 236000 xsym               LDQ     E_IO_ERR
         9 000015   200003 471500                    LDP1    @ERR,,AUTO
         9 000016   100000 756100                    STQ     0,,PR1

      722    15974    3            DCB# = TAPE_READ.V.DCB#;

  15974  9 000017   000010 235000 xsym               LDA     TAPE_READ+8
         9 000020   000022 771000                    ARL     18
         9 000021   200004 755100                    STA     DCB#,,AUTO

      723    15975    3            CALL FLI$RPT_ERR( ERR, DCB# );

  15975  9 000022   200004 630500                    EPPR0   DCB#,,AUTO
         9 000023   200007 450500                    STP0    ERR_IGNORE+2,,AUTO
         9 000024   200003 236100                    LDQ     @ERR,,AUTO
         9 000025   200006 756100                    STQ     ERR_IGNORE+1,,AUTO
         9 000026   200006 630500                    EPPR0   ERR_IGNORE+1,,AUTO
         9 000027   000020 631400 xsym               EPPR1   B_VECTNIL+16
         9 000030   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000031   000000 011000                    NOP     0

      724    15976    3            IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  15976  9 000032   000004 236000 xsym               LDQ     FPT_EXIT+4
         9 000033   777000 376003                    ANQ     -512,DU
         9 000034   004000 116003                    CMPQ    2048,DU
         9 000035   000040 603000 9                  TRC     s:15978
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:178  

      725    15977    3             THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  15977  9 000036   004000 236003                    LDQ     2048,DU
         9 000037   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      726    15978    3            TAPE_BAD = '1'B;

  15978  9 000040   400000 236003                    LDQ     -131072,DU
         9 000041   000000 756000 xsym               STQ     TAPE_BAD

      727    15979    3            CALL FLI$RPT_ERR( E_FILES_SKIPPED );

  15979  9 000042   000000 630400 10                 EPPR0   0
         9 000043   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000044   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000045   000000 011000                    NOP     0

      728    15980        /***
      729    15981         *** Attempt to read next block - positioning tape past bad spot for next read.
      730    15982         *** If not possible to read past bad spot, hopefully the next open will enable
      731    15983         *** us to skip out to the next EFT_RESTRICT_FILE. A number of logical files may
      732    15984         *** be skipped in the process.
      733    15985        ***/
      734    15986    3            CALL M$READ( TAPE_READ )

  15986  9 000046   000000 630400 xsym               EPPR0   TAPE_READ
         9 000047   440000 713400                    CLIMB   alt,read
         9 000050   401400 401760                    pmme    nvectors=4
         9 000051   000105 702000 9                  TSX2    s:16002

      735    15987    4             WHENRETURN DO;

      736    15988    4               BLK_TAG0$ = PINCRW( TAPE_BLOCK_.PTR$, TAPE_BLOCK_.PTR$->BLK_TAG.NBR*
             15988                        SIZEW(BLK_TAG) );

  15988  9 000052   000001 470400 xsym               LDP0    TAPE_BLOCK_+1
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:179  
         9 000053   000000 236100                    LDQ     0,,PR0
         9 000054   000011 772000                    QRL     9
         9 000055   000777 376007                    ANQ     511,DL
         9 000056   000013 402003                    MPY     11,DU
         9 000057   000001 036000 xsym               ADLQ    TAPE_BLOCK_+1
         9 000060   000000 756000 xsym               STQ     BLK_TAG0$

      737    15989    4               GRAN_BASE$ = PINCRW( BLK_TAG0$, SIZEW(BLK_TAG0) );

  15989  9 000061   000013 036003                    ADLQ    11,DU
         9 000062   000000 756000 xsym               STQ     GRAN_BASE$

      738    15990    4               BLK_TAG$ = PINCRW( BLK_TAG0$, -SIZEW(BLK_TAG) );

  15990  9 000063   000000 236000 xsym               LDQ     BLK_TAG0$
         9 000064   777765 036003                    ADLQ    -11,DU
         9 000065   000000 756000 xsym               STQ     BLK_TAG$

      739    15991    4               MAX_FIT$ = PINCRC( TAPE_BLOCK_.PTR$, F$DCB.ARS# - 4096 );

  15991  9 000066   000000 471400 xsym               LDP1    M$TAPE00$
         9 000067   100000 236100                    LDQ     0,,PR1
         9 000070   000020 736000                    QLS     16
         9 000071   002000 136003                    SBLQ    1024,DU
         9 000072   000001 036000 xsym               ADLQ    TAPE_BLOCK_+1
         9 000073   000000 756000 xsym               STQ     MAX_FIT$

      740    15992    4               EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG0.WHERE.PSN;

  15992  9 000074   000000 473400 xsym               LDP3    BLK_TAG0$
         9 000075   000000 474400 xsym               LDP4    EFTFILE_DCB$
         9 000076   040100 100500                    MLR     fill='040'O
         9 000077   300003 000006                    ADSC9   3,,PR3                   cn=0,n=6
         9 000100   400024 000006                    ADSC9   20,,PR4                  cn=0,n=6

      741    15993    4               EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG0.WHERE.ACCT;

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:180  
  15993  9 000101   040100 100500                    MLR     fill='040'O
         9 000102   300004 400010                    ADSC9   4,,PR3                   cn=2,n=8
         9 000103   400020 000010                    ADSC9   16,,PR4                  cn=0,n=8

      742    15994    4               ALTRETURN;                  /* Altreturn with I/O error           */

  15994  9 000104   000000 702200 xent               TSX2  ! X66_AALT

      743    15995    4               END;
      744    15996    4             WHENALTRETURN DO;

      745    15997        /***
      746    15998         *** If blank tape encountered, this indicates no more data on tape and next
      747    15999         *** tape should be mounted and read. Any other error, except EOF, indicates more
      748    16000         *** data exists on the current tape and continued reading is necessary.
      749    16001         ***/
      750    16002    4               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$BLNKTP

  16002  9 000105   000000 470400 xsym               LDP0    B$TCB$
         9 000106   000000 471500                    LDP1    0,,PR0
         9 000107   100102 236100                    LDQ     66,,PR1
         9 000110   377770 376007                    ANQ     131064,DL
         9 000111   000050 116007                    CMPQ    40,DL
         9 000112   000145 601000 9                  TNZ     s:16016

      751    16003    5                THEN DO;                   /* No more data on this volume        */

      752    16004    5                  CALL FLC$TAPE_CLOSE ( ERR_IGNORE )

  16004  9 000113   200005 633500                    EPPR3   ERR_IGNORE,,AUTO
         9 000114   200006 453500                    STP3    ERR_IGNORE+1,,AUTO
         9 000115   200006 630500                    EPPR0   ERR_IGNORE+1,,AUTO
         9 000116   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000117   000000 701000 xent               TSX1    FLC$TAPE_CLOSE
         9 000120   000122 702000 9                  TSX2    s:16007
         9 000121   000122 710000 9                  TRA     s:16007

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:181  
      753    16005    6                   WHENALTRETURN DO;

      754    16006    6                     END;

      755    16007    5                  TAPE_REMOVE.V.PSN# = F$DCB.PSN#;

  16007  9 000122   000000 470400 xsym               LDP0    M$TAPE00$
         9 000123   040000 100500                    MLR     fill='040'O
         9 000124   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         9 000125   000002 400006 xsym               ADSC9   TAPE_REMOVE+2            cn=2,n=6

      756    16008    5                  CALL M$REM( TAPE_REMOVE )

  16008  9 000126   000000 630400 xsym               EPPR0   TAPE_REMOVE
         9 000127   460006 713400                    CLIMB   alt,+24582
         9 000130   400000 401760                    pmme    nvectors=1
         9 000131   000133 702000 9                  TSX2    s:16010
         9 000132   000136 710000 9                  TRA     s:16012

      757    16009    6                   WHENALTRETURN DO;

      758    16010    6                     CALL FLI$RPT_ERR;

  16010  9 000133   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 000134   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000135   000000 011000                    NOP     0

      759    16011    6                     END;

      760    16012    5                  TAPE_OPEN.V.VOL# = F$DCB.VOL# + 1; /* Mount nxt vol. on nxt open */

  16012  9 000136   000000 470400 xsym               LDP0    M$TAPE00$
         9 000137   000043 236100                    LDQ     35,,PR0
         9 000140   000033 772000                    QRL     27
         9 000141   000001 036007                    ADLQ    1,DL
         9 000142   000033 736000                    QLS     27
         9 000143   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:182  

      761    16013    5                  ALTRETURN;

  16013  9 000144   000000 702200 xent               TSX2  ! X66_AALT

      762    16014    5                  END;
      763    16015    5                ELSE DO;

      764    16016    5                  IF B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$EOF /* More data on this vol. */

  16016  9 000145   000060 116007                    CMPQ    48,DL
         9 000146   000152 600000 9                  TZE     s:16018

      765    16017    5                   THEN CALL FLI$RPT_ERR;

  16017  9 000147   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 000150   000000 701000 xent               TSX1    FLI$RPT_ERR
         9 000151   000000 011000                    NOP     0

      766    16018    5                  CALL FLC$TAPE_CLOSE ( ERR_IGNORE )

  16018  9 000152   200005 630500                    EPPR0   ERR_IGNORE,,AUTO
         9 000153   200006 450500                    STP0    ERR_IGNORE+1,,AUTO
         9 000154   200006 630500                    EPPR0   ERR_IGNORE+1,,AUTO
         9 000155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000156   000000 701000 xent               TSX1    FLC$TAPE_CLOSE
         9 000157   000161 702000 9                  TSX2    s:16021
         9 000160   000161 710000 9                  TRA     s:16021

      767    16019    6                   WHENALTRETURN DO;

      768    16020    6                     END;

      769    16021    5                  ALTRETURN;

  16021  9 000161   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:183  
      770    16022    5                  END;
      771    16023    4               END;
      772    16024    3            END;
      773    16025    2         BLK_TAG0$ = PINCRW( TAPE_BLOCK_.PTR$, TAPE_BLOCK_.PTR$->BLK_TAG.NBR*SIZEW(
             16025                  BLK_TAG) );

  16025  9 000162   000001 471400 xsym               LDP1    TAPE_BLOCK_+1
         9 000163   100000 236100                    LDQ     0,,PR1
         9 000164   000011 772000                    QRL     9
         9 000165   000777 376007                    ANQ     511,DL
         9 000166   000013 402003                    MPY     11,DU
         9 000167   000001 036000 xsym               ADLQ    TAPE_BLOCK_+1
         9 000170   000000 756000 xsym               STQ     BLK_TAG0$

      774    16026    2         GRAN_BASE$ = PINCRW( BLK_TAG0$, SIZEW(BLK_TAG0) );

  16026  9 000171   000013 036003                    ADLQ    11,DU
         9 000172   000000 756000 xsym               STQ     GRAN_BASE$

      775    16027    2         BLK_TAG$ = PINCRW( BLK_TAG0$, -SIZEW(BLK_TAG) );

  16027  9 000173   000000 236000 xsym               LDQ     BLK_TAG0$
         9 000174   777765 036003                    ADLQ    -11,DU
         9 000175   000000 756000 xsym               STQ     BLK_TAG$

      776    16028    2         MAX_FIT$ = PINCRC( TAPE_BLOCK_.PTR$, F$DCB.ARS# - 4096 );

  16028  9 000176   000000 236100                    LDQ     0,,PR0
         9 000177   000020 736000                    QLS     16
         9 000200   002000 136003                    SBLQ    1024,DU
         9 000201   000001 036000 xsym               ADLQ    TAPE_BLOCK_+1
         9 000202   000000 756000 xsym               STQ     MAX_FIT$

      777    16029    2         EFTFILE_DCB$->F$DCB.PSN# = BLK_TAG0.WHERE.PSN;

  16029  9 000203   000000 473400 xsym               LDP3    BLK_TAG0$
         9 000204   000000 474400 xsym               LDP4    EFTFILE_DCB$
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:184  
         9 000205   040100 100500                    MLR     fill='040'O
         9 000206   300003 000006                    ADSC9   3,,PR3                   cn=0,n=6
         9 000207   400024 000006                    ADSC9   20,,PR4                  cn=0,n=6

      778    16030    2         EFTFILE_DCB$->F$DCB.ACCT# = BLK_TAG0.WHERE.ACCT;

  16030  9 000210   040100 100500                    MLR     fill='040'O
         9 000211   300004 400010                    ADSC9   4,,PR3                   cn=2,n=8
         9 000212   400020 000010                    ADSC9   16,,PR4                  cn=0,n=8

      779    16031    2         END;

  16031  9 000213   000250 710000 9                  TRA     s:16052

      780    16032    2       WHENALTRETURN DO;

      781    16033    2         ERR = B$TCB.ALT$->B$ALT.ERR;

  16033  9 000214   000000 470400 xsym               LDP0    B$TCB$
         9 000215   000000 471500                    LDP1    0,,PR0
         9 000216   100102 236100                    LDQ     66,,PR1
         9 000217   200003 473500                    LDP3    @ERR,,AUTO
         9 000220   300000 756100                    STQ     0,,PR3

      782    16034    2         IF ERR.CODE ~= %E$EOF

  16034  9 000221   300000 236100                    LDQ     0,,PR3
         9 000222   377770 376007                    ANQ     131064,DL
         9 000223   000060 116007                    CMPQ    48,DL
         9 000224   000250 600000 9                  TZE     s:16052

      783    16035    3          THEN DO;                         /* Unexpected error                   */

      784    16036    3            CALL FLI$RPT_ERR;

  16036  9 000225   000002 631400 xsym               EPPR1   B_VECTNIL+2
         9 000226   000000 701000 xent               TSX1    FLI$RPT_ERR
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:185  
         9 000227   000000 011000                    NOP     0

      785    16037    3            IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16037  9 000230   000004 236000 xsym               LDQ     FPT_EXIT+4
         9 000231   777000 376003                    ANQ     -512,DU
         9 000232   004000 116003                    CMPQ    2048,DU
         9 000233   000236 603000 9                  TRC     s:16039

      786    16038    3             THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16038  9 000234   004000 236003                    LDQ     2048,DU
         9 000235   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      787    16039    3            TAPE_BAD = '1'B;

  16039  9 000236   400000 236003                    LDQ     -131072,DU
         9 000237   000000 756000 xsym               STQ     TAPE_BAD

      788    16040    3            CALL FLC$TAPE_CLOSE( ERR_IGNORE )

  16040  9 000240   200005 630500                    EPPR0   ERR_IGNORE,,AUTO
         9 000241   200006 450500                    STP0    ERR_IGNORE+1,,AUTO
         9 000242   200006 630500                    EPPR0   ERR_IGNORE+1,,AUTO
         9 000243   000017 631400 xsym               EPPR1   B_VECTNIL+15
         9 000244   000000 701000 xent               TSX1    FLC$TAPE_CLOSE
         9 000245   000247 702000 9                  TSX2    s:16043
         9 000246   000247 710000 9                  TRA     s:16043

      789    16041    4             WHENALTRETURN DO;

      790    16042    4               END;

      791    16043    3            ALTRETURN;

  16043  9 000247   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:186  
      792    16044    3            END;
      793    16045    2         END;
      794    16046        /***
      795    16047         *** Detect when a file has crossed disk boundries and set flag. A
      796    16048         *** bit different from tape as files crossing tape boundries are
      797    16049         *** determined by the user trailer label written as a result of CVOL
      798    16050         *** control.
      799    16051         ***/
      800    16052    1      IF (SUBSTR(F$DCB.RES#,0,2) = 'OD' AND TAPE_SN ~= F$DCB.PSN#)

  16052  9 000250   000000 470400 xsym               LDP0    M$TAPE00$
         9 000251   000026 220100                    LDX0    22,,PR0
         9 000252   000000 100000 8                  CMPX0   0
         9 000253   000262 601000 9                  TNZ     s:16054
         9 000254   040100 106400                    CMPC    fill='040'O
         9 000255   000000 000006 xsym               ADSC9   TAPE_SN                  cn=0,n=6
         9 000256   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         9 000257   000262 600000 9                  TZE     s:16054

      801    16053    1       THEN CROSSED = '*';

  16053  9 000260   052000 236003                    LDQ     21504,DU
         9 000261   000000 756000 xsym               STQ     CROSSED

      802    16054    1      RETURN;

  16054  9 000262   000000 702200 xent               TSX2  ! X66_ARET
      803    16055
      804    16056    1   END FLC$READ_TAPE_BLOCK;
      805    16057        %EOD;

PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:187  
--  Include file information  --

   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$READ_TAPE_BLOCK.
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:188  

 **** Variables and constants ****

  ****  Section 006  Data  FLC$READ_TAPE_BLOCK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/d STRC(360)   r     1 DEL_NODATA_REC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ERR                       4-0-0/w UBIN        r     1 DCB#
    *0-0-0/w STRC        r     1 ERR                        5-0-0/w STRC        r     1 ERR_IGNORE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 BACKUP_NAME                0-0-0/w PTR         r     1 BLK_TAG$
     0-0-0/w PTR         r     1 BLK_TAG0$                  0-0-0/w PTR         r     1 BLOCK_GRAN$
     0-0-0/c CHAR        r     1 CROSSED                    0-0-0/w PTR         r     1 DISK_FILE_SPEC$
     0-0-0/w PTR         r     1 DISK_GRAN$                 0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/c ASTR(9)     r     1 DUAL_FILE
     0-0-0/w PTR         r     1 EFTFILE_DCB$               0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE
     0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE          0-0-0/w STRC        r     1 E_FILES_SKIPPED
     0-0-0/w STRC        r     1 E_IO_ERR                   0-0-0/d STRC(216)   r     1 FPT_EXIT
     0-0-0/w PTR         r     1 GRAN_BASE$                 0-0-0/w PTR         r     1 M$TAPE00$
     0-0-0/w PTR         r     1 MAX_FIT$                   0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE
     0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME           0-0-0/c STRC(369)   r     1 NODATA_KEY
     0-0-0/c ASTR(9)     r     1 PRIME_FILE                 0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_KEY                0-0-0/c ASTR(9)     r     1 REBUILD_NAME
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:189  
     0-0-0/b BIT         r     1 TAPE_BAD                   0-0-0/d STRC(72)    r     1 TAPE_BLOCK_
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/d STRC(2088)  r     1 TAPE_OPEN
     0-0-0/d STRC(504)   r     1 TAPE_READ                  0-0-0/d STRC(144)   r     1 TAPE_REMOVE
     0-0-0/c CHAR(6)     r     1 TAPE_SN                    0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(396)   r     1 BLK_TAG                    0-0-0/w STRC(396)   r     1 BLK_TAG0
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$NODATA_LIST


   Procedure FLC$READ_TAPE_BLOCK requires 179 words for executable code.
   Procedure FLC$READ_TAPE_BLOCK requires 8 words of local(AUTO) storage.
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:190  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:191  
          MINI XREF LISTING

ARCHIVE_NAME.L#
      6474**DCL      6474--IMP-SIZ
B$ALT.CODE
     15948**DCL     15948--REDEF   15949--REDEF   15949--REDEF
B$ALT.ERR
     15949**DCL     16033>>ASSIGN
B$ALT.ERR.CODE
     15950**DCL     16002>>IF      16016>>IF
B$ALT.ERR.ERR#
     15950**DCL     15950--REDEF
B$ALT.EVID
     15949**DCL     15949--REDEF   15949--REDEF
B$TCB.ALT$
     15944**DCL     16002>>IF      16016>>IF      16033>>ASSIGN
B$TCB$
      8313**DCL     15944--IMP-PTR 16002>>IF      16016>>IF      16033>>ASSIGN
BACKUP_NAME.L#
      6118**DCL      6118--IMP-SIZ
BLK_TAG
      5607**DCL     15988--ASSIGN  15990--ASSIGN  16025--ASSIGN  16027--ASSIGN
BLK_TAG.NAME
      5610**DCL      5610--REDEF
BLK_TAG.NBR
      5609**DCL     15988>>ASSIGN  16025>>ASSIGN
BLK_TAG$
      5607**DCL      5607--IMP-PTR 15990<<ASSIGN  16027<<ASSIGN
BLK_TAG0
      5613**DCL     15989--ASSIGN  16026--ASSIGN
BLK_TAG0.NAME
      5616**DCL      5616--REDEF
BLK_TAG0.WHERE.ACCT
      5616**DCL     15993>>ASSIGN  16030>>ASSIGN
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:192  
BLK_TAG0.WHERE.PSN
      5616**DCL     15992>>ASSIGN  16029>>ASSIGN
BLK_TAG0$
      5613**DCL      5613--IMP-PTR 15988<<ASSIGN  15989>>ASSIGN  15990>>ASSIGN  15992>>ASSIGN  15993>>ASSIGN
     16025<<ASSIGN  16026>>ASSIGN  16027>>ASSIGN  16029>>ASSIGN  16030>>ASSIGN
BLOCK_GRAN$
      5620**DCL      5621--IMP-PTR
CLOSE_NODATA_LIST.SN_
      7272**DCL      7272--REDEF
CLOSE_NODATA_LIST.UTL_
      7273**DCL      7273--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
      7287**DCL      7287--REDEF
CLOSE_NODATA_LIST.V.TYPE#
      7285**DCL      7285--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
      7282**DCL      7282--REDEF    7284--REDEF
CLOSE_PRIME_DUAL.SN_
      6749**DCL      6749--REDEF
CLOSE_PRIME_DUAL.UTL_
      6750**DCL      6750--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
      6764**DCL      6764--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
      6762**DCL      6762--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
      6759**DCL      6759--REDEF    6761--REDEF
CLOSE_REBUILD.SN_
      7024**DCL      7024--REDEF
CLOSE_REBUILD.UTL_
      7025**DCL      7025--REDEF
CLOSE_REBUILD.V.EXPIRE#
      7039**DCL      7039--REDEF
CLOSE_REBUILD.V.TYPE#
      7037**DCL      7037--REDEF
CLOSE_REBUILD.V.XTNSIZE#
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:193  
      7034**DCL      7034--REDEF    7036--REDEF
CLOSE_STATUS.SN_
      6239**DCL      6239--REDEF
CLOSE_STATUS.UTL_
      6240**DCL      6240--REDEF
CLOSE_STATUS.V.EXPIRE#
      6254**DCL      6254--REDEF
CLOSE_STATUS.V.TYPE#
      6252**DCL      6252--REDEF
CLOSE_STATUS.V.XTNSIZE#
      6249**DCL      6249--REDEF    6251--REDEF
CLOSE_TSN_USED.SN_
      5949**DCL      5949--REDEF
CLOSE_TSN_USED.UTL_
      5950**DCL      5950--REDEF
CLOSE_TSN_USED.V.EXPIRE#
      5964**DCL      5964--REDEF
CLOSE_TSN_USED.V.TYPE#
      5962**DCL      5962--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
      5959**DCL      5959--REDEF    5961--REDEF
CON_CLOSE_ARCHIVE.SN_
      6281**DCL      6281--REDEF
CON_CLOSE_ARCHIVE.UTL_
      6282**DCL      6282--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
      6296**DCL      6296--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
      6294**DCL      6294--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
      6291**DCL      6291--REDEF    6293--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
      6368**DCL      6369--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
      6374**DCL      6375--REDEF    6375--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:194  
      6373**DCL      6374--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
      6372**DCL      6373--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
      6366**DCL      6367--REDEF    6367--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
      6406**DCL      6406--REDEF    6406--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
      6372**DCL      6372--REDEF
CON_READ_ARCHIVE_FILE.STATION_
      6430**DCL      6431--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
      6442**DCL      6442--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
      6440**DCL      6440--REDEF
CROSSED
      5642**DCL     16053<<ASSIGN
CVOL_UTL.ULBL#
      5709**DCL      5709--REDEF
DCB#
     15959**DCL     15974<<ASSIGN  15975<>CALL
DEL_NODATA_REC.V
      7375**DCL      7372--DCLINIT
DISK_CLOSE.SN_
      7993**DCL      7993--REDEF
DISK_CLOSE.UTL_
      7994**DCL      7994--REDEF
DISK_CLOSE.V.EXPIRE#
      8008**DCL      8008--REDEF
DISK_CLOSE.V.TYPE#
      8006**DCL      8006--REDEF
DISK_CLOSE.V.XTNSIZE#
      8003**DCL      8003--REDEF    8005--REDEF
DISK_FILE_SPEC.SPEC
      8358**DCL      8360--REDEF
DISK_FILE_SPEC.SPEC.START
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:195  
      8359**DCL      8359--REDEF
DISK_FILE_SPEC.SPEC.STOP
      8360**DCL      8360--REDEF
DISK_FILE_SPEC$
      8357**DCL      8358--IMP-PTR
DISK_GRAN$
      5620**DCL      5620--IMP-PTR
DISK_OPEN.ACSVEH_
      7858**DCL      7859--REDEF
DISK_OPEN.ALTKEYS_
      7864**DCL      7865--REDEF    7865--REDEF
DISK_OPEN.HDR_
      7863**DCL      7864--REDEF
DISK_OPEN.TAB_
      7862**DCL      7863--REDEF
DISK_OPEN.UHL_
      7856**DCL      7857--REDEF    7857--REDEF
DISK_OPEN.V.FSN#
      7896**DCL      7896--REDEF    7896--REDEF
DISK_OPEN.WSN_
      7862**DCL      7862--REDEF
DISK_READ.STATION_
      7920**DCL      7921--REDEF
DISK_READ.V.DVBYTE.REREAD#
      7932**DCL      7932--REDEF
DISK_READ.V.INDX#
      7930**DCL      7930--REDEF
DISK_WRITE.STATION_
      7958**DCL      7958--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7965**DCL      7965--REDEF
DPLIST$
      8343**DCL      8355--IMP-PTR
DPRESLIST$
      8357**DCL      8357--IMP-PTR
DUAL_FILE.L#
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:196  
      6545**DCL      6545--IMP-SIZ
EFTFILE_DCB$
      5642**DCL     15992>>ASSIGN  15993>>ASSIGN  16029>>ASSIGN  16030>>ASSIGN
EFTWORD
      8478**DCL      8478--REDEF
EFT_CVOL_FILE.L#
      5669**DCL      5669--IMP-SIZ
EFT_RESTRICT_FILE.L#
      5696**DCL      5696--IMP-SIZ
ERR
        12**DCL         6--PROC    15973<<ASSIGN  15975<>CALL    16033<<ASSIGN
ERR.CODE
        16**DCL     16034>>IF
ERR_IGNORE
     15960**DCL     16004<>CALL    16018<>CALL    16040<>CALL
E_FILES_SKIPPED
     15481**DCL     15979<>CALL
E_IO_ERR
     15391**DCL     15973>>ASSIGN
F$DCB.ACCT#
     15903**DCL     15993<<ASSIGN  16030<<ASSIGN
F$DCB.ACTPOS
     15919**DCL     15919--REDEF
F$DCB.ARS#
     15893**DCL     15893--REDEF   15991>>ASSIGN  16028>>ASSIGN
F$DCB.ATTR
     15912**DCL     15913--REDEF
F$DCB.BORROW
     15927**DCL     15927--REDEF   15927--REDEF   15927--REDEF
F$DCB.DCBNAME.L
     15941**DCL     15941--IMP-SIZ
F$DCB.EOMCHAR#
     15897**DCL     15897--REDEF
F$DCB.FLDID
     15922**DCL     15922--REDEF
F$DCB.FORM$
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:197  
     15916**DCL     15916--REDEF
F$DCB.FSECT
     15932**DCL     15932--REDEF
F$DCB.FSN#
     15909**DCL     15909--REDEF   15909--REDEF   15910--REDEF
F$DCB.HEADER$
     15915**DCL     15915--REDEF
F$DCB.IXTNSIZE#
     15913**DCL     15913--REDEF
F$DCB.LASTSTA$
     15902**DCL     15902--REDEF
F$DCB.LVL
     15928**DCL     15928--REDEF
F$DCB.NAME#.C
     15903**DCL     15903--REDEF
F$DCB.NOEOF
     15925**DCL     15925--REDEF
F$DCB.NRECS#
     15914**DCL     15914--REDEF
F$DCB.NRECX
     15933**DCL     15933--REDEF
F$DCB.OHDR
     15925**DCL     15925--REDEF
F$DCB.ORG#
     15908**DCL     15908--REDEF
F$DCB.PRECNO
     15931**DCL     15931--REDEF
F$DCB.PSN#
     15903**DCL     15992<<ASSIGN  16007>>ASSIGN  16029<<ASSIGN  16052>>IF
F$DCB.RCSZ
     15937**DCL     15937--REDEF
F$DCB.RES#
     15904**DCL     15904--REDEF   16052>>IF
F$DCB.SETX
     15916**DCL     15916--REDEF
F$DCB.TAB$
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:198  
     15916**DCL     15916--REDEF
F$DCB.TDA
     15930**DCL     15931--REDEF
F$DCB.TYC.IOERR#
     15894**DCL     15971>>IF
F$DCB.VOL#
     15914**DCL     16012>>ASSIGN
F$DCB.WSN#
     15904**DCL     15904--REDEF
FIT_AREA.W2
      5980**DCL      5981--REDEF
FLC$TAPE_CLOSE
     15879**DCL-ENT 16004--CALL    16018--CALL    16040--CALL
FLI$RPT_ERR
     15880**DCL-ENT 15975--CALL    15979--CALL    16010--CALL    16017--CALL    16036--CALL
FPT_EXIT.V.STEPCC#
      7783**DCL      7783--REDEF   15976>>IF      15977<<ASSIGN  16037>>IF      16038<<ASSIGN
GRAN_BASE$
      5638**DCL     15989<<ASSIGN  16026<<ASSIGN
M$READ
      5511**DCL-ENT 15969--CALL    15986--CALL
M$REM
      5519**DCL-ENT 16008--CALL
M$TAPE00$
      5606**DCL     15887--IMP-PTR 15971>>IF      15991>>ASSIGN  16007>>ASSIGN  16012>>ASSIGN  16028>>ASSIGN
     16052>>IF      16052>>IF
MAX_FIT$
      5712**DCL     15991<<ASSIGN  16028<<ASSIGN
NBR_BYTES_TO_MOVE
      5619**DCL      5620--IMP-SIZ  5621--IMP-SIZ
NODATA_FILE_NAME.L#
      7234**DCL      7234--IMP-SIZ
NODATA_KEY
      7380**DCL      7372--DCLINIT  7373--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
      7167**DCL      7168--REDEF
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:199  
OPEN_NODATA_LIST.ALTKEYS_
      7173**DCL      7174--REDEF    7174--REDEF
OPEN_NODATA_LIST.HDR_
      7172**DCL      7173--REDEF
OPEN_NODATA_LIST.TAB_
      7171**DCL      7172--REDEF
OPEN_NODATA_LIST.UHL_
      7165**DCL      7166--REDEF    7166--REDEF
OPEN_NODATA_LIST.V.FSN#
      7205**DCL      7205--REDEF    7205--REDEF
OPEN_NODATA_LIST.WSN_
      7171**DCL      7171--REDEF
OPEN_PRIME_DUAL.ACSVEH_
      6614**DCL      6615--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
      6620**DCL      6621--REDEF    6621--REDEF
OPEN_PRIME_DUAL.HDR_
      6619**DCL      6620--REDEF
OPEN_PRIME_DUAL.TAB_
      6618**DCL      6619--REDEF
OPEN_PRIME_DUAL.UHL_
      6612**DCL      6613--REDEF    6613--REDEF
OPEN_PRIME_DUAL.V.FSN#
      6652**DCL      6652--REDEF    6652--REDEF
OPEN_PRIME_DUAL.WSN_
      6618**DCL      6618--REDEF
OPEN_REBUILD.ACSVEH_
      6849**DCL      6850--REDEF
OPEN_REBUILD.ALTKEYS_
      6855**DCL      6856--REDEF    6856--REDEF
OPEN_REBUILD.HDR_
      6854**DCL      6855--REDEF
OPEN_REBUILD.TAB_
      6853**DCL      6854--REDEF
OPEN_REBUILD.UHL_
      6847**DCL      6848--REDEF    6848--REDEF
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:200  
OPEN_REBUILD.V.FSN#
      6887**DCL      6887--REDEF    6887--REDEF
OPEN_REBUILD.WSN_
      6853**DCL      6853--REDEF
OPEN_STATUS.ACSVEH_
      6051**DCL      6052--REDEF
OPEN_STATUS.ALTKEYS_
      6057**DCL      6058--REDEF    6058--REDEF
OPEN_STATUS.HDR_
      6056**DCL      6057--REDEF
OPEN_STATUS.TAB_
      6055**DCL      6056--REDEF
OPEN_STATUS.UHL_
      6049**DCL      6050--REDEF    6050--REDEF
OPEN_STATUS.V.FSN#
      6089**DCL      6089--REDEF    6089--REDEF
OPEN_STATUS.WSN_
      6055**DCL      6055--REDEF
OPEN_TSN_USED.ACSVEH_
      5787**DCL      5788--REDEF
OPEN_TSN_USED.ALTKEYS_
      5793**DCL      5794--REDEF    5794--REDEF
OPEN_TSN_USED.HDR_
      5792**DCL      5793--REDEF
OPEN_TSN_USED.TAB_
      5791**DCL      5792--REDEF
OPEN_TSN_USED.UHL_
      5785**DCL      5786--REDEF    5786--REDEF
OPEN_TSN_USED.V.FSN#
      5825**DCL      5825--REDEF    5825--REDEF
OPEN_TSN_USED.WSN_
      5791**DCL      5791--REDEF
PRE_RET_CLOSE.SN_
      8721**DCL      8721--REDEF
PRE_RET_CLOSE.UTL_
      8722**DCL      8722--REDEF
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:201  
PRE_RET_CLOSE.V.EXPIRE#
      8736**DCL      8736--REDEF
PRE_RET_CLOSE.V.TYPE#
      8734**DCL      8734--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      8731**DCL      8731--REDEF    8733--REDEF
PRE_RET_OPEN.ACSVEH_
      8656**DCL      8657--REDEF
PRE_RET_OPEN.ALTKEYS_
      8662**DCL      8663--REDEF    8663--REDEF
PRE_RET_OPEN.HDR_
      8661**DCL      8662--REDEF
PRE_RET_OPEN.TAB_
      8660**DCL      8661--REDEF
PRE_RET_OPEN.UHL_
      8654**DCL      8655--REDEF    8655--REDEF
PRE_RET_OPEN.V.FSN#
      8694**DCL      8694--REDEF    8694--REDEF
PRE_RET_OPEN.WSN_
      8660**DCL      8660--REDEF
PRE_RET_READ.STATION_
      8511**DCL      8512--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      8523**DCL      8523--REDEF
PRE_RET_READ.V.INDX#
      8521**DCL      8521--REDEF
PRE_RET_WRITE.STATION_
      8549**DCL      8549--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      8556**DCL      8556--REDEF
PRIME_FILE.L#
      6518**DCL      6518--IMP-SIZ
READ_NODATA_LIST.STATION_
      7311**DCL      7312--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
      7323**DCL      7323--REDEF
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:202  
READ_NODATA_LIST.V.INDX#
      7321**DCL      7321--REDEF
READ_PRIME_DUAL.STATION_
      6676**DCL      6677--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
      6688**DCL      6688--REDEF
READ_PRIME_DUAL.V.INDX#
      6686**DCL      6686--REDEF
READ_REBUILD.STATION_
      6982**DCL      6983--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
      6994**DCL      6994--REDEF
READ_REBUILD.V.INDX#
      6992**DCL      6992--REDEF
READ_STATUS.STATION_
      6197**DCL      6198--REDEF
READ_STATUS.V.DVBYTE.REREAD#
      6209**DCL      6209--REDEF
READ_STATUS.V.INDX#
      6207**DCL      6207--REDEF
READ_TSN_USED.STATION_
      5907**DCL      5908--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
      5919**DCL      5919--REDEF
READ_TSN_USED.V.INDX#
      5917**DCL      5917--REDEF
REBUILD_DIR_KEY.L#
      7068**DCL      7068--IMP-SIZ
REBUILD_KEY.L#
      7095**DCL      7095--IMP-SIZ
REBUILD_NAME.L#
      6916**DCL      6916--IMP-SIZ
RET_CMDS_NAME.L#
      8765**DCL      8765--IMP-SIZ
SNVECLIST$
      8297**DCL      8297--IMP-PTR
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:203  
SPEC.START
      8361**DCL      8362--REDEF
SPEC.STOP
      8362**DCL      8363--REDEF
SPECCHARS
      8361**DCL      8361--REDEF
TAPE_BAD
      5714**DCL     15978<<ASSIGN  16039<<ASSIGN
TAPE_BLOCK_.PTR$
      5636**DCL     15988>>ASSIGN  15988>>ASSIGN  15991>>ASSIGN  16025>>ASSIGN  16025>>ASSIGN  16028>>ASSIGN
TAPE_BLOCK_.W2
      5635**DCL      5636--REDEF
TAPE_CLOSE.SN_
      8214**DCL      8214--REDEF
TAPE_CLOSE.UTL_
      8215**DCL      8215--REDEF
TAPE_CLOSE.V.EXPIRE#
      8229**DCL      8229--REDEF
TAPE_CLOSE.V.TYPE#
      8227**DCL      8227--REDEF
TAPE_CLOSE.V.XTNSIZE#
      8224**DCL      8224--REDEF    8226--REDEF
TAPE_DCBLIST$
      7770**DCL      7770--IMP-PTR
TAPE_OPEN.ACSVEH_
      8079**DCL      8080--REDEF
TAPE_OPEN.ALTKEYS_
      8085**DCL      8086--REDEF    8086--REDEF
TAPE_OPEN.HDR_
      8084**DCL      8085--REDEF
TAPE_OPEN.TAB_
      8083**DCL      8084--REDEF
TAPE_OPEN.UHL_
      8077**DCL      8078--REDEF    8078--REDEF
TAPE_OPEN.V.FSN#
      8117**DCL      8117--REDEF    8117--REDEF
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:204  
TAPE_OPEN.V.IOERROK#
      8108**DCL     15971>>IF
TAPE_OPEN.V.VOL#
      8111**DCL     16012<<ASSIGN
TAPE_OPEN.WSN_
      8083**DCL      8083--REDEF
TAPE_READ
      8138**DCL     15969<>CALL    15986<>CALL
TAPE_READ.STATION_
      8141**DCL      8142--REDEF
TAPE_READ.V.DCB#
      8142**DCL     15974>>ASSIGN
TAPE_READ.V.DVBYTE.REREAD#
      8153**DCL      8153--REDEF
TAPE_READ.V.INDX#
      8151**DCL      8151--REDEF
TAPE_REMOVE
      8258**DCL     16008<>CALL
TAPE_REMOVE.V.PSN#
      8259**DCL     16007<<ASSIGN
TAPE_SN
      5712**DCL     16052>>IF
TAPE_WRITE.STATION_
      8179**DCL      8179--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      8186**DCL      8186--REDEF
TSN_USED_NAME.L#
      5854**DCL      5854--IMP-SIZ
TVECTOR.W2
      8310**DCL      8311--REDEF
WRITE_NODATA_LIST.STATION_
      7349**DCL      7349--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
      7356**DCL      7356--REDEF
WRITE_PRIME_DUAL.STATION_
      6714**DCL      6714--REDEF
PL6.E3A0      #005=FLC$READ_TAPE_BLOCK File=FLC$ROUTINES.:E05TSI                 TUE 07/29/97 15:42 Page:205  
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
      6721**DCL      6721--REDEF
WRITE_REBUILD.STATION_
      6950**DCL      6950--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
      6957**DCL      6957--REDEF
WRITE_STATUS.STATION_
      6165**DCL      6165--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
      6172**DCL      6172--REDEF
WRITE_TSN_USED.STATION_
      5875**DCL      5875--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
      5882**DCL      5882--REDEF

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:206  
      806        1        /*T***********************************************************/
      807        2        /*T*                                                         */
      808        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      809        4        /*T*                                                         */
      810        5        /*T***********************************************************/
      811        6        FLC$TAPE_OPEN: PROC( ERR ) ALTRET;
      812        7        /*F*  NAME: FLC$TAPE_OPEN
      813        8              PURPOSE: Open next file on tape and allocate enough buffer
      814        9                 space to read its largest record.
      815       10        */
      816       11
      817       12        /***
      818       13         *** INCLUDE
      819       14         ***/
      820       15
      821       16        %INCLUDE CP_6;
      822     5575        %INCLUDE B_ERRORS_C;
      823     6702        %INCLUDE FLI_DATA_R;
      824     8116        %INCLUDE FLS_DATA_R;
      825     9916        %INCLUDE FLE_DATA_R;
      826    15867        %INCLUDE CP_6_SUBS;
      827    16407
      828    16408        /***
      829    16409         *** ENTRY
      830    16410         ***/
      831    16411
      832    16412    1   DCL FLI$ALLOC_BUF ENTRY(2);
      833    16413    1   DCL FLI$RPT_ERR ENTRY(5);
      834    16414
      835    16415        /***
      836    16416         *** SYMREF
      837    16417         ***/
      838    16418
      839    16419    1   DCL BREAK_CONTINUED BIT(1) SYMREF;
      840    16420
      841    16421        /***
      842    16422         *** PARAMETERS
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:207  
      843    16423         ***/
      844    16424
      845    16425    1   DCL 1 ERR ALIGNED,
      846    16426    1         2 FCG BIT(12) UNAL,
      847    16427    1         2 MID BIT(6) UNAL,
      848    16428    1         2 MON BIT(1) UNAL,
      849    16429    1         2 CODE UBIN(14) UNAL,
      850    16430    1         2 SEV UBIN(3) UNAL;
      851    16431
      852    16432        /***
      853    16433         *** STATIC
      854    16434         ***/
      855    16435
      856    16436    1   DCL SIZE UBIN WORD STATIC;
      857    16437    1   DCL DCB# UBIN WORD AUTO;
      858    16438        %VLP_VECTOR( FPTN=INCR_BUF_ );
      859    16453
      860    16454        /***
      861    16455         *** BASED
      862    16456         ***/
      863    16457
      864    16458        %F$DCB( BASED="BASED(M$TAPE00$)" );
      865    16515        %B$TCB( STCLASS="BASED(B$TCB$)" );
      866    16518        %B$ALT;
      867    16526
      868    16527        /****************************************/
      869    16528
      870    16529    1      IF TAPE_OPEN.V.VOL# > 0 AND TAPE_OPEN.V.FSN# = 0
      871    16530    2       THEN DO;
      872    16531    2         TAPE_OPEN.V.OPER.MNTONLY# = %YES#;
      873    16532    2   SMALL_LOOP:
      874    16533    3         DO WHILE ( '1'B );
      875    16534    3   RETRY_OPEN:
      876    16535    3            CALL M$OPEN ( TAPE_OPEN )
      877    16536    4             WHENRETURN DO;
      878    16537        /***
      879    16538         *** If an I/O error and I/O continue spec'd, continue performing mounts
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:208  
      880    16539         *** until a good volume is found.
      881    16540         ***/
      882    16541    4               IF ( F$DCB.TYC.IOERR# AND TAPE_OPEN.V.IOERROK# )
      883    16542    5                THEN DO;
      884    16543    5                  ERR = E_IO_ERR;
      885    16544    5                  DCB# = TAPE_OPEN.V.DCB#;
      886    16545    5                  CALL FLI$RPT_ERR( ERR, DCB# );
      887    16546    5                  IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      888    16547    5                   THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      889    16548    5                  TAPE_REMOVE.V.PSN# = F$DCB.PSN#;
      890    16549    5                  CALL M$REM( TAPE_REMOVE )
      891    16550    6                   WHENALTRETURN DO;
      892    16551    6                     END;
      893    16552    5                  TAPE_OPEN.V.VOL# = TAPE_OPEN.V.VOL# + 1;
      894    16553    5                  GOTO RETRY_OPEN;
      895    16554    5                  END;
      896    16555
      897    16556    4               ERR= '0'B;
      898    16557    4               IF F$DCB.FSECT > 1
      899    16558    4                THEN TAPE_OPEN.V.FSN# = F$DCB.FSN# + 1;
      900    16559    4                ELSE TAPE_OPEN.V.FSN# = F$DCB.FSN#; /* has to be specified       */
      901    16560                                                /* since THISF# will be.              */
      902    16561    4               TAPE_OPEN.V.OPER.MNTONLY# = %NO#;
      903    16562    4               TAPE_OPEN.V.OPER.THISF# = %YES#;
             16562                        /* If not set, will try to open the 1st FSN */
      904    16563    4               EXIT SMALL_LOOP;
      905    16564    4               END;
      906    16565    4             WHENALTRETURN DO;
      907    16566    4               IF NOT ( B$TCB.ALT$->B$ALT.ERR.CODE = %E$VOLERR
      908    16567    4                 AND ERR = E_IO_ERR ) /* Err trying to get nxt vol on I/O cont.? */
      909    16568    5                THEN DO;
      910    16569    5                  ERR = B$TCB.ALT$ -> B$ALT.ERR; /* Nope, report err             */
      911    16570    5                  CALL FLI$RPT_ERR;
      912    16571    5                  END;
      913    16572
      914    16573    4               IF NOT ( ERR.CODE = %E$MNTBRK AND BREAK_CONTINUED )
      915    16574    5                THEN DO;
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:209  
      916    16575    5                  IF ERR.CODE ~= %E$MNTBRK
      917    16576    5                   THEN IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      918    16577    5                      THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      919    16578    5                  TAPE_BAD = '1'B;
      920    16579    5                  ALTRETURN;
      921    16580    5                  END;
      922    16581    4               END;
      923    16582    3            END;
      924    16583    2         END;
      925    16584
      926    16585    2      DO WHILE( '1'B );
      927    16586    2         CALL M$OPEN( TAPE_OPEN )
      928    16587    3          WHENRETURN DO;
      929    16588        /***
      930    16589         *** If an I/O error when I/O continue spec'd, skip out to next EFT_RESTRICT_FILE
      931    16590         *** on input tape after writing error msge. Possibility of running off end of
      932    16591         *** reel if last file on tape and is bad.
      933    16592         ***/
      934    16593    3            IF ( F$DCB.TYC.IOERR# AND TAPE_OPEN.V.IOERROK# )
      935    16594    4             THEN DO;
      936    16595    4               DCB# = TAPE_OPEN.V.DCB#;
      937    16596    4               CALL FLI$RPT_ERR( E_IO_ERR, DCB# );
      938    16597    4               IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      939    16598    4                THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      940    16599    4               TAPE_OPEN.V.OPER.THISF# = %NO#;
      941    16600    4               TAPE_OPEN.V.FINDPOS# = %YES#;
      942    16601    4               CALL M$OPEN( TAPE_OPEN )    /* Open next good tape file           */
      943    16602    5                WHENRETURN DO;
      944    16603    5                  CALL FLI$RPT_ERR( E_FILES_SKIPPED ); /* Output "files skipped" */
      945    16604    5                  TAPE_OPEN.V.FINDPOS# = %NO#;
      946    16605    5                  END;
      947    16606    5                WHENALTRETURN DO;
      948    16607    5                  TAPE_OPEN.V.FINDPOS# = %NO#; /* Can't get past tape error      */
      949    16608    5                  TAPE_OPEN.V.OPER.THISF# = %NO#;
      950    16609    5                  GOTO TAPE_OPEN_ALT;
      951    16610    5                  END;
      952    16611    4               END;
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:210  
      953    16612
      954    16613    3            TAPE_OPEN.V.OPER.THISF# = %NO#;
      955    16614    3            TAPE_OPEN.V.INITZ.SCRUB# = %NO#;
      956    16615    3            TAPE_OPEN.NAME_ = VECTOR(ERASE);
      957    16616    3            TAPE_OPEN.V.FSN# = 0;
      958    16617    3            TAPE_OPEN.V.VOL# = 0;
      959    16618    3            IF F$DCB.ORG# = %RESTRICT#
      960    16619    3              AND F$DCB.NAME#.C = EFT_RESTRICT_FILE.NAME#
      961    16620    4             THEN DO;
      962    16621    5               IF F$DCB.BLKL# > TAPE_BLOCK_SIZE THEN DO;
      963    16622    5                  SIZE = (F$DCB.BLKL# - TAPE_BLOCK_SIZE + 4095) / 4096;
      964    16623    5                  CALL FLI$ALLOC_BUF( INCR_BUF_, SIZE );
      965    16624    5                  TAPE_BLOCK_.W1.VSIZE# = TAPE_BLOCK_.W1.VSIZE# + SIZE * 4096;
      966    16625    5                  TAPE_BLOCK_SIZE = TAPE_BLOCK_SIZE + SIZE*4096;
      967    16626    5                  END;
      968    16627    4               TAPE_READ.BUF_ = TAPE_BLOCK_;
      969    16628    4               ERR = '0'B;
      970    16629    4               BLK_TAG$ = PINCRW( TAPE_BLOCK_.PTR$, -SIZEW(BLK_TAG) );
      971    16630    4               TAPE_SN = F$DCB.PSN#;
      972    16631    4               TAPE_FSN = F$DCB.FSN#;
      973    16632    4               RETURN;
      974    16633    4               END;
      975    16634    4             ELSE DO;                      /* Skip non-packed file               */
      976    16635    4               CALL M$CLOSE( TAPE_CLOSE )
      977    16636    5                WHENRETURN DO;
      978    16637    5                  IF F$DCB.FSN# >= LAST_TAPE_FSN AND LAST_TAPE_FSN ~= 0
      979    16638    6                   THEN DO;                /* Stop now                           */
      980    16639    6                     ERR = '0'B;
             16639                              /* Probably should use a more explicit error message */
      981    16640    6                     ALTRETURN;
      982    16641    6                     END;
      983    16642    5                  TAPE_OPEN.V.RES# = F$DCB.RES#;
      984    16643    5                  END;
      985    16644    5                WHENALTRETURN DO;
      986    16645    5                  CALL FLI$RPT_ERR;
      987    16646    5                  ERR = B$TCB.ALT$->B$ALT.ERR;
      988    16647    5                  TAPE_BAD = '1'B;
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:211  
      989    16648    5                  IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
      990    16649    5                   THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
      991    16650    5                  ALTRETURN;
      992    16651    5                  END;
      993    16652    4               END;
      994    16653    3            END;
      995    16654    3          WHENALTRETURN DO;
      996    16655    3   TAPE_OPEN_ALT: ;
      997    16656    3            ERR = B$TCB.ALT$->B$ALT.ERR;
      998    16657    3            IF ERR.CODE ~= %E$EOSET
      999    16658    3             THEN CALL FLI$RPT_ERR;
     1000    16659    3             ELSE ALTRETURN;
     1001    16660    3            IF NOT( ERR.CODE = %E$MNTBRK AND BREAK_CONTINUED )
     1002    16661    4             THEN DO;
     1003    16662    4               IF ERR.CODE ~= %E$MNTBRK
     1004    16663    4                THEN IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
     1005    16664    4                   THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
     1006    16665    4               TAPE_BAD = '1'B;
     1007    16666    4               ALTRETURN;
     1008    16667    4               END;
     1009    16668    3            END;
     1010    16669    2         END;
     1011    16670    1   END FLC$TAPE_OPEN;
     1012    16671        %EOD;

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:212  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$TAPE_OPEN.

   Procedure FLC$TAPE_OPEN requires 282 words for executable code.
   Procedure FLC$TAPE_OPEN requires 8 words of local(AUTO) storage.

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:213  

 Object Unit name= FLC$TAPE_OPEN                              File name= FLC$ROUTINES.:E05TOU
 UTS= JUL 29 '97 15:43:24.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    24     30  FLC$TAPE_OPEN
    3   DCB   even  none     0      0  M$TSN_USED
    4   DCB   even  none     0      0  M$STATUS
    5   DCB   even  none     0      0  M$REBUILD
    6   DCB   even  none     0      0  M$ARCHIVE
    7   DCB   even  none     0      0  M$NODATA_LIST
    8   Proc  even  none   282    432  FLC$TAPE_OPEN
    9  RoData even  none    10     12  FLC$TAPE_OPEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes    yes     yes      Std        1  FLC$TAPE_OPEN

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
         yes           Std       2 FLI$ALLOC_BUF
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:214  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         FPT_EXIT
     TAPE_OPEN                             TAPE_READ                             TAPE_CLOSE
     TAPE_REMOVE                           SNVECLIST$                            B$TCB$
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             LAST_TAPE_FSN                         EFTWORD
     M$PRE_RET                             RET_CMDS_NAME                         M$TSN_USED
     M$STATUS                              M$REBUILD                             M$ARCHIVE
     M$NODATA_LIST                         M$TAPE00$                             BLK_TAG$
     BLK_TAG0$                             NBR_BYTES_TO_MOVE                     DISK_GRAN$
     BLOCK_GRAN$                           TAPE_BLOCK_                           TAPE_BLOCK_SIZE
r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE                     TAPE_SN
     TAPE_FSN                              TAPE_BAD                              TSN_USED_NAME
     BACKUP_NAME                      r    ARCHIVE_NAME                     r    PRIME_FILE
r    DUAL_FILE                             REBUILD_NAME                          REBUILD_DIR_KEY
     REBUILD_KEY                           NODATA_FILE_NAME                      NODATA_KEY
r    E_IO_ERR                         r    E_FILES_SKIPPED                       BREAK_CONTINUED
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:215  


      806        1        /*T***********************************************************/
      807        2        /*T*                                                         */
      808        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      809        4        /*T*                                                         */
      810        5        /*T***********************************************************/
      811        6        FLC$TAPE_OPEN: PROC( ERR ) ALTRET;

      6  8 000000   000000 700200 xent  FLC$TAPE_OP* TSX0  ! X66_AUTO_1
         8 000001   000010 000001                    ZERO    8,1

      812        7        /*F*  NAME: FLC$TAPE_OPEN
      813        8              PURPOSE: Open next file on tape and allocate enough buffer
      814        9                 space to read its largest record.
      815       10        */
      816       11
      817       12        /***
      818       13         *** INCLUDE
      819       14         ***/
      820       15
      821       16        %INCLUDE CP_6;
      822     5575        %INCLUDE B_ERRORS_C;
      823     6702        %INCLUDE FLI_DATA_R;
      824     8116        %INCLUDE FLS_DATA_R;
      825     9916        %INCLUDE FLE_DATA_R;
      826    15867        %INCLUDE CP_6_SUBS;
      827    16407
      828    16408        /***
      829    16409         *** ENTRY
      830    16410         ***/
      831    16411
      832    16412    1   DCL FLI$ALLOC_BUF ENTRY(2);
      833    16413    1   DCL FLI$RPT_ERR ENTRY(5);
      834    16414
      835    16415        /***
      836    16416         *** SYMREF
      837    16417         ***/
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:216  
      838    16418
      839    16419    1   DCL BREAK_CONTINUED BIT(1) SYMREF;
      840    16420
      841    16421        /***
      842    16422         *** PARAMETERS
      843    16423         ***/
      844    16424
      845    16425    1   DCL 1 ERR ALIGNED,
      846    16426    1         2 FCG BIT(12) UNAL,
      847    16427    1         2 MID BIT(6) UNAL,
      848    16428    1         2 MON BIT(1) UNAL,
      849    16429    1         2 CODE UBIN(14) UNAL,
      850    16430    1         2 SEV UBIN(3) UNAL;
      851    16431
      852    16432        /***
      853    16433         *** STATIC
      854    16434         ***/
      855    16435
      856    16436    1   DCL SIZE UBIN WORD STATIC;
      857    16437    1   DCL DCB# UBIN WORD AUTO;
      858    16438        %VLP_VECTOR( FPTN=INCR_BUF_ );
      859    16453
      860    16454        /***
      861    16455         *** BASED
      862    16456         ***/
      863    16457
      864    16458        %F$DCB( BASED="BASED(M$TAPE00$)" );
      865    16515        %B$TCB( STCLASS="BASED(B$TCB$)" );
      866    16518        %B$ALT;
      867    16526
      868    16527        /****************************************/
      869    16528
      870    16529    1      IF TAPE_OPEN.V.VOL# > 0 AND TAPE_OPEN.V.FSN# = 0

  16529  8 000002   000061 236000 xsym               LDQ     TAPE_OPEN+49
         8 000003   777000 316003                    CANQ    -512,DU
         8 000004   000150 600000 8                  TZE     s:16586
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:217  
         8 000005   000066 220000 xsym               LDX0    TAPE_OPEN+54
         8 000006   000150 601000 8                  TNZ     s:16586

      871    16530    2       THEN DO;

      872    16531    2         TAPE_OPEN.V.OPER.MNTONLY# = %YES#;

  16531  8 000007   001000 236007                    LDQ     512,DL
         8 000010   000044 256000 xsym               ORSQ    TAPE_OPEN+36

      873    16532    2   SMALL_LOOP:
      874    16533    3         DO WHILE ( '1'B );

  16533  8 000011                       SMALL_LOOP   null
      875    16534    3   RETRY_OPEN:
      876    16535    3            CALL M$OPEN ( TAPE_OPEN )

  16535  8 000011   000000 630400 xsym  RETRY_OPEN   EPPR0   TAPE_OPEN
         8 000012   450000 713400                    CLIMB   alt,open
         8 000013   410400 401760                    pmme    nvectors=18
         8 000014   000105 702000 8                  TSX2    s:16566

      877    16536    4             WHENRETURN DO;

      878    16537        /***
      879    16538         *** If an I/O error and I/O continue spec'd, continue performing mounts
      880    16539         *** until a good volume is found.
      881    16540         ***/
      882    16541    4               IF ( F$DCB.TYC.IOERR# AND TAPE_OPEN.V.IOERROK# )

  16541  8 000015   000000 470400 xsym               LDP0    M$TAPE00$
         8 000016   000002 430100                    FSZN    2,,PR0
         8 000017   000064 605000 8                  TPL     s:16556
         8 000020   000060 236000 xsym               LDQ     TAPE_OPEN+48
         8 000021   003000 316003                    CANQ    1536,DU
         8 000022   000064 600000 8                  TZE     s:16556

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:218  
      883    16542    5                THEN DO;

      884    16543    5                  ERR = E_IO_ERR;

  16543  8 000023   000000 236000 xsym               LDQ     E_IO_ERR
         8 000024   200003 471500                    LDP1    @ERR,,AUTO
         8 000025   100000 756100                    STQ     0,,PR1

      885    16544    5                  DCB# = TAPE_OPEN.V.DCB#;

  16544  8 000026   000044 235000 xsym               LDA     TAPE_OPEN+36
         8 000027   000022 771000                    ARL     18
         8 000030   200004 755100                    STA     DCB#,,AUTO

      886    16545    5                  CALL FLI$RPT_ERR( ERR, DCB# );

  16545  8 000031   200004 630500                    EPPR0   DCB#,,AUTO
         8 000032   200007 450500                    STP0    DCB#+3,,AUTO
         8 000033   200003 236100                    LDQ     @ERR,,AUTO
         8 000034   200006 756100                    STQ     DCB#+2,,AUTO
         8 000035   200006 630500                    EPPR0   DCB#+2,,AUTO
         8 000036   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000037   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000040   000000 011000                    NOP     0

      887    16546    5                  IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16546  8 000041   000004 236000 xsym               LDQ     FPT_EXIT+4
         8 000042   777000 376003                    ANQ     -512,DU
         8 000043   004000 116003                    CMPQ    2048,DU
         8 000044   000047 603000 8                  TRC     s:16548

      888    16547    5                   THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16547  8 000045   004000 236003                    LDQ     2048,DU
         8 000046   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:219  
      889    16548    5                  TAPE_REMOVE.V.PSN# = F$DCB.PSN#;

  16548  8 000047   000000 470400 xsym               LDP0    M$TAPE00$
         8 000050   040000 100500                    MLR     fill='040'O
         8 000051   000024 000006                    ADSC9   20,,PR0                  cn=0,n=6
         8 000052   000002 400006 xsym               ADSC9   TAPE_REMOVE+2            cn=2,n=6

      890    16549    5                  CALL M$REM( TAPE_REMOVE )

  16549  8 000053   000000 630400 xsym               EPPR0   TAPE_REMOVE
         8 000054   460006 713400                    CLIMB   alt,+24582
         8 000055   400000 401760                    pmme    nvectors=1
         8 000056   000060 702000 8                  TSX2    s:16552
         8 000057   000060 710000 8                  TRA     s:16552

      891    16550    6                   WHENALTRETURN DO;

      892    16551    6                     END;

      893    16552    5                  TAPE_OPEN.V.VOL# = TAPE_OPEN.V.VOL# + 1;

  16552  8 000060   000061 236000 xsym               LDQ     TAPE_OPEN+49
         8 000061   001000 036003                    ADLQ    512,DU
         8 000062   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O

      894    16553    5                  GOTO RETRY_OPEN;

  16553  8 000063   000011 710000 8                  TRA     SMALL_LOOP

      895    16554    5                  END;
      896    16555
      897    16556    4               ERR= '0'B;

  16556  8 000064   200003 471500                    LDP1    @ERR,,AUTO
         8 000065   100000 450100                    STZ     0,,PR1

      898    16557    4               IF F$DCB.FSECT > 1
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:220  

  16557  8 000066   000000 470400 xsym               LDP0    M$TAPE00$
         8 000067   000077 220100                    LDX0    63,,PR0
         8 000070   000002 100003                    CMPX0   2,DU
         8 000071   000076 602000 8                  TNC     s:16559

      899    16558    4                THEN TAPE_OPEN.V.FSN# = F$DCB.FSN# + 1;

  16558  8 000072   000034 221100                    LDX1    28,,PR0
         8 000073   000001 622011                    EAX2    1,X1
         8 000074   000066 742000 xsym               STX2    TAPE_OPEN+54
         8 000075   000100 710000 8                  TRA     s:16561

      900    16559    4                ELSE TAPE_OPEN.V.FSN# = F$DCB.FSN#; /* has to be specified       */

  16559  8 000076   000034 221100                    LDX1    28,,PR0
         8 000077   000066 741000 xsym               STX1    TAPE_OPEN+54

      901    16560                                                /* since THISF# will be.              */
      902    16561    4               TAPE_OPEN.V.OPER.MNTONLY# = %NO#;

  16561  8 000100   000000 236000 9                  LDQ     0
         8 000101   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      903    16562    4               TAPE_OPEN.V.OPER.THISF# = %YES#;
             16562                        /* If not set, will try to open the 1st FSN */

  16562  8 000102   002000 236007                    LDQ     1024,DL
         8 000103   000044 256000 xsym               ORSQ    TAPE_OPEN+36

      904    16563    4               EXIT SMALL_LOOP;

  16563  8 000104   000150 710000 8                  TRA     s:16586

      905    16564    4               END;
      906    16565    4             WHENALTRETURN DO;

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:221  
      907    16566    4               IF NOT ( B$TCB.ALT$->B$ALT.ERR.CODE = %E$VOLERR

  16566  8 000105   000000 470400 xsym               LDP0    B$TCB$
         8 000106   000000 471500                    LDP1    0,,PR0
         8 000107   100102 236100                    LDQ     66,,PR1
         8 000110   377770 376007                    ANQ     131064,DL
         8 000111   013260 116007                    CMPQ    5808,DL
         8 000112   000117 601000 8                  TNZ     s:16569
         8 000113   200003 473500                    LDP3    @ERR,,AUTO
         8 000114   300000 236100                    LDQ     0,,PR3
         8 000115   000000 116000 xsym               CMPQ    E_IO_ERR
         8 000116   000125 600000 8                  TZE     s:16573

      908    16567    4                 AND ERR = E_IO_ERR ) /* Err trying to get nxt vol on I/O cont.? */
      909    16568    5                THEN DO;

      910    16569    5                  ERR = B$TCB.ALT$ -> B$ALT.ERR; /* Nope, report err             */

  16569  8 000117   100102 236100                    LDQ     66,,PR1
         8 000120   200003 473500                    LDP3    @ERR,,AUTO
         8 000121   300000 756100                    STQ     0,,PR3

      911    16570    5                  CALL FLI$RPT_ERR;

  16570  8 000122   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000123   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000124   000000 011000                    NOP     0

      912    16571    5                  END;

      913    16572
      914    16573    4               IF NOT ( ERR.CODE = %E$MNTBRK AND BREAK_CONTINUED )

  16573  8 000125   200003 470500                    LDP0    @ERR,,AUTO
         8 000126   000000 236100                    LDQ     0,,PR0
         8 000127   377770 376007                    ANQ     131064,DL
         8 000130   012200 116007                    CMPQ    5248,DL
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:222  
         8 000131   000134 601000 8                  TNZ     s:16575
         8 000132   000000 234000 xsym               SZN     BREAK_CONTINUED
         8 000133   000147 604000 8                  TMI     s:16582

      915    16574    5                THEN DO;

      916    16575    5                  IF ERR.CODE ~= %E$MNTBRK

  16575  8 000134   012200 116007                    CMPQ    5248,DL
         8 000135   000144 600000 8                  TZE     s:16578

      917    16576    5                   THEN IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16576  8 000136   000004 236000 xsym               LDQ     FPT_EXIT+4
         8 000137   777000 376003                    ANQ     -512,DU
         8 000140   004000 116003                    CMPQ    2048,DU
         8 000141   000144 603000 8                  TRC     s:16578

      918    16577    5                      THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16577  8 000142   004000 236003                    LDQ     2048,DU
         8 000143   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      919    16578    5                  TAPE_BAD = '1'B;

  16578  8 000144   400000 236003                    LDQ     -131072,DU
         8 000145   000000 756000 xsym               STQ     TAPE_BAD

      920    16579    5                  ALTRETURN;

  16579  8 000146   000000 702200 xent               TSX2  ! X66_AALT

      921    16580    5                  END;
      922    16581    4               END;
      923    16582    3            END;

  16582  8 000147   000011 710000 8                  TRA     SMALL_LOOP
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:223  

      924    16583    2         END;

      925    16584
      926    16585    2      DO WHILE( '1'B );

      927    16586    2         CALL M$OPEN( TAPE_OPEN )

  16586  8 000150   000000 630400 xsym               EPPR0   TAPE_OPEN
         8 000151   450000 713400                    CLIMB   alt,open
         8 000152   410400 401760                    pmme    nvectors=18
         8 000153   000371 702000 8                  TSX2    TAPE_OPEN_ALT

      928    16587    3          WHENRETURN DO;

      929    16588        /***
      930    16589         *** If an I/O error when I/O continue spec'd, skip out to next EFT_RESTRICT_FILE
      931    16590         *** on input tape after writing error msge. Possibility of running off end of
      932    16591         *** reel if last file on tape and is bad.
      933    16592         ***/
      934    16593    3            IF ( F$DCB.TYC.IOERR# AND TAPE_OPEN.V.IOERROK# )

  16593  8 000154   000000 470400 xsym               LDP0    M$TAPE00$
         8 000155   000002 430100                    FSZN    2,,PR0
         8 000156   000227 605000 8                  TPL     s:16613
         8 000157   000060 236000 xsym               LDQ     TAPE_OPEN+48
         8 000160   003000 316003                    CANQ    1536,DU
         8 000161   000227 600000 8                  TZE     s:16613

      935    16594    4             THEN DO;

      936    16595    4               DCB# = TAPE_OPEN.V.DCB#;

  16595  8 000162   000044 235000 xsym               LDA     TAPE_OPEN+36
         8 000163   000022 771000                    ARL     18
         8 000164   200004 755100                    STA     DCB#,,AUTO

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:224  
      937    16596    4               CALL FLI$RPT_ERR( E_IO_ERR, DCB# );

  16596  8 000165   200004 631500                    EPPR1   DCB#,,AUTO
         8 000166   200007 451500                    STP1    DCB#+3,,AUTO
         8 000167   000001 236000 9                  LDQ     1
         8 000170   200006 756100                    STQ     DCB#+2,,AUTO
         8 000171   200006 630500                    EPPR0   DCB#+2,,AUTO
         8 000172   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000173   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000174   000000 011000                    NOP     0

      938    16597    4               IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16597  8 000175   000004 236000 xsym               LDQ     FPT_EXIT+4
         8 000176   777000 376003                    ANQ     -512,DU
         8 000177   004000 116003                    CMPQ    2048,DU
         8 000200   000203 603000 8                  TRC     s:16599

      939    16598    4                THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16598  8 000201   004000 236003                    LDQ     2048,DU
         8 000202   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      940    16599    4               TAPE_OPEN.V.OPER.THISF# = %NO#;

  16599  8 000203   000002 236000 9                  LDQ     2
         8 000204   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      941    16600    4               TAPE_OPEN.V.FINDPOS# = %YES#;

  16600  8 000205   000001 236007                    LDQ     1,DL
         8 000206   000044 256000 xsym               ORSQ    TAPE_OPEN+36

      942    16601    4               CALL M$OPEN( TAPE_OPEN )    /* Open next good tape file           */

  16601  8 000207   000000 630400 xsym               EPPR0   TAPE_OPEN
         8 000210   450000 713400                    CLIMB   alt,open
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:225  
         8 000211   410400 401760                    pmme    nvectors=18
         8 000212   000222 702000 8                  TSX2    s:16607

      943    16602    5                WHENRETURN DO;

      944    16603    5                  CALL FLI$RPT_ERR( E_FILES_SKIPPED ); /* Output "files skipped" */

  16603  8 000213   000003 630400 9                  EPPR0   3
         8 000214   000017 631400 xsym               EPPR1   B_VECTNIL+15
         8 000215   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000216   000000 011000                    NOP     0

      945    16604    5                  TAPE_OPEN.V.FINDPOS# = %NO#;

  16604  8 000217   000004 236000 9                  LDQ     4
         8 000220   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      946    16605    5                  END;

  16605  8 000221   000227 710000 8                  TRA     s:16613

      947    16606    5                WHENALTRETURN DO;

      948    16607    5                  TAPE_OPEN.V.FINDPOS# = %NO#; /* Can't get past tape error      */

  16607  8 000222   000004 236000 9                  LDQ     4
         8 000223   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      949    16608    5                  TAPE_OPEN.V.OPER.THISF# = %NO#;

  16608  8 000224   000002 236000 9                  LDQ     2
         8 000225   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      950    16609    5                  GOTO TAPE_OPEN_ALT;

  16609  8 000226   000371 710000 8                  TRA     TAPE_OPEN_ALT

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:226  
      951    16610    5                  END;
      952    16611    4               END;

      953    16612
      954    16613    3            TAPE_OPEN.V.OPER.THISF# = %NO#;

  16613  8 000227   000002 236000 9                  LDQ     2
         8 000230   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      955    16614    3            TAPE_OPEN.V.INITZ.SCRUB# = %NO#;

  16614  8 000231   000005 236000 9                  LDQ     5
         8 000232   000044 356000 xsym               ANSQ    TAPE_OPEN+36

      956    16615    3            TAPE_OPEN.NAME_ = VECTOR(ERASE);

  16615  8 000233   000006 237000 9                  LDAQ    6
         8 000234   000006 757000 xsym               STAQ    TAPE_OPEN+6

      957    16616    3            TAPE_OPEN.V.FSN# = 0;

  16616  8 000235   000000 220003                    LDX0    0,DU
         8 000236   000066 740000 xsym               STX0    TAPE_OPEN+54

      958    16617    3            TAPE_OPEN.V.VOL# = 0;

  16617  8 000237   000000 236003                    LDQ     0,DU
         8 000240   000061 552040 xsym               STBQ    TAPE_OPEN+49,'40'O

      959    16618    3            IF F$DCB.ORG# = %RESTRICT#

  16618  8 000241   000000 470400 xsym               LDP0    M$TAPE00$
         8 000242   000032 236100                    LDQ     26,,PR0
         8 000243   777000 376003                    ANQ     -512,DU
         8 000244   022000 116003                    CMPQ    9216,DU
         8 000245   000326 601000 8                  TNZ     s:16635
         8 000246   000000 236000 xsym               LDQ     EFT_RESTRICT_FILE
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:227  
         8 000247   000033 772000                    QRL     27
         8 000250   000000 621006                    EAX1    0,QL
         8 000251   040040 106500                    CMPC    fill='040'O
         8 000252   000010 200037                    ADSC9   8,,PR0                   cn=1,n=31
         8 000253   000000 200011 xsym               ADSC9   EFT_RESTRICT_FILE        cn=1,n=*X1
         8 000254   000326 601000 8                  TNZ     s:16635

      960    16619    3              AND F$DCB.NAME#.C = EFT_RESTRICT_FILE.NAME#
      961    16620    4             THEN DO;

      962    16621    5               IF F$DCB.BLKL# > TAPE_BLOCK_SIZE THEN DO;

  16621  8 000255   000033 236100                    LDQ     27,,PR0
         8 000256   000022 772000                    QRL     18
         8 000257   000000 116000 xsym               CMPQ    TAPE_BLOCK_SIZE
         8 000260   000307 604400 8                  TMOZ    s:16627

      963    16622    5                  SIZE = (F$DCB.BLKL# - TAPE_BLOCK_SIZE + 4095) / 4096;

  16622  8 000261   000000 136000 xsym               SBLQ    TAPE_BLOCK_SIZE
         8 000262   007777 036007                    ADLQ    4095,DL
         8 000263   010000 506007                    DIV     4096,DL
         8 000264   000024 756000 2                  STQ     SIZE

      964    16623    5                  CALL FLI$ALLOC_BUF( INCR_BUF_, SIZE );

  16623  8 000265   000010 630400 9                  EPPR0   8
         8 000266   000020 631400 xsym               EPPR1   B_VECTNIL+16
         8 000267   000000 701000 xent               TSX1    FLI$ALLOC_BUF
         8 000270   000000 011000                    NOP     0

      965    16624    5                  TAPE_BLOCK_.W1.VSIZE# = TAPE_BLOCK_.W1.VSIZE# + SIZE * 4096;

  16624  8 000271   000000 236000 xsym               LDQ     TAPE_BLOCK_
         8 000272   000020 772000                    QRL     16
         8 000273   200006 756100                    STQ     DCB#+2,,AUTO
         8 000274   000024 236000 2                  LDQ     SIZE
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:228  
         8 000275   000014 736000                    QLS     12
         8 000276   200006 036100                    ADLQ    DCB#+2,,AUTO
         8 000277   000020 736000                    QLS     16
         8 000300   000000 676000 xsym               ERQ     TAPE_BLOCK_
         8 000301   000034 376000 xsym               ANQ     B_VECTNIL+28
         8 000302   000000 656000 xsym               ERSQ    TAPE_BLOCK_

      966    16625    5                  TAPE_BLOCK_SIZE = TAPE_BLOCK_SIZE + SIZE*4096;

  16625  8 000303   000024 236000 2                  LDQ     SIZE
         8 000304   000014 736000                    QLS     12
         8 000305   000000 036000 xsym               ADLQ    TAPE_BLOCK_SIZE
         8 000306   000000 756000 xsym               STQ     TAPE_BLOCK_SIZE

      967    16626    5                  END;

      968    16627    4               TAPE_READ.BUF_ = TAPE_BLOCK_;

  16627  8 000307   000000 237000 xsym               LDAQ    TAPE_BLOCK_
         8 000310   000004 757000 xsym               STAQ    TAPE_READ+4

      969    16628    4               ERR = '0'B;

  16628  8 000311   200003 470500                    LDP0    @ERR,,AUTO
         8 000312   000000 450100                    STZ     0,,PR0

      970    16629    4               BLK_TAG$ = PINCRW( TAPE_BLOCK_.PTR$, -SIZEW(BLK_TAG) );

  16629  8 000313   000001 236000 xsym               LDQ     TAPE_BLOCK_+1
         8 000314   777765 036003                    ADLQ    -11,DU
         8 000315   000000 756000 xsym               STQ     BLK_TAG$

      971    16630    4               TAPE_SN = F$DCB.PSN#;

  16630  8 000316   000000 471400 xsym               LDP1    M$TAPE00$
         8 000317   040000 100500                    MLR     fill='040'O
         8 000320   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:229  
         8 000321   000000 000006 xsym               ADSC9   TAPE_SN                  cn=0,n=6

      972    16631    4               TAPE_FSN = F$DCB.FSN#;

  16631  8 000322   100034 236100                    LDQ     28,,PR1
         8 000323   000022 772000                    QRL     18
         8 000324   000000 756000 xsym               STQ     TAPE_FSN

      973    16632    4               RETURN;

  16632  8 000325   000000 702200 xent               TSX2  ! X66_ARET

      974    16633    4               END;
      975    16634    4             ELSE DO;                      /* Skip non-packed file               */

      976    16635    4               CALL M$CLOSE( TAPE_CLOSE )

  16635  8 000326   000000 630400 xsym               EPPR0   TAPE_CLOSE
         8 000327   450001 713400                    CLIMB   alt,close
         8 000330   406000 401760                    pmme    nvectors=13
         8 000331   000347 702000 8                  TSX2    s:16645

      977    16636    5                WHENRETURN DO;

      978    16637    5                  IF F$DCB.FSN# >= LAST_TAPE_FSN AND LAST_TAPE_FSN ~= 0

  16637  8 000332   000000 470400 xsym               LDP0    M$TAPE00$
         8 000333   000034 236100                    LDQ     28,,PR0
         8 000334   000022 772000                    QRL     18
         8 000335   000000 116000 xsym               CMPQ    LAST_TAPE_FSN
         8 000336   000344 604000 8                  TMI     s:16642
         8 000337   000000 235000 xsym               LDA     LAST_TAPE_FSN
         8 000340   000344 600000 8                  TZE     s:16642

      979    16638    6                   THEN DO;                /* Stop now                           */

      980    16639    6                     ERR = '0'B;
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:230  
             16639                              /* Probably should use a more explicit error message */

  16639  8 000341   200003 471500                    LDP1    @ERR,,AUTO
         8 000342   100000 450100                    STZ     0,,PR1

      981    16640    6                     ALTRETURN;

  16640  8 000343   000000 702200 xent               TSX2  ! X66_AALT

      982    16641    6                     END;
      983    16642    5                  TAPE_OPEN.V.RES# = F$DCB.RES#;

  16642  8 000344   000026 236100                    LDQ     22,,PR0
         8 000345   000050 756000 xsym               STQ     TAPE_OPEN+40

      984    16643    5                  END;

  16643  8 000346   000370 710000 8                  TRA     s:16653

      985    16644    5                WHENALTRETURN DO;

      986    16645    5                  CALL FLI$RPT_ERR;

  16645  8 000347   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000350   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000351   000000 011000                    NOP     0

      987    16646    5                  ERR = B$TCB.ALT$->B$ALT.ERR;

  16646  8 000352   000000 470400 xsym               LDP0    B$TCB$
         8 000353   000000 471500                    LDP1    0,,PR0
         8 000354   100102 236100                    LDQ     66,,PR1
         8 000355   200003 473500                    LDP3    @ERR,,AUTO
         8 000356   300000 756100                    STQ     0,,PR3

      988    16647    5                  TAPE_BAD = '1'B;

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:231  
  16647  8 000357   400000 236003                    LDQ     -131072,DU
         8 000360   000000 756000 xsym               STQ     TAPE_BAD

      989    16648    5                  IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

  16648  8 000361   000004 236000 xsym               LDQ     FPT_EXIT+4
         8 000362   777000 376003                    ANQ     -512,DU
         8 000363   004000 116003                    CMPQ    2048,DU
         8 000364   000367 603000 8                  TRC     s:16650

      990    16649    5                   THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16649  8 000365   004000 236003                    LDQ     2048,DU
         8 000366   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

      991    16650    5                  ALTRETURN;

  16650  8 000367   000000 702200 xent               TSX2  ! X66_AALT

      992    16651    5                  END;
      993    16652    4               END;

      994    16653    3            END;

  16653  8 000370   000431 710000 8                  TRA     s:16669

      995    16654    3          WHENALTRETURN DO;

  16653  8 000371                       TAPE_OPEN_A* null
      996    16655    3   TAPE_OPEN_ALT: ;
      997    16656    3            ERR = B$TCB.ALT$->B$ALT.ERR;

  16656  8 000371   000000 470400 xsym               LDP0    B$TCB$
         8 000372   000000 471500                    LDP1    0,,PR0
         8 000373   100102 236100                    LDQ     66,,PR1
         8 000374   200003 473500                    LDP3    @ERR,,AUTO
         8 000375   300000 756100                    STQ     0,,PR3
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:232  

      998    16657    3            IF ERR.CODE ~= %E$EOSET

  16657  8 000376   300000 236100                    LDQ     0,,PR3
         8 000377   377770 376007                    ANQ     131064,DL
         8 000400   013140 116007                    CMPQ    5728,DL
         8 000401   000406 600000 8                  TZE     s:16659

      999    16658    3             THEN CALL FLI$RPT_ERR;

  16658  8 000402   000002 631400 xsym               EPPR1   B_VECTNIL+2
         8 000403   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000404   000000 011000                    NOP     0
         8 000405   000407 710000 8                  TRA     s:16660

     1000    16659    3             ELSE ALTRETURN;

  16659  8 000406   000000 702200 xent               TSX2  ! X66_AALT

     1001    16660    3            IF NOT( ERR.CODE = %E$MNTBRK AND BREAK_CONTINUED )

  16660  8 000407   200003 470500                    LDP0    @ERR,,AUTO
         8 000410   000000 236100                    LDQ     0,,PR0
         8 000411   377770 376007                    ANQ     131064,DL
         8 000412   012200 116007                    CMPQ    5248,DL
         8 000413   000416 601000 8                  TNZ     s:16662
         8 000414   000000 234000 xsym               SZN     BREAK_CONTINUED
         8 000415   000431 604000 8                  TMI     s:16669

     1002    16661    4             THEN DO;

     1003    16662    4               IF ERR.CODE ~= %E$MNTBRK

  16662  8 000416   012200 116007                    CMPQ    5248,DL
         8 000417   000426 600000 8                  TZE     s:16665

     1004    16663    4                THEN IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:233  

  16663  8 000420   000004 236000 xsym               LDQ     FPT_EXIT+4
         8 000421   777000 376003                    ANQ     -512,DU
         8 000422   004000 116003                    CMPQ    2048,DU
         8 000423   000426 603000 8                  TRC     s:16665

     1005    16664    4                   THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

  16664  8 000424   004000 236003                    LDQ     2048,DU
         8 000425   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1006    16665    4               TAPE_BAD = '1'B;

  16665  8 000426   400000 236003                    LDQ     -131072,DU
         8 000427   000000 756000 xsym               STQ     TAPE_BAD

     1007    16666    4               ALTRETURN;

  16666  8 000430   000000 702200 xent               TSX2  ! X66_AALT

     1008    16667    4               END;
     1009    16668    3            END;
     1010    16669    2         END;

  16669  8 000431   000150 710000 8                  TRA     s:16586
     1011    16670    1   END FLC$TAPE_OPEN;
     1012    16671        %EOD;

PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:234  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   FL_PERR_C.:E05TOU  is referenced.
   FLE_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$TAPE_OPEN.
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:235  

 **** Variables and constants ****

  ****  Section 002  Data  FLC$TAPE_OPEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/d STRC(360)   r     1 DEL_NODATA_REC            26-0-0/d STRC(72)    r     1 INCR_BUF_
    24-0-0/w UBIN        r     1 SIZE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ERR                       4-0-0/w UBIN        r     1 DCB#
    *0-0-0/w STRC        r     1 ERR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 BACKUP_NAME                0-0-0/w PTR         r     1 BLK_TAG$
     0-0-0/w PTR         r     1 BLK_TAG0$                  0-0-0/w PTR         r     1 BLOCK_GRAN$
     0-0-0/b BIT         r     1 BREAK_CONTINUED            0-0-0/w PTR         r     1 DISK_FILE_SPEC$
     0-0-0/w PTR         r     1 DISK_GRAN$                 0-0-0/w PTR         r     1 DPLIST$
     0-0-0/w PTR         r     1 DPRESLIST$                 0-0-0/c ASTR(9)     r     1 DUAL_FILE
     0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE              0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE
     0-0-0/w STRC        r     1 E_FILES_SKIPPED            0-0-0/w STRC        r     1 E_IO_ERR
     0-0-0/d STRC(216)   r     1 FPT_EXIT                   0-0-0/w SBIN        r     1 LAST_TAPE_FSN
     0-0-0/w PTR         r     1 M$TAPE00$                  0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE
     0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME           0-0-0/c STRC(369)   r     1 NODATA_KEY
     0-0-0/c ASTR(9)     r     1 PRIME_FILE                 0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_KEY                0-0-0/c ASTR(9)     r     1 REBUILD_NAME
     0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME              0-0-0/w PTR         r     1 SNVECLIST$
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:236  
     0-0-0/b BIT         r     1 TAPE_BAD                   0-0-0/d STRC(72)    r     1 TAPE_BLOCK_
     0-0-0/w SBIN        r     1 TAPE_BLOCK_SIZE            0-0-0/d STRC(1080)  r     1 TAPE_CLOSE
     0-0-0/w PTR         r     1 TAPE_DCBLIST$              0-0-0/w SBIN        r     1 TAPE_FSN
     0-0-0/d STRC(2088)  r     1 TAPE_OPEN                  0-0-0/d STRC(504)   r     1 TAPE_READ
     0-0-0/d STRC(144)   r     1 TAPE_REMOVE                0-0-0/c CHAR(6)     r     1 TAPE_SN
     0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/w STRC(396)   r     1 BLK_TAG                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$NODATA_LIST


   Procedure FLC$TAPE_OPEN requires 282 words for executable code.
   Procedure FLC$TAPE_OPEN requires 8 words of local(AUTO) storage.
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:237  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:238  
          MINI XREF LISTING

ARCHIVE_NAME.L#
      9008**DCL      9008--IMP-SIZ
B$ALT.CODE
     16520**DCL     16520--REDEF   16521--REDEF   16521--REDEF
B$ALT.ERR
     16521**DCL     16569>>ASSIGN  16646>>ASSIGN  16656>>ASSIGN
B$ALT.ERR.CODE
     16522**DCL     16566>>IF
B$ALT.ERR.ERR#
     16522**DCL     16522--REDEF
B$ALT.EVID
     16521**DCL     16521--REDEF   16521--REDEF
B$TCB.ALT$
     16516**DCL     16566>>IF      16569>>ASSIGN  16646>>ASSIGN  16656>>ASSIGN
B$TCB$
      7633**DCL     16516--IMP-PTR 16566>>IF      16569>>ASSIGN  16646>>ASSIGN  16656>>ASSIGN
BACKUP_NAME.L#
      8652**DCL      8652--IMP-SIZ
BLK_TAG
      8141**DCL     16629--ASSIGN
BLK_TAG.NAME
      8144**DCL      8144--REDEF
BLK_TAG$
      8141**DCL      8141--IMP-PTR 16629<<ASSIGN
BLK_TAG0.NAME
      8150**DCL      8150--REDEF
BLK_TAG0$
      8147**DCL      8147--IMP-PTR
BLOCK_GRAN$
      8154**DCL      8155--IMP-PTR
BREAK_CONTINUED
     16419**DCL     16573>>IF      16660>>IF
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:239  
CLOSE_NODATA_LIST.SN_
      9806**DCL      9806--REDEF
CLOSE_NODATA_LIST.UTL_
      9807**DCL      9807--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
      9821**DCL      9821--REDEF
CLOSE_NODATA_LIST.V.TYPE#
      9819**DCL      9819--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
      9816**DCL      9816--REDEF    9818--REDEF
CLOSE_PRIME_DUAL.SN_
      9283**DCL      9283--REDEF
CLOSE_PRIME_DUAL.UTL_
      9284**DCL      9284--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
      9298**DCL      9298--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
      9296**DCL      9296--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
      9293**DCL      9293--REDEF    9295--REDEF
CLOSE_REBUILD.SN_
      9558**DCL      9558--REDEF
CLOSE_REBUILD.UTL_
      9559**DCL      9559--REDEF
CLOSE_REBUILD.V.EXPIRE#
      9573**DCL      9573--REDEF
CLOSE_REBUILD.V.TYPE#
      9571**DCL      9571--REDEF
CLOSE_REBUILD.V.XTNSIZE#
      9568**DCL      9568--REDEF    9570--REDEF
CLOSE_STATUS.SN_
      8773**DCL      8773--REDEF
CLOSE_STATUS.UTL_
      8774**DCL      8774--REDEF
CLOSE_STATUS.V.EXPIRE#
      8788**DCL      8788--REDEF
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:240  
CLOSE_STATUS.V.TYPE#
      8786**DCL      8786--REDEF
CLOSE_STATUS.V.XTNSIZE#
      8783**DCL      8783--REDEF    8785--REDEF
CLOSE_TSN_USED.SN_
      8483**DCL      8483--REDEF
CLOSE_TSN_USED.UTL_
      8484**DCL      8484--REDEF
CLOSE_TSN_USED.V.EXPIRE#
      8498**DCL      8498--REDEF
CLOSE_TSN_USED.V.TYPE#
      8496**DCL      8496--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
      8493**DCL      8493--REDEF    8495--REDEF
CON_CLOSE_ARCHIVE.SN_
      8815**DCL      8815--REDEF
CON_CLOSE_ARCHIVE.UTL_
      8816**DCL      8816--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
      8830**DCL      8830--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
      8828**DCL      8828--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
      8825**DCL      8825--REDEF    8827--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
      8902**DCL      8903--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
      8908**DCL      8909--REDEF    8909--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
      8907**DCL      8908--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
      8906**DCL      8907--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
      8900**DCL      8901--REDEF    8901--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
      8940**DCL      8940--REDEF    8940--REDEF
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:241  
CON_OPEN_ARCHIVE_FILE.WSN_
      8906**DCL      8906--REDEF
CON_READ_ARCHIVE_FILE.STATION_
      8964**DCL      8965--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
      8976**DCL      8976--REDEF
CON_READ_ARCHIVE_FILE.V.INDX#
      8974**DCL      8974--REDEF
CVOL_UTL.ULBL#
      8243**DCL      8243--REDEF
DCB#
     16437**DCL     16544<<ASSIGN  16545<>CALL    16595<<ASSIGN  16596<>CALL
DEL_NODATA_REC.V
      9909**DCL      9906--DCLINIT
DISK_CLOSE.SN_
      7313**DCL      7313--REDEF
DISK_CLOSE.UTL_
      7314**DCL      7314--REDEF
DISK_CLOSE.V.EXPIRE#
      7328**DCL      7328--REDEF
DISK_CLOSE.V.TYPE#
      7326**DCL      7326--REDEF
DISK_CLOSE.V.XTNSIZE#
      7323**DCL      7323--REDEF    7325--REDEF
DISK_FILE_SPEC.SPEC
      7678**DCL      7680--REDEF
DISK_FILE_SPEC.SPEC.START
      7679**DCL      7679--REDEF
DISK_FILE_SPEC.SPEC.STOP
      7680**DCL      7680--REDEF
DISK_FILE_SPEC$
      7677**DCL      7678--IMP-PTR
DISK_GRAN$
      8154**DCL      8154--IMP-PTR
DISK_OPEN.ACSVEH_
      7178**DCL      7179--REDEF
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:242  
DISK_OPEN.ALTKEYS_
      7184**DCL      7185--REDEF    7185--REDEF
DISK_OPEN.HDR_
      7183**DCL      7184--REDEF
DISK_OPEN.TAB_
      7182**DCL      7183--REDEF
DISK_OPEN.UHL_
      7176**DCL      7177--REDEF    7177--REDEF
DISK_OPEN.V.FSN#
      7216**DCL      7216--REDEF    7216--REDEF
DISK_OPEN.WSN_
      7182**DCL      7182--REDEF
DISK_READ.STATION_
      7240**DCL      7241--REDEF
DISK_READ.V.DVBYTE.REREAD#
      7252**DCL      7252--REDEF
DISK_READ.V.INDX#
      7250**DCL      7250--REDEF
DISK_WRITE.STATION_
      7278**DCL      7278--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      7285**DCL      7285--REDEF
DPLIST$
      7663**DCL      7675--IMP-PTR
DPRESLIST$
      7677**DCL      7677--IMP-PTR
DUAL_FILE.L#
      9079**DCL      9079--IMP-SIZ
EFTWORD
      7798**DCL      7798--REDEF
EFT_CVOL_FILE.L#
      8203**DCL      8203--IMP-SIZ
EFT_RESTRICT_FILE.L#
      8230**DCL      8230--IMP-SIZ 16618>>IF
EFT_RESTRICT_FILE.NAME#
      8230**DCL     16618>>IF
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:243  
ERR
     16425**DCL         6--PROC    16543<<ASSIGN  16545<>CALL    16556<<ASSIGN  16566>>IF      16569<<ASSIGN
     16628<<ASSIGN  16639<<ASSIGN  16646<<ASSIGN  16656<<ASSIGN
ERR.CODE
     16429**DCL     16573>>IF      16575>>IF      16657>>IF      16660>>IF      16662>>IF
E_FILES_SKIPPED
     15474**DCL     16603<>CALL
E_IO_ERR
     15384**DCL     16543>>ASSIGN  16566>>IF      16596<>CALL
F$DCB.ACTPOS
     16491**DCL     16491--REDEF
F$DCB.ARS#
     16465**DCL     16465--REDEF
F$DCB.ATTR
     16484**DCL     16485--REDEF
F$DCB.BLKL#
     16481**DCL     16621>>IF      16622>>ASSIGN
F$DCB.BORROW
     16499**DCL     16499--REDEF   16499--REDEF   16499--REDEF
F$DCB.DCBNAME.L
     16513**DCL     16513--IMP-SIZ
F$DCB.EOMCHAR#
     16469**DCL     16469--REDEF
F$DCB.FLDID
     16494**DCL     16494--REDEF
F$DCB.FORM$
     16488**DCL     16488--REDEF
F$DCB.FSECT
     16504**DCL     16504--REDEF   16557>>IF
F$DCB.FSN#
     16481**DCL     16481--REDEF   16481--REDEF   16482--REDEF   16558>>ASSIGN  16559>>ASSIGN  16631>>ASSIGN
     16637>>IF
F$DCB.HEADER$
     16487**DCL     16487--REDEF
F$DCB.IXTNSIZE#
     16485**DCL     16485--REDEF
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:244  
F$DCB.LASTSTA$
     16474**DCL     16474--REDEF
F$DCB.LVL
     16500**DCL     16500--REDEF
F$DCB.NAME#.C
     16475**DCL     16475--REDEF   16618>>IF
F$DCB.NOEOF
     16497**DCL     16497--REDEF
F$DCB.NRECS#
     16486**DCL     16486--REDEF
F$DCB.NRECX
     16505**DCL     16505--REDEF
F$DCB.OHDR
     16497**DCL     16497--REDEF
F$DCB.ORG#
     16480**DCL     16480--REDEF   16618>>IF
F$DCB.PRECNO
     16503**DCL     16503--REDEF
F$DCB.PSN#
     16475**DCL     16548>>ASSIGN  16630>>ASSIGN
F$DCB.RCSZ
     16509**DCL     16509--REDEF
F$DCB.RES#
     16476**DCL     16476--REDEF   16642>>ASSIGN
F$DCB.SETX
     16488**DCL     16488--REDEF
F$DCB.TAB$
     16488**DCL     16488--REDEF
F$DCB.TDA
     16502**DCL     16503--REDEF
F$DCB.TYC.IOERR#
     16466**DCL     16541>>IF      16593>>IF
F$DCB.WSN#
     16476**DCL     16476--REDEF
FIT_AREA.W2
      8514**DCL      8515--REDEF
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:245  
FLI$ALLOC_BUF
     16412**DCL-ENT 16623--CALL
FLI$RPT_ERR
     16413**DCL-ENT 16545--CALL    16570--CALL    16596--CALL    16603--CALL    16645--CALL    16658--CALL
FPT_EXIT.V.STEPCC#
      7103**DCL      7103--REDEF   16546>>IF      16547<<ASSIGN  16576>>IF      16577<<ASSIGN  16597>>IF
     16598<<ASSIGN  16648>>IF      16649<<ASSIGN  16663>>IF      16664<<ASSIGN
INCR_BUF_
     16449**DCL     16623<>CALL
INCR_BUF_.W2
     16450**DCL     16451--REDEF
LAST_TAPE_FSN
      7797**DCL     16637>>IF      16637>>IF
M$CLOSE
      5503**DCL-ENT 16635--CALL
M$OPEN
      5503**DCL-ENT 16535--CALL    16586--CALL    16601--CALL
M$REM
      5512**DCL-ENT 16549--CALL
M$TAPE00$
      8140**DCL     16459--IMP-PTR 16541>>IF      16548>>ASSIGN  16557>>IF      16558>>ASSIGN  16559>>ASSIGN
     16593>>IF      16618>>IF      16618>>IF      16621>>IF      16622>>ASSIGN  16630>>ASSIGN  16631>>ASSIGN
     16637>>IF      16642>>ASSIGN
NBR_BYTES_TO_MOVE
      8153**DCL      8154--IMP-SIZ  8155--IMP-SIZ
NODATA_FILE_NAME.L#
      9768**DCL      9768--IMP-SIZ
NODATA_KEY
      9914**DCL      9906--DCLINIT  9907--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
      9701**DCL      9702--REDEF
OPEN_NODATA_LIST.ALTKEYS_
      9707**DCL      9708--REDEF    9708--REDEF
OPEN_NODATA_LIST.HDR_
      9706**DCL      9707--REDEF
OPEN_NODATA_LIST.TAB_
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:246  
      9705**DCL      9706--REDEF
OPEN_NODATA_LIST.UHL_
      9699**DCL      9700--REDEF    9700--REDEF
OPEN_NODATA_LIST.V.FSN#
      9739**DCL      9739--REDEF    9739--REDEF
OPEN_NODATA_LIST.WSN_
      9705**DCL      9705--REDEF
OPEN_PRIME_DUAL.ACSVEH_
      9148**DCL      9149--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
      9154**DCL      9155--REDEF    9155--REDEF
OPEN_PRIME_DUAL.HDR_
      9153**DCL      9154--REDEF
OPEN_PRIME_DUAL.TAB_
      9152**DCL      9153--REDEF
OPEN_PRIME_DUAL.UHL_
      9146**DCL      9147--REDEF    9147--REDEF
OPEN_PRIME_DUAL.V.FSN#
      9186**DCL      9186--REDEF    9186--REDEF
OPEN_PRIME_DUAL.WSN_
      9152**DCL      9152--REDEF
OPEN_REBUILD.ACSVEH_
      9383**DCL      9384--REDEF
OPEN_REBUILD.ALTKEYS_
      9389**DCL      9390--REDEF    9390--REDEF
OPEN_REBUILD.HDR_
      9388**DCL      9389--REDEF
OPEN_REBUILD.TAB_
      9387**DCL      9388--REDEF
OPEN_REBUILD.UHL_
      9381**DCL      9382--REDEF    9382--REDEF
OPEN_REBUILD.V.FSN#
      9421**DCL      9421--REDEF    9421--REDEF
OPEN_REBUILD.WSN_
      9387**DCL      9387--REDEF
OPEN_STATUS.ACSVEH_
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:247  
      8585**DCL      8586--REDEF
OPEN_STATUS.ALTKEYS_
      8591**DCL      8592--REDEF    8592--REDEF
OPEN_STATUS.HDR_
      8590**DCL      8591--REDEF
OPEN_STATUS.TAB_
      8589**DCL      8590--REDEF
OPEN_STATUS.UHL_
      8583**DCL      8584--REDEF    8584--REDEF
OPEN_STATUS.V.FSN#
      8623**DCL      8623--REDEF    8623--REDEF
OPEN_STATUS.WSN_
      8589**DCL      8589--REDEF
OPEN_TSN_USED.ACSVEH_
      8321**DCL      8322--REDEF
OPEN_TSN_USED.ALTKEYS_
      8327**DCL      8328--REDEF    8328--REDEF
OPEN_TSN_USED.HDR_
      8326**DCL      8327--REDEF
OPEN_TSN_USED.TAB_
      8325**DCL      8326--REDEF
OPEN_TSN_USED.UHL_
      8319**DCL      8320--REDEF    8320--REDEF
OPEN_TSN_USED.V.FSN#
      8359**DCL      8359--REDEF    8359--REDEF
OPEN_TSN_USED.WSN_
      8325**DCL      8325--REDEF
PRE_RET_CLOSE.SN_
      8041**DCL      8041--REDEF
PRE_RET_CLOSE.UTL_
      8042**DCL      8042--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      8056**DCL      8056--REDEF
PRE_RET_CLOSE.V.TYPE#
      8054**DCL      8054--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:248  
      8051**DCL      8051--REDEF    8053--REDEF
PRE_RET_OPEN.ACSVEH_
      7976**DCL      7977--REDEF
PRE_RET_OPEN.ALTKEYS_
      7982**DCL      7983--REDEF    7983--REDEF
PRE_RET_OPEN.HDR_
      7981**DCL      7982--REDEF
PRE_RET_OPEN.TAB_
      7980**DCL      7981--REDEF
PRE_RET_OPEN.UHL_
      7974**DCL      7975--REDEF    7975--REDEF
PRE_RET_OPEN.V.FSN#
      8014**DCL      8014--REDEF    8014--REDEF
PRE_RET_OPEN.WSN_
      7980**DCL      7980--REDEF
PRE_RET_READ.STATION_
      7831**DCL      7832--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      7843**DCL      7843--REDEF
PRE_RET_READ.V.INDX#
      7841**DCL      7841--REDEF
PRE_RET_WRITE.STATION_
      7869**DCL      7869--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      7876**DCL      7876--REDEF
PRIME_FILE.L#
      9052**DCL      9052--IMP-SIZ
READ_NODATA_LIST.STATION_
      9845**DCL      9846--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
      9857**DCL      9857--REDEF
READ_NODATA_LIST.V.INDX#
      9855**DCL      9855--REDEF
READ_PRIME_DUAL.STATION_
      9210**DCL      9211--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:249  
      9222**DCL      9222--REDEF
READ_PRIME_DUAL.V.INDX#
      9220**DCL      9220--REDEF
READ_REBUILD.STATION_
      9516**DCL      9517--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
      9528**DCL      9528--REDEF
READ_REBUILD.V.INDX#
      9526**DCL      9526--REDEF
READ_STATUS.STATION_
      8731**DCL      8732--REDEF
READ_STATUS.V.DVBYTE.REREAD#
      8743**DCL      8743--REDEF
READ_STATUS.V.INDX#
      8741**DCL      8741--REDEF
READ_TSN_USED.STATION_
      8441**DCL      8442--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
      8453**DCL      8453--REDEF
READ_TSN_USED.V.INDX#
      8451**DCL      8451--REDEF
REBUILD_DIR_KEY.L#
      9602**DCL      9602--IMP-SIZ
REBUILD_KEY.L#
      9629**DCL      9629--IMP-SIZ
REBUILD_NAME.L#
      9450**DCL      9450--IMP-SIZ
RETRY_OPEN
     16535**LABEL   16553--GOTO
RET_CMDS_NAME.L#
      8085**DCL      8085--IMP-SIZ
SIZE
     16436**DCL     16622<<ASSIGN  16623<>CALL    16624>>ASSIGN  16625>>ASSIGN
SMALL_LOOP
     16533**LABEL   16563--EXIT
SNVECLIST$
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:250  
      7617**DCL      7617--IMP-PTR
SPEC.START
      7681**DCL      7682--REDEF
SPEC.STOP
      7682**DCL      7683--REDEF
SPECCHARS
      7681**DCL      7681--REDEF
TAPE_BAD
      8248**DCL     16578<<ASSIGN  16647<<ASSIGN  16665<<ASSIGN
TAPE_BLOCK_
      8168**DCL     16627>>ASSIGN
TAPE_BLOCK_.PTR$
      8170**DCL     16629>>ASSIGN
TAPE_BLOCK_.W1.VSIZE#
      8168**DCL     16624<<ASSIGN  16624>>ASSIGN
TAPE_BLOCK_.W2
      8169**DCL      8170--REDEF
TAPE_BLOCK_SIZE
      8172**DCL     16621>>IF      16622>>ASSIGN  16625<<ASSIGN  16625>>ASSIGN
TAPE_CLOSE
      7534**DCL     16635<>CALL
TAPE_CLOSE.SN_
      7534**DCL      7534--REDEF
TAPE_CLOSE.UTL_
      7535**DCL      7535--REDEF
TAPE_CLOSE.V.EXPIRE#
      7549**DCL      7549--REDEF
TAPE_CLOSE.V.TYPE#
      7547**DCL      7547--REDEF
TAPE_CLOSE.V.XTNSIZE#
      7544**DCL      7544--REDEF    7546--REDEF
TAPE_DCBLIST$
      7090**DCL      7090--IMP-PTR
TAPE_FSN
      8246**DCL     16631<<ASSIGN
TAPE_OPEN
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:251  
      7397**DCL     16535<>CALL    16586<>CALL    16601<>CALL
TAPE_OPEN.ACSVEH_
      7399**DCL      7400--REDEF
TAPE_OPEN.ALTKEYS_
      7405**DCL      7406--REDEF    7406--REDEF
TAPE_OPEN.HDR_
      7404**DCL      7405--REDEF
TAPE_OPEN.NAME_
      7398**DCL     16615<<ASSIGN
TAPE_OPEN.TAB_
      7403**DCL      7404--REDEF
TAPE_OPEN.UHL_
      7397**DCL      7398--REDEF    7398--REDEF
TAPE_OPEN.V.DCB#
      7406**DCL     16544>>ASSIGN  16595>>ASSIGN
TAPE_OPEN.V.FINDPOS#
      7412**DCL     16600<<ASSIGN  16604<<ASSIGN  16607<<ASSIGN
TAPE_OPEN.V.FSN#
      7437**DCL      7437--REDEF    7437--REDEF   16529>>IF      16558<<ASSIGN  16559<<ASSIGN  16616<<ASSIGN
TAPE_OPEN.V.INITZ.SCRUB#
      7407**DCL     16614<<ASSIGN
TAPE_OPEN.V.IOERROK#
      7428**DCL     16541>>IF      16593>>IF
TAPE_OPEN.V.OPER.MNTONLY#
      7410**DCL     16531<<ASSIGN  16561<<ASSIGN
TAPE_OPEN.V.OPER.THISF#
      7409**DCL     16562<<ASSIGN  16599<<ASSIGN  16608<<ASSIGN  16613<<ASSIGN
TAPE_OPEN.V.RES#
      7421**DCL     16642<<ASSIGN
TAPE_OPEN.V.VOL#
      7431**DCL     16529>>IF      16552<<ASSIGN  16552>>ASSIGN  16617<<ASSIGN
TAPE_OPEN.WSN_
      7403**DCL      7403--REDEF
TAPE_OPEN_ALT
     16653**LABEL   16609--GOTO
TAPE_READ.BUF_
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:252  
      7460**DCL     16627<<ASSIGN
TAPE_READ.STATION_
      7461**DCL      7462--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      7473**DCL      7473--REDEF
TAPE_READ.V.INDX#
      7471**DCL      7471--REDEF
TAPE_REMOVE
      7578**DCL     16549<>CALL
TAPE_REMOVE.V.PSN#
      7579**DCL     16548<<ASSIGN
TAPE_SN
      8246**DCL     16630<<ASSIGN
TAPE_WRITE.STATION_
      7499**DCL      7499--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      7506**DCL      7506--REDEF
TSN_USED_NAME.L#
      8388**DCL      8388--IMP-SIZ
TVECTOR.W2
      7630**DCL      7631--REDEF
WRITE_NODATA_LIST.STATION_
      9883**DCL      9883--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
      9890**DCL      9890--REDEF
WRITE_PRIME_DUAL.STATION_
      9248**DCL      9248--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
      9255**DCL      9255--REDEF
WRITE_REBUILD.STATION_
      9484**DCL      9484--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
      9491**DCL      9491--REDEF
WRITE_STATUS.STATION_
      8699**DCL      8699--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
PL6.E3A0      #006=FLC$TAPE_OPEN File=FLC$ROUTINES.:E05TSI                       TUE 07/29/97 15:43 Page:253  
      8706**DCL      8706--REDEF
WRITE_TSN_USED.STATION_
      8409**DCL      8409--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
      8416**DCL      8416--REDEF

PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:254  
     1013        1        /*T***********************************************************/
     1014        2        /*T*                                                         */
     1015        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1016        4        /*T*                                                         */
     1017        5        /*T***********************************************************/
     1018        6        %EJECT;
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:255  
     1019        7        FLC$TAPE_CLOSE: PROC( ERR ) ALTRET;
     1020        8        /*F* NAME: FLC$TAPE_CLOSE
     1021        9              PURPOSE: Close currently open tape file.
     1022       10        */
     1023       11
     1024       12        /***
     1025       13         *** INCLUDE
     1026       14         ***/
     1027       15
     1028       16        %INCLUDE CP_6;
     1029     5575        %INCLUDE FLI_DATA_R;
     1030     6989        %INCLUDE FLS_DATA_R;
     1031     8789
     1032     8790        /***
     1033     8791         *** ENTRY
     1034     8792         ***/
     1035     8793
     1036     8794    1   DCL FLI$RPT_ERR ENTRY(5);
     1037     8795
     1038     8796
     1039     8797    1   DCL 1 ERR ALIGNED,
     1040     8798    1         2 FCG BIT(12) UNAL,
     1041     8799    1         2 MID BIT(6) UNAL,
     1042     8800    1         2 MON BIT(1) UNAL,
     1043     8801    1         2 CODE UBIN(14) UNAL,
     1044     8802    1         2 SEV UBIN(3) UNAL;
     1045     8803
     1046     8804        /***
     1047     8805         *** BASED
     1048     8806         ***/
     1049     8807
     1050     8808        %F$DCB( BASED="BASED(M$TAPE00$)" );
     1051     8865        %B$TCB( STCLASS="BASED(B$TCB$)" );
     1052     8868        %B$ALT;
     1053     8876
     1054     8877        /****************************************/
     1055     8878
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:256  
     1056     8879    2      IF F$DCB.FCD# THEN DO;
     1057     8880    2         CALL M$CLOSE( TAPE_CLOSE ) ALTRET( JUSTALT );
     1058     8881    2         END;
     1059     8882
     1060     8883    1      IF F$DCB.FSN# >= LAST_TAPE_FSN
     1061     8884    2       THEN DO;
     1062     8885    2         LAST_TAPE_FSN = 0;
     1063     8886    2         ALTRETURN;
     1064     8887    2         END;
     1065     8888    1       ELSE RETURN;
     1066     8889
     1067     8890    1   JUSTALT:
     1068     8891    1      CALL FLI$RPT_ERR;
     1069     8892    1      IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR
     1070     8893    1       THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;
     1071     8894    1      TAPE_BAD = '1'B;
     1072     8895    1      ERR = B$TCB.ALT$->B$ALT.ERR;
     1073     8896    1      ALTRETURN;
     1074     8897
     1075     8898    1   END FLC$TAPE_CLOSE;

PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:257  
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$TAPE_CLOSE.

   Procedure FLC$TAPE_CLOSE requires 35 words for executable code.
   Procedure FLC$TAPE_CLOSE requires 4 words of local(AUTO) storage.

    No errors detected in file FLC$ROUTINES.:E05TSI    .

PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:258  

 Object Unit name= FLC$TAPE_CLOSE                             File name= FLC$ROUTINES.:E05TOU
 UTS= JUL 29 '97 15:44:22.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$PRE_RET
    2   Data  even  none    20     24  FLC$TAPE_CLOSE
    3   DCB   even  none     0      0  M$TSN_USED
    4   DCB   even  none     0      0  M$STATUS
    5   DCB   even  none     0      0  M$REBUILD
    6   DCB   even  none     0      0  M$ARCHIVE
    7   DCB   even  none     0      0  M$NODATA_LIST
    8   Proc  even  none    35     43  FLC$TAPE_CLOSE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes    yes     yes      Std        1  FLC$TAPE_CLOSE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 FLI$RPT_ERR
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:259  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TAPE_DCBLIST$                         FPT_EXIT
     TAPE_CLOSE                            SNVECLIST$                            B$TCB$
     DPLIST$                               DPRESLIST$                            DISK_FILE_SPEC$
     SPECCHARS                             LAST_TAPE_FSN                         EFTWORD
     M$PRE_RET                             RET_CMDS_NAME                         M$TSN_USED
     M$STATUS                              M$REBUILD                             M$ARCHIVE
     M$NODATA_LIST                         M$TAPE00$                             BLK_TAG$
     BLK_TAG0$                             NBR_BYTES_TO_MOVE                     DISK_GRAN$
     BLOCK_GRAN$                      r    EFT_CVOL_FILE                    r    EFT_RESTRICT_FILE
     TAPE_BAD                              TSN_USED_NAME                         BACKUP_NAME
r    ARCHIVE_NAME                     r    PRIME_FILE                       r    DUAL_FILE
     REBUILD_NAME                          REBUILD_DIR_KEY                       REBUILD_KEY
     NODATA_FILE_NAME                      NODATA_KEY                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:260  


     1013        1        /*T***********************************************************/
     1014        2        /*T*                                                         */
     1015        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1016        4        /*T*                                                         */
     1017        5        /*T***********************************************************/
     1018        6        %EJECT;
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:261  
     1019        7        FLC$TAPE_CLOSE: PROC( ERR ) ALTRET;

      7  8 000000   000000 700200 xent  FLC$TAPE_CL* TSX0  ! X66_AUTO_1
         8 000001   000004 000001                    ZERO    4,1

     1020        8        /*F* NAME: FLC$TAPE_CLOSE
     1021        9              PURPOSE: Close currently open tape file.
     1022       10        */
     1023       11
     1024       12        /***
     1025       13         *** INCLUDE
     1026       14         ***/
     1027       15
     1028       16        %INCLUDE CP_6;
     1029     5575        %INCLUDE FLI_DATA_R;
     1030     6989        %INCLUDE FLS_DATA_R;
     1031     8789
     1032     8790        /***
     1033     8791         *** ENTRY
     1034     8792         ***/
     1035     8793
     1036     8794    1   DCL FLI$RPT_ERR ENTRY(5);
     1037     8795
     1038     8796
     1039     8797    1   DCL 1 ERR ALIGNED,
     1040     8798    1         2 FCG BIT(12) UNAL,
     1041     8799    1         2 MID BIT(6) UNAL,
     1042     8800    1         2 MON BIT(1) UNAL,
     1043     8801    1         2 CODE UBIN(14) UNAL,
     1044     8802    1         2 SEV UBIN(3) UNAL;
     1045     8803
     1046     8804        /***
     1047     8805         *** BASED
     1048     8806         ***/
     1049     8807
     1050     8808        %F$DCB( BASED="BASED(M$TAPE00$)" );
     1051     8865        %B$TCB( STCLASS="BASED(B$TCB$)" );
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:262  
     1052     8868        %B$ALT;
     1053     8876
     1054     8877        /****************************************/
     1055     8878
     1056     8879    2      IF F$DCB.FCD# THEN DO;

   8879  8 000002   000000 470400 xsym               LDP0    M$TAPE00$
         8 000003   000031 236100                    LDQ     25,,PR0
         8 000004   020000 316007                    CANQ    8192,DL
         8 000005   000012 600000 8                  TZE     s:8883

     1057     8880    2         CALL M$CLOSE( TAPE_CLOSE ) ALTRET( JUSTALT );

   8880  8 000006   000000 630400 xsym               EPPR0   TAPE_CLOSE
         8 000007   450001 713400                    CLIMB   alt,close
         8 000010   406000 401760                    pmme    nvectors=13
         8 000011   000022 702000 8                  TSX2    JUSTALT

     1058     8881    2         END;

     1059     8882
     1060     8883    1      IF F$DCB.FSN# >= LAST_TAPE_FSN

   8883  8 000012   000000 470400 xsym               LDP0    M$TAPE00$
         8 000013   000034 236100                    LDQ     28,,PR0
         8 000014   000022 772000                    QRL     18
         8 000015   000000 116000 xsym               CMPQ    LAST_TAPE_FSN
         8 000016   000021 604000 8                  TMI     s:8888

     1061     8884    2       THEN DO;

     1062     8885    2         LAST_TAPE_FSN = 0;

   8885  8 000017   000000 450000 xsym               STZ     LAST_TAPE_FSN

     1063     8886    2         ALTRETURN;

PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:263  
   8886  8 000020   000000 702200 xent               TSX2  ! X66_AALT

     1064     8887    2         END;
     1065     8888    1       ELSE RETURN;

   8888  8 000021   000000 702200 xent               TSX2  ! X66_ARET

     1066     8889
     1067     8890    1   JUSTALT:
     1068     8891    1      CALL FLI$RPT_ERR;

   8891  8 000022   000002 631400 xsym  JUSTALT      EPPR1   B_VECTNIL+2
         8 000023   000000 701000 xent               TSX1    FLI$RPT_ERR
         8 000024   000000 011000                    NOP     0

     1069     8892    1      IF FPT_EXIT.V.STEPCC# < %TAPE_ERROR

   8892  8 000025   000004 236000 xsym               LDQ     FPT_EXIT+4
         8 000026   777000 376003                    ANQ     -512,DU
         8 000027   004000 116003                    CMPQ    2048,DU
         8 000030   000033 603000 8                  TRC     s:8894

     1070     8893    1       THEN FPT_EXIT.V.STEPCC# = %TAPE_ERROR;

   8893  8 000031   004000 236003                    LDQ     2048,DU
         8 000032   000004 552040 xsym               STBQ    FPT_EXIT+4,'40'O

     1071     8894    1      TAPE_BAD = '1'B;

   8894  8 000033   400000 236003                    LDQ     -131072,DU
         8 000034   000000 756000 xsym               STQ     TAPE_BAD

     1072     8895    1      ERR = B$TCB.ALT$->B$ALT.ERR;

   8895  8 000035   000000 470400 xsym               LDP0    B$TCB$
         8 000036   000000 471500                    LDP1    0,,PR0
         8 000037   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:264  
         8 000040   200003 473500                    LDP3    @ERR,,AUTO
         8 000041   300000 756100                    STQ     0,,PR3

     1073     8896    1      ALTRETURN;

   8896  8 000042   000000 702200 xent               TSX2  ! X66_AALT
     1074     8897
     1075     8898    1   END FLC$TAPE_CLOSE;

PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:265  
--  Include file information  --

   FLS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   FLB_SUBS_C.:E05TOU  is referenced.
   FLI_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FLC$TAPE_CLOSE.
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:266  

 **** Variables and constants ****

  ****  Section 002  Data  FLC$TAPE_CLOSE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/d STRC(360)   r     1 DEL_NODATA_REC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ERR                      *0-0-0/w STRC        r     1 ERR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ASTR(9)     r     1 ARCHIVE_NAME               0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 BACKUP_NAME                0-0-0/w PTR         r     1 BLK_TAG$
     0-0-0/w PTR         r     1 BLK_TAG0$                  0-0-0/w PTR         r     1 BLOCK_GRAN$
     0-0-0/w PTR         r     1 DISK_FILE_SPEC$            0-0-0/w PTR         r     1 DISK_GRAN$
     0-0-0/w PTR         r     1 DPLIST$                    0-0-0/w PTR         r     1 DPRESLIST$
     0-0-0/c ASTR(9)     r     1 DUAL_FILE                  0-0-0/c ASTR(9)     r     1 EFT_CVOL_FILE
     0-0-0/c ASTR(9)     r     1 EFT_RESTRICT_FILE          0-0-0/d STRC(216)   r     1 FPT_EXIT
     0-0-0/w SBIN        r     1 LAST_TAPE_FSN              0-0-0/w PTR         r     1 M$TAPE00$
     0-0-0/w SBIN        r     1 NBR_BYTES_TO_MOVE          0-0-0/c ASTR(9)     r     1 NODATA_FILE_NAME
     0-0-0/c STRC(369)   r     1 NODATA_KEY                 0-0-0/c ASTR(9)     r     1 PRIME_FILE
     0-0-0/c ASTR(9)     r     1 REBUILD_DIR_KEY            0-0-0/c ASTR(9)     r     1 REBUILD_KEY
     0-0-0/c ASTR(9)     r     1 REBUILD_NAME               0-0-0/c ASTR(9)     r     1 RET_CMDS_NAME
     0-0-0/w PTR         r     1 SNVECLIST$                 0-0-0/b BIT         r     1 TAPE_BAD
     0-0-0/d STRC(1080)  r     1 TAPE_CLOSE                 0-0-0/w PTR         r     1 TAPE_DCBLIST$
     0-0-0/c ASTR(9)     r     1 TSN_USED_NAME

PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:267  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$NODATA_LIST


   Procedure FLC$TAPE_CLOSE requires 35 words for executable code.
   Procedure FLC$TAPE_CLOSE requires 4 words of local(AUTO) storage.

    No errors detected in file FLC$ROUTINES.:E05TSI    .
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:268  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:269  
          MINI XREF LISTING

ARCHIVE_NAME.L#
      7881**DCL      7881--IMP-SIZ
B$ALT.CODE
      8870**DCL      8870--REDEF    8871--REDEF    8871--REDEF
B$ALT.ERR
      8871**DCL      8895>>ASSIGN
B$ALT.ERR.ERR#
      8872**DCL      8872--REDEF
B$ALT.EVID
      8871**DCL      8871--REDEF    8871--REDEF
B$TCB.ALT$
      8866**DCL      8895>>ASSIGN
B$TCB$
      6506**DCL      8866--IMP-PTR  8895>>ASSIGN
BACKUP_NAME.L#
      7525**DCL      7525--IMP-SIZ
BLK_TAG.NAME
      7017**DCL      7017--REDEF
BLK_TAG$
      7014**DCL      7014--IMP-PTR
BLK_TAG0.NAME
      7023**DCL      7023--REDEF
BLK_TAG0$
      7020**DCL      7020--IMP-PTR
BLOCK_GRAN$
      7027**DCL      7028--IMP-PTR
CLOSE_NODATA_LIST.SN_
      8679**DCL      8679--REDEF
CLOSE_NODATA_LIST.UTL_
      8680**DCL      8680--REDEF
CLOSE_NODATA_LIST.V.EXPIRE#
      8694**DCL      8694--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:270  
CLOSE_NODATA_LIST.V.TYPE#
      8692**DCL      8692--REDEF
CLOSE_NODATA_LIST.V.XTNSIZE#
      8689**DCL      8689--REDEF    8691--REDEF
CLOSE_PRIME_DUAL.SN_
      8156**DCL      8156--REDEF
CLOSE_PRIME_DUAL.UTL_
      8157**DCL      8157--REDEF
CLOSE_PRIME_DUAL.V.EXPIRE#
      8171**DCL      8171--REDEF
CLOSE_PRIME_DUAL.V.TYPE#
      8169**DCL      8169--REDEF
CLOSE_PRIME_DUAL.V.XTNSIZE#
      8166**DCL      8166--REDEF    8168--REDEF
CLOSE_REBUILD.SN_
      8431**DCL      8431--REDEF
CLOSE_REBUILD.UTL_
      8432**DCL      8432--REDEF
CLOSE_REBUILD.V.EXPIRE#
      8446**DCL      8446--REDEF
CLOSE_REBUILD.V.TYPE#
      8444**DCL      8444--REDEF
CLOSE_REBUILD.V.XTNSIZE#
      8441**DCL      8441--REDEF    8443--REDEF
CLOSE_STATUS.SN_
      7646**DCL      7646--REDEF
CLOSE_STATUS.UTL_
      7647**DCL      7647--REDEF
CLOSE_STATUS.V.EXPIRE#
      7661**DCL      7661--REDEF
CLOSE_STATUS.V.TYPE#
      7659**DCL      7659--REDEF
CLOSE_STATUS.V.XTNSIZE#
      7656**DCL      7656--REDEF    7658--REDEF
CLOSE_TSN_USED.SN_
      7356**DCL      7356--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:271  
CLOSE_TSN_USED.UTL_
      7357**DCL      7357--REDEF
CLOSE_TSN_USED.V.EXPIRE#
      7371**DCL      7371--REDEF
CLOSE_TSN_USED.V.TYPE#
      7369**DCL      7369--REDEF
CLOSE_TSN_USED.V.XTNSIZE#
      7366**DCL      7366--REDEF    7368--REDEF
CON_CLOSE_ARCHIVE.SN_
      7688**DCL      7688--REDEF
CON_CLOSE_ARCHIVE.UTL_
      7689**DCL      7689--REDEF
CON_CLOSE_ARCHIVE.V.EXPIRE#
      7703**DCL      7703--REDEF
CON_CLOSE_ARCHIVE.V.TYPE#
      7701**DCL      7701--REDEF
CON_CLOSE_ARCHIVE.V.XTNSIZE#
      7698**DCL      7698--REDEF    7700--REDEF
CON_OPEN_ARCHIVE_FILE.ACSVEH_
      7775**DCL      7776--REDEF
CON_OPEN_ARCHIVE_FILE.ALTKEYS_
      7781**DCL      7782--REDEF    7782--REDEF
CON_OPEN_ARCHIVE_FILE.HDR_
      7780**DCL      7781--REDEF
CON_OPEN_ARCHIVE_FILE.TAB_
      7779**DCL      7780--REDEF
CON_OPEN_ARCHIVE_FILE.UHL_
      7773**DCL      7774--REDEF    7774--REDEF
CON_OPEN_ARCHIVE_FILE.V.FSN#
      7813**DCL      7813--REDEF    7813--REDEF
CON_OPEN_ARCHIVE_FILE.WSN_
      7779**DCL      7779--REDEF
CON_READ_ARCHIVE_FILE.STATION_
      7837**DCL      7838--REDEF
CON_READ_ARCHIVE_FILE.V.DVBYTE.REREAD#
      7849**DCL      7849--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:272  
CON_READ_ARCHIVE_FILE.V.INDX#
      7847**DCL      7847--REDEF
CVOL_UTL.ULBL#
      7116**DCL      7116--REDEF
DEL_NODATA_REC.V
      8782**DCL      8779--DCLINIT
DISK_CLOSE.SN_
      6186**DCL      6186--REDEF
DISK_CLOSE.UTL_
      6187**DCL      6187--REDEF
DISK_CLOSE.V.EXPIRE#
      6201**DCL      6201--REDEF
DISK_CLOSE.V.TYPE#
      6199**DCL      6199--REDEF
DISK_CLOSE.V.XTNSIZE#
      6196**DCL      6196--REDEF    6198--REDEF
DISK_FILE_SPEC.SPEC
      6551**DCL      6553--REDEF
DISK_FILE_SPEC.SPEC.START
      6552**DCL      6552--REDEF
DISK_FILE_SPEC.SPEC.STOP
      6553**DCL      6553--REDEF
DISK_FILE_SPEC$
      6550**DCL      6551--IMP-PTR
DISK_GRAN$
      7027**DCL      7027--IMP-PTR
DISK_OPEN.ACSVEH_
      6051**DCL      6052--REDEF
DISK_OPEN.ALTKEYS_
      6057**DCL      6058--REDEF    6058--REDEF
DISK_OPEN.HDR_
      6056**DCL      6057--REDEF
DISK_OPEN.TAB_
      6055**DCL      6056--REDEF
DISK_OPEN.UHL_
      6049**DCL      6050--REDEF    6050--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:273  
DISK_OPEN.V.FSN#
      6089**DCL      6089--REDEF    6089--REDEF
DISK_OPEN.WSN_
      6055**DCL      6055--REDEF
DISK_READ.STATION_
      6113**DCL      6114--REDEF
DISK_READ.V.DVBYTE.REREAD#
      6125**DCL      6125--REDEF
DISK_READ.V.INDX#
      6123**DCL      6123--REDEF
DISK_WRITE.STATION_
      6151**DCL      6151--REDEF
DISK_WRITE.V.DVBYTE.VFC#
      6158**DCL      6158--REDEF
DPLIST$
      6536**DCL      6548--IMP-PTR
DPRESLIST$
      6550**DCL      6550--IMP-PTR
DUAL_FILE.L#
      7952**DCL      7952--IMP-SIZ
EFTWORD
      6671**DCL      6671--REDEF
EFT_CVOL_FILE.L#
      7076**DCL      7076--IMP-SIZ
EFT_RESTRICT_FILE.L#
      7103**DCL      7103--IMP-SIZ
ERR
      8797**DCL         7--PROC     8895<<ASSIGN
F$DCB.ACTPOS
      8841**DCL      8841--REDEF
F$DCB.ARS#
      8815**DCL      8815--REDEF
F$DCB.ATTR
      8834**DCL      8835--REDEF
F$DCB.BORROW
      8849**DCL      8849--REDEF    8849--REDEF    8849--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:274  
F$DCB.DCBNAME.L
      8863**DCL      8863--IMP-SIZ
F$DCB.EOMCHAR#
      8819**DCL      8819--REDEF
F$DCB.FCD#
      8828**DCL      8879>>IF
F$DCB.FLDID
      8844**DCL      8844--REDEF
F$DCB.FORM$
      8838**DCL      8838--REDEF
F$DCB.FSECT
      8854**DCL      8854--REDEF
F$DCB.FSN#
      8831**DCL      8831--REDEF    8831--REDEF    8832--REDEF    8883>>IF
F$DCB.HEADER$
      8837**DCL      8837--REDEF
F$DCB.IXTNSIZE#
      8835**DCL      8835--REDEF
F$DCB.LASTSTA$
      8824**DCL      8824--REDEF
F$DCB.LVL
      8850**DCL      8850--REDEF
F$DCB.NAME#.C
      8825**DCL      8825--REDEF
F$DCB.NOEOF
      8847**DCL      8847--REDEF
F$DCB.NRECS#
      8836**DCL      8836--REDEF
F$DCB.NRECX
      8855**DCL      8855--REDEF
F$DCB.OHDR
      8847**DCL      8847--REDEF
F$DCB.ORG#
      8830**DCL      8830--REDEF
F$DCB.PRECNO
      8853**DCL      8853--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:275  
F$DCB.RCSZ
      8859**DCL      8859--REDEF
F$DCB.RES#
      8826**DCL      8826--REDEF
F$DCB.SETX
      8838**DCL      8838--REDEF
F$DCB.TAB$
      8838**DCL      8838--REDEF
F$DCB.TDA
      8852**DCL      8853--REDEF
F$DCB.WSN#
      8826**DCL      8826--REDEF
FIT_AREA.W2
      7387**DCL      7388--REDEF
FLI$RPT_ERR
      8794**DCL-ENT  8891--CALL
FPT_EXIT.V.STEPCC#
      5976**DCL      5976--REDEF    8892>>IF       8893<<ASSIGN
JUSTALT
      8891**LABEL    8880--CALLALT
LAST_TAPE_FSN
      6670**DCL      8883>>IF       8885<<ASSIGN
M$CLOSE
      5503**DCL-ENT  8880--CALL
M$TAPE00$
      7013**DCL      8809--IMP-PTR  8879>>IF       8883>>IF
NBR_BYTES_TO_MOVE
      7026**DCL      7027--IMP-SIZ  7028--IMP-SIZ
NODATA_FILE_NAME.L#
      8641**DCL      8641--IMP-SIZ
NODATA_KEY
      8787**DCL      8779--DCLINIT  8780--DCLINIT
OPEN_NODATA_LIST.ACSVEH_
      8574**DCL      8575--REDEF
OPEN_NODATA_LIST.ALTKEYS_
      8580**DCL      8581--REDEF    8581--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:276  
OPEN_NODATA_LIST.HDR_
      8579**DCL      8580--REDEF
OPEN_NODATA_LIST.TAB_
      8578**DCL      8579--REDEF
OPEN_NODATA_LIST.UHL_
      8572**DCL      8573--REDEF    8573--REDEF
OPEN_NODATA_LIST.V.FSN#
      8612**DCL      8612--REDEF    8612--REDEF
OPEN_NODATA_LIST.WSN_
      8578**DCL      8578--REDEF
OPEN_PRIME_DUAL.ACSVEH_
      8021**DCL      8022--REDEF
OPEN_PRIME_DUAL.ALTKEYS_
      8027**DCL      8028--REDEF    8028--REDEF
OPEN_PRIME_DUAL.HDR_
      8026**DCL      8027--REDEF
OPEN_PRIME_DUAL.TAB_
      8025**DCL      8026--REDEF
OPEN_PRIME_DUAL.UHL_
      8019**DCL      8020--REDEF    8020--REDEF
OPEN_PRIME_DUAL.V.FSN#
      8059**DCL      8059--REDEF    8059--REDEF
OPEN_PRIME_DUAL.WSN_
      8025**DCL      8025--REDEF
OPEN_REBUILD.ACSVEH_
      8256**DCL      8257--REDEF
OPEN_REBUILD.ALTKEYS_
      8262**DCL      8263--REDEF    8263--REDEF
OPEN_REBUILD.HDR_
      8261**DCL      8262--REDEF
OPEN_REBUILD.TAB_
      8260**DCL      8261--REDEF
OPEN_REBUILD.UHL_
      8254**DCL      8255--REDEF    8255--REDEF
OPEN_REBUILD.V.FSN#
      8294**DCL      8294--REDEF    8294--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:277  
OPEN_REBUILD.WSN_
      8260**DCL      8260--REDEF
OPEN_STATUS.ACSVEH_
      7458**DCL      7459--REDEF
OPEN_STATUS.ALTKEYS_
      7464**DCL      7465--REDEF    7465--REDEF
OPEN_STATUS.HDR_
      7463**DCL      7464--REDEF
OPEN_STATUS.TAB_
      7462**DCL      7463--REDEF
OPEN_STATUS.UHL_
      7456**DCL      7457--REDEF    7457--REDEF
OPEN_STATUS.V.FSN#
      7496**DCL      7496--REDEF    7496--REDEF
OPEN_STATUS.WSN_
      7462**DCL      7462--REDEF
OPEN_TSN_USED.ACSVEH_
      7194**DCL      7195--REDEF
OPEN_TSN_USED.ALTKEYS_
      7200**DCL      7201--REDEF    7201--REDEF
OPEN_TSN_USED.HDR_
      7199**DCL      7200--REDEF
OPEN_TSN_USED.TAB_
      7198**DCL      7199--REDEF
OPEN_TSN_USED.UHL_
      7192**DCL      7193--REDEF    7193--REDEF
OPEN_TSN_USED.V.FSN#
      7232**DCL      7232--REDEF    7232--REDEF
OPEN_TSN_USED.WSN_
      7198**DCL      7198--REDEF
PRE_RET_CLOSE.SN_
      6914**DCL      6914--REDEF
PRE_RET_CLOSE.UTL_
      6915**DCL      6915--REDEF
PRE_RET_CLOSE.V.EXPIRE#
      6929**DCL      6929--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:278  
PRE_RET_CLOSE.V.TYPE#
      6927**DCL      6927--REDEF
PRE_RET_CLOSE.V.XTNSIZE#
      6924**DCL      6924--REDEF    6926--REDEF
PRE_RET_OPEN.ACSVEH_
      6849**DCL      6850--REDEF
PRE_RET_OPEN.ALTKEYS_
      6855**DCL      6856--REDEF    6856--REDEF
PRE_RET_OPEN.HDR_
      6854**DCL      6855--REDEF
PRE_RET_OPEN.TAB_
      6853**DCL      6854--REDEF
PRE_RET_OPEN.UHL_
      6847**DCL      6848--REDEF    6848--REDEF
PRE_RET_OPEN.V.FSN#
      6887**DCL      6887--REDEF    6887--REDEF
PRE_RET_OPEN.WSN_
      6853**DCL      6853--REDEF
PRE_RET_READ.STATION_
      6704**DCL      6705--REDEF
PRE_RET_READ.V.DVBYTE.REREAD#
      6716**DCL      6716--REDEF
PRE_RET_READ.V.INDX#
      6714**DCL      6714--REDEF
PRE_RET_WRITE.STATION_
      6742**DCL      6742--REDEF
PRE_RET_WRITE.V.DVBYTE.VFC#
      6749**DCL      6749--REDEF
PRIME_FILE.L#
      7925**DCL      7925--IMP-SIZ
READ_NODATA_LIST.STATION_
      8718**DCL      8719--REDEF
READ_NODATA_LIST.V.DVBYTE.REREAD#
      8730**DCL      8730--REDEF
READ_NODATA_LIST.V.INDX#
      8728**DCL      8728--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:279  
READ_PRIME_DUAL.STATION_
      8083**DCL      8084--REDEF
READ_PRIME_DUAL.V.DVBYTE.REREAD#
      8095**DCL      8095--REDEF
READ_PRIME_DUAL.V.INDX#
      8093**DCL      8093--REDEF
READ_REBUILD.STATION_
      8389**DCL      8390--REDEF
READ_REBUILD.V.DVBYTE.REREAD#
      8401**DCL      8401--REDEF
READ_REBUILD.V.INDX#
      8399**DCL      8399--REDEF
READ_STATUS.STATION_
      7604**DCL      7605--REDEF
READ_STATUS.V.DVBYTE.REREAD#
      7616**DCL      7616--REDEF
READ_STATUS.V.INDX#
      7614**DCL      7614--REDEF
READ_TSN_USED.STATION_
      7314**DCL      7315--REDEF
READ_TSN_USED.V.DVBYTE.REREAD#
      7326**DCL      7326--REDEF
READ_TSN_USED.V.INDX#
      7324**DCL      7324--REDEF
REBUILD_DIR_KEY.L#
      8475**DCL      8475--IMP-SIZ
REBUILD_KEY.L#
      8502**DCL      8502--IMP-SIZ
REBUILD_NAME.L#
      8323**DCL      8323--IMP-SIZ
RET_CMDS_NAME.L#
      6958**DCL      6958--IMP-SIZ
SNVECLIST$
      6490**DCL      6490--IMP-PTR
SPEC.START
      6554**DCL      6555--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:280  
SPEC.STOP
      6555**DCL      6556--REDEF
SPECCHARS
      6554**DCL      6554--REDEF
TAPE_BAD
      7121**DCL      8894<<ASSIGN
TAPE_BLOCK_.W2
      7042**DCL      7043--REDEF
TAPE_CLOSE
      6407**DCL      8880<>CALL
TAPE_CLOSE.SN_
      6407**DCL      6407--REDEF
TAPE_CLOSE.UTL_
      6408**DCL      6408--REDEF
TAPE_CLOSE.V.EXPIRE#
      6422**DCL      6422--REDEF
TAPE_CLOSE.V.TYPE#
      6420**DCL      6420--REDEF
TAPE_CLOSE.V.XTNSIZE#
      6417**DCL      6417--REDEF    6419--REDEF
TAPE_DCBLIST$
      5963**DCL      5963--IMP-PTR
TAPE_OPEN.ACSVEH_
      6272**DCL      6273--REDEF
TAPE_OPEN.ALTKEYS_
      6278**DCL      6279--REDEF    6279--REDEF
TAPE_OPEN.HDR_
      6277**DCL      6278--REDEF
TAPE_OPEN.TAB_
      6276**DCL      6277--REDEF
TAPE_OPEN.UHL_
      6270**DCL      6271--REDEF    6271--REDEF
TAPE_OPEN.V.FSN#
      6310**DCL      6310--REDEF    6310--REDEF
TAPE_OPEN.WSN_
      6276**DCL      6276--REDEF
PL6.E3A0      #007=FLC$TAPE_CLOSE File=FLC$ROUTINES.:E05TSI                      TUE 07/29/97 15:44 Page:281  
TAPE_READ.STATION_
      6334**DCL      6335--REDEF
TAPE_READ.V.DVBYTE.REREAD#
      6346**DCL      6346--REDEF
TAPE_READ.V.INDX#
      6344**DCL      6344--REDEF
TAPE_WRITE.STATION_
      6372**DCL      6372--REDEF
TAPE_WRITE.V.DVBYTE.VFC#
      6379**DCL      6379--REDEF
TSN_USED_NAME.L#
      7261**DCL      7261--IMP-SIZ
TVECTOR.W2
      6503**DCL      6504--REDEF
WRITE_NODATA_LIST.STATION_
      8756**DCL      8756--REDEF
WRITE_NODATA_LIST.V.DVBYTE.VFC#
      8763**DCL      8763--REDEF
WRITE_PRIME_DUAL.STATION_
      8121**DCL      8121--REDEF
WRITE_PRIME_DUAL.V.DVBYTE.VFC#
      8128**DCL      8128--REDEF
WRITE_REBUILD.STATION_
      8357**DCL      8357--REDEF
WRITE_REBUILD.V.DVBYTE.VFC#
      8364**DCL      8364--REDEF
WRITE_STATUS.STATION_
      7572**DCL      7572--REDEF
WRITE_STATUS.V.DVBYTE.VFC#
      7579**DCL      7579--REDEF
WRITE_TSN_USED.STATION_
      7282**DCL      7282--REDEF
WRITE_TSN_USED.V.DVBYTE.VFC#
      7289**DCL      7289--REDEF
