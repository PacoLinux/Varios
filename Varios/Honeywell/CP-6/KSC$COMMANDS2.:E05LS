VERSION E05

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        KSC$DISPLAY: PROC(TOP$) ALTRET;
        7        7        /**/
        8        8    1   DCL TOP$ PTR;
        9        9        /**/
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE CP_6_SUBS;
       12      631        %INCLUDE KL_MACRO_C;
       13     3983        %INCLUDE KS_MACRO_M;
       14     4180        %INCLUDE KS_SUBS_C;
       15     4423        %INCLUDE KS_DATA_R;
       16     4438        %INCLUDE KS_PERR_C;
       17     4505        %INCLUDE KL_CONTROL_C;
       18     4885        %INCLUDE KL_AFCN_C;
       19     4986        %INCLUDE KL_CONFIG_M;
       20     5748        %INCLUDE GI_BOOT_C;
       21     5859        %INCLUDE XU_MACRO_C;
       22     8965        %INCLUDE KH$CHN;
       23     9087        %INCLUDE B_ERRORS_C;
       24    10214        %INCLUDE KHA_FNC_E;
       25    10314        %INCLUDE F$DCB;
       26    10363        %INCLUDE KL_SUPER_C;
       27    13265        /**/
       28    13266        %KS$BOX(TITLE="entry defs");

             13284    1   /***************************************************************************
             13285    1    *                                                                         *
             13286    1    *                                 entry defs                              *
             13287    1    *                                                                         *
             13288    1    ***************************************************************************/

       29    13293    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
       30    13294    1   DCL KSE$ERRMSG ENTRY(4);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:2    
       31    13295    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
       32    13296    1   DCL KSU$HEXBIN ENTRY(2);
       33    13297    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
       34    13298    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
       35    13299    1   DCL KSW$WRITE ENTRY(11);
       36    13300    1   DCL KSU$PACK2 ENTRY(2);
       37    13301    1   DCL KSU$PACK4 ENTRY(2);
       38    13302    1   DCL KSU$UNPACK ENTRY(2);
       39    13303    1   DCL KSU$BLD_KL_CONTROL ENTRY(5);
       40    13304    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
       41    13305        %KS$BOX(TITLE="symref variables");

             13323    1   /***************************************************************************
             13324    1    *                                                                         *
             13325    1    *                              symref variables                           *
             13326    1    *                                                                         *
             13327    1    ***************************************************************************/

       42    13332    1   DCL B$TCB$ PTR SYMREF;
       43    13333    1   DCL KS_TBL(0:0) PTR SYMREF;
       44    13334        %KS$HAND_INFO (NAME=KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF",LAST=YES);
       45    13373        %KS$BOX(TITLE="symdef variables");

             13391    1   /***************************************************************************
             13392    1    *                                                                         *
             13393    1    *                              symdef variables                           *
             13394    1    *                                                                         *
             13395    1    ***************************************************************************/

       46    13400        %KS$BOX(TITLE="constant variables",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:3    
             13418    1   /***************************************************************************
             13419    1    *                                                                         *
             13420    1    *                             constant variables                          *
             13421    1    *                                                                         *
             13422    1    ***************************************************************************/

       47    13427    1   DCL TEXT_NODETYPE(0:5) CHAR(4) CONSTANT INIT(' ','Host','Fep','Me','Debg','Rfep');
       48    13428    1   DCL BOOTFID_FMT CHAR(0) CALIGNED CONSTANT INIT('%/Monitor Fid: %A%/Library: %A%10P')
             13428            ;
       49    13429    1   DCL BOOTFID_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(BOOTFID_FMT));
       50    13430        /*
       51    13431          Variable declarations necessary for the CHANNEL table display
       52    13432          from the FEP.
       53    13433        */
       54    13434
       55    13435
       56    13436    1        DCL CHN_HDR_FMT_1 CHAR(0) CONSTANT INIT(
             13436           'DEV  DEV  EXT        CTX            DRC DRP DWN             SND CCB LGN RED%10P'
             13436                 );
       57    13437    1        DCL CHN_HDR_FMT_2 CHAR(0) CONSTANT INIT(
             13437           'ADDR ID   ID   ATTR  PTR  RS STATUS CNC DTR LD  ENB INP OTP SLT I O TO  TO %10P'
             13437                 );
       58    13438    1        DCL CHN_DAT_FMT CHAR(0) CONSTANT
       59    13439    1                INIT('%4H%X%4H%X%4H%X%4H%X%5H%X%2A%2X%4A%2X%3A%X%3A%X%3A%X%3A%X%3A%X%3A
             13439        %X%3A%1S%X%1D%X%1D%X%3D%X%3D%10P');
       60    13440    1        DCL CHAN_HD_FUL_FMT CHAR(0) CALIGNED CONSTANT INIT(
             13440                 '%/%20- Channel #%LH-%D-%D on Node %LD(%LA%10P)');
       61    13441    1        DCL CHAN_HD_FUL_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CHAN_HD_FUL_FMT));
       62    13442
       63    13443        /*
       64    13444                format and vector necessary for pseudo displays
       65    13445        */
       66    13446
       67    13447    1   DCL PSEUDO_NME_FMT CHAR(0) CONSTANT INIT(
             13447            'Name: %A%/%5XMax Ghost = %LD%/%5XMax Handler = %LD%10P');
       68    13448    1   DCL PSEUDO_NME_VEC VECTOR CONSTANT DALIGNED INIT(VECTOR(PSEUDO_NME_FMT));
       69    13449    1   DCL PSEUDO_USR_FMT CHAR(0) CONSTANT INIT(
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:4    
             13449            '%5XMax CG = %LD%/%5XMax User = %LD%/%5XMax System = %LD%10P');
       70    13450    1   DCL PSEUDO_USR_VEC VECTOR CONSTANT DALIGNED INIT(VECTOR(PSEUDO_USR_FMT));
       71    13451        /*
       72    13452             format and vectors for status display
       73    13453        */
       74    13454    1   DCL KS_NETSTAT CHAR(0) CONSTANT INIT('NETWORK STATUS');
       75    13455    1   DCL NET_STAT_FMT CHAR(0) CONSTANT INIT('%/%33- %A%10P %/%33- ______________');
       76    13456    1   DCL NET_STAT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(NET_STAT_FMT));
       77    13457    1   DCL NODE_FMT CHAR(0) CONSTANT INIT('%2/%5- Node # %LD Node Name = %LA%10P');
       78    13458    1   DCL NODE_VEC BIT(72) DALIGNED CONSTANT INIT(VECTOR(NODE_FMT));
       79    13459    1   DCL HST_FMT CHAR(0) CONSTANT INIT ('%/%10- Host..........................%LA%10P');
       80    13460    1   DCL HST_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(HST_FMT));
       81    13461    1   DCL ACTV_FMT CHAR(0) CONSTANT INIT('%10- Active........................%LA%10P');
       82    13462    1   DCL ACTV_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(ACTV_FMT));
       83    13463    1   DCL CN_FMT CHAR(0) CONSTANT INIT('%10- Current Node..................%LA%10P');
       84    13464    1   DCL CN_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CN_FMT));
       85    13465    1   DCL QOS_FMT CHAR(0) CONSTANT INIT('%10- Quality of Service............%D%10P');
       86    13466    1   DCL QOS_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(QOS_FMT));
       87    13467    1   DCL ALT_FMT CHAR(0) CONSTANT INIT('%10- Alt Quality of Service........%D%10P');
       88    13468    1   DCL ALT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(ALT_FMT));
       89    13469    1   DCL LNKNME_FMT CHAR(0) CONSTANT INIT('%10- Link Node Name................%LA%10P');
       90    13470    1   DCL LNKNME_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNKNME_FMT));
       91    13471    1   DCL LNKNUM_FMT CHAR(0) CONSTANT INIT('%10- Link Node Number..............%LD%10P');
       92    13472    1   DCL LNKNUM_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNKNUM_FMT));
       93    13473    1   DCL LNKCNCT_FMT CHAR(0) CONSTANT INIT('%10- Link Connected................%LA%10P');
       94    13474    1   DCL LNKCNCT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNKCNCT_FMT));
       95    13475    1   DCL BLK_FMT CHAR(0) CONSTANT INIT('%T %2X (%2P%D%3P) %25- %D%10P');
       96    13476    1   DCL SHORT_HDR_FMT CHAR(0) CONSTANT INIT('%A%10P');
       97    13477    1   DCL SHORT_LINE_FMT CHAR(0) CALIGNED CONSTANT INIT('  Node %LD(%LA) %LA%10P');
       98    13478    1   DCL SHORT_LINE_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(SHORT_LINE_FMT));
       99    13479    1   DCL SHORT_HDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(SHORT_HDR_FMT));
      100    13480        /*
      101    13481                       formats and vectors for boot display
      102    13482        */
      103    13483    1   DCL NHNDLR_FMT CHAR(0) CONSTANT INIT('Number of Handlers = %D%10P');
      104    13484    1   DCL NHNDLR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(NHNDLR_FMT));
      105    13485    1   DCL HNDLR_FMT CHAR(0) CONSTANT INIT('%5-%3D%4X%8A%2X%3A%3X%A%10P');
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:5    
      106    13486    1   DCL HNDLR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(HNDLR_FMT));
      107    13487    1   DCL PSEUDO_FMT CHAR(0) CONSTANT INIT('%8A%10P');
      108    13488    1   DCL PSEUDO_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(PSEUDO_FMT));
      109    13489        /*
      110    13490                        formats and vectors for param displays
      111    13491        */
      112    13492    1   DCL PARAM_FMT CHAR(0) CONSTANT INIT('%T %15- %2P%D%10P');
      113    13493    1   DCL PARAM_USRPRM_FMT CHAR(0) CONSTANT INIT('%T %2X (%2P%D%3P) %25- %D %10P');
      114    13494    1   DCL PARAM_CHAR_FMT CHAR(0) CONSTANT INIT('%T %15- %2P%A%10P');
      115    13495    1   DCL PARAM_HEX_FMT CHAR(0) CONSTANT INIT('%T %15- %2P%H%10P');
      116    13496    1   DCL USRPARM_HDR_FMT CHAR(0) CONSTANT INIT('%/%T%1.1=%8(%7X%.1#KD%1:1#+.1=%)%2Q');
      117    13497    1   DCL CURRENT_FMT CHAR(0) CONSTANT INIT('%\CURRENT%2Q');
      118    13498    1   DCL USRPARM_ENTRY_FMT CHAR(0) CONSTANT INIT('%\%N.1=%3X%5.16@D%1#:7?[%/%]%2Q');
      119    13499    1   DCL USRPARM_NETCON_FMT CHAR(0) CONSTANT INIT(':NETCON %2.18NP%8(%3X%5.18D%)%2Q');
      120    13500    1   DCL BLOCK_HDR_FMT CHAR(0) CONSTANT INIT (
             13500            '%/%T%10-%.18D%2S%2X%.18D%2S%13(%X%.18D%2S%)%X19.2%2Q');
      121    13501    1   DCL BLOCK_ENTRY_FMT CHAR(0) CONSTANT INIT(
             13501            '%\%N.1=%1#:8?.:1-[ %3.16@D%? %4.16@D%]%1#:15?[%/%]%2Q');
      122    13502    1   DCL BLOCK_NETCON_FMT CHAR(0) CONSTANT INIT(
             13502            ':NETCON%2.18NP%8( %3.18D%)%8( %4.18D%)%2Q');
      123    13503    1   DCL BLOCK_DEFAULT_FMT CHAR(0) CONSTANT INIT(
             13503            'DEFAULT%8(%14S %3.18D%)%8(%14S %4.18D%)%2Q');
      124    13504        /*
      125    13505                          format and vectors for network display
      126    13506        */
      127    13507    1   DCL  1  NETWORK_FMT CONSTANT ALIGNED,
      128    13508    1           2 * CHAR(0) INIT ('%1N.0=%2P%N.1=%.7C                    %C'),
      129    13509    1           2 * CHAR(0) INIT('%0#.1[Node#%7-Name%19-Type%26-Host%35-Route%44-Links%/%]')
             13509                    ,
      130    13510    1           2 * CHAR(0) INIT('%3.1#KD'),
      131    13511    1           2 * CHAR(0) INIT('%7-%5:1#*.2=%3.2:2#+P%8A'),
      132    13512    1           2 * CHAR(0) INIT('%19-%4.1:2#+P%N.3=%5.3#P%4A'),
      133    13513    1           2 * CHAR(0) INIT('%26-%3.4:2#+P%8A'),
      134    13514    1           2 * CHAR(0) INIT(
             13514                    '%35-%6P%N.4=%4#:1#-.0[Local%?%3#.3[  %?%4#.0[None%?%3.4#KD%]%]%]'),
      135    13515    1           2 * CHAR(0) INIT('%44-%7P%N.5=%5#(.%4.18LY   %)'),
      136    13516    1           2 * CHAR(0) INIT('%/%2Q');
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:6    
      137    13517    1   DCL NETWORK_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(NETWORK_FMT));
      138    13518    1   DCL PSEUDOHDR_FMT CHAR(0) CONSTANT INIT('Currently defined Pseudos:%10P');
      139    13519    1   DCL PSEUDOHDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(PSEUDOHDR_FMT));
      140    13520    1   DCL BOOTHDR_FMT CHAR(0) CONSTANT INIT('%/Boot Information for Node %8A%10P');
      141    13521    1   DCL HNDLRHDR_FMT CHAR(0) CONSTANT INIT('%/%5-user#  name      boot  fid %10P');
      142    13522    1   DCL LIBACCT_FMT CHAR(0) CONSTANT INIT('Library account = %8A%10P');
      143    13523    1   DCL LIBACCT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LIBACCT_FMT));
      144    13524        /*
      145    13525        Format and related format definition for link display
      146    13526        */
      147    13527    1   DCL LINK_FMT CHAR(0) CONSTANT INIT('%/Link information for node %8A%10P');
      148    13528    1   DCL LINK_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LINK_FMT));
      149    13529    1   DCL LINKCHAN_FMT CHAR(0) CONSTANT INIT('%5X Number of links = %D%10P');
      150    13530    1   DCL LINKCHAN_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LINKCHAN_FMT));
      151    13531    1   DCL HNDLRHDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(HNDLRHDR_FMT));
      152    13532    1   DCL BOOTHDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(BOOTHDR_FMT));
      153    13533    1   DCL CHAN_FMT CHAR(0) CONSTANT INIT('%8X Link# %D = .%LY%10P');
      154    13534    1   DCL CHAN_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CHAN_FMT));
      155    13535        /*
      156    13536                      formats and vectors for default and config displays
      157    13537        */
      158    13538    1   DCL DIHNDLR_FMT CHAR(0) CONSTANT INIT(
             13538            '%/Default Configuration information for Handler %>A on Node# %LD (%>A%10P)');
      159    13539    1   DCL LNCNFG_FMT CHAR(0) CALIGNED CONSTANT INIT(
             13539          '%/Line Configuration for Node# %LD (%>A) Channel# .%LH-%D-%D Terminal id %>A%10P'
             13539            );
      160    13540    1   DCL DIHNDLR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(DIHNDLR_FMT));
      161    13541    1   DCL LNCNFG_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNCNFG_FMT));
      162    13542        /*
      163    13543                format table for config display.
      164    13544        */
      165    13545    1   DCL 1 CONFIG_FMT CONSTANT ALIGNED,
      166    13546    1        2 * CHAR(0) INIT('%N.0=%.26-        '),
      167    13547    1        2 * CHAR(0) INIT(
             13547         '%.7C%-%:10-X%2N:6=.1[%:1-X%0#.1[%10#:1+.11#.12#.13#P%2N.6=(%3C)%?(   )%]%?%3C%]%C'
             13547                 ),
      168    13548    1        2 * CHAR(0) INIT('%.3C%6#.2[Yes%? No%]%C'),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:7    
      169    13549    1        2 * CHAR(0) INIT('%.5C%-%:12-X%5.16@D%C'),
      170    13550    1     2 * CHAR(0) INIT('%.4C%-%:12-X%16+@N.:1-[%:1-X%0#.1[%10#:1+.11#.12#.13#P%16+@N.9=%
             13550        22C%?  (   )%]%?%10#.11#.12#.13#P%5C%]%C'),
      171    13551    1        2 * CHAR(0) INIT(
             13551        '%.22C%-%:13-X%9#:1000?.:1-[  (%3.9#KD)%?%9#:10000?.:1-[ (%4.9#KD)%?(%5.9#KD)%]%]%C'
             13551                 ),
      172    13552    1     2 * CHAR(0) INIT(
             13552         '%.35C%34#.0.2.5P%2N.2[%-%:11-X%34#.2[Auto%?:%:2-X(Auto)%]%?%34#.4P%16+@N:29=.:1-['
             13552              ),
      173    13553    1     2 * CHAR(0) INIT('%0#.1[%3.34=%35C%?%-%:11-X(   )%]%?%4.29#P%34#.2[%-%:12-X%5.18D%
             13553        ?%18N.9=%22C%]%]%]%C'),
      174    13554    1        2 * CHAR(0) INIT('%/Logon:%-%:12-X%2.4.2.5P%2N.2[%2.10.2P%T%?None%]%/'),
      175    13555    1        2 * CHAR(0) INIT('Profile:%-%:12-X%2.4.3.5P%2N.2[%2.7.2P%T%?%:1-X'),
      176    13556    1        2 * CHAR(0) INIT(
             13556                 '%0#.1[%3.4.3.5P%2N.2[%3.7.2P(%T)%?(None)%]%?%0#.2[ None%?(    )%]%]%]'),
      177    13557    1     2 * CHAR(0) INIT('%0#.1[%-%-%:1-X%5P(With %>A defaults)%]%2/'),
      178    13558    1        2 * CHAR(0) INIT('%RAttribute:%-%:12-X%2.4.3.2P%1N.1[%2.5.2P.%4.16@ZH%?%:1-X'),
      179    13559    1    2 *CHAR(0) INIT(
             13559         '%0#.1[%3.4.3.2P%1N.1[%3.5.2P(.%4.16@ZH)%? (None)%]%?%0#.2[  None%?  (   )%]%]%]%-'
             13559             ),
      180    13560    1        2 * CHAR(0) INIT('%RBlock:%2:10=.3:11=.0:12=.0:13=P%4C%-'),
      181    13561    1        2 * CHAR(0) INIT('%RBreak Req:%2:10=.0:11=.0:12=.7:13=P%7C%-'),
      182    13562    1        2 * CHAR(0) INIT('%RBuffer size:%2:10=.1:11=.0:12=.0:13=P%4C%-'),
      183    13563    1     2 * CHAR(0) INIT('%RClock:%2:10=.0:11=.1:12=.5:13=P%7C%-'),
      184    13564    1     2 * CHAR(0) INIT('%RDebug:%2:10=.0:11=.2:12=.1:13=P%7C%-'),
      185    13565    1     2 * CHAR(0) INIT('%RDsb hst dwn:%2:10=.0:11=.3:12=.1:13=P%7C%-'),
      186    13566    1     2 * CHAR(0) INIT('%RDrop DTR:%2:10=.0:11=.1:12=.7:13=P%7C%-'),
      187    13567    1     2 * CHAR(0) INIT('%REcho Logon:%2:10=.4:11=.2:12=.3:13=P%7C%-'),
      188    13568    1     2 * CHAR(0) INIT('%REnable:%2:10=.0:11=.2:12=.7:13=P%7C%-'),
      189    13569    1     2 * CHAR(0) INIT('%RFlow cntrl:%2:10=.0:11=.0:12=.1:13=P%7C%-'),
      190    13570    1     2 * CHAR(0) INIT('%RHard wired:%2:10=.0:11=.1:12=.3:13=P%7C%-'),
      191    13571    1     2 * CHAR(0) INIT('%RInput:%2:10=.0:11=.0:12=.3:13=P%7C%-'),
      192    13572    1     2 * CHAR(0) INIT('%RKill hst dwn:%2:10=.0:11=.3:12=.3:13=P%7C%-'),
      193    13573    1     2 * CHAR(0) INIT('%RLgn timeout:%2:10=.5:11=.0:12=.0:13=P%4C%-'),
      194    13574    1     2 * CHAR(0) INIT('%ROutput:%2:10=.0:11=.0:12=.5:13=P%7C%-'),
      195    13575    1     2 * CHAR(0) INIT('%RReadtimeout:%2:10=.2:11=.0:12=.0:13=P%4C%-'),
      196    13576    1     2 * CHAR(0) INIT('%RRe-enable:%2:10=.0:11=.1:12=.1:13=P%7C%-'),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:8    
      197    13577    1     2 * CHAR(0) INIT('%RResource:%-%:9-X%2.4.3.1P%1N.1[%2.6.0P%2A%?%:1-X'),
      198    13578    1    2 *CHAR(0) INIT(
             13578          '%0#.1[%3.4.3.1P%1N.1[%3.6.0P(%2A)%?%:2-X(None)%]%?%:1-X%0#.2[None%?(   )%]%]%]%-'
             13578             ),
      199    13579    1     2 * CHAR(0) INIT('%RSend Sal:%2:10=.4:11=.2:12=.1:13=P%7C%-'),
      200    13580    1     2 * CHAR(0) INIT('%RSpeed:%2.34=%35C%-'),
      201    13581    1     2 * CHAR(0) INIT('%RTP timeout:%2:10=.2:11=.2:12=.0:13=P%4C%-'),
      202    13582    1     2 * CHAR(0) INIT('%RUnblock:%2:10=.3:11=.2:12=.0:13=P%4C%-'),
      203    13583    1    2 * CHAR(0) INIT('%2Q');
      204    13584
      205    13585        /*
      206    13586                   format table for channel table display
      207    13587        */
      208    13588    1   DCL 1 CHNFMT CONSTANT,
      209    13589    1         2 * CHAR(0) INIT('%!'),
      210    13590    1         2 * CHAR(0) INIT(
             13590                  'Termid:  .%H-%D-%D%26-Lev: %D%34-Ttyp: %4>A%51-Trm name: %8>A%2/'),
      211    13591    1         2 * CHAR(0) INIT('Attributes:  .%4ZH%26-'),
      212    13592    1         2 * CHAR(0) INIT('Echo Logon:   %4A%51-'),
      213    13593    1         2 * CHAR(0) INIT('Logon Failed: %4A%/'),
      214    13594    1         2 * CHAR(0) INIT('Autobaud:     %4A%26-'),
      215    13595    1         2 * CHAR(0) INIT('Enable:       %4A%51-'),
      216    13596    1         2 * CHAR(0) INIT('Ntwk flw ctr: %4A%/'),
      217    13597    1         2 * CHAR(0) INIT('Autologon:    %4A%26-'),
      218    13598    1         2 * CHAR(0) INIT('Enb hst up:   %4A%51-'),
      219    13599    1         2 * CHAR(0) INIT('Otp ccb cnt:  %4D%/'),
      220    13600    1         2 * CHAR(0) INIT('Block:       %5D%26-'),
      221    13601    1         2 * CHAR(0) INIT('Ext Dev Id:  .%4ZH%51-'),
      222    13602    1         2 * CHAR(0) INIT('Otp stt vld:  %4A%/'),
      223    13603    1         2 * CHAR(0) INIT('Break Requird:%4A%26-'),
      224    13604    1         2 * CHAR(0) INIT('First Device: %4A%51-'),
      225    13605    1         2 * CHAR(0) INIT('Output:       %4A%/'),
      226    13606    1         2 * CHAR(0) INIT('Bug:          %4A%26-'),
      227    13607    1         2 * CHAR(0) INIT('Hand$       .%5ZH%51-'),
      228    13608    1         2 * CHAR(0) INIT('Profile:      %4A%/'),
      229    13609    1         2 * CHAR(0) INIT('CCP loaded:   %4ZB%26-'),
      230    13610    1         2 * CHAR(0) INIT('Inp bfr sz:   %4D%51-'),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:9    
      231    13611    1         2 * CHAR(0) INIT('Re-enable:    %4A%/'),
      232    13612    1         2 * CHAR(0) INIT('Clock:        %4A%26-'),
      233    13613    1         2 * CHAR(0) INIT('Inp ccb cnt:  %4D%51-'),
      234    13614    1         2 * CHAR(0) INIT('Read Timeout: %4D%/'),
      235    13615    1         2 * CHAR(0) INIT('Context:    .%5ZH%26-'),
      236    13616    1         2 * CHAR(0) INIT('Inp stt vld:  %4A%51-'),
      237    13617    1         2 * CHAR(0) INIT('Remote Host:  %4A%/'),
      238    13618    1         2 * CHAR(0) INIT('Dead:         %4A%26-'),
      239    13619    1         2 * CHAR(0) INIT('Input:        %4A%51-'),
      240    13620    1         2 * CHAR(0) INIT('Resource:     %4A%/'),
      241    13621    1         2 * CHAR(0) INIT('Debug:        %4A%26-'),
      242    13622    1         2 * CHAR(0) INIT('Int count: %7D%51-'),
      243    13623    1         2 * CHAR(0) INIT('Send sal:     %4A%/'),
      244    13624    1         2 * CHAR(0) INIT('Device Id:   .%4ZH%26-'),
      245    13625    1         2 * CHAR(0) INIT('Kll hst dn:   %4A%51-'),
      246    13626    1         2 * CHAR(0) INIT('State:        %4A%/'),
      247    13627    1         2 * CHAR(0) INIT('Direct cnnct: %4A%26-'),
      248    13628    1         2 * CHAR(0) INIT('Lct55:         .%2ZH%51-'),
      249    13629    1         2 * CHAR(0) INIT('Sub$:       .%5ZH%/'),
      250    13630    1         2 * CHAR(0) INIT('Dnld ccp:     %4A%26-'),
      251    13631    1         2 * CHAR(0) INIT('Lgn Timeout:  %4D%51-'),
      252    13632    1         2 * CHAR(0) INIT('Sysid         %4D%/'),
      253    13633    1         2 * CHAR(0) INIT('Drop DTR:     %4A%26-'),
      254    13634    1         2 * CHAR(0) INIT('Line Speed:  %5D%51-'),
      255    13635    1         2 * CHAR(0) INIT('TP Timeout:   %4D%/'),
      256    13636    1         2 * CHAR(0) INIT('Dsb hst dn:   %4A%26-'),
      257    13637    1         2 * CHAR(0) INIT('Lnk$:       .%5ZH%51-'),
      258    13638    1         2 * CHAR(0) INIT('Unblock:     %5D%2/%10P');
      259    13639
      260    13640    1   DCL LINESPEED(0:15) UBIN HALF CONSTANT INIT(50,75,110,134,150,200,300,600,1050,
      261    13641    1                                               1200,1800,2000,2400,4800,9600,19200);
      262    13642
      263    13643        %SET STTNDX=0;
      264    13644        %MACRO NXTSTT (STT=0, TXT=, LAST(YES=");",NO=",")=",");
      265    13645        %ERROR (STT~=STTNDX,'*** State table out of order');
      266    13646           %TEXTCHAR(TXT)LAST
      267    13647        %SET STTNDX=STTNDX+1;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:10   
      268    13648        %MEND;
      269    13649
      270    13650    1   DCL STATE(0:%KH#CHN_STT_HI) CONSTANT CHAR(4) INIT(
      271    13651        %NXTSTT (STT=KH#CHN_STT_UN_INT, TXT=Uint);
      272    13656        %NXTSTT (STT=KH#CHN_STT_BSY, TXT=Busy);
      273    13661        %NXTSTT (STT=KH#CHN_STT_BSYDSBPND, TXT=BDsb);
      274    13666        %NXTSTT (STT=KH#CHN_STT_BSYPRTPND, TXT=BPrt);
      275    13671        %NXTSTT (STT=KH#CHN_STT_DSB, TXT=Dsab);
      276    13676        %NXTSTT (STT=KH#CHN_STT_ENB, TXT=Enab);
      277    13681        %NXTSTT (STT=KH#CHN_STT_PRT, TXT=Part);
      278    13686        %NXTSTT (STT=KH#CHN_STT_LINPROPND_ENB, TXT=ProE);
      279    13691        %NXTSTT (STT=KH#CHN_STT_LINPROPND_BSY, TXT=ProB);
      280    13696        %NXTSTT (STT=KH#CHN_STT_LINPROPND_BSYDSBPND, TXT=PrBD);
      281    13701        %NXTSTT (STT=KH#CHN_STT_NTRDY, TXT=Nrdy);
      282    13706        %NXTSTT (STT=KH#CHN_STT_DIAG, TXT=Diag);
      283    13711        %NXTSTT (STT=KH#CHN_STT_RMTDBG, TXT=Rdbg, LAST=YES);
      284    13716        %SET NXTTYP=0;
      285    13717        %MACRO NXTTXT(TYP=0,TXT=,LAST(YES=");")=",");
      286    13718        %ERROR(TYP~=NXTTYP,'*** Table out of order');
      287    13719        %TEXTCHAR(TXT)LAST
      288    13720        %SET NXTTYP=NXTTYP+1;
      289    13721        %MEND;
      290    13722    1   DCL DB_CHNTBL_TTYPS(0:10) CONSTANT SYMDEF CHAR(4) INIT(
      291    13723        %NXTTXT(TYP=KLTY_PROG#,TXT=PROG);
      292    13728        %NXTTXT(TYP=KLTY_SDEV#,TXT=SDEV);
      293    13733        %NXTTXT(TYP=KLTY_TTY#,TXT=TTY);
      294    13738        %NXTTXT(TYP=KLTY_STRM#,TXT=STRM);
      295    13743        %NXTTXT(TYP=KLTY_LINK#,TXT=LINK);
      296    13748        %NXTTXT(TYP=KLTY_FEP#,TXT=FEP);
      297    13753        %NXTTXT(TYP=KLTY_URP#,TXT=URP);
      298    13758        %NXTTXT(TYP=KLTY_3270#,TXT=3270);
      299    13763        %NXTTXT(TYP=KLTY_VIRCIR#,TXT=VIRC);
      300    13768        %NXTTXT(TYP=KLTY_CONT#,TXT=CONT);
      301    13773        %NXTTXT(TYP=KLTY_LINEDEV#,TXT=LNDV,LAST=YES);
      302    13778        /**/
      303    13779        %KS$BOX(TITLE="static variables",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:11   
             13797    1   /***************************************************************************
             13798    1    *                                                                         *
             13799    1    *                              static variables                           *
             13800    1    *                                                                         *
             13801    1    ***************************************************************************/

      304    13806    1   DCL FIRST BIT(1) STATIC INIT('0'B);
      305    13807    1   DCL KS_DISP_RNG BIT(1) STATIC INIT('0'B);
      306    13808    1   DCL HNDLR_INDX_SV UBIN BYTE STATIC INIT(0);
      307    13809    1   DCL CNFG$ PTR STATIC INIT(ADDR(CNFG_BUFFER));
      308    13810    1   DCL CNFG_BUFFER(0:49) UBIN WORD STATIC INIT(0*0);
      309    13811    1   DCL DEF_BUFFER(0:49) UBIN WORD STATIC INIT(0*0);
      310    13812    1   DCL CHAR_BUF(0:400) CHAR(1) STATIC;
      311    13813    1   DCL HANDLER$ PTR STATIC INIT(ADDR(CHAR_BUF));
      312    13814        %KL_ADMIN(FPTN=KS_ADMIN,LAST=",",STCLASS=STATIC);
      313    13974                 %KH$CHN(NAME=KS_CHN,LVL = 2);
      314    14098        %KL$CONFIG_KEY(NAME=KS$CONFIG_KEY,STCLASS=STATIC);
      315    14145        %KL$DEFAULT_KEY(NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
      316    14164        %KL_CONTROL (FPTN=KS_CONTROL,STCLASS=STATIC);
      317    14300        %KL$PSEUDO (NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
      318    14344        %KL$PSEUDO_KEY (NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
      319    14362        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_HNDLRPARM_HI,STCLASS=STATIC);
      320    14425        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
      321    14444        %KL$FEPBOOT (NAME=KS_FEPBOOT,NUM=GI_BOOT_HI,STCLASS=STATIC);
      322    14469        %KL$FEPBOOT_KEY (NAME=KS_FEPBOOT_KEY,STCLASS=STATIC);
      323    14487        %KL$FEPCTL (NAME=KS_FEPCTL,NUM=GI_CNTL_DISPHI,STCLASS=STATIC);
      324    14507        %KL$FEPCTL_KEY (NAME=KS_FEPCTL_KEY,STCLASS=STATIC);
      325    14525        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
      326    14555        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=STATIC);
      327    14582        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
      328    14599    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
      329    14600    1        2  CNT UBIN BYTE UNAL INIT(1),
      330    14601    1       2  TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
      331    14602        %KL$NETWORK (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
      332    14629        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
      333    14647        /*
      334    14648                Setup the links macro and the macro to define the key.
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:12   
      335    14649        */
      336    14650        %KL$LINK_KEY(NAME=KS_LINK_KEY,STCLASS=STATIC);
      337    14668    1   DCL HEX_DIGITS CHAR(0) STATIC INIT('0123456789ABCDEF');
      338    14669    1   DCL BLK_VEC BIT(72) STATIC DALIGNED INIT(VECTOR(BLK_FMT));
      339    14670    1   DCL PARAM_HEX_VEC VECTOR STATIC DALIGNED INIT(VECTOR(PARAM_HEX_FMT));
      340    14671    1   DCL PARAM_CHAR_VEC VECTOR STATIC DALIGNED INIT(VECTOR(PARAM_CHAR_FMT));
      341    14672    1   DCL PARAM_VEC BIT(72) STATIC DALIGNED INIT(VECTOR(PARAM_FMT));
      342    14673
      343    14674    1   DCL UNKNOWN CHAR(0) STATIC INIT('           ');
      344    14675        %KS$BOX(TITLE="based variables",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:13   
             14693    1   /***************************************************************************
             14694    1    *                                                                         *
             14695    1    *                              based variables                            *
             14696    1    *                                                                         *
             14697    1    ***************************************************************************/

      345    14702        %B$TCB;
      346    14705        %B$ALT;
      347    14713    1   DCL B$PARAM(0:0) UBIN HALF BASED HALIGNED;
      348    14714        %KL$HNDLR (NAME=KS$HNDLR,NUM=KL_FIXED_HI,STCLASS="BASED(HANDLER$)");
      349    14777        %KL$LINCNFG(NAME=KS_CNFG_BUF,STCLASS="BASED(CNFG$)");
      350    14935        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      351    14980        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      352    15018        %KS$PARAM (NAME=KS$PARAM,LVL=1,STCLASS="(0:0) BASED",LAST=";");
      353    15088        %KL_ADMIN(FPTN=ADMIN,LAST=",",STCLASS="BASED(KS_MSGBUF$)");
      354    15248                  %KH$CHN(NAME=KS_CHN,LVL=2);
      355    15372        %KL_CONTROL(FPTN=CONTROL,STCLASS="BASED(KS_MSGBUF$)");
      356    15508    1         DCL   1  HND   BASED UNAL,
      357    15509    1                  2  DAT(0:18)   BIT(1)  UNAL;
      358    15510        %KS$PARAM(NAME=KS$PARAM_SPCL,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
      359    15580        %KS$BOX(TITLE="auto variables");

             15598    1   /***************************************************************************
             15599    1    *                                                                         *
             15600    1    *                               auto variables                            *
             15601    1    *                                                                         *
             15602    1    ***************************************************************************/

      360    15607        %B$TERMINAL_ID(FPTN = TERMLO, STCLASS = AUTO);
      361    15636        %B$TERMINAL_ID(FPTN = TERMHI, STCLASS = AUTO);
      362    15665        %KH$CHN(NAME=KH$CHN,LVL=1,STCLASS=AUTO);
      363    15789        %KL$CONFIG_KEY(NAME=KS_CONFIG_KEY,STCLASS=AUTO);
      364    15836    1   DCL ATTRIBUTE UBIN;
      365    15837    1   DCL KS_YES_NO CHAR(3);
      366    15838    1   DCL SPD UBIN;
      367    15839    1   DCL NODESLCT BIT(1);
      368    15840    1   DCL L UBIN;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:14   
      369    15841    1   DCL CHAN_DISP_FULL BIT(1);
      370    15842    1   DCL ONE_CHAN_FLAG BIT(1);
      371    15843    1   DCL 1 OPT(0:5),
      372    15844    1         2 P$     PTR,
      373    15845    1         2 LAST   UBIN;
      374    15846    1   DCL   HDR_FLAG  BIT(1);
      375    15847    1   DCL   OPTION_SATISFIED  BIT(1);
      376    15848    1   DCL ATTR    UBIN;
      377    15849    1   DCL FIRST_PARM  BIT(1);
      378    15850    1   DCL NO_CURRENT_VAL BIT(1) ALIGNED;
      379    15851    1   DCL IPARAM$ PTR;
      380    15852    1   DCL ONE_PARM_ONLY BIT(1);
      381    15853    1       DCL DEF_OPT UBIN;
      382    15854    1   DCL MAX_PARM UBIN;
      383    15855    1   DCL I UBIN;
      384    15856    1   DCL SBLK UBIN;
      385    15857    1   DCL J UBIN;
      386    15858    1   DCL K UBIN;
      387    15859    1   DCL PARMX UBIN;
      388    15860    1   DCL PARMTYPE UBIN;
      389    15861    1   DCL INDX UBIN;
      390    15862    1   DCL INDX_VEC(0:49) UBIN;
      391    15863    1   DCL NUM_INDX UBIN;
      392    15864    1   DCL TEMP1 UBIN;
      393    15865    1   DCL TEMP2 UBIN;
      394    15866    1   DCL VALUE UBIN;
      395    15867    1   DCL 1 VALUE_C REDEF VALUE,
      396    15868    1           2 * CHAR(2),
      397    15869    1           2 CHR CHAR(2) UNAL;
      398    15870    1   DCL ERR# UBIN;
      399    15871    1   DCL BLK$ PTR;
      400    15872    1   DCL SUBLK$ PTR;
      401    15873    1   DCL PTR$ PTR;
      402    15874    1   DCL PTR$_R REDEF PTR$ BIT(36);
      403    15875    1   DCL RES CHAR(2);
      404    15876    1   DCL NODETYPE CHAR(4);
      405    15877    1   DCL FEPNODE SBIN;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:15   
      406    15878    1   DCL FEPNAME CHAR(8);
      407    15879    1   DCL MSG$ PTR;
      408    15880    1   DCL TEMP_PERM UBIN;
      409    15881    1   DCL CONNECTION CHAR(5);
      410    15882    1   DCL BLOCK_VEC VECTOR;
      411    15883    1   DCL READ_COUNTER UBIN BYTE;
      412    15884    1   DCL KS_CHKNODE SBIN;
      413    15885        %KS$BOX(TITLE="FPTs, VLPs and such",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:16   
             15903    1   /***************************************************************************
             15904    1    *                                                                         *
             15905    1    *                            FPTs, VLPs and such                          *
             15906    1    *                                                                         *
             15907    1    ***************************************************************************/

      414    15912        %FPT_READ (FPTN=READ_NETCON,
      415    15913                   DCB=M$NETCON,
      416    15914                   KEYS=YES);
      417    15953
      418    15954        %FPT_PRECORD (FPTN = PREC_NETCON,
      419    15955                      DCB  = M$NETCON,
      420    15956                      KEYS = YES,
      421    15957                      KEYR = YES);
      422    15978
      423    15979        %FPT_NODEINFO(FPTN=KS_NODEINFO_F,
      424    15980                      NODEINFO = KS_NODEINFO_V);
      425    15992        %VLR_NODEINFO(FPTN=KS_NODEINFO_V);
      426    16007
      427    16008        %FPT_MONINFO(FPTN = KS_MONINFO_F,MONINFO = KS_MONINFO_V);
      428    16023        %VLR_MONINFO(FPTN = KS_MONINFO_V);
      429    16041
      430    16042        %FPT_READ(FPTN = READ_NETWORK,KEYS=YES,DCB = M$NETCON,
      431    16043                   KEY = KS_NETWORK_KEY,BUF = KS_NETWORK);
      432    16082        %VLP_NAME ( FPTN = NAME, STCLASS = BASED);
      433    16109        %KS$BOX(TITLE="DCBs");

             16127    1   /***************************************************************************
             16128    1    *                                                                         *
             16129    1    *                                    DCBs                                 *
             16130    1    *                                                                         *
             16131    1    ***************************************************************************/

      434    16136    1   DCL M$NETCON DCB;
      435    16137        /*
      436    16138           Now dcl some variables to help in the packing of data into
      437    16139           fep format(ie 9-8) and vice-versa (8-9)
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:17   
      438    16140        */
      439    16141    1        DCL S_R(0:17) BIT(1) BASED(S$) UNAL;
      440    16142    1        DCL S_R_W(0:35) BIT(1) BASED(S$) UNAL;
      441    16143    1        DCL S$ PTR;
      442    16144    1        DCL BINDX UBIN;
      443    16145    1        DCL D$ PTR;
      444    16146    1        DCL D_R(0:17) BIT(1) BASED(D$) UNAL;
      445    16147    1        DCL D_R_W(0:35) BIT(1) BASED(D$) UNAL;
      446    16148        %MACRO ARRAY_TO_WORD (S=JUNK,D=JUNK);
      447    16149             D$ = ADDR(D);
      448    16150             S$ = ADDR(S);
      449    16151             D = 0;
      450    16152             DO BINDX = 1 TO 8;
      451    16153                D_R(BINDX+1) = S_R(BINDX);
      452    16154             END;
      453    16155             DO BINDX = 10 TO 17;
      454    16156                D_R(BINDX) = S_R(BINDX);
      455    16157             END;
      456    16158             D = BITBIN(D_R);
      457    16159        %MEND;
      458    16160        %MACRO PACK4(S=JUNK,D=JUNK);
      459    16161             D$ = ADDR(D);
      460    16162             S$ = ADDR(S);
      461    16163             D = 0;
      462    16164             DO BINDX = 1 TO 8;
      463    16165                D_R_W(BINDX+3) = S_R_W(BINDX);
      464    16166             END;
      465    16167             DO BINDX = 10 TO 17;
      466    16168                D_R_W(BINDX+2) =  S_R_W(BINDX);
      467    16169             END;
      468    16170             DO BINDX = 19 TO 26;
      469    16171                D_R_W(BINDX+1) = S_R_W(BINDX);
      470    16172             END;
      471    16173             DO BINDX = 28 TO 35;
      472    16174                D_R_W(BINDX) = S_R_W(BINDX);
      473    16175             END;
      474    16176             D = BITBIN(D_R_W);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:18   
      475    16177        %MEND;
      476    16178        %MACRO WORD_TO_ARRAY (S=JUNK,D=JUNK);
      477    16179             D.BYT(0) = S/256;
      478    16180             D.BYT(1) = MOD(S,256);
      479    16181        %MEND;
      480    16182
      481    16183             %MACRO CHN_T_F(R=JUNK,D=JUNK);
      482    16184
      483    16185                IF KH$CHN.R THEN
      484    16186                   D = 'Yes';
      485    16187                ELSE
      486    16188                   D = 'No ';
      487    16189             %MEND;
      488    16190
      489    16191    1   DCL 1 CHNTBL ALIGNED AUTO,
      490    16192    1         2 TERMID CALIGNED,
      491    16193    1           3 CHANNEL UBIN,
      492    16194    1           3 SUBDEVICE UBIN,
      493    16195    1           3 SUBSUBDEVICE UBIN,
      494    16196    1           3 LEV UBIN,
      495    16197    1           3 TTYP CHAR(4),
      496    16198    1           3 TERM_NAME CHAR(8),
      497    16199    1         2 ATTR UBIN,
      498    16200    1         2 ECHLGN CHAR(4),
      499    16201    1         2 AUTLGNFAILED CHAR(4),
      500    16202    1         2 AUTBAD CHAR(4),
      501    16203    1         2 ENB CHAR(4),
      502    16204    1         2 DC1DC3NTWOTPFLWCTR CHAR(4),
      503    16205    1         2 AUTLGN CHAR(4),
      504    16206    1         2 ENBHSTUP CHAR(4),
      505    16207    1         2 OTPCCBCNT UBIN,
      506    16208    1         2 BLOCK UBIN,
      507    16209    1         2 EXTDVCID UBIN,
      508    16210    1         2 OTPCCBSTTPTRVLD CHAR(4),
      509    16211    1         2 BRKRQ CHAR(4),
      510    16212    1         2 CTR CHAR(4),
      511    16213    1         2 OTP CHAR(4),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:19   
      512    16214    1         2 BUG CHAR(4),
      513    16215    1         2 HAND$ PTR /*(ADDR(NIL))*/,
      514    16216    1         2 PROFILE CHAR(4),
      515    16217    1         2 CTR_DWNLD UBIN,
      516    16218    1         2 INPBFRBYTSIZ UBIN,
      517    16219    1         2 RE_ENB CHAR(4),
      518    16220    1         2 CLK CHAR(4),
      519    16221    1         2 INPCCBCNT UBIN,
      520    16222    1         2 REDTIMOUTPRD UBIN,
      521    16223    1         2 CTX$ PTR,
      522    16224    1         2 INPCCBSTTPTRVLD CHAR(4),
      523    16225    1         2 RMTHST CHAR(4),
      524    16226    1         2 DED CHAR(4),
      525    16227    1         2 INP CHAR(4),
      526    16228    1         2 RESOURCE CHAR(4),
      527    16229    1         2 DBG CHAR(4),
      528    16230    1         2 INTCNT UBIN,
      529    16231    1         2 SNDSLT CHAR(4),
      530    16232    1         2 DVCID UBIN,
      531    16233    1         2 KLLHSTDWN CHAR(4),
      532    16234    1         2 STT CHAR(4),
      533    16235    1         2 DRCCNC CHAR(4),
      534    16236    1         2 LCT55 UBIN,
      535    16237    1         2 SUB$ PTR /*(ADDR(NIL))*/,
      536    16238    1         2 DWNLOD CHAR(4),
      537    16239    1         2 LGNTIMOUTPRD UBIN,
      538    16240    1         2 SYSID UBIN,
      539    16241    1         2 DRPDTR CHAR(4),
      540    16242    1         2 LINSPD UBIN,
      541    16243    1         2 TPTIMOUTPRD UBIN,
      542    16244    1         2 DSBHSTDWN CHAR(4),
      543    16245    1         2 LNK$ PTR /*(ADDR(NIL))*/,
      544    16246    1         2 UNBLOCK UBIN;
      545    16247
      546    16248    1        DCL 1 CHNTBL_SUM ALIGNED,   /* summary channel display*/
      547    16249    1          2 CHANNEL UBIN,
      548    16250    1          2 DVCID   UBIN,
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:20   
      549    16251    1          2 EXTDVCID UBIN,
      550    16252    1          2 ATTR    UBIN,
      551    16253    1          2 CTX$      UBIN,
      552    16254    1          2 RESOURCE CHAR(2),
      553    16255    1          2 STT     CHAR(4),
      554    16256    1          2 DRCCNC  CHAR(3),
      555    16257    1          2 DRPDTR  CHAR(3),
      556    16258    1          2 DWNLOD  CHAR(3),
      557    16259    1          2 ENB     CHAR(3),
      558    16260    1          2 INP     CHAR(3),
      559    16261    1          2 OTP     CHAR(3),
      560    16262    1          2 SNDSLT  CHAR(3),
      561    16263    1          2 *       CHAR(1),  /*Space needed for formatter*/
      562    16264    1          2 INPCCBCNT UBIN,
      563    16265    1          2 OTPCCBCNT UBIN,
      564    16266    1          2 LGNTIMOUTPRD UBIN,
      565    16267    1          2 REDTIMOUTPRD UBIN;
      566    16268        /**/
      567    16269    1   DCL LAST_DI UBIN;
      568    16270    1        DCL LAST   UBIN;
      569    16271    1        DCL FIRST_SUBLK  UBIN;
      570    16272    1        DCL CHAN UBIN;
      571    16273    1        DCL CHANHI UBIN;
      572    16274    1        DCL CHANLO UBIN;
      573    16275    1        DCL SUBCODE UBIN;
      574    16276    1        DCL SUBLO UBIN;
      575    16277    1        DCL SUBHI UBIN;
      576    16278    1        DCL SUBSUBHI UBIN;
      577    16279    1        DCL SUBSUBLO UBIN;
      578    16280    1        DCL LEV UBIN;
      579    16281    1        DCL SUBDEV UBIN;
      580    16282    1        DCL SUBSUBDEV UBIN;
      581    16283    1        DCL TTEMP UBIN;
      582    16284    1        DCL HEX_CHAR CHAR(1);
      583    16285    1        DCL HEX_DIGIT UBIN;
      584    16286    1        DCL TBIT1 BIT(16);
      585    16287    1        DCL TBIT2 BIT(16);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:21   
      586    16288    1        DCL CODE UBIN;
      587    16289
      588    16290        %KS$BOX(TITLE="EQUs");

             16308    1   /***************************************************************************
             16309    1    *                                                                         *
             16310    1    *                                    EQUs                                 *
             16311    1    *                                                                         *
             16312    1    ***************************************************************************/

      589    16317        %EQU FROM_NETCON = 1;
      590    16318        %EQU FROM_FEP = 2;
      591    16319        %EQU CHANTBL_REQST_SIZE = 16;
      592    16320    1   DCL FORM UBIN HALF;
      593    16321    1   DCL SUBLK_INDX UBIN BYTE;
      594    16322        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:22   
      595    16323    1         READ_NETCON.V.KEYS# = '1'B;
      596    16324    1         READ_NETCON.V.KEYR# = '0'B;
      597    16325    1       LAST_DI = 0;
      598    16326    2        DO I = 0 TO OUT$BLK.NSUBLKS - 1;
      599    16327    2           BLK$ = OUT$BLK.SUBLK$(I);
      600    16328    3           DO CASE(BLK$->OUT$BLK.CODE);
      601    16329    3              CASE(%KS_BOOTINFO);
      602    16330    3               IF BLK$->OUT$BLK.NSUBLKS ~= 0 THEN
      603    16331    4                  DO;
      604    16332    4                     CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));
      605    16333    4                     KS_NODE_SV = KS_NODE;
      606    16334    4                     KS_NODENAME_SV = KS_NODENAME;
      607    16335    4                     KS_NODE = FEPNODE;
      608    16336    4                     KS_NODENAME = FEPNAME;
      609    16337    4                  END;
      610    16338    4                 IF KS_NODENAME = 'HOST' THEN DO;
      611    16339    4                    CALL KSE$ERRMSG(%E$KS_NONODE);
      612    16340    4                    RETURN;
      613    16341    4                    END;  /* IF KS_NODENAME = 'HOST' */
      614    16342    3                 KS_FEPBOOT_KEY.NODE = KS_NODE;
      615    16343    3                 KS_FEPHNDLR_KEY.NODE = KS_NODE;
      616    16344    3                 KS_HANDLER_KEY.NODE = KS_NODE;
      617    16345    3                 KS_SUB_BUF_1.COUNT = SIZEC('BOOTINFO');
      618    16346    3                 KS_SUB_BUF_1.TEXT = 'BOOTINFO';
      619    16347    3                 CALL KSW$WRITE(BOOTHDR_VEC,VECTOR(KS_NODENAME));
      620    16348    3                 READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
      621    16349    3                 READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);
      622    16350    3                 CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);
      623    16351
      624    16352    3                 READ_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);
      625    16353    3                 READ_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);
      626    16354    3                 CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);
      627    16355    3                 CALL KSW$WRITE(BOOTFID_VEC,VECTOR(KS_FEPBOOT.BOOTFID),
      628    16356    3                                VECTOR(KS_FEPHNDLR.DEFLIBACCT));
      629    16357    3                 READ_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
      630    16358    3                 HANDLER$ = ADDR(CHAR_BUF);
      631    16359    3                 READ_NETCON.BUF_ = VECTOR(CHAR_BUF);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:23   
      632    16360    3                 CALL KSW$WRITE(HNDLRHDR_VEC);
      633    16361    4                 DO J = 1 TO KS_FEPHNDLR.NHANDLERS;
      634    16362    4                    KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J-1);
      635    16363    4                    CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);
      636    16364    4                    IF KS_FEPHNDLR.BOOTIME(J-1) THEN
      637    16365    4                       KS_YES_NO = 'Yes';
      638    16366    4                    ELSE
      639    16367    4                       KS_YES_NO = 'No';
      640    16368    4                    CALL KSW$WRITE(HNDLR_VEC,VECTOR(J),VECTOR(KS$HNDLR.HNDLRNAME),
             16368                             VECTOR(KS_YES_NO),VECTOR(KS$HNDLR.HNDLRFID));
      641    16369    4                    END;  /* DO J */
      642    16370
      643    16371
      644    16372        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:24   
      645    16373    3              CASE(%KS_NET_STATUS);
      646    16374    3                 READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
      647    16375    3                 READ_NETCON.BUF_ = VECTOR(KS_NETWORK);
      648    16376    3                 CALL M$READ(READ_NETCON) WHENALTRETURN
      649    16377    4                    DO;
      650    16378    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY THEN
      651    16379    4                       GOTO DISP_ERR;
      652    16380    4                    KS_NETWORK = '0'B;
      653    16381    4                    END;
      654    16382    3                 IF KS_NETWORK.NODE# = 0 THEN
      655    16383    4                    DO;
      656    16384    4                    CALL KSE$ERRMSG(%E$KS_NO_NETWORK);
      657    16385    4                    END;
      658    16386    3                 ELSE
      659    16387    4                    DO;
      660    16388    4                    FIRST_SUBLK = 0;
      661    16389    4                    IF BLK$->OUT$BLK.NSUBLKS = 0 THEN
      662    16390    5                       DO;
      663    16391    5                       FORM = %KS_STAT_SHORT;
      664    16392    5                       NODESLCT = '0'B;
      665    16393    5                       END;
      666    16394    4                    ELSE
      667    16395    5                       DO;
      668    16396    5                       IF BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_STAT_LONG OR
      669    16397    5                          BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_STAT_SHORT THEN
      670    16398    6                          DO;
      671    16399    6                          FORM = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
      672    16400    6                          IF BLK$->OUT$BLK.NSUBLKS > 1 THEN
      673    16401    7                             DO;
      674    16402    7                             NODESLCT = '1'B;
      675    16403    7                             SUBLK$ = BLK$;
      676    16404    7                             LAST = BLK$->OUT$BLK.NSUBLKS - 1;
      677    16405    7                             FIRST_SUBLK = 1;
      678    16406    7                             END;  /* nsublks > 1 */
      679    16407    6                          ELSE
      680    16408    6                             NODESLCT = '0'B;
      681    16409    6                          END;  /* is there a form specified in the nodes */
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:25   
      682    16410    5                       ELSE
      683    16411    6                          DO;
      684    16412    6                          FORM = %KS_STAT_SHORT;
      685    16413    6                          NODESLCT = '1'B;
      686    16414    6                          SUBLK$ = BLK$;
      687    16415    6                          LAST = BLK$->OUT$BLK.NSUBLKS - 1;
      688    16416    6                          END;
      689    16417    5                       END;  /* what form do we use? */
      690    16418    4                    CALL M$MONINFO(KS_MONINFO_F) ALTRET(DISP_ERR);
      691    16419    4                    IF NOT NODESLCT THEN
      692    16420    4                       LAST = KS_MONINFO_V.NUM_NODES;
      693    16421    4                    IF FORM ~= %KS_STAT_SHORT THEN
      694    16422    4                       CALL KSW$WRITE(NET_STAT_VEC,VECTOR(KS_NETSTAT));
      695    16423    5                    DO L = FIRST_SUBLK TO LAST;
      696    16424    5                       IF NODESLCT THEN
      697    16425    6                          DO;
      698    16426    6                          CALL GET_NODE(SUBLK$->OUT$BLK.SUBLK$(L));
      699    16427    6                          J = FEPNODE;
      700    16428    6                          IF FEPNODE > KS_MONINFO_V.NUM_NODES OR
      701    16429    6                             FEPNODE = -1 THEN   /* if node is not defined */
      702    16430    7                             DO;
      703    16431    7                             CALL KSE$ERRMSG(%E$KS_BADNUM);
      704    16432    7                             GOTO STAT_END_LOOP;
      705    16433    7                             END;
      706    16434    6                          END; /* nodeslct  */
      707    16435    5                       ELSE
      708    16436    5                          J = L;
      709    16437    5                       KS_NODEINFO_F.V.NODENUM# = J;
      710    16438    5                       NODETYPE = TEXT_NODETYPE(KS_NETWORK.NODE.TYPE(J));
      711    16439    5                       IF NODETYPE = ' ' AND NODESLCT THEN
      712    16440    6                          DO; /* nodetype = ' ' */
      713    16441    6                          CALL KSE$ERRMSG(%E$KS_BADNUM);
      714    16442    6                          GOTO STAT_END_LOOP;
      715    16443    6                          END; /* if nodetype = ' '  */
      716    16444    5                       IF NODETYPE ~= ' ' THEN
      717    16445    6       THE_BIG_DO:        DO;
      718    16446    6                          CALL M$NODEINFO(KS_NODEINFO_F) ALTRET(DISP_ERR);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:26   
      719    16447    6                          IF FORM = %KS_STAT_SHORT THEN
      720    16448    7                             DO;
      721    16449    7                             IF KS_NODEINFO_V.ACTIVE# THEN
      722    16450    7                                UNKNOWN = 'is running';
      723    16451    7                             ELSE
      724    16452    7                                UNKNOWN = 'is disabled';
      725    16453    7                             CALL KSW$WRITE(SHORT_LINE_VEC,VECTOR(J),VECTOR(KS_NETWORK.
             16453                                      NODE.NODE(J)),VECTOR(UNKNOWN));
      726    16454    7                             EXIT THE_BIG_DO;
      727    16455    7                             END;  /* end processing of short form */
      728    16456    6                          CALL KSW$WRITE(NODE_VEC,VECTOR(J),VECTOR(KS_NETWORK.NODE.NODE
             16456                                   (J)));
      729    16457
      730    16458    6                          IF KS_NODEINFO_V.HOST# THEN
      731    16459    6                             KS_YES_NO = 'Yes';
      732    16460    6                          ELSE
      733    16461    6                             KS_YES_NO = 'No ';
      734    16462    6                          CALL KSW$WRITE(HST_VEC,VECTOR(KS_YES_NO));
      735    16463
      736    16464    6                          IF KS_NODEINFO_V.ACTIVE# THEN
      737    16465    6                             KS_YES_NO = 'Yes';
      738    16466    6                          ELSE
      739    16467    6                             KS_YES_NO = 'No ';
      740    16468    6                          CALL KSW$WRITE(ACTV_VEC,VECTOR(KS_YES_NO));
      741    16469    6                          IF KS_NODEINFO_V.CURRENTNODE# THEN
      742    16470    6                             KS_YES_NO = 'Yes';
      743    16471    6                          ELSE
      744    16472    6                             KS_YES_NO = 'No ';
      745    16473    6                          CALL KSW$WRITE(CN_VEC,VECTOR(KS_YES_NO));
      746    16474
      747    16475    6                          CALL KSW$WRITE(QOS_VEC,VECTOR(KS_NODEINFO_V.QOS#));
      748    16476    6                          CALL KSW$WRITE(ALT_VEC,VECTOR(KS_NODEINFO_V.ALTQOS#));
      749    16477    6                          CALL KSW$WRITE(LNKNME_VEC,VECTOR(KS_NODEINFO_V.LINKNODENAME#)
             16477                                   );
      750    16478    6                          CALL KSW$WRITE(LNKNUM_VEC,VECTOR(KS_NODEINFO_V.LINKNODENUM#))
             16478                                   ;
      751    16479    6                          IF KS_NODEINFO_V.LINKCONNECTED# THEN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:27   
      752    16480    6                             KS_YES_NO = 'Yes';
      753    16481    6                          ELSE
      754    16482    6                             KS_YES_NO = 'No';
      755    16483    6                          CALL KSW$WRITE(LNKCNCT_VEC,VECTOR(KS_YES_NO));
      756    16484    6                          END;  /* node type not = ' ' */
      757    16485    5        STAT_END_LOOP:;
      758    16486    5                    END;    /* do loop for # of nodes */
      759    16487    4                 END;     /* else number of nodes >0  */
      760    16488
      761    16489        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:28   
      762    16490    3              CASE(%KS_PSEUDO);
      763    16491    4                 IF KS_NODENAME = 'HOST' THEN DO;
      764    16492    4                    CALL KSE$ERRMSG(%E$KS_NONODE);
      765    16493    4                    RETURN;
      766    16494    4                    END;  /* IF KS_NODENAME = 'HOST' */
      767    16495    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NODENAME);
      768    16496    3                 KS_SUB_BUF_1.TEXT = KS_NODENAME;
      769    16497    3                 KS_PSEUDO_KEY.NODE = KS_NODE;
      770    16498    3                 READ_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);
      771    16499    3                 READ_NETCON.BUF_ = VECTOR(KS_PSEUDO);
      772    16500    4                 CALL M$READ(READ_NETCON) WHENALTRETURN DO;
      773    16501    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY
      774    16502    4                       THEN GOTO PSEUDO_DISP_ERR;
      775    16503    4                    KS_PSEUDO = '0'B;
      776    16504    4                    END;  /* WHEN ALTRETURN */
      777    16505    4                 IF KS_PSEUDO.PSEUDO# = 0 THEN DO;
      778    16506    4                    CALL KSE$ERRMSG(%E$KS_NOPSEUDOS,VECTOR(KS_SUB_BUF_1));
      779    16507                         /*E* ERROR: KSN-E$KS_NOPSEUDOS-0
      780    16508                              MESSAGE: No pseudo resources defined for node %U1.
      781    16509                              DESCRIPTION: SEE MESSAGE.      */
      782    16510    4                    END;  /* IF NODE# = 0 */
      783    16511    4                 ELSE DO;
      784    16512    4                    CALL KSW$WRITE(PSEUDOHDR_VEC);
      785    16513    5                    DO J = 0 TO KS_PSEUDO.PSEUDO# - 1;
      786    16514    5                       CALL KSW$WRITE(PSEUDO_NME_VEC,
      787    16515    5                             VECTOR(KS_PSEUDO.PSEUDO.NAME(J)),
      788    16516    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_GHST(J)),
      789    16517    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_HAND(J)));
      790    16518    5                       CALL KSW$WRITE(PSEUDO_USR_VEC,
      791    16519    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_CG(J)),
      792    16520    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_USR(J)),
      793    16521    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_SYS(J)));
      794    16522
      795    16523    5                       END;  /* DO J */
      796    16524    4                    END;  /* ELSE */
      797    16525    4                 DO WHILE('0'B);
      798    16526    4   PSEUDO_DISP_ERR:;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:29   
      799    16527    4                    CALL KSE$ERRMSG(0);
      800    16528    4                    KS_SUB_BUF_1.COUNT = SIZEC('PSEUDO');
      801    16529    4                    KS_SUB_BUF_1.TEXT = 'PSEUDO';
      802    16530    4                    CALL KSE$ERRMSG(%E$KS_CANTDIPARM);
      803    16531    4                    END;  /* DO NEVER */
      804    16532        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:30   
      805    16533    3              CASE (%KS_LNCONFIG,%KS_DFLTCNFG);
      806    16534    3                 IF BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN
      807    16535    4                    DO;
      808    16536    4                    CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));
      809    16537    4                    KS_NODENAME_SV = KS_NODENAME;
      810    16538    4                    KS_NODE_SV = KS_NODE;
      811    16539    4                    KS_NODENAME = FEPNAME;
      812    16540    4                    KS_NODE = FEPNODE;
      813    16541    4                    SUBLK_INDX = 1;
      814    16542    4                    END;
      815    16543    3                 ELSE
      816    16544    3                    SUBLK_INDX = 0;
      817    16545
      818    16546    3                 READ_NETCON.V.KEYS# = '1'B;
      819    16547    3                 READ_NETCON.V.KEYR# = '0'B;
      820    16548
      821    16549    3                 IF (BLK$->OUT$BLK.CODE = %KS_DFLTCNFG) THEN
      822    16550    4                    DO;
      823    16551    4                       IF KS_NODENAME='HOST' THEN
      824    16552    5                          DO;
      825    16553    5                             CALL KSE$ERRMSG(%E$KS_NONODE);
      826    16554    5                             RETURN;
      827    16555    5                          END;
      828    16556    4                 KS_SUB_BUF_1.COUNT = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$SYM.COUNT;
      829    16557    4                 KS_SUB_BUF_1.TEXT  = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$SYM.TEXT;
      830    16558    4                    KS_DISP_RNG = '0'B;
      831    16559    4       DEF_OPT = 2;
      832    16560    4                    FIRST = '0'B;
      833    16561    4                    KS_DEFAULT_KEY.NODE = KS_NODE;
      834    16562    4                    KS_DEFAULT_KEY.HNDLR = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$SYM.
             16562                             TEXT;
      835    16563    4                    READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);
      836    16564    4                    READ_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
      837    16565    4                    CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);
      838    16566    4                    CALL KSW$WRITE(DIHNDLR_VEC,VECTOR(KS_DEFAULT_KEY.HNDLR),VECTOR(
             16566                             KS_NODE),VECTOR(KS_NODENAME));
      839    16567    4                    END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:31   
      840    16568    3                 ELSE
      841    16569    4       DEFTERM:     DO;
      842    16570    4                 KS_SUB_BUF_1.COUNT = SIZEC('Configuration');
      843    16571    4                 KS_SUB_BUF_1.TEXT  = 'Configuration';
      844    16572    4                 KS_CONFIG_KEY = KS$CONFIG_KEY;
      845    16573
      846    16574    4           IF SUBLK_INDX  < BLK$->OUT$BLK.NSUBLKS - 1 THEN
      847    16575    5              DO;
      848    16576    5                 DEF_OPT = 1;
      849    16577    5                 KS_DEFAULT_KEY.NODE = KS_NODE;
      850    16578    5                 KS_DEFAULT_KEY.HNDLR = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX+1)->
      851    16579    5                 OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      852    16580    5                 READ_NETCON.V.KEYS# = '1'B;
      853    16581    5                 READ_NETCON.V.KEYR# = '0'B;
      854    16582    5                 READ_NETCON.BUF_ = VECTOR(DEF_BUFFER);
      855    16583    5                 READ_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
      856    16584    5                 CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);
      857    16585    5              END;
      858    16586    4           ELSE
      859    16587    4              DEF_OPT = 0;
      860    16588
      861    16589    4                    IF BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.CODE = %KS_FULL THEN
      862    16590    5                       DO;
      863    16591    5                       KS_DISP_RNG = '1'B;
      864    16592    5                       FIRST = '1'B;
      865    16593    5                       TERMLO = '0'B;
      866    16594    5                       TERMHI = '0'B;
      867    16595    5                       TERMLO.LEV = 1;
      868    16596    5                       KS_CONFIG_KEY.TERMID = TERMLO;
      869    16597    5                       TERMHI.TERM.CHANNEL.BYT(0) = BITBIN('377'O);
      870    16598    5                       TERMHI.LEV = 1;
      871    16599    5                       KS_CONFIG_KEY.NODE = KS_NODE;
      872    16600    5                       CNFG_BUFFER = '0'B;
      873    16601    5                       READ_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);
      874    16602    5                       READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);
      875    16603    5                       END;
      876    16604    5                       ELSE DO;  /* if full not specified  */
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:32   
      877    16605    5                    CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.
             16605                             SUBLK$(0),TERMLO) WHENALTRETURN
      878    16606    6                       DO;
      879    16607    6                       IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM THEN
      880    16608    6                          GOTO DISP_ERR;
      881    16609    6                       END;  /*  altreturn on termlo   */
      882    16610    5                    IF (BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.NSUBLKS = 2) THEN
      883    16611    6                       DO;
      884    16612    6                       CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.
             16612                                SUBLK$(1),TERMHI) WHENALTRETURN
      885    16613    7                          DO;
      886    16614    7                          IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM THEN
      887    16615    7                             GOTO ERR1;
      888    16616    7                          END;  /* altreturn on termhi */
      889    16617    6                       CALL KSU$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN
      890    16618    7                             DO;
      891    16619    7                             CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);
      892    16620    7                             GOTO ERR1;
      893    16621    7                             END;
      894    16622
      895    16623    6                       KS_DISP_RNG = '1'B;
      896    16624    6                       FIRST = '1'B;
      897    16625    6                       END;
      898    16626    6                    ELSE DO;
      899    16627    6                       KS_DISP_RNG = '0'B;
      900    16628    6                       TERMHI = TERMLO;
      901    16629    6                       FIRST = '0'B;
      902    16630    6                    END;
      903    16631    5                 IF KS_NODENAME='HOST' AND TERMLO.TERM.TERM_NAME = ' ' THEN
      904    16632    6                    DO;
      905    16633    6                       CALL KSE$ERRMSG(%E$KS_NONODE);
      906    16634    6                       RETURN;
      907    16635    6                    END;
      908    16636
      909    16637    5                    CNFG_BUFFER = '0'B;
      910    16638    5                    KS_CONFIG_KEY.TERMID = TERMLO;
      911    16639
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:33   
      912    16640    5                    IF TERMLO.TERM.TERM_NAME ~= ' ' THEN
      913    16641    6                       DO;
      914    16642    6                          KS_CONFIG_KEY.NODE = 0;
      915    16643    6                          KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;
      916    16644    6                       END;
      917    16645    5                    ELSE
      918    16646    5                       KS_CONFIG_KEY.NODE = KS_NODE;
      919    16647    5                 END;  /*end of else part of di config full */
      920    16648    4              CALL KSU$READ_NETCON (VECTOR(KS_CONFIG_KEY),VECTOR(CNFG_BUFFER))
             16648                       WHENALTRETURN
      921    16649
      922    16650    5                       DO;
      923    16651    5                       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY AND
      924    16652    5                          KS_DISP_RNG THEN
      925    16653    6                          DO;
      926    16654    6                          PREC_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);
      927    16655    6                          CALL M$PRECORD(PREC_NETCON) WHENALTRETURN
      928    16656    7         DO;
      929    16657    7           READ_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);
      930    16658    7           READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);
      931    16659    7                             READ_NETCON.V.KEYS# = '0'B;
      932    16660    7                             READ_NETCON.V.KEYR# = '1'B;
      933    16661    7                             CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);
      934    16662    7                             IF KS_CONFIG_KEY.NODE ~= KS_NODE OR
      935    16663    7                                KS_CONFIG_KEY.TYP  ~= %KL_KEYTYP_CONFIG THEN
      936    16664    7                                   GOTO DISP_ERR;
      937    16665    7                             CALL KSU$CHK_TRM_RNG(KS_CONFIG_KEY.TERMID,TERMHI) ALTRET(
             16665                                      DISP_ERR);
      938    16666    7                             END;  /* end of 2nd read */
      939    16667    6                          END;  /* if error code = no key and display range*/
      940    16668    5                       ELSE
      941    16669    5                          GOTO DISP_ERR;
      942    16670    5                       END;
      943    16671    4                    END;/*   end of else part of if default  */
      944    16672    4                 DO WHILE ('1'B);
      945    16673    4                    IF BLK$->OUT$BLK.CODE = %KS_LNCONFIG THEN
      946    16674    5                       DO;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:34   
      947    16675    5                       IF KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = ' ' THEN
      948    16676    6                          DO;
      949    16677                               %ARRAY_TO_WORD(S="KS_CONFIG_KEY.TERMID.TERM.CHANNEL",D=
             16677                                   ATTRIBUTE);
      950    16689    6                          END;
      951    16690    5                       ELSE
      952    16691    6                          DO;
      953    16692                               %ARRAY_TO_WORD(S="TERMLO.TERM.CHANNEL",D=ATTRIBUTE);
      954    16704    6                          END;
      955    16705    5                        CALL KSW$WRITE(LNCNFG_VEC, VECTOR(KS_NODE),
      956    16706    5                                       VECTOR(KS_NODENAME),VECTOR(ATTRIBUTE),
      957    16707    5                                       VECTOR(KS_CONFIG_KEY.TERMID.TERM.SUBDEVICE),
      958    16708    5                                       VECTOR(KS_CONFIG_KEY.TERMID.TERM.SUBSUBDEVICE),
      959    16709    5                                       VECTOR(KS_CONFIG_KEY.TERMID.TERM.TERM_NAME));
      960    16710
      961    16711    5                         END;
      962    16712    4                   CALL KSW$WRITE(VECTOR(CONFIG_FMT),VECTOR(DEF_OPT),VECTOR(CNFG_BUFFER
             16712                            ),VECTOR(DEF_BUFFER),VECTOR(LINESPEED),
      963    16713    4                      VECTOR(KS_DEFAULT_KEY.HNDLR));
      964    16714    4                 IF KS_DISP_RNG THEN
      965    16715    5                  DO;
      966    16716    6                  IF KS_CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' ' THEN DO;
      967    16717    6                     TERMHI.TERM.CHANNEL = '0'B;
      968    16718    6                     KS_CHKNODE = 0;
      969    16719    6                     END;
      970    16720    5                  ELSE
      971    16721    5                     KS_CHKNODE = KS_NODE;
      972    16722    5                    IF FIRST THEN
      973    16723    6                       DO;
      974    16724    6                       FIRST = '0'B;
      975    16725    6                       IF KS_CONFIG_KEY.TERMID.LEV>%TERMINAL_ID_LEV_CHAN# AND
      976    16726    7                          KS_CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' ' THEN DO;
      977    16727    7                          KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;
      978    16728    7                          END;
      979    16729    6                       READ_NETCON.V.KEYR# = '1'B;
      980    16730    6                       READ_NETCON.V.KEYS# = '0'B;
      981    16731    6                       END;  /*if first*/
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:35   
      982    16732    5                    END;  /*if display range*/
      983    16733    4                 ELSE
      984    16734    4                    GOTO END_LOOP;
      985    16735
      986    16736    4                 CNFG_BUFFER = '0'B;
      987    16737    4                       READ_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);
      988    16738    4                 READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);
      989    16739    4                 CALL M$READ(READ_NETCON) WHENALTRETURN
      990    16740    5                    DO;
      991    16741    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF THEN
      992    16742    5                       GOTO END_LOOP;
      993    16743    5                    ELSE
      994    16744    5                       GOTO DISP_ERR;
      995    16745    5                    END; /*altreturn from read netcon*/
      996    16746
      997    16747
      998    16748    4                 IF (KS_CONFIG_KEY.TYP ~= %KL_KEYTYP_CONFIG) OR
      999    16749    4              (KS_CONFIG_KEY.NODE ~= KS_CHKNODE) THEN
     1000    16750    4                       GOTO END_LOOP;
     1001    16751    5                 ELSE DO;
     1002    16752    6                    CALL KSU$CHK_TRM_RNG(KS_CONFIG_KEY.TERMID,TERMHI) WHENALTRETURN DO;
     1003    16753
     1004    16754    6                       GOTO END_LOOP;
     1005    16755    6                       END;   /*  when altreturn  */
     1006    16756    5                    END;  /*  else  */
     1007    16757    4                 END;   /*end while loop*/
     1008    16758        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:36   
     1009    16759        /*
     1010    16760             This section of code displays the channel table as it is
     1011    16761             represented in the FEP.  Five options exist; CHAN,FULL,STATE
     1012    16762             DVCCLS and DVCATTR.
     1013    16763        */
     1014    16764
     1015    16765    3        CASE (%KS_CHANTBL);
     1016    16766
     1017    16767
     1018    16768
     1019    16769        /*
     1020    16770                   If the number of sub-blocks is 0 then no options were
     1021    16771                   specified and all channels on that node will be displayed.
     1022    16772                   otherwise check to see if a node was specified in the
     1023    16773                   commands string, if so substitute nodes and continue.
     1024    16774                   If the first sub-block is not a node specification then
     1025    16775                   the sub-options begin with the first sub-block.
     1026    16776        */
     1027    16777    3           FIRST_SUBLK = 0;
     1028    16778    3            IF BLK$->OUT$BLK.NSUBLKS ~= 0 THEN
     1029    16779    4               DO;
     1030    16780    4               IF BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN
     1031    16781    5                  DO;
     1032    16782    5                  CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));
     1033    16783    5                  KS_NODE_SV = KS_NODE;
     1034    16784    5                  KS_NODE = FEPNODE;
     1035    16785    5                  KS_NODENAME_SV = KS_NODENAME;
     1036    16786    5                  KS_NODENAME = FEPNAME;
     1037    16787    5                  FIRST_SUBLK = 1;
     1038    16788    5                  END;
     1039    16789    4               END;
     1040    16790    3            KS_SUB_BUF_1.COUNT = SIZEC('Channel Table');
     1041    16791    3            KS_SUB_BUF_1.TEXT = 'Channel Table';
     1042    16792    3            READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
     1043    16793    3            READ_NETCON.BUF_ = VECTOR(KS_NETWORK);
     1044    16794    3            CALL M$READ (READ_NETCON) ALTRET (DISP_ERR);
     1045    16795
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:37   
     1046    16796    3            IF KS_NETWORK.NODE.TYPE(KS_NODE) = 1 OR
     1047    16797    3               KS_NETWORK.NODE.TYPE(KS_NODE) = 3 THEN
     1048    16798    4               DO;
     1049    16799    4                  CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);
     1050    16800                       /*E*   ERROR: KSN-E$KS_BAD_NODE_TYPE-0
     1051    16801                              MESSAGE: This command works only on FEP nodes.
     1052    16802                              DESCRIPTION: SEE MESSAGE */
     1053    16803    4                  GOTO END_LOOP;
     1054    16804    4               END;
     1055    16805
     1056    16806    3            CHANHI = %KS_CHANNEL_HI;
     1057    16807    3            CHANLO = %KS_CHANNEL_LO;
     1058    16808    3            SUBLO = %KS_SUB_LO;
     1059    16809    3            SUBHI = %KS_SUB_HI;
     1060    16810    3            SUBSUBLO = %KS_SUB_LO;
     1061    16811    3            SUBSUBHI = %KS_SUB_HI;
     1062    16812    3              CALL KSU$UNPACK (CHANLO,TERMLO.TERM.CHANNEL);
     1063    16813    3              CALL KSU$UNPACK (CHANHI,TERMHI.TERM.CHANNEL);
     1064    16814    3              CALL KSU$UNPACK (SUBLO,TERMLO.TERM.SUBDEVICE);
     1065    16815    3              CALL KSU$UNPACK (SUBHI,TERMHI.TERM.SUBDEVICE);
     1066    16816    3              CALL KSU$UNPACK (SUBSUBLO,TERMLO.TERM.SUBSUBDEVICE);
     1067    16817    3              CALL KSU$UNPACK (SUBSUBHI,TERMHI.TERM.SUBSUBDEVICE);
     1068    16818    3              TERMLO.LEV = 1;
     1069    16819    3              TERMHI.LEV = 1;
     1070    16820
     1071    16821    3            CHAN_DISP_FULL = '0'B;
     1072    16822    3            ONE_CHAN_FLAG = '0'B;
     1073    16823
     1074    16824    3            OPT.P$(%KS_DVCRES) = ADDR(NIL);
     1075    16825    3            OPT.P$(%KS_DVCATTR) = ADDR(NIL);
     1076    16826    3            OPT.P$(%KS_STATE) = ADDR(NIL);
     1077    16827
     1078    16828    3            IF BLK$->OUT$BLK.NSUBLKS ~= FIRST_SUBLK THEN
     1079    16829    4               DO;
     1080    16830    4                  LAST = BLK$->OUT$BLK.NSUBLKS - 1;
     1081    16831
     1082    16832
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:38   
     1083    16833        /*
     1084    16834                This loop goes through all of the sub-nodes specified off
     1085    16835                of the channel node.
     1086    16836        */
     1087    16837
     1088    16838    5                DO SBLK = FIRST_SUBLK TO LAST;
     1089    16839    5                    CODE = BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.CODE;
     1090    16840    6                     DO CASE(CODE);
     1091    16841    6                        CASE(%KS_CHAN);
     1092    16842    6      CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$
             16842               (0),TERMLO) ALTRET(DISP_ERR);
     1093    16843    6                           IF (BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.SUBLK$(0)->OUT$BLK.
             16843                                    NSUBLKS = 2) THEN
     1094    16844    7                              DO;
     1095    16845    7       CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.SUBLK$(0)->OUT$BLK.
             16845                SUBLK$(1),TERMHI) ALTRET(DISP_ERR);
     1096    16846    7                              CALL KSU$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN
     1097    16847    8                                 DO;
     1098    16848    8                                 CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);
     1099    16849    8                                 GOTO END_LOOP;
     1100    16850    8                                 END;
     1101    16851    7                              END;  /*  if 2 sublocks   */
     1102    16852    6                           ELSE
     1103    16853    7                              DO;
     1104    16854    7                              CHAN_DISP_FULL = '1'B;
     1105    16855    7                              ONE_CHAN_FLAG = '1'B;
     1106    16856    7                              TERMHI = TERMLO;
     1107    16857    7                              END;
     1108    16858
     1109    16859    6                        CASE (%KS_FULL);
     1110    16860    6                           CHAN_DISP_FULL = '1'B;
     1111    16861
     1112    16862    6                        CASE (%KS_DVCRES, %KS_DVCATTR, %KS_STATE);
     1113    16863    6      OPT.P$(CODE) = BLK$->OUT$BLK.SUBLK$(SBLK);
     1114    16864    6                           OPT.LAST(CODE) = OPT.P$(CODE)->OUT$BLK.NSUBLKS-1;
     1115    16865    6                     END; /*CASE*/
     1116    16866    5                  END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:39   
     1117    16867    4               END;
     1118    16868
     1119    16869    3               HDR_FLAG = '0'B;
     1120    16870    3   NEW_CHAN_DISP:
     1121    16871    3              KS_ADMIN.CODE = IGA_CHNDISP;
     1122    16872    3              KS_ADMIN.HANDLER = ' ';
     1123    16873    3              CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);
     1124    16874    3              CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);
     1125    16875
     1126    16876    3              KS_ADMIN.TERMID_LO = TERMLO;
     1127    16877    3              KS_ADMIN.TERMID_HI = TERMHI;
     1128    16878    3              IF TERMLO = TERMHI THEN ONE_CHAN_FLAG = '1'B;
     1129    16879
     1130    16880        /*
     1131    16881           Before the CHAN_LOOP is started first display KS_ADMIN.TERMID_LO.
     1132    16882           The CHAN_LOOP will increment CHANLO + 128 after that.
     1133    16883        */
     1134    16884
     1135    16885    3              CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN));
     1136    16886    3              CALL KSR$RD_HLPCG(ONE_CHAN_FLAG);
     1137    16887    3              KH$CHN = ADMIN.KS_CHN;
     1138    16888    3              CALL DISPLAY_CHAN;
     1139    16889
     1140    16890    4   CHAN_LOOP: DO CHAN = CHANLO TO CHANHI BY 128 * %CHANTBL_REQST_SIZE;
     1141    16891        /*
     1142    16892          When increment on successive loops, make sure that TERMID_LO is
     1143    16893          increased by 128 above the previous TERMID_HI.
     1144    16894        */
     1145    16895    4                 CALL KSU$UNPACK(CHAN+128,KS_ADMIN.TERMID_LO.TERM.CHANNEL);
     1146    16896    4                 IF (CHAN+128*%CHANTBL_REQST_SIZE)>=CHANHI THEN
     1147    16897    4                    CALL KSU$UNPACK(CHANHI,KS_ADMIN.TERMID_HI.TERM.CHANNEL);
     1148    16898    4                 ELSE
     1149    16899    4                    CALL KSU$UNPACK(CHAN+128*%CHANTBL_REQST_SIZE,
     1150    16900    4                         KS_ADMIN.TERMID_HI.TERM.CHANNEL);
     1151    16901    4                 CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN));
     1152    16902    5                 DO WHILE '1'B;
     1153    16903    5                    CALL KSR$RD_HLPCG(ONE_CHAN_FLAG)
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:40   
     1154    16904    6                         WHENALTRETURN DO;
     1155    16905    6                            IF ONE_CHAN_FLAG = '1'B THEN
     1156    16906    6                               GOTO END_LOOP;
     1157    16907    6                            IF ADMIN.RESULTS.ERR# = 9999 THEN
     1158    16908    6                               GOTO OLD_CHAN_DISP;
     1159    16909    6                            END;
     1160    16910    5                    IF ADMIN.TYPE = 1 AND NOT ONE_CHAN_FLAG THEN EXIT;
     1161    16911    5                    IF ADMIN.TERMID_LO.TERM.CHANNEL = '0'B THEN
     1162    16912    5                       EXIT CHAN_LOOP;
     1163    16913    5                    KH$CHN = ADMIN.KS_CHN;
     1164    16914    5                    CALL DISPLAY_CHAN;
     1165    16915    5                    IF ADMIN.KS_CHN.TERMID = TERMHI OR
     1166    16916    5                       ONE_CHAN_FLAG THEN EXIT CHAN_LOOP;
     1167    16917    5                 END;
     1168    16918    4              END;
     1169    16919
     1170    16920    3              KS_ADMIN.CODE = IGA_ADMIN;
     1171    16921
     1172    16922    4              DO WHILE ('0'B);
     1173    16923    4   OLD_CHAN_DISP:KS_ADMIN.CODE = IGA_ADMIN;
     1174    16924    4                 KS_ADMIN.FNC = %KHA_FNC_CHNTBL;
     1175    16925    4                 KS_ADMIN.HANDLER = ' ';
     1176    16926
     1177    16927    4                 IF CODE = %KS_CHAN THEN
     1178    16928    5                    DO;
     1179    16929    5                       CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);
     1180    16930    5                       CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);
     1181    16931    5                       CALL KSU$PACK2 (TERMLO.TERM.SUBDEVICE,SUBLO);
     1182    16932    5                       CALL KSU$PACK2 (TERMHI.TERM.SUBDEVICE,SUBHI);
     1183    16933    5                       CALL KSU$PACK2 (TERMLO.TERM.SUBSUBDEVICE,SUBSUBLO);
     1184    16934    5                       CALL KSU$PACK2 (TERMHI.TERM.SUBSUBDEVICE,SUBSUBHI);
     1185    16935    5                    END;
     1186    16936
     1187    16937    5   C_LOOP:       DO CHAN = CHANLO TO CHANHI BY 128;
     1188    16938    5                    CALL KSU$UNPACK (CHAN,KS_ADMIN.TERMID_LO.TERM.CHANNEL);
     1189    16939    6   S_LOOP:          DO SUBDEV = SUBLO TO SUBHI;
     1190    16940    6                       CALL KSU$UNPACK (SUBDEV,KS_ADMIN.TERMID_LO.TERM.SUBDEVICE);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:41   
     1191    16941    7   SS_LOOP:            DO SUBSUBDEV = SUBSUBLO TO SUBSUBHI;
     1192    16942    7                          CALL KSU$UNPACK (SUBSUBDEV,KS_ADMIN.TERMID_LO.TERM.
             16942                                   SUBSUBDEVICE);
     1193    16943    8   LEV_LOOP:              DO LEV = 1 TO 3;
     1194    16944
     1195    16945    8                             IF ONE_CHAN_FLAG THEN
     1196    16946    8                                KS_ADMIN.TERMID_LO.LEV = TERMLO.LEV;
     1197    16947    8                             ELSE
     1198    16948    8                                KS_ADMIN.TERMID_LO.LEV = LEV;
     1199    16949
     1200    16950    8                             KS_ADMIN.TERMID_HI = KS_ADMIN.TERMID_LO;
     1201    16951
     1202    16952    8                    CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET(ERR1);
     1203    16953    8                    CALL KSR$RD_HLPCG(ONE_CHAN_FLAG);
     1204    16954    8                    IF ADMIN.RESULTS.ERR# = %E$CHAN_NOT_THERE OR
     1205    16955    8                      ADMIN.RESULTS.ERR# = %E$NOT_OWNED THEN
     1206    16956    8                       EXIT S_LOOP;
     1207    16957    8                    IF ADMIN.RESULTS ~= '0'B THEN
     1208    16958    8                       GOTO ERR1;
     1209    16959    8                    KH$CHN = ADMIN.KS_CHN;
     1210    16960    8                    IF LEV ~= 1 AND NOT ONE_CHAN_FLAG THEN
     1211    16961    9                       DO;
     1212    16962    9                       PTR$ = KH$CHN.LNK$;
     1213    16963    9                       IF PTR$_R = '0'B THEN
     1214    16964    9                          EXIT LEV_LOOP;
     1215    16965    9                       END;
     1216    16966    8                       PTR$ = KH$CHN.CTX$;
     1217    16967    8                             CALL DISPLAY_CHAN;
     1218    16968    8         IF ONE_CHAN_FLAG  THEN
     1219    16969    8              EXIT C_LOOP;
     1220    16970    8                          END LEV_LOOP;
     1221    16971    7                       END SS_LOOP;
     1222    16972    6                    END S_LOOP;
     1223    16973    5                 END C_LOOP;
     1224    16974    4              END;     /* OLD_CHAN_DISP */
     1225    16975        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:42   
     1226    16976    3              CASE(%KS_NETWORK);
     1227    16977    3                 KS_SUB_BUF_1.COUNT = SIZEC('NETWORK');
     1228    16978    3                 KS_SUB_BUF_1.TEXT = 'NETWORK';
     1229    16979    3                 READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
     1230    16980    3                 READ_NETCON.BUF_ = VECTOR(KS_NETWORK);
     1231    16981    4                 CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     1232    16982    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY
     1233    16983    4                       THEN GOTO DISP_ERR;
     1234    16984    4                    KS_NETWORK = '0'B;
     1235    16985    4                    END;  /* WHENALTRETURN */
     1236    16986    4                 IF KS_NETWORK.NODE# = 0 THEN DO;
     1237    16987    4                    CALL KSE$ERRMSG(%E$KS_NO_NETWORK);
     1238    16988                         /*E* ERROR: KSN-E$KS_NO_NETWORK-0
     1239    16989                              MESSAGE: No nodes currently defined.
     1240    16990                              MESSAGE1: Nodes must be defined via the DEFINE command.
     1241    16991                              DESCRIPTION: SEE MESSAGES */
     1242    16992    4                    END;  /* IF NODE# = 0 */
     1243    16993    4                 ELSE DO;
     1244    16994    4                 READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);
     1245    16995    4               READ_NETCON.BUF_ = VECTOR(KS_RFEP);
     1246    16996    5               CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     1247    16997    5                   KS_RFEP = KS_NETWORK;
     1248    16998    5                END;
     1249    16999    4   IF BLK$->OUT$BLK.NSUBLKS = 0 THEN
     1250    17000    5        DO;
     1251    17001    5           NODESLCT = '0'B;
     1252    17002    5           LAST = KS_NETWORK.NODE#;
     1253    17003    5        END;
     1254    17004    4   ELSE
     1255    17005    5        DO;
     1256    17006    5           NODESLCT = '1'B;
     1257    17007    5           LAST = BLK$->OUT$BLK.NSUBLKS - 1;
     1258    17008    5        END;
     1259    17009    4                    FIRST = '1'B;
     1260    17010    5                    DO L = 0 TO LAST;
     1261    17011    5                       IF NODESLCT THEN
     1262    17012    6                          DO;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:43   
     1263    17013    6                             CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(L));
     1264    17014    6                             J = FEPNODE;
     1265    17015    6                             IF FEPNODE > KS_NETWORK.NODE# OR FEPNAME = ' ' OR FEPNODE
             17015                                      = -1 THEN
     1266    17016    7                                DO;
     1267    17017    7                                   KS_SUB_BUF_1.TEXT = BLK$->OUT$BLK.SUBLK$(L)->OUT$SYM
             17017                                            .TEXT;
     1268    17018    7                                   KS_SUB_BUF_1.COUNT = BLK$->OUT$BLK.SUBLK$(L)->
             17018                                            OUT$SYM.COUNT;
     1269    17019    7                                   CALL KSE$ERRMSG(%E$KS_UNDEFNODE,VECTOR(KS_SUB_BUF_1)
             17019                                            );
     1270    17020    7                                   GOTO END_DI_NET_LOOP;
     1271    17021    7                                END;
     1272    17022    6                          END;
     1273    17023    5                       ELSE
     1274    17024    5                          J = L;
     1275    17025    5                       IF KS_RFEP.NODE.TYPE(J) ~= 0 THEN
     1276    17026    6                          DO;
     1277    17027    6                             KS_NODEINFO_F.V.NODENUM# = J;
     1278    17028    6                             CALL M$NODEINFO (KS_NODEINFO_F)
     1279    17029    7                                WHENALTRETURN DO;
     1280    17030    7                                   KS_NODEINFO_V.LINKNODENUM# = 0;
     1281    17031    7                                END;
     1282    17032
     1283    17033    6                             KS_LINK_KEY.NODE = J;
     1284    17034    6                             READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     1285    17035    6                             READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     1286    17036    7                             CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     1287    17037    7                                KS_LINK.LINKS# = 0;
     1288    17038    7                                END;
     1289    17039
     1290    17040    6                             CALL KSW$WRITE (NETWORK_VEC,
     1291    17041    6                                VECTOR(FIRST),
     1292    17042    6                                VECTOR(J),
     1293    17043    6                                VECTOR(KS_NETWORK),
     1294    17044    6                                VECTOR(KS_RFEP),
     1295    17045    6                                VECTOR(TEXT_NODETYPE),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:44   
     1296    17046    6                                VECTOR(KS_NODEINFO_V.LINKNODENUM#),
     1297    17047    6                                VECTOR(KS_MSGBUF));
     1298    17048    6                             FIRST = '0'B;
     1299    17049    6                          END;
     1300    17050    5   END_DI_NET_LOOP:    END;                /* DO J                               */
     1301    17051    4                    END;  /* ELSE */
     1302    17052        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:45   
     1303    17053        /*
     1304    17054                This section of the case displays the xxxx associated with
     1305    17055                the selected node
     1306    17056        */
     1307    17057    3              CASE(%KS_LINKS);
     1308    17058    3                 IF KS_NODENAME='HOST' THEN
     1309    17059    4                    DO;
     1310    17060    4                    CALL KSE$ERRMSG(%E$KS_NONODE);
     1311    17061    4                    RETURN;
     1312    17062    4                    END;
     1313    17063
     1314    17064    3                 KS_LINK_KEY.NODE = KS_NODE;
     1315    17065    3                 KS_SUB_BUF_1.COUNT = SIZEC('LINKS');
     1316    17066    3                 KS_SUB_BUF_1.TEXT = 'LINKS';
     1317    17067    3                 CALL KSW$WRITE(LINK_VEC,VECTOR(KS_NODENAME));
     1318    17068    3                 READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     1319    17069    3                 READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     1320    17070
     1321    17071    3                 CALL M$READ(READ_NETCON) ALTRET (DISP_ERR);
     1322    17072    3                 CALL KSW$WRITE(LINKCHAN_VEC,VECTOR(KS_LINK.LINKS#));
     1323    17073
     1324    17074    4                 DO I = 0 TO KS_LINK.LINKS#-1;
     1325    17075    4                    CALL KSW$WRITE(CHAN_VEC,VECTOR(I),VECTOR(KS_LINK.CHANNEL(I)));
     1326    17076    4                 END;
     1327    17077
     1328    17078        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:46   
     1329    17079
     1330    17080        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:47   
     1331    17081    3               CASE(%KS_PARAM,%KS_BOOT_PRMS,%KS_LCP6_PRMS,%KS_HNDLR_PRMS);
     1332    17082    3                  IF KS_NODENAME = 'HOST' THEN
     1333    17083    4                     DO;
     1334    17084    4                        CALL KSE$ERRMSG(%E$KS_NONODE);
     1335    17085    4                        RETURN;
     1336    17086    4                     END;
     1337    17087    3                 FIRST_PARM = '1'B;
     1338    17088
     1339    17089    4                  DO CASE (BLK$->OUT$BLK.CODE);
     1340    17090    4                     CASE (%KS_PARAM);
     1341    17091    4                        MAX_PARM = 0;
     1342    17092    4                        PARMTYPE = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     1343    17093    4                        ONE_PARM_ONLY = '1'B;
     1344    17094    4                       IF LAST_DI = %KS_PARAM THEN FIRST_PARM = '0'B;
     1345    17095    4                     CASE (%KS_BOOT_PRMS);
     1346    17096    4                        MAX_PARM = %GI_BOOT_HI;
     1347    17097    4                        PARMTYPE = %KS_BOOT_PARAM;
     1348    17098    4                        ONE_PARM_ONLY = '0'B;
     1349    17099    4                     CASE (%KS_LCP6_PRMS);
     1350    17100    4                        MAX_PARM = %GI_CNTL_DISPHI;
     1351    17101    4                        PARMTYPE = %KS_LCP6_PARAM;
     1352    17102    4                        ONE_PARM_ONLY = '0'B;
     1353    17103    4                     CASE (%KS_HNDLR_PRMS);
     1354    17104    4                        MAX_PARM = KS_HAND_INFO.SZ(KS_HNDLRINDX) - 1;
     1355    17105    4                        PARMTYPE = %KS_HNDLR_PARAM;
     1356    17106    4                        ONE_PARM_ONLY = '0'B;
     1357    17107    4                  END;
     1358    17108    3   PARM_LOOP:
     1359    17109    4         DO PARMX = 0 TO MAX_PARM;
     1360    17110
     1361    17111    4            IF ONE_PARM_ONLY THEN
     1362    17112    4               PARMX = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     1363    17113
     1364    17114    4            IF KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME.NAME# = 'SPARE' OR
     1365    17115    4               KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME.NAME# =
     1366    17116    4               'DPS8000FLG' THEN
     1367    17117    4               GOTO PARM_LOOP_END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:48   
     1368    17118                 /*N* Temp. for D00.  See SET command*/
     1369    17119    4           IF PARMTYPE = %KS_BOOT_PARAM AND PARMX = %GI_BOOT_NSHUF THEN
     1370    17120    5              DO;
     1371    17121    5                 IF ONE_PARM_ONLY THEN
     1372    17122    5                    CALL KSE$ERRMSG (%E$KS_NO_MORE_NSHUF);
     1373    17123    5                 GOTO PARM_LOOP_END;
     1374    17124    5              END;
     1375    17125
     1376    17126    4           IF PARMTYPE = %KS_LCP6_PARAM AND
     1377    17127    4              PARMX = %GI_CNTL_KEEPDELTA AND
     1378    17128    4              NOT ONE_PARM_ONLY THEN
     1379    17129    4              GOTO PARM_LOOP_END;
     1380    17130
     1381    17131    4            NO_CURRENT_VAL = '0'B;
     1382    17132
     1383    17133    5            DO CASE (PARMTYPE);
     1384    17134
     1385    17135    5              CASE(%KS_BOOT_PARAM);
     1386    17136    5                 IF KS_SELPRMOPT = %KS_FILE THEN
     1387    17137    5                    NO_CURRENT_VAL = '1'B;
     1388    17138    5                 ELSE
     1389    17139    6                    DO;
     1390    17140    6                       CALL KSU$BLD_KL_CONTROL(KS_CONTROL,'BABOON',%KL_CONTROL_DISPLAY,
             17140                                %GI_CNTL_DISPHI + 1 + PARMX,0);
     1391    17141    6                       CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL));
     1392    17142    6                       CALL KSR$RD_HLPCG ('0');
     1393    17143    6      BOOTP_RDCG_ERR:      IF CONTROL.TYPE = 0 THEN
     1394    17144    6                          NO_CURRENT_VAL = '1'B;
     1395    17145    6                    END;
     1396    17146    5                  KS_FEPBOOT_KEY.NODE = KS_NODE;
     1397    17147    5                  CALL KSU$READ_NETCON(VECTOR(KS_FEPBOOT_KEY),VECTOR(KS_FEPBOOT));
     1398    17148    5                  CALL DISP_NONHAND_PARM (PARMTYPE,PARMX,CONTROL.VALUE,KS_FEPBOOT.
             17148                           BOOTPARAMS(PARMX),'0'B);
     1399    17149
     1400    17150    5               CASE (%KS_LCP6_PARAM);
     1401    17151    5                 IF KS_SELPRMOPT = %KS_FILE THEN
     1402    17152    5                    NO_CURRENT_VAL = '1'B;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:49   
     1403    17153    5                 ELSE
     1404    17154    6                    DO;
     1405    17155    6                       CALL KSU$BLD_KL_CONTROL(KS_CONTROL,'BABOON',%KL_CONTROL_DISPLAY,
             17155                                PARMX,0);
     1406    17156    6                       CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET(LCP6_RDCG_ERR);
     1407    17157    6                       CALL KSR$RD_HLPCG ('0') ALTRET (LCP6_RDCG_ERR);
     1408    17158    6   LCP6_RDCG_ERR:      IF CONTROL.TYPE = 0 THEN
     1409    17159    6                          NO_CURRENT_VAL = '1'B;
     1410    17160    6                    END;
     1411    17161    5                  KS_FEPCTL_KEY.NODE = KS_NODE;
     1412    17162    5                  CALL KSU$READ_NETCON(VECTOR(KS_FEPCTL_KEY),VECTOR(KS_FEPCTL)) ALTRET(
             17162                           LCP6_RDNETCON_ERR);
     1413    17163    5   LCP6_RDNETCON_ERR:
     1414    17164    5                  CALL DISP_NONHAND_PARM (PARMTYPE,PARMX,CONTROL.VALUE,KS_FEPCTL.PARAMS
             17164                           (PARMX),NO_CURRENT_VAL);
     1415    17165
     1416    17166    5               CASE (%KS_HNDLR_PARAM);
     1417    17167    5                  IF KS_HNDLRNAME = ' ' THEN
     1418    17168    6                     DO;
     1419    17169    6                        CALL KSE$ERRMSG (%E$KS_NOHANDLER);
     1420    17170                             /*E* ERROR:  KSN-E$KS_NOHANDLER-0
     1421    17171              MESSAGE:A handler must be selected in order to display a handler parameter. */
     1422    17172    6                        GOTO END_LOOP;
     1423    17173    6                     END;
     1424    17174    5                  IF NOT(ADDR(KS_TBL(PARMTYPE)->KS$PARAM.HND(PARMX))->HND.DAT(
             17174                           KS_HNDLRINDX)) THEN
     1425    17175    6                     DO;
     1426    17176    6                        IF ONE_PARM_ONLY THEN
     1427    17177    7                           DO;
     1428    17178    7                              KS_SUB_BUF_1.COUNT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(
             17178                                       PARMX)->NAME.L#;
     1429    17179    7                              KS_SUB_BUF_1.TEXT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(
             17179                                       PARMX)->NAME.NAME#;
     1430    17180    7                              KS_SUB_BUF_2.COUNT = SIZEC(KS_HNDLRNAME);
     1431    17181    7                              KS_SUB_BUF_2.TEXT = KS_HNDLRNAME;
     1432    17182    7                              CALL KSE$ERRMSG(%E$KS_ILGSET,VECTOR(KS_SUB_BUF_1),VECTOR(
             17182                                       KS_SUB_BUF_2));
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:50   
     1433    17183    7                           END;
     1434    17184    6                        GOTO PARM_LOOP_END;
     1435    17185    6                     END;
     1436    17186
     1437    17187    5                  IF NOT KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.INDX(PARMX) THEN
     1438    17188    6                     DO;
     1439    17189    6                        IF KS_SELPRMOPT = %KS_FILE THEN
     1440    17190    6                           NO_CURRENT_VAL = '1'B;
     1441    17191    6                        ELSE
     1442    17192    7                           DO;
     1443    17193    7                              CALL KSU$BLD_KL_CONTROL(KS_CONTROL,KS_HNDLRNAME,%
             17193                                       KL_CONTROL_DISPLAY,PARMX,0);
     1444    17194    7                              CALL KSR$WR_HLPCG(VECTOR(KS_CONTROL)) ALTRET(
             17194                                       HAND_RDCG_ERR);
     1445    17195    7                              CALL KSR$RD_HLPCG('0') ALTRET (HAND_RDCG_ERR);
     1446    17196    7   HAND_RDCG_ERR:             IF CONTROL.TYPE = 0 THEN
     1447    17197    7                                 NO_CURRENT_VAL = '1'B;
     1448    17198    7                           END;
     1449    17199
     1450    17200    6                        KS_HANDLER_KEY.NODE = KS_NODE;
     1451    17201    6                        KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;
     1452    17202    6                        CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF))
             17202                                 WHENALTRETURN
     1453    17203    7                             DO;
     1454    17204    7                                KS_SUB_BUF_1.TEXT = KS_HNDLRNAME;
     1455    17205    7                                KS_SUB_BUF_1.COUNT = SIZEC(KS_HNDLRNAME);
     1456    17206    7                                KS_SUB_BUF_2.TEXT = KS_NODENAME;
     1457    17207    7                                KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);
     1458    17208    7                                CALL KSE$ERRMSG(%E$KS_HAND_NOT_DEF,VECTOR(KS_SUB_BUF_1)
             17208                                         ,VECTOR(KS_SUB_BUF_2));
     1459    17209                                     /*E* ERROR: KSN-E$KS_HAND_NOT_DEF-0
     1460    17210                                  MESSAGE: Handler %U1 has not been defined for node %U2. */
     1461    17211    7                                GOTO  END_LOOP;
     1462    17212    7                             END;
     1463    17213    6   HAND_RDNETCON_ERR:   CALL DISPARM (KS_HNDLRINDX+3,PARMX,,CONTROL.VALUE,KS$HNDLR.
             17213            PARAMS(PARMX),NO_CURRENT_VAL);
     1464    17214    6                     END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:51   
     1465    17215    5                  ELSE
     1466    17216    6                     DO;
     1467    17217    6                        IF PARMX = %KL_HNDLRPARM_USRPARM1 OR
     1468    17218    6                        PARMX = %KL_HNDLRPARM_USRPARM2 THEN
     1469    17219    7                           DO;
     1470    17220    7                              IF ONE_PARM_ONLY THEN
     1471    17221    8                                 DO;
     1472    17222    8                                    PTR$ = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
             17222                                             OUT$BLK.SUBLK$(0);
     1473    17223    8                                    INDX = PTR$->OUT$BLK.CODE;
     1474    17224    8                                    CALL DISPLAY_INDEXED_PARM(PARMX,INDX);
     1475    17225    8                                 END;
     1476    17226    7                              ELSE
     1477    17227    8       DO;
     1478    17228    8           CALL KSW$WRITE(VECTOR(USRPARM_HDR_FMT),
     1479    17229    8                         VECTOR(KS_TBL(KS_HNDLRINDX+3)->KS$PARAM.TEXTNAME(PARMX)->NAME)
             17229                                  );
     1480    17230    8           IF KS_SELPRMOPT ~= %KS_FILE THEN
     1481    17231    9             DO;
     1482    17232    9                CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY,
             17232                         PARMX,0);
     1483    17233    9                CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (DI_USRPARM_FROM_NETCON);
     1484    17234    9                CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_USRPARM_FROM_NETCON);
     1485    17235    9                 IF CONTROL.TYPE = 0 THEN
     1486    17236    9                   GOTO DI_USRPARM_FROM_NETCON;
     1487    17237
     1488    17238    9                CALL KSW$WRITE(VECTOR(CURRENT_FMT));
     1489    17239   10                DO INDX = %KS_USRPRM1 TO %KS_USRPRM8;
     1490    17240   10                   CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY
             17240                            ,PARMX,INDX);
     1491    17241   10                   CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (
             17241                            DI_USRPARM_FROM_NETCON);
     1492    17242   10                   CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_USRPARM_FROM_NETCON);
     1493    17243   10                   CALL KSW$WRITE(VECTOR(USRPARM_ENTRY_FMT),VECTOR(INDX),VECTOR(CONTROL
             17243                            .VALUE));
     1494    17244   10                END;
     1495    17245    9             END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:52   
     1496    17246
     1497    17247    8   DI_USRPARM_FROM_NETCON:
     1498    17248    8                KS_HANDLER_KEY.NODE = KS_NODE;
     1499    17249    8                KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;
     1500    17250    8                CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF)) ALTRET(
             17250                         DISP_ERR);
     1501    17251    8                IPARAM$ = PINCRW(ADDR(CHAR_BUF),PARMX-%KL_HNDLRPARM_BLOCK);
     1502    17252
     1503    17253    8                CALL KSW$WRITE(VECTOR(USRPARM_NETCON_FMT),VECTOR(IPARAM$->KS$HNDLR.
             17253                         IPARAM.OFFSET(0)),VECTOR(CHAR_BUF));
     1504    17254    8       END;
     1505    17255    7                           END;
     1506    17256    6                        ELSE
     1507    17257    7                           DO;
     1508    17258    7   IF ONE_PARM_ONLY AND BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
     1509    17259    7      OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_SPEED_LIST THEN
     1510    17260    8       DO;
     1511    17261    8          PTR$ = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0);
     1512    17262    9          DO J = 0 TO PTR$->OUT$BLK.NSUBLKS - 1;
     1513    17263    9             INDX = PTR$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE;
     1514    17264    9             CALL DISPLAY_INDEXED_PARM (PARMX,INDX);
     1515    17265    9          END;
     1516    17266    8       END;
     1517    17267    7   ELSE
     1518    17268    8       DO;
     1519    17269    8           CALL KSW$WRITE(VECTOR(BLOCK_HDR_FMT),
     1520    17270    8                          VECTOR(KS_TBL(KS_HNDLRINDX+3)->KS$PARAM.TEXTNAME(PARMX)->NAME
             17270                                   ),
     1521    17271    8                         VECTOR(LINESPEED));
     1522    17272    8           IF KS_SELPRMOPT ~= %KS_FILE THEN
     1523    17273    9             DO;
     1524    17274    9                CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY,
             17274                         PARMX,0);
     1525    17275    9                CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (DI_FROM_NETCON);
     1526    17276    9                CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_FROM_NETCON);
     1527    17277    9                 IF CONTROL.TYPE = 0 THEN
     1528    17278    9                   GOTO DI_FROM_NETCON;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:53   
     1529    17279
     1530    17280    9                CALL KSW$WRITE(VECTOR(CURRENT_FMT));
     1531    17281   10                DO INDX = %KS_SPEED_50 TO %KS_SPEED_19200;
     1532    17282   10                   CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY
             17282                            ,PARMX,INDX);
     1533    17283   10                   CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (DI_FROM_NETCON);
     1534    17284   10                   CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_FROM_NETCON);
     1535    17285   10                   CALL KSW$WRITE(VECTOR(BLOCK_ENTRY_FMT),VECTOR(INDX),VECTOR(CONTROL.
             17285                            VALUE));
     1536    17286   10                END;
     1537    17287    9             END;
     1538    17288
     1539    17289    8   DI_FROM_NETCON:
     1540    17290    8                KS_HANDLER_KEY.NODE = KS_NODE;
     1541    17291    8                KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;
     1542    17292    8                CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF)) ALTRET(
             17292                         DISP_ERR);
     1543    17293    8                IPARAM$ = PINCRW(ADDR(CHAR_BUF),PARMX-%KL_HNDLRPARM_BLOCK);
     1544    17294
     1545    17295    8                CALL KSW$WRITE(VECTOR(BLOCK_NETCON_FMT),VECTOR(IPARAM$->KS$HNDLR.IPARAM
             17295                         .OFFSET(0)),VECTOR(CHAR_BUF));
     1546    17296    8                VBASE(BLOCK_VEC) = KS_TBL(KS_HNDLRINDX+3)->KS$PARAM_SPCL.SPCL_TBL$(
             17296                         PARMX);
     1547    17297    8                VBOUND(BLOCK_VEC) = 256;  /*Size of KS_BLOCK_TBL*/
     1548    17298    8                CALL KSW$WRITE(VECTOR(BLOCK_DEFAULT_FMT),BLOCK_VEC);
     1549    17299    8       END;
     1550    17300    7                           END;
     1551    17301    6                     END;
     1552    17302    5            END;
     1553    17303    4         IF ONE_PARM_ONLY THEN
     1554    17304    4            EXIT PARM_LOOP;
     1555    17305    4   PARM_LOOP_END:
     1556    17306    4         END;  /*PARM_LOOP*/
     1557    17307
     1558    17308    3              END;  /* DO CASE(CODE) */
     1559    17309    3            DO WHILE ('0'B);
     1560    17310    3   DISP_ERR:   CALL KSE$ERRMSG(0);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:54   
     1561    17311    3   ERR1:       CALL KSE$ERRMSG (%E$KS_CANTDIPARM,VECTOR(KS_SUB_BUF_1));
     1562    17312                    /*E* ERROR:    KSN-E$KS_CANTDIPARM-0
     1563    17313                         MESSAGE:  Unable to display %U1. */
     1564    17314    3               GOTO END_LOOP;
     1565    17315    3            END;
     1566    17316    2   END_LOOP:;
     1567    17317    2           READ_NETCON.V.KEYR# = '0'B;
     1568    17318    2           READ_NETCON.V.KEYS# = '1'B;
     1569    17319    2           IF KS_NODENAME_SV ~= ' ' THEN
     1570    17320    3              DO;
     1571    17321    3              KS_NODENAME = KS_NODENAME_SV;
     1572    17322    3              KS_NODE = KS_NODE_SV;
     1573    17323    3              KS_NODENAME_SV = ' ';
     1574    17324    3              END;
     1575    17325    2          LAST_DI = BLK$->OUT$BLK.CODE;
     1576    17326    2           END;  /* DO I */
     1577    17327    1   RETURN;
     1578    17328        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:55   
     1579    17329
     1580    17330    1     GET_NODE:  PROC(PTR$);
     1581    17331
     1582    17332    2           DCL PTR$ PTR;
     1583    17333
     1584    17334    2     CALL M$READ(READ_NETWORK);
     1585    17335    2           FEPNODE = -1;
     1586    17336    3     DO CASE(PTR$->OUT$BLK.CODE);
     1587    17337
     1588    17338    3        CASE (%KS_TEXTVAL);
     1589    17339
     1590    17340    3           FEPNAME = PTR$->OUT$SYM.TEXT;
     1591    17341    4           DO I = 0 TO KS_NETWORK.NODE#;
     1592    17342    4              IF FEPNAME = KS_NETWORK.NODE.NODE(I) THEN
     1593    17343    4                 FEPNODE = I;
     1594    17344    4           END;
     1595    17345
     1596    17346    3        CASE (%KS_DECVAL);
     1597    17347    3           CALL CHARBIN(FEPNODE,PTR$->OUT$SYM.TEXT);
     1598    17348    3           IF FEPNODE <= KS_NETWORK.NODE# THEN
     1599    17349    3              FEPNAME = KS_NETWORK.NODE.NODE(FEPNODE);
     1600    17350    3     END;   /* case  */
     1601    17351    2     RETURN;
     1602    17352    2     END GET_NODE;
     1603    17353        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:56   
     1604    17354    1   DISPLAY_INDEXED_PARM:  PROC (PARMX,INDX);
     1605    17355
     1606    17356    2            DCL PARMX UBIN;
     1607    17357    2            DCL INDX UBIN;
     1608    17358    2            DCL J UBIN;
     1609    17359
     1610    17360    2            IF KS_SELPRMOPT = %KS_FILE THEN
     1611    17361    2               NO_CURRENT_VAL = '1'B;
     1612    17362    2            ELSE
     1613    17363    3               DO;
     1614    17364    3                  CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY,
             17364                           PARMX,INDX);
     1615    17365    3                  CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (HNDLR_CG_ERR);
     1616    17366    3                  CALL KSR$RD_HLPCG ('0'B) ALTRET (HNDLR_CG_ERR);
     1617    17367    3   HNDLR_CG_ERR:
     1618    17368    3                  IF CONTROL.TYPE = 0 THEN
     1619    17369    3                     NO_CURRENT_VAL = '1'B;
     1620    17370    3               END;
     1621    17371
     1622    17372    2            KS_HANDLER_KEY.NODE = KS_NODE;
     1623    17373    2            KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;
     1624    17374    2            CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF)) ALTRET (
             17374                     DISP_ERR);
     1625    17375    2           J = PARMX - %KL_HNDLRPARM_BLOCK;
     1626    17376    2            IPARAM$ = PINCRW(ADDR(CHAR_BUF),J);
     1627    17377    2            HANDLER$ = PINCRW (ADDR(CHAR_BUF),IPARAM$->KS$HNDLR.IPARAM.OFFSET(0));
     1628    17378    2            CALL DISPARM (KS_HNDLRINDX+3,PARMX,INDX,CONTROL.VALUE,HANDLER$->B$PARAM(
             17378                     INDX),NO_CURRENT_VAL);
     1629    17379    2            HANDLER$ = ADDR(CHAR_BUF);
     1630    17380    2   DISP_ERR:
     1631    17381    2   END DISPLAY_INDEXED_PARM;
     1632    17382
     1633    17383    1   DISPARM: PROC (PARMTYPE,PARMX,INDX,CURRENT_VAL,NETCON_VAL,NO_CURRENT_VAL);
     1634    17384
     1635    17385    2         DCL PARMTYPE   UBIN;
     1636    17386    2         DCL PARMX      UBIN;
     1637    17387    2         DCL INDX       UBIN;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:57   
     1638    17388    2         DCL CURRENT_VAL UBIN HALF HALIGNED;
     1639    17389    2         DCL NETCON_VAL UBIN  HALF UNAL;
     1640    17390    2         DCL NO_CURRENT_VAL BIT(1) ALIGNED;
     1641    17391    2         DCL NETCON_DISP UBIN WORD;
     1642    17392    2         DCL SPCL_TBL$  PTR;
     1643    17393    2         DCL INDX_NAME  UBIN;
     1644    17394    2         DCL CURRENT_DISP UBIN;
     1645    17395    2         DCL DEFAULT    UBIN;
     1646    17396    2         DCL MIN        UBIN;
     1647    17397    2         DCL MAX        UBIN;
     1648    17398
     1649    17399    2        DCL HDR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17399                 'PARAMETER%20-CURRENT%30-:NETCON%40-DEFAULT%50-MINIMUM%60-MAXIMUM%10P');
     1650    17400    2        DCL INDX_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17400                 '%T%X(%D)%20-%D%30-%D%40-%D%50-%D%60-%D%10P');
     1651    17401    2        DCL RES_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17401                 '%T%20-%A%28-%A%38-%A%48-%A%58-%A%10P');
     1652    17402    2        DCL ATTR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17402                 '%T%20-%H%30-%H%40-%H%50-%H%60-%H%10P');
     1653    17403    2        DCL PARM_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17403                 '%T%20-%D%30-%D%40-%D%50-%D%60-%D%10P');
     1654    17404        %KS$PARAM(NAME=KS$PARAM_SPCL,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
     1655    17474    2        DCL INDX_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17474                 '%T%X(%D)%30-%D%40-%D%50-%D%60-%D%10P');
     1656    17475    2        DCL ATTR_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17475                 '%T%30-%H%40-%H%50-%H%60-%H%10P');
     1657    17476    2        DCL PARM_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17476                 '%T%30-%D%40-%D%50-%D%60-%D%10P');
     1658    17477    2         IF FIRST_PARM THEN
     1659    17478    3            DO;
     1660    17479    3               CALL KSW$WRITE (VECTOR(HDR_FMT));
     1661    17480    3               FIRST_PARM = '0'B;
     1662    17481    3            END;
     1663    17482
     1664    17483
     1665    17484    3         DO CASE (PARMX);
     1666    17485    3           CASE (%KL_HNDLRPARM_BLOCK,%KL_HNDLRPARM_UNBLOCK);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:58   
     1667    17486    3               INDX_NAME = LINESPEED(INDX);
     1668    17487    3               SPCL_TBL$ = KS_TBL(PARMTYPE)->KS$PARAM_SPCL.SPCL_TBL$(PARMX);
     1669    17488    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);
     1670    17489    3               NETCON_DISP = NETCON_VAL;
     1671    17490    3               DEFAULT = SPCL_TBL$->KS$PARAM.DEFAULT(INDX);
     1672    17491    3               MIN     = SPCL_TBL$->KS$PARAM.MIN(INDX);
     1673    17492    3               MAX     = SPCL_TBL$->KS$PARAM.MAX(INDX);
     1674    17493    3              IF NO_CURRENT_VAL THEN
     1675    17494    3                 CALL KSW$WRITE (VECTOR(INDX_NO_CURR_FMT),
     1676    17495    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17495                                          NAME),
     1677    17496    3                                 VECTOR(INDX_NAME),
     1678    17497    3                                 VECTOR(NETCON_DISP),
     1679    17498    3                                 VECTOR(DEFAULT),
     1680    17499    3                                 VECTOR(MIN),
     1681    17500    3                                 VECTOR(MAX));
     1682    17501    3              ELSE
     1683    17502    3                  CALL KSW$WRITE (VECTOR(INDX_FMT),
     1684    17503    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17503                                           NAME),
     1685    17504    3                                  VECTOR(INDX_NAME),
     1686    17505    3                                  VECTOR(CURRENT_DISP),
     1687    17506    3                                  VECTOR(NETCON_DISP),
     1688    17507    3                                  VECTOR(DEFAULT),
     1689    17508    3                                  VECTOR(MIN),
     1690    17509    3                                  VECTOR(MAX));
     1691    17510
     1692    17511    3            CASE (%KL_HNDLRPARM_USRPARM1,%KL_HNDLRPARM_USRPARM2);
     1693    17512    3               INDX_NAME = INDX + 1;
     1694    17513    3               SPCL_TBL$ = KS_TBL(PARMTYPE)->KS$PARAM_SPCL.SPCL_TBL$(PARMX);
     1695    17514    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);
     1696    17515    3               NETCON_DISP = NETCON_VAL;
     1697    17516    3               DEFAULT = SPCL_TBL$->KS$PARAM.DEFAULT(INDX);
     1698    17517    3               MIN     = SPCL_TBL$->KS$PARAM.MIN(INDX);
     1699    17518    3               MAX     = SPCL_TBL$->KS$PARAM.MAX(INDX);
     1700    17519    3              IF NO_CURRENT_VAL THEN
     1701    17520    3                 CALL KSW$WRITE (VECTOR(INDX_NO_CURR_FMT),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:59   
     1702    17521    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17521                                          NAME),
     1703    17522    3                                 VECTOR(INDX_NAME),
     1704    17523    3                                 VECTOR(NETCON_DISP),
     1705    17524    3                                 VECTOR(DEFAULT),
     1706    17525    3                                 VECTOR(MIN),
     1707    17526    3                                 VECTOR(MAX));
     1708    17527    3              ELSE
     1709    17528    3                  CALL KSW$WRITE (VECTOR(INDX_FMT),
     1710    17529    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17529                                           NAME),
     1711    17530    3                                  VECTOR(INDX_NAME),
     1712    17531    3                                  VECTOR(CURRENT_DISP),
     1713    17532    3                                  VECTOR(NETCON_DISP),
     1714    17533    3                                  VECTOR(DEFAULT),
     1715    17534    3                                  VECTOR(MIN),
     1716    17535    3                                  VECTOR(MAX));
     1717    17536
     1718    17537    3            CASE (%KL_HNDLRPARM_RES);
     1719    17538    3               NETCON_DISP = NETCON_VAL;
     1720    17539    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);
     1721    17540    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);
     1722    17541    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);
     1723    17542    3                 IF NO_CURRENT_VAL THEN
     1724    17543    3                    CURRENT_VAL = 32;
     1725    17544    3               CALL KSW$WRITE (VECTOR(RES_FMT),
     1726    17545    3                               VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME)
             17545                                        ,
     1727    17546    3                               VECTOR(CURRENT_VAL),
     1728    17547    3                               VECTOR(NETCON_DISP),
     1729    17548    3                               VECTOR(DEFAULT),
     1730    17549    3                               VECTOR(MIN),
     1731    17550    3                               VECTOR(MAX));
     1732    17551    3            CASE (%KL_HNDLRPARM_ATTR,%KL_HNDLRPARM_MMRINTCHC);
     1733    17552    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);
     1734    17553    3               NETCON_DISP = NETCON_VAL;
     1735    17554    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:60   
     1736    17555    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);
     1737    17556    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);
     1738    17557    3              IF NO_CURRENT_VAL THEN
     1739    17558    3                 CALL KSW$WRITE (VECTOR(ATTR_NO_CURR_FMT),
     1740    17559    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17559                                          NAME),
     1741    17560    3                                 VECTOR(NETCON_DISP),
     1742    17561    3                                 VECTOR(DEFAULT),
     1743    17562    3                                 VECTOR(MIN),
     1744    17563    3                                 VECTOR(MAX));
     1745    17564    3              ELSE
     1746    17565    3                  CALL KSW$WRITE (VECTOR(ATTR_FMT),
     1747    17566    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17566                                           NAME),
     1748    17567    3                                  VECTOR(CURRENT_DISP),
     1749    17568    3                                  VECTOR(NETCON_DISP),
     1750    17569    3                                  VECTOR(DEFAULT),
     1751    17570    3                                  VECTOR(MIN),
     1752    17571    3                                  VECTOR(MAX));
     1753    17572    3            CASE (%KL_HNDLRPARM_RCVCQBYTSIZ,%KL_HNDLRPARM_SNDCQBYTSIZ);
     1754    17573    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);
     1755    17574    3                 CURRENT_DISP = CURRENT_DISP * 2;
     1756    17575    3               NETCON_DISP = NETCON_VAL * 2;
     1757    17576    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX) * 2;
     1758    17577    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX) * 2;
     1759    17578    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX) * 2;
     1760    17579    3              IF NO_CURRENT_VAL THEN
     1761    17580    3                 CALL KSW$WRITE (VECTOR(PARM_NO_CURR_FMT),
     1762    17581    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17581                                          NAME),
     1763    17582    3                                 VECTOR(NETCON_DISP),
     1764    17583    3                                 VECTOR(DEFAULT),
     1765    17584    3                                 VECTOR(MIN),
     1766    17585    3                                 VECTOR(MAX));
     1767    17586    3              ELSE
     1768    17587    3                  CALL KSW$WRITE (VECTOR(PARM_FMT),
     1769    17588    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:61   
             17588                                           NAME),
     1770    17589    3                                  VECTOR(CURRENT_DISP),
     1771    17590    3                                  VECTOR(NETCON_DISP),
     1772    17591    3                                  VECTOR(DEFAULT),
     1773    17592    3                                  VECTOR(MIN),
     1774    17593    3                                  VECTOR(MAX));
     1775    17594    3            CASE (ELSE);
     1776    17595    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);
     1777    17596    3               NETCON_DISP = NETCON_VAL;
     1778    17597    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);
     1779    17598    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);
     1780    17599    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);
     1781    17600    3              IF NO_CURRENT_VAL THEN
     1782    17601    3                 CALL KSW$WRITE (VECTOR(PARM_NO_CURR_FMT),
     1783    17602    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17602                                          NAME),
     1784    17603    3                                 VECTOR(NETCON_DISP),
     1785    17604    3                                 VECTOR(DEFAULT),
     1786    17605    3                                 VECTOR(MIN),
     1787    17606    3                                 VECTOR(MAX));
     1788    17607    3              ELSE
     1789    17608    3                  CALL KSW$WRITE (VECTOR(PARM_FMT),
     1790    17609    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17609                                           NAME),
     1791    17610    3                                  VECTOR(CURRENT_DISP),
     1792    17611    3                                  VECTOR(NETCON_DISP),
     1793    17612    3                                  VECTOR(DEFAULT),
     1794    17613    3                                  VECTOR(MIN),
     1795    17614    3                                  VECTOR(MAX));
     1796    17615    3         END;
     1797    17616    2   END DISPARM;
     1798    17617    1   YESNO: PROC(FLAG,TEXT);
     1799    17618
     1800    17619    2   DCL FLAG BIT(1) UNAL;
     1801    17620    2   DCL TEXT CHAR(4);
     1802    17621
     1803    17622    2           IF FLAG THEN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:62   
     1804    17623    2              TEXT = ' Yes';
     1805    17624    2           ELSE
     1806    17625    2              TEXT = '  No';
     1807    17626    2           RETURN;
     1808    17627
     1809    17628    2   END YESNO;
     1810    17629    1   DISP_NONHAND_PARM: PROC (PARMTYPE,PARMX,CURRENT_VAL,NETCON_VAL,NO_CURRENT_VAL);
     1811    17630
     1812    17631    2         DCL PARMTYPE   UBIN;
     1813    17632    2         DCL PARMX      UBIN;
     1814    17633    2         DCL CURRENT_VAL UBIN HALF HALIGNED;
     1815    17634    2         DCL CURRENT_DISP  UBIN;
     1816    17635    2         DCL NETCON_VAL UBIN;
     1817    17636    2        DCL NO_CURRENT_VAL BIT(1) ALIGNED;
     1818    17637    2         DCL DEFAULT    UBIN;
     1819    17638    2         DCL MIN        UBIN;
     1820    17639    2         DCL MAX        UBIN;
     1821    17640    2         DCL HDR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17640                  ' PARAMETER%20-CURRENT%30-:NETCON%40-DEFAULT%50-MINIMUM%60-MAXIMUM%10P');
     1822    17641    2         DCL PARM_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17641                  '%X%T%20-%D%30-%D%40-%D%50-%D%60-%D%10P');
     1823    17642    2         DCL PARM_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17642                  '%X%T%30-%D%40-%D%50-%D%60-%D%10P');
     1824    17643    2         DCL PARM_DISPONLY_FMT CONSTANT CHAR(0) ALIGNED INIT('%X%T%20-%D%10P  ');
     1825    17644
     1826    17645    2         IF FIRST_PARM AND
     1827    17646    2            NOT (KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.DISPONLY(PARMX) AND
     1828    17647    2                 NO_CURRENT_VAL) THEN
     1829    17648    3            DO;
     1830    17649    3               CALL KSW$WRITE (VECTOR(HDR_FMT));
     1831    17650    3               FIRST_PARM = '0'B;
     1832    17651    3            END;
     1833    17652
     1834    17653
     1835    17654    2         CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);
     1836    17655
     1837    17656    2         IF PARMX = %GI_CNTL_KEEPDELTA AND CURRENT_DISP > 0 THEN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:63   
     1838    17657    2            CURRENT_DISP = 1;
     1839    17658
     1840    17659    2         IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.DISPONLY(PARMX) THEN
     1841    17660    3            DO;
     1842    17661    3               IF NO_CURRENT_VAL THEN
     1843    17662    3                  RETURN;
     1844    17663    3               ELSE
     1845    17664    3                  CALL KSW$WRITE (VECTOR(PARM_DISPONLY_FMT),
     1846    17665    3                       VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME),
     1847    17666    3                       VECTOR(CURRENT_DISP));
     1848    17667    3            END;
     1849    17668    2         ELSE
     1850    17669    3            DO;
     1851    17670    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);
     1852    17671    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);
     1853    17672    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);
     1854    17673    3               IF NO_CURRENT_VAL THEN
     1855    17674    3                  CALL KSW$WRITE (VECTOR(PARM_NO_CURR_FMT),
     1856    17675    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17675                                           NAME),
     1857    17676    3                                  VECTOR(NETCON_VAL),
     1858    17677    3                                  VECTOR(DEFAULT),
     1859    17678    3                                  VECTOR(MIN),
     1860    17679    3                                  VECTOR(MAX));
     1861    17680    3               ELSE
     1862    17681    3                   CALL KSW$WRITE (VECTOR(PARM_FMT),
     1863    17682    3                                   VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17682                                            NAME),
     1864    17683    3                                   VECTOR(CURRENT_DISP),
     1865    17684    3                                   VECTOR(NETCON_VAL),
     1866    17685    3                                   VECTOR(DEFAULT),
     1867    17686    3                                   VECTOR(MIN),
     1868    17687    3                                   VECTOR(MAX));
     1869    17688    3            END;
     1870    17689
     1871    17690    2   END DISP_NONHAND_PARM;
     1872    17691        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:64   
     1873    17692    1   DISPLAY_CHAN: PROC;
     1874    17693                    %ARRAY_TO_WORD(S="KH$CHN.ATTR",D="CHNTBL.ATTR");
     1875    17705    2               OPTION_SATISFIED = '1'B;
     1876    17706    2               IF NOT ONE_CHAN_FLAG THEN
     1877    17707    3   OPT_LOOP:      DO I = %KS_DVCRES TO %KS_STATE;
     1878    17708    3                     IF OPT.P$(I) = ADDR(NIL) THEN
     1879    17709    3                        OPTION_SATISFIED = '1'B;
     1880    17710    3                     ELSE
     1881    17711    4                        DO;
     1882    17712    4                           OPTION_SATISFIED = '0'B;
     1883    17713    5   SUB_OPT_LOOP:           DO J = 0 TO OPT.LAST(I);
     1884    17714    6                              DO CASE(I);
     1885    17715    6                                 CASE (%KS_DVCRES);
     1886    17716    6                                    IF KH$CHN.RESOURCE = OPT.P$(I)->OUT$BLK.SUBLK$(J)->
             17716                                             OUT$SYM.TEXT THEN
     1887    17717    7                                       DO;
     1888    17718    7                                          OPTION_SATISFIED = '1'B;
     1889    17719    7                                          EXIT SUB_OPT_LOOP;
     1890    17720    7                                       END;
     1891    17721    6                                 CASE (%KS_DVCATTR);
     1892    17722    6                                    CALL KSU$HEXBIN (ATTR,OPT.P$(I)->OUT$BLK.SUBLK$(J)
             17722                                             ->OUT$BLK.SUBLK$(0));
     1893    17723    6                                    IF ATTR = CHNTBL.ATTR THEN
     1894    17724    7                                       DO;
     1895    17725    7                                          OPTION_SATISFIED = '1'B;
     1896    17726    7                                          EXIT SUB_OPT_LOOP;
     1897    17727    7                                       END;
     1898    17728    6                                 CASE (%KS_STATE);
     1899    17729    6                                    IF KH$CHN.STT.BYT = OPT.P$(I)->OUT$BLK.SUBLK$(J)->
             17729                                             OUT$BLK.CODE THEN
     1900    17730    7                                       DO;
     1901    17731    7                                          OPTION_SATISFIED = '1'B;
     1902    17732    7                                          EXIT SUB_OPT_LOOP;
     1903    17733    7                                       END;
     1904    17734    6                              END; /*CASE*/
     1905    17735    5                           END; /*SUB_OPT_LOOP*/
     1906    17736    4                        END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:65   
     1907    17737    3                        IF  NOT OPTION_SATISFIED THEN
     1908    17738    3                           EXIT OPT_LOOP;
     1909    17739    3                     END; /*OPT_LOOP*/
     1910    17740    2                  IF OPTION_SATISFIED THEN
     1911    17741    3                     DO;
     1912    17742    3                        IF CHAN_DISP_FULL THEN
     1913    17743    4                           DO;
     1914    17744    4           CALL YESNO(KH$CHN.BRKRQ,CHNTBL.BRKRQ);
     1915    17745    4           CALL YESNO(KH$CHN.CLK,CHNTBL.CLK);
     1916    17746    4           CALL YESNO(KH$CHN.RMTHST,CHNTBL.RMTHST);
     1917    17747    4           CALL YESNO(KH$CHN.DBG,CHNTBL.DBG);
     1918    17748    4           CALL YESNO(KH$CHN.AUTLGN,CHNTBL.AUTLGN);
     1919    17749    4           CALL YESNO(KH$CHN.AUTLGNFAILED,CHNTBL.AUTLGNFAILED);
     1920    17750    4           CALL YESNO(KH$CHN.PROFILE,CHNTBL.PROFILE);
     1921    17751    4           CHNTBL.STT=STATE(KH$CHN.STT.BYT);
     1922    17752    4           CALL KSU$PACK2(KH$CHN.DVCID,CHNTBL.DVCID);
     1923    17753    4           CALL KSU$PACK2(KH$CHN.EXTDVCID,CHNTBL.EXTDVCID);
     1924    17754    4           CALL CONCAT(CHNTBL.RESOURCE,'  ',KH$CHN.RESOURCE);
     1925    17755    4           CALL KSU$PACK2(KH$CHN.ATTR,CHNTBL.ATTR);
     1926    17756    4           CALL KSU$PACK2(KH$CHN.SYSID,CHNTBL.SYSID);
     1927    17757    4           CALL YESNO(KH$CHN.DRCCNC,CHNTBL.DRCCNC);
     1928    17758    4           CALL YESNO(KH$CHN.INP,CHNTBL.INP);
     1929    17759    4           CALL YESNO(KH$CHN.OTP,CHNTBL.OTP);
     1930    17760    4           CALL YESNO(KH$CHN.DWNLOD,CHNTBL.DWNLOD);
     1931    17761    4           CHNTBL.INPCCBCNT=KH$CHN.INPCCBCNT;
     1932    17762    4           CALL YESNO(KH$CHN.RE_ENB,CHNTBL.RE_ENB);
     1933    17763    4           CALL YESNO(KH$CHN.ENB,CHNTBL.ENB);
     1934    17764    4           CALL YESNO(KH$CHN.CTR,CHNTBL.CTR);
     1935    17765    4           CHNTBL.CTR_DWNLD = BITBIN(KH$CHN.CCPDWNLD);
     1936    17766    4           CHNTBL.OTPCCBCNT=KH$CHN.OTPCCBCNT;
     1937    17767    4           CHNTBL.LCT55=KH$CHN.LCT55.BYT;
     1938    17768    4           CALL YESNO(KH$CHN.INPCCBSTTPTRVLD,CHNTBL.INPCCBSTTPTRVLD);
     1939    17769    4           CALL YESNO(KH$CHN.OTPCCBSTTPTRVLD,CHNTBL.OTPCCBSTTPTRVLD);
     1940    17770    4           CALL YESNO(KH$CHN.DRPDTR,CHNTBL.DRPDTR);
     1941    17771    4           CALL YESNO(KH$CHN.AUTBAD,CHNTBL.AUTBAD);
     1942    17772    4           CHNTBL.LINSPD=LINESPEED(KH$CHN.LINSPD);
     1943    17773    4           CALL YESNO(KH$CHN.BUG,CHNTBL.BUG);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:66   
     1944    17774    4           CALL YESNO(KH$CHN.DC1DC3NTWOTPFLWCTR,CHNTBL.DC1DC3NTWOTPFLWCTR);
     1945    17775    4           CALL YESNO(KH$CHN.DSBHSTDWN,CHNTBL.DSBHSTDWN);
     1946    17776    4           CALL YESNO(KH$CHN.KLLHSTDWN,CHNTBL.KLLHSTDWN);
     1947    17777    4           CALL YESNO(KH$CHN.ENBHSTUP,CHNTBL.ENBHSTUP);
     1948    17778    4           CALL YESNO(KH$CHN.SNDSLT,CHNTBL.SNDSLT);
     1949    17779    4           CALL YESNO(KH$CHN.ECHLGN,CHNTBL.ECHLGN);
     1950    17780    4           CALL YESNO(KH$CHN.DED,CHNTBL.DED);
     1951    17781    4           CHNTBL.REDTIMOUTPRD = KH$CHN.REDTIMOUTPRD.BYT;
     1952    17782    4           CHNTBL.LGNTIMOUTPRD=KH$CHN.LGNTIMOUTPRD.BYT;
     1953    17783    4           CHNTBL.TPTIMOUTPRD=KH$CHN.TPTIMOUTPRD.BYT;
     1954    17784    4           CALL KSU$PACK2(KH$CHN.INPBFRBYTSIZ,CHNTBL.INPBFRBYTSIZ);
     1955    17785    4           CALL KSU$PACK4(KH$CHN.CTX$,CHNTBL.CTX$);
     1956    17786    4           CALL KSU$PACK4(KH$CHN.INTCNT,CHNTBL.INTCNT);
     1957    17787    4           CALL KSU$PACK2(KH$CHN.BLOCK,CHNTBL.BLOCK);
     1958    17788    4           CALL KSU$PACK2(KH$CHN.UNBLOCK,CHNTBL.UNBLOCK);
     1959    17789    4           CALL KSU$PACK2(KH$CHN.TERMID.TERM.CHANNEL,CHNTBL.TERMID.CHANNEL);
     1960    17790    4           CALL KSU$PACK2(KH$CHN.TERMID.TERM.SUBDEVICE,CHNTBL.TERMID.SUBDEVICE);
     1961    17791    4           CALL KSU$PACK2(KH$CHN.TERMID.TERM.SUBSUBDEVICE,CHNTBL.TERMID.SUBSUBDEVICE);
     1962    17792    4           CHNTBL.TERMID.TERM_NAME=KH$CHN.TERMID.TERM.TERM_NAME;
     1963    17793    4           CHNTBL.TERMID.TTYP=DB_CHNTBL_TTYPS(KH$CHN.TERMID.TTYP);
     1964    17794    4           CHNTBL.TERMID.LEV=KH$CHN.TERMID.LEV;
     1965    17795    4           CALL KSU$PACK4(KH$CHN.SUB$,CHNTBL.SUB$);
     1966    17796    4           CALL KSU$PACK4(KH$CHN.LNK$,CHNTBL.LNK$);
     1967    17797    4           CALL KSU$PACK4(KH$CHN.HAND$,CHNTBL.HAND$);
     1968    17798
     1969    17799    4                              CALL KSW$WRITE(VECTOR(CHNFMT),VECTOR(CHNTBL));
     1970    17800    4                           END;  /*CHAN_DISP_FULL*/
     1971    17801    3                        ELSE
     1972    17802    4                           DO;
     1973    17803    4                              IF NOT HDR_FLAG THEN
     1974    17804    5                                 DO;
     1975    17805    5                                    CALL KSW$WRITE(VECTOR(CHN_HDR_FMT_1));
     1976    17806    5                                    CALL KSW$WRITE(VECTOR(CHN_HDR_FMT_2));
     1977    17807    5                                    HDR_FLAG = '1'B;
     1978    17808    5                                 END;
     1979    17809
     1980    17810                                   %ARRAY_TO_WORD(S="KH$CHN.DVCID",D="CHNTBL_SUM.DVCID");
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:67   
     1981    17822                                   %ARRAY_TO_WORD(S="KH$CHN.TERMID.TERM.CHANNEL",D=
             17822                                       "CHNTBL_SUM.CHANNEL");
     1982    17834                                   %ARRAY_TO_WORD(S="KH$CHN.EXTDVCID",D=
             17834                                       "CHNTBL_SUM.EXTDVCID");
     1983    17846                                   %ARRAY_TO_WORD(S="KH$CHN.ATTR",D="CHNTBL_SUM.ATTR");
     1984    17858                                   %CHN_T_F(R="SNDSLT",D="CHNTBL_SUM.SNDSLT");
     1985    17864                                   %CHN_T_F(R="INP",D="CHNTBL_SUM.INP");
     1986    17870                                   %CHN_T_F(R="OTP",D="CHNTBL_SUM.OTP");
     1987    17876                                   %CHN_T_F(R="DWNLOD",D="CHNTBL_SUM.DWNLOD");
     1988    17882                                   %CHN_T_F(R="ENB",D="CHNTBL_SUM.ENB");
     1989    17888    4                              CHNTBL_SUM.STT = STATE(KH$CHN.STT.BYT);
     1990    17889
     1991    17890    4                              CHNTBL_SUM.INPCCBCNT = KH$CHN.INPCCBCNT;
     1992    17891    4                              CHNTBL_SUM.OTPCCBCNT = KH$CHN.OTPCCBCNT;
     1993    17892    4                              CHNTBL_SUM.REDTIMOUTPRD = KH$CHN.REDTIMOUTPRD.BYT;
     1994    17893    4                              CHNTBL_SUM.LGNTIMOUTPRD = KH$CHN.LGNTIMOUTPRD.BYT;
     1995    17894                                   %PACK4(S="KH$CHN.CTX$",D="CHNTBL_SUM.CTX$");
     1996    17912                                   %CHN_T_F(R="DRPDTR",D="CHNTBL_SUM.DRPDTR");
     1997    17918    4                              CHNTBL_SUM.RESOURCE = KH$CHN.RESOURCE;
     1998    17919                                   %CHN_T_F(R="DRCCNC",D="CHNTBL_SUM.DRCCNC");
     1999    17925    4                              CALL KSW$WRITE(VECTOR(CHN_DAT_FMT),
     2000    17926    4                                             VECTOR(CHNTBL_SUM));
     2001    17927    4                           END;  /*DISPLAY SUMMARY CHANTBL ENTRY*/
     2002    17928    3                     END;  /*DISPLAY CHANTBL ENTRY*/
     2003    17929    2        END DISPLAY_CHAN;
     2004    17930    1   END KSC$DISPLAY;
     2005    17931        %EOD;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:68   
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$DISPLAY.

   Procedure KSC$DISPLAY requires 4998 words for executable code.
   Procedure KSC$DISPLAY requires 306 words of local(AUTO) storage.

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:69   

 Object Unit name= KSC$DISPLAY                                File name= KSC$COMMANDS2.:E05TOU
 UTS= JUL 30 '97 01:42:12.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS   1514   2752  KSC$DISPLAY
    2   Data  even  none  3420   6534  KSC$DISPLAY
    3   DCB   even  none     0      0  M$NETCON
    4   Proc  even  none  4998  11606  KSC$DISPLAY
    5  RoData even  none   337    521  KSC$DISPLAY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  KSC$DISPLAY

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1   2505  DB_CHNTBL_TTYPS
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:70   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      11 KSW$WRITE
 yes     yes           Std       1 KSR$RD_HLPCG
         yes           Std       5 KSU$BLD_KL_CONTROL
 yes     yes           Std       2 KSU$CHK_TRM_RNG
         yes           Std       2 KSU$PACK2
 yes     yes           Std       2 KSU$READ_NETCON
         yes           Std       4 KSE$ERRMSG
 yes     yes           Std       1 KSR$WR_HLPCG
 yes     yes           Std       3 KSU$BLD_TERMID
         yes           Std       2 KSU$UNPACK
         yes           Std       2 KSU$HEXBIN
         yes           Std       2 KSU$PACK4
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODENAME
     KS_SELPRMOPT                          KS_NODE                               KS_NODENAME_SV
     KS_NODE_SV                            KS_HNDLRNAME                          KS_HNDLRINDX
     KS_ERRCODE                            KS_MSGBUF                             KS_MSGBUF$
     KS_SUB_BUF_1                          KS_SUB_BUF_2                          B$TCB$
     KS_TBL                                KS_HAND_INFO                          M$NETCON
     B_VECTNIL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:71   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:72   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        KSC$DISPLAY: PROC(TOP$) ALTRET;

      6  4 000000   000000 700200 xent  KSC$DISPLAY  TSX0  ! X66_AUTO_1
         4 000001   000462 000001                    ZERO    306,1

        7        7        /**/
        8        8    1   DCL TOP$ PTR;
        9        9        /**/
       10       10        %INCLUDE CP_6;
       11       91        %INCLUDE CP_6_SUBS;
       12      631        %INCLUDE KL_MACRO_C;
       13     3983        %INCLUDE KS_MACRO_M;
       14     4180        %INCLUDE KS_SUBS_C;
       15     4423        %INCLUDE KS_DATA_R;
       16     4438        %INCLUDE KS_PERR_C;
       17     4505        %INCLUDE KL_CONTROL_C;
       18     4885        %INCLUDE KL_AFCN_C;
       19     4986        %INCLUDE KL_CONFIG_M;
       20     5748        %INCLUDE GI_BOOT_C;
       21     5859        %INCLUDE XU_MACRO_C;
       22     8965        %INCLUDE KH$CHN;
       23     9087        %INCLUDE B_ERRORS_C;
       24    10214        %INCLUDE KHA_FNC_E;
       25    10314        %INCLUDE F$DCB;
       26    10363        %INCLUDE KL_SUPER_C;
       27    13265        /**/
       28    13266        %KS$BOX(TITLE="entry defs");

             13284    1   /***************************************************************************
             13285    1    *                                                                         *
             13286    1    *                                 entry defs                              *
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:73   
             13287    1    *                                                                         *
             13288    1    ***************************************************************************/

       29    13293    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
       30    13294    1   DCL KSE$ERRMSG ENTRY(4);
       31    13295    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
       32    13296    1   DCL KSU$HEXBIN ENTRY(2);
       33    13297    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
       34    13298    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
       35    13299    1   DCL KSW$WRITE ENTRY(11);
       36    13300    1   DCL KSU$PACK2 ENTRY(2);
       37    13301    1   DCL KSU$PACK4 ENTRY(2);
       38    13302    1   DCL KSU$UNPACK ENTRY(2);
       39    13303    1   DCL KSU$BLD_KL_CONTROL ENTRY(5);
       40    13304    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
       41    13305        %KS$BOX(TITLE="symref variables");

             13323    1   /***************************************************************************
             13324    1    *                                                                         *
             13325    1    *                              symref variables                           *
             13326    1    *                                                                         *
             13327    1    ***************************************************************************/

       42    13332    1   DCL B$TCB$ PTR SYMREF;
       43    13333    1   DCL KS_TBL(0:0) PTR SYMREF;
       44    13334        %KS$HAND_INFO (NAME=KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF",LAST=YES);
       45    13373        %KS$BOX(TITLE="symdef variables");

             13391    1   /***************************************************************************
             13392    1    *                                                                         *
             13393    1    *                              symdef variables                           *
             13394    1    *                                                                         *
             13395    1    ***************************************************************************/

       46    13400        %KS$BOX(TITLE="constant variables",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:74   
             13418    1   /***************************************************************************
             13419    1    *                                                                         *
             13420    1    *                             constant variables                          *
             13421    1    *                                                                         *
             13422    1    ***************************************************************************/

       47    13427    1   DCL TEXT_NODETYPE(0:5) CHAR(4) CONSTANT INIT(' ','Host','Fep','Me','Debg','Rfep');
       48    13428    1  DCL BOOTFID_FMT CHAR(0) CALIGNED CONSTANT INIT('%/Monitor Fid: %A%/Library: %A%10P')
             13428            ;
       49    13429    1   DCL BOOTFID_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(BOOTFID_FMT));
       50    13430        /*
       51    13431          Variable declarations necessary for the CHANNEL table display
       52    13432          from the FEP.
       53    13433        */
       54    13434
       55    13435
       56    13436    1        DCL CHN_HDR_FMT_1 CHAR(0) CONSTANT INIT(
             13436           'DEV  DEV  EXT        CTX            DRC DRP DWN            SND CCB LGN RED%10P'
             13436                 );
       57    13437    1        DCL CHN_HDR_FMT_2 CHAR(0) CONSTANT INIT(
             13437           'ADDR ID   ID   ATTR  PTR  RS STATUS CNC DTR LD  ENB INP OTP SLT I O TO TO %10P'
             13437                 );
       58    13438    1        DCL CHN_DAT_FMT CHAR(0) CONSTANT
       59    13439    1               INIT('%4H%X%4H%X%4H%X%4H%X%5H%X%2A%2X%4A%2X%3A%X%3A%X%3A%X%3A%X%3A%X%3A
             13439        %X%3A%1S%X%1D%X%1D%X%3D%X%3D%10P');
       60    13440    1        DCL CHAN_HD_FUL_FMT CHAR(0) CALIGNED CONSTANT INIT(
             13440                 '%/%20- Channel #%LH-%D-%D on Node %LD(%LA%10P)');
       61    13441    1        DCL CHAN_HD_FUL_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CHAN_HD_FUL_FMT));
       62    13442
       63    13443        /*
       64    13444                format and vector necessary for pseudo displays
       65    13445        */
       66    13446
       67    13447    1   DCL PSEUDO_NME_FMT CHAR(0) CONSTANT INIT(
             13447            'Name: %A%/%5XMax Ghost = %LD%/%5XMax Handler = %LD%10P');
       68    13448    1   DCL PSEUDO_NME_VEC VECTOR CONSTANT DALIGNED INIT(VECTOR(PSEUDO_NME_FMT));
       69    13449    1   DCL PSEUDO_USR_FMT CHAR(0) CONSTANT INIT(
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:75   
             13449            '%5XMax CG = %LD%/%5XMax User = %LD%/%5XMax System = %LD%10P');
       70    13450    1   DCL PSEUDO_USR_VEC VECTOR CONSTANT DALIGNED INIT(VECTOR(PSEUDO_USR_FMT));
       71    13451        /*
       72    13452             format and vectors for status display
       73    13453        */
       74    13454    1   DCL KS_NETSTAT CHAR(0) CONSTANT INIT('NETWORK STATUS');
       75    13455    1   DCL NET_STAT_FMT CHAR(0) CONSTANT INIT('%/%33- %A%10P %/%33- ______________');
       76    13456    1   DCL NET_STAT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(NET_STAT_FMT));
       77    13457    1   DCL NODE_FMT CHAR(0) CONSTANT INIT('%2/%5- Node # %LD Node Name = %LA%10P');
       78    13458    1   DCL NODE_VEC BIT(72) DALIGNED CONSTANT INIT(VECTOR(NODE_FMT));
       79    13459    1   DCL HST_FMT CHAR(0) CONSTANT INIT ('%/%10- Host..........................%LA%10P');
       80    13460    1   DCL HST_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(HST_FMT));
       81    13461    1   DCL ACTV_FMT CHAR(0) CONSTANT INIT('%10- Active........................%LA%10P');
       82    13462    1   DCL ACTV_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(ACTV_FMT));
       83    13463    1   DCL CN_FMT CHAR(0) CONSTANT INIT('%10- Current Node..................%LA%10P');
       84    13464    1   DCL CN_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CN_FMT));
       85    13465    1   DCL QOS_FMT CHAR(0) CONSTANT INIT('%10- Quality of Service............%D%10P');
       86    13466    1   DCL QOS_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(QOS_FMT));
       87    13467    1   DCL ALT_FMT CHAR(0) CONSTANT INIT('%10- Alt Quality of Service........%D%10P');
       88    13468    1   DCL ALT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(ALT_FMT));
       89    13469    1   DCL LNKNME_FMT CHAR(0) CONSTANT INIT('%10- Link Node Name................%LA%10P');
       90    13470    1   DCL LNKNME_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNKNME_FMT));
       91    13471    1   DCL LNKNUM_FMT CHAR(0) CONSTANT INIT('%10- Link Node Number..............%LD%10P');
       92    13472    1   DCL LNKNUM_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNKNUM_FMT));
       93    13473    1  DCL LNKCNCT_FMT CHAR(0) CONSTANT INIT('%10- Link Connected................%LA%10P');
       94    13474    1   DCL LNKCNCT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNKCNCT_FMT));
       95    13475    1   DCL BLK_FMT CHAR(0) CONSTANT INIT('%T %2X (%2P%D%3P) %25- %D%10P');
       96    13476    1   DCL SHORT_HDR_FMT CHAR(0) CONSTANT INIT('%A%10P');
       97    13477    1   DCL SHORT_LINE_FMT CHAR(0) CALIGNED CONSTANT INIT('  Node %LD(%LA) %LA%10P');
       98    13478    1   DCL SHORT_LINE_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(SHORT_LINE_FMT));
       99    13479    1   DCL SHORT_HDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(SHORT_HDR_FMT));
      100    13480        /*
      101    13481                       formats and vectors for boot display
      102    13482        */
      103    13483    1   DCL NHNDLR_FMT CHAR(0) CONSTANT INIT('Number of Handlers = %D%10P');
      104    13484    1   DCL NHNDLR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(NHNDLR_FMT));
      105    13485    1   DCL HNDLR_FMT CHAR(0) CONSTANT INIT('%5-%3D%4X%8A%2X%3A%3X%A%10P');
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:76   
      106    13486    1   DCL HNDLR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(HNDLR_FMT));
      107    13487    1   DCL PSEUDO_FMT CHAR(0) CONSTANT INIT('%8A%10P');
      108    13488    1   DCL PSEUDO_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(PSEUDO_FMT));
      109    13489        /*
      110    13490                        formats and vectors for param displays
      111    13491        */
      112    13492    1   DCL PARAM_FMT CHAR(0) CONSTANT INIT('%T %15- %2P%D%10P');
      113    13493    1   DCL PARAM_USRPRM_FMT CHAR(0) CONSTANT INIT('%T %2X (%2P%D%3P) %25- %D %10P');
      114    13494    1   DCL PARAM_CHAR_FMT CHAR(0) CONSTANT INIT('%T %15- %2P%A%10P');
      115    13495    1   DCL PARAM_HEX_FMT CHAR(0) CONSTANT INIT('%T %15- %2P%H%10P');
      116    13496    1   DCL USRPARM_HDR_FMT CHAR(0) CONSTANT INIT('%/%T%1.1=%8(%7X%.1#KD%1:1#+.1=%)%2Q');
      117    13497    1   DCL CURRENT_FMT CHAR(0) CONSTANT INIT('%\CURRENT%2Q');
      118    13498    1   DCL USRPARM_ENTRY_FMT CHAR(0) CONSTANT INIT('%\%N.1=%3X%5.16@D%1#:7?[%/%]%2Q');
      119    13499    1   DCL USRPARM_NETCON_FMT CHAR(0) CONSTANT INIT(':NETCON %2.18NP%8(%3X%5.18D%)%2Q');
      120    13500    1   DCL BLOCK_HDR_FMT CHAR(0) CONSTANT INIT (
             13500            '%/%T%10-%.18D%2S%2X%.18D%2S%13(%X%.18D%2S%)%X19.2%2Q');
      121    13501    1   DCL BLOCK_ENTRY_FMT CHAR(0) CONSTANT INIT(
             13501            '%\%N.1=%1#:8?.:1-[ %3.16@D%? %4.16@D%]%1#:15?[%/%]%2Q');
      122    13502    1   DCL BLOCK_NETCON_FMT CHAR(0) CONSTANT INIT(
             13502            ':NETCON%2.18NP%8( %3.18D%)%8( %4.18D%)%2Q');
      123    13503    1   DCL BLOCK_DEFAULT_FMT CHAR(0) CONSTANT INIT(
             13503            'DEFAULT%8(%14S %3.18D%)%8(%14S %4.18D%)%2Q');
      124    13504        /*
      125    13505                          format and vectors for network display
      126    13506        */
      127    13507    1   DCL  1  NETWORK_FMT CONSTANT ALIGNED,
      128    13508    1           2 * CHAR(0) INIT ('%1N.0=%2P%N.1=%.7C                    %C'),
      129    13509    1          2 * CHAR(0) INIT('%0#.1[Node#%7-Name%19-Type%26-Host%35-Route%44-Links%/%]')
             13509                    ,
      130    13510    1           2 * CHAR(0) INIT('%3.1#KD'),
      131    13511    1           2 * CHAR(0) INIT('%7-%5:1#*.2=%3.2:2#+P%8A'),
      132    13512    1           2 * CHAR(0) INIT('%19-%4.1:2#+P%N.3=%5.3#P%4A'),
      133    13513    1           2 * CHAR(0) INIT('%26-%3.4:2#+P%8A'),
      134    13514    1           2 * CHAR(0) INIT(
             13514                    '%35-%6P%N.4=%4#:1#-.0[Local%?%3#.3[  %?%4#.0[None%?%3.4#KD%]%]%]'),
      135    13515    1           2 * CHAR(0) INIT('%44-%7P%N.5=%5#(.%4.18LY   %)'),
      136    13516    1           2 * CHAR(0) INIT('%/%2Q');
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:77   
      137    13517    1   DCL NETWORK_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(NETWORK_FMT));
      138    13518    1   DCL PSEUDOHDR_FMT CHAR(0) CONSTANT INIT('Currently defined Pseudos:%10P');
      139    13519    1   DCL PSEUDOHDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(PSEUDOHDR_FMT));
      140    13520    1   DCL BOOTHDR_FMT CHAR(0) CONSTANT INIT('%/Boot Information for Node %8A%10P');
      141    13521    1   DCL HNDLRHDR_FMT CHAR(0) CONSTANT INIT('%/%5-user#  name      boot  fid %10P');
      142    13522    1   DCL LIBACCT_FMT CHAR(0) CONSTANT INIT('Library account = %8A%10P');
      143    13523    1   DCL LIBACCT_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LIBACCT_FMT));
      144    13524        /*
      145    13525        Format and related format definition for link display
      146    13526        */
      147    13527    1   DCL LINK_FMT CHAR(0) CONSTANT INIT('%/Link information for node %8A%10P');
      148    13528    1   DCL LINK_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LINK_FMT));
      149    13529    1   DCL LINKCHAN_FMT CHAR(0) CONSTANT INIT('%5X Number of links = %D%10P');
      150    13530    1   DCL LINKCHAN_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LINKCHAN_FMT));
      151    13531    1   DCL HNDLRHDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(HNDLRHDR_FMT));
      152    13532    1   DCL BOOTHDR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(BOOTHDR_FMT));
      153    13533    1   DCL CHAN_FMT CHAR(0) CONSTANT INIT('%8X Link# %D = .%LY%10P');
      154    13534    1   DCL CHAN_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(CHAN_FMT));
      155    13535        /*
      156    13536                      formats and vectors for default and config displays
      157    13537        */
      158    13538    1   DCL DIHNDLR_FMT CHAR(0) CONSTANT INIT(
             13538            '%/Default Configuration information for Handler %>A on Node# %LD (%>A%10P)');
      159    13539    1   DCL LNCNFG_FMT CHAR(0) CALIGNED CONSTANT INIT(
             13539         '%/Line Configuration for Node# %LD (%>A) Channel# .%LH-%D-%D Terminal id %>A%10P'
             13539            );
      160    13540    1   DCL DIHNDLR_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(DIHNDLR_FMT));
      161    13541    1   DCL LNCNFG_VEC BIT(72) CONSTANT DALIGNED INIT(VECTOR(LNCNFG_FMT));
      162    13542        /*
      163    13543                format table for config display.
      164    13544        */
      165    13545    1   DCL 1 CONFIG_FMT CONSTANT ALIGNED,
      166    13546    1        2 * CHAR(0) INIT('%N.0=%.26-        '),
      167    13547    1        2 * CHAR(0) INIT(
             13547         '%.7C%-%:10-X%2N:6=.1[%:1-X%0#.1[%10#:1+.11#.12#.13#P%2N.6=(%3C)%?(  )%]%?%3C%]%C'
             13547                 ),
      168    13548    1        2 * CHAR(0) INIT('%.3C%6#.2[Yes%? No%]%C'),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:78   
      169    13549    1        2 * CHAR(0) INIT('%.5C%-%:12-X%5.16@D%C'),
      170    13550    1    2 * CHAR(0) INIT('%.4C%-%:12-X%16+@N.:1-[%:1-X%0#.1[%10#:1+.11#.12#.13#P%16+@N.9=%
             13550        22C%?  (   )%]%?%10#.11#.12#.13#P%5C%]%C'),
      171    13551    1        2 * CHAR(0) INIT(
             13551        '%.22C%-%:13-X%9#:1000?.:1-[ (%3.9#KD)%?%9#:10000?.:1-[ (%4.9#KD)%?(%5.9#KD)%]%]%C'
             13551                 ),
      172    13552    1     2 * CHAR(0) INIT(
             13552        '%.35C%34#.0.2.5P%2N.2[%-%:11-X%34#.2[Auto%?:%:2-X(Auto)%]%?%34#.4P%16+@N:29=.:1-['
             13552              ),
      173    13553    1     2 * CHAR(0) INIT('%0#.1[%3.34=%35C%?%-%:11-X(  )%]%?%4.29#P%34#.2[%-%:12-X%5.18D%
             13553        ?%18N.9=%22C%]%]%]%C'),
      174    13554    1        2 * CHAR(0) INIT('%/Logon:%-%:12-X%2.4.2.5P%2N.2[%2.10.2P%T%?None%]%/'),
      175    13555    1        2 * CHAR(0) INIT('Profile:%-%:12-X%2.4.3.5P%2N.2[%2.7.2P%T%?%:1-X'),
      176    13556    1        2 * CHAR(0) INIT(
             13556                 '%0#.1[%3.4.3.5P%2N.2[%3.7.2P(%T)%?(None)%]%?%0#.2[ None%?(    )%]%]%]'),
      177    13557    1     2 * CHAR(0) INIT('%0#.1[%-%-%:1-X%5P(With %>A defaults)%]%2/'),
      178    13558    1       2 * CHAR(0) INIT('%RAttribute:%-%:12-X%2.4.3.2P%1N.1[%2.5.2P.%4.16@ZH%?%:1-X'),
      179    13559    1    2 *CHAR(0) INIT(
             13559         '%0#.1[%3.4.3.2P%1N.1[%3.5.2P(.%4.16@ZH)%? (None)%]%?%0#.2[  None%?  (  )%]%]%]%-'
             13559             ),
      180    13560    1        2 * CHAR(0) INIT('%RBlock:%2:10=.3:11=.0:12=.0:13=P%4C%-'),
      181    13561    1        2 * CHAR(0) INIT('%RBreak Req:%2:10=.0:11=.0:12=.7:13=P%7C%-'),
      182    13562    1        2 * CHAR(0) INIT('%RBuffer size:%2:10=.1:11=.0:12=.0:13=P%4C%-'),
      183    13563    1     2 * CHAR(0) INIT('%RClock:%2:10=.0:11=.1:12=.5:13=P%7C%-'),
      184    13564    1     2 * CHAR(0) INIT('%RDebug:%2:10=.0:11=.2:12=.1:13=P%7C%-'),
      185    13565    1     2 * CHAR(0) INIT('%RDsb hst dwn:%2:10=.0:11=.3:12=.1:13=P%7C%-'),
      186    13566    1     2 * CHAR(0) INIT('%RDrop DTR:%2:10=.0:11=.1:12=.7:13=P%7C%-'),
      187    13567    1     2 * CHAR(0) INIT('%REcho Logon:%2:10=.4:11=.2:12=.3:13=P%7C%-'),
      188    13568    1     2 * CHAR(0) INIT('%REnable:%2:10=.0:11=.2:12=.7:13=P%7C%-'),
      189    13569    1     2 * CHAR(0) INIT('%RFlow cntrl:%2:10=.0:11=.0:12=.1:13=P%7C%-'),
      190    13570    1     2 * CHAR(0) INIT('%RHard wired:%2:10=.0:11=.1:12=.3:13=P%7C%-'),
      191    13571    1     2 * CHAR(0) INIT('%RInput:%2:10=.0:11=.0:12=.3:13=P%7C%-'),
      192    13572    1     2 * CHAR(0) INIT('%RKill hst dwn:%2:10=.0:11=.3:12=.3:13=P%7C%-'),
      193    13573    1     2 * CHAR(0) INIT('%RLgn timeout:%2:10=.5:11=.0:12=.0:13=P%4C%-'),
      194    13574    1     2 * CHAR(0) INIT('%ROutput:%2:10=.0:11=.0:12=.5:13=P%7C%-'),
      195    13575    1     2 * CHAR(0) INIT('%RReadtimeout:%2:10=.2:11=.0:12=.0:13=P%4C%-'),
      196    13576    1     2 * CHAR(0) INIT('%RRe-enable:%2:10=.0:11=.1:12=.1:13=P%7C%-'),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:79   
      197    13577    1     2 * CHAR(0) INIT('%RResource:%-%:9-X%2.4.3.1P%1N.1[%2.6.0P%2A%?%:1-X'),
      198    13578    1    2 *CHAR(0) INIT(
             13578          '%0#.1[%3.4.3.1P%1N.1[%3.6.0P(%2A)%?%:2-X(None)%]%?%:1-X%0#.2[None%?(  )%]%]%]%-'
             13578             ),
      199    13579    1     2 * CHAR(0) INIT('%RSend Sal:%2:10=.4:11=.2:12=.1:13=P%7C%-'),
      200    13580    1     2 * CHAR(0) INIT('%RSpeed:%2.34=%35C%-'),
      201    13581    1     2 * CHAR(0) INIT('%RTP timeout:%2:10=.2:11=.2:12=.0:13=P%4C%-'),
      202    13582    1     2 * CHAR(0) INIT('%RUnblock:%2:10=.3:11=.2:12=.0:13=P%4C%-'),
      203    13583    1    2 * CHAR(0) INIT('%2Q');
      204    13584
      205    13585        /*
      206    13586                   format table for channel table display
      207    13587        */
      208    13588    1   DCL 1 CHNFMT CONSTANT,
      209    13589    1         2 * CHAR(0) INIT('%!'),
      210    13590    1         2 * CHAR(0) INIT(
             13590                  'Termid:  .%H-%D-%D%26-Lev: %D%34-Ttyp: %4>A%51-Trm name: %8>A%2/'),
      211    13591    1         2 * CHAR(0) INIT('Attributes:  .%4ZH%26-'),
      212    13592    1         2 * CHAR(0) INIT('Echo Logon:   %4A%51-'),
      213    13593    1         2 * CHAR(0) INIT('Logon Failed: %4A%/'),
      214    13594    1         2 * CHAR(0) INIT('Autobaud:     %4A%26-'),
      215    13595    1         2 * CHAR(0) INIT('Enable:       %4A%51-'),
      216    13596    1         2 * CHAR(0) INIT('Ntwk flw ctr: %4A%/'),
      217    13597    1         2 * CHAR(0) INIT('Autologon:    %4A%26-'),
      218    13598    1         2 * CHAR(0) INIT('Enb hst up:   %4A%51-'),
      219    13599    1         2 * CHAR(0) INIT('Otp ccb cnt:  %4D%/'),
      220    13600    1         2 * CHAR(0) INIT('Block:       %5D%26-'),
      221    13601    1         2 * CHAR(0) INIT('Ext Dev Id:  .%4ZH%51-'),
      222    13602    1         2 * CHAR(0) INIT('Otp stt vld:  %4A%/'),
      223    13603    1         2 * CHAR(0) INIT('Break Requird:%4A%26-'),
      224    13604    1         2 * CHAR(0) INIT('First Device: %4A%51-'),
      225    13605    1         2 * CHAR(0) INIT('Output:       %4A%/'),
      226    13606    1         2 * CHAR(0) INIT('Bug:          %4A%26-'),
      227    13607    1         2 * CHAR(0) INIT('Hand$       .%5ZH%51-'),
      228    13608    1         2 * CHAR(0) INIT('Profile:      %4A%/'),
      229    13609    1         2 * CHAR(0) INIT('CCP loaded:   %4ZB%26-'),
      230    13610    1         2 * CHAR(0) INIT('Inp bfr sz:   %4D%51-'),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:80   
      231    13611    1         2 * CHAR(0) INIT('Re-enable:    %4A%/'),
      232    13612    1         2 * CHAR(0) INIT('Clock:        %4A%26-'),
      233    13613    1         2 * CHAR(0) INIT('Inp ccb cnt:  %4D%51-'),
      234    13614    1         2 * CHAR(0) INIT('Read Timeout: %4D%/'),
      235    13615    1         2 * CHAR(0) INIT('Context:    .%5ZH%26-'),
      236    13616    1         2 * CHAR(0) INIT('Inp stt vld:  %4A%51-'),
      237    13617    1         2 * CHAR(0) INIT('Remote Host:  %4A%/'),
      238    13618    1         2 * CHAR(0) INIT('Dead:         %4A%26-'),
      239    13619    1         2 * CHAR(0) INIT('Input:        %4A%51-'),
      240    13620    1         2 * CHAR(0) INIT('Resource:     %4A%/'),
      241    13621    1         2 * CHAR(0) INIT('Debug:        %4A%26-'),
      242    13622    1         2 * CHAR(0) INIT('Int count: %7D%51-'),
      243    13623    1         2 * CHAR(0) INIT('Send sal:     %4A%/'),
      244    13624    1         2 * CHAR(0) INIT('Device Id:   .%4ZH%26-'),
      245    13625    1         2 * CHAR(0) INIT('Kll hst dn:   %4A%51-'),
      246    13626    1         2 * CHAR(0) INIT('State:        %4A%/'),
      247    13627    1         2 * CHAR(0) INIT('Direct cnnct: %4A%26-'),
      248    13628    1         2 * CHAR(0) INIT('Lct55:         .%2ZH%51-'),
      249    13629    1         2 * CHAR(0) INIT('Sub$:       .%5ZH%/'),
      250    13630    1         2 * CHAR(0) INIT('Dnld ccp:     %4A%26-'),
      251    13631    1         2 * CHAR(0) INIT('Lgn Timeout:  %4D%51-'),
      252    13632    1         2 * CHAR(0) INIT('Sysid         %4D%/'),
      253    13633    1         2 * CHAR(0) INIT('Drop DTR:     %4A%26-'),
      254    13634    1         2 * CHAR(0) INIT('Line Speed:  %5D%51-'),
      255    13635    1         2 * CHAR(0) INIT('TP Timeout:   %4D%/'),
      256    13636    1         2 * CHAR(0) INIT('Dsb hst dn:   %4A%26-'),
      257    13637    1         2 * CHAR(0) INIT('Lnk$:       .%5ZH%51-'),
      258    13638    1         2 * CHAR(0) INIT('Unblock:     %5D%2/%10P');
      259    13639
      260    13640    1   DCL LINESPEED(0:15) UBIN HALF CONSTANT INIT(50,75,110,134,150,200,300,600,1050,
      261    13641    1                                               1200,1800,2000,2400,4800,9600,19200);
      262    13642
      263    13643        %SET STTNDX=0;
      264    13644        %MACRO NXTSTT (STT=0, TXT=, LAST(YES=");",NO=",")=",");
      265    13645        %ERROR (STT~=STTNDX,'*** State table out of order');
      266    13646           %TEXTCHAR(TXT)LAST
      267    13647        %SET STTNDX=STTNDX+1;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:81   
      268    13648        %MEND;
      269    13649
      270    13650    1   DCL STATE(0:%KH#CHN_STT_HI) CONSTANT CHAR(4) INIT(
      271    13651        %NXTSTT (STT=KH#CHN_STT_UN_INT, TXT=Uint);
      272    13656        %NXTSTT (STT=KH#CHN_STT_BSY, TXT=Busy);
      273    13661        %NXTSTT (STT=KH#CHN_STT_BSYDSBPND, TXT=BDsb);
      274    13666        %NXTSTT (STT=KH#CHN_STT_BSYPRTPND, TXT=BPrt);
      275    13671        %NXTSTT (STT=KH#CHN_STT_DSB, TXT=Dsab);
      276    13676        %NXTSTT (STT=KH#CHN_STT_ENB, TXT=Enab);
      277    13681        %NXTSTT (STT=KH#CHN_STT_PRT, TXT=Part);
      278    13686        %NXTSTT (STT=KH#CHN_STT_LINPROPND_ENB, TXT=ProE);
      279    13691        %NXTSTT (STT=KH#CHN_STT_LINPROPND_BSY, TXT=ProB);
      280    13696        %NXTSTT (STT=KH#CHN_STT_LINPROPND_BSYDSBPND, TXT=PrBD);
      281    13701        %NXTSTT (STT=KH#CHN_STT_NTRDY, TXT=Nrdy);
      282    13706        %NXTSTT (STT=KH#CHN_STT_DIAG, TXT=Diag);
      283    13711        %NXTSTT (STT=KH#CHN_STT_RMTDBG, TXT=Rdbg, LAST=YES);
      284    13716        %SET NXTTYP=0;
      285    13717        %MACRO NXTTXT(TYP=0,TXT=,LAST(YES=");")=",");
      286    13718        %ERROR(TYP~=NXTTYP,'*** Table out of order');
      287    13719        %TEXTCHAR(TXT)LAST
      288    13720        %SET NXTTYP=NXTTYP+1;
      289    13721        %MEND;
      290    13722    1   DCL DB_CHNTBL_TTYPS(0:10) CONSTANT SYMDEF CHAR(4) INIT(
      291    13723        %NXTTXT(TYP=KLTY_PROG#,TXT=PROG);
      292    13728        %NXTTXT(TYP=KLTY_SDEV#,TXT=SDEV);
      293    13733        %NXTTXT(TYP=KLTY_TTY#,TXT=TTY);
      294    13738        %NXTTXT(TYP=KLTY_STRM#,TXT=STRM);
      295    13743        %NXTTXT(TYP=KLTY_LINK#,TXT=LINK);
      296    13748        %NXTTXT(TYP=KLTY_FEP#,TXT=FEP);
      297    13753        %NXTTXT(TYP=KLTY_URP#,TXT=URP);
      298    13758        %NXTTXT(TYP=KLTY_3270#,TXT=3270);
      299    13763        %NXTTXT(TYP=KLTY_VIRCIR#,TXT=VIRC);
      300    13768        %NXTTXT(TYP=KLTY_CONT#,TXT=CONT);
      301    13773        %NXTTXT(TYP=KLTY_LINEDEV#,TXT=LNDV,LAST=YES);
      302    13778        /**/
      303    13779        %KS$BOX(TITLE="static variables",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:82   
             13797    1   /***************************************************************************
             13798    1    *                                                                         *
             13799    1    *                              static variables                           *
             13800    1    *                                                                         *
             13801    1    ***************************************************************************/

      304    13806    1   DCL FIRST BIT(1) STATIC INIT('0'B);
      305    13807    1   DCL KS_DISP_RNG BIT(1) STATIC INIT('0'B);
      306    13808    1   DCL HNDLR_INDX_SV UBIN BYTE STATIC INIT(0);
      307    13809    1   DCL CNFG$ PTR STATIC INIT(ADDR(CNFG_BUFFER));
      308    13810    1   DCL CNFG_BUFFER(0:49) UBIN WORD STATIC INIT(0*0);
      309    13811    1   DCL DEF_BUFFER(0:49) UBIN WORD STATIC INIT(0*0);
      310    13812    1   DCL CHAR_BUF(0:400) CHAR(1) STATIC;
      311    13813    1   DCL HANDLER$ PTR STATIC INIT(ADDR(CHAR_BUF));
      312    13814        %KL_ADMIN(FPTN=KS_ADMIN,LAST=",",STCLASS=STATIC);
      313    13974                 %KH$CHN(NAME=KS_CHN,LVL = 2);
      314    14098        %KL$CONFIG_KEY(NAME=KS$CONFIG_KEY,STCLASS=STATIC);
      315    14145        %KL$DEFAULT_KEY(NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
      316    14164        %KL_CONTROL (FPTN=KS_CONTROL,STCLASS=STATIC);
      317    14300        %KL$PSEUDO (NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
      318    14344        %KL$PSEUDO_KEY (NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
      319    14362        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_HNDLRPARM_HI,STCLASS=STATIC);
      320    14425        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
      321    14444        %KL$FEPBOOT (NAME=KS_FEPBOOT,NUM=GI_BOOT_HI,STCLASS=STATIC);
      322    14469        %KL$FEPBOOT_KEY (NAME=KS_FEPBOOT_KEY,STCLASS=STATIC);
      323    14487        %KL$FEPCTL (NAME=KS_FEPCTL,NUM=GI_CNTL_DISPHI,STCLASS=STATIC);
      324    14507        %KL$FEPCTL_KEY (NAME=KS_FEPCTL_KEY,STCLASS=STATIC);
      325    14525        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
      326    14555        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=STATIC);
      327    14582        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
      328    14599    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
      329    14600    1        2  CNT UBIN BYTE UNAL INIT(1),
      330    14601    1       2  TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
      331    14602        %KL$NETWORK (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
      332    14629        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
      333    14647        /*
      334    14648                Setup the links macro and the macro to define the key.
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:83   
      335    14649        */
      336    14650        %KL$LINK_KEY(NAME=KS_LINK_KEY,STCLASS=STATIC);
      337    14668    1   DCL HEX_DIGITS CHAR(0) STATIC INIT('0123456789ABCDEF');
      338    14669    1   DCL BLK_VEC BIT(72) STATIC DALIGNED INIT(VECTOR(BLK_FMT));
      339    14670    1   DCL PARAM_HEX_VEC VECTOR STATIC DALIGNED INIT(VECTOR(PARAM_HEX_FMT));
      340    14671    1   DCL PARAM_CHAR_VEC VECTOR STATIC DALIGNED INIT(VECTOR(PARAM_CHAR_FMT));
      341    14672    1   DCL PARAM_VEC BIT(72) STATIC DALIGNED INIT(VECTOR(PARAM_FMT));
      342    14673
      343    14674    1   DCL UNKNOWN CHAR(0) STATIC INIT('           ');
      344    14675        %KS$BOX(TITLE="based variables",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:84   
             14693    1   /***************************************************************************
             14694    1    *                                                                         *
             14695    1    *                              based variables                            *
             14696    1    *                                                                         *
             14697    1    ***************************************************************************/

      345    14702        %B$TCB;
      346    14705        %B$ALT;
      347    14713    1   DCL B$PARAM(0:0) UBIN HALF BASED HALIGNED;
      348    14714        %KL$HNDLR (NAME=KS$HNDLR,NUM=KL_FIXED_HI,STCLASS="BASED(HANDLER$)");
      349    14777        %KL$LINCNFG(NAME=KS_CNFG_BUF,STCLASS="BASED(CNFG$)");
      350    14935        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      351    14980        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
      352    15018        %KS$PARAM (NAME=KS$PARAM,LVL=1,STCLASS="(0:0) BASED",LAST=";");
      353    15088        %KL_ADMIN(FPTN=ADMIN,LAST=",",STCLASS="BASED(KS_MSGBUF$)");
      354    15248                  %KH$CHN(NAME=KS_CHN,LVL=2);
      355    15372        %KL_CONTROL(FPTN=CONTROL,STCLASS="BASED(KS_MSGBUF$)");
      356    15508    1         DCL   1  HND   BASED UNAL,
      357    15509    1                  2  DAT(0:18)   BIT(1)  UNAL;
      358    15510        %KS$PARAM(NAME=KS$PARAM_SPCL,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
      359    15580        %KS$BOX(TITLE="auto variables");

             15598    1   /***************************************************************************
             15599    1    *                                                                         *
             15600    1    *                               auto variables                            *
             15601    1    *                                                                         *
             15602    1    ***************************************************************************/

      360    15607        %B$TERMINAL_ID(FPTN = TERMLO, STCLASS = AUTO);
      361    15636        %B$TERMINAL_ID(FPTN = TERMHI, STCLASS = AUTO);
      362    15665        %KH$CHN(NAME=KH$CHN,LVL=1,STCLASS=AUTO);
      363    15789        %KL$CONFIG_KEY(NAME=KS_CONFIG_KEY,STCLASS=AUTO);
      364    15836    1   DCL ATTRIBUTE UBIN;
      365    15837    1   DCL KS_YES_NO CHAR(3);
      366    15838    1   DCL SPD UBIN;
      367    15839    1   DCL NODESLCT BIT(1);
      368    15840    1   DCL L UBIN;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:85   
      369    15841    1   DCL CHAN_DISP_FULL BIT(1);
      370    15842    1   DCL ONE_CHAN_FLAG BIT(1);
      371    15843    1   DCL 1 OPT(0:5),
      372    15844    1         2 P$     PTR,
      373    15845    1         2 LAST   UBIN;
      374    15846    1   DCL   HDR_FLAG  BIT(1);
      375    15847    1   DCL   OPTION_SATISFIED  BIT(1);
      376    15848    1   DCL ATTR    UBIN;
      377    15849    1   DCL FIRST_PARM  BIT(1);
      378    15850    1   DCL NO_CURRENT_VAL BIT(1) ALIGNED;
      379    15851    1   DCL IPARAM$ PTR;
      380    15852    1   DCL ONE_PARM_ONLY BIT(1);
      381    15853    1       DCL DEF_OPT UBIN;
      382    15854    1   DCL MAX_PARM UBIN;
      383    15855    1   DCL I UBIN;
      384    15856    1   DCL SBLK UBIN;
      385    15857    1   DCL J UBIN;
      386    15858    1   DCL K UBIN;
      387    15859    1   DCL PARMX UBIN;
      388    15860    1   DCL PARMTYPE UBIN;
      389    15861    1   DCL INDX UBIN;
      390    15862    1   DCL INDX_VEC(0:49) UBIN;
      391    15863    1   DCL NUM_INDX UBIN;
      392    15864    1   DCL TEMP1 UBIN;
      393    15865    1   DCL TEMP2 UBIN;
      394    15866    1   DCL VALUE UBIN;
      395    15867    1   DCL 1 VALUE_C REDEF VALUE,
      396    15868    1           2 * CHAR(2),
      397    15869    1           2 CHR CHAR(2) UNAL;
      398    15870    1   DCL ERR# UBIN;
      399    15871    1   DCL BLK$ PTR;
      400    15872    1   DCL SUBLK$ PTR;
      401    15873    1   DCL PTR$ PTR;
      402    15874    1   DCL PTR$_R REDEF PTR$ BIT(36);
      403    15875    1   DCL RES CHAR(2);
      404    15876    1   DCL NODETYPE CHAR(4);
      405    15877    1   DCL FEPNODE SBIN;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:86   
      406    15878    1   DCL FEPNAME CHAR(8);
      407    15879    1   DCL MSG$ PTR;
      408    15880    1   DCL TEMP_PERM UBIN;
      409    15881    1   DCL CONNECTION CHAR(5);
      410    15882    1   DCL BLOCK_VEC VECTOR;
      411    15883    1   DCL READ_COUNTER UBIN BYTE;
      412    15884    1   DCL KS_CHKNODE SBIN;
      413    15885        %KS$BOX(TITLE="FPTs, VLPs and such",PAGE=YES);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:87   
             15903    1   /***************************************************************************
             15904    1    *                                                                         *
             15905    1    *                            FPTs, VLPs and such                          *
             15906    1    *                                                                         *
             15907    1    ***************************************************************************/

      414    15912        %FPT_READ (FPTN=READ_NETCON,
      415    15913                   DCB=M$NETCON,
      416    15914                   KEYS=YES);
      417    15953
      418    15954        %FPT_PRECORD (FPTN = PREC_NETCON,
      419    15955                      DCB  = M$NETCON,
      420    15956                      KEYS = YES,
      421    15957                      KEYR = YES);
      422    15978
      423    15979        %FPT_NODEINFO(FPTN=KS_NODEINFO_F,
      424    15980                      NODEINFO = KS_NODEINFO_V);
      425    15992        %VLR_NODEINFO(FPTN=KS_NODEINFO_V);
      426    16007
      427    16008        %FPT_MONINFO(FPTN = KS_MONINFO_F,MONINFO = KS_MONINFO_V);
      428    16023        %VLR_MONINFO(FPTN = KS_MONINFO_V);
      429    16041
      430    16042        %FPT_READ(FPTN = READ_NETWORK,KEYS=YES,DCB = M$NETCON,
      431    16043                   KEY = KS_NETWORK_KEY,BUF = KS_NETWORK);
      432    16082        %VLP_NAME ( FPTN = NAME, STCLASS = BASED);
      433    16109        %KS$BOX(TITLE="DCBs");

             16127    1   /***************************************************************************
             16128    1    *                                                                         *
             16129    1    *                                    DCBs                                 *
             16130    1    *                                                                         *
             16131    1    ***************************************************************************/

      434    16136    1   DCL M$NETCON DCB;
      435    16137        /*
      436    16138           Now dcl some variables to help in the packing of data into
      437    16139           fep format(ie 9-8) and vice-versa (8-9)
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:88   
      438    16140        */
      439    16141    1        DCL S_R(0:17) BIT(1) BASED(S$) UNAL;
      440    16142    1        DCL S_R_W(0:35) BIT(1) BASED(S$) UNAL;
      441    16143    1        DCL S$ PTR;
      442    16144    1        DCL BINDX UBIN;
      443    16145    1        DCL D$ PTR;
      444    16146    1        DCL D_R(0:17) BIT(1) BASED(D$) UNAL;
      445    16147    1        DCL D_R_W(0:35) BIT(1) BASED(D$) UNAL;
      446    16148        %MACRO ARRAY_TO_WORD (S=JUNK,D=JUNK);
      447    16149             D$ = ADDR(D);
      448    16150             S$ = ADDR(S);
      449    16151             D = 0;
      450    16152             DO BINDX = 1 TO 8;
      451    16153                D_R(BINDX+1) = S_R(BINDX);
      452    16154             END;
      453    16155             DO BINDX = 10 TO 17;
      454    16156                D_R(BINDX) = S_R(BINDX);
      455    16157             END;
      456    16158             D = BITBIN(D_R);
      457    16159        %MEND;
      458    16160        %MACRO PACK4(S=JUNK,D=JUNK);
      459    16161             D$ = ADDR(D);
      460    16162             S$ = ADDR(S);
      461    16163             D = 0;
      462    16164             DO BINDX = 1 TO 8;
      463    16165                D_R_W(BINDX+3) = S_R_W(BINDX);
      464    16166             END;
      465    16167             DO BINDX = 10 TO 17;
      466    16168                D_R_W(BINDX+2) =  S_R_W(BINDX);
      467    16169             END;
      468    16170             DO BINDX = 19 TO 26;
      469    16171                D_R_W(BINDX+1) = S_R_W(BINDX);
      470    16172             END;
      471    16173             DO BINDX = 28 TO 35;
      472    16174                D_R_W(BINDX) = S_R_W(BINDX);
      473    16175             END;
      474    16176             D = BITBIN(D_R_W);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:89   
      475    16177        %MEND;
      476    16178        %MACRO WORD_TO_ARRAY (S=JUNK,D=JUNK);
      477    16179             D.BYT(0) = S/256;
      478    16180             D.BYT(1) = MOD(S,256);
      479    16181        %MEND;
      480    16182
      481    16183             %MACRO CHN_T_F(R=JUNK,D=JUNK);
      482    16184
      483    16185                IF KH$CHN.R THEN
      484    16186                   D = 'Yes';
      485    16187                ELSE
      486    16188                   D = 'No ';
      487    16189             %MEND;
      488    16190
      489    16191    1   DCL 1 CHNTBL ALIGNED AUTO,
      490    16192    1         2 TERMID CALIGNED,
      491    16193    1           3 CHANNEL UBIN,
      492    16194    1           3 SUBDEVICE UBIN,
      493    16195    1           3 SUBSUBDEVICE UBIN,
      494    16196    1           3 LEV UBIN,
      495    16197    1           3 TTYP CHAR(4),
      496    16198    1           3 TERM_NAME CHAR(8),
      497    16199    1         2 ATTR UBIN,
      498    16200    1         2 ECHLGN CHAR(4),
      499    16201    1         2 AUTLGNFAILED CHAR(4),
      500    16202    1         2 AUTBAD CHAR(4),
      501    16203    1         2 ENB CHAR(4),
      502    16204    1         2 DC1DC3NTWOTPFLWCTR CHAR(4),
      503    16205    1         2 AUTLGN CHAR(4),
      504    16206    1         2 ENBHSTUP CHAR(4),
      505    16207    1         2 OTPCCBCNT UBIN,
      506    16208    1         2 BLOCK UBIN,
      507    16209    1         2 EXTDVCID UBIN,
      508    16210    1         2 OTPCCBSTTPTRVLD CHAR(4),
      509    16211    1         2 BRKRQ CHAR(4),
      510    16212    1         2 CTR CHAR(4),
      511    16213    1         2 OTP CHAR(4),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:90   
      512    16214    1         2 BUG CHAR(4),
      513    16215    1         2 HAND$ PTR /*(ADDR(NIL))*/,
      514    16216    1         2 PROFILE CHAR(4),
      515    16217    1         2 CTR_DWNLD UBIN,
      516    16218    1         2 INPBFRBYTSIZ UBIN,
      517    16219    1         2 RE_ENB CHAR(4),
      518    16220    1         2 CLK CHAR(4),
      519    16221    1         2 INPCCBCNT UBIN,
      520    16222    1         2 REDTIMOUTPRD UBIN,
      521    16223    1         2 CTX$ PTR,
      522    16224    1         2 INPCCBSTTPTRVLD CHAR(4),
      523    16225    1         2 RMTHST CHAR(4),
      524    16226    1         2 DED CHAR(4),
      525    16227    1         2 INP CHAR(4),
      526    16228    1         2 RESOURCE CHAR(4),
      527    16229    1         2 DBG CHAR(4),
      528    16230    1         2 INTCNT UBIN,
      529    16231    1         2 SNDSLT CHAR(4),
      530    16232    1         2 DVCID UBIN,
      531    16233    1         2 KLLHSTDWN CHAR(4),
      532    16234    1         2 STT CHAR(4),
      533    16235    1         2 DRCCNC CHAR(4),
      534    16236    1         2 LCT55 UBIN,
      535    16237    1         2 SUB$ PTR /*(ADDR(NIL))*/,
      536    16238    1         2 DWNLOD CHAR(4),
      537    16239    1         2 LGNTIMOUTPRD UBIN,
      538    16240    1         2 SYSID UBIN,
      539    16241    1         2 DRPDTR CHAR(4),
      540    16242    1         2 LINSPD UBIN,
      541    16243    1         2 TPTIMOUTPRD UBIN,
      542    16244    1         2 DSBHSTDWN CHAR(4),
      543    16245    1         2 LNK$ PTR /*(ADDR(NIL))*/,
      544    16246    1         2 UNBLOCK UBIN;
      545    16247
      546    16248    1        DCL 1 CHNTBL_SUM ALIGNED,   /* summary channel display*/
      547    16249    1          2 CHANNEL UBIN,
      548    16250    1          2 DVCID   UBIN,
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:91   
      549    16251    1          2 EXTDVCID UBIN,
      550    16252    1          2 ATTR    UBIN,
      551    16253    1          2 CTX$      UBIN,
      552    16254    1          2 RESOURCE CHAR(2),
      553    16255    1          2 STT     CHAR(4),
      554    16256    1          2 DRCCNC  CHAR(3),
      555    16257    1          2 DRPDTR  CHAR(3),
      556    16258    1          2 DWNLOD  CHAR(3),
      557    16259    1          2 ENB     CHAR(3),
      558    16260    1          2 INP     CHAR(3),
      559    16261    1          2 OTP     CHAR(3),
      560    16262    1          2 SNDSLT  CHAR(3),
      561    16263    1          2 *       CHAR(1),  /*Space needed for formatter*/
      562    16264    1          2 INPCCBCNT UBIN,
      563    16265    1          2 OTPCCBCNT UBIN,
      564    16266    1          2 LGNTIMOUTPRD UBIN,
      565    16267    1          2 REDTIMOUTPRD UBIN;
      566    16268        /**/
      567    16269    1   DCL LAST_DI UBIN;
      568    16270    1        DCL LAST   UBIN;
      569    16271    1        DCL FIRST_SUBLK  UBIN;
      570    16272    1        DCL CHAN UBIN;
      571    16273    1        DCL CHANHI UBIN;
      572    16274    1        DCL CHANLO UBIN;
      573    16275    1        DCL SUBCODE UBIN;
      574    16276    1        DCL SUBLO UBIN;
      575    16277    1        DCL SUBHI UBIN;
      576    16278    1        DCL SUBSUBHI UBIN;
      577    16279    1        DCL SUBSUBLO UBIN;
      578    16280    1        DCL LEV UBIN;
      579    16281    1        DCL SUBDEV UBIN;
      580    16282    1        DCL SUBSUBDEV UBIN;
      581    16283    1        DCL TTEMP UBIN;
      582    16284    1        DCL HEX_CHAR CHAR(1);
      583    16285    1        DCL HEX_DIGIT UBIN;
      584    16286    1        DCL TBIT1 BIT(16);
      585    16287    1        DCL TBIT2 BIT(16);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:92   
      586    16288    1        DCL CODE UBIN;
      587    16289
      588    16290        %KS$BOX(TITLE="EQUs");

             16308    1   /***************************************************************************
             16309    1    *                                                                         *
             16310    1    *                                    EQUs                                 *
             16311    1    *                                                                         *
             16312    1    ***************************************************************************/

      589    16317        %EQU FROM_NETCON = 1;
      590    16318        %EQU FROM_FEP = 2;
      591    16319        %EQU CHANTBL_REQST_SIZE = 16;
      592    16320    1   DCL FORM UBIN HALF;
      593    16321    1   DCL SUBLK_INDX UBIN BYTE;
      594    16322        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:93   
      595    16323    1         READ_NETCON.V.KEYS# = '1'B;

  16323  4 000002   200000 236007                    LDQ     65536,DL
         4 000003   006424 256000 2                  ORSQ    READ_NETCON+8

      596    16324    1         READ_NETCON.V.KEYR# = '0'B;

  16324  4 000004   000000 236000 5                  LDQ     0
         4 000005   006424 356000 2                  ANSQ    READ_NETCON+8

      597    16325    1       LAST_DI = 0;

  16325  4 000006   200326 450100                    STZ     LAST_DI,,AUTO

      598    16326    2        DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  16326  4 000007   200075 450100                    STZ     I,,AUTO
         4 000010   005176 710000 4                  TRA     s:17326+3

      599    16327    2           BLK$ = OUT$BLK.SUBLK$(I);

  16327  4 000011   200003 470500                    LDP0    @TOP$,,AUTO
         4 000012   000000 471500                    LDP1    0,,PR0
         4 000013   200075 720100                    LXL0    I,,AUTO
         4 000014   100003 236110                    LDQ     3,X0,PR1
         4 000015   200173 756100                    STQ     BLK$,,AUTO

      600    16328    3           DO CASE(BLK$->OUT$BLK.CODE);

  16328  4 000016   200173 473500                    LDP3    BLK$,,AUTO
         4 000017   300000 721100                    LXL1    0,,PR3
         4 000020   000016 101003                    CMPX1   14,DU
         4 000021   000023 602011 4                  TNC     s:16328+5,X1
         4 000022   005134 710000 4                  TRA     s:17309
         4 000023   005134 710000 4                  TRA     s:17309
         4 000024   000041 710000 4                  TRA     s:16330
         4 000025   000765 710000 4                  TRA     s:16491
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:94   
         4 000026   003622 710000 4                  TRA     s:17082
         4 000027   003253 710000 4                  TRA     s:16977
         4 000030   005134 710000 4                  TRA     s:17309
         4 000031   003507 710000 4                  TRA     s:17058
         4 000032   002235 710000 4                  TRA     s:16777
         4 000033   001210 710000 4                  TRA     s:16534
         4 000034   001210 710000 4                  TRA     s:16534
         4 000035   000263 710000 4                  TRA     s:16374
         4 000036   003622 710000 4                  TRA     s:17082
         4 000037   003622 710000 4                  TRA     s:17082
         4 000040   003622 710000 4                  TRA     s:17082

      601    16329    3              CASE(%KS_BOOTINFO);

      602    16330    3               IF BLK$->OUT$BLK.NSUBLKS ~= 0 THEN

  16330  4 000041   300001 222100                    LDX2    1,,PR3
         4 000042   000062 600000 4                  TZE     s:16338

      603    16331    4                  DO;

      604    16332    4                     CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));

  16332  4 000043   300003 474500                    LDP4    3,,PR3
         4 000044   400003 635500                    EPPR5   3,,PR4
         4 000045   200355 455500                    STP5    SUBLK_INDX+2,,AUTO
         4 000046   005206 701000 4                  TSX1    GET_NODE
         4 000047   000000 011000                    NOP     0

      605    16333    4                     KS_NODE_SV = KS_NODE;

  16333  4 000050   000000 235000 xsym               LDA     KS_NODE
         4 000051   000000 755000 xsym               STA     KS_NODE_SV

      606    16334    4                     KS_NODENAME_SV = KS_NODENAME;

  16334  4 000052   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:95   
         4 000053   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000054   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8

      607    16335    4                     KS_NODE = FEPNODE;

  16335  4 000055   200200 236100                    LDQ     FEPNODE,,AUTO
         4 000056   000000 756000 xsym               STQ     KS_NODE

      608    16336    4                     KS_NODENAME = FEPNAME;

  16336  4 000057   040000 100500                    MLR     fill='040'O
         4 000060   200201 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 000061   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

      609    16337    4                  END;

      610    16338    4                 IF KS_NODENAME = 'HOST' THEN DO;

  16338  4 000062   040000 106400                    CMPC    fill='040'O
         4 000063   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000064   002710 000004 1                  ADSC9   PARM_DISPONLY_FMT+4      cn=0,n=4
         4 000065   000073 601000 4                  TNZ     s:16342

      611    16339    4                    CALL KSE$ERRMSG(%E$KS_NONODE);

  16339  4 000066   000001 630400 5                  EPPR0   1
         4 000067   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000070   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000071   000000 011000                    NOP     0

      612    16340    4                    RETURN;

  16340  4 000072   000000 702200 xent               TSX2  ! X66_ARET

      613    16341    4                    END;  /* IF KS_NODENAME = 'HOST' */
      614    16342    3                 KS_FEPBOOT_KEY.NODE = KS_NODE;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:96   
  16342  4 000073   000000 236000 xsym               LDQ     KS_NODE
         4 000074   000011 736000                    QLS     9
         4 000075   001246 552010 2                  STBQ    KS_FEPBOOT_KEY,'10'O

      615    16343    3                 KS_FEPHNDLR_KEY.NODE = KS_NODE;

  16343  4 000076   000000 236000 xsym               LDQ     KS_NODE
         4 000077   000011 736000                    QLS     9
         4 000100   006371 552010 2                  STBQ    KS_FEPHNDLR_KEY,'10'O

      616    16344    3                 KS_HANDLER_KEY.NODE = KS_NODE;

  16344  4 000101   000000 236000 xsym               LDQ     KS_NODE
         4 000102   000011 736000                    QLS     9
         4 000103   001211 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

      617    16345    3                 KS_SUB_BUF_1.COUNT = SIZEC('BOOTINFO');

  16345  4 000104   010000 236003                    LDQ     4096,DU
         4 000105   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

      618    16346    3                 KS_SUB_BUF_1.TEXT = 'BOOTINFO';

  16346  4 000106   040000 100400                    MLR     fill='040'O
         4 000107   002711 000010 1                  ADSC9   PARM_DISPONLY_FMT+5      cn=0,n=8
         4 000110   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

      619    16347    3                 CALL KSW$WRITE(BOOTHDR_VEC,VECTOR(KS_NODENAME));

  16347  4 000111   000004 630400 5                  EPPR0   4
         4 000112   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000113   000000 701000 xent               TSX1    KSW$WRITE
         4 000114   000000 011000                    NOP     0

      620    16348    3                 READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  16348  4 000115   000006 237000 5                  LDAQ    6
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:97   
         4 000116   006416 757000 2                  STAQ    READ_NETCON+2

      621    16349    3                 READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);

  16349  4 000117   000010 237000 5                  LDAQ    8
         4 000120   006420 757000 2                  STAQ    READ_NETCON+4

      622    16350    3                 CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);

  16350  4 000121   006414 630400 2                  EPPR0   READ_NETCON
         4 000122   440000 713400                    CLIMB   alt,read
         4 000123   401400 401760                    pmme    nvectors=4
         4 000124   005135 702000 4                  TSX2    DISP_ERR

      623    16351
      624    16352    3                 READ_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);

  16352  4 000125   000012 237000 5                  LDAQ    10
         4 000126   006416 757000 2                  STAQ    READ_NETCON+2

      625    16353    3                 READ_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);

  16353  4 000127   000014 237000 5                  LDAQ    12
         4 000130   006420 757000 2                  STAQ    READ_NETCON+4

      626    16354    3                 CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);

  16354  4 000131   006414 630400 2                  EPPR0   READ_NETCON
         4 000132   440000 713400                    CLIMB   alt,read
         4 000133   401400 401760                    pmme    nvectors=4
         4 000134   005135 702000 4                  TSX2    DISP_ERR

      627    16355    3                 CALL KSW$WRITE(BOOTFID_VEC,VECTOR(KS_FEPBOOT.BOOTFID),

  16355  4 000135   000022 630400 5                  EPPR0   18
         4 000136   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000137   000000 701000 xent               TSX1    KSW$WRITE
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:98   
         4 000140   000000 011000                    NOP     0

      628    16356    3                                VECTOR(KS_FEPHNDLR.DEFLIBACCT));
      629    16357    3                 READ_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);

  16357  4 000141   000026 237000 5                  LDAQ    22
         4 000142   006416 757000 2                  STAQ    READ_NETCON+2

      630    16358    3                 HANDLER$ = ADDR(CHAR_BUF);

  16358  4 000143   000030 236000 5                  LDQ     24
         4 000144   000315 756000 2                  STQ     HANDLER$

      631    16359    3                 READ_NETCON.BUF_ = VECTOR(CHAR_BUF);

  16359  4 000145   000032 237000 5                  LDAQ    26
         4 000146   006420 757000 2                  STAQ    READ_NETCON+4

      632    16360    3                 CALL KSW$WRITE(HNDLRHDR_VEC);

  16360  4 000147   000034 630400 5                  EPPR0   28
         4 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000151   000000 701000 xent               TSX1    KSW$WRITE
         4 000152   000000 011000                    NOP     0

      633    16361    4                 DO J = 1 TO KS_FEPHNDLR.NHANDLERS;

  16361  4 000153   000001 235007                    LDA     1,DL
         4 000154   200077 755100                    STA     J,,AUTO
         4 000155   000257 710000 4                  TRA     s:16369+3

      634    16362    4                    KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J-1);

  16362  4 000156   200077 235100                    LDA     J,,AUTO
         4 000157   000003 735000                    ALS     3
         4 000160   040000 100405                    MLR     fill='040'O
         4 000161   001311 000010 2                  ADSC9   KS_FEPHNDLR+2,A          cn=0,n=8
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:99   
         4 000162   001211 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

      635    16363    4                    CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);

  16363  4 000163   006414 630400 2                  EPPR0   READ_NETCON
         4 000164   440000 713400                    CLIMB   alt,read
         4 000165   401400 401760                    pmme    nvectors=4
         4 000166   005135 702000 4                  TSX2    DISP_ERR

      636    16364    4                    IF KS_FEPHNDLR.BOOTIME(J-1) THEN

  16364  4 000167   200077 235100                    LDA     J,,AUTO
         4 000170   000000 066405                    CMPB    filb='0'B
         4 000171   001311 700001 2                  BDSC    KS_FEPHNDLR+2,A          by=3,bit=8,n=1
         4 000172   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 000173   000201 600000 4                  TZE     s:16367

      637    16365    4                       KS_YES_NO = 'Yes';

  16365  4 000174   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 000175   000035 376000 5                  ANQ     29
         4 000176   000040 276007                    ORQ     32,DL
         4 000177   200042 756100                    STQ     KS_YES_NO,,AUTO
         4 000200   000205 710000 4                  TRA     s:16368

      638    16366    4                    ELSE
      639    16367    4                       KS_YES_NO = 'No';

  16367  4 000201   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 000202   777777 376003                    ANQ     -1,DU
         4 000203   040040 276007                    ORQ     16416,DL
         4 000204   200042 756100                    STQ     KS_YES_NO,,AUTO

      640    16368    4                    CALL KSW$WRITE(HNDLR_VEC,VECTOR(J),VECTOR(KS$HNDLR.HNDLRNAME),
             16368                             VECTOR(KS_YES_NO),VECTOR(KS$HNDLR.HNDLRFID));

  16368  4 000205   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:100  
         4 000206   200376 452500                    STP2    MAX+1,,AUTO
         4 000207   200376 236100                    LDQ     MAX+1,,AUTO
         4 000210   000077 036003                    ADLQ    63,DU
         4 000211   200400 757100                    STAQ    MAX+3,,AUTO
         4 000212   000002 235000 5                  LDA     2
         4 000213   000315 236000 2                  LDQ     HANDLER$
         4 000214   000012 036003                    ADLQ    10,DU
         4 000215   200402 757100                    STAQ    MAX+5,,AUTO
         4 000216   577640 235007                    LDA     -65632,DL
         4 000217   200404 452500                    STP2    MAX+7,,AUTO
         4 000220   200404 236100                    LDQ     MAX+7,,AUTO
         4 000221   000042 036003                    ADLQ    34,DU
         4 000222   200406 757100                    STAQ    MAX+9,,AUTO
         4 000223   000016 235000 5                  LDA     14
         4 000224   000315 236000 2                  LDQ     HANDLER$
         4 000225   200412 757100                    STAQ    MAX+13,,AUTO
         4 000226   200400 237100                    LDAQ    MAX+3,,AUTO
         4 000227   200410 757100                    STAQ    MAX+11,,AUTO
         4 000230   200402 237100                    LDAQ    MAX+5,,AUTO
         4 000231   200414 757100                    STAQ    MAX+15,,AUTO
         4 000232   200406 237100                    LDAQ    MAX+9,,AUTO
         4 000233   200416 757100                    STAQ    MAX+17,,AUTO
         4 000234   200412 237100                    LDAQ    MAX+13,,AUTO
         4 000235   200420 757100                    STAQ    MAX+19,,AUTO
         4 000236   200420 630500                    EPPR0   MAX+19,,AUTO
         4 000237   200426 450500                    STP0    MAX+25,,AUTO
         4 000240   200416 631500                    EPPR1   MAX+17,,AUTO
         4 000241   200425 451500                    STP1    MAX+24,,AUTO
         4 000242   200414 633500                    EPPR3   MAX+15,,AUTO
         4 000243   200424 453500                    STP3    MAX+23,,AUTO
         4 000244   200410 634500                    EPPR4   MAX+11,,AUTO
         4 000245   200423 454500                    STP4    MAX+22,,AUTO
         4 000246   000036 236000 5                  LDQ     30
         4 000247   200422 756100                    STQ     MAX+21,,AUTO
         4 000250   200422 630500                    EPPR0   MAX+21,,AUTO
         4 000251   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 000252   000000 701000 xent               TSX1    KSW$WRITE
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:101  
         4 000253   000000 011000                    NOP     0

      641    16369    4                    END;  /* DO J */

  16369  4 000254   200077 235100                    LDA     J,,AUTO
         4 000255   000001 035007                    ADLA    1,DL
         4 000256   200077 755100                    STA     J,,AUTO
         4 000257   001307 236000 2                  LDQ     KS_FEPHNDLR
         4 000260   200077 116100                    CMPQ    J,,AUTO
         4 000261   000156 603000 4                  TRC     s:16362
         4 000262   005134 710000 4                  TRA     s:17309

      642    16370
      643    16371
      644    16372        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:102  
      645    16373    3              CASE(%KS_NET_STATUS);

      646    16374    3                 READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  16374  4 000263   000040 237000 5                  LDAQ    32
         4 000264   006416 757000 2                  STAQ    READ_NETCON+2

      647    16375    3                 READ_NETCON.BUF_ = VECTOR(KS_NETWORK);

  16375  4 000265   000042 237000 5                  LDAQ    34
         4 000266   006420 757000 2                  STAQ    READ_NETCON+4

      648    16376    3                 CALL M$READ(READ_NETCON) WHENALTRETURN

  16376  4 000267   006414 630400 2                  EPPR0   READ_NETCON
         4 000270   440000 713400                    CLIMB   alt,read
         4 000271   401400 401760                    pmme    nvectors=4
         4 000272   000274 702000 4                  TSX2    s:16378
         4 000273   000306 710000 4                  TRA     s:16382

      649    16377    4                    DO;

      650    16378    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY THEN

  16378  4 000274   000000 470400 xsym               LDP0    B$TCB$
         4 000275   000000 471500                    LDP1    0,,PR0
         4 000276   100102 236100                    LDQ     66,,PR1
         4 000277   377770 376007                    ANQ     131064,DL
         4 000300   001020 116007                    CMPQ    528,DL
         4 000301   005135 600000 4                  TZE     DISP_ERR

      651    16379    4                       GOTO DISP_ERR;
      652    16380    4                    KS_NETWORK = '0'B;

  16380  4 000302   012004 220003                    LDX0    5124,DU
         4 000303   000040 100400                    MLR     fill='000'O
         4 000304   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:103  
         4 000305   001365 000010 2                  ADSC9   KS_NETWORK               cn=0,n=*X0

      653    16381    4                    END;

      654    16382    3                 IF KS_NETWORK.NODE# = 0 THEN

  16382  4 000306   001365 235000 2                  LDA     KS_NETWORK
         4 000307   000315 601000 4                  TNZ     s:16388

      655    16383    4                    DO;

      656    16384    4                    CALL KSE$ERRMSG(%E$KS_NO_NETWORK);

  16384  4 000310   000045 630400 5                  EPPR0   37
         4 000311   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000312   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000313   000000 011000                    NOP     0

      657    16385    4                    END;

  16385  4 000314   005134 710000 4                  TRA     s:17309

      658    16386    3                 ELSE
      659    16387    4                    DO;

      660    16388    4                    FIRST_SUBLK = 0;

  16388  4 000315   200330 450100                    STZ     FIRST_SUBLK,,AUTO

      661    16389    4                    IF BLK$->OUT$BLK.NSUBLKS = 0 THEN

  16389  4 000316   200173 470500                    LDP0    BLK$,,AUTO
         4 000317   000001 220100                    LDX0    1,,PR0
         4 000320   000325 601000 4                  TNZ     s:16396

      662    16390    5                       DO;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:104  
      663    16391    5                       FORM = %KS_STAT_SHORT;

  16391  4 000321   000002 221003                    LDX1    2,DU
         4 000322   200352 741100                    STX1    FORM,,AUTO

      664    16392    5                       NODESLCT = '0'B;

  16392  4 000323   200044 450100                    STZ     NODESLCT,,AUTO

      665    16393    5                       END;

  16393  4 000324   000365 710000 4                  TRA     s:16418

      666    16394    4                    ELSE
      667    16395    5                       DO;

      668    16396    5                       IF BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_STAT_LONG OR

  16396  4 000325   000003 471500                    LDP1    3,,PR0
         4 000326   100000 721100                    LXL1    0,,PR1
         4 000327   000003 101003                    CMPX1   3,DU
         4 000330   000333 600000 4                  TZE     s:16399
         4 000331   000002 101003                    CMPX1   2,DU
         4 000332   000353 601000 4                  TNZ     s:16412

      669    16397    5                          BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_STAT_SHORT THEN
      670    16398    6                          DO;

      671    16399    6                          FORM = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  16399  4 000333   200352 741100                    STX1    FORM,,AUTO

      672    16400    6                          IF BLK$->OUT$BLK.NSUBLKS > 1 THEN

  16400  4 000334   000002 100003                    CMPX0   2,DU
         4 000335   000351 602000 4                  TNC     s:16408

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:105  
      673    16401    7                             DO;

      674    16402    7                             NODESLCT = '1'B;

  16402  4 000336   400000 236003                    LDQ     -131072,DU
         4 000337   200044 756100                    STQ     NODESLCT,,AUTO

      675    16403    7                             SUBLK$ = BLK$;

  16403  4 000340   200173 236100                    LDQ     BLK$,,AUTO
         4 000341   200174 756100                    STQ     SUBLK$,,AUTO

      676    16404    7                             LAST = BLK$->OUT$BLK.NSUBLKS - 1;

  16404  4 000342   000001 236100                    LDQ     1,,PR0
         4 000343   000022 772000                    QRL     18
         4 000344   000001 136007                    SBLQ    1,DL
         4 000345   200327 756100                    STQ     LAST,,AUTO

      677    16405    7                             FIRST_SUBLK = 1;

  16405  4 000346   000001 235007                    LDA     1,DL
         4 000347   200330 755100                    STA     FIRST_SUBLK,,AUTO

      678    16406    7                             END;  /* nsublks > 1 */

  16406  4 000350   000365 710000 4                  TRA     s:16418

      679    16407    6                          ELSE
      680    16408    6                             NODESLCT = '0'B;

  16408  4 000351   200044 450100                    STZ     NODESLCT,,AUTO

      681    16409    6                          END;  /* is there a form specified in the nodes */

  16409  4 000352   000365 710000 4                  TRA     s:16418

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:106  
      682    16410    5                       ELSE
      683    16411    6                          DO;

      684    16412    6                          FORM = %KS_STAT_SHORT;

  16412  4 000353   000002 222003                    LDX2    2,DU
         4 000354   200352 742100                    STX2    FORM,,AUTO

      685    16413    6                          NODESLCT = '1'B;

  16413  4 000355   400000 236003                    LDQ     -131072,DU
         4 000356   200044 756100                    STQ     NODESLCT,,AUTO

      686    16414    6                          SUBLK$ = BLK$;

  16414  4 000357   200173 236100                    LDQ     BLK$,,AUTO
         4 000360   200174 756100                    STQ     SUBLK$,,AUTO

      687    16415    6                          LAST = BLK$->OUT$BLK.NSUBLKS - 1;

  16415  4 000361   000001 236100                    LDQ     1,,PR0
         4 000362   000022 772000                    QRL     18
         4 000363   000001 136007                    SBLQ    1,DL
         4 000364   200327 756100                    STQ     LAST,,AUTO

      688    16416    6                          END;

      689    16417    5                       END;  /* what form do we use? */

      690    16418    4                    CALL M$MONINFO(KS_MONINFO_F) ALTRET(DISP_ERR);

  16418  4 000365   006462 630400 2                  EPPR0   KS_MONINFO_F
         4 000366   420023 713400                    CLIMB   alt,+8211
         4 000367   402400 401760                    pmme    nvectors=6
         4 000370   005135 702000 4                  TSX2    DISP_ERR

      691    16419    4                    IF NOT NODESLCT THEN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:107  

  16419  4 000371   200044 234100                    SZN     NODESLCT,,AUTO
         4 000372   000375 604000 4                  TMI     s:16421

      692    16420    4                       LAST = KS_MONINFO_V.NUM_NODES;

  16420  4 000373   006512 235000 2                  LDA     KS_MONINFO_V+12
         4 000374   200327 755100                    STA     LAST,,AUTO

      693    16421    4                    IF FORM ~= %KS_STAT_SHORT THEN

  16421  4 000375   200352 220100                    LDX0    FORM,,AUTO
         4 000376   000002 100003                    CMPX0   2,DU
         4 000377   000404 600000 4                  TZE     s:16423

      694    16422    4                       CALL KSW$WRITE(NET_STAT_VEC,VECTOR(KS_NETSTAT));

  16422  4 000400   000050 630400 5                  EPPR0   40
         4 000401   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000402   000000 701000 xent               TSX1    KSW$WRITE
         4 000403   000000 011000                    NOP     0

      695    16423    5                    DO L = FIRST_SUBLK TO LAST;

  16423  4 000404   200330 235100                    LDA     FIRST_SUBLK,,AUTO
         4 000405   200045 755100                    STA     L,,AUTO
         4 000406   000761 710000 4                  TRA     STAT_END_LOOP+3

      696    16424    5                       IF NODESLCT THEN

  16424  4 000407   200044 234100                    SZN     NODESLCT,,AUTO
         4 000410   000435 605000 4                  TPL     s:16436

      697    16425    6                          DO;

      698    16426    6                          CALL GET_NODE(SUBLK$->OUT$BLK.SUBLK$(L));

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:108  
  16426  4 000411   200045 236100                    LDQ     L,,AUTO
         4 000412   000022 736000                    QLS     18
         4 000413   000003 036003                    ADLQ    3,DU
         4 000414   200174 036100                    ADLQ    SUBLK$,,AUTO
         4 000415   200355 756100                    STQ     SUBLK_INDX+2,,AUTO
         4 000416   005206 701000 4                  TSX1    GET_NODE
         4 000417   000000 011000                    NOP     0

      699    16427    6                          J = FEPNODE;

  16427  4 000420   200200 235100                    LDA     FEPNODE,,AUTO
         4 000421   200077 755100                    STA     J,,AUTO

      700    16428    6                          IF FEPNODE > KS_MONINFO_V.NUM_NODES OR

  16428  4 000422   006512 236000 2                  LDQ     KS_MONINFO_V+12
         4 000423   000426 604000 4                  TMI     s:16428+4
         4 000424   200200 116100                    CMPQ    FEPNODE,,AUTO
         4 000425   000430 604000 4                  TMI     s:16431
         4 000426   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 000427   000437 601000 4                  TNZ     s:16437

      701    16429    6                             FEPNODE = -1 THEN   /* if node is not defined */
      702    16430    7                             DO;

      703    16431    7                             CALL KSE$ERRMSG(%E$KS_BADNUM);

  16431  4 000430   000053 630400 5                  EPPR0   43
         4 000431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000432   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000433   000000 011000                    NOP     0

      704    16432    7                             GOTO STAT_END_LOOP;

  16432  4 000434   000756 710000 4                  TRA     STAT_END_LOOP

      705    16433    7                             END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:109  
      706    16434    6                          END; /* nodeslct  */
      707    16435    5                       ELSE
      708    16436    5                          J = L;

  16436  4 000435   200045 235100                    LDA     L,,AUTO
         4 000436   200077 755100                    STA     J,,AUTO

      709    16437    5                       KS_NODEINFO_F.V.NODENUM# = J;

  16437  4 000437   200077 236100                    LDQ     J,,AUTO
         4 000440   000033 736000                    QLS     27
         4 000441   006452 552040 2                  STBQ    KS_NODEINFO_F+6,'40'O

      710    16438    5                       NODETYPE = TEXT_NODETYPE(KS_NETWORK.NODE.TYPE(J));

  16438  4 000442   200077 236100                    LDQ     J,,AUTO
         4 000443   000005 402007                    MPY     5,DL
         4 000444   001366 720006 2                  LXL0    KS_NETWORK+1,QL
         4 000445   000000 236010 1                  LDQ     TEXT_NODETYPE,X0
         4 000446   200177 756100                    STQ     NODETYPE,,AUTO

      711    16439    5                       IF NODETYPE = ' ' AND NODESLCT THEN

  16439  4 000447   000035 116000 xsym               CMPQ    B_VECTNIL+29
         4 000450   000460 601000 4                  TNZ     s:16444
         4 000451   200044 234100                    SZN     NODESLCT,,AUTO
         4 000452   000460 605000 4                  TPL     s:16444

      712    16440    6                          DO; /* nodetype = ' ' */

      713    16441    6                          CALL KSE$ERRMSG(%E$KS_BADNUM);

  16441  4 000453   000053 630400 5                  EPPR0   43
         4 000454   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000455   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000456   000000 011000                    NOP     0

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:110  
      714    16442    6                          GOTO STAT_END_LOOP;

  16442  4 000457   000756 710000 4                  TRA     STAT_END_LOOP

      715    16443    6                          END; /* if nodetype = ' '  */
      716    16444    5                       IF NODETYPE ~= ' ' THEN

  16444  4 000460   000035 116000 xsym               CMPQ    B_VECTNIL+29
         4 000461   000756 600000 4                  TZE     STAT_END_LOOP

      717    16445    6       THE_BIG_DO:        DO;

  16445  4 000462                       THE_BIG_DO   null
      718    16446    6                          CALL M$NODEINFO(KS_NODEINFO_F) ALTRET(DISP_ERR);

  16446  4 000462   006444 630400 2                  EPPR0   KS_NODEINFO_F
         4 000463   560031 713400                    CLIMB   alt,+57369
         4 000464   400400 401760                    pmme    nvectors=2
         4 000465   005135 702000 4                  TSX2    DISP_ERR

      719    16447    6                          IF FORM = %KS_STAT_SHORT THEN

  16447  4 000466   200352 220100                    LDX0    FORM,,AUTO
         4 000467   000002 100003                    CMPX0   2,DU
         4 000470   000540 601000 4                  TNZ     s:16456

      720    16448    7                             DO;

      721    16449    7                             IF KS_NODEINFO_V.ACTIVE# THEN

  16449  4 000471   006456 236000 2                  LDQ     KS_NODEINFO_V+2
         4 000472   000200 316003                    CANQ    128,DU
         4 000473   000500 600000 4                  TZE     s:16452

      722    16450    7                                UNKNOWN = 'is running';

  16450  4 000474   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:111  
         4 000475   002715 000012 1                  ADSC9   PARM_DISPONLY_FMT+9      cn=0,n=10
         4 000476   006410 000013 2                  ADSC9   UNKNOWN                  cn=0,n=11
         4 000477   000503 710000 4                  TRA     s:16453

      723    16451    7                             ELSE
      724    16452    7                                UNKNOWN = 'is disabled';

  16452  4 000500   040000 100400                    MLR     fill='040'O
         4 000501   002720 000013 1                  ADSC9   PARM_DISPONLY_FMT+12     cn=0,n=11
         4 000502   006410 000013 2                  ADSC9   UNKNOWN                  cn=0,n=11

      725    16453    7                            CALL KSW$WRITE(SHORT_LINE_VEC,VECTOR(J),VECTOR(KS_NETWORK.
             16453                                      NODE.NODE(J)),VECTOR(UNKNOWN));

  16453  4 000503   777640 235007                    LDA     -96,DL
         4 000504   200376 452500                    STP2    MAX+1,,AUTO
         4 000505   200376 236100                    LDQ     MAX+1,,AUTO
         4 000506   000077 036003                    ADLQ    63,DU
         4 000507   200400 757100                    STAQ    MAX+3,,AUTO
         4 000510   000002 235000 5                  LDA     2
         4 000511   200077 236100                    LDQ     J,,AUTO
         4 000512   200402 755100                    STA     MAX+5,,AUTO
         4 000513   000005 402003                    MPY     5,DU
         4 000514   000054 036000 5                  ADLQ    44
         4 000515   200402 235100                    LDA     MAX+5,,AUTO
         4 000516   200406 757100                    STAQ    MAX+9,,AUTO
         4 000517   200400 237100                    LDAQ    MAX+3,,AUTO
         4 000520   200404 757100                    STAQ    MAX+7,,AUTO
         4 000521   200406 237100                    LDAQ    MAX+9,,AUTO
         4 000522   200410 757100                    STAQ    MAX+11,,AUTO
         4 000523   000060 236000 5                  LDQ     48
         4 000524   200415 756100                    STQ     MAX+16,,AUTO
         4 000525   200410 630500                    EPPR0   MAX+11,,AUTO
         4 000526   200414 450500                    STP0    MAX+15,,AUTO
         4 000527   200404 631500                    EPPR1   MAX+7,,AUTO
         4 000530   200413 451500                    STP1    MAX+14,,AUTO
         4 000531   000061 236000 5                  LDQ     49
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:112  
         4 000532   200412 756100                    STQ     MAX+13,,AUTO
         4 000533   200412 630500                    EPPR0   MAX+13,,AUTO
         4 000534   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000535   000000 701000 xent               TSX1    KSW$WRITE
         4 000536   000000 011000                    NOP     0

      726    16454    7                             EXIT THE_BIG_DO;

  16454  4 000537   000756 710000 4                  TRA     STAT_END_LOOP

      727    16455    7                             END;  /* end processing of short form */
      728    16456    6                         CALL KSW$WRITE(NODE_VEC,VECTOR(J),VECTOR(KS_NETWORK.NODE.NODE
             16456                                   (J)));

  16456  4 000540   777640 235007                    LDA     -96,DL
         4 000541   200376 452500                    STP2    MAX+1,,AUTO
         4 000542   200376 236100                    LDQ     MAX+1,,AUTO
         4 000543   000077 036003                    ADLQ    63,DU
         4 000544   200400 757100                    STAQ    MAX+3,,AUTO
         4 000545   000002 235000 5                  LDA     2
         4 000546   200077 236100                    LDQ     J,,AUTO
         4 000547   200402 755100                    STA     MAX+5,,AUTO
         4 000550   000005 402003                    MPY     5,DU
         4 000551   000054 036000 5                  ADLQ    44
         4 000552   200402 235100                    LDA     MAX+5,,AUTO
         4 000553   200406 757100                    STAQ    MAX+9,,AUTO
         4 000554   200400 237100                    LDAQ    MAX+3,,AUTO
         4 000555   200404 757100                    STAQ    MAX+7,,AUTO
         4 000556   200406 237100                    LDAQ    MAX+9,,AUTO
         4 000557   200410 757100                    STAQ    MAX+11,,AUTO
         4 000560   200410 630500                    EPPR0   MAX+11,,AUTO
         4 000561   200414 450500                    STP0    MAX+15,,AUTO
         4 000562   200404 631500                    EPPR1   MAX+7,,AUTO
         4 000563   200413 451500                    STP1    MAX+14,,AUTO
         4 000564   000062 236000 5                  LDQ     50
         4 000565   200412 756100                    STQ     MAX+13,,AUTO
         4 000566   200412 630500                    EPPR0   MAX+13,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:113  
         4 000567   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000570   000000 701000 xent               TSX1    KSW$WRITE
         4 000571   000000 011000                    NOP     0

      729    16457
      730    16458    6                          IF KS_NODEINFO_V.HOST# THEN

  16458  4 000572   006456 236000 2                  LDQ     KS_NODEINFO_V+2
         4 000573   000400 316003                    CANQ    256,DU
         4 000574   000602 600000 4                  TZE     s:16461

      731    16459    6                             KS_YES_NO = 'Yes';

  16459  4 000575   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 000576   000035 376000 5                  ANQ     29
         4 000577   000040 276007                    ORQ     32,DL
         4 000600   200042 756100                    STQ     KS_YES_NO,,AUTO
         4 000601   000606 710000 4                  TRA     s:16462

      732    16460    6                          ELSE
      733    16461    6                             KS_YES_NO = 'No ';

  16461  4 000602   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 000603   000035 376000 5                  ANQ     29
         4 000604   000040 276007                    ORQ     32,DL
         4 000605   200042 756100                    STQ     KS_YES_NO,,AUTO

      734    16462    6                          CALL KSW$WRITE(HST_VEC,VECTOR(KS_YES_NO));

  16462  4 000606   577640 235007                    LDA     -65632,DL
         4 000607   200376 452500                    STP2    MAX+1,,AUTO
         4 000610   200376 236100                    LDQ     MAX+1,,AUTO
         4 000611   000042 036003                    ADLQ    34,DU
         4 000612   200400 757100                    STAQ    MAX+3,,AUTO
         4 000613   200400 630500                    EPPR0   MAX+3,,AUTO
         4 000614   200403 450500                    STP0    MAX+6,,AUTO
         4 000615   000063 236000 5                  LDQ     51
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:114  
         4 000616   200402 756100                    STQ     MAX+5,,AUTO
         4 000617   200402 630500                    EPPR0   MAX+5,,AUTO
         4 000620   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000621   000000 701000 xent               TSX1    KSW$WRITE
         4 000622   000000 011000                    NOP     0

      735    16463
      736    16464    6                          IF KS_NODEINFO_V.ACTIVE# THEN

  16464  4 000623   006456 236000 2                  LDQ     KS_NODEINFO_V+2
         4 000624   000200 316003                    CANQ    128,DU
         4 000625   000633 600000 4                  TZE     s:16467

      737    16465    6                             KS_YES_NO = 'Yes';

  16465  4 000626   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 000627   000035 376000 5                  ANQ     29
         4 000630   000040 276007                    ORQ     32,DL
         4 000631   200042 756100                    STQ     KS_YES_NO,,AUTO
         4 000632   000637 710000 4                  TRA     s:16468

      738    16466    6                          ELSE
      739    16467    6                             KS_YES_NO = 'No ';

  16467  4 000633   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 000634   000035 376000 5                  ANQ     29
         4 000635   000040 276007                    ORQ     32,DL
         4 000636   200042 756100                    STQ     KS_YES_NO,,AUTO

      740    16468    6                          CALL KSW$WRITE(ACTV_VEC,VECTOR(KS_YES_NO));

  16468  4 000637   577640 235007                    LDA     -65632,DL
         4 000640   200376 452500                    STP2    MAX+1,,AUTO
         4 000641   200376 236100                    LDQ     MAX+1,,AUTO
         4 000642   000042 036003                    ADLQ    34,DU
         4 000643   200400 757100                    STAQ    MAX+3,,AUTO
         4 000644   200400 630500                    EPPR0   MAX+3,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:115  
         4 000645   200403 450500                    STP0    MAX+6,,AUTO
         4 000646   000064 236000 5                  LDQ     52
         4 000647   200402 756100                    STQ     MAX+5,,AUTO
         4 000650   200402 630500                    EPPR0   MAX+5,,AUTO
         4 000651   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000652   000000 701000 xent               TSX1    KSW$WRITE
         4 000653   000000 011000                    NOP     0

      741    16469    6                          IF KS_NODEINFO_V.CURRENTNODE# THEN

  16469  4 000654   006456 236000 2                  LDQ     KS_NODEINFO_V+2
         4 000655   000100 316003                    CANQ    64,DU
         4 000656   000664 600000 4                  TZE     s:16472

      742    16470    6                             KS_YES_NO = 'Yes';

  16470  4 000657   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 000660   000035 376000 5                  ANQ     29
         4 000661   000040 276007                    ORQ     32,DL
         4 000662   200042 756100                    STQ     KS_YES_NO,,AUTO
         4 000663   000670 710000 4                  TRA     s:16473

      743    16471    6                          ELSE
      744    16472    6                             KS_YES_NO = 'No ';

  16472  4 000664   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 000665   000035 376000 5                  ANQ     29
         4 000666   000040 276007                    ORQ     32,DL
         4 000667   200042 756100                    STQ     KS_YES_NO,,AUTO

      745    16473    6                          CALL KSW$WRITE(CN_VEC,VECTOR(KS_YES_NO));

  16473  4 000670   577640 235007                    LDA     -65632,DL
         4 000671   200376 452500                    STP2    MAX+1,,AUTO
         4 000672   200376 236100                    LDQ     MAX+1,,AUTO
         4 000673   000042 036003                    ADLQ    34,DU
         4 000674   200400 757100                    STAQ    MAX+3,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:116  
         4 000675   200400 630500                    EPPR0   MAX+3,,AUTO
         4 000676   200403 450500                    STP0    MAX+6,,AUTO
         4 000677   000065 236000 5                  LDQ     53
         4 000700   200402 756100                    STQ     MAX+5,,AUTO
         4 000701   200402 630500                    EPPR0   MAX+5,,AUTO
         4 000702   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000703   000000 701000 xent               TSX1    KSW$WRITE
         4 000704   000000 011000                    NOP     0

      746    16474
      747    16475    6                          CALL KSW$WRITE(QOS_VEC,VECTOR(KS_NODEINFO_V.QOS#));

  16475  4 000705   000070 630400 5                  EPPR0   56
         4 000706   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000707   000000 701000 xent               TSX1    KSW$WRITE
         4 000710   000000 011000                    NOP     0

      748    16476    6                          CALL KSW$WRITE(ALT_VEC,VECTOR(KS_NODEINFO_V.ALTQOS#));

  16476  4 000711   000074 630400 5                  EPPR0   60
         4 000712   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000713   000000 701000 xent               TSX1    KSW$WRITE
         4 000714   000000 011000                    NOP     0

      749    16477    6                         CALL KSW$WRITE(LNKNME_VEC,VECTOR(KS_NODEINFO_V.LINKNODENAME#)
             16477                                   );

  16477  4 000715   000100 630400 5                  EPPR0   64
         4 000716   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000717   000000 701000 xent               TSX1    KSW$WRITE
         4 000720   000000 011000                    NOP     0

      750    16478    6                         CALL KSW$WRITE(LNKNUM_VEC,VECTOR(KS_NODEINFO_V.LINKNODENUM#))
             16478                                   ;

  16478  4 000721   000104 630400 5                  EPPR0   68
         4 000722   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:117  
         4 000723   000000 701000 xent               TSX1    KSW$WRITE
         4 000724   000000 011000                    NOP     0

      751    16479    6                          IF KS_NODEINFO_V.LINKCONNECTED# THEN

  16479  4 000725   006456 236000 2                  LDQ     KS_NODEINFO_V+2
         4 000726   000040 316003                    CANQ    32,DU
         4 000727   000735 600000 4                  TZE     s:16482

      752    16480    6                             KS_YES_NO = 'Yes';

  16480  4 000730   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 000731   000035 376000 5                  ANQ     29
         4 000732   000040 276007                    ORQ     32,DL
         4 000733   200042 756100                    STQ     KS_YES_NO,,AUTO
         4 000734   000741 710000 4                  TRA     s:16483

      753    16481    6                          ELSE
      754    16482    6                             KS_YES_NO = 'No';

  16482  4 000735   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 000736   777777 376003                    ANQ     -1,DU
         4 000737   040040 276007                    ORQ     16416,DL
         4 000740   200042 756100                    STQ     KS_YES_NO,,AUTO

      755    16483    6                          CALL KSW$WRITE(LNKCNCT_VEC,VECTOR(KS_YES_NO));

  16483  4 000741   577640 235007                    LDA     -65632,DL
         4 000742   200376 452500                    STP2    MAX+1,,AUTO
         4 000743   200376 236100                    LDQ     MAX+1,,AUTO
         4 000744   000042 036003                    ADLQ    34,DU
         4 000745   200400 757100                    STAQ    MAX+3,,AUTO
         4 000746   200400 630500                    EPPR0   MAX+3,,AUTO
         4 000747   200403 450500                    STP0    MAX+6,,AUTO
         4 000750   000106 236000 5                  LDQ     70
         4 000751   200402 756100                    STQ     MAX+5,,AUTO
         4 000752   200402 630500                    EPPR0   MAX+5,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:118  
         4 000753   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000754   000000 701000 xent               TSX1    KSW$WRITE
         4 000755   000000 011000                    NOP     0

      756    16484    6                          END;  /* node type not = ' ' */

  16477  4 000756                       STAT_END_LO* null
      757    16485    5        STAT_END_LOOP:;
      758    16486    5                    END;    /* do loop for # of nodes */

  16486  4 000756   200045 235100                    LDA     L,,AUTO
         4 000757   000001 035007                    ADLA    1,DL
         4 000760   200045 755100                    STA     L,,AUTO
         4 000761   200327 236100                    LDQ     LAST,,AUTO
         4 000762   200045 116100                    CMPQ    L,,AUTO
         4 000763   000407 603000 4                  TRC     s:16424

      759    16487    4                 END;     /* else number of nodes >0  */

  16487  4 000764   005134 710000 4                  TRA     s:17309

      760    16488
      761    16489        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:119  
      762    16490    3              CASE(%KS_PSEUDO);

      763    16491    4                 IF KS_NODENAME = 'HOST' THEN DO;

  16491  4 000765   040000 106400                    CMPC    fill='040'O
         4 000766   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000767   002710 000004 1                  ADSC9   PARM_DISPONLY_FMT+4      cn=0,n=4
         4 000770   000776 601000 4                  TNZ     s:16495

      764    16492    4                    CALL KSE$ERRMSG(%E$KS_NONODE);

  16492  4 000771   000001 630400 5                  EPPR0   1
         4 000772   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000773   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000774   000000 011000                    NOP     0

      765    16493    4                    RETURN;

  16493  4 000775   000000 702200 xent               TSX2  ! X66_ARET

      766    16494    4                    END;  /* IF KS_NODENAME = 'HOST' */
      767    16495    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NODENAME);

  16495  4 000776   010000 236003                    LDQ     4096,DU
         4 000777   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

      768    16496    3                 KS_SUB_BUF_1.TEXT = KS_NODENAME;

  16496  4 001000   040000 100400                    MLR     fill='040'O
         4 001001   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 001002   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

      769    16497    3                 KS_PSEUDO_KEY.NODE = KS_NODE;

  16497  4 001003   000000 236000 xsym               LDQ     KS_NODE
         4 001004   000011 736000                    QLS     9
         4 001005   001150 552010 2                  STBQ    KS_PSEUDO_KEY,'10'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:120  

      770    16498    3                 READ_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);

  16498  4 001006   000110 237000 5                  LDAQ    72
         4 001007   006416 757000 2                  STAQ    READ_NETCON+2

      771    16499    3                 READ_NETCON.BUF_ = VECTOR(KS_PSEUDO);

  16499  4 001010   000112 237000 5                  LDAQ    74
         4 001011   006420 757000 2                  STAQ    READ_NETCON+4

      772    16500    4                 CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  16500  4 001012   006414 630400 2                  EPPR0   READ_NETCON
         4 001013   440000 713400                    CLIMB   alt,read
         4 001014   401400 401760                    pmme    nvectors=4
         4 001015   001017 702000 4                  TSX2    s:16501
         4 001016   001030 710000 4                  TRA     s:16505

      773    16501    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY

  16501  4 001017   000000 470400 xsym               LDP0    B$TCB$
         4 001020   000000 471500                    LDP1    0,,PR0
         4 001021   100102 236100                    LDQ     66,,PR1
         4 001022   377770 376007                    ANQ     131064,DL
         4 001023   001020 116007                    CMPQ    528,DL
         4 001024   001172 601000 4                  TNZ     PSEUDO_DISP_ERR

      774    16502    4                       THEN GOTO PSEUDO_DISP_ERR;
      775    16503    4                    KS_PSEUDO = '0'B;

  16503  4 001025   000000 100400                    MLR     fill='000'O
         4 001026   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001027   000402 002630 2                  ADSC9   KS_PSEUDO                cn=0,n=1432

      776    16504    4                    END;  /* WHEN ALTRETURN */

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:121  
      777    16505    4                 IF KS_PSEUDO.PSEUDO# = 0 THEN DO;

  16505  4 001030   000402 235000 2                  LDA     KS_PSEUDO
         4 001031   001037 601000 4                  TNZ     s:16512

      778    16506    4                    CALL KSE$ERRMSG(%E$KS_NOPSEUDOS,VECTOR(KS_SUB_BUF_1));

  16506  4 001032   000117 630400 5                  EPPR0   79
         4 001033   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001034   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001035   000000 011000                    NOP     0

      779    16507                         /*E* ERROR: KSN-E$KS_NOPSEUDOS-0
      780    16508                              MESSAGE: No pseudo resources defined for node %U1.
      781    16509                              DESCRIPTION: SEE MESSAGE.      */
      782    16510    4                    END;  /* IF NODE# = 0 */

  16510  4 001036   001171 710000 4                  TRA     s:16525

      783    16511    4                 ELSE DO;

      784    16512    4                    CALL KSW$WRITE(PSEUDOHDR_VEC);

  16512  4 001037   000121 630400 5                  EPPR0   81
         4 001040   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001041   000000 701000 xent               TSX1    KSW$WRITE
         4 001042   000000 011000                    NOP     0

      785    16513    5                    DO J = 0 TO KS_PSEUDO.PSEUDO# - 1;

  16513  4 001043   200077 450100                    STZ     J,,AUTO
         4 001044   001166 710000 4                  TRA     s:16523+3

      786    16514    5                       CALL KSW$WRITE(PSEUDO_NME_VEC,

  16514  4 001045   000002 235000 5                  LDA     2
         4 001046   200077 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:122  
         4 001047   200376 755100                    STA     MAX+1,,AUTO
         4 001050   000007 402003                    MPY     7,DU
         4 001051   000122 036000 5                  ADLQ    82
         4 001052   200376 235100                    LDA     MAX+1,,AUTO
         4 001053   200400 757100                    STAQ    MAX+3,,AUTO
         4 001054   777640 235007                    LDA     -96,DL
         4 001055   200077 236100                    LDQ     J,,AUTO
         4 001056   200402 755100                    STA     MAX+5,,AUTO
         4 001057   000007 402003                    MPY     7,DU
         4 001060   000123 036000 5                  ADLQ    83
         4 001061   200402 235100                    LDA     MAX+5,,AUTO
         4 001062   200404 757100                    STAQ    MAX+7,,AUTO
         4 001063   777640 235007                    LDA     -96,DL
         4 001064   200077 236100                    LDQ     J,,AUTO
         4 001065   200406 755100                    STA     MAX+9,,AUTO
         4 001066   000007 402003                    MPY     7,DU
         4 001067   000124 036000 5                  ADLQ    84
         4 001070   200406 235100                    LDA     MAX+9,,AUTO
         4 001071   200412 757100                    STAQ    MAX+13,,AUTO
         4 001072   200400 237100                    LDAQ    MAX+3,,AUTO
         4 001073   200410 757100                    STAQ    MAX+11,,AUTO
         4 001074   200404 237100                    LDAQ    MAX+7,,AUTO
         4 001075   200414 757100                    STAQ    MAX+15,,AUTO
         4 001076   200412 237100                    LDAQ    MAX+13,,AUTO
         4 001077   200416 757100                    STAQ    MAX+17,,AUTO
         4 001100   200416 630500                    EPPR0   MAX+17,,AUTO
         4 001101   200423 450500                    STP0    MAX+22,,AUTO
         4 001102   200414 631500                    EPPR1   MAX+15,,AUTO
         4 001103   200422 451500                    STP1    MAX+21,,AUTO
         4 001104   200410 633500                    EPPR3   MAX+11,,AUTO
         4 001105   200421 453500                    STP3    MAX+20,,AUTO
         4 001106   000125 236000 5                  LDQ     85
         4 001107   200420 756100                    STQ     MAX+19,,AUTO
         4 001110   200420 630500                    EPPR0   MAX+19,,AUTO
         4 001111   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001112   000000 701000 xent               TSX1    KSW$WRITE
         4 001113   000000 011000                    NOP     0
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:123  

      787    16515    5                             VECTOR(KS_PSEUDO.PSEUDO.NAME(J)),
      788    16516    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_GHST(J)),
      789    16517    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_HAND(J)));
      790    16518    5                       CALL KSW$WRITE(PSEUDO_USR_VEC,

  16518  4 001114   777640 235007                    LDA     -96,DL
         4 001115   200077 236100                    LDQ     J,,AUTO
         4 001116   200376 755100                    STA     MAX+1,,AUTO
         4 001117   000007 402003                    MPY     7,DU
         4 001120   000126 036000 5                  ADLQ    86
         4 001121   200376 235100                    LDA     MAX+1,,AUTO
         4 001122   200400 757100                    STAQ    MAX+3,,AUTO
         4 001123   777640 235007                    LDA     -96,DL
         4 001124   200077 236100                    LDQ     J,,AUTO
         4 001125   200402 755100                    STA     MAX+5,,AUTO
         4 001126   000007 402003                    MPY     7,DU
         4 001127   000127 036000 5                  ADLQ    87
         4 001130   200402 235100                    LDA     MAX+5,,AUTO
         4 001131   200404 757100                    STAQ    MAX+7,,AUTO
         4 001132   777640 235007                    LDA     -96,DL
         4 001133   200077 236100                    LDQ     J,,AUTO
         4 001134   200406 755100                    STA     MAX+9,,AUTO
         4 001135   000007 402003                    MPY     7,DU
         4 001136   000130 036000 5                  ADLQ    88
         4 001137   200406 235100                    LDA     MAX+9,,AUTO
         4 001140   200412 757100                    STAQ    MAX+13,,AUTO
         4 001141   200400 237100                    LDAQ    MAX+3,,AUTO
         4 001142   200410 757100                    STAQ    MAX+11,,AUTO
         4 001143   200404 237100                    LDAQ    MAX+7,,AUTO
         4 001144   200414 757100                    STAQ    MAX+15,,AUTO
         4 001145   200412 237100                    LDAQ    MAX+13,,AUTO
         4 001146   200416 757100                    STAQ    MAX+17,,AUTO
         4 001147   200416 630500                    EPPR0   MAX+17,,AUTO
         4 001150   200423 450500                    STP0    MAX+22,,AUTO
         4 001151   200414 631500                    EPPR1   MAX+15,,AUTO
         4 001152   200422 451500                    STP1    MAX+21,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:124  
         4 001153   200410 633500                    EPPR3   MAX+11,,AUTO
         4 001154   200421 453500                    STP3    MAX+20,,AUTO
         4 001155   000131 236000 5                  LDQ     89
         4 001156   200420 756100                    STQ     MAX+19,,AUTO
         4 001157   200420 630500                    EPPR0   MAX+19,,AUTO
         4 001160   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001161   000000 701000 xent               TSX1    KSW$WRITE
         4 001162   000000 011000                    NOP     0

      791    16519    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_CG(J)),
      792    16520    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_USR(J)),
      793    16521    5                             VECTOR(KS_PSEUDO.PSEUDO.MAX_SYS(J)));
      794    16522
      795    16523    5                       END;  /* DO J */

  16523  4 001163   200077 235100                    LDA     J,,AUTO
         4 001164   000001 035007                    ADLA    1,DL
         4 001165   200077 755100                    STA     J,,AUTO
         4 001166   200077 236100                    LDQ     J,,AUTO
         4 001167   000402 116000 2                  CMPQ    KS_PSEUDO
         4 001170   001045 602000 4                  TNC     s:16514

      796    16524    4                    END;  /* ELSE */

      797    16525    4                 DO WHILE('0'B);

  16525  4 001171   005134 710000 4                  TRA     s:17309

  16520  4 001172                       PSEUDO_DISP* null
      798    16526    4   PSEUDO_DISP_ERR:;
      799    16527    4                    CALL KSE$ERRMSG(0);

  16527  4 001172   000132 630400 5                  EPPR0   90
         4 001173   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001174   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001175   000000 011000                    NOP     0

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:125  
      800    16528    4                    KS_SUB_BUF_1.COUNT = SIZEC('PSEUDO');

  16528  4 001176   006000 236003                    LDQ     3072,DU
         4 001177   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

      801    16529    4                    KS_SUB_BUF_1.TEXT = 'PSEUDO';

  16529  4 001200   040000 100400                    MLR     fill='040'O
         4 001201   002723 000006 1                  ADSC9   PARM_DISPONLY_FMT+15     cn=0,n=6
         4 001202   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

      802    16530    4                    CALL KSE$ERRMSG(%E$KS_CANTDIPARM);

  16530  4 001203   000134 630400 5                  EPPR0   92
         4 001204   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001205   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001206   000000 011000                    NOP     0

      803    16531    4                    END;  /* DO NEVER */

  16531  4 001207   005134 710000 4                  TRA     s:17309

      804    16532        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:126  
      805    16533    3              CASE (%KS_LNCONFIG,%KS_DFLTCNFG);

      806    16534    3                 IF BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN

  16534  4 001210   300003 474500                    LDP4    3,,PR3
         4 001211   400000 722100                    LXL2    0,,PR4
         4 001212   000001 102003                    CMPX2   1,DU
         4 001213   001235 601000 4                  TNZ     s:16544

      807    16535    4                    DO;

      808    16536    4                    CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));

  16536  4 001214   400003 635500                    EPPR5   3,,PR4
         4 001215   200355 455500                    STP5    SUBLK_INDX+2,,AUTO
         4 001216   005206 701000 4                  TSX1    GET_NODE
         4 001217   000000 011000                    NOP     0

      809    16537    4                    KS_NODENAME_SV = KS_NODENAME;

  16537  4 001220   040000 100400                    MLR     fill='040'O
         4 001221   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 001222   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8

      810    16538    4                    KS_NODE_SV = KS_NODE;

  16538  4 001223   000000 235000 xsym               LDA     KS_NODE
         4 001224   000000 755000 xsym               STA     KS_NODE_SV

      811    16539    4                    KS_NODENAME = FEPNAME;

  16539  4 001225   040000 100500                    MLR     fill='040'O
         4 001226   200201 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 001227   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

      812    16540    4                    KS_NODE = FEPNODE;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:127  
  16540  4 001230   200200 236100                    LDQ     FEPNODE,,AUTO
         4 001231   000000 756000 xsym               STQ     KS_NODE

      813    16541    4                    SUBLK_INDX = 1;

  16541  4 001232   001000 236003                    LDQ     512,DU
         4 001233   200353 756100                    STQ     SUBLK_INDX,,AUTO

      814    16542    4                    END;

  16542  4 001234   001236 710000 4                  TRA     s:16546

      815    16543    3                 ELSE
      816    16544    3                    SUBLK_INDX = 0;

  16544  4 001235   200353 450100                    STZ     SUBLK_INDX,,AUTO

      817    16545
      818    16546    3                 READ_NETCON.V.KEYS# = '1'B;

  16546  4 001236   200000 236007                    LDQ     65536,DL
         4 001237   006424 256000 2                  ORSQ    READ_NETCON+8

      819    16547    3                 READ_NETCON.V.KEYR# = '0'B;

  16547  4 001240   000000 236000 5                  LDQ     0
         4 001241   006424 356000 2                  ANSQ    READ_NETCON+8

      820    16548
      821    16549    3                 IF (BLK$->OUT$BLK.CODE = %KS_DFLTCNFG) THEN

  16549  4 001242   200173 470500                    LDP0    BLK$,,AUTO
         4 001243   000000 720100                    LXL0    0,,PR0
         4 001244   000011 100003                    CMPX0   9,DU
         4 001245   001332 601000 4                  TNZ     DEFTERM

      822    16550    4                    DO;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:128  

      823    16551    4                       IF KS_NODENAME='HOST' THEN

  16551  4 001246   040000 106400                    CMPC    fill='040'O
         4 001247   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 001250   002710 000004 1                  ADSC9   PARM_DISPONLY_FMT+4      cn=0,n=4
         4 001251   001257 601000 4                  TNZ     s:16556

      824    16552    5                          DO;

      825    16553    5                             CALL KSE$ERRMSG(%E$KS_NONODE);

  16553  4 001252   000001 630400 5                  EPPR0   1
         4 001253   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001254   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001255   000000 011000                    NOP     0

      826    16554    5                             RETURN;

  16554  4 001256   000000 702200 xent               TSX2  ! X66_ARET

      827    16555    5                          END;
      828    16556    4                 KS_SUB_BUF_1.COUNT = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$SYM.COUNT;

  16556  4 001257   200353 236100                    LDQ     SUBLK_INDX,,AUTO
         4 001260   000033 772000                    QRL     27
         4 001261   000003 471506                    LDP1    3,QL,PR0
         4 001262   100004 236100                    LDQ     4,,PR1
         4 001263   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

      829    16557    4                 KS_SUB_BUF_1.TEXT  = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$SYM.TEXT;

  16557  4 001264   200353 236100                    LDQ     SUBLK_INDX,,AUTO
         4 001265   000033 772000                    QRL     27
         4 001266   000003 471506                    LDP1    3,QL,PR0
         4 001267   100004 236100                    LDQ     4,,PR1
         4 001270   000033 772000                    QRL     27
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:129  
         4 001271   000000 620006                    EAX0    0,QL
         4 001272   040000 100540                    MLR     fill='040'O
         4 001273   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 001274   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

      830    16558    4                    KS_DISP_RNG = '0'B;

  16558  4 001275   000001 450000 2                  STZ     KS_DISP_RNG

      831    16559    4       DEF_OPT = 2;

  16559  4 001276   000002 235007                    LDA     2,DL
         4 001277   200073 755100                    STA     DEF_OPT,,AUTO

      832    16560    4                    FIRST = '0'B;

  16560  4 001300   000000 450000 2                  STZ     FIRST

      833    16561    4                    KS_DEFAULT_KEY.NODE = KS_NODE;

  16561  4 001301   000000 236000 xsym               LDQ     KS_NODE
         4 001302   000011 736000                    QLS     9
         4 001303   000364 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

      834    16562    4                    KS_DEFAULT_KEY.HNDLR = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$SYM.
             16562                             TEXT;

  16562  4 001304   200353 236100                    LDQ     SUBLK_INDX,,AUTO
         4 001305   000033 772000                    QRL     27
         4 001306   000003 471506                    LDP1    3,QL,PR0
         4 001307   100004 236100                    LDQ     4,,PR1
         4 001310   000033 772000                    QRL     27
         4 001311   000000 620006                    EAX0    0,QL
         4 001312   040000 100540                    MLR     fill='040'O
         4 001313   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 001314   000364 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:130  
      835    16563    4                    READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);

  16563  4 001315   000136 237000 5                  LDAQ    94
         4 001316   006420 757000 2                  STAQ    READ_NETCON+4

      836    16564    4                    READ_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);

  16564  4 001317   000140 237000 5                  LDAQ    96
         4 001320   006416 757000 2                  STAQ    READ_NETCON+2

      837    16565    4                    CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);

  16565  4 001321   006414 630400 2                  EPPR0   READ_NETCON
         4 001322   440000 713400                    CLIMB   alt,read
         4 001323   401400 401760                    pmme    nvectors=4
         4 001324   005135 702000 4                  TSX2    DISP_ERR

      838    16566    4                    CALL KSW$WRITE(DIHNDLR_VEC,VECTOR(KS_DEFAULT_KEY.HNDLR),VECTOR(
             16566                             KS_NODE),VECTOR(KS_NODENAME));

  16566  4 001325   000146 630400 5                  EPPR0   102
         4 001326   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001327   000000 701000 xent               TSX1    KSW$WRITE
         4 001330   000000 011000                    NOP     0

      839    16567    4                    END;

  16567  4 001331   001705 710000 4                  TRA     s:16673

      840    16568    3                 ELSE
      841    16569    4       DEFTERM:     DO;

  16569  4 001332                       DEFTERM      null
      842    16570    4                 KS_SUB_BUF_1.COUNT = SIZEC('Configuration');

  16570  4 001332   015000 236003                    LDQ     6656,DU
         4 001333   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:131  

      843    16571    4                 KS_SUB_BUF_1.TEXT  = 'Configuration';

  16571  4 001334   040000 100400                    MLR     fill='040'O
         4 001335   002725 000015 1                  ADSC9   PARM_DISPONLY_FMT+17     cn=0,n=13
         4 001336   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

      844    16572    4                 KS_CONFIG_KEY = KS$CONFIG_KEY;

  16572  4 001337   000100 100400                    MLR     fill='000'O
         4 001340   000357 000023 2                  ADSC9   KS$CONFIG_KEY            cn=0,n=19
         4 001341   200034 000023                    ADSC9   KS_CONFIG_KEY,,AUTO      cn=0,n=19

      845    16573
      846    16574    4           IF SUBLK_INDX  < BLK$->OUT$BLK.NSUBLKS - 1 THEN

  16574  4 001342   000001 236100                    LDQ     1,,PR0
         4 001343   000022 772000                    QRL     18
         4 001344   000001 136007                    SBLQ    1,DL
         4 001345   200376 756100                    STQ     MAX+1,,AUTO
         4 001346   200353 236100                    LDQ     SUBLK_INDX,,AUTO
         4 001347   000033 772000                    QRL     27
         4 001350   200376 116100                    CMPQ    MAX+1,,AUTO
         4 001351   001406 605000 4                  TPL     s:16587

      847    16575    5              DO;

      848    16576    5                 DEF_OPT = 1;

  16576  4 001352   000001 235007                    LDA     1,DL
         4 001353   200073 755100                    STA     DEF_OPT,,AUTO

      849    16577    5                 KS_DEFAULT_KEY.NODE = KS_NODE;

  16577  4 001354   000000 236000 xsym               LDQ     KS_NODE
         4 001355   000011 736000                    QLS     9
         4 001356   000364 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:132  

      850    16578    5                 KS_DEFAULT_KEY.HNDLR = BLK$->OUT$BLK.SUBLK$(SUBLK_INDX+1)->

  16578  4 001357   200353 236100                    LDQ     SUBLK_INDX,,AUTO
         4 001360   000033 772000                    QRL     27
         4 001361   000004 471506                    LDP1    4,QL,PR0
         4 001362   100003 473500                    LDP3    3,,PR1
         4 001363   300004 236100                    LDQ     4,,PR3
         4 001364   000033 772000                    QRL     27
         4 001365   000000 620006                    EAX0    0,QL
         4 001366   040000 100540                    MLR     fill='040'O
         4 001367   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 001370   000364 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

      851    16579    5                 OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      852    16580    5                 READ_NETCON.V.KEYS# = '1'B;

  16580  4 001371   200000 236007                    LDQ     65536,DL
         4 001372   006424 256000 2                  ORSQ    READ_NETCON+8

      853    16581    5                 READ_NETCON.V.KEYR# = '0'B;

  16581  4 001373   000000 236000 5                  LDQ     0
         4 001374   006424 356000 2                  ANSQ    READ_NETCON+8

      854    16582    5                 READ_NETCON.BUF_ = VECTOR(DEF_BUFFER);

  16582  4 001375   000152 237000 5                  LDAQ    106
         4 001376   006420 757000 2                  STAQ    READ_NETCON+4

      855    16583    5                 READ_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);

  16583  4 001377   000140 237000 5                  LDAQ    96
         4 001400   006416 757000 2                  STAQ    READ_NETCON+2

      856    16584    5                 CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:133  
  16584  4 001401   006414 630400 2                  EPPR0   READ_NETCON
         4 001402   440000 713400                    CLIMB   alt,read
         4 001403   401400 401760                    pmme    nvectors=4
         4 001404   005135 702000 4                  TSX2    DISP_ERR

      857    16585    5              END;

  16585  4 001405   001407 710000 4                  TRA     s:16589

      858    16586    4           ELSE
      859    16587    4              DEF_OPT = 0;

  16587  4 001406   200073 450100                    STZ     DEF_OPT,,AUTO

      860    16588
      861    16589    4                    IF BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.CODE = %KS_FULL THEN

  16589  4 001407   200353 236100                    LDQ     SUBLK_INDX,,AUTO
         4 001410   000033 772000                    QRL     27
         4 001411   200173 470500                    LDP0    BLK$,,AUTO
         4 001412   000003 471506                    LDP1    3,QL,PR0
         4 001413   100000 720100                    LXL0    0,,PR1
         4 001414   000006 100003                    CMPX0   6,DU
         4 001415   001456 601000 4                  TNZ     s:16605

      862    16590    5                       DO;

      863    16591    5                       KS_DISP_RNG = '1'B;

  16591  4 001416   400000 236003                    LDQ     -131072,DU
         4 001417   000001 756000 2                  STQ     KS_DISP_RNG

      864    16592    5                       FIRST = '1'B;

  16592  4 001420   000000 756000 2                  STQ     FIRST

      865    16593    5                       TERMLO = '0'B;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:134  

  16593  4 001421   000100 100400                    MLR     fill='000'O
         4 001422   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001423   200004 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16

      866    16594    5                       TERMHI = '0'B;

  16594  4 001424   000100 100400                    MLR     fill='000'O
         4 001425   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001426   200010 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16

      867    16595    5                       TERMLO.LEV = 1;

  16595  4 001427   000001 236003                    LDQ     1,DU
         4 001430   200004 552120                    STBQ    TERMLO,'20'O,AUTO

      868    16596    5                       KS_CONFIG_KEY.TERMID = TERMLO;

  16596  4 001431   000100 100500                    MLR     fill='000'O
         4 001432   200004 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 001433   200034 600020                    ADSC9   KS_CONFIG_KEY,,AUTO      cn=3,n=16

      869    16597    5                       TERMHI.TERM.CHANNEL.BYT(0) = BITBIN('377'O);

  16597  4 001434   377000 236007                    LDQ     130560,DL
         4 001435   200010 256100                    ORSQ    TERMHI,,AUTO

      870    16598    5                       TERMHI.LEV = 1;

  16598  4 001436   000001 236003                    LDQ     1,DU
         4 001437   200010 552120                    STBQ    TERMHI,'20'O,AUTO

      871    16599    5                       KS_CONFIG_KEY.NODE = KS_NODE;

  16599  4 001440   000000 236000 xsym               LDQ     KS_NODE
         4 001441   000011 736000                    QLS     9
         4 001442   200034 552110                    STBQ    KS_CONFIG_KEY,'10'O,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:135  

      872    16600    5                       CNFG_BUFFER = '0'B;

  16600  4 001443   000000 100400                    MLR     fill='000'O
         4 001444   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001445   000004 000310 2                  ADSC9   CNFG_BUFFER              cn=0,n=200

      873    16601    5                       READ_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);

  16601  4 001446   000154 235000 5                  LDA     108
         4 001447   200376 452500                    STP2    MAX+1,,AUTO
         4 001450   200376 236100                    LDQ     MAX+1,,AUTO
         4 001451   000034 036003                    ADLQ    28,DU
         4 001452   006416 757000 2                  STAQ    READ_NETCON+2

      874    16602    5                       READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);

  16602  4 001453   000136 237000 5                  LDAQ    94
         4 001454   006420 757000 2                  STAQ    READ_NETCON+4

      875    16603    5                       END;

  16603  4 001455   001602 710000 4                  TRA     s:16648

      876    16604    5                       ELSE DO;  /* if full not specified  */

      877    16605    5                    CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.
             16605                             SUBLK$(0),TERMLO) WHENALTRETURN

  16605  4 001456   200004 633500                    EPPR3   TERMLO,,AUTO
         4 001457   200377 453500                    STP3    MAX+2,,AUTO
         4 001460   100003 634500                    EPPR4   3,,PR1
         4 001461   200376 454500                    STP4    MAX+1,,AUTO
         4 001462   200376 630500                    EPPR0   MAX+1,,AUTO
         4 001463   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001464   000000 701000 xent               TSX1    KSU$BLD_TERMID
         4 001465   001467 702000 4                  TSX2    s:16607
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:136  
         4 001466   001473 710000 4                  TRA     s:16610

      878    16606    6                       DO;

      879    16607    6                       IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM THEN

  16607  4 001467   000000 236000 xsym               LDQ     KS_ERRCODE
         4 001470   377770 376007                    ANQ     131064,DL
         4 001471   000270 116007                    CMPQ    184,DL
         4 001472   005135 601000 4                  TNZ     DISP_ERR

      880    16608    6                          GOTO DISP_ERR;
      881    16609    6                       END;  /*  altreturn on termlo   */

      882    16610    5                    IF (BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.NSUBLKS = 2) THEN

  16610  4 001473   200353 236100                    LDQ     SUBLK_INDX,,AUTO
         4 001474   000033 772000                    QRL     27
         4 001475   200173 470500                    LDP0    BLK$,,AUTO
         4 001476   000003 471506                    LDP1    3,QL,PR0
         4 001477   100001 220100                    LDX0    1,,PR1
         4 001500   000002 100003                    CMPX0   2,DU
         4 001501   001541 601000 4                  TNZ     s:16627

      883    16611    6                       DO;

      884    16612    6                       CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SUBLK_INDX)->OUT$BLK.
             16612                                SUBLK$(1),TERMHI) WHENALTRETURN

  16612  4 001502   200010 633500                    EPPR3   TERMHI,,AUTO
         4 001503   200377 453500                    STP3    MAX+2,,AUTO
         4 001504   100004 634500                    EPPR4   4,,PR1
         4 001505   200376 454500                    STP4    MAX+1,,AUTO
         4 001506   200376 630500                    EPPR0   MAX+1,,AUTO
         4 001507   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001510   000000 701000 xent               TSX1    KSU$BLD_TERMID
         4 001511   001513 702000 4                  TSX2    s:16614
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:137  
         4 001512   001517 710000 4                  TRA     s:16617

      885    16613    7                          DO;

      886    16614    7                          IF KS_ERRCODE.CODE ~= %E$KS_NO_CHAN_FOR_TRM THEN

  16614  4 001513   000000 236000 xsym               LDQ     KS_ERRCODE
         4 001514   377770 376007                    ANQ     131064,DL
         4 001515   000270 116007                    CMPQ    184,DL
         4 001516   005141 601000 4                  TNZ     ERR1

      887    16615    7                             GOTO ERR1;
      888    16616    7                          END;  /* altreturn on termhi */

      889    16617    6                       CALL KSU$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN

  16617  4 001517   200010 630500                    EPPR0   TERMHI,,AUTO
         4 001520   200377 450500                    STP0    MAX+2,,AUTO
         4 001521   200004 631500                    EPPR1   TERMLO,,AUTO
         4 001522   200376 451500                    STP1    MAX+1,,AUTO
         4 001523   200376 630500                    EPPR0   MAX+1,,AUTO
         4 001524   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001525   000000 701000 xent               TSX1    KSU$CHK_TRM_RNG
         4 001526   001530 702000 4                  TSX2    s:16619
         4 001527   001535 710000 4                  TRA     s:16623

      890    16618    7                             DO;

      891    16619    7                             CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);

  16619  4 001530   000156 630400 5                  EPPR0   110
         4 001531   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001532   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001533   000000 011000                    NOP     0

      892    16620    7                             GOTO ERR1;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:138  
  16620  4 001534   005141 710000 4                  TRA     ERR1

      893    16621    7                             END;
      894    16622
      895    16623    6                       KS_DISP_RNG = '1'B;

  16623  4 001535   400000 236003                    LDQ     -131072,DU
         4 001536   000001 756000 2                  STQ     KS_DISP_RNG

      896    16624    6                       FIRST = '1'B;

  16624  4 001537   000000 756000 2                  STQ     FIRST

      897    16625    6                       END;

  16625  4 001540   001546 710000 4                  TRA     s:16631

      898    16626    6                    ELSE DO;

      899    16627    6                       KS_DISP_RNG = '0'B;

  16627  4 001541   000001 450000 2                  STZ     KS_DISP_RNG

      900    16628    6                       TERMHI = TERMLO;

  16628  4 001542   000100 100500                    MLR     fill='000'O
         4 001543   200004 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 001544   200010 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16

      901    16629    6                       FIRST = '0'B;

  16629  4 001545   000000 450000 2                  STZ     FIRST

      902    16630    6                    END;

      903    16631    5                 IF KS_NODENAME='HOST' AND TERMLO.TERM.TERM_NAME = ' ' THEN

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:139  
  16631  4 001546   040000 106400                    CMPC    fill='040'O
         4 001547   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 001550   002710 000004 1                  ADSC9   PARM_DISPONLY_FMT+4      cn=0,n=4
         4 001551   001562 601000 4                  TNZ     s:16637
         4 001552   200006 237100                    LDAQ    TERMLO+2,,AUTO
         4 001553   000160 117000 5                  CMPAQ   112
         4 001554   001562 601000 4                  TNZ     s:16637

      904    16632    6                    DO;

      905    16633    6                       CALL KSE$ERRMSG(%E$KS_NONODE);

  16633  4 001555   000001 630400 5                  EPPR0   1
         4 001556   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001557   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001560   000000 011000                    NOP     0

      906    16634    6                       RETURN;

  16634  4 001561   000000 702200 xent               TSX2  ! X66_ARET

      907    16635    6                    END;
      908    16636
      909    16637    5                    CNFG_BUFFER = '0'B;

  16637  4 001562   000000 100400                    MLR     fill='000'O
         4 001563   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001564   000004 000310 2                  ADSC9   CNFG_BUFFER              cn=0,n=200

      910    16638    5                    KS_CONFIG_KEY.TERMID = TERMLO;

  16638  4 001565   000100 100500                    MLR     fill='000'O
         4 001566   200004 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 001567   200034 600020                    ADSC9   KS_CONFIG_KEY,,AUTO      cn=3,n=16

      911    16639
      912    16640    5                    IF TERMLO.TERM.TERM_NAME ~= ' ' THEN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:140  

  16640  4 001570   200006 237100                    LDAQ    TERMLO+2,,AUTO
         4 001571   000160 117000 5                  CMPAQ   112
         4 001572   001577 600000 4                  TZE     s:16646

      913    16641    6                       DO;

      914    16642    6                          KS_CONFIG_KEY.NODE = 0;

  16642  4 001573   000000 236003                    LDQ     0,DU
         4 001574   200034 552110                    STBQ    KS_CONFIG_KEY,'10'O,AUTO

      915    16643    6                          KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;

  16643  4 001575   200035 552130                    STBQ    KS_CONFIG_KEY+1,'30'O,AUTO

      916    16644    6                       END;

  16644  4 001576   001602 710000 4                  TRA     s:16648

      917    16645    5                    ELSE
      918    16646    5                       KS_CONFIG_KEY.NODE = KS_NODE;

  16646  4 001577   000000 236000 xsym               LDQ     KS_NODE
         4 001600   000011 736000                    QLS     9
         4 001601   200034 552110                    STBQ    KS_CONFIG_KEY,'10'O,AUTO

      919    16647    5                 END;  /*end of else part of di config full */

      920    16648    4              CALL KSU$READ_NETCON (VECTOR(KS_CONFIG_KEY),VECTOR(CNFG_BUFFER))
             16648                       WHENALTRETURN

  16648  4 001602   000154 235000 5                  LDA     108
         4 001603   200376 452500                    STP2    MAX+1,,AUTO
         4 001604   200376 236100                    LDQ     MAX+1,,AUTO
         4 001605   000034 036003                    ADLQ    28,DU
         4 001606   200400 757100                    STAQ    MAX+3,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:141  
         4 001607   000162 236000 5                  LDQ     114
         4 001610   200403 756100                    STQ     MAX+6,,AUTO
         4 001611   200400 630500                    EPPR0   MAX+3,,AUTO
         4 001612   200402 450500                    STP0    MAX+5,,AUTO
         4 001613   200402 630500                    EPPR0   MAX+5,,AUTO
         4 001614   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001615   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 001616   001620 702000 4                  TSX2    s:16651
         4 001617   001705 710000 4                  TRA     s:16673

      921    16649
      922    16650    5                       DO;

      923    16651    5                       IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$NOKEY AND

  16651  4 001620   000000 470400 xsym               LDP0    B$TCB$
         4 001621   000000 471500                    LDP1    0,,PR0
         4 001622   100102 236100                    LDQ     66,,PR1
         4 001623   377770 376007                    ANQ     131064,DL
         4 001624   001020 116007                    CMPQ    528,DL
         4 001625   005135 601000 4                  TNZ     DISP_ERR
         4 001626   000001 234000 2                  SZN     KS_DISP_RNG
         4 001627   005135 605000 4                  TPL     DISP_ERR

      924    16652    5                          KS_DISP_RNG THEN
      925    16653    6                          DO;

      926    16654    6                          PREC_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);

  16654  4 001630   000154 235000 5                  LDA     108
         4 001631   200376 452500                    STP2    MAX+1,,AUTO
         4 001632   200376 236100                    LDQ     MAX+1,,AUTO
         4 001633   000034 036003                    ADLQ    28,DU
         4 001634   006434 757000 2                  STAQ    PREC_NETCON+2

      927    16655    6                          CALL M$PRECORD(PREC_NETCON) WHENALTRETURN

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:142  
  16655  4 001635   006432 630400 2                  EPPR0   PREC_NETCON
         4 001636   440003 713400                    CLIMB   alt,+16387
         4 001637   401000 401760                    pmme    nvectors=3
         4 001640   001642 702000 4                  TSX2    s:16657
         4 001641   001704 710000 4                  TRA     s:16667

      928    16656    7         DO;

      929    16657    7           READ_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);

  16657  4 001642   000154 235000 5                  LDA     108
         4 001643   200376 452500                    STP2    MAX+1,,AUTO
         4 001644   200376 236100                    LDQ     MAX+1,,AUTO
         4 001645   000034 036003                    ADLQ    28,DU
         4 001646   006416 757000 2                  STAQ    READ_NETCON+2

      930    16658    7           READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);

  16658  4 001647   000136 237000 5                  LDAQ    94
         4 001650   006420 757000 2                  STAQ    READ_NETCON+4

      931    16659    7                             READ_NETCON.V.KEYS# = '0'B;

  16659  4 001651   000163 236000 5                  LDQ     115
         4 001652   006424 356000 2                  ANSQ    READ_NETCON+8

      932    16660    7                             READ_NETCON.V.KEYR# = '1'B;

  16660  4 001653   100000 236007                    LDQ     32768,DL
         4 001654   006424 256000 2                  ORSQ    READ_NETCON+8

      933    16661    7                             CALL M$READ(READ_NETCON) ALTRET(DISP_ERR);

  16661  4 001655   006414 630400 2                  EPPR0   READ_NETCON
         4 001656   440000 713400                    CLIMB   alt,read
         4 001657   401400 401760                    pmme    nvectors=4
         4 001660   005135 702000 4                  TSX2    DISP_ERR
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:143  

      934    16662    7                             IF KS_CONFIG_KEY.NODE ~= KS_NODE OR

  16662  4 001661   200034 236100                    LDQ     KS_CONFIG_KEY,,AUTO
         4 001662   000011 772000                    QRL     9
         4 001663   000777 376007                    ANQ     511,DL
         4 001664   000000 116000 xsym               CMPQ    KS_NODE
         4 001665   005135 601000 4                  TNZ     DISP_ERR
         4 001666   200034 236100                    LDQ     KS_CONFIG_KEY,,AUTO
         4 001667   000777 376003                    ANQ     511,DU
         4 001670   000002 116003                    CMPQ    2,DU
         4 001671   005135 601000 4                  TNZ     DISP_ERR

      935    16663    7                                KS_CONFIG_KEY.TYP  ~= %KL_KEYTYP_CONFIG THEN
      936    16664    7                                   GOTO DISP_ERR;
      937    16665    7                             CALL KSU$CHK_TRM_RNG(KS_CONFIG_KEY.TERMID,TERMHI) ALTRET(
             16665                                      DISP_ERR);

  16665  4 001672   200010 630500                    EPPR0   TERMHI,,AUTO
         4 001673   200377 450500                    STP0    MAX+2,,AUTO
         4 001674   200400 452500                    STP2    MAX+3,,AUTO
         4 001675   200400 236100                    LDQ     MAX+3,,AUTO
         4 001676   000164 036000 5                  ADLQ    116
         4 001677   200376 756100                    STQ     MAX+1,,AUTO
         4 001700   200376 630500                    EPPR0   MAX+1,,AUTO
         4 001701   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001702   000000 701000 xent               TSX1    KSU$CHK_TRM_RNG
         4 001703   005135 702000 4                  TSX2    DISP_ERR

      938    16666    7                             END;  /* end of 2nd read */

      939    16667    6                          END;  /* if error code = no key and display range*/

  16667  4 001704   001705 710000 4                  TRA     s:16673

      940    16668    5                       ELSE
      941    16669    5                          GOTO DISP_ERR;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:144  
      942    16670    5                       END;
      943    16671    4                    END;/*   end of else part of if default  */

      944    16672    4                 DO WHILE ('1'B);

      945    16673    4                    IF BLK$->OUT$BLK.CODE = %KS_LNCONFIG THEN

  16673  4 001705   200173 470500                    LDP0    BLK$,,AUTO
         4 001706   000000 720100                    LXL0    0,,PR0
         4 001707   000010 100003                    CMPX0   8,DU
         4 001710   002102 601000 4                  TNZ     s:16712

      946    16674    5                       DO;

      947    16675    5                       IF KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = ' ' THEN

  16675  4 001711   040000 106500                    CMPC    fill='040'O
         4 001712   200036 600010                    ADSC9   KS_CONFIG_KEY+2,,AUTO    cn=3,n=8
         4 001713   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001714   001762 601000 4                  TNZ     s:16693

      948    16676    6                          DO;

      949    16677                               %ARRAY_TO_WORD(S="KS_CONFIG_KEY.TERMID.TERM.CHANNEL",D=
             16677                                   ATTRIBUTE);

  16678  4 001715   200041 631500                    EPPR1   ATTRIBUTE,,AUTO
         4 001716   200216 451500                    STP1    D$,,AUTO

  16679  4 001717   200376 452500                    STP2    MAX+1,,AUTO
         4 001720   200376 236100                    LDQ     MAX+1,,AUTO
         4 001721   000165 036000 5                  ADLQ    117
         4 001722   200214 756100                    STQ     S$,,AUTO

  16680  4 001723   200041 450100                    STZ     ATTRIBUTE,,AUTO

  16681  4 001724   000001 235007                    LDA     1,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:145  
         4 001725   200215 755100                    STA     BINDX,,AUTO

  16682  4 001726   200214 470500                    LDP0    S$,,AUTO
         4 001727   200215 235100                    LDA     BINDX,,AUTO
         4 001730   200216 471500                    LDP1    D$,,AUTO
         4 001731   003105 060505                    CSL     bolr='003'O
         4 001732   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 001733   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  16683  4 001734   000001 035007                    ADLA    1,DL
         4 001735   200215 755100                    STA     BINDX,,AUTO
         4 001736   000011 115007                    CMPA    9,DL
         4 001737   001726 602000 4                  TNC     s:16682

  16684  4 001740   000012 236007                    LDQ     10,DL
         4 001741   200215 756100                    STQ     BINDX,,AUTO

  16685  4 001742   200214 470500                    LDP0    S$,,AUTO
         4 001743   200215 235100                    LDA     BINDX,,AUTO
         4 001744   200216 471500                    LDP1    D$,,AUTO
         4 001745   003105 060505                    CSL     bolr='003'O
         4 001746   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 001747   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  16686  4 001750   000001 035007                    ADLA    1,DL
         4 001751   200215 755100                    STA     BINDX,,AUTO
         4 001752   000022 115007                    CMPA    18,DL
         4 001753   001742 602000 4                  TNC     s:16685

  16687  4 001754   003100 061500                    CSR     bolr='003'O
         4 001755   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 001756   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 001757   200376 236100                    LDQ     MAX+1,,AUTO
         4 001760   200041 756100                    STQ     ATTRIBUTE,,AUTO

      950    16689    6                          END;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:146  
  16689  4 001761   002026 710000 4                  TRA     s:16709

      951    16690    5                       ELSE
      952    16691    6                          DO;

      953    16692                               %ARRAY_TO_WORD(S="TERMLO.TERM.CHANNEL",D=ATTRIBUTE);

  16693  4 001762   200041 631500                    EPPR1   ATTRIBUTE,,AUTO
         4 001763   200216 451500                    STP1    D$,,AUTO

  16694  4 001764   200376 452500                    STP2    MAX+1,,AUTO
         4 001765   200376 236100                    LDQ     MAX+1,,AUTO
         4 001766   000166 036000 5                  ADLQ    118
         4 001767   200214 756100                    STQ     S$,,AUTO

  16695  4 001770   200041 450100                    STZ     ATTRIBUTE,,AUTO

  16696  4 001771   000001 235007                    LDA     1,DL
         4 001772   200215 755100                    STA     BINDX,,AUTO

  16697  4 001773   200214 470500                    LDP0    S$,,AUTO
         4 001774   200215 235100                    LDA     BINDX,,AUTO
         4 001775   200216 471500                    LDP1    D$,,AUTO
         4 001776   003105 060505                    CSL     bolr='003'O
         4 001777   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 002000   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  16698  4 002001   000001 035007                    ADLA    1,DL
         4 002002   200215 755100                    STA     BINDX,,AUTO
         4 002003   000011 115007                    CMPA    9,DL
         4 002004   001773 602000 4                  TNC     s:16697

  16699  4 002005   000012 236007                    LDQ     10,DL
         4 002006   200215 756100                    STQ     BINDX,,AUTO

  16700  4 002007   200214 470500                    LDP0    S$,,AUTO
         4 002010   200215 235100                    LDA     BINDX,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:147  
         4 002011   200216 471500                    LDP1    D$,,AUTO
         4 002012   003105 060505                    CSL     bolr='003'O
         4 002013   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 002014   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  16701  4 002015   000001 035007                    ADLA    1,DL
         4 002016   200215 755100                    STA     BINDX,,AUTO
         4 002017   000022 115007                    CMPA    18,DL
         4 002020   002007 602000 4                  TNC     s:16700

  16702  4 002021   003100 061500                    CSR     bolr='003'O
         4 002022   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 002023   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 002024   200376 236100                    LDQ     MAX+1,,AUTO
         4 002025   200041 756100                    STQ     ATTRIBUTE,,AUTO

      954    16704    6                          END;

      955    16705    5                        CALL KSW$WRITE(LNCNFG_VEC, VECTOR(KS_NODE),
      956    16706    5                                       VECTOR(KS_NODENAME),VECTOR(ATTRIBUTE),
      957    16707    5                                       VECTOR(KS_CONFIG_KEY.TERMID.TERM.SUBDEVICE),
      958    16708    5                                       VECTOR(KS_CONFIG_KEY.TERMID.TERM.SUBSUBDEVICE),
      959    16709    5                                       VECTOR(KS_CONFIG_KEY.TERMID.TERM.TERM_NAME));

  16709  4 002026   777640 235007                    LDA     -96,DL
         4 002027   200376 452500                    STP2    MAX+1,,AUTO
         4 002030   200376 236100                    LDQ     MAX+1,,AUTO
         4 002031   000041 036003                    ADLQ    33,DU
         4 002032   200400 757100                    STAQ    MAX+3,,AUTO
         4 002033   377640 235007                    LDA     130976,DL
         4 002034   200402 452500                    STP2    MAX+5,,AUTO
         4 002035   200402 236100                    LDQ     MAX+5,,AUTO
         4 002036   000167 036000 5                  ADLQ    119
         4 002037   200404 757100                    STAQ    MAX+7,,AUTO
         4 002040   377640 235007                    LDA     130976,DL
         4 002041   200406 452500                    STP2    MAX+9,,AUTO
         4 002042   200406 236100                    LDQ     MAX+9,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:148  
         4 002043   000170 036000 5                  ADLQ    120
         4 002044   200410 757100                    STAQ    MAX+11,,AUTO
         4 002045   000002 235000 5                  LDA     2
         4 002046   200412 452500                    STP2    MAX+13,,AUTO
         4 002047   200412 236100                    LDQ     MAX+13,,AUTO
         4 002050   000171 036000 5                  ADLQ    121
         4 002051   200416 757100                    STAQ    MAX+17,,AUTO
         4 002052   200400 237100                    LDAQ    MAX+3,,AUTO
         4 002053   200414 757100                    STAQ    MAX+15,,AUTO
         4 002054   200404 237100                    LDAQ    MAX+7,,AUTO
         4 002055   200420 757100                    STAQ    MAX+19,,AUTO
         4 002056   200410 237100                    LDAQ    MAX+11,,AUTO
         4 002057   200422 757100                    STAQ    MAX+21,,AUTO
         4 002060   200416 237100                    LDAQ    MAX+17,,AUTO
         4 002061   200424 757100                    STAQ    MAX+23,,AUTO
         4 002062   200424 633500                    EPPR3   MAX+23,,AUTO
         4 002063   200434 453500                    STP3    MAX+31,,AUTO
         4 002064   200422 634500                    EPPR4   MAX+21,,AUTO
         4 002065   200433 454500                    STP4    MAX+30,,AUTO
         4 002066   200420 635500                    EPPR5   MAX+19,,AUTO
         4 002067   200432 455500                    STP5    MAX+29,,AUTO
         4 002070   200414 636500                    EPPR6   MAX+15,,AUTO
         4 002071   200431 456500                    STP6    MAX+28,,AUTO
         4 002072   000005 236000 5                  LDQ     5
         4 002073   200430 756100                    STQ     MAX+27,,AUTO
         4 002074   000172 237000 5                  LDAQ    122
         4 002075   200426 757100                    STAQ    MAX+25,,AUTO
         4 002076   200426 630500                    EPPR0   MAX+25,,AUTO
         4 002077   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 002100   000000 701000 xent               TSX1    KSW$WRITE
         4 002101   000000 011000                    NOP     0

      960    16710
      961    16711    5                         END;

      962    16712    4                  CALL KSW$WRITE(VECTOR(CONFIG_FMT),VECTOR(DEF_OPT),VECTOR(CNFG_BUFFER
             16712                            ),VECTOR(DEF_BUFFER),VECTOR(LINESPEED),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:149  

  16712  4 002102   777640 235007                    LDA     -96,DL
         4 002103   200376 452500                    STP2    MAX+1,,AUTO
         4 002104   200376 236100                    LDQ     MAX+1,,AUTO
         4 002105   000073 036003                    ADLQ    59,DU
         4 002106   200400 757100                    STAQ    MAX+3,,AUTO
         4 002107   000200 237000 5                  LDAQ    128
         4 002110   200406 757100                    STAQ    MAX+9,,AUTO
         4 002111   000202 237000 5                  LDAQ    130
         4 002112   200404 757100                    STAQ    MAX+7,,AUTO
         4 002113   200400 630500                    EPPR0   MAX+3,,AUTO
         4 002114   200403 450500                    STP0    MAX+6,,AUTO
         4 002115   000204 236000 5                  LDQ     132
         4 002116   200402 756100                    STQ     MAX+5,,AUTO
         4 002117   200402 630500                    EPPR0   MAX+5,,AUTO
         4 002120   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 002121   000000 701000 xent               TSX1    KSW$WRITE
         4 002122   000000 011000                    NOP     0

      963    16713    4                      VECTOR(KS_DEFAULT_KEY.HNDLR));
      964    16714    4                 IF KS_DISP_RNG THEN

  16714  4 002123   000001 234000 2                  SZN     KS_DISP_RNG
         4 002124   005146 605000 4                  TPL     END_LOOP

      965    16715    5                  DO;

      966    16716    6                  IF KS_CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' ' THEN DO;

  16716  4 002125   040000 106500                    CMPC    fill='040'O
         4 002126   200036 600010                    ADSC9   KS_CONFIG_KEY+2,,AUTO    cn=3,n=8
         4 002127   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002130   002135 600000 4                  TZE     s:16721

      967    16717    6                     TERMHI.TERM.CHANNEL = '0'B;

  16717  4 002131   000000 220003                    LDX0    0,DU
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:150  
         4 002132   200010 440100                    SXL0    TERMHI,,AUTO

      968    16718    6                     KS_CHKNODE = 0;

  16718  4 002133   200213 450100                    STZ     KS_CHKNODE,,AUTO

      969    16719    6                     END;

  16719  4 002134   002137 710000 4                  TRA     s:16722

      970    16720    5                  ELSE
      971    16721    5                     KS_CHKNODE = KS_NODE;

  16721  4 002135   000000 235000 xsym               LDA     KS_NODE
         4 002136   200213 755100                    STA     KS_CHKNODE,,AUTO

      972    16722    5                    IF FIRST THEN

  16722  4 002137   000000 234000 2                  SZN     FIRST
         4 002140   002161 605000 4                  TPL     s:16736

      973    16723    6                       DO;

      974    16724    6                       FIRST = '0'B;

  16724  4 002141   000000 450000 2                  STZ     FIRST

      975    16725    6                       IF KS_CONFIG_KEY.TERMID.LEV>%TERMINAL_ID_LEV_CHAN# AND

  16725  4 002142   200035 236100                    LDQ     KS_CONFIG_KEY+1,,AUTO
         4 002143   777000 376003                    ANQ     -512,DU
         4 002144   002000 116003                    CMPQ    1024,DU
         4 002145   002154 602000 4                  TNC     s:16729
         4 002146   040000 106500                    CMPC    fill='040'O
         4 002147   200036 600010                    ADSC9   KS_CONFIG_KEY+2,,AUTO    cn=3,n=8
         4 002150   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002151   002154 600000 4                  TZE     s:16729
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:151  

      976    16726    7                          KS_CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' ' THEN DO;

      977    16727    7                          KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;

  16727  4 002152   000000 236003                    LDQ     0,DU
         4 002153   200035 552130                    STBQ    KS_CONFIG_KEY+1,'30'O,AUTO

      978    16728    7                          END;

      979    16729    6                       READ_NETCON.V.KEYR# = '1'B;

  16729  4 002154   100000 236007                    LDQ     32768,DL
         4 002155   006424 256000 2                  ORSQ    READ_NETCON+8

      980    16730    6                       READ_NETCON.V.KEYS# = '0'B;

  16730  4 002156   000163 236000 5                  LDQ     115
         4 002157   006424 356000 2                  ANSQ    READ_NETCON+8

      981    16731    6                       END;  /*if first*/

      982    16732    5                    END;  /*if display range*/

  16732  4 002160   002161 710000 4                  TRA     s:16736

      983    16733    4                 ELSE
      984    16734    4                    GOTO END_LOOP;
      985    16735
      986    16736    4                 CNFG_BUFFER = '0'B;

  16736  4 002161   000000 100400                    MLR     fill='000'O
         4 002162   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 002163   000004 000310 2                  ADSC9   CNFG_BUFFER              cn=0,n=200

      987    16737    4                       READ_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:152  
  16737  4 002164   000154 235000 5                  LDA     108
         4 002165   200376 452500                    STP2    MAX+1,,AUTO
         4 002166   200376 236100                    LDQ     MAX+1,,AUTO
         4 002167   000034 036003                    ADLQ    28,DU
         4 002170   006416 757000 2                  STAQ    READ_NETCON+2

      988    16738    4                 READ_NETCON.BUF_ = VECTOR(CNFG_BUFFER);

  16738  4 002171   000136 237000 5                  LDAQ    94
         4 002172   006420 757000 2                  STAQ    READ_NETCON+4

      989    16739    4                 CALL M$READ(READ_NETCON) WHENALTRETURN

  16739  4 002173   006414 630400 2                  EPPR0   READ_NETCON
         4 002174   440000 713400                    CLIMB   alt,read
         4 002175   401400 401760                    pmme    nvectors=4
         4 002176   002200 702000 4                  TSX2    s:16741
         4 002177   002207 710000 4                  TRA     s:16748

      990    16740    5                    DO;

      991    16741    5                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = %E$EOF THEN

  16741  4 002200   000000 470400 xsym               LDP0    B$TCB$
         4 002201   000000 471500                    LDP1    0,,PR0
         4 002202   100102 236100                    LDQ     66,,PR1
         4 002203   377770 376007                    ANQ     131064,DL
         4 002204   000060 116007                    CMPQ    48,DL
         4 002205   005146 600000 4                  TZE     END_LOOP

      992    16742    5                       GOTO END_LOOP;
      993    16743    5                    ELSE
      994    16744    5                       GOTO DISP_ERR;

  16744  4 002206   005135 710000 4                  TRA     DISP_ERR

      995    16745    5                    END; /*altreturn from read netcon*/
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:153  
      996    16746
      997    16747
      998    16748    4                 IF (KS_CONFIG_KEY.TYP ~= %KL_KEYTYP_CONFIG) OR

  16748  4 002207   200034 236100                    LDQ     KS_CONFIG_KEY,,AUTO
         4 002210   000777 376003                    ANQ     511,DU
         4 002211   000002 116003                    CMPQ    2,DU
         4 002212   005146 601000 4                  TNZ     END_LOOP
         4 002213   200034 236100                    LDQ     KS_CONFIG_KEY,,AUTO
         4 002214   000011 772000                    QRL     9
         4 002215   000777 376007                    ANQ     511,DL
         4 002216   200213 116100                    CMPQ    KS_CHKNODE,,AUTO
         4 002217   005146 601000 4                  TNZ     END_LOOP

      999    16749    4              (KS_CONFIG_KEY.NODE ~= KS_CHKNODE) THEN
     1000    16750    4                       GOTO END_LOOP;
     1001    16751    5                 ELSE DO;

     1002    16752    6                   CALL KSU$CHK_TRM_RNG(KS_CONFIG_KEY.TERMID,TERMHI) WHENALTRETURN DO;

  16752  4 002220   200010 630500                    EPPR0   TERMHI,,AUTO
         4 002221   200377 450500                    STP0    MAX+2,,AUTO
         4 002222   200400 452500                    STP2    MAX+3,,AUTO
         4 002223   200400 236100                    LDQ     MAX+3,,AUTO
         4 002224   000164 036000 5                  ADLQ    116
         4 002225   200376 756100                    STQ     MAX+1,,AUTO
         4 002226   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002227   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002230   000000 701000 xent               TSX1    KSU$CHK_TRM_RNG
         4 002231   002233 702000 4                  TSX2    s:16754
         4 002232   002234 710000 4                  TRA     s:16757

     1003    16753
     1004    16754    6                       GOTO END_LOOP;

  16754  4 002233   005146 710000 4                  TRA     END_LOOP

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:154  
     1005    16755    6                       END;   /*  when altreturn  */
     1006    16756    5                    END;  /*  else  */

     1007    16757    4                 END;   /*end while loop*/

  16757  4 002234   001705 710000 4                  TRA     s:16673

     1008    16758        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:155  
     1009    16759        /*
     1010    16760             This section of code displays the channel table as it is
     1011    16761             represented in the FEP.  Five options exist; CHAN,FULL,STATE
     1012    16762             DVCCLS and DVCATTR.
     1013    16763        */
     1014    16764
     1015    16765    3        CASE (%KS_CHANTBL);

     1016    16766
     1017    16767
     1018    16768
     1019    16769        /*
     1020    16770                   If the number of sub-blocks is 0 then no options were
     1021    16771                   specified and all channels on that node will be displayed.
     1022    16772                   otherwise check to see if a node was specified in the
     1023    16773                   commands string, if so substitute nodes and continue.
     1024    16774                   If the first sub-block is not a node specification then
     1025    16775                   the sub-options begin with the first sub-block.
     1026    16776        */
     1027    16777    3           FIRST_SUBLK = 0;

  16777  4 002235   200330 450100                    STZ     FIRST_SUBLK,,AUTO

     1028    16778    3            IF BLK$->OUT$BLK.NSUBLKS ~= 0 THEN

  16778  4 002236   300001 222100                    LDX2    1,,PR3
         4 002237   002264 600000 4                  TZE     s:16790

     1029    16779    4               DO;

     1030    16780    4               IF BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_NODE THEN

  16780  4 002240   300003 474500                    LDP4    3,,PR3
         4 002241   400000 723100                    LXL3    0,,PR4
         4 002242   000001 103003                    CMPX3   1,DU
         4 002243   002264 601000 4                  TNZ     s:16790

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:156  
     1031    16781    5                  DO;

     1032    16782    5                  CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0));

  16782  4 002244   400003 635500                    EPPR5   3,,PR4
         4 002245   200355 455500                    STP5    SUBLK_INDX+2,,AUTO
         4 002246   005206 701000 4                  TSX1    GET_NODE
         4 002247   000000 011000                    NOP     0

     1033    16783    5                  KS_NODE_SV = KS_NODE;

  16783  4 002250   000000 235000 xsym               LDA     KS_NODE
         4 002251   000000 755000 xsym               STA     KS_NODE_SV

     1034    16784    5                  KS_NODE = FEPNODE;

  16784  4 002252   200200 236100                    LDQ     FEPNODE,,AUTO
         4 002253   000000 756000 xsym               STQ     KS_NODE

     1035    16785    5                  KS_NODENAME_SV = KS_NODENAME;

  16785  4 002254   040000 100400                    MLR     fill='040'O
         4 002255   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 002256   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8

     1036    16786    5                  KS_NODENAME = FEPNAME;

  16786  4 002257   040000 100500                    MLR     fill='040'O
         4 002260   200201 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 002261   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

     1037    16787    5                  FIRST_SUBLK = 1;

  16787  4 002262   000001 235007                    LDA     1,DL
         4 002263   200330 755100                    STA     FIRST_SUBLK,,AUTO

     1038    16788    5                  END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:157  

     1039    16789    4               END;

     1040    16790    3            KS_SUB_BUF_1.COUNT = SIZEC('Channel Table');

  16790  4 002264   015000 236003                    LDQ     6656,DU
         4 002265   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1041    16791    3            KS_SUB_BUF_1.TEXT = 'Channel Table';

  16791  4 002266   040000 100400                    MLR     fill='040'O
         4 002267   002731 000015 1                  ADSC9   PARM_DISPONLY_FMT+21     cn=0,n=13
         4 002270   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1042    16792    3            READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  16792  4 002271   000040 237000 5                  LDAQ    32
         4 002272   006416 757000 2                  STAQ    READ_NETCON+2

     1043    16793    3            READ_NETCON.BUF_ = VECTOR(KS_NETWORK);

  16793  4 002273   000042 237000 5                  LDAQ    34
         4 002274   006420 757000 2                  STAQ    READ_NETCON+4

     1044    16794    3            CALL M$READ (READ_NETCON) ALTRET (DISP_ERR);

  16794  4 002275   006414 630400 2                  EPPR0   READ_NETCON
         4 002276   440000 713400                    CLIMB   alt,read
         4 002277   401400 401760                    pmme    nvectors=4
         4 002300   005135 702000 4                  TSX2    DISP_ERR

     1045    16795
     1046    16796    3            IF KS_NETWORK.NODE.TYPE(KS_NODE) = 1 OR

  16796  4 002301   000000 236000 xsym               LDQ     KS_NODE
         4 002302   000005 402007                    MPY     5,DL
         4 002303   001366 235006 2                  LDA     KS_NETWORK+1,QL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:158  
         4 002304   000001 115007                    CMPA    1,DL
         4 002305   002310 600000 4                  TZE     s:16799
         4 002306   000003 115007                    CMPA    3,DL
         4 002307   002315 601000 4                  TNZ     s:16806

     1047    16797    3               KS_NETWORK.NODE.TYPE(KS_NODE) = 3 THEN
     1048    16798    4               DO;

     1049    16799    4                  CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);

  16799  4 002310   000206 630400 5                  EPPR0   134
         4 002311   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002312   000000 701000 xent               TSX1    KSE$ERRMSG
         4 002313   000000 011000                    NOP     0

     1050    16800                       /*E*   ERROR: KSN-E$KS_BAD_NODE_TYPE-0
     1051    16801                              MESSAGE: This command works only on FEP nodes.
     1052    16802                              DESCRIPTION: SEE MESSAGE */
     1053    16803    4                  GOTO END_LOOP;

  16803  4 002314   005146 710000 4                  TRA     END_LOOP

     1054    16804    4               END;
     1055    16805
     1056    16806    3            CHANHI = %KS_CHANNEL_HI;

  16806  4 002315   177716 235007                    LDA     65486,DL
         4 002316   200332 755100                    STA     CHANHI,,AUTO

     1057    16807    3            CHANLO = %KS_CHANNEL_LO;

  16807  4 002317   002000 235007                    LDA     1024,DL
         4 002320   200333 755100                    STA     CHANLO,,AUTO

     1058    16808    3            SUBLO = %KS_SUB_LO;

  16808  4 002321   200335 450100                    STZ     SUBLO,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:159  

     1059    16809    3            SUBHI = %KS_SUB_HI;

  16809  4 002322   000037 235007                    LDA     31,DL
         4 002323   200336 755100                    STA     SUBHI,,AUTO

     1060    16810    3            SUBSUBLO = %KS_SUB_LO;

  16810  4 002324   200340 450100                    STZ     SUBSUBLO,,AUTO

     1061    16811    3            SUBSUBHI = %KS_SUB_HI;

  16811  4 002325   200337 755100                    STA     SUBSUBHI,,AUTO

     1062    16812    3              CALL KSU$UNPACK (CHANLO,TERMLO.TERM.CHANNEL);

  16812  4 002326   200400 452500                    STP2    MAX+3,,AUTO
         4 002327   200400 236100                    LDQ     MAX+3,,AUTO
         4 002330   000166 036000 5                  ADLQ    118
         4 002331   200377 756100                    STQ     MAX+2,,AUTO
         4 002332   200333 630500                    EPPR0   CHANLO,,AUTO
         4 002333   200376 450500                    STP0    MAX+1,,AUTO
         4 002334   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002335   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002336   000000 701000 xent               TSX1    KSU$UNPACK
         4 002337   000000 011000                    NOP     0

     1063    16813    3              CALL KSU$UNPACK (CHANHI,TERMHI.TERM.CHANNEL);

  16813  4 002340   200400 452500                    STP2    MAX+3,,AUTO
         4 002341   200400 236100                    LDQ     MAX+3,,AUTO
         4 002342   000207 036000 5                  ADLQ    135
         4 002343   200377 756100                    STQ     MAX+2,,AUTO
         4 002344   200332 630500                    EPPR0   CHANHI,,AUTO
         4 002345   200376 450500                    STP0    MAX+1,,AUTO
         4 002346   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002347   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:160  
         4 002350   000000 701000 xent               TSX1    KSU$UNPACK
         4 002351   000000 011000                    NOP     0

     1064    16814    3              CALL KSU$UNPACK (SUBLO,TERMLO.TERM.SUBDEVICE);

  16814  4 002352   200005 630500                    EPPR0   TERMLO+1,,AUTO
         4 002353   200377 450500                    STP0    MAX+2,,AUTO
         4 002354   200335 631500                    EPPR1   SUBLO,,AUTO
         4 002355   200376 451500                    STP1    MAX+1,,AUTO
         4 002356   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002357   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002360   000000 701000 xent               TSX1    KSU$UNPACK
         4 002361   000000 011000                    NOP     0

     1065    16815    3              CALL KSU$UNPACK (SUBHI,TERMHI.TERM.SUBDEVICE);

  16815  4 002362   200011 630500                    EPPR0   TERMHI+1,,AUTO
         4 002363   200377 450500                    STP0    MAX+2,,AUTO
         4 002364   200336 631500                    EPPR1   SUBHI,,AUTO
         4 002365   200376 451500                    STP1    MAX+1,,AUTO
         4 002366   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002367   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002370   000000 701000 xent               TSX1    KSU$UNPACK
         4 002371   000000 011000                    NOP     0

     1066    16816    3              CALL KSU$UNPACK (SUBSUBLO,TERMLO.TERM.SUBSUBDEVICE);

  16816  4 002372   200400 452500                    STP2    MAX+3,,AUTO
         4 002373   200400 236100                    LDQ     MAX+3,,AUTO
         4 002374   000210 036000 5                  ADLQ    136
         4 002375   200377 756100                    STQ     MAX+2,,AUTO
         4 002376   200340 630500                    EPPR0   SUBSUBLO,,AUTO
         4 002377   200376 450500                    STP0    MAX+1,,AUTO
         4 002400   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002401   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002402   000000 701000 xent               TSX1    KSU$UNPACK
         4 002403   000000 011000                    NOP     0
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:161  

     1067    16817    3              CALL KSU$UNPACK (SUBSUBHI,TERMHI.TERM.SUBSUBDEVICE);

  16817  4 002404   200400 452500                    STP2    MAX+3,,AUTO
         4 002405   200400 236100                    LDQ     MAX+3,,AUTO
         4 002406   000211 036000 5                  ADLQ    137
         4 002407   200377 756100                    STQ     MAX+2,,AUTO
         4 002410   200337 630500                    EPPR0   SUBSUBHI,,AUTO
         4 002411   200376 450500                    STP0    MAX+1,,AUTO
         4 002412   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002413   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002414   000000 701000 xent               TSX1    KSU$UNPACK
         4 002415   000000 011000                    NOP     0

     1068    16818    3              TERMLO.LEV = 1;

  16818  4 002416   000001 236003                    LDQ     1,DU
         4 002417   200004 552120                    STBQ    TERMLO,'20'O,AUTO

     1069    16819    3              TERMHI.LEV = 1;

  16819  4 002420   200010 552120                    STBQ    TERMHI,'20'O,AUTO

     1070    16820
     1071    16821    3            CHAN_DISP_FULL = '0'B;

  16821  4 002421   200046 450100                    STZ     CHAN_DISP_FULL,,AUTO

     1072    16822    3            ONE_CHAN_FLAG = '0'B;

  16822  4 002422   200047 450100                    STZ     ONE_CHAN_FLAG,,AUTO

     1073    16823
     1074    16824    3            OPT.P$(%KS_DVCRES) = ADDR(NIL);

  16824  4 002423   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 002424   200056 756100                    STQ     OPT+6,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:162  

     1075    16825    3            OPT.P$(%KS_DVCATTR) = ADDR(NIL);

  16825  4 002425   200060 756100                    STQ     OPT+8,,AUTO

     1076    16826    3            OPT.P$(%KS_STATE) = ADDR(NIL);

  16826  4 002426   200062 756100                    STQ     OPT+10,,AUTO

     1077    16827
     1078    16828    3            IF BLK$->OUT$BLK.NSUBLKS ~= FIRST_SUBLK THEN

  16828  4 002427   200173 470500                    LDP0    BLK$,,AUTO
         4 002430   000001 236100                    LDQ     1,,PR0
         4 002431   000022 772000                    QRL     18
         4 002432   200330 116100                    CMPQ    FIRST_SUBLK,,AUTO
         4 002433   002561 600000 4                  TZE     s:16869

     1079    16829    4               DO;

     1080    16830    4                  LAST = BLK$->OUT$BLK.NSUBLKS - 1;

  16830  4 002434   000001 136007                    SBLQ    1,DL
         4 002435   200327 756100                    STQ     LAST,,AUTO

     1081    16831
     1082    16832
     1083    16833        /*
     1084    16834                This loop goes through all of the sub-nodes specified off
     1085    16835                of the channel node.
     1086    16836        */
     1087    16837
     1088    16838    5                DO SBLK = FIRST_SUBLK TO LAST;

  16838  4 002436   200330 235100                    LDA     FIRST_SUBLK,,AUTO
         4 002437   200076 755100                    STA     SBLK,,AUTO
         4 002440   002556 710000 4                  TRA     s:16866+3
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:163  

     1089    16839    5                    CODE = BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.CODE;

  16839  4 002441   200173 470500                    LDP0    BLK$,,AUTO
         4 002442   200076 720100                    LXL0    SBLK,,AUTO
         4 002443   000003 471510                    LDP1    3,X0,PR0
         4 002444   100000 236100                    LDQ     0,,PR1
         4 002445   777777 376007                    ANQ     -1,DL
         4 002446   200351 756100                    STQ     CODE,,AUTO

     1090    16840    6                     DO CASE(CODE);

  16840  4 002447   000007 116007                    CMPQ    7,DL
         4 002450   002452 602006 4                  TNC     s:16840+3,QL
         4 002451   002553 710000 4                  TRA     s:16866
         4 002452   002553 710000 4                  TRA     s:16866
         4 002453   002553 710000 4                  TRA     s:16866
         4 002454   002461 710000 4                  TRA     s:16842
         4 002455   002542 710000 4                  TRA     s:16863
         4 002456   002542 710000 4                  TRA     s:16863
         4 002457   002542 710000 4                  TRA     s:16863
         4 002460   002537 710000 4                  TRA     s:16860

     1091    16841    6                        CASE(%KS_CHAN);

     1092    16842    6     CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$
             16842               (0),TERMLO) ALTRET(DISP_ERR);

  16842  4 002461   100003 473500                    LDP3    3,,PR1
         4 002462   200004 634500                    EPPR4   TERMLO,,AUTO
         4 002463   200377 454500                    STP4    MAX+2,,AUTO
         4 002464   300003 631500                    EPPR1   3,,PR3
         4 002465   200376 451500                    STP1    MAX+1,,AUTO
         4 002466   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002467   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002470   000000 701000 xent               TSX1    KSU$BLD_TERMID
         4 002471   005135 702000 4                  TSX2    DISP_ERR
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:164  

     1093    16843    6                           IF (BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.SUBLK$(0)->OUT$BLK.
             16843                                    NSUBLKS = 2) THEN

  16843  4 002472   200173 470500                    LDP0    BLK$,,AUTO
         4 002473   200076 720100                    LXL0    SBLK,,AUTO
         4 002474   000003 471510                    LDP1    3,X0,PR0
         4 002475   100003 473500                    LDP3    3,,PR1
         4 002476   300001 221100                    LDX1    1,,PR3
         4 002477   000002 101003                    CMPX1   2,DU
         4 002500   002530 601000 4                  TNZ     s:16854

     1094    16844    7                              DO;

     1095    16845    7       CALL KSU$BLD_TERMID(BLK$->OUT$BLK.SUBLK$(SBLK)->OUT$BLK.SUBLK$(0)->OUT$BLK.
             16845                SUBLK$(1),TERMHI) ALTRET(DISP_ERR);

  16845  4 002501   200010 634500                    EPPR4   TERMHI,,AUTO
         4 002502   200377 454500                    STP4    MAX+2,,AUTO
         4 002503   300004 631500                    EPPR1   4,,PR3
         4 002504   200376 451500                    STP1    MAX+1,,AUTO
         4 002505   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002506   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002507   000000 701000 xent               TSX1    KSU$BLD_TERMID
         4 002510   005135 702000 4                  TSX2    DISP_ERR

     1096    16846    7                              CALL KSU$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN

  16846  4 002511   200010 630500                    EPPR0   TERMHI,,AUTO
         4 002512   200377 450500                    STP0    MAX+2,,AUTO
         4 002513   200004 631500                    EPPR1   TERMLO,,AUTO
         4 002514   200376 451500                    STP1    MAX+1,,AUTO
         4 002515   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002516   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002517   000000 701000 xent               TSX1    KSU$CHK_TRM_RNG
         4 002520   002522 702000 4                  TSX2    s:16848
         4 002521   002527 710000 4                  TRA     s:16851
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:165  

     1097    16847    8                                 DO;

     1098    16848    8                                 CALL KSE$ERRMSG(%E$KS_BAD_TRM_RANGE);

  16848  4 002522   000156 630400 5                  EPPR0   110
         4 002523   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002524   000000 701000 xent               TSX1    KSE$ERRMSG
         4 002525   000000 011000                    NOP     0

     1099    16849    8                                 GOTO END_LOOP;

  16849  4 002526   005146 710000 4                  TRA     END_LOOP

     1100    16850    8                                 END;
     1101    16851    7                              END;  /*  if 2 sublocks   */

  16851  4 002527   002553 710000 4                  TRA     s:16866

     1102    16852    6                           ELSE
     1103    16853    7                              DO;

     1104    16854    7                              CHAN_DISP_FULL = '1'B;

  16854  4 002530   400000 236003                    LDQ     -131072,DU
         4 002531   200046 756100                    STQ     CHAN_DISP_FULL,,AUTO

     1105    16855    7                              ONE_CHAN_FLAG = '1'B;

  16855  4 002532   200047 756100                    STQ     ONE_CHAN_FLAG,,AUTO

     1106    16856    7                              TERMHI = TERMLO;

  16856  4 002533   000100 100500                    MLR     fill='000'O
         4 002534   200004 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 002535   200010 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:166  
     1107    16857    7                              END;

  16857  4 002536   002553 710000 4                  TRA     s:16866

     1108    16858
     1109    16859    6                        CASE (%KS_FULL);

     1110    16860    6                           CHAN_DISP_FULL = '1'B;

  16860  4 002537   400000 236003                    LDQ     -131072,DU
         4 002540   200046 756100                    STQ     CHAN_DISP_FULL,,AUTO
         4 002541   002553 710000 4                  TRA     s:16866

     1111    16861
     1112    16862    6                        CASE (%KS_DVCRES, %KS_DVCATTR, %KS_STATE);

     1113    16863    6      OPT.P$(CODE) = BLK$->OUT$BLK.SUBLK$(SBLK);

  16863  4 002542   200351 235100                    LDA     CODE,,AUTO
         4 002543   000001 735000                    ALS     1
         4 002544   000003 236110                    LDQ     3,X0,PR0
         4 002545   200050 756105                    STQ     OPT,AL,AUTO

     1114    16864    6                           OPT.LAST(CODE) = OPT.P$(CODE)->OUT$BLK.NSUBLKS-1;

  16864  4 002546   200050 473505                    LDP3    OPT,AL,AUTO
         4 002547   300001 236100                    LDQ     1,,PR3
         4 002550   000022 772000                    QRL     18
         4 002551   000001 136007                    SBLQ    1,DL
         4 002552   200051 756105                    STQ     OPT+1,AL,AUTO

     1115    16865    6                     END; /*CASE*/

     1116    16866    5                  END;

  16866  4 002553   200076 235100                    LDA     SBLK,,AUTO
         4 002554   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:167  
         4 002555   200076 755100                    STA     SBLK,,AUTO
         4 002556   200327 236100                    LDQ     LAST,,AUTO
         4 002557   200076 116100                    CMPQ    SBLK,,AUTO
         4 002560   002441 603000 4                  TRC     s:16839

     1117    16867    4               END;

     1118    16868
     1119    16869    3               HDR_FLAG = '0'B;

  16869  4 002561   200064 450100                    STZ     HDR_FLAG,,AUTO

     1120    16870    3   NEW_CHAN_DISP:
     1121    16871    3              KS_ADMIN.CODE = IGA_CHNDISP;

  16871  4 002562   117000 236003       NEW_CHAN_DI* LDQ     40448,DU
         4 002563   000316 552040 2                  STBQ    KS_ADMIN,'40'O

     1122    16872    3              KS_ADMIN.HANDLER = ' ';

  16872  4 002564   000035 235000 xsym               LDA     B_VECTNIL+29
         4 002565   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 002566   000317 755000 2                  STA     KS_ADMIN+1
         4 002567   000320 756000 2                  STQ     KS_ADMIN+2

     1123    16873    3              CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);

  16873  4 002570   200333 630500                    EPPR0   CHANLO,,AUTO
         4 002571   200377 450500                    STP0    MAX+2,,AUTO
         4 002572   200400 452500                    STP2    MAX+3,,AUTO
         4 002573   200400 236100                    LDQ     MAX+3,,AUTO
         4 002574   000166 036000 5                  ADLQ    118
         4 002575   200376 756100                    STQ     MAX+1,,AUTO
         4 002576   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002577   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002600   000000 701000 xent               TSX1    KSU$PACK2
         4 002601   000000 011000                    NOP     0
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:168  

     1124    16874    3              CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);

  16874  4 002602   200332 630500                    EPPR0   CHANHI,,AUTO
         4 002603   200377 450500                    STP0    MAX+2,,AUTO
         4 002604   200400 452500                    STP2    MAX+3,,AUTO
         4 002605   200400 236100                    LDQ     MAX+3,,AUTO
         4 002606   000207 036000 5                  ADLQ    135
         4 002607   200376 756100                    STQ     MAX+1,,AUTO
         4 002610   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002611   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002612   000000 701000 xent               TSX1    KSU$PACK2
         4 002613   000000 011000                    NOP     0

     1125    16875
     1126    16876    3              KS_ADMIN.TERMID_LO = TERMLO;

  16876  4 002614   000000 100500                    MLR     fill='000'O
         4 002615   200004 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 002616   000327 000020 2                  ADSC9   KS_ADMIN+9               cn=0,n=16

     1127    16877    3              KS_ADMIN.TERMID_HI = TERMHI;

  16877  4 002617   000000 100500                    MLR     fill='000'O
         4 002620   200010 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16
         4 002621   000333 000020 2                  ADSC9   KS_ADMIN+13              cn=0,n=16

     1128    16878    3              IF TERMLO = TERMHI THEN ONE_CHAN_FLAG = '1'B;

  16878  4 002622   000100 106500                    CMPC    fill='000'O
         4 002623   200004 000020                    ADSC9   TERMLO,,AUTO             cn=0,n=16
         4 002624   200010 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16
         4 002625   002630 601000 4                  TNZ     s:16885

  16878  4 002626   400000 236003                    LDQ     -131072,DU
         4 002627   200047 756100                    STQ     ONE_CHAN_FLAG,,AUTO

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:169  
     1129    16879
     1130    16880        /*
     1131    16881           Before the CHAN_LOOP is started first display KS_ADMIN.TERMID_LO.
     1132    16882           The CHAN_LOOP will increment CHANLO + 128 after that.
     1133    16883        */
     1134    16884
     1135    16885    3              CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN));

  16885  4 002630   000214 630400 5                  EPPR0   140
         4 002631   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002632   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 002633   000000 011000                    NOP     0

     1136    16886    3              CALL KSR$RD_HLPCG(ONE_CHAN_FLAG);

  16886  4 002634   200047 630500                    EPPR0   ONE_CHAN_FLAG,,AUTO
         4 002635   200376 450500                    STP0    MAX+1,,AUTO
         4 002636   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002637   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002640   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 002641   000000 011000                    NOP     0

     1137    16887    3              KH$CHN = ADMIN.KS_CHN;

  16887  4 002642   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 002643   000100 100500                    MLR     fill='000'O
         4 002644   000021 000100                    ADSC9   17,,PR0                  cn=0,n=64
         4 002645   200014 000100                    ADSC9   KH$CHN,,AUTO             cn=0,n=64

     1138    16888    3              CALL DISPLAY_CHAN;

  16888  4 002646   010064 701000 4                  TSX1    DISPLAY_CHAN
         4 002647   000000 011000                    NOP     0

     1139    16889
     1140    16890    4   CHAN_LOOP: DO CHAN = CHANLO TO CHANHI BY 128 * %CHANTBL_REQST_SIZE;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:170  
  16890  4 002650   200333 235100       CHAN_LOOP    LDA     CHANLO,,AUTO
         4 002651   200331 755100                    STA     CHAN,,AUTO
         4 002652   002767 710000 4                  TRA     s:16918+3

     1141    16891        /*
     1142    16892          When increment on successive loops, make sure that TERMID_LO is
     1143    16893          increased by 128 above the previous TERMID_HI.
     1144    16894        */
     1145    16895    4                 CALL KSU$UNPACK(CHAN+128,KS_ADMIN.TERMID_LO.TERM.CHANNEL);

  16895  4 002653   200331 235100                    LDA     CHAN,,AUTO
         4 002654   000200 035007                    ADLA    128,DL
         4 002655   200376 755100                    STA     MAX+1,,AUTO
         4 002656   000215 236000 5                  LDQ     141
         4 002657   200401 756100                    STQ     MAX+4,,AUTO
         4 002660   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002661   200400 450500                    STP0    MAX+3,,AUTO
         4 002662   200400 630500                    EPPR0   MAX+3,,AUTO
         4 002663   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002664   000000 701000 xent               TSX1    KSU$UNPACK
         4 002665   000000 011000                    NOP     0

     1146    16896    4                 IF (CHAN+128*%CHANTBL_REQST_SIZE)>=CHANHI THEN

  16896  4 002666   200331 236100                    LDQ     CHAN,,AUTO
         4 002667   004000 036007                    ADLQ    2048,DL
         4 002670   200332 116100                    CMPQ    CHANHI,,AUTO
         4 002671   002703 602000 4                  TNC     s:16899

     1147    16897    4                    CALL KSU$UNPACK(CHANHI,KS_ADMIN.TERMID_HI.TERM.CHANNEL);

  16897  4 002672   000216 236000 5                  LDQ     142
         4 002673   200377 756100                    STQ     MAX+2,,AUTO
         4 002674   200332 630500                    EPPR0   CHANHI,,AUTO
         4 002675   200376 450500                    STP0    MAX+1,,AUTO
         4 002676   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002677   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:171  
         4 002700   000000 701000 xent               TSX1    KSU$UNPACK
         4 002701   000000 011000                    NOP     0
         4 002702   002714 710000 4                  TRA     s:16901

     1148    16898    4                 ELSE
     1149    16899    4                    CALL KSU$UNPACK(CHAN+128*%CHANTBL_REQST_SIZE,

  16899  4 002703   200376 756100                    STQ     MAX+1,,AUTO
         4 002704   000216 236000 5                  LDQ     142
         4 002705   200401 756100                    STQ     MAX+4,,AUTO
         4 002706   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002707   200400 450500                    STP0    MAX+3,,AUTO
         4 002710   200400 630500                    EPPR0   MAX+3,,AUTO
         4 002711   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002712   000000 701000 xent               TSX1    KSU$UNPACK
         4 002713   000000 011000                    NOP     0

     1150    16900    4                         KS_ADMIN.TERMID_HI.TERM.CHANNEL);
     1151    16901    4                 CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN));

  16901  4 002714   000214 630400 5                  EPPR0   140
         4 002715   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002716   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 002717   000000 011000                    NOP     0

     1152    16902    5                 DO WHILE '1'B;

     1153    16903    5                    CALL KSR$RD_HLPCG(ONE_CHAN_FLAG)

  16903  4 002720   200047 630500                    EPPR0   ONE_CHAN_FLAG,,AUTO
         4 002721   200376 450500                    STP0    MAX+1,,AUTO
         4 002722   200376 630500                    EPPR0   MAX+1,,AUTO
         4 002723   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002724   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 002725   002727 702000 4                  TSX2    s:16905
         4 002726   002736 710000 4                  TRA     s:16910

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:172  
     1154    16904    6                         WHENALTRETURN DO;

     1155    16905    6                            IF ONE_CHAN_FLAG = '1'B THEN

  16905  4 002727   200047 234100                    SZN     ONE_CHAN_FLAG,,AUTO
         4 002730   005146 604000 4                  TMI     END_LOOP

     1156    16906    6                               GOTO END_LOOP;
     1157    16907    6                            IF ADMIN.RESULTS.ERR# = 9999 THEN

  16907  4 002731   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 002732   000007 236100                    LDQ     7,,PR0
         4 002733   377770 376007                    ANQ     131064,DL
         4 002734   234170 116007                    CMPQ    79992,DL
         4 002735   002775 600000 4                  TZE     OLD_CHAN_DISP

     1158    16908    6                               GOTO OLD_CHAN_DISP;
     1159    16909    6                            END;

     1160    16910    5                    IF ADMIN.TYPE = 1 AND NOT ONE_CHAN_FLAG THEN EXIT;

  16910  4 002736   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 002737   000000 236100                    LDQ     0,,PR0
         4 002740   000777 376003                    ANQ     511,DU
         4 002741   000001 116003                    CMPQ    1,DU
         4 002742   002745 601000 4                  TNZ     s:16911
         4 002743   200047 234100                    SZN     ONE_CHAN_FLAG,,AUTO
         4 002744   002764 605000 4                  TPL     s:16918

     1161    16911    5                    IF ADMIN.TERMID_LO.TERM.CHANNEL = '0'B THEN

  16911  4 002745   000011 720100                    LXL0    9,,PR0
         4 002746   002772 600000 4                  TZE     s:16920

     1162    16912    5                       EXIT CHAN_LOOP;
     1163    16913    5                    KH$CHN = ADMIN.KS_CHN;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:173  
  16913  4 002747   000100 100500                    MLR     fill='000'O
         4 002750   000021 000100                    ADSC9   17,,PR0                  cn=0,n=64
         4 002751   200014 000100                    ADSC9   KH$CHN,,AUTO             cn=0,n=64

     1164    16914    5                    CALL DISPLAY_CHAN;

  16914  4 002752   010064 701000 4                  TSX1    DISPLAY_CHAN
         4 002753   000000 011000                    NOP     0

     1165    16915    5                    IF ADMIN.KS_CHN.TERMID = TERMHI OR

  16915  4 002754   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 002755   000100 106500                    CMPC    fill='000'O
         4 002756   000032 000020                    ADSC9   26,,PR0                  cn=0,n=16
         4 002757   200010 000020                    ADSC9   TERMHI,,AUTO             cn=0,n=16
         4 002760   002772 600000 4                  TZE     s:16920
         4 002761   200047 234100                    SZN     ONE_CHAN_FLAG,,AUTO
         4 002762   002772 604000 4                  TMI     s:16920

     1166    16916    5                       ONE_CHAN_FLAG THEN EXIT CHAN_LOOP;
     1167    16917    5                 END;

  16917  4 002763   002720 710000 4                  TRA     s:16903

     1168    16918    4              END;

  16918  4 002764   200331 235100                    LDA     CHAN,,AUTO
         4 002765   004000 035007                    ADLA    2048,DL
         4 002766   200331 755100                    STA     CHAN,,AUTO
         4 002767   200332 236100                    LDQ     CHANHI,,AUTO
         4 002770   200331 116100                    CMPQ    CHAN,,AUTO
         4 002771   002653 603000 4                  TRC     s:16895

     1169    16919
     1170    16920    3              KS_ADMIN.CODE = IGA_ADMIN;

  16920  4 002772   043000 236003                    LDQ     17920,DU
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:174  
         4 002773   000316 552040 2                  STBQ    KS_ADMIN,'40'O

     1171    16921
     1172    16922    4              DO WHILE ('0'B);

  16922  4 002774   005134 710000 4                  TRA     s:17309

     1173    16923    4   OLD_CHAN_DISP:KS_ADMIN.CODE = IGA_ADMIN;

  16923  4 002775   043000 236003       OLD_CHAN_DI* LDQ     17920,DU
         4 002776   000316 552040 2                  STBQ    KS_ADMIN,'40'O

     1174    16924    4                 KS_ADMIN.FNC = %KHA_FNC_CHNTBL;

  16924  4 002777   000033 220003                    LDX0    27,DU
         4 003000   000326 440000 2                  SXL0    KS_ADMIN+8

     1175    16925    4                 KS_ADMIN.HANDLER = ' ';

  16925  4 003001   000035 235000 xsym               LDA     B_VECTNIL+29
         4 003002   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 003003   000317 755000 2                  STA     KS_ADMIN+1
         4 003004   000320 756000 2                  STQ     KS_ADMIN+2

     1176    16926
     1177    16927    4                 IF CODE = %KS_CHAN THEN

  16927  4 003005   200351 235100                    LDA     CODE,,AUTO
         4 003006   000002 115007                    CMPA    2,DL
         4 003007   003100 601000 4                  TNZ     C_LOOP

     1178    16928    5                    DO;

     1179    16929    5                       CALL KSU$PACK2 (TERMLO.TERM.CHANNEL,CHANLO);

  16929  4 003010   200333 631500                    EPPR1   CHANLO,,AUTO
         4 003011   200377 451500                    STP1    MAX+2,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:175  
         4 003012   200400 452500                    STP2    MAX+3,,AUTO
         4 003013   200400 236100                    LDQ     MAX+3,,AUTO
         4 003014   000166 036000 5                  ADLQ    118
         4 003015   200376 756100                    STQ     MAX+1,,AUTO
         4 003016   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003017   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003020   000000 701000 xent               TSX1    KSU$PACK2
         4 003021   000000 011000                    NOP     0

     1180    16930    5                       CALL KSU$PACK2 (TERMHI.TERM.CHANNEL,CHANHI);

  16930  4 003022   200332 630500                    EPPR0   CHANHI,,AUTO
         4 003023   200377 450500                    STP0    MAX+2,,AUTO
         4 003024   200400 452500                    STP2    MAX+3,,AUTO
         4 003025   200400 236100                    LDQ     MAX+3,,AUTO
         4 003026   000207 036000 5                  ADLQ    135
         4 003027   200376 756100                    STQ     MAX+1,,AUTO
         4 003030   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003032   000000 701000 xent               TSX1    KSU$PACK2
         4 003033   000000 011000                    NOP     0

     1181    16931    5                       CALL KSU$PACK2 (TERMLO.TERM.SUBDEVICE,SUBLO);

  16931  4 003034   200335 630500                    EPPR0   SUBLO,,AUTO
         4 003035   200377 450500                    STP0    MAX+2,,AUTO
         4 003036   200005 631500                    EPPR1   TERMLO+1,,AUTO
         4 003037   200376 451500                    STP1    MAX+1,,AUTO
         4 003040   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003041   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003042   000000 701000 xent               TSX1    KSU$PACK2
         4 003043   000000 011000                    NOP     0

     1182    16932    5                       CALL KSU$PACK2 (TERMHI.TERM.SUBDEVICE,SUBHI);

  16932  4 003044   200336 630500                    EPPR0   SUBHI,,AUTO
         4 003045   200377 450500                    STP0    MAX+2,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:176  
         4 003046   200011 631500                    EPPR1   TERMHI+1,,AUTO
         4 003047   200376 451500                    STP1    MAX+1,,AUTO
         4 003050   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003051   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003052   000000 701000 xent               TSX1    KSU$PACK2
         4 003053   000000 011000                    NOP     0

     1183    16933    5                       CALL KSU$PACK2 (TERMLO.TERM.SUBSUBDEVICE,SUBSUBLO);

  16933  4 003054   200340 630500                    EPPR0   SUBSUBLO,,AUTO
         4 003055   200377 450500                    STP0    MAX+2,,AUTO
         4 003056   200400 452500                    STP2    MAX+3,,AUTO
         4 003057   200400 236100                    LDQ     MAX+3,,AUTO
         4 003060   000210 036000 5                  ADLQ    136
         4 003061   200376 756100                    STQ     MAX+1,,AUTO
         4 003062   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003063   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003064   000000 701000 xent               TSX1    KSU$PACK2
         4 003065   000000 011000                    NOP     0

     1184    16934    5                       CALL KSU$PACK2 (TERMHI.TERM.SUBSUBDEVICE,SUBSUBHI);

  16934  4 003066   200337 630500                    EPPR0   SUBSUBHI,,AUTO
         4 003067   200377 450500                    STP0    MAX+2,,AUTO
         4 003070   200400 452500                    STP2    MAX+3,,AUTO
         4 003071   200400 236100                    LDQ     MAX+3,,AUTO
         4 003072   000211 036000 5                  ADLQ    137
         4 003073   200376 756100                    STQ     MAX+1,,AUTO
         4 003074   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003075   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003076   000000 701000 xent               TSX1    KSU$PACK2
         4 003077   000000 011000                    NOP     0

     1185    16935    5                    END;

     1186    16936
     1187    16937    5   C_LOOP:       DO CHAN = CHANLO TO CHANHI BY 128;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:177  

  16937  4 003100   200333 235100       C_LOOP       LDA     CHANLO,,AUTO
         4 003101   200331 755100                    STA     CHAN,,AUTO
         4 003102   003247 710000 4                  TRA     s:16973+3

     1188    16938    5                    CALL KSU$UNPACK (CHAN,KS_ADMIN.TERMID_LO.TERM.CHANNEL);

  16938  4 003103   000215 236000 5                  LDQ     141
         4 003104   200377 756100                    STQ     MAX+2,,AUTO
         4 003105   200331 630500                    EPPR0   CHAN,,AUTO
         4 003106   200376 450500                    STP0    MAX+1,,AUTO
         4 003107   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003110   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003111   000000 701000 xent               TSX1    KSU$UNPACK
         4 003112   000000 011000                    NOP     0

     1189    16939    6   S_LOOP:          DO SUBDEV = SUBLO TO SUBHI;

  16939  4 003113   200335 235100       S_LOOP       LDA     SUBLO,,AUTO
         4 003114   200342 755100                    STA     SUBDEV,,AUTO
         4 003115   003241 710000 4                  TRA     s:16972+3

     1190    16940    6                       CALL KSU$UNPACK (SUBDEV,KS_ADMIN.TERMID_LO.TERM.SUBDEVICE);

  16940  4 003116   000217 236000 5                  LDQ     143
         4 003117   200377 756100                    STQ     MAX+2,,AUTO
         4 003120   200342 630500                    EPPR0   SUBDEV,,AUTO
         4 003121   200376 450500                    STP0    MAX+1,,AUTO
         4 003122   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003123   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003124   000000 701000 xent               TSX1    KSU$UNPACK
         4 003125   000000 011000                    NOP     0

     1191    16941    7   SS_LOOP:            DO SUBSUBDEV = SUBSUBLO TO SUBSUBHI;

  16941  4 003126   200340 235100       SS_LOOP      LDA     SUBSUBLO,,AUTO
         4 003127   200343 755100                    STA     SUBSUBDEV,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:178  
         4 003130   003233 710000 4                  TRA     s:16971+3

     1192    16942    7                          CALL KSU$UNPACK (SUBSUBDEV,KS_ADMIN.TERMID_LO.TERM.
             16942                                   SUBSUBDEVICE);

  16942  4 003131   000220 236000 5                  LDQ     144
         4 003132   200377 756100                    STQ     MAX+2,,AUTO
         4 003133   200343 630500                    EPPR0   SUBSUBDEV,,AUTO
         4 003134   200376 450500                    STP0    MAX+1,,AUTO
         4 003135   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003136   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003137   000000 701000 xent               TSX1    KSU$UNPACK
         4 003140   000000 011000                    NOP     0

     1193    16943    8   LEV_LOOP:              DO LEV = 1 TO 3;

  16943  4 003141   000001 235007       LEV_LOOP     LDA     1,DL
         4 003142   200341 755100                    STA     LEV,,AUTO

     1194    16944
     1195    16945    8                             IF ONE_CHAN_FLAG THEN

  16945  4 003143   200047 234100                    SZN     ONE_CHAN_FLAG,,AUTO
         4 003144   003150 605000 4                  TPL     s:16948

     1196    16946    8                                KS_ADMIN.TERMID_LO.LEV = TERMLO.LEV;

  16946  4 003145   200004 236100                    LDQ     TERMLO,,AUTO
         4 003146   000327 552020 2                  STBQ    KS_ADMIN+9,'20'O
         4 003147   003153 710000 4                  TRA     s:16950

     1197    16947    8                             ELSE
     1198    16948    8                                KS_ADMIN.TERMID_LO.LEV = LEV;

  16948  4 003150   200341 236100                    LDQ     LEV,,AUTO
         4 003151   000022 736000                    QLS     18
         4 003152   000327 552020 2                  STBQ    KS_ADMIN+9,'20'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:179  

     1199    16949
     1200    16950    8                             KS_ADMIN.TERMID_HI = KS_ADMIN.TERMID_LO;

  16950  4 003153   000000 100400                    MLR     fill='000'O
         4 003154   000327 000020 2                  ADSC9   KS_ADMIN+9               cn=0,n=16
         4 003155   000333 000020 2                  ADSC9   KS_ADMIN+13              cn=0,n=16

     1201    16951
     1202    16952    8                    CALL KSR$WR_HLPCG(VECTOR(KS_ADMIN)) ALTRET(ERR1);

  16952  4 003156   000214 630400 5                  EPPR0   140
         4 003157   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003160   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 003161   005141 702000 4                  TSX2    ERR1

     1203    16953    8                    CALL KSR$RD_HLPCG(ONE_CHAN_FLAG);

  16953  4 003162   200047 630500                    EPPR0   ONE_CHAN_FLAG,,AUTO
         4 003163   200376 450500                    STP0    MAX+1,,AUTO
         4 003164   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003165   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003166   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 003167   000000 011000                    NOP     0

     1204    16954    8                    IF ADMIN.RESULTS.ERR# = %E$CHAN_NOT_THERE OR

  16954  4 003170   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 003171   000007 236100                    LDQ     7,,PR0
         4 003172   377770 376007                    ANQ     131064,DL
         4 003173   020670 116007                    CMPQ    8632,DL
         4 003174   003244 600000 4                  TZE     s:16973
         4 003175   021040 116007                    CMPQ    8736,DL
         4 003176   003244 600000 4                  TZE     s:16973

     1205    16955    8                      ADMIN.RESULTS.ERR# = %E$NOT_OWNED THEN
     1206    16956    8                       EXIT S_LOOP;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:180  
     1207    16957    8                    IF ADMIN.RESULTS ~= '0'B THEN

  16957  4 003177   000007 235100                    LDA     7,,PR0
         4 003200   005141 601000 4                  TNZ     ERR1

     1208    16958    8                       GOTO ERR1;
     1209    16959    8                    KH$CHN = ADMIN.KS_CHN;

  16959  4 003201   000100 100500                    MLR     fill='000'O
         4 003202   000021 000100                    ADSC9   17,,PR0                  cn=0,n=64
         4 003203   200014 000100                    ADSC9   KH$CHN,,AUTO             cn=0,n=64

     1210    16960    8                    IF LEV ~= 1 AND NOT ONE_CHAN_FLAG THEN

  16960  4 003204   200341 235100                    LDA     LEV,,AUTO
         4 003205   000001 115007                    CMPA    1,DL
         4 003206   003215 600000 4                  TZE     s:16966
         4 003207   200047 234100                    SZN     ONE_CHAN_FLAG,,AUTO
         4 003210   003215 604000 4                  TMI     s:16966

     1211    16961    9                       DO;

     1212    16962    9                       PTR$ = KH$CHN.LNK$;

  16962  4 003211   200032 236100                    LDQ     KH$CHN+14,,AUTO
         4 003212   200175 756100                    STQ     PTR$,,AUTO

     1213    16963    9                       IF PTR$_R = '0'B THEN

  16963  4 003213   200175 235100                    LDA     PTR$,,AUTO
         4 003214   003230 600000 4                  TZE     s:16971

     1214    16964    9                          EXIT LEV_LOOP;
     1215    16965    9                       END;

     1216    16966    8                       PTR$ = KH$CHN.CTX$;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:181  
  16966  4 003215   200022 236100                    LDQ     KH$CHN+6,,AUTO
         4 003216   200175 756100                    STQ     PTR$,,AUTO

     1217    16967    8                             CALL DISPLAY_CHAN;

  16967  4 003217   010064 701000 4                  TSX1    DISPLAY_CHAN
         4 003220   000000 011000                    NOP     0

     1218    16968    8         IF ONE_CHAN_FLAG  THEN

  16968  4 003221   200047 234100                    SZN     ONE_CHAN_FLAG,,AUTO
         4 003222   003252 604000 4                  TMI     s:16974

     1219    16969    8              EXIT C_LOOP;
     1220    16970    8                          END LEV_LOOP;

  16970  4 003223   200341 235100                    LDA     LEV,,AUTO
         4 003224   000001 035007                    ADLA    1,DL
         4 003225   200341 755100                    STA     LEV,,AUTO
         4 003226   000004 115007                    CMPA    4,DL
         4 003227   003143 602000 4                  TNC     s:16945

     1221    16971    7                       END SS_LOOP;

  16971  4 003230   200343 235100                    LDA     SUBSUBDEV,,AUTO
         4 003231   000001 035007                    ADLA    1,DL
         4 003232   200343 755100                    STA     SUBSUBDEV,,AUTO
         4 003233   200337 236100                    LDQ     SUBSUBHI,,AUTO
         4 003234   200343 116100                    CMPQ    SUBSUBDEV,,AUTO
         4 003235   003131 603000 4                  TRC     s:16942

     1222    16972    6                    END S_LOOP;

  16972  4 003236   200342 235100                    LDA     SUBDEV,,AUTO
         4 003237   000001 035007                    ADLA    1,DL
         4 003240   200342 755100                    STA     SUBDEV,,AUTO
         4 003241   200336 236100                    LDQ     SUBHI,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:182  
         4 003242   200342 116100                    CMPQ    SUBDEV,,AUTO
         4 003243   003116 603000 4                  TRC     s:16940

     1223    16973    5                 END C_LOOP;

  16973  4 003244   200331 235100                    LDA     CHAN,,AUTO
         4 003245   000200 035007                    ADLA    128,DL
         4 003246   200331 755100                    STA     CHAN,,AUTO
         4 003247   200332 236100                    LDQ     CHANHI,,AUTO
         4 003250   200331 116100                    CMPQ    CHAN,,AUTO
         4 003251   003103 603000 4                  TRC     s:16938

     1224    16974    4              END;     /* OLD_CHAN_DISP */

  16974  4 003252   005134 710000 4                  TRA     s:17309

     1225    16975        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:183  
     1226    16976    3              CASE(%KS_NETWORK);

     1227    16977    3                 KS_SUB_BUF_1.COUNT = SIZEC('NETWORK');

  16977  4 003253   007000 236003                    LDQ     3584,DU
         4 003254   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1228    16978    3                 KS_SUB_BUF_1.TEXT = 'NETWORK';

  16978  4 003255   040000 100400                    MLR     fill='040'O
         4 003256   002735 000007 1                  ADSC9   PARM_DISPONLY_FMT+25     cn=0,n=7
         4 003257   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1229    16979    3                 READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  16979  4 003260   000040 237000 5                  LDAQ    32
         4 003261   006416 757000 2                  STAQ    READ_NETCON+2

     1230    16980    3                 READ_NETCON.BUF_ = VECTOR(KS_NETWORK);

  16980  4 003262   000042 237000 5                  LDAQ    34
         4 003263   006420 757000 2                  STAQ    READ_NETCON+4

     1231    16981    4                 CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  16981  4 003264   006414 630400 2                  EPPR0   READ_NETCON
         4 003265   440000 713400                    CLIMB   alt,read
         4 003266   401400 401760                    pmme    nvectors=4
         4 003267   003271 702000 4                  TSX2    s:16982
         4 003270   003303 710000 4                  TRA     s:16986

     1232    16982    4                    IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY

  16982  4 003271   000000 470400 xsym               LDP0    B$TCB$
         4 003272   000000 471500                    LDP1    0,,PR0
         4 003273   100102 236100                    LDQ     66,,PR1
         4 003274   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:184  
         4 003275   001020 116007                    CMPQ    528,DL
         4 003276   005135 601000 4                  TNZ     DISP_ERR

     1233    16983    4                       THEN GOTO DISP_ERR;
     1234    16984    4                    KS_NETWORK = '0'B;

  16984  4 003277   012004 220003                    LDX0    5124,DU
         4 003300   000040 100400                    MLR     fill='000'O
         4 003301   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 003302   001365 000010 2                  ADSC9   KS_NETWORK               cn=0,n=*X0

     1235    16985    4                    END;  /* WHENALTRETURN */

     1236    16986    4                 IF KS_NETWORK.NODE# = 0 THEN DO;

  16986  4 003303   001365 235000 2                  LDA     KS_NETWORK
         4 003304   003312 601000 4                  TNZ     s:16994

     1237    16987    4                    CALL KSE$ERRMSG(%E$KS_NO_NETWORK);

  16987  4 003305   000045 630400 5                  EPPR0   37
         4 003306   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003307   000000 701000 xent               TSX1    KSE$ERRMSG
         4 003310   000000 011000                    NOP     0

     1238    16988                         /*E* ERROR: KSN-E$KS_NO_NETWORK-0
     1239    16989                              MESSAGE: No nodes currently defined.
     1240    16990                              MESSAGE1: Nodes must be defined via the DEFINE command.
     1241    16991                              DESCRIPTION: SEE MESSAGES */
     1242    16992    4                    END;  /* IF NODE# = 0 */

  16992  4 003311   005134 710000 4                  TRA     s:17309

     1243    16993    4                 ELSE DO;

     1244    16994    4                 READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:185  
  16994  4 003312   000222 237000 5                  LDAQ    146
         4 003313   006416 757000 2                  STAQ    READ_NETCON+2

     1245    16995    4               READ_NETCON.BUF_ = VECTOR(KS_RFEP);

  16995  4 003314   000224 237000 5                  LDAQ    148
         4 003315   006420 757000 2                  STAQ    READ_NETCON+4

     1246    16996    5               CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  16996  4 003316   006414 630400 2                  EPPR0   READ_NETCON
         4 003317   440000 713400                    CLIMB   alt,read
         4 003320   401400 401760                    pmme    nvectors=4
         4 003321   003323 702000 4                  TSX2    s:16997
         4 003322   003327 710000 4                  TRA     s:16999

     1247    16997    5                   KS_RFEP = KS_NETWORK;

  16997  4 003323   012004 220003                    LDX0    5124,DU
         4 003324   000040 100440                    MLR     fill='000'O
         4 003325   001365 000010 2                  ADSC9   KS_NETWORK               cn=0,n=*X0
         4 003326   003770 000010 2                  ADSC9   KS_RFEP                  cn=0,n=*X0

     1248    16998    5                END;

     1249    16999    4   IF BLK$->OUT$BLK.NSUBLKS = 0 THEN

  16999  4 003327   200173 470500                    LDP0    BLK$,,AUTO
         4 003330   000001 220100                    LDX0    1,,PR0
         4 003331   003336 601000 4                  TNZ     s:17006

     1250    17000    5        DO;

     1251    17001    5           NODESLCT = '0'B;

  17001  4 003332   200044 450100                    STZ     NODESLCT,,AUTO

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:186  
     1252    17002    5           LAST = KS_NETWORK.NODE#;

  17002  4 003333   001365 235000 2                  LDA     KS_NETWORK
         4 003334   200327 755100                    STA     LAST,,AUTO

     1253    17003    5        END;

  17003  4 003335   003344 710000 4                  TRA     s:17009

     1254    17004    4   ELSE
     1255    17005    5        DO;

     1256    17006    5           NODESLCT = '1'B;

  17006  4 003336   400000 236003                    LDQ     -131072,DU
         4 003337   200044 756100                    STQ     NODESLCT,,AUTO

     1257    17007    5           LAST = BLK$->OUT$BLK.NSUBLKS - 1;

  17007  4 003340   000001 236100                    LDQ     1,,PR0
         4 003341   000022 772000                    QRL     18
         4 003342   000001 136007                    SBLQ    1,DL
         4 003343   200327 756100                    STQ     LAST,,AUTO

     1258    17008    5        END;

     1259    17009    4                    FIRST = '1'B;

  17009  4 003344   400000 236003                    LDQ     -131072,DU
         4 003345   000000 756000 2                  STQ     FIRST

     1260    17010    5                    DO L = 0 TO LAST;

  17010  4 003346   200045 450100                    STZ     L,,AUTO
         4 003347   003503 710000 4                  TRA     END_DI_NET_LOOP+3

     1261    17011    5                       IF NODESLCT THEN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:187  

  17011  4 003350   200044 234100                    SZN     NODESLCT,,AUTO
         4 003351   003416 605000 4                  TPL     s:17024

     1262    17012    6                          DO;

     1263    17013    6                             CALL GET_NODE(BLK$->OUT$BLK.SUBLK$(L));

  17013  4 003352   200045 236100                    LDQ     L,,AUTO
         4 003353   000022 736000                    QLS     18
         4 003354   000003 036003                    ADLQ    3,DU
         4 003355   200173 036100                    ADLQ    BLK$,,AUTO
         4 003356   200355 756100                    STQ     SUBLK_INDX+2,,AUTO
         4 003357   005206 701000 4                  TSX1    GET_NODE
         4 003360   000000 011000                    NOP     0

     1264    17014    6                             J = FEPNODE;

  17014  4 003361   200200 235100                    LDA     FEPNODE,,AUTO
         4 003362   200077 755100                    STA     J,,AUTO

     1265    17015    6                             IF FEPNODE > KS_NETWORK.NODE# OR FEPNAME = ' ' OR FEPNODE
             17015                                      = -1 THEN

  17015  4 003363   001365 236000 2                  LDQ     KS_NETWORK
         4 003364   003367 604000 4                  TMI     s:17015+4
         4 003365   200200 116100                    CMPQ    FEPNODE,,AUTO
         4 003366   003375 604000 4                  TMI     s:17017
         4 003367   040000 106500                    CMPC    fill='040'O
         4 003370   200201 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 003371   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003372   003375 600000 4                  TZE     s:17017
         4 003373   000027 115000 xsym               CMPA    B_VECTNIL+23
         4 003374   003420 601000 4                  TNZ     s:17025

     1266    17016    7                                DO;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:188  
     1267    17017    7                                  KS_SUB_BUF_1.TEXT = BLK$->OUT$BLK.SUBLK$(L)->OUT$SYM
             17017                                            .TEXT;

  17017  4 003375   200173 470500                    LDP0    BLK$,,AUTO
         4 003376   200045 720100                    LXL0    L,,AUTO
         4 003377   000003 471510                    LDP1    3,X0,PR0
         4 003400   100004 236100                    LDQ     4,,PR1
         4 003401   000033 772000                    QRL     27
         4 003402   000000 621006                    EAX1    0,QL
         4 003403   040000 100540                    MLR     fill='040'O
         4 003404   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 003405   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1268    17018    7                                   KS_SUB_BUF_1.COUNT = BLK$->OUT$BLK.SUBLK$(L)->
             17018                                            OUT$SYM.COUNT;

  17018  4 003406   000003 471510                    LDP1    3,X0,PR0
         4 003407   100004 236100                    LDQ     4,,PR1
         4 003410   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1269    17019    7                                  CALL KSE$ERRMSG(%E$KS_UNDEFNODE,VECTOR(KS_SUB_BUF_1)
             17019                                            );

  17019  4 003411   000227 630400 5                  EPPR0   151
         4 003412   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003413   000000 701000 xent               TSX1    KSE$ERRMSG
         4 003414   000000 011000                    NOP     0

     1270    17020    7                                   GOTO END_DI_NET_LOOP;

  17020  4 003415   003500 710000 4                  TRA     END_DI_NET_LOOP

     1271    17021    7                                END;
     1272    17022    6                          END;
     1273    17023    5                       ELSE
     1274    17024    5                          J = L;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:189  
  17024  4 003416   200045 235100                    LDA     L,,AUTO
         4 003417   200077 755100                    STA     J,,AUTO

     1275    17025    5                       IF KS_RFEP.NODE.TYPE(J) ~= 0 THEN

  17025  4 003420   200077 236100                    LDQ     J,,AUTO
         4 003421   000005 402007                    MPY     5,DL
         4 003422   003771 235006 2                  LDA     KS_RFEP+1,QL
         4 003423   003500 600000 4                  TZE     END_DI_NET_LOOP

     1276    17026    6                          DO;

     1277    17027    6                             KS_NODEINFO_F.V.NODENUM# = J;

  17027  4 003424   200077 236100                    LDQ     J,,AUTO
         4 003425   000033 736000                    QLS     27
         4 003426   006452 552040 2                  STBQ    KS_NODEINFO_F+6,'40'O

     1278    17028    6                             CALL M$NODEINFO (KS_NODEINFO_F)

  17028  4 003427   006444 630400 2                  EPPR0   KS_NODEINFO_F
         4 003430   560031 713400                    CLIMB   alt,+57369
         4 003431   400400 401760                    pmme    nvectors=2
         4 003432   003434 702000 4                  TSX2    s:17030
         4 003433   003436 710000 4                  TRA     s:17033

     1279    17029    7                                WHENALTRETURN DO;

     1280    17030    7                                   KS_NODEINFO_V.LINKNODENUM# = 0;

  17030  4 003434   000000 236003                    LDQ     0,DU
         4 003435   006461 552040 2                  STBQ    KS_NODEINFO_V+5,'40'O

     1281    17031    7                                END;

     1282    17032
     1283    17033    6                             KS_LINK_KEY.NODE = J;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:190  

  17033  4 003436   200077 236100                    LDQ     J,,AUTO
         4 003437   000011 736000                    QLS     9
         4 003440   006372 552010 2                  STBQ    KS_LINK_KEY,'10'O

     1284    17034    6                             READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  17034  4 003441   000232 237000 5                  LDAQ    154
         4 003442   006416 757000 2                  STAQ    READ_NETCON+2

     1285    17035    6                             READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  17035  4 003443   000234 237000 5                  LDAQ    156
         4 003444   006420 757000 2                  STAQ    READ_NETCON+4

     1286    17036    7                             CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  17036  4 003445   006414 630400 2                  EPPR0   READ_NETCON
         4 003446   440000 713400                    CLIMB   alt,read
         4 003447   401400 401760                    pmme    nvectors=4
         4 003450   003452 702000 4                  TSX2    s:17037
         4 003451   003454 710000 4                  TRA     s:17040

     1287    17037    7                                KS_LINK.LINKS# = 0;

  17037  4 003452   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 003453   000000 450100                    STZ     0,,PR0

     1288    17038    7                                END;

     1289    17039
     1290    17040    6                             CALL KSW$WRITE (NETWORK_VEC,

  17040  4 003454   777640 235007                    LDA     -96,DL
         4 003455   200376 452500                    STP2    MAX+1,,AUTO
         4 003456   200376 236100                    LDQ     MAX+1,,AUTO
         4 003457   000077 036003                    ADLQ    63,DU
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:191  
         4 003460   200400 757100                    STAQ    MAX+3,,AUTO
         4 003461   000242 237000 5                  LDAQ    162
         4 003462   200410 757100                    STAQ    MAX+11,,AUTO
         4 003463   000244 237000 5                  LDAQ    164
         4 003464   200406 757100                    STAQ    MAX+9,,AUTO
         4 003465   000246 236000 5                  LDQ     166
         4 003466   200405 756100                    STQ     MAX+8,,AUTO
         4 003467   200400 630500                    EPPR0   MAX+3,,AUTO
         4 003470   200404 450500                    STP0    MAX+7,,AUTO
         4 003471   000250 237000 5                  LDAQ    168
         4 003472   200402 757100                    STAQ    MAX+5,,AUTO
         4 003473   200402 630500                    EPPR0   MAX+5,,AUTO
         4 003474   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 003475   000000 701000 xent               TSX1    KSW$WRITE
         4 003476   000000 011000                    NOP     0

     1291    17041    6                                VECTOR(FIRST),
     1292    17042    6                                VECTOR(J),
     1293    17043    6                                VECTOR(KS_NETWORK),
     1294    17044    6                                VECTOR(KS_RFEP),
     1295    17045    6                                VECTOR(TEXT_NODETYPE),
     1296    17046    6                                VECTOR(KS_NODEINFO_V.LINKNODENUM#),
     1297    17047    6                                VECTOR(KS_MSGBUF));
     1298    17048    6                             FIRST = '0'B;

  17048  4 003477   000000 450000 2                  STZ     FIRST

     1299    17049    6                          END;

     1300    17050    5   END_DI_NET_LOOP:    END;                /* DO J                               */

  17050  4 003500   200045 235100       END_DI_NET_* LDA     L,,AUTO
         4 003501   000001 035007                    ADLA    1,DL
         4 003502   200045 755100                    STA     L,,AUTO
         4 003503   200327 236100                    LDQ     LAST,,AUTO
         4 003504   200045 116100                    CMPQ    L,,AUTO
         4 003505   003350 603000 4                  TRC     s:17011
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:192  

     1301    17051    4                    END;  /* ELSE */

  17051  4 003506   005134 710000 4                  TRA     s:17309

     1302    17052        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:193  
     1303    17053        /*
     1304    17054                This section of the case displays the xxxx associated with
     1305    17055                the selected node
     1306    17056        */
     1307    17057    3              CASE(%KS_LINKS);

     1308    17058    3                 IF KS_NODENAME='HOST' THEN

  17058  4 003507   040000 106400                    CMPC    fill='040'O
         4 003510   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 003511   002710 000004 1                  ADSC9   PARM_DISPONLY_FMT+4      cn=0,n=4
         4 003512   003520 601000 4                  TNZ     s:17064

     1309    17059    4                    DO;

     1310    17060    4                    CALL KSE$ERRMSG(%E$KS_NONODE);

  17060  4 003513   000001 630400 5                  EPPR0   1
         4 003514   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003515   000000 701000 xent               TSX1    KSE$ERRMSG
         4 003516   000000 011000                    NOP     0

     1311    17061    4                    RETURN;

  17061  4 003517   000000 702200 xent               TSX2  ! X66_ARET

     1312    17062    4                    END;
     1313    17063
     1314    17064    3                 KS_LINK_KEY.NODE = KS_NODE;

  17064  4 003520   000000 236000 xsym               LDQ     KS_NODE
         4 003521   000011 736000                    QLS     9
         4 003522   006372 552010 2                  STBQ    KS_LINK_KEY,'10'O

     1315    17065    3                 KS_SUB_BUF_1.COUNT = SIZEC('LINKS');

  17065  4 003523   005000 236003                    LDQ     2560,DU
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:194  
         4 003524   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1316    17066    3                 KS_SUB_BUF_1.TEXT = 'LINKS';

  17066  4 003525   040000 100400                    MLR     fill='040'O
         4 003526   002737 000005 1                  ADSC9   PARM_DISPONLY_FMT+27     cn=0,n=5
         4 003527   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1317    17067    3                 CALL KSW$WRITE(LINK_VEC,VECTOR(KS_NODENAME));

  17067  4 003530   000252 630400 5                  EPPR0   170
         4 003531   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003532   000000 701000 xent               TSX1    KSW$WRITE
         4 003533   000000 011000                    NOP     0

     1318    17068    3                 READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  17068  4 003534   000232 237000 5                  LDAQ    154
         4 003535   006416 757000 2                  STAQ    READ_NETCON+2

     1319    17069    3                 READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  17069  4 003536   000234 237000 5                  LDAQ    156
         4 003537   006420 757000 2                  STAQ    READ_NETCON+4

     1320    17070
     1321    17071    3                 CALL M$READ(READ_NETCON) ALTRET (DISP_ERR);

  17071  4 003540   006414 630400 2                  EPPR0   READ_NETCON
         4 003541   440000 713400                    CLIMB   alt,read
         4 003542   401400 401760                    pmme    nvectors=4
         4 003543   005135 702000 4                  TSX2    DISP_ERR

     1322    17072    3                 CALL KSW$WRITE(LINKCHAN_VEC,VECTOR(KS_LINK.LINKS#));

  17072  4 003544   777640 235007                    LDA     -96,DL
         4 003545   000000 236000 xsym               LDQ     KS_MSGBUF$
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:195  
         4 003546   200376 757100                    STAQ    MAX+1,,AUTO
         4 003547   200376 630500                    EPPR0   MAX+1,,AUTO
         4 003550   200401 450500                    STP0    MAX+4,,AUTO
         4 003551   000254 236000 5                  LDQ     172
         4 003552   200400 756100                    STQ     MAX+3,,AUTO
         4 003553   200400 630500                    EPPR0   MAX+3,,AUTO
         4 003554   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003555   000000 701000 xent               TSX1    KSW$WRITE
         4 003556   000000 011000                    NOP     0

     1323    17073
     1324    17074    4                 DO I = 0 TO KS_LINK.LINKS#-1;

  17074  4 003557   200075 450100                    STZ     I,,AUTO
         4 003560   003615 710000 4                  TRA     s:17076+3

     1325    17075    4                    CALL KSW$WRITE(CHAN_VEC,VECTOR(I),VECTOR(KS_LINK.CHANNEL(I)));

  17075  4 003561   777640 235007                    LDA     -96,DL
         4 003562   200376 452500                    STP2    MAX+1,,AUTO
         4 003563   200376 236100                    LDQ     MAX+1,,AUTO
         4 003564   000075 036003                    ADLQ    61,DU
         4 003565   200400 757100                    STAQ    MAX+3,,AUTO
         4 003566   377640 235007                    LDA     130976,DL
         4 003567   200075 236100                    LDQ     I,,AUTO
         4 003570   000021 736000                    QLS     17
         4 003571   000001 036003                    ADLQ    1,DU
         4 003572   000000 036000 xsym               ADLQ    KS_MSGBUF$
         4 003573   200404 757100                    STAQ    MAX+7,,AUTO
         4 003574   200400 237100                    LDAQ    MAX+3,,AUTO
         4 003575   200402 757100                    STAQ    MAX+5,,AUTO
         4 003576   200404 237100                    LDAQ    MAX+7,,AUTO
         4 003577   200406 757100                    STAQ    MAX+9,,AUTO
         4 003600   200406 630500                    EPPR0   MAX+9,,AUTO
         4 003601   200412 450500                    STP0    MAX+13,,AUTO
         4 003602   200402 631500                    EPPR1   MAX+5,,AUTO
         4 003603   200411 451500                    STP1    MAX+12,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:196  
         4 003604   000255 236000 5                  LDQ     173
         4 003605   200410 756100                    STQ     MAX+11,,AUTO
         4 003606   200410 630500                    EPPR0   MAX+11,,AUTO
         4 003607   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 003610   000000 701000 xent               TSX1    KSW$WRITE
         4 003611   000000 011000                    NOP     0

     1326    17076    4                 END;

  17076  4 003612   200075 235100                    LDA     I,,AUTO
         4 003613   000001 035007                    ADLA    1,DL
         4 003614   200075 755100                    STA     I,,AUTO
         4 003615   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 003616   200075 236100                    LDQ     I,,AUTO
         4 003617   000000 116100                    CMPQ    0,,PR0
         4 003620   003561 602000 4                  TNC     s:17075
         4 003621   005134 710000 4                  TRA     s:17309

     1327    17077
     1328    17078        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:197  
     1329    17079
     1330    17080        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:198  
     1331    17081    3               CASE(%KS_PARAM,%KS_BOOT_PRMS,%KS_LCP6_PRMS,%KS_HNDLR_PRMS);

     1332    17082    3                  IF KS_NODENAME = 'HOST' THEN

  17082  4 003622   040000 106400                    CMPC    fill='040'O
         4 003623   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 003624   002710 000004 1                  ADSC9   PARM_DISPONLY_FMT+4      cn=0,n=4
         4 003625   003633 601000 4                  TNZ     s:17087

     1333    17083    4                     DO;

     1334    17084    4                        CALL KSE$ERRMSG(%E$KS_NONODE);

  17084  4 003626   000001 630400 5                  EPPR0   1
         4 003627   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003630   000000 701000 xent               TSX1    KSE$ERRMSG
         4 003631   000000 011000                    NOP     0

     1335    17085    4                        RETURN;

  17085  4 003632   000000 702200 xent               TSX2  ! X66_ARET

     1336    17086    4                     END;
     1337    17087    3                 FIRST_PARM = '1'B;

  17087  4 003633   400000 236003                    LDQ     -131072,DU
         4 003634   200067 756100                    STQ     FIRST_PARM,,AUTO

     1338    17088
     1339    17089    4                  DO CASE (BLK$->OUT$BLK.CODE);

  17089  4 003635   000016 101003                    CMPX1   14,DU
         4 003636   003640 602011 4                  TNC     s:17089+3,X1
         4 003637   003717 710000 4                  TRA     PARM_LOOP
         4 003640   003717 710000 4                  TRA     PARM_LOOP
         4 003641   003717 710000 4                  TRA     PARM_LOOP
         4 003642   003717 710000 4                  TRA     PARM_LOOP
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:199  
         4 003643   003656 710000 4                  TRA     s:17091
         4 003644   003717 710000 4                  TRA     PARM_LOOP
         4 003645   003717 710000 4                  TRA     PARM_LOOP
         4 003646   003717 710000 4                  TRA     PARM_LOOP
         4 003647   003717 710000 4                  TRA     PARM_LOOP
         4 003650   003717 710000 4                  TRA     PARM_LOOP
         4 003651   003717 710000 4                  TRA     PARM_LOOP
         4 003652   003717 710000 4                  TRA     PARM_LOOP
         4 003653   003672 710000 4                  TRA     s:17096
         4 003654   003700 710000 4                  TRA     s:17100
         4 003655   003706 710000 4                  TRA     s:17104

     1340    17090    4                     CASE (%KS_PARAM);

     1341    17091    4                        MAX_PARM = 0;

  17091  4 003656   200074 450100                    STZ     MAX_PARM,,AUTO

     1342    17092    4                        PARMTYPE = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  17092  4 003657   300003 474500                    LDP4    3,,PR3
         4 003660   400000 236100                    LDQ     0,,PR4
         4 003661   777777 376007                    ANQ     -1,DL
         4 003662   200102 756100                    STQ     PARMTYPE,,AUTO

     1343    17093    4                        ONE_PARM_ONLY = '1'B;

  17093  4 003663   400000 236003                    LDQ     -131072,DU
         4 003664   200072 756100                    STQ     ONE_PARM_ONLY,,AUTO

     1344    17094    4                       IF LAST_DI = %KS_PARAM THEN FIRST_PARM = '0'B;

  17094  4 003665   200326 235100                    LDA     LAST_DI,,AUTO
         4 003666   000003 115007                    CMPA    3,DL
         4 003667   003717 601000 4                  TNZ     PARM_LOOP

  17094  4 003670   200067 450100                    STZ     FIRST_PARM,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:200  
         4 003671   003717 710000 4                  TRA     PARM_LOOP

     1345    17095    4                     CASE (%KS_BOOT_PRMS);

     1346    17096    4                        MAX_PARM = %GI_BOOT_HI;

  17096  4 003672   000017 235007                    LDA     15,DL
         4 003673   200074 755100                    STA     MAX_PARM,,AUTO

     1347    17097    4                        PARMTYPE = %KS_BOOT_PARAM;

  17097  4 003674   000001 235007                    LDA     1,DL
         4 003675   200102 755100                    STA     PARMTYPE,,AUTO

     1348    17098    4                        ONE_PARM_ONLY = '0'B;

  17098  4 003676   200072 450100                    STZ     ONE_PARM_ONLY,,AUTO
         4 003677   003717 710000 4                  TRA     PARM_LOOP

     1349    17099    4                     CASE (%KS_LCP6_PRMS);

     1350    17100    4                        MAX_PARM = %GI_CNTL_DISPHI;

  17100  4 003700   000035 235007                    LDA     29,DL
         4 003701   200074 755100                    STA     MAX_PARM,,AUTO

     1351    17101    4                        PARMTYPE = %KS_LCP6_PARAM;

  17101  4 003702   000002 235007                    LDA     2,DL
         4 003703   200102 755100                    STA     PARMTYPE,,AUTO

     1352    17102    4                        ONE_PARM_ONLY = '0'B;

  17102  4 003704   200072 450100                    STZ     ONE_PARM_ONLY,,AUTO
         4 003705   003717 710000 4                  TRA     PARM_LOOP

     1353    17103    4                     CASE (%KS_HNDLR_PRMS);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:201  

     1354    17104    4                        MAX_PARM = KS_HAND_INFO.SZ(KS_HNDLRINDX) - 1;

  17104  4 003706   000000 236000 xsym               LDQ     KS_HNDLRINDX
         4 003707   000033 772000                    QRL     27
         4 003710   000005 402007                    MPY     5,DL
         4 003711   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         4 003712   000001 135007                    SBLA    1,DL
         4 003713   200074 755100                    STA     MAX_PARM,,AUTO

     1355    17105    4                        PARMTYPE = %KS_HNDLR_PARAM;

  17105  4 003714   000003 235007                    LDA     3,DL
         4 003715   200102 755100                    STA     PARMTYPE,,AUTO

     1356    17106    4                        ONE_PARM_ONLY = '0'B;

  17106  4 003716   200072 450100                    STZ     ONE_PARM_ONLY,,AUTO

     1357    17107    4                  END;

     1358    17108    3   PARM_LOOP:
     1359    17109    4         DO PARMX = 0 TO MAX_PARM;

  17109  4 003717   200101 450100       PARM_LOOP    STZ     PARMX,,AUTO
         4 003720   005131 710000 4                  TRA     PARM_LOOP_END+3

     1360    17110
     1361    17111    4            IF ONE_PARM_ONLY THEN

  17111  4 003721   200072 234100                    SZN     ONE_PARM_ONLY,,AUTO
         4 003722   003731 605000 4                  TPL     s:17114

     1362    17112    4               PARMX = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  17112  4 003723   200173 470500                    LDP0    BLK$,,AUTO
         4 003724   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:202  
         4 003725   100003 473500                    LDP3    3,,PR1
         4 003726   300000 236100                    LDQ     0,,PR3
         4 003727   777777 376007                    ANQ     -1,DL
         4 003730   200101 756100                    STQ     PARMX,,AUTO

     1363    17113
     1364    17114    4            IF KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME.NAME# = 'SPARE' OR

  17114  4 003731   200102 720100                    LXL0    PARMTYPE,,AUTO
         4 003732   000000 470410 xsym               LDP0    KS_TBL,X0
         4 003733   200101 235100                    LDA     PARMX,,AUTO
         4 003734   000002 735000                    ALS     2
         4 003735   000000 471505                    LDP1    0,AL,PR0
         4 003736   000100 101500                    MRL     fill='000'O
         4 003737   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 003740   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 003741   200376 221100                    LDX1    MAX+1,,AUTO
         4 003742   040000 106540                    CMPC    fill='040'O
         4 003743   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         4 003744   002741 000005 1                  ADSC9   PARM_DISPONLY_FMT+29     cn=0,n=5
         4 003745   005126 600000 4                  TZE     PARM_LOOP_END
         4 003746   000000 471505                    LDP1    0,AL,PR0
         4 003747   000100 101500                    MRL     fill='000'O
         4 003750   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 003751   200377 000002                    ADSC9   MAX+2,,AUTO              cn=0,n=2
         4 003752   200377 222100                    LDX2    MAX+2,,AUTO
         4 003753   040000 106540                    CMPC    fill='040'O
         4 003754   100000 200012                    ADSC9   0,,PR1                   cn=1,n=*X2
         4 003755   002743 000012 1                  ADSC9   PARM_DISPONLY_FMT+31     cn=0,n=10
         4 003756   005126 600000 4                  TZE     PARM_LOOP_END

     1365    17115    4               KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME.NAME# =
     1366    17116    4               'DPS8000FLG' THEN
     1367    17117    4               GOTO PARM_LOOP_END;
     1368    17118                 /*N* Temp. for D00.  See SET command*/
     1369    17119    4           IF PARMTYPE = %KS_BOOT_PARAM AND PARMX = %GI_BOOT_NSHUF THEN

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:203  
  17119  4 003757   200102 236100                    LDQ     PARMTYPE,,AUTO
         4 003760   000001 116007                    CMPQ    1,DL
         4 003761   003774 601000 4                  TNZ     s:17126
         4 003762   200101 235100                    LDA     PARMX,,AUTO
         4 003763   000010 115007                    CMPA    8,DL
         4 003764   003774 601000 4                  TNZ     s:17126

     1370    17120    5              DO;

     1371    17121    5                 IF ONE_PARM_ONLY THEN

  17121  4 003765   200072 234100                    SZN     ONE_PARM_ONLY,,AUTO
         4 003766   003773 605000 4                  TPL     s:17123

     1372    17122    5                    CALL KSE$ERRMSG (%E$KS_NO_MORE_NSHUF);

  17122  4 003767   000257 630400 5                  EPPR0   175
         4 003770   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003771   000000 701000 xent               TSX1    KSE$ERRMSG
         4 003772   000000 011000                    NOP     0

     1373    17123    5                 GOTO PARM_LOOP_END;

  17123  4 003773   005126 710000 4                  TRA     PARM_LOOP_END

     1374    17124    5              END;
     1375    17125
     1376    17126    4           IF PARMTYPE = %KS_LCP6_PARAM AND

  17126  4 003774   000002 116007                    CMPQ    2,DL
         4 003775   004003 601000 4                  TNZ     s:17131
         4 003776   200101 235100                    LDA     PARMX,,AUTO
         4 003777   000016 115007                    CMPA    14,DL
         4 004000   004003 601000 4                  TNZ     s:17131
         4 004001   200072 234100                    SZN     ONE_PARM_ONLY,,AUTO
         4 004002   005126 605000 4                  TPL     PARM_LOOP_END

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:204  
     1377    17127    4              PARMX = %GI_CNTL_KEEPDELTA AND
     1378    17128    4              NOT ONE_PARM_ONLY THEN
     1379    17129    4              GOTO PARM_LOOP_END;
     1380    17130
     1381    17131    4            NO_CURRENT_VAL = '0'B;

  17131  4 004003   200070 450100                    STZ     NO_CURRENT_VAL,,AUTO

     1382    17132
     1383    17133    5            DO CASE (PARMTYPE);

  17133  4 004004   000004 116007                    CMPQ    4,DL
         4 004005   004007 602006 4                  TNC     s:17133+3,QL
         4 004006   005124 710000 4                  TRA     s:17303
         4 004007   005124 710000 4                  TRA     s:17303
         4 004010   004013 710000 4                  TRA     s:17136
         4 004011   004105 710000 4                  TRA     s:17151
         4 004012   004174 710000 4                  TRA     s:17167

     1384    17134
     1385    17135    5              CASE(%KS_BOOT_PARAM);

     1386    17136    5                 IF KS_SELPRMOPT = %KS_FILE THEN

  17136  4 004013   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 004014   777000 376003                    ANQ     -512,DU
         4 004015   003000 116003                    CMPQ    1536,DU
         4 004016   004022 601000 4                  TNZ     s:17140

     1387    17137    5                    NO_CURRENT_VAL = '1'B;

  17137  4 004017   400000 236003                    LDQ     -131072,DU
         4 004020   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO
         4 004021   004057 710000 4                  TRA     s:17146

     1388    17138    5                 ELSE
     1389    17139    6                    DO;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:205  

     1390    17140    6                      CALL KSU$BLD_KL_CONTROL(KS_CONTROL,'BABOON',%KL_CONTROL_DISPLAY,
             17140                                %GI_CNTL_DISPHI + 1 + PARMX,0);

  17140  4 004022   200101 235100                    LDA     PARMX,,AUTO
         4 004023   000036 035007                    ADLA    30,DL
         4 004024   200376 755100                    STA     MAX+1,,AUTO
         4 004025   000132 236000 5                  LDQ     90
         4 004026   200403 756100                    STQ     MAX+6,,AUTO
         4 004027   200376 631500                    EPPR1   MAX+1,,AUTO
         4 004030   200402 451500                    STP1    MAX+5,,AUTO
         4 004031   000260 237000 5                  LDAQ    176
         4 004032   200400 757100                    STAQ    MAX+3,,AUTO
         4 004033   000262 236000 5                  LDQ     178
         4 004034   200377 756100                    STQ     MAX+2,,AUTO
         4 004035   200377 630500                    EPPR0   MAX+2,,AUTO
         4 004036   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 004037   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 004040   000000 011000                    NOP     0

     1391    17141    6                       CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL));

  17141  4 004041   000266 630400 5                  EPPR0   182
         4 004042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004043   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 004044   000000 011000                    NOP     0

     1392    17142    6                       CALL KSR$RD_HLPCG ('0');

  17142  4 004045   000270 630400 5                  EPPR0   184
         4 004046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004047   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 004050   000000 011000                    NOP     0

     1393    17143    6      BOOTP_RDCG_ERR:      IF CONTROL.TYPE = 0 THEN

  17143  4 004051   000000 470400 xsym  BOOTP_RDCG_* LDP0    KS_MSGBUF$
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:206  
         4 004052   000000 236100                    LDQ     0,,PR0
         4 004053   000777 316003                    CANQ    511,DU
         4 004054   004057 601000 4                  TNZ     s:17146

     1394    17144    6                          NO_CURRENT_VAL = '1'B;

  17144  4 004055   400000 236003                    LDQ     -131072,DU
         4 004056   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO

     1395    17145    6                    END;

     1396    17146    5                  KS_FEPBOOT_KEY.NODE = KS_NODE;

  17146  4 004057   000000 236000 xsym               LDQ     KS_NODE
         4 004060   000011 736000                    QLS     9
         4 004061   001246 552010 2                  STBQ    KS_FEPBOOT_KEY,'10'O

     1397    17147    5                  CALL KSU$READ_NETCON(VECTOR(KS_FEPBOOT_KEY),VECTOR(KS_FEPBOOT));

  17147  4 004062   000271 630400 5                  EPPR0   185
         4 004063   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004064   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 004065   000000 011000                    NOP     0

     1398    17148    5                  CALL DISP_NONHAND_PARM (PARMTYPE,PARMX,CONTROL.VALUE,KS_FEPBOOT.
             17148                           BOOTPARAMS(PARMX),'0'B);

  17148  4 004066   000132 236000 5                  LDQ     90
         4 004067   200361 756100                    STQ     @NETCON_VAL+1,,AUTO
         4 004070   200101 720100                    LXL0    PARMX,,AUTO
         4 004071   001226 630410 2                  EPPR0   KS_FEPBOOT+10,X0
         4 004072   200360 450500                    STP0    @CURRENT_VAL+1,,AUTO
         4 004073   000000 236000 xsym               LDQ     KS_MSGBUF$
         4 004074   000012 036003                    ADLQ    10,DU
         4 004075   200357 756100                    STQ     @PARMX+1,,AUTO
         4 004076   200101 631500                    EPPR1   PARMX,,AUTO
         4 004077   200356 451500                    STP1    @PARMTYPE+1,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:207  
         4 004100   200102 633500                    EPPR3   PARMTYPE,,AUTO
         4 004101   200355 453500                    STP3    SUBLK_INDX+2,,AUTO
         4 004102   007514 701000 4                  TSX1    DISP_NONHAND_PARM
         4 004103   000000 011000                    NOP     0
         4 004104   005124 710000 4                  TRA     s:17303

     1399    17149
     1400    17150    5               CASE (%KS_LCP6_PARAM);

     1401    17151    5                 IF KS_SELPRMOPT = %KS_FILE THEN

  17151  4 004105   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 004106   777000 376003                    ANQ     -512,DU
         4 004107   003000 116003                    CMPQ    1536,DU
         4 004110   004114 601000 4                  TNZ     s:17155

     1402    17152    5                    NO_CURRENT_VAL = '1'B;

  17152  4 004111   400000 236003                    LDQ     -131072,DU
         4 004112   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO
         4 004113   004146 710000 4                  TRA     s:17161

     1403    17153    5                 ELSE
     1404    17154    6                    DO;

     1405    17155    6                      CALL KSU$BLD_KL_CONTROL(KS_CONTROL,'BABOON',%KL_CONTROL_DISPLAY,
             17155                                PARMX,0);

  17155  4 004114   000132 236000 5                  LDQ     90
         4 004115   200402 756100                    STQ     MAX+5,,AUTO
         4 004116   200101 631500                    EPPR1   PARMX,,AUTO
         4 004117   200401 451500                    STP1    MAX+4,,AUTO
         4 004120   000261 236000 5                  LDQ     177
         4 004121   200400 756100                    STQ     MAX+3,,AUTO
         4 004122   000262 237000 5                  LDAQ    178
         4 004123   200376 757100                    STAQ    MAX+1,,AUTO
         4 004124   200376 630500                    EPPR0   MAX+1,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:208  
         4 004125   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 004126   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 004127   000000 011000                    NOP     0

     1406    17156    6                       CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET(LCP6_RDCG_ERR);

  17156  4 004130   000266 630400 5                  EPPR0   182
         4 004131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004132   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 004133   004140 702000 4                  TSX2    LCP6_RDCG_ERR

     1407    17157    6                       CALL KSR$RD_HLPCG ('0') ALTRET (LCP6_RDCG_ERR);

  17157  4 004134   000270 630400 5                  EPPR0   184
         4 004135   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004136   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 004137   004140 702000 4                  TSX2    LCP6_RDCG_ERR

     1408    17158    6   LCP6_RDCG_ERR:      IF CONTROL.TYPE = 0 THEN

  17158  4 004140   000000 470400 xsym  LCP6_RDCG_E* LDP0    KS_MSGBUF$
         4 004141   000000 236100                    LDQ     0,,PR0
         4 004142   000777 316003                    CANQ    511,DU
         4 004143   004146 601000 4                  TNZ     s:17161

     1409    17159    6                          NO_CURRENT_VAL = '1'B;

  17159  4 004144   400000 236003                    LDQ     -131072,DU
         4 004145   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO

     1410    17160    6                    END;

     1411    17161    5                  KS_FEPCTL_KEY.NODE = KS_NODE;

  17161  4 004146   000000 236000 xsym               LDQ     KS_NODE
         4 004147   000011 736000                    QLS     9
         4 004150   001306 552010 2                  STBQ    KS_FEPCTL_KEY,'10'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:209  

     1412    17162    5                 CALL KSU$READ_NETCON(VECTOR(KS_FEPCTL_KEY),VECTOR(KS_FEPCTL)) ALTRET(
             17162                           LCP6_RDNETCON_ERR);

  17162  4 004151   000300 630400 5                  EPPR0   192
         4 004152   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004153   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 004154   004155 702000 4                  TSX2    LCP6_RDNETCON_ERR

     1413    17163    5   LCP6_RDNETCON_ERR:
     1414    17164    5                 CALL DISP_NONHAND_PARM (PARMTYPE,PARMX,CONTROL.VALUE,KS_FEPCTL.PARAMS
             17164                           (PARMX),NO_CURRENT_VAL);

  17164  4 004155   200070 630500       LCP6_RDNETC* EPPR0   NO_CURRENT_VAL,,AUTO
         4 004156   200361 450500                    STP0    @NETCON_VAL+1,,AUTO
         4 004157   200101 720100                    LXL0    PARMX,,AUTO
         4 004160   001250 631410 2                  EPPR1   KS_FEPCTL+1,X0
         4 004161   200360 451500                    STP1    @CURRENT_VAL+1,,AUTO
         4 004162   000000 236000 xsym               LDQ     KS_MSGBUF$
         4 004163   000012 036003                    ADLQ    10,DU
         4 004164   200357 756100                    STQ     @PARMX+1,,AUTO
         4 004165   200101 633500                    EPPR3   PARMX,,AUTO
         4 004166   200356 453500                    STP3    @PARMTYPE+1,,AUTO
         4 004167   200102 634500                    EPPR4   PARMTYPE,,AUTO
         4 004170   200355 454500                    STP4    SUBLK_INDX+2,,AUTO
         4 004171   007514 701000 4                  TSX1    DISP_NONHAND_PARM
         4 004172   000000 011000                    NOP     0
         4 004173   005124 710000 4                  TRA     s:17303

     1415    17165
     1416    17166    5               CASE (%KS_HNDLR_PARAM);

     1417    17167    5                  IF KS_HNDLRNAME = ' ' THEN

  17167  4 004174   040000 106400                    CMPC    fill='040'O
         4 004175   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 004176   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:210  
         4 004177   004205 601000 4                  TNZ     s:17174

     1418    17168    6                     DO;

     1419    17169    6                        CALL KSE$ERRMSG (%E$KS_NOHANDLER);

  17169  4 004200   000303 630400 5                  EPPR0   195
         4 004201   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004202   000000 701000 xent               TSX1    KSE$ERRMSG
         4 004203   000000 011000                    NOP     0

     1420    17170                             /*E* ERROR:  KSN-E$KS_NOHANDLER-0
     1421    17171             MESSAGE:A handler must be selected in order to display a handler parameter. */
     1422    17172    6                        GOTO END_LOOP;

  17172  4 004204   005146 710000 4                  TRA     END_LOOP

     1423    17173    6                     END;
     1424    17174    5                  IF NOT(ADDR(KS_TBL(PARMTYPE)->KS$PARAM.HND(PARMX))->HND.DAT(
             17174                           KS_HNDLRINDX)) THEN

  17174  4 004205   000000 236000 xsym               LDQ     KS_HNDLRINDX
         4 004206   000033 772000                    QRL     27
         4 004207   200376 756100                    STQ     MAX+1,,AUTO
         4 004210   200101 236100                    LDQ     PARMX,,AUTO
         4 004211   000220 402007                    MPY     144,DL
         4 004212   200376 036100                    ADLQ    MAX+1,,AUTO
         4 004213   000000 066506                    CMPB    filb='0'B
         4 004214   000001 400001                    BDSC    1,Q,PR0                  by=2,bit=0,n=1
         4 004215   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 004216   004251 601000 4                  TNZ     s:17187

     1425    17175    6                     DO;

     1426    17176    6                        IF ONE_PARM_ONLY THEN

  17176  4 004217   200072 234100                    SZN     ONE_PARM_ONLY,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:211  
         4 004220   004250 605000 4                  TPL     s:17184

     1427    17177    7                           DO;

     1428    17178    7                             KS_SUB_BUF_1.COUNT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(
             17178                                       PARMX)->NAME.L#;

  17178  4 004221   200101 235100                    LDA     PARMX,,AUTO
         4 004222   000002 735000                    ALS     2
         4 004223   000000 471505                    LDP1    0,AL,PR0
         4 004224   000000 100500                    MLR     fill='000'O
         4 004225   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 004226   000000 000001 xsym               ADSC9   KS_SUB_BUF_1             cn=0,n=1

     1429    17179    7                              KS_SUB_BUF_1.TEXT = KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(
             17179                                       PARMX)->NAME.NAME#;

  17179  4 004227   000000 471505                    LDP1    0,AL,PR0
         4 004230   000100 101500                    MRL     fill='000'O
         4 004231   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         4 004232   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 004233   200376 221100                    LDX1    MAX+1,,AUTO
         4 004234   040000 100540                    MLR     fill='040'O
         4 004235   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
         4 004236   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1430    17180    7                              KS_SUB_BUF_2.COUNT = SIZEC(KS_HNDLRNAME);

  17180  4 004237   010000 236003                    LDQ     4096,DU
         4 004240   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     1431    17181    7                              KS_SUB_BUF_2.TEXT = KS_HNDLRNAME;

  17181  4 004241   040000 100400                    MLR     fill='040'O
         4 004242   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 004243   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:212  
     1432    17182    7                             CALL KSE$ERRMSG(%E$KS_ILGSET,VECTOR(KS_SUB_BUF_1),VECTOR(
             17182                                       KS_SUB_BUF_2));

  17182  4 004244   000307 630400 5                  EPPR0   199
         4 004245   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 004246   000000 701000 xent               TSX1    KSE$ERRMSG
         4 004247   000000 011000                    NOP     0

     1433    17183    7                           END;

     1434    17184    6                        GOTO PARM_LOOP_END;

  17184  4 004250   005126 710000 4                  TRA     PARM_LOOP_END

     1435    17185    6                     END;
     1436    17186
     1437    17187    5                  IF NOT KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.INDX(PARMX) THEN

  17187  4 004251   200101 235100                    LDA     PARMX,,AUTO
         4 004252   000002 735000                    ALS     2
         4 004253   000001 234105                    SZN     1,AL,PR0
         4 004254   004376 604000 4                  TMI     s:17217

     1438    17188    6                     DO;

     1439    17189    6                        IF KS_SELPRMOPT = %KS_FILE THEN

  17189  4 004255   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 004256   777000 376003                    ANQ     -512,DU
         4 004257   003000 116003                    CMPQ    1536,DU
         4 004260   004264 601000 4                  TNZ     s:17193

     1440    17190    6                           NO_CURRENT_VAL = '1'B;

  17190  4 004261   400000 236003                    LDQ     -131072,DU
         4 004262   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO
         4 004263   004316 710000 4                  TRA     s:17200
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:213  

     1441    17191    6                        ELSE
     1442    17192    7                           DO;

     1443    17193    7                              CALL KSU$BLD_KL_CONTROL(KS_CONTROL,KS_HNDLRNAME,%
             17193                                       KL_CONTROL_DISPLAY,PARMX,0);

  17193  4 004264   000132 236000 5                  LDQ     90
         4 004265   200402 756100                    STQ     MAX+5,,AUTO
         4 004266   200101 631500                    EPPR1   PARMX,,AUTO
         4 004267   200401 451500                    STP1    MAX+4,,AUTO
         4 004270   000261 236000 5                  LDQ     177
         4 004271   200400 756100                    STQ     MAX+3,,AUTO
         4 004272   000312 237000 5                  LDAQ    202
         4 004273   200376 757100                    STAQ    MAX+1,,AUTO
         4 004274   200376 630500                    EPPR0   MAX+1,,AUTO
         4 004275   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 004276   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 004277   000000 011000                    NOP     0

     1444    17194    7                              CALL KSR$WR_HLPCG(VECTOR(KS_CONTROL)) ALTRET(
             17194                                       HAND_RDCG_ERR);

  17194  4 004300   000266 630400 5                  EPPR0   182
         4 004301   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004302   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 004303   004310 702000 4                  TSX2    HAND_RDCG_ERR

     1445    17195    7                              CALL KSR$RD_HLPCG('0') ALTRET (HAND_RDCG_ERR);

  17195  4 004304   000270 630400 5                  EPPR0   184
         4 004305   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004306   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 004307   004310 702000 4                  TSX2    HAND_RDCG_ERR

     1446    17196    7   HAND_RDCG_ERR:             IF CONTROL.TYPE = 0 THEN

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:214  
  17196  4 004310   000000 470400 xsym  HAND_RDCG_E* LDP0    KS_MSGBUF$
         4 004311   000000 236100                    LDQ     0,,PR0
         4 004312   000777 316003                    CANQ    511,DU
         4 004313   004316 601000 4                  TNZ     s:17200

     1447    17197    7                                 NO_CURRENT_VAL = '1'B;

  17197  4 004314   400000 236003                    LDQ     -131072,DU
         4 004315   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO

     1448    17198    7                           END;

     1449    17199
     1450    17200    6                        KS_HANDLER_KEY.NODE = KS_NODE;

  17200  4 004316   000000 236000 xsym               LDQ     KS_NODE
         4 004317   000011 736000                    QLS     9
         4 004320   001211 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1451    17201    6                        KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;

  17201  4 004321   040000 100400                    MLR     fill='040'O
         4 004322   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 004323   001211 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1452    17202    6                        CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF))
             17202                                 WHENALTRETURN

  17202  4 004324   000314 630400 5                  EPPR0   204
         4 004325   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004326   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 004327   004331 702000 4                  TSX2    s:17204
         4 004330   004347 710000 4                  TRA     HAND_RDNETCON_ERR

     1453    17203    7                             DO;

     1454    17204    7                                KS_SUB_BUF_1.TEXT = KS_HNDLRNAME;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:215  

  17204  4 004331   040000 100400                    MLR     fill='040'O
         4 004332   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 004333   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     1455    17205    7                                KS_SUB_BUF_1.COUNT = SIZEC(KS_HNDLRNAME);

  17205  4 004334   010000 236003                    LDQ     4096,DU
         4 004335   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     1456    17206    7                                KS_SUB_BUF_2.TEXT = KS_NODENAME;

  17206  4 004336   040000 100400                    MLR     fill='040'O
         4 004337   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 004340   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

     1457    17207    7                                KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);

  17207  4 004341   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     1458    17208    7                               CALL KSE$ERRMSG(%E$KS_HAND_NOT_DEF,VECTOR(KS_SUB_BUF_1)
             17208                                         ,VECTOR(KS_SUB_BUF_2));

  17208  4 004342   000317 630400 5                  EPPR0   207
         4 004343   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 004344   000000 701000 xent               TSX1    KSE$ERRMSG
         4 004345   000000 011000                    NOP     0

     1459    17209                                     /*E* ERROR: KSN-E$KS_HAND_NOT_DEF-0
     1460    17210                                 MESSAGE: Handler %U1 has not been defined for node %U2. */
     1461    17211    7                                GOTO  END_LOOP;

  17211  4 004346   005146 710000 4                  TRA     END_LOOP

     1462    17212    7                             END;
     1463    17213    6   HAND_RDNETCON_ERR:   CALL DISPARM (KS_HNDLRINDX+3,PARMX,,CONTROL.VALUE,KS$HNDLR.
             17213            PARAMS(PARMX),NO_CURRENT_VAL);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:216  

  17213  4 004347   000000 236000 xsym  HAND_RDNETC* LDQ     KS_HNDLRINDX
         4 004350   000033 772000                    QRL     27
         4 004351   000003 036007                    ADLQ    3,DL
         4 004352   200460 756100                    STQ     MAX+51,,AUTO
         4 004353   200070 630500                    EPPR0   NO_CURRENT_VAL,,AUTO
         4 004354   200366 450500                    STP0    MAX+1,,AUTO
         4 004355   200101 236100                    LDQ     PARMX,,AUTO
         4 004356   000021 736000                    QLS     17
         4 004357   000015 036003                    ADLQ    13,DU
         4 004360   000315 036000 2                  ADLQ    HANDLER$
         4 004361   200365 756100                    STQ     MIN+1,,AUTO
         4 004362   000000 236000 xsym               LDQ     KS_MSGBUF$
         4 004363   000012 036003                    ADLQ    10,DU
         4 004364   200364 756100                    STQ     DEFAULT+1,,AUTO
         4 004365   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 004366   200363 756100                    STQ     CURRENT_DISP+1,,AUTO
         4 004367   200101 631500                    EPPR1   PARMX,,AUTO
         4 004370   200362 451500                    STP1    @NO_CURRENT_VAL+1,,AUTO
         4 004371   200460 633500                    EPPR3   MAX+51,,AUTO
         4 004372   200361 453500                    STP3    @NETCON_VAL+1,,AUTO
         4 004373   005412 701000 4                  TSX1    DISPARM
         4 004374   000000 011000                    NOP     0

     1464    17214    6                     END;

  17214  4 004375   005124 710000 4                  TRA     s:17303

     1465    17215    5                  ELSE
     1466    17216    6                     DO;

     1467    17217    6                        IF PARMX = %KL_HNDLRPARM_USRPARM1 OR

  17217  4 004376   200101 236100                    LDQ     PARMX,,AUTO
         4 004377   000037 116007                    CMPQ    31,DL
         4 004400   004403 600000 4                  TZE     s:17220
         4 004401   000040 116007                    CMPQ    32,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:217  
         4 004402   004631 601000 4                  TNZ     s:17258

     1468    17218    6                        PARMX = %KL_HNDLRPARM_USRPARM2 THEN
     1469    17219    7                           DO;

     1470    17220    7                              IF ONE_PARM_ONLY THEN

  17220  4 004403   200072 234100                    SZN     ONE_PARM_ONLY,,AUTO
         4 004404   004425 605000 4                  TPL     s:17228

     1471    17221    8                                 DO;

     1472    17222    8                                   PTR$ = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
             17222                                             OUT$BLK.SUBLK$(0);

  17222  4 004405   200173 471500                    LDP1    BLK$,,AUTO
         4 004406   100003 473500                    LDP3    3,,PR1
         4 004407   300003 474500                    LDP4    3,,PR3
         4 004410   400003 236100                    LDQ     3,,PR4
         4 004411   200175 756100                    STQ     PTR$,,AUTO

     1473    17223    8                                    INDX = PTR$->OUT$BLK.CODE;

  17223  4 004412   200175 475500                    LDP5    PTR$,,AUTO
         4 004413   500000 236100                    LDQ     0,,PR5
         4 004414   777777 376007                    ANQ     -1,DL
         4 004415   200103 756100                    STQ     INDX,,AUTO

     1474    17224    8                                    CALL DISPLAY_INDEXED_PARM(PARMX,INDX);

  17224  4 004416   200103 633500                    EPPR3   INDX,,AUTO
         4 004417   200356 453500                    STP3    @PARMTYPE+1,,AUTO
         4 004420   200101 634500                    EPPR4   PARMX,,AUTO
         4 004421   200355 454500                    STP4    SUBLK_INDX+2,,AUTO
         4 004422   005274 701000 4                  TSX1    DISPLAY_INDEXED_PARM
         4 004423   000000 011000                    NOP     0

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:218  
     1475    17225    8                                 END;

  17225  4 004424   005124 710000 4                  TRA     s:17303

     1476    17226    7                              ELSE
     1477    17227    8       DO;

     1478    17228    8           CALL KSW$WRITE(VECTOR(USRPARM_HDR_FMT),

  17228  4 004425   000000 236000 xsym               LDQ     KS_HNDLRINDX
         4 004426   000033 772000                    QRL     27
         4 004427   000003 471406 xsym               LDP1    KS_TBL+3,QL
         4 004430   100000 473505                    LDP3    0,AL,PR1
         4 004431   000100 101500                    MRL     fill='000'O
         4 004432   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         4 004433   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 004434   200376 221100                    LDX1    MAX+1,,AUTO
         4 004435   000001 622011                    EAX2    1,X1
         4 004436   000000 635012                    EAA     0,X2
         4 004437   000002 771000                    ARL     2
         4 004440   000140 135007                    SBLA    96,DL
         4 004441   200377 453500                    STP3    MAX+2,,AUTO
         4 004442   200377 236100                    LDQ     MAX+2,,AUTO
         4 004443   200400 757100                    STAQ    MAX+3,,AUTO
         4 004444   200400 631500                    EPPR1   MAX+3,,AUTO
         4 004445   200403 451500                    STP1    MAX+6,,AUTO
         4 004446   000324 236000 5                  LDQ     212
         4 004447   200402 756100                    STQ     MAX+5,,AUTO
         4 004450   200402 630500                    EPPR0   MAX+5,,AUTO
         4 004451   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004452   000000 701000 xent               TSX1    KSW$WRITE
         4 004453   000000 011000                    NOP     0

     1479    17229    8                        VECTOR(KS_TBL(KS_HNDLRINDX+3)->KS$PARAM.TEXTNAME(PARMX)->NAME)
             17229                                  );
     1480    17230    8           IF KS_SELPRMOPT ~= %KS_FILE THEN

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:219  
  17230  4 004454   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 004455   777000 376003                    ANQ     -512,DU
         4 004456   003000 116003                    CMPQ    1536,DU
         4 004457   004575 600000 4                  TZE     DI_USRPARM_FROM_NETCON

     1481    17231    9             DO;

     1482    17232    9                CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY,
             17232                         PARMX,0);

  17232  4 004460   000132 236000 5                  LDQ     90
         4 004461   200402 756100                    STQ     MAX+5,,AUTO
         4 004462   200101 630500                    EPPR0   PARMX,,AUTO
         4 004463   200401 450500                    STP0    MAX+4,,AUTO
         4 004464   000261 236000 5                  LDQ     177
         4 004465   200400 756100                    STQ     MAX+3,,AUTO
         4 004466   000312 237000 5                  LDAQ    202
         4 004467   200376 757100                    STAQ    MAX+1,,AUTO
         4 004470   200376 630500                    EPPR0   MAX+1,,AUTO
         4 004471   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 004472   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 004473   000000 011000                    NOP     0

     1483    17233    9               CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (DI_USRPARM_FROM_NETCON);

  17233  4 004474   000266 630400 5                  EPPR0   182
         4 004475   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004476   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 004477   004575 702000 4                  TSX2    DI_USRPARM_FROM_NETCON

     1484    17234    9                CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_USRPARM_FROM_NETCON);

  17234  4 004500   000132 630400 5                  EPPR0   90
         4 004501   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004502   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 004503   004575 702000 4                  TSX2    DI_USRPARM_FROM_NETCON

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:220  
     1485    17235    9                 IF CONTROL.TYPE = 0 THEN

  17235  4 004504   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 004505   000000 236100                    LDQ     0,,PR0
         4 004506   000777 316003                    CANQ    511,DU
         4 004507   004575 600000 4                  TZE     DI_USRPARM_FROM_NETCON

     1486    17236    9                   GOTO DI_USRPARM_FROM_NETCON;
     1487    17237
     1488    17238    9                CALL KSW$WRITE(VECTOR(CURRENT_FMT));

  17238  4 004510   000330 630400 5                  EPPR0   216
         4 004511   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004512   000000 701000 xent               TSX1    KSW$WRITE
         4 004513   000000 011000                    NOP     0

     1489    17239   10                DO INDX = %KS_USRPRM1 TO %KS_USRPRM8;

  17239  4 004514   200103 450100                    STZ     INDX,,AUTO

     1490    17240   10                  CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY
             17240                            ,PARMX,INDX);

  17240  4 004515   200103 630500                    EPPR0   INDX,,AUTO
         4 004516   200402 450500                    STP0    MAX+5,,AUTO
         4 004517   200101 631500                    EPPR1   PARMX,,AUTO
         4 004520   200401 451500                    STP1    MAX+4,,AUTO
         4 004521   000261 236000 5                  LDQ     177
         4 004522   200400 756100                    STQ     MAX+3,,AUTO
         4 004523   000312 237000 5                  LDAQ    202
         4 004524   200376 757100                    STAQ    MAX+1,,AUTO
         4 004525   200376 630500                    EPPR0   MAX+1,,AUTO
         4 004526   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 004527   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 004530   000000 011000                    NOP     0

     1491    17241   10                   CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:221  
             17241                            DI_USRPARM_FROM_NETCON);

  17241  4 004531   000266 630400 5                  EPPR0   182
         4 004532   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004533   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 004534   004575 702000 4                  TSX2    DI_USRPARM_FROM_NETCON

     1492    17242   10                   CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_USRPARM_FROM_NETCON);

  17242  4 004535   000132 630400 5                  EPPR0   90
         4 004536   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004537   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 004540   004575 702000 4                  TSX2    DI_USRPARM_FROM_NETCON

     1493    17243   10                  CALL KSW$WRITE(VECTOR(USRPARM_ENTRY_FMT),VECTOR(INDX),VECTOR(CONTROL
             17243                            .VALUE));

  17243  4 004541   777640 235007                    LDA     -96,DL
         4 004542   200376 452500                    STP2    MAX+1,,AUTO
         4 004543   200376 236100                    LDQ     MAX+1,,AUTO
         4 004544   000103 036003                    ADLQ    67,DU
         4 004545   200400 757100                    STAQ    MAX+3,,AUTO
         4 004546   377640 235007                    LDA     130976,DL
         4 004547   000000 236000 xsym               LDQ     KS_MSGBUF$
         4 004550   000012 036003                    ADLQ    10,DU
         4 004551   200404 757100                    STAQ    MAX+7,,AUTO
         4 004552   200400 237100                    LDAQ    MAX+3,,AUTO
         4 004553   200402 757100                    STAQ    MAX+5,,AUTO
         4 004554   200404 237100                    LDAQ    MAX+7,,AUTO
         4 004555   200406 757100                    STAQ    MAX+9,,AUTO
         4 004556   200406 630500                    EPPR0   MAX+9,,AUTO
         4 004557   200412 450500                    STP0    MAX+13,,AUTO
         4 004560   200402 631500                    EPPR1   MAX+5,,AUTO
         4 004561   200411 451500                    STP1    MAX+12,,AUTO
         4 004562   000334 236000 5                  LDQ     220
         4 004563   200410 756100                    STQ     MAX+11,,AUTO
         4 004564   200410 630500                    EPPR0   MAX+11,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:222  
         4 004565   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 004566   000000 701000 xent               TSX1    KSW$WRITE
         4 004567   000000 011000                    NOP     0

     1494    17244   10                END;

  17244  4 004570   200103 235100                    LDA     INDX,,AUTO
         4 004571   000001 035007                    ADLA    1,DL
         4 004572   200103 755100                    STA     INDX,,AUTO
         4 004573   000010 115007                    CMPA    8,DL
         4 004574   004515 602000 4                  TNC     s:17240

     1495    17245    9             END;

     1496    17246
     1497    17247    8   DI_USRPARM_FROM_NETCON:
     1498    17248    8                KS_HANDLER_KEY.NODE = KS_NODE;

  17248  4 004575   000000 236000 xsym  DI_USRPARM_* LDQ     KS_NODE
         4 004576   000011 736000                    QLS     9
         4 004577   001211 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1499    17249    8                KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;

  17249  4 004600   040000 100400                    MLR     fill='040'O
         4 004601   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 004602   001211 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1500    17250    8                CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF)) ALTRET(
             17250                         DISP_ERR);

  17250  4 004603   000314 630400 5                  EPPR0   204
         4 004604   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 004605   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 004606   005135 702000 4                  TSX2    DISP_ERR

     1501    17251    8                IPARAM$ = PINCRW(ADDR(CHAR_BUF),PARMX-%KL_HNDLRPARM_BLOCK);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:223  

  17251  4 004607   200101 720100                    LXL0    PARMX,,AUTO
         4 004610   000113 630410 2                  EPPR0   DEF_BUFFER+21,X0
         4 004611   200071 450500                    STP0    IPARAM$,,AUTO

     1502    17252
     1503    17253    8                CALL KSW$WRITE(VECTOR(USRPARM_NETCON_FMT),VECTOR(IPARAM$->KS$HNDLR.
             17253                         IPARAM.OFFSET(0)),VECTOR(CHAR_BUF));

  17253  4 004612   377640 235007                    LDA     130976,DL
         4 004613   200071 236100                    LDQ     IPARAM$,,AUTO
         4 004614   000034 036003                    ADLQ    28,DU
         4 004615   200376 757100                    STAQ    MAX+1,,AUTO
         4 004616   000315 236000 5                  LDQ     205
         4 004617   200402 756100                    STQ     MAX+5,,AUTO
         4 004620   200376 631500                    EPPR1   MAX+1,,AUTO
         4 004621   200401 451500                    STP1    MAX+4,,AUTO
         4 004622   000340 236000 5                  LDQ     224
         4 004623   200400 756100                    STQ     MAX+3,,AUTO
         4 004624   200400 630500                    EPPR0   MAX+3,,AUTO
         4 004625   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 004626   000000 701000 xent               TSX1    KSW$WRITE
         4 004627   000000 011000                    NOP     0

     1504    17254    8       END;

     1505    17255    7                           END;

  17255  4 004630   005124 710000 4                  TRA     s:17303

     1506    17256    6                        ELSE
     1507    17257    7                           DO;

     1508    17258    7   IF ONE_PARM_ONLY AND BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->

  17258  4 004631   200072 234100                    SZN     ONE_PARM_ONLY,,AUTO
         4 004632   004674 605000 4                  TPL     s:17269
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:224  
         4 004633   200173 471500                    LDP1    BLK$,,AUTO
         4 004634   100003 473500                    LDP3    3,,PR1
         4 004635   300003 474500                    LDP4    3,,PR3
         4 004636   400003 475500                    LDP5    3,,PR4
         4 004637   500000 721100                    LXL1    0,,PR5
         4 004640   000001 101003                    CMPX1   1,DU
         4 004641   004674 601000 4                  TNZ     s:17269

     1509    17259    7      OUT$BLK.SUBLK$(0)->OUT$BLK.CODE = %KS_SPEED_LIST THEN
     1510    17260    8       DO;

     1511    17261    8          PTR$ = BLK$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0);

  17261  4 004642   400003 236100                    LDQ     3,,PR4
         4 004643   200175 756100                    STQ     PTR$,,AUTO

     1512    17262    9          DO J = 0 TO PTR$->OUT$BLK.NSUBLKS - 1;

  17262  4 004644   200077 450100                    STZ     J,,AUTO
         4 004645   004665 710000 4                  TRA     s:17265+3

     1513    17263    9             INDX = PTR$->OUT$BLK.SUBLK$(J)->OUT$BLK.CODE;

  17263  4 004646   200175 470500                    LDP0    PTR$,,AUTO
         4 004647   200077 720100                    LXL0    J,,AUTO
         4 004650   000003 471510                    LDP1    3,X0,PR0
         4 004651   100000 236100                    LDQ     0,,PR1
         4 004652   777777 376007                    ANQ     -1,DL
         4 004653   200103 756100                    STQ     INDX,,AUTO

     1514    17264    9             CALL DISPLAY_INDEXED_PARM (PARMX,INDX);

  17264  4 004654   200103 631500                    EPPR1   INDX,,AUTO
         4 004655   200356 451500                    STP1    @PARMTYPE+1,,AUTO
         4 004656   200101 633500                    EPPR3   PARMX,,AUTO
         4 004657   200355 453500                    STP3    SUBLK_INDX+2,,AUTO
         4 004660   005274 701000 4                  TSX1    DISPLAY_INDEXED_PARM
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:225  
         4 004661   000000 011000                    NOP     0

     1515    17265    9          END;

  17265  4 004662   200077 235100                    LDA     J,,AUTO
         4 004663   000001 035007                    ADLA    1,DL
         4 004664   200077 755100                    STA     J,,AUTO
         4 004665   200175 470500                    LDP0    PTR$,,AUTO
         4 004666   000001 236100                    LDQ     1,,PR0
         4 004667   000022 772000                    QRL     18
         4 004670   200077 116100                    CMPQ    J,,AUTO
         4 004671   004673 600000 4                  TZE     s:17266
         4 004672   004646 603000 4                  TRC     s:17263

     1516    17266    8       END;

  17266  4 004673   005124 710000 4                  TRA     s:17303

     1517    17267    7   ELSE
     1518    17268    8       DO;

     1519    17269    8           CALL KSW$WRITE(VECTOR(BLOCK_HDR_FMT),

  17269  4 004674   000000 236000 xsym               LDQ     KS_HNDLRINDX
         4 004675   000033 772000                    QRL     27
         4 004676   000003 471406 xsym               LDP1    KS_TBL+3,QL
         4 004677   100000 473505                    LDP3    0,AL,PR1
         4 004700   000100 101500                    MRL     fill='000'O
         4 004701   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         4 004702   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 004703   200376 221100                    LDX1    MAX+1,,AUTO
         4 004704   000001 622011                    EAX2    1,X1
         4 004705   000000 635012                    EAA     0,X2
         4 004706   000002 771000                    ARL     2
         4 004707   000140 135007                    SBLA    96,DL
         4 004710   200377 453500                    STP3    MAX+2,,AUTO
         4 004711   200377 236100                    LDQ     MAX+2,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:226  
         4 004712   200400 757100                    STAQ    MAX+3,,AUTO
         4 004713   000200 236000 5                  LDQ     128
         4 004714   200404 756100                    STQ     MAX+7,,AUTO
         4 004715   200400 631500                    EPPR1   MAX+3,,AUTO
         4 004716   200403 451500                    STP1    MAX+6,,AUTO
         4 004717   000344 236000 5                  LDQ     228
         4 004720   200402 756100                    STQ     MAX+5,,AUTO
         4 004721   200402 630500                    EPPR0   MAX+5,,AUTO
         4 004722   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 004723   000000 701000 xent               TSX1    KSW$WRITE
         4 004724   000000 011000                    NOP     0

     1520    17270    8                         VECTOR(KS_TBL(KS_HNDLRINDX+3)->KS$PARAM.TEXTNAME(PARMX)->NAME
             17270                                   ),
     1521    17271    8                         VECTOR(LINESPEED));
     1522    17272    8           IF KS_SELPRMOPT ~= %KS_FILE THEN

  17272  4 004725   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 004726   777000 376003                    ANQ     -512,DU
         4 004727   003000 116003                    CMPQ    1536,DU
         4 004730   005046 600000 4                  TZE     DI_FROM_NETCON

     1523    17273    9             DO;

     1524    17274    9                CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY,
             17274                         PARMX,0);

  17274  4 004731   000132 236000 5                  LDQ     90
         4 004732   200402 756100                    STQ     MAX+5,,AUTO
         4 004733   200101 630500                    EPPR0   PARMX,,AUTO
         4 004734   200401 450500                    STP0    MAX+4,,AUTO
         4 004735   000261 236000 5                  LDQ     177
         4 004736   200400 756100                    STQ     MAX+3,,AUTO
         4 004737   000312 237000 5                  LDAQ    202
         4 004740   200376 757100                    STAQ    MAX+1,,AUTO
         4 004741   200376 630500                    EPPR0   MAX+1,,AUTO
         4 004742   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:227  
         4 004743   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 004744   000000 011000                    NOP     0

     1525    17275    9                CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (DI_FROM_NETCON);

  17275  4 004745   000266 630400 5                  EPPR0   182
         4 004746   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004747   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 004750   005046 702000 4                  TSX2    DI_FROM_NETCON

     1526    17276    9                CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_FROM_NETCON);

  17276  4 004751   000132 630400 5                  EPPR0   90
         4 004752   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004753   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 004754   005046 702000 4                  TSX2    DI_FROM_NETCON

     1527    17277    9                 IF CONTROL.TYPE = 0 THEN

  17277  4 004755   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 004756   000000 236100                    LDQ     0,,PR0
         4 004757   000777 316003                    CANQ    511,DU
         4 004760   005046 600000 4                  TZE     DI_FROM_NETCON

     1528    17278    9                   GOTO DI_FROM_NETCON;
     1529    17279
     1530    17280    9                CALL KSW$WRITE(VECTOR(CURRENT_FMT));

  17280  4 004761   000330 630400 5                  EPPR0   216
         4 004762   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 004763   000000 701000 xent               TSX1    KSW$WRITE
         4 004764   000000 011000                    NOP     0

     1531    17281   10                DO INDX = %KS_SPEED_50 TO %KS_SPEED_19200;

  17281  4 004765   200103 450100                    STZ     INDX,,AUTO

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:228  
     1532    17282   10                  CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY
             17282                            ,PARMX,INDX);

  17282  4 004766   200103 630500                    EPPR0   INDX,,AUTO
         4 004767   200402 450500                    STP0    MAX+5,,AUTO
         4 004770   200101 631500                    EPPR1   PARMX,,AUTO
         4 004771   200401 451500                    STP1    MAX+4,,AUTO
         4 004772   000261 236000 5                  LDQ     177
         4 004773   200400 756100                    STQ     MAX+3,,AUTO
         4 004774   000312 237000 5                  LDAQ    202
         4 004775   200376 757100                    STAQ    MAX+1,,AUTO
         4 004776   200376 630500                    EPPR0   MAX+1,,AUTO
         4 004777   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 005000   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 005001   000000 011000                    NOP     0

     1533    17283   10                   CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (DI_FROM_NETCON);

  17283  4 005002   000266 630400 5                  EPPR0   182
         4 005003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005004   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 005005   005046 702000 4                  TSX2    DI_FROM_NETCON

     1534    17284   10                   CALL KSR$RD_HLPCG ('0'B) ALTRET(DI_FROM_NETCON);

  17284  4 005006   000132 630400 5                  EPPR0   90
         4 005007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005010   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 005011   005046 702000 4                  TSX2    DI_FROM_NETCON

     1535    17285   10                   CALL KSW$WRITE(VECTOR(BLOCK_ENTRY_FMT),VECTOR(INDX),VECTOR(CONTROL.
             17285                            VALUE));

  17285  4 005012   777640 235007                    LDA     -96,DL
         4 005013   200376 452500                    STP2    MAX+1,,AUTO
         4 005014   200376 236100                    LDQ     MAX+1,,AUTO
         4 005015   000103 036003                    ADLQ    67,DU
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:229  
         4 005016   200400 757100                    STAQ    MAX+3,,AUTO
         4 005017   377640 235007                    LDA     130976,DL
         4 005020   000000 236000 xsym               LDQ     KS_MSGBUF$
         4 005021   000012 036003                    ADLQ    10,DU
         4 005022   200404 757100                    STAQ    MAX+7,,AUTO
         4 005023   200400 237100                    LDAQ    MAX+3,,AUTO
         4 005024   200402 757100                    STAQ    MAX+5,,AUTO
         4 005025   200404 237100                    LDAQ    MAX+7,,AUTO
         4 005026   200406 757100                    STAQ    MAX+9,,AUTO
         4 005027   200406 630500                    EPPR0   MAX+9,,AUTO
         4 005030   200412 450500                    STP0    MAX+13,,AUTO
         4 005031   200402 631500                    EPPR1   MAX+5,,AUTO
         4 005032   200411 451500                    STP1    MAX+12,,AUTO
         4 005033   000350 236000 5                  LDQ     232
         4 005034   200410 756100                    STQ     MAX+11,,AUTO
         4 005035   200410 630500                    EPPR0   MAX+11,,AUTO
         4 005036   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 005037   000000 701000 xent               TSX1    KSW$WRITE
         4 005040   000000 011000                    NOP     0

     1536    17286   10                END;

  17286  4 005041   200103 235100                    LDA     INDX,,AUTO
         4 005042   000001 035007                    ADLA    1,DL
         4 005043   200103 755100                    STA     INDX,,AUTO
         4 005044   000020 115007                    CMPA    16,DL
         4 005045   004766 602000 4                  TNC     s:17282

     1537    17287    9             END;

     1538    17288
     1539    17289    8   DI_FROM_NETCON:
     1540    17290    8                KS_HANDLER_KEY.NODE = KS_NODE;

  17290  4 005046   000000 236000 xsym  DI_FROM_NET* LDQ     KS_NODE
         4 005047   000011 736000                    QLS     9
         4 005050   001211 552010 2                  STBQ    KS_HANDLER_KEY,'10'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:230  

     1541    17291    8                KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;

  17291  4 005051   040000 100400                    MLR     fill='040'O
         4 005052   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 005053   001211 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1542    17292    8                CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF)) ALTRET(
             17292                         DISP_ERR);

  17292  4 005054   000314 630400 5                  EPPR0   204
         4 005055   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005056   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 005057   005135 702000 4                  TSX2    DISP_ERR

     1543    17293    8                IPARAM$ = PINCRW(ADDR(CHAR_BUF),PARMX-%KL_HNDLRPARM_BLOCK);

  17293  4 005060   200101 720100                    LXL0    PARMX,,AUTO
         4 005061   000113 630410 2                  EPPR0   DEF_BUFFER+21,X0
         4 005062   200071 450500                    STP0    IPARAM$,,AUTO

     1544    17294
     1545    17295    8               CALL KSW$WRITE(VECTOR(BLOCK_NETCON_FMT),VECTOR(IPARAM$->KS$HNDLR.IPARAM
             17295                         .OFFSET(0)),VECTOR(CHAR_BUF));

  17295  4 005063   377640 235007                    LDA     130976,DL
         4 005064   200071 236100                    LDQ     IPARAM$,,AUTO
         4 005065   000034 036003                    ADLQ    28,DU
         4 005066   200376 757100                    STAQ    MAX+1,,AUTO
         4 005067   000315 236000 5                  LDQ     205
         4 005070   200402 756100                    STQ     MAX+5,,AUTO
         4 005071   200376 631500                    EPPR1   MAX+1,,AUTO
         4 005072   200401 451500                    STP1    MAX+4,,AUTO
         4 005073   000354 236000 5                  LDQ     236
         4 005074   200400 756100                    STQ     MAX+3,,AUTO
         4 005075   200400 630500                    EPPR0   MAX+3,,AUTO
         4 005076   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:231  
         4 005077   000000 701000 xent               TSX1    KSW$WRITE
         4 005100   000000 011000                    NOP     0

     1546    17296    8                VBASE(BLOCK_VEC) = KS_TBL(KS_HNDLRINDX+3)->KS$PARAM_SPCL.SPCL_TBL$(
             17296                         PARMX);

  17296  4 005101   000000 236000 xsym               LDQ     KS_HNDLRINDX
         4 005102   000033 772000                    QRL     27
         4 005103   000003 470406 xsym               LDP0    KS_TBL+3,QL
         4 005104   200101 235100                    LDA     PARMX,,AUTO
         4 005105   000002 735000                    ALS     2
         4 005106   000002 236105                    LDQ     2,AL,PR0
         4 005107   200211 756100                    STQ     BLOCK_VEC+1,,AUTO

     1547    17297    8                VBOUND(BLOCK_VEC) = 256;  /*Size of KS_BLOCK_TBL*/

  17297  4 005110   200210 236100                    LDQ     BLOCK_VEC,,AUTO
         4 005111   177777 376007                    ANQ     65535,DL
         4 005112   000100 276003                    ORQ     64,DU
         4 005113   200210 756100                    STQ     BLOCK_VEC,,AUTO

     1548    17298    8                CALL KSW$WRITE(VECTOR(BLOCK_DEFAULT_FMT),BLOCK_VEC);

  17298  4 005114   200210 630500                    EPPR0   BLOCK_VEC,,AUTO
         4 005115   200377 450500                    STP0    MAX+2,,AUTO
         4 005116   000360 236000 5                  LDQ     240
         4 005117   200376 756100                    STQ     MAX+1,,AUTO
         4 005120   200376 630500                    EPPR0   MAX+1,,AUTO
         4 005121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005122   000000 701000 xent               TSX1    KSW$WRITE
         4 005123   000000 011000                    NOP     0

     1549    17299    8       END;

     1550    17300    7                           END;

     1551    17301    6                     END;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:232  

     1552    17302    5            END;

     1553    17303    4         IF ONE_PARM_ONLY THEN

  17303  4 005124   200072 234100                    SZN     ONE_PARM_ONLY,,AUTO
         4 005125   005134 604000 4                  TMI     s:17309

     1554    17304    4            EXIT PARM_LOOP;
     1555    17305    4   PARM_LOOP_END:
     1556    17306    4         END;  /*PARM_LOOP*/

  17306  4 005126   200101 235100       PARM_LOOP_E* LDA     PARMX,,AUTO
         4 005127   000001 035007                    ADLA    1,DL
         4 005130   200101 755100                    STA     PARMX,,AUTO
         4 005131   200074 236100                    LDQ     MAX_PARM,,AUTO
         4 005132   200101 116100                    CMPQ    PARMX,,AUTO
         4 005133   003721 603000 4                  TRC     s:17111

     1557    17307
     1558    17308    3              END;  /* DO CASE(CODE) */

     1559    17309    3            DO WHILE ('0'B);

  17309  4 005134   005146 710000 4                  TRA     END_LOOP

     1560    17310    3   DISP_ERR:   CALL KSE$ERRMSG(0);

  17310  4 005135   000132 630400 5     DISP_ERR     EPPR0   90
         4 005136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005137   000000 701000 xent               TSX1    KSE$ERRMSG
         4 005140   000000 011000                    NOP     0

     1561    17311    3   ERR1:       CALL KSE$ERRMSG (%E$KS_CANTDIPARM,VECTOR(KS_SUB_BUF_1));

  17311  4 005141   000134 630400 5     ERR1         EPPR0   92
         4 005142   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:233  
         4 005143   000000 701000 xent               TSX1    KSE$ERRMSG
         4 005144   000000 011000                    NOP     0

     1562    17312                    /*E* ERROR:    KSN-E$KS_CANTDIPARM-0
     1563    17313                         MESSAGE:  Unable to display %U1. */
     1564    17314    3               GOTO END_LOOP;

  17314  4 005145   005146 710000 4                  TRA     END_LOOP

     1565    17315    3            END;

  17310  4 005146                       END_LOOP     null
     1566    17316    2   END_LOOP:;
     1567    17317    2           READ_NETCON.V.KEYR# = '0'B;

  17317  4 005146   000000 236000 5                  LDQ     0
         4 005147   006424 356000 2                  ANSQ    READ_NETCON+8

     1568    17318    2           READ_NETCON.V.KEYS# = '1'B;

  17318  4 005150   200000 236007                    LDQ     65536,DL
         4 005151   006424 256000 2                  ORSQ    READ_NETCON+8

     1569    17319    2           IF KS_NODENAME_SV ~= ' ' THEN

  17319  4 005152   040000 106400                    CMPC    fill='040'O
         4 005153   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8
         4 005154   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 005155   005167 600000 4                  TZE     s:17325

     1570    17320    3              DO;

     1571    17321    3              KS_NODENAME = KS_NODENAME_SV;

  17321  4 005156   040000 100400                    MLR     fill='040'O
         4 005157   000000 000010 xsym               ADSC9   KS_NODENAME_SV           cn=0,n=8
         4 005160   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:234  

     1572    17322    3              KS_NODE = KS_NODE_SV;

  17322  4 005161   000000 235000 xsym               LDA     KS_NODE_SV
         4 005162   000000 755000 xsym               STA     KS_NODE

     1573    17323    3              KS_NODENAME_SV = ' ';

  17323  4 005163   000035 235000 xsym               LDA     B_VECTNIL+29
         4 005164   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 005165   000000 755000 xsym               STA     KS_NODENAME_SV
         4 005166   000001 756000 xsym               STQ     KS_NODENAME_SV+1

     1574    17324    3              END;

     1575    17325    2          LAST_DI = BLK$->OUT$BLK.CODE;

  17325  4 005167   200173 470500                    LDP0    BLK$,,AUTO
         4 005170   000000 236100                    LDQ     0,,PR0
         4 005171   777777 376007                    ANQ     -1,DL
         4 005172   200326 756100                    STQ     LAST_DI,,AUTO

     1576    17326    2           END;  /* DO I */

  17326  4 005173   200075 235100                    LDA     I,,AUTO
         4 005174   000001 035007                    ADLA    1,DL
         4 005175   200075 755100                    STA     I,,AUTO
         4 005176   200003 470500                    LDP0    @TOP$,,AUTO
         4 005177   000000 471500                    LDP1    0,,PR0
         4 005200   100001 236100                    LDQ     1,,PR1
         4 005201   000022 772000                    QRL     18
         4 005202   200075 116100                    CMPQ    I,,AUTO
         4 005203   005205 600000 4                  TZE     s:17327
         4 005204   000011 603000 4                  TRC     s:16327

     1577    17327    1   RETURN;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:235  
  17327  4 005205   000000 702200 xent               TSX2  ! X66_ARET

     1578    17328        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:236  
     1579    17329
     1580    17330    1     GET_NODE:  PROC(PTR$);

  17330  4 005206   200354 741300       GET_NODE     STX1  ! SUBLK_INDX+1,,AUTO

     1581    17331
     1582    17332    2           DCL PTR$ PTR;
     1583    17333
     1584    17334    2     CALL M$READ(READ_NETWORK);

  17334  4 005207   006516 630400 2                  EPPR0   READ_NETWORK
         4 005210   040000 713400                    CLIMB   read
         4 005211   401400 401760                    pmme    nvectors=4

     1585    17335    2           FEPNODE = -1;

  17335  4 005212   000001 335007                    LCA     1,DL
         4 005213   200200 755100                    STA     FEPNODE,,AUTO

     1586    17336    3     DO CASE(PTR$->OUT$BLK.CODE);

  17336  4 005214   200355 470500                    LDP0    @PTR$,,AUTO
         4 005215   000000 471500                    LDP1    0,,PR0
         4 005216   100000 720100                    LXL0    0,,PR1
         4 005217   000002 100003                    CMPX0   2,DU
         4 005220   005222 602010 4                  TNC     s:17336+6,X0
         4 005221   005272 710000 4                  TRA     s:17351
         4 005222   005224 710000 4                  TRA     s:17340
         4 005223   005253 710000 4                  TRA     s:17347

     1587    17337
     1588    17338    3        CASE (%KS_TEXTVAL);

     1589    17339
     1590    17340    3           FEPNAME = PTR$->OUT$SYM.TEXT;

  17340  4 005224   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:237  
         4 005225   000033 772000                    QRL     27
         4 005226   000000 621006                    EAX1    0,QL
         4 005227   040100 100540                    MLR     fill='040'O
         4 005230   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 005231   200201 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

     1591    17341    4           DO I = 0 TO KS_NETWORK.NODE#;

  17341  4 005232   200075 450100                    STZ     I,,AUTO
         4 005233   005247 710000 4                  TRA     s:17344+3

     1592    17342    4              IF FEPNAME = KS_NETWORK.NODE.NODE(I) THEN

  17342  4 005234   200075 236100                    LDQ     I,,AUTO
         4 005235   000024 402007                    MPY     20,DL
         4 005236   040006 106500                    CMPC    fill='040'O
         4 005237   200201 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8
         4 005240   001367 000010 2                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 005241   005244 601000 4                  TNZ     s:17344

     1593    17343    4                 FEPNODE = I;

  17343  4 005242   200075 235100                    LDA     I,,AUTO
         4 005243   200200 755100                    STA     FEPNODE,,AUTO

     1594    17344    4           END;

  17344  4 005244   200075 235100                    LDA     I,,AUTO
         4 005245   000001 035007                    ADLA    1,DL
         4 005246   200075 755100                    STA     I,,AUTO
         4 005247   001365 236000 2                  LDQ     KS_NETWORK
         4 005250   200075 116100                    CMPQ    I,,AUTO
         4 005251   005234 603000 4                  TRC     s:17342
         4 005252   005272 710000 4                  TRA     s:17351

     1595    17345
     1596    17346    3        CASE (%KS_DECVAL);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:238  

     1597    17347    3           CALL CHARBIN(FEPNODE,PTR$->OUT$SYM.TEXT);

  17347  4 005253   100004 236100                    LDQ     4,,PR1
         4 005254   000033 772000                    QRL     27
         4 005255   000000 621006                    EAX1    0,QL
         4 005256   000100 305540                    DTB
         4 005257   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
         4 005260   200200 000004                    NDSC9   FEPNODE,,AUTO            cn=0,s=lsgnf,sf=0,n=4

     1598    17348    3           IF FEPNODE <= KS_NETWORK.NODE# THEN

  17348  4 005261   001365 236000 2                  LDQ     KS_NETWORK
         4 005262   005265 604000 4                  TMI     s:17349
         4 005263   200200 116100                    CMPQ    FEPNODE,,AUTO
         4 005264   005272 604000 4                  TMI     s:17351

     1599    17349    3              FEPNAME = KS_NETWORK.NODE.NODE(FEPNODE);

  17349  4 005265   200200 236100                    LDQ     FEPNODE,,AUTO
         4 005266   000024 402007                    MPY     20,DL
         4 005267   040100 100406                    MLR     fill='040'O
         4 005270   001367 000010 2                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 005271   200201 000010                    ADSC9   FEPNAME,,AUTO            cn=0,n=8

     1600    17350    3     END;   /* case  */

     1601    17351    2     RETURN;

  17351  4 005272   200354 221300                    LDX1  ! SUBLK_INDX+1,,AUTO
         4 005273   000001 702211                    TSX2  ! 1,X1

     1602    17352    2     END GET_NODE;
     1603    17353        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:239  
     1604    17354    1   DISPLAY_INDEXED_PARM:  PROC (PARMX,INDX);

  17354  4 005274   200354 741300       DISPLAY_IND* STX1  ! SUBLK_INDX+1,,AUTO

     1605    17355
     1606    17356    2            DCL PARMX UBIN;
     1607    17357    2            DCL INDX UBIN;
     1608    17358    2            DCL J UBIN;
     1609    17359
     1610    17360    2            IF KS_SELPRMOPT = %KS_FILE THEN

  17360  4 005275   000000 236000 xsym               LDQ     KS_SELPRMOPT
         4 005276   777000 376003                    ANQ     -512,DU
         4 005277   003000 116003                    CMPQ    1536,DU
         4 005300   005304 601000 4                  TNZ     s:17364

     1611    17361    2               NO_CURRENT_VAL = '1'B;

  17361  4 005301   400000 236003                    LDQ     -131072,DU
         4 005302   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO
         4 005303   005335 710000 4                  TRA     s:17372

     1612    17362    2            ELSE
     1613    17363    3               DO;

     1614    17364    3                 CALL KSU$BLD_KL_CONTROL (KS_CONTROL,KS_HNDLRNAME,%KL_CONTROL_DISPLAY,
             17364                           PARMX,INDX);

  17364  4 005304   200356 236100                    LDQ     @INDX,,AUTO
         4 005305   200402 756100                    STQ     MAX+5,,AUTO
         4 005306   200355 236100                    LDQ     @PARMX,,AUTO
         4 005307   000261 235000 5                  LDA     177
         4 005310   200400 757100                    STAQ    MAX+3,,AUTO
         4 005311   000312 237000 5                  LDAQ    202
         4 005312   200376 757100                    STAQ    MAX+1,,AUTO
         4 005313   200376 630500                    EPPR0   MAX+1,,AUTO
         4 005314   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:240  
         4 005315   000000 701000 xent               TSX1    KSU$BLD_KL_CONTROL
         4 005316   000000 011000                    NOP     0

     1615    17365    3                  CALL KSR$WR_HLPCG (VECTOR(KS_CONTROL)) ALTRET (HNDLR_CG_ERR);

  17365  4 005317   000266 630400 5                  EPPR0   182
         4 005320   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005321   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 005322   005327 702000 4                  TSX2    HNDLR_CG_ERR

     1616    17366    3                  CALL KSR$RD_HLPCG ('0'B) ALTRET (HNDLR_CG_ERR);

  17366  4 005323   000132 630400 5                  EPPR0   90
         4 005324   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005325   000000 701000 xent               TSX1    KSR$RD_HLPCG
         4 005326   005327 702000 4                  TSX2    HNDLR_CG_ERR

     1617    17367    3   HNDLR_CG_ERR:
     1618    17368    3                  IF CONTROL.TYPE = 0 THEN

  17368  4 005327   000000 470400 xsym  HNDLR_CG_ERR LDP0    KS_MSGBUF$
         4 005330   000000 236100                    LDQ     0,,PR0
         4 005331   000777 316003                    CANQ    511,DU
         4 005332   005335 601000 4                  TNZ     s:17372

     1619    17369    3                     NO_CURRENT_VAL = '1'B;

  17369  4 005333   400000 236003                    LDQ     -131072,DU
         4 005334   200070 756100                    STQ     NO_CURRENT_VAL,,AUTO

     1620    17370    3               END;

     1621    17371
     1622    17372    2            KS_HANDLER_KEY.NODE = KS_NODE;

  17372  4 005335   000000 236000 xsym               LDQ     KS_NODE
         4 005336   000011 736000                    QLS     9
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:241  
         4 005337   001211 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     1623    17373    2            KS_HANDLER_KEY.HNDLR = KS_HNDLRNAME;

  17373  4 005340   040000 100400                    MLR     fill='040'O
         4 005341   000000 000010 xsym               ADSC9   KS_HNDLRNAME             cn=0,n=8
         4 005342   001211 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     1624    17374    2            CALL KSU$READ_NETCON (VECTOR(KS_HANDLER_KEY),VECTOR(CHAR_BUF)) ALTRET (
             17374                     DISP_ERR);

  17374  4 005343   000314 630400 5                  EPPR0   204
         4 005344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005345   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 005346   005410 702000 4                  TSX2    DISP_ERR

     1625    17375    2           J = PARMX - %KL_HNDLRPARM_BLOCK;

  17375  4 005347   200355 470500                    LDP0    @PARMX,,AUTO
         4 005350   000000 235100                    LDA     0,,PR0
         4 005351   000035 135007                    SBLA    29,DL
         4 005352   200357 755100                    STA     J,,AUTO

     1626    17376    2            IPARAM$ = PINCRW(ADDR(CHAR_BUF),J);

  17376  4 005353   000150 631405 2                  EPPR1   CHAR_BUF,AL
         4 005354   200071 451500                    STP1    IPARAM$,,AUTO

     1627    17377    2            HANDLER$ = PINCRW (ADDR(CHAR_BUF),IPARAM$->KS$HNDLR.IPARAM.OFFSET(0));

  17377  4 005355   100034 220100                    LDX0    28,,PR1
         4 005356   000150 633410 2                  EPPR3   CHAR_BUF,X0
         4 005357   000315 453400 2                  STP3    HANDLER$

     1628    17378    2            CALL DISPARM (KS_HNDLRINDX+3,PARMX,INDX,CONTROL.VALUE,HANDLER$->B$PARAM(
             17378                     INDX),NO_CURRENT_VAL);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:242  
  17378  4 005360   200356 474500                    LDP4    @INDX,,AUTO
         4 005361   400000 235100                    LDA     0,,PR4
         4 005362   000000 236000 xsym               LDQ     KS_HNDLRINDX
         4 005363   000033 772000                    QRL     27
         4 005364   000003 036007                    ADLQ    3,DL
         4 005365   200461 756100                    STQ     MAX+52,,AUTO
         4 005366   200070 635500                    EPPR5   NO_CURRENT_VAL,,AUTO
         4 005367   200366 455500                    STP5    MAX+1,,AUTO
         4 005370   000044 733000                    LRS     36
         4 005371   000021 736000                    QLS     17
         4 005372   000315 036000 2                  ADLQ    HANDLER$
         4 005373   200365 756100                    STQ     MIN+1,,AUTO
         4 005374   000000 236000 xsym               LDQ     KS_MSGBUF$
         4 005375   000012 036003                    ADLQ    10,DU
         4 005376   200364 756100                    STQ     DEFAULT+1,,AUTO
         4 005377   200356 236100                    LDQ     @INDX,,AUTO
         4 005400   200355 235100                    LDA     @PARMX,,AUTO
         4 005401   200362 757100                    STAQ    @NO_CURRENT_VAL+1,,AUTO
         4 005402   200461 636500                    EPPR6   MAX+52,,AUTO
         4 005403   200361 456500                    STP6    @NETCON_VAL+1,,AUTO
         4 005404   005412 701000 4                  TSX1    DISPARM
         4 005405   000000 011000                    NOP     0

     1629    17379    2            HANDLER$ = ADDR(CHAR_BUF);

  17379  4 005406   000030 236000 5                  LDQ     24
         4 005407   000315 756000 2                  STQ     HANDLER$

     1630    17380    2   DISP_ERR:
     1631    17381    2   END DISPLAY_INDEXED_PARM;

  17381  4 005410                       DISP_ERR     null
  17381  4 005410   200354 221300                    LDX1  ! SUBLK_INDX+1,,AUTO
         4 005411   000001 702211                    TSX2  ! 1,X1

     1632    17382
     1633    17383    1   DISPARM: PROC (PARMTYPE,PARMX,INDX,CURRENT_VAL,NETCON_VAL,NO_CURRENT_VAL);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:243  

  17383  4 005412   200360 741300       DISPARM      STX1  ! @CURRENT_VAL+1,,AUTO

     1634    17384
     1635    17385    2         DCL PARMTYPE   UBIN;
     1636    17386    2         DCL PARMX      UBIN;
     1637    17387    2         DCL INDX       UBIN;
     1638    17388    2         DCL CURRENT_VAL UBIN HALF HALIGNED;
     1639    17389    2         DCL NETCON_VAL UBIN  HALF UNAL;
     1640    17390    2         DCL NO_CURRENT_VAL BIT(1) ALIGNED;
     1641    17391    2         DCL NETCON_DISP UBIN WORD;
     1642    17392    2         DCL SPCL_TBL$  PTR;
     1643    17393    2         DCL INDX_NAME  UBIN;
     1644    17394    2         DCL CURRENT_DISP UBIN;
     1645    17395    2         DCL DEFAULT    UBIN;
     1646    17396    2         DCL MIN        UBIN;
     1647    17397    2         DCL MAX        UBIN;
     1648    17398
     1649    17399    2        DCL HDR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17399                 'PARAMETER%20-CURRENT%30-:NETCON%40-DEFAULT%50-MINIMUM%60-MAXIMUM%10P');
     1650    17400    2        DCL INDX_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17400                 '%T%X(%D)%20-%D%30-%D%40-%D%50-%D%60-%D%10P');
     1651    17401    2        DCL RES_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17401                 '%T%20-%A%28-%A%38-%A%48-%A%58-%A%10P');
     1652    17402    2        DCL ATTR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17402                 '%T%20-%H%30-%H%40-%H%50-%H%60-%H%10P');
     1653    17403    2        DCL PARM_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17403                 '%T%20-%D%30-%D%40-%D%50-%D%60-%D%10P');
     1654    17404        %KS$PARAM(NAME=KS$PARAM_SPCL,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
     1655    17474    2        DCL INDX_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17474                 '%T%X(%D)%30-%D%40-%D%50-%D%60-%D%10P');
     1656    17475    2        DCL ATTR_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17475                 '%T%30-%H%40-%H%50-%H%60-%H%10P');
     1657    17476    2        DCL PARM_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17476                 '%T%30-%D%40-%D%50-%D%60-%D%10P');
     1658    17477    2         IF FIRST_PARM THEN

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:244  
  17477  4 005413   200067 234100                    SZN     FIRST_PARM,,AUTO
         4 005414   005422 605000 4                  TPL     s:17484

     1659    17478    3            DO;

     1660    17479    3               CALL KSW$WRITE (VECTOR(HDR_FMT));

  17479  4 005415   000364 630400 5                  EPPR0   244
         4 005416   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 005417   000000 701000 xent               TSX1    KSW$WRITE
         4 005420   000000 011000                    NOP     0

     1661    17480    3               FIRST_PARM = '0'B;

  17480  4 005421   200067 450100                    STZ     FIRST_PARM,,AUTO

     1662    17481    3            END;

     1663    17482
     1664    17483
     1665    17484    3         DO CASE (PARMX);

  17484  4 005422   200362 470500                    LDP0    @PARMX,,AUTO
         4 005423   000000 235100                    LDA     0,,PR0
         4 005424   000041 115007                    CMPA    33,DL
         4 005425   005427 602005 4                  TNC     s:17484+5,AL
         4 005426   007216 710000 4                  TRA     s:17595
         4 005427   007216 710000 4                  TRA     s:17595
         4 005430   007216 710000 4                  TRA     s:17595
         4 005431   007216 710000 4                  TRA     s:17595
         4 005432   006307 710000 4                  TRA     s:17538
         4 005433   006455 710000 4                  TRA     s:17552
         4 005434   007216 710000 4                  TRA     s:17595
         4 005435   007216 710000 4                  TRA     s:17595
         4 005436   007216 710000 4                  TRA     s:17595
         4 005437   007216 710000 4                  TRA     s:17595
         4 005440   007216 710000 4                  TRA     s:17595
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:245  
         4 005441   007216 710000 4                  TRA     s:17595
         4 005442   007216 710000 4                  TRA     s:17595
         4 005443   006731 710000 4                  TRA     s:17573
         4 005444   006731 710000 4                  TRA     s:17573
         4 005445   006455 710000 4                  TRA     s:17552
         4 005446   007216 710000 4                  TRA     s:17595
         4 005447   007216 710000 4                  TRA     s:17595
         4 005450   007216 710000 4                  TRA     s:17595
         4 005451   007216 710000 4                  TRA     s:17595
         4 005452   007216 710000 4                  TRA     s:17595
         4 005453   007216 710000 4                  TRA     s:17595
         4 005454   007216 710000 4                  TRA     s:17595
         4 005455   007216 710000 4                  TRA     s:17595
         4 005456   007216 710000 4                  TRA     s:17595
         4 005457   007216 710000 4                  TRA     s:17595
         4 005460   007216 710000 4                  TRA     s:17595
         4 005461   007216 710000 4                  TRA     s:17595
         4 005462   007216 710000 4                  TRA     s:17595
         4 005463   007216 710000 4                  TRA     s:17595
         4 005464   005470 710000 4                  TRA     s:17486
         4 005465   005470 710000 4                  TRA     s:17486
         4 005466   006000 710000 4                  TRA     s:17512
         4 005467   006000 710000 4                  TRA     s:17512

     1666    17485    3           CASE (%KL_HNDLRPARM_BLOCK,%KL_HNDLRPARM_UNBLOCK);

     1667    17486    3               INDX_NAME = LINESPEED(INDX);

  17486  4 005470   200363 471500                    LDP1    @INDX,,AUTO
         4 005471   100000 720100                    LXL0    0,,PR1
         4 005472   002450 236010 1                  LDQ     LINESPEED,X0
         4 005473   000022 772000                    QRL     18
         4 005474   200371 756100                    STQ     INDX_NAME,,AUTO

     1668    17487    3               SPCL_TBL$ = KS_TBL(PARMTYPE)->KS$PARAM_SPCL.SPCL_TBL$(PARMX);

  17487  4 005475   200361 473500                    LDP3    @PARMTYPE,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:246  
         4 005476   300000 720100                    LXL0    0,,PR3
         4 005477   000000 474410 xsym               LDP4    KS_TBL,X0
         4 005500   000000 235100                    LDA     0,,PR0
         4 005501   000002 735000                    ALS     2
         4 005502   400002 236105                    LDQ     2,AL,PR4
         4 005503   200370 756100                    STQ     SPCL_TBL$,,AUTO

     1669    17488    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);

  17488  4 005504   200372 635500                    EPPR5   CURRENT_DISP,,AUTO
         4 005505   200377 455500                    STP5    MAX+2,,AUTO
         4 005506   200364 236100                    LDQ     @CURRENT_VAL,,AUTO
         4 005507   200376 756100                    STQ     MAX+1,,AUTO
         4 005510   200376 630500                    EPPR0   MAX+1,,AUTO
         4 005511   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 005512   000000 701000 xent               TSX1    KSU$PACK2
         4 005513   000000 011000                    NOP     0

     1670    17489    3               NETCON_DISP = NETCON_VAL;

  17489  4 005514   200365 470500                    LDP0    @NETCON_VAL,,AUTO
         4 005515   003100 061500                    CSR     bolr='003'O
         4 005516   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         4 005517   200367 000044                    BDSC    NETCON_DISP,,AUTO        by=0,bit=0,n=36

     1671    17490    3               DEFAULT = SPCL_TBL$->KS$PARAM.DEFAULT(INDX);

  17490  4 005520   200363 471500                    LDP1    @INDX,,AUTO
         4 005521   100000 235100                    LDA     0,,PR1
         4 005522   000002 735000                    ALS     2
         4 005523   200370 473500                    LDP3    SPCL_TBL$,,AUTO
         4 005524   300003 235105                    LDA     3,AL,PR3
         4 005525   200373 755100                    STA     DEFAULT,,AUTO

     1672    17491    3               MIN     = SPCL_TBL$->KS$PARAM.MIN(INDX);

  17491  4 005526   100000 235100                    LDA     0,,PR1
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:247  
         4 005527   000002 735000                    ALS     2
         4 005530   300002 236105                    LDQ     2,AL,PR3
         4 005531   777777 376007                    ANQ     -1,DL
         4 005532   200374 756100                    STQ     MIN,,AUTO

     1673    17492    3               MAX     = SPCL_TBL$->KS$PARAM.MAX(INDX);

  17492  4 005533   100000 235100                    LDA     0,,PR1
         4 005534   000002 735000                    ALS     2
         4 005535   300002 236105                    LDQ     2,AL,PR3
         4 005536   000022 772000                    QRL     18
         4 005537   200375 756100                    STQ     MAX,,AUTO

     1674    17493    3              IF NO_CURRENT_VAL THEN

  17493  4 005540   200366 474500                    LDP4    @NO_CURRENT_VAL,,AUTO
         4 005541   400000 234100                    SZN     0,,PR4
         4 005542   005655 605000 4                  TPL     s:17509

     1675    17494    3                 CALL KSW$WRITE (VECTOR(INDX_NO_CURR_FMT),

  17494  4 005543   200361 475500                    LDP5    @PARMTYPE,,AUTO
         4 005544   500000 720100                    LXL0    0,,PR5
         4 005545   000000 476410 xsym               LDP6    KS_TBL,X0
         4 005546   200362 477500                    LDP7    @PARMX,,AUTO
         4 005547   700000 235100                    LDA     0,,PR7
         4 005550   000002 735000                    ALS     2
         4 005551   600000 470505                    LDP0    0,AL,PR6
         4 005552   000100 101500                    MRL     fill='000'O
         4 005553   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 005554   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 005555   200376 220100                    LDX0    MAX+1,,AUTO
         4 005556   000001 621010                    EAX1    1,X0
         4 005557   000000 635011                    EAA     0,X1
         4 005560   000002 771000                    ARL     2
         4 005561   000140 135007                    SBLA    96,DL
         4 005562   200377 450500                    STP0    MAX+2,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:248  
         4 005563   200377 236100                    LDQ     MAX+2,,AUTO
         4 005564   200400 757100                    STAQ    MAX+3,,AUTO
         4 005565   777640 235007                    LDA     -96,DL
         4 005566   200402 452500                    STP2    MAX+5,,AUTO
         4 005567   200402 236100                    LDQ     MAX+5,,AUTO
         4 005570   000371 036003                    ADLQ    249,DU
         4 005571   200404 757100                    STAQ    MAX+7,,AUTO
         4 005572   777640 235007                    LDA     -96,DL
         4 005573   200406 452500                    STP2    MAX+9,,AUTO
         4 005574   200406 236100                    LDQ     MAX+9,,AUTO
         4 005575   000367 036003                    ADLQ    247,DU
         4 005576   200410 757100                    STAQ    MAX+11,,AUTO
         4 005577   777640 235007                    LDA     -96,DL
         4 005600   200412 452500                    STP2    MAX+13,,AUTO
         4 005601   200412 236100                    LDQ     MAX+13,,AUTO
         4 005602   000373 036003                    ADLQ    251,DU
         4 005603   200414 757100                    STAQ    MAX+15,,AUTO
         4 005604   777640 235007                    LDA     -96,DL
         4 005605   200416 452500                    STP2    MAX+17,,AUTO
         4 005606   200416 236100                    LDQ     MAX+17,,AUTO
         4 005607   000374 036003                    ADLQ    252,DU
         4 005610   200420 757100                    STAQ    MAX+19,,AUTO
         4 005611   777640 235007                    LDA     -96,DL
         4 005612   200422 452500                    STP2    MAX+21,,AUTO
         4 005613   200422 236100                    LDQ     MAX+21,,AUTO
         4 005614   000375 036003                    ADLQ    253,DU
         4 005615   200426 757100                    STAQ    MAX+25,,AUTO
         4 005616   200400 237100                    LDAQ    MAX+3,,AUTO
         4 005617   200424 757100                    STAQ    MAX+23,,AUTO
         4 005620   200404 237100                    LDAQ    MAX+7,,AUTO
         4 005621   200430 757100                    STAQ    MAX+27,,AUTO
         4 005622   200410 237100                    LDAQ    MAX+11,,AUTO
         4 005623   200432 757100                    STAQ    MAX+29,,AUTO
         4 005624   200414 237100                    LDAQ    MAX+15,,AUTO
         4 005625   200434 757100                    STAQ    MAX+31,,AUTO
         4 005626   200420 237100                    LDAQ    MAX+19,,AUTO
         4 005627   200436 757100                    STAQ    MAX+33,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:249  
         4 005630   200426 237100                    LDAQ    MAX+25,,AUTO
         4 005631   200440 757100                    STAQ    MAX+35,,AUTO
         4 005632   200440 636500                    EPPR6   MAX+35,,AUTO
         4 005633   200450 456500                    STP6    MAX+43,,AUTO
         4 005634   200436 630500                    EPPR0   MAX+33,,AUTO
         4 005635   200447 450500                    STP0    MAX+42,,AUTO
         4 005636   200434 630500                    EPPR0   MAX+31,,AUTO
         4 005637   200446 450500                    STP0    MAX+41,,AUTO
         4 005640   200432 630500                    EPPR0   MAX+29,,AUTO
         4 005641   200445 450500                    STP0    MAX+40,,AUTO
         4 005642   200430 630500                    EPPR0   MAX+27,,AUTO
         4 005643   200444 450500                    STP0    MAX+39,,AUTO
         4 005644   200424 630500                    EPPR0   MAX+23,,AUTO
         4 005645   200443 450500                    STP0    MAX+38,,AUTO
         4 005646   000370 236000 5                  LDQ     248
         4 005647   200442 756100                    STQ     MAX+37,,AUTO
         4 005650   200442 630500                    EPPR0   MAX+37,,AUTO
         4 005651   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 005652   000000 701000 xent               TSX1    KSW$WRITE
         4 005653   000000 011000                    NOP     0
         4 005654   007471 710000 4                  TRA     s:17616

     1676    17495    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17495                                          NAME),
     1677    17496    3                                 VECTOR(INDX_NAME),
     1678    17497    3                                 VECTOR(NETCON_DISP),
     1679    17498    3                                 VECTOR(DEFAULT),
     1680    17499    3                                 VECTOR(MIN),
     1681    17500    3                                 VECTOR(MAX));
     1682    17501    3              ELSE
     1683    17502    3                  CALL KSW$WRITE (VECTOR(INDX_FMT),
     1684    17503    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17503                                           NAME),
     1685    17504    3                                  VECTOR(INDX_NAME),
     1686    17505    3                                  VECTOR(CURRENT_DISP),
     1687    17506    3                                  VECTOR(NETCON_DISP),
     1688    17507    3                                  VECTOR(DEFAULT),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:250  
     1689    17508    3                                  VECTOR(MIN),
     1690    17509    3                                  VECTOR(MAX));

  17509  4 005655   200361 475500                    LDP5    @PARMTYPE,,AUTO
         4 005656   500000 720100                    LXL0    0,,PR5
         4 005657   000000 476410 xsym               LDP6    KS_TBL,X0
         4 005660   200362 477500                    LDP7    @PARMX,,AUTO
         4 005661   700000 235100                    LDA     0,,PR7
         4 005662   000002 735000                    ALS     2
         4 005663   600000 470505                    LDP0    0,AL,PR6
         4 005664   000100 101500                    MRL     fill='000'O
         4 005665   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 005666   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 005667   200376 220100                    LDX0    MAX+1,,AUTO
         4 005670   000001 621010                    EAX1    1,X0
         4 005671   000000 635011                    EAA     0,X1
         4 005672   000002 771000                    ARL     2
         4 005673   000140 135007                    SBLA    96,DL
         4 005674   200377 450500                    STP0    MAX+2,,AUTO
         4 005675   200377 236100                    LDQ     MAX+2,,AUTO
         4 005676   200400 757100                    STAQ    MAX+3,,AUTO
         4 005677   777640 235007                    LDA     -96,DL
         4 005700   200402 452500                    STP2    MAX+5,,AUTO
         4 005701   200402 236100                    LDQ     MAX+5,,AUTO
         4 005702   000371 036003                    ADLQ    249,DU
         4 005703   200404 757100                    STAQ    MAX+7,,AUTO
         4 005704   777640 235007                    LDA     -96,DL
         4 005705   200406 452500                    STP2    MAX+9,,AUTO
         4 005706   200406 236100                    LDQ     MAX+9,,AUTO
         4 005707   000372 036003                    ADLQ    250,DU
         4 005710   200410 757100                    STAQ    MAX+11,,AUTO
         4 005711   777640 235007                    LDA     -96,DL
         4 005712   200412 452500                    STP2    MAX+13,,AUTO
         4 005713   200412 236100                    LDQ     MAX+13,,AUTO
         4 005714   000367 036003                    ADLQ    247,DU
         4 005715   200414 757100                    STAQ    MAX+15,,AUTO
         4 005716   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:251  
         4 005717   200416 452500                    STP2    MAX+17,,AUTO
         4 005720   200416 236100                    LDQ     MAX+17,,AUTO
         4 005721   000373 036003                    ADLQ    251,DU
         4 005722   200420 757100                    STAQ    MAX+19,,AUTO
         4 005723   777640 235007                    LDA     -96,DL
         4 005724   200422 452500                    STP2    MAX+21,,AUTO
         4 005725   200422 236100                    LDQ     MAX+21,,AUTO
         4 005726   000374 036003                    ADLQ    252,DU
         4 005727   200424 757100                    STAQ    MAX+23,,AUTO
         4 005730   777640 235007                    LDA     -96,DL
         4 005731   200426 452500                    STP2    MAX+25,,AUTO
         4 005732   200426 236100                    LDQ     MAX+25,,AUTO
         4 005733   000375 036003                    ADLQ    253,DU
         4 005734   200432 757100                    STAQ    MAX+29,,AUTO
         4 005735   200400 237100                    LDAQ    MAX+3,,AUTO
         4 005736   200430 757100                    STAQ    MAX+27,,AUTO
         4 005737   200404 237100                    LDAQ    MAX+7,,AUTO
         4 005740   200434 757100                    STAQ    MAX+31,,AUTO
         4 005741   200410 237100                    LDAQ    MAX+11,,AUTO
         4 005742   200436 757100                    STAQ    MAX+33,,AUTO
         4 005743   200414 237100                    LDAQ    MAX+15,,AUTO
         4 005744   200440 757100                    STAQ    MAX+35,,AUTO
         4 005745   200420 237100                    LDAQ    MAX+19,,AUTO
         4 005746   200442 757100                    STAQ    MAX+37,,AUTO
         4 005747   200424 237100                    LDAQ    MAX+23,,AUTO
         4 005750   200444 757100                    STAQ    MAX+39,,AUTO
         4 005751   200432 237100                    LDAQ    MAX+29,,AUTO
         4 005752   200446 757100                    STAQ    MAX+41,,AUTO
         4 005753   200446 636500                    EPPR6   MAX+41,,AUTO
         4 005754   200457 456500                    STP6    MAX+50,,AUTO
         4 005755   200444 630500                    EPPR0   MAX+39,,AUTO
         4 005756   200456 450500                    STP0    MAX+49,,AUTO
         4 005757   200442 630500                    EPPR0   MAX+37,,AUTO
         4 005760   200455 450500                    STP0    MAX+48,,AUTO
         4 005761   200440 630500                    EPPR0   MAX+35,,AUTO
         4 005762   200454 450500                    STP0    MAX+47,,AUTO
         4 005763   200436 630500                    EPPR0   MAX+33,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:252  
         4 005764   200453 450500                    STP0    MAX+46,,AUTO
         4 005765   200434 630500                    EPPR0   MAX+31,,AUTO
         4 005766   200452 450500                    STP0    MAX+45,,AUTO
         4 005767   200430 630500                    EPPR0   MAX+27,,AUTO
         4 005770   200451 450500                    STP0    MAX+44,,AUTO
         4 005771   000374 236000 5                  LDQ     252
         4 005772   200450 756100                    STQ     MAX+43,,AUTO
         4 005773   200450 630500                    EPPR0   MAX+43,,AUTO
         4 005774   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 005775   000000 701000 xent               TSX1    KSW$WRITE
         4 005776   000000 011000                    NOP     0
         4 005777   007471 710000 4                  TRA     s:17616

     1691    17510
     1692    17511    3            CASE (%KL_HNDLRPARM_USRPARM1,%KL_HNDLRPARM_USRPARM2);

     1693    17512    3               INDX_NAME = INDX + 1;

  17512  4 006000   200363 471500                    LDP1    @INDX,,AUTO
         4 006001   100000 235100                    LDA     0,,PR1
         4 006002   000001 035007                    ADLA    1,DL
         4 006003   200371 755100                    STA     INDX_NAME,,AUTO

     1694    17513    3               SPCL_TBL$ = KS_TBL(PARMTYPE)->KS$PARAM_SPCL.SPCL_TBL$(PARMX);

  17513  4 006004   200361 473500                    LDP3    @PARMTYPE,,AUTO
         4 006005   300000 720100                    LXL0    0,,PR3
         4 006006   000000 474410 xsym               LDP4    KS_TBL,X0
         4 006007   000000 235100                    LDA     0,,PR0
         4 006010   000002 735000                    ALS     2
         4 006011   400002 236105                    LDQ     2,AL,PR4
         4 006012   200370 756100                    STQ     SPCL_TBL$,,AUTO

     1695    17514    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);

  17514  4 006013   200372 635500                    EPPR5   CURRENT_DISP,,AUTO
         4 006014   200377 455500                    STP5    MAX+2,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:253  
         4 006015   200364 236100                    LDQ     @CURRENT_VAL,,AUTO
         4 006016   200376 756100                    STQ     MAX+1,,AUTO
         4 006017   200376 630500                    EPPR0   MAX+1,,AUTO
         4 006020   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006021   000000 701000 xent               TSX1    KSU$PACK2
         4 006022   000000 011000                    NOP     0

     1696    17515    3               NETCON_DISP = NETCON_VAL;

  17515  4 006023   200365 470500                    LDP0    @NETCON_VAL,,AUTO
         4 006024   003100 061500                    CSR     bolr='003'O
         4 006025   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         4 006026   200367 000044                    BDSC    NETCON_DISP,,AUTO        by=0,bit=0,n=36

     1697    17516    3               DEFAULT = SPCL_TBL$->KS$PARAM.DEFAULT(INDX);

  17516  4 006027   200363 471500                    LDP1    @INDX,,AUTO
         4 006030   100000 235100                    LDA     0,,PR1
         4 006031   000002 735000                    ALS     2
         4 006032   200370 473500                    LDP3    SPCL_TBL$,,AUTO
         4 006033   300003 235105                    LDA     3,AL,PR3
         4 006034   200373 755100                    STA     DEFAULT,,AUTO

     1698    17517    3               MIN     = SPCL_TBL$->KS$PARAM.MIN(INDX);

  17517  4 006035   100000 235100                    LDA     0,,PR1
         4 006036   000002 735000                    ALS     2
         4 006037   300002 236105                    LDQ     2,AL,PR3
         4 006040   777777 376007                    ANQ     -1,DL
         4 006041   200374 756100                    STQ     MIN,,AUTO

     1699    17518    3               MAX     = SPCL_TBL$->KS$PARAM.MAX(INDX);

  17518  4 006042   100000 235100                    LDA     0,,PR1
         4 006043   000002 735000                    ALS     2
         4 006044   300002 236105                    LDQ     2,AL,PR3
         4 006045   000022 772000                    QRL     18
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:254  
         4 006046   200375 756100                    STQ     MAX,,AUTO

     1700    17519    3              IF NO_CURRENT_VAL THEN

  17519  4 006047   200366 474500                    LDP4    @NO_CURRENT_VAL,,AUTO
         4 006050   400000 234100                    SZN     0,,PR4
         4 006051   006164 605000 4                  TPL     s:17535

     1701    17520    3                 CALL KSW$WRITE (VECTOR(INDX_NO_CURR_FMT),

  17520  4 006052   200361 475500                    LDP5    @PARMTYPE,,AUTO
         4 006053   500000 720100                    LXL0    0,,PR5
         4 006054   000000 476410 xsym               LDP6    KS_TBL,X0
         4 006055   200362 477500                    LDP7    @PARMX,,AUTO
         4 006056   700000 235100                    LDA     0,,PR7
         4 006057   000002 735000                    ALS     2
         4 006060   600000 470505                    LDP0    0,AL,PR6
         4 006061   000100 101500                    MRL     fill='000'O
         4 006062   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 006063   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 006064   200376 220100                    LDX0    MAX+1,,AUTO
         4 006065   000001 621010                    EAX1    1,X0
         4 006066   000000 635011                    EAA     0,X1
         4 006067   000002 771000                    ARL     2
         4 006070   000140 135007                    SBLA    96,DL
         4 006071   200377 450500                    STP0    MAX+2,,AUTO
         4 006072   200377 236100                    LDQ     MAX+2,,AUTO
         4 006073   200400 757100                    STAQ    MAX+3,,AUTO
         4 006074   777640 235007                    LDA     -96,DL
         4 006075   200402 452500                    STP2    MAX+5,,AUTO
         4 006076   200402 236100                    LDQ     MAX+5,,AUTO
         4 006077   000371 036003                    ADLQ    249,DU
         4 006100   200404 757100                    STAQ    MAX+7,,AUTO
         4 006101   777640 235007                    LDA     -96,DL
         4 006102   200406 452500                    STP2    MAX+9,,AUTO
         4 006103   200406 236100                    LDQ     MAX+9,,AUTO
         4 006104   000367 036003                    ADLQ    247,DU
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:255  
         4 006105   200410 757100                    STAQ    MAX+11,,AUTO
         4 006106   777640 235007                    LDA     -96,DL
         4 006107   200412 452500                    STP2    MAX+13,,AUTO
         4 006110   200412 236100                    LDQ     MAX+13,,AUTO
         4 006111   000373 036003                    ADLQ    251,DU
         4 006112   200414 757100                    STAQ    MAX+15,,AUTO
         4 006113   777640 235007                    LDA     -96,DL
         4 006114   200416 452500                    STP2    MAX+17,,AUTO
         4 006115   200416 236100                    LDQ     MAX+17,,AUTO
         4 006116   000374 036003                    ADLQ    252,DU
         4 006117   200420 757100                    STAQ    MAX+19,,AUTO
         4 006120   777640 235007                    LDA     -96,DL
         4 006121   200422 452500                    STP2    MAX+21,,AUTO
         4 006122   200422 236100                    LDQ     MAX+21,,AUTO
         4 006123   000375 036003                    ADLQ    253,DU
         4 006124   200426 757100                    STAQ    MAX+25,,AUTO
         4 006125   200400 237100                    LDAQ    MAX+3,,AUTO
         4 006126   200424 757100                    STAQ    MAX+23,,AUTO
         4 006127   200404 237100                    LDAQ    MAX+7,,AUTO
         4 006130   200430 757100                    STAQ    MAX+27,,AUTO
         4 006131   200410 237100                    LDAQ    MAX+11,,AUTO
         4 006132   200432 757100                    STAQ    MAX+29,,AUTO
         4 006133   200414 237100                    LDAQ    MAX+15,,AUTO
         4 006134   200434 757100                    STAQ    MAX+31,,AUTO
         4 006135   200420 237100                    LDAQ    MAX+19,,AUTO
         4 006136   200436 757100                    STAQ    MAX+33,,AUTO
         4 006137   200426 237100                    LDAQ    MAX+25,,AUTO
         4 006140   200440 757100                    STAQ    MAX+35,,AUTO
         4 006141   200440 636500                    EPPR6   MAX+35,,AUTO
         4 006142   200450 456500                    STP6    MAX+43,,AUTO
         4 006143   200436 630500                    EPPR0   MAX+33,,AUTO
         4 006144   200447 450500                    STP0    MAX+42,,AUTO
         4 006145   200434 630500                    EPPR0   MAX+31,,AUTO
         4 006146   200446 450500                    STP0    MAX+41,,AUTO
         4 006147   200432 630500                    EPPR0   MAX+29,,AUTO
         4 006150   200445 450500                    STP0    MAX+40,,AUTO
         4 006151   200430 630500                    EPPR0   MAX+27,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:256  
         4 006152   200444 450500                    STP0    MAX+39,,AUTO
         4 006153   200424 630500                    EPPR0   MAX+23,,AUTO
         4 006154   200443 450500                    STP0    MAX+38,,AUTO
         4 006155   000370 236000 5                  LDQ     248
         4 006156   200442 756100                    STQ     MAX+37,,AUTO
         4 006157   200442 630500                    EPPR0   MAX+37,,AUTO
         4 006160   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 006161   000000 701000 xent               TSX1    KSW$WRITE
         4 006162   000000 011000                    NOP     0
         4 006163   007471 710000 4                  TRA     s:17616

     1702    17521    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17521                                          NAME),
     1703    17522    3                                 VECTOR(INDX_NAME),
     1704    17523    3                                 VECTOR(NETCON_DISP),
     1705    17524    3                                 VECTOR(DEFAULT),
     1706    17525    3                                 VECTOR(MIN),
     1707    17526    3                                 VECTOR(MAX));
     1708    17527    3              ELSE
     1709    17528    3                  CALL KSW$WRITE (VECTOR(INDX_FMT),
     1710    17529    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17529                                           NAME),
     1711    17530    3                                  VECTOR(INDX_NAME),
     1712    17531    3                                  VECTOR(CURRENT_DISP),
     1713    17532    3                                  VECTOR(NETCON_DISP),
     1714    17533    3                                  VECTOR(DEFAULT),
     1715    17534    3                                  VECTOR(MIN),
     1716    17535    3                                  VECTOR(MAX));

  17535  4 006164   200361 475500                    LDP5    @PARMTYPE,,AUTO
         4 006165   500000 720100                    LXL0    0,,PR5
         4 006166   000000 476410 xsym               LDP6    KS_TBL,X0
         4 006167   200362 477500                    LDP7    @PARMX,,AUTO
         4 006170   700000 235100                    LDA     0,,PR7
         4 006171   000002 735000                    ALS     2
         4 006172   600000 470505                    LDP0    0,AL,PR6
         4 006173   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:257  
         4 006174   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 006175   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 006176   200376 220100                    LDX0    MAX+1,,AUTO
         4 006177   000001 621010                    EAX1    1,X0
         4 006200   000000 635011                    EAA     0,X1
         4 006201   000002 771000                    ARL     2
         4 006202   000140 135007                    SBLA    96,DL
         4 006203   200377 450500                    STP0    MAX+2,,AUTO
         4 006204   200377 236100                    LDQ     MAX+2,,AUTO
         4 006205   200400 757100                    STAQ    MAX+3,,AUTO
         4 006206   777640 235007                    LDA     -96,DL
         4 006207   200402 452500                    STP2    MAX+5,,AUTO
         4 006210   200402 236100                    LDQ     MAX+5,,AUTO
         4 006211   000371 036003                    ADLQ    249,DU
         4 006212   200404 757100                    STAQ    MAX+7,,AUTO
         4 006213   777640 235007                    LDA     -96,DL
         4 006214   200406 452500                    STP2    MAX+9,,AUTO
         4 006215   200406 236100                    LDQ     MAX+9,,AUTO
         4 006216   000372 036003                    ADLQ    250,DU
         4 006217   200410 757100                    STAQ    MAX+11,,AUTO
         4 006220   777640 235007                    LDA     -96,DL
         4 006221   200412 452500                    STP2    MAX+13,,AUTO
         4 006222   200412 236100                    LDQ     MAX+13,,AUTO
         4 006223   000367 036003                    ADLQ    247,DU
         4 006224   200414 757100                    STAQ    MAX+15,,AUTO
         4 006225   777640 235007                    LDA     -96,DL
         4 006226   200416 452500                    STP2    MAX+17,,AUTO
         4 006227   200416 236100                    LDQ     MAX+17,,AUTO
         4 006230   000373 036003                    ADLQ    251,DU
         4 006231   200420 757100                    STAQ    MAX+19,,AUTO
         4 006232   777640 235007                    LDA     -96,DL
         4 006233   200422 452500                    STP2    MAX+21,,AUTO
         4 006234   200422 236100                    LDQ     MAX+21,,AUTO
         4 006235   000374 036003                    ADLQ    252,DU
         4 006236   200424 757100                    STAQ    MAX+23,,AUTO
         4 006237   777640 235007                    LDA     -96,DL
         4 006240   200426 452500                    STP2    MAX+25,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:258  
         4 006241   200426 236100                    LDQ     MAX+25,,AUTO
         4 006242   000375 036003                    ADLQ    253,DU
         4 006243   200432 757100                    STAQ    MAX+29,,AUTO
         4 006244   200400 237100                    LDAQ    MAX+3,,AUTO
         4 006245   200430 757100                    STAQ    MAX+27,,AUTO
         4 006246   200404 237100                    LDAQ    MAX+7,,AUTO
         4 006247   200434 757100                    STAQ    MAX+31,,AUTO
         4 006250   200410 237100                    LDAQ    MAX+11,,AUTO
         4 006251   200436 757100                    STAQ    MAX+33,,AUTO
         4 006252   200414 237100                    LDAQ    MAX+15,,AUTO
         4 006253   200440 757100                    STAQ    MAX+35,,AUTO
         4 006254   200420 237100                    LDAQ    MAX+19,,AUTO
         4 006255   200442 757100                    STAQ    MAX+37,,AUTO
         4 006256   200424 237100                    LDAQ    MAX+23,,AUTO
         4 006257   200444 757100                    STAQ    MAX+39,,AUTO
         4 006260   200432 237100                    LDAQ    MAX+29,,AUTO
         4 006261   200446 757100                    STAQ    MAX+41,,AUTO
         4 006262   200446 636500                    EPPR6   MAX+41,,AUTO
         4 006263   200457 456500                    STP6    MAX+50,,AUTO
         4 006264   200444 630500                    EPPR0   MAX+39,,AUTO
         4 006265   200456 450500                    STP0    MAX+49,,AUTO
         4 006266   200442 630500                    EPPR0   MAX+37,,AUTO
         4 006267   200455 450500                    STP0    MAX+48,,AUTO
         4 006270   200440 630500                    EPPR0   MAX+35,,AUTO
         4 006271   200454 450500                    STP0    MAX+47,,AUTO
         4 006272   200436 630500                    EPPR0   MAX+33,,AUTO
         4 006273   200453 450500                    STP0    MAX+46,,AUTO
         4 006274   200434 630500                    EPPR0   MAX+31,,AUTO
         4 006275   200452 450500                    STP0    MAX+45,,AUTO
         4 006276   200430 630500                    EPPR0   MAX+27,,AUTO
         4 006277   200451 450500                    STP0    MAX+44,,AUTO
         4 006300   000374 236000 5                  LDQ     252
         4 006301   200450 756100                    STQ     MAX+43,,AUTO
         4 006302   200450 630500                    EPPR0   MAX+43,,AUTO
         4 006303   000026 631400 xsym               EPPR1   B_VECTNIL+22
         4 006304   000000 701000 xent               TSX1    KSW$WRITE
         4 006305   000000 011000                    NOP     0
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:259  
         4 006306   007471 710000 4                  TRA     s:17616

     1717    17536
     1718    17537    3            CASE (%KL_HNDLRPARM_RES);

     1719    17538    3               NETCON_DISP = NETCON_VAL;

  17538  4 006307   200365 471500                    LDP1    @NETCON_VAL,,AUTO
         4 006310   003100 061500                    CSR     bolr='003'O
         4 006311   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 006312   200367 000044                    BDSC    NETCON_DISP,,AUTO        by=0,bit=0,n=36

     1720    17539    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);

  17539  4 006313   200361 473500                    LDP3    @PARMTYPE,,AUTO
         4 006314   300000 720100                    LXL0    0,,PR3
         4 006315   000000 474410 xsym               LDP4    KS_TBL,X0
         4 006316   000000 235100                    LDA     0,,PR0
         4 006317   000002 735000                    ALS     2
         4 006320   400003 235105                    LDA     3,AL,PR4
         4 006321   200373 755100                    STA     DEFAULT,,AUTO

     1721    17540    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);

  17540  4 006322   300000 720100                    LXL0    0,,PR3
         4 006323   000000 474410 xsym               LDP4    KS_TBL,X0
         4 006324   000000 235100                    LDA     0,,PR0
         4 006325   000002 735000                    ALS     2
         4 006326   400002 236105                    LDQ     2,AL,PR4
         4 006327   777777 376007                    ANQ     -1,DL
         4 006330   200374 756100                    STQ     MIN,,AUTO

     1722    17541    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);

  17541  4 006331   300000 720100                    LXL0    0,,PR3
         4 006332   000000 474410 xsym               LDP4    KS_TBL,X0
         4 006333   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:260  
         4 006334   000002 735000                    ALS     2
         4 006335   400002 236105                    LDQ     2,AL,PR4
         4 006336   000022 772000                    QRL     18
         4 006337   200375 756100                    STQ     MAX,,AUTO

     1723    17542    3                 IF NO_CURRENT_VAL THEN

  17542  4 006340   200366 474500                    LDP4    @NO_CURRENT_VAL,,AUTO
         4 006341   400000 234100                    SZN     0,,PR4
         4 006342   006347 605000 4                  TPL     s:17544

     1724    17543    3                    CURRENT_VAL = 32;

  17543  4 006343   200364 475500                    LDP5    @CURRENT_VAL,,AUTO
         4 006344   000100 101400                    MRL     fill='000'O
         4 006345   000375 000004 5                  ADSC9   253                      cn=0,n=4
         4 006346   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2

     1725    17544    3               CALL KSW$WRITE (VECTOR(RES_FMT),

  17544  4 006347   300000 720100                    LXL0    0,,PR3
         4 006350   000000 475410 xsym               LDP5    KS_TBL,X0
         4 006351   000000 235100                    LDA     0,,PR0
         4 006352   000002 735000                    ALS     2
         4 006353   500000 476505                    LDP6    0,AL,PR5
         4 006354   000100 101500                    MRL     fill='000'O
         4 006355   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         4 006356   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 006357   200376 220100                    LDX0    MAX+1,,AUTO
         4 006360   000001 621010                    EAX1    1,X0
         4 006361   000000 635011                    EAA     0,X1
         4 006362   000002 771000                    ARL     2
         4 006363   000140 135007                    SBLA    96,DL
         4 006364   200377 456500                    STP6    MAX+2,,AUTO
         4 006365   200377 236100                    LDQ     MAX+2,,AUTO
         4 006366   200400 757100                    STAQ    MAX+3,,AUTO
         4 006367   377640 235007                    LDA     130976,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:261  
         4 006370   200364 236100                    LDQ     @CURRENT_VAL,,AUTO
         4 006371   200402 757100                    STAQ    MAX+5,,AUTO
         4 006372   777640 235007                    LDA     -96,DL
         4 006373   200404 452500                    STP2    MAX+7,,AUTO
         4 006374   200404 236100                    LDQ     MAX+7,,AUTO
         4 006375   000367 036003                    ADLQ    247,DU
         4 006376   200406 757100                    STAQ    MAX+9,,AUTO
         4 006377   777640 235007                    LDA     -96,DL
         4 006400   200410 452500                    STP2    MAX+11,,AUTO
         4 006401   200410 236100                    LDQ     MAX+11,,AUTO
         4 006402   000373 036003                    ADLQ    251,DU
         4 006403   200412 757100                    STAQ    MAX+13,,AUTO
         4 006404   777640 235007                    LDA     -96,DL
         4 006405   200414 452500                    STP2    MAX+15,,AUTO
         4 006406   200414 236100                    LDQ     MAX+15,,AUTO
         4 006407   000374 036003                    ADLQ    252,DU
         4 006410   200416 757100                    STAQ    MAX+17,,AUTO
         4 006411   777640 235007                    LDA     -96,DL
         4 006412   200420 452500                    STP2    MAX+19,,AUTO
         4 006413   200420 236100                    LDQ     MAX+19,,AUTO
         4 006414   000375 036003                    ADLQ    253,DU
         4 006415   200424 757100                    STAQ    MAX+23,,AUTO
         4 006416   200400 237100                    LDAQ    MAX+3,,AUTO
         4 006417   200422 757100                    STAQ    MAX+21,,AUTO
         4 006420   200402 237100                    LDAQ    MAX+5,,AUTO
         4 006421   200426 757100                    STAQ    MAX+25,,AUTO
         4 006422   200406 237100                    LDAQ    MAX+9,,AUTO
         4 006423   200430 757100                    STAQ    MAX+27,,AUTO
         4 006424   200412 237100                    LDAQ    MAX+13,,AUTO
         4 006425   200432 757100                    STAQ    MAX+29,,AUTO
         4 006426   200416 237100                    LDAQ    MAX+17,,AUTO
         4 006427   200434 757100                    STAQ    MAX+31,,AUTO
         4 006430   200424 237100                    LDAQ    MAX+23,,AUTO
         4 006431   200436 757100                    STAQ    MAX+33,,AUTO
         4 006432   200436 635500                    EPPR5   MAX+33,,AUTO
         4 006433   200446 455500                    STP5    MAX+41,,AUTO
         4 006434   200434 637500                    EPPR7   MAX+31,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:262  
         4 006435   200445 457500                    STP7    MAX+40,,AUTO
         4 006436   200432 630500                    EPPR0   MAX+29,,AUTO
         4 006437   200444 450500                    STP0    MAX+39,,AUTO
         4 006440   200430 630500                    EPPR0   MAX+27,,AUTO
         4 006441   200443 450500                    STP0    MAX+38,,AUTO
         4 006442   200426 630500                    EPPR0   MAX+25,,AUTO
         4 006443   200442 450500                    STP0    MAX+37,,AUTO
         4 006444   200422 630500                    EPPR0   MAX+21,,AUTO
         4 006445   200441 450500                    STP0    MAX+36,,AUTO
         4 006446   000400 236000 5                  LDQ     256
         4 006447   200440 756100                    STQ     MAX+35,,AUTO
         4 006450   200440 630500                    EPPR0   MAX+35,,AUTO
         4 006451   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 006452   000000 701000 xent               TSX1    KSW$WRITE
         4 006453   000000 011000                    NOP     0
         4 006454   007471 710000 4                  TRA     s:17616

     1726    17545    3                              VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME)
             17545                                        ,
     1727    17546    3                               VECTOR(CURRENT_VAL),
     1728    17547    3                               VECTOR(NETCON_DISP),
     1729    17548    3                               VECTOR(DEFAULT),
     1730    17549    3                               VECTOR(MIN),
     1731    17550    3                               VECTOR(MAX));
     1732    17551    3            CASE (%KL_HNDLRPARM_ATTR,%KL_HNDLRPARM_MMRINTCHC);

     1733    17552    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);

  17552  4 006455   200372 631500                    EPPR1   CURRENT_DISP,,AUTO
         4 006456   200377 451500                    STP1    MAX+2,,AUTO
         4 006457   200364 236100                    LDQ     @CURRENT_VAL,,AUTO
         4 006460   200376 756100                    STQ     MAX+1,,AUTO
         4 006461   200376 630500                    EPPR0   MAX+1,,AUTO
         4 006462   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006463   000000 701000 xent               TSX1    KSU$PACK2
         4 006464   000000 011000                    NOP     0

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:263  
     1734    17553    3               NETCON_DISP = NETCON_VAL;

  17553  4 006465   200365 470500                    LDP0    @NETCON_VAL,,AUTO
         4 006466   003100 061500                    CSR     bolr='003'O
         4 006467   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         4 006470   200367 000044                    BDSC    NETCON_DISP,,AUTO        by=0,bit=0,n=36

     1735    17554    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);

  17554  4 006471   200361 471500                    LDP1    @PARMTYPE,,AUTO
         4 006472   100000 720100                    LXL0    0,,PR1
         4 006473   000000 473410 xsym               LDP3    KS_TBL,X0
         4 006474   200362 474500                    LDP4    @PARMX,,AUTO
         4 006475   400000 235100                    LDA     0,,PR4
         4 006476   000002 735000                    ALS     2
         4 006477   300003 235105                    LDA     3,AL,PR3
         4 006500   200373 755100                    STA     DEFAULT,,AUTO

     1736    17555    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);

  17555  4 006501   100000 720100                    LXL0    0,,PR1
         4 006502   000000 473410 xsym               LDP3    KS_TBL,X0
         4 006503   400000 235100                    LDA     0,,PR4
         4 006504   000002 735000                    ALS     2
         4 006505   300002 236105                    LDQ     2,AL,PR3
         4 006506   777777 376007                    ANQ     -1,DL
         4 006507   200374 756100                    STQ     MIN,,AUTO

     1737    17556    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);

  17556  4 006510   100000 720100                    LXL0    0,,PR1
         4 006511   000000 473410 xsym               LDP3    KS_TBL,X0
         4 006512   400000 235100                    LDA     0,,PR4
         4 006513   000002 735000                    ALS     2
         4 006514   300002 236105                    LDQ     2,AL,PR3
         4 006515   000022 772000                    QRL     18
         4 006516   200375 756100                    STQ     MAX,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:264  

     1738    17557    3              IF NO_CURRENT_VAL THEN

  17557  4 006517   200366 473500                    LDP3    @NO_CURRENT_VAL,,AUTO
         4 006520   300000 234100                    SZN     0,,PR3
         4 006521   006621 605000 4                  TPL     s:17565

     1739    17558    3                 CALL KSW$WRITE (VECTOR(ATTR_NO_CURR_FMT),

  17558  4 006522   100000 720100                    LXL0    0,,PR1
         4 006523   000000 475410 xsym               LDP5    KS_TBL,X0
         4 006524   400000 235100                    LDA     0,,PR4
         4 006525   000002 735000                    ALS     2
         4 006526   500000 476505                    LDP6    0,AL,PR5
         4 006527   000100 101500                    MRL     fill='000'O
         4 006530   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         4 006531   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 006532   200376 220100                    LDX0    MAX+1,,AUTO
         4 006533   000001 621010                    EAX1    1,X0
         4 006534   000000 635011                    EAA     0,X1
         4 006535   000002 771000                    ARL     2
         4 006536   000140 135007                    SBLA    96,DL
         4 006537   200377 456500                    STP6    MAX+2,,AUTO
         4 006540   200377 236100                    LDQ     MAX+2,,AUTO
         4 006541   200400 757100                    STAQ    MAX+3,,AUTO
         4 006542   777640 235007                    LDA     -96,DL
         4 006543   200402 452500                    STP2    MAX+5,,AUTO
         4 006544   200402 236100                    LDQ     MAX+5,,AUTO
         4 006545   000367 036003                    ADLQ    247,DU
         4 006546   200404 757100                    STAQ    MAX+7,,AUTO
         4 006547   777640 235007                    LDA     -96,DL
         4 006550   200406 452500                    STP2    MAX+9,,AUTO
         4 006551   200406 236100                    LDQ     MAX+9,,AUTO
         4 006552   000373 036003                    ADLQ    251,DU
         4 006553   200410 757100                    STAQ    MAX+11,,AUTO
         4 006554   777640 235007                    LDA     -96,DL
         4 006555   200412 452500                    STP2    MAX+13,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:265  
         4 006556   200412 236100                    LDQ     MAX+13,,AUTO
         4 006557   000374 036003                    ADLQ    252,DU
         4 006560   200414 757100                    STAQ    MAX+15,,AUTO
         4 006561   777640 235007                    LDA     -96,DL
         4 006562   200416 452500                    STP2    MAX+17,,AUTO
         4 006563   200416 236100                    LDQ     MAX+17,,AUTO
         4 006564   000375 036003                    ADLQ    253,DU
         4 006565   200422 757100                    STAQ    MAX+21,,AUTO
         4 006566   200400 237100                    LDAQ    MAX+3,,AUTO
         4 006567   200420 757100                    STAQ    MAX+19,,AUTO
         4 006570   200404 237100                    LDAQ    MAX+7,,AUTO
         4 006571   200424 757100                    STAQ    MAX+23,,AUTO
         4 006572   200410 237100                    LDAQ    MAX+11,,AUTO
         4 006573   200426 757100                    STAQ    MAX+25,,AUTO
         4 006574   200414 237100                    LDAQ    MAX+15,,AUTO
         4 006575   200430 757100                    STAQ    MAX+27,,AUTO
         4 006576   200422 237100                    LDAQ    MAX+21,,AUTO
         4 006577   200432 757100                    STAQ    MAX+29,,AUTO
         4 006600   200432 635500                    EPPR5   MAX+29,,AUTO
         4 006601   200441 455500                    STP5    MAX+36,,AUTO
         4 006602   200430 637500                    EPPR7   MAX+27,,AUTO
         4 006603   200440 457500                    STP7    MAX+35,,AUTO
         4 006604   200426 630500                    EPPR0   MAX+25,,AUTO
         4 006605   200437 450500                    STP0    MAX+34,,AUTO
         4 006606   200424 630500                    EPPR0   MAX+23,,AUTO
         4 006607   200436 450500                    STP0    MAX+33,,AUTO
         4 006610   200420 630500                    EPPR0   MAX+19,,AUTO
         4 006611   200435 450500                    STP0    MAX+32,,AUTO
         4 006612   000404 236000 5                  LDQ     260
         4 006613   200434 756100                    STQ     MAX+31,,AUTO
         4 006614   200434 630500                    EPPR0   MAX+31,,AUTO
         4 006615   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 006616   000000 701000 xent               TSX1    KSW$WRITE
         4 006617   000000 011000                    NOP     0
         4 006620   007471 710000 4                  TRA     s:17616

     1740    17559    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:266  
             17559                                          NAME),
     1741    17560    3                                 VECTOR(NETCON_DISP),
     1742    17561    3                                 VECTOR(DEFAULT),
     1743    17562    3                                 VECTOR(MIN),
     1744    17563    3                                 VECTOR(MAX));
     1745    17564    3              ELSE
     1746    17565    3                  CALL KSW$WRITE (VECTOR(ATTR_FMT),

  17565  4 006621   100000 720100                    LXL0    0,,PR1
         4 006622   000000 475410 xsym               LDP5    KS_TBL,X0
         4 006623   400000 235100                    LDA     0,,PR4
         4 006624   000002 735000                    ALS     2
         4 006625   500000 476505                    LDP6    0,AL,PR5
         4 006626   000100 101500                    MRL     fill='000'O
         4 006627   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         4 006630   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 006631   200376 220100                    LDX0    MAX+1,,AUTO
         4 006632   000001 621010                    EAX1    1,X0
         4 006633   000000 635011                    EAA     0,X1
         4 006634   000002 771000                    ARL     2
         4 006635   000140 135007                    SBLA    96,DL
         4 006636   200377 456500                    STP6    MAX+2,,AUTO
         4 006637   200377 236100                    LDQ     MAX+2,,AUTO
         4 006640   200400 757100                    STAQ    MAX+3,,AUTO
         4 006641   777640 235007                    LDA     -96,DL
         4 006642   200402 452500                    STP2    MAX+5,,AUTO
         4 006643   200402 236100                    LDQ     MAX+5,,AUTO
         4 006644   000372 036003                    ADLQ    250,DU
         4 006645   200404 757100                    STAQ    MAX+7,,AUTO
         4 006646   777640 235007                    LDA     -96,DL
         4 006647   200406 452500                    STP2    MAX+9,,AUTO
         4 006650   200406 236100                    LDQ     MAX+9,,AUTO
         4 006651   000367 036003                    ADLQ    247,DU
         4 006652   200410 757100                    STAQ    MAX+11,,AUTO
         4 006653   777640 235007                    LDA     -96,DL
         4 006654   200412 452500                    STP2    MAX+13,,AUTO
         4 006655   200412 236100                    LDQ     MAX+13,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:267  
         4 006656   000373 036003                    ADLQ    251,DU
         4 006657   200414 757100                    STAQ    MAX+15,,AUTO
         4 006660   777640 235007                    LDA     -96,DL
         4 006661   200416 452500                    STP2    MAX+17,,AUTO
         4 006662   200416 236100                    LDQ     MAX+17,,AUTO
         4 006663   000374 036003                    ADLQ    252,DU
         4 006664   200420 757100                    STAQ    MAX+19,,AUTO
         4 006665   777640 235007                    LDA     -96,DL
         4 006666   200422 452500                    STP2    MAX+21,,AUTO
         4 006667   200422 236100                    LDQ     MAX+21,,AUTO
         4 006670   000375 036003                    ADLQ    253,DU
         4 006671   200426 757100                    STAQ    MAX+25,,AUTO
         4 006672   200400 237100                    LDAQ    MAX+3,,AUTO
         4 006673   200424 757100                    STAQ    MAX+23,,AUTO
         4 006674   200404 237100                    LDAQ    MAX+7,,AUTO
         4 006675   200430 757100                    STAQ    MAX+27,,AUTO
         4 006676   200410 237100                    LDAQ    MAX+11,,AUTO
         4 006677   200432 757100                    STAQ    MAX+29,,AUTO
         4 006700   200414 237100                    LDAQ    MAX+15,,AUTO
         4 006701   200434 757100                    STAQ    MAX+31,,AUTO
         4 006702   200420 237100                    LDAQ    MAX+19,,AUTO
         4 006703   200436 757100                    STAQ    MAX+33,,AUTO
         4 006704   200426 237100                    LDAQ    MAX+25,,AUTO
         4 006705   200440 757100                    STAQ    MAX+35,,AUTO
         4 006706   200440 635500                    EPPR5   MAX+35,,AUTO
         4 006707   200450 455500                    STP5    MAX+43,,AUTO
         4 006710   200436 637500                    EPPR7   MAX+33,,AUTO
         4 006711   200447 457500                    STP7    MAX+42,,AUTO
         4 006712   200434 630500                    EPPR0   MAX+31,,AUTO
         4 006713   200446 450500                    STP0    MAX+41,,AUTO
         4 006714   200432 630500                    EPPR0   MAX+29,,AUTO
         4 006715   200445 450500                    STP0    MAX+40,,AUTO
         4 006716   200430 630500                    EPPR0   MAX+27,,AUTO
         4 006717   200444 450500                    STP0    MAX+39,,AUTO
         4 006720   200424 630500                    EPPR0   MAX+23,,AUTO
         4 006721   200443 450500                    STP0    MAX+38,,AUTO
         4 006722   000410 236000 5                  LDQ     264
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:268  
         4 006723   200442 756100                    STQ     MAX+37,,AUTO
         4 006724   200442 630500                    EPPR0   MAX+37,,AUTO
         4 006725   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 006726   000000 701000 xent               TSX1    KSW$WRITE
         4 006727   000000 011000                    NOP     0
         4 006730   007471 710000 4                  TRA     s:17616

     1747    17566    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17566                                           NAME),
     1748    17567    3                                  VECTOR(CURRENT_DISP),
     1749    17568    3                                  VECTOR(NETCON_DISP),
     1750    17569    3                                  VECTOR(DEFAULT),
     1751    17570    3                                  VECTOR(MIN),
     1752    17571    3                                  VECTOR(MAX));
     1753    17572    3            CASE (%KL_HNDLRPARM_RCVCQBYTSIZ,%KL_HNDLRPARM_SNDCQBYTSIZ);

     1754    17573    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);

  17573  4 006731   200372 631500                    EPPR1   CURRENT_DISP,,AUTO
         4 006732   200377 451500                    STP1    MAX+2,,AUTO
         4 006733   200364 236100                    LDQ     @CURRENT_VAL,,AUTO
         4 006734   200376 756100                    STQ     MAX+1,,AUTO
         4 006735   200376 630500                    EPPR0   MAX+1,,AUTO
         4 006736   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 006737   000000 701000 xent               TSX1    KSU$PACK2
         4 006740   000000 011000                    NOP     0

     1755    17574    3                 CURRENT_DISP = CURRENT_DISP * 2;

  17574  4 006741   200372 235100                    LDA     CURRENT_DISP,,AUTO
         4 006742   000001 735000                    ALS     1
         4 006743   200372 755100                    STA     CURRENT_DISP,,AUTO

     1756    17575    3               NETCON_DISP = NETCON_VAL * 2;

  17575  4 006744   200365 470500                    LDP0    @NETCON_VAL,,AUTO
         4 006745   003100 061500                    CSR     bolr='003'O
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:269  
         4 006746   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         4 006747   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 006750   200376 236100                    LDQ     MAX+1,,AUTO
         4 006751   000001 736000                    QLS     1
         4 006752   200367 756100                    STQ     NETCON_DISP,,AUTO

     1757    17576    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX) * 2;

  17576  4 006753   200361 471500                    LDP1    @PARMTYPE,,AUTO
         4 006754   100000 720100                    LXL0    0,,PR1
         4 006755   000000 473410 xsym               LDP3    KS_TBL,X0
         4 006756   200362 474500                    LDP4    @PARMX,,AUTO
         4 006757   400000 235100                    LDA     0,,PR4
         4 006760   000002 735000                    ALS     2
         4 006761   300003 235105                    LDA     3,AL,PR3
         4 006762   000001 735000                    ALS     1
         4 006763   200373 755100                    STA     DEFAULT,,AUTO

     1758    17577    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX) * 2;

  17577  4 006764   100000 720100                    LXL0    0,,PR1
         4 006765   000000 473410 xsym               LDP3    KS_TBL,X0
         4 006766   400000 235100                    LDA     0,,PR4
         4 006767   000002 735000                    ALS     2
         4 006770   300002 236105                    LDQ     2,AL,PR3
         4 006771   000001 736000                    QLS     1
         4 006772   000411 376000 5                  ANQ     265
         4 006773   200374 756100                    STQ     MIN,,AUTO

     1759    17578    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX) * 2;

  17578  4 006774   100000 720100                    LXL0    0,,PR1
         4 006775   000000 473410 xsym               LDP3    KS_TBL,X0
         4 006776   400000 235100                    LDA     0,,PR4
         4 006777   000002 735000                    ALS     2
         4 007000   300002 236105                    LDQ     2,AL,PR3
         4 007001   000021 772000                    QRL     17
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:270  
         4 007002   000411 376000 5                  ANQ     265
         4 007003   200375 756100                    STQ     MAX,,AUTO

     1760    17579    3              IF NO_CURRENT_VAL THEN

  17579  4 007004   200366 473500                    LDP3    @NO_CURRENT_VAL,,AUTO
         4 007005   300000 234100                    SZN     0,,PR3
         4 007006   007106 605000 4                  TPL     s:17587

     1761    17580    3                 CALL KSW$WRITE (VECTOR(PARM_NO_CURR_FMT),

  17580  4 007007   100000 720100                    LXL0    0,,PR1
         4 007010   000000 475410 xsym               LDP5    KS_TBL,X0
         4 007011   400000 235100                    LDA     0,,PR4
         4 007012   000002 735000                    ALS     2
         4 007013   500000 476505                    LDP6    0,AL,PR5
         4 007014   000100 101500                    MRL     fill='000'O
         4 007015   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         4 007016   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 007017   200376 220100                    LDX0    MAX+1,,AUTO
         4 007020   000001 621010                    EAX1    1,X0
         4 007021   000000 635011                    EAA     0,X1
         4 007022   000002 771000                    ARL     2
         4 007023   000140 135007                    SBLA    96,DL
         4 007024   200377 456500                    STP6    MAX+2,,AUTO
         4 007025   200377 236100                    LDQ     MAX+2,,AUTO
         4 007026   200400 757100                    STAQ    MAX+3,,AUTO
         4 007027   777640 235007                    LDA     -96,DL
         4 007030   200402 452500                    STP2    MAX+5,,AUTO
         4 007031   200402 236100                    LDQ     MAX+5,,AUTO
         4 007032   000367 036003                    ADLQ    247,DU
         4 007033   200404 757100                    STAQ    MAX+7,,AUTO
         4 007034   777640 235007                    LDA     -96,DL
         4 007035   200406 452500                    STP2    MAX+9,,AUTO
         4 007036   200406 236100                    LDQ     MAX+9,,AUTO
         4 007037   000373 036003                    ADLQ    251,DU
         4 007040   200410 757100                    STAQ    MAX+11,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:271  
         4 007041   777640 235007                    LDA     -96,DL
         4 007042   200412 452500                    STP2    MAX+13,,AUTO
         4 007043   200412 236100                    LDQ     MAX+13,,AUTO
         4 007044   000374 036003                    ADLQ    252,DU
         4 007045   200414 757100                    STAQ    MAX+15,,AUTO
         4 007046   777640 235007                    LDA     -96,DL
         4 007047   200416 452500                    STP2    MAX+17,,AUTO
         4 007050   200416 236100                    LDQ     MAX+17,,AUTO
         4 007051   000375 036003                    ADLQ    253,DU
         4 007052   200422 757100                    STAQ    MAX+21,,AUTO
         4 007053   200400 237100                    LDAQ    MAX+3,,AUTO
         4 007054   200420 757100                    STAQ    MAX+19,,AUTO
         4 007055   200404 237100                    LDAQ    MAX+7,,AUTO
         4 007056   200424 757100                    STAQ    MAX+23,,AUTO
         4 007057   200410 237100                    LDAQ    MAX+11,,AUTO
         4 007060   200426 757100                    STAQ    MAX+25,,AUTO
         4 007061   200414 237100                    LDAQ    MAX+15,,AUTO
         4 007062   200430 757100                    STAQ    MAX+27,,AUTO
         4 007063   200422 237100                    LDAQ    MAX+21,,AUTO
         4 007064   200432 757100                    STAQ    MAX+29,,AUTO
         4 007065   200432 635500                    EPPR5   MAX+29,,AUTO
         4 007066   200441 455500                    STP5    MAX+36,,AUTO
         4 007067   200430 637500                    EPPR7   MAX+27,,AUTO
         4 007070   200440 457500                    STP7    MAX+35,,AUTO
         4 007071   200426 630500                    EPPR0   MAX+25,,AUTO
         4 007072   200437 450500                    STP0    MAX+34,,AUTO
         4 007073   200424 630500                    EPPR0   MAX+23,,AUTO
         4 007074   200436 450500                    STP0    MAX+33,,AUTO
         4 007075   200420 630500                    EPPR0   MAX+19,,AUTO
         4 007076   200435 450500                    STP0    MAX+32,,AUTO
         4 007077   000414 236000 5                  LDQ     268
         4 007100   200434 756100                    STQ     MAX+31,,AUTO
         4 007101   200434 630500                    EPPR0   MAX+31,,AUTO
         4 007102   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 007103   000000 701000 xent               TSX1    KSW$WRITE
         4 007104   000000 011000                    NOP     0
         4 007105   007471 710000 4                  TRA     s:17616
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:272  

     1762    17581    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17581                                          NAME),
     1763    17582    3                                 VECTOR(NETCON_DISP),
     1764    17583    3                                 VECTOR(DEFAULT),
     1765    17584    3                                 VECTOR(MIN),
     1766    17585    3                                 VECTOR(MAX));
     1767    17586    3              ELSE
     1768    17587    3                  CALL KSW$WRITE (VECTOR(PARM_FMT),

  17587  4 007106   100000 720100                    LXL0    0,,PR1
         4 007107   000000 475410 xsym               LDP5    KS_TBL,X0
         4 007110   400000 235100                    LDA     0,,PR4
         4 007111   000002 735000                    ALS     2
         4 007112   500000 476505                    LDP6    0,AL,PR5
         4 007113   000100 101500                    MRL     fill='000'O
         4 007114   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         4 007115   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 007116   200376 220100                    LDX0    MAX+1,,AUTO
         4 007117   000001 621010                    EAX1    1,X0
         4 007120   000000 635011                    EAA     0,X1
         4 007121   000002 771000                    ARL     2
         4 007122   000140 135007                    SBLA    96,DL
         4 007123   200377 456500                    STP6    MAX+2,,AUTO
         4 007124   200377 236100                    LDQ     MAX+2,,AUTO
         4 007125   200400 757100                    STAQ    MAX+3,,AUTO
         4 007126   777640 235007                    LDA     -96,DL
         4 007127   200402 452500                    STP2    MAX+5,,AUTO
         4 007130   200402 236100                    LDQ     MAX+5,,AUTO
         4 007131   000372 036003                    ADLQ    250,DU
         4 007132   200404 757100                    STAQ    MAX+7,,AUTO
         4 007133   777640 235007                    LDA     -96,DL
         4 007134   200406 452500                    STP2    MAX+9,,AUTO
         4 007135   200406 236100                    LDQ     MAX+9,,AUTO
         4 007136   000367 036003                    ADLQ    247,DU
         4 007137   200410 757100                    STAQ    MAX+11,,AUTO
         4 007140   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:273  
         4 007141   200412 452500                    STP2    MAX+13,,AUTO
         4 007142   200412 236100                    LDQ     MAX+13,,AUTO
         4 007143   000373 036003                    ADLQ    251,DU
         4 007144   200414 757100                    STAQ    MAX+15,,AUTO
         4 007145   777640 235007                    LDA     -96,DL
         4 007146   200416 452500                    STP2    MAX+17,,AUTO
         4 007147   200416 236100                    LDQ     MAX+17,,AUTO
         4 007150   000374 036003                    ADLQ    252,DU
         4 007151   200420 757100                    STAQ    MAX+19,,AUTO
         4 007152   777640 235007                    LDA     -96,DL
         4 007153   200422 452500                    STP2    MAX+21,,AUTO
         4 007154   200422 236100                    LDQ     MAX+21,,AUTO
         4 007155   000375 036003                    ADLQ    253,DU
         4 007156   200426 757100                    STAQ    MAX+25,,AUTO
         4 007157   200400 237100                    LDAQ    MAX+3,,AUTO
         4 007160   200424 757100                    STAQ    MAX+23,,AUTO
         4 007161   200404 237100                    LDAQ    MAX+7,,AUTO
         4 007162   200430 757100                    STAQ    MAX+27,,AUTO
         4 007163   200410 237100                    LDAQ    MAX+11,,AUTO
         4 007164   200432 757100                    STAQ    MAX+29,,AUTO
         4 007165   200414 237100                    LDAQ    MAX+15,,AUTO
         4 007166   200434 757100                    STAQ    MAX+31,,AUTO
         4 007167   200420 237100                    LDAQ    MAX+19,,AUTO
         4 007170   200436 757100                    STAQ    MAX+33,,AUTO
         4 007171   200426 237100                    LDAQ    MAX+25,,AUTO
         4 007172   200440 757100                    STAQ    MAX+35,,AUTO
         4 007173   200440 635500                    EPPR5   MAX+35,,AUTO
         4 007174   200450 455500                    STP5    MAX+43,,AUTO
         4 007175   200436 637500                    EPPR7   MAX+33,,AUTO
         4 007176   200447 457500                    STP7    MAX+42,,AUTO
         4 007177   200434 630500                    EPPR0   MAX+31,,AUTO
         4 007200   200446 450500                    STP0    MAX+41,,AUTO
         4 007201   200432 630500                    EPPR0   MAX+29,,AUTO
         4 007202   200445 450500                    STP0    MAX+40,,AUTO
         4 007203   200430 630500                    EPPR0   MAX+27,,AUTO
         4 007204   200444 450500                    STP0    MAX+39,,AUTO
         4 007205   200424 630500                    EPPR0   MAX+23,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:274  
         4 007206   200443 450500                    STP0    MAX+38,,AUTO
         4 007207   000420 236000 5                  LDQ     272
         4 007210   200442 756100                    STQ     MAX+37,,AUTO
         4 007211   200442 630500                    EPPR0   MAX+37,,AUTO
         4 007212   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 007213   000000 701000 xent               TSX1    KSW$WRITE
         4 007214   000000 011000                    NOP     0
         4 007215   007471 710000 4                  TRA     s:17616

     1769    17588    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17588                                           NAME),
     1770    17589    3                                  VECTOR(CURRENT_DISP),
     1771    17590    3                                  VECTOR(NETCON_DISP),
     1772    17591    3                                  VECTOR(DEFAULT),
     1773    17592    3                                  VECTOR(MIN),
     1774    17593    3                                  VECTOR(MAX));
     1775    17594    3            CASE (ELSE);

     1776    17595    3               CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);

  17595  4 007216   200372 631500                    EPPR1   CURRENT_DISP,,AUTO
         4 007217   200377 451500                    STP1    MAX+2,,AUTO
         4 007220   200364 236100                    LDQ     @CURRENT_VAL,,AUTO
         4 007221   200376 756100                    STQ     MAX+1,,AUTO
         4 007222   200376 630500                    EPPR0   MAX+1,,AUTO
         4 007223   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007224   000000 701000 xent               TSX1    KSU$PACK2
         4 007225   000000 011000                    NOP     0

     1777    17596    3               NETCON_DISP = NETCON_VAL;

  17596  4 007226   200365 470500                    LDP0    @NETCON_VAL,,AUTO
         4 007227   003100 061500                    CSR     bolr='003'O
         4 007230   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         4 007231   200367 000044                    BDSC    NETCON_DISP,,AUTO        by=0,bit=0,n=36

     1778    17597    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:275  

  17597  4 007232   200361 471500                    LDP1    @PARMTYPE,,AUTO
         4 007233   100000 720100                    LXL0    0,,PR1
         4 007234   000000 473410 xsym               LDP3    KS_TBL,X0
         4 007235   200362 474500                    LDP4    @PARMX,,AUTO
         4 007236   400000 235100                    LDA     0,,PR4
         4 007237   000002 735000                    ALS     2
         4 007240   300003 235105                    LDA     3,AL,PR3
         4 007241   200373 755100                    STA     DEFAULT,,AUTO

     1779    17598    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);

  17598  4 007242   100000 720100                    LXL0    0,,PR1
         4 007243   000000 473410 xsym               LDP3    KS_TBL,X0
         4 007244   400000 235100                    LDA     0,,PR4
         4 007245   000002 735000                    ALS     2
         4 007246   300002 236105                    LDQ     2,AL,PR3
         4 007247   777777 376007                    ANQ     -1,DL
         4 007250   200374 756100                    STQ     MIN,,AUTO

     1780    17599    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);

  17599  4 007251   100000 720100                    LXL0    0,,PR1
         4 007252   000000 473410 xsym               LDP3    KS_TBL,X0
         4 007253   400000 235100                    LDA     0,,PR4
         4 007254   000002 735000                    ALS     2
         4 007255   300002 236105                    LDQ     2,AL,PR3
         4 007256   000022 772000                    QRL     18
         4 007257   200375 756100                    STQ     MAX,,AUTO

     1781    17600    3              IF NO_CURRENT_VAL THEN

  17600  4 007260   200366 473500                    LDP3    @NO_CURRENT_VAL,,AUTO
         4 007261   300000 234100                    SZN     0,,PR3
         4 007262   007362 605000 4                  TPL     s:17608

     1782    17601    3                 CALL KSW$WRITE (VECTOR(PARM_NO_CURR_FMT),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:276  

  17601  4 007263   100000 720100                    LXL0    0,,PR1
         4 007264   000000 475410 xsym               LDP5    KS_TBL,X0
         4 007265   400000 235100                    LDA     0,,PR4
         4 007266   000002 735000                    ALS     2
         4 007267   500000 476505                    LDP6    0,AL,PR5
         4 007270   000100 101500                    MRL     fill='000'O
         4 007271   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         4 007272   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 007273   200376 220100                    LDX0    MAX+1,,AUTO
         4 007274   000001 621010                    EAX1    1,X0
         4 007275   000000 635011                    EAA     0,X1
         4 007276   000002 771000                    ARL     2
         4 007277   000140 135007                    SBLA    96,DL
         4 007300   200377 456500                    STP6    MAX+2,,AUTO
         4 007301   200377 236100                    LDQ     MAX+2,,AUTO
         4 007302   200400 757100                    STAQ    MAX+3,,AUTO
         4 007303   777640 235007                    LDA     -96,DL
         4 007304   200402 452500                    STP2    MAX+5,,AUTO
         4 007305   200402 236100                    LDQ     MAX+5,,AUTO
         4 007306   000367 036003                    ADLQ    247,DU
         4 007307   200404 757100                    STAQ    MAX+7,,AUTO
         4 007310   777640 235007                    LDA     -96,DL
         4 007311   200406 452500                    STP2    MAX+9,,AUTO
         4 007312   200406 236100                    LDQ     MAX+9,,AUTO
         4 007313   000373 036003                    ADLQ    251,DU
         4 007314   200410 757100                    STAQ    MAX+11,,AUTO
         4 007315   777640 235007                    LDA     -96,DL
         4 007316   200412 452500                    STP2    MAX+13,,AUTO
         4 007317   200412 236100                    LDQ     MAX+13,,AUTO
         4 007320   000374 036003                    ADLQ    252,DU
         4 007321   200414 757100                    STAQ    MAX+15,,AUTO
         4 007322   777640 235007                    LDA     -96,DL
         4 007323   200416 452500                    STP2    MAX+17,,AUTO
         4 007324   200416 236100                    LDQ     MAX+17,,AUTO
         4 007325   000375 036003                    ADLQ    253,DU
         4 007326   200422 757100                    STAQ    MAX+21,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:277  
         4 007327   200400 237100                    LDAQ    MAX+3,,AUTO
         4 007330   200420 757100                    STAQ    MAX+19,,AUTO
         4 007331   200404 237100                    LDAQ    MAX+7,,AUTO
         4 007332   200424 757100                    STAQ    MAX+23,,AUTO
         4 007333   200410 237100                    LDAQ    MAX+11,,AUTO
         4 007334   200426 757100                    STAQ    MAX+25,,AUTO
         4 007335   200414 237100                    LDAQ    MAX+15,,AUTO
         4 007336   200430 757100                    STAQ    MAX+27,,AUTO
         4 007337   200422 237100                    LDAQ    MAX+21,,AUTO
         4 007340   200432 757100                    STAQ    MAX+29,,AUTO
         4 007341   200432 635500                    EPPR5   MAX+29,,AUTO
         4 007342   200441 455500                    STP5    MAX+36,,AUTO
         4 007343   200430 637500                    EPPR7   MAX+27,,AUTO
         4 007344   200440 457500                    STP7    MAX+35,,AUTO
         4 007345   200426 630500                    EPPR0   MAX+25,,AUTO
         4 007346   200437 450500                    STP0    MAX+34,,AUTO
         4 007347   200424 630500                    EPPR0   MAX+23,,AUTO
         4 007350   200436 450500                    STP0    MAX+33,,AUTO
         4 007351   200420 630500                    EPPR0   MAX+19,,AUTO
         4 007352   200435 450500                    STP0    MAX+32,,AUTO
         4 007353   000414 236000 5                  LDQ     268
         4 007354   200434 756100                    STQ     MAX+31,,AUTO
         4 007355   200434 630500                    EPPR0   MAX+31,,AUTO
         4 007356   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 007357   000000 701000 xent               TSX1    KSW$WRITE
         4 007360   000000 011000                    NOP     0
         4 007361   007471 710000 4                  TRA     s:17616

     1783    17602    3                                 VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17602                                          NAME),
     1784    17603    3                                 VECTOR(NETCON_DISP),
     1785    17604    3                                 VECTOR(DEFAULT),
     1786    17605    3                                 VECTOR(MIN),
     1787    17606    3                                 VECTOR(MAX));
     1788    17607    3              ELSE
     1789    17608    3                  CALL KSW$WRITE (VECTOR(PARM_FMT),

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:278  
  17608  4 007362   100000 720100                    LXL0    0,,PR1
         4 007363   000000 475410 xsym               LDP5    KS_TBL,X0
         4 007364   400000 235100                    LDA     0,,PR4
         4 007365   000002 735000                    ALS     2
         4 007366   500000 476505                    LDP6    0,AL,PR5
         4 007367   000100 101500                    MRL     fill='000'O
         4 007370   600000 000001                    ADSC9   0,,PR6                   cn=0,n=1
         4 007371   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 007372   200376 220100                    LDX0    MAX+1,,AUTO
         4 007373   000001 621010                    EAX1    1,X0
         4 007374   000000 635011                    EAA     0,X1
         4 007375   000002 771000                    ARL     2
         4 007376   000140 135007                    SBLA    96,DL
         4 007377   200377 456500                    STP6    MAX+2,,AUTO
         4 007400   200377 236100                    LDQ     MAX+2,,AUTO
         4 007401   200400 757100                    STAQ    MAX+3,,AUTO
         4 007402   777640 235007                    LDA     -96,DL
         4 007403   200402 452500                    STP2    MAX+5,,AUTO
         4 007404   200402 236100                    LDQ     MAX+5,,AUTO
         4 007405   000372 036003                    ADLQ    250,DU
         4 007406   200404 757100                    STAQ    MAX+7,,AUTO
         4 007407   777640 235007                    LDA     -96,DL
         4 007410   200406 452500                    STP2    MAX+9,,AUTO
         4 007411   200406 236100                    LDQ     MAX+9,,AUTO
         4 007412   000367 036003                    ADLQ    247,DU
         4 007413   200410 757100                    STAQ    MAX+11,,AUTO
         4 007414   777640 235007                    LDA     -96,DL
         4 007415   200412 452500                    STP2    MAX+13,,AUTO
         4 007416   200412 236100                    LDQ     MAX+13,,AUTO
         4 007417   000373 036003                    ADLQ    251,DU
         4 007420   200414 757100                    STAQ    MAX+15,,AUTO
         4 007421   777640 235007                    LDA     -96,DL
         4 007422   200416 452500                    STP2    MAX+17,,AUTO
         4 007423   200416 236100                    LDQ     MAX+17,,AUTO
         4 007424   000374 036003                    ADLQ    252,DU
         4 007425   200420 757100                    STAQ    MAX+19,,AUTO
         4 007426   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:279  
         4 007427   200422 452500                    STP2    MAX+21,,AUTO
         4 007430   200422 236100                    LDQ     MAX+21,,AUTO
         4 007431   000375 036003                    ADLQ    253,DU
         4 007432   200426 757100                    STAQ    MAX+25,,AUTO
         4 007433   200400 237100                    LDAQ    MAX+3,,AUTO
         4 007434   200424 757100                    STAQ    MAX+23,,AUTO
         4 007435   200404 237100                    LDAQ    MAX+7,,AUTO
         4 007436   200430 757100                    STAQ    MAX+27,,AUTO
         4 007437   200410 237100                    LDAQ    MAX+11,,AUTO
         4 007440   200432 757100                    STAQ    MAX+29,,AUTO
         4 007441   200414 237100                    LDAQ    MAX+15,,AUTO
         4 007442   200434 757100                    STAQ    MAX+31,,AUTO
         4 007443   200420 237100                    LDAQ    MAX+19,,AUTO
         4 007444   200436 757100                    STAQ    MAX+33,,AUTO
         4 007445   200426 237100                    LDAQ    MAX+25,,AUTO
         4 007446   200440 757100                    STAQ    MAX+35,,AUTO
         4 007447   200440 635500                    EPPR5   MAX+35,,AUTO
         4 007450   200450 455500                    STP5    MAX+43,,AUTO
         4 007451   200436 637500                    EPPR7   MAX+33,,AUTO
         4 007452   200447 457500                    STP7    MAX+42,,AUTO
         4 007453   200434 630500                    EPPR0   MAX+31,,AUTO
         4 007454   200446 450500                    STP0    MAX+41,,AUTO
         4 007455   200432 630500                    EPPR0   MAX+29,,AUTO
         4 007456   200445 450500                    STP0    MAX+40,,AUTO
         4 007457   200430 630500                    EPPR0   MAX+27,,AUTO
         4 007460   200444 450500                    STP0    MAX+39,,AUTO
         4 007461   200424 630500                    EPPR0   MAX+23,,AUTO
         4 007462   200443 450500                    STP0    MAX+38,,AUTO
         4 007463   000420 236000 5                  LDQ     272
         4 007464   200442 756100                    STQ     MAX+37,,AUTO
         4 007465   200442 630500                    EPPR0   MAX+37,,AUTO
         4 007466   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 007467   000000 701000 xent               TSX1    KSW$WRITE
         4 007470   000000 011000                    NOP     0

     1790    17609    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17609                                           NAME),
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:280  
     1791    17610    3                                  VECTOR(CURRENT_DISP),
     1792    17611    3                                  VECTOR(NETCON_DISP),
     1793    17612    3                                  VECTOR(DEFAULT),
     1794    17613    3                                  VECTOR(MIN),
     1795    17614    3                                  VECTOR(MAX));
     1796    17615    3         END;

     1797    17616    2   END DISPARM;

  17616  4 007471   200360 221300                    LDX1  ! @CURRENT_VAL+1,,AUTO
         4 007472   000001 702211                    TSX2  ! 1,X1

     1798    17617    1   YESNO: PROC(FLAG,TEXT);

  17617  4 007473   200356 741300       YESNO        STX1  ! @INDX,,AUTO

     1799    17618
     1800    17619    2   DCL FLAG BIT(1) UNAL;
     1801    17620    2   DCL TEXT CHAR(4);
     1802    17621
     1803    17622    2           IF FLAG THEN

  17622  4 007474   200357 470500                    LDP0    @FLAG,,AUTO
         4 007475   000000 066500                    CMPB    filb='0'B
         4 007476   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         4 007477   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         4 007500   007506 600000 4                  TZE     s:17625

     1804    17623    2              TEXT = ' Yes';

  17623  4 007501   200360 471500                    LDP1    @TEXT,,AUTO
         4 007502   040100 100400                    MLR     fill='040'O
         4 007503   002750 000004 1                  ADSC9   PARM_DISPONLY_FMT+36     cn=0,n=4
         4 007504   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         4 007505   007512 710000 4                  TRA     s:17626

     1805    17624    2           ELSE
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:281  
     1806    17625    2              TEXT = '  No';

  17625  4 007506   200360 471500                    LDP1    @TEXT,,AUTO
         4 007507   040100 100400                    MLR     fill='040'O
         4 007510   002751 000004 1                  ADSC9   PARM_DISPONLY_FMT+37     cn=0,n=4
         4 007511   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4

     1807    17626    2           RETURN;

  17626  4 007512   200356 221300                    LDX1  ! @INDX,,AUTO
         4 007513   000001 702211                    TSX2  ! 1,X1

     1808    17627
     1809    17628    2   END YESNO;
     1810    17629    1   DISP_NONHAND_PARM: PROC (PARMTYPE,PARMX,CURRENT_VAL,NETCON_VAL,NO_CURRENT_VAL);

  17629  4 007514   200354 741300       DISP_NONHAN* STX1  ! SUBLK_INDX+1,,AUTO

     1811    17630
     1812    17631    2         DCL PARMTYPE   UBIN;
     1813    17632    2         DCL PARMX      UBIN;
     1814    17633    2         DCL CURRENT_VAL UBIN HALF HALIGNED;
     1815    17634    2         DCL CURRENT_DISP  UBIN;
     1816    17635    2         DCL NETCON_VAL UBIN;
     1817    17636    2        DCL NO_CURRENT_VAL BIT(1) ALIGNED;
     1818    17637    2         DCL DEFAULT    UBIN;
     1819    17638    2         DCL MIN        UBIN;
     1820    17639    2         DCL MAX        UBIN;
     1821    17640    2         DCL HDR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17640                  ' PARAMETER%20-CURRENT%30-:NETCON%40-DEFAULT%50-MINIMUM%60-MAXIMUM%10P');
     1822    17641    2         DCL PARM_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17641                  '%X%T%20-%D%30-%D%40-%D%50-%D%60-%D%10P');
     1823    17642    2         DCL PARM_NO_CURR_FMT CONSTANT CHAR(0) ALIGNED INIT(
             17642                  '%X%T%30-%D%40-%D%50-%D%60-%D%10P');
     1824    17643    2         DCL PARM_DISPONLY_FMT CONSTANT CHAR(0) ALIGNED INIT('%X%T%20-%D%10P  ');
     1825    17644
     1826    17645    2         IF FIRST_PARM AND
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:282  

  17645  4 007515   200067 234100                    SZN     FIRST_PARM,,AUTO
         4 007516   007540 605000 4                  TPL     s:17654
         4 007517   200355 470500                    LDP0    @PARMTYPE,,AUTO
         4 007520   000000 720100                    LXL0    0,,PR0
         4 007521   000000 471410 xsym               LDP1    KS_TBL,X0
         4 007522   200356 473500                    LDP3    @PARMX,,AUTO
         4 007523   300000 235100                    LDA     0,,PR3
         4 007524   000002 735000                    ALS     2
         4 007525   100001 236105                    LDQ     1,AL,PR1
         4 007526   010000 316003                    CANQ    4096,DU
         4 007527   007533 600000 4                  TZE     s:17649
         4 007530   200361 474500                    LDP4    @NO_CURRENT_VAL,,AUTO
         4 007531   400000 234100                    SZN     0,,PR4
         4 007532   007540 604000 4                  TMI     s:17654

     1827    17646    2            NOT (KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.DISPONLY(PARMX) AND
     1828    17647    2                 NO_CURRENT_VAL) THEN
     1829    17648    3            DO;

     1830    17649    3               CALL KSW$WRITE (VECTOR(HDR_FMT));

  17649  4 007533   000424 630400 5                  EPPR0   276
         4 007534   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 007535   000000 701000 xent               TSX1    KSW$WRITE
         4 007536   000000 011000                    NOP     0

     1831    17650    3               FIRST_PARM = '0'B;

  17650  4 007537   200067 450100                    STZ     FIRST_PARM,,AUTO

     1832    17651    3            END;

     1833    17652
     1834    17653
     1835    17654    2         CALL KSU$PACK2 (CURRENT_VAL,CURRENT_DISP);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:283  
  17654  4 007540   200362 630500                    EPPR0   CURRENT_DISP,,AUTO
         4 007541   200377 450500                    STP0    MAX+2,,AUTO
         4 007542   200357 236100                    LDQ     @CURRENT_VAL,,AUTO
         4 007543   200376 756100                    STQ     MAX+1,,AUTO
         4 007544   200376 630500                    EPPR0   MAX+1,,AUTO
         4 007545   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 007546   000000 701000 xent               TSX1    KSU$PACK2
         4 007547   000000 011000                    NOP     0

     1836    17655
     1837    17656    2         IF PARMX = %GI_CNTL_KEEPDELTA AND CURRENT_DISP > 0 THEN

  17656  4 007550   200356 470500                    LDP0    @PARMX,,AUTO
         4 007551   000000 235100                    LDA     0,,PR0
         4 007552   000016 115007                    CMPA    14,DL
         4 007553   007560 601000 4                  TNZ     s:17659
         4 007554   200362 236100                    LDQ     CURRENT_DISP,,AUTO
         4 007555   007560 600000 4                  TZE     s:17659

     1838    17657    2            CURRENT_DISP = 1;

  17657  4 007556   000001 235007                    LDA     1,DL
         4 007557   200362 755100                    STA     CURRENT_DISP,,AUTO

     1839    17658
     1840    17659    2         IF KS_TBL(PARMTYPE)->KS$PARAM.FLAGS.DISPONLY(PARMX) THEN

  17659  4 007560   200355 471500                    LDP1    @PARMTYPE,,AUTO
         4 007561   100000 720100                    LXL0    0,,PR1
         4 007562   000000 473410 xsym               LDP3    KS_TBL,X0
         4 007563   000000 235100                    LDA     0,,PR0
         4 007564   000002 735000                    ALS     2
         4 007565   300001 236105                    LDQ     1,AL,PR3
         4 007566   010000 316003                    CANQ    4096,DU
         4 007567   007635 600000 4                  TZE     s:17670

     1841    17660    3            DO;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:284  

     1842    17661    3               IF NO_CURRENT_VAL THEN

  17661  4 007570   200361 474500                    LDP4    @NO_CURRENT_VAL,,AUTO
         4 007571   400000 234100                    SZN     0,,PR4
         4 007572   007575 605000 4                  TPL     s:17664

     1843    17662    3                  RETURN;

  17662  4 007573   200354 221300                    LDX1  ! SUBLK_INDX+1,,AUTO
         4 007574   000001 702211                    TSX2  ! 1,X1

     1844    17663    3               ELSE
     1845    17664    3                  CALL KSW$WRITE (VECTOR(PARM_DISPONLY_FMT),

  17664  4 007575   300000 475505                    LDP5    0,AL,PR3
         4 007576   000100 101500                    MRL     fill='000'O
         4 007577   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         4 007600   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 007601   200376 220100                    LDX0    MAX+1,,AUTO
         4 007602   000001 621010                    EAX1    1,X0
         4 007603   000000 635011                    EAA     0,X1
         4 007604   000002 771000                    ARL     2
         4 007605   000140 135007                    SBLA    96,DL
         4 007606   200377 455500                    STP5    MAX+2,,AUTO
         4 007607   200377 236100                    LDQ     MAX+2,,AUTO
         4 007610   200400 757100                    STAQ    MAX+3,,AUTO
         4 007611   777640 235007                    LDA     -96,DL
         4 007612   200402 452500                    STP2    MAX+5,,AUTO
         4 007613   200402 236100                    LDQ     MAX+5,,AUTO
         4 007614   000362 036003                    ADLQ    242,DU
         4 007615   200406 757100                    STAQ    MAX+9,,AUTO
         4 007616   200400 237100                    LDAQ    MAX+3,,AUTO
         4 007617   200404 757100                    STAQ    MAX+7,,AUTO
         4 007620   200406 237100                    LDAQ    MAX+9,,AUTO
         4 007621   200410 757100                    STAQ    MAX+11,,AUTO
         4 007622   200410 633500                    EPPR3   MAX+11,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:285  
         4 007623   200414 453500                    STP3    MAX+15,,AUTO
         4 007624   200404 636500                    EPPR6   MAX+7,,AUTO
         4 007625   200413 456500                    STP6    MAX+14,,AUTO
         4 007626   000430 236000 5                  LDQ     280
         4 007627   200412 756100                    STQ     MAX+13,,AUTO
         4 007630   200412 630500                    EPPR0   MAX+13,,AUTO
         4 007631   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 007632   000000 701000 xent               TSX1    KSW$WRITE
         4 007633   000000 011000                    NOP     0

     1846    17665    3                       VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->NAME),
     1847    17666    3                       VECTOR(CURRENT_DISP));
     1848    17667    3            END;

  17667  4 007634   010062 710000 4                  TRA     s:17690

     1849    17668    2         ELSE
     1850    17669    3            DO;

     1851    17670    3               DEFAULT = KS_TBL(PARMTYPE)->KS$PARAM.DEFAULT(PARMX);

  17670  4 007635   300003 235105                    LDA     3,AL,PR3
         4 007636   200363 755100                    STA     DEFAULT,,AUTO

     1852    17671    3               MIN     = KS_TBL(PARMTYPE)->KS$PARAM.MIN(PARMX);

  17671  4 007637   100000 720100                    LXL0    0,,PR1
         4 007640   000000 473410 xsym               LDP3    KS_TBL,X0
         4 007641   000000 235100                    LDA     0,,PR0
         4 007642   000002 735000                    ALS     2
         4 007643   300002 236105                    LDQ     2,AL,PR3
         4 007644   777777 376007                    ANQ     -1,DL
         4 007645   200364 756100                    STQ     MIN,,AUTO

     1853    17672    3               MAX     = KS_TBL(PARMTYPE)->KS$PARAM.MAX(PARMX);

  17672  4 007646   100000 720100                    LXL0    0,,PR1
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:286  
         4 007647   000000 473410 xsym               LDP3    KS_TBL,X0
         4 007650   000000 235100                    LDA     0,,PR0
         4 007651   000002 735000                    ALS     2
         4 007652   300002 236105                    LDQ     2,AL,PR3
         4 007653   000022 772000                    QRL     18
         4 007654   200365 756100                    STQ     MAX,,AUTO

     1854    17673    3               IF NO_CURRENT_VAL THEN

  17673  4 007655   200361 473500                    LDP3    @NO_CURRENT_VAL,,AUTO
         4 007656   300000 234100                    SZN     0,,PR3
         4 007657   007755 605000 4                  TPL     s:17681

     1855    17674    3                  CALL KSW$WRITE (VECTOR(PARM_NO_CURR_FMT),

  17674  4 007660   100000 720100                    LXL0    0,,PR1
         4 007661   000000 474410 xsym               LDP4    KS_TBL,X0
         4 007662   000000 235100                    LDA     0,,PR0
         4 007663   000002 735000                    ALS     2
         4 007664   400000 475505                    LDP5    0,AL,PR4
         4 007665   000100 101500                    MRL     fill='000'O
         4 007666   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         4 007667   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 007670   200376 220100                    LDX0    MAX+1,,AUTO
         4 007671   000001 621010                    EAX1    1,X0
         4 007672   000000 635011                    EAA     0,X1
         4 007673   000002 771000                    ARL     2
         4 007674   000140 135007                    SBLA    96,DL
         4 007675   200377 455500                    STP5    MAX+2,,AUTO
         4 007676   200377 236100                    LDQ     MAX+2,,AUTO
         4 007677   200400 757100                    STAQ    MAX+3,,AUTO
         4 007700   777640 235007                    LDA     -96,DL
         4 007701   200360 236100                    LDQ     @NETCON_VAL,,AUTO
         4 007702   200402 757100                    STAQ    MAX+5,,AUTO
         4 007703   777640 235007                    LDA     -96,DL
         4 007704   200404 452500                    STP2    MAX+7,,AUTO
         4 007705   200404 236100                    LDQ     MAX+7,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:287  
         4 007706   000363 036003                    ADLQ    243,DU
         4 007707   200406 757100                    STAQ    MAX+9,,AUTO
         4 007710   777640 235007                    LDA     -96,DL
         4 007711   200410 452500                    STP2    MAX+11,,AUTO
         4 007712   200410 236100                    LDQ     MAX+11,,AUTO
         4 007713   000364 036003                    ADLQ    244,DU
         4 007714   200412 757100                    STAQ    MAX+13,,AUTO
         4 007715   777640 235007                    LDA     -96,DL
         4 007716   200414 452500                    STP2    MAX+15,,AUTO
         4 007717   200414 236100                    LDQ     MAX+15,,AUTO
         4 007720   000365 036003                    ADLQ    245,DU
         4 007721   200420 757100                    STAQ    MAX+19,,AUTO
         4 007722   200400 237100                    LDAQ    MAX+3,,AUTO
         4 007723   200416 757100                    STAQ    MAX+17,,AUTO
         4 007724   200402 237100                    LDAQ    MAX+5,,AUTO
         4 007725   200422 757100                    STAQ    MAX+21,,AUTO
         4 007726   200406 237100                    LDAQ    MAX+9,,AUTO
         4 007727   200424 757100                    STAQ    MAX+23,,AUTO
         4 007730   200412 237100                    LDAQ    MAX+13,,AUTO
         4 007731   200426 757100                    STAQ    MAX+25,,AUTO
         4 007732   200420 237100                    LDAQ    MAX+19,,AUTO
         4 007733   200430 757100                    STAQ    MAX+27,,AUTO
         4 007734   200430 634500                    EPPR4   MAX+27,,AUTO
         4 007735   200437 454500                    STP4    MAX+34,,AUTO
         4 007736   200426 636500                    EPPR6   MAX+25,,AUTO
         4 007737   200436 456500                    STP6    MAX+33,,AUTO
         4 007740   200424 637500                    EPPR7   MAX+23,,AUTO
         4 007741   200435 457500                    STP7    MAX+32,,AUTO
         4 007742   200422 630500                    EPPR0   MAX+21,,AUTO
         4 007743   200434 450500                    STP0    MAX+31,,AUTO
         4 007744   200416 630500                    EPPR0   MAX+17,,AUTO
         4 007745   200433 450500                    STP0    MAX+30,,AUTO
         4 007746   000434 236000 5                  LDQ     284
         4 007747   200432 756100                    STQ     MAX+29,,AUTO
         4 007750   200432 630500                    EPPR0   MAX+29,,AUTO
         4 007751   000024 631400 xsym               EPPR1   B_VECTNIL+20
         4 007752   000000 701000 xent               TSX1    KSW$WRITE
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:288  
         4 007753   000000 011000                    NOP     0
         4 007754   010062 710000 4                  TRA     s:17690

     1856    17675    3                                  VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17675                                           NAME),
     1857    17676    3                                  VECTOR(NETCON_VAL),
     1858    17677    3                                  VECTOR(DEFAULT),
     1859    17678    3                                  VECTOR(MIN),
     1860    17679    3                                  VECTOR(MAX));
     1861    17680    3               ELSE
     1862    17681    3                   CALL KSW$WRITE (VECTOR(PARM_FMT),

  17681  4 007755   100000 720100                    LXL0    0,,PR1
         4 007756   000000 474410 xsym               LDP4    KS_TBL,X0
         4 007757   000000 235100                    LDA     0,,PR0
         4 007760   000002 735000                    ALS     2
         4 007761   400000 475505                    LDP5    0,AL,PR4
         4 007762   000100 101500                    MRL     fill='000'O
         4 007763   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1
         4 007764   200376 000002                    ADSC9   MAX+1,,AUTO              cn=0,n=2
         4 007765   200376 220100                    LDX0    MAX+1,,AUTO
         4 007766   000001 621010                    EAX1    1,X0
         4 007767   000000 635011                    EAA     0,X1
         4 007770   000002 771000                    ARL     2
         4 007771   000140 135007                    SBLA    96,DL
         4 007772   200377 455500                    STP5    MAX+2,,AUTO
         4 007773   200377 236100                    LDQ     MAX+2,,AUTO
         4 007774   200400 757100                    STAQ    MAX+3,,AUTO
         4 007775   777640 235007                    LDA     -96,DL
         4 007776   200402 452500                    STP2    MAX+5,,AUTO
         4 007777   200402 236100                    LDQ     MAX+5,,AUTO
         4 010000   000362 036003                    ADLQ    242,DU
         4 010001   200404 757100                    STAQ    MAX+7,,AUTO
         4 010002   777640 235007                    LDA     -96,DL
         4 010003   200360 236100                    LDQ     @NETCON_VAL,,AUTO
         4 010004   200406 757100                    STAQ    MAX+9,,AUTO
         4 010005   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:289  
         4 010006   200410 452500                    STP2    MAX+11,,AUTO
         4 010007   200410 236100                    LDQ     MAX+11,,AUTO
         4 010010   000363 036003                    ADLQ    243,DU
         4 010011   200412 757100                    STAQ    MAX+13,,AUTO
         4 010012   777640 235007                    LDA     -96,DL
         4 010013   200414 452500                    STP2    MAX+15,,AUTO
         4 010014   200414 236100                    LDQ     MAX+15,,AUTO
         4 010015   000364 036003                    ADLQ    244,DU
         4 010016   200416 757100                    STAQ    MAX+17,,AUTO
         4 010017   777640 235007                    LDA     -96,DL
         4 010020   200420 452500                    STP2    MAX+19,,AUTO
         4 010021   200420 236100                    LDQ     MAX+19,,AUTO
         4 010022   000365 036003                    ADLQ    245,DU
         4 010023   200424 757100                    STAQ    MAX+23,,AUTO
         4 010024   200400 237100                    LDAQ    MAX+3,,AUTO
         4 010025   200422 757100                    STAQ    MAX+21,,AUTO
         4 010026   200404 237100                    LDAQ    MAX+7,,AUTO
         4 010027   200426 757100                    STAQ    MAX+25,,AUTO
         4 010030   200406 237100                    LDAQ    MAX+9,,AUTO
         4 010031   200430 757100                    STAQ    MAX+27,,AUTO
         4 010032   200412 237100                    LDAQ    MAX+13,,AUTO
         4 010033   200432 757100                    STAQ    MAX+29,,AUTO
         4 010034   200416 237100                    LDAQ    MAX+17,,AUTO
         4 010035   200434 757100                    STAQ    MAX+31,,AUTO
         4 010036   200424 237100                    LDAQ    MAX+23,,AUTO
         4 010037   200436 757100                    STAQ    MAX+33,,AUTO
         4 010040   200436 634500                    EPPR4   MAX+33,,AUTO
         4 010041   200446 454500                    STP4    MAX+41,,AUTO
         4 010042   200434 636500                    EPPR6   MAX+31,,AUTO
         4 010043   200445 456500                    STP6    MAX+40,,AUTO
         4 010044   200432 637500                    EPPR7   MAX+29,,AUTO
         4 010045   200444 457500                    STP7    MAX+39,,AUTO
         4 010046   200430 630500                    EPPR0   MAX+27,,AUTO
         4 010047   200443 450500                    STP0    MAX+38,,AUTO
         4 010050   200426 630500                    EPPR0   MAX+25,,AUTO
         4 010051   200442 450500                    STP0    MAX+37,,AUTO
         4 010052   200422 630500                    EPPR0   MAX+21,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:290  
         4 010053   200441 450500                    STP0    MAX+36,,AUTO
         4 010054   000440 236000 5                  LDQ     288
         4 010055   200440 756100                    STQ     MAX+35,,AUTO
         4 010056   200440 630500                    EPPR0   MAX+35,,AUTO
         4 010057   000025 631400 xsym               EPPR1   B_VECTNIL+21
         4 010060   000000 701000 xent               TSX1    KSW$WRITE
         4 010061   000000 011000                    NOP     0

     1863    17682    3                                   VECTOR(KS_TBL(PARMTYPE)->KS$PARAM.TEXTNAME(PARMX)->
             17682                                            NAME),
     1864    17683    3                                   VECTOR(CURRENT_DISP),
     1865    17684    3                                   VECTOR(NETCON_VAL),
     1866    17685    3                                   VECTOR(DEFAULT),
     1867    17686    3                                   VECTOR(MIN),
     1868    17687    3                                   VECTOR(MAX));
     1869    17688    3            END;

     1870    17689
     1871    17690    2   END DISP_NONHAND_PARM;

  17690  4 010062   200354 221300                    LDX1  ! SUBLK_INDX+1,,AUTO
         4 010063   000001 702211                    TSX2  ! 1,X1

     1872    17691        %EJECT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:291  
     1873    17692    1   DISPLAY_CHAN: PROC;

  17692  4 010064   200354 741300       DISPLAY_CHAN STX1  ! SUBLK_INDX+1,,AUTO

     1874    17693                    %ARRAY_TO_WORD(S="KH$CHN.ATTR",D="CHNTBL.ATTR");

  17694  4 010065   200226 630500                    EPPR0   CHNTBL+7,,AUTO
         4 010066   200216 450500                    STP0    D$,,AUTO

  17695  4 010067   200376 452500                    STP2    MAX+1,,AUTO
         4 010070   200376 236100                    LDQ     MAX+1,,AUTO
         4 010071   000441 036000 5                  ADLQ    289
         4 010072   200214 756100                    STQ     S$,,AUTO

  17696  4 010073   200226 450100                    STZ     CHNTBL+7,,AUTO

  17697  4 010074   000001 235007                    LDA     1,DL
         4 010075   200215 755100                    STA     BINDX,,AUTO

  17698  4 010076   200214 470500                    LDP0    S$,,AUTO
         4 010077   200215 235100                    LDA     BINDX,,AUTO
         4 010100   200216 471500                    LDP1    D$,,AUTO
         4 010101   003105 060505                    CSL     bolr='003'O
         4 010102   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 010103   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  17699  4 010104   000001 035007                    ADLA    1,DL
         4 010105   200215 755100                    STA     BINDX,,AUTO
         4 010106   000011 115007                    CMPA    9,DL
         4 010107   010076 602000 4                  TNC     s:17698

  17700  4 010110   000012 236007                    LDQ     10,DL
         4 010111   200215 756100                    STQ     BINDX,,AUTO

  17701  4 010112   200214 470500                    LDP0    S$,,AUTO
         4 010113   200215 235100                    LDA     BINDX,,AUTO
         4 010114   200216 471500                    LDP1    D$,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:292  
         4 010115   003105 060505                    CSL     bolr='003'O
         4 010116   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 010117   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  17702  4 010120   000001 035007                    ADLA    1,DL
         4 010121   200215 755100                    STA     BINDX,,AUTO
         4 010122   000022 115007                    CMPA    18,DL
         4 010123   010112 602000 4                  TNC     s:17701

  17703  4 010124   003100 061500                    CSR     bolr='003'O
         4 010125   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 010126   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 010127   200376 236100                    LDQ     MAX+1,,AUTO
         4 010130   200226 756100                    STQ     CHNTBL+7,,AUTO

     1875    17705    2               OPTION_SATISFIED = '1'B;

  17705  4 010131   400000 236003                    LDQ     -131072,DU
         4 010132   200065 756100                    STQ     OPTION_SATISFIED,,AUTO

     1876    17706    2               IF NOT ONE_CHAN_FLAG THEN

  17706  4 010133   200047 234100                    SZN     ONE_CHAN_FLAG,,AUTO
         4 010134   010262 604000 4                  TMI     s:17740

     1877    17707    3   OPT_LOOP:      DO I = %KS_DVCRES TO %KS_STATE;

  17707  4 010135   000003 235007       OPT_LOOP     LDA     3,DL
         4 010136   200075 755100                    STA     I,,AUTO

     1878    17708    3                     IF OPT.P$(I) = ADDR(NIL) THEN

  17708  4 010137   200075 235100                    LDA     I,,AUTO
         4 010140   000001 735000                    ALS     1
         4 010141   200050 236105                    LDQ     OPT,AL,AUTO
         4 010142   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 010143   010147 601000 4                  TNZ     s:17712
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:293  

     1879    17709    3                        OPTION_SATISFIED = '1'B;

  17709  4 010144   400000 236003                    LDQ     -131072,DU
         4 010145   200065 756100                    STQ     OPTION_SATISFIED,,AUTO
         4 010146   010253 710000 4                  TRA     s:17737

     1880    17710    3                     ELSE
     1881    17711    4                        DO;

     1882    17712    4                           OPTION_SATISFIED = '0'B;

  17712  4 010147   200065 450100                    STZ     OPTION_SATISFIED,,AUTO

     1883    17713    5   SUB_OPT_LOOP:           DO J = 0 TO OPT.LAST(I);

  17713  4 010150   200077 450100       SUB_OPT_LOOP STZ     J,,AUTO
         4 010151   010246 710000 4                  TRA     s:17735+3

     1884    17714    6                              DO CASE(I);

  17714  4 010152   200075 235100                    LDA     I,,AUTO
         4 010153   000006 115007                    CMPA    6,DL
         4 010154   010156 602005 4                  TNC     s:17714+4,AL
         4 010155   010243 710000 4                  TRA     s:17735
         4 010156   010243 710000 4                  TRA     s:17735
         4 010157   010243 710000 4                  TRA     s:17735
         4 010160   010243 710000 4                  TRA     s:17735
         4 010161   010164 710000 4                  TRA     s:17716
         4 010162   010202 710000 4                  TRA     s:17722
         4 010163   010224 710000 4                  TRA     s:17729

     1885    17715    6                                 CASE (%KS_DVCRES);

     1886    17716    6                                   IF KH$CHN.RESOURCE = OPT.P$(I)->OUT$BLK.SUBLK$(J)->
             17716                                             OUT$SYM.TEXT THEN

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:294  
  17716  4 010164   000001 735000                    ALS     1
         4 010165   200050 470505                    LDP0    OPT,AL,AUTO
         4 010166   200077 720100                    LXL0    J,,AUTO
         4 010167   000003 471510                    LDP1    3,X0,PR0
         4 010170   100004 236100                    LDQ     4,,PR1
         4 010171   000033 772000                    QRL     27
         4 010172   000000 621006                    EAX1    0,QL
         4 010173   040140 106500                    CMPC    fill='040'O
         4 010174   200016 000002                    ADSC9   KH$CHN+2,,AUTO           cn=0,n=2
         4 010175   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 010176   010243 601000 4                  TNZ     s:17735

     1887    17717    7                                       DO;

     1888    17718    7                                          OPTION_SATISFIED = '1'B;

  17718  4 010177   400000 236003                    LDQ     -131072,DU
         4 010200   200065 756100                    STQ     OPTION_SATISFIED,,AUTO

     1889    17719    7                                          EXIT SUB_OPT_LOOP;

  17719  4 010201   010253 710000 4                  TRA     s:17737

     1890    17720    7                                       END;
     1891    17721    6                                 CASE (%KS_DVCATTR);

     1892    17722    6                                    CALL KSU$HEXBIN (ATTR,OPT.P$(I)->OUT$BLK.SUBLK$(J)
             17722                                             ->OUT$BLK.SUBLK$(0));

  17722  4 010202   000001 735000                    ALS     1
         4 010203   200050 470505                    LDP0    OPT,AL,AUTO
         4 010204   200077 720100                    LXL0    J,,AUTO
         4 010205   000003 471510                    LDP1    3,X0,PR0
         4 010206   100003 633500                    EPPR3   3,,PR1
         4 010207   200377 453500                    STP3    MAX+2,,AUTO
         4 010210   200066 631500                    EPPR1   ATTR,,AUTO
         4 010211   200376 451500                    STP1    MAX+1,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:295  
         4 010212   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010213   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010214   000000 701000 xent               TSX1    KSU$HEXBIN
         4 010215   000000 011000                    NOP     0

     1893    17723    6                                    IF ATTR = CHNTBL.ATTR THEN

  17723  4 010216   200066 236100                    LDQ     ATTR,,AUTO
         4 010217   200226 116100                    CMPQ    CHNTBL+7,,AUTO
         4 010220   010243 601000 4                  TNZ     s:17735

     1894    17724    7                                       DO;

     1895    17725    7                                          OPTION_SATISFIED = '1'B;

  17725  4 010221   400000 236003                    LDQ     -131072,DU
         4 010222   200065 756100                    STQ     OPTION_SATISFIED,,AUTO

     1896    17726    7                                          EXIT SUB_OPT_LOOP;

  17726  4 010223   010253 710000 4                  TRA     s:17737

     1897    17727    7                                       END;
     1898    17728    6                                 CASE (%KS_STATE);

     1899    17729    6                                    IF KH$CHN.STT.BYT = OPT.P$(I)->OUT$BLK.SUBLK$(J)->
             17729                                             OUT$BLK.CODE THEN

  17729  4 010224   000001 735000                    ALS     1
         4 010225   200050 470505                    LDP0    OPT,AL,AUTO
         4 010226   200077 720100                    LXL0    J,,AUTO
         4 010227   000003 471510                    LDP1    3,X0,PR0
         4 010230   100000 236100                    LDQ     0,,PR1
         4 010231   777777 376007                    ANQ     -1,DL
         4 010232   200376 756100                    STQ     MAX+1,,AUTO
         4 010233   200014 236100                    LDQ     KH$CHN,,AUTO
         4 010234   000011 772000                    QRL     9
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:296  
         4 010235   000377 376007                    ANQ     255,DL
         4 010236   200376 116100                    CMPQ    MAX+1,,AUTO
         4 010237   010243 601000 4                  TNZ     s:17735

     1900    17730    7                                       DO;

     1901    17731    7                                          OPTION_SATISFIED = '1'B;

  17731  4 010240   400000 236003                    LDQ     -131072,DU
         4 010241   200065 756100                    STQ     OPTION_SATISFIED,,AUTO

     1902    17732    7                                          EXIT SUB_OPT_LOOP;

  17732  4 010242   010253 710000 4                  TRA     s:17737

     1903    17733    7                                       END;
     1904    17734    6                              END; /*CASE*/

     1905    17735    5                           END; /*SUB_OPT_LOOP*/

  17735  4 010243   200077 235100                    LDA     J,,AUTO
         4 010244   000001 035007                    ADLA    1,DL
         4 010245   200077 755100                    STA     J,,AUTO
         4 010246   200075 235100                    LDA     I,,AUTO
         4 010247   000001 735000                    ALS     1
         4 010250   200051 236105                    LDQ     OPT+1,AL,AUTO
         4 010251   200077 116100                    CMPQ    J,,AUTO
         4 010252   010152 603000 4                  TRC     s:17714

     1906    17736    4                        END;

     1907    17737    3                        IF  NOT OPTION_SATISFIED THEN

  17737  4 010253   200065 234100                    SZN     OPTION_SATISFIED,,AUTO
         4 010254   010262 605000 4                  TPL     s:17740

     1908    17738    3                           EXIT OPT_LOOP;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:297  
     1909    17739    3                     END; /*OPT_LOOP*/

  17739  4 010255   200075 235100                    LDA     I,,AUTO
         4 010256   000001 035007                    ADLA    1,DL
         4 010257   200075 755100                    STA     I,,AUTO
         4 010260   000006 115007                    CMPA    6,DL
         4 010261   010137 602000 4                  TNC     s:17708

     1910    17740    2                  IF OPTION_SATISFIED THEN

  17740  4 010262   200065 234100                    SZN     OPTION_SATISFIED,,AUTO
         4 010263   011604 605000 4                  TPL     s:17929

     1911    17741    3                     DO;

     1912    17742    3                        IF CHAN_DISP_FULL THEN

  17742  4 010264   200046 234100                    SZN     CHAN_DISP_FULL,,AUTO
         4 010265   011113 605000 4                  TPL     s:17803

     1913    17743    4                           DO;

     1914    17744    4           CALL YESNO(KH$CHN.BRKRQ,CHNTBL.BRKRQ);

  17744  4 010266   200242 630500                    EPPR0   CHNTBL+19,,AUTO
         4 010267   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010270   200376 452500                    STP2    MAX+1,,AUTO
         4 010271   200376 236100                    LDQ     MAX+1,,AUTO
         4 010272   000442 036000 5                  ADLQ    290
         4 010273   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010274   007473 701000 4                  TSX1    YESNO
         4 010275   000000 011000                    NOP     0

     1915    17745    4           CALL YESNO(KH$CHN.CLK,CHNTBL.CLK);

  17745  4 010276   200253 630500                    EPPR0   CHNTBL+28,,AUTO
         4 010277   200360 450500                    STP0    @NETCON_VAL,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:298  
         4 010300   200376 452500                    STP2    MAX+1,,AUTO
         4 010301   200376 236100                    LDQ     MAX+1,,AUTO
         4 010302   000443 036000 5                  ADLQ    291
         4 010303   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010304   007473 701000 4                  TSX1    YESNO
         4 010305   000000 011000                    NOP     0

     1916    17746    4           CALL YESNO(KH$CHN.RMTHST,CHNTBL.RMTHST);

  17746  4 010306   200260 630500                    EPPR0   CHNTBL+33,,AUTO
         4 010307   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010310   200376 452500                    STP2    MAX+1,,AUTO
         4 010311   200376 236100                    LDQ     MAX+1,,AUTO
         4 010312   000444 036000 5                  ADLQ    292
         4 010313   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010314   007473 701000 4                  TSX1    YESNO
         4 010315   000000 011000                    NOP     0

     1917    17747    4           CALL YESNO(KH$CHN.DBG,CHNTBL.DBG);

  17747  4 010316   200264 630500                    EPPR0   CHNTBL+37,,AUTO
         4 010317   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010320   200376 452500                    STP2    MAX+1,,AUTO
         4 010321   200376 236100                    LDQ     MAX+1,,AUTO
         4 010322   000445 036000 5                  ADLQ    293
         4 010323   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010324   007473 701000 4                  TSX1    YESNO
         4 010325   000000 011000                    NOP     0

     1918    17748    4           CALL YESNO(KH$CHN.AUTLGN,CHNTBL.AUTLGN);

  17748  4 010326   200234 630500                    EPPR0   CHNTBL+13,,AUTO
         4 010327   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010330   200376 452500                    STP2    MAX+1,,AUTO
         4 010331   200376 236100                    LDQ     MAX+1,,AUTO
         4 010332   000446 036000 5                  ADLQ    294
         4 010333   200357 756100                    STQ     @CURRENT_VAL,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:299  
         4 010334   007473 701000 4                  TSX1    YESNO
         4 010335   000000 011000                    NOP     0

     1919    17749    4           CALL YESNO(KH$CHN.AUTLGNFAILED,CHNTBL.AUTLGNFAILED);

  17749  4 010336   200230 630500                    EPPR0   CHNTBL+9,,AUTO
         4 010337   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010340   200376 452500                    STP2    MAX+1,,AUTO
         4 010341   200376 236100                    LDQ     MAX+1,,AUTO
         4 010342   000447 036000 5                  ADLQ    295
         4 010343   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010344   007473 701000 4                  TSX1    YESNO
         4 010345   000000 011000                    NOP     0

     1920    17750    4           CALL YESNO(KH$CHN.PROFILE,CHNTBL.PROFILE);

  17750  4 010346   200247 630500                    EPPR0   CHNTBL+24,,AUTO
         4 010347   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010350   200376 452500                    STP2    MAX+1,,AUTO
         4 010351   200376 236100                    LDQ     MAX+1,,AUTO
         4 010352   000450 036000 5                  ADLQ    296
         4 010353   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010354   007473 701000 4                  TSX1    YESNO
         4 010355   000000 011000                    NOP     0

     1921    17751    4           CHNTBL.STT=STATE(KH$CHN.STT.BYT);

  17751  4 010356   200014 236100                    LDQ     KH$CHN,,AUTO
         4 010357   000011 772000                    QRL     9
         4 010360   000377 376007                    ANQ     255,DL
         4 010361   002470 236006 1                  LDQ     STATE,QL
         4 010362   200271 756100                    STQ     CHNTBL+42,,AUTO

     1922    17752    4           CALL KSU$PACK2(KH$CHN.DVCID,CHNTBL.DVCID);

  17752  4 010363   200267 630500                    EPPR0   CHNTBL+40,,AUTO
         4 010364   200377 450500                    STP0    MAX+2,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:300  
         4 010365   200015 631500                    EPPR1   KH$CHN+1,,AUTO
         4 010366   200376 451500                    STP1    MAX+1,,AUTO
         4 010367   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010370   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010371   000000 701000 xent               TSX1    KSU$PACK2
         4 010372   000000 011000                    NOP     0

     1923    17753    4           CALL KSU$PACK2(KH$CHN.EXTDVCID,CHNTBL.EXTDVCID);

  17753  4 010373   200240 630500                    EPPR0   CHNTBL+17,,AUTO
         4 010374   200377 450500                    STP0    MAX+2,,AUTO
         4 010375   200400 452500                    STP2    MAX+3,,AUTO
         4 010376   200400 236100                    LDQ     MAX+3,,AUTO
         4 010377   000451 036000 5                  ADLQ    297
         4 010400   200376 756100                    STQ     MAX+1,,AUTO
         4 010401   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010402   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010403   000000 701000 xent               TSX1    KSU$PACK2
         4 010404   000000 011000                    NOP     0

     1924    17754    4           CALL CONCAT(CHNTBL.RESOURCE,'  ',KH$CHN.RESOURCE);

  17754  4 010405   002751 220000 1                  LDX0    PARM_DISPONLY_FMT+37
         4 010406   200263 740100                    STX0    CHNTBL+36,,AUTO
         4 010407   200016 221100                    LDX1    KH$CHN+2,,AUTO
         4 010410   200263 441100                    SXL1    CHNTBL+36,,AUTO

     1925    17755    4           CALL KSU$PACK2(KH$CHN.ATTR,CHNTBL.ATTR);

  17755  4 010411   200226 630500                    EPPR0   CHNTBL+7,,AUTO
         4 010412   200377 450500                    STP0    MAX+2,,AUTO
         4 010413   200400 452500                    STP2    MAX+3,,AUTO
         4 010414   200400 236100                    LDQ     MAX+3,,AUTO
         4 010415   000441 036000 5                  ADLQ    289
         4 010416   200376 756100                    STQ     MAX+1,,AUTO
         4 010417   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010420   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:301  
         4 010421   000000 701000 xent               TSX1    KSU$PACK2
         4 010422   000000 011000                    NOP     0

     1926    17756    4           CALL KSU$PACK2(KH$CHN.SYSID,CHNTBL.SYSID);

  17756  4 010423   200277 630500                    EPPR0   CHNTBL+48,,AUTO
         4 010424   200377 450500                    STP0    MAX+2,,AUTO
         4 010425   200017 631500                    EPPR1   KH$CHN+3,,AUTO
         4 010426   200376 451500                    STP1    MAX+1,,AUTO
         4 010427   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010430   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010431   000000 701000 xent               TSX1    KSU$PACK2
         4 010432   000000 011000                    NOP     0

     1927    17757    4           CALL YESNO(KH$CHN.DRCCNC,CHNTBL.DRCCNC);

  17757  4 010433   200272 630500                    EPPR0   CHNTBL+43,,AUTO
         4 010434   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010435   200376 452500                    STP2    MAX+1,,AUTO
         4 010436   200376 236100                    LDQ     MAX+1,,AUTO
         4 010437   000452 036000 5                  ADLQ    298
         4 010440   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010441   007473 701000 4                  TSX1    YESNO
         4 010442   000000 011000                    NOP     0

     1928    17758    4           CALL YESNO(KH$CHN.INP,CHNTBL.INP);

  17758  4 010443   200262 630500                    EPPR0   CHNTBL+35,,AUTO
         4 010444   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010445   200376 452500                    STP2    MAX+1,,AUTO
         4 010446   200376 236100                    LDQ     MAX+1,,AUTO
         4 010447   000453 036000 5                  ADLQ    299
         4 010450   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010451   007473 701000 4                  TSX1    YESNO
         4 010452   000000 011000                    NOP     0

     1929    17759    4           CALL YESNO(KH$CHN.OTP,CHNTBL.OTP);
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:302  

  17759  4 010453   200244 630500                    EPPR0   CHNTBL+21,,AUTO
         4 010454   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010455   200376 452500                    STP2    MAX+1,,AUTO
         4 010456   200376 236100                    LDQ     MAX+1,,AUTO
         4 010457   000454 036000 5                  ADLQ    300
         4 010460   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010461   007473 701000 4                  TSX1    YESNO
         4 010462   000000 011000                    NOP     0

     1930    17760    4           CALL YESNO(KH$CHN.DWNLOD,CHNTBL.DWNLOD);

  17760  4 010463   200275 630500                    EPPR0   CHNTBL+46,,AUTO
         4 010464   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010465   200376 452500                    STP2    MAX+1,,AUTO
         4 010466   200376 236100                    LDQ     MAX+1,,AUTO
         4 010467   000455 036000 5                  ADLQ    301
         4 010470   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010471   007473 701000 4                  TSX1    YESNO
         4 010472   000000 011000                    NOP     0

     1931    17761    4           CHNTBL.INPCCBCNT=KH$CHN.INPCCBCNT;

  17761  4 010473   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 010474   000011 772000                    QRL     9
         4 010475   000017 376007                    ANQ     15,DL
         4 010476   200254 756100                    STQ     CHNTBL+29,,AUTO

     1932    17762    4           CALL YESNO(KH$CHN.RE_ENB,CHNTBL.RE_ENB);

  17762  4 010477   200252 630500                    EPPR0   CHNTBL+27,,AUTO
         4 010500   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010501   200376 452500                    STP2    MAX+1,,AUTO
         4 010502   200376 236100                    LDQ     MAX+1,,AUTO
         4 010503   000456 036000 5                  ADLQ    302
         4 010504   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010505   007473 701000 4                  TSX1    YESNO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:303  
         4 010506   000000 011000                    NOP     0

     1933    17763    4           CALL YESNO(KH$CHN.ENB,CHNTBL.ENB);

  17763  4 010507   200232 630500                    EPPR0   CHNTBL+11,,AUTO
         4 010510   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010511   200376 452500                    STP2    MAX+1,,AUTO
         4 010512   200376 236100                    LDQ     MAX+1,,AUTO
         4 010513   000457 036000 5                  ADLQ    303
         4 010514   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010515   007473 701000 4                  TSX1    YESNO
         4 010516   000000 011000                    NOP     0

     1934    17764    4           CALL YESNO(KH$CHN.CTR,CHNTBL.CTR);

  17764  4 010517   200243 630500                    EPPR0   CHNTBL+20,,AUTO
         4 010520   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010521   200376 452500                    STP2    MAX+1,,AUTO
         4 010522   200376 236100                    LDQ     MAX+1,,AUTO
         4 010523   000460 036000 5                  ADLQ    304
         4 010524   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010525   007473 701000 4                  TSX1    YESNO
         4 010526   000000 011000                    NOP     0

     1935    17765    4           CHNTBL.CTR_DWNLD = BITBIN(KH$CHN.CCPDWNLD);

  17765  4 010527   200014 236100                    LDQ     KH$CHN,,AUTO
         4 010530   000003 772000                    QRL     3
         4 010531   000017 376007                    ANQ     15,DL
         4 010532   200250 756100                    STQ     CHNTBL+25,,AUTO

     1936    17766    4           CHNTBL.OTPCCBCNT=KH$CHN.OTPCCBCNT;

  17766  4 010533   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 010534   000017 376007                    ANQ     15,DL
         4 010535   200236 756100                    STQ     CHNTBL+15,,AUTO

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:304  
     1937    17767    4           CHNTBL.LCT55=KH$CHN.LCT55.BYT;

  17767  4 010536   200020 236100                    LDQ     KH$CHN+4,,AUTO
         4 010537   000033 772000                    QRL     27
         4 010540   000377 376007                    ANQ     255,DL
         4 010541   200273 756100                    STQ     CHNTBL+44,,AUTO

     1938    17768    4           CALL YESNO(KH$CHN.INPCCBSTTPTRVLD,CHNTBL.INPCCBSTTPTRVLD);

  17768  4 010542   200257 630500                    EPPR0   CHNTBL+32,,AUTO
         4 010543   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010544   200376 452500                    STP2    MAX+1,,AUTO
         4 010545   200376 236100                    LDQ     MAX+1,,AUTO
         4 010546   000461 036000 5                  ADLQ    305
         4 010547   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010550   007473 701000 4                  TSX1    YESNO
         4 010551   000000 011000                    NOP     0

     1939    17769    4           CALL YESNO(KH$CHN.OTPCCBSTTPTRVLD,CHNTBL.OTPCCBSTTPTRVLD);

  17769  4 010552   200241 630500                    EPPR0   CHNTBL+18,,AUTO
         4 010553   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010554   200376 452500                    STP2    MAX+1,,AUTO
         4 010555   200376 236100                    LDQ     MAX+1,,AUTO
         4 010556   000462 036000 5                  ADLQ    306
         4 010557   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010560   007473 701000 4                  TSX1    YESNO
         4 010561   000000 011000                    NOP     0

     1940    17770    4           CALL YESNO(KH$CHN.DRPDTR,CHNTBL.DRPDTR);

  17770  4 010562   200300 630500                    EPPR0   CHNTBL+49,,AUTO
         4 010563   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010564   200376 452500                    STP2    MAX+1,,AUTO
         4 010565   200376 236100                    LDQ     MAX+1,,AUTO
         4 010566   000463 036000 5                  ADLQ    307
         4 010567   200357 756100                    STQ     @CURRENT_VAL,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:305  
         4 010570   007473 701000 4                  TSX1    YESNO
         4 010571   000000 011000                    NOP     0

     1941    17771    4           CALL YESNO(KH$CHN.AUTBAD,CHNTBL.AUTBAD);

  17771  4 010572   200231 630500                    EPPR0   CHNTBL+10,,AUTO
         4 010573   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010574   200376 452500                    STP2    MAX+1,,AUTO
         4 010575   200376 236100                    LDQ     MAX+1,,AUTO
         4 010576   000464 036000 5                  ADLQ    308
         4 010577   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010600   007473 701000 4                  TSX1    YESNO
         4 010601   000000 011000                    NOP     0

     1942    17772    4           CHNTBL.LINSPD=LINESPEED(KH$CHN.LINSPD);

  17772  4 010602   200020 220100                    LDX0    KH$CHN+4,,AUTO
         4 010603   000017 360003                    ANX0    15,DU
         4 010604   002450 236010 1                  LDQ     LINESPEED,X0
         4 010605   000022 772000                    QRL     18
         4 010606   200301 756100                    STQ     CHNTBL+50,,AUTO

     1943    17773    4           CALL YESNO(KH$CHN.BUG,CHNTBL.BUG);

  17773  4 010607   200245 630500                    EPPR0   CHNTBL+22,,AUTO
         4 010610   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010611   200376 452500                    STP2    MAX+1,,AUTO
         4 010612   200376 236100                    LDQ     MAX+1,,AUTO
         4 010613   000465 036000 5                  ADLQ    309
         4 010614   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010615   007473 701000 4                  TSX1    YESNO
         4 010616   000000 011000                    NOP     0

     1944    17774    4           CALL YESNO(KH$CHN.DC1DC3NTWOTPFLWCTR,CHNTBL.DC1DC3NTWOTPFLWCTR);

  17774  4 010617   200233 630500                    EPPR0   CHNTBL+12,,AUTO
         4 010620   200360 450500                    STP0    @NETCON_VAL,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:306  
         4 010621   200376 452500                    STP2    MAX+1,,AUTO
         4 010622   200376 236100                    LDQ     MAX+1,,AUTO
         4 010623   000466 036000 5                  ADLQ    310
         4 010624   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010625   007473 701000 4                  TSX1    YESNO
         4 010626   000000 011000                    NOP     0

     1945    17775    4           CALL YESNO(KH$CHN.DSBHSTDWN,CHNTBL.DSBHSTDWN);

  17775  4 010627   200303 630500                    EPPR0   CHNTBL+52,,AUTO
         4 010630   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010631   200376 452500                    STP2    MAX+1,,AUTO
         4 010632   200376 236100                    LDQ     MAX+1,,AUTO
         4 010633   000467 036000 5                  ADLQ    311
         4 010634   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010635   007473 701000 4                  TSX1    YESNO
         4 010636   000000 011000                    NOP     0

     1946    17776    4           CALL YESNO(KH$CHN.KLLHSTDWN,CHNTBL.KLLHSTDWN);

  17776  4 010637   200270 630500                    EPPR0   CHNTBL+41,,AUTO
         4 010640   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010641   200376 452500                    STP2    MAX+1,,AUTO
         4 010642   200376 236100                    LDQ     MAX+1,,AUTO
         4 010643   000470 036000 5                  ADLQ    312
         4 010644   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010645   007473 701000 4                  TSX1    YESNO
         4 010646   000000 011000                    NOP     0

     1947    17777    4           CALL YESNO(KH$CHN.ENBHSTUP,CHNTBL.ENBHSTUP);

  17777  4 010647   200235 630500                    EPPR0   CHNTBL+14,,AUTO
         4 010650   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010651   200376 452500                    STP2    MAX+1,,AUTO
         4 010652   200376 236100                    LDQ     MAX+1,,AUTO
         4 010653   000471 036000 5                  ADLQ    313
         4 010654   200357 756100                    STQ     @CURRENT_VAL,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:307  
         4 010655   007473 701000 4                  TSX1    YESNO
         4 010656   000000 011000                    NOP     0

     1948    17778    4           CALL YESNO(KH$CHN.SNDSLT,CHNTBL.SNDSLT);

  17778  4 010657   200266 630500                    EPPR0   CHNTBL+39,,AUTO
         4 010660   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010661   200376 452500                    STP2    MAX+1,,AUTO
         4 010662   200376 236100                    LDQ     MAX+1,,AUTO
         4 010663   000472 036000 5                  ADLQ    314
         4 010664   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010665   007473 701000 4                  TSX1    YESNO
         4 010666   000000 011000                    NOP     0

     1949    17779    4           CALL YESNO(KH$CHN.ECHLGN,CHNTBL.ECHLGN);

  17779  4 010667   200227 630500                    EPPR0   CHNTBL+8,,AUTO
         4 010670   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010671   200376 452500                    STP2    MAX+1,,AUTO
         4 010672   200376 236100                    LDQ     MAX+1,,AUTO
         4 010673   000473 036000 5                  ADLQ    315
         4 010674   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010675   007473 701000 4                  TSX1    YESNO
         4 010676   000000 011000                    NOP     0

     1950    17780    4           CALL YESNO(KH$CHN.DED,CHNTBL.DED);

  17780  4 010677   200261 630500                    EPPR0   CHNTBL+34,,AUTO
         4 010700   200360 450500                    STP0    @NETCON_VAL,,AUTO
         4 010701   200376 452500                    STP2    MAX+1,,AUTO
         4 010702   200376 236100                    LDQ     MAX+1,,AUTO
         4 010703   000474 036000 5                  ADLQ    316
         4 010704   200357 756100                    STQ     @CURRENT_VAL,,AUTO
         4 010705   007473 701000 4                  TSX1    YESNO
         4 010706   000000 011000                    NOP     0

     1951    17781    4           CHNTBL.REDTIMOUTPRD = KH$CHN.REDTIMOUTPRD.BYT;
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:308  

  17781  4 010707   200020 236100                    LDQ     KH$CHN+4,,AUTO
         4 010710   000377 376007                    ANQ     255,DL
         4 010711   200255 756100                    STQ     CHNTBL+30,,AUTO

     1952    17782    4           CHNTBL.LGNTIMOUTPRD=KH$CHN.LGNTIMOUTPRD.BYT;

  17782  4 010712   200021 236100                    LDQ     KH$CHN+5,,AUTO
         4 010713   000033 772000                    QRL     27
         4 010714   000377 376007                    ANQ     255,DL
         4 010715   200276 756100                    STQ     CHNTBL+47,,AUTO

     1953    17783    4           CHNTBL.TPTIMOUTPRD=KH$CHN.TPTIMOUTPRD.BYT;

  17783  4 010716   200021 236100                    LDQ     KH$CHN+5,,AUTO
         4 010717   000022 772000                    QRL     18
         4 010720   000377 376007                    ANQ     255,DL
         4 010721   200302 756100                    STQ     CHNTBL+51,,AUTO

     1954    17784    4           CALL KSU$PACK2(KH$CHN.INPBFRBYTSIZ,CHNTBL.INPBFRBYTSIZ);

  17784  4 010722   200251 630500                    EPPR0   CHNTBL+26,,AUTO
         4 010723   200377 450500                    STP0    MAX+2,,AUTO
         4 010724   200400 452500                    STP2    MAX+3,,AUTO
         4 010725   200400 236100                    LDQ     MAX+3,,AUTO
         4 010726   000475 036000 5                  ADLQ    317
         4 010727   200376 756100                    STQ     MAX+1,,AUTO
         4 010730   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010731   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010732   000000 701000 xent               TSX1    KSU$PACK2
         4 010733   000000 011000                    NOP     0

     1955    17785    4           CALL KSU$PACK4(KH$CHN.CTX$,CHNTBL.CTX$);

  17785  4 010734   200256 630500                    EPPR0   CHNTBL+31,,AUTO
         4 010735   200377 450500                    STP0    MAX+2,,AUTO
         4 010736   200022 631500                    EPPR1   KH$CHN+6,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:309  
         4 010737   200376 451500                    STP1    MAX+1,,AUTO
         4 010740   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010741   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010742   000000 701000 xent               TSX1    KSU$PACK4
         4 010743   000000 011000                    NOP     0

     1956    17786    4           CALL KSU$PACK4(KH$CHN.INTCNT,CHNTBL.INTCNT);

  17786  4 010744   200265 630500                    EPPR0   CHNTBL+38,,AUTO
         4 010745   200377 450500                    STP0    MAX+2,,AUTO
         4 010746   200023 631500                    EPPR1   KH$CHN+7,,AUTO
         4 010747   200376 451500                    STP1    MAX+1,,AUTO
         4 010750   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010751   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010752   000000 701000 xent               TSX1    KSU$PACK4
         4 010753   000000 011000                    NOP     0

     1957    17787    4           CALL KSU$PACK2(KH$CHN.BLOCK,CHNTBL.BLOCK);

  17787  4 010754   200237 630500                    EPPR0   CHNTBL+16,,AUTO
         4 010755   200377 450500                    STP0    MAX+2,,AUTO
         4 010756   200024 631500                    EPPR1   KH$CHN+8,,AUTO
         4 010757   200376 451500                    STP1    MAX+1,,AUTO
         4 010760   200376 630500                    EPPR0   MAX+1,,AUTO
         4 010761   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010762   000000 701000 xent               TSX1    KSU$PACK2
         4 010763   000000 011000                    NOP     0

     1958    17788    4           CALL KSU$PACK2(KH$CHN.UNBLOCK,CHNTBL.UNBLOCK);

  17788  4 010764   200305 630500                    EPPR0   CHNTBL+54,,AUTO
         4 010765   200377 450500                    STP0    MAX+2,,AUTO
         4 010766   200400 452500                    STP2    MAX+3,,AUTO
         4 010767   200400 236100                    LDQ     MAX+3,,AUTO
         4 010770   000476 036000 5                  ADLQ    318
         4 010771   200376 756100                    STQ     MAX+1,,AUTO
         4 010772   200376 630500                    EPPR0   MAX+1,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:310  
         4 010773   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 010774   000000 701000 xent               TSX1    KSU$PACK2
         4 010775   000000 011000                    NOP     0

     1959    17789    4           CALL KSU$PACK2(KH$CHN.TERMID.TERM.CHANNEL,CHNTBL.TERMID.CHANNEL);

  17789  4 010776   200217 630500                    EPPR0   CHNTBL,,AUTO
         4 010777   200377 450500                    STP0    MAX+2,,AUTO
         4 011000   200400 452500                    STP2    MAX+3,,AUTO
         4 011001   200400 236100                    LDQ     MAX+3,,AUTO
         4 011002   000477 036000 5                  ADLQ    319
         4 011003   200376 756100                    STQ     MAX+1,,AUTO
         4 011004   200376 630500                    EPPR0   MAX+1,,AUTO
         4 011005   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011006   000000 701000 xent               TSX1    KSU$PACK2
         4 011007   000000 011000                    NOP     0

     1960    17790    4           CALL KSU$PACK2(KH$CHN.TERMID.TERM.SUBDEVICE,CHNTBL.TERMID.SUBDEVICE);

  17790  4 011010   200220 630500                    EPPR0   CHNTBL+1,,AUTO
         4 011011   200377 450500                    STP0    MAX+2,,AUTO
         4 011012   200026 631500                    EPPR1   KH$CHN+10,,AUTO
         4 011013   200376 451500                    STP1    MAX+1,,AUTO
         4 011014   200376 630500                    EPPR0   MAX+1,,AUTO
         4 011015   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011016   000000 701000 xent               TSX1    KSU$PACK2
         4 011017   000000 011000                    NOP     0

     1961    17791    4           CALL KSU$PACK2(KH$CHN.TERMID.TERM.SUBSUBDEVICE,CHNTBL.TERMID.SUBSUBDEVICE);

  17791  4 011020   200221 630500                    EPPR0   CHNTBL+2,,AUTO
         4 011021   200377 450500                    STP0    MAX+2,,AUTO
         4 011022   200400 452500                    STP2    MAX+3,,AUTO
         4 011023   200400 236100                    LDQ     MAX+3,,AUTO
         4 011024   000500 036000 5                  ADLQ    320
         4 011025   200376 756100                    STQ     MAX+1,,AUTO
         4 011026   200376 630500                    EPPR0   MAX+1,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:311  
         4 011027   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011030   000000 701000 xent               TSX1    KSU$PACK2
         4 011031   000000 011000                    NOP     0

     1962    17792    4           CHNTBL.TERMID.TERM_NAME=KH$CHN.TERMID.TERM.TERM_NAME;

  17792  4 011032   040100 100500                    MLR     fill='040'O
         4 011033   200027 000010                    ADSC9   KH$CHN+11,,AUTO          cn=0,n=8
         4 011034   200224 000010                    ADSC9   CHNTBL+5,,AUTO           cn=0,n=8

     1963    17793    4           CHNTBL.TERMID.TTYP=DB_CHNTBL_TTYPS(KH$CHN.TERMID.TTYP);

  17793  4 011035   200025 236100                    LDQ     KH$CHN+9,,AUTO
         4 011036   000033 772000                    QRL     27
         4 011037   002505 236006 1                  LDQ     DB_CHNTBL_TTYPS,QL
         4 011040   200223 756100                    STQ     CHNTBL+4,,AUTO

     1964    17794    4           CHNTBL.TERMID.LEV=KH$CHN.TERMID.LEV;

  17794  4 011041   200025 236100                    LDQ     KH$CHN+9,,AUTO
         4 011042   000022 772000                    QRL     18
         4 011043   000777 376007                    ANQ     511,DL
         4 011044   200222 756100                    STQ     CHNTBL+3,,AUTO

     1965    17795    4           CALL KSU$PACK4(KH$CHN.SUB$,CHNTBL.SUB$);

  17795  4 011045   200274 630500                    EPPR0   CHNTBL+45,,AUTO
         4 011046   200377 450500                    STP0    MAX+2,,AUTO
         4 011047   200031 631500                    EPPR1   KH$CHN+13,,AUTO
         4 011050   200376 451500                    STP1    MAX+1,,AUTO
         4 011051   200376 630500                    EPPR0   MAX+1,,AUTO
         4 011052   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011053   000000 701000 xent               TSX1    KSU$PACK4
         4 011054   000000 011000                    NOP     0

     1966    17796    4           CALL KSU$PACK4(KH$CHN.LNK$,CHNTBL.LNK$);

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:312  
  17796  4 011055   200304 630500                    EPPR0   CHNTBL+53,,AUTO
         4 011056   200377 450500                    STP0    MAX+2,,AUTO
         4 011057   200032 631500                    EPPR1   KH$CHN+14,,AUTO
         4 011060   200376 451500                    STP1    MAX+1,,AUTO
         4 011061   200376 630500                    EPPR0   MAX+1,,AUTO
         4 011062   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011063   000000 701000 xent               TSX1    KSU$PACK4
         4 011064   000000 011000                    NOP     0

     1967    17797    4           CALL KSU$PACK4(KH$CHN.HAND$,CHNTBL.HAND$);

  17797  4 011065   200246 630500                    EPPR0   CHNTBL+23,,AUTO
         4 011066   200377 450500                    STP0    MAX+2,,AUTO
         4 011067   200033 631500                    EPPR1   KH$CHN+15,,AUTO
         4 011070   200376 451500                    STP1    MAX+1,,AUTO
         4 011071   200376 630500                    EPPR0   MAX+1,,AUTO
         4 011072   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011073   000000 701000 xent               TSX1    KSU$PACK4
         4 011074   000000 011000                    NOP     0

     1968    17798
     1969    17799    4                              CALL KSW$WRITE(VECTOR(CHNFMT),VECTOR(CHNTBL));

  17799  4 011075   000501 235000 5                  LDA     321
         4 011076   200376 452500                    STP2    MAX+1,,AUTO
         4 011077   200376 236100                    LDQ     MAX+1,,AUTO
         4 011100   000217 036003                    ADLQ    143,DU
         4 011101   200400 757100                    STAQ    MAX+3,,AUTO
         4 011102   200400 630500                    EPPR0   MAX+3,,AUTO
         4 011103   200403 450500                    STP0    MAX+6,,AUTO
         4 011104   000504 236000 5                  LDQ     324
         4 011105   200402 756100                    STQ     MAX+5,,AUTO
         4 011106   200402 630500                    EPPR0   MAX+5,,AUTO
         4 011107   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011110   000000 701000 xent               TSX1    KSW$WRITE
         4 011111   000000 011000                    NOP     0

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:313  
     1970    17800    4                           END;  /*CHAN_DISP_FULL*/

  17800  4 011112   011604 710000 4                  TRA     s:17929

     1971    17801    3                        ELSE
     1972    17802    4                           DO;

     1973    17803    4                              IF NOT HDR_FLAG THEN

  17803  4 011113   200064 234100                    SZN     HDR_FLAG,,AUTO
         4 011114   011127 604000 4                  TMI     s:17811

     1974    17804    5                                 DO;

     1975    17805    5                                    CALL KSW$WRITE(VECTOR(CHN_HDR_FMT_1));

  17805  4 011115   000510 630400 5                  EPPR0   328
         4 011116   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011117   000000 701000 xent               TSX1    KSW$WRITE
         4 011120   000000 011000                    NOP     0

     1976    17806    5                                    CALL KSW$WRITE(VECTOR(CHN_HDR_FMT_2));

  17806  4 011121   000514 630400 5                  EPPR0   332
         4 011122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 011123   000000 701000 xent               TSX1    KSW$WRITE
         4 011124   000000 011000                    NOP     0

     1977    17807    5                                    HDR_FLAG = '1'B;

  17807  4 011125   400000 236003                    LDQ     -131072,DU
         4 011126   200064 756100                    STQ     HDR_FLAG,,AUTO

     1978    17808    5                                 END;

     1979    17809
     1980    17810                                   %ARRAY_TO_WORD(S="KH$CHN.DVCID",D="CHNTBL_SUM.DVCID");
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:314  

  17811  4 011127   200307 630500                    EPPR0   CHNTBL_SUM+1,,AUTO
         4 011130   200216 450500                    STP0    D$,,AUTO

  17812  4 011131   200015 631500                    EPPR1   KH$CHN+1,,AUTO
         4 011132   200214 451500                    STP1    S$,,AUTO

  17813  4 011133   200307 450100                    STZ     CHNTBL_SUM+1,,AUTO

  17814  4 011134   000001 235007                    LDA     1,DL
         4 011135   200215 755100                    STA     BINDX,,AUTO

  17815  4 011136   200214 470500                    LDP0    S$,,AUTO
         4 011137   200215 235100                    LDA     BINDX,,AUTO
         4 011140   200216 471500                    LDP1    D$,,AUTO
         4 011141   003105 060505                    CSL     bolr='003'O
         4 011142   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011143   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  17816  4 011144   000001 035007                    ADLA    1,DL
         4 011145   200215 755100                    STA     BINDX,,AUTO
         4 011146   000011 115007                    CMPA    9,DL
         4 011147   011136 602000 4                  TNC     s:17815

  17817  4 011150   000012 236007                    LDQ     10,DL
         4 011151   200215 756100                    STQ     BINDX,,AUTO

  17818  4 011152   200214 470500                    LDP0    S$,,AUTO
         4 011153   200215 235100                    LDA     BINDX,,AUTO
         4 011154   200216 471500                    LDP1    D$,,AUTO
         4 011155   003105 060505                    CSL     bolr='003'O
         4 011156   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011157   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  17819  4 011160   000001 035007                    ADLA    1,DL
         4 011161   200215 755100                    STA     BINDX,,AUTO
         4 011162   000022 115007                    CMPA    18,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:315  
         4 011163   011152 602000 4                  TNC     s:17818

  17820  4 011164   003100 061500                    CSR     bolr='003'O
         4 011165   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 011166   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 011167   200376 236100                    LDQ     MAX+1,,AUTO
         4 011170   200307 756100                    STQ     CHNTBL_SUM+1,,AUTO

     1981    17822                                   %ARRAY_TO_WORD(S="KH$CHN.TERMID.TERM.CHANNEL",D=
             17822                                       "CHNTBL_SUM.CHANNEL");

  17823  4 011171   200306 633500                    EPPR3   CHNTBL_SUM,,AUTO
         4 011172   200216 453500                    STP3    D$,,AUTO

  17824  4 011173   200376 452500                    STP2    MAX+1,,AUTO
         4 011174   200376 236100                    LDQ     MAX+1,,AUTO
         4 011175   000477 036000 5                  ADLQ    319
         4 011176   200214 756100                    STQ     S$,,AUTO

  17825  4 011177   200306 450100                    STZ     CHNTBL_SUM,,AUTO

  17826  4 011200   000001 235007                    LDA     1,DL
         4 011201   200215 755100                    STA     BINDX,,AUTO

  17827  4 011202   200214 470500                    LDP0    S$,,AUTO
         4 011203   200215 235100                    LDA     BINDX,,AUTO
         4 011204   200216 471500                    LDP1    D$,,AUTO
         4 011205   003105 060505                    CSL     bolr='003'O
         4 011206   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011207   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  17828  4 011210   000001 035007                    ADLA    1,DL
         4 011211   200215 755100                    STA     BINDX,,AUTO
         4 011212   000011 115007                    CMPA    9,DL
         4 011213   011202 602000 4                  TNC     s:17827

  17829  4 011214   000012 236007                    LDQ     10,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:316  
         4 011215   200215 756100                    STQ     BINDX,,AUTO

  17830  4 011216   200214 470500                    LDP0    S$,,AUTO
         4 011217   200215 235100                    LDA     BINDX,,AUTO
         4 011220   200216 471500                    LDP1    D$,,AUTO
         4 011221   003105 060505                    CSL     bolr='003'O
         4 011222   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011223   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  17831  4 011224   000001 035007                    ADLA    1,DL
         4 011225   200215 755100                    STA     BINDX,,AUTO
         4 011226   000022 115007                    CMPA    18,DL
         4 011227   011216 602000 4                  TNC     s:17830

  17832  4 011230   003100 061500                    CSR     bolr='003'O
         4 011231   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 011232   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 011233   200376 236100                    LDQ     MAX+1,,AUTO
         4 011234   200306 756100                    STQ     CHNTBL_SUM,,AUTO

     1982    17834                                   %ARRAY_TO_WORD(S="KH$CHN.EXTDVCID",D=
             17834                                       "CHNTBL_SUM.EXTDVCID");

  17835  4 011235   200310 633500                    EPPR3   CHNTBL_SUM+2,,AUTO
         4 011236   200216 453500                    STP3    D$,,AUTO

  17836  4 011237   200376 452500                    STP2    MAX+1,,AUTO
         4 011240   200376 236100                    LDQ     MAX+1,,AUTO
         4 011241   000451 036000 5                  ADLQ    297
         4 011242   200214 756100                    STQ     S$,,AUTO

  17837  4 011243   200310 450100                    STZ     CHNTBL_SUM+2,,AUTO

  17838  4 011244   000001 235007                    LDA     1,DL
         4 011245   200215 755100                    STA     BINDX,,AUTO

  17839  4 011246   200214 470500                    LDP0    S$,,AUTO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:317  
         4 011247   200215 235100                    LDA     BINDX,,AUTO
         4 011250   200216 471500                    LDP1    D$,,AUTO
         4 011251   003105 060505                    CSL     bolr='003'O
         4 011252   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011253   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  17840  4 011254   000001 035007                    ADLA    1,DL
         4 011255   200215 755100                    STA     BINDX,,AUTO
         4 011256   000011 115007                    CMPA    9,DL
         4 011257   011246 602000 4                  TNC     s:17839

  17841  4 011260   000012 236007                    LDQ     10,DL
         4 011261   200215 756100                    STQ     BINDX,,AUTO

  17842  4 011262   200214 470500                    LDP0    S$,,AUTO
         4 011263   200215 235100                    LDA     BINDX,,AUTO
         4 011264   200216 471500                    LDP1    D$,,AUTO
         4 011265   003105 060505                    CSL     bolr='003'O
         4 011266   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011267   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  17843  4 011270   000001 035007                    ADLA    1,DL
         4 011271   200215 755100                    STA     BINDX,,AUTO
         4 011272   000022 115007                    CMPA    18,DL
         4 011273   011262 602000 4                  TNC     s:17842

  17844  4 011274   003100 061500                    CSR     bolr='003'O
         4 011275   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 011276   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 011277   200376 236100                    LDQ     MAX+1,,AUTO
         4 011300   200310 756100                    STQ     CHNTBL_SUM+2,,AUTO

     1983    17846                                   %ARRAY_TO_WORD(S="KH$CHN.ATTR",D="CHNTBL_SUM.ATTR");

  17847  4 011301   200311 633500                    EPPR3   CHNTBL_SUM+3,,AUTO
         4 011302   200216 453500                    STP3    D$,,AUTO

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:318  
  17848  4 011303   200376 452500                    STP2    MAX+1,,AUTO
         4 011304   200376 236100                    LDQ     MAX+1,,AUTO
         4 011305   000441 036000 5                  ADLQ    289
         4 011306   200214 756100                    STQ     S$,,AUTO

  17849  4 011307   200311 450100                    STZ     CHNTBL_SUM+3,,AUTO

  17850  4 011310   000001 235007                    LDA     1,DL
         4 011311   200215 755100                    STA     BINDX,,AUTO

  17851  4 011312   200214 470500                    LDP0    S$,,AUTO
         4 011313   200215 235100                    LDA     BINDX,,AUTO
         4 011314   200216 471500                    LDP1    D$,,AUTO
         4 011315   003105 060505                    CSL     bolr='003'O
         4 011316   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011317   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  17852  4 011320   000001 035007                    ADLA    1,DL
         4 011321   200215 755100                    STA     BINDX,,AUTO
         4 011322   000011 115007                    CMPA    9,DL
         4 011323   011312 602000 4                  TNC     s:17851

  17853  4 011324   000012 236007                    LDQ     10,DL
         4 011325   200215 756100                    STQ     BINDX,,AUTO

  17854  4 011326   200214 470500                    LDP0    S$,,AUTO
         4 011327   200215 235100                    LDA     BINDX,,AUTO
         4 011330   200216 471500                    LDP1    D$,,AUTO
         4 011331   003105 060505                    CSL     bolr='003'O
         4 011332   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011333   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  17855  4 011334   000001 035007                    ADLA    1,DL
         4 011335   200215 755100                    STA     BINDX,,AUTO
         4 011336   000022 115007                    CMPA    18,DL
         4 011337   011326 602000 4                  TNC     s:17854

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:319  
  17856  4 011340   003100 061500                    CSR     bolr='003'O
         4 011341   100000 000022                    BDSC    0,,PR1                   by=0,bit=0,n=18
         4 011342   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 011343   200376 236100                    LDQ     MAX+1,,AUTO
         4 011344   200311 756100                    STQ     CHNTBL_SUM+3,,AUTO

     1984    17858                                   %CHN_T_F(R="SNDSLT",D="CHNTBL_SUM.SNDSLT");

  17859  4 011345   200020 236100                    LDQ     KH$CHN+4,,AUTO
         4 011346   004000 316007                    CANQ    2048,DL
         4 011347   011353 600000 4                  TZE     s:17862

  17860  4 011350   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 011351   200321 552170                    STBQ    CHNTBL_SUM+11,'70'O,AUTO
         4 011352   011355 710000 4                  TRA     s:17865

  17862  4 011353   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 011354   200321 552170                    STBQ    CHNTBL_SUM+11,'70'O,AUTO

     1985    17864                                   %CHN_T_F(R="INP",D="CHNTBL_SUM.INP");

  17865  4 011355   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 011356   100000 316007                    CANQ    32768,DL
         4 011357   011364 600000 4                  TZE     s:17868

  17866  4 011360   040100 100400                    MLR     fill='040'O
         4 011361   002713 000003 1                  ADSC9   PARM_DISPONLY_FMT+7      cn=0,n=3
         4 011362   200317 400003                    ADSC9   CHNTBL_SUM+9,,AUTO       cn=2,n=3
         4 011363   011367 710000 4                  TRA     s:17871

  17868  4 011364   040100 100400                    MLR     fill='040'O
         4 011365   002714 000003 1                  ADSC9   PARM_DISPONLY_FMT+8      cn=0,n=3
         4 011366   200317 400003                    ADSC9   CHNTBL_SUM+9,,AUTO       cn=2,n=3

     1986    17870                                   %CHN_T_F(R="OTP",D="CHNTBL_SUM.OTP");

  17871  4 011367   040000 316007                    CANQ    16384,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:320  
         4 011370   011375 600000 4                  TZE     s:17874

  17872  4 011371   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 011372   000011 772000                    QRL     9
         4 011373   200320 552134                    STBQ    CHNTBL_SUM+10,'34'O,AUTO
         4 011374   011400 710000 4                  TRA     s:17877

  17874  4 011375   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 011376   000011 772000                    QRL     9
         4 011377   200320 552134                    STBQ    CHNTBL_SUM+10,'34'O,AUTO

     1987    17876                                   %CHN_T_F(R="DWNLOD",D="CHNTBL_SUM.DWNLOD");

  17877  4 011400   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 011401   020000 316007                    CANQ    8192,DL
         4 011402   011406 600000 4                  TZE     s:17880

  17878  4 011403   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 011404   200316 552170                    STBQ    CHNTBL_SUM+8,'70'O,AUTO
         4 011405   011410 710000 4                  TRA     s:17883

  17880  4 011406   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 011407   200316 552170                    STBQ    CHNTBL_SUM+8,'70'O,AUTO

     1988    17882                                   %CHN_T_F(R="ENB",D="CHNTBL_SUM.ENB");

  17883  4 011410   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 011411   000100 316007                    CANQ    64,DL
         4 011412   011417 600000 4                  TZE     s:17886

  17884  4 011413   040100 100400                    MLR     fill='040'O
         4 011414   002713 000003 1                  ADSC9   PARM_DISPONLY_FMT+7      cn=0,n=3
         4 011415   200316 600003                    ADSC9   CHNTBL_SUM+8,,AUTO       cn=3,n=3
         4 011416   011422 710000 4                  TRA     s:17888

  17886  4 011417   040100 100400                    MLR     fill='040'O
         4 011420   002714 000003 1                  ADSC9   PARM_DISPONLY_FMT+8      cn=0,n=3
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:321  
         4 011421   200316 600003                    ADSC9   CHNTBL_SUM+8,,AUTO       cn=3,n=3

     1989    17888    4                              CHNTBL_SUM.STT = STATE(KH$CHN.STT.BYT);

  17888  4 011422   200014 236100                    LDQ     KH$CHN,,AUTO
         4 011423   000011 772000                    QRL     9
         4 011424   000377 376007                    ANQ     255,DL
         4 011425   000002 736000                    QLS     2
         4 011426   040100 100406                    MLR     fill='040'O
         4 011427   002470 000004 1                  ADSC9   STATE,Q                  cn=0,n=4
         4 011430   200313 400004                    ADSC9   CHNTBL_SUM+5,,AUTO       cn=2,n=4

     1990    17889
     1991    17890    4                              CHNTBL_SUM.INPCCBCNT = KH$CHN.INPCCBCNT;

  17890  4 011431   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 011432   000011 772000                    QRL     9
         4 011433   000017 376007                    ANQ     15,DL
         4 011434   200322 756100                    STQ     CHNTBL_SUM+12,,AUTO

     1992    17891    4                              CHNTBL_SUM.OTPCCBCNT = KH$CHN.OTPCCBCNT;

  17891  4 011435   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 011436   000017 376007                    ANQ     15,DL
         4 011437   200323 756100                    STQ     CHNTBL_SUM+13,,AUTO

     1993    17892    4                              CHNTBL_SUM.REDTIMOUTPRD = KH$CHN.REDTIMOUTPRD.BYT;

  17892  4 011440   200020 236100                    LDQ     KH$CHN+4,,AUTO
         4 011441   000377 376007                    ANQ     255,DL
         4 011442   200325 756100                    STQ     CHNTBL_SUM+15,,AUTO

     1994    17893    4                              CHNTBL_SUM.LGNTIMOUTPRD = KH$CHN.LGNTIMOUTPRD.BYT;

  17893  4 011443   200021 236100                    LDQ     KH$CHN+5,,AUTO
         4 011444   000033 772000                    QRL     27
         4 011445   000377 376007                    ANQ     255,DL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:322  
         4 011446   200324 756100                    STQ     CHNTBL_SUM+14,,AUTO

     1995    17894                                   %PACK4(S="KH$CHN.CTX$",D="CHNTBL_SUM.CTX$");

  17895  4 011447   200312 633500                    EPPR3   CHNTBL_SUM+4,,AUTO
         4 011450   200216 453500                    STP3    D$,,AUTO

  17896  4 011451   200022 631500                    EPPR1   KH$CHN+6,,AUTO
         4 011452   200214 451500                    STP1    S$,,AUTO

  17897  4 011453   200312 450100                    STZ     CHNTBL_SUM+4,,AUTO

  17898  4 011454   000001 235007                    LDA     1,DL
         4 011455   200215 755100                    STA     BINDX,,AUTO

  17899  4 011456   200214 470500                    LDP0    S$,,AUTO
         4 011457   200215 235100                    LDA     BINDX,,AUTO
         4 011460   200216 471500                    LDP1    D$,,AUTO
         4 011461   003105 060505                    CSL     bolr='003'O
         4 011462   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011463   100000 030001                    BDSC    0,A,PR1                  by=0,bit=3,n=1

  17900  4 011464   000001 035007                    ADLA    1,DL
         4 011465   200215 755100                    STA     BINDX,,AUTO
         4 011466   000011 115007                    CMPA    9,DL
         4 011467   011456 602000 4                  TNC     s:17899

  17901  4 011470   000012 236007                    LDQ     10,DL
         4 011471   200215 756100                    STQ     BINDX,,AUTO

  17902  4 011472   200214 470500                    LDP0    S$,,AUTO
         4 011473   200215 235100                    LDA     BINDX,,AUTO
         4 011474   200216 471500                    LDP1    D$,,AUTO
         4 011475   003105 060505                    CSL     bolr='003'O
         4 011476   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011477   100000 020001                    BDSC    0,A,PR1                  by=0,bit=2,n=1

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:323  
  17903  4 011500   000001 035007                    ADLA    1,DL
         4 011501   200215 755100                    STA     BINDX,,AUTO
         4 011502   000022 115007                    CMPA    18,DL
         4 011503   011472 602000 4                  TNC     s:17902

  17904  4 011504   000023 236007                    LDQ     19,DL
         4 011505   200215 756100                    STQ     BINDX,,AUTO

  17905  4 011506   200214 470500                    LDP0    S$,,AUTO
         4 011507   200215 235100                    LDA     BINDX,,AUTO
         4 011510   200216 471500                    LDP1    D$,,AUTO
         4 011511   003105 060505                    CSL     bolr='003'O
         4 011512   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011513   100000 010001                    BDSC    0,A,PR1                  by=0,bit=1,n=1

  17906  4 011514   000001 035007                    ADLA    1,DL
         4 011515   200215 755100                    STA     BINDX,,AUTO
         4 011516   000033 115007                    CMPA    27,DL
         4 011517   011506 602000 4                  TNC     s:17905

  17907  4 011520   000034 236007                    LDQ     28,DL
         4 011521   200215 756100                    STQ     BINDX,,AUTO

  17908  4 011522   200214 470500                    LDP0    S$,,AUTO
         4 011523   200215 235100                    LDA     BINDX,,AUTO
         4 011524   200216 471500                    LDP1    D$,,AUTO
         4 011525   003105 060505                    CSL     bolr='003'O
         4 011526   000000 000001                    BDSC    0,A,PR0                  by=0,bit=0,n=1
         4 011527   100000 000001                    BDSC    0,A,PR1                  by=0,bit=0,n=1

  17909  4 011530   000001 035007                    ADLA    1,DL
         4 011531   200215 755100                    STA     BINDX,,AUTO
         4 011532   000044 115007                    CMPA    36,DL
         4 011533   011522 602000 4                  TNC     s:17908

  17910  4 011534   003100 060500                    CSL     bolr='003'O
         4 011535   100000 000044                    BDSC    0,,PR1                   by=0,bit=0,n=36
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:324  
         4 011536   200376 000044                    BDSC    MAX+1,,AUTO              by=0,bit=0,n=36
         4 011537   200376 236100                    LDQ     MAX+1,,AUTO
         4 011540   200312 756100                    STQ     CHNTBL_SUM+4,,AUTO

     1996    17912                                   %CHN_T_F(R="DRPDTR",D="CHNTBL_SUM.DRPDTR");

  17913  4 011541   200020 236100                    LDQ     KH$CHN+4,,AUTO
         4 011542   000040 316003                    CANQ    32,DU
         4 011543   011550 600000 4                  TZE     s:17916

  17914  4 011544   002713 236000 1                  LDQ     PARM_DISPONLY_FMT+7
         4 011545   000011 772000                    QRL     9
         4 011546   200315 552134                    STBQ    CHNTBL_SUM+7,'34'O,AUTO
         4 011547   011553 710000 4                  TRA     s:17918

  17916  4 011550   002714 236000 1                  LDQ     PARM_DISPONLY_FMT+8
         4 011551   000011 772000                    QRL     9
         4 011552   200315 552134                    STBQ    CHNTBL_SUM+7,'34'O,AUTO

     1997    17918    4                              CHNTBL_SUM.RESOURCE = KH$CHN.RESOURCE;

  17918  4 011553   200016 220100                    LDX0    KH$CHN+2,,AUTO
         4 011554   200313 740100                    STX0    CHNTBL_SUM+5,,AUTO

     1998    17919                                   %CHN_T_F(R="DRCCNC",D="CHNTBL_SUM.DRCCNC");

  17920  4 011555   200017 236100                    LDQ     KH$CHN+3,,AUTO
         4 011556   200000 316007                    CANQ    65536,DL
         4 011557   011564 600000 4                  TZE     s:17923

  17921  4 011560   040100 100400                    MLR     fill='040'O
         4 011561   002713 000003 1                  ADSC9   PARM_DISPONLY_FMT+7      cn=0,n=3
         4 011562   200314 400003                    ADSC9   CHNTBL_SUM+6,,AUTO       cn=2,n=3
         4 011563   011567 710000 4                  TRA     s:17925

  17923  4 011564   040100 100400                    MLR     fill='040'O
         4 011565   002714 000003 1                  ADSC9   PARM_DISPONLY_FMT+8      cn=0,n=3
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:325  
         4 011566   200314 400003                    ADSC9   CHNTBL_SUM+6,,AUTO       cn=2,n=3

     1999    17925    4                              CALL KSW$WRITE(VECTOR(CHN_DAT_FMT),

  17925  4 011567   000176 235000 5                  LDA     126
         4 011570   200376 452500                    STP2    MAX+1,,AUTO
         4 011571   200376 236100                    LDQ     MAX+1,,AUTO
         4 011572   000306 036003                    ADLQ    198,DU
         4 011573   200400 757100                    STAQ    MAX+3,,AUTO
         4 011574   200400 633500                    EPPR3   MAX+3,,AUTO
         4 011575   200403 453500                    STP3    MAX+6,,AUTO
         4 011576   000520 236000 5                  LDQ     336
         4 011577   200402 756100                    STQ     MAX+5,,AUTO
         4 011600   200402 630500                    EPPR0   MAX+5,,AUTO
         4 011601   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 011602   000000 701000 xent               TSX1    KSW$WRITE
         4 011603   000000 011000                    NOP     0

     2000    17926    4                                             VECTOR(CHNTBL_SUM));
     2001    17927    4                           END;  /*DISPLAY SUMMARY CHANTBL ENTRY*/

     2002    17928    3                     END;  /*DISPLAY CHANTBL ENTRY*/

     2003    17929    2        END DISPLAY_CHAN;

  17929  4 011604   200354 221300                    LDX1  ! SUBLK_INDX+1,,AUTO
         4 011605   000001 702211                    TSX2  ! 1,X1
     2004    17930    1   END KSC$DISPLAY;
     2005    17931        %EOD;

PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:326  
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$DISPLAY.
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:327  

 **** Variables and constants ****

  ****  Section 001 RoData KSC$DISPLAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   256-0-0/c CHAR(42)    r     1 ACTV_FMT                 272-0-0/d BIT (72)    r     1 ACTV_VEC
   330-0-0/c CHAR(41)    r     1 ALT_FMT                  344-0-0/d BIT (72)    r     1 ALT_VEC
  2565-0-0/w CHAR        r     1 ATTR_FMT                2620-0-0/w CHAR(30)    r     1 ATTR_NO_CURR_FMT
   420-0-0/c CHAR(29)    r     1 BLK_FMT                  625-0-0/c CHAR(42)    r     1 BLOCK_DEFAULT_FMT
   574-0-0/c CHAR(53)    r     1 BLOCK_ENTRY_FMT          557-0-0/c CHAR(52)    r     1 BLOCK_HDR_FMT
   612-0-0/c CHAR(41)    r     1 BLOCK_NETCON_FMT           6-0-0/c CHAR(34)    r     1 BOOTFID_FMT
    20-0-0/d BIT (72)    r     1 BOOTFID_VEC              760-0-0/c CHAR(35)    r     1 BOOTHDR_FMT
  1044-0-0/d BIT (72)    r     1 BOOTHDR_VEC             1046-0-0/c CHAR(23)    r     1 CHAN_FMT
   123-0-0/c CHAR(46)    r     1 CHAN_HD_FUL_FMT         1054-0-0/d BIT (72)    r     1 CHAN_VEC
  2042-0-0/c STRC(9432)  r     1 CHNFMT                    72-0-0/c CHAR(97)    r     1 CHN_DAT_FMT
    22-0-0/c CHAR(79)    r     1 CHN_HDR_FMT_1             46-0-0/c CHAR(79)    r     1 CHN_HDR_FMT_2
   274-0-0/c CHAR(42)    r     1 CN_FMT                   310-0-0/d BIT (72)    r     1 CN_VEC
  1132-0-0/w STRC(16407) r     1 CONFIG_FMT               534-0-0/c CHAR(12)    r     1 CURRENT_FMT
  2505-0-0/c CHAR(4)     r     1 DB_CHNTBL_TTYPS(0:10)
  1056-0-0/c CHAR(74)    r     1 DIHNDLR_FMT             1126-0-0/d BIT (72)    r     1 DIHNDLR_VEC
  2520-0-0/w CHAR(68)    r     1 HDR_FMT                 2640-0-0/w CHAR(69)    r     1 HDR_FMT
   771-0-0/c CHAR        r     1 HNDLRHDR_FMT            1042-0-0/d BIT (72)    r     1 HNDLRHDR_VEC
   456-0-0/c CHAR(27)    r     1 HNDLR_FMT                466-0-0/d BIT (72)    r     1 HNDLR_VEC
   240-0-0/c CHAR(44)    r     1 HST_FMT                  254-0-0/d BIT (72)    r     1 HST_VEC
  2541-0-0/w CHAR(42)    r     1 INDX_FMT                2607-0-0/w CHAR        r     1 INDX_NO_CURR_FMT
   204-0-0/c CHAR(14)    r     1 KS_NETSTAT              1002-0-0/c CHAR(25)    r     1 LIBACCT_FMT
  2450-0-0/w UBIN(18)    r     1 LINESPEED(0:15)
  1030-0-0/c CHAR(28)    r     1 LINKCHAN_FMT            1040-0-0/d BIT (72)    r     1 LINKCHAN_VEC
  1014-0-0/c CHAR(35)    r     1 LINK_FMT                1026-0-0/d BIT (72)    r     1 LINK_VEC
  1101-0-0/c CHAR(80)    r     1 LNCNFG_FMT              1130-0-0/d BIT (72)    r     1 LNCNFG_VEC
   402-0-0/c CHAR(42)    r     1 LNKCNCT_FMT              416-0-0/d BIT (72)    r     1 LNKCNCT_VEC
   346-0-0/c CHAR(42)    r     1 LNKNME_FMT               362-0-0/d BIT (72)    r     1 LNKNME_VEC
   364-0-0/c CHAR(42)    r     1 LNKNUM_FMT               400-0-0/d BIT (72)    r     1 LNKNUM_VEC
   640-0-0/w STRC(2412)  r     1 NETWORK_FMT              744-0-0/d BIT (72)    r     1 NETWORK_VEC
   210-0-0/c CHAR(35)    r     1 NET_STAT_FMT             222-0-0/d BIT (72)    r     1 NET_STAT_VEC
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:328  
   444-0-0/c CHAR(27)    r     1 NHNDLR_FMT               224-0-0/c CHAR(37)    r     1 NODE_FMT
   236-0-0/d BIT (72)    r     1 NODE_VEC                 511-0-0/c CHAR(17)    r     1 PARAM_CHAR_FMT
   474-0-0/c CHAR(17)    r     1 PARAM_FMT                516-0-0/c CHAR(17)    r     1 PARAM_HEX_FMT
  2704-0-0/w CHAR(16)    r     1 PARM_DISPONLY_FMT       2576-0-0/w CHAR        r     1 PARM_FMT
  2662-0-0/w CHAR(38)    r     1 PARM_FMT                2630-0-0/w CHAR(30)    r     1 PARM_NO_CURR_FMT
  2674-0-0/w CHAR(32)    r     1 PARM_NO_CURR_FMT         746-0-0/c CHAR(30)    r     1 PSEUDOHDR_FMT
   756-0-0/d BIT (72)    r     1 PSEUDOHDR_VEC            470-0-0/c CHAR(7)     r     1 PSEUDO_FMT
   142-0-0/c CHAR(54)    r     1 PSEUDO_NME_FMT           160-0-0/d VECT        r     1 PSEUDO_NME_VEC
   162-0-0/c CHAR(59)    r     1 PSEUDO_USR_FMT           202-0-0/d VECT        r     1 PSEUDO_USR_VEC
   312-0-0/c CHAR(41)    r     1 QOS_FMT                  326-0-0/d BIT (72)    r     1 QOS_VEC
  2554-0-0/w CHAR        r     1 RES_FMT                  430-0-0/c CHAR(6)     r     1 SHORT_HDR_FMT
   432-0-0/c CHAR(23)    r     1 SHORT_LINE_FMT           440-0-0/d BIT (72)    r     1 SHORT_LINE_VEC
  2470-0-0/c CHAR(4)     r     1 STATE(0:12)
     0-0-0/c CHAR(4)     r     1 TEXT_NODETYPE(0:5)
   537-0-0/c CHAR(31)    r     1 USRPARM_ENTRY_FMT        523-0-0/c CHAR(35)    r     1 USRPARM_HDR_FMT
   547-0-0/c CHAR(32)    r     1 USRPARM_NETCON_FMT

  ****  Section 002  Data  KSC$DISPLAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   150-0-0/c CHAR        r     1 CHAR_BUF(0:400)            3-0-0/w PTR         r     1 CNFG$
     4-0-0/w UBIN        r     1 CNFG_BUFFER(0:49)
    66-0-0/w UBIN        r     1 DEF_BUFFER(0:49)
     0-0-0/b BIT         r     1 FIRST                    315-0-0/w PTR         r     1 HANDLER$
   357-0-0/c STRC(171)   r     1 KS$CONFIG_KEY            316-0-0/w STRC(1188)  r     1 KS_ADMIN
   367-0-0/w STRC(396)   r     1 KS_CONTROL               364-0-0/w STRC(99)    r     1 KS_DEFAULT_KEY
     1-0-0/b BIT         r     1 KS_DISP_RNG             1214-0-0/w STRC(936)   r     1 KS_FEPBOOT
  1246-0-0/w STRC(27)    r     1 KS_FEPBOOT_KEY          1247-0-0/w STRC(1116)  r     1 KS_FEPCTL
  1306-0-0/w STRC(27)    r     1 KS_FEPCTL_KEY           1307-0-0/w STRC(1656)  r     1 KS_FEPHNDLR
  6371-0-0/w STRC(27)    r     1 KS_FEPHNDLR_KEY         1211-0-0/w STRC(99)    r     1 KS_HANDLER_KEY
  6372-0-0/w STRC(27)    r     1 KS_LINK_KEY             6462-0-0/d STRC(432)   r     1 KS_MONINFO_F
  6476-0-0/d STRC(540)   r     1 KS_MONINFO_V            1365-0-0/w STRC(46116) r     1 KS_NETWORK
  3766-0-0/w STRC(18)    r     1 KS_NETWORK_KEY          6444-0-0/d STRC(288)   r     1 KS_NODEINFO_F
  6454-0-0/d STRC(216)   r     1 KS_NODEINFO_V            402-0-0/w STRC(12888) r     1 KS_PSEUDO
  1150-0-0/w STRC(27)    r     1 KS_PSEUDO_KEY           3770-0-0/w STRC(46116) r     1 KS_RFEP
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:329  
  3767-0-0/w STRC(18)    r     1 KS_RFEP_KEY             6432-0-0/d STRC(360)   r     1 PREC_NETCON
  6414-0-0/d STRC(504)   r     1 READ_NETCON             6516-0-0/d STRC(504)   r     1 READ_NETWORK
  6410-0-0/c CHAR(11)    r     1 UNKNOWN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   364-0-0/w PTR         r     1 @CURRENT_VAL             357-0-0/w PTR         r     1 @CURRENT_VAL
   357-0-0/w PTR         r     1 @FLAG                    356-0-0/w PTR         r     1 @INDX
   363-0-0/w PTR         r     1 @INDX                    365-0-0/w PTR         r     1 @NETCON_VAL
   360-0-0/w PTR         r     1 @NETCON_VAL              366-0-0/w PTR         r     1 @NO_CURRENT_VAL
   361-0-0/w PTR         r     1 @NO_CURRENT_VAL          361-0-0/w PTR         r     1 @PARMTYPE
   355-0-0/w PTR         r     1 @PARMTYPE                355-0-0/w PTR         r     1 @PARMX
   362-0-0/w PTR         r     1 @PARMX                   356-0-0/w PTR         r     1 @PARMX
   355-0-0/w PTR         r     1 @PTR$                    360-0-0/w PTR         r     1 @TEXT
     3-0-0/w PTR         r     1 @TOP$                     66-0-0/w UBIN        r     1 ATTR
    41-0-0/w UBIN        r     1 ATTRIBUTE                215-0-0/w UBIN        r     1 BINDX
   173-0-0/w PTR         r     1 BLK$                     210-0-0/d VECT        r     1 BLOCK_VEC
   331-0-0/w UBIN        r     1 CHAN                     332-0-0/w UBIN        r     1 CHANHI
   333-0-0/w UBIN        r     1 CHANLO                    46-0-0/b BIT         r     1 CHAN_DISP_FULL
   217-0-0/w STRC(1980)  r     1 CHNTBL                   306-0-0/w STRC(576)   r     1 CHNTBL_SUM
   351-0-0/w UBIN        r     1 CODE                     372-0-0/w UBIN        r     1 CURRENT_DISP
   362-0-0/w UBIN        r     1 CURRENT_DISP              *0-0-0/h UBIN(18)    r     1 CURRENT_VAL
    *0-0-0/h UBIN(18)    r     1 CURRENT_VAL              216-0-0/w PTR         r     1 D$
   373-0-0/w UBIN        r     1 DEFAULT                  363-0-0/w UBIN        r     1 DEFAULT
    73-0-0/w UBIN        r     1 DEF_OPT                  201-0-0/c CHAR(8)     r     1 FEPNAME
   200-0-0/w SBIN        r     1 FEPNODE                   67-0-0/b BIT         r     1 FIRST_PARM
   330-0-0/w UBIN        r     1 FIRST_SUBLK               *0-0-0/b BIT         r     1 FLAG
   352-0-0/w UBIN(18)    r     1 FORM                      64-0-0/b BIT         r     1 HDR_FLAG
    75-0-0/w UBIN        r     1 I                        103-0-0/w UBIN        r     1 INDX
    *0-0-0/w UBIN        r     1 INDX                      *0-0-0/w UBIN        r     1 INDX
   371-0-0/w UBIN        r     1 INDX_NAME                 71-0-0/w PTR         r     1 IPARAM$
    77-0-0/w UBIN        r     1 J                        357-0-0/w UBIN        r     1 J
    14-0-0/w STRC(576)   r     1 KH$CHN                   213-0-0/w SBIN        r     1 KS_CHKNODE
    34-0-0/c STRC(171)   r     1 KS_CONFIG_KEY             42-0-0/c CHAR(3)     r     1 KS_YES_NO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:330  
    45-0-0/w UBIN        r     1 L                        327-0-0/w UBIN        r     1 LAST
   326-0-0/w UBIN        r     1 LAST_DI                  341-0-0/w UBIN        r     1 LEV
   375-0-0/w UBIN        r     1 MAX                      365-0-0/w UBIN        r     1 MAX
    74-0-0/w UBIN        r     1 MAX_PARM                 374-0-0/w UBIN        r     1 MIN
   364-0-0/w UBIN        r     1 MIN                      367-0-0/w UBIN        r     1 NETCON_DISP
    *0-0-0/b UBIN(18)    r     1 NETCON_VAL                *0-0-0/w UBIN        r     1 NETCON_VAL
    44-0-0/b BIT         r     1 NODESLCT                 177-0-0/c CHAR(4)     r     1 NODETYPE
    70-0-0/w BIT         r     1 NO_CURRENT_VAL            *0-0-0/w BIT         r     1 NO_CURRENT_VAL
    *0-0-0/w BIT         r     1 NO_CURRENT_VAL            47-0-0/b BIT         r     1 ONE_CHAN_FLAG
    72-0-0/b BIT         r     1 ONE_PARM_ONLY             50-0-0/w STRC(72)    r     1 OPT(0:5)
    65-0-0/b BIT         r     1 OPTION_SATISFIED         102-0-0/w UBIN        r     1 PARMTYPE
    *0-0-0/w UBIN        r     1 PARMTYPE                  *0-0-0/w UBIN        r     1 PARMTYPE
   101-0-0/w UBIN        r     1 PARMX                     *0-0-0/w UBIN        r     1 PARMX
    *0-0-0/w UBIN        r     1 PARMX                     *0-0-0/w UBIN        r     1 PARMX
   175-0-0/w PTR         r     1 PTR$                      *0-0-0/w PTR         r     1 PTR$
   175-0-0/w BIT         r     1 PTR$_R                   214-0-0/w PTR         r     1 S$
    76-0-0/w UBIN        r     1 SBLK                     370-0-0/w PTR         r     1 SPCL_TBL$
   342-0-0/w UBIN        r     1 SUBDEV                   336-0-0/w UBIN        r     1 SUBHI
   174-0-0/w PTR         r     1 SUBLK$                   353-0-0/w UBIN(9)     r     1 SUBLK_INDX
   335-0-0/w UBIN        r     1 SUBLO                    343-0-0/w UBIN        r     1 SUBSUBDEV
   337-0-0/w UBIN        r     1 SUBSUBHI                 340-0-0/w UBIN        r     1 SUBSUBLO
    10-0-0/c STRC(144)   r     1 TERMHI                     4-0-0/c STRC(144)   r     1 TERMLO
    *0-0-0/c CHAR(4)     r     1 TEXT                      *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC        r     1 KS_ERRCODE
     0-0-0/w STRC(180)   r     1 KS_HAND_INFO(0:0)
     0-0-0/w UBIN(9)     r     1 KS_HNDLRINDX               0-0-0/c CHAR(8)     r     1 KS_HNDLRNAME
     0-0-0/c CHAR(400)   r     1 KS_MSGBUF                  0-0-0/w PTR         r     1 KS_MSGBUF$
     0-0-0/w SBIN        r     1 KS_NODE                    0-0-0/c CHAR(8)     r     1 KS_NODENAME
     0-0-0/c CHAR(8)     r     1 KS_NODENAME_SV             0-0-0/w UBIN        r     1 KS_NODE_SV
     0-0-0/w UBIN(9)     r     1 KS_SELPRMOPT               0-0-0/w STRC(288)   r     1 KS_SUB_BUF_1
     0-0-0/w STRC(288)   r     1 KS_SUB_BUF_2               0-0-0/w PTR         r     1 KS_TBL(0:0)
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:331  

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1188)  r     1 ADMIN                      0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/h UBIN(18)    r     1 B$PARAM(0:0)
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/w STRC(396)   r     1 CONTROL
     0-0-0/b BIT         r     1 D_R(0:17)                  0-0-0/b BIT         r     1 D_R_W(0:35)
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/b STRC(19)    r     1 HND
     0-0-0/w STRC(1062)  r     1 KS$HNDLR
     0-0-0/w STRC(144)   r     1 KS$PARAM(0:0)
     0-0-0/w STRC(144)   r     1 KS$PARAM_SPCL(0:0)
     0-0-0/w STRC(144)   r     1 KS$PARAM_SPCL(0:0)
     0-0-0/w ASTR(387)   r     1 KS_CNFG_BUF                0-0-0/w STRC(54)    r     1 KS_LINK
     0-0-0N  NULL        r     1 M$NETCON                   0-0-0/c ASTR(9)     r     1 NAME
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/b BIT         r     1 S_R(0:17)                  0-0-0/b BIT         r     1 S_R_W(0:35)


   Procedure KSC$DISPLAY requires 4998 words for executable code.
   Procedure KSC$DISPLAY requires 306 words of local(AUTO) storage.
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:332  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:333  
          MINI XREF LISTING

ACTV_FMT
     13461**DCL     13462--DCLINIT
ACTV_VEC
     13462**DCL     16468<>CALL
ADMIN.KS_CHN
     15265**DCL     16887>>ASSIGN  16913>>ASSIGN  16959>>ASSIGN
ADMIN.KS_CHN.TERMID
     15357**DCL     16915>>IF
ADMIN.KS_CHN.TERMID.TERM
     15359**DCL     15368--REDEF
ADMIN.RESULTS
     15150**DCL     16957>>IF
ADMIN.RESULTS.ERR#
     15178**DCL     16907>>IF      16954>>IF      16954>>IF
ADMIN.TERMID_HI.TERM
     15236**DCL     15245--REDEF
ADMIN.TERMID_LO.TERM
     15207**DCL     15216--REDEF
ADMIN.TERMID_LO.TERM.CHANNEL
     15209**DCL     16911>>IF
ADMIN.TYPE
     15126**DCL     16910>>IF
ALT_FMT
     13467**DCL     13468--DCLINIT
ALT_VEC
     13468**DCL     16476<>CALL
ATTR
     15848**DCL     17722<>CALL    17723>>IF
ATTRIBUTE
     15836**DCL     16678--ASSIGN  16680<<ASSIGN  16687<<ASSIGN  16693--ASSIGN  16695<<ASSIGN  16702<<ASSIGN
     16709--CALL
ATTR_FMT IN PROCEDURE DISPARM
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:334  
     17402**DCL     17565--CALL
ATTR_NO_CURR_FMT IN PROCEDURE DISPARM
     17475**DCL     17558--CALL
B$ALT.CODE
     14707**DCL     14707--REDEF   14708--REDEF   14708--REDEF
B$ALT.ERR.CODE
     14709**DCL     16378>>IF      16501>>IF      16651>>IF      16741>>IF      16982>>IF
B$ALT.ERR.ERR#
     14709**DCL     14709--REDEF
B$ALT.EVID
     14708**DCL     14708--REDEF   14708--REDEF
B$PARAM
     14713**DCL     17378<>CALL
B$TCB.ALT$
     14703**DCL     16378>>IF      16501>>IF      16651>>IF      16741>>IF      16982>>IF
B$TCB$
     13332**DCL     16378>>IF      16501>>IF      16651>>IF      16741>>IF      16982>>IF
BINDX
     16144**DCL     16681<<DOINDEX 16682>>ASSIGN  16682>>ASSIGN  16684<<DOINDEX 16685>>ASSIGN  16685>>ASSIGN
     16696<<DOINDEX 16697>>ASSIGN  16697>>ASSIGN  16699<<DOINDEX 16700>>ASSIGN  16700>>ASSIGN  17697<<DOINDEX
     17698>>ASSIGN  17698>>ASSIGN  17700<<DOINDEX 17701>>ASSIGN  17701>>ASSIGN  17814<<DOINDEX 17815>>ASSIGN
     17815>>ASSIGN  17817<<DOINDEX 17818>>ASSIGN  17818>>ASSIGN  17826<<DOINDEX 17827>>ASSIGN  17827>>ASSIGN
     17829<<DOINDEX 17830>>ASSIGN  17830>>ASSIGN  17838<<DOINDEX 17839>>ASSIGN  17839>>ASSIGN  17841<<DOINDEX
     17842>>ASSIGN  17842>>ASSIGN  17850<<DOINDEX 17851>>ASSIGN  17851>>ASSIGN  17853<<DOINDEX 17854>>ASSIGN
     17854>>ASSIGN  17898<<DOINDEX 17899>>ASSIGN  17899>>ASSIGN  17901<<DOINDEX 17902>>ASSIGN  17902>>ASSIGN
     17904<<DOINDEX 17905>>ASSIGN  17905>>ASSIGN  17907<<DOINDEX 17908>>ASSIGN  17908>>ASSIGN
BLK$
     15871**DCL     16327<<ASSIGN  16328>>DOCASE  16330>>IF      16332>>CALL    16389>>IF      16396>>IF
     16396>>IF      16399>>ASSIGN  16400>>IF      16403>>ASSIGN  16404>>ASSIGN  16414>>ASSIGN  16415>>ASSIGN
     16534>>IF      16536>>CALL    16549>>IF      16556>>ASSIGN  16557>>ASSIGN  16557>>ASSIGN  16562>>ASSIGN
     16562>>ASSIGN  16574>>IF      16578>>ASSIGN  16578>>ASSIGN  16589>>IF      16605>>CALL    16610>>IF
     16612>>CALL    16673>>IF      16778>>IF      16780>>IF      16782>>CALL    16828>>IF      16830>>ASSIGN
     16839>>ASSIGN  16842>>CALL    16843>>IF      16845>>CALL    16863>>ASSIGN  16999>>IF      17007>>ASSIGN
     17013>>CALL    17017>>ASSIGN  17017>>ASSIGN  17018>>ASSIGN  17089>>DOCASE  17092>>ASSIGN  17112>>ASSIGN
     17222>>ASSIGN  17258>>IF      17261>>ASSIGN  17325>>ASSIGN
BLK_FMT
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:335  
     13475**DCL     14669--DCLINIT
BLOCK_DEFAULT_FMT
     13503**DCL     17298--CALL
BLOCK_ENTRY_FMT
     13501**DCL     17285--CALL
BLOCK_HDR_FMT
     13500**DCL     17269--CALL
BLOCK_NETCON_FMT
     13502**DCL     17295--CALL
BLOCK_VEC
     15882**DCL     17296<<ASSIGN  17297<<ASSIGN  17298<>CALL
BOOTFID_FMT
     13428**DCL     13429--DCLINIT
BOOTFID_VEC
     13429**DCL     16355<>CALL
BOOTHDR_FMT
     13520**DCL     13532--DCLINIT
BOOTHDR_VEC
     13532**DCL     16347<>CALL
CHAN
     16272**DCL     16890<<DOINDEX 16895>>CALL    16896>>IF      16899>>CALL    16937<<DOINDEX 16938<>CALL
CHANHI
     16273**DCL     16806<<ASSIGN  16813<>CALL    16874<>CALL    16890>>DOINDEX 16896>>IF      16897<>CALL
     16930<>CALL    16937>>DOINDEX
CHANLO
     16274**DCL     16807<<ASSIGN  16812<>CALL    16873<>CALL    16890>>DOINDEX 16929<>CALL    16937>>DOINDEX
CHAN_DISP_FULL
     15841**DCL     16821<<ASSIGN  16854<<ASSIGN  16860<<ASSIGN  17742>>IF
CHAN_FMT
     13533**DCL     13534--DCLINIT
CHAN_HD_FUL_FMT
     13440**DCL     13441--DCLINIT
CHAN_LOOP
     16890**LABEL   16912--EXIT    16916--EXIT
CHAN_VEC
     13534**DCL     17075<>CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:336  
CHAR_BUF
     13812**DCL     13813--DCLINIT 16358--ASSIGN  16359--ASSIGN  17202--CALL    17250--CALL    17251--ASSIGN
     17253--CALL    17292--CALL    17293--ASSIGN  17295--CALL    17374--CALL    17376--ASSIGN  17377--ASSIGN
     17379--ASSIGN
CHNFMT
     13588**DCL     17799--CALL
CHNTBL
     16191**DCL     17799--CALL
CHNTBL.ATTR
     16199**DCL     17694--ASSIGN  17696<<ASSIGN  17703<<ASSIGN  17723>>IF      17755<>CALL
CHNTBL.AUTBAD
     16202**DCL     17771<>CALL
CHNTBL.AUTLGN
     16205**DCL     17748<>CALL
CHNTBL.AUTLGNFAILED
     16201**DCL     17749<>CALL
CHNTBL.BLOCK
     16208**DCL     17787<>CALL
CHNTBL.BRKRQ
     16211**DCL     17744<>CALL
CHNTBL.BUG
     16214**DCL     17773<>CALL
CHNTBL.CLK
     16220**DCL     17745<>CALL
CHNTBL.CTR
     16212**DCL     17764<>CALL
CHNTBL.CTR_DWNLD
     16217**DCL     17765<<ASSIGN
CHNTBL.CTX$
     16223**DCL     17785<>CALL
CHNTBL.DBG
     16229**DCL     17747<>CALL
CHNTBL.DC1DC3NTWOTPFLWCTR
     16204**DCL     17774<>CALL
CHNTBL.DED
     16226**DCL     17780<>CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:337  
CHNTBL.DRCCNC
     16235**DCL     17757<>CALL
CHNTBL.DRPDTR
     16241**DCL     17770<>CALL
CHNTBL.DSBHSTDWN
     16244**DCL     17775<>CALL
CHNTBL.DVCID
     16232**DCL     17752<>CALL
CHNTBL.DWNLOD
     16238**DCL     17760<>CALL
CHNTBL.ECHLGN
     16200**DCL     17779<>CALL
CHNTBL.ENB
     16203**DCL     17763<>CALL
CHNTBL.ENBHSTUP
     16206**DCL     17777<>CALL
CHNTBL.EXTDVCID
     16209**DCL     17753<>CALL
CHNTBL.HAND$
     16215**DCL     17797<>CALL
CHNTBL.INP
     16227**DCL     17758<>CALL
CHNTBL.INPBFRBYTSIZ
     16218**DCL     17784<>CALL
CHNTBL.INPCCBCNT
     16221**DCL     17761<<ASSIGN
CHNTBL.INPCCBSTTPTRVLD
     16224**DCL     17768<>CALL
CHNTBL.INTCNT
     16230**DCL     17786<>CALL
CHNTBL.KLLHSTDWN
     16233**DCL     17776<>CALL
CHNTBL.LCT55
     16236**DCL     17767<<ASSIGN
CHNTBL.LGNTIMOUTPRD
     16239**DCL     17782<<ASSIGN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:338  
CHNTBL.LINSPD
     16242**DCL     17772<<ASSIGN
CHNTBL.LNK$
     16245**DCL     17796<>CALL
CHNTBL.OTP
     16213**DCL     17759<>CALL
CHNTBL.OTPCCBCNT
     16207**DCL     17766<<ASSIGN
CHNTBL.OTPCCBSTTPTRVLD
     16210**DCL     17769<>CALL
CHNTBL.PROFILE
     16216**DCL     17750<>CALL
CHNTBL.REDTIMOUTPRD
     16222**DCL     17781<<ASSIGN
CHNTBL.RESOURCE
     16228**DCL     17754<<CALLBLT
CHNTBL.RE_ENB
     16219**DCL     17762<>CALL
CHNTBL.RMTHST
     16225**DCL     17746<>CALL
CHNTBL.SNDSLT
     16231**DCL     17778<>CALL
CHNTBL.STT
     16234**DCL     17751<<ASSIGN
CHNTBL.SUB$
     16237**DCL     17795<>CALL
CHNTBL.SYSID
     16240**DCL     17756<>CALL
CHNTBL.TERMID.CHANNEL
     16193**DCL     17789<>CALL
CHNTBL.TERMID.LEV
     16196**DCL     17794<<ASSIGN
CHNTBL.TERMID.SUBDEVICE
     16194**DCL     17790<>CALL
CHNTBL.TERMID.SUBSUBDEVICE
     16195**DCL     17791<>CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:339  
CHNTBL.TERMID.TERM_NAME
     16198**DCL     17792<<ASSIGN
CHNTBL.TERMID.TTYP
     16197**DCL     17793<<ASSIGN
CHNTBL.TPTIMOUTPRD
     16243**DCL     17783<<ASSIGN
CHNTBL.UNBLOCK
     16246**DCL     17788<>CALL
CHNTBL_SUM
     16248**DCL     17925--CALL
CHNTBL_SUM.ATTR
     16252**DCL     17847--ASSIGN  17849<<ASSIGN  17856<<ASSIGN
CHNTBL_SUM.CHANNEL
     16249**DCL     17823--ASSIGN  17825<<ASSIGN  17832<<ASSIGN
CHNTBL_SUM.CTX$
     16253**DCL     17895--ASSIGN  17897<<ASSIGN  17910<<ASSIGN
CHNTBL_SUM.DRCCNC
     16256**DCL     17921<<ASSIGN  17923<<ASSIGN
CHNTBL_SUM.DRPDTR
     16257**DCL     17914<<ASSIGN  17916<<ASSIGN
CHNTBL_SUM.DVCID
     16250**DCL     17811--ASSIGN  17813<<ASSIGN  17820<<ASSIGN
CHNTBL_SUM.DWNLOD
     16258**DCL     17878<<ASSIGN  17880<<ASSIGN
CHNTBL_SUM.ENB
     16259**DCL     17884<<ASSIGN  17886<<ASSIGN
CHNTBL_SUM.EXTDVCID
     16251**DCL     17835--ASSIGN  17837<<ASSIGN  17844<<ASSIGN
CHNTBL_SUM.INP
     16260**DCL     17866<<ASSIGN  17868<<ASSIGN
CHNTBL_SUM.INPCCBCNT
     16264**DCL     17890<<ASSIGN
CHNTBL_SUM.LGNTIMOUTPRD
     16266**DCL     17893<<ASSIGN
CHNTBL_SUM.OTP
     16261**DCL     17872<<ASSIGN  17874<<ASSIGN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:340  
CHNTBL_SUM.OTPCCBCNT
     16265**DCL     17891<<ASSIGN
CHNTBL_SUM.REDTIMOUTPRD
     16267**DCL     17892<<ASSIGN
CHNTBL_SUM.RESOURCE
     16254**DCL     17918<<ASSIGN
CHNTBL_SUM.SNDSLT
     16262**DCL     17860<<ASSIGN  17862<<ASSIGN
CHNTBL_SUM.STT
     16255**DCL     17888<<ASSIGN
CHN_DAT_FMT
     13438**DCL     17925--CALL
CHN_HDR_FMT_1
     13436**DCL     17805--CALL
CHN_HDR_FMT_2
     13437**DCL     17806--CALL
CNFG$
     13809**DCL     14795--IMP-PTR
CNFG_BUFFER
     13810**DCL     13809--DCLINIT 16563--ASSIGN  16600<<ASSIGN  16602--ASSIGN  16637<<ASSIGN  16648--CALL
     16658--ASSIGN  16712--CALL    16736<<ASSIGN  16738--ASSIGN
CN_FMT
     13463**DCL     13464--DCLINIT
CN_VEC
     13464**DCL     16473<>CALL
CODE
     16288**DCL     16839<<ASSIGN  16840>>DOCASE  16863>>ASSIGN  16864>>ASSIGN  16864>>ASSIGN  16927>>IF
CONFIG_FMT
     13545**DCL     16712--CALL
CONTROL.TYPE
     15409**DCL     17143>>IF      17158>>IF      17196>>IF      17235>>IF      17277>>IF      17368>>IF
CONTROL.VALUE
     15496**DCL     17148<>CALL    17164<>CALL    17213<>CALL    17243--CALL    17285--CALL    17378<>CALL
CURRENT_DISP IN PROCEDURE DISPARM
     17394**DCL     17488<>CALL    17509--CALL    17514<>CALL    17535--CALL    17552<>CALL    17565--CALL
     17573<>CALL    17574<<ASSIGN  17574>>ASSIGN  17587--CALL    17595<>CALL    17608--CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:341  
CURRENT_DISP IN PROCEDURE DISP_NONHAND_PARM
     17634**DCL     17654<>CALL    17656>>IF      17657<<ASSIGN  17664--CALL    17681--CALL
CURRENT_FMT
     13497**DCL     17238--CALL    17280--CALL
CURRENT_VAL IN PROCEDURE DISPARM
     17388**DCL     17383--PROC    17488<>CALL    17514<>CALL    17543<<ASSIGN  17544--CALL    17552<>CALL
     17573<>CALL    17595<>CALL
CURRENT_VAL IN PROCEDURE DISP_NONHAND_PARM
     17633**DCL     17629--PROC    17654<>CALL
C_LOOP
     16937**LABEL   16969--EXIT
D$
     16145**DCL     16146--IMP-PTR 16147--IMP-PTR 16678<<ASSIGN  16682>>ASSIGN  16685>>ASSIGN  16687>>ASSIGN
     16693<<ASSIGN  16697>>ASSIGN  16700>>ASSIGN  16702>>ASSIGN  17694<<ASSIGN  17698>>ASSIGN  17701>>ASSIGN
     17703>>ASSIGN  17811<<ASSIGN  17815>>ASSIGN  17818>>ASSIGN  17820>>ASSIGN  17823<<ASSIGN  17827>>ASSIGN
     17830>>ASSIGN  17832>>ASSIGN  17835<<ASSIGN  17839>>ASSIGN  17842>>ASSIGN  17844>>ASSIGN  17847<<ASSIGN
     17851>>ASSIGN  17854>>ASSIGN  17856>>ASSIGN  17895<<ASSIGN  17899>>ASSIGN  17902>>ASSIGN  17905>>ASSIGN
     17908>>ASSIGN  17910>>ASSIGN
DB_CHNTBL_TTYPS
     13722**DCL     17793>>ASSIGN
DEFAULT IN PROCEDURE DISPARM
     17395**DCL     17490<<ASSIGN  17494--CALL    17509--CALL    17516<<ASSIGN  17520--CALL    17535--CALL
     17539<<ASSIGN  17544--CALL    17554<<ASSIGN  17558--CALL    17565--CALL    17576<<ASSIGN  17580--CALL
     17587--CALL    17597<<ASSIGN  17601--CALL    17608--CALL
DEFAULT IN PROCEDURE DISP_NONHAND_PARM
     17637**DCL     17670<<ASSIGN  17674--CALL    17681--CALL
DEF_BUFFER
     13811**DCL     16582--ASSIGN  16712--CALL
DEF_OPT
     15853**DCL     16559<<ASSIGN  16576<<ASSIGN  16587<<ASSIGN  16712--CALL
DIHNDLR_FMT
     13538**DCL     13540--DCLINIT
DIHNDLR_VEC
     13540**DCL     16566<>CALL
DISPARM
     17383**PROC    17213--CALL    17378--CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:342  
DISPLAY_CHAN
     17692**PROC    16888--CALL    16914--CALL    16967--CALL
DISPLAY_INDEXED_PARM
     17354**PROC    17224--CALL    17264--CALL
DISP_ERR
     17310**LABEL   16350--CALLALT 16354--CALLALT 16363--CALLALT 16379--GOTO    16418--CALLALT 16446--CALLALT
     16565--CALLALT 16584--CALLALT 16608--GOTO    16661--CALLALT 16664--GOTO    16665--CALLALT 16669--GOTO
     16744--GOTO    16794--CALLALT 16842--CALLALT 16845--CALLALT 16983--GOTO    17071--CALLALT 17250--CALLALT
     17292--CALLALT
DISP_ERR IN PROCEDURE DISPLAY_INDEXED_PARM
     17381**LABEL   17374--CALLALT
DISP_NONHAND_PARM
     17629**PROC    17148--CALL    17164--CALL
DI_FROM_NETCON
     17290**LABEL   17275--CALLALT 17276--CALLALT 17278--GOTO    17283--CALLALT 17284--CALLALT
DI_USRPARM_FROM_NETCON
     17248**LABEL   17233--CALLALT 17234--CALLALT 17236--GOTO    17241--CALLALT 17242--CALLALT
D_R
     16146**DCL     16682<<ASSIGN  16685<<ASSIGN  16687>>ASSIGN  16697<<ASSIGN  16700<<ASSIGN  16702>>ASSIGN
     17698<<ASSIGN  17701<<ASSIGN  17703>>ASSIGN  17815<<ASSIGN  17818<<ASSIGN  17820>>ASSIGN  17827<<ASSIGN
     17830<<ASSIGN  17832>>ASSIGN  17839<<ASSIGN  17842<<ASSIGN  17844>>ASSIGN  17851<<ASSIGN  17854<<ASSIGN
     17856>>ASSIGN
D_R_W
     16147**DCL     17899<<ASSIGN  17902<<ASSIGN  17905<<ASSIGN  17908<<ASSIGN  17910>>ASSIGN
END_DI_NET_LOOP
     17050**LABEL   17020--GOTO
END_LOOP
     17310**LABEL   16734--GOTO    16742--GOTO    16750--GOTO    16754--GOTO    16803--GOTO    16849--GOTO
     16906--GOTO    17172--GOTO    17211--GOTO    17314--GOTO
ERR1
     17311**LABEL   16615--GOTO    16620--GOTO    16952--CALLALT 16958--GOTO
F$DCB.ACTPOS
     10340**DCL     10340--REDEF
F$DCB.ARS
     10315**DCL     10315--REDEF
F$DCB.ATTR
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:343  
     10333**DCL     10334--REDEF
F$DCB.BORROW
     10348**DCL     10348--REDEF   10348--REDEF   10348--REDEF
F$DCB.DCBNAME.L
     10362**DCL     10362--IMP-SIZ
F$DCB.EOMCHAR
     10319**DCL     10319--REDEF
F$DCB.FLDID
     10343**DCL     10343--REDEF
F$DCB.FORM$
     10337**DCL     10337--REDEF
F$DCB.FSECT
     10353**DCL     10353--REDEF
F$DCB.FSN
     10330**DCL     10330--REDEF   10330--REDEF   10331--REDEF
F$DCB.HEADER$
     10336**DCL     10336--REDEF
F$DCB.IXTNSIZE
     10334**DCL     10334--REDEF
F$DCB.LASTSTA$
     10324**DCL     10324--REDEF
F$DCB.LVL
     10349**DCL     10349--REDEF
F$DCB.NAME.C
     10324**DCL     10324--REDEF
F$DCB.NOEOF
     10345**DCL     10345--REDEF
F$DCB.NRECS
     10335**DCL     10335--REDEF
F$DCB.NRECX
     10354**DCL     10354--REDEF
F$DCB.OHDR
     10346**DCL     10346--REDEF
F$DCB.ORG
     10329**DCL     10329--REDEF
F$DCB.PRECNO
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:344  
     10352**DCL     10352--REDEF
F$DCB.RCSZ
     10357**DCL     10357--REDEF
F$DCB.RES
     10325**DCL     10325--REDEF
F$DCB.SETX
     10337**DCL     10337--REDEF
F$DCB.TAB$
     10336**DCL     10337--REDEF
F$DCB.TDA
     10351**DCL     10351--REDEF
F$DCB.WSN
     10326**DCL     10326--REDEF
FEPNAME
     15878**DCL     16336>>ASSIGN  16539>>ASSIGN  16786>>ASSIGN  17015>>IF      17340<<ASSIGN  17342>>IF
     17349<<ASSIGN
FEPNODE
     15877**DCL     16335>>ASSIGN  16427>>ASSIGN  16428>>IF      16428>>IF      16540>>ASSIGN  16784>>ASSIGN
     17014>>ASSIGN  17015>>IF      17015>>IF      17335<<ASSIGN  17343<<ASSIGN  17347<<CALLBLT 17348>>IF
     17349>>ASSIGN
FIRST
     13806**DCL     16560<<ASSIGN  16592<<ASSIGN  16624<<ASSIGN  16629<<ASSIGN  16722>>IF      16724<<ASSIGN
     17009<<ASSIGN  17040--CALL    17048<<ASSIGN
FIRST_PARM
     15849**DCL     17087<<ASSIGN  17094<<ASSIGN  17477>>IF      17480<<ASSIGN  17645>>IF      17650<<ASSIGN
FIRST_SUBLK
     16271**DCL     16388<<ASSIGN  16405<<ASSIGN  16423>>DOINDEX 16777<<ASSIGN  16787<<ASSIGN  16828>>IF
     16838>>DOINDEX
FLAG IN PROCEDURE YESNO
     17619**DCL     17617--PROC    17622>>IF
FORM
     16320**DCL     16391<<ASSIGN  16399<<ASSIGN  16412<<ASSIGN  16421>>IF      16447>>IF
GET_NODE
     17330**PROC    16332--CALL    16426--CALL    16536--CALL    16782--CALL    17013--CALL
HANDLER$
     13813**DCL     14729--IMP-PTR 16358<<ASSIGN  16368>>CALL    16368>>CALL    17213>>CALL    17377<<ASSIGN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:345  
     17378>>CALL    17379<<ASSIGN
HAND_RDCG_ERR
     17196**LABEL   17194--CALLALT 17195--CALLALT
HDR_FLAG
     15846**DCL     16869<<ASSIGN  17803>>IF      17807<<ASSIGN
HDR_FMT IN PROCEDURE DISPARM
     17399**DCL     17479--CALL
HDR_FMT IN PROCEDURE DISP_NONHAND_PARM
     17640**DCL     17649--CALL
HND.DAT
     15509**DCL     17174>>IF
HNDLRHDR_FMT
     13521**DCL     13531--DCLINIT
HNDLRHDR_VEC
     13531**DCL     16360<>CALL
HNDLR_CG_ERR IN PROCEDURE DISPLAY_INDEXED_PARM
     17368**LABEL   17365--CALLALT 17366--CALLALT
HNDLR_FMT
     13485**DCL     13486--DCLINIT
HNDLR_VEC
     13486**DCL     16368<>CALL
HST_FMT
     13459**DCL     13460--DCLINIT
HST_VEC
     13460**DCL     16462<>CALL
I
     15855**DCL     16326<<DOINDEX 16327>>ASSIGN  17074<<DOINDEX 17075--CALL    17075>>CALL    17341<<DOINDEX
     17342>>IF      17343>>ASSIGN  17707<<DOINDEX 17708>>IF      17713>>DOINDEX 17714>>DOCASE  17716>>IF
     17716>>IF      17722>>CALL    17729>>IF
INDX
     15861**DCL     17223<<ASSIGN  17224<>CALL    17239<<DOINDEX 17240<>CALL    17243--CALL    17263<<ASSIGN
     17264<>CALL    17281<<DOINDEX 17282<>CALL    17285--CALL
INDX IN PROCEDURE DISPARM
     17387**DCL     17383--PROC    17486>>ASSIGN  17490>>ASSIGN  17491>>ASSIGN  17492>>ASSIGN  17512>>ASSIGN
     17516>>ASSIGN  17517>>ASSIGN  17518>>ASSIGN
INDX IN PROCEDURE DISPLAY_INDEXED_PARM
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:346  
     17357**DCL     17354--PROC    17364<>CALL    17378<>CALL    17378>>CALL
INDX_FMT IN PROCEDURE DISPARM
     17400**DCL     17509--CALL    17535--CALL
INDX_NAME IN PROCEDURE DISPARM
     17393**DCL     17486<<ASSIGN  17494--CALL    17509--CALL    17512<<ASSIGN  17520--CALL    17535--CALL
INDX_NO_CURR_FMT IN PROCEDURE DISPARM
     17474**DCL     17494--CALL    17520--CALL
IPARAM$
     15851**DCL     17251<<ASSIGN  17253>>CALL    17293<<ASSIGN  17295>>CALL    17376<<ASSIGN  17377>>ASSIGN
J
     15857**DCL     16361<<DOINDEX 16362>>ASSIGN  16364>>IF      16368--CALL    16427<<ASSIGN  16436<<ASSIGN
     16437>>ASSIGN  16438>>ASSIGN  16453--CALL    16453>>CALL    16456--CALL    16456>>CALL    16513<<DOINDEX
     16514>>CALL    16514>>CALL    16514>>CALL    16518>>CALL    16518>>CALL    16518>>CALL    17014<<ASSIGN
     17024<<ASSIGN  17025>>IF      17027>>ASSIGN  17033>>ASSIGN  17040--CALL    17262<<DOINDEX 17263>>ASSIGN
     17713<<DOINDEX 17716>>IF      17716>>IF      17722>>CALL    17729>>IF
J IN PROCEDURE DISPLAY_INDEXED_PARM
     17358**DCL     17375<<ASSIGN  17376>>ASSIGN
KH$CHN
     15680**DCL     16887<<ASSIGN  16913<<ASSIGN  16959<<ASSIGN
KH$CHN.ATTR
     15710**DCL     17695--ASSIGN  17755<>CALL    17848--ASSIGN
KH$CHN.AUTBAD
     15734**DCL     17771<>CALL
KH$CHN.AUTLGN
     15691**DCL     17748<>CALL
KH$CHN.AUTLGNFAILED
     15692**DCL     17749<>CALL
KH$CHN.BLOCK
     15752**DCL     17787<>CALL
KH$CHN.BRKRQ
     15701**DCL     17744<>CALL
KH$CHN.BUG
     15738**DCL     17773<>CALL
KH$CHN.CCPDWNLD
     15701**DCL     17765>>ASSIGN
KH$CHN.CLK
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:347  
     15691**DCL     17745<>CALL
KH$CHN.CTR
     15723**DCL     17764<>CALL
KH$CHN.CTX$
     15750**DCL     16966>>ASSIGN  17785<>CALL    17896--ASSIGN
KH$CHN.DBG
     15691**DCL     17747<>CALL
KH$CHN.DC1DC3NTWOTPFLWCTR
     15738**DCL     17774<>CALL
KH$CHN.DED
     15740**DCL     17780<>CALL
KH$CHN.DRCCNC
     15718**DCL     17757<>CALL    17920>>IF
KH$CHN.DRPDTR
     15733**DCL     17770<>CALL    17913>>IF
KH$CHN.DSBHSTDWN
     15738**DCL     17775<>CALL
KH$CHN.DVCID
     15703**DCL     17752<>CALL    17812--ASSIGN
KH$CHN.DWNLOD
     15718**DCL     17760<>CALL    17877>>IF
KH$CHN.ECHLGN
     15739**DCL     17779<>CALL
KH$CHN.ENB
     15723**DCL     17763<>CALL    17883>>IF
KH$CHN.ENBHSTUP
     15739**DCL     17777<>CALL
KH$CHN.EXTDVCID
     15703**DCL     17753<>CALL    17836--ASSIGN
KH$CHN.HAND$
     15787**DCL     17797<>CALL
KH$CHN.INP
     15718**DCL     17758<>CALL    17865>>IF
KH$CHN.INPBFRBYTSIZ
     15744**DCL     17784<>CALL
KH$CHN.INPCCBCNT
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:348  
     15719**DCL     17761>>ASSIGN  17890>>ASSIGN
KH$CHN.INPCCBSTTPTRVLD
     15733**DCL     17768<>CALL
KH$CHN.INTCNT
     15752**DCL     17786<>CALL
KH$CHN.KLLHSTDWN
     15739**DCL     17776<>CALL
KH$CHN.LCT55.BYT
     15726**DCL     17767>>ASSIGN
KH$CHN.LGNTIMOUTPRD.BYT
     15743**DCL     17782>>ASSIGN  17893>>ASSIGN
KH$CHN.LINSPD
     15734**DCL     17772>>ASSIGN
KH$CHN.LNK$
     15787**DCL     16962>>ASSIGN  17796<>CALL
KH$CHN.OTP
     15718**DCL     17759<>CALL    17871>>IF
KH$CHN.OTPCCBCNT
     15724**DCL     17766>>ASSIGN  17891>>ASSIGN
KH$CHN.OTPCCBSTTPTRVLD
     15733**DCL     17769<>CALL
KH$CHN.PROFILE
     15692**DCL     17750<>CALL
KH$CHN.REDTIMOUTPRD.BYT
     15742**DCL     17781>>ASSIGN  17892>>ASSIGN
KH$CHN.RESOURCE
     15708**DCL     17716>>IF      17754>>CALLBLT 17918>>ASSIGN
KH$CHN.RE_ENB
     15723**DCL     17762<>CALL
KH$CHN.RMTHST
     15691**DCL     17746<>CALL
KH$CHN.SNDSLT
     15739**DCL     17778<>CALL    17859>>IF
KH$CHN.STT.BYT
     15694**DCL     17729>>IF      17751>>ASSIGN  17888>>ASSIGN
KH$CHN.SUB$
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:349  
     15787**DCL     17795<>CALL
KH$CHN.SYSID
     15710**DCL     17756<>CALL
KH$CHN.TERMID.LEV
     15776**DCL     17794>>ASSIGN
KH$CHN.TERMID.TERM
     15776**DCL     15785--REDEF
KH$CHN.TERMID.TERM.CHANNEL
     15778**DCL     17789<>CALL    17824--ASSIGN
KH$CHN.TERMID.TERM.SUBDEVICE
     15778**DCL     17790<>CALL
KH$CHN.TERMID.TERM.SUBSUBDEVICE
     15779**DCL     17791<>CALL
KH$CHN.TERMID.TERM.TERM_NAME
     15785**DCL     17792>>ASSIGN
KH$CHN.TERMID.TTYP
     15776**DCL     17793>>ASSIGN
KH$CHN.TPTIMOUTPRD.BYT
     15744**DCL     17783>>ASSIGN
KH$CHN.UNBLOCK
     15753**DCL     17788<>CALL
KS$CONFIG_KEY
     14111**DCL     16572>>ASSIGN
KS$CONFIG_KEY.TERMID.TERM
     14133**DCL     14142--REDEF
KS$HNDLR.HNDLRFID
     14730**DCL     16368--CALL
KS$HNDLR.HNDLRNAME
     14733**DCL     16368--CALL
KS$HNDLR.IPARAM.OFFSET
     14771**DCL     17253--CALL    17295--CALL    17377>>ASSIGN
KS$HNDLR.PARAMS
     14756**DCL     17213<>CALL
KS$PARAM.DEFAULT
     15083**DCL     17490>>ASSIGN  17516>>ASSIGN  17539>>ASSIGN  17554>>ASSIGN  17576>>ASSIGN  17597>>ASSIGN
     17670>>ASSIGN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:350  
KS$PARAM.FLAGS.DISPONLY
     15047**DCL     17645>>IF      17659>>IF
KS$PARAM.FLAGS.INDX
     15042**DCL     17187>>IF
KS$PARAM.HND
     15049**DCL     17174--IF
KS$PARAM.MAX
     15067**DCL     17492>>ASSIGN  17518>>ASSIGN  17541>>ASSIGN  17556>>ASSIGN  17578>>ASSIGN  17599>>ASSIGN
     17672>>ASSIGN
KS$PARAM.MIN
     15071**DCL     17491>>ASSIGN  17517>>ASSIGN  17540>>ASSIGN  17555>>ASSIGN  17577>>ASSIGN  17598>>ASSIGN
     17671>>ASSIGN
KS$PARAM.TEXTNAME
     15036**DCL     17114>>IF      17114>>IF      17114>>IF      17114>>IF      17178>>ASSIGN  17179>>ASSIGN
     17179>>ASSIGN  17228>>CALL    17228>>CALL    17269>>CALL    17269>>CALL    17494>>CALL    17494>>CALL
     17509>>CALL    17509>>CALL    17520>>CALL    17520>>CALL    17535>>CALL    17535>>CALL    17544>>CALL
     17544>>CALL    17558>>CALL    17558>>CALL    17565>>CALL    17565>>CALL    17580>>CALL    17580>>CALL
     17587>>CALL    17587>>CALL    17601>>CALL    17601>>CALL    17608>>CALL    17608>>CALL    17664>>CALL
     17664>>CALL    17674>>CALL    17674>>CALL    17681>>CALL    17681>>CALL
KS$PARAM_SPCL.SPCL_TBL$
     15568**DCL     17296>>ASSIGN
KS$PARAM_SPCL.SPCL_TBL$ IN PROCEDURE DISPARM
     17462**DCL     17487>>ASSIGN  17513>>ASSIGN
KSE$ERRMSG
     13294**DCL-ENT 16339--CALL    16384--CALL    16431--CALL    16441--CALL    16492--CALL    16506--CALL
     16527--CALL    16530--CALL    16553--CALL    16619--CALL    16633--CALL    16799--CALL    16848--CALL
     16987--CALL    17019--CALL    17060--CALL    17084--CALL    17122--CALL    17169--CALL    17182--CALL
     17208--CALL    17310--CALL    17311--CALL
KSR$RD_HLPCG
     13297**DCL-ENT 16886--CALL    16903--CALL    16953--CALL    17142--CALL    17157--CALL    17195--CALL
     17234--CALL    17242--CALL    17276--CALL    17284--CALL    17366--CALL
KSR$WR_HLPCG
     13298**DCL-ENT 16885--CALL    16901--CALL    16952--CALL    17141--CALL    17156--CALL    17194--CALL
     17233--CALL    17241--CALL    17275--CALL    17283--CALL    17365--CALL
KSU$BLD_KL_CONTROL
     13303**DCL-ENT 17140--CALL    17155--CALL    17193--CALL    17232--CALL    17240--CALL    17274--CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:351  
     17282--CALL    17364--CALL
KSU$BLD_TERMID
     13293**DCL-ENT 16605--CALL    16612--CALL    16842--CALL    16845--CALL
KSU$CHK_TRM_RNG
     13295**DCL-ENT 16617--CALL    16665--CALL    16752--CALL    16846--CALL
KSU$HEXBIN
     13296**DCL-ENT 17722--CALL
KSU$PACK2
     13300**DCL-ENT 16873--CALL    16874--CALL    16929--CALL    16930--CALL    16931--CALL    16932--CALL
     16933--CALL    16934--CALL    17488--CALL    17514--CALL    17552--CALL    17573--CALL    17595--CALL
     17654--CALL    17752--CALL    17753--CALL    17755--CALL    17756--CALL    17784--CALL    17787--CALL
     17788--CALL    17789--CALL    17790--CALL    17791--CALL
KSU$PACK4
     13301**DCL-ENT 17785--CALL    17786--CALL    17795--CALL    17796--CALL    17797--CALL
KSU$READ_NETCON
     13304**DCL-ENT 16648--CALL    17147--CALL    17162--CALL    17202--CALL    17250--CALL    17292--CALL
     17374--CALL
KSU$UNPACK
     13302**DCL-ENT 16812--CALL    16813--CALL    16814--CALL    16815--CALL    16816--CALL    16817--CALL
     16895--CALL    16897--CALL    16899--CALL    16938--CALL    16940--CALL    16942--CALL
KSW$WRITE
     13299**DCL-ENT 16347--CALL    16355--CALL    16360--CALL    16368--CALL    16422--CALL    16453--CALL
     16456--CALL    16462--CALL    16468--CALL    16473--CALL    16475--CALL    16476--CALL    16477--CALL
     16478--CALL    16483--CALL    16512--CALL    16514--CALL    16518--CALL    16566--CALL    16709--CALL
     16712--CALL    17040--CALL    17067--CALL    17072--CALL    17075--CALL    17228--CALL    17238--CALL
     17243--CALL    17253--CALL    17269--CALL    17280--CALL    17285--CALL    17295--CALL    17298--CALL
     17479--CALL    17494--CALL    17509--CALL    17520--CALL    17535--CALL    17544--CALL    17558--CALL
     17565--CALL    17580--CALL    17587--CALL    17601--CALL    17608--CALL    17649--CALL    17664--CALL
     17674--CALL    17681--CALL    17799--CALL    17805--CALL    17806--CALL    17925--CALL
KS_ADMIN
     13846**DCL     16885--CALL    16901--CALL    16952--CALL
KS_ADMIN.CODE
     13851**DCL     16871<<ASSIGN  16920<<ASSIGN  16923<<ASSIGN
KS_ADMIN.FNC
     13913**DCL     16924<<ASSIGN
KS_ADMIN.HANDLER
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:352  
     13855**DCL     16872<<ASSIGN  16925<<ASSIGN
KS_ADMIN.KS_CHN.TERMID.TERM
     14085**DCL     14094--REDEF
KS_ADMIN.TERMID_HI
     13960**DCL     16877<<ASSIGN  16950<<ASSIGN
KS_ADMIN.TERMID_HI.TERM
     13962**DCL     13971--REDEF
KS_ADMIN.TERMID_HI.TERM.CHANNEL
     13964**DCL     16897<>CALL    16899<>CALL
KS_ADMIN.TERMID_LO
     13931**DCL     16876<<ASSIGN  16950>>ASSIGN
KS_ADMIN.TERMID_LO.LEV
     13933**DCL     16946<<ASSIGN  16948<<ASSIGN
KS_ADMIN.TERMID_LO.TERM
     13933**DCL     13942--REDEF
KS_ADMIN.TERMID_LO.TERM.CHANNEL
     13935**DCL     16895<>CALL    16938<>CALL
KS_ADMIN.TERMID_LO.TERM.SUBDEVICE
     13935**DCL     16940<>CALL
KS_ADMIN.TERMID_LO.TERM.SUBSUBDEVICE
     13936**DCL     16942<>CALL
KS_CHKNODE
     15884**DCL     16718<<ASSIGN  16721<<ASSIGN  16748>>IF
KS_CNFG_BUF.LGN.LGNSIZE
     14932**DCL     14933--IMP-SIZ
KS_CONFIG_KEY
     15802**DCL     16572<<ASSIGN  16601--ASSIGN  16648--CALL    16654--ASSIGN  16657--ASSIGN  16737--ASSIGN
KS_CONFIG_KEY.NODE
     15805**DCL     16599<<ASSIGN  16642<<ASSIGN  16646<<ASSIGN  16662>>IF      16748>>IF
KS_CONFIG_KEY.TERMID
     15822**DCL     16596<<ASSIGN  16638<<ASSIGN  16665<>CALL    16752<>CALL
KS_CONFIG_KEY.TERMID.LEV
     15824**DCL     16725>>IF
KS_CONFIG_KEY.TERMID.TERM
     15824**DCL     15833--REDEF
KS_CONFIG_KEY.TERMID.TERM.CHANNEL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:353  
     15826**DCL     16643<<ASSIGN  16679--ASSIGN  16727<<ASSIGN
KS_CONFIG_KEY.TERMID.TERM.SUBDEVICE
     15826**DCL     16709--CALL
KS_CONFIG_KEY.TERMID.TERM.SUBSUBDEVICE
     15827**DCL     16709--CALL
KS_CONFIG_KEY.TERMID.TERM.TERM_NAME
     15833**DCL     16675>>IF      16709--CALL    16716>>IF      16725>>IF
KS_CONFIG_KEY.TYP
     15804**DCL     16662>>IF      16748>>IF
KS_CONTROL
     14195**DCL     17140<>CALL    17141--CALL    17155<>CALL    17156--CALL    17193<>CALL    17194--CALL
     17232<>CALL    17233--CALL    17240<>CALL    17241--CALL    17274<>CALL    17275--CALL    17282<>CALL
     17283--CALL    17364<>CALL    17365--CALL
KS_DEFAULT_KEY
     14158**DCL     16564--ASSIGN  16583--ASSIGN
KS_DEFAULT_KEY.HNDLR
     14162**DCL     16562<<ASSIGN  16566--CALL    16578<<ASSIGN  16712--CALL
KS_DEFAULT_KEY.NODE
     14161**DCL     16561<<ASSIGN  16577<<ASSIGN
KS_DISP_RNG
     13807**DCL     16558<<ASSIGN  16591<<ASSIGN  16623<<ASSIGN  16627<<ASSIGN  16651>>IF      16714>>IF
KS_ERRCODE.CODE
      4434**DCL     16607>>IF      16614>>IF
KS_FEPBOOT
     14457**DCL     16349--ASSIGN  17147--CALL
KS_FEPBOOT.BOOTFID
     14458**DCL     16355--CALL
KS_FEPBOOT.BOOTPARAMS
     14464**DCL     17148<>CALL
KS_FEPBOOT_KEY
     14482**DCL     16348--ASSIGN  17147--CALL
KS_FEPBOOT_KEY.NODE
     14485**DCL     16342<<ASSIGN  17146<<ASSIGN
KS_FEPCTL
     14500**DCL     17162--CALL
KS_FEPCTL.PARAMS
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:354  
     14503**DCL     17164<>CALL
KS_FEPCTL_KEY
     14520**DCL     17162--CALL
KS_FEPCTL_KEY.NODE
     14523**DCL     17161<<ASSIGN
KS_FEPHNDLR
     14538**DCL     16353--ASSIGN
KS_FEPHNDLR.BOOTIME
     14545**DCL     16364>>IF
KS_FEPHNDLR.DEFLIBACCT
     14542**DCL     16355--CALL
KS_FEPHNDLR.HANDLER
     14549**DCL     16362>>ASSIGN
KS_FEPHNDLR.NHANDLERS
     14539**DCL     16361>>DOINDEX
KS_FEPHNDLR_KEY
     14642**DCL     16352--ASSIGN
KS_FEPHNDLR_KEY.NODE
     14645**DCL     16343<<ASSIGN
KS_HANDLER_KEY
     14438**DCL     16357--ASSIGN  17202--CALL    17250--CALL    17292--CALL    17374--CALL
KS_HANDLER_KEY.HNDLR
     14442**DCL     16362<<ASSIGN  17201<<ASSIGN  17249<<ASSIGN  17291<<ASSIGN  17373<<ASSIGN
KS_HANDLER_KEY.NODE
     14441**DCL     16344<<ASSIGN  17200<<ASSIGN  17248<<ASSIGN  17290<<ASSIGN  17372<<ASSIGN
KS_HAND_INFO.SZ
     13362**DCL     17104>>ASSIGN
KS_HNDLRINDX
      4433**DCL     17104>>ASSIGN  17174>>IF      17213>>CALL    17228>>CALL    17228>>CALL    17269>>CALL
     17269>>CALL    17296>>ASSIGN  17378>>CALL
KS_HNDLRNAME
      4433**DCL     17167>>IF      17180--ASSIGN  17181>>ASSIGN  17193<>CALL    17201>>ASSIGN  17204>>ASSIGN
     17205--ASSIGN  17232<>CALL    17240<>CALL    17249>>ASSIGN  17274<>CALL    17282<>CALL    17291>>ASSIGN
     17364<>CALL    17373>>ASSIGN
KS_LINK.CHANNEL
      4436**DCL     17075--CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:355  
KS_LINK.LINKS#
      4435**DCL     17037<<ASSIGN  17072--CALL    17074>>DOINDEX
KS_LINK_KEY
     14663**DCL     17034--ASSIGN  17068--ASSIGN
KS_LINK_KEY.NODE
     14666**DCL     17033<<ASSIGN  17064<<ASSIGN
KS_MONINFO_F
     16019**DCL     16418<>CALL
KS_MONINFO_V
     16034**DCL     16019--DCLINIT
KS_MONINFO_V.NUM_NODES
     16038**DCL     16420>>ASSIGN  16428>>IF
KS_MSGBUF
      4435**DCL     17035--ASSIGN  17040--CALL    17069--ASSIGN
KS_MSGBUF$
      4435**DCL      4435--IMP-PTR 15120--IMP-PTR 15403--IMP-PTR 16887>>ASSIGN  16907>>IF      16910>>IF
     16911>>IF      16913>>ASSIGN  16915>>IF      16954>>IF      16954>>IF      16957>>IF      16959>>ASSIGN
     17037>>ASSIGN  17072>>CALL    17074>>DOINDEX 17075>>CALL    17143>>IF      17148>>CALL    17158>>IF
     17164>>CALL    17196>>IF      17213>>CALL    17235>>IF      17243>>CALL    17277>>IF      17285>>CALL
     17368>>IF      17378>>CALL
KS_MYSTATION
      4431**DCL      4431--REDEF
KS_NETSTAT
     13454**DCL     16422--CALL
KS_NETWORK
     14568**DCL     16062--DCLINIT 16063--DCLINIT 16375--ASSIGN  16380<<ASSIGN  16793--ASSIGN  16980--ASSIGN
     16984<<ASSIGN  16997>>ASSIGN  17040--CALL
KS_NETWORK.NODE.NODE
     14577**DCL     16453--CALL    16456--CALL    17342>>IF      17349>>ASSIGN
KS_NETWORK.NODE.TYPE
     14574**DCL     16438>>ASSIGN  16796>>IF      16796>>IF
KS_NETWORK.NODE#
     14569**DCL     16382>>IF      16986>>IF      17002>>ASSIGN  17015>>IF      17341>>DOINDEX 17348>>IF
KS_NETWORK_KEY
     14595**DCL     16060--DCLINIT 16061--DCLINIT 16374--ASSIGN  16792--ASSIGN  16979--ASSIGN
KS_NODE
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:356  
      4432**DCL     16333>>ASSIGN  16335<<ASSIGN  16342>>ASSIGN  16343>>ASSIGN  16344>>ASSIGN  16497>>ASSIGN
     16538>>ASSIGN  16540<<ASSIGN  16561>>ASSIGN  16566--CALL    16577>>ASSIGN  16599>>ASSIGN  16646>>ASSIGN
     16662>>IF      16709--CALL    16721>>ASSIGN  16783>>ASSIGN  16784<<ASSIGN  16796>>IF      16796>>IF
     17064>>ASSIGN  17146>>ASSIGN  17161>>ASSIGN  17200>>ASSIGN  17248>>ASSIGN  17290>>ASSIGN  17322<<ASSIGN
     17372>>ASSIGN
KS_NODEINFO_F
     15989**DCL     16446<>CALL    17028<>CALL
KS_NODEINFO_F.V
     15989**DCL     15989--DCLINIT
KS_NODEINFO_F.V.NODENUM#
     15990**DCL     16437<<ASSIGN  17027<<ASSIGN
KS_NODEINFO_V
     16001**DCL     15989--DCLINIT
KS_NODEINFO_V.ACTIVE#
     16002**DCL     16449>>IF      16464>>IF
KS_NODEINFO_V.ALTQOS#
     16003**DCL     16476--CALL
KS_NODEINFO_V.CURRENTNODE#
     16002**DCL     16469>>IF
KS_NODEINFO_V.HOST#
     16001**DCL     16458>>IF
KS_NODEINFO_V.LINKCONNECTED#
     16002**DCL     16479>>IF
KS_NODEINFO_V.LINKNODENAME#
     16004**DCL     16477--CALL
KS_NODEINFO_V.LINKNODENUM#
     16004**DCL     16478--CALL    17030<<ASSIGN  17040--CALL
KS_NODEINFO_V.QOS#
     16003**DCL     16475--CALL
KS_NODENAME
      4431**DCL     16334>>ASSIGN  16336<<ASSIGN  16338>>IF      16347--CALL    16491>>IF      16495--ASSIGN
     16496>>ASSIGN  16537>>ASSIGN  16539<<ASSIGN  16551>>IF      16566--CALL    16631>>IF      16709--CALL
     16785>>ASSIGN  16786<<ASSIGN  17058>>IF      17067--CALL    17082>>IF      17206>>ASSIGN  17207--ASSIGN
     17321<<ASSIGN
KS_NODENAME_SV
      4432**DCL     16334<<ASSIGN  16537<<ASSIGN  16785<<ASSIGN  17319>>IF      17321>>ASSIGN  17323<<ASSIGN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:357  
KS_NODE_SV
      4432**DCL     16333<<ASSIGN  16538<<ASSIGN  16783<<ASSIGN  17322>>ASSIGN
KS_PSEUDO
     14313**DCL     16499--ASSIGN  16503<<ASSIGN
KS_PSEUDO.PSEUDO.MAX_CG
     14328**DCL     16518--CALL
KS_PSEUDO.PSEUDO.MAX_GHST
     14338**DCL     16514--CALL
KS_PSEUDO.PSEUDO.MAX_HAND
     14333**DCL     16514--CALL
KS_PSEUDO.PSEUDO.MAX_SYS
     14319**DCL     16518--CALL
KS_PSEUDO.PSEUDO.MAX_USR
     14323**DCL     16518--CALL
KS_PSEUDO.PSEUDO.NAME
     14317**DCL     16514--CALL
KS_PSEUDO.PSEUDO#
     14314**DCL     16505>>IF      16513>>DOINDEX
KS_PSEUDO_KEY
     14357**DCL     16498--ASSIGN
KS_PSEUDO_KEY.NODE
     14360**DCL     16497<<ASSIGN
KS_RFEP
     14615**DCL     16995--ASSIGN  16997<<ASSIGN  17040--CALL
KS_RFEP.NODE.TYPE
     14621**DCL     17025>>IF
KS_RFEP_KEY
     14599**DCL     16994--ASSIGN
KS_SELPRMOPT
      4432**DCL     17136>>IF      17151>>IF      17189>>IF      17230>>IF      17272>>IF      17360>>IF
KS_SUB_BUF_1
      4436**DCL     16506--CALL    17019--CALL    17182--CALL    17208--CALL    17311--CALL
KS_SUB_BUF_1.COUNT
      4436**DCL     16345<<ASSIGN  16495<<ASSIGN  16528<<ASSIGN  16556<<ASSIGN  16570<<ASSIGN  16790<<ASSIGN
     16977<<ASSIGN  17018<<ASSIGN  17065<<ASSIGN  17178<<ASSIGN  17205<<ASSIGN
KS_SUB_BUF_1.TEXT
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:358  
      4436**DCL     16346<<ASSIGN  16496<<ASSIGN  16529<<ASSIGN  16557<<ASSIGN  16571<<ASSIGN  16791<<ASSIGN
     16978<<ASSIGN  17017<<ASSIGN  17066<<ASSIGN  17179<<ASSIGN  17204<<ASSIGN
KS_SUB_BUF_2
      4436**DCL     17182--CALL    17208--CALL
KS_SUB_BUF_2.COUNT
      4437**DCL     17180<<ASSIGN  17207<<ASSIGN
KS_SUB_BUF_2.TEXT
      4437**DCL     17181<<ASSIGN  17206<<ASSIGN
KS_TBL
     13333**DCL     17114>>IF      17114>>IF      17114>>IF      17114>>IF      17174>>IF      17178>>ASSIGN
     17179>>ASSIGN  17179>>ASSIGN  17187>>IF      17228>>CALL    17228>>CALL    17269>>CALL    17269>>CALL
     17296>>ASSIGN  17487>>ASSIGN  17494>>CALL    17494>>CALL    17509>>CALL    17509>>CALL    17513>>ASSIGN
     17520>>CALL    17520>>CALL    17535>>CALL    17535>>CALL    17539>>ASSIGN  17540>>ASSIGN  17541>>ASSIGN
     17544>>CALL    17544>>CALL    17554>>ASSIGN  17555>>ASSIGN  17556>>ASSIGN  17558>>CALL    17558>>CALL
     17565>>CALL    17565>>CALL    17576>>ASSIGN  17577>>ASSIGN  17578>>ASSIGN  17580>>CALL    17580>>CALL
     17587>>CALL    17587>>CALL    17597>>ASSIGN  17598>>ASSIGN  17599>>ASSIGN  17601>>CALL    17601>>CALL
     17608>>CALL    17608>>CALL    17645>>IF      17659>>IF      17664>>CALL    17664>>CALL    17670>>ASSIGN
     17671>>ASSIGN  17672>>ASSIGN  17674>>CALL    17674>>CALL    17681>>CALL    17681>>CALL
KS_YES_NO
     15837**DCL     16365<<ASSIGN  16367<<ASSIGN  16368--CALL    16459<<ASSIGN  16461<<ASSIGN  16462--CALL
     16465<<ASSIGN  16467<<ASSIGN  16468--CALL    16470<<ASSIGN  16472<<ASSIGN  16473--CALL    16480<<ASSIGN
     16482<<ASSIGN  16483--CALL
L
     15840**DCL     16423<<DOINDEX 16426>>CALL    16436>>ASSIGN  17010<<DOINDEX 17013>>CALL    17017>>ASSIGN
     17017>>ASSIGN  17018>>ASSIGN  17024>>ASSIGN
LAST
     16270**DCL     16404<<ASSIGN  16415<<ASSIGN  16420<<ASSIGN  16423>>DOINDEX 16830<<ASSIGN  16838>>DOINDEX
     17002<<ASSIGN  17007<<ASSIGN  17010>>DOINDEX
LAST_DI
     16269**DCL     16325<<ASSIGN  17094>>IF      17325<<ASSIGN
LCP6_RDCG_ERR
     17158**LABEL   17156--CALLALT 17157--CALLALT
LCP6_RDNETCON_ERR
     17164**LABEL   17162--CALLALT
LEV
     16280**DCL     16943<<DOINDEX 16948>>ASSIGN  16960>>IF
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:359  
LEV_LOOP
     16943**LABEL   16964--EXIT
LIBACCT_FMT
     13522**DCL     13523--DCLINIT
LINESPEED
     13640**DCL     16712--CALL    17269--CALL    17486>>ASSIGN  17772>>ASSIGN
LINKCHAN_FMT
     13529**DCL     13530--DCLINIT
LINKCHAN_VEC
     13530**DCL     17072<>CALL
LINK_FMT
     13527**DCL     13528--DCLINIT
LINK_VEC
     13528**DCL     17067<>CALL
LNCNFG_FMT
     13539**DCL     13541--DCLINIT
LNCNFG_VEC
     13541**DCL     16709<>CALL
LNKCNCT_FMT
     13473**DCL     13474--DCLINIT
LNKCNCT_VEC
     13474**DCL     16483<>CALL
LNKNME_FMT
     13469**DCL     13470--DCLINIT
LNKNME_VEC
     13470**DCL     16477<>CALL
LNKNUM_FMT
     13471**DCL     13472--DCLINIT
LNKNUM_VEC
     13472**DCL     16478<>CALL
M$MONINFO
        87**DCL-ENT 16418--CALL
M$NODEINFO
        51**DCL-ENT 16446--CALL    17028--CALL
M$PRECORD
        23**DCL-ENT 16655--CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:360  
M$READ
        20**DCL-ENT 16350--CALL    16354--CALL    16363--CALL    16376--CALL    16500--CALL    16565--CALL
     16584--CALL    16661--CALL    16739--CALL    16794--CALL    16981--CALL    16996--CALL    17036--CALL
     17071--CALL    17334--CALL
MAX IN PROCEDURE DISPARM
     17397**DCL     17492<<ASSIGN  17494--CALL    17509--CALL    17518<<ASSIGN  17520--CALL    17535--CALL
     17541<<ASSIGN  17544--CALL    17556<<ASSIGN  17558--CALL    17565--CALL    17578<<ASSIGN  17580--CALL
     17587--CALL    17599<<ASSIGN  17601--CALL    17608--CALL
MAX IN PROCEDURE DISP_NONHAND_PARM
     17639**DCL     17672<<ASSIGN  17674--CALL    17681--CALL
MAX_PARM
     15854**DCL     17091<<ASSIGN  17096<<ASSIGN  17100<<ASSIGN  17104<<ASSIGN  17109>>DOINDEX
MIN IN PROCEDURE DISPARM
     17396**DCL     17491<<ASSIGN  17494--CALL    17509--CALL    17517<<ASSIGN  17520--CALL    17535--CALL
     17540<<ASSIGN  17544--CALL    17555<<ASSIGN  17558--CALL    17565--CALL    17577<<ASSIGN  17580--CALL
     17587--CALL    17598<<ASSIGN  17601--CALL    17608--CALL
MIN IN PROCEDURE DISP_NONHAND_PARM
     17638**DCL     17671<<ASSIGN  17674--CALL    17681--CALL
NAME
     16107**DCL     17228--CALL    17269--CALL    17494--CALL    17509--CALL    17520--CALL    17535--CALL
     17544--CALL    17558--CALL    17565--CALL    17580--CALL    17587--CALL    17601--CALL    17608--CALL
     17664--CALL    17674--CALL    17681--CALL
NAME.L#
     16107**DCL     16107--IMP-SIZ 17114>>IF      17114>>IF      17178>>ASSIGN  17179>>ASSIGN  17228>>CALL
     17269>>CALL    17494>>CALL    17509>>CALL    17520>>CALL    17535>>CALL    17544>>CALL    17558>>CALL
     17565>>CALL    17580>>CALL    17587>>CALL    17601>>CALL    17608>>CALL    17664>>CALL    17674>>CALL
     17681>>CALL
NAME.NAME#
     16107**DCL     17114>>IF      17114>>IF      17179>>ASSIGN
NETCON_DISP IN PROCEDURE DISPARM
     17391**DCL     17489<<ASSIGN  17494--CALL    17509--CALL    17515<<ASSIGN  17520--CALL    17535--CALL
     17538<<ASSIGN  17544--CALL    17553<<ASSIGN  17558--CALL    17565--CALL    17575<<ASSIGN  17580--CALL
     17587--CALL    17596<<ASSIGN  17601--CALL    17608--CALL
NETCON_VAL IN PROCEDURE DISPARM
     17389**DCL     17383--PROC    17489>>ASSIGN  17515>>ASSIGN  17538>>ASSIGN  17553>>ASSIGN  17575>>ASSIGN
     17596>>ASSIGN
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:361  
NETCON_VAL IN PROCEDURE DISP_NONHAND_PARM
     17635**DCL     17629--PROC    17674--CALL    17681--CALL
NETWORK_FMT
     13507**DCL     13517--DCLINIT
NETWORK_VEC
     13517**DCL     17040<>CALL
NET_STAT_FMT
     13455**DCL     13456--DCLINIT
NET_STAT_VEC
     13456**DCL     16422<>CALL
NHNDLR_FMT
     13483**DCL     13484--DCLINIT
NODESLCT
     15839**DCL     16392<<ASSIGN  16402<<ASSIGN  16408<<ASSIGN  16413<<ASSIGN  16419>>IF      16424>>IF
     16439>>IF      17001<<ASSIGN  17006<<ASSIGN  17011>>IF
NODETYPE
     15876**DCL     16438<<ASSIGN  16439>>IF      16444>>IF
NODE_FMT
     13457**DCL     13458--DCLINIT
NODE_VEC
     13458**DCL     16456<>CALL
NO_CURRENT_VAL
     15850**DCL     17131<<ASSIGN  17137<<ASSIGN  17144<<ASSIGN  17152<<ASSIGN  17159<<ASSIGN  17164<>CALL
     17190<<ASSIGN  17197<<ASSIGN  17213<>CALL    17361<<ASSIGN  17369<<ASSIGN  17378<>CALL
NO_CURRENT_VAL IN PROCEDURE DISPARM
     17390**DCL     17383--PROC    17493>>IF      17519>>IF      17542>>IF      17557>>IF      17579>>IF
     17600>>IF
NO_CURRENT_VAL IN PROCEDURE DISP_NONHAND_PARM
     17636**DCL     17629--PROC    17645>>IF      17661>>IF      17673>>IF
OLD_CHAN_DISP
     16923**LABEL   16908--GOTO
ONE_CHAN_FLAG
     15842**DCL     16822<<ASSIGN  16855<<ASSIGN  16878<<ASSIGN  16886<>CALL    16903<>CALL    16905>>IF
     16910>>IF      16915>>IF      16945>>IF      16953<>CALL    16960>>IF      16968>>IF      17706>>IF
ONE_PARM_ONLY
     15852**DCL     17093<<ASSIGN  17098<<ASSIGN  17102<<ASSIGN  17106<<ASSIGN  17111>>IF      17121>>IF
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:362  
     17126>>IF      17176>>IF      17220>>IF      17258>>IF      17303>>IF
OPT.LAST
     15845**DCL     16864<<ASSIGN  17713>>DOINDEX
OPT.P$
     15844**DCL     16824<<ASSIGN  16825<<ASSIGN  16826<<ASSIGN  16863<<ASSIGN  16864>>ASSIGN  17708>>IF
     17716>>IF      17716>>IF      17722>>CALL    17729>>IF
OPTION_SATISFIED
     15847**DCL     17705<<ASSIGN  17709<<ASSIGN  17712<<ASSIGN  17718<<ASSIGN  17725<<ASSIGN  17731<<ASSIGN
     17737>>IF      17740>>IF
OPT_LOOP IN PROCEDURE DISPLAY_CHAN
     17707**LABEL   17738--EXIT
OUT$BLK.CODE
     14949**DCL     16328>>DOCASE  16396>>IF      16396>>IF      16399>>ASSIGN  16534>>IF      16549>>IF
     16589>>IF      16673>>IF      16780>>IF      16839>>ASSIGN  17089>>DOCASE  17092>>ASSIGN  17112>>ASSIGN
     17223>>ASSIGN  17258>>IF      17263>>ASSIGN  17325>>ASSIGN  17336>>DOCASE  17729>>IF
OUT$BLK.NSUBLKS
     14953**DCL     16326>>DOINDEX 16330>>IF      16389>>IF      16400>>IF      16404>>ASSIGN  16415>>ASSIGN
     16574>>IF      16610>>IF      16778>>IF      16828>>IF      16830>>ASSIGN  16843>>IF      16864>>ASSIGN
     16999>>IF      17007>>ASSIGN  17262>>DOINDEX
OUT$BLK.SUBLK$
     14974**DCL     16327>>ASSIGN  16332>>CALL    16332<>CALL    16396>>IF      16396>>IF      16399>>ASSIGN
     16426<>CALL    16534>>IF      16536>>CALL    16536<>CALL    16556>>ASSIGN  16557>>ASSIGN  16557>>ASSIGN
     16562>>ASSIGN  16562>>ASSIGN  16578>>ASSIGN  16578>>ASSIGN  16578>>ASSIGN  16578>>ASSIGN  16589>>IF
     16605>>CALL    16605<>CALL    16610>>IF      16612>>CALL    16612<>CALL    16780>>IF      16782>>CALL
     16782<>CALL    16839>>ASSIGN  16842>>CALL    16842>>CALL    16842<>CALL    16843>>IF      16843>>IF
     16845>>CALL    16845>>CALL    16845<>CALL    16863>>ASSIGN  17013<>CALL    17017>>ASSIGN  17017>>ASSIGN
     17018>>ASSIGN  17092>>ASSIGN  17112>>ASSIGN  17112>>ASSIGN  17222>>ASSIGN  17222>>ASSIGN  17222>>ASSIGN
     17258>>IF      17258>>IF      17258>>IF      17261>>ASSIGN  17261>>ASSIGN  17261>>ASSIGN  17263>>ASSIGN
     17716>>IF      17716>>IF      17722>>CALL    17722<>CALL    17729>>IF
OUT$SYM.COUNT
     15010**DCL     15013--IMP-SIZ 16556>>ASSIGN  16557>>ASSIGN  16562>>ASSIGN  16578>>ASSIGN  17017>>ASSIGN
     17018>>ASSIGN  17340>>ASSIGN  17347>>CALLBLT 17716>>IF
OUT$SYM.TEXT
     15013**DCL     16557>>ASSIGN  16562>>ASSIGN  16578>>ASSIGN  17017>>ASSIGN  17340>>ASSIGN  17347>>CALLBLT
     17716>>IF
PARAM_CHAR_FMT
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:363  
     13494**DCL     14671--DCLINIT
PARAM_FMT
     13492**DCL     14672--DCLINIT
PARAM_HEX_FMT
     13495**DCL     14670--DCLINIT
PARMTYPE
     15860**DCL     17092<<ASSIGN  17097<<ASSIGN  17101<<ASSIGN  17105<<ASSIGN  17114>>IF      17114>>IF
     17114>>IF      17114>>IF      17119>>IF      17126>>IF      17133>>DOCASE  17148<>CALL    17164<>CALL
     17174>>IF      17178>>ASSIGN  17179>>ASSIGN  17179>>ASSIGN  17187>>IF
PARMTYPE IN PROCEDURE DISPARM
     17385**DCL     17383--PROC    17487>>ASSIGN  17494>>CALL    17494>>CALL    17509>>CALL    17509>>CALL
     17513>>ASSIGN  17520>>CALL    17520>>CALL    17535>>CALL    17535>>CALL    17539>>ASSIGN  17540>>ASSIGN
     17541>>ASSIGN  17544>>CALL    17544>>CALL    17554>>ASSIGN  17555>>ASSIGN  17556>>ASSIGN  17558>>CALL
     17558>>CALL    17565>>CALL    17565>>CALL    17576>>ASSIGN  17577>>ASSIGN  17578>>ASSIGN  17580>>CALL
     17580>>CALL    17587>>CALL    17587>>CALL    17597>>ASSIGN  17598>>ASSIGN  17599>>ASSIGN  17601>>CALL
     17601>>CALL    17608>>CALL    17608>>CALL
PARMTYPE IN PROCEDURE DISP_NONHAND_PARM
     17631**DCL     17629--PROC    17645>>IF      17659>>IF      17664>>CALL    17664>>CALL    17670>>ASSIGN
     17671>>ASSIGN  17672>>ASSIGN  17674>>CALL    17674>>CALL    17681>>CALL    17681>>CALL
PARMX
     15859**DCL     17109<<DOINDEX 17112<<ASSIGN  17114>>IF      17114>>IF      17114>>IF      17114>>IF
     17119>>IF      17126>>IF      17140>>CALL    17148<>CALL    17148>>CALL    17155<>CALL    17164<>CALL
     17164>>CALL    17174>>IF      17178>>ASSIGN  17179>>ASSIGN  17179>>ASSIGN  17187>>IF      17193<>CALL
     17213<>CALL    17213>>CALL    17217>>IF      17217>>IF      17224<>CALL    17228>>CALL    17228>>CALL
     17232<>CALL    17240<>CALL    17251>>ASSIGN  17264<>CALL    17269>>CALL    17269>>CALL    17274<>CALL
     17282<>CALL    17293>>ASSIGN  17296>>ASSIGN
PARMX IN PROCEDURE DISPARM
     17386**DCL     17383--PROC    17484>>DOCASE  17487>>ASSIGN  17494>>CALL    17494>>CALL    17509>>CALL
     17509>>CALL    17513>>ASSIGN  17520>>CALL    17520>>CALL    17535>>CALL    17535>>CALL    17539>>ASSIGN
     17540>>ASSIGN  17541>>ASSIGN  17544>>CALL    17544>>CALL    17554>>ASSIGN  17555>>ASSIGN  17556>>ASSIGN
     17558>>CALL    17558>>CALL    17565>>CALL    17565>>CALL    17576>>ASSIGN  17577>>ASSIGN  17578>>ASSIGN
     17580>>CALL    17580>>CALL    17587>>CALL    17587>>CALL    17597>>ASSIGN  17598>>ASSIGN  17599>>ASSIGN
     17601>>CALL    17601>>CALL    17608>>CALL    17608>>CALL
PARMX IN PROCEDURE DISPLAY_INDEXED_PARM
     17356**DCL     17354--PROC    17364<>CALL    17375>>ASSIGN  17378<>CALL
PARMX IN PROCEDURE DISP_NONHAND_PARM
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:364  
     17632**DCL     17629--PROC    17645>>IF      17656>>IF      17659>>IF      17664>>CALL    17664>>CALL
     17670>>ASSIGN  17671>>ASSIGN  17672>>ASSIGN  17674>>CALL    17674>>CALL    17681>>CALL    17681>>CALL
PARM_DISPONLY_FMT IN PROCEDURE DISP_NONHAND_PARM
     17643**DCL     17664--CALL
PARM_FMT IN PROCEDURE DISPARM
     17403**DCL     17587--CALL    17608--CALL
PARM_FMT IN PROCEDURE DISP_NONHAND_PARM
     17641**DCL     17681--CALL
PARM_LOOP
     17109**LABEL   17304--EXIT
PARM_LOOP_END
     17306**LABEL   17117--GOTO    17123--GOTO    17129--GOTO    17184--GOTO
PARM_NO_CURR_FMT IN PROCEDURE DISPARM
     17476**DCL     17580--CALL    17601--CALL
PARM_NO_CURR_FMT IN PROCEDURE DISP_NONHAND_PARM
     17642**DCL     17674--CALL
PREC_NETCON
     15968**DCL     16655<>CALL
PREC_NETCON.KEY_
     15968**DCL     16654<<ASSIGN
PREC_NETCON.V
     15970**DCL     15968--DCLINIT
PSEUDOHDR_FMT
     13518**DCL     13519--DCLINIT
PSEUDOHDR_VEC
     13519**DCL     16512<>CALL
PSEUDO_DISP_ERR
     16520**LABEL   16502--GOTO
PSEUDO_FMT
     13487**DCL     13488--DCLINIT
PSEUDO_NME_FMT
     13447**DCL     13448--DCLINIT
PSEUDO_NME_VEC
     13448**DCL     16514<>CALL
PSEUDO_USR_FMT
     13449**DCL     13450--DCLINIT
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:365  
PSEUDO_USR_VEC
     13450**DCL     16518<>CALL
PTR$
     15873**DCL     15874--REDEF   16962<<ASSIGN  16966<<ASSIGN  17222<<ASSIGN  17223>>ASSIGN  17261<<ASSIGN
     17262>>DOINDEX 17263>>ASSIGN
PTR$ IN PROCEDURE GET_NODE
     17332**DCL     17330--PROC    17336>>DOCASE  17340>>ASSIGN  17340>>ASSIGN  17347>>CALLBLT 17347>>CALLBLT
PTR$_R
     15874**DCL     16963>>IF
QOS_FMT
     13465**DCL     13466--DCLINIT
QOS_VEC
     13466**DCL     16475<>CALL
READ_NETCON
     15931**DCL     16350<>CALL    16354<>CALL    16363<>CALL    16376<>CALL    16500<>CALL    16565<>CALL
     16584<>CALL    16661<>CALL    16739<>CALL    16794<>CALL    16981<>CALL    16996<>CALL    17036<>CALL
     17071<>CALL
READ_NETCON.BUF_
     15933**DCL     16349<<ASSIGN  16353<<ASSIGN  16359<<ASSIGN  16375<<ASSIGN  16499<<ASSIGN  16563<<ASSIGN
     16582<<ASSIGN  16602<<ASSIGN  16658<<ASSIGN  16738<<ASSIGN  16793<<ASSIGN  16980<<ASSIGN  16995<<ASSIGN
     17035<<ASSIGN  17069<<ASSIGN
READ_NETCON.KEY_
     15931**DCL     16348<<ASSIGN  16352<<ASSIGN  16357<<ASSIGN  16374<<ASSIGN  16498<<ASSIGN  16564<<ASSIGN
     16583<<ASSIGN  16601<<ASSIGN  16657<<ASSIGN  16737<<ASSIGN  16792<<ASSIGN  16979<<ASSIGN  16994<<ASSIGN
     17034<<ASSIGN  17068<<ASSIGN
READ_NETCON.STATION_
     15934**DCL     15935--REDEF
READ_NETCON.V
     15935**DCL     15931--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
     15946**DCL     15946--REDEF
READ_NETCON.V.INDX#
     15944**DCL     15944--REDEF
READ_NETCON.V.KEYR#
     15936**DCL     16324<<ASSIGN  16547<<ASSIGN  16581<<ASSIGN  16660<<ASSIGN  16729<<ASSIGN  17317<<ASSIGN
READ_NETCON.V.KEYS#
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:366  
     15936**DCL     16323<<ASSIGN  16546<<ASSIGN  16580<<ASSIGN  16659<<ASSIGN  16730<<ASSIGN  17318<<ASSIGN
READ_NETWORK
     16060**DCL     17334<>CALL
READ_NETWORK.STATION_
     16063**DCL     16064--REDEF
READ_NETWORK.V
     16064**DCL     16060--DCLINIT
READ_NETWORK.V.DVBYTE.REREAD#
     16075**DCL     16075--REDEF
READ_NETWORK.V.INDX#
     16073**DCL     16073--REDEF
RES_FMT IN PROCEDURE DISPARM
     17401**DCL     17544--CALL
S$
     16143**DCL     16141--IMP-PTR 16142--IMP-PTR 16679<<ASSIGN  16682>>ASSIGN  16685>>ASSIGN  16694<<ASSIGN
     16697>>ASSIGN  16700>>ASSIGN  17695<<ASSIGN  17698>>ASSIGN  17701>>ASSIGN  17812<<ASSIGN  17815>>ASSIGN
     17818>>ASSIGN  17824<<ASSIGN  17827>>ASSIGN  17830>>ASSIGN  17836<<ASSIGN  17839>>ASSIGN  17842>>ASSIGN
     17848<<ASSIGN  17851>>ASSIGN  17854>>ASSIGN  17896<<ASSIGN  17899>>ASSIGN  17902>>ASSIGN  17905>>ASSIGN
     17908>>ASSIGN
SBLK
     15856**DCL     16838<<DOINDEX 16839>>ASSIGN  16842>>CALL    16843>>IF      16845>>CALL    16863>>ASSIGN
SHORT_HDR_FMT
     13476**DCL     13479--DCLINIT
SHORT_LINE_FMT
     13477**DCL     13478--DCLINIT
SHORT_LINE_VEC
     13478**DCL     16453<>CALL
SPCL_TBL$ IN PROCEDURE DISPARM
     17392**DCL     17487<<ASSIGN  17490>>ASSIGN  17491>>ASSIGN  17492>>ASSIGN  17513<<ASSIGN  17516>>ASSIGN
     17517>>ASSIGN  17518>>ASSIGN
STATE
     13650**DCL     17751>>ASSIGN  17888>>ASSIGN
STAT_END_LOOP
     16477**LABEL   16432--GOTO    16442--GOTO
SUBDEV
     16281**DCL     16939<<DOINDEX 16940<>CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:367  
SUBHI
     16277**DCL     16809<<ASSIGN  16815<>CALL    16932<>CALL    16939>>DOINDEX
SUBLK$
     15872**DCL     16403<<ASSIGN  16414<<ASSIGN  16426>>CALL
SUBLK_INDX
     16321**DCL     16541<<ASSIGN  16544<<ASSIGN  16556>>ASSIGN  16557>>ASSIGN  16557>>ASSIGN  16562>>ASSIGN
     16562>>ASSIGN  16574>>IF      16578>>ASSIGN  16578>>ASSIGN  16589>>IF      16605>>CALL    16610>>IF
     16612>>CALL
SUBLO
     16276**DCL     16808<<ASSIGN  16814<>CALL    16931<>CALL    16939>>DOINDEX
SUBSUBDEV
     16282**DCL     16941<<DOINDEX 16942<>CALL
SUBSUBHI
     16278**DCL     16811<<ASSIGN  16817<>CALL    16934<>CALL    16941>>DOINDEX
SUBSUBLO
     16279**DCL     16810<<ASSIGN  16816<>CALL    16933<>CALL    16941>>DOINDEX
SUB_OPT_LOOP IN PROCEDURE DISPLAY_CHAN
     17713**LABEL   17719--EXIT    17726--EXIT    17732--EXIT
S_LOOP
     16939**LABEL   16956--EXIT
S_R
     16141**DCL     16682>>ASSIGN  16685>>ASSIGN  16697>>ASSIGN  16700>>ASSIGN  17698>>ASSIGN  17701>>ASSIGN
     17815>>ASSIGN  17818>>ASSIGN  17827>>ASSIGN  17830>>ASSIGN  17839>>ASSIGN  17842>>ASSIGN  17851>>ASSIGN
     17854>>ASSIGN
S_R_W
     16142**DCL     17899>>ASSIGN  17902>>ASSIGN  17905>>ASSIGN  17908>>ASSIGN
TERMHI
     15650**DCL     16594<<ASSIGN  16612<>CALL    16617<>CALL    16628<<ASSIGN  16665<>CALL    16752<>CALL
     16845<>CALL    16846<>CALL    16856<<ASSIGN  16877>>ASSIGN  16878>>IF      16915>>IF
TERMHI.LEV
     15654**DCL     16598<<ASSIGN  16819<<ASSIGN
TERMHI.TERM
     15654**DCL     15663--REDEF
TERMHI.TERM.CHANNEL
     15656**DCL     16717<<ASSIGN  16813<>CALL    16874<>CALL    16930<>CALL
TERMHI.TERM.CHANNEL.BYT
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:368  
     15656**DCL     16597<<ASSIGN
TERMHI.TERM.SUBDEVICE
     15656**DCL     16815<>CALL    16932<>CALL
TERMHI.TERM.SUBSUBDEVICE
     15657**DCL     16817<>CALL    16934<>CALL
TERMLO
     15621**DCL     16593<<ASSIGN  16596>>ASSIGN  16605<>CALL    16617<>CALL    16628>>ASSIGN  16638>>ASSIGN
     16842<>CALL    16846<>CALL    16856>>ASSIGN  16876>>ASSIGN  16878>>IF
TERMLO.LEV
     15625**DCL     16595<<ASSIGN  16818<<ASSIGN  16946>>ASSIGN
TERMLO.TERM
     15625**DCL     15634--REDEF
TERMLO.TERM.CHANNEL
     15627**DCL     16694--ASSIGN  16812<>CALL    16873<>CALL    16929<>CALL
TERMLO.TERM.SUBDEVICE
     15627**DCL     16814<>CALL    16931<>CALL
TERMLO.TERM.SUBSUBDEVICE
     15628**DCL     16816<>CALL    16933<>CALL
TERMLO.TERM.TERM_NAME
     15634**DCL     16631>>IF      16640>>IF
TEXT IN PROCEDURE YESNO
     17620**DCL     17617--PROC    17623<<ASSIGN  17625<<ASSIGN
TEXT_NODETYPE
     13427**DCL     16438>>ASSIGN  17040--CALL
THE_BIG_DO
     16445**LABEL   16454--EXIT
TOP$
         8**DCL         6--PROC    14941--IMP-PTR 16326>>DOINDEX 16327>>ASSIGN
UNKNOWN
     14674**DCL     16450<<ASSIGN  16452<<ASSIGN  16453--CALL
USRPARM_ENTRY_FMT
     13498**DCL     17243--CALL
USRPARM_HDR_FMT
     13496**DCL     17228--CALL
USRPARM_NETCON_FMT
     13499**DCL     17253--CALL
PL6.E3A0      #001=KSC$DISPLAY File=KSC$COMMANDS2.:E05TSI                        WED 07/30/97 01:42 Page:369  
VALUE
     15866**DCL     15867--REDEF
YESNO
     17617**PROC    17744--CALL    17745--CALL    17746--CALL    17747--CALL    17748--CALL    17749--CALL
     17750--CALL    17757--CALL    17758--CALL    17759--CALL    17760--CALL    17762--CALL    17763--CALL
     17764--CALL    17768--CALL    17769--CALL    17770--CALL    17771--CALL    17773--CALL    17774--CALL
     17775--CALL    17776--CALL    17777--CALL    17778--CALL    17779--CALL    17780--CALL

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:370  
     2006        1        /*T***********************************************************/
     2007        2        /*T*                                                         */
     2008        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2009        4        /*T*                                                         */
     2010        5        /*T***********************************************************/
     2011        6        KSC$DELETE: PROC(TOP$) ALTRET;
     2012        7        /**/
     2013        8    1   DCL TOP$ PTR;
     2014        9        /**/
     2015       10        %INCLUDE CP_6;
     2016       91        %INCLUDE KL_MACRO_C;
     2017     3443        %INCLUDE KL_CONFIG_M;
     2018     4205        %INCLUDE KS_MACRO_M;
     2019     4402        %INCLUDE KS_SUBS_C;
     2020     4645        %INCLUDE KS_DATA_R;
     2021     4660        %INCLUDE KS_PERR_C;
     2022     4727        %INCLUDE XU_MACRO_C;
     2023     7833        %INCLUDE B_ERRORS_C;
     2024     8960        %INCLUDE F$DCB;
     2025     9009        %INCLUDE            KL_AFCN_C;
     2026     9110        /**/
     2027     9111        %KS$BOX(TITLE="entry defs");

              9129    1   /***************************************************************************
              9130    1    *                                                                         *
              9131    1    *                                 entry defs                              *
              9132    1    *                                                                         *
              9133    1    ***************************************************************************/

     2028     9138    1   DCL KSE$ERRMSG ENTRY(4);
     2029     9139    1   DCL                 KSR$WR_HLPCG ENTRY(1) ALTRET;
     2030     9140    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
     2031     9141    1   DCL KSU$BLD_TERMID  ENTRY(3) ALTRET;
     2032     9142    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
     2033     9143        %KS$BOX(TITLE="symref variables");

              9161    1   /***************************************************************************
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:371  
              9162    1    *                                                                         *
              9163    1    *                              symref variables                           *
              9164    1    *                                                                         *
              9165    1    ***************************************************************************/

     2034     9170    1   DCL B$TCB$ PTR SYMREF;
     2035     9171        %KS$BOX(TITLE="symdef variables");

              9189    1   /***************************************************************************
              9190    1    *                                                                         *
              9191    1    *                              symdef variables                           *
              9192    1    *                                                                         *
              9193    1    ***************************************************************************/

     2036     9198        %KS$BOX(TITLE="constant variables");

              9216    1   /***************************************************************************
              9217    1    *                                                                         *
              9218    1    *                             constant variables                          *
              9219    1    *                                                                         *
              9220    1    ***************************************************************************/

     2037     9225    1   DCL HEX_CHARS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
     2038     9226        %KS$BOX(TITLE="static variables");

              9244    1   /***************************************************************************
              9245    1    *                                                                         *
              9246    1    *                              static variables                           *
              9247    1    *                                                                         *
              9248    1    ***************************************************************************/

     2039     9253    1   DCL 1 PROMPT SYMREF,
     2040     9254    1        2 NODENAME CHAR(8),
     2041     9255    1        2 STAR CHAR(2);
     2042     9256        %KL$HNDLR_KEY(NAME = KS_HNDLR_KEY,STCLASS=STATIC);
     2043     9275        %KL$HNDLR_KEY(NAME = KS_HNDLR_LKEY,STCLASS=STATIC);
     2044     9294        %KL$DEFAULT_KEY(NAME = KS_DFLT_KEY,STCLASS=STATIC);
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:372  
     2045     9313        %KL$DEFAULT_KEY(NAME = KS_DFLT_LKEY,STCLASS=STATIC);
     2046     9332        %KL$CONFIG_KEY(NAME = KS_CONFIG_LKEY,STCLASS=STATIC);
     2047     9379        %KL$FEPBOOT_KEY(NAME = KS_FEPBOOT_KEY,STCLASS=STATIC);
     2048     9397        %KL$FEPHNDLR_KEY(NAME = KS_FEPHNDLR_KEY,STCLASS=STATIC);
     2049     9415        %KL$FEPCTL_KEY(NAME = KS_FEPCTL_KEY,STCLASS=STATIC);
     2050     9433        %KL$LINK_KEY(NAME = KS_LINK_KEY,STCLASS=STATIC);
     2051     9451        %KL$PSEUDO (NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
     2052     9495        %KL$PSEUDO_KEY (NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
     2053     9513        %KL$CONFIG_KEY(NAME = KS_CONFIG_KEY,STCLASS=STATIC);
     2054     9560        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=STATIC);
     2055     9587        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
     2056     9604    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
     2057     9605    1        2  CNT UBIN BYTE UNAL INIT(1),
     2058     9606    1       2  TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
     2059     9607        %KL$NETWORK         (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
     2060     9634    1   DCL                 HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
     2061     9635        %KS$BOX(TITLE="based variables");

              9653    1   /***************************************************************************
              9654    1    *                                                                         *
              9655    1    *                              based variables                            *
              9656    1    *                                                                         *
              9657    1    ***************************************************************************/

     2062     9662    1   DCL   HEX   UBIN(4)  BASED UNAL;
     2063     9663        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2064     9708        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
     2065     9746        %B$TCB;
     2066     9749        %B$ALT;
     2067     9757        %KL_HDR(FPTN=UPDATE,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     2068     9837        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:373  
              9855    1   /***************************************************************************
              9856    1    *                                                                         *
              9857    1    *                               auto variables                            *
              9858    1    *                                                                         *
              9859    1    ***************************************************************************/

     2069     9864    1   DCL LINK# UBIN;
     2070     9865    1   DCL   1  TEMP_LINK   STATIC,
     2071     9866    1            2  *        BIT(1) UNAL,
     2072     9867    1            2  HEX0     UBIN(4) UNAL,
     2073     9868    1            2  HEX1     UBIN(4) UNAL,
     2074     9869    1            2  *        BIT(1)  UNAL,
     2075     9870    1            2  HEX2     UBIN(4) UNAL,
     2076     9871    1            2  HEX3     UBIN(4) UNAL;
     2077     9872    1         DCL   HEX$(0:3)   PTR  STATIC INIT(
     2078     9873    1                                          ADDR(TEMP_LINK.HEX0),
     2079     9874    1                                          ADDR(TEMP_LINK.HEX1),
     2080     9875    1                                          ADDR(TEMP_LINK.HEX2),
     2081     9876    1                                          ADDR(TEMP_LINK.HEX3));
     2082     9877    1   DCL OFFSET UBIN;
     2083     9878    1   DCL TEMP   UBIN;
     2084     9879    1   DCL IN$ PTR;
     2085     9880    1   DCL NODE UBIN;
     2086     9881    1   DCL S SBIN;
     2087     9882    1   DCL I UBIN;
     2088     9883    1   DCL J UBIN;
     2089     9884    1   DCL K UBIN;
     2090     9885    1   DCL DELINDX UBIN;
     2091     9886    1   DCL PSEUDO_NAME CHAR(8);
     2092     9887    1   DCL NODENAME CHAR(8);
     2093     9888    1   DCL FOUND BIT(1);
     2094     9889        %KS$BOX(TITLE="FPTs, VLPs and such");

              9907    1   /***************************************************************************
              9908    1    *                                                                         *
              9909    1    *                            FPTs, VLPs and such                          *
              9910    1    *                                                                         *
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:374  
              9911    1    ***************************************************************************/

     2095     9916        %FPT_READ (FPTN=READ_NETCON,
     2096     9917                   DCB=M$NETCON,
     2097     9918                   KEYS=YES);
     2098     9957        %FPT_WRITE (FPTN=WRITE_NETCON,
     2099     9958                    DCB=M$NETCON);
     2100     9989        %FPT_DELREC(FPTN=DELETE_NETCON,
     2101     9990                    DCB = M$NETCON);
     2102    10009
     2103    10010        %KS$BOX(TITLE="DCBs");

             10028    1   /***************************************************************************
             10029    1    *                                                                         *
             10030    1    *                                    DCBs                                 *
             10031    1    *                                                                         *
             10032    1    ***************************************************************************/

     2104    10037    1   DCL M$NETCON DCB;
     2105    10038        %EJECT;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:375  
     2106    10039    2        DO CASE(OUT$BLK.CODE);
     2107    10040    2           CASE(%KS_PSEUDO);
     2108    10041    3              IF KS_NODENAME = 'HOST' THEN DO;
     2109    10042    3                 CALL KSE$ERRMSG(%E$KS_NONODE);
     2110    10043    3                 RETURN;
     2111    10044    3                 END;  /* IF KS_NODENAME = 'HOST' */
     2112    10045    2           CALL KSU$READ_NETCON(VECTOR(KS_NETWORK_KEY),VECTOR(KS_NETWORK))
     2113    10046    2              ALTRET(DEL_ERR);
     2114    10047    2           IF KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_HOST OR
     2115    10048    2              KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_ME THEN
     2116    10049    3              DO;
     2117    10050    3                 CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);
     2118    10051    3                 RETURN;
     2119    10052    3              END;
     2120    10053
     2121    10054    2              KS_PSEUDO_KEY.NODE = KS_NODE;
     2122    10055    2              READ_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);
     2123    10056    2              READ_NETCON.BUF_ = VECTOR(KS_PSEUDO);
     2124    10057    3              CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     2125    10058    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY
     2126    10059    3                    THEN GOTO DEL_ERR;
     2127    10060    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NODENAME);
     2128    10061    3                 KS_SUB_BUF_1.TEXT = KS_NODENAME;
     2129    10062    3                 CALL KSE$ERRMSG(%E$KS_NOPSEUDOS,VECTOR(KS_SUB_BUF_1));
     2130    10063    3                 RETURN;
     2131    10064    3                 END;  /* WHENALTRETURN */
     2132    10065    2              PSEUDO_NAME = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2133    10066    2              FOUND = '0'B;
     2134    10067    3              DO I = 0 TO KS_PSEUDO.PSEUDO# - 1;
     2135    10068    4                 IF KS_PSEUDO.PSEUDO.NAME(I) = PSEUDO_NAME THEN DO;
     2136    10069    4                    FOUND = '1'B;
     2137    10070    4                    DELINDX = I;
     2138    10071    4                    END;  /* IF FOUND */
     2139    10072    3                 END;  /* DO I */
     2140    10073    3              IF NOT FOUND THEN DO;
     2141    10074    3                 KS_SUB_BUF_1.COUNT = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
     2142    10075    3                 KS_SUB_BUF_1.TEXT = PSEUDO_NAME;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:376  
     2143    10076    3                 KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);
     2144    10077    3                 KS_SUB_BUF_2.TEXT = KS_NODENAME;
     2145    10078    3                 CALL KSE$ERRMSG(%E$KS_BAD_PSEUDO,VECTOR(KS_SUB_BUF_1),VECTOR(
             10078                          KS_SUB_BUF_2));
     2146    10079                      /*E* ERROR: KSN-E$KS_BAD_PSEUDO-0
     2147    10080                           MESSAGE: %U1 has not been defined for node %U2
     2148    10081                           DESCRIPTION: NO SUCH PSEUDO */
     2149    10082    3                 RETURN;
     2150    10083    3                 END;  /* IF NOT FOUND */
     2151    10084    3              DO I = DELINDX TO KS_PSEUDO.PSEUDO# - 1;
     2152    10085    3                 KS_PSEUDO.PSEUDO(I) = KS_PSEUDO.PSEUDO(I+1);
     2153    10086    3                 END;  /* DO I */
     2154    10087    2              KS_PSEUDO.PSEUDO# = KS_PSEUDO.PSEUDO# - 1;
     2155    10088    2              WRITE_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);
     2156    10089    2              WRITE_NETCON.BUF_ = VECTOR(KS_PSEUDO);
     2157    10090    2              WRITE_NETCON.BUF_.BOUND = KS_PSEUDO.PSEUDO# * 28 + 4 - 1;
     2158    10091    2              CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);
     2159    10092    2           CASE(%KS_NODE);
     2160    10093    2              READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
     2161    10094    2              READ_NETCON.BUF_ = VECTOR(KS_NETWORK);
     2162    10095    3              CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     2163    10096    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY
     2164    10097    3                    THEN GOTO DEL_ERR;
     2165    10098    3                 KS_NETWORK = '0'B;
     2166    10099    3                 END;  /* WHENALTRETURN */
     2167    10100    2             READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);
     2168    10101    2             READ_NETCON.BUF_ = VECTOR(KS_RFEP);
     2169    10102    3             CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     2170    10103    3                KS_RFEP = KS_NETWORK;
     2171    10104    3             END;
     2172    10105    3              IF KS_NETWORK.NODE# = 0 THEN DO;
     2173    10106    3                 CALL KSE$ERRMSG(%E$KS_NO_NETWORK);
     2174    10107    3                 END;  /* IF NODE# = 0 */
     2175    10108    3              ELSE DO;
     2176    10109    3                 FOUND = '0'B;
     2177    10110    3                 CALL CHARBIN(NODE,OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     2178    10111    4      NDSRCH:    DO I = 0 TO KS_NETWORK.NODE#;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:377  
     2179    10112    5                    IF I = NODE THEN DO;
     2180    10113    5                       NODENAME = KS_NETWORK.NODE.NODE(I);
     2181    10114    5                       FOUND = '1'B;
     2182    10115    5                       DELINDX = I;
     2183    10116    5                       EXIT NDSRCH;
     2184    10117    5                       END;   /* IF */
     2185    10118    4                    END;  /* DO I */
     2186    10119    4                 IF NOT FOUND THEN DO;
     2187    10120    4                    KS_SUB_BUF_1.COUNT = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
     2188    10121    4                    KS_SUB_BUF_1.TEXT = NODENAME;
     2189    10122    4                    CALL KSE$ERRMSG(%E$KS_UNDEFNODE,VECTOR(KS_SUB_BUF_1));
     2190    10123                         /*E* ERROR: KSN-E$KS_UNDEFNODE-0
     2191    10124                              MESSAGE: Node %U1 has not been defined.
     2192    10125                              DESCRIPTION: SEE MESSAGE */
     2193    10126    4                    RETURN;
     2194    10127    4                    END;  /* IF NOT FOUND */
     2195    10128    3                 KS_NETWORK.NODE.TYPE (DELINDX) = 0;
     2196    10129    3                 KS_NETWORK.NODE.NODE (DELINDX) = ' ';
     2197    10130    3                 WRITE_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
     2198    10131    3                 WRITE_NETCON.BUF_ = VECTOR(KS_NETWORK);
     2199    10132    3                 WRITE_NETCON.BUF_.BOUND = SIZEV(KS_NETWORK) - SIZEC(KS_NETWORK.NODE) +
             10132                          KS_NETWORK.NODE# * SIZEC(KS_NETWORK.NODE(0));
     2200    10133    3                 CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);
     2201    10134    3                KS_RFEP.NODE.TYPE (DELINDX) = 0;
     2202    10135    3                WRITE_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);
     2203    10136    3                WRITE_NETCON.BUF_ = VECTOR(KS_RFEP);
     2204    10137    3                WRITE_NETCON.BUF_.BOUND = SIZEV(KS_RFEP) - SIZEC(KS_RFEP.NODE) +
             10137                         KS_RFEP.NODE# * SIZEC(KS_RFEP.NODE(0));
     2205    10138    3                CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);
     2206    10139        /*
     2207    10140                delete all of the configuration records (if any) associated
     2208    10141                with this node.  However, if the node is 0 and the channel
     2209    10142                is 0 then this key belongs to SUPER and we should leave it
     2210    10143                alone.
     2211    10144        */
     2212    10145    3                 IF NODE ~= 0 THEN
     2213    10146    4                    DO;   /* dont delete configs if node = 0 */
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:378  
     2214    10147    4                 KS_CONFIG_KEY.NODE = NODE;
     2215    10148    4                 KS_CONFIG_KEY.TERMID = '0'B;
     2216    10149                         /* delete config records */
     2217    10150                         /* change prompt if same as deleted node */
     2218    10151
     2219    10152    4                    IF NODE = KS_NODE THEN
     2220    10153    5                       DO;
     2221    10154    5                       KS_NODE = 0;
     2222    10155    5                       KS_NODENAME = KS_NETWORK.NODE.NODE(0);
     2223    10156    5                       KS_NODENAME_SV = ' ';
     2224    10157    5                       PROMPT.NODENAME = 'HOST';
     2225    10158    5                       END;
     2226    10159    4                    KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = ' ';
     2227    10160    4                    KS_CONFIG_KEY.NODE = NODE;
     2228    10161    4                    DELETE_NETCON.KEY_ = VECTOR (KS_CONFIG_KEY);
     2229    10162    4                    KS_CONFIG_LKEY.NODE = NODE;
     2230    10163    4                    KS_CONFIG_LKEY.TERMID.TTYP = BITBIN('777'O);
     2231    10164    4                    KS_CONFIG_LKEY.TERMID.LEV = BITBIN('777'O);
     2232    10165    4                    DELETE_NETCON.LKEY_ = VECTOR (KS_CONFIG_LKEY);
     2233    10166    4                    CALL M$DELREC(DELETE_NETCON);
     2234    10167    4                       END;  /* dont delete config records if node=0 */
     2235    10168                         /* delete default records */
     2236    10169    3                    KS_DFLT_KEY.NODE = NODE;
     2237    10170    3                    KS_DFLT_KEY.HNDLR = ' ';
     2238    10171    3                    KS_DFLT_LKEY = KS_DFLT_KEY;
     2239    10172    3                    KS_DFLT_LKEY.HNDLR = '~~~~~';
     2240    10173    3                    DELETE_NETCON.KEY_ = VECTOR(KS_DFLT_KEY);
     2241    10174    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_DFLT_LKEY);
     2242    10175    3                    CALL M$DELREC(DELETE_NETCON);
     2243    10176                         /* delete handler records  */
     2244    10177    3                    KS_HNDLR_KEY.NODE = NODE;
     2245    10178    3                    KS_HNDLR_KEY.HNDLR = ' ';
     2246    10179    3                    KS_HNDLR_LKEY.HNDLR = '~~~~~~~';
     2247    10180    3                    KS_HNDLR_LKEY.NODE = NODE;
     2248    10181    3                    DELETE_NETCON.KEY_ = VECTOR(KS_HNDLR_KEY);
     2249    10182    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_HNDLR_LKEY);
     2250    10183    3                    CALL M$DELREC (DELETE_NETCON);
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:379  
     2251    10184                         /* delete boot record */
     2252    10185    3                    KS_FEPBOOT_KEY.NODE = NODE;
     2253    10186    3                    DELETE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
     2254    10187    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_FEPBOOT_KEY);
     2255    10188    3                    CALL M$DELREC (DELETE_NETCON);
     2256    10189                         /* delete fep hndlr record */
     2257    10190    3                    KS_FEPHNDLR_KEY.NODE = NODE;
     2258    10191    3                    DELETE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);
     2259    10192    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_FEPHNDLR_KEY);
     2260    10193    3                    CALL M$DELREC(DELETE_NETCON);
     2261    10194
     2262    10195    3                    KS_FEPCTL_KEY.NODE = NODE;
     2263    10196    3                    DELETE_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);
     2264    10197    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_FEPCTL_KEY);
     2265    10198    3                    CALL M$DELREC(DELETE_NETCON);
     2266    10199    3                    KS_LINK_KEY.NODE = NODE;
     2267    10200    3                    DELETE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     2268    10201    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_LINK_KEY);
     2269    10202    3                    CALL M$DELREC(DELETE_NETCON);
     2270    10203    3                    KS_PSEUDO_KEY.NODE = NODE;
     2271    10204    3                    DELETE_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);
     2272    10205    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_PSEUDO_KEY);
     2273    10206    3                    CALL M$DELREC(DELETE_NETCON);
     2274    10207    3   UPDATE.CODE = %IGA_UPDATE;
     2275    10208    4   CALL KSR$WR_HLPCG(VECTOR(UPDATE)) WHENALTRETURN DO; END;
     2276    10209
     2277    10210    3                 END;                      /* ELSE                               */
     2278    10211        %EJECT;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:380  
     2279    10212    2   CASE (%KS_LINKS);
     2280    10213    3              IF KS_NODENAME = 'HOST' THEN DO;
     2281    10214    3                 CALL KSE$ERRMSG(%E$KS_NONODE);
     2282    10215    3                 RETURN;
     2283    10216    3                 END;  /* IF KS_NODENAME = 'HOST' */
     2284    10217    2           CALL KSU$READ_NETCON(VECTOR(KS_NETWORK_KEY),VECTOR(KS_NETWORK))
     2285    10218    2              ALTRET(DEL_ERR);
     2286    10219    2           IF KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_HOST OR
     2287    10220    2              KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_ME THEN
     2288    10221    3              DO;
     2289    10222    3                 CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);
     2290    10223    3                 RETURN;
     2291    10224    3              END;
     2292    10225
     2293    10226    2         KS_LINK_KEY.NODE = KS_NODE;
     2294    10227
     2295    10228    2         IF OUT$BLK.NSUBLKS = 0  THEN        /*DELETE LINKS ALL*/
     2296    10229    2            KS_LINK.LINKS# = 0;
     2297    10230    2         ELSE
     2298    10231    3            DO;
     2299    10232    3               READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     2300    10233    3               READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     2301    10234    3               CALL M$READ(READ_NETCON) WHENALTRETURN
     2302    10235    4                  DO;
     2303    10236                     /*N* do error message which indicates to links defined for this node */
     2304    10237    4                  END;
     2305    10238    4               DO I = 0 TO OUT$BLK.NSUBLKS - 1;
     2306    10239    4                  IN$ = OUT$BLK.SUBLK$(I);
     2307    10240    4                  TEMP_LINK = '0'B;
     2308    10241    4                  OFFSET = 4 - IN$->OUT$SYM.COUNT;
     2309    10242    5                  DO J = OFFSET TO 3;
     2310    10243    5                     CALL INDEX (TEMP,SUBSTR(IN$->OUT$SYM.TEXT,J-OFFSET,1),HEX_CHARS);
     2311    10244    5                     HEX$(J)->HEX = TEMP;
     2312    10245    5                  END;
     2313    10246
     2314    10247    4   FIND_LINK_LOOP:
     2315    10248    5                  DO J = 0 TO KS_LINK.LINKS# - 1;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:381  
     2316    10249    5                     IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN
     2317    10250    5                        EXIT FIND_LINK_LOOP;
     2318    10251    5                  END;
     2319    10252
     2320    10253    4                  IF J < KS_LINK.LINKS# THEN
     2321    10254    5                     DO;
     2322    10255    6                        DO K = J TO KS_LINK.LINKS# - 2;
     2323    10256    6                           KS_LINK.CHANNEL(K) = KS_LINK.CHANNEL(K+1);
     2324    10257    6                        END;
     2325    10258    5                        KS_LINK.LINKS# = KS_LINK.LINKS# - 1;
     2326    10259    5                     END;
     2327    10260    4               END;
     2328    10261    3            END;
     2329    10262    2     WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     2330    10263    2     WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     2331    10264    2     IF KS_LINK.LINKS# <= 0 THEN
     2332    10265    2        WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) - 1;
     2333    10266    2     ELSE
     2334    10267    2        WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +
     2335    10268    2                                  (SIZEC(KS_LINK.CHANNEL(0)) * KS_LINK.LINKS#) - 1;
     2336    10269    2     CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);
     2337    10270        %EJECT;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:382  
     2338    10271    2        CASE (%KS_CONFIG);
     2339    10272    3              IF KS_NODENAME = 'HOST' THEN DO;
     2340    10273    3                 CALL KSE$ERRMSG(%E$KS_NONODE);
     2341    10274    3                 RETURN;
     2342    10275    3                 END;  /* IF KS_NODENAME = 'HOST' */
     2343    10276    2           CALL KSU$READ_NETCON(VECTOR(KS_NETWORK_KEY),VECTOR(KS_NETWORK))
     2344    10277    2              ALTRET(DEL_ERR);
     2345    10278    2           IF KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_HOST OR
     2346    10279    2              KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_ME THEN
     2347    10280    3              DO;
     2348    10281    3                 CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);
     2349    10282    3                 RETURN;
     2350    10283    3              END;
     2351    10284
     2352    10285    2           KS_CONFIG_KEY.NODE = KS_NODE;
     2353    10286    2           KS_CONFIG_LKEY.NODE = KS_NODE;
     2354    10287    2           KS_CONFIG_KEY.TERMID = '0'B;
     2355    10288
     2356    10289    2           IF OUT$BLK.NSUBLKS = 0 THEN
     2357    10290    3              DO;
     2358    10291    3                 KS_CONFIG_LKEY.TERMID.TTYP = BITBIN ('777'O);
     2359    10292    3                 KS_CONFIG_LKEY.TERMID.LEV  = BITBIN ('777'O);
     2360    10293    3              END;
     2361    10294    2           ELSE
     2362    10295    3              DO;
     2363    10296    3                 CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),KS_CONFIG_KEY
             10296                          .TERMID) ALTRET(NO_ERR);
     2364    10297    3                 IF OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS = 2 THEN
     2365    10298    4                    DO;
     2366    10299    4                       CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(1),
             10299                                KS_CONFIG_LKEY.TERMID) ALTRET(NO_ERR);
     2367    10300    4                       CALL KSU$CHK_TRM_RNG(KS_CONFIG_KEY.TERMID,KS_CONFIG_LKEY.TERMID)
     2368    10301    5                          WHENALTRETURN DO;
     2369    10302    5                             CALL KSE$ERRMSG (%E$KS_BAD_TRM_RANGE);
     2370    10303    5                             GOTO NO_ERR;
     2371    10304    5                          END;
     2372    10305    4                    END;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:383  
     2373    10306    3                 ELSE
     2374    10307    3                    KS_CONFIG_LKEY.TERMID = KS_CONFIG_KEY.TERMID;
     2375    10308    3              END;
     2376    10309    2        IF KS_CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' ' THEN
     2377    10310    3           DO;
     2378    10311    3              KS_CONFIG_KEY.NODE = 0;
     2379    10312    3              KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;
     2380    10313    3              KS_CONFIG_LKEY.NODE = 0;
     2381    10314    3              KS_CONFIG_LKEY.TERMID.TERM.CHANNEL = '0'B;
     2382    10315    3           END;
     2383    10316
     2384    10317    2           DELETE_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);
     2385    10318    2           DELETE_NETCON.LKEY_ = VECTOR(KS_CONFIG_LKEY);
     2386    10319    2           CALL M$DELREC(DELETE_NETCON);
     2387    10320    2              END;  /* DO CASE(CODE) */
     2388    10321    2        DO WHILE('0'B);
     2389    10322    2   DEL_ERR:;
     2390    10323    2           CALL KSE$ERRMSG(0);
     2391    10324    2           END;  /* DO NEVER */
     2392    10325    1     NO_ERR:;
     2393    10326    1        RETURN;
     2394    10327    1   END KSC$DELETE;
     2395    10328        %EOD;

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:384  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$DELETE.

   Procedure KSC$DELETE requires 678 words for executable code.
   Procedure KSC$DELETE requires 24 words of local(AUTO) storage.

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:385  

 Object Unit name= KSC$DELETE                                 File name= KSC$COMMANDS2.:E05TOU
 UTS= JUL 30 '97 01:46:17.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      9     11  KSC$DELETE
    2   Data  even  none  2992   5660  KSC$DELETE
    3   DCB   even  none     0      0  M$NETCON
    4   Proc  even  none   678   1246  KSC$DELETE
    5  RoData even  none    66    102  KSC$DELETE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  KSC$DELETE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 KSE$ERRMSG
 yes     yes           Std       2 KSU$READ_NETCON
 yes     yes           Std       2 KSU$CHK_TRM_RNG
 yes     yes           Std       1 KSR$WR_HLPCG
 yes     yes           Std       3 KSU$BLD_TERMID
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:386  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODENAME
     KS_NODE                               KS_NODENAME_SV                        KS_MSGBUF
     KS_MSGBUF$                            KS_SUB_BUF_1                          KS_SUB_BUF_2
     B$TCB$                                PROMPT                                M$NETCON
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:387  


     2006        1        /*T***********************************************************/
     2007        2        /*T*                                                         */
     2008        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2009        4        /*T*                                                         */
     2010        5        /*T***********************************************************/
     2011        6        KSC$DELETE: PROC(TOP$) ALTRET;

      6  4 000000   000000 700200 xent  KSC$DELETE   TSX0  ! X66_AUTO_1
         4 000001   000030 000001                    ZERO    24,1

     2012        7        /**/
     2013        8    1   DCL TOP$ PTR;
     2014        9        /**/
     2015       10        %INCLUDE CP_6;
     2016       91        %INCLUDE KL_MACRO_C;
     2017     3443        %INCLUDE KL_CONFIG_M;
     2018     4205        %INCLUDE KS_MACRO_M;
     2019     4402        %INCLUDE KS_SUBS_C;
     2020     4645        %INCLUDE KS_DATA_R;
     2021     4660        %INCLUDE KS_PERR_C;
     2022     4727        %INCLUDE XU_MACRO_C;
     2023     7833        %INCLUDE B_ERRORS_C;
     2024     8960        %INCLUDE F$DCB;
     2025     9009        %INCLUDE            KL_AFCN_C;
     2026     9110        /**/
     2027     9111        %KS$BOX(TITLE="entry defs");

              9129    1   /***************************************************************************
              9130    1    *                                                                         *
              9131    1    *                                 entry defs                              *
              9132    1    *                                                                         *
              9133    1    ***************************************************************************/

     2028     9138    1   DCL KSE$ERRMSG ENTRY(4);
     2029     9139    1   DCL                 KSR$WR_HLPCG ENTRY(1) ALTRET;
     2030     9140    1   DCL KSU$READ_NETCON ENTRY(2) ALTRET;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:388  
     2031     9141    1   DCL KSU$BLD_TERMID  ENTRY(3) ALTRET;
     2032     9142    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
     2033     9143        %KS$BOX(TITLE="symref variables");

              9161    1   /***************************************************************************
              9162    1    *                                                                         *
              9163    1    *                              symref variables                           *
              9164    1    *                                                                         *
              9165    1    ***************************************************************************/

     2034     9170    1   DCL B$TCB$ PTR SYMREF;
     2035     9171        %KS$BOX(TITLE="symdef variables");

              9189    1   /***************************************************************************
              9190    1    *                                                                         *
              9191    1    *                              symdef variables                           *
              9192    1    *                                                                         *
              9193    1    ***************************************************************************/

     2036     9198        %KS$BOX(TITLE="constant variables");

              9216    1   /***************************************************************************
              9217    1    *                                                                         *
              9218    1    *                             constant variables                          *
              9219    1    *                                                                         *
              9220    1    ***************************************************************************/

     2037     9225    1   DCL HEX_CHARS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
     2038     9226        %KS$BOX(TITLE="static variables");

              9244    1   /***************************************************************************
              9245    1    *                                                                         *
              9246    1    *                              static variables                           *
              9247    1    *                                                                         *
              9248    1    ***************************************************************************/

     2039     9253    1   DCL 1 PROMPT SYMREF,
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:389  
     2040     9254    1        2 NODENAME CHAR(8),
     2041     9255    1        2 STAR CHAR(2);
     2042     9256        %KL$HNDLR_KEY(NAME = KS_HNDLR_KEY,STCLASS=STATIC);
     2043     9275        %KL$HNDLR_KEY(NAME = KS_HNDLR_LKEY,STCLASS=STATIC);
     2044     9294        %KL$DEFAULT_KEY(NAME = KS_DFLT_KEY,STCLASS=STATIC);
     2045     9313        %KL$DEFAULT_KEY(NAME = KS_DFLT_LKEY,STCLASS=STATIC);
     2046     9332        %KL$CONFIG_KEY(NAME = KS_CONFIG_LKEY,STCLASS=STATIC);
     2047     9379        %KL$FEPBOOT_KEY(NAME = KS_FEPBOOT_KEY,STCLASS=STATIC);
     2048     9397        %KL$FEPHNDLR_KEY(NAME = KS_FEPHNDLR_KEY,STCLASS=STATIC);
     2049     9415        %KL$FEPCTL_KEY(NAME = KS_FEPCTL_KEY,STCLASS=STATIC);
     2050     9433        %KL$LINK_KEY(NAME = KS_LINK_KEY,STCLASS=STATIC);
     2051     9451        %KL$PSEUDO (NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
     2052     9495        %KL$PSEUDO_KEY (NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
     2053     9513        %KL$CONFIG_KEY(NAME = KS_CONFIG_KEY,STCLASS=STATIC);
     2054     9560        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=STATIC);
     2055     9587        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
     2056     9604    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
     2057     9605    1        2  CNT UBIN BYTE UNAL INIT(1),
     2058     9606    1       2  TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
     2059     9607        %KL$NETWORK         (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
     2060     9634    1   DCL                 HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
     2061     9635        %KS$BOX(TITLE="based variables");

              9653    1   /***************************************************************************
              9654    1    *                                                                         *
              9655    1    *                              based variables                            *
              9656    1    *                                                                         *
              9657    1    ***************************************************************************/

     2062     9662    1   DCL   HEX   UBIN(4)  BASED UNAL;
     2063     9663        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2064     9708        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
     2065     9746        %B$TCB;
     2066     9749        %B$ALT;
     2067     9757        %KL_HDR(FPTN=UPDATE,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     2068     9837        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:390  
              9855    1   /***************************************************************************
              9856    1    *                                                                         *
              9857    1    *                               auto variables                            *
              9858    1    *                                                                         *
              9859    1    ***************************************************************************/

     2069     9864    1   DCL LINK# UBIN;
     2070     9865    1   DCL   1  TEMP_LINK   STATIC,
     2071     9866    1            2  *        BIT(1) UNAL,
     2072     9867    1            2  HEX0     UBIN(4) UNAL,
     2073     9868    1            2  HEX1     UBIN(4) UNAL,
     2074     9869    1            2  *        BIT(1)  UNAL,
     2075     9870    1            2  HEX2     UBIN(4) UNAL,
     2076     9871    1            2  HEX3     UBIN(4) UNAL;
     2077     9872    1         DCL   HEX$(0:3)   PTR  STATIC INIT(
     2078     9873    1                                          ADDR(TEMP_LINK.HEX0),
     2079     9874    1                                          ADDR(TEMP_LINK.HEX1),
     2080     9875    1                                          ADDR(TEMP_LINK.HEX2),
     2081     9876    1                                          ADDR(TEMP_LINK.HEX3));
     2082     9877    1   DCL OFFSET UBIN;
     2083     9878    1   DCL TEMP   UBIN;
     2084     9879    1   DCL IN$ PTR;
     2085     9880    1   DCL NODE UBIN;
     2086     9881    1   DCL S SBIN;
     2087     9882    1   DCL I UBIN;
     2088     9883    1   DCL J UBIN;
     2089     9884    1   DCL K UBIN;
     2090     9885    1   DCL DELINDX UBIN;
     2091     9886    1   DCL PSEUDO_NAME CHAR(8);
     2092     9887    1   DCL NODENAME CHAR(8);
     2093     9888    1   DCL FOUND BIT(1);
     2094     9889        %KS$BOX(TITLE="FPTs, VLPs and such");

              9907    1   /***************************************************************************
              9908    1    *                                                                         *
              9909    1    *                            FPTs, VLPs and such                          *
              9910    1    *                                                                         *
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:391  
              9911    1    ***************************************************************************/

     2095     9916        %FPT_READ (FPTN=READ_NETCON,
     2096     9917                   DCB=M$NETCON,
     2097     9918                   KEYS=YES);
     2098     9957        %FPT_WRITE (FPTN=WRITE_NETCON,
     2099     9958                    DCB=M$NETCON);
     2100     9989        %FPT_DELREC(FPTN=DELETE_NETCON,
     2101     9990                    DCB = M$NETCON);
     2102    10009
     2103    10010        %KS$BOX(TITLE="DCBs");

             10028    1   /***************************************************************************
             10029    1    *                                                                         *
             10030    1    *                                    DCBs                                 *
             10031    1    *                                                                         *
             10032    1    ***************************************************************************/

     2104    10037    1   DCL M$NETCON DCB;
     2105    10038        %EJECT;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:392  
     2106    10039    2        DO CASE(OUT$BLK.CODE);

  10039  4 000002   200003 470500                    LDP0    @TOP$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   100000 720100                    LXL0    0,,PR1
         4 000005   000007 100003                    CMPX0   7,DU
         4 000006   000010 602010 4                  TNC     s:10039+6,X0
         4 000007   001240 710000 4                  TRA     s:10321
         4 000010   001240 710000 4                  TRA     s:10321
         4 000011   000225 710000 4                  TRA     s:10093
         4 000012   000017 710000 4                  TRA     s:10041
         4 000013   001240 710000 4                  TRA     s:10321
         4 000014   001240 710000 4                  TRA     s:10321
         4 000015   001100 710000 4                  TRA     s:10272
         4 000016   000645 710000 4                  TRA     s:10213

     2107    10040    2           CASE(%KS_PSEUDO);

     2108    10041    3              IF KS_NODENAME = 'HOST' THEN DO;

  10041  4 000017   040000 106400                    CMPC    fill='040'O
         4 000020   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000021   000004 000004 1                  ADSC9   HEX_CHARS+4              cn=0,n=4
         4 000022   000030 601000 4                  TNZ     s:10045

     2109    10042    3                 CALL KSE$ERRMSG(%E$KS_NONODE);

  10042  4 000023   000000 630400 5                  EPPR0   0
         4 000024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000025   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000026   000000 011000                    NOP     0

     2110    10043    3                 RETURN;

  10043  4 000027   000000 702200 xent               TSX2  ! X66_ARET

     2111    10044    3                 END;  /* IF KS_NODENAME = 'HOST' */
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:393  
     2112    10045    2           CALL KSU$READ_NETCON(VECTOR(KS_NETWORK_KEY),VECTOR(KS_NETWORK))

  10045  4 000030   000006 630400 5                  EPPR0   6
         4 000031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000032   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 000033   001241 702000 4                  TSX2    DEL_ERR

     2113    10046    2              ALTRET(DEL_ERR);
     2114    10047    2           IF KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_HOST OR

  10047  4 000034   000000 236000 xsym               LDQ     KS_NODE
         4 000035   000005 402007                    MPY     5,DL
         4 000036   000602 235006 2                  LDA     KS_NETWORK+1,QL
         4 000037   000001 115007                    CMPA    1,DL
         4 000040   000043 600000 4                  TZE     s:10050
         4 000041   000003 115007                    CMPA    3,DL
         4 000042   000050 601000 4                  TNZ     s:10054

     2115    10048    2              KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_ME THEN
     2116    10049    3              DO;

     2117    10050    3                 CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);

  10050  4 000043   000011 630400 5                  EPPR0   9
         4 000044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000045   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000046   000000 011000                    NOP     0

     2118    10051    3                 RETURN;

  10051  4 000047   000000 702200 xent               TSX2  ! X66_ARET

     2119    10052    3              END;
     2120    10053
     2121    10054    2              KS_PSEUDO_KEY.NODE = KS_NODE;

  10054  4 000050   000000 236000 xsym               LDQ     KS_NODE
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:394  
         4 000051   000011 736000                    QLS     9
         4 000052   000573 552010 2                  STBQ    KS_PSEUDO_KEY,'10'O

     2122    10055    2              READ_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);

  10055  4 000053   000012 237000 5                  LDAQ    10
         4 000054   005616 757000 2                  STAQ    READ_NETCON+2

     2123    10056    2              READ_NETCON.BUF_ = VECTOR(KS_PSEUDO);

  10056  4 000055   000014 237000 5                  LDAQ    12
         4 000056   005620 757000 2                  STAQ    READ_NETCON+4

     2124    10057    3              CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  10057  4 000057   005614 630400 2                  EPPR0   READ_NETCON
         4 000060   440000 713400                    CLIMB   alt,read
         4 000061   401400 401760                    pmme    nvectors=4
         4 000062   000064 702000 4                  TSX2    s:10058
         4 000063   000104 710000 4                  TRA     s:10065

     2125    10058    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY

  10058  4 000064   000000 470400 xsym               LDP0    B$TCB$
         4 000065   000000 471500                    LDP1    0,,PR0
         4 000066   100102 236100                    LDQ     66,,PR1
         4 000067   377770 376007                    ANQ     131064,DL
         4 000070   001020 116007                    CMPQ    528,DL
         4 000071   001241 601000 4                  TNZ     DEL_ERR

     2126    10059    3                    THEN GOTO DEL_ERR;
     2127    10060    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NODENAME);

  10060  4 000072   010000 236003                    LDQ     4096,DU
         4 000073   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2128    10061    3                 KS_SUB_BUF_1.TEXT = KS_NODENAME;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:395  

  10061  4 000074   040000 100400                    MLR     fill='040'O
         4 000075   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000076   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2129    10062    3                 CALL KSE$ERRMSG(%E$KS_NOPSEUDOS,VECTOR(KS_SUB_BUF_1));

  10062  4 000077   000021 630400 5                  EPPR0   17
         4 000100   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000101   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000102   000000 011000                    NOP     0

     2130    10063    3                 RETURN;

  10063  4 000103   000000 702200 xent               TSX2  ! X66_ARET

     2131    10064    3                 END;  /* WHENALTRETURN */
     2132    10065    2              PSEUDO_NAME = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  10065  4 000104   200003 470500                    LDP0    @TOP$,,AUTO
         4 000105   000000 471500                    LDP1    0,,PR0
         4 000106   100003 473500                    LDP3    3,,PR1
         4 000107   300004 236100                    LDQ     4,,PR3
         4 000110   000033 772000                    QRL     27
         4 000111   000000 620006                    EAX0    0,QL
         4 000112   040100 100540                    MLR     fill='040'O
         4 000113   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000114   200016 000010                    ADSC9   PSEUDO_NAME,,AUTO        cn=0,n=8

     2133    10066    2              FOUND = '0'B;

  10066  4 000115   200022 450100                    STZ     FOUND,,AUTO

     2134    10067    3              DO I = 0 TO KS_PSEUDO.PSEUDO# - 1;

  10067  4 000116   200012 450100                    STZ     I,,AUTO
         4 000117   000135 710000 4                  TRA     s:10072+3
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:396  

     2135    10068    4                 IF KS_PSEUDO.PSEUDO.NAME(I) = PSEUDO_NAME THEN DO;

  10068  4 000120   200012 236100                    LDQ     I,,AUTO
         4 000121   000034 402007                    MPY     28,DL
         4 000122   040100 106406                    CMPC    fill='040'O
         4 000123   000026 000010 2                  ADSC9   KS_PSEUDO+1,Q            cn=0,n=8
         4 000124   200016 000010                    ADSC9   PSEUDO_NAME,,AUTO        cn=0,n=8
         4 000125   000132 601000 4                  TNZ     s:10072

     2136    10069    4                    FOUND = '1'B;

  10069  4 000126   400000 236003                    LDQ     -131072,DU
         4 000127   200022 756100                    STQ     FOUND,,AUTO

     2137    10070    4                    DELINDX = I;

  10070  4 000130   200012 235100                    LDA     I,,AUTO
         4 000131   200015 755100                    STA     DELINDX,,AUTO

     2138    10071    4                    END;  /* IF FOUND */

     2139    10072    3                 END;  /* DO I */

  10072  4 000132   200012 235100                    LDA     I,,AUTO
         4 000133   000001 035007                    ADLA    1,DL
         4 000134   200012 755100                    STA     I,,AUTO
         4 000135   200012 236100                    LDQ     I,,AUTO
         4 000136   000025 116000 2                  CMPQ    KS_PSEUDO
         4 000137   000120 602000 4                  TNC     s:10068

     2140    10073    3              IF NOT FOUND THEN DO;

  10073  4 000140   200022 234100                    SZN     FOUND,,AUTO
         4 000141   000164 604000 4                  TMI     s:10084

     2141    10074    3                 KS_SUB_BUF_1.COUNT = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:397  

  10074  4 000142   200003 470500                    LDP0    @TOP$,,AUTO
         4 000143   000000 471500                    LDP1    0,,PR0
         4 000144   100003 473500                    LDP3    3,,PR1
         4 000145   300004 236100                    LDQ     4,,PR3
         4 000146   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2142    10075    3                 KS_SUB_BUF_1.TEXT = PSEUDO_NAME;

  10075  4 000147   040000 100500                    MLR     fill='040'O
         4 000150   200016 000010                    ADSC9   PSEUDO_NAME,,AUTO        cn=0,n=8
         4 000151   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2143    10076    3                 KS_SUB_BUF_2.COUNT = SIZEC(KS_NODENAME);

  10076  4 000152   010000 236003                    LDQ     4096,DU
         4 000153   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     2144    10077    3                 KS_SUB_BUF_2.TEXT = KS_NODENAME;

  10077  4 000154   040000 100400                    MLR     fill='040'O
         4 000155   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000156   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

     2145    10078    3                 CALL KSE$ERRMSG(%E$KS_BAD_PSEUDO,VECTOR(KS_SUB_BUF_1),VECTOR(
             10078                          KS_SUB_BUF_2));

  10078  4 000157   000027 630400 5                  EPPR0   23
         4 000160   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000161   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000162   000000 011000                    NOP     0

     2146    10079                      /*E* ERROR: KSN-E$KS_BAD_PSEUDO-0
     2147    10080                           MESSAGE: %U1 has not been defined for node %U2
     2148    10081                           DESCRIPTION: NO SUCH PSEUDO */
     2149    10082    3                 RETURN;

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:398  
  10082  4 000163   000000 702200 xent               TSX2  ! X66_ARET

     2150    10083    3                 END;  /* IF NOT FOUND */
     2151    10084    3              DO I = DELINDX TO KS_PSEUDO.PSEUDO# - 1;

  10084  4 000164   200015 235100                    LDA     DELINDX,,AUTO
         4 000165   200012 755100                    STA     I,,AUTO
         4 000166   000177 710000 4                  TRA     s:10086+3

     2152    10085    3                 KS_PSEUDO.PSEUDO(I) = KS_PSEUDO.PSEUDO(I+1);

  10085  4 000167   200012 236100                    LDQ     I,,AUTO
         4 000170   000034 402007                    MPY     28,DL
         4 000171   000006 100406                    MLR     fill='000'O
         4 000172   000035 000034 2                  ADSC9   KS_PSEUDO+8,Q            cn=0,n=28
         4 000173   000026 000034 2                  ADSC9   KS_PSEUDO+1,Q            cn=0,n=28

     2153    10086    3                 END;  /* DO I */

  10086  4 000174   200012 235100                    LDA     I,,AUTO
         4 000175   000001 035007                    ADLA    1,DL
         4 000176   200012 755100                    STA     I,,AUTO
         4 000177   200012 236100                    LDQ     I,,AUTO
         4 000200   000025 116000 2                  CMPQ    KS_PSEUDO
         4 000201   000167 602000 4                  TNC     s:10085

     2154    10087    2              KS_PSEUDO.PSEUDO# = KS_PSEUDO.PSEUDO# - 1;

  10087  4 000202   000025 235000 2                  LDA     KS_PSEUDO
         4 000203   000001 135007                    SBLA    1,DL
         4 000204   000025 755000 2                  STA     KS_PSEUDO

     2155    10088    2              WRITE_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);

  10088  4 000205   000012 237000 5                  LDAQ    10
         4 000206   005634 757000 2                  STAQ    WRITE_NETCON+2

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:399  
     2156    10089    2              WRITE_NETCON.BUF_ = VECTOR(KS_PSEUDO);

  10089  4 000207   000014 237000 5                  LDAQ    12
         4 000210   005636 757000 2                  STAQ    WRITE_NETCON+4

     2157    10090    2              WRITE_NETCON.BUF_.BOUND = KS_PSEUDO.PSEUDO# * 28 + 4 - 1;

  10090  4 000211   000025 236000 2                  LDQ     KS_PSEUDO
         4 000212   000034 402007                    MPY     28,DL
         4 000213   000003 036007                    ADLQ    3,DL
         4 000214   000020 736000                    QLS     16
         4 000215   005636 676000 2                  ERQ     WRITE_NETCON+4
         4 000216   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000217   005636 656000 2                  ERSQ    WRITE_NETCON+4

     2158    10091    2              CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);

  10091  4 000220   005632 630400 2                  EPPR0   WRITE_NETCON
         4 000221   440001 713400                    CLIMB   alt,write
         4 000222   401400 401760                    pmme    nvectors=4
         4 000223   001241 702000 4                  TSX2    DEL_ERR
         4 000224   001240 710000 4                  TRA     s:10321

     2159    10092    2           CASE(%KS_NODE);

     2160    10093    2              READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  10093  4 000225   000002 237000 5                  LDAQ    2
         4 000226   005616 757000 2                  STAQ    READ_NETCON+2

     2161    10094    2              READ_NETCON.BUF_ = VECTOR(KS_NETWORK);

  10094  4 000227   000004 237000 5                  LDAQ    4
         4 000230   005620 757000 2                  STAQ    READ_NETCON+4

     2162    10095    3              CALL M$READ(READ_NETCON) WHENALTRETURN DO;

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:400  
  10095  4 000231   005614 630400 2                  EPPR0   READ_NETCON
         4 000232   440000 713400                    CLIMB   alt,read
         4 000233   401400 401760                    pmme    nvectors=4
         4 000234   000236 702000 4                  TSX2    s:10096
         4 000235   000250 710000 4                  TRA     s:10100

     2163    10096    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY

  10096  4 000236   000000 470400 xsym               LDP0    B$TCB$
         4 000237   000000 471500                    LDP1    0,,PR0
         4 000240   100102 236100                    LDQ     66,,PR1
         4 000241   377770 376007                    ANQ     131064,DL
         4 000242   001020 116007                    CMPQ    528,DL
         4 000243   001241 601000 4                  TNZ     DEL_ERR

     2164    10097    3                    THEN GOTO DEL_ERR;
     2165    10098    3                 KS_NETWORK = '0'B;

  10098  4 000244   012004 220003                    LDX0    5124,DU
         4 000245   000040 100400                    MLR     fill='000'O
         4 000246   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000247   000601 000010 2                  ADSC9   KS_NETWORK               cn=0,n=*X0

     2166    10099    3                 END;  /* WHENALTRETURN */

     2167    10100    2             READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);

  10100  4 000250   000032 237000 5                  LDAQ    26
         4 000251   005616 757000 2                  STAQ    READ_NETCON+2

     2168    10101    2             READ_NETCON.BUF_ = VECTOR(KS_RFEP);

  10101  4 000252   000034 237000 5                  LDAQ    28
         4 000253   005620 757000 2                  STAQ    READ_NETCON+4

     2169    10102    3             CALL M$READ(READ_NETCON) WHENALTRETURN DO;

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:401  
  10102  4 000254   005614 630400 2                  EPPR0   READ_NETCON
         4 000255   440000 713400                    CLIMB   alt,read
         4 000256   401400 401760                    pmme    nvectors=4
         4 000257   000261 702000 4                  TSX2    s:10103
         4 000260   000265 710000 4                  TRA     s:10105

     2170    10103    3                KS_RFEP = KS_NETWORK;

  10103  4 000261   012004 220003                    LDX0    5124,DU
         4 000262   000040 100440                    MLR     fill='000'O
         4 000263   000601 000010 2                  ADSC9   KS_NETWORK               cn=0,n=*X0
         4 000264   003204 000010 2                  ADSC9   KS_RFEP                  cn=0,n=*X0

     2171    10104    3             END;

     2172    10105    3              IF KS_NETWORK.NODE# = 0 THEN DO;

  10105  4 000265   000601 235000 2                  LDA     KS_NETWORK
         4 000266   000274 601000 4                  TNZ     s:10109

     2173    10106    3                 CALL KSE$ERRMSG(%E$KS_NO_NETWORK);

  10106  4 000267   000037 630400 5                  EPPR0   31
         4 000270   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000271   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000272   000000 011000                    NOP     0

     2174    10107    3                 END;  /* IF NODE# = 0 */

  10107  4 000273   001240 710000 4                  TRA     s:10321

     2175    10108    3              ELSE DO;

     2176    10109    3                 FOUND = '0'B;

  10109  4 000274   200022 450100                    STZ     FOUND,,AUTO

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:402  
     2177    10110    3                 CALL CHARBIN(NODE,OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  10110  4 000275   200003 470500                    LDP0    @TOP$,,AUTO
         4 000276   000000 471500                    LDP1    0,,PR0
         4 000277   100003 473500                    LDP3    3,,PR1
         4 000300   300004 236100                    LDQ     4,,PR3
         4 000301   000033 772000                    QRL     27
         4 000302   000000 620006                    EAX0    0,QL
         4 000303   000100 305540                    DTB
         4 000304   300004 230010                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
         4 000305   200024 000010                    NDSC9   FOUND+2,,AUTO            cn=0,s=lsgnf,sf=0,n=8
         4 000306   200025 236100                    LDQ     FOUND+3,,AUTO
         4 000307   200010 756100                    STQ     NODE,,AUTO

     2178    10111    4      NDSRCH:    DO I = 0 TO KS_NETWORK.NODE#;

  10111  4 000310   200012 450100       NDSRCH       STZ     I,,AUTO
         4 000311   000330 710000 4                  TRA     s:10118+2

     2179    10112    5                    IF I = NODE THEN DO;

  10112  4 000312   200012 236100                    LDQ     I,,AUTO
         4 000313   200010 116100                    CMPQ    NODE,,AUTO
         4 000314   000326 601000 4                  TNZ     s:10118

     2180    10113    5                       NODENAME = KS_NETWORK.NODE.NODE(I);

  10113  4 000315   000024 402007                    MPY     20,DL
         4 000316   040100 100406                    MLR     fill='040'O
         4 000317   000603 000010 2                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000320   200020 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8

     2181    10114    5                       FOUND = '1'B;

  10114  4 000321   400000 236003                    LDQ     -131072,DU
         4 000322   200022 756100                    STQ     FOUND,,AUTO

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:403  
     2182    10115    5                       DELINDX = I;

  10115  4 000323   200012 235100                    LDA     I,,AUTO
         4 000324   200015 755100                    STA     DELINDX,,AUTO

     2183    10116    5                       EXIT NDSRCH;

  10116  4 000325   000333 710000 4                  TRA     s:10119

     2184    10117    5                       END;   /* IF */
     2185    10118    4                    END;  /* DO I */

  10118  4 000326   000001 036007                    ADLQ    1,DL
         4 000327   200012 756100                    STQ     I,,AUTO
         4 000330   000601 236000 2                  LDQ     KS_NETWORK
         4 000331   200012 116100                    CMPQ    I,,AUTO
         4 000332   000312 603000 4                  TRC     s:10112

     2186    10119    4                 IF NOT FOUND THEN DO;

  10119  4 000333   200022 234100                    SZN     FOUND,,AUTO
         4 000334   000352 604000 4                  TMI     s:10128

     2187    10120    4                    KS_SUB_BUF_1.COUNT = OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;

  10120  4 000335   200003 470500                    LDP0    @TOP$,,AUTO
         4 000336   000000 471500                    LDP1    0,,PR0
         4 000337   100003 473500                    LDP3    3,,PR1
         4 000340   300004 236100                    LDQ     4,,PR3
         4 000341   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2188    10121    4                    KS_SUB_BUF_1.TEXT = NODENAME;

  10121  4 000342   040000 100500                    MLR     fill='040'O
         4 000343   200020 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000344   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:404  
     2189    10122    4                    CALL KSE$ERRMSG(%E$KS_UNDEFNODE,VECTOR(KS_SUB_BUF_1));

  10122  4 000345   000041 630400 5                  EPPR0   33
         4 000346   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000347   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000350   000000 011000                    NOP     0

     2190    10123                         /*E* ERROR: KSN-E$KS_UNDEFNODE-0
     2191    10124                              MESSAGE: Node %U1 has not been defined.
     2192    10125                              DESCRIPTION: SEE MESSAGE */
     2193    10126    4                    RETURN;

  10126  4 000351   000000 702200 xent               TSX2  ! X66_ARET

     2194    10127    4                    END;  /* IF NOT FOUND */
     2195    10128    3                 KS_NETWORK.NODE.TYPE (DELINDX) = 0;

  10128  4 000352   200015 236100                    LDQ     DELINDX,,AUTO
         4 000353   000005 402007                    MPY     5,DL
         4 000354   000602 450006 2                  STZ     KS_NETWORK+1,QL

     2196    10129    3                 KS_NETWORK.NODE.NODE (DELINDX) = ' ';

  10129  4 000355   000000 620006                    EAX0    0,QL
         4 000356   000000 621006                    EAX1    0,QL
         4 000357   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000360   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000361   000603 755010 2                  STA     KS_NETWORK+2,X0
         4 000362   000604 756011 2                  STQ     KS_NETWORK+3,X1

     2197    10130    3                 WRITE_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  10130  4 000363   000002 237000 5                  LDAQ    2
         4 000364   005634 757000 2                  STAQ    WRITE_NETCON+2

     2198    10131    3                 WRITE_NETCON.BUF_ = VECTOR(KS_NETWORK);

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:405  
  10131  4 000365   000004 237000 5                  LDAQ    4
         4 000366   005636 757000 2                  STAQ    WRITE_NETCON+4

     2199    10132    3                WRITE_NETCON.BUF_.BOUND = SIZEV(KS_NETWORK) - SIZEC(KS_NETWORK.NODE) +
             10132                          KS_NETWORK.NODE# * SIZEC(KS_NETWORK.NODE(0));

  10132  4 000367   000601 236000 2                  LDQ     KS_NETWORK
         4 000370   000024 402007                    MPY     20,DL
         4 000371   000003 036007                    ADLQ    3,DL
         4 000372   000020 736000                    QLS     16
         4 000373   005636 676000 2                  ERQ     WRITE_NETCON+4
         4 000374   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000375   005636 656000 2                  ERSQ    WRITE_NETCON+4

     2200    10133    3                 CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);

  10133  4 000376   005632 630400 2                  EPPR0   WRITE_NETCON
         4 000377   440001 713400                    CLIMB   alt,write
         4 000400   401400 401760                    pmme    nvectors=4
         4 000401   001241 702000 4                  TSX2    DEL_ERR

     2201    10134    3                KS_RFEP.NODE.TYPE (DELINDX) = 0;

  10134  4 000402   200015 236100                    LDQ     DELINDX,,AUTO
         4 000403   000005 402007                    MPY     5,DL
         4 000404   003205 450006 2                  STZ     KS_RFEP+1,QL

     2202    10135    3                WRITE_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);

  10135  4 000405   000032 237000 5                  LDAQ    26
         4 000406   005634 757000 2                  STAQ    WRITE_NETCON+2

     2203    10136    3                WRITE_NETCON.BUF_ = VECTOR(KS_RFEP);

  10136  4 000407   000034 237000 5                  LDAQ    28
         4 000410   005636 757000 2                  STAQ    WRITE_NETCON+4

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:406  
     2204    10137    3                WRITE_NETCON.BUF_.BOUND = SIZEV(KS_RFEP) - SIZEC(KS_RFEP.NODE) +
             10137                         KS_RFEP.NODE# * SIZEC(KS_RFEP.NODE(0));

  10137  4 000411   003204 236000 2                  LDQ     KS_RFEP
         4 000412   000024 402007                    MPY     20,DL
         4 000413   000003 036007                    ADLQ    3,DL
         4 000414   000020 736000                    QLS     16
         4 000415   005636 676000 2                  ERQ     WRITE_NETCON+4
         4 000416   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000417   005636 656000 2                  ERSQ    WRITE_NETCON+4

     2205    10138    3                CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);

  10138  4 000420   005632 630400 2                  EPPR0   WRITE_NETCON
         4 000421   440001 713400                    CLIMB   alt,write
         4 000422   401400 401760                    pmme    nvectors=4
         4 000423   001241 702000 4                  TSX2    DEL_ERR

     2206    10139        /*
     2207    10140                delete all of the configuration records (if any) associated
     2208    10141                with this node.  However, if the node is 0 and the channel
     2209    10142                is 0 then this key belongs to SUPER and we should leave it
     2210    10143                alone.
     2211    10144        */
     2212    10145    3                 IF NODE ~= 0 THEN

  10145  4 000424   200010 235100                    LDA     NODE,,AUTO
         4 000425   000477 600000 4                  TZE     s:10169

     2213    10146    4                    DO;   /* dont delete configs if node = 0 */

     2214    10147    4                 KS_CONFIG_KEY.NODE = NODE;

  10147  4 000426   200010 236100                    LDQ     NODE,,AUTO
         4 000427   000011 736000                    QLS     9
         4 000430   000574 552010 2                  STBQ    KS_CONFIG_KEY,'10'O

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:407  
     2215    10148    4                 KS_CONFIG_KEY.TERMID = '0'B;

  10148  4 000431   000000 100400                    MLR     fill='000'O
         4 000432   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000433   000574 600020 2                  ADSC9   KS_CONFIG_KEY            cn=3,n=16

     2216    10149                         /* delete config records */
     2217    10150                         /* change prompt if same as deleted node */
     2218    10151
     2219    10152    4                    IF NODE = KS_NODE THEN

  10152  4 000434   200010 236100                    LDQ     NODE,,AUTO
         4 000435   000453 604000 4                  TMI     s:10159
         4 000436   000000 116000 xsym               CMPQ    KS_NODE
         4 000437   000453 601000 4                  TNZ     s:10159

     2220    10153    5                       DO;

     2221    10154    5                       KS_NODE = 0;

  10154  4 000440   000000 450000 xsym               STZ     KS_NODE

     2222    10155    5                       KS_NODENAME = KS_NETWORK.NODE.NODE(0);

  10155  4 000441   040000 100400                    MLR     fill='040'O
         4 000442   000603 000010 2                  ADSC9   KS_NETWORK+2             cn=0,n=8
         4 000443   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8

     2223    10156    5                       KS_NODENAME_SV = ' ';

  10156  4 000444   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000445   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000446   000000 755000 xsym               STA     KS_NODENAME_SV
         4 000447   000001 756000 xsym               STQ     KS_NODENAME_SV+1

     2224    10157    5                       PROMPT.NODENAME = 'HOST';

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:408  
  10157  4 000450   040000 100400                    MLR     fill='040'O
         4 000451   000004 000004 1                  ADSC9   HEX_CHARS+4              cn=0,n=4
         4 000452   000000 000010 xsym               ADSC9   PROMPT                   cn=0,n=8

     2225    10158    5                       END;

     2226    10159    4                    KS_CONFIG_KEY.TERMID.TERM.TERM_NAME = ' ';

  10159  4 000453   040000 100400                    MLR     fill='040'O
         4 000454   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000455   000576 600010 2                  ADSC9   KS_CONFIG_KEY+2          cn=3,n=8

     2227    10160    4                    KS_CONFIG_KEY.NODE = NODE;

  10160  4 000456   200010 236100                    LDQ     NODE,,AUTO
         4 000457   000011 736000                    QLS     9
         4 000460   000574 552010 2                  STBQ    KS_CONFIG_KEY,'10'O

     2228    10161    4                    DELETE_NETCON.KEY_ = VECTOR (KS_CONFIG_KEY);

  10161  4 000461   000044 237000 5                  LDAQ    36
         4 000462   005650 757000 2                  STAQ    DELETE_NETCON+2

     2229    10162    4                    KS_CONFIG_LKEY.NODE = NODE;

  10162  4 000463   200010 236100                    LDQ     NODE,,AUTO
         4 000464   000011 736000                    QLS     9
         4 000465   000014 552010 2                  STBQ    KS_CONFIG_LKEY,'10'O

     2230    10163    4                    KS_CONFIG_LKEY.TERMID.TTYP = BITBIN('777'O);

  10163  4 000466   000777 236007                    LDQ     511,DL
         4 000467   000014 552004 2                  STBQ    KS_CONFIG_LKEY,'04'O

     2231    10164    4                    KS_CONFIG_LKEY.TERMID.LEV = BITBIN('777'O);

  10164  4 000470   777000 236003                    LDQ     -512,DU
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:409  
         4 000471   000015 552040 2                  STBQ    KS_CONFIG_LKEY+1,'40'O

     2232    10165    4                    DELETE_NETCON.LKEY_ = VECTOR (KS_CONFIG_LKEY);

  10165  4 000472   000046 237000 5                  LDAQ    38
         4 000473   005652 757000 2                  STAQ    DELETE_NETCON+4

     2233    10166    4                    CALL M$DELREC(DELETE_NETCON);

  10166  4 000474   005646 630400 2                  EPPR0   DELETE_NETCON
         4 000475   040002 713400                    CLIMB   16386
         4 000476   401400 401760                    pmme    nvectors=4

     2234    10167    4                       END;  /* dont delete config records if node=0 */

     2235    10168                         /* delete default records */
     2236    10169    3                    KS_DFLT_KEY.NODE = NODE;

  10169  4 000477   200010 236100                    LDQ     NODE,,AUTO
         4 000500   000011 736000                    QLS     9
         4 000501   000006 552010 2                  STBQ    KS_DFLT_KEY,'10'O

     2237    10170    3                    KS_DFLT_KEY.HNDLR = ' ';

  10170  4 000502   040000 100400                    MLR     fill='040'O
         4 000503   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000504   000006 600010 2                  ADSC9   KS_DFLT_KEY              cn=3,n=8

     2238    10171    3                    KS_DFLT_LKEY = KS_DFLT_KEY;

  10171  4 000505   000000 100400                    MLR     fill='000'O
         4 000506   000006 000013 2                  ADSC9   KS_DFLT_KEY              cn=0,n=11
         4 000507   000011 000013 2                  ADSC9   KS_DFLT_LKEY             cn=0,n=11

     2239    10172    3                    KS_DFLT_LKEY.HNDLR = '~~~~~';

  10172  4 000510   040000 100400                    MLR     fill='040'O
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:410  
         4 000511   000005 000005 1                  ADSC9   HEX_CHARS+5              cn=0,n=5
         4 000512   000011 600010 2                  ADSC9   KS_DFLT_LKEY             cn=3,n=8

     2240    10173    3                    DELETE_NETCON.KEY_ = VECTOR(KS_DFLT_KEY);

  10173  4 000513   000050 237000 5                  LDAQ    40
         4 000514   005650 757000 2                  STAQ    DELETE_NETCON+2

     2241    10174    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_DFLT_LKEY);

  10174  4 000515   000052 237000 5                  LDAQ    42
         4 000516   005652 757000 2                  STAQ    DELETE_NETCON+4

     2242    10175    3                    CALL M$DELREC(DELETE_NETCON);

  10175  4 000517   005646 630400 2                  EPPR0   DELETE_NETCON
         4 000520   040002 713400                    CLIMB   16386
         4 000521   401400 401760                    pmme    nvectors=4

     2243    10176                         /* delete handler records  */
     2244    10177    3                    KS_HNDLR_KEY.NODE = NODE;

  10177  4 000522   200010 236100                    LDQ     NODE,,AUTO
         4 000523   000011 736000                    QLS     9
         4 000524   000000 552010 2                  STBQ    KS_HNDLR_KEY,'10'O

     2245    10178    3                    KS_HNDLR_KEY.HNDLR = ' ';

  10178  4 000525   040000 100400                    MLR     fill='040'O
         4 000526   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000527   000000 600010 2                  ADSC9   KS_HNDLR_KEY             cn=3,n=8

     2246    10179    3                    KS_HNDLR_LKEY.HNDLR = '~~~~~~~';

  10179  4 000530   040000 100400                    MLR     fill='040'O
         4 000531   000007 000007 1                  ADSC9   HEX_CHARS+7              cn=0,n=7
         4 000532   000003 600010 2                  ADSC9   KS_HNDLR_LKEY            cn=3,n=8
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:411  

     2247    10180    3                    KS_HNDLR_LKEY.NODE = NODE;

  10180  4 000533   200010 236100                    LDQ     NODE,,AUTO
         4 000534   000011 736000                    QLS     9
         4 000535   000003 552010 2                  STBQ    KS_HNDLR_LKEY,'10'O

     2248    10181    3                    DELETE_NETCON.KEY_ = VECTOR(KS_HNDLR_KEY);

  10181  4 000536   000054 237000 5                  LDAQ    44
         4 000537   005650 757000 2                  STAQ    DELETE_NETCON+2

     2249    10182    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_HNDLR_LKEY);

  10182  4 000540   000056 237000 5                  LDAQ    46
         4 000541   005652 757000 2                  STAQ    DELETE_NETCON+4

     2250    10183    3                    CALL M$DELREC (DELETE_NETCON);

  10183  4 000542   005646 630400 2                  EPPR0   DELETE_NETCON
         4 000543   040002 713400                    CLIMB   16386
         4 000544   401400 401760                    pmme    nvectors=4

     2251    10184                         /* delete boot record */
     2252    10185    3                    KS_FEPBOOT_KEY.NODE = NODE;

  10185  4 000545   200010 236100                    LDQ     NODE,,AUTO
         4 000546   000011 736000                    QLS     9
         4 000547   000021 552010 2                  STBQ    KS_FEPBOOT_KEY,'10'O

     2253    10186    3                    DELETE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  10186  4 000550   000060 237000 5                  LDAQ    48
         4 000551   005650 757000 2                  STAQ    DELETE_NETCON+2

     2254    10187    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_FEPBOOT_KEY);

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:412  
  10187  4 000552   000060 237000 5                  LDAQ    48
         4 000553   005652 757000 2                  STAQ    DELETE_NETCON+4

     2255    10188    3                    CALL M$DELREC (DELETE_NETCON);

  10188  4 000554   005646 630400 2                  EPPR0   DELETE_NETCON
         4 000555   040002 713400                    CLIMB   16386
         4 000556   401400 401760                    pmme    nvectors=4

     2256    10189                         /* delete fep hndlr record */
     2257    10190    3                    KS_FEPHNDLR_KEY.NODE = NODE;

  10190  4 000557   200010 236100                    LDQ     NODE,,AUTO
         4 000560   000011 736000                    QLS     9
         4 000561   000022 552010 2                  STBQ    KS_FEPHNDLR_KEY,'10'O

     2258    10191    3                    DELETE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);

  10191  4 000562   000062 237000 5                  LDAQ    50
         4 000563   005650 757000 2                  STAQ    DELETE_NETCON+2

     2259    10192    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_FEPHNDLR_KEY);

  10192  4 000564   000062 237000 5                  LDAQ    50
         4 000565   005652 757000 2                  STAQ    DELETE_NETCON+4

     2260    10193    3                    CALL M$DELREC(DELETE_NETCON);

  10193  4 000566   005646 630400 2                  EPPR0   DELETE_NETCON
         4 000567   040002 713400                    CLIMB   16386
         4 000570   401400 401760                    pmme    nvectors=4

     2261    10194
     2262    10195    3                    KS_FEPCTL_KEY.NODE = NODE;

  10195  4 000571   200010 236100                    LDQ     NODE,,AUTO
         4 000572   000011 736000                    QLS     9
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:413  
         4 000573   000023 552010 2                  STBQ    KS_FEPCTL_KEY,'10'O

     2263    10196    3                    DELETE_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);

  10196  4 000574   000064 237000 5                  LDAQ    52
         4 000575   005650 757000 2                  STAQ    DELETE_NETCON+2

     2264    10197    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_FEPCTL_KEY);

  10197  4 000576   000064 237000 5                  LDAQ    52
         4 000577   005652 757000 2                  STAQ    DELETE_NETCON+4

     2265    10198    3                    CALL M$DELREC(DELETE_NETCON);

  10198  4 000600   005646 630400 2                  EPPR0   DELETE_NETCON
         4 000601   040002 713400                    CLIMB   16386
         4 000602   401400 401760                    pmme    nvectors=4

     2266    10199    3                    KS_LINK_KEY.NODE = NODE;

  10199  4 000603   200010 236100                    LDQ     NODE,,AUTO
         4 000604   000011 736000                    QLS     9
         4 000605   000024 552010 2                  STBQ    KS_LINK_KEY,'10'O

     2267    10200    3                    DELETE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  10200  4 000606   000066 237000 5                  LDAQ    54
         4 000607   005650 757000 2                  STAQ    DELETE_NETCON+2

     2268    10201    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_LINK_KEY);

  10201  4 000610   000066 237000 5                  LDAQ    54
         4 000611   005652 757000 2                  STAQ    DELETE_NETCON+4

     2269    10202    3                    CALL M$DELREC(DELETE_NETCON);

  10202  4 000612   005646 630400 2                  EPPR0   DELETE_NETCON
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:414  
         4 000613   040002 713400                    CLIMB   16386
         4 000614   401400 401760                    pmme    nvectors=4

     2270    10203    3                    KS_PSEUDO_KEY.NODE = NODE;

  10203  4 000615   200010 236100                    LDQ     NODE,,AUTO
         4 000616   000011 736000                    QLS     9
         4 000617   000573 552010 2                  STBQ    KS_PSEUDO_KEY,'10'O

     2271    10204    3                    DELETE_NETCON.KEY_ = VECTOR(KS_PSEUDO_KEY);

  10204  4 000620   000012 237000 5                  LDAQ    10
         4 000621   005650 757000 2                  STAQ    DELETE_NETCON+2

     2272    10205    3                    DELETE_NETCON.LKEY_ = VECTOR(KS_PSEUDO_KEY);

  10205  4 000622   000012 237000 5                  LDAQ    10
         4 000623   005652 757000 2                  STAQ    DELETE_NETCON+4

     2273    10206    3                    CALL M$DELREC(DELETE_NETCON);

  10206  4 000624   005646 630400 2                  EPPR0   DELETE_NETCON
         4 000625   040002 713400                    CLIMB   16386
         4 000626   401400 401760                    pmme    nvectors=4

     2274    10207    3   UPDATE.CODE = %IGA_UPDATE;

  10207  4 000627   005605 470400 2                  LDP0    HDR$
         4 000630   026000 236003                    LDQ     11264,DU
         4 000631   000000 552140                    STBQ    0,'40'O,PR0

     2275    10208    4   CALL KSR$WR_HLPCG(VECTOR(UPDATE)) WHENALTRETURN DO; END;

  10208  4 000632   000070 235000 5                  LDA     56
         4 000633   005605 236000 2                  LDQ     HDR$
         4 000634   200024 757100                    STAQ    FOUND+2,,AUTO
         4 000635   200024 631500                    EPPR1   FOUND+2,,AUTO
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:415  
         4 000636   200026 451500                    STP1    FOUND+4,,AUTO
         4 000637   200026 630500                    EPPR0   FOUND+4,,AUTO
         4 000640   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000641   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 000642   000644 702000 4                  TSX2    s:10210
         4 000643   000644 710000 4                  TRA     s:10210

     2276    10209
     2277    10210    3                 END;                      /* ELSE                               */

  10210  4 000644   001240 710000 4                  TRA     s:10321

     2278    10211        %EJECT;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:416  
     2279    10212    2   CASE (%KS_LINKS);

     2280    10213    3              IF KS_NODENAME = 'HOST' THEN DO;

  10213  4 000645   040000 106400                    CMPC    fill='040'O
         4 000646   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 000647   000004 000004 1                  ADSC9   HEX_CHARS+4              cn=0,n=4
         4 000650   000656 601000 4                  TNZ     s:10217

     2281    10214    3                 CALL KSE$ERRMSG(%E$KS_NONODE);

  10214  4 000651   000000 630400 5                  EPPR0   0
         4 000652   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000653   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000654   000000 011000                    NOP     0

     2282    10215    3                 RETURN;

  10215  4 000655   000000 702200 xent               TSX2  ! X66_ARET

     2283    10216    3                 END;  /* IF KS_NODENAME = 'HOST' */
     2284    10217    2           CALL KSU$READ_NETCON(VECTOR(KS_NETWORK_KEY),VECTOR(KS_NETWORK))

  10217  4 000656   000006 630400 5                  EPPR0   6
         4 000657   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000660   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 000661   001241 702000 4                  TSX2    DEL_ERR

     2285    10218    2              ALTRET(DEL_ERR);
     2286    10219    2           IF KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_HOST OR

  10219  4 000662   000000 236000 xsym               LDQ     KS_NODE
         4 000663   000005 402007                    MPY     5,DL
         4 000664   000602 235006 2                  LDA     KS_NETWORK+1,QL
         4 000665   000001 115007                    CMPA    1,DL
         4 000666   000671 600000 4                  TZE     s:10222
         4 000667   000003 115007                    CMPA    3,DL
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:417  
         4 000670   000676 601000 4                  TNZ     s:10226

     2287    10220    2              KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_ME THEN
     2288    10221    3              DO;

     2289    10222    3                 CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);

  10222  4 000671   000011 630400 5                  EPPR0   9
         4 000672   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000673   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000674   000000 011000                    NOP     0

     2290    10223    3                 RETURN;

  10223  4 000675   000000 702200 xent               TSX2  ! X66_ARET

     2291    10224    3              END;
     2292    10225
     2293    10226    2         KS_LINK_KEY.NODE = KS_NODE;

  10226  4 000676   000000 236000 xsym               LDQ     KS_NODE
         4 000677   000011 736000                    QLS     9
         4 000700   000024 552010 2                  STBQ    KS_LINK_KEY,'10'O

     2294    10227
     2295    10228    2         IF OUT$BLK.NSUBLKS = 0  THEN        /*DELETE LINKS ALL*/

  10228  4 000701   200003 470500                    LDP0    @TOP$,,AUTO
         4 000702   000000 471500                    LDP1    0,,PR0
         4 000703   100001 220100                    LDX0    1,,PR1
         4 000704   000710 601000 4                  TNZ     s:10232

     2296    10229    2            KS_LINK.LINKS# = 0;

  10229  4 000705   000000 473400 xsym               LDP3    KS_MSGBUF$
         4 000706   300000 450100                    STZ     0,,PR3
         4 000707   001050 710000 4                  TRA     s:10262
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:418  

     2297    10230    2         ELSE
     2298    10231    3            DO;

     2299    10232    3               READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  10232  4 000710   000072 237000 5                  LDAQ    58
         4 000711   005620 757000 2                  STAQ    READ_NETCON+4

     2300    10233    3               READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  10233  4 000712   000066 237000 5                  LDAQ    54
         4 000713   005616 757000 2                  STAQ    READ_NETCON+2

     2301    10234    3               CALL M$READ(READ_NETCON) WHENALTRETURN

  10234  4 000714   005614 630400 2                  EPPR0   READ_NETCON
         4 000715   440000 713400                    CLIMB   alt,read
         4 000716   401400 401760                    pmme    nvectors=4
         4 000717   000721 702000 4                  TSX2    s:10238
         4 000720   000721 710000 4                  TRA     s:10238

     2302    10235    4                  DO;

     2303    10236                    /*N* do error message which indicates to links defined for this node */
     2304    10237    4                  END;

     2305    10238    4               DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  10238  4 000721   200012 450100                    STZ     I,,AUTO
         4 000722   001041 710000 4                  TRA     s:10260+3

     2306    10239    4                  IN$ = OUT$BLK.SUBLK$(I);

  10239  4 000723   200003 470500                    LDP0    @TOP$,,AUTO
         4 000724   000000 471500                    LDP1    0,,PR0
         4 000725   200012 720100                    LXL0    I,,AUTO
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:419  
         4 000726   100003 236110                    LDQ     3,X0,PR1
         4 000727   200007 756100                    STQ     IN$,,AUTO

     2307    10240    4                  TEMP_LINK = '0'B;

  10240  4 000730   000000 221003                    LDX1    0,DU
         4 000731   005606 741000 2                  STX1    TEMP_LINK

     2308    10241    4                  OFFSET = 4 - IN$->OUT$SYM.COUNT;

  10241  4 000732   200007 471500                    LDP1    IN$,,AUTO
         4 000733   100004 236100                    LDQ     4,,PR1
         4 000734   000033 772000                    QRL     27
         4 000735   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 000736   000005 036007                    ADLQ    5,DL
         4 000737   200005 756100                    STQ     OFFSET,,AUTO

     2309    10242    5                  DO J = OFFSET TO 3;

  10242  4 000740   200013 756100                    STQ     J,,AUTO
         4 000741   000764 710000 4                  TRA     s:10245+3

     2310    10243    5                     CALL INDEX (TEMP,SUBSTR(IN$->OUT$SYM.TEXT,J-OFFSET,1),HEX_CHARS);

  10243  4 000742   200007 470500                    LDP0    IN$,,AUTO
         4 000743   000004 236100                    LDQ     4,,PR0
         4 000744   000033 772000                    QRL     27
         4 000745   000000 620006                    EAX0    0,QL
         4 000746   200013 236100                    LDQ     J,,AUTO
         4 000747   200005 136100                    SBLQ    OFFSET,,AUTO
         4 000750   000106 124400                    SCM     mask='000'O
         4 000751   000000 000020 1                  ADSC9   HEX_CHARS                cn=0,n=16
         4 000752   000004 200001                    ADSC9   4,Q,PR0                  cn=1,n=1
         4 000753   200006 000100                    ARG     TEMP,,AUTO

     2311    10244    5                     HEX$(J)->HEX = TEMP;

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:420  
  10244  4 000754   200013 721100                    LXL1    J,,AUTO
         4 000755   005607 471411 2                  LDP1    HEX$,X1
         4 000756   003100 061500                    CSR     bolr='003'O
         4 000757   200006 000044                    BDSC    TEMP,,AUTO               by=0,bit=0,n=36
         4 000760   100000 000004                    BDSC    0,,PR1                   by=0,bit=0,n=4

     2312    10245    5                  END;

  10245  4 000761   200013 235100                    LDA     J,,AUTO
         4 000762   000001 035007                    ADLA    1,DL
         4 000763   200013 755100                    STA     J,,AUTO
         4 000764   200013 235100                    LDA     J,,AUTO
         4 000765   000004 115007                    CMPA    4,DL
         4 000766   000742 602000 4                  TNC     s:10243

     2313    10246
     2314    10247    4   FIND_LINK_LOOP:
     2315    10248    5                  DO J = 0 TO KS_LINK.LINKS# - 1;

  10248  4 000767   200013 450100       FIND_LINK_L* STZ     J,,AUTO
         4 000770   001003 710000 4                  TRA     s:10251+3

     2316    10249    5                     IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN

  10249  4 000771   200013 235100                    LDA     J,,AUTO
         4 000772   000001 735000                    ALS     1
         4 000773   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000774   000105 106400                    CMPC    fill='000'O
         4 000775   005606 000002 2                  ADSC9   TEMP_LINK                cn=0,n=2
         4 000776   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
         4 000777   001007 600000 4                  TZE     s:10253

     2317    10250    5                        EXIT FIND_LINK_LOOP;
     2318    10251    5                  END;

  10251  4 001000   200013 236100                    LDQ     J,,AUTO
         4 001001   000001 036007                    ADLQ    1,DL
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:421  
         4 001002   200013 756100                    STQ     J,,AUTO
         4 001003   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001004   200013 236100                    LDQ     J,,AUTO
         4 001005   000000 116100                    CMPQ    0,,PR0
         4 001006   000771 602000 4                  TNC     s:10249

     2319    10252
     2320    10253    4                  IF J < KS_LINK.LINKS# THEN

  10253  4 001007   200013 236100                    LDQ     J,,AUTO
         4 001010   000000 116100                    CMPQ    0,,PR0
         4 001011   001036 603000 4                  TRC     s:10260

     2321    10254    5                     DO;

     2322    10255    6                        DO K = J TO KS_LINK.LINKS# - 2;

  10255  4 001012   200014 756100                    STQ     K,,AUTO
         4 001013   001025 710000 4                  TRA     s:10257+3

     2323    10256    6                           KS_LINK.CHANNEL(K) = KS_LINK.CHANNEL(K+1);

  10256  4 001014   200014 235100                    LDA     K,,AUTO
         4 001015   000001 735000                    ALS     1
         4 001016   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001017   000105 100505                    MLR     fill='000'O
         4 001020   000001 400002                    ADSC9   1,A,PR0                  cn=2,n=2
         4 001021   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2

     2324    10257    6                        END;

  10257  4 001022   200014 236100                    LDQ     K,,AUTO
         4 001023   000001 036007                    ADLQ    1,DL
         4 001024   200014 756100                    STQ     K,,AUTO
         4 001025   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001026   000000 236100                    LDQ     0,,PR0
         4 001027   000002 136007                    SBLQ    2,DL
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:422  
         4 001030   001033 604000 4                  TMI     s:10258
         4 001031   200014 116100                    CMPQ    K,,AUTO
         4 001032   001014 603000 4                  TRC     s:10256

     2325    10258    5                        KS_LINK.LINKS# = KS_LINK.LINKS# - 1;

  10258  4 001033   000000 235100                    LDA     0,,PR0
         4 001034   000001 135007                    SBLA    1,DL
         4 001035   000000 755100                    STA     0,,PR0

     2326    10259    5                     END;

     2327    10260    4               END;

  10260  4 001036   200012 235100                    LDA     I,,AUTO
         4 001037   000001 035007                    ADLA    1,DL
         4 001040   200012 755100                    STA     I,,AUTO
         4 001041   200003 470500                    LDP0    @TOP$,,AUTO
         4 001042   000000 471500                    LDP1    0,,PR0
         4 001043   100001 236100                    LDQ     1,,PR1
         4 001044   000022 772000                    QRL     18
         4 001045   200012 116100                    CMPQ    I,,AUTO
         4 001046   001050 600000 4                  TZE     s:10262
         4 001047   000723 603000 4                  TRC     s:10239

     2328    10261    3            END;

     2329    10262    2     WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  10262  4 001050   000072 237000 5                  LDAQ    58
         4 001051   005636 757000 2                  STAQ    WRITE_NETCON+4

     2330    10263    2     WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  10263  4 001052   000066 237000 5                  LDAQ    54
         4 001053   005634 757000 2                  STAQ    WRITE_NETCON+2

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:423  
     2331    10264    2     IF KS_LINK.LINKS# <= 0 THEN

  10264  4 001054   000000 471400 xsym               LDP1    KS_MSGBUF$
         4 001055   100000 235100                    LDA     0,,PR1
         4 001056   001064 601000 4                  TNZ     s:10267

     2332    10265    2        WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) - 1;

  10265  4 001057   005636 236000 2                  LDQ     WRITE_NETCON+4
         4 001060   177777 376007                    ANQ     65535,DL
         4 001061   600000 276007                    ORQ     -65536,DL
         4 001062   005636 756000 2                  STQ     WRITE_NETCON+4
         4 001063   001073 710000 4                  TRA     s:10269

     2333    10266    2     ELSE
     2334    10267    2        WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +

  10267  4 001064   100000 236100                    LDQ     0,,PR1
         4 001065   000001 736000                    QLS     1
         4 001066   000003 036007                    ADLQ    3,DL
         4 001067   000020 736000                    QLS     16
         4 001070   005636 676000 2                  ERQ     WRITE_NETCON+4
         4 001071   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001072   005636 656000 2                  ERSQ    WRITE_NETCON+4

     2335    10268    2                                  (SIZEC(KS_LINK.CHANNEL(0)) * KS_LINK.LINKS#) - 1;
     2336    10269    2     CALL M$WRITE(WRITE_NETCON) ALTRET(DEL_ERR);

  10269  4 001073   005632 630400 2                  EPPR0   WRITE_NETCON
         4 001074   440001 713400                    CLIMB   alt,write
         4 001075   401400 401760                    pmme    nvectors=4
         4 001076   001241 702000 4                  TSX2    DEL_ERR
         4 001077   001240 710000 4                  TRA     s:10321

     2337    10270        %EJECT;
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:424  
     2338    10271    2        CASE (%KS_CONFIG);

     2339    10272    3              IF KS_NODENAME = 'HOST' THEN DO;

  10272  4 001100   040000 106400                    CMPC    fill='040'O
         4 001101   000000 000010 xsym               ADSC9   KS_NODENAME              cn=0,n=8
         4 001102   000004 000004 1                  ADSC9   HEX_CHARS+4              cn=0,n=4
         4 001103   001111 601000 4                  TNZ     s:10276

     2340    10273    3                 CALL KSE$ERRMSG(%E$KS_NONODE);

  10273  4 001104   000000 630400 5                  EPPR0   0
         4 001105   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001106   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001107   000000 011000                    NOP     0

     2341    10274    3                 RETURN;

  10274  4 001110   000000 702200 xent               TSX2  ! X66_ARET

     2342    10275    3                 END;  /* IF KS_NODENAME = 'HOST' */
     2343    10276    2           CALL KSU$READ_NETCON(VECTOR(KS_NETWORK_KEY),VECTOR(KS_NETWORK))

  10276  4 001111   000006 630400 5                  EPPR0   6
         4 001112   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001113   000000 701000 xent               TSX1    KSU$READ_NETCON
         4 001114   001241 702000 4                  TSX2    DEL_ERR

     2344    10277    2              ALTRET(DEL_ERR);
     2345    10278    2           IF KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_HOST OR

  10278  4 001115   000000 236000 xsym               LDQ     KS_NODE
         4 001116   000005 402007                    MPY     5,DL
         4 001117   000602 235006 2                  LDA     KS_NETWORK+1,QL
         4 001120   000001 115007                    CMPA    1,DL
         4 001121   001124 600000 4                  TZE     s:10281
         4 001122   000003 115007                    CMPA    3,DL
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:425  
         4 001123   001131 601000 4                  TNZ     s:10285

     2346    10279    2              KS_NETWORK.NODE.TYPE(KS_NODE) = %KS_ME THEN
     2347    10280    3              DO;

     2348    10281    3                 CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);

  10281  4 001124   000011 630400 5                  EPPR0   9
         4 001125   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001126   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001127   000000 011000                    NOP     0

     2349    10282    3                 RETURN;

  10282  4 001130   000000 702200 xent               TSX2  ! X66_ARET

     2350    10283    3              END;
     2351    10284
     2352    10285    2           KS_CONFIG_KEY.NODE = KS_NODE;

  10285  4 001131   000000 236000 xsym               LDQ     KS_NODE
         4 001132   000011 736000                    QLS     9
         4 001133   000574 552010 2                  STBQ    KS_CONFIG_KEY,'10'O

     2353    10286    2           KS_CONFIG_LKEY.NODE = KS_NODE;

  10286  4 001134   000000 236000 xsym               LDQ     KS_NODE
         4 001135   000011 736000                    QLS     9
         4 001136   000014 552010 2                  STBQ    KS_CONFIG_LKEY,'10'O

     2354    10287    2           KS_CONFIG_KEY.TERMID = '0'B;

  10287  4 001137   000000 100400                    MLR     fill='000'O
         4 001140   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 001141   000574 600020 2                  ADSC9   KS_CONFIG_KEY            cn=3,n=16

     2355    10288
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:426  
     2356    10289    2           IF OUT$BLK.NSUBLKS = 0 THEN

  10289  4 001142   200003 470500                    LDP0    @TOP$,,AUTO
         4 001143   000000 471500                    LDP1    0,,PR0
         4 001144   100001 220100                    LDX0    1,,PR1
         4 001145   001153 601000 4                  TNZ     s:10296

     2357    10290    3              DO;

     2358    10291    3                 KS_CONFIG_LKEY.TERMID.TTYP = BITBIN ('777'O);

  10291  4 001146   000777 236007                    LDQ     511,DL
         4 001147   000014 552004 2                  STBQ    KS_CONFIG_LKEY,'04'O

     2359    10292    3                 KS_CONFIG_LKEY.TERMID.LEV  = BITBIN ('777'O);

  10292  4 001150   777000 236003                    LDQ     -512,DU
         4 001151   000015 552040 2                  STBQ    KS_CONFIG_LKEY+1,'40'O

     2360    10293    3              END;

  10293  4 001152   001220 710000 4                  TRA     s:10309

     2361    10294    2           ELSE
     2362    10295    3              DO;

     2363    10296    3                CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),KS_CONFIG_KEY
             10296                          .TERMID) ALTRET(NO_ERR);

  10296  4 001153   100003 473500                    LDP3    3,,PR1
         4 001154   000071 236000 5                  LDQ     57
         4 001155   200025 756100                    STQ     FOUND+3,,AUTO
         4 001156   300003 631500                    EPPR1   3,,PR3
         4 001157   200024 451500                    STP1    FOUND+2,,AUTO
         4 001160   200024 630500                    EPPR0   FOUND+2,,AUTO
         4 001161   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001162   000000 701000 xent               TSX1    KSU$BLD_TERMID
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:427  
         4 001163   001245 702000 4                  TSX2    NO_ERR

     2364    10297    3                 IF OUT$BLK.SUBLK$(0)->OUT$BLK.NSUBLKS = 2 THEN

  10297  4 001164   200003 470500                    LDP0    @TOP$,,AUTO
         4 001165   000000 471500                    LDP1    0,,PR0
         4 001166   100003 473500                    LDP3    3,,PR1
         4 001167   300001 220100                    LDX0    1,,PR3
         4 001170   000002 100003                    CMPX0   2,DU
         4 001171   001215 601000 4                  TNZ     s:10307

     2365    10298    4                    DO;

     2366    10299    4                       CALL KSU$BLD_TERMID(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(1),
             10299                                KS_CONFIG_LKEY.TERMID) ALTRET(NO_ERR);

  10299  4 001172   000074 236000 5                  LDQ     60
         4 001173   200025 756100                    STQ     FOUND+3,,AUTO
         4 001174   300004 631500                    EPPR1   4,,PR3
         4 001175   200024 451500                    STP1    FOUND+2,,AUTO
         4 001176   200024 630500                    EPPR0   FOUND+2,,AUTO
         4 001177   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001200   000000 701000 xent               TSX1    KSU$BLD_TERMID
         4 001201   001245 702000 4                  TSX2    NO_ERR

     2367    10300    4                      CALL KSU$CHK_TRM_RNG(KS_CONFIG_KEY.TERMID,KS_CONFIG_LKEY.TERMID)

  10300  4 001202   000075 630400 5                  EPPR0   61
         4 001203   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001204   000000 701000 xent               TSX1    KSU$CHK_TRM_RNG
         4 001205   001207 702000 4                  TSX2    s:10302
         4 001206   001214 710000 4                  TRA     s:10305

     2368    10301    5                          WHENALTRETURN DO;

     2369    10302    5                             CALL KSE$ERRMSG (%E$KS_BAD_TRM_RANGE);

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:428  
  10302  4 001207   000100 630400 5                  EPPR0   64
         4 001210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001211   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001212   000000 011000                    NOP     0

     2370    10303    5                             GOTO NO_ERR;

  10303  4 001213   001245 710000 4                  TRA     NO_ERR

     2371    10304    5                          END;
     2372    10305    4                    END;

  10305  4 001214   001220 710000 4                  TRA     s:10309

     2373    10306    3                 ELSE
     2374    10307    3                    KS_CONFIG_LKEY.TERMID = KS_CONFIG_KEY.TERMID;

  10307  4 001215   000000 100400                    MLR     fill='000'O
         4 001216   000574 600020 2                  ADSC9   KS_CONFIG_KEY            cn=3,n=16
         4 001217   000014 600020 2                  ADSC9   KS_CONFIG_LKEY           cn=3,n=16

     2375    10308    3              END;

     2376    10309    2        IF KS_CONFIG_KEY.TERMID.TERM.TERM_NAME ~= ' ' THEN

  10309  4 001220   040000 106400                    CMPC    fill='040'O
         4 001221   000576 600010 2                  ADSC9   KS_CONFIG_KEY+2          cn=3,n=8
         4 001222   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001223   001231 600000 4                  TZE     s:10317

     2377    10310    3           DO;

     2378    10311    3              KS_CONFIG_KEY.NODE = 0;

  10311  4 001224   000000 236003                    LDQ     0,DU
         4 001225   000574 552010 2                  STBQ    KS_CONFIG_KEY,'10'O

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:429  
     2379    10312    3              KS_CONFIG_KEY.TERMID.TERM.CHANNEL = '0'B;

  10312  4 001226   000575 552030 2                  STBQ    KS_CONFIG_KEY+1,'30'O

     2380    10313    3              KS_CONFIG_LKEY.NODE = 0;

  10313  4 001227   000014 552010 2                  STBQ    KS_CONFIG_LKEY,'10'O

     2381    10314    3              KS_CONFIG_LKEY.TERMID.TERM.CHANNEL = '0'B;

  10314  4 001230   000015 552030 2                  STBQ    KS_CONFIG_LKEY+1,'30'O

     2382    10315    3           END;

     2383    10316
     2384    10317    2           DELETE_NETCON.KEY_ = VECTOR(KS_CONFIG_KEY);

  10317  4 001231   000044 237000 5                  LDAQ    36
         4 001232   005650 757000 2                  STAQ    DELETE_NETCON+2

     2385    10318    2           DELETE_NETCON.LKEY_ = VECTOR(KS_CONFIG_LKEY);

  10318  4 001233   000046 237000 5                  LDAQ    38
         4 001234   005652 757000 2                  STAQ    DELETE_NETCON+4

     2386    10319    2           CALL M$DELREC(DELETE_NETCON);

  10319  4 001235   005646 630400 2                  EPPR0   DELETE_NETCON
         4 001236   040002 713400                    CLIMB   16386
         4 001237   401400 401760                    pmme    nvectors=4

     2387    10320    2              END;  /* DO CASE(CODE) */

     2388    10321    2        DO WHILE('0'B);

  10321  4 001240   001245 710000 4                  TRA     NO_ERR

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:430  
  10320  4 001241                       DEL_ERR      null
     2389    10322    2   DEL_ERR:;
     2390    10323    2           CALL KSE$ERRMSG(0);

  10323  4 001241   000101 630400 5                  EPPR0   65
         4 001242   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001243   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001244   000000 011000                    NOP     0

     2391    10324    2           END;  /* DO NEVER */

  10322  4 001245                       NO_ERR       null
     2392    10325    1     NO_ERR:;
     2393    10326    1        RETURN;

  10326  4 001245   000000 702200 xent               TSX2  ! X66_ARET
     2394    10327    1   END KSC$DELETE;
     2395    10328        %EOD;

PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:431  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$DELETE.
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:432  

 **** Variables and constants ****

  ****  Section 001 RoData KSC$DELETE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(16)    r     1 HEX_CHARS

  ****  Section 002  Data  KSC$DELETE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  5646-0-0/d STRC(360)   r     1 DELETE_NETCON           5605-0-0/w PTR         r     1 HDR$
  5607-0-0/w PTR         r     1 HEX$(0:3)                574-0-0/c STRC(171)   r     1 KS_CONFIG_KEY
    14-0-0/c STRC(171)   r     1 KS_CONFIG_LKEY             6-0-0/w STRC(99)    r     1 KS_DFLT_KEY
    11-0-0/w STRC(99)    r     1 KS_DFLT_LKEY              21-0-0/w STRC(27)    r     1 KS_FEPBOOT_KEY
    23-0-0/w STRC(27)    r     1 KS_FEPCTL_KEY             22-0-0/w STRC(27)    r     1 KS_FEPHNDLR_KEY
     0-0-0/w STRC(99)    r     1 KS_HNDLR_KEY               3-0-0/w STRC(99)    r     1 KS_HNDLR_LKEY
    24-0-0/w STRC(27)    r     1 KS_LINK_KEY              601-0-0/w STRC(46116) r     1 KS_NETWORK
  3202-0-0/w STRC(18)    r     1 KS_NETWORK_KEY            25-0-0/w STRC(12888) r     1 KS_PSEUDO
   573-0-0/w STRC(27)    r     1 KS_PSEUDO_KEY           3204-0-0/w STRC(46116) r     1 KS_RFEP
  3203-0-0/w STRC(18)    r     1 KS_RFEP_KEY             5614-0-0/d STRC(504)   r     1 READ_NETCON
  5606-0-0/b STRC(18)    r     1 TEMP_LINK               5632-0-0/d STRC(432)   r     1 WRITE_NETCON

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                     15-0-0/w UBIN        r     1 DELINDX
    22-0-0/b BIT         r     1 FOUND                     12-0-0/w UBIN        r     1 I
     7-0-0/w PTR         r     1 IN$                       13-0-0/w UBIN        r     1 J
    14-0-0/w UBIN        r     1 K                         10-0-0/w UBIN        r     1 NODE
    20-0-0/c CHAR(8)     r     1 NODENAME                   5-0-0/w UBIN        r     1 OFFSET
    16-0-0/c CHAR(8)     r     1 PSEUDO_NAME                6-0-0/w UBIN        r     1 TEMP
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:433  
    *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/c CHAR(400)   r     1 KS_MSGBUF
     0-0-0/w PTR         r     1 KS_MSGBUF$                 0-0-0/w SBIN        r     1 KS_NODE
     0-0-0/c CHAR(8)     r     1 KS_NODENAME                0-0-0/c CHAR(8)     r     1 KS_NODENAME_SV
     0-0-0/w STRC(288)   r     1 KS_SUB_BUF_1               0-0-0/w STRC(288)   r     1 KS_SUB_BUF_2
     0-0-0/c STRC(90)    r     1 PROMPT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/b UBIN(4)     r     1 HEX
     0-0-0/w STRC(54)    r     1 KS_LINK                    0-0-0N  NULL        r     1 M$NETCON
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(306)   r     1 UPDATE


   Procedure KSC$DELETE requires 678 words for executable code.
   Procedure KSC$DELETE requires 24 words of local(AUTO) storage.
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:434  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:435  
          MINI XREF LISTING

B$ALT.CODE
      9751**DCL      9751--REDEF    9752--REDEF    9752--REDEF
B$ALT.ERR.CODE
      9753**DCL     10058>>IF      10096>>IF
B$ALT.ERR.ERR#
      9753**DCL      9753--REDEF
B$ALT.EVID
      9752**DCL      9752--REDEF    9752--REDEF
B$TCB.ALT$
      9747**DCL     10058>>IF      10096>>IF
B$TCB$
      9170**DCL     10058>>IF      10096>>IF
DELETE_NETCON
     10001**DCL     10166<>CALL    10175<>CALL    10183<>CALL    10188<>CALL    10193<>CALL    10198<>CALL
     10202<>CALL    10206<>CALL    10319<>CALL
DELETE_NETCON.KEY_
     10001**DCL     10161<<ASSIGN  10173<<ASSIGN  10181<<ASSIGN  10186<<ASSIGN  10191<<ASSIGN  10196<<ASSIGN
     10200<<ASSIGN  10204<<ASSIGN  10317<<ASSIGN
DELETE_NETCON.LKEY_
     10003**DCL     10165<<ASSIGN  10174<<ASSIGN  10182<<ASSIGN  10187<<ASSIGN  10192<<ASSIGN  10197<<ASSIGN
     10201<<ASSIGN  10205<<ASSIGN  10318<<ASSIGN
DELETE_NETCON.V
     10004**DCL     10001--DCLINIT
DELINDX
      9885**DCL     10070<<ASSIGN  10084>>DOINDEX 10115<<ASSIGN  10128>>ASSIGN  10129>>ASSIGN  10134>>ASSIGN
DEL_ERR
     10320**LABEL   10045--CALLALT 10059--GOTO    10091--CALLALT 10097--GOTO    10133--CALLALT 10138--CALLALT
     10217--CALLALT 10269--CALLALT 10276--CALLALT
F$DCB.ACTPOS
      8986**DCL      8986--REDEF
F$DCB.ARS
      8961**DCL      8961--REDEF
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:436  
F$DCB.ATTR
      8979**DCL      8980--REDEF
F$DCB.BORROW
      8994**DCL      8994--REDEF    8994--REDEF    8994--REDEF
F$DCB.DCBNAME.L
      9008**DCL      9008--IMP-SIZ
F$DCB.EOMCHAR
      8965**DCL      8965--REDEF
F$DCB.FLDID
      8989**DCL      8989--REDEF
F$DCB.FORM$
      8983**DCL      8983--REDEF
F$DCB.FSECT
      8999**DCL      8999--REDEF
F$DCB.FSN
      8976**DCL      8976--REDEF    8976--REDEF    8977--REDEF
F$DCB.HEADER$
      8982**DCL      8982--REDEF
F$DCB.IXTNSIZE
      8980**DCL      8980--REDEF
F$DCB.LASTSTA$
      8970**DCL      8970--REDEF
F$DCB.LVL
      8995**DCL      8995--REDEF
F$DCB.NAME.C
      8970**DCL      8970--REDEF
F$DCB.NOEOF
      8991**DCL      8991--REDEF
F$DCB.NRECS
      8981**DCL      8981--REDEF
F$DCB.NRECX
      9000**DCL      9000--REDEF
F$DCB.OHDR
      8992**DCL      8992--REDEF
F$DCB.ORG
      8975**DCL      8975--REDEF
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:437  
F$DCB.PRECNO
      8998**DCL      8998--REDEF
F$DCB.RCSZ
      9003**DCL      9003--REDEF
F$DCB.RES
      8971**DCL      8971--REDEF
F$DCB.SETX
      8983**DCL      8983--REDEF
F$DCB.TAB$
      8982**DCL      8983--REDEF
F$DCB.TDA
      8997**DCL      8997--REDEF
F$DCB.WSN
      8972**DCL      8972--REDEF
FIND_LINK_LOOP
     10248**LABEL   10250--EXIT
FOUND
      9888**DCL     10066<<ASSIGN  10069<<ASSIGN  10073>>IF      10109<<ASSIGN  10114<<ASSIGN  10119>>IF
HDR$
      9634**DCL      9773--IMP-PTR 10207>>ASSIGN  10208>>CALL
HEX
      9662**DCL     10244<<ASSIGN
HEX$
      9872**DCL     10244>>ASSIGN
HEX_CHARS
      9225**DCL     10243>>CALLBLT
I
      9882**DCL     10067<<DOINDEX 10068>>IF      10070>>ASSIGN  10084<<DOINDEX 10085>>ASSIGN  10085>>ASSIGN
     10111<<DOINDEX 10112>>IF      10113>>ASSIGN  10115>>ASSIGN  10238<<DOINDEX 10239>>ASSIGN
IN$
      9879**DCL     10239<<ASSIGN  10241>>ASSIGN  10243>>CALLBLT 10243>>CALLBLT
J
      9883**DCL     10242<<DOINDEX 10243>>CALLBLT 10244>>ASSIGN  10248<<DOINDEX 10249>>IF      10253>>IF
     10255>>DOINDEX
K
      9884**DCL     10255<<DOINDEX 10256>>ASSIGN  10256>>ASSIGN
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:438  
KSE$ERRMSG
      9138**DCL-ENT 10042--CALL    10050--CALL    10062--CALL    10078--CALL    10106--CALL    10122--CALL
     10214--CALL    10222--CALL    10273--CALL    10281--CALL    10302--CALL    10323--CALL
KSR$WR_HLPCG
      9139**DCL-ENT 10208--CALL
KSU$BLD_TERMID
      9141**DCL-ENT 10296--CALL    10299--CALL
KSU$CHK_TRM_RNG
      9142**DCL-ENT 10300--CALL
KSU$READ_NETCON
      9140**DCL-ENT 10045--CALL    10217--CALL    10276--CALL
KS_CONFIG_KEY
      9526**DCL     10161--ASSIGN  10317--ASSIGN
KS_CONFIG_KEY.NODE
      9529**DCL     10147<<ASSIGN  10160<<ASSIGN  10285<<ASSIGN  10311<<ASSIGN
KS_CONFIG_KEY.TERMID
      9546**DCL     10148<<ASSIGN  10287<<ASSIGN  10296<>CALL    10300<>CALL    10307>>ASSIGN
KS_CONFIG_KEY.TERMID.TERM
      9548**DCL      9557--REDEF
KS_CONFIG_KEY.TERMID.TERM.CHANNEL
      9550**DCL     10312<<ASSIGN
KS_CONFIG_KEY.TERMID.TERM.TERM_NAME
      9557**DCL     10159<<ASSIGN  10309>>IF
KS_CONFIG_LKEY
      9345**DCL     10165--ASSIGN  10318--ASSIGN
KS_CONFIG_LKEY.NODE
      9348**DCL     10162<<ASSIGN  10286<<ASSIGN  10313<<ASSIGN
KS_CONFIG_LKEY.TERMID
      9365**DCL     10299<>CALL    10300<>CALL    10307<<ASSIGN
KS_CONFIG_LKEY.TERMID.LEV
      9367**DCL     10164<<ASSIGN  10292<<ASSIGN
KS_CONFIG_LKEY.TERMID.TERM
      9367**DCL      9376--REDEF
KS_CONFIG_LKEY.TERMID.TERM.CHANNEL
      9369**DCL     10314<<ASSIGN
KS_CONFIG_LKEY.TERMID.TTYP
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:439  
      9367**DCL     10163<<ASSIGN  10291<<ASSIGN
KS_DFLT_KEY
      9307**DCL     10171>>ASSIGN  10173--ASSIGN
KS_DFLT_KEY.HNDLR
      9311**DCL     10170<<ASSIGN
KS_DFLT_KEY.NODE
      9310**DCL     10169<<ASSIGN
KS_DFLT_LKEY
      9326**DCL     10171<<ASSIGN  10174--ASSIGN
KS_DFLT_LKEY.HNDLR
      9330**DCL     10172<<ASSIGN
KS_FEPBOOT_KEY
      9392**DCL     10186--ASSIGN  10187--ASSIGN
KS_FEPBOOT_KEY.NODE
      9395**DCL     10185<<ASSIGN
KS_FEPCTL_KEY
      9428**DCL     10196--ASSIGN  10197--ASSIGN
KS_FEPCTL_KEY.NODE
      9431**DCL     10195<<ASSIGN
KS_FEPHNDLR_KEY
      9410**DCL     10191--ASSIGN  10192--ASSIGN
KS_FEPHNDLR_KEY.NODE
      9413**DCL     10190<<ASSIGN
KS_HNDLR_KEY
      9269**DCL     10181--ASSIGN
KS_HNDLR_KEY.HNDLR
      9273**DCL     10178<<ASSIGN
KS_HNDLR_KEY.NODE
      9272**DCL     10177<<ASSIGN
KS_HNDLR_LKEY
      9288**DCL     10182--ASSIGN
KS_HNDLR_LKEY.HNDLR
      9292**DCL     10179<<ASSIGN
KS_HNDLR_LKEY.NODE
      9291**DCL     10180<<ASSIGN
KS_LINK.CHANNEL
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:440  
      4658**DCL     10249>>IF      10256<<ASSIGN  10256>>ASSIGN  10267--ASSIGN
KS_LINK.LINKS#
      4657**DCL     10229<<ASSIGN  10248>>DOINDEX 10253>>IF      10255>>DOINDEX 10258<<ASSIGN  10258>>ASSIGN
     10264>>IF      10265--ASSIGN  10267>>ASSIGN  10267--ASSIGN
KS_LINK_KEY
      9446**DCL     10200--ASSIGN  10201--ASSIGN  10233--ASSIGN  10263--ASSIGN
KS_LINK_KEY.NODE
      9449**DCL     10199<<ASSIGN  10226<<ASSIGN
KS_MSGBUF
      4657**DCL      9634--DCLINIT 10232--ASSIGN  10262--ASSIGN
KS_MSGBUF$
      4657**DCL      4657--IMP-PTR 10229>>ASSIGN  10248>>DOINDEX 10249>>IF      10253>>IF      10255>>DOINDEX
     10256>>ASSIGN  10256>>ASSIGN  10258>>ASSIGN  10258>>ASSIGN  10264>>IF      10267>>ASSIGN
KS_MYSTATION
      4653**DCL      4653--REDEF
KS_NETWORK
      9573**DCL     10045--CALL    10094--ASSIGN  10098<<ASSIGN  10103>>ASSIGN  10131--ASSIGN  10132--ASSIGN
     10217--CALL    10276--CALL
KS_NETWORK.NODE
      9576**DCL     10132--ASSIGN  10132--ASSIGN
KS_NETWORK.NODE.NODE
      9582**DCL     10113>>ASSIGN  10129<<ASSIGN  10155>>ASSIGN
KS_NETWORK.NODE.TYPE
      9579**DCL     10047>>IF      10047>>IF      10128<<ASSIGN  10219>>IF      10219>>IF      10278>>IF
     10278>>IF
KS_NETWORK.NODE#
      9574**DCL     10105>>IF      10111>>DOINDEX 10132>>ASSIGN
KS_NETWORK_KEY
      9600**DCL     10045--CALL    10093--ASSIGN  10130--ASSIGN  10217--CALL    10276--CALL
KS_NODE
      4654**DCL     10047>>IF      10047>>IF      10054>>ASSIGN  10152>>IF      10154<<ASSIGN  10219>>IF
     10219>>IF      10226>>ASSIGN  10278>>IF      10278>>IF      10285>>ASSIGN  10286>>ASSIGN
KS_NODENAME
      4653**DCL     10041>>IF      10060--ASSIGN  10061>>ASSIGN  10076--ASSIGN  10077>>ASSIGN  10155<<ASSIGN
     10213>>IF      10272>>IF
KS_NODENAME_SV
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:441  
      4654**DCL     10156<<ASSIGN
KS_PSEUDO
      9464**DCL     10056--ASSIGN  10089--ASSIGN
KS_PSEUDO.PSEUDO
      9467**DCL     10085<<ASSIGN  10085>>ASSIGN
KS_PSEUDO.PSEUDO.NAME
      9468**DCL     10068>>IF
KS_PSEUDO.PSEUDO#
      9465**DCL     10067>>DOINDEX 10084>>DOINDEX 10087<<ASSIGN  10087>>ASSIGN  10090>>ASSIGN
KS_PSEUDO_KEY
      9508**DCL     10055--ASSIGN  10088--ASSIGN  10204--ASSIGN  10205--ASSIGN
KS_PSEUDO_KEY.NODE
      9511**DCL     10054<<ASSIGN  10203<<ASSIGN
KS_RFEP
      9620**DCL     10101--ASSIGN  10103<<ASSIGN  10136--ASSIGN  10137--ASSIGN
KS_RFEP.NODE
      9623**DCL     10137--ASSIGN  10137--ASSIGN
KS_RFEP.NODE.TYPE
      9626**DCL     10134<<ASSIGN
KS_RFEP.NODE#
      9621**DCL     10137>>ASSIGN
KS_RFEP_KEY
      9604**DCL     10100--ASSIGN  10135--ASSIGN
KS_SUB_BUF_1
      4658**DCL     10062--CALL    10078--CALL    10122--CALL
KS_SUB_BUF_1.COUNT
      4658**DCL     10060<<ASSIGN  10074<<ASSIGN  10120<<ASSIGN
KS_SUB_BUF_1.TEXT
      4658**DCL     10061<<ASSIGN  10075<<ASSIGN  10121<<ASSIGN
KS_SUB_BUF_2
      4658**DCL     10078--CALL
KS_SUB_BUF_2.COUNT
      4659**DCL     10076<<ASSIGN
KS_SUB_BUF_2.TEXT
      4659**DCL     10077<<ASSIGN
M$DELREC
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:442  
        21**DCL-ENT 10166--CALL    10175--CALL    10183--CALL    10188--CALL    10193--CALL    10198--CALL
     10202--CALL    10206--CALL    10319--CALL
M$READ
        20**DCL-ENT 10057--CALL    10095--CALL    10102--CALL    10234--CALL
M$WRITE
        20**DCL-ENT 10091--CALL    10133--CALL    10138--CALL    10269--CALL
NDSRCH
     10111**LABEL   10116--EXIT
NODE
      9880**DCL     10110<<CALLBLT 10112>>IF      10145>>IF      10147>>ASSIGN  10152>>IF      10160>>ASSIGN
     10162>>ASSIGN  10169>>ASSIGN  10177>>ASSIGN  10180>>ASSIGN  10185>>ASSIGN  10190>>ASSIGN  10195>>ASSIGN
     10199>>ASSIGN  10203>>ASSIGN
NODENAME
      9887**DCL     10113<<ASSIGN  10121>>ASSIGN
NO_ERR
     10322**LABEL   10296--CALLALT 10299--CALLALT 10303--GOTO
OFFSET
      9877**DCL     10241<<ASSIGN  10242>>DOINDEX 10243>>CALLBLT
OUT$BLK.CODE
      9677**DCL     10039>>DOCASE
OUT$BLK.NSUBLKS
      9681**DCL     10228>>IF      10238>>DOINDEX 10289>>IF      10297>>IF
OUT$BLK.SUBLK$
      9702**DCL     10065>>ASSIGN  10065>>ASSIGN  10074>>ASSIGN  10110>>CALLBLT 10110>>CALLBLT 10120>>ASSIGN
     10239>>ASSIGN  10296>>CALL    10296<>CALL    10297>>IF      10299>>CALL    10299<>CALL
OUT$SYM.COUNT
      9738**DCL      9741--IMP-SIZ 10065>>ASSIGN  10074>>ASSIGN  10110>>CALLBLT 10120>>ASSIGN  10241>>ASSIGN
     10243>>CALLBLT
OUT$SYM.TEXT
      9741**DCL     10065>>ASSIGN  10110>>CALLBLT 10243>>CALLBLT
PROMPT.NODENAME
      9254**DCL     10157<<ASSIGN
PSEUDO_NAME
      9886**DCL     10065<<ASSIGN  10068>>IF      10075>>ASSIGN
READ_NETCON
      9935**DCL     10057<>CALL    10095<>CALL    10102<>CALL    10234<>CALL
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:443  
READ_NETCON.BUF_
      9937**DCL     10056<<ASSIGN  10094<<ASSIGN  10101<<ASSIGN  10232<<ASSIGN
READ_NETCON.KEY_
      9935**DCL     10055<<ASSIGN  10093<<ASSIGN  10100<<ASSIGN  10233<<ASSIGN
READ_NETCON.STATION_
      9938**DCL      9939--REDEF
READ_NETCON.V
      9939**DCL      9935--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
      9950**DCL      9950--REDEF
READ_NETCON.V.INDX#
      9948**DCL      9948--REDEF
TEMP
      9878**DCL     10243<<CALLBLT 10244>>ASSIGN
TEMP_LINK
      9865**DCL     10240<<ASSIGN  10249>>IF
TEMP_LINK.HEX0
      9867**DCL      9873--DCLINIT
TEMP_LINK.HEX1
      9868**DCL      9874--DCLINIT
TEMP_LINK.HEX2
      9870**DCL      9875--DCLINIT
TEMP_LINK.HEX3
      9871**DCL      9876--DCLINIT
TOP$
         8**DCL         6--PROC     9669--IMP-PTR 10039>>DOCASE  10065>>ASSIGN  10065>>ASSIGN  10074>>ASSIGN
     10110>>CALLBLT 10110>>CALLBLT 10120>>ASSIGN  10228>>IF      10238>>DOINDEX 10239>>ASSIGN  10289>>IF
     10296>>CALL    10297>>IF      10299>>CALL
UPDATE
      9773**DCL     10208--CALL
UPDATE.CODE
      9778**DCL     10207<<ASSIGN
WRITE_NETCON
      9975**DCL     10091<>CALL    10133<>CALL    10138<>CALL    10269<>CALL
WRITE_NETCON.BUF_
      9975**DCL     10089<<ASSIGN  10131<<ASSIGN  10136<<ASSIGN  10262<<ASSIGN
PL6.E3A0      #002=KSC$DELETE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:46 Page:444  
WRITE_NETCON.BUF_.BOUND
      9975**DCL     10090<<ASSIGN  10132<<ASSIGN  10137<<ASSIGN  10265<<ASSIGN  10267<<ASSIGN
WRITE_NETCON.KEY_
      9975**DCL     10088<<ASSIGN  10130<<ASSIGN  10135<<ASSIGN  10263<<ASSIGN
WRITE_NETCON.STATION_
      9977**DCL      9977--REDEF
WRITE_NETCON.V
      9978**DCL      9975--DCLINIT
WRITE_NETCON.V.DVBYTE.VFC#
      9984**DCL      9984--REDEF

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:445  
     2396        1        /*T***********************************************************/
     2397        2        /*T*                                                         */
     2398        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2399        4        /*T*                                                         */
     2400        5        /*T***********************************************************/
     2401        6        KSC$DEFINE: PROC(TOP$) ALTRET;
     2402        7        /**/
     2403        8    1   DCL TOP$ PTR;
     2404        9        /**/
     2405       10        %INCLUDE CP_6;
     2406       91        %INCLUDE KL_MACRO_C;
     2407     3443        %INCLUDE KL_CONFIG_M;
     2408     4205        %INCLUDE KL_CONTROL_C;
     2409     4585        %INCLUDE GI_BOOT_C;
     2410     4696        %INCLUDE KS_MACRO_M;
     2411     4893        %INCLUDE KS_SUBS_C;
     2412     5136        %INCLUDE KS_DATA_R;
     2413     5151        %INCLUDE KS_PERR_C;
     2414     5218        %INCLUDE F$DCB;
     2415     5267        %INCLUDE XU_MACRO_C;
     2416     8373        %INCLUDE B_ERRORS_C;
     2417     9500        %INCLUDE CP_6_SUBS;
     2418    10040        %INCLUDE            KL_AFCN_C;
     2419    10141        %KS$BOX(TITLE="entry defs");

             10159    1   /***************************************************************************
             10160    1    *                                                                         *
             10161    1    *                                 entry defs                              *
             10162    1    *                                                                         *
             10163    1    ***************************************************************************/

     2420    10168    1   DCL KSE$ERRMSG ENTRY(4);
     2421    10169    1   DCL                 KSR$WR_HLPCG ENTRY(1) ALTRET;
     2422    10170    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
     2423    10171    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
     2424    10172        %KS$BOX(TITLE="symref variables");

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:446  
             10190    1   /***************************************************************************
             10191    1    *                                                                         *
             10192    1    *                              symref variables                           *
             10193    1    *                                                                         *
             10194    1    ***************************************************************************/

     2425    10199        %KS$HAND_INFO (NAME=KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF",LAST=YES);
     2426    10238    1   DCL B$TCB$ PTR SYMREF;
     2427    10239    1   DCL KS_TBL(0:0) PTR SYMREF;
     2428    10240        %KS$BOX(TITLE="symdef variables");

             10258    1   /***************************************************************************
             10259    1    *                                                                         *
             10260    1    *                              symdef variables                           *
             10261    1    *                                                                         *
             10262    1    ***************************************************************************/

     2429    10267        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS="STATIC SYMDEF");
     2430    10294        %KS$BOX(TITLE="constant variables");

             10312    1   /***************************************************************************
             10313    1    *                                                                         *
             10314    1    *                             constant variables                          *
             10315    1    *                                                                         *
             10316    1    ***************************************************************************/

     2431    10321    1   DCL HEX_CHARS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
     2432    10322        %KS$BOX(TITLE="static variables");

             10340    1   /***************************************************************************
             10341    1    *                                                                         *
             10342    1    *                              static variables                           *
             10343    1    *                                                                         *
             10344    1    ***************************************************************************/

     2433    10349        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
     2434    10368        %KL$LINK_KEY (NAME=KS_LINK_KEY,STCLASS=STATIC);
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:447  
     2435    10386        %KL$FEPBOOT (NAME=KS_FEPBOOT,NUM=GI_BOOT_HI,STCLASS=STATIC);
     2436    10411        %KL$FEPBOOT_KEY (NAME=KS_FEPBOOT_KEY,STCLASS=STATIC);
     2437    10429    1         DCL   HEX$(0:3)   PTR  STATIC INIT(
     2438    10430    1                                          ADDR(TEMP_LINK.HEX0),
     2439    10431    1                                          ADDR(TEMP_LINK.HEX1),
     2440    10432    1                                          ADDR(TEMP_LINK.HEX2),
     2441    10433    1                                          ADDR(TEMP_LINK.HEX3));
     2442    10434    1   DCL   1  TEMP_LINK   STATIC,
     2443    10435    1            2  *        BIT(1) UNAL,
     2444    10436    1            2  HEX0     UBIN(4) UNAL,
     2445    10437    1            2  HEX1     UBIN(4) UNAL,
     2446    10438    1            2  *        BIT(1)  UNAL,
     2447    10439    1            2  HEX2     UBIN(4) UNAL,
     2448    10440    1            2  HEX3     UBIN(4) UNAL;
     2449    10441        %KL$FEPCTL (NAME=KS_FEPCTL,NUM=GI_CNTL_BOOTHI,STCLASS=STATIC);
     2450    10461        %KL$FEPCTL_KEY (NAME=KS_FEPCTL_KEY,STCLASS=STATIC);
     2451    10479        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
     2452    10509        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
     2453    10527        %KL$PSEUDO (NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
     2454    10571        %KL$PSEUDO_KEY (NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
     2455    10589        %KL$NODEINFO (NAME=KS_NODEINFO,STCLASS=STATIC);
     2456    10606        %KL$NODEINFO_KEY (NAME=KS_NODEINFO_KEY,STCLASS=STATIC);
     2457    10623        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
     2458    10642    1        DCL   DEFAULT_BUF (0:49) UBIN WORD STATIC INIT(0*0);
     2459    10643    1        DCL   DEFAULT$ PTR STATIC INIT(ADDR(DEFAULT_BUF));
     2460    10644    1   DCL HNDLR$ PTR STATIC INIT(ADDR(HNDLR_BUF));
     2461    10645    1   DCL HNDLR_BUF(0:400) CHAR(1) STATIC;
     2462    10646        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
     2463    10663    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
     2464    10664    1        2  CNT UBIN BYTE UNAL INIT(1),
     2465    10665    1       2  TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
     2466    10666        %KL$NETWORK         (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
     2467    10693    1   DCL                 HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
     2468    10694        %KS$BOX(TITLE="based variables");

             10712    1   /***************************************************************************
             10713    1    *                                                                         *
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:448  
             10714    1    *                              based variables                            *
             10715    1    *                                                                         *
             10716    1    ***************************************************************************/

     2469    10721    1   DCL B$PARAMI(0:0) UBIN HALF BASED HALIGNED;
     2470    10722
     2471    10723        %KS$PARAM(NAME=KS$PARAM,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
     2472    10793        %KL$LINCNFG(NAME=KS_DEFAULT,STCLASS="BASED(DEFAULT$)");
     2473    10951        %B$TCB;
     2474    10954        %B$ALT;
     2475    10962        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2476    11007        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
     2477    11045        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_FIXED_HI,STCLASS="BASED(HNDLR$)");
     2478    11108    1   DCL   HEX   UBIN(4)  BASED UNAL;
     2479    11109        %KL_HDR(FPTN=UPDATE,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     2480    11189        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:449  
             11207    1   /***************************************************************************
             11208    1    *                                                                         *
             11209    1    *                               auto variables                            *
             11210    1    *                                                                         *
             11211    1    ***************************************************************************/

     2481    11216    1   DCL NODENAME CHAR(8);
     2482    11217    1   DCL                 NRLINKS SBIN;
     2483    11218    1   DCL                 LINK_LIST(0:10)  CHAR(4);
     2484    11219    1   DCL I UBIN;
     2485    11220    1   DCL FEX UBIN;
     2486    11221    1   DCL NODETYPE UBIN;
     2487    11222    1   DCL CONTROL_NODE CHAR(8);
     2488    11223    1   DCL OUT$ PTR;
     2489    11224    1   DCL DFLT$ PTR;
     2490    11225    1   DCL DFLT_OPT$ PTR;
     2491    11226    1   DCL K UBIN;
     2492    11227    1   DCL HAND# UBIN;
     2493    11228    1   DCL L UBIN;
     2494    11229    1   DCL J SBIN;
     2495    11230    1   DCL TEMP UBIN;
     2496    11231    1   DCL   LNKS  UBIN;
     2497    11232    1   DCL   OFFSET   UBIN;
     2498    11233    1       DCL LINK_NR CHAR(1);
     2499    11234        %KS$BOX(TITLE="FPTs, VLPs and such",PAGE=YES);

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:450  
             11252    1   /***************************************************************************
             11253    1    *                                                                         *
             11254    1    *                            FPTs, VLPs and such                          *
             11255    1    *                                                                         *
             11256    1    ***************************************************************************/

     2500    11261        %FPT_READ (FPTN=READ_NETCON,
     2501    11262                   DCB=M$NETCON,
     2502    11263                   KEYS=YES);
     2503    11302        %FPT_WRITE (FPTN=WRITE_NETCON,
     2504    11303                    DCB=M$NETCON);
     2505    11334        %FPT_MONINFO(FPTN = KS_MONINFO,
     2506    11335                     MONINFO = KS_MONINFO_V);
     2507    11350        %VLR_MONINFO(FPTN = KS_MONINFO_V);
     2508    11368        %KS$BOX(TITLE="DCBs");

             11386    1   /***************************************************************************
             11387    1    *                                                                         *
             11388    1    *                                    DCBs                                 *
             11389    1    *                                                                         *
             11390    1    ***************************************************************************/

     2509    11395    1   DCL M$NETCON DCB;
     2510    11396        %EJECT;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:451  
     2511    11397    2        DO CASE(OUT$BLK.CODE);
     2512    11398    2           CASE(%KS_NODE);
     2513    11399    2              CALL CHARBIN(FEX,OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     2514    11400    2              CALL BINCHAR(NODENAME,FEX);
     2515    11401    2              SUBSTR(NODENAME,0,4) = 'NODE';
     2516    11402    2              NODETYPE = %KS_FEP;
     2517    11403    2              CALL M$MONINFO(KS_MONINFO) ALTRET(DEF_ERR);
     2518    11404    2              CONTROL_NODE = KS_MONINFO_V.NODE_NAME;
     2519    11405    2             NRLINKS = 0;
     2520    11406
     2521    11407    3              DO I = 1 TO OUT$BLK.NSUBLKS-1;
     2522    11408    4                 DO CASE (OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
     2523    11409
     2524    11410    4                  CASE (%KS_NAME);
     2525    11411    4                    NODENAME = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2526    11412
     2527    11413    4                  CASE (%KS_TYPE);
     2528    11414    4                    NODETYPE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     2529    11415
     2530    11416    4                  CASE (%KS_CONT);
     2531    11417    4                    CONTROL_NODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2532    11418    4                   CASE (%KS_LINK);
     2533    11419    4                      NRLINKS = OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS;
     2534    11420    5                      DO J = 0 TO NRLINKS - 1;
     2535    11421    5                         LINK_LIST(J) = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$SYM.
             11421                                  TEXT;
     2536    11422    5                      END;
     2537    11423
     2538    11424    4                  END;
     2539    11425    3                 END;
     2540    11426
     2541    11427    2              KS_SUB_BUF_1.TEXT = NODENAME;
     2542    11428    2              KS_SUB_BUF_1.COUNT = SIZEC(NODENAME);
     2543    11429    2              IF NODETYPE = %KS_RFEP AND NRLINKS = 0 THEN
     2544    11430    3                DO;
     2545    11431    3                   CALL KSE$ERRMSG (%E$KS_RFEP_WITH_NO_LINKS-0,VECTOR(KS_SUB_BUF_1));
     2546    11432                         /*E* ERROR:  KSN-E$KS_RFEP_WITH_NO_LINKS_0
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:452  
     2547    11433          MESSAGE: A link must be defined on a RFEP node.  Node %U1 has not been defined. */
     2548    11434    3                   RETURN;
     2549    11435    3                END;
     2550    11436    2              IF NODETYPE = %KS_ME OR NODETYPE = %KS_HOST THEN
     2551    11437    2                 CONTROL_NODE = ' ';
     2552    11438    2     IF FEX > KS_MONINFO_V.NUM_NODES - 1 THEN
     2553    11439    3                DO;
     2554    11440    3                 CALL BINCHAR(KS_SUB_BUF_1.TEXT,KS_MONINFO_V.NUM_NODES - 1);
     2555    11441    3                 KS_SUB_BUF_1.TEXT = SUBSTR(KS_SUB_BUF_1.TEXT,28,3);
     2556    11442    3                   KS_SUB_BUF_1.COUNT = 3;
     2557    11443    3                   CALL KSE$ERRMSG (%E$KS_MAX_NODE-0,VECTOR(KS_SUB_BUF_1));
     2558    11444                         /*E* ERROR:  KSN-E$KS_MAX_NODE-0
     2559    11445                              MESSAGE: Node %U1 is the largest node that may be defined.
     2560    11446                              DESCRIPTION: The largest node number is set in TIGR
     2561    11447                                  above which NETCON can not define a node. */
     2562    11448    3                   RETURN;
     2563    11449    3                END;
     2564    11450    2              READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
     2565    11451    2              READ_NETCON.BUF_ = VECTOR(KS_NETWORK);
     2566    11452    3              CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     2567    11453    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY
     2568    11454    3                    THEN GOTO DEF_ERR;
     2569    11455    3                 END;  /* WHENALTRETURN */
     2570    11456    2             READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);
     2571    11457    2             READ_NETCON.BUF_ = VECTOR(KS_RFEP);
     2572    11458    3             CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     2573    11459    3                KS_RFEP = KS_NETWORK;
     2574    11460    3                END;  /* WHENALTRETURN */
     2575    11461    2              IF KS_NETWORK.NODE.NODE(FEX) ~= ' ' THEN
     2576    11462    3                 DO;
     2577    11463    3                    KS_SUB_BUF_1.COUNT = SIZEC(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
     2578    11464    3                    KS_SUB_BUF_1.TEXT = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     2579    11465    3                    CALL KSE$ERRMSG(%E$KS_DUP_NODE,VECTOR(KS_SUB_BUF_1));
     2580    11466                         /*E* ERROR: KSN-E$KS_DUP_NODE-0
     2581    11467                              MESSAGE: Node %U1 is already defined.
     2582    11468                              DESCRIPTION: SEE MESSAGE */
     2583    11469    3                    RETURN;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:453  
     2584    11470    3                 END;  /* IF */
     2585    11471    2              KS_NETWORK.NODE# = KS_MONINFO_V.NUM_NODES;
     2586    11472    3              DO I = 0 TO KS_NETWORK.NODE#;
     2587    11473    3                 IF KS_NETWORK.NODE.NODE(I) = NODENAME
     2588    11474    3                    THEN
     2589    11475    4                    DO;
     2590    11476    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));
     2591    11477    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     2592    11478    4                       CALL KSE$ERRMSG(%E$KS_DUP_NODE,VECTOR(KS_SUB_BUF_1));
     2593    11479    4                       RETURN;
     2594    11480    4                    END;  /* IF */
     2595    11481    3                 ELSE IF CONTROL_NODE = KS_NETWORK.NODE.NODE(I) AND
     2596    11482    3                        CONTROL_NODE ~= ' ' AND
     2597    11483    3                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_HOST AND
     2598    11484    3                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_ME)) THEN
     2599    11485    4                         DO;
     2600    11486    4                            CALL KSE$ERRMSG (%E$KS_CNTRL_NOT_HOST);
     2601    11487                                 /*E* ERROR:  KSN-E$KS_CNTRL_NOT_HOST-0
     2602    11488                     MESSAGE: WARNING: The control node specified is not of type host or me.
     2603    11489                                      DESCRIPTION:  SEE MESSAGE */
     2604    11490    4                         END;
     2605    11491    3                  ELSE IF KS_NETWORK.NODE.CONTROL_NODE(I) = NODENAME AND
     2606    11492    3                       (NODETYPE ~= %KS_HOST AND NODETYPE ~=%KS_ME) THEN
     2607    11493    4                          DO;
     2608    11494    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));
     2609    11495    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     2610    11496    4                             CALL KSE$ERRMSG (%E$KS_NODE_NOT_CNTRL, VECTOR(KS_SUB_BUF_1
             11496                                      ));
     2611    11497                                  /*E* ERROR: KSN-E$KS_NODE_NOT_CNTRL-0
     2612    11498         MESSAGE: WARNING: %U1 specifies this node as a control node, but this node is not H
             11498        OST or ME.
     2613    11499                                       DESCRIPTION:  SEE MESSAGE */
     2614    11500    4                          END;
     2615    11501    3               END;
     2616    11502
     2617    11503    2              IF FEX > KS_NETWORK.NODE#
     2618    11504    3              THEN DO;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:454  
     2619    11505    4                 DO I = KS_NETWORK.NODE#+1 TO FEX;
     2620    11506    4                    KS_NETWORK.NODE.TYPE(I) = 0;
     2621    11507    4                    KS_NETWORK.NODE.NODE(I) = ' ';
     2622    11508    4                   KS_RFEP.NODE.TYPE(I) = 0;
     2623    11509    4                   KS_RFEP.NODE.NODE(I) = ' ';
     2624    11510    4                    END;
     2625    11511    3                 KS_NETWORK.NODE# = FEX;
     2626    11512    3                KS_RFEP.NODE# = FEX;
     2627    11513    3                 END;
     2628    11514    2             KS_NETWORK.NODE.TYPE(FEX) = NODETYPE;
     2629    11515    2             KS_RFEP.NODE.TYPE(FEX) = NODETYPE;
     2630    11516    2              IF NODETYPE = %KS_RFEP THEN
     2631    11517    2                KS_NETWORK.NODE.TYPE(FEX) = %KS_FEP;
     2632    11518    2             KS_NETWORK.NODE.NODE(FEX) = NODENAME;
     2633    11519    2             KS_NETWORK.NODE.CONTROL_NODE(FEX) = CONTROL_NODE;
     2634    11520    2             WRITE_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
     2635    11521    2             WRITE_NETCON.BUF_ = VECTOR(KS_NETWORK);
     2636    11522    2                 WRITE_NETCON.BUF_.BOUND = SIZEV(KS_NETWORK) - SIZEC(KS_NETWORK.NODE) +
     2637    11523    2                   KS_NETWORK.NODE#*SIZEC(KS_NETWORK.NODE(0));
     2638    11524    2             CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);
     2639    11525    2             WRITE_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);
     2640    11526    2             WRITE_NETCON.BUF_ = VECTOR(KS_RFEP);
     2641    11527    2                 WRITE_NETCON.BUF_.BOUND = SIZEV(KS_RFEP) - SIZEC(KS_RFEP.NODE) +
     2642    11528    2                   KS_RFEP.NODE#*SIZEC(KS_RFEP.NODE(0));
     2643    11529    2             CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);
     2644    11530
     2645    11531    2              KS_FEPBOOT_KEY.NODE = FEX;
     2646    11532    2              KS_FEPCTL_KEY.NODE = FEX;
     2647    11533    2              KS_FEPHNDLR_KEY.NODE = FEX;
     2648    11534    2              KS_HANDLER_KEY.NODE = FEX;
     2649    11535    2              KS_DEFAULT_KEY.NODE = FEX;
     2650    11536
     2651    11537
     2652    11538        /* Do Case depending on node type */
     2653    11539    3              DO CASE (NODETYPE);
     2654    11540
     2655    11541    3              CASE (%KS_FEP,%KS_NODETYPE_DEBUG,%KS_RFEP);
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:455  
     2656    11542                   /* Write default FEPBOOT record */
     2657    11543    3              KS_FEPBOOT.BOOTFID = 'M:FEP.:SYS';
     2658    11544    3              KS_FEPBOOT.BOOTPARAMS = '0'B;
     2659    11545    4              DO I=0 TO %GI_BOOT_HI;
     2660    11546    4                 KS_FEPBOOT.BOOTPARAMS(I) = KS_TBL(%KS_BOOT_PARAM)->KS$PARAM.DEFAULT(I)
             11546                          ;
     2661    11547    4                 END;
     2662    11548    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_LDCT) = %GI_LDCT#;
     2663    11549    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_IOP) = %GI_IOP#;
     2664    11550    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_HMI) = %GI_HMI#;
     2665    11551    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_APESSN) = %GI_APESSN#;
     2666    11552    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_SPROC) = %GI_SPROC#;
     2667    11553    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_ACCTS) = %GI_ACCTS#;
     2668    11554    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_MUIS) = %GI_MUIS#;
     2669    11555    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_NSHUF) = %GI_NSHUF#;
     2670    11556    3                KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_TCTX) = %GI_TCTX#;
     2671    11557    3             KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_CBUFFER) = %GI_CBUFFER#;
     2672    11558    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_NODES) = %GI_NODES#;
     2673    11559    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_LINKS) = %GI_LINKS#;
     2674    11560    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_DEVICES) = %GI_DEVICES#;
     2675    11561    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_PCHANS) = %GI_PCHANS#;
     2676    11562    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
     2677    11563    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPBOOT);
     2678    11564    3              CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);
     2679    11565
     2680    11566                   /* Write default FEPCTL record */
     2681    11567    4              DO I=0 TO %GI_CNTL_BOOTHI;
     2682    11568    4                 KS_FEPCTL.PARAMS(I) = KS_TBL(%KS_LCP6_PARAM) -> KS$PARAM.DEFAULT(I);
     2683    11569    4                 END;
     2684    11570    3              KS_FEPCTL.NPARAMS = %GI_CNTL_BOOTHI;
     2685    11571
     2686    11572    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);
     2687    11573    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPCTL);
     2688    11574    3              CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);
     2689    11575
     2690    11576                   /* Write default FEPHNDLR record */
     2691    11577    3   IF NODETYPE = %KS_RFEP THEN
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:456  
     2692    11578    4       DO;
     2693    11579    4          KS_FEPHNDLR.NHANDLERS = 3; /* NA, HDLCX25, ASYNC */
     2694    11580    4          KS_FEPHNDLR.HANDLER(0) = 'NODEADMN';
     2695    11581    4          KS_FEPHNDLR.HANDLER(1) = 'HDLCX25';
     2696    11582    4          KS_FEPHNDLR.HANDLER(2) = 'ASYNC';
     2697    11583    4          KS_FEPHNDLR.DEFLIBACCT = ':SYS    ';
     2698    11584    4          KS_FEPHNDLR.BOOTIME(0) = '1'B;  /* load nodeadmn at bootime */
     2699    11585    4          KS_FEPHNDLR.BOOTIME(1) = '1'B;  /* load hdlcx25 at bootime */
     2700    11586    4          KS_FEPHNDLR.BOOTIME(2) = '0'B;  /* don't load async until later*/
     2701    11587    4       END;
     2702    11588    3   ELSE
     2703    11589    4       DO;
     2704    11590    4          KS_FEPHNDLR.NHANDLERS = 3; /* NA, FEI, ASYNC */
     2705    11591    4          KS_FEPHNDLR.HANDLER(0) = 'NODEADMN';
     2706    11592    4          KS_FEPHNDLR.HANDLER(1) = 'COUPLER';
     2707    11593    4          KS_FEPHNDLR.HANDLER(2) = 'ASYNC';
     2708    11594    4          KS_FEPHNDLR.DEFLIBACCT = ':SYS    ';
     2709    11595    4          KS_FEPHNDLR.BOOTIME(0) = '1'B;  /* load nodeadmn at bootime */
     2710    11596    4          KS_FEPHNDLR.BOOTIME(1) = '1'B;  /* load coupler at bootime */
     2711    11597    4          KS_FEPHNDLR.BOOTIME(2) = '1'B;  /* load async at bootime */
     2712    11598    4       END;
     2713    11599    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);
     2714    11600    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);
     2715    11601
     2716    11602
     2717    11603
     2718    11604
     2719    11605    3                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_FEPHNDLR.NHANDLERS) + SIZEC(
             11605                          KS_FEPHNDLR.DEFLIBACCT) + 4  /* bootime */
     2720    11606    3                                           + SIZEC(KS_FEPHNDLR.HANDLER(0)) *
             11606                                                    KS_FEPHNDLR.NHANDLERS - 1;
     2721    11607    3              CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);
     2722    11608
     2723    11609                   /* Write default HNDLR records */
     2724    11610    4              DO J = 1 TO KS_FEPHNDLR.NHANDLERS;
     2725    11611    4                 KS_DEFAULT_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J-1);
     2726    11612    4                 CALL KSU$INIT_DEFCNFG(KS_DEFAULT);
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:457  
     2727    11613    4                 CALL KSU$WRITE_NETCON(VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT));
     2728    11614    4                 KS_HANDLER = '0'B;
     2729    11615    4                 KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J-1);
     2730    11616    4                 KS_HANDLER.HNDLRFID = KS_FEPHNDLR.HANDLER(J-1);
     2731    11617    4                 CALL INDEX(TEMP,' ',KS_HANDLER.HNDLRFID);
     2732    11618    4                 CALL INSERT(KS_HANDLER.HNDLRFID,TEMP,,'.:SYS');
     2733    11619    4                 KS_HANDLER.HNDLRNAME = KS_FEPHNDLR.HANDLER(J-1);
     2734    11620    5                  DO HAND# = 0 TO 7;
     2735    11621    5                       IF KS_HAND_INFO.TEXT(HAND#) = KS_HANDLER_KEY.HNDLR
     2736    11622    5                       THEN
     2737    11623    5                            EXIT;
     2738    11624    5                       END;
     2739    11625    4                 KS_HANDLER.TYPE = KS_HAND_INFO.TYPE(HAND#);
     2740    11626
     2741    11627    4                 DFLT$ = KS_HAND_INFO.PARAMS$(HAND#);
     2742    11628
     2743    11629    4                 IF KS_HAND_INFO.SZ(HAND#) <= %KL_FIXED_HI
     2744    11630    4                 THEN KS_HANDLER.NPARAMS = KS_HAND_INFO.SZ(HAND#);
     2745    11631    4                 ELSE KS_HANDLER.NPARAMS = %KL_FIXED_HI;
     2746    11632
     2747    11633    5                 DO K=0 TO KS_HANDLER.NPARAMS-1;
     2748    11634    5                    KS_HANDLER.PARAMS(K) = DFLT$->KS$PARAM.DEFAULT(K);
     2749    11635    5                    END;
     2750    11636
     2751    11637    4                 IF KS_HAND_INFO.SZ(HAND#) > %KL_FIXED_HI
     2752    11638    5                 THEN DO;
     2753    11639    5                       KS_HANDLER.NPARAMI = KS_HAND_INFO.SZ(HAND#) - %KL_FIXED_HI;
     2754    11640    5                      OUT$ = PINCRW(ADDR(KS_HANDLER),SIZEW(KS_HANDLER));
     2755    11641
     2756    11642    6                     DO K = %KL_HNDLRPARM_BLOCK TO KS_HAND_INFO.SZ(HAND#)-1;
     2757    11643    6                         DFLT_OPT$ = DFLT$->KS$PARAM.SPCL_TBL$(K);
     2758    11644    6                        KS_HANDLER.IPARAM.OFFSET(K - %KL_HNDLRPARM_BLOCK) = POFFW(OUT$,
             11644                                 ADDR(KS_HANDLER));
     2759    11645    6                        KS_HANDLER.IPARAM.ARRAY_SZ(K - %KL_HNDLRPARM_BLOCK) =
             11645                                 KS_HAND_INFO.PARAMS$(HAND#)->KS$PARAM.ARRAY_SZ(K);
     2760    11646
     2761    11647    7                        DO I = 0 TO KS_HANDLER.IPARAM.ARRAY_SZ(K - %KL_HNDLRPARM_BLOCK)
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:458  
             11647                                 ;
     2762    11648    7                         OUT$->B$PARAMI(I) = DFLT_OPT$->KS$PARAM.DEFAULT(I);
     2763    11649    7                           END;
     2764    11650
     2765    11651    6                        OUT$ = PINCRW(OUT$,(KS_HANDLER.IPARAM.ARRAY_SZ(K - %
             11651                                 KL_HNDLRPARM_BLOCK)+2)/2);
     2766    11652    6                         END;  /* DO K - # of indexed params */
     2767    11653    5                     END;  /* DO IF ANY INDEXED PARAMS */
     2768    11654
     2769    11655    4                 WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
     2770    11656    4                 WRITE_NETCON.BUF_ = VECTOR(KS_HANDLER);
     2771    11657    4                 IF KS_HANDLER.NPARAMI = 0
     2772    11658    5                 THEN DO;
     2773    11659    5                    OUT$ = ADDR(KS_HANDLER);
     2774    11660    5                    OUT$ = PINCRW(OUT$,SIZEW(KS_HANDLER) + 1);
     2775    11661    5                 END;
     2776    11662
     2777    11663    4                 WRITE_NETCON.BUF_.BOUND = POFFC(OUT$,ADDR(KS_HANDLER))-1;
     2778    11664    4                 CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);
     2779    11665    4                 END;  /* DO J - # of handlers */
     2780    11666
     2781    11667             /* Write a link record for the FEP */
     2782    11668    3       KS_LINK.LINKS# = 0;
     2783    11669    4       DO I = 0 TO NRLINKS - 1;
     2784    11670    4          K = 3;
     2785    11671    4          TEMP_LINK = '0'B;
     2786    11672    5          DO J = 3 DOWNTO 0;
     2787    11673    5              IF SUBSTR(LINK_LIST(I),J,1) ~= ' ' THEN
     2788    11674    6                DO;
     2789    11675    6                   CALL INDEX (TEMP,SUBSTR(LINK_LIST(I),J,1),HEX_CHARS);
     2790    11676    6                   HEX$(K)->HEX = TEMP;
     2791    11677    6                   K = K - 1;
     2792    11678    6                END;
     2793    11679    5          END;
     2794    11680    4           IF I = 0 THEN
     2795    11681    5             DO;
     2796    11682    5                KS_LINK.CHANNEL(0)= TEMP_LINK;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:459  
     2797    11683    5                KS_LINK.LINKS# = KS_LINK.LINKS# + 1;
     2798    11684    5             END;
     2799    11685    4           ELSE
     2800    11686    5             DO;
     2801    11687    6   CHECK_DUP:             DO J = 0 TO KS_LINK.LINKS# - 1;
     2802    11688    6                    IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN
     2803    11689    6                      EXIT CHECK_DUP;
     2804    11690    6                END;
     2805    11691    5                 IF J = KS_LINK.LINKS# THEN
     2806    11692    6                   DO;
     2807    11693    6                      KS_LINK.CHANNEL(KS_LINK.LINKS#) = TEMP_LINK;
     2808    11694    6                      KS_LINK.LINKS# = KS_LINK.LINKS# + 1;
     2809    11695    6                   END;
     2810    11696    5             END;
     2811    11697    4       END;
     2812    11698    3       KS_LINK_KEY.NODE = FEX;
     2813    11699    3       WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     2814    11700    3       WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     2815    11701    3        WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +
     2816    11702    3                                 (SIZEC(KS_LINK.CHANNEL(0)) *
     2817    11703    3                                 KS_LINK.LINKS#) - 1;
     2818    11704    3       CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);
     2819    11705
     2820    11706        %EJECT;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:460  
     2821    11707    3               CASE (%KS_HOST);
     2822    11708
     2823    11709    3               CASE (%KS_ME);
     2824    11710    3                 KS_NODEINFO.NODE# = FEX;
     2825    11711    3                 KS_NODEINFO.NODENAME = NODENAME;
     2826    11712    3                 WRITE_NETCON.BUF_ = VECTOR(KS_NODEINFO);
     2827    11713    3                 WRITE_NETCON.KEY_ = VECTOR(KS_NODEINFO_KEY);
     2828    11714    3                 CALL M$WRITE (WRITE_NETCON) ALTRET(DEF_ERR);
     2829    11715
     2830    11716    3               END /* END CASES */;
     2831    11717    2   UPDATE.CODE = %IGA_UPDATE;
     2832    11718    3   CALL KSR$WR_HLPCG(VECTOR(UPDATE)) WHENALTRETURN DO; END;
     2833    11719
     2834    11720    2              RETURN;
     2835    11721    2         DEF_ERR:;
     2836    11722    2              CALL KSE$ERRMSG(0);
     2837    11723    2              CALL KSE$ERRMSG(%E$KS_CANTDEFNODE,VECTOR(KS_SUB_BUF_1));
     2838    11724                   /*E* ERROR: KSN-E$KS_CANTDEFNODE-0
     2839    11725                        MESSAGE: Unable to DEFINE node %U1.
     2840    11726                        DESCRIPTION: SEE MESSAGE */
     2841    11727        %EJECT;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:461  
     2842    11728    2            CASE (%KS_LINKS);
     2843    11729    2              KS_FEPBOOT_KEY.NODE = KS_NODE;
     2844    11730    2              READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);
     2845    11731    2              READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);
     2846    11732    3             CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     2847    11733    3                CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);
     2848    11734    3                RETURN;
     2849    11735    3             END;
     2850    11736    2               LNKS = KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_LINKS);
     2851    11737
     2852    11738    2              KS_LINK_KEY.NODE = KS_NODE;
     2853    11739    2              READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     2854    11740    2              READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     2855    11741    3              CALL M$READ(READ_NETCON)  WHENALTRETURN DO;
     2856    11742                      /*
     2857    11743                         a link record does not exist for this node
     2858    11744                      */
     2859    11745    3                 KS_LINK = '0'B;
     2860    11746    3                 END;  /* whenaltreturn  */
     2861    11747
     2862    11748    3               DO K = 0 TO OUT$BLK.NSUBLKS - 1;
     2863    11749    3                  OUT$ = OUT$BLK.SUBLK$(K);
     2864    11750    3                  IF KS_LINK.LINKS# >= LNKS THEN
     2865    11751    4                     DO;
     2866    11752    4                        KS_SUB_BUF_1.COUNT = SIZEC(LNKS);
     2867    11753    4                        CALL BINCHAR (KS_SUB_BUF_1.TEXT,LNKS);
     2868    11754    4                        KS_SUB_BUF_2.COUNT = OUT$->OUT$SYM.COUNT;
     2869    11755    4                        KS_SUB_BUF_2.TEXT = OUT$->OUT$SYM.TEXT;
     2870    11756    4                        CALL KSE$ERRMSG(%E$KS_TOOMANYLINKS,VECTOR(KS_SUB_BUF_1),VECTOR(
             11756                                 KS_SUB_BUF_2));
     2871    11757              /*E* ERROR:    KSN-E$KS_TOOMANYLINKS-0
     2872    11758         MESSAGE: Only %U1 links may be defined for this node.  Link .%U2 has not been defin
             11758        ed.
     2873    11759                  MESSAGE1: In order to define more links, set MAXLINKS to a higher value.*/
     2874    11760    4                     END;
     2875    11761    3                  ELSE
     2876    11762    4                     DO;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:462  
     2877    11763    4                        TEMP_LINK = '0'B;
     2878    11764    4                        OFFSET = 4 - OUT$->OUT$SYM.COUNT;
     2879    11765    5                        DO J = OFFSET TO 3;
     2880    11766    5                           CALL INDEX (TEMP,SUBSTR(OUT$->OUT$SYM.TEXT,J-OFFSET,1),
             11766                                    HEX_CHARS);
     2881    11767    5                           HEX$(J)->HEX = TEMP;
     2882    11768    5                        END;
     2883    11769    5   DUP_LINK_LOOP:       DO J = 0 TO KS_LINK.LINKS# - 1;
     2884    11770    5                           IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN
     2885    11771    5                              EXIT DUP_LINK_LOOP;
     2886    11772    5                        END;
     2887    11773
     2888    11774    4                        IF J = KS_LINK.LINKS# THEN
     2889    11775    5                           DO;
     2890    11776    5                              KS_LINK.CHANNEL(KS_LINK.LINKS#) = TEMP_LINK;
     2891    11777    5                              KS_LINK.LINKS# = KS_LINK.LINKS# + 1;
     2892    11778    5                           END;
     2893    11779    4                        ELSE
     2894    11780    5                           DO;
     2895    11781    5                              KS_SUB_BUF_1.COUNT = OUT$->OUT$SYM.COUNT;
     2896    11782    5                              KS_SUB_BUF_1.TEXT = OUT$->OUT$SYM.TEXT;
     2897    11783    5                             CALL BINCHAR (LINK_NR,J);
     2898    11784    5                             KS_SUB_BUF_2.TEXT = LINK_NR;
     2899    11785    5                             KS_SUB_BUF_2.COUNT = SIZEC(LINK_NR);
     2900    11786    5                              CALL KSE$ERRMSG(%E$KS_DUPLICATELINKS,
     2901    11787    5                                              VECTOR(KS_SUB_BUF_1),
     2902    11788    5                                              VECTOR(KS_SUB_BUF_2));
     2903    11789
     2904    11790                 /*E*  ERROR: KSN-E$KS_DUPLICATELINKS-0
     2905    11791                       MESSAGE:  .%U1 is a duplicate of link # %U2 */
     2906    11792    5                           END;
     2907    11793    4                     END;
     2908    11794    3               END;
     2909    11795    2              WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     2910    11796    2              WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     2911    11797    2              IF KS_LINK.LINKS# <= 0 THEN
     2912    11798    2                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) - 1;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:463  
     2913    11799    2              ELSE
     2914    11800    2                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +
     2915    11801    2                                           (SIZEC(KS_LINK.CHANNEL(0)) * KS_LINK.LINKS#)
             11801                                                    - 1;
     2916    11802    2              CALL M$WRITE (WRITE_NETCON) ALTRET(DEF_ERR);
     2917    11803
     2918    11804    2           END;  /* DO CASE */
     2919    11805    1   END KSC$DEFINE;
     2920    11806         %EOD;

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:464  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$DEFINE.

   Procedure KSC$DEFINE requires 1042 words for executable code.
   Procedure KSC$DEFINE requires 38 words of local(AUTO) storage.

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:465  

 Object Unit name= KSC$DEFINE                                 File name= KSC$COMMANDS2.:E05TOU
 UTS= JUL 30 '97 01:47:26.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none  3244   6254  KSC$DEFINE
    2  RoData even  UTS     20     24  KSC$DEFINE
    3   DCB   even  none     0      0  M$NETCON
    4   Proc  even  none  1042   2022  KSC$DEFINE
    5  RoData even  none    66    102  KSC$DEFINE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  KSC$DEFINE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  KS_NETWORK
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:466  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KSU$INIT_DEFCNFG
         yes           Std       4 KSE$ERRMSG
 yes     yes           Std       3 KSU$WRITE_NETCON
 yes     yes           Std       1 KSR$WR_HLPCG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODE
     KS_MSGBUF                             KS_MSGBUF$                            KS_SUB_BUF_1
     KS_SUB_BUF_2                          KS_HAND_INFO                          B$TCB$
     KS_TBL                                M$NETCON                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:467  


     2396        1        /*T***********************************************************/
     2397        2        /*T*                                                         */
     2398        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2399        4        /*T*                                                         */
     2400        5        /*T***********************************************************/
     2401        6        KSC$DEFINE: PROC(TOP$) ALTRET;

      6  4 000000   000000 700200 xent  KSC$DEFINE   TSX0  ! X66_AUTO_1
         4 000001   000046 000001                    ZERO    38,1

     2402        7        /**/
     2403        8    1   DCL TOP$ PTR;
     2404        9        /**/
     2405       10        %INCLUDE CP_6;
     2406       91        %INCLUDE KL_MACRO_C;
     2407     3443        %INCLUDE KL_CONFIG_M;
     2408     4205        %INCLUDE KL_CONTROL_C;
     2409     4585        %INCLUDE GI_BOOT_C;
     2410     4696        %INCLUDE KS_MACRO_M;
     2411     4893        %INCLUDE KS_SUBS_C;
     2412     5136        %INCLUDE KS_DATA_R;
     2413     5151        %INCLUDE KS_PERR_C;
     2414     5218        %INCLUDE F$DCB;
     2415     5267        %INCLUDE XU_MACRO_C;
     2416     8373        %INCLUDE B_ERRORS_C;
     2417     9500        %INCLUDE CP_6_SUBS;
     2418    10040        %INCLUDE            KL_AFCN_C;
     2419    10141        %KS$BOX(TITLE="entry defs");

             10159    1   /***************************************************************************
             10160    1    *                                                                         *
             10161    1    *                                 entry defs                              *
             10162    1    *                                                                         *
             10163    1    ***************************************************************************/

     2420    10168    1   DCL KSE$ERRMSG ENTRY(4);
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:468  
     2421    10169    1   DCL                 KSR$WR_HLPCG ENTRY(1) ALTRET;
     2422    10170    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
     2423    10171    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
     2424    10172        %KS$BOX(TITLE="symref variables");

             10190    1   /***************************************************************************
             10191    1    *                                                                         *
             10192    1    *                              symref variables                           *
             10193    1    *                                                                         *
             10194    1    ***************************************************************************/

     2425    10199        %KS$HAND_INFO (NAME=KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF",LAST=YES);
     2426    10238    1   DCL B$TCB$ PTR SYMREF;
     2427    10239    1   DCL KS_TBL(0:0) PTR SYMREF;
     2428    10240        %KS$BOX(TITLE="symdef variables");

             10258    1   /***************************************************************************
             10259    1    *                                                                         *
             10260    1    *                              symdef variables                           *
             10261    1    *                                                                         *
             10262    1    ***************************************************************************/

     2429    10267        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS="STATIC SYMDEF");
     2430    10294        %KS$BOX(TITLE="constant variables");

             10312    1   /***************************************************************************
             10313    1    *                                                                         *
             10314    1    *                             constant variables                          *
             10315    1    *                                                                         *
             10316    1    ***************************************************************************/

     2431    10321    1   DCL HEX_CHARS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
     2432    10322        %KS$BOX(TITLE="static variables");

             10340    1   /***************************************************************************
             10341    1    *                                                                         *
             10342    1    *                              static variables                           *
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:469  
             10343    1    *                                                                         *
             10344    1    ***************************************************************************/

     2433    10349        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
     2434    10368        %KL$LINK_KEY (NAME=KS_LINK_KEY,STCLASS=STATIC);
     2435    10386        %KL$FEPBOOT (NAME=KS_FEPBOOT,NUM=GI_BOOT_HI,STCLASS=STATIC);
     2436    10411        %KL$FEPBOOT_KEY (NAME=KS_FEPBOOT_KEY,STCLASS=STATIC);
     2437    10429    1         DCL   HEX$(0:3)   PTR  STATIC INIT(
     2438    10430    1                                          ADDR(TEMP_LINK.HEX0),
     2439    10431    1                                          ADDR(TEMP_LINK.HEX1),
     2440    10432    1                                          ADDR(TEMP_LINK.HEX2),
     2441    10433    1                                          ADDR(TEMP_LINK.HEX3));
     2442    10434    1   DCL   1  TEMP_LINK   STATIC,
     2443    10435    1            2  *        BIT(1) UNAL,
     2444    10436    1            2  HEX0     UBIN(4) UNAL,
     2445    10437    1            2  HEX1     UBIN(4) UNAL,
     2446    10438    1            2  *        BIT(1)  UNAL,
     2447    10439    1            2  HEX2     UBIN(4) UNAL,
     2448    10440    1            2  HEX3     UBIN(4) UNAL;
     2449    10441        %KL$FEPCTL (NAME=KS_FEPCTL,NUM=GI_CNTL_BOOTHI,STCLASS=STATIC);
     2450    10461        %KL$FEPCTL_KEY (NAME=KS_FEPCTL_KEY,STCLASS=STATIC);
     2451    10479        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
     2452    10509        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
     2453    10527        %KL$PSEUDO (NAME=KS_PSEUDO,NUM=50,STCLASS=STATIC);
     2454    10571        %KL$PSEUDO_KEY (NAME=KS_PSEUDO_KEY,STCLASS=STATIC);
     2455    10589        %KL$NODEINFO (NAME=KS_NODEINFO,STCLASS=STATIC);
     2456    10606        %KL$NODEINFO_KEY (NAME=KS_NODEINFO_KEY,STCLASS=STATIC);
     2457    10623        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
     2458    10642    1        DCL   DEFAULT_BUF (0:49) UBIN WORD STATIC INIT(0*0);
     2459    10643    1        DCL   DEFAULT$ PTR STATIC INIT(ADDR(DEFAULT_BUF));
     2460    10644    1   DCL HNDLR$ PTR STATIC INIT(ADDR(HNDLR_BUF));
     2461    10645    1   DCL HNDLR_BUF(0:400) CHAR(1) STATIC;
     2462    10646        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
     2463    10663    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
     2464    10664    1        2  CNT UBIN BYTE UNAL INIT(1),
     2465    10665    1       2  TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
     2466    10666        %KL$NETWORK         (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:470  
     2467    10693    1   DCL                 HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
     2468    10694        %KS$BOX(TITLE="based variables");

             10712    1   /***************************************************************************
             10713    1    *                                                                         *
             10714    1    *                              based variables                            *
             10715    1    *                                                                         *
             10716    1    ***************************************************************************/

     2469    10721    1   DCL B$PARAMI(0:0) UBIN HALF BASED HALIGNED;
     2470    10722
     2471    10723        %KS$PARAM(NAME=KS$PARAM,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
     2472    10793        %KL$LINCNFG(NAME=KS_DEFAULT,STCLASS="BASED(DEFAULT$)");
     2473    10951        %B$TCB;
     2474    10954        %B$ALT;
     2475    10962        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
     2476    11007        %PARSE$SYM (NAME=OUT$SYM,STCLASS=BASED);
     2477    11045        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_FIXED_HI,STCLASS="BASED(HNDLR$)");
     2478    11108    1   DCL   HEX   UBIN(4)  BASED UNAL;
     2479    11109        %KL_HDR(FPTN=UPDATE,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     2480    11189        %KS$BOX(TITLE="auto variables",PAGE=YES);

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:471  
             11207    1   /***************************************************************************
             11208    1    *                                                                         *
             11209    1    *                               auto variables                            *
             11210    1    *                                                                         *
             11211    1    ***************************************************************************/

     2481    11216    1   DCL NODENAME CHAR(8);
     2482    11217    1   DCL                 NRLINKS SBIN;
     2483    11218    1   DCL                 LINK_LIST(0:10)  CHAR(4);
     2484    11219    1   DCL I UBIN;
     2485    11220    1   DCL FEX UBIN;
     2486    11221    1   DCL NODETYPE UBIN;
     2487    11222    1   DCL CONTROL_NODE CHAR(8);
     2488    11223    1   DCL OUT$ PTR;
     2489    11224    1   DCL DFLT$ PTR;
     2490    11225    1   DCL DFLT_OPT$ PTR;
     2491    11226    1   DCL K UBIN;
     2492    11227    1   DCL HAND# UBIN;
     2493    11228    1   DCL L UBIN;
     2494    11229    1   DCL J SBIN;
     2495    11230    1   DCL TEMP UBIN;
     2496    11231    1   DCL   LNKS  UBIN;
     2497    11232    1   DCL   OFFSET   UBIN;
     2498    11233    1       DCL LINK_NR CHAR(1);
     2499    11234        %KS$BOX(TITLE="FPTs, VLPs and such",PAGE=YES);

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:472  
             11252    1   /***************************************************************************
             11253    1    *                                                                         *
             11254    1    *                            FPTs, VLPs and such                          *
             11255    1    *                                                                         *
             11256    1    ***************************************************************************/

     2500    11261        %FPT_READ (FPTN=READ_NETCON,
     2501    11262                   DCB=M$NETCON,
     2502    11263                   KEYS=YES);
     2503    11302        %FPT_WRITE (FPTN=WRITE_NETCON,
     2504    11303                    DCB=M$NETCON);
     2505    11334        %FPT_MONINFO(FPTN = KS_MONINFO,
     2506    11335                     MONINFO = KS_MONINFO_V);
     2507    11350        %VLR_MONINFO(FPTN = KS_MONINFO_V);
     2508    11368        %KS$BOX(TITLE="DCBs");

             11386    1   /***************************************************************************
             11387    1    *                                                                         *
             11388    1    *                                    DCBs                                 *
             11389    1    *                                                                         *
             11390    1    ***************************************************************************/

     2509    11395    1   DCL M$NETCON DCB;
     2510    11396        %EJECT;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:473  
     2511    11397    2        DO CASE(OUT$BLK.CODE);

  11397  4 000002   200003 470500                    LDP0    @TOP$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   100000 720100                    LXL0    0,,PR1
         4 000005   000007 100003                    CMPX0   7,DU
         4 000006   000010 602010 4                  TNC     s:11397+6,X0
         4 000007   002021 710000 4                  TRA     s:11805
         4 000010   002021 710000 4                  TRA     s:11805
         4 000011   000017 710000 4                  TRA     s:11399
         4 000012   002021 710000 4                  TRA     s:11805
         4 000013   002021 710000 4                  TRA     s:11805
         4 000014   002021 710000 4                  TRA     s:11805
         4 000015   002021 710000 4                  TRA     s:11805
         4 000016   001536 710000 4                  TRA     s:11729

     2512    11398    2           CASE(%KS_NODE);

     2513    11399    2              CALL CHARBIN(FEX,OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  11399  4 000017   100003 473500                    LDP3    3,,PR1
         4 000020   300004 236100                    LDQ     4,,PR3
         4 000021   000033 772000                    QRL     27
         4 000022   000000 621006                    EAX1    0,QL
         4 000023   000100 305540                    DTB
         4 000024   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 000025   200042 000010                    NDSC9   LINK_NR+1,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 000026   200043 235100                    LDA     LINK_NR+2,,AUTO
         4 000027   200023 755100                    STA     FEX,,AUTO

     2514    11400    2              CALL BINCHAR(NODENAME,FEX);

  11400  4 000030   000044 773000                    LRL     36
         4 000031   200042 757100                    STAQ    LINK_NR+1,,AUTO
         4 000032   000100 301500                    BTD
         4 000033   200042 000010                    NDSC9   LINK_NR+1,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 000034   200004 030010                    NDSC9   NODENAME,,AUTO           cn=0,s=nosgn,sf=0,n=8
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:474  

     2515    11401    2              SUBSTR(NODENAME,0,4) = 'NODE';

  11401  4 000035   000004 236000 2                  LDQ     HEX_CHARS+4
         4 000036   200004 756100                    STQ     NODENAME,,AUTO

     2516    11402    2              NODETYPE = %KS_FEP;

  11402  4 000037   000002 235007                    LDA     2,DL
         4 000040   200024 755100                    STA     NODETYPE,,AUTO

     2517    11403    2              CALL M$MONINFO(KS_MONINFO) ALTRET(DEF_ERR);

  11403  4 000041   006220 630400 1                  EPPR0   KS_MONINFO
         4 000042   420023 713400                    CLIMB   alt,+8211
         4 000043   402400 401760                    pmme    nvectors=6
         4 000044   001525 702000 4                  TSX2    DEF_ERR

     2518    11404    2              CONTROL_NODE = KS_MONINFO_V.NODE_NAME;

  11404  4 000045   006246 237000 1                  LDAQ    KS_MONINFO_V+10
         4 000046   200025 755100                    STA     CONTROL_NODE,,AUTO
         4 000047   200026 756100                    STQ     CONTROL_NODE+1,,AUTO

     2519    11405    2             NRLINKS = 0;

  11405  4 000050   200006 450100                    STZ     NRLINKS,,AUTO

     2520    11406
     2521    11407    3              DO I = 1 TO OUT$BLK.NSUBLKS-1;

  11407  4 000051   000001 235007                    LDA     1,DL
         4 000052   200022 755100                    STA     I,,AUTO
         4 000053   000150 710000 4                  TRA     s:11425+3

     2522    11408    4                 DO CASE (OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:475  
  11408  4 000054   200003 470500                    LDP0    @TOP$,,AUTO
         4 000055   000000 471500                    LDP1    0,,PR0
         4 000056   200022 720100                    LXL0    I,,AUTO
         4 000057   100003 473510                    LDP3    3,X0,PR1
         4 000060   300000 721100                    LXL1    0,,PR3
         4 000061   000005 101003                    CMPX1   5,DU
         4 000062   000064 602011 4                  TNC     s:11408+8,X1
         4 000063   000145 710000 4                  TRA     s:11425
         4 000064   000145 710000 4                  TRA     s:11425
         4 000065   000071 710000 4                  TRA     s:11411
         4 000066   000101 710000 4                  TRA     s:11414
         4 000067   000106 710000 4                  TRA     s:11417
         4 000070   000116 710000 4                  TRA     s:11419

     2523    11409
     2524    11410    4                  CASE (%KS_NAME);

     2525    11411    4                    NODENAME = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11411  4 000071   300003 474500                    LDP4    3,,PR3
         4 000072   400004 236100                    LDQ     4,,PR4
         4 000073   000033 772000                    QRL     27
         4 000074   000000 622006                    EAX2    0,QL
         4 000075   040100 100540                    MLR     fill='040'O
         4 000076   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000077   200004 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000100   000145 710000 4                  TRA     s:11425

     2526    11412
     2527    11413    4                  CASE (%KS_TYPE);

     2528    11414    4                    NODETYPE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  11414  4 000101   300003 474500                    LDP4    3,,PR3
         4 000102   400000 236100                    LDQ     0,,PR4
         4 000103   777777 376007                    ANQ     -1,DL
         4 000104   200024 756100                    STQ     NODETYPE,,AUTO
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:476  
         4 000105   000145 710000 4                  TRA     s:11425

     2529    11415
     2530    11416    4                  CASE (%KS_CONT);

     2531    11417    4                    CONTROL_NODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11417  4 000106   300003 474500                    LDP4    3,,PR3
         4 000107   400004 236100                    LDQ     4,,PR4
         4 000110   000033 772000                    QRL     27
         4 000111   000000 622006                    EAX2    0,QL
         4 000112   040100 100540                    MLR     fill='040'O
         4 000113   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000114   200025 000010                    ADSC9   CONTROL_NODE,,AUTO       cn=0,n=8
         4 000115   000145 710000 4                  TRA     s:11425

     2532    11418    4                   CASE (%KS_LINK);

     2533    11419    4                      NRLINKS = OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS;

  11419  4 000116   300001 236100                    LDQ     1,,PR3
         4 000117   000022 772000                    QRL     18
         4 000120   200006 756100                    STQ     NRLINKS,,AUTO

     2534    11420    5                      DO J = 0 TO NRLINKS - 1;

  11420  4 000121   200035 450100                    STZ     J,,AUTO
         4 000122   000142 710000 4                  TRA     s:11422+1

     2535    11421    5                         LINK_LIST(J) = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$SYM.
             11421                                  TEXT;

  11421  4 000123   200003 470500                    LDP0    @TOP$,,AUTO
         4 000124   000000 471500                    LDP1    0,,PR0
         4 000125   200022 720100                    LXL0    I,,AUTO
         4 000126   100003 473510                    LDP3    3,X0,PR1
         4 000127   200035 721100                    LXL1    J,,AUTO
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:477  
         4 000130   300003 474511                    LDP4    3,X1,PR3
         4 000131   400004 236100                    LDQ     4,,PR4
         4 000132   000033 772000                    QRL     27
         4 000133   200035 235100                    LDA     J,,AUTO
         4 000134   000002 735000                    ALS     2
         4 000135   000000 622006                    EAX2    0,QL
         4 000136   040105 100540                    MLR     fill='040'O
         4 000137   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000140   200007 000004                    ADSC9   LINK_LIST,A,AUTO         cn=0,n=4

     2536    11422    5                      END;

  11422  4 000141   200035 054100                    AOS     J,,AUTO
         4 000142   200035 236100                    LDQ     J,,AUTO
         4 000143   200006 116100                    CMPQ    NRLINKS,,AUTO
         4 000144   000123 604000 4                  TMI     s:11421

     2537    11423
     2538    11424    4                  END;

     2539    11425    3                 END;

  11425  4 000145   200022 235100                    LDA     I,,AUTO
         4 000146   000001 035007                    ADLA    1,DL
         4 000147   200022 755100                    STA     I,,AUTO
         4 000150   200003 470500                    LDP0    @TOP$,,AUTO
         4 000151   000000 471500                    LDP1    0,,PR0
         4 000152   100001 236100                    LDQ     1,,PR1
         4 000153   000022 772000                    QRL     18
         4 000154   200022 116100                    CMPQ    I,,AUTO
         4 000155   000157 600000 4                  TZE     s:11427
         4 000156   000054 603000 4                  TRC     s:11408

     2540    11426
     2541    11427    2              KS_SUB_BUF_1.TEXT = NODENAME;

  11427  4 000157   040000 100500                    MLR     fill='040'O
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:478  
         4 000160   200004 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000161   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2542    11428    2              KS_SUB_BUF_1.COUNT = SIZEC(NODENAME);

  11428  4 000162   010000 236003                    LDQ     4096,DU
         4 000163   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2543    11429    2              IF NODETYPE = %KS_RFEP AND NRLINKS = 0 THEN

  11429  4 000164   200024 235100                    LDA     NODETYPE,,AUTO
         4 000165   000005 115007                    CMPA    5,DL
         4 000166   000176 601000 4                  TNZ     s:11436
         4 000167   200006 235100                    LDA     NRLINKS,,AUTO
         4 000170   000176 601000 4                  TNZ     s:11436

     2544    11430    3                DO;

     2545    11431    3                   CALL KSE$ERRMSG (%E$KS_RFEP_WITH_NO_LINKS-0,VECTOR(KS_SUB_BUF_1));

  11431  4 000171   000003 630400 5                  EPPR0   3
         4 000172   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000173   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000174   000000 011000                    NOP     0

     2546    11432                         /*E* ERROR:  KSN-E$KS_RFEP_WITH_NO_LINKS_0
     2547    11433          MESSAGE: A link must be defined on a RFEP node. Node %U1 has not been defined. */
     2548    11434    3                   RETURN;

  11434  4 000175   000000 702200 xent               TSX2  ! X66_ARET

     2549    11435    3                END;
     2550    11436    2              IF NODETYPE = %KS_ME OR NODETYPE = %KS_HOST THEN

  11436  4 000176   200024 235100                    LDA     NODETYPE,,AUTO
         4 000177   000003 115007                    CMPA    3,DL
         4 000200   000203 600000 4                  TZE     s:11437
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:479  
         4 000201   000001 115007                    CMPA    1,DL
         4 000202   000207 601000 4                  TNZ     s:11438

     2551    11437    2                 CONTROL_NODE = ' ';

  11437  4 000203   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000204   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000205   200025 755100                    STA     CONTROL_NODE,,AUTO
         4 000206   200026 756100                    STQ     CONTROL_NODE+1,,AUTO

     2552    11438    2     IF FEX > KS_MONINFO_V.NUM_NODES - 1 THEN

  11438  4 000207   200023 236100                    LDQ     FEX,,AUTO
         4 000210   006250 116000 1                  CMPQ    KS_MONINFO_V+12
         4 000211   000232 602000 4                  TNC     s:11450

     2553    11439    3                DO;

     2554    11440    3                 CALL BINCHAR(KS_SUB_BUF_1.TEXT,KS_MONINFO_V.NUM_NODES - 1);

  11440  4 000212   006250 235000 1                  LDA     KS_MONINFO_V+12
         4 000213   000001 135007                    SBLA    1,DL
         4 000214   200042 755100                    STA     LINK_NR+1,,AUTO
         4 000215   000000 301500                    BTD
         4 000216   200042 000004                    NDSC9   LINK_NR+1,,AUTO          cn=0,s=lsgnf,sf=0,n=4
         4 000217   000000 230037 xsym               NDSC9   KS_SUB_BUF_1             cn=1,s=nosgn,sf=0,n=31

     2555    11441    3                 KS_SUB_BUF_1.TEXT = SUBSTR(KS_SUB_BUF_1.TEXT,28,3);

  11441  4 000220   040000 100400                    MLR     fill='040'O
         4 000221   000007 200003 xsym               ADSC9   KS_SUB_BUF_1+7           cn=1,n=3
         4 000222   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2556    11442    3                   KS_SUB_BUF_1.COUNT = 3;

  11442  4 000223   003000 236003                    LDQ     1536,DU
         4 000224   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:480  

     2557    11443    3                   CALL KSE$ERRMSG (%E$KS_MAX_NODE-0,VECTOR(KS_SUB_BUF_1));

  11443  4 000225   000006 630400 5                  EPPR0   6
         4 000226   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000227   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000230   000000 011000                    NOP     0

     2558    11444                         /*E* ERROR:  KSN-E$KS_MAX_NODE-0
     2559    11445                              MESSAGE: Node %U1 is the largest node that may be defined.
     2560    11446                              DESCRIPTION: The largest node number is set in TIGR
     2561    11447                                  above which NETCON can not define a node. */
     2562    11448    3                   RETURN;

  11448  4 000231   000000 702200 xent               TSX2  ! X66_ARET

     2563    11449    3                END;
     2564    11450    2              READ_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  11450  4 000232   000010 237000 5                  LDAQ    8
         4 000233   006170 757000 1                  STAQ    READ_NETCON+2

     2565    11451    2              READ_NETCON.BUF_ = VECTOR(KS_NETWORK);

  11451  4 000234   000012 237000 5                  LDAQ    10
         4 000235   006172 757000 1                  STAQ    READ_NETCON+4

     2566    11452    3              CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  11452  4 000236   006166 630400 1                  EPPR0   READ_NETCON
         4 000237   440000 713400                    CLIMB   alt,read
         4 000240   401400 401760                    pmme    nvectors=4
         4 000241   000243 702000 4                  TSX2    s:11453
         4 000242   000251 710000 4                  TRA     s:11456

     2567    11453    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE ~= %E$NOKEY

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:481  
  11453  4 000243   000000 470400 xsym               LDP0    B$TCB$
         4 000244   000000 471500                    LDP1    0,,PR0
         4 000245   100102 236100                    LDQ     66,,PR1
         4 000246   377770 376007                    ANQ     131064,DL
         4 000247   001020 116007                    CMPQ    528,DL
         4 000250   001525 601000 4                  TNZ     DEF_ERR

     2568    11454    3                    THEN GOTO DEF_ERR;
     2569    11455    3                 END;  /* WHENALTRETURN */

     2570    11456    2             READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);

  11456  4 000251   000014 237000 5                  LDAQ    12
         4 000252   006170 757000 1                  STAQ    READ_NETCON+2

     2571    11457    2             READ_NETCON.BUF_ = VECTOR(KS_RFEP);

  11457  4 000253   000016 237000 5                  LDAQ    14
         4 000254   006172 757000 1                  STAQ    READ_NETCON+4

     2572    11458    3             CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  11458  4 000255   006166 630400 1                  EPPR0   READ_NETCON
         4 000256   440000 713400                    CLIMB   alt,read
         4 000257   401400 401760                    pmme    nvectors=4
         4 000260   000262 702000 4                  TSX2    s:11459
         4 000261   000266 710000 4                  TRA     s:11461

     2573    11459    3                KS_RFEP = KS_NETWORK;

  11459  4 000262   012004 220003                    LDX0    5124,DU
         4 000263   000040 100440                    MLR     fill='000'O
         4 000264   000000 000010 1                  ADSC9   KS_NETWORK               cn=0,n=*X0
         4 000265   003564 000010 1                  ADSC9   KS_RFEP                  cn=0,n=*X0

     2574    11460    3                END;  /* WHENALTRETURN */

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:482  
     2575    11461    2              IF KS_NETWORK.NODE.NODE(FEX) ~= ' ' THEN

  11461  4 000266   200023 236100                    LDQ     FEX,,AUTO
         4 000267   000024 402007                    MPY     20,DL
         4 000270   040000 106406                    CMPC    fill='040'O
         4 000271   000002 000010 1                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000272   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000273   000320 600000 4                  TZE     s:11471

     2576    11462    3                 DO;

     2577    11463    3                    KS_SUB_BUF_1.COUNT = SIZEC(OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  11463  4 000274   200003 470500                    LDP0    @TOP$,,AUTO
         4 000275   000000 471500                    LDP1    0,,PR0
         4 000276   100003 473500                    LDP3    3,,PR1
         4 000277   300004 236100                    LDQ     4,,PR3
         4 000300   000033 772000                    QRL     27
         4 000301   000033 736000                    QLS     27
         4 000302   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2578    11464    3                    KS_SUB_BUF_1.TEXT = OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11464  4 000303   000000 471500                    LDP1    0,,PR0
         4 000304   100003 473500                    LDP3    3,,PR1
         4 000305   300004 236100                    LDQ     4,,PR3
         4 000306   000033 772000                    QRL     27
         4 000307   000000 620006                    EAX0    0,QL
         4 000310   040000 100540                    MLR     fill='040'O
         4 000311   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000312   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2579    11465    3                    CALL KSE$ERRMSG(%E$KS_DUP_NODE,VECTOR(KS_SUB_BUF_1));

  11465  4 000313   000021 630400 5                  EPPR0   17
         4 000314   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000315   000000 701000 xent               TSX1    KSE$ERRMSG
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:483  
         4 000316   000000 011000                    NOP     0

     2580    11466                         /*E* ERROR: KSN-E$KS_DUP_NODE-0
     2581    11467                              MESSAGE: Node %U1 is already defined.
     2582    11468                              DESCRIPTION: SEE MESSAGE */
     2583    11469    3                    RETURN;

  11469  4 000317   000000 702200 xent               TSX2  ! X66_ARET

     2584    11470    3                 END;  /* IF */
     2585    11471    2              KS_NETWORK.NODE# = KS_MONINFO_V.NUM_NODES;

  11471  4 000320   006250 235000 1                  LDA     KS_MONINFO_V+12
         4 000321   000000 755000 1                  STA     KS_NETWORK

     2586    11472    3              DO I = 0 TO KS_NETWORK.NODE#;

  11472  4 000322   200022 450100                    STZ     I,,AUTO
         4 000323   000423 710000 4                  TRA     s:11501+3

     2587    11473    3                 IF KS_NETWORK.NODE.NODE(I) = NODENAME

  11473  4 000324   200022 236100                    LDQ     I,,AUTO
         4 000325   000024 402007                    MPY     20,DL
         4 000326   040100 106406                    CMPC    fill='040'O
         4 000327   000002 000010 1                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000330   200004 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000331   000346 601000 4                  TNZ     s:11481

     2588    11474    3                    THEN
     2589    11475    4                    DO;

     2590    11476    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));

  11476  4 000332   010000 236003                    LDQ     4096,DU
         4 000333   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:484  
     2591    11477    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11477  4 000334   200022 236100                    LDQ     I,,AUTO
         4 000335   000024 402007                    MPY     20,DL
         4 000336   040000 100406                    MLR     fill='040'O
         4 000337   000002 000010 1                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000340   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2592    11478    4                       CALL KSE$ERRMSG(%E$KS_DUP_NODE,VECTOR(KS_SUB_BUF_1));

  11478  4 000341   000021 630400 5                  EPPR0   17
         4 000342   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000343   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000344   000000 011000                    NOP     0

     2593    11479    4                       RETURN;

  11479  4 000345   000000 702200 xent               TSX2  ! X66_ARET

     2594    11480    4                    END;  /* IF */
     2595    11481    3                 ELSE IF CONTROL_NODE = KS_NETWORK.NODE.NODE(I) AND

  11481  4 000346   040006 106500                    CMPC    fill='040'O
         4 000347   200025 000010                    ADSC9   CONTROL_NODE,,AUTO       cn=0,n=8
         4 000350   000002 000010 1                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000351   000372 601000 4                  TNZ     s:11491
         4 000352   040000 106500                    CMPC    fill='040'O
         4 000353   200025 000010                    ADSC9   CONTROL_NODE,,AUTO       cn=0,n=8
         4 000354   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000355   000372 600000 4                  TZE     s:11491
         4 000356   200022 236100                    LDQ     I,,AUTO
         4 000357   000005 402007                    MPY     5,DL
         4 000360   000001 235006 1                  LDA     KS_NETWORK+1,QL
         4 000361   000001 115007                    CMPA    1,DL
         4 000362   000372 600000 4                  TZE     s:11491
         4 000363   000003 115007                    CMPA    3,DL
         4 000364   000372 600000 4                  TZE     s:11491
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:485  

     2596    11482    3                        CONTROL_NODE ~= ' ' AND
     2597    11483    3                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_HOST AND
     2598    11484    3                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_ME)) THEN
     2599    11485    4                         DO;

     2600    11486    4                            CALL KSE$ERRMSG (%E$KS_CNTRL_NOT_HOST);

  11486  4 000365   000023 630400 5                  EPPR0   19
         4 000366   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000367   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000370   000000 011000                    NOP     0

     2601    11487                                 /*E* ERROR:  KSN-E$KS_CNTRL_NOT_HOST-0
     2602    11488                    MESSAGE: WARNING: The control node specified is not of type host or me.
     2603    11489                                      DESCRIPTION:  SEE MESSAGE */
     2604    11490    4                         END;

  11490  4 000371   000420 710000 4                  TRA     s:11501

     2605    11491    3                  ELSE IF KS_NETWORK.NODE.CONTROL_NODE(I) = NODENAME AND

  11491  4 000372   200022 236100                    LDQ     I,,AUTO
         4 000373   000024 402007                    MPY     20,DL
         4 000374   040100 106406                    CMPC    fill='040'O
         4 000375   000004 000010 1                  ADSC9   KS_NETWORK+4,Q           cn=0,n=8
         4 000376   200004 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000377   000420 601000 4                  TNZ     s:11501
         4 000400   200024 235100                    LDA     NODETYPE,,AUTO
         4 000401   000001 115007                    CMPA    1,DL
         4 000402   000420 600000 4                  TZE     s:11501
         4 000403   000003 115007                    CMPA    3,DL
         4 000404   000420 600000 4                  TZE     s:11501

     2606    11492    3                       (NODETYPE ~= %KS_HOST AND NODETYPE ~=%KS_ME) THEN
     2607    11493    4                          DO;

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:486  
     2608    11494    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));

  11494  4 000405   010000 236003                    LDQ     4096,DU
         4 000406   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2609    11495    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11495  4 000407   200022 236100                    LDQ     I,,AUTO
         4 000410   000024 402007                    MPY     20,DL
         4 000411   040000 100406                    MLR     fill='040'O
         4 000412   000002 000010 1                  ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000413   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2610    11496    4                            CALL KSE$ERRMSG (%E$KS_NODE_NOT_CNTRL, VECTOR(KS_SUB_BUF_1
             11496                                      ));

  11496  4 000414   000024 630400 5                  EPPR0   20
         4 000415   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000416   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000417   000000 011000                    NOP     0

     2611    11497                                  /*E* ERROR: KSN-E$KS_NODE_NOT_CNTRL-0
     2612    11498        MESSAGE: WARNING: %U1 specifies this node as a control node, but this node is not H
             11498        OST or ME.
     2613    11499                                       DESCRIPTION:  SEE MESSAGE */
     2614    11500    4                          END;

     2615    11501    3               END;

  11501  4 000420   200022 235100                    LDA     I,,AUTO
         4 000421   000001 035007                    ADLA    1,DL
         4 000422   200022 755100                    STA     I,,AUTO
         4 000423   000000 236000 1                  LDQ     KS_NETWORK
         4 000424   200022 116100                    CMPQ    I,,AUTO
         4 000425   000324 603000 4                  TRC     s:11473

     2616    11502
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:487  
     2617    11503    2              IF FEX > KS_NETWORK.NODE#

  11503  4 000426   200023 116100                    CMPQ    FEX,,AUTO
         4 000427   000461 603000 4                  TRC     s:11514

     2618    11504    3              THEN DO;

     2619    11505    4                 DO I = KS_NETWORK.NODE#+1 TO FEX;

  11505  4 000430   000001 036007                    ADLQ    1,DL
         4 000431   200022 756100                    STQ     I,,AUTO
         4 000432   000454 710000 4                  TRA     s:11510+3

     2620    11506    4                    KS_NETWORK.NODE.TYPE(I) = 0;

  11506  4 000433   200022 236100                    LDQ     I,,AUTO
         4 000434   000005 402007                    MPY     5,DL
         4 000435   000001 450006 1                  STZ     KS_NETWORK+1,QL

     2621    11507    4                    KS_NETWORK.NODE.NODE(I) = ' ';

  11507  4 000436   000000 620006                    EAX0    0,QL
         4 000437   000000 621006                    EAX1    0,QL
         4 000440   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000441   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000442   000002 755010 1                  STA     KS_NETWORK+2,X0
         4 000443   000003 756011 1                  STQ     KS_NETWORK+3,X1

     2622    11508    4                   KS_RFEP.NODE.TYPE(I) = 0;

  11508  4 000444   003565 450010 1                  STZ     KS_RFEP+1,X0

     2623    11509    4                   KS_RFEP.NODE.NODE(I) = ' ';

  11509  4 000445   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000446   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000447   003566 755010 1                  STA     KS_RFEP+2,X0
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:488  
         4 000450   003567 756010 1                  STQ     KS_RFEP+3,X0

     2624    11510    4                    END;

  11510  4 000451   200022 235100                    LDA     I,,AUTO
         4 000452   000001 035007                    ADLA    1,DL
         4 000453   200022 755100                    STA     I,,AUTO
         4 000454   200023 236100                    LDQ     FEX,,AUTO
         4 000455   200022 116100                    CMPQ    I,,AUTO
         4 000456   000433 603000 4                  TRC     s:11506

     2625    11511    3                 KS_NETWORK.NODE# = FEX;

  11511  4 000457   000000 756000 1                  STQ     KS_NETWORK

     2626    11512    3                KS_RFEP.NODE# = FEX;

  11512  4 000460   003564 756000 1                  STQ     KS_RFEP

     2627    11513    3                 END;

     2628    11514    2             KS_NETWORK.NODE.TYPE(FEX) = NODETYPE;

  11514  4 000461   200023 236100                    LDQ     FEX,,AUTO
         4 000462   000005 402007                    MPY     5,DL
         4 000463   200024 235100                    LDA     NODETYPE,,AUTO
         4 000464   000001 755006 1                  STA     KS_NETWORK+1,QL

     2629    11515    2             KS_RFEP.NODE.TYPE(FEX) = NODETYPE;

  11515  4 000465   003565 755006 1                  STA     KS_RFEP+1,QL

     2630    11516    2              IF NODETYPE = %KS_RFEP THEN

  11516  4 000466   000005 115007                    CMPA    5,DL
         4 000467   000472 601000 4                  TNZ     s:11518

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:489  
     2631    11517    2                KS_NETWORK.NODE.TYPE(FEX) = %KS_FEP;

  11517  4 000470   000002 235007                    LDA     2,DL
         4 000471   000001 755006 1                  STA     KS_NETWORK+1,QL

     2632    11518    2             KS_NETWORK.NODE.NODE(FEX) = NODENAME;

  11518  4 000472   000000 620006                    EAX0    0,QL
         4 000473   000000 621006                    EAX1    0,QL
         4 000474   200004 237100                    LDAQ    NODENAME,,AUTO
         4 000475   000002 755010 1                  STA     KS_NETWORK+2,X0
         4 000476   000003 756011 1                  STQ     KS_NETWORK+3,X1

     2633    11519    2             KS_NETWORK.NODE.CONTROL_NODE(FEX) = CONTROL_NODE;

  11519  4 000477   000000 635010                    EAA     0,X0
         4 000500   000020 771000                    ARL     16
         4 000501   040005 100500                    MLR     fill='040'O
         4 000502   200025 000010                    ADSC9   CONTROL_NODE,,AUTO       cn=0,n=8
         4 000503   000004 000010 1                  ADSC9   KS_NETWORK+4,A           cn=0,n=8

     2634    11520    2             WRITE_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  11520  4 000504   000010 237000 5                  LDAQ    8
         4 000505   006206 757000 1                  STAQ    WRITE_NETCON+2

     2635    11521    2             WRITE_NETCON.BUF_ = VECTOR(KS_NETWORK);

  11521  4 000506   000012 237000 5                  LDAQ    10
         4 000507   006210 757000 1                  STAQ    WRITE_NETCON+4

     2636    11522    2                WRITE_NETCON.BUF_.BOUND = SIZEV(KS_NETWORK) - SIZEC(KS_NETWORK.NODE) +

  11522  4 000510   000000 236000 1                  LDQ     KS_NETWORK
         4 000511   000024 402007                    MPY     20,DL
         4 000512   000003 036007                    ADLQ    3,DL
         4 000513   000020 736000                    QLS     16
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:490  
         4 000514   006210 676000 1                  ERQ     WRITE_NETCON+4
         4 000515   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000516   006210 656000 1                  ERSQ    WRITE_NETCON+4

     2637    11523    2                   KS_NETWORK.NODE#*SIZEC(KS_NETWORK.NODE(0));
     2638    11524    2             CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);

  11524  4 000517   006204 630400 1                  EPPR0   WRITE_NETCON
         4 000520   440001 713400                    CLIMB   alt,write
         4 000521   401400 401760                    pmme    nvectors=4
         4 000522   001525 702000 4                  TSX2    DEF_ERR

     2639    11525    2             WRITE_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);

  11525  4 000523   000014 237000 5                  LDAQ    12
         4 000524   006206 757000 1                  STAQ    WRITE_NETCON+2

     2640    11526    2             WRITE_NETCON.BUF_ = VECTOR(KS_RFEP);

  11526  4 000525   000016 237000 5                  LDAQ    14
         4 000526   006210 757000 1                  STAQ    WRITE_NETCON+4

     2641    11527    2                 WRITE_NETCON.BUF_.BOUND = SIZEV(KS_RFEP) - SIZEC(KS_RFEP.NODE) +

  11527  4 000527   003564 236000 1                  LDQ     KS_RFEP
         4 000530   000024 402007                    MPY     20,DL
         4 000531   000003 036007                    ADLQ    3,DL
         4 000532   000020 736000                    QLS     16
         4 000533   006210 676000 1                  ERQ     WRITE_NETCON+4
         4 000534   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000535   006210 656000 1                  ERSQ    WRITE_NETCON+4

     2642    11528    2                   KS_RFEP.NODE#*SIZEC(KS_RFEP.NODE(0));
     2643    11529    2             CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);

  11529  4 000536   006204 630400 1                  EPPR0   WRITE_NETCON
         4 000537   440001 713400                    CLIMB   alt,write
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:491  
         4 000540   401400 401760                    pmme    nvectors=4
         4 000541   001525 702000 4                  TSX2    DEF_ERR

     2644    11530
     2645    11531    2              KS_FEPBOOT_KEY.NODE = FEX;

  11531  4 000542   200023 236100                    LDQ     FEX,,AUTO
         4 000543   000011 736000                    QLS     9
         4 000544   002437 552010 1                  STBQ    KS_FEPBOOT_KEY,'10'O

     2646    11532    2              KS_FEPCTL_KEY.NODE = FEX;

  11532  4 000545   200023 236100                    LDQ     FEX,,AUTO
         4 000546   000011 736000                    QLS     9
         4 000547   002473 552010 1                  STBQ    KS_FEPCTL_KEY,'10'O

     2647    11533    2              KS_FEPHNDLR_KEY.NODE = FEX;

  11533  4 000550   200023 236100                    LDQ     FEX,,AUTO
         4 000551   000011 736000                    QLS     9
         4 000552   002552 552010 1                  STBQ    KS_FEPHNDLR_KEY,'10'O

     2648    11534    2              KS_HANDLER_KEY.NODE = FEX;

  11534  4 000553   200023 236100                    LDQ     FEX,,AUTO
         4 000554   000011 736000                    QLS     9
         4 000555   002401 552010 1                  STBQ    KS_HANDLER_KEY,'10'O

     2649    11535    2              KS_DEFAULT_KEY.NODE = FEX;

  11535  4 000556   200023 236100                    LDQ     FEX,,AUTO
         4 000557   000011 736000                    QLS     9
         4 000560   003326 552010 1                  STBQ    KS_DEFAULT_KEY,'10'O

     2650    11536
     2651    11537
     2652    11538        /* Do Case depending on node type */
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:492  
     2653    11539    3              DO CASE (NODETYPE);

  11539  4 000561   200024 235100                    LDA     NODETYPE,,AUTO
         4 000562   000006 115007                    CMPA    6,DL
         4 000563   000565 602005 4                  TNC     s:11539+4,AL
         4 000564   001507 710000 4                  TRA     s:11717
         4 000565   001507 710000 4                  TRA     s:11717
         4 000566   001507 710000 4                  TRA     s:11717
         4 000567   000573 710000 4                  TRA     s:11543
         4 000570   001472 710000 4                  TRA     s:11710
         4 000571   000573 710000 4                  TRA     s:11543
         4 000572   000573 710000 4                  TRA     s:11543

     2654    11540
     2655    11541    3              CASE (%KS_FEP,%KS_NODETYPE_DEBUG,%KS_RFEP);

     2656    11542                   /* Write default FEPBOOT record */
     2657    11543    3              KS_FEPBOOT.BOOTFID = 'M:FEP.:SYS';

  11543  4 000573   040000 100400                    MLR     fill='040'O
         4 000574   000005 000012 2                  ADSC9   HEX_CHARS+5              cn=0,n=10
         4 000575   002405 000050 1                  ADSC9   KS_FEPBOOT               cn=0,n=40

     2658    11544    3              KS_FEPBOOT.BOOTPARAMS = '0'B;

  11544  4 000576   000000 100400                    MLR     fill='000'O
         4 000577   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000600   002417 000100 1                  ADSC9   KS_FEPBOOT+10            cn=0,n=64

     2659    11545    4              DO I=0 TO %GI_BOOT_HI;

  11545  4 000601   200022 450100                    STZ     I,,AUTO

     2660    11546    4                KS_FEPBOOT.BOOTPARAMS(I) = KS_TBL(%KS_BOOT_PARAM)->KS$PARAM.DEFAULT(I)
             11546                          ;

  11546  4 000602   200022 235100                    LDA     I,,AUTO
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:493  
         4 000603   000002 735000                    ALS     2
         4 000604   000001 470400 xsym               LDP0    KS_TBL+1
         4 000605   200022 720100                    LXL0    I,,AUTO
         4 000606   000003 235105                    LDA     3,AL,PR0
         4 000607   002417 755010 1                  STA     KS_FEPBOOT+10,X0

     2661    11547    4                 END;

  11547  4 000610   200022 236100                    LDQ     I,,AUTO
         4 000611   000001 036007                    ADLQ    1,DL
         4 000612   200022 756100                    STQ     I,,AUTO
         4 000613   000020 116007                    CMPQ    16,DL
         4 000614   000602 602000 4                  TNC     s:11546

     2662    11548    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_LDCT) = %GI_LDCT#;

  11548  4 000615   000226 235007                    LDA     150,DL
         4 000616   002417 755000 1                  STA     KS_FEPBOOT+10

     2663    11549    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_IOP) = %GI_IOP#;

  11549  4 000617   000050 235007                    LDA     40,DL
         4 000620   002420 755000 1                  STA     KS_FEPBOOT+11

     2664    11550    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_HMI) = %GI_HMI#;

  11550  4 000621   000024 235007                    LDA     20,DL
         4 000622   002421 755000 1                  STA     KS_FEPBOOT+12

     2665    11551    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_APESSN) = %GI_APESSN#;

  11551  4 000623   000050 235007                    LDA     40,DL
         4 000624   002422 755000 1                  STA     KS_FEPBOOT+13

     2666    11552    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_SPROC) = %GI_SPROC#;

  11552  4 000625   000017 235007                    LDA     15,DL
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:494  
         4 000626   002425 755000 1                  STA     KS_FEPBOOT+16

     2667    11553    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_ACCTS) = %GI_ACCTS#;

  11553  4 000627   002433 755000 1                  STA     KS_FEPBOOT+22

     2668    11554    3              KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_MUIS) = %GI_MUIS#;

  11554  4 000630   000024 235007                    LDA     20,DL
         4 000631   002426 755000 1                  STA     KS_FEPBOOT+17

     2669    11555    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_NSHUF) = %GI_NSHUF#;

  11555  4 000632   002427 450000 1                  STZ     KS_FEPBOOT+18

     2670    11556    3                KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_TCTX) = %GI_TCTX#;

  11556  4 000633   000040 235007                    LDA     32,DL
         4 000634   002423 755000 1                  STA     KS_FEPBOOT+14

     2671    11557    3             KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_CBUFFER) = %GI_CBUFFER#;

  11557  4 000635   000144 235007                    LDA     100,DL
         4 000636   002424 755000 1                  STA     KS_FEPBOOT+15

     2672    11558    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_NODES) = %GI_NODES#;

  11558  4 000637   000020 235007                    LDA     16,DL
         4 000640   002430 755000 1                  STA     KS_FEPBOOT+19

     2673    11559    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_LINKS) = %GI_LINKS#;

  11559  4 000641   000005 235007                    LDA     5,DL
         4 000642   002431 755000 1                  STA     KS_FEPBOOT+20

     2674    11560    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_DEVICES) = %GI_DEVICES#;

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:495  
  11560  4 000643   000062 235007                    LDA     50,DL
         4 000644   002432 755000 1                  STA     KS_FEPBOOT+21

     2675    11561    3                 KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_PCHANS) = %GI_PCHANS#;

  11561  4 000645   000012 235007                    LDA     10,DL
         4 000646   002434 755000 1                  STA     KS_FEPBOOT+23

     2676    11562    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  11562  4 000647   000026 237000 5                  LDAQ    22
         4 000650   006206 757000 1                  STAQ    WRITE_NETCON+2

     2677    11563    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPBOOT);

  11563  4 000651   000030 237000 5                  LDAQ    24
         4 000652   006210 757000 1                  STAQ    WRITE_NETCON+4

     2678    11564    3              CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);

  11564  4 000653   006204 630400 1                  EPPR0   WRITE_NETCON
         4 000654   440001 713400                    CLIMB   alt,write
         4 000655   401400 401760                    pmme    nvectors=4
         4 000656   001525 702000 4                  TSX2    DEF_ERR

     2679    11565
     2680    11566                   /* Write default FEPCTL record */
     2681    11567    4              DO I=0 TO %GI_CNTL_BOOTHI;

  11567  4 000657   200022 450100                    STZ     I,,AUTO

     2682    11568    4                 KS_FEPCTL.PARAMS(I) = KS_TBL(%KS_LCP6_PARAM) -> KS$PARAM.DEFAULT(I);

  11568  4 000660   200022 235100                    LDA     I,,AUTO
         4 000661   000002 735000                    ALS     2
         4 000662   000002 470400 xsym               LDP0    KS_TBL+2
         4 000663   200022 720100                    LXL0    I,,AUTO
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:496  
         4 000664   000003 235105                    LDA     3,AL,PR0
         4 000665   002446 755010 1                  STA     KS_FEPCTL+1,X0

     2683    11569    4                 END;

  11569  4 000666   200022 236100                    LDQ     I,,AUTO
         4 000667   000001 036007                    ADLQ    1,DL
         4 000670   200022 756100                    STQ     I,,AUTO
         4 000671   000025 116007                    CMPQ    21,DL
         4 000672   000660 602000 4                  TNC     s:11568

     2684    11570    3              KS_FEPCTL.NPARAMS = %GI_CNTL_BOOTHI;

  11570  4 000673   000024 235007                    LDA     20,DL
         4 000674   002445 755000 1                  STA     KS_FEPCTL

     2685    11571
     2686    11572    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPCTL_KEY);

  11572  4 000675   000032 237000 5                  LDAQ    26
         4 000676   006206 757000 1                  STAQ    WRITE_NETCON+2

     2687    11573    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPCTL);

  11573  4 000677   000034 237000 5                  LDAQ    28
         4 000700   006210 757000 1                  STAQ    WRITE_NETCON+4

     2688    11574    3              CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);

  11574  4 000701   006204 630400 1                  EPPR0   WRITE_NETCON
         4 000702   440001 713400                    CLIMB   alt,write
         4 000703   401400 401760                    pmme    nvectors=4
         4 000704   001525 702000 4                  TSX2    DEF_ERR

     2689    11575
     2690    11576                   /* Write default FEPHNDLR record */
     2691    11577    3   IF NODETYPE = %KS_RFEP THEN
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:497  

  11577  4 000705   200024 235100                    LDA     NODETYPE,,AUTO
         4 000706   000005 115007                    CMPA    5,DL
         4 000707   000734 601000 4                  TNZ     s:11590

     2692    11578    4       DO;

     2693    11579    4          KS_FEPHNDLR.NHANDLERS = 3; /* NA, HDLCX25, ASYNC */

  11579  4 000710   000003 236007                    LDQ     3,DL
         4 000711   002474 756000 1                  STQ     KS_FEPHNDLR

     2694    11580    4          KS_FEPHNDLR.HANDLER(0) = 'NODEADMN';

  11580  4 000712   000010 237000 2                  LDAQ    HEX_CHARS+8
         4 000713   002500 757000 1                  STAQ    KS_FEPHNDLR+4

     2695    11581    4          KS_FEPHNDLR.HANDLER(1) = 'HDLCX25';

  11581  4 000714   040000 100400                    MLR     fill='040'O
         4 000715   000012 000007 2                  ADSC9   HEX_CHARS+10             cn=0,n=7
         4 000716   002502 000010 1                  ADSC9   KS_FEPHNDLR+6            cn=0,n=8

     2696    11582    4          KS_FEPHNDLR.HANDLER(2) = 'ASYNC';

  11582  4 000717   040000 100400                    MLR     fill='040'O
         4 000720   000014 000005 2                  ADSC9   HEX_CHARS+12             cn=0,n=5
         4 000721   002504 000010 1                  ADSC9   KS_FEPHNDLR+8            cn=0,n=8

     2697    11583    4          KS_FEPHNDLR.DEFLIBACCT = ':SYS    ';

  11583  4 000722   000016 237000 2                  LDAQ    HEX_CHARS+14
         4 000723   002475 755000 1                  STA     KS_FEPHNDLR+1
         4 000724   002476 756000 1                  STQ     KS_FEPHNDLR+2

     2698    11584    4          KS_FEPHNDLR.BOOTIME(0) = '1'B;  /* load nodeadmn at bootime */

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:498  
  11584  4 000725   400000 236003                    LDQ     -131072,DU
         4 000726   002477 256000 1                  ORSQ    KS_FEPHNDLR+3

     2699    11585    4          KS_FEPHNDLR.BOOTIME(1) = '1'B;  /* load hdlcx25 at bootime */

  11585  4 000727   200000 236003                    LDQ     65536,DU
         4 000730   002477 256000 1                  ORSQ    KS_FEPHNDLR+3

     2700    11586    4          KS_FEPHNDLR.BOOTIME(2) = '0'B;  /* don't load async until later*/

  11586  4 000731   000036 236000 5                  LDQ     30
         4 000732   002477 356000 1                  ANSQ    KS_FEPHNDLR+3

     2701    11587    4       END;

  11587  4 000733   000757 710000 4                  TRA     s:11599

     2702    11588    3   ELSE
     2703    11589    4       DO;

     2704    11590    4          KS_FEPHNDLR.NHANDLERS = 3; /* NA, FEI, ASYNC */

  11590  4 000734   000003 236007                    LDQ     3,DL
         4 000735   002474 756000 1                  STQ     KS_FEPHNDLR

     2705    11591    4          KS_FEPHNDLR.HANDLER(0) = 'NODEADMN';

  11591  4 000736   000010 237000 2                  LDAQ    HEX_CHARS+8
         4 000737   002500 757000 1                  STAQ    KS_FEPHNDLR+4

     2706    11592    4          KS_FEPHNDLR.HANDLER(1) = 'COUPLER';

  11592  4 000740   040000 100400                    MLR     fill='040'O
         4 000741   000020 000007 2                  ADSC9   HEX_CHARS+16             cn=0,n=7
         4 000742   002502 000010 1                  ADSC9   KS_FEPHNDLR+6            cn=0,n=8

     2707    11593    4          KS_FEPHNDLR.HANDLER(2) = 'ASYNC';
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:499  

  11593  4 000743   040000 100400                    MLR     fill='040'O
         4 000744   000014 000005 2                  ADSC9   HEX_CHARS+12             cn=0,n=5
         4 000745   002504 000010 1                  ADSC9   KS_FEPHNDLR+8            cn=0,n=8

     2708    11594    4          KS_FEPHNDLR.DEFLIBACCT = ':SYS    ';

  11594  4 000746   000016 237000 2                  LDAQ    HEX_CHARS+14
         4 000747   002475 755000 1                  STA     KS_FEPHNDLR+1
         4 000750   002476 756000 1                  STQ     KS_FEPHNDLR+2

     2709    11595    4          KS_FEPHNDLR.BOOTIME(0) = '1'B;  /* load nodeadmn at bootime */

  11595  4 000751   400000 236003                    LDQ     -131072,DU
         4 000752   002477 256000 1                  ORSQ    KS_FEPHNDLR+3

     2710    11596    4          KS_FEPHNDLR.BOOTIME(1) = '1'B;  /* load coupler at bootime */

  11596  4 000753   200000 236003                    LDQ     65536,DU
         4 000754   002477 256000 1                  ORSQ    KS_FEPHNDLR+3

     2711    11597    4          KS_FEPHNDLR.BOOTIME(2) = '1'B;  /* load async at bootime */

  11597  4 000755   100000 236003                    LDQ     32768,DU
         4 000756   002477 256000 1                  ORSQ    KS_FEPHNDLR+3

     2712    11598    4       END;

     2713    11599    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);

  11599  4 000757   000040 237000 5                  LDAQ    32
         4 000760   006206 757000 1                  STAQ    WRITE_NETCON+2

     2714    11600    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);

  11600  4 000761   000042 237000 5                  LDAQ    34
         4 000762   006210 757000 1                  STAQ    WRITE_NETCON+4
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:500  

     2715    11601
     2716    11602
     2717    11603
     2718    11604
     2719    11605    3                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_FEPHNDLR.NHANDLERS) + SIZEC(
             11605                          KS_FEPHNDLR.DEFLIBACCT) + 4  /* bootime */

  11605  4 000763   002474 236000 1                  LDQ     KS_FEPHNDLR
         4 000764   000003 736000                    QLS     3
         4 000765   000017 036007                    ADLQ    15,DL
         4 000766   000020 736000                    QLS     16
         4 000767   006210 676000 1                  ERQ     WRITE_NETCON+4
         4 000770   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000771   006210 656000 1                  ERSQ    WRITE_NETCON+4

     2720    11606    3                                           + SIZEC(KS_FEPHNDLR.HANDLER(0)) *
             11606                                                    KS_FEPHNDLR.NHANDLERS - 1;
     2721    11607    3              CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);

  11607  4 000772   006204 630400 1                  EPPR0   WRITE_NETCON
         4 000773   440001 713400                    CLIMB   alt,write
         4 000774   401400 401760                    pmme    nvectors=4
         4 000775   001525 702000 4                  TSX2    DEF_ERR

     2722    11608
     2723    11609                   /* Write default HNDLR records */
     2724    11610    4              DO J = 1 TO KS_FEPHNDLR.NHANDLERS;

  11610  4 000776   000001 235007                    LDA     1,DL
         4 000777   200035 755100                    STA     J,,AUTO
         4 001000   001324 710000 4                  TRA     s:11665+1

     2725    11611    4                 KS_DEFAULT_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J-1);

  11611  4 001001   200035 235100                    LDA     J,,AUTO
         4 001002   000003 735000                    ALS     3
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:501  
         4 001003   040000 100405                    MLR     fill='040'O
         4 001004   002476 000010 1                  ADSC9   KS_FEPHNDLR+2,A          cn=0,n=8
         4 001005   003326 600010 1                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

     2726    11612    4                 CALL KSU$INIT_DEFCNFG(KS_DEFAULT);

  11612  4 001006   003413 630400 1                  EPPR0   DEFAULT$
         4 001007   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001010   000000 701000 xent               TSX1    KSU$INIT_DEFCNFG
         4 001011   000000 011000                    NOP     0

     2727    11613    4                 CALL KSU$WRITE_NETCON(VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT));

  11613  4 001012   003413 470400 1                  LDP0    DEFAULT$
         4 001013   000012 236100                    LDQ     10,,PR0
         4 001014   000011 772000                    QRL     9
         4 001015   000777 376007                    ANQ     511,DL
         4 001016   000053 620006                    EAX0    43,QL
         4 001017   000000 635010                    EAA     0,X0
         4 001020   000002 771000                    ARL     2
         4 001021   000140 135007                    SBLA    96,DL
         4 001022   003413 236000 1                  LDQ     DEFAULT$
         4 001023   200042 757100                    STAQ    LINK_NR+1,,AUTO
         4 001024   200042 631500                    EPPR1   LINK_NR+1,,AUTO
         4 001025   200045 451500                    STP1    LINK_NR+4,,AUTO
         4 001026   000037 236000 5                  LDQ     31
         4 001027   200044 756100                    STQ     LINK_NR+3,,AUTO
         4 001030   200044 630500                    EPPR0   LINK_NR+3,,AUTO
         4 001031   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001032   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         4 001033   000000 011000                    NOP     0

     2728    11614    4                 KS_HANDLER = '0'B;

  11614  4 001034   003414 470400 1                  LDP0    HNDLR$
         4 001035   000100 100400                    MLR     fill='000'O
         4 001036   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:502  
         4 001037   000000 000166                    ADSC9   0,,PR0                   cn=0,n=118

     2729    11615    4                 KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J-1);

  11615  4 001040   200035 235100                    LDA     J,,AUTO
         4 001041   000003 735000                    ALS     3
         4 001042   040000 100405                    MLR     fill='040'O
         4 001043   002476 000010 1                  ADSC9   KS_FEPHNDLR+2,A          cn=0,n=8
         4 001044   002401 600010 1                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     2730    11616    4                 KS_HANDLER.HNDLRFID = KS_FEPHNDLR.HANDLER(J-1);

  11616  4 001045   040100 100405                    MLR     fill='040'O
         4 001046   002476 000010 1                  ADSC9   KS_FEPHNDLR+2,A          cn=0,n=8
         4 001047   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40

     2731    11617    4                 CALL INDEX(TEMP,' ',KS_HANDLER.HNDLRFID);

  11617  4 001050   000000 124500                    SCM     mask='000'O
         4 001051   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
         4 001052   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001053   200036 000100                    ARG     TEMP,,AUTO

     2732    11618    4                 CALL INSERT(KS_HANDLER.HNDLRFID,TEMP,,'.:SYS');

  11618  4 001054   200036 720100                    LXL0    TEMP,,AUTO
         4 001055   777727 620010                    EAX0    -41,X0
         4 001056   777777 660003                    ERX0    -1,DU
         4 001057   200036 236100                    LDQ     TEMP,,AUTO
         4 001060   040146 100400                    MLR     fill='040'O
         4 001061   000022 000005 2                  ADSC9   HEX_CHARS+18             cn=0,n=5
         4 001062   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0

     2733    11619    4                 KS_HANDLER.HNDLRNAME = KS_FEPHNDLR.HANDLER(J-1);

  11619  4 001063   200035 235100                    LDA     J,,AUTO
         4 001064   000001 735000                    ALS     1
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:503  
         4 001065   002476 237005 1                  LDAQ    KS_FEPHNDLR+2,AL
         4 001066   000012 755100                    STA     10,,PR0
         4 001067   000013 756100                    STQ     11,,PR0

     2734    11620    5                  DO HAND# = 0 TO 7;

  11620  4 001070   200033 450100                    STZ     HAND#,,AUTO

     2735    11621    5                       IF KS_HAND_INFO.TEXT(HAND#) = KS_HANDLER_KEY.HNDLR

  11621  4 001071   200033 236100                    LDQ     HAND#,,AUTO
         4 001072   000024 402007                    MPY     20,DL
         4 001073   040000 106406                    CMPC    fill='040'O
         4 001074   000000 000010 xsym               ADSC9   KS_HAND_INFO,Q           cn=0,n=8
         4 001075   002401 600010 1                  ADSC9   KS_HANDLER_KEY           cn=3,n=8
         4 001076   001104 600000 4                  TZE     s:11625

     2736    11622    5                       THEN
     2737    11623    5                            EXIT;
     2738    11624    5                       END;

  11624  4 001077   200033 235100                    LDA     HAND#,,AUTO
         4 001100   000001 035007                    ADLA    1,DL
         4 001101   200033 755100                    STA     HAND#,,AUTO
         4 001102   000010 115007                    CMPA    8,DL
         4 001103   001071 602000 4                  TNC     s:11621

     2739    11625    4                 KS_HANDLER.TYPE = KS_HAND_INFO.TYPE(HAND#);

  11625  4 001104   200033 236100                    LDQ     HAND#,,AUTO
         4 001105   000005 402007                    MPY     5,DL
         4 001106   003414 470400 1                  LDP0    HNDLR$
         4 001107   000002 236006 xsym               LDQ     KS_HAND_INFO+2,QL
         4 001110   000033 736000                    QLS     27
         4 001111   000014 552140                    STBQ    12,'40'O,PR0

     2740    11626
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:504  
     2741    11627    4                 DFLT$ = KS_HAND_INFO.PARAMS$(HAND#);

  11627  4 001112   200033 236100                    LDQ     HAND#,,AUTO
         4 001113   000005 402007                    MPY     5,DL
         4 001114   000004 236006 xsym               LDQ     KS_HAND_INFO+4,QL
         4 001115   200030 756100                    STQ     DFLT$,,AUTO

     2742    11628
     2743    11629    4                 IF KS_HAND_INFO.SZ(HAND#) <= %KL_FIXED_HI

  11629  4 001116   200033 236100                    LDQ     HAND#,,AUTO
         4 001117   000005 402007                    MPY     5,DL
         4 001120   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         4 001121   000036 115007                    CMPA    30,DL
         4 001122   001127 603000 4                  TRC     s:11631

     2744    11630    4                 THEN KS_HANDLER.NPARAMS = KS_HAND_INFO.SZ(HAND#);

  11630  4 001123   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         4 001124   000011 736000                    QLS     9
         4 001125   000014 552110                    STBQ    12,'10'O,PR0
         4 001126   001131 710000 4                  TRA     s:11633

     2745    11631    4                 ELSE KS_HANDLER.NPARAMS = %KL_FIXED_HI;

  11631  4 001127   035000 236007                    LDQ     14848,DL
         4 001130   000014 552110                    STBQ    12,'10'O,PR0

     2746    11632
     2747    11633    5                 DO K=0 TO KS_HANDLER.NPARAMS-1;

  11633  4 001131   200032 450100                    STZ     K,,AUTO
         4 001132   001147 710000 4                  TRA     s:11635+3

     2748    11634    5                    KS_HANDLER.PARAMS(K) = DFLT$->KS$PARAM.DEFAULT(K);

  11634  4 001133   200032 235100                    LDA     K,,AUTO
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:505  
         4 001134   000004 735000                    ALS     4
         4 001135   200032 236100                    LDQ     K,,AUTO
         4 001136   000001 736000                    QLS     1
         4 001137   200030 470500                    LDP0    DFLT$,,AUTO
         4 001140   003414 471400 1                  LDP1    HNDLR$
         4 001141   000106 101505                    MRL     fill='000'O
         4 001142   000003 000004                    ADSC9   3,A,PR0                  cn=0,n=4
         4 001143   100015 000002                    ADSC9   13,Q,PR1                 cn=0,n=2

     2749    11635    5                    END;

  11635  4 001144   200032 235100                    LDA     K,,AUTO
         4 001145   000001 035007                    ADLA    1,DL
         4 001146   200032 755100                    STA     K,,AUTO
         4 001147   003414 470400 1                  LDP0    HNDLR$
         4 001150   000014 236100                    LDQ     12,,PR0
         4 001151   000011 772000                    QRL     9
         4 001152   000777 376007                    ANQ     511,DL
         4 001153   200032 116100                    CMPQ    K,,AUTO
         4 001154   001156 600000 4                  TZE     s:11637
         4 001155   001133 603000 4                  TRC     s:11634

     2750    11636
     2751    11637    4                 IF KS_HAND_INFO.SZ(HAND#) > %KL_FIXED_HI

  11637  4 001156   200033 236100                    LDQ     HAND#,,AUTO
         4 001157   000005 402007                    MPY     5,DL
         4 001160   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         4 001161   000036 115007                    CMPA    30,DL
         4 001162   001270 602000 4                  TNC     s:11655

     2752    11638    5                 THEN DO;

     2753    11639    5                       KS_HANDLER.NPARAMI = KS_HAND_INFO.SZ(HAND#) - %KL_FIXED_HI;

  11639  4 001163   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         4 001164   000035 136007                    SBLQ    29,DL
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:506  
         4 001165   000014 552104                    STBQ    12,'04'O,PR0

     2754    11640    5                      OUT$ = PINCRW(ADDR(KS_HANDLER),SIZEW(KS_HANDLER));

  11640  4 001166   003414 236000 1                  LDQ     HNDLR$
         4 001167   000036 036003                    ADLQ    30,DU
         4 001170   200027 756100                    STQ     OUT$,,AUTO

     2755    11641
     2756    11642    6                     DO K = %KL_HNDLRPARM_BLOCK TO KS_HAND_INFO.SZ(HAND#)-1;

  11642  4 001171   000035 235007                    LDA     29,DL
         4 001172   200032 755100                    STA     K,,AUTO
         4 001173   001262 710000 4                  TRA     s:11652+3

     2757    11643    6                         DFLT_OPT$ = DFLT$->KS$PARAM.SPCL_TBL$(K);

  11643  4 001174   200032 235100                    LDA     K,,AUTO
         4 001175   000002 735000                    ALS     2
         4 001176   200030 470500                    LDP0    DFLT$,,AUTO
         4 001177   000002 236105                    LDQ     2,AL,PR0
         4 001200   200031 756100                    STQ     DFLT_OPT$,,AUTO

     2758    11644    6                       KS_HANDLER.IPARAM.OFFSET(K - %KL_HNDLRPARM_BLOCK) = POFFW(OUT$,
             11644                                 ADDR(KS_HANDLER));

  11644  4 001201   003414 236000 1                  LDQ     HNDLR$
         4 001202   000022 772000                    QRL     18
         4 001203   200042 756100                    STQ     LINK_NR+1,,AUTO
         4 001204   200027 236100                    LDQ     OUT$,,AUTO
         4 001205   000022 772000                    QRL     18
         4 001206   200042 136100                    SBLQ    LINK_NR+1,,AUTO
         4 001207   000000 620006                    EAX0    0,QL
         4 001210   003414 471400 1                  LDP1    HNDLR$
         4 001211   200032 721100                    LXL1    K,,AUTO
         4 001212   177777 740111                    STX0    -1,X1,PR1

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:507  
     2759    11645    6                        KS_HANDLER.IPARAM.ARRAY_SZ(K - %KL_HNDLRPARM_BLOCK) =
             11645                                 KS_HAND_INFO.PARAMS$(HAND#)->KS$PARAM.ARRAY_SZ(K);

  11645  4 001213   200033 236100                    LDQ     HAND#,,AUTO
         4 001214   000005 402007                    MPY     5,DL
         4 001215   000004 473406 xsym               LDP3    KS_HAND_INFO+4,QL
         4 001216   200032 235100                    LDA     K,,AUTO
         4 001217   000002 735000                    ALS     2
         4 001220   300001 236105                    LDQ     1,AL,PR3
         4 001221   000011 736000                    QLS     9
         4 001222   177776 676111                    ERQ     -2,X1,PR1
         4 001223   777000 376007                    ANQ     -512,DL
         4 001224   177776 656111                    ERSQ    -2,X1,PR1

     2760    11646
     2761    11647    7                       DO I = 0 TO KS_HANDLER.IPARAM.ARRAY_SZ(K - %KL_HNDLRPARM_BLOCK)
             11647                                 ;

  11647  4 001225   200022 450100                    STZ     I,,AUTO
         4 001226   001243 710000 4                  TRA     s:11649+3

     2762    11648    7                         OUT$->B$PARAMI(I) = DFLT_OPT$->KS$PARAM.DEFAULT(I);

  11648  4 001227   200022 235100                    LDA     I,,AUTO
         4 001230   000004 735000                    ALS     4
         4 001231   200022 236100                    LDQ     I,,AUTO
         4 001232   000001 736000                    QLS     1
         4 001233   200031 470500                    LDP0    DFLT_OPT$,,AUTO
         4 001234   200027 471500                    LDP1    OUT$,,AUTO
         4 001235   000106 101505                    MRL     fill='000'O
         4 001236   000003 000004                    ADSC9   3,A,PR0                  cn=0,n=4
         4 001237   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2

     2763    11649    7                           END;

  11649  4 001240   200022 235100                    LDA     I,,AUTO
         4 001241   000001 035007                    ADLA    1,DL
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:508  
         4 001242   200022 755100                    STA     I,,AUTO
         4 001243   003414 470400 1                  LDP0    HNDLR$
         4 001244   200032 720100                    LXL0    K,,AUTO
         4 001245   077776 236110                    LDQ     -2,X0,PR0
         4 001246   000011 772000                    QRL     9
         4 001247   000777 376007                    ANQ     511,DL
         4 001250   200022 116100                    CMPQ    I,,AUTO
         4 001251   001227 603000 4                  TRC     s:11648

     2764    11650
     2765    11651    6                        OUT$ = PINCRW(OUT$,(KS_HANDLER.IPARAM.ARRAY_SZ(K - %
             11651                                 KL_HNDLRPARM_BLOCK)+2)/2);

  11651  4 001252   000002 036007                    ADLQ    2,DL
         4 001253   000001 772000                    QRL     1
         4 001254   000022 736000                    QLS     18
         4 001255   200027 036100                    ADLQ    OUT$,,AUTO
         4 001256   200027 756100                    STQ     OUT$,,AUTO

     2766    11652    6                         END;  /* DO K - # of indexed params */

  11652  4 001257   200032 235100                    LDA     K,,AUTO
         4 001260   000001 035007                    ADLA    1,DL
         4 001261   200032 755100                    STA     K,,AUTO
         4 001262   200033 236100                    LDQ     HAND#,,AUTO
         4 001263   000005 402007                    MPY     5,DL
         4 001264   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         4 001265   200032 116100                    CMPQ    K,,AUTO
         4 001266   001270 600000 4                  TZE     s:11655
         4 001267   001174 603000 4                  TRC     s:11643

     2767    11653    5                     END;  /* DO IF ANY INDEXED PARAMS */

     2768    11654
     2769    11655    4                 WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);

  11655  4 001270   000046 237000 5                  LDAQ    38
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:509  
         4 001271   006206 757000 1                  STAQ    WRITE_NETCON+2

     2770    11656    4                 WRITE_NETCON.BUF_ = VECTOR(KS_HANDLER);

  11656  4 001272   000050 235000 5                  LDA     40
         4 001273   003414 236000 1                  LDQ     HNDLR$
         4 001274   006210 757000 1                  STAQ    WRITE_NETCON+4

     2771    11657    4                 IF KS_HANDLER.NPARAMI = 0

  11657  4 001275   000014 236100                    LDQ     12,,PR0
         4 001276   000777 316007                    CANQ    511,DL
         4 001277   001304 601000 4                  TNZ     s:11663

     2772    11658    5                 THEN DO;

     2773    11659    5                    OUT$ = ADDR(KS_HANDLER);

  11659  4 001300   003414 236000 1                  LDQ     HNDLR$
         4 001301   200027 756100                    STQ     OUT$,,AUTO

     2774    11660    5                    OUT$ = PINCRW(OUT$,SIZEW(KS_HANDLER) + 1);

  11660  4 001302   000037 036003                    ADLQ    31,DU
         4 001303   200027 756100                    STQ     OUT$,,AUTO

     2775    11661    5                 END;

     2776    11662
     2777    11663    4                 WRITE_NETCON.BUF_.BOUND = POFFC(OUT$,ADDR(KS_HANDLER))-1;

  11663  4 001304   003414 236000 1                  LDQ     HNDLR$
         4 001305   000020 772000                    QRL     16
         4 001306   200042 756100                    STQ     LINK_NR+1,,AUTO
         4 001307   200027 236100                    LDQ     OUT$,,AUTO
         4 001310   000020 772000                    QRL     16
         4 001311   200042 136100                    SBLQ    LINK_NR+1,,AUTO
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:510  
         4 001312   000001 136007                    SBLQ    1,DL
         4 001313   000020 736000                    QLS     16
         4 001314   006210 676000 1                  ERQ     WRITE_NETCON+4
         4 001315   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001316   006210 656000 1                  ERSQ    WRITE_NETCON+4

     2778    11664    4                 CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);

  11664  4 001317   006204 630400 1                  EPPR0   WRITE_NETCON
         4 001320   440001 713400                    CLIMB   alt,write
         4 001321   401400 401760                    pmme    nvectors=4
         4 001322   001525 702000 4                  TSX2    DEF_ERR

     2779    11665    4                 END;  /* DO J - # of handlers */

  11665  4 001323   200035 054100                    AOS     J,,AUTO
         4 001324   002474 236000 1                  LDQ     KS_FEPHNDLR
         4 001325   001001 604000 4                  TMI     s:11611
         4 001326   200035 116100                    CMPQ    J,,AUTO
         4 001327   001001 605000 4                  TPL     s:11611

     2780    11666
     2781    11667             /* Write a link record for the FEP */
     2782    11668    3       KS_LINK.LINKS# = 0;

  11668  4 001330   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001331   000000 450100                    STZ     0,,PR0

     2783    11669    4       DO I = 0 TO NRLINKS - 1;

  11669  4 001332   200022 450100                    STZ     I,,AUTO
         4 001333   001442 710000 4                  TRA     s:11697+3

     2784    11670    4          K = 3;

  11670  4 001334   000003 235007                    LDA     3,DL
         4 001335   200032 755100                    STA     K,,AUTO
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:511  

     2785    11671    4          TEMP_LINK = '0'B;

  11671  4 001336   000000 220003                    LDX0    0,DU
         4 001337   002444 740000 1                  STX0    TEMP_LINK

     2786    11672    5          DO J = 3 DOWNTO 0;

  11672  4 001340   200035 755100                    STA     J,,AUTO

     2787    11673    5              IF SUBSTR(LINK_LIST(I),J,1) ~= ' ' THEN

  11673  4 001341   200022 236100                    LDQ     I,,AUTO
         4 001342   000002 736000                    QLS     2
         4 001343   200035 036100                    ADLQ    J,,AUTO
         4 001344   040000 106506                    CMPC    fill='040'O
         4 001345   200007 000001                    ADSC9   LINK_LIST,Q,AUTO         cn=0,n=1
         4 001346   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001347   001367 600000 4                  TZE     s:11679

     2788    11674    6                DO;

     2789    11675    6                   CALL INDEX (TEMP,SUBSTR(LINK_LIST(I),J,1),HEX_CHARS);

  11675  4 001350   200022 236100                    LDQ     I,,AUTO
         4 001351   000002 736000                    QLS     2
         4 001352   200035 036100                    ADLQ    J,,AUTO
         4 001353   000106 124400                    SCM     mask='000'O
         4 001354   000000 000020 2                  ADSC9   HEX_CHARS                cn=0,n=16
         4 001355   200007 000001                    ADSC9   LINK_LIST,Q,AUTO         cn=0,n=1
         4 001356   200036 000100                    ARG     TEMP,,AUTO

     2790    11676    6                   HEX$(K)->HEX = TEMP;

  11676  4 001357   200032 720100                    LXL0    K,,AUTO
         4 001360   002440 470410 1                  LDP0    HEX$,X0
         4 001361   003100 061500                    CSR     bolr='003'O
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:512  
         4 001362   200036 000044                    BDSC    TEMP,,AUTO               by=0,bit=0,n=36
         4 001363   000000 000004                    BDSC    0,,PR0                   by=0,bit=0,n=4

     2791    11677    6                   K = K - 1;

  11677  4 001364   200032 235100                    LDA     K,,AUTO
         4 001365   000001 135007                    SBLA    1,DL
         4 001366   200032 755100                    STA     K,,AUTO

     2792    11678    6                END;

     2793    11679    5          END;

  11679  4 001367   000001 336007                    LCQ     1,DL
         4 001370   200035 056100                    ASQ     J,,AUTO
         4 001371   001341 605000 4                  TPL     s:11673

     2794    11680    4           IF I = 0 THEN

  11680  4 001372   200022 235100                    LDA     I,,AUTO
         4 001373   001403 601000 4                  TNZ     CHECK_DUP

     2795    11681    5             DO;

     2796    11682    5                KS_LINK.CHANNEL(0)= TEMP_LINK;

  11682  4 001374   002444 220000 1                  LDX0    TEMP_LINK
         4 001375   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001376   000001 740100                    STX0    1,,PR0

     2797    11683    5                KS_LINK.LINKS# = KS_LINK.LINKS# + 1;

  11683  4 001377   000000 235100                    LDA     0,,PR0
         4 001400   000001 035007                    ADLA    1,DL
         4 001401   000000 755100                    STA     0,,PR0

     2798    11684    5             END;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:513  

  11684  4 001402   001437 710000 4                  TRA     s:11697

     2799    11685    4           ELSE
     2800    11686    5             DO;

     2801    11687    6   CHECK_DUP:             DO J = 0 TO KS_LINK.LINKS# - 1;

  11687  4 001403   200035 450100       CHECK_DUP    STZ     J,,AUTO
         4 001404   001415 710000 4                  TRA     s:11690+1

     2802    11688    6                    IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN

  11688  4 001405   200035 235100                    LDA     J,,AUTO
         4 001406   000001 735000                    ALS     1
         4 001407   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001410   000105 106400                    CMPC    fill='000'O
         4 001411   002444 000002 1                  ADSC9   TEMP_LINK                cn=0,n=2
         4 001412   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
         4 001413   001422 600000 4                  TZE     s:11691

     2803    11689    6                      EXIT CHECK_DUP;
     2804    11690    6                END;

  11690  4 001414   200035 054100                    AOS     J,,AUTO
         4 001415   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001416   200035 236100                    LDQ     J,,AUTO
         4 001417   001405 604000 4                  TMI     s:11688
         4 001420   000000 116100                    CMPQ    0,,PR0
         4 001421   001405 602000 4                  TNC     s:11688

     2805    11691    5                 IF J = KS_LINK.LINKS# THEN

  11691  4 001422   200035 236100                    LDQ     J,,AUTO
         4 001423   001437 604000 4                  TMI     s:11697
         4 001424   000000 116100                    CMPQ    0,,PR0
         4 001425   001437 601000 4                  TNZ     s:11697
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:514  

     2806    11692    6                   DO;

     2807    11693    6                      KS_LINK.CHANNEL(KS_LINK.LINKS#) = TEMP_LINK;

  11693  4 001426   000000 235100                    LDA     0,,PR0
         4 001427   000001 735000                    ALS     1
         4 001430   000105 100400                    MLR     fill='000'O
         4 001431   002444 000002 1                  ADSC9   TEMP_LINK                cn=0,n=2
         4 001432   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2

     2808    11694    6                      KS_LINK.LINKS# = KS_LINK.LINKS# + 1;

  11694  4 001433   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001434   000000 235100                    LDA     0,,PR0
         4 001435   000001 035007                    ADLA    1,DL
         4 001436   000000 755100                    STA     0,,PR0

     2809    11695    6                   END;

     2810    11696    5             END;

     2811    11697    4       END;

  11697  4 001437   200022 235100                    LDA     I,,AUTO
         4 001440   000001 035007                    ADLA    1,DL
         4 001441   200022 755100                    STA     I,,AUTO
         4 001442   200022 236100                    LDQ     I,,AUTO
         4 001443   001446 604000 4                  TMI     s:11698
         4 001444   200006 116100                    CMPQ    NRLINKS,,AUTO
         4 001445   001334 604000 4                  TMI     s:11670

     2812    11698    3       KS_LINK_KEY.NODE = FEX;

  11698  4 001446   200023 236100                    LDQ     FEX,,AUTO
         4 001447   000011 736000                    QLS     9
         4 001450   002404 552010 1                  STBQ    KS_LINK_KEY,'10'O
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:515  

     2813    11699    3       WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  11699  4 001451   000052 237000 5                  LDAQ    42
         4 001452   006210 757000 1                  STAQ    WRITE_NETCON+4

     2814    11700    3       WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  11700  4 001453   000054 237000 5                  LDAQ    44
         4 001454   006206 757000 1                  STAQ    WRITE_NETCON+2

     2815    11701    3        WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +

  11701  4 001455   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001456   000000 236100                    LDQ     0,,PR0
         4 001457   000001 736000                    QLS     1
         4 001460   000003 036007                    ADLQ    3,DL
         4 001461   000020 736000                    QLS     16
         4 001462   006210 676000 1                  ERQ     WRITE_NETCON+4
         4 001463   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001464   006210 656000 1                  ERSQ    WRITE_NETCON+4

     2816    11702    3                                 (SIZEC(KS_LINK.CHANNEL(0)) *
     2817    11703    3                                 KS_LINK.LINKS#) - 1;
     2818    11704    3       CALL M$WRITE(WRITE_NETCON) ALTRET(DEF_ERR);

  11704  4 001465   006204 630400 1                  EPPR0   WRITE_NETCON
         4 001466   440001 713400                    CLIMB   alt,write
         4 001467   401400 401760                    pmme    nvectors=4
         4 001470   001525 702000 4                  TSX2    DEF_ERR
         4 001471   001507 710000 4                  TRA     s:11717

     2819    11705
     2820    11706        %EJECT;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:516  
     2821    11707    3               CASE (%KS_HOST);

     2822    11708
     2823    11709    3               CASE (%KS_ME);

     2824    11710    3                 KS_NODEINFO.NODE# = FEX;

  11710  4 001472   200023 236100                    LDQ     FEX,,AUTO
         4 001473   003322 756000 1                  STQ     KS_NODEINFO

     2825    11711    3                 KS_NODEINFO.NODENAME = NODENAME;

  11711  4 001474   200004 237100                    LDAQ    NODENAME,,AUTO
         4 001475   003323 755000 1                  STA     KS_NODEINFO+1
         4 001476   003324 756000 1                  STQ     KS_NODEINFO+2

     2826    11712    3                 WRITE_NETCON.BUF_ = VECTOR(KS_NODEINFO);

  11712  4 001477   000056 237000 5                  LDAQ    46
         4 001500   006210 757000 1                  STAQ    WRITE_NETCON+4

     2827    11713    3                 WRITE_NETCON.KEY_ = VECTOR(KS_NODEINFO_KEY);

  11713  4 001501   000060 237000 5                  LDAQ    48
         4 001502   006206 757000 1                  STAQ    WRITE_NETCON+2

     2828    11714    3                 CALL M$WRITE (WRITE_NETCON) ALTRET(DEF_ERR);

  11714  4 001503   006204 630400 1                  EPPR0   WRITE_NETCON
         4 001504   440001 713400                    CLIMB   alt,write
         4 001505   401400 401760                    pmme    nvectors=4
         4 001506   001525 702000 4                  TSX2    DEF_ERR

     2829    11715
     2830    11716    3               END /* END CASES */;

     2831    11717    2   UPDATE.CODE = %IGA_UPDATE;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:517  

  11717  4 001507   006165 470400 1                  LDP0    HDR$
         4 001510   026000 236003                    LDQ     11264,DU
         4 001511   000000 552140                    STBQ    0,'40'O,PR0

     2832    11718    3   CALL KSR$WR_HLPCG(VECTOR(UPDATE)) WHENALTRETURN DO; END;

  11718  4 001512   000051 235000 5                  LDA     41
         4 001513   006165 236000 1                  LDQ     HDR$
         4 001514   200042 757100                    STAQ    LINK_NR+1,,AUTO
         4 001515   200042 631500                    EPPR1   LINK_NR+1,,AUTO
         4 001516   200044 451500                    STP1    LINK_NR+3,,AUTO
         4 001517   200044 630500                    EPPR0   LINK_NR+3,,AUTO
         4 001520   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001521   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 001522   001524 702000 4                  TSX2    s:11720
         4 001523   001524 710000 4                  TRA     s:11720

     2833    11719
     2834    11720    2              RETURN;

  11720  4 001524   000000 702200 xent               TSX2  ! X66_ARET

  11717  4 001525                       DEF_ERR      null
     2835    11721    2         DEF_ERR:;
     2836    11722    2              CALL KSE$ERRMSG(0);

  11722  4 001525   000062 630400 5                  EPPR0   50
         4 001526   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001527   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001530   000000 011000                    NOP     0

     2837    11723    2              CALL KSE$ERRMSG(%E$KS_CANTDEFNODE,VECTOR(KS_SUB_BUF_1));

  11723  4 001531   000064 630400 5                  EPPR0   52
         4 001532   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001533   000000 701000 xent               TSX1    KSE$ERRMSG
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:518  
         4 001534   000000 011000                    NOP     0
         4 001535   002021 710000 4                  TRA     s:11805

     2838    11724                   /*E* ERROR: KSN-E$KS_CANTDEFNODE-0
     2839    11725                        MESSAGE: Unable to DEFINE node %U1.
     2840    11726                        DESCRIPTION: SEE MESSAGE */
     2841    11727        %EJECT;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:519  
     2842    11728    2            CASE (%KS_LINKS);

     2843    11729    2              KS_FEPBOOT_KEY.NODE = KS_NODE;

  11729  4 001536   000000 236000 xsym               LDQ     KS_NODE
         4 001537   000011 736000                    QLS     9
         4 001540   002437 552010 1                  STBQ    KS_FEPBOOT_KEY,'10'O

     2844    11730    2              READ_NETCON.BUF_ = VECTOR(KS_FEPBOOT);

  11730  4 001541   000030 237000 5                  LDAQ    24
         4 001542   006172 757000 1                  STAQ    READ_NETCON+4

     2845    11731    2              READ_NETCON.KEY_ = VECTOR(KS_FEPBOOT_KEY);

  11731  4 001543   000026 237000 5                  LDAQ    22
         4 001544   006170 757000 1                  STAQ    READ_NETCON+2

     2846    11732    3             CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  11732  4 001545   006166 630400 1                  EPPR0   READ_NETCON
         4 001546   440000 713400                    CLIMB   alt,read
         4 001547   401400 401760                    pmme    nvectors=4
         4 001550   001552 702000 4                  TSX2    s:11733
         4 001551   001557 710000 4                  TRA     s:11736

     2847    11733    3                CALL KSE$ERRMSG (%E$KS_BAD_NODE_TYPE-0);

  11733  4 001552   000067 630400 5                  EPPR0   55
         4 001553   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001554   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001555   000000 011000                    NOP     0

     2848    11734    3                RETURN;

  11734  4 001556   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:520  
     2849    11735    3             END;
     2850    11736    2               LNKS = KS_FEPBOOT.BOOTPARAMS(%GI_BOOT_LINKS);

  11736  4 001557   002431 235000 1                  LDA     KS_FEPBOOT+20
         4 001560   200037 755100                    STA     LNKS,,AUTO

     2851    11737
     2852    11738    2              KS_LINK_KEY.NODE = KS_NODE;

  11738  4 001561   000000 236000 xsym               LDQ     KS_NODE
         4 001562   000011 736000                    QLS     9
         4 001563   002404 552010 1                  STBQ    KS_LINK_KEY,'10'O

     2853    11739    2              READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  11739  4 001564   000052 237000 5                  LDAQ    42
         4 001565   006172 757000 1                  STAQ    READ_NETCON+4

     2854    11740    2              READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  11740  4 001566   000054 237000 5                  LDAQ    44
         4 001567   006170 757000 1                  STAQ    READ_NETCON+2

     2855    11741    3              CALL M$READ(READ_NETCON)  WHENALTRETURN DO;

  11741  4 001570   006166 630400 1                  EPPR0   READ_NETCON
         4 001571   440000 713400                    CLIMB   alt,read
         4 001572   401400 401760                    pmme    nvectors=4
         4 001573   001575 702000 4                  TSX2    s:11745
         4 001574   001600 710000 4                  TRA     s:11748

     2856    11742                      /*
     2857    11743                         a link record does not exist for this node
     2858    11744                      */
     2859    11745    3                 KS_LINK = '0'B;

  11745  4 001575   000000 470400 xsym               LDP0    KS_MSGBUF$
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:521  
         4 001576   000000 450100                    STZ     0,,PR0
         4 001577   000001 450100                    STZ     1,,PR0

     2860    11746    3                 END;  /* whenaltreturn  */

     2861    11747
     2862    11748    3               DO K = 0 TO OUT$BLK.NSUBLKS - 1;

  11748  4 001600   200032 450100                    STZ     K,,AUTO
         4 001601   001763 710000 4                  TRA     s:11794+3

     2863    11749    3                  OUT$ = OUT$BLK.SUBLK$(K);

  11749  4 001602   200003 470500                    LDP0    @TOP$,,AUTO
         4 001603   000000 471500                    LDP1    0,,PR0
         4 001604   200032 720100                    LXL0    K,,AUTO
         4 001605   100003 236110                    LDQ     3,X0,PR1
         4 001606   200027 756100                    STQ     OUT$,,AUTO

     2864    11750    3                  IF KS_LINK.LINKS# >= LNKS THEN

  11750  4 001607   000000 473400 xsym               LDP3    KS_MSGBUF$
         4 001610   300000 236100                    LDQ     0,,PR3
         4 001611   200037 116100                    CMPQ    LNKS,,AUTO
         4 001612   001641 602000 4                  TNC     s:11763

     2865    11751    4                     DO;

     2866    11752    4                        KS_SUB_BUF_1.COUNT = SIZEC(LNKS);

  11752  4 001613   004000 236003                    LDQ     2048,DU
         4 001614   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2867    11753    4                        CALL BINCHAR (KS_SUB_BUF_1.TEXT,LNKS);

  11753  4 001615   200037 235100                    LDA     LNKS,,AUTO
         4 001616   000044 773000                    LRL     36
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:522  
         4 001617   200042 757100                    STAQ    LINK_NR+1,,AUTO
         4 001620   000000 301500                    BTD
         4 001621   200042 000010                    NDSC9   LINK_NR+1,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         4 001622   000000 230037 xsym               NDSC9   KS_SUB_BUF_1             cn=1,s=nosgn,sf=0,n=31

     2868    11754    4                        KS_SUB_BUF_2.COUNT = OUT$->OUT$SYM.COUNT;

  11754  4 001623   200027 471500                    LDP1    OUT$,,AUTO
         4 001624   100004 236100                    LDQ     4,,PR1
         4 001625   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     2869    11755    4                        KS_SUB_BUF_2.TEXT = OUT$->OUT$SYM.TEXT;

  11755  4 001626   100004 236100                    LDQ     4,,PR1
         4 001627   000033 772000                    QRL     27
         4 001630   000000 621006                    EAX1    0,QL
         4 001631   040000 100540                    MLR     fill='040'O
         4 001632   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 001633   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

     2870    11756    4                       CALL KSE$ERRMSG(%E$KS_TOOMANYLINKS,VECTOR(KS_SUB_BUF_1),VECTOR(
             11756                                 KS_SUB_BUF_2));

  11756  4 001634   000073 630400 5                  EPPR0   59
         4 001635   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001636   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001637   000000 011000                    NOP     0

     2871    11757              /*E* ERROR:    KSN-E$KS_TOOMANYLINKS-0
     2872    11758         MESSAGE: Only %U1 links may be defined for this node. Link .%U2 has not been defin
             11758        ed.
     2873    11759                 MESSAGE1: In order to define more links, set MAXLINKS to a higher value.*/
     2874    11760    4                     END;

  11760  4 001640   001760 710000 4                  TRA     s:11794

     2875    11761    3                  ELSE
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:523  
     2876    11762    4                     DO;

     2877    11763    4                        TEMP_LINK = '0'B;

  11763  4 001641   000000 221003                    LDX1    0,DU
         4 001642   002444 741000 1                  STX1    TEMP_LINK

     2878    11764    4                        OFFSET = 4 - OUT$->OUT$SYM.COUNT;

  11764  4 001643   200027 471500                    LDP1    OUT$,,AUTO
         4 001644   100004 236100                    LDQ     4,,PR1
         4 001645   000033 772000                    QRL     27
         4 001646   000027 676000 xsym               ERQ     B_VECTNIL+23
         4 001647   000005 036007                    ADLQ    5,DL
         4 001650   200040 756100                    STQ     OFFSET,,AUTO

     2879    11765    5                        DO J = OFFSET TO 3;

  11765  4 001651   200035 756100                    STQ     J,,AUTO
         4 001652   001673 710000 4                  TRA     s:11768+1

     2880    11766    5                           CALL INDEX (TEMP,SUBSTR(OUT$->OUT$SYM.TEXT,J-OFFSET,1),
             11766                                    HEX_CHARS);

  11766  4 001653   200027 470500                    LDP0    OUT$,,AUTO
         4 001654   000004 236100                    LDQ     4,,PR0
         4 001655   000033 772000                    QRL     27
         4 001656   000000 620006                    EAX0    0,QL
         4 001657   200035 236100                    LDQ     J,,AUTO
         4 001660   200040 136100                    SBLQ    OFFSET,,AUTO
         4 001661   000106 124400                    SCM     mask='000'O
         4 001662   000000 000020 2                  ADSC9   HEX_CHARS                cn=0,n=16
         4 001663   000004 200001                    ADSC9   4,Q,PR0                  cn=1,n=1
         4 001664   200036 000100                    ARG     TEMP,,AUTO

     2881    11767    5                           HEX$(J)->HEX = TEMP;

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:524  
  11767  4 001665   200035 721100                    LXL1    J,,AUTO
         4 001666   002440 471411 1                  LDP1    HEX$,X1
         4 001667   003100 061500                    CSR     bolr='003'O
         4 001670   200036 000044                    BDSC    TEMP,,AUTO               by=0,bit=0,n=36
         4 001671   100000 000004                    BDSC    0,,PR1                   by=0,bit=0,n=4

     2882    11768    5                        END;

  11768  4 001672   200035 054100                    AOS     J,,AUTO
         4 001673   200035 235100                    LDA     J,,AUTO
         4 001674   000003 115007                    CMPA    3,DL
         4 001675   001653 604400 4                  TMOZ    s:11766

     2883    11769    5   DUP_LINK_LOOP:       DO J = 0 TO KS_LINK.LINKS# - 1;

  11769  4 001676   200035 450100       DUP_LINK_LO* STZ     J,,AUTO
         4 001677   001710 710000 4                  TRA     s:11772+1

     2884    11770    5                           IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN

  11770  4 001700   200035 235100                    LDA     J,,AUTO
         4 001701   000001 735000                    ALS     1
         4 001702   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001703   000105 106400                    CMPC    fill='000'O
         4 001704   002444 000002 1                  ADSC9   TEMP_LINK                cn=0,n=2
         4 001705   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
         4 001706   001715 600000 4                  TZE     s:11774

     2885    11771    5                              EXIT DUP_LINK_LOOP;
     2886    11772    5                        END;

  11772  4 001707   200035 054100                    AOS     J,,AUTO
         4 001710   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001711   200035 236100                    LDQ     J,,AUTO
         4 001712   001700 604000 4                  TMI     s:11770
         4 001713   000000 116100                    CMPQ    0,,PR0
         4 001714   001700 602000 4                  TNC     s:11770
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:525  

     2887    11773
     2888    11774    4                        IF J = KS_LINK.LINKS# THEN

  11774  4 001715   200035 236100                    LDQ     J,,AUTO
         4 001716   001733 604000 4                  TMI     s:11781
         4 001717   000000 116100                    CMPQ    0,,PR0
         4 001720   001733 601000 4                  TNZ     s:11781

     2889    11775    5                           DO;

     2890    11776    5                              KS_LINK.CHANNEL(KS_LINK.LINKS#) = TEMP_LINK;

  11776  4 001721   000000 235100                    LDA     0,,PR0
         4 001722   000001 735000                    ALS     1
         4 001723   000105 100400                    MLR     fill='000'O
         4 001724   002444 000002 1                  ADSC9   TEMP_LINK                cn=0,n=2
         4 001725   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2

     2891    11777    5                              KS_LINK.LINKS# = KS_LINK.LINKS# + 1;

  11777  4 001726   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 001727   000000 235100                    LDA     0,,PR0
         4 001730   000001 035007                    ADLA    1,DL
         4 001731   000000 755100                    STA     0,,PR0

     2892    11778    5                           END;

  11778  4 001732   001760 710000 4                  TRA     s:11794

     2893    11779    4                        ELSE
     2894    11780    5                           DO;

     2895    11781    5                              KS_SUB_BUF_1.COUNT = OUT$->OUT$SYM.COUNT;

  11781  4 001733   200027 471500                    LDP1    OUT$,,AUTO
         4 001734   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:526  
         4 001735   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     2896    11782    5                              KS_SUB_BUF_1.TEXT = OUT$->OUT$SYM.TEXT;

  11782  4 001736   100004 236100                    LDQ     4,,PR1
         4 001737   000033 772000                    QRL     27
         4 001740   000000 620006                    EAX0    0,QL
         4 001741   040000 100540                    MLR     fill='040'O
         4 001742   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 001743   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     2897    11783    5                             CALL BINCHAR (LINK_NR,J);

  11783  4 001744   000100 301500                    BTD
         4 001745   200035 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
         4 001746   200041 030001                    NDSC9   LINK_NR,,AUTO            cn=0,s=nosgn,sf=0,n=1

     2898    11784    5                             KS_SUB_BUF_2.TEXT = LINK_NR;

  11784  4 001747   040000 100500                    MLR     fill='040'O
         4 001750   200041 000001                    ADSC9   LINK_NR,,AUTO            cn=0,n=1
         4 001751   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

     2899    11785    5                             KS_SUB_BUF_2.COUNT = SIZEC(LINK_NR);

  11785  4 001752   001000 236003                    LDQ     512,DU
         4 001753   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     2900    11786    5                              CALL KSE$ERRMSG(%E$KS_DUPLICATELINKS,

  11786  4 001754   000077 630400 5                  EPPR0   63
         4 001755   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001756   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001757   000000 011000                    NOP     0

     2901    11787    5                                              VECTOR(KS_SUB_BUF_1),
     2902    11788    5                                              VECTOR(KS_SUB_BUF_2));
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:527  
     2903    11789
     2904    11790                 /*E*  ERROR: KSN-E$KS_DUPLICATELINKS-0
     2905    11791                       MESSAGE:  .%U1 is a duplicate of link # %U2 */
     2906    11792    5                           END;

     2907    11793    4                     END;

     2908    11794    3               END;

  11794  4 001760   200032 235100                    LDA     K,,AUTO
         4 001761   000001 035007                    ADLA    1,DL
         4 001762   200032 755100                    STA     K,,AUTO
         4 001763   200003 470500                    LDP0    @TOP$,,AUTO
         4 001764   000000 471500                    LDP1    0,,PR0
         4 001765   100001 236100                    LDQ     1,,PR1
         4 001766   000022 772000                    QRL     18
         4 001767   200032 116100                    CMPQ    K,,AUTO
         4 001770   001772 600000 4                  TZE     s:11795
         4 001771   001602 603000 4                  TRC     s:11749

     2909    11795    2              WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  11795  4 001772   000052 237000 5                  LDAQ    42
         4 001773   006210 757000 1                  STAQ    WRITE_NETCON+4

     2910    11796    2              WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  11796  4 001774   000054 237000 5                  LDAQ    44
         4 001775   006206 757000 1                  STAQ    WRITE_NETCON+2

     2911    11797    2              IF KS_LINK.LINKS# <= 0 THEN

  11797  4 001776   000000 471400 xsym               LDP1    KS_MSGBUF$
         4 001777   100000 235100                    LDA     0,,PR1
         4 002000   002006 601000 4                  TNZ     s:11800

     2912    11798    2                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) - 1;
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:528  

  11798  4 002001   006210 236000 1                  LDQ     WRITE_NETCON+4
         4 002002   177777 376007                    ANQ     65535,DL
         4 002003   600000 276007                    ORQ     -65536,DL
         4 002004   006210 756000 1                  STQ     WRITE_NETCON+4
         4 002005   002015 710000 4                  TRA     s:11802

     2913    11799    2              ELSE
     2914    11800    2                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +

  11800  4 002006   100000 236100                    LDQ     0,,PR1
         4 002007   000001 736000                    QLS     1
         4 002010   000003 036007                    ADLQ    3,DL
         4 002011   000020 736000                    QLS     16
         4 002012   006210 676000 1                  ERQ     WRITE_NETCON+4
         4 002013   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 002014   006210 656000 1                  ERSQ    WRITE_NETCON+4

     2915    11801    2                                          (SIZEC(KS_LINK.CHANNEL(0)) * KS_LINK.LINKS#)
             11801                                                    - 1;
     2916    11802    2              CALL M$WRITE (WRITE_NETCON) ALTRET(DEF_ERR);

  11802  4 002015   006204 630400 1                  EPPR0   WRITE_NETCON
         4 002016   440001 713400                    CLIMB   alt,write
         4 002017   401400 401760                    pmme    nvectors=4
         4 002020   001525 702000 4                  TSX2    DEF_ERR

     2917    11803
     2918    11804    2           END;  /* DO CASE */

     2919    11805    1   END KSC$DEFINE;

  11805  4 002021   000000 702200 xent               TSX2  ! X66_ARET
     2920    11806         %EOD;

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:529  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$DEFINE.
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:530  

 **** Variables and constants ****

  ****  Section 001  Data  KSC$DEFINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  3413-0-0/w PTR         r     1 DEFAULT$
  3331-0-0/w UBIN        r     1 DEFAULT_BUF(0:49)
  6165-0-0/w PTR         r     1 HDR$                    2440-0-0/w PTR         r     1 HEX$(0:3)
  3414-0-0/w PTR         r     1 HNDLR$
  3415-0-0/c CHAR        r     1 HNDLR_BUF(0:400)
  3326-0-0/w STRC(99)    r     1 KS_DEFAULT_KEY          2405-0-0/w STRC(936)   r     1 KS_FEPBOOT
  2437-0-0/w STRC(27)    r     1 KS_FEPBOOT_KEY          2445-0-0/w STRC(792)   r     1 KS_FEPCTL
  2473-0-0/w STRC(27)    r     1 KS_FEPCTL_KEY           2474-0-0/w STRC(1656)  r     1 KS_FEPHNDLR
  2552-0-0/w STRC(27)    r     1 KS_FEPHNDLR_KEY         2401-0-0/w STRC(99)    r     1 KS_HANDLER_KEY
  2404-0-0/w STRC(27)    r     1 KS_LINK_KEY             6220-0-0/d STRC(432)   r     1 KS_MONINFO
  6234-0-0/d STRC(540)   r     1 KS_MONINFO_V               0-0-0/w STRC(46116) r     1 KS_NETWORK
  3562-0-0/w STRC(18)    r     1 KS_NETWORK_KEY          3322-0-0/w STRC(108)   r     1 KS_NODEINFO
  3325-0-0/w STRC(18)    r     1 KS_NODEINFO_KEY         3564-0-0/w STRC(46116) r     1 KS_RFEP
  3563-0-0/w STRC(18)    r     1 KS_RFEP_KEY             6166-0-0/d STRC(504)   r     1 READ_NETCON
  2444-0-0/b STRC(18)    r     1 TEMP_LINK               6204-0-0/d STRC(432)   r     1 WRITE_NETCON

  ****  Section 002 RoData KSC$DEFINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(16)    r     1 HEX_CHARS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                     25-0-0/c CHAR(8)     r     1 CONTROL_NODE
    30-0-0/w PTR         r     1 DFLT$                     31-0-0/w PTR         r     1 DFLT_OPT$
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:531  
    23-0-0/w UBIN        r     1 FEX                       33-0-0/w UBIN        r     1 HAND#
    22-0-0/w UBIN        r     1 I                         35-0-0/w SBIN        r     1 J
    32-0-0/w UBIN        r     1 K
     7-0-0/c CHAR(4)     r     1 LINK_LIST(0:10)
    41-0-0/c CHAR        r     1 LINK_NR                   37-0-0/w UBIN        r     1 LNKS
     4-0-0/c CHAR(8)     r     1 NODENAME                  24-0-0/w UBIN        r     1 NODETYPE
     6-0-0/w SBIN        r     1 NRLINKS                   40-0-0/w UBIN        r     1 OFFSET
    27-0-0/w PTR         r     1 OUT$                      36-0-0/w UBIN        r     1 TEMP
    *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w STRC(180)   r     1 KS_HAND_INFO(0:0)
     0-0-0/c CHAR(400)   r     1 KS_MSGBUF                  0-0-0/w PTR         r     1 KS_MSGBUF$
     0-0-0/w SBIN        r     1 KS_NODE                    0-0-0/w STRC(288)   r     1 KS_SUB_BUF_1
     0-0-0/w STRC(288)   r     1 KS_SUB_BUF_2               0-0-0/w PTR         r     1 KS_TBL(0:0)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/h UBIN(18)    r     1 B$PARAMI(0:0)
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/b UBIN(4)     r     1 HEX
     0-0-0/w STRC(144)   r     1 KS$PARAM(0:0)
     0-0-0/w ASTR(387)   r     1 KS_DEFAULT                 0-0-0/w STRC(1062)  r     1 KS_HANDLER
     0-0-0/w STRC(54)    r     1 KS_LINK                    0-0-0N  NULL        r     1 M$NETCON
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(306)   r     1 UPDATE

PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:532  

   Procedure KSC$DEFINE requires 1042 words for executable code.
   Procedure KSC$DEFINE requires 38 words of local(AUTO) storage.
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:533  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:534  
          MINI XREF LISTING

B$ALT.CODE
     10956**DCL     10956--REDEF   10957--REDEF   10957--REDEF
B$ALT.ERR.CODE
     10958**DCL     11453>>IF
B$ALT.ERR.ERR#
     10958**DCL     10958--REDEF
B$ALT.EVID
     10957**DCL     10957--REDEF   10957--REDEF
B$PARAMI
     10721**DCL     11648<<ASSIGN
B$TCB.ALT$
     10952**DCL     11453>>IF
B$TCB$
     10238**DCL     11453>>IF
CHECK_DUP
     11687**LABEL   11689--EXIT
CONTROL_NODE
     11222**DCL     11404<<ASSIGN  11417<<ASSIGN  11437<<ASSIGN  11481>>IF      11481>>IF      11519>>ASSIGN
DEFAULT$
     10643**DCL     10811--IMP-PTR 11612>>CALL    11612>>CALL    11613>>CALL    11613>>CALL
DEFAULT_BUF
     10642**DCL     10643--DCLINIT
DEF_ERR
     11717**LABEL   11403--CALLALT 11454--GOTO    11524--CALLALT 11529--CALLALT 11564--CALLALT 11574--CALLALT
     11607--CALLALT 11664--CALLALT 11704--CALLALT 11714--CALLALT 11802--CALLALT
DFLT$
     11224**DCL     11627<<ASSIGN  11634>>ASSIGN  11643>>ASSIGN
DFLT_OPT$
     11225**DCL     11643<<ASSIGN  11648>>ASSIGN
DUP_LINK_LOOP
     11769**LABEL   11771--EXIT
F$DCB.ACTPOS
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:535  
      5244**DCL      5244--REDEF
F$DCB.ARS
      5219**DCL      5219--REDEF
F$DCB.ATTR
      5237**DCL      5238--REDEF
F$DCB.BORROW
      5252**DCL      5252--REDEF    5252--REDEF    5252--REDEF
F$DCB.DCBNAME.L
      5266**DCL      5266--IMP-SIZ
F$DCB.EOMCHAR
      5223**DCL      5223--REDEF
F$DCB.FLDID
      5247**DCL      5247--REDEF
F$DCB.FORM$
      5241**DCL      5241--REDEF
F$DCB.FSECT
      5257**DCL      5257--REDEF
F$DCB.FSN
      5234**DCL      5234--REDEF    5234--REDEF    5235--REDEF
F$DCB.HEADER$
      5240**DCL      5240--REDEF
F$DCB.IXTNSIZE
      5238**DCL      5238--REDEF
F$DCB.LASTSTA$
      5228**DCL      5228--REDEF
F$DCB.LVL
      5253**DCL      5253--REDEF
F$DCB.NAME.C
      5228**DCL      5228--REDEF
F$DCB.NOEOF
      5249**DCL      5249--REDEF
F$DCB.NRECS
      5239**DCL      5239--REDEF
F$DCB.NRECX
      5258**DCL      5258--REDEF
F$DCB.OHDR
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:536  
      5250**DCL      5250--REDEF
F$DCB.ORG
      5233**DCL      5233--REDEF
F$DCB.PRECNO
      5256**DCL      5256--REDEF
F$DCB.RCSZ
      5261**DCL      5261--REDEF
F$DCB.RES
      5229**DCL      5229--REDEF
F$DCB.SETX
      5241**DCL      5241--REDEF
F$DCB.TAB$
      5240**DCL      5241--REDEF
F$DCB.TDA
      5255**DCL      5255--REDEF
F$DCB.WSN
      5230**DCL      5230--REDEF
FEX
     11220**DCL     11399<<CALLBLT 11400>>CALLBLT 11438>>IF      11461>>IF      11503>>IF      11505>>DOINDEX
     11511>>ASSIGN  11512>>ASSIGN  11514>>ASSIGN  11515>>ASSIGN  11517>>ASSIGN  11518>>ASSIGN  11519>>ASSIGN
     11531>>ASSIGN  11532>>ASSIGN  11533>>ASSIGN  11534>>ASSIGN  11535>>ASSIGN  11698>>ASSIGN  11710>>ASSIGN
HAND#
     11227**DCL     11620<<DOINDEX 11621>>IF      11625>>ASSIGN  11627>>ASSIGN  11629>>IF      11630>>ASSIGN
     11637>>IF      11639>>ASSIGN  11642>>DOINDEX 11645>>ASSIGN
HDR$
     10693**DCL     11125--IMP-PTR 11717>>ASSIGN  11718>>CALL
HEX
     11108**DCL     11676<<ASSIGN  11767<<ASSIGN
HEX$
     10429**DCL     11676>>ASSIGN  11767>>ASSIGN
HEX_CHARS
     10321**DCL     11675>>CALLBLT 11766>>CALLBLT
HNDLR$
     10644**DCL     11060--IMP-PTR 11614>>ASSIGN  11616>>ASSIGN  11617>>CALLBLT 11618>>CALLBLT 11619>>ASSIGN
     11625>>ASSIGN  11630>>ASSIGN  11631>>ASSIGN  11633>>DOINDEX 11634>>ASSIGN  11639>>ASSIGN  11640>>ASSIGN
     11644>>ASSIGN  11644>>ASSIGN  11645>>ASSIGN  11647>>DOINDEX 11651>>ASSIGN  11656>>ASSIGN  11657>>IF
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:537  
     11659>>ASSIGN  11663>>ASSIGN
HNDLR_BUF
     10645**DCL     10644--DCLINIT
I
     11219**DCL     11407<<DOINDEX 11408>>DOCASE  11411>>ASSIGN  11411>>ASSIGN  11414>>ASSIGN  11417>>ASSIGN
     11417>>ASSIGN  11419>>ASSIGN  11421>>ASSIGN  11421>>ASSIGN  11472<<DOINDEX 11473>>IF      11476>>ASSIGN
     11477>>ASSIGN  11481>>IF      11481>>IF      11481>>IF      11491>>IF      11494>>ASSIGN  11495>>ASSIGN
     11505<<DOINDEX 11506>>ASSIGN  11507>>ASSIGN  11508>>ASSIGN  11509>>ASSIGN  11545<<DOINDEX 11546>>ASSIGN
     11546>>ASSIGN  11567<<DOINDEX 11568>>ASSIGN  11568>>ASSIGN  11647<<DOINDEX 11648>>ASSIGN  11648>>ASSIGN
     11669<<DOINDEX 11673>>IF      11675>>CALLBLT 11680>>IF
J
     11229**DCL     11420<<DOINDEX 11421>>ASSIGN  11421>>ASSIGN  11421>>ASSIGN  11610<<DOINDEX 11611>>ASSIGN
     11615>>ASSIGN  11616>>ASSIGN  11619>>ASSIGN  11672<<DOINDEX 11673>>IF      11675>>CALLBLT 11687<<DOINDEX
     11688>>IF      11691>>IF      11765<<DOINDEX 11766>>CALLBLT 11767>>ASSIGN  11769<<DOINDEX 11770>>IF
     11774>>IF      11783>>CALLBLT
K
     11226**DCL     11633<<DOINDEX 11634>>ASSIGN  11634>>ASSIGN  11642<<DOINDEX 11643>>ASSIGN  11644>>ASSIGN
     11645>>ASSIGN  11645>>ASSIGN  11647>>DOINDEX 11651>>ASSIGN  11670<<ASSIGN  11676>>ASSIGN  11677<<ASSIGN
     11677>>ASSIGN  11748<<DOINDEX 11749>>ASSIGN
KS$PARAM.ARRAY_SZ
     10764**DCL     11645>>ASSIGN
KS$PARAM.DEFAULT
     10788**DCL     11546>>ASSIGN  11568>>ASSIGN  11634>>ASSIGN  11648>>ASSIGN
KS$PARAM.SPCL_TBL$
     10781**DCL     11643>>ASSIGN
KSE$ERRMSG
     10168**DCL-ENT 11431--CALL    11443--CALL    11465--CALL    11478--CALL    11486--CALL    11496--CALL
     11722--CALL    11723--CALL    11733--CALL    11756--CALL    11786--CALL
KSR$WR_HLPCG
     10169**DCL-ENT 11718--CALL
KSU$INIT_DEFCNFG
     10170**DCL-ENT 11612--CALL
KSU$WRITE_NETCON
     10171**DCL-ENT 11613--CALL
KS_DEFAULT
     10811**DCL     11612<>CALL    11613--CALL
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:538  
KS_DEFAULT.LGN.LGNSIZE
     10948**DCL     10949--IMP-SIZ 11612>>CALL    11613>>CALL
KS_DEFAULT_KEY
     10636**DCL     11613--CALL
KS_DEFAULT_KEY.HNDLR
     10640**DCL     11611<<ASSIGN
KS_DEFAULT_KEY.NODE
     10639**DCL     11535<<ASSIGN
KS_FEPBOOT
     10399**DCL     11563--ASSIGN  11730--ASSIGN
KS_FEPBOOT.BOOTFID
     10400**DCL     11543<<ASSIGN
KS_FEPBOOT.BOOTPARAMS
     10406**DCL     11544<<ASSIGN  11546<<ASSIGN  11548<<ASSIGN  11549<<ASSIGN  11550<<ASSIGN  11551<<ASSIGN
     11552<<ASSIGN  11553<<ASSIGN  11554<<ASSIGN  11555<<ASSIGN  11556<<ASSIGN  11557<<ASSIGN  11558<<ASSIGN
     11559<<ASSIGN  11560<<ASSIGN  11561<<ASSIGN  11736>>ASSIGN
KS_FEPBOOT_KEY
     10424**DCL     11562--ASSIGN  11731--ASSIGN
KS_FEPBOOT_KEY.NODE
     10427**DCL     11531<<ASSIGN  11729<<ASSIGN
KS_FEPCTL
     10454**DCL     11573--ASSIGN
KS_FEPCTL.NPARAMS
     10455**DCL     11570<<ASSIGN
KS_FEPCTL.PARAMS
     10457**DCL     11568<<ASSIGN
KS_FEPCTL_KEY
     10474**DCL     11572--ASSIGN
KS_FEPCTL_KEY.NODE
     10477**DCL     11532<<ASSIGN
KS_FEPHNDLR
     10492**DCL     11600--ASSIGN
KS_FEPHNDLR.BOOTIME
     10499**DCL     11584<<ASSIGN  11585<<ASSIGN  11586<<ASSIGN  11595<<ASSIGN  11596<<ASSIGN  11597<<ASSIGN
KS_FEPHNDLR.DEFLIBACCT
     10496**DCL     11583<<ASSIGN  11594<<ASSIGN  11605--ASSIGN
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:539  
KS_FEPHNDLR.HANDLER
     10503**DCL     11580<<ASSIGN  11581<<ASSIGN  11582<<ASSIGN  11591<<ASSIGN  11592<<ASSIGN  11593<<ASSIGN
     11605--ASSIGN  11611>>ASSIGN  11615>>ASSIGN  11616>>ASSIGN  11619>>ASSIGN
KS_FEPHNDLR.NHANDLERS
     10493**DCL     11579<<ASSIGN  11590<<ASSIGN  11605--ASSIGN  11605>>ASSIGN  11610>>DOINDEX
KS_FEPHNDLR_KEY
     10522**DCL     11599--ASSIGN
KS_FEPHNDLR_KEY.NODE
     10525**DCL     11533<<ASSIGN
KS_HANDLER
     11060**DCL     11614<<ASSIGN  11640--ASSIGN  11640--ASSIGN  11644--ASSIGN  11656--ASSIGN  11659--ASSIGN
     11660--ASSIGN  11663--ASSIGN
KS_HANDLER.HNDLRFID
     11061**DCL     11616<<ASSIGN  11617>>CALLBLT 11618<<CALLBLT
KS_HANDLER.HNDLRNAME
     11064**DCL     11619<<ASSIGN
KS_HANDLER.IPARAM.ARRAY_SZ
     11093**DCL     11645<<ASSIGN  11647>>DOINDEX 11651>>ASSIGN
KS_HANDLER.IPARAM.OFFSET
     11102**DCL     11644<<ASSIGN
KS_HANDLER.NPARAMI
     11082**DCL     11639<<ASSIGN  11657>>IF
KS_HANDLER.NPARAMS
     11077**DCL     11630<<ASSIGN  11631<<ASSIGN  11633>>DOINDEX
KS_HANDLER.PARAMS
     11087**DCL     11634<<ASSIGN
KS_HANDLER.TYPE
     11068**DCL     11625<<ASSIGN
KS_HANDLER_KEY
     10362**DCL     11655--ASSIGN
KS_HANDLER_KEY.HNDLR
     10366**DCL     11615<<ASSIGN  11621>>IF
KS_HANDLER_KEY.NODE
     10365**DCL     11534<<ASSIGN
KS_HAND_INFO.PARAMS$
     10232**DCL     11627>>ASSIGN  11645>>ASSIGN
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:540  
KS_HAND_INFO.SZ
     10227**DCL     11629>>IF      11630>>ASSIGN  11637>>IF      11639>>ASSIGN  11642>>DOINDEX
KS_HAND_INFO.TEXT
     10217**DCL     11621>>IF
KS_HAND_INFO.TYPE
     10221**DCL     11625>>ASSIGN
KS_LINK
      5148**DCL     11745<<ASSIGN
KS_LINK.CHANNEL
      5149**DCL     11682<<ASSIGN  11688>>IF      11693<<ASSIGN  11701--ASSIGN  11770>>IF      11776<<ASSIGN
     11800--ASSIGN
KS_LINK.LINKS#
      5148**DCL     11668<<ASSIGN  11683<<ASSIGN  11683>>ASSIGN  11687>>DOINDEX 11691>>IF      11693>>ASSIGN
     11694<<ASSIGN  11694>>ASSIGN  11701>>ASSIGN  11701--ASSIGN  11750>>IF      11769>>DOINDEX 11774>>IF
     11776>>ASSIGN  11777<<ASSIGN  11777>>ASSIGN  11797>>IF      11798--ASSIGN  11800>>ASSIGN  11800--ASSIGN
KS_LINK_KEY
     10381**DCL     11700--ASSIGN  11740--ASSIGN  11796--ASSIGN
KS_LINK_KEY.NODE
     10384**DCL     11698<<ASSIGN  11738<<ASSIGN
KS_MONINFO
     11346**DCL     11403<>CALL
KS_MONINFO_V
     11361**DCL     11346--DCLINIT
KS_MONINFO_V.NODE_NAME
     11364**DCL     11404>>ASSIGN
KS_MONINFO_V.NUM_NODES
     11365**DCL     11438>>IF      11440>>CALLBLT 11471>>ASSIGN
KS_MSGBUF
      5148**DCL     10693--DCLINIT 11699--ASSIGN  11739--ASSIGN  11795--ASSIGN
KS_MSGBUF$
      5148**DCL      5148--IMP-PTR 11668>>ASSIGN  11682>>ASSIGN  11683>>ASSIGN  11683>>ASSIGN  11687>>DOINDEX
     11688>>IF      11691>>IF      11693>>ASSIGN  11693>>ASSIGN  11694>>ASSIGN  11694>>ASSIGN  11701>>ASSIGN
     11745>>ASSIGN  11750>>IF      11769>>DOINDEX 11770>>IF      11774>>IF      11776>>ASSIGN  11776>>ASSIGN
     11777>>ASSIGN  11777>>ASSIGN  11797>>IF      11800>>ASSIGN
KS_MYSTATION
      5144**DCL      5144--REDEF
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:541  
KS_NETWORK
     10280**DCL     11451--ASSIGN  11459>>ASSIGN  11521--ASSIGN  11522--ASSIGN
KS_NETWORK.NODE
     10283**DCL     11522--ASSIGN  11522--ASSIGN
KS_NETWORK.NODE.CONTROL_NODE
     10290**DCL     11491>>IF      11519<<ASSIGN
KS_NETWORK.NODE.NODE
     10289**DCL     11461>>IF      11473>>IF      11476--ASSIGN  11477>>ASSIGN  11481>>IF      11494--ASSIGN
     11495>>ASSIGN  11507<<ASSIGN  11518<<ASSIGN
KS_NETWORK.NODE.TYPE
     10286**DCL     11481>>IF      11481>>IF      11506<<ASSIGN  11514<<ASSIGN  11517<<ASSIGN
KS_NETWORK.NODE#
     10281**DCL     11471<<ASSIGN  11472>>DOINDEX 11503>>IF      11505>>DOINDEX 11511<<ASSIGN  11522>>ASSIGN
KS_NETWORK_KEY
     10659**DCL     11450--ASSIGN  11520--ASSIGN
KS_NODE
      5145**DCL     11729>>ASSIGN  11738>>ASSIGN
KS_NODEINFO
     10602**DCL     11712--ASSIGN
KS_NODEINFO.NODE#
     10603**DCL     11710<<ASSIGN
KS_NODEINFO.NODENAME
     10604**DCL     11711<<ASSIGN
KS_NODEINFO_KEY
     10619**DCL     11713--ASSIGN
KS_RFEP
     10679**DCL     11457--ASSIGN  11459<<ASSIGN  11526--ASSIGN  11527--ASSIGN
KS_RFEP.NODE
     10682**DCL     11527--ASSIGN  11527--ASSIGN
KS_RFEP.NODE.NODE
     10688**DCL     11509<<ASSIGN
KS_RFEP.NODE.TYPE
     10685**DCL     11508<<ASSIGN  11515<<ASSIGN
KS_RFEP.NODE#
     10680**DCL     11512<<ASSIGN  11527>>ASSIGN
KS_RFEP_KEY
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:542  
     10663**DCL     11456--ASSIGN  11525--ASSIGN
KS_SUB_BUF_1
      5149**DCL     11431--CALL    11443--CALL    11465--CALL    11478--CALL    11496--CALL    11723--CALL
     11756--CALL    11786--CALL
KS_SUB_BUF_1.COUNT
      5149**DCL     11428<<ASSIGN  11442<<ASSIGN  11463<<ASSIGN  11476<<ASSIGN  11494<<ASSIGN  11752<<ASSIGN
     11781<<ASSIGN
KS_SUB_BUF_1.TEXT
      5149**DCL     11427<<ASSIGN  11440<<CALLBLT 11441<<ASSIGN  11441>>ASSIGN  11464<<ASSIGN  11477<<ASSIGN
     11495<<ASSIGN  11753<<CALLBLT 11782<<ASSIGN
KS_SUB_BUF_2
      5149**DCL     11756--CALL    11786--CALL
KS_SUB_BUF_2.COUNT
      5150**DCL     11754<<ASSIGN  11785<<ASSIGN
KS_SUB_BUF_2.TEXT
      5150**DCL     11755<<ASSIGN  11784<<ASSIGN
KS_TBL
     10239**DCL     11546>>ASSIGN  11568>>ASSIGN
LINK_LIST
     11218**DCL     11421<<ASSIGN  11673>>IF      11675>>CALLBLT
LINK_NR
     11233**DCL     11783<<CALLBLT 11784>>ASSIGN  11785--ASSIGN
LNKS
     11231**DCL     11736<<ASSIGN  11750>>IF      11752--ASSIGN  11753>>CALLBLT
M$MONINFO
        87**DCL-ENT 11403--CALL
M$READ
        20**DCL-ENT 11452--CALL    11458--CALL    11732--CALL    11741--CALL
M$WRITE
        20**DCL-ENT 11524--CALL    11529--CALL    11564--CALL    11574--CALL    11607--CALL    11664--CALL
     11704--CALL    11714--CALL    11802--CALL
NODENAME
     11216**DCL     11400<<CALLBLT 11401<<ASSIGN  11411<<ASSIGN  11427>>ASSIGN  11428--ASSIGN  11473>>IF
     11491>>IF      11518>>ASSIGN  11711>>ASSIGN
NODETYPE
     11221**DCL     11402<<ASSIGN  11414<<ASSIGN  11429>>IF      11436>>IF      11436>>IF      11491>>IF
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:543  
     11491>>IF      11514>>ASSIGN  11515>>ASSIGN  11516>>IF      11539>>DOCASE  11577>>IF
NRLINKS
     11217**DCL     11405<<ASSIGN  11419<<ASSIGN  11420>>DOINDEX 11429>>IF      11669>>DOINDEX
OFFSET
     11232**DCL     11764<<ASSIGN  11765>>DOINDEX 11766>>CALLBLT
OUT$
     11223**DCL     11640<<ASSIGN  11644>>ASSIGN  11648>>ASSIGN  11651<<ASSIGN  11651>>ASSIGN  11659<<ASSIGN
     11660<<ASSIGN  11660>>ASSIGN  11663>>ASSIGN  11749<<ASSIGN  11754>>ASSIGN  11755>>ASSIGN  11755>>ASSIGN
     11764>>ASSIGN  11766>>CALLBLT 11766>>CALLBLT 11781>>ASSIGN  11782>>ASSIGN  11782>>ASSIGN
OUT$BLK.CODE
     10976**DCL     11397>>DOCASE  11408>>DOCASE  11414>>ASSIGN
OUT$BLK.NSUBLKS
     10980**DCL     11407>>DOINDEX 11419>>ASSIGN  11748>>DOINDEX
OUT$BLK.SUBLK$
     11001**DCL     11399>>CALLBLT 11399>>CALLBLT 11408>>DOCASE  11411>>ASSIGN  11411>>ASSIGN  11411>>ASSIGN
     11411>>ASSIGN  11414>>ASSIGN  11414>>ASSIGN  11417>>ASSIGN  11417>>ASSIGN  11417>>ASSIGN  11417>>ASSIGN
     11419>>ASSIGN  11421>>ASSIGN  11421>>ASSIGN  11421>>ASSIGN  11421>>ASSIGN  11463>>ASSIGN  11463>>ASSIGN
     11464>>ASSIGN  11464>>ASSIGN  11749>>ASSIGN
OUT$SYM.COUNT
     11037**DCL     11040--IMP-SIZ 11399>>CALLBLT 11411>>ASSIGN  11417>>ASSIGN  11421>>ASSIGN  11463>>ASSIGN
     11464>>ASSIGN  11754>>ASSIGN  11755>>ASSIGN  11764>>ASSIGN  11766>>CALLBLT 11781>>ASSIGN  11782>>ASSIGN
OUT$SYM.TEXT
     11040**DCL     11399>>CALLBLT 11411>>ASSIGN  11417>>ASSIGN  11421>>ASSIGN  11463--ASSIGN  11464>>ASSIGN
     11755>>ASSIGN  11766>>CALLBLT 11782>>ASSIGN
READ_NETCON
     11280**DCL     11452<>CALL    11458<>CALL    11732<>CALL    11741<>CALL
READ_NETCON.BUF_
     11282**DCL     11451<<ASSIGN  11457<<ASSIGN  11730<<ASSIGN  11739<<ASSIGN
READ_NETCON.KEY_
     11280**DCL     11450<<ASSIGN  11456<<ASSIGN  11731<<ASSIGN  11740<<ASSIGN
READ_NETCON.STATION_
     11283**DCL     11284--REDEF
READ_NETCON.V
     11284**DCL     11280--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
     11295**DCL     11295--REDEF
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:544  
READ_NETCON.V.INDX#
     11293**DCL     11293--REDEF
TEMP
     11230**DCL     11617<<CALLBLT 11618>>CALLBLT 11675<<CALLBLT 11676>>ASSIGN  11766<<CALLBLT 11767>>ASSIGN
TEMP_LINK
     10434**DCL     11671<<ASSIGN  11682>>ASSIGN  11688>>IF      11693>>ASSIGN  11763<<ASSIGN  11770>>IF
     11776>>ASSIGN
TEMP_LINK.HEX0
     10436**DCL     10430--DCLINIT
TEMP_LINK.HEX1
     10437**DCL     10431--DCLINIT
TEMP_LINK.HEX2
     10439**DCL     10432--DCLINIT
TEMP_LINK.HEX3
     10440**DCL     10433--DCLINIT
TOP$
         8**DCL         6--PROC    10968--IMP-PTR 11397>>DOCASE  11399>>CALLBLT 11399>>CALLBLT 11407>>DOINDEX
     11408>>DOCASE  11411>>ASSIGN  11411>>ASSIGN  11414>>ASSIGN  11417>>ASSIGN  11417>>ASSIGN  11419>>ASSIGN
     11421>>ASSIGN  11421>>ASSIGN  11463>>ASSIGN  11463>>ASSIGN  11464>>ASSIGN  11464>>ASSIGN  11748>>DOINDEX
     11749>>ASSIGN
UPDATE
     11125**DCL     11718--CALL
UPDATE.CODE
     11130**DCL     11717<<ASSIGN
WRITE_NETCON
     11320**DCL     11524<>CALL    11529<>CALL    11564<>CALL    11574<>CALL    11607<>CALL    11664<>CALL
     11704<>CALL    11714<>CALL    11802<>CALL
WRITE_NETCON.BUF_
     11320**DCL     11521<<ASSIGN  11526<<ASSIGN  11563<<ASSIGN  11573<<ASSIGN  11600<<ASSIGN  11656<<ASSIGN
     11699<<ASSIGN  11712<<ASSIGN  11795<<ASSIGN
WRITE_NETCON.BUF_.BOUND
     11320**DCL     11522<<ASSIGN  11527<<ASSIGN  11605<<ASSIGN  11663<<ASSIGN  11701<<ASSIGN  11798<<ASSIGN
     11800<<ASSIGN
WRITE_NETCON.KEY_
     11320**DCL     11520<<ASSIGN  11525<<ASSIGN  11562<<ASSIGN  11572<<ASSIGN  11599<<ASSIGN  11655<<ASSIGN
     11700<<ASSIGN  11713<<ASSIGN  11796<<ASSIGN
PL6.E3A0      #003=KSC$DEFINE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:47 Page:545  
WRITE_NETCON.STATION_
     11322**DCL     11322--REDEF
WRITE_NETCON.V
     11323**DCL     11320--DCLINIT
WRITE_NETCON.V.DVBYTE.VFC#
     11329**DCL     11329--REDEF

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:546  
     2921        1        /*T***********************************************************/
     2922        2        /*T*                                                         */
     2923        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2924        4        /*T*                                                         */
     2925        5        /*T***********************************************************/
     2926        6
     2927        7         KSC$UPDATE: PROC (TOP$) ALTRET;
     2928        8             /**/
     2929        9    1       DCL TOP$ PTR;
     2930       10             /**/
     2931       11        %INCLUDE KHA_FNC_E;
     2932      111        %INCLUDE CP_6;
     2933      192        %INCLUDE CP_6_SUBS;
     2934      732        %INCLUDE XU_MACRO_C;
     2935     3838        %INCLUDE KS_MACRO_M;
     2936     4035        %INCLUDE B_ERRORS_C;
     2937     5162        %INCLUDE KL_CONFIG_M;
     2938     5924        %INCLUDE KL_MACRO_C;
     2939     9276        %INCLUDE KS_SUBS_C;
     2940     9519        %INCLUDE KS_DATA_R;
     2941     9534        %INCLUDE KS_PERR_C;
     2942     9601        %INCLUDE KL_CONTROL_C;
     2943     9981        %INCLUDE KL_AFCN_C;
     2944    10082        /**/
     2945    10083        /*entry definitons*/
     2946    10084    1   DCL KSE$ERRMSG ENTRY(4);
     2947    10085    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
     2948    10086    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
     2949    10087    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
     2950    10088    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
     2951    10089    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
     2952    10090    1   DCL XUR$ERRCNVRT ENTRY(2);
     2953    10091    1   DCL KSW$WRITE ENTRY(11);
     2954    10092    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
     2955    10093    1   DCL KSU$GET_NODE ENTRY(3) ALTRET;
     2956    10094    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
     2957    10095        %KS$BOX(TITLE="symr variables");
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:547  

             10113    1   /***************************************************************************
             10114    1    *                                                                         *
             10115    1    *                               symr variables                            *
             10116    1    *                                                                         *
             10117    1    ***************************************************************************/

     2958    10122    1   DCL 1 PROMPT SYMREF,
     2959    10123    1        2 NODENAME CHAR(8),
     2960    10124    1        2 STAR CHAR(2);
     2961    10125        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=SYMREF);
     2962    10152        %KS$HAND_INFO (NAME=KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF", LAST=";");
     2963    10191        %KS$BOX(TITLE="symd variables");

             10209    1   /***************************************************************************
             10210    1    *                                                                         *
             10211    1    *                               symd variables                            *
             10212    1    *                                                                         *
             10213    1    ***************************************************************************/

     2964    10218        %KS$BOX(TITLE="cons variables");

             10236    1   /***************************************************************************
             10237    1    *                                                                         *
             10238    1    *                               cons variables                            *
             10239    1    *                                                                         *
             10240    1    ***************************************************************************/

     2965    10245    1   DCL HEX_CHARS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
     2966    10246        %KS$BOX(TITLE="stat variables");

             10264    1   /***************************************************************************
             10265    1    *                                                                         *
             10266    1    *                               stat variables                            *
             10267    1    *                                                                         *
             10268    1    ***************************************************************************/

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:548  
     2967    10273        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
     2968    10292        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
     2969    10311    1        DCL   DEFAULT$ PTR STATIC INIT(ADDR(DEFAULT_BUF));
     2970    10312    1        DCL   DEFAULT_BUF (0:49) UBIN WORD STATIC INIT(0*0);
     2971    10313    1   DCL CHAR_BUF(0:400) CHAR(1) STATIC;
     2972    10314    1   DCL HANDLER$ PTR STATIC INIT(ADDR(CHAR_BUF));
     2973    10315        %KL_HDR(FPTN=UPDATE,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     2974    10395    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
     2975    10396        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
     2976    10426    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
     2977    10427    1         2 CNT UBIN BYTE UNAL INIT(1),
     2978    10428    1         2 TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
     2979    10429    1         DCL   HEX$(0:3)   PTR  STATIC INIT(
     2980    10430    1                                          ADDR(TEMP_LINK.HEX0),
     2981    10431    1                                          ADDR(TEMP_LINK.HEX1),
     2982    10432    1                                          ADDR(TEMP_LINK.HEX2),
     2983    10433    1                                          ADDR(TEMP_LINK.HEX3));
     2984    10434    1   DCL   1  TEMP_LINK   STATIC,
     2985    10435    1            2  *        BIT(1) UNAL,
     2986    10436    1            2  HEX0     UBIN(4) UNAL,
     2987    10437    1            2  HEX1     UBIN(4) UNAL,
     2988    10438    1            2  *        BIT(1)  UNAL,
     2989    10439    1            2  HEX2     UBIN(4) UNAL,
     2990    10440    1            2  HEX3     UBIN(4) UNAL;
     2991    10441        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
     2992    10459        %KL$NETWORK (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
     2993    10486        %KL$LINK_KEY(NAME=KS_LINK_KEY,STCLASS=STATIC);
     2994    10504        %FPT_READ (FPTN=READ_NETCON,DCB=M$NETCON,KEYS=YES);
     2995    10543        %FPT_DELREC (FPTN=DELREC_NETCON,DCB=M$NETCON);
     2996    10562        %FPT_WRITE (FPTN=WRITE_NETCON,DCB=M$NETCON);
     2997    10593        %KS$PARAM (NAME=KS$PARAM,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
     2998    10663        %KL$LINCNFG(NAME=KS_DEFAULT,STCLASS="BASED(DEFAULT$)");
     2999    10821    1   DCL B$PARAMI(0:0) UBIN HALF BASED HALIGNED;
     3000    10822        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
     3001    10839    1   DCL M$NETCON DCB;
     3002    10840        %KS$BOX(TITLE="base variables");

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:549  
             10858    1   /***************************************************************************
             10859    1    *                                                                         *
             10860    1    *                               base variables                            *
             10861    1    *                                                                         *
             10862    1    ***************************************************************************/

     3003    10867        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_FIXED_HI,STCLASS="BASED(HANDLER$)");
     3004    10930        %KL_HDR(FPTN=KS$HDR,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     3005    11010        %PARSE$OUT (NAME=OUT$BLK,STCLASS = "BASED(TOP$)");
     3006    11055        %PARSE$SYM (NAME=OUT$SYM,STCLASS = BASED);
     3007    11093    1   DCL   HEX   UBIN(4)  BASED UNAL;
     3008    11094        %KS$BOX(TITLE="auto variables");

             11112    1   /***************************************************************************
             11113    1    *                                                                         *
             11114    1    *                               auto variables                            *
             11115    1    *                                                                         *
             11116    1    ***************************************************************************/

     3009    11121    1   DCL HDLCX25_IN BIT(1);
     3010    11122    1   DCL OUT$ PTR;
     3011    11123    1   DCL NODENAME CHAR(8);
     3012    11124    1   DCL DFLT$ PTR;
     3013    11125    1   DCL NRLINKS   SBIN;
     3014    11126    1   DCL DFLT_OPT$ PTR;
     3015    11127    1   DCL LINK_LIST(0:10) CHAR(4);
     3016    11128    1   DCL K UBIN;
     3017    11129    1   DCL I UBIN;
     3018    11130    1   DCL L SBIN;
     3019    11131    1   DCL HAND# UBIN;
     3020    11132    1   DCL J UBIN;
     3021    11133    1   DCL TEMP UBIN;
     3022    11134    1   DCL FEX UBIN;
     3023    11135    1   DCL NODETYPE  UBIN;
     3024    11136    1   DCL NEW_CLASS UBIN;
     3025    11137    1   DCL OLD_CLASS UBIN;
     3026    11138    1   DCL CONTROL_NODE CHAR(8);
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:550  
     3027    11139         /**/
     3028    11140        %EJECT;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:551  
     3029    11141    1   IF OUT$BLK.NSUBLKS = 0 THEN
     3030    11142    2        DO;
     3031    11143    2           UPDATE.CODE = %IGA_UPDATE;
     3032    11144    2           CALL KSR$WR_HLPCG(VECTOR(UPDATE));
     3033    11145    2        END;
     3034    11146    1   ELSE
     3035    11147    2        DO;
     3036    11148    2           CALL KSU$GET_NODE(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),FEX,NODENAME)
     3037    11149    3              WHENALTRETURN DO;
     3038    11150    3                 ALTRETURN;
     3039    11151    3              END;
     3040    11152    2           READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);
     3041    11153    2           READ_NETCON.BUF_ = VECTOR(KS_RFEP);
     3042    11154    3           CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     3043    11155    3              KS_RFEP = KS_NETWORK;
     3044    11156    3              END;  /* WHENALTRETURN */
     3045    11157    2           KS_LINK_KEY.NODE = FEX;
     3046    11158    2           READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     3047    11159    2           READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     3048    11160    2           CALL M$READ(READ_NETCON)
     3049    11161    3              WHENALTRETURN DO;
     3050    11162    3                 KS_LINK.LINKS# = 0;
     3051    11163    3              END;
     3052    11164    2           NODETYPE = KS_RFEP.NODE.TYPE(FEX);
     3053    11165    2           CONTROL_NODE = KS_NETWORK.NODE.CONTROL_NODE(FEX);
     3054    11166    2           NRLINKS = 0;
     3055    11167
     3056    11168    3           DO I= 1 TO OUT$BLK.NSUBLKS - 1;
     3057    11169    4              DO CASE (OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);
     3058    11170    4                 CASE (%KS_NAME);
     3059    11171    4                    NODENAME = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     3060    11172    4                 CASE (%KS_TYPE);
     3061    11173    4                    NODETYPE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;
     3062    11174    4                 CASE (%KS_CONT);
     3063    11175    4                    CONTROL_NODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
     3064    11176    4                 CASE (%KS_LINK);
     3065    11177    4                    NRLINKS = OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:552  
     3066    11178    5                    DO J = 0 TO NRLINKS - 1;
     3067    11179    5                       LINK_LIST(J) = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$SYM.
             11179                                TEXT;
     3068    11180    5                    END;
     3069    11181    4              END;
     3070    11182    3           END;
     3071    11183
     3072    11184    2           IF NODETYPE = %KS_HOST OR NODETYPE = %KS_ME THEN
     3073    11185    2              NEW_CLASS = %KS_HOST;
     3074    11186    2           ELSE
     3075    11187    2              NEW_CLASS = %KS_FEP;
     3076    11188    2           IF KS_NETWORK.NODE.TYPE(FEX) = %KS_HOST OR
     3077    11189    2              KS_NETWORK.NODE.TYPE(FEX) = %KS_ME THEN
     3078    11190    2              OLD_CLASS = %KS_HOST;
     3079    11191    2           ELSE
     3080    11192    2              OLD_CLASS = %KS_FEP;
     3081    11193    2           IF OLD_CLASS ~= NEW_CLASS THEN
     3082    11194    3              DO;
     3083    11195    3                 CALL KSE$ERRMSG (%E$KS_CANT_INTCHG_FEP_AND_HOST);
     3084    11196                      /*E* ERROR: KSN-E$KS_CANT_INTCHG_FEP_AND_HOST-0
     3085    11197         MESSAGE: It is illegal to update a fep type node to a host type node or a host type
             11197         node to a fep type node.*/
     3086    11198    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));
     3087    11199    3                 KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     3088    11200    3                 CALL KSE$ERRMSG (%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));
     3089    11201                      /*E* ERROR: KSN-E$KS_NO_UPDATE-0
     3090    11202                           MESSAGE: Node %U1 has not been updated. */
     3091    11203    3                 RETURN;
     3092    11204    3              END;
     3093    11205
     3094    11206    2           IF NEW_CLASS = %KS_HOST THEN
     3095    11207    3              DO;
     3096    11208    3                 IF CONTROL_NODE ~= ' ' THEN
     3097    11209    4                    DO;
     3098    11210    4                       CALL KSE$ERRMSG (%E$KS_CNTRL_NOSENSE_ON_HOST);
     3099    11211                            /*E* ERROR: KSN-E$KS_CNTRL_NOSENSE_ON_HOST
     3100    11212                     MESSAGE: It makes no sense to specify a control node on a host node. */
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:553  
     3101    11213    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));
     3102    11214    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     3103    11215    4                       CALL KSE$ERRMSG (%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));
     3104    11216    4                       RETURN;
     3105    11217    4                    END;
     3106    11218    3                 IF KS_LINK.LINKS# + NRLINKS ~= 0 THEN
     3107    11219    4                    DO;
     3108    11220    4                       CALL KSE$ERRMSG (%E$KS_LINKS_NOSENSE_ON_HOST);
     3109    11221                            /*E* ERROR: KSN-E$KS_LINKS_NOSENSE_ON_HOST-0
     3110    11222                             MESSAGE: It makes no sense to specify a link on a host node. */
     3111    11223    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));
     3112    11224    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     3113    11225    4                       CALL KSE$ERRMSG (%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));
     3114    11226    4                       RETURN;
     3115    11227    4                    END;
     3116    11228    3              END;
     3117    11229
     3118    11230    2           IF NODENAME ~= KS_NETWORK.NODE.NODE(FEX) THEN
     3119    11231    3              DO I = 0 TO KS_NETWORK.NODE#;
     3120    11232    3                 IF KS_NETWORK.NODE.NODE(I) = NODENAME THEN
     3121    11233    4                    DO;
     3122    11234    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));
     3123    11235    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     3124    11236    4                       CALL KSE$ERRMSG(%E$KS_DUP_NODE,VECTOR(KS_SUB_BUF_1));
     3125    11237    4                       RETURN;
     3126    11238    4                    END;
     3127    11239    3              END;
     3128    11240
     3129    11241    2           IF NODETYPE = %KS_RFEP AND (KS_LINK.LINKS# + NRLINKS = 0) THEN
     3130    11242    3              DO;
     3131    11243    3                 KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     3132    11244    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));
     3133    11245    3                 CALL KSE$ERRMSG(%E$KS_RFEP_WITH_NO_LINKS);
     3134    11246    3                 CALL KSE$ERRMSG(%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));
     3135    11247    3                 RETURN;
     3136    11248    3              END;
     3137    11249    3           DO I = 0 TO KS_NETWORK.NODE#;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:554  
     3138    11250    3              IF I~= FEX THEN
     3139    11251    4                 DO;
     3140    11252    4                    IF NEW_CLASS = %KS_HOST AND KS_NETWORK.NODE.NODE(FEX) ~= NODENAME
             11252                             AND
     3141    11253    4                       KS_NETWORK.NODE.CONTROL_NODE(I) = KS_NETWORK.NODE.NODE(FEX) THEN
     3142    11254    5                       DO;
     3143    11255    5                          KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     3144    11256    5                          KS_SUB_BUF_2.TEXT = KS_NETWORK.NODE.CONTROL_NODE(I);
     3145    11257    5                          KS_SUB_BUF_3.TEXT = KS_NETWORK.NODE.NODE(FEX);
     3146    11258    5                          KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));
     3147    11259    5                          KS_SUB_BUF_2.COUNT = SIZEC(KS_NETWORK.NODE.CONTROL_NODE(I));
     3148    11260    5                          KS_SUB_BUF_3.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));
     3149    11261    5                          CALL KSE$ERRMSG (%E$KS_CONTROLS_NAME_CHANGED,VECTOR(
             11261                                   KS_SUB_BUF_1),VECTOR(KS_SUB_BUF_2),VECTOR(KS_SUB_BUF_3));
     3150    11262        /*E* ERROR: KSN-E$KS_CONTROLS_NAME_CHANGED-0
     3151    11263         MESSAGE: WARNING - Node %U1 knows this node by the name %U2.  Its control node may
             11263        need to be changed to %U3. */
     3152    11264    5                       END;
     3153    11265    4                    IF NEW_CLASS = %KS_FEP AND KS_NETWORK.NODE.CONTROL_NODE(I) =
             11265                             NODENAME THEN
     3154    11266    5                       DO;
     3155    11267    5                          KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);
     3156    11268    5                          CALL KSE$ERRMSG (%E$KS_NODE_NOT_CNTRL,VECTOR(KS_SUB_BUF_1));
     3157    11269    5                       END;
     3158    11270    4                    IF CONTROL_NODE = KS_NETWORK.NODE.NODE(I) AND
     3159    11271    4                       CONTROL_NODE ~= ' ' AND
     3160    11272    4                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_HOST AND
     3161    11273    4                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_ME)) THEN
     3162    11274    5                       DO;
     3163    11275    5                          CALL KSE$ERRMSG (%E$KS_CNTRL_NOT_HOST);
     3164    11276    5                       END;
     3165    11277    4                 END;
     3166    11278    3           END;
     3167    11279    2           IF KS_NODE = FEX THEN
     3168    11280    3              DO;
     3169    11281    3                 KS_NODENAME = NODENAME;
     3170    11282    3                 PROMPT.NODENAME = NODENAME;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:555  
     3171    11283    3              END;
     3172    11284    2           KS_NETWORK.NODE.TYPE(FEX) = NODETYPE;
     3173    11285    2           KS_RFEP.NODE.TYPE(FEX) = NODETYPE;
     3174    11286    2           IF NODETYPE = %KS_RFEP THEN
     3175    11287    2              KS_NETWORK.NODE.TYPE(FEX) = %KS_FEP;
     3176    11288    2           KS_NETWORK.NODE.NODE(FEX) = NODENAME;
     3177    11289    2           KS_NETWORK.NODE.CONTROL_NODE(FEX) = CONTROL_NODE;
     3178    11290    2           WRITE_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);
     3179    11291    2           WRITE_NETCON.BUF_ = VECTOR(KS_NETWORK);
     3180    11292    2           WRITE_NETCON.BUF_.BOUND = SIZEV(KS_NETWORK) - SIZEC(KS_NETWORK.NODE) +
     3181    11293    2                 KS_NETWORK.NODE#*SIZEC(KS_NETWORK.NODE(0));
     3182    11294    2           CALL M$WRITE(WRITE_NETCON)
     3183    11295    3              WHENALTRETURN DO;
     3184    11296    3                 CALL KSE$ERRMSG(0);
     3185    11297    3              END;
     3186    11298    2           WRITE_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);
     3187    11299    2           WRITE_NETCON.BUF_ = VECTOR(KS_RFEP);
     3188    11300    2           WRITE_NETCON.BUF_.BOUND = SIZEV(KS_RFEP) - SIZEC(KS_RFEP.NODE)
     3189    11301    2                                + KS_RFEP.NODE# * SIZEC(KS_RFEP.NODE(0));
     3190    11302    2           CALL M$WRITE(WRITE_NETCON)
     3191    11303    3              WHENALTRETURN DO;
     3192    11304    3                 CALL KSE$ERRMSG(0);
     3193    11305    3              END;
     3194    11306
     3195    11307    3           DO I = 0 TO NRLINKS - 1;
     3196    11308    3              K = 3;
     3197    11309    3              TEMP_LINK = '0'B;
     3198    11310    4              DO L = 3 DOWNTO 0;
     3199    11311    4                 IF SUBSTR(LINK_LIST(I),L,1) ~= ' ' THEN
     3200    11312    5                    DO;
     3201    11313    5                       CALL INDEX (TEMP,SUBSTR(LINK_LIST(I),L,1),HEX_CHARS);
     3202    11314    5                       HEX$(K)->HEX = TEMP;
     3203    11315    5                       K = K - 1;
     3204    11316    5                    END;
     3205    11317    4              END;
     3206    11318    4   LINK_LOOP: DO J = 0 TO KS_LINK.LINKS# - 1;
     3207    11319    4                 IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:556  
     3208    11320    4                    EXIT LINK_LOOP;
     3209    11321    4              END;
     3210    11322
     3211    11323    3              IF J = KS_LINK.LINKS# THEN
     3212    11324    4                 DO;
     3213    11325    4                    KS_LINK.CHANNEL(KS_LINK.LINKS#) = TEMP_LINK;
     3214    11326    4                    KS_LINK.LINKS# = KS_LINK.LINKS# + 1;
     3215    11327    4                 END;
     3216    11328    3           END;
     3217    11329
     3218    11330    2           KS_LINK_KEY.NODE = FEX;
     3219    11331    2           WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);
     3220    11332    2           WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);
     3221    11333    2           WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +
     3222    11334    2                                    (SIZEC(KS_LINK.CHANNEL(0)) *
     3223    11335    2                                     KS_LINK.LINKS#) - 1;
     3224    11336    2           CALL M$WRITE(WRITE_NETCON);
     3225    11337
     3226    11338    2           KS_FEPHNDLR_KEY.NODE = FEX;
     3227    11339    2           READ_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);
     3228    11340    2           READ_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);
     3229    11341    2           CALL M$READ(READ_NETCON)
     3230    11342    3              WHENALTRETURN DO;
     3231    11343    3                 CALL KSE$ERRMSG(0);
     3232    11344    3              END;
     3233    11345    2           IF KS_RFEP.NODE.TYPE(FEX) = %KS_RFEP THEN
     3234    11346    3              DO;
     3235    11347    3                 J = 0;
     3236    11348    4                 DO I = 0 TO KS_FEPHNDLR.NHANDLERS - 1;
     3237    11349    4                    IF KS_FEPHNDLR.HANDLER(I) = 'COUPLER' THEN
     3238    11350    5                       DO;
     3239    11351    5                          KS_HANDLER_KEY.HNDLR = 'COUPLER';
     3240    11352    5                          KS_HANDLER_KEY.NODE = FEX;
     3241    11353    5                          DELREC_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
     3242    11354    5                          CALL M$DELREC(DELREC_NETCON);
     3243    11355    5                          KS_DEFAULT_KEY.NODE = FEX;
     3244    11356    5                          KS_DEFAULT_KEY.HNDLR = 'COUPLER';
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:557  
     3245    11357    5                          DELREC_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);
     3246    11358    5                          CALL M$DELREC(DELREC_NETCON);
     3247    11359    5                       END;
     3248    11360    4                    ELSE
     3249    11361    5                       DO;
     3250    11362    5                          IF KS_FEPHNDLR.HANDLER(I) ~= 'NODEADMN' AND
     3251    11363    5                             KS_FEPHNDLR.HANDLER(I) ~= 'HDLCX25'  THEN
     3252    11364    5                             KS_FEPHNDLR.BOOTIME(J) = '0'B;
     3253    11365    5                          IF KS_FEPHNDLR.HANDLER(I) = 'HDLCX25'  THEN
     3254    11366    5                             HDLCX25_IN = '1'B;
     3255    11367    5                          KS_FEPHNDLR.HANDLER(J) = KS_FEPHNDLR.HANDLER(I);
     3256    11368    5                          J = J + 1;
     3257    11369    5                       END;
     3258    11370    4                 END;
     3259    11371    3                 KS_FEPHNDLR.NHANDLERS = J;
     3260    11372    3                 IF ~HDLCX25_IN THEN
     3261    11373    4                    DO;
     3262    11374    4                       KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS + 1;
     3263    11375    4                       KS_FEPHNDLR.HANDLER(J) = 'HDLCX25';
     3264    11376    4                       KS_FEPHNDLR.BOOTIME(J) = '1'B;
     3265    11377    4                       KS_DEFAULT_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J);
     3266    11378    4                       CALL KSU$INIT_DEFCNFG(KS_DEFAULT);
     3267    11379    4                       CALL KSU$WRITE_NETCON(VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT))
             11379                                ;
     3268    11380    4                       KS_HANDLER = '0'B;
     3269    11381    4                       KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J);
     3270    11382    4                       KS_HANDLER.HNDLRFID = KS_FEPHNDLR.HANDLER(J);
     3271    11383    4                       CALL INDEX(TEMP,' ',KS_HANDLER.HNDLRFID);
     3272    11384    4                       CALL INSERT(KS_HANDLER.HNDLRFID,TEMP,,'.:SYS');
     3273    11385    4                       KS_HANDLER.HNDLRNAME = KS_FEPHNDLR.HANDLER(J);
     3274    11386    5                        DO HAND# = 0 TO 7;
     3275    11387    5                             IF KS_HAND_INFO.TEXT(HAND#) = KS_HANDLER_KEY.HNDLR
     3276    11388    5                             THEN
     3277    11389    5                                  EXIT;
     3278    11390    5                             END;
     3279    11391    4                       KS_HANDLER.TYPE = KS_HAND_INFO.TYPE(HAND#);
     3280    11392
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:558  
     3281    11393    4                       DFLT$ = KS_HAND_INFO.PARAMS$(HAND#);
     3282    11394
     3283    11395    4                       IF KS_HAND_INFO.SZ(HAND#) <= %KL_FIXED_HI
     3284    11396    4                       THEN KS_HANDLER.NPARAMS = KS_HAND_INFO.SZ(HAND#);
     3285    11397    4                       ELSE KS_HANDLER.NPARAMS = %KL_FIXED_HI;
     3286    11398
     3287    11399    5                       DO K=0 TO KS_HANDLER.NPARAMS-1;
     3288    11400    5                          KS_HANDLER.PARAMS(K) = DFLT$->KS$PARAM.DEFAULT(K);
     3289    11401    5                          END;
     3290    11402
     3291    11403    4                       IF KS_HAND_INFO.SZ(HAND#) > %KL_FIXED_HI
     3292    11404    5                       THEN DO;
     3293    11405    5                             KS_HANDLER.NPARAMI = KS_HAND_INFO.SZ(HAND#) - %KL_FIXED_HI
             11405                                      ;
     3294    11406    5                            OUT$ = PINCRW(ADDR(KS_HANDLER),SIZEW(KS_HANDLER));
     3295    11407
     3296    11408    6                            DO K = %KL_ASYNC_BLOCK TO KS_HAND_INFO.SZ(HAND#)-1;
     3297    11409    6                               DFLT_OPT$ = DFLT$->KS$PARAM.SPCL_TBL$(K);
     3298    11410    6                               KS_HANDLER.IPARAM.OFFSET(K - %KL_ASYNC_BLOCK) = POFFW(
             11410                                        OUT$,ADDR(KS_HANDLER));
     3299    11411    6                               KS_HANDLER.IPARAM.ARRAY_SZ(K - %KL_ASYNC_BLOCK) =
             11411                                        KS_HAND_INFO.PARAMS$(HAND#)->KS$PARAM.ARRAY_SZ(K);
     3300    11412
     3301    11413    7                               DO I = 0 TO KS_HANDLER.IPARAM.ARRAY_SZ(K - %
             11413                                        KL_ASYNC_BLOCK);
     3302    11414    7                               OUT$->B$PARAMI(I) = DFLT_OPT$->KS$PARAM.DEFAULT(I);
     3303    11415    7                                 END;
     3304    11416
     3305    11417    6                               OUT$ = PINCRW(OUT$,(KS_HANDLER.IPARAM.ARRAY_SZ(K - %
             11417                                        KL_ASYNC_BLOCK)+2)/2);
     3306    11418    6                               END;  /* DO K - # of indexed params */
     3307    11419    5                           END;  /* DO IF ANY INDEXED PARAMS */
     3308    11420
     3309    11421    4                       WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);
     3310    11422    4                       WRITE_NETCON.BUF_ = VECTOR(KS_HANDLER);
     3311    11423    4                       IF KS_HANDLER.NPARAMI = 0
     3312    11424    5                       THEN DO;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:559  
     3313    11425    5                          OUT$ = ADDR(KS_HANDLER);
     3314    11426    5                          OUT$ = PINCRW(OUT$,SIZEW(KS_HANDLER) + 1);
     3315    11427    5                       END;
     3316    11428
     3317    11429    4                       WRITE_NETCON.BUF_.BOUND = POFFC(OUT$,ADDR(KS_HANDLER))-1;
     3318    11430    4                       CALL M$WRITE(WRITE_NETCON)
     3319    11431    5                          WHENALTRETURN DO;
     3320    11432    5                             CALL KSE$ERRMSG(0);
     3321    11433    5                             ALTRETURN;
     3322    11434    5                          END;
     3323    11435    4                    END;
     3324    11436    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);
     3325    11437    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);
     3326    11438
     3327    11439
     3328    11440
     3329    11441
     3330    11442    3                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_FEPHNDLR.NHANDLERS) + SIZEC(
             11442                          KS_FEPHNDLR.DEFLIBACCT) + 4  /* bootime */
     3331    11443    3                                           + SIZEC(KS_FEPHNDLR.HANDLER(0)) *
             11443                                                    KS_FEPHNDLR.NHANDLERS - 1;
     3332    11444    3              CALL M$WRITE(WRITE_NETCON)
     3333    11445    4                 WHENALTRETURN DO;
     3334    11446    4                    CALL KSE$ERRMSG(0);
     3335    11447    4                    ALTRETURN;
     3336    11448    4                 END;
     3337    11449    3           END;
     3338    11450    2        END;
     3339    11451    1   END KSC$UPDATE;

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:560  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$UPDATE.

   Procedure KSC$UPDATE requires 866 words for executable code.
   Procedure KSC$UPDATE requires 38 words of local(AUTO) storage.

    No errors detected in file KSC$COMMANDS2.:E05TSI    .

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:561  

 Object Unit name= KSC$UPDATE                                 File name= KSC$COMMANDS2.:E05TOU
 UTS= JUL 30 '97 01:48:46.16 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     12     14  KSC$UPDATE
    2   Data  even  none  1533   2775  KSC$UPDATE
    3   DCB   even  none     0      0  M$NETCON
    4   Proc  even  none   866   1542  KSC$UPDATE
    5  RoData even  none    58     72  KSC$UPDATE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  KSC$UPDATE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KSR$WR_HLPCG
 yes     yes           Std       3 KSU$GET_NODE
         yes           Std       1 KSU$INIT_DEFCNFG
 yes     yes           Std       3 KSU$WRITE_NETCON
         yes           Std       4 KSE$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:562  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  KS_MYSTATION                          KS_NODENAME
     KS_NODE                               KS_MSGBUF                             KS_MSGBUF$
     KS_SUB_BUF_1                          KS_SUB_BUF_2                          KS_SUB_BUF_3
     PROMPT                                KS_NETWORK                            KS_HAND_INFO
     M$NETCON                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:563  


     2921        1        /*T***********************************************************/
     2922        2        /*T*                                                         */
     2923        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     2924        4        /*T*                                                         */
     2925        5        /*T***********************************************************/
     2926        6
     2927        7         KSC$UPDATE: PROC (TOP$) ALTRET;

      7  4 000000   000000 700200 xent  KSC$UPDATE   TSX0  ! X66_AUTO_1
         4 000001   000046 000001                    ZERO    38,1

     2928        8             /**/
     2929        9    1       DCL TOP$ PTR;
     2930       10             /**/
     2931       11        %INCLUDE KHA_FNC_E;
     2932      111        %INCLUDE CP_6;
     2933      192        %INCLUDE CP_6_SUBS;
     2934      732        %INCLUDE XU_MACRO_C;
     2935     3838        %INCLUDE KS_MACRO_M;
     2936     4035        %INCLUDE B_ERRORS_C;
     2937     5162        %INCLUDE KL_CONFIG_M;
     2938     5924        %INCLUDE KL_MACRO_C;
     2939     9276        %INCLUDE KS_SUBS_C;
     2940     9519        %INCLUDE KS_DATA_R;
     2941     9534        %INCLUDE KS_PERR_C;
     2942     9601        %INCLUDE KL_CONTROL_C;
     2943     9981        %INCLUDE KL_AFCN_C;
     2944    10082        /**/
     2945    10083        /*entry definitons*/
     2946    10084    1   DCL KSE$ERRMSG ENTRY(4);
     2947    10085    1   DCL KSR$RD_HLPCG ENTRY(1) ALTRET;
     2948    10086    1   DCL KSR$WR_HLPCG ENTRY(1) ALTRET;
     2949    10087    1   DCL KSU$BLD_TERMID ENTRY(3) ALTRET;
     2950    10088    1   DCL KSU$CHK_TRM_RNG ENTRY(2) ALTRET;
     2951    10089    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
     2952    10090    1   DCL XUR$ERRCNVRT ENTRY(2);
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:564  
     2953    10091    1   DCL KSW$WRITE ENTRY(11);
     2954    10092    1   DCL KSU$INIT_DEFCNFG ENTRY(1);
     2955    10093    1   DCL KSU$GET_NODE ENTRY(3) ALTRET;
     2956    10094    1   DCL KSU$WRITE_NETCON ENTRY(3) ALTRET;
     2957    10095        %KS$BOX(TITLE="symr variables");

             10113    1   /***************************************************************************
             10114    1    *                                                                         *
             10115    1    *                               symr variables                            *
             10116    1    *                                                                         *
             10117    1    ***************************************************************************/

     2958    10122    1   DCL 1 PROMPT SYMREF,
     2959    10123    1        2 NODENAME CHAR(8),
     2960    10124    1        2 STAR CHAR(2);
     2961    10125        %KL$NETWORK (NAME=KS_NETWORK,NUM=255,STCLASS=SYMREF);
     2962    10152        %KS$HAND_INFO (NAME=KS_HAND_INFO,LVL=1,STCLASS="(0:0) SYMREF", LAST=";");
     2963    10191        %KS$BOX(TITLE="symd variables");

             10209    1   /***************************************************************************
             10210    1    *                                                                         *
             10211    1    *                               symd variables                            *
             10212    1    *                                                                         *
             10213    1    ***************************************************************************/

     2964    10218        %KS$BOX(TITLE="cons variables");

             10236    1   /***************************************************************************
             10237    1    *                                                                         *
             10238    1    *                               cons variables                            *
             10239    1    *                                                                         *
             10240    1    ***************************************************************************/

     2965    10245    1   DCL HEX_CHARS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
     2966    10246        %KS$BOX(TITLE="stat variables");

             10264    1   /***************************************************************************
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:565  
             10265    1    *                                                                         *
             10266    1    *                               stat variables                            *
             10267    1    *                                                                         *
             10268    1    ***************************************************************************/

     2967    10273        %KL$HNDLR_KEY (NAME=KS_HANDLER_KEY,STCLASS=STATIC);
     2968    10292        %KL$DEFAULT_KEY (NAME=KS_DEFAULT_KEY,STCLASS=STATIC);
     2969    10311    1        DCL   DEFAULT$ PTR STATIC INIT(ADDR(DEFAULT_BUF));
     2970    10312    1        DCL   DEFAULT_BUF (0:49) UBIN WORD STATIC INIT(0*0);
     2971    10313    1   DCL CHAR_BUF(0:400) CHAR(1) STATIC;
     2972    10314    1   DCL HANDLER$ PTR STATIC INIT(ADDR(CHAR_BUF));
     2973    10315        %KL_HDR(FPTN=UPDATE,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     2974    10395    1   DCL HDR$ PTR STATIC INIT(ADDR(KS_MSGBUF));
     2975    10396        %KL$FEPHNDLR (NAME=KS_FEPHNDLR,NUM=20,STCLASS=STATIC);
     2976    10426    1   DCL 1 KS_RFEP_KEY STATIC ALIGNED,
     2977    10427    1         2 CNT UBIN BYTE UNAL INIT(1),
     2978    10428    1         2 TYP UBIN BYTE UNAL INIT(%KS_KEYTYP_RFEP);
     2979    10429    1         DCL   HEX$(0:3)   PTR  STATIC INIT(
     2980    10430    1                                          ADDR(TEMP_LINK.HEX0),
     2981    10431    1                                          ADDR(TEMP_LINK.HEX1),
     2982    10432    1                                          ADDR(TEMP_LINK.HEX2),
     2983    10433    1                                          ADDR(TEMP_LINK.HEX3));
     2984    10434    1   DCL   1  TEMP_LINK   STATIC,
     2985    10435    1            2  *        BIT(1) UNAL,
     2986    10436    1            2  HEX0     UBIN(4) UNAL,
     2987    10437    1            2  HEX1     UBIN(4) UNAL,
     2988    10438    1            2  *        BIT(1)  UNAL,
     2989    10439    1            2  HEX2     UBIN(4) UNAL,
     2990    10440    1            2  HEX3     UBIN(4) UNAL;
     2991    10441        %KL$FEPHNDLR_KEY (NAME=KS_FEPHNDLR_KEY,STCLASS=STATIC);
     2992    10459        %KL$NETWORK (NAME=KS_RFEP,NUM=255,STCLASS=STATIC);
     2993    10486        %KL$LINK_KEY(NAME=KS_LINK_KEY,STCLASS=STATIC);
     2994    10504        %FPT_READ (FPTN=READ_NETCON,DCB=M$NETCON,KEYS=YES);
     2995    10543        %FPT_DELREC (FPTN=DELREC_NETCON,DCB=M$NETCON);
     2996    10562        %FPT_WRITE (FPTN=WRITE_NETCON,DCB=M$NETCON);
     2997    10593        %KS$PARAM (NAME=KS$PARAM,LVL=1,SPECIAL=YES,STCLASS="(0:0) BASED",LAST=";");
     2998    10663        %KL$LINCNFG(NAME=KS_DEFAULT,STCLASS="BASED(DEFAULT$)");
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:566  
     2999    10821    1   DCL B$PARAMI(0:0) UBIN HALF BASED HALIGNED;
     3000    10822        %KL$NETWORK_KEY (NAME=KS_NETWORK_KEY,STCLASS=STATIC);
     3001    10839    1   DCL M$NETCON DCB;
     3002    10840        %KS$BOX(TITLE="base variables");

             10858    1   /***************************************************************************
             10859    1    *                                                                         *
             10860    1    *                               base variables                            *
             10861    1    *                                                                         *
             10862    1    ***************************************************************************/

     3003    10867        %KL$HNDLR (NAME=KS_HANDLER,NUM=KL_FIXED_HI,STCLASS="BASED(HANDLER$)");
     3004    10930        %KL_HDR(FPTN=KS$HDR,CODE=%IGA_UPDATE,STCLASS="BASED(HDR$)");
     3005    11010        %PARSE$OUT (NAME=OUT$BLK,STCLASS = "BASED(TOP$)");
     3006    11055        %PARSE$SYM (NAME=OUT$SYM,STCLASS = BASED);
     3007    11093    1   DCL   HEX   UBIN(4)  BASED UNAL;
     3008    11094        %KS$BOX(TITLE="auto variables");

             11112    1   /***************************************************************************
             11113    1    *                                                                         *
             11114    1    *                               auto variables                            *
             11115    1    *                                                                         *
             11116    1    ***************************************************************************/

     3009    11121    1   DCL HDLCX25_IN BIT(1);
     3010    11122    1   DCL OUT$ PTR;
     3011    11123    1   DCL NODENAME CHAR(8);
     3012    11124    1   DCL DFLT$ PTR;
     3013    11125    1   DCL NRLINKS   SBIN;
     3014    11126    1   DCL DFLT_OPT$ PTR;
     3015    11127    1   DCL LINK_LIST(0:10) CHAR(4);
     3016    11128    1   DCL K UBIN;
     3017    11129    1   DCL I UBIN;
     3018    11130    1   DCL L SBIN;
     3019    11131    1   DCL HAND# UBIN;
     3020    11132    1   DCL J UBIN;
     3021    11133    1   DCL TEMP UBIN;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:567  
     3022    11134    1   DCL FEX UBIN;
     3023    11135    1   DCL NODETYPE  UBIN;
     3024    11136    1   DCL NEW_CLASS UBIN;
     3025    11137    1   DCL OLD_CLASS UBIN;
     3026    11138    1   DCL CONTROL_NODE CHAR(8);
     3027    11139         /**/
     3028    11140        %EJECT;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:568  
     3029    11141    1   IF OUT$BLK.NSUBLKS = 0 THEN

  11141  4 000002   200003 470500                    LDP0    @TOP$,,AUTO
         4 000003   000000 471500                    LDP1    0,,PR0
         4 000004   100001 220100                    LDX0    1,,PR1
         4 000005   000023 601000 4                  TNZ     s:11148

     3030    11142    2        DO;

     3031    11143    2           UPDATE.CODE = %IGA_UPDATE;

  11143  4 000006   000237 473400 2                  LDP3    HDR$
         4 000007   026000 236003                    LDQ     11264,DU
         4 000010   300000 552140                    STBQ    0,'40'O,PR3

     3032    11144    2           CALL KSR$WR_HLPCG(VECTOR(UPDATE));

  11144  4 000011   000000 235000 5                  LDA     0
         4 000012   000237 236000 2                  LDQ     HDR$
         4 000013   200042 757100                    STAQ    CONTROL_NODE+2,,AUTO
         4 000014   200042 631500                    EPPR1   CONTROL_NODE+2,,AUTO
         4 000015   200044 451500                    STP1    CONTROL_NODE+4,,AUTO
         4 000016   200044 630500                    EPPR0   CONTROL_NODE+4,,AUTO
         4 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000020   000000 701000 xent               TSX1    KSR$WR_HLPCG
         4 000021   000000 011000                    NOP     0

     3033    11145    2        END;

  11145  4 000022   001541 710000 4                  TRA     s:11451

     3034    11146    1   ELSE
     3035    11147    2        DO;

     3036    11148    2           CALL KSU$GET_NODE(OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0),FEX,NODENAME)

  11148  4 000023   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:569  
         4 000024   200006 634500                    EPPR4   NODENAME,,AUTO
         4 000025   200044 454500                    STP4    CONTROL_NODE+4,,AUTO
         4 000026   200034 631500                    EPPR1   FEX,,AUTO
         4 000027   200043 451500                    STP1    CONTROL_NODE+3,,AUTO
         4 000030   300003 635500                    EPPR5   3,,PR3
         4 000031   200042 455500                    STP5    CONTROL_NODE+2,,AUTO
         4 000032   200042 630500                    EPPR0   CONTROL_NODE+2,,AUTO
         4 000033   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000034   000000 701000 xent               TSX1    KSU$GET_NODE
         4 000035   000037 702000 4                  TSX2    s:11150
         4 000036   000040 710000 4                  TRA     s:11152

     3037    11149    3              WHENALTRETURN DO;

     3038    11150    3                 ALTRETURN;

  11150  4 000037   000000 702200 xent               TSX2  ! X66_AALT

     3039    11151    3              END;
     3040    11152    2           READ_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);

  11152  4 000040   000002 237000 5                  LDAQ    2
         4 000041   002732 757000 2                  STAQ    READ_NETCON+2

     3041    11153    2           READ_NETCON.BUF_ = VECTOR(KS_RFEP);

  11153  4 000042   000004 237000 5                  LDAQ    4
         4 000043   002734 757000 2                  STAQ    READ_NETCON+4

     3042    11154    3           CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  11154  4 000044   002730 630400 2                  EPPR0   READ_NETCON
         4 000045   440000 713400                    CLIMB   alt,read
         4 000046   401400 401760                    pmme    nvectors=4
         4 000047   000051 702000 4                  TSX2    s:11155
         4 000050   000055 710000 4                  TRA     s:11157

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:570  
     3043    11155    3              KS_RFEP = KS_NETWORK;

  11155  4 000051   012004 220003                    LDX0    5124,DU
         4 000052   000040 100440                    MLR     fill='000'O
         4 000053   000000 000010 xsym               ADSC9   KS_NETWORK               cn=0,n=*X0
         4 000054   000325 000010 2                  ADSC9   KS_RFEP                  cn=0,n=*X0

     3044    11156    3              END;  /* WHENALTRETURN */

     3045    11157    2           KS_LINK_KEY.NODE = FEX;

  11157  4 000055   200034 236100                    LDQ     FEX,,AUTO
         4 000056   000011 736000                    QLS     9
         4 000057   002726 552010 2                  STBQ    KS_LINK_KEY,'10'O

     3046    11158    2           READ_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  11158  4 000060   000006 237000 5                  LDAQ    6
         4 000061   002732 757000 2                  STAQ    READ_NETCON+2

     3047    11159    2           READ_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  11159  4 000062   000010 237000 5                  LDAQ    8
         4 000063   002734 757000 2                  STAQ    READ_NETCON+4

     3048    11160    2           CALL M$READ(READ_NETCON)

  11160  4 000064   002730 630400 2                  EPPR0   READ_NETCON
         4 000065   440000 713400                    CLIMB   alt,read
         4 000066   401400 401760                    pmme    nvectors=4
         4 000067   000071 702000 4                  TSX2    s:11162
         4 000070   000073 710000 4                  TRA     s:11164

     3049    11161    3              WHENALTRETURN DO;

     3050    11162    3                 KS_LINK.LINKS# = 0;

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:571  
  11162  4 000071   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000072   000000 450100                    STZ     0,,PR0

     3051    11163    3              END;

     3052    11164    2           NODETYPE = KS_RFEP.NODE.TYPE(FEX);

  11164  4 000073   200034 236100                    LDQ     FEX,,AUTO
         4 000074   000005 402007                    MPY     5,DL
         4 000075   000326 235006 2                  LDA     KS_RFEP+1,QL
         4 000076   200035 755100                    STA     NODETYPE,,AUTO

     3053    11165    2           CONTROL_NODE = KS_NETWORK.NODE.CONTROL_NODE(FEX);

  11165  4 000077   200034 236100                    LDQ     FEX,,AUTO
         4 000100   000024 402007                    MPY     20,DL
         4 000101   040100 100406                    MLR     fill='040'O
         4 000102   000004 000010 xsym               ADSC9   KS_NETWORK+4,Q           cn=0,n=8
         4 000103   200040 000010                    ADSC9   CONTROL_NODE,,AUTO       cn=0,n=8

     3054    11166    2           NRLINKS = 0;

  11166  4 000104   200011 450100                    STZ     NRLINKS,,AUTO

     3055    11167
     3056    11168    3           DO I= 1 TO OUT$BLK.NSUBLKS - 1;

  11168  4 000105   000001 235007                    LDA     1,DL
         4 000106   200027 755100                    STA     I,,AUTO
         4 000107   000207 710000 4                  TRA     s:11182+3

     3057    11169    4              DO CASE (OUT$BLK.SUBLK$(I)->OUT$BLK.CODE);

  11169  4 000110   200003 470500                    LDP0    @TOP$,,AUTO
         4 000111   000000 471500                    LDP1    0,,PR0
         4 000112   200027 720100                    LXL0    I,,AUTO
         4 000113   100003 473510                    LDP3    3,X0,PR1
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:572  
         4 000114   300000 721100                    LXL1    0,,PR3
         4 000115   000005 101003                    CMPX1   5,DU
         4 000116   000120 602011 4                  TNC     s:11169+8,X1
         4 000117   000204 710000 4                  TRA     s:11182
         4 000120   000204 710000 4                  TRA     s:11182
         4 000121   000125 710000 4                  TRA     s:11171
         4 000122   000135 710000 4                  TRA     s:11173
         4 000123   000142 710000 4                  TRA     s:11175
         4 000124   000152 710000 4                  TRA     s:11177

     3058    11170    4                 CASE (%KS_NAME);

     3059    11171    4                    NODENAME = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  11171  4 000125   300003 474500                    LDP4    3,,PR3
         4 000126   400004 236100                    LDQ     4,,PR4
         4 000127   000033 772000                    QRL     27
         4 000130   000000 622006                    EAX2    0,QL
         4 000131   040100 100540                    MLR     fill='040'O
         4 000132   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000133   200006 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000134   000204 710000 4                  TRA     s:11182

     3060    11172    4                 CASE (%KS_TYPE);

     3061    11173    4                    NODETYPE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$BLK.CODE;

  11173  4 000135   300003 474500                    LDP4    3,,PR3
         4 000136   400000 236100                    LDQ     0,,PR4
         4 000137   777777 376007                    ANQ     -1,DL
         4 000140   200035 756100                    STQ     NODETYPE,,AUTO
         4 000141   000204 710000 4                  TRA     s:11182

     3062    11174    4                 CASE (%KS_CONT);

     3063    11175    4                    CONTROL_NODE = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:573  
  11175  4 000142   300003 474500                    LDP4    3,,PR3
         4 000143   400004 236100                    LDQ     4,,PR4
         4 000144   000033 772000                    QRL     27
         4 000145   000000 622006                    EAX2    0,QL
         4 000146   040100 100540                    MLR     fill='040'O
         4 000147   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000150   200040 000010                    ADSC9   CONTROL_NODE,,AUTO       cn=0,n=8
         4 000151   000204 710000 4                  TRA     s:11182

     3064    11176    4                 CASE (%KS_LINK);

     3065    11177    4                    NRLINKS = OUT$BLK.SUBLK$(I)->OUT$BLK.NSUBLKS;

  11177  4 000152   300001 236100                    LDQ     1,,PR3
         4 000153   000022 772000                    QRL     18
         4 000154   200011 756100                    STQ     NRLINKS,,AUTO

     3066    11178    5                    DO J = 0 TO NRLINKS - 1;

  11178  4 000155   200032 450100                    STZ     J,,AUTO
         4 000156   000200 710000 4                  TRA     s:11180+3

     3067    11179    5                       LINK_LIST(J) = OUT$BLK.SUBLK$(I)->OUT$BLK.SUBLK$(J)->OUT$SYM.
             11179                                TEXT;

  11179  4 000157   200003 470500                    LDP0    @TOP$,,AUTO
         4 000160   000000 471500                    LDP1    0,,PR0
         4 000161   200027 720100                    LXL0    I,,AUTO
         4 000162   100003 473510                    LDP3    3,X0,PR1
         4 000163   200032 721100                    LXL1    J,,AUTO
         4 000164   300003 474511                    LDP4    3,X1,PR3
         4 000165   400004 236100                    LDQ     4,,PR4
         4 000166   000033 772000                    QRL     27
         4 000167   200032 235100                    LDA     J,,AUTO
         4 000170   000002 735000                    ALS     2
         4 000171   000000 622006                    EAX2    0,QL
         4 000172   040105 100540                    MLR     fill='040'O
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:574  
         4 000173   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         4 000174   200013 000004                    ADSC9   LINK_LIST,A,AUTO         cn=0,n=4

     3068    11180    5                    END;

  11180  4 000175   200032 235100                    LDA     J,,AUTO
         4 000176   000001 035007                    ADLA    1,DL
         4 000177   200032 755100                    STA     J,,AUTO
         4 000200   200032 236100                    LDQ     J,,AUTO
         4 000201   000204 604000 4                  TMI     s:11182
         4 000202   200011 116100                    CMPQ    NRLINKS,,AUTO
         4 000203   000157 604000 4                  TMI     s:11179

     3069    11181    4              END;

     3070    11182    3           END;

  11182  4 000204   200027 235100                    LDA     I,,AUTO
         4 000205   000001 035007                    ADLA    1,DL
         4 000206   200027 755100                    STA     I,,AUTO
         4 000207   200003 470500                    LDP0    @TOP$,,AUTO
         4 000210   000000 471500                    LDP1    0,,PR0
         4 000211   100001 236100                    LDQ     1,,PR1
         4 000212   000022 772000                    QRL     18
         4 000213   200027 116100                    CMPQ    I,,AUTO
         4 000214   000216 600000 4                  TZE     s:11184
         4 000215   000110 603000 4                  TRC     s:11169

     3071    11183
     3072    11184    2           IF NODETYPE = %KS_HOST OR NODETYPE = %KS_ME THEN

  11184  4 000216   200035 235100                    LDA     NODETYPE,,AUTO
         4 000217   000001 115007                    CMPA    1,DL
         4 000220   000223 600000 4                  TZE     s:11185
         4 000221   000003 115007                    CMPA    3,DL
         4 000222   000226 601000 4                  TNZ     s:11187

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:575  
     3073    11185    2              NEW_CLASS = %KS_HOST;

  11185  4 000223   000001 235007                    LDA     1,DL
         4 000224   200036 755100                    STA     NEW_CLASS,,AUTO
         4 000225   000230 710000 4                  TRA     s:11188

     3074    11186    2           ELSE
     3075    11187    2              NEW_CLASS = %KS_FEP;

  11187  4 000226   000002 235007                    LDA     2,DL
         4 000227   200036 755100                    STA     NEW_CLASS,,AUTO

     3076    11188    2           IF KS_NETWORK.NODE.TYPE(FEX) = %KS_HOST OR

  11188  4 000230   200034 236100                    LDQ     FEX,,AUTO
         4 000231   000005 402007                    MPY     5,DL
         4 000232   000001 235006 xsym               LDA     KS_NETWORK+1,QL
         4 000233   000001 115007                    CMPA    1,DL
         4 000234   000237 600000 4                  TZE     s:11190
         4 000235   000003 115007                    CMPA    3,DL
         4 000236   000242 601000 4                  TNZ     s:11192

     3077    11189    2              KS_NETWORK.NODE.TYPE(FEX) = %KS_ME THEN
     3078    11190    2              OLD_CLASS = %KS_HOST;

  11190  4 000237   000001 235007                    LDA     1,DL
         4 000240   200037 755100                    STA     OLD_CLASS,,AUTO
         4 000241   000244 710000 4                  TRA     s:11193

     3079    11191    2           ELSE
     3080    11192    2              OLD_CLASS = %KS_FEP;

  11192  4 000242   000002 235007                    LDA     2,DL
         4 000243   200037 755100                    STA     OLD_CLASS,,AUTO

     3081    11193    2           IF OLD_CLASS ~= NEW_CLASS THEN

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:576  
  11193  4 000244   200037 236100                    LDQ     OLD_CLASS,,AUTO
         4 000245   200036 116100                    CMPQ    NEW_CLASS,,AUTO
         4 000246   000267 600000 4                  TZE     s:11206

     3082    11194    3              DO;

     3083    11195    3                 CALL KSE$ERRMSG (%E$KS_CANT_INTCHG_FEP_AND_HOST);

  11195  4 000247   000012 630400 5                  EPPR0   10
         4 000250   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000251   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000252   000000 011000                    NOP     0

     3084    11196                      /*E* ERROR: KSN-E$KS_CANT_INTCHG_FEP_AND_HOST-0
     3085    11197        MESSAGE: It is illegal to update a fep type node to a host type node or a host type
             11197         node to a fep type node.*/
     3086    11198    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));

  11198  4 000253   010000 236003                    LDQ     4096,DU
         4 000254   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     3087    11199    3                 KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11199  4 000255   200027 236100                    LDQ     I,,AUTO
         4 000256   000024 402007                    MPY     20,DL
         4 000257   040000 100406                    MLR     fill='040'O
         4 000260   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000261   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     3088    11200    3                 CALL KSE$ERRMSG (%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));

  11200  4 000262   000017 630400 5                  EPPR0   15
         4 000263   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000264   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000265   000000 011000                    NOP     0

     3089    11201                      /*E* ERROR: KSN-E$KS_NO_UPDATE-0
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:577  
     3090    11202                           MESSAGE: Node %U1 has not been updated. */
     3091    11203    3                 RETURN;

  11203  4 000266   000000 702200 xent               TSX2  ! X66_ARET

     3092    11204    3              END;
     3093    11205
     3094    11206    2           IF NEW_CLASS = %KS_HOST THEN

  11206  4 000267   200036 235100                    LDA     NEW_CLASS,,AUTO
         4 000270   000001 115007                    CMPA    1,DL
         4 000271   000341 601000 4                  TNZ     s:11230

     3095    11207    3              DO;

     3096    11208    3                 IF CONTROL_NODE ~= ' ' THEN

  11208  4 000272   200040 237100                    LDAQ    CONTROL_NODE,,AUTO
         4 000273   000022 117000 5                  CMPAQ   18
         4 000274   000315 600000 4                  TZE     s:11218

     3097    11209    4                    DO;

     3098    11210    4                       CALL KSE$ERRMSG (%E$KS_CNTRL_NOSENSE_ON_HOST);

  11210  4 000275   000025 630400 5                  EPPR0   21
         4 000276   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000277   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000300   000000 011000                    NOP     0

     3099    11211                            /*E* ERROR: KSN-E$KS_CNTRL_NOSENSE_ON_HOST
     3100    11212                    MESSAGE: It makes no sense to specify a control node on a host node. */
     3101    11213    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));

  11213  4 000301   010000 236003                    LDQ     4096,DU
         4 000302   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:578  
     3102    11214    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11214  4 000303   200027 236100                    LDQ     I,,AUTO
         4 000304   000024 402007                    MPY     20,DL
         4 000305   040000 100406                    MLR     fill='040'O
         4 000306   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000307   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     3103    11215    4                       CALL KSE$ERRMSG (%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));

  11215  4 000310   000017 630400 5                  EPPR0   15
         4 000311   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000312   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000313   000000 011000                    NOP     0

     3104    11216    4                       RETURN;

  11216  4 000314   000000 702200 xent               TSX2  ! X66_ARET

     3105    11217    4                    END;
     3106    11218    3                 IF KS_LINK.LINKS# + NRLINKS ~= 0 THEN

  11218  4 000315   000000 473400 xsym               LDP3    KS_MSGBUF$
         4 000316   300000 236100                    LDQ     0,,PR3
         4 000317   200011 036100                    ADLQ    NRLINKS,,AUTO
         4 000320   000341 600000 4                  TZE     s:11230

     3107    11219    4                    DO;

     3108    11220    4                       CALL KSE$ERRMSG (%E$KS_LINKS_NOSENSE_ON_HOST);

  11220  4 000321   000027 630400 5                  EPPR0   23
         4 000322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000323   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000324   000000 011000                    NOP     0

     3109    11221                            /*E* ERROR: KSN-E$KS_LINKS_NOSENSE_ON_HOST-0
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:579  
     3110    11222                            MESSAGE: It makes no sense to specify a link on a host node. */
     3111    11223    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));

  11223  4 000325   010000 236003                    LDQ     4096,DU
         4 000326   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     3112    11224    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11224  4 000327   200027 236100                    LDQ     I,,AUTO
         4 000330   000024 402007                    MPY     20,DL
         4 000331   040000 100406                    MLR     fill='040'O
         4 000332   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000333   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     3113    11225    4                       CALL KSE$ERRMSG (%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));

  11225  4 000334   000017 630400 5                  EPPR0   15
         4 000335   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000336   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000337   000000 011000                    NOP     0

     3114    11226    4                       RETURN;

  11226  4 000340   000000 702200 xent               TSX2  ! X66_ARET

     3115    11227    4                    END;
     3116    11228    3              END;
     3117    11229
     3118    11230    2           IF NODENAME ~= KS_NETWORK.NODE.NODE(FEX) THEN

  11230  4 000341   200034 236100                    LDQ     FEX,,AUTO
         4 000342   000024 402007                    MPY     20,DL
         4 000343   040006 106500                    CMPC    fill='040'O
         4 000344   200006 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000345   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000346   000401 600000 4                  TZE     s:11241

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:580  
     3119    11231    3              DO I = 0 TO KS_NETWORK.NODE#;

  11231  4 000347   200027 450100                    STZ     I,,AUTO
         4 000350   000376 710000 4                  TRA     s:11239+3

     3120    11232    3                 IF KS_NETWORK.NODE.NODE(I) = NODENAME THEN

  11232  4 000351   200027 236100                    LDQ     I,,AUTO
         4 000352   000024 402007                    MPY     20,DL
         4 000353   040100 106406                    CMPC    fill='040'O
         4 000354   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000355   200006 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000356   000373 601000 4                  TNZ     s:11239

     3121    11233    4                    DO;

     3122    11234    4                       KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));

  11234  4 000357   010000 236003                    LDQ     4096,DU
         4 000360   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     3123    11235    4                       KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11235  4 000361   200027 236100                    LDQ     I,,AUTO
         4 000362   000024 402007                    MPY     20,DL
         4 000363   040000 100406                    MLR     fill='040'O
         4 000364   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000365   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     3124    11236    4                       CALL KSE$ERRMSG(%E$KS_DUP_NODE,VECTOR(KS_SUB_BUF_1));

  11236  4 000366   000031 630400 5                  EPPR0   25
         4 000367   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000370   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000371   000000 011000                    NOP     0

     3125    11237    4                       RETURN;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:581  

  11237  4 000372   000000 702200 xent               TSX2  ! X66_ARET

     3126    11238    4                    END;
     3127    11239    3              END;

  11239  4 000373   200027 235100                    LDA     I,,AUTO
         4 000374   000001 035007                    ADLA    1,DL
         4 000375   200027 755100                    STA     I,,AUTO
         4 000376   000000 236000 xsym               LDQ     KS_NETWORK
         4 000377   200027 116100                    CMPQ    I,,AUTO
         4 000400   000351 603000 4                  TRC     s:11232

     3128    11240
     3129    11241    2           IF NODETYPE = %KS_RFEP AND (KS_LINK.LINKS# + NRLINKS = 0) THEN

  11241  4 000401   200035 235100                    LDA     NODETYPE,,AUTO
         4 000402   000005 115007                    CMPA    5,DL
         4 000403   000430 601000 4                  TNZ     s:11249
         4 000404   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000405   000000 236100                    LDQ     0,,PR0
         4 000406   200011 036100                    ADLQ    NRLINKS,,AUTO
         4 000407   000430 601000 4                  TNZ     s:11249

     3130    11242    3              DO;

     3131    11243    3                 KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11243  4 000410   200027 236100                    LDQ     I,,AUTO
         4 000411   000024 402007                    MPY     20,DL
         4 000412   040000 100406                    MLR     fill='040'O
         4 000413   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000414   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     3132    11244    3                 KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));

  11244  4 000415   010000 236003                    LDQ     4096,DU
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:582  
         4 000416   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     3133    11245    3                 CALL KSE$ERRMSG(%E$KS_RFEP_WITH_NO_LINKS);

  11245  4 000417   000034 630400 5                  EPPR0   28
         4 000420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000421   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000422   000000 011000                    NOP     0

     3134    11246    3                 CALL KSE$ERRMSG(%E$KS_NO_UPDATE,VECTOR(KS_SUB_BUF_1));

  11246  4 000423   000017 630400 5                  EPPR0   15
         4 000424   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000425   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000426   000000 011000                    NOP     0

     3135    11247    3                 RETURN;

  11247  4 000427   000000 702200 xent               TSX2  ! X66_ARET

     3136    11248    3              END;
     3137    11249    3           DO I = 0 TO KS_NETWORK.NODE#;

  11249  4 000430   200027 450100                    STZ     I,,AUTO
         4 000431   000554 710000 4                  TRA     s:11278+3

     3138    11250    3              IF I~= FEX THEN

  11250  4 000432   200027 236100                    LDQ     I,,AUTO
         4 000433   200034 116100                    CMPQ    FEX,,AUTO
         4 000434   000551 600000 4                  TZE     s:11278

     3139    11251    4                 DO;

     3140    11252    4                    IF NEW_CLASS = %KS_HOST AND KS_NETWORK.NODE.NODE(FEX) ~= NODENAME
             11252                             AND

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:583  
  11252  4 000435   200036 235100                    LDA     NEW_CLASS,,AUTO
         4 000436   000001 115007                    CMPA    1,DL
         4 000437   000505 601000 4                  TNZ     s:11265
         4 000440   200034 236100                    LDQ     FEX,,AUTO
         4 000441   000024 402007                    MPY     20,DL
         4 000442   040100 106406                    CMPC    fill='040'O
         4 000443   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000444   200006 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000445   000505 600000 4                  TZE     s:11265
         4 000446   200027 236100                    LDQ     I,,AUTO
         4 000447   000024 402007                    MPY     20,DL
         4 000450   200042 756100                    STQ     CONTROL_NODE+2,,AUTO
         4 000451   200034 236100                    LDQ     FEX,,AUTO
         4 000452   000024 402007                    MPY     20,DL
         4 000453   200042 235100                    LDA     CONTROL_NODE+2,,AUTO
         4 000454   040006 106405                    CMPC    fill='040'O
         4 000455   000004 000010 xsym               ADSC9   KS_NETWORK+4,A           cn=0,n=8
         4 000456   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000457   000505 601000 4                  TNZ     s:11265

     3141    11253    4                      KS_NETWORK.NODE.CONTROL_NODE(I) = KS_NETWORK.NODE.NODE(FEX) THEN
     3142    11254    5                       DO;

     3143    11255    5                          KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11255  4 000460   200027 236100                    LDQ     I,,AUTO
         4 000461   000024 402007                    MPY     20,DL
         4 000462   040000 100406                    MLR     fill='040'O
         4 000463   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000464   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     3144    11256    5                          KS_SUB_BUF_2.TEXT = KS_NETWORK.NODE.CONTROL_NODE(I);

  11256  4 000465   040000 100406                    MLR     fill='040'O
         4 000466   000004 000010 xsym               ADSC9   KS_NETWORK+4,Q           cn=0,n=8
         4 000467   000000 200037 xsym               ADSC9   KS_SUB_BUF_2             cn=1,n=31

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:584  
     3145    11257    5                          KS_SUB_BUF_3.TEXT = KS_NETWORK.NODE.NODE(FEX);

  11257  4 000470   200034 236100                    LDQ     FEX,,AUTO
         4 000471   000024 402007                    MPY     20,DL
         4 000472   040000 100406                    MLR     fill='040'O
         4 000473   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000474   000000 200037 xsym               ADSC9   KS_SUB_BUF_3             cn=1,n=31

     3146    11258    5                          KS_SUB_BUF_1.COUNT = SIZEC(KS_NETWORK.NODE.NODE(I));

  11258  4 000475   010000 236003                    LDQ     4096,DU
         4 000476   000000 552040 xsym               STBQ    KS_SUB_BUF_1,'40'O

     3147    11259    5                          KS_SUB_BUF_2.COUNT = SIZEC(KS_NETWORK.NODE.CONTROL_NODE(I));

  11259  4 000477   000000 552040 xsym               STBQ    KS_SUB_BUF_2,'40'O

     3148    11260    5                          KS_SUB_BUF_3.COUNT = SIZEC(KS_NETWORK.NODE.NODE(FEX));

  11260  4 000500   000000 552040 xsym               STBQ    KS_SUB_BUF_3,'40'O

     3149    11261    5                          CALL KSE$ERRMSG (%E$KS_CONTROLS_NAME_CHANGED,VECTOR(
             11261                                  KS_SUB_BUF_1),VECTOR(KS_SUB_BUF_2),VECTOR(KS_SUB_BUF_3));

  11261  4 000501   000043 630400 5                  EPPR0   35
         4 000502   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000503   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000504   000000 011000                    NOP     0

     3150    11262        /*E* ERROR: KSN-E$KS_CONTROLS_NAME_CHANGED-0
     3151    11263         MESSAGE: WARNING - Node %U1 knows this node by the name %U2.  Its control node may
             11263        need to be changed to %U3. */
     3152    11264    5                       END;

     3153    11265    4                    IF NEW_CLASS = %KS_FEP AND KS_NETWORK.NODE.CONTROL_NODE(I) =
             11265                             NODENAME THEN

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:585  
  11265  4 000505   200036 235100                    LDA     NEW_CLASS,,AUTO
         4 000506   000002 115007                    CMPA    2,DL
         4 000507   000525 601000 4                  TNZ     s:11270
         4 000510   200027 236100                    LDQ     I,,AUTO
         4 000511   000024 402007                    MPY     20,DL
         4 000512   040100 106406                    CMPC    fill='040'O
         4 000513   000004 000010 xsym               ADSC9   KS_NETWORK+4,Q           cn=0,n=8
         4 000514   200006 000010                    ADSC9   NODENAME,,AUTO           cn=0,n=8
         4 000515   000525 601000 4                  TNZ     s:11270

     3154    11266    5                       DO;

     3155    11267    5                          KS_SUB_BUF_1.TEXT = KS_NETWORK.NODE.NODE(I);

  11267  4 000516   040000 100406                    MLR     fill='040'O
         4 000517   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000520   000000 200037 xsym               ADSC9   KS_SUB_BUF_1             cn=1,n=31

     3156    11268    5                          CALL KSE$ERRMSG (%E$KS_NODE_NOT_CNTRL,VECTOR(KS_SUB_BUF_1));

  11268  4 000521   000047 630400 5                  EPPR0   39
         4 000522   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000523   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000524   000000 011000                    NOP     0

     3157    11269    5                       END;

     3158    11270    4                    IF CONTROL_NODE = KS_NETWORK.NODE.NODE(I) AND

  11270  4 000525   200027 236100                    LDQ     I,,AUTO
         4 000526   000024 402007                    MPY     20,DL
         4 000527   040006 106500                    CMPC    fill='040'O
         4 000530   200040 000010                    ADSC9   CONTROL_NODE,,AUTO       cn=0,n=8
         4 000531   000002 000010 xsym               ADSC9   KS_NETWORK+2,Q           cn=0,n=8
         4 000532   000551 601000 4                  TNZ     s:11278
         4 000533   200040 237100                    LDAQ    CONTROL_NODE,,AUTO
         4 000534   000022 117000 5                  CMPAQ   18
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:586  
         4 000535   000551 600000 4                  TZE     s:11278
         4 000536   200027 236100                    LDQ     I,,AUTO
         4 000537   000005 402007                    MPY     5,DL
         4 000540   000001 235006 xsym               LDA     KS_NETWORK+1,QL
         4 000541   000001 115007                    CMPA    1,DL
         4 000542   000551 600000 4                  TZE     s:11278
         4 000543   000003 115007                    CMPA    3,DL
         4 000544   000551 600000 4                  TZE     s:11278

     3159    11271    4                       CONTROL_NODE ~= ' ' AND
     3160    11272    4                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_HOST AND
     3161    11273    4                      (KS_NETWORK.NODE.TYPE(I) ~= %KS_ME)) THEN
     3162    11274    5                       DO;

     3163    11275    5                          CALL KSE$ERRMSG (%E$KS_CNTRL_NOT_HOST);

  11275  4 000545   000051 630400 5                  EPPR0   41
         4 000546   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000547   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000550   000000 011000                    NOP     0

     3164    11276    5                       END;

     3165    11277    4                 END;

     3166    11278    3           END;

  11278  4 000551   200027 235100                    LDA     I,,AUTO
         4 000552   000001 035007                    ADLA    1,DL
         4 000553   200027 755100                    STA     I,,AUTO
         4 000554   000000 236000 xsym               LDQ     KS_NETWORK
         4 000555   200027 116100                    CMPQ    I,,AUTO
         4 000556   000432 603000 4                  TRC     s:11250

     3167    11279    2           IF KS_NODE = FEX THEN

  11279  4 000557   000000 236000 xsym               LDQ     KS_NODE
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:587  
         4 000560   000571 604000 4                  TMI     s:11284
         4 000561   200034 116100                    CMPQ    FEX,,AUTO
         4 000562   000571 601000 4                  TNZ     s:11284

     3168    11280    3              DO;

     3169    11281    3                 KS_NODENAME = NODENAME;

  11281  4 000563   200006 237100                    LDAQ    NODENAME,,AUTO
         4 000564   000000 755000 xsym               STA     KS_NODENAME
         4 000565   000001 756000 xsym               STQ     KS_NODENAME+1

     3170    11282    3                 PROMPT.NODENAME = NODENAME;

  11282  4 000566   200006 237100                    LDAQ    NODENAME,,AUTO
         4 000567   000000 755000 xsym               STA     PROMPT
         4 000570   000001 756000 xsym               STQ     PROMPT+1

     3171    11283    3              END;

     3172    11284    2           KS_NETWORK.NODE.TYPE(FEX) = NODETYPE;

  11284  4 000571   200034 236100                    LDQ     FEX,,AUTO
         4 000572   000005 402007                    MPY     5,DL
         4 000573   200035 235100                    LDA     NODETYPE,,AUTO
         4 000574   000001 755006 xsym               STA     KS_NETWORK+1,QL

     3173    11285    2           KS_RFEP.NODE.TYPE(FEX) = NODETYPE;

  11285  4 000575   000326 755006 2                  STA     KS_RFEP+1,QL

     3174    11286    2           IF NODETYPE = %KS_RFEP THEN

  11286  4 000576   000005 115007                    CMPA    5,DL
         4 000577   000602 601000 4                  TNZ     s:11288

     3175    11287    2              KS_NETWORK.NODE.TYPE(FEX) = %KS_FEP;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:588  

  11287  4 000600   000002 235007                    LDA     2,DL
         4 000601   000001 755006 xsym               STA     KS_NETWORK+1,QL

     3176    11288    2           KS_NETWORK.NODE.NODE(FEX) = NODENAME;

  11288  4 000602   000000 620006                    EAX0    0,QL
         4 000603   000000 621006                    EAX1    0,QL
         4 000604   200006 237100                    LDAQ    NODENAME,,AUTO
         4 000605   000002 755010 xsym               STA     KS_NETWORK+2,X0
         4 000606   000003 756011 xsym               STQ     KS_NETWORK+3,X1

     3177    11289    2           KS_NETWORK.NODE.CONTROL_NODE(FEX) = CONTROL_NODE;

  11289  4 000607   200040 237100                    LDAQ    CONTROL_NODE,,AUTO
         4 000610   000004 755010 xsym               STA     KS_NETWORK+4,X0
         4 000611   000005 756010 xsym               STQ     KS_NETWORK+5,X0

     3178    11290    2           WRITE_NETCON.KEY_ = VECTOR(KS_NETWORK_KEY);

  11290  4 000612   000052 237000 5                  LDAQ    42
         4 000613   002762 757000 2                  STAQ    WRITE_NETCON+2

     3179    11291    2           WRITE_NETCON.BUF_ = VECTOR(KS_NETWORK);

  11291  4 000614   000054 237000 5                  LDAQ    44
         4 000615   002764 757000 2                  STAQ    WRITE_NETCON+4

     3180    11292    2           WRITE_NETCON.BUF_.BOUND = SIZEV(KS_NETWORK) - SIZEC(KS_NETWORK.NODE) +

  11292  4 000616   000000 236000 xsym               LDQ     KS_NETWORK
         4 000617   000024 402007                    MPY     20,DL
         4 000620   000003 036007                    ADLQ    3,DL
         4 000621   000020 736000                    QLS     16
         4 000622   002764 676000 2                  ERQ     WRITE_NETCON+4
         4 000623   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000624   002764 656000 2                  ERSQ    WRITE_NETCON+4
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:589  

     3181    11293    2                 KS_NETWORK.NODE#*SIZEC(KS_NETWORK.NODE(0));
     3182    11294    2           CALL M$WRITE(WRITE_NETCON)

  11294  4 000625   002760 630400 2                  EPPR0   WRITE_NETCON
         4 000626   440001 713400                    CLIMB   alt,write
         4 000627   401400 401760                    pmme    nvectors=4
         4 000630   000632 702000 4                  TSX2    s:11296
         4 000631   000636 710000 4                  TRA     s:11298

     3183    11295    3              WHENALTRETURN DO;

     3184    11296    3                 CALL KSE$ERRMSG(0);

  11296  4 000632   000056 630400 5                  EPPR0   46
         4 000633   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000634   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000635   000000 011000                    NOP     0

     3185    11297    3              END;

     3186    11298    2           WRITE_NETCON.KEY_ = VECTOR(KS_RFEP_KEY);

  11298  4 000636   000002 237000 5                  LDAQ    2
         4 000637   002762 757000 2                  STAQ    WRITE_NETCON+2

     3187    11299    2           WRITE_NETCON.BUF_ = VECTOR(KS_RFEP);

  11299  4 000640   000004 237000 5                  LDAQ    4
         4 000641   002764 757000 2                  STAQ    WRITE_NETCON+4

     3188    11300    2           WRITE_NETCON.BUF_.BOUND = SIZEV(KS_RFEP) - SIZEC(KS_RFEP.NODE)

  11300  4 000642   000325 236000 2                  LDQ     KS_RFEP
         4 000643   000024 402007                    MPY     20,DL
         4 000644   000003 036007                    ADLQ    3,DL
         4 000645   000020 736000                    QLS     16
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:590  
         4 000646   002764 676000 2                  ERQ     WRITE_NETCON+4
         4 000647   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000650   002764 656000 2                  ERSQ    WRITE_NETCON+4

     3189    11301    2                                + KS_RFEP.NODE# * SIZEC(KS_RFEP.NODE(0));
     3190    11302    2           CALL M$WRITE(WRITE_NETCON)

  11302  4 000651   002760 630400 2                  EPPR0   WRITE_NETCON
         4 000652   440001 713400                    CLIMB   alt,write
         4 000653   401400 401760                    pmme    nvectors=4
         4 000654   000656 702000 4                  TSX2    s:11304
         4 000655   000662 710000 4                  TRA     s:11307

     3191    11303    3              WHENALTRETURN DO;

     3192    11304    3                 CALL KSE$ERRMSG(0);

  11304  4 000656   000056 630400 5                  EPPR0   46
         4 000657   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000660   000000 701000 xent               TSX1    KSE$ERRMSG
         4 000661   000000 011000                    NOP     0

     3193    11305    3              END;

     3194    11306
     3195    11307    3           DO I = 0 TO NRLINKS - 1;

  11307  4 000662   200027 450100                    STZ     I,,AUTO
         4 000663   000761 710000 4                  TRA     s:11328+3

     3196    11308    3              K = 3;

  11308  4 000664   000003 235007                    LDA     3,DL
         4 000665   200026 755100                    STA     K,,AUTO

     3197    11309    3              TEMP_LINK = '0'B;

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:591  
  11309  4 000666   000000 220003                    LDX0    0,DU
         4 000667   000323 740000 2                  STX0    TEMP_LINK

     3198    11310    4              DO L = 3 DOWNTO 0;

  11310  4 000670   200030 755100                    STA     L,,AUTO

     3199    11311    4                 IF SUBSTR(LINK_LIST(I),L,1) ~= ' ' THEN

  11311  4 000671   200027 236100                    LDQ     I,,AUTO
         4 000672   000002 736000                    QLS     2
         4 000673   200030 036100                    ADLQ    L,,AUTO
         4 000674   040000 106506                    CMPC    fill='040'O
         4 000675   200013 000001                    ADSC9   LINK_LIST,Q,AUTO         cn=0,n=1
         4 000676   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000677   000717 600000 4                  TZE     s:11317

     3200    11312    5                    DO;

     3201    11313    5                       CALL INDEX (TEMP,SUBSTR(LINK_LIST(I),L,1),HEX_CHARS);

  11313  4 000700   200027 236100                    LDQ     I,,AUTO
         4 000701   000002 736000                    QLS     2
         4 000702   200030 036100                    ADLQ    L,,AUTO
         4 000703   000106 124400                    SCM     mask='000'O
         4 000704   000000 000020 1                  ADSC9   HEX_CHARS                cn=0,n=16
         4 000705   200013 000001                    ADSC9   LINK_LIST,Q,AUTO         cn=0,n=1
         4 000706   200033 000100                    ARG     TEMP,,AUTO

     3202    11314    5                       HEX$(K)->HEX = TEMP;

  11314  4 000707   200026 720100                    LXL0    K,,AUTO
         4 000710   000317 470410 2                  LDP0    HEX$,X0
         4 000711   003100 061500                    CSR     bolr='003'O
         4 000712   200033 000044                    BDSC    TEMP,,AUTO               by=0,bit=0,n=36
         4 000713   000000 000004                    BDSC    0,,PR0                   by=0,bit=0,n=4

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:592  
     3203    11315    5                       K = K - 1;

  11315  4 000714   200026 235100                    LDA     K,,AUTO
         4 000715   000001 135007                    SBLA    1,DL
         4 000716   200026 755100                    STA     K,,AUTO

     3204    11316    5                    END;

     3205    11317    4              END;

  11317  4 000717   000001 336007                    LCQ     1,DL
         4 000720   200030 056100                    ASQ     L,,AUTO
         4 000721   000671 605000 4                  TPL     s:11311

     3206    11318    4   LINK_LOOP: DO J = 0 TO KS_LINK.LINKS# - 1;

  11318  4 000722   200032 450100       LINK_LOOP    STZ     J,,AUTO
         4 000723   000736 710000 4                  TRA     s:11321+3

     3207    11319    4                 IF TEMP_LINK = KS_LINK.CHANNEL(J) THEN

  11319  4 000724   200032 235100                    LDA     J,,AUTO
         4 000725   000001 735000                    ALS     1
         4 000726   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000727   000105 106400                    CMPC    fill='000'O
         4 000730   000323 000002 2                  ADSC9   TEMP_LINK                cn=0,n=2
         4 000731   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
         4 000732   000742 600000 4                  TZE     s:11323

     3208    11320    4                    EXIT LINK_LOOP;
     3209    11321    4              END;

  11321  4 000733   200032 236100                    LDQ     J,,AUTO
         4 000734   000001 036007                    ADLQ    1,DL
         4 000735   200032 756100                    STQ     J,,AUTO
         4 000736   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000737   200032 236100                    LDQ     J,,AUTO
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:593  
         4 000740   000000 116100                    CMPQ    0,,PR0
         4 000741   000724 602000 4                  TNC     s:11319

     3210    11322
     3211    11323    3              IF J = KS_LINK.LINKS# THEN

  11323  4 000742   200032 236100                    LDQ     J,,AUTO
         4 000743   000000 116100                    CMPQ    0,,PR0
         4 000744   000756 601000 4                  TNZ     s:11328

     3212    11324    4                 DO;

     3213    11325    4                    KS_LINK.CHANNEL(KS_LINK.LINKS#) = TEMP_LINK;

  11325  4 000745   000000 235100                    LDA     0,,PR0
         4 000746   000001 735000                    ALS     1
         4 000747   000105 100400                    MLR     fill='000'O
         4 000750   000323 000002 2                  ADSC9   TEMP_LINK                cn=0,n=2
         4 000751   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2

     3214    11326    4                    KS_LINK.LINKS# = KS_LINK.LINKS# + 1;

  11326  4 000752   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000753   000000 235100                    LDA     0,,PR0
         4 000754   000001 035007                    ADLA    1,DL
         4 000755   000000 755100                    STA     0,,PR0

     3215    11327    4                 END;

     3216    11328    3           END;

  11328  4 000756   200027 235100                    LDA     I,,AUTO
         4 000757   000001 035007                    ADLA    1,DL
         4 000760   200027 755100                    STA     I,,AUTO
         4 000761   200027 236100                    LDQ     I,,AUTO
         4 000762   000765 604000 4                  TMI     s:11330
         4 000763   200011 116100                    CMPQ    NRLINKS,,AUTO
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:594  
         4 000764   000664 604000 4                  TMI     s:11308

     3217    11329
     3218    11330    2           KS_LINK_KEY.NODE = FEX;

  11330  4 000765   200034 236100                    LDQ     FEX,,AUTO
         4 000766   000011 736000                    QLS     9
         4 000767   002726 552010 2                  STBQ    KS_LINK_KEY,'10'O

     3219    11331    2           WRITE_NETCON.BUF_ = VECTOR(KS_MSGBUF);

  11331  4 000770   000010 237000 5                  LDAQ    8
         4 000771   002764 757000 2                  STAQ    WRITE_NETCON+4

     3220    11332    2           WRITE_NETCON.KEY_ = VECTOR(KS_LINK_KEY);

  11332  4 000772   000006 237000 5                  LDAQ    6
         4 000773   002762 757000 2                  STAQ    WRITE_NETCON+2

     3221    11333    2           WRITE_NETCON.BUF_.BOUND = SIZEC(KS_LINK.LINKS#) +

  11333  4 000774   000000 470400 xsym               LDP0    KS_MSGBUF$
         4 000775   000000 236100                    LDQ     0,,PR0
         4 000776   000001 736000                    QLS     1
         4 000777   000003 036007                    ADLQ    3,DL
         4 001000   000020 736000                    QLS     16
         4 001001   002764 676000 2                  ERQ     WRITE_NETCON+4
         4 001002   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001003   002764 656000 2                  ERSQ    WRITE_NETCON+4

     3222    11334    2                                    (SIZEC(KS_LINK.CHANNEL(0)) *
     3223    11335    2                                     KS_LINK.LINKS#) - 1;
     3224    11336    2           CALL M$WRITE(WRITE_NETCON);

  11336  4 001004   002760 630400 2                  EPPR0   WRITE_NETCON
         4 001005   040001 713400                    CLIMB   write
         4 001006   401400 401760                    pmme    nvectors=4
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:595  

     3225    11337
     3226    11338    2           KS_FEPHNDLR_KEY.NODE = FEX;

  11338  4 001007   200034 236100                    LDQ     FEX,,AUTO
         4 001010   000011 736000                    QLS     9
         4 001011   000324 552010 2                  STBQ    KS_FEPHNDLR_KEY,'10'O

     3227    11339    2           READ_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);

  11339  4 001012   000060 237000 5                  LDAQ    48
         4 001013   002734 757000 2                  STAQ    READ_NETCON+4

     3228    11340    2           READ_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);

  11340  4 001014   000062 237000 5                  LDAQ    50
         4 001015   002732 757000 2                  STAQ    READ_NETCON+2

     3229    11341    2           CALL M$READ(READ_NETCON)

  11341  4 001016   002730 630400 2                  EPPR0   READ_NETCON
         4 001017   440000 713400                    CLIMB   alt,read
         4 001020   401400 401760                    pmme    nvectors=4
         4 001021   001023 702000 4                  TSX2    s:11343
         4 001022   001027 710000 4                  TRA     s:11345

     3230    11342    3              WHENALTRETURN DO;

     3231    11343    3                 CALL KSE$ERRMSG(0);

  11343  4 001023   000056 630400 5                  EPPR0   46
         4 001024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001025   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001026   000000 011000                    NOP     0

     3232    11344    3              END;

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:596  
     3233    11345    2           IF KS_RFEP.NODE.TYPE(FEX) = %KS_RFEP THEN

  11345  4 001027   200034 236100                    LDQ     FEX,,AUTO
         4 001030   000005 402007                    MPY     5,DL
         4 001031   000326 235006 2                  LDA     KS_RFEP+1,QL
         4 001032   000005 115007                    CMPA    5,DL
         4 001033   001541 601000 4                  TNZ     s:11451

     3234    11346    3              DO;

     3235    11347    3                 J = 0;

  11347  4 001034   200032 450100                    STZ     J,,AUTO

     3236    11348    4                 DO I = 0 TO KS_FEPHNDLR.NHANDLERS - 1;

  11348  4 001035   200027 450100                    STZ     I,,AUTO
         4 001036   001140 710000 4                  TRA     s:11370+3

     3237    11349    4                    IF KS_FEPHNDLR.HANDLER(I) = 'COUPLER' THEN

  11349  4 001037   200027 235100                    LDA     I,,AUTO
         4 001040   000003 735000                    ALS     3
         4 001041   040000 106405                    CMPC    fill='040'O
         4 001042   000244 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         4 001043   000004 000007 1                  ADSC9   HEX_CHARS+4              cn=0,n=7
         4 001044   001074 601000 4                  TNZ     s:11362

     3238    11350    5                       DO;

     3239    11351    5                          KS_HANDLER_KEY.HNDLR = 'COUPLER';

  11351  4 001045   040000 100400                    MLR     fill='040'O
         4 001046   000004 000007 1                  ADSC9   HEX_CHARS+4              cn=0,n=7
         4 001047   000000 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     3240    11352    5                          KS_HANDLER_KEY.NODE = FEX;
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:597  

  11352  4 001050   200034 236100                    LDQ     FEX,,AUTO
         4 001051   000011 736000                    QLS     9
         4 001052   000000 552010 2                  STBQ    KS_HANDLER_KEY,'10'O

     3241    11353    5                          DELREC_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);

  11353  4 001053   000064 237000 5                  LDAQ    52
         4 001054   002750 757000 2                  STAQ    DELREC_NETCON+2

     3242    11354    5                          CALL M$DELREC(DELREC_NETCON);

  11354  4 001055   002746 630400 2                  EPPR0   DELREC_NETCON
         4 001056   040002 713400                    CLIMB   16386
         4 001057   401400 401760                    pmme    nvectors=4

     3243    11355    5                          KS_DEFAULT_KEY.NODE = FEX;

  11355  4 001060   200034 236100                    LDQ     FEX,,AUTO
         4 001061   000011 736000                    QLS     9
         4 001062   000003 552010 2                  STBQ    KS_DEFAULT_KEY,'10'O

     3244    11356    5                          KS_DEFAULT_KEY.HNDLR = 'COUPLER';

  11356  4 001063   040000 100400                    MLR     fill='040'O
         4 001064   000004 000007 1                  ADSC9   HEX_CHARS+4              cn=0,n=7
         4 001065   000003 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

     3245    11357    5                          DELREC_NETCON.KEY_ = VECTOR(KS_DEFAULT_KEY);

  11357  4 001066   000066 237000 5                  LDAQ    54
         4 001067   002750 757000 2                  STAQ    DELREC_NETCON+2

     3246    11358    5                          CALL M$DELREC(DELREC_NETCON);

  11358  4 001070   002746 630400 2                  EPPR0   DELREC_NETCON
         4 001071   040002 713400                    CLIMB   16386
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:598  
         4 001072   401400 401760                    pmme    nvectors=4

     3247    11359    5                       END;

  11359  4 001073   001135 710000 4                  TRA     s:11370

     3248    11360    4                    ELSE
     3249    11361    5                       DO;

     3250    11362    5                          IF KS_FEPHNDLR.HANDLER(I) ~= 'NODEADMN' AND

  11362  4 001074   200027 236100                    LDQ     I,,AUTO
         4 001075   000001 736000                    QLS     1
         4 001076   000244 237006 2                  LDAQ    KS_FEPHNDLR+4,QL
         4 001077   000006 117000 1                  CMPAQ   HEX_CHARS+6
         4 001100   001113 600000 4                  TZE     s:11365
         4 001101   200027 235100                    LDA     I,,AUTO
         4 001102   000003 735000                    ALS     3
         4 001103   040000 106405                    CMPC    fill='040'O
         4 001104   000244 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         4 001105   000010 000007 1                  ADSC9   HEX_CHARS+8              cn=0,n=7
         4 001106   001113 600000 4                  TZE     s:11365

     3251    11363    5                             KS_FEPHNDLR.HANDLER(I) ~= 'HDLCX25'  THEN
     3252    11364    5                             KS_FEPHNDLR.BOOTIME(J) = '0'B;

  11364  4 001107   200032 236100                    LDQ     J,,AUTO
         4 001110   003006 060400                    CSL     bolr='003'O
         4 001111   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         4 001112   000243 000001 2                  BDSC    KS_FEPHNDLR+3,Q          by=0,bit=0,n=1

     3253    11365    5                          IF KS_FEPHNDLR.HANDLER(I) = 'HDLCX25'  THEN

  11365  4 001113   200027 235100                    LDA     I,,AUTO
         4 001114   000003 735000                    ALS     3
         4 001115   040000 106405                    CMPC    fill='040'O
         4 001116   000244 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:599  
         4 001117   000010 000007 1                  ADSC9   HEX_CHARS+8              cn=0,n=7
         4 001120   001123 601000 4                  TNZ     s:11367

     3254    11366    5                             HDLCX25_IN = '1'B;

  11366  4 001121   400000 236003                    LDQ     -131072,DU
         4 001122   200004 756100                    STQ     HDLCX25_IN,,AUTO

     3255    11367    5                          KS_FEPHNDLR.HANDLER(J) = KS_FEPHNDLR.HANDLER(I);

  11367  4 001123   200032 236100                    LDQ     J,,AUTO
         4 001124   000001 736000                    QLS     1
         4 001125   200027 235100                    LDA     I,,AUTO
         4 001126   000001 735000                    ALS     1
         4 001127   000000 620006                    EAX0    0,QL
         4 001130   000244 237005 2                  LDAQ    KS_FEPHNDLR+4,AL
         4 001131   000244 757010 2                  STAQ    KS_FEPHNDLR+4,X0

     3256    11368    5                          J = J + 1;

  11368  4 001132   200032 235100                    LDA     J,,AUTO
         4 001133   000001 035007                    ADLA    1,DL
         4 001134   200032 755100                    STA     J,,AUTO

     3257    11369    5                       END;

     3258    11370    4                 END;

  11370  4 001135   200027 235100                    LDA     I,,AUTO
         4 001136   000001 035007                    ADLA    1,DL
         4 001137   200027 755100                    STA     I,,AUTO
         4 001140   200027 236100                    LDQ     I,,AUTO
         4 001141   000240 116000 2                  CMPQ    KS_FEPHNDLR
         4 001142   001037 602000 4                  TNC     s:11349

     3259    11371    3                 KS_FEPHNDLR.NHANDLERS = J;

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:600  
  11371  4 001143   200032 235100                    LDA     J,,AUTO
         4 001144   000240 755000 2                  STA     KS_FEPHNDLR

     3260    11372    3                 IF ~HDLCX25_IN THEN

  11372  4 001145   200004 236100                    LDQ     HDLCX25_IN,,AUTO
         4 001146   400000 376003                    ANQ     -131072,DU
         4 001147   400000 676003                    ERQ     -131072,DU
         4 001150   001514 600000 4                  TZE     s:11436

     3261    11373    4                    DO;

     3262    11374    4                       KS_FEPHNDLR.NHANDLERS = KS_FEPHNDLR.NHANDLERS + 1;

  11374  4 001151   000001 035007                    ADLA    1,DL
         4 001152   000240 755000 2                  STA     KS_FEPHNDLR

     3263    11375    4                       KS_FEPHNDLR.HANDLER(J) = 'HDLCX25';

  11375  4 001153   200032 236100                    LDQ     J,,AUTO
         4 001154   000001 736000                    QLS     1
         4 001155   000002 736000                    QLS     2
         4 001156   040006 100400                    MLR     fill='040'O
         4 001157   000010 000007 1                  ADSC9   HEX_CHARS+8              cn=0,n=7
         4 001160   000244 000010 2                  ADSC9   KS_FEPHNDLR+4,Q          cn=0,n=8

     3264    11376    4                       KS_FEPHNDLR.BOOTIME(J) = '1'B;

  11376  4 001161   200032 235100                    LDA     J,,AUTO
         4 001162   003005 060400                    CSL     bolr='003'O
         4 001163   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         4 001164   000243 000001 2                  BDSC    KS_FEPHNDLR+3,A          by=0,bit=0,n=1

     3265    11377    4                       KS_DEFAULT_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J);

  11377  4 001165   000003 735000                    ALS     3
         4 001166   040000 100405                    MLR     fill='040'O
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:601  
         4 001167   000244 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         4 001170   000003 600010 2                  ADSC9   KS_DEFAULT_KEY           cn=3,n=8

     3266    11378    4                       CALL KSU$INIT_DEFCNFG(KS_DEFAULT);

  11378  4 001171   000006 630400 2                  EPPR0   DEFAULT$
         4 001172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001173   000000 701000 xent               TSX1    KSU$INIT_DEFCNFG
         4 001174   000000 011000                    NOP     0

     3267    11379    4                      CALL KSU$WRITE_NETCON(VECTOR(KS_DEFAULT_KEY),VECTOR(KS_DEFAULT))
             11379                                ;

  11379  4 001175   000006 470400 2                  LDP0    DEFAULT$
         4 001176   000012 236100                    LDQ     10,,PR0
         4 001177   000011 772000                    QRL     9
         4 001200   000777 376007                    ANQ     511,DL
         4 001201   000053 620006                    EAX0    43,QL
         4 001202   000000 635010                    EAA     0,X0
         4 001203   000002 771000                    ARL     2
         4 001204   000140 135007                    SBLA    96,DL
         4 001205   000006 236000 2                  LDQ     DEFAULT$
         4 001206   200042 757100                    STAQ    CONTROL_NODE+2,,AUTO
         4 001207   200042 631500                    EPPR1   CONTROL_NODE+2,,AUTO
         4 001210   200045 451500                    STP1    CONTROL_NODE+5,,AUTO
         4 001211   000070 236000 5                  LDQ     56
         4 001212   200044 756100                    STQ     CONTROL_NODE+4,,AUTO
         4 001213   200044 630500                    EPPR0   CONTROL_NODE+4,,AUTO
         4 001214   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001215   000000 701000 xent               TSX1    KSU$WRITE_NETCON
         4 001216   000000 011000                    NOP     0

     3268    11380    4                       KS_HANDLER = '0'B;

  11380  4 001217   000236 470400 2                  LDP0    HANDLER$
         4 001220   000100 100400                    MLR     fill='000'O
         4 001221   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:602  
         4 001222   000000 000166                    ADSC9   0,,PR0                   cn=0,n=118

     3269    11381    4                       KS_HANDLER_KEY.HNDLR = KS_FEPHNDLR.HANDLER(J);

  11381  4 001223   200032 235100                    LDA     J,,AUTO
         4 001224   000003 735000                    ALS     3
         4 001225   040000 100405                    MLR     fill='040'O
         4 001226   000244 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         4 001227   000000 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8

     3270    11382    4                       KS_HANDLER.HNDLRFID = KS_FEPHNDLR.HANDLER(J);

  11382  4 001230   040100 100405                    MLR     fill='040'O
         4 001231   000244 000010 2                  ADSC9   KS_FEPHNDLR+4,A          cn=0,n=8
         4 001232   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40

     3271    11383    4                       CALL INDEX(TEMP,' ',KS_HANDLER.HNDLRFID);

  11383  4 001233   000000 124500                    SCM     mask='000'O
         4 001234   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40
         4 001235   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001236   200033 000100                    ARG     TEMP,,AUTO

     3272    11384    4                       CALL INSERT(KS_HANDLER.HNDLRFID,TEMP,,'.:SYS');

  11384  4 001237   200033 720100                    LXL0    TEMP,,AUTO
         4 001240   777727 620010                    EAX0    -41,X0
         4 001241   777777 660003                    ERX0    -1,DU
         4 001242   200033 236100                    LDQ     TEMP,,AUTO
         4 001243   040146 100400                    MLR     fill='040'O
         4 001244   000012 000005 1                  ADSC9   HEX_CHARS+10             cn=0,n=5
         4 001245   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0

     3273    11385    4                       KS_HANDLER.HNDLRNAME = KS_FEPHNDLR.HANDLER(J);

  11385  4 001246   200032 235100                    LDA     J,,AUTO
         4 001247   000001 735000                    ALS     1
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:603  
         4 001250   000244 237005 2                  LDAQ    KS_FEPHNDLR+4,AL
         4 001251   000012 755100                    STA     10,,PR0
         4 001252   000013 756100                    STQ     11,,PR0

     3274    11386    5                        DO HAND# = 0 TO 7;

  11386  4 001253   200031 450100                    STZ     HAND#,,AUTO

     3275    11387    5                             IF KS_HAND_INFO.TEXT(HAND#) = KS_HANDLER_KEY.HNDLR

  11387  4 001254   200031 236100                    LDQ     HAND#,,AUTO
         4 001255   000024 402007                    MPY     20,DL
         4 001256   040000 106406                    CMPC    fill='040'O
         4 001257   000000 000010 xsym               ADSC9   KS_HAND_INFO,Q           cn=0,n=8
         4 001260   000000 600010 2                  ADSC9   KS_HANDLER_KEY           cn=3,n=8
         4 001261   001267 600000 4                  TZE     s:11391

     3276    11388    5                             THEN
     3277    11389    5                                  EXIT;
     3278    11390    5                             END;

  11390  4 001262   200031 235100                    LDA     HAND#,,AUTO
         4 001263   000001 035007                    ADLA    1,DL
         4 001264   200031 755100                    STA     HAND#,,AUTO
         4 001265   000010 115007                    CMPA    8,DL
         4 001266   001254 602000 4                  TNC     s:11387

     3279    11391    4                       KS_HANDLER.TYPE = KS_HAND_INFO.TYPE(HAND#);

  11391  4 001267   200031 236100                    LDQ     HAND#,,AUTO
         4 001270   000005 402007                    MPY     5,DL
         4 001271   000236 470400 2                  LDP0    HANDLER$
         4 001272   000002 236006 xsym               LDQ     KS_HAND_INFO+2,QL
         4 001273   000033 736000                    QLS     27
         4 001274   000014 552140                    STBQ    12,'40'O,PR0

     3280    11392
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:604  
     3281    11393    4                       DFLT$ = KS_HAND_INFO.PARAMS$(HAND#);

  11393  4 001275   200031 236100                    LDQ     HAND#,,AUTO
         4 001276   000005 402007                    MPY     5,DL
         4 001277   000004 236006 xsym               LDQ     KS_HAND_INFO+4,QL
         4 001300   200010 756100                    STQ     DFLT$,,AUTO

     3282    11394
     3283    11395    4                       IF KS_HAND_INFO.SZ(HAND#) <= %KL_FIXED_HI

  11395  4 001301   200031 236100                    LDQ     HAND#,,AUTO
         4 001302   000005 402007                    MPY     5,DL
         4 001303   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         4 001304   000036 115007                    CMPA    30,DL
         4 001305   001312 603000 4                  TRC     s:11397

     3284    11396    4                       THEN KS_HANDLER.NPARAMS = KS_HAND_INFO.SZ(HAND#);

  11396  4 001306   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         4 001307   000011 736000                    QLS     9
         4 001310   000014 552110                    STBQ    12,'10'O,PR0
         4 001311   001314 710000 4                  TRA     s:11399

     3285    11397    4                       ELSE KS_HANDLER.NPARAMS = %KL_FIXED_HI;

  11397  4 001312   035000 236007                    LDQ     14848,DL
         4 001313   000014 552110                    STBQ    12,'10'O,PR0

     3286    11398
     3287    11399    5                       DO K=0 TO KS_HANDLER.NPARAMS-1;

  11399  4 001314   200026 450100                    STZ     K,,AUTO
         4 001315   001332 710000 4                  TRA     s:11401+3

     3288    11400    5                          KS_HANDLER.PARAMS(K) = DFLT$->KS$PARAM.DEFAULT(K);

  11400  4 001316   200026 235100                    LDA     K,,AUTO
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:605  
         4 001317   000004 735000                    ALS     4
         4 001320   200026 236100                    LDQ     K,,AUTO
         4 001321   000001 736000                    QLS     1
         4 001322   200010 470500                    LDP0    DFLT$,,AUTO
         4 001323   000236 471400 2                  LDP1    HANDLER$
         4 001324   000106 101505                    MRL     fill='000'O
         4 001325   000003 000004                    ADSC9   3,A,PR0                  cn=0,n=4
         4 001326   100015 000002                    ADSC9   13,Q,PR1                 cn=0,n=2

     3289    11401    5                          END;

  11401  4 001327   200026 235100                    LDA     K,,AUTO
         4 001330   000001 035007                    ADLA    1,DL
         4 001331   200026 755100                    STA     K,,AUTO
         4 001332   000236 470400 2                  LDP0    HANDLER$
         4 001333   000014 236100                    LDQ     12,,PR0
         4 001334   000011 772000                    QRL     9
         4 001335   000777 376007                    ANQ     511,DL
         4 001336   200026 116100                    CMPQ    K,,AUTO
         4 001337   001341 600000 4                  TZE     s:11403
         4 001340   001316 603000 4                  TRC     s:11400

     3290    11402
     3291    11403    4                       IF KS_HAND_INFO.SZ(HAND#) > %KL_FIXED_HI

  11403  4 001341   200031 236100                    LDQ     HAND#,,AUTO
         4 001342   000005 402007                    MPY     5,DL
         4 001343   000003 235006 xsym               LDA     KS_HAND_INFO+3,QL
         4 001344   000036 115007                    CMPA    30,DL
         4 001345   001453 602000 4                  TNC     s:11421

     3292    11404    5                       THEN DO;

     3293    11405    5                            KS_HANDLER.NPARAMI = KS_HAND_INFO.SZ(HAND#) - %KL_FIXED_HI
             11405                                      ;

  11405  4 001346   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:606  
         4 001347   000035 136007                    SBLQ    29,DL
         4 001350   000014 552104                    STBQ    12,'04'O,PR0

     3294    11406    5                            OUT$ = PINCRW(ADDR(KS_HANDLER),SIZEW(KS_HANDLER));

  11406  4 001351   000236 236000 2                  LDQ     HANDLER$
         4 001352   000036 036003                    ADLQ    30,DU
         4 001353   200005 756100                    STQ     OUT$,,AUTO

     3295    11407
     3296    11408    6                            DO K = %KL_ASYNC_BLOCK TO KS_HAND_INFO.SZ(HAND#)-1;

  11408  4 001354   000035 235007                    LDA     29,DL
         4 001355   200026 755100                    STA     K,,AUTO
         4 001356   001445 710000 4                  TRA     s:11418+3

     3297    11409    6                               DFLT_OPT$ = DFLT$->KS$PARAM.SPCL_TBL$(K);

  11409  4 001357   200026 235100                    LDA     K,,AUTO
         4 001360   000002 735000                    ALS     2
         4 001361   200010 470500                    LDP0    DFLT$,,AUTO
         4 001362   000002 236105                    LDQ     2,AL,PR0
         4 001363   200012 756100                    STQ     DFLT_OPT$,,AUTO

     3298    11410    6                               KS_HANDLER.IPARAM.OFFSET(K - %KL_ASYNC_BLOCK) = POFFW(
             11410                                        OUT$,ADDR(KS_HANDLER));

  11410  4 001364   000236 236000 2                  LDQ     HANDLER$
         4 001365   000022 772000                    QRL     18
         4 001366   200042 756100                    STQ     CONTROL_NODE+2,,AUTO
         4 001367   200005 236100                    LDQ     OUT$,,AUTO
         4 001370   000022 772000                    QRL     18
         4 001371   200042 136100                    SBLQ    CONTROL_NODE+2,,AUTO
         4 001372   000000 620006                    EAX0    0,QL
         4 001373   000236 471400 2                  LDP1    HANDLER$
         4 001374   200026 721100                    LXL1    K,,AUTO
         4 001375   177777 740111                    STX0    -1,X1,PR1
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:607  

     3299    11411    6                               KS_HANDLER.IPARAM.ARRAY_SZ(K - %KL_ASYNC_BLOCK) =
             11411                                        KS_HAND_INFO.PARAMS$(HAND#)->KS$PARAM.ARRAY_SZ(K);

  11411  4 001376   200031 236100                    LDQ     HAND#,,AUTO
         4 001377   000005 402007                    MPY     5,DL
         4 001400   000004 473406 xsym               LDP3    KS_HAND_INFO+4,QL
         4 001401   200026 235100                    LDA     K,,AUTO
         4 001402   000002 735000                    ALS     2
         4 001403   300001 236105                    LDQ     1,AL,PR3
         4 001404   000011 736000                    QLS     9
         4 001405   177776 676111                    ERQ     -2,X1,PR1
         4 001406   777000 376007                    ANQ     -512,DL
         4 001407   177776 656111                    ERSQ    -2,X1,PR1

     3300    11412
     3301    11413    7                               DO I = 0 TO KS_HANDLER.IPARAM.ARRAY_SZ(K - %
             11413                                        KL_ASYNC_BLOCK);

  11413  4 001410   200027 450100                    STZ     I,,AUTO
         4 001411   001426 710000 4                  TRA     s:11415+3

     3302    11414    7                               OUT$->B$PARAMI(I) = DFLT_OPT$->KS$PARAM.DEFAULT(I);

  11414  4 001412   200027 235100                    LDA     I,,AUTO
         4 001413   000004 735000                    ALS     4
         4 001414   200027 236100                    LDQ     I,,AUTO
         4 001415   000001 736000                    QLS     1
         4 001416   200012 470500                    LDP0    DFLT_OPT$,,AUTO
         4 001417   200005 471500                    LDP1    OUT$,,AUTO
         4 001420   000106 101505                    MRL     fill='000'O
         4 001421   000003 000004                    ADSC9   3,A,PR0                  cn=0,n=4
         4 001422   100000 000002                    ADSC9   0,Q,PR1                  cn=0,n=2

     3303    11415    7                                 END;

  11415  4 001423   200027 235100                    LDA     I,,AUTO
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:608  
         4 001424   000001 035007                    ADLA    1,DL
         4 001425   200027 755100                    STA     I,,AUTO
         4 001426   000236 470400 2                  LDP0    HANDLER$
         4 001427   200026 720100                    LXL0    K,,AUTO
         4 001430   077776 236110                    LDQ     -2,X0,PR0
         4 001431   000011 772000                    QRL     9
         4 001432   000777 376007                    ANQ     511,DL
         4 001433   200027 116100                    CMPQ    I,,AUTO
         4 001434   001412 603000 4                  TRC     s:11414

     3304    11416
     3305    11417    6                               OUT$ = PINCRW(OUT$,(KS_HANDLER.IPARAM.ARRAY_SZ(K - %
             11417                                        KL_ASYNC_BLOCK)+2)/2);

  11417  4 001435   000002 036007                    ADLQ    2,DL
         4 001436   000001 772000                    QRL     1
         4 001437   000022 736000                    QLS     18
         4 001440   200005 036100                    ADLQ    OUT$,,AUTO
         4 001441   200005 756100                    STQ     OUT$,,AUTO

     3306    11418    6                               END;  /* DO K - # of indexed params */

  11418  4 001442   200026 235100                    LDA     K,,AUTO
         4 001443   000001 035007                    ADLA    1,DL
         4 001444   200026 755100                    STA     K,,AUTO
         4 001445   200031 236100                    LDQ     HAND#,,AUTO
         4 001446   000005 402007                    MPY     5,DL
         4 001447   000003 236006 xsym               LDQ     KS_HAND_INFO+3,QL
         4 001450   200026 116100                    CMPQ    K,,AUTO
         4 001451   001453 600000 4                  TZE     s:11421
         4 001452   001357 603000 4                  TRC     s:11409

     3307    11419    5                           END;  /* DO IF ANY INDEXED PARAMS */

     3308    11420
     3309    11421    4                       WRITE_NETCON.KEY_ = VECTOR(KS_HANDLER_KEY);

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:609  
  11421  4 001453   000064 237000 5                  LDAQ    52
         4 001454   002762 757000 2                  STAQ    WRITE_NETCON+2

     3310    11422    4                       WRITE_NETCON.BUF_ = VECTOR(KS_HANDLER);

  11422  4 001455   000071 235000 5                  LDA     57
         4 001456   000236 236000 2                  LDQ     HANDLER$
         4 001457   002764 757000 2                  STAQ    WRITE_NETCON+4

     3311    11423    4                       IF KS_HANDLER.NPARAMI = 0

  11423  4 001460   000014 236100                    LDQ     12,,PR0
         4 001461   000777 316007                    CANQ    511,DL
         4 001462   001467 601000 4                  TNZ     s:11429

     3312    11424    5                       THEN DO;

     3313    11425    5                          OUT$ = ADDR(KS_HANDLER);

  11425  4 001463   000236 236000 2                  LDQ     HANDLER$
         4 001464   200005 756100                    STQ     OUT$,,AUTO

     3314    11426    5                          OUT$ = PINCRW(OUT$,SIZEW(KS_HANDLER) + 1);

  11426  4 001465   000037 036003                    ADLQ    31,DU
         4 001466   200005 756100                    STQ     OUT$,,AUTO

     3315    11427    5                       END;

     3316    11428
     3317    11429    4                       WRITE_NETCON.BUF_.BOUND = POFFC(OUT$,ADDR(KS_HANDLER))-1;

  11429  4 001467   000236 236000 2                  LDQ     HANDLER$
         4 001470   000020 772000                    QRL     16
         4 001471   200042 756100                    STQ     CONTROL_NODE+2,,AUTO
         4 001472   200005 236100                    LDQ     OUT$,,AUTO
         4 001473   000020 772000                    QRL     16
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:610  
         4 001474   200042 136100                    SBLQ    CONTROL_NODE+2,,AUTO
         4 001475   000001 136007                    SBLQ    1,DL
         4 001476   000020 736000                    QLS     16
         4 001477   002764 676000 2                  ERQ     WRITE_NETCON+4
         4 001500   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001501   002764 656000 2                  ERSQ    WRITE_NETCON+4

     3318    11430    4                       CALL M$WRITE(WRITE_NETCON)

  11430  4 001502   002760 630400 2                  EPPR0   WRITE_NETCON
         4 001503   440001 713400                    CLIMB   alt,write
         4 001504   401400 401760                    pmme    nvectors=4
         4 001505   001507 702000 4                  TSX2    s:11432
         4 001506   001514 710000 4                  TRA     s:11436

     3319    11431    5                          WHENALTRETURN DO;

     3320    11432    5                             CALL KSE$ERRMSG(0);

  11432  4 001507   000056 630400 5                  EPPR0   46
         4 001510   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001511   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001512   000000 011000                    NOP     0

     3321    11433    5                             ALTRETURN;

  11433  4 001513   000000 702200 xent               TSX2  ! X66_AALT

     3322    11434    5                          END;
     3323    11435    4                    END;

     3324    11436    3              WRITE_NETCON.KEY_ = VECTOR(KS_FEPHNDLR_KEY);

  11436  4 001514   000062 237000 5                  LDAQ    50
         4 001515   002762 757000 2                  STAQ    WRITE_NETCON+2

     3325    11437    3              WRITE_NETCON.BUF_ = VECTOR(KS_FEPHNDLR);
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:611  

  11437  4 001516   000060 237000 5                  LDAQ    48
         4 001517   002764 757000 2                  STAQ    WRITE_NETCON+4

     3326    11438
     3327    11439
     3328    11440
     3329    11441
     3330    11442    3                 WRITE_NETCON.BUF_.BOUND = SIZEC(KS_FEPHNDLR.NHANDLERS) + SIZEC(
             11442                          KS_FEPHNDLR.DEFLIBACCT) + 4  /* bootime */

  11442  4 001520   000240 236000 2                  LDQ     KS_FEPHNDLR
         4 001521   000003 736000                    QLS     3
         4 001522   000017 036007                    ADLQ    15,DL
         4 001523   000020 736000                    QLS     16
         4 001524   002764 676000 2                  ERQ     WRITE_NETCON+4
         4 001525   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 001526   002764 656000 2                  ERSQ    WRITE_NETCON+4

     3331    11443    3                                           + SIZEC(KS_FEPHNDLR.HANDLER(0)) *
             11443                                                    KS_FEPHNDLR.NHANDLERS - 1;
     3332    11444    3              CALL M$WRITE(WRITE_NETCON)

  11444  4 001527   002760 630400 2                  EPPR0   WRITE_NETCON
         4 001530   440001 713400                    CLIMB   alt,write
         4 001531   401400 401760                    pmme    nvectors=4
         4 001532   001534 702000 4                  TSX2    s:11446
         4 001533   001541 710000 4                  TRA     s:11451

     3333    11445    4                 WHENALTRETURN DO;

     3334    11446    4                    CALL KSE$ERRMSG(0);

  11446  4 001534   000056 630400 5                  EPPR0   46
         4 001535   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001536   000000 701000 xent               TSX1    KSE$ERRMSG
         4 001537   000000 011000                    NOP     0
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:612  

     3335    11447    4                    ALTRETURN;

  11447  4 001540   000000 702200 xent               TSX2  ! X66_AALT

     3336    11448    4                 END;
     3337    11449    3           END;

     3338    11450    2        END;

     3339    11451    1   END KSC$UPDATE;

  11451  4 001541   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:613  
--  Include file information  --

   KL_AFCN_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KS_PERR_C.:E05TOU  is referenced.
   KS_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KS_MACRO_M.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure KSC$UPDATE.
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:614  

 **** Variables and constants ****

  ****  Section 001 RoData KSC$UPDATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(16)    r     1 HEX_CHARS

  ****  Section 002  Data  KSC$UPDATE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    71-0-0/c CHAR        r     1 CHAR_BUF(0:400)            6-0-0/w PTR         r     1 DEFAULT$
     7-0-0/w UBIN        r     1 DEFAULT_BUF(0:49)
  2746-0-0/d STRC(360)   r     1 DELREC_NETCON            236-0-0/w PTR         r     1 HANDLER$
   237-0-0/w PTR         r     1 HDR$                     317-0-0/w PTR         r     1 HEX$(0:3)
     3-0-0/w STRC(99)    r     1 KS_DEFAULT_KEY           240-0-0/w STRC(1656)  r     1 KS_FEPHNDLR
   324-0-0/w STRC(27)    r     1 KS_FEPHNDLR_KEY            0-0-0/w STRC(99)    r     1 KS_HANDLER_KEY
  2726-0-0/w STRC(27)    r     1 KS_LINK_KEY             2774-0-0/w STRC(18)    r     1 KS_NETWORK_KEY
   325-0-0/w STRC(46116) r     1 KS_RFEP                  316-0-0/w STRC(18)    r     1 KS_RFEP_KEY
  2730-0-0/d STRC(504)   r     1 READ_NETCON              323-0-0/b STRC(18)    r     1 TEMP_LINK
  2760-0-0/d STRC(432)   r     1 WRITE_NETCON

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                     40-0-0/c CHAR(8)     r     1 CONTROL_NODE
    10-0-0/w PTR         r     1 DFLT$                     12-0-0/w PTR         r     1 DFLT_OPT$
    34-0-0/w UBIN        r     1 FEX                       31-0-0/w UBIN        r     1 HAND#
     4-0-0/b BIT         r     1 HDLCX25_IN                27-0-0/w UBIN        r     1 I
    32-0-0/w UBIN        r     1 J                         26-0-0/w UBIN        r     1 K
    30-0-0/w SBIN        r     1 L
    13-0-0/c CHAR(4)     r     1 LINK_LIST(0:10)
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:615  
    36-0-0/w UBIN        r     1 NEW_CLASS                  6-0-0/c CHAR(8)     r     1 NODENAME
    35-0-0/w UBIN        r     1 NODETYPE                  11-0-0/w SBIN        r     1 NRLINKS
    37-0-0/w UBIN        r     1 OLD_CLASS                  5-0-0/w PTR         r     1 OUT$
    33-0-0/w UBIN        r     1 TEMP                      *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 KS_HAND_INFO(0:0)
     0-0-0/c CHAR(400)   r     1 KS_MSGBUF                  0-0-0/w PTR         r     1 KS_MSGBUF$
     0-0-0/w STRC(46116) r     1 KS_NETWORK                 0-0-0/w SBIN        r     1 KS_NODE
     0-0-0/c CHAR(8)     r     1 KS_NODENAME                0-0-0/w STRC(288)   r     1 KS_SUB_BUF_1
     0-0-0/w STRC(288)   r     1 KS_SUB_BUF_2               0-0-0/w STRC(288)   r     1 KS_SUB_BUF_3
     0-0-0/c STRC(90)    r     1 PROMPT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/h UBIN(18)    r     1 B$PARAMI(0:0)
     0-0-0/b UBIN(4)     r     1 HEX
     0-0-0/w STRC(144)   r     1 KS$PARAM(0:0)
     0-0-0/w ASTR(387)   r     1 KS_DEFAULT                 0-0-0/w STRC(1062)  r     1 KS_HANDLER
     0-0-0/w STRC(54)    r     1 KS_LINK                    0-0-0N  NULL        r     1 M$NETCON
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(306)   r     1 UPDATE


   Procedure KSC$UPDATE requires 866 words for executable code.
   Procedure KSC$UPDATE requires 38 words of local(AUTO) storage.

    No errors detected in file KSC$COMMANDS2.:E05TSI    .
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:616  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:617  
          MINI XREF LISTING

B$PARAMI
     10821**DCL     11414<<ASSIGN
CHAR_BUF
     10313**DCL     10314--DCLINIT
CONTROL_NODE
     11138**DCL     11165<<ASSIGN  11175<<ASSIGN  11208>>IF      11270>>IF      11270>>IF      11289>>ASSIGN
DEFAULT$
     10311**DCL     10681--IMP-PTR 11378>>CALL    11378>>CALL    11379>>CALL    11379>>CALL
DEFAULT_BUF
     10312**DCL     10311--DCLINIT
DELREC_NETCON
     10554**DCL     11354<>CALL    11358<>CALL
DELREC_NETCON.KEY_
     10554**DCL     11353<<ASSIGN  11357<<ASSIGN
DELREC_NETCON.V
     10557**DCL     10554--DCLINIT
DFLT$
     11124**DCL     11393<<ASSIGN  11400>>ASSIGN  11409>>ASSIGN
DFLT_OPT$
     11126**DCL     11409<<ASSIGN  11414>>ASSIGN
FEX
     11134**DCL     11148<>CALL    11157>>ASSIGN  11164>>ASSIGN  11165>>ASSIGN  11188>>IF      11188>>IF
     11198>>ASSIGN  11213>>ASSIGN  11223>>ASSIGN  11230>>IF      11250>>IF      11252>>IF      11252>>IF
     11257>>ASSIGN  11260>>ASSIGN  11279>>IF      11284>>ASSIGN  11285>>ASSIGN  11287>>ASSIGN  11288>>ASSIGN
     11289>>ASSIGN  11330>>ASSIGN  11338>>ASSIGN  11345>>IF      11352>>ASSIGN  11355>>ASSIGN
HAND#
     11131**DCL     11386<<DOINDEX 11387>>IF      11391>>ASSIGN  11393>>ASSIGN  11395>>IF      11396>>ASSIGN
     11403>>IF      11405>>ASSIGN  11408>>DOINDEX 11411>>ASSIGN
HANDLER$
     10314**DCL     10882--IMP-PTR 11380>>ASSIGN  11382>>ASSIGN  11383>>CALLBLT 11384>>CALLBLT 11385>>ASSIGN
     11391>>ASSIGN  11396>>ASSIGN  11397>>ASSIGN  11399>>DOINDEX 11400>>ASSIGN  11405>>ASSIGN  11406>>ASSIGN
     11410>>ASSIGN  11410>>ASSIGN  11411>>ASSIGN  11413>>DOINDEX 11417>>ASSIGN  11422>>ASSIGN  11423>>IF
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:618  
     11425>>ASSIGN  11429>>ASSIGN
HDLCX25_IN
     11121**DCL     11366<<ASSIGN  11372>>IF
HDR$
     10395**DCL     10331--IMP-PTR 10946--IMP-PTR 11143>>ASSIGN  11144>>CALL
HEX
     11093**DCL     11314<<ASSIGN
HEX$
     10429**DCL     11314>>ASSIGN
HEX_CHARS
     10245**DCL     11313>>CALLBLT
I
     11129**DCL     11168<<DOINDEX 11169>>DOCASE  11171>>ASSIGN  11171>>ASSIGN  11173>>ASSIGN  11175>>ASSIGN
     11175>>ASSIGN  11177>>ASSIGN  11179>>ASSIGN  11179>>ASSIGN  11199>>ASSIGN  11214>>ASSIGN  11224>>ASSIGN
     11231<<DOINDEX 11232>>IF      11234>>ASSIGN  11235>>ASSIGN  11243>>ASSIGN  11244>>ASSIGN  11249<<DOINDEX
     11250>>IF      11252>>IF      11255>>ASSIGN  11256>>ASSIGN  11258>>ASSIGN  11259>>ASSIGN  11265>>IF
     11267>>ASSIGN  11270>>IF      11270>>IF      11270>>IF      11307<<DOINDEX 11311>>IF      11313>>CALLBLT
     11348<<DOINDEX 11349>>IF      11362>>IF      11362>>IF      11365>>IF      11367>>ASSIGN  11413<<DOINDEX
     11414>>ASSIGN  11414>>ASSIGN
J
     11132**DCL     11178<<DOINDEX 11179>>ASSIGN  11179>>ASSIGN  11179>>ASSIGN  11318<<DOINDEX 11319>>IF
     11323>>IF      11347<<ASSIGN  11364>>ASSIGN  11367>>ASSIGN  11368<<ASSIGN  11368>>ASSIGN  11371>>ASSIGN
     11375>>ASSIGN  11376>>ASSIGN  11377>>ASSIGN  11381>>ASSIGN  11382>>ASSIGN  11385>>ASSIGN
K
     11128**DCL     11308<<ASSIGN  11314>>ASSIGN  11315<<ASSIGN  11315>>ASSIGN  11399<<DOINDEX 11400>>ASSIGN
     11400>>ASSIGN  11408<<DOINDEX 11409>>ASSIGN  11410>>ASSIGN  11411>>ASSIGN  11411>>ASSIGN  11413>>DOINDEX
     11417>>ASSIGN
KS$PARAM.ARRAY_SZ
     10634**DCL     11411>>ASSIGN
KS$PARAM.DEFAULT
     10658**DCL     11400>>ASSIGN  11414>>ASSIGN
KS$PARAM.SPCL_TBL$
     10651**DCL     11409>>ASSIGN
KSE$ERRMSG
     10084**DCL-ENT 11195--CALL    11200--CALL    11210--CALL    11215--CALL    11220--CALL    11225--CALL
     11236--CALL    11245--CALL    11246--CALL    11261--CALL    11268--CALL    11275--CALL    11296--CALL
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:619  
     11304--CALL    11343--CALL    11432--CALL    11446--CALL
KSR$WR_HLPCG
     10086**DCL-ENT 11144--CALL
KSU$GET_NODE
     10093**DCL-ENT 11148--CALL
KSU$INIT_DEFCNFG
     10092**DCL-ENT 11378--CALL
KSU$WRITE_NETCON
     10094**DCL-ENT 11379--CALL
KS_DEFAULT
     10681**DCL     11378<>CALL    11379--CALL
KS_DEFAULT.LGN.LGNSIZE
     10818**DCL     10819--IMP-SIZ 11378>>CALL    11379>>CALL
KS_DEFAULT_KEY
     10305**DCL     11357--ASSIGN  11379--CALL
KS_DEFAULT_KEY.HNDLR
     10309**DCL     11356<<ASSIGN  11377<<ASSIGN
KS_DEFAULT_KEY.NODE
     10308**DCL     11355<<ASSIGN
KS_FEPHNDLR
     10409**DCL     11339--ASSIGN  11437--ASSIGN
KS_FEPHNDLR.BOOTIME
     10416**DCL     11364<<ASSIGN  11376<<ASSIGN
KS_FEPHNDLR.DEFLIBACCT
     10413**DCL     11442--ASSIGN
KS_FEPHNDLR.HANDLER
     10420**DCL     11349>>IF      11362>>IF      11362>>IF      11365>>IF      11367<<ASSIGN  11367>>ASSIGN
     11375<<ASSIGN  11377>>ASSIGN  11381>>ASSIGN  11382>>ASSIGN  11385>>ASSIGN  11442--ASSIGN
KS_FEPHNDLR.NHANDLERS
     10410**DCL     11348>>DOINDEX 11371<<ASSIGN  11374<<ASSIGN  11374>>ASSIGN  11442--ASSIGN  11442>>ASSIGN
KS_FEPHNDLR_KEY
     10454**DCL     11340--ASSIGN  11436--ASSIGN
KS_FEPHNDLR_KEY.NODE
     10457**DCL     11338<<ASSIGN
KS_HANDLER
     10882**DCL     11380<<ASSIGN  11406--ASSIGN  11406--ASSIGN  11410--ASSIGN  11422--ASSIGN  11425--ASSIGN
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:620  
     11426--ASSIGN  11429--ASSIGN
KS_HANDLER.HNDLRFID
     10883**DCL     11382<<ASSIGN  11383>>CALLBLT 11384<<CALLBLT
KS_HANDLER.HNDLRNAME
     10886**DCL     11385<<ASSIGN
KS_HANDLER.IPARAM.ARRAY_SZ
     10915**DCL     11411<<ASSIGN  11413>>DOINDEX 11417>>ASSIGN
KS_HANDLER.IPARAM.OFFSET
     10924**DCL     11410<<ASSIGN
KS_HANDLER.NPARAMI
     10904**DCL     11405<<ASSIGN  11423>>IF
KS_HANDLER.NPARAMS
     10899**DCL     11396<<ASSIGN  11397<<ASSIGN  11399>>DOINDEX
KS_HANDLER.PARAMS
     10909**DCL     11400<<ASSIGN
KS_HANDLER.TYPE
     10890**DCL     11391<<ASSIGN
KS_HANDLER_KEY
     10286**DCL     11353--ASSIGN  11421--ASSIGN
KS_HANDLER_KEY.HNDLR
     10290**DCL     11351<<ASSIGN  11381<<ASSIGN  11387>>IF
KS_HANDLER_KEY.NODE
     10289**DCL     11352<<ASSIGN
KS_HAND_INFO.PARAMS$
     10185**DCL     11393>>ASSIGN  11411>>ASSIGN
KS_HAND_INFO.SZ
     10180**DCL     11395>>IF      11396>>ASSIGN  11403>>IF      11405>>ASSIGN  11408>>DOINDEX
KS_HAND_INFO.TEXT
     10170**DCL     11387>>IF
KS_HAND_INFO.TYPE
     10174**DCL     11391>>ASSIGN
KS_LINK.CHANNEL
      9532**DCL     11319>>IF      11325<<ASSIGN  11333--ASSIGN
KS_LINK.LINKS#
      9531**DCL     11162<<ASSIGN  11218>>IF      11241>>IF      11318>>DOINDEX 11323>>IF      11325>>ASSIGN
     11326<<ASSIGN  11326>>ASSIGN  11333>>ASSIGN  11333--ASSIGN
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:621  
KS_LINK_KEY
     10499**DCL     11158--ASSIGN  11332--ASSIGN
KS_LINK_KEY.NODE
     10502**DCL     11157<<ASSIGN  11330<<ASSIGN
KS_MSGBUF
      9531**DCL     10395--DCLINIT 11159--ASSIGN  11331--ASSIGN
KS_MSGBUF$
      9531**DCL      9531--IMP-PTR 11162>>ASSIGN  11218>>IF      11241>>IF      11318>>DOINDEX 11319>>IF
     11323>>IF      11325>>ASSIGN  11325>>ASSIGN  11326>>ASSIGN  11326>>ASSIGN  11333>>ASSIGN
KS_MYSTATION
      9527**DCL      9527--REDEF
KS_NETWORK
     10138**DCL     11155>>ASSIGN  11291--ASSIGN  11292--ASSIGN
KS_NETWORK.NODE
     10141**DCL     11292--ASSIGN  11292--ASSIGN
KS_NETWORK.NODE.CONTROL_NODE
     10148**DCL     11165>>ASSIGN  11252>>IF      11256>>ASSIGN  11259--ASSIGN  11265>>IF      11289<<ASSIGN
KS_NETWORK.NODE.NODE
     10147**DCL     11198--ASSIGN  11199>>ASSIGN  11213--ASSIGN  11214>>ASSIGN  11223--ASSIGN  11224>>ASSIGN
     11230>>IF      11232>>IF      11234--ASSIGN  11235>>ASSIGN  11243>>ASSIGN  11244--ASSIGN  11252>>IF
     11252>>IF      11255>>ASSIGN  11257>>ASSIGN  11258--ASSIGN  11260--ASSIGN  11267>>ASSIGN  11270>>IF
     11288<<ASSIGN
KS_NETWORK.NODE.TYPE
     10144**DCL     11188>>IF      11188>>IF      11270>>IF      11270>>IF      11284<<ASSIGN  11287<<ASSIGN
KS_NETWORK.NODE#
     10139**DCL     11231>>DOINDEX 11249>>DOINDEX 11292>>ASSIGN
KS_NETWORK_KEY
     10835**DCL     11290--ASSIGN
KS_NODE
      9528**DCL     11279>>IF
KS_NODENAME
      9527**DCL     11281<<ASSIGN
KS_RFEP
     10472**DCL     11153--ASSIGN  11155<<ASSIGN  11299--ASSIGN  11300--ASSIGN
KS_RFEP.NODE
     10475**DCL     11300--ASSIGN  11300--ASSIGN
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:622  
KS_RFEP.NODE.TYPE
     10478**DCL     11164>>ASSIGN  11285<<ASSIGN  11345>>IF
KS_RFEP.NODE#
     10473**DCL     11300>>ASSIGN
KS_RFEP_KEY
     10426**DCL     11152--ASSIGN  11298--ASSIGN
KS_SUB_BUF_1
      9532**DCL     11200--CALL    11215--CALL    11225--CALL    11236--CALL    11246--CALL    11261--CALL
     11268--CALL
KS_SUB_BUF_1.COUNT
      9532**DCL     11198<<ASSIGN  11213<<ASSIGN  11223<<ASSIGN  11234<<ASSIGN  11244<<ASSIGN  11258<<ASSIGN
KS_SUB_BUF_1.TEXT
      9532**DCL     11199<<ASSIGN  11214<<ASSIGN  11224<<ASSIGN  11235<<ASSIGN  11243<<ASSIGN  11255<<ASSIGN
     11267<<ASSIGN
KS_SUB_BUF_2
      9532**DCL     11261--CALL
KS_SUB_BUF_2.COUNT
      9533**DCL     11259<<ASSIGN
KS_SUB_BUF_2.TEXT
      9533**DCL     11256<<ASSIGN
KS_SUB_BUF_3
      9533**DCL     11261--CALL
KS_SUB_BUF_3.COUNT
      9533**DCL     11260<<ASSIGN
KS_SUB_BUF_3.TEXT
      9533**DCL     11257<<ASSIGN
L
     11130**DCL     11310<<DOINDEX 11311>>IF      11313>>CALLBLT
LINK_LIST
     11127**DCL     11179<<ASSIGN  11311>>IF      11313>>CALLBLT
LINK_LOOP
     11318**LABEL   11320--EXIT
M$DELREC
       122**DCL-ENT 11354--CALL    11358--CALL
M$READ
       121**DCL-ENT 11154--CALL    11160--CALL    11341--CALL
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:623  
M$WRITE
       121**DCL-ENT 11294--CALL    11302--CALL    11336--CALL    11430--CALL    11444--CALL
NEW_CLASS
     11136**DCL     11185<<ASSIGN  11187<<ASSIGN  11193>>IF      11206>>IF      11252>>IF      11265>>IF
NODENAME
     11123**DCL     11148<>CALL    11171<<ASSIGN  11230>>IF      11232>>IF      11252>>IF      11265>>IF
     11281>>ASSIGN  11282>>ASSIGN  11288>>ASSIGN
NODETYPE
     11135**DCL     11164<<ASSIGN  11173<<ASSIGN  11184>>IF      11184>>IF      11241>>IF      11284>>ASSIGN
     11285>>ASSIGN  11286>>IF
NRLINKS
     11125**DCL     11166<<ASSIGN  11177<<ASSIGN  11178>>DOINDEX 11218>>IF      11241>>IF      11307>>DOINDEX
OLD_CLASS
     11137**DCL     11190<<ASSIGN  11192<<ASSIGN  11193>>IF
OUT$
     11122**DCL     11406<<ASSIGN  11410>>ASSIGN  11414>>ASSIGN  11417<<ASSIGN  11417>>ASSIGN  11425<<ASSIGN
     11426<<ASSIGN  11426>>ASSIGN  11429>>ASSIGN
OUT$BLK.CODE
     11024**DCL     11169>>DOCASE  11173>>ASSIGN
OUT$BLK.NSUBLKS
     11028**DCL     11141>>IF      11168>>DOINDEX 11177>>ASSIGN
OUT$BLK.SUBLK$
     11049**DCL     11148>>CALL    11148<>CALL    11169>>DOCASE  11171>>ASSIGN  11171>>ASSIGN  11171>>ASSIGN
     11171>>ASSIGN  11173>>ASSIGN  11173>>ASSIGN  11175>>ASSIGN  11175>>ASSIGN  11175>>ASSIGN  11175>>ASSIGN
     11177>>ASSIGN  11179>>ASSIGN  11179>>ASSIGN  11179>>ASSIGN  11179>>ASSIGN
OUT$SYM.COUNT
     11085**DCL     11088--IMP-SIZ 11171>>ASSIGN  11175>>ASSIGN  11179>>ASSIGN
OUT$SYM.TEXT
     11088**DCL     11171>>ASSIGN  11175>>ASSIGN  11179>>ASSIGN
PROMPT.NODENAME
     10123**DCL     11282<<ASSIGN
READ_NETCON
     10521**DCL     11154<>CALL    11160<>CALL    11341<>CALL
READ_NETCON.BUF_
     10523**DCL     11153<<ASSIGN  11159<<ASSIGN  11339<<ASSIGN
READ_NETCON.KEY_
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:624  
     10521**DCL     11152<<ASSIGN  11158<<ASSIGN  11340<<ASSIGN
READ_NETCON.STATION_
     10524**DCL     10525--REDEF
READ_NETCON.V
     10525**DCL     10521--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
     10536**DCL     10536--REDEF
READ_NETCON.V.INDX#
     10534**DCL     10534--REDEF
TEMP
     11133**DCL     11313<<CALLBLT 11314>>ASSIGN  11383<<CALLBLT 11384>>CALLBLT
TEMP_LINK
     10434**DCL     11309<<ASSIGN  11319>>IF      11325>>ASSIGN
TEMP_LINK.HEX0
     10436**DCL     10430--DCLINIT
TEMP_LINK.HEX1
     10437**DCL     10431--DCLINIT
TEMP_LINK.HEX2
     10439**DCL     10432--DCLINIT
TEMP_LINK.HEX3
     10440**DCL     10433--DCLINIT
TOP$
         9**DCL         7--PROC    11016--IMP-PTR 11141>>IF      11148>>CALL    11168>>DOINDEX 11169>>DOCASE
     11171>>ASSIGN  11171>>ASSIGN  11173>>ASSIGN  11175>>ASSIGN  11175>>ASSIGN  11177>>ASSIGN  11179>>ASSIGN
     11179>>ASSIGN
UPDATE
     10331**DCL     11144--CALL
UPDATE.CODE
     10336**DCL     11143<<ASSIGN
WRITE_NETCON
     10579**DCL     11294<>CALL    11302<>CALL    11336<>CALL    11430<>CALL    11444<>CALL
WRITE_NETCON.BUF_
     10579**DCL     11291<<ASSIGN  11299<<ASSIGN  11331<<ASSIGN  11422<<ASSIGN  11437<<ASSIGN
WRITE_NETCON.BUF_.BOUND
     10579**DCL     11292<<ASSIGN  11300<<ASSIGN  11333<<ASSIGN  11429<<ASSIGN  11442<<ASSIGN
WRITE_NETCON.KEY_
PL6.E3A0      #004=KSC$UPDATE File=KSC$COMMANDS2.:E05TSI                         WED 07/30/97 01:48 Page:625  
     10579**DCL     11290<<ASSIGN  11298<<ASSIGN  11332<<ASSIGN  11421<<ASSIGN  11436<<ASSIGN
WRITE_NETCON.STATION_
     10581**DCL     10581--REDEF
WRITE_NETCON.V
     10582**DCL     10579--DCLINIT
WRITE_NETCON.V.DVBYTE.VFC#
     10588**DCL     10588--REDEF
