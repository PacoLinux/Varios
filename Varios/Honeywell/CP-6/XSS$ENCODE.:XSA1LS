VERSION A01

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:1    
        1        1        /*M*    XSS$ENCODE      Encode a Session PDU and send it to Transport   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSS$ENCODE
        9        9                DESCRIPTION:
       10       10                    This routine encodes any desired Session PDU and sends it on
       11       11                    to the Transport layer.  The VBLK.EVENT determines which SPDU
       12       12                    to construct.  The resulting SPDU is passed on to Transport with
       13       13                    a Transport function code and any associated user data supplied.
       14       14        */
       15       15        XSS$ENCODE: PROC( VBLK) ALTRET;
       16       16        %INCLUDE UM_CP6;
       17      868        %INCLUDE K_ADDRESS_M;
       18     1371        %INCLUDE XSS_SESSION_E;
       19     1936        %INCLUDE XSS_SESSION_M;
       20     4579            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       21     7958        %INCLUDE XSS_INTERNAL_E;
       22     8256        %INCLUDE XSS_INTERNAL_M;
       23     8845            %XSS$SCTX( NAME=SCTX, STCLASS="BASED( SCTX$)");
       24     9279            %XSS$VBLK( NAME=VBLK, STCLASS="");
       25     9384        %INCLUDE XSC_COMMON_M;
       26    10037            %XSC$ADDRESS( NAME=UADR);
       27    10320        %MACRO FATALDEF( NAME=XSS_FATAL, STCLASS="CONSTANT SYMDEF", LVL=1, LAST=";",
       28    10321                         ERR#=0, SEV=7);
       29    10322            %VLP_ERRCODE( FPTN=NAME, STCLASS=STCLASS, FCG='XS', MID='S',
       30    10323                          MON='0'B, ERR#=ERR#, SEV=SEV);
       31    10324        %MEND;
       32    10325        %INCLUDE XSC_PERR_C;
       33    10402            %FATALDEF( NAME=XSS_F$ENCODE, ERR#=%F$ENCODE);
       34    10450            /*E*  ERROR:  XSS-F$ENCODE-7
       35    10451                MESSAGE:  VBLK.EVENT illegal for PDU encoder.
       36    10452            */
       37    10453        %EQU ITEMMAX = 16;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:2    
       38    10454
       39    10455    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
       40    10456    1       DCL XSS$RELMEM ENTRY(1) ALTRET;
       41    10457    1       DCL XSS$SCREECH ENTRY(1);
       42    10458    1       DCL XSS$TSEND ENTRY(1) ALTRET;
       43    10459
       44    10460    1       DCL XSS_ITEMCNT SBIN STATIC SYMDEF INIT( 0);
       45    10461    1       DCL XSS_ITEMMAX SBIN STATIC SYMDEF INIT( %ITEMMAX);
       46    10462
       47    10463            %ITEM( NAME="ITEMLIST(0:%ITEMMAX)", STCLASS=AUTO);
       48    10488    1       DCL BTMP BIT(36) ALIGNED;
       49    10489    1       DCL DATALVL SBIN;
       50    10490    1       DCL DATATAG SBIN;
       51    10491    1       DCL LOAD_GT_VALUE BIT(1) STATIC INIT( %FALSE);
       52    10492    1       DCL LOAD_PT_VALUE BIT(1) STATIC INIT( %FALSE);
       53    10493    1       DCL MAXSZ SBIN;
       54    10494    1       DCL PDUBUF CHAR( 600) AUTO;
       55    10495    1       DCL PDUIDX SBIN;
       56    10496    1       DCL REASON CHAR(513) AUTO;
       57    10497    1       DCL SCTX$ PTR;
       58    10498    1       DCL SFPT$ PTR;
       59    10499    1       DCL TEXT CHAR(16384) BASED CALIGNED;
       60    10500    1       DCL 1 TXTC BASED,
       61    10501    1            2 LEN UBIN(9) CALIGNED,
       62    10502    1            2 TXT CHAR( TXTC.LEN) CALIGNED;
       63    10503
       64    10504    1       SCTX$ = VBLK.CTX$;
       65    10505    1       SFPT$ = VBLK.FPT$;
       66    10506    1       DATALVL = 0;
       67    10507    1       DATATAG = %PGI_DATA;
       68    10508    1       XSS_ITEMCNT = 0;
       69    10509    1       ITEMLIST = '0'B;
       70    10510            %LOAD( LVL=0, TYP=NONE);
       71    10574    2       DO CASE( VBLK.EVENT);
       72    10575        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:3    
       73    10576        /*****************************************************************************
       74    10577        *
       75    10578        *       AA              ABORT ACCEPT SPDU
       76    10579        *
       77    10580        *****************************************************************************/
       78    10581    2           CASE( %XSS_SEV_AA);
       79    10582                    %LOAD( LVL=1, TAG=SI_AA, TYP=NONE);
       80    10646        /*****************************************************************************
       81    10647        *
       82    10648        *       AB_NR           ABORT (NO REUSE) SPDU
       83    10649        *       AB_R            ABORT (REUSE) SPDU
       84    10650        *
       85    10651        *****************************************************************************/
       86    10652    2           CASE( %XSS_SEV_AB_NR);
       87    10653    2               SCTX.TD.TCREL = %TRUE;
       88    10654    2               GOTO AB_COMMON;
       89    10655    2           CASE( %XSS_SEV_AB_R);
       90    10656    2               SCTX.TD.TCREL = %FALSE;
       91    10657    2   AB_COMMON:
       92    10658                    %LOAD( LVL=1, TAG=SI_AB, TYP=NONE);
       93    10722                    %LOAD( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL="SCTX.TD");
       94    10786    2               IF SCTX.TD.PRTER THEN
       95    10787                        %LOAD( LVL=2, TAG=PGI_RPV, TYP=CPTR, LEN=9, VAL="SCTX.RPV");
       96    10851    2               IF SCTX.TD.USRAB THEN
       97    10852    2                   DATALVL = 2;
       98    10853        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:4    
       99    10854        /*****************************************************************************
      100    10855        *
      101    10856        *       AC              ACCEPT SPDU
      102    10857        *
      103    10858        *****************************************************************************/
      104    10859    2           CASE( %XSS_SEV_AC);
      105    10860                    %LOAD( LVL=1, TAG=SI_AC, TYP=NONE);
      106    10924                    %LOAD( LVL=2, TAG=PGI_CI, TYP=NONE);
      107    10988                    %LOAD( LVL=3, TAG=PI_ASSUR, TYP=TXTC,
      108    10989                            VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");
      109    11053    2               IF XSS$CONNECT.COMMON$->TXTC.LEN ~= 0 THEN
      110    11054                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      111    11055                                VAL="XSS$CONNECT.COMMON$->TXTC");
      112    11119    2               IF XSS$CONNECT.ARI ~= %XSS_ARI_NONE# THEN
      113    11120                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN, LEN=4, VAL="XSS$CONNECT.ARI");
      114    11184                    %LOAD( LVL=2, TAG=PGI_CAI, TYP=NONE);
      115    11248                    %LOAD( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL="SCTX.PO");
      116    11312    2               IF SCTX.TSDUMS.INI ~= 0 OR SCTX.TSDUMS.RSP ~= 0 THEN
      117    11313                        %LOAD( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, LEN=4,
      118    11314                                VAL="SCTX.TSDUMS.INI*65536+SCTX.TSDUMS.RSP");
      119    11378                    %LOAD( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL="SCTX.VN");
      120    11442    2               IF NOT XSS$CONNECT.SFU.ACT AND
      121    11443    2                       ( XSS$CONNECT.SFU.RESYN OR XSS$CONNECT.SFU.MA OR
      122    11444    2                       XSS$CONNECT.SFU.SY) THEN
      123    11445                        %LOAD( LVL=3, TAG=PI_ISN, TYP=UBC6,
      124    11446                                LEN=6, VAL="XSS$CONNECT.SERNUM");
      125    11510    2               IF XSS$CONNECT.ITOKENS ~= '111111110'B THEN
      126    11511                        %LOAD( LVL=3, TAG=PI_TSI, TYP=BITS,
      127    11512                                LEN=8, VAL="XSS$CONNECT.ITOKENS");
      128    11576                    %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS,
      129    11577                            LEN=8, VAL="XSS$CONNECT.TOKENS");
      130    11641                    %LOAD( LVL=2, TAG=PGI_SUR, TYP=BITS,
      131    11642                            LEN=16, VAL="XSS$CONNECT.SFU");
      132    11706    2               IF XSS$CONNECT.CALLING$->UADR.SSAP.LEN ~= 0 THEN
      133    11707                        %LOAD( LVL=2, TAG=PGI_ISSEL, TYP=TXTC,
      134    11708                                VAL="XSS$CONNECT.CALLING$->UADR.SSAP");
      135    11772    2               IF XSS$CONNECT.RESPONDING$->UADR.SSAP.LEN ~= 0 THEN
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:5    
      136    11773                        %LOAD( LVL=2, TAG=PGI_ASSEL, TYP=TXTC,
      137    11774                                VAL="XSS$CONNECT.RESPONDING$->UADR.SSAP");
      138    11838    2               DATALVL = 2;
      139    11839        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:6    
      140    11840        /*****************************************************************************
      141    11841        *
      142    11842        *       AD              ACTIVITY DISCARD SPDU
      143    11843        *
      144    11844        *****************************************************************************/
      145    11845    2           CASE( %XSS_SEV_AD);
      146    11846    2               CALL LOADGT;
      147    11847                    %LOAD( LVL=1, TAG=SI_AD, TYP=NONE);
      148    11911                    %LOAD( LVL=2, TAG=PGI_RC, TYP=UBIN,
      149    11912                            LEN=1, VAL="XSS$ACTIVITY_DISCARD.REASON");
      150    11976        /*****************************************************************************
      151    11977        *
      152    11978        *       ADA             ACTIVITY DISCARD ACK SPDU
      153    11979        *
      154    11980        *****************************************************************************/
      155    11981    2           CASE( %XSS_SEV_ADA);
      156    11982    2               CALL LOADPT;
      157    11983                    %LOAD( LVL=1, TAG=SI_ADA, TYP=NONE);
      158    12047        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:7    
      159    12048        /*****************************************************************************
      160    12049        *
      161    12050        *       AE              ACTIVITY END SPDU
      162    12051        *
      163    12052        *****************************************************************************/
      164    12053    2           CASE( %XSS_SEV_AE);
      165    12054    2               CALL LOADGT;
      166    12055                    %LOAD( LVL=1, TAG=SI_AE, TYP=NONE);
      167    12119                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      168    12120                            LEN=6, VAL="XSS$ACTIVITY_END.SERNUM");
      169    12184    2               DATALVL = 2;
      170    12185        /*****************************************************************************
      171    12186        *
      172    12187        *       AEA             ACTIVITY END ACK SPDU
      173    12188        *
      174    12189        *****************************************************************************/
      175    12190    2           CASE( %XSS_SEV_AEA);
      176    12191    2               CALL LOADPT;
      177    12192                    %LOAD( LVL=1, TAG=SI_AEA, TYP=NONE);
      178    12256                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      179    12257                            LEN=6, VAL="SCTX.VM-1");
      180    12321    2               DATALVL = 2;
      181    12322        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:8    
      182    12323        /*****************************************************************************
      183    12324        *
      184    12325        *       AI              ACTIVITY INTERRUPT SPDU
      185    12326        *
      186    12327        *****************************************************************************/
      187    12328    2           CASE( %XSS_SEV_AI);
      188    12329    2               CALL LOADGT;
      189    12330                    %LOAD( LVL=1, TAG=SI_AI, TYP=NONE);
      190    12394                    %LOAD( LVL=2, TAG=PGI_RC, TYP=UBIN,
      191    12395                            LEN=1, VAL="XSS$ACTIVITY_INTERRUPT.REASON");
      192    12459        /*****************************************************************************
      193    12460        *
      194    12461        *       AIA             ACTIVITY INTERRUPT ACK SPDU
      195    12462        *
      196    12463        *****************************************************************************/
      197    12464    2           CASE( %XSS_SEV_AIA);
      198    12465    2               CALL LOADPT;
      199    12466                    %LOAD( LVL=1, TAG=SI_AIA, TYP=NONE);
      200    12530        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:9    
      201    12531        /*****************************************************************************
      202    12532        *
      203    12533        *       AR              ACTIVITY RESUME SPDU
      204    12534        *
      205    12535        *****************************************************************************/
      206    12536    2           CASE( %XSS_SEV_AR);
      207    12537    2               CALL LOADGT;
      208    12538                    %LOAD( LVL=1, TAG=SI_AR, TYP=NONE);
      209    12602                    %LOAD( LVL=2, TAG=PGI_LI, TYP=NONE);
      210    12666    2               IF XSS$ACTIVITY_RESUME.CALLED$->UADR.PSAP.LEN ~= 0 THEN
      211    12667                        %LOAD( LVL=3, TAG=PI_ASSEL, TYP=TXTC,
      212    12668                                VAL="XSS$ACTIVITY_RESUME.CALLED$->UADR.PSAP");
      213    12732    2               IF XSS$ACTIVITY_RESUME.CALLING$->UADR.PSAP.LEN ~= 0 THEN
      214    12733                        %LOAD( LVL=3, TAG=PI_ISSEL, TYP=TXTC,
      215    12734                                VAL="XSS$ACTIVITY_RESUME.CALLING$->UADR.PSAP");
      216    12798    2               IF XSS$ACTIVITY_RESUME.COMMON$->TXTC.LEN ~= 0 THEN
      217    12799                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      218    12800                                VAL="XSS$ACTIVITY_RESUME.COMMON$->TXTC");
      219    12864    2               IF XSS$ACTIVITY_RESUME.ARI ~= %XSS_ARI_NONE# THEN
      220    12865                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN,
      221    12866                                LEN=4, VAL="XSS$ACTIVITY_RESUME.ARI");
      222    12930                    %LOAD( LVL=3, TAG=PI_AI, TYP=TXTC,
      223    12931                            VAL="XSS$ACTIVITY_RESUME.OACTID");
      224    12995                    %LOAD( LVL=3, TAG=PI_SN, TYP=UBC6,
      225    12996                            LEN=6, VAL="XSS$ACTIVITY_RESUME.SERNUM");
      226    13060                    %LOAD( LVL=2, TAG=PGI_AI, TYP=TXTC,
      227    13061                            VAL="XSS$ACTIVITY_RESUME.ACTID");
      228    13125    2               DATALVL = 2;
      229    13126        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:10   
      230    13127        /*****************************************************************************
      231    13128        *
      232    13129        *       AS              ACTIVITY START SPDU
      233    13130        *
      234    13131        *****************************************************************************/
      235    13132    2           CASE( %XSS_SEV_AS);
      236    13133    2               CALL LOADGT;
      237    13134                    %LOAD( LVL=1, TAG=SI_AS, TYP=NONE);
      238    13198                    %LOAD( LVL=2, TAG=PGI_AI, TYP=TXTC,
      239    13199                            VAL="XSS$ACTIVITY_START.ACTID");
      240    13263    2               DATALVL = 2;
      241    13264        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:11   
      242    13265        /*****************************************************************************
      243    13266        *
      244    13267        *       CD              CAPABILITY DATA SPDU
      245    13268        *
      246    13269        *****************************************************************************/
      247    13270    2           CASE( %XSS_SEV_CD);
      248    13271    2               CALL LOADGT;
      249    13272                    %LOAD( LVL=1, TAG=SI_CD, TYP=NONE);
      250    13336    2               DATALVL = 2;
      251    13337        /*****************************************************************************
      252    13338        *
      253    13339        *       CDA             CAPABILITY DATA ACK SPDU
      254    13340        *
      255    13341        *****************************************************************************/
      256    13342    2           CASE( %XSS_SEV_CDA);
      257    13343    2               CALL LOADPT;
      258    13344                    %LOAD( LVL=1, TAG=SI_CDA, TYP=NONE);
      259    13408    2               DATALVL = 2;
      260    13409        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:12   
      261    13410        /*****************************************************************************
      262    13411        *
      263    13412        *       CN              CONNECT SPDU
      264    13413        *
      265    13414        *****************************************************************************/
      266    13415    2           CASE( %XSS_SEV_CN);
      267    13416                    %LOAD( LVL=1, TAG=SI_CN, TYP=NONE);
      268    13480                    %LOAD( LVL=2, TAG=PGI_CI, TYP=NONE);
      269    13544                    %LOAD( LVL=3, TAG=PI_ISSUR, TYP=TXTC,
      270    13545                            VAL="XSS$CONNECT.CALLING$->UADR.PSAP");
      271    13609    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);
      272    13610    2               IF XSS$CONNECT.COMMON$->TXTC.LEN ~= 0 THEN
      273    13611                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      274    13612                                VAL="XSS$CONNECT.COMMON$->TXTC");
      275    13676    2               IF XSS$CONNECT.ARI ~= %XSS_ARI_NONE# THEN
      276    13677                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN, LEN=4, VAL="XSS$CONNECT.ARI");
      277    13741                    %LOAD( LVL=2, TAG=PGI_CAI, TYP=NONE);
      278    13805                    %LOAD( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL="SCTX.PO");
      279    13869    2               IF SCTX.TSDUMS.INI ~= 0 OR SCTX.TSDUMS.RSP ~= 0 THEN
      280    13870                        %LOAD( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, LEN=4,
      281    13871                                VAL="SCTX.TSDUMS.INI*65536+SCTX.TSDUMS.RSP");
      282    13935                    %LOAD( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL="SCTX.VN");
      283    13999    2               IF NOT XSS$CONNECT.SFU.ACT AND
      284    14000    2                       ( XSS$CONNECT.SFU.RESYN OR XSS$CONNECT.SFU.MA OR
      285    14001    2                       XSS$CONNECT.SFU.SY) THEN
      286    14002                        %LOAD( LVL=3, TAG=PI_ISN, TYP=UBC6,
      287    14003                                LEN=6, VAL="XSS$CONNECT.SERNUM");
      288    14067    2               IF XSS$CONNECT.ITOKENS ~= '111111110'B THEN
      289    14068                        %LOAD( LVL=3, TAG=PI_TSI, TYP=BITS,
      290    14069                                LEN=8, VAL="XSS$CONNECT.ITOKENS");
      291    14133    2               IF XSS$CONNECT.ITOKENS.TR = %XSS_TSI_ISIDE# THEN
      292    14134    2                   SCTX.OWNED.TR = %TRUE;
      293    14135    2               IF XSS$CONNECT.ITOKENS.MA = %XSS_TSI_ISIDE# THEN
      294    14136    2                   SCTX.OWNED.MA = %TRUE;
      295    14137    2               IF XSS$CONNECT.ITOKENS.MI = %XSS_TSI_ISIDE# THEN
      296    14138    2                   SCTX.OWNED.MI = %TRUE;
      297    14139    2               IF XSS$CONNECT.ITOKENS.DK = %XSS_TSI_ISIDE# THEN
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:13   
      298    14140    2                   SCTX.OWNED.DK = %TRUE;
      299    14141                    %LOAD( LVL=2, TAG=PGI_SUR, TYP=BITS,
      300    14142                            LEN=16, VAL="XSS$CONNECT.SFU");
      301    14206    2               SCTX.FU = XSS$CONNECT.SFU;  /* negotiate this down on AC */
      302    14207    2               IF XSS$CONNECT.CALLING$->UADR.SSAP.LEN ~= 0 THEN
      303    14208                        %LOAD( LVL=2, TAG=PI_ISSEL, TYP=TXTC,
      304    14209                                VAL="XSS$CONNECT.CALLING$->UADR.SSAP");
      305    14273    2               IF XSS$CONNECT.CALLED$->UADR.SSAP.LEN ~= 0 THEN
      306    14274                        %LOAD( LVL=2, TAG=PI_ASSEL, TYP=TXTC,
      307    14275                                VAL="XSS$CONNECT.CALLED$->UADR.SSAP");
      308    14339    2               DATALVL = 2;
      309    14340                    /* make sure saved copy of User Data is framed.. */
      310    14341    2               IF SCTX.HEADX ~= %NULL THEN
      311    14342    2                   CALL XSS$BUFPTR( SCTX.HEADX, XSS$CONNECT.DATA.PTR$);
      312    14343        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:14   
      313    14344        /*****************************************************************************
      314    14345        *
      315    14346        *       DN              DISCONNECT SPDU
      316    14347        *
      317    14348        *****************************************************************************/
      318    14349    2           CASE( %XSS_SEV_DN);
      319    14350                    %LOAD( LVL=1, TAG=SI_DN, TYP=NONE);
      320    14414    2               DATALVL = 2;
      321    14415        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:15   
      322    14416        /*****************************************************************************
      323    14417        *
      324    14418        *       DT              DATA TRANSFER SPDU
      325    14419        *
      326    14420        *****************************************************************************/
      327    14421    2           CASE( %XSS_SEV_DT);
      328    14422    2               CALL LOADGT;
      329    14423                    %LOAD( LVL=1, TAG=SI_DT, TYP=NONE);
      330    14487    2               IF SCTX.FLAGS.VTCA THEN
      331    14488    2                   MAXSZ = SCTX.TSDUMS.RSP;
      332    14489    2               ELSE
      333    14490    2                   MAXSZ = SCTX.TSDUMS.INI;
      334    14491    2               IF MAXSZ ~= 0 THEN
      335    14492                        %LOAD( LVL=2, TAG=PGI_EI, TYP=BITS, LEN=8, VAL="VBLK.EI");
      336    14556    2               DATALVL = 2;
      337    14557    2               DATATAG = 0;
      338    14558        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:16   
      339    14559        /*****************************************************************************
      340    14560        *
      341    14561        *       ED              EXCEPTION DATA SPDU
      342    14562        *
      343    14563        *****************************************************************************/
      344    14564    2           CASE( %XSS_SEV_ED);
      345    14565    2               CALL LOADPT;
      346    14566                    %LOAD( LVL=1, TAG=SI_ED, TYP=NONE);
      347    14630                    %LOAD( LVL=2, TAG=PGI_RC, TYP=UBIN,
      348    14631                            LEN=1, VAL="XSS$U_EXCEPTION_REPORT.REASON");
      349    14695    2               DATALVL = 2;
      350    14696        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:17   
      351    14697        /*****************************************************************************
      352    14698        *
      353    14699        *       ER              EXCEPTION REPORT SPDU
      354    14700        *
      355    14701        *****************************************************************************/
      356    14702    2           CASE( %XSS_SEV_ER);
      357    14703    2               CALL LOADPT;
      358    14704                    %LOAD( LVL=1, TAG=SI_ER, TYP=NONE);
      359    14768                    %LOAD( LVL=2, TAG=PGI_RPV, TYP=CPTR,
      360    14769                            LEN="XSS$GENERIC.DATA.SIZE",
      361    14770                            VAL="XSS$GENERIC.DATA.PTR$->TEXT");
      362    14834        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:18   
      363    14835        /*****************************************************************************
      364    14836        *
      365    14837        *       EX              EXPEDITED DATA SPDU
      366    14838        *
      367    14839        *****************************************************************************/
      368    14840    2           CASE( %XSS_SEV_EX);
      369    14841                    %LOAD( LVL=1, TAG=SI_EX, TYP=NONE);
      370    14905    2               DATALVL = 2;
      371    14906    2               DATATAG = 0;
      372    14907        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:19   
      373    14908        /*****************************************************************************
      374    14909        *
      375    14910        *       FN_NR           FINISH (NO REUSE) SPDU
      376    14911        *       FN_R            FINISH (REUSE) SPDU
      377    14912        *
      378    14913        *****************************************************************************/
      379    14914    2           CASE( %XSS_SEV_FN_NR);
      380    14915    2               SCTX.TD.TCREL = %TRUE;
      381    14916    2               GOTO FN_COMMON;
      382    14917    2           CASE( %XSS_SEV_FN_R);
      383    14918    2               SCTX.TD.TCREL = %FALSE;
      384    14919    2   FN_COMMON:
      385    14920                    %LOAD( LVL=1, TAG=SI_FN, TYP=NONE);
      386    14984                    %LOAD( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL="SCTX.TD");
      387    15048    2               DATALVL = 2;
      388    15049        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:20   
      389    15050        /*****************************************************************************
      390    15051        *
      391    15052        *       GT              GIVE TOKENS SPDU
      392    15053        *
      393    15054        *****************************************************************************/
      394    15055    2           CASE( %XSS_SEV_GT);
      395    15056                    %LOAD( LVL=1, TAG=SI_GT, TYP=NONE);
      396    15120    2               IF XSS$TOKEN_GIVE.TOKENS ~= '000000000'B THEN
      397    15121                        %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS,
      398    15122                                LEN=8, VAL="XSS$TOKEN_GIVE.TOKENS");
      399    15186        /*****************************************************************************
      400    15187        *
      401    15188        *       GTA             GIVE TOKENS ACK SPDU
      402    15189        *
      403    15190        *****************************************************************************/
      404    15191    2           CASE( %XSS_SEV_GTA);
      405    15192                    %LOAD( LVL=1, TAG=SI_GTA, TYP=NONE);
      406    15256        /*****************************************************************************
      407    15257        *
      408    15258        *       GTC             GIVE TOKENS CONFIRM SPDU
      409    15259        *
      410    15260        *****************************************************************************/
      411    15261    2           CASE( %XSS_SEV_GTC);
      412    15262                    %LOAD( LVL=1, TAG=SI_GTC, TYP=NONE);
      413    15326        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:21   
      414    15327        /*****************************************************************************
      415    15328        *
      416    15329        *       MAA             MAJOR SYNC ACK SPDU
      417    15330        *
      418    15331        *****************************************************************************/
      419    15332    2           CASE( %XSS_SEV_MAA);
      420    15333    2               CALL LOADPT;
      421    15334                    %LOAD( LVL=1, TAG=SI_MAA, TYP=NONE);
      422    15398                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      423    15399                            LEN=6, VAL="SCTX.VM-1");
      424    15463    2               DATALVL = 2;
      425    15464        /*****************************************************************************
      426    15465        *
      427    15466        *       MAP             MAJOR SYNC POINT SPDU
      428    15467        *
      429    15468        *****************************************************************************/
      430    15469    2           CASE( %XSS_SEV_MAP);
      431    15470    2               CALL LOADGT;
      432    15471                    %LOAD( LVL=1, TAG=SI_MAP, TYP=NONE);
      433    15535                    %LOAD( LVL=2, TAG=PGI_STI, TYP=UBIN,
      434    15536                            LEN=1, VAL="XSS$SYNC_MAJOR.TYPE");
      435    15600                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      436    15601                            LEN=6, VAL="XSS$SYNC_MAJOR.SERNUM");
      437    15665    2               DATALVL = 2;
      438    15666        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:22   
      439    15667        /*****************************************************************************
      440    15668        *
      441    15669        *       MIA             MINOR SYNC ACK SPDU
      442    15670        *
      443    15671        *****************************************************************************/
      444    15672    2           CASE( %XSS_SEV_MIA);
      445    15673    2               CALL LOADPT;
      446    15674                    %LOAD( LVL=1, TAG=SI_MIA, TYP=NONE);
      447    15738                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      448    15739                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");
      449    15803    3               IF XSS$GENERIC.DATA.PTR$ ~= ADDR( NIL) THEN DO;
      450    15804                        %LOAD( LVL=2, TAG=PGI_UD, TYP=CPTR,
      451    15805                               LEN="XSS$GENERIC.DATA.SIZE",
      452    15806                               VAL="XSS$GENERIC.DATA.PTR$->TEXT");
      453    15870    3                   END;
      454    15871        /*****************************************************************************
      455    15872        *
      456    15873        *       MIP             MINOR SYNC POINT SPDU
      457    15874        *
      458    15875        *****************************************************************************/
      459    15876    2           CASE( %XSS_SEV_MIP);
      460    15877    2               CALL LOADGT;
      461    15878                    %LOAD( LVL=1, TAG=SI_MIP, TYP=NONE);
      462    15942    2               IF XSS$SYNC_MINOR.TYPE ~= 0 THEN
      463    15943                        %LOAD( LVL=2, TAG=PGI_STI, TYP=UBIN,
      464    15944                                LEN=1, VAL="XSS$SYNC_MINOR.TYPE");
      465    16008                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      466    16009                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");
      467    16073    2               DATALVL = 2;
      468    16074        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:23   
      469    16075        /*****************************************************************************
      470    16076        *
      471    16077        *       NF              NOT FINISHED SPDU
      472    16078        *
      473    16079        *****************************************************************************/
      474    16080    2           CASE( %XSS_SEV_NF);
      475    16081                    %LOAD( LVL=1, TAG=SI_NF, TYP=NONE);
      476    16145    2               DATALVL = 2;
      477    16146        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:24   
      478    16147        /*****************************************************************************
      479    16148        *
      480    16149        *       PR_MAA          PREPARE (MAJOR SYNC ACK) SPDU
      481    16150        *       PR_RA           PREPARE (RESYNCHRONIZE ACK) SPDU
      482    16151        *       PR_RS           PREPARE (RESYNCHRONIZE) SPDU
      483    16152        *
      484    16153        *****************************************************************************/
      485    16154    2           CASE( %XSS_SEV_PR_MAA);
      486    16155    2               SCTX.PT = %XSS_PT_MAA#;
      487    16156    2               GOTO PR_COMMON;
      488    16157    2           CASE( %XSS_SEV_PR_RA);
      489    16158    2               SCTX.PT = %XSS_PT_RA#;
      490    16159    2               GOTO PR_COMMON;
      491    16160    2           CASE( %XSS_SEV_PR_RS);
      492    16161    2               SCTX.PT = %XSS_PT_RS#;
      493    16162    2   PR_COMMON:
      494    16163                    %LOAD( LVL=1, TAG=SI_PR, TYP=NONE);
      495    16227                    %LOAD( LVL=2, TAG=PGI_PT, TYP=UBIN, LEN=1, VAL="SCTX.PT");
      496    16291        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:25   
      497    16292        /*****************************************************************************
      498    16293        *
      499    16294        *       PT              PLEASE TOKENS SPDU
      500    16295        *
      501    16296        *****************************************************************************/
      502    16297    2           CASE( %XSS_SEV_PT);
      503    16298                    %LOAD( LVL=1, TAG=SI_PT, TYP=NONE);
      504    16362    2               IF XSS$TOKEN_PLEASE.TOKENS ~= '000000000'B THEN
      505    16363                        %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS,
      506    16364                                LEN=8, VAL="XSS$TOKEN_PLEASE.TOKENS");
      507    16428    2               DATALVL = 2;
      508    16429        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:26   
      509    16430        /*****************************************************************************
      510    16431        *
      511    16432        *       RA              RESYNCHRONIZE ACK SPDU
      512    16433        *
      513    16434        *****************************************************************************/
      514    16435    2           CASE( %XSS_SEV_RA);
      515    16436    2               CALL LOADPT;
      516    16437                    %LOAD( LVL=1, TAG=SI_RA, TYP=NONE);
      517    16501    2               IF XSS$RESYNCHRONIZE.TOKENS ~= '000000000'B THEN
      518    16502                        %LOAD( LVL=2, TAG=PGI_TSI, TYP=BITS,
      519    16503                                LEN=8, VAL="XSS$RESYNCHRONIZE.TOKENS");
      520    16567                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      521    16568                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");
      522    16632    2               DATALVL = 2;
      523    16633        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:27   
      524    16634        /*****************************************************************************
      525    16635        *
      526    16636        *       RF_NR           REFUSE (NO REUSE) SPDU
      527    16637        *       RF_R            REFUSE (REUSE) SPDU
      528    16638        *
      529    16639        *****************************************************************************/
      530    16640    2           CASE( %XSS_SEV_RF_NR);
      531    16641    2               SCTX.TD.TCREL = %TRUE;
      532    16642    2               GOTO RF_COMMON;
      533    16643    2           CASE( %XSS_SEV_RF_R);
      534    16644    2               SCTX.TD.TCREL = %FALSE;
      535    16645    2   RF_COMMON:
      536    16646                    %LOAD( LVL=1, TAG=SI_RF, TYP=NONE);
      537    16710                    %LOAD( LVL=2, TAG=PGI_CI, TYP=NONE);
      538    16774                    %LOAD( LVL=3, TAG=PI_ASSUR, TYP=TXTC,
      539    16775                            VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");
      540    16839    2               IF XSS$CONNECT.COMMON$->TXTC.LEN ~= 0 THEN
      541    16840                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      542    16841                                VAL="XSS$CONNECT.COMMON$->TXTC");
      543    16905    2               IF XSS$CONNECT.ARI ~= %XSS_ARI_NONE# THEN
      544    16906                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN, LEN=4, VAL="XSS$CONNECT.ARI");
      545    16970                    %LOAD( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL="SCTX.TD");
      546    17034    2               IF XSS$CONNECT.REASON = %XSS_RC_REJECTED# THEN
      547    17035                        %LOAD( LVL=2, TAG=PGI_SUR, TYP=BITS,
      548    17036                                LEN=16, VAL="XSS$CONNECT.SFU");
      549    17100                    %LOAD( LVL=2, TAG=PGI_VN, TYP=UBIN, LEN=1, VAL="SCTX.VN");
      550    17164    2               CALL INSERT( REASON, 0, 1, BINASC( XSS$CONNECT.REASON));
      551    17165    2               CALL INSERT( REASON, 1, XSS$CONNECT.DATA.SIZE,
      552    17166    2                       XSS$CONNECT.DATA.PTR$->TEXT);
      553    17167                    %LOAD( LVL=2, TAG=PGI_RC, TYP=DATA,
      554    17168                            LEN="1+XSS$CONNECT.DATA.SIZE", VAL=REASON);
      555    17232        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:28   
      556    17233        /*****************************************************************************
      557    17234        *
      558    17235        *       RS_A            RESYNCHRONIZE (ABANDON) SPDU
      559    17236        *       RS_R            RESYNCHRONIZE (RESTART) SPDU
      560    17237        *       RS_S            RESYNCHRONIZE (SET) SPDU
      561    17238        *
      562    17239        *****************************************************************************/
      563    17240    2           CASE( %XSS_SEV_RS_A,
      564    17241    2                 %XSS_SEV_RS_R,
      565    17242    2                 %XSS_SEV_RS_S);
      566    17243    2               CALL LOADGT;
      567    17244                    %LOAD( LVL=1, TAG=SI_RS, TYP=NONE);
      568    17308    2               IF XSS$RESYNCHRONIZE.TOKENS ~= '000000000'B THEN
      569    17309                        %LOAD( LVL=2, TAG=PGI_TSI, TYP=BITS,
      570    17310                                LEN=8, VAL="XSS$RESYNCHRONIZE.TOKENS");
      571    17374                    %LOAD( LVL=2, TAG=PGI_RT, TYP=UBIN,
      572    17375                            LEN=1, VAL="XSS$RESYNCHRONIZE.TYPE");
      573    17439                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      574    17440                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");
      575    17504    2               DATALVL = 2;
      576    17505        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:29   
      577    17506        /*****************************************************************************
      578    17507        *
      579    17508        *       TD              TYPED DATA SPDU
      580    17509        *
      581    17510        *****************************************************************************/
      582    17511    2           CASE( %XSS_SEV_TD);
      583    17512                    %LOAD( LVL=1, TAG=SI_TD, TYP=NONE);
      584    17576    2               IF SCTX.FLAGS.VTCA THEN
      585    17577    2                   MAXSZ = SCTX.TSDUMS.RSP;
      586    17578    2               ELSE
      587    17579    2                   MAXSZ = SCTX.TSDUMS.INI;
      588    17580    2               IF MAXSZ ~= 0 THEN
      589    17581                        %LOAD( LVL=2, TAG=PGI_EI, TYP=BITS, LEN=8, VAL="VBLK.EI");
      590    17645    2               DATALVL = 2;
      591    17646    2               DATATAG = 0;
      592    17647        /*****************************************************************************
      593    17648        *
      594    17649        *       Illegal VBLK.EVENT
      595    17650        *
      596    17651        *****************************************************************************/
      597    17652    2           CASE( ELSE);
      598    17653    2               CALL XSS$SCREECH( XSS_F$ENCODE);
      599    17654    2           END;
      600    17655        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:30   
      601    17656    2       IF DATALVL > 0 AND XSS$GENERIC.DATA.PTR$ ~= ADDR( NIL) THEN DO;
      602    17657    2           IF DATATAG = 0 THEN
      603    17658                    %LOAD( LVL=DATALVL, TAG=0, TYP=DATA,
      604    17659                            LEN="XSS$GENERIC.DATA.SIZE",
      605    17660                            VAL="XSS$GENERIC.DATA.PTR$->TEXT");
      606    17724    2           ELSE
      607    17725                    %LOAD( LVL=DATALVL, TAG=PGI_DATA, TYP=DATA,
      608    17726                            LEN="XSS$GENERIC.DATA.SIZE",
      609    17727                            VAL="XSS$GENERIC.DATA.PTR$->TEXT");
      610    17791    2           END;
      611    17792    2       ELSE DO;
      612    17793    2           VBLK.DAT.SIZE = 0;
      613    17794    2           VBLK.DAT.PTR$ = ADDR( NIL);
      614    17795    2           END;
      615    17796            /* if CN, release the saved copy of User Data */
      616    17797    2       IF VBLK.EVENT = %XSS_SEV_CN THEN DO;
      617    17798    2           IF SCTX.HEADX ~= %NULL THEN
      618    17799    2               CALL XSS$RELMEM( SCTX.HEADX);
      619    17800    2           SCTX.HEADX = %NULL;
      620    17801    2           END;
      621    17802            /* Now, fix up the itemlist and build the PDU */
      622    17803    1       CALL FIXITEMS;
      623    17804    1       CALL BUILDPDU;
      624    17805            /* Send the constructed PDU on to Transport */
      625    17806    1       VBLK.PDU.SIZE = PDUIDX;
      626    17807    1       VBLK.PDU.PTR$ = ADDR( PDUBUF);
      627    17808    1       CALL XSS$TSEND( VBLK)
      628    17809    2       WHENALTRETURN DO;
      629    17810    2           ALTRETURN;
      630    17811    2           END;
      631    17812    1       RETURN;
      632    17813        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:31   
      633    17814        /*F*    NAME:   LOADGT
      634    17815
      635    17816                LOADGT is called when constructing certain SPDUs to load a GT SPDU
      636    17817                into the itemlist before the other SPDU.  The Session spec requires
      637    17818                a GT or PT in front of every Category 2 SPDU sent.  This routine
      638    17819                takes the least-hassle approach that meets the spec.
      639    17820        */
      640    17821    1   LOADGT: PROC;
      641    17822
      642    17823            %LOAD( LVL=1, TAG=SI_GT, TYP=NONE);
      643    17887    3       IF VBLK.EVENT = %XSS_SEV_DT AND VBLK.EI.EOSSDU THEN DO;
      644    17888                /*N* figure out when, if ever, we want to supply the value field */
      645    17889    4           IF LOAD_GT_VALUE THEN DO;
      646    17890    4               BTMP = '000000010'B;
      647    17891                    %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS, LEN=8, VAL=BTMP);
      648    17955    4               END;
      649    17956    3           END;
      650    17957    2       RETURN;
      651    17958
      652    17959    2       END LOADGT;
      653    17960
      654    17961        /*F*    NAME:   LOADPT
      655    17962
      656    17963                LOADPT does the same as LOADGT, but with a PT SPDU.
      657    17964        */
      658    17965    1   LOADPT: PROC;
      659    17966
      660    17967            %LOAD( LVL=1, TAG=SI_PT, TYP=NONE);
      661    18031            /*N* figure out when, if ever, we want to supply the value field */
      662    18032    3       IF LOAD_PT_VALUE THEN DO;
      663    18033    3           BTMP = '000000000'B;
      664    18034                %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS, LEN=8, VAL=BTMP);
      665    18098    3           END;
      666    18099    2       RETURN;
      667    18100
      668    18101    2       END LOADPT;
      669    18102        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:32   
      670    18103        /*F*    NAME:   FIXITEMS
      671    18104                DESCRIPTION:
      672    18105                    The lengths of enclosing items in the item list are determined.
      673    18106                    If a pointer-type item points into the NULL segment, its length
      674    18107                    is set to zero.  This is done here rather than bludgeoning the
      675    18108                    already-obscure LOAD macro to do an inline check for ADDR( NIL).
      676    18109        */
      677    18110    1   FIXITEMS: PROC;
      678    18111
      679    18112    2       DCL B$UBIN8 UBIN(8) BASED UNAL;
      680    18113    2       DCL B$UBIN9 UBIN(9) BASED CALIGNED;
      681    18114    2       DCL I SBIN;
      682    18115    2       DCL J SBIN;
      683    18116    2       DCL LEN UBIN;
      684    18117    2       DCL LVL UBIN;
      685    18118    2       DCL TEMP REDEF LVL UBIN;
      686    18119
      687    18120    3       DO I = XSS_ITEMCNT - 1 DOWNTO 1;
      688    18121    4           DO CASE( ITEMLIST.X.TYP( I));
      689    18122    4               CASE( %CPTR, %CVEC, %DATA);
      690    18123    4                   IF ITEMLIST.P( I) = ADDR( NIL) THEN
      691    18124    4                       ITEMLIST.X.LEN( I) = 0;
      692    18125    4               CASE( %TXTC);
      693    18126    4                   IF ITEMLIST.P( I) = ADDR( NIL) THEN
      694    18127    4                       ITEMLIST.X.LEN( I) = 0;
      695    18128    5                   ELSE DO;
      696    18129    5                       ITEMLIST.X.LEN( I) = ITEMLIST.P( I)->B$UBIN9;
      697    18130    5                       ITEMLIST.P( I) = PINCRC( ITEMLIST.P( I), 1);
      698    18131    5                       END;
      699    18132    4               CASE( %BITS);
      700    18133                        /* convert bit-length to byte-length; unpack bit value */
      701    18134    4                   ITEMLIST.X.LEN( I) = ( ITEMLIST.X.LEN( I) + 7) / 8;
      702    18135    4                   TEMP = ITEMLIST.U( I);
      703    18136                        /* unpack bit value 8 bits at a shot into low-8-of-9 */
      704    18137    4                   ITEMLIST.U( I) = ADDR( TEMP)->B$UBIN8 * 134217728 +
      705    18138    4                           PINCRB( ADDR( TEMP), 8)->B$UBIN8 * 262144 +
      706    18139    4                           PINCRB( ADDR( TEMP), 16)->B$UBIN8 * 512 +
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:33   
      707    18140    4                           PINCRB( ADDR( TEMP), 24)->B$UBIN8;
      708    18141    4               CASE( %UBIN);
      709    18142                        /* unpack the unsigned binary value */
      710    18143    4                   TEMP = ITEMLIST.U( I);
      711    18144    4                   ITEMLIST.U( I) =
      712    18145    4                           PINCRB( ADDR( TEMP), 4)->B$UBIN8 * 134217728 +
      713    18146    4                           PINCRB( ADDR( TEMP), 12)->B$UBIN8 * 262144 +
      714    18147    4                           PINCRB( ADDR( TEMP), 20)->B$UBIN8 * 512 +
      715    18148    4                           PINCRB( ADDR( TEMP), 28)->B$UBIN8;
      716    18149    4               END;
      717    18150    3           LEN = ITEMLIST.X.LEN( I);
      718    18151                /* If TAG is nonzero then TAG and LEN will have to be encoded,
      719    18152                   and LEN is now accumulated into the length of the enclosing
      720    18153                   item.  If TAG is zero then don't even accumulate LEN. */
      721    18154    4           IF ITEMLIST.X.TAG( I) ~= 0 THEN DO;
      722    18155    4               IF LEN > 254 THEN
      723    18156    4                   LEN = LEN + 4;  /* 3 bytes to encode length plus 1 for tag */
      724    18157    4               ELSE
      725    18158    4                   LEN = LEN + 2;  /* 1 byte to encode length plus 1 for tag */
      726    18159    4               LVL = ITEMLIST.X.LVL( I) - 1;
      727    18160    4   INCRLOOP:
      728    18161    5               DO J = I - 1 DOWNTO 0;
      729    18162    6                   IF LVL = ITEMLIST.X.LVL( J) THEN DO;
      730    18163    6                       ITEMLIST.X.LEN( J) = LEN + ITEMLIST.X.LEN( J);
      731    18164    6                       EXIT INCRLOOP;
      732    18165    6                       END;
      733    18166    5                   END;
      734    18167    4               END;
      735    18168    3           END;
      736    18169
      737    18170    2       END FIXITEMS;
      738    18171        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:34   
      739    18172        /*F*    NAME:   BUILDPDU
      740    18173                DESCRIPTION:
      741    18174                    Now that the item list has been fixed up, the SPDU itself can be
      742    18175                    constructed in the AUTO buffer.  Note that for efficiency, any
      743    18176                    user data to be sent along as part of the SPDU is *not* appended
      744    18177                    to the SPDU in AUTO.. it is framed in VBLK.DAT.
      745    18178        */
      746    18179    1   BUILDPDU: PROC;
      747    18180    2       DCL BYTES CHAR( LEN) BASED;
      748    18181    2       DCL I SBIN;
      749    18182    2       DCL LEN SBIN;
      750    18183        %MACRO STORBYTE( BYT=0);
      751    18184            CALL INSERT( PDUBUF, PDUIDX, 1, BINASC( BYT));
      752    18185            PDUIDX = 1 + PDUIDX;
      753    18186        %MEND;
      754    18187
      755    18188    2       PDUIDX = 0;
      756    18189    2       XSS_ITEMCNT = XSS_ITEMCNT - 1;
      757    18190            /* construct each item of the item list in turn.  Item 0 not used. */
      758    18191    3       DO I = 1 TO XSS_ITEMCNT;
      759    18192    4           IF ITEMLIST.X.TAG( I) ~= 0 THEN DO;
      760    18193                    /* Move the SI field in */
      761    18194                    %STORBYTE( BYT="ITEMLIST.X.TAG( I)");
      762    18198                    /* Move the LI field in */
      763    18199    4               LEN = ITEMLIST.X.LEN( I);
      764    18200    5               IF LEN > 254 THEN DO;
      765    18201                        %STORBYTE( BYT="255");
      766    18205                        %STORBYTE( BYT="LEN / 256");
      767    18209                        %STORBYTE( BYT="MOD( LEN, 256)");
      768    18213    5                   END;
      769    18214    5               ELSE DO;
      770    18215                        %STORBYTE( BYT="LEN");
      771    18219    5                   END;
      772    18220    4               END;
      773    18221                /* and finally, move the value field in */
      774    18222    4           DO CASE( ITEMLIST.X.TYP( I));
      775    18223    4               CASE( %NONE);
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:35   
      776    18224                        /* Set LEN to zero so not to incr PDUIDX for enclosing item */
      777    18225    4                   LEN = 0;
      778    18226    4               CASE( %DATA);
      779    18227                        /* Set LEN to zero so not to incr PDUIDX (DATA is always last) */
      780    18228    4                   LEN = 0;
      781    18229                        /* The (one) DATA item is not copied into the SPDU buffer.
      782    18230                           For efficiency, it is just framed in VBLK now. */
      783    18231    4                   VBLK.DAT.SIZE = ITEMLIST.X.LEN( I);
      784    18232    4                   VBLK.DAT.PTR$ = ITEMLIST.P( I);
      785    18233    4               CASE( %UBIN);
      786    18234                        /* Move up to 4 bytes of RJ, unpacked binary data */
      787    18235    4                   IF LEN > 0 THEN
      788    18236    4                       CALL INSERT( PDUBUF, PDUIDX, LEN,
      789    18237    4                               PINCRC( ADDR( ITEMLIST.U( I)), 4 - LEN)->BYTES);
      790    18238    4               CASE( %BITS);
      791    18239                        /* Move up to 4 bytes of LJ, unpacked bitstring data */
      792    18240    4                   IF LEN > 0 THEN
      793    18241    4                       CALL INSERT( PDUBUF, PDUIDX, LEN, ADDR( ITEMLIST.U( I))->BYTES);
      794    18242    4               CASE( %CPTR, %CVEC, %TXTC);
      795    18243                        /* Move the byte string pointed at by ITEM.PTR$ */
      796    18244    4                   IF LEN > 0 THEN
      797    18245    4                       CALL INSERT( PDUBUF, PDUIDX, LEN, ITEMLIST.P( I)->BYTES);
      798    18246    4               CASE( %UBC6);
      799    18247                        /* Build a serial number.  Note that LEN is 6. */
      800    18248    4                   CALL BINCHAR( PINCRC( ADDR( PDUBUF), PDUIDX)->BYTES, ITEMLIST.U( I))
             18248                            ;
      801    18249    4               CASE( ELSE);
      802    18250    4               END;
      803    18251    3           PDUIDX = LEN + PDUIDX;
      804    18252    3           END;
      805    18253
      806    18254    2       END BUILDPDU;
      807    18255
      808    18256    1       END XSS$ENCODE;

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:36   
--  Include file information  --

   XSC_PERR_C.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   UM_CP6.:E05OU  is referenced.
      No diagnostics issued in procedure XSS$ENCODE.

   Procedure XSS$ENCODE requires 1619 words for executable code.
   Procedure XSS$ENCODE requires 336 words of local(AUTO) storage.

    No errors detected in file XSS$ENCODE.:XSA1TSI    .

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:37   

 Object Unit name= XSS$ENCODE                                 File name= XSS$ENCODE.:XSA1TOU
 UTS= OCT 01 '97 12:17:39.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  XSS$ENCODE
    1   Data  even  none     4      4  XSS$ENCODE
    2   Proc  even  none  1619   3123  XSS$ENCODE
    3  RoData even  none    33     41  XSS$ENCODE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  XSS$ENCODE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  XSS_F$ENCODE                       1      0  XSS_ITEMCNT
    1      1  XSS_ITEMMAX
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:38   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 XSS$BUFPTR
         yes           Std       1 XSS$SCREECH
 yes     yes           Std       1 XSS$RELMEM
 yes     yes           Std       1 XSS$TSEND
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:39   


        1        1        /*M*    XSS$ENCODE      Encode a Session PDU and send it to Transport   */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DDA */
        8        8        /*F*    NAME:   XSS$ENCODE
        9        9                DESCRIPTION:
       10       10                    This routine encodes any desired Session PDU and sends it on
       11       11                    to the Transport layer.  The VBLK.EVENT determines which SPDU
       12       12                    to construct.  The resulting SPDU is passed on to Transport with
       13       13                    a Transport function code and any associated user data supplied.
       14       14        */
       15       15        XSS$ENCODE: PROC( VBLK) ALTRET;

     15  2 000000   000000 700200 xent  XSS$ENCODE   TSX0  ! X66_AUTO_1
         2 000001   000520 000001                    ZERO    336,1

       16       16        %INCLUDE UM_CP6;
       17      868        %INCLUDE K_ADDRESS_M;
       18     1371        %INCLUDE XSS_SESSION_E;
       19     1936        %INCLUDE XSS_SESSION_M;
       20     4579            %XSS$PRIMITIVES( STCLASS="BASED( SFPT$)");
       21     7958        %INCLUDE XSS_INTERNAL_E;
       22     8256        %INCLUDE XSS_INTERNAL_M;
       23     8845            %XSS$SCTX( NAME=SCTX, STCLASS="BASED( SCTX$)");
       24     9279            %XSS$VBLK( NAME=VBLK, STCLASS="");
       25     9384        %INCLUDE XSC_COMMON_M;
       26    10037            %XSC$ADDRESS( NAME=UADR);
       27    10320        %MACRO FATALDEF( NAME=XSS_FATAL, STCLASS="CONSTANT SYMDEF", LVL=1, LAST=";",
       28    10321                         ERR#=0, SEV=7);
       29    10322            %VLP_ERRCODE( FPTN=NAME, STCLASS=STCLASS, FCG='XS', MID='S',
       30    10323                          MON='0'B, ERR#=ERR#, SEV=SEV);
       31    10324        %MEND;
       32    10325        %INCLUDE XSC_PERR_C;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:40   
       33    10402            %FATALDEF( NAME=XSS_F$ENCODE, ERR#=%F$ENCODE);
       34    10450            /*E*  ERROR:  XSS-F$ENCODE-7
       35    10451                MESSAGE:  VBLK.EVENT illegal for PDU encoder.
       36    10452            */
       37    10453        %EQU ITEMMAX = 16;
       38    10454
       39    10455    1       DCL XSS$BUFPTR ENTRY(2) ALTRET;
       40    10456    1       DCL XSS$RELMEM ENTRY(1) ALTRET;
       41    10457    1       DCL XSS$SCREECH ENTRY(1);
       42    10458    1       DCL XSS$TSEND ENTRY(1) ALTRET;
       43    10459
       44    10460    1       DCL XSS_ITEMCNT SBIN STATIC SYMDEF INIT( 0);
       45    10461    1       DCL XSS_ITEMMAX SBIN STATIC SYMDEF INIT( %ITEMMAX);
       46    10462
       47    10463            %ITEM( NAME="ITEMLIST(0:%ITEMMAX)", STCLASS=AUTO);
       48    10488    1       DCL BTMP BIT(36) ALIGNED;
       49    10489    1       DCL DATALVL SBIN;
       50    10490    1       DCL DATATAG SBIN;
       51    10491    1       DCL LOAD_GT_VALUE BIT(1) STATIC INIT( %FALSE);
       52    10492    1       DCL LOAD_PT_VALUE BIT(1) STATIC INIT( %FALSE);
       53    10493    1       DCL MAXSZ SBIN;
       54    10494    1       DCL PDUBUF CHAR( 600) AUTO;
       55    10495    1       DCL PDUIDX SBIN;
       56    10496    1       DCL REASON CHAR(513) AUTO;
       57    10497    1       DCL SCTX$ PTR;
       58    10498    1       DCL SFPT$ PTR;
       59    10499    1       DCL TEXT CHAR(16384) BASED CALIGNED;
       60    10500    1       DCL 1 TXTC BASED,
       61    10501    1            2 LEN UBIN(9) CALIGNED,
       62    10502    1            2 TXT CHAR( TXTC.LEN) CALIGNED;
       63    10503
       64    10504    1       SCTX$ = VBLK.CTX$;

  10504  2 000002   200003 470500                    LDP0    @VBLK,,AUTO
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   200502 756100                    STQ     SCTX$,,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:41   
       65    10505    1       SFPT$ = VBLK.FPT$;

  10505  2 000005   000002 236100                    LDQ     2,,PR0
         2 000006   200503 756100                    STQ     SFPT$,,AUTO

       66    10506    1       DATALVL = 0;

  10506  2 000007   200047 450100                    STZ     DATALVL,,AUTO

       67    10507    1       DATATAG = %PGI_DATA;

  10507  2 000010   000301 235007                    LDA     193,DL
         2 000011   200050 755100                    STA     DATATAG,,AUTO

       68    10508    1       XSS_ITEMCNT = 0;

  10508  2 000012   000000 450000 1                  STZ     XSS_ITEMCNT

       69    10509    1       ITEMLIST = '0'B;

  10509  2 000013   000100 100400                    MLR     fill='000'O
         2 000014   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000015   200004 000210                    ADSC9   ITEMLIST,,AUTO           cn=0,n=136

       70    10510            %LOAD( LVL=0, TYP=NONE);

  10567  2 000016   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000017   000001 735000                    ALS     1
         2 000020   200004 450105                    STZ     ITEMLIST,AL,AUTO

  10570  2 000021   000000 054000 1                  AOS     XSS_ITEMCNT

       71    10574    2       DO CASE( VBLK.EVENT);

  10574  2 000022   000001 720100                    LXL0    1,,PR0
         2 000023   000777 360003                    ANX0    511,DU
         2 000024   000052 100003                    CMPX0   42,DU
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:42   
         2 000025   000027 602010 2                  TNC     s:10574+5,X0
         2 000026   002257 710000 2                  TRA     s:17653
         2 000027   002257 710000 2                  TRA     s:17653
         2 000030   000101 710000 2                  TRA     s:10639
         2 000031   000107 710000 2                  TRA     s:10653
         2 000032   000113 710000 2                  TRA     s:10656
         2 000033   000155 710000 2                  TRA     s:10917
         2 000034   000412 710000 2                  TRA     s:11846
         2 000035   000434 710000 2                  TRA     s:11982
         2 000036   000444 710000 2                  TRA     s:12054
         2 000037   000471 710000 2                  TRA     s:12191
         2 000040   000517 710000 2                  TRA     s:12329
         2 000041   000541 710000 2                  TRA     s:12465
         2 000042   000551 710000 2                  TRA     s:12537
         2 000043   000676 710000 2                  TRA     s:13133
         2 000044   000720 710000 2                  TRA     s:13271
         2 000045   000732 710000 2                  TRA     s:13343
         2 000046   000744 710000 2                  TRA     s:13473
         2 000047   001247 710000 2                  TRA     s:14407
         2 000050   001257 710000 2                  TRA     s:14422
         2 000051   001320 710000 2                  TRA     s:14565
         2 000052   001344 710000 2                  TRA     s:14703
         2 000053   001367 710000 2                  TRA     s:14898
         2 000054   001400 710000 2                  TRA     s:14915
         2 000055   001404 710000 2                  TRA     s:14918
         2 000056   001430 710000 2                  TRA     s:15113
         2 000057   001452 710000 2                  TRA     s:15249
         2 000060   001460 710000 2                  TRA     s:15319
         2 000061   001466 710000 2                  TRA     s:15333
         2 000062   001514 710000 2                  TRA     s:15470
         2 000063   001552 710000 2                  TRA     s:15673
         2 000064   001612 710000 2                  TRA     s:15877
         2 000065   001651 710000 2                  TRA     s:16138
         2 000066   001661 710000 2                  TRA     s:16155
         2 000067   001667 710000 2                  TRA     s:16158
         2 000070   001675 710000 2                  TRA     s:16161
         2 000071   001721 710000 2                  TRA     s:16355
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:43   
         2 000072   001745 710000 2                  TRA     s:16436
         2 000073   002003 710000 2                  TRA     s:16641
         2 000074   002007 710000 2                  TRA     s:16644
         2 000075   002150 710000 2                  TRA     s:17243
         2 000076   002150 710000 2                  TRA     s:17243
         2 000077   002150 710000 2                  TRA     s:17243
         2 000100   002221 710000 2                  TRA     s:17569

       72    10575        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:44   
       73    10576        /*****************************************************************************
       74    10577        *
       75    10578        *       AA              ABORT ACCEPT SPDU
       76    10579        *
       77    10580        *****************************************************************************/
       78    10581    2           CASE( %XSS_SEV_AA);

       79    10582                    %LOAD( LVL=1, TAG=SI_AA, TYP=NONE);

  10639  2 000101   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000102   000001 735000                    ALS     1
         2 000103   032001 236007                    LDQ     13313,DL
         2 000104   200004 756105                    STQ     ITEMLIST,AL,AUTO

  10642  2 000105   000000 054000 1                  AOS     XSS_ITEMCNT

  10644  2 000106   002263 710000 2                  TRA     s:17656

       80    10646        /*****************************************************************************
       81    10647        *
       82    10648        *       AB_NR           ABORT (NO REUSE) SPDU
       83    10649        *       AB_R            ABORT (REUSE) SPDU
       84    10650        *
       85    10651        *****************************************************************************/
       86    10652    2           CASE( %XSS_SEV_AB_NR);

       87    10653    2               SCTX.TD.TCREL = %TRUE;

  10653  2 000107   200502 471500                    LDP1    SCTX$,,AUTO
         2 000110   002000 236007                    LDQ     1024,DL
         2 000111   100015 256100                    ORSQ    13,,PR1

       88    10654    2               GOTO AB_COMMON;

  10654  2 000112   000116 710000 2                  TRA     AB_COMMON

       89    10655    2           CASE( %XSS_SEV_AB_R);
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:45   

       90    10656    2               SCTX.TD.TCREL = %FALSE;

  10656  2 000113   200502 471500                    LDP1    SCTX$,,AUTO
         2 000114   000001 236000 3                  LDQ     1
         2 000115   100015 356100                    ANSQ    13,,PR1

       91    10657    2   AB_COMMON:
       92    10658                    %LOAD( LVL=1, TAG=SI_AB, TYP=NONE);

  10683  2 000116                       AB_COMMON    null
  10715  2 000116   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000117   000001 735000                    ALS     1
         2 000120   031001 236007                    LDQ     12801,DL
         2 000121   200004 756105                    STQ     ITEMLIST,AL,AUTO

  10718  2 000122   000000 054000 1                  AOS     XSS_ITEMCNT

       93    10722                    %LOAD( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL="SCTX.TD");

  10775  2 000123   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000124   000001 735000                    ALS     1
         2 000125   100015 236100                    LDQ     13,,PR1
         2 000126   000022 736000                    QLS     18
         2 000127   777000 376003                    ANQ     -512,DU
         2 000130   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  10779  2 000131   000002 236000 3                  LDQ     2
         2 000132   200004 756105                    STQ     ITEMLIST,AL,AUTO

  10782  2 000133   000000 054000 1                  AOS     XSS_ITEMCNT

       94    10786    2               IF SCTX.TD.PRTER THEN

  10786  2 000134   100015 236100                    LDQ     13,,PR1
         2 000135   010000 316007                    CANQ    4096,DL
         2 000136   000147 600000 2                  TZE     s:10851
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:46   

       95    10787                        %LOAD( LVL=2, TAG=PGI_RPV, TYP=CPTR, LEN=9, VAL="SCTX.RPV");

  10835  2 000137   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000140   000001 735000                    ALS     1
         2 000141   200502 236100                    LDQ     SCTX$,,AUTO
         2 000142   400000 036007                    ADLQ    -131072,DL
         2 000143   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  10844  2 000144   000003 236000 3                  LDQ     3
         2 000145   200004 756105                    STQ     ITEMLIST,AL,AUTO

  10847  2 000146   000000 054000 1                  AOS     XSS_ITEMCNT

       96    10851    2               IF SCTX.TD.USRAB THEN

  10851  2 000147   100015 236100                    LDQ     13,,PR1
         2 000150   004000 316007                    CANQ    2048,DL
         2 000151   002263 600000 2                  TZE     s:17656

       97    10852    2                   DATALVL = 2;

  10852  2 000152   000002 235007                    LDA     2,DL
         2 000153   200047 755100                    STA     DATALVL,,AUTO
         2 000154   002263 710000 2                  TRA     s:17656

       98    10853        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:47   
       99    10854        /*****************************************************************************
      100    10855        *
      101    10856        *       AC              ACCEPT SPDU
      102    10857        *
      103    10858        *****************************************************************************/
      104    10859    2           CASE( %XSS_SEV_AC);

      105    10860                    %LOAD( LVL=1, TAG=SI_AC, TYP=NONE);

  10917  2 000155   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000156   000001 735000                    ALS     1
         2 000157   016001 236007                    LDQ     7169,DL
         2 000160   200004 756105                    STQ     ITEMLIST,AL,AUTO

  10920  2 000161   000000 054000 1                  AOS     XSS_ITEMCNT

      106    10924                    %LOAD( LVL=2, TAG=PGI_CI, TYP=NONE);

  10981  2 000162   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000163   000001 735000                    ALS     1
         2 000164   001002 236007                    LDQ     514,DL
         2 000165   200004 756105                    STQ     ITEMLIST,AL,AUTO

  10984  2 000166   000000 054000 1                  AOS     XSS_ITEMCNT

      107    10988                    %LOAD( LVL=3, TAG=PI_ASSUR, TYP=TXTC,
      108    10989                            VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");

  11037  2 000167   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000170   000001 735000                    ALS     1
         2 000171   200503 471500                    LDP1    SFPT$,,AUTO
         2 000172   100007 473500                    LDP3    7,,PR1
         2 000173   200005 453505                    STP3    ITEMLIST+1,AL,AUTO

  11046  2 000174   011073 236007                    LDQ     4667,DL
         2 000175   200004 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:48   
  11049  2 000176   000000 054000 1                  AOS     XSS_ITEMCNT

      109    11053    2               IF XSS$CONNECT.COMMON$->TXTC.LEN ~= 0 THEN

  11053  2 000177   100005 473500                    LDP3    5,,PR1
         2 000200   000100 101500                    MRL     fill='000'O
         2 000201   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         2 000202   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 000203   200512 236100                    LDQ     LVL+2,,AUTO
         2 000204   000000 116003                    CMPQ    0,DU
         2 000205   000215 600000 2                  TZE     s:11119

      110    11054                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      111    11055                                VAL="XSS$CONNECT.COMMON$->TXTC");

  11103  2 000206   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000207   000001 735000                    ALS     1
         2 000210   100005 473500                    LDP3    5,,PR1
         2 000211   200005 453505                    STP3    ITEMLIST+1,AL,AUTO

  11112  2 000212   013073 236007                    LDQ     5691,DL
         2 000213   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11115  2 000214   000000 054000 1                  AOS     XSS_ITEMCNT

      112    11119    2               IF XSS$CONNECT.ARI ~= %XSS_ARI_NONE# THEN

  11119  2 000215   100012 235100                    LDA     10,,PR1
         2 000216   000004 115000 3                  CMPA    4
         2 000217   000226 600000 2                  TZE     s:11241

      113    11120                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN, LEN=4, VAL="XSS$CONNECT.ARI");

  11165  2 000220   000000 236000 1                  LDQ     XSS_ITEMCNT
         2 000221   000001 736000                    QLS     1
         2 000222   200005 755106                    STA     ITEMLIST+1,QL,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:49   
  11177  2 000223   000005 235000 3                  LDA     5
         2 000224   200004 755106                    STA     ITEMLIST,QL,AUTO

  11180  2 000225   000000 054000 1                  AOS     XSS_ITEMCNT

      114    11184                    %LOAD( LVL=2, TAG=PGI_CAI, TYP=NONE);

  11241  2 000226   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000227   000001 735000                    ALS     1
         2 000230   005002 236007                    LDQ     2562,DL
         2 000231   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11244  2 000232   000000 054000 1                  AOS     XSS_ITEMCNT

      115    11248                    %LOAD( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL="SCTX.PO");

  11293  2 000233   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000234   000001 735000                    ALS     1
         2 000235   200502 473500                    LDP3    SCTX$,,AUTO
         2 000236   300013 236100                    LDQ     11,,PR3
         2 000237   000033 772000                    QRL     27
         2 000240   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11305  2 000241   000006 236000 3                  LDQ     6
         2 000242   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11308  2 000243   000000 054000 1                  AOS     XSS_ITEMCNT

      116    11312    2               IF SCTX.TSDUMS.INI ~= 0 OR SCTX.TSDUMS.RSP ~= 0 THEN

  11312  2 000244   300014 220100                    LDX0    12,,PR3
         2 000245   000250 601000 2                  TNZ     s:11359
         2 000246   300014 721100                    LXL1    12,,PR3
         2 000247   000265 600000 2                  TZE     s:11423

      117    11313                        %LOAD( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, LEN=4,
      118    11314                                VAL="SCTX.TSDUMS.INI*65536+SCTX.TSDUMS.RSP");
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:50   

  11359  2 000250   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000251   000001 735000                    ALS     1
         2 000252   300014 236100                    LDQ     12,,PR3
         2 000253   777777 376007                    ANQ     -1,DL
         2 000254   200512 756100                    STQ     LVL+2,,AUTO
         2 000255   300014 236100                    LDQ     12,,PR3
         2 000256   000002 772000                    QRL     2
         2 000257   000007 376000 3                  ANQ     7
         2 000260   200512 036100                    ADLQ    LVL+2,,AUTO
         2 000261   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11371  2 000262   000010 236000 3                  LDQ     8
         2 000263   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11374  2 000264   000000 054000 1                  AOS     XSS_ITEMCNT

      119    11378                    %LOAD( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL="SCTX.VN");

  11423  2 000265   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000266   000001 735000                    ALS     1
         2 000267   300013 236100                    LDQ     11,,PR3
         2 000270   000026 772000                    QRL     22
         2 000271   000017 376007                    ANQ     15,DL
         2 000272   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11435  2 000273   000011 236000 3                  LDQ     9
         2 000274   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11438  2 000275   000000 054000 1                  AOS     XSS_ITEMCNT

      120    11442    2               IF NOT XSS$CONNECT.SFU.ACT AND

  11442  2 000276   100010 236100                    LDQ     8,,PR1
         2 000277   000400 316007                    CANQ    256,DL
         2 000300   000321 601000 2                  TNZ     s:11510
         2 000301   000200 316007                    CANQ    128,DL
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:51   
         2 000302   000307 601000 2                  TNZ     s:11491
         2 000303   000100 316007                    CANQ    64,DL
         2 000304   000307 601000 2                  TNZ     s:11491
         2 000305   000040 316007                    CANQ    32,DL
         2 000306   000321 600000 2                  TZE     s:11510

      121    11443    2                       ( XSS$CONNECT.SFU.RESYN OR XSS$CONNECT.SFU.MA OR
      122    11444    2                       XSS$CONNECT.SFU.SY) THEN
      123    11445                        %LOAD( LVL=3, TAG=PI_ISN, TYP=UBC6,
      124    11446                                LEN=6, VAL="XSS$CONNECT.SERNUM");

  11491  2 000307   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000310   000001 735000                    ALS     1
         2 000311   000000 620005                    EAX0    0,AL
         2 000312   100004 235100                    LDA     4,,PR1
         2 000313   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  11503  2 000314   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000315   000001 735000                    ALS     1
         2 000316   000012 236000 3                  LDQ     10
         2 000317   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11506  2 000320   000000 054000 1                  AOS     XSS_ITEMCNT

      125    11510    2               IF XSS$CONNECT.ITOKENS ~= '111111110'B THEN

  11510  2 000321   100010 236100                    LDQ     8,,PR1
         2 000322   777000 376003                    ANQ     -512,DU
         2 000323   776000 116003                    CMPQ    -1024,DU
         2 000324   000335 600000 2                  TZE     s:11630

      126    11511                        %LOAD( LVL=3, TAG=PI_TSI, TYP=BITS,
      127    11512                                LEN=8, VAL="XSS$CONNECT.ITOKENS");

  11565  2 000325   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000326   000001 735000                    ALS     1
         2 000327   100010 236100                    LDQ     8,,PR1
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:52   
         2 000330   777000 376003                    ANQ     -512,DU
         2 000331   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11569  2 000332   000013 236000 3                  LDQ     11
         2 000333   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11572  2 000334   000000 054000 1                  AOS     XSS_ITEMCNT

      128    11576                    %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS,
      129    11577                            LEN=8, VAL="XSS$CONNECT.TOKENS");

  11630  2 000335   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000336   000001 735000                    ALS     1
         2 000337   100000 236100                    LDQ     0,,PR1
         2 000340   000033 736000                    QLS     27
         2 000341   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11634  2 000342   000014 236000 3                  LDQ     12
         2 000343   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11637  2 000344   000000 054000 1                  AOS     XSS_ITEMCNT

      130    11641                    %LOAD( LVL=2, TAG=PGI_SUR, TYP=BITS,
      131    11642                            LEN=16, VAL="XSS$CONNECT.SFU");

  11695  2 000345   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000346   000001 735000                    ALS     1
         2 000347   100010 236100                    LDQ     8,,PR1
         2 000350   000022 736000                    QLS     18
         2 000351   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11699  2 000352   000015 236000 3                  LDQ     13
         2 000353   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11702  2 000354   000000 054000 1                  AOS     XSS_ITEMCNT

      132    11706    2               IF XSS$CONNECT.CALLING$->UADR.SSAP.LEN ~= 0 THEN
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:53   

  11706  2 000355   100006 474500                    LDP4    6,,PR1
         2 000356   400070 236100                    LDQ     56,,PR4
         2 000357   000777 316003                    CANQ    511,DU
         2 000360   000372 600000 2                  TZE     s:11772

      133    11707                        %LOAD( LVL=2, TAG=PGI_ISSEL, TYP=TXTC,
      134    11708                                VAL="XSS$CONNECT.CALLING$->UADR.SSAP");

  11756  2 000361   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000362   000001 735000                    ALS     1
         2 000363   200512 454500                    STP4    LVL+2,,AUTO
         2 000364   200512 236100                    LDQ     LVL+2,,AUTO
         2 000365   000016 036000 3                  ADLQ    14
         2 000366   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11765  2 000367   063072 236007                    LDQ     26170,DL
         2 000370   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11768  2 000371   000000 054000 1                  AOS     XSS_ITEMCNT

      135    11772    2               IF XSS$CONNECT.RESPONDING$->UADR.SSAP.LEN ~= 0 THEN

  11772  2 000372   100007 474500                    LDP4    7,,PR1
         2 000373   400070 236100                    LDQ     56,,PR4
         2 000374   000777 316003                    CANQ    511,DU
         2 000375   000407 600000 2                  TZE     s:11838

      136    11773                        %LOAD( LVL=2, TAG=PGI_ASSEL, TYP=TXTC,
      137    11774                                VAL="XSS$CONNECT.RESPONDING$->UADR.SSAP");

  11822  2 000376   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000377   000001 735000                    ALS     1
         2 000400   200512 454500                    STP4    LVL+2,,AUTO
         2 000401   200512 236100                    LDQ     LVL+2,,AUTO
         2 000402   000016 036000 3                  ADLQ    14
         2 000403   200005 756105                    STQ     ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:54   

  11831  2 000404   064072 236007                    LDQ     26682,DL
         2 000405   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11834  2 000406   000000 054000 1                  AOS     XSS_ITEMCNT

      138    11838    2               DATALVL = 2;

  11838  2 000407   000002 235007                    LDA     2,DL
         2 000410   200047 755100                    STA     DATALVL,,AUTO
         2 000411   002263 710000 2                  TRA     s:17656

      139    11839        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:55   
      140    11840        /*****************************************************************************
      141    11841        *
      142    11842        *       AD              ACTIVITY DISCARD SPDU
      143    11843        *
      144    11844        *****************************************************************************/
      145    11845    2           CASE( %XSS_SEV_AD);

      146    11846    2               CALL LOADGT;

  11846  2 000412   002370 701000 2                  TSX1    LOADGT
         2 000413   000000 011000                    NOP     0

      147    11847                    %LOAD( LVL=1, TAG=SI_AD, TYP=NONE);

  11904  2 000414   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000415   000001 735000                    ALS     1
         2 000416   071001 236007                    LDQ     29185,DL
         2 000417   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11907  2 000420   000000 054000 1                  AOS     XSS_ITEMCNT

      148    11911                    %LOAD( LVL=2, TAG=PGI_RC, TYP=UBIN,
      149    11912                            LEN=1, VAL="XSS$ACTIVITY_DISCARD.REASON");

  11957  2 000421   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000422   000001 735000                    ALS     1
         2 000423   200503 470500                    LDP0    SFPT$,,AUTO
         2 000424   000000 236100                    LDQ     0,,PR0
         2 000425   000011 772000                    QRL     9
         2 000426   000777 376007                    ANQ     511,DL
         2 000427   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  11969  2 000430   000017 236000 3                  LDQ     15
         2 000431   200004 756105                    STQ     ITEMLIST,AL,AUTO

  11972  2 000432   000000 054000 1                  AOS     XSS_ITEMCNT

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:56   
  11974  2 000433   002263 710000 2                  TRA     s:17656

      150    11976        /*****************************************************************************
      151    11977        *
      152    11978        *       ADA             ACTIVITY DISCARD ACK SPDU
      153    11979        *
      154    11980        *****************************************************************************/
      155    11981    2           CASE( %XSS_SEV_ADA);

      156    11982    2               CALL LOADPT;

  11982  2 000434   002422 701000 2                  TSX1    LOADPT
         2 000435   000000 011000                    NOP     0

      157    11983                    %LOAD( LVL=1, TAG=SI_ADA, TYP=NONE);

  12040  2 000436   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000437   000001 735000                    ALS     1
         2 000440   072001 236007                    LDQ     29697,DL
         2 000441   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12043  2 000442   000000 054000 1                  AOS     XSS_ITEMCNT

  12045  2 000443   002263 710000 2                  TRA     s:17656

      158    12047        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:57   
      159    12048        /*****************************************************************************
      160    12049        *
      161    12050        *       AE              ACTIVITY END SPDU
      162    12051        *
      163    12052        *****************************************************************************/
      164    12053    2           CASE( %XSS_SEV_AE);

      165    12054    2               CALL LOADGT;

  12054  2 000444   002370 701000 2                  TSX1    LOADGT
         2 000445   000000 011000                    NOP     0

      166    12055                    %LOAD( LVL=1, TAG=SI_AE, TYP=NONE);

  12112  2 000446   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000447   000001 735000                    ALS     1
         2 000450   051001 236007                    LDQ     20993,DL
         2 000451   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12115  2 000452   000000 054000 1                  AOS     XSS_ITEMCNT

      167    12119                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      168    12120                            LEN=6, VAL="XSS$ACTIVITY_END.SERNUM");

  12165  2 000453   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000454   000001 735000                    ALS     1
         2 000455   200503 470500                    LDP0    SFPT$,,AUTO
         2 000456   000000 620005                    EAX0    0,AL
         2 000457   000004 235100                    LDA     4,,PR0
         2 000460   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  12177  2 000461   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000462   000001 735000                    ALS     1
         2 000463   000020 236000 3                  LDQ     16
         2 000464   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12180  2 000465   000000 054000 1                  AOS     XSS_ITEMCNT
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:58   

      169    12184    2               DATALVL = 2;

  12184  2 000466   000002 235007                    LDA     2,DL
         2 000467   200047 755100                    STA     DATALVL,,AUTO
         2 000470   002263 710000 2                  TRA     s:17656

      170    12185        /*****************************************************************************
      171    12186        *
      172    12187        *       AEA             ACTIVITY END ACK SPDU
      173    12188        *
      174    12189        *****************************************************************************/
      175    12190    2           CASE( %XSS_SEV_AEA);

      176    12191    2               CALL LOADPT;

  12191  2 000471   002422 701000 2                  TSX1    LOADPT
         2 000472   000000 011000                    NOP     0

      177    12192                    %LOAD( LVL=1, TAG=SI_AEA, TYP=NONE);

  12249  2 000473   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000474   000001 735000                    ALS     1
         2 000475   052001 236007                    LDQ     21505,DL
         2 000476   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12252  2 000477   000000 054000 1                  AOS     XSS_ITEMCNT

      178    12256                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      179    12257                            LEN=6, VAL="SCTX.VM-1");

  12302  2 000500   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000501   000001 735000                    ALS     1
         2 000502   200502 470500                    LDP0    SCTX$,,AUTO
         2 000503   000000 620005                    EAX0    0,AL
         2 000504   000011 235100                    LDA     9,,PR0
         2 000505   000001 135007                    SBLA    1,DL
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:59   
         2 000506   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  12314  2 000507   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000510   000001 735000                    ALS     1
         2 000511   000020 236000 3                  LDQ     16
         2 000512   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12317  2 000513   000000 054000 1                  AOS     XSS_ITEMCNT

      180    12321    2               DATALVL = 2;

  12321  2 000514   000002 235007                    LDA     2,DL
         2 000515   200047 755100                    STA     DATALVL,,AUTO
         2 000516   002263 710000 2                  TRA     s:17656

      181    12322        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:60   
      182    12323        /*****************************************************************************
      183    12324        *
      184    12325        *       AI              ACTIVITY INTERRUPT SPDU
      185    12326        *
      186    12327        *****************************************************************************/
      187    12328    2           CASE( %XSS_SEV_AI);

      188    12329    2               CALL LOADGT;

  12329  2 000517   002370 701000 2                  TSX1    LOADGT
         2 000520   000000 011000                    NOP     0

      189    12330                    %LOAD( LVL=1, TAG=SI_AI, TYP=NONE);

  12387  2 000521   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000522   000001 735000                    ALS     1
         2 000523   031001 236007                    LDQ     12801,DL
         2 000524   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12390  2 000525   000000 054000 1                  AOS     XSS_ITEMCNT

      190    12394                    %LOAD( LVL=2, TAG=PGI_RC, TYP=UBIN,
      191    12395                            LEN=1, VAL="XSS$ACTIVITY_INTERRUPT.REASON");

  12440  2 000526   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000527   000001 735000                    ALS     1
         2 000530   200503 470500                    LDP0    SFPT$,,AUTO
         2 000531   000000 236100                    LDQ     0,,PR0
         2 000532   000011 772000                    QRL     9
         2 000533   000777 376007                    ANQ     511,DL
         2 000534   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  12452  2 000535   000017 236000 3                  LDQ     15
         2 000536   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12455  2 000537   000000 054000 1                  AOS     XSS_ITEMCNT

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:61   
  12457  2 000540   002263 710000 2                  TRA     s:17656

      192    12459        /*****************************************************************************
      193    12460        *
      194    12461        *       AIA             ACTIVITY INTERRUPT ACK SPDU
      195    12462        *
      196    12463        *****************************************************************************/
      197    12464    2           CASE( %XSS_SEV_AIA);

      198    12465    2               CALL LOADPT;

  12465  2 000541   002422 701000 2                  TSX1    LOADPT
         2 000542   000000 011000                    NOP     0

      199    12466                    %LOAD( LVL=1, TAG=SI_AIA, TYP=NONE);

  12523  2 000543   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000544   000001 735000                    ALS     1
         2 000545   032001 236007                    LDQ     13313,DL
         2 000546   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12526  2 000547   000000 054000 1                  AOS     XSS_ITEMCNT

  12528  2 000550   002263 710000 2                  TRA     s:17656

      200    12530        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:62   
      201    12531        /*****************************************************************************
      202    12532        *
      203    12533        *       AR              ACTIVITY RESUME SPDU
      204    12534        *
      205    12535        *****************************************************************************/
      206    12536    2           CASE( %XSS_SEV_AR);

      207    12537    2               CALL LOADGT;

  12537  2 000551   002370 701000 2                  TSX1    LOADGT
         2 000552   000000 011000                    NOP     0

      208    12538                    %LOAD( LVL=1, TAG=SI_AR, TYP=NONE);

  12595  2 000553   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000554   000001 735000                    ALS     1
         2 000555   035001 236007                    LDQ     14849,DL
         2 000556   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12598  2 000557   000000 054000 1                  AOS     XSS_ITEMCNT

      209    12602                    %LOAD( LVL=2, TAG=PGI_LI, TYP=NONE);

  12659  2 000560   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000561   000001 735000                    ALS     1
         2 000562   041002 236007                    LDQ     16898,DL
         2 000563   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12662  2 000564   000000 054000 1                  AOS     XSS_ITEMCNT

      210    12666    2               IF XSS$ACTIVITY_RESUME.CALLED$->UADR.PSAP.LEN ~= 0 THEN

  12666  2 000565   200503 470500                    LDP0    SFPT$,,AUTO
         2 000566   000007 471500                    LDP1    7,,PR0
         2 000567   100000 236100                    LDQ     0,,PR1
         2 000570   777000 316003                    CANQ    -512,DU
         2 000571   000600 600000 2                  TZE     s:12732
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:63   

      211    12667                        %LOAD( LVL=3, TAG=PI_ASSEL, TYP=TXTC,
      212    12668                                VAL="XSS$ACTIVITY_RESUME.CALLED$->UADR.PSAP");

  12716  2 000572   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000573   000001 735000                    ALS     1
         2 000574   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  12725  2 000575   064073 236007                    LDQ     26683,DL
         2 000576   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12728  2 000577   000000 054000 1                  AOS     XSS_ITEMCNT

      213    12732    2               IF XSS$ACTIVITY_RESUME.CALLING$->UADR.PSAP.LEN ~= 0 THEN

  12732  2 000600   000006 471500                    LDP1    6,,PR0
         2 000601   100000 236100                    LDQ     0,,PR1
         2 000602   777000 316003                    CANQ    -512,DU
         2 000603   000612 600000 2                  TZE     s:12798

      214    12733                        %LOAD( LVL=3, TAG=PI_ISSEL, TYP=TXTC,
      215    12734                                VAL="XSS$ACTIVITY_RESUME.CALLING$->UADR.PSAP");

  12782  2 000604   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000605   000001 735000                    ALS     1
         2 000606   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  12791  2 000607   063073 236007                    LDQ     26171,DL
         2 000610   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12794  2 000611   000000 054000 1                  AOS     XSS_ITEMCNT

      216    12798    2               IF XSS$ACTIVITY_RESUME.COMMON$->TXTC.LEN ~= 0 THEN

  12798  2 000612   000005 471500                    LDP1    5,,PR0
         2 000613   000100 101500                    MRL     fill='000'O
         2 000614   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:64   
         2 000615   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 000616   200512 236100                    LDQ     LVL+2,,AUTO
         2 000617   000000 116003                    CMPQ    0,DU
         2 000620   000630 600000 2                  TZE     s:12864

      217    12799                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      218    12800                                VAL="XSS$ACTIVITY_RESUME.COMMON$->TXTC");

  12848  2 000621   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000622   000001 735000                    ALS     1
         2 000623   000005 471500                    LDP1    5,,PR0
         2 000624   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  12857  2 000625   013073 236007                    LDQ     5691,DL
         2 000626   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12860  2 000627   000000 054000 1                  AOS     XSS_ITEMCNT

      219    12864    2               IF XSS$ACTIVITY_RESUME.ARI ~= %XSS_ARI_NONE# THEN

  12864  2 000630   000014 235100                    LDA     12,,PR0
         2 000631   000004 115000 3                  CMPA    4
         2 000632   000641 600000 2                  TZE     s:12979

      220    12865                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN,
      221    12866                                LEN=4, VAL="XSS$ACTIVITY_RESUME.ARI");

  12911  2 000633   000000 236000 1                  LDQ     XSS_ITEMCNT
         2 000634   000001 736000                    QLS     1
         2 000635   200005 755106                    STA     ITEMLIST+1,QL,AUTO

  12923  2 000636   000005 235000 3                  LDA     5
         2 000637   200004 755106                    STA     ITEMLIST,QL,AUTO

  12926  2 000640   000000 054000 1                  AOS     XSS_ITEMCNT

      222    12930                    %LOAD( LVL=3, TAG=PI_AI, TYP=TXTC,
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:65   
      223    12931                            VAL="XSS$ACTIVITY_RESUME.OACTID");

  12979  2 000641   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000642   000001 735000                    ALS     1
         2 000643   200503 236100                    LDQ     SFPT$,,AUTO
         2 000644   000012 036003                    ADLQ    10,DU
         2 000645   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  12988  2 000646   051073 236007                    LDQ     21051,DL
         2 000647   200004 756105                    STQ     ITEMLIST,AL,AUTO

  12991  2 000650   000000 054000 1                  AOS     XSS_ITEMCNT

      224    12995                    %LOAD( LVL=3, TAG=PI_SN, TYP=UBC6,
      225    12996                            LEN=6, VAL="XSS$ACTIVITY_RESUME.SERNUM");

  13041  2 000651   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000652   000001 735000                    ALS     1
         2 000653   000000 620005                    EAX0    0,AL
         2 000654   000004 235100                    LDA     4,,PR0
         2 000655   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  13053  2 000656   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000657   000001 735000                    ALS     1
         2 000660   000021 236000 3                  LDQ     17
         2 000661   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13056  2 000662   000000 054000 1                  AOS     XSS_ITEMCNT

      226    13060                    %LOAD( LVL=2, TAG=PGI_AI, TYP=TXTC,
      227    13061                            VAL="XSS$ACTIVITY_RESUME.ACTID");

  13109  2 000663   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000664   000001 735000                    ALS     1
         2 000665   200503 236100                    LDQ     SFPT$,,AUTO
         2 000666   000010 036003                    ADLQ    8,DU
         2 000667   200005 756105                    STQ     ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:66   

  13118  2 000670   051072 236007                    LDQ     21050,DL
         2 000671   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13121  2 000672   000000 054000 1                  AOS     XSS_ITEMCNT

      228    13125    2               DATALVL = 2;

  13125  2 000673   000002 235007                    LDA     2,DL
         2 000674   200047 755100                    STA     DATALVL,,AUTO
         2 000675   002263 710000 2                  TRA     s:17656

      229    13126        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:67   
      230    13127        /*****************************************************************************
      231    13128        *
      232    13129        *       AS              ACTIVITY START SPDU
      233    13130        *
      234    13131        *****************************************************************************/
      235    13132    2           CASE( %XSS_SEV_AS);

      236    13133    2               CALL LOADGT;

  13133  2 000676   002370 701000 2                  TSX1    LOADGT
         2 000677   000000 011000                    NOP     0

      237    13134                    %LOAD( LVL=1, TAG=SI_AS, TYP=NONE);

  13191  2 000700   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000701   000001 735000                    ALS     1
         2 000702   055001 236007                    LDQ     23041,DL
         2 000703   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13194  2 000704   000000 054000 1                  AOS     XSS_ITEMCNT

      238    13198                    %LOAD( LVL=2, TAG=PGI_AI, TYP=TXTC,
      239    13199                            VAL="XSS$ACTIVITY_START.ACTID");

  13247  2 000705   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000706   000001 735000                    ALS     1
         2 000707   200503 236100                    LDQ     SFPT$,,AUTO
         2 000710   000004 036003                    ADLQ    4,DU
         2 000711   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  13256  2 000712   051072 236007                    LDQ     21050,DL
         2 000713   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13259  2 000714   000000 054000 1                  AOS     XSS_ITEMCNT

      240    13263    2               DATALVL = 2;

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:68   
  13263  2 000715   000002 235007                    LDA     2,DL
         2 000716   200047 755100                    STA     DATALVL,,AUTO
         2 000717   002263 710000 2                  TRA     s:17656

      241    13264        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:69   
      242    13265        /*****************************************************************************
      243    13266        *
      244    13267        *       CD              CAPABILITY DATA SPDU
      245    13268        *
      246    13269        *****************************************************************************/
      247    13270    2           CASE( %XSS_SEV_CD);

      248    13271    2               CALL LOADGT;

  13271  2 000720   002370 701000 2                  TSX1    LOADGT
         2 000721   000000 011000                    NOP     0

      249    13272                    %LOAD( LVL=1, TAG=SI_CD, TYP=NONE);

  13329  2 000722   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000723   000001 735000                    ALS     1
         2 000724   075001 236007                    LDQ     31233,DL
         2 000725   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13332  2 000726   000000 054000 1                  AOS     XSS_ITEMCNT

      250    13336    2               DATALVL = 2;

  13336  2 000727   000002 235007                    LDA     2,DL
         2 000730   200047 755100                    STA     DATALVL,,AUTO
         2 000731   002263 710000 2                  TRA     s:17656

      251    13337        /*****************************************************************************
      252    13338        *
      253    13339        *       CDA             CAPABILITY DATA ACK SPDU
      254    13340        *
      255    13341        *****************************************************************************/
      256    13342    2           CASE( %XSS_SEV_CDA);

      257    13343    2               CALL LOADPT;

  13343  2 000732   002422 701000 2                  TSX1    LOADPT
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:70   
         2 000733   000000 011000                    NOP     0

      258    13344                    %LOAD( LVL=1, TAG=SI_CDA, TYP=NONE);

  13401  2 000734   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000735   000001 735000                    ALS     1
         2 000736   076001 236007                    LDQ     31745,DL
         2 000737   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13404  2 000740   000000 054000 1                  AOS     XSS_ITEMCNT

      259    13408    2               DATALVL = 2;

  13408  2 000741   000002 235007                    LDA     2,DL
         2 000742   200047 755100                    STA     DATALVL,,AUTO
         2 000743   002263 710000 2                  TRA     s:17656

      260    13409        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:71   
      261    13410        /*****************************************************************************
      262    13411        *
      263    13412        *       CN              CONNECT SPDU
      264    13413        *
      265    13414        *****************************************************************************/
      266    13415    2           CASE( %XSS_SEV_CN);

      267    13416                    %LOAD( LVL=1, TAG=SI_CN, TYP=NONE);

  13473  2 000744   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000745   000001 735000                    ALS     1
         2 000746   015001 236007                    LDQ     6657,DL
         2 000747   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13476  2 000750   000000 054000 1                  AOS     XSS_ITEMCNT

      268    13480                    %LOAD( LVL=2, TAG=PGI_CI, TYP=NONE);

  13537  2 000751   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000752   000001 735000                    ALS     1
         2 000753   001002 236007                    LDQ     514,DL
         2 000754   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13540  2 000755   000000 054000 1                  AOS     XSS_ITEMCNT

      269    13544                    %LOAD( LVL=3, TAG=PI_ISSUR, TYP=TXTC,
      270    13545                            VAL="XSS$CONNECT.CALLING$->UADR.PSAP");

  13593  2 000756   000000 235000 1                  LDA     XSS_ITEMCNT
         2 000757   000001 735000                    ALS     1
         2 000760   200503 471500                    LDP1    SFPT$,,AUTO
         2 000761   100006 473500                    LDP3    6,,PR1
         2 000762   200005 453505                    STP3    ITEMLIST+1,AL,AUTO

  13602  2 000763   012073 236007                    LDQ     5179,DL
         2 000764   200004 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:72   
  13605  2 000765   000000 054000 1                  AOS     XSS_ITEMCNT

      271    13609    2               CALL XSS$BUFPTR( SCTX.COMX, XSS$CONNECT.COMMON$);

  13609  2 000766   200503 236100                    LDQ     SFPT$,,AUTO
         2 000767   000005 036003                    ADLQ    5,DU
         2 000770   200513 756100                    STQ     LVL+3,,AUTO
         2 000771   200502 236100                    LDQ     SCTX$,,AUTO
         2 000772   000004 036003                    ADLQ    4,DU
         2 000773   200512 756100                    STQ     LVL+2,,AUTO
         2 000774   200512 630500                    EPPR0   LVL+2,,AUTO
         2 000775   000022 631400 3                  EPPR1   18
         2 000776   000000 701000 xent               TSX1    XSS$BUFPTR
         2 000777   000000 011000                    NOP     0

      272    13610    2               IF XSS$CONNECT.COMMON$->TXTC.LEN ~= 0 THEN

  13610  2 001000   200503 470500                    LDP0    SFPT$,,AUTO
         2 001001   000005 471500                    LDP1    5,,PR0
         2 001002   000100 101500                    MRL     fill='000'O
         2 001003   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 001004   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 001005   200512 236100                    LDQ     LVL+2,,AUTO
         2 001006   000000 116003                    CMPQ    0,DU
         2 001007   001017 600000 2                  TZE     s:13676

      273    13611                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      274    13612                                VAL="XSS$CONNECT.COMMON$->TXTC");

  13660  2 001010   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001011   000001 735000                    ALS     1
         2 001012   000005 471500                    LDP1    5,,PR0
         2 001013   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  13669  2 001014   013073 236007                    LDQ     5691,DL
         2 001015   200004 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:73   
  13672  2 001016   000000 054000 1                  AOS     XSS_ITEMCNT

      275    13676    2               IF XSS$CONNECT.ARI ~= %XSS_ARI_NONE# THEN

  13676  2 001017   000012 235100                    LDA     10,,PR0
         2 001020   000004 115000 3                  CMPA    4
         2 001021   001030 600000 2                  TZE     s:13798

      276    13677                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN, LEN=4, VAL="XSS$CONNECT.ARI");

  13722  2 001022   000000 236000 1                  LDQ     XSS_ITEMCNT
         2 001023   000001 736000                    QLS     1
         2 001024   200005 755106                    STA     ITEMLIST+1,QL,AUTO

  13734  2 001025   000005 235000 3                  LDA     5
         2 001026   200004 755106                    STA     ITEMLIST,QL,AUTO

  13737  2 001027   000000 054000 1                  AOS     XSS_ITEMCNT

      277    13741                    %LOAD( LVL=2, TAG=PGI_CAI, TYP=NONE);

  13798  2 001030   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001031   000001 735000                    ALS     1
         2 001032   005002 236007                    LDQ     2562,DL
         2 001033   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13801  2 001034   000000 054000 1                  AOS     XSS_ITEMCNT

      278    13805                    %LOAD( LVL=3, TAG=PI_PO, TYP=UBIN, LEN=1, VAL="SCTX.PO");

  13850  2 001035   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001036   000001 735000                    ALS     1
         2 001037   200502 471500                    LDP1    SCTX$,,AUTO
         2 001040   100013 236100                    LDQ     11,,PR1
         2 001041   000033 772000                    QRL     27
         2 001042   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:74   
  13862  2 001043   000006 236000 3                  LDQ     6
         2 001044   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13865  2 001045   000000 054000 1                  AOS     XSS_ITEMCNT

      279    13869    2               IF SCTX.TSDUMS.INI ~= 0 OR SCTX.TSDUMS.RSP ~= 0 THEN

  13869  2 001046   100014 220100                    LDX0    12,,PR1
         2 001047   001052 601000 2                  TNZ     s:13916
         2 001050   100014 721100                    LXL1    12,,PR1
         2 001051   001067 600000 2                  TZE     s:13980

      280    13870                        %LOAD( LVL=3, TAG=PI_TSDUMS, TYP=UBIN, LEN=4,
      281    13871                                VAL="SCTX.TSDUMS.INI*65536+SCTX.TSDUMS.RSP");

  13916  2 001052   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001053   000001 735000                    ALS     1
         2 001054   100014 236100                    LDQ     12,,PR1
         2 001055   777777 376007                    ANQ     -1,DL
         2 001056   200512 756100                    STQ     LVL+2,,AUTO
         2 001057   100014 236100                    LDQ     12,,PR1
         2 001060   000002 772000                    QRL     2
         2 001061   000007 376000 3                  ANQ     7
         2 001062   200512 036100                    ADLQ    LVL+2,,AUTO
         2 001063   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  13928  2 001064   000010 236000 3                  LDQ     8
         2 001065   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13931  2 001066   000000 054000 1                  AOS     XSS_ITEMCNT

      282    13935                    %LOAD( LVL=3, TAG=PI_VN, TYP=UBIN, LEN=1, VAL="SCTX.VN");

  13980  2 001067   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001070   000001 735000                    ALS     1
         2 001071   100013 236100                    LDQ     11,,PR1
         2 001072   000026 772000                    QRL     22
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:75   
         2 001073   000017 376007                    ANQ     15,DL
         2 001074   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  13992  2 001075   000011 236000 3                  LDQ     9
         2 001076   200004 756105                    STQ     ITEMLIST,AL,AUTO

  13995  2 001077   000000 054000 1                  AOS     XSS_ITEMCNT

      283    13999    2               IF NOT XSS$CONNECT.SFU.ACT AND

  13999  2 001100   000010 236100                    LDQ     8,,PR0
         2 001101   000400 316007                    CANQ    256,DL
         2 001102   001123 601000 2                  TNZ     s:14067
         2 001103   000200 316007                    CANQ    128,DL
         2 001104   001111 601000 2                  TNZ     s:14048
         2 001105   000100 316007                    CANQ    64,DL
         2 001106   001111 601000 2                  TNZ     s:14048
         2 001107   000040 316007                    CANQ    32,DL
         2 001110   001123 600000 2                  TZE     s:14067

      284    14000    2                       ( XSS$CONNECT.SFU.RESYN OR XSS$CONNECT.SFU.MA OR
      285    14001    2                       XSS$CONNECT.SFU.SY) THEN
      286    14002                        %LOAD( LVL=3, TAG=PI_ISN, TYP=UBC6,
      287    14003                                LEN=6, VAL="XSS$CONNECT.SERNUM");

  14048  2 001111   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001112   000001 735000                    ALS     1
         2 001113   000000 620005                    EAX0    0,AL
         2 001114   000004 235100                    LDA     4,,PR0
         2 001115   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  14060  2 001116   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001117   000001 735000                    ALS     1
         2 001120   000012 236000 3                  LDQ     10
         2 001121   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14063  2 001122   000000 054000 1                  AOS     XSS_ITEMCNT
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:76   

      288    14067    2               IF XSS$CONNECT.ITOKENS ~= '111111110'B THEN

  14067  2 001123   000010 236100                    LDQ     8,,PR0
         2 001124   777000 376003                    ANQ     -512,DU
         2 001125   776000 116003                    CMPQ    -1024,DU
         2 001126   001137 600000 2                  TZE     s:14133

      289    14068                        %LOAD( LVL=3, TAG=PI_TSI, TYP=BITS,
      290    14069                                LEN=8, VAL="XSS$CONNECT.ITOKENS");

  14122  2 001127   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001130   000001 735000                    ALS     1
         2 001131   000010 236100                    LDQ     8,,PR0
         2 001132   777000 376003                    ANQ     -512,DU
         2 001133   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  14126  2 001134   000013 236000 3                  LDQ     11
         2 001135   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14129  2 001136   000000 054000 1                  AOS     XSS_ITEMCNT

      291    14133    2               IF XSS$CONNECT.ITOKENS.TR = %XSS_TSI_ISIDE# THEN

  14133  2 001137   000010 236100                    LDQ     8,,PR0
         2 001140   600000 316003                    CANQ    -65536,DU
         2 001141   001144 601000 2                  TNZ     s:14135

      292    14134    2                   SCTX.OWNED.TR = %TRUE;

  14134  2 001142   000200 236007                    LDQ     128,DL
         2 001143   100004 256100                    ORSQ    4,,PR1

      293    14135    2               IF XSS$CONNECT.ITOKENS.MA = %XSS_TSI_ISIDE# THEN

  14135  2 001144   000010 236100                    LDQ     8,,PR0
         2 001145   140000 316003                    CANQ    49152,DU
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:77   
         2 001146   001151 601000 2                  TNZ     s:14137

      294    14136    2                   SCTX.OWNED.MA = %TRUE;

  14136  2 001147   000040 236007                    LDQ     32,DL
         2 001150   100004 256100                    ORSQ    4,,PR1

      295    14137    2               IF XSS$CONNECT.ITOKENS.MI = %XSS_TSI_ISIDE# THEN

  14137  2 001151   000010 236100                    LDQ     8,,PR0
         2 001152   030000 316003                    CANQ    12288,DU
         2 001153   001156 601000 2                  TNZ     s:14139

      296    14138    2                   SCTX.OWNED.MI = %TRUE;

  14138  2 001154   000010 236007                    LDQ     8,DL
         2 001155   100004 256100                    ORSQ    4,,PR1

      297    14139    2               IF XSS$CONNECT.ITOKENS.DK = %XSS_TSI_ISIDE# THEN

  14139  2 001156   000010 236100                    LDQ     8,,PR0
         2 001157   006000 316003                    CANQ    3072,DU
         2 001160   001163 601000 2                  TNZ     s:14195

      298    14140    2                   SCTX.OWNED.DK = %TRUE;

  14140  2 001161   000002 236007                    LDQ     2,DL
         2 001162   100004 256100                    ORSQ    4,,PR1

      299    14141                    %LOAD( LVL=2, TAG=PGI_SUR, TYP=BITS,
      300    14142                            LEN=16, VAL="XSS$CONNECT.SFU");

  14195  2 001163   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001164   000001 735000                    ALS     1
         2 001165   000010 236100                    LDQ     8,,PR0
         2 001166   000022 736000                    QLS     18
         2 001167   200005 756105                    STQ     ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:78   

  14199  2 001170   000015 236000 3                  LDQ     13
         2 001171   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14202  2 001172   000000 054000 1                  AOS     XSS_ITEMCNT

      301    14206    2               SCTX.FU = XSS$CONNECT.SFU;  /* negotiate this down on AC */

  14206  2 001173   000010 720100                    LXL0    8,,PR0
         2 001174   100006 740100                    STX0    6,,PR1

      302    14207    2               IF XSS$CONNECT.CALLING$->UADR.SSAP.LEN ~= 0 THEN

  14207  2 001175   000006 473500                    LDP3    6,,PR0
         2 001176   300070 236100                    LDQ     56,,PR3
         2 001177   000777 316003                    CANQ    511,DU
         2 001200   001212 600000 2                  TZE     s:14273

      303    14208                        %LOAD( LVL=2, TAG=PI_ISSEL, TYP=TXTC,
      304    14209                                VAL="XSS$CONNECT.CALLING$->UADR.SSAP");

  14257  2 001201   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001202   000001 735000                    ALS     1
         2 001203   200512 453500                    STP3    LVL+2,,AUTO
         2 001204   200512 236100                    LDQ     LVL+2,,AUTO
         2 001205   000016 036000 3                  ADLQ    14
         2 001206   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  14266  2 001207   063072 236007                    LDQ     26170,DL
         2 001210   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14269  2 001211   000000 054000 1                  AOS     XSS_ITEMCNT

      305    14273    2               IF XSS$CONNECT.CALLED$->UADR.SSAP.LEN ~= 0 THEN

  14273  2 001212   000007 473500                    LDP3    7,,PR0
         2 001213   300070 236100                    LDQ     56,,PR3
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:79   
         2 001214   000777 316003                    CANQ    511,DU
         2 001215   001227 600000 2                  TZE     s:14339

      306    14274                        %LOAD( LVL=2, TAG=PI_ASSEL, TYP=TXTC,
      307    14275                                VAL="XSS$CONNECT.CALLED$->UADR.SSAP");

  14323  2 001216   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001217   000001 735000                    ALS     1
         2 001220   200512 453500                    STP3    LVL+2,,AUTO
         2 001221   200512 236100                    LDQ     LVL+2,,AUTO
         2 001222   000016 036000 3                  ADLQ    14
         2 001223   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  14332  2 001224   064072 236007                    LDQ     26682,DL
         2 001225   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14335  2 001226   000000 054000 1                  AOS     XSS_ITEMCNT

      308    14339    2               DATALVL = 2;

  14339  2 001227   000002 235007                    LDA     2,DL
         2 001230   200047 755100                    STA     DATALVL,,AUTO

      309    14340                    /* make sure saved copy of User Data is framed.. */
      310    14341    2               IF SCTX.HEADX ~= %NULL THEN

  14341  2 001231   100031 220100                    LDX0    25,,PR1
         2 001232   777777 100003                    CMPX0   -1,DU
         2 001233   002263 600000 2                  TZE     s:17656

      311    14342    2                   CALL XSS$BUFPTR( SCTX.HEADX, XSS$CONNECT.DATA.PTR$);

  14342  2 001234   200503 236100                    LDQ     SFPT$,,AUTO
         2 001235   000002 036003                    ADLQ    2,DU
         2 001236   200513 756100                    STQ     LVL+3,,AUTO
         2 001237   200502 236100                    LDQ     SCTX$,,AUTO
         2 001240   000031 036003                    ADLQ    25,DU
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:80   
         2 001241   200512 756100                    STQ     LVL+2,,AUTO
         2 001242   200512 630500                    EPPR0   LVL+2,,AUTO
         2 001243   000022 631400 3                  EPPR1   18
         2 001244   000000 701000 xent               TSX1    XSS$BUFPTR
         2 001245   000000 011000                    NOP     0
         2 001246   002263 710000 2                  TRA     s:17656

      312    14343        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:81   
      313    14344        /*****************************************************************************
      314    14345        *
      315    14346        *       DN              DISCONNECT SPDU
      316    14347        *
      317    14348        *****************************************************************************/
      318    14349    2           CASE( %XSS_SEV_DN);

      319    14350                    %LOAD( LVL=1, TAG=SI_DN, TYP=NONE);

  14407  2 001247   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001250   000001 735000                    ALS     1
         2 001251   012001 236007                    LDQ     5121,DL
         2 001252   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14410  2 001253   000000 054000 1                  AOS     XSS_ITEMCNT

      320    14414    2               DATALVL = 2;

  14414  2 001254   000002 235007                    LDA     2,DL
         2 001255   200047 755100                    STA     DATALVL,,AUTO
         2 001256   002263 710000 2                  TRA     s:17656

      321    14415        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:82   
      322    14416        /*****************************************************************************
      323    14417        *
      324    14418        *       DT              DATA TRANSFER SPDU
      325    14419        *
      326    14420        *****************************************************************************/
      327    14421    2           CASE( %XSS_SEV_DT);

      328    14422    2               CALL LOADGT;

  14422  2 001257   002370 701000 2                  TSX1    LOADGT
         2 001260   000000 011000                    NOP     0

      329    14423                    %LOAD( LVL=1, TAG=SI_DT, TYP=NONE);

  14480  2 001261   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001262   000001 735000                    ALS     1
         2 001263   001001 236007                    LDQ     513,DL
         2 001264   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14483  2 001265   000000 054000 1                  AOS     XSS_ITEMCNT

      330    14487    2               IF SCTX.FLAGS.VTCA THEN

  14487  2 001266   200502 470500                    LDP0    SCTX$,,AUTO
         2 001267   000006 236100                    LDQ     6,,PR0
         2 001270   002000 316007                    CANQ    1024,DL
         2 001271   001276 600000 2                  TZE     s:14490

      331    14488    2                   MAXSZ = SCTX.TSDUMS.RSP;

  14488  2 001272   000014 236100                    LDQ     12,,PR0
         2 001273   777777 376007                    ANQ     -1,DL
         2 001274   200051 756100                    STQ     MAXSZ,,AUTO
         2 001275   001301 710000 2                  TRA     s:14491

      332    14489    2               ELSE
      333    14490    2                   MAXSZ = SCTX.TSDUMS.INI;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:83   

  14490  2 001276   000014 236100                    LDQ     12,,PR0
         2 001277   000022 772000                    QRL     18
         2 001300   200051 756100                    STQ     MAXSZ,,AUTO

      334    14491    2               IF MAXSZ ~= 0 THEN

  14491  2 001301   001314 600000 2                  TZE     s:14556

      335    14492                        %LOAD( LVL=2, TAG=PGI_EI, TYP=BITS, LEN=8, VAL="VBLK.EI");

  14545  2 001302   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001303   000001 735000                    ALS     1
         2 001304   200003 471500                    LDP1    @VBLK,,AUTO
         2 001305   100001 236100                    LDQ     1,,PR1
         2 001306   000022 736000                    QLS     18
         2 001307   777000 376003                    ANQ     -512,DU
         2 001310   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  14549  2 001311   000023 236000 3                  LDQ     19
         2 001312   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14552  2 001313   000000 054000 1                  AOS     XSS_ITEMCNT

      336    14556    2               DATALVL = 2;

  14556  2 001314   000002 235007                    LDA     2,DL
         2 001315   200047 755100                    STA     DATALVL,,AUTO

      337    14557    2               DATATAG = 0;

  14557  2 001316   200050 450100                    STZ     DATATAG,,AUTO
         2 001317   002263 710000 2                  TRA     s:17656

      338    14558        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:84   
      339    14559        /*****************************************************************************
      340    14560        *
      341    14561        *       ED              EXCEPTION DATA SPDU
      342    14562        *
      343    14563        *****************************************************************************/
      344    14564    2           CASE( %XSS_SEV_ED);

      345    14565    2               CALL LOADPT;

  14565  2 001320   002422 701000 2                  TSX1    LOADPT
         2 001321   000000 011000                    NOP     0

      346    14566                    %LOAD( LVL=1, TAG=SI_ED, TYP=NONE);

  14623  2 001322   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001323   000001 735000                    ALS     1
         2 001324   060001 236007                    LDQ     24577,DL
         2 001325   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14626  2 001326   000000 054000 1                  AOS     XSS_ITEMCNT

      347    14630                    %LOAD( LVL=2, TAG=PGI_RC, TYP=UBIN,
      348    14631                            LEN=1, VAL="XSS$U_EXCEPTION_REPORT.REASON");

  14676  2 001327   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001330   000001 735000                    ALS     1
         2 001331   200503 470500                    LDP0    SFPT$,,AUTO
         2 001332   000000 236100                    LDQ     0,,PR0
         2 001333   000011 772000                    QRL     9
         2 001334   000777 376007                    ANQ     511,DL
         2 001335   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  14688  2 001336   000017 236000 3                  LDQ     15
         2 001337   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14691  2 001340   000000 054000 1                  AOS     XSS_ITEMCNT

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:85   
      349    14695    2               DATALVL = 2;

  14695  2 001341   000002 235007                    LDA     2,DL
         2 001342   200047 755100                    STA     DATALVL,,AUTO
         2 001343   002263 710000 2                  TRA     s:17656

      350    14696        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:86   
      351    14697        /*****************************************************************************
      352    14698        *
      353    14699        *       ER              EXCEPTION REPORT SPDU
      354    14700        *
      355    14701        *****************************************************************************/
      356    14702    2           CASE( %XSS_SEV_ER);

      357    14703    2               CALL LOADPT;

  14703  2 001344   002422 701000 2                  TSX1    LOADPT
         2 001345   000000 011000                    NOP     0

      358    14704                    %LOAD( LVL=1, TAG=SI_ER, TYP=NONE);

  14761  2 001346   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001347   000001 735000                    ALS     1
         2 001350   000001 236007                    LDQ     1,DL
         2 001351   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14764  2 001352   000000 054000 1                  AOS     XSS_ITEMCNT

      359    14768                    %LOAD( LVL=2, TAG=PGI_RPV, TYP=CPTR,
      360    14769                            LEN="XSS$GENERIC.DATA.SIZE",
      361    14770                            VAL="XSS$GENERIC.DATA.PTR$->TEXT");

  14818  2 001353   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001354   000001 735000                    ALS     1
         2 001355   200503 470500                    LDP0    SFPT$,,AUTO
         2 001356   000002 471500                    LDP1    2,,PR0
         2 001357   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  14827  2 001360   000000 620005                    EAX0    0,AL
         2 001361   000003 235100                    LDA     3,,PR0
         2 001362   000022 735000                    ALS     18
         2 001363   061022 035007                    ADLA    25106,DL
         2 001364   200004 755110                    STA     ITEMLIST,X0,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:87   
  14830  2 001365   000000 054000 1                  AOS     XSS_ITEMCNT

  14832  2 001366   002263 710000 2                  TRA     s:17656

      362    14834        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:88   
      363    14835        /*****************************************************************************
      364    14836        *
      365    14837        *       EX              EXPEDITED DATA SPDU
      366    14838        *
      367    14839        *****************************************************************************/
      368    14840    2           CASE( %XSS_SEV_EX);

      369    14841                    %LOAD( LVL=1, TAG=SI_EX, TYP=NONE);

  14898  2 001367   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001370   000001 735000                    ALS     1
         2 001371   005001 236007                    LDQ     2561,DL
         2 001372   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14901  2 001373   000000 054000 1                  AOS     XSS_ITEMCNT

      370    14905    2               DATALVL = 2;

  14905  2 001374   000002 235007                    LDA     2,DL
         2 001375   200047 755100                    STA     DATALVL,,AUTO

      371    14906    2               DATATAG = 0;

  14906  2 001376   200050 450100                    STZ     DATATAG,,AUTO
         2 001377   002263 710000 2                  TRA     s:17656

      372    14907        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:89   
      373    14908        /*****************************************************************************
      374    14909        *
      375    14910        *       FN_NR           FINISH (NO REUSE) SPDU
      376    14911        *       FN_R            FINISH (REUSE) SPDU
      377    14912        *
      378    14913        *****************************************************************************/
      379    14914    2           CASE( %XSS_SEV_FN_NR);

      380    14915    2               SCTX.TD.TCREL = %TRUE;

  14915  2 001400   200502 471500                    LDP1    SCTX$,,AUTO
         2 001401   002000 236007                    LDQ     1024,DL
         2 001402   100015 256100                    ORSQ    13,,PR1

      381    14916    2               GOTO FN_COMMON;

  14916  2 001403   001407 710000 2                  TRA     FN_COMMON

      382    14917    2           CASE( %XSS_SEV_FN_R);

      383    14918    2               SCTX.TD.TCREL = %FALSE;

  14918  2 001404   200502 471500                    LDP1    SCTX$,,AUTO
         2 001405   000001 236000 3                  LDQ     1
         2 001406   100015 356100                    ANSQ    13,,PR1

      384    14919    2   FN_COMMON:
      385    14920                    %LOAD( LVL=1, TAG=SI_FN, TYP=NONE);

  14945  2 001407                       FN_COMMON    null
  14977  2 001407   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001410   000001 735000                    ALS     1
         2 001411   011001 236007                    LDQ     4609,DL
         2 001412   200004 756105                    STQ     ITEMLIST,AL,AUTO

  14980  2 001413   000000 054000 1                  AOS     XSS_ITEMCNT

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:90   
      386    14984                    %LOAD( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL="SCTX.TD");

  15037  2 001414   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001415   000001 735000                    ALS     1
         2 001416   100015 236100                    LDQ     13,,PR1
         2 001417   000022 736000                    QLS     18
         2 001420   777000 376003                    ANQ     -512,DU
         2 001421   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  15041  2 001422   000002 236000 3                  LDQ     2
         2 001423   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15044  2 001424   000000 054000 1                  AOS     XSS_ITEMCNT

      387    15048    2               DATALVL = 2;

  15048  2 001425   000002 235007                    LDA     2,DL
         2 001426   200047 755100                    STA     DATALVL,,AUTO
         2 001427   002263 710000 2                  TRA     s:17656

      388    15049        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:91   
      389    15050        /*****************************************************************************
      390    15051        *
      391    15052        *       GT              GIVE TOKENS SPDU
      392    15053        *
      393    15054        *****************************************************************************/
      394    15055    2           CASE( %XSS_SEV_GT);

      395    15056                    %LOAD( LVL=1, TAG=SI_GT, TYP=NONE);

  15113  2 001430   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001431   000001 735000                    ALS     1
         2 001432   001001 236007                    LDQ     513,DL
         2 001433   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15116  2 001434   000000 054000 1                  AOS     XSS_ITEMCNT

      396    15120    2               IF XSS$TOKEN_GIVE.TOKENS ~= '000000000'B THEN

  15120  2 001435   200503 471500                    LDP1    SFPT$,,AUTO
         2 001436   100000 236100                    LDQ     0,,PR1
         2 001437   000777 316007                    CANQ    511,DL
         2 001440   002263 600000 2                  TZE     s:17656

      397    15121                        %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS,
      398    15122                                LEN=8, VAL="XSS$TOKEN_GIVE.TOKENS");

  15175  2 001441   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001442   000001 735000                    ALS     1
         2 001443   100000 236100                    LDQ     0,,PR1
         2 001444   000033 736000                    QLS     27
         2 001445   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  15179  2 001446   000014 236000 3                  LDQ     12
         2 001447   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15182  2 001450   000000 054000 1                  AOS     XSS_ITEMCNT

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:92   
  15184  2 001451   002263 710000 2                  TRA     s:17656

      399    15186        /*****************************************************************************
      400    15187        *
      401    15188        *       GTA             GIVE TOKENS ACK SPDU
      402    15189        *
      403    15190        *****************************************************************************/
      404    15191    2           CASE( %XSS_SEV_GTA);

      405    15192                    %LOAD( LVL=1, TAG=SI_GTA, TYP=NONE);

  15249  2 001452   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001453   000001 735000                    ALS     1
         2 001454   026001 236007                    LDQ     11265,DL
         2 001455   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15252  2 001456   000000 054000 1                  AOS     XSS_ITEMCNT

  15254  2 001457   002263 710000 2                  TRA     s:17656

      406    15256        /*****************************************************************************
      407    15257        *
      408    15258        *       GTC             GIVE TOKENS CONFIRM SPDU
      409    15259        *
      410    15260        *****************************************************************************/
      411    15261    2           CASE( %XSS_SEV_GTC);

      412    15262                    %LOAD( LVL=1, TAG=SI_GTC, TYP=NONE);

  15319  2 001460   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001461   000001 735000                    ALS     1
         2 001462   025001 236007                    LDQ     10753,DL
         2 001463   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15322  2 001464   000000 054000 1                  AOS     XSS_ITEMCNT

  15324  2 001465   002263 710000 2                  TRA     s:17656
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:93   

      413    15326        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:94   
      414    15327        /*****************************************************************************
      415    15328        *
      416    15329        *       MAA             MAJOR SYNC ACK SPDU
      417    15330        *
      418    15331        *****************************************************************************/
      419    15332    2           CASE( %XSS_SEV_MAA);

      420    15333    2               CALL LOADPT;

  15333  2 001466   002422 701000 2                  TSX1    LOADPT
         2 001467   000000 011000                    NOP     0

      421    15334                    %LOAD( LVL=1, TAG=SI_MAA, TYP=NONE);

  15391  2 001470   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001471   000001 735000                    ALS     1
         2 001472   052001 236007                    LDQ     21505,DL
         2 001473   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15394  2 001474   000000 054000 1                  AOS     XSS_ITEMCNT

      422    15398                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      423    15399                            LEN=6, VAL="SCTX.VM-1");

  15444  2 001475   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001476   000001 735000                    ALS     1
         2 001477   200502 470500                    LDP0    SCTX$,,AUTO
         2 001500   000000 620005                    EAX0    0,AL
         2 001501   000011 235100                    LDA     9,,PR0
         2 001502   000001 135007                    SBLA    1,DL
         2 001503   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  15456  2 001504   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001505   000001 735000                    ALS     1
         2 001506   000020 236000 3                  LDQ     16
         2 001507   200004 756105                    STQ     ITEMLIST,AL,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:95   
  15459  2 001510   000000 054000 1                  AOS     XSS_ITEMCNT

      424    15463    2               DATALVL = 2;

  15463  2 001511   000002 235007                    LDA     2,DL
         2 001512   200047 755100                    STA     DATALVL,,AUTO
         2 001513   002263 710000 2                  TRA     s:17656

      425    15464        /*****************************************************************************
      426    15465        *
      427    15466        *       MAP             MAJOR SYNC POINT SPDU
      428    15467        *
      429    15468        *****************************************************************************/
      430    15469    2           CASE( %XSS_SEV_MAP);

      431    15470    2               CALL LOADGT;

  15470  2 001514   002370 701000 2                  TSX1    LOADGT
         2 001515   000000 011000                    NOP     0

      432    15471                    %LOAD( LVL=1, TAG=SI_MAP, TYP=NONE);

  15528  2 001516   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001517   000001 735000                    ALS     1
         2 001520   051001 236007                    LDQ     20993,DL
         2 001521   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15531  2 001522   000000 054000 1                  AOS     XSS_ITEMCNT

      433    15535                    %LOAD( LVL=2, TAG=PGI_STI, TYP=UBIN,
      434    15536                            LEN=1, VAL="XSS$SYNC_MAJOR.TYPE");

  15581  2 001523   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001524   000001 735000                    ALS     1
         2 001525   200503 470500                    LDP0    SFPT$,,AUTO
         2 001526   000000 236100                    LDQ     0,,PR0
         2 001527   000011 772000                    QRL     9
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:96   
         2 001530   000777 376007                    ANQ     511,DL
         2 001531   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  15593  2 001532   000024 236000 3                  LDQ     20
         2 001533   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15596  2 001534   000000 054000 1                  AOS     XSS_ITEMCNT

      435    15600                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      436    15601                            LEN=6, VAL="XSS$SYNC_MAJOR.SERNUM");

  15646  2 001535   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001536   000001 735000                    ALS     1
         2 001537   000000 620005                    EAX0    0,AL
         2 001540   000004 235100                    LDA     4,,PR0
         2 001541   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  15658  2 001542   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001543   000001 735000                    ALS     1
         2 001544   000020 236000 3                  LDQ     16
         2 001545   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15661  2 001546   000000 054000 1                  AOS     XSS_ITEMCNT

      437    15665    2               DATALVL = 2;

  15665  2 001547   000002 235007                    LDA     2,DL
         2 001550   200047 755100                    STA     DATALVL,,AUTO
         2 001551   002263 710000 2                  TRA     s:17656

      438    15666        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:97   
      439    15667        /*****************************************************************************
      440    15668        *
      441    15669        *       MIA             MINOR SYNC ACK SPDU
      442    15670        *
      443    15671        *****************************************************************************/
      444    15672    2           CASE( %XSS_SEV_MIA);

      445    15673    2               CALL LOADPT;

  15673  2 001552   002422 701000 2                  TSX1    LOADPT
         2 001553   000000 011000                    NOP     0

      446    15674                    %LOAD( LVL=1, TAG=SI_MIA, TYP=NONE);

  15731  2 001554   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001555   000001 735000                    ALS     1
         2 001556   062001 236007                    LDQ     25601,DL
         2 001557   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15734  2 001560   000000 054000 1                  AOS     XSS_ITEMCNT

      447    15738                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      448    15739                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");

  15784  2 001561   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001562   000001 735000                    ALS     1
         2 001563   200503 470500                    LDP0    SFPT$,,AUTO
         2 001564   000000 620005                    EAX0    0,AL
         2 001565   000004 235100                    LDA     4,,PR0
         2 001566   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  15796  2 001567   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001570   000001 735000                    ALS     1
         2 001571   000020 236000 3                  LDQ     16
         2 001572   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15799  2 001573   000000 054000 1                  AOS     XSS_ITEMCNT
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:98   

      449    15803    3               IF XSS$GENERIC.DATA.PTR$ ~= ADDR( NIL) THEN DO;

  15803  2 001574   000002 236100                    LDQ     2,,PR0
         2 001575   000025 116000 3                  CMPQ    21
         2 001576   002263 600000 2                  TZE     s:17656

      450    15804                        %LOAD( LVL=2, TAG=PGI_UD, TYP=CPTR,
      451    15805                               LEN="XSS$GENERIC.DATA.SIZE",
      452    15806                               VAL="XSS$GENERIC.DATA.PTR$->TEXT");

  15854  2 001577   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001600   000001 735000                    ALS     1
         2 001601   000002 471500                    LDP1    2,,PR0
         2 001602   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  15863  2 001603   000000 620005                    EAX0    0,AL
         2 001604   000003 235100                    LDA     3,,PR0
         2 001605   000022 735000                    ALS     18
         2 001606   056022 035007                    ADLA    23570,DL
         2 001607   200004 755110                    STA     ITEMLIST,X0,AUTO

  15866  2 001610   000000 054000 1                  AOS     XSS_ITEMCNT

      453    15870    3                   END;

  15870  2 001611   002263 710000 2                  TRA     s:17656

      454    15871        /*****************************************************************************
      455    15872        *
      456    15873        *       MIP             MINOR SYNC POINT SPDU
      457    15874        *
      458    15875        *****************************************************************************/
      459    15876    2           CASE( %XSS_SEV_MIP);

      460    15877    2               CALL LOADGT;

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:99   
  15877  2 001612   002370 701000 2                  TSX1    LOADGT
         2 001613   000000 011000                    NOP     0

      461    15878                    %LOAD( LVL=1, TAG=SI_MIP, TYP=NONE);

  15935  2 001614   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001615   000001 735000                    ALS     1
         2 001616   061001 236007                    LDQ     25089,DL
         2 001617   200004 756105                    STQ     ITEMLIST,AL,AUTO

  15938  2 001620   000000 054000 1                  AOS     XSS_ITEMCNT

      462    15942    2               IF XSS$SYNC_MINOR.TYPE ~= 0 THEN

  15942  2 001621   200503 470500                    LDP0    SFPT$,,AUTO
         2 001622   000000 236100                    LDQ     0,,PR0
         2 001623   777000 316007                    CANQ    -512,DL
         2 001624   001636 600000 2                  TZE     s:16054

      463    15943                        %LOAD( LVL=2, TAG=PGI_STI, TYP=UBIN,
      464    15944                                LEN=1, VAL="XSS$SYNC_MINOR.TYPE");

  15989  2 001625   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001626   000001 735000                    ALS     1
         2 001627   000000 236100                    LDQ     0,,PR0
         2 001630   000011 772000                    QRL     9
         2 001631   000777 376007                    ANQ     511,DL
         2 001632   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  16001  2 001633   000024 236000 3                  LDQ     20
         2 001634   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16004  2 001635   000000 054000 1                  AOS     XSS_ITEMCNT

      465    16008                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      466    16009                            LEN=6, VAL="XSS$SYNC_MINOR.SERNUM");

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:100  
  16054  2 001636   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001637   000001 735000                    ALS     1
         2 001640   000000 620005                    EAX0    0,AL
         2 001641   000004 235100                    LDA     4,,PR0
         2 001642   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  16066  2 001643   000020 236000 3                  LDQ     16
         2 001644   200004 756110                    STQ     ITEMLIST,X0,AUTO

  16069  2 001645   000000 054000 1                  AOS     XSS_ITEMCNT

      467    16073    2               DATALVL = 2;

  16073  2 001646   000002 235007                    LDA     2,DL
         2 001647   200047 755100                    STA     DATALVL,,AUTO
         2 001650   002263 710000 2                  TRA     s:17656

      468    16074        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:101  
      469    16075        /*****************************************************************************
      470    16076        *
      471    16077        *       NF              NOT FINISHED SPDU
      472    16078        *
      473    16079        *****************************************************************************/
      474    16080    2           CASE( %XSS_SEV_NF);

      475    16081                    %LOAD( LVL=1, TAG=SI_NF, TYP=NONE);

  16138  2 001651   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001652   000001 735000                    ALS     1
         2 001653   010001 236007                    LDQ     4097,DL
         2 001654   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16141  2 001655   000000 054000 1                  AOS     XSS_ITEMCNT

      476    16145    2               DATALVL = 2;

  16145  2 001656   000002 235007                    LDA     2,DL
         2 001657   200047 755100                    STA     DATALVL,,AUTO
         2 001660   002263 710000 2                  TRA     s:17656

      477    16146        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:102  
      478    16147        /*****************************************************************************
      479    16148        *
      480    16149        *       PR_MAA          PREPARE (MAJOR SYNC ACK) SPDU
      481    16150        *       PR_RA           PREPARE (RESYNCHRONIZE ACK) SPDU
      482    16151        *       PR_RS           PREPARE (RESYNCHRONIZE) SPDU
      483    16152        *
      484    16153        *****************************************************************************/
      485    16154    2           CASE( %XSS_SEV_PR_MAA);

      486    16155    2               SCTX.PT = %XSS_PT_MAA#;

  16155  2 001661   200502 471500                    LDP1    SCTX$,,AUTO
         2 001662   100013 236100                    LDQ     11,,PR1
         2 001663   000026 376000 3                  ANQ     22
         2 001664   000001 276003                    ORQ     1,DU
         2 001665   100013 756100                    STQ     11,,PR1

      487    16156    2               GOTO PR_COMMON;

  16156  2 001666   001702 710000 2                  TRA     PR_COMMON

      488    16157    2           CASE( %XSS_SEV_PR_RA);

      489    16158    2               SCTX.PT = %XSS_PT_RA#;

  16158  2 001667   200502 471500                    LDP1    SCTX$,,AUTO
         2 001670   100013 236100                    LDQ     11,,PR1
         2 001671   000026 376000 3                  ANQ     22
         2 001672   000003 276003                    ORQ     3,DU
         2 001673   100013 756100                    STQ     11,,PR1

      490    16159    2               GOTO PR_COMMON;

  16159  2 001674   001702 710000 2                  TRA     PR_COMMON

      491    16160    2           CASE( %XSS_SEV_PR_RS);

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:103  
      492    16161    2               SCTX.PT = %XSS_PT_RS#;

  16161  2 001675   200502 471500                    LDP1    SCTX$,,AUTO
         2 001676   100013 236100                    LDQ     11,,PR1
         2 001677   000026 376000 3                  ANQ     22
         2 001700   000002 276003                    ORQ     2,DU
         2 001701   100013 756100                    STQ     11,,PR1

      493    16162    2   PR_COMMON:
      494    16163                    %LOAD( LVL=1, TAG=SI_PR, TYP=NONE);

  16188  2 001702                       PR_COMMON    null
  16220  2 001702   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001703   000001 735000                    ALS     1
         2 001704   007001 236007                    LDQ     3585,DL
         2 001705   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16223  2 001706   000000 054000 1                  AOS     XSS_ITEMCNT

      495    16227                    %LOAD( LVL=2, TAG=PGI_PT, TYP=UBIN, LEN=1, VAL="SCTX.PT");

  16272  2 001707   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001710   000001 735000                    ALS     1
         2 001711   100013 236100                    LDQ     11,,PR1
         2 001712   000022 772000                    QRL     18
         2 001713   000017 376007                    ANQ     15,DL
         2 001714   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  16284  2 001715   000027 236000 3                  LDQ     23
         2 001716   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16287  2 001717   000000 054000 1                  AOS     XSS_ITEMCNT

  16289  2 001720   002263 710000 2                  TRA     s:17656

      496    16291        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:104  
      497    16292        /*****************************************************************************
      498    16293        *
      499    16294        *       PT              PLEASE TOKENS SPDU
      500    16295        *
      501    16296        *****************************************************************************/
      502    16297    2           CASE( %XSS_SEV_PT);

      503    16298                    %LOAD( LVL=1, TAG=SI_PT, TYP=NONE);

  16355  2 001721   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001722   000001 735000                    ALS     1
         2 001723   002001 236007                    LDQ     1025,DL
         2 001724   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16358  2 001725   000000 054000 1                  AOS     XSS_ITEMCNT

      504    16362    2               IF XSS$TOKEN_PLEASE.TOKENS ~= '000000000'B THEN

  16362  2 001726   200503 471500                    LDP1    SFPT$,,AUTO
         2 001727   100000 236100                    LDQ     0,,PR1
         2 001730   000777 316007                    CANQ    511,DL
         2 001731   001742 600000 2                  TZE     s:16428

      505    16363                        %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS,
      506    16364                                LEN=8, VAL="XSS$TOKEN_PLEASE.TOKENS");

  16417  2 001732   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001733   000001 735000                    ALS     1
         2 001734   100000 236100                    LDQ     0,,PR1
         2 001735   000033 736000                    QLS     27
         2 001736   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  16421  2 001737   000014 236000 3                  LDQ     12
         2 001740   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16424  2 001741   000000 054000 1                  AOS     XSS_ITEMCNT

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:105  
      507    16428    2               DATALVL = 2;

  16428  2 001742   000002 235007                    LDA     2,DL
         2 001743   200047 755100                    STA     DATALVL,,AUTO
         2 001744   002263 710000 2                  TRA     s:17656

      508    16429        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:106  
      509    16430        /*****************************************************************************
      510    16431        *
      511    16432        *       RA              RESYNCHRONIZE ACK SPDU
      512    16433        *
      513    16434        *****************************************************************************/
      514    16435    2           CASE( %XSS_SEV_RA);

      515    16436    2               CALL LOADPT;

  16436  2 001745   002422 701000 2                  TSX1    LOADPT
         2 001746   000000 011000                    NOP     0

      516    16437                    %LOAD( LVL=1, TAG=SI_RA, TYP=NONE);

  16494  2 001747   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001750   000001 735000                    ALS     1
         2 001751   042001 236007                    LDQ     17409,DL
         2 001752   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16497  2 001753   000000 054000 1                  AOS     XSS_ITEMCNT

      517    16501    2               IF XSS$RESYNCHRONIZE.TOKENS ~= '000000000'B THEN

  16501  2 001754   200503 470500                    LDP0    SFPT$,,AUTO
         2 001755   000000 236100                    LDQ     0,,PR0
         2 001756   000777 316007                    CANQ    511,DL
         2 001757   001770 600000 2                  TZE     s:16613

      518    16502                        %LOAD( LVL=2, TAG=PGI_TSI, TYP=BITS,
      519    16503                                LEN=8, VAL="XSS$RESYNCHRONIZE.TOKENS");

  16556  2 001760   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001761   000001 735000                    ALS     1
         2 001762   000000 236100                    LDQ     0,,PR0
         2 001763   000033 736000                    QLS     27
         2 001764   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:107  
  16560  2 001765   000030 236000 3                  LDQ     24
         2 001766   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16563  2 001767   000000 054000 1                  AOS     XSS_ITEMCNT

      520    16567                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      521    16568                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");

  16613  2 001770   000000 235000 1                  LDA     XSS_ITEMCNT
         2 001771   000001 735000                    ALS     1
         2 001772   000000 620005                    EAX0    0,AL
         2 001773   000004 235100                    LDA     4,,PR0
         2 001774   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  16625  2 001775   000020 236000 3                  LDQ     16
         2 001776   200004 756110                    STQ     ITEMLIST,X0,AUTO

  16628  2 001777   000000 054000 1                  AOS     XSS_ITEMCNT

      522    16632    2               DATALVL = 2;

  16632  2 002000   000002 235007                    LDA     2,DL
         2 002001   200047 755100                    STA     DATALVL,,AUTO
         2 002002   002263 710000 2                  TRA     s:17656

      523    16633        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:108  
      524    16634        /*****************************************************************************
      525    16635        *
      526    16636        *       RF_NR           REFUSE (NO REUSE) SPDU
      527    16637        *       RF_R            REFUSE (REUSE) SPDU
      528    16638        *
      529    16639        *****************************************************************************/
      530    16640    2           CASE( %XSS_SEV_RF_NR);

      531    16641    2               SCTX.TD.TCREL = %TRUE;

  16641  2 002003   200502 471500                    LDP1    SCTX$,,AUTO
         2 002004   002000 236007                    LDQ     1024,DL
         2 002005   100015 256100                    ORSQ    13,,PR1

      532    16642    2               GOTO RF_COMMON;

  16642  2 002006   002012 710000 2                  TRA     RF_COMMON

      533    16643    2           CASE( %XSS_SEV_RF_R);

      534    16644    2               SCTX.TD.TCREL = %FALSE;

  16644  2 002007   200502 471500                    LDP1    SCTX$,,AUTO
         2 002010   000001 236000 3                  LDQ     1
         2 002011   100015 356100                    ANSQ    13,,PR1

      535    16645    2   RF_COMMON:
      536    16646                    %LOAD( LVL=1, TAG=SI_RF, TYP=NONE);

  16671  2 002012                       RF_COMMON    null
  16703  2 002012   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002013   000001 735000                    ALS     1
         2 002014   014001 236007                    LDQ     6145,DL
         2 002015   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16706  2 002016   000000 054000 1                  AOS     XSS_ITEMCNT

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:109  
      537    16710                    %LOAD( LVL=2, TAG=PGI_CI, TYP=NONE);

  16767  2 002017   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002020   000001 735000                    ALS     1
         2 002021   001002 236007                    LDQ     514,DL
         2 002022   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16770  2 002023   000000 054000 1                  AOS     XSS_ITEMCNT

      538    16774                    %LOAD( LVL=3, TAG=PI_ASSUR, TYP=TXTC,
      539    16775                            VAL="XSS$CONNECT.RESPONDING$->UADR.PSAP");

  16823  2 002024   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002025   000001 735000                    ALS     1
         2 002026   200503 473500                    LDP3    SFPT$,,AUTO
         2 002027   300007 474500                    LDP4    7,,PR3
         2 002030   200005 454505                    STP4    ITEMLIST+1,AL,AUTO

  16832  2 002031   011073 236007                    LDQ     4667,DL
         2 002032   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16835  2 002033   000000 054000 1                  AOS     XSS_ITEMCNT

      540    16839    2               IF XSS$CONNECT.COMMON$->TXTC.LEN ~= 0 THEN

  16839  2 002034   300005 474500                    LDP4    5,,PR3
         2 002035   000100 101500                    MRL     fill='000'O
         2 002036   400000 000001                    ADSC9   0,,PR4                   cn=0,n=1
         2 002037   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 002040   200512 236100                    LDQ     LVL+2,,AUTO
         2 002041   000000 116003                    CMPQ    0,DU
         2 002042   002052 600000 2                  TZE     s:16905

      541    16840                        %LOAD( LVL=3, TAG=PI_CR, TYP=TXTC,
      542    16841                                VAL="XSS$CONNECT.COMMON$->TXTC");

  16889  2 002043   000000 235000 1                  LDA     XSS_ITEMCNT
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:110  
         2 002044   000001 735000                    ALS     1
         2 002045   300005 474500                    LDP4    5,,PR3
         2 002046   200005 454505                    STP4    ITEMLIST+1,AL,AUTO

  16898  2 002047   013073 236007                    LDQ     5691,DL
         2 002050   200004 756105                    STQ     ITEMLIST,AL,AUTO

  16901  2 002051   000000 054000 1                  AOS     XSS_ITEMCNT

      543    16905    2               IF XSS$CONNECT.ARI ~= %XSS_ARI_NONE# THEN

  16905  2 002052   300012 235100                    LDA     10,,PR3
         2 002053   000004 115000 3                  CMPA    4
         2 002054   002063 600000 2                  TZE     s:17023

      544    16906                        %LOAD( LVL=3, TAG=PI_ARI, TYP=UBIN, LEN=4, VAL="XSS$CONNECT.ARI");

  16951  2 002055   000000 236000 1                  LDQ     XSS_ITEMCNT
         2 002056   000001 736000                    QLS     1
         2 002057   200005 755106                    STA     ITEMLIST+1,QL,AUTO

  16963  2 002060   000005 235000 3                  LDA     5
         2 002061   200004 755106                    STA     ITEMLIST,QL,AUTO

  16966  2 002062   000000 054000 1                  AOS     XSS_ITEMCNT

      545    16970                    %LOAD( LVL=2, TAG=PGI_TD, TYP=BITS, LEN=8, VAL="SCTX.TD");

  17023  2 002063   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002064   000001 735000                    ALS     1
         2 002065   100015 236100                    LDQ     13,,PR1
         2 002066   000022 736000                    QLS     18
         2 002067   777000 376003                    ANQ     -512,DU
         2 002070   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  17027  2 002071   000002 236000 3                  LDQ     2
         2 002072   200004 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:111  

  17030  2 002073   000000 054000 1                  AOS     XSS_ITEMCNT

      546    17034    2               IF XSS$CONNECT.REASON = %XSS_RC_REJECTED# THEN

  17034  2 002074   300000 236100                    LDQ     0,,PR3
         2 002075   777000 376007                    ANQ     -512,DL
         2 002076   002000 116007                    CMPQ    1024,DL
         2 002077   002110 601000 2                  TNZ     s:17145

      547    17035                        %LOAD( LVL=2, TAG=PGI_SUR, TYP=BITS,
      548    17036                                LEN=16, VAL="XSS$CONNECT.SFU");

  17089  2 002100   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002101   000001 735000                    ALS     1
         2 002102   300010 236100                    LDQ     8,,PR3
         2 002103   000022 736000                    QLS     18
         2 002104   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  17093  2 002105   000015 236000 3                  LDQ     13
         2 002106   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17096  2 002107   000000 054000 1                  AOS     XSS_ITEMCNT

      549    17100                    %LOAD( LVL=2, TAG=PGI_VN, TYP=UBIN, LEN=1, VAL="SCTX.VN");

  17145  2 002110   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002111   000001 735000                    ALS     1
         2 002112   100013 236100                    LDQ     11,,PR1
         2 002113   000026 772000                    QRL     22
         2 002114   000017 376007                    ANQ     15,DL
         2 002115   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  17157  2 002116   000031 236000 3                  LDQ     25
         2 002117   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17160  2 002120   000000 054000 1                  AOS     XSS_ITEMCNT
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:112  

      550    17164    2               CALL INSERT( REASON, 0, 1, BINASC( XSS$CONNECT.REASON));

  17164  2 002121   300000 236100                    LDQ     0,,PR3
         2 002122   000011 772000                    QRL     9
         2 002123   000777 376007                    ANQ     511,DL
         2 002124   000033 736000                    QLS     27
         2 002125   000032 276000 3                  ORQ     26
         2 002126   200301 552140                    STBQ    REASON,'40'O,AUTO

      551    17165    2               CALL INSERT( REASON, 1, XSS$CONNECT.DATA.SIZE,

  17165  2 002127   300002 474500                    LDP4    2,,PR3
         2 002130   300003 720100                    LXL0    3,,PR3
         2 002131   040000 221003                    LDX1    16384,DU
         2 002132   040140 100540                    MLR     fill='040'O
         2 002133   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         2 002134   200301 200010                    ADSC9   REASON,,AUTO             cn=1,n=*X0

      552    17166    2                       XSS$CONNECT.DATA.PTR$->TEXT);
      553    17167                    %LOAD( LVL=2, TAG=PGI_RC, TYP=DATA,
      554    17168                            LEN="1+XSS$CONNECT.DATA.SIZE", VAL=REASON);

  17216  2 002135   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002136   000001 735000                    ALS     1
         2 002137   200301 634500                    EPPR4   REASON,,AUTO
         2 002140   200005 454505                    STP4    ITEMLIST+1,AL,AUTO

  17225  2 002141   000000 620005                    EAX0    0,AL
         2 002142   300003 235100                    LDA     3,,PR3
         2 002143   000022 735000                    ALS     18
         2 002144   000033 035000 3                  ADLA    27
         2 002145   200004 755110                    STA     ITEMLIST,X0,AUTO

  17228  2 002146   000000 054000 1                  AOS     XSS_ITEMCNT

  17230  2 002147   002263 710000 2                  TRA     s:17656
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:113  

      555    17232        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:114  
      556    17233        /*****************************************************************************
      557    17234        *
      558    17235        *       RS_A            RESYNCHRONIZE (ABANDON) SPDU
      559    17236        *       RS_R            RESYNCHRONIZE (RESTART) SPDU
      560    17237        *       RS_S            RESYNCHRONIZE (SET) SPDU
      561    17238        *
      562    17239        *****************************************************************************/
      563    17240    2           CASE( %XSS_SEV_RS_A,

      564    17241    2                 %XSS_SEV_RS_R,
      565    17242    2                 %XSS_SEV_RS_S);
      566    17243    2               CALL LOADGT;

  17243  2 002150   002370 701000 2                  TSX1    LOADGT
         2 002151   000000 011000                    NOP     0

      567    17244                    %LOAD( LVL=1, TAG=SI_RS, TYP=NONE);

  17301  2 002152   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002153   000001 735000                    ALS     1
         2 002154   065001 236007                    LDQ     27137,DL
         2 002155   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17304  2 002156   000000 054000 1                  AOS     XSS_ITEMCNT

      568    17308    2               IF XSS$RESYNCHRONIZE.TOKENS ~= '000000000'B THEN

  17308  2 002157   200503 470500                    LDP0    SFPT$,,AUTO
         2 002160   000000 236100                    LDQ     0,,PR0
         2 002161   000777 316007                    CANQ    511,DL
         2 002162   002173 600000 2                  TZE     s:17420

      569    17309                        %LOAD( LVL=2, TAG=PGI_TSI, TYP=BITS,
      570    17310                                LEN=8, VAL="XSS$RESYNCHRONIZE.TOKENS");

  17363  2 002163   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002164   000001 735000                    ALS     1
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:115  
         2 002165   000000 236100                    LDQ     0,,PR0
         2 002166   000033 736000                    QLS     27
         2 002167   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  17367  2 002170   000030 236000 3                  LDQ     24
         2 002171   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17370  2 002172   000000 054000 1                  AOS     XSS_ITEMCNT

      571    17374                    %LOAD( LVL=2, TAG=PGI_RT, TYP=UBIN,
      572    17375                            LEN=1, VAL="XSS$RESYNCHRONIZE.TYPE");

  17420  2 002173   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002174   000001 735000                    ALS     1
         2 002175   000000 236100                    LDQ     0,,PR0
         2 002176   000011 772000                    QRL     9
         2 002177   000777 376007                    ANQ     511,DL
         2 002200   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  17432  2 002201   000034 236000 3                  LDQ     28
         2 002202   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17435  2 002203   000000 054000 1                  AOS     XSS_ITEMCNT

      573    17439                    %LOAD( LVL=2, TAG=PGI_SN, TYP=UBC6,
      574    17440                            LEN=6, VAL="XSS$RESYNCHRONIZE.SERNUM");

  17485  2 002204   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002205   000001 735000                    ALS     1
         2 002206   000000 620005                    EAX0    0,AL
         2 002207   000004 235100                    LDA     4,,PR0
         2 002210   200005 755110                    STA     ITEMLIST+1,X0,AUTO

  17497  2 002211   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002212   000001 735000                    ALS     1
         2 002213   000020 236000 3                  LDQ     16
         2 002214   200004 756105                    STQ     ITEMLIST,AL,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:116  

  17500  2 002215   000000 054000 1                  AOS     XSS_ITEMCNT

      575    17504    2               DATALVL = 2;

  17504  2 002216   000002 235007                    LDA     2,DL
         2 002217   200047 755100                    STA     DATALVL,,AUTO
         2 002220   002263 710000 2                  TRA     s:17656

      576    17505        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:117  
      577    17506        /*****************************************************************************
      578    17507        *
      579    17508        *       TD              TYPED DATA SPDU
      580    17509        *
      581    17510        *****************************************************************************/
      582    17511    2           CASE( %XSS_SEV_TD);

      583    17512                    %LOAD( LVL=1, TAG=SI_TD, TYP=NONE);

  17569  2 002221   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002222   000001 735000                    ALS     1
         2 002223   041001 236007                    LDQ     16897,DL
         2 002224   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17572  2 002225   000000 054000 1                  AOS     XSS_ITEMCNT

      584    17576    2               IF SCTX.FLAGS.VTCA THEN

  17576  2 002226   200502 471500                    LDP1    SCTX$,,AUTO
         2 002227   100006 236100                    LDQ     6,,PR1
         2 002230   002000 316007                    CANQ    1024,DL
         2 002231   002236 600000 2                  TZE     s:17579

      585    17577    2                   MAXSZ = SCTX.TSDUMS.RSP;

  17577  2 002232   100014 236100                    LDQ     12,,PR1
         2 002233   777777 376007                    ANQ     -1,DL
         2 002234   200051 756100                    STQ     MAXSZ,,AUTO
         2 002235   002241 710000 2                  TRA     s:17580

      586    17578    2               ELSE
      587    17579    2                   MAXSZ = SCTX.TSDUMS.INI;

  17579  2 002236   100014 236100                    LDQ     12,,PR1
         2 002237   000022 772000                    QRL     18
         2 002240   200051 756100                    STQ     MAXSZ,,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:118  
      588    17580    2               IF MAXSZ ~= 0 THEN

  17580  2 002241   002253 600000 2                  TZE     s:17645

      589    17581                        %LOAD( LVL=2, TAG=PGI_EI, TYP=BITS, LEN=8, VAL="VBLK.EI");

  17634  2 002242   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002243   000001 735000                    ALS     1
         2 002244   000001 236100                    LDQ     1,,PR0
         2 002245   000022 736000                    QLS     18
         2 002246   777000 376003                    ANQ     -512,DU
         2 002247   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  17638  2 002250   000023 236000 3                  LDQ     19
         2 002251   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17641  2 002252   000000 054000 1                  AOS     XSS_ITEMCNT

      590    17645    2               DATALVL = 2;

  17645  2 002253   000002 235007                    LDA     2,DL
         2 002254   200047 755100                    STA     DATALVL,,AUTO

      591    17646    2               DATATAG = 0;

  17646  2 002255   200050 450100                    STZ     DATATAG,,AUTO
         2 002256   002263 710000 2                  TRA     s:17656

      592    17647        /*****************************************************************************
      593    17648        *
      594    17649        *       Illegal VBLK.EVENT
      595    17650        *
      596    17651        *****************************************************************************/
      597    17652    2           CASE( ELSE);

      598    17653    2               CALL XSS$SCREECH( XSS_F$ENCODE);

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:119  
  17653  2 002257   000036 630400 3                  EPPR0   30
         2 002260   000035 631400 3                  EPPR1   29
         2 002261   000000 701000 xent               TSX1    XSS$SCREECH
         2 002262   000000 011000                    NOP     0

      599    17654    2           END;

      600    17655        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:120  
      601    17656    2       IF DATALVL > 0 AND XSS$GENERIC.DATA.PTR$ ~= ADDR( NIL) THEN DO;

  17656  2 002263   200047 235100                    LDA     DATALVL,,AUTO
         2 002264   002321 604400 2                  TMOZ    s:17793
         2 002265   200503 470500                    LDP0    SFPT$,,AUTO
         2 002266   000002 236100                    LDQ     2,,PR0
         2 002267   000025 116000 3                  CMPQ    21
         2 002270   002321 600000 2                  TZE     s:17793

      602    17657    2           IF DATATAG = 0 THEN

  17657  2 002271   200050 235100                    LDA     DATATAG,,AUTO
         2 002272   002306 601000 2                  TNZ     s:17775

      603    17658                    %LOAD( LVL=DATALVL, TAG=0, TYP=DATA,
      604    17659                            LEN="XSS$GENERIC.DATA.SIZE",
      605    17660                            VAL="XSS$GENERIC.DATA.PTR$->TEXT");

  17708  2 002273   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002274   000001 735000                    ALS     1
         2 002275   000002 471500                    LDP1    2,,PR0
         2 002276   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  17717  2 002277   000003 236100                    LDQ     3,,PR0
         2 002300   000022 736000                    QLS     18
         2 002301   200047 036100                    ADLQ    DATALVL,,AUTO
         2 002302   000050 036007                    ADLQ    40,DL
         2 002303   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17720  2 002304   000000 054000 1                  AOS     XSS_ITEMCNT

  17722  2 002305   002325 710000 2                  TRA     s:17797

      606    17724    2           ELSE
      607    17725                    %LOAD( LVL=DATALVL, TAG=PGI_DATA, TYP=DATA,
      608    17726                            LEN="XSS$GENERIC.DATA.SIZE",
      609    17727                            VAL="XSS$GENERIC.DATA.PTR$->TEXT");
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:121  

  17775  2 002306   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002307   000001 735000                    ALS     1
         2 002310   000002 471500                    LDP1    2,,PR0
         2 002311   200005 451505                    STP1    ITEMLIST+1,AL,AUTO

  17784  2 002312   000003 236100                    LDQ     3,,PR0
         2 002313   000022 736000                    QLS     18
         2 002314   200047 036100                    ADLQ    DATALVL,,AUTO
         2 002315   301050 036007                    ADLQ    98856,DL
         2 002316   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17787  2 002317   000000 054000 1                  AOS     XSS_ITEMCNT

      610    17791    2           END;

  17791  2 002320   002325 710000 2                  TRA     s:17797

      611    17792    2       ELSE DO;

      612    17793    2           VBLK.DAT.SIZE = 0;

  17793  2 002321   200003 470500                    LDP0    @VBLK,,AUTO
         2 002322   000007 450100                    STZ     7,,PR0

      613    17794    2           VBLK.DAT.PTR$ = ADDR( NIL);

  17794  2 002323   000025 236000 3                  LDQ     21
         2 002324   000006 756100                    STQ     6,,PR0

      614    17795    2           END;

      615    17796            /* if CN, release the saved copy of User Data */
      616    17797    2       IF VBLK.EVENT = %XSS_SEV_CN THEN DO;

  17797  2 002325   200003 470500                    LDP0    @VBLK,,AUTO
         2 002326   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:122  
         2 002327   000777 376007                    ANQ     511,DL
         2 002330   000017 116007                    CMPQ    15,DL
         2 002331   002350 601000 2                  TNZ     s:17803

      617    17798    2           IF SCTX.HEADX ~= %NULL THEN

  17798  2 002332   200502 471500                    LDP1    SCTX$,,AUTO
         2 002333   100031 220100                    LDX0    25,,PR1
         2 002334   777777 100003                    CMPX0   -1,DU
         2 002335   002345 600000 2                  TZE     s:17800

      618    17799    2               CALL XSS$RELMEM( SCTX.HEADX);

  17799  2 002336   200502 236100                    LDQ     SCTX$,,AUTO
         2 002337   000031 036003                    ADLQ    25,DU
         2 002340   200512 756100                    STQ     LVL+2,,AUTO
         2 002341   200512 630500                    EPPR0   LVL+2,,AUTO
         2 002342   000035 631400 3                  EPPR1   29
         2 002343   000000 701000 xent               TSX1    XSS$RELMEM
         2 002344   000000 011000                    NOP     0

      619    17800    2           SCTX.HEADX = %NULL;

  17800  2 002345   777777 220003                    LDX0    -1,DU
         2 002346   200502 470500                    LDP0    SCTX$,,AUTO
         2 002347   000031 740100                    STX0    25,,PR0

      620    17801    2           END;

      621    17802            /* Now, fix up the itemlist and build the PDU */
      622    17803    1       CALL FIXITEMS;

  17803  2 002350   002444 701000 2                  TSX1    FIXITEMS
         2 002351   000000 011000                    NOP     0

      623    17804    1       CALL BUILDPDU;

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:123  
  17804  2 002352   002702 701000 2                  TSX1    BUILDPDU
         2 002353   000000 011000                    NOP     0

      624    17805            /* Send the constructed PDU on to Transport */
      625    17806    1       VBLK.PDU.SIZE = PDUIDX;

  17806  2 002354   200003 470500                    LDP0    @VBLK,,AUTO
         2 002355   200300 235100                    LDA     PDUIDX,,AUTO
         2 002356   000005 755100                    STA     5,,PR0

      626    17807    1       VBLK.PDU.PTR$ = ADDR( PDUBUF);

  17807  2 002357   200052 631500                    EPPR1   PDUBUF,,AUTO
         2 002360   000004 451500                    STP1    4,,PR0

      627    17808    1       CALL XSS$TSEND( VBLK)

  17808  2 002361   200003 630500                    EPPR0   @VBLK,,AUTO
         2 002362   000035 631400 3                  EPPR1   29
         2 002363   000000 701000 xent               TSX1    XSS$TSEND
         2 002364   002366 702000 2                  TSX2    s:17810
         2 002365   002367 710000 2                  TRA     s:17812

      628    17809    2       WHENALTRETURN DO;

      629    17810    2           ALTRETURN;

  17810  2 002366   000000 702200 xent               TSX2  ! X66_AALT

      630    17811    2           END;
      631    17812    1       RETURN;

  17812  2 002367   000000 702200 xent               TSX2  ! X66_ARET

      632    17813        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:124  
      633    17814        /*F*    NAME:   LOADGT
      634    17815
      635    17816                LOADGT is called when constructing certain SPDUs to load a GT SPDU
      636    17817                into the itemlist before the other SPDU.  The Session spec requires
      637    17818                a GT or PT in front of every Category 2 SPDU sent.  This routine
      638    17819                takes the least-hassle approach that meets the spec.
      639    17820        */
      640    17821    1   LOADGT: PROC;

  17821  2 002370   200504 741300       LOADGT       STX1  ! SFPT$+1,,AUTO

      641    17822
      642    17823            %LOAD( LVL=1, TAG=SI_GT, TYP=NONE);

  17880  2 002371   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002372   000001 735000                    ALS     1
         2 002373   001001 236007                    LDQ     513,DL
         2 002374   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17883  2 002375   000000 054000 1                  AOS     XSS_ITEMCNT

      643    17887    3       IF VBLK.EVENT = %XSS_SEV_DT AND VBLK.EI.EOSSDU THEN DO;

  17887  2 002376   200003 470500                    LDP0    @VBLK,,AUTO
         2 002377   000001 236100                    LDQ     1,,PR0
         2 002400   000777 376007                    ANQ     511,DL
         2 002401   000021 116007                    CMPQ    17,DL
         2 002402   002420 601000 2                  TNZ     s:17957
         2 002403   000001 236100                    LDQ     1,,PR0
         2 002404   002000 316007                    CANQ    1024,DL
         2 002405   002420 600000 2                  TZE     s:17957

      644    17888                /*N* figure out when, if ever, we want to supply the value field */
      645    17889    4           IF LOAD_GT_VALUE THEN DO;

  17889  2 002406   000002 234000 1                  SZN     LOAD_GT_VALUE
         2 002407   002420 605000 2                  TPL     s:17957
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:125  

      646    17890    4               BTMP = '000000010'B;

  17890  2 002410   002000 236003                    LDQ     1024,DU
         2 002411   200046 756100                    STQ     BTMP,,AUTO

      647    17891                    %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS, LEN=8, VAL=BTMP);

  17944  2 002412   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002413   000001 735000                    ALS     1
         2 002414   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  17948  2 002415   000014 236000 3                  LDQ     12
         2 002416   200004 756105                    STQ     ITEMLIST,AL,AUTO

  17951  2 002417   000000 054000 1                  AOS     XSS_ITEMCNT

      648    17955    4               END;

      649    17956    3           END;

      650    17957    2       RETURN;

  17957  2 002420   200504 221300                    LDX1  ! SFPT$+1,,AUTO
         2 002421   000001 702211                    TSX2  ! 1,X1

      651    17958
      652    17959    2       END LOADGT;
      653    17960
      654    17961        /*F*    NAME:   LOADPT
      655    17962
      656    17963                LOADPT does the same as LOADGT, but with a PT SPDU.
      657    17964        */
      658    17965    1   LOADPT: PROC;

  17965  2 002422   200504 741300       LOADPT       STX1  ! SFPT$+1,,AUTO

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:126  
      659    17966
      660    17967            %LOAD( LVL=1, TAG=SI_PT, TYP=NONE);

  18024  2 002423   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002424   000001 735000                    ALS     1
         2 002425   002001 236007                    LDQ     1025,DL
         2 002426   200004 756105                    STQ     ITEMLIST,AL,AUTO

  18027  2 002427   000000 054000 1                  AOS     XSS_ITEMCNT

      661    18031            /*N* figure out when, if ever, we want to supply the value field */
      662    18032    3       IF LOAD_PT_VALUE THEN DO;

  18032  2 002430   000003 234000 1                  SZN     LOAD_PT_VALUE
         2 002431   002442 605000 2                  TPL     s:18099

      663    18033    3           BTMP = '000000000'B;

  18033  2 002432   200046 450100                    STZ     BTMP,,AUTO

      664    18034                %LOAD( LVL=2, TAG=PGI_TI, TYP=BITS, LEN=8, VAL=BTMP);

  18087  2 002433   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002434   000001 735000                    ALS     1
         2 002435   200046 236100                    LDQ     BTMP,,AUTO
         2 002436   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

  18091  2 002437   000014 236000 3                  LDQ     12
         2 002440   200004 756105                    STQ     ITEMLIST,AL,AUTO

  18094  2 002441   000000 054000 1                  AOS     XSS_ITEMCNT

      665    18098    3           END;

      666    18099    2       RETURN;

  18099  2 002442   200504 221300                    LDX1  ! SFPT$+1,,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:127  
         2 002443   000001 702211                    TSX2  ! 1,X1

      667    18100
      668    18101    2       END LOADPT;
      669    18102        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:128  
      670    18103        /*F*    NAME:   FIXITEMS
      671    18104                DESCRIPTION:
      672    18105                    The lengths of enclosing items in the item list are determined.
      673    18106                    If a pointer-type item points into the NULL segment, its length
      674    18107                    is set to zero.  This is done here rather than bludgeoning the
      675    18108                    already-obscure LOAD macro to do an inline check for ADDR( NIL).
      676    18109        */
      677    18110    1   FIXITEMS: PROC;

  18110  2 002444   200504 741300       FIXITEMS     STX1  ! SFPT$+1,,AUTO

      678    18111
      679    18112    2       DCL B$UBIN8 UBIN(8) BASED UNAL;
      680    18113    2       DCL B$UBIN9 UBIN(9) BASED CALIGNED;
      681    18114    2       DCL I SBIN;
      682    18115    2       DCL J SBIN;
      683    18116    2       DCL LEN UBIN;
      684    18117    2       DCL LVL UBIN;
      685    18118    2       DCL TEMP REDEF LVL UBIN;
      686    18119
      687    18120    3       DO I = XSS_ITEMCNT - 1 DOWNTO 1;

  18120  2 002445   000000 235000 1                  LDA     XSS_ITEMCNT
         2 002446   000001 135007                    SBLA    1,DL
         2 002447   200505 755100                    STA     I,,AUTO
         2 002450   002676 710000 2                  TRA     s:18168+2

      688    18121    4           DO CASE( ITEMLIST.X.TYP( I));

  18121  2 002451   200505 235100                    LDA     I,,AUTO
         2 002452   000001 735000                    ALS     1
         2 002453   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002454   000003 772000                    QRL     3
         2 002455   000037 376007                    ANQ     31,DL
         2 002456   000010 116007                    CMPQ    8,DL
         2 002457   002461 602006 2                  TNC     s:18121+8,QL
         2 002460   002622 710000 2                  TRA     s:18150
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:129  
         2 002461   002622 710000 2                  TRA     s:18150
         2 002462   002565 710000 2                  TRA     s:18143
         2 002463   002471 710000 2                  TRA     s:18123
         2 002464   002622 710000 2                  TRA     s:18150
         2 002465   002471 710000 2                  TRA     s:18123
         2 002466   002471 710000 2                  TRA     s:18123
         2 002467   002520 710000 2                  TRA     s:18134
         2 002470   002477 710000 2                  TRA     s:18126

      689    18122    4               CASE( %CPTR, %CVEC, %DATA);

      690    18123    4                   IF ITEMLIST.P( I) = ADDR( NIL) THEN

  18123  2 002471   200005 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 002472   000025 116000 3                  CMPQ    21
         2 002473   002622 601000 2                  TNZ     s:18150

      691    18124    4                       ITEMLIST.X.LEN( I) = 0;

  18124  2 002474   000000 220003                    LDX0    0,DU
         2 002475   200004 740105                    STX0    ITEMLIST,AL,AUTO
         2 002476   002622 710000 2                  TRA     s:18150

      692    18125    4               CASE( %TXTC);

      693    18126    4                   IF ITEMLIST.P( I) = ADDR( NIL) THEN

  18126  2 002477   200005 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 002500   000025 116000 3                  CMPQ    21
         2 002501   002505 601000 2                  TNZ     s:18129

      694    18127    4                       ITEMLIST.X.LEN( I) = 0;

  18127  2 002502   000000 220003                    LDX0    0,DU
         2 002503   200004 740105                    STX0    ITEMLIST,AL,AUTO
         2 002504   002622 710000 2                  TRA     s:18150

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:130  
      695    18128    5                   ELSE DO;

      696    18129    5                       ITEMLIST.X.LEN( I) = ITEMLIST.P( I)->B$UBIN9;

  18129  2 002505   200005 470505                    LDP0    ITEMLIST+1,AL,AUTO
         2 002506   000002 735000                    ALS     2
         2 002507   000105 101500                    MRL     fill='000'O
         2 002510   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 002511   200004 000002                    ADSC9   ITEMLIST,A,AUTO          cn=0,n=2

      697    18130    5                       ITEMLIST.P( I) = PINCRC( ITEMLIST.P( I), 1);

  18130  2 002512   200505 235100                    LDA     I,,AUTO
         2 002513   000001 735000                    ALS     1
         2 002514   200005 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 002515   200000 036007                    ADLQ    65536,DL
         2 002516   200005 756105                    STQ     ITEMLIST+1,AL,AUTO

      698    18131    5                       END;

  18131  2 002517   002622 710000 2                  TRA     s:18150

      699    18132    4               CASE( %BITS);

      700    18133                        /* convert bit-length to byte-length; unpack bit value */
      701    18134    4                   ITEMLIST.X.LEN( I) = ( ITEMLIST.X.LEN( I) + 7) / 8;

  18134  2 002520   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002521   000022 772000                    QRL     18
         2 002522   000007 036007                    ADLQ    7,DL
         2 002523   000003 772000                    QRL     3
         2 002524   000000 620006                    EAX0    0,QL
         2 002525   200004 740105                    STX0    ITEMLIST,AL,AUTO

      702    18135    4                   TEMP = ITEMLIST.U( I);

  18135  2 002526   200005 235105                    LDA     ITEMLIST+1,AL,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:131  
         2 002527   200510 755100                    STA     LVL,,AUTO

      703    18136                        /* unpack bit value 8 bits at a shot into low-8-of-9 */
      704    18137    4                   ITEMLIST.U( I) = ADDR( TEMP)->B$UBIN8 * 134217728 +

  18137  2 002530   200505 236100                    LDQ     I,,AUTO
         2 002531   000001 736000                    QLS     1
         2 002532   000000 620006                    EAX0    0,QL
         2 002533   200510 236100                    LDQ     LVL,,AUTO
         2 002534   000024 772000                    QRL     20
         2 002535   000377 376007                    ANQ     255,DL
         2 002536   200512 756100                    STQ     LVL+2,,AUTO
         2 002537   200510 236100                    LDQ     LVL,,AUTO
         2 002540   000023 772000                    QRL     19
         2 002541   377000 376007                    ANQ     130560,DL
         2 002542   200512 036100                    ADLQ    LVL+2,,AUTO
         2 002543   200513 756100                    STQ     LVL+3,,AUTO
         2 002544   200510 236100                    LDQ     LVL,,AUTO
         2 002545   000014 772000                    QRL     12
         2 002546   000377 376007                    ANQ     255,DL
         2 002547   200514 756100                    STQ     LVL+4,,AUTO
         2 002550   200513 236100                    LDQ     LVL+3,,AUTO
         2 002551   000011 736000                    QLS     9
         2 002552   200514 036100                    ADLQ    LVL+4,,AUTO
         2 002553   200515 756100                    STQ     LVL+5,,AUTO
         2 002554   200510 236100                    LDQ     LVL,,AUTO
         2 002555   000004 772000                    QRL     4
         2 002556   000377 376007                    ANQ     255,DL
         2 002557   200516 756100                    STQ     LVL+6,,AUTO
         2 002560   200515 236100                    LDQ     LVL+5,,AUTO
         2 002561   000011 736000                    QLS     9
         2 002562   200516 036100                    ADLQ    LVL+6,,AUTO
         2 002563   200005 756110                    STQ     ITEMLIST+1,X0,AUTO
         2 002564   002622 710000 2                  TRA     s:18150

      705    18138    4                           PINCRB( ADDR( TEMP), 8)->B$UBIN8 * 262144 +
      706    18139    4                           PINCRB( ADDR( TEMP), 16)->B$UBIN8 * 512 +
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:132  
      707    18140    4                           PINCRB( ADDR( TEMP), 24)->B$UBIN8;
      708    18141    4               CASE( %UBIN);

      709    18142                        /* unpack the unsigned binary value */
      710    18143    4                   TEMP = ITEMLIST.U( I);

  18143  2 002565   200005 235105                    LDA     ITEMLIST+1,AL,AUTO
         2 002566   200510 755100                    STA     LVL,,AUTO

      711    18144    4                   ITEMLIST.U( I) =

  18144  2 002567   200505 236100                    LDQ     I,,AUTO
         2 002570   000001 736000                    QLS     1
         2 002571   000000 620006                    EAX0    0,QL
         2 002572   200510 236100                    LDQ     LVL,,AUTO
         2 002573   000020 772000                    QRL     16
         2 002574   000377 376007                    ANQ     255,DL
         2 002575   200512 756100                    STQ     LVL+2,,AUTO
         2 002576   200510 236100                    LDQ     LVL,,AUTO
         2 002577   000017 772000                    QRL     15
         2 002600   377000 376007                    ANQ     130560,DL
         2 002601   200512 036100                    ADLQ    LVL+2,,AUTO
         2 002602   200513 756100                    STQ     LVL+3,,AUTO
         2 002603   200510 236100                    LDQ     LVL,,AUTO
         2 002604   000010 772000                    QRL     8
         2 002605   000377 376007                    ANQ     255,DL
         2 002606   200514 756100                    STQ     LVL+4,,AUTO
         2 002607   200513 236100                    LDQ     LVL+3,,AUTO
         2 002610   000011 736000                    QLS     9
         2 002611   200514 036100                    ADLQ    LVL+4,,AUTO
         2 002612   200515 756100                    STQ     LVL+5,,AUTO
         2 002613   200510 236100                    LDQ     LVL,,AUTO
         2 002614   000377 376007                    ANQ     255,DL
         2 002615   200516 756100                    STQ     LVL+6,,AUTO
         2 002616   200515 236100                    LDQ     LVL+5,,AUTO
         2 002617   000011 736000                    QLS     9
         2 002620   200516 036100                    ADLQ    LVL+6,,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:133  
         2 002621   200005 756110                    STQ     ITEMLIST+1,X0,AUTO

      712    18145    4                           PINCRB( ADDR( TEMP), 4)->B$UBIN8 * 134217728 +
      713    18146    4                           PINCRB( ADDR( TEMP), 12)->B$UBIN8 * 262144 +
      714    18147    4                           PINCRB( ADDR( TEMP), 20)->B$UBIN8 * 512 +
      715    18148    4                           PINCRB( ADDR( TEMP), 28)->B$UBIN8;
      716    18149    4               END;

      717    18150    3           LEN = ITEMLIST.X.LEN( I);

  18150  2 002622   200505 235100                    LDA     I,,AUTO
         2 002623   000001 735000                    ALS     1
         2 002624   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002625   000022 772000                    QRL     18
         2 002626   200507 756100                    STQ     LEN,,AUTO

      718    18151                /* If TAG is nonzero then TAG and LEN will have to be encoded,
      719    18152                   and LEN is now accumulated into the length of the enclosing
      720    18153                   item.  If TAG is zero then don't even accumulate LEN. */
      721    18154    4           IF ITEMLIST.X.TAG( I) ~= 0 THEN DO;

  18154  2 002627   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002630   377000 316007                    CANQ    130560,DL
         2 002631   002674 600000 2                  TZE     s:18168

      722    18155    4               IF LEN > 254 THEN

  18155  2 002632   200507 235100                    LDA     LEN,,AUTO
         2 002633   000377 115007                    CMPA    255,DL
         2 002634   002640 602000 2                  TNC     s:18158

      723    18156    4                   LEN = LEN + 4;  /* 3 bytes to encode length plus 1 for tag */

  18156  2 002635   000004 035007                    ADLA    4,DL
         2 002636   200507 755100                    STA     LEN,,AUTO
         2 002637   002642 710000 2                  TRA     s:18159

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:134  
      724    18157    4               ELSE
      725    18158    4                   LEN = LEN + 2;  /* 1 byte to encode length plus 1 for tag */

  18158  2 002640   000002 035007                    ADLA    2,DL
         2 002641   200507 755100                    STA     LEN,,AUTO

      726    18159    4               LVL = ITEMLIST.X.LVL( I) - 1;

  18159  2 002642   200505 236100                    LDQ     I,,AUTO
         2 002643   000001 736000                    QLS     1
         2 002644   200004 236106                    LDQ     ITEMLIST,QL,AUTO
         2 002645   000007 376007                    ANQ     7,DL
         2 002646   000001 136007                    SBLQ    1,DL
         2 002647   200510 756100                    STQ     LVL,,AUTO

      727    18160    4   INCRLOOP:
      728    18161    5               DO J = I - 1 DOWNTO 0;

  18161  2 002650   200505 235100       INCRLOOP     LDA     I,,AUTO
         2 002651   000001 135007                    SBLA    1,DL
         2 002652   200506 755100                    STA     J,,AUTO
         2 002653   002672 710000 2                  TRA     s:18166+2

      729    18162    6                   IF LVL = ITEMLIST.X.LVL( J) THEN DO;

  18162  2 002654   200506 235100                    LDA     J,,AUTO
         2 002655   000001 735000                    ALS     1
         2 002656   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002657   000007 376007                    ANQ     7,DL
         2 002660   200510 116100                    CMPQ    LVL,,AUTO
         2 002661   002670 601000 2                  TNZ     s:18166

      730    18163    6                       ITEMLIST.X.LEN( J) = LEN + ITEMLIST.X.LEN( J);

  18163  2 002662   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002663   000022 772000                    QRL     18
         2 002664   200507 036100                    ADLQ    LEN,,AUTO
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:135  
         2 002665   000000 620006                    EAX0    0,QL
         2 002666   200004 740105                    STX0    ITEMLIST,AL,AUTO

      731    18164    6                       EXIT INCRLOOP;

  18164  2 002667   002674 710000 2                  TRA     s:18168

      732    18165    6                       END;
      733    18166    5                   END;

  18166  2 002670   000001 336007                    LCQ     1,DL
         2 002671   200506 056100                    ASQ     J,,AUTO
         2 002672   200506 235100                    LDA     J,,AUTO
         2 002673   002654 605000 2                  TPL     s:18162

      734    18167    4               END;

      735    18168    3           END;

  18168  2 002674   000001 336007                    LCQ     1,DL
         2 002675   200505 056100                    ASQ     I,,AUTO
         2 002676   200505 235100                    LDA     I,,AUTO
         2 002677   002451 605400 2                  TPNZ    s:18121

      736    18169
      737    18170    2       END FIXITEMS;

  18170  2 002700   200504 221300                    LDX1  ! SFPT$+1,,AUTO
         2 002701   000001 702211                    TSX2  ! 1,X1

      738    18171        %EJECT;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:136  
      739    18172        /*F*    NAME:   BUILDPDU
      740    18173                DESCRIPTION:
      741    18174                    Now that the item list has been fixed up, the SPDU itself can be
      742    18175                    constructed in the AUTO buffer.  Note that for efficiency, any
      743    18176                    user data to be sent along as part of the SPDU is *not* appended
      744    18177                    to the SPDU in AUTO.. it is framed in VBLK.DAT.
      745    18178        */
      746    18179    1   BUILDPDU: PROC;

  18179  2 002702   200504 741300       BUILDPDU     STX1  ! SFPT$+1,,AUTO

      747    18180    2       DCL BYTES CHAR( LEN) BASED;
      748    18181    2       DCL I SBIN;
      749    18182    2       DCL LEN SBIN;
      750    18183        %MACRO STORBYTE( BYT=0);
      751    18184            CALL INSERT( PDUBUF, PDUIDX, 1, BINASC( BYT));
      752    18185            PDUIDX = 1 + PDUIDX;
      753    18186        %MEND;
      754    18187
      755    18188    2       PDUIDX = 0;

  18188  2 002703   200300 450100                    STZ     PDUIDX,,AUTO

      756    18189    2       XSS_ITEMCNT = XSS_ITEMCNT - 1;

  18189  2 002704   000001 336007                    LCQ     1,DL
         2 002705   000000 056000 1                  ASQ     XSS_ITEMCNT

      757    18190            /* construct each item of the item list in turn.  Item 0 not used. */
      758    18191    3       DO I = 1 TO XSS_ITEMCNT;

  18191  2 002706   000001 235007                    LDA     1,DL
         2 002707   200505 755100                    STA     I,,AUTO
         2 002710   003116 710000 2                  TRA     s:18252+1

      759    18192    4           IF ITEMLIST.X.TAG( I) ~= 0 THEN DO;

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:137  
  18192  2 002711   200505 235100                    LDA     I,,AUTO
         2 002712   000001 735000                    ALS     1
         2 002713   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002714   377000 316007                    CANQ    130560,DL
         2 002715   003002 600000 2                  TZE     s:18222

      760    18193                    /* Move the SI field in */
      761    18194                    %STORBYTE( BYT="ITEMLIST.X.TAG( I)");

  18195  2 002716   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002717   000011 772000                    QRL     9
         2 002720   000377 376007                    ANQ     255,DL
         2 002721   000033 736000                    QLS     27
         2 002722   000032 276000 3                  ORQ     26
         2 002723   200512 756100                    STQ     LVL+2,,AUTO
         2 002724   200300 235100                    LDA     PDUIDX,,AUTO
         2 002725   040105 100500                    MLR     fill='040'O
         2 002726   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 002727   200052 000001                    ADSC9   PDUBUF,A,AUTO            cn=0,n=1

  18196  2 002730   200300 054100                    AOS     PDUIDX,,AUTO

      762    18198                    /* Move the LI field in */
      763    18199    4               LEN = ITEMLIST.X.LEN( I);

  18199  2 002731   200505 235100                    LDA     I,,AUTO
         2 002732   000001 735000                    ALS     1
         2 002733   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 002734   000022 772000                    QRL     18
         2 002735   200506 756100                    STQ     LEN,,AUTO

      764    18200    5               IF LEN > 254 THEN DO;

  18200  2 002736   000376 116007                    CMPQ    254,DL
         2 002737   002772 604400 2                  TMOZ    s:18216

      765    18201                        %STORBYTE( BYT="255");
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:138  

  18202  2 002740   200300 235100                    LDA     PDUIDX,,AUTO
         2 002741   040105 100400                    MLR     fill='040'O
         2 002742   000037 000001 3                  ADSC9   31                       cn=0,n=1
         2 002743   200052 000001                    ADSC9   PDUBUF,A,AUTO            cn=0,n=1

  18203  2 002744   200300 054100                    AOS     PDUIDX,,AUTO

      766    18205                        %STORBYTE( BYT="LEN / 256");

  18206  2 002745   000400 506007                    DIV     256,DL
         2 002746   000033 736000                    QLS     27
         2 002747   000032 276000 3                  ORQ     26
         2 002750   200512 756100                    STQ     LVL+2,,AUTO
         2 002751   200300 235100                    LDA     PDUIDX,,AUTO
         2 002752   040105 100500                    MLR     fill='040'O
         2 002753   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 002754   200052 000001                    ADSC9   PDUBUF,A,AUTO            cn=0,n=1

  18207  2 002755   200300 054100                    AOS     PDUIDX,,AUTO

      767    18209                        %STORBYTE( BYT="MOD( LEN, 256)");

  18210  2 002756   200506 236100                    LDQ     LEN,,AUTO
         2 002757   000400 506007                    DIV     256,DL
         2 002760   000044 733000                    LRS     36
         2 002761   000033 736000                    QLS     27
         2 002762   000032 276000 3                  ORQ     26
         2 002763   200512 756100                    STQ     LVL+2,,AUTO
         2 002764   200300 235100                    LDA     PDUIDX,,AUTO
         2 002765   040105 100500                    MLR     fill='040'O
         2 002766   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 002767   200052 000001                    ADSC9   PDUBUF,A,AUTO            cn=0,n=1

  18211  2 002770   200300 054100                    AOS     PDUIDX,,AUTO

      768    18213    5                   END;
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:139  

  18213  2 002771   003002 710000 2                  TRA     s:18222

      769    18214    5               ELSE DO;

      770    18215                        %STORBYTE( BYT="LEN");

  18216  2 002772   000033 736000                    QLS     27
         2 002773   000032 276000 3                  ORQ     26
         2 002774   200512 756100                    STQ     LVL+2,,AUTO
         2 002775   200300 235100                    LDA     PDUIDX,,AUTO
         2 002776   040105 100500                    MLR     fill='040'O
         2 002777   200512 000004                    ADSC9   LVL+2,,AUTO              cn=0,n=4
         2 003000   200052 000001                    ADSC9   PDUBUF,A,AUTO            cn=0,n=1

  18217  2 003001   200300 054100                    AOS     PDUIDX,,AUTO

      771    18219    5                   END;

      772    18220    4               END;

      773    18221                /* and finally, move the value field in */
      774    18222    4           DO CASE( ITEMLIST.X.TYP( I));

  18222  2 003002   200505 235100                    LDA     I,,AUTO
         2 003003   000001 735000                    ALS     1
         2 003004   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003005   000003 772000                    QRL     3
         2 003006   000037 376007                    ANQ     31,DL
         2 003007   000010 116007                    CMPQ    8,DL
         2 003010   003012 602006 2                  TNC     s:18222+8,QL
         2 003011   003112 710000 2                  TRA     s:18251
         2 003012   003022 710000 2                  TRA     s:18225
         2 003013   003034 710000 2                  TRA     s:18235
         2 003014   003065 710000 2                  TRA     s:18244
         2 003015   003101 710000 2                  TRA     s:18248
         2 003016   003065 710000 2                  TRA     s:18244
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:140  
         2 003017   003024 710000 2                  TRA     s:18228
         2 003020   003052 710000 2                  TRA     s:18240
         2 003021   003065 710000 2                  TRA     s:18244

      775    18223    4               CASE( %NONE);

      776    18224                        /* Set LEN to zero so not to incr PDUIDX for enclosing item */
      777    18225    4                   LEN = 0;

  18225  2 003022   200506 450100                    STZ     LEN,,AUTO
         2 003023   003112 710000 2                  TRA     s:18251

      778    18226    4               CASE( %DATA);

      779    18227                        /* Set LEN to zero so not to incr PDUIDX (DATA is always last) */
      780    18228    4                   LEN = 0;

  18228  2 003024   200506 450100                    STZ     LEN,,AUTO

      781    18229                        /* The (one) DATA item is not copied into the SPDU buffer.
      782    18230                           For efficiency, it is just framed in VBLK now. */
      783    18231    4                   VBLK.DAT.SIZE = ITEMLIST.X.LEN( I);

  18231  2 003025   200004 236105                    LDQ     ITEMLIST,AL,AUTO
         2 003026   000022 772000                    QRL     18
         2 003027   200003 470500                    LDP0    @VBLK,,AUTO
         2 003030   000007 756100                    STQ     7,,PR0

      784    18232    4                   VBLK.DAT.PTR$ = ITEMLIST.P( I);

  18232  2 003031   200005 236105                    LDQ     ITEMLIST+1,AL,AUTO
         2 003032   000006 756100                    STQ     6,,PR0
         2 003033   003112 710000 2                  TRA     s:18251

      785    18233    4               CASE( %UBIN);

      786    18234                        /* Move up to 4 bytes of RJ, unpacked binary data */
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:141  
      787    18235    4                   IF LEN > 0 THEN

  18235  2 003034   200506 235100                    LDA     LEN,,AUTO
         2 003035   003112 604400 2                  TMOZ    s:18251

      788    18236    4                       CALL INSERT( PDUBUF, PDUIDX, LEN,

  18236  2 003036   200505 336100                    LCQ     I,,AUTO
         2 003037   000003 736000                    QLS     3
         2 003040   200506 036100                    ADLQ    LEN,,AUTO
         2 003041   000040 676000 3                  ERQ     32
         2 003042   000001 036007                    ADLQ    1,DL
         2 003043   000000 620005                    EAX0    0,AL
         2 003044   200506 721100                    LXL1    LEN,,AUTO
         2 003045   200300 235100                    LDA     PDUIDX,,AUTO
         2 003046   040145 100546                    MLR     fill='040'O
         2 003047   200006 000010                    ADSC9   ITEMLIST+2,Q,AUTO        cn=0,n=*X0
         2 003050   200052 000011                    ADSC9   PDUBUF,A,AUTO            cn=0,n=*X1
         2 003051   003112 710000 2                  TRA     s:18251

      789    18237    4                               PINCRC( ADDR( ITEMLIST.U( I)), 4 - LEN)->BYTES);
      790    18238    4               CASE( %BITS);

      791    18239                        /* Move up to 4 bytes of LJ, unpacked bitstring data */
      792    18240    4                   IF LEN > 0 THEN

  18240  2 003052   200506 235100                    LDA     LEN,,AUTO
         2 003053   003112 604400 2                  TMOZ    s:18251

      793    18241    4                      CALL INSERT( PDUBUF, PDUIDX, LEN, ADDR( ITEMLIST.U( I))->BYTES);

  18241  2 003054   200505 236100                    LDQ     I,,AUTO
         2 003055   000003 736000                    QLS     3
         2 003056   000000 620005                    EAX0    0,AL
         2 003057   200506 721100                    LXL1    LEN,,AUTO
         2 003060   200300 235100                    LDA     PDUIDX,,AUTO
         2 003061   040145 100546                    MLR     fill='040'O
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:142  
         2 003062   200005 000010                    ADSC9   ITEMLIST+1,Q,AUTO        cn=0,n=*X0
         2 003063   200052 000011                    ADSC9   PDUBUF,A,AUTO            cn=0,n=*X1
         2 003064   003112 710000 2                  TRA     s:18251

      794    18242    4               CASE( %CPTR, %CVEC, %TXTC);

      795    18243                        /* Move the byte string pointed at by ITEM.PTR$ */
      796    18244    4                   IF LEN > 0 THEN

  18244  2 003065   200506 235100                    LDA     LEN,,AUTO
         2 003066   003112 604400 2                  TMOZ    s:18251

      797    18245    4                       CALL INSERT( PDUBUF, PDUIDX, LEN, ITEMLIST.P( I)->BYTES);

  18245  2 003067   200505 236100                    LDQ     I,,AUTO
         2 003070   000001 736000                    QLS     1
         2 003071   200005 470506                    LDP0    ITEMLIST+1,QL,AUTO
         2 003072   000000 620005                    EAX0    0,AL
         2 003073   200506 721100                    LXL1    LEN,,AUTO
         2 003074   200300 235100                    LDA     PDUIDX,,AUTO
         2 003075   040145 100540                    MLR     fill='040'O
         2 003076   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 003077   200052 000011                    ADSC9   PDUBUF,A,AUTO            cn=0,n=*X1
         2 003100   003112 710000 2                  TRA     s:18251

      798    18246    4               CASE( %UBC6);

      799    18247                        /* Build a serial number.  Note that LEN is 6. */
      800    18248    4                  CALL BINCHAR( PINCRC( ADDR( PDUBUF), PDUIDX)->BYTES, ITEMLIST.U( I))
             18248                            ;

  18248  2 003101   200005 235105                    LDA     ITEMLIST+1,AL,AUTO
         2 003102   000044 773000                    LRL     36
         2 003103   200512 757100                    STAQ    LVL+2,,AUTO
         2 003104   200506 720100                    LXL0    LEN,,AUTO
         2 003105   200300 235100                    LDA     PDUIDX,,AUTO
         2 003106   000145 301500                    BTD
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:143  
         2 003107   200512 000010                    NDSC9   LVL+2,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         2 003110   200052 030010                    NDSC9   PDUBUF,A,AUTO            cn=0,s=nosgn,sf=0,n=*X0
         2 003111   003112 710000 2                  TRA     s:18251

      801    18249    4               CASE( ELSE);

      802    18250    4               END;

      803    18251    3           PDUIDX = LEN + PDUIDX;

  18251  2 003112   200506 236100                    LDQ     LEN,,AUTO
         2 003113   200300 036100                    ADLQ    PDUIDX,,AUTO
         2 003114   200300 756100                    STQ     PDUIDX,,AUTO

      804    18252    3           END;

  18252  2 003115   200505 054100                    AOS     I,,AUTO
         2 003116   200505 236100                    LDQ     I,,AUTO
         2 003117   000000 116000 1                  CMPQ    XSS_ITEMCNT
         2 003120   002711 604400 2                  TMOZ    s:18192

      805    18253
      806    18254    2       END BUILDPDU;

  18254  2 003121   200504 221300                    LDX1  ! SFPT$+1,,AUTO
         2 003122   000001 702211                    TSX2  ! 1,X1

XSS_F$ENCODE
 Sect OctLoc
   0     000   302323 001327                                                    ....

XSS_ITEMCNT
 Sect OctLoc
   1     000   000000 000000                                                    ....

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:144  
   1     001   000000 000020                                                    ....

LOAD_GT_VALUE
 Sect OctLoc
   1     002   0***** ******                                                    ....

LOAD_PT_VALUE
 Sect OctLoc
   1     003   0***** ******                                                    ....

(unnamed)
 Sect OctLoc
   3     000   000000 000000   777777 775777   000010 021062   000011 061022    ...........2..1.
   3     004   055055 055055   000004 014013   000001 023013   177777 600000    ----............
   3     010   000004 025013   000001 026013   000006 027033   000010 032063    ...............3
   3     014   000010 020062   000020 024062   000070 200000   000001 062012    ...2...2.8....2.
   3     020   000006 052032   000006 052033   000002 000000   000010 031062    ..*...*........2
   3     024   000001 017012   000000 006014   777760 777777   000001 030012    ................
   3     030   000010 032062   000001 026012   000040 040040   000001 062052    ...2.....   ..2*
   3     034   000001 033012   000001 000000   000000 006000   377040 040040    .............
   3     040   777777 777777                                                    ....
      807    18255
      808    18256    1       END XSS$ENCODE;

PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:145  
--  Include file information  --

   XSC_PERR_C.:XSA1TOU  is referenced.
   XSC_COMMON_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_M.:XSA1TOU  is referenced.
   XSS_INTERNAL_E.:XSA1TOU  is referenced.
   XSS_SESSION_M.:XSA1TOU  is referenced.
   XSS_SESSION_E.:XSA1TOU  is referenced.
   K_ADDRESS_M.:LIB_E05  is referenced.
   UM_CP6.:E05OU  is referenced.
      No diagnostics issued in procedure XSS$ENCODE.
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:146  

 **** Variables and constants ****

  ****  Section 000 RoData XSS$ENCODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 XSS_F$ENCODE

  ****  Section 001  Data  XSS$ENCODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/b BIT         r     1 LOAD_GT_VALUE              3-0-0/b BIT         r     1 LOAD_PT_VALUE
     0-0-0/w SBIN        r     1 XSS_ITEMCNT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @VBLK                     46-0-0/w BIT         r     1 BTMP
    47-0-0/w SBIN        r     1 DATALVL                   50-0-0/w SBIN        r     1 DATATAG
   505-0-0/w SBIN        r     1 I                        505-0-0/w SBIN        r     1 I
     4-0-0/w STRC(72)    r     1 ITEMLIST(0:16)
   506-0-0/w SBIN        r     1 J                        507-0-0/w UBIN        r     1 LEN
   506-0-0/w SBIN        r     1 LEN                      510-0-0/w UBIN        r     1 LVL
    51-0-0/w SBIN        r     1 MAXSZ                     52-0-0/c CHAR(600)   r     1 PDUBUF
   300-0-0/w SBIN        r     1 PDUIDX                   301-0-0/c CHAR(513)   r     1 REASON
   502-0-0/w PTR         r     1 SCTX$                    503-0-0/w PTR         r     1 SFPT$
   510-0-0/w UBIN        r     1 TEMP                      *0-0-0/d STRC(288)   r     1 VBLK

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:147  

     0-0-0/b UBIN(8)     r     1 B$UBIN8                    0-0-0/c UBIN(9)     r     1 B$UBIN9
     0-0-0/c ACHR        r     1 BYTES                      0-0-0/w STRC(1260)  r     1 SCTX
     0-0-0/c CHAR(16384) r     1 TEXT                       0-0-0/c ASTR(9)     r     1 TXTC
     0-0-0/w STRC(2718)  r     1 UADR                       0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_DISCARD
     0-0-0/d STRC(180)   r     1 XSS$ACTIVITY_END
     0-0-0/w STRC(72)    r     1 XSS$ACTIVITY_INTERRUPT
     0-0-0/d STRC(468)   r     1 XSS$ACTIVITY_RESUME        0-0-0/d STRC(216)   r     1 XSS$ACTIVITY_START
     0-0-0/d STRC(396)   r     1 XSS$CONNECT                0-0-0/d STRC(504)   r     1 XSS$GENERIC
     0-0-0/d STRC(180)   r     1 XSS$RESYNCHRONIZE          0-0-0/d STRC(180)   r     1 XSS$SYNC_MAJOR
     0-0-0/d STRC(180)   r     1 XSS$SYNC_MINOR             0-0-0/w STRC(72)    r     1 XSS$TOKEN_GIVE
     0-0-0/d STRC(144)   r     1 XSS$TOKEN_PLEASE
     0-0-0/d STRC(144)   r     1 XSS$U_EXCEPTION_REPORT


   Procedure XSS$ENCODE requires 1619 words for executable code.
   Procedure XSS$ENCODE requires 336 words of local(AUTO) storage.

    No errors detected in file XSS$ENCODE.:XSA1TSI    .
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:148  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:149  
          MINI XREF LISTING

AB_COMMON
     10683**LABEL   10654--GOTO
B$UBIN8 IN PROCEDURE FIXITEMS
     18112**DCL     18137>>ASSIGN  18137>>ASSIGN  18137>>ASSIGN  18137>>ASSIGN  18144>>ASSIGN  18144>>ASSIGN
     18144>>ASSIGN  18144>>ASSIGN
B$UBIN9 IN PROCEDURE FIXITEMS
     18113**DCL     18129>>ASSIGN
BTMP
     10488**DCL     17890<<ASSIGN  17944>>ASSIGN  18033<<ASSIGN  18087>>ASSIGN
BUILDPDU
     18179**PROC    17804--CALL
BYTES IN PROCEDURE BUILDPDU
     18180**DCL     18236>>CALLBLT 18241>>CALLBLT 18245>>CALLBLT 18248<<CALLBLT
DATALVL
     10489**DCL     10506<<ASSIGN  10852<<ASSIGN  11838<<ASSIGN  12184<<ASSIGN  12321<<ASSIGN  13125<<ASSIGN
     13263<<ASSIGN  13336<<ASSIGN  13408<<ASSIGN  14339<<ASSIGN  14414<<ASSIGN  14556<<ASSIGN  14695<<ASSIGN
     14905<<ASSIGN  15048<<ASSIGN  15463<<ASSIGN  15665<<ASSIGN  16073<<ASSIGN  16145<<ASSIGN  16428<<ASSIGN
     16632<<ASSIGN  17504<<ASSIGN  17645<<ASSIGN  17656>>IF      17717>>ASSIGN  17784>>ASSIGN
DATATAG
     10490**DCL     10507<<ASSIGN  14557<<ASSIGN  14906<<ASSIGN  17646<<ASSIGN  17657>>IF
FIXITEMS
     18110**PROC    17803--CALL
FN_COMMON
     14945**LABEL   14916--GOTO
I IN PROCEDURE BUILDPDU
     18181**DCL     18191<<DOINDEX 18192>>IF      18195>>CALLBLT 18199>>ASSIGN  18222>>DOCASE  18231>>ASSIGN
     18232>>ASSIGN  18236>>CALLBLT 18241>>CALLBLT 18245>>CALLBLT 18248>>CALLBLT
I IN PROCEDURE FIXITEMS
     18114**DCL     18120<<DOINDEX 18121>>DOCASE  18123>>IF      18124>>ASSIGN  18126>>IF      18127>>ASSIGN
     18129>>ASSIGN  18129>>ASSIGN  18130>>ASSIGN  18130>>ASSIGN  18134>>ASSIGN  18134>>ASSIGN  18135>>ASSIGN
     18137>>ASSIGN  18143>>ASSIGN  18144>>ASSIGN  18150>>ASSIGN  18154>>IF      18159>>ASSIGN  18161>>DOINDEX
INCRLOOP IN PROCEDURE FIXITEMS
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:150  
     18161**LABEL   18164--EXIT
ITEMLIST
     10468**DCL     10509<<ASSIGN
ITEMLIST.B
     10486**DCL     10775<<ASSIGN  11565<<ASSIGN  11630<<ASSIGN  11695<<ASSIGN  14122<<ASSIGN  14195<<ASSIGN
     14545<<ASSIGN  15037<<ASSIGN  15175<<ASSIGN  16417<<ASSIGN  16556<<ASSIGN  17023<<ASSIGN  17089<<ASSIGN
     17363<<ASSIGN  17634<<ASSIGN  17944<<ASSIGN  18087<<ASSIGN
ITEMLIST.P
     10485**DCL     10835<<ASSIGN  11037<<ASSIGN  11103<<ASSIGN  11756<<ASSIGN  11822<<ASSIGN  12716<<ASSIGN
     12782<<ASSIGN  12848<<ASSIGN  12979<<ASSIGN  13109<<ASSIGN  13247<<ASSIGN  13593<<ASSIGN  13660<<ASSIGN
     14257<<ASSIGN  14323<<ASSIGN  14818<<ASSIGN  15854<<ASSIGN  16823<<ASSIGN  16889<<ASSIGN  17216<<ASSIGN
     17708<<ASSIGN  17775<<ASSIGN  18123>>IF      18126>>IF      18129>>ASSIGN  18130<<ASSIGN  18130>>ASSIGN
     18232>>ASSIGN  18245>>CALLBLT
ITEMLIST.U
     10483**DCL     10484--REDEF   10485--REDEF   10486--REDEF   11165<<ASSIGN  11293<<ASSIGN  11359<<ASSIGN
     11423<<ASSIGN  11491<<ASSIGN  11957<<ASSIGN  12165<<ASSIGN  12302<<ASSIGN  12440<<ASSIGN  12911<<ASSIGN
     13041<<ASSIGN  13722<<ASSIGN  13850<<ASSIGN  13916<<ASSIGN  13980<<ASSIGN  14048<<ASSIGN  14676<<ASSIGN
     15444<<ASSIGN  15581<<ASSIGN  15646<<ASSIGN  15784<<ASSIGN  15989<<ASSIGN  16054<<ASSIGN  16272<<ASSIGN
     16613<<ASSIGN  16951<<ASSIGN  17145<<ASSIGN  17420<<ASSIGN  17485<<ASSIGN  18135>>ASSIGN  18137<<ASSIGN
     18143>>ASSIGN  18144<<ASSIGN  18236--CALLBLT 18241--CALLBLT 18248>>CALLBLT
ITEMLIST.X.LEN
     10477**DCL     18124<<ASSIGN  18127<<ASSIGN  18129<<ASSIGN  18134<<ASSIGN  18134>>ASSIGN  18150>>ASSIGN
     18163<<ASSIGN  18163>>ASSIGN  18199>>ASSIGN  18231>>ASSIGN
ITEMLIST.X.LVL
     10482**DCL     18159>>ASSIGN  18162>>IF
ITEMLIST.X.TAG
     10479**DCL     18154>>IF      18192>>IF      18195>>CALLBLT
ITEMLIST.X.TYP
     10481**DCL     18121>>DOCASE  18222>>DOCASE
ITEMLIST.Z
     10475**DCL     10476--REDEF   10567<<ASSIGN  10639<<ASSIGN  10715<<ASSIGN  10779<<ASSIGN  10844<<ASSIGN
     10917<<ASSIGN  10981<<ASSIGN  11046<<ASSIGN  11112<<ASSIGN  11177<<ASSIGN  11241<<ASSIGN  11305<<ASSIGN
     11371<<ASSIGN  11435<<ASSIGN  11503<<ASSIGN  11569<<ASSIGN  11634<<ASSIGN  11699<<ASSIGN  11765<<ASSIGN
     11831<<ASSIGN  11904<<ASSIGN  11969<<ASSIGN  12040<<ASSIGN  12112<<ASSIGN  12177<<ASSIGN  12249<<ASSIGN
     12314<<ASSIGN  12387<<ASSIGN  12452<<ASSIGN  12523<<ASSIGN  12595<<ASSIGN  12659<<ASSIGN  12725<<ASSIGN
     12791<<ASSIGN  12857<<ASSIGN  12923<<ASSIGN  12988<<ASSIGN  13053<<ASSIGN  13118<<ASSIGN  13191<<ASSIGN
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:151  
     13256<<ASSIGN  13329<<ASSIGN  13401<<ASSIGN  13473<<ASSIGN  13537<<ASSIGN  13602<<ASSIGN  13669<<ASSIGN
     13734<<ASSIGN  13798<<ASSIGN  13862<<ASSIGN  13928<<ASSIGN  13992<<ASSIGN  14060<<ASSIGN  14126<<ASSIGN
     14199<<ASSIGN  14266<<ASSIGN  14332<<ASSIGN  14407<<ASSIGN  14480<<ASSIGN  14549<<ASSIGN  14623<<ASSIGN
     14688<<ASSIGN  14761<<ASSIGN  14827<<ASSIGN  14898<<ASSIGN  14977<<ASSIGN  15041<<ASSIGN  15113<<ASSIGN
     15179<<ASSIGN  15249<<ASSIGN  15319<<ASSIGN  15391<<ASSIGN  15456<<ASSIGN  15528<<ASSIGN  15593<<ASSIGN
     15658<<ASSIGN  15731<<ASSIGN  15796<<ASSIGN  15863<<ASSIGN  15935<<ASSIGN  16001<<ASSIGN  16066<<ASSIGN
     16138<<ASSIGN  16220<<ASSIGN  16284<<ASSIGN  16355<<ASSIGN  16421<<ASSIGN  16494<<ASSIGN  16560<<ASSIGN
     16625<<ASSIGN  16703<<ASSIGN  16767<<ASSIGN  16832<<ASSIGN  16898<<ASSIGN  16963<<ASSIGN  17027<<ASSIGN
     17093<<ASSIGN  17157<<ASSIGN  17225<<ASSIGN  17301<<ASSIGN  17367<<ASSIGN  17432<<ASSIGN  17497<<ASSIGN
     17569<<ASSIGN  17638<<ASSIGN  17717<<ASSIGN  17784<<ASSIGN  17880<<ASSIGN  17948<<ASSIGN  18024<<ASSIGN
     18091<<ASSIGN
J IN PROCEDURE FIXITEMS
     18115**DCL     18161<<DOINDEX 18162>>IF      18163>>ASSIGN  18163>>ASSIGN
LEN IN PROCEDURE BUILDPDU
     18182**DCL     18180--IMP-SIZ 18199<<ASSIGN  18200>>IF      18206>>CALLBLT 18210>>CALLBLT 18216>>CALLBLT
     18225<<ASSIGN  18228<<ASSIGN  18235>>IF      18236>>CALLBLT 18236>>CALLBLT 18236>>CALLBLT 18240>>IF
     18241>>CALLBLT 18241>>CALLBLT 18244>>IF      18245>>CALLBLT 18245>>CALLBLT 18248>>CALLBLT 18251>>ASSIGN
LEN IN PROCEDURE FIXITEMS
     18116**DCL     18150<<ASSIGN  18155>>IF      18156<<ASSIGN  18156>>ASSIGN  18158<<ASSIGN  18158>>ASSIGN
     18163>>ASSIGN
LOADGT
     17821**PROC    11846--CALL    12054--CALL    12329--CALL    12537--CALL    13133--CALL    13271--CALL
     14422--CALL    15470--CALL    15877--CALL    17243--CALL
LOADPT
     17965**PROC    11982--CALL    12191--CALL    12465--CALL    13343--CALL    14565--CALL    14703--CALL
     15333--CALL    15673--CALL    16436--CALL
LOAD_GT_VALUE
     10491**DCL     17889>>IF
LOAD_PT_VALUE
     10492**DCL     18032>>IF
LVL IN PROCEDURE FIXITEMS
     18117**DCL     18118--REDEF   18159<<ASSIGN  18162>>IF
MAXSZ
     10493**DCL     14488<<ASSIGN  14490<<ASSIGN  14491>>IF      17577<<ASSIGN  17579<<ASSIGN  17580>>IF
PDUBUF
     10494**DCL     17807--ASSIGN  18195<<CALLBLT 18202<<CALLBLT 18206<<CALLBLT 18210<<CALLBLT 18216<<CALLBLT
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:152  
     18236<<CALLBLT 18241<<CALLBLT 18245<<CALLBLT 18248--CALLBLT
PDUIDX
     10495**DCL     17806>>ASSIGN  18188<<ASSIGN  18195>>CALLBLT 18196<<ASSIGN  18196>>ASSIGN  18202>>CALLBLT
     18203<<ASSIGN  18203>>ASSIGN  18206>>CALLBLT 18207<<ASSIGN  18207>>ASSIGN  18210>>CALLBLT 18211<<ASSIGN
     18211>>ASSIGN  18216>>CALLBLT 18217<<ASSIGN  18217>>ASSIGN  18236>>CALLBLT 18241>>CALLBLT 18245>>CALLBLT
     18248>>CALLBLT 18251<<ASSIGN  18251>>ASSIGN
PR_COMMON
     16188**LABEL   16156--GOTO    16159--GOTO
REASON
     10496**DCL     17164<<CALLBLT 17165<<CALLBLT 17216--ASSIGN
RF_COMMON
     16671**LABEL   16642--GOTO
SCTX.COMX
      8884**DCL     13609<>CALL
SCTX.FLAGS.VTCA
      9134**DCL     14487>>IF      17576>>IF
SCTX.FU
      9109**DCL     14206<<ASSIGN
SCTX.HEADX
      9188**DCL     14341>>IF      14342<>CALL    17798>>IF      17799<>CALL    17800<<ASSIGN
SCTX.HISTZ
      9177**DCL      9178--REDEF
SCTX.OWNED.DK
      8954**DCL     14140<<ASSIGN
SCTX.OWNED.MA
      8950**DCL     14136<<ASSIGN
SCTX.OWNED.MI
      8952**DCL     14138<<ASSIGN
SCTX.OWNED.TR
      8948**DCL     14134<<ASSIGN
SCTX.PO
      9143**DCL     11293>>ASSIGN  13850>>ASSIGN
SCTX.PT
      9148**DCL     16155<<ASSIGN  16158<<ASSIGN  16161<<ASSIGN  16272>>ASSIGN
SCTX.RPV
      8879**DCL     10835--ASSIGN
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:153  
SCTX.TD
      9165**DCL     10775>>ASSIGN  15037>>ASSIGN  17023>>ASSIGN
SCTX.TD.PRTER
      9168**DCL     10786>>IF
SCTX.TD.TCREL
      9170**DCL     10653<<ASSIGN  10656<<ASSIGN  14915<<ASSIGN  14918<<ASSIGN  16641<<ASSIGN  16644<<ASSIGN
SCTX.TD.USRAB
      9169**DCL     10851>>IF
SCTX.TSDUMS.INI
      9161**DCL     11312>>IF      11359>>ASSIGN  13869>>IF      13916>>ASSIGN  14490>>ASSIGN  17579>>ASSIGN
SCTX.TSDUMS.RSP
      9162**DCL     11312>>IF      11359>>ASSIGN  13869>>IF      13916>>ASSIGN  14488>>ASSIGN  17577>>ASSIGN
SCTX.VM
      9141**DCL     12302>>ASSIGN  15444>>ASSIGN
SCTX.VN
      9147**DCL     11423>>ASSIGN  13980>>ASSIGN  17145>>ASSIGN
SCTX$
     10497**DCL      8863--IMP-PTR 10504<<ASSIGN  10653>>ASSIGN  10656>>ASSIGN  10775>>ASSIGN  10786>>IF
     10835>>ASSIGN  10851>>IF      11293>>ASSIGN  11312>>IF      11312>>IF      11359>>ASSIGN  11359>>ASSIGN
     11423>>ASSIGN  12302>>ASSIGN  13609>>CALL    13850>>ASSIGN  13869>>IF      13869>>IF      13916>>ASSIGN
     13916>>ASSIGN  13980>>ASSIGN  14134>>ASSIGN  14136>>ASSIGN  14138>>ASSIGN  14140>>ASSIGN  14206>>ASSIGN
     14341>>IF      14342>>CALL    14487>>IF      14488>>ASSIGN  14490>>ASSIGN  14915>>ASSIGN  14918>>ASSIGN
     15037>>ASSIGN  15444>>ASSIGN  16155>>ASSIGN  16158>>ASSIGN  16161>>ASSIGN  16272>>ASSIGN  16641>>ASSIGN
     16644>>ASSIGN  17023>>ASSIGN  17145>>ASSIGN  17576>>IF      17577>>ASSIGN  17579>>ASSIGN  17798>>IF
     17799>>CALL    17800>>ASSIGN
SFPT$
     10498**DCL      4597--IMP-PTR  4743--IMP-PTR  4841--IMP-PTR  4992--IMP-PTR  5090--IMP-PTR  5316--IMP-PTR
      5479--IMP-PTR  5625--IMP-PTR  5948--IMP-PTR  6072--IMP-PTR  6216--IMP-PTR  6360--IMP-PTR  6446--IMP-PTR
      6532--IMP-PTR  6684--IMP-PTR  6897--IMP-PTR  7056--IMP-PTR  7215--IMP-PTR  7345--IMP-PTR  7537--IMP-PTR
      7681--IMP-PTR  7825--IMP-PTR 10505<<ASSIGN  11037>>ASSIGN  11053>>IF      11103>>ASSIGN  11119>>IF
     11165>>ASSIGN  11442>>IF      11442>>IF      11442>>IF      11442>>IF      11491>>ASSIGN  11510>>IF
     11565>>ASSIGN  11630>>ASSIGN  11695>>ASSIGN  11706>>IF      11756>>ASSIGN  11772>>IF      11822>>ASSIGN
     11957>>ASSIGN  12165>>ASSIGN  12440>>ASSIGN  12666>>IF      12716>>ASSIGN  12732>>IF      12782>>ASSIGN
     12798>>IF      12848>>ASSIGN  12864>>IF      12911>>ASSIGN  12979>>ASSIGN  13041>>ASSIGN  13109>>ASSIGN
     13247>>ASSIGN  13593>>ASSIGN  13609>>CALL    13610>>IF      13660>>ASSIGN  13676>>IF      13722>>ASSIGN
     13999>>IF      13999>>IF      13999>>IF      13999>>IF      14048>>ASSIGN  14067>>IF      14122>>ASSIGN
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:154  
     14133>>IF      14135>>IF      14137>>IF      14139>>IF      14195>>ASSIGN  14206>>ASSIGN  14207>>IF
     14257>>ASSIGN  14273>>IF      14323>>ASSIGN  14342>>CALL    14676>>ASSIGN  14818>>ASSIGN  14827>>ASSIGN
     15120>>IF      15175>>ASSIGN  15581>>ASSIGN  15646>>ASSIGN  15784>>ASSIGN  15803>>IF      15854>>ASSIGN
     15863>>ASSIGN  15942>>IF      15989>>ASSIGN  16054>>ASSIGN  16362>>IF      16417>>ASSIGN  16501>>IF
     16556>>ASSIGN  16613>>ASSIGN  16823>>ASSIGN  16839>>IF      16889>>ASSIGN  16905>>IF      16951>>ASSIGN
     17034>>IF      17089>>ASSIGN  17164>>CALLBLT 17165>>CALLBLT 17165>>CALLBLT 17225>>ASSIGN  17308>>IF
     17363>>ASSIGN  17420>>ASSIGN  17485>>ASSIGN  17656>>IF      17708>>ASSIGN  17717>>ASSIGN  17775>>ASSIGN
     17784>>ASSIGN
TEMP IN PROCEDURE FIXITEMS
     18118**DCL     18135<<ASSIGN  18137--ASSIGN  18137--ASSIGN  18137--ASSIGN  18137--ASSIGN  18143<<ASSIGN
     18144--ASSIGN  18144--ASSIGN  18144--ASSIGN  18144--ASSIGN
TEXT
     10499**DCL     14818--ASSIGN  15854--ASSIGN  17165>>CALLBLT 17708--ASSIGN  17775--ASSIGN
TXTC
     10500**DCL     11103--ASSIGN  12848--ASSIGN  13660--ASSIGN  16889--ASSIGN
TXTC.LEN
     10501**DCL     10502--IMP-SIZ 11053>>IF      12798>>IF      13610>>IF      16839>>IF
UADR.NSAP.ADDRESS_N
     10315**DCL     10316--REDEF
UADR.PSAP
     10091**DCL     11037--ASSIGN  12716--ASSIGN  12782--ASSIGN  13593--ASSIGN  16823--ASSIGN
UADR.PSAP.LEN
     10122**DCL     12666>>IF      12732>>IF
UADR.SSAP
     10154**DCL     11756--ASSIGN  11822--ASSIGN  14257--ASSIGN  14323--ASSIGN
UADR.SSAP.LEN
     10172**DCL     11706>>IF      11772>>IF      14207>>IF      14273>>IF
VBLK
      9296**DCL        15--PROC    17808<>CALL
VBLK.CTX$
      9304**DCL     10504>>ASSIGN
VBLK.DAT.PTR$
      9380**DCL     17794<<ASSIGN  18232<<ASSIGN
VBLK.DAT.SIZE
      9381**DCL     17793<<ASSIGN  18231<<ASSIGN
VBLK.EI
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:155  
      9307**DCL     14545>>ASSIGN  17634>>ASSIGN
VBLK.EI.EOSSDU
      9310**DCL     17887>>IF
VBLK.EVENT
      9314**DCL     10574>>DOCASE  17797>>IF      17887>>IF
VBLK.FPT$
      9315**DCL     10505>>ASSIGN
VBLK.PDU.PTR$
      9347**DCL     17807<<ASSIGN
VBLK.PDU.SIZE
      9348**DCL     17806<<ASSIGN
XSS$ACTIVITY_DISCARD.ERRDEF
      4787**DCL      4813--REDEF
XSS$ACTIVITY_DISCARD.REASON
      4785**DCL     11957>>ASSIGN
XSS$ACTIVITY_END.ERRDEF
      4877**DCL      4897--REDEF
XSS$ACTIVITY_END.SERNUM
      4973**DCL     12165>>ASSIGN
XSS$ACTIVITY_INTERRUPT.ERRDEF
      5042**DCL      5062--REDEF
XSS$ACTIVITY_INTERRUPT.REASON
      5034**DCL     12440>>ASSIGN
XSS$ACTIVITY_RESUME.ACTID
      5279**DCL     13109--ASSIGN
XSS$ACTIVITY_RESUME.ARI
      5297**DCL     12864>>IF      12911>>ASSIGN
XSS$ACTIVITY_RESUME.CALLED$
      5253**DCL     12666>>IF      12716>>ASSIGN
XSS$ACTIVITY_RESUME.CALLING$
      5244**DCL     12732>>IF      12782>>ASSIGN
XSS$ACTIVITY_RESUME.COMMON$
      5235**DCL     12798>>IF      12848>>ASSIGN
XSS$ACTIVITY_RESUME.ERRDEF
      5129**DCL      5149--REDEF
XSS$ACTIVITY_RESUME.OACTID
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:156  
      5289**DCL     12979--ASSIGN
XSS$ACTIVITY_RESUME.SERNUM
      5225**DCL     13041>>ASSIGN
XSS$ACTIVITY_START.ACTID
      5458**DCL     13247--ASSIGN
XSS$ACTIVITY_START.ERRDEF
      5350**DCL      5370--REDEF
XSS$BUFPTR
     10455**DCL-ENT 13609--CALL    14342--CALL
XSS$CAPABILITY_DATA.ERRDEF
      5515**DCL      5535--REDEF
XSS$CONNECT.ARI
      5929**DCL     11119>>IF      11165>>ASSIGN  13676>>IF      13722>>ASSIGN  16905>>IF      16951>>ASSIGN
XSS$CONNECT.CALLED$
      5851**DCL      5852--REDEF   14273>>IF      14323>>ASSIGN
XSS$CONNECT.CALLING$
      5834**DCL     11706>>IF      11756>>ASSIGN  13593>>ASSIGN  14207>>IF      14257>>ASSIGN
XSS$CONNECT.COMMON$
      5825**DCL     11053>>IF      11103>>ASSIGN  13609<>CALL    13610>>IF      13660>>ASSIGN  16839>>IF
     16889>>ASSIGN
XSS$CONNECT.DATA.PTR$
      5797**DCL     14342<>CALL    17165>>CALLBLT
XSS$CONNECT.DATA.SIZE
      5803**DCL     17165>>CALLBLT 17225>>ASSIGN
XSS$CONNECT.ERRDEF
      5719**DCL      5739--REDEF
XSS$CONNECT.ITOKENS
      5868**DCL     11510>>IF      11565>>ASSIGN  14067>>IF      14122>>ASSIGN
XSS$CONNECT.ITOKENS.DK
      5872**DCL     14139>>IF
XSS$CONNECT.ITOKENS.MA
      5870**DCL     14135>>IF
XSS$CONNECT.ITOKENS.MI
      5871**DCL     14137>>IF
XSS$CONNECT.ITOKENS.TR
      5869**DCL     14133>>IF
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:157  
XSS$CONNECT.REASON
      5667**DCL     17034>>IF      17164>>CALLBLT
XSS$CONNECT.RESPONDING$
      5852**DCL     11037>>ASSIGN  11772>>IF      11822>>ASSIGN  16823>>ASSIGN
XSS$CONNECT.SERNUM
      5815**DCL     11491>>ASSIGN  14048>>ASSIGN
XSS$CONNECT.SFU
      5904**DCL     11695>>ASSIGN  14195>>ASSIGN  14206>>ASSIGN  17089>>ASSIGN
XSS$CONNECT.SFU.ACT
      5910**DCL     11442>>IF      13999>>IF
XSS$CONNECT.SFU.MA
      5912**DCL     11442>>IF      13999>>IF
XSS$CONNECT.SFU.RESYN
      5911**DCL     11442>>IF      13999>>IF
XSS$CONNECT.SFU.SY
      5913**DCL     11442>>IF      13999>>IF
XSS$CONNECT.TOKENS
      5695**DCL     11630>>ASSIGN
XSS$CONTROL_GIVE.ERRDEF
      6024**DCL      6044--REDEF
XSS$DATA.ERRDEF
      6106**DCL      6126--REDEF
XSS$EXPEDITED_DATA.ERRDEF
      6250**DCL      6270--REDEF
XSS$GENERIC.DATA.PTR$
      4715**DCL     14818>>ASSIGN  15803>>IF      15854>>ASSIGN  17656>>IF      17708>>ASSIGN  17775>>ASSIGN
XSS$GENERIC.DATA.SIZE
      4721**DCL     14827>>ASSIGN  15863>>ASSIGN  17717>>ASSIGN  17784>>ASSIGN
XSS$GENERIC.ERRDEF
      4651**DCL      4671--REDEF
XSS$P_ABORT.ERRDEF
      6398**DCL      6418--REDEF
XSS$P_EXCEPTION_REPORT.ERRDEF
      6484**DCL      6504--REDEF
XSS$RELEASE.ERRDEF
      6574**DCL      6594--REDEF
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:158  
XSS$RELMEM
     10456**DCL-ENT 17799--CALL
XSS$RESYNCHRONIZE.ERRDEF
      6782**DCL      6802--REDEF
XSS$RESYNCHRONIZE.SERNUM
      6878**DCL     16613>>ASSIGN  17485>>ASSIGN
XSS$RESYNCHRONIZE.TOKENS
      6758**DCL     16501>>IF      16556>>ASSIGN  17308>>IF      17363>>ASSIGN
XSS$RESYNCHRONIZE.TYPE
      6722**DCL     17420>>ASSIGN
XSS$SCREECH
     10457**DCL-ENT 17653--CALL
XSS$SYNC_MAJOR.ERRDEF
      6941**DCL      6961--REDEF
XSS$SYNC_MAJOR.SERNUM
      7037**DCL     15646>>ASSIGN
XSS$SYNC_MAJOR.TYPE
      6933**DCL     15581>>ASSIGN
XSS$SYNC_MINOR.ERRDEF
      7100**DCL      7120--REDEF
XSS$SYNC_MINOR.SERNUM
      7196**DCL     15784>>ASSIGN  16054>>ASSIGN
XSS$SYNC_MINOR.TYPE
      7092**DCL     15942>>IF      15989>>ASSIGN
XSS$TOKEN_GIVE.ERRDEF
      7297**DCL      7317--REDEF
XSS$TOKEN_GIVE.TOKENS
      7273**DCL     15120>>IF      15175>>ASSIGN
XSS$TOKEN_PLEASE.ERRDEF
      7427**DCL      7447--REDEF
XSS$TOKEN_PLEASE.TOKENS
      7403**DCL     16362>>IF      16417>>ASSIGN
XSS$TSEND
     10458**DCL-ENT 17808--CALL
XSS$TYPED_DATA.ERRDEF
      7571**DCL      7591--REDEF
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:159  
XSS$U_ABORT.ERRDEF
      7715**DCL      7735--REDEF
XSS$U_EXCEPTION_REPORT.ERRDEF
      7864**DCL      7884--REDEF
XSS$U_EXCEPTION_REPORT.REASON
      7856**DCL     14676>>ASSIGN
XSS_F$ENCODE
     10416**DCL     17653<>CALL
XSS_ITEMCNT
     10460**DCL     10508<<ASSIGN  10567>>ASSIGN  10570<<ASSIGN  10570>>ASSIGN  10639>>ASSIGN  10642<<ASSIGN
     10642>>ASSIGN  10715>>ASSIGN  10718<<ASSIGN  10718>>ASSIGN  10775>>ASSIGN  10779>>ASSIGN  10782<<ASSIGN
     10782>>ASSIGN  10835>>ASSIGN  10844>>ASSIGN  10847<<ASSIGN  10847>>ASSIGN  10917>>ASSIGN  10920<<ASSIGN
     10920>>ASSIGN  10981>>ASSIGN  10984<<ASSIGN  10984>>ASSIGN  11037>>ASSIGN  11046>>ASSIGN  11049<<ASSIGN
     11049>>ASSIGN  11103>>ASSIGN  11112>>ASSIGN  11115<<ASSIGN  11115>>ASSIGN  11165>>ASSIGN  11177>>ASSIGN
     11180<<ASSIGN  11180>>ASSIGN  11241>>ASSIGN  11244<<ASSIGN  11244>>ASSIGN  11293>>ASSIGN  11305>>ASSIGN
     11308<<ASSIGN  11308>>ASSIGN  11359>>ASSIGN  11371>>ASSIGN  11374<<ASSIGN  11374>>ASSIGN  11423>>ASSIGN
     11435>>ASSIGN  11438<<ASSIGN  11438>>ASSIGN  11491>>ASSIGN  11503>>ASSIGN  11506<<ASSIGN  11506>>ASSIGN
     11565>>ASSIGN  11569>>ASSIGN  11572<<ASSIGN  11572>>ASSIGN  11630>>ASSIGN  11634>>ASSIGN  11637<<ASSIGN
     11637>>ASSIGN  11695>>ASSIGN  11699>>ASSIGN  11702<<ASSIGN  11702>>ASSIGN  11756>>ASSIGN  11765>>ASSIGN
     11768<<ASSIGN  11768>>ASSIGN  11822>>ASSIGN  11831>>ASSIGN  11834<<ASSIGN  11834>>ASSIGN  11904>>ASSIGN
     11907<<ASSIGN  11907>>ASSIGN  11957>>ASSIGN  11969>>ASSIGN  11972<<ASSIGN  11972>>ASSIGN  12040>>ASSIGN
     12043<<ASSIGN  12043>>ASSIGN  12112>>ASSIGN  12115<<ASSIGN  12115>>ASSIGN  12165>>ASSIGN  12177>>ASSIGN
     12180<<ASSIGN  12180>>ASSIGN  12249>>ASSIGN  12252<<ASSIGN  12252>>ASSIGN  12302>>ASSIGN  12314>>ASSIGN
     12317<<ASSIGN  12317>>ASSIGN  12387>>ASSIGN  12390<<ASSIGN  12390>>ASSIGN  12440>>ASSIGN  12452>>ASSIGN
     12455<<ASSIGN  12455>>ASSIGN  12523>>ASSIGN  12526<<ASSIGN  12526>>ASSIGN  12595>>ASSIGN  12598<<ASSIGN
     12598>>ASSIGN  12659>>ASSIGN  12662<<ASSIGN  12662>>ASSIGN  12716>>ASSIGN  12725>>ASSIGN  12728<<ASSIGN
     12728>>ASSIGN  12782>>ASSIGN  12791>>ASSIGN  12794<<ASSIGN  12794>>ASSIGN  12848>>ASSIGN  12857>>ASSIGN
     12860<<ASSIGN  12860>>ASSIGN  12911>>ASSIGN  12923>>ASSIGN  12926<<ASSIGN  12926>>ASSIGN  12979>>ASSIGN
     12988>>ASSIGN  12991<<ASSIGN  12991>>ASSIGN  13041>>ASSIGN  13053>>ASSIGN  13056<<ASSIGN  13056>>ASSIGN
     13109>>ASSIGN  13118>>ASSIGN  13121<<ASSIGN  13121>>ASSIGN  13191>>ASSIGN  13194<<ASSIGN  13194>>ASSIGN
     13247>>ASSIGN  13256>>ASSIGN  13259<<ASSIGN  13259>>ASSIGN  13329>>ASSIGN  13332<<ASSIGN  13332>>ASSIGN
     13401>>ASSIGN  13404<<ASSIGN  13404>>ASSIGN  13473>>ASSIGN  13476<<ASSIGN  13476>>ASSIGN  13537>>ASSIGN
     13540<<ASSIGN  13540>>ASSIGN  13593>>ASSIGN  13602>>ASSIGN  13605<<ASSIGN  13605>>ASSIGN  13660>>ASSIGN
     13669>>ASSIGN  13672<<ASSIGN  13672>>ASSIGN  13722>>ASSIGN  13734>>ASSIGN  13737<<ASSIGN  13737>>ASSIGN
     13798>>ASSIGN  13801<<ASSIGN  13801>>ASSIGN  13850>>ASSIGN  13862>>ASSIGN  13865<<ASSIGN  13865>>ASSIGN
     13916>>ASSIGN  13928>>ASSIGN  13931<<ASSIGN  13931>>ASSIGN  13980>>ASSIGN  13992>>ASSIGN  13995<<ASSIGN
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:160  
     13995>>ASSIGN  14048>>ASSIGN  14060>>ASSIGN  14063<<ASSIGN  14063>>ASSIGN  14122>>ASSIGN  14126>>ASSIGN
     14129<<ASSIGN  14129>>ASSIGN  14195>>ASSIGN  14199>>ASSIGN  14202<<ASSIGN  14202>>ASSIGN  14257>>ASSIGN
     14266>>ASSIGN  14269<<ASSIGN  14269>>ASSIGN  14323>>ASSIGN  14332>>ASSIGN  14335<<ASSIGN  14335>>ASSIGN
     14407>>ASSIGN  14410<<ASSIGN  14410>>ASSIGN  14480>>ASSIGN  14483<<ASSIGN  14483>>ASSIGN  14545>>ASSIGN
     14549>>ASSIGN  14552<<ASSIGN  14552>>ASSIGN  14623>>ASSIGN  14626<<ASSIGN  14626>>ASSIGN  14676>>ASSIGN
     14688>>ASSIGN  14691<<ASSIGN  14691>>ASSIGN  14761>>ASSIGN  14764<<ASSIGN  14764>>ASSIGN  14818>>ASSIGN
     14827>>ASSIGN  14830<<ASSIGN  14830>>ASSIGN  14898>>ASSIGN  14901<<ASSIGN  14901>>ASSIGN  14977>>ASSIGN
     14980<<ASSIGN  14980>>ASSIGN  15037>>ASSIGN  15041>>ASSIGN  15044<<ASSIGN  15044>>ASSIGN  15113>>ASSIGN
     15116<<ASSIGN  15116>>ASSIGN  15175>>ASSIGN  15179>>ASSIGN  15182<<ASSIGN  15182>>ASSIGN  15249>>ASSIGN
     15252<<ASSIGN  15252>>ASSIGN  15319>>ASSIGN  15322<<ASSIGN  15322>>ASSIGN  15391>>ASSIGN  15394<<ASSIGN
     15394>>ASSIGN  15444>>ASSIGN  15456>>ASSIGN  15459<<ASSIGN  15459>>ASSIGN  15528>>ASSIGN  15531<<ASSIGN
     15531>>ASSIGN  15581>>ASSIGN  15593>>ASSIGN  15596<<ASSIGN  15596>>ASSIGN  15646>>ASSIGN  15658>>ASSIGN
     15661<<ASSIGN  15661>>ASSIGN  15731>>ASSIGN  15734<<ASSIGN  15734>>ASSIGN  15784>>ASSIGN  15796>>ASSIGN
     15799<<ASSIGN  15799>>ASSIGN  15854>>ASSIGN  15863>>ASSIGN  15866<<ASSIGN  15866>>ASSIGN  15935>>ASSIGN
     15938<<ASSIGN  15938>>ASSIGN  15989>>ASSIGN  16001>>ASSIGN  16004<<ASSIGN  16004>>ASSIGN  16054>>ASSIGN
     16066>>ASSIGN  16069<<ASSIGN  16069>>ASSIGN  16138>>ASSIGN  16141<<ASSIGN  16141>>ASSIGN  16220>>ASSIGN
     16223<<ASSIGN  16223>>ASSIGN  16272>>ASSIGN  16284>>ASSIGN  16287<<ASSIGN  16287>>ASSIGN  16355>>ASSIGN
     16358<<ASSIGN  16358>>ASSIGN  16417>>ASSIGN  16421>>ASSIGN  16424<<ASSIGN  16424>>ASSIGN  16494>>ASSIGN
     16497<<ASSIGN  16497>>ASSIGN  16556>>ASSIGN  16560>>ASSIGN  16563<<ASSIGN  16563>>ASSIGN  16613>>ASSIGN
     16625>>ASSIGN  16628<<ASSIGN  16628>>ASSIGN  16703>>ASSIGN  16706<<ASSIGN  16706>>ASSIGN  16767>>ASSIGN
     16770<<ASSIGN  16770>>ASSIGN  16823>>ASSIGN  16832>>ASSIGN  16835<<ASSIGN  16835>>ASSIGN  16889>>ASSIGN
     16898>>ASSIGN  16901<<ASSIGN  16901>>ASSIGN  16951>>ASSIGN  16963>>ASSIGN  16966<<ASSIGN  16966>>ASSIGN
     17023>>ASSIGN  17027>>ASSIGN  17030<<ASSIGN  17030>>ASSIGN  17089>>ASSIGN  17093>>ASSIGN  17096<<ASSIGN
     17096>>ASSIGN  17145>>ASSIGN  17157>>ASSIGN  17160<<ASSIGN  17160>>ASSIGN  17216>>ASSIGN  17225>>ASSIGN
     17228<<ASSIGN  17228>>ASSIGN  17301>>ASSIGN  17304<<ASSIGN  17304>>ASSIGN  17363>>ASSIGN  17367>>ASSIGN
     17370<<ASSIGN  17370>>ASSIGN  17420>>ASSIGN  17432>>ASSIGN  17435<<ASSIGN  17435>>ASSIGN  17485>>ASSIGN
     17497>>ASSIGN  17500<<ASSIGN  17500>>ASSIGN  17569>>ASSIGN  17572<<ASSIGN  17572>>ASSIGN  17634>>ASSIGN
     17638>>ASSIGN  17641<<ASSIGN  17641>>ASSIGN  17708>>ASSIGN  17717>>ASSIGN  17720<<ASSIGN  17720>>ASSIGN
     17775>>ASSIGN  17784>>ASSIGN  17787<<ASSIGN  17787>>ASSIGN  17880>>ASSIGN  17883<<ASSIGN  17883>>ASSIGN
     17944>>ASSIGN  17948>>ASSIGN  17951<<ASSIGN  17951>>ASSIGN  18024>>ASSIGN  18027<<ASSIGN  18027>>ASSIGN
     18087>>ASSIGN  18091>>ASSIGN  18094<<ASSIGN  18094>>ASSIGN  18120>>DOINDEX 18189<<ASSIGN  18189>>ASSIGN
     18191>>DOINDEX
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:161  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=XSS$ENCODE File=XSS$ENCODE.:XSA1TSI                           WED 10/01/97 12:17 Page:162  
              MINI UREF LISTING

XSS$ENCODE      15**PROC
XSS_ITEMMAX   10461**DCL
