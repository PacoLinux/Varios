VERSION E05

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:1    
        1        1        /*M* GJA$ADMIN - Node Administrator main routine.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0,CRM=70  */
        8        8        /*P*    NAME:   GJA$ADMIN
        9        9                PURPOSE: This module contains the node admin init routine as
       10       10                         well as the routine that co_ordinates node admin
       11       11                         processing.
       12       12        */
       13       13
       14       14
       15       15        /*F*  NAME:    GJA$ADMIN
       16       16
       17       17              PURPOSE: This routine co-ordinates node admin processing.  Its
       18       18                       gets entered when there are messages to process in the
       19       19                       node admin receive circular queue.
       20       20
       21       21              DESCRIPTION: This routine gets entered at system startup and
       22       22                           initializes the node administrator.  It sets up
       23       23                           node admins CQ and issues a connect to the network
       24       24                           manager.
       25       25
       26       26                           GJA$ADMIN then scans the receive circular queue
       27       27                           processing messages one at a time.  When a message
       28       28                           is decoded, it is either handled here or a seperate
       29       29                           routine is called to do the processing.  When the
       30       30                           receive queue is depleted, we write out the send
       31       31                           circular queue and go to sleep.
       32       32        */
       33       33        GJA$ADMIN: PROC MAIN;
       34       34
       35       35        %INCLUDE G_JIT_M;
       36      300        %INCLUDE LCP_6;
       37     4579        %INCLUDE G$BOBCAT_M;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:2    
       38     4599        %INCLUDE GJA_MSG_M;                /* Node Admin message macros     */
       39     4838        %INCLUDE GM_VIRTUAL_E;
       40     5048        %INCLUDE KH$CLK;
       41     5418        %INCLUDE KH$CHN;
       42     5540        %INCLUDE K_ADDRESS_M;
       43     6043        %INCLUDE KN_ERRORS_C;
       44     6107        %INCLUDE KH_MACRO_C;
       45     6850        %INCLUDE KI_ERRORS_C;
       46     6935        %INCLUDE KL_AFCN_C;                     /* 'IGA' Function Codes     */
       47     7036        %INCLUDE KL_CONTROL_C;
       48     7416        %INCLUDE KL_MACRO_C;               /* Application message formats   */
       49    10768        %INCLUDE KNN_NETWORK_M;
       50    11131        %INCLUDE K_REASON_C;
       51    11157        %INCLUDE KNH_MACRO_C;                   /* CQ macros                */
       52    11440        %INCLUDE KV$VDH;
       53    11871        %INCLUDE KV$VDO;
       54    12886
       55    12887                                                /* EQUs and SUBs            */
       56    12888        %KV_VDO_ALL_E;
       57    12967        %GJA_UID_EQUS;
       58    12975        %G$JIT_E;
       59    13037                                                /* FPTs                     */
       60    13038        %FPT_SPRIV (PRC=YES,AUTH=YES,PRIV=PRIVS);
       61    13061        %FPT_CVM (FPTN=GET_BOBCAT,FROMSEG=FROMSEG,USERSEG=USERSEG,TYPE=MON,PAGES=256);
       62    13085        %VLP_SEGMENT(FPTN=USERSEG);
       63    13106        %VLP_SEGMENT(FPTN=FROMSEG);
       64    13127        %FPT_GDS(FPTN=FPT_GETMEM,FREE=YES,NEXT=BIG,PAGES=20,RESULTS=GJA_MEMORY_RESULTS);
       65    13151        %VLP_SEGMENT(FPTN=GJA_MEMORY_RESULTS);
       66    13172        %FPT_OPEN(FPTN=FPT_CQOPEN,ORG=CQ,HMI=VLP_HMI,DCB=M$CQ);
       67    13200        %VLP_HMI(RCQSIZE=4096,SCQSIZE=4096);
       68    13216        %FPT_TRAP (NTC=VLP_TRAP_CONDITIONS);
       69    13231        %VLP_TRAP_CONDITIONS (IGN_IO=G_YES#);
       70    13387        %FPT_WRTMLT(DCB=M$CQ);
       71    13407        %KL_SYSLOG(FPTN=GJA_SYSLOG,LAST=",",STCLASS=SYMREF);
       72    13431        %KL_ERRLOG(FPTN=ERRLOG,LAST=",",LVL=2,STCLASS=SYMREF);
       73    13539    1           3 DATA CHAR(200) UNAL;
       74    13540        %VLP_ERRCODE(FPTN=E$READ_ERR,FCG=GJ,MID=A,MON='1'B,ERR#=%E$READ_ERR,SEV=
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:3    
             13540            %G_SEV_ERROR#);
       75    13586        /*E* ERROR: GJA-E$READ_ERR
       76    13587             MESSAGE: Read complete without read pending.
       77    13588             MESSAGE1: nodeadmn received data from a logon connection which
       78    13589                       had no read out standing.  the message has been discarded.*/
       79    13590
       80    13591        /*E* ERROR: GJA-E$LINK_UP
       81    13592             MESSAGE: X.25 link is now active. VALUE(0) is connecting node#.
       82    13593             MESSAGE1: An X.25 link to or from a remote fep is now active.*/
       83    13594
       84    13595        /*E* ERROR: GJA-E$LINK_DOWN
       85    13596             MESSAGE: X.25 link is now inactive.  Value(0) is disconnecting node#.
       86    13597             MESSAGE1: An X.25 link to or from a remote fep is now inactive.*/
       87    13598
       88    13599        %FPT_TIME(SOURCE=CLOCK,DEST=UTS);
       89    13623    1   DCL B$PTR$ PTR BASED;
       90    13624                                                /* Internal Data            */
       91    13625    1   DCL PRIVS BIT(32) CONSTANT INIT(
       92    13626    1   %(G_PR_MSYS#|G_PR_CQ#|G_PR_SCREECH#|G_PR_SNAP#|G_PR_EXMM#|G_PR_SPCLMM#));
       93    13627        %KL_MES (FPTN=GJA_KL_MES,STCLASS=CONSTANT,CODE=IGA_INIT_DONE);
       94    13650        %KV$VDH_VDHINT(STCLASS=STATIC,BUSYBFRS=YES,BITMAPBFRS=YES,VLDBFR=YES,VLDAFTRLS=YES,
             13650            VLDAFTGET=YES);
       95    13669    1   DCL KH_CTLTBL$ PTR SYMREF;
       96    13670        %KV_VDOBYTSIZ (NAME=GJA_VDOBYTSIZ,STCLASS=SYMREF);
       97    13690        %KV$VDO_MRK (NAME=GJA_VDO_MRK,LAST=",",STCLASS=SYMREF);
       98    13731             %KV$VDOVLP_MRK (NAME=MRK,LVL=2);
       99    13784        %KV$VDO_DAT (NAME=GJA_LDDAT,STCLASS=SYMREF,LAST=",");
      100    13829             %KV$VDOVLP_ERR(NAME=ERR,STCLASS=SYMREF,LST=YES,LVL=2);
      101    13926        %KV$VDO_RQSDAT(NAME=KV_VDO_RQSDAT,FNC=KV_VDO_FNC_RQSDAT,
      102    13927                       MAXRCRBYTSIZ=4096,MAXNMBRCR=999,MAXNMBBYT=4096,
      103    13928                       STCLASS=CONSTANT);
      104    13976        %KH$EXP (FPTN=KH_EXP,STCLASS=STATIC);
      105    14039        %KH$CTLTBL (FPTN=CTLTBL,STCLASS=STATIC,HIPARM=%KL_NA_HI);
      106    14251        %KV$VDO_DAT(NAME=VDO_NODAT,STCLASS=CONSTANT,LAST=",",VLP=YES,FNC=KV_VDO_FNC_DAT);
      107    14296             %KV$VDOVLP_ERR (NAME=ERR,FCG=GJ,MID=A,MON='1'B,ERR#=%E$NODAT,SEV=0,STCLASS=
             14296                 CONSTANT,LVL=2);
      108    14393
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:4    
      109    14394
      110    14395                                                /* External Data            */
      111    14396    1   DCL G$DS1$ PTR SYMREF;
      112    14397    1   DCL G$DS4$ PTR SYMREF;
      113    14398    1   DCL GID_BOOTCHAN UBIN SYMREF;
      114    14399    1   DCL GJA_FIRST_TIME BIT(1) SYMREF;
      115    14400    1   DCL GJA_INTLEV UBIN SYMREF;
      116    14401    1   DCL GJA_ATTR UBIN SYMREF;
      117    14402    1   DCL ATTR UBIN(16);
      118    14403    1   DCL GJA_LDCT_NM UBIN SYMREF;
      119    14404    1   DCL GJA_LDCT_BABOON UBIN SYMREF;
      120    14405    1   DCL GJA_MAXNODE UBIN SYMREF;
      121    14406    1   DCL GJA_UID_NM UBIN(32) SYMREF;
      122    14407    1   DCL GJA_UID_NM$ REDEF GJA_UID_NM PTR;
      123    14408    1   DCL GJA_UID_BABOON UBIN(32) SYMREF;
      124    14409    1   DCL GJA_UID_BABOON$ REDEF GJA_UID_BABOON PTR;
      125    14410    1   DCL GJA_USRLGN_HEAD$ PTR SYMREF;
      126    14411    1   DCL GJA_HAND_HEAD$ PTR SYMREF;
      127    14412    1   DCL GJA_HOPCOST UBIN SYMREF;
      128    14413    1   DCL GJA_ROUTE$ PTR SYMREF;
      129    14414    1   DCL GJA_OSIROUTE$ PTR SYMREF;      /* ptr to array of osiroute ptrs */
      130    14415    1   DCL GJA_OSIMAX# UBIN SYMREF;
      131    14416    1   DCL GJA_LINKS UBIN SYMREF;
      132    14417    1   DCL GJA_LINK$ PTR SYMREF;
      133    14418    1   DCL GJA_NM_HEAD$ PTR SYMREF;
      134    14419    1   DCL GJA_NODE# UBIN SYMREF;
      135    14420    1   DCL GJA_CHNLOW$ PTR SYMREF;
      136    14421    1   DCL GJA_NODENAME CHAR(8) SYMREF;
      137    14422    1   DCL GJA_CHNHI$ PTR SYMREF;
      138    14423    1   DCL GJA_CHNLOW UBIN SYMREF;
      139    14424    1   DCL GJA_CHNHI UBIN SYMREF;
      140    14425    1   DCL GJA_CHNFREE$ PTR SYMREF;
      141    14426    1   DCL GJA_RETRYMAX UBIN SYMREF;
      142    14427    1   DCL GJA_UID_NANM$ PTR SYMREF;
      143    14428    1   DCL G$HAND_Q$ PTR SYMREF;
      144    14429    1   DCL GJA_DEFNODE UBIN SYMREF;
      145    14430    1   DCL GJA_HSTRSMED BIT(1) SYMREF;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:5    
      146    14431    1   DCL GJA_MAXRDS UBIN SYMREF;
      147    14432    1   DCL GJA_MSG_SGSYN$ PTR SYMREF;
      148    14433    1   DCL GJA_MSG_BDID$ PTR SYMREF;
      149    14434    1   DCL GJA_MSG_NOHOST$ PTR SYMREF;
      150    14435    1   DCL GJA_MSG_UDHOST$ PTR SYMREF;
      151    14436    1   DCL GJA_RCQSIZE UBIN SYMREF;
      152    14437    1   DCL GJA_SCQSIZE UBIN SYMREF;
      153    14438    1   DCL GJA_MEMORY UBIN SYMREF;
      154    14439        %FPT_TERM(FPTN=GJA_TERM,STCLASS=SYMREF);
      155    14461        %FPT_TERM_ACK(FPTN=GJA_TERM_ACK,STCLASS=SYMREF);
      156    14483        %FPT_CONNECT(FPTN=GJA_CONNECT,STCLASS=SYMREF);
      157    14552        %FPT_CONNECT_ACK (FPTN=GJA_CONNECT_ACK,STCLASS=SYMREF);
      158    14601        %KV$VDO_DAT (NAME=GJA_VDO_DAT_DAT2,STCLASS=SYMREF);
      159    14646
      160    14647
      161    14648                                                /* BASED                    */
      162    14649    1   DCL B$DWORD UBIN(32) BASED ALIGNED;
      163    14650    1   DCL KNN$ROUTE$(0:0) PTR BASED(GJA_ROUTE$);
      164    14651    1   DCL KNN$LINK$(0:0) PTR BASED(GJA_LINK$);
      165    14652    1   DCL GJA_MSG_DOWN$ PTR SYMREF;
      166    14653    1   DCL GJA_MSG_LINKDOWN$ PTR SYMREF;
      167    14654    1   DCL GJA_MSG_HOSTDOWN$ PTR SYMREF;
      168    14655        %KNN$ROUTE (STCLASS="BASED(ROUTE$)");
      169    14727        %KNN$LINK(STCLASS=BASED);
      170    14978    1   DCL STRING CHAR(SIZE) BASED;
      171    14979    1   DCL 1 SV$MSG BASED(MSG$),
      172    14980    1         2 BFRSIZ UBIN,     /* size of the buffer, so we can use 2nsys */
      173    14981    1         2 LNK$ PTR,
      174    14982    1         2 SZ UBIN,
      175    14983    1         2 VFC CHAR(1) UNAL,
      176    14984    1         2 * CHAR(1) UNAL;
      177    14985        %FPT_CONNECT_ACK(STCLASS="BASED(FPT$)");
      178    15034        %FPT_CONNECT (FPTN=FPT$CONNECT,STCLASS="BASED(FPT$)");
      179    15103        %G$BOBCAT (STCLASS="BASED(G$DS4$)");
      180    15116        %GJA$LGNCTX(STCLASS="BASED(CTX$)");
      181    15201        %GJA$HAND_CTX (STCLASS="BASED(CTX$)");
      182    15250        %KL_CONTROL_INIT(FPTN=KL$CONTROL,STCLASS="BASED(MSG$)");
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:6    
      183    15376        %KNH$QHDR(FPTN=CQ$QHDR,STCLASS="BASED(G$HAND_Q$)"); /* CQ header    */
      184    15389        %KNH$MESS(STCLASS="BASED(MSG$)");       /* CQ message template      */
      185    15438        %KV$VDO(NAME=KV$VDO,STCLASS="BASED(VDO$)");
      186    15465        %KV$VDO_RQSDAT (NAME=KV$VDO_RQSDAT,STCLASS="BASED(VDO$)");
      187    15513        %KV$VDO_STT (NAME=GJA_VDO_STT,STCLASS=SYMREF,LAST=",");
      188    15554             %KV$VDOVLP_DAT1(NAME=DAT1,LAST=",",LVL=2);
      189    15604    1         2 STATE CHAR(255);
      190    15605        %KH$CHN(STCLASS=BASED);
      191    15729        %KV$VDOVLP(NAME=KV$VDOVLP,STCLASS="BASED(VLP$)");
      192    15765        %KV$VDOVLP_DAT1;
      193    15815        %KV$VDOVLP_DAT2;
      194    15865          %KV$VDOVLP_ACTPOS;
      195    15916        %KV$VDOVLP_CG_MSGTYP;
      196    15968        %KV$VDOVLP_CG_STA;
      197    16019        %KV$VDOVLP_ERR;
      198    16116        %KV$VDOVLP_FLDID;
      199    16167        %KV$VDOVLP_KEY;
      200    16217        %KV$VDOVLP_MRK;
      201    16270        %KV$VDOVLP_CG_MSGID;
      202    16322
      203    16323
      204    16324                                                /* AUTO                     */
      205    16325        %GJA$PARAMS(STCLASS="");
      206    16340    1   DCL VLPSIZE UBIN;
      207    16341    1   DCL WHO UBIN;
      208    16342    1   DCL CHN$ PTR;
      209    16343    1   DCL MSG$ PTR;                 /* Pointer to MSG we are processing   */
      210    16344    1   DCL APP$ PTR;            /* Points to application specific message  */
      211    16345    1   DCL FPT$ PTR;            /* Pointer to the FPT portion of a message */
      212    16346    1   DCL CTX$ PTR;                      /* Pointer to handler context    */
      213    16347    1   DCL SVMSG$ PTR;
      214    16348    1   DCL VLP$ PTR;
      215    16349    1   DCL VDO$ PTR;
      216    16350    1   DCL MSGSIZ UBIN;                        /* Byte size of message     */
      217    16351    1   DCL ROUTE$ PTR;
      218    16352    1   DCL SCNSIZ SBIN;                   /* Number of bytes left to scan  */
      219    16353    1   DCL SIZE UBIN;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:7    
      220    16354    1   DCL LAST BIT(1);
      221    16355    1   DCL RECOVERY_NODE UBIN(32);
      222    16356        %KV$VDO_RQSDAT(NAME=KV@VDO_RQSDAT,STCLASS=AUTO);
      223    16404    1   DCL UNFLOW UBIN;
      224    16405    1   DCL MSGWTSIZE UBIN;
      225    16406    1   DCL SVCTX$ PTR;
      226    16407    1   DCL STRLEN UBIN;
      227    16408    1   DCL CHARPOS UBIN;
      228    16409    1   DCL NMAVAIL BIT(1);
      229    16410                                                /* DCBs                     */
      230    16411    1   DCL M$CQ DCB;
      231    16412                                                /* ENTRYS                   */
      232    16413    1   DCL GIJ$ABORTDUMP ENTRY;
      233    16414    1   DCL GJA$DECODE_APL_MSG ENTRY(2) ALTRET;
      234    16415    1   DCL GJA$DISOLVE_LGNUSR_CTX ENTRY(1);
      235    16416    1   DCL GJA$CONFIG ENTRY;
      236    16417    1   DCL GJA$DISOLVE_NA ENTRY(1);
      237    16418    1   DCL GJA$GET_CONFIG_INFO ENTRY (1);
      238    16419    1   DCL GJA$HOST_RECOVERY ENTRY(1) ALTRET;
      239    16420    1   DCL GJA$HOST_RESUMED ENTRY ALTRET;
      240    16421    1   DCL GJA$NETWORK_MANAGER ENTRY(2) ALTRET;
      241    16422    1   DCL GJA$LOGON_REQUEST ENTRY(3) ALTRET;
      242    16423    1   DCL GJA$LOGON_REQUEST_AGAIN ENTRY(1) ALTRET;
      243    16424    1   DCL KHC$UTS ENTRY(1) ALTRET;
      244    16425    1   DCL GJA$LOGON_TIMEOUT ENTRY(1);
      245    16426    1   DCL GJA$NODEINFO ENTRY(1);
      246    16427    1   DCL GJA$Q_MSG ENTRY(6);
      247    16428    1   DCL GJA$SOLICIT_LOGON ENTRY(1);
      248    16429    1   DCL GJA$SOLICIT_NM ENTRY(2);
      249    16430    1   DCL GJA$TERM_HANDLER ENTRY(1);
      250    16431    1   DCL GJA$WRITE ENTRY(6);
      251    16432    1   DCL KHC$DISPATCH ENTRY(1) ALTRET;
      252    16433    1   DCL KHC$WAIT ENTRY ALTRET;
      253    16434    1   DCL KVB$GET2NSYS ENTRY(2) ALTRET;
      254    16435    1   DCL KVB$GETSYS ENTRY(2) ALTRET;
      255    16436    1   DCL KVB$INT ENTRY(1) ALTRET;
      256    16437    1   DCL KVB$RLS2NSYS ENTRY(2) ALTRET;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:8    
      257    16438    1   DCL KVB$RLSSYS ENTRY(2) ALTRET;
      258    16439        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:9    
      259    16440        /* Node Admin Initialization
      260    16441        */
      261    16442    1      KH_CTLTBL$ = ADDR(CTLTBL);
      262    16443    1      CTLTBL.PARM.PTR$(%KL_HNDLRPARM_INTLVL) = ADDR(GJA_INTLEV);
      263    16444        /* Get privileged, take trap control and open the CQ DCB.
      264    16445        */
      265    16446    1      CALL M$SPRIV (FPT_SPRIV);
      266    16447    1      CALL M$SYS;
      267    16448    1      CALL M$TRAP(FPT_TRAP);
      268    16449        /* Map onto the BOBCAT segment in the monitor */
      269    16450    1      FROMSEG.BASE = %GM_BOBCAT_BASE;
      270    16451    1      USERSEG.BASE = %GM_USRDS4_BASE;
      271    16452    1      CALL M$CVM (GET_BOBCAT);
      272    16453    1      GJA_MAXNODE = G$BOBCAT.NODES;
      273    16454    1      GJA_NODE# = G$BOBCAT.FEP#;
      274    16455    1      GJA_NODENAME = G$BOBCAT.NODENAME;
      275    16456    1      GJA_DEFNODE = G$BOBCAT.HOSTNODE;
      276    16457    1      GJA_ROUTE$ = G$BOBCAT.ROUTE$$;
      277    16458    1      GJA_OSIROUTE$ = G$BOBCAT.OSIROUTE$;
      278    16459    1      GJA_OSIMAX# = G$BOBCAT.OSIROUTE#;
      279    16460    1      GJA_LINKS = G$BOBCAT.LINKS;
      280    16461    1      GJA_LINK$ = G$BOBCAT.LINK$$;
      281    16462
      282    16463        /* Get the NA control parameters */
      283    16464    1      MSG$ = PINCRW(G$DS1$,PINCRW(G$DS1$,2)->B$DWORD);
      284    16465    1      IF MSG$->KL$CONTROL.TYPE = 1         /* Paremeters present       */
      285    16466    2      THEN DO;
      286    16467    2           IF MSG$->KL$CONTROL.NUM_FPARAM >= %KL_HNDLRPARM_MEM
      287    16468    3           THEN DO;
      288    16469    3                FPT_GETMEM.V.PAGES = KL$CONTROL.FPARAM(%KL_HNDLRPARM_MEM);
      289    16470    3                GJA_MEMORY = FPT_GETMEM.V.PAGES;
      290    16471    3                END;
      291    16472    2           IF MSG$->KL$CONTROL.NUM_FPARAM > %KL_HNDLRPARM_RCVCQBYTSIZ
      292    16473    3           THEN DO;
      293    16474    3                VLP_HMI.RCQSIZE = KL$CONTROL.FPARAM(%KL_HNDLRPARM_RCVCQBYTSIZ);
      294    16475    3                GJA_RCQSIZE = VLP_HMI.RCQSIZE;
      295    16476    3                END;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:10   
      296    16477    2           IF MSG$->KL$CONTROL.NUM_FPARAM > %KL_HNDLRPARM_SNDCQBYTSIZ
      297    16478    3           THEN DO;
      298    16479    3                VLP_HMI.SCQSIZE = KL$CONTROL.FPARAM(%KL_HNDLRPARM_SNDCQBYTSIZ);
      299    16480    3                GJA_SCQSIZE = VLP_HMI.SCQSIZE;
      300    16481    3                END;
      301    16482    2           IF MSG$->KL$CONTROL.NUM_FPARAM >= %KL_NA_HOPCOST
      302    16483    2           THEN
      303    16484    2                GJA_HOPCOST = KL$CONTROL.FPARAM(%KL_NA_HOPCOST);
      304    16485    2           IF MSG$->KL$CONTROL.NUM_FPARAM > %KL_NA_LGNRTRYNUM
      305    16486    2           THEN
      306    16487    2                GJA_RETRYMAX = KL$CONTROL.FPARAM(%KL_NA_LGNRTRYNUM);
      307    16488    2           IF MSG$->KL$CONTROL.NUM_FPARAM >= %KL_HNDLRPARM_ATTR THEN
      308    16489    2                GJA_ATTR = KL$CONTROL.FPARAM(%KL_HNDLRPARM_ATTR);
      309    16490    2           END;
      310    16491
      311    16492    1      CALL M$OPEN(FPT_CQOPEN) WHENALTRETURN
      312    16493    2      DO;
      313    16494    2           CALL M$XXX;
      314    16495    2           END;
      315    16496        /*  Get some memory and use it to initialize the Node Admin buddy space pool.
      316    16497        */
      317    16498    1      CALL M$GDS(FPT_GETMEM)
      318    16499    2      WHENALTRETURN DO;
      319    16500    2           CALL M$XXX;
      320    16501    2           END;
      321    16502    1      KV$VDH_VDHINT.BFRBGN$ = GJA_MEMORY_RESULTS.BASE$;
      322    16503    1      KV$VDH_VDHINT.BFREND$=PINCRW(GJA_MEMORY_RESULTS.BASE$,GJA_MEMORY_RESULTS.PAGES*
             16503               256);
      323    16504    1      CALL KVB$INT(KV$VDH_VDHINT);
      324    16505
      325    16506        /* Setup the channel table.
      326    16507        */
      327    16508    1      GJA_CHNLOW = G$BOBCAT.CHNLOW;
      328    16509    1      GJA_CHNLOW$ = G$BOBCAT.CHNLOW$;
      329    16510    1      GJA_CHNHI$ = G$BOBCAT.CHNHI$;
      330    16511    1      GJA_CHNHI = G$BOBCAT.CHNHI;
      331    16512    1      GJA_CHNFREE$ = G$BOBCAT.CHNFREE$;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:11   
      332    16513    1      GID_BOOTCHAN = G$BOBCAT.BOOTCHAN;
      333    16514
      334    16515        /* Convert the config information passed to us in DS1. */
      335    16516    1      CALL GJA$CONFIG;
      336    16517
      337    16518        /* Get CTX for the NM connection */
      338    16519    1      SIZE=SIZEW(GJA$HAND_CTX);
      339    16520    1      CALL KVB$GETSYS(SIZE,CTX$);
      340    16521    1      GJA_UID_NANM$ = CTX$;
      341    16522    1      GJA_HAND_HEAD$ = CTX$;
      342    16523    1      GJA$HAND_CTX = '0'B;
      343    16524    1      GJA$HAND_CTX.WHO = %GJA_UID_NM;
      344    16525    1      GJA$HAND_CTX.NAME = 'MANAGER';
      345    16526
      346    16527
      347    16528        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:12   
      348    16529        /* Initialization complete.  Now, loop forever scanning the circular queue.
      349    16530        */
      350    16531    2      DO WHILE (%G_YES#);                  /* FOREVER                  */
      351    16532        /* Check for expired clocks */
      352    16533    3   CLOCK_LOOP:DO WHILE '1'B;
      353    16534    3                IF NOT KH_EXP.ABORT
      354    16535    3                THEN
      355    16536    3                     CALL KHC$DISPATCH (KH_EXP)
      356    16537    4                     WHENRETURN DO;
      357    16538    4                          CALL GJA$LOGON_TIMEOUT(KH_EXP.UID$);
      358    16539
      359    16540    4                          END;             /* WHENRETURN               */
      360    16541    4                     WHENALTRETURN DO;
      361    16542    4                          KH_EXP.CTBCTX$ = ADDR(NIL);
      362    16543    4                          EXIT CLOCK_LOOP;
      363    16544    4                          END;
      364    16545    3                END;
      365    16546
      366    16547        /*  Figure out how much there is to scan (accounting for wrap)
      367    16548        */
      368    16549    2   SCAN:   SCNSIZ=CQ$QHDR.RCQ.IPTR - CQ$QHDR.RCQ.RPTR;
      369    16550    2           IF SCNSIZ < 0
      370    16551    2           THEN SCNSIZ=SCNSIZ+CQ$QHDR.RCQ.SZ;
      371    16552
      372    16553        /*  Extract all current messages from the queue and process them.
      373    16554            Derive a pointer to the next message in the queue and determine
      374    16555            how large it is.  (RPTR is a DW index)  (MSGSIZ is in DWs)
      375    16556        */
      376    16557    3           DO WHILE (SCNSIZ > 0);
      377    16558    3                MSG$=PINCRW(G$HAND_Q$,CQ$QHDR.RCQ.OFFSET+CQ$QHDR.RCQ.RPTR*2);
      378    16559    3                MSGSIZ=(SIZEW(KNH$MESS) + (KNH$MESS.FPTSZ+1)/2 +(KNH$MESS.MSGSZ+1)/2 +
             16559                         1) / 2;
      379    16560    4                IF KNH$MESS.FUNCTION ~= %KN_FCN_NOP THEN DO;
      380    16561    4                     CTX$ = KNH$MESS.UID$;
      381    16562    4                     IF CTX$ ~= ADDR(NIL)
      382    16563    4                     THEN
      383    16564    4                          WHO = GJA$HAND_CTX.WHO;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:13   
      384    16565
      385    16566    4                     END;
      386    16567    3                ELSE
      387    16568    3                     CTX$ = ADDR(NIL);
      388    16569        /*  Branch out depending on the circular queue message function code.
      389    16570        */
      390    16571    4                DO CASE(KNH$MESS.FUNCTION);
      391    16572        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:14   
      392    16573        /*   NOP
      393    16574         */
      394    16575    4                 CASE(%KN_FCN_NOP);
      395    16576
      396    16577        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:15   
      397    16578        /*   Initiate Connection Request
      398    16579        */
      399    16580    4                 CASE(%KN_FCN_INIT);
      400    16581
      401    16582    4                   FPT$ = PINCRW(MSG$,SIZEW(KNH$MESS));
      402    16583
      403    16584    5                   DO SELECT (FPT$CONNECT.RESOURCE);
      404    16585
      405    16586    5                        SELECT ('NODADM');
      406    16587    5                        SIZE = SIZEW(GJA$HAND_CTX);
      407    16588    6                        CALL KVB$GETSYS(SIZE,CTX$) WHENALTRETURN DO;
      408    16589    6                             GOTO GETOUT;
      409    16590    6                             END;
      410    16591    5                        GJA$HAND_CTX = '0'B;
      411    16592    5                        GJA$HAND_CTX.SYSID = FPT$CONNECT.USER.SYSID;
      412    16593    5                        GJA$HAND_CTX.NAME = FPT$CONNECT.TERMINAL_ID.TERMID;
      413    16594    5                        IF GJA_HAND_HEAD$ = ADDR(NIL)
      414    16595    5                        THEN GJA_HAND_HEAD$ = CTX$;
      415    16596    6                        ELSE DO;
      416    16597    6                             GJA$HAND_CTX.LNK$ = GJA_HAND_HEAD$;
      417    16598    6                             GJA_HAND_HEAD$ = CTX$;
      418    16599    6                             END;
      419    16600    5                        GJA$HAND_CTX.LDCTX = KNH$MESS.LDCTX;
      420    16601    5                        GJA$HAND_CTX.WHO = %GJA_UID_HANDLER;
      421    16602    5                        IF FPT$CONNECT.TERMINAL_ID.TERMID = 'BABOON'
      422    16603    6                        THEN DO;
      423    16604    6                             GJA_UID_BABOON$ = CTX$;
      424    16605    6                             GJA$HAND_CTX.WHO = %GJA_UID_BABOON;
      425    16606    6                             GJA_LDCT_BABOON = KNH$MESS.LDCTX;
      426    16607    6                             GJA_CONNECT_ACK.REASON = %K_REASON_NORMAL;
      427    16608    6                             CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_CONNECT_ACK),
             16608                                      GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);
      428    16609    6                             CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_KL_MES),GJA_KL_MES,,,);
      429    16610    6                             END;
      430    16611    5                        ELSE
      431    16612    6                        DO;
      432    16613
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:16   
      433    16614        /*  Dont ack any handler connection until we are fully connected
      434    16615            to the network manager.
      435    16616        */
      436    16617    6                             GJA_CONNECT_ACK.REASON = %K_REASON_NORMAL;
      437    16618    6                             CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_KL_MES),GJA_KL_MES,
      438    16619    6                               SIZEC(GJA_CONNECT_ACK),GJA_CONNECT_ACK,%KN_FCN_INIT_ACK)
             16619                                        ;
      439    16620    6                             END;
      440    16621
      441    16622
      442    16623    5                        SELECT ('LOGON');
      443    16624    5                        CALL GJA$LOGON_REQUEST(CTX$,KNH$MESS,FPT$CONNECT) ALTRET(GETOUT
             16624                                 ); /* Logon request from a handler */
      444    16625
      445    16626
      446    16627    5                        SELECT ('NETMAN'); /* Connection from another NA */
      447    16628
      448    16629    5                        IF FPT$CONNECT.RLCID.NODE < GJA_NODE#
      449    16630    6                        THEN DO;
      450    16631    6                             GJA_CONNECT_ACK.REASON = %K_REASON_USRREJ;
      451    16632    6                             CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(
             16632                                      GJA_CONNECT_ACK),GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);
      452    16633    6                             END;
      453    16634    6                        ELSE DO;
      454    16635    6                             GJA_CONNECT_ACK.REASON = %K_REASON_NORMAL;
      455    16636    6                             ROUTE$ = KNN$ROUTE$(FPT$CONNECT.RLCID.NODE);
      456    16637    6                             CTX$ = KNN$ROUTE.CTX$;
      457    16638    6                             IF CTX$ = ADDR(NIL)
      458    16639    7                             THEN DO;
      459    16640    7                                  SIZE = SIZEW(GJA$HAND_CTX);
      460    16641    7                                  CALL KVB$GETSYS (SIZE,CTX$) ALTRET (GETOUT);
      461    16642    7                                  GJA$HAND_CTX = '0'B;
      462    16643    7                                  GJA$HAND_CTX.NAME = 'NETMAN';
      463    16644    7                                  GJA$HAND_CTX.WHO = %GJA_UID_NM;
      464    16645    7                                  GJA$HAND_CTX.NODE = FPT$CONNECT.RLCID.NODE;
      465    16646    7                                  ROUTE$ = KNN$ROUTE$(GJA$HAND_CTX.NODE);
      466    16647    7                                  KNN$ROUTE.CTX$ = CTX$;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:17   
      467    16648    7                                  GJA$HAND_CTX.LINK_CONNECTED = KNN$ROUTE.FLAGS.
             16648                                           LINK_CONNECTED;
      468    16649    7                                  IF GJA_NM_HEAD$ = ADDR(NIL)
      469    16650    7                                  THEN
      470    16651    7                                       GJA_NM_HEAD$ = CTX$;
      471    16652    8                                  ELSE DO;
      472    16653    8                                       GJA$HAND_CTX.LNK$ = GJA_NM_HEAD$;
      473    16654    8                                       GJA_NM_HEAD$ = CTX$;
      474    16655    8                                       END;
      475    16656    7                                  GJA$HAND_CTX.LDCTX = KNH$MESS.LDCTX;
      476    16657    7                                  CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_CONNECT_ACK),
             16657                                           GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);
      477    16658    7                                  CALL GJA$NODEINFO(CTX$);
      478    16659    7                                  END;
      479    16660    7                             ELSE DO;
      480    16661        /*
      481    16662          If we've got this far we need to init nak the first connectio attempt
      482    16663          unitl the connection either fails or complete.  So subsequent inits
      483    16664          are just nak'd.  This should not occur too often from the same node.
      484    16665        */
      485    16666    7                                  GJA_CONNECT_ACK.REASON = %K_REASON_USRREJ;
      486    16667    7                                  CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(
             16667                                           GJA_CONNECT_ACK)
      487    16668    7                                    ,GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);
      488    16669    7                                  END;
      489    16670    6                             END;
      490    16671
      491    16672    5                        END /* DO SELECT */;
      492    16673        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:18   
      493    16674        /*   Initiate Connection Acknowledgement
      494    16675        */
      495    16676        /*
      496    16677          Verify that the init was O.K. and if it wasn't, retry it.
      497    16678        */
      498    16679    4                 CASE(%KN_FCN_INIT_ACK);
      499    16680    4                   FPT$=PINCRW(MSG$,SIZEW(KNH$MESS));
      500    16681    4                   GJA$HAND_CTX.WAT4ACK = '0'B;
      501    16682    4                   IF FPT_CONNECT_ACK.REASON ~= %K_REASON_NORMAL
      502    16683    4                   THEN
      503    16684    4                        IF FPT_CONNECT_ACK.REASON = %K_REASON_NORTE
      504    16685    4                          OR (FPT_CONNECT_ACK.REASON = %K_REASON_USRREJ AND NOT
             16685                                   GJA$HAND_CTX.HOST_NODE)
      505    16686    5                        THEN DO;
      506    16687    5                             IF GJA$HAND_CTX.LDCTX = 0 /* No other connection */
      507    16688    5                             THEN
      508    16689    5                                  CALL GJA$DISOLVE_NA(CTX$);
      509    16690    5                             END;
      510    16691    5                        ELSE DO;
      511    16692    5                             GJA_CONNECT.RLCID.NODE = GJA$HAND_CTX.NODE;
      512    16693    5                             CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_CONNECT),GJA_CONNECT,%
             16693                                      KN_FCN_INIT);
      513    16694    5                             END;
      514    16695        /*
      515    16696          When we get connect ack from the network manager, we need to save
      516    16697          the LDCT index of the network manager for later use in communicating
      517    16698          with it.
      518    16699        */
      519    16700    5                   ELSE DO;
      520    16701    5                        GJA$HAND_CTX.LDCTX = KNH$MESS.LDCTX;
      521    16702        /*
      522    16703             Send the node info to this NA
      523    16704         */
      524    16705    5                        CALL GJA$NODEINFO(CTX$);
      525    16706        /*
      526    16707            if this init ack is from a host then check the logon list for any
      527    16708            previous autologon failures and reissue the connect on them.
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:19   
      528    16709        */
      529    16710    5                        SVMSG$ = GJA_USRLGN_HEAD$;
      530    16711    6                        DO WHILE SVMSG$ ~= ADDR(NIL);
      531    16712        /* if the node connecting has logons waiting reissue them now.  let the
      532    16713           default node take care of his own all non-autologon lines default to
      533    16714           gja_defnode as their nm*/
      534    16715    6                             IF SVMSG$->GJA$LGNCTX.NM_NODE = GJA$HAND_CTX.NODE
      535    16716    6                               AND GJA_DEFNODE ~= GJA$HAND_CTX.NODE
      536    16717    6                               AND SVMSG$->GJA$LGNCTX.CHN$->KH$CHN.AUTLGN THEN
      537    16718    7                             DO;
      538    16719    8                                  CALL GJA$LOGON_REQUEST_AGAIN(SVMSG$) WHENALTRETURN DO
             16719                                           ;
      539    16720                                                /* doesn't really altret    */
      540    16721    8                                       END;
      541    16722    7                                  END;
      542    16723    6                             SVMSG$ = SVMSG$->GJA$LGNCTX.LNK$;
      543    16724    6                             END;
      544    16725    5                        END;
      545    16726        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:20   
      546    16727        /*   Terminate Connection Request
      547    16728        */
      548    16729        /*
      549    16730          A TERM from VDH probably means that one of the devices attempting
      550    16731          logon has disconnected.  If we have already solicited the network
      551    16732          manager for information on this guy, just set a bit in his context
      552    16733          so that we can throw away the network managers responce when we
      553    16734          get it.  Otherwise, send a TERM ACK to VDH and displve this guys
      554    16735          context now.  At some future time we may also need code here to
      555    16736          support resources disconnecting.
      556    16737        */
      557    16738    4                 CASE(%KN_FCN_TERM);
      558    16739    5                   DO CASE (WHO);
      559    16740
      560    16741    5                    CASE (%GJA_UID_LOGON);
      561    16742
      562    16743        /*
      563    16744        */
      564    16745    5                      IF CTX$->GJA$LGNCTX.STATUS.NMRSP
      565    16746    5                        OR CTX$->GJA$LGNCTX.STATUS.WTPRO
      566    16747    5                      THEN CTX$->GJA$LGNCTX.STATUS.TERM='1'B;
      567    16748    6                      ELSE DO;
      568    16749    6                           CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_TERM_ACK),GJA_TERM_ACK,%
             16749                                    KN_FCN_TERM_ACK);
      569    16750    6                           CALL GJA$DISOLVE_LGNUSR_CTX(CTX$);
      570    16751    6                           END;
      571    16752
      572    16753
      573    16754    5                    CASE (%GJA_UID_NM);
      574    16755    5                      CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(GJA_TERM_ACK),
             16755                               GJA_TERM_ACK,%KN_FCN_TERM_ACK);
      575    16756    5                      IF CTX$ = GJA_UID_NM$
      576    16757    6                      THEN DO;
      577    16758    6                           GJA$HAND_CTX.WAT4ACK = '0'B;
      578    16759    6                           GJA_UID_NM$ = ADDR(NIL);
      579    16760    6                           END;
      580    16761    5                      RECOVERY_NODE = CTX$->GJA$HAND_CTX.NODE;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:21   
      581    16762        /*
      582    16763                            if the term comes before the ack then
      583    16764                            skip the disolve context message and let
      584    16765                            the init_ack do the work.
      585    16766        */
      586    16767    5                      IF GJA_UID_NM$ = ADDR(NIL) /* Our NM             */
      587    16768    6                      THEN DO;
      588    16769    6                           CALL GIJ$ABORTDUMP;
      589    16770    6                           GJA_UID_NM$ = ADDR(NIL);
      590    16771    6                           GJA_LDCT_NM = 0;
      591    16772
      592    16773    6                           END;
      593    16774    5                      CALL GJA$HOST_RECOVERY(RECOVERY_NODE);
      594    16775    5                      IF (GJA_DEFNODE = RECOVERY_NODE AND
      595    16776    5                        KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.FLAGS.LINK_CONNECTED) THEN
      596    16777    5                           GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;
      597    16778    5                      ELSE
      598    16779    5                           IF (GJA_DEFNODE ~= RECOVERY_NODE AND
      599    16780    5                             NOT (KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.FLAGS.
             16780                                      LINK_CONNECTED)) THEN
      600    16781    5                                IF (KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.LINK# ~= -1)
             16781                                         THEN
      601    16782    5                                     IF (KNN$LINK$(KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.
             16782                                              LINK#)->KNN$LINK.QOS < 255) THEN
      602    16783    5                                          GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;
      603    16784    5                                     ELSE
      604    16785    5                                          GJA_MSG_DOWN$ = GJA_MSG_LINKDOWN$;
      605    16786    5                                ELSE
      606    16787    5                                     ; /* link recovery already occurred*/
      607    16788    5                           ELSE
      608    16789    5                                IF (GJA_DEFNODE = RECOVERY_NODE) AND
      609    16790    5                                  ~(KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.FLAGS.
             16790                                           LINK_CONNECTED) THEN
      610    16791    5                                     IF (KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.LINK# ~= -1
             16791                                              ) THEN
      611    16792    5                                          IF (KNN$LINK$(KNN$ROUTE$(GJA_DEFNODE)->
             16792                                                   KNN$ROUTE.LINK#)->KNN$LINK.QOS < 255)
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:22   
             16792                                                   THEN
      612    16793    5                                               GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;
      613    16794    5                                          ELSE
      614    16795    5                                               GJA_MSG_DOWN$ = GJA_MSG_LINKDOWN$;
      615    16796    5                                     ELSE ;
      616    16797        /*
      617    16798         *                  if we aren't waiting for the init_ack on this connection
      618    16799         *                  go ahead and attempt the reconnect.
      619    16800         */
      620    16801    6                      IF NOT GJA$HAND_CTX.WAT4ACK THEN DO;
      621    16802    6                           CALL GJA$DISOLVE_NA(CTX$);
      622    16803    6                           ROUTE$ = KNN$ROUTE$(RECOVERY_NODE);
      623    16804    6                           IF KNN$ROUTE.CURRENT_QOS < 255
      624    16805    6                             AND (RECOVERY_NODE < GJA_NODE#
      625    16806    6                             OR KNN$ROUTE.FLAGS.HOST_NODE = '1'B) THEN
      626    16807    7                           DO;
      627    16808    7                                GJA_CONNECT.RLCID.NODE = RECOVERY_NODE;
      628    16809    7                                SIZE = SIZEW(GJA$HAND_CTX);
      629    16810    7                                CALL KVB$GETSYS(SIZE,CTX$)
      630    16811    8                                WHENALTRETURN DO;
      631    16812    8                                     GOTO GETOUT;
      632    16813    8                                     END;
      633    16814    7                                GJA$HAND_CTX = '0'B;
      634    16815    7                                GJA$HAND_CTX.WHO = %GJA_UID_NM;
      635    16816    7                                GJA$HAND_CTX.NODE = RECOVERY_NODE;
      636    16817    7                                GJA$HAND_CTX.HOST_NODE = KNN$ROUTE.FLAGS.HOST_NODE;
      637    16818    7                                IF GJA_NM_HEAD$ = ADDR(NIL)
      638    16819    7                                THEN
      639    16820    7                                     GJA_NM_HEAD$ = CTX$;
      640    16821    8                                ELSE DO;
      641    16822    8                                     GJA$HAND_CTX.LNK$ = GJA_NM_HEAD$;
      642    16823    8                                     GJA_NM_HEAD$ = CTX$;
      643    16824    8                                     END;
      644    16825    7                                KNN$ROUTE.CTX$ = CTX$;
      645    16826    7                                CALL GJA$Q_MSG (CTX$,,,SIZEC(GJA_CONNECT),GJA_CONNECT,%
             16826                                         KN_FCN_INIT);
      646    16827    7                                GJA$HAND_CTX.WAT4ACK = '1'B;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:23   
      647    16828    7                                GJA$HAND_CTX.LINK_CONNECTED = KNN$ROUTE.FLAGS.
             16828                                         LINK_CONNECTED;
      648    16829    7                                END;
      649    16830    6                           END;
      650    16831
      651    16832
      652    16833    5                    CASE (%GJA_UID_HANDLER);
      653    16834    5                      CALL GJA$TERM_HANDLER(CTX$);
      654    16835
      655    16836
      656    16837
      657    16838    5                    CASE (ELSE);
      658    16839    5                      CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(GJA_TERM_ACK),
             16839                               GJA_TERM_ACK,%KN_FCN_TERM_ACK);
      659    16840
      660    16841
      661    16842    5                      END;
      662    16843        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:24   
      663    16844        /*   Terminate Connection Acknowledgement
      664    16845        */
      665    16846        /*
      666    16847          For right now lets make sure that this is from VDH on behalf
      667    16848          of a user logon path that was just disolved.  If it was, call
      668    16849          a routine to disolve the context block.  Lets also make sure that
      669    16850          we were expecting this.  I hate surprises!
      670    16851        */
      671    16852    4                 CASE(%KN_FCN_TERM_ACK);
      672    16853    5                   DO CASE (WHO);
      673    16854
      674    16855    5                    CASE (%GJA_UID_NM);
      675    16856    5                      CALL GJA$DISOLVE_NA(CTX$);
      676    16857
      677    16858    5                    CASE (%GJA_UID_LOGON);
      678    16859    5                      IF NOT(CTX$->GJA$LGNCTX.STATUS.TERMACK)
      679    16860    5                      THEN
      680    16861    5                           CALL M$XXX;
      681    16862    5                      CALL GJA$DISOLVE_LGNUSR_CTX (CTX$);
      682    16863
      683    16864    5                    CASE (ELSE);
      684    16865    5                      CALL M$XXX;
      685    16866
      686    16867    5                      END;
      687    16868
      688    16869
      689    16870        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:25   
      690    16871        /*   Send Data
      691    16872        */
      692    16873        /*
      693    16874          Branch out depending on the VDO type
      694    16875        */
      695    16876    4                 CASE(%KN_FCN_DATA);
      696    16877    4                   IF WHO ~= %GJA_UID_LOGON OR ~GJA$LGNCTX.STATUS.TERMACK
      697    16878    5                   THEN DO;
      698    16879    5                        VDO$ = PINCRW(MSG$,SIZEW(KNH$MESS));
      699    16880    5                        GJA$PARAMS='0'B;
      700    16881    5                        GJA$PARAMS.MSG$=MSG$;
      701    16882    5                        GJA$PARAMS.VDO$=VDO$;
      702    16883    6   VDOLOOP:             DO WHILE ('1'B);
      703    16884    6                             VLP$=PINCRW(VDO$,(GJA_VDOBYTSIZ(KV$VDO.FNC)+1)/2);
      704    16885    6                             LAST = ~KV$VDO.VLP;
      705    16886    7   VLPLOOP:                  DO WHILE (~LAST);
      706    16887    8                                  DO CASE(KV$VDOVLP.TYP);
      707    16888
      708    16889    8                                   CASE(%KV_VDOVLP_TYP_DAT1);
      709    16890    8                                     APP$ = PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_DAT1));
      710    16891    8                                     VLPSIZE=(VLP$->KV$VDOVLP_DAT1.BYTSIZ+1)/2;
      711    16892    8                                     GJA$PARAMS.DATVLP$=VLP$;
      712    16893    8                                     GJA$PARAMS.DAT$=APP$;
      713    16894    8                                     GJA$PARAMS.DATSIZE = VLP$->KV$VDOVLP_DAT1.BYTSIZ;
      714    16895
      715    16896    8                                   CASE(%KV_VDOVLP_TYP_DAT2);
      716    16897    8                                     APP$ = PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_DAT2));
      717    16898    8                                     VLPSIZE=(VLP$->KV$VDOVLP_DAT2.BYTSIZ+1)/2;
      718    16899    8                                     GJA$PARAMS.DATVLP$=VLP$;
      719    16900    8                                     GJA$PARAMS.DAT$=APP$;
      720    16901    8                                     GJA$PARAMS.DATSIZE = VLP$->KV$VDOVLP_DAT2.BYTSIZ;
      721    16902
      722    16903    8                                   CASE(%KV_VDOVLP_TYP_CG_MSGTYP);
      723    16904    8                                     APP$=VLP$;
      724    16905    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_CG_MSGTYP);
      725    16906    8                                     GJA$PARAMS.CG_MSGTYP$=VLP$;
      726    16907
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:26   
      727    16908    8                                   CASE(%KV_VDOVLP_TYP_CG_STA);
      728    16909    8                                     APP$=VLP$;
      729    16910    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_CG_STA);
      730    16911    8                                     GJA$PARAMS.CG_STA$=VLP$;
      731    16912
      732    16913    8                                   CASE(%KV_VDOVLP_TYP_ERR);
      733    16914    8                                     APP$=VLP$;
      734    16915    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_ERR);
      735    16916    8                                     GJA$PARAMS.ERR$=VLP$;
      736    16917
      737    16918    8                                   CASE(%KV_VDOVLP_TYP_FLDID);
      738    16919    8                                     APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_FLDID));
      739    16920    8                                     VLPSIZE=(VLP$->KV$VDOVLP_FLDID.BYTSIZ+1)/2;
      740    16921    8                                     GJA$PARAMS.FLDID$=VLP$;
      741    16922
      742    16923    8                                   CASE(%KV_VDOVLP_TYP_KEY);
      743    16924    8                                     APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_KEY));
      744    16925    8                                     VLPSIZE=(VLP$->KV$VDOVLP_KEY.BYTSIZ+1)/2;
      745    16926    8                                     GJA$PARAMS.KEY$=VLP$;
      746    16927
      747    16928    8                                   CASE(%KV_VDOVLP_TYP_MRK);
      748    16929    8                                     GJA$PARAMS.MRK$=VLP$;
      749    16930    8                                     APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_MRK));
      750    16931    8                                     VLPSIZE=(VLP$->KV$VDOVLP_MRK.BYTSIZ+1)/2;
      751    16932
      752    16933    8                                   CASE(%KV_VDOVLP_TYP_CG_MSGID);
      753    16934    8                                     APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_CG_MSGID));
      754    16935    8                                     VLPSIZE=(VLP$->KV$VDOVLP_CG_MSGID.BYTSIZ+1)/2;
      755    16936    8                                     GJA$PARAMS.CG_MSGID$=VLP$;
      756    16937
      757    16938    8                                   CASE(%KV_VDOVLP_TYP_ACTPOS);
      758    16939    8                                     APP$=VLP$;
      759    16940    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_ACTPOS);
      760    16941
      761    16942    8                                   CASE(ELSE);
      762    16943    8                                     CALL M$XXX;
      763    16944    8                                     END;  /* VLP CASE                 */
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:27   
      764    16945
      765    16946
      766    16947    7                                  LAST = KV$VDOVLP.LST;
      767    16948    7                                  VLP$=PINCRW(APP$,VLPSIZE);
      768    16949    7                                  END;     /* VLP LOOP                 */
      769    16950        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:28   
      770    16951        /* If there was a marker on the message send it now */
      771    16952    6                             IF GJA$PARAMS.MRK$ ~= ADDR(NIL) AND GJA$PARAMS.MRK$->
             16952                                      KV$VDOVLP_MRK.MRKTYP ~= 0
      772    16953    6                               AND KV$VDO.FNC ~= %KV_VDO_FNC_MRK
      773    16954    7                             THEN DO;
      774    16955    7                                  GJA_VDO_MRK.MRK.MRKTYP = GJA$PARAMS.MRK$->
             16955                                           KV$VDOVLP_MRK.MRKTYP;
      775    16956    7                                  GJA_VDO_MRK.MRK.ID = GJA$PARAMS.MRK$->KV$VDOVLP_MRK.
             16956                                           ID;
      776    16957    7                                  CALL GJA$Q_MSG (KNH$MESS.UID$,SIZEC(GJA_VDO_MRK),
             16957                                           GJA_VDO_MRK);
      777    16958    7                                  GJA$PARAMS.MRK$->KV$VDOVLP_MRK.MRKTYP = 0;
      778    16959    7                                  END;
      779    16960
      780    16961
      781    16962    7                             DO CASE(KV$VDO.FNC); /* VDO CASE          */
      782    16963        /*
      783    16964          FNC = Event
      784    16965         */
      785    16966    7                              CASE (%KV_VDO_FNC_EVT);
      786    16967    7                                IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.RDPND
      787    16968    8                                THEN DO;
      788    16969    8                                     KNH$MESS.UID$->GJA$LGNCTX.STATUS.RDPND = '0'B;
      789    16970    8                                     CALL GJA$SOLICIT_LOGON(KNH$MESS.UID$);
      790    16971    8                                     END;
      791    16972        /*
      792    16973          FNC = Open session request
      793    16974          FNC = Block data (for flow control)
      794    16975
      795    16976          Send a read response to set throttle
      796    16977        */
      797    16978    7                              CASE(%KV_VDO_FNC_OPNSSN_RQS);
      798    16979    7   UN_FLOW:                     KV@VDO_RQSDAT=KV_VDO_RQSDAT;
      799    16980    7                                CALL GJA$Q_MSG(KNH$MESS.UID,SIZEC(
      800    16981    7                                  KV$VDO_RQSDAT),KV@VDO_RQSDAT);
      801    16982    7                                IF CTX$ ~= ADDR(NIL) AND WHO = %GJA_UID_HANDLER
      802    16983    7                                  AND NOT CTX$->GJA$HAND_CTX.BLK THEN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:29   
      803    16984    7                                     CTX$->GJA$HAND_CTX.RDSOUT = GJA_MAXRDS;
      804    16985    7                              CASE(%KV_VDO_FNC_BLKDAT);
      805    16986    7                                IF NOT GJA$HAND_CTX.BLK
      806    16987    7                                THEN GOTO UN_FLOW;
      807    16988        /*
      808    16989          FNC = Request Data
      809    16990        */
      810    16991    7                              CASE(%KV_VDO_FNC_RQSDAT);
      811    16992    7                                IF KV$VDO_RQSDAT.EOFNO_DAT AND GJA$HAND_CTX.
             16992                                         WAITING_MSG$ = ADDR(NIL)
      812    16993    8                                THEN DO;
      813    16994    8                                     CALL GJA$Q_MSG(CTX$,SIZEC(VDO_NODAT),VDO_NODAT);
      814    16995    8                                     END;
      815    16996    8                                ELSE DO;
      816    16997    8                                     IF KV$VDO_RQSDAT.INCMAXNMBBYT
      817    16998    8                                     THEN GJA$HAND_CTX.MAXNMBBYT = GJA$HAND_CTX.
             16998                                              MAXNMBBYT + KV$VDO_RQSDAT.MAXNMBBYT;
      818    16999    8                                     ELSE GJA$HAND_CTX.MAXNMBBYT = KV$VDO_RQSDAT.
             16999                                              MAXNMBBYT;
      819    17000        /* Check to see if we are incrementing.
      820    17001        */
      821    17002    8                                     IF KV$VDO_RQSDAT.INCMAXNMBRCR
      822    17003    8                                     THEN GJA$HAND_CTX.MAXNMBRCR = GJA$HAND_CTX.
             17003                                              MAXNMBRCR + KV$VDO_RQSDAT.MAXNMBRCR;
      823    17004    8                                     ELSE GJA$HAND_CTX.MAXNMBRCR = KV$VDO_RQSDAT.
             17004                                              MAXNMBRCR;
      824    17005    8                                     GJA$HAND_CTX.MAXRCRBYTSIZ = KV$VDO_RQSDAT.
             17005                                              MAXRCRBYTSIZ;
      825    17006        /* Send any messages waiting.
      826    17007        */
      827    17008    8                                     MSGWTSIZE = 0;
      828    17009    9                                     DO WHILE (GJA$HAND_CTX.WAITING_MSG$~=ADDR(NIL));
      829    17010    9                                          SVMSG$=GJA$HAND_CTX.WAITING_MSG$;
      830    17011    9                                          IF SVMSG$->SV$MSG.SZ > GJA$HAND_CTX.
             17011                                                   MAXRCRBYTSIZ AND
      831    17012    9                                            GJA$HAND_CTX.MAXNMBRCR > 0 THEN
      832    17013   10                                          DO;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:30   
      833    17014   10                                               GJA$HAND_CTX.MAXNMBRCR = GJA$HAND_CTX.
             17014                                                        MAXNMBRCR-1;
      834    17015   10                                               CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_LDDAT),
             17015                                                        GJA_LDDAT);
      835    17016   10                                               EXIT;
      836    17017   10                                               END; /* MAXNMBRCR>0*/
      837    17018    9                                          IF SVMSG$->SV$MSG.SZ > GJA$HAND_CTX.MAXNMBBYT
             17018                                                   OR
      838    17019    9                                            SVMSG$->SV$MSG.SZ > GJA$HAND_CTX.
             17019                                                     MAXRCRBYTSIZ OR
      839    17020    9                                            GJA$HAND_CTX.MAXNMBRCR = 0 THEN
      840    17021    9                                               EXIT;
      841    17022
      842    17023    9                                          SIZE = SVMSG$->SV$MSG.SZ;
      843    17024    9                                          IF SVMSG$->SV$MSG.VFC ~= BINASC(0)
      844    17025   10                                          THEN DO;
      845    17026   10                                               GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %
             17026                                                        KV_DATCTRCHRTYP_VFC;
      846    17027   10                                               GJA_VDO_DAT_DAT2.DATCTRCHR = SVMSG$->
             17027                                                        SV$MSG.VFC;
      847    17028   10                                               END;
      848    17029    9                                          SVMSG$=PINCRW(SVMSG$,SIZEW(SV$MSG));
      849    17030    9                                          CALL GJA$WRITE(CTX$,SIZE,SVMSG$->STRING);
      850    17031    9                                          GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %
             17031                                                   KV_DATCTRCHRTYP_NON;
      851    17032    9                                          GJA$HAND_CTX.MAXNMBRCR = GJA$HAND_CTX.
             17032                                                   MAXNMBRCR - 1;
      852    17033    9                                          GJA$HAND_CTX.MAXNMBBYT = GJA$HAND_CTX.
             17033                                                   MAXNMBBYT - SIZE;
      853    17034    9                                          SVMSG$ = GJA$HAND_CTX.WAITING_MSG$;
      854    17035    9                                          MSGWTSIZE = MSGWTSIZE + SVMSG$->SV$MSG.SZ;
      855    17036    9                                          GJA$HAND_CTX.WAITING_MSG$ = GJA$HAND_CTX.
             17036                                                   WAITING_MSG$->SV$MSG.LNK$;
      856    17037    9                                          CALL KVB$RLSSYS(SVMSG$->SV$MSG);
      857    17038    9                                          END;
      858    17039    8                                     END;
      859    17040    7                                IF CTX$ = GJA_UID_NM$ AND MSGWTSIZE > 0
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:31   
      860    17041    8                                THEN DO;
      861    17042    8                                     MSGWTSIZE = 0;
      862    17043        /*
      863    17044                how many bytes are left to send?
      864    17045        */
      865    17046    8                                     IF CTX$->GJA$HAND_CTX.WAITING_MSG$ ~= ADDR(NIL)
      866    17047    9                                     THEN DO;
      867    17048    9                                          MSGWTSIZE = CTX$->GJA$HAND_CTX.WAITING_MSG$->
             17048                                                   SV$MSG.SZ;
      868    17049    9                                          SVMSG$ = CTX$->GJA$HAND_CTX.WAITING_MSG$;
      869    17050   10                                          DO WHILE (SVMSG$->SV$MSG.LNK$ ~= ADDR(NIL));
      870    17051   10                                               SVMSG$ = SVMSG$->SV$MSG.LNK$;
      871    17052   10                                               MSGWTSIZE = MSGWTSIZE + SVMSG$->SV$MSG.
             17052                                                        SZ;
      872    17053   10                                               END; /* svmsg.lnk$ ~= addr(nil)*/
      873    17054    9                                          END; /* msg$ ~= addr(nil)    */
      874    17055    8                                     KV@VDO_RQSDAT = KV_VDO_RQSDAT;
      875    17056    8                                     SVCTX$ = CTX$;
      876    17057    8                                     CTX$ = GJA_HAND_HEAD$;
      877    17058    9                                     DO WHILE ( CTX$ ~= ADDR(NIL) );
      878    17059   10                                          IF GJA$HAND_CTX.BLK = '1'B THEN DO;
      879    17060   10                                               GJA$HAND_CTX.BLK = '0'B;
      880    17061   10                                               CALL GJA$Q_MSG(CTX$,LENGTHC(
             17061                                                        KV_VDO_RQSDAT),
      881    17062   10                                                 KV_VDO_RQSDAT);
      882    17063   10                                               END; /* hand.blk = 1    */
      883    17064    9                                          CTX$ = GJA$HAND_CTX.LNK$;
      884    17065    9                                          END; /* ctx~= addr(nil)*/
      885    17066    8                                     CTX$ = SVCTX$;
      886    17067    8                                     END; /* ctx$ = uid_nm$ and unflow > 0 */
      887    17068        /*
      888    17069          FNC = Request STT
      889    17070         */
      890    17071    7                              CASE(%KV_VDO_FNC_RQSSTT);
      891    17072
      892    17073
      893    17074    7                                NMAVAIL = '0'B;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:32   
      894    17075    7                                CHARPOS = 0;
      895    17076    7                                SUBSTR(GJA_VDO_STT.STATE,0,9) = 'Host(s): ';
      896    17077    7                                CHARPOS = 9;
      897    17078    7                                CTX$ = GJA_NM_HEAD$;
      898    17079    8   FNDNM:                       DO WHILE CTX$ ~= ADDR(NIL);
      899    17080    8                                     IF CTX$->GJA$HAND_CTX.HOST_NODE AND
      900    17081    9                                       CTX$->GJA$HAND_CTX.LDCTX ~= 0 THEN DO;
      901    17082    9                                          NMAVAIL = '1'B;
      902    17083    9                                          IF CTX$->GJA$HAND_CTX.NAME ~= ' '
      903    17084   10                                            AND CTX$->GJA$HAND_CTX.NAME ~= 'NETMAN'
             17084                                                     THEN DO;
      904    17085   10                                               STRLEN = 8;
      905    17086   11                                               DO WHILE (SUBSTR(CTX$->GJA$HAND_CTX.NAME
             17086                                                        ,STRLEN-1,1) = ' '
      906    17087   11                                                 AND STRLEN > 0);
      907    17088   11                                                    STRLEN = STRLEN - 1;
      908    17089   11                                                    END;
      909    17090   10                                               SUBSTR(GJA_VDO_STT.STATE,CHARPOS,STRLEN)
             17090                                                        = CTX$->GJA$HAND_CTX.NAME;
      910    17091   10                                               CHARPOS = STRLEN + CHARPOS;
      911    17092   10                                               SUBSTR(GJA_VDO_STT.STATE,CHARPOS,1) =
             17092                                                        ',';
      912    17093   10                                               CHARPOS = CHARPOS + 1;
      913    17094   10                                               END;
      914    17095    9                                          END;
      915    17096    8                                     CTX$ = CTX$->GJA$HAND_CTX.LNK$;
      916    17097    8                                     END;
      917    17098    7                                IF NOT NMAVAIL /* No hosts             */
      918    17099    8                                THEN DO;
      919    17100    8                                     GJA_VDO_STT.STATE = 'No Host';
      920    17101    8                                     GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC('No Host');
      921    17102    8                                     END;
      922    17103    7                                ELSE
      923    17104    7                                     IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.NMRSP
      924    17105    8                                     THEN DO;
      925    17106    8                                          GJA_VDO_STT.STATE = 'Connecting';
      926    17107    8                                          GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC(
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:33   
             17107                                                   'Connecting');
      927    17108    8                                          END;
      928    17109    7                                     ELSE
      929    17110    7                                          IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.WTPRO
      930    17111    8                                          THEN DO;
      931    17112    8                                               GJA_VDO_STT.STATE ='Profile';
      932    17113    8                                               GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC(
             17113                                                        'Profile');
      933    17114    8                                               END;
      934    17115    8                                          ELSE DO;
      935    17116        /*
      936    17117                if the .8000 bit has been reset via the attr field in netcon then
      937    17118                use the old display
      938    17119        */
      939    17120    9                                               IF (BINBIT(GJA_ATTR,16) & '8000'X) =
             17120                                                        '0'B THEN DO;
      940    17121    9                                                    GJA_VDO_STT.DAT1.BYTSIZ = CHARPOS -
             17121                                                             1;
      941    17122    9                                                    END;
      942    17123    9                                               ELSE DO;
      943    17124    9                                                    GJA_VDO_STT.STATE = 'Logging on';
      944    17125    9                                                    GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC(
             17125                                                             'Logging on');
      945    17126    9                                                    END;
      946    17127    8                                               END;
      947    17128    7                                SIZE = LENGTHC(GJA_VDO_STT) - LENGTHC(GJA_VDO_STT.STATE
             17128                                         )
      948    17129    7                                  + GJA_VDO_STT.DAT1.BYTSIZ;
      949    17130    7                                CALL GJA$Q_MSG(KNH$MESS.UID$,SIZE,GJA_VDO_STT);
      950    17131        /*
      951    17132          FNC = Data
      952    17133        */
      953    17134    7                              CASE(%KV_VDO_FNC_DAT);
      954    17135    7                                IF WHO = %GJA_UID_NM OR WHO = %GJA_UID_HANDLER
      955    17136    7                                  OR WHO = %GJA_UID_BABOON
      956    17137    7                                THEN CALL GJA$DECODE_APL_MSG(GJA$PARAMS,CTX$) ALTRET(
             17137                                         GETOUT);
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:34   
      957    17138
      958    17139    7                                ELSE IF WHO = %GJA_UID_LOGON
      959    17140    8                                     THEN DO;
      960    17141    8                                          IF NOT(KNH$MESS.UID$->GJA$LGNCTX.STATUS.
             17141                                                   LGNRSP)
      961    17142    8                                          THEN CALL M$XXX;
      962    17143    9                                          ELSE DO;
      963    17144   10                                               IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.
             17144                                                        RDPND = '0'B THEN DO;
      964    17145   10                                                    GJA_SYSLOG.FCN = IGA_SYSLOG;
      965    17146   10                                                    GJA_SYSLOG.ERRLOG.ERRCODE.ERR# = %
             17146                                                             E$READ_ERR;
      966    17147   10                                                    CALL KHC$UTS(GJA_SYSLOG.ERRLOG.UTS)
             17147                                                             ;
      967    17148   10                                                    GJA_SYSLOG.ERRLOG.TERMID = KNH$MESS
             17148                                                             .UID$->GJA$LGNCTX.TERMINAL_ID;
      968    17149   10                                                    ADDR(GJA_SYSLOG.ERRLOG.VALUES(0))->
             17149                                                             B$PTR$ = APP$;
      969    17150   10                                                    CALL GJA$NETWORK_MANAGER(GJA_SYSLOG
             17150                                                             ,SIZEC(GJA_SYSLOG)-SIZEC(
             17150                                                             GJA_SYSLOG.ERRLOG.DATA));
      970    17151   10                                                    END;
      971    17152   10                                               ELSE DO;
      972    17153   10                                                    KNH$MESS.UID$->GJA$LGNCTX.MSG$=APP$
             17153                                                             ;
      973    17154   10                                                    CALL GJA$SOLICIT_NM(KNH$MESS.UID$,
             17154                                                             GJA$PARAMS.DATSIZE);
      974    17155   10                                                    END;
      975    17156    9                                               END;
      976    17157    8                                          END;
      977    17158
      978    17159
      979    17160
      980    17161    7                              CASE (%KV_VDO_FNC_DSC_RQS);
      981    17162    7                                IF WHO ~= %GJA_UID_LOGON
      982    17163    7                                THEN CALL M$XXX;
      983    17164
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:35   
      984    17165        /* If we are waiting a response from the NETWORK MANAGER then
      985    17166           just set the TERM status in the CTX. */
      986    17167    7                                IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.NMRSP
      987    17168    7                                  OR KNH$MESS.UID$->GJA$LGNCTX.STATUS.WTPRO
      988    17169    7                                THEN
      989    17170    7                                     KNH$MESS.UID$->GJA$LGNCTX.STATUS.DSCRCV = '1'B;
      990    17171    8                                ELSE DO;
      991    17172    8                                     CALL GJA$Q_MSG(KNH$MESS.UID$,,,SIZEC(GJA_TERM),
             17172                                              GJA_TERM,%KN_FCN_TERM);
      992    17173    8                                     KNH$MESS.UID$->GJA$LGNCTX.STATUS.TERMACK = '1'B;
      993    17174    8                                     END;
      994    17175
      995    17176
      996    17177
      997    17178
      998    17179    7                              CASE(ELSE);
      999    17180                      /*N* Should screech here but half to wait until we handler all FNCs */
     1000    17181
     1001    17182    7                                END;       /* VDO CASE                 */
     1002    17183
     1003    17184
     1004    17185
     1005    17186    6                             IF POFFW(VLP$,MSG$) >= MSGSIZ
     1006    17187    6                             THEN EXIT VDOLOOP;
     1007    17188    6                             ELSE VDO$=VLP$;
     1008    17189    6                             END;          /* VDO LOOP                 */
     1009    17190    5                        END;
     1010    17191        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:36   
     1011    17192    4                 CASE(ELSE);
     1012    17193    4                   CALL M$XXX;
     1013    17194    4                   END;                    /* %KC_FCN CASE             */
     1014    17195        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:37   
     1015    17196        /*
     1016    17197           Decrement the scan size by the size of the message just processed
     1017    17198           and update the removal pointer taking wrap into account if necessary.
     1018    17199        */
     1019    17200    3                SCNSIZ=SCNSIZ-MSGSIZ;
     1020    17201    3                CQ$QHDR.RCQ.RPTR = CQ$QHDR.RCQ.RPTR + MSGSIZ;
     1021    17202    3                IF CQ$QHDR.RCQ.RPTR >= CQ$QHDR.RCQ.SZ
     1022    17203    3                THEN CQ$QHDR.RCQ.RPTR = 0;
     1023    17204    3                END;                       /* SCAN RECEIVE QUEUE       */
     1024    17205        /*
     1025    17206                  IF CQ$QHDR.RCQ.IPTR ~= CQ$QHDR.RCQ.RPTR
     1026    17207                       THEN GOTO SCAN;
     1027    17208         */
     1028    17209        /*
     1029    17210          We're done scanning the queue.  Write out the messages we've placed
     1030    17211          in our send CQ (if any) and go to sleep.
     1031    17212        */
     1032    17213    2   GETOUT: ;
     1033    17214    2           CALL M$WRTMLT(FPT_WRTMLT);
     1034    17215    2           CALL KHC$WAIT;
     1035    17216    2           END;                            /* FOREVER                  */
     1036    17217    1   END GJA$ADMIN;
     1037    17218        %EOD;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:38   
--  Include file information  --

   KV$VDO.:E05TOU  is referenced.
   KV$VDH.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   K_REASON_C.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KN_ERRORS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   GJA_MSG_M.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_JIT_M.:E05TOU  is referenced.
      No diagnostics issued in procedure GJA$ADMIN.

   Procedure GJA$ADMIN requires 3088 words for executable code.
   Procedure GJA$ADMIN requires 80 words of local(AUTO) storage.

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:39   

 Object Unit name= GJA$ADMIN                                  File name= GJA$ADMIN.:E05TOU
 UTS= JUL 29 '97 21:50:25.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none   223     DF  GJA$ADMIN
    1  RoData even  UTS     52     34  GJA$ADMIN
    2   DCB   even  none     0      0  M$CQ
    3   Proc  even  none  3088    C10  GJA$ADMIN
    4  RoData even  none     7      7  GJA$ADMIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Main       0  GJA$ADMIN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:40   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 GJA$CONFIG
 yes     yes           Std       2 KVB$GETSYS
         yes           Std       1 GJA$DISOLVE_LGNUSR_CTX
 yes     yes           Std       1 GJA$LOGON_REQUEST_AGAIN
 yes     yes           Std       1 GJA$HOST_RECOVERY
 yes     yes           Std       1 KHC$UTS
 yes     yes           Std       0 KHC$WAIT
 yes     yes           Std       2 GJA$DECODE_APL_MSG
         yes           Std       0 GIJ$ABORTDUMP
 yes     yes           Std       1 KVB$INT
         yes           Std       1 GJA$SOLICIT_LOGON
 yes     yes           Std       2 GJA$NETWORK_MANAGER
 yes     yes           Std       2 KVB$RLSSYS
 yes     yes           Std       1 KHC$DISPATCH
         yes           Std       6 GJA$Q_MSG
         yes           Std       6 GJA$WRITE
         yes           Std       2 GJA$SOLICIT_NM
         yes           Std       1 GJA$LOGON_TIMEOUT
 yes     yes           Std       3 GJA$LOGON_REQUEST
         yes           Std       1 GJA$NODEINFO
         yes           Std       1 GJA$DISOLVE_NA
         yes           Std       1 GJA$TERM_HANDLER
                       nStd      0 X6A_MAUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:41   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     GJA_SYSLOG                            KH_CTLTBL$                            GJA_VDOBYTSIZ
     GJA_VDO_MRK                           GJA_LDDAT                             G$DS1$
     G$DS4$                                GID_BOOTCHAN                          GJA_INTLEV
     GJA_ATTR                              GJA_LDCT_NM                           GJA_LDCT_BABOON
     GJA_MAXNODE                           GJA_UID_NM                            GJA_UID_BABOON
     GJA_USRLGN_HEAD$                      GJA_HAND_HEAD$                        GJA_HOPCOST
     GJA_ROUTE$                            GJA_OSIROUTE$                         GJA_OSIMAX#
     GJA_LINKS                             GJA_LINK$                             GJA_NM_HEAD$
     GJA_NODE#                             GJA_CHNLOW$                           GJA_NODENAME
     GJA_CHNHI$                            GJA_CHNLOW                            GJA_CHNHI
     GJA_CHNFREE$                          GJA_RETRYMAX                          GJA_UID_NANM$
     G$HAND_Q$                             GJA_DEFNODE                           GJA_MAXRDS
     GJA_RCQSIZE                           GJA_SCQSIZE                           GJA_MEMORY
     GJA_TERM                              GJA_TERM_ACK                          GJA_CONNECT
     GJA_CONNECT_ACK                       GJA_VDO_DAT_DAT2                      GJA_MSG_DOWN$
     GJA_MSG_LINKDOWN$                     GJA_MSG_HOSTDOWN$                     GJA_VDO_STT
     M$CQ                             r    G$ROS$
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:42   


        1        1        /*M* GJA$ADMIN - Node Administrator main routine.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0,CRM=70  */
        8        8        /*P*    NAME:   GJA$ADMIN
        9        9                PURPOSE: This module contains the node admin init routine as
       10       10                         well as the routine that co_ordinates node admin
       11       11                         processing.
       12       12        */
       13       13
       14       14
       15       15        /*F*  NAME:    GJA$ADMIN
       16       16
       17       17              PURPOSE: This routine co-ordinates node admin processing.  Its
       18       18                       gets entered when there are messages to process in the
       19       19                       node admin receive circular queue.
       20       20
       21       21              DESCRIPTION: This routine gets entered at system startup and
       22       22                           initializes the node administrator.  It sets up
       23       23                           node admins CQ and issues a connect to the network
       24       24                           manager.
       25       25
       26       26                           GJA$ADMIN then scans the receive circular queue
       27       27                           processing messages one at a time.  When a message
       28       28                           is decoded, it is either handled here or a seperate
       29       29                           routine is called to do the processing.  When the
       30       30                           receive queue is depleted, we write out the send
       31       31                           circular queue and go to sleep.
       32       32        */
       33       33        GJA$ADMIN: PROC MAIN;

     33   3 000000  D380 0000 0000  xent GJA$ADMIN       LNJ,B5   X6A_MAUTO
          3 000003       0050 0000                       DC       80,0
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:43   

       34       34
       35       35        %INCLUDE G_JIT_M;
       36      300        %INCLUDE LCP_6;
       37     4579        %INCLUDE G$BOBCAT_M;
       38     4599        %INCLUDE GJA_MSG_M;                /* Node Admin message macros     */
       39     4838        %INCLUDE GM_VIRTUAL_E;
       40     5048        %INCLUDE KH$CLK;
       41     5418        %INCLUDE KH$CHN;
       42     5540        %INCLUDE K_ADDRESS_M;
       43     6043        %INCLUDE KN_ERRORS_C;
       44     6107        %INCLUDE KH_MACRO_C;
       45     6850        %INCLUDE KI_ERRORS_C;
       46     6935        %INCLUDE KL_AFCN_C;                     /* 'IGA' Function Codes     */
       47     7036        %INCLUDE KL_CONTROL_C;
       48     7416        %INCLUDE KL_MACRO_C;               /* Application message formats   */
       49    10768        %INCLUDE KNN_NETWORK_M;
       50    11131        %INCLUDE K_REASON_C;
       51    11157        %INCLUDE KNH_MACRO_C;                   /* CQ macros                */
       52    11440        %INCLUDE KV$VDH;
       53    11871        %INCLUDE KV$VDO;
       54    12886
       55    12887                                                /* EQUs and SUBs            */
       56    12888        %KV_VDO_ALL_E;
       57    12967        %GJA_UID_EQUS;
       58    12975        %G$JIT_E;
       59    13037                                                /* FPTs                     */
       60    13038        %FPT_SPRIV (PRC=YES,AUTH=YES,PRIV=PRIVS);
       61    13061        %FPT_CVM (FPTN=GET_BOBCAT,FROMSEG=FROMSEG,USERSEG=USERSEG,TYPE=MON,PAGES=256);
       62    13085        %VLP_SEGMENT(FPTN=USERSEG);
       63    13106        %VLP_SEGMENT(FPTN=FROMSEG);
       64    13127        %FPT_GDS(FPTN=FPT_GETMEM,FREE=YES,NEXT=BIG,PAGES=20,RESULTS=GJA_MEMORY_RESULTS);
       65    13151        %VLP_SEGMENT(FPTN=GJA_MEMORY_RESULTS);
       66    13172        %FPT_OPEN(FPTN=FPT_CQOPEN,ORG=CQ,HMI=VLP_HMI,DCB=M$CQ);
       67    13200        %VLP_HMI(RCQSIZE=4096,SCQSIZE=4096);
       68    13216        %FPT_TRAP (NTC=VLP_TRAP_CONDITIONS);
       69    13231        %VLP_TRAP_CONDITIONS (IGN_IO=G_YES#);
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:44   
       70    13387        %FPT_WRTMLT(DCB=M$CQ);
       71    13407        %KL_SYSLOG(FPTN=GJA_SYSLOG,LAST=",",STCLASS=SYMREF);
       72    13431        %KL_ERRLOG(FPTN=ERRLOG,LAST=",",LVL=2,STCLASS=SYMREF);
       73    13539    1           3 DATA CHAR(200) UNAL;
       74    13540        %VLP_ERRCODE(FPTN=E$READ_ERR,FCG=GJ,MID=A,MON='1'B,ERR#=%E$READ_ERR,SEV=
             13540            %G_SEV_ERROR#);
       75    13586        /*E* ERROR: GJA-E$READ_ERR
       76    13587             MESSAGE: Read complete without read pending.
       77    13588             MESSAGE1: nodeadmn received data from a logon connection which
       78    13589                       had no read out standing.  the message has been discarded.*/
       79    13590
       80    13591        /*E* ERROR: GJA-E$LINK_UP
       81    13592             MESSAGE: X.25 link is now active. VALUE(0) is connecting node#.
       82    13593             MESSAGE1: An X.25 link to or from a remote fep is now active.*/
       83    13594
       84    13595        /*E* ERROR: GJA-E$LINK_DOWN
       85    13596             MESSAGE: X.25 link is now inactive.  Value(0) is disconnecting node#.
       86    13597             MESSAGE1: An X.25 link to or from a remote fep is now inactive.*/
       87    13598
       88    13599        %FPT_TIME(SOURCE=CLOCK,DEST=UTS);
       89    13623    1   DCL B$PTR$ PTR BASED;
       90    13624                                                /* Internal Data            */
       91    13625    1   DCL PRIVS BIT(32) CONSTANT INIT(
       92    13626    1   %(G_PR_MSYS#|G_PR_CQ#|G_PR_SCREECH#|G_PR_SNAP#|G_PR_EXMM#|G_PR_SPCLMM#));
       93    13627        %KL_MES (FPTN=GJA_KL_MES,STCLASS=CONSTANT,CODE=IGA_INIT_DONE);
       94    13650        %KV$VDH_VDHINT(STCLASS=STATIC,BUSYBFRS=YES,BITMAPBFRS=YES,VLDBFR=YES,VLDAFTRLS=YES,
             13650            VLDAFTGET=YES);
       95    13669    1   DCL KH_CTLTBL$ PTR SYMREF;
       96    13670        %KV_VDOBYTSIZ (NAME=GJA_VDOBYTSIZ,STCLASS=SYMREF);
       97    13690        %KV$VDO_MRK (NAME=GJA_VDO_MRK,LAST=",",STCLASS=SYMREF);
       98    13731             %KV$VDOVLP_MRK (NAME=MRK,LVL=2);
       99    13784        %KV$VDO_DAT (NAME=GJA_LDDAT,STCLASS=SYMREF,LAST=",");
      100    13829             %KV$VDOVLP_ERR(NAME=ERR,STCLASS=SYMREF,LST=YES,LVL=2);
      101    13926        %KV$VDO_RQSDAT(NAME=KV_VDO_RQSDAT,FNC=KV_VDO_FNC_RQSDAT,
      102    13927                       MAXRCRBYTSIZ=4096,MAXNMBRCR=999,MAXNMBBYT=4096,
      103    13928                       STCLASS=CONSTANT);
      104    13976        %KH$EXP (FPTN=KH_EXP,STCLASS=STATIC);
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:45   
      105    14039        %KH$CTLTBL (FPTN=CTLTBL,STCLASS=STATIC,HIPARM=%KL_NA_HI);
      106    14251        %KV$VDO_DAT(NAME=VDO_NODAT,STCLASS=CONSTANT,LAST=",",VLP=YES,FNC=KV_VDO_FNC_DAT);
      107    14296             %KV$VDOVLP_ERR (NAME=ERR,FCG=GJ,MID=A,MON='1'B,ERR#=%E$NODAT,SEV=0,STCLASS=
             14296                 CONSTANT,LVL=2);
      108    14393
      109    14394
      110    14395                                                /* External Data            */
      111    14396    1   DCL G$DS1$ PTR SYMREF;
      112    14397    1   DCL G$DS4$ PTR SYMREF;
      113    14398    1   DCL GID_BOOTCHAN UBIN SYMREF;
      114    14399    1   DCL GJA_FIRST_TIME BIT(1) SYMREF;
      115    14400    1   DCL GJA_INTLEV UBIN SYMREF;
      116    14401    1   DCL GJA_ATTR UBIN SYMREF;
      117    14402    1   DCL ATTR UBIN(16);
      118    14403    1   DCL GJA_LDCT_NM UBIN SYMREF;
      119    14404    1   DCL GJA_LDCT_BABOON UBIN SYMREF;
      120    14405    1   DCL GJA_MAXNODE UBIN SYMREF;
      121    14406    1   DCL GJA_UID_NM UBIN(32) SYMREF;
      122    14407    1   DCL GJA_UID_NM$ REDEF GJA_UID_NM PTR;
      123    14408    1   DCL GJA_UID_BABOON UBIN(32) SYMREF;
      124    14409    1   DCL GJA_UID_BABOON$ REDEF GJA_UID_BABOON PTR;
      125    14410    1   DCL GJA_USRLGN_HEAD$ PTR SYMREF;
      126    14411    1   DCL GJA_HAND_HEAD$ PTR SYMREF;
      127    14412    1   DCL GJA_HOPCOST UBIN SYMREF;
      128    14413    1   DCL GJA_ROUTE$ PTR SYMREF;
      129    14414    1   DCL GJA_OSIROUTE$ PTR SYMREF;      /* ptr to array of osiroute ptrs */
      130    14415    1   DCL GJA_OSIMAX# UBIN SYMREF;
      131    14416    1   DCL GJA_LINKS UBIN SYMREF;
      132    14417    1   DCL GJA_LINK$ PTR SYMREF;
      133    14418    1   DCL GJA_NM_HEAD$ PTR SYMREF;
      134    14419    1   DCL GJA_NODE# UBIN SYMREF;
      135    14420    1   DCL GJA_CHNLOW$ PTR SYMREF;
      136    14421    1   DCL GJA_NODENAME CHAR(8) SYMREF;
      137    14422    1   DCL GJA_CHNHI$ PTR SYMREF;
      138    14423    1   DCL GJA_CHNLOW UBIN SYMREF;
      139    14424    1   DCL GJA_CHNHI UBIN SYMREF;
      140    14425    1   DCL GJA_CHNFREE$ PTR SYMREF;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:46   
      141    14426    1   DCL GJA_RETRYMAX UBIN SYMREF;
      142    14427    1   DCL GJA_UID_NANM$ PTR SYMREF;
      143    14428    1   DCL G$HAND_Q$ PTR SYMREF;
      144    14429    1   DCL GJA_DEFNODE UBIN SYMREF;
      145    14430    1   DCL GJA_HSTRSMED BIT(1) SYMREF;
      146    14431    1   DCL GJA_MAXRDS UBIN SYMREF;
      147    14432    1   DCL GJA_MSG_SGSYN$ PTR SYMREF;
      148    14433    1   DCL GJA_MSG_BDID$ PTR SYMREF;
      149    14434    1   DCL GJA_MSG_NOHOST$ PTR SYMREF;
      150    14435    1   DCL GJA_MSG_UDHOST$ PTR SYMREF;
      151    14436    1   DCL GJA_RCQSIZE UBIN SYMREF;
      152    14437    1   DCL GJA_SCQSIZE UBIN SYMREF;
      153    14438    1   DCL GJA_MEMORY UBIN SYMREF;
      154    14439        %FPT_TERM(FPTN=GJA_TERM,STCLASS=SYMREF);
      155    14461        %FPT_TERM_ACK(FPTN=GJA_TERM_ACK,STCLASS=SYMREF);
      156    14483        %FPT_CONNECT(FPTN=GJA_CONNECT,STCLASS=SYMREF);
      157    14552        %FPT_CONNECT_ACK (FPTN=GJA_CONNECT_ACK,STCLASS=SYMREF);
      158    14601        %KV$VDO_DAT (NAME=GJA_VDO_DAT_DAT2,STCLASS=SYMREF);
      159    14646
      160    14647
      161    14648                                                /* BASED                    */
      162    14649    1   DCL B$DWORD UBIN(32) BASED ALIGNED;
      163    14650    1   DCL KNN$ROUTE$(0:0) PTR BASED(GJA_ROUTE$);
      164    14651    1   DCL KNN$LINK$(0:0) PTR BASED(GJA_LINK$);
      165    14652    1   DCL GJA_MSG_DOWN$ PTR SYMREF;
      166    14653    1   DCL GJA_MSG_LINKDOWN$ PTR SYMREF;
      167    14654    1   DCL GJA_MSG_HOSTDOWN$ PTR SYMREF;
      168    14655        %KNN$ROUTE (STCLASS="BASED(ROUTE$)");
      169    14727        %KNN$LINK(STCLASS=BASED);
      170    14978    1   DCL STRING CHAR(SIZE) BASED;
      171    14979    1   DCL 1 SV$MSG BASED(MSG$),
      172    14980    1         2 BFRSIZ UBIN,     /* size of the buffer, so we can use 2nsys */
      173    14981    1         2 LNK$ PTR,
      174    14982    1         2 SZ UBIN,
      175    14983    1         2 VFC CHAR(1) UNAL,
      176    14984    1         2 * CHAR(1) UNAL;
      177    14985        %FPT_CONNECT_ACK(STCLASS="BASED(FPT$)");
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:47   
      178    15034        %FPT_CONNECT (FPTN=FPT$CONNECT,STCLASS="BASED(FPT$)");
      179    15103        %G$BOBCAT (STCLASS="BASED(G$DS4$)");
      180    15116        %GJA$LGNCTX(STCLASS="BASED(CTX$)");
      181    15201        %GJA$HAND_CTX (STCLASS="BASED(CTX$)");
      182    15250        %KL_CONTROL_INIT(FPTN=KL$CONTROL,STCLASS="BASED(MSG$)");
      183    15376        %KNH$QHDR(FPTN=CQ$QHDR,STCLASS="BASED(G$HAND_Q$)"); /* CQ header    */
      184    15389        %KNH$MESS(STCLASS="BASED(MSG$)");       /* CQ message template      */
      185    15438        %KV$VDO(NAME=KV$VDO,STCLASS="BASED(VDO$)");
      186    15465        %KV$VDO_RQSDAT (NAME=KV$VDO_RQSDAT,STCLASS="BASED(VDO$)");
      187    15513        %KV$VDO_STT (NAME=GJA_VDO_STT,STCLASS=SYMREF,LAST=",");
      188    15554             %KV$VDOVLP_DAT1(NAME=DAT1,LAST=",",LVL=2);
      189    15604    1         2 STATE CHAR(255);
      190    15605        %KH$CHN(STCLASS=BASED);
      191    15729        %KV$VDOVLP(NAME=KV$VDOVLP,STCLASS="BASED(VLP$)");
      192    15765        %KV$VDOVLP_DAT1;
      193    15815        %KV$VDOVLP_DAT2;
      194    15865          %KV$VDOVLP_ACTPOS;
      195    15916        %KV$VDOVLP_CG_MSGTYP;
      196    15968        %KV$VDOVLP_CG_STA;
      197    16019        %KV$VDOVLP_ERR;
      198    16116        %KV$VDOVLP_FLDID;
      199    16167        %KV$VDOVLP_KEY;
      200    16217        %KV$VDOVLP_MRK;
      201    16270        %KV$VDOVLP_CG_MSGID;
      202    16322
      203    16323
      204    16324                                                /* AUTO                     */
      205    16325        %GJA$PARAMS(STCLASS="");
      206    16340    1   DCL VLPSIZE UBIN;
      207    16341    1   DCL WHO UBIN;
      208    16342    1   DCL CHN$ PTR;
      209    16343    1   DCL MSG$ PTR;                 /* Pointer to MSG we are processing   */
      210    16344    1   DCL APP$ PTR;            /* Points to application specific message  */
      211    16345    1   DCL FPT$ PTR;            /* Pointer to the FPT portion of a message */
      212    16346    1   DCL CTX$ PTR;                      /* Pointer to handler context    */
      213    16347    1   DCL SVMSG$ PTR;
      214    16348    1   DCL VLP$ PTR;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:48   
      215    16349    1   DCL VDO$ PTR;
      216    16350    1   DCL MSGSIZ UBIN;                        /* Byte size of message     */
      217    16351    1   DCL ROUTE$ PTR;
      218    16352    1   DCL SCNSIZ SBIN;                   /* Number of bytes left to scan  */
      219    16353    1   DCL SIZE UBIN;
      220    16354    1   DCL LAST BIT(1);
      221    16355    1   DCL RECOVERY_NODE UBIN(32);
      222    16356        %KV$VDO_RQSDAT(NAME=KV@VDO_RQSDAT,STCLASS=AUTO);
      223    16404    1   DCL UNFLOW UBIN;
      224    16405    1   DCL MSGWTSIZE UBIN;
      225    16406    1   DCL SVCTX$ PTR;
      226    16407    1   DCL STRLEN UBIN;
      227    16408    1   DCL CHARPOS UBIN;
      228    16409    1   DCL NMAVAIL BIT(1);
      229    16410                                                /* DCBs                     */
      230    16411    1   DCL M$CQ DCB;
      231    16412                                                /* ENTRYS                   */
      232    16413    1   DCL GIJ$ABORTDUMP ENTRY;
      233    16414    1   DCL GJA$DECODE_APL_MSG ENTRY(2) ALTRET;
      234    16415    1   DCL GJA$DISOLVE_LGNUSR_CTX ENTRY(1);
      235    16416    1   DCL GJA$CONFIG ENTRY;
      236    16417    1   DCL GJA$DISOLVE_NA ENTRY(1);
      237    16418    1   DCL GJA$GET_CONFIG_INFO ENTRY (1);
      238    16419    1   DCL GJA$HOST_RECOVERY ENTRY(1) ALTRET;
      239    16420    1   DCL GJA$HOST_RESUMED ENTRY ALTRET;
      240    16421    1   DCL GJA$NETWORK_MANAGER ENTRY(2) ALTRET;
      241    16422    1   DCL GJA$LOGON_REQUEST ENTRY(3) ALTRET;
      242    16423    1   DCL GJA$LOGON_REQUEST_AGAIN ENTRY(1) ALTRET;
      243    16424    1   DCL KHC$UTS ENTRY(1) ALTRET;
      244    16425    1   DCL GJA$LOGON_TIMEOUT ENTRY(1);
      245    16426    1   DCL GJA$NODEINFO ENTRY(1);
      246    16427    1   DCL GJA$Q_MSG ENTRY(6);
      247    16428    1   DCL GJA$SOLICIT_LOGON ENTRY(1);
      248    16429    1   DCL GJA$SOLICIT_NM ENTRY(2);
      249    16430    1   DCL GJA$TERM_HANDLER ENTRY(1);
      250    16431    1   DCL GJA$WRITE ENTRY(6);
      251    16432    1   DCL KHC$DISPATCH ENTRY(1) ALTRET;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:49   
      252    16433    1   DCL KHC$WAIT ENTRY ALTRET;
      253    16434    1   DCL KVB$GET2NSYS ENTRY(2) ALTRET;
      254    16435    1   DCL KVB$GETSYS ENTRY(2) ALTRET;
      255    16436    1   DCL KVB$INT ENTRY(1) ALTRET;
      256    16437    1   DCL KVB$RLS2NSYS ENTRY(2) ALTRET;
      257    16438    1   DCL KVB$RLSSYS ENTRY(2) ALTRET;
      258    16439        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:50   
      259    16440        /* Node Admin Initialization
      260    16441        */
      261    16442    1      KH_CTLTBL$ = ADDR(CTLTBL);

  16442   3 000005  EB80 0000 0099  00                   LAB,B6   CTLTBL
          3 000008  EF80 0000 0000  xsym                 STB,B6   KH_CTLTBL$

      262    16443    1      CTLTBL.PARM.PTR$(%KL_HNDLRPARM_INTLVL) = ADDR(GJA_INTLEV);

  16443   3 00000B  DB80 0000 0000  xsym                 LAB,B5   GJA_INTLEV
          3 00000E  DF80 0000 009B  00                   STB,B5   CTLTBL+2

      263    16444        /* Get privileged, take trap control and open the CQ DCB.
      264    16445        */
      265    16446    1      CALL M$SPRIV (FPT_SPRIV);

  16446   3 000011  BB80 0000 0000  00                   LAB,B3   FPT_SPRIV
          3 000014  B870 0CD0                            LDR,R3   3280,IMO
          3 000016  0001                                 MCL
          3 000017       0000                            DC       s:16446+6,PREL

      266    16447    1      CALL M$SYS;

  16447   3 000018  3C43                                 LDV,R3   67
          3 000019  0001                                 MCL
          3 00001A       0000                            DC       s:16447+2,PREL

      267    16448    1      CALL M$TRAP(FPT_TRAP);

  16448   3 00001B  BB80 0000 005A  00                   LAB,B3   FPT_TRAP
          3 00001E  B870 08C3                            LDR,R3   2243,IMO
          3 000020  0001                                 MCL
          3 000021       0000                            DC       s:16448+6,PREL

      268    16449        /* Map onto the BOBCAT segment in the monitor */
      269    16450    1      FROMSEG.BASE = %GM_BOBCAT_BASE;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:51   
  16450   3 000022  8CF0 000C 0000                       LDI      786432,IMO
          3 000025  8D00 0000 0019  00                   SDI      FROMSEG

      270    16451    1      USERSEG.BASE = %GM_USRDS4_BASE;

  16451   3 000028  8D00 0000 0016  00                   SDI      USERSEG

      271    16452    1      CALL M$CVM (GET_BOBCAT);

  16452   3 00002B  BB80 0000 000A  00                   LAB,B3   GET_BOBCAT
          3 00002E  B870 0D08                            LDR,R3   3336,IMO
          3 000030  0001                                 MCL
          3 000031       0000                            DC       s:16452+6,PREL

      272    16453    1      GJA_MAXNODE = G$BOBCAT.NODES;

  16453   3 000032  EC80 0000 0000  xsym                 LDB,B6   G$DS4$
          3 000035  E846 0015                            LDR,R6   21,B6
          3 000037  EF00 0000 0000  xsym                 STR,R6   GJA_MAXNODE

      273    16454    1      GJA_NODE# = G$BOBCAT.FEP#;

  16454   3 00003A  D806                                 LDR,R5   ,B6
          3 00003B  DF00 0000 0000  xsym                 STR,R5   GJA_NODE#

      274    16455    1      GJA_NODENAME = G$BOBCAT.NODENAME;

  16455   3 00003E  AB86                                 LAB,B2   ,B6
          3 00003F  2C02                                 LDV,R2   2
          3 000040  6C08                                 LDV,R6   8
          3 000041  BB80 0000 0000  xsym                 LAB,B3   GJA_NODENAME
          3 000044  3C00                                 LDV,R3   0
          3 000045  0008                                 MMM

      275    16456    1      GJA_DEFNODE = G$BOBCAT.HOSTNODE;

  16456   3 000046  DC80 0000 0000  xsym                 LDB,B5   G$DS4$
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:52   
          3 000049  E845 0061                            LDR,R6   97,B5
          3 00004B  EF00 0000 0000  xsym                 STR,R6   GJA_DEFNODE

      276    16457    1      GJA_ROUTE$ = G$BOBCAT.ROUTE$$;

  16457   3 00004E  CCC5 0030                            LDB,B4   48,B5
          3 000050  CF80 0000 0000  xsym                 STB,B4   GJA_ROUTE$

      277    16458    1      GJA_OSIROUTE$ = G$BOBCAT.OSIROUTE$;

  16458   3 000053  BCC5 0065                            LDB,B3   101,B5
          3 000055  BF80 0000 0000  xsym                 STB,B3   GJA_OSIROUTE$

      278    16459    1      GJA_OSIMAX# = G$BOBCAT.OSIROUTE#;

  16459   3 000058  D845 0062                            LDR,R5   98,B5
          3 00005A  DF00 0000 0000  xsym                 STR,R5   GJA_OSIMAX#

      279    16460    1      GJA_LINKS = G$BOBCAT.LINKS;

  16460   3 00005D  C845 0016                            LDR,R4   22,B5
          3 00005F  CF00 0000 0000  xsym                 STR,R4   GJA_LINKS

      280    16461    1      GJA_LINK$ = G$BOBCAT.LINK$$;

  16461   3 000062  9CC5 0032                            LDB,B1   50,B5
          3 000064  9F80 0000 0000  xsym                 STB,B1   GJA_LINK$

      281    16462
      282    16463        /* Get the NA control parameters */
      283    16464    1      MSG$ = PINCRW(G$DS1$,PINCRW(G$DS1$,2)->B$DWORD);

  16464   3 000067  EC80 0000 0000  xsym                 LDB,B6   G$DS1$
          3 00006A  8CC6 0002                            LDI      2,B6
          3 00006C  8400 0000 0000  xsym                 AID      G$DS1$
          3 00006F  8D47 0020                            SDI      MSG$,AUTO

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:53   
      284    16465    1      IF MSG$->KL$CONTROL.TYPE = 1         /* Paremeters present       */

  16465   3 000071  ACC7 0020                            LDB,B2   MSG$,AUTO
          3 000073  B802                                 LDR,R3   ,B2
          3 000074  B570 00FF                            AND,R3   255,IMO
          3 000076  3D01                                 CMV,R3   1
          3 000077  0981 0042                            BNE      s:16492,PREL

      285    16466    2      THEN DO;

      286    16467    2           IF MSG$->KL$CONTROL.NUM_FPARAM >= %KL_HNDLRPARM_MEM

  16467   3 000079  A842 0012                            LDR,R2   18,B2
          3 00007B  2D01                                 CMV,R2   1
          3 00007C  0201 0009                            BL       s:16472,PREL

      287    16468    3           THEN DO;

      288    16469    3                FPT_GETMEM.V.PAGES = KL$CONTROL.FPARAM(%KL_HNDLRPARM_MEM);

  16469   3 00007E  9842 0015                            LDR,R1   21,B2
          3 000080  9F00 0000 0022  00                   STR,R1   FPT_GETMEM+6

      289    16470    3                GJA_MEMORY = FPT_GETMEM.V.PAGES;

  16470   3 000083  9F00 0000 0000  xsym                 STR,R1   GJA_MEMORY

      290    16471    3                END;

      291    16472    2           IF MSG$->KL$CONTROL.NUM_FPARAM > %KL_HNDLRPARM_RCVCQBYTSIZ

  16472   3 000086  B842 0012                            LDR,R3   18,B2
          3 000088  3D0C                                 CMV,R3   12
          3 000089  0381 0009                            BLE      s:16477,PREL

      292    16473    3           THEN DO;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:54   
      293    16474    3                VLP_HMI.RCQSIZE = KL$CONTROL.FPARAM(%KL_HNDLRPARM_RCVCQBYTSIZ);

  16474   3 00008B  A842 0020                            LDR,R2   32,B2
          3 00008D  AF00 0000 0057  00                   STR,R2   VLP_HMI+1

      294    16475    3                GJA_RCQSIZE = VLP_HMI.RCQSIZE;

  16475   3 000090  AF00 0000 0000  xsym                 STR,R2   GJA_RCQSIZE

      295    16476    3                END;

      296    16477    2           IF MSG$->KL$CONTROL.NUM_FPARAM > %KL_HNDLRPARM_SNDCQBYTSIZ

  16477   3 000093  B842 0012                            LDR,R3   18,B2
          3 000095  3D0D                                 CMV,R3   13
          3 000096  0381 0009                            BLE      s:16482,PREL

      297    16478    3           THEN DO;

      298    16479    3                VLP_HMI.SCQSIZE = KL$CONTROL.FPARAM(%KL_HNDLRPARM_SNDCQBYTSIZ);

  16479   3 000098  A842 0021                            LDR,R2   33,B2
          3 00009A  AF00 0000 0056  00                   STR,R2   VLP_HMI

      299    16480    3                GJA_SCQSIZE = VLP_HMI.SCQSIZE;

  16480   3 00009D  AF00 0000 0000  xsym                 STR,R2   GJA_SCQSIZE

      300    16481    3                END;

      301    16482    2           IF MSG$->KL$CONTROL.NUM_FPARAM >= %KL_NA_HOPCOST

  16482   3 0000A0  B842 0012                            LDR,R3   18,B2
          3 0000A2  3D15                                 CMV,R3   21
          3 0000A3  0201 0006                            BL       s:16485,PREL

      302    16483    2           THEN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:55   
      303    16484    2                GJA_HOPCOST = KL$CONTROL.FPARAM(%KL_NA_HOPCOST);

  16484   3 0000A5  A842 0029                            LDR,R2   41,B2
          3 0000A7  AF00 0000 0000  xsym                 STR,R2   GJA_HOPCOST

      304    16485    2           IF MSG$->KL$CONTROL.NUM_FPARAM > %KL_NA_LGNRTRYNUM

  16485   3 0000AA  3D14                                 CMV,R3   20
          3 0000AB  0381 0006                            BLE      s:16488,PREL

      305    16486    2           THEN
      306    16487    2                GJA_RETRYMAX = KL$CONTROL.FPARAM(%KL_NA_LGNRTRYNUM);

  16487   3 0000AD  A842 0028                            LDR,R2   40,B2
          3 0000AF  AF00 0000 0000  xsym                 STR,R2   GJA_RETRYMAX

      307    16488    2           IF MSG$->KL$CONTROL.NUM_FPARAM >= %KL_HNDLRPARM_ATTR THEN

  16488   3 0000B2  3D04                                 CMV,R3   4
          3 0000B3  0201 0006                            BL       s:16492,PREL

      308    16489    2                GJA_ATTR = KL$CONTROL.FPARAM(%KL_HNDLRPARM_ATTR);

  16489   3 0000B5  A842 0018                            LDR,R2   24,B2
          3 0000B7  AF00 0000 0000  xsym                 STR,R2   GJA_ATTR

      309    16490    2           END;

      310    16491
      311    16492    1      CALL M$OPEN(FPT_CQOPEN) WHENALTRETURN

  16492   3 0000BA  BB80 0000 0027  00                   LAB,B3   FPT_CQOPEN
          3 0000BD  B870 3540                            LDR,R3   13632,IMO
          3 0000BF  0001                                 MCL
          3 0000C0       0003                            DC       s:16494,PREL
          3 0000C1  0F81 0005                            B        s:16498,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:56   
      312    16493    2      DO;

      313    16494    2           CALL M$XXX;

  16494   3 0000C3  B870 0082                            LDR,R3   130,IMO
          3 0000C5  0001                                 MCL
          3 0000C6       0000                            DC       s:16494+3,PREL

      314    16495    2           END;

      315    16496        /*  Get some memory and use it to initialize the Node Admin buddy space pool.
      316    16497        */
      317    16498    1      CALL M$GDS(FPT_GETMEM)

  16498   3 0000C7  BB80 0000 001C  00                   LAB,B3   FPT_GETMEM
          3 0000CA  B870 0902                            LDR,R3   2306,IMO
          3 0000CC  0001                                 MCL
          3 0000CD       0003                            DC       s:16500,PREL
          3 0000CE  0F81 0005                            B        s:16502,PREL

      318    16499    2      WHENALTRETURN DO;

      319    16500    2           CALL M$XXX;

  16500   3 0000D0  B870 0082                            LDR,R3   130,IMO
          3 0000D2  0001                                 MCL
          3 0000D3       0000                            DC       s:16500+3,PREL

      320    16501    2           END;

      321    16502    1      KV$VDH_VDHINT.BFRBGN$ = GJA_MEMORY_RESULTS.BASE$;

  16502   3 0000D4  EC80 0000 0024  00                   LDB,B6   GJA_MEMORY_RESULTS
          3 0000D7  EF80 0000 008B  00                   STB,B6   KV$VDH_VDHINT

      322    16503    1      KV$VDH_VDHINT.BFREND$=PINCRW(GJA_MEMORY_RESULTS.BASE$,GJA_MEMORY_RESULTS.PAGES*
             16503               256);
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:57   

  16503   3 0000DA  F800 0000 0026  00                   LDR,R7   GJA_MEMORY_RESULTS+2
          3 0000DD  6C00                                 LDV,R6   0
          3 0000DE  7088                                 DOL,R7   8
          3 0000DF  8400 0000 0024  00                   AID      GJA_MEMORY_RESULTS
          3 0000E2  8D00 0000 008D  00                   SDI      KV$VDH_VDHINT+2

      323    16504    1      CALL KVB$INT(KV$VDH_VDHINT);

  16504   3 0000E5  BB80 0000 0000  04                   LAB,B3   0
          3 0000E8  CBF0 0100                            LAB,B4   256,IMO
          3 0000EA  E380 0000 0000  xent                 LNJ,B6   KVB$INT
          3 0000ED       0001                            DC       s:16508,PREL

      324    16505
      325    16506        /* Setup the channel table.
      326    16507        */
      327    16508    1      GJA_CHNLOW = G$BOBCAT.CHNLOW;

  16508   3 0000EE  EC80 0000 0000  xsym                 LDB,B6   G$DS4$
          3 0000F1  E846 0034                            LDR,R6   52,B6
          3 0000F3  EF00 0000 0000  xsym                 STR,R6   GJA_CHNLOW

      328    16509    1      GJA_CHNLOW$ = G$BOBCAT.CHNLOW$;

  16509   3 0000F6  DCC6 0038                            LDB,B5   56,B6
          3 0000F8  DF80 0000 0000  xsym                 STB,B5   GJA_CHNLOW$

      329    16510    1      GJA_CHNHI$ = G$BOBCAT.CHNHI$;

  16510   3 0000FB  CCC6 003A                            LDB,B4   58,B6
          3 0000FD  CF80 0000 0000  xsym                 STB,B4   GJA_CHNHI$

      330    16511    1      GJA_CHNHI = G$BOBCAT.CHNHI;

  16511   3 000100  D846 0035                            LDR,R5   53,B6
          3 000102  DF00 0000 0000  xsym                 STR,R5   GJA_CHNHI
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:58   

      331    16512    1      GJA_CHNFREE$ = G$BOBCAT.CHNFREE$;

  16512   3 000105  BCC6 003C                            LDB,B3   60,B6
          3 000107  BF80 0000 0000  xsym                 STB,B3   GJA_CHNFREE$

      332    16513    1      GID_BOOTCHAN = G$BOBCAT.BOOTCHAN;

  16513   3 00010A  C846 0005                            LDR,R4   5,B6
          3 00010C  CF00 0000 0000  xsym                 STR,R4   GID_BOOTCHAN

      333    16514
      334    16515        /* Convert the config information passed to us in DS1. */
      335    16516    1      CALL GJA$CONFIG;

  16516   3 00010F  CBF0 0000                            LAB,B4   0,IMO
          3 000111  E380 0000 0000  xent                 LNJ,B6   GJA$CONFIG
          3 000114       0001                            DC       s:16519,PREL

      336    16517
      337    16518        /* Get CTX for the NM connection */
      338    16519    1      SIZE=SIZEW(GJA$HAND_CTX);

  16519   3 000115  6C11                                 LDV,R6   17
          3 000116  EF47 0032                            STR,R6   SIZE,AUTO

      339    16520    1      CALL KVB$GETSYS(SIZE,CTX$);

  16520   3 000118  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 00011A  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 00011C  DBC7 0032                            LAB,B5   SIZE,AUTO
          3 00011E  DFC7 0042                            STB,B5   NMAVAIL+1,AUTO
          3 000120  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000122  CBF0 0200                            LAB,B4   512,IMO
          3 000124  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          3 000127       0001                            DC       s:16521,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:59   
      340    16521    1      GJA_UID_NANM$ = CTX$;

  16521   3 000128  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00012A  EF80 0000 0000  xsym                 STB,B6   GJA_UID_NANM$

      341    16522    1      GJA_HAND_HEAD$ = CTX$;

  16522   3 00012D  EF80 0000 0000  xsym                 STB,B6   GJA_HAND_HEAD$

      342    16523    1      GJA$HAND_CTX = '0'B;

  16523   3 000130  5C22                                 LDV,R5   34
          3 000131  0021                                 ALR      ;
          3 000132       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          3 000134       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

      343    16524    1      GJA$HAND_CTX.WHO = %GJA_UID_NM;

  16524   3 000136  E870 2000                            LDR,R6   8192,IMO
          3 000138  437F                                 CSYNC    s:16524+1,SPREL
          3 000139  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00013B  EA86                                 SRM,R6,'E000'X    ,B6
          3 00013C       E000

      344    16525    1      GJA$HAND_CTX.NAME = 'MANAGER';

  16525   3 00013D  EB80 0000 0000  01                   LAB,B6   PRIVS
          3 000140  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000142  0021                                 ALR      ;
          3 000143       4706 000D                                ALPHANUM(13,B6,,7),;
          3 000145       4805 0009                                ALPHANUM(9,B5,,8,FILL)

      345    16526
      346    16527
      347    16528        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:60   
      348    16529        /* Initialization complete.  Now, loop forever scanning the circular queue.
      349    16530        */
      350    16531    2      DO WHILE (%G_YES#);                  /* FOREVER                  */

      351    16532        /* Check for expired clocks */
      352    16533    3   CLOCK_LOOP:DO WHILE '1'B;

  16533   3                              CLOCK_LOOP      null
      353    16534    3                IF NOT KH_EXP.ABORT

  16534   3 000147  437F                 CLOCK_LOOP      CSYNC    s:16525+9,SPREL
          3 000148  8280 0000 0098  00                   LB,'4000'X        KH_EXP+5
          3 00014B       4000
          3 00014C  057B                                 BBT      s:16531,SPREL

      354    16535    3                THEN
      355    16536    3                     CALL KHC$DISPATCH (KH_EXP)

  16536   3 00014D  BB80 0000 0002  04                   LAB,B3   +2
          3 000150  CBF0 0100                            LAB,B4   256,IMO
          3 000152  E380 0000 0000  xent                 LNJ,B6   KHC$DISPATCH
          3 000155       000C                            DC       s:16542,PREL

      356    16537    4                     WHENRETURN DO;

      357    16538    4                          CALL GJA$LOGON_TIMEOUT(KH_EXP.UID$);

  16538   3 000156  BB80 0000 0002  04                   LAB,B3   +2
          3 000159  CBF0 0100                            LAB,B4   256,IMO
          3 00015B  E380 0000 0000  xent                 LNJ,B6   GJA$LOGON_TIMEOUT
          3 00015E       0001                            DC       s:16540,PREL

      358    16539
      359    16540    4                          END;             /* WHENRETURN               */

  16540   3 00015F  0F81 0009                            B        s:16545,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:61   
      360    16541    4                     WHENALTRETURN DO;

      361    16542    4                          KH_EXP.CTBCTX$ = ADDR(NIL);

  16542   3 000161  EB80 0000 0000                       LAB,B6   0
          3 000164  EF80 0000 0096  00                   STB,B6   KH_EXP+3

      362    16543    4                          EXIT CLOCK_LOOP;

  16543   3 000167  0F81 0002                            B        s:16549,PREL

      363    16544    4                          END;
      364    16545    3                END;

  16545   3 000169  0FDE                                 B        s:16531,SPREL

      365    16546
      366    16547        /*  Figure out how much there is to scan (accounting for wrap)
      367    16548        */
      368    16549    2   SCAN:   SCNSIZ=CQ$QHDR.RCQ.IPTR - CQ$QHDR.RCQ.RPTR;

  16549   3 00016A  DC80 0000 0000  xsym SCAN            LDB,B5   G$HAND_Q$
          3 00016D  E805                                 LDR,R6   ,B5
          3 00016E  E245 0001                            SUB,R6   1,B5
          3 000170  EF47 0031                            STR,R6   SCNSIZ,AUTO

      369    16550    2           IF SCNSIZ < 0

  16550   3 000172  6881 0005                            BGEZ,R6  s:16557,PREL

      370    16551    2           THEN SCNSIZ=SCNSIZ+CQ$QHDR.RCQ.SZ;

  16551   3 000174  EA45 0002                            ADD,R6   2,B5
          3 000176  EF47 0031                            STR,R6   SCNSIZ,AUTO

      371    16552
      372    16553        /*  Extract all current messages from the queue and process them.
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:62   
      373    16554            Derive a pointer to the next message in the queue and determine
      374    16555            how large it is.  (RPTR is a DW index)  (MSGSIZ is in DWs)
      375    16556        */
      376    16557    3           DO WHILE (SCNSIZ > 0);

  16557   3 000178  6A81 0A88                            BLEZ,R6  s:17203,PREL

      377    16558    3                MSG$=PINCRW(G$HAND_Q$,CQ$QHDR.RCQ.OFFSET+CQ$QHDR.RCQ.RPTR*2);

  16558   3 00017A  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          3 00017D  E846 0001                            LDR,R6   1,B6
          3 00017F  6001                                 SOL,R6   1
          3 000180  EA46 0003                            ADD,R6   3,B6
          3 000182  F856                                 LDR,R7   R6
          3 000183  6C00                                 LDV,R6   0
          3 000184  8400 0000 0000  xsym                 AID      G$HAND_Q$
          3 000187  8D47 0020                            SDI      MSG$,AUTO

      378    16559    3                MSGSIZ=(SIZEW(KNH$MESS) + (KNH$MESS.FPTSZ+1)/2 +(KNH$MESS.MSGSZ+1)/2 +
             16559                         1) / 2;

  16559   3 000189  DCC7 0020                            LDB,B5   MSG$,AUTO
          3 00018B  D845 0006                            LDR,R5   6,B5
          3 00018D  5E01                                 ADV,R5   1
          3 00018E  5041                                 SOR,R5   1
          3 00018F  C845 0007                            LDR,R4   7,B5
          3 000191  4E01                                 ADV,R4   1
          3 000192  4041                                 SOR,R4   1
          3 000193  DA54                                 ADD,R5   R4
          3 000194  5E09                                 ADV,R5   9
          3 000195  5041                                 SOR,R5   1
          3 000196  DF47 002E                            STR,R5   MSGSIZ,AUTO

      379    16560    4                IF KNH$MESS.FUNCTION ~= %KN_FCN_NOP THEN DO;

  16560   3 000198  C805                                 LDR,R4   ,B5
          3 000199  4D06                                 CMV,R4   6
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:63   
          3 00019A  0901 000F                            BE       s:16568,PREL

      380    16561    4                     CTX$ = KNH$MESS.UID$;

  16561   3 00019C  CCC5 0002                            LDB,B4   2,B5
          3 00019E  CFC7 0026                            STB,B4   CTX$,AUTO

      381    16562    4                     IF CTX$ ~= ADDR(NIL)

  16562   3 0001A0  8DC7 0026                            CMN      CTX$,AUTO
          3 0001A2  0901 000C                            BE       s:16571,PREL

      382    16563    4                     THEN
      383    16564    4                          WHO = GJA$HAND_CTX.WHO;

  16564   3 0001A4  C804                                 LDR,R4   ,B4
          3 0001A5  404D                                 SOR,R4   13
          3 0001A6  CF47 001D                            STR,R4   WHO,AUTO

      384    16565
      385    16566    4                     END;

  16566   3 0001A8  0F81 0006                            B        s:16571,PREL

      386    16567    3                ELSE
      387    16568    3                     CTX$ = ADDR(NIL);

  16568   3 0001AA  CB80 0000 0000                       LAB,B4   0
          3 0001AD  CFC7 0026                            STB,B4   CTX$,AUTO

      388    16569        /*  Branch out depending on the circular queue message function code.
      389    16570        */
      390    16571    4                DO CASE(KNH$MESS.FUNCTION);

  16571   3 0001AF  B805                                 LDR,R3   ,B5
          3 0001B0  3D07                                 CMV,R3   7
          3 0001B1  0281 0A2F                            BGE      s:17193,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:64   
          3 0001B3  A830 0000 01B9  03                   LDR,R2   s:16571+10,R3
          3 0001B6  83A0 0000 01C0  03                   JMP      s:16582,R2
          3 0001B9       0A21                            DC       s:17193,PREL
          3 0001BA       0000                            DC       s:16582,PREL
          3 0001BB       022F                            DC       s:16680,PREL
          3 0001BC       02D2                            DC       s:16739,PREL
          3 0001BD       0500                            DC       s:16853,PREL
          3 0001BE       053B                            DC       s:16877,PREL
          3 0001BF       0A25                            DC       s:17200,PREL

      391    16572        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:65   
      392    16573        /*   NOP
      393    16574         */
      394    16575    4                 CASE(%KN_FCN_NOP);

      395    16576
      396    16577        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:66   
      397    16578        /*   Initiate Connection Request
      398    16579        */
      399    16580    4                 CASE(%KN_FCN_INIT);

      400    16581
      401    16582    4                   FPT$ = PINCRW(MSG$,SIZEW(KNH$MESS));

  16582   3 0001C0  BBC5 0008                            LAB,B3   8,B5
          3 0001C2  BFC7 0024                            STB,B3   FPT$,AUTO

      402    16583
      403    16584    5                   DO SELECT (FPT$CONNECT.RESOURCE);

  16584   3 0001C4  AB80 0000 0000  01                   LAB,B2   PRIVS
          3 0001C7  0022                                 ACM      ;
          3 0001C8       4803 0001                                ALPHANUM(1,B3,,8,FILL),;
          3 0001CA       4602 0011                                ALPHANUM(17,B2,,6,FILL)
          3 0001CC  7301 0017                            CBL      s:16584+32,PREL
          3 0001CE  AB80 0000 0000  01                   LAB,B2   PRIVS
          3 0001D1  0022                                 ACM      ;
          3 0001D2       4803 0001                                ALPHANUM(1,B3,,8,FILL),;
          3 0001D4       4602 0011                                ALPHANUM(17,B2,,6,FILL)
          3 0001D6  5381 010B                            CBE      s:16629,PREL
          3 0001D8  AB80 0000 0000  01                   LAB,B2   PRIVS
          3 0001DB  0022                                 ACM      ;
          3 0001DC       4803 0001                                ALPHANUM(1,B3,,8,FILL),;
          3 0001DE       4602 0014                                ALPHANUM(20,B2,,6,FILL)
          3 0001E0  5301 0A04                            CBNE     s:17200,PREL
          3 0001E2  0F81 000D                            B        s:16587,PREL
          3 0001E4  AB80 0000 0000  01                   LAB,B2   PRIVS
          3 0001E7  0022                                 ACM      ;
          3 0001E8       4803 0001                                ALPHANUM(1,B3,,8,FILL),;
          3 0001EA       4502 0017                                ALPHANUM(23,B2,,5,FILL)
          3 0001EC  5301 09F8                            CBNE     s:17200,PREL
          3 0001EE  0F81 00E1                            B        s:16624,PREL

      404    16585
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:67   
      405    16586    5                        SELECT ('NODADM');

      406    16587    5                        SIZE = SIZEW(GJA$HAND_CTX);

  16587   3 0001F0  4C11                                 LDV,R4   17
          3 0001F1  CF47 0032                            STR,R4   SIZE,AUTO

      407    16588    6                        CALL KVB$GETSYS(SIZE,CTX$) WHENALTRETURN DO;

  16588   3 0001F3  ABC7 0026                            LAB,B2   CTX$,AUTO
          3 0001F5  AFC7 0044                            STB,B2   NMAVAIL+3,AUTO
          3 0001F7  9BC7 0032                            LAB,B1   SIZE,AUTO
          3 0001F9  9FC7 0042                            STB,B1   NMAVAIL+1,AUTO
          3 0001FB  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0001FD  CBF0 0200                            LAB,B4   512,IMO
          3 0001FF  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          3 000202       0003                            DC       s:16589,PREL
          3 000203  0F81 0003                            B        s:16591,PREL

      408    16589    6                             GOTO GETOUT;

  16589   3 000205  0F81 09FB                            B        s:17203,PREL

      409    16590    6                             END;
      410    16591    5                        GJA$HAND_CTX = '0'B;

  16591   3 000207  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000209  5C22                                 LDV,R5   34
          3 00020A  0021                                 ALR      ;
          3 00020B       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          3 00020D       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

      411    16592    5                        GJA$HAND_CTX.SYSID = FPT$CONNECT.USER.SYSID;

  16592   3 00020F  437F                                 CSYNC    s:16591+7,SPREL
          3 000210  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000212  DCC7 0024                            LDB,B5   FPT$,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:68   
          3 000214  E845 000F                            LDR,R6   15,B5
          3 000216  EF46 000E                            STR,R6   14,B6

      412    16593    5                        GJA$HAND_CTX.NAME = FPT$CONNECT.TERMINAL_ID.TERMID;

  16593   3 000218  AB85                                 LAB,B2   ,B5
          3 000219  2C0C                                 LDV,R2   12
          3 00021A  6C08                                 LDV,R6   8
          3 00021B  BCC7 0026                            LDB,B3   CTX$,AUTO
          3 00021D  3C12                                 LDV,R3   18
          3 00021E  0008                                 MMM

      413    16594    5                        IF GJA_HAND_HEAD$ = ADDR(NIL)

  16594   3 00021F  8D80 0000 0000  xsym                 CMN      GJA_HAND_HEAD$
          3 000222  0981 0008                            BNE      s:16597,PREL

      414    16595    5                        THEN GJA_HAND_HEAD$ = CTX$;

  16595   3 000224  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000226  EF80 0000 0000  xsym                 STB,B6   GJA_HAND_HEAD$
          3 000229  0F81 000D                            B        s:16600,PREL

      415    16596    6                        ELSE DO;

      416    16597    6                             GJA$HAND_CTX.LNK$ = GJA_HAND_HEAD$;

  16597   3 00022B  EC80 0000 0000  xsym                 LDB,B6   GJA_HAND_HEAD$
          3 00022E  CCC7 0026                            LDB,B4   CTX$,AUTO
          3 000230  EFC4 0001                            STB,B6   1,B4

      417    16598    6                             GJA_HAND_HEAD$ = CTX$;

  16598   3 000232  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000234  EF80 0000 0000  xsym                 STB,B6   GJA_HAND_HEAD$

      418    16599    6                             END;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:69   

      419    16600    5                        GJA$HAND_CTX.LDCTX = KNH$MESS.LDCTX;

  16600   3 000237  CCC7 0020                            LDB,B4   MSG$,AUTO
          3 000239  E844 0001                            LDR,R6   1,B4
          3 00023B  EA86                                 SRM,R6,'1FFF'X    ,B6
          3 00023C       1FFF

      420    16601    5                        GJA$HAND_CTX.WHO = %GJA_UID_HANDLER;

  16601   3 00023D  E870 6000                            LDR,R6   24576,IMO
          3 00023F  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000241  EA86                                 SRM,R6,'E000'X    ,B6
          3 000242       E000

      421    16602    5                        IF FPT$CONNECT.TERMINAL_ID.TERMID = 'BABOON'

  16602   3 000243  ECC7 0024                            LDB,B6   FPT$,AUTO
          3 000245  BB80 0000 0000  01                   LAB,B3   PRIVS
          3 000248  0022                                 ACM      ;
          3 000249       4E06 0006                                ALPHANUM(6,B6,,14,FILL),;
          3 00024B       4603 001A                                ALPHANUM(26,B3,,6,FILL)
          3 00024D  5301 005B                            CBNE     s:16617,PREL

      422    16603    6                        THEN DO;

      423    16604    6                             GJA_UID_BABOON$ = CTX$;

  16604   3 00024F  BCC7 0026                            LDB,B3   CTX$,AUTO
          3 000251  BF80 0000 0000  xsym                 STB,B3   GJA_UID_BABOON

      424    16605    6                             GJA$HAND_CTX.WHO = %GJA_UID_BABOON;

  16605   3 000254  C870 4000                            LDR,R4   16384,IMO
          3 000256  CA83                                 SRM,R4,'E000'X    ,B3
          3 000257       E000

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:70   
      425    16606    6                             GJA_LDCT_BABOON = KNH$MESS.LDCTX;

  16606   3 000258  B844 0001                            LDR,R3   1,B4
          3 00025A  BF00 0000 0000  xsym                 STR,R3   GJA_LDCT_BABOON

      426    16607    6                             GJA_CONNECT_ACK.REASON = %K_REASON_NORMAL;

  16607   3 00025D  8700 0000 0000  xsym                 CL       GJA_CONNECT_ACK

      427    16608    6                             CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_CONNECT_ACK),
             16608                                      GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);

  16608   3 000260  BBF0 000C                            LAB,B3   12,IMO
          3 000262  9BF0 0002                            LAB,B1   2,IMO
          3 000264  9FC7 004C                            STB,B1   NMAVAIL+11,AUTO
          3 000266  EB80 0000 0000  xsym                 LAB,B6   GJA_CONNECT_ACK
          3 000269  EFC7 004A                            STB,B6   NMAVAIL+9,AUTO
          3 00026B  BFC7 0048                            STB,B3   NMAVAIL+7,AUTO
          3 00026D  EB80 0000 0000                       LAB,B6   0
          3 000270  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 000272  EB80 0000 0000                       LAB,B6   0
          3 000275  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 000277  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 000279  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 00027B  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 00027D  CBF0 0600                            LAB,B4   1536,IMO
          3 00027F  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000282       0001                            DC       s:16609,PREL

      428    16609    6                             CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_KL_MES),GJA_KL_MES,,,);

  16609   3 000283  EBF0 0002                            LAB,B6   2,IMO
          3 000285  DB80 0000 0000                       LAB,B5   0
          3 000288  DFC7 004C                            STB,B5   NMAVAIL+11,AUTO
          3 00028A  CB80 0000 0000                       LAB,B4   0
          3 00028D  CFC7 004A                            STB,B4   NMAVAIL+9,AUTO
          3 00028F  BB80 0000 0000                       LAB,B3   0
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:71   
          3 000292  BFC7 0048                            STB,B3   NMAVAIL+7,AUTO
          3 000294  AB80 0000 0002  01                   LAB,B2   GJA_KL_MES
          3 000297  AFC7 0046                            STB,B2   NMAVAIL+5,AUTO
          3 000299  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 00029B  9BC7 0026                            LAB,B1   CTX$,AUTO
          3 00029D  9FC7 0042                            STB,B1   NMAVAIL+1,AUTO
          3 00029F  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0002A1  CBF0 0600                            LAB,B4   1536,IMO
          3 0002A3  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 0002A6       0001                            DC       s:16610,PREL

      429    16610    6                             END;

  16610   3 0002A7  0F81 093D                            B        s:17200,PREL

      430    16611    5                        ELSE
      431    16612    6                        DO;

      432    16613
      433    16614        /*  Dont ack any handler connection until we are fully connected
      434    16615            to the network manager.
      435    16616        */
      436    16617    6                             GJA_CONNECT_ACK.REASON = %K_REASON_NORMAL;

  16617   3 0002A9  8700 0000 0000  xsym                 CL       GJA_CONNECT_ACK

      437    16618    6                             CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_KL_MES),GJA_KL_MES,

  16618   3 0002AC  BBF0 0002                            LAB,B3   2,IMO
          3 0002AE  9BF0 000C                            LAB,B1   12,IMO
          3 0002B0  EBF0 0002                            LAB,B6   2,IMO
          3 0002B2  EFC7 004C                            STB,B6   NMAVAIL+11,AUTO
          3 0002B4  EB80 0000 0000  xsym                 LAB,B6   GJA_CONNECT_ACK
          3 0002B7  EFC7 004A                            STB,B6   NMAVAIL+9,AUTO
          3 0002B9  9FC7 0048                            STB,B1   NMAVAIL+7,AUTO
          3 0002BB  EB80 0000 0002  01                   LAB,B6   GJA_KL_MES
          3 0002BE  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:72   
          3 0002C0  BFC7 0044                            STB,B3   NMAVAIL+3,AUTO
          3 0002C2  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 0002C4  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 0002C6  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0002C8  CBF0 0600                            LAB,B4   1536,IMO
          3 0002CA  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 0002CD       0001                            DC       s:16620,PREL

      438    16619    6                              SIZEC(GJA_CONNECT_ACK),GJA_CONNECT_ACK,%KN_FCN_INIT_ACK)
             16619                                        ;
      439    16620    6                             END;

  16620   3 0002CE  0F81 0916                            B        s:17200,PREL

      440    16621
      441    16622
      442    16623    5                        SELECT ('LOGON');

      443    16624    5                       CALL GJA$LOGON_REQUEST(CTX$,KNH$MESS,FPT$CONNECT) ALTRET(GETOUT
             16624                                 ); /* Logon request from a handler */

  16624   3 0002D0  BFC7 0046                            STB,B3   NMAVAIL+5,AUTO
          3 0002D2  DFC7 0044                            STB,B5   NMAVAIL+3,AUTO
          3 0002D4  ABC7 0026                            LAB,B2   CTX$,AUTO
          3 0002D6  AFC7 0042                            STB,B2   NMAVAIL+1,AUTO
          3 0002D8  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0002DA  CBF0 0300                            LAB,B4   768,IMO
          3 0002DC  E380 0000 0000  xent                 LNJ,B6   GJA$LOGON_REQUEST
          3 0002DF       0922                            DC       s:17203,PREL
          3 0002E0  0F81 0904                            B        s:17200,PREL

      444    16625
      445    16626
      446    16627    5                        SELECT ('NETMAN'); /* Connection from another NA */

      447    16628
      448    16629    5                        IF FPT$CONNECT.RLCID.NODE < GJA_NODE#
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:73   

  16629   3 0002E2  C2C3 000D                            LLH,R4   13,B3
          3 0002E4  C900 0000 0000  xsym                 CMR,R4   GJA_NODE#
          3 0002E7  0281 002E                            BGE      s:16635,PREL

      449    16630    6                        THEN DO;

      450    16631    6                             GJA_CONNECT_ACK.REASON = %K_REASON_USRREJ;

  16631   3 0002E9  1C05                                 LDV,R1   5
          3 0002EA  9F00 0000 0000  xsym                 STR,R1   GJA_CONNECT_ACK

      451    16632    6                             CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(
             16632                                      GJA_CONNECT_ACK),GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);

  16632   3 0002ED  ABC5 0001                            LAB,B2   1,B5
          3 0002EF  AFC7 0042                            STB,B2   NMAVAIL+1,AUTO
          3 0002F1  9BF0 000C                            LAB,B1   12,IMO
          3 0002F3  EBF0 0002                            LAB,B6   2,IMO
          3 0002F5  EFC7 004E                            STB,B6   NMAVAIL+13,AUTO
          3 0002F7  EB80 0000 0000  xsym                 LAB,B6   GJA_CONNECT_ACK
          3 0002FA  EFC7 004C                            STB,B6   NMAVAIL+11,AUTO
          3 0002FC  9FC7 004A                            STB,B1   NMAVAIL+9,AUTO
          3 0002FE  EB80 0000 0000                       LAB,B6   0
          3 000301  EFC7 0048                            STB,B6   NMAVAIL+7,AUTO
          3 000303  EB80 0000 0000                       LAB,B6   0
          3 000306  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 000308  EBC7 0042                            LAB,B6   NMAVAIL+1,AUTO
          3 00030A  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 00030C  BBC7 0044                            LAB,B3   NMAVAIL+3,AUTO
          3 00030E  CBF0 0600                            LAB,B4   1536,IMO
          3 000310  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000313       0001                            DC       s:16633,PREL

      452    16633    6                             END;

  16633   3 000314  0F81 08D0                            B        s:17200,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:74   

      453    16634    6                        ELSE DO;

      454    16635    6                             GJA_CONNECT_ACK.REASON = %K_REASON_NORMAL;

  16635   3 000316  8700 0000 0000  xsym                 CL       GJA_CONNECT_ACK

      455    16636    6                             ROUTE$ = KNN$ROUTE$(FPT$CONNECT.RLCID.NODE);

  16636   3 000319  B854                                 LDR,R3   R4
          3 00031A  AC80 0000 0000  xsym                 LDB,B2   GJA_ROUTE$
          3 00031D  9CB2                                 LDB,B1   ,B2,R3
          3 00031E  9FC7 002F                            STB,B1   ROUTE$,AUTO

      456    16637    6                             CTX$ = KNN$ROUTE.CTX$;

  16637   3 000320  ECC1 0002                            LDB,B6   2,B1
          3 000322  EFC7 0026                            STB,B6   CTX$,AUTO

      457    16638    6                             IF CTX$ = ADDR(NIL)

  16638   3 000324  8DC7 0026                            CMN      CTX$,AUTO
          3 000326  0981 009B                            BNE      s:16666,PREL

      458    16639    7                             THEN DO;

      459    16640    7                                  SIZE = SIZEW(GJA$HAND_CTX);

  16640   3 000328  2C11                                 LDV,R2   17
          3 000329  AF47 0032                            STR,R2   SIZE,AUTO

      460    16641    7                                  CALL KVB$GETSYS (SIZE,CTX$) ALTRET (GETOUT);

  16641   3 00032B  CBC7 0026                            LAB,B4   CTX$,AUTO
          3 00032D  CFC7 0044                            STB,B4   NMAVAIL+3,AUTO
          3 00032F  EBC7 0032                            LAB,B6   SIZE,AUTO
          3 000331  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:75   
          3 000333  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000335  CBF0 0200                            LAB,B4   512,IMO
          3 000337  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          3 00033A       08C7                            DC       s:17203,PREL

      461    16642    7                                  GJA$HAND_CTX = '0'B;

  16642   3 00033B  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00033D  5C22                                 LDV,R5   34
          3 00033E  0021                                 ALR      ;
          3 00033F       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          3 000341       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

      462    16643    7                                  GJA$HAND_CTX.NAME = 'NETMAN';

  16643   3 000343  EB80 0000 0000  01                   LAB,B6   PRIVS
          3 000346  437F                                 CSYNC    s:16643+2,SPREL
          3 000347  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000349  0021                                 ALR      ;
          3 00034A       4606 0011                                ALPHANUM(17,B6,,6),;
          3 00034C       4805 0009                                ALPHANUM(9,B5,,8,FILL)

      463    16644    7                                  GJA$HAND_CTX.WHO = %GJA_UID_NM;

  16644   3 00034E  E870 2000                            LDR,R6   8192,IMO
          3 000350  437F                                 CSYNC    s:16644+1,SPREL
          3 000351  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000353  EA86                                 SRM,R6,'E000'X    ,B6
          3 000354       E000

      464    16645    7                                  GJA$HAND_CTX.NODE = FPT$CONNECT.RLCID.NODE;

  16645   3 000355  ECC7 0024                            LDB,B6   FPT$,AUTO
          3 000357  C2C6 000D                            LLH,R4   13,B6
          3 000359  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 00035B  CAC5 000D                            SRM,R4,'00FF'X    13,B5
          3 00035D       00FF
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:76   

      465    16646    7                                  ROUTE$ = KNN$ROUTE$(GJA$HAND_CTX.NODE);

  16646   3 00035E  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000360  B845 000D                            LDR,R3   13,B5
          3 000362  B570 00FF                            AND,R3   255,IMO
          3 000364  CC80 0000 0000  xsym                 LDB,B4   GJA_ROUTE$
          3 000367  BCB4                                 LDB,B3   ,B4,R3
          3 000368  BFC7 002F                            STB,B3   ROUTE$,AUTO

      466    16647    7                                  KNN$ROUTE.CTX$ = CTX$;

  16647   3 00036A  DFC3 0002                            STB,B5   2,B3

      467    16648    7                                  GJA$HAND_CTX.LINK_CONNECTED = KNN$ROUTE.FLAGS.
             16648                                           LINK_CONNECTED;

  16648   3 00036C  C843 0007                            LDR,R4   7,B3
          3 00036E  ACC7 0026                            LDB,B2   CTX$,AUTO
          3 000370  CAC2 000D                            SRM,R4,'4000'X    13,B2
          3 000372       4000

      468    16649    7                                  IF GJA_NM_HEAD$ = ADDR(NIL)

  16649   3 000373  8D80 0000 0000  xsym                 CMN      GJA_NM_HEAD$
          3 000376  0981 0008                            BNE      s:16653,PREL

      469    16650    7                                  THEN
      470    16651    7                                       GJA_NM_HEAD$ = CTX$;

  16651   3 000378  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 00037A  DF80 0000 0000  xsym                 STB,B5   GJA_NM_HEAD$
          3 00037D  0F81 000D                            B        s:16656,PREL

      471    16652    8                                  ELSE DO;

      472    16653    8                                       GJA$HAND_CTX.LNK$ = GJA_NM_HEAD$;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:77   

  16653   3 00037F  DC80 0000 0000  xsym                 LDB,B5   GJA_NM_HEAD$
          3 000382  ACC7 0026                            LDB,B2   CTX$,AUTO
          3 000384  DFC2 0001                            STB,B5   1,B2

      473    16654    8                                       GJA_NM_HEAD$ = CTX$;

  16654   3 000386  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000388  DF80 0000 0000  xsym                 STB,B5   GJA_NM_HEAD$

      474    16655    8                                       END;

      475    16656    7                                  GJA$HAND_CTX.LDCTX = KNH$MESS.LDCTX;

  16656   3 00038B  CCC7 0020                            LDB,B4   MSG$,AUTO
          3 00038D  C844 0001                            LDR,R4   1,B4
          3 00038F  CA85                                 SRM,R4,'1FFF'X    ,B5
          3 000390       1FFF

      476    16657    7                                  CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_CONNECT_ACK),
             16657                                           GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);

  16657   3 000391  DBF0 000C                            LAB,B5   12,IMO
          3 000393  ABF0 0002                            LAB,B2   2,IMO
          3 000395  AFC7 004C                            STB,B2   NMAVAIL+11,AUTO
          3 000397  9B80 0000 0000  xsym                 LAB,B1   GJA_CONNECT_ACK
          3 00039A  9FC7 004A                            STB,B1   NMAVAIL+9,AUTO
          3 00039C  DFC7 0048                            STB,B5   NMAVAIL+7,AUTO
          3 00039E  EB80 0000 0000                       LAB,B6   0
          3 0003A1  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 0003A3  EB80 0000 0000                       LAB,B6   0
          3 0003A6  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 0003A8  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 0003AA  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 0003AC  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0003AE  CBF0 0600                            LAB,B4   1536,IMO
          3 0003B0  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:78   
          3 0003B3       0001                            DC       s:16658,PREL

      477    16658    7                                  CALL GJA$NODEINFO(CTX$);

  16658   3 0003B4  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 0003B6  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 0003B8  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0003BA  CBF0 0100                            LAB,B4   256,IMO
          3 0003BC  E380 0000 0000  xent                 LNJ,B6   GJA$NODEINFO
          3 0003BF       0001                            DC       s:16659,PREL

      478    16659    7                                  END;

  16659   3 0003C0  0F81 0824                            B        s:17200,PREL

      479    16660    7                             ELSE DO;

      480    16661        /*
      481    16662          If we've got this far we need to init nak the first connectio attempt
      482    16663          unitl the connection either fails or complete.  So subsequent inits
      483    16664          are just nak'd.  This should not occur too often from the same node.
      484    16665        */
      485    16666    7                                  GJA_CONNECT_ACK.REASON = %K_REASON_USRREJ;

  16666   3 0003C2  2C05                                 LDV,R2   5
          3 0003C3  AF00 0000 0000  xsym                 STR,R2   GJA_CONNECT_ACK

      486    16667    7                                  CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(
             16667                                           GJA_CONNECT_ACK)

  16667   3 0003C6  CBC5 0001                            LAB,B4   1,B5
          3 0003C8  CFC7 0042                            STB,B4   NMAVAIL+1,AUTO
          3 0003CA  EBF0 000C                            LAB,B6   12,IMO
          3 0003CC  DBF0 0002                            LAB,B5   2,IMO
          3 0003CE  DFC7 004E                            STB,B5   NMAVAIL+13,AUTO
          3 0003D0  DB80 0000 0000  xsym                 LAB,B5   GJA_CONNECT_ACK
          3 0003D3  DFC7 004C                            STB,B5   NMAVAIL+11,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:79   
          3 0003D5  EFC7 004A                            STB,B6   NMAVAIL+9,AUTO
          3 0003D7  EB80 0000 0000                       LAB,B6   0
          3 0003DA  EFC7 0048                            STB,B6   NMAVAIL+7,AUTO
          3 0003DC  EB80 0000 0000                       LAB,B6   0
          3 0003DF  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 0003E1  EBC7 0042                            LAB,B6   NMAVAIL+1,AUTO
          3 0003E3  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 0003E5  BBC7 0044                            LAB,B3   NMAVAIL+3,AUTO
          3 0003E7  CBF0 0600                            LAB,B4   1536,IMO
          3 0003E9  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 0003EC       0001                            DC       s:16672,PREL

      487    16668    7                                    ,GJA_CONNECT_ACK,%KN_FCN_INIT_ACK);
      488    16669    7                                  END;

      489    16670    6                             END;

      490    16671
      491    16672    5                        END /* DO SELECT */;

  16672   3 0003ED  0F81 07F7                            B        s:17200,PREL

      492    16673        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:80   
      493    16674        /*   Initiate Connection Acknowledgement
      494    16675        */
      495    16676        /*
      496    16677          Verify that the init was O.K. and if it wasn't, retry it.
      497    16678        */
      498    16679    4                 CASE(%KN_FCN_INIT_ACK);

      499    16680    4                   FPT$=PINCRW(MSG$,SIZEW(KNH$MESS));

  16680   3 0003EF  BBC5 0008                            LAB,B3   8,B5
          3 0003F1  BFC7 0024                            STB,B3   FPT$,AUTO

      500    16681    4                   GJA$HAND_CTX.WAT4ACK = '0'B;

  16681   3 0003F3  8844 000D                            LBF,'0800'X       13,B4
  16681   3 0003F5       0800

      501    16682    4                   IF FPT_CONNECT_ACK.REASON ~= %K_REASON_NORMAL

  16682   3 0003F6  C803                                 LDR,R4   ,B3
          3 0003F7  4901 0050                            BEZ,R4   s:16701,PREL

      502    16683    4                   THEN
      503    16684    4                        IF FPT_CONNECT_ACK.REASON = %K_REASON_NORTE

  16684   3 0003F9  4D02                                 CMV,R4   2
          3 0003FA  0901 000B                            BE       s:16687,PREL
          3 0003FC  4D05                                 CMV,R4   5
          3 0003FD  0981 001C                            BNE      s:16692,PREL
          3 0003FF  CCC7 0026                            LDB,B4   CTX$,AUTO
          3 000401  82C4 000D                            LB,'2000'X        13,B4
          3 000403       2000
          3 000404  0501 0015                            BBT      s:16692,PREL

      504    16685    4                          OR (FPT_CONNECT_ACK.REASON = %K_REASON_USRREJ AND NOT
             16685                                   GJA$HAND_CTX.HOST_NODE)
      505    16686    5                        THEN DO;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:81   

      506    16687    5                             IF GJA$HAND_CTX.LDCTX = 0 /* No other connection */

  16687   3 000406  CCC7 0026                            LDB,B4   CTX$,AUTO
          3 000408  8284                                 LB,'1FFF'X        ,B4
          3 000409       1FFF
          3 00040A  0501 07DA                            BBT      s:17200,PREL

      507    16688    5                             THEN
      508    16689    5                                  CALL GJA$DISOLVE_NA(CTX$);

  16689   3 00040C  ABC7 0026                            LAB,B2   CTX$,AUTO
          3 00040E  AFC7 0042                            STB,B2   NMAVAIL+1,AUTO
          3 000410  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000412  CBF0 0100                            LAB,B4   256,IMO
          3 000414  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_NA
          3 000417       0001                            DC       s:16690,PREL

      509    16690    5                             END;

  16690   3 000418  0F81 07CC                            B        s:17200,PREL

      510    16691    5                        ELSE DO;

      511    16692    5                             GJA_CONNECT.RLCID.NODE = GJA$HAND_CTX.NODE;

  16692   3 00041A  CCC7 0026                            LDB,B4   CTX$,AUTO
          3 00041C  B844 000D                            LDR,R3   13,B4
          3 00041E  B570 00FF                            AND,R3   255,IMO
          3 000420  B780 0000 000D  xsym                 STH,R3   GJA_CONNECT+13

      512    16693    5                             CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_CONNECT),GJA_CONNECT,%
             16693                                      KN_FCN_INIT);

  16693   3 000423  ABF0 0026                            LAB,B2   38,IMO
          3 000425  9BF0 0001                            LAB,B1   1,IMO
          3 000427  9FC7 004C                            STB,B1   NMAVAIL+11,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:82   
          3 000429  EB80 0000 0000  xsym                 LAB,B6   GJA_CONNECT
          3 00042C  EFC7 004A                            STB,B6   NMAVAIL+9,AUTO
          3 00042E  AFC7 0048                            STB,B2   NMAVAIL+7,AUTO
          3 000430  EB80 0000 0000                       LAB,B6   0
          3 000433  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 000435  EB80 0000 0000                       LAB,B6   0
          3 000438  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 00043A  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 00043C  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 00043E  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000440  CBF0 0600                            LAB,B4   1536,IMO
          3 000442  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000445       0001                            DC       s:16694,PREL

      513    16694    5                             END;

  16694   3 000446  0F81 079E                            B        s:17200,PREL

      514    16695        /*
      515    16696          When we get connect ack from the network manager, we need to save
      516    16697          the LDCT index of the network manager for later use in communicating
      517    16698          with it.
      518    16699        */
      519    16700    5                   ELSE DO;

      520    16701    5                        GJA$HAND_CTX.LDCTX = KNH$MESS.LDCTX;

  16701   3 000448  B845 0001                            LDR,R3   1,B5
          3 00044A  CCC7 0026                            LDB,B4   CTX$,AUTO
          3 00044C  BA84                                 SRM,R3,'1FFF'X    ,B4
          3 00044D       1FFF

      521    16702        /*
      522    16703             Send the node info to this NA
      523    16704         */
      524    16705    5                        CALL GJA$NODEINFO(CTX$);

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:83   
  16705   3 00044E  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 000450  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 000452  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000454  CBF0 0100                            LAB,B4   256,IMO
          3 000456  E380 0000 0000  xent                 LNJ,B6   GJA$NODEINFO
          3 000459       0001                            DC       s:16710,PREL

      525    16706        /*
      526    16707            if this init ack is from a host then check the logon list for any
      527    16708            previous autologon failures and reissue the connect on them.
      528    16709        */
      529    16710    5                        SVMSG$ = GJA_USRLGN_HEAD$;

  16710   3 00045A  EC80 0000 0000  xsym                 LDB,B6   GJA_USRLGN_HEAD$
          3 00045D  EFC7 0028                            STB,B6   SVMSG$,AUTO

      530    16711    6                        DO WHILE SVMSG$ ~= ADDR(NIL);

  16711   3 00045F  0F81 002D                            B        s:16724,PREL

      531    16712        /* if the node connecting has logons waiting reissue them now.  let the
      532    16713           default node take care of his own all non-autologon lines default to
      533    16714           gja_defnode as their nm*/
      534    16715    6                             IF SVMSG$->GJA$LGNCTX.NM_NODE = GJA$HAND_CTX.NODE

  16715   3 000461  ECC7 0028                            LDB,B6   SVMSG$,AUTO
          3 000463  E2C6 0009                            LLH,R6   9,B6
          3 000465  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000467  D845 000D                            LDR,R5   13,B5
          3 000469  D570 00FF                            AND,R5   255,IMO
          3 00046B  E955                                 CMR,R6   R5
          3 00046C  0981 001A                            BNE      s:16723,PREL
          3 00046E  D900 0000 0000  xsym                 CMR,R5   GJA_DEFNODE
          3 000471  0901 0015                            BE       s:16723,PREL
          3 000473  CCC6 000A                            LDB,B4   10,B6
          3 000475  8284                                 LB,'0004'X        ,B4
          3 000476       0004
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:84   
          3 000477  0581 000F                            BBF      s:16723,PREL

      535    16716    6                               AND GJA_DEFNODE ~= GJA$HAND_CTX.NODE
      536    16717    6                               AND SVMSG$->GJA$LGNCTX.CHN$->KH$CHN.AUTLGN THEN
      537    16718    7                             DO;

      538    16719    8                                 CALL GJA$LOGON_REQUEST_AGAIN(SVMSG$) WHENALTRETURN DO
             16719                                           ;

  16719   3 000479  BBC7 0028                            LAB,B3   SVMSG$,AUTO
          3 00047B  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 00047D  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 00047F  CBF0 0100                            LAB,B4   256,IMO
          3 000481  E380 0000 0000  xent                 LNJ,B6   GJA$LOGON_REQUEST_AGAIN
          3 000484       0003                            DC       s:16723,PREL
          3 000485  0F81 0001                            B        s:16723,PREL

      539    16720                                                /* doesn't really altret    */
      540    16721    8                                       END;

      541    16722    7                                  END;

      542    16723    6                             SVMSG$ = SVMSG$->GJA$LGNCTX.LNK$;

  16723   3 000487  ECC7 0028                            LDB,B6   SVMSG$,AUTO
          3 000489  DCC6 0001                            LDB,B5   1,B6
          3 00048B  DFC7 0028                            STB,B5   SVMSG$,AUTO

      543    16724    6                             END;

  16724   3 00048D  8DC7 0028                            CMN      SVMSG$,AUTO
          3 00048F  09D2                                 BNE      s:16715,SPREL

      544    16725    5                        END;

  16725   3 000490  0F81 0754                            B        s:17200,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:85   
      545    16726        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:86   
      546    16727        /*   Terminate Connection Request
      547    16728        */
      548    16729        /*
      549    16730          A TERM from VDH probably means that one of the devices attempting
      550    16731          logon has disconnected.  If we have already solicited the network
      551    16732          manager for information on this guy, just set a bit in his context
      552    16733          so that we can throw away the network managers responce when we
      553    16734          get it.  Otherwise, send a TERM ACK to VDH and displve this guys
      554    16735          context now.  At some future time we may also need code here to
      555    16736          support resources disconnecting.
      556    16737        */
      557    16738    4                 CASE(%KN_FCN_TERM);

      558    16739    5                   DO CASE (WHO);

  16739   3 000492  9847 001D                            LDR,R1   WHO,AUTO
          3 000494  1D05                                 CMV,R1   5
          3 000495  0281 0201                            BGE      s:16839,PREL
          3 000497  B810 0000 049D  03                   LDR,R3   s:16739+11,R1
          3 00049A  83B0 0000 04A2  03                   JMP      s:16745,R3
          3 00049D       01F5                            DC       s:16839,PREL
          3 00049E       0040                            DC       s:16755,PREL
          3 00049F       01F5                            DC       s:16839,PREL
          3 0004A0       01E7                            DC       s:16834,PREL
          3 0004A1       0000                            DC       s:16745,PREL

      559    16740
      560    16741    5                    CASE (%GJA_UID_LOGON);

      561    16742
      562    16743        /*
      563    16744        */
      564    16745    5                      IF CTX$->GJA$LGNCTX.STATUS.NMRSP

  16745   3 0004A2  82C4 0018                            LB,'2000'X        24,B4
  16745   3 0004A4       2000
          3 0004A5  0501 0006                            BBT      s:16747,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:87   
          3 0004A7  82C4 0018                            LB,'0200'X        24,B4
          3 0004A9       0200
          3 0004AA  0581 0006                            BBF      s:16749,PREL

      565    16746    5                        OR CTX$->GJA$LGNCTX.STATUS.WTPRO
      566    16747    5                      THEN CTX$->GJA$LGNCTX.STATUS.TERM='1'B;

  16747   3 0004AC  8944 0018                            LBT,'8000'X       24,B4
  16747   3 0004AE       8000
          3 0004AF  0F81 0735                            B        s:17200,PREL

      567    16748    6                      ELSE DO;

      568    16749    6                           CALL GJA$Q_MSG(CTX$,,,SIZEC(GJA_TERM_ACK),GJA_TERM_ACK,%
             16749                                    KN_FCN_TERM_ACK);

  16749   3 0004B1  BBF0 0004                            LAB,B3   4,IMO
          3 0004B3  ABF0 0004                            LAB,B2   4,IMO
          3 0004B5  AFC7 004C                            STB,B2   NMAVAIL+11,AUTO
          3 0004B7  9B80 0000 0000  xsym                 LAB,B1   GJA_TERM_ACK
          3 0004BA  9FC7 004A                            STB,B1   NMAVAIL+9,AUTO
          3 0004BC  BFC7 0048                            STB,B3   NMAVAIL+7,AUTO
          3 0004BE  EB80 0000 0000                       LAB,B6   0
          3 0004C1  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 0004C3  EB80 0000 0000                       LAB,B6   0
          3 0004C6  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 0004C8  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 0004CA  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 0004CC  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0004CE  CBF0 0600                            LAB,B4   1536,IMO
          3 0004D0  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 0004D3       0001                            DC       s:16750,PREL

      569    16750    6                           CALL GJA$DISOLVE_LGNUSR_CTX(CTX$);

  16750   3 0004D4  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 0004D6  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:88   
          3 0004D8  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0004DA  CBF0 0100                            LAB,B4   256,IMO
          3 0004DC  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_LGNUSR_CTX
          3 0004DF       0001                            DC       s:16751,PREL

      570    16751    6                           END;

  16751   3 0004E0  0F81 0704                            B        s:17200,PREL

      571    16752
      572    16753
      573    16754    5                    CASE (%GJA_UID_NM);

      574    16755    5                      CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(GJA_TERM_ACK),
             16755                               GJA_TERM_ACK,%KN_FCN_TERM_ACK);

  16755   3 0004E2  BBC5 0001                            LAB,B3   1,B5
          3 0004E4  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 0004E6  ABF0 0004                            LAB,B2   4,IMO
          3 0004E8  9BF0 0004                            LAB,B1   4,IMO
          3 0004EA  9FC7 004E                            STB,B1   NMAVAIL+13,AUTO
          3 0004EC  EB80 0000 0000  xsym                 LAB,B6   GJA_TERM_ACK
          3 0004EF  EFC7 004C                            STB,B6   NMAVAIL+11,AUTO
          3 0004F1  AFC7 004A                            STB,B2   NMAVAIL+9,AUTO
          3 0004F3  EB80 0000 0000                       LAB,B6   0
          3 0004F6  EFC7 0048                            STB,B6   NMAVAIL+7,AUTO
          3 0004F8  EB80 0000 0000                       LAB,B6   0
          3 0004FB  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 0004FD  EBC7 0042                            LAB,B6   NMAVAIL+1,AUTO
          3 0004FF  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 000501  BBC7 0044                            LAB,B3   NMAVAIL+3,AUTO
          3 000503  CBF0 0600                            LAB,B4   1536,IMO
          3 000505  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000508       0001                            DC       s:16756,PREL

      575    16756    5                      IF CTX$ = GJA_UID_NM$

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:89   
  16756   3 000509  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00050B  ED80 0000 0000  xsym                 CMB,B6   GJA_UID_NM
          3 00050E  0981 000A                            BNE      s:16761,PREL

      576    16757    6                      THEN DO;

      577    16758    6                           GJA$HAND_CTX.WAT4ACK = '0'B;

  16758   3 000510  8846 000D                            LBF,'0800'X       13,B6
  16758   3 000512       0800

      578    16759    6                           GJA_UID_NM$ = ADDR(NIL);

  16759   3 000513  EB80 0000 0000                       LAB,B6   0
          3 000516  EF80 0000 0000  xsym                 STB,B6   GJA_UID_NM

      579    16760    6                           END;

      580    16761    5                      RECOVERY_NODE = CTX$->GJA$HAND_CTX.NODE;

  16761   3 000519  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00051B  F846 000D                            LDR,R7   13,B6
          3 00051D  F570 00FF                            AND,R7   255,IMO
          3 00051F  6C00                                 LDV,R6   0
          3 000520  8D47 0034                            SDI      RECOVERY_NODE,AUTO

      581    16762        /*
      582    16763                            if the term comes before the ack then
      583    16764                            skip the disolve context message and let
      584    16765                            the init_ack do the work.
      585    16766        */
      586    16767    5                      IF GJA_UID_NM$ = ADDR(NIL) /* Our NM             */

  16767   3 000522  8D80 0000 0000  xsym                 CMN      GJA_UID_NM
          3 000525  0981 0010                            BNE      s:16774,PREL

      587    16768    6                      THEN DO;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:90   

      588    16769    6                           CALL GIJ$ABORTDUMP;

  16769   3 000527  CBF0 0000                            LAB,B4   0,IMO
          3 000529  E380 0000 0000  xent                 LNJ,B6   GIJ$ABORTDUMP
          3 00052C       0001                            DC       s:16770,PREL

      589    16770    6                           GJA_UID_NM$ = ADDR(NIL);

  16770   3 00052D  EB80 0000 0000                       LAB,B6   0
          3 000530  EF80 0000 0000  xsym                 STB,B6   GJA_UID_NM

      590    16771    6                           GJA_LDCT_NM = 0;

  16771   3 000533  8700 0000 0000  xsym                 CL       GJA_LDCT_NM

      591    16772
      592    16773    6                           END;

      593    16774    5                      CALL GJA$HOST_RECOVERY(RECOVERY_NODE);

  16774   3 000536  EBC7 0034                            LAB,B6   RECOVERY_NODE,AUTO
          3 000538  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 00053A  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 00053C  CBF0 0100                            LAB,B4   256,IMO
          3 00053E  E380 0000 0000  xent                 LNJ,B6   GJA$HOST_RECOVERY
          3 000541       0001                            DC       s:16775,PREL

      594    16775    5                      IF (GJA_DEFNODE = RECOVERY_NODE AND

  16775   3 000542  F800 0000 0000  xsym                 LDR,R7   GJA_DEFNODE
          3 000545  6C00                                 LDV,R6   0
          3 000546  84C7 0034                            SID      RECOVERY_NODE,AUTO
          3 000548  6981 0017                            BNEZ,R6  s:16779,PREL
          3 00054A  7981 0015                            BNEZ,R7  s:16779,PREL
          3 00054C  EC80 0000 0000  xsym                 LDB,B6   GJA_ROUTE$
          3 00054F  B800 0000 0000  xsym                 LDR,R3   GJA_DEFNODE
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:91   
          3 000552  DCB6                                 LDB,B5   ,B6,R3
          3 000553  82C5 0007                            LB,'4000'X        7,B5
          3 000555       4000
          3 000556  0581 0009                            BBF      s:16779,PREL

      595    16776    5                        KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.FLAGS.LINK_CONNECTED) THEN
      596    16777    5                           GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;

  16777   3 000558  CC80 0000 0000  xsym                 LDB,B4   GJA_MSG_HOSTDOWN$
          3 00055B  CF80 0000 0000  xsym                 STB,B4   GJA_MSG_DOWN$
          3 00055E  0F81 006F                            B        s:16801,PREL

      597    16778    5                      ELSE
      598    16779    5                           IF (GJA_DEFNODE ~= RECOVERY_NODE AND

  16779   3 000560  F800 0000 0000  xsym                 LDR,R7   GJA_DEFNODE
          3 000563  6C00                                 LDV,R6   0
          3 000564  84C7 0034                            SID      RECOVERY_NODE,AUTO
          3 000566  6981 0003                            BNEZ,R6  s:16779+10,PREL
          3 000568  7901 002D                            BEZ,R7   s:16789,PREL
          3 00056A  EC80 0000 0000  xsym                 LDB,B6   GJA_ROUTE$
          3 00056D  B800 0000 0000  xsym                 LDR,R3   GJA_DEFNODE
          3 000570  DCB6                                 LDB,B5   ,B6,R3
          3 000571  82C5 0007                            LB,'4000'X        7,B5
          3 000573       4000
          3 000574  0501 0021                            BBT      s:16789,PREL

      599    16780    5                             NOT (KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.FLAGS.
             16780                                      LINK_CONNECTED)) THEN
      600    16781    5                                IF (KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.LINK# ~= -1)
             16781                                         THEN

  16781   3 000576  E845 0004                            LDR,R6   4,B5
          3 000578  6DFF                                 CMV,R6   -1
          3 000579  0901 0054                            BE       s:16801,PREL

      601    16782    5                                     IF (KNN$LINK$(KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:92   
             16782                                              LINK#)->KNN$LINK.QOS < 255) THEN

  16782   3 00057B  A856                                 LDR,R2   R6
          3 00057C  CC80 0000 0000  xsym                 LDB,B4   GJA_LINK$
          3 00057F  BCA4                                 LDB,B3   ,B4,R2
          3 000580  D843 0004                            LDR,R5   4,B3
          3 000582  D970 00FF                            CMR,R5   255,IMO
          3 000584  0281 0009                            BGE      s:16785,PREL

      602    16783    5                                          GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;

  16783   3 000586  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_HOSTDOWN$
          3 000589  AF80 0000 0000  xsym                 STB,B2   GJA_MSG_DOWN$
          3 00058C  0F81 0041                            B        s:16801,PREL

      603    16784    5                                     ELSE
      604    16785    5                                          GJA_MSG_DOWN$ = GJA_MSG_LINKDOWN$;

  16785   3 00058E  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_LINKDOWN$
          3 000591  AF80 0000 0000  xsym                 STB,B2   GJA_MSG_DOWN$
          3 000594  0F81 0039                            B        s:16801,PREL

      605    16786    5                                ELSE
      606    16787    5                                     ; /* link recovery already occurred*/
      607    16788    5                           ELSE
      608    16789    5                                IF (GJA_DEFNODE = RECOVERY_NODE) AND

  16789   3 000596  F800 0000 0000  xsym                 LDR,R7   GJA_DEFNODE
          3 000599  6C00                                 LDV,R6   0
          3 00059A  84C7 0034                            SID      RECOVERY_NODE,AUTO
          3 00059C  6981 0031                            BNEZ,R6  s:16801,PREL
          3 00059E  7981 002F                            BNEZ,R7  s:16801,PREL
          3 0005A0  EC80 0000 0000  xsym                 LDB,B6   GJA_ROUTE$
          3 0005A3  B800 0000 0000  xsym                 LDR,R3   GJA_DEFNODE
          3 0005A6  DCB6                                 LDB,B5   ,B6,R3
          3 0005A7  E845 0007                            LDR,R6   7,B5
          3 0005A9  6001                                 SOL,R6   1
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:93   
          3 0005AA  E570 8000                            AND,R6   -32768,IMO
          3 0005AC  E670 8000                            XOR,R6   -32768,IMO
          3 0005AE  6901 001F                            BEZ,R6   s:16801,PREL

      609    16790    5                                  ~(KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.FLAGS.
             16790                                           LINK_CONNECTED) THEN
      610    16791    5                                    IF (KNN$ROUTE$(GJA_DEFNODE)->KNN$ROUTE.LINK# ~= -1
             16791                                              ) THEN

  16791   3 0005B0  E845 0004                            LDR,R6   4,B5
          3 0005B2  6DFF                                 CMV,R6   -1
          3 0005B3  0901 001A                            BE       s:16801,PREL

      611    16792    5                                          IF (KNN$LINK$(KNN$ROUTE$(GJA_DEFNODE)->
             16792                                                   KNN$ROUTE.LINK#)->KNN$LINK.QOS < 255)
             16792                                                   THEN

  16792   3 0005B5  A856                                 LDR,R2   R6
          3 0005B6  CC80 0000 0000  xsym                 LDB,B4   GJA_LINK$
          3 0005B9  BCA4                                 LDB,B3   ,B4,R2
          3 0005BA  D843 0004                            LDR,R5   4,B3
          3 0005BC  D970 00FF                            CMR,R5   255,IMO
          3 0005BE  0281 0009                            BGE      s:16795,PREL

      612    16793    5                                               GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;

  16793   3 0005C0  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_HOSTDOWN$
          3 0005C3  AF80 0000 0000  xsym                 STB,B2   GJA_MSG_DOWN$
          3 0005C6  0F81 0007                            B        s:16801,PREL

      613    16794    5                                          ELSE
      614    16795    5                                               GJA_MSG_DOWN$ = GJA_MSG_LINKDOWN$;

  16795   3 0005C8  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_LINKDOWN$
          3 0005CB  AF80 0000 0000  xsym                 STB,B2   GJA_MSG_DOWN$

      615    16796    5                                     ELSE ;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:94   
      616    16797        /*
      617    16798         *                  if we aren't waiting for the init_ack on this connection
      618    16799         *                  go ahead and attempt the reconnect.
      619    16800         */
      620    16801    6                      IF NOT GJA$HAND_CTX.WAT4ACK THEN DO;

  16801   3 0005CE  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 0005D0  82C6 000D                            LB,'0800'X        13,B6
          3 0005D2       0800
          3 0005D3  0501 0611                            BBT      s:17200,PREL

      621    16802    6                           CALL GJA$DISOLVE_NA(CTX$);

  16802   3 0005D5  DBC7 0026                            LAB,B5   CTX$,AUTO
          3 0005D7  DFC7 0042                            STB,B5   NMAVAIL+1,AUTO
          3 0005D9  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0005DB  CBF0 0100                            LAB,B4   256,IMO
          3 0005DD  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_NA
          3 0005E0       0001                            DC       s:16803,PREL

      622    16803    6                           ROUTE$ = KNN$ROUTE$(RECOVERY_NODE);

  16803   3 0005E1  8CC7 0034                            LDI      RECOVERY_NODE,AUTO
          3 0005E3  B857                                 LDR,R3   R7
          3 0005E4  EC80 0000 0000  xsym                 LDB,B6   GJA_ROUTE$
          3 0005E7  DCB6                                 LDB,B5   ,B6,R3
          3 0005E8  DFC7 002F                            STB,B5   ROUTE$,AUTO

      623    16804    6                           IF KNN$ROUTE.CURRENT_QOS < 255

  16804   3 0005EA  E845 0005                            LDR,R6   5,B5
          3 0005EC  E970 00FF                            CMR,R6   255,IMO
          3 0005EE  0281 05F6                            BGE      s:17200,PREL
          3 0005F0  F800 0000 0000  xsym                 LDR,R7   GJA_NODE#
          3 0005F3  6C00                                 LDV,R6   0
          3 0005F4  84C7 0034                            SID      RECOVERY_NODE,AUTO
          3 0005F6  6981 0003                            BNEZ,R6  s:16804+16,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:95   
          3 0005F8  7901 0003                            BEZ,R7   s:16804+18,PREL
          3 0005FA  0601 0005                            BCT      s:16808,PREL
          3 0005FC  89C5 0007                            CMZ      7,B5
          3 0005FE  0881 05E6                            BAGE     s:17200,PREL

      624    16805    6                             AND (RECOVERY_NODE < GJA_NODE#
      625    16806    6                             OR KNN$ROUTE.FLAGS.HOST_NODE = '1'B) THEN
      626    16807    7                           DO;

      627    16808    7                                GJA_CONNECT.RLCID.NODE = RECOVERY_NODE;

  16808   3 000600  E847 0035                            LDR,R6   RECOVERY_NODE+1,AUTO
          3 000602  E780 0000 000D  xsym                 STH,R6   GJA_CONNECT+13

      628    16809    7                                SIZE = SIZEW(GJA$HAND_CTX);

  16809   3 000605  5C11                                 LDV,R5   17
          3 000606  DF47 0032                            STR,R5   SIZE,AUTO

      629    16810    7                                CALL KVB$GETSYS(SIZE,CTX$)

  16810   3 000608  CBC7 0026                            LAB,B4   CTX$,AUTO
          3 00060A  CFC7 0044                            STB,B4   NMAVAIL+3,AUTO
          3 00060C  BBC7 0032                            LAB,B3   SIZE,AUTO
          3 00060E  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 000610  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000612  CBF0 0200                            LAB,B4   512,IMO
          3 000614  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          3 000617       0003                            DC       s:16812,PREL
          3 000618  0F81 0003                            B        s:16814,PREL

      630    16811    8                                WHENALTRETURN DO;

      631    16812    8                                     GOTO GETOUT;

  16812   3 00061A  0F81 05E6                            B        s:17203,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:96   
      632    16813    8                                     END;
      633    16814    7                                GJA$HAND_CTX = '0'B;

  16814   3 00061C  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00061E  5C22                                 LDV,R5   34
          3 00061F  0021                                 ALR      ;
          3 000620       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          3 000622       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

      634    16815    7                                GJA$HAND_CTX.WHO = %GJA_UID_NM;

  16815   3 000624  E870 2000                            LDR,R6   8192,IMO
          3 000626  437F                                 CSYNC    s:16815+1,SPREL
          3 000627  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000629  EA86                                 SRM,R6,'E000'X    ,B6
          3 00062A       E000

      635    16816    7                                GJA$HAND_CTX.NODE = RECOVERY_NODE;

  16816   3 00062B  C847 0035                            LDR,R4   RECOVERY_NODE+1,AUTO
          3 00062D  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00062F  CAC6 000D                            SRM,R4,'00FF'X    13,B6
          3 000631       00FF

      636    16817    7                                GJA$HAND_CTX.HOST_NODE = KNN$ROUTE.FLAGS.HOST_NODE;

  16817   3 000632  ECC7 002F                            LDB,B6   ROUTE$,AUTO
          3 000634  C846 0007                            LDR,R4   7,B6
          3 000636  4042                                 SOR,R4   2
          3 000637  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000639  CAC5 000D                            SRM,R4,'2000'X    13,B5
          3 00063B       2000

      637    16818    7                                IF GJA_NM_HEAD$ = ADDR(NIL)

  16818   3 00063C  8D80 0000 0000  xsym                 CMN      GJA_NM_HEAD$
          3 00063F  0981 0008                            BNE      s:16822,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:97   

      638    16819    7                                THEN
      639    16820    7                                     GJA_NM_HEAD$ = CTX$;

  16820   3 000641  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000643  DF80 0000 0000  xsym                 STB,B5   GJA_NM_HEAD$
          3 000646  0F81 000D                            B        s:16825,PREL

      640    16821    8                                ELSE DO;

      641    16822    8                                     GJA$HAND_CTX.LNK$ = GJA_NM_HEAD$;

  16822   3 000648  DC80 0000 0000  xsym                 LDB,B5   GJA_NM_HEAD$
          3 00064B  CCC7 0026                            LDB,B4   CTX$,AUTO
          3 00064D  DFC4 0001                            STB,B5   1,B4

      642    16823    8                                     GJA_NM_HEAD$ = CTX$;

  16823   3 00064F  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000651  DF80 0000 0000  xsym                 STB,B5   GJA_NM_HEAD$

      643    16824    8                                     END;

      644    16825    7                                KNN$ROUTE.CTX$ = CTX$;

  16825   3 000654  DFC6 0002                            STB,B5   2,B6

      645    16826    7                               CALL GJA$Q_MSG (CTX$,,,SIZEC(GJA_CONNECT),GJA_CONNECT,%
             16826                                         KN_FCN_INIT);

  16826   3 000656  CBF0 0026                            LAB,B4   38,IMO
          3 000658  BBF0 0001                            LAB,B3   1,IMO
          3 00065A  BFC7 004C                            STB,B3   NMAVAIL+11,AUTO
          3 00065C  AB80 0000 0000  xsym                 LAB,B2   GJA_CONNECT
          3 00065F  AFC7 004A                            STB,B2   NMAVAIL+9,AUTO
          3 000661  CFC7 0048                            STB,B4   NMAVAIL+7,AUTO
          3 000663  9B80 0000 0000                       LAB,B1   0
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:98   
          3 000666  9FC7 0046                            STB,B1   NMAVAIL+5,AUTO
          3 000668  EB80 0000 0000                       LAB,B6   0
          3 00066B  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 00066D  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 00066F  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 000671  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000673  CBF0 0600                            LAB,B4   1536,IMO
          3 000675  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000678       0001                            DC       s:16827,PREL

      646    16827    7                                GJA$HAND_CTX.WAT4ACK = '1'B;

  16827   3 000679  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00067B  8946 000D                            LBT,'0800'X       13,B6
          3 00067D       0800

      647    16828    7                                GJA$HAND_CTX.LINK_CONNECTED = KNN$ROUTE.FLAGS.
             16828                                         LINK_CONNECTED;

  16828   3 00067E  ECC7 002F                            LDB,B6   ROUTE$,AUTO
          3 000680  E846 0007                            LDR,R6   7,B6
          3 000682  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000684  EAC5 000D                            SRM,R6,'4000'X    13,B5
          3 000686       4000

      648    16829    7                                END;

      649    16830    6                           END;

  16830   3 000687  0F81 055D                            B        s:17200,PREL

      650    16831
      651    16832
      652    16833    5                    CASE (%GJA_UID_HANDLER);

      653    16834    5                      CALL GJA$TERM_HANDLER(CTX$);

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:99   
  16834   3 000689  BBC7 0026                            LAB,B3   CTX$,AUTO
          3 00068B  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 00068D  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 00068F  CBF0 0100                            LAB,B4   256,IMO
          3 000691  E380 0000 0000  xent                 LNJ,B6   GJA$TERM_HANDLER
          3 000694       0001                            DC       s:16834+12,PREL
          3 000695  0F81 054F                            B        s:17200,PREL

      654    16835
      655    16836
      656    16837
      657    16838    5                    CASE (ELSE);

      658    16839    5                      CALL GJA$Q_MSG (ADDR(KNH$MESS.LDCTX),,,SIZEC(GJA_TERM_ACK),
             16839                               GJA_TERM_ACK,%KN_FCN_TERM_ACK);

  16839   3 000697  BBC5 0001                            LAB,B3   1,B5
          3 000699  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 00069B  ABF0 0004                            LAB,B2   4,IMO
          3 00069D  9BF0 0004                            LAB,B1   4,IMO
          3 00069F  9FC7 004E                            STB,B1   NMAVAIL+13,AUTO
          3 0006A1  EB80 0000 0000  xsym                 LAB,B6   GJA_TERM_ACK
          3 0006A4  EFC7 004C                            STB,B6   NMAVAIL+11,AUTO
          3 0006A6  AFC7 004A                            STB,B2   NMAVAIL+9,AUTO
          3 0006A8  EB80 0000 0000                       LAB,B6   0
          3 0006AB  EFC7 0048                            STB,B6   NMAVAIL+7,AUTO
          3 0006AD  EB80 0000 0000                       LAB,B6   0
          3 0006B0  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 0006B2  EBC7 0042                            LAB,B6   NMAVAIL+1,AUTO
          3 0006B4  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 0006B6  BBC7 0044                            LAB,B3   NMAVAIL+3,AUTO
          3 0006B8  CBF0 0600                            LAB,B4   1536,IMO
          3 0006BA  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 0006BD       0001                            DC       s:16842,PREL

      659    16840
      660    16841
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:100  
      661    16842    5                      END;

  16842   3 0006BE  0F81 0526                            B        s:17200,PREL

      662    16843        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:101  
      663    16844        /*   Terminate Connection Acknowledgement
      664    16845        */
      665    16846        /*
      666    16847          For right now lets make sure that this is from VDH on behalf
      667    16848          of a user logon path that was just disolved.  If it was, call
      668    16849          a routine to disolve the context block.  Lets also make sure that
      669    16850          we were expecting this.  I hate surprises!
      670    16851        */
      671    16852    4                 CASE(%KN_FCN_TERM_ACK);

      672    16853    5                   DO CASE (WHO);

  16853   3 0006C0  9847 001D                            LDR,R1   WHO,AUTO
          3 0006C2  1D05                                 CMV,R1   5
          3 0006C3  0281 0031                            BGE      s:16865,PREL
          3 0006C5  B810 0000 06CB  03                   LDR,R3   s:16853+11,R1
          3 0006C8  83B0 0000 06D0  03                   JMP      s:16856,R3
          3 0006CB       0025                            DC       s:16865,PREL
          3 0006CC       0000                            DC       s:16856,PREL
          3 0006CD       0025                            DC       s:16865,PREL
          3 0006CE       0025                            DC       s:16865,PREL
          3 0006CF       000E                            DC       s:16859,PREL

      673    16854
      674    16855    5                    CASE (%GJA_UID_NM);

      675    16856    5                      CALL GJA$DISOLVE_NA(CTX$);

  16856   3 0006D0  BBC7 0026                            LAB,B3   CTX$,AUTO
          3 0006D2  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 0006D4  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0006D6  CBF0 0100                            LAB,B4   256,IMO
          3 0006D8  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_NA
          3 0006DB       0001                            DC       s:16856+12,PREL
          3 0006DC  0F81 0508                            B        s:17200,PREL

      676    16857
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:102  
      677    16858    5                    CASE (%GJA_UID_LOGON);

      678    16859    5                      IF NOT(CTX$->GJA$LGNCTX.STATUS.TERMACK)

  16859   3 0006DE  82C4 0018                            LB,'1000'X        24,B4
  16859   3 0006E0       1000
          3 0006E1  0501 0005                            BBT      s:16862,PREL

      679    16860    5                      THEN
      680    16861    5                           CALL M$XXX;

  16861   3 0006E3  B870 0082                            LDR,R3   130,IMO
          3 0006E5  0001                                 MCL
          3 0006E6       0000                            DC       s:16861+3,PREL

      681    16862    5                      CALL GJA$DISOLVE_LGNUSR_CTX (CTX$);

  16862   3 0006E7  EBC7 0026                            LAB,B6   CTX$,AUTO
          3 0006E9  EFC7 0042                            STB,B6   NMAVAIL+1,AUTO
          3 0006EB  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0006ED  CBF0 0100                            LAB,B4   256,IMO
          3 0006EF  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_LGNUSR_CTX
          3 0006F2       0001                            DC       s:16862+12,PREL
          3 0006F3  0F81 04F1                            B        s:17200,PREL

      682    16863
      683    16864    5                    CASE (ELSE);

      684    16865    5                      CALL M$XXX;

  16865   3 0006F5  B870 0082                            LDR,R3   130,IMO
          3 0006F7  0001                                 MCL
          3 0006F8       0000                            DC       s:16865+3,PREL

      685    16866
      686    16867    5                      END;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:103  
  16867   3 0006F9  0F81 04EB                            B        s:17200,PREL

      687    16868
      688    16869
      689    16870        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:104  
      690    16871        /*   Send Data
      691    16872        */
      692    16873        /*
      693    16874          Branch out depending on the VDO type
      694    16875        */
      695    16876    4                 CASE(%KN_FCN_DATA);

      696    16877    4                   IF WHO ~= %GJA_UID_LOGON OR ~GJA$LGNCTX.STATUS.TERMACK

  16877   3 0006FB  C847 001D                            LDR,R4   WHO,AUTO
          3 0006FD  4D04                                 CMV,R4   4
          3 0006FE  0981 000A                            BNE      s:16879,PREL
          3 000700  9844 0018                            LDR,R1   24,B4
          3 000702  1003                                 SOL,R1   3
          3 000703  9570 8000                            AND,R1   -32768,IMO
          3 000705  9670 8000                            XOR,R1   -32768,IMO
          3 000707  1901 04DD                            BEZ,R1   s:17200,PREL

      697    16878    5                   THEN DO;

      698    16879    5                        VDO$ = PINCRW(MSG$,SIZEW(KNH$MESS));

  16879   3 000709  BBC5 0008                            LAB,B3   8,B5
          3 00070B  BFC7 002C                            STB,B3   VDO$,AUTO

      699    16880    5                        GJA$PARAMS='0'B;

  16880   3 00070D  5C2E                                 LDV,R5   46
          3 00070E  0021                                 ALR      ;
          3 00070F       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          3 000711       4007 0005                                ALPHANUM(GJA$PARAMS,AUTO,,R5,FILL)

      700    16881    5                        GJA$PARAMS.MSG$=MSG$;

  16881   3 000713  437F                                 CSYNC    s:16880+5,SPREL
          3 000714  DCC7 0020                            LDB,B5   MSG$,AUTO
          3 000716  DFC7 0005                            STB,B5   GJA$PARAMS,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:105  

      701    16882    5                        GJA$PARAMS.VDO$=VDO$;

  16882   3 000718  CCC7 002C                            LDB,B4   VDO$,AUTO
          3 00071A  CFC7 0007                            STB,B4   GJA$PARAMS+2,AUTO

      702    16883    6   VDOLOOP:             DO WHILE ('1'B);

  16883   3                              VDOLOOP         null
      703    16884    6                             VLP$=PINCRW(VDO$,(GJA_VDOBYTSIZ(KV$VDO.FNC)+1)/2);

  16884   3 00071C  ECC7 002C            VDOLOOP         LDB,B6   VDO$,AUTO
          3 00071E  B286                                 LLH,R3   ,B6
          3 00071F  E2B0 0000 0000  xsym                 LLH,R6   GJA_VDOBYTSIZ,R3
          3 000722  6E01                                 ADV,R6   1
          3 000723  6041                                 SOR,R6   1
          3 000724  F856                                 LDR,R7   R6
          3 000725  6C00                                 LDV,R6   0
          3 000726  8447 002C                            AID      VDO$,AUTO
          3 000728  8D47 002A                            SDI      VLP$,AUTO

      704    16885    6                             LAST = ~KV$VDO.VLP;

  16885   3 00072A  D806                                 LDR,R5   ,B6
          3 00072B  5008                                 SOL,R5   8
          3 00072C  D570 8000                            AND,R5   -32768,IMO
          3 00072E  D670 8000                            XOR,R5   -32768,IMO
          3 000730  DF47 0033                            STR,R5   LAST,AUTO

      705    16886    7   VLPLOOP:                  DO WHILE (~LAST);

  16886   3 000732  0F81 00B6            VLPLOOP         B        s:16949,PREL

      706    16887    8                                  DO CASE(KV$VDOVLP.TYP);

  16887   3 000734  ECC7 002A                            LDB,B6   VLP$,AUTO
          3 000736  B806                                 LDR,R3   ,B6
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:106  
          3 000737  3048                                 SOR,R3   8
          3 000738  B570 007F                            AND,R3   127,IMO
          3 00073A  3D0C                                 CMV,R3   12
          3 00073B  0281 009B                            BGE      s:16943,PREL
          3 00073D  A830 0000 0743  03                   LDR,R2   s:16887+15,R3
          3 000740  83A0 0000 074F  03                   JMP      s:16890,R2
          3 000743       0088                            DC       s:16943,PREL
          3 000744       0072                            DC       s:16934,PREL
          3 000745       002A                            DC       s:16904,PREL
          3 000746       0033                            DC       s:16909,PREL
          3 000747       0000                            DC       s:16890,PREL
          3 000748       0016                            DC       s:16897,PREL
          3 000749       003C                            DC       s:16914,PREL
          3 00074A       0045                            DC       s:16919,PREL
          3 00074B       0054                            DC       s:16924,PREL
          3 00074C       0063                            DC       s:16929,PREL
          3 00074D       0088                            DC       s:16943,PREL
          3 00074E       0081                            DC       s:16939,PREL

      707    16888
      708    16889    8                                   CASE(%KV_VDOVLP_TYP_DAT1);

      709    16890    8                                     APP$ = PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_DAT1));

  16890   3 00074F  DBC6 0001                            LAB,B5   1,B6
          3 000751  DFC7 0022                            STB,B5   APP$,AUTO

      710    16891    8                                     VLPSIZE=(VLP$->KV$VDOVLP_DAT1.BYTSIZ+1)/2;

  16891   3 000753  E806                                 LDR,R6   ,B6
          3 000754  E570 00FF                            AND,R6   255,IMO
          3 000756  6E01                                 ADV,R6   1
          3 000757  6041                                 SOR,R6   1
          3 000758  EF47 001C                            STR,R6   VLPSIZE,AUTO

      711    16892    8                                     GJA$PARAMS.DATVLP$=VLP$;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:107  
  16892   3 00075A  EFC7 0009                            STB,B6   GJA$PARAMS+4,AUTO

      712    16893    8                                     GJA$PARAMS.DAT$=APP$;

  16893   3 00075C  DFC7 000B                            STB,B5   GJA$PARAMS+6,AUTO

      713    16894    8                                     GJA$PARAMS.DATSIZE = VLP$->KV$VDOVLP_DAT1.BYTSIZ;

  16894   3 00075E  D806                                 LDR,R5   ,B6
          3 00075F  D570 00FF                            AND,R5   255,IMO
          3 000761  DF47 000D                            STR,R5   GJA$PARAMS+8,AUTO
          3 000763  0F81 0077                            B        s:16947,PREL

      714    16895
      715    16896    8                                   CASE(%KV_VDOVLP_TYP_DAT2);

      716    16897    8                                     APP$ = PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_DAT2));

  16897   3 000765  DBC6 0002                            LAB,B5   2,B6
          3 000767  DFC7 0022                            STB,B5   APP$,AUTO

      717    16898    8                                     VLPSIZE=(VLP$->KV$VDOVLP_DAT2.BYTSIZ+1)/2;

  16898   3 000769  E846 0001                            LDR,R6   1,B6
          3 00076B  6E01                                 ADV,R6   1
          3 00076C  6041                                 SOR,R6   1
          3 00076D  EF47 001C                            STR,R6   VLPSIZE,AUTO

      718    16899    8                                     GJA$PARAMS.DATVLP$=VLP$;

  16899   3 00076F  EFC7 0009                            STB,B6   GJA$PARAMS+4,AUTO

      719    16900    8                                     GJA$PARAMS.DAT$=APP$;

  16900   3 000771  DFC7 000B                            STB,B5   GJA$PARAMS+6,AUTO

      720    16901    8                                     GJA$PARAMS.DATSIZE = VLP$->KV$VDOVLP_DAT2.BYTSIZ;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:108  

  16901   3 000773  D846 0001                            LDR,R5   1,B6
          3 000775  DF47 000D                            STR,R5   GJA$PARAMS+8,AUTO
          3 000777  0F81 0063                            B        s:16947,PREL

      721    16902
      722    16903    8                                   CASE(%KV_VDOVLP_TYP_CG_MSGTYP);

      723    16904    8                                     APP$=VLP$;

  16904   3 000779  EFC7 0022                            STB,B6   APP$,AUTO

      724    16905    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_CG_MSGTYP);

  16905   3 00077B  6C06                                 LDV,R6   6
          3 00077C  EF47 001C                            STR,R6   VLPSIZE,AUTO

      725    16906    8                                     GJA$PARAMS.CG_MSGTYP$=VLP$;

  16906   3 00077E  EFC7 000E                            STB,B6   GJA$PARAMS+9,AUTO
          3 000780  0F81 005A                            B        s:16947,PREL

      726    16907
      727    16908    8                                   CASE(%KV_VDOVLP_TYP_CG_STA);

      728    16909    8                                     APP$=VLP$;

  16909   3 000782  EFC7 0022                            STB,B6   APP$,AUTO

      729    16910    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_CG_STA);

  16910   3 000784  6C06                                 LDV,R6   6
          3 000785  EF47 001C                            STR,R6   VLPSIZE,AUTO

      730    16911    8                                     GJA$PARAMS.CG_STA$=VLP$;

  16911   3 000787  EFC7 0010                            STB,B6   GJA$PARAMS+11,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:109  
          3 000789  0F81 0051                            B        s:16947,PREL

      731    16912
      732    16913    8                                   CASE(%KV_VDOVLP_TYP_ERR);

      733    16914    8                                     APP$=VLP$;

  16914   3 00078B  EFC7 0022                            STB,B6   APP$,AUTO

      734    16915    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_ERR);

  16915   3 00078D  6C03                                 LDV,R6   3
          3 00078E  EF47 001C                            STR,R6   VLPSIZE,AUTO

      735    16916    8                                     GJA$PARAMS.ERR$=VLP$;

  16916   3 000790  EFC7 0014                            STB,B6   GJA$PARAMS+15,AUTO
          3 000792  0F81 0048                            B        s:16947,PREL

      736    16917
      737    16918    8                                   CASE(%KV_VDOVLP_TYP_FLDID);

      738    16919    8                                     APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_FLDID));

  16919   3 000794  DBC6 0002                            LAB,B5   2,B6
          3 000796  DFC7 0022                            STB,B5   APP$,AUTO

      739    16920    8                                     VLPSIZE=(VLP$->KV$VDOVLP_FLDID.BYTSIZ+1)/2;

  16920   3 000798  E806                                 LDR,R6   ,B6
          3 000799  E570 00FF                            AND,R6   255,IMO
          3 00079B  6E01                                 ADV,R6   1
          3 00079C  6041                                 SOR,R6   1
          3 00079D  EF47 001C                            STR,R6   VLPSIZE,AUTO

      740    16921    8                                     GJA$PARAMS.FLDID$=VLP$;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:110  
  16921   3 00079F  EFC7 0016                            STB,B6   GJA$PARAMS+17,AUTO
          3 0007A1  0F81 0039                            B        s:16947,PREL

      741    16922
      742    16923    8                                   CASE(%KV_VDOVLP_TYP_KEY);

      743    16924    8                                     APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_KEY));

  16924   3 0007A3  DBC6 0001                            LAB,B5   1,B6
          3 0007A5  DFC7 0022                            STB,B5   APP$,AUTO

      744    16925    8                                     VLPSIZE=(VLP$->KV$VDOVLP_KEY.BYTSIZ+1)/2;

  16925   3 0007A7  E806                                 LDR,R6   ,B6
          3 0007A8  E570 00FF                            AND,R6   255,IMO
          3 0007AA  6E01                                 ADV,R6   1
          3 0007AB  6041                                 SOR,R6   1
          3 0007AC  EF47 001C                            STR,R6   VLPSIZE,AUTO

      745    16926    8                                     GJA$PARAMS.KEY$=VLP$;

  16926   3 0007AE  EFC7 0018                            STB,B6   GJA$PARAMS+19,AUTO
          3 0007B0  0F81 002A                            B        s:16947,PREL

      746    16927
      747    16928    8                                   CASE(%KV_VDOVLP_TYP_MRK);

      748    16929    8                                     GJA$PARAMS.MRK$=VLP$;

  16929   3 0007B2  EFC7 001A                            STB,B6   GJA$PARAMS+21,AUTO

      749    16930    8                                     APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_MRK));

  16930   3 0007B4  DBC6 0004                            LAB,B5   4,B6
          3 0007B6  DFC7 0022                            STB,B5   APP$,AUTO

      750    16931    8                                     VLPSIZE=(VLP$->KV$VDOVLP_MRK.BYTSIZ+1)/2;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:111  

  16931   3 0007B8  E806                                 LDR,R6   ,B6
          3 0007B9  E570 00FF                            AND,R6   255,IMO
          3 0007BB  6E01                                 ADV,R6   1
          3 0007BC  6041                                 SOR,R6   1
          3 0007BD  EF47 001C                            STR,R6   VLPSIZE,AUTO
          3 0007BF  0F81 001B                            B        s:16947,PREL

      751    16932
      752    16933    8                                   CASE(%KV_VDOVLP_TYP_CG_MSGID);

      753    16934    8                                    APP$=PINCRW(VLP$,SIZEW(VLP$->KV$VDOVLP_CG_MSGID));

  16934   3 0007C1  DBC6 0006                            LAB,B5   6,B6
          3 0007C3  DFC7 0022                            STB,B5   APP$,AUTO

      754    16935    8                                     VLPSIZE=(VLP$->KV$VDOVLP_CG_MSGID.BYTSIZ+1)/2;

  16935   3 0007C5  E806                                 LDR,R6   ,B6
          3 0007C6  E570 00FF                            AND,R6   255,IMO
          3 0007C8  6E01                                 ADV,R6   1
          3 0007C9  6041                                 SOR,R6   1
          3 0007CA  EF47 001C                            STR,R6   VLPSIZE,AUTO

      755    16936    8                                     GJA$PARAMS.CG_MSGID$=VLP$;

  16936   3 0007CC  EFC7 0012                            STB,B6   GJA$PARAMS+13,AUTO
          3 0007CE  0F81 000C                            B        s:16947,PREL

      756    16937
      757    16938    8                                   CASE(%KV_VDOVLP_TYP_ACTPOS);

      758    16939    8                                     APP$=VLP$;

  16939   3 0007D0  EFC7 0022                            STB,B6   APP$,AUTO

      759    16940    8                                     VLPSIZE=SIZEW(VLP$->KV$VDOVLP_ACTPOS);
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:112  

  16940   3 0007D2  6C02                                 LDV,R6   2
          3 0007D3  EF47 001C                            STR,R6   VLPSIZE,AUTO
          3 0007D5  0F81 0005                            B        s:16947,PREL

      760    16941
      761    16942    8                                   CASE(ELSE);

      762    16943    8                                     CALL M$XXX;

  16943   3 0007D7  B870 0082                            LDR,R3   130,IMO
          3 0007D9  0001                                 MCL
          3 0007DA       0000                            DC       s:16943+3,PREL

      763    16944    8                                     END;  /* VLP CASE                 */

      764    16945
      765    16946
      766    16947    7                                  LAST = KV$VDOVLP.LST;

  16947   3 0007DB  ECC7 002A                            LDB,B6   VLP$,AUTO
          3 0007DD  E806                                 LDR,R6   ,B6
          3 0007DE  E570 8000                            AND,R6   -32768,IMO
          3 0007E0  EF47 0033                            STR,R6   LAST,AUTO

      767    16948    7                                  VLP$=PINCRW(APP$,VLPSIZE);

  16948   3 0007E2  F847 001C                            LDR,R7   VLPSIZE,AUTO
          3 0007E4  6C00                                 LDV,R6   0
          3 0007E5  8447 0022                            AID      APP$,AUTO
          3 0007E7  8D47 002A                            SDI      VLP$,AUTO

      768    16949    7                                  END;     /* VLP LOOP                 */

  16949   3 0007E9  D847 0033                            LDR,R5   LAST,AUTO
          3 0007EB  D570 8000                            AND,R5   -32768,IMO
          3 0007ED  D670 8000                            XOR,R5   -32768,IMO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:113  
          3 0007EF  5981 FF44                            BNEZ,R5  s:16887,PREL

      769    16950        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:114  
      770    16951        /* If there was a marker on the message send it now */
      771    16952    6                             IF GJA$PARAMS.MRK$ ~= ADDR(NIL) AND GJA$PARAMS.MRK$->
             16952                                      KV$VDOVLP_MRK.MRKTYP ~= 0

  16952   3 0007F1  8DC7 001A                            CMN      GJA$PARAMS+21,AUTO
          3 0007F3  0901 0035                            BE       s:16962,PREL
          3 0007F5  ECC7 001A                            LDB,B6   GJA$PARAMS+21,AUTO
          3 0007F7  82C6 0001                            LB,'00FF'X        1,B6
          3 0007F9       00FF
          3 0007FA  0581 002E                            BBF      s:16962,PREL
          3 0007FC  DCC7 002C                            LDB,B5   VDO$,AUTO
          3 0007FE  D285                                 LLH,R5   ,B5
          3 0007FF  5D1F                                 CMV,R5   31
          3 000800  0901 0028                            BE       s:16962,PREL

      772    16953    6                               AND KV$VDO.FNC ~= %KV_VDO_FNC_MRK
      773    16954    7                             THEN DO;

      774    16955    7                                  GJA_VDO_MRK.MRK.MRKTYP = GJA$PARAMS.MRK$->
             16955                                           KV$VDOVLP_MRK.MRKTYP;

  16955   3 000802  C846 0001                            LDR,R4   1,B6
          3 000804  CA80 0000 0002  xsym                 SRM,R4,'00FF'X    GJA_VDO_MRK+2
          3 000807       00FF

      775    16956    7                                  GJA_VDO_MRK.MRK.ID = GJA$PARAMS.MRK$->KV$VDOVLP_MRK.
             16956                                           ID;

  16956   3 000808  8CC6 0002                            LDI      2,B6
          3 00080A  8D00 0000 0003  xsym                 SDI      GJA_VDO_MRK+3

      776    16957    7                                  CALL GJA$Q_MSG (KNH$MESS.UID$,SIZEC(GJA_VDO_MRK),
             16957                                           GJA_VDO_MRK);

  16957   3 00080D  CBF0 000A                            LAB,B4   10,IMO
          3 00080F  BB80 0000 0000  xsym                 LAB,B3   GJA_VDO_MRK
          3 000812  BFC7 0046                            STB,B3   NMAVAIL+5,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:115  
          3 000814  CFC7 0044                            STB,B4   NMAVAIL+3,AUTO
          3 000816  ACC7 0020                            LDB,B2   MSG$,AUTO
          3 000818  9BC2 0002                            LAB,B1   2,B2
          3 00081A  9FC7 0042                            STB,B1   NMAVAIL+1,AUTO
          3 00081C  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 00081E  CBF0 0300                            LAB,B4   768,IMO
          3 000820  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000823       0001                            DC       s:16958,PREL

      777    16958    7                                  GJA$PARAMS.MRK$->KV$VDOVLP_MRK.MRKTYP = 0;

  16958   3 000824  ECC7 001A                            LDB,B6   GJA$PARAMS+21,AUTO
          3 000826  8846 0001                            LBF,'00FF'X       1,B6
          3 000828       00FF

      778    16959    7                                  END;

      779    16960
      780    16961
      781    16962    7                             DO CASE(KV$VDO.FNC); /* VDO CASE          */

  16962   3 000829  ECC7 002C                            LDB,B6   VDO$,AUTO
          3 00082B  B286                                 LLH,R3   ,B6
          3 00082C  3D19                                 CMV,R3   25
          3 00082D  0281 039A                            BGE      s:17186,PREL
          3 00082F  A830 0000 0835  03                   LDR,R2   s:16962+12,R3
          3 000832  83A0 0000 084E  03                   JMP      s:16967,R2
          3 000835       037A                            DC       s:17186,PREL
          3 000836       037A                            DC       s:17186,PREL
          3 000837       004F                            DC       s:16986,PREL
          3 000838       037A                            DC       s:17186,PREL
          3 000839       037A                            DC       s:17186,PREL
          3 00083A       02B1                            DC       s:17135,PREL
          3 00083B       037A                            DC       s:17186,PREL
          3 00083C       037A                            DC       s:17186,PREL
          3 00083D       037A                            DC       s:17186,PREL
          3 00083E       037A                            DC       s:17186,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:116  
          3 00083F       0332                            DC       s:17162,PREL
          3 000840       037A                            DC       s:17186,PREL
          3 000841       037A                            DC       s:17186,PREL
          3 000842       0000                            DC       s:16967,PREL
          3 000843       037A                            DC       s:17186,PREL
          3 000844       037A                            DC       s:17186,PREL
          3 000845       001A                            DC       s:16978,PREL
          3 000846       037A                            DC       s:17186,PREL
          3 000847       037A                            DC       s:17186,PREL
          3 000848       037A                            DC       s:17186,PREL
          3 000849       037A                            DC       s:17186,PREL
          3 00084A       037A                            DC       s:17186,PREL
          3 00084B       0057                            DC       s:16992,PREL
          3 00084C       037A                            DC       s:17186,PREL
          3 00084D       01A9                            DC       s:17074,PREL

      782    16963        /*
      783    16964          FNC = Event
      784    16965         */
      785    16966    7                              CASE (%KV_VDO_FNC_EVT);

      786    16967    7                                IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.RDPND

  16967   3 00084E  DCC7 0020                            LDB,B5   MSG$,AUTO
          3 000850  CCC5 0002                            LDB,B4   2,B5
          3 000852  82C4 0018                            LB,'0080'X        24,B4
          3 000854       0080
          3 000855  0581 0372                            BBF      s:17186,PREL

      787    16968    8                                THEN DO;

      788    16969    8                                     KNH$MESS.UID$->GJA$LGNCTX.STATUS.RDPND = '0'B;

  16969   3 000857  8844 0018                            LBF,'0080'X       24,B4
  16969   3 000859       0080

      789    16970    8                                     CALL GJA$SOLICIT_LOGON(KNH$MESS.UID$);
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:117  

  16970   3 00085A  CBC5 0002                            LAB,B4   2,B5
          3 00085C  CFC7 0042                            STB,B4   NMAVAIL+1,AUTO
          3 00085E  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000860  CBF0 0100                            LAB,B4   256,IMO
          3 000862  E380 0000 0000  xent                 LNJ,B6   GJA$SOLICIT_LOGON
          3 000865       0001                            DC       s:16971,PREL

      790    16971    8                                     END;

  16971   3 000866  0F81 0361                            B        s:17186,PREL

      791    16972        /*
      792    16973          FNC = Open session request
      793    16974          FNC = Block data (for flow control)
      794    16975
      795    16976          Send a read response to set throttle
      796    16977        */
      797    16978    7                              CASE(%KV_VDO_FNC_OPNSSN_RQS);

      798    16979    7   UN_FLOW:                     KV@VDO_RQSDAT=KV_VDO_RQSDAT;

  16979   3 000868  AB80 0000 0000  01   UN_FLOW         LAB,B2   PRIVS
          3 00086B  2C06                                 LDV,R2   6
          3 00086C  6C0A                                 LDV,R6   10
          3 00086D  BB87                                 LAB,B3   ,AUTO
          3 00086E  3C6C                                 LDV,R3   108
          3 00086F  0008                                 MMM

      799    16980    7                                CALL GJA$Q_MSG(KNH$MESS.UID,SIZEC(

  16980   3 000870  EBF0 000A                            LAB,B6   10,IMO
          3 000872  DBC7 0036                            LAB,B5   KV@VDO_RQSDAT,AUTO
          3 000874  DFC7 0046                            STB,B5   NMAVAIL+5,AUTO
          3 000876  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 000878  CCC7 0020                            LDB,B4   MSG$,AUTO
          3 00087A  ABC4 0002                            LAB,B2   2,B4
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:118  
          3 00087C  AFC7 0042                            STB,B2   NMAVAIL+1,AUTO
          3 00087E  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000880  CBF0 0300                            LAB,B4   768,IMO
          3 000882  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000885       0001                            DC       s:16982,PREL

      800    16981    7                                  KV$VDO_RQSDAT),KV@VDO_RQSDAT);
      801    16982    7                                IF CTX$ ~= ADDR(NIL) AND WHO = %GJA_UID_HANDLER

  16982   3 000886  8DC7 0026                            CMN      CTX$,AUTO
          3 000888  0901 033F                            BE       s:17186,PREL
          3 00088A  E847 001D                            LDR,R6   WHO,AUTO
          3 00088C  6D03                                 CMV,R6   3
          3 00088D  0981 033A                            BNE      s:17186,PREL
          3 00088F  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000891  82C6 000D                            LB,'1000'X        13,B6
          3 000893       1000
          3 000894  0501 0333                            BBT      s:17186,PREL

      802    16983    7                                  AND NOT CTX$->GJA$HAND_CTX.BLK THEN
      803    16984    7                                     CTX$->GJA$HAND_CTX.RDSOUT = GJA_MAXRDS;

  16984   3 000896  D800 0000 0000  xsym                 LDR,R5   GJA_MAXRDS
          3 000899  DF46 0006                            STR,R5   6,B6
          3 00089B  0F81 032C                            B        s:17186,PREL

      804    16985    7                              CASE(%KV_VDO_FNC_BLKDAT);

      805    16986    7                                IF NOT GJA$HAND_CTX.BLK

  16986   3 00089D  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 00089F  82C5 000D                            LB,'1000'X        13,B5
          3 0008A1       1000
          3 0008A2  05C6                                 BBF      s:16978,SPREL
          3 0008A3  0F81 0324                            B        s:17186,PREL

      806    16987    7                                THEN GOTO UN_FLOW;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:119  
      807    16988        /*
      808    16989          FNC = Request Data
      809    16990        */
      810    16991    7                              CASE(%KV_VDO_FNC_RQSDAT);

      811    16992    7                                IF KV$VDO_RQSDAT.EOFNO_DAT AND GJA$HAND_CTX.
             16992                                         WAITING_MSG$ = ADDR(NIL)

  16992   3 0008A5  82C6 0004                            LB,'0400'X        4,B6
  16992   3 0008A7       0400
          3 0008A8  0581 001E                            BBF      s:16997,PREL
          3 0008AA  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 0008AC  8DC5 0007                            CMN      7,B5
          3 0008AE  0981 0018                            BNE      s:16997,PREL

      812    16993    8                                THEN DO;

      813    16994    8                                     CALL GJA$Q_MSG(CTX$,SIZEC(VDO_NODAT),VDO_NODAT);

  16994   3 0008B0  CBF0 000A                            LAB,B4   10,IMO
          3 0008B2  BB80 0000 0008  01                   LAB,B3   VDO_NODAT
          3 0008B5  BFC7 0046                            STB,B3   NMAVAIL+5,AUTO
          3 0008B7  CFC7 0044                            STB,B4   NMAVAIL+3,AUTO
          3 0008B9  ABC7 0026                            LAB,B2   CTX$,AUTO
          3 0008BB  AFC7 0042                            STB,B2   NMAVAIL+1,AUTO
          3 0008BD  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0008BF  CBF0 0300                            LAB,B4   768,IMO
          3 0008C1  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 0008C4       0001                            DC       s:16995,PREL

      814    16995    8                                     END;

  16995   3 0008C5  0F81 00C6                            B        s:17040,PREL

      815    16996    8                                ELSE DO;

      816    16997    8                                     IF KV$VDO_RQSDAT.INCMAXNMBBYT
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:120  

  16997   3 0008C7  82C6 0004                            LB,'4000'X        4,B6
  16997   3 0008C9       4000
          3 0008CA  0581 000B                            BBF      s:16999,PREL

      817    16998    8                                     THEN GJA$HAND_CTX.MAXNMBBYT = GJA$HAND_CTX.
             16998                                              MAXNMBBYT + KV$VDO_RQSDAT.MAXNMBBYT;

  16998   3 0008CC  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 0008CE  E845 0005                            LDR,R6   5,B5
          3 0008D0  EA46 0003                            ADD,R6   3,B6
          3 0008D2  EF45 0005                            STR,R6   5,B5
          3 0008D4  0F81 0007                            B        s:17002,PREL

      818    16999    8                                     ELSE GJA$HAND_CTX.MAXNMBBYT = KV$VDO_RQSDAT.
             16999                                              MAXNMBBYT;

  16999   3 0008D6  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 0008D8  E846 0003                            LDR,R6   3,B6
          3 0008DA  EF45 0005                            STR,R6   5,B5

      819    17000        /* Check to see if we are incrementing.
      820    17001        */
      821    17002    8                                     IF KV$VDO_RQSDAT.INCMAXNMBRCR

  17002   3 0008DC  89C6 0004                            CMZ      4,B6
          3 0008DE  0881 000B                            BAGE     s:17004,PREL

      822    17003    8                                     THEN GJA$HAND_CTX.MAXNMBRCR = GJA$HAND_CTX.
             17003                                              MAXNMBRCR + KV$VDO_RQSDAT.MAXNMBRCR;

  17003   3 0008E0  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 0008E2  E845 0004                            LDR,R6   4,B5
          3 0008E4  EA46 0002                            ADD,R6   2,B6
          3 0008E6  EF45 0004                            STR,R6   4,B5
          3 0008E8  0F81 0007                            B        s:17005,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:121  
      823    17004    8                                     ELSE GJA$HAND_CTX.MAXNMBRCR = KV$VDO_RQSDAT.
             17004                                              MAXNMBRCR;

  17004   3 0008EA  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 0008EC  E846 0002                            LDR,R6   2,B6
          3 0008EE  EF45 0004                            STR,R6   4,B5

      824    17005    8                                     GJA$HAND_CTX.MAXRCRBYTSIZ = KV$VDO_RQSDAT.
             17005                                              MAXRCRBYTSIZ;

  17005   3 0008F0  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 0008F2  E846 0001                            LDR,R6   1,B6
          3 0008F4  EF45 0003                            STR,R6   3,B5

      825    17006        /* Send any messages waiting.
      826    17007        */
      827    17008    8                                     MSGWTSIZE = 0;

  17008   3 0008F6  8747 003C                            CL       MSGWTSIZE,AUTO

      828    17009    9                                     DO WHILE (GJA$HAND_CTX.WAITING_MSG$~=ADDR(NIL));

  17009   3 0008F8  0F81 008D                            B        s:17038,PREL

      829    17010    9                                          SVMSG$=GJA$HAND_CTX.WAITING_MSG$;

  17010   3 0008FA  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 0008FC  DCC6 0007                            LDB,B5   7,B6
          3 0008FE  DFC7 0028                            STB,B5   SVMSG$,AUTO

      830    17011    9                                          IF SVMSG$->SV$MSG.SZ > GJA$HAND_CTX.
             17011                                                   MAXRCRBYTSIZ AND

  17011   3 000900  E845 0003                            LDR,R6   3,B5
          3 000902  E946 0003                            CMR,R6   3,B6
          3 000904  0381 001E                            BLE      s:17018,PREL
          3 000906  D846 0004                            LDR,R5   4,B6
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:122  
          3 000908  5901 001A                            BEZ,R5   s:17018,PREL

      831    17012    9                                            GJA$HAND_CTX.MAXNMBRCR > 0 THEN
      832    17013   10                                          DO;

      833    17014   10                                               GJA$HAND_CTX.MAXNMBRCR = GJA$HAND_CTX.
             17014                                                        MAXNMBRCR-1;

  17014   3 00090A  88C6 0004                            DEC      4,B6

      834    17015   10                                               CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_LDDAT),
             17015                                                        GJA_LDDAT);

  17015   3 00090C  EBF0 000A                            LAB,B6   10,IMO
          3 00090E  DB80 0000 0000  xsym                 LAB,B5   GJA_LDDAT
          3 000911  DFC7 0046                            STB,B5   NMAVAIL+5,AUTO
          3 000913  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 000915  CBC7 0026                            LAB,B4   CTX$,AUTO
          3 000917  CFC7 0042                            STB,B4   NMAVAIL+1,AUTO
          3 000919  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 00091B  CBF0 0300                            LAB,B4   768,IMO
          3 00091D  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000920       0001                            DC       s:17016,PREL

      835    17016   10                                               EXIT;

  17016   3 000921  0F81 0001                            B        s:17018,PREL

      836    17017   10                                               END; /* MAXNMBRCR>0*/
      837    17018    9                                         IF SVMSG$->SV$MSG.SZ > GJA$HAND_CTX.MAXNMBBYT
             17018                                                   OR

  17018   3 000923  ECC7 0028                            LDB,B6   SVMSG$,AUTO
          3 000925  DCC7 0026                            LDB,B5   CTX$,AUTO
          3 000927  E846 0003                            LDR,R6   3,B6
          3 000929  E945 0005                            CMR,R6   5,B5
          3 00092B  0301 0060                            BG       s:17040,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:123  
          3 00092D  E945 0003                            CMR,R6   3,B5
          3 00092F  0301 005C                            BG       s:17040,PREL
          3 000931  D845 0004                            LDR,R5   4,B5
          3 000933  5901 0058                            BEZ,R5   s:17040,PREL

      838    17019    9                                            SVMSG$->SV$MSG.SZ > GJA$HAND_CTX.
             17019                                                     MAXRCRBYTSIZ OR
      839    17020    9                                            GJA$HAND_CTX.MAXNMBRCR = 0 THEN
      840    17021    9                                               EXIT;
      841    17022
      842    17023    9                                          SIZE = SVMSG$->SV$MSG.SZ;

  17023   3 000935  EF47 0032                            STR,R6   SIZE,AUTO

      843    17024    9                                          IF SVMSG$->SV$MSG.VFC ~= BINASC(0)

  17024   3 000937  D0C6 0004                            LDH,R5   4,B6
          3 000939  5D00                                 CMV,R5   0
          3 00093A  0901 000B                            BE       s:17029,PREL

      844    17025   10                                          THEN DO;

      845    17026   10                                               GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %
             17026                                                        KV_DATCTRCHRTYP_VFC;

  17026   3 00093C  C870 0800                            LDR,R4   2048,IMO
          3 00093E  CA80 0000 0001  xsym                 SRM,R4,'0C00'X    GJA_VDO_DAT_DAT2+1
          3 000941       0C00

      846    17027   10                                               GJA_VDO_DAT_DAT2.DATCTRCHR = SVMSG$->
             17027                                                        SV$MSG.VFC;

  17027   3 000942  DA80 0000 0001  xsym                 SRM,R5,'00FF'X    GJA_VDO_DAT_DAT2+1
  17027   3 000945       00FF

      847    17028   10                                               END;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:124  
      848    17029    9                                          SVMSG$=PINCRW(SVMSG$,SIZEW(SV$MSG));

  17029   3 000946  CBC6 0005                            LAB,B4   5,B6
          3 000948  CFC7 0028                            STB,B4   SVMSG$,AUTO

      849    17030    9                                          CALL GJA$WRITE(CTX$,SIZE,SVMSG$->STRING);

  17030   3 00094A  CFC7 0046                            STB,B4   NMAVAIL+5,AUTO
          3 00094C  EBC7 0032                            LAB,B6   SIZE,AUTO
          3 00094E  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 000950  BBC7 0026                            LAB,B3   CTX$,AUTO
          3 000952  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 000954  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000956  CBF0 0300                            LAB,B4   768,IMO
          3 000958  E380 0000 0000  xent                 LNJ,B6   GJA$WRITE
          3 00095B       0001                            DC       s:17031,PREL

      850    17031    9                                          GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %
             17031                                                   KV_DATCTRCHRTYP_NON;

  17031   3 00095C  8800 0000 0001  xsym                 LBF,'0C00'X       GJA_VDO_DAT_DAT2+1
  17031   3 00095F       0C00

      851    17032    9                                          GJA$HAND_CTX.MAXNMBRCR = GJA$HAND_CTX.
             17032                                                   MAXNMBRCR - 1;

  17032   3 000960  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000962  88C6 0004                            DEC      4,B6

      852    17033    9                                          GJA$HAND_CTX.MAXNMBBYT = GJA$HAND_CTX.
             17033                                                   MAXNMBBYT - SIZE;

  17033   3 000964  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000966  E846 0005                            LDR,R6   5,B6
          3 000968  E247 0032                            SUB,R6   SIZE,AUTO
          3 00096A  EF46 0005                            STR,R6   5,B6

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:125  
      853    17034    9                                          SVMSG$ = GJA$HAND_CTX.WAITING_MSG$;

  17034   3 00096C  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 00096E  DCC6 0007                            LDB,B5   7,B6
          3 000970  DFC7 0028                            STB,B5   SVMSG$,AUTO

      854    17035    9                                          MSGWTSIZE = MSGWTSIZE + SVMSG$->SV$MSG.SZ;

  17035   3 000972  E847 003C                            LDR,R6   MSGWTSIZE,AUTO
          3 000974  EA45 0003                            ADD,R6   3,B5
          3 000976  EF47 003C                            STR,R6   MSGWTSIZE,AUTO

      855    17036    9                                          GJA$HAND_CTX.WAITING_MSG$ = GJA$HAND_CTX.
             17036                                                   WAITING_MSG$->SV$MSG.LNK$;

  17036   3 000978  CCC6 0007                            LDB,B4   7,B6
          3 00097A  BCC4 0001                            LDB,B3   1,B4
          3 00097C  BFC6 0007                            STB,B3   7,B6

      856    17037    9                                          CALL KVB$RLSSYS(SVMSG$->SV$MSG);

  17037   3 00097E  BBC7 0028                            LAB,B3   SVMSG$,AUTO
          3 000980  CBF0 0100                            LAB,B4   256,IMO
          3 000982  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          3 000985       0001                            DC       s:17038,PREL

      857    17038    9                                          END;

  17038   3 000986  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000988  8DC6 0007                            CMN      7,B6
          3 00098A  0981 FF6F                            BNE      s:17010,PREL

      858    17039    8                                     END;

      859    17040    7                                IF CTX$ = GJA_UID_NM$ AND MSGWTSIZE > 0

  17040   3 00098C  ECC7 0026                            LDB,B6   CTX$,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:126  
          3 00098E  ED80 0000 0000  xsym                 CMB,B6   GJA_UID_NM
          3 000991  0981 0236                            BNE      s:17186,PREL
          3 000993  E847 003C                            LDR,R6   MSGWTSIZE,AUTO
          3 000995  6901 0232                            BEZ,R6   s:17186,PREL

      860    17041    8                                THEN DO;

      861    17042    8                                     MSGWTSIZE = 0;

  17042   3 000997  8747 003C                            CL       MSGWTSIZE,AUTO

      862    17043        /*
      863    17044                how many bytes are left to send?
      864    17045        */
      865    17046    8                                     IF CTX$->GJA$HAND_CTX.WAITING_MSG$ ~= ADDR(NIL)

  17046   3 000999  8DC6 0007                            CMN      7,B6
          3 00099B  0901 001A                            BE       s:17055,PREL

      866    17047    9                                     THEN DO;

      867    17048    9                                         MSGWTSIZE = CTX$->GJA$HAND_CTX.WAITING_MSG$->
             17048                                                   SV$MSG.SZ;

  17048   3 00099D  DCC6 0007                            LDB,B5   7,B6
          3 00099F  E845 0003                            LDR,R6   3,B5
          3 0009A1  EF47 003C                            STR,R6   MSGWTSIZE,AUTO

      868    17049    9                                          SVMSG$ = CTX$->GJA$HAND_CTX.WAITING_MSG$;

  17049   3 0009A3  DFC7 0028                            STB,B5   SVMSG$,AUTO

      869    17050   10                                          DO WHILE (SVMSG$->SV$MSG.LNK$ ~= ADDR(NIL));

  17050   3 0009A5  0F81 000D                            B        s:17053,PREL

      870    17051   10                                               SVMSG$ = SVMSG$->SV$MSG.LNK$;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:127  

  17051   3 0009A7  ECC7 0028                            LDB,B6   SVMSG$,AUTO
          3 0009A9  DCC6 0001                            LDB,B5   1,B6
          3 0009AB  DFC7 0028                            STB,B5   SVMSG$,AUTO

      871    17052   10                                               MSGWTSIZE = MSGWTSIZE + SVMSG$->SV$MSG.
             17052                                                        SZ;

  17052   3 0009AD  E847 003C                            LDR,R6   MSGWTSIZE,AUTO
          3 0009AF  EA45 0003                            ADD,R6   3,B5
          3 0009B1  EF47 003C                            STR,R6   MSGWTSIZE,AUTO

      872    17053   10                                               END; /* svmsg.lnk$ ~= addr(nil)*/

  17053   3 0009B3  8DC5 0001                            CMN      1,B5
          3 0009B5  09F2                                 BNE      s:17051,SPREL

      873    17054    9                                          END; /* msg$ ~= addr(nil)    */

      874    17055    8                                     KV@VDO_RQSDAT = KV_VDO_RQSDAT;

  17055   3 0009B6  AB80 0000 0000  01                   LAB,B2   PRIVS
          3 0009B9  2C06                                 LDV,R2   6
          3 0009BA  6C0A                                 LDV,R6   10
          3 0009BB  BB87                                 LAB,B3   ,AUTO
          3 0009BC  3C6C                                 LDV,R3   108
          3 0009BD  0008                                 MMM

      875    17056    8                                     SVCTX$ = CTX$;

  17056   3 0009BE  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 0009C0  EFC7 003D                            STB,B6   SVCTX$,AUTO

      876    17057    8                                     CTX$ = GJA_HAND_HEAD$;

  17057   3 0009C2  DC80 0000 0000  xsym                 LDB,B5   GJA_HAND_HEAD$
          3 0009C5  DFC7 0026                            STB,B5   CTX$,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:128  

      877    17058    9                                     DO WHILE ( CTX$ ~= ADDR(NIL) );

  17058   3 0009C7  0F81 0026                            B        s:17065,PREL

      878    17059   10                                          IF GJA$HAND_CTX.BLK = '1'B THEN DO;

  17059   3 0009C9  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 0009CB  82C6 000D                            LB,'1000'X        13,B6
          3 0009CD       1000
          3 0009CE  0581 0019                            BBF      s:17064,PREL

      879    17060   10                                               GJA$HAND_CTX.BLK = '0'B;

  17060   3 0009D0  8846 000D                            LBF,'1000'X       13,B6
  17060   3 0009D2       1000

      880    17061   10                                               CALL GJA$Q_MSG(CTX$,LENGTHC(
             17061                                                        KV_VDO_RQSDAT),

  17061   3 0009D3  EBF0 000A                            LAB,B6   10,IMO
          3 0009D5  DB80 0000 0003  01                   LAB,B5   KV_VDO_RQSDAT
          3 0009D8  DFC7 0046                            STB,B5   NMAVAIL+5,AUTO
          3 0009DA  EFC7 0044                            STB,B6   NMAVAIL+3,AUTO
          3 0009DC  CBC7 0026                            LAB,B4   CTX$,AUTO
          3 0009DE  CFC7 0042                            STB,B4   NMAVAIL+1,AUTO
          3 0009E0  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 0009E2  CBF0 0300                            LAB,B4   768,IMO
          3 0009E4  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 0009E7       0001                            DC       s:17064,PREL

      881    17062   10                                                 KV_VDO_RQSDAT);
      882    17063   10                                               END; /* hand.blk = 1    */

      883    17064    9                                          CTX$ = GJA$HAND_CTX.LNK$;

  17064   3 0009E8  ECC7 0026                            LDB,B6   CTX$,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:129  
          3 0009EA  DCC6 0001                            LDB,B5   1,B6
          3 0009EC  DFC7 0026                            STB,B5   CTX$,AUTO

      884    17065    9                                          END; /* ctx~= addr(nil)*/

  17065   3 0009EE  8DC7 0026                            CMN      CTX$,AUTO
          3 0009F0  09D9                                 BNE      s:17059,SPREL

      885    17066    8                                     CTX$ = SVCTX$;

  17066   3 0009F1  ECC7 003D                            LDB,B6   SVCTX$,AUTO
          3 0009F3  EFC7 0026                            STB,B6   CTX$,AUTO

      886    17067    8                                     END; /* ctx$ = uid_nm$ and unflow > 0 */

  17067   3 0009F5  0F81 01D2                            B        s:17186,PREL

      887    17068        /*
      888    17069          FNC = Request STT
      889    17070         */
      890    17071    7                              CASE(%KV_VDO_FNC_RQSSTT);

      891    17072
      892    17073
      893    17074    7                                NMAVAIL = '0'B;

  17074   3 0009F7  8747 0041                            CL       NMAVAIL,AUTO

      894    17075    7                                CHARPOS = 0;

  17075   3 0009F9  8747 0040                            CL       CHARPOS,AUTO

      895    17076    7                                SUBSTR(GJA_VDO_STT.STATE,0,9) = 'Host(s): ';

  17076   3 0009FB  AB80 0000 0000  01                   LAB,B2   PRIVS
          3 0009FE  2C3A                                 LDV,R2   58
          3 0009FF  6C09                                 LDV,R6   9
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:130  
          3 000A00  BB80 0000 0000  xsym                 LAB,B3   GJA_VDO_STT
          3 000A03  3C04                                 LDV,R3   4
          3 000A04  0008                                 MMM

      896    17077    7                                CHARPOS = 9;

  17077   3 000A05  6C09                                 LDV,R6   9
          3 000A06  EF47 0040                            STR,R6   CHARPOS,AUTO

      897    17078    7                                CTX$ = GJA_NM_HEAD$;

  17078   3 000A08  EC80 0000 0000  xsym                 LDB,B6   GJA_NM_HEAD$
          3 000A0B  EFC7 0026                            STB,B6   CTX$,AUTO

      898    17079    8   FNDNM:                       DO WHILE CTX$ ~= ADDR(NIL);

  17079   3 000A0D  0F81 0058            FNDNM           B        s:17097,PREL

      899    17080    8                                     IF CTX$->GJA$HAND_CTX.HOST_NODE AND

  17080   3 000A0F  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000A11  82C6 000D                            LB,'2000'X        13,B6
          3 000A13       2000
          3 000A14  0581 004B                            BBF      s:17096,PREL
          3 000A16  8286                                 LB,'1FFF'X        ,B6
          3 000A17       1FFF
          3 000A18  0581 0047                            BBF      s:17096,PREL

      900    17081    9                                       CTX$->GJA$HAND_CTX.LDCTX ~= 0 THEN DO;

      901    17082    9                                          NMAVAIL = '1'B;

  17082   3 000A1A  8947 0041                            LBT,'8000'X       NMAVAIL,AUTO
  17082   3 000A1C       8000

      902    17083    9                                          IF CTX$->GJA$HAND_CTX.NAME ~= ' '

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:131  
  17083   3 000A1D  DB80 0000 0000  04                   LAB,B5   0
          3 000A20  0022                                 ACM      ;
          3 000A21       4806 0009                                ALPHANUM(9,B6,,8,FILL),;
          3 000A23       4105 0004                                ALPHANUM(4,B5,,1,FILL)
          3 000A25  5381 003A                            CBE      s:17096,PREL
          3 000A27  DB80 0000 0000  01                   LAB,B5   PRIVS
          3 000A2A  0022                                 ACM      ;
          3 000A2B       4806 0009                                ALPHANUM(9,B6,,8,FILL),;
          3 000A2D       4605 0011                                ALPHANUM(17,B5,,6,FILL)
          3 000A2F  5381 0030                            CBE      s:17096,PREL

      903    17084   10                                            AND CTX$->GJA$HAND_CTX.NAME ~= 'NETMAN'
             17084                                                     THEN DO;

      904    17085   10                                               STRLEN = 8;

  17085   3 000A31  6C08                                 LDV,R6   8
          3 000A32  EF47 003F                            STR,R6   STRLEN,AUTO

      905    17086   11                                              DO WHILE (SUBSTR(CTX$->GJA$HAND_CTX.NAME
             17086                                                        ,STRLEN-1,1) = ' '

  17086   3 000A34  0F81 0003                            B        s:17089,PREL

      906    17087   11                                                 AND STRLEN > 0);
      907    17088   11                                                    STRLEN = STRLEN - 1;

  17088   3 000A36  88C7 003F                            DEC      STRLEN,AUTO

      908    17089   11                                                    END;

  17089   3 000A38  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000A3A  B847 003F                            LDR,R3   STRLEN,AUTO
          3 000A3C  3E11                                 ADV,R3   17
          3 000A3D  E0B6                                 LDH,R6   ,B6,R3
          3 000A3E  6D20                                 CMV,R6   32
          3 000A3F  0981 0004                            BNE      s:17090,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:132  
          3 000A41  D847 003F                            LDR,R5   STRLEN,AUTO
          3 000A43  59F3                                 BNEZ,R5  s:17088,SPREL

      909    17090   10                                              SUBSTR(GJA_VDO_STT.STATE,CHARPOS,STRLEN)
             17090                                                        = CTX$->GJA$HAND_CTX.NAME;

  17090   3 000A44  DB80 0000 0000  xsym                 LAB,B5   GJA_VDO_STT
          3 000A47  A847 0040                            LDR,R2   CHARPOS,AUTO
          3 000A49  D847 003F                            LDR,R5   STRLEN,AUTO
          3 000A4B  DA70 2000                            ADD,R5   8192,IMO
          3 000A4D  0021                                 ALR      ;
          3 000A4E       4806 0009                                ALPHANUM(9,B6,,8),;
          3 000A50       4025 0002                                ALPHANUM(2,B5,R2,,R5,FILL)

      910    17091   10                                               CHARPOS = STRLEN + CHARPOS;

  17091   3 000A52  437F                                 CSYNC    s:17090+13,SPREL
          3 000A53  E847 003F                            LDR,R6   STRLEN,AUTO
          3 000A55  EA47 0040                            ADD,R6   CHARPOS,AUTO
          3 000A57  EF47 0040                            STR,R6   CHARPOS,AUTO

      911    17092   10                                               SUBSTR(GJA_VDO_STT.STATE,CHARPOS,1) =
             17092                                                        ',';

  17092   3 000A59  5C2C                                 LDV,R5   44
          3 000A5A  B856                                 LDR,R3   R6
          3 000A5B  D7B0 0000 0002  xsym                 STH,R5   GJA_VDO_STT+2,R3

      912    17093   10                                               CHARPOS = CHARPOS + 1;

  17093   3 000A5E  8AC7 0040                            INC      CHARPOS,AUTO

      913    17094   10                                               END;

      914    17095    9                                          END;

      915    17096    8                                     CTX$ = CTX$->GJA$HAND_CTX.LNK$;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:133  

  17096   3 000A60  ECC7 0026                            LDB,B6   CTX$,AUTO
          3 000A62  DCC6 0001                            LDB,B5   1,B6
          3 000A64  DFC7 0026                            STB,B5   CTX$,AUTO

      916    17097    8                                     END;

  17097   3 000A66  8DC7 0026                            CMN      CTX$,AUTO
          3 000A68  0981 FFA6                            BNE      s:17080,PREL

      917    17098    7                                IF NOT NMAVAIL /* No hosts             */

  17098   3 000A6A  89C7 0041                            CMZ      NMAVAIL,AUTO
          3 000A6C  0801 0016                            BAL      s:17104,PREL

      918    17099    8                                THEN DO;

      919    17100    8                                     GJA_VDO_STT.STATE = 'No Host';

  17100   3 000A6E  EB80 0000 0000  01                   LAB,B6   PRIVS
          3 000A71  DB80 0000 0000  xsym                 LAB,B5   GJA_VDO_STT
          3 000A74  D870 20FF                            LDR,R5   8447,IMO
          3 000A76  0021                                 ALR      ;
          3 000A77       4706 0022                                ALPHANUM(34,B6,,7),;
          3 000A79       4005 0002                                ALPHANUM(2,B5,,R5,FILL)

      920    17101    8                                     GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC('No Host');

  17101   3 000A7B  6C07                                 LDV,R6   7
          3 000A7C  EA80 0000 0001  xsym                 SRM,R6,'00FF'X    GJA_VDO_STT+1
          3 000A7F       00FF

      921    17102    8                                     END;

  17102   3 000A80  437F                                 CSYNC    s:17101+4,SPREL
          3 000A81  0F81 005B                            B        s:17128,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:134  
      922    17103    7                                ELSE
      923    17104    7                                     IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.NMRSP

  17104   3 000A83  ECC7 0020                            LDB,B6   MSG$,AUTO
          3 000A85  DCC6 0002                            LDB,B5   2,B6
          3 000A87  82C5 0018                            LB,'2000'X        24,B5
          3 000A89       2000
          3 000A8A  0581 0016                            BBF      s:17110,PREL

      924    17105    8                                     THEN DO;

      925    17106    8                                          GJA_VDO_STT.STATE = 'Connecting';

  17106   3 000A8C  CB80 0000 0000  01                   LAB,B4   PRIVS
          3 000A8F  BB80 0000 0000  xsym                 LAB,B3   GJA_VDO_STT
          3 000A92  D870 20FF                            LDR,R5   8447,IMO
          3 000A94  0021                                 ALR      ;
          3 000A95       4A04 0026                                ALPHANUM(38,B4,,10),;
          3 000A97       4003 0002                                ALPHANUM(2,B3,,R5,FILL)

      926    17107    8                                          GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC(
             17107                                                   'Connecting');

  17107   3 000A99  6C0A                                 LDV,R6   10
          3 000A9A  EA80 0000 0001  xsym                 SRM,R6,'00FF'X    GJA_VDO_STT+1
          3 000A9D       00FF

      927    17108    8                                          END;

  17108   3 000A9E  437F                                 CSYNC    s:17107+4,SPREL
          3 000A9F  0F81 003D                            B        s:17128,PREL

      928    17109    7                                     ELSE
      929    17110    7                                          IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.WTPRO

  17110   3 000AA1  82C5 0018                            LB,'0200'X        24,B5
  17110   3 000AA3       0200
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:135  
          3 000AA4  0581 0016                            BBF      s:17120,PREL

      930    17111    8                                          THEN DO;

      931    17112    8                                               GJA_VDO_STT.STATE ='Profile';

  17112   3 000AA6  CB80 0000 0000  01                   LAB,B4   PRIVS
          3 000AA9  BB80 0000 0000  xsym                 LAB,B3   GJA_VDO_STT
          3 000AAC  D870 20FF                            LDR,R5   8447,IMO
          3 000AAE  0021                                 ALR      ;
          3 000AAF       4704 002B                                ALPHANUM(43,B4,,7),;
          3 000AB1       4003 0002                                ALPHANUM(2,B3,,R5,FILL)

      932    17113    8                                               GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC(
             17113                                                        'Profile');

  17113   3 000AB3  6C07                                 LDV,R6   7
          3 000AB4  EA80 0000 0001  xsym                 SRM,R6,'00FF'X    GJA_VDO_STT+1
          3 000AB7       00FF

      933    17114    8                                               END;

  17114   3 000AB8  437F                                 CSYNC    s:17113+4,SPREL
          3 000AB9  0F81 0023                            B        s:17128,PREL

      934    17115    8                                          ELSE DO;

      935    17116        /*
      936    17117                if the .8000 bit has been reset via the attr field in netcon then
      937    17118                use the old display
      938    17119        */
      939    17120    9                                               IF (BINBIT(GJA_ATTR,16) & '8000'X) =
             17120                                                        '0'B THEN DO;

  17120   3 000ABB  E800 0000 0000  xsym                 LDR,R6   GJA_ATTR
          3 000ABE  E570 8000                            AND,R6   -32768,IMO
          3 000AC0  6981 000A                            BNEZ,R6  s:17124,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:136  

      940    17121    9                                                   GJA_VDO_STT.DAT1.BYTSIZ = CHARPOS -
             17121                                                             1;

  17121   3 000AC2  E847 0040                            LDR,R6   CHARPOS,AUTO
          3 000AC4  6EFF                                 ADV,R6   -1
          3 000AC5  EA80 0000 0001  xsym                 SRM,R6,'00FF'X    GJA_VDO_STT+1
          3 000AC8       00FF

      941    17122    9                                                    END;

  17122   3 000AC9  0F81 0013                            B        s:17128,PREL

      942    17123    9                                               ELSE DO;

      943    17124    9                                                    GJA_VDO_STT.STATE = 'Logging on';

  17124   3 000ACB  CB80 0000 0000  01                   LAB,B4   PRIVS
          3 000ACE  BB80 0000 0000  xsym                 LAB,B3   GJA_VDO_STT
          3 000AD1  D870 20FF                            LDR,R5   8447,IMO
          3 000AD3  0021                                 ALR      ;
          3 000AD4       4A04 002F                                ALPHANUM(47,B4,,10),;
          3 000AD6       4003 0002                                ALPHANUM(2,B3,,R5,FILL)

      944    17125    9                                                    GJA_VDO_STT.DAT1.BYTSIZ = LENGTHC(
             17125                                                             'Logging on');

  17125   3 000AD8  6C0A                                 LDV,R6   10
          3 000AD9  EA80 0000 0001  xsym                 SRM,R6,'00FF'X    GJA_VDO_STT+1
          3 000ADC       00FF

      945    17126    9                                                    END;

      946    17127    8                                               END;

      947    17128    7                               SIZE = LENGTHC(GJA_VDO_STT) - LENGTHC(GJA_VDO_STT.STATE
             17128                                         )
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:137  

  17128   3 000ADD  E800 0000 0001  xsym                 LDR,R6   GJA_VDO_STT+1
          3 000AE0  E570 00FF                            AND,R6   255,IMO
          3 000AE2  6E04                                 ADV,R6   4
          3 000AE3  437F                                 CSYNC    s:17128+5,SPREL
          3 000AE4  EF47 0032                            STR,R6   SIZE,AUTO

      948    17129    7                                  + GJA_VDO_STT.DAT1.BYTSIZ;
      949    17130    7                                CALL GJA$Q_MSG(KNH$MESS.UID$,SIZE,GJA_VDO_STT);

  17130   3 000AE6  EB80 0000 0000  xsym                 LAB,B6   GJA_VDO_STT
          3 000AE9  EFC7 0046                            STB,B6   NMAVAIL+5,AUTO
          3 000AEB  DBC7 0032                            LAB,B5   SIZE,AUTO
          3 000AED  DFC7 0044                            STB,B5   NMAVAIL+3,AUTO
          3 000AEF  CCC7 0020                            LDB,B4   MSG$,AUTO
          3 000AF1  BBC4 0002                            LAB,B3   2,B4
          3 000AF3  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 000AF5  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000AF7  CBF0 0300                            LAB,B4   768,IMO
          3 000AF9  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000AFC       0001                            DC       s:17130+23,PREL
          3 000AFD  0F81 00CA                            B        s:17186,PREL

      950    17131        /*
      951    17132          FNC = Data
      952    17133        */
      953    17134    7                              CASE(%KV_VDO_FNC_DAT);

      954    17135    7                                IF WHO = %GJA_UID_NM OR WHO = %GJA_UID_HANDLER

  17135   3 000AFF  E847 001D                            LDR,R6   WHO,AUTO
          3 000B01  6D01                                 CMV,R6   1
          3 000B02  0901 0007                            BE       s:17137,PREL
          3 000B04  6D03                                 CMV,R6   3
          3 000B05  0901 0004                            BE       s:17137,PREL
          3 000B07  6D02                                 CMV,R6   2
          3 000B08  0981 0013                            BNE      s:17139,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:138  

      955    17136    7                                  OR WHO = %GJA_UID_BABOON
      956    17137    7                                THEN CALL GJA$DECODE_APL_MSG(GJA$PARAMS,CTX$) ALTRET(
             17137                                         GETOUT);

  17137   3 000B0A  DBC7 0026                            LAB,B5   CTX$,AUTO
          3 000B0C  DFC7 0044                            STB,B5   NMAVAIL+3,AUTO
          3 000B0E  CBC7 0005                            LAB,B4   GJA$PARAMS,AUTO
          3 000B10  CFC7 0042                            STB,B4   NMAVAIL+1,AUTO
          3 000B12  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000B14  CBF0 0200                            LAB,B4   512,IMO
          3 000B16  E380 0000 0000  xent                 LNJ,B6   GJA$DECODE_APL_MSG
          3 000B19       00E8                            DC       s:17203,PREL
          3 000B1A  0F81 00AD                            B        s:17186,PREL

      957    17138
      958    17139    7                                ELSE IF WHO = %GJA_UID_LOGON

  17139   3 000B1C  6D04                                 CMV,R6   4
          3 000B1D  0981 00AA                            BNE      s:17186,PREL

      959    17140    8                                     THEN DO;

      960    17141    8                                          IF NOT(KNH$MESS.UID$->GJA$LGNCTX.STATUS.
             17141                                                   LGNRSP)

  17141   3 000B1F  DCC7 0020                            LDB,B5   MSG$,AUTO
          3 000B21  CCC5 0002                            LDB,B4   2,B5
          3 000B23  82C4 0018                            LB,'4000'X        24,B4
          3 000B25       4000
          3 000B26  0501 0007                            BBT      s:17144,PREL

      961    17142    8                                          THEN CALL M$XXX;

  17142   3 000B28  B870 0082                            LDR,R3   130,IMO
          3 000B2A  0001                                 MCL
          3 000B2B       0000                            DC       s:17142+3,PREL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:139  
          3 000B2C  0F81 009B                            B        s:17186,PREL

      962    17143    9                                          ELSE DO;

      963    17144   10                                               IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.
             17144                                                        RDPND = '0'B THEN DO;

  17144   3 000B2E  82C4 0018                            LB,'0080'X        24,B4
  17144   3 000B30       0080
          3 000B31  0501 0038                            BBT      s:17153,PREL

      964    17145   10                                                    GJA_SYSLOG.FCN = IGA_SYSLOG;

  17145   3 000B33  5C27                                 LDV,R5   39
          3 000B34  D780 0000 0000  xsym                 STH,R5   GJA_SYSLOG

      965    17146   10                                                    GJA_SYSLOG.ERRLOG.ERRCODE.ERR# = %
             17146                                                             E$READ_ERR;

  17146   3 000B37  C870 27A8                            LDR,R4   10152,IMO
          3 000B39  CA80 0000 0003  xsym                 SRM,R4,'FFF8'X    GJA_SYSLOG+3
          3 000B3C       FFF8

      966    17147   10                                                   CALL KHC$UTS(GJA_SYSLOG.ERRLOG.UTS)
             17147                                                             ;

  17147   3 000B3D  BB80 0000 0005  04                   LAB,B3   +5
          3 000B40  CBF0 0100                            LAB,B4   256,IMO
          3 000B42  E380 0000 0000  xent                 LNJ,B6   KHC$UTS
          3 000B45       0001                            DC       s:17148,PREL

      967    17148   10                                                   GJA_SYSLOG.ERRLOG.TERMID = KNH$MESS
             17148                                                             .UID$->GJA$LGNCTX.TERMINAL_ID;

  17148   3 000B46  ECC7 0020                            LDB,B6   MSG$,AUTO
          3 000B48  DCC6 0002                            LDB,B5   2,B6
          3 000B4A  AB85                                 LAB,B2   ,B5
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:140  
          3 000B4B  2C1E                                 LDV,R2   30
          3 000B4C  6C10                                 LDV,R6   16
          3 000B4D  BB80 0000 0000  xsym                 LAB,B3   GJA_SYSLOG
          3 000B50  3C0C                                 LDV,R3   12
          3 000B51  0008                                 MMM

      968    17149   10                                                   ADDR(GJA_SYSLOG.ERRLOG.VALUES(0))->
             17149                                                             B$PTR$ = APP$;

  17149   3 000B52  ECC7 0022                            LDB,B6   APP$,AUTO
          3 000B54  EF80 0000 000E  xsym                 STB,B6   GJA_SYSLOG+14

      969    17150   10                                                   CALL GJA$NETWORK_MANAGER(GJA_SYSLOG
             17150                                                             ,SIZEC(GJA_SYSLOG)-SIZEC(
             17150                                                             GJA_SYSLOG.ERRLOG.DATA));

  17150   3 000B57  CBF0 0026                            LAB,B4   38,IMO
          3 000B59  CFC7 0044                            STB,B4   NMAVAIL+3,AUTO
          3 000B5B  BB80 0000 0000  xsym                 LAB,B3   GJA_SYSLOG
          3 000B5E  BFC7 0042                            STB,B3   NMAVAIL+1,AUTO
          3 000B60  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000B62  CBF0 0200                            LAB,B4   512,IMO
          3 000B64  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          3 000B67       0001                            DC       s:17151,PREL

      970    17151   10                                                    END;

  17151   3 000B68  0F81 005F                            B        s:17186,PREL

      971    17152   10                                               ELSE DO;

      972    17153   10                                                   KNH$MESS.UID$->GJA$LGNCTX.MSG$=APP$
             17153                                                             ;

  17153   3 000B6A  BCC7 0022                            LDB,B3   APP$,AUTO
          3 000B6C  BFC4 000C                            STB,B3   12,B4

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:141  
      973    17154   10                                                    CALL GJA$SOLICIT_NM(KNH$MESS.UID$,
             17154                                                             GJA$PARAMS.DATSIZE);

  17154   3 000B6E  CBC7 000D                            LAB,B4   GJA$PARAMS+8,AUTO
          3 000B70  CFC7 0044                            STB,B4   NMAVAIL+3,AUTO
          3 000B72  ABC5 0002                            LAB,B2   2,B5
          3 000B74  AFC7 0042                            STB,B2   NMAVAIL+1,AUTO
          3 000B76  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000B78  CBF0 0200                            LAB,B4   512,IMO
          3 000B7A  E380 0000 0000  xent                 LNJ,B6   GJA$SOLICIT_NM
          3 000B7D       0001                            DC       s:17157,PREL

      974    17155   10                                                    END;

      975    17156    9                                               END;

      976    17157    8                                          END;

  17157   3 000B7E  0F81 0049                            B        s:17186,PREL

      977    17158
      978    17159
      979    17160
      980    17161    7                              CASE (%KV_VDO_FNC_DSC_RQS);

      981    17162    7                                IF WHO ~= %GJA_UID_LOGON

  17162   3 000B80  E847 001D                            LDR,R6   WHO,AUTO
          3 000B82  6D04                                 CMV,R6   4
          3 000B83  0901 0005                            BE       s:17167,PREL

      982    17163    7                                THEN CALL M$XXX;

  17163   3 000B85  B870 0082                            LDR,R3   130,IMO
          3 000B87  0001                                 MCL
          3 000B88       0000                            DC       s:17163+3,PREL

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:142  
      983    17164
      984    17165        /* If we are waiting a response from the NETWORK MANAGER then
      985    17166           just set the TERM status in the CTX. */
      986    17167    7                                IF KNH$MESS.UID$->GJA$LGNCTX.STATUS.NMRSP

  17167   3 000B89  ECC7 0020                            LDB,B6   MSG$,AUTO
          3 000B8B  DCC6 0002                            LDB,B5   2,B6
          3 000B8D  82C5 0018                            LB,'2000'X        24,B5
          3 000B8F       2000
          3 000B90  0501 0006                            BBT      s:17170,PREL
          3 000B92  82C5 0018                            LB,'0200'X        24,B5
          3 000B94       0200
          3 000B95  0581 0006                            BBF      s:17172,PREL

      987    17168    7                                  OR KNH$MESS.UID$->GJA$LGNCTX.STATUS.WTPRO
      988    17169    7                                THEN
      989    17170    7                                     KNH$MESS.UID$->GJA$LGNCTX.STATUS.DSCRCV = '1'B;

  17170   3 000B97  8945 0018                            LBT,'0100'X       24,B5
  17170   3 000B99       0100
          3 000B9A  0F81 002D                            B        s:17186,PREL

      990    17171    8                                ELSE DO;

      991    17172    8                                     CALL GJA$Q_MSG(KNH$MESS.UID$,,,SIZEC(GJA_TERM),
             17172                                              GJA_TERM,%KN_FCN_TERM);

  17172   3 000B9C  CBF0 0008                            LAB,B4   8,IMO
          3 000B9E  BBF0 0003                            LAB,B3   3,IMO
          3 000BA0  BFC7 004C                            STB,B3   NMAVAIL+11,AUTO
          3 000BA2  DB80 0000 0000  xsym                 LAB,B5   GJA_TERM
          3 000BA5  DFC7 004A                            STB,B5   NMAVAIL+9,AUTO
          3 000BA7  CFC7 0048                            STB,B4   NMAVAIL+7,AUTO
          3 000BA9  AB80 0000 0000                       LAB,B2   0
          3 000BAC  AFC7 0046                            STB,B2   NMAVAIL+5,AUTO
          3 000BAE  9B80 0000 0000                       LAB,B1   0
          3 000BB1  9FC7 0044                            STB,B1   NMAVAIL+3,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:143  
          3 000BB3  DBC6 0002                            LAB,B5   2,B6
          3 000BB5  DFC7 0042                            STB,B5   NMAVAIL+1,AUTO
          3 000BB7  BBC7 0042                            LAB,B3   NMAVAIL+1,AUTO
          3 000BB9  CBF0 0600                            LAB,B4   1536,IMO
          3 000BBB  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          3 000BBE       0001                            DC       s:17173,PREL

      992    17173    8                                     KNH$MESS.UID$->GJA$LGNCTX.STATUS.TERMACK = '1'B;

  17173   3 000BBF  ECC7 0020                            LDB,B6   MSG$,AUTO
          3 000BC1  DCC6 0002                            LDB,B5   2,B6
          3 000BC3  8945 0018                            LBT,'1000'X       24,B5
          3 000BC5       1000

      993    17174    8                                     END;

  17174   3 000BC6  0F81 0001                            B        s:17186,PREL

      994    17175
      995    17176
      996    17177
      997    17178
      998    17179    7                              CASE(ELSE);

      999    17180                     /*N* Should screech here but half to wait until we handler all FNCs */
     1000    17181
     1001    17182    7                                END;       /* VDO CASE                 */

     1002    17183
     1003    17184
     1004    17185
     1005    17186    6                             IF POFFW(VLP$,MSG$) >= MSGSIZ

  17186   3 000BC8  8CC7 002A                            LDI      VLP$,AUTO
          3 000BCA  84C7 0020                            SID      MSG$,AUTO
          3 000BCC  8D47 0042                            SDI      NMAVAIL+1,AUTO
          3 000BCE  F847 002E                            LDR,R7   MSGSIZ,AUTO
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:144  
          3 000BD0  6C00                                 LDV,R6   0
          3 000BD1  84C7 0042                            SID      NMAVAIL+1,AUTO
          3 000BD3  6801 000B                            BLZ,R6   s:17190,PREL
          3 000BD5  6A01 0003                            BGZ,R6   s:17188,PREL
          3 000BD7  7901 0007                            BEZ,R7   s:17190,PREL

     1006    17187    6                             THEN EXIT VDOLOOP;
     1007    17188    6                             ELSE VDO$=VLP$;

  17188   3 000BD9  ECC7 002A                            LDB,B6   VLP$,AUTO
          3 000BDB  EFC7 002C                            STB,B6   VDO$,AUTO

     1008    17189    6                             END;          /* VDO LOOP                 */

  17189   3 000BDD  0F81 FB3E                            B        s:16883,PREL

     1009    17190    5                        END;

  17190   3 000BDF  0F81 0005                            B        s:17200,PREL

     1010    17191        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:145  
     1011    17192    4                 CASE(ELSE);

     1012    17193    4                   CALL M$XXX;

  17193   3 000BE1  B870 0082                            LDR,R3   130,IMO
          3 000BE3  0001                                 MCL
          3 000BE4       0000                            DC       s:17193+3,PREL

     1013    17194    4                   END;                    /* %KC_FCN CASE             */

     1014    17195        %EJECT;
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:146  
     1015    17196        /*
     1016    17197           Decrement the scan size by the size of the message just processed
     1017    17198           and update the removal pointer taking wrap into account if necessary.
     1018    17199        */
     1019    17200    3                SCNSIZ=SCNSIZ-MSGSIZ;

  17200   3 000BE5  E847 0031                            LDR,R6   SCNSIZ,AUTO
          3 000BE7  E247 002E                            SUB,R6   MSGSIZ,AUTO
          3 000BE9  EF47 0031                            STR,R6   SCNSIZ,AUTO

     1020    17201    3                CQ$QHDR.RCQ.RPTR = CQ$QHDR.RCQ.RPTR + MSGSIZ;

  17201   3 000BEB  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          3 000BEE  D846 0001                            LDR,R5   1,B6
          3 000BF0  DA47 002E                            ADD,R5   MSGSIZ,AUTO
          3 000BF2  DF46 0001                            STR,R5   1,B6

     1021    17202    3                IF CQ$QHDR.RCQ.RPTR >= CQ$QHDR.RCQ.SZ

  17202   3 000BF4  EC80 0000 0000  xsym                 LDB,B6   G$HAND_Q$
          3 000BF7  D846 0001                            LDR,R5   1,B6
          3 000BF9  D946 0002                            CMR,R5   2,B6
          3 000BFB  0201 0003                            BL       s:17204,PREL

     1022    17203    3                THEN CQ$QHDR.RCQ.RPTR = 0;

  17203   3 000BFD  8746 0001                            CL       1,B6

     1023    17204    3                END;                       /* SCAN RECEIVE QUEUE       */

  17204   3 000BFF  6A01 F57A                            BGZ,R6   s:16558,PREL

  17203   3                              GETOUT          null
     1024    17205        /*
     1025    17206                  IF CQ$QHDR.RCQ.IPTR ~= CQ$QHDR.RCQ.RPTR
     1026    17207                       THEN GOTO SCAN;
     1027    17208         */
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:147  
     1028    17209        /*
     1029    17210          We're done scanning the queue.  Write out the messages we've placed
     1030    17211          in our send CQ (if any) and go to sleep.
     1031    17212        */
     1032    17213    2   GETOUT: ;
     1033    17214    2           CALL M$WRTMLT(FPT_WRTMLT);

  17214   3 000C01  BB80 0000 006C  00   GETOUT          LAB,B3   FPT_WRTMLT
          3 000C04  B870 1144                            LDR,R3   4420,IMO
          3 000C06  0001                                 MCL
          3 000C07       0000                            DC       s:17203+6,PREL

     1034    17215    2           CALL KHC$WAIT;

  17215   3 000C08  CBF0 0000                            LAB,B4   0,IMO
          3 000C0A  E380 0000 0000  xent                 LNJ,B6   KHC$WAIT
          3 000C0D       0001                            DC       s:17216,PREL

     1035    17216    2           END;                            /* FOREVER                  */

  17216   3 000C0E  0F81 F538                            B        s:16531,PREL
     1036    17217    1   END GJA$ADMIN;
     1037    17218        %EOD;

PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:148  
--  Include file information  --

   KV$VDO.:E05TOU  is referenced.
   KV$VDH.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   K_REASON_C.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KN_ERRORS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   GJA_MSG_M.:E05TOU  is referenced.
   G$BOBCAT_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_JIT_M.:E05TOU  is referenced.
      No diagnostics issued in procedure GJA$ADMIN.
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:149  

 **** Variables and constants ****

  ****  Section 000  Data  GJA$ADMIN

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    99-0-0/w STRC(1120)  r     1 CTLTBL                    27-0-0/w STRC(752)   r     1 FPT_CQOPEN
    1C-0-0/w STRC(128)   r     1 FPT_GETMEM                 0-0-0/w STRC(160)   r     1 FPT_SPRIV
    7B-0-0/w STRC(256)   r     1 FPT_TIME                  5A-0-0/w STRC(96)    r     1 FPT_TRAP
    6C-0-0/w STRC(207)   r     1 FPT_WRTMLT                19-0-0/w STRC(48)    r     1 FROMSEG
     A-0-0/w STRC(192)   r     1 GET_BOBCAT                24-0-0/w STRC(48)    r     1 GJA_MEMORY_RESULTS
    93-0-0/w STRC(96)    r     1 KH_EXP                    8B-0-0/w STRC(128)   r     1 KV$VDH_VDHINT
    16-0-0/w STRC(48)    r     1 USERSEG                   56-0-0/w STRC(64)    r     1 VLP_HMI
    60-0-0/w STRC(192)   r     1 VLP_TRAP_CONDITIONS

  ****  Section 001 RoData GJA$ADMIN

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/w STRC(16)    r     1 GJA_KL_MES                 3-0-0/w STRC(80)    r     1 KV_VDO_RQSDAT
     0-0-0/b BIT (32)    r     1 PRIVS                      8-0-0/w STRC(80)    r     1 VDO_NODAT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/w PTR         r     1 APP$                      40-0-0/w UBIN(16)    r     1 CHARPOS
    26-0-0/w PTR         r     1 CTX$                      24-0-0/w PTR         r     1 FPT$
     5-0-0/w STRC(368)   r     1 GJA$PARAMS                36-0-0/w STRC(80)    r     1 KV@VDO_RQSDAT
    33-0-0/b BIT         r     1 LAST                      20-0-0/w PTR         r     1 MSG$
    2E-0-0/w UBIN(16)    r     1 MSGSIZ                    3C-0-0/w UBIN(16)    r     1 MSGWTSIZE
    41-0-0/b BIT         r     1 NMAVAIL                   34-0-0/w UBIN(32)    r     1 RECOVERY_NODE
    2F-0-0/w PTR         r     1 ROUTE$                    31-0-0/w SBIN(16)    r     1 SCNSIZ
    32-0-0/w UBIN(16)    r     1 SIZE                      3F-0-0/w UBIN(16)    r     1 STRLEN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:150  
    3D-0-0/w PTR         r     1 SVCTX$                    28-0-0/w PTR         r     1 SVMSG$
    2C-0-0/w PTR         r     1 VDO$                      2A-0-0/w PTR         r     1 VLP$
    1C-0-0/w UBIN(16)    r     1 VLPSIZE                   1D-0-0/w UBIN(16)    r     1 WHO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$DS1$                     0-0-0/w PTR         r     1 G$DS4$
     0-0-0/w PTR         r     1 G$HAND_Q$                  0-0-0/w UBIN(16)    r     1 GID_BOOTCHAN
     0-0-0/w UBIN(16)    r     1 GJA_ATTR                   0-0-0/w PTR         r     1 GJA_CHNFREE$
     0-0-0/w UBIN(16)    r     1 GJA_CHNHI                  0-0-0/w PTR         r     1 GJA_CHNHI$
     0-0-0/w UBIN(16)    r     1 GJA_CHNLOW                 0-0-0/w PTR         r     1 GJA_CHNLOW$
     0-0-0/w STRC(304)   r     1 GJA_CONNECT                0-0-0/w STRC(96)    r     1 GJA_CONNECT_ACK
     0-0-0/w UBIN(16)    r     1 GJA_DEFNODE                0-0-0/w PTR         r     1 GJA_HAND_HEAD$
     0-0-0/w UBIN(16)    r     1 GJA_HOPCOST                0-0-0/w UBIN(16)    r     1 GJA_INTLEV
     0-0-0/w UBIN(16)    r     1 GJA_LDCT_BABOON            0-0-0/w UBIN(16)    r     1 GJA_LDCT_NM
     0-0-0/w STRC(80)    r     1 GJA_LDDAT                  0-0-0/w PTR         r     1 GJA_LINK$
     0-0-0/w UBIN(16)    r     1 GJA_LINKS                  0-0-0/w UBIN(16)    r     1 GJA_MAXNODE
     0-0-0/w UBIN(16)    r     1 GJA_MAXRDS                 0-0-0/w UBIN(16)    r     1 GJA_MEMORY
     0-0-0/w PTR         r     1 GJA_MSG_DOWN$              0-0-0/w PTR         r     1 GJA_MSG_HOSTDOWN$
     0-0-0/w PTR         r     1 GJA_MSG_LINKDOWN$          0-0-0/w PTR         r     1 GJA_NM_HEAD$
     0-0-0/w UBIN(16)    r     1 GJA_NODE#                  0-0-0/c CHAR(8)     r     1 GJA_NODENAME
     0-0-0/w UBIN(16)    r     1 GJA_OSIMAX#                0-0-0/w PTR         r     1 GJA_OSIROUTE$
     0-0-0/w UBIN(16)    r     1 GJA_RCQSIZE                0-0-0/w UBIN(16)    r     1 GJA_RETRYMAX
     0-0-0/w PTR         r     1 GJA_ROUTE$                 0-0-0/w UBIN(16)    r     1 GJA_SCQSIZE
     0-0-0/w STRC(1904)  r     1 GJA_SYSLOG                 0-0-0/w STRC(64)    r     1 GJA_TERM
     0-0-0/w STRC(32)    r     1 GJA_TERM_ACK               0-0-0/w UBIN(32)    r     1 GJA_UID_BABOON
     0-0-0/w PTR         r     1 GJA_UID_BABOON$            0-0-0/w PTR         r     1 GJA_UID_NANM$
     0-0-0/w UBIN(32)    r     1 GJA_UID_NM                 0-0-0/w PTR         r     1 GJA_UID_NM$
     0-0-0/w PTR         r     1 GJA_USRLGN_HEAD$
     0-0-0/c UBIN(8)     r     1 GJA_VDOBYTSIZ(0:34)
     0-0-0/w STRC(32)    r     1 GJA_VDO_DAT_DAT2           0-0-0/w STRC(80)    r     1 GJA_VDO_MRK
     0-0-0/w STRC(2072)  r     1 GJA_VDO_STT                0-0-0/w PTR         r     1 KH_CTLTBL$

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:151  

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(32)    r     1 B$DWORD                    0-0-0/w PTR         r     1 B$PTR$
     0-0-0/w STRC(384)   r     1 CQ$QHDR                    0-0-0/w STRC(304)   r     1 FPT$CONNECT
     0-0-0/w STRC(96)    r     1 FPT_CONNECT_ACK            0-0-0/w STRC(1696)  r     1 G$BOBCAT
     0-0-0/c STRC(272)   r     1 GJA$HAND_CTX               0-0-0/w STRC(528)   r     1 GJA$LGNCTX
     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(768)   r     1 KL$CONTROL
     0-0-0/c STRC(128)   r     1 KNH$MESS                   0-0-0/c STRC(608)   r     1 KNN$LINK
     0-0-0/w PTR         r     1 KNN$LINK$(0:0)
     0-0-0/w STRC(208)   r     1 KNN$ROUTE
     0-0-0/w PTR         r     1 KNN$ROUTE$(0:0)
     0-0-0/w STRC(16)    r     1 KV$VDO                     0-0-0/w STRC(16)    r     1 KV$VDOVLP
     0-0-0/w STRC(32)    r     1 KV$VDOVLP_ACTPOS           0-0-0/w STRC(96)    r     1 KV$VDOVLP_CG_MSGID
     0-0-0/w STRC(96)    r     1 KV$VDOVLP_CG_MSGTYP        0-0-0/w STRC(96)    r     1 KV$VDOVLP_CG_STA
     0-0-0/w STRC(16)    r     1 KV$VDOVLP_DAT1             0-0-0/w STRC(32)    r     1 KV$VDOVLP_DAT2
     0-0-0/w STRC(48)    r     1 KV$VDOVLP_ERR              0-0-0/w STRC(32)    r     1 KV$VDOVLP_FLDID
     0-0-0/w STRC(16)    r     1 KV$VDOVLP_KEY              0-0-0/w STRC(64)    r     1 KV$VDOVLP_MRK
     0-0-0/w STRC(80)    r     1 KV$VDO_RQSDAT              0-0-0N  NULL        r     1 M$CQ
     0-0-0/c ACHR        r     1 STRING                     0-0-0/w STRC(80)    r     1 SV$MSG


   Procedure GJA$ADMIN requires 3088 words for executable code.
   Procedure GJA$ADMIN requires 80 words of local(AUTO) storage.
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:152  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:153  
          MINI XREF LISTING

APP$
     16344**DCL     16890<<ASSIGN  16893>>ASSIGN  16897<<ASSIGN  16900>>ASSIGN  16904<<ASSIGN  16909<<ASSIGN
     16914<<ASSIGN  16919<<ASSIGN  16924<<ASSIGN  16930<<ASSIGN  16934<<ASSIGN  16939<<ASSIGN  16948>>ASSIGN
     17149>>ASSIGN  17153>>ASSIGN
B$DWORD
     14649**DCL     16464>>ASSIGN
B$PTR$
     13623**DCL     17149<<ASSIGN
CHARPOS
     16408**DCL     17075<<ASSIGN  17077<<ASSIGN  17090>>ASSIGN  17091<<ASSIGN  17091>>ASSIGN  17092>>ASSIGN
     17093<<ASSIGN  17093>>ASSIGN  17121>>ASSIGN
CLOCK_LOOP
     16533**LABEL   16543--EXIT
CQ$QHDR.RCQ
     15377**DCL     15377--REDEF
CQ$QHDR.RCQ.IPTR
     15377**DCL     16549>>ASSIGN
CQ$QHDR.RCQ.OFFSET
     15377**DCL     16558>>ASSIGN
CQ$QHDR.RCQ.RPTR
     15377**DCL     16549>>ASSIGN  16558>>ASSIGN  17201<<ASSIGN  17201>>ASSIGN  17202>>IF      17203<<ASSIGN
CQ$QHDR.RCQ.SZ
     15377**DCL     16551>>ASSIGN  17202>>IF
CTLTBL
     14056**DCL     16442--ASSIGN
CTLTBL.PARM.PTR$
     14182**DCL     16443<<ASSIGN
CTX$
     16346**DCL     15117--IMP-PTR 15202--IMP-PTR 16520<>CALL    16521>>ASSIGN  16522>>ASSIGN  16523>>ASSIGN
     16524>>ASSIGN  16525>>ASSIGN  16561<<ASSIGN  16562>>IF      16564>>ASSIGN  16568<<ASSIGN  16588<>CALL
     16591>>ASSIGN  16592>>ASSIGN  16593>>ASSIGN  16595>>ASSIGN  16597>>ASSIGN  16598>>ASSIGN  16600>>ASSIGN
     16601>>ASSIGN  16604>>ASSIGN  16605>>ASSIGN  16608<>CALL    16609<>CALL    16618<>CALL    16624<>CALL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:154  
     16637<<ASSIGN  16638>>IF      16641<>CALL    16642>>ASSIGN  16643>>ASSIGN  16644>>ASSIGN  16645>>ASSIGN
     16646>>ASSIGN  16647>>ASSIGN  16648>>ASSIGN  16651>>ASSIGN  16653>>ASSIGN  16654>>ASSIGN  16656>>ASSIGN
     16657<>CALL    16658<>CALL    16681>>ASSIGN  16684>>IF      16687>>IF      16689<>CALL    16692>>ASSIGN
     16693<>CALL    16701>>ASSIGN  16705<>CALL    16715>>IF      16715>>IF      16745>>IF      16745>>IF
     16747>>ASSIGN  16749<>CALL    16750<>CALL    16756>>IF      16758>>ASSIGN  16761>>ASSIGN  16801>>IF
     16802<>CALL    16810<>CALL    16814>>ASSIGN  16815>>ASSIGN  16816>>ASSIGN  16817>>ASSIGN  16820>>ASSIGN
     16822>>ASSIGN  16823>>ASSIGN  16825>>ASSIGN  16826<>CALL    16827>>ASSIGN  16828>>ASSIGN  16834<>CALL
     16856<>CALL    16859>>IF      16862<>CALL    16877>>IF      16982>>IF      16982>>IF      16984>>ASSIGN
     16986>>IF      16992>>IF      16994<>CALL    16998>>ASSIGN  16998>>ASSIGN  16999>>ASSIGN  17003>>ASSIGN
     17003>>ASSIGN  17004>>ASSIGN  17005>>ASSIGN  17009>>DOWHILE 17010>>ASSIGN  17011>>IF      17011>>IF
     17014>>ASSIGN  17014>>ASSIGN  17015<>CALL    17018>>IF      17018>>IF      17018>>IF      17030<>CALL
     17032>>ASSIGN  17032>>ASSIGN  17033>>ASSIGN  17033>>ASSIGN  17034>>ASSIGN  17036>>ASSIGN  17036>>ASSIGN
     17040>>IF      17046>>IF      17048>>ASSIGN  17049>>ASSIGN  17056>>ASSIGN  17057<<ASSIGN  17058>>DOWHILE
     17059>>IF      17060>>ASSIGN  17061<>CALL    17064<<ASSIGN  17064>>ASSIGN  17066<<ASSIGN  17078<<ASSIGN
     17079>>DOWHILE 17080>>IF      17080>>IF      17083>>IF      17083>>IF      17086>>DOWHILE 17090>>ASSIGN
     17096<<ASSIGN  17096>>ASSIGN  17137<>CALL
FPT$
     16345**DCL     14999--IMP-PTR 15048--IMP-PTR 16582<<ASSIGN  16584>>DOSELCT 16592>>ASSIGN  16593>>ASSIGN
     16602>>IF      16624>>CALL    16629>>IF      16636>>ASSIGN  16645>>ASSIGN  16680<<ASSIGN  16682>>IF
     16684>>IF      16684>>IF
FPT$CONNECT
     15048**DCL     16624<>CALL
FPT$CONNECT.RESOURCE
     15054**DCL     16584>>DOSELCT
FPT$CONNECT.RLCID.GENERATION
     15084**DCL     15085--REDEF
FPT$CONNECT.RLCID.LDCTX
     15085**DCL     15085--REDEF
FPT$CONNECT.RLCID.NODE
     15084**DCL     16629>>IF      16636>>ASSIGN  16645>>ASSIGN
FPT$CONNECT.TERMINAL_ID.TERM
     15073**DCL     15082--REDEF
FPT$CONNECT.TERMINAL_ID.TERMID
     15082**DCL     16593>>ASSIGN  16602>>IF
FPT$CONNECT.USER.SYSID
     15086**DCL     16592>>ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:155  
FPT_CONNECT_ACK.REASON
     15003**DCL     16682>>IF      16684>>IF      16684>>IF
FPT_CONNECT_ACK.UID.UID
     15029**DCL     15029--REDEF   15029--REDEF
FPT_CQOPEN
     13185**DCL     16492<>CALL
FPT_CQOPEN.V
     13193**DCL     13187--DCLINIT
FPT_GETMEM
     13140**DCL     16498<>CALL
FPT_GETMEM.V
     13143**DCL     13143--DCLINIT
FPT_GETMEM.V.PAGES
     13147**DCL     16469<<ASSIGN  16470>>ASSIGN
FPT_SPRIV
     13051**DCL     16446<>CALL
FPT_SPRIV.V
     13053**DCL     13053--DCLINIT
FPT_TIME.V
     13616**DCL     13615--DCLINIT
FPT_TRAP
     13229**DCL     16448<>CALL
FPT_WRTMLT
     13400**DCL     17214<>CALL
FPT_WRTMLT.V
     13405**DCL     13402--DCLINIT
FROMSEG
     13120**DCL     13077--DCLINIT
FROMSEG.BASE
     13124**DCL     13124--REDEF   16450<<ASSIGN
G$BOBCAT.BOOTCHAN
     15104**DCL     16513>>ASSIGN
G$BOBCAT.CHNFREE$
     15111**DCL     16512>>ASSIGN
G$BOBCAT.CHNHI
     15110**DCL     16511>>ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:156  
G$BOBCAT.CHNHI$
     15111**DCL     16510>>ASSIGN
G$BOBCAT.CHNLOW
     15110**DCL     16508>>ASSIGN
G$BOBCAT.CHNLOW$
     15111**DCL     16509>>ASSIGN
G$BOBCAT.FEP#
     15104**DCL     16454>>ASSIGN
G$BOBCAT.HOSTNODE
     15113**DCL     16456>>ASSIGN
G$BOBCAT.LINK$$
     15110**DCL     16461>>ASSIGN
G$BOBCAT.LINKS
     15107**DCL     16460>>ASSIGN
G$BOBCAT.NODENAME
     15104**DCL     16455>>ASSIGN
G$BOBCAT.NODES
     15107**DCL     16453>>ASSIGN
G$BOBCAT.OSIROUTE#
     15113**DCL     16459>>ASSIGN
G$BOBCAT.OSIROUTE$
     15114**DCL     16458>>ASSIGN
G$BOBCAT.ROUTE$$
     15110**DCL     16457>>ASSIGN
G$DS1$
     14396**DCL     16464>>ASSIGN  16464>>ASSIGN
G$DS4$
     14397**DCL     15104--IMP-PTR 16453>>ASSIGN  16454>>ASSIGN  16455>>ASSIGN  16456>>ASSIGN  16457>>ASSIGN
     16458>>ASSIGN  16459>>ASSIGN  16460>>ASSIGN  16461>>ASSIGN  16508>>ASSIGN  16509>>ASSIGN  16510>>ASSIGN
     16511>>ASSIGN  16512>>ASSIGN  16513>>ASSIGN
G$HAND_Q$
     14428**DCL     15377--IMP-PTR 16549>>ASSIGN  16549>>ASSIGN  16551>>ASSIGN  16558>>ASSIGN  16558>>ASSIGN
     16558>>ASSIGN  17201>>ASSIGN  17201>>ASSIGN  17202>>IF      17202>>IF      17203>>ASSIGN
GETOUT
     17203**LABEL   16589--GOTO    16624--CALLALT 16641--CALLALT 16812--GOTO    17137--CALLALT
GET_BOBCAT
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:157  
     13074**DCL     16452<>CALL
GET_BOBCAT.V
     13078**DCL     13077--DCLINIT
GID_BOOTCHAN
     14398**DCL     16513<<ASSIGN
GIJ$ABORTDUMP
     16413**DCL-ENT 16769--CALL
GJA$CONFIG
     16416**DCL-ENT 16516--CALL
GJA$DECODE_APL_MSG
     16414**DCL-ENT 17137--CALL
GJA$DISOLVE_LGNUSR_CTX
     16415**DCL-ENT 16750--CALL    16862--CALL
GJA$DISOLVE_NA
     16417**DCL-ENT 16689--CALL    16802--CALL    16856--CALL
GJA$HAND_CTX
     15202**DCL     16519--ASSIGN  16523<<ASSIGN  16587--ASSIGN  16591<<ASSIGN  16640--ASSIGN  16642<<ASSIGN
     16809--ASSIGN  16814<<ASSIGN
GJA$HAND_CTX.BLK
     15233**DCL     16982>>IF      16986>>IF      17059>>IF      17060<<ASSIGN
GJA$HAND_CTX.HOST_NODE
     15232**DCL     16684>>IF      16817<<ASSIGN  17080>>IF
GJA$HAND_CTX.LDCTX
     15208**DCL     16600<<ASSIGN  16656<<ASSIGN  16687>>IF      16701<<ASSIGN  17080>>IF
GJA$HAND_CTX.LINK_CONNECTED
     15231**DCL     16648<<ASSIGN  16828<<ASSIGN
GJA$HAND_CTX.LNK$
     15212**DCL     16597<<ASSIGN  16653<<ASSIGN  16822<<ASSIGN  17064>>ASSIGN  17096>>ASSIGN
GJA$HAND_CTX.MAXNMBBYT
     15216**DCL     16998<<ASSIGN  16998>>ASSIGN  16999<<ASSIGN  17018>>IF      17033<<ASSIGN  17033>>ASSIGN
GJA$HAND_CTX.MAXNMBRCR
     15215**DCL     17003<<ASSIGN  17003>>ASSIGN  17004<<ASSIGN  17011>>IF      17014<<ASSIGN  17014>>ASSIGN
     17018>>IF      17032<<ASSIGN  17032>>ASSIGN
GJA$HAND_CTX.MAXRCRBYTSIZ
     15214**DCL     17005<<ASSIGN  17011>>IF      17018>>IF
GJA$HAND_CTX.NAME
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:158  
     15226**DCL     16525<<ASSIGN  16593<<ASSIGN  16643<<ASSIGN  17083>>IF      17083>>IF      17086>>DOWHILE
     17090>>ASSIGN
GJA$HAND_CTX.NODE
     15237**DCL     16645<<ASSIGN  16646>>ASSIGN  16692>>ASSIGN  16715>>IF      16715>>IF      16761>>ASSIGN
     16816<<ASSIGN
GJA$HAND_CTX.RDSOUT
     15217**DCL     16984<<ASSIGN
GJA$HAND_CTX.SYSID
     15241**DCL     16592<<ASSIGN
GJA$HAND_CTX.WAITING_MSG$
     15224**DCL     16992>>IF      17009>>DOWHILE 17010>>ASSIGN  17034>>ASSIGN  17036<<ASSIGN  17036>>ASSIGN
     17046>>IF      17048>>ASSIGN  17049>>ASSIGN
GJA$HAND_CTX.WAT4ACK
     15234**DCL     16681<<ASSIGN  16758<<ASSIGN  16801>>IF      16827<<ASSIGN
GJA$HAND_CTX.WHO
     15207**DCL     16524<<ASSIGN  16564>>ASSIGN  16601<<ASSIGN  16605<<ASSIGN  16644<<ASSIGN  16815<<ASSIGN
GJA$HOST_RECOVERY
     16419**DCL-ENT 16774--CALL
GJA$LGNCTX.CHN$
     15143**DCL     16715>>IF
GJA$LGNCTX.LNK$
     15127**DCL     16723>>ASSIGN
GJA$LGNCTX.MSG$
     15144**DCL     17153<<ASSIGN
GJA$LGNCTX.NM_NODE
     15141**DCL     16715>>IF
GJA$LGNCTX.STATUS.DSCRCV
     15192**DCL     17170<<ASSIGN
GJA$LGNCTX.STATUS.LGNRSP
     15186**DCL     17141>>IF
GJA$LGNCTX.STATUS.NMRSP
     15187**DCL     16745>>IF      17104>>IF      17167>>IF
GJA$LGNCTX.STATUS.RDPND
     15196**DCL     16967>>IF      16969<<ASSIGN  17144>>IF
GJA$LGNCTX.STATUS.TERM
     15185**DCL     16747<<ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:159  
GJA$LGNCTX.STATUS.TERMACK
     15188**DCL     16859>>IF      16877>>IF      17173<<ASSIGN
GJA$LGNCTX.STATUS.WTPRO
     15191**DCL     16745>>IF      17110>>IF      17167>>IF
GJA$LGNCTX.TERMINAL_ID
     15166**DCL     17148>>ASSIGN
GJA$LGNCTX.TERMINAL_ID.TERM
     15168**DCL     15177--REDEF
GJA$LOGON_REQUEST
     16422**DCL-ENT 16624--CALL
GJA$LOGON_REQUEST_AGAIN
     16423**DCL-ENT 16719--CALL
GJA$LOGON_TIMEOUT
     16425**DCL-ENT 16538--CALL
GJA$NETWORK_MANAGER
     16421**DCL-ENT 17150--CALL
GJA$NODEINFO
     16426**DCL-ENT 16658--CALL    16705--CALL
GJA$PARAMS
     16326**DCL     16880<<ASSIGN  17137<>CALL
GJA$PARAMS.CG_MSGID$
     16334**DCL     16936<<ASSIGN
GJA$PARAMS.CG_MSGTYP$
     16332**DCL     16906<<ASSIGN
GJA$PARAMS.CG_STA$
     16333**DCL     16911<<ASSIGN
GJA$PARAMS.DAT$
     16330**DCL     16893<<ASSIGN  16900<<ASSIGN
GJA$PARAMS.DATSIZE
     16331**DCL     16894<<ASSIGN  16901<<ASSIGN  17154<>CALL
GJA$PARAMS.DATVLP$
     16329**DCL     16892<<ASSIGN  16899<<ASSIGN
GJA$PARAMS.ERR$
     16335**DCL     16916<<ASSIGN
GJA$PARAMS.FLDID$
     16336**DCL     16921<<ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:160  
GJA$PARAMS.KEY$
     16337**DCL     16926<<ASSIGN
GJA$PARAMS.MRK$
     16338**DCL     16929<<ASSIGN  16952>>IF      16952>>IF      16955>>ASSIGN  16956>>ASSIGN  16958>>ASSIGN
GJA$PARAMS.MSG$
     16327**DCL     16881<<ASSIGN
GJA$PARAMS.VDO$
     16328**DCL     16882<<ASSIGN
GJA$Q_MSG
     16427**DCL-ENT 16608--CALL    16609--CALL    16618--CALL    16632--CALL    16657--CALL    16667--CALL
     16693--CALL    16749--CALL    16755--CALL    16826--CALL    16839--CALL    16957--CALL    16980--CALL
     16994--CALL    17015--CALL    17061--CALL    17130--CALL    17172--CALL
GJA$SOLICIT_LOGON
     16428**DCL-ENT 16970--CALL
GJA$SOLICIT_NM
     16429**DCL-ENT 17154--CALL
GJA$TERM_HANDLER
     16430**DCL-ENT 16834--CALL
GJA$WRITE
     16431**DCL-ENT 17030--CALL
GJA_ATTR
     14401**DCL     16489<<ASSIGN  17120>>IF
GJA_CHNFREE$
     14425**DCL     16512<<ASSIGN
GJA_CHNHI
     14424**DCL     16511<<ASSIGN
GJA_CHNHI$
     14422**DCL     16510<<ASSIGN
GJA_CHNLOW
     14423**DCL     16508<<ASSIGN
GJA_CHNLOW$
     14420**DCL     16509<<ASSIGN
GJA_CONNECT
     14497**DCL     16693--CALL    16693<>CALL    16826--CALL    16826<>CALL
GJA_CONNECT.RLCID.GENERATION
     14533**DCL     14534--REDEF
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:161  
GJA_CONNECT.RLCID.LDCTX
     14534**DCL     14534--REDEF
GJA_CONNECT.RLCID.NODE
     14533**DCL     16692<<ASSIGN  16808<<ASSIGN
GJA_CONNECT.TERMINAL_ID.TERM
     14522**DCL     14531--REDEF
GJA_CONNECT_ACK
     14566**DCL     16608--CALL    16608<>CALL    16618--CALL    16618<>CALL    16632--CALL    16632<>CALL
     16657--CALL    16657<>CALL    16667--CALL    16667<>CALL
GJA_CONNECT_ACK.REASON
     14570**DCL     16607<<ASSIGN  16617<<ASSIGN  16631<<ASSIGN  16635<<ASSIGN  16666<<ASSIGN
GJA_CONNECT_ACK.UID.UID
     14596**DCL     14596--REDEF   14596--REDEF
GJA_DEFNODE
     14429**DCL     16456<<ASSIGN  16715>>IF      16775>>IF      16775>>IF      16779>>IF      16779>>IF
     16781>>IF      16782>>IF      16789>>IF      16789>>IF      16791>>IF      16792>>IF
GJA_HAND_HEAD$
     14411**DCL     16522<<ASSIGN  16594>>IF      16595<<ASSIGN  16597>>ASSIGN  16598<<ASSIGN  17057>>ASSIGN
GJA_HOPCOST
     14412**DCL     16484<<ASSIGN
GJA_INTLEV
     14400**DCL     16443--ASSIGN
GJA_KL_MES
     13643**DCL     16609--CALL    16609<>CALL    16618--CALL    16618<>CALL
GJA_LDCT_BABOON
     14404**DCL     16606<<ASSIGN
GJA_LDCT_NM
     14403**DCL     16771<<ASSIGN
GJA_LDDAT
     13817**DCL     17015--CALL    17015<>CALL
GJA_LINK$
     14417**DCL     14651--IMP-PTR 16461<<ASSIGN  16782>>IF      16792>>IF
GJA_LINKS
     14416**DCL     16460<<ASSIGN
GJA_MAXNODE
     14405**DCL     16453<<ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:162  
GJA_MAXRDS
     14431**DCL     16984>>ASSIGN
GJA_MEMORY
     14438**DCL     16470<<ASSIGN
GJA_MEMORY_RESULTS
     13165**DCL     13143--DCLINIT
GJA_MEMORY_RESULTS.BASE
     13169**DCL     13169--REDEF
GJA_MEMORY_RESULTS.BASE$
     13169**DCL     16502>>ASSIGN  16503>>ASSIGN
GJA_MEMORY_RESULTS.PAGES
     13169**DCL     16503>>ASSIGN
GJA_MSG_DOWN$
     14652**DCL     16777<<ASSIGN  16783<<ASSIGN  16785<<ASSIGN  16793<<ASSIGN  16795<<ASSIGN
GJA_MSG_HOSTDOWN$
     14654**DCL     16777>>ASSIGN  16783>>ASSIGN  16793>>ASSIGN
GJA_MSG_LINKDOWN$
     14653**DCL     16785>>ASSIGN  16795>>ASSIGN
GJA_NM_HEAD$
     14418**DCL     16649>>IF      16651<<ASSIGN  16653>>ASSIGN  16654<<ASSIGN  16818>>IF      16820<<ASSIGN
     16822>>ASSIGN  16823<<ASSIGN  17078>>ASSIGN
GJA_NODE#
     14419**DCL     16454<<ASSIGN  16629>>IF      16804>>IF
GJA_NODENAME
     14421**DCL     16455<<ASSIGN
GJA_OSIMAX#
     14415**DCL     16459<<ASSIGN
GJA_OSIROUTE$
     14414**DCL     16458<<ASSIGN
GJA_RCQSIZE
     14436**DCL     16475<<ASSIGN
GJA_RETRYMAX
     14426**DCL     16487<<ASSIGN
GJA_ROUTE$
     14413**DCL     14650--IMP-PTR 16457<<ASSIGN  16636>>ASSIGN  16646>>ASSIGN  16775>>IF      16779>>IF
     16781>>IF      16782>>IF      16789>>IF      16791>>IF      16792>>IF      16803>>ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:163  
GJA_SCQSIZE
     14437**DCL     16480<<ASSIGN
GJA_SYSLOG
     13422**DCL     17150<>CALL    17150--CALL
GJA_SYSLOG.ERRLOG.DATA
     13539**DCL     17150--CALL
GJA_SYSLOG.ERRLOG.ERRCODE.ERR#
     13495**DCL     17146<<ASSIGN
GJA_SYSLOG.ERRLOG.TERMID
     13519**DCL     17148<<ASSIGN
GJA_SYSLOG.ERRLOG.TERMID.TERM
     13521**DCL     13530--REDEF
GJA_SYSLOG.ERRLOG.UTS
     13499**DCL     17147<>CALL
GJA_SYSLOG.ERRLOG.VALUES
     13533**DCL     17149--ASSIGN
GJA_SYSLOG.FCN
     13423**DCL     17145<<ASSIGN
GJA_TERM
     14453**DCL     17172--CALL    17172<>CALL
GJA_TERM_ACK
     14477**DCL     16749--CALL    16749<>CALL    16755--CALL    16755<>CALL    16839--CALL    16839<>CALL
GJA_UID_BABOON
     14408**DCL     14409--REDEF
GJA_UID_BABOON$
     14409**DCL     16604<<ASSIGN
GJA_UID_NANM$
     14427**DCL     16521<<ASSIGN
GJA_UID_NM
     14406**DCL     14407--REDEF
GJA_UID_NM$
     14407**DCL     16756>>IF      16759<<ASSIGN  16767>>IF      16770<<ASSIGN  17040>>IF
GJA_USRLGN_HEAD$
     14410**DCL     16710>>ASSIGN
GJA_VDOBYTSIZ
     13683**DCL     16884>>ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:164  
GJA_VDO_DAT_DAT2.DATCTRCHR
     14643**DCL     17027<<ASSIGN
GJA_VDO_DAT_DAT2.DATCTRCHRTYP
     14642**DCL     17026<<ASSIGN  17031<<ASSIGN
GJA_VDO_MRK
     13723**DCL     16957--CALL    16957<>CALL
GJA_VDO_MRK.MRK.ID
     13781**DCL     16956<<ASSIGN
GJA_VDO_MRK.MRK.MRKTYP
     13780**DCL     16955<<ASSIGN
GJA_VDO_STT
     15546**DCL     17128--ASSIGN  17130<>CALL
GJA_VDO_STT.DAT1.BYTSIZ
     15595**DCL     17101<<ASSIGN  17107<<ASSIGN  17113<<ASSIGN  17121<<ASSIGN  17125<<ASSIGN  17128>>ASSIGN
GJA_VDO_STT.STATE
     15604**DCL     17076<<ASSIGN  17090<<ASSIGN  17092<<ASSIGN  17100<<ASSIGN  17106<<ASSIGN  17112<<ASSIGN
     17124<<ASSIGN  17128--ASSIGN
KH$CHN.AUTLGN
     15631**DCL     16715>>IF
KH$CHN.TERMID.TERM
     15716**DCL     15725--REDEF
KHC$DISPATCH
     16432**DCL-ENT 16536--CALL
KHC$UTS
     16424**DCL-ENT 17147--CALL
KHC$WAIT
     16433**DCL-ENT 17215--CALL
KH_CTLTBL$
     13669**DCL     16442<<ASSIGN
KH_EXP
     13990**DCL     16536<>CALL
KH_EXP.ABORT
     14012**DCL     16534>>IF
KH_EXP.CTBCTX$
     14005**DCL     16542<<ASSIGN
KH_EXP.UID
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:165  
     13996**DCL     13997--REDEF
KH_EXP.UID$
     13997**DCL     16538<>CALL
KL$CONTROL.FPARAM
     15361**DCL     16469>>ASSIGN  16474>>ASSIGN  16479>>ASSIGN  16484>>ASSIGN  16487>>ASSIGN  16489>>ASSIGN
KL$CONTROL.NUM_FPARAM
     15354**DCL     16467>>IF      16472>>IF      16477>>IF      16482>>IF      16485>>IF      16488>>IF
KL$CONTROL.TYPE
     15289**DCL     16465>>IF
KNH$MESS
     15402**DCL     16559--ASSIGN  16582--ASSIGN  16624<>CALL    16680--ASSIGN  16879--ASSIGN
KNH$MESS.FPTSZ
     15435**DCL     16559>>ASSIGN
KNH$MESS.FUNCTION
     15402**DCL     15402--REDEF   16560>>IF      16571>>DOCASE
KNH$MESS.LDCTX
     15407**DCL     16600>>ASSIGN  16606>>ASSIGN  16632--CALL    16656>>ASSIGN  16667--CALL    16701>>ASSIGN
     16755--CALL    16839--CALL
KNH$MESS.MSGSZ
     15436**DCL     16559>>ASSIGN
KNH$MESS.UID
     15432**DCL     15432--REDEF   15432--REDEF   16980<>CALL
KNH$MESS.UID$
     15432**DCL     16561>>ASSIGN  16957<>CALL    16967>>IF      16969>>ASSIGN  16970<>CALL    17104>>IF
     17110>>IF      17130<>CALL    17141>>IF      17144>>IF      17148>>ASSIGN  17153>>ASSIGN  17154<>CALL
     17167>>IF      17167>>IF      17170>>ASSIGN  17172<>CALL    17173>>ASSIGN
KNN$LINK.DEST.ADDRESS_N
     14915**DCL     14916--REDEF
KNN$LINK.LADR.ADDRESS_N
     14858**DCL     14859--REDEF
KNN$LINK.LDCT$
     14729**DCL     14736--REDEF
KNN$LINK.QOS
     14788**DCL     16782>>IF      16792>>IF
KNN$LINK$
     14651**DCL     16782>>IF      16792>>IF
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:166  
KNN$ROUTE.CTX$
     14663**DCL     16637>>ASSIGN  16647<<ASSIGN  16825<<ASSIGN
KNN$ROUTE.CURRENT_QOS
     14674**DCL     16804>>IF
KNN$ROUTE.FLAGS.HOST_NODE
     14684**DCL     16804>>IF      16817>>ASSIGN
KNN$ROUTE.FLAGS.LINK_CONNECTED
     14688**DCL     16648>>ASSIGN  16775>>IF      16779>>IF      16789>>IF      16828>>ASSIGN
KNN$ROUTE.LINK#
     14669**DCL     16781>>IF      16782>>IF      16791>>IF      16792>>IF
KNN$ROUTE$
     14650**DCL     16636>>ASSIGN  16646>>ASSIGN  16775>>IF      16779>>IF      16781>>IF      16782>>IF
     16789>>IF      16791>>IF      16792>>IF      16803>>ASSIGN
KV$VDH_VDHINT
     13663**DCL     16504<>CALL
KV$VDH_VDHINT.BFRBGN$
     13663**DCL     16502<<ASSIGN
KV$VDH_VDHINT.BFREND$
     13663**DCL     16503<<ASSIGN
KV$VDO.FNC
     15462**DCL     16884>>ASSIGN  16952>>IF      16962>>DOCASE
KV$VDO.VLP
     15462**DCL     16885>>ASSIGN
KV$VDOVLP.LST
     15755**DCL     16947>>ASSIGN
KV$VDOVLP.TYP
     15755**DCL     16887>>DOCASE
KV$VDOVLP_ACTPOS
     15900**DCL     16940--ASSIGN
KV$VDOVLP_CG_MSGID
     16305**DCL     16934--ASSIGN
KV$VDOVLP_CG_MSGID.BYTSIZ
     16311**DCL     16935>>ASSIGN
KV$VDOVLP_CG_MSGTYP
     15951**DCL     16905--ASSIGN
KV$VDOVLP_CG_STA
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:167  
     16003**DCL     16910--ASSIGN
KV$VDOVLP_DAT1
     15800**DCL     16890--ASSIGN
KV$VDOVLP_DAT1.BYTSIZ
     15806**DCL     16891>>ASSIGN  16894>>ASSIGN
KV$VDOVLP_DAT2
     15850**DCL     16897--ASSIGN
KV$VDOVLP_DAT2.BYTSIZ
     15858**DCL     16898>>ASSIGN  16901>>ASSIGN
KV$VDOVLP_ERR
     16054**DCL     16915--ASSIGN
KV$VDOVLP_FLDID
     16151**DCL     16919--ASSIGN
KV$VDOVLP_FLDID.BYTSIZ
     16157**DCL     16920>>ASSIGN
KV$VDOVLP_KEY
     16202**DCL     16924--ASSIGN
KV$VDOVLP_KEY.BYTSIZ
     16208**DCL     16925>>ASSIGN
KV$VDOVLP_MRK
     16252**DCL     16930--ASSIGN
KV$VDOVLP_MRK.BYTSIZ
     16258**DCL     16931>>ASSIGN
KV$VDOVLP_MRK.ID
     16267**DCL     16956>>ASSIGN
KV$VDOVLP_MRK.MRKTYP
     16266**DCL     16952>>IF      16955>>ASSIGN  16958<<ASSIGN
KV$VDO_RQSDAT
     15498**DCL     16980--CALL
KV$VDO_RQSDAT.EOFNO_DAT
     15509**DCL     16992>>IF
KV$VDO_RQSDAT.INCMAXNMBBYT
     15507**DCL     16997>>IF
KV$VDO_RQSDAT.INCMAXNMBRCR
     15507**DCL     17002>>IF
KV$VDO_RQSDAT.MAXNMBBYT
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:168  
     15506**DCL     16998>>ASSIGN  16999>>ASSIGN
KV$VDO_RQSDAT.MAXNMBRCR
     15505**DCL     17003>>ASSIGN  17004>>ASSIGN
KV$VDO_RQSDAT.MAXRCRBYTSIZ
     15505**DCL     17005>>ASSIGN
KV@VDO_RQSDAT
     16389**DCL     16979<<ASSIGN  16980<>CALL    17055<<ASSIGN
KVB$GETSYS
     16435**DCL-ENT 16520--CALL    16588--CALL    16641--CALL    16810--CALL
KVB$INT
     16436**DCL-ENT 16504--CALL
KVB$RLSSYS
     16438**DCL-ENT 17037--CALL
KV_VDO_RQSDAT
     13961**DCL     16979>>ASSIGN  17055>>ASSIGN  17061--CALL    17061<>CALL
LAST
     16354**DCL     16885<<ASSIGN  16886>>DOWHILE 16947<<ASSIGN
M$CVM
      4557**DCL-ENT 16452--CALL
M$GDS
      4555**DCL-ENT 16498--CALL
M$OPEN
      4560**DCL-ENT 16492--CALL
M$SPRIV
      4549**DCL-ENT 16446--CALL
M$SYS
      4535**DCL-ENT 16447--CALL
M$TRAP
      4544**DCL-ENT 16448--CALL
M$WRTMLT
      4561**DCL-ENT 17214--CALL
M$XXX
      4538**DCL-ENT 16494--CALL    16500--CALL    16861--CALL    16865--CALL    16943--CALL    17142--CALL
     17163--CALL    17193--CALL
MSG$
     16343**DCL     14979--IMP-PTR 15283--IMP-PTR 15402--IMP-PTR 16464<<ASSIGN  16465>>IF      16467>>IF
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:169  
     16469>>ASSIGN  16472>>IF      16474>>ASSIGN  16477>>IF      16479>>ASSIGN  16482>>IF      16484>>ASSIGN
     16485>>IF      16487>>ASSIGN  16488>>IF      16489>>ASSIGN  16558<<ASSIGN  16559>>ASSIGN  16559>>ASSIGN
     16560>>IF      16561>>ASSIGN  16571>>DOCASE  16582>>ASSIGN  16600>>ASSIGN  16606>>ASSIGN  16624>>CALL
     16632>>CALL    16656>>ASSIGN  16667>>CALL    16680>>ASSIGN  16701>>ASSIGN  16755>>CALL    16839>>CALL
     16879>>ASSIGN  16881>>ASSIGN  16957>>CALL    16967>>IF      16969>>ASSIGN  16970>>CALL    16980>>CALL
     17104>>IF      17110>>IF      17130>>CALL    17141>>IF      17144>>IF      17148>>ASSIGN  17153>>ASSIGN
     17154>>CALL    17167>>IF      17167>>IF      17170>>ASSIGN  17172>>CALL    17173>>ASSIGN  17186>>IF
MSGSIZ
     16350**DCL     16559<<ASSIGN  17186>>IF      17200>>ASSIGN  17201>>ASSIGN
MSGWTSIZE
     16405**DCL     17008<<ASSIGN  17035<<ASSIGN  17035>>ASSIGN  17040>>IF      17042<<ASSIGN  17048<<ASSIGN
     17052<<ASSIGN  17052>>ASSIGN
NMAVAIL
     16409**DCL     17074<<ASSIGN  17082<<ASSIGN  17098>>IF
PRIVS
     13625**DCL     13053--DCLINIT
RECOVERY_NODE
     16355**DCL     16761<<ASSIGN  16774<>CALL    16775>>IF      16779>>IF      16789>>IF      16803>>ASSIGN
     16804>>IF      16808>>ASSIGN  16816>>ASSIGN
ROUTE$
     16351**DCL     14656--IMP-PTR 16636<<ASSIGN  16637>>ASSIGN  16646<<ASSIGN  16647>>ASSIGN  16648>>ASSIGN
     16803<<ASSIGN  16804>>IF      16804>>IF      16817>>ASSIGN  16825>>ASSIGN  16828>>ASSIGN
SCNSIZ
     16352**DCL     16549<<ASSIGN  16550>>IF      16551<<ASSIGN  16551>>ASSIGN  16557>>DOWHILE 17200<<ASSIGN
     17200>>ASSIGN
SIZE
     16353**DCL     14978--IMP-SIZ 16519<<ASSIGN  16520<>CALL    16587<<ASSIGN  16588<>CALL    16640<<ASSIGN
     16641<>CALL    16809<<ASSIGN  16810<>CALL    17023<<ASSIGN  17030<>CALL    17030>>CALL    17033>>ASSIGN
     17128<<ASSIGN  17130<>CALL
STRING
     14978**DCL     17030<>CALL
STRLEN
     16407**DCL     17085<<ASSIGN  17086>>DOWHILE 17086>>DOWHILE 17088<<ASSIGN  17088>>ASSIGN  17090>>ASSIGN
     17091>>ASSIGN
SV$MSG
     14979**DCL     17029--ASSIGN  17037<>CALL
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:170  
SV$MSG.LNK$
     14981**DCL     17036>>ASSIGN  17050>>DOWHILE 17051>>ASSIGN
SV$MSG.SZ
     14982**DCL     17011>>IF      17018>>IF      17018>>IF      17023>>ASSIGN  17035>>ASSIGN  17048>>ASSIGN
     17052>>ASSIGN
SV$MSG.VFC
     14983**DCL     17024>>IF      17027>>ASSIGN
SVCTX$
     16406**DCL     17056<<ASSIGN  17066>>ASSIGN
SVMSG$
     16347**DCL     16710<<ASSIGN  16711>>DOWHILE 16715>>IF      16715>>IF      16719<>CALL    16723<<ASSIGN
     16723>>ASSIGN  17010<<ASSIGN  17011>>IF      17018>>IF      17018>>IF      17023>>ASSIGN  17024>>IF
     17027>>ASSIGN  17029<<ASSIGN  17029>>ASSIGN  17030>>CALL    17034<<ASSIGN  17035>>ASSIGN  17037>>CALL
     17049<<ASSIGN  17050>>DOWHILE 17051<<ASSIGN  17051>>ASSIGN  17052>>ASSIGN
UN_FLOW
     16979**LABEL   16987--GOTO
USERSEG
     13099**DCL     13077--DCLINIT
USERSEG.BASE
     13103**DCL     13103--REDEF   16451<<ASSIGN
VDO$
     16349**DCL     15458--IMP-PTR 15498--IMP-PTR 16879<<ASSIGN  16882>>ASSIGN  16884>>ASSIGN  16884>>ASSIGN
     16885>>ASSIGN  16952>>IF      16962>>DOCASE  16992>>IF      16997>>IF      16998>>ASSIGN  16999>>ASSIGN
     17002>>IF      17003>>ASSIGN  17004>>ASSIGN  17005>>ASSIGN  17188<<ASSIGN
VDOLOOP
     16883**LABEL   17187--EXIT
VDO_NODAT
     14284**DCL     16994--CALL    16994<>CALL
VLP$
     16348**DCL     15751--IMP-PTR 16884<<ASSIGN  16887>>DOCASE  16890>>ASSIGN  16890>>ASSIGN  16891>>ASSIGN
     16892>>ASSIGN  16894>>ASSIGN  16897>>ASSIGN  16897>>ASSIGN  16898>>ASSIGN  16899>>ASSIGN  16901>>ASSIGN
     16904>>ASSIGN  16905>>ASSIGN  16906>>ASSIGN  16909>>ASSIGN  16910>>ASSIGN  16911>>ASSIGN  16914>>ASSIGN
     16915>>ASSIGN  16916>>ASSIGN  16919>>ASSIGN  16919>>ASSIGN  16920>>ASSIGN  16921>>ASSIGN  16924>>ASSIGN
     16924>>ASSIGN  16925>>ASSIGN  16926>>ASSIGN  16929>>ASSIGN  16930>>ASSIGN  16930>>ASSIGN  16931>>ASSIGN
     16934>>ASSIGN  16934>>ASSIGN  16935>>ASSIGN  16936>>ASSIGN  16939>>ASSIGN  16940>>ASSIGN  16947>>ASSIGN
     16948<<ASSIGN  17186>>IF      17188>>ASSIGN
PL6.E3A0      #001=GJA$ADMIN File=GJA$ADMIN.:E05TSI                              TUE 07/29/97 21:50 Page:171  
VLPSIZE
     16340**DCL     16891<<ASSIGN  16898<<ASSIGN  16905<<ASSIGN  16910<<ASSIGN  16915<<ASSIGN  16920<<ASSIGN
     16925<<ASSIGN  16931<<ASSIGN  16935<<ASSIGN  16940<<ASSIGN  16948>>ASSIGN
VLP_HMI
     13213**DCL     13187--DCLINIT
VLP_HMI.RCQSIZE
     13213**DCL     16474<<ASSIGN  16475>>ASSIGN
VLP_HMI.SCQSIZE
     13213**DCL     16479<<ASSIGN  16480>>ASSIGN
VLP_TRAP_CONDITIONS
     13244**DCL     13229--DCLINIT
WHO
     16341**DCL     16564<<ASSIGN  16739>>DOCASE  16853>>DOCASE  16877>>IF      16982>>IF      17135>>IF
     17135>>IF      17135>>IF      17139>>IF      17162>>IF

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:172  
     1038        1        /*T***********************************************************/
     1039        2        /*T*                                                         */
     1040        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1041        4        /*T*                                                         */
     1042        5        /*T***********************************************************/
     1043        6        /*F*    NAME:  GJA$DECODE_APL_MSG
     1044        7                PURPOSE:  This routine is called when GJA$ADMIN determines
     1045        8                          that a message passed is from the network manager.
     1046        9                          This routine determines what type of message it
     1047       10                          was called with and acts on it.
     1048       11                DESCRIPTION:  This routine is fairly simple.  It just determines
     1049       12                              what type of message was sent and acts on it.
     1050       13                CALL:  CALL GJA$DECODE_APL_MSG(MSG$,APP$) ALTRET(label)
     1051       14                INPUT: MSG$ - Points to the head of the message
     1052       15                       APP$ - Points to the IGA message header
     1053       16                       VDO$ - Points to the start of the VDO
     1054       17        */
     1055       18        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:173  
     1056       19        GJA$DECODE_APL_MSG: PROC(GJA$PARAMS,MSGCTX$) ALTRET;
     1057       20
     1058       21        %INCLUDE CP_6_SUBS;
     1059      561        %INCLUDE LCP_6;
     1060     4840        %INCLUDE GH_IOFNC_E;
     1061     4909        %INCLUDE GJA_MSG_M;
     1062     5148        %INCLUDE KH$CHN;
     1063     5270        %INCLUDE KH$IO;
     1064     5517        %INCLUDE KL_AFCN_C;                     /* 'IGA' Function Codes     */
     1065     5618        %INCLUDE KL_MACRO_C;
     1066     8970        %INCLUDE KNH_MACRO_C;
     1067     9253        %INCLUDE KV$VDO;
     1068    10268        %INCLUDE KV$GLB;
     1069    10687        %INCLUDE KV$GLBCTX;
     1070    11132        %INCLUDE KV_GLBCNS_E;
     1071    11473        %INCLUDE KI_ERRORS_C;
     1072    11558        %INCLUDE KI_SUBS_C;
     1073    11694        %INCLUDE KNN_NETWORK_M;
     1074    12057        %INCLUDE KN_ERRORS_C;
     1075    12121        %INCLUDE KL_SUPER_C;
     1076    15023        %INCLUDE NK_VFC_C;
     1077    15097        %INCLUDE KHA_FNC_E;
     1078    15197        %INCLUDE K_ID_E;
     1079    15247        %INCLUDE K_SCODE_C;
     1080    15332        %INCLUDE K_ADDRESS_M;
     1081    15835                                                /* Equates                  */
     1082    15836        %GJA_UID_EQUS;
     1083    15844                                                /* VDO stuff                */
     1084    15845        %KV_VDO_E;
     1085    15881        %KV_VDOVLP_E;
     1086    15895        %KV_DATCTRCHRTYP_E;
     1087    15901        %KV_DATMOD_E;
     1088    15907        %K#LYRID_E;
     1089    15914        %K#ENTID_E;
     1090    15933                                                /* Args                     */
     1091    15934        %GJA$PARAMS(STCLASS=PARAM);
     1092    15949    1   DCL MSGCTX$ PTR;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:174  
     1093    15950                                                /* Symrefs                  */
     1094    15951    1   DCL GID_BOOTCHAN UBIN SYMREF;
     1095    15952    1   DCL GJA_HOPCOST UBIN SYMREF;
     1096    15953    1   DCL GJA_DEFNODE UBIN SYMREF;
     1097    15954    1   DCL GJA_ROUTE$ PTR SYMREF;
     1098    15955    1   DCL GJA_OSIROUTE$ PTR SYMREF;
     1099    15956    1   DCL GJA_LINKS UBIN SYMREF;
     1100    15957    1   DCL GJA_OSIMAX# UBIN SYMREF;
     1101    15958    1   DCL GJA_NM_HEAD$ PTR SYMREF;
     1102    15959    1   DCL GJA_NODE# UBIN SYMREF;
     1103    15960    1   DCL GJA_LDCT_NM UBIN SYMREF;
     1104    15961    1   DCL GJA_LDCT_BABOON UBIN SYMREF;
     1105    15962    1   DCL GJA_UID_NM UBIN(32) SYMREF;
     1106    15963    1   DCL GJA_UID_NM$ REDEF GJA_UID_NM PTR;
     1107    15964    1   DCL GJA_UID_BABOON UBIN(32) SYMREF;
     1108    15965    1   DCL GJA_UID_BABOON$ REDEF GJA_UID_BABOON PTR;
     1109    15966    1   DCL GJA_UID_NANM$ PTR SYMREF;
     1110    15967    1   DCL GJA_USRLGN_HEAD$ PTR SYMREF;
     1111    15968    1   DCL G$TCB$ PTR SYMREF READONLY;
     1112    15969    1   DCL GJA_HAND_HEAD$ PTR SYMREF;
     1113    15970    1   DCL GJA_ERRMSG_HEAD$ PTR SYMREF;
     1114    15971    1   DCL GJA_MSG_HOSTDOWN$ PTR SYMREF;
     1115    15972    1   DCL GJA_MSG_LINKDOWN$ PTR SYMREF;
     1116    15973    1   DCL GJA_MSG_DOWN$ PTR SYMREF;
     1117    15974    1   DCL GJA_HOSTRESUMED$ PTR SYMREF;
     1118    15975    1   DCL GJA_LGNTIMEDOUT$ PTR SYMREF;
     1119    15976    1   DCL GJA_NOLOGONMSG$ PTR SYMREF;
     1120    15977    1   DCL GJA_MSG_SALUTE$ PTR SYMREF;
     1121    15978    1   DCL GJA_MSG_HDR$ PTR SYMREF;
     1122    15979    1   DCL GJA_FIRST_TIME BIT(1) SYMREF;
     1123    15980    1   DCL GJA_HSTRSMED BIT(1) SYMREF;
     1124    15981    1   DCL GJA_MSG_SGSYN$ PTR SYMREF;
     1125    15982    1   DCL GJA_MSG_NOHOST$ PTR SYMREF;
     1126    15983    1   DCL GJA_MSG_UDHOST$ PTR SYMREF;
     1127    15984    1   DCL GJA_MSG_BDID$ PTR SYMREF;
     1128    15985    1   DCL GJA_MAXRDS UBIN SYMREF;
     1129    15986        %GJA_NODETBL(NAME=GJA$NODETBL,STCLASS="SYMREF");
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:175  
     1130    16010
     1131    16011        %KL_SYSLOG(FPTN=GJA_SYSLOG,LAST=",",STCLASS=SYMREF);
     1132    16035        %KL_ERRLOG(FPTN=ERRLOG,LAST=",",LVL=2,STCLASS=SYMREF);
     1133    16143    1           3 DATA CHAR(200) UNAL;
     1134    16144
     1135    16145        %KH$IO (FPTN=GJA_IO,FNC=%GH#IO_OTPCHNCTR,STPIO=YES,STCLASS=SYMREF);
     1136    16259        %FPT_TERM (FPTN=GJA_TERM,STCLASS=SYMREF);
     1137    16281        %FPT_TERM_ACK(FPTN=GJA_TERM_ACK,STCLASS=SYMREF);
     1138    16303        %FPT_CONNECT (FPTN=GJA_CONNECT,STCLASS=SYMREF);
     1139    16372        %FPT_CONNECT_ACK(FPTN=GJA_CONNECT_ACK,STCLASS=SYMREF);
     1140    16421    1   DCL GJA_CHNHI UBIN SYMREF;
     1141    16422    1   DCL GJA_CHNLOW UBIN SYMREF;
     1142    16423    1   DCL GJA_CHNLOW$ PTR SYMREF;
     1143    16424    1   DCL GJA_CHNHI$ PTR SYMREF;
     1144    16425        %KV$VDO_PRM(NAME=GJA_PARAM_VDO,LAST=",",STCLASS=SYMREF);
     1145    16466        %KV$VDOVLP_DAT2(STCLASS="",LVL=2);
     1146    16516        %KV$VDO_DAT(NAME=GJA_VDO_DAT_DAT1,STCLASS=SYMREF,LAST=",");
     1147    16561        %KV$VDOVLP_DAT1(STCLASS="",LVL=2);
     1148    16611        %KV$VDO_DAT(NAME=GJA_VDO_DAT_DAT2,STCLASS=SYMREF,LAST=",");
     1149    16656        %KV$VDOVLP_DAT2(STCLASS="",LVL=2);
     1150    16706        %KV$VDO_PRM(NAME=GJA_PROMPT_VDO,STCLASS=SYMREF,LAST=",");
     1151    16747             %KV$VDOVLP_DAT2(NAME=DAT2,STCLASS=SYMREF,LVL=2,LAST=",");
     1152    16797    1         2 TL,
     1153    16798    1           3 TYPE UBIN BYTE UNAL,
     1154    16799    1           3 LEN UBIN BYTE UNAL,
     1155    16800    1         2 VFC CHAR(1) UNAL,
     1156    16801    1         2 PROMPT CHAR(39) UNAL;
     1157    16802                                                /* Fpts                     */
     1158    16803        %FPT_AFD(FPTN=FPT_AFD);
     1159    16818        %FPT_MAKEUSR(FPTN=FPT_MAKEUSR);
     1160    16833        %FPT_RUE (FPTN=FPT_RUE);
     1161    16856                                                /* Errcodes                 */
     1162    16857        %VLP_ERRCODE(FPTN=E$CONT_NOT_PART,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CONT_NOT_ALL_PART,
             16857            SEV=%G_SEV_ERROR#);
     1163    16903        %VLP_ERRCODE(FPTN=E$CHAN_NOT_THERE,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CHAN_NOT_THERE,SEV=
             16903            %G_SEV_ERROR#);
     1164    16949        %VLP_ERRCODE(FPTN=E$NO_MORE_DEVICES,FCG=GJ,MID=A,MON='1'B,ERR#=%E$NO_MORE_DEVICES,
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:176  
             16949            SEV=%G_SEV_ERROR#);
     1165    16995        %VLP_ERRCODE(FPTN=E$ADMIN_ERR,FCG=GJ,MID=A,MON='1'B,ERR#=%E$ADMIN_ERR,SEV=
             16995            %G_SEV_ERROR#);
     1166    17041        %VLP_ERRCODE(FPTN=E$UNOWNED,FCG=GJ,MID=A,MON='1'B,ERR#=%E$UNOWNED,SEV=%G_SEV_ERROR#)
             17041            ;
     1167    17087        %VLP_ERRCODE(FPTN=E$ILGLTRANS,FCG=GJ,MID=A,MON='1'B,ERR#=%E$ILGLTRANS,SEV=
             17087            %G_SEV_ERROR#);
     1168    17133        %VLP_ERRCODE(FPTN=E$CANTPART,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CANTPART,SEV=
             17133            %G_SEV_ERROR#);
     1169    17179        %VLP_ERRCODE(FPTN=E$CHAN_NOT_PART,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CHAN_NOT_PART,SEV=
             17179            %G_SEV_ERROR#);
     1170    17225        %VLP_ERRCODE(FPTN=E$CHAN_BUSY,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CHAN_BUSY,SEV=
             17225            %G_SEV_ERROR#);
     1171    17271        %VLP_ERRCODE(FPTN=E$CONT_MUST_HAVE_DIAG,FCG=GJ,MID=A,MON='1'B,
     1172    17272                     ERR#=%E$CONT_MUST_HAVE_DIAG,SEV=%G_SEV_ERROR#);
     1173    17318        %VLP_ERRCODE(FPTN=E$CONT_OWNED,FCG=GJ,MID=A,MON='1'B,
     1174    17319                     ERR#=%E$CONT_OWNED,SEV=%G_SEV_ERROR#);
     1175    17365        %VLP_ERRCODE(FPTN=E$CHAN_OWNED,FCG=GJ,MID=A,MON='1'B,
     1176    17366                     ERR#=%E$CHAN_OWNED,SEV=%G_SEV_ERROR#);
     1177    17412        %VLP_ERRCODE(FPTN=E$NO_DEVICES,FCG=GJ,MID=A,MON='1'B,
     1178    17413                     ERR#=%E$NO_DEVICES,SEV=%G_SEV_ERROR#);
     1179    17459        %VLP_ERRCODE(FPTN=E$NOTYOURS,FCG=GJ,MID=A,MON='1'B,
     1180    17460                     ERR#=%E$NOTYOURS,SEV=%G_SEV_ERROR#);
     1181    17506        %VLP_ERRCODE(FPTN=E$CHAN_PART,FCG=GJ,MID=A,MON='1'B,
     1182    17507                     ERR#=%E$CHAN_PART,SEV=%G_SEV_ERROR#);
     1183    17553        %VLP_ERRCODE (FPTN=E$CHAN_DIAG,FCG=GJ,MID=A,MON='1'B,
     1184    17554                      ERR#=%E$CHAN_DIAG,SEV=%G_SEV_ERROR#);
     1185    17600        %VLP_ERRCODE(FPTN=E$ALLREADY_IS,FCG=GJ,MID=A,MON='1'B,
     1186    17601                     ERR#=%E$ALLREADY_IS,SEV=%G_SEV_ERROR#);
     1187    17647        %VLP_ERRCODE(FPTN=E$NOT_OWNED,FCG=GJ,MID=A,MON='1'B,
     1188    17648                     ERR#=%E$NOT_OWNED,SEV=%G_SEV_ERROR#);
     1189    17694        %VLP_ERRCODE(FPTN=E$NO_HANDLER,FCG=GJ,MID=A,MON='1'B,
     1190    17695                     ERR#=%E$NO_HANDLER,SEV=%G_SEV_ERROR#);
     1191    17741        %VLP_ERRCODE(FPTN=E$NONETMAN,FCG=GJ,MID=A,MON='1'B,
     1192    17742                     ERR#=%E$NONETMAN,SEV=%G_SEV_ERROR#,STCLASS="CONSTANT SYMDEF");
     1193    17788        %VLP_ERRCODE (FPTN=E$NOHANDLER,FCG=GJ,MID=A,MON='1'B,
     1194    17789                       ERR#=%E$NOHANDLER,SEV=%G_SEV_ERROR#);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:177  
     1195    17835        %VLP_SCODE (FPTN=HOSTKEYIN,ERR#=%S$HOST_KEYIN,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1196    17896        %VLP_SCODE (FPTN=HOSTBOOT,ERR#=%S$HOST_BOOT,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1197    17957        %VLP_SCODE (FPTN=NODEDEV,ERR#=%S$NODEDEV,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1198    18018        %VLP_SCODE (FPTN=BADFNC,ERR#=%S$BADFNC,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1199    18079
     1200    18080
     1201    18081                                                /* BASED Structures         */
     1202    18082        %KNN$ROUTE (STCLASS="BASED(ROUTE$)");
     1203    18154        %KNN$LINK (STCLASS="BASED(LINK$)");
     1204    18405    1   DCL KNN$ROUTE$ (0:0) PTR BASED (GJA_ROUTE$);
     1205    18406    1   DCL KNN$OSIROUTE$ (0:0) PTR BASED(GJA_OSIROUTE$);
     1206    18407    1   DCL BUFFER CHAR(999) BASED;
     1207    18408    1   DCL 1 TEXTC_STRING BASED,
     1208    18409    1         2 SIZE UBIN BYTE UNAL,
     1209    18410    1         2 STRING CHAR(TEXTC_STRING.SIZE) UNAL;
     1210    18411    1   DCL STRING CHAR(SIZE) BASED;
     1211    18412        %G$TCB;
     1212    18433        %G$EXCFR;
     1213    18815        %GJA$LGNCTX(STCLASS=BASED);
     1214    18900        %GJA$ERRMSG_CTX(STCLASS=BASED);
     1215    18928        %KH$CHN (STCLASS="BASED(CHN$)");
     1216    19052        %GJA$HAND_CTX(STCLASS="BASED(CTX$)");
     1217    19101        %KL_MES (FPTN=KL$MES,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1218    19124        %KL_KEYMES(FPTN=KL$KEYMES,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1219    19263        %KL_DVCERRRSP (FPTN=KL$DVCERRRSP,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1220    19316        %KL_ACQUIRE(FPTN=KL$ACQUIRE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1221    19398        %KL_AFD(FPTN=KL$AFD,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1222    19438        %KL_RELEASE(FPTN=KL$RELEASE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1223    19493        %KL_CONTROL(FPTN=KL$CONTROL,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1224    19630        %KL_SGN(FPTN=KL$SGN,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1225    19723        %KL_SGNRSP(FPTN=KL$SGNRSP,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1226    19859        %KL_ERRMSG_RQS (FPTN=KL$ERRMSG_RQS,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1227    20034        %KL_ERRMSG_RSP (FPTN=KL$ERRMSG_RSP,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1228    20110        %KL_ERRMSG_RSP (FPTN=KL$ERRMSG_RSPSZ,STCLASS=BASED,LONG=NO);
     1229    20186        %KL_CHNRSP(FPTN=KL$CHNRSP,STCLASS="BASED(GJA$PARAMS.DAT$)",MSGSIZE=
             20186            "KL$CHNRSP.MESSAGE.MSGSIZE");
     1230    20406        %KL_FEPST (FPTN=KL$FEPST,STCLASS="BASED(GJA$PARAMS.DAT$)");
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:178  
     1231    20441        %KL_NODECHG (FPTN=KL$NODECHG,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1232    20465        %KL_NODEINFO (FPTN=KL$NODEINFO,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1233    20489        %KL_TIME (FPTN=KL$TIME,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1234    20513        %KL_RQSCHN(FPTN=KL$RQSCHN,STCLASS="BASED(KL$)");
     1235    20616        %KL_CWNAK (FPTN=KL$CWNAK,STCLASS="BASED(RSP$)");
     1236    20681        %KL_RUE(FPTN=KL$RUE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1237    20785        %KL_STRTU(STCLASS="BASED(GJA$PARAMS.DAT$)");
     1238    20958        %KL_REQSTATS (NAME=KL$REQSTATS,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1239    21252        %KL_PRFRSP(FPTN=KL$PRFRSP,STCLASS="BASED(GJA$PARAMS.DAT$)",PRFSIZE=
             21252            "KL$PRFRSP.PROFILE.PRFSIZE");
     1240    21302        %KL_WRITE(FPTN=KL$WRITE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1241    21341        %KL_ADMIN(FPTN=KL$ADMIN,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1242    21502        %KL_SETNODE(FPTN=KL$SETNODE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1243    21548        %KL_CNFG_MSG (FPTN=KL$CNFG_MSG,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1244    21832        %KL_CONFIGRSP(FPTN=KL$CONFIGRSP,STCLASS="BASED(RSP$)");
     1245    21923        %KL_CONFIGRQS(FPTN=KL$CONFIGRQS,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1246    21972        %KL_CHSCRLVL(FPTN=KL$CHSCRLVL,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1247    22011        %KL_UPDOSI(FPTN=KL$UPDOSI,ADRTYP=NET,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1248    22220        %KL_OSILINKCHG(FPTN=KL$OSILINKCHG,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1249    22343        %KNN$OSIROUTE(FPTN=KNN$OSIROUTE,STCLASS="BASED(OSI$)");
     1250    22560        %KV$VDO_PRM(NAME=GJA$PROFILE_VDO,LAST=",",STCLASS=BASED);
     1251    22601        %KV$VDOVLP_DAT2(STCLASS="",LVL=2);
     1252    22651        %KV$VDO_DAT(NAME=GJA$VDO_DAT_DAT1,STCLASS=BASED,LAST=",");
     1253    22696        %KV$VDOVLP_DAT1(STCLASS="",LVL=2);
     1254    22746        %KV$VDO(NAME=KV$VDOHDR,STCLASS="BASED(GJA$PARAMS.VDO$)");
     1255    22773        %KV$VDOVLP_DAT1;
     1256    22823        %KV$VDOVLP_DAT2;
     1257    22873        %KV$VDO_DAT;
     1258    22918        %KV$VDOVLP_CG_MSGTYP;
     1259    22970        %KV$VDOVLP_CG_STA;
     1260    23021        %KV$VDOVLP_ERR;
     1261    23118        %KV$VDOVLP_FLDID;
     1262    23169        %KV$VDOVLP_MRK;
     1263    23222        %KV$VDOVLP_KEY;
     1264    23272        %KV$VDO_RQSDAT(NAME=KV_VDO_RQSDAT,STCLASS=CONSTANT,FNC=KV_VDO_FNC_RQSDAT,
     1265    23273                            MAXRCRBYTSIZ=2048,MAXNMBRCR=999,MAXNMBBYT=2048);
     1266    23321        %KV$VDO_RQSDAT(NAME=KV@VDO_RQSDAT,STCLASS=AUTO);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:179  
     1267    23369        %KV$VDI;
     1268    23440                                                /* Static                   */
     1269    23441    1   DCL VDO_BUFFER(0:767) CHAR(1) STATIC;
     1270    23442        %KV$VDO_DAT(NAME=GJA_RETURN_MSG,FNC=KV_VDO_FNC_DAT,STCLASS=STATIC,
     1271    23443                    LAST=",",VLP=YES);
     1272    23488        %KV$VDOVLP_DAT1(STCLASS=STATIC,LST=YES,LAST=",",LVL=2);
     1273    23538        %KL_RETURN(STCLASS=STATIC,LVL=2);
     1274    23572        %KV$VDO_DAT(NAME=GJA_CHN_RSP,FNC=KV_VDO_FNC_DAT,STCLASS=STATIC,LAST=",",VLP=YES);
     1275    23617        %KV$VDOVLP_DAT2(STCLASS=STATIC,LST=YES,LAST=",",LVL=2);
     1276    23667        %KL_ADMIN(FPTN=ADMIN,STCLASS=STATIC,LVL=2,LAST=",");
     1277    23828        %KH$CHN(NAME=CHN,STCLASS=STATIC,LVL=3,LAST=";");
     1278    23952        %KL_RQSCHN (FPTN=GJA_RQSCHN,STCLASS=SYMREF);
     1279    24055        %KL_ADMIN (FPTN=GJA_ADMIN,STCLASS=SYMREF);
     1280    24216        %KL_HDR (FPTN=KL$HDR,STCLASS="BASED(KL$)");
     1281    24297                                                /* AUTO                     */
     1282    24298    1   DCL LINK$ PTR;
     1283    24299    1   DCL ROUTE$ PTR;
     1284    24300    1   DCL STARTCHN$ PTR;
     1285    24301    1   DCL KL$ PTR;
     1286    24302    1   DCL I UBIN;
     1287    24303    1   DCL J UBIN;
     1288    24304    1   DCL CHN$ PTR;
     1289    24305    1   DCL CTX$ PTR;
     1290    24306    1   DCL CTX REDEF CTX$ UBIN(32);
     1291    24307    1   DCL UID UBIN(32);
     1292    24308    1   DCL UID$ REDEF UID PTR;
     1293    24309    1   DCL THAND$ PTR;
     1294    24310    1   DCL TCHN$ PTR;
     1295    24311    1   DCL LVL2$ PTR;
     1296    24312    1   DCL LVL3$ PTR;
     1297    24313    1   DCL RNGFLG BIT(1);
     1298    24314    1   DCL WHO UBIN;
     1299    24315    1   DCL NMI$ PTR;
     1300    24316    1   DCL SVMSG$ PTR;
     1301    24317    1   DCL OSI$ PTR;
     1302    24318    1   DCL NMID$ PTR;
     1303    24319    1   DCL NMID REDEF NMID$ UBIN(32);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:180  
     1304    24320    1   DCL SVCHN$ PTR;
     1305    24321    1   DCL SVCHAN UBIN;
     1306    24322    1   DCL SVATTR BIT(16);
     1307    24323    1   DCL MSGSIZ UBIN;
     1308    24324    1   DCL SIZE UBIN;
     1309    24325    1   DCL RSP$ PTR;
     1310    24326    1   DCL NLINES UBIN;
     1311    24327    1   DCL CONTADDR UBIN;
     1312    24328    1   DCL BASECHAN UBIN;
     1313    24329    1   DCL LASTCHAN UBIN;
     1314    24330    1   DCL CHAN UBIN;
     1315    24331    1   DCL CHANLO UBIN;
     1316    24332    1   DCL CHANHI UBIN;
     1317    24333    1   DCL SUB UBIN;
     1318    24334    1   DCL SUBLO UBIN;
     1319    24335    1   DCL SUBHI UBIN;
     1320    24336    1   DCL SUBSUB UBIN;
     1321    24337    1   DCL SUBSUBLO UBIN;
     1322    24338    1   DCL SUBSUBHI UBIN;
     1323    24339    1   DCL LEV UBIN;
     1324    24340    1   DCL MAXLEV UBIN;
     1325    24341        %B$TERMINAL_ID (FPTN=KL$TERMINAL_ID,STCLASS=AUTO,ALGN=WALIGNED);
     1326    24370        %B$TERMINAL_ID (FPTN=TERMID_C,STCLASS=CONSTANT);
     1327    24399        %KL_MES (FPTN=GJA_STOK,STCLASS=CONSTANT,CODE=IGA_STOK);
     1328    24422        %KL_NA_INFO (FPTN=NA,STCLASS=AUTO);
     1329    24471        %KL_HNDCMN_INFO (FPTN=HNDCMN,STCLASS=AUTO,LVL=1,LAST=";");
     1330    24551        %B$TERMINAL_ID (FPTN=TERMLO,STCLASS=AUTO,ALGN=WALIGNED);
     1331    24580        %B$TERMINAL_ID (FPTN=TERMHI,STCLASS=AUTO,ALGN=WALIGNED);
     1332    24609        %KL_SGNRSP (FPTN=SGNRSP,STCLASS=AUTO,RSPSIZ=50);
     1333    24745        %KL_ADMIN (FPTN=ADMIN,STCLASS=AUTO,LAST=",");
     1334    24906        %KH$CHN(STCLASS=AUTO,LVL=2);
     1335    25030        %KL_NODECHG(FPTN=NODECHG,STCLASS=AUTO);
     1336    25054        %KL_UPDOSI(FPTN=UPDOSI,STCLASS=AUTO);
     1337    25263        %KL_OSILINKCHG(FPTN=OSILINKCHG,STCLASS=AUTO);
     1338    25386                                                /* Entrys                   */
     1339    25387    1   DCL GJA$Q_MSG ENTRY(6);
     1340    25388    1   DCL GJA$WRITE ENTRY(6);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:181  
     1341    25389    1   DCL GIJ$INITDUMP ENTRY;
     1342    25390    1   DCL KVB$GETSYS ENTRY(2) ALTRET;
     1343    25391    1   DCL KVB$RLSSYS ENTRY(2) ALTRET;
     1344    25392    1   DCL KVB$RLS2NSYS ENTRY(2) ALTRET;
     1345    25393    1   DCL GJA$DISOLVE_LGNUSR_CTX ENTRY(1);
     1346    25394    1   DCL GJA$DISOLVE_ERRMSG_CTX ENTRY(1);
     1347    25395    1   DCL KVB$GET2NSYS ENTRY(2) ALTRET;
     1348    25396    1   DCL GJA$BLD_CTX ENTRY(3) ALTRET;
     1349    25397    1   DCL GJA$CHK_TRM_RNG ENTRY(2) ALTRET;
     1350    25398    1   DCL GJA$LOGON_RESPONCE ENTRY(1) ALTRET;
     1351    25399    1   DCL GJA$LOGON_REQUEST ENTRY(3);
     1352    25400    1   DCL GJA$LOGON_REQUEST_AGAIN ENTRY(1) ALTRET;
     1353    25401    1   DCL GJA$GET_CONFIG_INFO ENTRY (1);
     1354    25402    1   DCL GJA$UPDATE_CHNTBL ENTRY(3) ALTRET;
     1355    25403    1   DCL GJA$GET_CHNTBL_PTR ENTRY(2) ALTRET;
     1356    25404    1   DCL GJA$SEND_MSG ENTRY(4) ALTRET;
     1357    25405    1   DCL GJA$NETWORK_MANAGER ENTRY(2) ALTRET;
     1358    25406    1   DCL GJA$LINEPROFILE ENTRY(2) ALTRET;
     1359    25407    1   DCL GIJ$DUMPMSG ENTRY(1);
     1360    25408    1   DCL KHI$IO_OTP ENTRY(2) ALTRET;
     1361    25409    1   DCL GJA$HOST_RESUMED ENTRY ALTRET;
     1362    25410    1   DCL KHC$UTS ENTRY(1) ALTRET;
     1363    25411    1   DCL GJA$NA_INFO ENTRY(1) ALTRET;
     1364    25412                                                /* Macro                    */
     1365    25413        /*
     1366    25414          This macro is used later in GJA$ADMIN to extract some sort of
     1367    25415          header out of a message and place it in a dynamic buffer in the
     1368    25416          node admin buffer pool.
     1369    25417        */
     1370    25418        %MACRO EXTRACT_MESSAGE(DESTPTR=GJA_DESTPTR);
     1371    25419           IF (GJA$HAND_CTX.NODE ~= GJA_DEFNODE) THEN RETURN;
     1372    25420           IF DESTPTR ~= ADDR(NIL)              /* Release old buffer       */
     1373    25421           THEN CALL KVB$RLSSYS((DESTPTR->TEXTC_STRING.SIZE+2)/2,DESTPTR);
     1374    25422           SIZE=(GJA$PARAMS.DATSIZE-SIZEC(KL$MES)+2)/2;
     1375    25423           CALL KVB$GETSYS(SIZE,DESTPTR);
     1376    25424           SIZE=GJA$PARAMS.DATSIZE-SIZEC(KL$MES);
     1377    25425           DESTPTR->TEXTC_STRING.SIZE=SIZE;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:182  
     1378    25426           DESTPTR->TEXTC_STRING.STRING=PINCRW(GJA$PARAMS.DAT$,SIZEW(KL$MES))->BUFFER;
     1379    25427        %MEND;
     1380    25428        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:183  
     1381    25429    1      CTX$ = MSGCTX$;
     1382    25430    1      UID$ = MSGCTX$;
     1383    25431    1      WHO = GJA$HAND_CTX.WHO;
     1384    25432        /*
     1385    25433          try and prevent the handler from ever getting blocked by tracking the
     1386    25434          number of messages received.  When enough messages have been received
     1387    25435          go ahead an reissue the request dat.  The idea is to keep the handler
     1388    25436          flush with credits
     1389    25437        */
     1390    25438    1      IF WHO = %GJA_UID_HANDLER THEN
     1391    25439    2      DO;
     1392    25440    2           GJA$HAND_CTX.RDSOUT = GJA$HAND_CTX.RDSOUT - 1;
     1393    25441    2           IF (GJA_MAXRDS - (GJA_MAXRDS/4) >= GJA$HAND_CTX.RDSOUT) AND NOT GJA$HAND_CTX
             25441                    .BLK THEN
     1394    25442    3           DO;
     1395    25443    3                KV@VDO_RQSDAT = KV_VDO_RQSDAT;
     1396    25444    3                CALL GJA$Q_MSG(CTX$,SIZEC(KV_VDO_RQSDAT),KV@VDO_RQSDAT);
     1397    25445    3                GJA$HAND_CTX.RDSOUT = GJA_MAXRDS;
     1398    25446    3                END;
     1399    25447    2           END;
     1400    25448    1      IF GJA$PARAMS.DAT$ = ADDR(NIL) THEN
     1401    25449    2      DO;
     1402    25450        /*    CALL GJA$NETWORK_MANAGER(ERRLOGBUF);  */
     1403    25451    2           RETURN;
     1404    25452    2           END;
     1405    25453
     1406    25454    2      DO CASE(KL$MES.CODE);                /* KL$MES.CODE CASE         */
     1407    25455
     1408    25456    2       CASE (IGA_CRASHFEP);
     1409    25457    2         IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM THEN
     1410    25458    2              RETURN;
     1411    25459    2         CALL M$SCREECH(HOSTKEYIN);
     1412    25460                  /*S* SCREECH_CODE: GJA-S$HOST_KEYIN
     1413    25461                       TYPE:SCREECH
     1414    25462                       MESSAGE: Host KEYIN request.
     1415    25463                       REMARKS: Somebody asked us to DIE
     1416    25464         */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:184  
     1417    25465        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:185  
     1418    25466    2       CASE (IGA_CRASHFEP_BF);
     1419    25467    2         IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM THEN
     1420    25468    2              RETURN;
     1421    25469    2         CALL M$SCREECH(BADFNC);
     1422    25470        /*S*    SCREECH_CODE: GJA-S$BADFNC
     1423    25471                TYPE: SCREECH
     1424    25472                MESSAGE: Bad message in host icq.
     1425    25473                REMARKS: An illegal message was found in the hosts ICQ.
     1426    25474        */
     1427    25475        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:186  
     1428    25476    2       CASE (IGA_BOOTFEP);
     1429    25477    2         IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM THEN
     1430    25478    2              RETURN;
     1431    25479    2         CALL M$SCREECH(HOSTBOOT);
     1432    25480                  /*S* SCREECH_CODE: GJA-S$HOST_BOOT
     1433    25481                       TYPE:SCREECH
     1434    25482                       MESSAGE: Host BOOT KEYIN request.
     1435    25483                       REMARKS: Somebody asked us to DIE
     1436    25484         */
     1437    25485        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:187  
     1438    25486    2       CASE (IGA_SETNODE);       /* Set node and time from network     */
     1439    25487    2         GJA_NODE# = KL$SETNODE.NODE#;
     1440    25488        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:188  
     1441    25489
     1442    25490    2       CASE(IGA_CONTROL,IGA_CONTROL_INIT);
     1443    25491        /*
     1444    25492          These messages are passed back and fourth between the network
     1445    25493          manager and the handler (or BABOON) via Node Admin.  The basic
     1446    25494          principal is to see who sent the message and if the sender was
     1447    25495          the handler or BABOON, send the message to the network manager;
     1448    25496          otherwise if the sender was the Network manager, send the message
     1449    25497          to the appropriate handler (or BABOON).  Note that the same template
     1450    25498          is used for both messages.  They have the same starting format.
     1451    25499        */
     1452    25500    2         IF WHO = %GJA_UID_NM
     1453    25501    3         THEN DO;                          /* Message from NETMAN      */
     1454    25502    3              IF KL$CONTROL.HANDLER='BABOON'
     1455    25503    4              THEN DO;                     /* Send this off to BABOON  */
     1456    25504    4                   CALL GJA$Q_MSG(GJA_UID_BABOON,
     1457    25505    4                     GJA$PARAMS.DATSIZE,KL$CONTROL);
     1458    25506    4                   END;                    /* Send this off to BABOON  */
     1459    25507    4              ELSE IF KL$CONTROL.HANDLER='NODEADMN' THEN DO;
     1460    25508    4                        CALL GJA$NA_INFO (KL$CONTROL);
     1461    25509    4                        CALL GJA$NETWORK_MANAGER (KL$CONTROL,GJA$PARAMS.DATSIZE);
     1462    25510    4                        END;
     1463    25511    4                   ELSE DO;
     1464    25512    4                        CTX$=GJA_HAND_HEAD$;
     1465    25513    5   HANDLER_SEARCH:      DO WHILE (CTX$ ~= ADDR(NIL));
     1466    25514    5                             IF KL$CONTROL.HANDLER = GJA$HAND_CTX.NAME
     1467    25515    6                             THEN DO;      /* Handler found            */
     1468    25516    6                                  CALL GJA$SEND_MSG(CTX$,KL$CONTROL,GJA$PARAMS.DATSIZE)
     1469    25517    7                                  WHENALTRETURN DO;
     1470    25518    7                                       ALTRETURN;
     1471    25519    7                                       END;
     1472    25520    6                                  EXIT HANDLER_SEARCH;
     1473    25521    6                                  END;     /* Handler found            */
     1474    25522    5                             CTX$=GJA$HAND_CTX.LNK$;
     1475    25523    5                             END;
     1476    25524    4                        IF CTX$ = ADDR(NIL)
     1477    25525    5                        THEN DO;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:189  
     1478    25526    5                             KL$CONTROL.RESULTS=E$NOHANDLER;
     1479    25527             /*E* ERROR: GJA-%E$NOHANDLER-0
     1480    25528                  MESSAGE: There is no handler with the specified name.
     1481    25529              */
     1482    25530    5                             CALL GJA$NETWORK_MANAGER(KL$CONTROL,SIZEC(KL$CONTROL));
     1483    25531    5                             END;
     1484    25532    4                        END;               /* Send this to a handler   */
     1485    25533    3              END;                         /* Message from NETMAN      */
     1486    25534    3         ELSE DO;                /* Message from handler or BABOON     */
     1487    25535    3              KL$CONTROL.HANDLER = GJA$HAND_CTX.NAME;
     1488    25536    3              IF KL$MES.CODE = IGA_CONTROL_INIT
     1489    25537    3              THEN
     1490    25538    3                   CALL GJA$NETWORK_MANAGER(KL$CONTROL,GJA$PARAMS.DATSIZE);
     1491    25539    4              ELSE DO;
     1492    25540    4                   I = KL$CONTROL.SRCE_NODE;
     1493    25541    4                   CALL FIND_NODE(I,CTX$)
     1494    25542    5                   WHENRETURN DO;
     1495    25543    5                        CALL GJA$SEND_MSG(CTX$,KL$CONTROL,GJA$PARAMS.DATSIZE);
     1496    25544    5                        END;
     1497    25545    4                   END;
     1498    25546    3              END;               /* Message from handler or BABOON     */
     1499    25547        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:190  
     1500    25548    2       CASE(IGA_REQSTATS);
     1501    25549    3         IF WHO = %GJA_UID_NM THEN DO;
     1502    25550    3              CTX$ = GJA_HAND_HEAD$;
     1503    25551    4              DO WHILE(CTX$ ~= ADDR(NIL));
     1504    25552    4                   IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM
     1505    25553    4                   THEN
     1506    25554    4                        CALL GJA$SEND_MSG(CTX$,KL$REQSTATS,SIZEC(KL$REQSTATS));
     1507    25555    4                   CTX$ = GJA$HAND_CTX.LNK$;
     1508    25556    4                   END;                    /* DO WHILE                 */
     1509    25557    3              END;                         /* IF UID = NM              */
     1510    25558    3         ELSE DO;
     1511    25559    3              KL$REQSTATS.HANDLER = GJA$HAND_CTX.NAME;
     1512    25560    3              I = KL$REQSTATS.SRCE_NODE;
     1513    25561    3              CALL FIND_NODE(I,CTX$)
     1514    25562    4              WHENRETURN DO;
     1515    25563    4                   CALL GJA$SEND_MSG(CTX$,KL$REQSTATS,GJA$PARAMS.DATSIZE);
     1516    25564    4                   END;
     1517    25565    3              END;                         /* ELSE                     */
     1518    25566        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:191  
     1519    25567    2       CASE(IGA_ADMIN);
     1520    25568        /*
     1521    25569          This is an administrative request or responce.  If the message
     1522    25570          is from the network manager, we check the channel involved to see if
     1523    25571          the operation is legal from the node admin standpoint.  If not, we
     1524    25572          send the same message back to the network manager with the
     1525    25573          appropriate error code.  If the request looks O.K., we foward it to
     1526    25574          the handler (or BABOON) as appropriate.  The handler will attempt to
     1527    25575          perform the operation indicated and then send the same message back
     1528    25576          to Node Admin.  If the operation was performed, Node Admin will
     1529    25577          update his channel table (if necessary), and send the message up to
     1530    25578          the network manager, indicating the operation was performed.
     1531    25579        */
     1532    25580    3   ADMIN: DO;
     1533    25581    3              UID$ = ADDR(NIL);
     1534    25582    3              ADMIN = KL$ADMIN;
     1535    25583    3              WHO = GJA$HAND_CTX.WHO;
     1536    25584    3              IF WHO = %GJA_UID_NM
     1537    25585    3              THEN
     1538    25586    3                   ADMIN.RESULTS = '0'B;
     1539    25587    3              TERMLO = KL$ADMIN.TERMID_LO;
     1540    25588    3              TERMHI = KL$ADMIN.TERMID_HI;
     1541    25589    4              CALL GJA$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN DO;
     1542    25590                      /*N* ??????*/
     1543    25591    4                   END;                    /* WHENALTRETURN            */
     1544    25592    3              CHANLO = TERMLO.TERM.CHANNEL;
     1545    25593    3              CHANHI = TERMHI.TERM.CHANNEL;
     1546    25594    3              SUBLO = TERMLO.TERM.SUBDEVICE;
     1547    25595    3              SUBHI = TERMHI.TERM.SUBDEVICE;
     1548    25596    3              SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;
     1549    25597    3              SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;
     1550    25598    4              IF WHO = %GJA_UID_NM THEN DO;
     1551    25599    5                   CALL CHN_HANDLER WHENALTRETURN DO;
     1552    25600    5                        EXIT ADMIN;
     1553    25601    5                        END;
     1554    25602    4                   END;
     1555    25603    3              KL$TERMINAL_ID = '0'B;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:192  
     1556    25604    3              KL$TERMINAL_ID.LEV = TERMLO.LEV;
     1557    25605    4              DO CHAN = CHANLO TO CHANHI BY 128;
     1558    25606    5                   DO SUB = SUBLO TO SUBHI;
     1559    25607    6                        DO SUBSUB = SUBSUBLO TO SUBSUBHI;
     1560    25608    6                             KL$TERMINAL_ID.TERM.CHANNEL = CHAN;
     1561    25609    6                             KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;
     1562    25610    6                             KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;
     1563    25611    7                             CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN
             25611                                      DO;
     1564    25612    7                                  ADMIN.RESULTS=E$CHAN_NOT_THERE;
     1565    25613    7                                  EXIT ADMIN;
     1566    25614    7                                  END;
     1567    25615    6                             IF UID$ = ADDR(NIL) THEN
     1568    25616    6                                  UID$ = KH$CHN.HAND$;
     1569    25617    6                             IF KH$CHN.HAND$ = ADDR(NIL)
     1570    25618    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_PARTITION
     1571    25619    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_PARTITION_DIAG
     1572    25620    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_RETURN
     1573    25621    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_CHNTBL
     1574    25622    6                             THEN ADMIN.RESULTS = E$NOT_OWNED;
     1575    25623        /*E* ERROR:  GJA-E$NO_HANDLER
     1576    25624             MESSAGE:  Specified handler is not currently running.
     1577    25625        */
     1578    25626        /*E* ERROR:  GJA-E$NOT_OWNED
     1579    25627             MESSAGE:  Operation illegal on an unowned channel
     1580    25628        */
     1581    25629    6                             IF (KL$ADMIN.FNC~=%KHA_FNC_RETURN) AND
     1582    25630    6                               (KL$ADMIN.FNC~=%KHA_FNC_CHNTBL) AND
     1583    25631    6                               (KH$CHN.STT=%KH#CHN_STT_PRT) AND
     1584    25632    6                               (WHO=%GJA_UID_NM)
     1585    25633    6                             THEN ADMIN.RESULTS=E$CHAN_PART;
     1586    25634        /*E* ERROR:  GJA-E$CHAN_PART
     1587    25635             MESSAGE:  Operation illegal on a partitioned channel.
     1588    25636        */
     1589    25637    6                             IF KH$CHN.STT = %KH#CHN_STT_DIAG
     1590    25638    6                             THEN
     1591    25639    6                                  ADMIN.RESULTS = E$CHAN_DIAG;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:193  
     1592    25640                            /*E* ERROR: GJA-%E$CHAN_DIAG
     1593    25641                                 MESSAGE: That channels is being used for diagnostics.
     1594    25642                             */
     1595    25643
     1596    25644
     1597    25645    6                             IF WHO=%GJA_UID_HANDLER AND KL$ADMIN.FNC=%
             25645                                      KHA_FNC_PARTITION THEN
     1598    25646    6                                  ADMIN.HANDLER = GJA$HAND_CTX.NAME;
     1599    25647    6                             IF ADMIN.RESULTS
     1600    25648    6                             THEN EXIT ADMIN;
     1601    25649
     1602    25650    6                             IF WHO = %GJA_UID_NM
     1603    25651    6                             THEN
     1604    25652    7   CASEFNC:                  DO CASE(KL$ADMIN.FNC);
     1605    25653
     1606    25654    7                              CASE(%KHA_FNC_CHNTBL);
     1607    25655    7                                UID$ = ADDR(NIL);
     1608    25656    7                                ADMIN.KH$CHN = KH$CHN;
     1609    25657        /*                           IF KH$CHN.VDI$ ~= ADDR(NIL) THEN
     1610    25658                                        KH$CHN.SPEED = KH$CHN.VDI$->KV$VDI.LINSPD; */
     1611    25659    7                                EXIT ADMIN;
     1612    25660
     1613    25661
     1614    25662
     1615    25663    7                              CASE (%KHA_FNC_PARTITION);
     1616    25664    7                                IF KH$CHN.HAND$ = ADDR(NIL)
     1617    25665    7                                THEN
     1618    25666    7                                     KH$CHN.STT = %KH#CHN_STT_PRT;
     1619    25667    7                                ELSE
     1620    25668    8                                DO;
     1621    25669    8                                     TCHN$ = GJA_USRLGN_HEAD$;
     1622    25670    9                                     DO WHILE TCHN$ ~= ADDR(NIL);
     1623    25671    9                                          IF KL$TERMINAL_ID = TCHN$->GJA$LGNCTX.
             25671                                                   TERMINAL_ID
     1624    25672    9                                            AND KH$CHN.AUTLGN THEN
     1625    25673   10                                          DO;
     1626    25674   10                                               ADMIN.RESULTS = E$CANTPART;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:194  
     1627    25675                                     /*E* ERROR: GJA-%E$CANTPART
     1628    25676                 MESSAGE: The channel you attempted to partition is currently logging on. */
     1629    25677   10                                               EXIT ADMIN;
     1630    25678   10                                               END;
     1631    25679    9                                          TCHN$ = TCHN$->GJA$LGNCTX.LNK$;
     1632    25680    9                                          END;
     1633    25681    8                                     END;
     1634    25682
     1635    25683    7                              CASE(%KHA_FNC_RETURN);
     1636    25684    7                                IF KH$CHN.STT ~= %KH#CHN_STT_PRT
     1637    25685    8                                THEN DO;
     1638    25686    8                                     ADMIN.RESULTS=E$CHAN_NOT_PART;
     1639    25687    8                                     EXIT ADMIN;
     1640    25688    8                                     END;
     1641    25689        /*E* ERROR:   GJA-%E$CHAN_NOT_PART
     1642    25690             MESSAGE: This channel was never partitioned
     1643    25691        */
     1644    25692
     1645    25693
     1646    25694                       /* See if there is a handler that wants this one     */
     1647    25695    7                                CTX$ = GJA_HAND_HEAD$;
     1648    25696    8                                DO WHILE (CTX$ ~= ADDR(NIL));
     1649    25697    8                                     IF KH$CHN.RESOURCE = GJA$HAND_CTX.RES
     1650    25698    8                                       AND (GJA$HAND_CTX.ATTR & ~KH$CHN.ATTR) = '0'B
     1651    25699    9                                     THEN DO;
     1652    25700    9                                          KH$CHN.HAND$ = CTX$;
     1653    25701    9                                          UID$ = CTX$;
     1654    25702    9                                          KH$CHN.SYSID = GJA$HAND_CTX.SYSID;
     1655    25703    9                                          CALL UPDATE_SUBS ( KH$CHN );
     1656    25704    9                                          EXIT CASEFNC;
     1657    25705    9                                          END;
     1658    25706    8                                     CTX$ = GJA$HAND_CTX.LNK$;
     1659    25707    8                                     END;
     1660    25708                                                /* Could not find a handler */
     1661    25709    7                                KH$CHN.STT = %KH#CHN_STT_UN_INT;
     1662    25710                      /*E* ERROR: GJA-%E$UNOWNED
     1663    25711                           MESSAGE: Return attempted on an unowned channel.
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:195  
     1664    25712                           MESSAGE1: No handler currently running has the same
     1665    25713                                     res and attr as the chan in your command.
     1666    25714                      */
     1667    25715    7                                END;       /* KL$ADMIN.FNC CASE        */
     1668    25716    6                             END;          /* DO SUBSUB                */
     1669    25717    5                        END;               /* DO SUB                   */
     1670    25718    4                   END;                    /* DO CHAN                  */
     1671    25719    3              END;                         /* ADMIN                    */
     1672    25720
     1673    25721    2         IF KL$ADMIN.ORIGIN ~= 'NODEADMN'
     1674    25722    3         THEN DO;
     1675    25723    3              IF WHO ~= %GJA_UID_NM OR UID$ = ADDR(NIL) OR ADMIN.RESULTS ~= '0'B
     1676    25724    3              THEN
     1677    25725    3                   IF KL$ADMIN.ORIGIN = 'KHA$ADMN'
     1678    25726    3                   THEN
     1679    25727    3                        CALL GJA$NETWORK_MANAGER(ADMIN,SIZEC(ADMIN));
     1680    25728    4                   ELSE DO;
     1681    25729    4                        I = ADMIN.SRCE_NODE;
     1682    25730    4                        CALL FIND_NODE(I,CTX$)
     1683    25731    5                        WHENRETURN DO;
     1684    25732    5                             CALL GJA$SEND_MSG(CTX$,ADMIN,LENGTHC(ADMIN));
     1685    25733    5                             END;
     1686    25734    4                        END;
     1687    25735    3              ELSE
     1688    25736    3                   CALL GJA$SEND_MSG(UID,ADMIN,SIZEC(KL$ADMIN));
     1689    25737    3              END;
     1690    25738        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:196  
     1691    25739    2       CASE(IGA_RESET);
     1692    25740    2         KL$ = ADDR(VDO_BUFFER);
     1693    25741    2         KL$HDR = ADDR(KL$CNFG_MSG)->KL$HDR;
     1694    25742    2         MSGSIZ = SIZEC(GJA_VDO_DAT_DAT1) + SIZEC(KL$HDR);
     1695    25743    2         TERMLO = KL$CNFG_MSG.TERMID_LO;
     1696    25744    2         TERMHI = KL$CNFG_MSG.TERMID_HI;
     1697    25745    2         CHANLO = TERMLO.TERM.CHANNEL;
     1698    25746    2         CHANHI = TERMHI.TERM.CHANNEL;
     1699    25747    2         SUBLO = TERMLO.TERM.SUBDEVICE;
     1700    25748    2         SUBHI = TERMHI.TERM.SUBDEVICE;
     1701    25749    2         SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;
     1702    25750    2         SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;
     1703    25751    2         KL$TERMINAL_ID = '0'B;
     1704    25752    2         KL$TERMINAL_ID.LEV = TERMLO.LEV;
     1705    25753    3         DO CHAN = CHANLO TO CHANHI BY 128;
     1706    25754    4              DO SUB = SUBLO TO SUBHI;
     1707    25755    5                   DO SUBSUB = SUBSUBLO TO SUBSUBHI;
     1708    25756    5                        KL$TERMINAL_ID.TERM.CHANNEL = CHAN;
     1709    25757    5                        KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;
     1710    25758    5                        KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;
     1711    25759    5                        NA = KL$CNFG_MSG.NA;
     1712    25760    5                        CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,KL$CNFG_MSG.KHA)
     1713    25761    6                        WHENALTRETURN DO;
     1714    25762    6                             KL$HDR.RESULTS = E$CHAN_NOT_THERE;
     1715    25763    6                             GOTO SEND_RESET_NAK;
     1716    25764    6                             END;          /* WHENALTRETURN            */
     1717    25765    5                        END;               /* DO SUBSUB                */
     1718    25766    4                   END;                    /* DO SUB                   */
     1719    25767    3              END;                         /* DO CHAN                  */
     1720    25768    2   SEND_RESET_NAK:;
     1721    25769    2         CALL GJA$SEND_MSG(MSGCTX$,KL$HDR,SIZEC(KL$HDR));
     1722    25770    2         RETURN;
     1723    25771        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:197  
     1724    25772    2       CASE (IGA_CHNDISP);
     1725    25773    2         ADMIN = KL$ADMIN;
     1726    25774    2         WHO = GJA$HAND_CTX.WHO;
     1727    25775    2         IF WHO = %GJA_UID_NM
     1728    25776    2         THEN
     1729    25777    2              ADMIN.RESULTS = '0'B;
     1730    25778    2         TERMLO = KL$ADMIN.TERMID_LO;
     1731    25779    2         TERMHI = KL$ADMIN.TERMID_HI;
     1732    25780    3         CALL GJA$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN DO;
     1733    25781                      /*N* ??????*/
     1734    25782    3              END;                         /* WHENALTRETURN            */
     1735    25783    2         KL$TERMINAL_ID = '0'B;
     1736    25784    2         KL$TERMINAL_ID.TERM.TERM_NAME = ' ';
     1737    25785    2         TERMHI.TERM.TERM_NAME = ' ';
     1738    25786    2         TERMLO.TERM.TERM_NAME = ' ';
     1739    25787    2         LEV = TERMLO.LEV;
     1740    25788    2         MAXLEV = TERMHI.LEV;
     1741    25789    2         ADMIN.TYPE = 0;
     1742    25790    2         IF TERMLO = TERMHI THEN
     1743    25791    3         DO;
     1744    25792    4              CALL GJA$GET_CHNTBL_PTR(TERMHI,CHN$) WHENRETURN DO;
     1745    25793    4                   ADMIN.TYPE = 1;
     1746    25794    4                   ADMIN.KH$CHN = KH$CHN;
     1747    25795    4                   ADMIN.RESULTS = '0'B;
     1748    25796    4                   END;
     1749    25797    4              WHENALTRETURN DO;
     1750    25798    4   BADLEV:         ADMIN.TYPE = 1;
     1751    25799    4                   ADMIN.RESULTS = E$CHAN_NOT_THERE;
     1752    25800    4                   END;
     1753    25801    3              CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     1754    25802    3              RETURN;
     1755    25803    3              END;                         /* if only one channel      */
     1756    25804
     1757    25805    2         IF TERMHI.TERM.CHANNEL >= (GJA_CHNHI/128)*128 THEN
     1758    25806    3         DO;
     1759    25807    3              TERMHI.TERM.CHANNEL = (GJA_CHNHI/128)*128;
     1760    25808    3              KL$TERMINAL_ID = TERMHI;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:198  
     1761    25809    3              KL$TERMINAL_ID.TERM.SUBDEVICE = 0;
     1762    25810    3              KL$TERMINAL_ID.TERM.SUBSUBDEVICE = 0;
     1763    25811    4              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;
     1764    25812    4                   TERMHI.LEV = TERMHI.LEV - 1;
     1765    25813    4                   KL$TERMINAL_ID.LEV = TERMHI.LEV;
     1766    25814    5                   CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;
     1767    25815    5                        TERMHI.LEV = %TERMINAL_ID_LEV_CHAN#;
     1768    25816    5                        END;
     1769    25817    4                   END;
     1770    25818    3              END;
     1771    25819
     1772    25820    3         DO CASE(LEV);                /* what lev is the request for ?*/
     1773    25821    3          CASE(%TERMINAL_ID_LEV_CHAN#);
     1774    25822    3            SUBLO = 0;
     1775    25823    3            SUBHI = 65535;
     1776    25824    3            SUBSUBLO = SUBLO;
     1777    25825    3            SUBSUBHI = SUBHI;
     1778    25826    3          CASE(%TERMINAL_ID_LEV_SUBCHAN#);
     1779    25827    3            SUBLO = TERMLO.TERM.SUBDEVICE;
     1780    25828    3            SUBHI = TERMHI.TERM.SUBDEVICE;
     1781    25829    3            SUBSUBLO = 0;
     1782    25830    3            SUBSUBHI = 65535;
     1783    25831    3          CASE(%TERMINAL_ID_LEV_SUBSUBCHAN#);
     1784    25832    3            SUBLO = TERMLO.TERM.SUBDEVICE;
     1785    25833    3            SUBHI = TERMHI.TERM.SUBDEVICE;
     1786    25834    3            SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;
     1787    25835    3            SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;
     1788    25836    3          CASE(ELSE);
     1789    25837    3            GOTO BADLEV;
     1790    25838    3            END;                           /* do case on lev           */
     1791    25839
     1792    25840    2         CHANLO = TERMLO.TERM.CHANNEL;
     1793    25841    2         CHANHI = TERMHI.TERM.CHANNEL;
     1794    25842    3   CHAN1: DO CHAN = CHANLO TO CHANHI BY 128;
     1795    25843    3              KL$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN#;
     1796    25844    3              KL$TERMINAL_ID.TERM.CHANNEL = CHAN;
     1797    25845    3              KL$TERMINAL_ID.TERM.SUBDEVICE = 0;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:199  
     1798    25846    3              KL$TERMINAL_ID.TERM.SUBSUBDEVICE = 0;
     1799    25847    4   CHNOK:     CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENRETURN DO;
     1800    25848    4                   IF KH$CHN.DVCID = '0'B THEN
     1801    25849    4                        EXIT CHNOK;
     1802    25850    4                   IF KL$TERMINAL_ID.LEV >= TERMLO.LEV THEN
     1803    25851    5                   DO;
     1804    25852    5                        ADMIN.KH$CHN = KH$CHN;
     1805    25853    5                        CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     1806    25854    5                        END;
     1807    25855    4                   LVL2$ = KH$CHN.SUB$;
     1808    25856    5                   DO WHILE LVL2$ ~= ADDR(NIL);
     1809    25857    5                        TCHN$ = LVL2$;
     1810    25858    6                        DO CASE(TERMLO.LEV);
     1811    25859    6                         CASE(%TERMINAL_ID_LEV_CHAN#);
     1812    25860    6                           ADMIN.KH$CHN = TCHN$->KH$CHN;
     1813    25861    6                           CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     1814    25862    6                         CASE(%TERMINAL_ID_LEV_SUBCHAN#);
     1815    25863    6   DOCHECKS:               IF TERMLO.LEV <= TCHN$->KH$CHN.TERMID.LEV AND
     1816    25864    6                             SUBLO <= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE AND
     1817    25865    6                             SUBHI >= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE THEN
     1818    25866    7                           DO;
     1819    25867    7                                ADMIN.KH$CHN = TCHN$->KH$CHN;
     1820    25868    7                                CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     1821    25869    7                                END;
     1822    25870    6                         CASE(%TERMINAL_ID_LEV_SUBSUBCHAN#);
     1823    25871    6                           IF TERMLO.TERM.SUBSUBDEVICE <= TCHN$->KH$CHN.TERMID.TERM.
             25871                                    SUBSUBDEVICE AND
     1824    25872    6                             TERMHI.TERM.SUBSUBDEVICE >= TCHN$->KH$CHN.TERMID.TERM.
             25872                                      SUBSUBDEVICE THEN
     1825    25873    6                                GOTO DOCHECKS;
     1826    25874    6                           END;            /* do case                  */
     1827    25875
     1828    25876    5                        LVL3$=LVL2$->KH$CHN.SUB$;
     1829    25877    6                        DO WHILE LVL3$~=ADDR(NIL);
     1830    25878
     1831    25879    6                             TCHN$ = LVL3$;
     1832    25880    7                             DO CASE(TERMLO.LEV);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:200  
     1833    25881    7                              CASE(%TERMINAL_ID_LEV_CHAN#);
     1834    25882    7                                ADMIN.KH$CHN = TCHN$->KH$CHN;
     1835    25883    7                                CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     1836    25884    7                              CASE(%TERMINAL_ID_LEV_SUBCHAN#);
     1837    25885    7   DOCHECKS1:                   IF TERMLO.LEV <= TCHN$->KH$CHN.TERMID.LEV AND
     1838    25886    7                                  SUBLO <= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE AND
     1839    25887    7                                  SUBHI >= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE THEN
     1840    25888    8                                DO;
     1841    25889    8                                     ADMIN.KH$CHN = TCHN$->KH$CHN;
     1842    25890    8                                     CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     1843    25891    8                                     END;
     1844    25892    7                              CASE(%TERMINAL_ID_LEV_SUBSUBCHAN#);
     1845    25893    7                                IF TERMLO.TERM.SUBSUBDEVICE <= TCHN$->KH$CHN.TERMID.
             25893                                         TERM.SUBSUBDEVICE AND
     1846    25894    7                                  TERMHI.TERM.SUBSUBDEVICE >= TCHN$->KH$CHN.TERMID.TERM
             25894                                           .SUBSUBDEVICE THEN
     1847    25895    7                                     GOTO DOCHECKS1;
     1848    25896    7                                END;       /* do case                  */
     1849    25897    6                             LVL3$ = LVL3$->KH$CHN.LNK$;
     1850    25898    6                             END;          /* do while lvl3$~=addr(nil)*/
     1851    25899    5                        LVL2$ = LVL2$->KH$CHN.LNK$;
     1852    25900    5                        END;               /* do while lvl2$~=addr(nil)*/
     1853    25901    4                   END;                    /* whenreturn               */
     1854    25902    3              END;                         /* do chanlo to chanhi      */
     1855    25903    2         ADMIN.TERMID_LO = '0'B;
     1856    25904    2         ADMIN.TYPE = 1;
     1857    25905    2         CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     1858    25906    2         RETURN;
     1859    25907        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:201  
     1860    25908    2       CASE(IGA_SSAL);                     /* Set salutation           */
     1861    25909    2         IF GJA_DEFNODE = GJA$HAND_CTX.NODE THEN
     1862    25910        /* dont change message unless its from our nm */
     1863    25911                   %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_SALUTE$);
     1864    25921
     1865    25922    2       CASE(IGA_HDR);                      /* Set Salutation header    */
     1866    25923    2         IF GJA_DEFNODE = GJA$HAND_CTX.NODE THEN
     1867    25924                   %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HDR$);
     1868    25934
     1869    25935    2       CASE(IGA_STOPFEP);
     1870    25936              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HDR$);
     1871    25946    2         CALL GJA$NETWORK_MANAGER(GJA_STOK,SIZEC(GJA_STOK));
     1872    25947
     1873    25948    2       CASE(IGA_SHDM);                     /* Host down message        */
     1874    25949              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HOSTDOWN$);
     1875    25959
     1876    25960    2       CASE(IGA_LNKDWNMSG);
     1877    25961              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_LINKDOWN$);
     1878    25971
     1879    25972    2       CASE(IGA_HOSTRESUMED);
     1880    25973              %EXTRACT_MESSAGE(DESTPTR=GJA_HOSTRESUMED$);
     1881    25983
     1882    25984    2       CASE(IGA_LGNTIMEDOUT);
     1883    25985              %EXTRACT_MESSAGE(DESTPTR=GJA_LGNTIMEDOUT$);
     1884    25995
     1885    25996    2       CASE(IGA_NOLOGONMSG);
     1886    25997              %EXTRACT_MESSAGE(DESTPTR=GJA_NOLOGONMSG$);
     1887    26007
     1888    26008    2       CASE (IGA_LGNPRMPT);
     1889    26009    2         SIZE = GJA$PARAMS.DATSIZE - SIZEC(KL$MES);
     1890    26010    2         GJA_PROMPT_VDO.DAT2.BYTSIZ = SIZE + 3;
     1891    26011    2         GJA_PROMPT_VDO.TL.LEN = SIZE+1;
     1892    26012    2         GJA_PROMPT_VDO.PROMPT = PINCRW(GJA$PARAMS.DAT$,SIZEW(KL$MES))->BUFFER;
     1893    26013
     1894    26014    2       CASE(IGA_BCST);                     /* Broadcase message        */
     1895    26015              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HDR$);
     1896    26025    2         GOTO SENDALL;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:202  
     1897    26026
     1898    26027    2       CASE(IGA_SALL);                     /* Sendall message          */
     1899    26028    2   SENDALL: ;
     1900    26029    2         RSP$ = GJA_USRLGN_HEAD$;
     1901    26030
     1902    26031    3         DO WHILE(RSP$ ~= ADDR(NIL));
     1903    26032    3              IF RSP$->GJA$LGNCTX.STATUS.INT
     1904    26033    3                AND NOT (RSP$->GJA$LGNCTX.STATUS.TERM OR RSP$->GJA$LGNCTX.STATUS.DSCRCV
             26033                         OR RSP$->GJA$LGNCTX.STATUS.TERMACK)
     1905    26034    4              THEN DO;
     1906    26035    4                   GJA_VDO_DAT_DAT2.FNC = %KV_VDO_FNC_DAT_IMD;
     1907    26036    4                   CALL GJA$SEND_MSG(RSP$,PINCRW(GJA$PARAMS.DAT$,SIZEW(KL$MES))->BUFFER
             26036                            ,
     1908    26037    4                     GJA$PARAMS.DATSIZE-SIZEC(KL$MES),%VFC_TRANSITION0);
     1909    26038    4                   GJA_VDO_DAT_DAT2.FNC = %KV_VDO_FNC_DAT;
     1910    26039    4                   END;
     1911    26040    3              RSP$ = RSP$->GJA$LGNCTX.LNK$;
     1912    26041    3              END;
     1913    26042
     1914    26043
     1915    26044    2       CASE(IGA_HOSTNA);
     1916    26045              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_NOHOST$);
     1917    26055        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:203  
     1918    26056    2       CASE (IGA_SGSYN);
     1919    26057              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_SGSYN$);
     1920    26067    2       CASE (IGA_UDHOST);
     1921    26068              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_UDHOST$);
     1922    26078    2       CASE (IGA_BDID);
     1923    26079              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_BDID$);
     1924    26089        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:204  
     1925    26090    2       CASE (IGA_NODETBL);
     1926    26091    2         IF KL$SETNODE.INVALID = '0'B THEN
     1927    26092    3         DO;
     1928    26093    3              IF KL$SETNODE.NODE# > 255 THEN
     1929    26094    3                   EXIT;
     1930    26095    3              IF KL$SETNODE.NODE# > GJA$NODETBL.NODE# THEN
     1931    26096    3                   GJA$NODETBL.NODE# = KL$SETNODE.NODE#;
     1932    26097    3              GJA$NODETBL.NODE.NODE(KL$SETNODE.NODE#) = KL$SETNODE.NODE_NAME;
     1933    26098    3              IF KL$SETNODE.HOST_NODE THEN
     1934    26099    3                   GJA$NODETBL.NODE.HOST(KL$SETNODE.NODE#) = 1;
     1935    26100    3              ELSE
     1936    26101    3                   GJA$NODETBL.NODE.HOST(KL$SETNODE.NODE#) = 0;
     1937    26102    3              END;
     1938    26103    3         ELSE DO;
     1939    26104                                           /* slug could not read :NETCON   */
     1940    26105    3              END;
     1941    26106
     1942    26107        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:205  
     1943    26108    2       CASE (IGA_RUE);
     1944    26109    2         FPT_RUE.V.USER = KL$RUE.SYSID;
     1945    26110    2         FPT_RUE.V.EVENT = KL$RUE.EVENT#;
     1946    26111    2         CALL M$RUE (FPT_RUE)
     1947    26112    3         WHENALTRETURN DO;
     1948    26113    3              KL$RUE.RESULTS = G$TCB$->G$TCB.ALT$->G$EXCFR.TRLR.ERR;
     1949    26114    3              END;
     1950    26115    2         CALL GJA$SEND_MSG(MSGCTX$,KL$RUE,GJA$PARAMS.DATSIZE);
     1951    26116
     1952    26117        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:206  
     1953    26118    2       CASE(IGA_STRTU);                    /* START USER               */
     1954    26119    2         FPT_MAKEUSR.STRTU=VECTOR(KL_STRTU);
     1955    26120    2         CALL M$MAKEUSR(FPT_MAKEUSR)
     1956    26121    3         WHENALTRETURN DO;
     1957    26122    3              RSP$=ADDR(VDO_BUFFER);
     1958    26123    3              KL$CWNAK='0'B;
     1959    26124    3              KL$CWNAK.NETADR=KL_STRTU.NETADR_FROM;
     1960    26125    3   CWNAK:     ;
     1961    26126    3              KL$CWNAK.FCN=IGA_CWNAK;
     1962    26127    3              KL$CWNAK.NETERR.ERR.L6=G$TCB$->G$TCB.ALT$->G$EXCFR.TRLR.ERR;
     1963    26128    3              CALL GJA$SEND_MSG(UID$,KL$CWNAK,SIZEC(KL$CWNAK));
     1964    26129    3              END;
     1965    26130
     1966    26131        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:207  
     1967    26132    2       CASE(IGA_AFD);                 /* ASSOCIATE FRONT-END DEBUGGER  */
     1968    26133    2         FPT_AFD.AFD=VECTOR(KL$AFD);
     1969    26134    2         CALL M$AFD(FPT_AFD)
     1970    26135    3         WHENALTRETURN DO;
     1971    26136    3              RSP$=ADDR(VDO_BUFFER);
     1972    26137    3              KL$CWNAK='0'B;
     1973    26138    3              KL$CWNAK.NETADR=KL$AFD.NETADR_FROM;
     1974    26139    3              GOTO CWNAK;
     1975    26140    3              END;
     1976    26141        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:208  
     1977    26142    2       CASE(IGA_SGN);
     1978    26143    2         IF WHO = %GJA_UID_BABOON
     1979    26144    3         THEN DO;
     1980    26145    3              SIZE = SIZEW(CTX$->GJA$LGNCTX);
     1981    26146    3              CALL KVB$GETSYS(SIZE,CTX$);
     1982    26147    3              CTX$->GJA$LGNCTX = '0'B;
     1983    26148    3              CTX$->GJA$LGNCTX.USER.SYSID = KL$SGN.NMID;
     1984    26149    3              CTX$->GJA$LGNCTX.NODE = KL$SGN.NODE;
     1985    26150    3              CTX$->GJA$LGNCTX.TERMINAL_ID = KL$SGN.TERMINAL_ID;
     1986    26151    3              CTX$->GJA$LGNCTX.LDCTX = GJA_LDCT_BABOON;
     1987    26152    3              CTX$->GJA$LGNCTX.WHO = %GJA_UID_BABOON;
     1988    26153    3              IF GJA_USRLGN_HEAD$ = ADDR(NIL)
     1989    26154    3              THEN GJA_USRLGN_HEAD$ = CTX$;
     1990    26155    4              ELSE DO;
     1991    26156    4                   CTX$->GJA$LGNCTX.LNK$ = GJA_USRLGN_HEAD$;
     1992    26157    4                   GJA_USRLGN_HEAD$ = CTX$;
     1993    26158    4                   END;
     1994    26159    3              KL$SGN.NMID = CTX;
     1995    26160    4              CALL GJA$NETWORK_MANAGER(KL$SGN,SIZEC(KL$SGN)+KL$SGN.LOGON.LGNSIZ)
             26160                       WHENRETURN DO;
     1996    26161    4                   CTX$->GJA$LGNCTX.STATUS.NMRSP = '1'B;
     1997    26162    4                   END;
     1998    26163    4              WHENALTRETURN DO;
     1999    26164    4                   CTX$->GJA$LGNCTX.STATUS.NMRSP = '0'B;
     2000    26165    4                   END;
     2001    26166    3              END;
     2002    26167    3         ELSE DO;           /* This is a return sign on, forward it    */
     2003    26168    3              ROUTE$ = KNN$ROUTE$(KL$SGN.NODE);
     2004    26169    3              CTX$ = KNN$ROUTE.CTX$;
     2005    26170    3              IF CTX$ = ADDR(NIL) OR CTX$->GJA$HAND_CTX.LDCTX = 0
     2006    26171    4              THEN DO;
     2007    26172    4                   SGNRSP.FCN = IGA_SGNRSP;
     2008    26173    4                   SGNRSP.NMID = KL$SGN.NMID;
     2009    26174    4                   SGNRSP.ERRCODE = E$NONETMAN;
     2010    26175    4                   GJA$PARAMS.DAT$ = ADDR(SGNRSP);
     2011    26176    4                   GJA$PARAMS.DATSIZE = SIZEC(SGNRSP);
     2012    26177    4                   SGNRSP.MESSAGE.RSPSIZ = GJA_MSG_NOHOST$->TEXTC_STRING.SIZE;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:209  
     2013    26178    4                   SGNRSP.MESSAGE.RSPTXT = SUBSTR(GJA_MSG_NOHOST$->TEXTC_STRING.STRING,
             26178                            0,GJA_MSG_NOHOST$->TEXTC_STRING.SIZE);
     2014    26179    4                   GOTO SGNRSP;
     2015    26180    4                   END;
     2016    26181    4              ELSE DO;
     2017    26182    4                   NMID=KL$SGN.NMID;
     2018    26183    4                   RSP$=GJA_USRLGN_HEAD$;
     2019    26184    5                   DO WHILE (RSP$ ~= ADDR(NIL));
     2020    26185    5                        IF RSP$=NMID$
     2021    26186    5                        THEN EXIT;
     2022    26187    5                        RSP$=RSP$->GJA$LGNCTX.LNK$;
     2023    26188    5                        END;
     2024    26189    4                   IF RSP$ = ADDR(NIL)
     2025    26190    4                   THEN CALL M$XXX;
     2026    26191    4                   RSP$->GJA$LGNCTX.NM_NODE = KL$SGN.NODE;
     2027    26192    4                   KL$SGN.NODE = GJA_NODE#;
     2028    26193    4                   CALL GJA$SEND_MSG(CTX$,KL$SGN,GJA$PARAMS.DATSIZE);
     2029    26194    4                   END;
     2030    26195    3              END;
     2031    26196
     2032    26197        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:210  
     2033    26198    2       CASE(IGA_SGNRSP);                   /* LOGON RESPONCE           */
     2034    26199    2   SGNRSP: ;
     2035    26200        /*
     2036    26201          This is a responce to a logon request made previously.  We need to
     2037    26202          run the GJA$LGNCTX chain to find the context clock that this
     2038    26203          signon refers to.  Once we find it, if the user has disconnected,
     2039    26204          we wind him down.  Otherwise, we set up the context block we
     2040    26205          found and call a routine to process the responce.
     2041    26206        */
     2042    26207    2         NMID=KL$SGNRSP.NMID;
     2043    26208    2         CTX$=GJA_USRLGN_HEAD$;
     2044    26209    3         DO WHILE (CTX$ ~= ADDR(NIL));
     2045    26210    3              IF CTX$=NMID$
     2046    26211    3              THEN EXIT;
     2047    26212    3              CTX$=CTX$->GJA$LGNCTX.LNK$;
     2048    26213    3              END;
     2049    26214    2         IF CTX$ = ADDR(NIL)
     2050    26215    2         THEN CALL M$XXX;
     2051    26216
     2052    26217    2         IF CTX$->GJA$LGNCTX.STATUS.TERMACK THEN RETURN; /* whoops, one slipped thru */
     2053    26218                       /* If this CTX is from Baboon just forward it on     */
     2054    26219    2         IF CTX$->GJA$LGNCTX.LDCTX = GJA_LDCT_BABOON
     2055    26220    3         THEN DO;
     2056    26221    3              KL$SGNRSP.NMID = CTX$->GJA$LGNCTX.USER.SYSID;
     2057    26222    3              CALL GJA$Q_MSG(GJA_UID_BABOON,
     2058    26223    3                SIZEC(KL$SGNRSP),KL$SGNRSP);
     2059    26224    3              CALL GJA$DISOLVE_LGNUSR_CTX(CTX$);
     2060    26225    3              END;
     2061    26226    3         ELSE DO;
     2062    26227    3              CTX$->GJA$LGNCTX.MSG$=GJA$PARAMS.DAT$;
     2063    26228    3              CALL GJA$LOGON_RESPONCE(CTX$);
     2064    26229    3              END;
     2065    26230        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:211  
     2066    26231    2       CASE(IGA_ERRMSG_RQS);
     2067    26232
     2068    26233    2         SIZE = SIZEW(CTX$->GJA$ERRMSG_CTX);
     2069    26234    2         CALL KVB$GET2NSYS(SIZE,CTX$);
     2070    26235
     2071    26236    2         CTX$->GJA$ERRMSG_CTX = '0'B;
     2072    26237    2         CTX$->GJA$ERRMSG_CTX.USR# = KL$ERRMSG_RQS.USR#;
     2073    26238    2         CTX$->GJA$ERRMSG_CTX.LDCTX = GJA_LDCT_BABOON;
     2074    26239    2         CTX$->GJA$ERRMSG_CTX.WHO = %GJA_UID_BABOON;
     2075    26240    2         CTX$->GJA$ERRMSG_CTX.NODE = GJA_DEFNODE;
     2076    26241
     2077    26242    2         IF GJA_ERRMSG_HEAD$ = ADDR(NIL)
     2078    26243    2         THEN GJA_ERRMSG_HEAD$ = CTX$;
     2079    26244    3         ELSE DO;
     2080    26245    3              CTX$->GJA$ERRMSG_CTX.LNK$ = GJA_ERRMSG_HEAD$;
     2081    26246    3              GJA_ERRMSG_HEAD$ = CTX$;
     2082    26247    3              END;
     2083    26248
     2084    26249    2         KL$ERRMSG_RQS.CTX$ = CTX$;
     2085    26250    2         CALL GJA$NETWORK_MANAGER(KL$ERRMSG_RQS,SIZEC(KL$ERRMSG_RQS));
     2086    26251
     2087    26252
     2088    26253        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:212  
     2089    26254    2       CASE(IGA_ERRMSG_RSP);
     2090    26255
     2091    26256    2         CTX$=GJA_ERRMSG_HEAD$;
     2092    26257    3         DO WHILE (CTX$ ~= ADDR(NIL));
     2093    26258    3              IF CTX$ = KL$ERRMSG_RSP.CTX$
     2094    26259    3              THEN EXIT;
     2095    26260    3              CTX$ = CTX$->GJA$ERRMSG_CTX.LNK$;
     2096    26261    3              END;
     2097    26262    2         IF CTX$ = ADDR(NIL)
     2098    26263    2         THEN CALL M$XXX;
     2099    26264
     2100    26265    2         CALL GJA$SEND_MSG(CTX$, KL$ERRMSG_RSP,
     2101    26266    2           KL$ERRMSG_RSP.MESSAGE_SZ + SIZEC(KL$ERRMSG_RSPSZ) );
     2102    26267
     2103    26268    2         CALL GJA$DISOLVE_ERRMSG_CTX(CTX$);
     2104    26269        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:213  
     2105    26270    2       CASE(IGA_CNFG_MSG);
     2106    26271    2         KL$ = ADDR(VDO_BUFFER);
     2107    26272    2         KL$HDR = ADDR(KL$CNFG_MSG)->KL$HDR;
     2108    26273    2         MSGSIZ = SIZEC(GJA_VDO_DAT_DAT1) + SIZEC(KL$HDR);
     2109    26274    2         TERMLO = KL$CNFG_MSG.TERMID_LO;
     2110    26275    2         TERMHI = KL$CNFG_MSG.TERMID_HI;
     2111    26276    2         CHANLO = TERMLO.TERM.CHANNEL;
     2112    26277    2         CHANHI = TERMHI.TERM.CHANNEL;
     2113    26278    2         SUBLO = TERMLO.TERM.SUBDEVICE;
     2114    26279    2         SUBHI = TERMHI.TERM.SUBDEVICE;
     2115    26280    2         SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;
     2116    26281    2         SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;
     2117    26282    2         KL$TERMINAL_ID = '0'B;
     2118    26283    2         KL$TERMINAL_ID.LEV = TERMLO.LEV;
     2119    26284    3         DO CHAN = CHANLO TO CHANHI BY 128;
     2120    26285    4              DO SUB = SUBLO TO SUBHI;
     2121    26286    5                   DO SUBSUB = SUBSUBLO TO SUBSUBHI;
     2122    26287    5                        KL$TERMINAL_ID.TERM.CHANNEL = CHAN;
     2123    26288    5                        KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;
     2124    26289    5                        KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;
     2125    26290    5                        NA = KL$CNFG_MSG.NA;
     2126    26291    5                        CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,KL$CNFG_MSG.KHA)
     2127    26292    6                        WHENALTRETURN DO;
     2128    26293    6                             IF KL$TERMINAL_ID.LEV > %TERMINAL_ID_LEV_CHAN# THEN
     2129    26294    7                             DO;
     2130    26295    7                                  CALL GJA$BLD_CTX(KL$TERMINAL_ID,CHN$,'0'B) WHENRETURN
     2131    26296    8                                  DO;
     2132    26297    8                                       CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,
             26297                                                KL$CNFG_MSG.KHA) WHENALTRETURN
     2133    26298    9                                       DO;
     2134    26299    9                                            KL$HDR.RESULTS = E$CHAN_NOT_THERE;
     2135    26300    9                                            GOTO SEND_CNFG_NAK;
     2136    26301    9                                            END;
     2137    26302    8                                       END;
     2138    26303    7                                  WHENALTRETURN
     2139    26304    8                                  DO;
     2140    26305    8                                       KL$HDR.RESULTS = E$NO_MORE_DEVICES;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:214  
     2141    26306    8                                       GOTO SEND_CNFG_NAK;
     2142    26307    8                                       END;
     2143    26308                /*E* ERROR: GJA-E$NO_MORE_DEVICES
     2144    26309            MESSAGE: No more devices.  Increase the NETCON device parameter for this fep. */
     2145    26310    7                                  END;     /* if .lev > chan#          */
     2146    26311    6                             ELSE
     2147    26312    7                             DO;
     2148    26313    7                                  KL$HDR.RESULTS = E$CHAN_NOT_THERE;
     2149    26314    7                                  GOTO SEND_CNFG_NAK;
     2150    26315    7                                  END;
     2151    26316                       /*E* ERROR: GJA-E$CHAN_NOT_THERE
     2152    26317                            MESSAGE: That channel does not exist.
     2153    26318                             */
     2154    26319    6                             END;          /* WHENALTRETURN            */
     2155    26320    5                        ADMIN = GJA_ADMIN;
     2156    26321    5                        ADMIN.TERMID_LO = KL$TERMINAL_ID;
     2157    26322    5                        ADMIN.TERMID_HI = KL$TERMINAL_ID;
     2158    26323    5                        ADMIN.FNC = %KHA_FNC_CNFG;
     2159    26324    5                        CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);
     2160    26325    5                        IF KH$CHN.HAND$ ~= ADDR(NIL)
     2161    26326    5                        THEN
     2162    26327    5                             CALL GJA$SEND_MSG(KH$CHN.HAND$,ADMIN,SIZEC(ADMIN));
     2163    26328    5                        END;               /* DO SUBSUB                */
     2164    26329    4                   END;                    /* DO SUB                   */
     2165    26330    3              END;                         /* DO SUBSUB                */
     2166    26331    2   SEND_CNFG_NAK:;
     2167    26332    2         CALL GJA$SEND_MSG(MSGCTX$,KL$HDR,SIZEC(KL$HDR));
     2168    26333    2         RETURN;
     2169    26334        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:215  
     2170    26335    2       CASE(IGA_RQSCHN);
     2171    26336        /*
     2172    26337          This is a request from a handler for config information or line
     2173    26338          profile information.  Just pass it on to the network manager
     2174    26339        */
     2175    26340    2         GJA$PARAMS.DAT$->KL$RQSCHN.HANDLER=GJA$HAND_CTX.NAME;
     2176    26341    2         CALL GJA$NETWORK_MANAGER(GJA$PARAMS.DAT$->KL$RQSCHN,GJA$PARAMS.DATSIZE);
     2177    26342        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:216  
     2178    26343    2       CASE(IGA_CHNRSP);                   /* CHANNEL CONFIG INFO      */
     2179    26344    2         NA = KL$CHNRSP.NA;
     2180    26345    2         HNDCMN = KL$CHNRSP.HNDCMN;
     2181    26346    2         KL$TERMINAL_ID = KL$CHNRSP.TERMINAL_ID;
     2182    26347
     2183    26348        /* If its a line profile build the table */
     2184    26349    2         IF KL$CHNRSP.LINE_PROFILE
     2185    26350    3         THEN DO;
     2186    26351    3              KL$TERMINAL_ID = KL$CHNRSP.TERMINAL_ID;
     2187    26352    3              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);
     2188    26353    3              CTX$ = KH$CHN.HAND$;
     2189    26354    3              IF KL$CHNRSP.NAK
     2190    26355    4              THEN DO;
     2191    26356    4                   CALL GJA$SEND_MSG(CTX$,KL$CHNRSP,SIZEW(KL$CHNRSP));
     2192    26357    4                   RETURN;
     2193    26358    4                   END;
     2194    26359    3              CALL GJA$SEND_MSG(CTX$,KL$CHNRSP,GJA$PARAMS.DATSIZE);
     2195    26360    3              CALL GJA$LINEPROFILE (KL$TERMINAL_ID,ADDR(KL$CHNRSP.MESSAGE.MESSAGE));
     2196    26361    3              RETURN;
     2197    26362    3              END;
     2198    26363    2         IF KL$CHNRSP.DFLTHND
     2199    26364    3         THEN DO;
     2200    26365    3              IF NOT KL$CHNRSP.NAK
     2201    26366    3              THEN
     2202    26367    3                   CALL DEFAULT_HAND;
     2203    26368    3              IF CTX$ = GJA_UID_NANM$ THEN
     2204    26369    4              DO;
     2205    26370    4                   CTX$ = GJA_HAND_HEAD$;
     2206    26371
     2207    26372    5                   DO WHILE(CTX$ ~= ADDR(NIL));
     2208    26373    5                        IF CTX$->GJA$HAND_CTX.NAME = KL$CHNRSP.HANDLER
     2209    26374    5                        THEN
     2210    26375    5                             EXIT;
     2211    26376    5                        CTX$ = CTX$->GJA$HAND_CTX.LNK$;
     2212    26377    5                        END;
     2213    26378
     2214    26379    4                   END;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:217  
     2215    26380    3              IF NOT GJA_FIRST_TIME
     2216    26381    3              THEN
     2217    26382    3                   IF CTX$ ~= ADDR(NIL)
     2218    26383    3                   THEN
     2219    26384    3                        CALL ALLOCATE_CHAN(CTX$);
     2220    26385    3              RETURN;
     2221    26386    3              END;
     2222    26387        /*
     2223    26388             If the channel is zerop and it is the first time lets go.
     2224    26389         */
     2225    26390    2         IF GJA_FIRST_TIME AND KL$TERMINAL_ID.TERM = '0'B
     2226    26391    3         THEN DO;
     2227    26392    3              GJA_FIRST_TIME = '0'B;
     2228    26393    3              CTX$ = GJA_HAND_HEAD$;
     2229    26394    4              DO WHILE (CTX$ ~= ADDR(NIL));
     2230    26395    4                   IF CTX$->GJA$HAND_CTX.WHO = %GJA_UID_HANDLER
     2231    26396    4                   THEN
     2232    26397    4                        CALL ALLOCATE_CHAN(CTX$);
     2233    26398    4                   CTX$ = CTX$->GJA$HAND_CTX.LNK$;
     2234    26399    4                   END;
     2235    26400    3              GOTO NM_SAYS_GO;
     2236    26401    3              END;
     2237    26402
     2238    26403    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)
     2239    26404    3         WHENALTRETURN DO;
     2240    26405    3              IF KL$TERMINAL_ID.LEV ~= %TERMINAL_ID_LEV_CHAN#
     2241    26406    3              THEN
     2242    26407    4                   CALL GJA$BLD_CTX (KL$TERMINAL_ID,CHN$,'0'B) WHENALTRETURN DO;
     2243    26408    4                        CALL M$SCREECH(NODEDEV);
     2244    26409                         /*S* SCREECH_CODE: GJA-S$NODEDEV
     2245    26410                              TYPE:SCREECH
     2246    26411                              MESSAGE: NODEADMN out of device context memory.
     2247    26412                              REMARKS: Increase the DEVICE parameter in NETCON and
     2248    26413                                       reboot.
     2249    26414                         */
     2250    26415    4                        END;
     2251    26416    3              END;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:218  
     2252    26417    2         IF NA.CNFG_EXISTS THEN
     2253    26418    2              CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,HNDCMN);
     2254    26419
     2255    26420
     2256    26421        /* If there is already a handler send an ENABLE or DISABLE to the
     2257    26422           line depending on the channel table flag.
     2258    26423        */
     2259    26424        /*  If scndcnfg is on then a terminal name was associated with this
     2260    26425            request.  This config is just to get and records configged under
     2261    26426            chan-n-n instead of termname-n-n.  The chnrsp from the term name
     2262    26427            will issue the enable to the handler.  This is only for bozos
     2263    26428            who wont read the manual.
     2264    26429        */
     2265    26430    2         IF KL$CHNRSP.SCNDCNFG THEN
     2266    26431    2              RETURN;
     2267    26432    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)
     2268    26433    3         WHENRETURN DO;
     2269    26434    3              IF KH$CHN.HAND$ ~= ADDR(NIL)
     2270    26435    4              THEN DO;
     2271    26436    4                   ADMIN = GJA_ADMIN;
     2272    26437    4                   ADMIN.TERMID_LO = KL$TERMINAL_ID;
     2273    26438    4                   ADMIN.TERMID_HI = KL$TERMINAL_ID;
     2274    26439    4                   IF KH$CHN.ENB
     2275    26440    5                   THEN DO;
     2276    26441    5                        ADMIN.FNC = %KHA_FNC_ENABLE;
     2277    26442    5                        CALL GJA$SEND_MSG(KH$CHN.HAND$,ADMIN,SIZEC(ADMIN));
     2278    26443    5                        END;
     2279    26444    4                   END;
     2280    26445    3              END;
     2281    26446        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:219  
     2282    26447    2       CASE (IGA_GO);                 /* Were all set lets get going   */
     2283    26448        /* Check to see if this is the first time that we connected to the network
     2284    26449             manager. If it is we just return.  This routine will be called
     2285    26450             later on a CHNRSP with a channel of zero indicatine the last
     2286    26451             response.
     2287    26452         */
     2288    26453    2         IF GJA_FIRST_TIME
     2289    26454    2         THEN
     2290    26455    2              RETURN;
     2291    26456
     2292    26457    2   NM_SAYS_GO: ;
     2293    26458        /*
     2294    26459          Just in case we managed to get a logon request in here someplace,
     2295    26460          run the logon chain to pickup where we left off on the request
     2296    26461        */
     2297    26462    2         CTX$=GJA_USRLGN_HEAD$;
     2298    26463    2         IF NOT(GJA_HSTRSMED) THEN
     2299    26464    3              CALL GJA$HOST_RESUMED WHENALTRETURN DO;END;
     2300    26465    3         IF GJA_DEFNODE = UID$->GJA$HAND_CTX.NODE THEN DO;
     2301    26466    4              DO WHILE (CTX$ ~= ADDR(NIL));
     2302    26467    4                   IF CTX$->GJA$LGNCTX.STATUS.WAITING_HOST OR
     2303    26468    4                     ( NOT CTX$->GJA$LGNCTX.STATUS.NMRSP AND
     2304    26469    4                     NOT CTX$->GJA$LGNCTX.STATUS.WTPRO) THEN
     2305    26470    4                        CALL GJA$LOGON_REQUEST_AGAIN(CTX$)
     2306    26471    5                        WHENALTRETURN DO;
     2307    26472    5                             END;
     2308    26473    4                   CTX$=CTX$->GJA$LGNCTX.LNK$;
     2309    26474    4                   END;
     2310    26475    3              END;                         /* defnode = hand_ctx.node*/
     2311    26476        /* If we booted from diskette start the dump */
     2312    26477    2         KL$TERMINAL_ID = '0'B;
     2313    26478    2         KL$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN#;
     2314    26479    2         KL$TERMINAL_ID.TERM.CHANNEL = GID_BOOTCHAN * 64;
     2315    26480    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)
     2316    26481    3         WHENRETURN DO;
     2317    26482    3              IF KH$CHN.RESOURCE = 'DK'
     2318    26483    3              THEN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:220  
     2319    26484    3                   CALL GIJ$INITDUMP;
     2320    26485    3              END;
     2321    26486
     2322    26487        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:221  
     2323    26488
     2324    26489    2       CASE(IGA_LINE_ACQUIRE);
     2325    26490
     2326    26491    2         IF WHO = %GJA_UID_HANDLER
     2327    26492    3         THEN DO;
     2328    26493    3              GJA$HAND_CTX.RES = KL$ACQUIRE.RES;
     2329    26494    3              GJA$HAND_CTX.ATTR = KL$ACQUIRE.ATTR;
     2330    26495
     2331    26496    3              IF GJA_FIRST_TIME
     2332    26497    3              THEN
     2333    26498    3                   CALL ALLOCATE_CHAN(CTX$);
     2334    26499    4              ELSE DO;
     2335    26500                  /* SEND UP A REQUEST FOR THE DEFAULT HANDLER AND PROFILE  */
     2336    26501    4                   ADDR(VDO_BUFFER)->KL$RQSCHN = GJA_RQSCHN;
     2337    26502    4                   ADDR(VDO_BUFFER)->KL$RQSCHN.HANDLER = GJA$HAND_CTX.NAME;
     2338    26503    4                   ADDR(VDO_BUFFER)->KL$RQSCHN.DFLTHND = '1'B;
     2339    26504    4                   CALL GJA$NETWORK_MANAGER (ADDR(VDO_BUFFER)->KL$RQSCHN,SIZEC(ADDR(
             26504                            VDO_BUFFER)->KL$RQSCHN));
     2340    26505    4                   ADDR(VDO_BUFFER)->KL$RQSCHN.DFLTHND = '0'B;
     2341    26506    4                   END;
     2342    26507    3              RETURN;
     2343    26508    3              END;
     2344    26509    2         KL$TERMINAL_ID.LEV=%TERMINAL_ID_LEV_CHAN#;
     2345    26510    2         SVCHN$ = ADDR(NIL);
     2346    26511    2         SVCHAN=KL$ACQUIRE.CHAN;
     2347    26512    2         BASECHAN=0;
     2348    26513    2         LASTCHAN=0;
     2349    26514    2         KL$ACQUIRE.CHAN=0;
     2350    26515    2         KL$ACQUIRE.HIGHCHAN=0;
     2351    26516    2         KL$ACQUIRE.LOWCHAN=0;
     2352    26517        /*
     2353    26518          The following code segment sets up a base channel to start the
     2354    26519          search and last channel to end the search.  It understands
     2355    26520          a diagnostic request to scan an entire controller and sets up the
     2356    26521          range accordingly.  For normal, non-diagnostic requests, the range
     2357    26522          is the whole channel table.  If a diagnostic user requests a
     2358    26523          channel and controller for a non MLCP, NMLC device, he gets just
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:222  
     2359    26524          that one channel, even though he asked for the whole controller.
     2360    26525        */
     2361    26526    2         IF KL$ACQUIRE.DIAG
     2362    26527    3         THEN DO;                          /* DIAG                     */
     2363    26528    3              KL$TERMINAL_ID.TERM.CHANNEL=SVCHAN;
     2364    26529    3              KL$ACQUIRE.ERRCODE=E$CHAN_NOT_THERE;
     2365    26530    3              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) ALTRET(SENDIT);
     2366    26531    3              KL$ACQUIRE.ERRCODE='0'B;
     2367    26532    3              IF KL$ACQUIRE.CONTROLLER
     2368    26533    4              THEN DO;                     /* CONTROLLER               */
     2369    26534    4                   IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_MLCP#
     2370    26535    5                   THEN DO;
     2371    26536    5                        BASECHAN=SVCHAN-MOD(SVCHAN,1024/*'400'X*/);
     2372    26537    5                        LASTCHAN=BASECHAN+(896/*'400'X-'80'X*/);
     2373    26538    5                        END;
     2374    26539    4                   ELSE IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_NMLC#
     2375    26540    5                        THEN DO;
     2376    26541    5                             BASECHAN=SVCHAN-MOD(SVCHAN,2048/*'800'X*/);
     2377    26542    5                             LASTCHAN=BASECHAN+(1920/*'800'X-'80'X*/);
     2378    26543    5                             END;
     2379    26544    5                        ELSE DO;
     2380    26545    5                             BASECHAN=SVCHAN;
     2381    26546    5                             LASTCHAN=SVCHAN;
     2382    26547    5                             END;
     2383    26548    4                   END;                    /* CONTROLLER               */
     2384    26549    4              ELSE DO;
     2385    26550    4                   BASECHAN=SVCHAN;
     2386    26551    4                   LASTCHAN=SVCHAN;
     2387    26552    4                   END;
     2388    26553    3              END;                         /* DIAG                     */
     2389    26554    3         ELSE DO;
     2390    26555    3              BASECHAN=GJA_CHNLOW;
     2391    26556    3              LASTCHAN=GJA_CHNHI;
     2392    26557    3              END;
     2393    26558        /*
     2394    26559          Now that we have a range, lets get a pointer to the first channel
     2395    26560          that actually exists in that range.  If none exist, we have a
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:223  
     2396    26561          problem.
     2397    26562        */
     2398    26563    2         KL$TERMINAL_ID.TERM.CHANNEL=BASECHAN;
     2399    26564    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);
     2400    26565    2         SVCHN$ = CHN$;
     2401    26566    2         IF CHN$ ~= ADDR(NIL) AND KH$CHN.CHNBIT0_9*64 > LASTCHAN
     2402    26567    2         THEN KL$ACQUIRE.ERRCODE=E$CHAN_NOT_THERE;
     2403    26568    3         ELSE DO;
     2404    26569    3              BASECHAN=KH$CHN.CHNBIT0_9*64;
     2405    26570    3              SVATTR = KL$ACQUIRE.ATTR;
     2406    26571        /*
     2407    26572          This loop does the actual aquiring.
     2408    26573        */
     2409    26574    4   ACQUIRE:   DO WHILE (BASECHAN <= LASTCHAN AND CHN$ <= GJA_CHNHI$); /* ACQUIRE */
     2410    26575    5   CHAN:           DO ;                    /* CHAN                     */
     2411    26576    5                        IF BASECHAN = 0
     2412    26577    5                        THEN EXIT CHAN;
     2413    26578        /*
     2414    26579          If this is a diagnostic acquire and the channel is owned, its
     2415    26580          all over but the erroring.  If this is a non-diagnostic acquire
     2416    26581          and the channel is owned, skip to the next one.
     2417    26582        */
     2418    26583    5                        IF(KH$CHN.HAND$ ~= ADDR(NIL) OR KH$CHN.SYSID ~= 0)
     2419    26584    6                        THEN DO;
     2420    26585    6                             IF KL$ACQUIRE.DIAG
     2421    26586    7                             THEN DO;
     2422    26587    7                                  IF KL$ACQUIRE.CONTROLLER
     2423    26588    7                                  THEN KL$ACQUIRE.ERRCODE=E$CONT_OWNED;
     2424    26589        /*E* ERROR: GJA-E$CONT_OWNED
     2425    26590             MESSAGE: This controller is wholly or partially owned already.
     2426    26591        */
     2427    26592    7                                  ELSE KL$ACQUIRE.ERRCODE=E$CHAN_OWNED;
     2428    26593        /*E* ERROR: GJA-E$CHAN_OWNED
     2429    26594             MESSAGE: This channel is already owned by someone.
     2430    26595        */
     2431    26596    7                                  EXIT ACQUIRE;
     2432    26597    7                                  END;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:224  
     2433    26598    6                             EXIT CHAN;
     2434    26599    6                             END;
     2435    26600        /*
     2436    26601          The channel is not currently owned.  If this is a diagnostic acquire
     2437    26602          and the channel is not partitioned for diagnostics, we blow the
     2438    26603          guy off.
     2439    26604        */
     2440    26605    5                        IF KL$ACQUIRE.DIAG AND KH$CHN.STT ~= %KH#CHN_STT_PRT
     2441    26606    6                        THEN DO;
     2442    26607    6                             IF KL$ACQUIRE.CONTROLLER
     2443    26608    6                             THEN KL$ACQUIRE.ERRCODE=E$CONT_NOT_PART;
     2444    26609    6                             ELSE KL$ACQUIRE.ERRCODE=E$CHAN_NOT_PART;
     2445    26610    6                             EXIT ACQUIRE;
     2446    26611    6                             END;
     2447    26612        /*
     2448    26613          Well we finally get to the check to see if this channel can satisfy
     2449    26614          the necessary requirements.  If res and attr match up or if this is
     2450    26615          a diag acquire (we allready narrowed the range) its good.
     2451    26616        */
     2452    26617    5                        IF (KH$CHN.RESOURCE = KL$ACQUIRE.RES AND
     2453    26618    5                          (SVATTR &~ KH$CHN.ATTR)='0'B) OR
     2454    26619    5                          KL$ACQUIRE.DIAG
     2455    26620    6                        THEN DO;
     2456    26621    6                             IF KL$ACQUIRE.LOWCHAN=0
     2457    26622    6                             THEN KL$ACQUIRE.LOWCHAN=KH$CHN.CHNBIT0_9*64;
     2458    26623    6                             IF KH$CHN.CHNBIT0_9*64 > KL$ACQUIRE.HIGHCHAN
     2459    26624    6                             THEN KL$ACQUIRE.HIGHCHAN=KH$CHN.CHNBIT0_9*64;
     2460    26625        /*
     2461    26626          If we haven't allready filled in the rest of KL$ACQUIRE do it if
     2462    26627          either this is a non-diagnostic acquire or its a diagnostic acquire
     2463    26628          and we've gotten to the channel the guy originally asked for
     2464    26629          (this might be a controller request and we allways return the
     2465    26630          information for the requested channel)
     2466    26631        */
     2467    26632    6                             IF (KL$ACQUIRE.DIAG AND SVCHAN=KH$CHN.CHNBIT0_9*64) OR
     2468    26633    6                               (NOT(KL$ACQUIRE.DIAG) AND KL$ACQUIRE.CHAN=0)
     2469    26634    7                             THEN DO;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:225  
     2470    26635    7                                  KL$ACQUIRE.DVCID=KH$CHN.DVCID;
     2471    26636    7                                  KL$ACQUIRE.ATTR=KH$CHN.ATTR;
     2472    26637    7                                  KL$ACQUIRE.EXTDVCID=KH$CHN.EXTDVCID;
     2473    26638    7                                  END;
     2474    26639        /*
     2475    26640          Fill in the channel table entry to reflect the new owner
     2476    26641        */
     2477    26642    6                             IF KL$ACQUIRE.DIAG
     2478    26643    6                             THEN KH$CHN.STT = %KH#CHN_STT_DIAG;
     2479    26644    6                             IF KL$ACQUIRE.CHAN=0 OR KL$ACQUIRE.DIAG
     2480    26645    7                             THEN DO;
     2481    26646    7                                  KL$ACQUIRE.CHAN=KH$CHN.CHNBIT0_9*64;
     2482    26647    7                                  IF KL$ACQUIRE.USER# ~= 0
     2483    26648    7                                  THEN KH$CHN.SYSID=KL$ACQUIRE.USER#;
     2484    26649    7                                  ELSE KH$CHN.SYSID = GJA$HAND_CTX.SYSID;
     2485    26650    7                                  KH$CHN.HAND$ = CTX$;
     2486    26651    7                                  END;
     2487    26652    6                             END;
     2488    26653    5                        END;
     2489    26654        /*
     2490    26655          Bump pointer to next entry
     2491    26656        */
     2492    26657    4                   CHN$=PINCRW(CHN$,SIZEW(KH$CHN));
     2493    26658    4                   BASECHAN=KH$CHN.CHNBIT0_9*64;
     2494    26659    4                   END;
     2495    26660    3              END;
     2496    26661    2         IF KL$ACQUIRE.CHAN=0
     2497    26662    2           AND KL$ACQUIRE.ERRCODE = '0'B
     2498    26663    2         THEN KL$ACQUIRE.ERRCODE=E$NO_DEVICES;
     2499    26664        /*E* ERROR:  GJA-E$NO_DEVICES
     2500    26665             MESSAGE: No available devices meet the specified criteria.
     2501    26666        */
     2502    26667    2   SENDIT: ;
     2503    26668    2         CALL GJA$SEND_MSG(CTX$,KL$ACQUIRE,SIZEC(KL$ACQUIRE));
     2504    26669    2         IF KL$ACQUIRE.DIAG AND SVCHN$~=ADDR(NIL) AND KL$ACQUIRE.ERRCODE~='0'B
     2505    26670    3         THEN DO;
     2506    26671        /* Clear out channels we have gotten */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:226  
     2507    26672    4              DO WHILE (SVCHN$ < CHN$);
     2508    26673    4                   SVCHN$->KH$CHN.STT = %KH#CHN_STT_PRT;
     2509    26674    4                   SVCHN$->KH$CHN.SYSID = 0;
     2510    26675    4                   SVCHN$->KH$CHN.HAND$ = ADDR(NIL);
     2511    26676    4                   SVCHN$ = PINCRW(SVCHN$,SIZEW(KH$CHN));
     2512    26677    4                   END;
     2513    26678    3              END;
     2514    26679        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:227  
     2515    26680    2       CASE(IGA_PRFRSP);
     2516    26681
     2517    26682    2         NMID=KL$PRFRSP.NMID;
     2518    26683    2         CTX$=GJA_USRLGN_HEAD$;
     2519    26684    3         DO WHILE (CTX$ ~= ADDR(NIL));
     2520    26685    3              IF CTX$=NMID$
     2521    26686    3              THEN EXIT;
     2522    26687    3              CTX$=CTX$->GJA$LGNCTX.LNK$;
     2523    26688    3              END;
     2524    26689    2         IF CTX$ = ADDR(NIL)
     2525    26690    2         THEN CALL M$XXX;
     2526    26691    2         IF CTX$->GJA$LGNCTX.STATUS.TERMACK THEN RETURN; /* whoops, one slipped thru*/
     2527    26692    2         IF (CTX$->GJA$LGNCTX.STATUS.TERM OR CTX$->GJA$LGNCTX.STATUS.DSCRCV)
     2528    26693    2           AND CTX$->GJA$LGNCTX.STATUS.WTPRO AND NOT KL$PRFRSP.MORE
     2529    26694    3         THEN DO;
     2530    26695    3              IF CTX$->GJA$LGNCTX.STATUS.TERM
     2531    26696    4              THEN DO;
     2532    26697    4                   CALL GJA$Q_MSG(CTX$,
     2533    26698    4                     ,,SIZEC(GJA_TERM_ACK),GJA_TERM_ACK,%KN_FCN_TERM_ACK);
     2534    26699    4                   CALL GJA$DISOLVE_LGNUSR_CTX(CTX$);
     2535    26700    4                   END;
     2536    26701    4              ELSE DO;
     2537    26702    4                   CALL GJA$Q_MSG(CTX$,
     2538    26703    4                     ,,SIZEC(GJA_TERM),GJA_TERM,%KN_FCN_TERM);
     2539    26704    4                   CTX$->GJA$LGNCTX.STATUS.TERMACK = '1'B;
     2540    26705    4                   END;
     2541    26706    3              RETURN;
     2542    26707    3              END;
     2543    26708
     2544    26709
     2545    26710    2         IF KL$PRFRSP.IMP                  /* IMP RECORED              */
     2546    26711    3         THEN DO;
     2547    26712    3              SIZE = KL$PRFRSP.PROFILE.PRFSIZE;
     2548    26713    3              CALL GJA$SEND_MSG(CTX$,KL$PRFRSP.PROFILE.PRFTXT,SIZE,%VFC_SLPP);
     2549    26714    3              END;
     2550    26715    3         ELSE DO;
     2551    26716    3              ADDR(VDO_BUFFER)->GJA$PROFILE_VDO=GJA_PARAM_VDO;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:228  
     2552    26717    3              ADDR(VDO_BUFFER)->GJA$PROFILE_VDO.KV$VDOVLP_DAT2.BYTSIZ=
     2553    26718    3                KL$PRFRSP.PROFILE.PRFSIZE;
     2554    26719    3              SIZE=KL$PRFRSP.PROFILE.PRFSIZE;
     2555    26720    3              PINCRW(ADDR(VDO_BUFFER),SIZEW(GJA_PARAM_VDO))->STRING=
     2556    26721    3                SUBSTR(KL$PRFRSP.PROFILE.PRFTXT,0,KL$PRFRSP.PROFILE.PRFSIZE);
     2557    26722    3              MSGSIZ=SIZEC(GJA_PARAM_VDO)+KL$PRFRSP.PROFILE.PRFSIZE;
     2558    26723    3              IF KL$PRFRSP.PROFILE.PRFSIZE ~= 0
     2559    26724    3              THEN
     2560    26725    3                   CALL GJA$Q_MSG(CTX$,MSGSIZ,ADDR(VDO_BUFFER)->GJA$PROFILE_VDO);
     2561    26726    3              END;
     2562    26727    2         CTX$->GJA$LGNCTX.RETRYCNT = 0;
     2563    26728    2         IF CTX$->GJA$LGNCTX.STATUS.WTPRO AND NOT KL$PRFRSP.MORE
     2564    26729    2         THEN
     2565    26730    2              CALL GJA$LOGON_REQUEST_AGAIN(CTX$);
     2566    26731        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:229  
     2567    26732    2       CASE(IGA_WRITE);
     2568    26733
     2569    26734    2         NMID=KL$WRITE.NMID;
     2570    26735    2         CTX$=GJA_USRLGN_HEAD$;
     2571    26736    3         DO WHILE (CTX$ ~= ADDR(NIL));
     2572    26737    3              IF CTX$=NMID$
     2573    26738    3              THEN EXIT;
     2574    26739    3              CTX$=CTX$->GJA$LGNCTX.LNK$;
     2575    26740    3              END;
     2576    26741    2         IF CTX$ = ADDR(NIL)
     2577    26742    2         THEN CALL M$XXX;
     2578    26743    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1=GJA_VDO_DAT_DAT1;
     2579    26744    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1.KV$VDOVLP_DAT1.BYTSIZ=
     2580    26745    2           KL$WRITE.MESSAGE.MSGSIZE;
     2581    26746    2         SIZE = KL$WRITE.MESSAGE.MSGSIZE;
     2582    26747    2         PINCRW(ADDR(VDO_BUFFER),SIZEW(GJA_VDO_DAT_DAT1))->STRING=
     2583    26748    2           KL$WRITE.MESSAGE.MSGTXT;
     2584    26749    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1.DATCTRCHRTYP = %KV_DATCTRCHRTYP_VFC;
     2585    26750    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1.DATCTRCHR = %VFC_TRANSITION0;
     2586    26751    2         MSGSIZ=SIZEC(GJA_VDO_DAT_DAT1)+KL$WRITE.MESSAGE.MSGSIZE;
     2587    26752    2         CALL GJA$Q_MSG(CTX$,MSGSIZ,ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1);
     2588    26753        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:230  
     2589    26754    2       CASE(IGA_LINE_RELEASE);
     2590    26755
     2591    26756    2         SVCHAN=KL$RELEASE.CHAN;
     2592    26757    2         KL$TERMINAL_ID.LEV=%TERMINAL_ID_LEV_CHAN#;
     2593    26758    2         KL$TERMINAL_ID.TERM.CHANNEL=KL$RELEASE.CHAN;
     2594    26759    2         KL$RELEASE.ERRCODE=E$CHAN_NOT_THERE;
     2595    26760    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)
     2596    26761    3         WHENALTRETURN DO;
     2597    26762    3              IF SVCHAN ~= 0
     2598    26763    3              THEN
     2599    26764    3                   GOTO SCRAP;
     2600    26765    3              END;
     2601    26766    2         KL$RELEASE.ERRCODE='0'B;
     2602    26767    2         IF KL$RELEASE.CONTROLLER
     2603    26768    3         THEN DO;                          /* CONTROLLER               */
     2604    26769    3              IF (KH$CHN.DVCID&'FF00'X) = %GJA_DVCID_MLCP#
     2605    26770    4              THEN DO;
     2606    26771    4                   BASECHAN=SVCHAN-MOD(SVCHAN,1024/*'400'X*/);
     2607    26772    4                   LASTCHAN=BASECHAN+(896/*'400'X-'80'X*/);
     2608    26773    4                   END;
     2609    26774    3              ELSE IF (KH$CHN.DVCID&'FF00'X) = %GJA_DVCID_NMLC#
     2610    26775    4                   THEN DO;
     2611    26776    4                        BASECHAN=SVCHAN-MOD(SVCHAN,2048/*'800'X*/);
     2612    26777    4                        LASTCHAN=BASECHAN+(1920/*'800'X-'80'X*/);
     2613    26778    4                        END;
     2614    26779    4                   ELSE DO;
     2615    26780    4                        BASECHAN=SVCHAN;
     2616    26781    4                        LASTCHAN=SVCHAN;
     2617    26782    4                        END;
     2618    26783    3              END;
     2619    26784    3         ELSE DO;
     2620    26785    3              BASECHAN=SVCHAN;
     2621    26786    3              LASTCHAN=SVCHAN;
     2622    26787    3              END;
     2623    26788    2         IF SVCHAN = 0
     2624    26789    3         THEN DO;
     2625    26790    3              BASECHAN = 0;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:231  
     2626    26791    3              LASTCHAN = GJA_CHNHI;
     2627    26792    3              END;
     2628    26793    2         KL$TERMINAL_ID.TERM.CHANNEL=BASECHAN;
     2629    26794    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);
     2630    26795    2         STARTCHN$=CHN$;
     2631    26796    2         IF SVCHAN ~= 0               /* Not all channels for user     */
     2632    26797    2         THEN
     2633    26798    3   CHECK: DO WHILE (BASECHAN <= LASTCHAN);
     2634    26799    3              IF BASECHAN ~= 0
     2635    26800    4              THEN DO;
     2636    26801    4                   IF KL$RELEASE.USER# ~= 0
     2637    26802    4                   THEN IF KH$CHN.SYSID ~= KL$RELEASE.USER#
     2638    26803    5                        THEN DO;
     2639    26804    5                             KL$RELEASE.ERRCODE=E$NOTYOURS;
     2640    26805    5                             EXIT CHECK;
     2641    26806    5                             END;
     2642    26807    4                        ELSE
     2643    26808    4                             IF KH$CHN.HAND$ ~= CTX$
     2644    26809    5                             THEN DO;
     2645    26810    5                                  KL$RELEASE.ERRCODE=E$NOTYOURS;
     2646    26811    5                                  EXIT CHECK;
     2647    26812    5                                  END;
     2648    26813    4                   END;
     2649    26814    3              CHN$=PINCRW(CHN$,SIZEW(KH$CHN));
     2650    26815    3              BASECHAN=KH$CHN.CHNBIT0_9*64;
     2651    26816    3              END;
     2652    26817    2         IF KL$RELEASE.ERRCODE = '0'B
     2653    26818    3         THEN DO;
     2654    26819    3              CHN$=STARTCHN$;
     2655    26820    3              BASECHAN=KH$CHN.CHNBIT0_9*64;
     2656    26821    4   CHN:       DO WHILE (BASECHAN <= LASTCHAN);
     2657    26822    4                   IF KH$CHN.SYSID = KL$RELEASE.USER#
     2658    26823    5                   THEN DO;
     2659    26824    5                        KH$CHN.SYSID=0;
     2660    26825    5                        KH$CHN.HAND$=ADDR(NIL);
     2661    26826    5                        IF KH$CHN.STT = %KH#CHN_STT_DIAG
     2662    26827    5                        THEN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:232  
     2663    26828    5                             KH$CHN.STT = %KH#CHN_STT_PRT;
     2664    26829    5                        IF KH$CHN.DVCID ~= '0'B
     2665    26830    5                        THEN
     2666    26831    5                             CALL KHI$IO_OTP(KH$CHN,GJA_IO);
     2667    26832    5                        END;
     2668    26833    4                   CHN$=PINCRW(CHN$,SIZEW(KH$CHN));
     2669    26834    4                   IF CHN$ > GJA_CHNHI$ THEN
     2670    26835    4                        EXIT CHN;
     2671    26836    4                   BASECHAN=KH$CHN.CHNBIT0_9*64;
     2672    26837    4                   END;
     2673    26838    3              END;
     2674    26839    2         IF SVCHAN ~= 0
     2675    26840    2         THEN
     2676    26841    2   SCRAP:     CALL GJA$SEND_MSG(UID$,KL$RELEASE,SIZEC(KL$RELEASE));
     2677    26842        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:233  
     2678    26843    2       CASE(IGA_CONFIGRQS);
     2679    26844        /*
     2680    26845          Setup the start of the response
     2681    26846        */
     2682    26847    2         RSP$=ADDR(VDO_BUFFER);
     2683    26848    2         KL$CONFIGRSP='0'B;
     2684    26849    2         KL$CONFIGRSP.FCN=IGA_CONFIGRSP;
     2685    26850    2         KL$CONFIGRSP.MSGID=KL$CONFIGRQS.MSGID;
     2686    26851    2         KL$CONFIGRSP.NODE=KL$CONFIGRQS.SRC_NODE;
     2687    26852        /*
     2688    26853          A user in the host has asked for the configuration of a given
     2689    26854          channel.  Lets give him what he deserves.  If he is a diagnostic
     2690    26855          user and the controller bit is set, we have to scan each device
     2691    26856          on this controller, and if they are all not in a state where
     2692    26857          T&Ds can acquire them, we report an error.
     2693    26858        */
     2694    26859    2         KL$TERMINAL_ID.LEV=%TERMINAL_ID_LEV_CHAN#;
     2695    26860    2         KL$TERMINAL_ID.TERM.CHANNEL=KL$CONFIGRQS.CHANNEL;
     2696    26861    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)
     2697    26862    3         WHENALTRETURN DO;
     2698    26863    3              KL$CONFIGRSP.STATUS = 0;
     2699    26864    3              GOTO CONFIG_XIT;
     2700    26865    3              END;
     2701    26866        /*
     2702    26867          The channel exists.  We allways fill in the channel information for
     2703    26868          the actual channel requested, before we make further checks.
     2704    26869        */
     2705    26870    2         I=KH$CHN.STT;
     2706    26871    2         IF KH$CHN.DVCID = '0'B
     2707    26872    3         THEN DO;
     2708    26873    3              KL$CONFIGRSP.STATUS = 0;
     2709    26874    3              GOTO CONFIG_XIT;
     2710    26875    3              END;
     2711    26876    2         CALL CONVERT_STATE (I);
     2712    26877    2         KL$CONFIGRSP.STATUS = I;
     2713    26878    2         KL$CONFIGRSP.DVCID=KH$CHN.DVCID;
     2714    26879    2         KL$CONFIGRSP.EXTDVCID=KH$CHN.EXTDVCID;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:234  
     2715    26880    2         IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_MLCP#
     2716    26881    3         THEN DO;
     2717    26882    3              BASECHAN=KL$TERMINAL_ID.TERM.CHANNEL-MOD(KL$TERMINAL_ID.TERM.CHANNEL,1024
             26882                       /*'400'X*/);
     2718    26883    3              LASTCHAN=BASECHAN+(896/*'400'X-'80'X*/);
     2719    26884    3              END;
     2720    26885    2         ELSE
     2721    26886    2              IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_NMLC#
     2722    26887    3              THEN DO;
     2723    26888    3                   BASECHAN=KL$TERMINAL_ID.TERM.CHANNEL-MOD(KL$TERMINAL_ID.TERM.CHANNEL
             26888                            ,2048/*'800'X*/);
     2724    26889    3                   LASTCHAN=BASECHAN+(1920/*'800'X-'80'X*/);
     2725    26890    3                   END;
     2726    26891    3              ELSE DO;
     2727    26892    3                   BASECHAN=KL$TERMINAL_ID.TERM.CHANNEL;
     2728    26893    3                   LASTCHAN=KL$TERMINAL_ID.TERM.CHANNEL;
     2729    26894    3                   END;
     2730    26895    2         IF BASECHAN ~= LASTCHAN
     2731    26896    3         THEN DO;
     2732    26897    3              KL$TERMINAL_ID.TERM.CHANNEL=BASECHAN;
     2733    26898    3              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);
     2734    26899    4              DO WHILE (KH$CHN.CHNBIT0_9*64 <= LASTCHAN);
     2735    26900    4                   I = KH$CHN.STT;
     2736    26901    4                   CALL CONVERT_STATE (I);
     2737    26902    4                   IF I > KL$CONFIGRSP.CTLR_STATUS
     2738    26903    4                   THEN KL$CONFIGRSP.CTLR_STATUS = I;
     2739    26904    4                   CHN$=PINCRW(CHN$,SIZEW(KH$CHN));
     2740    26905    4                   END;
     2741    26906    3              END;
     2742    26907    2   CONFIG_XIT: CALL GJA$SEND_MSG(UID$,KL$CONFIGRSP,SIZEC(KL$CONFIGRSP));
     2743    26908        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:235  
     2744    26909    2       CASE(IGA_KMSG,IGA_SYSLOG);          /* Keyin message            */
     2745    26910    2         CALL GJA$NETWORK_MANAGER(KL$KEYMES,GJA$PARAMS.DATSIZE);
     2746    26911        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:236  
     2747    26912    2       CASE(IGA_DVCERRRSP);
     2748    26913    2         KL$TERMINAL_ID = KL$DVCERRRSP.TERMID;
     2749    26914    3         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;
     2750    26915    3              ALTRETURN;
     2751    26916    3              END;                         /* WHENALTRETURN            */
     2752    26917    2         IF KH$CHN.HAND$ = ADDR(NIL) THEN ALTRETURN;
     2753    26918    2         CALL GJA$SEND_MSG(KH$CHN.HAND$,GJA$PARAMS.DAT$->BUFFER,GJA$PARAMS.DATSIZE);
     2754    26919        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:237  
     2755    26920    2       CASE(IGA_FEPST);               /* Change in state of network    */
     2756    26921    3         DO CASE (KL$FEPST.PROB);
     2757    26922
     2758    26923    3          CASE (KIER_LNKUP);
     2759    26924    3   CONTACT_NA: ;
     2760    26925    3            ROUTE$ = KNN$ROUTE$(KL$FEPST.FEP);
     2761    26926    3            CTX$ = KNN$ROUTE.CTX$;
     2762    26927    3            IF KNN$ROUTE.CTX$ = ADDR(NIL)
     2763    26928    4            THEN DO;
     2764    26929    5                 IF KL$FEPST.PROB=KIER_LNKUP AND NOT KNN$ROUTE.FLAGS.HOST_NODE THEN DO;
     2765    26930        /*
     2766    26931                      send a link up message to indicate when link recovery occurred
     2767    26932        */
     2768    26933    5                      GJA_SYSLOG.ERRLOG.ERRCODE.ERR# = %E$LINK_UP;
     2769    26934    5                      CALL KHC$UTS(GJA_SYSLOG.ERRLOG.UTS);
     2770    26935    5                      GJA_SYSLOG.ERRLOG.VALUES(0) = KL$FEPST.FEP;
     2771    26936    5                      GJA_SYSLOG.ERRLOG.TERMID.TERM.CHANNEL = KL$FEPST.CHAN#;
     2772    26937    5                      CALL GJA$NETWORK_MANAGER(GJA_SYSLOG,SIZEC(GJA_SYSLOG)-SIZEC(
             26937                               GJA_SYSLOG.ERRLOG.DATA));
     2773    26938    5                      END;
     2774    26939        /*
     2775    26940                      dont send an init if it would only be naked anyway
     2776    26941        */
     2777    26942    4                 IF KL$FEPST.PROB =  KIER_LNKUP
     2778    26943    4                   AND KL$FEPST.FEP > GJA_NODE#
     2779    26944    4                   AND NOT KNN$ROUTE.FLAGS.HOST_NODE THEN RETURN;
     2780    26945
     2781    26946    4                 GJA_CONNECT.RLCID.NODE = KL$FEPST.FEP;
     2782    26947    4                 SIZE = SIZEW(GJA$HAND_CTX);
     2783    26948    4                 CALL KVB$GETSYS(SIZE,CTX$)
     2784    26949    5                 WHENALTRETURN DO;
     2785    26950    5                      ALTRETURN;
     2786    26951    5                      END;
     2787    26952    4                 GJA$HAND_CTX = '0'B;
     2788    26953    4                 GJA$HAND_CTX.WHO = %GJA_UID_NM;
     2789    26954    4                 GJA$HAND_CTX.NODE = KL$FEPST.FEP;
     2790    26955    4                 GJA$HAND_CTX.HOST_NODE = KNN$ROUTE.FLAGS.HOST_NODE;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:238  
     2791    26956    4                 IF GJA_NM_HEAD$ = ADDR(NIL)
     2792    26957    4                 THEN
     2793    26958    4                      GJA_NM_HEAD$ = CTX$;
     2794    26959    5                 ELSE DO;
     2795    26960    5                      GJA$HAND_CTX.LNK$ = GJA_NM_HEAD$;
     2796    26961    5                      GJA_NM_HEAD$ = CTX$;
     2797    26962    5                      END;
     2798    26963    4                 KNN$ROUTE.CTX$ = CTX$;
     2799    26964    4                 CALL GJA$Q_MSG (CTX$,,,SIZEC(GJA_CONNECT),GJA_CONNECT,%KN_FCN_INIT);
     2800    26965    4                 GJA$HAND_CTX.WAT4ACK = '1'B;
     2801    26966    4                 END;
     2802    26967    3            GJA$HAND_CTX.LINK_CONNECTED = KNN$ROUTE.FLAGS.LINK_CONNECTED;
     2803    26968
     2804    26969
     2805    26970    3          CASE (KIER_LNKDWN);
     2806    26971    3            ROUTE$ = KNN$ROUTE$(KL$FEPST.FEP);
     2807    26972    3            CTX$ = KNN$ROUTE.CTX$;
     2808    26973    4            IF NOT KNN$ROUTE.FLAGS.HOST_NODE THEN DO;
     2809    26974    4                 GJA_SYSLOG.ERRLOG.ERRCODE.ERR# = %E$LINK_DOWN;
     2810    26975    4                 CALL KHC$UTS(GJA_SYSLOG.ERRLOG.UTS);
     2811    26976    4                 GJA_SYSLOG.ERRLOG.VALUES(0) = KL$FEPST.FEP;
     2812    26977    4                 GJA_SYSLOG.ERRLOG.TERMID.TERM.CHANNEL = KL$FEPST.CHAN#;
     2813    26978    4                 CALL GJA$NETWORK_MANAGER(GJA_SYSLOG,SIZEC(GJA_SYSLOG)-SIZEC(GJA_SYSLOG
             26978                          .ERRLOG.DATA));
     2814    26979    4                 END;
     2815    26980    3            IF CTX$ ~= ADDR(NIL)
     2816    26981    4            THEN DO;
     2817    26982    4                 GJA$HAND_CTX.LINK_CONNECTED = '0'B;
     2818    26983    4                 IF GJA$HAND_CTX.HOST_NODE
     2819    26984    4                 THEN
     2820    26985    4                      GJA$HAND_CTX.LNKDWNRCVD = '1'B;
     2821    26986    4                 GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;
     2822    26987    4                 END;
     2823    26988
     2824    26989    3          CASE (KIER_QOSCHG);
     2825    26990
     2826    26991    3            ROUTE$ = KNN$ROUTE$(KL$FEPST.FEP);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:239  
     2827    26992    3            CTX$ = GJA_NM_HEAD$;
     2828    26993    3            NODECHG.NODE = KL$FEPST.FEP;
     2829    26994    3            NODECHG.MYNODE = GJA_NODE#;
     2830    26995    3            IF KNN$ROUTE.FLAGS.HOST_NODE = '1'B
     2831    26996    3            THEN
     2832    26997    3                 NODECHG.HOSTNODE = 1;
     2833    26998    3            ELSE
     2834    26999    3                 NODECHG.HOSTNODE = 0;
     2835    27000    3            NODECHG.FCN = IGA_NODECHG;
     2836    27001
     2837    27002    4            DO WHILE (CTX$ ~= ADDR(NIL));
     2838    27003    4                 IF GJA$HAND_CTX.LDCTX ~= 0 AND GJA$HAND_CTX.LINK_CONNECTED
     2839    27004    5                 THEN DO;
     2840    27005    5                      LINK$ = KNN$ROUTE.LINK$;
     2841    27006    5                      IF LINK$ ~= ADDR(NIL) AND KNN$LINK.NODE# = GJA$HAND_CTX.NODE
     2842    27007    5                      THEN
     2843    27008    5                           NODECHG.QOS = KL$FEPST.ALT_QOS;
     2844    27009    5                      ELSE
     2845    27010    5                           NODECHG.QOS = KL$FEPST.QOS;
     2846    27011    5                      IF NODECHG.QOS + GJA_HOPCOST > 255
     2847    27012    5                      THEN
     2848    27013    5                           NODECHG.QOS = 255;
     2849    27014    5                      ELSE
     2850    27015    5                           NODECHG.QOS = NODECHG.QOS + GJA_HOPCOST;
     2851    27016    5                      IF NODECHG.QOS = 255 OR LINK$ = ADDR(NIL) OR
     2852    27017    5                        GJA$HAND_CTX.NODE ~= KNN$LINK.NODE#
     2853    27018    5                      THEN
     2854    27019    5                           CALL GJA$SEND_MSG(CTX$,NODECHG,SIZEC(NODECHG));
     2855    27020    5                      END;
     2856    27021    4                 CTX$ = GJA$HAND_CTX.LNK$;
     2857    27022    4                 END;
     2858    27023
     2859    27024    3            CTX$ = KNN$ROUTE.CTX$;
     2860    27025    3            IF CTX$ ~= ADDR(NIL)
     2861    27026    4            THEN DO;
     2862    27027    4                 IF KL$FEPST.QOS = 255
     2863    27028    4                   AND KNN$ROUTE.FLAGS.HOST_NODE
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:240  
     2864    27029    4                   AND GJA_DEFNODE = KL$FEPST.FEP
     2865    27030    4                   AND NOT GJA$HAND_CTX.LNKDWNRCVD
     2866    27031    4                 THEN
     2867    27032    4                      IF KL$FEPST.REASON = KIER_LNKDWN
     2868    27033    4                      THEN
     2869    27034    4                           GJA_MSG_DOWN$ = GJA_MSG_LINKDOWN$;
     2870    27035    4                      ELSE
     2871    27036    4                           GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;
     2872    27037    4                 GJA$HAND_CTX.LNKDWNRCVD = '0'B;
     2873    27038    4                 END;
     2874    27039    3            ELSE            /* the term bet the qos change message     */
     2875    27040    3                 IF KL$FEPST.QOS = 255
     2876    27041    3                   AND KNN$ROUTE.FLAGS.HOST_NODE
     2877    27042    3                   AND GJA_DEFNODE = KL$FEPST.FEP
     2878    27043    3                   AND KL$FEPST.REASON = KIER_QOSCHG THEN
     2879    27044    3                      GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;
     2880    27045    3            IF KL$FEPST.QOS = 255          /* No connection            */
     2881    27046    3            THEN
     2882    27047    3                 KNN$ROUTE.CTX$ = ADDR(NIL);
     2883    27048
     2884    27049        /* Check to see if this is a new host node */
     2885    27050    3            IF KNN$ROUTE.CTX$ = ADDR(NIL) AND KNN$ROUTE.FLAGS.HOST_NODE
     2886    27051    3              AND KL$FEPST.QOS ~= 255
     2887    27052    4            THEN DO;
     2888    27053    4                 GOTO CONTACT_NA;
     2889    27054    4                 END;
     2890    27055    3            END;
     2891    27056
     2892    27057        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:241  
     2893    27058    2       CASE (IGA_NODEINFO);
     2894    27059
     2895    27060    2         GJA$HAND_CTX.NAME = KL$NODEINFO.MYNAME;
     2896    27061    2         IF KL$NODEINFO.BOSS ~= 0          /* He is my boss            */
     2897    27062    2           AND GJA_UID_NM$ = ADDR(NIL)
     2898    27063    3         THEN DO;
     2899    27064    3              GJA_DEFNODE = GJA$HAND_CTX.NODE;
     2900    27065    3              GJA_UID_NM$ = CTX$;
     2901    27066    3              GJA_LDCT_NM = GJA$HAND_CTX.LDCTX;
     2902    27067    3              IF GJA_FIRST_TIME
     2903    27068    3              THEN
     2904    27069    3                   CALL GJA$GET_CONFIG_INFO;
     2905    27070    3              END;
     2906    27071
     2907    27072        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:242  
     2908    27073    2       CASE (IGA_NODECHG);
     2909    27074    2         CALL GJA$SEND_MSG(GJA_UID_BABOON,KL$NODECHG,SIZEC(KL$NODECHG));
     2910    27075        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:243  
     2911    27076    2       CASE (IGA_TIME);
     2912    27077    2         CALL GJA$SEND_MSG(GJA_UID_BABOON,KL$TIME,SIZEC(KL$TIME));
     2913    27078
     2914    27079        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:244  
     2915    27080    2       CASE (IGA_DUMPMSG);
     2916    27081    2         CALL GIJ$DUMPMSG(KL$MES);
     2917    27082
     2918    27083    2       CASE (IGA_CHSCRLVL);
     2919    27084    2         CALL GJA$SEND_MSG(GJA_UID_BABOON,KL$CHSCRLVL,SIZEC(KL$CHSCRLVL));
     2920    27085        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:245  
     2921    27086    2       CASE(IGA_UPDOSI,IGA_DELOSI);
     2922    27087        /*
     2923    27088             forward message to baboon for inclusion in our osiroute tables.
     2924    27089        */
     2925    27090    2         CALL GJA$SEND_MSG(GJA_UID_BABOON$,KL$UPDOSI,SIZEC(KL$UPDOSI));
     2926    27091
     2927    27092    2       CASE(IGA_OSILINKCHG,IGA_OSILINKCHG_DF);
     2928    27093          /*
     2929    27094             an osi link on a remote system has changed status(up/down).
     2930    27095             forward the message to all link connected nodes except the one
     2931    27096             which sent us this message
     2932    27097        */
     2933    27098    2         I = KL$OSILINKCHG.NODE#;     /* node# of osi link location    */
     2934    27099    3         IF KL$OSILINKCHG.FCN = IGA_OSILINKCHG_DF THEN DO;
     2935    27100    3              KL$OSILINKCHG.FCN = IGA_OSILINKCHG;
     2936    27101    3              CALL GJA$SEND_MSG(GJA_UID_BABOON$,KL$OSILINKCHG,SIZEC(KL$OSILINKCHG));
     2937    27102    3              RETURN;
     2938    27103    3              END;
     2939    27104    2         CALL GJA$SEND_MSG(GJA_UID_BABOON$,KL$OSILINKCHG,SIZEC(KL$OSILINKCHG));
     2940    27105    2         OSILINKCHG = KL$OSILINKCHG;
     2941    27106    2   FORWARDOSI:;
     2942    27107    2         OSILINKCHG.FCN = IGA_OSILINKCHG;
     2943    27108    2         OSILINKCHG.MYNODE# = GJA_NODE#;
     2944    27109    2         CTX$ = GJA_NM_HEAD$;
     2945    27110    3         DO WHILE CTX$ ~= ADDR(NIL);
     2946    27111    3              IF GJA$HAND_CTX.LINK_CONNECTED AND GJA$HAND_CTX.NODE ~= KL$OSILINKCHG.
             27111                       MYNODE# AND
     2947    27112    4                GJA$HAND_CTX.WAT4ACK ~= '1'B THEN DO;
     2948    27113    4                   CALL GJA$SEND_MSG(CTX$,OSILINKCHG,SIZEC(OSILINKCHG));
     2949    27114    4                   END;     /* if link_connected and node ~= mynode    */
     2950    27115    3              CTX$ = GJA$HAND_CTX.LNK$;
     2951    27116    3              END;                         /* while ctx$               */
     2952    27117
     2953    27118    2       CASE(IGA_OSILINKUP,IGA_OSILINKDOWN);
     2954    27119    2         OSILINKCHG = '0'B;
     2955    27120    2         OSILINKCHG.TYPE = KL$OSILINKCHG.FCN;
             27120                  /* osilinkchg intra fep, up/down inter fep*/
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:246  
     2956    27121    2         OSILINKCHG.NODE# = GJA_NODE#; /* this is a message about our fep */
     2957    27122    2         OSILINKCHG.SNPA = KL$OSILINKCHG.SNPA;
     2958    27123    2         OSILINKCHG.QOS = KL$OSILINKCHG.QOS;
     2959    27124    2         OSILINKCHG.TERMID.TERM.CHANNEL = KL$OSILINKCHG.TERMID.TERM.CHANNEL;
     2960    27125    2         GOTO FORWARDOSI;
     2961    27126
     2962    27127    2         END;                              /* case on iga_?            */
     2963    27128    1      RETURN;
     2964    27129        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:247  
     2965    27130    1   ALLOCATE_CHAN: PROC (CTX$);
     2966    27131
     2967    27132    2   DCL CTX$ PTR;
     2968    27133
     2969    27134    2      CHN$ = GJA_CHNLOW$;
     2970    27135    3      DO WHILE (CHN$ <= GJA_CHNHI$);
     2971    27136    3           IF KH$CHN.STT = %KH#CHN_STT_NTRDY AND NOT GJA_FIRST_TIME
     2972    27137    3           THEN
     2973    27138    3                KH$CHN.STT = %KH#CHN_STT_UN_INT;
     2974    27139    3           IF KH$CHN.CHNBIT0_9 ~= 0
     2975    27140    3             AND CTX$->GJA$HAND_CTX.RES = KH$CHN.RESOURCE
     2976    27141    3             AND (CTX$->GJA$HAND_CTX.ATTR &~ KH$CHN.ATTR)= '0'B
     2977    27142    3             AND KH$CHN.STT = %KH#CHN_STT_UN_INT
     2978    27143    3             AND KH$CHN.SYSID = 0
     2979    27144    4           THEN DO;
     2980    27145    4                KH$CHN.HAND$ = CTX$;
     2981    27146    4                KH$CHN.SYSID = CTX$->GJA$HAND_CTX.SYSID;
     2982    27147    4                CALL UPDATE_SUBS ( KH$CHN );
     2983    27148    4                END;
     2984    27149    3           CHN$ = PINCRW(CHN$,SIZEW(KH$CHN));
     2985    27150    3           END;
     2986    27151    2      ADMIN = GJA_ADMIN;
     2987    27152    2      ADMIN.TERMID_LO.LEV = %TERMINAL_ID_LEV_CHAN#;
     2988    27153    2      ADMIN.TERMID_LO.TERM.CHANNEL = GJA_CHNLOW;
     2989    27154    2      ADMIN.TERMID_HI.LEV = %TERMINAL_ID_LEV_CHAN#;
     2990    27155    2      ADMIN.TERMID_HI.TERM.CHANNEL = GJA_CHNHI;
     2991    27156    2      ADMIN.FNC = %KHA_FNC_INTDVC;
     2992    27157    2      CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));
     2993    27158
     2994    27159    2      RETURN;
     2995    27160    2   END ALLOCATE_CHAN;
     2996    27161        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:248  
     2997    27162
     2998    27163        /*P*
     2999    27164              NAME:  UPDATE_SUBS
     3000    27165              PURPOSE: To update CHAN$ and SYSID in the channel tables
     3001    27166                       of the sub and subsubchannels of a base channel.
     3002    27167              DESCRIPTION: See above.
     3003    27168              CALL:  CALL UPDATE_SUBS ( KH$CHN );
     3004    27169              INPUT: KH$CHN is channel table of base channel.
     3005    27170              OUTPUT: None.
     3006    27171        */
     3007    27172
     3008    27173    1   UPDATE_SUBS: PROC ( BAS_CHN );
     3009    27174
     3010    27175        %KH$CHN ( NAME=BAS_CHN, STCLASS= );
     3011    27299
     3012    27300    2   DCL SUB$ PTR;
     3013    27301    2   DCL SUBSUB$ PTR;
     3014    27302        %KH$CHN ( STCLASS=BASED );
     3015    27426
     3016    27427    2      IF ( BAS_CHN.TERMID.LEV ~= %TERMINAL_ID_LEV_CHAN# ) THEN
     3017    27428    2           RETURN;
     3018    27429
     3019    27430    2      SUB$ = BAS_CHN.SUB$;
     3020    27431    3      DO WHILE ( SUB$ ~= ADDR(NIL) );
     3021    27432    3           SUBSUB$ = SUB$->KH$CHN.SUB$;
     3022    27433    4           DO WHILE ( SUBSUB$ ~= ADDR(NIL) );
     3023    27434    4                SUBSUB$->KH$CHN.HAND$ = BAS_CHN.HAND$;
     3024    27435    4                SUBSUB$->KH$CHN.SYSID = BAS_CHN.SYSID;
     3025    27436    4                SUBSUB$ = SUBSUB$->KH$CHN.LNK$;
     3026    27437    4                END;
     3027    27438    3           SUB$->KH$CHN.HAND$ = BAS_CHN.HAND$;
     3028    27439    3           SUB$->KH$CHN.SYSID = BAS_CHN.SYSID;
     3029    27440    3           SUB$ = SUB$->KH$CHN.LNK$;
     3030    27441    3           END;
     3031    27442
     3032    27443    2   END UPDATE_SUBS;
     3033    27444
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:249  
     3034    27445        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:250  
     3035    27446    1   DEFAULT_HAND: PROC;
     3036    27447
     3037    27448    2   DCL RES CHAR(2);
     3038    27449    2   DCL ATTR BIT(16);
     3039    27450
     3040    27451    2      CTX$ = GJA_HAND_HEAD$;
     3041    27452
     3042    27453    3      DO WHILE(CTX$ ~= ADDR(NIL));
     3043    27454    3           IF CTX$->GJA$HAND_CTX.NAME = KL$CHNRSP.HANDLER
     3044    27455    3           THEN
     3045    27456    3                EXIT;
     3046    27457    3           CTX$ = CTX$->GJA$HAND_CTX.LNK$;
     3047    27458    3           END;
     3048    27459
     3049    27460    3      DO SELECT (KL$CHNRSP.HANDLER);
     3050    27461
     3051    27462    3           SELECT('ASYNC');
     3052    27463    3           RES = 'CL';
     3053    27464    3           ATTR = %G_ATTR_CL_ASYNC;
     3054    27465
     3055    27466    3           SELECT ('UNITREC');
     3056    27467    3           RES = 'UR';
     3057    27468    3           ATTR = '0'B;
     3058    27469
     3059    27470    3           SELECT ('BISYNC');
     3060    27471    3           RES='CL';
     3061    27472    3           ATTR = %G_ATTR_CL_SYNC;
     3062    27473
     3063    27474    3           SELECT ('HDLCX25');
     3064    27475    3           RES = 'CL';
     3065    27476    3           ATTR = %G_ATTR_CL_HDLC;
     3066    27477
     3067    27478    3           SELECT ('COUPLER');
     3068    27479    3           RES = 'HL';
     3069    27480    3           ATTR = '0'B;
     3070    27481
     3071    27482    3           SELECT (ELSE);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:251  
     3072    27483
     3073    27484    3      RES = '  ';
     3074    27485    3      ATTR = '0'B;
     3075    27486
     3076    27487    3           END;
     3077    27488    2      IF CTX$ ~= ADDR(NIL) AND CTX$->GJA$HAND_CTX.RES ~= ' '
     3078    27489    3      THEN DO;
     3079    27490    3           RES = CTX$->GJA$HAND_CTX.RES;
     3080    27491    3           ATTR = CTX$->GJA$HAND_CTX.ATTR;
     3081    27492    3           END;
     3082    27493
     3083    27494    2      IF NA.RESPRES
     3084    27495    2      THEN
     3085    27496    2           RES = NA.RES;
     3086    27497    2      IF NA.ATTRPRES
     3087    27498    2      THEN
     3088    27499    2           ATTR = NA.ATTR;
     3089    27500
     3090    27501    2      IF CTX$ ~= ADDR(NIL)
     3091    27502    3      THEN DO;
     3092    27503    3           CTX$->GJA$HAND_CTX.RES = RES;
     3093    27504    3           CTX$->GJA$HAND_CTX.ATTR = ATTR;
     3094    27505    3           END;
     3095    27506
     3096    27507    2      CHN$ = GJA_CHNLOW$;
     3097    27508
     3098    27509    2      IF GJA_FIRST_TIME
     3099    27510    2      THEN
     3100    27511    3      DO WHILE (CHN$ <= GJA_CHNHI$);
     3101    27512
     3102    27513    3           IF KH$CHN.RESOURCE = RES AND
     3103    27514    3             (ATTR & ~KH$CHN.ATTR )='0'B
     3104    27515    4           THEN DO;
     3105    27516    4                KL$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN#;
     3106    27517    4                KL$TERMINAL_ID.TERM.CHANNEL = KH$CHN.CHNBIT0_9 * 64;
     3107    27518    4                CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,HNDCMN);
     3108    27519    4                END;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:252  
     3109    27520    3           CHN$ = PINCRW(CHN$,SIZEW(KH$CHN));
     3110    27521    3           END;
     3111    27522
     3112    27523        /* If MSGSIZE is non zero there is a default profile */
     3113    27524    2      IF KL$CHNRSP.MESSAGE.MSGSIZE ~= 0
     3114    27525    3      THEN DO;
     3115    27526    3           ADDR(VDO_BUFFER)->KL$PRFRSP.FCN = IGA_PRFRSP;
     3116    27527    3           ADDR(VDO_BUFFER)->KL$PRFRSP.PROFILE.PRFSIZE = KL$CHNRSP.MESSAGE.MSGSIZE;
     3117    27528    3           ADDR(VDO_BUFFER)->KL$PRFRSP.PROFILE.PRFTXT = KL$CHNRSP.MESSAGE.MESSAGE;
     3118    27529    3           IF CTX$ ~= ADDR(NIL)
     3119    27530    3           THEN
     3120    27531    3                CALL GJA$SEND_MSG(CTX$,VDO_BUFFER,SIZEC(ADDR(VDO_BUFFER)->KL$PRFRSP));
     3121    27532    3           END;
     3122    27533
     3123    27534    2      RETURN;
     3124    27535
     3125    27536    2   END DEFAULT_HAND;
     3126    27537        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:253  
     3127    27538    1   CONVERT_STATE: PROC(STATUS);
     3128    27539    2   DCL STATUS UBIN;
     3129    27540
     3130    27541    3      DO CASE(STATUS);
     3131    27542
     3132    27543    3       CASE (%KH#CHN_STT_PRT);
     3133    27544    3         STATUS = %CHNST_PART#;
     3134    27545
     3135    27546    3       CASE (%KH#CHN_STT_DSB);
     3136    27547    3         STATUS = %CHNST_DSB#;
     3137    27548
     3138    27549    3       CASE (%KH#CHN_STT_DIAG);
     3139    27550    3         STATUS = %CHNST_DIAG#;
     3140    27551
     3141    27552    3       CASE (ELSE);
     3142    27553    3         STATUS = %CHNST_ENB#;
     3143    27554
     3144    27555    3         END;
     3145    27556
     3146    27557    2      RETURN;
     3147    27558
     3148    27559    2   END CONVERT_STATE;
     3149    27560        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:254  
     3150    27561    1   FIND_NODE: PROC(NODE#,NM$) ALTRET;
     3151    27562
     3152    27563    2   DCL NODE# UBIN;
     3153    27564    2   DCL NM$ PTR;
     3154    27565
     3155    27566    2      NM$ = GJA_NM_HEAD$;
     3156    27567
     3157    27568    3      DO WHILE(NM$ ~= ADDR(NIL));
     3158    27569    3           IF NM$->GJA$HAND_CTX.NODE = NODE#
     3159    27570    3             AND NM$->GJA$HAND_CTX.LDCTX ~=0
     3160    27571    3           THEN
     3161    27572    3                RETURN;
     3162    27573    3           NM$ = CTX$->GJA$HAND_CTX.LNK$;
     3163    27574    3           END;
     3164    27575
     3165    27576    2      ALTRETURN;
     3166    27577
     3167    27578    2   END FIND_NODE;
     3168    27579        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:255  
     3169    27580    1   CHN_HANDLER: PROC ALTRET;
     3170    27581
     3171    27582    2      THAND$ = ADDR(NIL);
     3172    27583    2      KL$TERMINAL_ID.LEV = TERMLO.LEV;
     3173    27584    3      DO CHAN = CHANLO TO CHANHI BY 128;
     3174    27585    4           DO SUB = SUBLO TO SUBHI;
     3175    27586    5                DO SUBSUB = SUBSUBLO TO SUBSUBHI;
     3176    27587    5                     KL$TERMINAL_ID.TERM.CHANNEL = CHAN;
     3177    27588    5                     KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;
     3178    27589    5                     KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;
     3179    27590    6                     CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;
     3180    27591    6                          ADMIN.RESULTS=E$CHAN_NOT_THERE;
     3181    27592    6                          ALTRETURN;
     3182    27593    6                          END;
     3183    27594    6                     IF KH$CHN.HAND$ ~= ADDR(NIL) AND THAND$ ~= ADDR(NIL) THEN DO;
     3184    27595    6                          IF KH$CHN.HAND$ ~= THAND$ THEN
     3185    27596    7                          DO;
     3186    27597    7                               ADMIN.RESULTS=E$ADMIN_ERR;
     3187    27598        /*E* ERROR: GJA-E$ADMIN_ERR
     3188    27599             MESSAGE: The range of channels specified in your admin request do not
     3189    27600                      belong to the same handler.
     3190    27601             MESSAGE1: Admin commands such as kill,enable,part etc when executed on
     3191    27602                       a range of channels will not work if the channels do not
     3192    27603                       belong to the same handler. KH$CHN.HAND$                 */
     3193    27604    7                               ALTRETURN;
     3194    27605    7                               END;
     3195    27606    6                          END;
     3196    27607    5                     ELSE
     3197    27608    5                          THAND$ = KH$CHN.HAND$;
     3198    27609    5                     END;                  /*SUBSUB*/
     3199    27610    4                END;                       /*SUB*/
     3200    27611    3           END;                            /*CHAN*/
     3201    27612    2   END CHN_HANDLER;
     3202    27613    1   END GJA$DECODE_APL_MSG;
     3203    27614        %EOD;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:256  
--  Include file information  --

   K_ADDRESS_M.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KN_ERRORS_C.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$IO.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   GJA_MSG_M.:E05TOU  is referenced.
   GH_IOFNC_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure GJA$DECODE_APL_MSG.

   Procedure GJA$DECODE_APL_MSG requires 8849 words for executable code.
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:257  
   Procedure GJA$DECODE_APL_MSG requires 288 words of local(AUTO) storage.

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:258  

 Object Unit name= GJA$DECODE_APL_MSG                         File name= GJA$ADMIN.:E05TOU
 UTS= JUL 29 '97 21:51:56.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none   525    20D  GJA$DECODE_APL_MSG
    1  RoData even  UTS     50     32  GJA$DECODE_APL_MSG
    2   Proc  even  none  8849   2291  GJA$DECODE_APL_MSG
    3  RoData even  none     6      6  GJA$DECODE_APL_MSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  GJA$DECODE_APL_MSG

  ****  Data defs  ****

 Sect HexLoc  Name                           Sect HexLoc  Name
    1      0  E$NONETMAN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:259  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       6 GJA$Q_MSG
 yes     yes           Std       1 GJA$NA_INFO
 yes     yes           Std       2 GJA$NETWORK_MANAGER
 yes     yes           Std       4 GJA$SEND_MSG
         yes           Std       1 GJA$DISOLVE_LGNUSR_CTX
 yes     yes           Std       2 GJA$LINEPROFILE
         yes           Std       0 GIJ$INITDUMP
 yes     yes           Std       2 KVB$GETSYS
         yes           Std       1 GJA$GET_CONFIG_INFO
 yes     yes           Std       2 KVB$GET2NSYS
 yes     yes           Std       1 KHC$UTS
         yes           Std       1 GIJ$DUMPMSG
 yes     yes           Std       2 GJA$CHK_TRM_RNG
 yes     yes           Std       0 GJA$HOST_RESUMED
 yes     yes           Std       2 GJA$GET_CHNTBL_PTR
 yes     yes           Std       3 GJA$BLD_CTX
 yes     yes           Std       1 GJA$LOGON_REQUEST_AGAIN
 yes     yes           Std       2 KVB$RLSSYS
 yes     yes           Std       1 GJA$LOGON_RESPONCE
 yes     yes           Std       3 GJA$UPDATE_CHNTBL
         yes           Std       1 GJA$DISOLVE_ERRMSG_CTX
 yes     yes           Std       2 KHI$IO_OTP
                       nStd      0 X6A_AUTO_2
                       nStd      0 X6A_ARET
                       nStd      0 X6A_AALT
                       nStd      0 X6C_ALR
                       nStd      0 X6C_ALRZ
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:260  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     GID_BOOTCHAN                          GJA_HOPCOST                           GJA_DEFNODE
     GJA_ROUTE$                            GJA_OSIROUTE$                         GJA_NM_HEAD$
     GJA_NODE#                             GJA_LDCT_NM                           GJA_LDCT_BABOON
     GJA_UID_NM                            GJA_UID_BABOON                        GJA_UID_NANM$
     GJA_USRLGN_HEAD$                 r    G$TCB$                                GJA_HAND_HEAD$
     GJA_ERRMSG_HEAD$                      GJA_MSG_HOSTDOWN$                     GJA_MSG_LINKDOWN$
     GJA_MSG_DOWN$                         GJA_HOSTRESUMED$                      GJA_LGNTIMEDOUT$
     GJA_NOLOGONMSG$                       GJA_MSG_SALUTE$                       GJA_MSG_HDR$
     GJA_FIRST_TIME                        GJA_HSTRSMED                          GJA_MSG_SGSYN$
     GJA_MSG_NOHOST$                       GJA_MSG_UDHOST$                       GJA_MSG_BDID$
     GJA_MAXRDS                            GJA$NODETBL                           GJA_SYSLOG
     GJA_IO                                GJA_TERM                              GJA_TERM_ACK
     GJA_CONNECT                           GJA_CHNHI                             GJA_CHNLOW
     GJA_CHNLOW$                           GJA_CHNHI$                            GJA_PARAM_VDO
     GJA_VDO_DAT_DAT1                      GJA_VDO_DAT_DAT2                      GJA_PROMPT_VDO
     GJA_RQSCHN                            GJA_ADMIN                        r    G$ROS$
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:261  


     1038        1        /*T***********************************************************/
     1039        2        /*T*                                                         */
     1040        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1041        4        /*T*                                                         */
     1042        5        /*T***********************************************************/
     1043        6        /*F*    NAME:  GJA$DECODE_APL_MSG
     1044        7                PURPOSE:  This routine is called when GJA$ADMIN determines
     1045        8                          that a message passed is from the network manager.
     1046        9                          This routine determines what type of message it
     1047       10                          was called with and acts on it.
     1048       11                DESCRIPTION:  This routine is fairly simple.  It just determines
     1049       12                              what type of message was sent and acts on it.
     1050       13                CALL:  CALL GJA$DECODE_APL_MSG(MSG$,APP$) ALTRET(label)
     1051       14                INPUT: MSG$ - Points to the head of the message
     1052       15                       APP$ - Points to the IGA message header
     1053       16                       VDO$ - Points to the start of the VDO
     1054       17        */
     1055       18        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:262  
     1056       19        GJA$DECODE_APL_MSG: PROC(GJA$PARAMS,MSGCTX$) ALTRET;

     19   2 000000  D380 0000 0000  xent GJA$DECODE_APL_*LNJ,B5   X6A_AUTO_2
          2 000003       0120 0002                       DC       288,2

     1057       20
     1058       21        %INCLUDE CP_6_SUBS;
     1059      561        %INCLUDE LCP_6;
     1060     4840        %INCLUDE GH_IOFNC_E;
     1061     4909        %INCLUDE GJA_MSG_M;
     1062     5148        %INCLUDE KH$CHN;
     1063     5270        %INCLUDE KH$IO;
     1064     5517        %INCLUDE KL_AFCN_C;                     /* 'IGA' Function Codes     */
     1065     5618        %INCLUDE KL_MACRO_C;
     1066     8970        %INCLUDE KNH_MACRO_C;
     1067     9253        %INCLUDE KV$VDO;
     1068    10268        %INCLUDE KV$GLB;
     1069    10687        %INCLUDE KV$GLBCTX;
     1070    11132        %INCLUDE KV_GLBCNS_E;
     1071    11473        %INCLUDE KI_ERRORS_C;
     1072    11558        %INCLUDE KI_SUBS_C;
     1073    11694        %INCLUDE KNN_NETWORK_M;
     1074    12057        %INCLUDE KN_ERRORS_C;
     1075    12121        %INCLUDE KL_SUPER_C;
     1076    15023        %INCLUDE NK_VFC_C;
     1077    15097        %INCLUDE KHA_FNC_E;
     1078    15197        %INCLUDE K_ID_E;
     1079    15247        %INCLUDE K_SCODE_C;
     1080    15332        %INCLUDE K_ADDRESS_M;
     1081    15835                                                /* Equates                  */
     1082    15836        %GJA_UID_EQUS;
     1083    15844                                                /* VDO stuff                */
     1084    15845        %KV_VDO_E;
     1085    15881        %KV_VDOVLP_E;
     1086    15895        %KV_DATCTRCHRTYP_E;
     1087    15901        %KV_DATMOD_E;
     1088    15907        %K#LYRID_E;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:263  
     1089    15914        %K#ENTID_E;
     1090    15933                                                /* Args                     */
     1091    15934        %GJA$PARAMS(STCLASS=PARAM);
     1092    15949    1   DCL MSGCTX$ PTR;
     1093    15950                                                /* Symrefs                  */
     1094    15951    1   DCL GID_BOOTCHAN UBIN SYMREF;
     1095    15952    1   DCL GJA_HOPCOST UBIN SYMREF;
     1096    15953    1   DCL GJA_DEFNODE UBIN SYMREF;
     1097    15954    1   DCL GJA_ROUTE$ PTR SYMREF;
     1098    15955    1   DCL GJA_OSIROUTE$ PTR SYMREF;
     1099    15956    1   DCL GJA_LINKS UBIN SYMREF;
     1100    15957    1   DCL GJA_OSIMAX# UBIN SYMREF;
     1101    15958    1   DCL GJA_NM_HEAD$ PTR SYMREF;
     1102    15959    1   DCL GJA_NODE# UBIN SYMREF;
     1103    15960    1   DCL GJA_LDCT_NM UBIN SYMREF;
     1104    15961    1   DCL GJA_LDCT_BABOON UBIN SYMREF;
     1105    15962    1   DCL GJA_UID_NM UBIN(32) SYMREF;
     1106    15963    1   DCL GJA_UID_NM$ REDEF GJA_UID_NM PTR;
     1107    15964    1   DCL GJA_UID_BABOON UBIN(32) SYMREF;
     1108    15965    1   DCL GJA_UID_BABOON$ REDEF GJA_UID_BABOON PTR;
     1109    15966    1   DCL GJA_UID_NANM$ PTR SYMREF;
     1110    15967    1   DCL GJA_USRLGN_HEAD$ PTR SYMREF;
     1111    15968    1   DCL G$TCB$ PTR SYMREF READONLY;
     1112    15969    1   DCL GJA_HAND_HEAD$ PTR SYMREF;
     1113    15970    1   DCL GJA_ERRMSG_HEAD$ PTR SYMREF;
     1114    15971    1   DCL GJA_MSG_HOSTDOWN$ PTR SYMREF;
     1115    15972    1   DCL GJA_MSG_LINKDOWN$ PTR SYMREF;
     1116    15973    1   DCL GJA_MSG_DOWN$ PTR SYMREF;
     1117    15974    1   DCL GJA_HOSTRESUMED$ PTR SYMREF;
     1118    15975    1   DCL GJA_LGNTIMEDOUT$ PTR SYMREF;
     1119    15976    1   DCL GJA_NOLOGONMSG$ PTR SYMREF;
     1120    15977    1   DCL GJA_MSG_SALUTE$ PTR SYMREF;
     1121    15978    1   DCL GJA_MSG_HDR$ PTR SYMREF;
     1122    15979    1   DCL GJA_FIRST_TIME BIT(1) SYMREF;
     1123    15980    1   DCL GJA_HSTRSMED BIT(1) SYMREF;
     1124    15981    1   DCL GJA_MSG_SGSYN$ PTR SYMREF;
     1125    15982    1   DCL GJA_MSG_NOHOST$ PTR SYMREF;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:264  
     1126    15983    1   DCL GJA_MSG_UDHOST$ PTR SYMREF;
     1127    15984    1   DCL GJA_MSG_BDID$ PTR SYMREF;
     1128    15985    1   DCL GJA_MAXRDS UBIN SYMREF;
     1129    15986        %GJA_NODETBL(NAME=GJA$NODETBL,STCLASS="SYMREF");
     1130    16010
     1131    16011        %KL_SYSLOG(FPTN=GJA_SYSLOG,LAST=",",STCLASS=SYMREF);
     1132    16035        %KL_ERRLOG(FPTN=ERRLOG,LAST=",",LVL=2,STCLASS=SYMREF);
     1133    16143    1           3 DATA CHAR(200) UNAL;
     1134    16144
     1135    16145        %KH$IO (FPTN=GJA_IO,FNC=%GH#IO_OTPCHNCTR,STPIO=YES,STCLASS=SYMREF);
     1136    16259        %FPT_TERM (FPTN=GJA_TERM,STCLASS=SYMREF);
     1137    16281        %FPT_TERM_ACK(FPTN=GJA_TERM_ACK,STCLASS=SYMREF);
     1138    16303        %FPT_CONNECT (FPTN=GJA_CONNECT,STCLASS=SYMREF);
     1139    16372        %FPT_CONNECT_ACK(FPTN=GJA_CONNECT_ACK,STCLASS=SYMREF);
     1140    16421    1   DCL GJA_CHNHI UBIN SYMREF;
     1141    16422    1   DCL GJA_CHNLOW UBIN SYMREF;
     1142    16423    1   DCL GJA_CHNLOW$ PTR SYMREF;
     1143    16424    1   DCL GJA_CHNHI$ PTR SYMREF;
     1144    16425        %KV$VDO_PRM(NAME=GJA_PARAM_VDO,LAST=",",STCLASS=SYMREF);
     1145    16466        %KV$VDOVLP_DAT2(STCLASS="",LVL=2);
     1146    16516        %KV$VDO_DAT(NAME=GJA_VDO_DAT_DAT1,STCLASS=SYMREF,LAST=",");
     1147    16561        %KV$VDOVLP_DAT1(STCLASS="",LVL=2);
     1148    16611        %KV$VDO_DAT(NAME=GJA_VDO_DAT_DAT2,STCLASS=SYMREF,LAST=",");
     1149    16656        %KV$VDOVLP_DAT2(STCLASS="",LVL=2);
     1150    16706        %KV$VDO_PRM(NAME=GJA_PROMPT_VDO,STCLASS=SYMREF,LAST=",");
     1151    16747             %KV$VDOVLP_DAT2(NAME=DAT2,STCLASS=SYMREF,LVL=2,LAST=",");
     1152    16797    1         2 TL,
     1153    16798    1           3 TYPE UBIN BYTE UNAL,
     1154    16799    1           3 LEN UBIN BYTE UNAL,
     1155    16800    1         2 VFC CHAR(1) UNAL,
     1156    16801    1         2 PROMPT CHAR(39) UNAL;
     1157    16802                                                /* Fpts                     */
     1158    16803        %FPT_AFD(FPTN=FPT_AFD);
     1159    16818        %FPT_MAKEUSR(FPTN=FPT_MAKEUSR);
     1160    16833        %FPT_RUE (FPTN=FPT_RUE);
     1161    16856                                                /* Errcodes                 */
     1162    16857        %VLP_ERRCODE(FPTN=E$CONT_NOT_PART,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CONT_NOT_ALL_PART,
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:265  
             16857            SEV=%G_SEV_ERROR#);
     1163    16903       %VLP_ERRCODE(FPTN=E$CHAN_NOT_THERE,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CHAN_NOT_THERE,SEV=
             16903            %G_SEV_ERROR#);
     1164    16949        %VLP_ERRCODE(FPTN=E$NO_MORE_DEVICES,FCG=GJ,MID=A,MON='1'B,ERR#=%E$NO_MORE_DEVICES,
             16949            SEV=%G_SEV_ERROR#);
     1165    16995        %VLP_ERRCODE(FPTN=E$ADMIN_ERR,FCG=GJ,MID=A,MON='1'B,ERR#=%E$ADMIN_ERR,SEV=
             16995            %G_SEV_ERROR#);
     1166    17041       %VLP_ERRCODE(FPTN=E$UNOWNED,FCG=GJ,MID=A,MON='1'B,ERR#=%E$UNOWNED,SEV=%G_SEV_ERROR#)
             17041            ;
     1167    17087        %VLP_ERRCODE(FPTN=E$ILGLTRANS,FCG=GJ,MID=A,MON='1'B,ERR#=%E$ILGLTRANS,SEV=
             17087            %G_SEV_ERROR#);
     1168    17133        %VLP_ERRCODE(FPTN=E$CANTPART,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CANTPART,SEV=
             17133            %G_SEV_ERROR#);
     1169    17179        %VLP_ERRCODE(FPTN=E$CHAN_NOT_PART,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CHAN_NOT_PART,SEV=
             17179            %G_SEV_ERROR#);
     1170    17225        %VLP_ERRCODE(FPTN=E$CHAN_BUSY,FCG=GJ,MID=A,MON='1'B,ERR#=%E$CHAN_BUSY,SEV=
             17225            %G_SEV_ERROR#);
     1171    17271        %VLP_ERRCODE(FPTN=E$CONT_MUST_HAVE_DIAG,FCG=GJ,MID=A,MON='1'B,
     1172    17272                     ERR#=%E$CONT_MUST_HAVE_DIAG,SEV=%G_SEV_ERROR#);
     1173    17318        %VLP_ERRCODE(FPTN=E$CONT_OWNED,FCG=GJ,MID=A,MON='1'B,
     1174    17319                     ERR#=%E$CONT_OWNED,SEV=%G_SEV_ERROR#);
     1175    17365        %VLP_ERRCODE(FPTN=E$CHAN_OWNED,FCG=GJ,MID=A,MON='1'B,
     1176    17366                     ERR#=%E$CHAN_OWNED,SEV=%G_SEV_ERROR#);
     1177    17412        %VLP_ERRCODE(FPTN=E$NO_DEVICES,FCG=GJ,MID=A,MON='1'B,
     1178    17413                     ERR#=%E$NO_DEVICES,SEV=%G_SEV_ERROR#);
     1179    17459        %VLP_ERRCODE(FPTN=E$NOTYOURS,FCG=GJ,MID=A,MON='1'B,
     1180    17460                     ERR#=%E$NOTYOURS,SEV=%G_SEV_ERROR#);
     1181    17506        %VLP_ERRCODE(FPTN=E$CHAN_PART,FCG=GJ,MID=A,MON='1'B,
     1182    17507                     ERR#=%E$CHAN_PART,SEV=%G_SEV_ERROR#);
     1183    17553        %VLP_ERRCODE (FPTN=E$CHAN_DIAG,FCG=GJ,MID=A,MON='1'B,
     1184    17554                      ERR#=%E$CHAN_DIAG,SEV=%G_SEV_ERROR#);
     1185    17600        %VLP_ERRCODE(FPTN=E$ALLREADY_IS,FCG=GJ,MID=A,MON='1'B,
     1186    17601                     ERR#=%E$ALLREADY_IS,SEV=%G_SEV_ERROR#);
     1187    17647        %VLP_ERRCODE(FPTN=E$NOT_OWNED,FCG=GJ,MID=A,MON='1'B,
     1188    17648                     ERR#=%E$NOT_OWNED,SEV=%G_SEV_ERROR#);
     1189    17694        %VLP_ERRCODE(FPTN=E$NO_HANDLER,FCG=GJ,MID=A,MON='1'B,
     1190    17695                     ERR#=%E$NO_HANDLER,SEV=%G_SEV_ERROR#);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:266  
     1191    17741        %VLP_ERRCODE(FPTN=E$NONETMAN,FCG=GJ,MID=A,MON='1'B,
     1192    17742                     ERR#=%E$NONETMAN,SEV=%G_SEV_ERROR#,STCLASS="CONSTANT SYMDEF");
     1193    17788        %VLP_ERRCODE (FPTN=E$NOHANDLER,FCG=GJ,MID=A,MON='1'B,
     1194    17789                       ERR#=%E$NOHANDLER,SEV=%G_SEV_ERROR#);
     1195    17835        %VLP_SCODE (FPTN=HOSTKEYIN,ERR#=%S$HOST_KEYIN,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1196    17896        %VLP_SCODE (FPTN=HOSTBOOT,ERR#=%S$HOST_BOOT,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1197    17957        %VLP_SCODE (FPTN=NODEDEV,ERR#=%S$NODEDEV,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1198    18018        %VLP_SCODE (FPTN=BADFNC,ERR#=%S$BADFNC,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     1199    18079
     1200    18080
     1201    18081                                                /* BASED Structures         */
     1202    18082        %KNN$ROUTE (STCLASS="BASED(ROUTE$)");
     1203    18154        %KNN$LINK (STCLASS="BASED(LINK$)");
     1204    18405    1   DCL KNN$ROUTE$ (0:0) PTR BASED (GJA_ROUTE$);
     1205    18406    1   DCL KNN$OSIROUTE$ (0:0) PTR BASED(GJA_OSIROUTE$);
     1206    18407    1   DCL BUFFER CHAR(999) BASED;
     1207    18408    1   DCL 1 TEXTC_STRING BASED,
     1208    18409    1         2 SIZE UBIN BYTE UNAL,
     1209    18410    1         2 STRING CHAR(TEXTC_STRING.SIZE) UNAL;
     1210    18411    1   DCL STRING CHAR(SIZE) BASED;
     1211    18412        %G$TCB;
     1212    18433        %G$EXCFR;
     1213    18815        %GJA$LGNCTX(STCLASS=BASED);
     1214    18900        %GJA$ERRMSG_CTX(STCLASS=BASED);
     1215    18928        %KH$CHN (STCLASS="BASED(CHN$)");
     1216    19052        %GJA$HAND_CTX(STCLASS="BASED(CTX$)");
     1217    19101        %KL_MES (FPTN=KL$MES,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1218    19124        %KL_KEYMES(FPTN=KL$KEYMES,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1219    19263        %KL_DVCERRRSP (FPTN=KL$DVCERRRSP,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1220    19316        %KL_ACQUIRE(FPTN=KL$ACQUIRE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1221    19398        %KL_AFD(FPTN=KL$AFD,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1222    19438        %KL_RELEASE(FPTN=KL$RELEASE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1223    19493        %KL_CONTROL(FPTN=KL$CONTROL,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1224    19630        %KL_SGN(FPTN=KL$SGN,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1225    19723        %KL_SGNRSP(FPTN=KL$SGNRSP,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1226    19859        %KL_ERRMSG_RQS (FPTN=KL$ERRMSG_RQS,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1227    20034        %KL_ERRMSG_RSP (FPTN=KL$ERRMSG_RSP,STCLASS="BASED(GJA$PARAMS.DAT$)");
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:267  
     1228    20110        %KL_ERRMSG_RSP (FPTN=KL$ERRMSG_RSPSZ,STCLASS=BASED,LONG=NO);
     1229    20186        %KL_CHNRSP(FPTN=KL$CHNRSP,STCLASS="BASED(GJA$PARAMS.DAT$)",MSGSIZE=
             20186            "KL$CHNRSP.MESSAGE.MSGSIZE");
     1230    20406        %KL_FEPST (FPTN=KL$FEPST,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1231    20441        %KL_NODECHG (FPTN=KL$NODECHG,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1232    20465        %KL_NODEINFO (FPTN=KL$NODEINFO,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1233    20489        %KL_TIME (FPTN=KL$TIME,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1234    20513        %KL_RQSCHN(FPTN=KL$RQSCHN,STCLASS="BASED(KL$)");
     1235    20616        %KL_CWNAK (FPTN=KL$CWNAK,STCLASS="BASED(RSP$)");
     1236    20681        %KL_RUE(FPTN=KL$RUE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1237    20785        %KL_STRTU(STCLASS="BASED(GJA$PARAMS.DAT$)");
     1238    20958        %KL_REQSTATS (NAME=KL$REQSTATS,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1239    21252        %KL_PRFRSP(FPTN=KL$PRFRSP,STCLASS="BASED(GJA$PARAMS.DAT$)",PRFSIZE=
             21252            "KL$PRFRSP.PROFILE.PRFSIZE");
     1240    21302        %KL_WRITE(FPTN=KL$WRITE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1241    21341        %KL_ADMIN(FPTN=KL$ADMIN,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1242    21502        %KL_SETNODE(FPTN=KL$SETNODE,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1243    21548        %KL_CNFG_MSG (FPTN=KL$CNFG_MSG,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1244    21832        %KL_CONFIGRSP(FPTN=KL$CONFIGRSP,STCLASS="BASED(RSP$)");
     1245    21923        %KL_CONFIGRQS(FPTN=KL$CONFIGRQS,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1246    21972        %KL_CHSCRLVL(FPTN=KL$CHSCRLVL,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1247    22011        %KL_UPDOSI(FPTN=KL$UPDOSI,ADRTYP=NET,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1248    22220        %KL_OSILINKCHG(FPTN=KL$OSILINKCHG,STCLASS="BASED(GJA$PARAMS.DAT$)");
     1249    22343        %KNN$OSIROUTE(FPTN=KNN$OSIROUTE,STCLASS="BASED(OSI$)");
     1250    22560        %KV$VDO_PRM(NAME=GJA$PROFILE_VDO,LAST=",",STCLASS=BASED);
     1251    22601        %KV$VDOVLP_DAT2(STCLASS="",LVL=2);
     1252    22651        %KV$VDO_DAT(NAME=GJA$VDO_DAT_DAT1,STCLASS=BASED,LAST=",");
     1253    22696        %KV$VDOVLP_DAT1(STCLASS="",LVL=2);
     1254    22746        %KV$VDO(NAME=KV$VDOHDR,STCLASS="BASED(GJA$PARAMS.VDO$)");
     1255    22773        %KV$VDOVLP_DAT1;
     1256    22823        %KV$VDOVLP_DAT2;
     1257    22873        %KV$VDO_DAT;
     1258    22918        %KV$VDOVLP_CG_MSGTYP;
     1259    22970        %KV$VDOVLP_CG_STA;
     1260    23021        %KV$VDOVLP_ERR;
     1261    23118        %KV$VDOVLP_FLDID;
     1262    23169        %KV$VDOVLP_MRK;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:268  
     1263    23222        %KV$VDOVLP_KEY;
     1264    23272        %KV$VDO_RQSDAT(NAME=KV_VDO_RQSDAT,STCLASS=CONSTANT,FNC=KV_VDO_FNC_RQSDAT,
     1265    23273                            MAXRCRBYTSIZ=2048,MAXNMBRCR=999,MAXNMBBYT=2048);
     1266    23321        %KV$VDO_RQSDAT(NAME=KV@VDO_RQSDAT,STCLASS=AUTO);
     1267    23369        %KV$VDI;
     1268    23440                                                /* Static                   */
     1269    23441    1   DCL VDO_BUFFER(0:767) CHAR(1) STATIC;
     1270    23442        %KV$VDO_DAT(NAME=GJA_RETURN_MSG,FNC=KV_VDO_FNC_DAT,STCLASS=STATIC,
     1271    23443                    LAST=",",VLP=YES);
     1272    23488        %KV$VDOVLP_DAT1(STCLASS=STATIC,LST=YES,LAST=",",LVL=2);
     1273    23538        %KL_RETURN(STCLASS=STATIC,LVL=2);
     1274    23572        %KV$VDO_DAT(NAME=GJA_CHN_RSP,FNC=KV_VDO_FNC_DAT,STCLASS=STATIC,LAST=",",VLP=YES);
     1275    23617        %KV$VDOVLP_DAT2(STCLASS=STATIC,LST=YES,LAST=",",LVL=2);
     1276    23667        %KL_ADMIN(FPTN=ADMIN,STCLASS=STATIC,LVL=2,LAST=",");
     1277    23828        %KH$CHN(NAME=CHN,STCLASS=STATIC,LVL=3,LAST=";");
     1278    23952        %KL_RQSCHN (FPTN=GJA_RQSCHN,STCLASS=SYMREF);
     1279    24055        %KL_ADMIN (FPTN=GJA_ADMIN,STCLASS=SYMREF);
     1280    24216        %KL_HDR (FPTN=KL$HDR,STCLASS="BASED(KL$)");
     1281    24297                                                /* AUTO                     */
     1282    24298    1   DCL LINK$ PTR;
     1283    24299    1   DCL ROUTE$ PTR;
     1284    24300    1   DCL STARTCHN$ PTR;
     1285    24301    1   DCL KL$ PTR;
     1286    24302    1   DCL I UBIN;
     1287    24303    1   DCL J UBIN;
     1288    24304    1   DCL CHN$ PTR;
     1289    24305    1   DCL CTX$ PTR;
     1290    24306    1   DCL CTX REDEF CTX$ UBIN(32);
     1291    24307    1   DCL UID UBIN(32);
     1292    24308    1   DCL UID$ REDEF UID PTR;
     1293    24309    1   DCL THAND$ PTR;
     1294    24310    1   DCL TCHN$ PTR;
     1295    24311    1   DCL LVL2$ PTR;
     1296    24312    1   DCL LVL3$ PTR;
     1297    24313    1   DCL RNGFLG BIT(1);
     1298    24314    1   DCL WHO UBIN;
     1299    24315    1   DCL NMI$ PTR;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:269  
     1300    24316    1   DCL SVMSG$ PTR;
     1301    24317    1   DCL OSI$ PTR;
     1302    24318    1   DCL NMID$ PTR;
     1303    24319    1   DCL NMID REDEF NMID$ UBIN(32);
     1304    24320    1   DCL SVCHN$ PTR;
     1305    24321    1   DCL SVCHAN UBIN;
     1306    24322    1   DCL SVATTR BIT(16);
     1307    24323    1   DCL MSGSIZ UBIN;
     1308    24324    1   DCL SIZE UBIN;
     1309    24325    1   DCL RSP$ PTR;
     1310    24326    1   DCL NLINES UBIN;
     1311    24327    1   DCL CONTADDR UBIN;
     1312    24328    1   DCL BASECHAN UBIN;
     1313    24329    1   DCL LASTCHAN UBIN;
     1314    24330    1   DCL CHAN UBIN;
     1315    24331    1   DCL CHANLO UBIN;
     1316    24332    1   DCL CHANHI UBIN;
     1317    24333    1   DCL SUB UBIN;
     1318    24334    1   DCL SUBLO UBIN;
     1319    24335    1   DCL SUBHI UBIN;
     1320    24336    1   DCL SUBSUB UBIN;
     1321    24337    1   DCL SUBSUBLO UBIN;
     1322    24338    1   DCL SUBSUBHI UBIN;
     1323    24339    1   DCL LEV UBIN;
     1324    24340    1   DCL MAXLEV UBIN;
     1325    24341        %B$TERMINAL_ID (FPTN=KL$TERMINAL_ID,STCLASS=AUTO,ALGN=WALIGNED);
     1326    24370        %B$TERMINAL_ID (FPTN=TERMID_C,STCLASS=CONSTANT);
     1327    24399        %KL_MES (FPTN=GJA_STOK,STCLASS=CONSTANT,CODE=IGA_STOK);
     1328    24422        %KL_NA_INFO (FPTN=NA,STCLASS=AUTO);
     1329    24471        %KL_HNDCMN_INFO (FPTN=HNDCMN,STCLASS=AUTO,LVL=1,LAST=";");
     1330    24551        %B$TERMINAL_ID (FPTN=TERMLO,STCLASS=AUTO,ALGN=WALIGNED);
     1331    24580        %B$TERMINAL_ID (FPTN=TERMHI,STCLASS=AUTO,ALGN=WALIGNED);
     1332    24609        %KL_SGNRSP (FPTN=SGNRSP,STCLASS=AUTO,RSPSIZ=50);
     1333    24745        %KL_ADMIN (FPTN=ADMIN,STCLASS=AUTO,LAST=",");
     1334    24906        %KH$CHN(STCLASS=AUTO,LVL=2);
     1335    25030        %KL_NODECHG(FPTN=NODECHG,STCLASS=AUTO);
     1336    25054        %KL_UPDOSI(FPTN=UPDOSI,STCLASS=AUTO);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:270  
     1337    25263        %KL_OSILINKCHG(FPTN=OSILINKCHG,STCLASS=AUTO);
     1338    25386                                                /* Entrys                   */
     1339    25387    1   DCL GJA$Q_MSG ENTRY(6);
     1340    25388    1   DCL GJA$WRITE ENTRY(6);
     1341    25389    1   DCL GIJ$INITDUMP ENTRY;
     1342    25390    1   DCL KVB$GETSYS ENTRY(2) ALTRET;
     1343    25391    1   DCL KVB$RLSSYS ENTRY(2) ALTRET;
     1344    25392    1   DCL KVB$RLS2NSYS ENTRY(2) ALTRET;
     1345    25393    1   DCL GJA$DISOLVE_LGNUSR_CTX ENTRY(1);
     1346    25394    1   DCL GJA$DISOLVE_ERRMSG_CTX ENTRY(1);
     1347    25395    1   DCL KVB$GET2NSYS ENTRY(2) ALTRET;
     1348    25396    1   DCL GJA$BLD_CTX ENTRY(3) ALTRET;
     1349    25397    1   DCL GJA$CHK_TRM_RNG ENTRY(2) ALTRET;
     1350    25398    1   DCL GJA$LOGON_RESPONCE ENTRY(1) ALTRET;
     1351    25399    1   DCL GJA$LOGON_REQUEST ENTRY(3);
     1352    25400    1   DCL GJA$LOGON_REQUEST_AGAIN ENTRY(1) ALTRET;
     1353    25401    1   DCL GJA$GET_CONFIG_INFO ENTRY (1);
     1354    25402    1   DCL GJA$UPDATE_CHNTBL ENTRY(3) ALTRET;
     1355    25403    1   DCL GJA$GET_CHNTBL_PTR ENTRY(2) ALTRET;
     1356    25404    1   DCL GJA$SEND_MSG ENTRY(4) ALTRET;
     1357    25405    1   DCL GJA$NETWORK_MANAGER ENTRY(2) ALTRET;
     1358    25406    1   DCL GJA$LINEPROFILE ENTRY(2) ALTRET;
     1359    25407    1   DCL GIJ$DUMPMSG ENTRY(1);
     1360    25408    1   DCL KHI$IO_OTP ENTRY(2) ALTRET;
     1361    25409    1   DCL GJA$HOST_RESUMED ENTRY ALTRET;
     1362    25410    1   DCL KHC$UTS ENTRY(1) ALTRET;
     1363    25411    1   DCL GJA$NA_INFO ENTRY(1) ALTRET;
     1364    25412                                                /* Macro                    */
     1365    25413        /*
     1366    25414          This macro is used later in GJA$ADMIN to extract some sort of
     1367    25415          header out of a message and place it in a dynamic buffer in the
     1368    25416          node admin buffer pool.
     1369    25417        */
     1370    25418        %MACRO EXTRACT_MESSAGE(DESTPTR=GJA_DESTPTR);
     1371    25419           IF (GJA$HAND_CTX.NODE ~= GJA_DEFNODE) THEN RETURN;
     1372    25420           IF DESTPTR ~= ADDR(NIL)              /* Release old buffer       */
     1373    25421           THEN CALL KVB$RLSSYS((DESTPTR->TEXTC_STRING.SIZE+2)/2,DESTPTR);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:271  
     1374    25422           SIZE=(GJA$PARAMS.DATSIZE-SIZEC(KL$MES)+2)/2;
     1375    25423           CALL KVB$GETSYS(SIZE,DESTPTR);
     1376    25424           SIZE=GJA$PARAMS.DATSIZE-SIZEC(KL$MES);
     1377    25425           DESTPTR->TEXTC_STRING.SIZE=SIZE;
     1378    25426           DESTPTR->TEXTC_STRING.STRING=PINCRW(GJA$PARAMS.DAT$,SIZEW(KL$MES))->BUFFER;
     1379    25427        %MEND;
     1380    25428        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:272  
     1381    25429    1      CTX$ = MSGCTX$;

  25429   2 000005  ECC7 0006                            LDB,B6   @MSGCTX$,AUTO
          2 000007  DC86                                 LDB,B5   ,B6
          2 000008  DFC7 0019                            STB,B5   CTX$,AUTO

     1382    25430    1      UID$ = MSGCTX$;

  25430   2 00000A  CC86                                 LDB,B4   ,B6
          2 00000B  CFC7 001B                            STB,B4   UID,AUTO

     1383    25431    1      WHO = GJA$HAND_CTX.WHO;

  25431   2 00000D  E805                                 LDR,R6   ,B5
          2 00000E  604D                                 SOR,R6   13
          2 00000F  EF47 0026                            STR,R6   WHO,AUTO

     1384    25432        /*
     1385    25433          try and prevent the handler from ever getting blocked by tracking the
     1386    25434          number of messages received.  When enough messages have been received
     1387    25435          go ahead an reissue the request dat.  The idea is to keep the handler
     1388    25436          flush with credits
     1389    25437        */
     1390    25438    1      IF WHO = %GJA_UID_HANDLER THEN

  25438   2 000011  6D03                                 CMV,R6   3
          2 000012  0981 003B                            BNE      s:25448,PREL

     1391    25439    2      DO;

     1392    25440    2           GJA$HAND_CTX.RDSOUT = GJA$HAND_CTX.RDSOUT - 1;

  25440   2 000014  88C5 0006                            DEC      6,B5

     1393    25441    2          IF (GJA_MAXRDS - (GJA_MAXRDS/4) >= GJA$HAND_CTX.RDSOUT) AND NOT GJA$HAND_CTX
             25441                    .BLK THEN

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:273  
  25441   2 000016  D800 0000 0000  xsym                 LDR,R5   GJA_MAXRDS
          2 000019  5042                                 SOR,R5   2
          2 00001A  D200 0000 0000  xsym                 SUB,R5   GJA_MAXRDS
          2 00001D  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 00001F  8255                                 NEG      R5
          2 000020  5801 002D                            BLZ,R5   s:25448,PREL
          2 000022  D945 0006                            CMR,R5   6,B5
          2 000024  0201 0029                            BL       s:25448,PREL
          2 000026  82C5 000D                            LB,'1000'X        13,B5
          2 000028       1000
          2 000029  0501 0024                            BBT      s:25448,PREL

     1394    25442    3           DO;

     1395    25443    3                KV@VDO_RQSDAT = KV_VDO_RQSDAT;

  25443   2 00002B  AB80 0000 0000  01                   LAB,B2   E$NONETMAN
          2 00002E  2C04                                 LDV,R2   4
          2 00002F  6C0A                                 LDV,R6   10
          2 000030  BB87                                 LAB,B3   ,AUTO
          2 000031  3C10                                 LDV,R3   16
          2 000032  0008                                 MMM

     1396    25444    3                CALL GJA$Q_MSG(CTX$,SIZEC(KV_VDO_RQSDAT),KV@VDO_RQSDAT);

  25444   2 000033  DBF0 000A                            LAB,B5   10,IMO
          2 000035  CBC7 0008                            LAB,B4   KV@VDO_RQSDAT,AUTO
          2 000037  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 000039  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00003B  ABC7 0019                            LAB,B2   CTX$,AUTO
          2 00003D  AFC7 0114                            STB,B2   SUBSUB$+2,AUTO
          2 00003F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000041  CBF0 0300                            LAB,B4   768,IMO
          2 000043  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 000046       0001                            DC       s:25445,PREL

     1397    25445    3                GJA$HAND_CTX.RDSOUT = GJA_MAXRDS;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:274  

  25445   2 000047  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 000049  E800 0000 0000  xsym                 LDR,R6   GJA_MAXRDS
          2 00004C  EF46 0006                            STR,R6   6,B6

     1398    25446    3                END;

     1399    25447    2           END;

     1400    25448    1      IF GJA$PARAMS.DAT$ = ADDR(NIL) THEN

  25448   2 00004E  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000050  8DC6 0006                            CMN      6,B6
          2 000052  0981 0004                            BNE      s:25454,PREL

     1401    25449    2      DO;

     1402    25450        /*    CALL GJA$NETWORK_MANAGER(ERRLOGBUF);  */
     1403    25451    2           RETURN;

  25451   2 000054  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1404    25452    2           END;
     1405    25453
     1406    25454    2      DO CASE(KL$MES.CODE);                /* KL$MES.CODE CASE         */

  25454   2 000057  DCC6 0006                            LDB,B5   6,B6
          2 000059  B285                                 LLH,R3   ,B5
          2 00005A  3D5C                                 CMV,R3   92
          2 00005B  0281 1EF5                            BGE      s:27128,PREL
          2 00005D  A830 0000 0063  02                   LDR,R2   s:25454+12,R3
          2 000060  83A0 0000 00BF  02                   JMP      s:25457,R2
          2 000063       1E92                            DC       s:27128,PREL
          2 000064       075F                            DC       s:25909,PREL
          2 000065       0E11                            DC       s:26143,PREL
          2 000066       1E92                            DC       s:27128,PREL
          2 000067       09D8                            DC       s:25986,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:275  
          2 000068       08A6                            DC       s:25950,PREL
          2 000069       1E92                            DC       s:27128,PREL
          2 00006A       0972                            DC       s:25974,PREL
          2 00006B       1371                            DC       s:26453,PREL
          2 00006C       0B26                            DC       s:26027,PREL
          2 00006D       0A3E                            DC       s:25998,PREL
          2 00006E       0AC0                            DC       s:26016,PREL
          2 00006F       1E92                            DC       s:27128,PREL
          2 000070       1E92                            DC       s:27128,PREL
          2 000071       1A7D                            DC       s:26910,PREL
          2 000072       07C7                            DC       s:25923,PREL
          2 000073       1A8D                            DC       s:26913,PREL
          2 000074       1D92                            DC       s:27077,PREL
          2 000075       0026                            DC       s:25477,PREL
          2 000076       0000                            DC       s:25457,PREL
          2 000077       082F                            DC       s:25937,PREL
          2 000078       0D55                            DC       s:26109,PREL
          2 000079       1E92                            DC       s:27128,PREL
          2 00007A       1E92                            DC       s:27128,PREL
          2 00007B       090C                            DC       s:25962,PREL
          2 00007C       0AA4                            DC       s:26009,PREL
          2 00007D       1E92                            DC       s:27128,PREL
          2 00007E       0D8E                            DC       s:26119,PREL
          2 00007F       1E92                            DC       s:27128,PREL
          2 000080       1E92                            DC       s:27128,PREL
          2 000081       1E92                            DC       s:27128,PREL
          2 000082       1E92                            DC       s:27128,PREL
          2 000083       1ACA                            DC       s:26921,PREL
          2 000084       0040                            DC       s:25500,PREL
          2 000085       0040                            DC       s:25500,PREL
          2 000086       0187                            DC       s:25567,PREL
          2 000087       0123                            DC       s:25549,PREL
          2 000088       0039                            DC       s:25487,PREL
          2 000089       1056                            DC       s:26271,PREL
          2 00008A       1A7D                            DC       s:26910,PREL
          2 00008B       1D4C                            DC       s:27060,PREL
          2 00008C       1D7D                            DC       s:27074,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:276  
          2 00008D       1DA7                            DC       s:27081,PREL
          2 00008E       1826                            DC       s:26756,PREL
          2 00008F       13F5                            DC       s:26491,PREL
          2 000090       0FA5                            DC       s:26233,PREL
          2 000091       100D                            DC       s:26256,PREL
          2 000092       1E92                            DC       s:27128,PREL
          2 000093       1E92                            DC       s:27128,PREL
          2 000094       1E92                            DC       s:27128,PREL
          2 000095       1E92                            DC       s:27128,PREL
          2 000096       1E92                            DC       s:27128,PREL
          2 000097       1DB3                            DC       s:27084,PREL
          2 000098       1E92                            DC       s:27128,PREL
          2 000099       1E92                            DC       s:27128,PREL
          2 00009A       1E92                            DC       s:27128,PREL
          2 00009B       1E92                            DC       s:27128,PREL
          2 00009C       1E92                            DC       s:27128,PREL
          2 00009D       1E92                            DC       s:27128,PREL
          2 00009E       1E92                            DC       s:27128,PREL
          2 00009F       1E92                            DC       s:27128,PREL
          2 0000A0       11AB                            DC       s:26340,PREL
          2 0000A1       11C4                            DC       s:26344,PREL
          2 0000A2       1E92                            DC       s:27128,PREL
          2 0000A3       0F31                            DC       s:26198,PREL
          2 0000A4       1E92                            DC       s:27128,PREL
          2 0000A5       1677                            DC       s:26682,PREL
          2 0000A6       197C                            DC       s:26847,PREL
          2 0000A7       1E92                            DC       s:27128,PREL
          2 0000A8       1E92                            DC       s:27128,PREL
          2 0000A9       1E92                            DC       s:27128,PREL
          2 0000AA       1E92                            DC       s:27128,PREL
          2 0000AB       17B0                            DC       s:26734,PREL
          2 0000AC       1E92                            DC       s:27128,PREL
          2 0000AD       1E92                            DC       s:27128,PREL
          2 0000AE       0DE0                            DC       s:26133,PREL
          2 0000AF       1E92                            DC       s:27128,PREL
          2 0000B0       0B78                            DC       s:26046,PREL
          2 0000B1       03DB                            DC       s:25740,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:277  
          2 0000B2       049B                            DC       s:25773,PREL
          2 0000B3       0013                            DC       s:25467,PREL
          2 0000B4       0D10                            DC       s:26091,PREL
          2 0000B5       0BDE                            DC       s:26058,PREL
          2 0000B6       1E92                            DC       s:27128,PREL
          2 0000B7       0C44                            DC       s:26069,PREL
          2 0000B8       0CAA                            DC       s:26080,PREL
          2 0000B9       1DC8                            DC       s:27090,PREL
          2 0000BA       1DC8                            DC       s:27090,PREL
          2 0000BB       1E68                            DC       s:27119,PREL
          2 0000BC       1E68                            DC       s:27119,PREL
          2 0000BD       1DDD                            DC       s:27098,PREL
          2 0000BE       1DDD                            DC       s:27098,PREL

     1407    25455
     1408    25456    2       CASE (IGA_CRASHFEP);

     1409    25457    2         IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM THEN

  25457   2 0000BF  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0000C1  E804                                 LDR,R6   ,B4
          2 0000C2  604D                                 SOR,R6   13
          2 0000C3  6D01                                 CMV,R6   1
          2 0000C4  0901 0004                            BE       s:25459,PREL

     1410    25458    2              RETURN;

  25458   2 0000C6  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1411    25459    2         CALL M$SCREECH(HOSTKEYIN);

  25459   2 0000C9  BB80 0000 0034  00                   LAB,B3   HOSTKEYIN
          2 0000CC  B870 0485                            LDR,R3   1157,IMO
          2 0000CE  0001                                 MCL
          2 0000CF       0000                            DC       s:25459+6,PREL
          2 0000D0  0F81 1E80                            B        s:27128,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:278  
     1412    25460                  /*S* SCREECH_CODE: GJA-S$HOST_KEYIN
     1413    25461                       TYPE:SCREECH
     1414    25462                       MESSAGE: Host KEYIN request.
     1415    25463                       REMARKS: Somebody asked us to DIE
     1416    25464         */
     1417    25465        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:279  
     1418    25466    2       CASE (IGA_CRASHFEP_BF);

     1419    25467    2         IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM THEN

  25467   2 0000D2  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0000D4  E804                                 LDR,R6   ,B4
          2 0000D5  604D                                 SOR,R6   13
          2 0000D6  6D01                                 CMV,R6   1
          2 0000D7  0901 0004                            BE       s:25469,PREL

     1420    25468    2              RETURN;

  25468   2 0000D9  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1421    25469    2         CALL M$SCREECH(BADFNC);

  25469   2 0000DC  BB80 0000 003D  00                   LAB,B3   BADFNC
          2 0000DF  B870 0485                            LDR,R3   1157,IMO
          2 0000E1  0001                                 MCL
          2 0000E2       0000                            DC       s:25469+6,PREL
          2 0000E3  0F81 1E6D                            B        s:27128,PREL

     1422    25470        /*S*    SCREECH_CODE: GJA-S$BADFNC
     1423    25471                TYPE: SCREECH
     1424    25472                MESSAGE: Bad message in host icq.
     1425    25473                REMARKS: An illegal message was found in the hosts ICQ.
     1426    25474        */
     1427    25475        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:280  
     1428    25476    2       CASE (IGA_BOOTFEP);

     1429    25477    2         IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM THEN

  25477   2 0000E5  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0000E7  E804                                 LDR,R6   ,B4
          2 0000E8  604D                                 SOR,R6   13
          2 0000E9  6D01                                 CMV,R6   1
          2 0000EA  0901 0004                            BE       s:25479,PREL

     1430    25478    2              RETURN;

  25478   2 0000EC  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1431    25479    2         CALL M$SCREECH(HOSTBOOT);

  25479   2 0000EF  BB80 0000 0037  00                   LAB,B3   HOSTBOOT
          2 0000F2  B870 0485                            LDR,R3   1157,IMO
          2 0000F4  0001                                 MCL
          2 0000F5       0000                            DC       s:25479+6,PREL
          2 0000F6  0F81 1E5A                            B        s:27128,PREL

     1432    25480                  /*S* SCREECH_CODE: GJA-S$HOST_BOOT
     1433    25481                       TYPE:SCREECH
     1434    25482                       MESSAGE: Host BOOT KEYIN request.
     1435    25483                       REMARKS: Somebody asked us to DIE
     1436    25484         */
     1437    25485        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:281  
     1438    25486    2       CASE (IGA_SETNODE);       /* Set node and time from network     */

     1439    25487    2         GJA_NODE# = KL$SETNODE.NODE#;

  25487   2 0000F8  E845 0003                            LDR,R6   3,B5
          2 0000FA  EF00 0000 0000  xsym                 STR,R6   GJA_NODE#
          2 0000FD  0F81 1E53                            B        s:27128,PREL

     1440    25488        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:282  
     1441    25489
     1442    25490    2       CASE(IGA_CONTROL,IGA_CONTROL_INIT);

     1443    25491        /*
     1444    25492          These messages are passed back and fourth between the network
     1445    25493          manager and the handler (or BABOON) via Node Admin.  The basic
     1446    25494          principal is to see who sent the message and if the sender was
     1447    25495          the handler or BABOON, send the message to the network manager;
     1448    25496          otherwise if the sender was the Network manager, send the message
     1449    25497          to the appropriate handler (or BABOON).  Note that the same template
     1450    25498          is used for both messages.  They have the same starting format.
     1451    25499        */
     1452    25500    2         IF WHO = %GJA_UID_NM

  25500   2 0000FF  E847 0026                            LDR,R6   WHO,AUTO
          2 000101  6D01                                 CMV,R6   1
          2 000102  0981 009B                            BNE      s:25535,PREL

     1453    25501    3         THEN DO;                          /* Message from NETMAN      */

     1454    25502    3              IF KL$CONTROL.HANDLER='BABOON'

  25502   2 000104  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 000107  0022                                 ACM      ;
          2 000108       4805 0002                                ALPHANUM(2,B5,,8,FILL),;
          2 00010A       4604 0010                                ALPHANUM(16,B4,,6,FILL)
          2 00010C  5301 0016                            CBNE     s:25507,PREL

     1455    25503    4              THEN DO;                     /* Send this off to BABOON  */

     1456    25504    4                   CALL GJA$Q_MSG(GJA_UID_BABOON,

  25504   2 00010E  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 000110  CBC6 0008                            LAB,B4   8,B6
          2 000112  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 000114  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 000117  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:283  
          2 000119  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00011B  CBF0 0300                            LAB,B4   768,IMO
          2 00011D  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 000120       0001                            DC       s:25506,PREL

     1457    25505    4                     GJA$PARAMS.DATSIZE,KL$CONTROL);
     1458    25506    4                   END;                    /* Send this off to BABOON  */

  25506   2 000121  0F81 1E2F                            B        s:27128,PREL

     1459    25507    4              ELSE IF KL$CONTROL.HANDLER='NODEADMN' THEN DO;

  25507   2 000123  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 000126  0022                                 ACM      ;
          2 000127       4805 0002                                ALPHANUM(2,B5,,8,FILL),;
          2 000129       4804 0013                                ALPHANUM(19,B4,,8,FILL)
          2 00012B  5301 001F                            CBNE     s:25512,PREL

     1460    25508    4                        CALL GJA$NA_INFO (KL$CONTROL);

  25508   2 00012D  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 00012F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000131  CBF0 0100                            LAB,B4   256,IMO
          2 000133  E380 0000 0000  xent                 LNJ,B6   GJA$NA_INFO
          2 000136       0001                            DC       s:25509,PREL

     1461    25509    4                        CALL GJA$NETWORK_MANAGER (KL$CONTROL,GJA$PARAMS.DATSIZE);

  25509   2 000137  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000139  DCC6 0006                            LDB,B5   6,B6
          2 00013B  CBC6 0008                            LAB,B4   8,B6
          2 00013D  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 00013F  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 000141  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000143  CBF0 0200                            LAB,B4   512,IMO
          2 000145  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 000148       0001                            DC       s:25510,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:284  

     1462    25510    4                        END;

  25510   2 000149  0F81 1E07                            B        s:27128,PREL

     1463    25511    4                   ELSE DO;

     1464    25512    4                        CTX$=GJA_HAND_HEAD$;

  25512   2 00014B  CC80 0000 0000  xsym                 LDB,B4   GJA_HAND_HEAD$
          2 00014E  CFC7 0019                            STB,B4   CTX$,AUTO

     1465    25513    5   HANDLER_SEARCH:      DO WHILE (CTX$ ~= ADDR(NIL));

  25513   2 000150  0F81 002B            HANDLER_SEARCH  B        s:25523,PREL

     1466    25514    5                             IF KL$CONTROL.HANDLER = GJA$HAND_CTX.NAME

  25514   2 000152  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000154  DCC6 0006                            LDB,B5   6,B6
          2 000156  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000158  0022                                 ACM      ;
          2 000159       4805 0002                                ALPHANUM(2,B5,,8,FILL),;
          2 00015B       4804 0009                                ALPHANUM(9,B4,,8,FILL)
          2 00015D  5301 001A                            CBNE     s:25522,PREL

     1467    25515    6                             THEN DO;      /* Handler found            */

     1468    25516    6                                 CALL GJA$SEND_MSG(CTX$,KL$CONTROL,GJA$PARAMS.DATSIZE)

  25516   2 00015F  BBC6 0008                            LAB,B3   8,B6
          2 000161  BFC7 0118                            STB,B3   SUBSUB$+6,AUTO
          2 000163  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000165  ABC7 0019                            LAB,B2   CTX$,AUTO
          2 000167  AFC7 0114                            STB,B2   SUBSUB$+2,AUTO
          2 000169  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00016B  CBF0 0300                            LAB,B4   768,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:285  
          2 00016D  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000170       0003                            DC       s:25518,PREL
          2 000171  0F81 0004                            B        s:25520,PREL

     1469    25517    7                                  WHENALTRETURN DO;

     1470    25518    7                                       ALTRETURN;

  25518   2 000173  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

     1471    25519    7                                       END;
     1472    25520    6                                  EXIT HANDLER_SEARCH;

  25520   2 000176  0F81 0008                            B        s:25524,PREL

     1473    25521    6                                  END;     /* Handler found            */
     1474    25522    5                             CTX$=GJA$HAND_CTX.LNK$;

  25522   2 000178  BCC4 0001                            LDB,B3   1,B4
          2 00017A  BFC7 0019                            STB,B3   CTX$,AUTO

     1475    25523    5                             END;

  25523   2 00017C  8DC7 0019                            CMN      CTX$,AUTO
          2 00017E  09D4                                 BNE      s:25514,SPREL

     1476    25524    4                        IF CTX$ = ADDR(NIL)

  25524   2 00017F  8DC7 0019                            CMN      CTX$,AUTO
          2 000181  0981 1DCF                            BNE      s:27128,PREL

     1477    25525    5                        THEN DO;

     1478    25526    5                             KL$CONTROL.RESULTS=E$NOHANDLER;

  25526   2 000183  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000185  DCC6 0006                            LDB,B5   6,B6
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:286  
          2 000187  8C80 0000 0032  00                   LDI      E$NOHANDLER
          2 00018A  8D45 000E                            SDI      14,B5

     1479    25527             /*E* ERROR: GJA-%E$NOHANDLER-0
     1480    25528                  MESSAGE: There is no handler with the specified name.
     1481    25529              */
     1482    25530    5                             CALL GJA$NETWORK_MANAGER(KL$CONTROL,SIZEC(KL$CONTROL));

  25530   2 00018C  DCC6 0006                            LDB,B5   6,B6
          2 00018E  CBF0 002C                            LAB,B4   44,IMO
          2 000190  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 000192  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 000194  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000196  CBF0 0200                            LAB,B4   512,IMO
          2 000198  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 00019B       0001                            DC       s:25533,PREL

     1483    25531    5                             END;

     1484    25532    4                        END;               /* Send this to a handler   */

     1485    25533    3              END;                         /* Message from NETMAN      */

  25533   2 00019C  0F81 1DB4                            B        s:27128,PREL

     1486    25534    3         ELSE DO;                /* Message from handler or BABOON     */

     1487    25535    3              KL$CONTROL.HANDLER = GJA$HAND_CTX.NAME;

  25535   2 00019E  ACC7 0019                            LDB,B2   CTX$,AUTO
          2 0001A0  2C12                                 LDV,R2   18
          2 0001A1  6C08                                 LDV,R6   8
          2 0001A2  BB85                                 LAB,B3   ,B5
          2 0001A3  3C04                                 LDV,R3   4
          2 0001A4  0008                                 MMM

     1488    25536    3              IF KL$MES.CODE = IGA_CONTROL_INIT
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:287  

  25536   2 0001A5  CCC6 0006                            LDB,B4   6,B6
          2 0001A7  E284                                 LLH,R6   ,B4
          2 0001A8  6D22                                 CMV,R6   34
          2 0001A9  0981 0011                            BNE      s:25540,PREL

     1489    25537    3              THEN
     1490    25538    3                   CALL GJA$NETWORK_MANAGER(KL$CONTROL,GJA$PARAMS.DATSIZE);

  25538   2 0001AB  ABC6 0008                            LAB,B2   8,B6
          2 0001AD  AFC7 0116                            STB,B2   SUBSUB$+4,AUTO
          2 0001AF  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0001B1  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0001B3  CBF0 0200                            LAB,B4   512,IMO
          2 0001B5  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 0001B8       0001                            DC       s:25538+14,PREL
          2 0001B9  0F81 1D97                            B        s:27128,PREL

     1491    25539    4              ELSE DO;

     1492    25540    4                   I = KL$CONTROL.SRCE_NODE;

  25540   2 0001BB  D2C4 0001                            LLH,R5   1,B4
          2 0001BD  DF47 0015                            STR,R5   I,AUTO

     1493    25541    4                   CALL FIND_NODE(I,CTX$)

  25541   2 0001BF  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 0001C1  CFC7 010C                            STB,B4   ATTR+1,AUTO
          2 0001C3  ABC7 0015                            LAB,B2   I,AUTO
          2 0001C5  AFC7 010A                            STB,B2   OSILINKCHG+18,AUTO
          2 0001C7  E3C0 201E                            LNJ,B6   s:0,PREL
          2 0001C9       0017                            DC       s:25546,PREL

     1494    25542    5                   WHENRETURN DO;

     1495    25543    5                        CALL GJA$SEND_MSG(CTX$,KL$CONTROL,GJA$PARAMS.DATSIZE);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:288  

  25543   2 0001CA  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0001CC  DCC6 0006                            LDB,B5   6,B6
          2 0001CE  CBC6 0008                            LAB,B4   8,B6
          2 0001D0  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 0001D2  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0001D4  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 0001D6  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 0001D8  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0001DA  CBF0 0300                            LAB,B4   768,IMO
          2 0001DC  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 0001DF       0001                            DC       s:25546,PREL

     1496    25544    5                        END;

     1497    25545    4                   END;

     1498    25546    3              END;               /* Message from handler or BABOON     */

  25546   2 0001E0  0F81 1D70                            B        s:27128,PREL

     1499    25547        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:289  
     1500    25548    2       CASE(IGA_REQSTATS);

     1501    25549    3         IF WHO = %GJA_UID_NM THEN DO;

  25549   2 0001E2  E847 0026                            LDR,R6   WHO,AUTO
          2 0001E4  6D01                                 CMV,R6   1
          2 0001E5  0981 0030                            BNE      s:25559,PREL

     1502    25550    3              CTX$ = GJA_HAND_HEAD$;

  25550   2 0001E7  CC80 0000 0000  xsym                 LDB,B4   GJA_HAND_HEAD$
          2 0001EA  CFC7 0019                            STB,B4   CTX$,AUTO

     1503    25551    4              DO WHILE(CTX$ ~= ADDR(NIL));

  25551   2 0001EC  0F81 0024                            B        s:25556,PREL

     1504    25552    4                   IF GJA$HAND_CTX.WHO ~= %GJA_UID_NM

  25552   2 0001EE  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 0001F0  E806                                 LDR,R6   ,B6
          2 0001F1  604D                                 SOR,R6   13
          2 0001F2  6D01                                 CMV,R6   1
          2 0001F3  0901 0017                            BE       s:25555,PREL

     1505    25553    4                   THEN
     1506    25554    4                        CALL GJA$SEND_MSG(CTX$,KL$REQSTATS,SIZEC(KL$REQSTATS));

  25554   2 0001F5  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 0001F7  CCC5 0006                            LDB,B4   6,B5
          2 0001F9  BBF0 0028                            LAB,B3   40,IMO
          2 0001FB  BFC7 0118                            STB,B3   SUBSUB$+6,AUTO
          2 0001FD  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 0001FF  ABC7 0019                            LAB,B2   CTX$,AUTO
          2 000201  AFC7 0114                            STB,B2   SUBSUB$+2,AUTO
          2 000203  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000205  CBF0 0300                            LAB,B4   768,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:290  
          2 000207  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 00020A       0001                            DC       s:25555,PREL

     1507    25555    4                   CTX$ = GJA$HAND_CTX.LNK$;

  25555   2 00020B  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 00020D  DCC6 0001                            LDB,B5   1,B6
          2 00020F  DFC7 0019                            STB,B5   CTX$,AUTO

     1508    25556    4                   END;                    /* DO WHILE                 */

  25556   2 000211  8DC7 0019                            CMN      CTX$,AUTO
          2 000213  09DB                                 BNE      s:25552,SPREL

     1509    25557    3              END;                         /* IF UID = NM              */

  25557   2 000214  0F81 1D3C                            B        s:27128,PREL

     1510    25558    3         ELSE DO;

     1511    25559    3              KL$REQSTATS.HANDLER = GJA$HAND_CTX.NAME;

  25559   2 000216  ACC7 0019                            LDB,B2   CTX$,AUTO
          2 000218  2C12                                 LDV,R2   18
          2 000219  6C08                                 LDV,R6   8
          2 00021A  BB85                                 LAB,B3   ,B5
          2 00021B  3C18                                 LDV,R3   24
          2 00021C  0008                                 MMM

     1512    25560    3              I = KL$REQSTATS.SRCE_NODE;

  25560   2 00021D  CCC6 0006                            LDB,B4   6,B6
          2 00021F  E2C4 0001                            LLH,R6   1,B4
          2 000221  EF47 0015                            STR,R6   I,AUTO

     1513    25561    3              CALL FIND_NODE(I,CTX$)

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:291  
  25561   2 000223  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 000225  CFC7 010C                            STB,B4   ATTR+1,AUTO
          2 000227  ABC7 0015                            LAB,B2   I,AUTO
          2 000229  AFC7 010A                            STB,B2   OSILINKCHG+18,AUTO
          2 00022B  E3C0 1FBA                            LNJ,B6   s:0,PREL
          2 00022D       0017                            DC       s:25565,PREL

     1514    25562    4              WHENRETURN DO;

     1515    25563    4                   CALL GJA$SEND_MSG(CTX$,KL$REQSTATS,GJA$PARAMS.DATSIZE);

  25563   2 00022E  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000230  DCC6 0006                            LDB,B5   6,B6
          2 000232  CBC6 0008                            LAB,B4   8,B6
          2 000234  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 000236  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000238  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 00023A  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00023C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00023E  CBF0 0300                            LAB,B4   768,IMO
          2 000240  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000243       0001                            DC       s:25565,PREL

     1516    25564    4                   END;

     1517    25565    3              END;                         /* ELSE                     */

  25565   2 000244  0F81 1D0C                            B        s:27128,PREL

     1518    25566        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:292  
     1519    25567    2       CASE(IGA_ADMIN);

     1520    25568        /*
     1521    25569          This is an administrative request or responce.  If the message
     1522    25570          is from the network manager, we check the channel involved to see if
     1523    25571          the operation is legal from the node admin standpoint.  If not, we
     1524    25572          send the same message back to the network manager with the
     1525    25573          appropriate error code.  If the request looks O.K., we foward it to
     1526    25574          the handler (or BABOON) as appropriate.  The handler will attempt to
     1527    25575          perform the operation indicated and then send the same message back
     1528    25576          to Node Admin.  If the operation was performed, Node Admin will
     1529    25577          update his channel table (if necessary), and send the message up to
     1530    25578          the network manager, indicating the operation was performed.
     1531    25579        */
     1532    25580    3   ADMIN: DO;

  25580   2                              ADMIN           null
     1533    25581    3              UID$ = ADDR(NIL);

  25581   2 000246  CB80 0000 0000       ADMIN           LAB,B4   0
          2 000249  CFC7 001B                            STB,B4   UID,AUTO

     1534    25582    3              ADMIN = KL$ADMIN;

  25582   2 00024B  DCC6 0006                            LDB,B5   6,B6
          2 00024D  4C44                                 LDV,R4   68
          2 00024E  D870 0084                            LDR,R5   132,IMO
          2 000250  0021                                 ALR      ;
          2 000251       4005 0000                                ALPHANUM(0,B5,,R4),;
          2 000253       4007 0094                                ALPHANUM(ADMIN,AUTO,,R5,FILL)

     1535    25583    3              WHO = GJA$HAND_CTX.WHO;

  25583   2 000255  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 000257  437F                                 CSYNC    s:25583+1,SPREL
          2 000258  E805                                 LDR,R6   ,B5
          2 000259  604D                                 SOR,R6   13
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:293  
          2 00025A  EF47 0026                            STR,R6   WHO,AUTO

     1536    25584    3              IF WHO = %GJA_UID_NM

  25584   2 00025C  6D01                                 CMV,R6   1
          2 00025D  0981 0005                            BNE      s:25587,PREL

     1537    25585    3              THEN
     1538    25586    3                   ADMIN.RESULTS = '0'B;

  25586   2 00025F  8747 00A2                            CL       ADMIN+14,AUTO
          2 000261  8747 00A3                            CL       ADMIN+15,AUTO

     1539    25587    3              TERMLO = KL$ADMIN.TERMID_LO;

  25587   2 000263  BCC6 0006                            LDB,B3   6,B6
          2 000265  AB83                                 LAB,B2   ,B3
          2 000266  2C24                                 LDV,R2   36
          2 000267  6C10                                 LDV,R6   16
          2 000268  BBC7 005B                            LAB,B3   TERMLO,AUTO
          2 00026A  3C00                                 LDV,R3   0
          2 00026B  0008                                 MMM

     1540    25588    3              TERMHI = KL$ADMIN.TERMID_HI;

  25588   2 00026C  DCC6 0006                            LDB,B5   6,B6
          2 00026E  AB85                                 LAB,B2   ,B5
          2 00026F  2C34                                 LDV,R2   52
          2 000270  6C10                                 LDV,R6   16
          2 000271  BBC7 0063                            LAB,B3   TERMHI,AUTO
          2 000273  3C00                                 LDV,R3   0
          2 000274  0008                                 MMM

     1541    25589    4              CALL GJA$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN DO;

  25589   2 000275  CBC7 0063                            LAB,B4   TERMHI,AUTO
          2 000277  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:294  
          2 000279  BBC7 005B                            LAB,B3   TERMLO,AUTO
          2 00027B  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00027D  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00027F  CBF0 0200                            LAB,B4   512,IMO
          2 000281  E380 0000 0000  xent                 LNJ,B6   GJA$CHK_TRM_RNG
          2 000284       0003                            DC       s:25592,PREL
          2 000285  0F81 0001                            B        s:25592,PREL

     1542    25590                      /*N* ??????*/
     1543    25591    4                   END;                    /* WHENALTRETURN            */

     1544    25592    3              CHANLO = TERMLO.TERM.CHANNEL;

  25592   2 000287  E847 005C                            LDR,R6   TERMLO+1,AUTO
          2 000289  EF47 003C                            STR,R6   CHANLO,AUTO

     1545    25593    3              CHANHI = TERMHI.TERM.CHANNEL;

  25593   2 00028B  D847 0064                            LDR,R5   TERMHI+1,AUTO
          2 00028D  DF47 003D                            STR,R5   CHANHI,AUTO

     1546    25594    3              SUBLO = TERMLO.TERM.SUBDEVICE;

  25594   2 00028F  C847 005D                            LDR,R4   TERMLO+2,AUTO
          2 000291  CF47 003F                            STR,R4   SUBLO,AUTO

     1547    25595    3              SUBHI = TERMHI.TERM.SUBDEVICE;

  25595   2 000293  B847 0065                            LDR,R3   TERMHI+2,AUTO
          2 000295  BF47 0040                            STR,R3   SUBHI,AUTO

     1548    25596    3              SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;

  25596   2 000297  A847 005E                            LDR,R2   TERMLO+3,AUTO
          2 000299  AF47 0042                            STR,R2   SUBSUBLO,AUTO

     1549    25597    3              SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:295  

  25597   2 00029B  9847 0066                            LDR,R1   TERMHI+3,AUTO
          2 00029D  9F47 0043                            STR,R1   SUBSUBHI,AUTO

     1550    25598    4              IF WHO = %GJA_UID_NM THEN DO;

  25598   2 00029F  E847 0026                            LDR,R6   WHO,AUTO
          2 0002A1  6D01                                 CMV,R6   1
          2 0002A2  0981 0008                            BNE      s:25603,PREL

     1551    25599    5                   CALL CHN_HANDLER WHENALTRETURN DO;

  25599   2 0002A4  E3C0 1F6C                            LNJ,B6   s:0,PREL
          2 0002A6       0003                            DC       s:25600,PREL
          2 0002A7  0F81 0003                            B        s:25603,PREL

     1552    25600    5                        EXIT ADMIN;

  25600   2 0002A9  0F81 0177                            B        s:25721,PREL

     1553    25601    5                        END;
     1554    25602    4                   END;

     1555    25603    3              KL$TERMINAL_ID = '0'B;

  25603   2 0002AB  5C10                                 LDV,R5   16
          2 0002AC  0021                                 ALR      ;
          2 0002AD       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 0002AF       4007 0046                                ALPHANUM(KL$TERMINAL_ID,AUTO,,R5,FILL)

     1556    25604    3              KL$TERMINAL_ID.LEV = TERMLO.LEV;

  25604   2 0002B1  437F                                 CSYNC    s:25603+5,SPREL
          2 0002B2  E847 005B                            LDR,R6   TERMLO,AUTO
          2 0002B4  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 0002B6       00FF

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:296  
     1557    25605    4              DO CHAN = CHANLO TO CHANHI BY 128;

  25605   2 0002B7  C847 003C                            LDR,R4   CHANLO,AUTO
          2 0002B9  CF47 003B                            STR,R4   CHAN,AUTO
          2 0002BB  0F81 015F                            B        s:25718+6,PREL

     1558    25606    5                   DO SUB = SUBLO TO SUBHI;

  25606   2 0002BD  E847 003F                            LDR,R6   SUBLO,AUTO
          2 0002BF  EF47 003E                            STR,R6   SUB,AUTO
          2 0002C1  0F81 014D                            B        s:25717+2,PREL

     1559    25607    6                        DO SUBSUB = SUBSUBLO TO SUBSUBHI;

  25607   2 0002C3  E847 0042                            LDR,R6   SUBSUBLO,AUTO
          2 0002C5  EF47 0041                            STR,R6   SUBSUB,AUTO
          2 0002C7  0F81 013F                            B        s:25716+2,PREL

     1560    25608    6                             KL$TERMINAL_ID.TERM.CHANNEL = CHAN;

  25608   2 0002C9  E847 003B                            LDR,R6   CHAN,AUTO
          2 0002CB  EF47 0047                            STR,R6   KL$TERMINAL_ID+1,AUTO

     1561    25609    6                             KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;

  25609   2 0002CD  D847 003E                            LDR,R5   SUB,AUTO
          2 0002CF  DF47 0048                            STR,R5   KL$TERMINAL_ID+2,AUTO

     1562    25610    6                             KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;

  25610   2 0002D1  C847 0041                            LDR,R4   SUBSUB,AUTO
          2 0002D3  CF47 0049                            STR,R4   KL$TERMINAL_ID+3,AUTO

     1563    25611    7                            CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN
             25611                                      DO;

  25611   2 0002D5  EBC7 0017                            LAB,B6   CHN$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:297  
          2 0002D7  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 0002D9  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 0002DB  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 0002DD  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0002DF  CBF0 0200                            LAB,B4   512,IMO
          2 0002E1  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 0002E4       0003                            DC       s:25612,PREL
          2 0002E5  0F81 0008                            B        s:25615,PREL

     1564    25612    7                                  ADMIN.RESULTS=E$CHAN_NOT_THERE;

  25612   2 0002E7  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 0002EA  8D47 00A2                            SDI      ADMIN+14,AUTO

     1565    25613    7                                  EXIT ADMIN;

  25613   2 0002EC  0F81 0134                            B        s:25721,PREL

     1566    25614    7                                  END;
     1567    25615    6                             IF UID$ = ADDR(NIL) THEN

  25615   2 0002EE  8DC7 001B                            CMN      UID,AUTO
          2 0002F0  0981 0007                            BNE      s:25617,PREL

     1568    25616    6                                  UID$ = KH$CHN.HAND$;

  25616   2 0002F2  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0002F4  DCC6 001E                            LDB,B5   30,B6
          2 0002F6  DFC7 001B                            STB,B5   UID,AUTO

     1569    25617    6                             IF KH$CHN.HAND$ = ADDR(NIL)

  25617   2 0002F8  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0002FA  8DC6 001E                            CMN      30,B6
          2 0002FC  0981 0018                            BNE      s:25629,PREL
          2 0002FE  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 000300  CCC5 0006                            LDB,B4   6,B5
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:298  
          2 000302  E844 0011                            LDR,R6   17,B4
          2 000304  6D07                                 CMV,R6   7
          2 000305  0901 000F                            BE       s:25629,PREL
          2 000307  6D08                                 CMV,R6   8
          2 000308  0901 000C                            BE       s:25629,PREL
          2 00030A  6D09                                 CMV,R6   9
          2 00030B  0901 0009                            BE       s:25629,PREL
          2 00030D  6D1B                                 CMV,R6   27
          2 00030E  0901 0006                            BE       s:25629,PREL

     1570    25618    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_PARTITION
     1571    25619    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_PARTITION_DIAG
     1572    25620    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_RETURN
     1573    25621    6                               AND KL$ADMIN.FNC ~= %KHA_FNC_CHNTBL
     1574    25622    6                             THEN ADMIN.RESULTS = E$NOT_OWNED;

  25622   2 000310  8C80 0000 002E  00                   LDI      E$NOT_OWNED
          2 000313  8D47 00A2                            SDI      ADMIN+14,AUTO

     1575    25623        /*E* ERROR:  GJA-E$NO_HANDLER
     1576    25624             MESSAGE:  Specified handler is not currently running.
     1577    25625        */
     1578    25626        /*E* ERROR:  GJA-E$NOT_OWNED
     1579    25627             MESSAGE:  Operation illegal on an unowned channel
     1580    25628        */
     1581    25629    6                             IF (KL$ADMIN.FNC~=%KHA_FNC_RETURN) AND

  25629   2 000315  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 000317  CCC5 0006                            LDB,B4   6,B5
          2 000319  E844 0011                            LDR,R6   17,B4
          2 00031B  6D09                                 CMV,R6   9
          2 00031C  0901 0013                            BE       s:25637,PREL
          2 00031E  6D1B                                 CMV,R6   27
          2 00031F  0901 0010                            BE       s:25637,PREL
          2 000321  D2C6 0001                            LLH,R5   1,B6
          2 000323  5D06                                 CMV,R5   6
          2 000324  0981 000B                            BNE      s:25637,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:299  
          2 000326  C847 0026                            LDR,R4   WHO,AUTO
          2 000328  4D01                                 CMV,R4   1
          2 000329  0981 0006                            BNE      s:25637,PREL

     1582    25630    6                               (KL$ADMIN.FNC~=%KHA_FNC_CHNTBL) AND
     1583    25631    6                               (KH$CHN.STT=%KH#CHN_STT_PRT) AND
     1584    25632    6                               (WHO=%GJA_UID_NM)
     1585    25633    6                             THEN ADMIN.RESULTS=E$CHAN_PART;

  25633   2 00032B  8C80 0000 0028  00                   LDI      E$CHAN_PART
          2 00032E  8D47 00A2                            SDI      ADMIN+14,AUTO

     1586    25634        /*E* ERROR:  GJA-E$CHAN_PART
     1587    25635             MESSAGE:  Operation illegal on a partitioned channel.
     1588    25636        */
     1589    25637    6                             IF KH$CHN.STT = %KH#CHN_STT_DIAG

  25637   2 000330  E2C6 0001                            LLH,R6   1,B6
          2 000332  6D0B                                 CMV,R6   11
          2 000333  0981 0006                            BNE      s:25645,PREL

     1590    25638    6                             THEN
     1591    25639    6                                  ADMIN.RESULTS = E$CHAN_DIAG;

  25639   2 000335  8C80 0000 002A  00                   LDI      E$CHAN_DIAG
          2 000338  8D47 00A2                            SDI      ADMIN+14,AUTO

     1592    25640                            /*E* ERROR: GJA-%E$CHAN_DIAG
     1593    25641                                 MESSAGE: That channels is being used for diagnostics.
     1594    25642                             */
     1595    25643
     1596    25644
     1597    25645    6                             IF WHO=%GJA_UID_HANDLER AND KL$ADMIN.FNC=%
             25645                                      KHA_FNC_PARTITION THEN

  25645   2 00033A  E847 0026                            LDR,R6   WHO,AUTO
          2 00033C  6D03                                 CMV,R6   3
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:300  
          2 00033D  0981 0010                            BNE      s:25647,PREL
          2 00033F  CCC5 0006                            LDB,B4   6,B5
          2 000341  D844 0011                            LDR,R5   17,B4
          2 000343  5D07                                 CMV,R5   7
          2 000344  0981 0009                            BNE      s:25647,PREL

     1598    25646    6                                  ADMIN.HANDLER = GJA$HAND_CTX.NAME;

  25646   2 000346  ACC7 0019                            LDB,B2   CTX$,AUTO
          2 000348  2C12                                 LDV,R2   18
          2 000349  6C08                                 LDV,R6   8
          2 00034A  BBC7 0096                            LAB,B3   ADMIN+2,AUTO
          2 00034C  3C00                                 LDV,R3   0
          2 00034D  0008                                 MMM

     1599    25647    6                             IF ADMIN.RESULTS

  25647   2 00034E  EB80 0000 0000  03                   LAB,B6   0
          2 000351  5C01                                 LDV,R5   1
          2 000352  0022                                 ACM      ;
          2 000353       4407 00A2                                ALPHANUM(ADMIN+14,AUTO,,4,FILL),;
          2 000355       4006 0000                                ALPHANUM(0,B6,,R5,FILL)
          2 000357  5301 00C9                            CBNE     s:25721,PREL

     1600    25648    6                             THEN EXIT ADMIN;
     1601    25649
     1602    25650    6                             IF WHO = %GJA_UID_NM

  25650   2 000359  E847 0026                            LDR,R6   WHO,AUTO
          2 00035B  6D01                                 CMV,R6   1
          2 00035C  0981 00A8                            BNE      s:25716,PREL

     1603    25651    6                             THEN
     1604    25652    7   CASEFNC:                  DO CASE(KL$ADMIN.FNC);

  25652   2 00035E  ECC5 0006            CASEFNC         LDB,B6   6,B5
          2 000360  B846 0011                            LDR,R3   17,B6
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:301  
          2 000362  3EF9                                 ADV,R3   -7
          2 000363  3D15                                 CMV,R3   21
          2 000364  0281 00A0                            BGE      s:25716,PREL
          2 000366  A830 0000 036C  02                   LDR,R2   CASEFNC+14,R3
          2 000369  83A0 0000 0381  02                   JMP      s:25655,R2
          2 00036C       000F                            DC       s:25664,PREL
          2 00036D       0084                            DC       s:25716,PREL
          2 00036E       0041                            DC       s:25684,PREL
          2 00036F       0084                            DC       s:25716,PREL
          2 000370       0084                            DC       s:25716,PREL
          2 000371       0084                            DC       s:25716,PREL
          2 000372       0084                            DC       s:25716,PREL
          2 000373       0084                            DC       s:25716,PREL
          2 000374       0084                            DC       s:25716,PREL
          2 000375       0084                            DC       s:25716,PREL
          2 000376       0084                            DC       s:25716,PREL
          2 000377       0084                            DC       s:25716,PREL
          2 000378       0084                            DC       s:25716,PREL
          2 000379       0084                            DC       s:25716,PREL
          2 00037A       0084                            DC       s:25716,PREL
          2 00037B       0084                            DC       s:25716,PREL
          2 00037C       0084                            DC       s:25716,PREL
          2 00037D       0084                            DC       s:25716,PREL
          2 00037E       0084                            DC       s:25716,PREL
          2 00037F       0084                            DC       s:25716,PREL
          2 000380       0000                            DC       s:25655,PREL

     1605    25653
     1606    25654    7                              CASE(%KHA_FNC_CHNTBL);

     1607    25655    7                                UID$ = ADDR(NIL);

  25655   2 000381  CB80 0000 0000                       LAB,B4   0
          2 000384  CFC7 001B                            STB,B4   UID,AUTO

     1608    25656    7                                ADMIN.KH$CHN = KH$CHN;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:302  
  25656   2 000386  ACC7 0017                            LDB,B2   CHN$,AUTO
          2 000388  2C00                                 LDV,R2   0
          2 000389  6C40                                 LDV,R6   64
          2 00038A  BBC7 00B6                            LAB,B3   ADMIN+34,AUTO
          2 00038C  3C00                                 LDV,R3   0
          2 00038D  0008                                 MMM

     1609    25657        /*                           IF KH$CHN.VDI$ ~= ADDR(NIL) THEN
     1610    25658                                        KH$CHN.SPEED = KH$CHN.VDI$->KV$VDI.LINSPD; */
     1611    25659    7                                EXIT ADMIN;

  25659   2 00038E  0F81 0092                            B        s:25721,PREL

     1612    25660
     1613    25661
     1614    25662
     1615    25663    7                              CASE (%KHA_FNC_PARTITION);

     1616    25664    7                                IF KH$CHN.HAND$ = ADDR(NIL)

  25664   2 000390  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 000392  8DC4 001E                            CMN      30,B4
          2 000394  0981 0006                            BNE      s:25669,PREL

     1617    25665    7                                THEN
     1618    25666    7                                     KH$CHN.STT = %KH#CHN_STT_PRT;

  25666   2 000396  4C06                                 LDV,R4   6
          2 000397  C7C4 0001                            STH,R4   1,B4
          2 000399  0F81 006B                            B        s:25716,PREL

     1619    25667    7                                ELSE
     1620    25668    8                                DO;

     1621    25669    8                                     TCHN$ = GJA_USRLGN_HEAD$;

  25669   2 00039B  BC80 0000 0000  xsym                 LDB,B3   GJA_USRLGN_HEAD$
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:303  
          2 00039E  BFC7 001F                            STB,B3   TCHN$,AUTO

     1622    25670    9                                     DO WHILE TCHN$ ~= ADDR(NIL);

  25670   2 0003A0  0F81 001C                            B        s:25680,PREL

     1623    25671    9                                          IF KL$TERMINAL_ID = TCHN$->GJA$LGNCTX.
             25671                                                   TERMINAL_ID

  25671   2 0003A2  ECC7 001F                            LDB,B6   TCHN$,AUTO
          2 0003A4  5C10                                 LDV,R5   16
          2 0003A5  0022                                 ACM      ;
          2 0003A6       5007 0046                                ALPHANUM(KL$TERMINAL_ID,AUTO,,16,FILL),;
          2 0003A8       4006 000F                                ALPHANUM(15,B6,,R5,FILL)
          2 0003AA  5301 000E                            CBNE     s:25679,PREL
          2 0003AC  DCC7 0017                            LDB,B5   CHN$,AUTO
          2 0003AE  8285                                 LB,'0004'X        ,B5
          2 0003AF       0004
          2 0003B0  0581 0008                            BBF      s:25679,PREL

     1624    25672    9                                            AND KH$CHN.AUTLGN THEN
     1625    25673   10                                          DO;

     1626    25674   10                                               ADMIN.RESULTS = E$CANTPART;

  25674   2 0003B2  8C80 0000 0018  00                   LDI      E$CANTPART
          2 0003B5  8D47 00A2                            SDI      ADMIN+14,AUTO

     1627    25675                                     /*E* ERROR: GJA-%E$CANTPART
     1628    25676                MESSAGE: The channel you attempted to partition is currently logging on. */
     1629    25677   10                                               EXIT ADMIN;

  25677   2 0003B7  0F81 0069                            B        s:25721,PREL

     1630    25678   10                                               END;
     1631    25679    9                                          TCHN$ = TCHN$->GJA$LGNCTX.LNK$;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:304  
  25679   2 0003B9  DCC6 0001                            LDB,B5   1,B6
          2 0003BB  DFC7 001F                            STB,B5   TCHN$,AUTO

     1632    25680    9                                          END;

  25680   2 0003BD  8DC7 001F                            CMN      TCHN$,AUTO
          2 0003BF  09E3                                 BNE      s:25671,SPREL

     1633    25681    8                                     END;

  25681   2 0003C0  0F81 0044                            B        s:25716,PREL

     1634    25682
     1635    25683    7                              CASE(%KHA_FNC_RETURN);

     1636    25684    7                                IF KH$CHN.STT ~= %KH#CHN_STT_PRT

  25684   2 0003C2  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 0003C4  C2C4 0001                            LLH,R4   1,B4
          2 0003C6  4D06                                 CMV,R4   6
          2 0003C7  0901 0008                            BE       s:25695,PREL

     1637    25685    8                                THEN DO;

     1638    25686    8                                     ADMIN.RESULTS=E$CHAN_NOT_PART;

  25686   2 0003C9  8C80 0000 001A  00                   LDI      E$CHAN_NOT_PART
          2 0003CC  8D47 00A2                            SDI      ADMIN+14,AUTO

     1639    25687    8                                     EXIT ADMIN;

  25687   2 0003CE  0F81 0052                            B        s:25721,PREL

     1640    25688    8                                     END;
     1641    25689        /*E* ERROR:   GJA-%E$CHAN_NOT_PART
     1642    25690             MESSAGE: This channel was never partitioned
     1643    25691        */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:305  
     1644    25692
     1645    25693
     1646    25694                       /* See if there is a handler that wants this one     */
     1647    25695    7                                CTX$ = GJA_HAND_HEAD$;

  25695   2 0003D0  BC80 0000 0000  xsym                 LDB,B3   GJA_HAND_HEAD$
          2 0003D3  BFC7 0019                            STB,B3   CTX$,AUTO

     1648    25696    8                                DO WHILE (CTX$ ~= ADDR(NIL));

  25696   2 0003D5  0F81 0028                            B        s:25707,PREL

     1649    25697    8                                     IF KH$CHN.RESOURCE = GJA$HAND_CTX.RES

  25697   2 0003D7  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0003D9  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 0003DB  0022                                 ACM      ;
          2 0003DC       4206 0004                                ALPHANUM(4,B6,,2,FILL),;
          2 0003DE       4205 000F                                ALPHANUM(15,B5,,2,FILL)
          2 0003E0  5301 0019                            CBNE     s:25706,PREL
          2 0003E2  E846 0005                            LDR,R6   5,B6
          2 0003E4  8656                                 CPL      R6
          2 0003E5  E545 0010                            AND,R6   16,B5
          2 0003E7  6981 0012                            BNEZ,R6  s:25706,PREL

     1650    25698    8                                       AND (GJA$HAND_CTX.ATTR & ~KH$CHN.ATTR) = '0'B
     1651    25699    9                                     THEN DO;

     1652    25700    9                                          KH$CHN.HAND$ = CTX$;

  25700   2 0003E9  DFC6 001E                            STB,B5   30,B6

     1653    25701    9                                          UID$ = CTX$;

  25701   2 0003EB  DFC7 001B                            STB,B5   UID,AUTO

     1654    25702    9                                          KH$CHN.SYSID = GJA$HAND_CTX.SYSID;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:306  

  25702   2 0003ED  E845 000E                            LDR,R6   14,B5
          2 0003EF  EF46 0006                            STR,R6   6,B6

     1655    25703    9                                          CALL UPDATE_SUBS ( KH$CHN );

  25703   2 0003F1  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0003F3  EFC7 010E                            STB,B6   @NM$+2,AUTO
          2 0003F5  E3C0 1BE8                            LNJ,B6   s:0,PREL
          2 0003F7       0001                            DC       s:25704,PREL

     1656    25704    9                                          EXIT CASEFNC;

  25704   2 0003F8  0F81 000C                            B        s:25716,PREL

     1657    25705    9                                          END;
     1658    25706    8                                     CTX$ = GJA$HAND_CTX.LNK$;

  25706   2 0003FA  CCC5 0001                            LDB,B4   1,B5
          2 0003FC  CFC7 0019                            STB,B4   CTX$,AUTO

     1659    25707    8                                     END;

  25707   2 0003FE  8DC7 0019                            CMN      CTX$,AUTO
          2 000400  09D7                                 BNE      s:25697,SPREL

     1660    25708                                                /* Could not find a handler */
     1661    25709    7                                KH$CHN.STT = %KH#CHN_STT_UN_INT;

  25709   2 000401  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 000403  87C6 0001                            CLH      1,B6

     1662    25710                      /*E* ERROR: GJA-%E$UNOWNED
     1663    25711                           MESSAGE: Return attempted on an unowned channel.
     1664    25712                           MESSAGE1: No handler currently running has the same
     1665    25713                                     res and attr as the chan in your command.
     1666    25714                      */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:307  
     1667    25715    7                                END;       /* KL$ADMIN.FNC CASE        */

     1668    25716    6                             END;          /* DO SUBSUB                */

  25716   2 000405  8AC7 0041                            INC      SUBSUB,AUTO
          2 000407  E847 0041                            LDR,R6   SUBSUB,AUTO
          2 000409  E947 0043                            CMR,R6   SUBSUBHI,AUTO
          2 00040B  0381 FEBD                            BLE      s:25608,PREL

     1669    25717    5                        END;               /* DO SUB                   */

  25717   2 00040D  8AC7 003E                            INC      SUB,AUTO
          2 00040F  E847 003E                            LDR,R6   SUB,AUTO
          2 000411  E947 0040                            CMR,R6   SUBHI,AUTO
          2 000413  0381 FEAF                            BLE      s:25607,PREL

     1670    25718    4                   END;                    /* DO CHAN                  */

  25718   2 000415  D847 003B                            LDR,R5   CHAN,AUTO
          2 000417  DA70 0080                            ADD,R5   128,IMO
          2 000419  DF47 003B                            STR,R5   CHAN,AUTO
          2 00041B  E847 003B                            LDR,R6   CHAN,AUTO
          2 00041D  E947 003D                            CMR,R6   CHANHI,AUTO
          2 00041F  0381 FE9D                            BLE      s:25606,PREL

     1671    25719    3              END;                         /* ADMIN                    */

     1672    25720
     1673    25721    2         IF KL$ADMIN.ORIGIN ~= 'NODEADMN'

  25721   2 000421  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000423  DCC6 0006                            LDB,B5   6,B6
          2 000425  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 000428  0022                                 ACM      ;
          2 000429       4805 0006                                ALPHANUM(6,B5,,8,FILL),;
          2 00042B       4804 0013                                ALPHANUM(19,B4,,8,FILL)
          2 00042D  5381 1B23                            CBE      s:27128,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:308  

     1674    25722    3         THEN DO;

     1675    25723    3              IF WHO ~= %GJA_UID_NM OR UID$ = ADDR(NIL) OR ADMIN.RESULTS ~= '0'B

  25723   2 00042F  E847 0026                            LDR,R6   WHO,AUTO
          2 000431  6D01                                 CMV,R6   1
          2 000432  0981 0010                            BNE      s:25725,PREL
          2 000434  8DC7 001B                            CMN      UID,AUTO
          2 000436  0901 000C                            BE       s:25725,PREL
          2 000438  CB80 0000 0000  03                   LAB,B4   0
          2 00043B  5C01                                 LDV,R5   1
          2 00043C  0022                                 ACM      ;
          2 00043D       4407 00A2                                ALPHANUM(ADMIN+14,AUTO,,4,FILL),;
          2 00043F       4004 0000                                ALPHANUM(0,B4,,R5,FILL)
          2 000441  5381 0042                            CBE      s:25736,PREL

     1676    25724    3              THEN
     1677    25725    3                   IF KL$ADMIN.ORIGIN = 'KHA$ADMN'

  25725   2 000443  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 000446  0022                                 ACM      ;
          2 000447       4805 0006                                ALPHANUM(6,B5,,8,FILL),;
          2 000449       4804 0017                                ALPHANUM(23,B4,,8,FILL)
          2 00044B  5301 0013                            CBNE     s:25729,PREL

     1678    25726    3                   THEN
     1679    25727    3                        CALL GJA$NETWORK_MANAGER(ADMIN,SIZEC(ADMIN));

  25727   2 00044D  CBF0 0084                            LAB,B4   132,IMO
          2 00044F  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 000451  DBC7 0094                            LAB,B5   ADMIN,AUTO
          2 000453  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 000455  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000457  CBF0 0200                            LAB,B4   512,IMO
          2 000459  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 00045C       0001                            DC       s:25727+16,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:309  
          2 00045D  0F81 1AF3                            B        s:27128,PREL

     1680    25728    4                   ELSE DO;

     1681    25729    4                        I = ADMIN.SRCE_NODE;

  25729   2 00045F  D2C7 0095                            LLH,R5   ADMIN+1,AUTO
          2 000461  DF47 0015                            STR,R5   I,AUTO

     1682    25730    4                        CALL FIND_NODE(I,CTX$)

  25730   2 000463  DBC7 0019                            LAB,B5   CTX$,AUTO
          2 000465  DFC7 010C                            STB,B5   ATTR+1,AUTO
          2 000467  CBC7 0015                            LAB,B4   I,AUTO
          2 000469  CFC7 010A                            STB,B4   OSILINKCHG+18,AUTO
          2 00046B  E3C0 1D7A                            LNJ,B6   s:0,PREL
          2 00046D       0015                            DC       s:25734,PREL

     1683    25731    5                        WHENRETURN DO;

     1684    25732    5                             CALL GJA$SEND_MSG(CTX$,ADMIN,LENGTHC(ADMIN));

  25732   2 00046E  EBF0 0084                            LAB,B6   132,IMO
          2 000470  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 000472  DBC7 0094                            LAB,B5   ADMIN,AUTO
          2 000474  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000476  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 000478  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 00047A  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00047C  CBF0 0300                            LAB,B4   768,IMO
          2 00047E  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000481       0001                            DC       s:25734,PREL

     1685    25733    5                             END;

     1686    25734    4                        END;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:310  
  25734   2 000482  0F81 1ACE                            B        s:27128,PREL

     1687    25735    3              ELSE
     1688    25736    3                   CALL GJA$SEND_MSG(UID,ADMIN,SIZEC(KL$ADMIN));

  25736   2 000484  CBF0 0044                            LAB,B4   68,IMO
          2 000486  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 000488  DBC7 0094                            LAB,B5   ADMIN,AUTO
          2 00048A  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00048C  BBC7 001B                            LAB,B3   UID,AUTO
          2 00048E  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 000490  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000492  CBF0 0300                            LAB,B4   768,IMO
          2 000494  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000497       0001                            DC       s:25737,PREL

     1689    25737    3              END;

  25737   2 000498  0F81 1AB8                            B        s:27128,PREL

     1690    25738        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:311  
     1691    25739    2       CASE(IGA_RESET);

     1692    25740    2         KL$ = ADDR(VDO_BUFFER);

  25740   2 00049A  CB80 0000 0040  00                   LAB,B4   VDO_BUFFER
          2 00049D  CFC7 0013                            STB,B4   KL$,AUTO

     1693    25741    2         KL$HDR = ADDR(KL$CNFG_MSG)->KL$HDR;

  25741   2 00049F  AB85                                 LAB,B2   ,B5
          2 0004A0  2C00                                 LDV,R2   0
          2 0004A1  6C22                                 LDV,R6   34
          2 0004A2  BB84                                 LAB,B3   ,B4
          2 0004A3  3C00                                 LDV,R3   0
          2 0004A4  0008                                 MMM

     1694    25742    2         MSGSIZ = SIZEC(GJA_VDO_DAT_DAT1) + SIZEC(KL$HDR);

  25742   2 0004A5  6C28                                 LDV,R6   40
          2 0004A6  EF47 0033                            STR,R6   MSGSIZ,AUTO

     1695    25743    2         TERMLO = KL$CNFG_MSG.TERMID_LO;

  25743   2 0004A8  9CC6 0006                            LDB,B1   6,B6
          2 0004AA  AB81                                 LAB,B2   ,B1
          2 0004AB  2C22                                 LDV,R2   34
          2 0004AC  6C10                                 LDV,R6   16
          2 0004AD  BBC7 005B                            LAB,B3   TERMLO,AUTO
          2 0004AF  3C00                                 LDV,R3   0
          2 0004B0  0008                                 MMM

     1696    25744    2         TERMHI = KL$CNFG_MSG.TERMID_HI;

  25744   2 0004B1  BCC6 0006                            LDB,B3   6,B6
          2 0004B3  AB83                                 LAB,B2   ,B3
          2 0004B4  2C32                                 LDV,R2   50
          2 0004B5  6C10                                 LDV,R6   16
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:312  
          2 0004B6  BBC7 0063                            LAB,B3   TERMHI,AUTO
          2 0004B8  3C00                                 LDV,R3   0
          2 0004B9  0008                                 MMM

     1697    25745    2         CHANLO = TERMLO.TERM.CHANNEL;

  25745   2 0004BA  E847 005C                            LDR,R6   TERMLO+1,AUTO
          2 0004BC  EF47 003C                            STR,R6   CHANLO,AUTO

     1698    25746    2         CHANHI = TERMHI.TERM.CHANNEL;

  25746   2 0004BE  D847 0064                            LDR,R5   TERMHI+1,AUTO
          2 0004C0  DF47 003D                            STR,R5   CHANHI,AUTO

     1699    25747    2         SUBLO = TERMLO.TERM.SUBDEVICE;

  25747   2 0004C2  C847 005D                            LDR,R4   TERMLO+2,AUTO
          2 0004C4  CF47 003F                            STR,R4   SUBLO,AUTO

     1700    25748    2         SUBHI = TERMHI.TERM.SUBDEVICE;

  25748   2 0004C6  B847 0065                            LDR,R3   TERMHI+2,AUTO
          2 0004C8  BF47 0040                            STR,R3   SUBHI,AUTO

     1701    25749    2         SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;

  25749   2 0004CA  A847 005E                            LDR,R2   TERMLO+3,AUTO
          2 0004CC  AF47 0042                            STR,R2   SUBSUBLO,AUTO

     1702    25750    2         SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;

  25750   2 0004CE  9847 0066                            LDR,R1   TERMHI+3,AUTO
          2 0004D0  9F47 0043                            STR,R1   SUBSUBHI,AUTO

     1703    25751    2         KL$TERMINAL_ID = '0'B;

  25751   2 0004D2  5C10                                 LDV,R5   16
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:313  
          2 0004D3  0021                                 ALR      ;
          2 0004D4       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 0004D6       4007 0046                                ALPHANUM(KL$TERMINAL_ID,AUTO,,R5,FILL)

     1704    25752    2         KL$TERMINAL_ID.LEV = TERMLO.LEV;

  25752   2 0004D8  437F                                 CSYNC    s:25751+5,SPREL
          2 0004D9  E847 005B                            LDR,R6   TERMLO,AUTO
          2 0004DB  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 0004DD       00FF

     1705    25753    3         DO CHAN = CHANLO TO CHANHI BY 128;

  25753   2 0004DE  E847 003C                            LDR,R6   CHANLO,AUTO
          2 0004E0  EF47 003B                            STR,R6   CHAN,AUTO
          2 0004E2  0F81 005A                            B        s:25767+6,PREL

     1706    25754    4              DO SUB = SUBLO TO SUBHI;

  25754   2 0004E4  E847 003F                            LDR,R6   SUBLO,AUTO
          2 0004E6  EF47 003E                            STR,R6   SUB,AUTO
          2 0004E8  0F81 0048                            B        s:25766+2,PREL

     1707    25755    5                   DO SUBSUB = SUBSUBLO TO SUBSUBHI;

  25755   2 0004EA  E847 0042                            LDR,R6   SUBSUBLO,AUTO
          2 0004EC  EF47 0041                            STR,R6   SUBSUB,AUTO
          2 0004EE  0F81 003B                            B        s:25765+2,PREL

     1708    25756    5                        KL$TERMINAL_ID.TERM.CHANNEL = CHAN;

  25756   2 0004F0  E847 003B                            LDR,R6   CHAN,AUTO
          2 0004F2  EF47 0047                            STR,R6   KL$TERMINAL_ID+1,AUTO

     1709    25757    5                        KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;

  25757   2 0004F4  D847 003E                            LDR,R5   SUB,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:314  
          2 0004F6  DF47 0048                            STR,R5   KL$TERMINAL_ID+2,AUTO

     1710    25758    5                        KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;

  25758   2 0004F8  C847 0041                            LDR,R4   SUBSUB,AUTO
          2 0004FA  CF47 0049                            STR,R4   KL$TERMINAL_ID+3,AUTO

     1711    25759    5                        NA = KL$CNFG_MSG.NA;

  25759   2 0004FC  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0004FE  DCC6 0006                            LDB,B5   6,B6
          2 000500  AB85                                 LAB,B2   ,B5
          2 000501  2C54                                 LDV,R2   84
          2 000502  6C08                                 LDV,R6   8
          2 000503  BBC7 004E                            LAB,B3   NA,AUTO
          2 000505  3C00                                 LDV,R3   0
          2 000506  0008                                 MMM

     1712    25760    5                        CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,KL$CNFG_MSG.KHA)

  25760   2 000507  CCC6 0006                            LDB,B4   6,B6
          2 000509  BBC4 0021                            LAB,B3   33,B4
          2 00050B  BFC7 0118                            STB,B3   SUBSUB$+6,AUTO
          2 00050D  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 00050F  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 000511  9BC7 004E                            LAB,B1   NA,AUTO
          2 000513  9FC7 0114                            STB,B1   SUBSUB$+2,AUTO
          2 000515  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000517  CBF0 0300                            LAB,B4   768,IMO
          2 000519  E380 0000 0000  xent                 LNJ,B6   GJA$UPDATE_CHNTBL
          2 00051C       0003                            DC       s:25762,PREL
          2 00051D  0F81 000A                            B        s:25765,PREL

     1713    25761    6                        WHENALTRETURN DO;

     1714    25762    6                             KL$HDR.RESULTS = E$CHAN_NOT_THERE;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:315  
  25762   2 00051F  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 000522  ECC7 0013                            LDB,B6   KL$,AUTO
          2 000524  8D46 000E                            SDI      14,B6

     1715    25763    6                             GOTO SEND_RESET_NAK;

  25763   2 000526  0F81 001C                            B        s:25760,PREL

     1716    25764    6                             END;          /* WHENALTRETURN            */
     1717    25765    5                        END;               /* DO SUBSUB                */

  25765   2 000528  8AC7 0041                            INC      SUBSUB,AUTO
          2 00052A  E847 0041                            LDR,R6   SUBSUB,AUTO
          2 00052C  E947 0043                            CMR,R6   SUBSUBHI,AUTO
          2 00052E  03C2                                 BLE      s:25756,SPREL

     1718    25766    4                   END;                    /* DO SUB                   */

  25766   2 00052F  8AC7 003E                            INC      SUB,AUTO
          2 000531  E847 003E                            LDR,R6   SUB,AUTO
          2 000533  E947 0040                            CMR,R6   SUBHI,AUTO
          2 000535  0381 FFB4                            BLE      s:25755,PREL

     1719    25767    3              END;                         /* DO CHAN                  */

  25767   2 000537  D847 003B                            LDR,R5   CHAN,AUTO
          2 000539  DA70 0080                            ADD,R5   128,IMO
          2 00053B  DF47 003B                            STR,R5   CHAN,AUTO
          2 00053D  E847 003B                            LDR,R6   CHAN,AUTO
          2 00053F  E947 003D                            CMR,R6   CHANHI,AUTO
          2 000541  0381 FFA2                            BLE      s:25754,PREL

  25760   2                              SEND_RESET_NAK  null
     1720    25768    2   SEND_RESET_NAK:;
     1721    25769    2         CALL GJA$SEND_MSG(MSGCTX$,KL$HDR,SIZEC(KL$HDR));

  25769   2 000543  EBF0 0022            SEND_RESET_NAK  LAB,B6   34,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:316  
          2 000545  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 000547  DCC7 0013                            LDB,B5   KL$,AUTO
          2 000549  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00054B  CCC7 0006                            LDB,B4   @MSGCTX$,AUTO
          2 00054D  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 00054F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000551  CBF0 0300                            LAB,B4   768,IMO
          2 000553  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000556       0001                            DC       s:25770,PREL

     1722    25770    2         RETURN;

  25770   2 000557  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1723    25771        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:317  
     1724    25772    2       CASE (IGA_CHNDISP);

     1725    25773    2         ADMIN = KL$ADMIN;

  25773   2 00055A  4C44                                 LDV,R4   68
          2 00055B  D870 0084                            LDR,R5   132,IMO
          2 00055D  0021                                 ALR      ;
          2 00055E       4005 0000                                ALPHANUM(0,B5,,R4),;
          2 000560       4007 0094                                ALPHANUM(ADMIN,AUTO,,R5,FILL)

     1726    25774    2         WHO = GJA$HAND_CTX.WHO;

  25774   2 000562  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 000564  437F                                 CSYNC    s:25774+1,SPREL
          2 000565  E805                                 LDR,R6   ,B5
          2 000566  604D                                 SOR,R6   13
          2 000567  EF47 0026                            STR,R6   WHO,AUTO

     1727    25775    2         IF WHO = %GJA_UID_NM

  25775   2 000569  6D01                                 CMV,R6   1
          2 00056A  0981 0005                            BNE      s:25778,PREL

     1728    25776    2         THEN
     1729    25777    2              ADMIN.RESULTS = '0'B;

  25777   2 00056C  8747 00A2                            CL       ADMIN+14,AUTO
          2 00056E  8747 00A3                            CL       ADMIN+15,AUTO

     1730    25778    2         TERMLO = KL$ADMIN.TERMID_LO;

  25778   2 000570  CCC6 0006                            LDB,B4   6,B6
          2 000572  AB84                                 LAB,B2   ,B4
          2 000573  2C24                                 LDV,R2   36
          2 000574  6C10                                 LDV,R6   16
          2 000575  BBC7 005B                            LAB,B3   TERMLO,AUTO
          2 000577  3C00                                 LDV,R3   0
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:318  
          2 000578  0008                                 MMM

     1731    25779    2         TERMHI = KL$ADMIN.TERMID_HI;

  25779   2 000579  DCC6 0006                            LDB,B5   6,B6
          2 00057B  AB85                                 LAB,B2   ,B5
          2 00057C  2C34                                 LDV,R2   52
          2 00057D  6C10                                 LDV,R6   16
          2 00057E  BBC7 0063                            LAB,B3   TERMHI,AUTO
          2 000580  3C00                                 LDV,R3   0
          2 000581  0008                                 MMM

     1732    25780    3         CALL GJA$CHK_TRM_RNG(TERMLO,TERMHI) WHENALTRETURN DO;

  25780   2 000582  BBC7 0063                            LAB,B3   TERMHI,AUTO
          2 000584  BFC7 0116                            STB,B3   SUBSUB$+4,AUTO
          2 000586  9BC7 005B                            LAB,B1   TERMLO,AUTO
          2 000588  9FC7 0114                            STB,B1   SUBSUB$+2,AUTO
          2 00058A  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00058C  CBF0 0200                            LAB,B4   512,IMO
          2 00058E  E380 0000 0000  xent                 LNJ,B6   GJA$CHK_TRM_RNG
          2 000591       0003                            DC       s:25783,PREL
          2 000592  0F81 0001                            B        s:25783,PREL

     1733    25781                      /*N* ??????*/
     1734    25782    3              END;                         /* WHENALTRETURN            */

     1735    25783    2         KL$TERMINAL_ID = '0'B;

  25783   2 000594  5C10                                 LDV,R5   16
          2 000595  0021                                 ALR      ;
          2 000596       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 000598       4007 0046                                ALPHANUM(KL$TERMINAL_ID,AUTO,,R5,FILL)

     1736    25784    2         KL$TERMINAL_ID.TERM.TERM_NAME = ' ';

  25784   2 00059A  0021                                 ALR      ;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:319  
          2 00059B       4178 2000                                ALPHANUM('2000'X,IMO,,1),;
          2 00059D       4807 004A                                ALPHANUM(KL$TERMINAL_ID+4,AUTO,,8,FILL)

     1737    25785    2         TERMHI.TERM.TERM_NAME = ' ';

  25785   2 00059F  0021                                 ALR      ;
          2 0005A0       4178 2000                                ALPHANUM('2000'X,IMO,,1),;
          2 0005A2       4807 0067                                ALPHANUM(TERMHI+4,AUTO,,8,FILL)

     1738    25786    2         TERMLO.TERM.TERM_NAME = ' ';

  25786   2 0005A4  0021                                 ALR      ;
          2 0005A5       4178 2000                                ALPHANUM('2000'X,IMO,,1),;
          2 0005A7       4807 005F                                ALPHANUM(TERMLO+4,AUTO,,8,FILL)

     1739    25787    2         LEV = TERMLO.LEV;

  25787   2 0005A9  E847 005B                            LDR,R6   TERMLO,AUTO
          2 0005AB  E570 00FF                            AND,R6   255,IMO
          2 0005AD  EF47 0044                            STR,R6   LEV,AUTO

     1740    25788    2         MAXLEV = TERMHI.LEV;

  25788   2 0005AF  C847 0063                            LDR,R4   TERMHI,AUTO
          2 0005B1  C570 00FF                            AND,R4   255,IMO
          2 0005B3  CF47 0045                            STR,R4   MAXLEV,AUTO

     1741    25789    2         ADMIN.TYPE = 0;

  25789   2 0005B5  8847 0094                            LBF,'00FF'X       ADMIN,AUTO
  25789   2 0005B7       00FF

     1742    25790    2         IF TERMLO = TERMHI THEN

  25790   2 0005B8  0022                                 ACM      ;
          2 0005B9       5007 005B                                ALPHANUM(TERMLO,AUTO,,16,FILL),;
          2 0005BB       4007 0063                                ALPHANUM(TERMHI,AUTO,,R5,FILL)
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:320  
          2 0005BD  5301 0043                            CBNE     s:25805,PREL

     1743    25791    3         DO;

     1744    25792    4              CALL GJA$GET_CHNTBL_PTR(TERMHI,CHN$) WHENRETURN DO;

  25792   2 0005BF  EBC7 0017                            LAB,B6   CHN$,AUTO
          2 0005C1  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 0005C3  DBC7 0063                            LAB,B5   TERMHI,AUTO
          2 0005C5  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 0005C7  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0005C9  CBF0 0200                            LAB,B4   512,IMO
          2 0005CB  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 0005CE       0013                            DC       s:25797,PREL

     1745    25793    4                   ADMIN.TYPE = 1;

  25793   2 0005CF  6C01                                 LDV,R6   1
          2 0005D0  EAC7 0094                            SRM,R6,'00FF'X    ADMIN,AUTO
          2 0005D2       00FF

     1746    25794    4                   ADMIN.KH$CHN = KH$CHN;

  25794   2 0005D3  ACC7 0017                            LDB,B2   CHN$,AUTO
          2 0005D5  2C00                                 LDV,R2   0
          2 0005D6  6C40                                 LDV,R6   64
          2 0005D7  BBC7 00B6                            LAB,B3   ADMIN+34,AUTO
          2 0005D9  3C00                                 LDV,R3   0
          2 0005DA  0008                                 MMM

     1747    25795    4                   ADMIN.RESULTS = '0'B;

  25795   2 0005DB  8747 00A2                            CL       ADMIN+14,AUTO
          2 0005DD  8747 00A3                            CL       ADMIN+15,AUTO

     1748    25796    4                   END;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:321  
  25796   2 0005DF  0F81 000A                            B        s:25801,PREL

     1749    25797    4              WHENALTRETURN DO;

     1750    25798    4   BADLEV:         ADMIN.TYPE = 1;

  25798   2 0005E1  6C01                 BADLEV          LDV,R6   1
          2 0005E2  EAC7 0094                            SRM,R6,'00FF'X    ADMIN,AUTO
          2 0005E4       00FF

     1751    25799    4                   ADMIN.RESULTS = E$CHAN_NOT_THERE;

  25799   2 0005E5  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 0005E8  8D47 00A2                            SDI      ADMIN+14,AUTO

     1752    25800    4                   END;

     1753    25801    3              CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  25801   2 0005EA  EBF0 0084                            LAB,B6   132,IMO
          2 0005EC  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 0005EE  DBC7 0094                            LAB,B5   ADMIN,AUTO
          2 0005F0  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0005F2  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 0005F4  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0005F6  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0005F8  CBF0 0300                            LAB,B4   768,IMO
          2 0005FA  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 0005FD       0001                            DC       s:25802,PREL

     1754    25802    3              RETURN;

  25802   2 0005FE  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1755    25803    3              END;                         /* if only one channel      */
     1756    25804
     1757    25805    2         IF TERMHI.TERM.CHANNEL >= (GJA_CHNHI/128)*128 THEN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:322  

  25805   2 000601  B800 0000 0000  xsym                 LDR,R3   GJA_CHNHI
          2 000604  3047                                 SOR,R3   7
          2 000605  3007                                 SOL,R3   7
          2 000606  B947 0064                            CMR,R3   TERMHI+1,AUTO
          2 000608  0301 0048                            BG       s:25820,PREL

     1758    25806    3         DO;

     1759    25807    3              TERMHI.TERM.CHANNEL = (GJA_CHNHI/128)*128;

  25807   2 00060A  B800 0000 0000  xsym                 LDR,R3   GJA_CHNHI
          2 00060D  3047                                 SOR,R3   7
          2 00060E  3007                                 SOL,R3   7
          2 00060F  BF47 0064                            STR,R3   TERMHI+1,AUTO

     1760    25808    3              KL$TERMINAL_ID = TERMHI;

  25808   2 000611  ABC7 0063                            LAB,B2   TERMHI,AUTO
          2 000613  2C00                                 LDV,R2   0
          2 000614  6C10                                 LDV,R6   16
          2 000615  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 000617  3C00                                 LDV,R3   0
          2 000618  0008                                 MMM

     1761    25809    3              KL$TERMINAL_ID.TERM.SUBDEVICE = 0;

  25809   2 000619  8747 0048                            CL       KL$TERMINAL_ID+2,AUTO

     1762    25810    3              KL$TERMINAL_ID.TERM.SUBSUBDEVICE = 0;

  25810   2 00061B  8747 0049                            CL       KL$TERMINAL_ID+3,AUTO

     1763    25811    4              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;

  25811   2 00061D  EBC7 0017                            LAB,B6   CHN$,AUTO
          2 00061F  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:323  
          2 000621  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 000623  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 000625  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000627  CBF0 0200                            LAB,B4   512,IMO
          2 000629  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 00062C       0003                            DC       s:25812,PREL
          2 00062D  0F81 0023                            B        s:25820,PREL

     1764    25812    4                   TERMHI.LEV = TERMHI.LEV - 1;

  25812   2 00062F  E847 0063                            LDR,R6   TERMHI,AUTO
          2 000631  EA70 00FF                            ADD,R6   255,IMO
          2 000633  EAC7 0063                            SRM,R6,'00FF'X    TERMHI,AUTO
          2 000635       00FF

     1765    25813    4                   KL$TERMINAL_ID.LEV = TERMHI.LEV;

  25813   2 000636  E847 0063                            LDR,R6   TERMHI,AUTO
          2 000638  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 00063A       00FF

     1766    25814    5                   CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;

  25814   2 00063B  EBC7 0017                            LAB,B6   CHN$,AUTO
          2 00063D  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 00063F  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 000641  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 000643  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000645  CBF0 0200                            LAB,B4   512,IMO
          2 000647  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 00064A       0003                            DC       s:25815,PREL
          2 00064B  0F81 0005                            B        s:25820,PREL

     1767    25815    5                        TERMHI.LEV = %TERMINAL_ID_LEV_CHAN#;

  25815   2 00064D  6C01                                 LDV,R6   1
          2 00064E  EAC7 0063                            SRM,R6,'00FF'X    TERMHI,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:324  
          2 000650       00FF

     1768    25816    5                        END;

     1769    25817    4                   END;

     1770    25818    3              END;

     1771    25819
     1772    25820    3         DO CASE(LEV);                /* what lev is the request for ?*/

  25820   2 000651  B847 0044                            LDR,R3   LEV,AUTO
          2 000653  3D04                                 CMV,R3   4
          2 000654  0281 003B                            BGE      s:25837,PREL
          2 000656  A830 0000 065C  02                   LDR,R2   s:25820+11,R3
          2 000659  83A0 0000 0660  02                   JMP      s:25822,R2
          2 00065C       0030                            DC       s:25837,PREL
          2 00065D       0000                            DC       s:25822,PREL
          2 00065E       000F                            DC       s:25827,PREL
          2 00065F       001E                            DC       s:25832,PREL

     1773    25821    3          CASE(%TERMINAL_ID_LEV_CHAN#);

     1774    25822    3            SUBLO = 0;

  25822   2 000660  8747 003F                            CL       SUBLO,AUTO

     1775    25823    3            SUBHI = 65535;

  25823   2 000662  8947 0040                            LBT,'FFFF'X       SUBHI,AUTO
  25823   2 000664       FFFF

     1776    25824    3            SUBSUBLO = SUBLO;

  25824   2 000665  E847 003F                            LDR,R6   SUBLO,AUTO
          2 000667  EF47 0042                            STR,R6   SUBSUBLO,AUTO

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:325  
     1777    25825    3            SUBSUBHI = SUBHI;

  25825   2 000669  D847 0040                            LDR,R5   SUBHI,AUTO
          2 00066B  DF47 0043                            STR,R5   SUBSUBHI,AUTO
          2 00066D  0F81 0024                            B        s:25840,PREL

     1778    25826    3          CASE(%TERMINAL_ID_LEV_SUBCHAN#);

     1779    25827    3            SUBLO = TERMLO.TERM.SUBDEVICE;

  25827   2 00066F  E847 005D                            LDR,R6   TERMLO+2,AUTO
          2 000671  EF47 003F                            STR,R6   SUBLO,AUTO

     1780    25828    3            SUBHI = TERMHI.TERM.SUBDEVICE;

  25828   2 000673  D847 0065                            LDR,R5   TERMHI+2,AUTO
          2 000675  DF47 0040                            STR,R5   SUBHI,AUTO

     1781    25829    3            SUBSUBLO = 0;

  25829   2 000677  8747 0042                            CL       SUBSUBLO,AUTO

     1782    25830    3            SUBSUBHI = 65535;

  25830   2 000679  8947 0043                            LBT,'FFFF'X       SUBSUBHI,AUTO
  25830   2 00067B       FFFF
          2 00067C  0F81 0015                            B        s:25840,PREL

     1783    25831    3          CASE(%TERMINAL_ID_LEV_SUBSUBCHAN#);

     1784    25832    3            SUBLO = TERMLO.TERM.SUBDEVICE;

  25832   2 00067E  E847 005D                            LDR,R6   TERMLO+2,AUTO
          2 000680  EF47 003F                            STR,R6   SUBLO,AUTO

     1785    25833    3            SUBHI = TERMHI.TERM.SUBDEVICE;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:326  
  25833   2 000682  D847 0065                            LDR,R5   TERMHI+2,AUTO
          2 000684  DF47 0040                            STR,R5   SUBHI,AUTO

     1786    25834    3            SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;

  25834   2 000686  C847 005E                            LDR,R4   TERMLO+3,AUTO
          2 000688  CF47 0042                            STR,R4   SUBSUBLO,AUTO

     1787    25835    3            SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;

  25835   2 00068A  9847 0066                            LDR,R1   TERMHI+3,AUTO
          2 00068C  9F47 0043                            STR,R1   SUBSUBHI,AUTO
          2 00068E  0F81 0003                            B        s:25840,PREL

     1788    25836    3          CASE(ELSE);

     1789    25837    3            GOTO BADLEV;

  25837   2 000690  0F81 FF50                            B        s:25797,PREL

     1790    25838    3            END;                           /* do case on lev           */

     1791    25839
     1792    25840    2         CHANLO = TERMLO.TERM.CHANNEL;

  25840   2 000692  C847 005C                            LDR,R4   TERMLO+1,AUTO
          2 000694  CF47 003C                            STR,R4   CHANLO,AUTO

     1793    25841    2         CHANHI = TERMHI.TERM.CHANNEL;

  25841   2 000696  9847 0064                            LDR,R1   TERMHI+1,AUTO
          2 000698  9F47 003D                            STR,R1   CHANHI,AUTO

     1794    25842    3   CHAN1: DO CHAN = CHANLO TO CHANHI BY 128;

  25842   2 00069A  CF47 003B            CHAN1           STR,R4   CHAN,AUTO
          2 00069C  0F81 0159                            B        s:25902+6,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:327  

     1795    25843    3              KL$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN#;

  25843   2 00069E  6C01                                 LDV,R6   1
          2 00069F  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 0006A1       00FF

     1796    25844    3              KL$TERMINAL_ID.TERM.CHANNEL = CHAN;

  25844   2 0006A2  D847 003B                            LDR,R5   CHAN,AUTO
          2 0006A4  DF47 0047                            STR,R5   KL$TERMINAL_ID+1,AUTO

     1797    25845    3              KL$TERMINAL_ID.TERM.SUBDEVICE = 0;

  25845   2 0006A6  8747 0048                            CL       KL$TERMINAL_ID+2,AUTO

     1798    25846    3              KL$TERMINAL_ID.TERM.SUBSUBDEVICE = 0;

  25846   2 0006A8  8747 0049                            CL       KL$TERMINAL_ID+3,AUTO

     1799    25847    4   CHNOK:     CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENRETURN DO;

  25847   2 0006AA  EBC7 0017            CHNOK           LAB,B6   CHN$,AUTO
          2 0006AC  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 0006AE  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 0006B0  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 0006B2  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0006B4  CBF0 0200                            LAB,B4   512,IMO
          2 0006B6  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 0006B9       0137                            DC       s:25902,PREL

     1800    25848    4                   IF KH$CHN.DVCID = '0'B THEN

  25848   2 0006BA  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0006BC  E846 0002                            LDR,R6   2,B6
          2 0006BE  6901 0131                            BEZ,R6   s:25902,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:328  
     1801    25849    4                        EXIT CHNOK;
     1802    25850    4                   IF KL$TERMINAL_ID.LEV >= TERMLO.LEV THEN

  25850   2 0006C0  D847 0046                            LDR,R5   KL$TERMINAL_ID,AUTO
          2 0006C2  D570 00FF                            AND,R5   255,IMO
          2 0006C4  C847 005B                            LDR,R4   TERMLO,AUTO
          2 0006C6  C570 00FF                            AND,R4   255,IMO
          2 0006C8  D954                                 CMR,R5   R4
          2 0006C9  0801 001C                            BAL      s:25855,PREL

     1803    25851    5                   DO;

     1804    25852    5                        ADMIN.KH$CHN = KH$CHN;

  25852   2 0006CB  AB86                                 LAB,B2   ,B6
          2 0006CC  2C00                                 LDV,R2   0
          2 0006CD  6C40                                 LDV,R6   64
          2 0006CE  BBC7 00B6                            LAB,B3   ADMIN+34,AUTO
          2 0006D0  3C00                                 LDV,R3   0
          2 0006D1  0008                                 MMM

     1805    25853    5                        CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  25853   2 0006D2  DBF0 0084                            LAB,B5   132,IMO
          2 0006D4  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 0006D6  CBC7 0094                            LAB,B4   ADMIN,AUTO
          2 0006D8  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 0006DA  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 0006DC  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 0006DE  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0006E0  CBF0 0300                            LAB,B4   768,IMO
          2 0006E2  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 0006E5       0001                            DC       s:25855,PREL

     1806    25854    5                        END;

     1807    25855    4                   LVL2$ = KH$CHN.SUB$;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:329  

  25855   2 0006E6  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0006E8  DCC6 001A                            LDB,B5   26,B6
          2 0006EA  DFC7 0021                            STB,B5   LVL2$,AUTO

     1808    25856    5                   DO WHILE LVL2$ ~= ADDR(NIL);

  25856   2 0006EC  0F81 00FF                            B        s:25900,PREL

     1809    25857    5                        TCHN$ = LVL2$;

  25857   2 0006EE  ECC7 0021                            LDB,B6   LVL2$,AUTO
          2 0006F0  EFC7 001F                            STB,B6   TCHN$,AUTO

     1810    25858    6                        DO CASE(TERMLO.LEV);

  25858   2 0006F2  B847 005B                            LDR,R3   TERMLO,AUTO
          2 0006F4  B570 00FF                            AND,R3   255,IMO
          2 0006F6  3D04                                 CMV,R3   4
          2 0006F7  0281 0069                            BGE      s:25876,PREL
          2 0006F9  A830 0000 06FF  02                   LDR,R2   s:25858+13,R3
          2 0006FC  83A0 0000 0703  02                   JMP      s:25860,R2
          2 0006FF       005E                            DC       s:25876,PREL
          2 000700       0000                            DC       s:25860,PREL
          2 000701       001D                            DC       s:25862,PREL
          2 000702       0053                            DC       s:25871,PREL

     1811    25859    6                         CASE(%TERMINAL_ID_LEV_CHAN#);

     1812    25860    6                           ADMIN.KH$CHN = TCHN$->KH$CHN;

  25860   2 000703  AB86                                 LAB,B2   ,B6
          2 000704  2C00                                 LDV,R2   0
          2 000705  6C40                                 LDV,R6   64
          2 000706  BBC7 00B6                            LAB,B3   ADMIN+34,AUTO
          2 000708  3C00                                 LDV,R3   0
          2 000709  0008                                 MMM
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:330  

     1813    25861    6                           CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  25861   2 00070A  DBF0 0084                            LAB,B5   132,IMO
          2 00070C  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 00070E  CBC7 0094                            LAB,B4   ADMIN,AUTO
          2 000710  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 000712  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 000714  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 000716  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000718  CBF0 0300                            LAB,B4   768,IMO
          2 00071A  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 00071D       0001                            DC       s:25861+20,PREL
          2 00071E  0F81 0042                            B        s:25876,PREL

     1814    25862    6                         CASE(%TERMINAL_ID_LEV_SUBCHAN#);

     1815    25863    6   DOCHECKS:               IF TERMLO.LEV <= TCHN$->KH$CHN.TERMID.LEV AND

  25863   2 000720  E847 005B            DOCHECKS        LDR,R6   TERMLO,AUTO
          2 000722  E570 00FF                            AND,R6   255,IMO
          2 000724  ECC7 001F                            LDB,B6   TCHN$,AUTO
          2 000726  D846 0012                            LDR,R5   18,B6
          2 000728  D570 00FF                            AND,R5   255,IMO
          2 00072A  E955                                 CMR,R6   R5
          2 00072B  0A01 0035                            BAG      s:25876,PREL
          2 00072D  C847 003F                            LDR,R4   SUBLO,AUTO
          2 00072F  C946 0014                            CMR,R4   20,B6
          2 000731  0301 002F                            BG       s:25876,PREL
          2 000733  B847 0040                            LDR,R3   SUBHI,AUTO
          2 000735  B946 0014                            CMR,R3   20,B6
          2 000737  0201 0029                            BL       s:25876,PREL

     1816    25864    6                             SUBLO <= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE AND
     1817    25865    6                             SUBHI >= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE THEN
     1818    25866    7                           DO;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:331  
     1819    25867    7                                ADMIN.KH$CHN = TCHN$->KH$CHN;

  25867   2 000739  AB86                                 LAB,B2   ,B6
          2 00073A  2C00                                 LDV,R2   0
          2 00073B  6C40                                 LDV,R6   64
          2 00073C  BBC7 00B6                            LAB,B3   ADMIN+34,AUTO
          2 00073E  3C00                                 LDV,R3   0
          2 00073F  0008                                 MMM

     1820    25868    7                                CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  25868   2 000740  DBF0 0084                            LAB,B5   132,IMO
          2 000742  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 000744  CBC7 0094                            LAB,B4   ADMIN,AUTO
          2 000746  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 000748  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 00074A  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00074C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00074E  CBF0 0300                            LAB,B4   768,IMO
          2 000750  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000753       0001                            DC       s:25869,PREL

     1821    25869    7                                END;

  25869   2 000754  0F81 000C                            B        s:25876,PREL

     1822    25870    6                         CASE(%TERMINAL_ID_LEV_SUBSUBCHAN#);

     1823    25871    6                           IF TERMLO.TERM.SUBSUBDEVICE <= TCHN$->KH$CHN.TERMID.TERM.
             25871                                    SUBSUBDEVICE AND

  25871   2 000756  E847 005E                            LDR,R6   TERMLO+3,AUTO
          2 000758  E946 0015                            CMR,R6   21,B6
          2 00075A  0301 0006                            BG       s:25876,PREL
          2 00075C  D847 0066                            LDR,R5   TERMHI+3,AUTO
          2 00075E  D946 0015                            CMR,R5   21,B6
          2 000760  02C0                                 BGE      s:25862,SPREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:332  

     1824    25872    6                             TERMHI.TERM.SUBSUBDEVICE >= TCHN$->KH$CHN.TERMID.TERM.
             25872                                      SUBSUBDEVICE THEN
     1825    25873    6                                GOTO DOCHECKS;
     1826    25874    6                           END;            /* do case                  */

     1827    25875
     1828    25876    5                        LVL3$=LVL2$->KH$CHN.SUB$;

  25876   2 000761  ECC7 0021                            LDB,B6   LVL2$,AUTO
          2 000763  DCC6 001A                            LDB,B5   26,B6
          2 000765  DFC7 0023                            STB,B5   LVL3$,AUTO

     1829    25877    6                        DO WHILE LVL3$~=ADDR(NIL);

  25877   2 000767  0F81 007A                            B        s:25898,PREL

     1830    25878
     1831    25879    6                             TCHN$ = LVL3$;

  25879   2 000769  ECC7 0023                            LDB,B6   LVL3$,AUTO
          2 00076B  EFC7 001F                            STB,B6   TCHN$,AUTO

     1832    25880    7                             DO CASE(TERMLO.LEV);

  25880   2 00076D  B847 005B                            LDR,R3   TERMLO,AUTO
          2 00076F  B570 00FF                            AND,R3   255,IMO
          2 000771  3D04                                 CMV,R3   4
          2 000772  0281 0069                            BGE      s:25897,PREL
          2 000774  A830 0000 077A  02                   LDR,R2   s:25880+13,R3
          2 000777  83A0 0000 077E  02                   JMP      s:25882,R2
          2 00077A       005E                            DC       s:25897,PREL
          2 00077B       0000                            DC       s:25882,PREL
          2 00077C       001D                            DC       s:25884,PREL
          2 00077D       0053                            DC       s:25893,PREL

     1833    25881    7                              CASE(%TERMINAL_ID_LEV_CHAN#);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:333  

     1834    25882    7                                ADMIN.KH$CHN = TCHN$->KH$CHN;

  25882   2 00077E  AB86                                 LAB,B2   ,B6
          2 00077F  2C00                                 LDV,R2   0
          2 000780  6C40                                 LDV,R6   64
          2 000781  BBC7 00B6                            LAB,B3   ADMIN+34,AUTO
          2 000783  3C00                                 LDV,R3   0
          2 000784  0008                                 MMM

     1835    25883    7                                CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  25883   2 000785  DBF0 0084                            LAB,B5   132,IMO
          2 000787  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 000789  CBC7 0094                            LAB,B4   ADMIN,AUTO
          2 00078B  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 00078D  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 00078F  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 000791  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000793  CBF0 0300                            LAB,B4   768,IMO
          2 000795  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000798       0001                            DC       s:25883+20,PREL
          2 000799  0F81 0042                            B        s:25897,PREL

     1836    25884    7                              CASE(%TERMINAL_ID_LEV_SUBCHAN#);

     1837    25885    7   DOCHECKS1:                   IF TERMLO.LEV <= TCHN$->KH$CHN.TERMID.LEV AND

  25885   2 00079B  E847 005B            DOCHECKS1       LDR,R6   TERMLO,AUTO
          2 00079D  E570 00FF                            AND,R6   255,IMO
          2 00079F  ECC7 001F                            LDB,B6   TCHN$,AUTO
          2 0007A1  D846 0012                            LDR,R5   18,B6
          2 0007A3  D570 00FF                            AND,R5   255,IMO
          2 0007A5  E955                                 CMR,R6   R5
          2 0007A6  0A01 0035                            BAG      s:25897,PREL
          2 0007A8  C847 003F                            LDR,R4   SUBLO,AUTO
          2 0007AA  C946 0014                            CMR,R4   20,B6
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:334  
          2 0007AC  0301 002F                            BG       s:25897,PREL
          2 0007AE  B847 0040                            LDR,R3   SUBHI,AUTO
          2 0007B0  B946 0014                            CMR,R3   20,B6
          2 0007B2  0201 0029                            BL       s:25897,PREL

     1838    25886    7                                  SUBLO <= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE AND
     1839    25887    7                                  SUBHI >= TCHN$->KH$CHN.TERMID.TERM.SUBDEVICE THEN
     1840    25888    8                                DO;

     1841    25889    8                                     ADMIN.KH$CHN = TCHN$->KH$CHN;

  25889   2 0007B4  AB86                                 LAB,B2   ,B6
          2 0007B5  2C00                                 LDV,R2   0
          2 0007B6  6C40                                 LDV,R6   64
          2 0007B7  BBC7 00B6                            LAB,B3   ADMIN+34,AUTO
          2 0007B9  3C00                                 LDV,R3   0
          2 0007BA  0008                                 MMM

     1842    25890    8                                     CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  25890   2 0007BB  DBF0 0084                            LAB,B5   132,IMO
          2 0007BD  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 0007BF  CBC7 0094                            LAB,B4   ADMIN,AUTO
          2 0007C1  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 0007C3  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 0007C5  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 0007C7  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0007C9  CBF0 0300                            LAB,B4   768,IMO
          2 0007CB  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 0007CE       0001                            DC       s:25891,PREL

     1843    25891    8                                     END;

  25891   2 0007CF  0F81 000C                            B        s:25897,PREL

     1844    25892    7                              CASE(%TERMINAL_ID_LEV_SUBSUBCHAN#);

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:335  
     1845    25893    7                                IF TERMLO.TERM.SUBSUBDEVICE <= TCHN$->KH$CHN.TERMID.
             25893                                         TERM.SUBSUBDEVICE AND

  25893   2 0007D1  E847 005E                            LDR,R6   TERMLO+3,AUTO
          2 0007D3  E946 0015                            CMR,R6   21,B6
          2 0007D5  0301 0006                            BG       s:25897,PREL
          2 0007D7  D847 0066                            LDR,R5   TERMHI+3,AUTO
          2 0007D9  D946 0015                            CMR,R5   21,B6
          2 0007DB  02C0                                 BGE      s:25884,SPREL

     1846    25894    7                                 TERMHI.TERM.SUBSUBDEVICE >= TCHN$->KH$CHN.TERMID.TERM
             25894                                           .SUBSUBDEVICE THEN
     1847    25895    7                                     GOTO DOCHECKS1;
     1848    25896    7                                END;       /* do case                  */

     1849    25897    6                             LVL3$ = LVL3$->KH$CHN.LNK$;

  25897   2 0007DC  ECC7 0023                            LDB,B6   LVL3$,AUTO
          2 0007DE  DCC6 001C                            LDB,B5   28,B6
          2 0007E0  DFC7 0023                            STB,B5   LVL3$,AUTO

     1850    25898    6                             END;          /* do while lvl3$~=addr(nil)*/

  25898   2 0007E2  8DC7 0023                            CMN      LVL3$,AUTO
          2 0007E4  0981 FF84                            BNE      s:25879,PREL

     1851    25899    5                        LVL2$ = LVL2$->KH$CHN.LNK$;

  25899   2 0007E6  ECC7 0021                            LDB,B6   LVL2$,AUTO
          2 0007E8  CCC6 001C                            LDB,B4   28,B6
          2 0007EA  CFC7 0021                            STB,B4   LVL2$,AUTO

     1852    25900    5                        END;               /* do while lvl2$~=addr(nil)*/

  25900   2 0007EC  8DC7 0021                            CMN      LVL2$,AUTO
          2 0007EE  0981 FEFF                            BNE      s:25857,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:336  
     1853    25901    4                   END;                    /* whenreturn               */

     1854    25902    3              END;                         /* do chanlo to chanhi      */

  25902   2 0007F0  E847 003B                            LDR,R6   CHAN,AUTO
          2 0007F2  EA70 0080                            ADD,R6   128,IMO
          2 0007F4  EF47 003B                            STR,R6   CHAN,AUTO
          2 0007F6  E847 003B                            LDR,R6   CHAN,AUTO
          2 0007F8  E947 003D                            CMR,R6   CHANHI,AUTO
          2 0007FA  0381 FEA3                            BLE      s:25843,PREL

     1855    25903    2         ADMIN.TERMID_LO = '0'B;

  25903   2 0007FC  5C10                                 LDV,R5   16
          2 0007FD  0021                                 ALR      ;
          2 0007FE       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 000800       4007 00A6                                ALPHANUM(ADMIN+18,AUTO,,R5,FILL)

     1856    25904    2         ADMIN.TYPE = 1;

  25904   2 000802  4C01                                 LDV,R4   1
          2 000803  CAC7 0094                            SRM,R4,'00FF'X    ADMIN,AUTO
          2 000805       00FF

     1857    25905    2         CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  25905   2 000806  EBF0 0084                            LAB,B6   132,IMO
          2 000808  437F                                 CSYNC    s:25905+1,SPREL
          2 000809  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 00080B  DBC7 0094                            LAB,B5   ADMIN,AUTO
          2 00080D  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00080F  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 000811  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000813  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000815  CBF0 0300                            LAB,B4   768,IMO
          2 000817  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 00081A       0001                            DC       s:25906,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:337  

     1858    25906    2         RETURN;

  25906   2 00081B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1859    25907        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:338  
     1860    25908    2       CASE(IGA_SSAL);                     /* Set salutation           */

     1861    25909    2         IF GJA_DEFNODE = GJA$HAND_CTX.NODE THEN

  25909   2 00081E  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000820  E844 000D                            LDR,R6   13,B4
          2 000822  E570 00FF                            AND,R6   255,IMO
          2 000824  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000827  0981 0006                            BNE      s:25913,PREL

     1862    25910        /* dont change message unless its from our nm */
     1863    25911                   %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_SALUTE$);

  25912   2 000829  0901 0004                            BE       s:25913,PREL

  25912   2 00082B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  25913   2 00082E  8D80 0000 0000  xsym                 CMN      GJA_MSG_SALUTE$
          2 000831  0901 001A                            BE       s:25915,PREL

  25914   2 000833  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_SALUTE$
          2 000836  D283                                 LLH,R5   ,B3
          2 000837  5E02                                 ADV,R5   2
          2 000838  5041                                 SOR,R5   1
          2 000839  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 00083B  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_SALUTE$
          2 00083E  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000840  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000842  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000844  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000846  CBF0 0200                            LAB,B4   512,IMO
          2 000848  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 00084B       0001                            DC       s:25915,PREL

  25915   2 00084C  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 00084E  E846 0008                            LDR,R6   8,B6
          2 000850  6041                                 SOR,R6   1
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:339  
          2 000851  EF47 0034                            STR,R6   SIZE,AUTO

  25916   2 000853  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_SALUTE$
          2 000856  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000858  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 00085A  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 00085C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00085E  CBF0 0200                            LAB,B4   512,IMO
          2 000860  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000863       0001                            DC       s:25917,PREL

  25917   2 000864  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000866  E846 0008                            LDR,R6   8,B6
          2 000868  6EFE                                 ADV,R6   -2
          2 000869  EF47 0034                            STR,R6   SIZE,AUTO

  25918   2 00086B  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_SALUTE$
          2 00086E  E785                                 STH,R6   ,B5

  25919   2 00086F  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_SALUTE$
          2 000872  E285                                 LLH,R6   ,B5
          2 000873  CCC6 0006                            LDB,B4   6,B6
          2 000875  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000877  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000879  AB84                                 LAB,B2   ,B4
          2 00087A  2C02                                 LDV,R2   2
          2 00087B  E870 03E7                            LDR,R6   999,IMO
          2 00087D  BB85                                 LAB,B3   ,B5
          2 00087E  3C01                                 LDV,R3   1
          2 00087F  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000881  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000884  0F81 16CC                            B        s:27128,PREL

     1864    25921
     1865    25922    2       CASE(IGA_HDR);                      /* Set Salutation header    */

     1866    25923    2         IF GJA_DEFNODE = GJA$HAND_CTX.NODE THEN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:340  

  25923   2 000886  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000888  E844 000D                            LDR,R6   13,B4
          2 00088A  E570 00FF                            AND,R6   255,IMO
          2 00088C  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 00088F  0981 0006                            BNE      s:25926,PREL

     1867    25924                   %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HDR$);

  25925   2 000891  0901 0004                            BE       s:25926,PREL

  25925   2 000893  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  25926   2 000896  8D80 0000 0000  xsym                 CMN      GJA_MSG_HDR$
          2 000899  0901 001A                            BE       s:25928,PREL

  25927   2 00089B  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_HDR$
          2 00089E  D283                                 LLH,R5   ,B3
          2 00089F  5E02                                 ADV,R5   2
          2 0008A0  5041                                 SOR,R5   1
          2 0008A1  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 0008A3  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HDR$
          2 0008A6  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 0008A8  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 0008AA  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 0008AC  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 0008AE  CBF0 0200                            LAB,B4   512,IMO
          2 0008B0  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 0008B3       0001                            DC       s:25928,PREL

  25928   2 0008B4  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0008B6  E846 0008                            LDR,R6   8,B6
          2 0008B8  6041                                 SOR,R6   1
          2 0008B9  EF47 0034                            STR,R6   SIZE,AUTO

  25929   2 0008BB  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HDR$
          2 0008BE  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:341  
          2 0008C0  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 0008C2  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0008C4  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0008C6  CBF0 0200                            LAB,B4   512,IMO
          2 0008C8  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 0008CB       0001                            DC       s:25930,PREL

  25930   2 0008CC  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0008CE  E846 0008                            LDR,R6   8,B6
          2 0008D0  6EFE                                 ADV,R6   -2
          2 0008D1  EF47 0034                            STR,R6   SIZE,AUTO

  25931   2 0008D3  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HDR$
          2 0008D6  E785                                 STH,R6   ,B5

  25932   2 0008D7  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HDR$
          2 0008DA  E285                                 LLH,R6   ,B5
          2 0008DB  CCC6 0006                            LDB,B4   6,B6
          2 0008DD  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 0008DF  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 0008E1  AB84                                 LAB,B2   ,B4
          2 0008E2  2C02                                 LDV,R2   2
          2 0008E3  E870 03E7                            LDR,R6   999,IMO
          2 0008E5  BB85                                 LAB,B3   ,B5
          2 0008E6  3C01                                 LDV,R3   1
          2 0008E7  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 0008E9  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 0008EC  0F81 1664                            B        s:27128,PREL

     1868    25934
     1869    25935    2       CASE(IGA_STOPFEP);

     1870    25936              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HDR$);

  25937   2 0008EE  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0008F0  E844 000D                            LDR,R6   13,B4
          2 0008F2  E570 00FF                            AND,R6   255,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:342  
          2 0008F4  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 0008F7  0901 0004                            BE       s:25938,PREL

  25937   2 0008F9  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  25938   2 0008FC  8D80 0000 0000  xsym                 CMN      GJA_MSG_HDR$
          2 0008FF  0901 001A                            BE       s:25940,PREL

  25939   2 000901  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_HDR$
          2 000904  D283                                 LLH,R5   ,B3
          2 000905  5E02                                 ADV,R5   2
          2 000906  5041                                 SOR,R5   1
          2 000907  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000909  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HDR$
          2 00090C  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 00090E  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000910  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000912  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000914  CBF0 0200                            LAB,B4   512,IMO
          2 000916  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000919       0001                            DC       s:25940,PREL

  25940   2 00091A  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 00091C  E846 0008                            LDR,R6   8,B6
          2 00091E  6041                                 SOR,R6   1
          2 00091F  EF47 0034                            STR,R6   SIZE,AUTO

  25941   2 000921  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HDR$
          2 000924  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000926  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000928  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 00092A  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00092C  CBF0 0200                            LAB,B4   512,IMO
          2 00092E  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000931       0001                            DC       s:25942,PREL

  25942   2 000932  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:343  
          2 000934  E846 0008                            LDR,R6   8,B6
          2 000936  6EFE                                 ADV,R6   -2
          2 000937  EF47 0034                            STR,R6   SIZE,AUTO

  25943   2 000939  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HDR$
          2 00093C  E785                                 STH,R6   ,B5

  25944   2 00093D  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HDR$
          2 000940  E285                                 LLH,R6   ,B5
          2 000941  CCC6 0006                            LDB,B4   6,B6
          2 000943  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000945  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000947  AB84                                 LAB,B2   ,B4
          2 000948  2C02                                 LDV,R2   2
          2 000949  E870 03E7                            LDR,R6   999,IMO
          2 00094B  BB85                                 LAB,B3   ,B5
          2 00094C  3C01                                 LDV,R3   1
          2 00094D  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 00094F  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

     1871    25946    2         CALL GJA$NETWORK_MANAGER(GJA_STOK,SIZEC(GJA_STOK));

  25946   2 000952  EBF0 0002                            LAB,B6   2,IMO
          2 000954  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 000956  DB80 0000 000F  01                   LAB,B5   GJA_STOK
          2 000959  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 00095B  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00095D  CBF0 0200                            LAB,B4   512,IMO
          2 00095F  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 000962       0001                            DC       s:25946+17,PREL
          2 000963  0F81 15ED                            B        s:27128,PREL

     1872    25947
     1873    25948    2       CASE(IGA_SHDM);                     /* Host down message        */

     1874    25949              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HOSTDOWN$);

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:344  
  25950   2 000965  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000967  E844 000D                            LDR,R6   13,B4
          2 000969  E570 00FF                            AND,R6   255,IMO
          2 00096B  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 00096E  0901 0004                            BE       s:25951,PREL

  25950   2 000970  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  25951   2 000973  8D80 0000 0000  xsym                 CMN      GJA_MSG_HOSTDOWN$
          2 000976  0901 001A                            BE       s:25953,PREL

  25952   2 000978  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_HOSTDOWN$
          2 00097B  D283                                 LLH,R5   ,B3
          2 00097C  5E02                                 ADV,R5   2
          2 00097D  5041                                 SOR,R5   1
          2 00097E  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000980  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HOSTDOWN$
          2 000983  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000985  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000987  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000989  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 00098B  CBF0 0200                            LAB,B4   512,IMO
          2 00098D  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000990       0001                            DC       s:25953,PREL

  25953   2 000991  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000993  E846 0008                            LDR,R6   8,B6
          2 000995  6041                                 SOR,R6   1
          2 000996  EF47 0034                            STR,R6   SIZE,AUTO

  25954   2 000998  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HOSTDOWN$
          2 00099B  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00099D  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 00099F  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0009A1  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0009A3  CBF0 0200                            LAB,B4   512,IMO
          2 0009A5  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:345  
          2 0009A8       0001                            DC       s:25955,PREL

  25955   2 0009A9  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0009AB  E846 0008                            LDR,R6   8,B6
          2 0009AD  6EFE                                 ADV,R6   -2
          2 0009AE  EF47 0034                            STR,R6   SIZE,AUTO

  25956   2 0009B0  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HOSTDOWN$
          2 0009B3  E785                                 STH,R6   ,B5

  25957   2 0009B4  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HOSTDOWN$
          2 0009B7  E285                                 LLH,R6   ,B5
          2 0009B8  CCC6 0006                            LDB,B4   6,B6
          2 0009BA  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 0009BC  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 0009BE  AB84                                 LAB,B2   ,B4
          2 0009BF  2C02                                 LDV,R2   2
          2 0009C0  E870 03E7                            LDR,R6   999,IMO
          2 0009C2  BB85                                 LAB,B3   ,B5
          2 0009C3  3C01                                 LDV,R3   1
          2 0009C4  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 0009C6  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 0009C9  0F81 1587                            B        s:27128,PREL

     1875    25959
     1876    25960    2       CASE(IGA_LNKDWNMSG);

     1877    25961              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_LINKDOWN$);

  25962   2 0009CB  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0009CD  E844 000D                            LDR,R6   13,B4
          2 0009CF  E570 00FF                            AND,R6   255,IMO
          2 0009D1  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 0009D4  0901 0004                            BE       s:25963,PREL

  25962   2 0009D6  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:346  
  25963   2 0009D9  8D80 0000 0000  xsym                 CMN      GJA_MSG_LINKDOWN$
          2 0009DC  0901 001A                            BE       s:25965,PREL

  25964   2 0009DE  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_LINKDOWN$
          2 0009E1  D283                                 LLH,R5   ,B3
          2 0009E2  5E02                                 ADV,R5   2
          2 0009E3  5041                                 SOR,R5   1
          2 0009E4  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 0009E6  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_LINKDOWN$
          2 0009E9  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 0009EB  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 0009ED  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 0009EF  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 0009F1  CBF0 0200                            LAB,B4   512,IMO
          2 0009F3  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 0009F6       0001                            DC       s:25965,PREL

  25965   2 0009F7  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0009F9  E846 0008                            LDR,R6   8,B6
          2 0009FB  6041                                 SOR,R6   1
          2 0009FC  EF47 0034                            STR,R6   SIZE,AUTO

  25966   2 0009FE  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_LINKDOWN$
          2 000A01  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000A03  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000A05  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000A07  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000A09  CBF0 0200                            LAB,B4   512,IMO
          2 000A0B  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000A0E       0001                            DC       s:25967,PREL

  25967   2 000A0F  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000A11  E846 0008                            LDR,R6   8,B6
          2 000A13  6EFE                                 ADV,R6   -2
          2 000A14  EF47 0034                            STR,R6   SIZE,AUTO

  25968   2 000A16  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_LINKDOWN$
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:347  
          2 000A19  E785                                 STH,R6   ,B5

  25969   2 000A1A  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_LINKDOWN$
          2 000A1D  E285                                 LLH,R6   ,B5
          2 000A1E  CCC6 0006                            LDB,B4   6,B6
          2 000A20  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000A22  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000A24  AB84                                 LAB,B2   ,B4
          2 000A25  2C02                                 LDV,R2   2
          2 000A26  E870 03E7                            LDR,R6   999,IMO
          2 000A28  BB85                                 LAB,B3   ,B5
          2 000A29  3C01                                 LDV,R3   1
          2 000A2A  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000A2C  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000A2F  0F81 1521                            B        s:27128,PREL

     1878    25971
     1879    25972    2       CASE(IGA_HOSTRESUMED);

     1880    25973              %EXTRACT_MESSAGE(DESTPTR=GJA_HOSTRESUMED$);

  25974   2 000A31  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000A33  E844 000D                            LDR,R6   13,B4
          2 000A35  E570 00FF                            AND,R6   255,IMO
          2 000A37  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000A3A  0901 0004                            BE       s:25975,PREL

  25974   2 000A3C  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  25975   2 000A3F  8D80 0000 0000  xsym                 CMN      GJA_HOSTRESUMED$
          2 000A42  0901 001A                            BE       s:25977,PREL

  25976   2 000A44  BC80 0000 0000  xsym                 LDB,B3   GJA_HOSTRESUMED$
          2 000A47  D283                                 LLH,R5   ,B3
          2 000A48  5E02                                 ADV,R5   2
          2 000A49  5041                                 SOR,R5   1
          2 000A4A  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:348  
          2 000A4C  DB80 0000 0000  xsym                 LAB,B5   GJA_HOSTRESUMED$
          2 000A4F  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000A51  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000A53  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000A55  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000A57  CBF0 0200                            LAB,B4   512,IMO
          2 000A59  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000A5C       0001                            DC       s:25977,PREL

  25977   2 000A5D  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000A5F  E846 0008                            LDR,R6   8,B6
          2 000A61  6041                                 SOR,R6   1
          2 000A62  EF47 0034                            STR,R6   SIZE,AUTO

  25978   2 000A64  DB80 0000 0000  xsym                 LAB,B5   GJA_HOSTRESUMED$
          2 000A67  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000A69  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000A6B  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000A6D  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000A6F  CBF0 0200                            LAB,B4   512,IMO
          2 000A71  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000A74       0001                            DC       s:25979,PREL

  25979   2 000A75  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000A77  E846 0008                            LDR,R6   8,B6
          2 000A79  6EFE                                 ADV,R6   -2
          2 000A7A  EF47 0034                            STR,R6   SIZE,AUTO

  25980   2 000A7C  DC80 0000 0000  xsym                 LDB,B5   GJA_HOSTRESUMED$
          2 000A7F  E785                                 STH,R6   ,B5

  25981   2 000A80  DC80 0000 0000  xsym                 LDB,B5   GJA_HOSTRESUMED$
          2 000A83  E285                                 LLH,R6   ,B5
          2 000A84  CCC6 0006                            LDB,B4   6,B6
          2 000A86  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000A88  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000A8A  AB84                                 LAB,B2   ,B4
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:349  
          2 000A8B  2C02                                 LDV,R2   2
          2 000A8C  E870 03E7                            LDR,R6   999,IMO
          2 000A8E  BB85                                 LAB,B3   ,B5
          2 000A8F  3C01                                 LDV,R3   1
          2 000A90  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000A92  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000A95  0F81 14BB                            B        s:27128,PREL

     1881    25983
     1882    25984    2       CASE(IGA_LGNTIMEDOUT);

     1883    25985              %EXTRACT_MESSAGE(DESTPTR=GJA_LGNTIMEDOUT$);

  25986   2 000A97  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000A99  E844 000D                            LDR,R6   13,B4
          2 000A9B  E570 00FF                            AND,R6   255,IMO
          2 000A9D  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000AA0  0901 0004                            BE       s:25987,PREL

  25986   2 000AA2  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  25987   2 000AA5  8D80 0000 0000  xsym                 CMN      GJA_LGNTIMEDOUT$
          2 000AA8  0901 001A                            BE       s:25989,PREL

  25988   2 000AAA  BC80 0000 0000  xsym                 LDB,B3   GJA_LGNTIMEDOUT$
          2 000AAD  D283                                 LLH,R5   ,B3
          2 000AAE  5E02                                 ADV,R5   2
          2 000AAF  5041                                 SOR,R5   1
          2 000AB0  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000AB2  DB80 0000 0000  xsym                 LAB,B5   GJA_LGNTIMEDOUT$
          2 000AB5  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000AB7  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000AB9  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000ABB  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000ABD  CBF0 0200                            LAB,B4   512,IMO
          2 000ABF  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000AC2       0001                            DC       s:25989,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:350  

  25989   2 000AC3  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000AC5  E846 0008                            LDR,R6   8,B6
          2 000AC7  6041                                 SOR,R6   1
          2 000AC8  EF47 0034                            STR,R6   SIZE,AUTO

  25990   2 000ACA  DB80 0000 0000  xsym                 LAB,B5   GJA_LGNTIMEDOUT$
          2 000ACD  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000ACF  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000AD1  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000AD3  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000AD5  CBF0 0200                            LAB,B4   512,IMO
          2 000AD7  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000ADA       0001                            DC       s:25991,PREL

  25991   2 000ADB  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000ADD  E846 0008                            LDR,R6   8,B6
          2 000ADF  6EFE                                 ADV,R6   -2
          2 000AE0  EF47 0034                            STR,R6   SIZE,AUTO

  25992   2 000AE2  DC80 0000 0000  xsym                 LDB,B5   GJA_LGNTIMEDOUT$
          2 000AE5  E785                                 STH,R6   ,B5

  25993   2 000AE6  DC80 0000 0000  xsym                 LDB,B5   GJA_LGNTIMEDOUT$
          2 000AE9  E285                                 LLH,R6   ,B5
          2 000AEA  CCC6 0006                            LDB,B4   6,B6
          2 000AEC  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000AEE  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000AF0  AB84                                 LAB,B2   ,B4
          2 000AF1  2C02                                 LDV,R2   2
          2 000AF2  E870 03E7                            LDR,R6   999,IMO
          2 000AF4  BB85                                 LAB,B3   ,B5
          2 000AF5  3C01                                 LDV,R3   1
          2 000AF6  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000AF8  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000AFB  0F81 1455                            B        s:27128,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:351  
     1884    25995
     1885    25996    2       CASE(IGA_NOLOGONMSG);

     1886    25997              %EXTRACT_MESSAGE(DESTPTR=GJA_NOLOGONMSG$);

  25998   2 000AFD  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000AFF  E844 000D                            LDR,R6   13,B4
          2 000B01  E570 00FF                            AND,R6   255,IMO
          2 000B03  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000B06  0901 0004                            BE       s:25999,PREL

  25998   2 000B08  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  25999   2 000B0B  8D80 0000 0000  xsym                 CMN      GJA_NOLOGONMSG$
          2 000B0E  0901 001A                            BE       s:26001,PREL

  26000   2 000B10  BC80 0000 0000  xsym                 LDB,B3   GJA_NOLOGONMSG$
          2 000B13  D283                                 LLH,R5   ,B3
          2 000B14  5E02                                 ADV,R5   2
          2 000B15  5041                                 SOR,R5   1
          2 000B16  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000B18  DB80 0000 0000  xsym                 LAB,B5   GJA_NOLOGONMSG$
          2 000B1B  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000B1D  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000B1F  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000B21  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000B23  CBF0 0200                            LAB,B4   512,IMO
          2 000B25  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000B28       0001                            DC       s:26001,PREL

  26001   2 000B29  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000B2B  E846 0008                            LDR,R6   8,B6
          2 000B2D  6041                                 SOR,R6   1
          2 000B2E  EF47 0034                            STR,R6   SIZE,AUTO

  26002   2 000B30  DB80 0000 0000  xsym                 LAB,B5   GJA_NOLOGONMSG$
          2 000B33  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:352  
          2 000B35  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000B37  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000B39  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000B3B  CBF0 0200                            LAB,B4   512,IMO
          2 000B3D  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000B40       0001                            DC       s:26003,PREL

  26003   2 000B41  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000B43  E846 0008                            LDR,R6   8,B6
          2 000B45  6EFE                                 ADV,R6   -2
          2 000B46  EF47 0034                            STR,R6   SIZE,AUTO

  26004   2 000B48  DC80 0000 0000  xsym                 LDB,B5   GJA_NOLOGONMSG$
          2 000B4B  E785                                 STH,R6   ,B5

  26005   2 000B4C  DC80 0000 0000  xsym                 LDB,B5   GJA_NOLOGONMSG$
          2 000B4F  E285                                 LLH,R6   ,B5
          2 000B50  CCC6 0006                            LDB,B4   6,B6
          2 000B52  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000B54  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000B56  AB84                                 LAB,B2   ,B4
          2 000B57  2C02                                 LDV,R2   2
          2 000B58  E870 03E7                            LDR,R6   999,IMO
          2 000B5A  BB85                                 LAB,B3   ,B5
          2 000B5B  3C01                                 LDV,R3   1
          2 000B5C  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000B5E  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000B61  0F81 13EF                            B        s:27128,PREL

     1887    26007
     1888    26008    2       CASE (IGA_LGNPRMPT);

     1889    26009    2         SIZE = GJA$PARAMS.DATSIZE - SIZEC(KL$MES);

  26009   2 000B63  E846 0008                            LDR,R6   8,B6
          2 000B65  6EFE                                 ADV,R6   -2
          2 000B66  EF47 0034                            STR,R6   SIZE,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:353  

     1890    26010    2         GJA_PROMPT_VDO.DAT2.BYTSIZ = SIZE + 3;

  26010   2 000B68  6E03                                 ADV,R6   3
          2 000B69  EF00 0000 0002  xsym                 STR,R6   GJA_PROMPT_VDO+2

     1891    26011    2         GJA_PROMPT_VDO.TL.LEN = SIZE+1;

  26011   2 000B6C  D847 0034                            LDR,R5   SIZE,AUTO
          2 000B6E  5E01                                 ADV,R5   1
          2 000B6F  DA80 0000 0003  xsym                 SRM,R5,'00FF'X    GJA_PROMPT_VDO+3
          2 000B72       00FF

     1892    26012    2         GJA_PROMPT_VDO.PROMPT = PINCRW(GJA$PARAMS.DAT$,SIZEW(KL$MES))->BUFFER;

  26012   2 000B73  DCC6 0006                            LDB,B5   6,B6
          2 000B75  AB85                                 LAB,B2   ,B5
          2 000B76  2C02                                 LDV,R2   2
          2 000B77  6C27                                 LDV,R6   39
          2 000B78  BB80 0000 0000  xsym                 LAB,B3   GJA_PROMPT_VDO
          2 000B7B  3C09                                 LDV,R3   9
          2 000B7C  0008                                 MMM
          2 000B7D  0F81 13D3                            B        s:27128,PREL

     1893    26013
     1894    26014    2       CASE(IGA_BCST);                     /* Broadcase message        */

     1895    26015              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_HDR$);

  26016   2 000B7F  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000B81  E844 000D                            LDR,R6   13,B4
          2 000B83  E570 00FF                            AND,R6   255,IMO
          2 000B85  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000B88  0901 0004                            BE       s:26017,PREL

  26016   2 000B8A  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:354  
  26017   2 000B8D  8D80 0000 0000  xsym                 CMN      GJA_MSG_HDR$
          2 000B90  0901 001A                            BE       s:26019,PREL

  26018   2 000B92  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_HDR$
          2 000B95  D283                                 LLH,R5   ,B3
          2 000B96  5E02                                 ADV,R5   2
          2 000B97  5041                                 SOR,R5   1
          2 000B98  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000B9A  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HDR$
          2 000B9D  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000B9F  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000BA1  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000BA3  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000BA5  CBF0 0200                            LAB,B4   512,IMO
          2 000BA7  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000BAA       0001                            DC       s:26019,PREL

  26019   2 000BAB  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000BAD  E846 0008                            LDR,R6   8,B6
          2 000BAF  6041                                 SOR,R6   1
          2 000BB0  EF47 0034                            STR,R6   SIZE,AUTO

  26020   2 000BB2  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_HDR$
          2 000BB5  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000BB7  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000BB9  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000BBB  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000BBD  CBF0 0200                            LAB,B4   512,IMO
          2 000BBF  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000BC2       0001                            DC       s:26021,PREL

  26021   2 000BC3  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000BC5  E846 0008                            LDR,R6   8,B6
          2 000BC7  6EFE                                 ADV,R6   -2
          2 000BC8  EF47 0034                            STR,R6   SIZE,AUTO

  26022   2 000BCA  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HDR$
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:355  
          2 000BCD  E785                                 STH,R6   ,B5

  26023   2 000BCE  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_HDR$
          2 000BD1  E285                                 LLH,R6   ,B5
          2 000BD2  CCC6 0006                            LDB,B4   6,B6
          2 000BD4  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000BD6  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000BD8  AB84                                 LAB,B2   ,B4
          2 000BD9  2C02                                 LDV,R2   2
          2 000BDA  E870 03E7                            LDR,R6   999,IMO
          2 000BDC  BB85                                 LAB,B3   ,B5
          2 000BDD  3C01                                 LDV,R3   1
          2 000BDE  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000BE0  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

     1896    26025    2         GOTO SENDALL;

  26025   2 000BE3  0F81 0001                            B        s:26027,PREL

     1897    26026
     1898    26027    2       CASE(IGA_SALL);                     /* Sendall message          */

  26025   2                              SENDALL         null
     1899    26028    2   SENDALL: ;
     1900    26029    2         RSP$ = GJA_USRLGN_HEAD$;

  26029   2 000BE5  EC80 0000 0000  xsym SENDALL         LDB,B6   GJA_USRLGN_HEAD$
          2 000BE8  EFC7 0035                            STB,B6   RSP$,AUTO

     1901    26030
     1902    26031    3         DO WHILE(RSP$ ~= ADDR(NIL));

  26031   2 000BEA  0F81 0046                            B        s:26041,PREL

     1903    26032    3              IF RSP$->GJA$LGNCTX.STATUS.INT

  26032   2 000BEC  ECC7 0035                            LDB,B6   RSP$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:356  
          2 000BEE  82C6 0018                            LB,'0400'X        24,B6
          2 000BF0       0400
          2 000BF1  0581 0039                            BBF      s:26040,PREL
          2 000BF3  89C6 0018                            CMZ      24,B6
          2 000BF5  0801 0035                            BAL      s:26040,PREL
          2 000BF7  82C6 0018                            LB,'0100'X        24,B6
          2 000BF9       0100
          2 000BFA  0501 0030                            BBT      s:26040,PREL
          2 000BFC  82C6 0018                            LB,'1000'X        24,B6
          2 000BFE       1000
          2 000BFF  0501 002B                            BBT      s:26040,PREL

     1904    26033    3               AND NOT (RSP$->GJA$LGNCTX.STATUS.TERM OR RSP$->GJA$LGNCTX.STATUS.DSCRCV
             26033                         OR RSP$->GJA$LGNCTX.STATUS.TERMACK)
     1905    26034    4              THEN DO;

     1906    26035    4                   GJA_VDO_DAT_DAT2.FNC = %KV_VDO_FNC_DAT_IMD;

  26035   2 000C01  6C06                                 LDV,R6   6
          2 000C02  E780 0000 0000  xsym                 STH,R6   GJA_VDO_DAT_DAT2

     1907    26036    4                  CALL GJA$SEND_MSG(RSP$,PINCRW(GJA$PARAMS.DAT$,SIZEW(KL$MES))->BUFFER
             26036                            ,

  26036   2 000C05  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 000C07  CCC5 0006                            LDB,B4   6,B5
          2 000C09  D845 0008                            LDR,R5   8,B5
          2 000C0B  5EFE                                 ADV,R5   -2
          2 000C0C  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000C0E  BB80 0000 0001  03                   LAB,B3   +1
          2 000C11  BFC7 011B                            STB,B3   SUBSUB$+9,AUTO
          2 000C13  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000C15  AFC7 0119                            STB,B2   SUBSUB$+7,AUTO
          2 000C17  9BC4 0001                            LAB,B1   1,B4
          2 000C19  9FC7 0117                            STB,B1   SUBSUB$+5,AUTO
          2 000C1B  CBC7 0035                            LAB,B4   RSP$,AUTO
          2 000C1D  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:357  
          2 000C1F  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000C21  CBF0 0400                            LAB,B4   1024,IMO
          2 000C23  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000C26       0001                            DC       s:26038,PREL

     1908    26037    4                     GJA$PARAMS.DATSIZE-SIZEC(KL$MES),%VFC_TRANSITION0);
     1909    26038    4                   GJA_VDO_DAT_DAT2.FNC = %KV_VDO_FNC_DAT;

  26038   2 000C27  6C05                                 LDV,R6   5
          2 000C28  E780 0000 0000  xsym                 STH,R6   GJA_VDO_DAT_DAT2

     1910    26039    4                   END;

     1911    26040    3              RSP$ = RSP$->GJA$LGNCTX.LNK$;

  26040   2 000C2B  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 000C2D  DCC6 0001                            LDB,B5   1,B6
          2 000C2F  DFC7 0035                            STB,B5   RSP$,AUTO

     1912    26041    3              END;

  26041   2 000C31  8DC7 0035                            CMN      RSP$,AUTO
          2 000C33  0981 FFB8                            BNE      s:26032,PREL
          2 000C35  0F81 131B                            B        s:27128,PREL

     1913    26042
     1914    26043
     1915    26044    2       CASE(IGA_HOSTNA);

     1916    26045              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_NOHOST$);

  26046   2 000C37  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000C39  E844 000D                            LDR,R6   13,B4
          2 000C3B  E570 00FF                            AND,R6   255,IMO
          2 000C3D  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000C40  0901 0004                            BE       s:26047,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:358  
  26046   2 000C42  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  26047   2 000C45  8D80 0000 0000  xsym                 CMN      GJA_MSG_NOHOST$
          2 000C48  0901 001A                            BE       s:26049,PREL

  26048   2 000C4A  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_NOHOST$
          2 000C4D  D283                                 LLH,R5   ,B3
          2 000C4E  5E02                                 ADV,R5   2
          2 000C4F  5041                                 SOR,R5   1
          2 000C50  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000C52  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_NOHOST$
          2 000C55  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000C57  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000C59  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000C5B  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000C5D  CBF0 0200                            LAB,B4   512,IMO
          2 000C5F  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000C62       0001                            DC       s:26049,PREL

  26049   2 000C63  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000C65  E846 0008                            LDR,R6   8,B6
          2 000C67  6041                                 SOR,R6   1
          2 000C68  EF47 0034                            STR,R6   SIZE,AUTO

  26050   2 000C6A  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_NOHOST$
          2 000C6D  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000C6F  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000C71  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000C73  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000C75  CBF0 0200                            LAB,B4   512,IMO
          2 000C77  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000C7A       0001                            DC       s:26051,PREL

  26051   2 000C7B  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000C7D  E846 0008                            LDR,R6   8,B6
          2 000C7F  6EFE                                 ADV,R6   -2
          2 000C80  EF47 0034                            STR,R6   SIZE,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:359  

  26052   2 000C82  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_NOHOST$
          2 000C85  E785                                 STH,R6   ,B5

  26053   2 000C86  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_NOHOST$
          2 000C89  E285                                 LLH,R6   ,B5
          2 000C8A  CCC6 0006                            LDB,B4   6,B6
          2 000C8C  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000C8E  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000C90  AB84                                 LAB,B2   ,B4
          2 000C91  2C02                                 LDV,R2   2
          2 000C92  E870 03E7                            LDR,R6   999,IMO
          2 000C94  BB85                                 LAB,B3   ,B5
          2 000C95  3C01                                 LDV,R3   1
          2 000C96  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000C98  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000C9B  0F81 12B5                            B        s:27128,PREL

     1917    26055        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:360  
     1918    26056    2       CASE (IGA_SGSYN);

     1919    26057              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_SGSYN$);

  26058   2 000C9D  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000C9F  E844 000D                            LDR,R6   13,B4
          2 000CA1  E570 00FF                            AND,R6   255,IMO
          2 000CA3  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000CA6  0901 0004                            BE       s:26059,PREL

  26058   2 000CA8  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  26059   2 000CAB  8D80 0000 0000  xsym                 CMN      GJA_MSG_SGSYN$
          2 000CAE  0901 001A                            BE       s:26061,PREL

  26060   2 000CB0  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_SGSYN$
          2 000CB3  D283                                 LLH,R5   ,B3
          2 000CB4  5E02                                 ADV,R5   2
          2 000CB5  5041                                 SOR,R5   1
          2 000CB6  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000CB8  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_SGSYN$
          2 000CBB  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000CBD  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000CBF  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000CC1  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000CC3  CBF0 0200                            LAB,B4   512,IMO
          2 000CC5  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000CC8       0001                            DC       s:26061,PREL

  26061   2 000CC9  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000CCB  E846 0008                            LDR,R6   8,B6
          2 000CCD  6041                                 SOR,R6   1
          2 000CCE  EF47 0034                            STR,R6   SIZE,AUTO

  26062   2 000CD0  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_SGSYN$
          2 000CD3  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000CD5  CBC7 0034                            LAB,B4   SIZE,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:361  
          2 000CD7  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000CD9  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000CDB  CBF0 0200                            LAB,B4   512,IMO
          2 000CDD  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000CE0       0001                            DC       s:26063,PREL

  26063   2 000CE1  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000CE3  E846 0008                            LDR,R6   8,B6
          2 000CE5  6EFE                                 ADV,R6   -2
          2 000CE6  EF47 0034                            STR,R6   SIZE,AUTO

  26064   2 000CE8  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_SGSYN$
          2 000CEB  E785                                 STH,R6   ,B5

  26065   2 000CEC  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_SGSYN$
          2 000CEF  E285                                 LLH,R6   ,B5
          2 000CF0  CCC6 0006                            LDB,B4   6,B6
          2 000CF2  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000CF4  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000CF6  AB84                                 LAB,B2   ,B4
          2 000CF7  2C02                                 LDV,R2   2
          2 000CF8  E870 03E7                            LDR,R6   999,IMO
          2 000CFA  BB85                                 LAB,B3   ,B5
          2 000CFB  3C01                                 LDV,R3   1
          2 000CFC  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000CFE  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000D01  0F81 124F                            B        s:27128,PREL

     1920    26067    2       CASE (IGA_UDHOST);

     1921    26068              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_UDHOST$);

  26069   2 000D03  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000D05  E844 000D                            LDR,R6   13,B4
          2 000D07  E570 00FF                            AND,R6   255,IMO
          2 000D09  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000D0C  0901 0004                            BE       s:26070,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:362  

  26069   2 000D0E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  26070   2 000D11  8D80 0000 0000  xsym                 CMN      GJA_MSG_UDHOST$
          2 000D14  0901 001A                            BE       s:26072,PREL

  26071   2 000D16  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_UDHOST$
          2 000D19  D283                                 LLH,R5   ,B3
          2 000D1A  5E02                                 ADV,R5   2
          2 000D1B  5041                                 SOR,R5   1
          2 000D1C  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000D1E  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_UDHOST$
          2 000D21  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000D23  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000D25  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000D27  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000D29  CBF0 0200                            LAB,B4   512,IMO
          2 000D2B  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000D2E       0001                            DC       s:26072,PREL

  26072   2 000D2F  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000D31  E846 0008                            LDR,R6   8,B6
          2 000D33  6041                                 SOR,R6   1
          2 000D34  EF47 0034                            STR,R6   SIZE,AUTO

  26073   2 000D36  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_UDHOST$
          2 000D39  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000D3B  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000D3D  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000D3F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000D41  CBF0 0200                            LAB,B4   512,IMO
          2 000D43  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000D46       0001                            DC       s:26074,PREL

  26074   2 000D47  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000D49  E846 0008                            LDR,R6   8,B6
          2 000D4B  6EFE                                 ADV,R6   -2
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:363  
          2 000D4C  EF47 0034                            STR,R6   SIZE,AUTO

  26075   2 000D4E  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_UDHOST$
          2 000D51  E785                                 STH,R6   ,B5

  26076   2 000D52  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_UDHOST$
          2 000D55  E285                                 LLH,R6   ,B5
          2 000D56  CCC6 0006                            LDB,B4   6,B6
          2 000D58  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000D5A  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000D5C  AB84                                 LAB,B2   ,B4
          2 000D5D  2C02                                 LDV,R2   2
          2 000D5E  E870 03E7                            LDR,R6   999,IMO
          2 000D60  BB85                                 LAB,B3   ,B5
          2 000D61  3C01                                 LDV,R3   1
          2 000D62  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000D64  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000D67  0F81 11E9                            B        s:27128,PREL

     1922    26078    2       CASE (IGA_BDID);

     1923    26079              %EXTRACT_MESSAGE(DESTPTR=GJA_MSG_BDID$);

  26080   2 000D69  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 000D6B  E844 000D                            LDR,R6   13,B4
          2 000D6D  E570 00FF                            AND,R6   255,IMO
          2 000D6F  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 000D72  0901 0004                            BE       s:26081,PREL

  26080   2 000D74  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  26081   2 000D77  8D80 0000 0000  xsym                 CMN      GJA_MSG_BDID$
          2 000D7A  0901 001A                            BE       s:26083,PREL

  26082   2 000D7C  BC80 0000 0000  xsym                 LDB,B3   GJA_MSG_BDID$
          2 000D7F  D283                                 LLH,R5   ,B3
          2 000D80  5E02                                 ADV,R5   2
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:364  
          2 000D81  5041                                 SOR,R5   1
          2 000D82  DF47 0114                            STR,R5   SUBSUB$+2,AUTO
          2 000D84  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_BDID$
          2 000D87  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 000D89  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000D8B  AFC7 0115                            STB,B2   SUBSUB$+3,AUTO
          2 000D8D  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000D8F  CBF0 0200                            LAB,B4   512,IMO
          2 000D91  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 000D94       0001                            DC       s:26083,PREL

  26083   2 000D95  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000D97  E846 0008                            LDR,R6   8,B6
          2 000D99  6041                                 SOR,R6   1
          2 000D9A  EF47 0034                            STR,R6   SIZE,AUTO

  26084   2 000D9C  DB80 0000 0000  xsym                 LAB,B5   GJA_MSG_BDID$
          2 000D9F  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000DA1  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000DA3  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000DA5  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000DA7  CBF0 0200                            LAB,B4   512,IMO
          2 000DA9  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000DAC       0001                            DC       s:26085,PREL

  26085   2 000DAD  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000DAF  E846 0008                            LDR,R6   8,B6
          2 000DB1  6EFE                                 ADV,R6   -2
          2 000DB2  EF47 0034                            STR,R6   SIZE,AUTO

  26086   2 000DB4  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_BDID$
          2 000DB7  E785                                 STH,R6   ,B5

  26087   2 000DB8  DC80 0000 0000  xsym                 LDB,B5   GJA_MSG_BDID$
          2 000DBB  E285                                 LLH,R6   ,B5
          2 000DBC  CCC6 0006                            LDB,B4   6,B6
          2 000DBE  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:365  
          2 000DC0  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 000DC2  AB84                                 LAB,B2   ,B4
          2 000DC3  2C02                                 LDV,R2   2
          2 000DC4  E870 03E7                            LDR,R6   999,IMO
          2 000DC6  BB85                                 LAB,B3   ,B5
          2 000DC7  3C01                                 LDV,R3   1
          2 000DC8  F847 0114                            LDR,R7   SUBSUB$+2,AUTO
          2 000DCA  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
          2 000DCD  0F81 1183                            B        s:27128,PREL

     1924    26089        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:366  
     1925    26090    2       CASE (IGA_NODETBL);

     1926    26091    2         IF KL$SETNODE.INVALID = '0'B THEN

  26091   2 000DCF  82C5 0001                            LB,'0020'X        1,B5
  26091   2 000DD1       0020
          2 000DD2  0501 003F                            BBT      s:26105,PREL

     1927    26092    3         DO;

     1928    26093    3              IF KL$SETNODE.NODE# > 255 THEN

  26093   2 000DD4  8CC5 0002                            LDI      2,B5
          2 000DD6  84F0 0000 00FF                       SID      255,IMO
          2 000DD9  6981 0003                            BNEZ,R6  s:26093+9,PREL
          2 000DDB  7901 0003                            BEZ,R7   s:26095,PREL
          2 000DDD  0601 0032                            BCT      s:26102,PREL

     1929    26094    3                   EXIT;
     1930    26095    3              IF KL$SETNODE.NODE# > GJA$NODETBL.NODE# THEN

  26095   2 000DDF  F800 0000 0000  xsym                 LDR,R7   GJA$NODETBL
          2 000DE2  6C00                                 LDV,R6   0
          2 000DE3  84C5 0002                            SID      2,B5
          2 000DE5  0601 0006                            BCT      s:26097,PREL

     1931    26096    3                   GJA$NODETBL.NODE# = KL$SETNODE.NODE#;

  26096   2 000DE7  E845 0003                            LDR,R6   3,B5
          2 000DE9  EF00 0000 0000  xsym                 STR,R6   GJA$NODETBL

     1932    26097    3              GJA$NODETBL.NODE.NODE(KL$SETNODE.NODE#) = KL$SETNODE.NODE_NAME;

  26097   2 000DEC  8CC5 0002                            LDI      2,B5
          2 000DEE  B857                                 LDR,R3   R7
          2 000DEF  AB85                                 LAB,B2   ,B5
          2 000DF0  2C08                                 LDV,R2   8
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:367  
          2 000DF1  6C08                                 LDV,R6   8
          2 000DF2  BB80 0000 0000  xsym                 LAB,B3   GJA$NODETBL
          2 000DF5  3F0A                                 MLV,R3   10
          2 000DF6  3E04                                 ADV,R3   4
          2 000DF7  0008                                 MMM

     1933    26098    3              IF KL$SETNODE.HOST_NODE THEN

  26098   2 000DF8  CCC6 0006                            LDB,B4   6,B6
          2 000DFA  82C4 0001                            LB,'0040'X        1,B4
          2 000DFC       0040
          2 000DFD  0581 000B                            BBF      s:26101,PREL

     1934    26099    3                   GJA$NODETBL.NODE.HOST(KL$SETNODE.NODE#) = 1;

  26099   2 000DFF  8CC4 0002                            LDI      2,B4
          2 000E01  B857                                 LDR,R3   R7
          2 000E02  3F05                                 MLV,R3   5
          2 000E03  6C01                                 LDV,R6   1
          2 000E04  EF30 0000 0001  xsym                 STR,R6   GJA$NODETBL+1,R3
          2 000E07  0F81 1149                            B        s:27128,PREL

     1935    26100    3              ELSE
     1936    26101    3                   GJA$NODETBL.NODE.HOST(KL$SETNODE.NODE#) = 0;

  26101   2 000E09  8CC4 0002                            LDI      2,B4
          2 000E0B  B857                                 LDR,R3   R7
          2 000E0C  3F05                                 MLV,R3   5
          2 000E0D  8730 0000 0001  xsym                 CL       GJA$NODETBL+1,R3

     1937    26102    3              END;

  26102   2 000E10  0F81 1140                            B        s:27128,PREL

     1938    26103    3         ELSE DO;

     1939    26104                                           /* slug could not read :NETCON   */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:368  
     1940    26105    3              END;

  26105   2 000E12  0F81 113E                            B        s:27128,PREL

     1941    26106
     1942    26107        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:369  
     1943    26108    2       CASE (IGA_RUE);

     1944    26109    2         FPT_RUE.V.USER = KL$RUE.SYSID;

  26109   2 000E14  E845 0011                            LDR,R6   17,B5
          2 000E16  EF00 0000 0009  00                   STR,R6   FPT_RUE+3

     1945    26110    2         FPT_RUE.V.EVENT = KL$RUE.EVENT#;

  26110   2 000E19  DCC6 0006                            LDB,B5   6,B6
          2 000E1B  D2C5 0012                            LLH,R5   18,B5
          2 000E1D  D780 0000 000A  00                   STH,R5   FPT_RUE+4

     1946    26111    2         CALL M$RUE (FPT_RUE)

  26111   2 000E20  BB80 0000 0006  00                   LAB,B3   FPT_RUE
          2 000E23  B870 04D7                            LDR,R3   1239,IMO
          2 000E25  0001                                 MCL
          2 000E26       0003                            DC       s:26113,PREL
          2 000E27  0F81 000D                            B        s:26115,PREL

     1947    26112    3         WHENALTRETURN DO;

     1948    26113    3              KL$RUE.RESULTS = G$TCB$->G$TCB.ALT$->G$EXCFR.TRLR.ERR;

  26113   2 000E29  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000E2B  DCC6 0006                            LDB,B5   6,B6
          2 000E2D  CC80 0000 0000  xsym                 LDB,B4   G$TCB$
          2 000E30  BC84                                 LDB,B3   ,B4
          2 000E31  8CC3 002B                            LDI      43,B3
          2 000E33  8D45 000E                            SDI      14,B5

     1949    26114    3              END;

     1950    26115    2         CALL GJA$SEND_MSG(MSGCTX$,KL$RUE,GJA$PARAMS.DATSIZE);

  26115   2 000E35  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:370  
          2 000E37  DCC6 0006                            LDB,B5   6,B6
          2 000E39  CBC6 0008                            LAB,B4   8,B6
          2 000E3B  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 000E3D  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000E3F  BCC7 0006                            LDB,B3   @MSGCTX$,AUTO
          2 000E41  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 000E43  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000E45  CBF0 0300                            LAB,B4   768,IMO
          2 000E47  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000E4A       0001                            DC       s:26115+22,PREL
          2 000E4B  0F81 1105                            B        s:27128,PREL

     1951    26116
     1952    26117        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:371  
     1953    26118    2       CASE(IGA_STRTU);                    /* START USER               */

     1954    26119    2         FPT_MAKEUSR.STRTU=VECTOR(KL_STRTU);

  26119   2 000E4D  DFC7 0115                            STB,B5   SUBSUB$+3,AUTO
          2 000E4F  E870 00B3                            LDR,R6   179,IMO
          2 000E51  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000E53  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000E55  2C00                                 LDV,R2   0
          2 000E56  6C06                                 LDV,R6   6
          2 000E57  BB80 0000 0000  00                   LAB,B3   FPT_AFD
          2 000E5A  3C06                                 LDV,R3   6
          2 000E5B  0008                                 MMM

     1955    26120    2         CALL M$MAKEUSR(FPT_MAKEUSR)

  26120   2 000E5C  BB80 0000 0003  00                   LAB,B3   FPT_MAKEUSR
          2 000E5F  B870 04C7                            LDR,R3   1223,IMO
          2 000E61  0001                                 MCL
          2 000E62       0003                            DC       s:26122,PREL
          2 000E63  0F81 0039                            B        s:26129,PREL

     1956    26121    3         WHENALTRETURN DO;

     1957    26122    3              RSP$=ADDR(VDO_BUFFER);

  26122   2 000E65  EB80 0000 0040  00                   LAB,B6   VDO_BUFFER
          2 000E68  EFC7 0035                            STB,B6   RSP$,AUTO

     1958    26123    3              KL$CWNAK='0'B;

  26123   2 000E6A  5C0C                                 LDV,R5   12
          2 000E6B  0021                                 ALR      ;
          2 000E6C       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 000E6E       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

     1959    26124    3              KL$CWNAK.NETADR=KL_STRTU.NETADR_FROM;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:372  

  26124   2 000E70  437F                                 CSYNC    s:26123+5,SPREL
          2 000E71  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000E73  DCC6 0006                            LDB,B5   6,B6
          2 000E75  8CC5 0001                            LDI      1,B5
          2 000E77  CCC7 0035                            LDB,B4   RSP$,AUTO
          2 000E79  8D44 0001                            SDI      1,B4

  26124   2                              CWNAK           null
     1960    26125    3   CWNAK:     ;
     1961    26126    3              KL$CWNAK.FCN=IGA_CWNAK;

  26126   2 000E7B  6C1C                 CWNAK           LDV,R6   28
          2 000E7C  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 000E7E  E786                                 STH,R6   ,B6

     1962    26127    3              KL$CWNAK.NETERR.ERR.L6=G$TCB$->G$TCB.ALT$->G$EXCFR.TRLR.ERR;

  26127   2 000E7F  EC80 0000 0000  xsym                 LDB,B6   G$TCB$
          2 000E82  DC86                                 LDB,B5   ,B6
          2 000E83  8CC5 002B                            LDI      43,B5
          2 000E85  CCC7 0035                            LDB,B4   RSP$,AUTO
          2 000E87  8D44 0004                            SDI      4,B4

     1963    26128    3              CALL GJA$SEND_MSG(UID$,KL$CWNAK,SIZEC(KL$CWNAK));

  26128   2 000E89  DBF0 000C                            LAB,B5   12,IMO
          2 000E8B  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 000E8D  CCC7 0035                            LDB,B4   RSP$,AUTO
          2 000E8F  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 000E91  BBC7 001B                            LAB,B3   UID,AUTO
          2 000E93  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 000E95  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000E97  CBF0 0300                            LAB,B4   768,IMO
          2 000E99  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000E9C       0001                            DC       s:26129,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:373  
     1964    26129    3              END;

  26129   2 000E9D  0F81 10B3                            B        s:27128,PREL

     1965    26130
     1966    26131        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:374  
     1967    26132    2       CASE(IGA_AFD);                 /* ASSOCIATE FRONT-END DEBUGGER  */

     1968    26133    2         FPT_AFD.AFD=VECTOR(KL$AFD);

  26133   2 000E9F  DFC7 0115                            STB,B5   SUBSUB$+3,AUTO
          2 000EA1  6C0F                                 LDV,R6   15
          2 000EA2  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000EA4  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 000EA6  2C00                                 LDV,R2   0
          2 000EA7  6C06                                 LDV,R6   6
          2 000EA8  BB80 0000 0000  00                   LAB,B3   FPT_AFD
          2 000EAB  3C00                                 LDV,R3   0
          2 000EAC  0008                                 MMM

     1969    26134    2         CALL M$AFD(FPT_AFD)

  26134   2 000EAD  BB80 0000 0000  00                   LAB,B3   FPT_AFD
          2 000EB0  B870 04D1                            LDR,R3   1233,IMO
          2 000EB2  0001                                 MCL
          2 000EB3       0003                            DC       s:26136,PREL
          2 000EB4  0F81 0019                            B        s:26139+2,PREL

     1970    26135    3         WHENALTRETURN DO;

     1971    26136    3              RSP$=ADDR(VDO_BUFFER);

  26136   2 000EB6  EB80 0000 0040  00                   LAB,B6   VDO_BUFFER
          2 000EB9  EFC7 0035                            STB,B6   RSP$,AUTO

     1972    26137    3              KL$CWNAK='0'B;

  26137   2 000EBB  5C0C                                 LDV,R5   12
          2 000EBC  0021                                 ALR      ;
          2 000EBD       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 000EBF       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

     1973    26138    3              KL$CWNAK.NETADR=KL$AFD.NETADR_FROM;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:375  

  26138   2 000EC1  437F                                 CSYNC    s:26137+5,SPREL
          2 000EC2  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000EC4  DCC6 0006                            LDB,B5   6,B6
          2 000EC6  8CC5 0001                            LDI      1,B5
          2 000EC8  CCC7 0035                            LDB,B4   RSP$,AUTO
          2 000ECA  8D44 0001                            SDI      1,B4

     1974    26139    3              GOTO CWNAK;

  26139   2 000ECC  0F81 FFAE                            B        s:26124,PREL
          2 000ECE  0F81 1082                            B        s:27128,PREL

     1975    26140    3              END;
     1976    26141        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:376  
     1977    26142    2       CASE(IGA_SGN);

     1978    26143    2         IF WHO = %GJA_UID_BABOON

  26143   2 000ED0  E847 0026                            LDR,R6   WHO,AUTO
          2 000ED2  6D02                                 CMV,R6   2
          2 000ED3  0981 008C                            BNE      s:26168,PREL

     1979    26144    3         THEN DO;

     1980    26145    3              SIZE = SIZEW(CTX$->GJA$LGNCTX);

  26145   2 000ED5  5C21                                 LDV,R5   33
          2 000ED6  DF47 0034                            STR,R5   SIZE,AUTO

     1981    26146    3              CALL KVB$GETSYS(SIZE,CTX$);

  26146   2 000ED8  DBC7 0019                            LAB,B5   CTX$,AUTO
          2 000EDA  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000EDC  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 000EDE  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 000EE0  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000EE2  CBF0 0200                            LAB,B4   512,IMO
          2 000EE4  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000EE7       0001                            DC       s:26147,PREL

     1982    26147    3              CTX$->GJA$LGNCTX = '0'B;

  26147   2 000EE8  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 000EEA  5C42                                 LDV,R5   66
          2 000EEB  0021                                 ALR      ;
          2 000EEC       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 000EEE       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

     1983    26148    3              CTX$->GJA$LGNCTX.USER.SYSID = KL$SGN.NMID;

  26148   2 000EF0  437F                                 CSYNC    s:26147+7,SPREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:377  
          2 000EF1  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000EF3  DCC6 0006                            LDB,B5   6,B6
          2 000EF5  AB85                                 LAB,B2   ,B5
          2 000EF6  2C19                                 LDV,R2   25
          2 000EF7  6C02                                 LDV,R6   2
          2 000EF8  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 000EFA  3C1C                                 LDV,R3   28
          2 000EFB  0008                                 MMM

     1984    26149    3              CTX$->GJA$LGNCTX.NODE = KL$SGN.NODE;

  26149   2 000EFC  CCC6 0006                            LDB,B4   6,B6
          2 000EFE  E804                                 LDR,R6   ,B4
          2 000EFF  E570 00FF                            AND,R6   255,IMO
          2 000F01  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 000F03  E7C3 0017                            STH,R6   23,B3

     1985    26150    3              CTX$->GJA$LGNCTX.TERMINAL_ID = KL$SGN.TERMINAL_ID;

  26150   2 000F05  CCC6 0006                            LDB,B4   6,B6
          2 000F07  AB84                                 LAB,B2   ,B4
          2 000F08  2C04                                 LDV,R2   4
          2 000F09  6C10                                 LDV,R6   16
          2 000F0A  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 000F0C  3C1E                                 LDV,R3   30
          2 000F0D  0008                                 MMM

     1986    26151    3              CTX$->GJA$LGNCTX.LDCTX = GJA_LDCT_BABOON;

  26151   2 000F0E  E800 0000 0000  xsym                 LDR,R6   GJA_LDCT_BABOON
          2 000F11  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 000F13  EA83                                 SRM,R6,'1FFF'X    ,B3
          2 000F14       1FFF

     1987    26152    3              CTX$->GJA$LGNCTX.WHO = %GJA_UID_BABOON;

  26152   2 000F15  E870 4000                            LDR,R6   16384,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:378  
          2 000F17  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 000F19  EA83                                 SRM,R6,'E000'X    ,B3
          2 000F1A       E000

     1988    26153    3              IF GJA_USRLGN_HEAD$ = ADDR(NIL)

  26153   2 000F1B  8D80 0000 0000  xsym                 CMN      GJA_USRLGN_HEAD$
          2 000F1E  0981 0008                            BNE      s:26156,PREL

     1989    26154    3              THEN GJA_USRLGN_HEAD$ = CTX$;

  26154   2 000F20  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 000F22  BF80 0000 0000  xsym                 STB,B3   GJA_USRLGN_HEAD$
          2 000F25  0F81 000D                            B        s:26159,PREL

     1990    26155    4              ELSE DO;

     1991    26156    4                   CTX$->GJA$LGNCTX.LNK$ = GJA_USRLGN_HEAD$;

  26156   2 000F27  BC80 0000 0000  xsym                 LDB,B3   GJA_USRLGN_HEAD$
          2 000F2A  9CC7 0019                            LDB,B1   CTX$,AUTO
          2 000F2C  BFC1 0001                            STB,B3   1,B1

     1992    26157    4                   GJA_USRLGN_HEAD$ = CTX$;

  26157   2 000F2E  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 000F30  BF80 0000 0000  xsym                 STB,B3   GJA_USRLGN_HEAD$

     1993    26158    4                   END;

     1994    26159    3              KL$SGN.NMID = CTX;

  26159   2 000F33  9CC6 0006                            LDB,B1   6,B6
          2 000F35  AB87                                 LAB,B2   ,AUTO
          2 000F36  2C32                                 LDV,R2   50
          2 000F37  6C04                                 LDV,R6   4
          2 000F38  BB81                                 LAB,B3   ,B1
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:379  
          2 000F39  3C17                                 LDV,R3   23
          2 000F3A  0008                                 MMM

     1995    26160    4              CALL GJA$NETWORK_MANAGER(KL$SGN,SIZEC(KL$SGN)+KL$SGN.LOGON.LGNSIZ)
             26160                       WHENRETURN DO;

  26160   2 000F3B  DCC6 0006                            LDB,B5   6,B6
          2 000F3D  E845 000E                            LDR,R6   14,B5
          2 000F3F  E570 00FF                            AND,R6   255,IMO
          2 000F41  6E20                                 ADV,R6   32
          2 000F42  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 000F44  EBC7 0114                            LAB,B6   SUBSUB$+2,AUTO
          2 000F46  EFC7 0117                            STB,B6   SUBSUB$+5,AUTO
          2 000F48  DFC7 0115                            STB,B5   SUBSUB$+3,AUTO
          2 000F4A  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 000F4C  CBF0 0200                            LAB,B4   512,IMO
          2 000F4E  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 000F51       0008                            DC       s:26164,PREL

     1996    26161    4                   CTX$->GJA$LGNCTX.STATUS.NMRSP = '1'B;

  26161   2 000F52  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 000F54  8946 0018                            LBT,'2000'X       24,B6
          2 000F56       2000

     1997    26162    4                   END;

  26162   2 000F57  0F81 0006                            B        s:26166,PREL

     1998    26163    4              WHENALTRETURN DO;

     1999    26164    4                   CTX$->GJA$LGNCTX.STATUS.NMRSP = '0'B;

  26164   2 000F59  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 000F5B  8846 0018                            LBF,'2000'X       24,B6
          2 000F5D       2000

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:380  
     2000    26165    4                   END;

     2001    26166    3              END;

  26166   2 000F5E  0F81 0FF2                            B        s:27128,PREL

     2002    26167    3         ELSE DO;           /* This is a return sign on, forward it    */

     2003    26168    3              ROUTE$ = KNN$ROUTE$(KL$SGN.NODE);

  26168   2 000F60  9805                                 LDR,R1   ,B5
          2 000F61  9570 00FF                            AND,R1   255,IMO
          2 000F63  CC80 0000 0000  xsym                 LDB,B4   GJA_ROUTE$
          2 000F66  BC94                                 LDB,B3   ,B4,R1
          2 000F67  BFC7 000F                            STB,B3   ROUTE$,AUTO

     2004    26169    3              CTX$ = KNN$ROUTE.CTX$;

  26169   2 000F69  ACC3 0002                            LDB,B2   2,B3
          2 000F6B  AFC7 0019                            STB,B2   CTX$,AUTO

     2005    26170    3              IF CTX$ = ADDR(NIL) OR CTX$->GJA$HAND_CTX.LDCTX = 0

  26170   2 000F6D  8DC7 0019                            CMN      CTX$,AUTO
          2 000F6F  0901 0005                            BE       s:26172,PREL
          2 000F71  8282                                 LB,'1FFF'X        ,B2
          2 000F72       1FFF
          2 000F73  0501 0030                            BBT      s:26182,PREL

     2006    26171    4              THEN DO;

     2007    26172    4                   SGNRSP.FCN = IGA_SGNRSP;

  26172   2 000F75  5C40                                 LDV,R5   64
          2 000F76  D7C7 006B                            STH,R5   SGNRSP,AUTO

     2008    26173    4                   SGNRSP.NMID = KL$SGN.NMID;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:381  

  26173   2 000F78  DCC6 0006                            LDB,B5   6,B6
          2 000F7A  5C04                                 LDV,R5   4
          2 000F7B  0021                                 ALR      ;
          2 000F7C       C405 000B                                ALPHANUM(11,B5,1,4),;
          2 000F7E       4007 0114                                ALPHANUM(SUBSUB$+2,AUTO,,R5,FILL)
          2 000F80  437F                                 CSYNC    s:26173+7,SPREL
          2 000F81  8CC7 0114                            LDI      SUBSUB$+2,AUTO
          2 000F83  8D47 006C                            SDI      SGNRSP+1,AUTO

     2009    26174    4                   SGNRSP.ERRCODE = E$NONETMAN;

  26174   2 000F85  8C80 0000 0000  01                   LDI      E$NONETMAN
          2 000F88  8D47 0070                            SDI      SGNRSP+5,AUTO

     2010    26175    4                   GJA$PARAMS.DAT$ = ADDR(SGNRSP);

  26175   2 000F8A  DBC7 006B                            LAB,B5   SGNRSP,AUTO
          2 000F8C  DFC6 0006                            STB,B5   6,B6

     2011    26176    4                   GJA$PARAMS.DATSIZE = SIZEC(SGNRSP);

  26176   2 000F8E  4C52                                 LDV,R4   82
          2 000F8F  CF46 0008                            STR,R4   8,B6

     2012    26177    4                   SGNRSP.MESSAGE.RSPSIZ = GJA_MSG_NOHOST$->TEXTC_STRING.SIZE;

  26177   2 000F91  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_NOHOST$
          2 000F94  B282                                 LLH,R3   ,B2
          2 000F95  BAC7 007A                            SRM,R3,'00FF'X    SGNRSP+15,AUTO
          2 000F97       00FF

     2013    26178    4                  SGNRSP.MESSAGE.RSPTXT = SUBSTR(GJA_MSG_NOHOST$->TEXTC_STRING.STRING,
             26178                            0,GJA_MSG_NOHOST$->TEXTC_STRING.SIZE);

  26178   2 000F98  B282                                 LLH,R3   ,B2
          2 000F99  C853                                 LDR,R4   R3
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:382  
          2 000F9A  D870 2032                            LDR,R5   8242,IMO
          2 000F9C  0021                                 ALR      ;
          2 000F9D       C002 0000                                ALPHANUM(0,B2,1,R4),;
          2 000F9F       4007 007B                                ALPHANUM(SGNRSP+16,AUTO,,R5,FILL)

     2014    26179    4                   GOTO SGNRSP;

  26179   2 000FA1  437F                                 CSYNC    s:26178+8,SPREL
          2 000FA2  0F81 004D                            B        s:26198,PREL

     2015    26180    4                   END;
     2016    26181    4              ELSE DO;

     2017    26182    4                   NMID=KL$SGN.NMID;

  26182   2 000FA4  DCC6 0006                            LDB,B5   6,B6
          2 000FA6  AB85                                 LAB,B2   ,B5
          2 000FA7  2C17                                 LDV,R2   23
          2 000FA8  6C04                                 LDV,R6   4
          2 000FA9  BB87                                 LAB,B3   ,AUTO
          2 000FAA  3C5A                                 LDV,R3   90
          2 000FAB  0008                                 MMM

     2018    26183    4                   RSP$=GJA_USRLGN_HEAD$;

  26183   2 000FAC  CC80 0000 0000  xsym                 LDB,B4   GJA_USRLGN_HEAD$
          2 000FAF  CFC7 0035                            STB,B4   RSP$,AUTO

     2019    26184    5                   DO WHILE (RSP$ ~= ADDR(NIL));

  26184   2 000FB1  0F81 000B                            B        s:26188,PREL

     2020    26185    5                        IF RSP$=NMID$

  26185   2 000FB3  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 000FB5  EDC7 002D                            CMB,B6   NMID$,AUTO
          2 000FB7  0901 0008                            BE       s:26189,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:383  

     2021    26186    5                        THEN EXIT;
     2022    26187    5                        RSP$=RSP$->GJA$LGNCTX.LNK$;

  26187   2 000FB9  DCC6 0001                            LDB,B5   1,B6
          2 000FBB  DFC7 0035                            STB,B5   RSP$,AUTO

     2023    26188    5                        END;

  26188   2 000FBD  8DC7 0035                            CMN      RSP$,AUTO
          2 000FBF  09F4                                 BNE      s:26185,SPREL

     2024    26189    4                   IF RSP$ = ADDR(NIL)

  26189   2 000FC0  8DC7 0035                            CMN      RSP$,AUTO
          2 000FC2  0981 0005                            BNE      s:26191,PREL

     2025    26190    4                   THEN CALL M$XXX;

  26190   2 000FC4  B870 0082                            LDR,R3   130,IMO
          2 000FC6  0001                                 MCL
          2 000FC7       0000                            DC       s:26190+3,PREL

     2026    26191    4                   RSP$->GJA$LGNCTX.NM_NODE = KL$SGN.NODE;

  26191   2 000FC8  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 000FCA  DCC6 0006                            LDB,B5   6,B6
          2 000FCC  E805                                 LDR,R6   ,B5
          2 000FCD  E570 00FF                            AND,R6   255,IMO
          2 000FCF  CCC7 0035                            LDB,B4   RSP$,AUTO
          2 000FD1  E7C4 0009                            STH,R6   9,B4

     2027    26192    4                   KL$SGN.NODE = GJA_NODE#;

  26192   2 000FD3  DCC6 0006                            LDB,B5   6,B6
          2 000FD5  E800 0000 0000  xsym                 LDR,R6   GJA_NODE#
          2 000FD8  EA85                                 SRM,R6,'00FF'X    ,B5
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:384  
          2 000FD9       00FF

     2028    26193    4                   CALL GJA$SEND_MSG(CTX$,KL$SGN,GJA$PARAMS.DATSIZE);

  26193   2 000FDA  DCC6 0006                            LDB,B5   6,B6
          2 000FDC  CBC6 0008                            LAB,B4   8,B6
          2 000FDE  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 000FE0  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 000FE2  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 000FE4  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 000FE6  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 000FE8  CBF0 0300                            LAB,B4   768,IMO
          2 000FEA  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 000FED       0001                            DC       s:26195,PREL

     2029    26194    4                   END;

     2030    26195    3              END;

  26195   2 000FEE  0F81 0F62                            B        s:27128,PREL

     2031    26196
     2032    26197        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:385  
     2033    26198    2       CASE(IGA_SGNRSP);                   /* LOGON RESPONCE           */

  26195   2                              SGNRSP          null
     2034    26199    2   SGNRSP: ;
     2035    26200        /*
     2036    26201          This is a responce to a logon request made previously.  We need to
     2037    26202          run the GJA$LGNCTX chain to find the context clock that this
     2038    26203          signon refers to.  Once we find it, if the user has disconnected,
     2039    26204          we wind him down.  Otherwise, we set up the context block we
     2040    26205          found and call a routine to process the responce.
     2041    26206        */
     2042    26207    2         NMID=KL$SGNRSP.NMID;

  26207   2 000FF0  DCC6 0006            SGNRSP          LDB,B5   6,B6
          2 000FF2  8CC5 0001                            LDI      1,B5
          2 000FF4  8D47 002D                            SDI      NMID$,AUTO

     2043    26208    2         CTX$=GJA_USRLGN_HEAD$;

  26208   2 000FF6  CC80 0000 0000                       LDB,B4   0
          2 000FF9  CFC7 0019                            STB,B4   CTX$,AUTO

     2044    26209    3         DO WHILE (CTX$ ~= ADDR(NIL));

  26209   2 000FFB  0F81 000B                            B        s:26213,PREL

     2045    26210    3              IF CTX$=NMID$

  26210   2 000FFD  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 000FFF  EDC7 002D                            CMB,B6   NMID$,AUTO
          2 001001  0901 0008                            BE       s:26214,PREL

     2046    26211    3              THEN EXIT;
     2047    26212    3              CTX$=CTX$->GJA$LGNCTX.LNK$;

  26212   2 001003  DCC6 0001                            LDB,B5   1,B6
          2 001005  DFC7 0019                            STB,B5   CTX$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:386  

     2048    26213    3              END;

  26213   2 001007  8DC7 0019                            CMN      CTX$,AUTO
          2 001009  09F4                                 BNE      s:26210,SPREL

     2049    26214    2         IF CTX$ = ADDR(NIL)

  26214   2 00100A  8DC7 0019                            CMN      CTX$,AUTO
          2 00100C  0981 0005                            BNE      s:26217,PREL

     2050    26215    2         THEN CALL M$XXX;

  26215   2 00100E  B870 0082                            LDR,R3   130,IMO
          2 001010  0001                                 MCL
          2 001011       0000                            DC       s:26215+3,PREL

     2051    26216
     2052    26217    2        IF CTX$->GJA$LGNCTX.STATUS.TERMACK THEN RETURN; /* whoops, one slipped thru */

  26217   2 001012  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001014  82C6 0018                            LB,'1000'X        24,B6
          2 001016       1000
          2 001017  0581 0004                            BBF      s:26219,PREL

  26217   2 001019  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2053    26218                       /* If this CTX is from Baboon just forward it on     */
     2054    26219    2         IF CTX$->GJA$LGNCTX.LDCTX = GJA_LDCT_BABOON

  26219   2 00101C  E806                                 LDR,R6   ,B6
          2 00101D  E570 1FFF                            AND,R6   8191,IMO
          2 00101F  E900 0000 0000  xsym                 CMR,R6   GJA_LDCT_BABOON
          2 001022  0981 002D                            BNE      s:26227,PREL

     2055    26220    3         THEN DO;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:387  
     2056    26221    3              KL$SGNRSP.NMID = CTX$->GJA$LGNCTX.USER.SYSID;

  26221   2 001024  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 001026  CCC5 0006                            LDB,B4   6,B5
          2 001028  F846 000E                            LDR,R7   14,B6
          2 00102A  6C00                                 LDV,R6   0
          2 00102B  8D44 0001                            SDI      1,B4

     2057    26222    3              CALL GJA$Q_MSG(GJA_UID_BABOON,

  26222   2 00102D  ECC5 0006                            LDB,B6   6,B5
          2 00102F  CBF0 0022                            LAB,B4   34,IMO
          2 001031  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 001033  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001035  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 001038  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00103A  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00103C  CBF0 0300                            LAB,B4   768,IMO
          2 00103E  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 001041       0001                            DC       s:26224,PREL

     2058    26223    3                SIZEC(KL$SGNRSP),KL$SGNRSP);
     2059    26224    3              CALL GJA$DISOLVE_LGNUSR_CTX(CTX$);

  26224   2 001042  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 001044  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 001046  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001048  CBF0 0100                            LAB,B4   256,IMO
          2 00104A  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_LGNUSR_CTX
          2 00104D       0001                            DC       s:26225,PREL

     2060    26225    3              END;

  26225   2 00104E  0F81 0F02                            B        s:27128,PREL

     2061    26226    3         ELSE DO;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:388  
     2062    26227    3              CTX$->GJA$LGNCTX.MSG$=GJA$PARAMS.DAT$;

  26227   2 001050  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 001052  CCC5 0006                            LDB,B4   6,B5
          2 001054  CFC6 000C                            STB,B4   12,B6

     2063    26228    3              CALL GJA$LOGON_RESPONCE(CTX$);

  26228   2 001056  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 001058  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 00105A  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00105C  CBF0 0100                            LAB,B4   256,IMO
          2 00105E  E380 0000 0000  xent                 LNJ,B6   GJA$LOGON_RESPONCE
          2 001061       0001                            DC       s:26229,PREL

     2064    26229    3              END;

  26229   2 001062  0F81 0EEE                            B        s:27128,PREL

     2065    26230        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:389  
     2066    26231    2       CASE(IGA_ERRMSG_RQS);

     2067    26232
     2068    26233    2         SIZE = SIZEW(CTX$->GJA$ERRMSG_CTX);

  26233   2 001064  6C0A                                 LDV,R6   10
          2 001065  EF47 0034                            STR,R6   SIZE,AUTO

     2069    26234    2         CALL KVB$GET2NSYS(SIZE,CTX$);

  26234   2 001067  DBC7 0019                            LAB,B5   CTX$,AUTO
          2 001069  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00106B  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 00106D  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 00106F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001071  CBF0 0200                            LAB,B4   512,IMO
          2 001073  E380 0000 0000  xent                 LNJ,B6   KVB$GET2NSYS
          2 001076       0001                            DC       s:26236,PREL

     2070    26235
     2071    26236    2         CTX$->GJA$ERRMSG_CTX = '0'B;

  26236   2 001077  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001079  5C14                                 LDV,R5   20
          2 00107A  0021                                 ALR      ;
          2 00107B       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 00107D       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

     2072    26237    2         CTX$->GJA$ERRMSG_CTX.USR# = KL$ERRMSG_RQS.USR#;

  26237   2 00107F  437F                                 CSYNC    s:26236+7,SPREL
          2 001080  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001082  DCC6 0006                            LDB,B5   6,B6
          2 001084  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 001086  E805                                 LDR,R6   ,B5
          2 001087  EAC4 0009                            SRM,R6,'00FF'X    9,B4
          2 001089       00FF
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:390  

     2073    26238    2         CTX$->GJA$ERRMSG_CTX.LDCTX = GJA_LDCT_BABOON;

  26238   2 00108A  E800 0000 0000  xsym                 LDR,R6   GJA_LDCT_BABOON
          2 00108D  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 00108F  EA85                                 SRM,R6,'1FFF'X    ,B5
          2 001090       1FFF

     2074    26239    2         CTX$->GJA$ERRMSG_CTX.WHO = %GJA_UID_BABOON;

  26239   2 001091  E870 4000                            LDR,R6   16384,IMO
          2 001093  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 001095  EA85                                 SRM,R6,'E000'X    ,B5
          2 001096       E000

     2075    26240    2         CTX$->GJA$ERRMSG_CTX.NODE = GJA_DEFNODE;

  26240   2 001097  C800 0000 0000  xsym                 LDR,R4   GJA_DEFNODE
          2 00109A  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 00109C  C7C5 0009                            STH,R4   9,B5

     2076    26241
     2077    26242    2         IF GJA_ERRMSG_HEAD$ = ADDR(NIL)

  26242   2 00109E  8D80 0000 0000  xsym                 CMN      GJA_ERRMSG_HEAD$
          2 0010A1  0981 0008                            BNE      s:26245,PREL

     2078    26243    2         THEN GJA_ERRMSG_HEAD$ = CTX$;

  26243   2 0010A3  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 0010A5  DF80 0000 0000  xsym                 STB,B5   GJA_ERRMSG_HEAD$
          2 0010A8  0F81 000D                            B        s:26249,PREL

     2079    26244    3         ELSE DO;

     2080    26245    3              CTX$->GJA$ERRMSG_CTX.LNK$ = GJA_ERRMSG_HEAD$;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:391  
  26245   2 0010AA  DC80 0000 0000  xsym                 LDB,B5   GJA_ERRMSG_HEAD$
          2 0010AD  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0010AF  DFC4 0001                            STB,B5   1,B4

     2081    26246    3              GJA_ERRMSG_HEAD$ = CTX$;

  26246   2 0010B1  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 0010B3  DF80 0000 0000  xsym                 STB,B5   GJA_ERRMSG_HEAD$

     2082    26247    3              END;

     2083    26248
     2084    26249    2         KL$ERRMSG_RQS.CTX$ = CTX$;

  26249   2 0010B6  CCC6 0006                            LDB,B4   6,B6
          2 0010B8  DFC4 0002                            STB,B5   2,B4

     2085    26250    2         CALL GJA$NETWORK_MANAGER(KL$ERRMSG_RQS,SIZEC(KL$ERRMSG_RQS));

  26250   2 0010BA  CCC6 0006                            LDB,B4   6,B6
          2 0010BC  BBF0 003E                            LAB,B3   62,IMO
          2 0010BE  BFC7 0116                            STB,B3   SUBSUB$+4,AUTO
          2 0010C0  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0010C2  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0010C4  CBF0 0200                            LAB,B4   512,IMO
          2 0010C6  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 0010C9       0001                            DC       s:26250+16,PREL
          2 0010CA  0F81 0E86                            B        s:27128,PREL

     2086    26251
     2087    26252
     2088    26253        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:392  
     2089    26254    2       CASE(IGA_ERRMSG_RSP);

     2090    26255
     2091    26256    2         CTX$=GJA_ERRMSG_HEAD$;

  26256   2 0010CC  CC80 0000 0000  xsym                 LDB,B4   GJA_ERRMSG_HEAD$
          2 0010CF  CFC7 0019                            STB,B4   CTX$,AUTO

     2092    26257    3         DO WHILE (CTX$ ~= ADDR(NIL));

  26257   2 0010D1  0F81 000F                            B        s:26261,PREL

     2093    26258    3              IF CTX$ = KL$ERRMSG_RSP.CTX$

  26258   2 0010D3  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0010D5  DCC6 0006                            LDB,B5   6,B6
          2 0010D7  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0010D9  CDC5 0002                            CMB,B4   2,B5
          2 0010DB  0901 0008                            BE       s:26262,PREL

     2094    26259    3              THEN EXIT;
     2095    26260    3              CTX$ = CTX$->GJA$ERRMSG_CTX.LNK$;

  26260   2 0010DD  BCC4 0001                            LDB,B3   1,B4
          2 0010DF  BFC7 0019                            STB,B3   CTX$,AUTO

     2096    26261    3              END;

  26261   2 0010E1  8DC7 0019                            CMN      CTX$,AUTO
          2 0010E3  09F0                                 BNE      s:26258,SPREL

     2097    26262    2         IF CTX$ = ADDR(NIL)

  26262   2 0010E4  8DC7 0019                            CMN      CTX$,AUTO
          2 0010E6  0981 0005                            BNE      s:26265,PREL

     2098    26263    2         THEN CALL M$XXX;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:393  

  26263   2 0010E8  B870 0082                            LDR,R3   130,IMO
          2 0010EA  0001                                 MCL
          2 0010EB       0000                            DC       s:26263+3,PREL

     2099    26264
     2100    26265    2         CALL GJA$SEND_MSG(CTX$, KL$ERRMSG_RSP,

  26265   2 0010EC  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0010EE  DCC6 0006                            LDB,B5   6,B6
          2 0010F0  E2C5 0001                            LLH,R6   1,B5
          2 0010F2  6E08                                 ADV,R6   8
          2 0010F3  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 0010F5  CBC7 0114                            LAB,B4   SUBSUB$+2,AUTO
          2 0010F7  CFC7 0119                            STB,B4   SUBSUB$+7,AUTO
          2 0010F9  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 0010FB  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 0010FD  BFC7 0115                            STB,B3   SUBSUB$+3,AUTO
          2 0010FF  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 001101  CBF0 0300                            LAB,B4   768,IMO
          2 001103  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001106       0001                            DC       s:26268,PREL

     2101    26266    2           KL$ERRMSG_RSP.MESSAGE_SZ + SIZEC(KL$ERRMSG_RSPSZ) );
     2102    26267
     2103    26268    2         CALL GJA$DISOLVE_ERRMSG_CTX(CTX$);

  26268   2 001107  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 001109  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 00110B  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00110D  CBF0 0100                            LAB,B4   256,IMO
          2 00110F  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_ERRMSG_CTX
          2 001112       0001                            DC       s:26268+12,PREL
          2 001113  0F81 0E3D                            B        s:27128,PREL

     2104    26269        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:394  
     2105    26270    2       CASE(IGA_CNFG_MSG);

     2106    26271    2         KL$ = ADDR(VDO_BUFFER);

  26271   2 001115  CB80 0000 0040  00                   LAB,B4   VDO_BUFFER
          2 001118  CFC7 0013                            STB,B4   KL$,AUTO

     2107    26272    2         KL$HDR = ADDR(KL$CNFG_MSG)->KL$HDR;

  26272   2 00111A  AB85                                 LAB,B2   ,B5
          2 00111B  2C00                                 LDV,R2   0
          2 00111C  6C22                                 LDV,R6   34
          2 00111D  BB84                                 LAB,B3   ,B4
          2 00111E  3C00                                 LDV,R3   0
          2 00111F  0008                                 MMM

     2108    26273    2         MSGSIZ = SIZEC(GJA_VDO_DAT_DAT1) + SIZEC(KL$HDR);

  26273   2 001120  6C28                                 LDV,R6   40
          2 001121  EF47 0033                            STR,R6   MSGSIZ,AUTO

     2109    26274    2         TERMLO = KL$CNFG_MSG.TERMID_LO;

  26274   2 001123  9CC6 0006                            LDB,B1   6,B6
          2 001125  AB81                                 LAB,B2   ,B1
          2 001126  2C22                                 LDV,R2   34
          2 001127  6C10                                 LDV,R6   16
          2 001128  BBC7 005B                            LAB,B3   TERMLO,AUTO
          2 00112A  3C00                                 LDV,R3   0
          2 00112B  0008                                 MMM

     2110    26275    2         TERMHI = KL$CNFG_MSG.TERMID_HI;

  26275   2 00112C  BCC6 0006                            LDB,B3   6,B6
          2 00112E  AB83                                 LAB,B2   ,B3
          2 00112F  2C32                                 LDV,R2   50
          2 001130  6C10                                 LDV,R6   16
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:395  
          2 001131  BBC7 0063                            LAB,B3   TERMHI,AUTO
          2 001133  3C00                                 LDV,R3   0
          2 001134  0008                                 MMM

     2111    26276    2         CHANLO = TERMLO.TERM.CHANNEL;

  26276   2 001135  E847 005C                            LDR,R6   TERMLO+1,AUTO
          2 001137  EF47 003C                            STR,R6   CHANLO,AUTO

     2112    26277    2         CHANHI = TERMHI.TERM.CHANNEL;

  26277   2 001139  D847 0064                            LDR,R5   TERMHI+1,AUTO
          2 00113B  DF47 003D                            STR,R5   CHANHI,AUTO

     2113    26278    2         SUBLO = TERMLO.TERM.SUBDEVICE;

  26278   2 00113D  C847 005D                            LDR,R4   TERMLO+2,AUTO
          2 00113F  CF47 003F                            STR,R4   SUBLO,AUTO

     2114    26279    2         SUBHI = TERMHI.TERM.SUBDEVICE;

  26279   2 001141  B847 0065                            LDR,R3   TERMHI+2,AUTO
          2 001143  BF47 0040                            STR,R3   SUBHI,AUTO

     2115    26280    2         SUBSUBLO = TERMLO.TERM.SUBSUBDEVICE;

  26280   2 001145  A847 005E                            LDR,R2   TERMLO+3,AUTO
          2 001147  AF47 0042                            STR,R2   SUBSUBLO,AUTO

     2116    26281    2         SUBSUBHI = TERMHI.TERM.SUBSUBDEVICE;

  26281   2 001149  9847 0066                            LDR,R1   TERMHI+3,AUTO
          2 00114B  9F47 0043                            STR,R1   SUBSUBHI,AUTO

     2117    26282    2         KL$TERMINAL_ID = '0'B;

  26282   2 00114D  5C10                                 LDV,R5   16
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:396  
          2 00114E  0021                                 ALR      ;
          2 00114F       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 001151       4007 0046                                ALPHANUM(KL$TERMINAL_ID,AUTO,,R5,FILL)

     2118    26283    2         KL$TERMINAL_ID.LEV = TERMLO.LEV;

  26283   2 001153  437F                                 CSYNC    s:26282+5,SPREL
          2 001154  E847 005B                            LDR,R6   TERMLO,AUTO
          2 001156  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 001158       00FF

     2119    26284    3         DO CHAN = CHANLO TO CHANHI BY 128;

  26284   2 001159  E847 003C                            LDR,R6   CHANLO,AUTO
          2 00115B  EF47 003B                            STR,R6   CHAN,AUTO
          2 00115D  0F81 00EF                            B        s:26330+6,PREL

     2120    26285    4              DO SUB = SUBLO TO SUBHI;

  26285   2 00115F  E847 003F                            LDR,R6   SUBLO,AUTO
          2 001161  EF47 003E                            STR,R6   SUB,AUTO
          2 001163  0F81 00DD                            B        s:26329+2,PREL

     2121    26286    5                   DO SUBSUB = SUBSUBLO TO SUBSUBHI;

  26286   2 001165  E847 0042                            LDR,R6   SUBSUBLO,AUTO
          2 001167  EF47 0041                            STR,R6   SUBSUB,AUTO
          2 001169  0F81 00CF                            B        s:26328+2,PREL

     2122    26287    5                        KL$TERMINAL_ID.TERM.CHANNEL = CHAN;

  26287   2 00116B  E847 003B                            LDR,R6   CHAN,AUTO
          2 00116D  EF47 0047                            STR,R6   KL$TERMINAL_ID+1,AUTO

     2123    26288    5                        KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;

  26288   2 00116F  D847 003E                            LDR,R5   SUB,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:397  
          2 001171  DF47 0048                            STR,R5   KL$TERMINAL_ID+2,AUTO

     2124    26289    5                        KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;

  26289   2 001173  C847 0041                            LDR,R4   SUBSUB,AUTO
          2 001175  CF47 0049                            STR,R4   KL$TERMINAL_ID+3,AUTO

     2125    26290    5                        NA = KL$CNFG_MSG.NA;

  26290   2 001177  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001179  DCC6 0006                            LDB,B5   6,B6
          2 00117B  AB85                                 LAB,B2   ,B5
          2 00117C  2C54                                 LDV,R2   84
          2 00117D  6C08                                 LDV,R6   8
          2 00117E  BBC7 004E                            LAB,B3   NA,AUTO
          2 001180  3C00                                 LDV,R3   0
          2 001181  0008                                 MMM

     2126    26291    5                        CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,KL$CNFG_MSG.KHA)

  26291   2 001182  CCC6 0006                            LDB,B4   6,B6
          2 001184  BBC4 0021                            LAB,B3   33,B4
          2 001186  BFC7 0118                            STB,B3   SUBSUB$+6,AUTO
          2 001188  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 00118A  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 00118C  9BC7 004E                            LAB,B1   NA,AUTO
          2 00118E  9FC7 0114                            STB,B1   SUBSUB$+2,AUTO
          2 001190  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001192  CBF0 0300                            LAB,B4   768,IMO
          2 001194  E380 0000 0000  xent                 LNJ,B6   GJA$UPDATE_CHNTBL
          2 001197       0003                            DC       s:26293,PREL
          2 001198  0F81 0055                            B        s:26320,PREL

     2127    26292    6                        WHENALTRETURN DO;

     2128    26293    6                             IF KL$TERMINAL_ID.LEV > %TERMINAL_ID_LEV_CHAN# THEN

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:398  
  26293   2 00119A  E847 0046                            LDR,R6   KL$TERMINAL_ID,AUTO
          2 00119C  E570 00FF                            AND,R6   255,IMO
          2 00119E  6D01                                 CMV,R6   1
          2 00119F  0381 0045                            BLE      s:26313,PREL

     2129    26294    7                             DO;

     2130    26295    7                                 CALL GJA$BLD_CTX(KL$TERMINAL_ID,CHN$,'0'B) WHENRETURN

  26295   2 0011A1  EBF0 0000                            LAB,B6   0,IMO
          2 0011A3  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 0011A5  DBC7 0017                            LAB,B5   CHN$,AUTO
          2 0011A7  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0011A9  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 0011AB  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0011AD  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0011AF  CBF0 0300                            LAB,B4   768,IMO
          2 0011B1  E380 0000 0000  xent                 LNJ,B6   GJA$BLD_CTX
          2 0011B4       0026                            DC       s:26305,PREL

     2131    26296    8                                  DO;

     2132    26297    8                                       CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,
             26297                                                KL$CNFG_MSG.KHA) WHENALTRETURN

  26297   2 0011B5  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0011B7  DCC6 0006                            LDB,B5   6,B6
          2 0011B9  CBC5 0021                            LAB,B4   33,B5
          2 0011BB  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 0011BD  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 0011BF  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0011C1  BBC7 004E                            LAB,B3   NA,AUTO
          2 0011C3  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 0011C5  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0011C7  CBF0 0300                            LAB,B4   768,IMO
          2 0011C9  E380 0000 0000  xent                 LNJ,B6   GJA$UPDATE_CHNTBL
          2 0011CC       0003                            DC       s:26299,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:399  
          2 0011CD  0F81 000A                            B        s:26302,PREL

     2133    26298    9                                       DO;

     2134    26299    9                                            KL$HDR.RESULTS = E$CHAN_NOT_THERE;

  26299   2 0011CF  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 0011D2  ECC7 0013                            LDB,B6   KL$,AUTO
          2 0011D4  8D46 000E                            SDI      14,B6

     2135    26300    9                                            GOTO SEND_CNFG_NAK;

  26300   2 0011D6  0F81 007C                            B        s:26322,PREL

     2136    26301    9                                            END;
     2137    26302    8                                       END;

  26302   2 0011D8  0F81 000A                            B        s:26310,PREL

     2138    26303    7                                  WHENALTRETURN
     2139    26304    8                                  DO;

     2140    26305    8                                       KL$HDR.RESULTS = E$NO_MORE_DEVICES;

  26305   2 0011DA  8C80 0000 0010  00                   LDI      E$NO_MORE_DEVICES
          2 0011DD  ECC7 0013                            LDB,B6   KL$,AUTO
          2 0011DF  8D46 000E                            SDI      14,B6

     2141    26306    8                                       GOTO SEND_CNFG_NAK;

  26306   2 0011E1  0F81 0071                            B        s:26322,PREL

     2142    26307    8                                       END;
     2143    26308                /*E* ERROR: GJA-E$NO_MORE_DEVICES
     2144    26309            MESSAGE: No more devices. Increase the NETCON device parameter for this fep. */
     2145    26310    7                                  END;     /* if .lev > chan#          */

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:400  
  26310   2 0011E3  0F81 000A                            B        s:26320,PREL

     2146    26311    6                             ELSE
     2147    26312    7                             DO;

     2148    26313    7                                  KL$HDR.RESULTS = E$CHAN_NOT_THERE;

  26313   2 0011E5  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 0011E8  ECC7 0013                            LDB,B6   KL$,AUTO
          2 0011EA  8D46 000E                            SDI      14,B6

     2149    26314    7                                  GOTO SEND_CNFG_NAK;

  26314   2 0011EC  0F81 0066                            B        s:26322,PREL

     2150    26315    7                                  END;
     2151    26316                       /*E* ERROR: GJA-E$CHAN_NOT_THERE
     2152    26317                            MESSAGE: That channel does not exist.
     2153    26318                             */
     2154    26319    6                             END;          /* WHENALTRETURN            */
     2155    26320    5                        ADMIN = GJA_ADMIN;

  26320   2 0011EE  EB80 0000 0000  xsym                 LAB,B6   GJA_ADMIN
          2 0011F1  4C44                                 LDV,R4   68
          2 0011F2  D870 0084                            LDR,R5   132,IMO
          2 0011F4  0021                                 ALR      ;
          2 0011F5       4006 0000                                ALPHANUM(0,B6,,R4),;
          2 0011F7       4007 0094                                ALPHANUM(ADMIN,AUTO,,R5,FILL)

     2156    26321    5                        ADMIN.TERMID_LO = KL$TERMINAL_ID;

  26321   2 0011F9  ABC7 0046                            LAB,B2   KL$TERMINAL_ID,AUTO
          2 0011FB  2C00                                 LDV,R2   0
          2 0011FC  6C10                                 LDV,R6   16
          2 0011FD  BBC7 00A6                            LAB,B3   ADMIN+18,AUTO
          2 0011FF  3C00                                 LDV,R3   0
          2 001200  437F                                 CSYNC    s:26321+6,SPREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:401  
          2 001201  0008                                 MMM

     2157    26322    5                        ADMIN.TERMID_HI = KL$TERMINAL_ID;

  26322   2 001202  ABC7 0046                            LAB,B2   KL$TERMINAL_ID,AUTO
          2 001204  2C00                                 LDV,R2   0
          2 001205  6C10                                 LDV,R6   16
          2 001206  BBC7 00AE                            LAB,B3   ADMIN+26,AUTO
          2 001208  3C00                                 LDV,R3   0
          2 001209  0008                                 MMM

     2158    26323    5                        ADMIN.FNC = %KHA_FNC_CNFG;

  26323   2 00120A  6C11                                 LDV,R6   17
          2 00120B  EF47 00A5                            STR,R6   ADMIN+17,AUTO

     2159    26324    5                        CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);

  26324   2 00120D  EBC7 0017                            LAB,B6   CHN$,AUTO
          2 00120F  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 001211  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 001213  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 001215  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001217  CBF0 0200                            LAB,B4   512,IMO
          2 001219  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 00121C       0001                            DC       s:26325,PREL

     2160    26325    5                        IF KH$CHN.HAND$ ~= ADDR(NIL)

  26325   2 00121D  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 00121F  8DC6 001E                            CMN      30,B6
          2 001221  0901 0015                            BE       s:26328,PREL

     2161    26326    5                        THEN
     2162    26327    5                             CALL GJA$SEND_MSG(KH$CHN.HAND$,ADMIN,SIZEC(ADMIN));

  26327   2 001223  DBF0 0084                            LAB,B5   132,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:402  
          2 001225  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 001227  CBC7 0094                            LAB,B4   ADMIN,AUTO
          2 001229  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 00122B  BBC6 001E                            LAB,B3   30,B6
          2 00122D  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00122F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001231  CBF0 0300                            LAB,B4   768,IMO
          2 001233  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001236       0001                            DC       s:26328,PREL

     2163    26328    5                        END;               /* DO SUBSUB                */

  26328   2 001237  8AC7 0041                            INC      SUBSUB,AUTO
          2 001239  E847 0041                            LDR,R6   SUBSUB,AUTO
          2 00123B  E947 0043                            CMR,R6   SUBSUBHI,AUTO
          2 00123D  0381 FF2D                            BLE      s:26287,PREL

     2164    26329    4                   END;                    /* DO SUB                   */

  26329   2 00123F  8AC7 003E                            INC      SUB,AUTO
          2 001241  E847 003E                            LDR,R6   SUB,AUTO
          2 001243  E947 0040                            CMR,R6   SUBHI,AUTO
          2 001245  0381 FF1F                            BLE      s:26286,PREL

     2165    26330    3              END;                         /* DO SUBSUB                */

  26330   2 001247  D847 003B                            LDR,R5   CHAN,AUTO
          2 001249  DA70 0080                            ADD,R5   128,IMO
          2 00124B  DF47 003B                            STR,R5   CHAN,AUTO
          2 00124D  E847 003B                            LDR,R6   CHAN,AUTO
          2 00124F  E947 003D                            CMR,R6   CHANHI,AUTO
          2 001251  0381 FF0D                            BLE      s:26285,PREL

  26322   2                              SEND_CNFG_NAK   null
     2166    26331    2   SEND_CNFG_NAK:;
     2167    26332    2         CALL GJA$SEND_MSG(MSGCTX$,KL$HDR,SIZEC(KL$HDR));

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:403  
  26332   2 001253  EBF0 0022            SEND_CNFG_NAK   LAB,B6   34,IMO
          2 001255  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 001257  DCC7 0013                            LDB,B5   KL$,AUTO
          2 001259  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00125B  CCC7 0006                            LDB,B4   @MSGCTX$,AUTO
          2 00125D  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 00125F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001261  CBF0 0300                            LAB,B4   768,IMO
          2 001263  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001266       0001                            DC       s:26333,PREL

     2168    26333    2         RETURN;

  26333   2 001267  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2169    26334        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:404  
     2170    26335    2       CASE(IGA_RQSCHN);

     2171    26336        /*
     2172    26337          This is a request from a handler for config information or line
     2173    26338          profile information.  Just pass it on to the network manager
     2174    26339        */
     2175    26340    2         GJA$PARAMS.DAT$->KL$RQSCHN.HANDLER=GJA$HAND_CTX.NAME;

  26340   2 00126A  ACC7 0019                            LDB,B2   CTX$,AUTO
          2 00126C  2C12                                 LDV,R2   18
          2 00126D  6C08                                 LDV,R6   8
          2 00126E  BB85                                 LAB,B3   ,B5
          2 00126F  3C02                                 LDV,R3   2
          2 001270  0008                                 MMM

     2176    26341    2         CALL GJA$NETWORK_MANAGER(GJA$PARAMS.DAT$->KL$RQSCHN,GJA$PARAMS.DATSIZE);

  26341   2 001271  CCC6 0006                            LDB,B4   6,B6
          2 001273  ABC6 0008                            LAB,B2   8,B6
          2 001275  AFC7 0116                            STB,B2   SUBSUB$+4,AUTO
          2 001277  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001279  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00127B  CBF0 0200                            LAB,B4   512,IMO
          2 00127D  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 001280       0001                            DC       s:26341+16,PREL
          2 001281  0F81 0CCF                            B        s:27128,PREL

     2177    26342        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:405  
     2178    26343    2       CASE(IGA_CHNRSP);                   /* CHANNEL CONFIG INFO      */

     2179    26344    2         NA = KL$CHNRSP.NA;

  26344   2 001283  AB85                                 LAB,B2   ,B5
          2 001284  2C1A                                 LDV,R2   26
          2 001285  6C08                                 LDV,R6   8
          2 001286  BBC7 004E                            LAB,B3   NA,AUTO
          2 001288  3C00                                 LDV,R3   0
          2 001289  0008                                 MMM

     2180    26345    2         HNDCMN = KL$CHNRSP.HNDCMN;

  26345   2 00128A  CCC6 0006                            LDB,B4   6,B6
          2 00128C  AB84                                 LAB,B2   ,B4
          2 00128D  2C22                                 LDV,R2   34
          2 00128E  6C12                                 LDV,R6   18
          2 00128F  BBC7 0052                            LAB,B3   HNDCMN,AUTO
          2 001291  3C00                                 LDV,R3   0
          2 001292  0008                                 MMM

     2181    26346    2         KL$TERMINAL_ID = KL$CHNRSP.TERMINAL_ID;

  26346   2 001293  BCC6 0006                            LDB,B3   6,B6
          2 001295  AB83                                 LAB,B2   ,B3
          2 001296  2C0A                                 LDV,R2   10
          2 001297  6C10                                 LDV,R6   16
          2 001298  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 00129A  3C00                                 LDV,R3   0
          2 00129B  0008                                 MMM

     2182    26347
     2183    26348        /* If its a line profile build the table */
     2184    26349    2         IF KL$CHNRSP.LINE_PROFILE

  26349   2 00129C  BCC6 0006                            LDB,B3   6,B6
          2 00129E  8283                                 LB,'0080'X        ,B3
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:406  
          2 00129F       0080
          2 0012A0  0581 0070                            BBF      s:26363,PREL

     2185    26350    3         THEN DO;

     2186    26351    3              KL$TERMINAL_ID = KL$CHNRSP.TERMINAL_ID;

  26351   2 0012A2  AB83                                 LAB,B2   ,B3
          2 0012A3  2C0A                                 LDV,R2   10
          2 0012A4  6C10                                 LDV,R6   16
          2 0012A5  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 0012A7  3C00                                 LDV,R3   0
          2 0012A8  0008                                 MMM

     2187    26352    3              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);

  26352   2 0012A9  BBC7 0017                            LAB,B3   CHN$,AUTO
          2 0012AB  BFC7 0116                            STB,B3   SUBSUB$+4,AUTO
          2 0012AD  ABC7 0046                            LAB,B2   KL$TERMINAL_ID,AUTO
          2 0012AF  AFC7 0114                            STB,B2   SUBSUB$+2,AUTO
          2 0012B1  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0012B3  CBF0 0200                            LAB,B4   512,IMO
          2 0012B5  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 0012B8       0001                            DC       s:26353,PREL

     2188    26353    3              CTX$ = KH$CHN.HAND$;

  26353   2 0012B9  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0012BB  DCC6 001E                            LDB,B5   30,B6
          2 0012BD  DFC7 0019                            STB,B5   CTX$,AUTO

     2189    26354    3              IF KL$CHNRSP.NAK

  26354   2 0012BF  CCC7 0004                            LDB,B4   @GJA$PARAMS,AUTO
          2 0012C1  BCC4 0006                            LDB,B3   6,B4
          2 0012C3  8283                                 LB,'0010'X        ,B3
          2 0012C4       0010
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:407  
          2 0012C5  0581 001E                            BBF      s:26359,PREL

     2190    26355    4              THEN DO;

     2191    26356    4                   CALL GJA$SEND_MSG(CTX$,KL$CHNRSP,SIZEW(KL$CHNRSP));

  26356   2 0012C7  E843 001A                            LDR,R6   26,B3
          2 0012C9  6003                                 SOL,R6   3
          2 0012CA  EA70 01BF                            ADD,R6   447,IMO
          2 0012CC  6044                                 SOR,R6   4
          2 0012CD  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 0012CF  ABC7 0114                            LAB,B2   SUBSUB$+2,AUTO
          2 0012D1  AFC7 0119                            STB,B2   SUBSUB$+7,AUTO
          2 0012D3  BFC7 0117                            STB,B3   SUBSUB$+5,AUTO
          2 0012D5  9BC7 0019                            LAB,B1   CTX$,AUTO
          2 0012D7  9FC7 0115                            STB,B1   SUBSUB$+3,AUTO
          2 0012D9  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 0012DB  CBF0 0300                            LAB,B4   768,IMO
          2 0012DD  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 0012E0       0001                            DC       s:26357,PREL

     2192    26357    4                   RETURN;

  26357   2 0012E1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2193    26358    4                   END;
     2194    26359    3              CALL GJA$SEND_MSG(CTX$,KL$CHNRSP,GJA$PARAMS.DATSIZE);

  26359   2 0012E4  ABC4 0008                            LAB,B2   8,B4
          2 0012E6  AFC7 0118                            STB,B2   SUBSUB$+6,AUTO
          2 0012E8  BFC7 0116                            STB,B3   SUBSUB$+4,AUTO
          2 0012EA  9BC7 0019                            LAB,B1   CTX$,AUTO
          2 0012EC  9FC7 0114                            STB,B1   SUBSUB$+2,AUTO
          2 0012EE  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0012F0  CBF0 0300                            LAB,B4   768,IMO
          2 0012F2  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 0012F5       0001                            DC       s:26360,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:408  

     2195    26360    3              CALL GJA$LINEPROFILE (KL$TERMINAL_ID,ADDR(KL$CHNRSP.MESSAGE.MESSAGE));

  26360   2 0012F6  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0012F8  DCC6 0006                            LDB,B5   6,B6
          2 0012FA  CBC5 001B                            LAB,B4   27,B5
          2 0012FC  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0012FE  DBC7 0114                            LAB,B5   SUBSUB$+2,AUTO
          2 001300  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 001302  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 001304  BFC7 0116                            STB,B3   SUBSUB$+4,AUTO
          2 001306  BBC7 0116                            LAB,B3   SUBSUB$+4,AUTO
          2 001308  CBF0 0200                            LAB,B4   512,IMO
          2 00130A  E380 0000 0000  xent                 LNJ,B6   GJA$LINEPROFILE
          2 00130D       0001                            DC       s:26361,PREL

     2196    26361    3              RETURN;

  26361   2 00130E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2197    26362    3              END;
     2198    26363    2         IF KL$CHNRSP.DFLTHND

  26363   2 001311  8283                                 LB,'0020'X        ,B3
  26363   2 001312       0020
          2 001313  0581 003D                            BBF      s:26390,PREL

     2199    26364    3         THEN DO;

     2200    26365    3              IF NOT KL$CHNRSP.NAK

  26365   2 001315  8283                                 LB,'0010'X        ,B3
  26365   2 001316       0010
          2 001317  0501 0004                            BBT      s:26368,PREL

     2201    26366    3              THEN
     2202    26367    3                   CALL DEFAULT_HAND;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:409  

  26367   2 001319  E3C0 0D0B                            LNJ,B6   s:0,PREL
          2 00131B       0001                            DC       s:26368,PREL

     2203    26368    3              IF CTX$ = GJA_UID_NANM$ THEN

  26368   2 00131C  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 00131E  ED80 0000 0000  xsym                 CMB,B6   GJA_UID_NANM$
          2 001321  0981 001C                            BNE      s:26380,PREL

     2204    26369    4              DO;

     2205    26370    4                   CTX$ = GJA_HAND_HEAD$;

  26370   2 001323  DC80 0000 0000  xsym                 LDB,B5   GJA_HAND_HEAD$
          2 001326  DFC7 0019                            STB,B5   CTX$,AUTO

     2206    26371
     2207    26372    5                   DO WHILE(CTX$ ~= ADDR(NIL));

  26372   2 001328  0F81 0012                            B        s:26377,PREL

     2208    26373    5                        IF CTX$->GJA$HAND_CTX.NAME = KL$CHNRSP.HANDLER

  26373   2 00132A  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 00132C  DCC6 0006                            LDB,B5   6,B6
          2 00132E  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 001330  0022                                 ACM      ;
          2 001331       4804 0009                                ALPHANUM(9,B4,,8,FILL),;
          2 001333       4805 0001                                ALPHANUM(1,B5,,8,FILL)
          2 001335  5381 0008                            CBE      s:26380,PREL

     2209    26374    5                        THEN
     2210    26375    5                             EXIT;
     2211    26376    5                        CTX$ = CTX$->GJA$HAND_CTX.LNK$;

  26376   2 001337  BCC4 0001                            LDB,B3   1,B4
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:410  
          2 001339  BFC7 0019                            STB,B3   CTX$,AUTO

     2212    26377    5                        END;

  26377   2 00133B  8DC7 0019                            CMN      CTX$,AUTO
          2 00133D  09ED                                 BNE      s:26373,SPREL

     2213    26378
     2214    26379    4                   END;

     2215    26380    3              IF NOT GJA_FIRST_TIME

  26380   2 00133E  8980 0000 0000  xsym                 CMZ      GJA_FIRST_TIME
          2 001341  0801 000C                            BAL      s:26385,PREL

     2216    26381    3              THEN
     2217    26382    3                   IF CTX$ ~= ADDR(NIL)

  26382   2 001343  8DC7 0019                            CMN      CTX$,AUTO
          2 001345  0901 0008                            BE       s:26385,PREL

     2218    26383    3                   THEN
     2219    26384    3                        CALL ALLOCATE_CHAN(CTX$);

  26384   2 001347  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 001349  EFC7 010A                            STB,B6   OSILINKCHG+18,AUTO
          2 00134B  E3C0 0C08                            LNJ,B6   s:0,PREL
          2 00134D       0001                            DC       s:26385,PREL

     2220    26385    3              RETURN;

  26385   2 00134E  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2221    26386    3              END;
     2222    26387        /*
     2223    26388             If the channel is zerop and it is the first time lets go.
     2224    26389         */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:411  
     2225    26390    2         IF GJA_FIRST_TIME AND KL$TERMINAL_ID.TERM = '0'B

  26390   2 001351  8980 0000 0000  xsym                 CMZ      GJA_FIRST_TIME
          2 001354  0881 002F                            BAGE     s:26403,PREL
          2 001356  AB80 0000 0000  03                   LAB,B2   0
          2 001359  5C01                                 LDV,R5   1
          2 00135A  0022                                 ACM      ;
          2 00135B       4E07 0047                                ALPHANUM(KL$TERMINAL_ID+1,AUTO,,14,FILL),;
          2 00135D       4002 0000                                ALPHANUM(0,B2,,R5,FILL)
          2 00135F  5301 0024                            CBNE     s:26403,PREL

     2226    26391    3         THEN DO;

     2227    26392    3              GJA_FIRST_TIME = '0'B;

  26392   2 001361  8700 0000 0000  xsym                 CL       GJA_FIRST_TIME

     2228    26393    3              CTX$ = GJA_HAND_HEAD$;

  26393   2 001364  AC80 0000 0000  xsym                 LDB,B2   GJA_HAND_HEAD$
          2 001367  AFC7 0019                            STB,B2   CTX$,AUTO

     2229    26394    4              DO WHILE (CTX$ ~= ADDR(NIL));

  26394   2 001369  0F81 0015                            B        s:26399,PREL

     2230    26395    4                   IF CTX$->GJA$HAND_CTX.WHO = %GJA_UID_HANDLER

  26395   2 00136B  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 00136D  E806                                 LDR,R6   ,B6
          2 00136E  604D                                 SOR,R6   13
          2 00136F  6D03                                 CMV,R6   3
          2 001370  0981 0008                            BNE      s:26398,PREL

     2231    26396    4                   THEN
     2232    26397    4                        CALL ALLOCATE_CHAN(CTX$);

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:412  
  26397   2 001372  DBC7 0019                            LAB,B5   CTX$,AUTO
          2 001374  DFC7 010A                            STB,B5   OSILINKCHG+18,AUTO
          2 001376  E3C0 0BDD                            LNJ,B6   s:0,PREL
          2 001378       0001                            DC       s:26398,PREL

     2233    26398    4                   CTX$ = CTX$->GJA$HAND_CTX.LNK$;

  26398   2 001379  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 00137B  DCC6 0001                            LDB,B5   1,B6
          2 00137D  DFC7 0019                            STB,B5   CTX$,AUTO

     2234    26399    4                   END;

  26399   2 00137F  8DC7 0019                            CMN      CTX$,AUTO
          2 001381  09EA                                 BNE      s:26395,SPREL

     2235    26400    3              GOTO NM_SAYS_GO;

  26400   2 001382  0F81 00B5                            B        s:26454,PREL

     2236    26401    3              END;
     2237    26402
     2238    26403    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)

  26403   2 001384  ABC7 0017                            LAB,B2   CHN$,AUTO
          2 001386  AFC7 0116                            STB,B2   SUBSUB$+4,AUTO
          2 001388  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 00138A  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00138C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00138E  CBF0 0200                            LAB,B4   512,IMO
          2 001390  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 001393       0003                            DC       s:26405,PREL
          2 001394  0F81 0025                            B        s:26417,PREL

     2239    26404    3         WHENALTRETURN DO;

     2240    26405    3              IF KL$TERMINAL_ID.LEV ~= %TERMINAL_ID_LEV_CHAN#
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:413  

  26405   2 001396  E847 0046                            LDR,R6   KL$TERMINAL_ID,AUTO
          2 001398  E570 00FF                            AND,R6   255,IMO
          2 00139A  6D01                                 CMV,R6   1
          2 00139B  0901 001E                            BE       s:26417,PREL

     2241    26406    3              THEN
     2242    26407    4                   CALL GJA$BLD_CTX (KL$TERMINAL_ID,CHN$,'0'B) WHENALTRETURN DO;

  26407   2 00139D  EBF0 0000                            LAB,B6   0,IMO
          2 00139F  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 0013A1  DBC7 0017                            LAB,B5   CHN$,AUTO
          2 0013A3  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0013A5  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 0013A7  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0013A9  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0013AB  CBF0 0300                            LAB,B4   768,IMO
          2 0013AD  E380 0000 0000  xent                 LNJ,B6   GJA$BLD_CTX
          2 0013B0       0003                            DC       s:26408,PREL
          2 0013B1  0F81 0008                            B        s:26417,PREL

     2243    26408    4                        CALL M$SCREECH(NODEDEV);

  26408   2 0013B3  BB80 0000 003A  00                   LAB,B3   NODEDEV
          2 0013B6  B870 0485                            LDR,R3   1157,IMO
          2 0013B8  0001                                 MCL
          2 0013B9       0000                            DC       s:26408+6,PREL

     2244    26409                         /*S* SCREECH_CODE: GJA-S$NODEDEV
     2245    26410                              TYPE:SCREECH
     2246    26411                              MESSAGE: NODEADMN out of device context memory.
     2247    26412                              REMARKS: Increase the DEVICE parameter in NETCON and
     2248    26413                                       reboot.
     2249    26414                         */
     2250    26415    4                        END;

     2251    26416    3              END;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:414  

     2252    26417    2         IF NA.CNFG_EXISTS THEN

  26417   2 0013BA  82C7 004E                            LB,'0002'X        NA,AUTO
  26417   2 0013BC       0002
          2 0013BD  0581 0015                            BBF      s:26430,PREL

     2253    26418    2              CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,HNDCMN);

  26418   2 0013BF  EBC7 0052                            LAB,B6   HNDCMN,AUTO
          2 0013C1  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 0013C3  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 0013C5  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0013C7  CBC7 004E                            LAB,B4   NA,AUTO
          2 0013C9  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0013CB  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0013CD  CBF0 0300                            LAB,B4   768,IMO
          2 0013CF  E380 0000 0000  xent                 LNJ,B6   GJA$UPDATE_CHNTBL
          2 0013D2       0001                            DC       s:26430,PREL

     2254    26419
     2255    26420
     2256    26421        /* If there is already a handler send an ENABLE or DISABLE to the
     2257    26422           line depending on the channel table flag.
     2258    26423        */
     2259    26424        /*  If scndcnfg is on then a terminal name was associated with this
     2260    26425            request.  This config is just to get and records configged under
     2261    26426            chan-n-n instead of termname-n-n.  The chnrsp from the term name
     2262    26427            will issue the enable to the handler.  This is only for bozos
     2263    26428            who wont read the manual.
     2264    26429        */
     2265    26430    2         IF KL$CHNRSP.SCNDCNFG THEN

  26430   2 0013D3  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0013D5  DCC6 0006                            LDB,B5   6,B6
          2 0013D7  8285                                 LB,'0008'X        ,B5
          2 0013D8       0008
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:415  
          2 0013D9  0581 0004                            BBF      s:26432,PREL

     2266    26431    2              RETURN;

  26431   2 0013DB  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2267    26432    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)

  26432   2 0013DE  CBC7 0017                            LAB,B4   CHN$,AUTO
          2 0013E0  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 0013E2  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 0013E4  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 0013E6  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0013E8  CBF0 0200                            LAB,B4   512,IMO
          2 0013EA  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 0013ED       0041                            DC       s:26445,PREL

     2268    26433    3         WHENRETURN DO;

     2269    26434    3              IF KH$CHN.HAND$ ~= ADDR(NIL)

  26434   2 0013EE  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0013F0  8DC6 001E                            CMN      30,B6
          2 0013F2  0901 003B                            BE       s:26445,PREL

     2270    26435    4              THEN DO;

     2271    26436    4                   ADMIN = GJA_ADMIN;

  26436   2 0013F4  DB80 0000 0000                       LAB,B5   0
          2 0013F7  4C44                                 LDV,R4   68
          2 0013F8  D870 0084                            LDR,R5   132,IMO
          2 0013FA  0021                                 ALR      ;
          2 0013FB       4005 0000                                ALPHANUM(0,B5,,R4),;
          2 0013FD       4007 0094                                ALPHANUM(ADMIN,AUTO,,R5,FILL)

     2272    26437    4                   ADMIN.TERMID_LO = KL$TERMINAL_ID;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:416  

  26437   2 0013FF  ABC7 0046                            LAB,B2   KL$TERMINAL_ID,AUTO
          2 001401  2C00                                 LDV,R2   0
          2 001402  6C10                                 LDV,R6   16
          2 001403  BBC7 00A6                            LAB,B3   ADMIN+18,AUTO
          2 001405  3C00                                 LDV,R3   0
          2 001406  437F                                 CSYNC    s:26437+6,SPREL
          2 001407  0008                                 MMM

     2273    26438    4                   ADMIN.TERMID_HI = KL$TERMINAL_ID;

  26438   2 001408  ABC7 0046                            LAB,B2   KL$TERMINAL_ID,AUTO
          2 00140A  2C00                                 LDV,R2   0
          2 00140B  6C10                                 LDV,R6   16
          2 00140C  BBC7 00AE                            LAB,B3   ADMIN+26,AUTO
          2 00140E  3C00                                 LDV,R3   0
          2 00140F  0008                                 MMM

     2274    26439    4                   IF KH$CHN.ENB

  26439   2 001410  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001412  82C6 0007                            LB,'0040'X        7,B6
          2 001414       0040
          2 001415  0581 0018                            BBF      s:26445,PREL

     2275    26440    5                   THEN DO;

     2276    26441    5                        ADMIN.FNC = %KHA_FNC_ENABLE;

  26441   2 001417  6C01                                 LDV,R6   1
          2 001418  EF47 00A5                            STR,R6   ADMIN+17,AUTO

     2277    26442    5                        CALL GJA$SEND_MSG(KH$CHN.HAND$,ADMIN,SIZEC(ADMIN));

  26442   2 00141A  DBF0 0084                            LAB,B5   132,IMO
          2 00141C  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 00141E  CBC7 0094                            LAB,B4   ADMIN,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:417  
          2 001420  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001422  BBC6 001E                            LAB,B3   30,B6
          2 001424  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001426  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001428  CBF0 0300                            LAB,B4   768,IMO
          2 00142A  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 00142D       0001                            DC       s:26445,PREL

     2278    26443    5                        END;

     2279    26444    4                   END;

     2280    26445    3              END;

  26445   2 00142E  0F81 0B22                            B        s:27128,PREL

     2281    26446        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:418  
     2282    26447    2       CASE (IGA_GO);                 /* Were all set lets get going   */

     2283    26448        /* Check to see if this is the first time that we connected to the network
     2284    26449             manager. If it is we just return.  This routine will be called
     2285    26450             later on a CHNRSP with a channel of zero indicatine the last
     2286    26451             response.
     2287    26452         */
     2288    26453    2         IF GJA_FIRST_TIME

  26453   2 001430  8980 0000 0000  xsym                 CMZ      GJA_FIRST_TIME
          2 001433  0881 0004                            BAGE     s:26454,PREL

     2289    26454    2         THEN
     2290    26455    2              RETURN;

  26455   2 001435  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

  26454   2                              NM_SAYS_GO      null
     2291    26456
     2292    26457    2   NM_SAYS_GO: ;
     2293    26458        /*
     2294    26459          Just in case we managed to get a logon request in here someplace,
     2295    26460          run the logon chain to pickup where we left off on the request
     2296    26461        */
     2297    26462    2         CTX$=GJA_USRLGN_HEAD$;

  26462   2 001438  EC80 0000 0000  xsym NM_SAYS_GO      LDB,B6   GJA_USRLGN_HEAD$
          2 00143B  EFC7 0019                            STB,B6   CTX$,AUTO

     2298    26463    2         IF NOT(GJA_HSTRSMED) THEN

  26463   2 00143D  8980 0000 0000  xsym                 CMZ      GJA_HSTRSMED
          2 001440  0801 0009                            BAL      s:26465,PREL

     2299    26464    3              CALL GJA$HOST_RESUMED WHENALTRETURN DO;END;

  26464   2 001442  CBF0 0000                            LAB,B4   0,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:419  
          2 001444  E380 0000 0000  xent                 LNJ,B6   GJA$HOST_RESUMED
          2 001447       0003                            DC       s:26465,PREL
          2 001448  0F81 0001                            B        s:26465,PREL

     2300    26465    3         IF GJA_DEFNODE = UID$->GJA$HAND_CTX.NODE THEN DO;

  26465   2 00144A  ECC7 001B                            LDB,B6   UID,AUTO
          2 00144C  E846 000D                            LDR,R6   13,B6
          2 00144E  E570 00FF                            AND,R6   255,IMO
          2 001450  E900 0000 0000  xsym                 CMR,R6   GJA_DEFNODE
          2 001453  0981 002B                            BNE      s:26477,PREL

     2301    26466    4              DO WHILE (CTX$ ~= ADDR(NIL));

  26466   2 001455  0F81 0026                            B        s:26474,PREL

     2302    26467    4                   IF CTX$->GJA$LGNCTX.STATUS.WAITING_HOST OR

  26467   2 001457  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001459  82C6 0018                            LB,'0040'X        24,B6
          2 00145B       0040
          2 00145C  0501 000B                            BBT      s:26470,PREL
          2 00145E  82C6 0018                            LB,'2000'X        24,B6
          2 001460       2000
          2 001461  0501 0014                            BBT      s:26473,PREL
          2 001463  82C6 0018                            LB,'0200'X        24,B6
          2 001465       0200
          2 001466  0501 000F                            BBT      s:26473,PREL

     2303    26468    4                     ( NOT CTX$->GJA$LGNCTX.STATUS.NMRSP AND
     2304    26469    4                     NOT CTX$->GJA$LGNCTX.STATUS.WTPRO) THEN
     2305    26470    4                        CALL GJA$LOGON_REQUEST_AGAIN(CTX$)

  26470   2 001468  DBC7 0019                            LAB,B5   CTX$,AUTO
          2 00146A  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 00146C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00146E  CBF0 0100                            LAB,B4   256,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:420  
          2 001470  E380 0000 0000  xent                 LNJ,B6   GJA$LOGON_REQUEST_AGAIN
          2 001473       0003                            DC       s:26473,PREL
          2 001474  0F81 0001                            B        s:26473,PREL

     2306    26471    5                        WHENALTRETURN DO;

     2307    26472    5                             END;

     2308    26473    4                   CTX$=CTX$->GJA$LGNCTX.LNK$;

  26473   2 001476  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001478  DCC6 0001                            LDB,B5   1,B6
          2 00147A  DFC7 0019                            STB,B5   CTX$,AUTO

     2309    26474    4                   END;

  26474   2 00147C  8DC7 0019                            CMN      CTX$,AUTO
          2 00147E  09D9                                 BNE      s:26467,SPREL

     2310    26475    3              END;                         /* defnode = hand_ctx.node*/

     2311    26476        /* If we booted from diskette start the dump */
     2312    26477    2         KL$TERMINAL_ID = '0'B;

  26477   2 00147F  5C10                                 LDV,R5   16
          2 001480  0021                                 ALR      ;
          2 001481       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 001483       4007 0046                                ALPHANUM(KL$TERMINAL_ID,AUTO,,R5,FILL)

     2313    26478    2         KL$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN#;

  26478   2 001485  6C01                                 LDV,R6   1
          2 001486  437F                                 CSYNC    s:26478,SPREL
          2 001487  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 001489       00FF

     2314    26479    2         KL$TERMINAL_ID.TERM.CHANNEL = GID_BOOTCHAN * 64;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:421  

  26479   2 00148A  C800 0000 0000  xsym                 LDR,R4   GID_BOOTCHAN
          2 00148D  4006                                 SOL,R4   6
          2 00148E  CF47 0047                            STR,R4   KL$TERMINAL_ID+1,AUTO

     2315    26480    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)

  26480   2 001490  EBC7 0017                            LAB,B6   CHN$,AUTO
          2 001492  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 001494  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 001496  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 001498  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00149A  CBF0 0200                            LAB,B4   512,IMO
          2 00149C  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 00149F       0013                            DC       s:26485,PREL

     2316    26481    3         WHENRETURN DO;

     2317    26482    3              IF KH$CHN.RESOURCE = 'DK'

  26482   2 0014A0  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0014A2  DB80 0000 0000  01                   LAB,B5   E$NONETMAN
          2 0014A5  0022                                 ACM      ;
          2 0014A6       4206 0004                                ALPHANUM(4,B6,,2,FILL),;
          2 0014A8       4205 001B                                ALPHANUM(27,B5,,2,FILL)
          2 0014AA  5301 0007                            CBNE     s:26485,PREL

     2318    26483    3              THEN
     2319    26484    3                   CALL GIJ$INITDUMP;

  26484   2 0014AC  CBF0 0000                            LAB,B4   0,IMO
          2 0014AE  E380 0000 0000  xent                 LNJ,B6   GIJ$INITDUMP
          2 0014B1       0001                            DC       s:26485,PREL

     2320    26485    3              END;

  26485   2 0014B2  0F81 0A9E                            B        s:27128,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:422  

     2321    26486
     2322    26487        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:423  
     2323    26488
     2324    26489    2       CASE(IGA_LINE_ACQUIRE);

     2325    26490
     2326    26491    2         IF WHO = %GJA_UID_HANDLER

  26491   2 0014B4  E847 0026                            LDR,R6   WHO,AUTO
          2 0014B6  6D03                                 CMV,R6   3
          2 0014B7  0981 0060                            BNE      s:26509,PREL

     2327    26492    3         THEN DO;

     2328    26493    3              GJA$HAND_CTX.RES = KL$ACQUIRE.RES;

  26493   2 0014B9  AB85                                 LAB,B2   ,B5
          2 0014BA  2C0C                                 LDV,R2   12
          2 0014BB  6C02                                 LDV,R6   2
          2 0014BC  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 0014BE  3C1E                                 LDV,R3   30
          2 0014BF  0008                                 MMM

     2329    26494    3              GJA$HAND_CTX.ATTR = KL$ACQUIRE.ATTR;

  26494   2 0014C0  CCC6 0006                            LDB,B4   6,B6
          2 0014C2  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 0014C4  E844 0007                            LDR,R6   7,B4
          2 0014C6  EF43 0010                            STR,R6   16,B3

     2330    26495
     2331    26496    3              IF GJA_FIRST_TIME

  26496   2 0014C8  8980 0000 0000  xsym                 CMZ      GJA_FIRST_TIME
          2 0014CB  0881 000A                            BAGE     s:26501,PREL

     2332    26497    3              THEN
     2333    26498    3                   CALL ALLOCATE_CHAN(CTX$);

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:424  
  26498   2 0014CD  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 0014CF  CFC7 010A                            STB,B4   OSILINKCHG+18,AUTO
          2 0014D1  E3C0 0A82                            LNJ,B6   s:0,PREL
          2 0014D3       0001                            DC       s:26498+7,PREL
          2 0014D4  0F81 0040                            B        s:26507,PREL

     2334    26499    4              ELSE DO;

     2335    26500                  /* SEND UP A REQUEST FOR THE DEFAULT HANDLER AND PROFILE  */
     2336    26501    4                   ADDR(VDO_BUFFER)->KL$RQSCHN = GJA_RQSCHN;

  26501   2 0014D6  AB80 0000 0000  xsym                 LAB,B2   GJA_RQSCHN
          2 0014D9  2C00                                 LDV,R2   0
          2 0014DA  E280 0000 000D  xsym                 LLH,R6   GJA_RQSCHN+13
          2 0014DD  6E1B                                 ADV,R6   27
          2 0014DE  BB80 0000 0040  00                   LAB,B3   VDO_BUFFER
          2 0014E1  3C00                                 LDV,R3   0
          2 0014E2  F280 0000 004D  00                   LLH,R7   VDO_BUFFER+13
          2 0014E5  7E1B                                 ADV,R7   27
          2 0014E6  D380 0000 0000  xent                 LNJ,B5   X6C_ALRZ

     2337    26502    4                   ADDR(VDO_BUFFER)->KL$RQSCHN.HANDLER = GJA$HAND_CTX.NAME;

  26502   2 0014E9  ACC7 0019                            LDB,B2   CTX$,AUTO
          2 0014EB  2C12                                 LDV,R2   18
          2 0014EC  6C08                                 LDV,R6   8
          2 0014ED  BB80 0000 0041  00                   LAB,B3   VDO_BUFFER+1
          2 0014F0  3C00                                 LDV,R3   0
          2 0014F1  0008                                 MMM

     2338    26503    4                   ADDR(VDO_BUFFER)->KL$RQSCHN.DFLTHND = '1'B;

  26503   2 0014F2  8900 0000 0040  00                   LBT,'0020'X       VDO_BUFFER
  26503   2 0014F5       0020

     2339    26504    4                   CALL GJA$NETWORK_MANAGER (ADDR(VDO_BUFFER)->KL$RQSCHN,SIZEC(ADDR(
             26504                            VDO_BUFFER)->KL$RQSCHN));
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:425  

  26504   2 0014F6  E280 0000 004D  00                   LLH,R6   VDO_BUFFER+13
          2 0014F9  6003                                 SOL,R6   3
          2 0014FA  EA70 00E7                            ADD,R6   231,IMO
          2 0014FC  6044                                 SOR,R6   4
          2 0014FD  6001                                 SOL,R6   1
          2 0014FE  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 001500  EBC7 0114                            LAB,B6   SUBSUB$+2,AUTO
          2 001502  EFC7 0117                            STB,B6   SUBSUB$+5,AUTO
          2 001504  DB80 0000 0040  00                   LAB,B5   VDO_BUFFER
          2 001507  DFC7 0115                            STB,B5   SUBSUB$+3,AUTO
          2 001509  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 00150B  CBF0 0200                            LAB,B4   512,IMO
          2 00150D  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 001510       0001                            DC       s:26505,PREL

     2340    26505    4                   ADDR(VDO_BUFFER)->KL$RQSCHN.DFLTHND = '0'B;

  26505   2 001511  8800 0000 0040  00                   LBF,'0020'X       VDO_BUFFER
  26505   2 001514       0020

     2341    26506    4                   END;

     2342    26507    3              RETURN;

  26507   2 001515  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2343    26508    3              END;
     2344    26509    2         KL$TERMINAL_ID.LEV=%TERMINAL_ID_LEV_CHAN#;

  26509   2 001518  5C01                                 LDV,R5   1
          2 001519  DAC7 0046                            SRM,R5,'00FF'X    KL$TERMINAL_ID,AUTO
          2 00151B       00FF

     2345    26510    2         SVCHN$ = ADDR(NIL);

  26510   2 00151C  DB80 0000 0000                       LAB,B5   0
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:426  
          2 00151F  DFC7 002F                            STB,B5   SVCHN$,AUTO

     2346    26511    2         SVCHAN=KL$ACQUIRE.CHAN;

  26511   2 001521  CCC6 0006                            LDB,B4   6,B6
          2 001523  C844 0001                            LDR,R4   1,B4
          2 001525  CF47 0031                            STR,R4   SVCHAN,AUTO

     2347    26512    2         BASECHAN=0;

  26512   2 001527  8747 0039                            CL       BASECHAN,AUTO

     2348    26513    2         LASTCHAN=0;

  26513   2 001529  8747 003A                            CL       LASTCHAN,AUTO

     2349    26514    2         KL$ACQUIRE.CHAN=0;

  26514   2 00152B  8744 0001                            CL       1,B4

     2350    26515    2         KL$ACQUIRE.HIGHCHAN=0;

  26515   2 00152D  CCC6 0006                            LDB,B4   6,B6
          2 00152F  8744 0002                            CL       2,B4

     2351    26516    2         KL$ACQUIRE.LOWCHAN=0;

  26516   2 001531  CCC6 0006                            LDB,B4   6,B6
          2 001533  8744 0003                            CL       3,B4

     2352    26517        /*
     2353    26518          The following code segment sets up a base channel to start the
     2354    26519          search and last channel to end the search.  It understands
     2355    26520          a diagnostic request to scan an entire controller and sets up the
     2356    26521          range accordingly.  For normal, non-diagnostic requests, the range
     2357    26522          is the whole channel table.  If a diagnostic user requests a
     2358    26523          channel and controller for a non MLCP, NMLC device, he gets just
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:427  
     2359    26524          that one channel, even though he asked for the whole controller.
     2360    26525        */
     2361    26526    2         IF KL$ACQUIRE.DIAG

  26526   2 001535  CCC6 0006                            LDB,B4   6,B6
          2 001537  89C4 0008                            CMZ      8,B4
          2 001539  0881 0069                            BAGE     s:26555,PREL

     2362    26527    3         THEN DO;                          /* DIAG                     */

     2363    26528    3              KL$TERMINAL_ID.TERM.CHANNEL=SVCHAN;

  26528   2 00153B  CF47 0047                            STR,R4   KL$TERMINAL_ID+1,AUTO

     2364    26529    3              KL$ACQUIRE.ERRCODE=E$CHAN_NOT_THERE;

  26529   2 00153D  CCC6 0006                            LDB,B4   6,B6
          2 00153F  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 001542  8D44 0009                            SDI      9,B4

     2365    26530    3              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) ALTRET(SENDIT);

  26530   2 001544  CBC7 0017                            LAB,B4   CHN$,AUTO
          2 001546  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001548  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 00154A  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00154C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00154E  CBF0 0200                            LAB,B4   512,IMO
          2 001550  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 001553       019B                            DC       s:26661,PREL

     2366    26531    3              KL$ACQUIRE.ERRCODE='0'B;

  26531   2 001554  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001556  DCC6 0006                            LDB,B5   6,B6
          2 001558  8745 0009                            CL       9,B5
          2 00155A  8745 000A                            CL       10,B5
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:428  

     2367    26532    3              IF KL$ACQUIRE.CONTROLLER

  26532   2 00155C  DCC6 0006                            LDB,B5   6,B6
          2 00155E  82C5 0008                            LB,'4000'X        8,B5
          2 001560       4000
          2 001561  0581 0039                            BBF      s:26550,PREL

     2368    26533    4              THEN DO;                     /* CONTROLLER               */

     2369    26534    4                   IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_MLCP#

  26534   2 001563  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001565  E844 0002                            LDR,R6   2,B4
          2 001567  E570 FF00                            AND,R6   -256,IMO
          2 001569  E970 2100                            CMR,R6   8448,IMO
          2 00156B  0981 0010                            BNE      s:26539,PREL

     2370    26535    5                   THEN DO;

     2371    26536    5                        BASECHAN=SVCHAN-MOD(SVCHAN,1024/*'400'X*/);

  26536   2 00156D  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 00156F  E570 03FF                            AND,R6   1023,IMO
          2 001571  E247 0031                            SUB,R6   SVCHAN,AUTO
          2 001573  8256                                 NEG      R6
          2 001574  EF47 0039                            STR,R6   BASECHAN,AUTO

     2372    26537    5                        LASTCHAN=BASECHAN+(896/*'400'X-'80'X*/);

  26537   2 001576  EA70 0380                            ADD,R6   896,IMO
          2 001578  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2373    26538    5                        END;

  26538   2 00157A  0F81 0032                            B        s:26563,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:429  
     2374    26539    4                   ELSE IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_NMLC#

  26539   2 00157C  E844 0002                            LDR,R6   2,B4
          2 00157E  E570 FF00                            AND,R6   -256,IMO
          2 001580  E970 2900                            CMR,R6   10496,IMO
          2 001582  0981 0010                            BNE      s:26545,PREL

     2375    26540    5                        THEN DO;

     2376    26541    5                             BASECHAN=SVCHAN-MOD(SVCHAN,2048/*'800'X*/);

  26541   2 001584  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 001586  E570 07FF                            AND,R6   2047,IMO
          2 001588  E247 0031                            SUB,R6   SVCHAN,AUTO
          2 00158A  8256                                 NEG      R6
          2 00158B  EF47 0039                            STR,R6   BASECHAN,AUTO

     2377    26542    5                             LASTCHAN=BASECHAN+(1920/*'800'X-'80'X*/);

  26542   2 00158D  EA70 0780                            ADD,R6   1920,IMO
          2 00158F  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2378    26543    5                             END;

  26543   2 001591  0F81 001B                            B        s:26563,PREL

     2379    26544    5                        ELSE DO;

     2380    26545    5                             BASECHAN=SVCHAN;

  26545   2 001593  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 001595  EF47 0039                            STR,R6   BASECHAN,AUTO

     2381    26546    5                             LASTCHAN=SVCHAN;

  26546   2 001597  EF47 003A                            STR,R6   LASTCHAN,AUTO

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:430  
     2382    26547    5                             END;

     2383    26548    4                   END;                    /* CONTROLLER               */

  26548   2 001599  0F81 0013                            B        s:26563,PREL

     2384    26549    4              ELSE DO;

     2385    26550    4                   BASECHAN=SVCHAN;

  26550   2 00159B  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 00159D  EF47 0039                            STR,R6   BASECHAN,AUTO

     2386    26551    4                   LASTCHAN=SVCHAN;

  26551   2 00159F  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2387    26552    4                   END;

     2388    26553    3              END;                         /* DIAG                     */

  26553   2 0015A1  0F81 000B                            B        s:26563,PREL

     2389    26554    3         ELSE DO;

     2390    26555    3              BASECHAN=GJA_CHNLOW;

  26555   2 0015A3  B800 0000 0000  xsym                 LDR,R3   GJA_CHNLOW
          2 0015A6  BF47 0039                            STR,R3   BASECHAN,AUTO

     2391    26556    3              LASTCHAN=GJA_CHNHI;

  26556   2 0015A8  A800 0000 0000  xsym                 LDR,R2   GJA_CHNHI
          2 0015AB  AF47 003A                            STR,R2   LASTCHAN,AUTO

     2392    26557    3              END;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:431  
     2393    26558        /*
     2394    26559          Now that we have a range, lets get a pointer to the first channel
     2395    26560          that actually exists in that range.  If none exist, we have a
     2396    26561          problem.
     2397    26562        */
     2398    26563    2         KL$TERMINAL_ID.TERM.CHANNEL=BASECHAN;

  26563   2 0015AD  E847 0039                            LDR,R6   BASECHAN,AUTO
          2 0015AF  EF47 0047                            STR,R6   KL$TERMINAL_ID+1,AUTO

     2399    26564    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);

  26564   2 0015B1  DBC7 0017                            LAB,B5   CHN$,AUTO
          2 0015B3  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0015B5  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 0015B7  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0015B9  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0015BB  CBF0 0200                            LAB,B4   512,IMO
          2 0015BD  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 0015C0       0001                            DC       s:26565,PREL

     2400    26565    2         SVCHN$ = CHN$;

  26565   2 0015C1  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0015C3  EFC7 002F                            STB,B6   SVCHN$,AUTO

     2401    26566    2         IF CHN$ ~= ADDR(NIL) AND KH$CHN.CHNBIT0_9*64 > LASTCHAN

  26566   2 0015C5  8DC7 0017                            CMN      CHN$,AUTO
          2 0015C7  0901 0013                            BE       s:26569,PREL
          2 0015C9  E806                                 LDR,R6   ,B6
          2 0015CA  E570 FFC0                            AND,R6   -64,IMO
          2 0015CC  E947 003A                            CMR,R6   LASTCHAN,AUTO
          2 0015CE  0381 000C                            BLE      s:26569,PREL

     2402    26567    2         THEN KL$ACQUIRE.ERRCODE=E$CHAN_NOT_THERE;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:432  
  26567   2 0015D0  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 0015D2  CCC5 0006                            LDB,B4   6,B5
          2 0015D4  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 0015D7  8D44 0009                            SDI      9,B4
          2 0015D9  0F81 00FC                            B        s:26661,PREL

     2403    26568    3         ELSE DO;

     2404    26569    3              BASECHAN=KH$CHN.CHNBIT0_9*64;

  26569   2 0015DB  E806                                 LDR,R6   ,B6
          2 0015DC  E570 FFC0                            AND,R6   -64,IMO
          2 0015DE  EF47 0039                            STR,R6   BASECHAN,AUTO

     2405    26570    3              SVATTR = KL$ACQUIRE.ATTR;

  26570   2 0015E0  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 0015E2  CCC5 0006                            LDB,B4   6,B5
          2 0015E4  D844 0007                            LDR,R5   7,B4
          2 0015E6  DF47 0032                            STR,R5   SVATTR,AUTO

     2406    26571        /*
     2407    26572          This loop does the actual aquiring.
     2408    26573        */
     2409    26574    4   ACQUIRE:   DO WHILE (BASECHAN <= LASTCHAN AND CHN$ <= GJA_CHNHI$); /* ACQUIRE */

  26574   2 0015E8  0F81 00E2            ACQUIRE         B        s:26659,PREL

     2410    26575    5   CHAN:           DO ;                    /* CHAN                     */

  26575   2                              CHAN            null
     2411    26576    5                        IF BASECHAN = 0

  26576   2 0015EA  E847 0039            CHAN            LDR,R6   BASECHAN,AUTO
          2 0015EC  6901 00D3                            BEZ,R6   s:26657,PREL

     2412    26577    5                        THEN EXIT CHAN;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:433  
     2413    26578        /*
     2414    26579          If this is a diagnostic acquire and the channel is owned, its
     2415    26580          all over but the erroring.  If this is a non-diagnostic acquire
     2416    26581          and the channel is owned, skip to the next one.
     2417    26582        */
     2418    26583    5                        IF(KH$CHN.HAND$ ~= ADDR(NIL) OR KH$CHN.SYSID ~= 0)

  26583   2 0015EE  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0015F0  8DC6 001E                            CMN      30,B6
          2 0015F2  0981 0005                            BNE      s:26585,PREL
          2 0015F4  D846 0006                            LDR,R5   6,B6
          2 0015F6  5901 001E                            BEZ,R5   s:26605,PREL

     2419    26584    6                        THEN DO;

     2420    26585    6                             IF KL$ACQUIRE.DIAG

  26585   2 0015F8  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 0015FA  CCC5 0006                            LDB,B4   6,B5
          2 0015FC  89C4 0008                            CMZ      8,B4
          2 0015FE  0881 0014                            BAGE     s:26598,PREL

     2421    26586    7                             THEN DO;

     2422    26587    7                                  IF KL$ACQUIRE.CONTROLLER

  26587   2 001600  82C4 0008                            LB,'4000'X        8,B4
  26587   2 001602       4000
          2 001603  0581 0008                            BBF      s:26592,PREL

     2423    26588    7                                  THEN KL$ACQUIRE.ERRCODE=E$CONT_OWNED;

  26588   2 001605  8C80 0000 0020  00                   LDI      E$CONT_OWNED
          2 001608  8D44 0009                            SDI      9,B4
          2 00160A  0F81 0006                            B        s:26596,PREL

     2424    26589        /*E* ERROR: GJA-E$CONT_OWNED
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:434  
     2425    26590             MESSAGE: This controller is wholly or partially owned already.
     2426    26591        */
     2427    26592    7                                  ELSE KL$ACQUIRE.ERRCODE=E$CHAN_OWNED;

  26592   2 00160C  8C80 0000 0022  00                   LDI      E$CHAN_OWNED
          2 00160F  8D44 0009                            SDI      9,B4

     2428    26593        /*E* ERROR: GJA-E$CHAN_OWNED
     2429    26594             MESSAGE: This channel is already owned by someone.
     2430    26595        */
     2431    26596    7                                  EXIT ACQUIRE;

  26596   2 001611  0F81 00C4                            B        s:26661,PREL

     2432    26597    7                                  END;
     2433    26598    6                             EXIT CHAN;

  26598   2 001613  0F81 00AC                            B        s:26657,PREL

     2434    26599    6                             END;
     2435    26600        /*
     2436    26601          The channel is not currently owned.  If this is a diagnostic acquire
     2437    26602          and the channel is not partitioned for diagnostics, we blow the
     2438    26603          guy off.
     2439    26604        */
     2440    26605    5                        IF KL$ACQUIRE.DIAG AND KH$CHN.STT ~= %KH#CHN_STT_PRT

  26605   2 001615  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 001617  CCC5 0006                            LDB,B4   6,B5
          2 001619  89C4 0008                            CMZ      8,B4
          2 00161B  0881 0019                            BAGE     s:26617,PREL
          2 00161D  C2C6 0001                            LLH,R4   1,B6
          2 00161F  4D06                                 CMV,R4   6
          2 001620  0901 0014                            BE       s:26617,PREL

     2441    26606    6                        THEN DO;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:435  
     2442    26607    6                             IF KL$ACQUIRE.CONTROLLER

  26607   2 001622  82C4 0008                            LB,'4000'X        8,B4
  26607   2 001624       4000
          2 001625  0581 0008                            BBF      s:26609,PREL

     2443    26608    6                             THEN KL$ACQUIRE.ERRCODE=E$CONT_NOT_PART;

  26608   2 001627  8C80 0000 000C  00                   LDI      E$CONT_NOT_PART
          2 00162A  8D44 0009                            SDI      9,B4
          2 00162C  0F81 0006                            B        s:26610,PREL

     2444    26609    6                             ELSE KL$ACQUIRE.ERRCODE=E$CHAN_NOT_PART;

  26609   2 00162E  8C80 0000 001A  00                   LDI      E$CHAN_NOT_PART
          2 001631  8D44 0009                            SDI      9,B4

     2445    26610    6                             EXIT ACQUIRE;

  26610   2 001633  0F81 00A2                            B        s:26661,PREL

     2446    26611    6                             END;
     2447    26612        /*
     2448    26613          Well we finally get to the check to see if this channel can satisfy
     2449    26614          the necessary requirements.  If res and attr match up or if this is
     2450    26615          a diag acquire (we allready narrowed the range) its good.
     2451    26616        */
     2452    26617    5                        IF (KH$CHN.RESOURCE = KL$ACQUIRE.RES AND

  26617   2 001635  0022                                 ACM      ;
          2 001636       4206 0004                                ALPHANUM(4,B6,,2,FILL),;
          2 001638       4204 0006                                ALPHANUM(6,B4,,2,FILL)
          2 00163A  5301 0008                            CBNE     s:26617+14,PREL
          2 00163C  C846 0005                            LDR,R4   5,B6
          2 00163E  8654                                 CPL      R4
          2 00163F  C547 0032                            AND,R4   SVATTR,AUTO
          2 001641  4901 0005                            BEZ,R4   s:26621,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:436  
          2 001643  89C4 0008                            CMZ      8,B4
          2 001645  0881 007A                            BAGE     s:26657,PREL

     2453    26618    5                          (SVATTR &~ KH$CHN.ATTR)='0'B) OR
     2454    26619    5                          KL$ACQUIRE.DIAG
     2455    26620    6                        THEN DO;

     2456    26621    6                             IF KL$ACQUIRE.LOWCHAN=0

  26621   2 001647  C844 0003                            LDR,R4   3,B4
          2 001649  4981 0006                            BNEZ,R4  s:26623,PREL

     2457    26622    6                             THEN KL$ACQUIRE.LOWCHAN=KH$CHN.CHNBIT0_9*64;

  26622   2 00164B  C806                                 LDR,R4   ,B6
          2 00164C  C570 FFC0                            AND,R4   -64,IMO
          2 00164E  CF44 0003                            STR,R4   3,B4

     2458    26623    6                             IF KH$CHN.CHNBIT0_9*64 > KL$ACQUIRE.HIGHCHAN

  26623   2 001650  ECC5 0006                            LDB,B6   6,B5
          2 001652  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001654  D804                                 LDR,R5   ,B4
          2 001655  D570 FFC0                            AND,R5   -64,IMO
          2 001657  D946 0002                            CMR,R5   2,B6
          2 001659  0381 0003                            BLE      s:26632,PREL

     2459    26624    6                             THEN KL$ACQUIRE.HIGHCHAN=KH$CHN.CHNBIT0_9*64;

  26624   2 00165B  DF46 0002                            STR,R5   2,B6

     2460    26625        /*
     2461    26626          If we haven't allready filled in the rest of KL$ACQUIRE do it if
     2462    26627          either this is a non-diagnostic acquire or its a diagnostic acquire
     2463    26628          and we've gotten to the channel the guy originally asked for
     2464    26629          (this might be a controller request and we allways return the
     2465    26630          information for the requested channel)
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:437  
     2466    26631        */
     2467    26632    6                             IF (KL$ACQUIRE.DIAG AND SVCHAN=KH$CHN.CHNBIT0_9*64) OR

  26632   2 00165D  ECC5 0006                            LDB,B6   6,B5
          2 00165F  89C6 0008                            CMZ      8,B6
          2 001661  0881 000A                            BAGE     s:26632+15,PREL
          2 001663  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001665  D804                                 LDR,R5   ,B4
          2 001666  D570 FFC0                            AND,R5   -64,IMO
          2 001668  D947 0031                            CMR,R5   SVCHAN,AUTO
          2 00166A  0901 0009                            BE       s:26635,PREL
          2 00166C  89C6 0008                            CMZ      8,B6
          2 00166E  0801 001B                            BAL      s:26642,PREL
          2 001670  D846 0001                            LDR,R5   1,B6
          2 001672  5981 0017                            BNEZ,R5  s:26642,PREL

     2468    26633    6                               (NOT(KL$ACQUIRE.DIAG) AND KL$ACQUIRE.CHAN=0)
     2469    26634    7                             THEN DO;

     2470    26635    7                                  KL$ACQUIRE.DVCID=KH$CHN.DVCID;

  26635   2 001674  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001676  D844 0002                            LDR,R5   2,B4
          2 001678  DF46 0004                            STR,R5   4,B6

     2471    26636    7                                  KL$ACQUIRE.ATTR=KH$CHN.ATTR;

  26636   2 00167A  ECC5 0006                            LDB,B6   6,B5
          2 00167C  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 00167E  D844 0005                            LDR,R5   5,B4
          2 001680  DF46 0007                            STR,R5   7,B6

     2472    26637    7                                  KL$ACQUIRE.EXTDVCID=KH$CHN.EXTDVCID;

  26637   2 001682  ECC5 0006                            LDB,B6   6,B5
          2 001684  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001686  D844 0003                            LDR,R5   3,B4
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:438  
          2 001688  DF46 0005                            STR,R5   5,B6

     2473    26638    7                                  END;

     2474    26639        /*
     2475    26640          Fill in the channel table entry to reflect the new owner
     2476    26641        */
     2477    26642    6                             IF KL$ACQUIRE.DIAG

  26642   2 00168A  ECC5 0006                            LDB,B6   6,B5
          2 00168C  89C6 0008                            CMZ      8,B6
          2 00168E  0881 0006                            BAGE     s:26644,PREL

     2478    26643    6                             THEN KH$CHN.STT = %KH#CHN_STT_DIAG;

  26643   2 001690  5C0B                                 LDV,R5   11
          2 001691  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001693  D7C4 0001                            STH,R5   1,B4

     2479    26644    6                             IF KL$ACQUIRE.CHAN=0 OR KL$ACQUIRE.DIAG

  26644   2 001695  ECC5 0006                            LDB,B6   6,B5
          2 001697  D846 0001                            LDR,R5   1,B6
          2 001699  5901 0005                            BEZ,R5   s:26646,PREL
          2 00169B  89C6 0008                            CMZ      8,B6
          2 00169D  0881 0022                            BAGE     s:26657,PREL

     2480    26645    7                             THEN DO;

     2481    26646    7                                  KL$ACQUIRE.CHAN=KH$CHN.CHNBIT0_9*64;

  26646   2 00169F  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 0016A1  D804                                 LDR,R5   ,B4
          2 0016A2  D570 FFC0                            AND,R5   -64,IMO
          2 0016A4  DF46 0001                            STR,R5   1,B6

     2482    26647    7                                  IF KL$ACQUIRE.USER# ~= 0
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:439  

  26647   2 0016A6  ECC5 0006                            LDB,B6   6,B5
          2 0016A8  D846 000B                            LDR,R5   11,B6
          2 0016AA  5901 0007                            BEZ,R5   s:26649,PREL

     2483    26648    7                                  THEN KH$CHN.SYSID=KL$ACQUIRE.USER#;

  26648   2 0016AC  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 0016AE  DF44 0006                            STR,R5   6,B4
          2 0016B0  0F81 0009                            B        s:26650,PREL

     2484    26649    7                                  ELSE KH$CHN.SYSID = GJA$HAND_CTX.SYSID;

  26649   2 0016B2  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 0016B4  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 0016B6  C843 000E                            LDR,R4   14,B3
          2 0016B8  CF44 0006                            STR,R4   6,B4

     2485    26650    7                                  KH$CHN.HAND$ = CTX$;

  26650   2 0016BA  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 0016BC  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 0016BE  EFC4 001E                            STB,B6   30,B4

     2486    26651    7                                  END;

     2487    26652    6                             END;

     2488    26653    5                        END;

     2489    26654        /*
     2490    26655          Bump pointer to next entry
     2491    26656        */
     2492    26657    4                   CHN$=PINCRW(CHN$,SIZEW(KH$CHN));

  26657   2 0016C0  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0016C2  DBC6 0020                            LAB,B5   32,B6
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:440  
          2 0016C4  DFC7 0017                            STB,B5   CHN$,AUTO

     2493    26658    4                   BASECHAN=KH$CHN.CHNBIT0_9*64;

  26658   2 0016C6  E805                                 LDR,R6   ,B5
          2 0016C7  E570 FFC0                            AND,R6   -64,IMO
          2 0016C9  EF47 0039                            STR,R6   BASECHAN,AUTO

     2494    26659    4                   END;

  26659   2 0016CB  E947 003A                            CMR,R6   LASTCHAN,AUTO
          2 0016CD  0301 0008                            BG       s:26661,PREL
          2 0016CF  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0016D1  ED80 0000 0000  xsym                 CMB,B6   GJA_CHNHI$
          2 0016D4  0381 FF15                            BLE      s:26575,PREL

     2495    26660    3              END;

     2496    26661    2         IF KL$ACQUIRE.CHAN=0

  26661   2 0016D6  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0016D8  DCC6 0006                            LDB,B5   6,B6
          2 0016DA  E845 0001                            LDR,R6   1,B5
          2 0016DC  6981 0011                            BNEZ,R6  s:26661,PREL
          2 0016DE  CB80 0000 0000  03                   LAB,B4   0
          2 0016E1  5C01                                 LDV,R5   1
          2 0016E2  0022                                 ACM      ;
          2 0016E3       4405 0009                                ALPHANUM(9,B5,,4,FILL),;
          2 0016E5       4004 0000                                ALPHANUM(0,B4,,R5,FILL)
          2 0016E7  5301 0006                            CBNE     s:26661,PREL

     2497    26662    2           AND KL$ACQUIRE.ERRCODE = '0'B
     2498    26663    2         THEN KL$ACQUIRE.ERRCODE=E$NO_DEVICES;

  26663   2 0016E9  8C80 0000 0024  00                   LDI      E$NO_DEVICES
          2 0016EC  8D45 0009                            SDI      9,B5

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:441  
  26661   2                              SENDIT          null
     2499    26664        /*E* ERROR:  GJA-E$NO_DEVICES
     2500    26665             MESSAGE: No available devices meet the specified criteria.
     2501    26666        */
     2502    26667    2   SENDIT: ;
     2503    26668    2         CALL GJA$SEND_MSG(CTX$,KL$ACQUIRE,SIZEC(KL$ACQUIRE));

  26668   2 0016EE  ECC7 0004            SENDIT          LDB,B6   @GJA$PARAMS,AUTO
          2 0016F0  DCC6 0006                            LDB,B5   6,B6
          2 0016F2  CBF0 0018                            LAB,B4   24,IMO
          2 0016F4  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 0016F6  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0016F8  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 0016FA  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 0016FC  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0016FE  CBF0 0300                            LAB,B4   768,IMO
          2 001700  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001703       0001                            DC       s:26669,PREL

     2504    26669    2         IF KL$ACQUIRE.DIAG AND SVCHN$~=ADDR(NIL) AND KL$ACQUIRE.ERRCODE~='0'B

  26669   2 001704  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001706  DCC6 0006                            LDB,B5   6,B6
          2 001708  89C5 0008                            CMZ      8,B5
          2 00170A  0881 0846                            BAGE     s:27128,PREL
          2 00170C  8DC7 002F                            CMN      SVCHN$,AUTO
          2 00170E  0901 0842                            BE       s:27128,PREL
          2 001710  CB80 0000 0000  03                   LAB,B4   0
          2 001713  5C01                                 LDV,R5   1
          2 001714  0022                                 ACM      ;
          2 001715       4405 0009                                ALPHANUM(9,B5,,4,FILL),;
          2 001717       4004 0000                                ALPHANUM(0,B4,,R5,FILL)
          2 001719  5381 0837                            CBE      s:27128,PREL

     2505    26670    3         THEN DO;

     2506    26671        /* Clear out channels we have gotten */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:442  
     2507    26672    4              DO WHILE (SVCHN$ < CHN$);

  26672   2 00171B  CCC7 002F                            LDB,B4   SVCHN$,AUTO
          2 00171D  CDC7 0017                            CMB,B4   CHN$,AUTO
          2 00171F  0281 0831                            BGE      s:27128,PREL

     2508    26673    4                   SVCHN$->KH$CHN.STT = %KH#CHN_STT_PRT;

  26673   2 001721  6C06                                 LDV,R6   6
          2 001722  ECC7 002F                            LDB,B6   SVCHN$,AUTO
          2 001724  E7C6 0001                            STH,R6   1,B6

     2509    26674    4                   SVCHN$->KH$CHN.SYSID = 0;

  26674   2 001726  8746 0006                            CL       6,B6

     2510    26675    4                   SVCHN$->KH$CHN.HAND$ = ADDR(NIL);

  26675   2 001728  DB80 0000 0000                       LAB,B5   0
          2 00172B  DFC6 001E                            STB,B5   30,B6

     2511    26676    4                   SVCHN$ = PINCRW(SVCHN$,SIZEW(KH$CHN));

  26676   2 00172D  CBC6 0020                            LAB,B4   32,B6
          2 00172F  CFC7 002F                            STB,B4   SVCHN$,AUTO

     2512    26677    4                   END;

  26677   2 001731  CDC7 0017                            CMB,B4   CHN$,AUTO
          2 001733  026E                                 BL       s:26673,SPREL

     2513    26678    3              END;

  26678   2 001734  0F81 081C                            B        s:27128,PREL

     2514    26679        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:443  
     2515    26680    2       CASE(IGA_PRFRSP);

     2516    26681
     2517    26682    2         NMID=KL$PRFRSP.NMID;

  26682   2 001736  8CC5 0001                            LDI      1,B5
          2 001738  8D47 002D                            SDI      NMID$,AUTO

     2518    26683    2         CTX$=GJA_USRLGN_HEAD$;

  26683   2 00173A  CC80 0000 0000  xsym                 LDB,B4   GJA_USRLGN_HEAD$
          2 00173D  CFC7 0019                            STB,B4   CTX$,AUTO

     2519    26684    3         DO WHILE (CTX$ ~= ADDR(NIL));

  26684   2 00173F  0F81 000B                            B        s:26688,PREL

     2520    26685    3              IF CTX$=NMID$

  26685   2 001741  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001743  EDC7 002D                            CMB,B6   NMID$,AUTO
          2 001745  0901 0008                            BE       s:26689,PREL

     2521    26686    3              THEN EXIT;
     2522    26687    3              CTX$=CTX$->GJA$LGNCTX.LNK$;

  26687   2 001747  DCC6 0001                            LDB,B5   1,B6
          2 001749  DFC7 0019                            STB,B5   CTX$,AUTO

     2523    26688    3              END;

  26688   2 00174B  8DC7 0019                            CMN      CTX$,AUTO
          2 00174D  09F4                                 BNE      s:26685,SPREL

     2524    26689    2         IF CTX$ = ADDR(NIL)

  26689   2 00174E  8DC7 0019                            CMN      CTX$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:444  
          2 001750  0981 0005                            BNE      s:26691,PREL

     2525    26690    2         THEN CALL M$XXX;

  26690   2 001752  B870 0082                            LDR,R3   130,IMO
          2 001754  0001                                 MCL
          2 001755       0000                            DC       s:26690+3,PREL

     2526    26691    2         IF CTX$->GJA$LGNCTX.STATUS.TERMACK THEN RETURN; /* whoops, one slipped thru*/

  26691   2 001756  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001758  82C6 0018                            LB,'1000'X        24,B6
          2 00175A       1000
          2 00175B  0581 0004                            BBF      s:26692,PREL

  26691   2 00175D  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2527    26692    2         IF (CTX$->GJA$LGNCTX.STATUS.TERM OR CTX$->GJA$LGNCTX.STATUS.DSCRCV)

  26692   2 001760  89C6 0018                            CMZ      24,B6
          2 001762  0801 0006                            BAL      s:26692+9,PREL
          2 001764  82C6 0018                            LB,'0100'X        24,B6
          2 001766       0100
          2 001767  0581 006E                            BBF      s:26710,PREL
          2 001769  82C6 0018                            LB,'0200'X        24,B6
          2 00176B       0200
          2 00176C  0581 0069                            BBF      s:26710,PREL
          2 00176E  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 001770  CCC5 0006                            LDB,B4   6,B5
          2 001772  8284                                 LB,'0040'X        ,B4
          2 001773       0040
          2 001774  0501 0061                            BBT      s:26710,PREL

     2528    26693    2           AND CTX$->GJA$LGNCTX.STATUS.WTPRO AND NOT KL$PRFRSP.MORE
     2529    26694    3         THEN DO;

     2530    26695    3              IF CTX$->GJA$LGNCTX.STATUS.TERM
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:445  

  26695   2 001776  89C6 0018                            CMZ      24,B6
          2 001778  0881 0032                            BAGE     s:26702,PREL

     2531    26696    4              THEN DO;

     2532    26697    4                   CALL GJA$Q_MSG(CTX$,

  26697   2 00177A  BBF0 0004                            LAB,B3   4,IMO
          2 00177C  ABF0 0004                            LAB,B2   4,IMO
          2 00177E  AFC7 011E                            STB,B2   SUBSUB$+12,AUTO
          2 001780  CB80 0000 0000  xsym                 LAB,B4   GJA_TERM_ACK
          2 001783  CFC7 011C                            STB,B4   SUBSUB$+10,AUTO
          2 001785  BFC7 011A                            STB,B3   SUBSUB$+8,AUTO
          2 001787  9B80 0000 0000                       LAB,B1   0
          2 00178A  9FC7 0118                            STB,B1   SUBSUB$+6,AUTO
          2 00178C  EB80 0000 0000                       LAB,B6   0
          2 00178F  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 001791  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 001793  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 001795  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001797  CBF0 0600                            LAB,B4   1536,IMO
          2 001799  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 00179C       0001                            DC       s:26699,PREL

     2533    26698    4                     ,,SIZEC(GJA_TERM_ACK),GJA_TERM_ACK,%KN_FCN_TERM_ACK);
     2534    26699    4                   CALL GJA$DISOLVE_LGNUSR_CTX(CTX$);

  26699   2 00179D  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 00179F  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 0017A1  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0017A3  CBF0 0100                            LAB,B4   256,IMO
          2 0017A5  E380 0000 0000  xent                 LNJ,B6   GJA$DISOLVE_LGNUSR_CTX
          2 0017A8       0001                            DC       s:26700,PREL

     2535    26700    4                   END;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:446  
  26700   2 0017A9  0F81 0029                            B        s:26706,PREL

     2536    26701    4              ELSE DO;

     2537    26702    4                   CALL GJA$Q_MSG(CTX$,

  26702   2 0017AB  BBF0 0008                            LAB,B3   8,IMO
          2 0017AD  ABF0 0003                            LAB,B2   3,IMO
          2 0017AF  AFC7 011E                            STB,B2   SUBSUB$+12,AUTO
          2 0017B1  CB80 0000 0000  xsym                 LAB,B4   GJA_TERM
          2 0017B4  CFC7 011C                            STB,B4   SUBSUB$+10,AUTO
          2 0017B6  BFC7 011A                            STB,B3   SUBSUB$+8,AUTO
          2 0017B8  9B80 0000 0000                       LAB,B1   0
          2 0017BB  9FC7 0118                            STB,B1   SUBSUB$+6,AUTO
          2 0017BD  EB80 0000 0000                       LAB,B6   0
          2 0017C0  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 0017C2  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 0017C4  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 0017C6  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0017C8  CBF0 0600                            LAB,B4   1536,IMO
          2 0017CA  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 0017CD       0001                            DC       s:26704,PREL

     2538    26703    4                     ,,SIZEC(GJA_TERM),GJA_TERM,%KN_FCN_TERM);
     2539    26704    4                   CTX$->GJA$LGNCTX.STATUS.TERMACK = '1'B;

  26704   2 0017CE  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 0017D0  8946 0018                            LBT,'1000'X       24,B6
          2 0017D2       1000

     2540    26705    4                   END;

     2541    26706    3              RETURN;

  26706   2 0017D3  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2542    26707    3              END;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:447  
     2543    26708
     2544    26709
     2545    26710    2         IF KL$PRFRSP.IMP                  /* IMP RECORED              */

  26710   2 0017D6  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 0017D8  CCC5 0006                            LDB,B4   6,B5
          2 0017DA  8284                                 LB,'0080'X        ,B4
          2 0017DB       0080
          2 0017DC  0581 0022                            BBF      s:26716,PREL

     2546    26711    3         THEN DO;

     2547    26712    3              SIZE = KL$PRFRSP.PROFILE.PRFSIZE;

  26712   2 0017DE  E844 0003                            LDR,R6   3,B4
          2 0017E0  EF47 0034                            STR,R6   SIZE,AUTO

     2548    26713    3              CALL GJA$SEND_MSG(CTX$,KL$PRFRSP.PROFILE.PRFTXT,SIZE,%VFC_SLPP);

  26713   2 0017E2  CCC5 0006                            LDB,B4   6,B5
          2 0017E4  BB80 0000 0002  03                   LAB,B3   +2
          2 0017E7  BFC7 011A                            STB,B3   SUBSUB$+8,AUTO
          2 0017E9  ABC7 0034                            LAB,B2   SIZE,AUTO
          2 0017EB  AFC7 0118                            STB,B2   SUBSUB$+6,AUTO
          2 0017ED  9BC4 0004                            LAB,B1   4,B4
          2 0017EF  9FC7 0116                            STB,B1   SUBSUB$+4,AUTO
          2 0017F1  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 0017F3  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 0017F5  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 0017F7  CBF0 0400                            LAB,B4   1024,IMO
          2 0017F9  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 0017FC       0001                            DC       s:26714,PREL

     2549    26714    3              END;

  26714   2 0017FD  0F81 004F                            B        s:26727,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:448  
     2550    26715    3         ELSE DO;

     2551    26716    3              ADDR(VDO_BUFFER)->GJA$PROFILE_VDO=GJA_PARAM_VDO;

  26716   2 0017FF  AB80 0000 0000  xsym                 LAB,B2   GJA_PARAM_VDO
          2 001802  2C00                                 LDV,R2   0
          2 001803  6C06                                 LDV,R6   6
          2 001804  BB80 0000 0040  00                   LAB,B3   VDO_BUFFER
          2 001807  3C00                                 LDV,R3   0
          2 001808  0008                                 MMM

     2552    26717    3              ADDR(VDO_BUFFER)->GJA$PROFILE_VDO.KV$VDOVLP_DAT2.BYTSIZ=

  26717   2 001809  ECC5 0006                            LDB,B6   6,B5
          2 00180B  E846 0003                            LDR,R6   3,B6
          2 00180D  EF00 0000 0042  00                   STR,R6   VDO_BUFFER+2

     2553    26718    3                KL$PRFRSP.PROFILE.PRFSIZE;
     2554    26719    3              SIZE=KL$PRFRSP.PROFILE.PRFSIZE;

  26719   2 001810  ECC5 0006                            LDB,B6   6,B5
          2 001812  D846 0003                            LDR,R5   3,B6
          2 001814  DF47 0034                            STR,R5   SIZE,AUTO

     2555    26720    3              PINCRW(ADDR(VDO_BUFFER),SIZEW(GJA_PARAM_VDO))->STRING=

  26720   2 001816  ECC5 0006                            LDB,B6   6,B5
          2 001818  C846 0003                            LDR,R4   3,B6
          2 00181A  CF47 0114                            STR,R4   SUBSUB$+2,AUTO
          2 00181C  EFC7 0115                            STB,B6   SUBSUB$+3,AUTO
          2 00181E  AB86                                 LAB,B2   ,B6
          2 00181F  2C08                                 LDV,R2   8
          2 001820  E854                                 LDR,R6   R4
          2 001821  BB80 0000 0043  00                   LAB,B3   VDO_BUFFER+3
          2 001824  3C00                                 LDV,R3   0
          2 001825  F855                                 LDR,R7   R5
          2 001826  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:449  

     2556    26721    3                SUBSTR(KL$PRFRSP.PROFILE.PRFTXT,0,KL$PRFRSP.PROFILE.PRFSIZE);
     2557    26722    3              MSGSIZ=SIZEC(GJA_PARAM_VDO)+KL$PRFRSP.PROFILE.PRFSIZE;

  26722   2 001829  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 00182B  DCC6 0006                            LDB,B5   6,B6
          2 00182D  E845 0003                            LDR,R6   3,B5
          2 00182F  6E06                                 ADV,R6   6
          2 001830  EF47 0033                            STR,R6   MSGSIZ,AUTO

     2558    26723    3              IF KL$PRFRSP.PROFILE.PRFSIZE ~= 0

  26723   2 001832  DCC6 0006                            LDB,B5   6,B6
          2 001834  D845 0003                            LDR,R5   3,B5
          2 001836  5901 0016                            BEZ,R5   s:26727,PREL

     2559    26724    3              THEN
     2560    26725    3                   CALL GJA$Q_MSG(CTX$,MSGSIZ,ADDR(VDO_BUFFER)->GJA$PROFILE_VDO);

  26725   2 001838  CB80 0000 0040  00                   LAB,B4   VDO_BUFFER
          2 00183B  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 00183D  DBC7 0033                            LAB,B5   MSGSIZ,AUTO
          2 00183F  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001841  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 001843  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001845  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001847  CBF0 0300                            LAB,B4   768,IMO
          2 001849  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 00184C       0001                            DC       s:26727,PREL

     2561    26726    3              END;

     2562    26727    2         CTX$->GJA$LGNCTX.RETRYCNT = 0;

  26727   2 00184D  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 00184F  8846 0009                            LBF,'00FF'X       9,B6
          2 001851       00FF
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:450  

     2563    26728    2         IF CTX$->GJA$LGNCTX.STATUS.WTPRO AND NOT KL$PRFRSP.MORE

  26728   2 001852  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001854  82C6 0018                            LB,'0200'X        24,B6
          2 001856       0200
          2 001857  0581 06F9                            BBF      s:27128,PREL
          2 001859  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 00185B  CCC5 0006                            LDB,B4   6,B5
          2 00185D  8284                                 LB,'0040'X        ,B4
          2 00185E       0040
          2 00185F  0501 06F1                            BBT      s:27128,PREL

     2564    26729    2         THEN
     2565    26730    2              CALL GJA$LOGON_REQUEST_AGAIN(CTX$);

  26730   2 001861  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 001863  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001865  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001867  CBF0 0100                            LAB,B4   256,IMO
          2 001869  E380 0000 0000  xent                 LNJ,B6   GJA$LOGON_REQUEST_AGAIN
          2 00186C       0001                            DC       s:26730+12,PREL
          2 00186D  0F81 06E3                            B        s:27128,PREL

     2566    26731        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:451  
     2567    26732    2       CASE(IGA_WRITE);

     2568    26733
     2569    26734    2         NMID=KL$WRITE.NMID;

  26734   2 00186F  8CC5 0001                            LDI      1,B5
          2 001871  8D47 002D                            SDI      NMID$,AUTO

     2570    26735    2         CTX$=GJA_USRLGN_HEAD$;

  26735   2 001873  CC80 0000 0000  xsym                 LDB,B4   GJA_USRLGN_HEAD$
          2 001876  CFC7 0019                            STB,B4   CTX$,AUTO

     2571    26736    3         DO WHILE (CTX$ ~= ADDR(NIL));

  26736   2 001878  0F81 000B                            B        s:26740,PREL

     2572    26737    3              IF CTX$=NMID$

  26737   2 00187A  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 00187C  EDC7 002D                            CMB,B6   NMID$,AUTO
          2 00187E  0901 0008                            BE       s:26741,PREL

     2573    26738    3              THEN EXIT;
     2574    26739    3              CTX$=CTX$->GJA$LGNCTX.LNK$;

  26739   2 001880  DCC6 0001                            LDB,B5   1,B6
          2 001882  DFC7 0019                            STB,B5   CTX$,AUTO

     2575    26740    3              END;

  26740   2 001884  8DC7 0019                            CMN      CTX$,AUTO
          2 001886  09F4                                 BNE      s:26737,SPREL

     2576    26741    2         IF CTX$ = ADDR(NIL)

  26741   2 001887  8DC7 0019                            CMN      CTX$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:452  
          2 001889  0981 0005                            BNE      s:26743,PREL

     2577    26742    2         THEN CALL M$XXX;

  26742   2 00188B  B870 0082                            LDR,R3   130,IMO
          2 00188D  0001                                 MCL
          2 00188E       0000                            DC       s:26742+3,PREL

     2578    26743    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1=GJA_VDO_DAT_DAT1;

  26743   2 00188F  AB80 0000 0000  xsym                 LAB,B2   GJA_VDO_DAT_DAT1
          2 001892  2C00                                 LDV,R2   0
          2 001893  6C06                                 LDV,R6   6
          2 001894  BB80 0000 0040  00                   LAB,B3   VDO_BUFFER
          2 001897  3C00                                 LDV,R3   0
          2 001898  0008                                 MMM

     2579    26744    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1.KV$VDOVLP_DAT1.BYTSIZ=

  26744   2 001899  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 00189B  DCC6 0006                            LDB,B5   6,B6
          2 00189D  E2C5 0003                            LLH,R6   3,B5
          2 00189F  EA80 0000 0042  00                   SRM,R6,'00FF'X    VDO_BUFFER+2
          2 0018A2       00FF

     2580    26745    2           KL$WRITE.MESSAGE.MSGSIZE;
     2581    26746    2         SIZE = KL$WRITE.MESSAGE.MSGSIZE;

  26746   2 0018A3  DCC6 0006                            LDB,B5   6,B6
          2 0018A5  E2C5 0003                            LLH,R6   3,B5
          2 0018A7  EF47 0034                            STR,R6   SIZE,AUTO

     2582    26747    2         PINCRW(ADDR(VDO_BUFFER),SIZEW(GJA_VDO_DAT_DAT1))->STRING=

  26747   2 0018A9  DCC6 0006                            LDB,B5   6,B6
          2 0018AB  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 0018AD  AB85                                 LAB,B2   ,B5
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:453  
          2 0018AE  2C07                                 LDV,R2   7
          2 0018AF  E870 00FF                            LDR,R6   255,IMO
          2 0018B1  BB80 0000 0043  00                   LAB,B3   VDO_BUFFER+3
          2 0018B4  3C00                                 LDV,R3   0
          2 0018B5  F847 0034                            LDR,R7   SIZE,AUTO
          2 0018B7  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

     2583    26748    2           KL$WRITE.MESSAGE.MSGTXT;
     2584    26749    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1.DATCTRCHRTYP = %KV_DATCTRCHRTYP_VFC;

  26749   2 0018BA  E870 0800                            LDR,R6   2048,IMO
          2 0018BC  EA80 0000 0041  00                   SRM,R6,'0C00'X    VDO_BUFFER+1
          2 0018BF       0C00

     2585    26750    2         ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1.DATCTRCHR = %VFC_TRANSITION0;

  26750   2 0018C0  5C1E                                 LDV,R5   30
          2 0018C1  DA80 0000 0041  00                   SRM,R5,'00FF'X    VDO_BUFFER+1
          2 0018C4       00FF

     2586    26751    2         MSGSIZ=SIZEC(GJA_VDO_DAT_DAT1)+KL$WRITE.MESSAGE.MSGSIZE;

  26751   2 0018C5  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0018C7  DCC6 0006                            LDB,B5   6,B6
          2 0018C9  C2C5 0003                            LLH,R4   3,B5
          2 0018CB  4E06                                 ADV,R4   6
          2 0018CC  CF47 0033                            STR,R4   MSGSIZ,AUTO

     2587    26752    2         CALL GJA$Q_MSG(CTX$,MSGSIZ,ADDR(VDO_BUFFER)->GJA$VDO_DAT_DAT1);

  26752   2 0018CE  DB80 0000 0040  00                   LAB,B5   VDO_BUFFER
          2 0018D1  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 0018D3  CBC7 0033                            LAB,B4   MSGSIZ,AUTO
          2 0018D5  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 0018D7  BBC7 0019                            LAB,B3   CTX$,AUTO
          2 0018D9  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 0018DB  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:454  
          2 0018DD  CBF0 0300                            LAB,B4   768,IMO
          2 0018DF  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 0018E2       0001                            DC       s:26752+21,PREL
          2 0018E3  0F81 066D                            B        s:27128,PREL

     2588    26753        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:455  
     2589    26754    2       CASE(IGA_LINE_RELEASE);

     2590    26755
     2591    26756    2         SVCHAN=KL$RELEASE.CHAN;

  26756   2 0018E5  E845 0001                            LDR,R6   1,B5
          2 0018E7  EF47 0031                            STR,R6   SVCHAN,AUTO

     2592    26757    2         KL$TERMINAL_ID.LEV=%TERMINAL_ID_LEV_CHAN#;

  26757   2 0018E9  5C01                                 LDV,R5   1
          2 0018EA  DAC7 0046                            SRM,R5,'00FF'X    KL$TERMINAL_ID,AUTO
          2 0018EC       00FF

     2593    26758    2         KL$TERMINAL_ID.TERM.CHANNEL=KL$RELEASE.CHAN;

  26758   2 0018ED  DCC6 0006                            LDB,B5   6,B6
          2 0018EF  C845 0001                            LDR,R4   1,B5
          2 0018F1  CF47 0047                            STR,R4   KL$TERMINAL_ID+1,AUTO

     2594    26759    2         KL$RELEASE.ERRCODE=E$CHAN_NOT_THERE;

  26759   2 0018F3  DCC6 0006                            LDB,B5   6,B6
          2 0018F5  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 0018F8  8D45 0004                            SDI      4,B5

     2595    26760    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)

  26760   2 0018FA  DBC7 0017                            LAB,B5   CHN$,AUTO
          2 0018FC  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 0018FE  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 001900  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001902  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001904  CBF0 0200                            LAB,B4   512,IMO
          2 001906  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 001909       0003                            DC       s:26762,PREL
          2 00190A  0F81 0005                            B        s:26766,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:456  

     2596    26761    3         WHENALTRETURN DO;

     2597    26762    3              IF SVCHAN ~= 0

  26762   2 00190C  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 00190E  6981 0114                            BNEZ,R6  s:26841,PREL

     2598    26763    3              THEN
     2599    26764    3                   GOTO SCRAP;
     2600    26765    3              END;

     2601    26766    2         KL$RELEASE.ERRCODE='0'B;

  26766   2 001910  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001912  DCC6 0006                            LDB,B5   6,B6
          2 001914  8745 0004                            CL       4,B5
          2 001916  8745 0005                            CL       5,B5

     2602    26767    2         IF KL$RELEASE.CONTROLLER

  26767   2 001918  DCC6 0006                            LDB,B5   6,B6
          2 00191A  89C5 0002                            CMZ      2,B5
          2 00191C  0881 0039                            BAGE     s:26785,PREL

     2603    26768    3         THEN DO;                          /* CONTROLLER               */

     2604    26769    3              IF (KH$CHN.DVCID&'FF00'X) = %GJA_DVCID_MLCP#

  26769   2 00191E  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001920  E844 0002                            LDR,R6   2,B4
          2 001922  E570 FF00                            AND,R6   -256,IMO
          2 001924  E970 2100                            CMR,R6   8448,IMO
          2 001926  0981 0010                            BNE      s:26774,PREL

     2605    26770    4              THEN DO;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:457  
     2606    26771    4                   BASECHAN=SVCHAN-MOD(SVCHAN,1024/*'400'X*/);

  26771   2 001928  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 00192A  E570 03FF                            AND,R6   1023,IMO
          2 00192C  E247 0031                            SUB,R6   SVCHAN,AUTO
          2 00192E  8256                                 NEG      R6
          2 00192F  EF47 0039                            STR,R6   BASECHAN,AUTO

     2607    26772    4                   LASTCHAN=BASECHAN+(896/*'400'X-'80'X*/);

  26772   2 001931  EA70 0380                            ADD,R6   896,IMO
          2 001933  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2608    26773    4                   END;

  26773   2 001935  0F81 0026                            B        s:26788,PREL

     2609    26774    3              ELSE IF (KH$CHN.DVCID&'FF00'X) = %GJA_DVCID_NMLC#

  26774   2 001937  E844 0002                            LDR,R6   2,B4
          2 001939  E570 FF00                            AND,R6   -256,IMO
          2 00193B  E970 2900                            CMR,R6   10496,IMO
          2 00193D  0981 0010                            BNE      s:26780,PREL

     2610    26775    4                   THEN DO;

     2611    26776    4                        BASECHAN=SVCHAN-MOD(SVCHAN,2048/*'800'X*/);

  26776   2 00193F  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 001941  E570 07FF                            AND,R6   2047,IMO
          2 001943  E247 0031                            SUB,R6   SVCHAN,AUTO
          2 001945  8256                                 NEG      R6
          2 001946  EF47 0039                            STR,R6   BASECHAN,AUTO

     2612    26777    4                        LASTCHAN=BASECHAN+(1920/*'800'X-'80'X*/);

  26777   2 001948  EA70 0780                            ADD,R6   1920,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:458  
          2 00194A  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2613    26778    4                        END;

  26778   2 00194C  0F81 000F                            B        s:26788,PREL

     2614    26779    4                   ELSE DO;

     2615    26780    4                        BASECHAN=SVCHAN;

  26780   2 00194E  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 001950  EF47 0039                            STR,R6   BASECHAN,AUTO

     2616    26781    4                        LASTCHAN=SVCHAN;

  26781   2 001952  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2617    26782    4                        END;

     2618    26783    3              END;

  26783   2 001954  0F81 0007                            B        s:26788,PREL

     2619    26784    3         ELSE DO;

     2620    26785    3              BASECHAN=SVCHAN;

  26785   2 001956  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 001958  EF47 0039                            STR,R6   BASECHAN,AUTO

     2621    26786    3              LASTCHAN=SVCHAN;

  26786   2 00195A  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2622    26787    3              END;

     2623    26788    2         IF SVCHAN = 0
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:459  

  26788   2 00195C  D847 0031                            LDR,R5   SVCHAN,AUTO
          2 00195E  5981 0008                            BNEZ,R5  s:26793,PREL

     2624    26789    3         THEN DO;

     2625    26790    3              BASECHAN = 0;

  26790   2 001960  8747 0039                            CL       BASECHAN,AUTO

     2626    26791    3              LASTCHAN = GJA_CHNHI;

  26791   2 001962  E800 0000 0000  xsym                 LDR,R6   GJA_CHNHI
          2 001965  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2627    26792    3              END;

     2628    26793    2         KL$TERMINAL_ID.TERM.CHANNEL=BASECHAN;

  26793   2 001967  C847 0039                            LDR,R4   BASECHAN,AUTO
          2 001969  CF47 0047                            STR,R4   KL$TERMINAL_ID+1,AUTO

     2629    26794    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);

  26794   2 00196B  DBC7 0017                            LAB,B5   CHN$,AUTO
          2 00196D  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 00196F  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 001971  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001973  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001975  CBF0 0200                            LAB,B4   512,IMO
          2 001977  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 00197A       0001                            DC       s:26795,PREL

     2630    26795    2         STARTCHN$=CHN$;

  26795   2 00197B  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 00197D  EFC7 0011                            STB,B6   STARTCHN$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:460  

     2631    26796    2         IF SVCHAN ~= 0               /* Not all channels for user     */

  26796   2 00197F  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 001981  6901 003B                            BEZ,R6   s:26817,PREL

     2632    26797    2         THEN
     2633    26798    3   CHECK: DO WHILE (BASECHAN <= LASTCHAN);

  26798   2 001983  D847 0039            CHECK           LDR,R5   BASECHAN,AUTO
          2 001985  D947 003A                            CMR,R5   LASTCHAN,AUTO
          2 001987  0301 0035                            BG       s:26817,PREL

     2634    26799    3              IF BASECHAN ~= 0

  26799   2 001989  E847 0039                            LDR,R6   BASECHAN,AUTO
          2 00198B  6901 0023                            BEZ,R6   s:26814,PREL

     2635    26800    4              THEN DO;

     2636    26801    4                   IF KL$RELEASE.USER# ~= 0

  26801   2 00198D  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 00198F  DCC6 0006                            LDB,B5   6,B6
          2 001991  D845 0003                            LDR,R5   3,B5
          2 001993  5901 001B                            BEZ,R5   s:26814,PREL

     2637    26802    4                   THEN IF KH$CHN.SYSID ~= KL$RELEASE.USER#

  26802   2 001995  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 001997  D944 0006                            CMR,R5   6,B4
          2 001999  0901 0008                            BE       s:26808,PREL

     2638    26803    5                        THEN DO;

     2639    26804    5                             KL$RELEASE.ERRCODE=E$NOTYOURS;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:461  
  26804   2 00199B  8C80 0000 0026  00                   LDI      E$NOTYOURS
          2 00199E  8D45 0004                            SDI      4,B5

     2640    26805    5                             EXIT CHECK;

  26805   2 0019A0  0F81 001C                            B        s:26817,PREL

     2641    26806    5                             END;
     2642    26807    4                        ELSE
     2643    26808    4                             IF KH$CHN.HAND$ ~= CTX$

  26808   2 0019A2  BCC4 001E                            LDB,B3   30,B4
          2 0019A4  BDC7 0019                            CMB,B3   CTX$,AUTO
          2 0019A6  0901 0008                            BE       s:26814,PREL

     2644    26809    5                             THEN DO;

     2645    26810    5                                  KL$RELEASE.ERRCODE=E$NOTYOURS;

  26810   2 0019A8  8C80 0000 0026  00                   LDI      E$NOTYOURS
          2 0019AB  8D45 0004                            SDI      4,B5

     2646    26811    5                                  EXIT CHECK;

  26811   2 0019AD  0F81 000F                            B        s:26817,PREL

     2647    26812    5                                  END;
     2648    26813    4                   END;
     2649    26814    3              CHN$=PINCRW(CHN$,SIZEW(KH$CHN));

  26814   2 0019AF  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 0019B1  DBC6 0020                            LAB,B5   32,B6
          2 0019B3  DFC7 0017                            STB,B5   CHN$,AUTO

     2650    26815    3              BASECHAN=KH$CHN.CHNBIT0_9*64;

  26815   2 0019B5  E805                                 LDR,R6   ,B5
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:462  
          2 0019B6  E570 FFC0                            AND,R6   -64,IMO
          2 0019B8  EF47 0039                            STR,R6   BASECHAN,AUTO

     2651    26816    3              END;

  26816   2 0019BA  E947 003A                            CMR,R6   LASTCHAN,AUTO
          2 0019BC  03CD                                 BLE      s:26799,SPREL

     2652    26817    2         IF KL$RELEASE.ERRCODE = '0'B

  26817   2 0019BD  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0019BF  DCC6 0006                            LDB,B5   6,B6
          2 0019C1  CB80 0000 0000  03                   LAB,B4   0
          2 0019C4  5C01                                 LDV,R5   1
          2 0019C5  0022                                 ACM      ;
          2 0019C6       4405 0004                                ALPHANUM(4,B5,,4,FILL),;
          2 0019C8       4004 0000                                ALPHANUM(0,B4,,R5,FILL)
          2 0019CA  5301 0054                            CBNE     s:26839,PREL

     2653    26818    3         THEN DO;

     2654    26819    3              CHN$=STARTCHN$;

  26819   2 0019CC  CCC7 0011                            LDB,B4   STARTCHN$,AUTO
          2 0019CE  CFC7 0017                            STB,B4   CHN$,AUTO

     2655    26820    3              BASECHAN=KH$CHN.CHNBIT0_9*64;

  26820   2 0019D0  E804                                 LDR,R6   ,B4
          2 0019D1  E570 FFC0                            AND,R6   -64,IMO
          2 0019D3  EF47 0039                            STR,R6   BASECHAN,AUTO

     2656    26821    4   CHN:       DO WHILE (BASECHAN <= LASTCHAN);

  26821   2 0019D5  E947 003A            CHN             CMR,R6   LASTCHAN,AUTO
          2 0019D7  0301 0047                            BG       s:26839,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:463  
     2657    26822    4                   IF KH$CHN.SYSID = KL$RELEASE.USER#

  26822   2 0019D9  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 0019DB  DCC6 0006                            LDB,B5   6,B6
          2 0019DD  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 0019DF  E844 0006                            LDR,R6   6,B4
          2 0019E1  E945 0003                            CMR,R6   3,B5
          2 0019E3  0981 0027                            BNE      s:26833,PREL

     2658    26823    5                   THEN DO;

     2659    26824    5                        KH$CHN.SYSID=0;

  26824   2 0019E5  8744 0006                            CL       6,B4

     2660    26825    5                        KH$CHN.HAND$=ADDR(NIL);

  26825   2 0019E7  DB80 0000 0000                       LAB,B5   0
          2 0019EA  CCC7 0017                            LDB,B4   CHN$,AUTO
          2 0019EC  DFC4 001E                            STB,B5   30,B4

     2661    26826    5                        IF KH$CHN.STT = %KH#CHN_STT_DIAG

  26826   2 0019EE  E2C4 0001                            LLH,R6   1,B4
          2 0019F0  6D0B                                 CMV,R6   11
          2 0019F1  0981 0004                            BNE      s:26829,PREL

     2662    26827    5                        THEN
     2663    26828    5                             KH$CHN.STT = %KH#CHN_STT_PRT;

  26828   2 0019F3  5C06                                 LDV,R5   6
          2 0019F4  D7C4 0001                            STH,R5   1,B4

     2664    26829    5                        IF KH$CHN.DVCID ~= '0'B

  26829   2 0019F6  DCC7 0017                            LDB,B5   CHN$,AUTO
          2 0019F8  E845 0002                            LDR,R6   2,B5
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:464  
          2 0019FA  6901 0010                            BEZ,R6   s:26833,PREL

     2665    26830    5                        THEN
     2666    26831    5                             CALL KHI$IO_OTP(KH$CHN,GJA_IO);

  26831   2 0019FC  CB80 0000 0000  xsym                 LAB,B4   GJA_IO
          2 0019FF  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001A01  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 001A03  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001A05  CBF0 0200                            LAB,B4   512,IMO
          2 001A07  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTP
          2 001A0A       0001                            DC       s:26833,PREL

     2667    26832    5                        END;

     2668    26833    4                   CHN$=PINCRW(CHN$,SIZEW(KH$CHN));

  26833   2 001A0B  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001A0D  DBC6 0020                            LAB,B5   32,B6
          2 001A0F  DFC7 0017                            STB,B5   CHN$,AUTO

     2669    26834    4                   IF CHN$ > GJA_CHNHI$ THEN

  26834   2 001A11  DD80 0000 0000  xsym                 CMB,B5   GJA_CHNHI$
          2 001A14  0301 000A                            BG       s:26839,PREL

     2670    26835    4                        EXIT CHN;
     2671    26836    4                   BASECHAN=KH$CHN.CHNBIT0_9*64;

  26836   2 001A16  E805                                 LDR,R6   ,B5
          2 001A17  E570 FFC0                            AND,R6   -64,IMO
          2 001A19  EF47 0039                            STR,R6   BASECHAN,AUTO

     2672    26837    4                   END;

  26837   2 001A1B  E947 003A                            CMR,R6   LASTCHAN,AUTO
          2 001A1D  0381 FFBB                            BLE      s:26822,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:465  

     2673    26838    3              END;

     2674    26839    2         IF SVCHAN ~= 0

  26839   2 001A1F  E847 0031                            LDR,R6   SVCHAN,AUTO
          2 001A21  6901 052F                            BEZ,R6   s:27128,PREL

     2675    26840    2         THEN
     2676    26841    2   SCRAP:     CALL GJA$SEND_MSG(UID$,KL$RELEASE,SIZEC(KL$RELEASE));

  26841   2 001A23  ECC7 0004            SCRAP           LDB,B6   @GJA$PARAMS,AUTO
          2 001A25  DCC6 0006                            LDB,B5   6,B6
          2 001A27  CBF0 000C                            LAB,B4   12,IMO
          2 001A29  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 001A2B  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001A2D  BBC7 001B                            LAB,B3   UID,AUTO
          2 001A2F  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001A31  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001A33  CBF0 0300                            LAB,B4   768,IMO
          2 001A35  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001A38       0001                            DC       s:26841+22,PREL
          2 001A39  0F81 0517                            B        s:27128,PREL

     2677    26842        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:466  
     2678    26843    2       CASE(IGA_CONFIGRQS);

     2679    26844        /*
     2680    26845          Setup the start of the response
     2681    26846        */
     2682    26847    2         RSP$=ADDR(VDO_BUFFER);

  26847   2 001A3B  CB80 0000 0040  00                   LAB,B4   VDO_BUFFER
          2 001A3E  CFC7 0035                            STB,B4   RSP$,AUTO

     2683    26848    2         KL$CONFIGRSP='0'B;

  26848   2 001A40  5C18                                 LDV,R5   24
          2 001A41  0021                                 ALR      ;
          2 001A42       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 001A44       4004 0000                                ALPHANUM(0,B4,,R5,FILL)

     2684    26849    2         KL$CONFIGRSP.FCN=IGA_CONFIGRSP;

  26849   2 001A46  6C44                                 LDV,R6   68
          2 001A47  437F                                 CSYNC    s:26849,SPREL
          2 001A48  DCC7 0035                            LDB,B5   RSP$,AUTO
          2 001A4A  E785                                 STH,R6   ,B5

     2685    26850    2         KL$CONFIGRSP.MSGID=KL$CONFIGRQS.MSGID;

  26850   2 001A4B  DCC6 0006                            LDB,B5   6,B6
          2 001A4D  8CC5 0002                            LDI      2,B5
          2 001A4F  CCC7 0035                            LDB,B4   RSP$,AUTO
          2 001A51  8D44 0002                            SDI      2,B4

     2686    26851    2         KL$CONFIGRSP.NODE=KL$CONFIGRQS.SRC_NODE;

  26851   2 001A53  DCC6 0006                            LDB,B5   6,B6
          2 001A55  E845 0004                            LDR,R6   4,B5
          2 001A57  E570 00FF                            AND,R6   255,IMO
          2 001A59  CCC7 0035                            LDB,B4   RSP$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:467  
          2 001A5B  E7C4 0004                            STH,R6   4,B4

     2687    26852        /*
     2688    26853          A user in the host has asked for the configuration of a given
     2689    26854          channel.  Lets give him what he deserves.  If he is a diagnostic
     2690    26855          user and the controller bit is set, we have to scan each device
     2691    26856          on this controller, and if they are all not in a state where
     2692    26857          T&Ds can acquire them, we report an error.
     2693    26858        */
     2694    26859    2         KL$TERMINAL_ID.LEV=%TERMINAL_ID_LEV_CHAN#;

  26859   2 001A5D  6C01                                 LDV,R6   1
          2 001A5E  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 001A60       00FF

     2695    26860    2         KL$TERMINAL_ID.TERM.CHANNEL=KL$CONFIGRQS.CHANNEL;

  26860   2 001A61  DCC6 0006                            LDB,B5   6,B6
          2 001A63  C845 000A                            LDR,R4   10,B5
          2 001A65  CF47 0047                            STR,R4   KL$TERMINAL_ID+1,AUTO

     2696    26861    2         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$)

  26861   2 001A67  DBC7 0017                            LAB,B5   CHN$,AUTO
          2 001A69  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001A6B  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 001A6D  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001A6F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001A71  CBF0 0200                            LAB,B4   512,IMO
          2 001A73  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 001A76       0003                            DC       s:26863,PREL
          2 001A77  0F81 0007                            B        s:26870,PREL

     2697    26862    3         WHENALTRETURN DO;

     2698    26863    3              KL$CONFIGRSP.STATUS = 0;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:468  
  26863   2 001A79  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 001A7B  87C6 0005                            CLH      5,B6

     2699    26864    3              GOTO CONFIG_XIT;

  26864   2 001A7D  0F81 00A8                            B        s:26906,PREL

     2700    26865    3              END;
     2701    26866        /*
     2702    26867          The channel exists.  We allways fill in the channel information for
     2703    26868          the actual channel requested, before we make further checks.
     2704    26869        */
     2705    26870    2         I=KH$CHN.STT;

  26870   2 001A7F  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001A81  E2C6 0001                            LLH,R6   1,B6
          2 001A83  EF47 0015                            STR,R6   I,AUTO

     2706    26871    2         IF KH$CHN.DVCID = '0'B

  26871   2 001A85  D846 0002                            LDR,R5   2,B6
          2 001A87  5981 0007                            BNEZ,R5  s:26876,PREL

     2707    26872    3         THEN DO;

     2708    26873    3              KL$CONFIGRSP.STATUS = 0;

  26873   2 001A89  DCC7 0035                            LDB,B5   RSP$,AUTO
          2 001A8B  87C5 0005                            CLH      5,B5

     2709    26874    3              GOTO CONFIG_XIT;

  26874   2 001A8D  0F81 0098                            B        s:26906,PREL

     2710    26875    3              END;
     2711    26876    2         CALL CONVERT_STATE (I);

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:469  
  26876   2 001A8F  DBC7 0015                            LAB,B5   I,AUTO
          2 001A91  DFC7 010A                            STB,B5   OSILINKCHG+18,AUTO
          2 001A93  E3C0 0729                            LNJ,B6   s:0,PREL
          2 001A95       0001                            DC       s:26877,PREL

     2712    26877    2         KL$CONFIGRSP.STATUS = I;

  26877   2 001A96  E847 0015                            LDR,R6   I,AUTO
          2 001A98  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 001A9A  E7C6 0005                            STH,R6   5,B6

     2713    26878    2         KL$CONFIGRSP.DVCID=KH$CHN.DVCID;

  26878   2 001A9C  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 001A9E  DCC7 0017                            LDB,B5   CHN$,AUTO
          2 001AA0  E845 0002                            LDR,R6   2,B5
          2 001AA2  EF46 0006                            STR,R6   6,B6

     2714    26879    2         KL$CONFIGRSP.EXTDVCID=KH$CHN.EXTDVCID;

  26879   2 001AA4  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 001AA6  DCC7 0017                            LDB,B5   CHN$,AUTO
          2 001AA8  E845 0003                            LDR,R6   3,B5
          2 001AAA  EF46 0007                            STR,R6   7,B6

     2715    26880    2         IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_MLCP#

  26880   2 001AAC  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001AAE  E846 0002                            LDR,R6   2,B6
          2 001AB0  E570 FF00                            AND,R6   -256,IMO
          2 001AB2  E970 2100                            CMR,R6   8448,IMO
          2 001AB4  0981 0010                            BNE      s:26886,PREL

     2716    26881    3         THEN DO;

     2717    26882    3             BASECHAN=KL$TERMINAL_ID.TERM.CHANNEL-MOD(KL$TERMINAL_ID.TERM.CHANNEL,1024
             26882                       /*'400'X*/);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:470  

  26882   2 001AB6  E847 0047                            LDR,R6   KL$TERMINAL_ID+1,AUTO
          2 001AB8  E570 03FF                            AND,R6   1023,IMO
          2 001ABA  E247 0047                            SUB,R6   KL$TERMINAL_ID+1,AUTO
          2 001ABC  8256                                 NEG      R6
          2 001ABD  EF47 0039                            STR,R6   BASECHAN,AUTO

     2718    26883    3              LASTCHAN=BASECHAN+(896/*'400'X-'80'X*/);

  26883   2 001ABF  EA70 0380                            ADD,R6   896,IMO
          2 001AC1  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2719    26884    3              END;

  26884   2 001AC3  0F81 001E                            B        s:26895,PREL

     2720    26885    2         ELSE
     2721    26886    2              IF (KH$CHN.DVCID&'FF00'X)=%GJA_DVCID_NMLC#

  26886   2 001AC5  E846 0002                            LDR,R6   2,B6
          2 001AC7  E570 FF00                            AND,R6   -256,IMO
          2 001AC9  E970 2900                            CMR,R6   10496,IMO
          2 001ACB  0981 0010                            BNE      s:26892,PREL

     2722    26887    3              THEN DO;

     2723    26888    3                  BASECHAN=KL$TERMINAL_ID.TERM.CHANNEL-MOD(KL$TERMINAL_ID.TERM.CHANNEL
             26888                            ,2048/*'800'X*/);

  26888   2 001ACD  E847 0047                            LDR,R6   KL$TERMINAL_ID+1,AUTO
          2 001ACF  E570 07FF                            AND,R6   2047,IMO
          2 001AD1  E247 0047                            SUB,R6   KL$TERMINAL_ID+1,AUTO
          2 001AD3  8256                                 NEG      R6
          2 001AD4  EF47 0039                            STR,R6   BASECHAN,AUTO

     2724    26889    3                   LASTCHAN=BASECHAN+(1920/*'800'X-'80'X*/);

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:471  
  26889   2 001AD6  EA70 0780                            ADD,R6   1920,IMO
          2 001AD8  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2725    26890    3                   END;

  26890   2 001ADA  0F81 0007                            B        s:26895,PREL

     2726    26891    3              ELSE DO;

     2727    26892    3                   BASECHAN=KL$TERMINAL_ID.TERM.CHANNEL;

  26892   2 001ADC  E847 0047                            LDR,R6   KL$TERMINAL_ID+1,AUTO
          2 001ADE  EF47 0039                            STR,R6   BASECHAN,AUTO

     2728    26893    3                   LASTCHAN=KL$TERMINAL_ID.TERM.CHANNEL;

  26893   2 001AE0  EF47 003A                            STR,R6   LASTCHAN,AUTO

     2729    26894    3                   END;

     2730    26895    2         IF BASECHAN ~= LASTCHAN

  26895   2 001AE2  E947 0039                            CMR,R6   BASECHAN,AUTO
          2 001AE4  0901 0041                            BE       s:26906,PREL

     2731    26896    3         THEN DO;

     2732    26897    3              KL$TERMINAL_ID.TERM.CHANNEL=BASECHAN;

  26897   2 001AE6  D847 0039                            LDR,R5   BASECHAN,AUTO
          2 001AE8  DF47 0047                            STR,R5   KL$TERMINAL_ID+1,AUTO

     2733    26898    3              CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$);

  26898   2 001AEA  DBC7 0017                            LAB,B5   CHN$,AUTO
          2 001AEC  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001AEE  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:472  
          2 001AF0  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001AF2  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001AF4  CBF0 0200                            LAB,B4   512,IMO
          2 001AF6  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 001AF9       0001                            DC       s:26899,PREL

     2734    26899    4              DO WHILE (KH$CHN.CHNBIT0_9*64 <= LASTCHAN);

  26899   2 001AFA  0F81 0023                            B        s:26905,PREL

     2735    26900    4                   I = KH$CHN.STT;

  26900   2 001AFC  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001AFE  E2C6 0001                            LLH,R6   1,B6
          2 001B00  EF47 0015                            STR,R6   I,AUTO

     2736    26901    4                   CALL CONVERT_STATE (I);

  26901   2 001B02  DBC7 0015                            LAB,B5   I,AUTO
          2 001B04  DFC7 010A                            STB,B5   OSILINKCHG+18,AUTO
          2 001B06  E3C0 06B6                            LNJ,B6   s:0,PREL
          2 001B08       0001                            DC       s:26902,PREL

     2737    26902    4                   IF I > KL$CONFIGRSP.CTLR_STATUS

  26902   2 001B09  ECC7 0035                            LDB,B6   RSP$,AUTO
          2 001B0B  E846 0004                            LDR,R6   4,B6
          2 001B0D  E570 00FF                            AND,R6   255,IMO
          2 001B0F  E947 0015                            CMR,R6   I,AUTO
          2 001B11  0281 0006                            BGE      s:26904,PREL

     2738    26903    4                   THEN KL$CONFIGRSP.CTLR_STATUS = I;

  26903   2 001B13  D847 0015                            LDR,R5   I,AUTO
          2 001B15  DAC6 0004                            SRM,R5,'00FF'X    4,B6
          2 001B17       00FF

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:473  
     2739    26904    4                   CHN$=PINCRW(CHN$,SIZEW(KH$CHN));

  26904   2 001B18  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001B1A  DBC6 0020                            LAB,B5   32,B6
          2 001B1C  DFC7 0017                            STB,B5   CHN$,AUTO

     2740    26905    4                   END;

  26905   2 001B1E  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001B20  E806                                 LDR,R6   ,B6
          2 001B21  E570 FFC0                            AND,R6   -64,IMO
          2 001B23  E947 003A                            CMR,R6   LASTCHAN,AUTO
          2 001B25  03D7                                 BLE      s:26900,SPREL

     2741    26906    3              END;

     2742    26907    2   CONFIG_XIT: CALL GJA$SEND_MSG(UID$,KL$CONFIGRSP,SIZEC(KL$CONFIGRSP));

  26907   2 001B26  EBF0 0018            CONFIG_XIT      LAB,B6   24,IMO
          2 001B28  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 001B2A  DCC7 0035                            LDB,B5   RSP$,AUTO
          2 001B2C  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001B2E  CBC7 001B                            LAB,B4   UID,AUTO
          2 001B30  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001B32  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001B34  CBF0 0300                            LAB,B4   768,IMO
          2 001B36  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001B39       0001                            DC       s:26906+20,PREL
          2 001B3A  0F81 0416                            B        s:27128,PREL

     2743    26908        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:474  
     2744    26909    2       CASE(IGA_KMSG,IGA_SYSLOG);          /* Keyin message            */

     2745    26910    2         CALL GJA$NETWORK_MANAGER(KL$KEYMES,GJA$PARAMS.DATSIZE);

  26910   2 001B3C  CBC6 0008                            LAB,B4   8,B6
          2 001B3E  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001B40  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 001B42  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001B44  CBF0 0200                            LAB,B4   512,IMO
          2 001B46  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 001B49       0001                            DC       s:26910+14,PREL
          2 001B4A  0F81 0406                            B        s:27128,PREL

     2746    26911        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:475  
     2747    26912    2       CASE(IGA_DVCERRRSP);

     2748    26913    2         KL$TERMINAL_ID = KL$DVCERRRSP.TERMID;

  26913   2 001B4C  AB85                                 LAB,B2   ,B5
          2 001B4D  2C04                                 LDV,R2   4
          2 001B4E  6C10                                 LDV,R6   16
          2 001B4F  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 001B51  3C00                                 LDV,R3   0
          2 001B52  0008                                 MMM

     2749    26914    3         CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;

  26914   2 001B53  CBC7 0017                            LAB,B4   CHN$,AUTO
          2 001B55  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001B57  BBC7 0046                            LAB,B3   KL$TERMINAL_ID,AUTO
          2 001B59  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001B5B  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001B5D  CBF0 0200                            LAB,B4   512,IMO
          2 001B5F  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 001B62       0003                            DC       s:26915,PREL
          2 001B63  0F81 0004                            B        s:26917,PREL

     2750    26915    3              ALTRETURN;

  26915   2 001B65  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

     2751    26916    3              END;                         /* WHENALTRETURN            */
     2752    26917    2         IF KH$CHN.HAND$ = ADDR(NIL) THEN ALTRETURN;

  26917   2 001B68  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001B6A  8DC6 001E                            CMN      30,B6
          2 001B6C  0981 0004                            BNE      s:26918,PREL

  26917   2 001B6E  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

     2753    26918    2         CALL GJA$SEND_MSG(KH$CHN.HAND$,GJA$PARAMS.DAT$->BUFFER,GJA$PARAMS.DATSIZE);
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:476  

  26918   2 001B71  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 001B73  CCC5 0006                            LDB,B4   6,B5
          2 001B75  BBC5 0008                            LAB,B3   8,B5
          2 001B77  BFC7 0118                            STB,B3   SUBSUB$+6,AUTO
          2 001B79  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001B7B  ABC6 001E                            LAB,B2   30,B6
          2 001B7D  AFC7 0114                            STB,B2   SUBSUB$+2,AUTO
          2 001B7F  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001B81  CBF0 0300                            LAB,B4   768,IMO
          2 001B83  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001B86       0001                            DC       s:26918+22,PREL
          2 001B87  0F81 03C9                            B        s:27128,PREL

     2754    26919        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:477  
     2755    26920    2       CASE(IGA_FEPST);               /* Change in state of network    */

     2756    26921    3         DO CASE (KL$FEPST.PROB);

  26921   2 001B89  9845 0001                            LDR,R1   1,B5
          2 001B8B  1EEF                                 ADV,R1   -17
          2 001B8C  1D03                                 CMV,R1   3
          2 001B8D  0281 03C3                            BGE      s:27128,PREL
          2 001B8F  B810 0000 1B95  02                   LDR,R3   s:26921+12,R1
          2 001B92  83B0 0000 1B98  02                   JMP      CONTACT_NA,R3
          2 001B95       0000                            DC       s:26923,PREL
          2 001B96       00F9                            DC       s:26971,PREL
          2 001B97       0156                            DC       s:26991,PREL

     2757    26922
     2758    26923    3          CASE (KIER_LNKUP);

     2759    26924    3   CONTACT_NA: ;

  26924   2                              CONTACT_NA      null
     2760    26925    3            ROUTE$ = KNN$ROUTE$(KL$FEPST.FEP);

  26925   2 001B98  ECC7 0004            CONTACT_NA      LDB,B6   @GJA$PARAMS,AUTO
          2 001B9A  DCC6 0006                            LDB,B5   6,B6
          2 001B9C  B805                                 LDR,R3   ,B5
          2 001B9D  B570 00FF                            AND,R3   255,IMO
          2 001B9F  CC80 0000 0000  xsym                 LDB,B4   GJA_ROUTE$
          2 001BA2  BCB4                                 LDB,B3   ,B4,R3
          2 001BA3  BFC7 000F                            STB,B3   ROUTE$,AUTO

     2761    26926    3            CTX$ = KNN$ROUTE.CTX$;

  26926   2 001BA5  ACC3 0002                            LDB,B2   2,B3
          2 001BA7  AFC7 0019                            STB,B2   CTX$,AUTO

     2762    26927    3            IF KNN$ROUTE.CTX$ = ADDR(NIL)

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:478  
  26927   2 001BA9  8DC3 0002                            CMN      2,B3
          2 001BAB  0981 00DA                            BNE      s:26967,PREL

     2763    26928    4            THEN DO;

     2764    26929    5                IF KL$FEPST.PROB=KIER_LNKUP AND NOT KNN$ROUTE.FLAGS.HOST_NODE THEN DO;

  26929   2 001BAD  DCC6 0006                            LDB,B5   6,B6
          2 001BAF  E845 0001                            LDR,R6   1,B5
          2 001BB1  6D11                                 CMV,R6   17
          2 001BB2  0981 0036                            BNE      s:26942,PREL
          2 001BB4  89C3 0007                            CMZ      7,B3
          2 001BB6  0801 0032                            BAL      s:26942,PREL

     2765    26930        /*
     2766    26931                      send a link up message to indicate when link recovery occurred
     2767    26932        */
     2768    26933    5                      GJA_SYSLOG.ERRLOG.ERRCODE.ERR# = %E$LINK_UP;

  26933   2 001BB8  D870 27B0                            LDR,R5   10160,IMO
          2 001BBA  DA80 0000 0003  xsym                 SRM,R5,'FFF8'X    GJA_SYSLOG+3
          2 001BBD       FFF8

     2769    26934    5                      CALL KHC$UTS(GJA_SYSLOG.ERRLOG.UTS);

  26934   2 001BBE  BB80 0000 0003  03                   LAB,B3   +3
          2 001BC1  CBF0 0100                            LAB,B4   256,IMO
          2 001BC3  E380 0000 0000  xent                 LNJ,B6   KHC$UTS
          2 001BC6       0001                            DC       s:26935,PREL

     2770    26935    5                      GJA_SYSLOG.ERRLOG.VALUES(0) = KL$FEPST.FEP;

  26935   2 001BC7  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001BC9  DCC6 0006                            LDB,B5   6,B6
          2 001BCB  E805                                 LDR,R6   ,B5
          2 001BCC  E570 00FF                            AND,R6   255,IMO
          2 001BCE  EF00 0000 000E  xsym                 STR,R6   GJA_SYSLOG+14
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:479  

     2771    26936    5                      GJA_SYSLOG.ERRLOG.TERMID.TERM.CHANNEL = KL$FEPST.CHAN#;

  26936   2 001BD1  DCC6 0006                            LDB,B5   6,B6
          2 001BD3  D845 0006                            LDR,R5   6,B5
          2 001BD5  DF00 0000 0007  xsym                 STR,R5   GJA_SYSLOG+7

     2772    26937    5                      CALL GJA$NETWORK_MANAGER(GJA_SYSLOG,SIZEC(GJA_SYSLOG)-SIZEC(
             26937                               GJA_SYSLOG.ERRLOG.DATA));

  26937   2 001BD8  DBF0 0026                            LAB,B5   38,IMO
          2 001BDA  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001BDC  CB80 0000 0000  xsym                 LAB,B4   GJA_SYSLOG
          2 001BDF  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001BE1  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001BE3  CBF0 0200                            LAB,B4   512,IMO
          2 001BE5  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 001BE8       0001                            DC       s:26942,PREL

     2773    26938    5                      END;

     2774    26939        /*
     2775    26940                      dont send an init if it would only be naked anyway
     2776    26941        */
     2777    26942    4                 IF KL$FEPST.PROB =  KIER_LNKUP

  26942   2 001BE9  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001BEB  DCC6 0006                            LDB,B5   6,B6
          2 001BED  E845 0001                            LDR,R6   1,B5
          2 001BEF  6D11                                 CMV,R6   17
          2 001BF0  0981 0012                            BNE      s:26946,PREL
          2 001BF2  D805                                 LDR,R5   ,B5
          2 001BF3  D570 00FF                            AND,R5   255,IMO
          2 001BF5  D900 0000 0000  xsym                 CMR,R5   GJA_NODE#
          2 001BF8  0381 000A                            BLE      s:26946,PREL
          2 001BFA  CCC7 000F                            LDB,B4   ROUTE$,AUTO
          2 001BFC  89C4 0007                            CMZ      7,B4
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:480  
          2 001BFE  0801 0004                            BAL      s:26946,PREL

     2778    26943    4                   AND KL$FEPST.FEP > GJA_NODE#
     2779    26944    4                   AND NOT KNN$ROUTE.FLAGS.HOST_NODE THEN RETURN;

  26944   2 001C00  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2780    26945
     2781    26946    4                 GJA_CONNECT.RLCID.NODE = KL$FEPST.FEP;

  26946   2 001C03  D805                                 LDR,R5   ,B5
          2 001C04  D570 00FF                            AND,R5   255,IMO
          2 001C06  D780 0000 000D  xsym                 STH,R5   GJA_CONNECT+13

     2782    26947    4                 SIZE = SIZEW(GJA$HAND_CTX);

  26947   2 001C09  6C11                                 LDV,R6   17
          2 001C0A  EF47 0034                            STR,R6   SIZE,AUTO

     2783    26948    4                 CALL KVB$GETSYS(SIZE,CTX$)

  26948   2 001C0C  DBC7 0019                            LAB,B5   CTX$,AUTO
          2 001C0E  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001C10  CBC7 0034                            LAB,B4   SIZE,AUTO
          2 001C12  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001C14  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001C16  CBF0 0200                            LAB,B4   512,IMO
          2 001C18  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 001C1B       0003                            DC       s:26950,PREL
          2 001C1C  0F81 0004                            B        s:26952,PREL

     2784    26949    5                 WHENALTRETURN DO;

     2785    26950    5                      ALTRETURN;

  26950   2 001C1E  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:481  
     2786    26951    5                      END;
     2787    26952    4                 GJA$HAND_CTX = '0'B;

  26952   2 001C21  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001C23  5C22                                 LDV,R5   34
          2 001C24  0021                                 ALR      ;
          2 001C25       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 001C27       4006 0000                                ALPHANUM(0,B6,,R5,FILL)

     2788    26953    4                 GJA$HAND_CTX.WHO = %GJA_UID_NM;

  26953   2 001C29  E870 2000                            LDR,R6   8192,IMO
          2 001C2B  437F                                 CSYNC    s:26953+1,SPREL
          2 001C2C  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001C2E  EA86                                 SRM,R6,'E000'X    ,B6
          2 001C2F       E000

     2789    26954    4                 GJA$HAND_CTX.NODE = KL$FEPST.FEP;

  26954   2 001C30  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001C32  DCC6 0006                            LDB,B5   6,B6
          2 001C34  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 001C36  C805                                 LDR,R4   ,B5
          2 001C37  CAC4 000D                            SRM,R4,'00FF'X    13,B4
          2 001C39       00FF

     2790    26955    4                 GJA$HAND_CTX.HOST_NODE = KNN$ROUTE.FLAGS.HOST_NODE;

  26955   2 001C3A  DCC7 000F                            LDB,B5   ROUTE$,AUTO
          2 001C3C  C845 0007                            LDR,R4   7,B5
          2 001C3E  4042                                 SOR,R4   2
          2 001C3F  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 001C41  CAC4 000D                            SRM,R4,'2000'X    13,B4
          2 001C43       2000

     2791    26956    4                 IF GJA_NM_HEAD$ = ADDR(NIL)

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:482  
  26956   2 001C44  8D80 0000 0000  xsym                 CMN      GJA_NM_HEAD$
          2 001C47  0981 0008                            BNE      s:26960,PREL

     2792    26957    4                 THEN
     2793    26958    4                      GJA_NM_HEAD$ = CTX$;

  26958   2 001C49  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 001C4B  CF80 0000 0000  xsym                 STB,B4   GJA_NM_HEAD$
          2 001C4E  0F81 000D                            B        s:26963,PREL

     2794    26959    5                 ELSE DO;

     2795    26960    5                      GJA$HAND_CTX.LNK$ = GJA_NM_HEAD$;

  26960   2 001C50  CC80 0000 0000  xsym                 LDB,B4   GJA_NM_HEAD$
          2 001C53  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 001C55  CFC3 0001                            STB,B4   1,B3

     2796    26961    5                      GJA_NM_HEAD$ = CTX$;

  26961   2 001C57  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 001C59  CF80 0000 0000  xsym                 STB,B4   GJA_NM_HEAD$

     2797    26962    5                      END;

     2798    26963    4                 KNN$ROUTE.CTX$ = CTX$;

  26963   2 001C5C  CFC5 0002                            STB,B4   2,B5

     2799    26964    4                 CALL GJA$Q_MSG (CTX$,,,SIZEC(GJA_CONNECT),GJA_CONNECT,%KN_FCN_INIT);

  26964   2 001C5E  BBF0 0026                            LAB,B3   38,IMO
          2 001C60  ABF0 0001                            LAB,B2   1,IMO
          2 001C62  AFC7 011E                            STB,B2   SUBSUB$+12,AUTO
          2 001C64  9B80 0000 0000  xsym                 LAB,B1   GJA_CONNECT
          2 001C67  9FC7 011C                            STB,B1   SUBSUB$+10,AUTO
          2 001C69  BFC7 011A                            STB,B3   SUBSUB$+8,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:483  
          2 001C6B  EB80 0000 0000                       LAB,B6   0
          2 001C6E  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 001C70  EB80 0000 0000                       LAB,B6   0
          2 001C73  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 001C75  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 001C77  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 001C79  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001C7B  CBF0 0600                            LAB,B4   1536,IMO
          2 001C7D  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          2 001C80       0001                            DC       s:26965,PREL

     2800    26965    4                 GJA$HAND_CTX.WAT4ACK = '1'B;

  26965   2 001C81  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001C83  8946 000D                            LBT,'0800'X       13,B6
          2 001C85       0800

     2801    26966    4                 END;

     2802    26967    3            GJA$HAND_CTX.LINK_CONNECTED = KNN$ROUTE.FLAGS.LINK_CONNECTED;

  26967   2 001C86  ECC7 000F                            LDB,B6   ROUTE$,AUTO
          2 001C88  E846 0007                            LDR,R6   7,B6
          2 001C8A  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 001C8C  EAC5 000D                            SRM,R6,'4000'X    13,B5
          2 001C8E       4000
          2 001C8F  0F81 02C1                            B        s:27128,PREL

     2803    26968
     2804    26969
     2805    26970    3          CASE (KIER_LNKDWN);

     2806    26971    3            ROUTE$ = KNN$ROUTE$(KL$FEPST.FEP);

  26971   2 001C91  A805                                 LDR,R2   ,B5
          2 001C92  A570 00FF                            AND,R2   255,IMO
          2 001C94  CC80 0000 0000  xsym                 LDB,B4   GJA_ROUTE$
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:484  
          2 001C97  BCA4                                 LDB,B3   ,B4,R2
          2 001C98  BFC7 000F                            STB,B3   ROUTE$,AUTO

     2807    26972    3            CTX$ = KNN$ROUTE.CTX$;

  26972   2 001C9A  ACC3 0002                            LDB,B2   2,B3
          2 001C9C  AFC7 0019                            STB,B2   CTX$,AUTO

     2808    26973    4            IF NOT KNN$ROUTE.FLAGS.HOST_NODE THEN DO;

  26973   2 001C9E  89C3 0007                            CMZ      7,B3
          2 001CA0  0801 0032                            BAL      s:26980,PREL

     2809    26974    4                 GJA_SYSLOG.ERRLOG.ERRCODE.ERR# = %E$LINK_DOWN;

  26974   2 001CA2  E870 27B8                            LDR,R6   10168,IMO
          2 001CA4  EA80 0000 0003  xsym                 SRM,R6,'FFF8'X    GJA_SYSLOG+3
          2 001CA7       FFF8

     2810    26975    4                 CALL KHC$UTS(GJA_SYSLOG.ERRLOG.UTS);

  26975   2 001CA8  BB80 0000 0003  03                   LAB,B3   +3
          2 001CAB  CBF0 0100                            LAB,B4   256,IMO
          2 001CAD  E380 0000 0000  xent                 LNJ,B6   KHC$UTS
          2 001CB0       0001                            DC       s:26976,PREL

     2811    26976    4                 GJA_SYSLOG.ERRLOG.VALUES(0) = KL$FEPST.FEP;

  26976   2 001CB1  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001CB3  DCC6 0006                            LDB,B5   6,B6
          2 001CB5  E805                                 LDR,R6   ,B5
          2 001CB6  E570 00FF                            AND,R6   255,IMO
          2 001CB8  EF00 0000 000E  xsym                 STR,R6   GJA_SYSLOG+14

     2812    26977    4                 GJA_SYSLOG.ERRLOG.TERMID.TERM.CHANNEL = KL$FEPST.CHAN#;

  26977   2 001CBB  DCC6 0006                            LDB,B5   6,B6
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:485  
          2 001CBD  D845 0006                            LDR,R5   6,B5
          2 001CBF  DF00 0000 0007  xsym                 STR,R5   GJA_SYSLOG+7

     2813    26978    4                CALL GJA$NETWORK_MANAGER(GJA_SYSLOG,SIZEC(GJA_SYSLOG)-SIZEC(GJA_SYSLOG
             26978                          .ERRLOG.DATA));

  26978   2 001CC2  DBF0 0026                            LAB,B5   38,IMO
          2 001CC4  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001CC6  CB80 0000 0000  xsym                 LAB,B4   GJA_SYSLOG
          2 001CC9  CFC7 0114                            STB,B4   SUBSUB$+2,AUTO
          2 001CCB  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001CCD  CBF0 0200                            LAB,B4   512,IMO
          2 001CCF  E380 0000 0000  xent                 LNJ,B6   GJA$NETWORK_MANAGER
          2 001CD2       0001                            DC       s:26980,PREL

     2814    26979    4                 END;

     2815    26980    3            IF CTX$ ~= ADDR(NIL)

  26980   2 001CD3  8DC7 0019                            CMN      CTX$,AUTO
          2 001CD5  0901 027B                            BE       s:27128,PREL

     2816    26981    4            THEN DO;

     2817    26982    4                 GJA$HAND_CTX.LINK_CONNECTED = '0'B;

  26982   2 001CD7  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001CD9  8846 000D                            LBF,'4000'X       13,B6
          2 001CDB       4000

     2818    26983    4                 IF GJA$HAND_CTX.HOST_NODE

  26983   2 001CDC  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001CDE  82C6 000D                            LB,'2000'X        13,B6
          2 001CE0       2000
          2 001CE1  0581 0004                            BBF      s:26986,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:486  
     2819    26984    4                 THEN
     2820    26985    4                      GJA$HAND_CTX.LNKDWNRCVD = '1'B;

  26985   2 001CE3  8946 000D                            LBT,'0400'X       13,B6
  26985   2 001CE5       0400

     2821    26986    4                 GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;

  26986   2 001CE6  EC80 0000 0000  xsym                 LDB,B6   GJA_MSG_HOSTDOWN$
          2 001CE9  EF80 0000 0000  xsym                 STB,B6   GJA_MSG_DOWN$

     2822    26987    4                 END;

  26987   2 001CEC  0F81 0264                            B        s:27128,PREL

     2823    26988
     2824    26989    3          CASE (KIER_QOSCHG);

     2825    26990
     2826    26991    3            ROUTE$ = KNN$ROUTE$(KL$FEPST.FEP);

  26991   2 001CEE  A805                                 LDR,R2   ,B5
          2 001CEF  A570 00FF                            AND,R2   255,IMO
          2 001CF1  CC80 0000 0000  xsym                 LDB,B4   GJA_ROUTE$
          2 001CF4  BCA4                                 LDB,B3   ,B4,R2
          2 001CF5  BFC7 000F                            STB,B3   ROUTE$,AUTO

     2827    26992    3            CTX$ = GJA_NM_HEAD$;

  26992   2 001CF7  AC80 0000 0000  xsym                 LDB,B2   GJA_NM_HEAD$
          2 001CFA  AFC7 0019                            STB,B2   CTX$,AUTO

     2828    26993    3            NODECHG.NODE = KL$FEPST.FEP;

  26993   2 001CFC  DCC6 0006                            LDB,B5   6,B6
          2 001CFE  E805                                 LDR,R6   ,B5
          2 001CFF  E570 00FF                            AND,R6   255,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:487  
          2 001D01  E7C7 00D8                            STH,R6   NODECHG+2,AUTO

     2829    26994    3            NODECHG.MYNODE = GJA_NODE#;

  26994   2 001D03  E800 0000 0000  xsym                 LDR,R6   GJA_NODE#
          2 001D06  EAC7 00D7                            SRM,R6,'00FF'X    NODECHG+1,AUTO
          2 001D08       00FF

     2830    26995    3            IF KNN$ROUTE.FLAGS.HOST_NODE = '1'B

  26995   2 001D09  89C3 0007                            CMZ      7,B3
          2 001D0B  0881 0007                            BAGE     s:26999,PREL

     2831    26996    3            THEN
     2832    26997    3                 NODECHG.HOSTNODE = 1;

  26997   2 001D0D  5C01                                 LDV,R5   1
          2 001D0E  DAC7 00D8                            SRM,R5,'00FF'X    NODECHG+2,AUTO
          2 001D10       00FF
          2 001D11  0F81 0004                            B        s:27000,PREL

     2833    26998    3            ELSE
     2834    26999    3                 NODECHG.HOSTNODE = 0;

  26999   2 001D13  8847 00D8                            LBF,'00FF'X       NODECHG+2,AUTO
  26999   2 001D15       00FF

     2835    27000    3            NODECHG.FCN = IGA_NODECHG;

  27000   2 001D16  5C29                                 LDV,R5   41
          2 001D17  D7C7 00D6                            STH,R5   NODECHG,AUTO

     2836    27001
     2837    27002    4            DO WHILE (CTX$ ~= ADDR(NIL));

  27002   2 001D19  0F81 0070                            B        s:27022,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:488  
     2838    27003    4                 IF GJA$HAND_CTX.LDCTX ~= 0 AND GJA$HAND_CTX.LINK_CONNECTED

  27003   2 001D1B  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001D1D  8286                                 LB,'1FFF'X        ,B6
          2 001D1E       1FFF
          2 001D1F  0581 0064                            BBF      s:27021,PREL
          2 001D21  82C6 000D                            LB,'4000'X        13,B6
          2 001D23       4000
          2 001D24  0581 005F                            BBF      s:27021,PREL

     2839    27004    5                 THEN DO;

     2840    27005    5                      LINK$ = KNN$ROUTE.LINK$;

  27005   2 001D26  DCC7 000F                            LDB,B5   ROUTE$,AUTO
          2 001D28  CC85                                 LDB,B4   ,B5
          2 001D29  CFC7 000D                            STB,B4   LINK$,AUTO

     2841    27006    5                      IF LINK$ ~= ADDR(NIL) AND KNN$LINK.NODE# = GJA$HAND_CTX.NODE

  27006   2 001D2B  8DC7 000D                            CMN      LINK$,AUTO
          2 001D2D  0901 0013                            BE       s:27010,PREL
          2 001D2F  E846 000D                            LDR,R6   13,B6
          2 001D31  E570 00FF                            AND,R6   255,IMO
          2 001D33  E944 0002                            CMR,R6   2,B4
          2 001D35  0981 000B                            BNE      s:27010,PREL

     2842    27007    5                      THEN
     2843    27008    5                           NODECHG.QOS = KL$FEPST.ALT_QOS;

  27008   2 001D37  BCC7 0004                            LDB,B3   @GJA$PARAMS,AUTO
          2 001D39  ACC3 0006                            LDB,B2   6,B3
          2 001D3B  D842 0005                            LDR,R5   5,B2
          2 001D3D  D7C7 00D9                            STH,R5   NODECHG+3,AUTO
          2 001D3F  0F81 0009                            B        s:27011,PREL

     2844    27009    5                      ELSE
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:489  
     2845    27010    5                           NODECHG.QOS = KL$FEPST.QOS;

  27010   2 001D41  BCC7 0004                            LDB,B3   @GJA$PARAMS,AUTO
          2 001D43  ACC3 0006                            LDB,B2   6,B3
          2 001D45  E842 0003                            LDR,R6   3,B2
          2 001D47  E7C7 00D9                            STH,R6   NODECHG+3,AUTO

     2846    27011    5                      IF NODECHG.QOS + GJA_HOPCOST > 255

  27011   2 001D49  E2C7 00D9                            LLH,R6   NODECHG+3,AUTO
          2 001D4B  EA00 0000 0000  xsym                 ADD,R6   GJA_HOPCOST
          2 001D4E  E970 00FF                            CMR,R6   255,IMO
          2 001D50  0381 0006                            BLE      s:27015,PREL

     2847    27012    5                      THEN
     2848    27013    5                           NODECHG.QOS = 255;

  27013   2 001D52  8947 00D9                            LBT,'FF00'X       NODECHG+3,AUTO
  27013   2 001D54       FF00
          2 001D55  0F81 0008                            B        s:27016,PREL

     2849    27014    5                      ELSE
     2850    27015    5                           NODECHG.QOS = NODECHG.QOS + GJA_HOPCOST;

  27015   2 001D57  E2C7 00D9                            LLH,R6   NODECHG+3,AUTO
          2 001D59  EA00 0000 0000  xsym                 ADD,R6   GJA_HOPCOST
          2 001D5C  E7C7 00D9                            STH,R6   NODECHG+3,AUTO

     2851    27016    5                      IF NODECHG.QOS = 255 OR LINK$ = ADDR(NIL) OR

  27016   2 001D5E  E2C7 00D9                            LLH,R6   NODECHG+3,AUTO
          2 001D60  E970 00FF                            CMR,R6   255,IMO
          2 001D62  0901 000D                            BE       s:27019,PREL
          2 001D64  8DC7 000D                            CMN      LINK$,AUTO
          2 001D66  0901 0009                            BE       s:27019,PREL
          2 001D68  D846 000D                            LDR,R5   13,B6
          2 001D6A  D570 00FF                            AND,R5   255,IMO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:490  
          2 001D6C  D944 0002                            CMR,R5   2,B4
          2 001D6E  0901 0015                            BE       s:27021,PREL

     2852    27017    5                        GJA$HAND_CTX.NODE ~= KNN$LINK.NODE#
     2853    27018    5                      THEN
     2854    27019    5                           CALL GJA$SEND_MSG(CTX$,NODECHG,SIZEC(NODECHG));

  27019   2 001D70  ABF0 0008                            LAB,B2   8,IMO
          2 001D72  AFC7 0118                            STB,B2   SUBSUB$+6,AUTO
          2 001D74  9BC7 00D6                            LAB,B1   NODECHG,AUTO
          2 001D76  9FC7 0116                            STB,B1   SUBSUB$+4,AUTO
          2 001D78  EBC7 0019                            LAB,B6   CTX$,AUTO
          2 001D7A  EFC7 0114                            STB,B6   SUBSUB$+2,AUTO
          2 001D7C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001D7E  CBF0 0300                            LAB,B4   768,IMO
          2 001D80  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001D83       0001                            DC       s:27021,PREL

     2855    27020    5                      END;

     2856    27021    4                 CTX$ = GJA$HAND_CTX.LNK$;

  27021   2 001D84  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001D86  DCC6 0001                            LDB,B5   1,B6
          2 001D88  DFC7 0019                            STB,B5   CTX$,AUTO

     2857    27022    4                 END;

  27022   2 001D8A  8DC7 0019                            CMN      CTX$,AUTO
          2 001D8C  0981 FF8E                            BNE      s:27003,PREL

     2858    27023
     2859    27024    3            CTX$ = KNN$ROUTE.CTX$;

  27024   2 001D8E  ECC7 000F                            LDB,B6   ROUTE$,AUTO
          2 001D90  DCC6 0002                            LDB,B5   2,B6
          2 001D92  DFC7 0019                            STB,B5   CTX$,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:491  

     2860    27025    3            IF CTX$ ~= ADDR(NIL)

  27025   2 001D94  8DC7 0019                            CMN      CTX$,AUTO
          2 001D96  0901 0034                            BE       s:27040,PREL

     2861    27026    4            THEN DO;

     2862    27027    4                 IF KL$FEPST.QOS = 255

  27027   2 001D98  CCC7 0004                            LDB,B4   @GJA$PARAMS,AUTO
          2 001D9A  BCC4 0006                            LDB,B3   6,B4
          2 001D9C  E843 0003                            LDR,R6   3,B3
          2 001D9E  E970 00FF                            CMR,R6   255,IMO
          2 001DA0  0981 0025                            BNE      s:27037,PREL
          2 001DA2  89C6 0007                            CMZ      7,B6
          2 001DA4  0881 0021                            BAGE     s:27037,PREL
          2 001DA6  D803                                 LDR,R5   ,B3
          2 001DA7  D570 00FF                            AND,R5   255,IMO
          2 001DA9  D900 0000 0000  xsym                 CMR,R5   GJA_DEFNODE
          2 001DAC  0981 0019                            BNE      s:27037,PREL
          2 001DAE  82C5 000D                            LB,'0400'X        13,B5
          2 001DB0       0400
          2 001DB1  0501 0014                            BBT      s:27037,PREL

     2863    27028    4                   AND KNN$ROUTE.FLAGS.HOST_NODE
     2864    27029    4                   AND GJA_DEFNODE = KL$FEPST.FEP
     2865    27030    4                   AND NOT GJA$HAND_CTX.LNKDWNRCVD
     2866    27031    4                 THEN
     2867    27032    4                      IF KL$FEPST.REASON = KIER_LNKDWN

  27032   2 001DB3  C843 0002                            LDR,R4   2,B3
          2 001DB5  4D12                                 CMV,R4   18
          2 001DB6  0981 0009                            BNE      s:27036,PREL

     2868    27033    4                      THEN
     2869    27034    4                           GJA_MSG_DOWN$ = GJA_MSG_LINKDOWN$;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:492  

  27034   2 001DB8  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_LINKDOWN$
          2 001DBB  AF80 0000 0000  xsym                 STB,B2   GJA_MSG_DOWN$
          2 001DBE  0F81 0007                            B        s:27037,PREL

     2870    27035    4                      ELSE
     2871    27036    4                           GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;

  27036   2 001DC0  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_HOSTDOWN$
          2 001DC3  AF80 0000 0000  xsym                 STB,B2   GJA_MSG_DOWN$

     2872    27037    4                 GJA$HAND_CTX.LNKDWNRCVD = '0'B;

  27037   2 001DC6  8845 000D                            LBF,'0400'X       13,B5
  27037   2 001DC8       0400

     2873    27038    4                 END;

  27038   2 001DC9  0F81 0022                            B        s:27045,PREL

     2874    27039    3            ELSE            /* the term bet the qos change message     */
     2875    27040    3                 IF KL$FEPST.QOS = 255

  27040   2 001DCB  CCC7 0004                            LDB,B4   @GJA$PARAMS,AUTO
          2 001DCD  BCC4 0006                            LDB,B3   6,B4
          2 001DCF  E843 0003                            LDR,R6   3,B3
          2 001DD1  E970 00FF                            CMR,R6   255,IMO
          2 001DD3  0981 0018                            BNE      s:27045,PREL
          2 001DD5  89C6 0007                            CMZ      7,B6
          2 001DD7  0881 0014                            BAGE     s:27045,PREL
          2 001DD9  D803                                 LDR,R5   ,B3
          2 001DDA  D570 00FF                            AND,R5   255,IMO
          2 001DDC  D900 0000 0000  xsym                 CMR,R5   GJA_DEFNODE
          2 001DDF  0981 000C                            BNE      s:27045,PREL
          2 001DE1  C843 0002                            LDR,R4   2,B3
          2 001DE3  4D13                                 CMV,R4   19
          2 001DE4  0981 0007                            BNE      s:27045,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:493  

     2876    27041    3                   AND KNN$ROUTE.FLAGS.HOST_NODE
     2877    27042    3                   AND GJA_DEFNODE = KL$FEPST.FEP
     2878    27043    3                   AND KL$FEPST.REASON = KIER_QOSCHG THEN
     2879    27044    3                      GJA_MSG_DOWN$ = GJA_MSG_HOSTDOWN$;

  27044   2 001DE6  AC80 0000 0000  xsym                 LDB,B2   GJA_MSG_HOSTDOWN$
          2 001DE9  AF80 0000 0000  xsym                 STB,B2   GJA_MSG_DOWN$

     2880    27045    3            IF KL$FEPST.QOS = 255          /* No connection            */

  27045   2 001DEC  DCC4 0006                            LDB,B5   6,B4
          2 001DEE  E845 0003                            LDR,R6   3,B5
          2 001DF0  E970 00FF                            CMR,R6   255,IMO
          2 001DF2  0981 0006                            BNE      s:27050,PREL

     2881    27046    3            THEN
     2882    27047    3                 KNN$ROUTE.CTX$ = ADDR(NIL);

  27047   2 001DF4  BB80 0000 0000                       LAB,B3   0
          2 001DF7  BFC6 0002                            STB,B3   2,B6

     2883    27048
     2884    27049        /* Check to see if this is a new host node */
     2885    27050    3            IF KNN$ROUTE.CTX$ = ADDR(NIL) AND KNN$ROUTE.FLAGS.HOST_NODE

  27050   2 001DF9  8DC6 0002                            CMN      2,B6
          2 001DFB  0981 0155                            BNE      s:27128,PREL
          2 001DFD  89C6 0007                            CMZ      7,B6
          2 001DFF  0881 0151                            BAGE     s:27128,PREL
          2 001E01  DCC4 0006                            LDB,B5   6,B4
          2 001E03  E845 0003                            LDR,R6   3,B5
          2 001E05  E970 00FF                            CMR,R6   255,IMO
          2 001E07  0901 0149                            BE       s:27128,PREL

     2886    27051    3              AND KL$FEPST.QOS ~= 255
     2887    27052    4            THEN DO;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:494  

     2888    27053    4                 GOTO CONTACT_NA;

  27053   2 001E09  0F81 FD8E                            B        s:26923,PREL

     2889    27054    4                 END;
     2890    27055    3            END;

     2891    27056
     2892    27057        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:495  
     2893    27058    2       CASE (IGA_NODEINFO);

     2894    27059
     2895    27060    2         GJA$HAND_CTX.NAME = KL$NODEINFO.MYNAME;

  27060   2 001E0B  AB85                                 LAB,B2   ,B5
          2 001E0C  2C05                                 LDV,R2   5
          2 001E0D  6C08                                 LDV,R6   8
          2 001E0E  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 001E10  3C12                                 LDV,R3   18
          2 001E11  0008                                 MMM

     2896    27061    2         IF KL$NODEINFO.BOSS ~= 0          /* He is my boss            */

  27061   2 001E12  CCC6 0006                            LDB,B4   6,B6
          2 001E14  E2C4 0001                            LLH,R6   1,B4
          2 001E16  6901 013A                            BEZ,R6   s:27128,PREL
          2 001E18  8D80 0000 0000  xsym                 CMN      GJA_UID_NM
          2 001E1B  0981 0135                            BNE      s:27128,PREL

     2897    27062    2           AND GJA_UID_NM$ = ADDR(NIL)
     2898    27063    3         THEN DO;

     2899    27064    3              GJA_DEFNODE = GJA$HAND_CTX.NODE;

  27064   2 001E1D  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 001E1F  D843 000D                            LDR,R5   13,B3
          2 001E21  D570 00FF                            AND,R5   255,IMO
          2 001E23  DF00 0000 0000  xsym                 STR,R5   GJA_DEFNODE

     2900    27065    3              GJA_UID_NM$ = CTX$;

  27065   2 001E26  BF80 0000 0000  xsym                 STB,B3   GJA_UID_NM

     2901    27066    3              GJA_LDCT_NM = GJA$HAND_CTX.LDCTX;

  27066   2 001E29  E803                                 LDR,R6   ,B3
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:496  
          2 001E2A  E570 1FFF                            AND,R6   8191,IMO
          2 001E2C  EF00 0000 0000  xsym                 STR,R6   GJA_LDCT_NM

     2902    27067    3              IF GJA_FIRST_TIME

  27067   2 001E2F  8980 0000 0000  xsym                 CMZ      GJA_FIRST_TIME
          2 001E32  0881 011E                            BAGE     s:27128,PREL

     2903    27068    3              THEN
     2904    27069    3                   CALL GJA$GET_CONFIG_INFO;

  27069   2 001E34  CBF0 0000                            LAB,B4   0,IMO
          2 001E36  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CONFIG_INFO
          2 001E39       0001                            DC       s:27070,PREL

     2905    27070    3              END;

  27070   2 001E3A  0F81 0116                            B        s:27128,PREL

     2906    27071
     2907    27072        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:497  
     2908    27073    2       CASE (IGA_NODECHG);

     2909    27074    2         CALL GJA$SEND_MSG(GJA_UID_BABOON,KL$NODECHG,SIZEC(KL$NODECHG));

  27074   2 001E3C  CBF0 0008                            LAB,B4   8,IMO
          2 001E3E  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 001E40  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001E42  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 001E45  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001E47  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001E49  CBF0 0300                            LAB,B4   768,IMO
          2 001E4B  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001E4E       0001                            DC       s:27074+19,PREL
          2 001E4F  0F81 0101                            B        s:27128,PREL

     2910    27075        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:498  
     2911    27076    2       CASE (IGA_TIME);

     2912    27077    2         CALL GJA$SEND_MSG(GJA_UID_BABOON,KL$TIME,SIZEC(KL$TIME));

  27077   2 001E51  CBF0 0006                            LAB,B4   6,IMO
          2 001E53  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 001E55  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001E57  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 001E5A  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001E5C  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001E5E  CBF0 0300                            LAB,B4   768,IMO
          2 001E60  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001E63       0001                            DC       s:27077+19,PREL
          2 001E64  0F81 00EC                            B        s:27128,PREL

     2913    27078
     2914    27079        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:499  
     2915    27080    2       CASE (IGA_DUMPMSG);

     2916    27081    2         CALL GIJ$DUMPMSG(KL$MES);

  27081   2 001E66  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 001E68  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001E6A  CBF0 0100                            LAB,B4   256,IMO
          2 001E6C  E380 0000 0000  xent                 LNJ,B6   GIJ$DUMPMSG
          2 001E6F       0001                            DC       s:27081+10,PREL
          2 001E70  0F81 00E0                            B        s:27128,PREL

     2917    27082
     2918    27083    2       CASE (IGA_CHSCRLVL);

     2919    27084    2         CALL GJA$SEND_MSG(GJA_UID_BABOON,KL$CHSCRLVL,SIZEC(KL$CHSCRLVL));

  27084   2 001E72  CBF0 0002                            LAB,B4   2,IMO
          2 001E74  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 001E76  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001E78  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 001E7B  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001E7D  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001E7F  CBF0 0300                            LAB,B4   768,IMO
          2 001E81  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001E84       0001                            DC       s:27084+19,PREL
          2 001E85  0F81 00CB                            B        s:27128,PREL

     2920    27085        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:500  
     2921    27086    2       CASE(IGA_UPDOSI,IGA_DELOSI);

     2922    27087        /*
     2923    27088             forward message to baboon for inclusion in our osiroute tables.
     2924    27089        */
     2925    27090    2         CALL GJA$SEND_MSG(GJA_UID_BABOON$,KL$UPDOSI,SIZEC(KL$UPDOSI));

  27090   2 001E87  CBF0 003C                            LAB,B4   60,IMO
          2 001E89  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 001E8B  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001E8D  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 001E90  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001E92  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001E94  CBF0 0300                            LAB,B4   768,IMO
          2 001E96  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001E99       0001                            DC       s:27090+19,PREL
          2 001E9A  0F81 00B6                            B        s:27128,PREL

     2926    27091
     2927    27092    2       CASE(IGA_OSILINKCHG,IGA_OSILINKCHG_DF);

     2928    27093          /*
     2929    27094             an osi link on a remote system has changed status(up/down).
     2930    27095             forward the message to all link connected nodes except the one
     2931    27096             which sent us this message
     2932    27097        */
     2933    27098    2         I = KL$OSILINKCHG.NODE#;     /* node# of osi link location    */

  27098   2 001E9C  E845 0001                            LDR,R6   1,B5
          2 001E9E  E570 00FF                            AND,R6   255,IMO
          2 001EA0  EF47 0015                            STR,R6   I,AUTO

     2934    27099    3         IF KL$OSILINKCHG.FCN = IGA_OSILINKCHG_DF THEN DO;

  27099   2 001EA2  DCC6 0006                            LDB,B5   6,B6
          2 001EA4  D285                                 LLH,R5   ,B5
          2 001EA5  5D5B                                 CMV,R5   91
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:501  
          2 001EA6  0981 001B                            BNE      s:27104,PREL

     2935    27100    3              KL$OSILINKCHG.FCN = IGA_OSILINKCHG;

  27100   2 001EA8  4C5A                                 LDV,R4   90
          2 001EA9  C785                                 STH,R4   ,B5

     2936    27101    3              CALL GJA$SEND_MSG(GJA_UID_BABOON$,KL$OSILINKCHG,SIZEC(KL$OSILINKCHG));

  27101   2 001EAA  DCC6 0006                            LDB,B5   6,B6
          2 001EAC  CBF0 0020                            LAB,B4   32,IMO
          2 001EAE  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 001EB0  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001EB2  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 001EB5  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001EB7  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001EB9  CBF0 0300                            LAB,B4   768,IMO
          2 001EBB  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001EBE       0001                            DC       s:27102,PREL

     2937    27102    3              RETURN;

  27102   2 001EBF  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2938    27103    3              END;
     2939    27104    2         CALL GJA$SEND_MSG(GJA_UID_BABOON$,KL$OSILINKCHG,SIZEC(KL$OSILINKCHG));

  27104   2 001EC2  CBF0 0020                            LAB,B4   32,IMO
          2 001EC4  CFC7 0118                            STB,B4   SUBSUB$+6,AUTO
          2 001EC6  DFC7 0116                            STB,B5   SUBSUB$+4,AUTO
          2 001EC8  BB80 0000 0000  xsym                 LAB,B3   GJA_UID_BABOON
          2 001ECB  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001ECD  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001ECF  CBF0 0300                            LAB,B4   768,IMO
          2 001ED1  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001ED4       0001                            DC       s:27105,PREL

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:502  
     2940    27105    2         OSILINKCHG = KL$OSILINKCHG;

  27105   2 001ED5  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 001ED7  DCC6 0006                            LDB,B5   6,B6
          2 001ED9  AB85                                 LAB,B2   ,B5
          2 001EDA  2C00                                 LDV,R2   0
          2 001EDB  6C20                                 LDV,R6   32
          2 001EDC  BBC7 00F8                            LAB,B3   OSILINKCHG,AUTO
          2 001EDE  3C00                                 LDV,R3   0
          2 001EDF  0008                                 MMM

  27105   2                              FORWARDOSI      null
     2941    27106    2   FORWARDOSI:;
     2942    27107    2         OSILINKCHG.FCN = IGA_OSILINKCHG;

  27107   2 001EE0  6C5A                 FORWARDOSI      LDV,R6   90
          2 001EE1  E7C7 00F8                            STH,R6   OSILINKCHG,AUTO

     2943    27108    2         OSILINKCHG.MYNODE# = GJA_NODE#;

  27108   2 001EE3  D800 0000 0000  xsym                 LDR,R5   GJA_NODE#
          2 001EE6  D7C7 00F9                            STH,R5   OSILINKCHG+1,AUTO

     2944    27109    2         CTX$ = GJA_NM_HEAD$;

  27109   2 001EE8  EC80 0000 0000  xsym                 LDB,B6   GJA_NM_HEAD$
          2 001EEB  EFC7 0019                            STB,B6   CTX$,AUTO

     2945    27110    3         DO WHILE CTX$ ~= ADDR(NIL);

  27110   2 001EED  0F81 0034                            B        s:27116,PREL

     2946    27111    3              IF GJA$HAND_CTX.LINK_CONNECTED AND GJA$HAND_CTX.NODE ~= KL$OSILINKCHG.
             27111                       MYNODE# AND

  27111   2 001EEF  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001EF1  82C6 000D                            LB,'4000'X        13,B6
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:503  
          2 001EF3       4000
          2 001EF4  0581 0027                            BBF      s:27115,PREL
          2 001EF6  DCC7 0004                            LDB,B5   @GJA$PARAMS,AUTO
          2 001EF8  CCC5 0006                            LDB,B4   6,B5
          2 001EFA  E846 000D                            LDR,R6   13,B6
          2 001EFC  E570 00FF                            AND,R6   255,IMO
          2 001EFE  D2C4 0001                            LLH,R5   1,B4
          2 001F00  E955                                 CMR,R6   R5
          2 001F01  0901 001A                            BE       s:27115,PREL
          2 001F03  82C6 000D                            LB,'0800'X        13,B6
          2 001F05       0800
          2 001F06  0501 0015                            BBT      s:27115,PREL

     2947    27112    4                GJA$HAND_CTX.WAT4ACK ~= '1'B THEN DO;

     2948    27113    4                   CALL GJA$SEND_MSG(CTX$,OSILINKCHG,SIZEC(OSILINKCHG));

  27113   2 001F08  BBF0 0020                            LAB,B3   32,IMO
          2 001F0A  BFC7 0118                            STB,B3   SUBSUB$+6,AUTO
          2 001F0C  CBC7 00F8                            LAB,B4   OSILINKCHG,AUTO
          2 001F0E  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001F10  ABC7 0019                            LAB,B2   CTX$,AUTO
          2 001F12  AFC7 0114                            STB,B2   SUBSUB$+2,AUTO
          2 001F14  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001F16  CBF0 0300                            LAB,B4   768,IMO
          2 001F18  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001F1B       0001                            DC       s:27115,PREL

     2949    27114    4                   END;     /* if link_connected and node ~= mynode    */

     2950    27115    3              CTX$ = GJA$HAND_CTX.LNK$;

  27115   2 001F1C  ECC7 0019                            LDB,B6   CTX$,AUTO
          2 001F1E  DCC6 0001                            LDB,B5   1,B6
          2 001F20  DFC7 0019                            STB,B5   CTX$,AUTO

     2951    27116    3              END;                         /* while ctx$               */
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:504  

  27116   2 001F22  8DC7 0019                            CMN      CTX$,AUTO
          2 001F24  09CB                                 BNE      s:27111,SPREL
          2 001F25  0F81 002B                            B        s:27128,PREL

     2952    27117
     2953    27118    2       CASE(IGA_OSILINKUP,IGA_OSILINKDOWN);

     2954    27119    2         OSILINKCHG = '0'B;

  27119   2 001F27  5C20                                 LDV,R5   32
          2 001F28  0021                                 ALR      ;
          2 001F29       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 001F2B       4007 00F8                                ALPHANUM(OSILINKCHG,AUTO,,R5,FILL)

     2955    27120    2         OSILINKCHG.TYPE = KL$OSILINKCHG.FCN;
             27120                  /* osilinkchg intra fep, up/down inter fep*/

  27120   2 001F2D  437F                                 CSYNC    s:27119+5,SPREL
          2 001F2E  DCC6 0006                            LDB,B5   6,B6
          2 001F30  E285                                 LLH,R6   ,B5
          2 001F31  EAC7 00F8                            SRM,R6,'00FF'X    OSILINKCHG,AUTO
          2 001F33       00FF

     2956    27121    2         OSILINKCHG.NODE# = GJA_NODE#; /* this is a message about our fep */

  27121   2 001F34  E800 0000 0000  xsym                 LDR,R6   GJA_NODE#
          2 001F37  EAC7 00F9                            SRM,R6,'00FF'X    OSILINKCHG+1,AUTO
          2 001F39       00FF

     2957    27122    2         OSILINKCHG.SNPA = KL$OSILINKCHG.SNPA;

  27122   2 001F3A  DCC6 0006                            LDB,B5   6,B6
          2 001F3C  AB85                                 LAB,B2   ,B5
          2 001F3D  2C08                                 LDV,R2   8
          2 001F3E  6C08                                 LDV,R6   8
          2 001F3F  BBC7 00FC                            LAB,B3   OSILINKCHG+4,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:505  
          2 001F41  3C00                                 LDV,R3   0
          2 001F42  0008                                 MMM

     2958    27123    2         OSILINKCHG.QOS = KL$OSILINKCHG.QOS;

  27123   2 001F43  CCC6 0006                            LDB,B4   6,B6
          2 001F45  E2C4 0002                            LLH,R6   2,B4
          2 001F47  E7C7 00FA                            STH,R6   OSILINKCHG+2,AUTO

     2959    27124    2         OSILINKCHG.TERMID.TERM.CHANNEL = KL$OSILINKCHG.TERMID.TERM.CHANNEL;

  27124   2 001F49  CCC6 0006                            LDB,B4   6,B6
          2 001F4B  E844 0009                            LDR,R6   9,B4
          2 001F4D  EF47 0101                            STR,R6   OSILINKCHG+9,AUTO

     2960    27125    2         GOTO FORWARDOSI;

  27125   2 001F4F  0F81 FF90                            B        s:27105,PREL

     2961    27126
     2962    27127    2         END;                              /* case on iga_?            */

     2963    27128    1      RETURN;

  27128   2 001F51  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     2964    27129        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:506  
     2965    27130    1   ALLOCATE_CHAN: PROC (CTX$);

  27130   2 001F54  EFC7 0108            ALLOCATE_CHAN   STB,B6   OSILINKCHG+16,AUTO

     2966    27131
     2967    27132    2   DCL CTX$ PTR;
     2968    27133
     2969    27134    2      CHN$ = GJA_CHNLOW$;

  27134   2 001F56  DC80 0000 0000  xsym                 LDB,B5   GJA_CHNLOW$
          2 001F59  DFC7 0017                            STB,B5   CHN$,AUTO

     2970    27135    3      DO WHILE (CHN$ <= GJA_CHNHI$);

  27135   2 001F5B  DD80 0000 0000  xsym                 CMB,B5   GJA_CHNHI$
          2 001F5E  0301 0047                            BG       s:27151,PREL

     2971    27136    3           IF KH$CHN.STT = %KH#CHN_STT_NTRDY AND NOT GJA_FIRST_TIME

  27136   2 001F60  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001F62  E2C6 0001                            LLH,R6   1,B6
          2 001F64  6D0A                                 CMV,R6   10
          2 001F65  0981 0008                            BNE      s:27139,PREL
          2 001F67  8980 0000 0000  xsym                 CMZ      GJA_FIRST_TIME
          2 001F6A  0801 0003                            BAL      s:27139,PREL

     2972    27137    3           THEN
     2973    27138    3                KH$CHN.STT = %KH#CHN_STT_UN_INT;

  27138   2 001F6C  87C6 0001                            CLH      1,B6

     2974    27139    3           IF KH$CHN.CHNBIT0_9 ~= 0

  27139   2 001F6E  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001F70  8286                                 LB,'FFC0'X        ,B6
          2 001F71       FFC0
          2 001F72  0581 0028                            BBF      s:27149,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:507  
          2 001F74  DCC7 010A                            LDB,B5   @CTX$,AUTO
          2 001F76  CC85                                 LDB,B4   ,B5
          2 001F77  0022                                 ACM      ;
          2 001F78       4204 000F                                ALPHANUM(15,B4,,2,FILL),;
          2 001F7A       4206 0004                                ALPHANUM(4,B6,,2,FILL)
          2 001F7C  5301 001E                            CBNE     s:27149,PREL
          2 001F7E  E846 0005                            LDR,R6   5,B6
          2 001F80  8656                                 CPL      R6
          2 001F81  E544 0010                            AND,R6   16,B4
          2 001F83  6981 0017                            BNEZ,R6  s:27149,PREL
          2 001F85  E2C6 0001                            LLH,R6   1,B6
          2 001F87  6981 0013                            BNEZ,R6  s:27149,PREL
          2 001F89  D846 0006                            LDR,R5   6,B6
          2 001F8B  5981 000F                            BNEZ,R5  s:27149,PREL

     2975    27140    3             AND CTX$->GJA$HAND_CTX.RES = KH$CHN.RESOURCE
     2976    27141    3             AND (CTX$->GJA$HAND_CTX.ATTR &~ KH$CHN.ATTR)= '0'B
     2977    27142    3             AND KH$CHN.STT = %KH#CHN_STT_UN_INT
     2978    27143    3             AND KH$CHN.SYSID = 0
     2979    27144    4           THEN DO;

     2980    27145    4                KH$CHN.HAND$ = CTX$;

  27145   2 001F8D  CFC6 001E                            STB,B4   30,B6

     2981    27146    4                KH$CHN.SYSID = CTX$->GJA$HAND_CTX.SYSID;

  27146   2 001F8F  BC85                                 LDB,B3   ,B5
          2 001F90  D843 000E                            LDR,R5   14,B3
          2 001F92  DF46 0006                            STR,R5   6,B6

     2982    27147    4                CALL UPDATE_SUBS ( KH$CHN );

  27147   2 001F94  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001F96  EFC7 010E                            STB,B6   @NM$+2,AUTO
          2 001F98  E3C0 0045                            LNJ,B6   s:0,PREL
          2 001F9A       0001                            DC       s:27149,PREL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:508  

     2983    27148    4                END;

     2984    27149    3           CHN$ = PINCRW(CHN$,SIZEW(KH$CHN));

  27149   2 001F9B  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 001F9D  DBC6 0020                            LAB,B5   32,B6
          2 001F9F  DFC7 0017                            STB,B5   CHN$,AUTO

     2985    27150    3           END;

  27150   2 001FA1  DD80 0000 0000  xsym                 CMB,B5   GJA_CHNHI$
          2 001FA4  0381 FFBB                            BLE      s:27136,PREL

     2986    27151    2      ADMIN = GJA_ADMIN;

  27151   2 001FA6  EB80 0000 0000  xsym                 LAB,B6   GJA_ADMIN
          2 001FA9  4C44                                 LDV,R4   68
          2 001FAA  D870 0084                            LDR,R5   132,IMO
          2 001FAC  0021                                 ALR      ;
          2 001FAD       4006 0000                                ALPHANUM(0,B6,,R4),;
          2 001FAF       4007 0094                                ALPHANUM(ADMIN,AUTO,,R5,FILL)

     2987    27152    2      ADMIN.TERMID_LO.LEV = %TERMINAL_ID_LEV_CHAN#;

  27152   2 001FB1  6C01                                 LDV,R6   1
          2 001FB2  437F                                 CSYNC    s:27152,SPREL
          2 001FB3  EAC7 00A6                            SRM,R6,'00FF'X    ADMIN+18,AUTO
          2 001FB5       00FF

     2988    27153    2      ADMIN.TERMID_LO.TERM.CHANNEL = GJA_CHNLOW;

  27153   2 001FB6  B800 0000 0000  xsym                 LDR,R3   GJA_CHNLOW
          2 001FB9  BF47 00A7                            STR,R3   ADMIN+19,AUTO

     2989    27154    2      ADMIN.TERMID_HI.LEV = %TERMINAL_ID_LEV_CHAN#;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:509  
  27154   2 001FBB  EAC7 00AE                            SRM,R6,'00FF'X    ADMIN+26,AUTO
  27154   2 001FBD       00FF

     2990    27155    2      ADMIN.TERMID_HI.TERM.CHANNEL = GJA_CHNHI;

  27155   2 001FBE  A800 0000 0000  xsym                 LDR,R2   GJA_CHNHI
          2 001FC1  AF47 00AF                            STR,R2   ADMIN+27,AUTO

     2991    27156    2      ADMIN.FNC = %KHA_FNC_INTDVC;

  27156   2 001FC3  1C10                                 LDV,R1   16
          2 001FC4  9F47 00A5                            STR,R1   ADMIN+17,AUTO

     2992    27157    2      CALL GJA$SEND_MSG(CTX$,ADMIN,SIZEC(ADMIN));

  27157   2 001FC6  EBF0 0084                            LAB,B6   132,IMO
          2 001FC8  EFC7 0118                            STB,B6   SUBSUB$+6,AUTO
          2 001FCA  CBC7 0094                            LAB,B4   ADMIN,AUTO
          2 001FCC  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 001FCE  BCC7 010A                            LDB,B3   @CTX$,AUTO
          2 001FD0  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 001FD2  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 001FD4  CBF0 0300                            LAB,B4   768,IMO
          2 001FD6  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
          2 001FD9       0001                            DC       s:27159,PREL

     2993    27158
     2994    27159    2      RETURN;

  27159   2 001FDA  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
          2 001FDC  C3C6 0001                            LNJ,B4   1,B6

     2995    27160    2   END ALLOCATE_CHAN;
     2996    27161        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:510  
     2997    27162
     2998    27163        /*P*
     2999    27164              NAME:  UPDATE_SUBS
     3000    27165              PURPOSE: To update CHAN$ and SYSID in the channel tables
     3001    27166                       of the sub and subsubchannels of a base channel.
     3002    27167              DESCRIPTION: See above.
     3003    27168              CALL:  CALL UPDATE_SUBS ( KH$CHN );
     3004    27169              INPUT: KH$CHN is channel table of base channel.
     3005    27170              OUTPUT: None.
     3006    27171        */
     3007    27172
     3008    27173    1   UPDATE_SUBS: PROC ( BAS_CHN );

  27173   2 001FDE  EFC7 010C            UPDATE_SUBS     STB,B6   ATTR+1,AUTO

     3009    27174
     3010    27175        %KH$CHN ( NAME=BAS_CHN, STCLASS= );
     3011    27299
     3012    27300    2   DCL SUB$ PTR;
     3013    27301    2   DCL SUBSUB$ PTR;
     3014    27302        %KH$CHN ( STCLASS=BASED );
     3015    27426
     3016    27427    2      IF ( BAS_CHN.TERMID.LEV ~= %TERMINAL_ID_LEV_CHAN# ) THEN

  27427   2 001FE0  DCC7 010E                            LDB,B5   @BAS_CHN,AUTO
          2 001FE2  E845 0012                            LDR,R6   18,B5
          2 001FE4  E570 00FF                            AND,R6   255,IMO
          2 001FE6  6D01                                 CMV,R6   1
          2 001FE7  0901 0005                            BE       s:27430,PREL

     3017    27428    2           RETURN;

  27428   2 001FE9  ECC7 010C                            LDB,B6   ATTR+1,AUTO
          2 001FEB  C3C6 0001                            LNJ,B4   1,B6

     3018    27429
     3019    27430    2      SUB$ = BAS_CHN.SUB$;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:511  

  27430   2 001FED  CCC5 001A                            LDB,B4   26,B5
          2 001FEF  CFC7 0110                            STB,B4   SUB$,AUTO

     3020    27431    3      DO WHILE ( SUB$ ~= ADDR(NIL) );

  27431   2 001FF1  0F81 002C                            B        s:27441,PREL

     3021    27432    3           SUBSUB$ = SUB$->KH$CHN.SUB$;

  27432   2 001FF3  ECC7 0110                            LDB,B6   SUB$,AUTO
          2 001FF5  DCC6 001A                            LDB,B5   26,B6
          2 001FF7  DFC7 0112                            STB,B5   SUBSUB$,AUTO

     3022    27433    4           DO WHILE ( SUBSUB$ ~= ADDR(NIL) );

  27433   2 001FF9  0F81 0011                            B        s:27437,PREL

     3023    27434    4                SUBSUB$->KH$CHN.HAND$ = BAS_CHN.HAND$;

  27434   2 001FFB  ECC7 010E                            LDB,B6   @BAS_CHN,AUTO
          2 001FFD  DCC6 001E                            LDB,B5   30,B6
          2 001FFF  CCC7 0112                            LDB,B4   SUBSUB$,AUTO
          2 002001  DFC4 001E                            STB,B5   30,B4

     3024    27435    4                SUBSUB$->KH$CHN.SYSID = BAS_CHN.SYSID;

  27435   2 002003  E846 0006                            LDR,R6   6,B6
          2 002005  EF44 0006                            STR,R6   6,B4

     3025    27436    4                SUBSUB$ = SUBSUB$->KH$CHN.LNK$;

  27436   2 002007  BCC4 001C                            LDB,B3   28,B4
          2 002009  BFC7 0112                            STB,B3   SUBSUB$,AUTO

     3026    27437    4                END;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:512  
  27437   2 00200B  8DC7 0112                            CMN      SUBSUB$,AUTO
          2 00200D  09EE                                 BNE      s:27434,SPREL

     3027    27438    3           SUB$->KH$CHN.HAND$ = BAS_CHN.HAND$;

  27438   2 00200E  ECC7 010E                            LDB,B6   @BAS_CHN,AUTO
          2 002010  DCC6 001E                            LDB,B5   30,B6
          2 002012  CCC7 0110                            LDB,B4   SUB$,AUTO
          2 002014  DFC4 001E                            STB,B5   30,B4

     3028    27439    3           SUB$->KH$CHN.SYSID = BAS_CHN.SYSID;

  27439   2 002016  E846 0006                            LDR,R6   6,B6
          2 002018  EF44 0006                            STR,R6   6,B4

     3029    27440    3           SUB$ = SUB$->KH$CHN.LNK$;

  27440   2 00201A  BCC4 001C                            LDB,B3   28,B4
          2 00201C  BFC7 0110                            STB,B3   SUB$,AUTO

     3030    27441    3           END;

  27441   2 00201E  8DC7 0110                            CMN      SUB$,AUTO
          2 002020  09D3                                 BNE      s:27432,SPREL

     3031    27442
     3032    27443    2   END UPDATE_SUBS;

  27443   2 002021  ECC7 010C                            LDB,B6   ATTR+1,AUTO
          2 002023  C3C6 0001                            LNJ,B4   1,B6

     3033    27444
     3034    27445        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:513  
     3035    27446    1   DEFAULT_HAND: PROC;

  27446   2 002025  EFC7 0108            DEFAULT_HAND    STB,B6   OSILINKCHG+16,AUTO

     3036    27447
     3037    27448    2   DCL RES CHAR(2);
     3038    27449    2   DCL ATTR BIT(16);
     3039    27450
     3040    27451    2      CTX$ = GJA_HAND_HEAD$;

  27451   2 002027  DC80 0000 0000  xsym                 LDB,B5   GJA_HAND_HEAD$
          2 00202A  DFC7 0019                            STB,B5   CTX$,AUTO

     3041    27452
     3042    27453    3      DO WHILE(CTX$ ~= ADDR(NIL));

  27453   2 00202C  0F81 0012                            B        s:27458,PREL

     3043    27454    3           IF CTX$->GJA$HAND_CTX.NAME = KL$CHNRSP.HANDLER

  27454   2 00202E  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 002030  DCC6 0006                            LDB,B5   6,B6
          2 002032  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 002034  0022                                 ACM      ;
          2 002035       4804 0009                                ALPHANUM(9,B4,,8,FILL),;
          2 002037       4805 0001                                ALPHANUM(1,B5,,8,FILL)
          2 002039  5381 0008                            CBE      s:27460,PREL

     3044    27455    3           THEN
     3045    27456    3                EXIT;
     3046    27457    3           CTX$ = CTX$->GJA$HAND_CTX.LNK$;

  27457   2 00203B  BCC4 0001                            LDB,B3   1,B4
          2 00203D  BFC7 0019                            STB,B3   CTX$,AUTO

     3047    27458    3           END;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:514  
  27458   2 00203F  8DC7 0019                            CMN      CTX$,AUTO
          2 002041  09ED                                 BNE      s:27454,SPREL

     3048    27459
     3049    27460    3      DO SELECT (KL$CHNRSP.HANDLER);

  27460   2 002042  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 002044  DCC6 0006                            LDB,B5   6,B6
          2 002046  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 002049  0022                                 ACM      ;
          2 00204A       4805 0001                                ALPHANUM(1,B5,,8,FILL),;
          2 00204C       4604 001C                                ALPHANUM(28,B4,,6,FILL)
          2 00204E  7301 0037                            CBL      s:27460+68,PREL
          2 002050  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 002053  0022                                 ACM      ;
          2 002054       4805 0001                                ALPHANUM(1,B5,,8,FILL),;
          2 002056       4604 001C                                ALPHANUM(28,B4,,6,FILL)
          2 002058  5381 0055                            CBE      s:27471,PREL
          2 00205A  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 00205D  0022                                 ACM      ;
          2 00205E       4805 0001                                ALPHANUM(1,B5,,8,FILL),;
          2 002060       4704 001F                                ALPHANUM(31,B4,,7,FILL)
          2 002062  7301 0017                            CBL      s:27460+56,PREL
          2 002064  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 002067  0022                                 ACM      ;
          2 002068       4805 0001                                ALPHANUM(1,B5,,8,FILL),;
          2 00206A       4704 001F                                ALPHANUM(31,B4,,7,FILL)
          2 00206C  5381 0050                            CBE      s:27475,PREL
          2 00206E  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 002071  0022                                 ACM      ;
          2 002072       4805 0001                                ALPHANUM(1,B5,,8,FILL),;
          2 002074       4704 0023                                ALPHANUM(35,B4,,7,FILL)
          2 002076  5301 0062                            CBNE     s:27484,PREL
          2 002078  0F81 0028                            B        s:27467,PREL
          2 00207A  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 00207D  0022                                 ACM      ;
          2 00207E       4805 0001                                ALPHANUM(1,B5,,8,FILL),;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:515  
          2 002080       4704 0027                                ALPHANUM(39,B4,,7,FILL)
          2 002082  5301 0056                            CBNE     s:27484,PREL
          2 002084  0F81 0047                            B        s:27479,PREL
          2 002086  CB80 0000 0000  01                   LAB,B4   E$NONETMAN
          2 002089  0022                                 ACM      ;
          2 00208A       4805 0001                                ALPHANUM(1,B5,,8,FILL),;
          2 00208C       4504 002B                                ALPHANUM(43,B4,,5,FILL)
          2 00208E  5301 004A                            CBNE     s:27484,PREL
          2 002090  0F81 0001                            B        s:27463,PREL

     3050    27461
     3051    27462    3           SELECT('ASYNC');

     3052    27463    3           RES = 'CL';

  27463   2 002092  AB80 0000 0000  01                   LAB,B2   E$NONETMAN
          2 002095  2C5C                                 LDV,R2   92
          2 002096  6C02                                 LDV,R6   2
          2 002097  BBC7 010A                            LAB,B3   RES,AUTO
          2 002099  3C00                                 LDV,R3   0
          2 00209A  0008                                 MMM

     3053    27464    3           ATTR = %G_ATTR_CL_ASYNC;

  27464   2 00209B  E870 8000                            LDR,R6   -32768,IMO
          2 00209D  EF47 010B                            STR,R6   ATTR,AUTO
          2 00209F  0F81 0044                            B        s:27488,PREL

     3054    27465
     3055    27466    3           SELECT ('UNITREC');

     3056    27467    3           RES = 'UR';

  27467   2 0020A1  AB80 0000 0000  01                   LAB,B2   E$NONETMAN
          2 0020A4  2C5E                                 LDV,R2   94
          2 0020A5  6C02                                 LDV,R6   2
          2 0020A6  BBC7 010A                            LAB,B3   RES,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:516  
          2 0020A8  3C00                                 LDV,R3   0
          2 0020A9  0008                                 MMM

     3057    27468    3           ATTR = '0'B;

  27468   2 0020AA  8747 010B                            CL       ATTR,AUTO
          2 0020AC  0F81 0037                            B        s:27488,PREL

     3058    27469
     3059    27470    3           SELECT ('BISYNC');

     3060    27471    3           RES='CL';

  27471   2 0020AE  AB80 0000 0000  01                   LAB,B2   E$NONETMAN
          2 0020B1  2C5C                                 LDV,R2   92
          2 0020B2  6C02                                 LDV,R6   2
          2 0020B3  BBC7 010A                            LAB,B3   RES,AUTO
          2 0020B5  3C00                                 LDV,R3   0
          2 0020B6  0008                                 MMM

     3061    27472    3           ATTR = %G_ATTR_CL_SYNC;

  27472   2 0020B7  E870 1000                            LDR,R6   4096,IMO
          2 0020B9  EF47 010B                            STR,R6   ATTR,AUTO
          2 0020BB  0F81 0028                            B        s:27488,PREL

     3062    27473
     3063    27474    3           SELECT ('HDLCX25');

     3064    27475    3           RES = 'CL';

  27475   2 0020BD  AB80 0000 0000  01                   LAB,B2   E$NONETMAN
          2 0020C0  2C5C                                 LDV,R2   92
          2 0020C1  6C02                                 LDV,R6   2
          2 0020C2  BBC7 010A                            LAB,B3   RES,AUTO
          2 0020C4  3C00                                 LDV,R3   0
          2 0020C5  0008                                 MMM
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:517  

     3065    27476    3           ATTR = %G_ATTR_CL_HDLC;

  27476   2 0020C6  E870 2000                            LDR,R6   8192,IMO
          2 0020C8  EF47 010B                            STR,R6   ATTR,AUTO
          2 0020CA  0F81 0019                            B        s:27488,PREL

     3066    27477
     3067    27478    3           SELECT ('COUPLER');

     3068    27479    3           RES = 'HL';

  27479   2 0020CC  AB80 0000 0000  01                   LAB,B2   E$NONETMAN
          2 0020CF  2C60                                 LDV,R2   96
          2 0020D0  6C02                                 LDV,R6   2
          2 0020D1  BBC7 010A                            LAB,B3   RES,AUTO
          2 0020D3  3C00                                 LDV,R3   0
          2 0020D4  0008                                 MMM

     3069    27480    3           ATTR = '0'B;

  27480   2 0020D5  8747 010B                            CL       ATTR,AUTO
          2 0020D7  0F81 000C                            B        s:27488,PREL

     3070    27481
     3071    27482    3           SELECT (ELSE);

     3072    27483
     3073    27484    3      RES = '  ';

  27484   2 0020D9  AB80 0000 0000  01                   LAB,B2   E$NONETMAN
          2 0020DC  2C62                                 LDV,R2   98
          2 0020DD  6C02                                 LDV,R6   2
          2 0020DE  BBC7 010A                            LAB,B3   RES,AUTO
          2 0020E0  3C00                                 LDV,R3   0
          2 0020E1  0008                                 MMM

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:518  
     3074    27485    3      ATTR = '0'B;

  27485   2 0020E2  8747 010B                            CL       ATTR,AUTO

     3075    27486
     3076    27487    3           END;

     3077    27488    2      IF CTX$ ~= ADDR(NIL) AND CTX$->GJA$HAND_CTX.RES ~= ' '

  27488   2 0020E4  8DC7 0019                            CMN      CTX$,AUTO
          2 0020E6  0901 001A                            BE       s:27494,PREL
          2 0020E8  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 0020EA  CB80 0000 0000  03                   LAB,B4   0
          2 0020ED  0022                                 ACM      ;
          2 0020EE       4205 000F                                ALPHANUM(15,B5,,2,FILL),;
          2 0020F0       4104 0005                                ALPHANUM(5,B4,,1,FILL)
          2 0020F2  5381 000E                            CBE      s:27494,PREL

     3078    27489    3      THEN DO;

     3079    27490    3           RES = CTX$->GJA$HAND_CTX.RES;

  27490   2 0020F4  AB85                                 LAB,B2   ,B5
          2 0020F5  2C1E                                 LDV,R2   30
          2 0020F6  6C02                                 LDV,R6   2
          2 0020F7  BBC7 010A                            LAB,B3   RES,AUTO
          2 0020F9  3C00                                 LDV,R3   0
          2 0020FA  0008                                 MMM

     3080    27491    3           ATTR = CTX$->GJA$HAND_CTX.ATTR;

  27491   2 0020FB  CCC7 0019                            LDB,B4   CTX$,AUTO
          2 0020FD  E844 0010                            LDR,R6   16,B4
          2 0020FF  EF47 010B                            STR,R6   ATTR,AUTO

     3081    27492    3           END;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:519  
     3082    27493
     3083    27494    2      IF NA.RESPRES

  27494   2 002101  82C7 004E                            LB,'0080'X        NA,AUTO
  27494   2 002103       0080
          2 002104  0581 0009                            BBF      s:27497,PREL

     3084    27495    2      THEN
     3085    27496    2           RES = NA.RES;

  27496   2 002106  ABC7 0051                            LAB,B2   NA+3,AUTO
          2 002108  2C00                                 LDV,R2   0
          2 002109  6C02                                 LDV,R6   2
          2 00210A  BBC7 010A                            LAB,B3   RES,AUTO
          2 00210C  3C00                                 LDV,R3   0
          2 00210D  0008                                 MMM

     3086    27497    2      IF NA.ATTRPRES

  27497   2 00210E  82C7 004E                            LB,'0040'X        NA,AUTO
  27497   2 002110       0040
          2 002111  0581 0005                            BBF      s:27501,PREL

     3087    27498    2      THEN
     3088    27499    2           ATTR = NA.ATTR;

  27499   2 002113  E847 0050                            LDR,R6   NA+2,AUTO
          2 002115  EF47 010B                            STR,R6   ATTR,AUTO

     3089    27500
     3090    27501    2      IF CTX$ ~= ADDR(NIL)

  27501   2 002117  8DC7 0019                            CMN      CTX$,AUTO
          2 002119  0901 000F                            BE       s:27507,PREL

     3091    27502    3      THEN DO;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:520  
     3092    27503    3           CTX$->GJA$HAND_CTX.RES = RES;

  27503   2 00211B  ABC7 010A                            LAB,B2   RES,AUTO
          2 00211D  2C00                                 LDV,R2   0
          2 00211E  6C02                                 LDV,R6   2
          2 00211F  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 002121  3C1E                                 LDV,R3   30
          2 002122  0008                                 MMM

     3093    27504    3           CTX$->GJA$HAND_CTX.ATTR = ATTR;

  27504   2 002123  DCC7 0019                            LDB,B5   CTX$,AUTO
          2 002125  E847 010B                            LDR,R6   ATTR,AUTO
          2 002127  EF45 0010                            STR,R6   16,B5

     3094    27505    3           END;

     3095    27506
     3096    27507    2      CHN$ = GJA_CHNLOW$;

  27507   2 002129  DC80 0000 0000  xsym                 LDB,B5   GJA_CHNLOW$
          2 00212C  DFC7 0017                            STB,B5   CHN$,AUTO

     3097    27508
     3098    27509    2      IF GJA_FIRST_TIME

  27509   2 00212E  8980 0000 0000  xsym                 CMZ      GJA_FIRST_TIME
          2 002131  0881 003D                            BAGE     s:27524,PREL

     3099    27510    2      THEN
     3100    27511    3      DO WHILE (CHN$ <= GJA_CHNHI$);

  27511   2 002133  DD80 0000 0000  xsym                 CMB,B5   GJA_CHNHI$
          2 002136  0301 0038                            BG       s:27524,PREL

     3101    27512
     3102    27513    3           IF KH$CHN.RESOURCE = RES AND
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:521  

  27513   2 002138  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 00213A  0022                                 ACM      ;
          2 00213B       4206 0004                                ALPHANUM(4,B6,,2,FILL),;
          2 00213D       4207 010A                                ALPHANUM(RES,AUTO,,2,FILL)
          2 00213F  5301 0025                            CBNE     s:27520,PREL
          2 002141  E846 0005                            LDR,R6   5,B6
          2 002143  8656                                 CPL      R6
          2 002144  E547 010B                            AND,R6   ATTR,AUTO
          2 002146  6981 001E                            BNEZ,R6  s:27520,PREL

     3103    27514    3             (ATTR & ~KH$CHN.ATTR )='0'B
     3104    27515    4           THEN DO;

     3105    27516    4                KL$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN#;

  27516   2 002148  6C01                                 LDV,R6   1
          2 002149  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 00214B       00FF

     3106    27517    4                KL$TERMINAL_ID.TERM.CHANNEL = KH$CHN.CHNBIT0_9 * 64;

  27517   2 00214C  D806                                 LDR,R5   ,B6
          2 00214D  D570 FFC0                            AND,R5   -64,IMO
          2 00214F  DF47 0047                            STR,R5   KL$TERMINAL_ID+1,AUTO

     3107    27518    4                CALL GJA$UPDATE_CHNTBL(NA,KL$TERMINAL_ID,HNDCMN);

  27518   2 002151  DBC7 0052                            LAB,B5   HNDCMN,AUTO
          2 002153  DFC7 0118                            STB,B5   SUBSUB$+6,AUTO
          2 002155  CBC7 0046                            LAB,B4   KL$TERMINAL_ID,AUTO
          2 002157  CFC7 0116                            STB,B4   SUBSUB$+4,AUTO
          2 002159  BBC7 004E                            LAB,B3   NA,AUTO
          2 00215B  BFC7 0114                            STB,B3   SUBSUB$+2,AUTO
          2 00215D  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 00215F  CBF0 0300                            LAB,B4   768,IMO
          2 002161  E380 0000 0000  xent                 LNJ,B6   GJA$UPDATE_CHNTBL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:522  
          2 002164       0001                            DC       s:27520,PREL

     3108    27519    4                END;

     3109    27520    3           CHN$ = PINCRW(CHN$,SIZEW(KH$CHN));

  27520   2 002165  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 002167  DBC6 0020                            LAB,B5   32,B6
          2 002169  DFC7 0017                            STB,B5   CHN$,AUTO

     3110    27521    3           END;

  27521   2 00216B  DD80 0000 0000  xsym                 CMB,B5   GJA_CHNHI$
          2 00216E  03CA                                 BLE      s:27513,SPREL

     3111    27522
     3112    27523        /* If MSGSIZE is non zero there is a default profile */
     3113    27524    2      IF KL$CHNRSP.MESSAGE.MSGSIZE ~= 0

  27524   2 00216F  ECC7 0004                            LDB,B6   @GJA$PARAMS,AUTO
          2 002171  CCC6 0006                            LDB,B4   6,B6
          2 002173  E844 001A                            LDR,R6   26,B4
          2 002175  6901 0043                            BEZ,R6   s:27534,PREL

     3114    27525    3      THEN DO;

     3115    27526    3           ADDR(VDO_BUFFER)->KL$PRFRSP.FCN = IGA_PRFRSP;

  27526   2 002177  5C42                                 LDV,R5   66
          2 002178  D780 0000 0040  00                   STH,R5   VDO_BUFFER

     3116    27527    3           ADDR(VDO_BUFFER)->KL$PRFRSP.PROFILE.PRFSIZE = KL$CHNRSP.MESSAGE.MSGSIZE;

  27527   2 00217B  CCC6 0006                            LDB,B4   6,B6
          2 00217D  E844 001A                            LDR,R6   26,B4
          2 00217F  EF00 0000 0043  00                   STR,R6   VDO_BUFFER+3

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:523  
     3117    27528    3           ADDR(VDO_BUFFER)->KL$PRFRSP.PROFILE.PRFTXT = KL$CHNRSP.MESSAGE.MESSAGE;

  27528   2 002182  CCC6 0006                            LDB,B4   6,B6
          2 002184  C844 001A                            LDR,R4   26,B4
          2 002186  CF47 0114                            STR,R4   SUBSUB$+2,AUTO
          2 002188  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 00218A  AB84                                 LAB,B2   ,B4
          2 00218B  2C36                                 LDV,R2   54
          2 00218C  E854                                 LDR,R6   R4
          2 00218D  BB80 0000 0044  00                   LAB,B3   VDO_BUFFER+4
          2 002190  3C00                                 LDV,R3   0
          2 002191  F800 0000 0043  00                   LDR,R7   VDO_BUFFER+3
          2 002194  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

     3118    27529    3           IF CTX$ ~= ADDR(NIL)

  27529   2 002197  8DC7 0019                            CMN      CTX$,AUTO
          2 002199  0901 001F                            BE       s:27534,PREL

     3119    27530    3           THEN
     3120    27531    3                CALL GJA$SEND_MSG(CTX$,VDO_BUFFER,SIZEC(ADDR(VDO_BUFFER)->KL$PRFRSP));

  27531   2 00219B  E800 0000 0043  00                   LDR,R6   VDO_BUFFER+3
          2 00219E  6003                                 SOL,R6   3
          2 00219F  6E4F                                 ADV,R6   79
          2 0021A0  6044                                 SOR,R6   4
          2 0021A1  6001                                 SOL,R6   1
          2 0021A2  EF47 0114                            STR,R6   SUBSUB$+2,AUTO
          2 0021A4  EBC7 0114                            LAB,B6   SUBSUB$+2,AUTO
          2 0021A6  EFC7 0119                            STB,B6   SUBSUB$+7,AUTO
          2 0021A8  DB80 0000 0040  00                   LAB,B5   VDO_BUFFER
          2 0021AB  DFC7 0117                            STB,B5   SUBSUB$+5,AUTO
          2 0021AD  CBC7 0019                            LAB,B4   CTX$,AUTO
          2 0021AF  CFC7 0115                            STB,B4   SUBSUB$+3,AUTO
          2 0021B1  BBC7 0115                            LAB,B3   SUBSUB$+3,AUTO
          2 0021B3  CBF0 0300                            LAB,B4   768,IMO
          2 0021B5  E380 0000 0000  xent                 LNJ,B6   GJA$SEND_MSG
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:524  
          2 0021B8       0001                            DC       s:27534,PREL

     3121    27532    3           END;

     3122    27533
     3123    27534    2      RETURN;

  27534   2 0021B9  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
          2 0021BB  C3C6 0001                            LNJ,B4   1,B6

     3124    27535
     3125    27536    2   END DEFAULT_HAND;
     3126    27537        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:525  
     3127    27538    1   CONVERT_STATE: PROC(STATUS);

  27538   2 0021BD  EFC7 0108            CONVERT_STATE   STB,B6   OSILINKCHG+16,AUTO

     3128    27539    2   DCL STATUS UBIN;
     3129    27540
     3130    27541    3      DO CASE(STATUS);

  27541   2 0021BF  DCC7 010A                            LDB,B5   @STATUS,AUTO
          2 0021C1  B805                                 LDR,R3   ,B5
          2 0021C2  3EFC                                 ADV,R3   -4
          2 0021C3  3D08                                 CMV,R3   8
          2 0021C4  0281 001B                            BGE      s:27553,PREL
          2 0021C6  A830 0000 21CC  02                   LDR,R2   s:27541+13,R3
          2 0021C9  83A0 0000 21D4  02                   JMP      s:27544,R2
          2 0021CC       0004                            DC       s:27547,PREL
          2 0021CD       000C                            DC       s:27553,PREL
          2 0021CE       0000                            DC       s:27544,PREL
          2 0021CF       000C                            DC       s:27553,PREL
          2 0021D0       000C                            DC       s:27553,PREL
          2 0021D1       000C                            DC       s:27553,PREL
          2 0021D2       000C                            DC       s:27553,PREL
          2 0021D3       0008                            DC       s:27550,PREL

     3131    27542
     3132    27543    3       CASE (%KH#CHN_STT_PRT);

     3133    27544    3         STATUS = %CHNST_PART#;

  27544   2 0021D4  6C01                                 LDV,R6   1
          2 0021D5  EF05                                 STR,R6   ,B5
          2 0021D6  0F81 000B                            B        s:27557,PREL

     3134    27545
     3135    27546    3       CASE (%KH#CHN_STT_DSB);

     3136    27547    3         STATUS = %CHNST_DSB#;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:526  

  27547   2 0021D8  6C02                                 LDV,R6   2
          2 0021D9  EF05                                 STR,R6   ,B5
          2 0021DA  0F81 0007                            B        s:27557,PREL

     3137    27548
     3138    27549    3       CASE (%KH#CHN_STT_DIAG);

     3139    27550    3         STATUS = %CHNST_DIAG#;

  27550   2 0021DC  6C03                                 LDV,R6   3
          2 0021DD  EF05                                 STR,R6   ,B5
          2 0021DE  0F81 0003                            B        s:27557,PREL

     3140    27551
     3141    27552    3       CASE (ELSE);

     3142    27553    3         STATUS = %CHNST_ENB#;

  27553   2 0021E0  6C04                                 LDV,R6   4
          2 0021E1  EF05                                 STR,R6   ,B5

     3143    27554
     3144    27555    3         END;

     3145    27556
     3146    27557    2      RETURN;

  27557   2 0021E2  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
          2 0021E4  C3C6 0001                            LNJ,B4   1,B6

     3147    27558
     3148    27559    2   END CONVERT_STATE;
     3149    27560        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:527  
     3150    27561    1   FIND_NODE: PROC(NODE#,NM$) ALTRET;

  27561   2 0021E6  EFC7 0108            FIND_NODE       STB,B6   OSILINKCHG+16,AUTO

     3151    27562
     3152    27563    2   DCL NODE# UBIN;
     3153    27564    2   DCL NM$ PTR;
     3154    27565
     3155    27566    2      NM$ = GJA_NM_HEAD$;

  27566   2 0021E8  DC80 0000 0000  xsym                 LDB,B5   GJA_NM_HEAD$
          2 0021EB  CCC7 010C                            LDB,B4   @NM$,AUTO
          2 0021ED  DF84                                 STB,B5   ,B4

     3156    27567
     3157    27568    3      DO WHILE(NM$ ~= ADDR(NIL));

  27568   2 0021EE  0F81 001A                            B        s:27574,PREL

     3158    27569    3           IF NM$->GJA$HAND_CTX.NODE = NODE#

  27569   2 0021F0  ECC7 010C                            LDB,B6   @NM$,AUTO
          2 0021F2  DC86                                 LDB,B5   ,B6
          2 0021F3  CCC7 010A                            LDB,B4   @NODE#,AUTO
          2 0021F5  E845 000D                            LDR,R6   13,B5
          2 0021F7  E570 00FF                            AND,R6   255,IMO
          2 0021F9  E904                                 CMR,R6   ,B4
          2 0021FA  0981 0009                            BNE      s:27573,PREL
          2 0021FC  8285                                 LB,'1FFF'X        ,B5
          2 0021FD       1FFF
          2 0021FE  0581 0005                            BBF      s:27573,PREL

     3159    27570    3             AND NM$->GJA$HAND_CTX.LDCTX ~=0
     3160    27571    3           THEN
     3161    27572    3                RETURN;

  27572   2 002200  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:528  
          2 002202  C3C6 0001                            LNJ,B4   1,B6

     3162    27573    3           NM$ = CTX$->GJA$HAND_CTX.LNK$;

  27573   2 002204  BCC7 0019                            LDB,B3   CTX$,AUTO
          2 002206  ACC3 0001                            LDB,B2   1,B3
          2 002208  AF86                                 STB,B2   ,B6

     3163    27574    3           END;

  27574   2 002209  ECC7 010C                            LDB,B6   @NM$,AUTO
          2 00220B  8D86                                 CMN      ,B6
          2 00220C  09E4                                 BNE      s:27569,SPREL

     3164    27575
     3165    27576    2      ALTRETURN;

  27576   2 00220D  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
          2 00220F  B806                                 LDR,R3   ,B6
          2 002210  C3B6                                 LNJ,B4   ,B6,R3

     3166    27577
     3167    27578    2   END FIND_NODE;
     3168    27579        %EJECT;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:529  
     3169    27580    1   CHN_HANDLER: PROC ALTRET;

  27580   2 002211  EFC7 0108            CHN_HANDLER     STB,B6   OSILINKCHG+16,AUTO

     3170    27581
     3171    27582    2      THAND$ = ADDR(NIL);

  27582   2 002213  DB80 0000 0000                       LAB,B5   0
          2 002216  DFC7 001D                            STB,B5   THAND$,AUTO

     3172    27583    2      KL$TERMINAL_ID.LEV = TERMLO.LEV;

  27583   2 002218  E847 005B                            LDR,R6   TERMLO,AUTO
          2 00221A  EAC7 0046                            SRM,R6,'00FF'X    KL$TERMINAL_ID,AUTO
          2 00221C       00FF

     3173    27584    3      DO CHAN = CHANLO TO CHANHI BY 128;

  27584   2 00221D  D847 003C                            LDR,R5   CHANLO,AUTO
          2 00221F  DF47 003B                            STR,R5   CHAN,AUTO
          2 002221  0F81 0067                            B        s:27611+6,PREL

     3174    27585    4           DO SUB = SUBLO TO SUBHI;

  27585   2 002223  E847 003F                            LDR,R6   SUBLO,AUTO
          2 002225  EF47 003E                            STR,R6   SUB,AUTO
          2 002227  0F81 0055                            B        s:27610+2,PREL

     3175    27586    5                DO SUBSUB = SUBSUBLO TO SUBSUBHI;

  27586   2 002229  E847 0042                            LDR,R6   SUBSUBLO,AUTO
          2 00222B  EF47 0041                            STR,R6   SUBSUB,AUTO
          2 00222D  0F81 0047                            B        s:27609+2,PREL

     3176    27587    5                     KL$TERMINAL_ID.TERM.CHANNEL = CHAN;

  27587   2 00222F  E847 003B                            LDR,R6   CHAN,AUTO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:530  
          2 002231  EF47 0047                            STR,R6   KL$TERMINAL_ID+1,AUTO

     3177    27588    5                     KL$TERMINAL_ID.TERM.SUBDEVICE = SUB;

  27588   2 002233  D847 003E                            LDR,R5   SUB,AUTO
          2 002235  DF47 0048                            STR,R5   KL$TERMINAL_ID+2,AUTO

     3178    27589    5                     KL$TERMINAL_ID.TERM.SUBSUBDEVICE = SUBSUB;

  27589   2 002237  C847 0041                            LDR,R4   SUBSUB,AUTO
          2 002239  CF47 0049                            STR,R4   KL$TERMINAL_ID+3,AUTO

     3179    27590    6                     CALL GJA$GET_CHNTBL_PTR(KL$TERMINAL_ID,CHN$) WHENALTRETURN DO;

  27590   2 00223B  EBC7 0017                            LAB,B6   CHN$,AUTO
          2 00223D  EFC7 0116                            STB,B6   SUBSUB$+4,AUTO
          2 00223F  DBC7 0046                            LAB,B5   KL$TERMINAL_ID,AUTO
          2 002241  DFC7 0114                            STB,B5   SUBSUB$+2,AUTO
          2 002243  BBC7 0114                            LAB,B3   SUBSUB$+2,AUTO
          2 002245  CBF0 0200                            LAB,B4   512,IMO
          2 002247  E380 0000 0000  xent                 LNJ,B6   GJA$GET_CHNTBL_PTR
          2 00224A       0003                            DC       s:27591,PREL
          2 00224B  0F81 000A                            B        s:27594,PREL

     3180    27591    6                          ADMIN.RESULTS=E$CHAN_NOT_THERE;

  27591   2 00224D  8C80 0000 000E  00                   LDI      E$CHAN_NOT_THERE
          2 002250  8D47 00A2                            SDI      ADMIN+14,AUTO

     3181    27592    6                          ALTRETURN;

  27592   2 002252  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
          2 002254  B806                                 LDR,R3   ,B6
          2 002255  C3B6                                 LNJ,B4   ,B6,R3

     3182    27593    6                          END;
     3183    27594    6                     IF KH$CHN.HAND$ ~= ADDR(NIL) AND THAND$ ~= ADDR(NIL) THEN DO;
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:531  

  27594   2 002256  ECC7 0017                            LDB,B6   CHN$,AUTO
          2 002258  8DC6 001E                            CMN      30,B6
          2 00225A  0901 0014                            BE       s:27608,PREL
          2 00225C  8DC7 001D                            CMN      THAND$,AUTO
          2 00225E  0901 0010                            BE       s:27608,PREL

     3184    27595    6                          IF KH$CHN.HAND$ ~= THAND$ THEN

  27595   2 002260  DCC6 001E                            LDB,B5   30,B6
          2 002262  DDC7 001D                            CMB,B5   THAND$,AUTO
          2 002264  0901 000E                            BE       s:27609,PREL

     3185    27596    7                          DO;

     3186    27597    7                               ADMIN.RESULTS=E$ADMIN_ERR;

  27597   2 002266  8C80 0000 0012  00                   LDI      E$ADMIN_ERR
          2 002269  8D47 00A2                            SDI      ADMIN+14,AUTO

     3187    27598        /*E* ERROR: GJA-E$ADMIN_ERR
     3188    27599             MESSAGE: The range of channels specified in your admin request do not
     3189    27600                      belong to the same handler.
     3190    27601             MESSAGE1: Admin commands such as kill,enable,part etc when executed on
     3191    27602                       a range of channels will not work if the channels do not
     3192    27603                       belong to the same handler. KH$CHN.HAND$                 */
     3193    27604    7                               ALTRETURN;

  27604   2 00226B  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
          2 00226D  B806                                 LDR,R3   ,B6
          2 00226E  C3B6                                 LNJ,B4   ,B6,R3

     3194    27605    7                               END;
     3195    27606    6                          END;
     3196    27607    5                     ELSE
     3197    27608    5                          THAND$ = KH$CHN.HAND$;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:532  
  27608   2 00226F  DCC6 001E                            LDB,B5   30,B6
          2 002271  DFC7 001D                            STB,B5   THAND$,AUTO

     3198    27609    5                     END;                  /*SUBSUB*/

  27609   2 002273  8AC7 0041                            INC      SUBSUB,AUTO
          2 002275  E847 0041                            LDR,R6   SUBSUB,AUTO
          2 002277  E947 0043                            CMR,R6   SUBSUBHI,AUTO
          2 002279  0381 FFB5                            BLE      s:27587,PREL

     3199    27610    4                END;                       /*SUB*/

  27610   2 00227B  8AC7 003E                            INC      SUB,AUTO
          2 00227D  E847 003E                            LDR,R6   SUB,AUTO
          2 00227F  E947 0040                            CMR,R6   SUBHI,AUTO
          2 002281  0381 FFA7                            BLE      s:27586,PREL

     3200    27611    3           END;                            /*CHAN*/

  27611   2 002283  D847 003B                            LDR,R5   CHAN,AUTO
          2 002285  DA70 0080                            ADD,R5   128,IMO
          2 002287  DF47 003B                            STR,R5   CHAN,AUTO
          2 002289  D947 003D                            CMR,R5   CHANHI,AUTO
          2 00228B  0381 FF97                            BLE      s:27585,PREL

     3201    27612    2   END CHN_HANDLER;

  27612   2 00228D  ECC7 0108                            LDB,B6   OSILINKCHG+16,AUTO
          2 00228F  C3C6 0001                            LNJ,B4   1,B6
     3202    27613    1   END GJA$DECODE_APL_MSG;
     3203    27614        %EOD;

PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:533  
--  Include file information  --

   K_ADDRESS_M.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   K_ID_E.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KN_ERRORS_C.:E05TOU  is referenced.
   KNN_NETWORK_M.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   KI_ERRORS_C.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   KNH_MACRO_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KH$IO.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   GJA_MSG_M.:E05TOU  is referenced.
   GH_IOFNC_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure GJA$DECODE_APL_MSG.
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:534  

 **** Variables and constants ****

  ****  Section 000  Data  GJA$DECODE_APL_MSG

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    3D-0-0/w STRC(48)    r     1 BADFNC                    12-0-0/w STRC(32)    r     1 E$ADMIN_ERR
    18-0-0/w STRC(32)    r     1 E$CANTPART                2A-0-0/w STRC(32)    r     1 E$CHAN_DIAG
    1A-0-0/w STRC(32)    r     1 E$CHAN_NOT_PART            E-0-0/w STRC(32)    r     1 E$CHAN_NOT_THERE
    22-0-0/w STRC(32)    r     1 E$CHAN_OWNED              28-0-0/w STRC(32)    r     1 E$CHAN_PART
     C-0-0/w STRC(32)    r     1 E$CONT_NOT_PART           20-0-0/w STRC(32)    r     1 E$CONT_OWNED
    32-0-0/w STRC(32)    r     1 E$NOHANDLER               26-0-0/w STRC(32)    r     1 E$NOTYOURS
    2E-0-0/w STRC(32)    r     1 E$NOT_OWNED               24-0-0/w STRC(32)    r     1 E$NO_DEVICES
    10-0-0/w STRC(32)    r     1 E$NO_MORE_DEVICES          0-0-0/w STRC(48)    r     1 FPT_AFD
     3-0-0/w STRC(48)    r     1 FPT_MAKEUSR                6-0-0/d STRC(80)    r     1 FPT_RUE
    37-0-0/w STRC(48)    r     1 HOSTBOOT                  34-0-0/w STRC(48)    r     1 HOSTKEYIN
    3A-0-0/w STRC(48)    r     1 NODEDEV
    40-0-0/c CHAR        r     1 VDO_BUFFER(0:767)

  ****  Section 001 RoData GJA$DECODE_APL_MSG

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(32)    r     1 E$NONETMAN                 F-0-0/w STRC(16)    r     1 GJA_STOK
     2-0-0/w STRC(80)    r     1 KV_VDO_RQSDAT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

   10E-0-0/w PTR         r     1 @BAS_CHN                 10A-0-0/w PTR         r     1 @CTX$
     4-0-0/w PTR         r     1 @GJA$PARAMS                6-0-0/w PTR         r     1 @MSGCTX$
   10C-0-0/w PTR         r     1 @NM$                     10A-0-0/w PTR         r     1 @NODE#
   10A-0-0/w PTR         r     1 @STATUS                   94-0-0/w STRC(1056)  r     1 ADMIN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:535  
   10B-0-0/b BIT (16)    r     1 ATTR                      39-0-0/w UBIN(16)    r     1 BASECHAN
    *0-0-0/w STRC(512)   r     1 BAS_CHN                   3B-0-0/w UBIN(16)    r     1 CHAN
    3D-0-0/w UBIN(16)    r     1 CHANHI                    3C-0-0/w UBIN(16)    r     1 CHANLO
    17-0-0/w PTR         r     1 CHN$                      19-0-0/w UBIN(32)    r     1 CTX
    19-0-0/w PTR         r     1 CTX$                      *0-0-0/w PTR         r     1 CTX$
    *0-0-0/w STRC(368)   r     1 GJA$PARAMS                52-0-0/w STRC(144)   r     1 HNDCMN
    15-0-0/w UBIN(16)    r     1 I                         13-0-0/w PTR         r     1 KL$
    46-0-0/w STRC(128)   r     1 KL$TERMINAL_ID             8-0-0/w STRC(80)    r     1 KV@VDO_RQSDAT
    3A-0-0/w UBIN(16)    r     1 LASTCHAN                  44-0-0/w UBIN(16)    r     1 LEV
     D-0-0/w PTR         r     1 LINK$                     21-0-0/w PTR         r     1 LVL2$
    23-0-0/w PTR         r     1 LVL3$                     45-0-0/w UBIN(16)    r     1 MAXLEV
    *0-0-0/w PTR         r     1 MSGCTX$                   33-0-0/w UBIN(16)    r     1 MSGSIZ
    4E-0-0/c STRC(64)    r     1 NA                        *0-0-0/w PTR         r     1 NM$
    2D-0-0/w UBIN(32)    r     1 NMID                      2D-0-0/w PTR         r     1 NMID$
    *0-0-0/w UBIN(16)    r     1 NODE#                     D6-0-0/w STRC(56)    r     1 NODECHG
    2B-0-0/w PTR         r     1 OSI$                      F8-0-0/w STRC(256)   r     1 OSILINKCHG
   10A-0-0/c CHAR(2)     r     1 RES                        F-0-0/w PTR         r     1 ROUTE$
    35-0-0/w PTR         r     1 RSP$                      6B-0-0/w STRC(656)   r     1 SGNRSP
    34-0-0/w UBIN(16)    r     1 SIZE                      11-0-0/w PTR         r     1 STARTCHN$
    *0-0-0/w UBIN(16)    r     1 STATUS                    3E-0-0/w UBIN(16)    r     1 SUB
   110-0-0/w PTR         r     1 SUB$                      40-0-0/w UBIN(16)    r     1 SUBHI
    3F-0-0/w UBIN(16)    r     1 SUBLO                     41-0-0/w UBIN(16)    r     1 SUBSUB
   112-0-0/w PTR         r     1 SUBSUB$                   43-0-0/w UBIN(16)    r     1 SUBSUBHI
    42-0-0/w UBIN(16)    r     1 SUBSUBLO                  32-0-0/b BIT (16)    r     1 SVATTR
    31-0-0/w UBIN(16)    r     1 SVCHAN                    2F-0-0/w PTR         r     1 SVCHN$
    1F-0-0/w PTR         r     1 TCHN$                     63-0-0/w STRC(128)   r     1 TERMHI
    5B-0-0/w STRC(128)   r     1 TERMLO                    1D-0-0/w PTR         r     1 THAND$
    1B-0-0/w UBIN(32)    r     1 UID                       1B-0-0/w PTR         r     1 UID$
    26-0-0/w UBIN(16)    r     1 WHO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$TCB$                     0-0-0/w UBIN(16)    r     1 GID_BOOTCHAN
     0-0-0/w STRC(20496) r     1 GJA$NODETBL                0-0-0/w STRC(544)   r     1 GJA_ADMIN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:536  
     0-0-0/w UBIN(16)    r     1 GJA_CHNHI                  0-0-0/w PTR         r     1 GJA_CHNHI$
     0-0-0/w UBIN(16)    r     1 GJA_CHNLOW                 0-0-0/w PTR         r     1 GJA_CHNLOW$
     0-0-0/w STRC(304)   r     1 GJA_CONNECT                0-0-0/w UBIN(16)    r     1 GJA_DEFNODE
     0-0-0/w PTR         r     1 GJA_ERRMSG_HEAD$           0-0-0/b BIT         r     1 GJA_FIRST_TIME
     0-0-0/w PTR         r     1 GJA_HAND_HEAD$             0-0-0/w UBIN(16)    r     1 GJA_HOPCOST
     0-0-0/w PTR         r     1 GJA_HOSTRESUMED$           0-0-0/b BIT         r     1 GJA_HSTRSMED
     0-0-0/w STRC(32)    r     1 GJA_IO                     0-0-0/w UBIN(16)    r     1 GJA_LDCT_BABOON
     0-0-0/w UBIN(16)    r     1 GJA_LDCT_NM                0-0-0/w PTR         r     1 GJA_LGNTIMEDOUT$
     0-0-0/w UBIN(16)    r     1 GJA_MAXRDS                 0-0-0/w PTR         r     1 GJA_MSG_BDID$
     0-0-0/w PTR         r     1 GJA_MSG_DOWN$              0-0-0/w PTR         r     1 GJA_MSG_HDR$
     0-0-0/w PTR         r     1 GJA_MSG_HOSTDOWN$          0-0-0/w PTR         r     1 GJA_MSG_LINKDOWN$
     0-0-0/w PTR         r     1 GJA_MSG_NOHOST$            0-0-0/w PTR         r     1 GJA_MSG_SALUTE$
     0-0-0/w PTR         r     1 GJA_MSG_SGSYN$             0-0-0/w PTR         r     1 GJA_MSG_UDHOST$
     0-0-0/w PTR         r     1 GJA_NM_HEAD$               0-0-0/w UBIN(16)    r     1 GJA_NODE#
     0-0-0/w PTR         r     1 GJA_NOLOGONMSG$            0-0-0/w PTR         r     1 GJA_OSIROUTE$
     0-0-0/w STRC(48)    r     1 GJA_PARAM_VDO              0-0-0/w STRC(384)   r     1 GJA_PROMPT_VDO
     0-0-0/w PTR         r     1 GJA_ROUTE$                 0-0-0/w ASTR(216)   r     1 GJA_RQSCHN
     0-0-0/w STRC(1904)  r     1 GJA_SYSLOG                 0-0-0/w STRC(64)    r     1 GJA_TERM
     0-0-0/w STRC(32)    r     1 GJA_TERM_ACK               0-0-0/w UBIN(32)    r     1 GJA_UID_BABOON
     0-0-0/w PTR         r     1 GJA_UID_BABOON$            0-0-0/w PTR         r     1 GJA_UID_NANM$
     0-0-0/w UBIN(32)    r     1 GJA_UID_NM                 0-0-0/w PTR         r     1 GJA_UID_NM$
     0-0-0/w PTR         r     1 GJA_USRLGN_HEAD$           0-0-0/w STRC(48)    r     1 GJA_VDO_DAT_DAT1
     0-0-0/w STRC(64)    r     1 GJA_VDO_DAT_DAT2

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(999)   r     1 BUFFER                     0-0-0/w STRC(736)   r     1 G$EXCFR
     0-0-0/w STRC(96)    r     1 G$TCB                      0-0-0/c STRC(160)   r     1 GJA$ERRMSG_CTX
     0-0-0/c STRC(272)   r     1 GJA$HAND_CTX               0-0-0/w STRC(528)   r     1 GJA$LGNCTX
     0-0-0/w STRC(48)    r     1 GJA$PROFILE_VDO            0-0-0/w STRC(48)    r     1 GJA$VDO_DAT_DAT1
     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(512)   r     1 KH$CHN
     0-0-0/w STRC(192)   r     1 KL$ACQUIRE                 0-0-0/w STRC(544)   r     1 KL$ADMIN
     0-0-0/w STRC(128)   r     1 KL$AFD                     0-0-0/w ASTR(432)   r     1 KL$CHNRSP
     0-0-0/w STRC(16)    r     1 KL$CHSCRLVL                0-0-0/w STRC(736)   r     1 KL$CNFG_MSG
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:537  
     0-0-0/w STRC(176)   r     1 KL$CONFIGRQS               0-0-0/w STRC(192)   r     1 KL$CONFIGRSP
     0-0-0/w STRC(352)   r     1 KL$CONTROL                 0-0-0/w STRC(96)    r     1 KL$CWNAK
     0-0-0/w STRC(160)   r     1 KL$DVCERRRSP               0-0-0/w STRC(496)   r     1 KL$ERRMSG_RQS
     0-0-0/w STRC(1024)  r     1 KL$ERRMSG_RSP              0-0-0/w STRC(64)    r     1 KL$ERRMSG_RSPSZ
     0-0-0/w STRC(112)   r     1 KL$FEPST                   0-0-0/w STRC(272)   r     1 KL$HDR
     0-0-0/w STRC(200)   r     1 KL$KEYMES                  0-0-0/w STRC(16)    r     1 KL$MES
     0-0-0/w STRC(56)    r     1 KL$NODECHG                 0-0-0/w STRC(104)   r     1 KL$NODEINFO
     0-0-0/w STRC(256)   r     1 KL$OSILINKCHG              0-0-0/w ASTR(64)    r     1 KL$PRFRSP
     0-0-0/w STRC(96)    r     1 KL$RELEASE                 0-0-0/w STRC(320)   r     1 KL$REQSTATS
     0-0-0/w ASTR(216)   r     1 KL$RQSCHN                  0-0-0/w STRC(320)   r     1 KL$RUE
     0-0-0/w STRC(128)   r     1 KL$SETNODE                 0-0-0/w STRC(248)   r     1 KL$SGN
     0-0-0/w STRC(264)   r     1 KL$SGNRSP                  0-0-0/w STRC(40)    r     1 KL$TIME
     0-0-0/w STRC(480)   r     1 KL$UPDOSI                  0-0-0/w STRC(2096)  r     1 KL$WRITE
     0-0-0/w STRC(1440)  r     1 KL_STRTU                   0-0-0/c STRC(608)   r     1 KNN$LINK
     0-0-0/w STRC(208)   r     1 KNN$ROUTE
     0-0-0/w PTR         r     1 KNN$ROUTE$(0:0)
     0-0-0/c ACHR        r     1 STRING                     0-0-0/c ASTR(8)     r     1 TEXTC_STRING


   Procedure GJA$DECODE_APL_MSG requires 8849 words for executable code.
   Procedure GJA$DECODE_APL_MSG requires 288 words of local(AUTO) storage.
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:538  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:539  
          MINI XREF LISTING

ACQUIRE
     26574**LABEL   26596--EXIT    26610--EXIT
ADMIN
     25580**LABEL   25582<<ASSIGN  25600--EXIT    25613--EXIT    25648--EXIT    25659--EXIT    25677--EXIT
     25687--EXIT    25727<>CALL    25727--CALL    25732<>CALL    25732--CALL    25736<>CALL    25773<<ASSIGN
     25801<>CALL    25801--CALL    25853<>CALL    25853--CALL    25861<>CALL    25861--CALL    25868<>CALL
     25868--CALL    25883<>CALL    25883--CALL    25890<>CALL    25890--CALL    25905<>CALL    25905--CALL
     26320<<ASSIGN  26327<>CALL    26327--CALL    26436<<ASSIGN  26442<>CALL    26442--CALL    27151<<ASSIGN
     27157<>CALL    27157--CALL
ADMIN.FNC
     24843**DCL     26323<<ASSIGN  26441<<ASSIGN  27156<<ASSIGN
ADMIN.HANDLER
     24786**DCL     25646<<ASSIGN
ADMIN.KH$CHN
     24923**DCL     25656<<ASSIGN  25794<<ASSIGN  25852<<ASSIGN  25860<<ASSIGN  25867<<ASSIGN  25882<<ASSIGN
     25889<<ASSIGN
ADMIN.KH$CHN.TERMID.TERM
     25017**DCL     25026--REDEF
ADMIN.RESULTS
     24806**DCL     25586<<ASSIGN  25612<<ASSIGN  25622<<ASSIGN  25633<<ASSIGN  25639<<ASSIGN  25647>>IF
     25674<<ASSIGN  25686<<ASSIGN  25723>>IF      25777<<ASSIGN  25795<<ASSIGN  25799<<ASSIGN  27591<<ASSIGN
     27597<<ASSIGN
ADMIN.SRCE_NODE
     24784**DCL     25729>>ASSIGN
ADMIN.TERMID_HI
     24892**DCL     26322<<ASSIGN  26438<<ASSIGN
ADMIN.TERMID_HI.LEV
     24894**DCL     27154<<ASSIGN
ADMIN.TERMID_HI.TERM
     24894**DCL     24903--REDEF
ADMIN.TERMID_HI.TERM.CHANNEL
     24900**DCL     27155<<ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:540  
ADMIN.TERMID_LO
     24863**DCL     25903<<ASSIGN  26321<<ASSIGN  26437<<ASSIGN
ADMIN.TERMID_LO.LEV
     24865**DCL     27152<<ASSIGN
ADMIN.TERMID_LO.TERM
     24865**DCL     24874--REDEF
ADMIN.TERMID_LO.TERM.CHANNEL
     24871**DCL     27153<<ASSIGN
ADMIN.TYPE
     24783**DCL     25789<<ASSIGN  25793<<ASSIGN  25798<<ASSIGN  25904<<ASSIGN
ALLOCATE_CHAN
     27130**PROC    26384--CALL    26397--CALL    26498--CALL
ATTR IN PROCEDURE DEFAULT_HAND
     27449**DCL     27464<<ASSIGN  27468<<ASSIGN  27472<<ASSIGN  27476<<ASSIGN  27480<<ASSIGN  27485<<ASSIGN
     27491<<ASSIGN  27499<<ASSIGN  27504>>ASSIGN  27513>>IF
BADFNC
     18045**DCL     25469<>CALL
BADLEV
     25798**LABEL   25837--GOTO
BASECHAN
     24328**DCL     26512<<ASSIGN  26536<<ASSIGN  26537>>ASSIGN  26541<<ASSIGN  26542>>ASSIGN  26545<<ASSIGN
     26550<<ASSIGN  26555<<ASSIGN  26563>>ASSIGN  26569<<ASSIGN  26574>>DOWHILE 26576>>IF      26658<<ASSIGN
     26771<<ASSIGN  26772>>ASSIGN  26776<<ASSIGN  26777>>ASSIGN  26780<<ASSIGN  26785<<ASSIGN  26790<<ASSIGN
     26793>>ASSIGN  26798>>DOWHILE 26799>>IF      26815<<ASSIGN  26820<<ASSIGN  26821>>DOWHILE 26836<<ASSIGN
     26882<<ASSIGN  26883>>ASSIGN  26888<<ASSIGN  26889>>ASSIGN  26892<<ASSIGN  26895>>IF      26897>>ASSIGN
BAS_CHN IN PROCEDURE UPDATE_SUBS
     27190**DCL     27173--PROC
BAS_CHN.HAND$ IN PROCEDURE UPDATE_SUBS
     27297**DCL     27434>>ASSIGN  27438>>ASSIGN
BAS_CHN.SUB$ IN PROCEDURE UPDATE_SUBS
     27297**DCL     27430>>ASSIGN
BAS_CHN.SYSID IN PROCEDURE UPDATE_SUBS
     27223**DCL     27435>>ASSIGN  27439>>ASSIGN
BAS_CHN.TERMID.LEV IN PROCEDURE UPDATE_SUBS
     27286**DCL     27427>>IF
BAS_CHN.TERMID.TERM IN PROCEDURE UPDATE_SUBS
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:541  
     27286**DCL     27295--REDEF
BUFFER
     18407**DCL     25919>>ASSIGN  25932>>ASSIGN  25944>>ASSIGN  25957>>ASSIGN  25969>>ASSIGN  25981>>ASSIGN
     25993>>ASSIGN  26005>>ASSIGN  26012>>ASSIGN  26023>>ASSIGN  26036<>CALL    26053>>ASSIGN  26065>>ASSIGN
     26076>>ASSIGN  26087>>ASSIGN  26918<>CALL
CASEFNC
     25652**LABEL   25704--EXIT
CHAN
     26575**LABEL   25605<<DOINDEX 25608>>ASSIGN  25753<<DOINDEX 25756>>ASSIGN  25842<<DOINDEX 25844>>ASSIGN
     26284<<DOINDEX 26287>>ASSIGN  26577--EXIT    26598--EXIT    27584<<DOINDEX 27587>>ASSIGN
CHANHI
     24332**DCL     25593<<ASSIGN  25605>>DOINDEX 25746<<ASSIGN  25753>>DOINDEX 25841<<ASSIGN  25842>>DOINDEX
     26277<<ASSIGN  26284>>DOINDEX 27584>>DOINDEX
CHANLO
     24331**DCL     25592<<ASSIGN  25605>>DOINDEX 25745<<ASSIGN  25753>>DOINDEX 25840<<ASSIGN  25842>>DOINDEX
     26276<<ASSIGN  26284>>DOINDEX 27584>>DOINDEX
CHECK
     26798**LABEL   26805--EXIT    26811--EXIT
CHN
     26821**LABEL   26835--EXIT
CHN$
     24304**DCL     18943--IMP-PTR 25611<>CALL    25616>>ASSIGN  25617>>IF      25629>>IF      25637>>IF
     25656>>ASSIGN  25664>>IF      25666>>ASSIGN  25671>>IF      25684>>IF      25697>>IF      25697>>IF
     25700>>ASSIGN  25702>>ASSIGN  25703>>CALL    25709>>ASSIGN  25792<>CALL    25794>>ASSIGN  25811<>CALL
     25814<>CALL    25847<>CALL    25848>>IF      25852>>ASSIGN  25855>>ASSIGN  26295<>CALL    26324<>CALL
     26325>>IF      26327>>CALL    26352<>CALL    26353>>ASSIGN  26403<>CALL    26407<>CALL    26432<>CALL
     26434>>IF      26439>>IF      26442>>CALL    26480<>CALL    26482>>IF      26530<>CALL    26534>>IF
     26539>>IF      26564<>CALL    26565>>ASSIGN  26566>>IF      26566>>IF      26569>>ASSIGN  26574>>DOWHILE
     26583>>IF      26583>>IF      26605>>IF      26617>>IF      26617>>IF      26622>>ASSIGN  26623>>IF
     26624>>ASSIGN  26632>>IF      26635>>ASSIGN  26636>>ASSIGN  26637>>ASSIGN  26643>>ASSIGN  26646>>ASSIGN
     26648>>ASSIGN  26649>>ASSIGN  26650>>ASSIGN  26657<<ASSIGN  26657>>ASSIGN  26658>>ASSIGN  26672>>DOWHILE
     26760<>CALL    26769>>IF      26774>>IF      26794<>CALL    26795>>ASSIGN  26802>>IF      26808>>IF
     26814<<ASSIGN  26814>>ASSIGN  26815>>ASSIGN  26819<<ASSIGN  26820>>ASSIGN  26822>>IF      26824>>ASSIGN
     26825>>ASSIGN  26826>>IF      26828>>ASSIGN  26829>>IF      26831>>CALL    26833<<ASSIGN  26833>>ASSIGN
     26834>>IF      26836>>ASSIGN  26861<>CALL    26870>>ASSIGN  26871>>IF      26878>>ASSIGN  26879>>ASSIGN
     26880>>IF      26886>>IF      26898<>CALL    26899>>DOWHILE 26900>>ASSIGN  26904<<ASSIGN  26904>>ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:542  
     26914<>CALL    26917>>IF      26918>>CALL    27134<<ASSIGN  27135>>DOWHILE 27136>>IF      27138>>ASSIGN
     27139>>IF      27139>>IF      27139>>IF      27139>>IF      27139>>IF      27145>>ASSIGN  27146>>ASSIGN
     27147>>CALL    27149<<ASSIGN  27149>>ASSIGN  27507<<ASSIGN  27511>>DOWHILE 27513>>IF      27513>>IF
     27517>>ASSIGN  27520<<ASSIGN  27520>>ASSIGN  27590<>CALL    27594>>IF      27595>>IF      27608>>ASSIGN
CHNOK
     25847**LABEL   25849--EXIT
CHN_HANDLER
     27580**PROC    25599--CALL
CONFIG_XIT
     26907**LABEL   26864--GOTO    26874--GOTO
CONTACT_NA
     26924**LABEL   27053--GOTO
CONVERT_STATE
     27538**PROC    26876--CALL    26901--CALL
CTX
     24306**DCL     26159>>ASSIGN
CTX$
     24305**DCL     19053--IMP-PTR 24306--REDEF   25429<<ASSIGN  25431>>ASSIGN  25440>>ASSIGN  25440>>ASSIGN
     25441>>IF      25441>>IF      25444<>CALL    25445>>ASSIGN  25457>>IF      25467>>IF      25477>>IF
     25512<<ASSIGN  25513>>DOWHILE 25514>>IF      25516<>CALL    25522<<ASSIGN  25522>>ASSIGN  25524>>IF
     25535>>ASSIGN  25541<>CALL    25543<>CALL    25550<<ASSIGN  25551>>DOWHILE 25552>>IF      25554<>CALL
     25555<<ASSIGN  25555>>ASSIGN  25559>>ASSIGN  25561<>CALL    25563<>CALL    25583>>ASSIGN  25646>>ASSIGN
     25695<<ASSIGN  25696>>DOWHILE 25697>>IF      25697>>IF      25700>>ASSIGN  25701>>ASSIGN  25702>>ASSIGN
     25706<<ASSIGN  25706>>ASSIGN  25730<>CALL    25732<>CALL    25774>>ASSIGN  25801<>CALL    25853<>CALL
     25861<>CALL    25868<>CALL    25883<>CALL    25890<>CALL    25905<>CALL    25909>>IF      25912>>IF
     25923>>IF      25925>>IF      25937>>IF      25950>>IF      25962>>IF      25974>>IF      25986>>IF
     25998>>IF      26016>>IF      26046>>IF      26058>>IF      26069>>IF      26080>>IF      26145>>ASSIGN
     26146<>CALL    26147>>ASSIGN  26148>>ASSIGN  26149>>ASSIGN  26150>>ASSIGN  26151>>ASSIGN  26152>>ASSIGN
     26154>>ASSIGN  26156>>ASSIGN  26157>>ASSIGN  26161>>ASSIGN  26164>>ASSIGN  26169<<ASSIGN  26170>>IF
     26170>>IF      26193<>CALL    26208<<ASSIGN  26209>>DOWHILE 26210>>IF      26212<<ASSIGN  26212>>ASSIGN
     26214>>IF      26217>>IF      26219>>IF      26221>>ASSIGN  26224<>CALL    26227>>ASSIGN  26228<>CALL
     26233>>ASSIGN  26234<>CALL    26236>>ASSIGN  26237>>ASSIGN  26238>>ASSIGN  26239>>ASSIGN  26240>>ASSIGN
     26243>>ASSIGN  26245>>ASSIGN  26246>>ASSIGN  26249>>ASSIGN  26256<<ASSIGN  26257>>DOWHILE 26258>>IF
     26260<<ASSIGN  26260>>ASSIGN  26262>>IF      26265<>CALL    26268<>CALL    26340>>ASSIGN  26353<<ASSIGN
     26356<>CALL    26359<>CALL    26368>>IF      26370<<ASSIGN  26372>>DOWHILE 26373>>IF      26376<<ASSIGN
     26376>>ASSIGN  26382>>IF      26384<>CALL    26393<<ASSIGN  26394>>DOWHILE 26395>>IF      26397<>CALL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:543  
     26398<<ASSIGN  26398>>ASSIGN  26462<<ASSIGN  26466>>DOWHILE 26467>>IF      26467>>IF      26467>>IF
     26470<>CALL    26473<<ASSIGN  26473>>ASSIGN  26493>>ASSIGN  26494>>ASSIGN  26498<>CALL    26502>>ASSIGN
     26649>>ASSIGN  26650>>ASSIGN  26668<>CALL    26683<<ASSIGN  26684>>DOWHILE 26685>>IF      26687<<ASSIGN
     26687>>ASSIGN  26689>>IF      26691>>IF      26692>>IF      26692>>IF      26692>>IF      26695>>IF
     26697<>CALL    26699<>CALL    26702<>CALL    26704>>ASSIGN  26713<>CALL    26725<>CALL    26727>>ASSIGN
     26728>>IF      26730<>CALL    26735<<ASSIGN  26736>>DOWHILE 26737>>IF      26739<<ASSIGN  26739>>ASSIGN
     26741>>IF      26752<>CALL    26808>>IF      26926<<ASSIGN  26948<>CALL    26952>>ASSIGN  26953>>ASSIGN
     26954>>ASSIGN  26955>>ASSIGN  26958>>ASSIGN  26960>>ASSIGN  26961>>ASSIGN  26963>>ASSIGN  26964<>CALL
     26965>>ASSIGN  26967>>ASSIGN  26972<<ASSIGN  26980>>IF      26982>>ASSIGN  26983>>IF      26985>>ASSIGN
     26992<<ASSIGN  27002>>DOWHILE 27003>>IF      27003>>IF      27006>>IF      27016>>IF      27019<>CALL
     27021<<ASSIGN  27021>>ASSIGN  27024<<ASSIGN  27025>>IF      27027>>IF      27037>>ASSIGN  27060>>ASSIGN
     27064>>ASSIGN  27065>>ASSIGN  27066>>ASSIGN  27109<<ASSIGN  27110>>DOWHILE 27111>>IF      27111>>IF
     27111>>IF      27113<>CALL    27115<<ASSIGN  27115>>ASSIGN  27451<<ASSIGN  27453>>DOWHILE 27454>>IF
     27457<<ASSIGN  27457>>ASSIGN  27488>>IF      27488>>IF      27490>>ASSIGN  27491>>ASSIGN  27501>>IF
     27503>>ASSIGN  27504>>ASSIGN  27529>>IF      27531<>CALL    27573>>ASSIGN
CTX$ IN PROCEDURE ALLOCATE_CHAN
     27132**DCL     27130--PROC    27139>>IF      27139>>IF      27145>>ASSIGN  27146>>ASSIGN  27157<>CALL
CWNAK
     26124**LABEL   26139--GOTO
DEFAULT_HAND
     27446**PROC    26367--CALL
DOCHECKS
     25863**LABEL   25873--GOTO
DOCHECKS1
     25885**LABEL   25895--GOTO
E$ADMIN_ERR
     17009**DCL     27597>>ASSIGN
E$CANTPART
     17147**DCL     25674>>ASSIGN
E$CHAN_DIAG
     17568**DCL     25639>>ASSIGN
E$CHAN_NOT_PART
     17193**DCL     25686>>ASSIGN  26609>>ASSIGN
E$CHAN_NOT_THERE
     16917**DCL     25612>>ASSIGN  25762>>ASSIGN  25799>>ASSIGN  26299>>ASSIGN  26313>>ASSIGN  26529>>ASSIGN
     26567>>ASSIGN  26759>>ASSIGN  27591>>ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:544  
E$CHAN_OWNED
     17380**DCL     26592>>ASSIGN
E$CHAN_PART
     17521**DCL     25633>>ASSIGN
E$CONT_NOT_PART
     16871**DCL     26608>>ASSIGN
E$CONT_OWNED
     17333**DCL     26588>>ASSIGN
E$NOHANDLER
     17803**DCL     25526>>ASSIGN
E$NONETMAN
     17756**DCL     26174>>ASSIGN
E$NOTYOURS
     17474**DCL     26804>>ASSIGN  26810>>ASSIGN
E$NOT_OWNED
     17662**DCL     25622>>ASSIGN
E$NO_DEVICES
     17427**DCL     26663>>ASSIGN
E$NO_MORE_DEVICES
     16963**DCL     26305>>ASSIGN
FIND_NODE
     27561**PROC    25541--CALL    25561--CALL    25730--CALL
FORWARDOSI
     27105**LABEL   27125--GOTO
FPT_AFD
     16816**DCL     26134<>CALL
FPT_AFD.AFD
     16816**DCL     26133<<ASSIGN
FPT_MAKEUSR
     16831**DCL     26120<>CALL
FPT_MAKEUSR.STRTU
     16831**DCL     26119<<ASSIGN
FPT_RUE
     16846**DCL     26111<>CALL
FPT_RUE.V
     16848**DCL     16848--DCLINIT
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:545  
FPT_RUE.V.EVENT
     16853**DCL     26110<<ASSIGN
FPT_RUE.V.USER
     16853**DCL     26109<<ASSIGN
G$EXCFR.P$$
     18502**DCL     18502--REDEF   18502--REDEF
G$EXCFR.PREVSZ
     18452**DCL     18452--REDEF
G$EXCFR.TRLR.ERR
     18782**DCL     26113>>ASSIGN  26127>>ASSIGN
G$EXCFR.TRLR.EVID
     18739**DCL     18757--REDEF   18765--REDEF   18765--REDEF
G$EXCFR.TRLR.SUBC
     18716**DCL     18716--REDEF   18734--REDEF   18738--REDEF   18738--REDEF
G$TCB.ALT$
     18430**DCL     26113>>ASSIGN  26127>>ASSIGN
G$TCB$
     15968**DCL     26113>>ASSIGN  26127>>ASSIGN
GID_BOOTCHAN
     15951**DCL     26479>>ASSIGN
GIJ$DUMPMSG
     25407**DCL-ENT 27081--CALL
GIJ$INITDUMP
     25389**DCL-ENT 26484--CALL
GJA$BLD_CTX
     25396**DCL-ENT 26295--CALL    26407--CALL
GJA$CHK_TRM_RNG
     25397**DCL-ENT 25589--CALL    25780--CALL
GJA$DISOLVE_ERRMSG_CTX
     25394**DCL-ENT 26268--CALL
GJA$DISOLVE_LGNUSR_CTX
     25393**DCL-ENT 26224--CALL    26699--CALL
GJA$ERRMSG_CTX
     18901**DCL     26233--ASSIGN  26236<<ASSIGN
GJA$ERRMSG_CTX.LDCTX
     18907**DCL     26238<<ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:546  
GJA$ERRMSG_CTX.LNK$
     18911**DCL     26245<<ASSIGN  26260>>ASSIGN
GJA$ERRMSG_CTX.NODE
     18925**DCL     26240<<ASSIGN
GJA$ERRMSG_CTX.USR#
     18926**DCL     26237<<ASSIGN
GJA$ERRMSG_CTX.WHO
     18906**DCL     26239<<ASSIGN
GJA$GET_CHNTBL_PTR
     25403**DCL-ENT 25611--CALL    25792--CALL    25811--CALL    25814--CALL    25847--CALL    26324--CALL
     26352--CALL    26403--CALL    26432--CALL    26480--CALL    26530--CALL    26564--CALL    26760--CALL
     26794--CALL    26861--CALL    26898--CALL    26914--CALL    27590--CALL
GJA$GET_CONFIG_INFO
     25401**DCL-ENT 27069--CALL
GJA$HAND_CTX
     19053**DCL     26947--ASSIGN  26952<<ASSIGN
GJA$HAND_CTX.ATTR
     19098**DCL     25697>>IF      26494<<ASSIGN  27139>>IF      27491>>ASSIGN  27504<<ASSIGN
GJA$HAND_CTX.BLK
     19084**DCL     25441>>IF
GJA$HAND_CTX.HOST_NODE
     19083**DCL     26955<<ASSIGN  26983>>IF
GJA$HAND_CTX.LDCTX
     19059**DCL     26170>>IF      27003>>IF      27066>>ASSIGN  27569>>IF
GJA$HAND_CTX.LINK_CONNECTED
     19082**DCL     26967<<ASSIGN  26982<<ASSIGN  27003>>IF      27111>>IF
GJA$HAND_CTX.LNK$
     19063**DCL     25522>>ASSIGN  25555>>ASSIGN  25706>>ASSIGN  26376>>ASSIGN  26398>>ASSIGN  26960<<ASSIGN
     27021>>ASSIGN  27115>>ASSIGN  27457>>ASSIGN  27573>>ASSIGN
GJA$HAND_CTX.LNKDWNRCVD
     19086**DCL     26985<<ASSIGN  27027>>IF      27037<<ASSIGN
GJA$HAND_CTX.NAME
     19077**DCL     25514>>IF      25535>>ASSIGN  25559>>ASSIGN  25646>>ASSIGN  26340>>ASSIGN  26373>>IF
     26502>>ASSIGN  27060<<ASSIGN  27454>>IF
GJA$HAND_CTX.NODE
     19088**DCL     25909>>IF      25912>>IF      25923>>IF      25925>>IF      25937>>IF      25950>>IF
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:547  
     25962>>IF      25974>>IF      25986>>IF      25998>>IF      26016>>IF      26046>>IF      26058>>IF
     26069>>IF      26080>>IF      26465>>IF      26954<<ASSIGN  27006>>IF      27016>>IF      27064>>ASSIGN
     27111>>IF      27569>>IF
GJA$HAND_CTX.RDSOUT
     19068**DCL     25440<<ASSIGN  25440>>ASSIGN  25441>>IF      25445<<ASSIGN
GJA$HAND_CTX.RES
     19094**DCL     25697>>IF      26493<<ASSIGN  27139>>IF      27488>>IF      27490>>ASSIGN  27503<<ASSIGN
GJA$HAND_CTX.SYSID
     19092**DCL     25702>>ASSIGN  26649>>ASSIGN  27146>>ASSIGN
GJA$HAND_CTX.WAT4ACK
     19085**DCL     26965<<ASSIGN  27111>>IF
GJA$HAND_CTX.WHO
     19058**DCL     25431>>ASSIGN  25457>>IF      25467>>IF      25477>>IF      25552>>IF      25583>>ASSIGN
     25774>>ASSIGN  26395>>IF      26953<<ASSIGN
GJA$HOST_RESUMED
     25409**DCL-ENT 26464--CALL
GJA$LGNCTX
     18816**DCL     26145--ASSIGN  26147<<ASSIGN
GJA$LGNCTX.LDCTX
     18822**DCL     26151<<ASSIGN  26219>>IF
GJA$LGNCTX.LNK$
     18826**DCL     25679>>ASSIGN  26040>>ASSIGN  26156<<ASSIGN  26187>>ASSIGN  26212>>ASSIGN  26473>>ASSIGN
     26687>>ASSIGN  26739>>ASSIGN
GJA$LGNCTX.MSG$
     18843**DCL     26227<<ASSIGN
GJA$LGNCTX.NM_NODE
     18840**DCL     26191<<ASSIGN
GJA$LGNCTX.NODE
     18878**DCL     26149<<ASSIGN
GJA$LGNCTX.RETRYCNT
     18841**DCL     26727<<ASSIGN
GJA$LGNCTX.STATUS.DSCRCV
     18891**DCL     26032>>IF      26692>>IF
GJA$LGNCTX.STATUS.INT
     18889**DCL     26032>>IF
GJA$LGNCTX.STATUS.NMRSP
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:548  
     18886**DCL     26161<<ASSIGN  26164<<ASSIGN  26467>>IF
GJA$LGNCTX.STATUS.TERM
     18884**DCL     26032>>IF      26692>>IF      26695>>IF
GJA$LGNCTX.STATUS.TERMACK
     18887**DCL     26032>>IF      26217>>IF      26691>>IF      26704<<ASSIGN
GJA$LGNCTX.STATUS.WAITING_HOST
     18896**DCL     26467>>IF
GJA$LGNCTX.STATUS.WTPRO
     18890**DCL     26467>>IF      26692>>IF      26728>>IF
GJA$LGNCTX.TERMINAL_ID
     18865**DCL     25671>>IF      26150<<ASSIGN
GJA$LGNCTX.TERMINAL_ID.TERM
     18867**DCL     18876--REDEF
GJA$LGNCTX.USER.SYSID
     18845**DCL     26148<<ASSIGN  26221>>ASSIGN
GJA$LGNCTX.WHO
     18821**DCL     26152<<ASSIGN
GJA$LINEPROFILE
     25406**DCL-ENT 26360--CALL
GJA$LOGON_REQUEST_AGAIN
     25400**DCL-ENT 26470--CALL    26730--CALL
GJA$LOGON_RESPONCE
     25398**DCL-ENT 26228--CALL
GJA$NA_INFO
     25411**DCL-ENT 25508--CALL
GJA$NETWORK_MANAGER
     25405**DCL-ENT 25509--CALL    25530--CALL    25538--CALL    25727--CALL    25946--CALL    26160--CALL
     26250--CALL    26341--CALL    26504--CALL    26910--CALL    26937--CALL    26978--CALL
GJA$NODETBL.NODE.HOST
     16005**DCL     26099<<ASSIGN  26101<<ASSIGN
GJA$NODETBL.NODE.NODE
     16008**DCL     26097<<ASSIGN
GJA$NODETBL.NODE#
     16000**DCL     26095>>IF      26096<<ASSIGN
GJA$PARAMS
     15935**DCL        19--PROC
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:549  
GJA$PARAMS.DAT$
     15939**DCL     19117--IMP-PTR 19143--IMP-PTR 19278--IMP-PTR 19347--IMP-PTR 19411--IMP-PTR 19469--IMP-PTR
     19524--IMP-PTR 19645--IMP-PTR 19738--IMP-PTR 19874--IMP-PTR 20049--IMP-PTR 20201--IMP-PTR 20419--IMP-PTR
     20456--IMP-PTR 20480--IMP-PTR 20504--IMP-PTR 20712--IMP-PTR 20800--IMP-PTR 21110--IMP-PTR 21267--IMP-PTR
     21317--IMP-PTR 21373--IMP-PTR 21517--IMP-PTR 21579--IMP-PTR 21938--IMP-PTR 22003--IMP-PTR 22028--IMP-PTR
     22237--IMP-PTR 25448>>IF      25454>>DOCASE  25487>>ASSIGN  25502>>IF      25504>>CALL    25507>>IF
     25508>>CALL    25509>>CALL    25514>>IF      25516>>CALL    25526>>ASSIGN  25530>>CALL    25535>>ASSIGN
     25536>>IF      25538>>CALL    25540>>ASSIGN  25543>>CALL    25554>>CALL    25559>>ASSIGN  25560>>ASSIGN
     25563>>CALL    25582>>ASSIGN  25587>>ASSIGN  25588>>ASSIGN  25617>>IF      25617>>IF      25617>>IF
     25617>>IF      25629>>IF      25629>>IF      25645>>IF      25652>>DOCASE  25721>>IF      25725>>IF
     25741>>ASSIGN  25743>>ASSIGN  25744>>ASSIGN  25759>>ASSIGN  25760>>CALL    25773>>ASSIGN  25778>>ASSIGN
     25779>>ASSIGN  25919>>ASSIGN  25932>>ASSIGN  25944>>ASSIGN  25957>>ASSIGN  25969>>ASSIGN  25981>>ASSIGN
     25993>>ASSIGN  26005>>ASSIGN  26012>>ASSIGN  26023>>ASSIGN  26036>>CALL    26053>>ASSIGN  26065>>ASSIGN
     26076>>ASSIGN  26087>>ASSIGN  26091>>IF      26093>>IF      26095>>IF      26096>>ASSIGN  26097>>ASSIGN
     26097>>ASSIGN  26098>>IF      26099>>ASSIGN  26101>>ASSIGN  26109>>ASSIGN  26110>>ASSIGN  26113>>ASSIGN
     26115>>CALL    26119>>ASSIGN  26124>>ASSIGN  26133>>ASSIGN  26138>>ASSIGN  26148>>ASSIGN  26149>>ASSIGN
     26150>>ASSIGN  26159>>ASSIGN  26160>>CALL    26160>>CALL    26168>>ASSIGN  26173>>ASSIGN  26175<<ASSIGN
     26182>>ASSIGN  26191>>ASSIGN  26192>>ASSIGN  26193>>CALL    26207>>ASSIGN  26221>>ASSIGN  26222>>CALL
     26227>>ASSIGN  26237>>ASSIGN  26249>>ASSIGN  26250>>CALL    26258>>IF      26265>>CALL    26265>>CALL
     26272>>ASSIGN  26274>>ASSIGN  26275>>ASSIGN  26290>>ASSIGN  26291>>CALL    26297>>CALL    26340>>ASSIGN
     26341>>CALL    26341>>CALL    26344>>ASSIGN  26345>>ASSIGN  26346>>ASSIGN  26349>>IF      26351>>ASSIGN
     26354>>IF      26356>>CALL    26356>>CALL    26356>>CALL    26356>>CALL    26359>>CALL    26359>>CALL
     26360>>CALL    26363>>IF      26365>>IF      26373>>IF      26430>>IF      26493>>ASSIGN  26494>>ASSIGN
     26511>>ASSIGN  26514>>ASSIGN  26515>>ASSIGN  26516>>ASSIGN  26526>>IF      26529>>ASSIGN  26531>>ASSIGN
     26532>>IF      26567>>ASSIGN  26570>>ASSIGN  26585>>IF      26587>>IF      26588>>ASSIGN  26592>>ASSIGN
     26605>>IF      26607>>IF      26608>>ASSIGN  26609>>ASSIGN  26617>>IF      26617>>IF      26621>>IF
     26622>>ASSIGN  26623>>IF      26624>>ASSIGN  26632>>IF      26632>>IF      26632>>IF      26635>>ASSIGN
     26636>>ASSIGN  26637>>ASSIGN  26642>>IF      26644>>IF      26644>>IF      26646>>ASSIGN  26647>>IF
     26648>>ASSIGN  26661>>IF      26661>>IF      26663>>ASSIGN  26668>>CALL    26669>>IF      26669>>IF
     26682>>ASSIGN  26692>>IF      26710>>IF      26712>>ASSIGN  26713>>CALL    26713>>CALL    26717>>ASSIGN
     26719>>ASSIGN  26720>>ASSIGN  26720>>ASSIGN  26720>>ASSIGN  26722>>ASSIGN  26723>>IF      26728>>IF
     26734>>ASSIGN  26744>>ASSIGN  26746>>ASSIGN  26747>>ASSIGN  26751>>ASSIGN  26756>>ASSIGN  26758>>ASSIGN
     26759>>ASSIGN  26766>>ASSIGN  26767>>IF      26801>>IF      26802>>IF      26804>>ASSIGN  26810>>ASSIGN
     26817>>IF      26822>>IF      26841>>CALL    26850>>ASSIGN  26851>>ASSIGN  26860>>ASSIGN  26910>>CALL
     26913>>ASSIGN  26918>>CALL    26921>>DOCASE  26925>>ASSIGN  26929>>IF      26935>>ASSIGN  26936>>ASSIGN
     26942>>IF      26942>>IF      26946>>ASSIGN  26954>>ASSIGN  26971>>ASSIGN  26976>>ASSIGN  26977>>ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:550  
     26991>>ASSIGN  26993>>ASSIGN  27008>>ASSIGN  27010>>ASSIGN  27027>>IF      27027>>IF      27032>>IF
     27040>>IF      27040>>IF      27040>>IF      27045>>IF      27050>>IF      27060>>ASSIGN  27061>>IF
     27074>>CALL    27077>>CALL    27081>>CALL    27084>>CALL    27090>>CALL    27098>>ASSIGN  27099>>IF
     27100>>ASSIGN  27101>>CALL    27104>>CALL    27105>>ASSIGN  27111>>IF      27120>>ASSIGN  27122>>ASSIGN
     27123>>ASSIGN  27124>>ASSIGN  27454>>IF      27460>>DOSELCT 27524>>IF      27527>>ASSIGN  27528>>ASSIGN
     27528>>ASSIGN
GJA$PARAMS.DATSIZE
     15940**DCL     25504<>CALL    25509<>CALL    25516<>CALL    25538<>CALL    25543<>CALL    25563<>CALL
     25915>>ASSIGN  25917>>ASSIGN  25928>>ASSIGN  25930>>ASSIGN  25940>>ASSIGN  25942>>ASSIGN  25953>>ASSIGN
     25955>>ASSIGN  25965>>ASSIGN  25967>>ASSIGN  25977>>ASSIGN  25979>>ASSIGN  25989>>ASSIGN  25991>>ASSIGN
     26001>>ASSIGN  26003>>ASSIGN  26009>>ASSIGN  26019>>ASSIGN  26021>>ASSIGN  26036>>CALL    26049>>ASSIGN
     26051>>ASSIGN  26061>>ASSIGN  26063>>ASSIGN  26072>>ASSIGN  26074>>ASSIGN  26083>>ASSIGN  26085>>ASSIGN
     26115<>CALL    26176<<ASSIGN  26193<>CALL    26341<>CALL    26359<>CALL    26910<>CALL    26918<>CALL
GJA$PARAMS.VDO$
     15937**DCL     22766--IMP-PTR
GJA$PROFILE_VDO
     22593**DCL     26716<<ASSIGN  26725<>CALL
GJA$PROFILE_VDO.KV$VDOVLP_DAT2.BYTSIZ
     22644**DCL     26717<<ASSIGN
GJA$Q_MSG
     25387**DCL-ENT 25444--CALL    25504--CALL    26222--CALL    26697--CALL    26702--CALL    26725--CALL
     26752--CALL    26964--CALL
GJA$SEND_MSG
     25404**DCL-ENT 25516--CALL    25543--CALL    25554--CALL    25563--CALL    25732--CALL    25736--CALL
     25769--CALL    25801--CALL    25853--CALL    25861--CALL    25868--CALL    25883--CALL    25890--CALL
     25905--CALL    26036--CALL    26115--CALL    26128--CALL    26193--CALL    26265--CALL    26327--CALL
     26332--CALL    26356--CALL    26359--CALL    26442--CALL    26668--CALL    26713--CALL    26841--CALL
     26907--CALL    26918--CALL    27019--CALL    27074--CALL    27077--CALL    27084--CALL    27090--CALL
     27101--CALL    27104--CALL    27113--CALL    27157--CALL    27531--CALL
GJA$UPDATE_CHNTBL
     25402**DCL-ENT 25760--CALL    26291--CALL    26297--CALL    26418--CALL    27518--CALL
GJA$VDO_DAT_DAT1
     22684**DCL     26743<<ASSIGN  26752<>CALL
GJA$VDO_DAT_DAT1.DATCTRCHR
     22693**DCL     26750<<ASSIGN
GJA$VDO_DAT_DAT1.DATCTRCHRTYP
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:551  
     22692**DCL     26749<<ASSIGN
GJA$VDO_DAT_DAT1.KV$VDOVLP_DAT1.BYTSIZ
     22737**DCL     26744<<ASSIGN
GJA_ADMIN
     24087**DCL     26320>>ASSIGN  26436>>ASSIGN  27151>>ASSIGN
GJA_ADMIN.TERMID_HI.TERM
     24204**DCL     24213--REDEF
GJA_ADMIN.TERMID_LO.TERM
     24175**DCL     24184--REDEF
GJA_CHNHI
     16421**DCL     25805>>IF      25807>>ASSIGN  26556>>ASSIGN  26791>>ASSIGN  27155>>ASSIGN
GJA_CHNHI$
     16424**DCL     26574>>DOWHILE 26834>>IF      27135>>DOWHILE 27511>>DOWHILE
GJA_CHNLOW
     16422**DCL     26555>>ASSIGN  27153>>ASSIGN
GJA_CHNLOW$
     16423**DCL     27134>>ASSIGN  27507>>ASSIGN
GJA_CHN_RSP.ADMIN.CHN.TERMID.TERM
     23939**DCL     23948--REDEF
GJA_CHN_RSP.ADMIN.TERMID_HI.TERM
     23816**DCL     23825--REDEF
GJA_CHN_RSP.ADMIN.TERMID_LO.TERM
     23787**DCL     23796--REDEF
GJA_CONNECT
     16317**DCL     26964--CALL    26964<>CALL
GJA_CONNECT.RLCID.GENERATION
     16353**DCL     16354--REDEF
GJA_CONNECT.RLCID.LDCTX
     16354**DCL     16354--REDEF
GJA_CONNECT.RLCID.NODE
     16353**DCL     26946<<ASSIGN
GJA_CONNECT.TERMINAL_ID.TERM
     16342**DCL     16351--REDEF
GJA_CONNECT_ACK.UID.UID
     16416**DCL     16416--REDEF   16416--REDEF
GJA_DEFNODE
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:552  
     15953**DCL     25909>>IF      25912>>IF      25923>>IF      25925>>IF      25937>>IF      25950>>IF
     25962>>IF      25974>>IF      25986>>IF      25998>>IF      26016>>IF      26046>>IF      26058>>IF
     26069>>IF      26080>>IF      26240>>ASSIGN  26465>>IF      27027>>IF      27040>>IF      27064<<ASSIGN
GJA_ERRMSG_HEAD$
     15970**DCL     26242>>IF      26243<<ASSIGN  26245>>ASSIGN  26246<<ASSIGN  26256>>ASSIGN
GJA_FIRST_TIME
     15979**DCL     26380>>IF      26390>>IF      26392<<ASSIGN  26453>>IF      26496>>IF      27067>>IF
     27136>>IF      27509>>IF
GJA_HAND_HEAD$
     15969**DCL     25512>>ASSIGN  25550>>ASSIGN  25695>>ASSIGN  26370>>ASSIGN  26393>>ASSIGN  27451>>ASSIGN
GJA_HOPCOST
     15952**DCL     27011>>IF      27015>>ASSIGN
GJA_HOSTRESUMED$
     15974**DCL     25975>>IF      25976>>CALL    25976<>CALL    25978<>CALL    25980>>ASSIGN  25981>>ASSIGN
     25981>>ASSIGN
GJA_HSTRSMED
     15980**DCL     26463>>IF
GJA_IO
     16157**DCL     26831<>CALL
GJA_IO.ASNSTT
     16166**DCL     16167--REDEF   16173--REDEF   16178--REDEF   16182--REDEF   16186--REDEF   16190--REDEF
     16197--REDEF   16203--REDEF   16209--REDEF   16214--REDEF   16221--REDEF   16224--REDEF   16228--REDEF
     16235--REDEF   16239--REDEF   16243--REDEF   16247--REDEF   16252--REDEF   16256--REDEF
GJA_LDCT_BABOON
     15961**DCL     26151>>ASSIGN  26219>>IF      26238>>ASSIGN
GJA_LDCT_NM
     15960**DCL     27066<<ASSIGN
GJA_LGNTIMEDOUT$
     15975**DCL     25987>>IF      25988>>CALL    25988<>CALL    25990<>CALL    25992>>ASSIGN  25993>>ASSIGN
     25993>>ASSIGN
GJA_MAXRDS
     15985**DCL     25441>>IF      25441>>IF      25445>>ASSIGN
GJA_MSG_BDID$
     15984**DCL     26081>>IF      26082>>CALL    26082<>CALL    26084<>CALL    26086>>ASSIGN  26087>>ASSIGN
     26087>>ASSIGN
GJA_MSG_DOWN$
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:553  
     15973**DCL     26986<<ASSIGN  27034<<ASSIGN  27036<<ASSIGN  27044<<ASSIGN
GJA_MSG_HDR$
     15978**DCL     25926>>IF      25927>>CALL    25927<>CALL    25929<>CALL    25931>>ASSIGN  25932>>ASSIGN
     25932>>ASSIGN  25938>>IF      25939>>CALL    25939<>CALL    25941<>CALL    25943>>ASSIGN  25944>>ASSIGN
     25944>>ASSIGN  26017>>IF      26018>>CALL    26018<>CALL    26020<>CALL    26022>>ASSIGN  26023>>ASSIGN
     26023>>ASSIGN
GJA_MSG_HOSTDOWN$
     15971**DCL     25951>>IF      25952>>CALL    25952<>CALL    25954<>CALL    25956>>ASSIGN  25957>>ASSIGN
     25957>>ASSIGN  26986>>ASSIGN  27036>>ASSIGN  27044>>ASSIGN
GJA_MSG_LINKDOWN$
     15972**DCL     25963>>IF      25964>>CALL    25964<>CALL    25966<>CALL    25968>>ASSIGN  25969>>ASSIGN
     25969>>ASSIGN  27034>>ASSIGN
GJA_MSG_NOHOST$
     15982**DCL     26047>>IF      26048>>CALL    26048<>CALL    26050<>CALL    26052>>ASSIGN  26053>>ASSIGN
     26053>>ASSIGN  26177>>ASSIGN  26178>>ASSIGN  26178>>ASSIGN  26178>>ASSIGN
GJA_MSG_SALUTE$
     15977**DCL     25913>>IF      25914>>CALL    25914<>CALL    25916<>CALL    25918>>ASSIGN  25919>>ASSIGN
     25919>>ASSIGN
GJA_MSG_SGSYN$
     15981**DCL     26059>>IF      26060>>CALL    26060<>CALL    26062<>CALL    26064>>ASSIGN  26065>>ASSIGN
     26065>>ASSIGN
GJA_MSG_UDHOST$
     15983**DCL     26070>>IF      26071>>CALL    26071<>CALL    26073<>CALL    26075>>ASSIGN  26076>>ASSIGN
     26076>>ASSIGN
GJA_NM_HEAD$
     15958**DCL     26956>>IF      26958<<ASSIGN  26960>>ASSIGN  26961<<ASSIGN  26992>>ASSIGN  27109>>ASSIGN
     27566>>ASSIGN
GJA_NODE#
     15959**DCL     25487<<ASSIGN  26192>>ASSIGN  26942>>IF      26994>>ASSIGN  27108>>ASSIGN  27121>>ASSIGN
GJA_NOLOGONMSG$
     15976**DCL     25999>>IF      26000>>CALL    26000<>CALL    26002<>CALL    26004>>ASSIGN  26005>>ASSIGN
     26005>>ASSIGN
GJA_OSIROUTE$
     15955**DCL     18406--IMP-PTR
GJA_PARAM_VDO
     16458**DCL     26716>>ASSIGN  26720--ASSIGN  26722--ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:554  
GJA_PROMPT_VDO.DAT2.BYTSIZ
     16790**DCL     26010<<ASSIGN
GJA_PROMPT_VDO.PROMPT
     16801**DCL     26012<<ASSIGN
GJA_PROMPT_VDO.TL.LEN
     16799**DCL     26011<<ASSIGN
GJA_ROUTE$
     15954**DCL     18405--IMP-PTR 26168>>ASSIGN  26925>>ASSIGN  26971>>ASSIGN  26991>>ASSIGN
GJA_RQSCHN
     23967**DCL     26501>>ASSIGN
GJA_RQSCHN.SGN.L
     24041**DCL     24049--IMP-SIZ 26501>>ASSIGN
GJA_RQSCHN.TERMINAL_ID.TERM
     24021**DCL     24030--REDEF
GJA_STOK
     24415**DCL     25946<>CALL    25946--CALL
GJA_SYSLOG
     16026**DCL     26937<>CALL    26937--CALL    26978<>CALL    26978--CALL
GJA_SYSLOG.ERRLOG.DATA
     16143**DCL     26937--CALL    26978--CALL
GJA_SYSLOG.ERRLOG.ERRCODE.ERR#
     16099**DCL     26933<<ASSIGN  26974<<ASSIGN
GJA_SYSLOG.ERRLOG.TERMID.TERM
     16125**DCL     16134--REDEF
GJA_SYSLOG.ERRLOG.TERMID.TERM.CHANNEL
     16131**DCL     26936<<ASSIGN  26977<<ASSIGN
GJA_SYSLOG.ERRLOG.UTS
     16103**DCL     26934<>CALL    26975<>CALL
GJA_SYSLOG.ERRLOG.VALUES
     16137**DCL     26935<<ASSIGN  26976<<ASSIGN
GJA_TERM
     16273**DCL     26702--CALL    26702<>CALL
GJA_TERM_ACK
     16297**DCL     26697--CALL    26697<>CALL
GJA_UID_BABOON
     15964**DCL     15965--REDEF   25504<>CALL    26222<>CALL    27074<>CALL    27077<>CALL    27084<>CALL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:555  
GJA_UID_BABOON$
     15965**DCL     27090<>CALL    27101<>CALL    27104<>CALL
GJA_UID_NANM$
     15966**DCL     26368>>IF
GJA_UID_NM
     15962**DCL     15963--REDEF
GJA_UID_NM$
     15963**DCL     27061>>IF      27065<<ASSIGN
GJA_USRLGN_HEAD$
     15967**DCL     25669>>ASSIGN  26029>>ASSIGN  26153>>IF      26154<<ASSIGN  26156>>ASSIGN  26157<<ASSIGN
     26183>>ASSIGN  26208>>ASSIGN  26462>>ASSIGN  26683>>ASSIGN  26735>>ASSIGN
GJA_VDO_DAT_DAT1
     16549**DCL     25742--ASSIGN  26273--ASSIGN  26743>>ASSIGN  26747--ASSIGN  26751--ASSIGN
GJA_VDO_DAT_DAT2.FNC
     16648**DCL     26035<<ASSIGN  26038<<ASSIGN
HANDLER_SEARCH
     25513**LABEL   25520--EXIT
HNDCMN
     24487**DCL     26345<<ASSIGN  26418<>CALL    27518<>CALL
HOSTBOOT
     17923**DCL     25479<>CALL
HOSTKEYIN
     17862**DCL     25459<>CALL
I
     24302**DCL     25540<<ASSIGN  25541<>CALL    25560<<ASSIGN  25561<>CALL    25729<<ASSIGN  25730<>CALL
     26870<<ASSIGN  26876<>CALL    26877>>ASSIGN  26900<<ASSIGN  26901<>CALL    26902>>IF      26903>>ASSIGN
     27098<<ASSIGN
KH$CHN
     18943**DCL     25656>>ASSIGN  25703<>CALL    25794>>ASSIGN  25852>>ASSIGN  25860>>ASSIGN  25867>>ASSIGN
     25882>>ASSIGN  25889>>ASSIGN  26657--ASSIGN  26676--ASSIGN  26814--ASSIGN  26831<>CALL    26833--ASSIGN
     26904--ASSIGN  27147<>CALL    27149--ASSIGN  27520--ASSIGN
KH$CHN.ATTR
     18976**DCL     25697>>IF      26617>>IF      26636>>ASSIGN  27139>>IF      27513>>IF
KH$CHN.AUTLGN
     18954**DCL     25671>>IF
KH$CHN.CHNBIT0_9
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:556  
     18950**DCL     26566>>IF      26569>>ASSIGN  26622>>ASSIGN  26623>>IF      26624>>ASSIGN  26632>>IF
     26646>>ASSIGN  26658>>ASSIGN  26815>>ASSIGN  26820>>ASSIGN  26836>>ASSIGN  26899>>DOWHILE 27139>>IF
     27517>>ASSIGN
KH$CHN.DVCID
     18969**DCL     25848>>IF      26534>>IF      26539>>IF      26635>>ASSIGN  26769>>IF      26774>>IF
     26829>>IF      26871>>IF      26878>>ASSIGN  26880>>IF      26886>>IF
KH$CHN.ENB
     18986**DCL     26439>>IF
KH$CHN.EXTDVCID
     18969**DCL     26637>>ASSIGN  26879>>ASSIGN
KH$CHN.HAND$
     19050**DCL     25616>>ASSIGN  25617>>IF      25664>>IF      25700<<ASSIGN  26325>>IF      26327<>CALL
     26353>>ASSIGN  26434>>IF      26442<>CALL    26583>>IF      26650<<ASSIGN  26675<<ASSIGN  26808>>IF
     26825<<ASSIGN  26917>>IF      26918<>CALL    27145<<ASSIGN  27594>>IF      27595>>IF      27608>>ASSIGN
KH$CHN.LNK$
     19050**DCL     25897>>ASSIGN  25899>>ASSIGN
KH$CHN.RESOURCE
     18971**DCL     25697>>IF      26482>>IF      26617>>IF      27139>>IF      27513>>IF
KH$CHN.STT
     18959**DCL     25629>>IF      25637>>IF      25666<<ASSIGN  25684>>IF      25709<<ASSIGN  26605>>IF
     26643<<ASSIGN  26673<<ASSIGN  26826>>IF      26828<<ASSIGN  26870>>ASSIGN  26900>>ASSIGN  27136>>IF
     27138<<ASSIGN  27139>>IF
KH$CHN.SUB$
     19050**DCL     25855>>ASSIGN  25876>>ASSIGN
KH$CHN.SYSID
     18976**DCL     25702<<ASSIGN  26583>>IF      26648<<ASSIGN  26649<<ASSIGN  26674<<ASSIGN  26802>>IF
     26822>>IF      26824<<ASSIGN  27139>>IF      27146<<ASSIGN
KH$CHN.TERMID.LEV
     19039**DCL     25863>>IF      25885>>IF
KH$CHN.TERMID.TERM
     19039**DCL     19048--REDEF
KH$CHN.TERMID.TERM.SUBDEVICE
     19045**DCL     25863>>IF      25863>>IF      25885>>IF      25885>>IF
KH$CHN.TERMID.TERM.SUBSUBDEVICE
     19045**DCL     25871>>IF      25871>>IF      25893>>IF      25893>>IF
KH$CHN.HAND$ IN PROCEDURE UPDATE_SUBS
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:557  
     27424**DCL     27434<<ASSIGN  27438<<ASSIGN
KH$CHN.LNK$ IN PROCEDURE UPDATE_SUBS
     27424**DCL     27436>>ASSIGN  27440>>ASSIGN
KH$CHN.SUB$ IN PROCEDURE UPDATE_SUBS
     27424**DCL     27432>>ASSIGN
KH$CHN.SYSID IN PROCEDURE UPDATE_SUBS
     27350**DCL     27435<<ASSIGN  27439<<ASSIGN
KH$CHN.TERMID.TERM IN PROCEDURE UPDATE_SUBS
     27413**DCL     27422--REDEF
KHC$UTS
     25410**DCL-ENT 26934--CALL    26975--CALL
KHI$IO_OTP
     25408**DCL-ENT 26831--CALL
KL$
     24301**DCL     20528--IMP-PTR 24232--IMP-PTR 25740<<ASSIGN  25741>>ASSIGN  25762>>ASSIGN  25769>>CALL
     26271<<ASSIGN  26272>>ASSIGN  26299>>ASSIGN  26305>>ASSIGN  26313>>ASSIGN  26332>>CALL
KL$ACQUIRE
     19347**DCL     26668<>CALL    26668--CALL
KL$ACQUIRE.ATTR
     19373**DCL     26494>>ASSIGN  26570>>ASSIGN  26636<<ASSIGN
KL$ACQUIRE.CHAN
     19354**DCL     26511>>ASSIGN  26514<<ASSIGN  26632>>IF      26644>>IF      26646<<ASSIGN  26661>>IF
KL$ACQUIRE.CONTROLLER
     19379**DCL     26532>>IF      26587>>IF      26607>>IF
KL$ACQUIRE.DIAG
     19376**DCL     26526>>IF      26585>>IF      26605>>IF      26617>>IF      26632>>IF      26632>>IF
     26642>>IF      26644>>IF      26669>>IF
KL$ACQUIRE.DVCID
     19364**DCL     26635<<ASSIGN
KL$ACQUIRE.ERRCODE
     19388**DCL     26529<<ASSIGN  26531<<ASSIGN  26567<<ASSIGN  26588<<ASSIGN  26592<<ASSIGN  26608<<ASSIGN
     26609<<ASSIGN  26661>>IF      26663<<ASSIGN  26669>>IF
KL$ACQUIRE.EXTDVCID
     19366**DCL     26637<<ASSIGN
KL$ACQUIRE.HIGHCHAN
     19358**DCL     26515<<ASSIGN  26623>>IF      26624<<ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:558  
KL$ACQUIRE.LOWCHAN
     19361**DCL     26516<<ASSIGN  26621>>IF      26622<<ASSIGN
KL$ACQUIRE.RES
     19371**DCL     26493>>ASSIGN  26617>>IF
KL$ACQUIRE.USER#
     19392**DCL     26647>>IF      26648>>ASSIGN
KL$ADMIN
     21373**DCL     25582>>ASSIGN  25736--CALL    25773>>ASSIGN
KL$ADMIN.FNC
     21439**DCL     25617>>IF      25617>>IF      25617>>IF      25617>>IF      25629>>IF      25629>>IF
     25645>>IF      25652>>DOCASE
KL$ADMIN.ORIGIN
     21383**DCL     25721>>IF      25725>>IF
KL$ADMIN.TERMID_HI
     21488**DCL     25588>>ASSIGN  25779>>ASSIGN
KL$ADMIN.TERMID_HI.TERM
     21490**DCL     21499--REDEF
KL$ADMIN.TERMID_LO
     21459**DCL     25587>>ASSIGN  25778>>ASSIGN
KL$ADMIN.TERMID_LO.TERM
     21461**DCL     21470--REDEF
KL$AFD
     19411**DCL     26133--ASSIGN
KL$AFD.NETADR_FROM
     19416**DCL     26138>>ASSIGN
KL$CHNRSP
     20201**DCL     26356<>CALL    26356--CALL    26359<>CALL
KL$CHNRSP.DFLTHND
     20216**DCL     26363>>IF
KL$CHNRSP.HANDLER
     20230**DCL     26373>>IF      27454>>IF      27460>>DOSELCT
KL$CHNRSP.HNDCMN
     20330**DCL     26345>>ASSIGN
KL$CHNRSP.LINE_PROFILE
     20208**DCL     26349>>IF
KL$CHNRSP.MESSAGE.MESSAGE
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:559  
     20402**DCL     26360--CALL    27528>>ASSIGN
KL$CHNRSP.MESSAGE.MSGSIZE
     20398**DCL     20402--IMP-SIZ 26356>>CALL    26356>>CALL    26359>>CALL    27524>>IF      27527>>ASSIGN
     27528>>ASSIGN
KL$CHNRSP.NA
     20281**DCL     26344>>ASSIGN
KL$CHNRSP.NAK
     20220**DCL     26354>>IF      26365>>IF
KL$CHNRSP.SCNDCNFG
     20224**DCL     26430>>IF
KL$CHNRSP.TERMINAL_ID
     20250**DCL     26346>>ASSIGN  26351>>ASSIGN
KL$CHNRSP.TERMINAL_ID.TERM
     20252**DCL     20261--REDEF
KL$CHSCRLVL
     22003**DCL     27084<>CALL    27084--CALL
KL$CNFG_MSG
     21579**DCL     25741--ASSIGN  26272--ASSIGN
KL$CNFG_MSG.KHA
     21720**DCL     25760<>CALL    26291<>CALL    26297<>CALL
KL$CNFG_MSG.NA
     21800**DCL     25759>>ASSIGN  26290>>ASSIGN
KL$CNFG_MSG.TERMID_HI
     21689**DCL     25744>>ASSIGN  26275>>ASSIGN
KL$CNFG_MSG.TERMID_HI.TERM
     21691**DCL     21700--REDEF
KL$CNFG_MSG.TERMID_LO
     21660**DCL     25743>>ASSIGN  26274>>ASSIGN
KL$CNFG_MSG.TERMID_LO.TERM
     21662**DCL     21671--REDEF
KL$CONFIGRQS.CHANNEL
     21968**DCL     26860>>ASSIGN
KL$CONFIGRQS.MSGID
     21947**DCL     26850>>ASSIGN
KL$CONFIGRQS.SRC_NODE
     21955**DCL     26851>>ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:560  
KL$CONFIGRSP
     21847**DCL     26848<<ASSIGN  26907<>CALL    26907--CALL
KL$CONFIGRSP.CTLR_STATUS
     21863**DCL     26902>>IF      26903<<ASSIGN
KL$CONFIGRSP.DVCID
     21877**DCL     26878<<ASSIGN
KL$CONFIGRSP.EXTDVCID
     21880**DCL     26879<<ASSIGN
KL$CONFIGRSP.FCN
     21848**DCL     26849<<ASSIGN
KL$CONFIGRSP.MSGID
     21856**DCL     26850<<ASSIGN
KL$CONFIGRSP.NODE
     21860**DCL     26851<<ASSIGN
KL$CONFIGRSP.STATUS
     21866**DCL     26863<<ASSIGN  26873<<ASSIGN  26877<<ASSIGN
KL$CONTROL
     19524**DCL     25504<>CALL    25508<>CALL    25509<>CALL    25516<>CALL    25530<>CALL    25530--CALL
     25538<>CALL    25543<>CALL
KL$CONTROL.HANDLER
     19533**DCL     25502>>IF      25507>>IF      25514>>IF      25535<<ASSIGN
KL$CONTROL.RESULTS
     19553**DCL     25526<<ASSIGN
KL$CONTROL.SRCE_NODE
     19531**DCL     25540>>ASSIGN
KL$CWNAK
     20629**DCL     26123<<ASSIGN  26128<>CALL    26128--CALL    26137<<ASSIGN
KL$CWNAK.FCN
     20630**DCL     26126<<ASSIGN
KL$CWNAK.NETADR
     20633**DCL     26124<<ASSIGN  26138<<ASSIGN
KL$CWNAK.NETERR.ERR.L6
     20676**DCL     26127<<ASSIGN
KL$DVCERRRSP.TERMID
     19302**DCL     26913>>ASSIGN
KL$DVCERRRSP.TERMID.TERM
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:561  
     19304**DCL     19313--REDEF
KL$ERRMSG_RQS
     19874**DCL     26250<>CALL    26250--CALL
KL$ERRMSG_RQS.CTX$
     19906**DCL     26249<<ASSIGN
KL$ERRMSG_RQS.USR#
     19881**DCL     26237>>ASSIGN
KL$ERRMSG_RSP
     20049**DCL     26265<>CALL
KL$ERRMSG_RSP.CTX$
     20102**DCL     26258>>IF
KL$ERRMSG_RSP.MESSAGE_SZ
     20061**DCL     26265>>CALL
KL$ERRMSG_RSPSZ
     20125**DCL     26265--CALL
KL$FEPST.ALT_QOS
     20430**DCL     27008>>ASSIGN
KL$FEPST.CHAN#
     20431**DCL     26936>>ASSIGN  26977>>ASSIGN
KL$FEPST.FEP
     20422**DCL     26925>>ASSIGN  26935>>ASSIGN  26942>>IF      26946>>ASSIGN  26954>>ASSIGN  26971>>ASSIGN
     26976>>ASSIGN  26991>>ASSIGN  26993>>ASSIGN  27027>>IF      27040>>IF
KL$FEPST.PROB
     20425**DCL     26921>>DOCASE  26929>>IF      26942>>IF
KL$FEPST.QOS
     20428**DCL     27010>>ASSIGN  27027>>IF      27040>>IF      27045>>IF      27050>>IF
KL$FEPST.REASON
     20427**DCL     27032>>IF      27040>>IF
KL$FEPST.STATE
     20426**DCL     20427--REDEF
KL$HDR
     24232**DCL     25741<<ASSIGN  25741>>ASSIGN  25742--ASSIGN  25769<>CALL    25769--CALL    26272<<ASSIGN
     26272>>ASSIGN  26273--ASSIGN  26332<>CALL    26332--CALL
KL$HDR.RESULTS
     24261**DCL     25762<<ASSIGN  26299<<ASSIGN  26305<<ASSIGN  26313<<ASSIGN
KL$KEYMES
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:562  
     19143**DCL     26910<>CALL
KL$KEYMES.TERMID.TERM
     19225**DCL     19234--REDEF
KL$MES
     19117**DCL     25915--ASSIGN  25917--ASSIGN  25919--ASSIGN  25928--ASSIGN  25930--ASSIGN  25932--ASSIGN
     25940--ASSIGN  25942--ASSIGN  25944--ASSIGN  25953--ASSIGN  25955--ASSIGN  25957--ASSIGN  25965--ASSIGN
     25967--ASSIGN  25969--ASSIGN  25977--ASSIGN  25979--ASSIGN  25981--ASSIGN  25989--ASSIGN  25991--ASSIGN
     25993--ASSIGN  26001--ASSIGN  26003--ASSIGN  26005--ASSIGN  26009--ASSIGN  26012--ASSIGN  26019--ASSIGN
     26021--ASSIGN  26023--ASSIGN  26036--CALL    26036--CALL    26049--ASSIGN  26051--ASSIGN  26053--ASSIGN
     26061--ASSIGN  26063--ASSIGN  26065--ASSIGN  26072--ASSIGN  26074--ASSIGN  26076--ASSIGN  26083--ASSIGN
     26085--ASSIGN  26087--ASSIGN  27081<>CALL
KL$MES.CODE
     19121**DCL     25454>>DOCASE  25536>>IF
KL$NODECHG
     20456**DCL     27074<>CALL    27074--CALL
KL$NODEINFO.BOSS
     20484**DCL     27061>>IF
KL$NODEINFO.MYNAME
     20487**DCL     27060>>ASSIGN
KL$OSILINKCHG
     22237**DCL     27101<>CALL    27101--CALL    27104<>CALL    27104--CALL    27105>>ASSIGN
KL$OSILINKCHG.FCN
     22248**DCL     27099>>IF      27100<<ASSIGN  27120>>ASSIGN
KL$OSILINKCHG.MYNODE#
     22268**DCL     27111>>IF
KL$OSILINKCHG.NODE#
     22270**DCL     27098>>ASSIGN
KL$OSILINKCHG.QOS
     22272**DCL     27123>>ASSIGN
KL$OSILINKCHG.SNPA
     22298**DCL     27122>>ASSIGN
KL$OSILINKCHG.TERMID.TERM
     22329**DCL     22338--REDEF
KL$OSILINKCHG.TERMID.TERM.CHANNEL
     22335**DCL     27124>>ASSIGN
KL$PRFRSP
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:563  
     21267**DCL     27531--CALL
KL$PRFRSP.FCN
     21268**DCL     27526<<ASSIGN
KL$PRFRSP.IMP
     21274**DCL     26710>>IF
KL$PRFRSP.MORE
     21275**DCL     26692>>IF      26728>>IF
KL$PRFRSP.NMID
     21282**DCL     26682>>ASSIGN
KL$PRFRSP.PROFILE.PRFSIZE
     21294**DCL     21298--IMP-SIZ 26712>>ASSIGN  26713>>CALL    26717>>ASSIGN  26719>>ASSIGN  26720>>ASSIGN
     26720>>ASSIGN  26722>>ASSIGN  26723>>IF      27527<<ASSIGN  27528>>ASSIGN  27531>>CALL
KL$PRFRSP.PROFILE.PRFTXT
     21298**DCL     26713<>CALL    26720>>ASSIGN  27528<<ASSIGN
KL$RELEASE
     19469**DCL     26841<>CALL    26841--CALL
KL$RELEASE.CHAN
     19476**DCL     26756>>ASSIGN  26758>>ASSIGN
KL$RELEASE.CONTROLLER
     19479**DCL     26767>>IF
KL$RELEASE.ERRCODE
     19489**DCL     26759<<ASSIGN  26766<<ASSIGN  26804<<ASSIGN  26810<<ASSIGN  26817>>IF
KL$RELEASE.USER#
     19484**DCL     26801>>IF      26802>>IF      26822>>IF
KL$REQSTATS
     21110**DCL     25554<>CALL    25554--CALL    25563<>CALL
KL$REQSTATS.DSPMSK
     21200**DCL     21206--REDEF
KL$REQSTATS.HANDLER
     21187**DCL     25559<<ASSIGN
KL$REQSTATS.SLCMSK
     21241**DCL     21248--REDEF
KL$REQSTATS.SRCE_NODE
     21124**DCL     25560>>ASSIGN
KL$RQSCHN
     20528**DCL     26341<>CALL    26501<<ASSIGN  26504<>CALL    26504--CALL
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:564  
KL$RQSCHN.DFLTHND
     20543**DCL     26503<<ASSIGN  26505<<ASSIGN
KL$RQSCHN.HANDLER
     20560**DCL     26340<<ASSIGN  26502<<ASSIGN
KL$RQSCHN.SGN.L
     20602**DCL     20610--IMP-SIZ 26341>>CALL    26501>>ASSIGN  26504>>CALL    26504>>CALL
KL$RQSCHN.TERMINAL_ID.TERM
     20582**DCL     20591--REDEF
KL$RUE
     20712**DCL     26115<>CALL
KL$RUE.EVENT#
     20782**DCL     26110>>ASSIGN
KL$RUE.RESULTS
     20741**DCL     26113<<ASSIGN
KL$RUE.SYSID
     20778**DCL     26109>>ASSIGN
KL$SETNODE.HOST_NODE
     21529**DCL     26098>>IF
KL$SETNODE.INVALID
     21533**DCL     26091>>IF
KL$SETNODE.NODE#
     21539**DCL     25487>>ASSIGN  26093>>IF      26095>>IF      26096>>ASSIGN  26097>>ASSIGN  26099>>ASSIGN
     26101>>ASSIGN
KL$SETNODE.NODE_NAME
     21545**DCL     26097>>ASSIGN
KL$SGN
     19645**DCL     26160<>CALL    26160--CALL    26193<>CALL
KL$SGN.LOGON.LGNSIZ
     19720**DCL     26160>>CALL
KL$SGN.NMID
     19709**DCL     26148>>ASSIGN  26159<<ASSIGN  26173>>ASSIGN  26182>>ASSIGN
KL$SGN.NODE
     19649**DCL     26149>>ASSIGN  26168>>ASSIGN  26191>>ASSIGN  26192<<ASSIGN
KL$SGN.TERMINAL_ID
     19670**DCL     26150>>ASSIGN
KL$SGN.TERMINAL_ID.TERM
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:565  
     19672**DCL     19681--REDEF
KL$SGNRSP
     19738**DCL     26222--CALL    26222<>CALL
KL$SGNRSP.NMID
     19756**DCL     26207>>ASSIGN  26221<<ASSIGN
KL$SGNRSP.TERMID.TERM
     19842**DCL     19851--REDEF
KL$TERMINAL_ID
     24355**DCL     25603<<ASSIGN  25611<>CALL    25671>>IF      25751<<ASSIGN  25760<>CALL    25783<<ASSIGN
     25808<<ASSIGN  25811<>CALL    25814<>CALL    25847<>CALL    26282<<ASSIGN  26291<>CALL    26295<>CALL
     26297<>CALL    26321>>ASSIGN  26322>>ASSIGN  26324<>CALL    26346<<ASSIGN  26351<<ASSIGN  26352<>CALL
     26360<>CALL    26403<>CALL    26407<>CALL    26418<>CALL    26432<>CALL    26437>>ASSIGN  26438>>ASSIGN
     26477<<ASSIGN  26480<>CALL    26530<>CALL    26564<>CALL    26760<>CALL    26794<>CALL    26861<>CALL
     26898<>CALL    26913<<ASSIGN  26914<>CALL    27518<>CALL    27590<>CALL
KL$TERMINAL_ID.LEV
     24359**DCL     25604<<ASSIGN  25752<<ASSIGN  25813<<ASSIGN  25843<<ASSIGN  25850>>IF      26283<<ASSIGN
     26293>>IF      26405>>IF      26478<<ASSIGN  26509<<ASSIGN  26757<<ASSIGN  26859<<ASSIGN  27516<<ASSIGN
     27583<<ASSIGN
KL$TERMINAL_ID.TERM
     24359**DCL     24368--REDEF   26390>>IF
KL$TERMINAL_ID.TERM.CHANNEL
     24365**DCL     25608<<ASSIGN  25756<<ASSIGN  25844<<ASSIGN  26287<<ASSIGN  26479<<ASSIGN  26528<<ASSIGN
     26563<<ASSIGN  26758<<ASSIGN  26793<<ASSIGN  26860<<ASSIGN  26882>>ASSIGN  26882>>ASSIGN  26888>>ASSIGN
     26888>>ASSIGN  26892>>ASSIGN  26893>>ASSIGN  26897<<ASSIGN  27517<<ASSIGN  27587<<ASSIGN
KL$TERMINAL_ID.TERM.SUBDEVICE
     24365**DCL     25609<<ASSIGN  25757<<ASSIGN  25809<<ASSIGN  25845<<ASSIGN  26288<<ASSIGN  27588<<ASSIGN
KL$TERMINAL_ID.TERM.SUBSUBDEVICE
     24365**DCL     25610<<ASSIGN  25758<<ASSIGN  25810<<ASSIGN  25846<<ASSIGN  26289<<ASSIGN  27589<<ASSIGN
KL$TERMINAL_ID.TERM.TERM_NAME
     24368**DCL     25784<<ASSIGN
KL$TIME
     20504**DCL     27077<>CALL    27077--CALL
KL$UPDOSI
     22028**DCL     27090<>CALL    27090--CALL
KL$UPDOSI.LNSAP.ADDRESS_N
     22182**DCL     22183--REDEF
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:566  
KL$UPDOSI.MYNODE#
     22063**DCL     22065--REDEF
KL$UPDOSI.NODE#
     22066**DCL     22068--REDEF
KL$UPDOSI.NSAP.ADDRESS_N
     22126**DCL     22127--REDEF
KL$WRITE.MESSAGE.MSGSIZE
     21334**DCL     26744>>ASSIGN  26746>>ASSIGN  26751>>ASSIGN
KL$WRITE.MESSAGE.MSGTXT
     21337**DCL     26747>>ASSIGN
KL$WRITE.NMID
     21327**DCL     26734>>ASSIGN
KL_STRTU
     20800**DCL     26119--ASSIGN
KL_STRTU.NETADR_FROM
     20811**DCL     26124>>ASSIGN
KNN$LINK.DEST.ADDRESS_N
     18342**DCL     18343--REDEF
KNN$LINK.LADR.ADDRESS_N
     18285**DCL     18286--REDEF
KNN$LINK.LDCT$
     18156**DCL     18163--REDEF
KNN$LINK.NODE#
     18171**DCL     27006>>IF      27016>>IF
KNN$OSIROUTE.LNSAP.ADDRESS_N
     22501**DCL     22502--REDEF
KNN$OSIROUTE.NSAP.ADDRESS_N
     22411**DCL     22412--REDEF
KNN$ROUTE.CTX$
     18090**DCL     26169>>ASSIGN  26926>>ASSIGN  26927>>IF      26963<<ASSIGN  26972>>ASSIGN  27024>>ASSIGN
     27047<<ASSIGN  27050>>IF
KNN$ROUTE.FLAGS.HOST_NODE
     18111**DCL     26929>>IF      26942>>IF      26955>>ASSIGN  26973>>IF      26995>>IF      27027>>IF
     27040>>IF      27050>>IF
KNN$ROUTE.FLAGS.LINK_CONNECTED
     18115**DCL     26967>>ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:567  
KNN$ROUTE.LINK$
     18084**DCL     27005>>ASSIGN
KNN$ROUTE$
     18405**DCL     26168>>ASSIGN  26925>>ASSIGN  26971>>ASSIGN  26991>>ASSIGN
KV@VDO_RQSDAT
     23354**DCL     25443<<ASSIGN  25444<>CALL
KVB$GET2NSYS
     25395**DCL-ENT 26234--CALL
KVB$GETSYS
     25390**DCL-ENT 25916--CALL    25929--CALL    25941--CALL    25954--CALL    25966--CALL    25978--CALL
     25990--CALL    26002--CALL    26020--CALL    26050--CALL    26062--CALL    26073--CALL    26084--CALL
     26146--CALL    26948--CALL
KVB$RLSSYS
     25391**DCL-ENT 25914--CALL    25927--CALL    25939--CALL    25952--CALL    25964--CALL    25976--CALL
     25988--CALL    26000--CALL    26018--CALL    26048--CALL    26060--CALL    26071--CALL    26082--CALL
KV_VDO_RQSDAT
     23306**DCL     25443>>ASSIGN  25444--CALL
LASTCHAN
     24329**DCL     26513<<ASSIGN  26537<<ASSIGN  26542<<ASSIGN  26546<<ASSIGN  26551<<ASSIGN  26556<<ASSIGN
     26566>>IF      26574>>DOWHILE 26772<<ASSIGN  26777<<ASSIGN  26781<<ASSIGN  26786<<ASSIGN  26791<<ASSIGN
     26798>>DOWHILE 26821>>DOWHILE 26883<<ASSIGN  26889<<ASSIGN  26893<<ASSIGN  26895>>IF      26899>>DOWHILE
LEV
     24339**DCL     25787<<ASSIGN  25820>>DOCASE
LINK$
     24298**DCL     18155--IMP-PTR 27005<<ASSIGN  27006>>IF      27006>>IF      27016>>IF      27016>>IF
LVL2$
     24311**DCL     25855<<ASSIGN  25856>>DOWHILE 25857>>ASSIGN  25876>>ASSIGN  25899<<ASSIGN  25899>>ASSIGN
LVL3$
     24312**DCL     25876<<ASSIGN  25877>>DOWHILE 25879>>ASSIGN  25897<<ASSIGN  25897>>ASSIGN
M$AFD
      4810**DCL-ENT 26134--CALL
M$MAKEUSR
      4806**DCL-ENT 26120--CALL
M$RUE
      4812**DCL-ENT 26111--CALL
M$SCREECH
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:568  
      4801**DCL-ENT 25459--CALL    25469--CALL    25479--CALL    26408--CALL
M$XXX
      4799**DCL-ENT 26190--CALL    26215--CALL    26263--CALL    26690--CALL    26742--CALL
MAXLEV
     24340**DCL     25788<<ASSIGN
MSGCTX$
     15949**DCL        19--PROC    25429>>ASSIGN  25430>>ASSIGN  25769<>CALL    26115<>CALL    26332<>CALL
MSGSIZ
     24323**DCL     25742<<ASSIGN  26273<<ASSIGN  26722<<ASSIGN  26725<>CALL    26751<<ASSIGN  26752<>CALL
NA
     24438**DCL     25759<<ASSIGN  25760<>CALL    26290<<ASSIGN  26291<>CALL    26297<>CALL    26344<<ASSIGN
     26418<>CALL    27518<>CALL
NA.ATTR
     24467**DCL     27499>>ASSIGN
NA.ATTRPRES
     24453**DCL     27497>>IF
NA.CNFG_EXISTS
     24456**DCL     26417>>IF
NA.RES
     24469**DCL     27496>>ASSIGN
NA.RESPRES
     24452**DCL     27494>>IF
NM$ IN PROCEDURE FIND_NODE
     27564**DCL     27561--PROC    27566<<ASSIGN  27568>>DOWHILE 27569>>IF      27569>>IF      27573<<ASSIGN
NMID
     24319**DCL     26182<<ASSIGN  26207<<ASSIGN  26682<<ASSIGN  26734<<ASSIGN
NMID$
     24318**DCL     24319--REDEF   26185>>IF      26210>>IF      26685>>IF      26737>>IF
NM_SAYS_GO
     26454**LABEL   26400--GOTO
NODE# IN PROCEDURE FIND_NODE
     27563**DCL     27561--PROC    27569>>IF
NODECHG
     25045**DCL     27019<>CALL    27019--CALL
NODECHG.FCN
     25046**DCL     27000<<ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:569  
NODECHG.HOSTNODE
     25051**DCL     26997<<ASSIGN  26999<<ASSIGN
NODECHG.MYNODE
     25049**DCL     26994<<ASSIGN
NODECHG.NODE
     25050**DCL     26993<<ASSIGN
NODECHG.QOS
     25052**DCL     27008<<ASSIGN  27010<<ASSIGN  27011>>IF      27013<<ASSIGN  27015<<ASSIGN  27015>>ASSIGN
     27016>>IF
NODEDEV
     17984**DCL     26408<>CALL
OSI$
     24317**DCL     22359--IMP-PTR
OSILINKCHG
     25280**DCL     27105<<ASSIGN  27113<>CALL    27113--CALL    27119<<ASSIGN
OSILINKCHG.FCN
     25291**DCL     27107<<ASSIGN
OSILINKCHG.MYNODE#
     25311**DCL     27108<<ASSIGN
OSILINKCHG.NODE#
     25313**DCL     27121<<ASSIGN
OSILINKCHG.QOS
     25315**DCL     27123<<ASSIGN
OSILINKCHG.SNPA
     25341**DCL     27122<<ASSIGN
OSILINKCHG.TERMID.TERM
     25372**DCL     25381--REDEF
OSILINKCHG.TERMID.TERM.CHANNEL
     25378**DCL     27124<<ASSIGN
OSILINKCHG.TYPE
     25302**DCL     27120<<ASSIGN
RES IN PROCEDURE DEFAULT_HAND
     27448**DCL     27463<<ASSIGN  27467<<ASSIGN  27471<<ASSIGN  27475<<ASSIGN  27479<<ASSIGN  27484<<ASSIGN
     27490<<ASSIGN  27496<<ASSIGN  27503>>ASSIGN  27513>>IF
ROUTE$
     24299**DCL     18083--IMP-PTR 26168<<ASSIGN  26169>>ASSIGN  26925<<ASSIGN  26926>>ASSIGN  26927>>IF
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:570  
     26929>>IF      26942>>IF      26955>>ASSIGN  26963>>ASSIGN  26967>>ASSIGN  26971<<ASSIGN  26972>>ASSIGN
     26973>>IF      26991<<ASSIGN  26995>>IF      27005>>ASSIGN  27024>>ASSIGN  27027>>IF      27040>>IF
     27047>>ASSIGN  27050>>IF      27050>>IF
RSP$
     24325**DCL     20629--IMP-PTR 21847--IMP-PTR 26029<<ASSIGN  26031>>DOWHILE 26032>>IF      26032>>IF
     26032>>IF      26032>>IF      26036<>CALL    26040<<ASSIGN  26040>>ASSIGN  26122<<ASSIGN  26123>>ASSIGN
     26124>>ASSIGN  26126>>ASSIGN  26127>>ASSIGN  26128>>CALL    26136<<ASSIGN  26137>>ASSIGN  26138>>ASSIGN
     26183<<ASSIGN  26184>>DOWHILE 26185>>IF      26187<<ASSIGN  26187>>ASSIGN  26189>>IF      26191>>ASSIGN
     26847<<ASSIGN  26848>>ASSIGN  26849>>ASSIGN  26850>>ASSIGN  26851>>ASSIGN  26863>>ASSIGN  26873>>ASSIGN
     26877>>ASSIGN  26878>>ASSIGN  26879>>ASSIGN  26902>>IF      26903>>ASSIGN  26907>>CALL
SCRAP
     26841**LABEL   26764--GOTO
SENDALL
     26025**LABEL   26025--GOTO
SENDIT
     26661**LABEL   26530--CALLALT
SEND_CNFG_NAK
     26322**LABEL   26300--GOTO    26306--GOTO    26314--GOTO
SEND_RESET_NAK
     25760**LABEL   25763--GOTO
SGNRSP
     26195**LABEL   26175--ASSIGN  26176--ASSIGN  26179--GOTO
SGNRSP.ERRCODE
     24680**DCL     26174<<ASSIGN
SGNRSP.FCN
     24625**DCL     26172<<ASSIGN
SGNRSP.MESSAGE.RSPSIZ
     24742**DCL     26177<<ASSIGN
SGNRSP.MESSAGE.RSPTXT
     24743**DCL     26178<<ASSIGN
SGNRSP.NMID
     24642**DCL     26173<<ASSIGN
SGNRSP.TERMID.TERM
     24728**DCL     24737--REDEF
SIZE
     24324**DCL     18411--IMP-SIZ 25915<<ASSIGN  25916<>CALL    25917<<ASSIGN  25918>>ASSIGN  25928<<ASSIGN
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:571  
     25929<>CALL    25930<<ASSIGN  25931>>ASSIGN  25940<<ASSIGN  25941<>CALL    25942<<ASSIGN  25943>>ASSIGN
     25953<<ASSIGN  25954<>CALL    25955<<ASSIGN  25956>>ASSIGN  25965<<ASSIGN  25966<>CALL    25967<<ASSIGN
     25968>>ASSIGN  25977<<ASSIGN  25978<>CALL    25979<<ASSIGN  25980>>ASSIGN  25989<<ASSIGN  25990<>CALL
     25991<<ASSIGN  25992>>ASSIGN  26001<<ASSIGN  26002<>CALL    26003<<ASSIGN  26004>>ASSIGN  26009<<ASSIGN
     26010>>ASSIGN  26011>>ASSIGN  26019<<ASSIGN  26020<>CALL    26021<<ASSIGN  26022>>ASSIGN  26049<<ASSIGN
     26050<>CALL    26051<<ASSIGN  26052>>ASSIGN  26061<<ASSIGN  26062<>CALL    26063<<ASSIGN  26064>>ASSIGN
     26072<<ASSIGN  26073<>CALL    26074<<ASSIGN  26075>>ASSIGN  26083<<ASSIGN  26084<>CALL    26085<<ASSIGN
     26086>>ASSIGN  26145<<ASSIGN  26146<>CALL    26233<<ASSIGN  26234<>CALL    26712<<ASSIGN  26713<>CALL
     26719<<ASSIGN  26720>>ASSIGN  26746<<ASSIGN  26747>>ASSIGN  26947<<ASSIGN  26948<>CALL
STARTCHN$
     24300**DCL     26795<<ASSIGN  26819>>ASSIGN
STATUS IN PROCEDURE CONVERT_STATE
     27539**DCL     27538--PROC    27541>>DOCASE  27544<<ASSIGN  27547<<ASSIGN  27550<<ASSIGN  27553<<ASSIGN
STRING
     18411**DCL     26720<<ASSIGN  26747<<ASSIGN
SUB
     24333**DCL     25606<<DOINDEX 25609>>ASSIGN  25754<<DOINDEX 25757>>ASSIGN  26285<<DOINDEX 26288>>ASSIGN
     27585<<DOINDEX 27588>>ASSIGN
SUB$ IN PROCEDURE UPDATE_SUBS
     27300**DCL     27430<<ASSIGN  27431>>DOWHILE 27432>>ASSIGN  27438>>ASSIGN  27439>>ASSIGN  27440<<ASSIGN
     27440>>ASSIGN
SUBHI
     24335**DCL     25595<<ASSIGN  25606>>DOINDEX 25748<<ASSIGN  25754>>DOINDEX 25823<<ASSIGN  25825>>ASSIGN
     25828<<ASSIGN  25833<<ASSIGN  25863>>IF      25885>>IF      26279<<ASSIGN  26285>>DOINDEX 27585>>DOINDEX
SUBLO
     24334**DCL     25594<<ASSIGN  25606>>DOINDEX 25747<<ASSIGN  25754>>DOINDEX 25822<<ASSIGN  25824>>ASSIGN
     25827<<ASSIGN  25832<<ASSIGN  25863>>IF      25885>>IF      26278<<ASSIGN  26285>>DOINDEX 27585>>DOINDEX
SUBSUB
     24336**DCL     25607<<DOINDEX 25610>>ASSIGN  25755<<DOINDEX 25758>>ASSIGN  26286<<DOINDEX 26289>>ASSIGN
     27586<<DOINDEX 27589>>ASSIGN
SUBSUB$ IN PROCEDURE UPDATE_SUBS
     27301**DCL     27432<<ASSIGN  27433>>DOWHILE 27434>>ASSIGN  27435>>ASSIGN  27436<<ASSIGN  27436>>ASSIGN
SUBSUBHI
     24338**DCL     25597<<ASSIGN  25607>>DOINDEX 25750<<ASSIGN  25755>>DOINDEX 25825<<ASSIGN  25830<<ASSIGN
     25835<<ASSIGN  26281<<ASSIGN  26286>>DOINDEX 27586>>DOINDEX
SUBSUBLO
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:572  
     24337**DCL     25596<<ASSIGN  25607>>DOINDEX 25749<<ASSIGN  25755>>DOINDEX 25824<<ASSIGN  25829<<ASSIGN
     25834<<ASSIGN  26280<<ASSIGN  26286>>DOINDEX 27586>>DOINDEX
SVATTR
     24322**DCL     26570<<ASSIGN  26617>>IF
SVCHAN
     24321**DCL     26511<<ASSIGN  26528>>ASSIGN  26536>>ASSIGN  26536>>ASSIGN  26541>>ASSIGN  26541>>ASSIGN
     26545>>ASSIGN  26546>>ASSIGN  26550>>ASSIGN  26551>>ASSIGN  26632>>IF      26756<<ASSIGN  26762>>IF
     26771>>ASSIGN  26771>>ASSIGN  26776>>ASSIGN  26776>>ASSIGN  26780>>ASSIGN  26781>>ASSIGN  26785>>ASSIGN
     26786>>ASSIGN  26788>>IF      26796>>IF      26839>>IF
SVCHN$
     24320**DCL     26510<<ASSIGN  26565<<ASSIGN  26669>>IF      26672>>DOWHILE 26673>>ASSIGN  26674>>ASSIGN
     26675>>ASSIGN  26676<<ASSIGN  26676>>ASSIGN
TCHN$
     24310**DCL     25669<<ASSIGN  25670>>DOWHILE 25671>>IF      25679<<ASSIGN  25679>>ASSIGN  25857<<ASSIGN
     25860>>ASSIGN  25863>>IF      25863>>IF      25863>>IF      25867>>ASSIGN  25871>>IF      25871>>IF
     25879<<ASSIGN  25882>>ASSIGN  25885>>IF      25885>>IF      25885>>IF      25889>>ASSIGN  25893>>IF
     25893>>IF
TERMHI
     24594**DCL     25588<<ASSIGN  25589<>CALL    25744<<ASSIGN  25779<<ASSIGN  25780<>CALL    25790>>IF
     25792<>CALL    25808>>ASSIGN  26275<<ASSIGN
TERMHI.LEV
     24598**DCL     25788>>ASSIGN  25812<<ASSIGN  25812>>ASSIGN  25813>>ASSIGN  25815<<ASSIGN
TERMHI.TERM
     24598**DCL     24607--REDEF
TERMHI.TERM.CHANNEL
     24604**DCL     25593>>ASSIGN  25746>>ASSIGN  25805>>IF      25807<<ASSIGN  25841>>ASSIGN  26277>>ASSIGN
TERMHI.TERM.SUBDEVICE
     24604**DCL     25595>>ASSIGN  25748>>ASSIGN  25828>>ASSIGN  25833>>ASSIGN  26279>>ASSIGN
TERMHI.TERM.SUBSUBDEVICE
     24604**DCL     25597>>ASSIGN  25750>>ASSIGN  25835>>ASSIGN  25871>>IF      25893>>IF      26281>>ASSIGN
TERMHI.TERM.TERM_NAME
     24607**DCL     25785<<ASSIGN
TERMID_C.TERM
     24388**DCL     24397--REDEF
TERMLO
     24565**DCL     25587<<ASSIGN  25589<>CALL    25743<<ASSIGN  25778<<ASSIGN  25780<>CALL    25790>>IF
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:573  
     26274<<ASSIGN
TERMLO.LEV
     24569**DCL     25604>>ASSIGN  25752>>ASSIGN  25787>>ASSIGN  25850>>IF      25858>>DOCASE  25863>>IF
     25880>>DOCASE  25885>>IF      26283>>ASSIGN  27583>>ASSIGN
TERMLO.TERM
     24569**DCL     24578--REDEF
TERMLO.TERM.CHANNEL
     24575**DCL     25592>>ASSIGN  25745>>ASSIGN  25840>>ASSIGN  26276>>ASSIGN
TERMLO.TERM.SUBDEVICE
     24575**DCL     25594>>ASSIGN  25747>>ASSIGN  25827>>ASSIGN  25832>>ASSIGN  26278>>ASSIGN
TERMLO.TERM.SUBSUBDEVICE
     24575**DCL     25596>>ASSIGN  25749>>ASSIGN  25834>>ASSIGN  25871>>IF      25893>>IF      26280>>ASSIGN
TERMLO.TERM.TERM_NAME
     24578**DCL     25786<<ASSIGN
TEXTC_STRING.SIZE
     18409**DCL     18410--IMP-SIZ 25914>>CALL    25918<<ASSIGN  25919>>ASSIGN  25927>>CALL    25931<<ASSIGN
     25932>>ASSIGN  25939>>CALL    25943<<ASSIGN  25944>>ASSIGN  25952>>CALL    25956<<ASSIGN  25957>>ASSIGN
     25964>>CALL    25968<<ASSIGN  25969>>ASSIGN  25976>>CALL    25980<<ASSIGN  25981>>ASSIGN  25988>>CALL
     25992<<ASSIGN  25993>>ASSIGN  26000>>CALL    26004<<ASSIGN  26005>>ASSIGN  26018>>CALL    26022<<ASSIGN
     26023>>ASSIGN  26048>>CALL    26052<<ASSIGN  26053>>ASSIGN  26060>>CALL    26064<<ASSIGN  26065>>ASSIGN
     26071>>CALL    26075<<ASSIGN  26076>>ASSIGN  26082>>CALL    26086<<ASSIGN  26087>>ASSIGN  26177>>ASSIGN
     26178>>ASSIGN  26178>>ASSIGN
TEXTC_STRING.STRING
     18410**DCL     25919<<ASSIGN  25932<<ASSIGN  25944<<ASSIGN  25957<<ASSIGN  25969<<ASSIGN  25981<<ASSIGN
     25993<<ASSIGN  26005<<ASSIGN  26023<<ASSIGN  26053<<ASSIGN  26065<<ASSIGN  26076<<ASSIGN  26087<<ASSIGN
     26178>>ASSIGN
THAND$
     24309**DCL     27582<<ASSIGN  27594>>IF      27595>>IF      27608<<ASSIGN
UID
     24307**DCL     24308--REDEF   25736<>CALL
UID$
     24308**DCL     25430<<ASSIGN  25581<<ASSIGN  25615>>IF      25616<<ASSIGN  25655<<ASSIGN  25701<<ASSIGN
     25723>>IF      26128<>CALL    26465>>IF      26841<>CALL    26907<>CALL
UPDATE_SUBS
     27173**PROC    25703--CALL    27147--CALL
UPDOSI.LNSAP.ADDRESS_N
PL6.E3A0      #002=GJA$DECODE_APL_MSG File=GJA$ADMIN.:E05TSI                     TUE 07/29/97 21:51 Page:574  
     25225**DCL     25226--REDEF
UPDOSI.MYNODE#
     25106**DCL     25108--REDEF
UPDOSI.NODE#
     25109**DCL     25111--REDEF
UPDOSI.NSAP.ADDRESS_N
     25169**DCL     25170--REDEF
VDO_BUFFER
     23441**DCL     25740--ASSIGN  26122--ASSIGN  26136--ASSIGN  26271--ASSIGN  26501--ASSIGN  26501--ASSIGN
     26502--ASSIGN  26503--ASSIGN  26504--CALL    26504--CALL    26504--CALL    26504--CALL    26505--ASSIGN
     26716--ASSIGN  26717--ASSIGN  26720--ASSIGN  26725--CALL    26743--ASSIGN  26744--ASSIGN  26747--ASSIGN
     26749--ASSIGN  26750--ASSIGN  26752--CALL    26847--ASSIGN  27526--ASSIGN  27527--ASSIGN  27528--ASSIGN
     27528--ASSIGN  27531<>CALL    27531--CALL    27531--CALL
WHO
     24314**DCL     25431<<ASSIGN  25438>>IF      25500>>IF      25549>>IF      25583<<ASSIGN  25584>>IF
     25598>>IF      25629>>IF      25645>>IF      25650>>IF      25723>>IF      25774<<ASSIGN  25775>>IF
     26143>>IF      26491>>IF

PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:575  
     3204        1        /*T***********************************************************/
     3205        2        /*T*                                                         */
     3206        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3207        4        /*T*                                                         */
     3208        5        /*T***********************************************************/
     3209        6        GJA$NA_INFO: PROC (KL$CONTROL) ALTRET;
     3210        7        %INCLUDE LCP_6;
     3211     4286        %INCLUDE KL_CONTROL_C;
     3212     4666        %INCLUDE KL_MACRO_C;
     3213     8018
     3214     8019        %KL_CONTROL(FPTN=KL$CONTROL,STCLASS="");
     3215     8156    1   DCL GJA_INTLEV UBIN SYMREF;
     3216     8157    1   DCL GJA_ATTR UBIN(16) SYMREF;
     3217     8158    1   DCL GJA_HOPCOST UBIN SYMREF;
     3218     8159    1   DCL GJA_RCQSIZE UBIN SYMREF;
     3219     8160    1   DCL GJA_SCQSIZE UBIN SYMREF;
     3220     8161    1   DCL GJA_RETRYMAX UBIN SYMREF;
     3221     8162    1   DCL GJA_MEMORY UBIN SYMREF;
     3222     8163
     3223     8164    1      IF KL$CONTROL.CMD = %KL_CONTROL_SET THEN
     3224     8165    1           KL$CONTROL.VALUE = 0;
     3225     8166    2      ELSE DO;
     3226     8167    2           KL$CONTROL.TYPE = 1;
     3227     8168    3           DO CASE (KL$CONTROL.PARMX);
     3228     8169
     3229     8170    3            CASE (%KL_HNDLRPARM_INTLVL);
     3230     8171    3              KL$CONTROL.VALUE = GJA_INTLEV;
     3231     8172
     3232     8173    3            CASE (%KL_HNDLRPARM_ATTR);
     3233     8174    3              KL$CONTROL.VALUE = GJA_ATTR;
     3234     8175
     3235     8176    3            CASE (%KL_HNDLRPARM_HOPCOST);
     3236     8177    3              KL$CONTROL.VALUE = GJA_HOPCOST;
     3237     8178
     3238     8179    3            CASE (%KL_HNDLRPARM_RCVCQBYTSIZ);
     3239     8180    3              KL$CONTROL.VALUE = GJA_RCQSIZE;
     3240     8181
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:576  
     3241     8182    3            CASE (%KL_HNDLRPARM_SNDCQBYTSIZ);
     3242     8183    3              KL$CONTROL.VALUE = GJA_SCQSIZE;
     3243     8184
     3244     8185    3            CASE (%KL_HNDLRPARM_LGNRTRYNUM);
     3245     8186    3              KL$CONTROL.VALUE = GJA_RETRYMAX;
     3246     8187
     3247     8188    3            CASE (%KL_HNDLRPARM_MEM);
     3248     8189    3              KL$CONTROL.VALUE = GJA_MEMORY;
     3249     8190
     3250     8191    3            CASE (ELSE);
     3251     8192    3              KL$CONTROL.VALUE = 0;
     3252     8193    3              KL$CONTROL.TYPE = 0;
     3253     8194    3              END;
     3254     8195    2           END;
     3255     8196    1   END GJA$NA_INFO;
     3256     8197        %EOD;

PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:577  
--  Include file information  --

   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure GJA$NA_INFO.

   Procedure GJA$NA_INFO requires 108 words for executable code.
   Procedure GJA$NA_INFO requires 6 words of local(AUTO) storage.

PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:578  

 Object Unit name= GJA$NA_INFO                                File name= GJA$ADMIN.:E05TOU
 UTS= JUL 29 '97 21:55:04.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none   108     6C  GJA$NA_INFO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        1  GJA$NA_INFO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     GJA_INTLEV                            GJA_ATTR                              GJA_HOPCOST
     GJA_RCQSIZE                           GJA_SCQSIZE                           GJA_RETRYMAX
     GJA_MEMORY                       r    G$ROS$
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:579  


     3204        1        /*T***********************************************************/
     3205        2        /*T*                                                         */
     3206        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3207        4        /*T*                                                         */
     3208        5        /*T***********************************************************/
     3209        6        GJA$NA_INFO: PROC (KL$CONTROL) ALTRET;

      6   0 000000  D380 0000 0000  xent GJA$NA_INFO     LNJ,B5   X6A_AUTO_1
          0 000003       0006 0001                       DC       6,1

     3210        7        %INCLUDE LCP_6;
     3211     4286        %INCLUDE KL_CONTROL_C;
     3212     4666        %INCLUDE KL_MACRO_C;
     3213     8018
     3214     8019        %KL_CONTROL(FPTN=KL$CONTROL,STCLASS="");
     3215     8156    1   DCL GJA_INTLEV UBIN SYMREF;
     3216     8157    1   DCL GJA_ATTR UBIN(16) SYMREF;
     3217     8158    1   DCL GJA_HOPCOST UBIN SYMREF;
     3218     8159    1   DCL GJA_RCQSIZE UBIN SYMREF;
     3219     8160    1   DCL GJA_SCQSIZE UBIN SYMREF;
     3220     8161    1   DCL GJA_RETRYMAX UBIN SYMREF;
     3221     8162    1   DCL GJA_MEMORY UBIN SYMREF;
     3222     8163
     3223     8164    1      IF KL$CONTROL.CMD = %KL_CONTROL_SET THEN

   8164   0 000005  ECC7 0004                            LDB,B6   @KL$CONTROL,AUTO
          0 000007  E846 0011                            LDR,R6   17,B6
          0 000009  6D01                                 CMV,R6   1
          0 00000A  0981 0005                            BNE      s:8167,PREL

     3224     8165    1           KL$CONTROL.VALUE = 0;

   8165   0 00000C  8746 0014                            CL       20,B6
          0 00000E  0F81 005A                            B        s:8196,PREL

     3225     8166    2      ELSE DO;
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:580  

     3226     8167    2           KL$CONTROL.TYPE = 1;

   8167   0 000010  5C01                                 LDV,R5   1
          0 000011  DA86                                 SRM,R5,'00FF'X    ,B6
          0 000012       00FF

     3227     8168    3           DO CASE (KL$CONTROL.PARMX);

   8168   0 000013  B846 0012                            LDR,R3   18,B6
          0 000015  3D16                                 CMV,R3   22
          0 000016  0281 004E                            BGE      s:8192,PREL
          0 000018  A830 0000 001E  00                   LDR,R2   s:8168+11,R3
          0 00001B  83A0 0000 0034  00                   JMP      s:8171,R2
          0 00001E       0000                            DC       s:8171,PREL
          0 00001F       002A                            DC       s:8189,PREL
          0 000020       0031                            DC       s:8192,PREL
          0 000021       0031                            DC       s:8192,PREL
          0 000022       0007                            DC       s:8174,PREL
          0 000023       0031                            DC       s:8192,PREL
          0 000024       0031                            DC       s:8192,PREL
          0 000025       0031                            DC       s:8192,PREL
          0 000026       0031                            DC       s:8192,PREL
          0 000027       0031                            DC       s:8192,PREL
          0 000028       0031                            DC       s:8192,PREL
          0 000029       0031                            DC       s:8192,PREL
          0 00002A       0015                            DC       s:8180,PREL
          0 00002B       001C                            DC       s:8183,PREL
          0 00002C       0031                            DC       s:8192,PREL
          0 00002D       0031                            DC       s:8192,PREL
          0 00002E       0031                            DC       s:8192,PREL
          0 00002F       0031                            DC       s:8192,PREL
          0 000030       0031                            DC       s:8192,PREL
          0 000031       0031                            DC       s:8192,PREL
          0 000032       0023                            DC       s:8186,PREL
          0 000033       000E                            DC       s:8177,PREL

PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:581  
     3228     8169
     3229     8170    3            CASE (%KL_HNDLRPARM_INTLVL);

     3230     8171    3              KL$CONTROL.VALUE = GJA_INTLEV;

   8171   0 000034  C800 0000 0000  xsym                 LDR,R4   GJA_INTLEV
          0 000037  CF46 0014                            STR,R4   20,B6
          0 000039  0F81 002F                            B        s:8196,PREL

     3231     8172
     3232     8173    3            CASE (%KL_HNDLRPARM_ATTR);

     3233     8174    3              KL$CONTROL.VALUE = GJA_ATTR;

   8174   0 00003B  C800 0000 0000  xsym                 LDR,R4   GJA_ATTR
          0 00003E  CF46 0014                            STR,R4   20,B6
          0 000040  0F81 0028                            B        s:8196,PREL

     3234     8175
     3235     8176    3            CASE (%KL_HNDLRPARM_HOPCOST);

     3236     8177    3              KL$CONTROL.VALUE = GJA_HOPCOST;

   8177   0 000042  C800 0000 0000  xsym                 LDR,R4   GJA_HOPCOST
          0 000045  CF46 0014                            STR,R4   20,B6
          0 000047  0F81 0021                            B        s:8196,PREL

     3237     8178
     3238     8179    3            CASE (%KL_HNDLRPARM_RCVCQBYTSIZ);

     3239     8180    3              KL$CONTROL.VALUE = GJA_RCQSIZE;

   8180   0 000049  C800 0000 0000  xsym                 LDR,R4   GJA_RCQSIZE
          0 00004C  CF46 0014                            STR,R4   20,B6
          0 00004E  0F81 001A                            B        s:8196,PREL

     3240     8181
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:582  
     3241     8182    3            CASE (%KL_HNDLRPARM_SNDCQBYTSIZ);

     3242     8183    3              KL$CONTROL.VALUE = GJA_SCQSIZE;

   8183   0 000050  C800 0000 0000  xsym                 LDR,R4   GJA_SCQSIZE
          0 000053  CF46 0014                            STR,R4   20,B6
          0 000055  0F81 0013                            B        s:8196,PREL

     3243     8184
     3244     8185    3            CASE (%KL_HNDLRPARM_LGNRTRYNUM);

     3245     8186    3              KL$CONTROL.VALUE = GJA_RETRYMAX;

   8186   0 000057  C800 0000 0000  xsym                 LDR,R4   GJA_RETRYMAX
          0 00005A  CF46 0014                            STR,R4   20,B6
          0 00005C  0F81 000C                            B        s:8196,PREL

     3246     8187
     3247     8188    3            CASE (%KL_HNDLRPARM_MEM);

     3248     8189    3              KL$CONTROL.VALUE = GJA_MEMORY;

   8189   0 00005E  C800 0000 0000  xsym                 LDR,R4   GJA_MEMORY
          0 000061  CF46 0014                            STR,R4   20,B6
          0 000063  0F81 0005                            B        s:8196,PREL

     3249     8190
     3250     8191    3            CASE (ELSE);

     3251     8192    3              KL$CONTROL.VALUE = 0;

   8192   0 000065  8746 0014                            CL       20,B6

     3252     8193    3              KL$CONTROL.TYPE = 0;

   8193   0 000067  8806                                 LBF,'00FF'X       ,B6
   8193   0 000068       00FF
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:583  

     3253     8194    3              END;

     3254     8195    2           END;

     3255     8196    1   END GJA$NA_INFO;

   8196   0 000069  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
     3256     8197        %EOD;

PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:584  
--  Include file information  --

   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure GJA$NA_INFO.
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:585  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KL$CONTROL               *0-0-0/w STRC(352)   r     1 KL$CONTROL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(16)    r     1 GJA_ATTR                   0-0-0/w UBIN(16)    r     1 GJA_HOPCOST
     0-0-0/w UBIN(16)    r     1 GJA_INTLEV                 0-0-0/w UBIN(16)    r     1 GJA_MEMORY
     0-0-0/w UBIN(16)    r     1 GJA_RCQSIZE                0-0-0/w UBIN(16)    r     1 GJA_RETRYMAX
     0-0-0/w UBIN(16)    r     1 GJA_SCQSIZE


   Procedure GJA$NA_INFO requires 108 words for executable code.
   Procedure GJA$NA_INFO requires 6 words of local(AUTO) storage.
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:586  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=GJA$NA_INFO File=GJA$ADMIN.:E05TSI                            TUE 07/29/97 21:55 Page:587  
          MINI XREF LISTING

GJA_ATTR
      8157**DCL      8174>>ASSIGN
GJA_HOPCOST
      8158**DCL      8177>>ASSIGN
GJA_INTLEV
      8156**DCL      8171>>ASSIGN
GJA_MEMORY
      8162**DCL      8189>>ASSIGN
GJA_RCQSIZE
      8159**DCL      8180>>ASSIGN
GJA_RETRYMAX
      8161**DCL      8186>>ASSIGN
GJA_SCQSIZE
      8160**DCL      8183>>ASSIGN
KL$CONTROL
      8050**DCL         6--PROC
KL$CONTROL.CMD
      8116**DCL      8164>>IF
KL$CONTROL.PARMX
      8117**DCL      8168>>DOCASE
KL$CONTROL.TYPE
      8056**DCL      8167<<ASSIGN   8193<<ASSIGN
KL$CONTROL.VALUE
      8119**DCL      8165<<ASSIGN   8171<<ASSIGN   8174<<ASSIGN   8177<<ASSIGN   8180<<ASSIGN   8183<<ASSIGN
      8186<<ASSIGN   8189<<ASSIGN   8192<<ASSIGN

PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:588  
     3257        1        /*T***********************************************************/
     3258        2        /*T*                                                         */
     3259        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3260        4        /*T*                                                         */
     3261        5        /*T***********************************************************/
     3262        6        GJA$SEND_MSG: PROC (CTX$,MSG,MSGSZ,VFC) ALTRET;
     3263        7
     3264        8        %INCLUDE LCP_6;
     3265     4287        %INCLUDE K_SCODE_C;
     3266     4372        %INCLUDE KI_SUBS_C;
     3267     4508        %INCLUDE KV$VDO;
     3268     5523        %INCLUDE GJA_MSG_M;
     3269     5762        %INCLUDE KNH_MACRO_C;
     3270     6045
     3271     6046        %GJA_UID_EQUS;
     3272     6054        %KV_VDO_ALL_E;
     3273     6133
     3274     6134        %KV$VDO_BLKDAT (NAME=VDO_BLKDAT,STCLASS=STATIC,STR=KIDM_CP);
     3275     6177        %KV$VDO_RQSDAT (NAME=VDO_RQSDAT,STCLASS=STATIC,STR=KIDM_CP,
     3276     6178                        MAXNMBRCR=0,INCMAXNMBRCR=NO);
     3277     6226        %KV$VDO_DAT (NAME=GJA_VDO_DAT_DAT2,STCLASS=SYMREF);
     3278     6271        %KV$VDO_DAT (NAME=GJA_LDDAT,STCLASS=SYMREF,LAST=",");
     3279     6316             %KV$VDOVLP_ERR(NAME=ERR,LVL=2);
     3280     6413    1   DCL CTX$ PTR;
     3281     6414    1   DCL MSG CHAR(MSGSZ);
     3282     6415    1   DCL MSGSZ UBIN;
     3283     6416    1   DCL VFC CHAR(1) CALIGNED;
     3284     6417    1   DCL SIZE UBIN;
     3285     6418    1   DCL STRING CHAR(SIZE) BASED;
     3286     6419    1   DCL 1 SV$MSG BASED,
     3287     6420    1         2 BFRSIZ UBIN,     /* size of the buffer so we can use 2nsys  */
     3288     6421    1         2 LNK$ PTR,
     3289     6422    1         2 SZ UBIN,
     3290     6423    1         2 VFC CHAR(1) UNAL,
     3291     6424    1         2 * CHAR(1) UNAL;
     3292     6425    1   DCL WHO UBIN;
     3293     6426    1   DCL SVMSG$ PTR;
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:589  
     3294     6427    1   DCL TMP$ PTR;
     3295     6428    1   DCL SVMSGCNT UBIN;
     3296     6429    1   DCL TCTX$ PTR;
     3297     6430    1   DCL GJA_UID_NM UBIN(32) SYMREF;
     3298     6431    1   DCL GJA_UID_NM$ REDEF GJA_UID_NM PTR;
     3299     6432    1   DCL GJA_HAND_HEAD$ PTR SYMREF;
     3300     6433        %VLP_SCODE (FPTN=NODEMEM,ERR#=%S$NODEMEM,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     3301     6494
     3302     6495        %GJA$HAND_CTX;
     3303     6544
     3304     6545                                                /* Entry references         */
     3305     6546    1   DCL GJA$WRITE ENTRY(6);
     3306     6547    1   DCL GJA$Q_MSG ENTRY(6);
     3307     6548    1   DCL KVB$GET2NSYS ENTRY(2) ALTRET;
     3308     6549    1   DCL KVB$GETSYS ENTRY(2) ALTRET;
     3309     6550
     3310     6551    1      WHO = CTX$->GJA$HAND_CTX.WHO;
     3311     6552    1      IF WHO = %GJA_UID_BABOON OR WHO = %GJA_UID_LOGON
     3312     6553    1        OR (CTX$->GJA$HAND_CTX.MAXNMBRCR > 0 AND MSGSZ <= CTX$->GJA$HAND_CTX.
              6553                 MAXRCRBYTSIZ)
     3313     6554    2      THEN DO;
     3314     6555    2           IF ADDR(VFC) ~= ADDR(NIL)
     3315     6556    3           THEN DO;
     3316     6557    3                GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %KV_DATCTRCHRTYP_VFC;
     3317     6558    3                GJA_VDO_DAT_DAT2.DATCTRCHR = VFC;
     3318     6559    3                END;
     3319     6560    2           CALL GJA$WRITE (CTX$,
     3320     6561    2             MSGSZ,MSG);
     3321     6562    2           GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %KV_DATCTRCHRTYP_NON;
     3322     6563    2           IF WHO ~= %GJA_UID_BABOON AND WHO ~= %GJA_UID_LOGON
     3323     6564    3           THEN DO;
     3324     6565    3                CTX$->GJA$HAND_CTX.MAXNMBBYT = CTX$->GJA$HAND_CTX.MAXNMBBYT - MSGSZ;
     3325     6566    3                CTX$->GJA$HAND_CTX.MAXNMBRCR = CTX$->GJA$HAND_CTX.MAXNMBRCR-1;
     3326     6567    3                END;
     3327     6568    2           END;
     3328     6569
     3329     6570
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:590  
     3330     6571    2      ELSE DO;
     3331     6572    2           IF CTX$->GJA$HAND_CTX.MAXNMBRCR > 0
     3332     6573    3           THEN DO;
     3333     6574    3                CTX$->GJA$HAND_CTX.MAXNMBRCR = CTX$->GJA$HAND_CTX.MAXNMBRCR - 1;
     3334     6575    3                CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_LDDAT),GJA_LDDAT);
     3335     6576    3                END;
     3336     6577    3           ELSE DO;
     3337     6578    4                DO CASE(WHO);
     3338     6579    4                 CASE(%GJA_UID_NM);
     3339     6580    4                   IF NOT CTX$->GJA$HAND_CTX.HOST_NODE THEN
     3340     6581    5                   DO;
     3341     6582                               /* need credits from another nodeadmn  so ask for um
     3342     6583                                  dont send blk dat to slug*/
     3343     6584    5                        VDO_BLKDAT.RCRBYTSIZ = MSGSZ;
     3344     6585    5                        CALL GJA$Q_MSG(CTX$,LENGTHC(VDO_BLKDAT),VDO_BLKDAT);
     3345     6586    5                        END;
     3346     6587    4                 CASE(%GJA_UID_HANDLER);
     3347     6588    4                   IF NOT CTX$->GJA$HAND_CTX.BLK THEN
     3348     6589                  /* dont block a handler who is already flow controlled*/
     3349     6590    5                   DO;
     3350     6591    5                        VDO_BLKDAT.RCRBYTSIZ = MSGSZ;
     3351     6592    5                        CALL GJA$Q_MSG(CTX$,LENGTHC(VDO_BLKDAT),VDO_BLKDAT);
     3352     6593    5                        END;
     3353     6594    4                 CASE(ELSE);
     3354     6595                            /* should never get here.  LOGON and BABOON are taken
     3355     6596                               care over above */
     3356     6597    4                   END;                    /* do case(who)*/
     3357     6598    3                END;
     3358     6599                            /* returns actual size of buffer in first word  */
     3359     6600    2           CALL KVB$GET2NSYS ((MSGSZ+SIZEC(SV$MSG)+1)/2,SVMSG$)
     3360     6601    3           WHENALTRETURN DO;
     3361     6602    3                CALL M$SCREECH(NODEMEM);
     3362     6603                  /*S* SCREECH_CODE: GJA-S$NODEMEM
     3363     6604                       TYPE:SCREECH
     3364     6605                       MESSAGE: NODEADMN out of memory
     3365     6606                       REMARKS: Nodeadmin ran out of memory.
     3366     6607         */
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:591  
     3367     6608    3                END;
     3368     6609    2           SVMSG$->SV$MSG.LNK$ = ADDR(NIL);
     3369     6610    2           SVMSG$->SV$MSG.SZ = MSGSZ;
     3370     6611    2           IF ADDR(VFC) = ADDR(NIL)
     3371     6612    2           THEN
     3372     6613    2                SVMSG$->SV$MSG.VFC = BINASC(0);
     3373     6614    2           ELSE
     3374     6615    2                SVMSG$->SV$MSG.VFC = VFC;
     3375     6616    2           SVMSGCNT = SVMSG$->SV$MSG.SZ;
     3376     6617    2           IF CTX$->GJA$HAND_CTX.WAITING_MSG$ = ADDR(NIL)
     3377     6618    2           THEN CTX$->GJA$HAND_CTX.WAITING_MSG$ = SVMSG$;
     3378     6619    3           ELSE DO;
     3379     6620    3                TMP$ = CTX$->GJA$HAND_CTX.WAITING_MSG$;
     3380     6621    4                DO WHILE (TMP$->SV$MSG.LNK$ ~= ADDR(NIL));
     3381     6622    4                     TMP$ = TMP$->SV$MSG.LNK$;
     3382     6623    4                     SVMSGCNT = SVMSGCNT + TMP$->SV$MSG.SZ;
     3383     6624    4                     END;
     3384     6625    3                TMP$->SV$MSG.LNK$ = SVMSG$;
     3385     6626    3                END;
     3386     6627    2           SVMSG$ = PINCRW(SVMSG$,SIZEW(SV$MSG));
     3387     6628    2           SIZE = MSGSZ;
     3388     6629    2           SVMSG$->STRING = MSG;
     3389     6630        /*
     3390     6631           If the path to the Host is blocked, flow control every handler.
     3391     6632        */
     3392     6633    2           IF CTX$ = GJA_UID_NM$ AND SVMSGCNT >= 4096
     3393     6634    3           THEN DO;
     3394     6635    3                TCTX$ = GJA_HAND_HEAD$;
     3395     6636    4                DO WHILE ( TCTX$ ~= ADDR(NIL) );
     3396     6637    4                     IF TCTX$->GJA$HAND_CTX.WHO = %GJA_UID_HANDLER AND
     3397     6638    4                       NOT TCTX$->GJA$HAND_CTX.BLK
     3398     6639    4                     THEN
     3399     6640    5                     DO;
     3400     6641    5                          CALL GJA$Q_MSG (TCTX$,LENGTHC(VDO_RQSDAT),VDO_RQSDAT);
     3401     6642    5                          TCTX$->GJA$HAND_CTX.BLK = '1'B;
     3402     6643    5                          END;
     3403     6644    4                     TCTX$ = TCTX$->GJA$HAND_CTX.LNK$;
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:592  
     3404     6645    4                     END;
     3405     6646    3                END;
     3406     6647    2           END;
     3407     6648
     3408     6649    1      RETURN;
     3409     6650
     3410     6651    1   END GJA$SEND_MSG;

PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:593  
--  Include file information  --

   KNH_MACRO_C.:E05TOU  is referenced.
   GJA_MSG_M.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure GJA$SEND_MSG.

   Procedure GJA$SEND_MSG requires 494 words for executable code.
   Procedure GJA$SEND_MSG requires 34 words of local(AUTO) storage.

    No errors detected in file GJA$ADMIN.:E05TSI    .

PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:594  

 Object Unit name= GJA$SEND_MSG                               File name= GJA$ADMIN.:E05TOU
 UTS= JUL 29 '97 21:55:23.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none    11      B  GJA$SEND_MSG
    1   Proc  even  none   494    1EE  GJA$SEND_MSG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        4  GJA$SEND_MSG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       6 GJA$WRITE
         yes           Std       6 GJA$Q_MSG
 yes     yes           Std       2 KVB$GET2NSYS
                       nStd      0 X6A_AUTO_N
                       nStd      0 X6C_ALR
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     GJA_VDO_DAT_DAT2                      GJA_LDDAT                             GJA_UID_NM
     GJA_HAND_HEAD$                   r    G$ROS$
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:595  


     3257        1        /*T***********************************************************/
     3258        2        /*T*                                                         */
     3259        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     3260        4        /*T*                                                         */
     3261        5        /*T***********************************************************/
     3262        6        GJA$SEND_MSG: PROC (CTX$,MSG,MSGSZ,VFC) ALTRET;

      6   1 000000  D380 0000 0000  xent GJA$SEND_MSG    LNJ,B5   X6A_AUTO_N
          1 000003       0022 0004                       DC       34,4

     3263        7
     3264        8        %INCLUDE LCP_6;
     3265     4287        %INCLUDE K_SCODE_C;
     3266     4372        %INCLUDE KI_SUBS_C;
     3267     4508        %INCLUDE KV$VDO;
     3268     5523        %INCLUDE GJA_MSG_M;
     3269     5762        %INCLUDE KNH_MACRO_C;
     3270     6045
     3271     6046        %GJA_UID_EQUS;
     3272     6054        %KV_VDO_ALL_E;
     3273     6133
     3274     6134        %KV$VDO_BLKDAT (NAME=VDO_BLKDAT,STCLASS=STATIC,STR=KIDM_CP);
     3275     6177        %KV$VDO_RQSDAT (NAME=VDO_RQSDAT,STCLASS=STATIC,STR=KIDM_CP,
     3276     6178                        MAXNMBRCR=0,INCMAXNMBRCR=NO);
     3277     6226        %KV$VDO_DAT (NAME=GJA_VDO_DAT_DAT2,STCLASS=SYMREF);
     3278     6271        %KV$VDO_DAT (NAME=GJA_LDDAT,STCLASS=SYMREF,LAST=",");
     3279     6316             %KV$VDOVLP_ERR(NAME=ERR,LVL=2);
     3280     6413    1   DCL CTX$ PTR;
     3281     6414    1   DCL MSG CHAR(MSGSZ);
     3282     6415    1   DCL MSGSZ UBIN;
     3283     6416    1   DCL VFC CHAR(1) CALIGNED;
     3284     6417    1   DCL SIZE UBIN;
     3285     6418    1   DCL STRING CHAR(SIZE) BASED;
     3286     6419    1   DCL 1 SV$MSG BASED,
     3287     6420    1         2 BFRSIZ UBIN,     /* size of the buffer so we can use 2nsys  */
     3288     6421    1         2 LNK$ PTR,
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:596  
     3289     6422    1         2 SZ UBIN,
     3290     6423    1         2 VFC CHAR(1) UNAL,
     3291     6424    1         2 * CHAR(1) UNAL;
     3292     6425    1   DCL WHO UBIN;
     3293     6426    1   DCL SVMSG$ PTR;
     3294     6427    1   DCL TMP$ PTR;
     3295     6428    1   DCL SVMSGCNT UBIN;
     3296     6429    1   DCL TCTX$ PTR;
     3297     6430    1   DCL GJA_UID_NM UBIN(32) SYMREF;
     3298     6431    1   DCL GJA_UID_NM$ REDEF GJA_UID_NM PTR;
     3299     6432    1   DCL GJA_HAND_HEAD$ PTR SYMREF;
     3300     6433        %VLP_SCODE (FPTN=NODEMEM,ERR#=%S$NODEMEM,FCG=GJ,MID=A,SEV=G_SEV_SCREECH#);
     3301     6494
     3302     6495        %GJA$HAND_CTX;
     3303     6544
     3304     6545                                                /* Entry references         */
     3305     6546    1   DCL GJA$WRITE ENTRY(6);
     3306     6547    1   DCL GJA$Q_MSG ENTRY(6);
     3307     6548    1   DCL KVB$GET2NSYS ENTRY(2) ALTRET;
     3308     6549    1   DCL KVB$GETSYS ENTRY(2) ALTRET;
     3309     6550
     3310     6551    1      WHO = CTX$->GJA$HAND_CTX.WHO;

   6551   1 000005  ECC7 0004                            LDB,B6   @CTX$,AUTO
          1 000007  DC86                                 LDB,B5   ,B6
          1 000008  E805                                 LDR,R6   ,B5
          1 000009  604D                                 SOR,R6   13
          1 00000A  EF47 000D                            STR,R6   WHO,AUTO

     3311     6552    1      IF WHO = %GJA_UID_BABOON OR WHO = %GJA_UID_LOGON

   6552   1 00000C  6D02                                 CMV,R6   2
          1 00000D  0901 000F                            BE       s:6555,PREL
          1 00000F  6D04                                 CMV,R6   4
          1 000010  0901 000C                            BE       s:6555,PREL
          1 000012  D845 0004                            LDR,R5   4,B5
          1 000014  5901 007A                            BEZ,R5   s:6572,PREL
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:597  
          1 000016  CCC7 0008                            LDB,B4   @MSGSZ,AUTO
          1 000018  C804                                 LDR,R4   ,B4
          1 000019  C945 0003                            CMR,R4   3,B5
          1 00001B  0301 0073                            BG       s:6572,PREL

     3312     6553    1        OR (CTX$->GJA$HAND_CTX.MAXNMBRCR > 0 AND MSGSZ <= CTX$->GJA$HAND_CTX.
              6553                 MAXRCRBYTSIZ)
     3313     6554    2      THEN DO;

     3314     6555    2           IF ADDR(VFC) ~= ADDR(NIL)

   6555   1 00001D  8CC7 000A                            LDI      @VFC,AUTO
          1 00001F  B856                                 LDR,R3   R6
          1 000020  E570 7FFF                            AND,R6   32767,IMO
          1 000022  8D47 0016                            SDI      TCTX$+3,AUTO
          1 000024  DCC7 0016                            LDB,B5   TCTX$+3,AUTO
          1 000026  304F                                 SOR,R3   15
          1 000027  DFC7 0018                            STB,B5   TCTX$+5,AUTO
          1 000029  8CC7 0018                            LDI      TCTX$+5,AUTO
          1 00002B  7031                                 DCL,R7   1
          1 00002C  8D47 001A                            SDI      TCTX$+7,AUTO
          1 00002E  F853                                 LDR,R7   R3
          1 00002F  6C00                                 LDV,R6   0
          1 000030  8447 001A                            AID      TCTX$+7,AUTO
          1 000032  7071                                 DCR,R7   1
          1 000033  8D47 001C                            SDI      TCTX$+9,AUTO
          1 000035  8DC7 001C                            CMN      TCTX$+9,AUTO
          1 000037  0901 0016                            BE       s:6560,PREL

     3315     6556    3           THEN DO;

     3316     6557    3                GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %KV_DATCTRCHRTYP_VFC;

   6557   1 000039  D870 0800                            LDR,R5   2048,IMO
          1 00003B  DA80 0000 0001  xsym                 SRM,R5,'0C00'X    GJA_VDO_DAT_DAT2+1
          1 00003E       0C00

PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:598  
     3317     6558    3                GJA_VDO_DAT_DAT2.DATCTRCHR = VFC;

   6558   1 00003F  8CC7 000A                            LDI      @VFC,AUTO
          1 000041  B856                                 LDR,R3   R6
          1 000042  E570 7FFF                            AND,R6   32767,IMO
          1 000044  8D47 0016                            SDI      TCTX$+3,AUTO
          1 000046  CCC7 0016                            LDB,B4   TCTX$+3,AUTO
          1 000048  304F                                 SOR,R3   15
          1 000049  C0B4                                 LDH,R4   ,B4,R3
          1 00004A  CA80 0000 0001  xsym                 SRM,R4,'00FF'X    GJA_VDO_DAT_DAT2+1
          1 00004D       00FF

     3318     6559    3                END;

     3319     6560    2           CALL GJA$WRITE (CTX$,

   6560   1 00004E  8CC7 0006                            LDI      @MSG,AUTO
          1 000050  B856                                 LDR,R3   R6
          1 000051  E570 7FFF                            AND,R6   32767,IMO
          1 000053  8D47 0016                            SDI      TCTX$+3,AUTO
          1 000055  CCC7 0016                            LDB,B4   TCTX$+3,AUTO
          1 000057  304F                                 SOR,R3   15
          1 000058  CFC7 001E                            STB,B4   TCTX$+11,AUTO
          1 00005A  8CC7 001E                            LDI      TCTX$+11,AUTO
          1 00005C  7031                                 DCL,R7   1
          1 00005D  8D47 0020                            SDI      TCTX$+13,AUTO
          1 00005F  F853                                 LDR,R7   R3
          1 000060  6C00                                 LDV,R6   0
          1 000061  8447 0020                            AID      TCTX$+13,AUTO
          1 000063  7071                                 DCR,R7   1
          1 000064  8D47 001C                            SDI      TCTX$+9,AUTO
          1 000066  BCC7 0008                            LDB,B3   @MSGSZ,AUTO
          1 000068  BFC7 001A                            STB,B3   TCTX$+7,AUTO
          1 00006A  EFC7 0018                            STB,B6   TCTX$+5,AUTO
          1 00006C  BBC7 0018                            LAB,B3   TCTX$+5,AUTO
          1 00006E  CBF0 0300                            LAB,B4   768,IMO
          1 000070  E380 0000 0000  xent                 LNJ,B6   GJA$WRITE
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:599  
          1 000073       0001                            DC       s:6562,PREL

     3320     6561    2             MSGSZ,MSG);
     3321     6562    2           GJA_VDO_DAT_DAT2.DATCTRCHRTYP = %KV_DATCTRCHRTYP_NON;

   6562   1 000074  8800 0000 0001  xsym                 LBF,'0C00'X       GJA_VDO_DAT_DAT2+1
   6562   1 000077       0C00

     3322     6563    2           IF WHO ~= %GJA_UID_BABOON AND WHO ~= %GJA_UID_LOGON

   6563   1 000078  E847 000D                            LDR,R6   WHO,AUTO
          1 00007A  6D02                                 CMV,R6   2
          1 00007B  0901 016F                            BE       s:6649,PREL
          1 00007D  6D04                                 CMV,R6   4
          1 00007E  0901 016C                            BE       s:6649,PREL

     3323     6564    3           THEN DO;

     3324     6565    3                CTX$->GJA$HAND_CTX.MAXNMBBYT = CTX$->GJA$HAND_CTX.MAXNMBBYT - MSGSZ;

   6565   1 000080  ECC7 0004                            LDB,B6   @CTX$,AUTO
          1 000082  DC86                                 LDB,B5   ,B6
          1 000083  CCC7 0008                            LDB,B4   @MSGSZ,AUTO
          1 000085  D845 0005                            LDR,R5   5,B5
          1 000087  D204                                 SUB,R5   ,B4
          1 000088  DF45 0005                            STR,R5   5,B5

     3325     6566    3                CTX$->GJA$HAND_CTX.MAXNMBRCR = CTX$->GJA$HAND_CTX.MAXNMBRCR-1;

   6566   1 00008A  DC86                                 LDB,B5   ,B6
          1 00008B  88C5 0004                            DEC      4,B5

     3326     6567    3                END;

     3327     6568    2           END;

   6568   1 00008D  0F81 015D                            B        s:6649,PREL
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:600  

     3328     6569
     3329     6570
     3330     6571    2      ELSE DO;

     3331     6572    2           IF CTX$->GJA$HAND_CTX.MAXNMBRCR > 0

   6572   1 00008F  5901 0018                            BEZ,R5   s:6578,PREL

     3332     6573    3           THEN DO;

     3333     6574    3                CTX$->GJA$HAND_CTX.MAXNMBRCR = CTX$->GJA$HAND_CTX.MAXNMBRCR - 1;

   6574   1 000091  88C5 0004                            DEC      4,B5

     3334     6575    3                CALL GJA$Q_MSG(CTX$,LENGTHC(GJA_LDDAT),GJA_LDDAT);

   6575   1 000093  DBF0 000A                            LAB,B5   10,IMO
          1 000095  CB80 0000 0000  xsym                 LAB,B4   GJA_LDDAT
          1 000098  CFC7 001A                            STB,B4   TCTX$+7,AUTO
          1 00009A  DFC7 0018                            STB,B5   TCTX$+5,AUTO
          1 00009C  EFC7 0016                            STB,B6   TCTX$+3,AUTO
          1 00009E  BBC7 0016                            LAB,B3   TCTX$+3,AUTO
          1 0000A0  CBF0 0300                            LAB,B4   768,IMO
          1 0000A2  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          1 0000A5       0001                            DC       s:6576,PREL

     3335     6576    3                END;

   6576   1 0000A6  0F81 004F                            B        s:6600,PREL

     3336     6577    3           ELSE DO;

     3337     6578    4                DO CASE(WHO);

   6578   1 0000A8  B856                                 LDR,R3   R6
          1 0000A9  3D04                                 CMV,R3   4
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:601  
          1 0000AA  0281 004B                            BGE      s:6600,PREL
          1 0000AC  A830 0000 00B2  01                   LDR,R2   s:6578+10,R3
          1 0000AF  83A0 0000 00B6  01                   JMP      s:6580,R2
          1 0000B2       0040                            DC       s:6600,PREL
          1 0000B3       0000                            DC       s:6580,PREL
          1 0000B4       0040                            DC       s:6600,PREL
          1 0000B5       0020                            DC       s:6588,PREL

     3338     6579    4                 CASE(%GJA_UID_NM);

     3339     6580    4                   IF NOT CTX$->GJA$HAND_CTX.HOST_NODE THEN

   6580   1 0000B6  82C5 000D                            LB,'2000'X        13,B5
   6580   1 0000B8       2000
          1 0000B9  0501 003C                            BBT      s:6600,PREL

     3340     6581    5                   DO;

     3341     6582                               /* need credits from another nodeadmn  so ask for um
     3342     6583                                  dont send blk dat to slug*/
     3343     6584    5                        VDO_BLKDAT.RCRBYTSIZ = MSGSZ;

   6584   1 0000BB  CCC7 0008                            LDB,B4   @MSGSZ,AUTO
          1 0000BD  C804                                 LDR,R4   ,B4
          1 0000BE  CF00 0000 0001  00                   STR,R4   VDO_BLKDAT+1

     3344     6585    5                        CALL GJA$Q_MSG(CTX$,LENGTHC(VDO_BLKDAT),VDO_BLKDAT);

   6585   1 0000C1  DBF0 0006                            LAB,B5   6,IMO
          1 0000C3  BB80 0000 0000  00                   LAB,B3   VDO_BLKDAT
          1 0000C6  BFC7 001A                            STB,B3   TCTX$+7,AUTO
          1 0000C8  DFC7 0018                            STB,B5   TCTX$+5,AUTO
          1 0000CA  EFC7 0016                            STB,B6   TCTX$+3,AUTO
          1 0000CC  BBC7 0016                            LAB,B3   TCTX$+3,AUTO
          1 0000CE  CBF0 0300                            LAB,B4   768,IMO
          1 0000D0  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          1 0000D3       0001                            DC       s:6586,PREL
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:602  

     3345     6586    5                        END;

   6586   1 0000D4  0F81 0021                            B        s:6600,PREL

     3346     6587    4                 CASE(%GJA_UID_HANDLER);

     3347     6588    4                   IF NOT CTX$->GJA$HAND_CTX.BLK THEN

   6588   1 0000D6  82C5 000D                            LB,'1000'X        13,B5
   6588   1 0000D8       1000
          1 0000D9  0501 001C                            BBT      s:6600,PREL

     3348     6589                  /* dont block a handler who is already flow controlled*/
     3349     6590    5                   DO;

     3350     6591    5                        VDO_BLKDAT.RCRBYTSIZ = MSGSZ;

   6591   1 0000DB  CCC7 0008                            LDB,B4   @MSGSZ,AUTO
          1 0000DD  C804                                 LDR,R4   ,B4
          1 0000DE  CF00 0000 0001  00                   STR,R4   VDO_BLKDAT+1

     3351     6592    5                        CALL GJA$Q_MSG(CTX$,LENGTHC(VDO_BLKDAT),VDO_BLKDAT);

   6592   1 0000E1  DBF0 0006                            LAB,B5   6,IMO
          1 0000E3  BB80 0000 0000  00                   LAB,B3   VDO_BLKDAT
          1 0000E6  BFC7 001A                            STB,B3   TCTX$+7,AUTO
          1 0000E8  DFC7 0018                            STB,B5   TCTX$+5,AUTO
          1 0000EA  EFC7 0016                            STB,B6   TCTX$+3,AUTO
          1 0000EC  BBC7 0016                            LAB,B3   TCTX$+3,AUTO
          1 0000EE  CBF0 0300                            LAB,B4   768,IMO
          1 0000F0  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          1 0000F3       0001                            DC       s:6593,PREL

     3352     6593    5                        END;

   6593   1 0000F4  0F81 0001                            B        s:6600,PREL
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:603  

     3353     6594    4                 CASE(ELSE);

     3354     6595                            /* should never get here.  LOGON and BABOON are taken
     3355     6596                               care over above */
     3356     6597    4                   END;                    /* do case(who)*/

     3357     6598    3                END;

     3358     6599                            /* returns actual size of buffer in first word  */
     3359     6600    2           CALL KVB$GET2NSYS ((MSGSZ+SIZEC(SV$MSG)+1)/2,SVMSG$)

   6600   1 0000F6  ECC7 0008                            LDB,B6   @MSGSZ,AUTO
          1 0000F8  E806                                 LDR,R6   ,B6
          1 0000F9  6E0B                                 ADV,R6   11
          1 0000FA  6041                                 SOR,R6   1
          1 0000FB  EF47 0016                            STR,R6   TCTX$+3,AUTO
          1 0000FD  DBC7 000E                            LAB,B5   SVMSG$,AUTO
          1 0000FF  DFC7 0019                            STB,B5   TCTX$+6,AUTO
          1 000101  CBC7 0016                            LAB,B4   TCTX$+3,AUTO
          1 000103  CFC7 0017                            STB,B4   TCTX$+4,AUTO
          1 000105  BBC7 0017                            LAB,B3   TCTX$+4,AUTO
          1 000107  CBF0 0200                            LAB,B4   512,IMO
          1 000109  E380 0000 0000  xent                 LNJ,B6   KVB$GET2NSYS
          1 00010C       0003                            DC       s:6602,PREL
          1 00010D  0F81 0008                            B        s:6609,PREL

     3360     6601    3           WHENALTRETURN DO;

     3361     6602    3                CALL M$SCREECH(NODEMEM);

   6602   1 00010F  BB80 0000 0008  00                   LAB,B3   NODEMEM
          1 000112  B870 0485                            LDR,R3   1157,IMO
          1 000114  0001                                 MCL
          1 000115       0000                            DC       s:6602+6,PREL

     3362     6603                  /*S* SCREECH_CODE: GJA-S$NODEMEM
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:604  
     3363     6604                       TYPE:SCREECH
     3364     6605                       MESSAGE: NODEADMN out of memory
     3365     6606                       REMARKS: Nodeadmin ran out of memory.
     3366     6607         */
     3367     6608    3                END;

     3368     6609    2           SVMSG$->SV$MSG.LNK$ = ADDR(NIL);

   6609   1 000116  EB80 0000 0000                       LAB,B6   0
          1 000119  DCC7 000E                            LDB,B5   SVMSG$,AUTO
          1 00011B  EFC5 0001                            STB,B6   1,B5

     3369     6610    2           SVMSG$->SV$MSG.SZ = MSGSZ;

   6610   1 00011D  ECC7 000E                            LDB,B6   SVMSG$,AUTO
          1 00011F  DCC7 0008                            LDB,B5   @MSGSZ,AUTO
          1 000121  E805                                 LDR,R6   ,B5
          1 000122  EF46 0003                            STR,R6   3,B6

     3370     6611    2           IF ADDR(VFC) = ADDR(NIL)

   6611   1 000124  8CC7 000A                            LDI      @VFC,AUTO
          1 000126  B856                                 LDR,R3   R6
          1 000127  E570 7FFF                            AND,R6   32767,IMO
          1 000129  8D47 0016                            SDI      TCTX$+3,AUTO
          1 00012B  ECC7 0016                            LDB,B6   TCTX$+3,AUTO
          1 00012D  304F                                 SOR,R3   15
          1 00012E  EFC7 0018                            STB,B6   TCTX$+5,AUTO
          1 000130  8CC7 0018                            LDI      TCTX$+5,AUTO
          1 000132  7031                                 DCL,R7   1
          1 000133  8D47 001A                            SDI      TCTX$+7,AUTO
          1 000135  F853                                 LDR,R7   R3
          1 000136  6C00                                 LDV,R6   0
          1 000137  8447 001A                            AID      TCTX$+7,AUTO
          1 000139  7071                                 DCR,R7   1
          1 00013A  8D47 001C                            SDI      TCTX$+9,AUTO
          1 00013C  8DC7 001C                            CMN      TCTX$+9,AUTO
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:605  
          1 00013E  0981 0008                            BNE      s:6615,PREL

     3371     6612    2           THEN
     3372     6613    2                SVMSG$->SV$MSG.VFC = BINASC(0);

   6613   1 000140  5C00                                 LDV,R5   0
          1 000141  CCC7 000E                            LDB,B4   SVMSG$,AUTO
          1 000143  D7C4 0004                            STH,R5   4,B4
          1 000145  0F81 0010                            B        s:6616,PREL

     3373     6614    2           ELSE
     3374     6615    2                SVMSG$->SV$MSG.VFC = VFC;

   6615   1 000147  8CC7 000A                            LDI      @VFC,AUTO
          1 000149  B856                                 LDR,R3   R6
          1 00014A  E570 7FFF                            AND,R6   32767,IMO
          1 00014C  8D47 0016                            SDI      TCTX$+3,AUTO
          1 00014E  CCC7 0016                            LDB,B4   TCTX$+3,AUTO
          1 000150  304F                                 SOR,R3   15
          1 000151  D0B4                                 LDH,R5   ,B4,R3
          1 000152  BCC7 000E                            LDB,B3   SVMSG$,AUTO
          1 000154  D7C3 0004                            STH,R5   4,B3

     3375     6616    2           SVMSGCNT = SVMSG$->SV$MSG.SZ;

   6616   1 000156  ECC7 000E                            LDB,B6   SVMSG$,AUTO
          1 000158  E846 0003                            LDR,R6   3,B6
          1 00015A  EF47 0012                            STR,R6   SVMSGCNT,AUTO

     3376     6617    2           IF CTX$->GJA$HAND_CTX.WAITING_MSG$ = ADDR(NIL)

   6617   1 00015C  CCC7 0004                            LDB,B4   @CTX$,AUTO
          1 00015E  BC84                                 LDB,B3   ,B4
          1 00015F  8DC3 0007                            CMN      7,B3
          1 000161  0981 0005                            BNE      s:6620,PREL

     3377     6618    2           THEN CTX$->GJA$HAND_CTX.WAITING_MSG$ = SVMSG$;
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:606  

   6618   1 000163  EFC3 0007                            STB,B6   7,B3
          1 000165  0F81 001C                            B        s:6627,PREL

     3378     6619    3           ELSE DO;

     3379     6620    3                TMP$ = CTX$->GJA$HAND_CTX.WAITING_MSG$;

   6620   1 000167  ACC3 0007                            LDB,B2   7,B3
          1 000169  AFC7 0010                            STB,B2   TMP$,AUTO

     3380     6621    4                DO WHILE (TMP$->SV$MSG.LNK$ ~= ADDR(NIL));

   6621   1 00016B  0F81 000D                            B        s:6624,PREL

     3381     6622    4                     TMP$ = TMP$->SV$MSG.LNK$;

   6622   1 00016D  ECC7 0010                            LDB,B6   TMP$,AUTO
          1 00016F  DCC6 0001                            LDB,B5   1,B6
          1 000171  DFC7 0010                            STB,B5   TMP$,AUTO

     3382     6623    4                     SVMSGCNT = SVMSGCNT + TMP$->SV$MSG.SZ;

   6623   1 000173  E847 0012                            LDR,R6   SVMSGCNT,AUTO
          1 000175  EA45 0003                            ADD,R6   3,B5
          1 000177  EF47 0012                            STR,R6   SVMSGCNT,AUTO

     3383     6624    4                     END;

   6624   1 000179  ECC7 0010                            LDB,B6   TMP$,AUTO
          1 00017B  8DC6 0001                            CMN      1,B6
          1 00017D  09F0                                 BNE      s:6622,SPREL

     3384     6625    3                TMP$->SV$MSG.LNK$ = SVMSG$;

   6625   1 00017E  DCC7 000E                            LDB,B5   SVMSG$,AUTO
          1 000180  DFC6 0001                            STB,B5   1,B6
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:607  

     3385     6626    3                END;

     3386     6627    2           SVMSG$ = PINCRW(SVMSG$,SIZEW(SV$MSG));

   6627   1 000182  ECC7 000E                            LDB,B6   SVMSG$,AUTO
          1 000184  DBC6 0005                            LAB,B5   5,B6
          1 000186  DFC7 000E                            STB,B5   SVMSG$,AUTO

     3387     6628    2           SIZE = MSGSZ;

   6628   1 000188  ECC7 0008                            LDB,B6   @MSGSZ,AUTO
          1 00018A  D806                                 LDR,R5   ,B6
          1 00018B  DF47 000C                            STR,R5   SIZE,AUTO

     3388     6629    2           SVMSG$->STRING = MSG;

   6629   1 00018D  8CC7 0006                            LDI      @MSG,AUTO
          1 00018F  B856                                 LDR,R3   R6
          1 000190  E570 7FFF                            AND,R6   32767,IMO
          1 000192  8D47 0016                            SDI      TCTX$+3,AUTO
          1 000194  CCC7 0016                            LDB,B4   TCTX$+3,AUTO
          1 000196  304F                                 SOR,R3   15
          1 000197  C806                                 LDR,R4   ,B6
          1 000198  BF47 0018                            STR,R3   TCTX$+5,AUTO
          1 00019A  CF47 0019                            STR,R4   TCTX$+6,AUTO
          1 00019C  CFC7 001A                            STB,B4   TCTX$+7,AUTO
          1 00019E  AB84                                 LAB,B2   ,B4
          1 00019F  A853                                 LDR,R2   R3
          1 0001A0  E854                                 LDR,R6   R4
          1 0001A1  BB85                                 LAB,B3   ,B5
          1 0001A2  3C00                                 LDV,R3   0
          1 0001A3  F855                                 LDR,R7   R5
          1 0001A4  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

     3389     6630        /*
     3390     6631           If the path to the Host is blocked, flow control every handler.
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:608  
     3391     6632        */
     3392     6633    2           IF CTX$ = GJA_UID_NM$ AND SVMSGCNT >= 4096

   6633   1 0001A7  ECC7 0004                            LDB,B6   @CTX$,AUTO
          1 0001A9  DC86                                 LDB,B5   ,B6
          1 0001AA  DD80 0000 0000  xsym                 CMB,B5   GJA_UID_NM
          1 0001AD  0981 003D                            BNE      s:6649,PREL
          1 0001AF  E847 0012                            LDR,R6   SVMSGCNT,AUTO
          1 0001B1  E970 1000                            CMR,R6   4096,IMO
          1 0001B3  0201 0037                            BL       s:6649,PREL

     3393     6634    3           THEN DO;

     3394     6635    3                TCTX$ = GJA_HAND_HEAD$;

   6635   1 0001B5  CC80 0000 0000  xsym                 LDB,B4   GJA_HAND_HEAD$
          1 0001B8  CFC7 0013                            STB,B4   TCTX$,AUTO

     3395     6636    4                DO WHILE ( TCTX$ ~= ADDR(NIL) );

   6636   1 0001BA  0F81 002D                            B        s:6645,PREL

     3396     6637    4                     IF TCTX$->GJA$HAND_CTX.WHO = %GJA_UID_HANDLER AND

   6637   1 0001BC  ECC7 0013                            LDB,B6   TCTX$,AUTO
          1 0001BE  E806                                 LDR,R6   ,B6
          1 0001BF  604D                                 SOR,R6   13
          1 0001C0  6D03                                 CMV,R6   3
          1 0001C1  0981 0020                            BNE      s:6644,PREL
          1 0001C3  82C6 000D                            LB,'1000'X        13,B6
          1 0001C5       1000
          1 0001C6  0501 001B                            BBT      s:6644,PREL

     3397     6638    4                       NOT TCTX$->GJA$HAND_CTX.BLK
     3398     6639    4                     THEN
     3399     6640    5                     DO;

PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:609  
     3400     6641    5                          CALL GJA$Q_MSG (TCTX$,LENGTHC(VDO_RQSDAT),VDO_RQSDAT);

   6641   1 0001C8  DBF0 000A                            LAB,B5   10,IMO
          1 0001CA  CB80 0000 0003  00                   LAB,B4   VDO_RQSDAT
          1 0001CD  CFC7 001A                            STB,B4   TCTX$+7,AUTO
          1 0001CF  DFC7 0018                            STB,B5   TCTX$+5,AUTO
          1 0001D1  BBC7 0013                            LAB,B3   TCTX$,AUTO
          1 0001D3  BFC7 0016                            STB,B3   TCTX$+3,AUTO
          1 0001D5  BBC7 0016                            LAB,B3   TCTX$+3,AUTO
          1 0001D7  CBF0 0300                            LAB,B4   768,IMO
          1 0001D9  E380 0000 0000  xent                 LNJ,B6   GJA$Q_MSG
          1 0001DC       0001                            DC       s:6642,PREL

     3401     6642    5                          TCTX$->GJA$HAND_CTX.BLK = '1'B;

   6642   1 0001DD  ECC7 0013                            LDB,B6   TCTX$,AUTO
          1 0001DF  8946 000D                            LBT,'1000'X       13,B6
          1 0001E1       1000

     3402     6643    5                          END;

     3403     6644    4                     TCTX$ = TCTX$->GJA$HAND_CTX.LNK$;

   6644   1 0001E2  ECC7 0013                            LDB,B6   TCTX$,AUTO
          1 0001E4  DCC6 0001                            LDB,B5   1,B6
          1 0001E6  DFC7 0013                            STB,B5   TCTX$,AUTO

     3404     6645    4                     END;

   6645   1 0001E8  8DC7 0013                            CMN      TCTX$,AUTO
          1 0001EA  09D2                                 BNE      s:6637,SPREL

     3405     6646    3                END;

     3406     6647    2           END;

     3407     6648
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:610  
     3408     6649    1      RETURN;

   6649   1 0001EB  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
     3409     6650
     3410     6651    1   END GJA$SEND_MSG;

PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:611  
--  Include file information  --

   KNH_MACRO_C.:E05TOU  is referenced.
   GJA_MSG_M.:E05TOU  is referenced.
   KV$VDO.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   K_SCODE_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure GJA$SEND_MSG.
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:612  

 **** Variables and constants ****

  ****  Section 000  Data  GJA$SEND_MSG

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     8-0-0/w STRC(48)    r     1 NODEMEM                    0-0-0/w STRC(48)    r     1 VDO_BLKDAT
     3-0-0/w STRC(80)    r     1 VDO_RQSDAT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @CTX$                      6-0-0/w PTR         r     1 @MSG
     8-0-0/w PTR         r     1 @MSGSZ                     A-0-0/w PTR         r     1 @VFC
    *0-0-0/w PTR         r     1 CTX$                      *0-0-0/c ACHR        r     1 MSG
    *0-0-0/w UBIN(16)    r     1 MSGSZ                      C-0-0/w UBIN(16)    r     1 SIZE
     E-0-0/w PTR         r     1 SVMSG$                    12-0-0/w UBIN(16)    r     1 SVMSGCNT
    13-0-0/w PTR         r     1 TCTX$                     10-0-0/w PTR         r     1 TMP$
    *0-0-0/c CHAR        r     1 VFC                        D-0-0/w UBIN(16)    r     1 WHO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 GJA_HAND_HEAD$             0-0-0/w STRC(80)    r     1 GJA_LDDAT
     0-0-0/w UBIN(32)    r     1 GJA_UID_NM                 0-0-0/w PTR         r     1 GJA_UID_NM$
     0-0-0/w STRC(32)    r     1 GJA_VDO_DAT_DAT2

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:613  
     0-0-0/c STRC(272)   r     1 GJA$HAND_CTX               0-0-0/c ACHR        r     1 STRING
     0-0-0/w STRC(80)    r     1 SV$MSG


   Procedure GJA$SEND_MSG requires 494 words for executable code.
   Procedure GJA$SEND_MSG requires 34 words of local(AUTO) storage.

    No errors detected in file GJA$ADMIN.:E05TSI    .
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:614  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:615  
          MINI XREF LISTING

CTX$
      6413**DCL         6--PROC     6551>>ASSIGN   6552>>IF       6552>>IF       6560<>CALL     6565>>ASSIGN
      6565>>ASSIGN   6566>>ASSIGN   6566>>ASSIGN   6572>>IF       6574>>ASSIGN   6574>>ASSIGN   6575<>CALL
      6580>>IF       6585<>CALL     6588>>IF       6592<>CALL     6617>>IF       6618>>ASSIGN   6620>>ASSIGN
      6633>>IF
GJA$HAND_CTX.BLK
      6527**DCL      6588>>IF       6637>>IF       6642<<ASSIGN
GJA$HAND_CTX.HOST_NODE
      6526**DCL      6580>>IF
GJA$HAND_CTX.LNK$
      6506**DCL      6644>>ASSIGN
GJA$HAND_CTX.MAXNMBBYT
      6510**DCL      6565<<ASSIGN   6565>>ASSIGN
GJA$HAND_CTX.MAXNMBRCR
      6509**DCL      6552>>IF       6566<<ASSIGN   6566>>ASSIGN   6572>>IF       6574<<ASSIGN   6574>>ASSIGN
GJA$HAND_CTX.MAXRCRBYTSIZ
      6508**DCL      6552>>IF
GJA$HAND_CTX.WAITING_MSG$
      6518**DCL      6617>>IF       6618<<ASSIGN   6620>>ASSIGN
GJA$HAND_CTX.WHO
      6501**DCL      6551>>ASSIGN   6637>>IF
GJA$Q_MSG
      6547**DCL-ENT  6575--CALL     6585--CALL     6592--CALL     6641--CALL
GJA$WRITE
      6546**DCL-ENT  6560--CALL
GJA_HAND_HEAD$
      6432**DCL      6635>>ASSIGN
GJA_LDDAT
      6304**DCL      6575--CALL     6575<>CALL
GJA_UID_NM
      6430**DCL      6431--REDEF
GJA_UID_NM$
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:616  
      6431**DCL      6633>>IF
GJA_VDO_DAT_DAT2.DATCTRCHR
      6268**DCL      6558<<ASSIGN
GJA_VDO_DAT_DAT2.DATCTRCHRTYP
      6267**DCL      6557<<ASSIGN   6562<<ASSIGN
KVB$GET2NSYS
      6548**DCL-ENT  6600--CALL
M$SCREECH
      4248**DCL-ENT  6602--CALL
MSG
      6414**DCL         6--PROC     6560<>CALL     6629>>ASSIGN
MSGSZ
      6415**DCL         6--PROC     6414--IMP-SIZ  6552>>IF       6560<>CALL     6560>>CALL     6565>>ASSIGN
      6584>>ASSIGN   6591>>ASSIGN   6600>>CALL     6610>>ASSIGN   6628>>ASSIGN   6629>>ASSIGN
NODEMEM
      6460**DCL      6602<>CALL
SIZE
      6417**DCL      6418--IMP-SIZ  6628<<ASSIGN   6629>>ASSIGN
STRING
      6418**DCL      6629<<ASSIGN
SV$MSG
      6419**DCL      6600--CALL     6627--ASSIGN
SV$MSG.LNK$
      6421**DCL      6609<<ASSIGN   6621>>DOWHILE  6622>>ASSIGN   6625<<ASSIGN
SV$MSG.SZ
      6422**DCL      6610<<ASSIGN   6616>>ASSIGN   6623>>ASSIGN
SV$MSG.VFC
      6423**DCL      6613<<ASSIGN   6615<<ASSIGN
SVMSG$
      6426**DCL      6600<>CALL     6609>>ASSIGN   6610>>ASSIGN   6613>>ASSIGN   6615>>ASSIGN   6616>>ASSIGN
      6618>>ASSIGN   6625>>ASSIGN   6627<<ASSIGN   6627>>ASSIGN   6629>>ASSIGN
SVMSGCNT
      6428**DCL      6616<<ASSIGN   6623<<ASSIGN   6623>>ASSIGN   6633>>IF
TCTX$
      6429**DCL      6635<<ASSIGN   6636>>DOWHILE  6637>>IF       6637>>IF       6641<>CALL     6642>>ASSIGN
      6644<<ASSIGN   6644>>ASSIGN
PL6.E3A0      #004=GJA$SEND_MSG File=GJA$ADMIN.:E05TSI                           TUE 07/29/97 21:55 Page:617  
TMP$
      6427**DCL      6620<<ASSIGN   6621>>DOWHILE  6622<<ASSIGN   6622>>ASSIGN   6623>>ASSIGN   6625>>ASSIGN
VDO_BLKDAT
      6167**DCL      6585--CALL     6585<>CALL     6592--CALL     6592<>CALL
VDO_BLKDAT.RCRBYTSIZ
      6174**DCL      6584<<ASSIGN   6591<<ASSIGN
VDO_RQSDAT
      6211**DCL      6641--CALL     6641<>CALL
VFC
      6416**DCL         6--PROC     6555--IF       6558>>ASSIGN   6611--IF       6615>>ASSIGN
WHO
      6425**DCL      6551<<ASSIGN   6552>>IF       6552>>IF       6563>>IF       6563>>IF       6578>>DOCASE
