VERSION E05

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:1    
        1        1        /*M* THS$SET_DEVS - ROUTINE TO ESTABLISH DEVICE CRITERIA FOR ELAN */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        THS$SET_DEVS: PROC(CODE,TEXT,LEN) ALTRET;
        8        8        /**/
        9        9        /* PARAMS */
       10       10    1   DCL CODE UBIN;
       11       11    1   DCL TEXT CHAR(8);
       12       12    1   DCL LEN UBIN;
       13       13        /**/
       14       14        /* INCLUDE FILES */
       15       15        %INCLUDE CP_6;
       16       96        %INCLUDE KL_CONFIG_M;
       17      858        %INCLUDE F$DCB;
       18      907        %INCLUDE TH_SUBS_C;
       19     1289        %INCLUDE TH_DATA_R;
       20     1367        %INCLUDE TH_PERR_C;
       21     1408        /**/
       22     1409        /* DCB */
       23     1410    1   DCL M$NETCON DCB;
       24     1411        /* VARIABLES */
       25     1412    1   DCL I UBIN;
       26     1413    1   DCL J UBIN;
       27     1414    1   DCL K UBIN;
       28     1415    1   DCL NUM UBIN WORD;
       29     1416    1   DCL SAVE_ME CHAR(8);
       30     1417    1   DCL FEP# CHAR(3) UNAL;
       31     1418    1   DCL FEP#1(0:2) REDEF FEP# CHAR(1);
       32     1419    1   DCL FEP_NAME CHAR(8);
       33     1420    1   DCL CLASS$ PTR;
       34     1421    1   DCL MODEL$ PTR;
       35     1422    1   DCL 1 CLASS_TBL BASED(CLASS$),
       36     1423    1         2 NUMDEVS UBIN BYTE UNAL,
       37     1424    1         2 DEVNM(0:200) CHAR(8) UNAL;
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:2    
       38     1425    1   DCL FOUND BIT(1) STATIC INIT('0'B);
       39     1426        /**/
       40     1427        /* FPTs */
       41     1428        %FPT_OPEN(FPTN=OPEN_NETCON,
       42     1429                  STCLASS=CONSTANT,
       43     1430                  DCB=M$NETCON,
       44     1431                  ACCT=SYS_ACCT,
       45     1432                  NAME=NETCON,
       46     1433                  ASN=FILE,
       47     1434                  SHARE=ALL,
       48     1435                  FUN=IN,
       49     1436                  ORG=KEYED);
       50     1545        %FPT_READ(FPTN=READ_NETCON,
       51     1546                  STCLASS=STATIC,
       52     1547                  DCB=M$NETCON,
       53     1548                  KEYS=YES,
       54     1549                  KEY=KL$NETWORK_KEY,
       55     1550                  BUF=KL$NETWORK);
       56     1589        %FPT_CLOSE(FPTN=CLOSE_NETCON,
       57     1590                   STCLASS=CONSTANT,
       58     1591                   DCB=M$NETCON);
       59     1633        %VLP_ACCT(FPTN=SYS_ACCT,ACCT=':SYS',STCLASS=CONSTANT);
       60     1646        %VLP_NAME(FPTN=NETCON,NAME=':NETCON',STCLASS=CONSTANT);
       61     1673        /**/
       62     1674        /* ENTRY DEFS */
       63     1675    1   DCL THM$ERRMSG ENTRY(1);
       64     1676        /**/
       65     1677        /* SYMREF DECLARES FOR TABLES IN THI$INIT */
       66     1678        %MACRO TBL (NAME=JUNK,
       67     1679                   NUM=JUNK,
       68     1680                   COUNT=JUNK,
       69     1681                  STCLASS="SYMREF");
       70     1682        DCL 1 NAME STCLASS,
       71     1683              2 NUM UBIN BYTE UNAL,
       72     1684               2 DEVNM(0:COUNT) CHAR(8) UNAL;
       73     1685        %MEND;
       74     1686        %TBL (NAME=MC_TBL,NUM=NUMIOMS,COUNT=%MC_MAX);
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:3    
       75     1691        %TBL (NAME=IOM_TBL,NUM=NUMIOMS,COUNT=%IOM_MAX);
       76     1696        %TBL (NAME=UC_TBL,NUM=NUMUCS,COUNT=%UCS_MAX);
       77     1701        %TBL (NAME=TC_TBL,NUM=NUMTCS,COUNT=%TCS_MAX);
       78     1706        %TBL (NAME=DC_TBL,NUM=NUMDCS,COUNT=%DCS_MAX);
       79     1711        %TBL (NAME=AC_TBL,NUM=NUMACS,COUNT=%ACS_MAX);
       80     1716        %TBL (NAME=OPC_TBL,NUM=NUMOPCS,COUNT=%OPC_MAX);
       81     1721        %TBL (NAME=FEP_TBL,NUM=NUMFEPS,COUNT=%FEP_MAX);
       82     1726        %TBL (NAME=AP_TBL,NUM=NUMAPS,COUNT=%APS_MAX);
       83     1731        %TBL (NAME=OD_TBL,NUM=NUMODS,COUNT=%ODS_MAX);
       84     1736        %TBL (NAME=LP_TBL,NUM=NUMLPS,COUNT=%LPS_MAX);
       85     1741        %TBL (NAME=CR_TBL,NUM=NUMCRS,COUNT=%CRS_MAX);
       86     1746        %TBL (NAME=CP_TBL,NUM=NUMCPS,COUNT=%CPS_MAX);
       87     1751        %TBL (NAME=DP_TBL,NUM=NUMDPS,COUNT=%DPS_MAX);
       88     1756        %TBL (NAME=MT_TBL,NUM=NUMMTS,COUNT=%MTS_MAX);
       89     1761        %TBL (NAME=XX_TBL,NUM=NUMXXS,COUNT=%XXS_MAX);
       90     1766        /**/
       91     1767    1   DCL 1 CLASS_TABLE(0:%NCLASSM1) SYMREF,
       92     1768    1         2 TXT CHAR(8),
       93     1769    1         2 PTR$ PTR;
       94     1770        %MACRO MODEL (NAME=JUNK,STCLASS="SYMREF");
       95     1771        DCL 1 NAME STCLASS,
       96     1772              2 MOD# CHAR(8) UNAL,
       97     1773              2 NUMDEVS UBIN BYTE UNAL,
       98     1774              2 DEVNM(0:200) CHAR(8) UNAL;
       99     1775        %MEND;
      100     1776        %MODEL (NAME=MDL_TBL0);
      101     1782        %MODEL (NAME=MDL_TBL1);
      102     1788        %MODEL (NAME=MDL_TBL2);
      103     1794        %MODEL (NAME=MDL_TBL3);
      104     1800        %MODEL (NAME=MDL_TBL4);
      105     1806        %MODEL (NAME=MDL_TBL5);
      106     1812        %MODEL (NAME=MDL_TBL6);
      107     1818        %MODEL (NAME=MDL_TBL7);
      108     1824        %MODEL (NAME=MDL_TBL8);
      109     1830        %MODEL (NAME=MDL_TBL9);
      110     1836        %MODEL (NAME=MDL_TBL10);
      111     1842        %MODEL (NAME=MDL_TBL21);
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:4    
      112     1848        %MODEL (NAME=MDL_TBL22);
      113     1854        %MODEL (NAME=MDL_TBL23);
      114     1860        %MODEL (NAME=MDL_TBL24);
      115     1866        %MODEL (NAME=MDL_TBL25);
      116     1872        %MODEL (NAME=MDL_TBL26);
      117     1878        %MODEL (NAME=MDL_TBL27);
      118     1884        %MODEL (NAME=MDL_TBL28);
      119     1890        %MODEL (NAME=MDL_TBL29);
      120     1896        %MODEL (NAME=MDL_TBL30);
      121     1902
      122     1903        %EQU NUM_MODELS = 30;
      123     1904    1   DCL MODEL_PTR$(0:%NUM_MODELS) PTR SYMREF;
      124     1905    1   DCL 1 MDL_TBL BASED(MODEL$),
      125     1906    1         2 MOD# CHAR(8) UNAL,
      126     1907    1         2 NUMDEVS UBIN BYTE UNAL,
      127     1908    1         2 DEVNM(0:200) CHAR(8) UNAL;
      128     1909        /**/
      129     1910        %KL$NETWORK(NUM=255,STCLASS=STATIC);
      130     1937        %KL$NETWORK_KEY(STCLASS=STATIC);
      131     1954        /**/
      132     1955        %EJECT;
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:5    
      133     1956    1        FOUND = %FALSE;
      134     1957    2        DO CASE(CODE);
      135     1958    2           CASE(%ALL);
      136     1959    2              NUM = TH_NUM_REP_DEVS;
      137     1960    3              DO I = 0 TO %NCLASSM1;
      138     1961    3                 CLASS$ = CLASS_TABLE.PTR$(I);
      139     1962    4                 DO J = 0 TO CLASS_TBL.NUMDEVS - 1;
      140     1963    4                    TH_REP_DEVS(NUM + J) = CLASS_TBL.DEVNM(J);
      141     1964    4                 END;                      /* DO J                               */
      142     1965    3                 NUM = NUM + CLASS_TBL.NUMDEVS;
      143     1966    3              END;                         /* DO I                               */
      144     1967    2              TH_NUM_REP_DEVS = NUM + 1;
      145     1968    2              TH_REP_DEVS(TH_NUM_REP_DEVS - 1) = 'MEM';
      146     1969    2           CASE(%MC,%MT,%XX,%DP,%CR,%CP,%LP,%UC,%DC,%TC,%FEP,%IOM,%SC,%MPC1,
      147     1970    2                %AP,%OD,%AC,%OPC);
      148     1971    2              IF LEN = 0
      149     1972    2                 THEN                      /* CLASS                              */
      150     1973    3                 DO;
      151     1974    4                    DO I = 0 TO %NCLASSM1;
      152     1975    4                       IF CLASS_TABLE.TXT(I) = TEXT
      153     1976    4                          THEN             /* CLASS FOUND                        */
      154     1977    5                          DO;
      155     1978    6                             IF CODE = %FEP THEN DO;
      156     1979    6                                CALL M$OPEN(OPEN_NETCON);
      157     1980    6                                CALL M$READ(READ_NETCON);
      158     1981    6                               IF KL$NETWORK.NODE# > 0 THEN
      159     1982    7                               DO J = 0 TO KL$NETWORK.NODE#;
      160     1983    7                                 IF (KL$NETWORK.NODE.TYPE(J) = %KL_NODETYPE_ME)
      161     1984    8                                 THEN DO;
      162     1985    8                                      SAVE_ME = KL$NETWORK.NODE.NODE(J);
      163     1986    8                                      GOTO FOUND_ME;
      164     1987    8                                 END;  /* if then */
      165     1988    7                               END; /* do i */
      166     1989    7   FOUND_ME:               DO J = 0 TO KL$NETWORK.NODE#;
      167     1990    7                            IF((KL$NETWORK.NODE.TYPE(J) = %KL_NODETYPE_FEP) AND
      168     1991    7                              (KL$NETWORK.NODE.CONTROL_NODE(J) = SAVE_ME))
      169     1992    8                            THEN DO;
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:6    
      170     1993    8                              FEP# = ' ';
      171     1994    8                              CALL BINCHAR(FEP#,J);
      172     1995    8                              IF(FEP#1(0) = '0' AND FEP#1(1) = '0')
      173     1996    8                              THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(2));
      174     1997    8                              ELSE IF(FEP#1(0) = '0')
      175     1998    8                              THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(1),FEP#1(2));
      176     1999    8                              ELSE CALL CONCAT(FEP_NAME,'FEP',FEP#);
      177     2000    9                                DO K = 0 TO TH_NUM_DEVS;
      178     2001    9                                 IF TH_SYS_DEVS.DEVN(K) = FEP_NAME
      179     2002   10                                 THEN DO;
      180     2003   10                                   TH_REP_DEVS(TH_NUM_REP_DEVS) = FEP_NAME;
      181     2004   10                                   TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + 1;
      182     2005   10                                   GOTO MATCH_FOUND;
      183     2006   10                                 END;
      184     2007    9                                END;
      185     2008    9        DO NEVER;
      186     2009    9   MATCH_FOUND: FOUND = %TRUE;
      187     2010    9        END; /* do never */
      188     2011    8                            END; /* if fep and a part of ME node */
      189     2012    7                           END; /* do j */
      190     2013    6                         CALL M$CLOSE(CLOSE_NETCON);
      191     2014    6                             END; /* if fep is selected */
      192     2015    6                         ELSE DO;  /* if not fep selected */
      193     2016    6                             FOUND = %TRUE;
      194     2017    6                             CLASS$ = CLASS_TABLE.PTR$(I);
      195     2018    6                             K = 0;
      196     2019    7                             DO J = TH_NUM_REP_DEVS TO TH_NUM_REP_DEVS + CLASS_TBL.
              2019                                      NUMDEVS - 1;
      197     2020    7                                TH_REP_DEVS(J) = CLASS_TBL.DEVNM(K);
      198     2021    7                                K = K + 1;
      199     2022    7                                END;          /* DO J                               */
      200     2023    6                             TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + CLASS_TBL.NUMDEVS;
      201     2024    6                         END; /*  if not fep selected */
      202     2025    5                          END;             /* IF                                 */
      203     2026    4                    END;                   /* DO I                               */
      204     2027    3                    IF NOT FOUND
      205     2028    3                       THEN                /* BAD CLASS DESIGNATOR INPUT         */
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:7    
      206     2029    4                       DO;
      207     2030    4                          CALL THM$ERRMSG(%E$TH_NO_SUCH_CLASS);
      208     2031    4                          ALTRETURN;
      209     2032    4                       END;                /* IF NOT FOUND                       */
      210     2033                         /*E* ERROR: THE-E$TH_NO_SUCH_CLASS-0
      211     2034                              MESSAGE: Bad class designator in FOR clause.
      212     2035                              MESSAGE1: The class designator input does not exist in
      213     2036                                        the current system configuration.
      214     2037                         */
      215     2038    3                 END;                      /* IF LEN = 0                         */
      216     2039    2                 ELSE                      /* DEVICE                             */
      217     2040    3                 DO;
      218     2041    3                    IF CODE = %IOM OR CODE = %FEP
      219     2042    3                       THEN CALL INSERT(TEXT,LEN,,'        ');
      220     2043    3                       ELSE CALL INSERT(TEXT,LEN,,'00000000');
      221     2044    4                    DO I = 0 TO TH_NUM_DEVS;
      222     2045    4                       IF TH_SYS_DEVS.DEVN(I) = TEXT
      223     2046    4                          THEN             /* DEVICE FOUND                       */
      224     2047    5                          DO;
      225     2048    5                             FOUND = %TRUE;
      226     2049    5                             TH_REP_DEVS(TH_NUM_REP_DEVS) = TEXT;
      227     2050    5                             TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + 1;
      228     2051    5                          END;             /* IF                                 */
      229     2052    4                    END;                   /* DO I                               */
      230     2053    3                    IF NOT FOUND
      231     2054    3                       THEN                /* BAD DEVICE NAME                    */
      232     2055    4                       DO;
      233     2056    4                          CALL THM$ERRMSG(%E$TH_NO_SUCH_DEVICE);
      234     2057    4                          ALTRETURN;
      235     2058    4                       END;                /* IF NOT FOUND                       */
      236     2059                         /*E* ERROR: THE-E$TH_NO_SUCH_DEVICE-0
      237     2060                              MESSAGE: Bad device name in FOR clause.
      238     2061                              MESSAGE1: The device number input does not exist in the
      239     2062                                        current system configuration.
      240     2063                          */
      241     2064    3                 END;                      /* DEVICE                             */
      242     2065    2           CASE(%MTU,%MSU,%CRU,%PCU,%PRU,%CONSOLE,%XXU);
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:8    
      243     2066    2              NUM = 0;
      244     2067    3              DO I = 0 TO TH_NUM_MODS - 1;
      245     2068    3                 MODEL$ = MODEL_PTR$(I);
      246     2069    3                 IF MDL_TBL.MOD# = TEXT
      247     2070    3                    THEN                   /* MODEL# FOUND                       */
      248     2071    4                    DO;
      249     2072    4                       FOUND = %TRUE;
      250     2073    4                       K = 0;
      251     2074    5                       DO J = TH_NUM_REP_DEVS TO TH_NUM_REP_DEVS + MDL_TBL.NUMDEVS - 1;
      252     2075    5                          TH_REP_DEVS(J) = MDL_TBL.DEVNM(K);
      253     2076    5                          K = K + 1;
      254     2077    5                          END;                /* DO J                               */
      255     2078    4                       TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + MDL_TBL.NUMDEVS;
      256     2079    4                    END;                   /* IF                                 */
      257     2080    3              END;                         /* DO I                               */
      258     2081    2              IF NOT FOUND
      259     2082    2                 THEN                      /* BAD MODEL# INPUT                   */
      260     2083    3                 DO;
      261     2084    3                    CALL THM$ERRMSG(%E$TH_NO_SUCH_MOD#);
      262     2085    3                    ALTRETURN;
      263     2086    3                 END;                      /* IF NOT FOUND                       */
      264     2087                   /*E* ERROR: THE-E$TH_NO_SUCH_MOD#-0
      265     2088                        MESSAGE: Bad model number in FOR clause.
      266     2089                        MESSAGE1: The model number input does not exist in the
      267     2090                                  current system configuration.
      268     2091                   */
      269     2092    2           CASE(%MEM);
      270     2093    2              TH_REP_DEVS(TH_NUM_REP_DEVS) = 'MEM';
      271     2094    2              TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + 1;
      272     2095    2        END;                               /* CASE(CODE)                         */
      273     2096    1   END THS$SET_DEVS;

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:9    
--  Include file information  --

   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THS$SET_DEVS.

   Procedure THS$SET_DEVS requires 416 words for executable code.
   Procedure THS$SET_DEVS requires 20 words of local(AUTO) storage.

    No errors detected in file THS$SET_DEVS.:E05TSI    .

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:10   

 Object Unit name= THS$SET_DEVS                               File name= THS$SET_DEVS.:E05TOU
 UTS= JUL 30 '97 06:16:55.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$NETCON
    2   Data  even  none  1298   2422  THS$SET_DEVS
    3  RoData even  UTS     98    142  THS$SET_DEVS
    4   Proc  even  none   416    640  THS$SET_DEVS
    5  RoData even  none     9     11  THS$SET_DEVS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        3  THS$SET_DEVS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 THM$ERRMSG
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  TH_NUM_REP_DEVS                       TH_REP_DEVS
     TH_SYS_DEVS                           TH_NUM_MODS                           TH_NUM_DEVS
     TH_XSA_BUF_VECTOR                     M$NETCON                              CLASS_TABLE
     MODEL_PTR$                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:12   


        1        1        /*M* THS$SET_DEVS - ROUTINE TO ESTABLISH DEVICE CRITERIA FOR ELAN */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        THS$SET_DEVS: PROC(CODE,TEXT,LEN) ALTRET;

      7  4 000000   000000 700200 xent  THS$SET_DEVS TSX0  ! X66_AUTO_3
         4 000001   000024 000003                    ZERO    20,3

        8        8        /**/
        9        9        /* PARAMS */
       10       10    1   DCL CODE UBIN;
       11       11    1   DCL TEXT CHAR(8);
       12       12    1   DCL LEN UBIN;
       13       13        /**/
       14       14        /* INCLUDE FILES */
       15       15        %INCLUDE CP_6;
       16       96        %INCLUDE KL_CONFIG_M;
       17      858        %INCLUDE F$DCB;
       18      907        %INCLUDE TH_SUBS_C;
       19     1289        %INCLUDE TH_DATA_R;
       20     1367        %INCLUDE TH_PERR_C;
       21     1408        /**/
       22     1409        /* DCB */
       23     1410    1   DCL M$NETCON DCB;
       24     1411        /* VARIABLES */
       25     1412    1   DCL I UBIN;
       26     1413    1   DCL J UBIN;
       27     1414    1   DCL K UBIN;
       28     1415    1   DCL NUM UBIN WORD;
       29     1416    1   DCL SAVE_ME CHAR(8);
       30     1417    1   DCL FEP# CHAR(3) UNAL;
       31     1418    1   DCL FEP#1(0:2) REDEF FEP# CHAR(1);
       32     1419    1   DCL FEP_NAME CHAR(8);
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:13   
       33     1420    1   DCL CLASS$ PTR;
       34     1421    1   DCL MODEL$ PTR;
       35     1422    1   DCL 1 CLASS_TBL BASED(CLASS$),
       36     1423    1         2 NUMDEVS UBIN BYTE UNAL,
       37     1424    1         2 DEVNM(0:200) CHAR(8) UNAL;
       38     1425    1   DCL FOUND BIT(1) STATIC INIT('0'B);
       39     1426        /**/
       40     1427        /* FPTs */
       41     1428        %FPT_OPEN(FPTN=OPEN_NETCON,
       42     1429                  STCLASS=CONSTANT,
       43     1430                  DCB=M$NETCON,
       44     1431                  ACCT=SYS_ACCT,
       45     1432                  NAME=NETCON,
       46     1433                  ASN=FILE,
       47     1434                  SHARE=ALL,
       48     1435                  FUN=IN,
       49     1436                  ORG=KEYED);
       50     1545        %FPT_READ(FPTN=READ_NETCON,
       51     1546                  STCLASS=STATIC,
       52     1547                  DCB=M$NETCON,
       53     1548                  KEYS=YES,
       54     1549                  KEY=KL$NETWORK_KEY,
       55     1550                  BUF=KL$NETWORK);
       56     1589        %FPT_CLOSE(FPTN=CLOSE_NETCON,
       57     1590                   STCLASS=CONSTANT,
       58     1591                   DCB=M$NETCON);
       59     1633        %VLP_ACCT(FPTN=SYS_ACCT,ACCT=':SYS',STCLASS=CONSTANT);
       60     1646        %VLP_NAME(FPTN=NETCON,NAME=':NETCON',STCLASS=CONSTANT);
       61     1673        /**/
       62     1674        /* ENTRY DEFS */
       63     1675    1   DCL THM$ERRMSG ENTRY(1);
       64     1676        /**/
       65     1677        /* SYMREF DECLARES FOR TABLES IN THI$INIT */
       66     1678        %MACRO TBL (NAME=JUNK,
       67     1679                   NUM=JUNK,
       68     1680                   COUNT=JUNK,
       69     1681                  STCLASS="SYMREF");
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:14   
       70     1682        DCL 1 NAME STCLASS,
       71     1683              2 NUM UBIN BYTE UNAL,
       72     1684               2 DEVNM(0:COUNT) CHAR(8) UNAL;
       73     1685        %MEND;
       74     1686        %TBL (NAME=MC_TBL,NUM=NUMIOMS,COUNT=%MC_MAX);
       75     1691        %TBL (NAME=IOM_TBL,NUM=NUMIOMS,COUNT=%IOM_MAX);
       76     1696        %TBL (NAME=UC_TBL,NUM=NUMUCS,COUNT=%UCS_MAX);
       77     1701        %TBL (NAME=TC_TBL,NUM=NUMTCS,COUNT=%TCS_MAX);
       78     1706        %TBL (NAME=DC_TBL,NUM=NUMDCS,COUNT=%DCS_MAX);
       79     1711        %TBL (NAME=AC_TBL,NUM=NUMACS,COUNT=%ACS_MAX);
       80     1716        %TBL (NAME=OPC_TBL,NUM=NUMOPCS,COUNT=%OPC_MAX);
       81     1721        %TBL (NAME=FEP_TBL,NUM=NUMFEPS,COUNT=%FEP_MAX);
       82     1726        %TBL (NAME=AP_TBL,NUM=NUMAPS,COUNT=%APS_MAX);
       83     1731        %TBL (NAME=OD_TBL,NUM=NUMODS,COUNT=%ODS_MAX);
       84     1736        %TBL (NAME=LP_TBL,NUM=NUMLPS,COUNT=%LPS_MAX);
       85     1741        %TBL (NAME=CR_TBL,NUM=NUMCRS,COUNT=%CRS_MAX);
       86     1746        %TBL (NAME=CP_TBL,NUM=NUMCPS,COUNT=%CPS_MAX);
       87     1751        %TBL (NAME=DP_TBL,NUM=NUMDPS,COUNT=%DPS_MAX);
       88     1756        %TBL (NAME=MT_TBL,NUM=NUMMTS,COUNT=%MTS_MAX);
       89     1761        %TBL (NAME=XX_TBL,NUM=NUMXXS,COUNT=%XXS_MAX);
       90     1766        /**/
       91     1767    1   DCL 1 CLASS_TABLE(0:%NCLASSM1) SYMREF,
       92     1768    1         2 TXT CHAR(8),
       93     1769    1         2 PTR$ PTR;
       94     1770        %MACRO MODEL (NAME=JUNK,STCLASS="SYMREF");
       95     1771        DCL 1 NAME STCLASS,
       96     1772              2 MOD# CHAR(8) UNAL,
       97     1773              2 NUMDEVS UBIN BYTE UNAL,
       98     1774              2 DEVNM(0:200) CHAR(8) UNAL;
       99     1775        %MEND;
      100     1776        %MODEL (NAME=MDL_TBL0);
      101     1782        %MODEL (NAME=MDL_TBL1);
      102     1788        %MODEL (NAME=MDL_TBL2);
      103     1794        %MODEL (NAME=MDL_TBL3);
      104     1800        %MODEL (NAME=MDL_TBL4);
      105     1806        %MODEL (NAME=MDL_TBL5);
      106     1812        %MODEL (NAME=MDL_TBL6);
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:15   
      107     1818        %MODEL (NAME=MDL_TBL7);
      108     1824        %MODEL (NAME=MDL_TBL8);
      109     1830        %MODEL (NAME=MDL_TBL9);
      110     1836        %MODEL (NAME=MDL_TBL10);
      111     1842        %MODEL (NAME=MDL_TBL21);
      112     1848        %MODEL (NAME=MDL_TBL22);
      113     1854        %MODEL (NAME=MDL_TBL23);
      114     1860        %MODEL (NAME=MDL_TBL24);
      115     1866        %MODEL (NAME=MDL_TBL25);
      116     1872        %MODEL (NAME=MDL_TBL26);
      117     1878        %MODEL (NAME=MDL_TBL27);
      118     1884        %MODEL (NAME=MDL_TBL28);
      119     1890        %MODEL (NAME=MDL_TBL29);
      120     1896        %MODEL (NAME=MDL_TBL30);
      121     1902
      122     1903        %EQU NUM_MODELS = 30;
      123     1904    1   DCL MODEL_PTR$(0:%NUM_MODELS) PTR SYMREF;
      124     1905    1   DCL 1 MDL_TBL BASED(MODEL$),
      125     1906    1         2 MOD# CHAR(8) UNAL,
      126     1907    1         2 NUMDEVS UBIN BYTE UNAL,
      127     1908    1         2 DEVNM(0:200) CHAR(8) UNAL;
      128     1909        /**/
      129     1910        %KL$NETWORK(NUM=255,STCLASS=STATIC);
      130     1937        %KL$NETWORK_KEY(STCLASS=STATIC);
      131     1954        /**/
      132     1955        %EJECT;
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:16   
      133     1956    1        FOUND = %FALSE;

   1956  4 000002   000000 450000 2                  STZ     FOUND

      134     1957    2        DO CASE(CODE);

   1957  4 000003   200003 470500                    LDP0    @CODE,,AUTO
         4 000004   000000 235100                    LDA     0,,PR0
         4 000005   000043 115007                    CMPA    35,DL
         4 000006   000010 602005 4                  TNC     s:1957+5,AL
         4 000007   000637 710000 4                  TRA     s:2096
         4 000010   000637 710000 4                  TRA     s:2096
         4 000011   000626 710000 4                  TRA     s:2093
         4 000012   000135 710000 4                  TRA     s:1971
         4 000013   000135 710000 4                  TRA     s:1971
         4 000014   000135 710000 4                  TRA     s:1971
         4 000015   000135 710000 4                  TRA     s:1971
         4 000016   000135 710000 4                  TRA     s:1971
         4 000017   000135 710000 4                  TRA     s:1971
         4 000020   000135 710000 4                  TRA     s:1971
         4 000021   000135 710000 4                  TRA     s:1971
         4 000022   000135 710000 4                  TRA     s:1971
         4 000023   000135 710000 4                  TRA     s:1971
         4 000024   000135 710000 4                  TRA     s:1971
         4 000025   000135 710000 4                  TRA     s:1971
         4 000026   000053 710000 4                  TRA     s:1959
         4 000027   000532 710000 4                  TRA     s:2066
         4 000030   000532 710000 4                  TRA     s:2066
         4 000031   000532 710000 4                  TRA     s:2066
         4 000032   000532 710000 4                  TRA     s:2066
         4 000033   000532 710000 4                  TRA     s:2066
         4 000034   000135 710000 4                  TRA     s:1971
         4 000035   000532 710000 4                  TRA     s:2066
         4 000036   000532 710000 4                  TRA     s:2066
         4 000037   000637 710000 4                  TRA     s:2096
         4 000040   000637 710000 4                  TRA     s:2096
         4 000041   000637 710000 4                  TRA     s:2096
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:17   
         4 000042   000637 710000 4                  TRA     s:2096
         4 000043   000637 710000 4                  TRA     s:2096
         4 000044   000637 710000 4                  TRA     s:2096
         4 000045   000637 710000 4                  TRA     s:2096
         4 000046   000135 710000 4                  TRA     s:1971
         4 000047   000135 710000 4                  TRA     s:1971
         4 000050   000135 710000 4                  TRA     s:1971
         4 000051   000135 710000 4                  TRA     s:1971
         4 000052   000135 710000 4                  TRA     s:1971

      135     1958    2           CASE(%ALL);

      136     1959    2              NUM = TH_NUM_REP_DEVS;

   1959  4 000053   000000 236000 xsym               LDQ     TH_NUM_REP_DEVS
         4 000054   200011 756100                    STQ     NUM,,AUTO

      137     1960    3              DO I = 0 TO %NCLASSM1;

   1960  4 000055   200006 450100                    STZ     I,,AUTO

      138     1961    3                 CLASS$ = CLASS_TABLE.PTR$(I);

   1961  4 000056   200006 236100                    LDQ     I,,AUTO
         4 000057   000003 402007                    MPY     3,DL
         4 000060   000002 236006 xsym               LDQ     CLASS_TABLE+2,QL
         4 000061   200017 756100                    STQ     CLASS$,,AUTO

      139     1962    4                 DO J = 0 TO CLASS_TBL.NUMDEVS - 1;

   1962  4 000062   200007 450100                    STZ     J,,AUTO
         4 000063   000101 710000 4                  TRA     s:1964+3

      140     1963    4                    TH_REP_DEVS(NUM + J) = CLASS_TBL.DEVNM(J);

   1963  4 000064   200011 236100                    LDQ     NUM,,AUTO
         4 000065   200007 036100                    ADLQ    J,,AUTO
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:18   
         4 000066   000001 736000                    QLS     1
         4 000067   200007 235100                    LDA     J,,AUTO
         4 000070   000003 735000                    ALS     3
         4 000071   000002 736000                    QLS     2
         4 000072   200017 470500                    LDP0    CLASS$,,AUTO
         4 000073   040006 100505                    MLR     fill='040'O
         4 000074   000000 200010                    ADSC9   0,A,PR0                  cn=1,n=8
         4 000075   000000 000010 xsym               ADSC9   TH_REP_DEVS,Q            cn=0,n=8

      141     1964    4                 END;                      /* DO J                               */

   1964  4 000076   200007 236100                    LDQ     J,,AUTO
         4 000077   000001 036007                    ADLQ    1,DL
         4 000100   200007 756100                    STQ     J,,AUTO
         4 000101   200017 470500                    LDP0    CLASS$,,AUTO
         4 000102   000100 101500                    MRL     fill='000'O
         4 000103   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000104   200022 000004                    ADSC9   MODEL$+2,,AUTO           cn=0,n=4
         4 000105   200022 236100                    LDQ     MODEL$+2,,AUTO
         4 000106   200007 116100                    CMPQ    J,,AUTO
         4 000107   000111 600000 4                  TZE     s:1965
         4 000110   000064 603000 4                  TRC     s:1963

      142     1965    3                 NUM = NUM + CLASS_TBL.NUMDEVS;

   1965  4 000111   000100 101500                    MRL     fill='000'O
         4 000112   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000113   200022 000004                    ADSC9   MODEL$+2,,AUTO           cn=0,n=4
         4 000114   200022 236100                    LDQ     MODEL$+2,,AUTO
         4 000115   200011 036100                    ADLQ    NUM,,AUTO
         4 000116   200011 756100                    STQ     NUM,,AUTO

      143     1966    3              END;                         /* DO I                               */

   1966  4 000117   200006 235100                    LDA     I,,AUTO
         4 000120   000001 035007                    ADLA    1,DL
         4 000121   200006 755100                    STA     I,,AUTO
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:19   
         4 000122   000022 115007                    CMPA    18,DL
         4 000123   000056 602000 4                  TNC     s:1961

      144     1967    2              TH_NUM_REP_DEVS = NUM + 1;

   1967  4 000124   000001 036007                    ADLQ    1,DL
         4 000125   000000 756000 xsym               STQ     TH_NUM_REP_DEVS

      145     1968    2              TH_REP_DEVS(TH_NUM_REP_DEVS - 1) = 'MEM';

   1968  4 000126   000000 235000 xsym               LDA     TH_NUM_REP_DEVS
         4 000127   000001 735000                    ALS     1
         4 000130   000002 735000                    ALS     2
         4 000131   040005 100400                    MLR     fill='040'O
         4 000132   000134 000003 3                  ADSC9   NETCON+2                 cn=0,n=3
         4 000133   777776 000010 xsym               ADSC9   TH_REP_DEVS-2,A          cn=0,n=8
         4 000134   000637 710000 4                  TRA     s:2096

      146     1969    2           CASE(%MC,%MT,%XX,%DP,%CR,%CP,%LP,%UC,%DC,%TC,%FEP,%IOM,%SC,%MPC1,

      147     1970    2                %AP,%OD,%AC,%OPC);
      148     1971    2              IF LEN = 0

   1971  4 000135   200005 471500                    LDP1    @LEN,,AUTO
         4 000136   100000 235100                    LDA     0,,PR1
         4 000137   000435 601000 4                  TNZ     s:2041

      149     1972    2                 THEN                      /* CLASS                              */
      150     1973    3                 DO;

      151     1974    4                    DO I = 0 TO %NCLASSM1;

   1974  4 000140   200006 450100                    STZ     I,,AUTO

      152     1975    4                       IF CLASS_TABLE.TXT(I) = TEXT

   1975  4 000141   200006 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:20   
         4 000142   000014 402007                    MPY     12,DL
         4 000143   200004 470500                    LDP0    @TEXT,,AUTO
         4 000144   040100 106406                    CMPC    fill='040'O
         4 000145   000000 000010 xsym               ADSC9   CLASS_TABLE,Q            cn=0,n=8
         4 000146   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000147   000421 601000 4                  TNZ     s:2026

      153     1976    4                          THEN             /* CLASS FOUND                        */
      154     1977    5                          DO;

      155     1978    6                             IF CODE = %FEP THEN DO;

   1978  4 000150   200003 471500                    LDP1    @CODE,,AUTO
         4 000151   100000 235100                    LDA     0,,PR1
         4 000152   000003 115007                    CMPA    3,DL
         4 000153   000351 601000 4                  TNZ     s:2016

      156     1979    6                                CALL M$OPEN(OPEN_NETCON);

   1979  4 000154   000000 630400 3                  EPPR0   OPEN_NETCON
         4 000155   050000 713400                    CLIMB   open
         4 000156   410400 401760                    pmme    nvectors=18

      157     1980    6                                CALL M$READ(READ_NETCON);

   1980  4 000157   000002 630400 2                  EPPR0   READ_NETCON
         4 000160   040000 713400                    CLIMB   read
         4 000161   401400 401760                    pmme    nvectors=4

      158     1981    6                               IF KL$NETWORK.NODE# > 0 THEN

   1981  4 000162   000020 235000 2                  LDA     KL$NETWORK
         4 000163   000207 600000 4                  TZE     FOUND_ME

      159     1982    7                               DO J = 0 TO KL$NETWORK.NODE#;

   1982  4 000164   200007 450100                    STZ     J,,AUTO
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:21   
         4 000165   000204 710000 4                  TRA     s:1988+3

      160     1983    7                                 IF (KL$NETWORK.NODE.TYPE(J) = %KL_NODETYPE_ME)

   1983  4 000166   200007 236100                    LDQ     J,,AUTO
         4 000167   000005 402007                    MPY     5,DL
         4 000170   000021 235006 2                  LDA     KL$NETWORK+1,QL
         4 000171   000003 115007                    CMPA    3,DL
         4 000172   000201 601000 4                  TNZ     s:1988

      161     1984    8                                 THEN DO;

      162     1985    8                                      SAVE_ME = KL$NETWORK.NODE.NODE(J);

   1985  4 000173   200007 236100                    LDQ     J,,AUTO
         4 000174   000024 402007                    MPY     20,DL
         4 000175   040100 100406                    MLR     fill='040'O
         4 000176   000022 000010 2                  ADSC9   KL$NETWORK+2,Q           cn=0,n=8
         4 000177   200012 000010                    ADSC9   SAVE_ME,,AUTO            cn=0,n=8

      163     1986    8                                      GOTO FOUND_ME;

   1986  4 000200   000207 710000 4                  TRA     FOUND_ME

      164     1987    8                                 END;  /* if then */
      165     1988    7                               END; /* do i */

   1988  4 000201   200007 235100                    LDA     J,,AUTO
         4 000202   000001 035007                    ADLA    1,DL
         4 000203   200007 755100                    STA     J,,AUTO
         4 000204   000020 236000 2                  LDQ     KL$NETWORK
         4 000205   200007 116100                    CMPQ    J,,AUTO
         4 000206   000166 603000 4                  TRC     s:1983

      166     1989    7   FOUND_ME:               DO J = 0 TO KL$NETWORK.NODE#;

   1989  4 000207   200007 450100       FOUND_ME     STZ     J,,AUTO
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:22   
         4 000210   000342 710000 4                  TRA     s:2012+3

      167     1990    7                            IF((KL$NETWORK.NODE.TYPE(J) = %KL_NODETYPE_FEP) AND

   1990  4 000211   200007 236100                    LDQ     J,,AUTO
         4 000212   000005 402007                    MPY     5,DL
         4 000213   000021 235006 2                  LDA     KL$NETWORK+1,QL
         4 000214   000002 115007                    CMPA    2,DL
         4 000215   000337 601000 4                  TNZ     s:2012
         4 000216   200007 236100                    LDQ     J,,AUTO
         4 000217   000024 402007                    MPY     20,DL
         4 000220   040100 106406                    CMPC    fill='040'O
         4 000221   000024 000010 2                  ADSC9   KL$NETWORK+4,Q           cn=0,n=8
         4 000222   200012 000010                    ADSC9   SAVE_ME,,AUTO            cn=0,n=8
         4 000223   000337 601000 4                  TNZ     s:2012

      168     1991    7                              (KL$NETWORK.NODE.CONTROL_NODE(J) = SAVE_ME))
      169     1992    8                            THEN DO;

      170     1993    8                              FEP# = ' ';

   1993  4 000224   000000 236000 5                  LDQ     0
         4 000225   200014 552170                    STBQ    FEP#,'70'O,AUTO

      171     1994    8                              CALL BINCHAR(FEP#,J);

   1994  4 000226   200007 235100                    LDA     J,,AUTO
         4 000227   000044 773000                    LRL     36
         4 000230   200022 757100                    STAQ    MODEL$+2,,AUTO
         4 000231   000100 301500                    BTD
         4 000232   200022 000010                    NDSC9   MODEL$+2,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         4 000233   200014 030003                    NDSC9   FEP#,,AUTO               cn=0,s=nosgn,sf=0,n=3

      172     1995    8                              IF(FEP#1(0) = '0' AND FEP#1(1) = '0')

   1995  4 000234   200014 236100                    LDQ     FEP#,,AUTO
         4 000235   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:23   
         4 000236   060000 116003                    CMPQ    24576,DU
         4 000237   000254 601000 4                  TNZ     s:1997
         4 000240   200014 236100                    LDQ     FEP#,,AUTO
         4 000241   000777 376003                    ANQ     511,DU
         4 000242   000060 116003                    CMPQ    48,DU
         4 000243   000254 601000 4                  TNZ     s:1997

      173     1996    8                              THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(2));

   1996  4 000244   000135 236000 3                  LDQ     NETCON+3
         4 000245   000001 376000 5                  ANQ     1
         4 000246   000040 276007                    ORQ     32,DL
         4 000247   200015 756100                    STQ     FEP_NAME,,AUTO
         4 000250   040100 100500                    MLR     fill='040'O
         4 000251   200014 400001                    ADSC9   FEP#,,AUTO               cn=2,n=1
         4 000252   200015 600005                    ADSC9   FEP_NAME,,AUTO           cn=3,n=5
         4 000253   000304 710000 4                  TRA     s:2000

      174     1997    8                              ELSE IF(FEP#1(0) = '0')

   1997  4 000254   200014 236100                    LDQ     FEP#,,AUTO
         4 000255   777000 376003                    ANQ     -512,DU
         4 000256   060000 116003                    CMPQ    24576,DU
         4 000257   000275 601000 4                  TNZ     s:1999

      175     1998    8                              THEN CALL CONCAT(FEP_NAME,'FEP',FEP#1(1),FEP#1(2));

   1998  4 000260   000135 236000 3                  LDQ     NETCON+3
         4 000261   000001 376000 5                  ANQ     1
         4 000262   000040 276007                    ORQ     32,DL
         4 000263   200015 756100                    STQ     FEP_NAME,,AUTO
         4 000264   200014 236100                    LDQ     FEP#,,AUTO
         4 000265   000022 772000                    QRL     18
         4 000266   200015 552104                    STBQ    FEP_NAME,'04'O,AUTO
         4 000267   200014 236100                    LDQ     FEP#,,AUTO
         4 000270   000022 736000                    QLS     18
         4 000271   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:24   
         4 000272   000002 276000 5                  ORQ     2
         4 000273   200016 756100                    STQ     FEP_NAME+1,,AUTO
         4 000274   000304 710000 4                  TRA     s:2000

      176     1999    8                              ELSE CALL CONCAT(FEP_NAME,'FEP',FEP#);

   1999  4 000275   000135 236000 3                  LDQ     NETCON+3
         4 000276   000001 376000 5                  ANQ     1
         4 000277   000040 276007                    ORQ     32,DL
         4 000300   200015 756100                    STQ     FEP_NAME,,AUTO
         4 000301   040100 100500                    MLR     fill='040'O
         4 000302   200014 000003                    ADSC9   FEP#,,AUTO               cn=0,n=3
         4 000303   200015 600005                    ADSC9   FEP_NAME,,AUTO           cn=3,n=5

      177     2000    9                                DO K = 0 TO TH_NUM_DEVS;

   2000  4 000304   200010 450100                    STZ     K,,AUTO
         4 000305   000331 710000 4                  TRA     s:2007+3

      178     2001    9                                 IF TH_SYS_DEVS.DEVN(K) = FEP_NAME

   2001  4 000306   200010 235100                    LDA     K,,AUTO
         4 000307   000004 735000                    ALS     4
         4 000310   040100 106405                    CMPC    fill='040'O
         4 000311   000000 000010 xsym               ADSC9   TH_SYS_DEVS,A            cn=0,n=8
         4 000312   200015 000010                    ADSC9   FEP_NAME,,AUTO           cn=0,n=8
         4 000313   000326 601000 4                  TNZ     s:2007

      179     2002   10                                 THEN DO;

      180     2003   10                                   TH_REP_DEVS(TH_NUM_REP_DEVS) = FEP_NAME;

   2003  4 000314   000000 236000 xsym               LDQ     TH_NUM_REP_DEVS
         4 000315   000001 736000                    QLS     1
         4 000316   000002 736000                    QLS     2
         4 000317   040006 100500                    MLR     fill='040'O
         4 000320   200015 000010                    ADSC9   FEP_NAME,,AUTO           cn=0,n=8
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:25   
         4 000321   000000 000010 xsym               ADSC9   TH_REP_DEVS,Q            cn=0,n=8

      181     2004   10                                   TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + 1;

   2004  4 000322   000000 236000 xsym               LDQ     TH_NUM_REP_DEVS
         4 000323   000001 036007                    ADLQ    1,DL
         4 000324   000000 756000 xsym               STQ     TH_NUM_REP_DEVS

      182     2005   10                                   GOTO MATCH_FOUND;

   2005  4 000325   000335 710000 4                  TRA     MATCH_FOUND

      183     2006   10                                 END;
      184     2007    9                                END;

   2007  4 000326   200010 236100                    LDQ     K,,AUTO
         4 000327   000001 036007                    ADLQ    1,DL
         4 000330   200010 756100                    STQ     K,,AUTO
         4 000331   000000 236000 xsym               LDQ     TH_NUM_DEVS
         4 000332   200010 116100                    CMPQ    K,,AUTO
         4 000333   000306 603000 4                  TRC     s:2001

      185     2008    9        DO NEVER;

   2008  4 000334   000337 710000 4                  TRA     s:2012

      186     2009    9   MATCH_FOUND: FOUND = %TRUE;

   2009  4 000335   400000 236003       MATCH_FOUND  LDQ     -131072,DU
         4 000336   000000 756000 2                  STQ     FOUND

      187     2010    9        END; /* do never */

      188     2011    8                            END; /* if fep and a part of ME node */

      189     2012    7                           END; /* do j */

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:26   
   2012  4 000337   200007 235100                    LDA     J,,AUTO
         4 000340   000001 035007                    ADLA    1,DL
         4 000341   200007 755100                    STA     J,,AUTO
         4 000342   000020 236000 2                  LDQ     KL$NETWORK
         4 000343   200007 116100                    CMPQ    J,,AUTO
         4 000344   000211 603000 4                  TRC     s:1990

      190     2013    6                         CALL M$CLOSE(CLOSE_NETCON);

   2013  4 000345   000072 630400 3                  EPPR0   CLOSE_NETCON
         4 000346   050001 713400                    CLIMB   close
         4 000347   406000 401760                    pmme    nvectors=13

      191     2014    6                             END; /* if fep is selected */

   2014  4 000350   000421 710000 4                  TRA     s:2026

      192     2015    6                         ELSE DO;  /* if not fep selected */

      193     2016    6                             FOUND = %TRUE;

   2016  4 000351   400000 236003                    LDQ     -131072,DU
         4 000352   000000 756000 2                  STQ     FOUND

      194     2017    6                             CLASS$ = CLASS_TABLE.PTR$(I);

   2017  4 000353   200006 236100                    LDQ     I,,AUTO
         4 000354   000003 402007                    MPY     3,DL
         4 000355   000002 236006 xsym               LDQ     CLASS_TABLE+2,QL
         4 000356   200017 756100                    STQ     CLASS$,,AUTO

      195     2018    6                             K = 0;

   2018  4 000357   200010 450100                    STZ     K,,AUTO

      196     2019    7                             DO J = TH_NUM_REP_DEVS TO TH_NUM_REP_DEVS + CLASS_TBL.
              2019                                      NUMDEVS - 1;
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:27   

   2019  4 000360   000000 235000 xsym               LDA     TH_NUM_REP_DEVS
         4 000361   200007 755100                    STA     J,,AUTO
         4 000362   000402 710000 4                  TRA     s:2022+3

      197     2020    7                                TH_REP_DEVS(J) = CLASS_TBL.DEVNM(K);

   2020  4 000363   200007 235100                    LDA     J,,AUTO
         4 000364   000001 735000                    ALS     1
         4 000365   200010 236100                    LDQ     K,,AUTO
         4 000366   000003 736000                    QLS     3
         4 000367   000002 735000                    ALS     2
         4 000370   200017 470500                    LDP0    CLASS$,,AUTO
         4 000371   040005 100506                    MLR     fill='040'O
         4 000372   000000 200010                    ADSC9   0,Q,PR0                  cn=1,n=8
         4 000373   000000 000010 xsym               ADSC9   TH_REP_DEVS,A            cn=0,n=8

      198     2021    7                                K = K + 1;

   2021  4 000374   200010 235100                    LDA     K,,AUTO
         4 000375   000001 035007                    ADLA    1,DL
         4 000376   200010 755100                    STA     K,,AUTO

      199     2022    7                                END;          /* DO J                               */

   2022  4 000377   200007 236100                    LDQ     J,,AUTO
         4 000400   000001 036007                    ADLQ    1,DL
         4 000401   200007 756100                    STQ     J,,AUTO
         4 000402   200017 470500                    LDP0    CLASS$,,AUTO
         4 000403   000100 101500                    MRL     fill='000'O
         4 000404   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000405   200022 000004                    ADSC9   MODEL$+2,,AUTO           cn=0,n=4
         4 000406   200022 236100                    LDQ     MODEL$+2,,AUTO
         4 000407   000000 036000 xsym               ADLQ    TH_NUM_REP_DEVS
         4 000410   200007 116100                    CMPQ    J,,AUTO
         4 000411   000413 600000 4                  TZE     s:2023
         4 000412   000363 603000 4                  TRC     s:2020
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:28   

      200     2023    6                             TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + CLASS_TBL.NUMDEVS;

   2023  4 000413   000100 101500                    MRL     fill='000'O
         4 000414   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         4 000415   200022 000004                    ADSC9   MODEL$+2,,AUTO           cn=0,n=4
         4 000416   200022 236100                    LDQ     MODEL$+2,,AUTO
         4 000417   000000 036000 xsym               ADLQ    TH_NUM_REP_DEVS
         4 000420   000000 756000 xsym               STQ     TH_NUM_REP_DEVS

      201     2024    6                         END; /*  if not fep selected */

      202     2025    5                          END;             /* IF                                 */

      203     2026    4                    END;                   /* DO I                               */

   2026  4 000421   200006 235100                    LDA     I,,AUTO
         4 000422   000001 035007                    ADLA    1,DL
         4 000423   200006 755100                    STA     I,,AUTO
         4 000424   000022 115007                    CMPA    18,DL
         4 000425   000141 602000 4                  TNC     s:1975

      204     2027    3                    IF NOT FOUND

   2027  4 000426   000000 234000 2                  SZN     FOUND
         4 000427   000637 604000 4                  TMI     s:2096

      205     2028    3                       THEN                /* BAD CLASS DESIGNATOR INPUT         */
      206     2029    4                       DO;

      207     2030    4                          CALL THM$ERRMSG(%E$TH_NO_SUCH_CLASS);

   2030  4 000430   000004 630400 5                  EPPR0   4
         4 000431   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000432   000000 701000 xent               TSX1    THM$ERRMSG
         4 000433   000000 011000                    NOP     0

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:29   
      208     2031    4                          ALTRETURN;

   2031  4 000434   000000 702200 xent               TSX2  ! X66_AALT

      209     2032    4                       END;                /* IF NOT FOUND                       */
      210     2033                         /*E* ERROR: THE-E$TH_NO_SUCH_CLASS-0
      211     2034                              MESSAGE: Bad class designator in FOR clause.
      212     2035                              MESSAGE1: The class designator input does not exist in
      213     2036                                        the current system configuration.
      214     2037                         */
      215     2038    3                 END;                      /* IF LEN = 0                         */
      216     2039    2                 ELSE                      /* DEVICE                             */
      217     2040    3                 DO;

      218     2041    3                    IF CODE = %IOM OR CODE = %FEP

   2041  4 000435   000000 235100                    LDA     0,,PR0
         4 000436   000002 115007                    CMPA    2,DL
         4 000437   000442 600000 4                  TZE     s:2042
         4 000440   000003 115007                    CMPA    3,DL
         4 000441   000456 601000 4                  TNZ     s:2043

      219     2042    3                       THEN CALL INSERT(TEXT,LEN,,'        ');

   2042  4 000442   100000 235100                    LDA     0,,PR1
         4 000443   200022 755100                    STA     MODEL$+2,,AUTO
         4 000444   100000 235100                    LDA     0,,PR1
         4 000445   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000446   000011 035007                    ADLA    9,DL
         4 000447   200004 473500                    LDP3    @TEXT,,AUTO
         4 000450   000000 620005                    EAX0    0,AL
         4 000451   200022 235100                    LDA     MODEL$+2,,AUTO
         4 000452   040145 100400                    MLR     fill='040'O
         4 000453   000136 000010 3                  ADSC9   NETCON+4                 cn=0,n=8
         4 000454   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0
         4 000455   000471 710000 4                  TRA     s:2044

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:30   
      220     2043    3                       ELSE CALL INSERT(TEXT,LEN,,'00000000');

   2043  4 000456   100000 235100                    LDA     0,,PR1
         4 000457   200022 755100                    STA     MODEL$+2,,AUTO
         4 000460   100000 235100                    LDA     0,,PR1
         4 000461   000027 675000 xsym               ERA     B_VECTNIL+23
         4 000462   000011 035007                    ADLA    9,DL
         4 000463   200004 473500                    LDP3    @TEXT,,AUTO
         4 000464   000000 620005                    EAX0    0,AL
         4 000465   200022 235100                    LDA     MODEL$+2,,AUTO
         4 000466   040145 100400                    MLR     fill='040'O
         4 000467   000140 000010 3                  ADSC9   NETCON+6                 cn=0,n=8
         4 000470   300000 000010                    ADSC9   0,A,PR3                  cn=0,n=*X0

      221     2044    4                    DO I = 0 TO TH_NUM_DEVS;

   2044  4 000471   200006 450100                    STZ     I,,AUTO
         4 000472   000520 710000 4                  TRA     s:2052+3

      222     2045    4                       IF TH_SYS_DEVS.DEVN(I) = TEXT

   2045  4 000473   200006 235100                    LDA     I,,AUTO
         4 000474   000004 735000                    ALS     4
         4 000475   200004 470500                    LDP0    @TEXT,,AUTO
         4 000476   040100 106405                    CMPC    fill='040'O
         4 000477   000000 000010 xsym               ADSC9   TH_SYS_DEVS,A            cn=0,n=8
         4 000500   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000501   000515 601000 4                  TNZ     s:2052

      223     2046    4                          THEN             /* DEVICE FOUND                       */
      224     2047    5                          DO;

      225     2048    5                             FOUND = %TRUE;

   2048  4 000502   400000 236003                    LDQ     -131072,DU
         4 000503   000000 756000 2                  STQ     FOUND

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:31   
      226     2049    5                             TH_REP_DEVS(TH_NUM_REP_DEVS) = TEXT;

   2049  4 000504   000000 235000 xsym               LDA     TH_NUM_REP_DEVS
         4 000505   000001 735000                    ALS     1
         4 000506   000002 735000                    ALS     2
         4 000507   040005 100500                    MLR     fill='040'O
         4 000510   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000511   000000 000010 xsym               ADSC9   TH_REP_DEVS,A            cn=0,n=8

      227     2050    5                             TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + 1;

   2050  4 000512   000000 235000 xsym               LDA     TH_NUM_REP_DEVS
         4 000513   000001 035007                    ADLA    1,DL
         4 000514   000000 755000 xsym               STA     TH_NUM_REP_DEVS

      228     2051    5                          END;             /* IF                                 */

      229     2052    4                    END;                   /* DO I                               */

   2052  4 000515   200006 235100                    LDA     I,,AUTO
         4 000516   000001 035007                    ADLA    1,DL
         4 000517   200006 755100                    STA     I,,AUTO
         4 000520   000000 236000 xsym               LDQ     TH_NUM_DEVS
         4 000521   200006 116100                    CMPQ    I,,AUTO
         4 000522   000473 603000 4                  TRC     s:2045

      230     2053    3                    IF NOT FOUND

   2053  4 000523   000000 234000 2                  SZN     FOUND
         4 000524   000637 604000 4                  TMI     s:2096

      231     2054    3                       THEN                /* BAD DEVICE NAME                    */
      232     2055    4                       DO;

      233     2056    4                          CALL THM$ERRMSG(%E$TH_NO_SUCH_DEVICE);

   2056  4 000525   000006 630400 5                  EPPR0   6
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:32   
         4 000526   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000527   000000 701000 xent               TSX1    THM$ERRMSG
         4 000530   000000 011000                    NOP     0

      234     2057    4                          ALTRETURN;

   2057  4 000531   000000 702200 xent               TSX2  ! X66_AALT

      235     2058    4                       END;                /* IF NOT FOUND                       */
      236     2059                         /*E* ERROR: THE-E$TH_NO_SUCH_DEVICE-0
      237     2060                              MESSAGE: Bad device name in FOR clause.
      238     2061                              MESSAGE1: The device number input does not exist in the
      239     2062                                        current system configuration.
      240     2063                          */
      241     2064    3                 END;                      /* DEVICE                             */
      242     2065    2           CASE(%MTU,%MSU,%CRU,%PCU,%PRU,%CONSOLE,%XXU);

      243     2066    2              NUM = 0;

   2066  4 000532   200011 450100                    STZ     NUM,,AUTO

      244     2067    3              DO I = 0 TO TH_NUM_MODS - 1;

   2067  4 000533   200006 450100                    STZ     I,,AUTO
         4 000534   000614 710000 4                  TRA     s:2080+3

      245     2068    3                 MODEL$ = MODEL_PTR$(I);

   2068  4 000535   200006 720100                    LXL0    I,,AUTO
         4 000536   000000 236010 xsym               LDQ     MODEL_PTR$,X0
         4 000537   200020 756100                    STQ     MODEL$,,AUTO

      246     2069    3                 IF MDL_TBL.MOD# = TEXT

   2069  4 000540   200020 470500                    LDP0    MODEL$,,AUTO
         4 000541   200004 471500                    LDP1    @TEXT,,AUTO
         4 000542   040100 106500                    CMPC    fill='040'O
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:33   
         4 000543   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         4 000544   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         4 000545   000611 601000 4                  TNZ     s:2080

      247     2070    3                    THEN                   /* MODEL# FOUND                       */
      248     2071    4                    DO;

      249     2072    4                       FOUND = %TRUE;

   2072  4 000546   400000 236003                    LDQ     -131072,DU
         4 000547   000000 756000 2                  STQ     FOUND

      250     2073    4                       K = 0;

   2073  4 000550   200010 450100                    STZ     K,,AUTO

      251     2074    5                      DO J = TH_NUM_REP_DEVS TO TH_NUM_REP_DEVS + MDL_TBL.NUMDEVS - 1;

   2074  4 000551   000000 235000 xsym               LDA     TH_NUM_REP_DEVS
         4 000552   200007 755100                    STA     J,,AUTO
         4 000553   000573 710000 4                  TRA     s:2077+3

      252     2075    5                          TH_REP_DEVS(J) = MDL_TBL.DEVNM(K);

   2075  4 000554   200007 235100                    LDA     J,,AUTO
         4 000555   000001 735000                    ALS     1
         4 000556   200010 236100                    LDQ     K,,AUTO
         4 000557   000003 736000                    QLS     3
         4 000560   000002 735000                    ALS     2
         4 000561   200020 470500                    LDP0    MODEL$,,AUTO
         4 000562   040005 100506                    MLR     fill='040'O
         4 000563   000002 200010                    ADSC9   2,Q,PR0                  cn=1,n=8
         4 000564   000000 000010 xsym               ADSC9   TH_REP_DEVS,A            cn=0,n=8

      253     2076    5                          K = K + 1;

   2076  4 000565   200010 235100                    LDA     K,,AUTO
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:34   
         4 000566   000001 035007                    ADLA    1,DL
         4 000567   200010 755100                    STA     K,,AUTO

      254     2077    5                          END;                /* DO J                               */

   2077  4 000570   200007 236100                    LDQ     J,,AUTO
         4 000571   000001 036007                    ADLQ    1,DL
         4 000572   200007 756100                    STQ     J,,AUTO
         4 000573   000100 101500                    MRL     fill='000'O
         4 000574   000002 000001                    ADSC9   2,,PR0                   cn=0,n=1
         4 000575   200022 000004                    ADSC9   MODEL$+2,,AUTO           cn=0,n=4
         4 000576   200022 236100                    LDQ     MODEL$+2,,AUTO
         4 000577   000000 036000 xsym               ADLQ    TH_NUM_REP_DEVS
         4 000600   200007 116100                    CMPQ    J,,AUTO
         4 000601   000603 600000 4                  TZE     s:2078
         4 000602   000554 603000 4                  TRC     s:2075

      255     2078    4                       TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + MDL_TBL.NUMDEVS;

   2078  4 000603   000100 101500                    MRL     fill='000'O
         4 000604   000002 000001                    ADSC9   2,,PR0                   cn=0,n=1
         4 000605   200022 000004                    ADSC9   MODEL$+2,,AUTO           cn=0,n=4
         4 000606   200022 236100                    LDQ     MODEL$+2,,AUTO
         4 000607   000000 036000 xsym               ADLQ    TH_NUM_REP_DEVS
         4 000610   000000 756000 xsym               STQ     TH_NUM_REP_DEVS

      256     2079    4                    END;                   /* IF                                 */

      257     2080    3              END;                         /* DO I                               */

   2080  4 000611   200006 235100                    LDA     I,,AUTO
         4 000612   000001 035007                    ADLA    1,DL
         4 000613   200006 755100                    STA     I,,AUTO
         4 000614   200006 236100                    LDQ     I,,AUTO
         4 000615   000000 116000 xsym               CMPQ    TH_NUM_MODS
         4 000616   000535 602000 4                  TNC     s:2068

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:35   
      258     2081    2              IF NOT FOUND

   2081  4 000617   000000 234000 2                  SZN     FOUND
         4 000620   000637 604000 4                  TMI     s:2096

      259     2082    2                 THEN                      /* BAD MODEL# INPUT                   */
      260     2083    3                 DO;

      261     2084    3                    CALL THM$ERRMSG(%E$TH_NO_SUCH_MOD#);

   2084  4 000621   000010 630400 5                  EPPR0   8
         4 000622   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000623   000000 701000 xent               TSX1    THM$ERRMSG
         4 000624   000000 011000                    NOP     0

      262     2085    3                    ALTRETURN;

   2085  4 000625   000000 702200 xent               TSX2  ! X66_AALT

      263     2086    3                 END;                      /* IF NOT FOUND                       */
      264     2087                   /*E* ERROR: THE-E$TH_NO_SUCH_MOD#-0
      265     2088                        MESSAGE: Bad model number in FOR clause.
      266     2089                        MESSAGE1: The model number input does not exist in the
      267     2090                                  current system configuration.
      268     2091                   */
      269     2092    2           CASE(%MEM);

      270     2093    2              TH_REP_DEVS(TH_NUM_REP_DEVS) = 'MEM';

   2093  4 000626   000000 236000 xsym               LDQ     TH_NUM_REP_DEVS
         4 000627   000001 736000                    QLS     1
         4 000630   000002 736000                    QLS     2
         4 000631   040006 100400                    MLR     fill='040'O
         4 000632   000134 000003 3                  ADSC9   NETCON+2                 cn=0,n=3
         4 000633   000000 000010 xsym               ADSC9   TH_REP_DEVS,Q            cn=0,n=8

      271     2094    2              TH_NUM_REP_DEVS = TH_NUM_REP_DEVS + 1;
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:36   

   2094  4 000634   000000 235000 xsym               LDA     TH_NUM_REP_DEVS
         4 000635   000001 035007                    ADLA    1,DL
         4 000636   000000 755000 xsym               STA     TH_NUM_REP_DEVS

      272     2095    2        END;                               /* CASE(CODE)                         */

      273     2096    1   END THS$SET_DEVS;

   2096  4 000637   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:37   
--  Include file information  --

   TH_PERR_C.:E05TOU  is referenced.
   TH_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   TH_SUBS_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure THS$SET_DEVS.
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:38   

 **** Variables and constants ****

  ****  Section 002  Data  THS$SET_DEVS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 FOUND                     20-0-0/w STRC(46116) r     1 KL$NETWORK
  2421-0-0/w STRC(18)    r     1 KL$NETWORK_KEY             2-0-0/d STRC(504)   r     1 READ_NETCON

  ****  Section 003 RoData THS$SET_DEVS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/d STRC(1080)  r     1 CLOSE_NETCON             132-0-0/c STRC(72)    r     1 NETCON
     0-0-0/d STRC(2088)  r     1 OPEN_NETCON              130-0-0/c STRC(72)    r     1 SYS_ACCT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CODE                      5-0-0/w PTR         r     1 @LEN
     4-0-0/w PTR         r     1 @TEXT                     17-0-0/w PTR         r     1 CLASS$
    *0-0-0/w UBIN        r     1 CODE                      14-0-0/c CHAR(3)     r     1 FEP#
    14-0-0/c CHAR        r     1 FEP#1(0:2)                15-0-0/c CHAR(8)     r     1 FEP_NAME
     6-0-0/w UBIN        r     1 I                          7-0-0/w UBIN        r     1 J
    10-0-0/w UBIN        r     1 K                         *0-0-0/w UBIN        r     1 LEN
    20-0-0/w PTR         r     1 MODEL$                    11-0-0/w UBIN        r     1 NUM
    12-0-0/c CHAR(8)     r     1 SAVE_ME                   *0-0-0/c CHAR(8)     r     1 TEXT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:39   
     0-0-0/w STRC(108)   r     1 CLASS_TABLE(0:17)
     0-0-0/w PTR         r     1 MODEL_PTR$(0:30)
     0-0-0/w UBIN        r     1 TH_NUM_DEVS                0-0-0/w UBIN        r     1 TH_NUM_MODS
     0-0-0/w UBIN        r     1 TH_NUM_REP_DEVS
     0-0-0/w CHAR(8)     r     1 TH_REP_DEVS(0:511)
     0-0-0/w STRC(144)   r     1 TH_SYS_DEVS(0:511)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(14481) r     1 CLASS_TBL                  0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$NETCON                   0-0-0/c STRC(14553) r     1 MDL_TBL


   Procedure THS$SET_DEVS requires 416 words for executable code.
   Procedure THS$SET_DEVS requires 20 words of local(AUTO) storage.

    No errors detected in file THS$SET_DEVS.:E05TSI    .
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:41   
          MINI XREF LISTING

CLASS$
      1420**DCL      1422--IMP-PTR  1961<<ASSIGN   1962>>DOINDEX  1963>>ASSIGN   1965>>ASSIGN   2017<<ASSIGN
      2019>>DOINDEX  2020>>ASSIGN   2023>>ASSIGN
CLASS_TABLE.PTR$
      1769**DCL      1961>>ASSIGN   2017>>ASSIGN
CLASS_TABLE.TXT
      1768**DCL      1975>>IF
CLASS_TBL.DEVNM
      1424**DCL      1963>>ASSIGN   2020>>ASSIGN
CLASS_TBL.NUMDEVS
      1423**DCL      1962>>DOINDEX  1965>>ASSIGN   2019>>DOINDEX  2023>>ASSIGN
CLOSE_NETCON
      1614**DCL      2013<>CALL
CLOSE_NETCON.SN_
      1614**DCL      1614--REDEF
CLOSE_NETCON.UTL_
      1615**DCL      1615--REDEF
CLOSE_NETCON.V
      1619**DCL      1614--DCLINIT
CLOSE_NETCON.V.EXPIRE#
      1629**DCL      1629--REDEF
CLOSE_NETCON.V.TYPE#
      1627**DCL      1627--REDEF
CLOSE_NETCON.V.XTNSIZE#
      1624**DCL      1624--REDEF    1626--REDEF
CODE
        10**DCL         7--PROC     1957>>DOCASE   1978>>IF       2041>>IF       2041>>IF
F$DCB.ACTPOS
       884**DCL       884--REDEF
F$DCB.ARS
       859**DCL       859--REDEF
F$DCB.ATTR
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:42   
       877**DCL       878--REDEF
F$DCB.BORROW
       892**DCL       892--REDEF     892--REDEF     892--REDEF
F$DCB.DCBNAME.L
       906**DCL       906--IMP-SIZ
F$DCB.EOMCHAR
       863**DCL       863--REDEF
F$DCB.FLDID
       887**DCL       887--REDEF
F$DCB.FORM$
       881**DCL       881--REDEF
F$DCB.FSECT
       897**DCL       897--REDEF
F$DCB.FSN
       874**DCL       874--REDEF     874--REDEF     875--REDEF
F$DCB.HEADER$
       880**DCL       880--REDEF
F$DCB.IXTNSIZE
       878**DCL       878--REDEF
F$DCB.LASTSTA$
       868**DCL       868--REDEF
F$DCB.LVL
       893**DCL       893--REDEF
F$DCB.NAME.C
       868**DCL       868--REDEF
F$DCB.NOEOF
       889**DCL       889--REDEF
F$DCB.NRECS
       879**DCL       879--REDEF
F$DCB.NRECX
       898**DCL       898--REDEF
F$DCB.OHDR
       890**DCL       890--REDEF
F$DCB.ORG
       873**DCL       873--REDEF
F$DCB.PRECNO
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:43   
       896**DCL       896--REDEF
F$DCB.RCSZ
       901**DCL       901--REDEF
F$DCB.RES
       869**DCL       869--REDEF
F$DCB.SETX
       881**DCL       881--REDEF
F$DCB.TAB$
       880**DCL       881--REDEF
F$DCB.TDA
       895**DCL       895--REDEF
F$DCB.WSN
       870**DCL       870--REDEF
FEP#
      1417**DCL      1418--REDEF    1993<<ASSIGN   1994<<CALLBLT  1999>>CALLBLT
FEP#1
      1418**DCL      1995>>IF       1995>>IF       1996>>CALLBLT  1997>>IF       1998>>CALLBLT  1998>>CALLBLT
FEP_NAME
      1419**DCL      1996<<CALLBLT  1998<<CALLBLT  1999<<CALLBLT  2001>>IF       2003>>ASSIGN
FOUND
      1425**DCL      1956<<ASSIGN   2009<<ASSIGN   2016<<ASSIGN   2027>>IF       2048<<ASSIGN   2053>>IF
      2072<<ASSIGN   2081>>IF
FOUND_ME
      1989**LABEL    1986--GOTO
I
      1412**DCL      1960<<DOINDEX  1961>>ASSIGN   1974<<DOINDEX  1975>>IF       2017>>ASSIGN   2044<<DOINDEX
      2045>>IF       2067<<DOINDEX  2068>>ASSIGN
J
      1413**DCL      1962<<DOINDEX  1963>>ASSIGN   1963>>ASSIGN   1982<<DOINDEX  1983>>IF       1985>>ASSIGN
      1989<<DOINDEX  1990>>IF       1990>>IF       1994>>CALLBLT  2019<<DOINDEX  2020>>ASSIGN   2074<<DOINDEX
      2075>>ASSIGN
K
      1414**DCL      2000<<DOINDEX  2001>>IF       2018<<ASSIGN   2020>>ASSIGN   2021<<ASSIGN   2021>>ASSIGN
      2073<<ASSIGN   2075>>ASSIGN   2076<<ASSIGN   2076>>ASSIGN
KL$NETWORK
      1923**DCL      1569--DCLINIT  1570--DCLINIT
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:44   
KL$NETWORK.NODE.CONTROL_NODE
      1933**DCL      1990>>IF
KL$NETWORK.NODE.NODE
      1932**DCL      1985>>ASSIGN
KL$NETWORK.NODE.TYPE
      1929**DCL      1983>>IF       1990>>IF
KL$NETWORK.NODE#
      1924**DCL      1981>>IF       1982>>DOINDEX  1989>>DOINDEX
KL$NETWORK_KEY
      1950**DCL      1567--DCLINIT  1568--DCLINIT
LEN
        12**DCL         7--PROC     1971>>IF       2042>>CALLBLT  2043>>CALLBLT
M$CLOSE
        24**DCL-ENT  2013--CALL
M$OPEN
        24**DCL-ENT  1979--CALL
M$READ
        25**DCL-ENT  1980--CALL
MATCH_FOUND
      2009**LABEL    2005--GOTO
MDL_TBL.DEVNM
      1908**DCL      2075>>ASSIGN
MDL_TBL.MOD#
      1906**DCL      2069>>IF
MDL_TBL.NUMDEVS
      1907**DCL      2074>>DOINDEX  2078>>ASSIGN
MODEL$
      1421**DCL      1905--IMP-PTR  2068<<ASSIGN   2069>>IF       2074>>DOINDEX  2075>>ASSIGN   2078>>ASSIGN
MODEL_PTR$
      1904**DCL      2068>>ASSIGN
NETCON
      1671**DCL      1502--DCLINIT
NUM
      1415**DCL      1959<<ASSIGN   1963>>ASSIGN   1965<<ASSIGN   1965>>ASSIGN   1967>>ASSIGN   2066<<ASSIGN
OPEN_NETCON
      1501**DCL      1979<>CALL
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:45   
OPEN_NETCON.ACSVEH_
      1503**DCL      1504--REDEF
OPEN_NETCON.ALTKEYS_
      1509**DCL      1510--REDEF    1510--REDEF
OPEN_NETCON.HDR_
      1508**DCL      1509--REDEF
OPEN_NETCON.TAB_
      1507**DCL      1508--REDEF
OPEN_NETCON.UHL_
      1501**DCL      1502--REDEF    1502--REDEF
OPEN_NETCON.V
      1510**DCL      1501--DCLINIT
OPEN_NETCON.V.FSN#
      1541**DCL      1541--REDEF    1541--REDEF
OPEN_NETCON.WSN_
      1507**DCL      1507--REDEF
READ_NETCON
      1567**DCL      1980<>CALL
READ_NETCON.STATION_
      1570**DCL      1571--REDEF
READ_NETCON.V
      1571**DCL      1567--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
      1582**DCL      1582--REDEF
READ_NETCON.V.INDX#
      1580**DCL      1580--REDEF
SAVE_ME
      1416**DCL      1985<<ASSIGN   1990>>IF
SYS_ACCT
      1644**DCL      1506--DCLINIT
TEXT
        11**DCL         7--PROC     1975>>IF       2042<<CALLBLT  2043<<CALLBLT  2045>>IF       2049>>ASSIGN
      2069>>IF
THM$ERRMSG
      1675**DCL-ENT  2030--CALL     2056--CALL     2084--CALL
TH_CONSTRAINTS.E_BY_B
PL6.E3A0      #001=THS$SET_DEVS File=THS$SET_DEVS.:E05TSI                        WED 07/30/97 06:16 Page:46   
      1300**DCL      1300--REDEF
TH_CONSTRAINTS.M_BY_B
      1299**DCL      1299--REDEF
TH_CONSTRAINTS.TYPES
      1297**DCL      1297--REDEF
TH_DEFAULT.E_BY_B
      1308**DCL      1308--REDEF
TH_DEFAULT.M_BY_B
      1307**DCL      1307--REDEF
TH_DEFAULT.TYPES
      1305**DCL      1305--REDEF
TH_NUM_DEVS
      1324**DCL      2000>>DOINDEX  2044>>DOINDEX
TH_NUM_MODS
      1323**DCL      2067>>DOINDEX
TH_NUM_REP_DEVS
      1322**DCL      1959>>ASSIGN   1967<<ASSIGN   1968>>ASSIGN   2003>>ASSIGN   2004<<ASSIGN   2004>>ASSIGN
      2019>>DOINDEX  2019>>DOINDEX  2023<<ASSIGN   2023>>ASSIGN   2049>>ASSIGN   2050<<ASSIGN   2050>>ASSIGN
      2074>>DOINDEX  2074>>DOINDEX  2078<<ASSIGN   2078>>ASSIGN   2093>>ASSIGN   2094<<ASSIGN   2094>>ASSIGN
TH_REP_DEVS
      1323**DCL      1963<<ASSIGN   1968<<ASSIGN   2003<<ASSIGN   2020<<ASSIGN   2049<<ASSIGN   2075<<ASSIGN
      2093<<ASSIGN
TH_SAVE.E_BY_B
      1316**DCL      1316--REDEF
TH_SAVE.M_BY_B
      1314**DCL      1314--REDEF
TH_SAVE.TYPES
      1312**DCL      1313--REDEF
TH_SYS_DEVS.DEVN
      1323**DCL      2001>>IF       2045>>IF
TH_XSA_BUF_VECTOR
      1332**DCL      1332--REDEF
