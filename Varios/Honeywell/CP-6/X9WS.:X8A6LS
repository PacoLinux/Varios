VERSION A06

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:1    
        1        1        /*M* X9WS$START -- Provides file positioning & START stmt support.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P*
        9        9               NAME: X9WS$START
       10       10            PURPOSE: This module provides the functionality necessary for
       11       11                     the support of the START statement for all random access
       12       12                     file types (indexed, relative, keyed).
       13       13        */
       14       14        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:2    
       15       15        /*--------*/
       16       16        X9WS$START: PROC(FAB, ALT_RET, START_CODE, KEY_OFFSET, KEY_LEN) ALTRET;
       17       17        /*--------*/
       18       18
       19       19            %INCLUDE X8A_SYS_FILE;
       20     6289            %INCLUDE X9A_FAB;
       21     6476            %INCLUDE X9A_IO;
       22     6626            %INCLUDE X9A_LIB_IO;
       23     7010            %INCLUDE X8A_ERRCOM;
       24     7099            %DCL_FAB;
       25     7221            %DCL_SHARED        (@STCLASS="BASED (FAB.SHARED$)");
       26     7230            %EQU NONE          = 3;
       27     7231        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:3    
       28     7232    1       DCL PRIME_KEYX     SBIN WORD;
       29     7233    1       DCL ALT_RET        BIT(1) ALIGNED;
       30     7234    1       DCL KEY_LEN        SBIN WORD;
       31     7235    1       DCL KEY_OFFSET     SBIN WORD;
       32     7236    1       DCL START_CODE     SBIN WORD;
       33     7237    1       DCL I              SBIN WORD;
       34     7238    1       DCL RELATIVE_KEY   UBIN WORD;
       35     7239    1       DCL 1 KEYED_KEY    ALIGNED,
       36     7240    1            2 LENGTH      UBIN(9)   UNAL,
       37     7241    1            2 TEXT        CHAR(255) UNAL;
       38     7242    1       DCL KEY_TEXT       CHAR (KEYED_KEY.LENGTH) BASED (FAB.RECORD_KEY$) UNAL;
       39     7243    1       DCL INDEX_KEY      CHAR (KEY_LEN) BASED  (FAB.RECORD_KEY$) UNAL;
       40     7244    1       DCL ALT_INDX$      PTR;
       41     7245    1       DCL ALT_INDX       CHAR (KEY_LEN) BASED  (ALT_INDX$) UNAL;
       42     7246    1       DCL IO_STATUS      CHAR(2)        BASED  (FAB.IO_STATUS$);
       43     7247    1       DCL SUB_KEY        BIT(1);
       44     7248    1       DCL TEMP_INDX      CHAR(255);
       45     7249    1       DCL SAVE_INDX      CHAR(255);
       46     7250    1       DCL LOW_VALUE      CHAR(255);
       47     7251    1       DCL TEMP_LEN       SBIN WORD;
       48     7252
       49     7253    1   DCL 1 TWOBYTES UBIN(18) HALIGNED;                                    /*#37958*/
       50     7254    1   DCL 1 ONEBYTE REDEF TWOBYTES,                                        /*#37958*/
       51     7255    1       2 HIBYTE UBIN(9) CALIGNED,                                       /*#37958*/
       52     7256    1       2 LOBYTE UBIN(9) CALIGNED;                                       /*#37958*/
       53     7257            %VLP_ALTKEYS   (FPTN=ALT_KEYS, STCLASS="BASED (FAB.ALT_KEY$)");
       54     7272            %FPT_PRECORD   (FPTN=START);
       55     7293
       56     7294    1       DCL X9WE$IO_ERROR            ENTRY(2) ALTRET;
       57     7295    1       DCL X9WE$IO_ERROR_STATUS     ENTRY(2) ALTRET;
       58     7296    1       DCL X8ER$ERROR               ENTRY(3);
       59     7297    1       DCL X8CV$CONVERT_TO_INTEGER  ENTRY(3) ALTRET;
       60     7298    1       DCL XSA$PRECORD              ENTRY(2) ALTRET;
       61     7299        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:4    
       62     7300    2       DO CASE  (FAB.FILE_STATUS);
       63     7301
       64     7302    2         CASE (%FILE_NOT_PRESENT);
       65     7303
       66     7304    2           IO_STATUS = %NO_RANDOM_RECORD;
       67     7305    2           CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);
       68     7306
       69     7307    2         CASE (%FILE_LOCKED, %FILE_CLOSED, %FILE_NEVER_OPEN);
       70     7308
       71     7309    2           IO_STATUS = %NOT_OPEN_INPUT;
       72     7310    2           CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);
       73     7311
       74     7312        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:5    
       75     7313    2         CASE (%FILE_OPEN);
       76     7314
       77     7315    2           DCB$ = DCBADDR  (FAB.DCB_NUM);
       78     7316    2           IF M$XX.FUN# = %CREATE THEN
       79     7317    3             DO;
       80     7318    3               IO_STATUS = %NOT_OPEN_INPUT;
       81     7319    3               CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);
       82     7320    3             END;
       83     7321    2           ELSE
       84     7322    3             DO;
       85     7323    3               START.V.DCB# = FAB.DCB_NUM;
       86     7324    3               FAB.LAST_IO = %START;
       87     7325    3               IO_STATUS = %SUCCESSFUL;
       88     7326    3               FAB.B.NO_NEXT_RECORD_EXISTS = %NO#;
       89     7327
       90     7328    4               DO CASE (FAB.ORG#);
       91     7329        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:6    
       92     7330        /*-----------------\
       93     7331        |  RELATIVE Start  |
       94     7332        \-----------------*/
       95     7333
       96     7334    4              CASE (%CP6_RELATIVE);
       97     7335
       98     7336    4                CALL X8CV$CONVERT_TO_INTEGER (FAB.RELATIVE_KEY$,
       99     7337    4                     FAB.RELATIVE_DESC, RELATIVE_KEY);
      100     7338    4                START.KEY_ = VECTOR  (RELATIVE_KEY);
      101     7339    5                DO CASE (START_CODE);
      102     7340
      103     7341    5                  CASE (%START_GREATER_THAN);
      104     7342
      105     7343    5                    RELATIVE_KEY = RELATIVE_KEY + 1;
      106     7344
      107     7345    5                  CASE (%START_GREATER_THAN_EQUAL, %START_EQUAL);
      108     7346
      109     7347                         /* nothing to change in this case */
      110     7348    5                  CASE (ELSE);
      111     7349
      112     7350    5                    CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS:RELATIVE', 13);
      113     7351
      114     7352    5                END;  /* case */
      115     7353
      116     7354    4                START.V.KEYS# = YES#;
      117     7355    4                START.V.N#    = 0;
      118     7356    4                CALL POS_REC
      119     7357    4                WHENALTRETURN
      120     7358    5                  DO;
      121     7359    5                    CALL X9WE$IO_ERROR (FAB, ALT_RET)
      122     7360    5                    WHENALTRETURN
      123     7361    6                      DO;
      124     7362    6                        ALTRETURN;
      125     7363    6                      END;
      126     7364    5                  END;
      127     7365        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:7    
      128     7366        /*----------------\
      129     7367        |  INDEXed Start  |
      130     7368        \----------------*/
      131     7369
      132     7370    4              CASE (%CP6_INDEXED);
      133     7371
      134     7372    4                FAB.B.SHARED_INDEX_ALT = %NO#;     /*#29480*/
      135     7373    4                START.V.KEYS# = YES#;
      136     7374    4                START.V.KEYR# = YES#;
      137     7375    4                START.V.N#    = 0;
      138     7376    4                PRIME_KEYX = POFFC (FAB.RECORD_KEY$, FAB.BUFFER$);
      139     7377    4                IF KEY_OFFSET = PRIME_KEYX THEN
      140     7378    5                  DO;
      141     7379    5                    TEMP_LEN = FAB.RECORD_KEY_LEN;
      142     7380    5                    IF TEMP_LEN = KEY_LEN THEN
      143     7381    6                      DO;
      144     7382    6                        SUB_KEY = NO#;
      145     7383    6                        TEMP_INDX = INDEX_KEY;
      146     7384    6                        SAVE_INDX = INDEX_KEY; /* save sending key for */
      147     7385    6                      END;                     /* duplicate compares   */
      148     7386    5                    ELSE
      149     7387    6                      DO;     /*  we have a subkey */
      150     7388    6                        SUB_KEY = YES#;
      151     7389    6                        TEMP_INDX = INDEX_KEY;
      152     7390    6                        SAVE_INDX = INDEX_KEY;
      153     7391                             /* Move LOW-VALUES to unused part */  /*#40798*/
      154     7392    7                        DO I = KEY_LEN TO TEMP_LEN - 1;
      155     7393    7                          SUBSTR (TEMP_INDX,I,1) = BINASC(0);
      156     7394    7                        END;
      157     7395    6                      END;
      158     7396    5                    START.V.INDX# = %PRIMARY_KEY;
      159     7397    5                    START.KEY_  = VECTOR (SUBSTR (TEMP_INDX,0,TEMP_LEN));
      160     7398    5                  END;
      161     7399    4                ELSE  /* we have an alternate key */
      162     7400        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:8    
      163     7401        /*----------------\
      164     7402        |  INDEXed Start  |
      165     7403        \----------------*/
      166     7404
      167     7405    5   FIND_ALT_KEY:  DO  I = 0 TO ALT_KEYS.SIZ# - 1;
      168     7406    5                    IF KEY_OFFSET = ALT_KEYS.K.KEYX# (I) THEN
      169     7407    6                      DO;
      170     7408    6                        TEMP_LEN = ALT_KEYS.K.KEYL# (I);
      171     7409    6                        ALT_INDX$ = PINCRC (FAB.BUFFER$, ALT_KEYS.K.KEYX#(I));
      172     7410    6                        IF TEMP_LEN = KEY_LEN THEN
      173     7411    7                          DO;
      174     7412    7                            SUB_KEY = NO#;
      175     7413    7                            TEMP_INDX = ALT_INDX;
      176     7414    7                            SAVE_INDX = ALT_INDX;
      177     7415    7                            START.V.INDX# = I + 2;
      178     7416    7                          END;
      179     7417    6                        ELSE
      180     7418    7                          DO;
      181     7419    7                            SUB_KEY = YES#;
      182     7420    7                            TEMP_INDX = ALT_INDX;
      183     7421    7                            SAVE_INDX = ALT_INDX;
      184     7422    7                            START.V.INDX# = I + 2;
      185     7423    7             /*#37958*/     IF   START_CODE = %START_GREATER_THAN
      186     7424    8             /*#37958*/     THEN DO;
      187     7425    8             /*#37958*/          I = TEMP_LEN;
      188     7426    9             /*#37958*/          DO  UNTIL (ONEBYTE.HIBYTE = 0 OR I = 0);
      189     7427    9             /*#37958*/              I = I - 1;
      190     7428    9             /*#37958*/              TWOBYTES = ASCBIN(SUBSTR(TEMP_INDX,I,1));
      191     7429    9             /*#37958*/              TWOBYTES = TWOBYTES + 1;
      192     7430    9             /*#37958*/              SUBSTR(TEMP_INDX,I,1) = BINASC(ONEBYTE.LOBYTE);
      193     7431    9             /*#37958*/          END; /* DO  UNTIL ...                      */
      194     7432    8             /*#37958*/          IF   ONEBYTE.HIBYTE ~= 0
      195     7433    8             /*#37958*/          THEN
      196     7434    9             /*#37958*/               DO;
      197     7435    9             /*#37958*/               IO_STATUS = %NO_RANDOM_RECORD;
      198     7436    9             /*#37958*/               FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      199     7437    9             /*#37958*/               CALL X9WE$IO_ERROR_STATUS(FAB,ALT_RET)
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:9    
      200     7438   10             /*#37958*/                    WHENALTRETURN DO; ALTRETURN; END;
      201     7439    9             /*#37958*/               END;
      202     7440    8             /*#37958*/          END;
      203     7441    8                            DO   I = KEY_LEN TO TEMP_LEN - 1;           /*#37958*/
      204     7442    8                              SUBSTR (TEMP_INDX,I,1) = BINASC(0);
      205     7443    8                            END;
      206     7444    7                          END;
      207     7445    6                        START.KEY_ = VECTOR (SUBSTR (TEMP_INDX,0,TEMP_LEN));
      208     7446    6                        IF M$XX.SHARE# ~= %NONE THEN           /*#24102*/
      209     7447    7                          DO;
      210     7448    7                            FAB.B.SHARED_INDEX_ALT = %YES#;
      211     7449    7                            FAB.B.REPOSITION = %NO#;
      212     7450    7                            SHARED.INDX = START.V.INDX# - 2;
      213     7451    7                            SHARED.RECNUM = 1;
      214     7452    7                          END;
      215     7453    6                        EXIT FIND_ALT_KEY;
      216     7454    6                      END;
      217     7455    5                  END;
      218     7456
      219     7457    5                DO I = 0 TO TEMP_LEN - 1;
      220     7458    5                  SUBSTR (LOW_VALUE,I,1) = BINASC (0);
      221     7459    5                END;
      222     7460        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:10   
      223     7461        /*----------------\
      224     7462        |  INDEXed Start  |
      225     7463        \----------------*/
      226     7464
      227     7465    5                DO CASE  (START_CODE);
      228     7466
      229     7467    5                  CASE  (%START_EQUAL);
      230     7468
      231     7469    5                    CALL POS_REC
      232     7470    5                    WHENALTRETURN
      233     7471    6                      DO;
      234     7472    6                        IF  SUBSTR (TEMP_INDX,0,KEY_LEN) ~=
      235     7473    6                            SUBSTR (SAVE_INDX,0,KEY_LEN) THEN
      236     7474    6                          CALL X9WE$IO_ERROR (FAB, ALT_RET)
      237     7475    6                            WHENALTRETURN
      238     7476    7                              DO;
      239     7477    7                                ALTRETURN;
      240     7478    7                              END;
      241     7479    6                      END;
      242     7480        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:11   
      243     7481        /*----------------\
      244     7482        |  INDEXed Start  |
      245     7483        \----------------*/
      246     7484
      247     7485    5                  CASE  (%START_GREATER_THAN_EQUAL);
      248     7486
      249     7487    5                    CALL POS_REC
      250     7488    5                      WHENALTRETURN
      251     7489    6                        DO;
      252     7490    6                          IF SUBSTR (TEMP_INDX,0,KEY_LEN) =
      253     7491    6                             SUBSTR (LOW_VALUE,0,KEY_LEN) THEN
      254     7492    6                            CALL X9WE$IO_ERROR (FAB, ALT_RET)
      255     7493    6                              WHENALTRETURN
      256     7494    7                                DO;
      257     7495    7                                  ALTRETURN;
      258     7496    7                            END;
      259     7497    6                        END;
      260     7498        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:12   
      261     7499        /*----------------\
      262     7500        |  INDEXed Start  |
      263     7501        \----------------*/
      264     7502
      265     7503    5                  CASE  (%START_GREATER_THAN);
      266     7504
      267     7505    5                    CALL POS_REC
      268     7506    5                      WHENRETURN
      269     7507    6                        DO WHILE  (SUBSTR (TEMP_INDX,0,KEY_LEN)  =
      270     7508    6                                   SUBSTR (SAVE_INDX,0,KEY_LEN));
      271     7509    6                          IF FAB.B.SHARED_INDEX_ALT THEN       /*#24102*/
      272     7510    6                            CALL GREATER_ADVANCE_SHARED
      273     7511    6                              WHENALTRETURN
      274     7512    7                                DO;
      275     7513    7                                  ALTRETURN;
      276     7514    7                                END;
      277     7515    6                          ELSE
      278     7516    6                            CALL GREATER_ADVANCE
      279     7517    6                              WHENALTRETURN
      280     7518    7                                DO;
      281     7519    7                                  ALTRETURN;
      282     7520    7                                END;
      283     7521    6                        END; /* while not a duplicate index */
      284     7522        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:13   
      285     7523        /*----------------\
      286     7524        |  INDEXed Start  |
      287     7525        \----------------*/
      288     7526
      289     7527    5                      WHENALTRETURN
      290     7528    6                        DO;
      291     7529    6                          IF SUBSTR (TEMP_INDX,0,KEY_LEN)  =
      292     7530    6                             SUBSTR (LOW_VALUE,0,KEY_LEN) THEN
      293     7531    6                            CALL X9WE$IO_ERROR (FAB, ALT_RET)
      294     7532    6                              WHENALTRETURN
      295     7533    7                                DO;
      296     7534    7                                  ALTRETURN;
      297     7535    7                                END;
      298     7536    6                          ELSE
      299     7537    6                            IF SUB_KEY THEN
      300     7538    7                              DO WHILE  (SUBSTR (TEMP_INDX,0,KEY_LEN) =
      301     7539    7                                         SUBSTR (SAVE_INDX,0,KEY_LEN));
      302     7540    7                                IF   FAB.B.SHARED_INDEX_ALT             /*#37958*/
      303     7541    7                                THEN CALL GREATER_ADVANCE_SHARED        /*#37958*/
      304     7542    8                                     WHENALTRETURN DO; ALTRETURN; END;  /*#37958*/
      305     7543    7                                ELSE CALL GREATER_ADVANCE               /*#37958*/
      306     7544    8                                     WHENALTRETURN DO; ALTRETURN; END;  /*#37958*/
      307     7545    7                              END; /* WHILE */
      308     7546    6                        END;
      309     7547    5                END;  /* case start_code */
      310     7548        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:14   
      311     7549        /*--------------\
      312     7550        |  KEYed Start  |
      313     7551        \--------------*/
      314     7552
      315     7553    4               CASE (%CP6_KEYED);
      316     7554
      317     7555    4                 KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;
      318     7556    4                 KEYED_KEY.TEXT   = KEY_TEXT;
      319     7557    4                 START.KEY_       = VECTOR (KEYED_KEY);
      320     7558    4                 START.V.KEYS#      = YES#;
      321     7559    4                 START.V.KEYR#      = YES#;
      322     7560    4                 START.V.N#    = 0;
      323     7561
      324     7562    5                 DO I = 0 TO FAB.RECORD_KEY_LEN - 1;
      325     7563    5                   SUBSTR (LOW_VALUE,I,1) =  BINASC(0);
      326     7564    5                 END;
      327     7565
      328     7566    5                 DO CASE (START_CODE);
      329     7567        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:15   
      330     7568        /*--------------\
      331     7569        |  KEYed Start  |
      332     7570        \--------------*/
      333     7571
      334     7572    5                   CASE (%START_GREATER_THAN);
      335     7573
      336     7574    5                     CALL POS_REC
      337     7575    5                      WHENRETURN
      338     7576    6                       DO;
      339     7577    6                         START.V.KEYS# = %NO#;
      340     7578    6                         START.V.N#    = 1;
      341     7579    6                         CALL POS_REC
      342     7580    6                         WHENRETURN
      343     7581    7                           DO;
      344     7582    7                             IF KEYED_KEY.LENGTH = 0 THEN
      345     7583    8                               DO;
      346     7584    8                                 FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      347     7585    8                                 IO_STATUS = %NO_RANDOM_RECORD;
      348     7586    8                                 IF ALT_RET THEN
      349     7587    8                                   ALTRETURN; /* invalid key clause */
      350     7588    8                                 ELSE
      351     7589    8                                   CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);
      352     7590    8                               END;
      353     7591    7                           END;
      354     7592        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:16   
      355     7593        /*--------------\
      356     7594        |  KEYed Start  |
      357     7595        \--------------*/
      358     7596
      359     7597    6                         WHENALTRETURN
      360     7598    7                           DO;
      361     7599    7                             FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      362     7600    7                             CALL X9WE$IO_ERROR (FAB);
      363     7601    7                           END;
      364     7602    6                       END;
      365     7603        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:17   
      366     7604        /*--------------\
      367     7605        |  KEYed Start  |
      368     7606        \--------------*/
      369     7607
      370     7608    5                     WHENALTRETURN
      371     7609    6                       DO;
      372     7610    6                         IF KEYED_KEY.LENGTH = 0 THEN
      373     7611    7                           DO;
      374     7612    7                             FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      375     7613    7                             IO_STATUS = %NO_RANDOM_RECORD;
      376     7614    7                             IF ALT_RET THEN
      377     7615    7                               ALTRETURN;
      378     7616    7                             ELSE
      379     7617    7                               CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);
      380     7618    7                           END;
      381     7619    6                         ELSE
      382     7620    6                           RETURN;
      383     7621    6                       END;
      384     7622        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:18   
      385     7623        /*--------------\
      386     7624        |  KEYed Start  |
      387     7625        \--------------*/
      388     7626
      389     7627    5                   CASE (%START_EQUAL);
      390     7628    5                     CALL POS_REC
      391     7629    5                     WHENALTRETURN
      392     7630    6                       DO;
      393     7631    6                         FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      394     7632    6                         CALL X9WE$IO_ERROR (FAB, ALT_RET)
      395     7633    6                         WHENALTRETURN
      396     7634    7                           DO;
      397     7635    7                             ALTRETURN;    /*  INVALID KEY  */
      398     7636    7                           END;
      399     7637    6                       END;
      400     7638        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:19   
      401     7639        /*--------------\
      402     7640        |  KEYed Start  |
      403     7641        \--------------*/
      404     7642
      405     7643    5                   CASE (%START_GREATER_THAN_EQUAL);
      406     7644    5                     CALL POS_REC
      407     7645    5                       WHENALTRETURN
      408     7646    6                         DO;
      409     7647    6                           IF KEYED_KEY.LENGTH = 0 THEN
      410     7648    7                             DO;
      411     7649    7                               FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      412     7650    7                               IO_STATUS = %NO_RANDOM_RECORD;
      413     7651    7                               CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET)
      414     7652    7                               WHENALTRETURN
      415     7653    8                                 DO;
      416     7654    8                                   ALTRETURN;
      417     7655    8                                 END;
      418     7656    7                             END;
      419     7657    6                           ELSE
      420     7658    6                             RETURN;
      421     7659    6                         END;
      422     7660
      423     7661    5                   CASE (ELSE);
      424     7662    5                     CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS:KEYED', 10);
      425     7663
      426     7664    5                 END;  /* case start_code */
      427     7665    4             END; /* case m$xx.org# */
      428     7666    3           END; /* else do (if m$xx.fun# = %create) */
      429     7667    2         END; /* case fab.file_status */
      430     7668
      431     7669    1       IF FAB.B.SHARED_INDEX_ALT THEN                          /*#24102*/
      432     7670    2         DO;
      433     7671    2           SHARED.KEY = TEMP_INDX;                                      /*#37958*/
      434     7672    2         END;
      435     7673        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:20   
      436     7674        /*----------------------*/
      437     7675    1     GREATER_ADVANCE_SHARED:     PROC   ALTRET;                /*#24102*/
      438     7676        /*----------------------*/
      439     7677
      440     7678        /*I*
      441     7679               NAME: X9WS$START:GREATER_ADVANCE_SHARED
      442     7680
      443     7681            PURPOSE: This procedure was developed in order to provide support
      444     7682                     for sequential reads of shared indexed files accessed
      445     7683                     with an alternate key because this functionality was removed
      446     7684                     from the C00 release of the CP-6 operating system.
      447     7685        */
      448     7686    2       START.V.KEYS# = %YES#;
      449     7687
      450     7688    2       IF ALT_KEYS.K.UNIQUE# (SHARED.INDX) THEN
      451     7689    3         DO;
      452     7690    3           START.V.N# = 1;
      453     7691    3         END;
      454     7692    2       ELSE
      455     7693    3         DO;
      456     7694    3           SHARED.RECNUM = SHARED.RECNUM + 1;
      457     7695    3           START.V.RECNUM# = SHARED.RECNUM;
      458     7696    3           START.V.N# = 0;
      459     7697    3         END;
      460     7698
      461     7699    2       CALL M$PRECORD (START)
      462     7700    2         WHENRETURN
      463     7701    3           DO;
      464     7702    3             IF SUBSTR (TEMP_INDX,0,KEY_LEN) = SUBSTR (LOW_VALUE,0,KEY_LEN) THEN
      465     7703    4               DO;
      466     7704    4                 IO_STATUS = %NO_RANDOM_RECORD;
      467     7705    4                 FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      468     7706    4                 CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET)
      469     7707    4                   WHENALTRETURN
      470     7708    5                     DO;
      471     7709    5                       ALTRETURN;
      472     7710    5                     END;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:21   
      473     7711    4                END;
      474     7712    3            END;  /* whenreturn */
      475     7713        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:22   
      476     7714    2          WHENALTRETURN
      477     7715    3            DO;
      478     7716    3              CALL X9WE$IO_ERROR (FAB)
      479     7717    3                WHENALTRETURN
      480     7718    4                  DO;
      481     7719    4                    ALTRETURN;
      482     7720    4                  END;
      483     7721    3               IF NOT ALT_KEYS.K.UNIQUE# (SHARED.INDX) THEN
      484     7722    4                 DO;
      485     7723    4                   START.V.N# = 1;
      486     7724    4                   START.V.RECNUM# = SHARED.RECNUM - 1; /* last dup */
      487     7725    4                   SHARED.RECNUM = 1;
      488     7726    4                   TEMP_INDX = SAVE_INDX;
      489     7727    4                   CALL M$PRECORD (START)
      490     7728    4                     WHENALTRETURN
      491     7729    5                       DO;
      492     7730    5                         CALL X9WE$IO_ERROR (FAB);
      493     7731    5                       END;
      494     7732    4                 END;
      495     7733    3             END; /* whenaltreturn */
      496     7734
      497     7735    2     END GREATER_ADVANCE_SHARED; /* proc */
      498     7736        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:23   
      499     7737        /*---------------*/
      500     7738    1     GREATER_ADVANCE: PROC  ALTRET;
      501     7739        /*---------------*/
      502     7740
      503     7741        /*I*
      504     7742               NAME: X9WS$START:GREATER_ADVANCE
      505     7743
      506     7744            PURPOSE: This procedure will advance to the next key > than the
      507     7745                     key positioned to by the first call to M$PRECORD.
      508     7746        */
      509     7747
      510     7748    2       START.V.N# = 1;
      511     7749    2       START.V.KEYS# = NO#;
      512     7750    2       CALL POS_REC
      513     7751    2         WHENRETURN
      514     7752    3           DO;        /* CHECK FOR EOF */
      515     7753    3             IF SUBSTR (TEMP_INDX,0,KEY_LEN) = SUBSTR (LOW_VALUE,0,KEY_LEN) THEN
      516     7754    4               DO;
      517     7755    4                 IO_STATUS = %NO_RANDOM_RECORD;
      518     7756    4                 FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      519     7757    4                 CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET)
      520     7758    4                 WHENALTRETURN
      521     7759    5                   DO;
      522     7760    5                     ALTRETURN;
      523     7761    5                   END;
      524     7762    4                END;
      525     7763    3             END;      /* WHENRETURN */
      526     7764    2         WHENALTRETURN
      527     7765    3           DO;
      528     7766    3             FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;
      529     7767    3             CALL X9WE$IO_ERROR (FAB, ALT_RET)
      530     7768    3             WHENALTRETURN
      531     7769    4               DO;
      532     7770    4                 ALTRETURN;
      533     7771    4               END;
      534     7772    3           END;
      535     7773    2     END GREATER_ADVANCE;  /* proc */
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:24   
      536     7774        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:25   
      537     7775        /*-------*/
      538     7776    1     POS_REC: PROC  ALTRET;
      539     7777        /*-------*/
      540     7778
      541     7779        /*I*
      542     7780               NAME: X9WS$START:POS_REC
      543     7781
      544     7782            PURPOSE: This procedure will position to the requested key.
      545     7783        */
      546     7784
      547     7785    2       IF FAB.B.FAST_SEQUENTIAL THEN
      548     7786    2         CALL XSA$PRECORD (START, FAB.XSA)
      549     7787    2           WHENALTRETURN
      550     7788    3             DO;
      551     7789    3               ALTRETURN;
      552     7790    3             END;
      553     7791    2       ELSE
      554     7792    2         CALL M$PRECORD (START)
      555     7793    2           WHENALTRETURN
      556     7794    3             DO;
      557     7795    3               ALTRETURN;
      558     7796    3             END;
      559     7797
      560     7798    2     END POS_REC;
      561     7799
      562     7800    1   END X9WS$START; /* proc */
      563     7801        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:26   
      564     7802        %EOD;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:27   
--  Include file information  --

   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
      No diagnostics issued in procedure X9WS$START.

   Procedure X9WS$START requires 727 words for executable code.
   Procedure X9WS$START requires 302 words of local(AUTO) storage.

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:28   

 Object Unit name= X9WS$START                                 File name= X9WS.:X8A6TOU
 UTS= AUG 09 '97 11:08:35.48 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    10     12  X9WS$START
    2  RoData even  UTS     10     12  X9WS$START
    3   Proc  even  none   727   1327  X9WS$START
    4  RoData even  none    20     24  X9WS$START

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        5  X9WS$START

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 X9WE$IO_ERROR_STATUS
 yes     yes           Std       3 X8CV$CONVERT_TO_INTEGER
 yes     yes           Std       2 X9WE$IO_ERROR
         yes           Std       3 X8ER$ERROR
 yes     yes           Std       2 XSA$PRECORD
                       nStd      0 X66_AUTO_5
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:29   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:30   


        1        1        /*M* X9WS$START -- Provides file positioning & START stmt support.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*P*
        9        9               NAME: X9WS$START
       10       10            PURPOSE: This module provides the functionality necessary for
       11       11                     the support of the START statement for all random access
       12       12                     file types (indexed, relative, keyed).
       13       13        */
       14       14        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:31   
       15       15        /*--------*/
       16       16        X9WS$START: PROC(FAB, ALT_RET, START_CODE, KEY_OFFSET, KEY_LEN) ALTRET;

     16  3 000000   000000 700200 xent  X9WS$START   TSX0  ! X66_AUTO_5
         3 000001   000456 000005                    ZERO    302,5

       17       17        /*--------*/
       18       18
       19       19            %INCLUDE X8A_SYS_FILE;
       20     6289            %INCLUDE X9A_FAB;
       21     6476            %INCLUDE X9A_IO;
       22     6626            %INCLUDE X9A_LIB_IO;
       23     7010            %INCLUDE X8A_ERRCOM;
       24     7099            %DCL_FAB;
       25     7221            %DCL_SHARED        (@STCLASS="BASED (FAB.SHARED$)");
       26     7230            %EQU NONE          = 3;
       27     7231        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:32   
       28     7232    1       DCL PRIME_KEYX     SBIN WORD;
       29     7233    1       DCL ALT_RET        BIT(1) ALIGNED;
       30     7234    1       DCL KEY_LEN        SBIN WORD;
       31     7235    1       DCL KEY_OFFSET     SBIN WORD;
       32     7236    1       DCL START_CODE     SBIN WORD;
       33     7237    1       DCL I              SBIN WORD;
       34     7238    1       DCL RELATIVE_KEY   UBIN WORD;
       35     7239    1       DCL 1 KEYED_KEY    ALIGNED,
       36     7240    1            2 LENGTH      UBIN(9)   UNAL,
       37     7241    1            2 TEXT        CHAR(255) UNAL;
       38     7242    1       DCL KEY_TEXT       CHAR (KEYED_KEY.LENGTH) BASED (FAB.RECORD_KEY$) UNAL;
       39     7243    1       DCL INDEX_KEY      CHAR (KEY_LEN) BASED  (FAB.RECORD_KEY$) UNAL;
       40     7244    1       DCL ALT_INDX$      PTR;
       41     7245    1       DCL ALT_INDX       CHAR (KEY_LEN) BASED  (ALT_INDX$) UNAL;
       42     7246    1       DCL IO_STATUS      CHAR(2)        BASED  (FAB.IO_STATUS$);
       43     7247    1       DCL SUB_KEY        BIT(1);
       44     7248    1       DCL TEMP_INDX      CHAR(255);
       45     7249    1       DCL SAVE_INDX      CHAR(255);
       46     7250    1       DCL LOW_VALUE      CHAR(255);
       47     7251    1       DCL TEMP_LEN       SBIN WORD;
       48     7252
       49     7253    1   DCL 1 TWOBYTES UBIN(18) HALIGNED;                                    /*#37958*/
       50     7254    1   DCL 1 ONEBYTE REDEF TWOBYTES,                                        /*#37958*/
       51     7255    1       2 HIBYTE UBIN(9) CALIGNED,                                       /*#37958*/
       52     7256    1       2 LOBYTE UBIN(9) CALIGNED;                                       /*#37958*/
       53     7257            %VLP_ALTKEYS   (FPTN=ALT_KEYS, STCLASS="BASED (FAB.ALT_KEY$)");
       54     7272            %FPT_PRECORD   (FPTN=START);
       55     7293
       56     7294    1       DCL X9WE$IO_ERROR            ENTRY(2) ALTRET;
       57     7295    1       DCL X9WE$IO_ERROR_STATUS     ENTRY(2) ALTRET;
       58     7296    1       DCL X8ER$ERROR               ENTRY(3);
       59     7297    1       DCL X8CV$CONVERT_TO_INTEGER  ENTRY(3) ALTRET;
       60     7298    1       DCL XSA$PRECORD              ENTRY(2) ALTRET;
       61     7299        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:33   
       62     7300    2       DO CASE  (FAB.FILE_STATUS);

   7300  3 000002   200003 470500                    LDP0    @FAB,,AUTO
         3 000003   000026 235100                    LDA     22,,PR0
         3 000004   000006 115007                    CMPA    6,DL
         3 000005   000007 602005 3                  TNC     s:7300+5,AL
         3 000006   001074 710000 3                  TRA     s:7669
         3 000007   000026 710000 3                  TRA     s:7309
         3 000010   000026 710000 3                  TRA     s:7309
         3 000011   000037 710000 3                  TRA     s:7315
         3 000012   000015 710000 3                  TRA     s:7304
         3 000013   001074 710000 3                  TRA     s:7669
         3 000014   000026 710000 3                  TRA     s:7309

       63     7301
       64     7302    2         CASE (%FILE_NOT_PRESENT);

       65     7303
       66     7304    2           IO_STATUS = %NO_RANDOM_RECORD;

   7304  3 000015   000036 471500                    LDP1    30,,PR0
         3 000016   040100 100400                    MLR     fill='040'O
         3 000017   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 000020   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

       67     7305    2           CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);

   7305  3 000021   200003 630500                    EPPR0   @FAB,,AUTO
         3 000022   000000 631400 4                  EPPR1   0
         3 000023   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 000024   000000 011000                    NOP     0
         3 000025   001074 710000 3                  TRA     s:7669

       68     7306
       69     7307    2         CASE (%FILE_LOCKED, %FILE_CLOSED, %FILE_NEVER_OPEN);

       70     7308
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:34   
       71     7309    2           IO_STATUS = %NOT_OPEN_INPUT;

   7309  3 000026   000036 471500                    LDP1    30,,PR0
         3 000027   040100 100400                    MLR     fill='040'O
         3 000030   000001 000002 2                  ADSC9   1                        cn=0,n=2
         3 000031   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

       72     7310    2           CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);

   7310  3 000032   200003 630500                    EPPR0   @FAB,,AUTO
         3 000033   000000 631400 4                  EPPR1   0
         3 000034   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 000035   000000 011000                    NOP     0
         3 000036   001074 710000 3                  TRA     s:7669

       73     7311
       74     7312        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:35   
       75     7313    2         CASE (%FILE_OPEN);

       76     7314
       77     7315    2           DCB$ = DCBADDR  (FAB.DCB_NUM);

   7315  3 000037   000001 471400 4                  LDP1    1
         3 000040   100000 473500                    LDP3    0,,PR1
         3 000041   000034 220100                    LDX0    28,,PR0
         3 000042   300000 236110                    LDQ     0,X0,PR3
         3 000043   200010 756100                    STQ     DCB$,,AUTO

       78     7316    2           IF M$XX.FUN# = %CREATE THEN

   7316  3 000044   200010 474500                    LDP4    DCB$,,AUTO
         3 000045   400032 236100                    LDQ     26,,PR4
         3 000046   000777 376003                    ANQ     511,DU
         3 000047   000003 116003                    CMPQ    3,DU
         3 000050   000062 601000 3                  TNZ     s:7323

       79     7317    3             DO;

       80     7318    3               IO_STATUS = %NOT_OPEN_INPUT;

   7318  3 000051   000036 475500                    LDP5    30,,PR0
         3 000052   040100 100400                    MLR     fill='040'O
         3 000053   000001 000002 2                  ADSC9   1                        cn=0,n=2
         3 000054   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2

       81     7319    3               CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);

   7319  3 000055   200003 630500                    EPPR0   @FAB,,AUTO
         3 000056   000000 631400 4                  EPPR1   0
         3 000057   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 000060   000000 011000                    NOP     0

       82     7320    3             END;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:36   
   7320  3 000061   001074 710000 3                  TRA     s:7669

       83     7321    2           ELSE
       84     7322    3             DO;

       85     7323    3               START.V.DCB# = FAB.DCB_NUM;

   7323  3 000062   000006 740000 1                  STX0    START+6

       86     7324    3               FAB.LAST_IO = %START;

   7324  3 000063   000005 235007                    LDA     5,DL
         3 000064   000025 755100                    STA     21,,PR0

       87     7325    3               IO_STATUS = %SUCCESSFUL;

   7325  3 000065   000036 475500                    LDP5    30,,PR0
         3 000066   040100 100400                    MLR     fill='040'O
         3 000067   000002 000002 2                  ADSC9   2                        cn=0,n=2
         3 000070   500000 000002                    ADSC9   0,,PR5                   cn=0,n=2

       88     7326    3               FAB.B.NO_NEXT_RECORD_EXISTS = %NO#;

   7326  3 000071   000002 236000 4                  LDQ     2
         3 000072   000032 356100                    ANSQ    26,,PR0

       89     7327
       90     7328    4               DO CASE (FAB.ORG#);

   7328  3 000073   000002 235100                    LDA     2,,PR0
         3 000074   000007 115007                    CMPA    7,DL
         3 000075   000077 602005 3                  TNC     s:7328+4,AL
         3 000076   001074 710000 3                  TRA     s:7669
         3 000077   001074 710000 3                  TRA     s:7669
         3 000100   001074 710000 3                  TRA     s:7669
         3 000101   000666 710000 3                  TRA     s:7555
         3 000102   001074 710000 3                  TRA     s:7669
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:37   
         3 000103   001074 710000 3                  TRA     s:7669
         3 000104   000106 710000 3                  TRA     s:7336
         3 000105   000164 710000 3                  TRA     s:7372

       91     7329        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:38   
       92     7330        /*-----------------\
       93     7331        |  RELATIVE Start  |
       94     7332        \-----------------*/
       95     7333
       96     7334    4              CASE (%CP6_RELATIVE);

       97     7335
       98     7336    4                CALL X8CV$CONVERT_TO_INTEGER (FAB.RELATIVE_KEY$,

   7336  3 000106   200041 635500                    EPPR5   RELATIVE_KEY,,AUTO
         3 000107   200454 455500                    STP5    TWOBYTES+7,,AUTO
         3 000110   200003 236100                    LDQ     @FAB,,AUTO
         3 000111   000030 036003                    ADLQ    24,DU
         3 000112   200453 756100                    STQ     TWOBYTES+6,,AUTO
         3 000113   200003 236100                    LDQ     @FAB,,AUTO
         3 000114   000053 036003                    ADLQ    43,DU
         3 000115   200452 756100                    STQ     TWOBYTES+5,,AUTO
         3 000116   200452 630500                    EPPR0   TWOBYTES+5,,AUTO
         3 000117   000003 631400 4                  EPPR1   3
         3 000120   000000 701000 xent               TSX1    X8CV$CONVERT_TO_INTEGER
         3 000121   000000 011000                    NOP     0

       99     7337    4                     FAB.RELATIVE_DESC, RELATIVE_KEY);
      100     7338    4                START.KEY_ = VECTOR  (RELATIVE_KEY);

   7338  3 000122   777640 235007                    LDA     -96,DL
         3 000123   200452 452500                    STP2    TWOBYTES+5,,AUTO
         3 000124   200452 236100                    LDQ     TWOBYTES+5,,AUTO
         3 000125   000041 036003                    ADLQ    33,DU
         3 000126   000002 757000 1                  STAQ    START+2

      101     7339    5                DO CASE (START_CODE);

   7339  3 000127   200005 470500                    LDP0    @START_CODE,,AUTO
         3 000130   000000 235100                    LDA     0,,PR0
         3 000131   000003 115007                    CMPA    3,DL
         3 000132   000134 602005 3                  TNC     s:7339+5,AL
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:39   
         3 000133   000143 710000 3                  TRA     s:7350
         3 000134   000147 710000 3                  TRA     s:7354
         3 000135   000137 710000 3                  TRA     s:7343
         3 000136   000147 710000 3                  TRA     s:7354

      102     7340
      103     7341    5                  CASE (%START_GREATER_THAN);

      104     7342
      105     7343    5                    RELATIVE_KEY = RELATIVE_KEY + 1;

   7343  3 000137   200041 235100                    LDA     RELATIVE_KEY,,AUTO
         3 000140   000001 035007                    ADLA    1,DL
         3 000141   200041 755100                    STA     RELATIVE_KEY,,AUTO
         3 000142   000147 710000 3                  TRA     s:7354

      106     7344
      107     7345    5                  CASE (%START_GREATER_THAN_EQUAL, %START_EQUAL);

      108     7346
      109     7347                         /* nothing to change in this case */
      110     7348    5                  CASE (ELSE);

      111     7349
      112     7350    5                    CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS:RELATIVE', 13);

   7350  3 000143   000006 630400 4                  EPPR0   6
         3 000144   000003 631400 4                  EPPR1   3
         3 000145   000000 701000 xent               TSX1    X8ER$ERROR
         3 000146   000000 011000                    NOP     0

      113     7351
      114     7352    5                END;  /* case */

      115     7353
      116     7354    4                START.V.KEYS# = YES#;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:40   
   7354  3 000147   400000 236007                    LDQ     -131072,DL
         3 000150   000006 256000 1                  ORSQ    START+6

      117     7355    4                START.V.N#    = 0;

   7355  3 000151   000007 450000 1                  STZ     START+7

      118     7356    4                CALL POS_REC

   7356  3 000152   001274 701000 3                  TSX1    POS_REC
         3 000153   000155 702000 3                  TSX2    s:7359
         3 000154   000163 710000 3                  TRA     s:7364

      119     7357    4                WHENALTRETURN
      120     7358    5                  DO;

      121     7359    5                    CALL X9WE$IO_ERROR (FAB, ALT_RET)

   7359  3 000155   200003 630500                    EPPR0   @FAB,,AUTO
         3 000156   000000 631400 4                  EPPR1   0
         3 000157   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000160   000162 702000 3                  TSX2    s:7362
         3 000161   000163 710000 3                  TRA     s:7364

      122     7360    5                    WHENALTRETURN
      123     7361    6                      DO;

      124     7362    6                        ALTRETURN;

   7362  3 000162   000000 702200 xent               TSX2  ! X66_AALT

      125     7363    6                      END;
      126     7364    5                  END;

   7364  3 000163   001074 710000 3                  TRA     s:7669

      127     7365        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:41   
      128     7366        /*----------------\
      129     7367        |  INDEXed Start  |
      130     7368        \----------------*/
      131     7369
      132     7370    4              CASE (%CP6_INDEXED);

      133     7371
      134     7372    4                FAB.B.SHARED_INDEX_ALT = %NO#;     /*#29480*/

   7372  3 000164   000011 236000 4                  LDQ     9
         3 000165   000032 356100                    ANSQ    26,,PR0

      135     7373    4                START.V.KEYS# = YES#;

   7373  3 000166   400000 236007                    LDQ     -131072,DL
         3 000167   000006 256000 1                  ORSQ    START+6

      136     7374    4                START.V.KEYR# = YES#;

   7374  3 000170   200000 236007                    LDQ     65536,DL
         3 000171   000006 256000 1                  ORSQ    START+6

      137     7375    4                START.V.N#    = 0;

   7375  3 000172   000007 450000 1                  STZ     START+7

      138     7376    4                PRIME_KEYX = POFFC (FAB.RECORD_KEY$, FAB.BUFFER$);

   7376  3 000173   000052 236100                    LDQ     42,,PR0
         3 000174   000020 772000                    QRL     16
         3 000175   200452 756100                    STQ     TWOBYTES+5,,AUTO
         3 000176   000054 236100                    LDQ     44,,PR0
         3 000177   000020 772000                    QRL     16
         3 000200   200452 136100                    SBLQ    TWOBYTES+5,,AUTO
         3 000201   200037 756100                    STQ     PRIME_KEYX,,AUTO

      139     7377    4                IF KEY_OFFSET = PRIME_KEYX THEN
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:42   

   7377  3 000202   200006 475500                    LDP5    @KEY_OFFSET,,AUTO
         3 000203   500000 116100                    CMPQ    0,,PR5
         3 000204   000270 601000 3                  TNZ     FIND_ALT_KEY

      140     7378    5                  DO;

      141     7379    5                    TEMP_LEN = FAB.RECORD_KEY_LEN;

   7379  3 000205   000031 235100                    LDA     25,,PR0
         3 000206   200444 755100                    STA     TEMP_LEN,,AUTO

      142     7380    5                    IF TEMP_LEN = KEY_LEN THEN

   7380  3 000207   200007 476500                    LDP6    @KEY_LEN,,AUTO
         3 000210   200444 236100                    LDQ     TEMP_LEN,,AUTO
         3 000211   600000 116100                    CMPQ    0,,PR6
         3 000212   000227 601000 3                  TNZ     s:7388

      143     7381    6                      DO;

      144     7382    6                        SUB_KEY = NO#;

   7382  3 000213   200143 450100                    STZ     SUB_KEY,,AUTO

      145     7383    6                        TEMP_INDX = INDEX_KEY;

   7383  3 000214   000054 477500                    LDP7    44,,PR0
         3 000215   600000 720100                    LXL0    0,,PR6
         3 000216   040100 100540                    MLR     fill='040'O
         3 000217   700000 000010                    ADSC9   0,,PR7                   cn=0,n=*X0
         3 000220   200144 000377                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=255

      146     7384    6                        SAVE_INDX = INDEX_KEY; /* save sending key for */

   7384  3 000221   000054 477500                    LDP7    44,,PR0
         3 000222   600000 720100                    LXL0    0,,PR6
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:43   
         3 000223   040100 100540                    MLR     fill='040'O
         3 000224   700000 000010                    ADSC9   0,,PR7                   cn=0,n=*X0
         3 000225   200244 000377                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=255

      147     7385    6                      END;                     /* duplicate compares   */

   7385  3 000226   000256 710000 3                  TRA     s:7396

      148     7386    5                    ELSE
      149     7387    6                      DO;     /*  we have a subkey */

      150     7388    6                        SUB_KEY = YES#;

   7388  3 000227   400000 236003                    LDQ     -131072,DU
         3 000230   200143 756100                    STQ     SUB_KEY,,AUTO

      151     7389    6                        TEMP_INDX = INDEX_KEY;

   7389  3 000231   000054 477500                    LDP7    44,,PR0
         3 000232   600000 720100                    LXL0    0,,PR6
         3 000233   040100 100540                    MLR     fill='040'O
         3 000234   700000 000010                    ADSC9   0,,PR7                   cn=0,n=*X0
         3 000235   200144 000377                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=255

      152     7390    6                        SAVE_INDX = INDEX_KEY;

   7390  3 000236   000054 477500                    LDP7    44,,PR0
         3 000237   600000 720100                    LXL0    0,,PR6
         3 000240   040100 100540                    MLR     fill='040'O
         3 000241   700000 000010                    ADSC9   0,,PR7                   cn=0,n=*X0
         3 000242   200244 000377                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=255

      153     7391                             /* Move LOW-VALUES to unused part */  /*#40798*/
      154     7392    7                        DO I = KEY_LEN TO TEMP_LEN - 1;

   7392  3 000243   600000 235100                    LDA     0,,PR6
         3 000244   200040 755100                    STA     I,,AUTO
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:44   
         3 000245   000253 710000 3                  TRA     s:7394+1

      155     7393    7                          SUBSTR (TEMP_INDX,I,1) = BINASC(0);

   7393  3 000246   200040 235100                    LDA     I,,AUTO
         3 000247   040105 100400                    MLR     fill='040'O
         3 000250   000012 000001 4                  ADSC9   10                       cn=0,n=1
         3 000251   200144 000001                    ADSC9   TEMP_INDX,A,AUTO         cn=0,n=1

      156     7394    7                        END;

   7394  3 000252   200040 054100                    AOS     I,,AUTO
         3 000253   200040 236100                    LDQ     I,,AUTO
         3 000254   200444 116100                    CMPQ    TEMP_LEN,,AUTO
         3 000255   000246 604000 3                  TMI     s:7393

      157     7395    6                      END;

      158     7396    5                    START.V.INDX# = %PRIMARY_KEY;

   7396  3 000256   000001 236007                    LDQ     1,DL
         3 000257   000006 552004 1                  STBQ    START+6,'04'O

      159     7397    5                    START.KEY_  = VECTOR (SUBSTR (TEMP_INDX,0,TEMP_LEN));

   7397  3 000260   200444 235100                    LDA     TEMP_LEN,,AUTO
         3 000261   000020 735000                    ALS     16
         3 000262   000140 135007                    SBLA    96,DL
         3 000263   200452 452500                    STP2    TWOBYTES+5,,AUTO
         3 000264   200452 236100                    LDQ     TWOBYTES+5,,AUTO
         3 000265   000144 036003                    ADLQ    100,DU
         3 000266   000002 757000 1                  STAQ    START+2

      160     7398    5                  END;

   7398  3 000267   000504 710000 3                  TRA     s:7457

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:45   
      161     7399    4                ELSE  /* we have an alternate key */
      162     7400        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:46   
      163     7401        /*----------------\
      164     7402        |  INDEXed Start  |
      165     7403        \----------------*/
      166     7404
      167     7405    5   FIND_ALT_KEY:  DO  I = 0 TO ALT_KEYS.SIZ# - 1;

   7405  3 000270   200040 450100       FIND_ALT_KEY STZ     I,,AUTO
         3 000271   000477 710000 3                  TRA     s:7455+1

      168     7406    5                    IF KEY_OFFSET = ALT_KEYS.K.KEYX# (I) THEN

   7406  3 000272   200003 470500                    LDP0    @FAB,,AUTO
         3 000273   000055 471500                    LDP1    45,,PR0
         3 000274   200006 473500                    LDP3    @KEY_OFFSET,,AUTO
         3 000275   200040 720100                    LXL0    I,,AUTO
         3 000276   100001 236110                    LDQ     1,X0,PR1
         3 000277   777777 376007                    ANQ     -1,DL
         3 000300   300000 116100                    CMPQ    0,,PR3
         3 000301   000476 601000 3                  TNZ     s:7455

      169     7407    6                      DO;

      170     7408    6                        TEMP_LEN = ALT_KEYS.K.KEYL# (I);

   7408  3 000302   100001 236110                    LDQ     1,X0,PR1
         3 000303   000022 772000                    QRL     18
         3 000304   000777 376007                    ANQ     511,DL
         3 000305   200444 756100                    STQ     TEMP_LEN,,AUTO

      171     7409    6                        ALT_INDX$ = PINCRC (FAB.BUFFER$, ALT_KEYS.K.KEYX#(I));

   7409  3 000306   100001 236110                    LDQ     1,X0,PR1
         3 000307   777777 376007                    ANQ     -1,DL
         3 000310   000052 474500                    LDP4    42,,PR0
         3 000311   000011 402007                    MPY     9,DL
         3 000312   400000 503506                    ABD     0,QL,PR4
         3 000313   200142 454500                    STP4    ALT_INDX$,,AUTO
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:47   

      172     7410    6                        IF TEMP_LEN = KEY_LEN THEN

   7410  3 000314   200007 475500                    LDP5    @KEY_LEN,,AUTO
         3 000315   200444 236100                    LDQ     TEMP_LEN,,AUTO
         3 000316   500000 116100                    CMPQ    0,,PR5
         3 000317   000335 601000 3                  TNZ     s:7419

      173     7411    7                          DO;

      174     7412    7                            SUB_KEY = NO#;

   7412  3 000320   200143 450100                    STZ     SUB_KEY,,AUTO

      175     7413    7                            TEMP_INDX = ALT_INDX;

   7413  3 000321   500000 721100                    LXL1    0,,PR5
         3 000322   040100 100540                    MLR     fill='040'O
         3 000323   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         3 000324   200144 000377                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=255

      176     7414    7                            SAVE_INDX = ALT_INDX;

   7414  3 000325   500000 721100                    LXL1    0,,PR5
         3 000326   040100 100540                    MLR     fill='040'O
         3 000327   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         3 000330   200244 000377                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=255

      177     7415    7                            START.V.INDX# = I + 2;

   7415  3 000331   200040 236100                    LDQ     I,,AUTO
         3 000332   000002 036007                    ADLQ    2,DL
         3 000333   000006 552004 1                  STBQ    START+6,'04'O

      178     7416    7                          END;

   7416  3 000334   000444 710000 3                  TRA     s:7445
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:48   

      179     7417    6                        ELSE
      180     7418    7                          DO;

      181     7419    7                            SUB_KEY = YES#;

   7419  3 000335   400000 236003                    LDQ     -131072,DU
         3 000336   200143 756100                    STQ     SUB_KEY,,AUTO

      182     7420    7                            TEMP_INDX = ALT_INDX;

   7420  3 000337   500000 721100                    LXL1    0,,PR5
         3 000340   040100 100540                    MLR     fill='040'O
         3 000341   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         3 000342   200144 000377                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=255

      183     7421    7                            SAVE_INDX = ALT_INDX;

   7421  3 000343   500000 721100                    LXL1    0,,PR5
         3 000344   040100 100540                    MLR     fill='040'O
         3 000345   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         3 000346   200244 000377                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=255

      184     7422    7                            START.V.INDX# = I + 2;

   7422  3 000347   200040 236100                    LDQ     I,,AUTO
         3 000350   000002 036007                    ADLQ    2,DL
         3 000351   000006 552004 1                  STBQ    START+6,'04'O

      185     7423    7             /*#37958*/     IF   START_CODE = %START_GREATER_THAN

   7423  3 000352   200005 471500                    LDP1    @START_CODE,,AUTO
         3 000353   100000 235100                    LDA     0,,PR1
         3 000354   000001 115007                    CMPA    1,DL
         3 000355   000430 601000 3                  TNZ     s:7441

      186     7424    8             /*#37958*/     THEN DO;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:49   

      187     7425    8             /*#37958*/          I = TEMP_LEN;

   7425  3 000356   200444 235100                    LDA     TEMP_LEN,,AUTO
         3 000357   200040 755100                    STA     I,,AUTO

      188     7426    9             /*#37958*/          DO  UNTIL (ONEBYTE.HIBYTE = 0 OR I = 0);

      189     7427    9             /*#37958*/              I = I - 1;

   7427  3 000360   000001 336007                    LCQ     1,DL
         3 000361   200040 056100                    ASQ     I,,AUTO

      190     7428    9             /*#37958*/              TWOBYTES = ASCBIN(SUBSTR(TEMP_INDX,I,1));

   7428  3 000362   200040 235100                    LDA     I,,AUTO
         3 000363   000100 101505                    MRL     fill='000'O
         3 000364   200144 000001                    ADSC9   TEMP_INDX,A,AUTO         cn=0,n=1
         3 000365   200452 000004                    ADSC9   TWOBYTES+5,,AUTO         cn=0,n=4
         3 000366   200452 236100                    LDQ     TWOBYTES+5,,AUTO
         3 000367   000000 620006                    EAX0    0,QL
         3 000370   200445 740100                    STX0    TWOBYTES,,AUTO

      191     7429    9             /*#37958*/              TWOBYTES = TWOBYTES + 1;

   7429  3 000371   000001 621010                    EAX1    1,X0
         3 000372   200445 741100                    STX1    TWOBYTES,,AUTO

      192     7430    9             /*#37958*/              SUBSTR(TEMP_INDX,I,1) = BINASC(ONEBYTE.LOBYTE);

   7430  3 000373   200445 236100                    LDQ     TWOBYTES,,AUTO
         3 000374   000022 772000                    QRL     18
         3 000375   000777 376007                    ANQ     511,DL
         3 000376   000033 736000                    QLS     27
         3 000377   000012 276000 4                  ORQ     10
         3 000400   200452 756100                    STQ     TWOBYTES+5,,AUTO
         3 000401   040105 100500                    MLR     fill='040'O
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:50   
         3 000402   200452 000004                    ADSC9   TWOBYTES+5,,AUTO         cn=0,n=4
         3 000403   200144 000001                    ADSC9   TEMP_INDX,A,AUTO         cn=0,n=1

      193     7431    9             /*#37958*/          END; /* DO  UNTIL ...                      */

   7431  3 000404   200445 236100                    LDQ     TWOBYTES,,AUTO
         3 000405   777000 316003                    CANQ    -512,DU
         3 000406   000411 600000 3                  TZE     s:7432
         3 000407   000000 115003                    CMPA    0,DU
         3 000410   000360 601000 3                  TNZ     s:7427

      194     7432    8             /*#37958*/          IF   ONEBYTE.HIBYTE ~= 0

   7432  3 000411   777000 316003                    CANQ    -512,DU
         3 000412   000430 600000 3                  TZE     s:7441

      195     7433    8             /*#37958*/          THEN
      196     7434    9             /*#37958*/               DO;

      197     7435    9             /*#37958*/               IO_STATUS = %NO_RANDOM_RECORD;

   7435  3 000413   200003 470500                    LDP0    @FAB,,AUTO
         3 000414   000036 471500                    LDP1    30,,PR0
         3 000415   040100 100400                    MLR     fill='040'O
         3 000416   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 000417   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      198     7436    9             /*#37958*/               FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7436  3 000420   000002 236003                    LDQ     2,DU
         3 000421   000032 256100                    ORSQ    26,,PR0

      199     7437    9             /*#37958*/               CALL X9WE$IO_ERROR_STATUS(FAB,ALT_RET)

   7437  3 000422   200003 630500                    EPPR0   @FAB,,AUTO
         3 000423   000000 631400 4                  EPPR1   0
         3 000424   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:51   
         3 000425   000427 702000 3                  TSX2    s:7438
         3 000426   000430 710000 3                  TRA     s:7441

      200     7438   10             /*#37958*/                    WHENALTRETURN DO; ALTRETURN; END;

   7438  3 000427   000000 702200 xent               TSX2  ! X66_AALT

      201     7439    9             /*#37958*/               END;

      202     7440    8             /*#37958*/          END;

      203     7441    8                            DO   I = KEY_LEN TO TEMP_LEN - 1;           /*#37958*/

   7441  3 000430   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 000431   000000 235100                    LDA     0,,PR0
         3 000432   200040 755100                    STA     I,,AUTO
         3 000433   000441 710000 3                  TRA     s:7443+1

      204     7442    8                              SUBSTR (TEMP_INDX,I,1) = BINASC(0);

   7442  3 000434   200040 235100                    LDA     I,,AUTO
         3 000435   040105 100400                    MLR     fill='040'O
         3 000436   000012 000001 4                  ADSC9   10                       cn=0,n=1
         3 000437   200144 000001                    ADSC9   TEMP_INDX,A,AUTO         cn=0,n=1

      205     7443    8                            END;

   7443  3 000440   200040 054100                    AOS     I,,AUTO
         3 000441   200040 236100                    LDQ     I,,AUTO
         3 000442   200444 116100                    CMPQ    TEMP_LEN,,AUTO
         3 000443   000434 604000 3                  TMI     s:7442

      206     7444    7                          END;

      207     7445    6                        START.KEY_ = VECTOR (SUBSTR (TEMP_INDX,0,TEMP_LEN));

   7445  3 000444   200444 235100                    LDA     TEMP_LEN,,AUTO
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:52   
         3 000445   000020 735000                    ALS     16
         3 000446   000140 135007                    SBLA    96,DL
         3 000447   200452 452500                    STP2    TWOBYTES+5,,AUTO
         3 000450   200452 236100                    LDQ     TWOBYTES+5,,AUTO
         3 000451   000144 036003                    ADLQ    100,DU
         3 000452   000002 757000 1                  STAQ    START+2

      208     7446    6                        IF M$XX.SHARE# ~= %NONE THEN           /*#24102*/

   7446  3 000453   200010 470500                    LDP0    DCB$,,AUTO
         3 000454   000031 236100                    LDQ     25,,PR0
         3 000455   000600 376007                    ANQ     384,DL
         3 000456   000600 116007                    CMPQ    384,DL
         3 000457   000475 600000 3                  TZE     s:7453

      209     7447    7                          DO;

      210     7448    7                            FAB.B.SHARED_INDEX_ALT = %YES#;

   7448  3 000460   200003 471500                    LDP1    @FAB,,AUTO
         3 000461   100000 236007                    LDQ     32768,DL
         3 000462   100032 256100                    ORSQ    26,,PR1

      211     7449    7                            FAB.B.REPOSITION = %NO#;

   7449  3 000463   000013 236000 4                  LDQ     11
         3 000464   100032 356100                    ANSQ    26,,PR1

      212     7450    7                            SHARED.INDX = START.V.INDX# - 2;

   7450  3 000465   100037 473500                    LDP3    31,,PR1
         3 000466   000006 236000 1                  LDQ     START+6
         3 000467   000777 376007                    ANQ     511,DL
         3 000470   000002 136007                    SBLQ    2,DL
         3 000471   300003 756100                    STQ     3,,PR3

      213     7451    7                            SHARED.RECNUM = 1;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:53   

   7451  3 000472   100037 473500                    LDP3    31,,PR1
         3 000473   000001 236007                    LDQ     1,DL
         3 000474   300002 756100                    STQ     2,,PR3

      214     7452    7                          END;

      215     7453    6                        EXIT FIND_ALT_KEY;

   7453  3 000475   000504 710000 3                  TRA     s:7457

      216     7454    6                      END;
      217     7455    5                  END;

   7455  3 000476   200040 054100                    AOS     I,,AUTO
         3 000477   000055 471500                    LDP1    45,,PR0
         3 000500   200040 236100                    LDQ     I,,AUTO
         3 000501   000272 604000 3                  TMI     s:7406
         3 000502   100000 116100                    CMPQ    0,,PR1
         3 000503   000272 602000 3                  TNC     s:7406

      218     7456
      219     7457    5                DO I = 0 TO TEMP_LEN - 1;

   7457  3 000504   200040 450100                    STZ     I,,AUTO
         3 000505   000513 710000 3                  TRA     s:7459+1

      220     7458    5                  SUBSTR (LOW_VALUE,I,1) = BINASC (0);

   7458  3 000506   200040 235100                    LDA     I,,AUTO
         3 000507   040105 100400                    MLR     fill='040'O
         3 000510   000012 000001 4                  ADSC9   10                       cn=0,n=1
         3 000511   200344 000001                    ADSC9   LOW_VALUE,A,AUTO         cn=0,n=1

      221     7459    5                END;

   7459  3 000512   200040 054100                    AOS     I,,AUTO
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:54   
         3 000513   200040 236100                    LDQ     I,,AUTO
         3 000514   200444 116100                    CMPQ    TEMP_LEN,,AUTO
         3 000515   000506 604000 3                  TMI     s:7458

      222     7460        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:55   
      223     7461        /*----------------\
      224     7462        |  INDEXed Start  |
      225     7463        \----------------*/
      226     7464
      227     7465    5                DO CASE  (START_CODE);

   7465  3 000516   200005 470500                    LDP0    @START_CODE,,AUTO
         3 000517   000000 235100                    LDA     0,,PR0
         3 000520   000003 115007                    CMPA    3,DL
         3 000521   000523 602005 3                  TNC     s:7465+5,AL
         3 000522   001074 710000 3                  TRA     s:7669
         3 000523   000526 710000 3                  TRA     s:7469
         3 000524   000570 710000 3                  TRA     s:7505
         3 000525   000547 710000 3                  TRA     s:7487

      228     7466
      229     7467    5                  CASE  (%START_EQUAL);

      230     7468
      231     7469    5                    CALL POS_REC

   7469  3 000526   001274 701000 3                  TSX1    POS_REC
         3 000527   000531 702000 3                  TSX2    s:7472
         3 000530   000546 710000 3                  TRA     s:7479

      232     7470    5                    WHENALTRETURN
      233     7471    6                      DO;

      234     7472    6                        IF  SUBSTR (TEMP_INDX,0,KEY_LEN) ~=

   7472  3 000531   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 000532   000000 720100                    LXL0    0,,PR0
         3 000533   000000 721100                    LXL1    0,,PR0
         3 000534   040140 106540                    CMPC    fill='040'O
         3 000535   200144 000010                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=*X0
         3 000536   200244 000011                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=*X1
         3 000537   000546 600000 3                  TZE     s:7479
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:56   

      235     7473    6                            SUBSTR (SAVE_INDX,0,KEY_LEN) THEN
      236     7474    6                          CALL X9WE$IO_ERROR (FAB, ALT_RET)

   7474  3 000540   200003 630500                    EPPR0   @FAB,,AUTO
         3 000541   000000 631400 4                  EPPR1   0
         3 000542   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000543   000545 702000 3                  TSX2    s:7477
         3 000544   000546 710000 3                  TRA     s:7479

      237     7475    6                            WHENALTRETURN
      238     7476    7                              DO;

      239     7477    7                                ALTRETURN;

   7477  3 000545   000000 702200 xent               TSX2  ! X66_AALT

      240     7478    7                              END;
      241     7479    6                      END;

   7479  3 000546   001074 710000 3                  TRA     s:7669

      242     7480        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:57   
      243     7481        /*----------------\
      244     7482        |  INDEXed Start  |
      245     7483        \----------------*/
      246     7484
      247     7485    5                  CASE  (%START_GREATER_THAN_EQUAL);

      248     7486
      249     7487    5                    CALL POS_REC

   7487  3 000547   001274 701000 3                  TSX1    POS_REC
         3 000550   000552 702000 3                  TSX2    s:7490
         3 000551   000567 710000 3                  TRA     s:7497

      250     7488    5                      WHENALTRETURN
      251     7489    6                        DO;

      252     7490    6                          IF SUBSTR (TEMP_INDX,0,KEY_LEN) =

   7490  3 000552   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 000553   000000 720100                    LXL0    0,,PR0
         3 000554   000000 721100                    LXL1    0,,PR0
         3 000555   040140 106540                    CMPC    fill='040'O
         3 000556   200144 000010                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=*X0
         3 000557   200344 000011                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X1
         3 000560   000567 601000 3                  TNZ     s:7497

      253     7491    6                             SUBSTR (LOW_VALUE,0,KEY_LEN) THEN
      254     7492    6                            CALL X9WE$IO_ERROR (FAB, ALT_RET)

   7492  3 000561   200003 630500                    EPPR0   @FAB,,AUTO
         3 000562   000000 631400 4                  EPPR1   0
         3 000563   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000564   000566 702000 3                  TSX2    s:7495
         3 000565   000567 710000 3                  TRA     s:7497

      255     7493    6                              WHENALTRETURN
      256     7494    7                                DO;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:58   

      257     7495    7                                  ALTRETURN;

   7495  3 000566   000000 702200 xent               TSX2  ! X66_AALT

      258     7496    7                            END;
      259     7497    6                        END;

   7497  3 000567   001074 710000 3                  TRA     s:7669

      260     7498        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:59   
      261     7499        /*----------------\
      262     7500        |  INDEXed Start  |
      263     7501        \----------------*/
      264     7502
      265     7503    5                  CASE  (%START_GREATER_THAN);

      266     7504
      267     7505    5                    CALL POS_REC

   7505  3 000570   001274 701000 3                  TSX1    POS_REC
         3 000571   000620 702000 3                  TSX2    s:7529

      268     7506    5                      WHENRETURN
      269     7507    6                        DO WHILE  (SUBSTR (TEMP_INDX,0,KEY_LEN)  =

   7507  3 000572   000610 710000 3                  TRA     s:7521

      270     7508    6                                   SUBSTR (SAVE_INDX,0,KEY_LEN));
      271     7509    6                          IF FAB.B.SHARED_INDEX_ALT THEN       /*#24102*/

   7509  3 000573   200003 470500                    LDP0    @FAB,,AUTO
         3 000574   000032 236100                    LDQ     26,,PR0
         3 000575   100000 316007                    CANQ    32768,DL
         3 000576   000604 600000 3                  TZE     s:7516

      272     7510    6                            CALL GREATER_ADVANCE_SHARED

   7510  3 000577   001105 701000 3                  TSX1    GREATER_ADVANCE_SHARED
         3 000600   000602 702000 3                  TSX2    s:7513
         3 000601   000603 710000 3                  TRA     s:7513+1

      273     7511    6                              WHENALTRETURN
      274     7512    7                                DO;

      275     7513    7                                  ALTRETURN;

   7513  3 000602   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:60   
         3 000603   000610 710000 3                  TRA     s:7521

      276     7514    7                                END;
      277     7515    6                          ELSE
      278     7516    6                            CALL GREATER_ADVANCE

   7516  3 000604   001223 701000 3                  TSX1    GREATER_ADVANCE
         3 000605   000607 702000 3                  TSX2    s:7519
         3 000606   000610 710000 3                  TRA     s:7521

      279     7517    6                              WHENALTRETURN
      280     7518    7                                DO;

      281     7519    7                                  ALTRETURN;

   7519  3 000607   000000 702200 xent               TSX2  ! X66_AALT

      282     7520    7                                END;
      283     7521    6                        END; /* while not a duplicate index */

   7521  3 000610   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 000611   000000 720100                    LXL0    0,,PR0
         3 000612   000000 721100                    LXL1    0,,PR0
         3 000613   040140 106540                    CMPC    fill='040'O
         3 000614   200144 000010                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=*X0
         3 000615   200244 000011                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=*X1
         3 000616   000573 600000 3                  TZE     s:7509
         3 000617   000665 710000 3                  TRA     s:7547

      284     7522        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:61   
      285     7523        /*----------------\
      286     7524        |  INDEXed Start  |
      287     7525        \----------------*/
      288     7526
      289     7527    5                      WHENALTRETURN
      290     7528    6                        DO;

      291     7529    6                          IF SUBSTR (TEMP_INDX,0,KEY_LEN)  =

   7529  3 000620   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 000621   000000 720100                    LXL0    0,,PR0
         3 000622   000000 721100                    LXL1    0,,PR0
         3 000623   040140 106540                    CMPC    fill='040'O
         3 000624   200144 000010                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=*X0
         3 000625   200344 000011                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X1
         3 000626   000636 601000 3                  TNZ     s:7537

      292     7530    6                             SUBSTR (LOW_VALUE,0,KEY_LEN) THEN
      293     7531    6                            CALL X9WE$IO_ERROR (FAB, ALT_RET)

   7531  3 000627   200003 630500                    EPPR0   @FAB,,AUTO
         3 000630   000000 631400 4                  EPPR1   0
         3 000631   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000632   000634 702000 3                  TSX2    s:7534
         3 000633   000635 710000 3                  TRA     s:7534+1

      294     7532    6                              WHENALTRETURN
      295     7533    7                                DO;

      296     7534    7                                  ALTRETURN;

   7534  3 000634   000000 702200 xent               TSX2  ! X66_AALT
         3 000635   000665 710000 3                  TRA     s:7547

      297     7535    7                                END;
      298     7536    6                          ELSE
      299     7537    6                            IF SUB_KEY THEN
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:62   

   7537  3 000636   200143 234100                    SZN     SUB_KEY,,AUTO
         3 000637   000665 605000 3                  TPL     s:7547

      300     7538    7                              DO WHILE  (SUBSTR (TEMP_INDX,0,KEY_LEN) =

   7538  3 000640   000656 710000 3                  TRA     s:7545

      301     7539    7                                         SUBSTR (SAVE_INDX,0,KEY_LEN));
      302     7540    7                                IF   FAB.B.SHARED_INDEX_ALT             /*#37958*/

   7540  3 000641   200003 470500                    LDP0    @FAB,,AUTO
         3 000642   000032 236100                    LDQ     26,,PR0
         3 000643   100000 316007                    CANQ    32768,DL
         3 000644   000652 600000 3                  TZE     s:7543

      303     7541    7                                THEN CALL GREATER_ADVANCE_SHARED        /*#37958*/

   7541  3 000645   001105 701000 3                  TSX1    GREATER_ADVANCE_SHARED
         3 000646   000650 702000 3                  TSX2    s:7542
         3 000647   000651 710000 3                  TRA     s:7542+1

      304     7542    8                                     WHENALTRETURN DO; ALTRETURN; END;  /*#37958*/

   7542  3 000650   000000 702200 xent               TSX2  ! X66_AALT
         3 000651   000656 710000 3                  TRA     s:7545

      305     7543    7                                ELSE CALL GREATER_ADVANCE               /*#37958*/

   7543  3 000652   001223 701000 3                  TSX1    GREATER_ADVANCE
         3 000653   000655 702000 3                  TSX2    s:7544
         3 000654   000656 710000 3                  TRA     s:7545

      306     7544    8                                     WHENALTRETURN DO; ALTRETURN; END;  /*#37958*/

   7544  3 000655   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:63   
      307     7545    7                              END; /* WHILE */

   7545  3 000656   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 000657   000000 720100                    LXL0    0,,PR0
         3 000660   000000 721100                    LXL1    0,,PR0
         3 000661   040140 106540                    CMPC    fill='040'O
         3 000662   200144 000010                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=*X0
         3 000663   200244 000011                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=*X1
         3 000664   000641 600000 3                  TZE     s:7540

      308     7546    6                        END;

      309     7547    5                END;  /* case start_code */

   7547  3 000665   001074 710000 3                  TRA     s:7669

      310     7548        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:64   
      311     7549        /*--------------\
      312     7550        |  KEYed Start  |
      313     7551        \--------------*/
      314     7552
      315     7553    4               CASE (%CP6_KEYED);

      316     7554
      317     7555    4                 KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;

   7555  3 000666   000031 236100                    LDQ     25,,PR0
         3 000667   000033 736000                    QLS     27
         3 000670   200042 552140                    STBQ    KEYED_KEY,'40'O,AUTO

      318     7556    4                 KEYED_KEY.TEXT   = KEY_TEXT;

   7556  3 000671   000054 475500                    LDP5    44,,PR0
         3 000672   200042 236100                    LDQ     KEYED_KEY,,AUTO
         3 000673   000033 772000                    QRL     27
         3 000674   000000 620006                    EAX0    0,QL
         3 000675   040100 100540                    MLR     fill='040'O
         3 000676   500000 000010                    ADSC9   0,,PR5                   cn=0,n=*X0
         3 000677   200042 200377                    ADSC9   KEYED_KEY,,AUTO          cn=1,n=255

      319     7557    4                 START.KEY_       = VECTOR (KEYED_KEY);

   7557  3 000700   000014 235000 4                  LDA     12
         3 000701   200452 452500                    STP2    TWOBYTES+5,,AUTO
         3 000702   200452 236100                    LDQ     TWOBYTES+5,,AUTO
         3 000703   000042 036003                    ADLQ    34,DU
         3 000704   000002 757000 1                  STAQ    START+2

      320     7558    4                 START.V.KEYS#      = YES#;

   7558  3 000705   400000 236007                    LDQ     -131072,DL
         3 000706   000006 256000 1                  ORSQ    START+6

      321     7559    4                 START.V.KEYR#      = YES#;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:65   

   7559  3 000707   200000 236007                    LDQ     65536,DL
         3 000710   000006 256000 1                  ORSQ    START+6

      322     7560    4                 START.V.N#    = 0;

   7560  3 000711   000007 450000 1                  STZ     START+7

      323     7561
      324     7562    5                 DO I = 0 TO FAB.RECORD_KEY_LEN - 1;

   7562  3 000712   200040 450100                    STZ     I,,AUTO
         3 000713   000721 710000 3                  TRA     s:7564+1

      325     7563    5                   SUBSTR (LOW_VALUE,I,1) =  BINASC(0);

   7563  3 000714   200040 235100                    LDA     I,,AUTO
         3 000715   040105 100400                    MLR     fill='040'O
         3 000716   000012 000001 4                  ADSC9   10                       cn=0,n=1
         3 000717   200344 000001                    ADSC9   LOW_VALUE,A,AUTO         cn=0,n=1

      326     7564    5                 END;

   7564  3 000720   200040 054100                    AOS     I,,AUTO
         3 000721   200003 470500                    LDP0    @FAB,,AUTO
         3 000722   200040 236100                    LDQ     I,,AUTO
         3 000723   000031 116100                    CMPQ    25,,PR0
         3 000724   000714 604000 3                  TMI     s:7563

      327     7565
      328     7566    5                 DO CASE (START_CODE);

   7566  3 000725   200005 471500                    LDP1    @START_CODE,,AUTO
         3 000726   100000 235100                    LDA     0,,PR1
         3 000727   000003 115007                    CMPA    3,DL
         3 000730   000732 602005 3                  TNC     s:7566+5,AL
         3 000731   001070 710000 3                  TRA     s:7662
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:66   
         3 000732   001025 710000 3                  TRA     s:7628
         3 000733   000735 710000 3                  TRA     s:7574
         3 000734   001042 710000 3                  TRA     s:7644

      329     7567        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:67   
      330     7568        /*--------------\
      331     7569        |  KEYed Start  |
      332     7570        \--------------*/
      333     7571
      334     7572    5                   CASE (%START_GREATER_THAN);

      335     7573
      336     7574    5                     CALL POS_REC

   7574  3 000735   001274 701000 3                  TSX1    POS_REC
         3 000736   001000 702000 3                  TSX2    s:7610

      337     7575    5                      WHENRETURN
      338     7576    6                       DO;

      339     7577    6                         START.V.KEYS# = %NO#;

   7577  3 000737   000015 236000 4                  LDQ     13
         3 000740   000006 356000 1                  ANSQ    START+6

      340     7578    6                         START.V.N#    = 1;

   7578  3 000741   000001 235007                    LDA     1,DL
         3 000742   000007 755000 1                  STA     START+7

      341     7579    6                         CALL POS_REC

   7579  3 000743   001274 701000 3                  TSX1    POS_REC
         3 000744   000770 702000 3                  TSX2    s:7599

      342     7580    6                         WHENRETURN
      343     7581    7                           DO;

      344     7582    7                             IF KEYED_KEY.LENGTH = 0 THEN

   7582  3 000745   200042 236100                    LDQ     KEYED_KEY,,AUTO
         3 000746   777000 316003                    CANQ    -512,DU
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:68   
         3 000747   000767 601000 3                  TNZ     s:7591

      345     7583    8                               DO;

      346     7584    8                                 FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7584  3 000750   200003 470500                    LDP0    @FAB,,AUTO
         3 000751   000002 236003                    LDQ     2,DU
         3 000752   000032 256100                    ORSQ    26,,PR0

      347     7585    8                                 IO_STATUS = %NO_RANDOM_RECORD;

   7585  3 000753   000036 471500                    LDP1    30,,PR0
         3 000754   040100 100400                    MLR     fill='040'O
         3 000755   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 000756   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      348     7586    8                                 IF ALT_RET THEN

   7586  3 000757   200004 471500                    LDP1    @ALT_RET,,AUTO
         3 000760   100000 234100                    SZN     0,,PR1
         3 000761   000763 605000 3                  TPL     s:7589

      349     7587    8                                   ALTRETURN; /* invalid key clause */

   7587  3 000762   000000 702200 xent               TSX2  ! X66_AALT

      350     7588    8                                 ELSE
      351     7589    8                                   CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);

   7589  3 000763   200003 630500                    EPPR0   @FAB,,AUTO
         3 000764   000000 631400 4                  EPPR1   0
         3 000765   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 000766   000000 011000                    NOP     0

      352     7590    8                               END;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:69   
      353     7591    7                           END;

   7591  3 000767   000777 710000 3                  TRA     s:7602

      354     7592        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:70   
      355     7593        /*--------------\
      356     7594        |  KEYed Start  |
      357     7595        \--------------*/
      358     7596
      359     7597    6                         WHENALTRETURN
      360     7598    7                           DO;

      361     7599    7                             FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7599  3 000770   200003 470500                    LDP0    @FAB,,AUTO
         3 000771   000002 236003                    LDQ     2,DU
         3 000772   000032 256100                    ORSQ    26,,PR0

      362     7600    7                             CALL X9WE$IO_ERROR (FAB);

   7600  3 000773   200003 630500                    EPPR0   @FAB,,AUTO
         3 000774   000016 631400 4                  EPPR1   14
         3 000775   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 000776   000000 011000                    NOP     0

      363     7601    7                           END;

      364     7602    6                       END;

   7602  3 000777   001024 710000 3                  TRA     s:7620+1

      365     7603        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:71   
      366     7604        /*--------------\
      367     7605        |  KEYed Start  |
      368     7606        \--------------*/
      369     7607
      370     7608    5                     WHENALTRETURN
      371     7609    6                       DO;

      372     7610    6                         IF KEYED_KEY.LENGTH = 0 THEN

   7610  3 001000   200042 236100                    LDQ     KEYED_KEY,,AUTO
         3 001001   777000 316003                    CANQ    -512,DU
         3 001002   001023 601000 3                  TNZ     s:7620

      373     7611    7                           DO;

      374     7612    7                             FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7612  3 001003   200003 470500                    LDP0    @FAB,,AUTO
         3 001004   000002 236003                    LDQ     2,DU
         3 001005   000032 256100                    ORSQ    26,,PR0

      375     7613    7                             IO_STATUS = %NO_RANDOM_RECORD;

   7613  3 001006   000036 471500                    LDP1    30,,PR0
         3 001007   040100 100400                    MLR     fill='040'O
         3 001010   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 001011   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      376     7614    7                             IF ALT_RET THEN

   7614  3 001012   200004 471500                    LDP1    @ALT_RET,,AUTO
         3 001013   100000 234100                    SZN     0,,PR1
         3 001014   001016 605000 3                  TPL     s:7617

      377     7615    7                               ALTRETURN;

   7615  3 001015   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:72   

      378     7616    7                             ELSE
      379     7617    7                               CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET);

   7617  3 001016   200003 630500                    EPPR0   @FAB,,AUTO
         3 001017   000000 631400 4                  EPPR1   0
         3 001020   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 001021   000000 011000                    NOP     0

      380     7618    7                           END;

   7618  3 001022   001024 710000 3                  TRA     s:7620+1

      381     7619    6                         ELSE
      382     7620    6                           RETURN;

   7620  3 001023   000000 702200 xent               TSX2  ! X66_ARET
         3 001024   001074 710000 3                  TRA     s:7669

      383     7621    6                       END;
      384     7622        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:73   
      385     7623        /*--------------\
      386     7624        |  KEYed Start  |
      387     7625        \--------------*/
      388     7626
      389     7627    5                   CASE (%START_EQUAL);

      390     7628    5                     CALL POS_REC

   7628  3 001025   001274 701000 3                  TSX1    POS_REC
         3 001026   001030 702000 3                  TSX2    s:7631
         3 001027   001041 710000 3                  TRA     s:7637

      391     7629    5                     WHENALTRETURN
      392     7630    6                       DO;

      393     7631    6                         FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7631  3 001030   200003 470500                    LDP0    @FAB,,AUTO
         3 001031   000002 236003                    LDQ     2,DU
         3 001032   000032 256100                    ORSQ    26,,PR0

      394     7632    6                         CALL X9WE$IO_ERROR (FAB, ALT_RET)

   7632  3 001033   200003 630500                    EPPR0   @FAB,,AUTO
         3 001034   000000 631400 4                  EPPR1   0
         3 001035   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 001036   001040 702000 3                  TSX2    s:7635
         3 001037   001041 710000 3                  TRA     s:7637

      395     7633    6                         WHENALTRETURN
      396     7634    7                           DO;

      397     7635    7                             ALTRETURN;    /*  INVALID KEY  */

   7635  3 001040   000000 702200 xent               TSX2  ! X66_AALT

      398     7636    7                           END;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:74   
      399     7637    6                       END;

   7637  3 001041   001074 710000 3                  TRA     s:7669

      400     7638        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:75   
      401     7639        /*--------------\
      402     7640        |  KEYed Start  |
      403     7641        \--------------*/
      404     7642
      405     7643    5                   CASE (%START_GREATER_THAN_EQUAL);

      406     7644    5                     CALL POS_REC

   7644  3 001042   001274 701000 3                  TSX1    POS_REC
         3 001043   001045 702000 3                  TSX2    s:7647
         3 001044   001067 710000 3                  TRA     s:7658+1

      407     7645    5                       WHENALTRETURN
      408     7646    6                         DO;

      409     7647    6                           IF KEYED_KEY.LENGTH = 0 THEN

   7647  3 001045   200042 236100                    LDQ     KEYED_KEY,,AUTO
         3 001046   777000 316003                    CANQ    -512,DU
         3 001047   001066 601000 3                  TNZ     s:7658

      410     7648    7                             DO;

      411     7649    7                               FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7649  3 001050   200003 470500                    LDP0    @FAB,,AUTO
         3 001051   000002 236003                    LDQ     2,DU
         3 001052   000032 256100                    ORSQ    26,,PR0

      412     7650    7                               IO_STATUS = %NO_RANDOM_RECORD;

   7650  3 001053   000036 471500                    LDP1    30,,PR0
         3 001054   040100 100400                    MLR     fill='040'O
         3 001055   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 001056   100000 000002                    ADSC9   0,,PR1                   cn=0,n=2

      413     7651    7                               CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET)
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:76   

   7651  3 001057   200003 630500                    EPPR0   @FAB,,AUTO
         3 001060   000000 631400 4                  EPPR1   0
         3 001061   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 001062   001064 702000 3                  TSX2    s:7654
         3 001063   001065 710000 3                  TRA     s:7656

      414     7652    7                               WHENALTRETURN
      415     7653    8                                 DO;

      416     7654    8                                   ALTRETURN;

   7654  3 001064   000000 702200 xent               TSX2  ! X66_AALT

      417     7655    8                                 END;
      418     7656    7                             END;

   7656  3 001065   001067 710000 3                  TRA     s:7658+1

      419     7657    6                           ELSE
      420     7658    6                             RETURN;

   7658  3 001066   000000 702200 xent               TSX2  ! X66_ARET
         3 001067   001074 710000 3                  TRA     s:7669

      421     7659    6                         END;
      422     7660
      423     7661    5                   CASE (ELSE);

      424     7662    5                     CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS:KEYED', 10);

   7662  3 001070   000020 630400 4                  EPPR0   16
         3 001071   000003 631400 4                  EPPR1   3
         3 001072   000000 701000 xent               TSX1    X8ER$ERROR
         3 001073   000000 011000                    NOP     0

      425     7663
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:77   
      426     7664    5                 END;  /* case start_code */

      427     7665    4             END; /* case m$xx.org# */

      428     7666    3           END; /* else do (if m$xx.fun# = %create) */

      429     7667    2         END; /* case fab.file_status */

      430     7668
      431     7669    1       IF FAB.B.SHARED_INDEX_ALT THEN                          /*#24102*/

   7669  3 001074   200003 470500                    LDP0    @FAB,,AUTO
         3 001075   000032 236100                    LDQ     26,,PR0
         3 001076   100000 316007                    CANQ    32768,DL
         3 001077   001104 600000 3                  TZE     s:7672

      432     7670    2         DO;

      433     7671    2           SHARED.KEY = TEMP_INDX;                                      /*#37958*/

   7671  3 001100   000037 471500                    LDP1    31,,PR0
         3 001101   040100 100500                    MLR     fill='040'O
         3 001102   200144 000377                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=255
         3 001103   100004 000400                    ADSC9   4,,PR1                   cn=0,n=256

      434     7672    2         END;

   7672  3 001104   001326 710000 3                  TRA     s:7800

      435     7673        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:78   
      436     7674        /*----------------------*/
      437     7675    1     GREATER_ADVANCE_SHARED:     PROC   ALTRET;                /*#24102*/

   7675  3 001105   200446 741300       GREATER_ADV* STX1  ! TWOBYTES+1,,AUTO

      438     7676        /*----------------------*/
      439     7677
      440     7678        /*I*
      441     7679               NAME: X9WS$START:GREATER_ADVANCE_SHARED
      442     7680
      443     7681            PURPOSE: This procedure was developed in order to provide support
      444     7682                     for sequential reads of shared indexed files accessed
      445     7683                     with an alternate key because this functionality was removed
      446     7684                     from the C00 release of the CP-6 operating system.
      447     7685        */
      448     7686    2       START.V.KEYS# = %YES#;

   7686  3 001106   400000 236007                    LDQ     -131072,DL
         3 001107   000006 256000 1                  ORSQ    START+6

      449     7687
      450     7688    2       IF ALT_KEYS.K.UNIQUE# (SHARED.INDX) THEN

   7688  3 001110   200003 470500                    LDP0    @FAB,,AUTO
         3 001111   000037 471500                    LDP1    31,,PR0
         3 001112   000055 473500                    LDP3    45,,PR0
         3 001113   100003 720100                    LXL0    3,,PR1
         3 001114   300001 234110                    SZN     1,X0,PR3
         3 001115   001121 605000 3                  TPL     s:7694

      451     7689    3         DO;

      452     7690    3           START.V.N# = 1;

   7690  3 001116   000001 235007                    LDA     1,DL
         3 001117   000007 755000 1                  STA     START+7

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:79   
      453     7691    3         END;

   7691  3 001120   001130 710000 3                  TRA     s:7699

      454     7692    2       ELSE
      455     7693    3         DO;

      456     7694    3           SHARED.RECNUM = SHARED.RECNUM + 1;

   7694  3 001121   100002 235100                    LDA     2,,PR1
         3 001122   000001 035007                    ADLA    1,DL
         3 001123   100002 755100                    STA     2,,PR1

      457     7695    3           START.V.RECNUM# = SHARED.RECNUM;

   7695  3 001124   000037 471500                    LDP1    31,,PR0
         3 001125   100002 720100                    LXL0    2,,PR1
         3 001126   000010 740000 1                  STX0    START+8

      458     7696    3           START.V.N# = 0;

   7696  3 001127   000007 450000 1                  STZ     START+7

      459     7697    3         END;

      460     7698
      461     7699    2       CALL M$PRECORD (START)

   7699  3 001130   000000 630400 1                  EPPR0   START
         3 001131   440003 713400                    CLIMB   alt,+16387
         3 001132   401000 401760                    pmme    nvectors=3
         3 001133   001162 702000 3                  TSX2    s:7716

      462     7700    2         WHENRETURN
      463     7701    3           DO;

      464     7702    3             IF SUBSTR (TEMP_INDX,0,KEY_LEN) = SUBSTR (LOW_VALUE,0,KEY_LEN) THEN
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:80   

   7702  3 001134   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 001135   000000 720100                    LXL0    0,,PR0
         3 001136   000000 721100                    LXL1    0,,PR0
         3 001137   040140 106540                    CMPC    fill='040'O
         3 001140   200144 000010                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=*X0
         3 001141   200344 000011                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X1
         3 001142   001161 601000 3                  TNZ     s:7712

      465     7703    4               DO;

      466     7704    4                 IO_STATUS = %NO_RANDOM_RECORD;

   7704  3 001143   200003 471500                    LDP1    @FAB,,AUTO
         3 001144   100036 473500                    LDP3    30,,PR1
         3 001145   040100 100400                    MLR     fill='040'O
         3 001146   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 001147   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2

      467     7705    4                 FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7705  3 001150   000002 236003                    LDQ     2,DU
         3 001151   100032 256100                    ORSQ    26,,PR1

      468     7706    4                 CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET)

   7706  3 001152   200003 630500                    EPPR0   @FAB,,AUTO
         3 001153   000000 631400 4                  EPPR1   0
         3 001154   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 001155   001157 702000 3                  TSX2    s:7709
         3 001156   001161 710000 3                  TRA     s:7712

      469     7707    4                   WHENALTRETURN
      470     7708    5                     DO;

      471     7709    5                       ALTRETURN;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:81   
   7709  3 001157   200446 221300                    LDX1  ! TWOBYTES+1,,AUTO
         3 001160   000000 702211                    TSX2  ! 0,X1

      472     7710    5                     END;
      473     7711    4                END;

      474     7712    3            END;  /* whenreturn */

   7712  3 001161   001221 710000 3                  TRA     s:7735

      475     7713        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:82   
      476     7714    2          WHENALTRETURN
      477     7715    3            DO;

      478     7716    3              CALL X9WE$IO_ERROR (FAB)

   7716  3 001162   200003 630500                    EPPR0   @FAB,,AUTO
         3 001163   000016 631400 4                  EPPR1   14
         3 001164   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 001165   001167 702000 3                  TSX2    s:7719
         3 001166   001171 710000 3                  TRA     s:7721

      479     7717    3                WHENALTRETURN
      480     7718    4                  DO;

      481     7719    4                    ALTRETURN;

   7719  3 001167   200446 221300                    LDX1  ! TWOBYTES+1,,AUTO
         3 001170   000000 702211                    TSX2  ! 0,X1

      482     7720    4                  END;
      483     7721    3               IF NOT ALT_KEYS.K.UNIQUE# (SHARED.INDX) THEN

   7721  3 001171   200003 470500                    LDP0    @FAB,,AUTO
         3 001172   000037 471500                    LDP1    31,,PR0
         3 001173   000055 473500                    LDP3    45,,PR0
         3 001174   100003 720100                    LXL0    3,,PR1
         3 001175   300001 234110                    SZN     1,X0,PR3
         3 001176   001221 604000 3                  TMI     s:7735

      484     7722    4                 DO;

      485     7723    4                   START.V.N# = 1;

   7723  3 001177   000001 235007                    LDA     1,DL
         3 001200   000007 755000 1                  STA     START+7

      486     7724    4                   START.V.RECNUM# = SHARED.RECNUM - 1; /* last dup */
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:83   

   7724  3 001201   100002 720100                    LXL0    2,,PR1
         3 001202   777777 621010                    EAX1    -1,X0
         3 001203   000010 741000 1                  STX1    START+8

      487     7725    4                   SHARED.RECNUM = 1;

   7725  3 001204   100002 755100                    STA     2,,PR1

      488     7726    4                   TEMP_INDX = SAVE_INDX;

   7726  3 001205   040100 100500                    MLR     fill='040'O
         3 001206   200244 000377                    ADSC9   SAVE_INDX,,AUTO          cn=0,n=255
         3 001207   200144 000377                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=255

      489     7727    4                   CALL M$PRECORD (START)

   7727  3 001210   000000 630400 1                  EPPR0   START
         3 001211   440003 713400                    CLIMB   alt,+16387
         3 001212   401000 401760                    pmme    nvectors=3
         3 001213   001215 702000 3                  TSX2    s:7730
         3 001214   001221 710000 3                  TRA     s:7735

      490     7728    4                     WHENALTRETURN
      491     7729    5                       DO;

      492     7730    5                         CALL X9WE$IO_ERROR (FAB);

   7730  3 001215   200003 630500                    EPPR0   @FAB,,AUTO
         3 001216   000016 631400 4                  EPPR1   14
         3 001217   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 001220   000000 011000                    NOP     0

      493     7731    5                       END;

      494     7732    4                 END;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:84   
      495     7733    3             END; /* whenaltreturn */

      496     7734
      497     7735    2     END GREATER_ADVANCE_SHARED; /* proc */

   7735  3 001221   200446 221300                    LDX1  ! TWOBYTES+1,,AUTO
         3 001222   000001 702211                    TSX2  ! 1,X1

      498     7736        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:85   
      499     7737        /*---------------*/
      500     7738    1     GREATER_ADVANCE: PROC  ALTRET;

   7738  3 001223   200446 741300       GREATER_ADV* STX1  ! TWOBYTES+1,,AUTO

      501     7739        /*---------------*/
      502     7740
      503     7741        /*I*
      504     7742               NAME: X9WS$START:GREATER_ADVANCE
      505     7743
      506     7744            PURPOSE: This procedure will advance to the next key > than the
      507     7745                     key positioned to by the first call to M$PRECORD.
      508     7746        */
      509     7747
      510     7748    2       START.V.N# = 1;

   7748  3 001224   000001 235007                    LDA     1,DL
         3 001225   000007 755000 1                  STA     START+7

      511     7749    2       START.V.KEYS# = NO#;

   7749  3 001226   000015 236000 4                  LDQ     13
         3 001227   000006 356000 1                  ANSQ    START+6

      512     7750    2       CALL POS_REC

   7750  3 001230   001274 701000 3                  TSX1    POS_REC
         3 001231   001260 702000 3                  TSX2    s:7766

      513     7751    2         WHENRETURN
      514     7752    3           DO;        /* CHECK FOR EOF */

      515     7753    3             IF SUBSTR (TEMP_INDX,0,KEY_LEN) = SUBSTR (LOW_VALUE,0,KEY_LEN) THEN

   7753  3 001232   200007 470500                    LDP0    @KEY_LEN,,AUTO
         3 001233   000000 720100                    LXL0    0,,PR0
         3 001234   000000 721100                    LXL1    0,,PR0
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:86   
         3 001235   040140 106540                    CMPC    fill='040'O
         3 001236   200144 000010                    ADSC9   TEMP_INDX,,AUTO          cn=0,n=*X0
         3 001237   200344 000011                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X1
         3 001240   001257 601000 3                  TNZ     s:7763

      516     7754    4               DO;

      517     7755    4                 IO_STATUS = %NO_RANDOM_RECORD;

   7755  3 001241   200003 471500                    LDP1    @FAB,,AUTO
         3 001242   100036 473500                    LDP3    30,,PR1
         3 001243   040100 100400                    MLR     fill='040'O
         3 001244   000000 000002 2                  ADSC9   0                        cn=0,n=2
         3 001245   300000 000002                    ADSC9   0,,PR3                   cn=0,n=2

      518     7756    4                 FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7756  3 001246   000002 236003                    LDQ     2,DU
         3 001247   100032 256100                    ORSQ    26,,PR1

      519     7757    4                 CALL X9WE$IO_ERROR_STATUS (FAB, ALT_RET)

   7757  3 001250   200003 630500                    EPPR0   @FAB,,AUTO
         3 001251   000000 631400 4                  EPPR1   0
         3 001252   000000 701000 xent               TSX1    X9WE$IO_ERROR_STATUS
         3 001253   001255 702000 3                  TSX2    s:7760
         3 001254   001257 710000 3                  TRA     s:7763

      520     7758    4                 WHENALTRETURN
      521     7759    5                   DO;

      522     7760    5                     ALTRETURN;

   7760  3 001255   200446 221300                    LDX1  ! TWOBYTES+1,,AUTO
         3 001256   000000 702211                    TSX2  ! 0,X1

      523     7761    5                   END;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:87   
      524     7762    4                END;

      525     7763    3             END;      /* WHENRETURN */

   7763  3 001257   001272 710000 3                  TRA     s:7773

      526     7764    2         WHENALTRETURN
      527     7765    3           DO;

      528     7766    3             FAB.B.NO_NEXT_RECORD_EXISTS = %YES#;

   7766  3 001260   200003 470500                    LDP0    @FAB,,AUTO
         3 001261   000002 236003                    LDQ     2,DU
         3 001262   000032 256100                    ORSQ    26,,PR0

      529     7767    3             CALL X9WE$IO_ERROR (FAB, ALT_RET)

   7767  3 001263   200003 630500                    EPPR0   @FAB,,AUTO
         3 001264   000000 631400 4                  EPPR1   0
         3 001265   000000 701000 xent               TSX1    X9WE$IO_ERROR
         3 001266   001270 702000 3                  TSX2    s:7770
         3 001267   001272 710000 3                  TRA     s:7773

      530     7768    3             WHENALTRETURN
      531     7769    4               DO;

      532     7770    4                 ALTRETURN;

   7770  3 001270   200446 221300                    LDX1  ! TWOBYTES+1,,AUTO
         3 001271   000000 702211                    TSX2  ! 0,X1

      533     7771    4               END;
      534     7772    3           END;

      535     7773    2     END GREATER_ADVANCE;  /* proc */

   7773  3 001272   200446 221300                    LDX1  ! TWOBYTES+1,,AUTO
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:88   
         3 001273   000001 702211                    TSX2  ! 1,X1

      536     7774        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:89   
      537     7775        /*-------*/
      538     7776    1     POS_REC: PROC  ALTRET;

   7776  3 001274   200450 741300       POS_REC      STX1  ! TWOBYTES+3,,AUTO

      539     7777        /*-------*/
      540     7778
      541     7779        /*I*
      542     7780               NAME: X9WS$START:POS_REC
      543     7781
      544     7782            PURPOSE: This procedure will position to the requested key.
      545     7783        */
      546     7784
      547     7785    2       IF FAB.B.FAST_SEQUENTIAL THEN

   7785  3 001275   200003 470500                    LDP0    @FAB,,AUTO
         3 001276   000032 236100                    LDQ     26,,PR0
         3 001277   000004 316003                    CANQ    4,DU
         3 001300   001315 600000 3                  TZE     s:7792

      548     7786    2         CALL XSA$PRECORD (START, FAB.XSA)

   7786  3 001301   200003 236100                    LDQ     @FAB,,AUTO
         3 001302   000060 036003                    ADLQ    48,DU
         3 001303   000023 235000 4                  LDA     19
         3 001304   200452 757100                    STAQ    TWOBYTES+5,,AUTO
         3 001305   200452 630500                    EPPR0   TWOBYTES+5,,AUTO
         3 001306   000000 631400 4                  EPPR1   0
         3 001307   000000 701000 xent               TSX1    XSA$PRECORD
         3 001310   001312 702000 3                  TSX2    s:7789
         3 001311   001314 710000 3                  TRA     s:7789+2

      549     7787    2           WHENALTRETURN
      550     7788    3             DO;

      551     7789    3               ALTRETURN;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:90   
   7789  3 001312   200450 221300                    LDX1  ! TWOBYTES+3,,AUTO
         3 001313   000000 702211                    TSX2  ! 0,X1
         3 001314   001324 710000 3                  TRA     s:7798

      552     7790    3             END;
      553     7791    2       ELSE
      554     7792    2         CALL M$PRECORD (START)

   7792  3 001315   000000 630400 1                  EPPR0   START
         3 001316   440003 713400                    CLIMB   alt,+16387
         3 001317   401000 401760                    pmme    nvectors=3
         3 001320   001322 702000 3                  TSX2    s:7795
         3 001321   001324 710000 3                  TRA     s:7798

      555     7793    2           WHENALTRETURN
      556     7794    3             DO;

      557     7795    3               ALTRETURN;

   7795  3 001322   200450 221300                    LDX1  ! TWOBYTES+3,,AUTO
         3 001323   000000 702211                    TSX2  ! 0,X1

      558     7796    3             END;
      559     7797
      560     7798    2     END POS_REC;

   7798  3 001324   200450 221300                    LDX1  ! TWOBYTES+3,,AUTO
         3 001325   000001 702211                    TSX2  ! 1,X1

      561     7799
      562     7800    1   END X9WS$START; /* proc */

   7800  3 001326   000000 702200 xent               TSX2  ! X66_ARET
      563     7801        %EJECT;
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:91   
      564     7802        %EOD;

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:92   
--  Include file information  --

   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
      No diagnostics issued in procedure X9WS$START.
PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:93   

 **** Variables and constants ****

  ****  Section 001  Data  X9WS$START

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(360)   r     1 START

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ALT_RET                   3-0-0/w PTR         r     1 @FAB
     7-0-0/w PTR         r     1 @KEY_LEN                   6-0-0/w PTR         r     1 @KEY_OFFSET
     5-0-0/w PTR         r     1 @START_CODE              142-0-0/w PTR         r     1 ALT_INDX$
    *0-0-0/w BIT         r     1 ALT_RET                   10-0-0/w PTR         r     1 DCB$
    *0-0-0/d STRC(2232)  r     1 FAB                       40-0-0/w SBIN        r     1 I
    42-0-0/w STRC(2304)  r     1 KEYED_KEY                 *0-0-0/w SBIN        r     1 KEY_LEN
    *0-0-0/w SBIN        r     1 KEY_OFFSET               344-0-0/c CHAR(255)   r     1 LOW_VALUE
   445-0-0/h STRC(18)    r     1 ONEBYTE                   37-0-0/w SBIN        r     1 PRIME_KEYX
    41-0-0/w UBIN        r     1 RELATIVE_KEY             244-0-0/c CHAR(255)   r     1 SAVE_INDX
    13-0-0/c CHAR(80)          1 SPECIAL_ERR_MSG           *0-0-0/w SBIN        r     1 START_CODE
   143-0-0/b BIT         r     1 SUB_KEY                  144-0-0/c CHAR(255)   r     1 TEMP_INDX
   444-0-0/w SBIN        r     1 TEMP_LEN                 445-0-0/h UBIN(18)    r     1 TWOBYTES
    11-0-0/w PTR         r     1 USE$$                     12-0-0/w EPTR        r     1 USE_ENTRY$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$TCB$

  ****  BASED and DCB variables  ****

PL6.E3A0      #001=X9WS$START File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:08 Page:94   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 ALT_INDX                   0-0-0/d STRC(72)    r     1 ALT_KEYS
     0-0-0/w STRC(2448)        1 B$ALT                      0-0-0/w STRC(144)         1 B$TCB
     0-0-0/c ACHR        r     1 INDEX_KEY                  0-0-0/c CHAR(2)     r     1 IO_STATUS
     0-0-0/c ACHR        r     1 KEY_TEXT                   0-0-0N  NULL        r     1 M$UC
     0-0-0/d ASTR(3528)  r     1 M$XX                       0-0-0/w STRC(2448)  r     1 SHARED
     0-0-0/w STRC(864)         1 USE_PROC


   Procedure X9WS$START requires 727 words for executable code.
   Procedure X9WS$START requires 302 words of local(AUTO) storage.

PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:95   
      565        1        /*M* X9WS$REPOS -- Provides for Cobol file position requirements    */
      566        2        /*T***********************************************************/
      567        3        /*T*                                                         */
      568        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      569        5        /*T*                                                         */
      570        6        /*T***********************************************************/
      571        7
      572        8        /*P*
      573        9               NAME: X9WS$REPOS
      574       10            PURPOSE: This module provides a method of "correcting" file
      575       11                     management's version of current record pointer in order
      576       12                     to fulfill the Cobol requirements for file positioning.
      577       13
      578       14        */
      579       15        /*-------*/
      580       16        X9WS$REPOS: PROC  (FAB, KEY_SENT, N);
      581       17        /*-------*/
      582       18
      583       19            %INCLUDE X8A_SYS_FILE;
      584     6289            %INCLUDE X8A_ERRCOM;
      585     6378            %INCLUDE X9A_FAB;
      586     6565            %INCLUDE X9A_IO;
      587     6715            %INCLUDE X9A_LIB_IO;
      588     7099            %DCL_FAB;
      589     7221        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:96   
      590     7222    1       DCL START_INDEX_KEY     CHAR (INDX_LEN) BASED (START_INDX$);
      591     7223    1       DCL START_INDX            CHAR(255);
      592     7224    1       DCL START_INDX$           PTR;
      593     7225    1       DCL INDX_LEN              SBIN WORD;
      594     7226    1       DCL START_RELATIVE_KEY    UBIN WORD;
      595     7227
      596     7228    1       DCL 1 ID_BUF              ALIGNED STATIC,
      597     7229    1             2 NO_REC_IDS        UBIN WORD,
      598     7230    1             2 REC_ID            UBIN WORD;
      599     7231
      600     7232    1       DCL 1 START_KEYED_KEY     ALIGNED,
      601     7233    1             2 LENGTH            UBIN(9) UNAL,
      602     7234    1             2 TEXT              CHAR(255) UNAL;
      603     7235    1       DCL LOW_VALUE             CHAR(255);
      604     7236    1       DCL I                     SBIN WORD;
      605     7237    1       DCL N                     SBIN WORD;
      606     7238    1       DCL KEY_SENT              BIT(1) ALIGNED;
      607     7239
      608     7240            %FPT_PRECORD              (FPTN = START);
      609     7261            %FPT_PFIL                 (FPTN = POSITION_FILE);
      610     7276
      611     7277    1       DCL X8ER$ERROR            ENTRY(3);
      612     7278
      613     7279            %VLP_ALTKEYS       (FPTN=ALT_KEYS, STCLASS="BASED (FAB.ALT_KEY$)");
      614     7294        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:97   
      615     7295        /*-----------\
      616     7296        | Reposition |
      617     7297        \-----------*/
      618     7298
      619     7299    1       DCB$ = DCBADDR (FAB.DCB_NUM);
      620     7300    1       START.V.KEYS# = KEY_SENT;
      621     7301    1       START.V.N# = 0;
      622     7302    2       DO CASE (FAB.ORG#);
      623     7303
      624     7304    2         CASE (%CP6_INDEXED);
      625     7305
      626     7306    2           START_INDX$ = ADDR (START_INDX);
      627     7307    2           IF NOT START.V.KEYS# THEN
      628     7308    2             START.V.INDX# = M$XX.INDX;  /* save key pointer */
      629     7309    2           IF  START.V.INDX# = 0
      630     7310    2           OR  START.V.INDX# = 1  THEN
      631     7311    3             DO;                                   /*#36768*/
      632     7312    3               INDX_LEN = FAB.RECORD_KEY_LEN;
      633     7313    3               START.V.ID# = NO#;                  /*#36768*/
      634     7314    3               START.V.IDS# = NO#;                 /*#36768*/
      635     7315    3              END;                                 /*#36768*/
      636     7316    2           ELSE
      637     7317    3             DO;
      638     7318    3               IF NOT ALT_KEYS.K.UNIQUE# (START.V.INDX# - 2) THEN
      639     7319    4                 DO;  /* we have duplicates */
      640     7320    4                   START.IDBUF_ = VECTOR (ID_BUF);
      641     7321    4                   START.V.ID#  = YES#;
      642     7322    4                   START.V.IDS# = START.V.KEYS#;
      643     7323    4                 END;
      644     7324    3               INDX_LEN = ALT_KEYS.K.KEYL# (START.V.INDX# - 2);
      645     7325    3             END;
      646     7326    2           START.KEY_ = VECTOR (START_INDEX_KEY);
      647     7327    3           DO I = 0 TO INDX_LEN - 1;
      648     7328    3             SUBSTR (LOW_VALUE,I,1) = BINASC(0);
      649     7329    3           END;
      650     7330    2           IF START.V.KEYS#   THEN
      651     7331    2             IF START_INDEX_KEY = SUBSTR (LOW_VALUE,0,INDX_LEN - 1) THEN
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:98   
      652     7332    2               START.V.N# = 0;
      653     7333        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:99   
      654     7334        /*-----------\
      655     7335        | Reposition |
      656     7336        \-----------*/
      657     7337
      658     7338    2         CASE (%CP6_RELATIVE);
      659     7339
      660     7340    2           START.KEY_ = VECTOR (START_RELATIVE_KEY);
      661     7341    2           IF  START_RELATIVE_KEY = 0
      662     7342    2           AND START.V.KEYS#  THEN
      663     7343    2             START.V.N# = 0;
      664     7344
      665     7345    2         CASE (%CP6_KEYED);
      666     7346
      667     7347    2           START_KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;
      668     7348    2           START.KEY_ = VECTOR (START_KEYED_KEY);
      669     7349    3            DO I = 0 TO FAB.RECORD_KEY_LEN - 1;
      670     7350    3              SUBSTR (LOW_VALUE,I,1) = BINASC(0);
      671     7351    3            END;
      672     7352    2            IF START.V.KEYS# THEN
      673     7353    2              IF SUBSTR (START_KEYED_KEY.TEXT,0,START_KEYED_KEY.LENGTH) =
      674     7354    2                 SUBSTR  (LOW_VALUE,0, START_KEYED_KEY.LENGTH) THEN
      675     7355    2                       START.V.N# = 0;
      676     7356
      677     7357    2         CASE (ELSE);
      678     7358
      679     7359    2           CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS$REPOS', 10);
      680     7360    2       END; /* case m$xx.org# */
      681     7361        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:100  
      682     7362        /*-----------\
      683     7363        | Reposition |
      684     7364        \-----------*/
      685     7365
      686     7366    1       START.V.KEYR# = YES#;
      687     7367    1       START.V.DCB#  = FAB.DCB_NUM;
      688     7368    1       CALL M$PRECORD (START)
      689     7369    1         WHENRETURN
      690     7370    2           DO;
      691     7371    2             START.V.N# = N;
      692     7372    2             START.V.KEYS# = %NO#;
      693     7373    2             START.V.IDS#  = %NO#;
      694     7374    2             CALL M$PRECORD (START)
      695     7375    2               WHENALTRETURN
      696     7376    3                 DO;
      697     7377    3                   CALL POSITION_ERROR;
      698     7378    3                 END;
      699     7379    2           END;  /* Whenreturn  (N# = 0) */
      700     7380    1         WHENALTRETURN
      701     7381    2           DO;
      702     7382    2             CALL POSITION_ERROR;
      703     7383    2           END;
      704     7384        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:101  
      705     7385          /*------------*/
      706     7386    1      POSITION_ERROR:     PROC;
      707     7387          /*------------*/
      708     7388
      709     7389        /*V*                   Reposition_Altreturn
      710     7390
      711     7391         a) If this was the first call then we are at beginning of file so,
      712     7392            set the key to low value.
      713     7393
      714     7394         b) If this was the second call (KEY_SENT = true) then we have an
      715     7395            end of file condition.  This should only happen with calls from
      716     7396            Delete so, position the file to eof and return.
      717     7397
      718     7398        */
      719     7399    2                   IF NOT START.V.KEYS# THEN    /* we are at bof */
      720     7400    3                     DO CASE  (FAB.ORG#);
      721     7401
      722     7402    3                       CASE (%CP6_INDEXED);
      723     7403    3                         START_INDEX_KEY = SUBSTR (LOW_VALUE,0,INDX_LEN - 1);
      724     7404
      725     7405    3                       CASE (%CP6_RELATIVE);
      726     7406    3                         START_RELATIVE_KEY = 0;
      727     7407
      728     7408    3                       CASE (%CP6_KEYED);
      729     7409    3                         START_KEYED_KEY.TEXT =
      730     7410    3                              SUBSTR (LOW_VALUE,0,START_KEYED_KEY.LENGTH - 1);
      731     7411
      732     7412    3                       CASE (ELSE);
      733     7413    3                         CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS$REPOS', 10);
      734     7414    3                     END; /* case fab.org# */
      735     7415        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:102  
      736     7416        /*-----------\
      737     7417        | Reposition |
      738     7418        \-----------*/
      739     7419
      740     7420    2                   ELSE       /* the key was sent in so, we are at eof */
      741     7421    2                     IF  FAB.LAST_IO = %DELETE THEN
      742     7422    3                       DO;
      743     7423    3                         POSITION_FILE.V.BOF# = %NO#;     /* position to eof */
      744     7424    3                         POSITION_FILE.V.DCB# = FAB.DCB_NUM;
      745     7425    3                         CALL M$PFIL  (POSITION_FILE);
      746     7426    3                         RETURN;
      747     7427    3                       END;
      748     7428    2      END POSITION_ERROR; /* proc */
      749     7429    1   END X9WS$REPOS; /* proc */
      750     7430        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:103  

PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:104  
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
      No diagnostics issued in procedure X9WS$REPOS.

   Procedure X9WS$REPOS requires 226 words for executable code.
   Procedure X9WS$REPOS requires 230 words of local(AUTO) storage.

    No errors detected in file X9WS.:X8A6TSI    .

PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:105  

 Object Unit name= X9WS$REPOS                                 File name= X9WS.:X8A6TOU
 UTS= AUG 09 '97 11:11:36.40 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    16     20  X9WS$REPOS
    2  RoData even  UTS      3      3  X9WS$REPOS
    3   Proc  even  none   226    342  X9WS$REPOS
    4  RoData even  none    14     16  X9WS$REPOS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        3  X9WS$REPOS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 X8ER$ERROR
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:106  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:107  


      565        1        /*M* X9WS$REPOS -- Provides for Cobol file position requirements    */
      566        2        /*T***********************************************************/
      567        3        /*T*                                                         */
      568        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      569        5        /*T*                                                         */
      570        6        /*T***********************************************************/
      571        7
      572        8        /*P*
      573        9               NAME: X9WS$REPOS
      574       10            PURPOSE: This module provides a method of "correcting" file
      575       11                     management's version of current record pointer in order
      576       12                     to fulfill the Cobol requirements for file positioning.
      577       13
      578       14        */
      579       15        /*-------*/
      580       16        X9WS$REPOS: PROC  (FAB, KEY_SENT, N);

     16  3 000000   000000 700200 xent  X9WS$REPOS   TSX0  ! X66_AUTO_3
         3 000001   000346 000003                    ZERO    230,3

      581       17        /*-------*/
      582       18
      583       19            %INCLUDE X8A_SYS_FILE;
      584     6289            %INCLUDE X8A_ERRCOM;
      585     6378            %INCLUDE X9A_FAB;
      586     6565            %INCLUDE X9A_IO;
      587     6715            %INCLUDE X9A_LIB_IO;
      588     7099            %DCL_FAB;
      589     7221        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:108  
      590     7222    1       DCL START_INDEX_KEY     CHAR (INDX_LEN) BASED (START_INDX$);
      591     7223    1       DCL START_INDX            CHAR(255);
      592     7224    1       DCL START_INDX$           PTR;
      593     7225    1       DCL INDX_LEN              SBIN WORD;
      594     7226    1       DCL START_RELATIVE_KEY    UBIN WORD;
      595     7227
      596     7228    1       DCL 1 ID_BUF              ALIGNED STATIC,
      597     7229    1             2 NO_REC_IDS        UBIN WORD,
      598     7230    1             2 REC_ID            UBIN WORD;
      599     7231
      600     7232    1       DCL 1 START_KEYED_KEY     ALIGNED,
      601     7233    1             2 LENGTH            UBIN(9) UNAL,
      602     7234    1             2 TEXT              CHAR(255) UNAL;
      603     7235    1       DCL LOW_VALUE             CHAR(255);
      604     7236    1       DCL I                     SBIN WORD;
      605     7237    1       DCL N                     SBIN WORD;
      606     7238    1       DCL KEY_SENT              BIT(1) ALIGNED;
      607     7239
      608     7240            %FPT_PRECORD              (FPTN = START);
      609     7261            %FPT_PFIL                 (FPTN = POSITION_FILE);
      610     7276
      611     7277    1       DCL X8ER$ERROR            ENTRY(3);
      612     7278
      613     7279            %VLP_ALTKEYS       (FPTN=ALT_KEYS, STCLASS="BASED (FAB.ALT_KEY$)");
      614     7294        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:109  
      615     7295        /*-----------\
      616     7296        | Reposition |
      617     7297        \-----------*/
      618     7298
      619     7299    1       DCB$ = DCBADDR (FAB.DCB_NUM);

   7299  3 000002   000000 470400 4                  LDP0    0
         3 000003   000000 471500                    LDP1    0,,PR0
         3 000004   200003 473500                    LDP3    @FAB,,AUTO
         3 000005   300034 220100                    LDX0    28,,PR3
         3 000006   100000 236110                    LDQ     0,X0,PR1
         3 000007   200032 756100                    STQ     DCB$,,AUTO

      620     7300    1       START.V.KEYS# = KEY_SENT;

   7300  3 000010   200004 474500                    LDP4    @KEY_SENT,,AUTO
         3 000011   400000 236100                    LDQ     0,,PR4
         3 000012   000022 772000                    QRL     18
         3 000013   000010 676000 1                  ERQ     START+6
         3 000014   400000 376007                    ANQ     -131072,DL
         3 000015   000010 656000 1                  ERSQ    START+6

      621     7301    1       START.V.N# = 0;

   7301  3 000016   000011 450000 1                  STZ     START+7

      622     7302    2       DO CASE (FAB.ORG#);

   7302  3 000017   300002 235100                    LDA     2,,PR3
         3 000020   000007 115007                    CMPA    7,DL
         3 000021   000023 602005 3                  TNC     s:7302+4,AL
         3 000022   000215 710000 3                  TRA     s:7359
         3 000023   000215 710000 3                  TRA     s:7359
         3 000024   000215 710000 3                  TRA     s:7359
         3 000025   000153 710000 3                  TRA     s:7347
         3 000026   000215 710000 3                  TRA     s:7359
         3 000027   000215 710000 3                  TRA     s:7359
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:110  
         3 000030   000137 710000 3                  TRA     s:7340
         3 000031   000032 710000 3                  TRA     s:7306

      623     7303
      624     7304    2         CASE (%CP6_INDEXED);

      625     7305
      626     7306    2           START_INDX$ = ADDR (START_INDX);

   7306  3 000032   200035 635500                    EPPR5   START_INDX,,AUTO
         3 000033   200135 455500                    STP5    START_INDX$,,AUTO

      627     7307    2           IF NOT START.V.KEYS# THEN

   7307  3 000034   000010 236000 1                  LDQ     START+6
         3 000035   400000 316007                    CANQ    -131072,DL
         3 000036   000043 601000 3                  TNZ     s:7309

      628     7308    2             START.V.INDX# = M$XX.INDX;  /* save key pointer */

   7308  3 000037   200032 476500                    LDP6    DCB$,,AUTO
         3 000040   600077 236100                    LDQ     63,,PR6
         3 000041   000022 772000                    QRL     18
         3 000042   000010 552004 1                  STBQ    START+6,'04'O

      629     7309    2           IF  START.V.INDX# = 0

   7309  3 000043   000010 236000 1                  LDQ     START+6
         3 000044   000777 316007                    CANQ    511,DL
         3 000045   000052 600000 3                  TZE     s:7312
         3 000046   000010 236000 1                  LDQ     START+6
         3 000047   000777 376007                    ANQ     511,DL
         3 000050   000001 116007                    CMPQ    1,DL
         3 000051   000061 601000 3                  TNZ     s:7318

      630     7310    2           OR  START.V.INDX# = 1  THEN
      631     7311    3             DO;                                   /*#36768*/
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:111  

      632     7312    3               INDX_LEN = FAB.RECORD_KEY_LEN;

   7312  3 000052   300031 235100                    LDA     25,,PR3
         3 000053   200136 755100                    STA     INDX_LEN,,AUTO

      633     7313    3               START.V.ID# = NO#;                  /*#36768*/

   7313  3 000054   000001 236000 4                  LDQ     1
         3 000055   000010 356000 1                  ANSQ    START+6

      634     7314    3               START.V.IDS# = NO#;                 /*#36768*/

   7314  3 000056   000002 236000 4                  LDQ     2
         3 000057   000010 356000 1                  ANSQ    START+6

      635     7315    3              END;                                 /*#36768*/

   7315  3 000060   000103 710000 3                  TRA     s:7326

      636     7316    2           ELSE
      637     7317    3             DO;

      638     7318    3               IF NOT ALT_KEYS.K.UNIQUE# (START.V.INDX# - 2) THEN

   7318  3 000061   300055 476500                    LDP6    45,,PR3
         3 000062   000010 721000 1                  LXL1    START+6
         3 000063   000777 361003                    ANX1    511,DU
         3 000064   677777 234111                    SZN     -1,X1,PR6
         3 000065   000077 604000 3                  TMI     s:7324

      639     7319    4                 DO;  /* we have duplicates */

      640     7320    4                   START.IDBUF_ = VECTOR (ID_BUF);

   7320  3 000066   000004 237000 4                  LDAQ    4
         3 000067   000006 757000 1                  STAQ    START+4
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:112  

      641     7321    4                   START.V.ID#  = YES#;

   7321  3 000070   100000 236007                    LDQ     32768,DL
         3 000071   000010 256000 1                  ORSQ    START+6

      642     7322    4                   START.V.IDS# = START.V.KEYS#;

   7322  3 000072   000010 236000 1                  LDQ     START+6
         3 000073   000003 772000                    QRL     3
         3 000074   000010 676000 1                  ERQ     START+6
         3 000075   040000 376007                    ANQ     16384,DL
         3 000076   000010 656000 1                  ERSQ    START+6

      643     7323    4                 END;

      644     7324    3               INDX_LEN = ALT_KEYS.K.KEYL# (START.V.INDX# - 2);

   7324  3 000077   677777 236111                    LDQ     -1,X1,PR6
         3 000100   000022 772000                    QRL     18
         3 000101   000777 376007                    ANQ     511,DL
         3 000102   200136 756100                    STQ     INDX_LEN,,AUTO

      645     7325    3             END;

      646     7326    2           START.KEY_ = VECTOR (START_INDEX_KEY);

   7326  3 000103   200136 235100                    LDA     INDX_LEN,,AUTO
         3 000104   000020 735000                    ALS     16
         3 000105   000140 135007                    SBLA    96,DL
         3 000106   200135 236100                    LDQ     START_INDX$,,AUTO
         3 000107   000004 757000 1                  STAQ    START+2

      647     7327    3           DO I = 0 TO INDX_LEN - 1;

   7327  3 000110   200340 450100                    STZ     I,,AUTO
         3 000111   000117 710000 3                  TRA     s:7329+1
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:113  

      648     7328    3             SUBSTR (LOW_VALUE,I,1) = BINASC(0);

   7328  3 000112   200340 235100                    LDA     I,,AUTO
         3 000113   040105 100400                    MLR     fill='040'O
         3 000114   000003 000001 4                  ADSC9   3                        cn=0,n=1
         3 000115   200240 000001                    ADSC9   LOW_VALUE,A,AUTO         cn=0,n=1

      649     7329    3           END;

   7329  3 000116   200340 054100                    AOS     I,,AUTO
         3 000117   200340 236100                    LDQ     I,,AUTO
         3 000120   200136 116100                    CMPQ    INDX_LEN,,AUTO
         3 000121   000112 604000 3                  TMI     s:7328

      650     7330    2           IF START.V.KEYS#   THEN

   7330  3 000122   000010 236000 1                  LDQ     START+6
         3 000123   400000 316007                    CANQ    -131072,DL
         3 000124   000221 600000 3                  TZE     s:7366

      651     7331    2             IF START_INDEX_KEY = SUBSTR (LOW_VALUE,0,INDX_LEN - 1) THEN

   7331  3 000125   200136 720100                    LXL0    INDX_LEN,,AUTO
         3 000126   777777 621010                    EAX1    -1,X0
         3 000127   200135 470500                    LDP0    START_INDX$,,AUTO
         3 000130   200136 722100                    LXL2    INDX_LEN,,AUTO
         3 000131   040140 106540                    CMPC    fill='040'O
         3 000132   000000 000012                    ADSC9   0,,PR0                   cn=0,n=*X2
         3 000133   200240 000011                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X1
         3 000134   000221 601000 3                  TNZ     s:7366

      652     7332    2               START.V.N# = 0;

   7332  3 000135   000011 450000 1                  STZ     START+7
         3 000136   000221 710000 3                  TRA     s:7366

PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:114  
      653     7333        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:115  
      654     7334        /*-----------\
      655     7335        | Reposition |
      656     7336        \-----------*/
      657     7337
      658     7338    2         CASE (%CP6_RELATIVE);

      659     7339
      660     7340    2           START.KEY_ = VECTOR (START_RELATIVE_KEY);

   7340  3 000137   777640 235007                    LDA     -96,DL
         3 000140   200344 452500                    STP2    I+4,,AUTO
         3 000141   200344 236100                    LDQ     I+4,,AUTO
         3 000142   000137 036003                    ADLQ    95,DU
         3 000143   000004 757000 1                  STAQ    START+2

      661     7341    2           IF  START_RELATIVE_KEY = 0

   7341  3 000144   200137 235100                    LDA     START_RELATIVE_KEY,,AUTO
         3 000145   000221 601000 3                  TNZ     s:7366
         3 000146   000010 236000 1                  LDQ     START+6
         3 000147   400000 316007                    CANQ    -131072,DL
         3 000150   000221 600000 3                  TZE     s:7366

      662     7342    2           AND START.V.KEYS#  THEN
      663     7343    2             START.V.N# = 0;

   7343  3 000151   000011 450000 1                  STZ     START+7
         3 000152   000221 710000 3                  TRA     s:7366

      664     7344
      665     7345    2         CASE (%CP6_KEYED);

      666     7346
      667     7347    2           START_KEYED_KEY.LENGTH = FAB.RECORD_KEY_LEN;

   7347  3 000153   300031 236100                    LDQ     25,,PR3
         3 000154   000033 736000                    QLS     27
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:116  
         3 000155   200140 552140                    STBQ    START_KEYED_KEY,'40'O,AUTO

      668     7348    2           START.KEY_ = VECTOR (START_KEYED_KEY);

   7348  3 000156   000006 235000 4                  LDA     6
         3 000157   200344 452500                    STP2    I+4,,AUTO
         3 000160   200344 236100                    LDQ     I+4,,AUTO
         3 000161   000140 036003                    ADLQ    96,DU
         3 000162   000004 757000 1                  STAQ    START+2

      669     7349    3            DO I = 0 TO FAB.RECORD_KEY_LEN - 1;

   7349  3 000163   200340 450100                    STZ     I,,AUTO
         3 000164   000172 710000 3                  TRA     s:7351+1

      670     7350    3              SUBSTR (LOW_VALUE,I,1) = BINASC(0);

   7350  3 000165   200340 235100                    LDA     I,,AUTO
         3 000166   040105 100400                    MLR     fill='040'O
         3 000167   000003 000001 4                  ADSC9   3                        cn=0,n=1
         3 000170   200240 000001                    ADSC9   LOW_VALUE,A,AUTO         cn=0,n=1

      671     7351    3            END;

   7351  3 000171   200340 054100                    AOS     I,,AUTO
         3 000172   200003 470500                    LDP0    @FAB,,AUTO
         3 000173   200340 236100                    LDQ     I,,AUTO
         3 000174   000031 116100                    CMPQ    25,,PR0
         3 000175   000165 604000 3                  TMI     s:7350

      672     7352    2            IF START.V.KEYS# THEN

   7352  3 000176   000010 236000 1                  LDQ     START+6
         3 000177   400000 316007                    CANQ    -131072,DL
         3 000200   000221 600000 3                  TZE     s:7366

      673     7353    2              IF SUBSTR (START_KEYED_KEY.TEXT,0,START_KEYED_KEY.LENGTH) =
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:117  

   7353  3 000201   200140 236100                    LDQ     START_KEYED_KEY,,AUTO
         3 000202   000033 772000                    QRL     27
         3 000203   000000 620006                    EAX0    0,QL
         3 000204   200140 236100                    LDQ     START_KEYED_KEY,,AUTO
         3 000205   000033 772000                    QRL     27
         3 000206   000000 621006                    EAX1    0,QL
         3 000207   040140 106540                    CMPC    fill='040'O
         3 000210   200140 200010                    ADSC9   START_KEYED_KEY,,AUTO    cn=1,n=*X0
         3 000211   200240 000011                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X1
         3 000212   000221 601000 3                  TNZ     s:7366

      674     7354    2                 SUBSTR  (LOW_VALUE,0, START_KEYED_KEY.LENGTH) THEN
      675     7355    2                       START.V.N# = 0;

   7355  3 000213   000011 450000 1                  STZ     START+7
         3 000214   000221 710000 3                  TRA     s:7366

      676     7356
      677     7357    2         CASE (ELSE);

      678     7358
      679     7359    2           CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS$REPOS', 10);

   7359  3 000215   000012 630400 4                  EPPR0   10
         3 000216   000007 631400 4                  EPPR1   7
         3 000217   000000 701000 xent               TSX1    X8ER$ERROR
         3 000220   000000 011000                    NOP     0

      680     7360    2       END; /* case m$xx.org# */

      681     7361        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:118  
      682     7362        /*-----------\
      683     7363        | Reposition |
      684     7364        \-----------*/
      685     7365
      686     7366    1       START.V.KEYR# = YES#;

   7366  3 000221   200000 236007                    LDQ     65536,DL
         3 000222   000010 256000 1                  ORSQ    START+6

      687     7367    1       START.V.DCB#  = FAB.DCB_NUM;

   7367  3 000223   200003 470500                    LDP0    @FAB,,AUTO
         3 000224   000034 220100                    LDX0    28,,PR0
         3 000225   000010 740000 1                  STX0    START+6

      688     7368    1       CALL M$PRECORD (START)

   7368  3 000226   000002 630400 1                  EPPR0   START
         3 000227   440003 713400                    CLIMB   alt,+16387
         3 000230   401000 401760                    pmme    nvectors=3
         3 000231   000251 702000 3                  TSX2    s:7382

      689     7369    1         WHENRETURN
      690     7370    2           DO;

      691     7371    2             START.V.N# = N;

   7371  3 000232   200005 470500                    LDP0    @N,,AUTO
         3 000233   000000 235100                    LDA     0,,PR0
         3 000234   000011 755000 1                  STA     START+7

      692     7372    2             START.V.KEYS# = %NO#;

   7372  3 000235   000015 236000 4                  LDQ     13
         3 000236   000010 356000 1                  ANSQ    START+6

      693     7373    2             START.V.IDS#  = %NO#;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:119  

   7373  3 000237   000002 236000 4                  LDQ     2
         3 000240   000010 356000 1                  ANSQ    START+6

      694     7374    2             CALL M$PRECORD (START)

   7374  3 000241   000002 630400 1                  EPPR0   START
         3 000242   440003 713400                    CLIMB   alt,+16387
         3 000243   401000 401760                    pmme    nvectors=3
         3 000244   000246 702000 3                  TSX2    s:7377
         3 000245   000250 710000 3                  TRA     s:7379

      695     7375    2               WHENALTRETURN
      696     7376    3                 DO;

      697     7377    3                   CALL POSITION_ERROR;

   7377  3 000246   000254 701000 3                  TSX1    POSITION_ERROR
         3 000247   000000 011000                    NOP     0

      698     7378    3                 END;

      699     7379    2           END;  /* Whenreturn  (N# = 0) */

   7379  3 000250   000253 710000 3                  TRA     s:7383

      700     7380    1         WHENALTRETURN
      701     7381    2           DO;

      702     7382    2             CALL POSITION_ERROR;

   7382  3 000251   000254 701000 3                  TSX1    POSITION_ERROR
         3 000252   000000 011000                    NOP     0

      703     7383    2           END;

   7383  3 000253   000341 710000 3                  TRA     s:7429
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:120  

      704     7384        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:121  
      705     7385          /*------------*/
      706     7386    1      POSITION_ERROR:     PROC;

   7386  3 000254   200342 741300       POSITION_ER* STX1  ! I+2,,AUTO

      707     7387          /*------------*/
      708     7388
      709     7389        /*V*                   Reposition_Altreturn
      710     7390
      711     7391         a) If this was the first call then we are at beginning of file so,
      712     7392            set the key to low value.
      713     7393
      714     7394         b) If this was the second call (KEY_SENT = true) then we have an
      715     7395            end of file condition.  This should only happen with calls from
      716     7396            Delete so, position the file to eof and return.
      717     7397
      718     7398        */
      719     7399    2                   IF NOT START.V.KEYS# THEN    /* we are at bof */

   7399  3 000255   000010 236000 1                  LDQ     START+6
         3 000256   400000 316007                    CANQ    -131072,DL
         3 000257   000322 601000 3                  TNZ     s:7421

      720     7400    3                     DO CASE  (FAB.ORG#);

   7400  3 000260   200003 470500                    LDP0    @FAB,,AUTO
         3 000261   000002 235100                    LDA     2,,PR0
         3 000262   000007 115007                    CMPA    7,DL
         3 000263   000265 602005 3                  TNC     s:7400+5,AL
         3 000264   000315 710000 3                  TRA     s:7413
         3 000265   000315 710000 3                  TRA     s:7413
         3 000266   000315 710000 3                  TRA     s:7413
         3 000267   000306 710000 3                  TRA     s:7409
         3 000270   000315 710000 3                  TRA     s:7413
         3 000271   000315 710000 3                  TRA     s:7413
         3 000272   000304 710000 3                  TRA     s:7406
         3 000273   000274 710000 3                  TRA     s:7403
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:122  

      721     7401
      722     7402    3                       CASE (%CP6_INDEXED);

      723     7403    3                         START_INDEX_KEY = SUBSTR (LOW_VALUE,0,INDX_LEN - 1);

   7403  3 000274   200136 720100                    LXL0    INDX_LEN,,AUTO
         3 000275   777777 622010                    EAX2    -1,X0
         3 000276   200135 471500                    LDP1    START_INDX$,,AUTO
         3 000277   200136 723100                    LXL3    INDX_LEN,,AUTO
         3 000300   040140 100540                    MLR     fill='040'O
         3 000301   200240 000012                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X2
         3 000302   100000 000013                    ADSC9   0,,PR1                   cn=0,n=*X3
         3 000303   000337 710000 3                  TRA     s:7428

      724     7404
      725     7405    3                       CASE (%CP6_RELATIVE);

      726     7406    3                         START_RELATIVE_KEY = 0;

   7406  3 000304   200137 450100                    STZ     START_RELATIVE_KEY,,AUTO
         3 000305   000337 710000 3                  TRA     s:7428

      727     7407
      728     7408    3                       CASE (%CP6_KEYED);

      729     7409    3                         START_KEYED_KEY.TEXT =

   7409  3 000306   200140 236100                    LDQ     START_KEYED_KEY,,AUTO
         3 000307   000033 772000                    QRL     27
         3 000310   777777 620006                    EAX0    -1,QL
         3 000311   040100 100540                    MLR     fill='040'O
         3 000312   200240 000010                    ADSC9   LOW_VALUE,,AUTO          cn=0,n=*X0
         3 000313   200140 200377                    ADSC9   START_KEYED_KEY,,AUTO    cn=1,n=255
         3 000314   000337 710000 3                  TRA     s:7428

      730     7410    3                              SUBSTR (LOW_VALUE,0,START_KEYED_KEY.LENGTH - 1);
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:123  
      731     7411
      732     7412    3                       CASE (ELSE);

      733     7413    3                         CALL X8ER$ERROR (%UNEXPECTED_CASE, 'X9WS$REPOS', 10);

   7413  3 000315   000012 630400 4                  EPPR0   10
         3 000316   000007 631400 4                  EPPR1   7
         3 000317   000000 701000 xent               TSX1    X8ER$ERROR
         3 000320   000000 011000                    NOP     0

      734     7414    3                     END; /* case fab.org# */

   7414  3 000321   000337 710000 3                  TRA     s:7428

      735     7415        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:124  
      736     7416        /*-----------\
      737     7417        | Reposition |
      738     7418        \-----------*/
      739     7419
      740     7420    2                   ELSE       /* the key was sent in so, we are at eof */
      741     7421    2                     IF  FAB.LAST_IO = %DELETE THEN

   7421  3 000322   200003 470500                    LDP0    @FAB,,AUTO
         3 000323   000025 235100                    LDA     21,,PR0
         3 000324   000006 115007                    CMPA    6,DL
         3 000325   000337 601000 3                  TNZ     s:7428

      742     7422    3                       DO;

      743     7423    3                         POSITION_FILE.V.BOF# = %NO#;     /* position to eof */

   7423  3 000326   000015 236000 4                  LDQ     13
         3 000327   000016 356000 1                  ANSQ    POSITION_FILE+2

      744     7424    3                         POSITION_FILE.V.DCB# = FAB.DCB_NUM;

   7424  3 000330   000034 220100                    LDX0    28,,PR0
         3 000331   000016 740000 1                  STX0    POSITION_FILE+2

      745     7425    3                         CALL M$PFIL  (POSITION_FILE);

   7425  3 000332   000014 630400 1                  EPPR0   POSITION_FILE
         3 000333   040004 713400                    CLIMB   16388
         3 000334   400000 401760                    pmme    nvectors=1

      746     7426    3                         RETURN;

   7426  3 000335   200342 221300                    LDX1  ! I+2,,AUTO
         3 000336   000001 702211                    TSX2  ! 1,X1

      747     7427    3                       END;
      748     7428    2      END POSITION_ERROR; /* proc */
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:125  

   7428  3 000337   200342 221300                    LDX1  ! I+2,,AUTO
         3 000340   000001 702211                    TSX2  ! 1,X1

      749     7429    1   END X9WS$REPOS; /* proc */

   7429  3 000341   000000 702200 xent               TSX2  ! X66_ARET
      750     7430        %EJECT;
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:126  

PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:127  
--  Include file information  --

   X9A_LIB_IO.:X8A6TOU  cannot be made into a system file and is referenced.
   X9A_IO.:X8A6TOU  is referenced.
   XS_MACRO_C.:LIBRARY  is referenced.
   X9A_FAB.:X8A6TOU  is referenced.
   X8A_ERRCOM.:X8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_SYS_FILE.:X8A6TOU  is referenced.
      No diagnostics issued in procedure X9WS$REPOS.
PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:128  

 **** Variables and constants ****

  ****  Section 001  Data  X9WS$REPOS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 ID_BUF                    14-0-0/d STRC(144)   r     1 POSITION_FILE
     2-0-0/d STRC(360)   r     1 START

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FAB                       4-0-0/w PTR         r     1 @KEY_SENT
     5-0-0/w PTR         r     1 @N                        32-0-0/w PTR         r     1 DCB$
    *0-0-0/d STRC(2232)  r     1 FAB                      340-0-0/w SBIN        r     1 I
   136-0-0/w SBIN        r     1 INDX_LEN                  *0-0-0/w BIT         r     1 KEY_SENT
   240-0-0/c CHAR(255)   r     1 LOW_VALUE                 *0-0-0/w SBIN        r     1 N
     6-0-0/c CHAR(80)          1 SPECIAL_ERR_MSG           35-0-0/c CHAR(255)   r     1 START_INDX
   135-0-0/w PTR         r     1 START_INDX$              140-0-0/w STRC(2304)  r     1 START_KEYED_KEY
   137-0-0/w UBIN        r     1 START_RELATIVE_KEY        33-0-0/w PTR         r     1 USE$$
    34-0-0/w EPTR        r     1 USE_ENTRY$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=X9WS$REPOS File=X9WS.:X8A6TSI                                 SAT 08/09/97 11:11 Page:129  
     0-0-0/d STRC(72)    r     1 ALT_KEYS                   0-0-0/w STRC(2448)        1 B$ALT
     0-0-0/w STRC(144)         1 B$TCB                      0-0-0N  NULL        r     1 M$UC
     0-0-0/d ASTR(3528)  r     1 M$XX                       0-0-0/c ACHR        r     1 START_INDEX_KEY
     0-0-0/w STRC(864)         1 USE_PROC


   Procedure X9WS$REPOS requires 226 words for executable code.
   Procedure X9WS$REPOS requires 230 words of local(AUTO) storage.

    No errors detected in file X9WS.:X8A6TSI    .
