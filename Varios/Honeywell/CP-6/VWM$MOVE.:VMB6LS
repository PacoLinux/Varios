VERSION B06

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:1    
        1        1        /*M* VWM$MOVE - User interface for file transporter. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*F**
        9        9        *
       10       10        *   NAME:  VWM$MOVE
       11       11        *
       12       12        *   PURPOSE:
       13       13        *       To provide a user interface for file transfer.
       14       14        *
       15       15        *   DESCRIPTION:
       16       16        *       Parse the user's command(s) into VW_OPTIONS#, then call the
       17       17        *       BEAM or SUCK subroutines to perform the task.
       18       18        *
       19       19        *   REFERENCE:
       20       20        *       See the appropriate Architecture File document for a description
       21       21        *       of MOVE.
       22       22        *
       23       23        ****/
       24       24
       25       25        /*D**
       26       26        *
       27       27        *   NAME:  VWM$MOVE
       28       28        *
       29       29        *   CALL:
       30       30        *       Main program.
       31       31        *
       32       32        *   PARAMETERS:
       33       33        *       None.
       34       34        *
       35       35        *   INTERFACE:
       36       36        *       Calls VWB$BEAM, VWK$SUCK, and references VWY$YOUCALLD.
       37       37        *       Also uses the parser, XUR$ routines, and ASZ$SCRAMBLE.
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:2    
       38       38        *
       39       39        *   ENVIRONMENT:
       40       40        *       This is the main program for the user interface for file transfer.
       41       41        *
       42       42        *   INPUT:
       43       43        *       B$JIT.CCBUF may contain a command to be parsed; if it doesn't,
       44       44        *       the user is prompted for input.
       45       45        *
       46       46        *   OUTPUT:
       47       47        *       VW_OPTIONS# is set up for a file transfer when valid data are
       48       48        *       parsed.  VW_IAM# is set up with the name of "this" node.  Other
       49       49        *       VW_? global symbols reside here and may be initialized, though
       50       50        *       this routine usually doesn't use them.
       51       51        *
       52       52        *   SCRATCH:
       53       53        *       None.
       54       54        *
       55       55        *   DESCRIPTION:
       56       56        *       MOVE moves files between CP-6 systems, Any file type may be
       57       57        *       transmitted; keys, DVBYTE, and file attributes are retained,
       58       58        *       unless otherwise specified.
       59       59        *
       60       60        ****/
       61       61
       62       62        VWM$MOVE: PROC MAIN NOAUTO;
       63       63
       64       64        /****
       65       65        *
       66       66        *   %INCLUDEs
       67       67        *
       68       68        ****/
       69       69
       70       70        %INCLUDE B$TABLES_C;
       71      178        %INCLUDE CP_6;
       72     5737        %INCLUDE CP_6_SUBS;
       73     6277        %INCLUDE B$JIT;
       74     6880        %INCLUDE B_ERRORS_C;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:3    
       75     8007        %INCLUDE KL_SUPER_C;
       76    10909        %INCLUDE XU_MACRO_C;
       77    14015        %INCLUDE XUR_ENTRY;
       78    14047        %INCLUDE VW_MOVE_E;
       79    14125        %INCLUDE VWM_ERRS_E;
       80    14499        %INCLUDE VW_OPTS_M;
       81    15183        %MOVE_OPTIONS(STCLASS="STATIC SYMDEF");
       82    15686        %INCLUDE VW_NODEATER_E;
       83    15742        %INCLUDE VW_FPTS_M;
       84    16163        %KL_DREC(NAME=HLPBUF,LAST=",");
       85    16276        %KL_FEBLK(LVL=2,STCLASS=STATIC,RCNT=31);
       86    16325
       87    16326        /****
       88    16327        *
       89    16328        *   FPTs
       90    16329        *
       91    16330        ****/
       92    16331
       93    16332                  %P_PCB;
       94    16531
       95    16532        %PARSE$OUT;
       96    16577
       97    16578        %PARSE$SYM;
       98    16616
       99    16617        %B$XL_UPPER;
      100    16621        %B$SR_NON_BLANK;
      101    16625
      102    16626        %FPT_PRIV (FPTN=FMSEC, PRIV=%PR_FMSEC#);
      103    16641
      104    16642        %FPT_EXIT(STEPCC=ABORT);
      105    16657
      106    16658        %FPT_INT(UENTRY=VWY$YOUCALLD);
      107    16672
      108    16673        %FPT_FID(FPTN=FID_INP,
      109    16674                 ACCT=ACCT_INP,
      110    16675                 NAME=NAME_INP,
      111    16676                 PASS=PASS_INP,
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:4    
      112    16677                 SN=SN_INP,
      113    16678                 ASN=ASN_INP,
      114    16679                 RES=RES_INP,
      115    16680                 RESULTS=INP_VLR);
      116    16703
      117    16704        %VLP_ACCT(FPTN=ACCT_INP,
      118    16705                  ACCT='        ');
      119    16718
      120    16719        %VLP_NAME(FPTN=NAME_INP,
      121    16720                  LEN=31,
      122    16721                  NAME=' ');
      123    16748
      124    16749        %VLP_PASS(FPTN=PASS_INP,
      125    16750                  PASS='        ');
      126    16763
      127    16764        %VLP_SN(FPTN=SN_INP,
      128    16765                N=6);
      129    16778
      130    16779        %VLR_FID(FPTN=INP_VLR);
      131    16798
      132    16799        %FPT_FID(FPTN=FID_OUT,
      133    16800                 ACCT=ACCT_OUT,
      134    16801                 NAME=NAME_OUT,
      135    16802                 PASS=PASS_OUT,
      136    16803                 SN=SN_OUT,
      137    16804                 ASN=ASN_OUT,
      138    16805                 RES=RES_OUT,
      139    16806                 RESULTS=OUT_VLR);
      140    16829
      141    16830        %VLP_ACCT(FPTN=ACCT_OUT,
      142    16831                  ACCT='        ');
      143    16844
      144    16845        %VLP_NAME(FPTN=NAME_OUT,
      145    16846                  LEN=31,
      146    16847                  NAME=' ');
      147    16874
      148    16875        %VLP_PASS(FPTN=PASS_OUT,
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:5    
      149    16876                  PASS='        ');
      150    16889
      151    16890        %VLP_SN(FPTN=SN_OUT,
      152    16891                N=6);
      153    16904
      154    16905        %VLR_FID(FPTN=OUT_VLR);
      155    16924
      156    16925        %VLR_FID(FPTN=MAIL_VLR);
      157    16944
      158    16945        %FPT_UNFID(FPTN=UNFID_INP,
      159    16946                   ACCT=ACCT_INP,
      160    16947                   ASN=ASN_INP,
      161    16948                   LEN=I,
      162    16949                   NAME=NAME_INP,
      163    16950                   PASS=PASS_INP,
      164    16951                   RES=RES_INP,
      165    16952                   SN=SN_INP,
      166    16953                   TEXTFID=OPTS.INP.FID);
      167    16971
      168    16972        %FPT_UNFID(FPTN=UNFID_OUT,
      169    16973                   ACCT=ACCT_OUT,
      170    16974                   ASN=ASN_OUT,
      171    16975                   LEN=I,
      172    16976                   NAME=NAME_OUT,
      173    16977                   PASS=PASS_OUT,
      174    16978                   RES=RES_OUT,
      175    16979                   SN=SN_OUT,
      176    16980                   TEXTFID=OPTS.OUT.FID);
      177    16998
      178    16999        %FPT_OPEN(FPTN=OPEN_ITST,
      179    17000                  DCB=M$INP,
      180    17001                  NAME=NAME_INP,
      181    17002                  ACCT=ACCT_INP,
      182    17003                  PASS=PASS_INP,
      183    17004                  ASN=FILE,
      184    17005                  FUN=IN,
      185    17006                  TEST=YES,
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:6    
      186    17007                  SCRUB=YES,
      187    17008                  EXIST=OLDFILE,
      188    17009                  SN=SN_INP);
      189    17118
      190    17119        %FPT_OPEN(FPTN=OPEN_OTST,
      191    17120                  DCB=M$INP,
      192    17121                  NAME=NAME_OUT,
      193    17122                  ACCT=ACCT_OUT,
      194    17123                  PASS=PASS_OUT,
      195    17124                  ASN=FILE,
      196    17125                  FUN=IN,
      197    17126                  TEST=YES,
      198    17127                  SCRUB=YES,
      199    17128                  EXIST=OLDFILE,
      200    17129                  SN=SN_OUT);
      201    17238
      202    17239        %FPT_READ(FPTN=READ_ME,
      203    17240                  DCB=M$ME,
      204    17241                  BUF=MEBUF);
      205    17280
      206    17281        %FPT_OPEN(FPTN=OPEN_HLP,
      207    17282                  DCB=M$HLP,
      208    17283                  NAME=NAME_HLP,
      209    17284                  ACCT=ACCT_HLP,
      210    17285                  FUN=IN,
      211    17286                  ACS=DIRECT,
      212    17287                  SHARE=ALL,
      213    17288                  ASN=FILE);
      214    17397
      215    17398        %VLP_NAME(FPTN=NAME_HLP,
      216    17399                  LEN=4,
      217    17400                  NAME=':HLP');
      218    17427
      219    17428        %VLP_ACCT(FPTN=ACCT_HLP,
      220    17429                  ACCT=':SYS');
      221    17442
      222    17443        %FPT_READ(FPTN=READ_HLP,
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:7    
      223    17444                  DCB=M$HLP,
      224    17445                  BUF=HLPBUF,
      225    17446                  KEYS=YES,
      226    17447                  KEY=ACCTNAME);
      227    17486
      228    17487        %FPT_CLOSE(FPTN=CLOSE_HLP,
      229    17488                   DCB=M$HLP,
      230    17489                   DISP=SAVE);
      231    17531
      232    17532        %FPT_WAIT(FPTN=SNOOZE,
      233    17533                  UNITS=5);
      234    17547
      235    17548        %FPT_TRMCTL(FPTN=ECHO_OF,
      236    17549                    TRMCTL=VLP_OF);
      237    17576
      238    17577        %VLP_TRMCTL(FPTN=VLP_OF,
      239    17578                    DISPINPUT=NO);
      240    17618
      241    17619        %FPT_TRMCTL(FPTN=ECHO_ON,
      242    17620                    TRMCTL=VLP_ON);
      243    17647
      244    17648        %VLP_TRMCTL(FPTN=VLP_ON,
      245    17649                    DISPINPUT=YES);
      246    17689
      247    17690        %FPT_PROMPT(VFC=YES);
      248    17718
      249    17719        %FPT_PRIV(PRIV=%PR_FMREAD#);
      250    17734
      251    17735        %M$DCB(DCBN=M$CONTINUATION,
      252    17736               ASN=FILE,
      253    17737               EXIST=OLDFILE,
      254    17738               FUN=IN,
      255    17739               NAME='*CONTINUATION_COMMANDS');
      256    17813
      257    17814        %F$DCB(DCBN=DUMMY);
      258    17871
      259    17872        %B$TCB;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:8    
      260    17875
      261    17876        %B$ALT;
      262    17884
      263    17885        %XUR_INIT(SYNTAX=YES,
      264    17886                  PCB=P_PCB,
      265    17887                  WORK=WRKBUF);
      266    17986
      267    17987        /****
      268    17988        *
      269    17989        *   Local variables.
      270    17990        *
      271    17991        ****/
      272    17992
      273    17993    1   DCL VWB$BEAM                       ENTRY(1) ALTRET;
      274    17994    1   DCL VWK$SUCK                       ENTRY ALTRET;
      275    17995    1   DCL VWY$YOUCALLD                   ENTRY ASYNC;
      276    17996
      277    17997    1   DCL VWM_COMMAND SYMREF             BIT(36);
      278    17998    1   DCL B$JIT$ SYMREF                  PTR;
      279    17999    1   DCL B$TCB$ SYMREF                  PTR;
      280    18000    1   DCL 1 B_VERSION SYMREF,
      281    18001    1         2 L UNAL                     UBIN BYTE,
      282    18002    1         2 C UNAL                     CHAR(B_VERSION.L);
      283    18003
      284    18004    1   DCL M$ME                           DCB;
      285    18005    1   DCL M$LL                           DCB;
      286    18006    1   DCL M$NODE                         DCB;
      287    18007    1   DCL M$INP                          DCB;
      288    18008    1   DCL M$HLP                          DCB;
      289    18009
      290    18010    1   DCL I                              SBIN;
      291    18011    1   DCL J                              SBIN;
      292    18012    1   DCL K                              SBIN;
      293    18013    1   DCL OPTX                           SBIN;
      294    18014    1   DCL RECX                           SBIN;
      295    18015    1   DCL VW_INPCNT# STATIC SYMDEF       SBIN;
      296    18016    1   DCL VW_OUTCNT# STATIC SYMDEF       SBIN;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:9    
      297    18017    1   DCL VW_TOTBYTES# STATIC SYMDEF     SBIN;
      298    18018    1   DCL ASN_INP                        UBIN BYTE;
      299    18019    1   DCL ASN_OUT                        UBIN BYTE;
      300    18020    1   DCL RES_INP                        CHAR(4);
      301    18021    1   DCL RES_OUT                        CHAR(4);
      302    18022
      303    18023    1   DCL P                              PTR;
      304    18024    1   DCL BLK$                           PTR;
      305    18025    1   DCL OPT$                           PTR;
      306    18026
      307    18027    1   DCL WRKBUF STATIC DALIGNED         CHAR(4096);
      308    18028    1   DCL MEBUF STATIC                   CHAR(256);
      309    18029    1   DCL LOBUF STATIC                   CHAR(256);
      310    18030    1   DCL DWORK                          CHAR(8);
      311    18031    1   DCL VW_IAM# STATIC SYMDEF          CHAR(8);
      312    18032    1   DCL ASTERISK CONSTANT              CHAR(2) INIT('@*');
      313    18033
      314    18034    1   DCL 1 ACCTNAME STATIC,
      315    18035    1         2 L UNAL                     UBIN BYTE,
      316    18036    1         2 ACCT UNAL                  CHAR(8),
      317    18037    1         2 NAME UNAL                  CHAR(12);
      318    18038
      319    18039    1   DCL 1 ERRMSGFID CONSTANT,
      320    18040    1         2 L UNAL                     UBIN BYTE INIT(15),
      321    18041    1         2 C UNAL                     CHAR(39) INIT(':VWERRMSG.:SYS');
      322    18042
      323    18043    1   DCL 1 U1,
      324    18044    1         2 L UNAL                     UBIN BYTE,
      325    18045    1         2 C UNAL                     CHAR(79);
      326    18046
      327    18047    1   DCL 1 PROMPT CONSTANT,
      328    18048    1         2 * UNAL                     UBIN BYTE INIT(2),
      329    18049    1         2 * UNAL                     CHAR(2) INIT('::');
      330    18050
      331    18051    1   DCL VW_SCRAMBLE# STATIC SYMDEF     BIT(1);
      332    18052    1   DCL ONCE                           BIT(1);
      333    18053
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:10   
      334    18054    1   DCL UPPERS(0:1) CONSTANT           CHAR(64) INIT(
      335    18055    1           '                                 !"#$%&''()*+,-./0123456789:;<=>?',
      336    18056    1           '@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{|}~ ');
      337    18057
      338    18058
      339    18059    1   dcl  VWM$GET_MAILBOX      entry(3) altret;
      340    18060    1   dcl  VWM$FIX_MAILBOX      entry(3) altret;
      341    18061
      342    18062        %EJECT;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:11   
      343    18063        /****
      344    18064        *
      345    18065        *   Main program for user interface.  Parse command into OPTS
      346    18066        *   then pass command to BEAM or SUCK as appropriate.
      347    18067        *
      348    18068        ****/
      349    18069
      350    18070        /****
      351    18071        *
      352    18072        *   MOVE is linked with FMSEC so that it can forcibly write files into
      353    18073        *   the :MOVE account for intrasystem beaming (used to support external
      354    18074        *   nodes).  This privilege is on when MOVE is entered, so it should be
      355    18075        *   turned back off unless the user is authorized for that privilege.
      356    18076        *
      357    18077        ****/
      358    18078
      359    18079    1           IF B$JIT.PRIV.ACTIVE.FMSEC AND NOT B$JIT.PRIV.JOB.FMSEC
      360    18080    1           THEN
      361    18081    1              CALL M$RPRIV (FMSEC);
      362    18082
      363    18083        /****
      364    18084        *
      365    18085        *   Initialize the XU routines.
      366    18086        *
      367    18087        ****/
      368    18088
      369    18089    1           CALL XUR$INIT(XUR_INIT);
      370    18090
      371    18091        /****
      372    18092        *
      373    18093        *   Initialize the error message file; turn off FMR if it shouldn't be on.
      374    18094        *   Set up the initial command continuation DCB to M$CONTINUATION.
      375    18095        *
      376    18096        ****/
      377    18097
      378    18098    1           CALL XUR$SETERRMSG(ERRMSGFID);
      379    18099    1           CALL XUR$SETDCBS(DCBNUM(M$CONTINUATION));
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:12   
      380    18100    1           IF NOT (B$JIT.PRIV.JOB&%PR_FMREAD#) THEN
      381    18101    1              CALL M$RPRIV(FPT_PRIV);
      382    18102
      383    18103        /****
      384    18104        *
      385    18105        *   Open the :NODES file, input; then read the *IAM record.
      386    18106        *
      387    18107        ****/
      388    18108
      389    18109    2           CALL M$OPEN(OPEN_NODE) WHENALTRETURN DO;
      390    18110    2              CALL XUR$ERRMSG(%E$VWM_NOD);
      391    18111    2              CALL M$EXIT(FPT_EXIT);
      392    18112    2              END;
      393    18113    1           NODEKEY.L=8;
      394    18114    1           NODEKEY.C='*IAM';
      395    18115    2           CALL M$READ(READ_NODE) WHENALTRETURN DO;
      396    18116    2              CALL XUR$ERRMSG(%E$VWM_NOD);
      397    18117    2              CALL M$EXIT(FPT_EXIT);
      398    18118    2              END;
      399    18119    1           VW_IAM#=NODEOVR.PATH_NAME;
      400    18120
      401    18121        /****
      402    18122        *
      403    18123        *   Parse the command in CCBUF or read from M$SI.
      404    18124        *
      405    18125        ****/
      406    18126
      407    18127    1           ONCE='1'B;
      408    18128    2           IF B$JIT.PRFLAGS.CONTINUED THEN DO;
      409    18129    2              I=1;
      410    18130    2              MEBUF=';';
      411    18131    2              END;
      412    18132    2           ELSE DO;
      413    18133    2              I=B$JIT.CCARS;
      414    18134    2              MEBUF=SUBSTR(B$JIT.CCBUF,0,I);
      415    18135    2              END;
      416    18136
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:13   
      417    18137    1   GET_COMMAND:
      418    18138    1           IF ONCE THEN
      419    18139    2              CALL XUR$GETCMD(VWM_COMMAND,BLK$,,MEBUF,I) WHENALTRETURN DO;
      420    18140    2                 IF P_PCB.HI_CHAR>0 THEN
      421    18141    2                    CALL XUR$ERRPTR(,DCBNUM(M$ME));
      422    18142    2                 CALL XUR$ERRMSG(BLK$);
      423    18143    2                 CALL M$EXIT(FPT_EXIT);
      424    18144    2                 END;
      425    18145    2           ELSE DO;
      426    18146    3              CALL XUR$GETCMD(VWM_COMMAND,BLK$,PROMPT) WHENALTRETURN DO;
      427    18147    3                 I=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      428    18148    3                 IF I=%E$EOF OR I=%E$EOD OR I=%E$EOT THEN
      429    18149    3                    CALL M$EXIT;
      430    18150    3                 IF P_PCB.HI_CHAR>0 THEN
      431    18151    3                    CALL XUR$ERRPTR(,DCBNUM(M$ME));
      432    18152    3                 ELSE
      433    18153    3                    CALL M$EXIT;
      434    18154    3                 CALL XUR$ERRMSG(BLK$);
      435    18155    3                 GOTO GET_COMMAND;
      436    18156    3                 END;
      437    18157    2              CALL XUR$ECHOIF(DCBNUM(M$ME));
      438    18158    2              END;
      439    18159
      440    18160        /****
      441    18161        *
      442    18162        *   Reset working storage cells to defaults.
      443    18163        *
      444    18164        ****/
      445    18165
      446    18166    1           VW_OPTIONS#=' ';
      447    18167    1           OPTS.MAILINIT.WHO='I';
      448    18168    1           OPTX=0;
      449    18169    1           RECX=0;
      450    18170
      451    18171        /****
      452    18172        *
      453    18173        *   Walk through the options list, parsing into OPTS.
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:14   
      454    18174        *
      455    18175        ****/
      456    18176
      457    18177    1           BLK$=P_PCB.OUT$;
      458    18178    1           I=1;
      459    18179
      460    18180        /****
      461    18181        *
      462    18182        *   Look for an ending command.
      463    18183        *
      464    18184        ****/
      465    18185
      466    18186    1           IF OUT$BLK.NSUBLKS<1 THEN
      467    18187    1              CALL M$EXIT;
      468    18188    2           IF OUT$BLK.NSUBLKS=1 THEN DO;
      469    18189    2              P=OUT$BLK.SUBLK$(0);
      470    18190    2              CALL XLATE(U1.C,UPPERS,SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT));
      471    18191    2              IF U1.C='END' OR U1.C='QUIT' OR U1.C='STOP' OR U1.C='EXIT'
      472    18192    2                OR U1.C='X' OR U1.C='E' OR U1.C='Q' THEN
      473    18193    2                 CALL M$EXIT;
      474    18194    2              END;
      475    18195
      476    18196        /****
      477    18197        *
      478    18198        *   Look for the input FID.
      479    18199        *
      480    18200        ****/
      481    18201
      482    18202    1           IF I>=OUT$BLK.NSUBLKS THEN
      483    18203    1              GOTO DONE_PARSING;
      484    18204    1           P=OUT$BLK.SUBLK$(I);
      485    18205    2           IF P->OUT$BLK.CODE=%FID# THEN DO;
      486    18206    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>79 THEN DO;
      487    18207    3                 CALL XUR$ERRMSG(%E$VWM_ITL);
      488    18208    3                 GOTO DECIDE;
      489    18209    3                 END;
      490    18210    2              OPTS.INP.L=ASCBIN('/')+P->OUT$SYM.COUNT;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:15   
      491    18211    2              OPTS.INP.FID=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);
      492    18212
      493    18213        /****
      494    18214        *
      495    18215        *   See if the WSN came along for the ride.
      496    18216        *
      497    18217        ****/
      498    18218
      499    18219    3              IF SUBSTR(OPTS.INP.FID,0,1)~='''' THEN DO;
      500    18220    4                 CALL INDEX(J,'@',OPTS.INP.FID) WHENRETURN DO;
      501    18221    5                    IF J>0 THEN DO;
      502    18222    5                       OPTS.INP.L=ASCBIN('/')+J;
      503    18223    5                       OPTS.INP.FID=SUBSTR(OPTS.INP.FID,0,J);
      504    18224    5                       END;
      505    18225    5                    ELSE DO;
      506    18226    5                       CALL XUR$ERRMSG(%E$VWM_ITL);
      507    18227    5                       GOTO DECIDE;
      508    18228    5                       END;
      509    18229    4                    P->OUT$BLK.CODE=%WSN#;
      510    18230    4                    P->OUT$SYM.COUNT=P->OUT$SYM.COUNT-J-1;
      511    18231    4                    CALL XLATE (P->OUT$SYM.TEXT, B$XL_UPPER, SUBSTR(P->OUT$SYM.TEXT,J+1
             18231                             ,P->OUT$SYM.COUNT));
      512    18232    4                    END;
      513    18233    4                 WHENALTRETURN DO;
      514    18234    4                    I=I+1;
      515    18235    4                    END;
      516    18236    3                 END;
      517    18237    2              ELSE
      518    18238    2                 I=I+1;
      519    18239    2              END;
      520    18240
      521    18241        /****
      522    18242        *
      523    18243        *   Look for a source node.
      524    18244        *
      525    18245        ****/
      526    18246
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:16   
      527    18247    1           IF I>=OUT$BLK.NSUBLKS THEN
      528    18248    1              GOTO DONE_PARSING;
      529    18249    1           P=OUT$BLK.SUBLK$(I);
      530    18250    2           IF P->OUT$BLK.CODE=%WSN# THEN DO;
      531    18251    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>8 THEN DO;
      532    18252    3                 CALL XUR$ERRMSG(%E$VWM_SRC);
      533    18253    3                 GOTO DECIDE;
      534    18254    3                 END;
      535    18255    2              OPTS.INP.NODE=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);
      536    18256    2              I=I+1;
      537    18257    2              END;
      538    18258
      539    18259        /****
      540    18260        *
      541    18261        *   Look for source options.
      542    18262        *
      543    18263        ****/
      544    18264
      545    18265    1           IF I>=OUT$BLK.NSUBLKS THEN
      546    18266    1              GOTO DONE_PARSING;
      547    18267    1           P=OUT$BLK.SUBLK$(I);
      548    18268    2           IF P->OUT$BLK.CODE=%OPTLST# THEN DO;
      549    18269    2              CALL OPTIONS(P,OPTS.INP) ALTRET(DECIDE);
      550    18270    2              I=I+1;
      551    18271    2              END;
      552    18272
      553    18273        /****
      554    18274        *
      555    18275        *   Look for ON/TO/INTO/OVER.
      556    18276        *
      557    18277        ****/
      558    18278
      559    18279    1           IF I>=OUT$BLK.NSUBLKS THEN
      560    18280    1              GOTO DONE_PARSING;
      561    18281    1           P=OUT$BLK.SUBLK$(I);
      562    18282    2           IF P->OUT$BLK.CODE>=%HOWTO# AND P->OUT$BLK.CODE<=%HOWOVER# THEN DO;
      563    18283    2              OPTS.OUT.MISC.HOW=P->OUT$BLK.CODE-%HOWTO#;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:17   
      564    18284    2              I=I+1;
      565    18285    2              END;
      566    18286
      567    18287        /****
      568    18288        *
      569    18289        *   Look for the output FID.
      570    18290        *
      571    18291        ****/
      572    18292
      573    18293    1           IF I>=OUT$BLK.NSUBLKS THEN
      574    18294    1              GOTO DONE_PARSING;
      575    18295    1           P=OUT$BLK.SUBLK$(I);
      576    18296    2           IF P->OUT$BLK.CODE=%FID# THEN DO;
      577    18297    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>79 THEN DO;
      578    18298    3                 CALL XUR$ERRMSG(%E$VWM_OTL);
      579    18299    3                 GOTO DECIDE;
      580    18300    3                 END;
      581    18301    2              OPTS.OUT.L=ASCBIN('/')+P->OUT$SYM.COUNT;
      582    18302    2              OPTS.OUT.FID=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);
      583    18303
      584    18304        /****
      585    18305        *
      586    18306        *   See if the WSN came along for the ride.
      587    18307        *
      588    18308        ****/
      589    18309
      590    18310    3              IF SUBSTR(OPTS.OUT.FID,0,1)~='''' THEN DO;
      591    18311    4                 CALL INDEX(J,'@',OPTS.OUT.FID) WHENRETURN DO;
      592    18312    5                    IF J>0 THEN DO;
      593    18313    5                       OPTS.OUT.L=ASCBIN('/')+J;
      594    18314    5                       OPTS.OUT.FID=SUBSTR(OPTS.OUT.FID,0,J);
      595    18315    5                       END;
      596    18316    5                    ELSE DO;
      597    18317    5                       CALL XUR$ERRMSG(%E$VWM_OTL);
      598    18318    5                       GOTO DECIDE;
      599    18319    5                       END;
      600    18320    4                    P->OUT$BLK.CODE=%WSN#;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:18   
      601    18321    4                    P->OUT$SYM.COUNT=P->OUT$SYM.COUNT-J-1;
      602    18322    4                    CALL XLATE (P->OUT$SYM.TEXT, B$XL_UPPER, SUBSTR(P->OUT$SYM.TEXT,J+1
             18322                             ,P->OUT$SYM.COUNT));
      603    18323    4                    END;
      604    18324    4                 WHENALTRETURN DO;
      605    18325    4                    I=I+1;
      606    18326    4                    END;
      607    18327    3                 END;
      608    18328    2              ELSE
      609    18329    2                 I=I+1;
      610    18330    2              END;
      611    18331
      612    18332        /****
      613    18333        *
      614    18334        *   Look for a destination node.
      615    18335        *
      616    18336        ****/
      617    18337
      618    18338    1           IF I>=OUT$BLK.NSUBLKS THEN
      619    18339    1              GOTO DONE_PARSING;
      620    18340    1           P=OUT$BLK.SUBLK$(I);
      621    18341    2           IF P->OUT$BLK.CODE=%WSN# THEN DO;
      622    18342    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>8 THEN DO;
      623    18343    3                 CALL XUR$ERRMSG(%E$VWM_DST);
      624    18344    3                 GOTO DECIDE;
      625    18345    3                 END;
      626    18346    2              OPTS.OUT.NODE=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);
      627    18347    2              I=I+1;
      628    18348    2              END;
      629    18349
      630    18350        /****
      631    18351        *
      632    18352        *   Look for destination options.
      633    18353        *
      634    18354        ****/
      635    18355
      636    18356    1           IF I>=OUT$BLK.NSUBLKS THEN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:19   
      637    18357    1              GOTO DONE_PARSING;
      638    18358    1           P=OUT$BLK.SUBLK$(I);
      639    18359    2           IF P->OUT$BLK.CODE=%OPTLST# THEN DO;
      640    18360    2              CALL OPTIONS(P,OPTS.OUT) ALTRET(DECIDE);
      641    18361    2              I=I+1;
      642    18362    2              END;
      643    18363
      644    18364        /****
      645    18365        *
      646    18366        *   Oops, we should never get here without I>=OUT$BLK.NSUBLKS.
      647    18367        *
      648    18368        ****/
      649    18369
      650    18370    2           IF I<OUT$BLK.NSUBLKS THEN DO;
      651    18371    2              CALL XUR$ERRMSG(%E$VWM_SYN);
      652    18372    2              GOTO DECIDE;
      653    18373    2              END;
      654    18374
      655    18375        /****
      656    18376        *
      657    18377        *   Everything has been parsed into OPTS.  Now fix things up and
      658    18378        *   check for insanities.
      659    18379        *
      660    18380        ****/
      661    18381
      662    18382    1   DONE_PARSING:
      663    18383
      664    18384        /****
      665    18385        *
      666    18386        *   Fix up the input node specification and check that it exists.
      667    18387        *   If the node name is LOCAL or the *IAM node, blank it (it's us).
      668    18388        *   Strange things will happen if some yo-yo specifies a local
      669    18389        *   synonym for the input node.
      670    18390        *
      671    18391        ****/
      672    18392
      673    18393    1           IF OPTS.INP.NODE=' ' OR OPTS.INP.NODE='LOCAL' OR OPTS.INP.NODE=VW_IAM# THEN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:20   
      674    18394    1              OPTS.INP.NODE=' ';
      675    18395    2           ELSE DO;
      676    18396    2              NODEKEY.C=OPTS.INP.NODE;
      677    18397    3              CALL M$READ(READ_NODE) WHENALTRETURN DO;
      678    18398    3                 CALL XUR$ERRMSG(%E$VWM_SND);
      679    18399    3                 GOTO DECIDE;
      680    18400    3                 END;
      681    18401    3              IF DCBADDR(DCBNUM(M$NODE))->DUMMY.ARS#=8 THEN DO;
      682    18402    3                 OPTS.INP.NODE=NODEOVR.PATH_NAME;
      683    18403    3                 NODEKEY.C=NODEOVR.PATH_NAME;
      684    18404    4                 CALL M$READ(READ_NODE) WHENALTRETURN DO;
      685    18405    4                    CALL XUR$ERRMSG(%E$VWM_SND);
      686    18406    4                    GOTO DECIDE;
      687    18407    4                    END;
      688    18408    3                 IF OPTS.INP.NODE=' ' OR OPTS.INP.NODE='LOCAL' OR
      689    18409    3                   OPTS.INP.NODE=VW_IAM# THEN
      690    18410    3                    OPTS.INP.NODE=' ';
      691    18411    3                 END;
      692    18412    2              IF NODEOVR.TYPE_DEST = %N_EXTERNAL#
      693    18413    3              THEN DO;
      694    18414    3                 CALL XUR$ERRMSG (%E$VWM_EXTERNAL);
      695    18415    3                 GOTO DECIDE;
      696    18416    3                 END;
      697    18417    2              END;
      698    18418
      699    18419        /****
      700    18420        *
      701    18421        *   Fix up the output node specification and check that it exists.
      702    18422        *   Zap the node name if it's us (like above).
      703    18423        *
      704    18424        ****/
      705    18425
      706    18426    1           IF OPTS.OUT.NODE=' ' OR OPTS.OUT.NODE='LOCAL' OR OPTS.OUT.NODE=VW_IAM# THEN
      707    18427    1              OPTS.OUT.NODE=' ';
      708    18428    2           ELSE DO;
      709    18429    2              NODEKEY.C=OPTS.OUT.NODE;
      710    18430    3              CALL M$READ(READ_NODE) WHENALTRETURN DO;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:21   
      711    18431    3                 CALL XUR$ERRMSG(%E$VWM_DND);
      712    18432    3                 GOTO DECIDE;
      713    18433    3                 END;
      714    18434    3              IF DCBADDR(DCBNUM(M$NODE))->DUMMY.ARS#=8 THEN DO;
      715    18435    3                 DWORK=OPTS.OUT.NODE;
      716    18436    3                 OPTS.OUT.NODE=NODEOVR.PATH_NAME;
      717    18437    3                 NODEKEY.C=NODEOVR.PATH_NAME;
      718    18438    4                 CALL M$READ(READ_NODE) WHENALTRETURN DO;
      719    18439    4                    CALL XUR$ERRMSG(%E$VWM_DND);
      720    18440    4                    GOTO DECIDE;
      721    18441    4                    END;
      722    18442    3                 IF NODEOVR.TYPE_DEST = %N_EXTERNAL#
      723    18443    3                 THEN
      724    18444    3                    OPTS.OUT.NODE = DWORK;
      725    18445    3                 IF OPTS.OUT.NODE=' ' OR OPTS.OUT.NODE='LOCAL' OR
      726    18446    3                   OPTS.OUT.NODE=VW_IAM# THEN
      727    18447    3                    OPTS.OUT.NODE=' ';
      728    18448    3                 END;
      729    18449    2              END;
      730    18450
      731    18451        /****
      732    18452        *
      733    18453        *   See if there's an input FID.  If not, say hi and prompt for a command.
      734    18454        *
      735    18455        ****/
      736    18456
      737    18457    2           IF CARD(1)=' ' THEN DO;
      738    18458    3              IF ONCE THEN DO;
      739    18459    3                 ONCE='0'B;
      740    18460    3                 CALL XUR$ERRMSG(%E$VWM_HI,,,VECTOR(B_VERSION));
      741    18461    3                 CALL XUR$SETDCBS(DCBNUM(M$ME));
      742    18462    3                 END;
      743    18463    2              ELSE
      744    18464    2                 CALL XUR$ERRMSG(%E$VWM_NTD);
      745    18465    2              GOTO GET_COMMAND;
      746    18466    2              END;
      747    18467
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:22   
      748    18468        /****
      749    18469        *
      750    18470        *   Check for trying to send a file to the same node as it is on, i.e.,
      751    18471        *   @X -> @X.
      752    18472        *
      753    18473        ****/
      754    18474
      755    18475    2           IF OPTS.INP.NODE=OPTS.OUT.NODE THEN DO;
      756    18476    2              CALL XUR$ERRMSG(%E$VWM_PCL);
      757    18477    2              GOTO DECIDE;
      758    18478    2              END;
      759    18479
      760    18480        /****
      761    18481        *
      762    18482        *   If this isn't a "foreign" file name, check to make sure that
      763    18483        *   it's a valid file name and device type for us to MOVE.
      764    18484        *
      765    18485        ****/
      766    18486
      767    18487    2           IF OPTS.INP.NODE=' ' OR SUBSTR(OPTS.INP.FID,0,1)~='''' THEN DO;
      768    18488
      769    18489    2              FID_INP.TEXTFID_=VECTOR(OPTS.INP.FID);
      770    18490    3              CALL M$FID(FID_INP) WHENALTRETURN DO;
      771    18491    3                 CALL XUR$ERRMSG(%E$VWM_INP);
      772    18492    3                 GOTO DECIDE;
      773    18493    3                 END;
      774    18494
      775    18495    3              IF ASN_INP~=%DEVICE# AND ASN_INP~=%FILE# AND ASN_INP~=%TAPE# THEN DO;
      776    18496    3                 CALL XUR$ERRMSG(%E$VWM_INP);
      777    18497    3                 GOTO DECIDE;
      778    18498    3                 END;
      779    18499
      780    18500    2              IF ASN_INP=%DEVICE# AND
      781    18501    2                SUBSTR(RES_INP,0,2)~='CR' AND
      782    18502    2                SUBSTR(RES_INP,0,2)~='ME' AND
      783    18503    2                SUBSTR(RES_INP,0,2)~='LT' AND
      784    18504    2                SUBSTR(RES_INP,0,2)~='MT' AND
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:23   
      785    18505    3                SUBSTR(RES_INP,0,2)~='FT' THEN DO;
      786    18506    3                 CALL XUR$ERRMSG(%E$VWM_INP);
      787    18507    3                 GOTO DECIDE;
      788    18508    3                 END;
      789    18509
      790    18510    2              IF (ASN_INP=%FILE# OR SUBSTR(RES_INP,0,2)='LT') AND NOT INP_VLR.NAME
      791    18511    3              THEN DO;
      792    18512    3                 INP_VLR.NAME='1'B;
      793    18513    3                 NAME_INP.NAME#='?';
      794    18514    3                 NAME_INP.L#=1;
      795    18515    3                 END;
      796    18516
      797    18517        /****
      798    18518        *
      799    18519        *   Force M$UNFID to materialize an account.
      800    18520        *
      801    18521        ****/
      802    18522
      803    18523    2              IF OPTS.INP.NODE=' ' AND
      804    18524    2                ((ASN_INP=%FILE# AND NOT INP_VLR.ACCT) OR
      805    18525    3                (INP_VLR.ACCT AND ACCT_INP.ACCT#=' ')) THEN DO;
      806    18526    3                 INP_VLR.ACCT='1'B;
      807    18527    3                 ACCT_INP.ACCT#=B$JIT.FACCN;
      808    18528    3                 IF SN_INP.SN#(0)=' ' THEN
      809    18529    3                    SN_INP.SN#(0)=B$JIT.FPSN;
      810    18530    3                 END;
      811    18531    3              CALL M$UNFID(UNFID_INP) WHENALTRETURN DO;
      812    18532    3                 CALL XUR$ERRMSG(%E$VWM_ITL);
      813    18533    3                 GOTO DECIDE;
      814    18534    3                 END;
      815    18535    2              OPTS.INP.L=I+ASCBIN('/');
      816    18536
      817    18537    2              END;
      818    18538
      819    18539        /****
      820    18540        *
      821    18541        *   If the input node is here and the input name and account matches
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:24   
      822    18542        *   the JIT name and account, blank the input name and account.
      823    18543        *
      824    18544        ****/
      825    18545
      826    18546    1           IF OPTS.INP.NODE=' ' AND OPTS.INP.ACCT=B$JIT.ACCN AND
      827    18547    2             OPTS.INP.NAME=B$JIT.UNAME THEN DO;
      828    18548    2              OPTS.INP.ACCT=' ';
      829    18549    2              OPTS.INP.NAME=' ';
      830    18550    2              OPTS.INP.EPASS=' ';
      831    18551    2              END;
      832    18552
      833    18553        /****
      834    18554        *
      835    18555        *   If the input node is here and the input account, name is blank,
      836    18556        *   check to see if the file exists if it isn't wildcarded.
      837    18557        *
      838    18558        ****/
      839    18559
      840    18560    2           IF OPTS.INP.NODE=' ' AND OPTS.INP.ACCT=' ' AND ASN_INP=%FILE# THEN DO;
      841    18561    3              CALL INDEX(I,'?',SUBSTR(NAME_INP.NAME#,0,NAME_INP.L#)) WHENALTRETURN DO;
      842    18562    4                 CALL M$OPEN(OPEN_ITST) WHENALTRETURN DO;
      843    18563    4                    CALL XUR$ERRMSG(B$TCB$->B$TCB.ALT$->B$ALT.ERR,DCBNUM(M$INP));
      844    18564    4                    GOTO DECIDE;
      845    18565    4                    END;
      846    18566    3                 END;
      847    18567    2              END;
      848    18568
      849    18569        /****
      850    18570        *
      851    18571        *   Work with the output FID.  If it's not a "foreign" FID, make sure
      852    18572        *   it's legal in both syntax and device type.
      853    18573        *
      854    18574        ****/
      855    18575
      856    18576    2           IF OPTS.OUT.FID='.' OR OPTS.OUT.FID=' ' THEN DO;
      857    18577    2              OPTS.OUT.FID=NAME_INP.NAME#;
      858    18578    2              OPTS.OUT.L=NAME_INP.L#+ASCBIN('/');
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:25   
      859    18579    2              END;
      860    18580
      861    18581    2           IF OPTS.OUT.NODE=' ' OR SUBSTR(OPTS.OUT.FID,0,1)~='''' THEN DO;
      862    18582
      863    18583    2              FID_OUT.TEXTFID_=VECTOR(OPTS.OUT.FID);
      864    18584    3              CALL M$FID(FID_OUT) WHENALTRETURN DO;
      865    18585    3                 CALL XUR$ERRMSG(%E$VWM_OUT);
      866    18586    3                 GOTO DECIDE;
      867    18587    3                 END;
      868    18588
      869    18589    3              IF ASN_OUT~=%DEVICE# AND ASN_OUT~=%FILE# AND ASN_OUT~=%TAPE# THEN DO;
      870    18590    3                 CALL XUR$ERRMSG(%E$VWM_OUT);
      871    18591    3                 GOTO DECIDE;
      872    18592    3                 END;
      873    18593
      874    18594    2              IF ASN_OUT=%DEVICE# AND
      875    18595    2                SUBSTR(RES_OUT,0,2)~='CP' AND
      876    18596    2                SUBSTR(RES_OUT,0,2)~='ME' AND
      877    18597    2                SUBSTR(RES_OUT,0,2)~='LP' AND
      878    18598    2                SUBSTR(RES_OUT,0,2)~='JE' AND
      879    18599    2                SUBSTR(RES_OUT,0,2)~='LT' AND
      880    18600    2                SUBSTR(RES_OUT,0,2)~='MT' AND
      881    18601    3                SUBSTR(RES_OUT,0,2)~='FT' THEN DO;
      882    18602    3                 CALL XUR$ERRMSG(%E$VWM_OUT);
      883    18603    3                 GOTO DECIDE;
      884    18604    3                 END;
      885    18605
      886    18606        /****
      887    18607        *
      888    18608        *   If there's no output name (where one is needed), make it the same
      889    18609        *   as the input name.
      890    18610        *
      891    18611        ****/
      892    18612
      893    18613    2              IF (ASN_OUT=%FILE# OR SUBSTR(RES_OUT,0,2)='LT') AND NOT OUT_VLR.NAME
      894    18614    3              THEN DO;
      895    18615    3                 OUT_VLR.NAME='1'B;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:26   
      896    18616    3                 NAME_OUT=NAME_INP;
      897    18617    3                 END;
      898    18618
      899    18619        /****
      900    18620        *
      901    18621        *   Force M$UNFID to materialize an account.
      902    18622        *
      903    18623        ****/
      904    18624
      905    18625    2              IF OPTS.OUT.NODE=' ' AND
      906    18626    2                ((ASN_OUT=%FILE# AND NOT OUT_VLR.ACCT) OR
      907    18627    3                (OUT_VLR.ACCT AND ACCT_OUT.ACCT#=' ')) THEN DO;
      908    18628    3                 OUT_VLR.ACCT='1'B;
      909    18629    3                 ACCT_OUT.ACCT#=B$JIT.FACCN;
      910    18630    3                 IF SN_OUT.SN#(0)=' ' THEN
      911    18631    3                    SN_OUT.SN#(0)=B$JIT.FPSN;
      912    18632    3                 END;
      913    18633    3              CALL M$UNFID(UNFID_OUT) WHENALTRETURN DO;
      914    18634    3                 CALL XUR$ERRMSG(%E$VWM_OTL);
      915    18635    3                 GOTO DECIDE;
      916    18636    3                 END;
      917    18637    2              OPTS.OUT.L=I+ASCBIN('/');
      918    18638
      919    18639        /****
      920    18640        *
      921    18641        *   You can't move to a star file.
      922    18642        *
      923    18643        ****/
      924    18644
      925    18645    3              IF ASN_OUT=%FILE# AND SUBSTR(OPTS.OUT.FID,0,1)='*' THEN DO;
      926    18646    3                 CALL XUR$ERRMSG(%E$VWM_STR);
      927    18647    3                 GOTO DECIDE;
      928    18648    3                 END;
      929    18649    2              END;
      930    18650
      931    18651        /****
      932    18652        *
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:27   
      933    18653        *   Restore the *IAM node name if needed.  Note that we already checked
      934    18654        *   for insanities above.
      935    18655        *
      936    18656        ****/
      937    18657
      938    18658    1           IF OPTS.OUT.NODE=' ' THEN
      939    18659    1              OPTS.OUT.NODE=VW_IAM#;
      940    18660
      941    18661        /****
      942    18662        *
      943    18663        *   If we're sucking a file to here and we didn't get a logon name
      944    18664        *   and account, supply one from the JIT.
      945    18665        *
      946    18666        ****/
      947    18667
      948    18668    1           IF OPTS.OUT.NODE=VW_IAM# AND OPTS.OUT.ACCT=' ' AND
      949    18669    2             OPTS.OUT.NAME=' ' THEN DO;
      950    18670    2              OPTS.OUT.ACCT=B$JIT.ACCN;
      951    18671    2              OPTS.OUT.NAME=B$JIT.UNAME;
      952    18672    2              END;
      953    18673
      954    18674        /****
      955    18675        *
      956    18676        *   Get the logon IDs at both nodes, if necessary.
      957    18677        *
      958    18678        ****/
      959    18679
      960    18680    1           IF ONCE THEN
      961    18681    1              CALL XUR$ERRMSG(%E$VWM_HI,,,VECTOR(B_VERSION));
      962    18682
      963    18683    1           CALL LOGON(OPTS.INP,'1'B) ALTRET(DECIDE);
      964    18684
      965    18685        /****
      966    18686        *
      967    18687        *   If this is a suck to here and the logon matches the current JIT
      968    18688        *   name and account, fetch the password from :HLP so that the user
      969    18689        *   doesn't have to specify it.  This isn't a security breach, since
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:28   
      970    18690        *   he had to know the password in order to log on.
      971    18691        *
      972    18692        ****/
      973    18693
      974    18694    1           IF OPTS.OUT.NODE=VW_IAM# AND B$JIT.ACCN=OPTS.OUT.ACCT AND
      975    18695    2             B$JIT.UNAME=OPTS.OUT.NAME AND OPTS.OUT.EPASS=' ' THEN DO;
      976    18696    2              ACCTNAME.ACCT=OPTS.OUT.ACCT;
      977    18697    2              ACCTNAME.NAME=OPTS.OUT.NAME;
      978    18698    2              CALL INDEX(I,' ',OPTS.OUT.NAME);
      979    18699    2              ACCTNAME.L=I+8;
      980    18700
      981    18701        /****
      982    18702        *
      983    18703        *   We need FMR to read :HLP.  Turn it on, then remember to turn it
      984    18704        *   off if it wasn't already on.  Otherwise, anyone could MOVE anything
      985    18705        *   to anywhere!
      986    18706        *
      987    18707        ****/
      988    18708
      989    18709    2              CALL M$SPRIV(FPT_PRIV);
      990    18710    3              DO WHILE('0'B);
      991    18711
      992    18712    3   SLEEP_HLP:
      993    18713    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$FILEBUSY THEN
      994    18714    3                    GOTO ANYWAY;
      995    18715    3                 CALL M$WAIT(SNOOZE);
      996    18716    3                 END;
      997    18717    2              CALL M$OPEN(OPEN_HLP) ALTRET(SLEEP_HLP);
      998    18718    3              CALL M$READ(READ_HLP) WHENALTRETURN DO;
      999    18719    3                 CALL M$CLOSE(CLOSE_HLP);
     1000    18720    3                 IF NOT (B$JIT.PRIV.JOB&%PR_FMREAD#) THEN
     1001    18721    3                    CALL M$RPRIV(FPT_PRIV);
     1002    18722    3                 GOTO ANYWAY;
     1003    18723    3                 END;
     1004    18724    2              CALL M$CLOSE(CLOSE_HLP);
     1005    18725    2              OPTS.OUT.EPASS=HLPBUF.PASSWORD;
     1006    18726    2              CALL LOGON(OPTS.OUT,'0'B) ALTRET(DECIDE);
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:29   
     1007    18727    2              END;
     1008    18728
     1009    18729        /****
     1010    18730        *
     1011    18731        *   We're moving elsewhere, so prompt for the logon.
     1012    18732        *
     1013    18733        ****/
     1014    18734
     1015    18735    2           ELSE DO;
     1016    18736
     1017    18737    2   ANYWAY:
     1018    18738    2              CALL LOGON(OPTS.OUT,'1'B) ALTRET(DECIDE);
     1019    18739    2              END;
     1020    18740
     1021    18741        /****
     1022    18742        *
     1023    18743        *   If we are moving to @LOCAL and the logon is the same as the JIT,
     1024    18744        *   check to make sure the file does not exist if 'TO' or 'ON'.
     1025    18745        *
     1026    18746        ****/
     1027    18747
     1028    18748    1           IF OPTS.OUT.NODE=VW_IAM# AND OPTS.OUT.ACCT=B$JIT.ACCN AND OPTS.OUT.NAME=
     1029    18749    2             B$JIT.UNAME AND OPTS.OUT.MISC.HOW<2 AND ASN_OUT=%FILE# THEN DO;
     1030    18750    3              CALL M$OPEN(OPEN_OTST) WHENRETURN DO;
     1031    18751    3                 CALL XUR$ERRMSG(%E$VWM_CWO);
     1032    18752    3                 GOTO DECIDE;
     1033    18753    3                 END;
     1034    18754    2              END;
     1035    18755
     1036    18756
     1037    18757        /****
     1038    18758        *
     1039    18759        *   Now fix up the mailboxes.  If we are the initiator and sender,
     1040    18760        *   ignore any sender options.  If we are the initiator and the
     1041    18761        *   receiver, ignore any receiver options.
     1042    18762        *
     1043    18763        ****/
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:30   
     1044    18764
     1045    18765    2           IF OPTS.INP.NODE=' ' AND OPTS.MAILINIT.WHO~=' ' THEN DO;
     1046    18766    2              CARD(4)=' ';
     1047    18767    2              CARD(5)=' ';
     1048    18768    2              END;
     1049    18769
     1050    18770    1           IF OPTS.MAILSNDR.WHO~=' ' THEN
     1051    18771    1              OPTS.MAILSNDR.NODE=OPTS.INP.NODE;
     1052    18772
     1053    18773    2           IF OPTS.OUT.NODE=VW_IAM# AND OPTS.MAILINIT.WHO~=' ' THEN DO;
     1054    18774    2              CARD(6)=' ';
     1055    18775    2              CARD(7)=' ';
     1056    18776    2              END;
     1057    18777
     1058    18778    1           IF OPTS.MAILRCVR.WHO~=' ' THEN
     1059    18779    1              OPTS.MAILRCVR.NODE=OPTS.OUT.NODE;
     1060    18780
     1061    18781        /****
     1062    18782        *
     1063    18783        *   Determine if there's a good mailbox (if needed) for the initiator.
     1064    18784        *
     1065    18785        ****/
     1066    18786
     1067    18787    2           IF OPTS.MAILINIT.WHO~=' ' THEN DO;
     1068    18788    2              OPTS.MAILINIT.NODE=VW_IAM#;
     1069    18789
     1070    18790        /****
     1071    18791        *
     1072    18792        *   If a mailbox was specified, make sure it's valid.
     1073    18793        *
     1074    18794        ****/
     1075    18795
     1076    18796
     1077    18797    2   NAMESERVER:
     1078    18798    3              do;
     1079    18799    4                 call VWM$GET_MAILBOX( OPTS.MAILINIT.MAILBOX, VW_IAM# ) whenaltreturn
             18799                          do;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:31   
     1080    18800    4                    call XUR$ERRMSG(%E$VWM_BMS);
     1081    18801    4                    OPTS.MAILINIT.MAILBOX = ' ';
     1082    18802    5                    call VWM$GET_MAILBOX( OPTS.MAILINIT.MAILBOX, VW_IAM# )
             18802                             whenaltreturn do;
     1083    18803    5                       call XUR$ERRMSG(%E$VWM_IMI);
     1084    18804    5                       CARD(8) = ' ';
     1085    18805    5                       CARD(9) = ' ';
     1086    18806    5                       exit NAMESERVER;
     1087    18807    5                       end;
     1088    18808    4                    end;                   /*  Of first altreturn do;            */
     1089    18809    3                 call searchr(I,J,B$SR_NON_BLANK,OPTS.MAILINIT.MAILBOX);
     1090    18810    3                 OPTS.MAILINIT.L = I + ascbin('/') + 1;
     1091    18811    3                 end;
     1092    18812    2              END;
     1093    18813
     1094    18814        /****
     1095    18815        *
     1096    18816        *   Check the sender's mailbox for validity.
     1097    18817        *
     1098    18818        ****/
     1099    18819
     1100    18820    1   MAIL_OK:
     1101    18821    2           IF OPTS.MAILSNDR.WHO~=' ' THEN DO;
     1102    18822    3              call VWM$FIX_MAILBOX(OPTS.MAILSNDR.MAILBOX,OPTS.INP.ACCT) whenaltreturn
             18822                       do;
     1103    18823    3                 call XUR$ERRMSG(%E$VWM_RMI);
     1104    18824    3                 goto DECIDE;
     1105    18825    3                 end;
     1106    18826    2              call searchr(I,J,B$SR_NON_BLANK,OPTS.MAILSNDR.MAILBOX);
     1107    18827    2              OPTS.MAILSNDR.L = I + ascbin('/') + 1;
     1108    18828
     1109    18829    2              END;
     1110    18830
     1111    18831        /****
     1112    18832        *
     1113    18833        *   Check the receiver's mailbox for validity.
     1114    18834        *
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:32   
     1115    18835        ****/
     1116    18836
     1117    18837    2           IF OPTS.MAILRCVR.WHO~=' ' THEN DO;
     1118    18838    3              call VWM$FIX_MAILBOX(OPTS.MAILRCVR.MAILBOX,OPTS.OUT.ACCT) whenaltreturn
             18838                       do;
     1119    18839    3                 call XUR$ERRMSG(%E$VWM_RMI);
     1120    18840    3                 goto DECIDE;
     1121    18841    3                 end;
     1122    18842    2              call searchr(I,J,B$SR_NON_BLANK,OPTS.MAILRCVR.MAILBOX);
     1123    18843    2              OPTS.MAILRCVR.L = I + ascbin('/') + 1;
     1124    18844
     1125    18845    2              END;
     1126    18846
     1127    18847        /****
     1128    18848        *
     1129    18849        *   Clear the PROMPT flags, if any.
     1130    18850        *
     1131    18851        ****/
     1132    18852
     1133    18853    1           OPTS.INP.MISC.PROMPT='0'B;
     1134    18854    1           OPTS.OUT.MISC.PROMPT='0'B;
     1135    18855
     1136    18856        /****
     1137    18857        *
     1138    18858        *   Now fill out the command buffer.
     1139    18859        *
     1140    18860        ****/
     1141    18861
     1142    18862    1           IF OPTS.INP.ACCT~=' ' THEN
     1143    18863    1              OPTS.INP.CMD='SUCK';
     1144    18864    1           IF OPTS.OUT.ACCT~=' ' THEN
     1145    18865    1              OPTS.OUT.CMD='BEAM';
     1146    18866    1           IF OPTS.MAILSNDR.WHO~=' ' THEN
     1147    18867    1              OPTS.MAILSNDR.CMD='MAIL';
     1148    18868    1           IF OPTS.MAILRCVR.WHO~=' ' THEN
     1149    18869    1              OPTS.MAILRCVR.CMD='MAIL';
     1150    18870    1           IF OPTS.MAILINIT.WHO~=' ' THEN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:33   
     1151    18871    1              OPTS.MAILINIT.CMD='MAIL';
     1152    18872
     1153    18873        /****
     1154    18874        *
     1155    18875        *   Reset counters, set up interrupt linkage, set the prompt, and DO IT!
     1156    18876        *
     1157    18877        ****/
     1158    18878
     1159    18879    1           VW_INPCNT#=0;
     1160    18880    1           VW_OUTCNT#=0;
     1161    18881
     1162    18882    1           FPT_PROMPT.PROMPT_=VECTOR(ASTERISK);
     1163    18883    1           CALL M$PROMPT(FPT_PROMPT);
     1164    18884
     1165    18885    1           CALL M$INT(FPT_INT);
     1166    18886
     1167    18887    1           IF OPTS.INP.CMD~=' ' THEN
     1168    18888    2              CALL VWK$SUCK WHENALTRETURN DO;
     1169    18889    2                 GOTO DECIDE;
     1170    18890    2                 END;
     1171    18891    1           ELSE
     1172    18892    2              CALL VWB$BEAM WHENALTRETURN DO;
     1173    18893    2                 GOTO DECIDE;
     1174    18894    2                 END;
     1175    18895
     1176    18896        /****
     1177    18897        *
     1178    18898        *   Tell the user where the mail is going, if any.
     1179    18899        *
     1180    18900        ****/
     1181    18901
     1182    18902    1           IF CARD(8)=' ' THEN
     1183    18903    1              CALL XUR$ERRMSG(%E$VWM_NMA);
     1184    18904    2           ELSE DO;
     1185    18905    2              U1.C=OPTS.MAILINIT.MAILBOX;
     1186    18906    2              U1.L=OPTS.MAILINIT.L-ASCBIN('/');
     1187    18907    2              CALL XUR$ERRMSG(%E$VWM_MA,,DCBNUM(M$ME),VECTOR(U1));
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:34   
     1188    18908    2              END;
     1189    18909
     1190    18910        /****
     1191    18911        *
     1192    18912        *   Decide where to go.
     1193    18913        *
     1194    18914        ****/
     1195    18915
     1196    18916    1   DECIDE:
     1197    18917    1           IF ONCE THEN
     1198    18918    1              CALL M$EXIT;
     1199    18919    1           ELSE
     1200    18920    1              GOTO GET_COMMAND;
     1201    18921
     1202    18922        %EJECT;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:35   
     1203    18923        /*I**
     1204    18924        *
     1205    18925        *   NAME:  OPTIONS
     1206    18926        *
     1207    18927        *   PURPOSE:
     1208    18928        *       To decode a parsed options list into VW_OPTIONS#.
     1209    18929        *
     1210    18930        *   CALL:
     1211    18931        *       CALL OPTIONS(blk$,argb) ALTRET...
     1212    18932        *
     1213    18933        *   PARAMETERS:
     1214    18934        *       blk$ is the pointer to the parse block which is an options list.
     1215    18935        *       argb is a two-"card" output block into which the options may be
     1216    18936        *       placed.  Options which do are strictly input or output are placed
     1217    18937        *       directly into VW_OPTIONS#; others, such as logon information, are
     1218    18938        *       either input or output and are placed into "argb".
     1219    18939        *
     1220    18940        *   DATA:
     1221    18941        *       VW_OPTIONS# may be modified.
     1222    18942        *
     1223    18943        *   DESCRIPTION:
     1224    18944        *       OPTIONS processes the parser options output nodes and puts the
     1225    18945        *       results in the option block.
     1226    18946        *
     1227    18947        ****/
     1228    18948
     1229    18949    1   OPTIONS: PROC(BLK$,ARGB) ALTRET;
     1230    18950
     1231    18951    2   DCL BLK$                           ALIGNED PTR;
     1232    18952
     1233    18953    2   DCL 1 ARGB ALIGNED,
     1234    18954    2         2 *                          CHAR(4),
     1235    18955    2         2 ACCT                       CHAR(8),
     1236    18956    2         2 NAME                       CHAR(12),
     1237    18957    2         2 EPASS                      CHAR(12),
     1238    18958    2         2 * UNAL                     CHAR(35),
     1239    18959    2         2 MISC UNAL,
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:36   
     1240    18960    2           3 PROMPT UNAL              BIT(1),
     1241    18961    2           3 * UNAL                   BIT(8),
     1242    18962    2         2 NODE                       CHAR(8),
     1243    18963    2         2 *                          CHAR(80);
     1244    18964    2   DCL ARGF REDEF ARGB                CHAR(160);
     1245    18965
     1246    18966    2   DCL P                              PTR;
     1247    18967    2   DCL Q                              PTR;
     1248    18968
     1249    18969    2   DCL I                              SBIN;
     1250    18970    2   DCL MM                             UBIN;
     1251    18971    2   DCL DD                             UBIN;
     1252    18972    2   DCL YY                             UBIN;
     1253    18973    2   DCL FRST                           UBIN;
     1254    18974    2   DCL LAST                           UBIN;
     1255    18975
     1256    18976    2   DCL DIM(0:11) CONSTANT             UBIN BYTE
     1257    18977    2           INIT(31,29,31,30,31,30,31,31,30,31,30,31);
     1258    18978
     1259    18979
     1260    18980        /****
     1261    18981        *
     1262    18982        *   Walk through the parser nodes passed.
     1263    18983        *
     1264    18984        ****/
     1265    18985
     1266    18986    3           DO I=0 TO BLK$->OUT$BLK.NSUBLKS-1;
     1267    18987    3              P=BLK$->OUT$BLK.SUBLK$(I);
     1268    18988    4              DO SELECT(P->OUT$BLK.CODE);
     1269    18989
     1270    18990        /****
     1271    18991        *
     1272    18992        *   Account, name, password (or perversions thereof)
     1273    18993        *
     1274    18994        ****/
     1275    18995
     1276    18996    4                 SELECT(%OPTACCT#);
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:37   
     1277    18997    5                 DO CASE(P->OUT$BLK.NSUBLKS);
     1278    18998
     1279    18999        /****
     1280    19000        *
     1281    19001        *   Password only or 'foreign logon'
     1282    19002        *
     1283    19003        ****/
     1284    19004
     1285    19005    5                  CASE(1);
     1286    19006    5                    Q=P->OUT$BLK.SUBLK$(0);
     1287    19007    5                    IF Q->OUT$BLK.CODE=%SUBPASS# THEN
     1288    19008    5                       ARGB.EPASS=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1289    19009    5                    ELSE
     1290    19010    5                       CALL INSERT(ARGF,4,67,'''',SUBSTR(Q->OUT$SYM.TEXT,
     1291    19011    5                         0,Q->OUT$SYM.COUNT),'''');
     1292    19012
     1293    19013        /****
     1294    19014        *
     1295    19015        *   Account,name
     1296    19016        *
     1297    19017        ****/
     1298    19018
     1299    19019    5                  CASE(2);
     1300    19020    5                    Q=P->OUT$BLK.SUBLK$(0);
     1301    19021    5                    ARGB.ACCT=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1302    19022    5                    Q=P->OUT$BLK.SUBLK$(1);
     1303    19023    5                    ARGB.NAME=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1304    19024
     1305    19025        /****
     1306    19026        *
     1307    19027        *   Account,name,password
     1308    19028        *
     1309    19029        ****/
     1310    19030
     1311    19031    5                  CASE(3);
     1312    19032    5                    Q=P->OUT$BLK.SUBLK$(0);
     1313    19033    5                    ARGB.ACCT=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:38   
     1314    19034    5                    Q=P->OUT$BLK.SUBLK$(1);
     1315    19035    5                    ARGB.NAME=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1316    19036    5                    Q=P->OUT$BLK.SUBLK$(2);
     1317    19037    5                    ARGB.EPASS=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1318    19038    5                  END;
     1319    19039
     1320    19040        /****
     1321    19041        *
     1322    19042        *   NLN/NK option
     1323    19043        *
     1324    19044        ****/
     1325    19045
     1326    19046    4                 SELECT(%OPTNLN#);
     1327    19047    4                 OPTS.INP.MISC.NLN='1'B;
     1328    19048
     1329    19049        /****
     1330    19050        *
     1331    19051        *   NSC option
     1332    19052        *
     1333    19053        ****/
     1334    19054
     1335    19055    4                 SELECT(%OPTNSC#);
     1336    19056    4                 OPTS.INP.MISC.NSC='1'B;
     1337    19057
     1338    19058        /****
     1339    19059        *
     1340    19060        *   NFA option
     1341    19061        *
     1342    19062        ****/
     1343    19063
     1344    19064    4                 SELECT(%OPTNFA#);
     1345    19065    4                 OPTS.INP.MISC.NFA='1'B;
     1346    19066
     1347    19067        /****
     1348    19068        *
     1349    19069        *   TRAN/X option
     1350    19070        *
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:39   
     1351    19071        ****/
     1352    19072
     1353    19073    4                 SELECT(%OPTTRAN#);
     1354    19074    4                 OPTS.INP.MISC.TRAN='1'B;
     1355    19075
     1356    19076        /****
     1357    19077        *
     1358    19078        *   Record selection option
     1359    19079        *
     1360    19080        ****/
     1361    19081
     1362    19082    4                 SELECT(%OPTRECS#);
     1363    19083    5                 IF OPTX>=LENGTHC(OPTS.OPTSRECS)/80 OR RECX>9 THEN DO;
     1364    19084    5                    CALL XUR$ERRMSG(%E$VWM_TMO);
     1365    19085    5                    ALTRETURN;
     1366    19086    5                    END;
     1367    19087    4                 OPT$=ADDR(OPTS.OPTSRECS(OPTX));
     1368    19088    4                 OPT$->OPTSRECS.SUB='RECS';
     1369    19089    4                 Q=P->OUT$BLK.SUBLK$(0);
     1370    19090    4                 CALL CHARBIN(FRST,SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT));
     1371    19091    4                 IF P->OUT$BLK.NSUBLKS=1 THEN
     1372    19092    4                    LAST=FRST;
     1373    19093    5                 ELSE DO;
     1374    19094    5                    Q=P->OUT$BLK.SUBLK$(1);
     1375    19095    5                    CALL CHARBIN(LAST,SUBSTR(Q->OUT$SYM.TEXT,0,
     1376    19096    5                      Q->OUT$SYM.COUNT));
     1377    19097    5                    END;
     1378    19098    4                 IF LAST<FRST THEN
     1379    19099    4                    CALL XUR$ERRMSG(%E$VWM_RNG);
     1380    19100    5                 ELSE DO;
     1381    19101    5                    CALL BINCHAR(OPT$->OPTSRECS.FRST,FRST);
     1382    19102    5                    CALL BINCHAR(OPT$->OPTSRECS.LAST,LAST);
     1383    19103    5                    OPT$->OPTSRECS.CMD='OPTS';
     1384    19104    5                    OPTX=OPTX+1;
     1385    19105    5                    RECX=RECX+1;
     1386    19106    5                    END;
     1387    19107
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:40   
     1388    19108        /****
     1389    19109        *
     1390    19110        *   Key selection option (not yet implemented)
     1391    19111        *
     1392    19112        ****/
     1393    19113
     1394    19114    4                 SELECT(%OPTKEYS#);
     1395    19115    4                 CALL XUR$ERRMSG(%E$VWM_NYI);
     1396    19116
     1397    19117        /****
     1398    19118        *
     1399    19119        *   Edit key selection option (not yet implemented)
     1400    19120        *
     1401    19121        ****/
     1402    19122
     1403    19123    4                 SELECT(%OPTEDIT#);
     1404    19124    4                 CALL XUR$ERRMSG(%E$VWM_NYI);
     1405    19125
     1406    19126        /****
     1407    19127        *
     1408    19128        *   NMA/NMTI option
     1409    19129        *
     1410    19130        ****/
     1411    19131
     1412    19132    4                 SELECT(%SUBNMA#,%SUBNMTI#);
     1413    19133    4                 CARD(8)=' ';
     1414    19134    4                 CARD(9)=' ';
     1415    19135
     1416    19136        /****
     1417    19137        *
     1418    19138        *   MAIL/MTI option
     1419    19139        *
     1420    19140        ****/
     1421    19141
     1422    19142    4                 SELECT(%SUBMA#,%SUBMTI#);
     1423    19143    4                 OPTS.MAILINIT.WHO='I';
     1424    19144    4                 CARD(9)=' ';
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:41   
     1425    19145    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;
     1426    19146    5                    Q=P->OUT$BLK.SUBLK$(0);
     1427    19147    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;
     1428    19148    6                       CALL XUR$ERRMSG(%E$VWM_IML);
     1429    19149    6                       ALTRETURN;
     1430    19150    6                       END;
     1431    19151    5                    OPTS.MAILINIT.L=ASCBIN('/')+Q->OUT$SYM.COUNT;
     1432    19152    5                    OPTS.MAILINIT.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1433    19153    5                    END;
     1434    19154
     1435    19155        /****
     1436    19156        *
     1437    19157        *   EMTI option (treated as MTI)
     1438    19158        *
     1439    19159        ****/
     1440    19160
     1441    19161    4                 SELECT(%SUBEMTI#);
     1442    19162    4                 OPTS.MAILINIT.WHO='E';
     1443    19163    4                 CARD(9)=' ';
     1444    19164    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;
     1445    19165    5                    Q=P->OUT$BLK.SUBLK$(0);
     1446    19166    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;
     1447    19167    6                       CALL XUR$ERRMSG(%E$VWM_IML);
     1448    19168    6                       ALTRETURN;
     1449    19169    6                       END;
     1450    19170    5                    OPTS.MAILINIT.L=ASCBIN('/')+Q->OUT$SYM.COUNT;
     1451    19171    5                    OPTS.MAILINIT.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1452    19172    5                    END;
     1453    19173
     1454    19174        /****
     1455    19175        *
     1456    19176        *   NMTS option
     1457    19177        *
     1458    19178        ****/
     1459    19179
     1460    19180    4                 SELECT(%SUBNMTS#);
     1461    19181    4                 CARD(4)=' ';
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:42   
     1462    19182    4                 CARD(5)=' ';
     1463    19183
     1464    19184        /****
     1465    19185        *
     1466    19186        *   MTS option
     1467    19187        *
     1468    19188        ****/
     1469    19189
     1470    19190    4                 SELECT(%SUBMTS#);
     1471    19191    4                 OPTS.MAILSNDR.WHO='S';
     1472    19192    4                 CARD(5)=' ';
     1473    19193    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;
     1474    19194    5                    Q=P->OUT$BLK.SUBLK$(0);
     1475    19195    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;
     1476    19196    6                       CALL XUR$ERRMSG(%E$VWM_SML);
     1477    19197    6                       ALTRETURN;
     1478    19198    6                       END;
     1479    19199    5                    OPTS.MAILSNDR.L=ASCBIN('/')+Q->OUT$SYM.COUNT;
     1480    19200    5                    OPTS.MAILSNDR.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1481    19201    5                    END;
     1482    19202
     1483    19203        /****
     1484    19204        *
     1485    19205        *   NMTR option
     1486    19206        *
     1487    19207        ****/
     1488    19208
     1489    19209    4                 SELECT(%SUBNMTR#);
     1490    19210    4                 CARD(6)=' ';
     1491    19211    4                 CARD(7)=' ';
     1492    19212
     1493    19213        /****
     1494    19214        *
     1495    19215        *   MTR option
     1496    19216        *
     1497    19217        ****/
     1498    19218
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:43   
     1499    19219    4                 SELECT(%SUBMTR#);
     1500    19220    4                 OPTS.MAILRCVR.WHO='R';
     1501    19221    4                 CARD(7)=' ';
     1502    19222    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;
     1503    19223    5                    Q=P->OUT$BLK.SUBLK$(0);
     1504    19224    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;
     1505    19225    6                       CALL XUR$ERRMSG(%E$VWM_RML);
     1506    19226    6                       ALTRETURN;
     1507    19227    6                       END;
     1508    19228    5                    OPTS.MAILRCVR.L=ASCBIN('/')+Q->OUT$SYM.COUNT;
     1509    19229    5                    OPTS.MAILRCVR.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);
     1510    19230    5                    END;
     1511    19231
     1512    19232        /****
     1513    19233        *
     1514    19234        *   DDNF option
     1515    19235        *
     1516    19236        ****/
     1517    19237
     1518    19238    4                 SELECT(%OPTDDN#);
     1519    19239    4                 OPTS.OUT.MISC.DDNF='1'B;
     1520    19240
     1521    19241        /****
     1522    19242        *
     1523    19243        *   PROMPT option
     1524    19244        *
     1525    19245        ****/
     1526    19246
     1527    19247    4                 SELECT(%OPTPROMPT#);
     1528    19248    4                 ARGB.MISC.PROMPT='1'B;
     1529    19249
     1530    19250        /****
     1531    19251        *
     1532    19252        *   DATE option
     1533    19253        *
     1534    19254        ****/
     1535    19255
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:44   
     1536    19256    4                 SELECT(%OPTDATE#);
     1537    19257    5                 IF OPTX>=LENGTHC(OPTS.OPTSRECS)/80 THEN DO;
     1538    19258    5                    CALL XUR$ERRMSG(%E$VWM_TMO);
     1539    19259    5                    ALTRETURN;
     1540    19260    5                    END;
     1541    19261    4                 OPT$=ADDR(OPTS.OPTSRECS(OPTX));
     1542    19262    4                 OPT$->OPTSDATE.SUB='DATE';
     1543    19263
     1544    19264    4                 Q=P->OUT$BLK.SUBLK$(0);
     1545    19265    4                 IF Q->OUT$BLK.CODE=%SUBCRE# THEN
     1546    19266    4                    OPT$->OPTSDATE.WHICH='C';
     1547    19267    4                 ELSE
     1548    19268    4                    OPT$->OPTSDATE.WHICH='M';
     1549    19269
     1550    19270    4                 Q=P->OUT$BLK.SUBLK$(1);
     1551    19271    5                 DO SELECT(Q->OUT$BLK.CODE);
     1552    19272    5                    SELECT(%RELGT#);
     1553    19273    5                    OPT$->OPTSDATE.REL='GT';
     1554    19274    5                    SELECT(%RELEQ#);
     1555    19275    5                    OPT$->OPTSDATE.REL='EQ';
     1556    19276    5                    SELECT(%RELGE#);
     1557    19277    5                    OPT$->OPTSDATE.REL='GE';
     1558    19278    5                    SELECT(%RELLT#);
     1559    19279    5                    OPT$->OPTSDATE.REL='LT';
     1560    19280    5                    SELECT(%RELNE#);
     1561    19281    5                    OPT$->OPTSDATE.REL='NE';
     1562    19282    5                    SELECT(%RELLE#);
     1563    19283    5                    OPT$->OPTSDATE.REL='LE';
     1564    19284    5                    END;
     1565    19285
     1566    19286    4                 Q=P->OUT$BLK.SUBLK$(2);
     1567    19287    4                 IF Q->OUT$BLK.CODE=%WHNYDY# THEN
     1568    19288    4                    OPT$->OPTSDATE.UTS='YESTERDAY';
     1569    19289    4                 ELSE IF Q->OUT$BLK.CODE=%WHNTDY# THEN
     1570    19290    4                       OPT$->OPTSDATE.UTS='TODAY';
     1571    19291    4                    ELSE IF Q->OUT$BLK.CODE=%WHNGDS# THEN
     1572    19292    4                          CALL CONCAT(OPT$->OPTSDATE.UTS,'-',SUBSTR(Q->OUT$BLK.SUBLK$(0
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:45   
             19292                                   )
     1573    19293    4                            ->OUT$SYM.TEXT,0,Q->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT));
     1574    19294    5                       ELSE IF Q->OUT$BLK.CODE=%WHNDAT# THEN DO;
     1575    19295    5                             CALL CHARBIN(MM,SUBSTR(Q->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,
     1576    19296    5                               0,Q->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT));
     1577    19297    5                             CALL CHARBIN(DD,SUBSTR(Q->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT,
     1578    19298    5                               0,Q->OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT));
     1579    19299    5                             CALL CHARBIN(YY,SUBSTR(Q->OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT,
     1580    19300    5                               0,Q->OUT$BLK.SUBLK$(2)->OUT$SYM.COUNT));
     1581    19301    5                             IF MM<1 OR MM>12 OR DD<1 OR DD>DIM(MM-1) OR YY>99 OR
     1582    19302    6                               (YY<78 AND YY>20) OR (MM=2 AND DD>28 AND MOD(YY,4)>0)
             19302                                        THEN DO;
     1583    19303
     1584    19304    6                                CALL XUR$ERRMSG(%E$VWM_DAT);
     1585    19305    6                                ALTRETURN;
     1586    19306    6                                END;
     1587    19307    5                             DD=DD+100*MM+10000*YY;
     1588    19308    5                             CALL BINCHAR(DWORK,DD);
     1589    19309    5                             OPT$->OPTSDATE.UTS=SUBSTR(DWORK,2,6);
     1590    19310    5                             END;
     1591    19311    4                 OPT$->OPTSDATE.CMD='OPTS';
     1592    19312    4                 OPTX=OPTX+1;
     1593    19313
     1594    19314        /****
     1595    19315        *
     1596    19316        *   End of case
     1597    19317        *
     1598    19318        ****/
     1599    19319
     1600    19320    4                 END;
     1601    19321    3              END;
     1602    19322
     1603    19323    2           RETURN;
     1604    19324
     1605    19325    2   END;
     1606    19326
     1607    19327        %EJECT;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:46   
     1608    19328        /*I**
     1609    19329        *
     1610    19330        *   NAME:  LOGON
     1611    19331        *
     1612    19332        *   PURPOSE:
     1613    19333        *       To obtain the complete logon for a node and/or to scramble the
     1614    19334        *       password, if required.
     1615    19335        *
     1616    19336        *   CALL:
     1617    19337        *       CALL LOGON(argb,doit) ALTRET...
     1618    19338        *
     1619    19339        *   PARAMETERS:
     1620    19340        *       argb is a two-"card" logon information block, part of VW_OPTIONS#.
     1621    19341        *       doit is a flag which specifies whether ASZ$SCRAMBLE is to be called
     1622    19342        *       or not.
     1623    19343        *
     1624    19344        *   DATA:
     1625    19345        *       The JIT is examined.  MEBUF and LOBUF may be modified by a prompt
     1626    19346        *       for logon information.
     1627    19347        *
     1628    19348        *   DESCRIPTION:
     1629    19349        *       Get the complete logon for an input or output node, if needed.
     1630    19350        *
     1631    19351        ****/
     1632    19352
     1633    19353    1   LOGON:  PROC(ARGB,DOIT) ALTRET;
     1634    19354
     1635    19355    2   DCL 1 ARGB ALIGNED,
     1636    19356    2         2 *                          CHAR(4),
     1637    19357    2         2 ACCT                       CHAR(8),
     1638    19358    2         2 NAME                       CHAR(12),
     1639    19359    2         2 EPASS                      CHAR(12),
     1640    19360    2         2 BIT9(0:11) REDEF EPASS UNAL UBIN BYTE,
     1641    19361    2         2 *                          CHAR(35),
     1642    19362    2         2 MISC UNAL,
     1643    19363    2           3 PROMPT UNAL              BIT(1),
     1644    19364    2           3 * UNAL                   BIT(8),
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:47   
     1645    19365    2         2 NODE                       CHAR(8),
     1646    19366    2         2 *                          CHAR(80);
     1647    19367    2   DCL ARGF REDEF ARGB                CHAR(160);
     1648    19368
     1649    19369    2   DCL DOIT                           BIT(1);
     1650    19370
     1651    19371    2   DCL I                              SBIN;
     1652    19372    2   DCL J                              SBIN;
     1653    19373    2   DCL K                              SBIN;
     1654    19374    2   DCL L                              SBIN;
     1655    19375    2   DCL M                              SBIN;
     1656    19376    2   DCL N                              SBIN;
     1657    19377
     1658    19378    2   DCL ASZ$SCRAMBLE                   ENTRY(1);
     1659    19379
     1660    19380    2   DCL PASSWORD                       CHAR(8);
     1661    19381    2   DCL BIT6(0:11) REDEF PASSWORD UNAL UBIN(6);
     1662    19382
     1663    19383
     1664    19384    2   DCL BADDIES(0:127) CONSTANT UNAL   UBIN BYTE INIT(
     1665    19385    2           1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
     1666    19386    2           1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,
     1667    19387    2           1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,
     1668    19388    2           1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1);
     1669    19389
     1670    19390        /****
     1671    19391        *
     1672    19392        *   If there is no node specification, no account logon is needed.
     1673    19393        *
     1674    19394        ****/
     1675    19395
     1676    19396    2           IF ARGB.NODE~=' ' AND SUBSTR(ARGB.ACCT,0,1)~='''' AND
     1677    19397    3             (ARGB.ACCT=' ' OR ARGB.NAME=' ' OR ARGB.EPASS=' ') THEN DO;
     1678    19398
     1679    19399        /****
     1680    19400        *
     1681    19401        *   Slug in the defaults.
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:48   
     1682    19402        *
     1683    19403        ****/
     1684    19404
     1685    19405    3              IF ARGB.ACCT=' ' THEN
     1686    19406    3                 ARGB.ACCT=B$JIT.ACCN;
     1687    19407    3              IF ARGB.NAME=' ' THEN
     1688    19408    3                 ARGB.NAME=B$JIT.UNAME;
     1689    19409
     1690    19410        /****
     1691    19411        *
     1692    19412        *   If we're online and not in an XEQ file or if PROMPT is set, prompt.
     1693    19413        *   This logic doesn't work too well on a half-duplex terminal.
     1694    19414        *
     1695    19415        ****/
     1696    19416
     1697    19417    3              IF (B$JIT.MODE=%M_INT# AND (B$JIT.CPFLAGS1&'000000000020'O)='0'B)
     1698    19418    4                OR ARGB.MISC.PROMPT THEN DO;
     1699    19419    5                 IF B$JIT.MODE=%M_INT# THEN DO;
     1700    19420    5                    CALL INDEX(I,' ',ARGB.NODE);
     1701    19421    5                    CALL CONCAT(LOBUF,'` Logon @',SUBSTR(ARGB.NODE,0,I),'?');
     1702    19422    5                    FPT_PROMPT.PROMPT_=VECTOR(SUBSTR(LOBUF,0,I+10));
     1703    19423    5                    CALL M$PROMPT(FPT_PROMPT);
     1704    19424    5                    CALL M$STRMCTL(ECHO_OF);
     1705    19425    5                    END;
     1706    19426
     1707    19427    4   TRY_AGAIN:
     1708    19428    4                 MEBUF=' ';
     1709    19429    5                 CALL M$READ(READ_ME) WHENRETURN DO;
     1710    19430
     1711    19431        /****
     1712    19432        *
     1713    19433        *   Crudely simulate the parser.
     1714    19434        *
     1715    19435        ****/
     1716    19436
     1717    19437    5                    I=0;
     1718    19438    5                    J=0;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:49   
     1719    19439    5                    K=0;
     1720    19440    6                    DO WHILE(I<256);
     1721    19441    7                       IF SUBSTR(MEBUF,I,1)~=' ' THEN DO;
     1722    19442    8                          IF SUBSTR(MEBUF,I,1)='''' THEN DO;
     1723    19443    8                             CALL INDEX(L,'''',MEBUF,I+1)
     1724    19444    9                             WHENRETURN DO;
     1725    19445    9                                SUBSTR(MEBUF,J,L-I+1)=SUBSTR(MEBUF,I,
     1726    19446    9                                  L-I+1);
     1727    19447    9                                J=J+L-I+1;
     1728    19448    9                                I=L+1;
     1729    19449    9                                END;
     1730    19450    9                             WHENALTRETURN DO;
     1731    19451    9                                L=69;
     1732    19452    9                                I=255;
     1733    19453    9                                END;
     1734    19454    8                             END;
     1735    19455    8                          ELSE DO;
     1736    19456    8                             SUBSTR(MEBUF,J,1)=SUBSTR(MEBUF,I,1);
     1737    19457    8                             J=J+1;
     1738    19458    8                             IF SUBSTR(MEBUF,J,1)=',' THEN
     1739    19459    8                                K=K+1;
     1740    19460    8                             END;
     1741    19461    7                          END;
     1742    19462    6                       I=I+1;
     1743    19463    6                       END;
     1744    19464
     1745    19465        /****
     1746    19466        *
     1747    19467        *   K counts commas.  If more than two were encountered, error!
     1748    19468        *
     1749    19469        ****/
     1750    19470
     1751    19471    6                    IF K>2 THEN DO;
     1752    19472    6                       CALL XUR$ERRMSG(%E$VWM_UID);
     1753    19473    6                       IF B$JIT.MODE=%M_INT# OR ARGB.MISC.PROMPT THEN
     1754    19474    6                          GOTO TRY_AGAIN;
     1755    19475    6                       ALTRETURN;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:50   
     1756    19476    6                       END;
     1757    19477    6                    DO CASE(K);
     1758    19478
     1759    19479
     1760    19480        /****
     1761    19481        *
     1762    19482        *   Nothing entered, foreign logon, or password only.
     1763    19483        *
     1764    19484        ****/
     1765    19485
     1766    19486    6                     CASE(0);
     1767    19487    7                       IF J>0 THEN DO;
     1768    19488    8                          IF SUBSTR(MEBUF,0,1)~='''' THEN DO;
     1769    19489    9                             IF J>8 THEN DO;
     1770    19490    9                                CALL XUR$ERRMSG(%E$VWM_UID);
     1771    19491    9                                IF B$JIT.MODE=%M_INT# OR ARGB.MISC.PROMPT THEN
     1772    19492    9                                   GOTO TRY_AGAIN;
     1773    19493    9                                ALTRETURN;
     1774    19494    9                                END;
     1775    19495    8                             ARGB.EPASS=SUBSTR(MEBUF,0,J);
     1776    19496    8                             END;
     1777    19497    8                          ELSE DO;
     1778    19498    9                             IF J>67 THEN DO;
     1779    19499    9                                CALL XUR$ERRMSG(%E$VWM_UID);
     1780    19500    9                                IF B$JIT.MODE=%M_INT# THEN
     1781    19501    9                                   GOTO TRY_AGAIN;
     1782    19502    9                                ALTRETURN;
     1783    19503    9                                END;
     1784    19504    8                             SUBSTR(ARGF,4,67)=SUBSTR(MEBUF,0,J);
     1785    19505    8                             END;
     1786    19506    7                          END;
     1787    19507
     1788    19508        /****
     1789    19509        *
     1790    19510        *   Account,name
     1791    19511        *
     1792    19512        ****/
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:51   
     1793    19513
     1794    19514    6                     CASE(1);
     1795    19515    6                       CALL INDEX(K,',',MEBUF);
     1796    19516    7                       IF K<1 OR K>8 OR J-K<2 OR J-K>13 THEN DO;
     1797    19517    7                          CALL XUR$ERRMSG(%E$VWM_UID);
     1798    19518    7                          IF B$JIT.MODE=%M_INT# THEN
     1799    19519    7                             GOTO TRY_AGAIN;
     1800    19520    7                          ALTRETURN;
     1801    19521    7                          END;
     1802    19522    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,0,K)) WHENRETURN DO;
     1803    19523    7                          CALL XUR$ERRMSG(%E$VWM_UID);
     1804    19524    7                          IF B$JIT.MODE=%M_INT# THEN
     1805    19525    7                             GOTO TRY_AGAIN;
     1806    19526    7                          ALTRETURN;
     1807    19527    7                          END;
     1808    19528    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,K+1,J-K-1)) WHENRETURN DO;
     1809    19529    7                          CALL XUR$ERRMSG(%E$VWM_UID);
     1810    19530    7                          IF B$JIT.MODE=%M_INT# THEN
     1811    19531    7                             GOTO TRY_AGAIN;
     1812    19532    7                          ALTRETURN;
     1813    19533    7                          END;
     1814    19534    6                       ARGB.ACCT=SUBSTR(MEBUF,0,K);
     1815    19535    6                       ARGB.NAME=SUBSTR(MEBUF,K+1,J-K-1);
     1816    19536
     1817    19537        /****
     1818    19538        *
     1819    19539        *   Account,name,password
     1820    19540        *
     1821    19541        ****/
     1822    19542
     1823    19543    6                     CASE(2);
     1824    19544    6                       CALL INDEX(K,',',MEBUF);
     1825    19545    6                       CALL INDEX(L,',',MEBUF,K+1);
     1826    19546    7                       IF K<1 OR K>8 OR L-K<2 OR L-K>13 OR J-L<2 OR J-L>9 THEN DO;
     1827    19547    7                          CALL XUR$ERRMSG(%E$VWM_UID);
     1828    19548    7                          IF B$JIT.MODE=%M_INT# THEN
     1829    19549    7                             GOTO TRY_AGAIN;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:52   
     1830    19550    7                          ALTRETURN;
     1831    19551    7                          END;
     1832    19552    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,0,K)) WHENRETURN DO;
     1833    19553    7                          CALL XUR$ERRMSG(%E$VWM_UID);
     1834    19554    7                          IF B$JIT.MODE=%M_INT# THEN
     1835    19555    7                             GOTO TRY_AGAIN;
     1836    19556    7                          ALTRETURN;
     1837    19557    7                          END;
     1838    19558    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,K+1,L-K-1)) WHENRETURN DO;
     1839    19559    7                          CALL XUR$ERRMSG(%E$VWM_UID);
     1840    19560    7                          IF B$JIT.MODE=%M_INT# THEN
     1841    19561    7                             GOTO TRY_AGAIN;
     1842    19562    7                          ALTRETURN;
     1843    19563    7                          END;
     1844    19564    6                       ARGB.ACCT=SUBSTR(MEBUF,0,K);
     1845    19565    6                       ARGB.NAME=SUBSTR(MEBUF,K+1,L-K-1);
     1846    19566    6                       ARGB.EPASS=SUBSTR(MEBUF,L+1,J-L-1);
     1847    19567    6                     END;
     1848    19568    5                    END;
     1849    19569    4                 IF B$JIT.MODE=%M_INT# THEN
     1850    19570    4                    CALL M$STRMCTL(ECHO_ON);
     1851    19571    4                 END;
     1852    19572    3              END;
     1853    19573
     1854    19574        /****
     1855    19575        *
     1856    19576        *   Encode the password, no matter where it came from.
     1857    19577        *
     1858    19578        ****/
     1859    19579
     1860    19580    3           IF ARGB.NODE~=' ' AND SUBSTR(ARGB.ACCT,0,1)~='''' THEN DO;
     1861    19581    3              PASSWORD=ARGB.EPASS;
     1862    19582    3              IF DOIT THEN
     1863    19583    3                 CALL ASZ$SCRAMBLE(PASSWORD);
     1864    19584    4              DO I=0 TO 11;
     1865    19585    4                 ARGB.BIT9(I)=BIT6(I)+ASCBIN(' ');
     1866    19586    4                 END;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:53   
     1867    19587    3              END;
     1868    19588
     1869    19589        /****
     1870    19590        *
     1871    19591        *   Disallow :MAIL,500ATOB as a legal logon.
     1872    19592        *
     1873    19593        ****/
     1874    19594
     1875    19595    2           IF ARGB.NODE~=' ' AND ARGB.ACCT=':MAIL' AND ARGB.NAME='500ATOB'
     1876    19596    3           THEN DO;
     1877    19597    3              CALL XUR$ERRMSG(%E$VWM_SUK);
     1878    19598    3              ALTRETURN;
     1879    19599    3              END;
     1880    19600
     1881    19601    2           RETURN;
     1882    19602
     1883    19603    2   END;
     1884    19604
     1885    19605    1   END;
     1886    19606        %EOD;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:54   
--  Include file information  --

   VW_FPTS_M.:VMB6TOU  cannot be made into a system file and is referenced.
   VW_NODEATER_E.:VMB6TOU  is referenced.
   VW_OPTS_M.:VMB6TOU  is referenced.
   VWM_ERRS_E.:VMB6TOU  is referenced.
   VW_MOVE_E.:VMB6TOU  is referenced.
   XUR_ENTRY.:LIB_E05  cannot be made into a system file and is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   KL_SUPER_C.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VWM$MOVE.

   Procedure VWM$MOVE requires 2569 words for executable code.
   Procedure VWM$MOVE is declared NOAUTO and requires 2526 words of local(STATIC) storage.

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:55   

 Object Unit name= VWM$MOVE                                   File name= VWM$MOVE.:VMB6TOU
 UTS= AUG 20 '97 15:41:59.80 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none  2526   4736  VWM$MOVE
    1   DCB   even  none     0      0  M$UC
    2  RtLbCm even  none     2      2  ACCT_NODE
    3  RoData even  UTS    161    241  VWM$MOVE
    4   DCB   even  none    98    142  M$CONTINUATION
    5   DCB   even  none     0      0  M$ME
    6   DCB   even  none     0      0  M$LL
    7   DCB   even  none     0      0  M$NODE
    8   DCB   even  none     0      0  M$INP
    9   DCB   even  none     0      0  M$HLP
   10   Proc  even  none  2569   5011  VWM$MOVE
   11  RoData even  none   124    174  VWM$MOVE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes            yes      Main       0  VWM$MOVE
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:56   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      1  VW_OPTIONS#                        0   1420  P_PCB
    0   2427  VW_INPCNT#                         0   2430  VW_OUTCNT#
    0   2431  VW_TOTBYTES#                       0   4644  VW_IAM#
    0   4700  VW_SCRAMBLE#

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       6 XUR$GETCMD
 yes     yes           Std       1 VWB$BEAM
         yes          Async      0 VWY$YOUCALLD
 yes     yes           Std       4 XUR$SETDCBS
 yes     yes           Std       1 XUR$ECHOIF
 yes     yes           Std       3 VWM$FIX_MAILBOX
 yes     yes           Std       2 XTX$ADAPT
 yes     yes           Std       3 XUR$INIT
 yes     yes           Std       1 XUR$SETERRMSG
 yes     yes           Std       0 VWK$SUCK
 yes     yes           Std       3 VWM$GET_MAILBOX
 yes     yes           Std       2 XUR$ERRPTR
 yes     yes           Std       7 XUR$ERRMSG
         yes           Std       1 ASZ$SCRAMBLE
                       nStd      0 X66_MSTATIC
                       nStd      0 X66_MSRET
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:57   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    B$XL_UPPER$                      r    B$SR_NON_BLANK$
     M$CONTINUATION                        VWM_COMMAND                           B$JIT$
     B$TCB$                                B_VERSION                             M$ME
     M$LL                                  M$NODE                                M$INP
     M$HLP

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:58   


        1        1        /*M* VWM$MOVE - User interface for file transporter. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*F**
        9        9        *
       10       10        *   NAME:  VWM$MOVE
       11       11        *
       12       12        *   PURPOSE:
       13       13        *       To provide a user interface for file transfer.
       14       14        *
       15       15        *   DESCRIPTION:
       16       16        *       Parse the user's command(s) into VW_OPTIONS#, then call the
       17       17        *       BEAM or SUCK subroutines to perform the task.
       18       18        *
       19       19        *   REFERENCE:
       20       20        *       See the appropriate Architecture File document for a description
       21       21        *       of MOVE.
       22       22        *
       23       23        ****/
       24       24
       25       25        /*D**
       26       26        *
       27       27        *   NAME:  VWM$MOVE
       28       28        *
       29       29        *   CALL:
       30       30        *       Main program.
       31       31        *
       32       32        *   PARAMETERS:
       33       33        *       None.
       34       34        *
       35       35        *   INTERFACE:
       36       36        *       Calls VWB$BEAM, VWK$SUCK, and references VWY$YOUCALLD.
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:59   
       37       37        *       Also uses the parser, XUR$ routines, and ASZ$SCRAMBLE.
       38       38        *
       39       39        *   ENVIRONMENT:
       40       40        *       This is the main program for the user interface for file transfer.
       41       41        *
       42       42        *   INPUT:
       43       43        *       B$JIT.CCBUF may contain a command to be parsed; if it doesn't,
       44       44        *       the user is prompted for input.
       45       45        *
       46       46        *   OUTPUT:
       47       47        *       VW_OPTIONS# is set up for a file transfer when valid data are
       48       48        *       parsed.  VW_IAM# is set up with the name of "this" node.  Other
       49       49        *       VW_? global symbols reside here and may be initialized, though
       50       50        *       this routine usually doesn't use them.
       51       51        *
       52       52        *   SCRATCH:
       53       53        *       None.
       54       54        *
       55       55        *   DESCRIPTION:
       56       56        *       MOVE moves files between CP-6 systems, Any file type may be
       57       57        *       transmitted; keys, DVBYTE, and file attributes are retained,
       58       58        *       unless otherwise specified.
       59       59        *
       60       60        ****/
       61       61
       62       62        VWM$MOVE: PROC MAIN NOAUTO;

     62 10 000000   000000 700200 xent  VWM$MOVE     TSX0  ! X66_MSTATIC
        10 000001   000000 000000 0                  ZERO    0,0

       63       63
       64       64        /****
       65       65        *
       66       66        *   %INCLUDEs
       67       67        *
       68       68        ****/
       69       69
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:60   
       70       70        %INCLUDE B$TABLES_C;
       71      178        %INCLUDE CP_6;
       72     5737        %INCLUDE CP_6_SUBS;
       73     6277        %INCLUDE B$JIT;
       74     6880        %INCLUDE B_ERRORS_C;
       75     8007        %INCLUDE KL_SUPER_C;
       76    10909        %INCLUDE XU_MACRO_C;
       77    14015        %INCLUDE XUR_ENTRY;
       78    14047        %INCLUDE VW_MOVE_E;
       79    14125        %INCLUDE VWM_ERRS_E;
       80    14499        %INCLUDE VW_OPTS_M;
       81    15183        %MOVE_OPTIONS(STCLASS="STATIC SYMDEF");
       82    15686        %INCLUDE VW_NODEATER_E;
       83    15742        %INCLUDE VW_FPTS_M;
       84    16163        %KL_DREC(NAME=HLPBUF,LAST=",");
       85    16276        %KL_FEBLK(LVL=2,STCLASS=STATIC,RCNT=31);
       86    16325
       87    16326        /****
       88    16327        *
       89    16328        *   FPTs
       90    16329        *
       91    16330        ****/
       92    16331
       93    16332                  %P_PCB;
       94    16531
       95    16532        %PARSE$OUT;
       96    16577
       97    16578        %PARSE$SYM;
       98    16616
       99    16617        %B$XL_UPPER;
      100    16621        %B$SR_NON_BLANK;
      101    16625
      102    16626        %FPT_PRIV (FPTN=FMSEC, PRIV=%PR_FMSEC#);
      103    16641
      104    16642        %FPT_EXIT(STEPCC=ABORT);
      105    16657
      106    16658        %FPT_INT(UENTRY=VWY$YOUCALLD);
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:61   
      107    16672
      108    16673        %FPT_FID(FPTN=FID_INP,
      109    16674                 ACCT=ACCT_INP,
      110    16675                 NAME=NAME_INP,
      111    16676                 PASS=PASS_INP,
      112    16677                 SN=SN_INP,
      113    16678                 ASN=ASN_INP,
      114    16679                 RES=RES_INP,
      115    16680                 RESULTS=INP_VLR);
      116    16703
      117    16704        %VLP_ACCT(FPTN=ACCT_INP,
      118    16705                  ACCT='        ');
      119    16718
      120    16719        %VLP_NAME(FPTN=NAME_INP,
      121    16720                  LEN=31,
      122    16721                  NAME=' ');
      123    16748
      124    16749        %VLP_PASS(FPTN=PASS_INP,
      125    16750                  PASS='        ');
      126    16763
      127    16764        %VLP_SN(FPTN=SN_INP,
      128    16765                N=6);
      129    16778
      130    16779        %VLR_FID(FPTN=INP_VLR);
      131    16798
      132    16799        %FPT_FID(FPTN=FID_OUT,
      133    16800                 ACCT=ACCT_OUT,
      134    16801                 NAME=NAME_OUT,
      135    16802                 PASS=PASS_OUT,
      136    16803                 SN=SN_OUT,
      137    16804                 ASN=ASN_OUT,
      138    16805                 RES=RES_OUT,
      139    16806                 RESULTS=OUT_VLR);
      140    16829
      141    16830        %VLP_ACCT(FPTN=ACCT_OUT,
      142    16831                  ACCT='        ');
      143    16844
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:62   
      144    16845        %VLP_NAME(FPTN=NAME_OUT,
      145    16846                  LEN=31,
      146    16847                  NAME=' ');
      147    16874
      148    16875        %VLP_PASS(FPTN=PASS_OUT,
      149    16876                  PASS='        ');
      150    16889
      151    16890        %VLP_SN(FPTN=SN_OUT,
      152    16891                N=6);
      153    16904
      154    16905        %VLR_FID(FPTN=OUT_VLR);
      155    16924
      156    16925        %VLR_FID(FPTN=MAIL_VLR);
      157    16944
      158    16945        %FPT_UNFID(FPTN=UNFID_INP,
      159    16946                   ACCT=ACCT_INP,
      160    16947                   ASN=ASN_INP,
      161    16948                   LEN=I,
      162    16949                   NAME=NAME_INP,
      163    16950                   PASS=PASS_INP,
      164    16951                   RES=RES_INP,
      165    16952                   SN=SN_INP,
      166    16953                   TEXTFID=OPTS.INP.FID);
      167    16971
      168    16972        %FPT_UNFID(FPTN=UNFID_OUT,
      169    16973                   ACCT=ACCT_OUT,
      170    16974                   ASN=ASN_OUT,
      171    16975                   LEN=I,
      172    16976                   NAME=NAME_OUT,
      173    16977                   PASS=PASS_OUT,
      174    16978                   RES=RES_OUT,
      175    16979                   SN=SN_OUT,
      176    16980                   TEXTFID=OPTS.OUT.FID);
      177    16998
      178    16999        %FPT_OPEN(FPTN=OPEN_ITST,
      179    17000                  DCB=M$INP,
      180    17001                  NAME=NAME_INP,
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:63   
      181    17002                  ACCT=ACCT_INP,
      182    17003                  PASS=PASS_INP,
      183    17004                  ASN=FILE,
      184    17005                  FUN=IN,
      185    17006                  TEST=YES,
      186    17007                  SCRUB=YES,
      187    17008                  EXIST=OLDFILE,
      188    17009                  SN=SN_INP);
      189    17118
      190    17119        %FPT_OPEN(FPTN=OPEN_OTST,
      191    17120                  DCB=M$INP,
      192    17121                  NAME=NAME_OUT,
      193    17122                  ACCT=ACCT_OUT,
      194    17123                  PASS=PASS_OUT,
      195    17124                  ASN=FILE,
      196    17125                  FUN=IN,
      197    17126                  TEST=YES,
      198    17127                  SCRUB=YES,
      199    17128                  EXIST=OLDFILE,
      200    17129                  SN=SN_OUT);
      201    17238
      202    17239        %FPT_READ(FPTN=READ_ME,
      203    17240                  DCB=M$ME,
      204    17241                  BUF=MEBUF);
      205    17280
      206    17281        %FPT_OPEN(FPTN=OPEN_HLP,
      207    17282                  DCB=M$HLP,
      208    17283                  NAME=NAME_HLP,
      209    17284                  ACCT=ACCT_HLP,
      210    17285                  FUN=IN,
      211    17286                  ACS=DIRECT,
      212    17287                  SHARE=ALL,
      213    17288                  ASN=FILE);
      214    17397
      215    17398        %VLP_NAME(FPTN=NAME_HLP,
      216    17399                  LEN=4,
      217    17400                  NAME=':HLP');
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:64   
      218    17427
      219    17428        %VLP_ACCT(FPTN=ACCT_HLP,
      220    17429                  ACCT=':SYS');
      221    17442
      222    17443        %FPT_READ(FPTN=READ_HLP,
      223    17444                  DCB=M$HLP,
      224    17445                  BUF=HLPBUF,
      225    17446                  KEYS=YES,
      226    17447                  KEY=ACCTNAME);
      227    17486
      228    17487        %FPT_CLOSE(FPTN=CLOSE_HLP,
      229    17488                   DCB=M$HLP,
      230    17489                   DISP=SAVE);
      231    17531
      232    17532        %FPT_WAIT(FPTN=SNOOZE,
      233    17533                  UNITS=5);
      234    17547
      235    17548        %FPT_TRMCTL(FPTN=ECHO_OF,
      236    17549                    TRMCTL=VLP_OF);
      237    17576
      238    17577        %VLP_TRMCTL(FPTN=VLP_OF,
      239    17578                    DISPINPUT=NO);
      240    17618
      241    17619        %FPT_TRMCTL(FPTN=ECHO_ON,
      242    17620                    TRMCTL=VLP_ON);
      243    17647
      244    17648        %VLP_TRMCTL(FPTN=VLP_ON,
      245    17649                    DISPINPUT=YES);
      246    17689
      247    17690        %FPT_PROMPT(VFC=YES);
      248    17718
      249    17719        %FPT_PRIV(PRIV=%PR_FMREAD#);
      250    17734
      251    17735        %M$DCB(DCBN=M$CONTINUATION,
      252    17736               ASN=FILE,
      253    17737               EXIST=OLDFILE,
      254    17738               FUN=IN,
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:65   
      255    17739               NAME='*CONTINUATION_COMMANDS');
      256    17813
      257    17814        %F$DCB(DCBN=DUMMY);
      258    17871
      259    17872        %B$TCB;
      260    17875
      261    17876        %B$ALT;
      262    17884
      263    17885        %XUR_INIT(SYNTAX=YES,
      264    17886                  PCB=P_PCB,
      265    17887                  WORK=WRKBUF);
      266    17986
      267    17987        /****
      268    17988        *
      269    17989        *   Local variables.
      270    17990        *
      271    17991        ****/
      272    17992
      273    17993    1   DCL VWB$BEAM                       ENTRY(1) ALTRET;
      274    17994    1   DCL VWK$SUCK                       ENTRY ALTRET;
      275    17995    1   DCL VWY$YOUCALLD                   ENTRY ASYNC;
      276    17996
      277    17997    1   DCL VWM_COMMAND SYMREF             BIT(36);
      278    17998    1   DCL B$JIT$ SYMREF                  PTR;
      279    17999    1   DCL B$TCB$ SYMREF                  PTR;
      280    18000    1   DCL 1 B_VERSION SYMREF,
      281    18001    1         2 L UNAL                     UBIN BYTE,
      282    18002    1         2 C UNAL                     CHAR(B_VERSION.L);
      283    18003
      284    18004    1   DCL M$ME                           DCB;
      285    18005    1   DCL M$LL                           DCB;
      286    18006    1   DCL M$NODE                         DCB;
      287    18007    1   DCL M$INP                          DCB;
      288    18008    1   DCL M$HLP                          DCB;
      289    18009
      290    18010    1   DCL I                              SBIN;
      291    18011    1   DCL J                              SBIN;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:66   
      292    18012    1   DCL K                              SBIN;
      293    18013    1   DCL OPTX                           SBIN;
      294    18014    1   DCL RECX                           SBIN;
      295    18015    1   DCL VW_INPCNT# STATIC SYMDEF       SBIN;
      296    18016    1   DCL VW_OUTCNT# STATIC SYMDEF       SBIN;
      297    18017    1   DCL VW_TOTBYTES# STATIC SYMDEF     SBIN;
      298    18018    1   DCL ASN_INP                        UBIN BYTE;
      299    18019    1   DCL ASN_OUT                        UBIN BYTE;
      300    18020    1   DCL RES_INP                        CHAR(4);
      301    18021    1   DCL RES_OUT                        CHAR(4);
      302    18022
      303    18023    1   DCL P                              PTR;
      304    18024    1   DCL BLK$                           PTR;
      305    18025    1   DCL OPT$                           PTR;
      306    18026
      307    18027    1   DCL WRKBUF STATIC DALIGNED         CHAR(4096);
      308    18028    1   DCL MEBUF STATIC                   CHAR(256);
      309    18029    1   DCL LOBUF STATIC                   CHAR(256);
      310    18030    1   DCL DWORK                          CHAR(8);
      311    18031    1   DCL VW_IAM# STATIC SYMDEF          CHAR(8);
      312    18032    1   DCL ASTERISK CONSTANT              CHAR(2) INIT('@*');
      313    18033
      314    18034    1   DCL 1 ACCTNAME STATIC,
      315    18035    1         2 L UNAL                     UBIN BYTE,
      316    18036    1         2 ACCT UNAL                  CHAR(8),
      317    18037    1         2 NAME UNAL                  CHAR(12);
      318    18038
      319    18039    1   DCL 1 ERRMSGFID CONSTANT,
      320    18040    1         2 L UNAL                     UBIN BYTE INIT(15),
      321    18041    1         2 C UNAL                     CHAR(39) INIT(':VWERRMSG.:SYS');
      322    18042
      323    18043    1   DCL 1 U1,
      324    18044    1         2 L UNAL                     UBIN BYTE,
      325    18045    1         2 C UNAL                     CHAR(79);
      326    18046
      327    18047    1   DCL 1 PROMPT CONSTANT,
      328    18048    1         2 * UNAL                     UBIN BYTE INIT(2),
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:67   
      329    18049    1         2 * UNAL                     CHAR(2) INIT('::');
      330    18050
      331    18051    1   DCL VW_SCRAMBLE# STATIC SYMDEF     BIT(1);
      332    18052    1   DCL ONCE                           BIT(1);
      333    18053
      334    18054    1   DCL UPPERS(0:1) CONSTANT           CHAR(64) INIT(
      335    18055    1           '                                 !"#$%&''()*+,-./0123456789:;<=>?',
      336    18056    1           '@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{|}~ ');
      337    18057
      338    18058
      339    18059    1   dcl  VWM$GET_MAILBOX      entry(3) altret;
      340    18060    1   dcl  VWM$FIX_MAILBOX      entry(3) altret;
      341    18061
      342    18062        %EJECT;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:68   
      343    18063        /****
      344    18064        *
      345    18065        *   Main program for user interface.  Parse command into OPTS
      346    18066        *   then pass command to BEAM or SUCK as appropriate.
      347    18067        *
      348    18068        ****/
      349    18069
      350    18070        /****
      351    18071        *
      352    18072        *   MOVE is linked with FMSEC so that it can forcibly write files into
      353    18073        *   the :MOVE account for intrasystem beaming (used to support external
      354    18074        *   nodes).  This privilege is on when MOVE is entered, so it should be
      355    18075        *   turned back off unless the user is authorized for that privilege.
      356    18076        *
      357    18077        ****/
      358    18078
      359    18079    1           IF B$JIT.PRIV.ACTIVE.FMSEC AND NOT B$JIT.PRIV.JOB.FMSEC

  18079 10 000002   000000 470400 xsym               LDP0    B$JIT$
        10 000003   000013 236100                    LDQ     11,,PR0
        10 000004   100000 316003                    CANQ    32768,DU
        10 000005   000014 600000 10                 TZE     s:18089
        10 000006   000015 236100                    LDQ     13,,PR0
        10 000007   100000 316003                    CANQ    32768,DU
        10 000010   000014 601000 10                 TNZ     s:18089

      360    18080    1           THEN
      361    18081    1              CALL M$RPRIV (FMSEC);

  18081 10 000011   001436 630400 0                  EPPR0   FMSEC
        10 000012   020013 713400                    CLIMB   8203
        10 000013   400000 401760                    pmme    nvectors=1

      362    18082
      363    18083        /****
      364    18084        *
      365    18085        *   Initialize the XU routines.
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:69   
      366    18086        *
      367    18087        ****/
      368    18088
      369    18089    1           CALL XUR$INIT(XUR_INIT);

  18089 10 000014   000001 630400 11                 EPPR0   1
        10 000015   000000 631400 11                 EPPR1   0
        10 000016   000000 701000 xent               TSX1    XUR$INIT
        10 000017   000000 011000                    NOP     0

      370    18090
      371    18091        /****
      372    18092        *
      373    18093        *   Initialize the error message file; turn off FMR if it shouldn't be on.
      374    18094        *   Set up the initial command continuation DCB to M$CONTINUATION.
      375    18095        *
      376    18096        ****/
      377    18097
      378    18098    1           CALL XUR$SETERRMSG(ERRMSGFID);

  18098 10 000020   000002 630400 11                 EPPR0   2
        10 000021   000000 631400 11                 EPPR1   0
        10 000022   000000 701000 xent               TSX1    XUR$SETERRMSG
        10 000023   000000 011000                    NOP     0

      379    18099    1           CALL XUR$SETDCBS(DCBNUM(M$CONTINUATION));

  18099 10 000024   000000 236007 xsym               LDQ     M$CONTINUATION,DL
        10 000025   004730 756000 0                  STQ     PASSWORD+2
        10 000026   004730 630400 0                  EPPR0   PASSWORD+2
        10 000027   004731 450400 0                  STP0    PASSWORD+3
        10 000030   004731 630400 0                  EPPR0   PASSWORD+3
        10 000031   000000 631400 11                 EPPR1   0
        10 000032   000000 701000 xent               TSX1    XUR$SETDCBS
        10 000033   000000 011000                    NOP     0

      380    18100    1           IF NOT (B$JIT.PRIV.JOB&%PR_FMREAD#) THEN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:70   

  18100 10 000034   000000 470400 xsym               LDP0    B$JIT$
        10 000035   000015 236100                    LDQ     13,,PR0
        10 000036   000171 376000 3                  ANQ     BADDIES+32
        10 000037   000043 601000 10                 TNZ     s:18109

      381    18101    1              CALL M$RPRIV(FPT_PRIV);

  18101 10 000040   002346 630400 0                  EPPR0   FPT_PRIV
        10 000041   020013 713400                    CLIMB   8203
        10 000042   400000 401760                    pmme    nvectors=1

      382    18102
      383    18103        /****
      384    18104        *
      385    18105        *   Open the :NODES file, input; then read the *IAM record.
      386    18106        *
      387    18107        ****/
      388    18108
      389    18109    2           CALL M$OPEN(OPEN_NODE) WHENALTRETURN DO;

  18109 10 000043   000766 630400 0                  EPPR0   OPEN_NODE
        10 000044   450000 713400                    CLIMB   alt,open
        10 000045   410400 401760                    pmme    nvectors=18
        10 000046   000050 702000 10                 TSX2    s:18110
        10 000047   000057 710000 10                 TRA     s:18113

      390    18110    2              CALL XUR$ERRMSG(%E$VWM_NOD);

  18110 10 000050   000004 630400 11                 EPPR0   4
        10 000051   000000 631400 11                 EPPR1   0
        10 000052   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000053   000000 011000                    NOP     0

      391    18111    2              CALL M$EXIT(FPT_EXIT);

  18111 10 000054   001442 630400 0                  EPPR0   FPT_EXIT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:71   
        10 000055   000001 713400                    CLIMB   exit
        10 000056   400400 401760                    pmme    nvectors=2

      392    18112    2              END;

      393    18113    1           NODEKEY.L=8;

  18113 10 000057   010000 236003                    LDQ     4096,DU
        10 000060   001136 552040 0                  STBQ    NODEKEY,'40'O

      394    18114    1           NODEKEY.C='*IAM';

  18114 10 000061   040000 100400                    MLR     fill='040'O
        10 000062   000172 000004 3                  ADSC9   BADDIES+33               cn=0,n=4
        10 000063   001136 200010 0                  ADSC9   NODEKEY                  cn=1,n=8

      395    18115    2           CALL M$READ(READ_NODE) WHENALTRETURN DO;

  18115 10 000064   001062 630400 0                  EPPR0   READ_NODE
        10 000065   440000 713400                    CLIMB   alt,read
        10 000066   401400 401760                    pmme    nvectors=4
        10 000067   000071 702000 10                 TSX2    s:18116
        10 000070   000100 710000 10                 TRA     s:18119

      396    18116    2              CALL XUR$ERRMSG(%E$VWM_NOD);

  18116 10 000071   000004 630400 11                 EPPR0   4
        10 000072   000000 631400 11                 EPPR1   0
        10 000073   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000074   000000 011000                    NOP     0

      397    18117    2              CALL M$EXIT(FPT_EXIT);

  18117 10 000075   001442 630400 0                  EPPR0   FPT_EXIT
        10 000076   000001 713400                    CLIMB   exit
        10 000077   400400 401760                    pmme    nvectors=2

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:72   
      398    18118    2              END;

      399    18119    1           VW_IAM#=NODEOVR.PATH_NAME;

  18119 10 000100   040000 100400                    MLR     fill='040'O
        10 000101   001141 000010 0                  ADSC9   NODEOVR                  cn=0,n=8
        10 000102   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8

      400    18120
      401    18121        /****
      402    18122        *
      403    18123        *   Parse the command in CCBUF or read from M$SI.
      404    18124        *
      405    18125        ****/
      406    18126
      407    18127    1           ONCE='1'B;

  18127 10 000103   400000 236003                    LDQ     -131072,DU
        10 000104   004701 756000 0                  STQ     ONCE

      408    18128    2           IF B$JIT.PRFLAGS.CONTINUED THEN DO;

  18128 10 000105   000000 470400 xsym               LDP0    B$JIT$
        10 000106   000030 430100                    FSZN    24,,PR0
        10 000107   000116 605000 10                 TPL     s:18133

      409    18129    2              I=1;

  18129 10 000110   000001 235007                    LDA     1,DL
        10 000111   002422 755000 0                  STA     I

      410    18130    2              MEBUF=';';

  18130 10 000112   040000 100400                    MLR     fill='040'O
        10 000113   000005 000001 11                 ADSC9   5                        cn=0,n=1
        10 000114   004442 000400 0                  ADSC9   MEBUF                    cn=0,n=256

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:73   
      411    18131    2              END;

  18131 10 000115   000125 710000 10                 TRA     GET_COMMAND

      412    18132    2           ELSE DO;

      413    18133    2              I=B$JIT.CCARS;

  18133 10 000116   000032 236100                    LDQ     26,,PR0
        10 000117   000022 732000                    QRS     18
        10 000120   002422 756000 0                  STQ     I

      414    18134    2              MEBUF=SUBSTR(B$JIT.CCBUF,0,I);

  18134 10 000121   000000 620006                    EAX0    0,QL
        10 000122   040000 100540                    MLR     fill='040'O
        10 000123   000033 000010                    ADSC9   27,,PR0                  cn=0,n=*X0
        10 000124   004442 000400 0                  ADSC9   MEBUF                    cn=0,n=256

      415    18135    2              END;

      416    18136
      417    18137    1   GET_COMMAND:
      418    18138    1           IF ONCE THEN

  18138 10 000125   004701 234000 0     GET_COMMAND  SZN     ONCE
        10 000126   000167 605000 10                 TPL     s:18146

      419    18139    2              CALL XUR$GETCMD(VWM_COMMAND,BLK$,,MEBUF,I) WHENALTRETURN DO;

  18139 10 000127   000010 236000 11                 LDQ     8
        10 000130   004734 756000 0                  STQ     PASSWORD+6
        10 000131   000011 236000 11                 LDQ     9
        10 000132   000007 235000 11                 LDA     7
        10 000133   004732 757000 0                  STAQ    PASSWORD+4
        10 000134   000012 237000 11                 LDAQ    10
        10 000135   004730 757000 0                  STAQ    PASSWORD+2
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:74   
        10 000136   004730 630400 0                  EPPR0   PASSWORD+2
        10 000137   000006 631400 11                 EPPR1   6
        10 000140   000000 701000 xent               TSX1    XUR$GETCMD
        10 000141   000143 702000 10                 TSX2    s:18140
        10 000142   000166 710000 10                 TRA     s:18144

      420    18140    2                 IF P_PCB.HI_CHAR>0 THEN

  18140 10 000143   001432 235000 0                  LDA     P_PCB+10
        10 000144   000157 600000 10                 TZE     s:18142

      421    18141    2                    CALL XUR$ERRPTR(,DCBNUM(M$ME));

  18141 10 000145   000000 236007 xsym               LDQ     M$ME,DL
        10 000146   004730 756000 0                  STQ     PASSWORD+2
        10 000147   004730 630400 0                  EPPR0   PASSWORD+2
        10 000150   004733 450400 0                  STP0    PASSWORD+5
        10 000151   000007 236000 11                 LDQ     7
        10 000152   004732 756000 0                  STQ     PASSWORD+4
        10 000153   004732 630400 0                  EPPR0   PASSWORD+4
        10 000154   000014 631400 11                 EPPR1   12
        10 000155   000000 701000 xent               TSX1    XUR$ERRPTR
        10 000156   000000 011000                    NOP     0

      422    18142    2                 CALL XUR$ERRMSG(BLK$);

  18142 10 000157   000013 630400 11                 EPPR0   11
        10 000160   000000 631400 11                 EPPR1   0
        10 000161   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000162   000000 011000                    NOP     0

      423    18143    2                 CALL M$EXIT(FPT_EXIT);

  18143 10 000163   001442 630400 0                  EPPR0   FPT_EXIT
        10 000164   000001 713400                    CLIMB   exit
        10 000165   400400 401760                    pmme    nvectors=2

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:75   
      424    18144    2                 END;

  18144 10 000166   000246 710000 10                 TRA     s:18166

      425    18145    2           ELSE DO;

      426    18146    3              CALL XUR$GETCMD(VWM_COMMAND,BLK$,PROMPT) WHENALTRETURN DO;

  18146 10 000167   000016 630400 11                 EPPR0   14
        10 000170   000015 631400 11                 EPPR1   13
        10 000171   000000 701000 xent               TSX1    XUR$GETCMD
        10 000172   000174 702000 10                 TSX2    s:18147
        10 000173   000236 710000 10                 TRA     s:18157

      427    18147    3                 I=B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;

  18147 10 000174   000000 470400 xsym               LDP0    B$TCB$
        10 000175   000000 471500                    LDP1    0,,PR0
        10 000176   100102 236100                    LDQ     66,,PR1
        10 000177   000003 772000                    QRL     3
        10 000200   037777 376007                    ANQ     16383,DL
        10 000201   002422 756000 0                  STQ     I

      428    18148    3                 IF I=%E$EOF OR I=%E$EOD OR I=%E$EOT THEN

  18148 10 000202   000006 116007                    CMPQ    6,DL
        10 000203   000210 600000 10                 TZE     s:18149
        10 000204   000012 116007                    CMPQ    10,DL
        10 000205   000210 600000 10                 TZE     s:18149
        10 000206   000002 116007                    CMPQ    2,DL
        10 000207   000212 601000 10                 TNZ     s:18150

      429    18149    3                    CALL M$EXIT;

  18149 10 000210   000001 713400                    CLIMB   exit
        10 000211   000000 401760                    pmme    nvectors=0

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:76   
      430    18150    3                 IF P_PCB.HI_CHAR>0 THEN

  18150 10 000212   001432 235000 0                  LDA     P_PCB+10
        10 000213   000227 600000 10                 TZE     s:18153

      431    18151    3                    CALL XUR$ERRPTR(,DCBNUM(M$ME));

  18151 10 000214   000000 236007 xsym               LDQ     M$ME,DL
        10 000215   004730 756000 0                  STQ     PASSWORD+2
        10 000216   004730 630400 0                  EPPR0   PASSWORD+2
        10 000217   004733 450400 0                  STP0    PASSWORD+5
        10 000220   000007 236000 11                 LDQ     7
        10 000221   004732 756000 0                  STQ     PASSWORD+4
        10 000222   004732 630400 0                  EPPR0   PASSWORD+4
        10 000223   000014 631400 11                 EPPR1   12
        10 000224   000000 701000 xent               TSX1    XUR$ERRPTR
        10 000225   000000 011000                    NOP     0
        10 000226   000231 710000 10                 TRA     s:18154

      432    18152    3                 ELSE
      433    18153    3                    CALL M$EXIT;

  18153 10 000227   000001 713400                    CLIMB   exit
        10 000230   000000 401760                    pmme    nvectors=0

      434    18154    3                 CALL XUR$ERRMSG(BLK$);

  18154 10 000231   000013 630400 11                 EPPR0   11
        10 000232   000000 631400 11                 EPPR1   0
        10 000233   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000234   000000 011000                    NOP     0

      435    18155    3                 GOTO GET_COMMAND;

  18155 10 000235   000125 710000 10                 TRA     GET_COMMAND

      436    18156    3                 END;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:77   
      437    18157    2              CALL XUR$ECHOIF(DCBNUM(M$ME));

  18157 10 000236   000000 236007 xsym               LDQ     M$ME,DL
        10 000237   004730 756000 0                  STQ     PASSWORD+2
        10 000240   004730 630400 0                  EPPR0   PASSWORD+2
        10 000241   004731 450400 0                  STP0    PASSWORD+3
        10 000242   004731 630400 0                  EPPR0   PASSWORD+3
        10 000243   000000 631400 11                 EPPR1   0
        10 000244   000000 701000 xent               TSX1    XUR$ECHOIF
        10 000245   000000 011000                    NOP     0

      438    18158    2              END;

      439    18159
      440    18160        /****
      441    18161        *
      442    18162        *   Reset working storage cells to defaults.
      443    18163        *
      444    18164        ****/
      445    18165
      446    18166    1           VW_OPTIONS#=' ';

  18166 10 000246   040000 100400                    MLR     fill='040'O
        10 000247   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 000250   000001 003720 0                  ADSC9   VW_OPTIONS#              cn=0,n=2000

      447    18167    1           OPTS.MAILINIT.WHO='I';

  18167 10 000251   111000 236003                    LDQ     37376,DU
        10 000252   000242 552040 0                  STBQ    VW_OPTIONS#+161,'40'O

      448    18168    1           OPTX=0;

  18168 10 000253   002425 450000 0                  STZ     OPTX

      449    18169    1           RECX=0;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:78   
  18169 10 000254   002426 450000 0                  STZ     RECX

      450    18170
      451    18171        /****
      452    18172        *
      453    18173        *   Walk through the options list, parsing into OPTS.
      454    18174        *
      455    18175        ****/
      456    18176
      457    18177    1           BLK$=P_PCB.OUT$;

  18177 10 000255   001423 236000 0                  LDQ     P_PCB+3
        10 000256   002437 756000 0                  STQ     BLK$

      458    18178    1           I=1;

  18178 10 000257   000001 235007                    LDA     1,DL
        10 000260   002422 755000 0                  STA     I

      459    18179
      460    18180        /****
      461    18181        *
      462    18182        *   Look for an ending command.
      463    18183        *
      464    18184        ****/
      465    18185
      466    18186    1           IF OUT$BLK.NSUBLKS<1 THEN

  18186 10 000261   002437 470400 0                  LDP0    BLK$
        10 000262   000001 220100                    LDX0    1,,PR0
        10 000263   000266 601000 10                 TNZ     s:18188

      467    18187    1              CALL M$EXIT;

  18187 10 000264   000001 713400                    CLIMB   exit
        10 000265   000000 401760                    pmme    nvectors=0

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:79   
      468    18188    2           IF OUT$BLK.NSUBLKS=1 THEN DO;

  18188 10 000266   002437 470400 0                  LDP0    BLK$
        10 000267   000001 220100                    LDX0    1,,PR0
        10 000270   000001 100003                    CMPX0   1,DU
        10 000271   000342 601000 10                 TNZ     s:18202

      469    18189    2              P=OUT$BLK.SUBLK$(0);

  18189 10 000272   000003 236100                    LDQ     3,,PR0
        10 000273   002436 756000 0                  STQ     P

      470    18190    2              CALL XLATE(U1.C,UPPERS,SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT));

  18190 10 000274   002436 471400 0                  LDP1    P
        10 000275   100004 236100                    LDQ     4,,PR1
        10 000276   000033 772000                    QRL     27
        10 000277   000000 620006                    EAX0    0,QL
        10 000300   040000 160540                    MVT     fill='040'O
        10 000301   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
        10 000302   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000303   000055 000000 3                  ARG     UPPERS

      471    18191    2              IF U1.C='END' OR U1.C='QUIT' OR U1.C='STOP' OR U1.C='EXIT'

  18191 10 000304   040000 106400                    CMPC    fill='040'O
        10 000305   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000306   000173 000003 3                  ADSC9   BADDIES+34               cn=0,n=3
        10 000307   000340 600000 10                 TZE     s:18193
        10 000310   040000 106400                    CMPC    fill='040'O
        10 000311   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000312   000174 000004 3                  ADSC9   BADDIES+35               cn=0,n=4
        10 000313   000340 600000 10                 TZE     s:18193
        10 000314   040000 106400                    CMPC    fill='040'O
        10 000315   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000316   000175 000004 3                  ADSC9   BADDIES+36               cn=0,n=4
        10 000317   000340 600000 10                 TZE     s:18193
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:80   
        10 000320   040000 106400                    CMPC    fill='040'O
        10 000321   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000322   000176 000004 3                  ADSC9   BADDIES+37               cn=0,n=4
        10 000323   000340 600000 10                 TZE     s:18193
        10 000324   040000 106400                    CMPC    fill='040'O
        10 000325   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000326   000022 000001 11                 ADSC9   18                       cn=0,n=1
        10 000327   000340 600000 10                 TZE     s:18193
        10 000330   040000 106400                    CMPC    fill='040'O
        10 000331   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000332   000023 000001 11                 ADSC9   19                       cn=0,n=1
        10 000333   000340 600000 10                 TZE     s:18193
        10 000334   040000 106400                    CMPC    fill='040'O
        10 000335   004654 200117 0                  ADSC9   U1                       cn=1,n=79
        10 000336   000024 000001 11                 ADSC9   20                       cn=0,n=1
        10 000337   000342 601000 10                 TNZ     s:18202

      472    18192    2                OR U1.C='X' OR U1.C='E' OR U1.C='Q' THEN
      473    18193    2                 CALL M$EXIT;

  18193 10 000340   000001 713400                    CLIMB   exit
        10 000341   000000 401760                    pmme    nvectors=0

      474    18194    2              END;

      475    18195
      476    18196        /****
      477    18197        *
      478    18198        *   Look for the input FID.
      479    18199        *
      480    18200        ****/
      481    18201
      482    18202    1           IF I>=OUT$BLK.NSUBLKS THEN

  18202 10 000342   002437 470400 0                  LDP0    BLK$
        10 000343   000001 236100                    LDQ     1,,PR0
        10 000344   000022 772000                    QRL     18
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:81   
        10 000345   002422 116000 0                  CMPQ    I
        10 000346   001012 604400 10                 TMOZ    DONE_PARSING

      483    18203    1              GOTO DONE_PARSING;
      484    18204    1           P=OUT$BLK.SUBLK$(I);

  18204 10 000347   002422 720000 0                  LXL0    I
        10 000350   000003 236110                    LDQ     3,X0,PR0
        10 000351   002436 756000 0                  STQ     P

      485    18205    2           IF P->OUT$BLK.CODE=%FID# THEN DO;

  18205 10 000352   002436 471400 0                  LDP1    P
        10 000353   100000 721100                    LXL1    0,,PR1
        10 000354   000002 101003                    CMPX1   2,DU
        10 000355   000466 601000 10                 TNZ     s:18247

      486    18206    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>79 THEN DO;

  18206 10 000356   100004 236100                    LDQ     4,,PR1
        10 000357   777000 316003                    CANQ    -512,DU
        10 000360   000365 600000 10                 TZE     s:18207
        10 000361   100004 236100                    LDQ     4,,PR1
        10 000362   777000 376003                    ANQ     -512,DU
        10 000363   120000 116003                    CMPQ    40960,DU
        10 000364   000372 602000 10                 TNC     s:18210

      487    18207    3                 CALL XUR$ERRMSG(%E$VWM_ITL);

  18207 10 000365   000026 630400 11                 EPPR0   22
        10 000366   000000 631400 11                 EPPR1   0
        10 000367   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000370   000000 011000                    NOP     0

      488    18208    3                 GOTO DECIDE;

  18208 10 000371   002626 710000 10                 TRA     DECIDE
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:82   

      489    18209    3                 END;
      490    18210    2              OPTS.INP.L=ASCBIN('/')+P->OUT$SYM.COUNT;

  18210 10 000372   100004 236100                    LDQ     4,,PR1
        10 000373   000033 772000                    QRL     27
        10 000374   000057 036007                    ADLQ    47,DL
        10 000375   000033 736000                    QLS     27
        10 000376   000025 552040 0                  STBQ    VW_OPTIONS#+20,'40'O

      491    18211    2              OPTS.INP.FID=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);

  18211 10 000377   100004 236100                    LDQ     4,,PR1
        10 000400   000033 772000                    QRL     27
        10 000401   000000 621006                    EAX1    0,QL
        10 000402   040000 100540                    MLR     fill='040'O
        10 000403   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 000404   000025 200117 0                  ADSC9   VW_OPTIONS#+20           cn=1,n=79

      492    18212
      493    18213        /****
      494    18214        *
      495    18215        *   See if the WSN came along for the ride.
      496    18216        *
      497    18217        ****/
      498    18218
      499    18219    3              IF SUBSTR(OPTS.INP.FID,0,1)~='''' THEN DO;

  18219 10 000405   000025 236000 0                  LDQ     VW_OPTIONS#+20
        10 000406   000777 376003                    ANQ     511,DU
        10 000407   000047 116003                    CMPQ    39,DU
        10 000410   000465 600000 10                 TZE     s:18238

      500    18220    4                 CALL INDEX(J,'@',OPTS.INP.FID) WHENRETURN DO;

  18220 10 000411   000000 124400                    SCM     mask='000'O
        10 000412   000025 200117 0                  ADSC9   VW_OPTIONS#+20           cn=1,n=79
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:83   
        10 000413   000027 000001 11                 ADSC9   23                       cn=0,n=1
        10 000414   002423 000000 0                  ARG     J
        10 000415   000463 606400 10                 TTN     s:18234

      501    18221    5                    IF J>0 THEN DO;

  18221 10 000416   002423 235000 0                  LDA     J
        10 000417   000431 604400 10                 TMOZ    s:18226

      502    18222    5                       OPTS.INP.L=ASCBIN('/')+J;

  18222 10 000420   002423 236000 0                  LDQ     J
        10 000421   000057 036007                    ADLQ    47,DL
        10 000422   000033 736000                    QLS     27
        10 000423   000025 552040 0                  STBQ    VW_OPTIONS#+20,'40'O

      503    18223    5                       OPTS.INP.FID=SUBSTR(OPTS.INP.FID,0,J);

  18223 10 000424   000000 621005                    EAX1    0,AL
        10 000425   040000 100440                    MLR     fill='040'O
        10 000426   000025 200011 0                  ADSC9   VW_OPTIONS#+20           cn=1,n=*X1
        10 000427   000025 200117 0                  ADSC9   VW_OPTIONS#+20           cn=1,n=79

      504    18224    5                       END;

  18224 10 000430   000436 710000 10                 TRA     s:18229

      505    18225    5                    ELSE DO;

      506    18226    5                       CALL XUR$ERRMSG(%E$VWM_ITL);

  18226 10 000431   000026 630400 11                 EPPR0   22
        10 000432   000000 631400 11                 EPPR1   0
        10 000433   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000434   000000 011000                    NOP     0

      507    18227    5                       GOTO DECIDE;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:84   

  18227 10 000435   002626 710000 10                 TRA     DECIDE

      508    18228    5                       END;
      509    18229    4                    P->OUT$BLK.CODE=%WSN#;

  18229 10 000436   000003 221003                    LDX1    3,DU
        10 000437   100000 441100                    SXL1    0,,PR1

      510    18230    4                    P->OUT$SYM.COUNT=P->OUT$SYM.COUNT-J-1;

  18230 10 000440   002436 470400 0                  LDP0    P
        10 000441   000004 236100                    LDQ     4,,PR0
        10 000442   000033 772000                    QRL     27
        10 000443   002423 136000 0                  SBLQ    J
        10 000444   000001 136007                    SBLQ    1,DL
        10 000445   000033 736000                    QLS     27
        10 000446   000004 552140                    STBQ    4,'40'O,PR0

      511    18231    4                   CALL XLATE (P->OUT$SYM.TEXT, B$XL_UPPER, SUBSTR(P->OUT$SYM.TEXT,J+1
             18231                             ,P->OUT$SYM.COUNT));

  18231 10 000447   002436 470400 0                  LDP0    P
        10 000450   000004 236100                    LDQ     4,,PR0
        10 000451   000033 772000                    QRL     27
        10 000452   000000 620006                    EAX0    0,QL
        10 000453   000000 622006                    EAX2    0,QL
        10 000454   002423 235000 0                  LDA     J
        10 000455   000000 471400 xsym               LDP1    B$XL_UPPER$
        10 000456   040140 160545                    MVT     fill='040'O
        10 000457   000004 400012                    ADSC9   4,A,PR0                  cn=2,n=*X2
        10 000460   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
        10 000461   100000 000100                    ARG     0,,PR1

      512    18232    4                    END;

  18232 10 000462   000464 710000 10                 TRA     s:18236
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:85   

      513    18233    4                 WHENALTRETURN DO;

      514    18234    4                    I=I+1;

  18234 10 000463   002422 054000 0                  AOS     I

      515    18235    4                    END;

      516    18236    3                 END;

  18236 10 000464   000466 710000 10                 TRA     s:18247

      517    18237    2              ELSE
      518    18238    2                 I=I+1;

  18238 10 000465   002422 054000 0                  AOS     I

      519    18239    2              END;

      520    18240
      521    18241        /****
      522    18242        *
      523    18243        *   Look for a source node.
      524    18244        *
      525    18245        ****/
      526    18246
      527    18247    1           IF I>=OUT$BLK.NSUBLKS THEN

  18247 10 000466   002437 470400 0                  LDP0    BLK$
        10 000467   000001 236100                    LDQ     1,,PR0
        10 000470   000022 772000                    QRL     18
        10 000471   002422 116000 0                  CMPQ    I
        10 000472   001012 604400 10                 TMOZ    DONE_PARSING

      528    18248    1              GOTO DONE_PARSING;
      529    18249    1           P=OUT$BLK.SUBLK$(I);
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:86   

  18249 10 000473   002422 720000 0                  LXL0    I
        10 000474   000003 236110                    LDQ     3,X0,PR0
        10 000475   002436 756000 0                  STQ     P

      530    18250    2           IF P->OUT$BLK.CODE=%WSN# THEN DO;

  18250 10 000476   002436 471400 0                  LDP1    P
        10 000477   100000 721100                    LXL1    0,,PR1
        10 000500   000003 101003                    CMPX1   3,DU
        10 000501   000525 601000 10                 TNZ     s:18265

      531    18251    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>8 THEN DO;

  18251 10 000502   100004 236100                    LDQ     4,,PR1
        10 000503   777000 316003                    CANQ    -512,DU
        10 000504   000511 600000 10                 TZE     s:18252
        10 000505   100004 236100                    LDQ     4,,PR1
        10 000506   777000 376003                    ANQ     -512,DU
        10 000507   011000 116003                    CMPQ    4608,DU
        10 000510   000516 602000 10                 TNC     s:18255

      532    18252    3                 CALL XUR$ERRMSG(%E$VWM_SRC);

  18252 10 000511   000031 630400 11                 EPPR0   25
        10 000512   000000 631400 11                 EPPR1   0
        10 000513   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000514   000000 011000                    NOP     0

      533    18253    3                 GOTO DECIDE;

  18253 10 000515   002626 710000 10                 TRA     DECIDE

      534    18254    3                 END;
      535    18255    2              OPTS.INP.NODE=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);

  18255 10 000516   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:87   
        10 000517   000033 772000                    QRL     27
        10 000520   000000 622006                    EAX2    0,QL
        10 000521   040000 100540                    MLR     fill='040'O
        10 000522   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        10 000523   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8

      536    18256    2              I=I+1;

  18256 10 000524   002422 054000 0                  AOS     I

      537    18257    2              END;

      538    18258
      539    18259        /****
      540    18260        *
      541    18261        *   Look for source options.
      542    18262        *
      543    18263        ****/
      544    18264
      545    18265    1           IF I>=OUT$BLK.NSUBLKS THEN

  18265 10 000525   000001 236100                    LDQ     1,,PR0
        10 000526   000022 772000                    QRL     18
        10 000527   002422 116000 0                  CMPQ    I
        10 000530   001012 604400 10                 TMOZ    DONE_PARSING

      546    18266    1              GOTO DONE_PARSING;
      547    18267    1           P=OUT$BLK.SUBLK$(I);

  18267 10 000531   002422 720000 0                  LXL0    I
        10 000532   000003 236110                    LDQ     3,X0,PR0
        10 000533   002436 756000 0                  STQ     P

      548    18268    2           IF P->OUT$BLK.CODE=%OPTLST# THEN DO;

  18268 10 000534   002436 471400 0                  LDP1    P
        10 000535   100000 721100                    LXL1    0,,PR1
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:88   
        10 000536   000004 101003                    CMPX1   4,DU
        10 000537   000547 601000 10                 TNZ     s:18279

      549    18269    2              CALL OPTIONS(P,OPTS.INP) ALTRET(DECIDE);

  18269 10 000540   000032 236000 11                 LDQ     26
        10 000541   004704 756000 0                  STQ     @BLK$+1
        10 000542   000033 236000 11                 LDQ     27
        10 000543   004703 756000 0                  STQ     ONCE+2
        10 000544   002634 701000 10                 TSX1    OPTIONS
        10 000545   002626 702000 10                 TSX2    DECIDE

      550    18270    2              I=I+1;

  18270 10 000546   002422 054000 0                  AOS     I

      551    18271    2              END;

      552    18272
      553    18273        /****
      554    18274        *
      555    18275        *   Look for ON/TO/INTO/OVER.
      556    18276        *
      557    18277        ****/
      558    18278
      559    18279    1           IF I>=OUT$BLK.NSUBLKS THEN

  18279 10 000547   002437 470400 0                  LDP0    BLK$
        10 000550   000001 236100                    LDQ     1,,PR0
        10 000551   000022 772000                    QRL     18
        10 000552   002422 116000 0                  CMPQ    I
        10 000553   001012 604400 10                 TMOZ    DONE_PARSING

      560    18280    1              GOTO DONE_PARSING;
      561    18281    1           P=OUT$BLK.SUBLK$(I);

  18281 10 000554   002422 720000 0                  LXL0    I
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:89   
        10 000555   000003 236110                    LDQ     3,X0,PR0
        10 000556   002436 756000 0                  STQ     P

      562    18282    2           IF P->OUT$BLK.CODE>=%HOWTO# AND P->OUT$BLK.CODE<=%HOWOVER# THEN DO;

  18282 10 000557   002436 471400 0                  LDP1    P
        10 000560   100000 721100                    LXL1    0,,PR1
        10 000561   000012 101003                    CMPX1   10,DU
        10 000562   000574 602000 10                 TNC     s:18293
        10 000563   000016 101003                    CMPX1   14,DU
        10 000564   000574 603000 10                 TRC     s:18293

      563    18283    2              OPTS.OUT.MISC.HOW=P->OUT$BLK.CODE-%HOWTO#;

  18283 10 000565   100000 236100                    LDQ     0,,PR1
        10 000566   777777 376007                    ANQ     -1,DL
        10 000567   000012 136007                    SBLQ    10,DL
        10 000570   000072 676000 0                  ERQ     VW_OPTIONS#+57
        10 000571   000003 376007                    ANQ     3,DL
        10 000572   000072 656000 0                  ERSQ    VW_OPTIONS#+57

      564    18284    2              I=I+1;

  18284 10 000573   002422 054000 0                  AOS     I

      565    18285    2              END;

      566    18286
      567    18287        /****
      568    18288        *
      569    18289        *   Look for the output FID.
      570    18290        *
      571    18291        ****/
      572    18292
      573    18293    1           IF I>=OUT$BLK.NSUBLKS THEN

  18293 10 000574   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:90   
        10 000575   000022 772000                    QRL     18
        10 000576   002422 116000 0                  CMPQ    I
        10 000577   001012 604400 10                 TMOZ    DONE_PARSING

      574    18294    1              GOTO DONE_PARSING;
      575    18295    1           P=OUT$BLK.SUBLK$(I);

  18295 10 000600   002422 720000 0                  LXL0    I
        10 000601   000003 236110                    LDQ     3,X0,PR0
        10 000602   002436 756000 0                  STQ     P

      576    18296    2           IF P->OUT$BLK.CODE=%FID# THEN DO;

  18296 10 000603   002436 471400 0                  LDP1    P
        10 000604   100000 721100                    LXL1    0,,PR1
        10 000605   000002 101003                    CMPX1   2,DU
        10 000606   000717 601000 10                 TNZ     s:18338

      577    18297    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>79 THEN DO;

  18297 10 000607   100004 236100                    LDQ     4,,PR1
        10 000610   777000 316003                    CANQ    -512,DU
        10 000611   000616 600000 10                 TZE     s:18298
        10 000612   100004 236100                    LDQ     4,,PR1
        10 000613   777000 376003                    ANQ     -512,DU
        10 000614   120000 116003                    CMPQ    40960,DU
        10 000615   000623 602000 10                 TNC     s:18301

      578    18298    3                 CALL XUR$ERRMSG(%E$VWM_OTL);

  18298 10 000616   000035 630400 11                 EPPR0   29
        10 000617   000000 631400 11                 EPPR1   0
        10 000620   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000621   000000 011000                    NOP     0

      579    18299    3                 GOTO DECIDE;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:91   
  18299 10 000622   002626 710000 10                 TRA     DECIDE

      580    18300    3                 END;
      581    18301    2              OPTS.OUT.L=ASCBIN('/')+P->OUT$SYM.COUNT;

  18301 10 000623   100004 236100                    LDQ     4,,PR1
        10 000624   000033 772000                    QRL     27
        10 000625   000057 036007                    ADLQ    47,DL
        10 000626   000033 736000                    QLS     27
        10 000627   000075 552040 0                  STBQ    VW_OPTIONS#+60,'40'O

      582    18302    2              OPTS.OUT.FID=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);

  18302 10 000630   100004 236100                    LDQ     4,,PR1
        10 000631   000033 772000                    QRL     27
        10 000632   000000 621006                    EAX1    0,QL
        10 000633   040000 100540                    MLR     fill='040'O
        10 000634   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 000635   000075 200117 0                  ADSC9   VW_OPTIONS#+60           cn=1,n=79

      583    18303
      584    18304        /****
      585    18305        *
      586    18306        *   See if the WSN came along for the ride.
      587    18307        *
      588    18308        ****/
      589    18309
      590    18310    3              IF SUBSTR(OPTS.OUT.FID,0,1)~='''' THEN DO;

  18310 10 000636   000075 236000 0                  LDQ     VW_OPTIONS#+60
        10 000637   000777 376003                    ANQ     511,DU
        10 000640   000047 116003                    CMPQ    39,DU
        10 000641   000716 600000 10                 TZE     s:18329

      591    18311    4                 CALL INDEX(J,'@',OPTS.OUT.FID) WHENRETURN DO;

  18311 10 000642   000000 124400                    SCM     mask='000'O
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:92   
        10 000643   000075 200117 0                  ADSC9   VW_OPTIONS#+60           cn=1,n=79
        10 000644   000027 000001 11                 ADSC9   23                       cn=0,n=1
        10 000645   002423 000000 0                  ARG     J
        10 000646   000714 606400 10                 TTN     s:18325

      592    18312    5                    IF J>0 THEN DO;

  18312 10 000647   002423 235000 0                  LDA     J
        10 000650   000662 604400 10                 TMOZ    s:18317

      593    18313    5                       OPTS.OUT.L=ASCBIN('/')+J;

  18313 10 000651   002423 236000 0                  LDQ     J
        10 000652   000057 036007                    ADLQ    47,DL
        10 000653   000033 736000                    QLS     27
        10 000654   000075 552040 0                  STBQ    VW_OPTIONS#+60,'40'O

      594    18314    5                       OPTS.OUT.FID=SUBSTR(OPTS.OUT.FID,0,J);

  18314 10 000655   000000 621005                    EAX1    0,AL
        10 000656   040000 100440                    MLR     fill='040'O
        10 000657   000075 200011 0                  ADSC9   VW_OPTIONS#+60           cn=1,n=*X1
        10 000660   000075 200117 0                  ADSC9   VW_OPTIONS#+60           cn=1,n=79

      595    18315    5                       END;

  18315 10 000661   000667 710000 10                 TRA     s:18320

      596    18316    5                    ELSE DO;

      597    18317    5                       CALL XUR$ERRMSG(%E$VWM_OTL);

  18317 10 000662   000035 630400 11                 EPPR0   29
        10 000663   000000 631400 11                 EPPR1   0
        10 000664   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000665   000000 011000                    NOP     0

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:93   
      598    18318    5                       GOTO DECIDE;

  18318 10 000666   002626 710000 10                 TRA     DECIDE

      599    18319    5                       END;
      600    18320    4                    P->OUT$BLK.CODE=%WSN#;

  18320 10 000667   000003 221003                    LDX1    3,DU
        10 000670   100000 441100                    SXL1    0,,PR1

      601    18321    4                    P->OUT$SYM.COUNT=P->OUT$SYM.COUNT-J-1;

  18321 10 000671   002436 470400 0                  LDP0    P
        10 000672   000004 236100                    LDQ     4,,PR0
        10 000673   000033 772000                    QRL     27
        10 000674   002423 136000 0                  SBLQ    J
        10 000675   000001 136007                    SBLQ    1,DL
        10 000676   000033 736000                    QLS     27
        10 000677   000004 552140                    STBQ    4,'40'O,PR0

      602    18322    4                   CALL XLATE (P->OUT$SYM.TEXT, B$XL_UPPER, SUBSTR(P->OUT$SYM.TEXT,J+1
             18322                             ,P->OUT$SYM.COUNT));

  18322 10 000700   002436 470400 0                  LDP0    P
        10 000701   000004 236100                    LDQ     4,,PR0
        10 000702   000033 772000                    QRL     27
        10 000703   000000 620006                    EAX0    0,QL
        10 000704   000000 622006                    EAX2    0,QL
        10 000705   002423 235000 0                  LDA     J
        10 000706   000000 471400 xsym               LDP1    B$XL_UPPER$
        10 000707   040140 160545                    MVT     fill='040'O
        10 000710   000004 400012                    ADSC9   4,A,PR0                  cn=2,n=*X2
        10 000711   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
        10 000712   100000 000100                    ARG     0,,PR1

      603    18323    4                    END;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:94   
  18323 10 000713   000715 710000 10                 TRA     s:18327

      604    18324    4                 WHENALTRETURN DO;

      605    18325    4                    I=I+1;

  18325 10 000714   002422 054000 0                  AOS     I

      606    18326    4                    END;

      607    18327    3                 END;

  18327 10 000715   000717 710000 10                 TRA     s:18338

      608    18328    2              ELSE
      609    18329    2                 I=I+1;

  18329 10 000716   002422 054000 0                  AOS     I

      610    18330    2              END;

      611    18331
      612    18332        /****
      613    18333        *
      614    18334        *   Look for a destination node.
      615    18335        *
      616    18336        ****/
      617    18337
      618    18338    1           IF I>=OUT$BLK.NSUBLKS THEN

  18338 10 000717   002437 470400 0                  LDP0    BLK$
        10 000720   000001 236100                    LDQ     1,,PR0
        10 000721   000022 772000                    QRL     18
        10 000722   002422 116000 0                  CMPQ    I
        10 000723   001012 604400 10                 TMOZ    DONE_PARSING

      619    18339    1              GOTO DONE_PARSING;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:95   
      620    18340    1           P=OUT$BLK.SUBLK$(I);

  18340 10 000724   002422 720000 0                  LXL0    I
        10 000725   000003 236110                    LDQ     3,X0,PR0
        10 000726   002436 756000 0                  STQ     P

      621    18341    2           IF P->OUT$BLK.CODE=%WSN# THEN DO;

  18341 10 000727   002436 471400 0                  LDP1    P
        10 000730   100000 721100                    LXL1    0,,PR1
        10 000731   000003 101003                    CMPX1   3,DU
        10 000732   000756 601000 10                 TNZ     s:18356

      622    18342    3              IF P->OUT$SYM.COUNT<1 OR P->OUT$SYM.COUNT>8 THEN DO;

  18342 10 000733   100004 236100                    LDQ     4,,PR1
        10 000734   777000 316003                    CANQ    -512,DU
        10 000735   000742 600000 10                 TZE     s:18343
        10 000736   100004 236100                    LDQ     4,,PR1
        10 000737   777000 376003                    ANQ     -512,DU
        10 000740   011000 116003                    CMPQ    4608,DU
        10 000741   000747 602000 10                 TNC     s:18346

      623    18343    3                 CALL XUR$ERRMSG(%E$VWM_DST);

  18343 10 000742   000037 630400 11                 EPPR0   31
        10 000743   000000 631400 11                 EPPR1   0
        10 000744   000000 701000 xent               TSX1    XUR$ERRMSG
        10 000745   000000 011000                    NOP     0

      624    18344    3                 GOTO DECIDE;

  18344 10 000746   002626 710000 10                 TRA     DECIDE

      625    18345    3                 END;
      626    18346    2              OPTS.OUT.NODE=SUBSTR(P->OUT$SYM.TEXT,0,P->OUT$SYM.COUNT);

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:96   
  18346 10 000747   100004 236100                    LDQ     4,,PR1
        10 000750   000033 772000                    QRL     27
        10 000751   000000 622006                    EAX2    0,QL
        10 000752   040000 100540                    MLR     fill='040'O
        10 000753   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
        10 000754   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8

      627    18347    2              I=I+1;

  18347 10 000755   002422 054000 0                  AOS     I

      628    18348    2              END;

      629    18349
      630    18350        /****
      631    18351        *
      632    18352        *   Look for destination options.
      633    18353        *
      634    18354        ****/
      635    18355
      636    18356    1           IF I>=OUT$BLK.NSUBLKS THEN

  18356 10 000756   000001 236100                    LDQ     1,,PR0
        10 000757   000022 772000                    QRL     18
        10 000760   002422 116000 0                  CMPQ    I
        10 000761   001012 604400 10                 TMOZ    DONE_PARSING

      637    18357    1              GOTO DONE_PARSING;
      638    18358    1           P=OUT$BLK.SUBLK$(I);

  18358 10 000762   002422 720000 0                  LXL0    I
        10 000763   000003 236110                    LDQ     3,X0,PR0
        10 000764   002436 756000 0                  STQ     P

      639    18359    2           IF P->OUT$BLK.CODE=%OPTLST# THEN DO;

  18359 10 000765   002436 471400 0                  LDP1    P
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:97   
        10 000766   100000 721100                    LXL1    0,,PR1
        10 000767   000004 101003                    CMPX1   4,DU
        10 000770   001000 601000 10                 TNZ     s:18370

      640    18360    2              CALL OPTIONS(P,OPTS.OUT) ALTRET(DECIDE);

  18360 10 000771   000040 236000 11                 LDQ     32
        10 000772   004704 756000 0                  STQ     @BLK$+1
        10 000773   000033 236000 11                 LDQ     27
        10 000774   004703 756000 0                  STQ     ONCE+2
        10 000775   002634 701000 10                 TSX1    OPTIONS
        10 000776   002626 702000 10                 TSX2    DECIDE

      641    18361    2              I=I+1;

  18361 10 000777   002422 054000 0                  AOS     I

      642    18362    2              END;

      643    18363
      644    18364        /****
      645    18365        *
      646    18366        *   Oops, we should never get here without I>=OUT$BLK.NSUBLKS.
      647    18367        *
      648    18368        ****/
      649    18369
      650    18370    2           IF I<OUT$BLK.NSUBLKS THEN DO;

  18370 10 001000   002437 470400 0                  LDP0    BLK$
        10 001001   000001 236100                    LDQ     1,,PR0
        10 001002   000022 772000                    QRL     18
        10 001003   002422 116000 0                  CMPQ    I
        10 001004   001012 604400 10                 TMOZ    DONE_PARSING

      651    18371    2              CALL XUR$ERRMSG(%E$VWM_SYN);

  18371 10 001005   000042 630400 11                 EPPR0   34
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:98   
        10 001006   000000 631400 11                 EPPR1   0
        10 001007   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001010   000000 011000                    NOP     0

      652    18372    2              GOTO DECIDE;

  18372 10 001011   002626 710000 10                 TRA     DECIDE

      653    18373    2              END;
      654    18374
      655    18375        /****
      656    18376        *
      657    18377        *   Everything has been parsed into OPTS.  Now fix things up and
      658    18378        *   check for insanities.
      659    18379        *
      660    18380        ****/
      661    18381
      662    18382    1   DONE_PARSING:
      663    18383
      664    18384        /****
      665    18385        *
      666    18386        *   Fix up the input node specification and check that it exists.
      667    18387        *   If the node name is LOCAL or the *IAM node, blank it (it's us).
      668    18388        *   Strange things will happen if some yo-yo specifies a local
      669    18389        *   synonym for the input node.
      670    18390        *
      671    18391        ****/
      672    18392
      673    18393    1           IF OPTS.INP.NODE=' ' OR OPTS.INP.NODE='LOCAL' OR OPTS.INP.NODE=VW_IAM# THEN

  18393 10 001012   040000 106400       DONE_PARSING CMPC    fill='040'O
        10 001013   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001014   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001015   001026 600000 10                 TZE     s:18394
        10 001016   040000 106400                    CMPC    fill='040'O
        10 001017   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001020   000177 000005 3                  ADSC9   BADDIES+38               cn=0,n=5
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:99   
        10 001021   001026 600000 10                 TZE     s:18394
        10 001022   040000 106400                    CMPC    fill='040'O
        10 001023   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001024   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 001025   001033 601000 10                 TNZ     s:18396

      674    18394    1              OPTS.INP.NODE=' ';

  18394 10 001026   000021 235000 11                 LDA     17
        10 001027   000021 236000 11                 LDQ     17
        10 001030   000023 755000 0                  STA     VW_OPTIONS#+18
        10 001031   000024 756000 0                  STQ     VW_OPTIONS#+19
        10 001032   001130 710000 10                 TRA     s:18426

      675    18395    2           ELSE DO;

      676    18396    2              NODEKEY.C=OPTS.INP.NODE;

  18396 10 001033   040000 100400                    MLR     fill='040'O
        10 001034   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001035   001136 200010 0                  ADSC9   NODEKEY                  cn=1,n=8

      677    18397    3              CALL M$READ(READ_NODE) WHENALTRETURN DO;

  18397 10 001036   001062 630400 0                  EPPR0   READ_NODE
        10 001037   440000 713400                    CLIMB   alt,read
        10 001040   401400 401760                    pmme    nvectors=4
        10 001041   001043 702000 10                 TSX2    s:18398
        10 001042   001050 710000 10                 TRA     s:18401

      678    18398    3                 CALL XUR$ERRMSG(%E$VWM_SND);

  18398 10 001043   000044 630400 11                 EPPR0   36
        10 001044   000000 631400 11                 EPPR1   0
        10 001045   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001046   000000 011000                    NOP     0

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:100  
      679    18399    3                 GOTO DECIDE;

  18399 10 001047   002626 710000 10                 TRA     DECIDE

      680    18400    3                 END;
      681    18401    3              IF DCBADDR(DCBNUM(M$NODE))->DUMMY.ARS#=8 THEN DO;

  18401 10 001050   000000 236007 xsym               LDQ     M$NODE,DL
        10 001051   000045 470400 11                 LDP0    37
        10 001052   000000 471500                    LDP1    0,,PR0
        10 001053   100000 473506                    LDP3    0,QL,PR1
        10 001054   300000 235100                    LDA     0,,PR3
        10 001055   000010 115007                    CMPA    8,DL
        10 001056   001117 601000 10                 TNZ     s:18412

      682    18402    3                 OPTS.INP.NODE=NODEOVR.PATH_NAME;

  18402 10 001057   040000 100400                    MLR     fill='040'O
        10 001060   001141 000010 0                  ADSC9   NODEOVR                  cn=0,n=8
        10 001061   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8

      683    18403    3                 NODEKEY.C=NODEOVR.PATH_NAME;

  18403 10 001062   040000 100400                    MLR     fill='040'O
        10 001063   001141 000010 0                  ADSC9   NODEOVR                  cn=0,n=8
        10 001064   001136 200010 0                  ADSC9   NODEKEY                  cn=1,n=8

      684    18404    4                 CALL M$READ(READ_NODE) WHENALTRETURN DO;

  18404 10 001065   001062 630400 0                  EPPR0   READ_NODE
        10 001066   440000 713400                    CLIMB   alt,read
        10 001067   401400 401760                    pmme    nvectors=4
        10 001070   001072 702000 10                 TSX2    s:18405
        10 001071   001077 710000 10                 TRA     s:18408

      685    18405    4                    CALL XUR$ERRMSG(%E$VWM_SND);

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:101  
  18405 10 001072   000044 630400 11                 EPPR0   36
        10 001073   000000 631400 11                 EPPR1   0
        10 001074   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001075   000000 011000                    NOP     0

      686    18406    4                    GOTO DECIDE;

  18406 10 001076   002626 710000 10                 TRA     DECIDE

      687    18407    4                    END;
      688    18408    3                 IF OPTS.INP.NODE=' ' OR OPTS.INP.NODE='LOCAL' OR

  18408 10 001077   040000 106400                    CMPC    fill='040'O
        10 001100   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001101   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001102   001113 600000 10                 TZE     s:18410
        10 001103   040000 106400                    CMPC    fill='040'O
        10 001104   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001105   000177 000005 3                  ADSC9   BADDIES+38               cn=0,n=5
        10 001106   001113 600000 10                 TZE     s:18410
        10 001107   040000 106400                    CMPC    fill='040'O
        10 001110   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001111   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 001112   001117 601000 10                 TNZ     s:18412

      689    18409    3                   OPTS.INP.NODE=VW_IAM# THEN
      690    18410    3                    OPTS.INP.NODE=' ';

  18410 10 001113   000021 235000 11                 LDA     17
        10 001114   000021 236000 11                 LDQ     17
        10 001115   000023 755000 0                  STA     VW_OPTIONS#+18
        10 001116   000024 756000 0                  STQ     VW_OPTIONS#+19

      691    18411    3                 END;

      692    18412    2              IF NODEOVR.TYPE_DEST = %N_EXTERNAL#

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:102  
  18412 10 001117   001145 236000 0                  LDQ     NODEOVR+4
        10 001120   777000 376003                    ANQ     -512,DU
        10 001121   157000 116003                    CMPQ    56832,DU
        10 001122   001130 601000 10                 TNZ     s:18426

      693    18413    3              THEN DO;

      694    18414    3                 CALL XUR$ERRMSG (%E$VWM_EXTERNAL);

  18414 10 001123   000047 630400 11                 EPPR0   39
        10 001124   000000 631400 11                 EPPR1   0
        10 001125   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001126   000000 011000                    NOP     0

      695    18415    3                 GOTO DECIDE;

  18415 10 001127   002626 710000 10                 TRA     DECIDE

      696    18416    3                 END;
      697    18417    2              END;
      698    18418
      699    18419        /****
      700    18420        *
      701    18421        *   Fix up the output node specification and check that it exists.
      702    18422        *   Zap the node name if it's us (like above).
      703    18423        *
      704    18424        ****/
      705    18425
      706    18426    1           IF OPTS.OUT.NODE=' ' OR OPTS.OUT.NODE='LOCAL' OR OPTS.OUT.NODE=VW_IAM# THEN

  18426 10 001130   040000 106400                    CMPC    fill='040'O
        10 001131   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001132   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001133   001144 600000 10                 TZE     s:18427
        10 001134   040000 106400                    CMPC    fill='040'O
        10 001135   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001136   000177 000005 3                  ADSC9   BADDIES+38               cn=0,n=5
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:103  
        10 001137   001144 600000 10                 TZE     s:18427
        10 001140   040000 106400                    CMPC    fill='040'O
        10 001141   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001142   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 001143   001151 601000 10                 TNZ     s:18429

      707    18427    1              OPTS.OUT.NODE=' ';

  18427 10 001144   000021 235000 11                 LDA     17
        10 001145   000021 236000 11                 LDQ     17
        10 001146   000073 755000 0                  STA     VW_OPTIONS#+58
        10 001147   000074 756000 0                  STQ     VW_OPTIONS#+59
        10 001150   001247 710000 10                 TRA     s:18457

      708    18428    2           ELSE DO;

      709    18429    2              NODEKEY.C=OPTS.OUT.NODE;

  18429 10 001151   040000 100400                    MLR     fill='040'O
        10 001152   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001153   001136 200010 0                  ADSC9   NODEKEY                  cn=1,n=8

      710    18430    3              CALL M$READ(READ_NODE) WHENALTRETURN DO;

  18430 10 001154   001062 630400 0                  EPPR0   READ_NODE
        10 001155   440000 713400                    CLIMB   alt,read
        10 001156   401400 401760                    pmme    nvectors=4
        10 001157   001161 702000 10                 TSX2    s:18431
        10 001160   001166 710000 10                 TRA     s:18434

      711    18431    3                 CALL XUR$ERRMSG(%E$VWM_DND);

  18431 10 001161   000051 630400 11                 EPPR0   41
        10 001162   000000 631400 11                 EPPR1   0
        10 001163   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001164   000000 011000                    NOP     0

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:104  
      712    18432    3                 GOTO DECIDE;

  18432 10 001165   002626 710000 10                 TRA     DECIDE

      713    18433    3                 END;
      714    18434    3              IF DCBADDR(DCBNUM(M$NODE))->DUMMY.ARS#=8 THEN DO;

  18434 10 001166   000000 236007 xsym               LDQ     M$NODE,DL
        10 001167   000045 470400 11                 LDP0    37
        10 001170   000000 471500                    LDP1    0,,PR0
        10 001171   100000 473506                    LDP3    0,QL,PR1
        10 001172   300000 235100                    LDA     0,,PR3
        10 001173   000010 115007                    CMPA    8,DL
        10 001174   001247 601000 10                 TNZ     s:18457

      715    18435    3                 DWORK=OPTS.OUT.NODE;

  18435 10 001175   040000 100400                    MLR     fill='040'O
        10 001176   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001177   004642 000010 0                  ADSC9   DWORK                    cn=0,n=8

      716    18436    3                 OPTS.OUT.NODE=NODEOVR.PATH_NAME;

  18436 10 001200   040000 100400                    MLR     fill='040'O
        10 001201   001141 000010 0                  ADSC9   NODEOVR                  cn=0,n=8
        10 001202   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8

      717    18437    3                 NODEKEY.C=NODEOVR.PATH_NAME;

  18437 10 001203   040000 100400                    MLR     fill='040'O
        10 001204   001141 000010 0                  ADSC9   NODEOVR                  cn=0,n=8
        10 001205   001136 200010 0                  ADSC9   NODEKEY                  cn=1,n=8

      718    18438    4                 CALL M$READ(READ_NODE) WHENALTRETURN DO;

  18438 10 001206   001062 630400 0                  EPPR0   READ_NODE
        10 001207   440000 713400                    CLIMB   alt,read
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:105  
        10 001210   401400 401760                    pmme    nvectors=4
        10 001211   001213 702000 10                 TSX2    s:18439
        10 001212   001220 710000 10                 TRA     s:18442

      719    18439    4                    CALL XUR$ERRMSG(%E$VWM_DND);

  18439 10 001213   000051 630400 11                 EPPR0   41
        10 001214   000000 631400 11                 EPPR1   0
        10 001215   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001216   000000 011000                    NOP     0

      720    18440    4                    GOTO DECIDE;

  18440 10 001217   002626 710000 10                 TRA     DECIDE

      721    18441    4                    END;
      722    18442    3                 IF NODEOVR.TYPE_DEST = %N_EXTERNAL#

  18442 10 001220   001145 236000 0                  LDQ     NODEOVR+4
        10 001221   777000 376003                    ANQ     -512,DU
        10 001222   157000 116003                    CMPQ    56832,DU
        10 001223   001227 601000 10                 TNZ     s:18445

      723    18443    3                 THEN
      724    18444    3                    OPTS.OUT.NODE = DWORK;

  18444 10 001224   004642 237000 0                  LDAQ    DWORK
        10 001225   000073 755000 0                  STA     VW_OPTIONS#+58
        10 001226   000074 756000 0                  STQ     VW_OPTIONS#+59

      725    18445    3                 IF OPTS.OUT.NODE=' ' OR OPTS.OUT.NODE='LOCAL' OR

  18445 10 001227   040000 106400                    CMPC    fill='040'O
        10 001230   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001231   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001232   001243 600000 10                 TZE     s:18447
        10 001233   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:106  
        10 001234   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001235   000177 000005 3                  ADSC9   BADDIES+38               cn=0,n=5
        10 001236   001243 600000 10                 TZE     s:18447
        10 001237   040000 106400                    CMPC    fill='040'O
        10 001240   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001241   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 001242   001247 601000 10                 TNZ     s:18457

      726    18446    3                   OPTS.OUT.NODE=VW_IAM# THEN
      727    18447    3                    OPTS.OUT.NODE=' ';

  18447 10 001243   000021 235000 11                 LDA     17
        10 001244   000021 236000 11                 LDQ     17
        10 001245   000073 755000 0                  STA     VW_OPTIONS#+58
        10 001246   000074 756000 0                  STQ     VW_OPTIONS#+59

      728    18448    3                 END;

      729    18449    2              END;

      730    18450
      731    18451        /****
      732    18452        *
      733    18453        *   See if there's an input FID.  If not, say hi and prompt for a command.
      734    18454        *
      735    18455        ****/
      736    18456
      737    18457    2           IF CARD(1)=' ' THEN DO;

  18457 10 001247   040000 106400                    CMPC    fill='040'O
        10 001250   000025 000120 0                  ADSC9   VW_OPTIONS#+20           cn=0,n=80
        10 001251   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001252   001316 601000 10                 TNZ     s:18475

      738    18458    3              IF ONCE THEN DO;

  18458 10 001253   004701 234000 0                  SZN     ONCE
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:107  
        10 001254   001311 605000 10                 TPL     s:18464

      739    18459    3                 ONCE='0'B;

  18459 10 001255   004701 450000 0                  STZ     ONCE

      740    18460    3                 CALL XUR$ERRMSG(%E$VWM_HI,,,VECTOR(B_VERSION));

  18460 10 001256   000000 236000 xsym               LDQ     B_VERSION
        10 001257   000033 772000                    QRL     27
        10 001260   000001 620006                    EAX0    1,QL
        10 001261   000000 635010                    EAA     0,X0
        10 001262   000002 771000                    ARL     2
        10 001263   000140 135007                    SBLA    96,DL
        10 001264   000052 236000 11                 LDQ     42
        10 001265   004730 757000 0                  STAQ    PASSWORD+2
        10 001266   004730 630400 0                  EPPR0   PASSWORD+2
        10 001267   004735 450400 0                  STP0    PASSWORD+7
        10 001270   000007 236000 11                 LDQ     7
        10 001271   004734 756000 0                  STQ     PASSWORD+6
        10 001272   000055 235000 11                 LDA     45
        10 001273   004732 757000 0                  STAQ    PASSWORD+4
        10 001274   004732 630400 0                  EPPR0   PASSWORD+4
        10 001275   000053 631400 11                 EPPR1   43
        10 001276   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001277   000000 011000                    NOP     0

      741    18461    3                 CALL XUR$SETDCBS(DCBNUM(M$ME));

  18461 10 001300   000000 236007 xsym               LDQ     M$ME,DL
        10 001301   004730 756000 0                  STQ     PASSWORD+2
        10 001302   004730 630400 0                  EPPR0   PASSWORD+2
        10 001303   004731 450400 0                  STP0    PASSWORD+3
        10 001304   004731 630400 0                  EPPR0   PASSWORD+3
        10 001305   000000 631400 11                 EPPR1   0
        10 001306   000000 701000 xent               TSX1    XUR$SETDCBS
        10 001307   000000 011000                    NOP     0
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:108  

      742    18462    3                 END;

  18462 10 001310   001315 710000 10                 TRA     s:18465

      743    18463    2              ELSE
      744    18464    2                 CALL XUR$ERRMSG(%E$VWM_NTD);

  18464 10 001311   000057 630400 11                 EPPR0   47
        10 001312   000000 631400 11                 EPPR1   0
        10 001313   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001314   000000 011000                    NOP     0

      745    18465    2              GOTO GET_COMMAND;

  18465 10 001315   000125 710000 10                 TRA     GET_COMMAND

      746    18466    2              END;
      747    18467
      748    18468        /****
      749    18469        *
      750    18470        *   Check for trying to send a file to the same node as it is on, i.e.,
      751    18471        *   @X -> @X.
      752    18472        *
      753    18473        ****/
      754    18474
      755    18475    2           IF OPTS.INP.NODE=OPTS.OUT.NODE THEN DO;

  18475 10 001316   040000 106400                    CMPC    fill='040'O
        10 001317   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001320   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001321   001327 601000 10                 TNZ     s:18487

      756    18476    2              CALL XUR$ERRMSG(%E$VWM_PCL);

  18476 10 001322   000061 630400 11                 EPPR0   49
        10 001323   000000 631400 11                 EPPR1   0
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:109  
        10 001324   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001325   000000 011000                    NOP     0

      757    18477    2              GOTO DECIDE;

  18477 10 001326   002626 710000 10                 TRA     DECIDE

      758    18478    2              END;
      759    18479
      760    18480        /****
      761    18481        *
      762    18482        *   If this isn't a "foreign" file name, check to make sure that
      763    18483        *   it's a valid file name and device type for us to MOVE.
      764    18484        *
      765    18485        ****/
      766    18486
      767    18487    2           IF OPTS.INP.NODE=' ' OR SUBSTR(OPTS.INP.FID,0,1)~='''' THEN DO;

  18487 10 001327   040000 106400                    CMPC    fill='040'O
        10 001330   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001331   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001332   001337 600000 10                 TZE     s:18489
        10 001333   000025 236000 0                  LDQ     VW_OPTIONS#+20
        10 001334   000777 376003                    ANQ     511,DU
        10 001335   000047 116003                    CMPQ    39,DU
        10 001336   001503 600000 10                 TZE     s:18546

      768    18488
      769    18489    2              FID_INP.TEXTFID_=VECTOR(OPTS.INP.FID);

  18489 10 001337   000062 237000 11                 LDAQ    50
        10 001340   001456 757000 0                  STAQ    FID_INP+2

      770    18490    3              CALL M$FID(FID_INP) WHENALTRETURN DO;

  18490 10 001341   001454 630400 0                  EPPR0   FID_INP
        10 001342   420001 713400                    CLIMB   alt,+8193
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:110  
        10 001343   404400 401760                    pmme    nvectors=10
        10 001344   001346 702000 10                 TSX2    s:18491
        10 001345   001353 710000 10                 TRA     s:18495

      771    18491    3                 CALL XUR$ERRMSG(%E$VWM_INP);

  18491 10 001346   000065 630400 11                 EPPR0   53
        10 001347   000000 631400 11                 EPPR1   0
        10 001350   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001351   000000 011000                    NOP     0

      772    18492    3                 GOTO DECIDE;

  18492 10 001352   002626 710000 10                 TRA     DECIDE

      773    18493    3                 END;
      774    18494
      775    18495    3              IF ASN_INP~=%DEVICE# AND ASN_INP~=%FILE# AND ASN_INP~=%TAPE# THEN DO;

  18495 10 001353   002432 236000 0                  LDQ     ASN_INP
        10 001354   777000 376003                    ANQ     -512,DU
        10 001355   003000 116003                    CMPQ    1536,DU
        10 001356   001370 600000 10                 TZE     s:18500
        10 001357   001000 116003                    CMPQ    512,DU
        10 001360   001370 600000 10                 TZE     s:18500
        10 001361   002000 116003                    CMPQ    1024,DU
        10 001362   001370 600000 10                 TZE     s:18500

      776    18496    3                 CALL XUR$ERRMSG(%E$VWM_INP);

  18496 10 001363   000065 630400 11                 EPPR0   53
        10 001364   000000 631400 11                 EPPR1   0
        10 001365   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001366   000000 011000                    NOP     0

      777    18497    3                 GOTO DECIDE;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:111  
  18497 10 001367   002626 710000 10                 TRA     DECIDE

      778    18498    3                 END;
      779    18499
      780    18500    2              IF ASN_INP=%DEVICE# AND

  18500 10 001370   003000 116003                    CMPQ    1536,DU
        10 001371   001412 601000 10                 TNZ     s:18510
        10 001372   002434 220000 0                  LDX0    RES_INP
        10 001373   000201 100000 3                  CMPX0   BADDIES+40
        10 001374   001412 600000 10                 TZE     s:18510
        10 001375   000202 100000 3                  CMPX0   BADDIES+41
        10 001376   001412 600000 10                 TZE     s:18510
        10 001377   000203 100000 3                  CMPX0   BADDIES+42
        10 001400   001412 600000 10                 TZE     s:18510
        10 001401   000204 100000 3                  CMPX0   BADDIES+43
        10 001402   001412 600000 10                 TZE     s:18510
        10 001403   000205 100000 3                  CMPX0   BADDIES+44
        10 001404   001412 600000 10                 TZE     s:18510

      781    18501    2                SUBSTR(RES_INP,0,2)~='CR' AND
      782    18502    2                SUBSTR(RES_INP,0,2)~='ME' AND
      783    18503    2                SUBSTR(RES_INP,0,2)~='LT' AND
      784    18504    2                SUBSTR(RES_INP,0,2)~='MT' AND
      785    18505    3                SUBSTR(RES_INP,0,2)~='FT' THEN DO;

      786    18506    3                 CALL XUR$ERRMSG(%E$VWM_INP);

  18506 10 001405   000065 630400 11                 EPPR0   53
        10 001406   000000 631400 11                 EPPR1   0
        10 001407   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001410   000000 011000                    NOP     0

      787    18507    3                 GOTO DECIDE;

  18507 10 001411   002626 710000 10                 TRA     DECIDE

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:112  
      788    18508    3                 END;
      789    18509
      790    18510    2              IF (ASN_INP=%FILE# OR SUBSTR(RES_INP,0,2)='LT') AND NOT INP_VLR.NAME

  18510 10 001412   001000 116003                    CMPQ    512,DU
        10 001413   001417 600000 10                 TZE     s:18510+5
        10 001414   002434 220000 0                  LDX0    RES_INP
        10 001415   000203 100000 3                  CMPX0   BADDIES+42
        10 001416   001430 601000 10                 TNZ     s:18523
        10 001417   001532 234000 0                  SZN     INP_VLR
        10 001420   001430 604000 10                 TMI     s:18523

      791    18511    3              THEN DO;

      792    18512    3                 INP_VLR.NAME='1'B;

  18512 10 001421   400000 236003                    LDQ     -131072,DU
        10 001422   001532 256000 0                  ORSQ    INP_VLR

      793    18513    3                 NAME_INP.NAME#='?';

  18513 10 001423   040000 100400                    MLR     fill='040'O
        10 001424   000066 000001 11                 ADSC9   54                       cn=0,n=1
        10 001425   001506 200037 0                  ADSC9   NAME_INP                 cn=1,n=31

      794    18514    3                 NAME_INP.L#=1;

  18514 10 001426   001000 236003                    LDQ     512,DU
        10 001427   001506 552040 0                  STBQ    NAME_INP,'40'O

      795    18515    3                 END;

      796    18516
      797    18517        /****
      798    18518        *
      799    18519        *   Force M$UNFID to materialize an account.
      800    18520        *
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:113  
      801    18521        ****/
      802    18522
      803    18523    2              IF OPTS.INP.NODE=' ' AND

  18523 10 001430   040000 106400                    CMPC    fill='040'O
        10 001431   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001432   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001433   001465 601000 10                 TNZ     s:18531
        10 001434   002432 236000 0                  LDQ     ASN_INP
        10 001435   777000 376003                    ANQ     -512,DU
        10 001436   001000 116003                    CMPQ    512,DU
        10 001437   001443 601000 10                 TNZ     s:18523+11
        10 001440   001532 236000 0                  LDQ     INP_VLR
        10 001441   200000 316003                    CANQ    65536,DU
        10 001442   001451 600000 10                 TZE     s:18526
        10 001443   001532 236000 0                  LDQ     INP_VLR
        10 001444   200000 316003                    CANQ    65536,DU
        10 001445   001465 600000 10                 TZE     s:18531
        10 001446   001504 237000 0                  LDAQ    ACCT_INP
        10 001447   000070 117000 11                 CMPAQ   56
        10 001450   001465 601000 10                 TNZ     s:18531

      804    18524    2                ((ASN_INP=%FILE# AND NOT INP_VLR.ACCT) OR
      805    18525    3                (INP_VLR.ACCT AND ACCT_INP.ACCT#=' ')) THEN DO;

      806    18526    3                 INP_VLR.ACCT='1'B;

  18526 10 001451   200000 236003                    LDQ     65536,DU
        10 001452   001532 256000 0                  ORSQ    INP_VLR

      807    18527    3                 ACCT_INP.ACCT#=B$JIT.FACCN;

  18527 10 001453   000000 470400 xsym               LDP0    B$JIT$
        10 001454   000006 237100                    LDAQ    6,,PR0
        10 001455   001504 757000 0                  STAQ    ACCT_INP

      808    18528    3                 IF SN_INP.SN#(0)=' ' THEN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:114  

  18528 10 001456   040000 106400                    CMPC    fill='040'O
        10 001457   001521 000006 0                  ADSC9   SN_INP+1                 cn=0,n=6
        10 001460   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001461   001465 601000 10                 TNZ     s:18531

      809    18529    3                    SN_INP.SN#(0)=B$JIT.FPSN;

  18529 10 001462   040000 100500                    MLR     fill='040'O
        10 001463   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
        10 001464   001521 000006 0                  ADSC9   SN_INP+1                 cn=0,n=6

      810    18530    3                 END;

      811    18531    3              CALL M$UNFID(UNFID_INP) WHENALTRETURN DO;

  18531 10 001465   001646 630400 0                  EPPR0   UNFID_INP
        10 001466   420021 713400                    CLIMB   alt,+8209
        10 001467   404400 401760                    pmme    nvectors=10
        10 001470   001472 702000 10                 TSX2    s:18532
        10 001471   001477 710000 10                 TRA     s:18535

      812    18532    3                 CALL XUR$ERRMSG(%E$VWM_ITL);

  18532 10 001472   000026 630400 11                 EPPR0   22
        10 001473   000000 631400 11                 EPPR1   0
        10 001474   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001475   000000 011000                    NOP     0

      813    18533    3                 GOTO DECIDE;

  18533 10 001476   002626 710000 10                 TRA     DECIDE

      814    18534    3                 END;
      815    18535    2              OPTS.INP.L=I+ASCBIN('/');

  18535 10 001477   002422 236000 0                  LDQ     I
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:115  
        10 001500   000057 036007                    ADLQ    47,DL
        10 001501   000033 736000                    QLS     27
        10 001502   000025 552040 0                  STBQ    VW_OPTIONS#+20,'40'O

      816    18536
      817    18537    2              END;

      818    18538
      819    18539        /****
      820    18540        *
      821    18541        *   If the input node is here and the input name and account matches
      822    18542        *   the JIT name and account, blank the input name and account.
      823    18543        *
      824    18544        ****/
      825    18545
      826    18546    1           IF OPTS.INP.NODE=' ' AND OPTS.INP.ACCT=B$JIT.ACCN AND

  18546 10 001503   040000 106400                    CMPC    fill='040'O
        10 001504   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001505   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001506   001531 601000 10                 TNZ     s:18560
        10 001507   000000 470400 xsym               LDP0    B$JIT$
        10 001510   040100 106400                    CMPC    fill='040'O
        10 001511   000002 000010 0                  ADSC9   VW_OPTIONS#+1            cn=0,n=8
        10 001512   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 001513   001531 601000 10                 TNZ     s:18560
        10 001514   040100 106400                    CMPC    fill='040'O
        10 001515   000004 000014 0                  ADSC9   VW_OPTIONS#+3            cn=0,n=12
        10 001516   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 001517   001531 601000 10                 TNZ     s:18560

      827    18547    2             OPTS.INP.NAME=B$JIT.UNAME THEN DO;

      828    18548    2              OPTS.INP.ACCT=' ';

  18548 10 001520   000021 235000 11                 LDA     17
        10 001521   000021 236000 11                 LDQ     17
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:116  
        10 001522   000002 757000 0                  STAQ    VW_OPTIONS#+1

      829    18549    2              OPTS.INP.NAME=' ';

  18549 10 001523   040000 100400                    MLR     fill='040'O
        10 001524   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001525   000004 000014 0                  ADSC9   VW_OPTIONS#+3            cn=0,n=12

      830    18550    2              OPTS.INP.EPASS=' ';

  18550 10 001526   040000 100400                    MLR     fill='040'O
        10 001527   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001530   000007 000014 0                  ADSC9   VW_OPTIONS#+6            cn=0,n=12

      831    18551    2              END;

      832    18552
      833    18553        /****
      834    18554        *
      835    18555        *   If the input node is here and the input account, name is blank,
      836    18556        *   check to see if the file exists if it isn't wildcarded.
      837    18557        *
      838    18558        ****/
      839    18559
      840    18560    2           IF OPTS.INP.NODE=' ' AND OPTS.INP.ACCT=' ' AND ASN_INP=%FILE# THEN DO;

  18560 10 001531   040000 106400                    CMPC    fill='040'O
        10 001532   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 001533   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001534   001577 601000 10                 TNZ     s:18576
        10 001535   000002 237000 0                  LDAQ    VW_OPTIONS#+1
        10 001536   000070 117000 11                 CMPAQ   56
        10 001537   001577 601000 10                 TNZ     s:18576
        10 001540   002432 236000 0                  LDQ     ASN_INP
        10 001541   777000 376003                    ANQ     -512,DU
        10 001542   001000 116003                    CMPQ    512,DU
        10 001543   001577 601000 10                 TNZ     s:18576
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:117  

      841    18561    3              CALL INDEX(I,'?',SUBSTR(NAME_INP.NAME#,0,NAME_INP.L#)) WHENALTRETURN DO;

  18561 10 001544   001506 236000 0                  LDQ     NAME_INP
        10 001545   000033 772000                    QRL     27
        10 001546   000000 620006                    EAX0    0,QL
        10 001547   000000 124440                    SCM     mask='000'O
        10 001550   001506 200010 0                  ADSC9   NAME_INP                 cn=1,n=*X0
        10 001551   000066 000001 11                 ADSC9   54                       cn=0,n=1
        10 001552   002422 000000 0                  ARG     I
        10 001553   001555 606400 10                 TTN     s:18562
        10 001554   001577 710000 10                 TRA     s:18576

      842    18562    4                 CALL M$OPEN(OPEN_ITST) WHENALTRETURN DO;

  18562 10 001555   001722 630400 0                  EPPR0   OPEN_ITST
        10 001556   450000 713400                    CLIMB   alt,open
        10 001557   410400 401760                    pmme    nvectors=18
        10 001560   001562 702000 10                 TSX2    s:18563
        10 001561   001577 710000 10                 TRA     s:18576

      843    18563    4                    CALL XUR$ERRMSG(B$TCB$->B$TCB.ALT$->B$ALT.ERR,DCBNUM(M$INP));

  18563 10 001562   000000 470400 xsym               LDP0    B$TCB$
        10 001563   000000 471500                    LDP1    0,,PR0
        10 001564   000000 236007 xsym               LDQ     M$INP,DL
        10 001565   004730 756000 0                  STQ     PASSWORD+2
        10 001566   004730 633400 0                  EPPR3   PASSWORD+2
        10 001567   004733 453400 0                  STP3    PASSWORD+5
        10 001570   100102 634500                    EPPR4   66,,PR1
        10 001571   004732 454400 0                  STP4    PASSWORD+4
        10 001572   004732 630400 0                  EPPR0   PASSWORD+4
        10 001573   000014 631400 11                 EPPR1   12
        10 001574   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001575   000000 011000                    NOP     0

      844    18564    4                    GOTO DECIDE;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:118  

  18564 10 001576   002626 710000 10                 TRA     DECIDE

      845    18565    4                    END;
      846    18566    3                 END;

      847    18567    2              END;

      848    18568
      849    18569        /****
      850    18570        *
      851    18571        *   Work with the output FID.  If it's not a "foreign" FID, make sure
      852    18572        *   it's legal in both syntax and device type.
      853    18573        *
      854    18574        ****/
      855    18575
      856    18576    2           IF OPTS.OUT.FID='.' OR OPTS.OUT.FID=' ' THEN DO;

  18576 10 001577   040000 106400                    CMPC    fill='040'O
        10 001600   000075 200117 0                  ADSC9   VW_OPTIONS#+60           cn=1,n=79
        10 001601   000067 000001 11                 ADSC9   55                       cn=0,n=1
        10 001602   001607 600000 10                 TZE     s:18577
        10 001603   040000 106400                    CMPC    fill='040'O
        10 001604   000075 200117 0                  ADSC9   VW_OPTIONS#+60           cn=1,n=79
        10 001605   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001606   001617 601000 10                 TNZ     s:18581

      857    18577    2              OPTS.OUT.FID=NAME_INP.NAME#;

  18577 10 001607   040000 100400                    MLR     fill='040'O
        10 001610   001506 200037 0                  ADSC9   NAME_INP                 cn=1,n=31
        10 001611   000075 200117 0                  ADSC9   VW_OPTIONS#+60           cn=1,n=79

      858    18578    2              OPTS.OUT.L=NAME_INP.L#+ASCBIN('/');

  18578 10 001612   001506 236000 0                  LDQ     NAME_INP
        10 001613   000033 772000                    QRL     27
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:119  
        10 001614   000057 036007                    ADLQ    47,DL
        10 001615   000033 736000                    QLS     27
        10 001616   000075 552040 0                  STBQ    VW_OPTIONS#+60,'40'O

      859    18579    2              END;

      860    18580
      861    18581    2           IF OPTS.OUT.NODE=' ' OR SUBSTR(OPTS.OUT.FID,0,1)~='''' THEN DO;

  18581 10 001617   040000 106400                    CMPC    fill='040'O
        10 001620   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001621   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001622   001627 600000 10                 TZE     s:18583
        10 001623   000075 236000 0                  LDQ     VW_OPTIONS#+60
        10 001624   000777 376003                    ANQ     511,DU
        10 001625   000047 116003                    CMPQ    39,DU
        10 001626   002012 600000 10                 TZE     s:18658

      862    18582
      863    18583    2              FID_OUT.TEXTFID_=VECTOR(OPTS.OUT.FID);

  18583 10 001627   000072 237000 11                 LDAQ    58
        10 001630   001546 757000 0                  STAQ    FID_OUT+2

      864    18584    3              CALL M$FID(FID_OUT) WHENALTRETURN DO;

  18584 10 001631   001544 630400 0                  EPPR0   FID_OUT
        10 001632   420001 713400                    CLIMB   alt,+8193
        10 001633   404400 401760                    pmme    nvectors=10
        10 001634   001636 702000 10                 TSX2    s:18585
        10 001635   001643 710000 10                 TRA     s:18589

      865    18585    3                 CALL XUR$ERRMSG(%E$VWM_OUT);

  18585 10 001636   000075 630400 11                 EPPR0   61
        10 001637   000000 631400 11                 EPPR1   0
        10 001640   000000 701000 xent               TSX1    XUR$ERRMSG
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:120  
        10 001641   000000 011000                    NOP     0

      866    18586    3                 GOTO DECIDE;

  18586 10 001642   002626 710000 10                 TRA     DECIDE

      867    18587    3                 END;
      868    18588
      869    18589    3              IF ASN_OUT~=%DEVICE# AND ASN_OUT~=%FILE# AND ASN_OUT~=%TAPE# THEN DO;

  18589 10 001643   002433 236000 0                  LDQ     ASN_OUT
        10 001644   777000 376003                    ANQ     -512,DU
        10 001645   003000 116003                    CMPQ    1536,DU
        10 001646   001660 600000 10                 TZE     s:18594
        10 001647   001000 116003                    CMPQ    512,DU
        10 001650   001660 600000 10                 TZE     s:18594
        10 001651   002000 116003                    CMPQ    1024,DU
        10 001652   001660 600000 10                 TZE     s:18594

      870    18590    3                 CALL XUR$ERRMSG(%E$VWM_OUT);

  18590 10 001653   000075 630400 11                 EPPR0   61
        10 001654   000000 631400 11                 EPPR1   0
        10 001655   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001656   000000 011000                    NOP     0

      871    18591    3                 GOTO DECIDE;

  18591 10 001657   002626 710000 10                 TRA     DECIDE

      872    18592    3                 END;
      873    18593
      874    18594    2              IF ASN_OUT=%DEVICE# AND

  18594 10 001660   003000 116003                    CMPQ    1536,DU
        10 001661   001706 601000 10                 TNZ     s:18613
        10 001662   002435 220000 0                  LDX0    RES_OUT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:121  
        10 001663   000206 100000 3                  CMPX0   BADDIES+45
        10 001664   001706 600000 10                 TZE     s:18613
        10 001665   000202 100000 3                  CMPX0   BADDIES+41
        10 001666   001706 600000 10                 TZE     s:18613
        10 001667   000207 100000 3                  CMPX0   BADDIES+46
        10 001670   001706 600000 10                 TZE     s:18613
        10 001671   000210 100000 3                  CMPX0   BADDIES+47
        10 001672   001706 600000 10                 TZE     s:18613
        10 001673   000203 100000 3                  CMPX0   BADDIES+42
        10 001674   001706 600000 10                 TZE     s:18613
        10 001675   000204 100000 3                  CMPX0   BADDIES+43
        10 001676   001706 600000 10                 TZE     s:18613
        10 001677   000205 100000 3                  CMPX0   BADDIES+44
        10 001700   001706 600000 10                 TZE     s:18613

      875    18595    2                SUBSTR(RES_OUT,0,2)~='CP' AND
      876    18596    2                SUBSTR(RES_OUT,0,2)~='ME' AND
      877    18597    2                SUBSTR(RES_OUT,0,2)~='LP' AND
      878    18598    2                SUBSTR(RES_OUT,0,2)~='JE' AND
      879    18599    2                SUBSTR(RES_OUT,0,2)~='LT' AND
      880    18600    2                SUBSTR(RES_OUT,0,2)~='MT' AND
      881    18601    3                SUBSTR(RES_OUT,0,2)~='FT' THEN DO;

      882    18602    3                 CALL XUR$ERRMSG(%E$VWM_OUT);

  18602 10 001701   000075 630400 11                 EPPR0   61
        10 001702   000000 631400 11                 EPPR1   0
        10 001703   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001704   000000 011000                    NOP     0

      883    18603    3                 GOTO DECIDE;

  18603 10 001705   002626 710000 10                 TRA     DECIDE

      884    18604    3                 END;
      885    18605
      886    18606        /****
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:122  
      887    18607        *
      888    18608        *   If there's no output name (where one is needed), make it the same
      889    18609        *   as the input name.
      890    18610        *
      891    18611        ****/
      892    18612
      893    18613    2              IF (ASN_OUT=%FILE# OR SUBSTR(RES_OUT,0,2)='LT') AND NOT OUT_VLR.NAME

  18613 10 001706   001000 116003                    CMPQ    512,DU
        10 001707   001713 600000 10                 TZE     s:18613+5
        10 001710   002435 220000 0                  LDX0    RES_OUT
        10 001711   000203 100000 3                  CMPX0   BADDIES+42
        10 001712   001722 601000 10                 TNZ     s:18625
        10 001713   001622 234000 0                  SZN     OUT_VLR
        10 001714   001722 604000 10                 TMI     s:18625

      894    18614    3              THEN DO;

      895    18615    3                 OUT_VLR.NAME='1'B;

  18615 10 001715   400000 236003                    LDQ     -131072,DU
        10 001716   001622 256000 0                  ORSQ    OUT_VLR

      896    18616    3                 NAME_OUT=NAME_INP;

  18616 10 001717   000000 100400                    MLR     fill='000'O
        10 001720   001506 000040 0                  ADSC9   NAME_INP                 cn=0,n=32
        10 001721   001576 000040 0                  ADSC9   NAME_OUT                 cn=0,n=32

      897    18617    3                 END;

      898    18618
      899    18619        /****
      900    18620        *
      901    18621        *   Force M$UNFID to materialize an account.
      902    18622        *
      903    18623        ****/
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:123  
      904    18624
      905    18625    2              IF OPTS.OUT.NODE=' ' AND

  18625 10 001722   040000 106400                    CMPC    fill='040'O
        10 001723   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 001724   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001725   001757 601000 10                 TNZ     s:18633
        10 001726   002433 236000 0                  LDQ     ASN_OUT
        10 001727   777000 376003                    ANQ     -512,DU
        10 001730   001000 116003                    CMPQ    512,DU
        10 001731   001735 601000 10                 TNZ     s:18625+11
        10 001732   001622 236000 0                  LDQ     OUT_VLR
        10 001733   200000 316003                    CANQ    65536,DU
        10 001734   001743 600000 10                 TZE     s:18628
        10 001735   001622 236000 0                  LDQ     OUT_VLR
        10 001736   200000 316003                    CANQ    65536,DU
        10 001737   001757 600000 10                 TZE     s:18633
        10 001740   001574 237000 0                  LDAQ    ACCT_OUT
        10 001741   000070 117000 11                 CMPAQ   56
        10 001742   001757 601000 10                 TNZ     s:18633

      906    18626    2                ((ASN_OUT=%FILE# AND NOT OUT_VLR.ACCT) OR
      907    18627    3                (OUT_VLR.ACCT AND ACCT_OUT.ACCT#=' ')) THEN DO;

      908    18628    3                 OUT_VLR.ACCT='1'B;

  18628 10 001743   200000 236003                    LDQ     65536,DU
        10 001744   001622 256000 0                  ORSQ    OUT_VLR

      909    18629    3                 ACCT_OUT.ACCT#=B$JIT.FACCN;

  18629 10 001745   000000 470400 xsym               LDP0    B$JIT$
        10 001746   000006 237100                    LDAQ    6,,PR0
        10 001747   001574 757000 0                  STAQ    ACCT_OUT

      910    18630    3                 IF SN_OUT.SN#(0)=' ' THEN

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:124  
  18630 10 001750   040000 106400                    CMPC    fill='040'O
        10 001751   001611 000006 0                  ADSC9   SN_OUT+1                 cn=0,n=6
        10 001752   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 001753   001757 601000 10                 TNZ     s:18633

      911    18631    3                    SN_OUT.SN#(0)=B$JIT.FPSN;

  18631 10 001754   040000 100500                    MLR     fill='040'O
        10 001755   000021 000006                    ADSC9   17,,PR0                  cn=0,n=6
        10 001756   001611 000006 0                  ADSC9   SN_OUT+1                 cn=0,n=6

      912    18632    3                 END;

      913    18633    3              CALL M$UNFID(UNFID_OUT) WHENALTRETURN DO;

  18633 10 001757   001674 630400 0                  EPPR0   UNFID_OUT
        10 001760   420021 713400                    CLIMB   alt,+8209
        10 001761   404400 401760                    pmme    nvectors=10
        10 001762   001764 702000 10                 TSX2    s:18634
        10 001763   001771 710000 10                 TRA     s:18637

      914    18634    3                 CALL XUR$ERRMSG(%E$VWM_OTL);

  18634 10 001764   000035 630400 11                 EPPR0   29
        10 001765   000000 631400 11                 EPPR1   0
        10 001766   000000 701000 xent               TSX1    XUR$ERRMSG
        10 001767   000000 011000                    NOP     0

      915    18635    3                 GOTO DECIDE;

  18635 10 001770   002626 710000 10                 TRA     DECIDE

      916    18636    3                 END;
      917    18637    2              OPTS.OUT.L=I+ASCBIN('/');

  18637 10 001771   002422 236000 0                  LDQ     I
        10 001772   000057 036007                    ADLQ    47,DL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:125  
        10 001773   000033 736000                    QLS     27
        10 001774   000075 552040 0                  STBQ    VW_OPTIONS#+60,'40'O

      918    18638
      919    18639        /****
      920    18640        *
      921    18641        *   You can't move to a star file.
      922    18642        *
      923    18643        ****/
      924    18644
      925    18645    3              IF ASN_OUT=%FILE# AND SUBSTR(OPTS.OUT.FID,0,1)='*' THEN DO;

  18645 10 001775   002433 236000 0                  LDQ     ASN_OUT
        10 001776   777000 376003                    ANQ     -512,DU
        10 001777   001000 116003                    CMPQ    512,DU
        10 002000   002012 601000 10                 TNZ     s:18658
        10 002001   000075 236000 0                  LDQ     VW_OPTIONS#+60
        10 002002   000777 376003                    ANQ     511,DU
        10 002003   000052 116003                    CMPQ    42,DU
        10 002004   002012 601000 10                 TNZ     s:18658

      926    18646    3                 CALL XUR$ERRMSG(%E$VWM_STR);

  18646 10 002005   000077 630400 11                 EPPR0   63
        10 002006   000000 631400 11                 EPPR1   0
        10 002007   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002010   000000 011000                    NOP     0

      927    18647    3                 GOTO DECIDE;

  18647 10 002011   002626 710000 10                 TRA     DECIDE

      928    18648    3                 END;
      929    18649    2              END;
      930    18650
      931    18651        /****
      932    18652        *
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:126  
      933    18653        *   Restore the *IAM node name if needed.  Note that we already checked
      934    18654        *   for insanities above.
      935    18655        *
      936    18656        ****/
      937    18657
      938    18658    1           IF OPTS.OUT.NODE=' ' THEN

  18658 10 002012   040000 106400                    CMPC    fill='040'O
        10 002013   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 002014   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002015   002021 601000 10                 TNZ     s:18668

      939    18659    1              OPTS.OUT.NODE=VW_IAM#;

  18659 10 002016   004644 237000 0                  LDAQ    VW_IAM#
        10 002017   000073 755000 0                  STA     VW_OPTIONS#+58
        10 002020   000074 756000 0                  STQ     VW_OPTIONS#+59

      940    18660
      941    18661        /****
      942    18662        *
      943    18663        *   If we're sucking a file to here and we didn't get a logon name
      944    18664        *   and account, supply one from the JIT.
      945    18665        *
      946    18666        ****/
      947    18667
      948    18668    1           IF OPTS.OUT.NODE=VW_IAM# AND OPTS.OUT.ACCT=' ' AND

  18668 10 002021   040000 106400                    CMPC    fill='040'O
        10 002022   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 002023   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 002024   002043 601000 10                 TNZ     s:18680
        10 002025   000052 237000 0                  LDAQ    VW_OPTIONS#+41
        10 002026   000070 117000 11                 CMPAQ   56
        10 002027   002043 601000 10                 TNZ     s:18680
        10 002030   040000 106400                    CMPC    fill='040'O
        10 002031   000054 000014 0                  ADSC9   VW_OPTIONS#+43           cn=0,n=12
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:127  
        10 002032   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002033   002043 601000 10                 TNZ     s:18680

      949    18669    2             OPTS.OUT.NAME=' ' THEN DO;

      950    18670    2              OPTS.OUT.ACCT=B$JIT.ACCN;

  18670 10 002034   000000 470400 xsym               LDP0    B$JIT$
        10 002035   040000 100500                    MLR     fill='040'O
        10 002036   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 002037   000052 000010 0                  ADSC9   VW_OPTIONS#+41           cn=0,n=8

      951    18671    2              OPTS.OUT.NAME=B$JIT.UNAME;

  18671 10 002040   040000 100500                    MLR     fill='040'O
        10 002041   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 002042   000054 000014 0                  ADSC9   VW_OPTIONS#+43           cn=0,n=12

      952    18672    2              END;

      953    18673
      954    18674        /****
      955    18675        *
      956    18676        *   Get the logon IDs at both nodes, if necessary.
      957    18677        *
      958    18678        ****/
      959    18679
      960    18680    1           IF ONCE THEN

  18680 10 002043   004701 234000 0                  SZN     ONCE
        10 002044   002067 605000 10                 TPL     s:18683

      961    18681    1              CALL XUR$ERRMSG(%E$VWM_HI,,,VECTOR(B_VERSION));

  18681 10 002045   000000 236000 xsym               LDQ     B_VERSION
        10 002046   000033 772000                    QRL     27
        10 002047   000001 620006                    EAX0    1,QL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:128  
        10 002050   000000 635010                    EAA     0,X0
        10 002051   000002 771000                    ARL     2
        10 002052   000140 135007                    SBLA    96,DL
        10 002053   000052 236000 11                 LDQ     42
        10 002054   004730 757000 0                  STAQ    PASSWORD+2
        10 002055   004730 630400 0                  EPPR0   PASSWORD+2
        10 002056   004735 450400 0                  STP0    PASSWORD+7
        10 002057   000007 236000 11                 LDQ     7
        10 002060   004734 756000 0                  STQ     PASSWORD+6
        10 002061   000055 235000 11                 LDA     45
        10 002062   004732 757000 0                  STAQ    PASSWORD+4
        10 002063   004732 630400 0                  EPPR0   PASSWORD+4
        10 002064   000053 631400 11                 EPPR1   43
        10 002065   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002066   000000 011000                    NOP     0

      962    18682
      963    18683    1           CALL LOGON(OPTS.INP,'1'B) ALTRET(DECIDE);

  18683 10 002067   000102 237000 11                 LDAQ    66
        10 002070   004716 757000 0                  STAQ    LAST+2
        10 002071   004033 701000 10                 TSX1    LOGON
        10 002072   002626 702000 10                 TSX2    DECIDE

      964    18684
      965    18685        /****
      966    18686        *
      967    18687        *   If this is a suck to here and the logon matches the current JIT
      968    18688        *   name and account, fetch the password from :HLP so that the user
      969    18689        *   doesn't have to specify it.  This isn't a security breach, since
      970    18690        *   he had to know the password in order to log on.
      971    18691        *
      972    18692        ****/
      973    18693
      974    18694    1           IF OPTS.OUT.NODE=VW_IAM# AND B$JIT.ACCN=OPTS.OUT.ACCT AND

  18694 10 002073   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:129  
        10 002074   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 002075   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 002076   002206 601000 10                 TNZ     ANYWAY
        10 002077   000000 470400 xsym               LDP0    B$JIT$
        10 002100   040000 106500                    CMPC    fill='040'O
        10 002101   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 002102   000052 000010 0                  ADSC9   VW_OPTIONS#+41           cn=0,n=8
        10 002103   002206 601000 10                 TNZ     ANYWAY
        10 002104   040000 106500                    CMPC    fill='040'O
        10 002105   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 002106   000054 000014 0                  ADSC9   VW_OPTIONS#+43           cn=0,n=12
        10 002107   002206 601000 10                 TNZ     ANYWAY
        10 002110   040000 106400                    CMPC    fill='040'O
        10 002111   000057 000014 0                  ADSC9   VW_OPTIONS#+46           cn=0,n=12
        10 002112   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002113   002206 601000 10                 TNZ     ANYWAY

      975    18695    2             B$JIT.UNAME=OPTS.OUT.NAME AND OPTS.OUT.EPASS=' ' THEN DO;

      976    18696    2              ACCTNAME.ACCT=OPTS.OUT.ACCT;

  18696 10 002114   040000 100400                    MLR     fill='040'O
        10 002115   000052 000010 0                  ADSC9   VW_OPTIONS#+41           cn=0,n=8
        10 002116   004646 200010 0                  ADSC9   ACCTNAME                 cn=1,n=8

      977    18697    2              ACCTNAME.NAME=OPTS.OUT.NAME;

  18697 10 002117   040000 100400                    MLR     fill='040'O
        10 002120   000054 000014 0                  ADSC9   VW_OPTIONS#+43           cn=0,n=12
        10 002121   004650 200014 0                  ADSC9   ACCTNAME+2               cn=1,n=12

      978    18698    2              CALL INDEX(I,' ',OPTS.OUT.NAME);

  18698 10 002122   000000 124400                    SCM     mask='000'O
        10 002123   000054 000014 0                  ADSC9   VW_OPTIONS#+43           cn=0,n=12
        10 002124   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002125   002422 000000 0                  ARG     I
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:130  

      979    18699    2              ACCTNAME.L=I+8;

  18699 10 002126   002422 236000 0                  LDQ     I
        10 002127   000010 036007                    ADLQ    8,DL
        10 002130   000033 736000                    QLS     27
        10 002131   004646 552040 0                  STBQ    ACCTNAME,'40'O

      980    18700
      981    18701        /****
      982    18702        *
      983    18703        *   We need FMR to read :HLP.  Turn it on, then remember to turn it
      984    18704        *   off if it wasn't already on.  Otherwise, anyone could MOVE anything
      985    18705        *   to anywhere!
      986    18706        *
      987    18707        ****/
      988    18708
      989    18709    2              CALL M$SPRIV(FPT_PRIV);

  18709 10 002132   002346 630400 0                  EPPR0   FPT_PRIV
        10 002133   020012 713400                    CLIMB   8202
        10 002134   400000 401760                    pmme    nvectors=1

      990    18710    3              DO WHILE('0'B);

  18710 10 002135   002147 710000 10                 TRA     s:18717

      991    18711
      992    18712    3   SLEEP_HLP:
      993    18713    3                 IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE~=%E$FILEBUSY THEN

  18713 10 002136   000000 470400 xsym  SLEEP_HLP    LDP0    B$TCB$
        10 002137   000000 471500                    LDP1    0,,PR0
        10 002140   100102 236100                    LDQ     66,,PR1
        10 002141   377770 376007                    ANQ     131064,DL
        10 002142   001550 116007                    CMPQ    872,DL
        10 002143   002206 601000 10                 TNZ     ANYWAY
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:131  

      994    18714    3                    GOTO ANYWAY;
      995    18715    3                 CALL M$WAIT(SNOOZE);

  18715 10 002144   002276 630400 0                  EPPR0   SNOOZE
        10 002145   020006 713400                    CLIMB   8198
        10 002146   400400 401760                    pmme    nvectors=2

      996    18716    3                 END;

      997    18717    2              CALL M$OPEN(OPEN_HLP) ALTRET(SLEEP_HLP);

  18717 10 002147   002124 630400 0                  EPPR0   OPEN_HLP
        10 002150   450000 713400                    CLIMB   alt,open
        10 002151   410400 401760                    pmme    nvectors=18
        10 002152   002136 702000 10                 TSX2    SLEEP_HLP

      998    18718    3              CALL M$READ(READ_HLP) WHENALTRETURN DO;

  18718 10 002153   002222 630400 0                  EPPR0   READ_HLP
        10 002154   440000 713400                    CLIMB   alt,read
        10 002155   401400 401760                    pmme    nvectors=4
        10 002156   002160 702000 10                 TSX2    s:18719
        10 002157   002173 710000 10                 TRA     s:18724

      999    18719    3                 CALL M$CLOSE(CLOSE_HLP);

  18719 10 002160   002240 630400 0                  EPPR0   CLOSE_HLP
        10 002161   050001 713400                    CLIMB   close
        10 002162   406000 401760                    pmme    nvectors=13

     1000    18720    3                 IF NOT (B$JIT.PRIV.JOB&%PR_FMREAD#) THEN

  18720 10 002163   000000 470400 xsym               LDP0    B$JIT$
        10 002164   000015 236100                    LDQ     13,,PR0
        10 002165   000171 376000 3                  ANQ     BADDIES+32
        10 002166   002172 601000 10                 TNZ     s:18722
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:132  

     1001    18721    3                    CALL M$RPRIV(FPT_PRIV);

  18721 10 002167   002346 630400 0                  EPPR0   FPT_PRIV
        10 002170   020013 713400                    CLIMB   8203
        10 002171   400000 401760                    pmme    nvectors=1

     1002    18722    3                 GOTO ANYWAY;

  18722 10 002172   002206 710000 10                 TRA     ANYWAY

     1003    18723    3                 END;
     1004    18724    2              CALL M$CLOSE(CLOSE_HLP);

  18724 10 002173   002240 630400 0                  EPPR0   CLOSE_HLP
        10 002174   050001 713400                    CLIMB   close
        10 002175   406000 401760                    pmme    nvectors=13

     1005    18725    2              OPTS.OUT.EPASS=HLPBUF.PASSWORD;

  18725 10 002176   040000 100400                    MLR     fill='040'O
        10 002177   001151 000010 0                  ADSC9   HLPBUF+2                 cn=0,n=8
        10 002200   000057 000014 0                  ADSC9   VW_OPTIONS#+46           cn=0,n=12

     1006    18726    2              CALL LOGON(OPTS.OUT,'0'B) ALTRET(DECIDE);

  18726 10 002201   000104 237000 11                 LDAQ    68
        10 002202   004716 757000 0                  STAQ    LAST+2
        10 002203   004033 701000 10                 TSX1    LOGON
        10 002204   002626 702000 10                 TSX2    DECIDE

     1007    18727    2              END;

  18727 10 002205   002212 710000 10                 TRA     s:18748

     1008    18728
     1009    18729        /****
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:133  
     1010    18730        *
     1011    18731        *   We're moving elsewhere, so prompt for the logon.
     1012    18732        *
     1013    18733        ****/
     1014    18734
     1015    18735    2           ELSE DO;

     1016    18736
     1017    18737    2   ANYWAY:
     1018    18738    2              CALL LOGON(OPTS.OUT,'1'B) ALTRET(DECIDE);

  18738 10 002206   000106 237000 11    ANYWAY       LDAQ    70
        10 002207   004716 757000 0                  STAQ    LAST+2
        10 002210   004033 701000 10                 TSX1    LOGON
        10 002211   002626 702000 10                 TSX2    DECIDE

     1019    18739    2              END;

     1020    18740
     1021    18741        /****
     1022    18742        *
     1023    18743        *   If we are moving to @LOCAL and the logon is the same as the JIT,
     1024    18744        *   check to make sure the file does not exist if 'TO' or 'ON'.
     1025    18745        *
     1026    18746        ****/
     1027    18747
     1028    18748    1           IF OPTS.OUT.NODE=VW_IAM# AND OPTS.OUT.ACCT=B$JIT.ACCN AND OPTS.OUT.NAME=

  18748 10 002212   040000 106400                    CMPC    fill='040'O
        10 002213   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 002214   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 002215   002250 601000 10                 TNZ     s:18765
        10 002216   000000 470400 xsym               LDP0    B$JIT$
        10 002217   040100 106400                    CMPC    fill='040'O
        10 002220   000052 000010 0                  ADSC9   VW_OPTIONS#+41           cn=0,n=8
        10 002221   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 002222   002250 601000 10                 TNZ     s:18765
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:134  
        10 002223   040100 106400                    CMPC    fill='040'O
        10 002224   000054 000014 0                  ADSC9   VW_OPTIONS#+43           cn=0,n=12
        10 002225   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 002226   002250 601000 10                 TNZ     s:18765
        10 002227   000072 236000 0                  LDQ     VW_OPTIONS#+57
        10 002230   000003 376007                    ANQ     3,DL
        10 002231   000002 116007                    CMPQ    2,DL
        10 002232   002250 603000 10                 TRC     s:18765
        10 002233   002433 236000 0                  LDQ     ASN_OUT
        10 002234   777000 376003                    ANQ     -512,DU
        10 002235   001000 116003                    CMPQ    512,DU
        10 002236   002250 601000 10                 TNZ     s:18765

     1029    18749    2             B$JIT.UNAME AND OPTS.OUT.MISC.HOW<2 AND ASN_OUT=%FILE# THEN DO;

     1030    18750    3              CALL M$OPEN(OPEN_OTST) WHENRETURN DO;

  18750 10 002237   002014 630400 0                  EPPR0   OPEN_OTST
        10 002240   450000 713400                    CLIMB   alt,open
        10 002241   410400 401760                    pmme    nvectors=18
        10 002242   002250 702000 10                 TSX2    s:18765

     1031    18751    3                 CALL XUR$ERRMSG(%E$VWM_CWO);

  18751 10 002243   000111 630400 11                 EPPR0   73
        10 002244   000000 631400 11                 EPPR1   0
        10 002245   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002246   000000 011000                    NOP     0

     1032    18752    3                 GOTO DECIDE;

  18752 10 002247   002626 710000 10                 TRA     DECIDE

     1033    18753    3                 END;
     1034    18754    2              END;

     1035    18755
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:135  
     1036    18756
     1037    18757        /****
     1038    18758        *
     1039    18759        *   Now fix up the mailboxes.  If we are the initiator and sender,
     1040    18760        *   ignore any sender options.  If we are the initiator and the
     1041    18761        *   receiver, ignore any receiver options.
     1042    18762        *
     1043    18763        ****/
     1044    18764
     1045    18765    2           IF OPTS.INP.NODE=' ' AND OPTS.MAILINIT.WHO~=' ' THEN DO;

  18765 10 002250   040000 106400                    CMPC    fill='040'O
        10 002251   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 002252   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002253   002266 601000 10                 TNZ     s:18770
        10 002254   000242 236000 0                  LDQ     VW_OPTIONS#+161
        10 002255   777000 376003                    ANQ     -512,DU
        10 002256   040000 116003                    CMPQ    16384,DU
        10 002257   002266 600000 10                 TZE     s:18770

     1046    18766    2              CARD(4)=' ';

  18766 10 002260   040000 100400                    MLR     fill='040'O
        10 002261   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002262   000121 000120 0                  ADSC9   VW_OPTIONS#+80           cn=0,n=80

     1047    18767    2              CARD(5)=' ';

  18767 10 002263   040000 100400                    MLR     fill='040'O
        10 002264   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002265   000145 000120 0                  ADSC9   VW_OPTIONS#+100          cn=0,n=80

     1048    18768    2              END;

     1049    18769
     1050    18770    1           IF OPTS.MAILSNDR.WHO~=' ' THEN

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:136  
  18770 10 002266   000122 236000 0                  LDQ     VW_OPTIONS#+81
        10 002267   777000 376003                    ANQ     -512,DU
        10 002270   040000 116003                    CMPQ    16384,DU
        10 002271   002275 600000 10                 TZE     s:18773

     1051    18771    1              OPTS.MAILSNDR.NODE=OPTS.INP.NODE;

  18771 10 002272   040000 100400                    MLR     fill='040'O
        10 002273   000023 000010 0                  ADSC9   VW_OPTIONS#+18           cn=0,n=8
        10 002274   000143 000010 0                  ADSC9   VW_OPTIONS#+98           cn=0,n=8

     1052    18772
     1053    18773    2           IF OPTS.OUT.NODE=VW_IAM# AND OPTS.MAILINIT.WHO~=' ' THEN DO;

  18773 10 002275   040000 106400                    CMPC    fill='040'O
        10 002276   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 002277   004644 000010 0                  ADSC9   VW_IAM#                  cn=0,n=8
        10 002300   002313 601000 10                 TNZ     s:18778
        10 002301   000242 236000 0                  LDQ     VW_OPTIONS#+161
        10 002302   777000 376003                    ANQ     -512,DU
        10 002303   040000 116003                    CMPQ    16384,DU
        10 002304   002313 600000 10                 TZE     s:18778

     1054    18774    2              CARD(6)=' ';

  18774 10 002305   040000 100400                    MLR     fill='040'O
        10 002306   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002307   000171 000120 0                  ADSC9   VW_OPTIONS#+120          cn=0,n=80

     1055    18775    2              CARD(7)=' ';

  18775 10 002310   040000 100400                    MLR     fill='040'O
        10 002311   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002312   000215 000120 0                  ADSC9   VW_OPTIONS#+140          cn=0,n=80

     1056    18776    2              END;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:137  
     1057    18777
     1058    18778    1           IF OPTS.MAILRCVR.WHO~=' ' THEN

  18778 10 002313   000172 236000 0                  LDQ     VW_OPTIONS#+121
        10 002314   777000 376003                    ANQ     -512,DU
        10 002315   040000 116003                    CMPQ    16384,DU
        10 002316   002322 600000 10                 TZE     s:18787

     1059    18779    1              OPTS.MAILRCVR.NODE=OPTS.OUT.NODE;

  18779 10 002317   040000 100400                    MLR     fill='040'O
        10 002320   000073 000010 0                  ADSC9   VW_OPTIONS#+58           cn=0,n=8
        10 002321   000213 000010 0                  ADSC9   VW_OPTIONS#+138          cn=0,n=8

     1060    18780
     1061    18781        /****
     1062    18782        *
     1063    18783        *   Determine if there's a good mailbox (if needed) for the initiator.
     1064    18784        *
     1065    18785        ****/
     1066    18786
     1067    18787    2           IF OPTS.MAILINIT.WHO~=' ' THEN DO;

  18787 10 002322   000242 236000 0                  LDQ     VW_OPTIONS#+161
        10 002323   777000 376003                    ANQ     -512,DU
        10 002324   040000 116003                    CMPQ    16384,DU
        10 002325   002405 600000 10                 TZE     MAIL_OK

     1068    18788    2              OPTS.MAILINIT.NODE=VW_IAM#;

  18788 10 002326   004644 237000 0                  LDAQ    VW_IAM#
        10 002327   000263 755000 0                  STA     VW_OPTIONS#+178
        10 002330   000264 756000 0                  STQ     VW_OPTIONS#+179

     1069    18789
     1070    18790        /****
     1071    18791        *
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:138  
     1072    18792        *   If a mailbox was specified, make sure it's valid.
     1073    18793        *
     1074    18794        ****/
     1075    18795
     1076    18796
     1077    18797    2   NAMESERVER:
     1078    18798    3              do;

  18798 10 002331                       NAMESERVER   null
     1079    18799    4                 call VWM$GET_MAILBOX( OPTS.MAILINIT.MAILBOX, VW_IAM# ) whenaltreturn
             18799                          do;

  18799 10 002331   000112 630400 11                 EPPR0   74
        10 002332   000014 631400 11                 EPPR1   12
        10 002333   000000 701000 xent               TSX1    VWM$GET_MAILBOX
        10 002334   002336 702000 10                 TSX2    s:18800
        10 002335   002365 710000 10                 TRA     s:18809

     1080    18800    4                    call XUR$ERRMSG(%E$VWM_BMS);

  18800 10 002336   000115 630400 11                 EPPR0   77
        10 002337   000000 631400 11                 EPPR1   0
        10 002340   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002341   000000 011000                    NOP     0

     1081    18801    4                    OPTS.MAILINIT.MAILBOX = ' ';

  18801 10 002342   040000 100400                    MLR     fill='040'O
        10 002343   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002344   000265 200117 0                  ADSC9   VW_OPTIONS#+180          cn=1,n=79

     1082    18802    5                    call VWM$GET_MAILBOX( OPTS.MAILINIT.MAILBOX, VW_IAM# )
             18802                             whenaltreturn do;

  18802 10 002345   000112 630400 11                 EPPR0   74
        10 002346   000014 631400 11                 EPPR1   12
        10 002347   000000 701000 xent               TSX1    VWM$GET_MAILBOX
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:139  
        10 002350   002352 702000 10                 TSX2    s:18803
        10 002351   002365 710000 10                 TRA     s:18809

     1083    18803    5                       call XUR$ERRMSG(%E$VWM_IMI);

  18803 10 002352   000117 630400 11                 EPPR0   79
        10 002353   000000 631400 11                 EPPR1   0
        10 002354   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002355   000000 011000                    NOP     0

     1084    18804    5                       CARD(8) = ' ';

  18804 10 002356   040000 100400                    MLR     fill='040'O
        10 002357   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002360   000241 000120 0                  ADSC9   VW_OPTIONS#+160          cn=0,n=80

     1085    18805    5                       CARD(9) = ' ';

  18805 10 002361   040000 100400                    MLR     fill='040'O
        10 002362   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002363   000265 000120 0                  ADSC9   VW_OPTIONS#+180          cn=0,n=80

     1086    18806    5                       exit NAMESERVER;

  18806 10 002364   002405 710000 10                 TRA     MAIL_OK

     1087    18807    5                       end;
     1088    18808    4                    end;                   /*  Of first altreturn do;            */

     1089    18809    3                 call searchr(I,J,B$SR_NON_BLANK,OPTS.MAILINIT.MAILBOX);

  18809 10 002365   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
        10 002366   000000 165400                    TCTR
        10 002367   000265 200117 0                  ADSC9   VW_OPTIONS#+180          cn=1,n=79
        10 002370   000000 000100                    ARG     0,,PR0
        10 002371   002422 000000 0                  ARG     I
        10 002372   002422 235000 0                  LDA     I
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:140  
        10 002373   000033 771000                    ARL     27
        10 002374   002423 755000 0                  STA     J
        10 002375   002422 551040 0                  STBA    I,'40'O
        10 002376   002401 606400 10                 TTN     s:18810
        10 002377   000116 236007                    LDQ     78,DL
        10 002400   002422 156000 0                  SSQ     I

     1090    18810    3                 OPTS.MAILINIT.L = I + ascbin('/') + 1;

  18810 10 002401   002422 236000 0                  LDQ     I
        10 002402   000060 036007                    ADLQ    48,DL
        10 002403   000033 736000                    QLS     27
        10 002404   000265 552040 0                  STBQ    VW_OPTIONS#+180,'40'O

     1091    18811    3                 end;

     1092    18812    2              END;

     1093    18813
     1094    18814        /****
     1095    18815        *
     1096    18816        *   Check the sender's mailbox for validity.
     1097    18817        *
     1098    18818        ****/
     1099    18819
     1100    18820    1   MAIL_OK:
     1101    18821    2           IF OPTS.MAILSNDR.WHO~=' ' THEN DO;

  18821 10 002405   000122 236000 0     MAIL_OK      LDQ     VW_OPTIONS#+81
        10 002406   777000 376003                    ANQ     -512,DU
        10 002407   040000 116003                    CMPQ    16384,DU
        10 002410   002443 600000 10                 TZE     s:18837

     1102    18822    3              call VWM$FIX_MAILBOX(OPTS.MAILSNDR.MAILBOX,OPTS.INP.ACCT) whenaltreturn
             18822                       do;

  18822 10 002411   000120 630400 11                 EPPR0   80
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:141  
        10 002412   000014 631400 11                 EPPR1   12
        10 002413   000000 701000 xent               TSX1    VWM$FIX_MAILBOX
        10 002414   002416 702000 10                 TSX2    s:18823
        10 002415   002423 710000 10                 TRA     s:18826

     1103    18823    3                 call XUR$ERRMSG(%E$VWM_RMI);

  18823 10 002416   000123 630400 11                 EPPR0   83
        10 002417   000000 631400 11                 EPPR1   0
        10 002420   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002421   000000 011000                    NOP     0

     1104    18824    3                 goto DECIDE;

  18824 10 002422   002626 710000 10                 TRA     DECIDE

     1105    18825    3                 end;
     1106    18826    2              call searchr(I,J,B$SR_NON_BLANK,OPTS.MAILSNDR.MAILBOX);

  18826 10 002423   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
        10 002424   000000 165400                    TCTR
        10 002425   000145 200117 0                  ADSC9   VW_OPTIONS#+100          cn=1,n=79
        10 002426   000000 000100                    ARG     0,,PR0
        10 002427   002422 000000 0                  ARG     I
        10 002430   002422 235000 0                  LDA     I
        10 002431   000033 771000                    ARL     27
        10 002432   002423 755000 0                  STA     J
        10 002433   002422 551040 0                  STBA    I,'40'O
        10 002434   002437 606400 10                 TTN     s:18827
        10 002435   000116 236007                    LDQ     78,DL
        10 002436   002422 156000 0                  SSQ     I

     1107    18827    2              OPTS.MAILSNDR.L = I + ascbin('/') + 1;

  18827 10 002437   002422 236000 0                  LDQ     I
        10 002440   000060 036007                    ADLQ    48,DL
        10 002441   000033 736000                    QLS     27
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:142  
        10 002442   000145 552040 0                  STBQ    VW_OPTIONS#+100,'40'O

     1108    18828
     1109    18829    2              END;

     1110    18830
     1111    18831        /****
     1112    18832        *
     1113    18833        *   Check the receiver's mailbox for validity.
     1114    18834        *
     1115    18835        ****/
     1116    18836
     1117    18837    2           IF OPTS.MAILRCVR.WHO~=' ' THEN DO;

  18837 10 002443   000172 236000 0                  LDQ     VW_OPTIONS#+121
        10 002444   777000 376003                    ANQ     -512,DU
        10 002445   040000 116003                    CMPQ    16384,DU
        10 002446   002501 600000 10                 TZE     s:18853

     1118    18838    3              call VWM$FIX_MAILBOX(OPTS.MAILRCVR.MAILBOX,OPTS.OUT.ACCT) whenaltreturn
             18838                       do;

  18838 10 002447   000124 630400 11                 EPPR0   84
        10 002450   000014 631400 11                 EPPR1   12
        10 002451   000000 701000 xent               TSX1    VWM$FIX_MAILBOX
        10 002452   002454 702000 10                 TSX2    s:18839
        10 002453   002461 710000 10                 TRA     s:18842

     1119    18839    3                 call XUR$ERRMSG(%E$VWM_RMI);

  18839 10 002454   000123 630400 11                 EPPR0   83
        10 002455   000000 631400 11                 EPPR1   0
        10 002456   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002457   000000 011000                    NOP     0

     1120    18840    3                 goto DECIDE;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:143  
  18840 10 002460   002626 710000 10                 TRA     DECIDE

     1121    18841    3                 end;
     1122    18842    2              call searchr(I,J,B$SR_NON_BLANK,OPTS.MAILRCVR.MAILBOX);

  18842 10 002461   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
        10 002462   000000 165400                    TCTR
        10 002463   000215 200117 0                  ADSC9   VW_OPTIONS#+140          cn=1,n=79
        10 002464   000000 000100                    ARG     0,,PR0
        10 002465   002422 000000 0                  ARG     I
        10 002466   002422 235000 0                  LDA     I
        10 002467   000033 771000                    ARL     27
        10 002470   002423 755000 0                  STA     J
        10 002471   002422 551040 0                  STBA    I,'40'O
        10 002472   002475 606400 10                 TTN     s:18843
        10 002473   000116 236007                    LDQ     78,DL
        10 002474   002422 156000 0                  SSQ     I

     1123    18843    2              OPTS.MAILRCVR.L = I + ascbin('/') + 1;

  18843 10 002475   002422 236000 0                  LDQ     I
        10 002476   000060 036007                    ADLQ    48,DL
        10 002477   000033 736000                    QLS     27
        10 002500   000215 552040 0                  STBQ    VW_OPTIONS#+140,'40'O

     1124    18844
     1125    18845    2              END;

     1126    18846
     1127    18847        /****
     1128    18848        *
     1129    18849        *   Clear the PROMPT flags, if any.
     1130    18850        *
     1131    18851        ****/
     1132    18852
     1133    18853    1           OPTS.INP.MISC.PROMPT='0'B;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:144  
  18853 10 002501   000126 236000 11                 LDQ     86
        10 002502   000022 356000 0                  ANSQ    VW_OPTIONS#+17

     1134    18854    1           OPTS.OUT.MISC.PROMPT='0'B;

  18854 10 002503   000072 356000 0                  ANSQ    VW_OPTIONS#+57

     1135    18855
     1136    18856        /****
     1137    18857        *
     1138    18858        *   Now fill out the command buffer.
     1139    18859        *
     1140    18860        ****/
     1141    18861
     1142    18862    1           IF OPTS.INP.ACCT~=' ' THEN

  18862 10 002504   000002 237000 0                  LDAQ    VW_OPTIONS#+1
        10 002505   000070 117000 11                 CMPAQ   56
        10 002506   002511 600000 10                 TZE     s:18864

     1143    18863    1              OPTS.INP.CMD='SUCK';

  18863 10 002507   000211 236000 3                  LDQ     BADDIES+48
        10 002510   000001 756000 0                  STQ     VW_OPTIONS#

     1144    18864    1           IF OPTS.OUT.ACCT~=' ' THEN

  18864 10 002511   000052 237000 0                  LDAQ    VW_OPTIONS#+41
        10 002512   000070 117000 11                 CMPAQ   56
        10 002513   002516 600000 10                 TZE     s:18866

     1145    18865    1              OPTS.OUT.CMD='BEAM';

  18865 10 002514   000212 236000 3                  LDQ     BADDIES+49
        10 002515   000051 756000 0                  STQ     VW_OPTIONS#+40

     1146    18866    1           IF OPTS.MAILSNDR.WHO~=' ' THEN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:145  

  18866 10 002516   000122 236000 0                  LDQ     VW_OPTIONS#+81
        10 002517   777000 376003                    ANQ     -512,DU
        10 002520   040000 116003                    CMPQ    16384,DU
        10 002521   002524 600000 10                 TZE     s:18868

     1147    18867    1              OPTS.MAILSNDR.CMD='MAIL';

  18867 10 002522   000213 236000 3                  LDQ     BADDIES+50
        10 002523   000121 756000 0                  STQ     VW_OPTIONS#+80

     1148    18868    1           IF OPTS.MAILRCVR.WHO~=' ' THEN

  18868 10 002524   000172 236000 0                  LDQ     VW_OPTIONS#+121
        10 002525   777000 376003                    ANQ     -512,DU
        10 002526   040000 116003                    CMPQ    16384,DU
        10 002527   002532 600000 10                 TZE     s:18870

     1149    18869    1              OPTS.MAILRCVR.CMD='MAIL';

  18869 10 002530   000213 236000 3                  LDQ     BADDIES+50
        10 002531   000171 756000 0                  STQ     VW_OPTIONS#+120

     1150    18870    1           IF OPTS.MAILINIT.WHO~=' ' THEN

  18870 10 002532   000242 236000 0                  LDQ     VW_OPTIONS#+161
        10 002533   777000 376003                    ANQ     -512,DU
        10 002534   040000 116003                    CMPQ    16384,DU
        10 002535   002540 600000 10                 TZE     s:18879

     1151    18871    1              OPTS.MAILINIT.CMD='MAIL';

  18871 10 002536   000213 236000 3                  LDQ     BADDIES+50
        10 002537   000241 756000 0                  STQ     VW_OPTIONS#+160

     1152    18872
     1153    18873        /****
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:146  
     1154    18874        *
     1155    18875        *   Reset counters, set up interrupt linkage, set the prompt, and DO IT!
     1156    18876        *
     1157    18877        ****/
     1158    18878
     1159    18879    1           VW_INPCNT#=0;

  18879 10 002540   002427 450000 0                  STZ     VW_INPCNT#

     1160    18880    1           VW_OUTCNT#=0;

  18880 10 002541   002430 450000 0                  STZ     VW_OUTCNT#

     1161    18881
     1162    18882    1           FPT_PROMPT.PROMPT_=VECTOR(ASTERISK);

  18882 10 002542   000130 237000 11                 LDAQ    88
        10 002543   002340 757000 0                  STAQ    FPT_PROMPT+4

     1163    18883    1           CALL M$PROMPT(FPT_PROMPT);

  18883 10 002544   002334 630400 0                  EPPR0   FPT_PROMPT
        10 002545   160002 713400                    CLIMB   57346
        10 002546   401000 401760                    pmme    nvectors=3

     1164    18884
     1165    18885    1           CALL M$INT(FPT_INT);

  18885 10 002547   001450 630400 0                  EPPR0   FPT_INT
        10 002550   010002 713400                    CLIMB   4098
        10 002551   400000 401760                    pmme    nvectors=1

     1166    18886
     1167    18887    1           IF OPTS.INP.CMD~=' ' THEN

  18887 10 002552   000001 236000 0                  LDQ     VW_OPTIONS#
        10 002553   000021 116000 11                 CMPQ    17
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:147  
        10 002554   002563 600000 10                 TZE     s:18892

     1168    18888    2              CALL VWK$SUCK WHENALTRETURN DO;

  18888 10 002555   000101 631400 11                 EPPR1   65
        10 002556   000000 701000 xent               TSX1    VWK$SUCK
        10 002557   002561 702000 10                 TSX2    s:18889
        10 002560   002562 710000 10                 TRA     s:18889+1

     1169    18889    2                 GOTO DECIDE;

  18889 10 002561   002626 710000 10                 TRA     DECIDE
        10 002562   002570 710000 10                 TRA     s:18902

     1170    18890    2                 END;
     1171    18891    1           ELSE
     1172    18892    2              CALL VWB$BEAM WHENALTRETURN DO;

  18892 10 002563   000101 631400 11                 EPPR1   65
        10 002564   000000 701000 xent               TSX1    VWB$BEAM
        10 002565   002567 702000 10                 TSX2    s:18893
        10 002566   002570 710000 10                 TRA     s:18902

     1173    18893    2                 GOTO DECIDE;

  18893 10 002567   002626 710000 10                 TRA     DECIDE

     1174    18894    2                 END;
     1175    18895
     1176    18896        /****
     1177    18897        *
     1178    18898        *   Tell the user where the mail is going, if any.
     1179    18899        *
     1180    18900        ****/
     1181    18901
     1182    18902    1           IF CARD(8)=' ' THEN

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:148  
  18902 10 002570   040000 106400                    CMPC    fill='040'O
        10 002571   000241 000120 0                  ADSC9   VW_OPTIONS#+160          cn=0,n=80
        10 002572   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 002573   002601 601000 10                 TNZ     s:18905

     1183    18903    1              CALL XUR$ERRMSG(%E$VWM_NMA);

  18903 10 002574   000132 630400 11                 EPPR0   90
        10 002575   000000 631400 11                 EPPR1   0
        10 002576   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002577   000000 011000                    NOP     0
        10 002600   002626 710000 10                 TRA     DECIDE

     1184    18904    2           ELSE DO;

     1185    18905    2              U1.C=OPTS.MAILINIT.MAILBOX;

  18905 10 002601   040000 100400                    MLR     fill='040'O
        10 002602   000265 200117 0                  ADSC9   VW_OPTIONS#+180          cn=1,n=79
        10 002603   004654 200117 0                  ADSC9   U1                       cn=1,n=79

     1186    18906    2              U1.L=OPTS.MAILINIT.L-ASCBIN('/');

  18906 10 002604   000265 236000 0                  LDQ     VW_OPTIONS#+180
        10 002605   000033 772000                    QRL     27
        10 002606   000057 136007                    SBLQ    47,DL
        10 002607   000033 736000                    QLS     27
        10 002610   004654 552040 0                  STBQ    U1,'40'O

     1187    18907    2              CALL XUR$ERRMSG(%E$VWM_MA,,DCBNUM(M$ME),VECTOR(U1));

  18907 10 002611   000000 236007 xsym               LDQ     M$ME,DL
        10 002612   004730 756000 0                  STQ     PASSWORD+2
        10 002613   000137 236000 11                 LDQ     95
        10 002614   004735 756000 0                  STQ     PASSWORD+7
        10 002615   004730 630400 0                  EPPR0   PASSWORD+2
        10 002616   004734 450400 0                  STP0    PASSWORD+6
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:149  
        10 002617   000007 236000 11                 LDQ     7
        10 002620   000140 235000 11                 LDA     96
        10 002621   004732 757000 0                  STAQ    PASSWORD+4
        10 002622   004732 630400 0                  EPPR0   PASSWORD+4
        10 002623   000053 631400 11                 EPPR1   43
        10 002624   000000 701000 xent               TSX1    XUR$ERRMSG
        10 002625   000000 011000                    NOP     0

     1188    18908    2              END;

     1189    18909
     1190    18910        /****
     1191    18911        *
     1192    18912        *   Decide where to go.
     1193    18913        *
     1194    18914        ****/
     1195    18915
     1196    18916    1   DECIDE:
     1197    18917    1           IF ONCE THEN

  18917 10 002626   004701 234000 0     DECIDE       SZN     ONCE
        10 002627   000125 605000 10                 TPL     GET_COMMAND

     1198    18918    1              CALL M$EXIT;

  18918 10 002630   000001 713400                    CLIMB   exit
        10 002631   000000 401760                    pmme    nvectors=0
        10 002632   002633 710000 10                 TRA     s:18918+3
        10 002633   005010 710000 10                 TRA     s:19605

     1199    18919    1           ELSE
     1200    18920    1              GOTO GET_COMMAND;
     1201    18921
     1202    18922        %EJECT;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:150  
     1203    18923        /*I**
     1204    18924        *
     1205    18925        *   NAME:  OPTIONS
     1206    18926        *
     1207    18927        *   PURPOSE:
     1208    18928        *       To decode a parsed options list into VW_OPTIONS#.
     1209    18929        *
     1210    18930        *   CALL:
     1211    18931        *       CALL OPTIONS(blk$,argb) ALTRET...
     1212    18932        *
     1213    18933        *   PARAMETERS:
     1214    18934        *       blk$ is the pointer to the parse block which is an options list.
     1215    18935        *       argb is a two-"card" output block into which the options may be
     1216    18936        *       placed.  Options which do are strictly input or output are placed
     1217    18937        *       directly into VW_OPTIONS#; others, such as logon information, are
     1218    18938        *       either input or output and are placed into "argb".
     1219    18939        *
     1220    18940        *   DATA:
     1221    18941        *       VW_OPTIONS# may be modified.
     1222    18942        *
     1223    18943        *   DESCRIPTION:
     1224    18944        *       OPTIONS processes the parser options output nodes and puts the
     1225    18945        *       results in the option block.
     1226    18946        *
     1227    18947        ****/
     1228    18948
     1229    18949    1   OPTIONS: PROC(BLK$,ARGB) ALTRET;

  18949 10 002634   004702 741200 0     OPTIONS      STX1  ! ONCE+1

     1230    18950
     1231    18951    2   DCL BLK$                           ALIGNED PTR;
     1232    18952
     1233    18953    2   DCL 1 ARGB ALIGNED,
     1234    18954    2         2 *                          CHAR(4),
     1235    18955    2         2 ACCT                       CHAR(8),
     1236    18956    2         2 NAME                       CHAR(12),
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:151  
     1237    18957    2         2 EPASS                      CHAR(12),
     1238    18958    2         2 * UNAL                     CHAR(35),
     1239    18959    2         2 MISC UNAL,
     1240    18960    2           3 PROMPT UNAL              BIT(1),
     1241    18961    2           3 * UNAL                   BIT(8),
     1242    18962    2         2 NODE                       CHAR(8),
     1243    18963    2         2 *                          CHAR(80);
     1244    18964    2   DCL ARGF REDEF ARGB                CHAR(160);
     1245    18965
     1246    18966    2   DCL P                              PTR;
     1247    18967    2   DCL Q                              PTR;
     1248    18968
     1249    18969    2   DCL I                              SBIN;
     1250    18970    2   DCL MM                             UBIN;
     1251    18971    2   DCL DD                             UBIN;
     1252    18972    2   DCL YY                             UBIN;
     1253    18973    2   DCL FRST                           UBIN;
     1254    18974    2   DCL LAST                           UBIN;
     1255    18975
     1256    18976    2   DCL DIM(0:11) CONSTANT             UBIN BYTE
     1257    18977    2           INIT(31,29,31,30,31,30,31,31,30,31,30,31);
     1258    18978
     1259    18979
     1260    18980        /****
     1261    18981        *
     1262    18982        *   Walk through the parser nodes passed.
     1263    18983        *
     1264    18984        ****/
     1265    18985
     1266    18986    3           DO I=0 TO BLK$->OUT$BLK.NSUBLKS-1;

  18986 10 002635   004707 450000 0                  STZ     I
        10 002636   004023 710000 10                 TRA     s:19321+1

     1267    18987    3              P=BLK$->OUT$BLK.SUBLK$(I);

  18987 10 002637   004703 470400 0                  LDP0    @BLK$
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:152  
        10 002640   000000 471500                    LDP1    0,,PR0
        10 002641   004707 720000 0                  LXL0    I
        10 002642   100003 236110                    LDQ     3,X0,PR1
        10 002643   004705 756000 0                  STQ     P

     1268    18988    4              DO SELECT(P->OUT$BLK.CODE);

  18988 10 002644   004705 473400 0                  LDP3    P
        10 002645   300000 236100                    LDQ     0,,PR3
        10 002646   777777 376007                    ANQ     -1,DL
        10 002647   000153 116007                    CMPQ    107,DL
        10 002650   002725 602000 10                 TNC     s:18988+49
        10 002651   003246 600000 10                 TZE     s:19124
        10 002652   000335 116007                    CMPQ    221,DL
        10 002653   002677 602000 10                 TNC     s:18988+27
        10 002654   003262 600000 10                 TZE     s:19143
        10 002655   000346 116007                    CMPQ    230,DL
        10 002656   002673 602000 10                 TNC     s:18988+23
        10 002657   003370 600000 10                 TZE     s:19181
        10 002660   000360 116007                    CMPQ    240,DL
        10 002661   002667 602000 10                 TNC     s:18988+19
        10 002662   003442 600000 10                 TZE     s:19210
        10 002663   300000 721100                    LXL1    0,,PR3
        10 002664   000361 101003                    CMPX1   241,DU
        10 002665   004022 601000 10                 TNZ     s:19321
        10 002666   003451 710000 10                 TRA     s:19220
        10 002667   300000 721100                    LXL1    0,,PR3
        10 002670   000347 101003                    CMPX1   231,DU
        10 002671   004022 601000 10                 TNZ     s:19321
        10 002672   003377 710000 10                 TRA     s:19191
        10 002673   300000 721100                    LXL1    0,,PR3
        10 002674   000336 101003                    CMPX1   222,DU
        10 002675   004022 601000 10                 TNZ     s:19321
        10 002676   003325 710000 10                 TRA     s:19162
        10 002677   000156 116007                    CMPQ    110,DL
        10 002700   002715 602000 10                 TNC     s:18988+41
        10 002701   003517 600000 10                 TZE     s:19248
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:153  
        10 002702   000311 116007                    CMPQ    201,DL
        10 002703   002711 602000 10                 TNC     s:18988+37
        10 002704   003262 600000 10                 TZE     s:19143
        10 002705   300000 721100                    LXL1    0,,PR3
        10 002706   000334 101003                    CMPX1   220,DU
        10 002707   004022 601000 10                 TNZ     s:19321
        10 002710   003253 710000 10                 TRA     s:19133
        10 002711   300000 721100                    LXL1    0,,PR3
        10 002712   000310 101003                    CMPX1   200,DU
        10 002713   004022 601000 10                 TNZ     s:19321
        10 002714   003253 710000 10                 TRA     s:19133
        10 002715   000155 116007                    CMPQ    109,DL
        10 002716   002721 602000 10                 TNC     s:18988+45
        10 002717   003514 600000 10                 TZE     s:19239
        10 002720   004022 710000 10                 TRA     s:19321
        10 002721   300000 721100                    LXL1    0,,PR3
        10 002722   000154 101003                    CMPX1   108,DU
        10 002723   004022 601000 10                 TNZ     s:19321
        10 002724   003523 710000 10                 TRA     s:19257
        10 002725   000147 116007                    CMPQ    103,DL
        10 002726   002743 602000 10                 TNC     s:18988+63
        10 002727   003122 600000 10                 TZE     s:19065
        10 002730   000151 116007                    CMPQ    105,DL
        10 002731   002737 602000 10                 TNC     s:18988+59
        10 002732   003130 600000 10                 TZE     s:19083
        10 002733   300000 721100                    LXL1    0,,PR3
        10 002734   000152 101003                    CMPX1   106,DU
        10 002735   004022 601000 10                 TNZ     s:19321
        10 002736   003241 710000 10                 TRA     s:19115
        10 002737   300000 721100                    LXL1    0,,PR3
        10 002740   000150 101003                    CMPX1   104,DU
        10 002741   004022 601000 10                 TNZ     s:19321
        10 002742   003125 710000 10                 TRA     s:19074
        10 002743   000145 116007                    CMPQ    101,DL
        10 002744   002752 602000 10                 TNC     s:18988+70
        10 002745   003114 600000 10                 TZE     s:19047
        10 002746   300000 721100                    LXL1    0,,PR3
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:154  
        10 002747   000146 101003                    CMPX1   102,DU
        10 002750   004022 601000 10                 TNZ     s:19321
        10 002751   003117 710000 10                 TRA     s:19056
        10 002752   300000 721100                    LXL1    0,,PR3
        10 002753   000144 101003                    CMPX1   100,DU
        10 002754   004022 601000 10                 TNZ     s:19321
        10 002755   002756 710000 10                 TRA     s:18997

     1269    18989
     1270    18990        /****
     1271    18991        *
     1272    18992        *   Account, name, password (or perversions thereof)
     1273    18993        *
     1274    18994        ****/
     1275    18995
     1276    18996    4                 SELECT(%OPTACCT#);

     1277    18997    5                 DO CASE(P->OUT$BLK.NSUBLKS);

  18997 10 002756   300001 222100                    LDX2    1,,PR3
        10 002757   000004 102003                    CMPX2   4,DU
        10 002760   002762 602012 10                 TNC     s:18997+4,X2
        10 002761   004022 710000 10                 TRA     s:19321
        10 002762   003113 710000 10                 TRA     s:19038
        10 002763   002766 710000 10                 TRA     s:19006
        10 002764   003033 710000 10                 TRA     s:19020
        10 002765   003057 710000 10                 TRA     s:19032

     1278    18998
     1279    18999        /****
     1280    19000        *
     1281    19001        *   Password only or 'foreign logon'
     1282    19002        *
     1283    19003        ****/
     1284    19004
     1285    19005    5                  CASE(1);

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:155  
     1286    19006    5                    Q=P->OUT$BLK.SUBLK$(0);

  19006 10 002766   300003 236100                    LDQ     3,,PR3
        10 002767   004706 756000 0                  STQ     Q

     1287    19007    5                    IF Q->OUT$BLK.CODE=%SUBPASS# THEN

  19007 10 002770   004706 474400 0                  LDP4    Q
        10 002771   400000 723100                    LXL3    0,,PR4
        10 002772   000456 103003                    CMPX3   302,DU
        10 002773   003004 601000 10                 TNZ     s:19010

     1288    19008    5                       ARGB.EPASS=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19008 10 002774   400004 236100                    LDQ     4,,PR4
        10 002775   000033 772000                    QRL     27
        10 002776   000000 624006                    EAX4    0,QL
        10 002777   004704 475400 0                  LDP5    @ARGB
        10 003000   040100 100540                    MLR     fill='040'O
        10 003001   400004 200014                    ADSC9   4,,PR4                   cn=1,n=*X4
        10 003002   500006 000014                    ADSC9   6,,PR5                   cn=0,n=12
        10 003003   004022 710000 10                 TRA     s:19321

     1289    19009    5                    ELSE
     1290    19010    5                       CALL INSERT(ARGF,4,67,'''',SUBSTR(Q->OUT$SYM.TEXT,

  19010 10 003004   004706 470400 0                  LDP0    Q
        10 003005   000004 236100                    LDQ     4,,PR0
        10 003006   000033 772000                    QRL     27
        10 003007   004704 471400 0                  LDP1    @ARGB
        10 003010   000000 620006                    EAX0    0,QL
        10 003011   047000 236003                    LDQ     19968,DU
        10 003012   100001 552140                    STBQ    1,'40'O,PR1
        10 003013   040100 100540                    MLR     fill='040'O
        10 003014   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
        10 003015   100001 200102                    ADSC9   1,,PR1                   cn=1,n=66
        10 003016   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:156  
        10 003017   000022 772000                    QRL     18
        10 003020   000102 116007                    CMPQ    66,DL
        10 003021   003032 603000 10                 TRC     s:19010+22
        10 003022   004730 740000 0                  STX0    PASSWORD+2
        10 003023   777675 620010                    EAX0    -67,X0
        10 003024   777777 660003                    ERX0    -1,DU
        10 003025   004730 235000 0                  LDA     PASSWORD+2
        10 003026   000022 771000                    ARL     18
        10 003027   040145 100400                    MLR     fill='040'O
        10 003030   000141 000001 11                 ADSC9   97                       cn=0,n=1
        10 003031   100001 200010                    ADSC9   1,A,PR1                  cn=1,n=*X0
        10 003032   004022 710000 10                 TRA     s:19321

     1291    19011    5                         0,Q->OUT$SYM.COUNT),'''');
     1292    19012
     1293    19013        /****
     1294    19014        *
     1295    19015        *   Account,name
     1296    19016        *
     1297    19017        ****/
     1298    19018
     1299    19019    5                  CASE(2);

     1300    19020    5                    Q=P->OUT$BLK.SUBLK$(0);

  19020 10 003033   300003 236100                    LDQ     3,,PR3
        10 003034   004706 756000 0                  STQ     Q

     1301    19021    5                    ARGB.ACCT=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19021 10 003035   004706 474400 0                  LDP4    Q
        10 003036   400004 236100                    LDQ     4,,PR4
        10 003037   000033 772000                    QRL     27
        10 003040   000000 623006                    EAX3    0,QL
        10 003041   004704 475400 0                  LDP5    @ARGB
        10 003042   040100 100540                    MLR     fill='040'O
        10 003043   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:157  
        10 003044   500001 000010                    ADSC9   1,,PR5                   cn=0,n=8

     1302    19022    5                    Q=P->OUT$BLK.SUBLK$(1);

  19022 10 003045   300004 236100                    LDQ     4,,PR3
        10 003046   004706 756000 0                  STQ     Q

     1303    19023    5                    ARGB.NAME=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19023 10 003047   004706 471400 0                  LDP1    Q
        10 003050   100004 236100                    LDQ     4,,PR1
        10 003051   000033 772000                    QRL     27
        10 003052   000000 621006                    EAX1    0,QL
        10 003053   040100 100540                    MLR     fill='040'O
        10 003054   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 003055   500003 000014                    ADSC9   3,,PR5                   cn=0,n=12
        10 003056   004022 710000 10                 TRA     s:19321

     1304    19024
     1305    19025        /****
     1306    19026        *
     1307    19027        *   Account,name,password
     1308    19028        *
     1309    19029        ****/
     1310    19030
     1311    19031    5                  CASE(3);

     1312    19032    5                    Q=P->OUT$BLK.SUBLK$(0);

  19032 10 003057   300003 236100                    LDQ     3,,PR3
        10 003060   004706 756000 0                  STQ     Q

     1313    19033    5                    ARGB.ACCT=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19033 10 003061   004706 474400 0                  LDP4    Q
        10 003062   400004 236100                    LDQ     4,,PR4
        10 003063   000033 772000                    QRL     27
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:158  
        10 003064   000000 623006                    EAX3    0,QL
        10 003065   004704 475400 0                  LDP5    @ARGB
        10 003066   040100 100540                    MLR     fill='040'O
        10 003067   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
        10 003070   500001 000010                    ADSC9   1,,PR5                   cn=0,n=8

     1314    19034    5                    Q=P->OUT$BLK.SUBLK$(1);

  19034 10 003071   300004 236100                    LDQ     4,,PR3
        10 003072   004706 756000 0                  STQ     Q

     1315    19035    5                    ARGB.NAME=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19035 10 003073   004706 471400 0                  LDP1    Q
        10 003074   100004 236100                    LDQ     4,,PR1
        10 003075   000033 772000                    QRL     27
        10 003076   000000 621006                    EAX1    0,QL
        10 003077   040100 100540                    MLR     fill='040'O
        10 003100   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 003101   500003 000014                    ADSC9   3,,PR5                   cn=0,n=12

     1316    19036    5                    Q=P->OUT$BLK.SUBLK$(2);

  19036 10 003102   300005 236100                    LDQ     5,,PR3
        10 003103   004706 756000 0                  STQ     Q

     1317    19037    5                    ARGB.EPASS=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19037 10 003104   004706 471400 0                  LDP1    Q
        10 003105   100004 236100                    LDQ     4,,PR1
        10 003106   000033 772000                    QRL     27
        10 003107   000000 621006                    EAX1    0,QL
        10 003110   040100 100540                    MLR     fill='040'O
        10 003111   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 003112   500006 000014                    ADSC9   6,,PR5                   cn=0,n=12

     1318    19038    5                  END;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:159  

  19038 10 003113   004022 710000 10                 TRA     s:19321

     1319    19039
     1320    19040        /****
     1321    19041        *
     1322    19042        *   NLN/NK option
     1323    19043        *
     1324    19044        ****/
     1325    19045
     1326    19046    4                 SELECT(%OPTNLN#);

     1327    19047    4                 OPTS.INP.MISC.NLN='1'B;

  19047 10 003114   000001 236007                    LDQ     1,DL
        10 003115   000022 256000 0                  ORSQ    VW_OPTIONS#+17
        10 003116   004022 710000 10                 TRA     s:19321

     1328    19048
     1329    19049        /****
     1330    19050        *
     1331    19051        *   NSC option
     1332    19052        *
     1333    19053        ****/
     1334    19054
     1335    19055    4                 SELECT(%OPTNSC#);

     1336    19056    4                 OPTS.INP.MISC.NSC='1'B;

  19056 10 003117   000004 236007                    LDQ     4,DL
        10 003120   000022 256000 0                  ORSQ    VW_OPTIONS#+17
        10 003121   004022 710000 10                 TRA     s:19321

     1337    19057
     1338    19058        /****
     1339    19059        *
     1340    19060        *   NFA option
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:160  
     1341    19061        *
     1342    19062        ****/
     1343    19063
     1344    19064    4                 SELECT(%OPTNFA#);

     1345    19065    4                 OPTS.INP.MISC.NFA='1'B;

  19065 10 003122   000002 236007                    LDQ     2,DL
        10 003123   000022 256000 0                  ORSQ    VW_OPTIONS#+17
        10 003124   004022 710000 10                 TRA     s:19321

     1346    19066
     1347    19067        /****
     1348    19068        *
     1349    19069        *   TRAN/X option
     1350    19070        *
     1351    19071        ****/
     1352    19072
     1353    19073    4                 SELECT(%OPTTRAN#);

     1354    19074    4                 OPTS.INP.MISC.TRAN='1'B;

  19074 10 003125   000010 236007                    LDQ     8,DL
        10 003126   000022 256000 0                  ORSQ    VW_OPTIONS#+17
        10 003127   004022 710000 10                 TRA     s:19321

     1355    19075
     1356    19076        /****
     1357    19077        *
     1358    19078        *   Record selection option
     1359    19079        *
     1360    19080        ****/
     1361    19081
     1362    19082    4                 SELECT(%OPTRECS#);

     1363    19083    5                 IF OPTX>=LENGTHC(OPTS.OPTSRECS)/80 OR RECX>9 THEN DO;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:161  
  19083 10 003130   002425 235000 0                  LDA     OPTX
        10 003131   000017 115007                    CMPA    15,DL
        10 003132   003136 605000 10                 TPL     s:19084
        10 003133   002426 236000 0                  LDQ     RECX
        10 003134   000011 116007                    CMPQ    9,DL
        10 003135   003144 604400 10                 TMOZ    s:19087

     1364    19084    5                    CALL XUR$ERRMSG(%E$VWM_TMO);

  19084 10 003136   000143 630400 11                 EPPR0   99
        10 003137   000000 631400 11                 EPPR1   0
        10 003140   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003141   000000 011000                    NOP     0

     1365    19085    5                    ALTRETURN;

  19085 10 003142   004702 221200 0                  LDX1  ! ONCE+1
        10 003143   000000 702211                    TSX2  ! 0,X1

     1366    19086    5                    END;
     1367    19087    4                 OPT$=ADDR(OPTS.OPTSRECS(OPTX));

  19087 10 003144   002425 236000 0                  LDQ     OPTX
        10 003145   000024 402003                    MPY     20,DU
        10 003146   000144 036000 11                 ADLQ    100
        10 003147   002440 756000 0                  STQ     OPT$

     1368    19088    4                 OPT$->OPTSRECS.SUB='RECS';

  19088 10 003150   002440 470400 0                  LDP0    OPT$
        10 003151   040100 100400                    MLR     fill='040'O
        10 003152   000214 000004 3                  ADSC9   BADDIES+51               cn=0,n=4
        10 003153   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4

     1369    19089    4                 Q=P->OUT$BLK.SUBLK$(0);

  19089 10 003154   004705 471400 0                  LDP1    P
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:162  
        10 003155   100003 236100                    LDQ     3,,PR1
        10 003156   004706 756000 0                  STQ     Q

     1370    19090    4                 CALL CHARBIN(FRST,SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT));

  19090 10 003157   004706 473400 0                  LDP3    Q
        10 003160   300004 236100                    LDQ     4,,PR3
        10 003161   000033 772000                    QRL     27
        10 003162   000000 620006                    EAX0    0,QL
        10 003163   000000 305540                    DTB
        10 003164   300004 230010                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X0
        10 003165   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 003166   004731 235000 0                  LDA     PASSWORD+3
        10 003167   004713 755000 0                  STA     FRST

     1371    19091    4                 IF P->OUT$BLK.NSUBLKS=1 THEN

  19091 10 003170   100001 220100                    LDX0    1,,PR1
        10 003171   000001 100003                    CMPX0   1,DU
        10 003172   003175 601000 10                 TNZ     s:19094

     1372    19092    4                    LAST=FRST;

  19092 10 003173   004714 755000 0                  STA     LAST
        10 003174   003210 710000 10                 TRA     s:19098

     1373    19093    5                 ELSE DO;

     1374    19094    5                    Q=P->OUT$BLK.SUBLK$(1);

  19094 10 003175   100004 236100                    LDQ     4,,PR1
        10 003176   004706 756000 0                  STQ     Q

     1375    19095    5                    CALL CHARBIN(LAST,SUBSTR(Q->OUT$SYM.TEXT,0,

  19095 10 003177   004706 473400 0                  LDP3    Q
        10 003200   300004 236100                    LDQ     4,,PR3
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:163  
        10 003201   000033 772000                    QRL     27
        10 003202   000000 621006                    EAX1    0,QL
        10 003203   000000 305540                    DTB
        10 003204   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
        10 003205   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 003206   004731 236000 0                  LDQ     PASSWORD+3
        10 003207   004714 756000 0                  STQ     LAST

     1376    19096    5                      Q->OUT$SYM.COUNT));
     1377    19097    5                    END;

     1378    19098    4                 IF LAST<FRST THEN

  19098 10 003210   004714 236000 0                  LDQ     LAST
        10 003211   004713 116000 0                  CMPQ    FRST
        10 003212   003220 603000 10                 TRC     s:19101

     1379    19099    4                    CALL XUR$ERRMSG(%E$VWM_RNG);

  19099 10 003213   000146 630400 11                 EPPR0   102
        10 003214   000000 631400 11                 EPPR1   0
        10 003215   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003216   000000 011000                    NOP     0
        10 003217   004022 710000 10                 TRA     s:19321

     1380    19100    5                 ELSE DO;

     1381    19101    5                    CALL BINCHAR(OPT$->OPTSRECS.FRST,FRST);

  19101 10 003220   000044 773000                    LRL     36
        10 003221   004730 757000 0                  STAQ    PASSWORD+2
        10 003222   000100 301400                    BTD
        10 003223   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 003224   000002 030012                    NDSC9   2,,PR0                   cn=0,s=nosgn,sf=0,n=10

     1382    19102    5                    CALL BINCHAR(OPT$->OPTSRECS.LAST,LAST);

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:164  
  19102 10 003225   004714 235000 0                  LDA     LAST
        10 003226   000044 773000                    LRL     36
        10 003227   004730 757000 0                  STAQ    PASSWORD+2
        10 003230   000100 301400                    BTD
        10 003231   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 003232   000004 430012                    NDSC9   4,,PR0                   cn=2,s=nosgn,sf=0,n=10

     1383    19103    5                    OPT$->OPTSRECS.CMD='OPTS';

  19103 10 003233   040100 100400                    MLR     fill='040'O
        10 003234   000215 000004 3                  ADSC9   BADDIES+52               cn=0,n=4
        10 003235   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1384    19104    5                    OPTX=OPTX+1;

  19104 10 003236   002425 054000 0                  AOS     OPTX

     1385    19105    5                    RECX=RECX+1;

  19105 10 003237   002426 054000 0                  AOS     RECX

     1386    19106    5                    END;

  19106 10 003240   004022 710000 10                 TRA     s:19321

     1387    19107
     1388    19108        /****
     1389    19109        *
     1390    19110        *   Key selection option (not yet implemented)
     1391    19111        *
     1392    19112        ****/
     1393    19113
     1394    19114    4                 SELECT(%OPTKEYS#);

     1395    19115    4                 CALL XUR$ERRMSG(%E$VWM_NYI);

  19115 10 003241   000150 630400 11                 EPPR0   104
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:165  
        10 003242   000000 631400 11                 EPPR1   0
        10 003243   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003244   000000 011000                    NOP     0
        10 003245   004022 710000 10                 TRA     s:19321

     1396    19116
     1397    19117        /****
     1398    19118        *
     1399    19119        *   Edit key selection option (not yet implemented)
     1400    19120        *
     1401    19121        ****/
     1402    19122
     1403    19123    4                 SELECT(%OPTEDIT#);

     1404    19124    4                 CALL XUR$ERRMSG(%E$VWM_NYI);

  19124 10 003246   000150 630400 11                 EPPR0   104
        10 003247   000000 631400 11                 EPPR1   0
        10 003250   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003251   000000 011000                    NOP     0
        10 003252   004022 710000 10                 TRA     s:19321

     1405    19125
     1406    19126        /****
     1407    19127        *
     1408    19128        *   NMA/NMTI option
     1409    19129        *
     1410    19130        ****/
     1411    19131
     1412    19132    4                 SELECT(%SUBNMA#,%SUBNMTI#);

     1413    19133    4                 CARD(8)=' ';

  19133 10 003253   040000 100400                    MLR     fill='040'O
        10 003254   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003255   000241 000120 0                  ADSC9   VW_OPTIONS#+160          cn=0,n=80

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:166  
     1414    19134    4                 CARD(9)=' ';

  19134 10 003256   040000 100400                    MLR     fill='040'O
        10 003257   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003260   000265 000120 0                  ADSC9   VW_OPTIONS#+180          cn=0,n=80
        10 003261   004022 710000 10                 TRA     s:19321

     1415    19135
     1416    19136        /****
     1417    19137        *
     1418    19138        *   MAIL/MTI option
     1419    19139        *
     1420    19140        ****/
     1421    19141
     1422    19142    4                 SELECT(%SUBMA#,%SUBMTI#);

     1423    19143    4                 OPTS.MAILINIT.WHO='I';

  19143 10 003262   111000 236003                    LDQ     37376,DU
        10 003263   000242 552040 0                  STBQ    VW_OPTIONS#+161,'40'O

     1424    19144    4                 CARD(9)=' ';

  19144 10 003264   040000 100400                    MLR     fill='040'O
        10 003265   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003266   000265 000120 0                  ADSC9   VW_OPTIONS#+180          cn=0,n=80

     1425    19145    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;

  19145 10 003267   300001 221100                    LDX1    1,,PR3
        10 003270   004022 600000 10                 TZE     s:19321

     1426    19146    5                    Q=P->OUT$BLK.SUBLK$(0);

  19146 10 003271   300003 236100                    LDQ     3,,PR3
        10 003272   004706 756000 0                  STQ     Q

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:167  
     1427    19147    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;

  19147 10 003273   004706 471400 0                  LDP1    Q
        10 003274   100004 236100                    LDQ     4,,PR1
        10 003275   777000 316003                    CANQ    -512,DU
        10 003276   003303 600000 10                 TZE     s:19148
        10 003277   100004 236100                    LDQ     4,,PR1
        10 003300   777000 376003                    ANQ     -512,DU
        10 003301   120000 116003                    CMPQ    40960,DU
        10 003302   003311 602000 10                 TNC     s:19151

     1428    19148    6                       CALL XUR$ERRMSG(%E$VWM_IML);

  19148 10 003303   000152 630400 11                 EPPR0   106
        10 003304   000000 631400 11                 EPPR1   0
        10 003305   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003306   000000 011000                    NOP     0

     1429    19149    6                       ALTRETURN;

  19149 10 003307   004702 221200 0                  LDX1  ! ONCE+1
        10 003310   000000 702211                    TSX2  ! 0,X1

     1430    19150    6                       END;
     1431    19151    5                    OPTS.MAILINIT.L=ASCBIN('/')+Q->OUT$SYM.COUNT;

  19151 10 003311   100004 236100                    LDQ     4,,PR1
        10 003312   000033 772000                    QRL     27
        10 003313   000057 036007                    ADLQ    47,DL
        10 003314   000033 736000                    QLS     27
        10 003315   000265 552040 0                  STBQ    VW_OPTIONS#+180,'40'O

     1432    19152    5                    OPTS.MAILINIT.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19152 10 003316   100004 236100                    LDQ     4,,PR1
        10 003317   000033 772000                    QRL     27
        10 003320   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:168  
        10 003321   040000 100540                    MLR     fill='040'O
        10 003322   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 003323   000265 200117 0                  ADSC9   VW_OPTIONS#+180          cn=1,n=79

     1433    19153    5                    END;

  19153 10 003324   004022 710000 10                 TRA     s:19321

     1434    19154
     1435    19155        /****
     1436    19156        *
     1437    19157        *   EMTI option (treated as MTI)
     1438    19158        *
     1439    19159        ****/
     1440    19160
     1441    19161    4                 SELECT(%SUBEMTI#);

     1442    19162    4                 OPTS.MAILINIT.WHO='E';

  19162 10 003325   105000 236003                    LDQ     35328,DU
        10 003326   000242 552040 0                  STBQ    VW_OPTIONS#+161,'40'O

     1443    19163    4                 CARD(9)=' ';

  19163 10 003327   040000 100400                    MLR     fill='040'O
        10 003330   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003331   000265 000120 0                  ADSC9   VW_OPTIONS#+180          cn=0,n=80

     1444    19164    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;

  19164 10 003332   300001 221100                    LDX1    1,,PR3
        10 003333   004022 600000 10                 TZE     s:19321

     1445    19165    5                    Q=P->OUT$BLK.SUBLK$(0);

  19165 10 003334   300003 236100                    LDQ     3,,PR3
        10 003335   004706 756000 0                  STQ     Q
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:169  

     1446    19166    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;

  19166 10 003336   004706 471400 0                  LDP1    Q
        10 003337   100004 236100                    LDQ     4,,PR1
        10 003340   777000 316003                    CANQ    -512,DU
        10 003341   003346 600000 10                 TZE     s:19167
        10 003342   100004 236100                    LDQ     4,,PR1
        10 003343   777000 376003                    ANQ     -512,DU
        10 003344   120000 116003                    CMPQ    40960,DU
        10 003345   003354 602000 10                 TNC     s:19170

     1447    19167    6                       CALL XUR$ERRMSG(%E$VWM_IML);

  19167 10 003346   000152 630400 11                 EPPR0   106
        10 003347   000000 631400 11                 EPPR1   0
        10 003350   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003351   000000 011000                    NOP     0

     1448    19168    6                       ALTRETURN;

  19168 10 003352   004702 221200 0                  LDX1  ! ONCE+1
        10 003353   000000 702211                    TSX2  ! 0,X1

     1449    19169    6                       END;
     1450    19170    5                    OPTS.MAILINIT.L=ASCBIN('/')+Q->OUT$SYM.COUNT;

  19170 10 003354   100004 236100                    LDQ     4,,PR1
        10 003355   000033 772000                    QRL     27
        10 003356   000057 036007                    ADLQ    47,DL
        10 003357   000033 736000                    QLS     27
        10 003360   000265 552040 0                  STBQ    VW_OPTIONS#+180,'40'O

     1451    19171    5                    OPTS.MAILINIT.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19171 10 003361   100004 236100                    LDQ     4,,PR1
        10 003362   000033 772000                    QRL     27
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:170  
        10 003363   000000 621006                    EAX1    0,QL
        10 003364   040000 100540                    MLR     fill='040'O
        10 003365   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 003366   000265 200117 0                  ADSC9   VW_OPTIONS#+180          cn=1,n=79

     1452    19172    5                    END;

  19172 10 003367   004022 710000 10                 TRA     s:19321

     1453    19173
     1454    19174        /****
     1455    19175        *
     1456    19176        *   NMTS option
     1457    19177        *
     1458    19178        ****/
     1459    19179
     1460    19180    4                 SELECT(%SUBNMTS#);

     1461    19181    4                 CARD(4)=' ';

  19181 10 003370   040000 100400                    MLR     fill='040'O
        10 003371   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003372   000121 000120 0                  ADSC9   VW_OPTIONS#+80           cn=0,n=80

     1462    19182    4                 CARD(5)=' ';

  19182 10 003373   040000 100400                    MLR     fill='040'O
        10 003374   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003375   000145 000120 0                  ADSC9   VW_OPTIONS#+100          cn=0,n=80
        10 003376   004022 710000 10                 TRA     s:19321

     1463    19183
     1464    19184        /****
     1465    19185        *
     1466    19186        *   MTS option
     1467    19187        *
     1468    19188        ****/
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:171  
     1469    19189
     1470    19190    4                 SELECT(%SUBMTS#);

     1471    19191    4                 OPTS.MAILSNDR.WHO='S';

  19191 10 003377   123000 236003                    LDQ     42496,DU
        10 003400   000122 552040 0                  STBQ    VW_OPTIONS#+81,'40'O

     1472    19192    4                 CARD(5)=' ';

  19192 10 003401   040000 100400                    MLR     fill='040'O
        10 003402   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003403   000145 000120 0                  ADSC9   VW_OPTIONS#+100          cn=0,n=80

     1473    19193    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;

  19193 10 003404   300001 221100                    LDX1    1,,PR3
        10 003405   004022 600000 10                 TZE     s:19321

     1474    19194    5                    Q=P->OUT$BLK.SUBLK$(0);

  19194 10 003406   300003 236100                    LDQ     3,,PR3
        10 003407   004706 756000 0                  STQ     Q

     1475    19195    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;

  19195 10 003410   004706 471400 0                  LDP1    Q
        10 003411   100004 236100                    LDQ     4,,PR1
        10 003412   777000 316003                    CANQ    -512,DU
        10 003413   003420 600000 10                 TZE     s:19196
        10 003414   100004 236100                    LDQ     4,,PR1
        10 003415   777000 376003                    ANQ     -512,DU
        10 003416   120000 116003                    CMPQ    40960,DU
        10 003417   003426 602000 10                 TNC     s:19199

     1476    19196    6                       CALL XUR$ERRMSG(%E$VWM_SML);

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:172  
  19196 10 003420   000154 630400 11                 EPPR0   108
        10 003421   000000 631400 11                 EPPR1   0
        10 003422   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003423   000000 011000                    NOP     0

     1477    19197    6                       ALTRETURN;

  19197 10 003424   004702 221200 0                  LDX1  ! ONCE+1
        10 003425   000000 702211                    TSX2  ! 0,X1

     1478    19198    6                       END;
     1479    19199    5                    OPTS.MAILSNDR.L=ASCBIN('/')+Q->OUT$SYM.COUNT;

  19199 10 003426   100004 236100                    LDQ     4,,PR1
        10 003427   000033 772000                    QRL     27
        10 003430   000057 036007                    ADLQ    47,DL
        10 003431   000033 736000                    QLS     27
        10 003432   000145 552040 0                  STBQ    VW_OPTIONS#+100,'40'O

     1480    19200    5                    OPTS.MAILSNDR.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19200 10 003433   100004 236100                    LDQ     4,,PR1
        10 003434   000033 772000                    QRL     27
        10 003435   000000 621006                    EAX1    0,QL
        10 003436   040000 100540                    MLR     fill='040'O
        10 003437   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 003440   000145 200117 0                  ADSC9   VW_OPTIONS#+100          cn=1,n=79

     1481    19201    5                    END;

  19201 10 003441   004022 710000 10                 TRA     s:19321

     1482    19202
     1483    19203        /****
     1484    19204        *
     1485    19205        *   NMTR option
     1486    19206        *
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:173  
     1487    19207        ****/
     1488    19208
     1489    19209    4                 SELECT(%SUBNMTR#);

     1490    19210    4                 CARD(6)=' ';

  19210 10 003442   040000 100400                    MLR     fill='040'O
        10 003443   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003444   000171 000120 0                  ADSC9   VW_OPTIONS#+120          cn=0,n=80

     1491    19211    4                 CARD(7)=' ';

  19211 10 003445   040000 100400                    MLR     fill='040'O
        10 003446   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003447   000215 000120 0                  ADSC9   VW_OPTIONS#+140          cn=0,n=80
        10 003450   004022 710000 10                 TRA     s:19321

     1492    19212
     1493    19213        /****
     1494    19214        *
     1495    19215        *   MTR option
     1496    19216        *
     1497    19217        ****/
     1498    19218
     1499    19219    4                 SELECT(%SUBMTR#);

     1500    19220    4                 OPTS.MAILRCVR.WHO='R';

  19220 10 003451   122000 236003                    LDQ     41984,DU
        10 003452   000172 552040 0                  STBQ    VW_OPTIONS#+121,'40'O

     1501    19221    4                 CARD(7)=' ';

  19221 10 003453   040000 100400                    MLR     fill='040'O
        10 003454   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 003455   000215 000120 0                  ADSC9   VW_OPTIONS#+140          cn=0,n=80

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:174  
     1502    19222    5                 IF P->OUT$BLK.NSUBLKS>0 THEN DO;

  19222 10 003456   300001 221100                    LDX1    1,,PR3
        10 003457   004022 600000 10                 TZE     s:19321

     1503    19223    5                    Q=P->OUT$BLK.SUBLK$(0);

  19223 10 003460   300003 236100                    LDQ     3,,PR3
        10 003461   004706 756000 0                  STQ     Q

     1504    19224    6                    IF Q->OUT$SYM.COUNT<1 OR Q->OUT$SYM.COUNT>79 THEN DO;

  19224 10 003462   004706 471400 0                  LDP1    Q
        10 003463   100004 236100                    LDQ     4,,PR1
        10 003464   777000 316003                    CANQ    -512,DU
        10 003465   003472 600000 10                 TZE     s:19225
        10 003466   100004 236100                    LDQ     4,,PR1
        10 003467   777000 376003                    ANQ     -512,DU
        10 003470   120000 116003                    CMPQ    40960,DU
        10 003471   003500 602000 10                 TNC     s:19228

     1505    19225    6                       CALL XUR$ERRMSG(%E$VWM_RML);

  19225 10 003472   000156 630400 11                 EPPR0   110
        10 003473   000000 631400 11                 EPPR1   0
        10 003474   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003475   000000 011000                    NOP     0

     1506    19226    6                       ALTRETURN;

  19226 10 003476   004702 221200 0                  LDX1  ! ONCE+1
        10 003477   000000 702211                    TSX2  ! 0,X1

     1507    19227    6                       END;
     1508    19228    5                    OPTS.MAILRCVR.L=ASCBIN('/')+Q->OUT$SYM.COUNT;

  19228 10 003500   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:175  
        10 003501   000033 772000                    QRL     27
        10 003502   000057 036007                    ADLQ    47,DL
        10 003503   000033 736000                    QLS     27
        10 003504   000215 552040 0                  STBQ    VW_OPTIONS#+140,'40'O

     1509    19229    5                    OPTS.MAILRCVR.MAILBOX=SUBSTR(Q->OUT$SYM.TEXT,0,Q->OUT$SYM.COUNT);

  19229 10 003505   100004 236100                    LDQ     4,,PR1
        10 003506   000033 772000                    QRL     27
        10 003507   000000 621006                    EAX1    0,QL
        10 003510   040000 100540                    MLR     fill='040'O
        10 003511   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
        10 003512   000215 200117 0                  ADSC9   VW_OPTIONS#+140          cn=1,n=79

     1510    19230    5                    END;

  19230 10 003513   004022 710000 10                 TRA     s:19321

     1511    19231
     1512    19232        /****
     1513    19233        *
     1514    19234        *   DDNF option
     1515    19235        *
     1516    19236        ****/
     1517    19237
     1518    19238    4                 SELECT(%OPTDDN#);

     1519    19239    4                 OPTS.OUT.MISC.DDNF='1'B;

  19239 10 003514   000100 236007                    LDQ     64,DL
        10 003515   000072 256000 0                  ORSQ    VW_OPTIONS#+57
        10 003516   004022 710000 10                 TRA     s:19321

     1520    19240
     1521    19241        /****
     1522    19242        *
     1523    19243        *   PROMPT option
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:176  
     1524    19244        *
     1525    19245        ****/
     1526    19246
     1527    19247    4                 SELECT(%OPTPROMPT#);

     1528    19248    4                 ARGB.MISC.PROMPT='1'B;

  19248 10 003517   004704 474400 0                  LDP4    @ARGB
        10 003520   000400 236007                    LDQ     256,DL
        10 003521   400021 256100                    ORSQ    17,,PR4
        10 003522   004022 710000 10                 TRA     s:19321

     1529    19249
     1530    19250        /****
     1531    19251        *
     1532    19252        *   DATE option
     1533    19253        *
     1534    19254        ****/
     1535    19255
     1536    19256    4                 SELECT(%OPTDATE#);

     1537    19257    5                 IF OPTX>=LENGTHC(OPTS.OPTSRECS)/80 THEN DO;

  19257 10 003523   002425 235000 0                  LDA     OPTX
        10 003524   000017 115007                    CMPA    15,DL
        10 003525   003534 604000 10                 TMI     s:19261

     1538    19258    5                    CALL XUR$ERRMSG(%E$VWM_TMO);

  19258 10 003526   000143 630400 11                 EPPR0   99
        10 003527   000000 631400 11                 EPPR1   0
        10 003530   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003531   000000 011000                    NOP     0

     1539    19259    5                    ALTRETURN;

  19259 10 003532   004702 221200 0                  LDX1  ! ONCE+1
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:177  
        10 003533   000000 702211                    TSX2  ! 0,X1

     1540    19260    5                    END;
     1541    19261    4                 OPT$=ADDR(OPTS.OPTSRECS(OPTX));

  19261 10 003534   002425 236000 0                  LDQ     OPTX
        10 003535   000024 402003                    MPY     20,DU
        10 003536   000144 036000 11                 ADLQ    100
        10 003537   002440 756000 0                  STQ     OPT$

     1542    19262    4                 OPT$->OPTSDATE.SUB='DATE';

  19262 10 003540   002440 474400 0                  LDP4    OPT$
        10 003541   040100 100400                    MLR     fill='040'O
        10 003542   000216 000004 3                  ADSC9   BADDIES+53               cn=0,n=4
        10 003543   400001 000004                    ADSC9   1,,PR4                   cn=0,n=4

     1543    19263
     1544    19264    4                 Q=P->OUT$BLK.SUBLK$(0);

  19264 10 003544   300003 236100                    LDQ     3,,PR3
        10 003545   004706 756000 0                  STQ     Q

     1545    19265    4                 IF Q->OUT$BLK.CODE=%SUBCRE# THEN

  19265 10 003546   004706 471400 0                  LDP1    Q
        10 003547   100000 721100                    LXL1    0,,PR1
        10 003550   000372 101003                    CMPX1   250,DU
        10 003551   003556 601000 10                 TNZ     s:19268

     1546    19266    4                    OPT$->OPTSDATE.WHICH='C';

  19266 10 003552   040100 100400                    MLR     fill='040'O
        10 003553   000157 000001 11                 ADSC9   111                      cn=0,n=1
        10 003554   400002 000001                    ADSC9   2,,PR4                   cn=0,n=1
        10 003555   003561 710000 10                 TRA     s:19270

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:178  
     1547    19267    4                 ELSE
     1548    19268    4                    OPT$->OPTSDATE.WHICH='M';

  19268 10 003556   040100 100400                    MLR     fill='040'O
        10 003557   000160 000001 11                 ADSC9   112                      cn=0,n=1
        10 003560   400002 000001                    ADSC9   2,,PR4                   cn=0,n=1

     1549    19269
     1550    19270    4                 Q=P->OUT$BLK.SUBLK$(1);

  19270 10 003561   300004 236100                    LDQ     4,,PR3
        10 003562   004706 756000 0                  STQ     Q

     1551    19271    5                 DO SELECT(Q->OUT$BLK.CODE);

  19271 10 003563   004706 471400 0                  LDP1    Q
        10 003564   100000 236100                    LDQ     0,,PR1
        10 003565   777777 376007                    ANQ     -1,DL
        10 003566   000624 116007                    CMPQ    404,DL
        10 003567   003600 602000 10                 TNC     s:19271+13
        10 003570   003627 600000 10                 TZE     s:19279
        10 003571   000625 116007                    CMPQ    405,DL
        10 003572   003642 602000 10                 TNC     s:19286
        10 003573   003633 600000 10                 TZE     s:19281
        10 003574   100000 721100                    LXL1    0,,PR1
        10 003575   000626 101003                    CMPX1   406,DU
        10 003576   003642 601000 10                 TNZ     s:19286
        10 003577   003637 710000 10                 TRA     s:19283
        10 003600   000622 116007                    CMPQ    402,DL
        10 003601   003607 602000 10                 TNC     s:19271+20
        10 003602   003617 600000 10                 TZE     s:19275
        10 003603   100000 721100                    LXL1    0,,PR1
        10 003604   000623 101003                    CMPX1   403,DU
        10 003605   003642 601000 10                 TNZ     s:19286
        10 003606   003623 710000 10                 TRA     s:19277
        10 003607   100000 721100                    LXL1    0,,PR1
        10 003610   000621 101003                    CMPX1   401,DU
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:179  
        10 003611   003642 601000 10                 TNZ     s:19286
        10 003612   003613 710000 10                 TRA     s:19273

     1552    19272    5                    SELECT(%RELGT#);

     1553    19273    5                    OPT$->OPTSDATE.REL='GT';

  19273 10 003613   040100 100400                    MLR     fill='040'O
        10 003614   000217 000002 3                  ADSC9   BADDIES+54               cn=0,n=2
        10 003615   400002 200002                    ADSC9   2,,PR4                   cn=1,n=2
        10 003616   003642 710000 10                 TRA     s:19286

     1554    19274    5                    SELECT(%RELEQ#);

     1555    19275    5                    OPT$->OPTSDATE.REL='EQ';

  19275 10 003617   040100 100400                    MLR     fill='040'O
        10 003620   000220 000002 3                  ADSC9   BADDIES+55               cn=0,n=2
        10 003621   400002 200002                    ADSC9   2,,PR4                   cn=1,n=2
        10 003622   003642 710000 10                 TRA     s:19286

     1556    19276    5                    SELECT(%RELGE#);

     1557    19277    5                    OPT$->OPTSDATE.REL='GE';

  19277 10 003623   040100 100400                    MLR     fill='040'O
        10 003624   000221 000002 3                  ADSC9   BADDIES+56               cn=0,n=2
        10 003625   400002 200002                    ADSC9   2,,PR4                   cn=1,n=2
        10 003626   003642 710000 10                 TRA     s:19286

     1558    19278    5                    SELECT(%RELLT#);

     1559    19279    5                    OPT$->OPTSDATE.REL='LT';

  19279 10 003627   040100 100400                    MLR     fill='040'O
        10 003630   000203 000002 3                  ADSC9   BADDIES+42               cn=0,n=2
        10 003631   400002 200002                    ADSC9   2,,PR4                   cn=1,n=2
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:180  
        10 003632   003642 710000 10                 TRA     s:19286

     1560    19280    5                    SELECT(%RELNE#);

     1561    19281    5                    OPT$->OPTSDATE.REL='NE';

  19281 10 003633   040100 100400                    MLR     fill='040'O
        10 003634   000222 000002 3                  ADSC9   BADDIES+57               cn=0,n=2
        10 003635   400002 200002                    ADSC9   2,,PR4                   cn=1,n=2
        10 003636   003642 710000 10                 TRA     s:19286

     1562    19282    5                    SELECT(%RELLE#);

     1563    19283    5                    OPT$->OPTSDATE.REL='LE';

  19283 10 003637   040100 100400                    MLR     fill='040'O
        10 003640   000223 000002 3                  ADSC9   BADDIES+58               cn=0,n=2
        10 003641   400002 200002                    ADSC9   2,,PR4                   cn=1,n=2

     1564    19284    5                    END;

     1565    19285
     1566    19286    4                 Q=P->OUT$BLK.SUBLK$(2);

  19286 10 003642   300005 236100                    LDQ     5,,PR3
        10 003643   004706 756000 0                  STQ     Q

     1567    19287    4                 IF Q->OUT$BLK.CODE=%WHNYDY# THEN

  19287 10 003644   004706 471400 0                  LDP1    Q
        10 003645   100000 721100                    LXL1    0,,PR1
        10 003646   000635 101003                    CMPX1   413,DU
        10 003647   003654 601000 10                 TNZ     s:19289

     1568    19288    4                    OPT$->OPTSDATE.UTS='YESTERDAY';

  19288 10 003650   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:181  
        10 003651   000224 000011 3                  ADSC9   BADDIES+59               cn=0,n=9
        10 003652   400002 600013                    ADSC9   2,,PR4                   cn=3,n=11
        10 003653   004015 710000 10                 TRA     s:19311

     1569    19289    4                 ELSE IF Q->OUT$BLK.CODE=%WHNTDY# THEN

  19289 10 003654   000634 101003                    CMPX1   412,DU
        10 003655   003662 601000 10                 TNZ     s:19291

     1570    19290    4                       OPT$->OPTSDATE.UTS='TODAY';

  19290 10 003656   040100 100400                    MLR     fill='040'O
        10 003657   000227 000005 3                  ADSC9   BADDIES+62               cn=0,n=5
        10 003660   400002 600013                    ADSC9   2,,PR4                   cn=3,n=11
        10 003661   004015 710000 10                 TRA     s:19311

     1571    19291    4                    ELSE IF Q->OUT$BLK.CODE=%WHNGDS# THEN

  19291 10 003662   000633 101003                    CMPX1   411,DU
        10 003663   003677 601000 10                 TNZ     s:19294

     1572    19292    4                         CALL CONCAT(OPT$->OPTSDATE.UTS,'-',SUBSTR(Q->OUT$BLK.SUBLK$(0
             19292                                   )

  19292 10 003664   100003 475500                    LDP5    3,,PR1
        10 003665   500004 236100                    LDQ     4,,PR5
        10 003666   000033 772000                    QRL     27
        10 003667   040100 100400                    MLR     fill='040'O
        10 003670   000161 000001 11                 ADSC9   113                      cn=0,n=1
        10 003671   400002 600001                    ADSC9   2,,PR4                   cn=3,n=1
        10 003672   000000 621006                    EAX1    0,QL
        10 003673   040100 100540                    MLR     fill='040'O
        10 003674   500004 200011                    ADSC9   4,,PR5                   cn=1,n=*X1
        10 003675   400003 000012                    ADSC9   3,,PR4                   cn=0,n=10
        10 003676   004015 710000 10                 TRA     s:19311

     1573    19293    4                            ->OUT$SYM.TEXT,0,Q->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT));
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:182  
     1574    19294    5                       ELSE IF Q->OUT$BLK.CODE=%WHNDAT# THEN DO;

  19294 10 003677   000632 101003                    CMPX1   410,DU
        10 003700   004015 601000 10                 TNZ     s:19311

     1575    19295    5                            CALL CHARBIN(MM,SUBSTR(Q->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,

  19295 10 003701   100003 475500                    LDP5    3,,PR1
        10 003702   500004 236100                    LDQ     4,,PR5
        10 003703   000033 772000                    QRL     27
        10 003704   000000 622006                    EAX2    0,QL
        10 003705   000000 305540                    DTB
        10 003706   500004 230012                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X2
        10 003707   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 003710   004731 235000 0                  LDA     PASSWORD+3
        10 003711   004710 755000 0                  STA     MM

     1576    19296    5                               0,Q->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT));
     1577    19297    5                            CALL CHARBIN(DD,SUBSTR(Q->OUT$BLK.SUBLK$(1)->OUT$SYM.TEXT,

  19297 10 003712   100004 475500                    LDP5    4,,PR1
        10 003713   500004 236100                    LDQ     4,,PR5
        10 003714   000033 772000                    QRL     27
        10 003715   000000 621006                    EAX1    0,QL
        10 003716   000000 305540                    DTB
        10 003717   500004 230011                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X1
        10 003720   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 003721   004731 236000 0                  LDQ     PASSWORD+3
        10 003722   004711 756000 0                  STQ     DD

     1578    19298    5                               0,Q->OUT$BLK.SUBLK$(1)->OUT$SYM.COUNT));
     1579    19299    5                            CALL CHARBIN(YY,SUBSTR(Q->OUT$BLK.SUBLK$(2)->OUT$SYM.TEXT,

  19299 10 003723   100005 475500                    LDP5    5,,PR1
        10 003724   500004 236100                    LDQ     4,,PR5
        10 003725   000033 772000                    QRL     27
        10 003726   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:183  
        10 003727   000000 305540                    DTB
        10 003730   500004 230011                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X1
        10 003731   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 003732   004731 236000 0                  LDQ     PASSWORD+3
        10 003733   004712 756000 0                  STQ     YY

     1580    19300    5                               0,Q->OUT$BLK.SUBLK$(2)->OUT$SYM.COUNT));
     1581    19301    5                             IF MM<1 OR MM>12 OR DD<1 OR DD>DIM(MM-1) OR YY>99 OR

  19301 10 003734   000000 115003                    CMPA    0,DU
        10 003735   003767 600000 10                 TZE     s:19304
        10 003736   000015 115007                    CMPA    13,DL
        10 003737   003767 603000 10                 TRC     s:19304
        10 003740   004711 235000 0                  LDA     DD
        10 003741   003767 600000 10                 TZE     s:19304
        10 003742   004710 721000 0                  LXL1    MM
        10 003743   000114 236011 3                  LDQ     UPPERS+31,X1
        10 003744   000033 772000                    QRL     27
        10 003745   004711 116000 0                  CMPQ    DD
        10 003746   003767 602000 10                 TNC     s:19304
        10 003747   004712 235000 0                  LDA     YY
        10 003750   000144 115007                    CMPA    100,DL
        10 003751   003767 603000 10                 TRC     s:19304
        10 003752   000116 115007                    CMPA    78,DL
        10 003753   003756 603000 10                 TRC     s:19301+18
        10 003754   000025 115007                    CMPA    21,DL
        10 003755   003767 603000 10                 TRC     s:19304
        10 003756   004710 235000 0                  LDA     MM
        10 003757   000002 115007                    CMPA    2,DL
        10 003760   003775 601000 10                 TNZ     s:19307
        10 003761   004711 235000 0                  LDA     DD
        10 003762   000035 115007                    CMPA    29,DL
        10 003763   003775 602000 10                 TNC     s:19307
        10 003764   004712 236000 0                  LDQ     YY
        10 003765   000003 376007                    ANQ     3,DL
        10 003766   003775 600000 10                 TZE     s:19307

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:184  
     1582    19302    6                               (YY<78 AND YY>20) OR (MM=2 AND DD>28 AND MOD(YY,4)>0)
             19302                                        THEN DO;

     1583    19303
     1584    19304    6                                CALL XUR$ERRMSG(%E$VWM_DAT);

  19304 10 003767   000163 630400 11                 EPPR0   115
        10 003770   000000 631400 11                 EPPR1   0
        10 003771   000000 701000 xent               TSX1    XUR$ERRMSG
        10 003772   000000 011000                    NOP     0

     1585    19305    6                                ALTRETURN;

  19305 10 003773   004702 221200 0                  LDX1  ! ONCE+1
        10 003774   000000 702211                    TSX2  ! 0,X1

     1586    19306    6                                END;
     1587    19307    5                             DD=DD+100*MM+10000*YY;

  19307 10 003775   004710 236000 0                  LDQ     MM
        10 003776   000144 402007                    MPY     100,DL
        10 003777   004711 036000 0                  ADLQ    DD
        10 004000   004730 756000 0                  STQ     PASSWORD+2
        10 004001   004712 236000 0                  LDQ     YY
        10 004002   023420 402007                    MPY     10000,DL
        10 004003   004730 036000 0                  ADLQ    PASSWORD+2
        10 004004   004711 756000 0                  STQ     DD

     1588    19308    5                             CALL BINCHAR(DWORK,DD);

  19308 10 004005   000000 235003                    LDA     0,DU
        10 004006   004730 757000 0                  STAQ    PASSWORD+2
        10 004007   000000 301400                    BTD
        10 004010   004730 000010 0                  NDSC9   PASSWORD+2               cn=0,s=lsgnf,sf=0,n=8
        10 004011   004642 030010 0                  NDSC9   DWORK                    cn=0,s=nosgn,sf=0,n=8

     1589    19309    5                             OPT$->OPTSDATE.UTS=SUBSTR(DWORK,2,6);
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:185  

  19309 10 004012   040100 100400                    MLR     fill='040'O
        10 004013   004642 400006 0                  ADSC9   DWORK                    cn=2,n=6
        10 004014   400002 600013                    ADSC9   2,,PR4                   cn=3,n=11

     1590    19310    5                             END;

     1591    19311    4                 OPT$->OPTSDATE.CMD='OPTS';

  19311 10 004015   002440 470400 0                  LDP0    OPT$
        10 004016   040100 100400                    MLR     fill='040'O
        10 004017   000215 000004 3                  ADSC9   BADDIES+52               cn=0,n=4
        10 004020   000000 000004                    ADSC9   0,,PR0                   cn=0,n=4

     1592    19312    4                 OPTX=OPTX+1;

  19312 10 004021   002425 054000 0                  AOS     OPTX

     1593    19313
     1594    19314        /****
     1595    19315        *
     1596    19316        *   End of case
     1597    19317        *
     1598    19318        ****/
     1599    19319
     1600    19320    4                 END;

     1601    19321    3              END;

  19321 10 004022   004707 054000 0                  AOS     I
        10 004023   004703 470400 0                  LDP0    @BLK$
        10 004024   000000 471500                    LDP1    0,,PR0
        10 004025   100001 236100                    LDQ     1,,PR1
        10 004026   000022 772000                    QRL     18
        10 004027   004707 116000 0                  CMPQ    I
        10 004030   002637 605400 10                 TPNZ    s:18987

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:186  
     1602    19322
     1603    19323    2           RETURN;

  19323 10 004031   004702 221200 0                  LDX1  ! ONCE+1
        10 004032   000001 702211                    TSX2  ! 1,X1

     1604    19324
     1605    19325    2   END;
     1606    19326
     1607    19327        %EJECT;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:187  
     1608    19328        /*I**
     1609    19329        *
     1610    19330        *   NAME:  LOGON
     1611    19331        *
     1612    19332        *   PURPOSE:
     1613    19333        *       To obtain the complete logon for a node and/or to scramble the
     1614    19334        *       password, if required.
     1615    19335        *
     1616    19336        *   CALL:
     1617    19337        *       CALL LOGON(argb,doit) ALTRET...
     1618    19338        *
     1619    19339        *   PARAMETERS:
     1620    19340        *       argb is a two-"card" logon information block, part of VW_OPTIONS#.
     1621    19341        *       doit is a flag which specifies whether ASZ$SCRAMBLE is to be called
     1622    19342        *       or not.
     1623    19343        *
     1624    19344        *   DATA:
     1625    19345        *       The JIT is examined.  MEBUF and LOBUF may be modified by a prompt
     1626    19346        *       for logon information.
     1627    19347        *
     1628    19348        *   DESCRIPTION:
     1629    19349        *       Get the complete logon for an input or output node, if needed.
     1630    19350        *
     1631    19351        ****/
     1632    19352
     1633    19353    1   LOGON:  PROC(ARGB,DOIT) ALTRET;

  19353 10 004033   004715 741200 0     LOGON        STX1  ! LAST+1

     1634    19354
     1635    19355    2   DCL 1 ARGB ALIGNED,
     1636    19356    2         2 *                          CHAR(4),
     1637    19357    2         2 ACCT                       CHAR(8),
     1638    19358    2         2 NAME                       CHAR(12),
     1639    19359    2         2 EPASS                      CHAR(12),
     1640    19360    2         2 BIT9(0:11) REDEF EPASS UNAL UBIN BYTE,
     1641    19361    2         2 *                          CHAR(35),
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:188  
     1642    19362    2         2 MISC UNAL,
     1643    19363    2           3 PROMPT UNAL              BIT(1),
     1644    19364    2           3 * UNAL                   BIT(8),
     1645    19365    2         2 NODE                       CHAR(8),
     1646    19366    2         2 *                          CHAR(80);
     1647    19367    2   DCL ARGF REDEF ARGB                CHAR(160);
     1648    19368
     1649    19369    2   DCL DOIT                           BIT(1);
     1650    19370
     1651    19371    2   DCL I                              SBIN;
     1652    19372    2   DCL J                              SBIN;
     1653    19373    2   DCL K                              SBIN;
     1654    19374    2   DCL L                              SBIN;
     1655    19375    2   DCL M                              SBIN;
     1656    19376    2   DCL N                              SBIN;
     1657    19377
     1658    19378    2   DCL ASZ$SCRAMBLE                   ENTRY(1);
     1659    19379
     1660    19380    2   DCL PASSWORD                       CHAR(8);
     1661    19381    2   DCL BIT6(0:11) REDEF PASSWORD UNAL UBIN(6);
     1662    19382
     1663    19383
     1664    19384    2   DCL BADDIES(0:127) CONSTANT UNAL   UBIN BYTE INIT(
     1665    19385    2           1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
     1666    19386    2           1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,
     1667    19387    2           1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,
     1668    19388    2           1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1);
     1669    19389
     1670    19390        /****
     1671    19391        *
     1672    19392        *   If there is no node specification, no account logon is needed.
     1673    19393        *
     1674    19394        ****/
     1675    19395
     1676    19396    2           IF ARGB.NODE~=' ' AND SUBSTR(ARGB.ACCT,0,1)~='''' AND

  19396 10 004034   004716 470400 0                  LDP0    @ARGB
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:189  
        10 004035   040000 106500                    CMPC    fill='040'O
        10 004036   000022 000010                    ADSC9   18,,PR0                  cn=0,n=8
        10 004037   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004040   004714 600000 10                 TZE     s:19580
        10 004041   000001 236100                    LDQ     1,,PR0
        10 004042   777000 376003                    ANQ     -512,DU
        10 004043   047000 116003                    CMPQ    19968,DU
        10 004044   004714 600000 10                 TZE     s:19580
        10 004045   040000 106500                    CMPC    fill='040'O
        10 004046   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 004047   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004050   004061 600000 10                 TZE     s:19405
        10 004051   040000 106500                    CMPC    fill='040'O
        10 004052   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 004053   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004054   004061 600000 10                 TZE     s:19405
        10 004055   040000 106500                    CMPC    fill='040'O
        10 004056   000006 000014                    ADSC9   6,,PR0                   cn=0,n=12
        10 004057   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004060   004714 601000 10                 TNZ     s:19580

     1677    19397    3             (ARGB.ACCT=' ' OR ARGB.NAME=' ' OR ARGB.EPASS=' ') THEN DO;

     1678    19398
     1679    19399        /****
     1680    19400        *
     1681    19401        *   Slug in the defaults.
     1682    19402        *
     1683    19403        ****/
     1684    19404
     1685    19405    3              IF ARGB.ACCT=' ' THEN

  19405 10 004061   040000 106500                    CMPC    fill='040'O
        10 004062   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 004063   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004064   004071 601000 10                 TNZ     s:19407

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:190  
     1686    19406    3                 ARGB.ACCT=B$JIT.ACCN;

  19406 10 004065   000000 471400 xsym               LDP1    B$JIT$
        10 004066   040100 100500                    MLR     fill='040'O
        10 004067   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
        10 004070   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

     1687    19407    3              IF ARGB.NAME=' ' THEN

  19407 10 004071   040000 106500                    CMPC    fill='040'O
        10 004072   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 004073   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004074   004101 601000 10                 TNZ     s:19417

     1688    19408    3                 ARGB.NAME=B$JIT.UNAME;

  19408 10 004075   000000 471400 xsym               LDP1    B$JIT$
        10 004076   040100 100500                    MLR     fill='040'O
        10 004077   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12
        10 004100   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12

     1689    19409
     1690    19410        /****
     1691    19411        *
     1692    19412        *   If we're online and not in an XEQ file or if PROMPT is set, prompt.
     1693    19413        *   This logic doesn't work too well on a half-duplex terminal.
     1694    19414        *
     1695    19415        ****/
     1696    19416
     1697    19417    3              IF (B$JIT.MODE=%M_INT# AND (B$JIT.CPFLAGS1&'000000000020'O)='0'B)

  19417 10 004101   000000 471400 xsym               LDP1    B$JIT$
        10 004102   100000 236100                    LDQ     0,,PR1
        10 004103   740000 376003                    ANQ     -16384,DU
        10 004104   140000 116003                    CMPQ    49152,DU
        10 004105   004111 601000 10                 TNZ     s:19417+8
        10 004106   100143 236100                    LDQ     99,,PR1
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:191  
        10 004107   000231 376000 3                  ANQ     BADDIES+64
        10 004110   004114 600000 10                 TZE     s:19419
        10 004111   000021 236100                    LDQ     17,,PR0
        10 004112   000400 316007                    CANQ    256,DL
        10 004113   004714 600000 10                 TZE     s:19580

     1698    19418    4                OR ARGB.MISC.PROMPT THEN DO;

     1699    19419    5                 IF B$JIT.MODE=%M_INT# THEN DO;

  19419 10 004114   100000 236100                    LDQ     0,,PR1
        10 004115   740000 376003                    ANQ     -16384,DU
        10 004116   140000 116003                    CMPQ    49152,DU
        10 004117   004156 601000 10                 TNZ     TRY_AGAIN

     1700    19420    5                    CALL INDEX(I,' ',ARGB.NODE);

  19420 10 004120   000000 124500                    SCM     mask='000'O
        10 004121   000022 000010                    ADSC9   18,,PR0                  cn=0,n=8
        10 004122   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004123   004720 000000 0                  ARG     I

     1701    19421    5                    CALL CONCAT(LOBUF,'` Logon @',SUBSTR(ARGB.NODE,0,I),'?');

  19421 10 004124   040000 100400                    MLR     fill='040'O
        10 004125   000232 000011 3                  ADSC9   BADDIES+65               cn=0,n=9
        10 004126   004542 000011 0                  ADSC9   LOBUF                    cn=0,n=9
        10 004127   004720 720000 0                  LXL0    I
        10 004130   040000 100540                    MLR     fill='040'O
        10 004131   000022 000010                    ADSC9   18,,PR0                  cn=0,n=*X0
        10 004132   004544 200367 0                  ADSC9   LOBUF+2                  cn=1,n=247
        10 004133   004720 236000 0                  LDQ     I
        10 004134   000367 116007                    CMPQ    247,DL
        10 004135   004143 605000 10                 TPL     s:19422
        10 004136   777410 621006                    EAX1    -248,QL
        10 004137   777777 661003                    ERX1    -1,DU
        10 004140   040046 100400                    MLR     fill='040'O
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:192  
        10 004141   000066 000001 11                 ADSC9   54                       cn=0,n=1
        10 004142   004544 200011 0                  ADSC9   LOBUF+2,Q                cn=1,n=*X1

     1702    19422    5                    FPT_PROMPT.PROMPT_=VECTOR(SUBSTR(LOBUF,0,I+10));

  19422 10 004143   004720 235000 0                  LDA     I
        10 004144   000020 735000                    ALS     16
        10 004145   000164 035000 11                 ADLA    116
        10 004146   000165 236000 11                 LDQ     117
        10 004147   002340 757000 0                  STAQ    FPT_PROMPT+4

     1703    19423    5                    CALL M$PROMPT(FPT_PROMPT);

  19423 10 004150   002334 630400 0                  EPPR0   FPT_PROMPT
        10 004151   160002 713400                    CLIMB   57346
        10 004152   401000 401760                    pmme    nvectors=3

     1704    19424    5                    CALL M$STRMCTL(ECHO_OF);

  19424 10 004153   002304 630400 0                  EPPR0   ECHO_OF
        10 004154   160000 713400                    CLIMB   57344
        10 004155   401000 401760                    pmme    nvectors=3

     1705    19425    5                    END;

     1706    19426
     1707    19427    4   TRY_AGAIN:
     1708    19428    4                 MEBUF=' ';

  19428 10 004156   040000 100400       TRY_AGAIN    MLR     fill='040'O
        10 004157   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004160   004442 000400 0                  ADSC9   MEBUF                    cn=0,n=256

     1709    19429    5                 CALL M$READ(READ_ME) WHENRETURN DO;

  19429 10 004161   002106 630400 0                  EPPR0   READ_ME
        10 004162   440000 713400                    CLIMB   alt,read
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:193  
        10 004163   401400 401760                    pmme    nvectors=4
        10 004164   004704 702000 10                 TSX2    s:19569

     1710    19430
     1711    19431        /****
     1712    19432        *
     1713    19433        *   Crudely simulate the parser.
     1714    19434        *
     1715    19435        ****/
     1716    19436
     1717    19437    5                    I=0;

  19437 10 004165   004720 450000 0                  STZ     I

     1718    19438    5                    J=0;

  19438 10 004166   004721 450000 0                  STZ     J

     1719    19439    5                    K=0;

  19439 10 004167   004722 450000 0                  STZ     K

     1720    19440    6                    DO WHILE(I<256);

  19440 10 004170   004720 235000 0                  LDA     I
        10 004171   000400 115007                    CMPA    256,DL
        10 004172   004266 605000 10                 TPL     s:19471

     1721    19441    7                       IF SUBSTR(MEBUF,I,1)~=' ' THEN DO;

  19441 10 004173   004720 235000 0                  LDA     I
        10 004174   040000 106405                    CMPC    fill='040'O
        10 004175   004442 000001 0                  ADSC9   MEBUF,A                  cn=0,n=1
        10 004176   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004177   004262 600000 10                 TZE     s:19462

     1722    19442    8                          IF SUBSTR(MEBUF,I,1)='''' THEN DO;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:194  

  19442 10 004200   040000 106405                    CMPC    fill='040'O
        10 004201   004442 000001 0                  ADSC9   MEBUF,A                  cn=0,n=1
        10 004202   000141 000001 11                 ADSC9   97                       cn=0,n=1
        10 004203   004247 601000 10                 TNZ     s:19456

     1723    19443    8                             CALL INDEX(L,'''',MEBUF,I+1)

  19443 10 004204   777400 620005                    EAX0    -256,AL
        10 004205   777777 660003                    ERX0    -1,DU
        10 004206   004720 236000 0                  LDQ     I
        10 004207   000001 036007                    ADLQ    1,DL
        10 004210   000000 124445                    SCM     mask='000'O
        10 004211   004442 200010 0                  ADSC9   MEBUF,A                  cn=1,n=*X0
        10 004212   000141 000001 11                 ADSC9   97                       cn=0,n=1
        10 004213   004723 000000 0                  ARG     L
        10 004214   004723 056000 0                  ASQ     L
        10 004215   004242 606400 10                 TTN     s:19451

     1724    19444    9                             WHENRETURN DO;

     1725    19445    9                                SUBSTR(MEBUF,J,L-I+1)=SUBSTR(MEBUF,I,

  19445 10 004216   004723 236000 0                  LDQ     L
        10 004217   004720 136000 0                  SBLQ    I
        10 004220   004730 756000 0                  STQ     PASSWORD+2
        10 004221   004723 236000 0                  LDQ     L
        10 004222   004720 136000 0                  SBLQ    I
        10 004223   000001 621006                    EAX1    1,QL
        10 004224   004730 722000 0                  LXL2    PASSWORD+2
        10 004225   000001 623012                    EAX3    1,X2
        10 004226   004721 236000 0                  LDQ     J
        10 004227   040046 100445                    MLR     fill='040'O
        10 004230   004442 000011 0                  ADSC9   MEBUF,A                  cn=0,n=*X1
        10 004231   004442 000013 0                  ADSC9   MEBUF,Q                  cn=0,n=*X3

     1726    19446    9                                  L-I+1);
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:195  
     1727    19447    9                                J=J+L-I+1;

  19447 10 004232   004723 036000 0                  ADLQ    L
        10 004233   004720 136000 0                  SBLQ    I
        10 004234   000001 036007                    ADLQ    1,DL
        10 004235   004721 756000 0                  STQ     J

     1728    19448    9                                I=L+1;

  19448 10 004236   004723 235000 0                  LDA     L
        10 004237   000001 035007                    ADLA    1,DL
        10 004240   004720 755000 0                  STA     I

     1729    19449    9                                END;

  19449 10 004241   004246 710000 10                 TRA     s:19454

     1730    19450    9                             WHENALTRETURN DO;

     1731    19451    9                                L=69;

  19451 10 004242   000105 235007                    LDA     69,DL
        10 004243   004723 755000 0                  STA     L

     1732    19452    9                                I=255;

  19452 10 004244   000377 236007                    LDQ     255,DL
        10 004245   004720 756000 0                  STQ     I

     1733    19453    9                                END;

     1734    19454    8                             END;

  19454 10 004246   004262 710000 10                 TRA     s:19462

     1735    19455    8                          ELSE DO;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:196  
     1736    19456    8                             SUBSTR(MEBUF,J,1)=SUBSTR(MEBUF,I,1);

  19456 10 004247   004721 236000 0                  LDQ     J
        10 004250   040006 100405                    MLR     fill='040'O
        10 004251   004442 000001 0                  ADSC9   MEBUF,A                  cn=0,n=1
        10 004252   004442 000001 0                  ADSC9   MEBUF,Q                  cn=0,n=1

     1737    19457    8                             J=J+1;

  19457 10 004253   004721 054000 0                  AOS     J

     1738    19458    8                             IF SUBSTR(MEBUF,J,1)=',' THEN

  19458 10 004254   004721 236000 0                  LDQ     J
        10 004255   040000 106406                    CMPC    fill='040'O
        10 004256   004442 000001 0                  ADSC9   MEBUF,Q                  cn=0,n=1
        10 004257   000166 000001 11                 ADSC9   118                      cn=0,n=1
        10 004260   004262 601000 10                 TNZ     s:19462

     1739    19459    8                                K=K+1;

  19459 10 004261   004722 054000 0                  AOS     K

     1740    19460    8                             END;

     1741    19461    7                          END;

     1742    19462    6                       I=I+1;

  19462 10 004262   004720 054000 0                  AOS     I

     1743    19463    6                       END;

  19463 10 004263   004720 235000 0                  LDA     I
        10 004264   000400 115007                    CMPA    256,DL
        10 004265   004173 604000 10                 TMI     s:19441

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:197  
     1744    19464
     1745    19465        /****
     1746    19466        *
     1747    19467        *   K counts commas.  If more than two were encountered, error!
     1748    19468        *
     1749    19469        ****/
     1750    19470
     1751    19471    6                    IF K>2 THEN DO;

  19471 10 004266   004722 236000 0                  LDQ     K
        10 004267   000002 116007                    CMPQ    2,DL
        10 004270   004310 604400 10                 TMOZ    s:19477

     1752    19472    6                       CALL XUR$ERRMSG(%E$VWM_UID);

  19472 10 004271   000170 630400 11                 EPPR0   120
        10 004272   000000 631400 11                 EPPR1   0
        10 004273   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004274   000000 011000                    NOP     0

     1753    19473    6                       IF B$JIT.MODE=%M_INT# OR ARGB.MISC.PROMPT THEN

  19473 10 004275   000000 470400 xsym               LDP0    B$JIT$
        10 004276   000000 236100                    LDQ     0,,PR0
        10 004277   740000 376003                    ANQ     -16384,DU
        10 004300   140000 116003                    CMPQ    49152,DU
        10 004301   004156 600000 10                 TZE     TRY_AGAIN
        10 004302   004716 471400 0                  LDP1    @ARGB
        10 004303   100021 236100                    LDQ     17,,PR1
        10 004304   000400 316007                    CANQ    256,DL
        10 004305   004156 601000 10                 TNZ     TRY_AGAIN

     1754    19474    6                          GOTO TRY_AGAIN;
     1755    19475    6                       ALTRETURN;

  19475 10 004306   004715 221200 0                  LDX1  ! LAST+1
        10 004307   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:198  

     1756    19476    6                       END;
     1757    19477    6                    DO CASE(K);

  19477 10 004310   000003 116007                    CMPQ    3,DL
        10 004311   004313 602006 10                 TNC     s:19477+3,QL
        10 004312   004704 710000 10                 TRA     s:19569
        10 004313   004316 710000 10                 TRA     s:19487
        10 004314   004376 710000 10                 TRA     s:19515
        10 004315   004525 710000 10                 TRA     s:19544

     1758    19478
     1759    19479
     1760    19480        /****
     1761    19481        *
     1762    19482        *   Nothing entered, foreign logon, or password only.
     1763    19483        *
     1764    19484        ****/
     1765    19485
     1766    19486    6                     CASE(0);

     1767    19487    7                       IF J>0 THEN DO;

  19487 10 004316   004721 235000 0                  LDA     J
        10 004317   004704 604400 10                 TMOZ    s:19569

     1768    19488    8                          IF SUBSTR(MEBUF,0,1)~='''' THEN DO;

  19488 10 004320   004442 236000 0                  LDQ     MEBUF
        10 004321   777000 376003                    ANQ     -512,DU
        10 004322   047000 116003                    CMPQ    19968,DU
        10 004323   004353 600000 10                 TZE     s:19498

     1769    19489    9                             IF J>8 THEN DO;

  19489 10 004324   000010 115007                    CMPA    8,DL
        10 004325   004345 604400 10                 TMOZ    s:19495
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:199  

     1770    19490    9                                CALL XUR$ERRMSG(%E$VWM_UID);

  19490 10 004326   000170 630400 11                 EPPR0   120
        10 004327   000000 631400 11                 EPPR1   0
        10 004330   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004331   000000 011000                    NOP     0

     1771    19491    9                                IF B$JIT.MODE=%M_INT# OR ARGB.MISC.PROMPT THEN

  19491 10 004332   000000 470400 xsym               LDP0    B$JIT$
        10 004333   000000 236100                    LDQ     0,,PR0
        10 004334   740000 376003                    ANQ     -16384,DU
        10 004335   140000 116003                    CMPQ    49152,DU
        10 004336   004156 600000 10                 TZE     TRY_AGAIN
        10 004337   004716 471400 0                  LDP1    @ARGB
        10 004340   100021 236100                    LDQ     17,,PR1
        10 004341   000400 316007                    CANQ    256,DL
        10 004342   004156 601000 10                 TNZ     TRY_AGAIN

     1772    19492    9                                   GOTO TRY_AGAIN;
     1773    19493    9                                ALTRETURN;

  19493 10 004343   004715 221200 0                  LDX1  ! LAST+1
        10 004344   000000 702211                    TSX2  ! 0,X1

     1774    19494    9                                END;
     1775    19495    8                             ARGB.EPASS=SUBSTR(MEBUF,0,J);

  19495 10 004345   000000 620005                    EAX0    0,AL
        10 004346   004716 470400 0                  LDP0    @ARGB
        10 004347   040100 100440                    MLR     fill='040'O
        10 004350   004442 000010 0                  ADSC9   MEBUF                    cn=0,n=*X0
        10 004351   000006 000014                    ADSC9   6,,PR0                   cn=0,n=12

     1776    19496    8                             END;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:200  
  19496 10 004352   004704 710000 10                 TRA     s:19569

     1777    19497    8                          ELSE DO;

     1778    19498    9                             IF J>67 THEN DO;

  19498 10 004353   000103 115007                    CMPA    67,DL
        10 004354   004370 604400 10                 TMOZ    s:19504

     1779    19499    9                                CALL XUR$ERRMSG(%E$VWM_UID);

  19499 10 004355   000170 630400 11                 EPPR0   120
        10 004356   000000 631400 11                 EPPR1   0
        10 004357   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004360   000000 011000                    NOP     0

     1780    19500    9                                IF B$JIT.MODE=%M_INT# THEN

  19500 10 004361   000000 470400 xsym               LDP0    B$JIT$
        10 004362   000000 236100                    LDQ     0,,PR0
        10 004363   740000 376003                    ANQ     -16384,DU
        10 004364   140000 116003                    CMPQ    49152,DU
        10 004365   004156 600000 10                 TZE     TRY_AGAIN

     1781    19501    9                                   GOTO TRY_AGAIN;
     1782    19502    9                                ALTRETURN;

  19502 10 004366   004715 221200 0                  LDX1  ! LAST+1
        10 004367   000000 702211                    TSX2  ! 0,X1

     1783    19503    9                                END;
     1784    19504    8                             SUBSTR(ARGF,4,67)=SUBSTR(MEBUF,0,J);

  19504 10 004370   000000 620005                    EAX0    0,AL
        10 004371   004716 470400 0                  LDP0    @ARGB
        10 004372   040100 100440                    MLR     fill='040'O
        10 004373   004442 000010 0                  ADSC9   MEBUF                    cn=0,n=*X0
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:201  
        10 004374   000001 000103                    ADSC9   1,,PR0                   cn=0,n=67

     1785    19505    8                             END;

     1786    19506    7                          END;

  19506 10 004375   004704 710000 10                 TRA     s:19569

     1787    19507
     1788    19508        /****
     1789    19509        *
     1790    19510        *   Account,name
     1791    19511        *
     1792    19512        ****/
     1793    19513
     1794    19514    6                     CASE(1);

     1795    19515    6                       CALL INDEX(K,',',MEBUF);

  19515 10 004376   000000 124400                    SCM     mask='000'O
        10 004377   004442 000400 0                  ADSC9   MEBUF                    cn=0,n=256
        10 004400   000166 000001 11                 ADSC9   118                      cn=0,n=1
        10 004401   004722 000000 0                  ARG     K

     1796    19516    7                       IF K<1 OR K>8 OR J-K<2 OR J-K>13 THEN DO;

  19516 10 004402   004722 236000 0                  LDQ     K
        10 004403   004416 604400 10                 TMOZ    s:19517
        10 004404   000010 116007                    CMPQ    8,DL
        10 004405   004416 605400 10                 TPNZ    s:19517
        10 004406   004721 236000 0                  LDQ     J
        10 004407   004722 136000 0                  SBLQ    K
        10 004410   000002 116007                    CMPQ    2,DL
        10 004411   004416 604000 10                 TMI     s:19517
        10 004412   004721 236000 0                  LDQ     J
        10 004413   004722 136000 0                  SBLQ    K
        10 004414   000015 116007                    CMPQ    13,DL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:202  
        10 004415   004431 604400 10                 TMOZ    s:19522

     1797    19517    7                          CALL XUR$ERRMSG(%E$VWM_UID);

  19517 10 004416   000170 630400 11                 EPPR0   120
        10 004417   000000 631400 11                 EPPR1   0
        10 004420   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004421   000000 011000                    NOP     0

     1798    19518    7                          IF B$JIT.MODE=%M_INT# THEN

  19518 10 004422   000000 470400 xsym               LDP0    B$JIT$
        10 004423   000000 236100                    LDQ     0,,PR0
        10 004424   740000 376003                    ANQ     -16384,DU
        10 004425   140000 116003                    CMPQ    49152,DU
        10 004426   004156 600000 10                 TZE     TRY_AGAIN

     1799    19519    7                             GOTO TRY_AGAIN;
     1800    19520    7                          ALTRETURN;

  19520 10 004427   004715 221200 0                  LDX1  ! LAST+1
        10 004430   000000 702211                    TSX2  ! 0,X1

     1801    19521    7                          END;
     1802    19522    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,0,K)) WHENRETURN DO;

  19522 10 004431   004722 720000 0                  LXL0    K
        10 004432   000000 164440                    TCT
        10 004433   004442 000010 0                  ADSC9   MEBUF                    cn=0,n=*X0
        10 004434   000131 000000 3                  ARG     BADDIES
        10 004435   004724 000000 0                  ARG     M
        10 004436   004724 236000 0                  LDQ     M
        10 004437   000044 737000                    LLS     36
        10 004440   000033 771000                    ARL     27
        10 004441   004725 755000 0                  STA     N
        10 004442   004724 551040 0                  STBA    M,'40'O
        10 004443   004457 606400 10                 TTN     s:19528
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:203  

     1803    19523    7                          CALL XUR$ERRMSG(%E$VWM_UID);

  19523 10 004444   000170 630400 11                 EPPR0   120
        10 004445   000000 631400 11                 EPPR1   0
        10 004446   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004447   000000 011000                    NOP     0

     1804    19524    7                          IF B$JIT.MODE=%M_INT# THEN

  19524 10 004450   000000 470400 xsym               LDP0    B$JIT$
        10 004451   000000 236100                    LDQ     0,,PR0
        10 004452   740000 376003                    ANQ     -16384,DU
        10 004453   140000 116003                    CMPQ    49152,DU
        10 004454   004156 600000 10                 TZE     TRY_AGAIN

     1805    19525    7                             GOTO TRY_AGAIN;
     1806    19526    7                          ALTRETURN;

  19526 10 004455   004715 221200 0                  LDX1  ! LAST+1
        10 004456   000000 702211                    TSX2  ! 0,X1

     1807    19527    7                          END;
     1808    19528    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,K+1,J-K-1)) WHENRETURN DO;

  19528 10 004457   004721 236000 0                  LDQ     J
        10 004460   004722 136000 0                  SBLQ    K
        10 004461   777777 620006                    EAX0    -1,QL
        10 004462   004722 235000 0                  LDA     K
        10 004463   000000 164445                    TCT
        10 004464   004442 200010 0                  ADSC9   MEBUF,A                  cn=1,n=*X0
        10 004465   000131 000000 3                  ARG     BADDIES
        10 004466   004724 000000 0                  ARG     M
        10 004467   004724 236000 0                  LDQ     M
        10 004470   000044 737000                    LLS     36
        10 004471   000033 771000                    ARL     27
        10 004472   004725 755000 0                  STA     N
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:204  
        10 004473   004724 551040 0                  STBA    M,'40'O
        10 004474   004510 606400 10                 TTN     s:19534

     1809    19529    7                          CALL XUR$ERRMSG(%E$VWM_UID);

  19529 10 004475   000170 630400 11                 EPPR0   120
        10 004476   000000 631400 11                 EPPR1   0
        10 004477   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004500   000000 011000                    NOP     0

     1810    19530    7                          IF B$JIT.MODE=%M_INT# THEN

  19530 10 004501   000000 470400 xsym               LDP0    B$JIT$
        10 004502   000000 236100                    LDQ     0,,PR0
        10 004503   740000 376003                    ANQ     -16384,DU
        10 004504   140000 116003                    CMPQ    49152,DU
        10 004505   004156 600000 10                 TZE     TRY_AGAIN

     1811    19531    7                             GOTO TRY_AGAIN;
     1812    19532    7                          ALTRETURN;

  19532 10 004506   004715 221200 0                  LDX1  ! LAST+1
        10 004507   000000 702211                    TSX2  ! 0,X1

     1813    19533    7                          END;
     1814    19534    6                       ARGB.ACCT=SUBSTR(MEBUF,0,K);

  19534 10 004510   004722 720000 0                  LXL0    K
        10 004511   004716 470400 0                  LDP0    @ARGB
        10 004512   040100 100440                    MLR     fill='040'O
        10 004513   004442 000010 0                  ADSC9   MEBUF                    cn=0,n=*X0
        10 004514   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

     1815    19535    6                       ARGB.NAME=SUBSTR(MEBUF,K+1,J-K-1);

  19535 10 004515   004721 236000 0                  LDQ     J
        10 004516   004722 136000 0                  SBLQ    K
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:205  
        10 004517   777777 621006                    EAX1    -1,QL
        10 004520   004722 235000 0                  LDA     K
        10 004521   040100 100445                    MLR     fill='040'O
        10 004522   004442 200011 0                  ADSC9   MEBUF,A                  cn=1,n=*X1
        10 004523   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 004524   004704 710000 10                 TRA     s:19569

     1816    19536
     1817    19537        /****
     1818    19538        *
     1819    19539        *   Account,name,password
     1820    19540        *
     1821    19541        ****/
     1822    19542
     1823    19543    6                     CASE(2);

     1824    19544    6                       CALL INDEX(K,',',MEBUF);

  19544 10 004525   000000 124400                    SCM     mask='000'O
        10 004526   004442 000400 0                  ADSC9   MEBUF                    cn=0,n=256
        10 004527   000166 000001 11                 ADSC9   118                      cn=0,n=1
        10 004530   004722 000000 0                  ARG     K

     1825    19545    6                       CALL INDEX(L,',',MEBUF,K+1);

  19545 10 004531   004722 720000 0                  LXL0    K
        10 004532   777400 620010                    EAX0    -256,X0
        10 004533   777777 660003                    ERX0    -1,DU
        10 004534   004722 236000 0                  LDQ     K
        10 004535   000001 036007                    ADLQ    1,DL
        10 004536   004722 235000 0                  LDA     K
        10 004537   000000 124445                    SCM     mask='000'O
        10 004540   004442 200010 0                  ADSC9   MEBUF,A                  cn=1,n=*X0
        10 004541   000166 000001 11                 ADSC9   118                      cn=0,n=1
        10 004542   004723 000000 0                  ARG     L
        10 004543   004723 056000 0                  ASQ     L

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:206  
     1826    19546    7                       IF K<1 OR K>8 OR L-K<2 OR L-K>13 OR J-L<2 OR J-L>9 THEN DO;

  19546 10 004544   000000 115003                    CMPA    0,DU
        10 004545   004570 604400 10                 TMOZ    s:19547
        10 004546   000010 115007                    CMPA    8,DL
        10 004547   004570 605400 10                 TPNZ    s:19547
        10 004550   004723 236000 0                  LDQ     L
        10 004551   004722 136000 0                  SBLQ    K
        10 004552   000002 116007                    CMPQ    2,DL
        10 004553   004570 604000 10                 TMI     s:19547
        10 004554   004723 236000 0                  LDQ     L
        10 004555   004722 136000 0                  SBLQ    K
        10 004556   000015 116007                    CMPQ    13,DL
        10 004557   004570 605400 10                 TPNZ    s:19547
        10 004560   004721 236000 0                  LDQ     J
        10 004561   004723 136000 0                  SBLQ    L
        10 004562   000002 116007                    CMPQ    2,DL
        10 004563   004570 604000 10                 TMI     s:19547
        10 004564   004721 236000 0                  LDQ     J
        10 004565   004723 136000 0                  SBLQ    L
        10 004566   000011 116007                    CMPQ    9,DL
        10 004567   004603 604400 10                 TMOZ    s:19552

     1827    19547    7                          CALL XUR$ERRMSG(%E$VWM_UID);

  19547 10 004570   000170 630400 11                 EPPR0   120
        10 004571   000000 631400 11                 EPPR1   0
        10 004572   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004573   000000 011000                    NOP     0

     1828    19548    7                          IF B$JIT.MODE=%M_INT# THEN

  19548 10 004574   000000 470400 xsym               LDP0    B$JIT$
        10 004575   000000 236100                    LDQ     0,,PR0
        10 004576   740000 376003                    ANQ     -16384,DU
        10 004577   140000 116003                    CMPQ    49152,DU
        10 004600   004156 600000 10                 TZE     TRY_AGAIN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:207  

     1829    19549    7                             GOTO TRY_AGAIN;
     1830    19550    7                          ALTRETURN;

  19550 10 004601   004715 221200 0                  LDX1  ! LAST+1
        10 004602   000000 702211                    TSX2  ! 0,X1

     1831    19551    7                          END;
     1832    19552    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,0,K)) WHENRETURN DO;

  19552 10 004603   000000 621005                    EAX1    0,AL
        10 004604   000000 164440                    TCT
        10 004605   004442 000011 0                  ADSC9   MEBUF                    cn=0,n=*X1
        10 004606   000131 000000 3                  ARG     BADDIES
        10 004607   004724 000000 0                  ARG     M
        10 004610   004724 235000 0                  LDA     M
        10 004611   000033 771000                    ARL     27
        10 004612   004725 755000 0                  STA     N
        10 004613   004724 551040 0                  STBA    M,'40'O
        10 004614   004630 606400 10                 TTN     s:19558

     1833    19553    7                          CALL XUR$ERRMSG(%E$VWM_UID);

  19553 10 004615   000170 630400 11                 EPPR0   120
        10 004616   000000 631400 11                 EPPR1   0
        10 004617   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004620   000000 011000                    NOP     0

     1834    19554    7                          IF B$JIT.MODE=%M_INT# THEN

  19554 10 004621   000000 470400 xsym               LDP0    B$JIT$
        10 004622   000000 236100                    LDQ     0,,PR0
        10 004623   740000 376003                    ANQ     -16384,DU
        10 004624   140000 116003                    CMPQ    49152,DU
        10 004625   004156 600000 10                 TZE     TRY_AGAIN

     1835    19555    7                             GOTO TRY_AGAIN;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:208  
     1836    19556    7                          ALTRETURN;

  19556 10 004626   004715 221200 0                  LDX1  ! LAST+1
        10 004627   000000 702211                    TSX2  ! 0,X1

     1837    19557    7                          END;
     1838    19558    7                       CALL SEARCH(M,N,BADDIES,SUBSTR(MEBUF,K+1,L-K-1)) WHENRETURN DO;

  19558 10 004630   004723 236000 0                  LDQ     L
        10 004631   004722 136000 0                  SBLQ    K
        10 004632   777777 620006                    EAX0    -1,QL
        10 004633   004722 235000 0                  LDA     K
        10 004634   000000 164445                    TCT
        10 004635   004442 200010 0                  ADSC9   MEBUF,A                  cn=1,n=*X0
        10 004636   000131 000000 3                  ARG     BADDIES
        10 004637   004724 000000 0                  ARG     M
        10 004640   004724 236000 0                  LDQ     M
        10 004641   000044 737000                    LLS     36
        10 004642   000033 771000                    ARL     27
        10 004643   004725 755000 0                  STA     N
        10 004644   004724 551040 0                  STBA    M,'40'O
        10 004645   004661 606400 10                 TTN     s:19564

     1839    19559    7                          CALL XUR$ERRMSG(%E$VWM_UID);

  19559 10 004646   000170 630400 11                 EPPR0   120
        10 004647   000000 631400 11                 EPPR1   0
        10 004650   000000 701000 xent               TSX1    XUR$ERRMSG
        10 004651   000000 011000                    NOP     0

     1840    19560    7                          IF B$JIT.MODE=%M_INT# THEN

  19560 10 004652   000000 470400 xsym               LDP0    B$JIT$
        10 004653   000000 236100                    LDQ     0,,PR0
        10 004654   740000 376003                    ANQ     -16384,DU
        10 004655   140000 116003                    CMPQ    49152,DU
        10 004656   004156 600000 10                 TZE     TRY_AGAIN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:209  

     1841    19561    7                             GOTO TRY_AGAIN;
     1842    19562    7                          ALTRETURN;

  19562 10 004657   004715 221200 0                  LDX1  ! LAST+1
        10 004660   000000 702211                    TSX2  ! 0,X1

     1843    19563    7                          END;
     1844    19564    6                       ARGB.ACCT=SUBSTR(MEBUF,0,K);

  19564 10 004661   004722 720000 0                  LXL0    K
        10 004662   004716 470400 0                  LDP0    @ARGB
        10 004663   040100 100440                    MLR     fill='040'O
        10 004664   004442 000010 0                  ADSC9   MEBUF                    cn=0,n=*X0
        10 004665   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

     1845    19565    6                       ARGB.NAME=SUBSTR(MEBUF,K+1,L-K-1);

  19565 10 004666   004723 236000 0                  LDQ     L
        10 004667   004722 136000 0                  SBLQ    K
        10 004670   777777 621006                    EAX1    -1,QL
        10 004671   004722 235000 0                  LDA     K
        10 004672   040100 100445                    MLR     fill='040'O
        10 004673   004442 200011 0                  ADSC9   MEBUF,A                  cn=1,n=*X1
        10 004674   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12

     1846    19566    6                       ARGB.EPASS=SUBSTR(MEBUF,L+1,J-L-1);

  19566 10 004675   004721 236000 0                  LDQ     J
        10 004676   004723 136000 0                  SBLQ    L
        10 004677   777777 621006                    EAX1    -1,QL
        10 004700   004723 236000 0                  LDQ     L
        10 004701   040100 100446                    MLR     fill='040'O
        10 004702   004442 200011 0                  ADSC9   MEBUF,Q                  cn=1,n=*X1
        10 004703   000006 000014                    ADSC9   6,,PR0                   cn=0,n=12

     1847    19567    6                     END;
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:210  

     1848    19568    5                    END;

     1849    19569    4                 IF B$JIT.MODE=%M_INT# THEN

  19569 10 004704   000000 470400 xsym               LDP0    B$JIT$
        10 004705   000000 236100                    LDQ     0,,PR0
        10 004706   740000 376003                    ANQ     -16384,DU
        10 004707   140000 116003                    CMPQ    49152,DU
        10 004710   004714 601000 10                 TNZ     s:19580

     1850    19570    4                    CALL M$STRMCTL(ECHO_ON);

  19570 10 004711   002320 630400 0                  EPPR0   ECHO_ON
        10 004712   160000 713400                    CLIMB   57344
        10 004713   401000 401760                    pmme    nvectors=3

     1851    19571    4                 END;

     1852    19572    3              END;

     1853    19573
     1854    19574        /****
     1855    19575        *
     1856    19576        *   Encode the password, no matter where it came from.
     1857    19577        *
     1858    19578        ****/
     1859    19579
     1860    19580    3           IF ARGB.NODE~=' ' AND SUBSTR(ARGB.ACCT,0,1)~='''' THEN DO;

  19580 10 004714   004716 470400 0                  LDP0    @ARGB
        10 004715   040000 106500                    CMPC    fill='040'O
        10 004716   000022 000010                    ADSC9   18,,PR0                  cn=0,n=8
        10 004717   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004720   004764 600000 10                 TZE     s:19595
        10 004721   000001 236100                    LDQ     1,,PR0
        10 004722   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:211  
        10 004723   047000 116003                    CMPQ    19968,DU
        10 004724   004764 600000 10                 TZE     s:19595

     1861    19581    3              PASSWORD=ARGB.EPASS;

  19581 10 004725   040000 100500                    MLR     fill='040'O
        10 004726   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
        10 004727   004726 000010 0                  ADSC9   PASSWORD                 cn=0,n=8

     1862    19582    3              IF DOIT THEN

  19582 10 004730   004717 471400 0                  LDP1    @DOIT
        10 004731   000000 066500                    CMPB    filb='0'B
        10 004732   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
        10 004733   000101 000022 11                 BDSC    65                       by=0,bit=0,n=18
        10 004734   004741 600000 10                 TZE     s:19584

     1863    19583    3                 CALL ASZ$SCRAMBLE(PASSWORD);

  19583 10 004735   000171 630400 11                 EPPR0   121
        10 004736   000000 631400 11                 EPPR1   0
        10 004737   000000 701000 xent               TSX1    ASZ$SCRAMBLE
        10 004740   000000 011000                    NOP     0

     1864    19584    4              DO I=0 TO 11;

  19584 10 004741   004720 450000 0                  STZ     I

     1865    19585    4                 ARGB.BIT9(I)=BIT6(I)+ASCBIN(' ');

  19585 10 004742   004720 235000 0                  LDA     I
        10 004743   004745 605000 10                 TPL     s:19585+3
        10 004744   000006 035003                    ADLA    6,DU
        10 004745   000000 101405                    MRL     fill='000'O
        10 004746   004726 020001 0                  ADSC6   PASSWORD,A               cn=0,n=1
        10 004747   004731 020006 0                  ADSC6   PASSWORD+3               cn=0,n=6
        10 004750   004731 236000 0                  LDQ     PASSWORD+3
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:212  
        10 004751   000040 036007                    ADLQ    32,DL
        10 004752   004730 756000 0                  STQ     PASSWORD+2
        10 004753   004716 470400 0                  LDP0    @ARGB
        10 004754   004720 235000 0                  LDA     I
        10 004755   000105 101400                    MRL     fill='000'O
        10 004756   004730 000004 0                  ADSC9   PASSWORD+2               cn=0,n=4
        10 004757   000006 000001                    ADSC9   6,A,PR0                  cn=0,n=1

     1866    19586    4                 END;

  19586 10 004760   004720 054000 0                  AOS     I
        10 004761   004720 235000 0                  LDA     I
        10 004762   000013 115007                    CMPA    11,DL
        10 004763   004742 604400 10                 TMOZ    s:19585

     1867    19587    3              END;

     1868    19588
     1869    19589        /****
     1870    19590        *
     1871    19591        *   Disallow :MAIL,500ATOB as a legal logon.
     1872    19592        *
     1873    19593        ****/
     1874    19594
     1875    19595    2           IF ARGB.NODE~=' ' AND ARGB.ACCT=':MAIL' AND ARGB.NAME='500ATOB'

  19595 10 004764   040000 106500                    CMPC    fill='040'O
        10 004765   000022 000010                    ADSC9   18,,PR0                  cn=0,n=8
        10 004766   000021 000001 11                 ADSC9   17                       cn=0,n=1
        10 004767   005006 600000 10                 TZE     s:19601
        10 004770   040000 106500                    CMPC    fill='040'O
        10 004771   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
        10 004772   000235 000005 3                  ADSC9   BADDIES+68               cn=0,n=5
        10 004773   005006 601000 10                 TNZ     s:19601
        10 004774   040000 106500                    CMPC    fill='040'O
        10 004775   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
        10 004776   000237 000007 3                  ADSC9   BADDIES+70               cn=0,n=7
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:213  
        10 004777   005006 601000 10                 TNZ     s:19601

     1876    19596    3           THEN DO;

     1877    19597    3              CALL XUR$ERRMSG(%E$VWM_SUK);

  19597 10 005000   000173 630400 11                 EPPR0   123
        10 005001   000000 631400 11                 EPPR1   0
        10 005002   000000 701000 xent               TSX1    XUR$ERRMSG
        10 005003   000000 011000                    NOP     0

     1878    19598    3              ALTRETURN;

  19598 10 005004   004715 221200 0                  LDX1  ! LAST+1
        10 005005   000000 702211                    TSX2  ! 0,X1

     1879    19599    3              END;
     1880    19600
     1881    19601    2           RETURN;

  19601 10 005006   004715 221200 0                  LDX1  ! LAST+1
        10 005007   000001 702211                    TSX2  ! 1,X1

     1882    19602
     1883    19603    2   END;
     1884    19604
     1885    19605    1   END;

  19605 10 005010   000000 702200 xent               TSX2  ! X66_MSRET

VW_OPTIONS#
 Sect OctLoc
   0     001   ****** ******   ****** ******   ****** ******   ****** ******    ................

OPEN_NODE
 Sect OctLoc
   0     766   000025 777640   001032 006000   000000 177640   000000 006014    ................
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:214  
   0     772   000000 177640   000000 006014   000001 577640   001060 006000    .............0..
   0     776   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    1012*  000001 777640   000000 006000   000000 177640   000000 006014    ................
   0    1016   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    1032*  000000 000042   000000 002001   252525 002002   000040 252520    ..."......... ..
   0    1036   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   0    1042   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    1046   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   0    1052   040040 040040   000000 000000   000000 000000   000000 000000        ............
   0    1056   000000 000000   ****** ******                                    ........

NAME_NODE
 Sect OctLoc
   0    1060   006072 116117   104105 123***                                    .:NODES.

READ_NODE
 Sect OctLoc
   0    1062   000005 777640   001072 006000   000002 177640   001136 006000    .....:.......^..
   0    1066   000005 377640   001141 006000   000000 177640   000000 006014    .....a..........
   0    1072   000000 600000   000000 000000   000000 000000   000000 000000    ................
   0    1076   000000 000000   000000 000000                                    ........

CLOSE_NODE
 Sect OctLoc
   0    1100   000003 777640   001132 006000   000000 177640   000000 006014    .....Z..........
   0    1104   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    1130*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   0    1134   000220 000000   000000 000000                                    ........

NODEKEY
 Sect OctLoc
   0    1136   010*** ******   ****** ******   ****** ******                    ............

NODEOVR
 Sect OctLoc
   0    1141   ****** ******   ****** ******   ****** ******   ****** ******    ................

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:215  
HLPBUF
 Sect OctLoc
   0    1147   001140 000000   060060 060060   040040 040040   040040 040040    .`..0000
   0    1153   000040 040040   040040 040040   040040 040040   114117 103101    .           LOCA
   0    1157   114040 040040   123131 123040   040040 040040   040040 040040    L   SYS
   0    1163   040040 040040   114117 103101   114040 040040   000000 000000        LOCAL   ....
   0    1167   061040 040040   040040 061040   040040 040040   061040 040040    1     1     1
   0    1173   040040 061040   040040 040040   040040 040040   040040 040040      1
   0    1177   000000 000000   377023 417000   000000 000000   000000 000000    ................
   0    1203   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    1207   000000 000000   000000 000000   000344 702250   000344 702250    ................
   0    1213   000344 702250   000344 702250   000200 000200   000200 000200    ................
   0    1217   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    1237*  040040 040040   040040 040040   000000 000000   000000 000000            ........
   0    1277*  000037 040040   000000 000000   000000 000000   040040 000000    ..  ........  ..
   0    1303   000000 000000   000000 040040   000000 000000   000000 000000    ......  ........
   0    1307   040040 000000   000000 000000   000000 040040   000000 000000      ........  ....
   0    1313   000000 000000   040040 000000   000000 000000   000000 040040    ....  ........
   0    1317   000000 000000   000000 000000   040040 000000   000000 000000    ........  ......
   0    1323   000000 040040   000000 000000   000000 000000   040040 000000    ..  ........  ..
   0    1327   000000 000000   000000 040040   000000 000000   000000 000000    ......  ........
   0    1333   040040 000000   000000 000000   000000 040040   000000 000000      ........  ....
   0    1337   000000 000000   040040 000000   000000 000000   000000 040040    ....  ........
   0    1343   000000 000000   000000 000000   040040 000000   000000 000000    ........  ......
   0    1347   000000 040040   000000 000000   000000 000000   040040 000000    ..  ........  ..
   0    1353   000000 000000   000000 040040   000000 000000   000000 000000    ......  ........
   0    1357   040040 000000   000000 000000   000000 040040   000000 000000      ........  ....
   0    1363   000000 000000   040040 000000   000000 000000   000000 040040    ....  ........
   0    1367   000000 000000   000000 000000   040040 000000   000000 000000    ........  ......
   0    1373   000000 040040   000000 000000   000000 000000   040040 000000    ..  ........  ..
   0    1377   000000 000000   000000 040040   000000 000000   000000 000000    ......  ........
   0    1403   040040 000000   000000 000000   000000 040040   000000 000000      ........  ....
   0    1407   000000 000000   040040 000000   000000 000000   000000 040040    ....  ........
   0    1413   000000 000000   000000 000000   040040 000000   000000 000000    ........  ......
   0    1417   000000 ******                                                    ....

P_PCB
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:216  
 Sect OctLoc
   0    1420   000000 006014   000000 006014   000000 006014   000000 006014    ................
   0    1424   000000 000000   000000 600000   000000 000000   040042 040042    ............ " "
   0    1430   000000 040000   000000 000000   000000 000000   000000 006014    .. .............
   0    1434   000000 006014   000000 000000                                    ........

FMSEC
 Sect OctLoc
   0    1436   000001 777640   001440 006000   100000 000000   000000 000000    ........@.......

FPT_EXIT
 Sect OctLoc
   0    1442   000001 777640   001446 006000   000000 177640   000000 006014    ................
   0    1446   006000 000000   000000 000000                                    ........

FPT_INT
 Sect OctLoc
   0    1450   000001 777640   001452 006000   000000 000000   000000 000000    ................

FID_INP
 Sect OctLoc
   0    1454   000003 777640   001500 006000   000000 177640   000000 006014    ................
   0    1460   000007 777640   001506 006000   000001 777640   001504 006000    ................
   0    1464   000001 777640   001516 006000   000011 777640   001520 006000    ................
   0    1470   000000 177640   000000 006014   000000 777640   002432 006000    ................
   0    1474   000000 777640   002434 006000   000011 777640   001532 006000    ................
   0    1500   777000 000000   000000 000000   000000 000000   ****** ******    ................

ACCT_INP
 Sect OctLoc
   0    1504   040040 040040   040040 040040

NAME_INP
 Sect OctLoc
   0    1506   001040 040040   040040 040040   040040 040040   040040 040040    .
   0    1512   040040 040040   040040 040040   040040 040040   040040 040040

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:217  
PASS_INP
 Sect OctLoc
   0    1516   040040 040040   040040 040040

SN_INP
 Sect OctLoc
   0    1520   000000 000006   040040 040040   040040 040040   040040 040040    ....
   0    1524   040040 040040   040040 040040   040040 040040   040040 040040
   0    1530   040040 040040   040040 040040

INP_VLR
 Sect OctLoc
   0    1532   ****** ******   ****** ******   ****** ******   ****** ******    ................

FID_OUT
 Sect OctLoc
   0    1544   000003 777640   001570 006000   000000 177640   000000 006014    ................
   0    1550   000007 777640   001576 006000   000001 777640   001574 006000    ................
   0    1554   000001 777640   001606 006000   000011 777640   001610 006000    ................
   0    1560   000000 177640   000000 006014   000000 777640   002433 006000    ................
   0    1564   000000 777640   002435 006000   000011 777640   001622 006000    ................
   0    1570   777000 000000   000000 000000   000000 000000   ****** ******    ................

ACCT_OUT
 Sect OctLoc
   0    1574   040040 040040   040040 040040

NAME_OUT
 Sect OctLoc
   0    1576   001040 040040   040040 040040   040040 040040   040040 040040    .
   0    1602   040040 040040   040040 040040   040040 040040   040040 040040

PASS_OUT
 Sect OctLoc
   0    1606   040040 040040   040040 040040

SN_OUT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:218  
 Sect OctLoc
   0    1610   000000 000006   040040 040040   040040 040040   040040 040040    ....
   0    1614   040040 040040   040040 040040   040040 040040   040040 040040
   0    1620   040040 040040   040040 040040

OUT_VLR
 Sect OctLoc
   0    1622   ****** ******   ****** ******   ****** ******   ****** ******    ................

MAIL_VLR
 Sect OctLoc
   0    1634   ****** ******   ****** ******   ****** ******   ****** ******    ................

UNFID_INP
 Sect OctLoc
   0    1646   000001 777640   001672 006000   000023 577640   000025 206000    ................
   0    1652   000007 777640   001506 006000   000001 777640   001504 006000    ................
   0    1656   000001 777640   001516 006000   000011 777640   001520 006000    ................
   0    1662   000000 177640   000000 006014   000000 777640   002432 006000    ................
   0    1666   000000 777640   002434 006000   000000 777640   002422 006000    ................
   0    1672   000000 000000   0***** ******                                    ........

UNFID_OUT
 Sect OctLoc
   0    1674   000001 777640   001720 006000   000023 577640   000075 206000    .............=..
   0    1700   000007 777640   001576 006000   000001 777640   001574 006000    ................
   0    1704   000001 777640   001606 006000   000011 777640   001610 006000    ................
   0    1710   000000 177640   000000 006014   000000 777640   002433 006000    ................
   0    1714   000000 777640   002435 006000   000000 777640   002422 006000    ................
   0    1720   000000 000000   0***** ******                                    ........

OPEN_ITST
 Sect OctLoc
   0    1722   000025 777640   001766 006000   000011 777640   001520 006000    ................
   0    1726   000000 177640   000000 006014   000007 777640   001506 006000    ................
   0    1732   000001 777640   001516 006000   000000 177640   000000 006014    ................
   0    1736   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:219  
   0    1746*  000001 777640   001504 006000   000000 177640   000000 006014    ................
   0    1752   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    1766*  000000 420442   000000 002001   252525 000000   000040 252520    ............. ..
   0    1772   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   0    1776   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    2002   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   0    2006   040040 040040   000000 000000   000000 000000   000000 000000        ............
   0    2012   000000 000000   ****** ******                                    ........

OPEN_OTST
 Sect OctLoc
   0    2014   000025 777640   002060 006000   000011 777640   001610 006000    .....0..........
   0    2020   000000 177640   000000 006014   000007 777640   001576 006000    ................
   0    2024   000001 777640   001606 006000   000000 177640   000000 006014    ................
   0    2030   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    2040*  000001 777640   001574 006000   000000 177640   000000 006014    ................
   0    2044   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    2060*  000000 420442   000000 002001   252525 000000   000040 252520    ............. ..
   0    2064   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   0    2070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    2074   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   0    2100   040040 040040   000000 000000   000000 000000   000000 000000        ............
   0    2104   000000 000000   ****** ******                                    ........

READ_ME
 Sect OctLoc
   0    2106   000005 777640   002116 006000   000000 177640   000000 006014    .....N..........
   0    2112   000077 777640   004442 006000   000000 177640   000000 006014    .?..............
   0    2116   000000 400000   000000 000000   000000 000000   000000 000000    ................
   0    2122   000000 000000   000000 000000                                    ........

OPEN_HLP
 Sect OctLoc
   0    2124   000025 777640   002170 006000   000000 177640   000000 006014    .....x..........
   0    2130   000000 177640   000000 006014   000001 177640   002216 006000    ................
   0    2134   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    2150*  000001 777640   002220 006000   000000 177640   000000 006014    ................
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:220  
   0    2154   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    2170*  000000 000052   000000 002001   252525 000002   000040 252520    ...*......... ..
   0    2174   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   0    2200   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    2204   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   0    2210   040040 040040   000000 000000   000000 000000   000000 000000        ............
   0    2214   000000 000000   ****** ******                                    ........

NAME_HLP
 Sect OctLoc
   0    2216   004072 110114   120*** ******                                    .:HLP...

ACCT_HLP
 Sect OctLoc
   0    2220   072123 131123   040040 040040                                    :SYS

READ_HLP
 Sect OctLoc
   0    2222   000005 777640   002232 006000   000005 177640   004646 006000    ................
   0    2226   000250 777640   001147 006000   000000 177640   000000 006014    .....g..........
   0    2232   000000 600000   000000 000000   000000 000000   000000 000000    ................
   0    2236   000000 000000   000000 000000                                    ........

CLOSE_HLP
 Sect OctLoc
   0    2240   000003 777640   002272 006000   000000 177640   000000 006014    ................
   0    2244   000000 177640   000000 006014   000000 177640   000000 006014    ................
   0    2270*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   0    2274   000220 000000   000000 000000                                    ........

SNOOZE
 Sect OctLoc
   0    2276   000001 777640   002302 006000   000000 177640   000000 006014    ................
   0    2302   000000 000005   000000 000001                                    ........

ECHO_OF
 Sect OctLoc
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:221  
   0    2304   000001 777640   002312 006000   000000 177640   000000 006014    ................
   0    2310   000003 777640   002314 006000   000000 000000   000000 000000    ................

VLP_OF
 Sect OctLoc
   0    2314   125025 125125   125125 377377   125157 377377   377377 125177    U.UUUU..Uo....U.

ECHO_ON
 Sect OctLoc
   0    2320   000001 777640   002326 006000   000000 177640   000000 006014    ................
   0    2324   000003 777640   002330 006000   000000 000000   000000 000000    ................

VLP_ON
 Sect OctLoc
   0    2330   125225 125125   125125 377377   125157 377377   377377 125177    U.UUUU..Uo....U.

FPT_PROMPT
 Sect OctLoc
   0    2334   000003 777640   002342 006000   000000 177640   000000 006014    ................
   0    2340   000000 177640   000000 006014   000000 000000   000000 000000    ................
   0    2344   100000 000000   000000 000000                                    @.......

FPT_PRIV
 Sect OctLoc
   0    2346   000001 777640   002350 006000   020000 000000   000000 000000    ................

XUR_INIT
 Sect OctLoc
   0    2352   520000 000001   000000 000000   000000 000000   000000 000000    ................
   0    2356   001420 006000   001777 777640   002442 006000   000000 000000    ................
   0    2362   000000 006014   000000 000000   000000 000000   ****** ******    ................
   0    2366   000000 177640   000000 006014   000000 000000   000000 000000    ................
   0    2372   000000 177640   000000 006014   000000 000000   00000* ******    ................
   0    2376   000000 000000   000000 000000   000000 000000   000000 000000    ................
   0    2416*  000000 000000   000000 000000   000000 000000                    ............

WRKBUF
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:222  
 Sect OctLoc
   0    2442   ****** ******   ****** ******   ****** ******   ****** ******    ................

MEBUF
 Sect OctLoc
   0    4442   ****** ******   ****** ******   ****** ******   ****** ******    ................

LOBUF
 Sect OctLoc
   0    4542   ****** ******   ****** ******   ****** ******   ****** ******    ................

ACCTNAME
 Sect OctLoc
   0    4646   ****** ******   ****** ******   ****** ******   ****** ******    ................

U1
 Sect OctLoc
   0    4654   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
   0    4730   ****** ******   ****** ******   ****** ******   ****** ******    ................

ACCT_NODE
 Sect OctLoc
   2     000   072123 131123   040040 040040                                    :SYS

MODE
 Sect OctLoc
   3     000   006144 151141   154165 160040   040040 040040   010150 141162    .dialup     .har
   3     004   144167 151162   145040 040040                                    dwire

TYPE
 Sect OctLoc
   3     006   006103 120066   103060 060040   040006 103120   066102 060063    .CP6C00  .CP6B03
   3     012   040040 006103   120066 102060   062040 040003   103120 066040      .CP6B02  .CP6
   3     016   040040 040040   004103 120055   066040 040040   040003 103120        .CP-6    .CP
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:223  
   3     022   126040 040040   040040 004103   120055 126040   040040 040005    V     .CP-V    .
   3     026   107103 117123   063040 040040   005107 103117   123070 040040    GCOS3   .GCOS8
   3     032   040007 107103   117123 066120   106040 005107   103117 123066     .GCOS6PF .GCOS6
   3     036   040040 040010   105130 124105   122116 101114                       .EXTERNAL

ASTERISK
 Sect OctLoc
   3     041   100052 ******                                                    @*..

ERRMSGFID
 Sect OctLoc
   3     042   017072 126127   105122 122115   123107 056072   123131 123040    .:VWERRMSG.:SYS
   3     046   040040 040040   040040 040040   040040 040040   040040 040040
   3     052   040040 040040   040040 040040

PROMPT
 Sect OctLoc
   3     054   002072 072***                                                    .::.

UPPERS
 Sect OctLoc
   3     055   040040 040040   040040 040040   040040 040040   040040 040040
   3     065*  040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
   3     071   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
   3     075   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
   3     101   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
   3     105   140101 102103   104105 106107   110111 112113   114115 116117    `ABCDEFGHIJKLMNO
   3     111   120121 122123   124125 126127   130131 132173   174175 176040    PQRSTUVWXYZ{|}~

DIM
 Sect OctLoc
   3     115   037*** ******   035*** ******   037*** ******   036*** ******    ................
   3     121   037*** ******   036*** ******   037*** ******   037*** ******    ................
   3     125   036*** ******   037*** ******   036*** ******   037*** ******    ................

BADDIES
 Sect OctLoc
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:224  
   3     131   001001 001001   001001 001001   001001 001001   001001 001001    ................
   3     141*  001001 001001   000001 001001   001001 001001   001001 001001    ................
   3     145   000000 000000   000000 000000   000000 000001   001001 001001    ................
   3     151   001000 000000   000000 000000   000000 000000   000000 000000    ................
   3     155   000000 000000   000000 000000   000000 000001   001001 001001    ................
   3     161   001000 000000   000000 000000   000000 000000   000000 000000    ................
   3     165   000000 000000   000000 000000   000000 000001   001001 001001    ................

(unnamed)
 Sect OctLoc
   3     171   020000 000000   052111 101115   105116 104040   121125 111124    ....*IAMEND QUIT
   3     175   123124 117120   105130 111124   114117 103101   114040 040040    STOPEXITLOCAL
   3     201   103122 040040   115105 040040   114124 040040   115124 040040    CR  ME  LT  MT
   3     205   106124 040040   103120 040040   114120 040040   112105 040040    FT  CP  LP  JE
   3     211   123125 103113   102105 101115   115101 111114   122105 103123    SUCKBEAMMAILRECS
   3     215   117120 124123   104101 124105   107124 040040   105121 040040    OPTSDATEGT  EQ
   3     221   107105 040040   116105 040040   114105 040040   131105 123124    GE  NE  LE  YEST
   3     225   105122 104101   131040 040040   124117 104101   131040 040040    ERDAY   TODAY
   3     231   000000 000020   140040 114157   147157 156040   100040 040040    ....` Logon @
   3     235   072115 101111   114040 040040   065060 060101   124117 102040    :MAIL   500ATOB

(unnamed)
 Sect OctLoc
   4     000   000000 000000   000000 000000   000000 000000   000000 000501    ................
   4     004   000000 000000   000000 000000   000000 006014   000000 006014    ................
   4     010   026052 103117   116124 111116   125101 124111   117116 137103    .*CONTINUATION_C
   4     014   117115 115101   116104 123040   040040 040040   040040 040040    OMMANDS
   4     020   040040 040040   040040 040040   040040 040040   040040 040040
   4     024   040040 040040   040040 040040   115105 040040   040040 040040            ME
   4     030   040040 040040   000000 202015   000002 001000   000000 000000        ............
   4     034   000000 000000   000000 000000   000000 000000   000002 776003    ................
   4     040   001000 000000   000000 000002   000000 000000   000000 000000    ................
   4     044   000000 000111   040040 040040   000000 006014   000000 006014    ...I    ........
   4     050   000000 006014   000000 000000   000000 000000   000000 006014    ................
   4     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     060   000000 010000   000000 000000   000000 000000   000000 000000    ................
   4     064   000000 000020   000000 000000   000000 006014   000000 000000    ................
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:225  
   4     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     074   000000 000000   000000 006014   000000 000000   000000 000000    ................
   4     100   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     104   ****** ******   ****** ******   000000 000000   ****** ******    ................
   4     110   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     124*  000000 000000   000000 000000   000000 000000   ****** ******    ................
   4     134*  ****** ******   ****** ******   ****** ******   000000 070707    ..............8.
   4     140   ****** ******   ****** ******                                    ........

(unnamed)
 Sect OctLoc
  11     000   000001 000000   002352 006000   000042 006000   262715 000210    ........."......
  11     004   000003 006000   073040 040040   000005 000000   000000 006014    ....;   ........
  11     010   002422 006000   004442 006000   000000 006000   002437 006000    ................
  11     014   000002 000000   000003 000000   000000 006000   002437 006000    ................
  11     020   000054 006000   040040 040040   130040 040040   105040 040040    .,..    X   E
  11     024   121040 040040   262715 000050   000025 006000   100040 040040    Q   ...(....@
  11     030   262715 000230   000030 006000   000001 006000   002436 006000    ................
  11     034   262715 000060   000034 006000   262715 000220   000036 006000    ...0............
  11     040   000051 006000   262715 000260   000041 006000   262715 000350    .).......!......
  11     044   000043 006000   000000 006003   262715 000660   000046 006000    .#...........&..
  11     050   262715 000360   000050 006000   000000 006000   000004 000000    .....(..........
  11     054   262715 000000   000054 006000   262715 000270   000056 006000    .....,..........
  11     060   262715 000310   000060 006000   000023 577640   000025 206000    .....0..........
  11     064   262715 000010   000064 006000   077040 040040   056040 040040    .....4..?   .
  11     070   040040 040040   040040 040040   000023 577640   000075 206000            .....=..
  11     074   262715 000020   000074 006000   262715 000370   000076 006000    .....<.......>..
  11     100   400000 000000   000000 000000   000001 006000   000100 006000    .............@..
  11     104   000051 006000   000101 006000   000051 006000   000100 006000    .)...A...)...@..
  11     110   262715 000110   000110 006000   000265 206000   004644 006000    ...H.H..........
  11     114   262715 000500   000114 006000   262715 000400   000116 006000    .....L.......N..
  11     120   000145 206000   000002 006000   262715 000440   000122 006000    .e...........R..
  11     124   000215 206000   000052 006000   777777 777377   262715 000450    .....*..........
  11     130   000000 377640   000041 006000   000127 006000   000000 000000    .....!...W......
  11     134   000023 777640   004654 006000   262715 000460   000134 006000    .............\..
  11     140   000136 006000   047040 040040   262715 000610   000142 006000    .^..'   .....b..
  11     144   000311 006000   262715 000640   000145 006000   262715 000340    .........e......
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:226  
  11     150   000147 006000   262715 000070   000151 006000   262715 000410    .g.....8.i......
  11     154   000153 006000   262715 000430   000155 006000   103040 040040    .k.......m..C
  11     160   115040 040040   055040 040040   262715 000620   000162 006000    M   -   .....r..
  11     164   000002 377640   004542 006000   054040 040040   262715 000300    ........,   ....
  11     170   000167 006000   004726 006000   262715 000150   000172 006000    .w.........h.z..
     1886    19606        %EOD;

PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:227  
--  Include file information  --

   VW_FPTS_M.:VMB6TOU  cannot be made into a system file and is referenced.
   VW_NODEATER_E.:VMB6TOU  is referenced.
   VW_OPTS_M.:VMB6TOU  is referenced.
   VWM_ERRS_E.:VMB6TOU  is referenced.
   VW_MOVE_E.:VMB6TOU  is referenced.
   XUR_ENTRY.:LIB_E05  cannot be made into a system file and is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   KL_SUPER_C.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VWM$MOVE.
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:228  

 **** Variables and constants ****

  ****  Section 000  Data  VWM$MOVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  4704-0-0/w PTR         r     1 @ARGB                   4716-0-0/w PTR         r     1 @ARGB
  4703-0-0/w PTR         r     1 @BLK$                   4717-0-0/w PTR         r     1 @DOIT
  4646-0-0/c STRC(189)   r     1 ACCTNAME                2220-0-0/c STRC(72)    r     1 ACCT_HLP
  1504-0-0/c STRC(72)    r     1 ACCT_INP                1574-0-0/c STRC(72)    r     1 ACCT_OUT
    *0-0-0/w STRC(1440)  r     1 ARGB                      *0-0-0/w STRC(1440)  r     1 ARGB
    *0-0-0/w CHAR(160)   r     1 ARGF                      *0-0-0/w CHAR(160)   r     1 ARGF
  2432-0-0/w UBIN(9)     r     1 ASN_INP                 2433-0-0/w UBIN(9)     r     1 ASN_OUT
  4726-0-0/c UBIN(6)     r     1 BIT6(0:11)              2437-0-0/w PTR         r     1 BLK$
    *0-0-0/w PTR         r     1 BLK$                       1-0-0/c CHAR(80)    r     1 CARD(0:24)
  2240-0-0/d STRC(1080)  r     1 CLOSE_HLP               1100-0-0/d STRC(1080)  r     1 CLOSE_NODE
  4711-0-0/w UBIN        r     1 DD                        *0-0-0/b BIT         r     1 DOIT
  4642-0-0/c CHAR(8)     r     1 DWORK                   2304-0-0/d STRC(288)   r     1 ECHO_OF
  2320-0-0/d STRC(288)   r     1 ECHO_ON                 1454-0-0/d STRC(864)   r     1 FID_INP
  1544-0-0/d STRC(864)   r     1 FID_OUT                 1436-0-0/d STRC(144)   r     1 FMSEC
  1442-0-0/d STRC(216)   r     1 FPT_EXIT                1450-0-0/d STRC(144)   r     1 FPT_INT
  2346-0-0/d STRC(144)   r     1 FPT_PRIV                2334-0-0/d STRC(360)   r     1 FPT_PROMPT
  4713-0-0/w UBIN        r     1 FRST                    1147-0-0/w STRC(6084)  r     1 HLPBUF
  2422-0-0/w SBIN        r     1 I                       4707-0-0/w SBIN        r     1 I
  4720-0-0/w SBIN        r     1 I                       1532-0-0/d STRC(324)   r     1 INP_VLR
  2423-0-0/w SBIN        r     1 J                       4721-0-0/w SBIN        r     1 J
  2424-0-0/w SBIN              1 K                       4722-0-0/w SBIN        r     1 K
  4723-0-0/w SBIN        r     1 L                       4714-0-0/w UBIN        r     1 LAST
  4542-0-0/c CHAR(256)   r     1 LOBUF                   4724-0-0/w SBIN        r     1 M
  1634-0-0/d STRC(324)         1 MAIL_VLR                4442-0-0/c CHAR(256)   r     1 MEBUF
  4710-0-0/w UBIN        r     1 MM                      4725-0-0/w SBIN        r     1 N
  2216-0-0/c STRC(45)    r     1 NAME_HLP                1506-0-0/c STRC(288)   r     1 NAME_INP
  1060-0-0/c STRC(63)    r     1 NAME_NODE               1576-0-0/c STRC(288)   r     1 NAME_OUT
  1136-0-0/c STRC(81)    r     1 NODEKEY                 1141-0-0/c STRC(198)   r     1 NODEOVR
  1141-0-0/c CHAR(22)    r     1 NODEREC                 4701-0-0/b BIT         r     1 ONCE
  2124-0-0/d STRC(2088)  r     1 OPEN_HLP                1722-0-0/d STRC(2088)  r     1 OPEN_ITST
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:229  
   766-0-0/d STRC(2088)  r     1 OPEN_NODE               2014-0-0/d STRC(2088)  r     1 OPEN_OTST
  2440-0-0/w PTR         r     1 OPT$                       1-0-0/c STRC(18000) r     1 OPTS
  2425-0-0/w SBIN        r     1 OPTX                    1622-0-0/d STRC(324)   r     1 OUT_VLR
  2436-0-0/w PTR         r     1 P                       4705-0-0/w PTR         r     1 P
  4726-0-0/c CHAR(8)     r     1 PASSWORD                1516-0-0/c STRC(72)    r     1 PASS_INP
  1606-0-0/c STRC(72)    r     1 PASS_OUT                1420-0-0/w STRC(504)   r     1 P_PCB
  4706-0-0/w PTR         r     1 Q                       2222-0-0/d STRC(504)   r     1 READ_HLP
  2106-0-0/d STRC(504)   r     1 READ_ME                 1062-0-0/d STRC(504)   r     1 READ_NODE
  2426-0-0/w SBIN        r     1 RECX                    2434-0-0/c CHAR(4)     r     1 RES_INP
  2435-0-0/c CHAR(4)     r     1 RES_OUT                 2276-0-0/d STRC(216)   r     1 SNOOZE
  1520-0-0/d STRC(360)   r     1 SN_INP                  1610-0-0/d STRC(360)   r     1 SN_OUT
  4654-0-0/c STRC(720)   r     1 U1                      1646-0-0/d STRC(792)   r     1 UNFID_INP
  1674-0-0/d STRC(792)   r     1 UNFID_OUT               2314-0-0/d STRC(144)   r     1 VLP_OF
  2330-0-0/d STRC(144)   r     1 VLP_ON                  4644-0-0/c CHAR(8)     r     1 VW_IAM#
  2427-0-0/w SBIN        r     1 VW_INPCNT#                 1-0-0/c CHAR(2000)  r     1 VW_OPTIONS#
  2430-0-0/w SBIN        r     1 VW_OUTCNT#              4700-0-0/b BIT               1 VW_SCRAMBLE#
  2431-0-0/w SBIN              1 VW_TOTBYTES#            2442-0-0/d CHAR(4096)  r     1 WRKBUF
  2352-0-0/d STRC(1404)  r     1 XUR_INIT                4712-0-0/w UBIN        r     1 YY

  ****  Section 002 RtLmCm ACCT_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(72)    r     1 ACCT_NODE

  ****  Section 003 RoData VWM$MOVE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    41-0-0/c CHAR(2)     r     1 ASTERISK                 131-0-0/b UBIN(9)     r     1 BADDIES(0:127)
   115-0-0/w UBIN(9)     r     1 DIM(0:11)                 42-0-0/c STRC(360)   r     1 ERRMSGFID
     0-0-0/c STRC(108)         1 MODE(0:1)                 54-0-0/c STRC(27)    r     1 PROMPT
     6-0-0/c STRC(81)          1 TYPE(0:11)                55-0-0/c CHAR(64)    r     1 UPPERS(0:1)

  ****  SYMREF variables  ****
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:230  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$SR_NON_BLANK$
     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 B$XL_UPPER$
     0-0-0/c ASTR(9)     r     1 B_VERSION                  0-0-0/b BIT         r     1 VWM_COMMAND

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/d STRC(4608)  r     1 B$SR_NON_BLANK             0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC(4608)  r     1 B$XL_UPPER                 0-0-0/d ASTR(3528)  r     1 DUMMY
     0-0-0/d ASTR(3528)  r     1 M$CONTINUATION             0-0-0N  NULL        r     1 M$HLP
     0-0-0N  NULL        r     1 M$INP                      0-0-0N  NULL        r     1 M$LL
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$NODE
     0-0-0N  NULL        r     1 M$UC                       0-0-0/c STRC(720)         1 OPTSCHAR
     0-0-0/c STRC(720)   r     1 OPTSDATE                   0-0-0/c STRC(720)   r     1 OPTSRECS
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure VWM$MOVE requires 2569 words for executable code.
   Procedure VWM$MOVE is declared NOAUTO and requires 2526 words of local(STATIC) storage.
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:231  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:232  
          MINI XREF LISTING

ACCTNAME
     18034**DCL     17464--DCLINIT 17465--DCLINIT
ACCTNAME.ACCT
     18036**DCL     18696<<ASSIGN
ACCTNAME.L
     18035**DCL     18699<<ASSIGN
ACCTNAME.NAME
     18037**DCL     18697<<ASSIGN
ACCT_HLP
     17440**DCL     17358--DCLINIT
ACCT_INP
     16716**DCL     16692--DCLINIT 16965--DCLINIT 17079--DCLINIT
ACCT_INP.ACCT#
     16716**DCL     18523>>IF      18527<<ASSIGN
ACCT_NODE
     15928**DCL     15845--DCLINIT
ACCT_OUT
     16842**DCL     16818--DCLINIT 16992--DCLINIT 17199--DCLINIT
ACCT_OUT.ACCT#
     16842**DCL     18625>>IF      18629<<ASSIGN
ANYWAY
     18738**LABEL   18714--GOTO    18722--GOTO
ARGB IN PROCEDURE LOGON
     19355**DCL     19353--PROC    19367--REDEF
ARGB.ACCT IN PROCEDURE LOGON
     19357**DCL     19396>>IF      19396>>IF      19405>>IF      19406<<ASSIGN  19534<<ASSIGN  19564<<ASSIGN
     19580>>IF      19595>>IF
ARGB.BIT9 IN PROCEDURE LOGON
     19360**DCL     19585<<ASSIGN
ARGB.EPASS IN PROCEDURE LOGON
     19359**DCL     19360--REDEF   19396>>IF      19495<<ASSIGN  19566<<ASSIGN  19581>>ASSIGN
ARGB.MISC.PROMPT IN PROCEDURE LOGON
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:233  
     19363**DCL     19417>>IF      19473>>IF      19491>>IF
ARGB.NAME IN PROCEDURE LOGON
     19358**DCL     19396>>IF      19407>>IF      19408<<ASSIGN  19535<<ASSIGN  19565<<ASSIGN  19595>>IF
ARGB.NODE IN PROCEDURE LOGON
     19365**DCL     19396>>IF      19420>>CALLBLT 19421>>CALLBLT 19580>>IF      19595>>IF
ARGB IN PROCEDURE OPTIONS
     18953**DCL     18949--PROC    18964--REDEF
ARGB.ACCT IN PROCEDURE OPTIONS
     18955**DCL     19021<<ASSIGN  19033<<ASSIGN
ARGB.EPASS IN PROCEDURE OPTIONS
     18957**DCL     19008<<ASSIGN  19037<<ASSIGN
ARGB.MISC.PROMPT IN PROCEDURE OPTIONS
     18960**DCL     19248<<ASSIGN
ARGB.NAME IN PROCEDURE OPTIONS
     18956**DCL     19023<<ASSIGN  19035<<ASSIGN
ARGF IN PROCEDURE LOGON
     19367**DCL     19504<<ASSIGN
ARGF IN PROCEDURE OPTIONS
     18964**DCL     19010<<CALLBLT
ASN_INP
     18018**DCL     16694--DCLINIT 16967--DCLINIT 18495>>IF      18495>>IF      18495>>IF      18500>>IF
     18510>>IF      18523>>IF      18560>>IF
ASN_OUT
     18019**DCL     16820--DCLINIT 16994--DCLINIT 18589>>IF      18589>>IF      18589>>IF      18594>>IF
     18613>>IF      18625>>IF      18645>>IF      18748>>IF
ASTERISK
     18032**DCL     18882--ASSIGN
ASZ$SCRAMBLE IN PROCEDURE LOGON
     19378**DCL-ENT 19583--CALL
B$ALT.CODE
     17878**DCL     17878--REDEF   17879--REDEF   17879--REDEF
B$ALT.ERR
     17879**DCL     18563<>CALL
B$ALT.ERR.CODE
     17880**DCL     18147>>ASSIGN  18713>>IF
B$ALT.ERR.ERR#
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:234  
     17880**DCL     17880--REDEF
B$ALT.EVID
     17879**DCL     17879--REDEF   17879--REDEF
B$JIT.ACCN
      6604**DCL     18546>>IF      18670>>ASSIGN  18694>>IF      18748>>IF      19406>>ASSIGN
B$JIT.CCARS
      6692**DCL     18133>>ASSIGN
B$JIT.CCBUF
      6692**DCL     18134>>ASSIGN
B$JIT.CPFLAGS1
      6693**DCL     19417>>IF
B$JIT.CPFLAGS1.SLEAZE
      6698**DCL      6698--REDEF
B$JIT.ERR.MID
      6605**DCL      6605--REDEF
B$JIT.FACCN
      6604**DCL     18527>>ASSIGN  18629>>ASSIGN
B$JIT.FPSN
      6685**DCL     18529>>ASSIGN  18631>>ASSIGN
B$JIT.JRESPEAK
      6766**DCL      6767--REDEF
B$JIT.MODE
      6599**DCL     19417>>IF      19419>>IF      19473>>IF      19491>>IF      19500>>IF      19518>>IF
     19524>>IF      19530>>IF      19548>>IF      19554>>IF      19560>>IF      19569>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6875**DCL      6875--REDEF    6876--REDEF
B$JIT.PNR
      6779**DCL      6779--REDEF
B$JIT.PRFLAGS.CONTINUED
      6688**DCL     18128>>IF
B$JIT.PRIV.ACTIVE.FMSEC
      6606**DCL     18079>>IF
B$JIT.PRIV.JOB
      6648**DCL     18100>>IF      18720>>IF
B$JIT.PRIV.JOB.FMSEC
      6649**DCL     18079>>IF
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:235  
B$JIT.TSLINE
      6873**DCL      6874--REDEF
B$JIT.UNAME
      6604**DCL     18546>>IF      18671>>ASSIGN  18694>>IF      18748>>IF      19408>>ASSIGN
B$JIT$
     17998**DCL      6599--IMP-PTR 18079>>IF      18079>>IF      18100>>IF      18128>>IF      18133>>ASSIGN
     18134>>ASSIGN  18527>>ASSIGN  18529>>ASSIGN  18546>>IF      18546>>IF      18629>>ASSIGN  18631>>ASSIGN
     18670>>ASSIGN  18671>>ASSIGN  18694>>IF      18694>>IF      18720>>IF      18748>>IF      18748>>IF
     19406>>ASSIGN  19408>>ASSIGN  19417>>IF      19417>>IF      19419>>IF      19473>>IF      19491>>IF
     19500>>IF      19518>>IF      19524>>IF      19530>>IF      19548>>IF      19554>>IF      19560>>IF
     19569>>IF
B$SR_NON_BLANK
     16623**DCL     18809>>CALLBLT 18826>>CALLBLT 18842>>CALLBLT
B$SR_NON_BLANK$
     16622**DCL     16623--IMP-PTR 18809>>CALLBLT 18826>>CALLBLT 18842>>CALLBLT
B$TCB.ALT$
     17873**DCL     18147>>ASSIGN  18563>>CALL    18713>>IF
B$TCB$
     17999**DCL     18147>>ASSIGN  18563>>CALL    18713>>IF
B$XL_UPPER
     16619**DCL     18231>>CALLBLT 18322>>CALLBLT
B$XL_UPPER$
     16618**DCL     16619--IMP-PTR 18231>>CALLBLT 18322>>CALLBLT
BADDIES IN PROCEDURE LOGON
     19384**DCL     19522>>CALLBLT 19528>>CALLBLT 19552>>CALLBLT 19558>>CALLBLT
BIT6 IN PROCEDURE LOGON
     19381**DCL     19585>>ASSIGN
BLK$
     18024**DCL     16538--IMP-PTR 16585--IMP-PTR 18139<>CALL    18142<>CALL    18146<>CALL    18154<>CALL
     18177<<ASSIGN  18186>>IF      18188>>IF      18189>>ASSIGN  18202>>IF      18204>>ASSIGN  18247>>IF
     18249>>ASSIGN  18265>>IF      18267>>ASSIGN  18279>>IF      18281>>ASSIGN  18293>>IF      18295>>ASSIGN
     18338>>IF      18340>>ASSIGN  18356>>IF      18358>>ASSIGN  18370>>IF
BLK$ IN PROCEDURE OPTIONS
     18951**DCL     18949--PROC    18986>>DOINDEX 18987>>ASSIGN
B_VERSION
     18000**DCL     18460--CALL    18681--CALL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:236  
B_VERSION.L
     18001**DCL     18002--IMP-SIZ 18460>>CALL    18681>>CALL
CARD
     15558**DCL     18457>>IF      18766<<ASSIGN  18767<<ASSIGN  18774<<ASSIGN  18775<<ASSIGN  18804<<ASSIGN
     18805<<ASSIGN  18902>>IF      19133<<ASSIGN  19134<<ASSIGN  19144<<ASSIGN  19163<<ASSIGN  19181<<ASSIGN
     19182<<ASSIGN  19192<<ASSIGN  19210<<ASSIGN  19211<<ASSIGN  19221<<ASSIGN
CLOSE_HLP
     17512**DCL     18719<>CALL    18724<>CALL
CLOSE_HLP.SN_
     17512**DCL     17512--REDEF
CLOSE_HLP.UTL_
     17513**DCL     17513--REDEF
CLOSE_HLP.V
     17517**DCL     17512--DCLINIT
CLOSE_HLP.V.EXPIRE#
     17527**DCL     17527--REDEF
CLOSE_HLP.V.TYPE#
     17525**DCL     17525--REDEF
CLOSE_HLP.V.XTNSIZE#
     17522**DCL     17522--REDEF   17524--REDEF
CLOSE_NODE.SN_
     16000**DCL     16000--REDEF
CLOSE_NODE.UTL_
     16001**DCL     16001--REDEF
CLOSE_NODE.V
     16005**DCL     16000--DCLINIT
CLOSE_NODE.V.EXPIRE#
     16015**DCL     16015--REDEF
CLOSE_NODE.V.TYPE#
     16013**DCL     16013--REDEF
CLOSE_NODE.V.XTNSIZE#
     16010**DCL     16010--REDEF   16012--REDEF
DD IN PROCEDURE OPTIONS
     18971**DCL     19297<<CALLBLT 19301>>IF      19301>>IF      19301>>IF      19307<<ASSIGN  19307>>ASSIGN
     19308>>CALLBLT
DECIDE
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:237  
     18917**LABEL   18208--GOTO    18227--GOTO    18253--GOTO    18269--CALLALT 18299--GOTO    18318--GOTO
     18344--GOTO    18360--CALLALT 18372--GOTO    18399--GOTO    18406--GOTO    18415--GOTO    18432--GOTO
     18440--GOTO    18477--GOTO    18492--GOTO    18497--GOTO    18507--GOTO    18533--GOTO    18564--GOTO
     18586--GOTO    18591--GOTO    18603--GOTO    18635--GOTO    18647--GOTO    18683--CALLALT 18726--CALLALT
     18738--CALLALT 18752--GOTO    18824--GOTO    18840--GOTO    18889--GOTO    18893--GOTO
DIM IN PROCEDURE OPTIONS
     18976**DCL     19301>>IF
DOIT IN PROCEDURE LOGON
     19369**DCL     19353--PROC    19582>>IF
DONE_PARSING
     18393**LABEL   18203--GOTO    18248--GOTO    18266--GOTO    18280--GOTO    18294--GOTO    18339--GOTO
     18357--GOTO
DUMMY.ACTPOS
     17847**DCL     17847--REDEF
DUMMY.ARS#
     17821**DCL     17821--REDEF   18401>>IF      18434>>IF
DUMMY.ATTR
     17840**DCL     17841--REDEF
DUMMY.BORROW
     17855**DCL     17855--REDEF   17855--REDEF   17855--REDEF
DUMMY.DCBNAME.L
     17869**DCL     17869--IMP-SIZ
DUMMY.EOMCHAR#
     17825**DCL     17825--REDEF
DUMMY.FLDID
     17850**DCL     17850--REDEF
DUMMY.FORM$
     17844**DCL     17844--REDEF
DUMMY.FSECT
     17860**DCL     17860--REDEF
DUMMY.FSN#
     17837**DCL     17837--REDEF   17837--REDEF   17838--REDEF
DUMMY.HEADER$
     17843**DCL     17843--REDEF
DUMMY.IXTNSIZE#
     17841**DCL     17841--REDEF
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:238  
DUMMY.LASTSTA$
     17830**DCL     17830--REDEF
DUMMY.LVL
     17856**DCL     17856--REDEF
DUMMY.NAME#.C
     17831**DCL     17831--REDEF
DUMMY.NOEOF
     17853**DCL     17853--REDEF
DUMMY.NRECS#
     17842**DCL     17842--REDEF
DUMMY.NRECX
     17861**DCL     17861--REDEF
DUMMY.OHDR
     17853**DCL     17853--REDEF
DUMMY.ORG#
     17836**DCL     17836--REDEF
DUMMY.PRECNO
     17859**DCL     17859--REDEF
DUMMY.RCSZ
     17865**DCL     17865--REDEF
DUMMY.RES#
     17832**DCL     17832--REDEF
DUMMY.SETX
     17844**DCL     17844--REDEF
DUMMY.TAB$
     17844**DCL     17844--REDEF
DUMMY.TDA
     17858**DCL     17859--REDEF
DUMMY.WSN#
     17832**DCL     17832--REDEF
DWORK
     18030**DCL     18435<<ASSIGN  18444>>ASSIGN  19308<<CALLBLT 19309>>ASSIGN
ECHO_OF
     17565**DCL     19424<>CALL
ECHO_OF.V
     17573**DCL     17567--DCLINIT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:239  
ECHO_ON
     17636**DCL     19570<>CALL
ECHO_ON.V
     17644**DCL     17638--DCLINIT
ERRMSGFID
     18039**DCL     18098<>CALL
FID_INP
     16691**DCL     18490<>CALL
FID_INP.TEXTFID_
     16691**DCL     18489<<ASSIGN
FID_INP.V
     16695**DCL     16691--DCLINIT
FID_OUT
     16817**DCL     18584<>CALL
FID_OUT.TEXTFID_
     16817**DCL     18583<<ASSIGN
FID_OUT.V
     16821**DCL     16817--DCLINIT
FMSEC
     16637**DCL     18081<>CALL
FMSEC.V
     16637**DCL     16637--DCLINIT
FPT_EXIT
     16653**DCL     18111<>CALL    18117<>CALL    18143<>CALL
FPT_EXIT.V
     16653**DCL     16653--DCLINIT
FPT_EXIT.V.STEPCC#
     16654**DCL     16654--REDEF
FPT_INT
     16669**DCL     18885<>CALL
FPT_INT.V
     16669**DCL     16669--DCLINIT
FPT_PRIV
     17730**DCL     18101<>CALL    18709<>CALL    18721<>CALL
FPT_PRIV.V
     17730**DCL     17730--DCLINIT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:240  
FPT_PROMPT
     17706**DCL     18883<>CALL    19423<>CALL
FPT_PROMPT.PROMPT_
     17712**DCL     18882<<ASSIGN  19422<<ASSIGN
FPT_PROMPT.V
     17714**DCL     17708--DCLINIT
FRST IN PROCEDURE OPTIONS
     18973**DCL     19090<<CALLBLT 19092>>ASSIGN  19098>>IF      19101>>CALLBLT
GET_COMMAND
     18138**LABEL   18155--GOTO    18465--GOTO    18920--GOTO
HLPBUF
     16176**DCL     17466--DCLINIT 17467--DCLINIT
HLPBUF.PASSWORD
     16234**DCL     16238--REDEF   18725>>ASSIGN
HLPBUF.RENAME
     16257**DCL     16258--REDEF
I
     18010**DCL     16968--DCLINIT 16995--DCLINIT 18129<<ASSIGN  18133<<ASSIGN  18134>>ASSIGN  18139<>CALL
     18147<<ASSIGN  18148>>IF      18148>>IF      18148>>IF      18178<<ASSIGN  18202>>IF      18204>>ASSIGN
     18234<<ASSIGN  18234>>ASSIGN  18238<<ASSIGN  18238>>ASSIGN  18247>>IF      18249>>ASSIGN  18256<<ASSIGN
     18256>>ASSIGN  18265>>IF      18267>>ASSIGN  18270<<ASSIGN  18270>>ASSIGN  18279>>IF      18281>>ASSIGN
     18284<<ASSIGN  18284>>ASSIGN  18293>>IF      18295>>ASSIGN  18325<<ASSIGN  18325>>ASSIGN  18329<<ASSIGN
     18329>>ASSIGN  18338>>IF      18340>>ASSIGN  18347<<ASSIGN  18347>>ASSIGN  18356>>IF      18358>>ASSIGN
     18361<<ASSIGN  18361>>ASSIGN  18370>>IF      18535>>ASSIGN  18561<<CALLBLT 18637>>ASSIGN  18698<<CALLBLT
     18699>>ASSIGN  18809<<CALLBLT 18810>>ASSIGN  18826<<CALLBLT 18827>>ASSIGN  18842<<CALLBLT 18843>>ASSIGN
I IN PROCEDURE LOGON
     19371**DCL     19420<<CALLBLT 19421>>CALLBLT 19422>>ASSIGN  19437<<ASSIGN  19440>>DOWHILE 19441>>IF
     19442>>IF      19443>>CALLBLT 19445>>ASSIGN  19445>>ASSIGN  19445>>ASSIGN  19447>>ASSIGN  19448<<ASSIGN
     19452<<ASSIGN  19456>>ASSIGN  19462<<ASSIGN  19462>>ASSIGN  19584<<DOINDEX 19585>>ASSIGN  19585>>ASSIGN
I IN PROCEDURE OPTIONS
     18969**DCL     18986<<DOINDEX 18987>>ASSIGN
INP_VLR
     16790**DCL     16695--DCLINIT
INP_VLR.ACCT
     16790**DCL     18523>>IF      18523>>IF      18526<<ASSIGN
INP_VLR.NAME
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:241  
     16790**DCL     18510>>IF      18512<<ASSIGN
J
     18011**DCL     18220<<CALLBLT 18221>>IF      18222>>ASSIGN  18223>>ASSIGN  18230>>ASSIGN  18231>>CALLBLT
     18311<<CALLBLT 18312>>IF      18313>>ASSIGN  18314>>ASSIGN  18321>>ASSIGN  18322>>CALLBLT 18809<<CALLBLT
     18826<<CALLBLT 18842<<CALLBLT
J IN PROCEDURE LOGON
     19372**DCL     19438<<ASSIGN  19445>>ASSIGN  19447<<ASSIGN  19447>>ASSIGN  19456>>ASSIGN  19457<<ASSIGN
     19457>>ASSIGN  19458>>IF      19487>>IF      19489>>IF      19495>>ASSIGN  19498>>IF      19504>>ASSIGN
     19516>>IF      19516>>IF      19528>>CALLBLT 19535>>ASSIGN  19546>>IF      19546>>IF      19566>>ASSIGN
K IN PROCEDURE LOGON
     19373**DCL     19439<<ASSIGN  19459<<ASSIGN  19459>>ASSIGN  19471>>IF      19477>>DOCASE  19515<<CALLBLT
     19516>>IF      19516>>IF      19516>>IF      19516>>IF      19522>>CALLBLT 19528>>CALLBLT 19528>>CALLBLT
     19534>>ASSIGN  19535>>ASSIGN  19535>>ASSIGN  19544<<CALLBLT 19545>>CALLBLT 19546>>IF      19546>>IF
     19546>>IF      19546>>IF      19552>>CALLBLT 19558>>CALLBLT 19558>>CALLBLT 19564>>ASSIGN  19565>>ASSIGN
     19565>>ASSIGN
L IN PROCEDURE LOGON
     19374**DCL     19443<<CALLBLT 19445>>ASSIGN  19445>>ASSIGN  19447>>ASSIGN  19448>>ASSIGN  19451<<ASSIGN
     19545<<CALLBLT 19546>>IF      19546>>IF      19546>>IF      19546>>IF      19558>>CALLBLT 19565>>ASSIGN
     19566>>ASSIGN  19566>>ASSIGN
LAST IN PROCEDURE OPTIONS
     18974**DCL     19092<<ASSIGN  19095<<CALLBLT 19098>>IF      19102>>CALLBLT
LOBUF
     18029**DCL     19421<<CALLBLT 19422--ASSIGN
LOGON
     19353**PROC    18683--CALL    18726--CALL    18738--CALL
M IN PROCEDURE LOGON
     19375**DCL     19522<<CALLBLT 19528<<CALLBLT 19552<<CALLBLT 19558<<CALLBLT
M$CLOSE
      5665**DCL-ENT 18719--CALL    18724--CALL
M$CONTINUATION
     17740**DCL     18099<>CALL
M$CONTINUATION.ACTPOS
     17781**DCL     17781--REDEF
M$CONTINUATION.ARS#
     17740**DCL     17740--REDEF
M$CONTINUATION.ATTR#
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:242  
     17770**DCL     17770--REDEF   17772--REDEF
M$CONTINUATION.BORROW
     17792**DCL     17792--REDEF   17792--REDEF   17792--REDEF
M$CONTINUATION.DCBNAME.L
     17811**DCL     17811--IMP-SIZ 18099>>CALL
M$CONTINUATION.EOMCHAR#
     17747**DCL     17748--REDEF
M$CONTINUATION.FLDID
     17784**DCL     17785--REDEF
M$CONTINUATION.FORM$
     17776**DCL     17776--REDEF
M$CONTINUATION.FSECT
     17799**DCL     17799--REDEF
M$CONTINUATION.FSN#
     17766**DCL     17766--REDEF   17766--REDEF   17767--REDEF
M$CONTINUATION.HEADER$
     17775**DCL     17776--REDEF
M$CONTINUATION.IXTNSIZE#
     17772**DCL     17773--REDEF
M$CONTINUATION.LASTSTA$
     17756**DCL     17756--REDEF
M$CONTINUATION.LVL
     17793**DCL     17793--REDEF
M$CONTINUATION.NAME#.C
     17756**DCL     17757--REDEF
M$CONTINUATION.NOEOF
     17788**DCL     17788--REDEF
M$CONTINUATION.NRECS#
     17773**DCL     17773--REDEF
M$CONTINUATION.NRECX
     17800**DCL     17800--REDEF
M$CONTINUATION.OHDR
     17789**DCL     17789--REDEF
M$CONTINUATION.ORG#
     17764**DCL     17765--REDEF
M$CONTINUATION.PRECNO
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:243  
     17797**DCL     17797--REDEF
M$CONTINUATION.RCSZ
     17805**DCL     17805--REDEF
M$CONTINUATION.RES#
     17758**DCL     17758--REDEF
M$CONTINUATION.SETX
     17777**DCL     17777--REDEF
M$CONTINUATION.TAB$
     17776**DCL     17776--REDEF
M$CONTINUATION.TDA
     17796**DCL     17797--REDEF
M$CONTINUATION.WSN#
     17758**DCL     17759--REDEF
M$EXIT
      5677**DCL-ENT 18111--CALL    18117--CALL    18143--CALL    18149--CALL    18153--CALL    18187--CALL
     18193--CALL    18918--CALL
M$FID
      5728**DCL-ENT 18490--CALL    18584--CALL
M$INP
     18007**DCL     18563<>CALL
M$INT
      5720**DCL-ENT 18885--CALL
M$ME
     18004**DCL     18141<>CALL    18151<>CALL    18157<>CALL    18461<>CALL    18907<>CALL
M$NODE
     18006**DCL     18401--IF      18434--IF
M$OPEN
      5665**DCL-ENT 18109--CALL    18562--CALL    18717--CALL    18750--CALL
M$PROMPT
      5689**DCL-ENT 18883--CALL    19423--CALL
M$READ
      5666**DCL-ENT 18115--CALL    18397--CALL    18404--CALL    18430--CALL    18438--CALL    18718--CALL
     19429--CALL
M$RPRIV
      5724**DCL-ENT 18081--CALL    18101--CALL    18721--CALL
M$SPRIV
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:244  
      5724**DCL-ENT 18709--CALL
M$STRMCTL
      5689**DCL-ENT 19424--CALL    19570--CALL
M$UNFID
      5728**DCL-ENT 18531--CALL    18633--CALL
M$WAIT
      5723**DCL-ENT 18715--CALL
MEBUF
     18028**DCL     17260--DCLINIT 17261--DCLINIT 18130<<ASSIGN  18134<<ASSIGN  18139<>CALL    19428<<ASSIGN
     19441>>IF      19442>>IF      19443>>CALLBLT 19445<<ASSIGN  19445>>ASSIGN  19456<<ASSIGN  19456>>ASSIGN
     19458>>IF      19488>>IF      19495>>ASSIGN  19504>>ASSIGN  19515>>CALLBLT 19522>>CALLBLT 19528>>CALLBLT
     19534>>ASSIGN  19535>>ASSIGN  19544>>CALLBLT 19545>>CALLBLT 19552>>CALLBLT 19558>>CALLBLT 19564>>ASSIGN
     19565>>ASSIGN  19566>>ASSIGN
MM IN PROCEDURE OPTIONS
     18970**DCL     19295<<CALLBLT 19301>>IF      19301>>IF      19301>>IF      19301>>IF      19307>>ASSIGN
N IN PROCEDURE LOGON
     19376**DCL     19522<<CALLBLT 19528<<CALLBLT 19552<<CALLBLT 19558<<CALLBLT
NAMESERVER
     18798**LABEL   18806--EXIT
NAME_HLP
     17425**DCL     17354--DCLINIT
NAME_INP
     16746**DCL     16692--DCLINIT 16965--DCLINIT 17075--DCLINIT 18616>>ASSIGN
NAME_INP.L#
     16746**DCL     18514<<ASSIGN  18561>>CALLBLT 18578>>ASSIGN
NAME_INP.NAME#
     16746**DCL     18513<<ASSIGN  18561>>CALLBLT 18577>>ASSIGN
NAME_NODE
     15912**DCL     15841--DCLINIT
NAME_OUT
     16872**DCL     16818--DCLINIT 16992--DCLINIT 17195--DCLINIT 18616<<ASSIGN
NODEKEY
     16056**DCL     15952--DCLINIT 15953--DCLINIT
NODEKEY.C
     16058**DCL     18114<<ASSIGN  18396<<ASSIGN  18403<<ASSIGN  18429<<ASSIGN  18437<<ASSIGN
NODEKEY.L
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:245  
     16057**DCL     18113<<ASSIGN
NODEOVR
     16067**DCL     16162--REDEF
NODEOVR.PATH_NAME
     16076**DCL     16087--REDEF   18119>>ASSIGN  18402>>ASSIGN  18403>>ASSIGN  18436>>ASSIGN  18437>>ASSIGN
NODEOVR.TYPE_DEST
     16106**DCL     18412>>IF      18442>>IF
NODEREC
     16162**DCL     15954--DCLINIT 15955--DCLINIT
ONCE
     18052**DCL     18127<<ASSIGN  18138>>IF      18458>>IF      18459<<ASSIGN  18680>>IF      18917>>IF
OPEN_HLP
     17353**DCL     18717<>CALL
OPEN_HLP.ACSVEH_
     17355**DCL     17356--REDEF
OPEN_HLP.ALTKEYS_
     17361**DCL     17362--REDEF   17362--REDEF
OPEN_HLP.HDR_
     17360**DCL     17361--REDEF
OPEN_HLP.TAB_
     17359**DCL     17360--REDEF
OPEN_HLP.UHL_
     17353**DCL     17354--REDEF   17354--REDEF
OPEN_HLP.V
     17362**DCL     17353--DCLINIT
OPEN_HLP.V.FSN#
     17393**DCL     17393--REDEF   17393--REDEF
OPEN_HLP.WSN_
     17359**DCL     17359--REDEF
OPEN_ITST
     17074**DCL     18562<>CALL
OPEN_ITST.ACSVEH_
     17076**DCL     17077--REDEF
OPEN_ITST.ALTKEYS_
     17082**DCL     17083--REDEF   17083--REDEF
OPEN_ITST.HDR_
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:246  
     17081**DCL     17082--REDEF
OPEN_ITST.TAB_
     17080**DCL     17081--REDEF
OPEN_ITST.UHL_
     17074**DCL     17075--REDEF   17075--REDEF
OPEN_ITST.V
     17083**DCL     17074--DCLINIT
OPEN_ITST.V.FSN#
     17114**DCL     17114--REDEF   17114--REDEF
OPEN_ITST.WSN_
     17080**DCL     17080--REDEF
OPEN_NODE
     15840**DCL     18109<>CALL
OPEN_NODE.ACSVEH_
     15842**DCL     15843--REDEF
OPEN_NODE.ALTKEYS_
     15848**DCL     15849--REDEF   15849--REDEF
OPEN_NODE.HDR_
     15847**DCL     15848--REDEF
OPEN_NODE.TAB_
     15846**DCL     15847--REDEF
OPEN_NODE.UHL_
     15840**DCL     15841--REDEF   15841--REDEF
OPEN_NODE.V
     15849**DCL     15840--DCLINIT
OPEN_NODE.V.FSN#
     15880**DCL     15880--REDEF   15880--REDEF
OPEN_NODE.WSN_
     15846**DCL     15846--REDEF
OPEN_OTST
     17194**DCL     18750<>CALL
OPEN_OTST.ACSVEH_
     17196**DCL     17197--REDEF
OPEN_OTST.ALTKEYS_
     17202**DCL     17203--REDEF   17203--REDEF
OPEN_OTST.HDR_
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:247  
     17201**DCL     17202--REDEF
OPEN_OTST.TAB_
     17200**DCL     17201--REDEF
OPEN_OTST.UHL_
     17194**DCL     17195--REDEF   17195--REDEF
OPEN_OTST.V
     17203**DCL     17194--DCLINIT
OPEN_OTST.V.FSN#
     17234**DCL     17234--REDEF   17234--REDEF
OPEN_OTST.WSN_
     17200**DCL     17200--REDEF
OPT$
     18025**DCL     19087<<ASSIGN  19088>>ASSIGN  19101>>CALLBLT 19102>>CALLBLT 19103>>ASSIGN  19261<<ASSIGN
     19262>>ASSIGN  19266>>ASSIGN  19268>>ASSIGN  19273>>ASSIGN  19275>>ASSIGN  19277>>ASSIGN  19279>>ASSIGN
     19281>>ASSIGN  19283>>ASSIGN  19288>>ASSIGN  19290>>ASSIGN  19292>>CALLBLT 19309>>ASSIGN  19311>>ASSIGN
OPTIONS
     18949**PROC    18269--CALL    18360--CALL
OPTS.INP
     15201**DCL     18269<>CALL    18683<>CALL
OPTS.INP.ACCT
     15213**DCL     18546>>IF      18548<<ASSIGN  18560>>IF      18822<>CALL    18862>>IF
OPTS.INP.CMD
     15207**DCL     18863<<ASSIGN  18887>>IF
OPTS.INP.EPASS
     15225**DCL     18550<<ASSIGN
OPTS.INP.FID
     15303**DCL     16964--DCLINIT 18211<<ASSIGN  18219>>IF      18220>>CALLBLT 18223<<ASSIGN  18223>>ASSIGN
     18487>>IF      18489--ASSIGN
OPTS.INP.L
     15297**DCL     18210<<ASSIGN  18222<<ASSIGN  18535<<ASSIGN
OPTS.INP.MISC.NFA
     15274**DCL     19065<<ASSIGN
OPTS.INP.MISC.NLN
     15280**DCL     19047<<ASSIGN
OPTS.INP.MISC.NSC
     15268**DCL     19056<<ASSIGN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:248  
OPTS.INP.MISC.PROMPT
     15247**DCL     18853<<ASSIGN
OPTS.INP.MISC.TRAN
     15262**DCL     19074<<ASSIGN
OPTS.INP.NAME
     15219**DCL     18546>>IF      18549<<ASSIGN
OPTS.INP.NODE
     15287**DCL     18255<<ASSIGN  18393>>IF      18393>>IF      18393>>IF      18394<<ASSIGN  18396>>ASSIGN
     18402<<ASSIGN  18408>>IF      18408>>IF      18408>>IF      18410<<ASSIGN  18475>>IF      18487>>IF
     18523>>IF      18546>>IF      18560>>IF      18765>>IF      18771>>ASSIGN
OPTS.MAILINIT.CMD
     15508**DCL     18871<<ASSIGN
OPTS.MAILINIT.L
     15536**DCL     18810<<ASSIGN  18906>>ASSIGN  19151<<ASSIGN  19170<<ASSIGN
OPTS.MAILINIT.MAILBOX
     15542**DCL     18799<>CALL    18801<<ASSIGN  18802<>CALL    18809>>CALLBLT 18905>>ASSIGN  19152<<ASSIGN
     19171<<ASSIGN
OPTS.MAILINIT.NODE
     15529**DCL     18788<<ASSIGN
OPTS.MAILINIT.WHO
     15517**DCL     18167<<ASSIGN  18765>>IF      18773>>IF      18787>>IF      18870>>IF      19143<<ASSIGN
     19162<<ASSIGN
OPTS.MAILRCVR.CMD
     15465**DCL     18869<<ASSIGN
OPTS.MAILRCVR.L
     15490**DCL     18843<<ASSIGN  19228<<ASSIGN
OPTS.MAILRCVR.MAILBOX
     15496**DCL     18838<>CALL    18842>>CALLBLT 19229<<ASSIGN
OPTS.MAILRCVR.NODE
     15483**DCL     18779<<ASSIGN
OPTS.MAILRCVR.WHO
     15471**DCL     18778>>IF      18837>>IF      18868>>IF      19220<<ASSIGN
OPTS.MAILSNDR.CMD
     15422**DCL     18867<<ASSIGN
OPTS.MAILSNDR.L
     15447**DCL     18827<<ASSIGN  19199<<ASSIGN
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:249  
OPTS.MAILSNDR.MAILBOX
     15453**DCL     18822<>CALL    18826>>CALLBLT 19200<<ASSIGN
OPTS.MAILSNDR.NODE
     15440**DCL     18771<<ASSIGN
OPTS.MAILSNDR.WHO
     15428**DCL     18770>>IF      18821>>IF      18866>>IF      19191<<ASSIGN
OPTS.OPTSRECS
     15552**DCL     19083--IF      19087--ASSIGN  19257--IF      19261--ASSIGN
OPTS.OUT
     15310**DCL     18360<>CALL    18726<>CALL    18738<>CALL
OPTS.OUT.ACCT
     15322**DCL     18668>>IF      18670<<ASSIGN  18694>>IF      18696>>ASSIGN  18748>>IF      18838<>CALL
     18864>>IF
OPTS.OUT.CMD
     15316**DCL     18865<<ASSIGN
OPTS.OUT.EPASS
     15335**DCL     18694>>IF      18725<<ASSIGN
OPTS.OUT.FID
     15410**DCL     16991--DCLINIT 18302<<ASSIGN  18310>>IF      18311>>CALLBLT 18314<<ASSIGN  18314>>ASSIGN
     18576>>IF      18576>>IF      18577<<ASSIGN  18581>>IF      18583--ASSIGN  18645>>IF
OPTS.OUT.L
     15404**DCL     18301<<ASSIGN  18313<<ASSIGN  18578<<ASSIGN  18637<<ASSIGN
OPTS.OUT.MISC.DDNF
     15363**DCL     19239<<ASSIGN
OPTS.OUT.MISC.HOW
     15387**DCL     18283<<ASSIGN  18748>>IF
OPTS.OUT.MISC.PROMPT
     15356**DCL     18854<<ASSIGN
OPTS.OUT.NAME
     15328**DCL     18668>>IF      18671<<ASSIGN  18694>>IF      18697>>ASSIGN  18698>>CALLBLT 18748>>IF
OPTS.OUT.NODE
     15394**DCL     18346<<ASSIGN  18426>>IF      18426>>IF      18426>>IF      18427<<ASSIGN  18429>>ASSIGN
     18435>>ASSIGN  18436<<ASSIGN  18444<<ASSIGN  18445>>IF      18445>>IF      18445>>IF      18447<<ASSIGN
     18475>>IF      18581>>IF      18625>>IF      18658>>IF      18659<<ASSIGN  18668>>IF      18694>>IF
     18748>>IF      18773>>IF      18779>>ASSIGN
OPTSDATE.CMD
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:250  
     15571**DCL     19311<<ASSIGN
OPTSDATE.REL
     15589**DCL     19273<<ASSIGN  19275<<ASSIGN  19277<<ASSIGN  19279<<ASSIGN  19281<<ASSIGN  19283<<ASSIGN
OPTSDATE.SUB
     15577**DCL     19262<<ASSIGN
OPTSDATE.UTS
     15596**DCL     19288<<ASSIGN  19290<<ASSIGN  19292<<CALLBLT 19309<<ASSIGN
OPTSDATE.WHICH
     15583**DCL     19266<<ASSIGN  19268<<ASSIGN
OPTSRECS.CMD
     15616**DCL     19103<<ASSIGN
OPTSRECS.FRST
     15629**DCL     19101<<CALLBLT
OPTSRECS.LAST
     15636**DCL     19102<<CALLBLT
OPTSRECS.SUB
     15622**DCL     19088<<ASSIGN
OPTX
     18013**DCL     18168<<ASSIGN  19083>>IF      19087>>ASSIGN  19104<<ASSIGN  19104>>ASSIGN  19257>>IF
     19261>>ASSIGN  19312<<ASSIGN  19312>>ASSIGN
OUT$BLK.CODE
     16546**DCL     18205>>IF      18229<<ASSIGN  18250>>IF      18268>>IF      18282>>IF      18282>>IF
     18283>>ASSIGN  18296>>IF      18320<<ASSIGN  18341>>IF      18359>>IF      18988>>DOSELCT 19007>>IF
     19265>>IF      19271>>DOSELCT 19287>>IF      19289>>IF      19291>>IF      19294>>IF
OUT$BLK.NSUBLKS
     16550**DCL     18186>>IF      18188>>IF      18202>>IF      18247>>IF      18265>>IF      18279>>IF
     18293>>IF      18338>>IF      18356>>IF      18370>>IF      18986>>DOINDEX 18997>>DOCASE  19091>>IF
     19145>>IF      19164>>IF      19193>>IF      19222>>IF
OUT$BLK.SUBLK$
     16571**DCL     18189>>ASSIGN  18204>>ASSIGN  18249>>ASSIGN  18267>>ASSIGN  18281>>ASSIGN  18295>>ASSIGN
     18340>>ASSIGN  18358>>ASSIGN  18987>>ASSIGN  19006>>ASSIGN  19020>>ASSIGN  19022>>ASSIGN  19032>>ASSIGN
     19034>>ASSIGN  19036>>ASSIGN  19089>>ASSIGN  19094>>ASSIGN  19146>>ASSIGN  19165>>ASSIGN  19194>>ASSIGN
     19223>>ASSIGN  19264>>ASSIGN  19270>>ASSIGN  19286>>ASSIGN  19292>>CALLBLT 19292>>CALLBLT 19292>>CALLBLT
     19295>>CALLBLT 19295>>CALLBLT 19295>>CALLBLT 19297>>CALLBLT 19297>>CALLBLT 19297>>CALLBLT 19299>>CALLBLT
     19299>>CALLBLT 19299>>CALLBLT
OUT$SYM.COUNT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:251  
     16608**DCL     16611--IMP-SIZ 18190>>CALLBLT 18190>>CALLBLT 18206>>IF      18206>>IF      18210>>ASSIGN
     18211>>ASSIGN  18211>>ASSIGN  18230<<ASSIGN  18230>>ASSIGN  18231>>CALLBLT 18231>>CALLBLT 18231>>CALLBLT
     18251>>IF      18251>>IF      18255>>ASSIGN  18255>>ASSIGN  18297>>IF      18297>>IF      18301>>ASSIGN
     18302>>ASSIGN  18302>>ASSIGN  18321<<ASSIGN  18321>>ASSIGN  18322>>CALLBLT 18322>>CALLBLT 18322>>CALLBLT
     18342>>IF      18342>>IF      18346>>ASSIGN  18346>>ASSIGN  19008>>ASSIGN  19008>>ASSIGN  19010>>CALLBLT
     19010>>CALLBLT 19021>>ASSIGN  19021>>ASSIGN  19023>>ASSIGN  19023>>ASSIGN  19033>>ASSIGN  19033>>ASSIGN
     19035>>ASSIGN  19035>>ASSIGN  19037>>ASSIGN  19037>>ASSIGN  19090>>CALLBLT 19090>>CALLBLT 19095>>CALLBLT
     19095>>CALLBLT 19147>>IF      19147>>IF      19151>>ASSIGN  19152>>ASSIGN  19152>>ASSIGN  19166>>IF
     19166>>IF      19170>>ASSIGN  19171>>ASSIGN  19171>>ASSIGN  19195>>IF      19195>>IF      19199>>ASSIGN
     19200>>ASSIGN  19200>>ASSIGN  19224>>IF      19224>>IF      19228>>ASSIGN  19229>>ASSIGN  19229>>ASSIGN
     19292>>CALLBLT 19292>>CALLBLT 19295>>CALLBLT 19295>>CALLBLT 19297>>CALLBLT 19297>>CALLBLT 19299>>CALLBLT
     19299>>CALLBLT
OUT$SYM.TEXT
     16611**DCL     18190>>CALLBLT 18211>>ASSIGN  18231<<CALLBLT 18231>>CALLBLT 18255>>ASSIGN  18302>>ASSIGN
     18322<<CALLBLT 18322>>CALLBLT 18346>>ASSIGN  19008>>ASSIGN  19010>>CALLBLT 19021>>ASSIGN  19023>>ASSIGN
     19033>>ASSIGN  19035>>ASSIGN  19037>>ASSIGN  19090>>CALLBLT 19095>>CALLBLT 19152>>ASSIGN  19171>>ASSIGN
     19200>>ASSIGN  19229>>ASSIGN  19292>>CALLBLT 19295>>CALLBLT 19297>>CALLBLT 19299>>CALLBLT
OUT_VLR
     16916**DCL     16821--DCLINIT
OUT_VLR.ACCT
     16916**DCL     18625>>IF      18625>>IF      18628<<ASSIGN
OUT_VLR.NAME
     16916**DCL     18613>>IF      18615<<ASSIGN
P
     18023**DCL     18189<<ASSIGN  18190>>CALLBLT 18190>>CALLBLT 18190>>CALLBLT 18204<<ASSIGN  18205>>IF
     18206>>IF      18206>>IF      18210>>ASSIGN  18211>>ASSIGN  18211>>ASSIGN  18211>>ASSIGN  18229>>ASSIGN
     18230>>ASSIGN  18230>>ASSIGN  18231>>CALLBLT 18231>>CALLBLT 18231>>CALLBLT 18231>>CALLBLT 18231>>CALLBLT
     18249<<ASSIGN  18250>>IF      18251>>IF      18251>>IF      18255>>ASSIGN  18255>>ASSIGN  18255>>ASSIGN
     18267<<ASSIGN  18268>>IF      18269<>CALL    18281<<ASSIGN  18282>>IF      18282>>IF      18283>>ASSIGN
     18295<<ASSIGN  18296>>IF      18297>>IF      18297>>IF      18301>>ASSIGN  18302>>ASSIGN  18302>>ASSIGN
     18302>>ASSIGN  18320>>ASSIGN  18321>>ASSIGN  18321>>ASSIGN  18322>>CALLBLT 18322>>CALLBLT 18322>>CALLBLT
     18322>>CALLBLT 18322>>CALLBLT 18340<<ASSIGN  18341>>IF      18342>>IF      18342>>IF      18346>>ASSIGN
     18346>>ASSIGN  18346>>ASSIGN  18358<<ASSIGN  18359>>IF      18360<>CALL
P IN PROCEDURE OPTIONS
     18966**DCL     18987<<ASSIGN  18988>>DOSELCT 18997>>DOCASE  19006>>ASSIGN  19020>>ASSIGN  19022>>ASSIGN
     19032>>ASSIGN  19034>>ASSIGN  19036>>ASSIGN  19089>>ASSIGN  19091>>IF      19094>>ASSIGN  19145>>IF
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:252  
     19146>>ASSIGN  19164>>IF      19165>>ASSIGN  19193>>IF      19194>>ASSIGN  19222>>IF      19223>>ASSIGN
     19264>>ASSIGN  19270>>ASSIGN  19286>>ASSIGN
PASSWORD IN PROCEDURE LOGON
     19380**DCL     19381--REDEF   19581<<ASSIGN  19583<>CALL
PASS_INP
     16761**DCL     16693--DCLINIT 16966--DCLINIT 17076--DCLINIT
PASS_OUT
     16887**DCL     16819--DCLINIT 16993--DCLINIT 17196--DCLINIT
PROMPT
     18047**DCL     18146<>CALL
P_PCB
     16350**DCL     17922--DCLINIT
P_PCB.HI_CHAR
     16501**DCL     18140>>IF      18150>>IF
P_PCB.OUT$
     16363**DCL     18177>>ASSIGN
Q IN PROCEDURE OPTIONS
     18967**DCL     19006<<ASSIGN  19007>>IF      19008>>ASSIGN  19008>>ASSIGN  19008>>ASSIGN  19010>>CALLBLT
     19010>>CALLBLT 19010>>CALLBLT 19020<<ASSIGN  19021>>ASSIGN  19021>>ASSIGN  19021>>ASSIGN  19022<<ASSIGN
     19023>>ASSIGN  19023>>ASSIGN  19023>>ASSIGN  19032<<ASSIGN  19033>>ASSIGN  19033>>ASSIGN  19033>>ASSIGN
     19034<<ASSIGN  19035>>ASSIGN  19035>>ASSIGN  19035>>ASSIGN  19036<<ASSIGN  19037>>ASSIGN  19037>>ASSIGN
     19037>>ASSIGN  19089<<ASSIGN  19090>>CALLBLT 19090>>CALLBLT 19090>>CALLBLT 19094<<ASSIGN  19095>>CALLBLT
     19095>>CALLBLT 19095>>CALLBLT 19146<<ASSIGN  19147>>IF      19147>>IF      19151>>ASSIGN  19152>>ASSIGN
     19152>>ASSIGN  19152>>ASSIGN  19165<<ASSIGN  19166>>IF      19166>>IF      19170>>ASSIGN  19171>>ASSIGN
     19171>>ASSIGN  19171>>ASSIGN  19194<<ASSIGN  19195>>IF      19195>>IF      19199>>ASSIGN  19200>>ASSIGN
     19200>>ASSIGN  19200>>ASSIGN  19223<<ASSIGN  19224>>IF      19224>>IF      19228>>ASSIGN  19229>>ASSIGN
     19229>>ASSIGN  19229>>ASSIGN  19264<<ASSIGN  19265>>IF      19270<<ASSIGN  19271>>DOSELCT 19286<<ASSIGN
     19287>>IF      19289>>IF      19291>>IF      19292>>CALLBLT 19292>>CALLBLT 19292>>CALLBLT 19294>>IF
     19295>>CALLBLT 19295>>CALLBLT 19295>>CALLBLT 19297>>CALLBLT 19297>>CALLBLT 19297>>CALLBLT 19299>>CALLBLT
     19299>>CALLBLT 19299>>CALLBLT
READ_HLP
     17464**DCL     18718<>CALL
READ_HLP.STATION_
     17467**DCL     17468--REDEF
READ_HLP.V
     17468**DCL     17464--DCLINIT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:253  
READ_HLP.V.DVBYTE.REREAD#
     17479**DCL     17479--REDEF
READ_HLP.V.INDX#
     17477**DCL     17477--REDEF
READ_ME
     17258**DCL     19429<>CALL
READ_ME.STATION_
     17261**DCL     17262--REDEF
READ_ME.V
     17262**DCL     17258--DCLINIT
READ_ME.V.DVBYTE.REREAD#
     17273**DCL     17273--REDEF
READ_ME.V.INDX#
     17271**DCL     17271--REDEF
READ_NODE
     15952**DCL     18115<>CALL    18397<>CALL    18404<>CALL    18430<>CALL    18438<>CALL
READ_NODE.STATION_
     15955**DCL     15956--REDEF
READ_NODE.V
     15956**DCL     15952--DCLINIT
READ_NODE.V.DVBYTE.REREAD#
     15967**DCL     15967--REDEF
READ_NODE.V.INDX#
     15965**DCL     15965--REDEF
RECX
     18014**DCL     18169<<ASSIGN  19083>>IF      19105<<ASSIGN  19105>>ASSIGN
RES_INP
     18020**DCL     16694--DCLINIT 16967--DCLINIT 18500>>IF      18500>>IF      18500>>IF      18500>>IF
     18500>>IF      18510>>IF
RES_OUT
     18021**DCL     16820--DCLINIT 16994--DCLINIT 18594>>IF      18594>>IF      18594>>IF      18594>>IF
     18594>>IF      18594>>IF      18594>>IF      18613>>IF
SLEEP_HLP
     18713**LABEL   18717--CALLALT
SNOOZE
     17544**DCL     18715<>CALL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:254  
SNOOZE.V
     17545**DCL     17544--DCLINIT
SN_INP
     16776**DCL     16693--DCLINIT 16966--DCLINIT 17074--DCLINIT
SN_INP.SN#
     16776**DCL     18528>>IF      18529<<ASSIGN
SN_OUT
     16902**DCL     16819--DCLINIT 16993--DCLINIT 17194--DCLINIT
SN_OUT.SN#
     16902**DCL     18630>>IF      18631<<ASSIGN
TRY_AGAIN IN PROCEDURE LOGON
     19428**LABEL   19474--GOTO    19492--GOTO    19501--GOTO    19519--GOTO    19525--GOTO    19531--GOTO
     19549--GOTO    19555--GOTO    19561--GOTO
U1
     18043**DCL     18907--CALL
U1.C
     18045**DCL     18190<<CALLBLT 18191>>IF      18191>>IF      18191>>IF      18191>>IF      18191>>IF
     18191>>IF      18191>>IF      18905<<ASSIGN
U1.L
     18044**DCL     18906<<ASSIGN
UNFID_INP
     16964**DCL     18531<>CALL
UNFID_INP.V
     16968**DCL     16964--DCLINIT
UNFID_OUT
     16991**DCL     18633<>CALL
UNFID_OUT.V
     16995**DCL     16991--DCLINIT
UPPERS
     18054**DCL     18190>>CALLBLT
VLP_OF
     17595**DCL     17571--DCLINIT
VLP_OF.BREAKCOUNT
     17606**DCL     17607--REDEF
VLP_ON
     17666**DCL     17642--DCLINIT
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:255  
VLP_ON.BREAKCOUNT
     17677**DCL     17678--REDEF
VWB$BEAM
     17993**DCL-ENT 18892--CALL
VWK$SUCK
     17994**DCL-ENT 18888--CALL
VWM$FIX_MAILBOX
     18060**DCL-ENT 18822--CALL    18838--CALL
VWM$GET_MAILBOX
     18059**DCL-ENT 18799--CALL    18802--CALL
VWM_COMMAND
     17997**DCL     18139<>CALL    18146<>CALL
VWY$YOUCALLD
     17995**DCL-ENT 16669--DCLINIT
VW_IAM#
     18031**DCL     18119<<ASSIGN  18393>>IF      18408>>IF      18426>>IF      18445>>IF      18659>>ASSIGN
     18668>>IF      18694>>IF      18748>>IF      18773>>IF      18788>>ASSIGN  18799<>CALL    18802<>CALL
VW_INPCNT#
     18015**DCL     18879<<ASSIGN
VW_OPTIONS#
     15189**DCL     15195--REDEF   15558--REDEF   18166<<ASSIGN
VW_OUTCNT#
     18016**DCL     18880<<ASSIGN
WRKBUF
     18027**DCL     17923--DCLINIT
XTX$ADAPT
     17904**DCL-ENT 17983--DCLINIT
XUR$ECHOIF
     14024**DCL-ENT 18157--CALL
XUR$ERRMSG
     14030**DCL-ENT 18110--CALL    18116--CALL    18142--CALL    18154--CALL    18207--CALL    18226--CALL
     18252--CALL    18298--CALL    18317--CALL    18343--CALL    18371--CALL    18398--CALL    18405--CALL
     18414--CALL    18431--CALL    18439--CALL    18460--CALL    18464--CALL    18476--CALL    18491--CALL
     18496--CALL    18506--CALL    18532--CALL    18563--CALL    18585--CALL    18590--CALL    18602--CALL
     18634--CALL    18646--CALL    18681--CALL    18751--CALL    18800--CALL    18803--CALL    18823--CALL
     18839--CALL    18903--CALL    18907--CALL    19084--CALL    19099--CALL    19115--CALL    19124--CALL
PL6.E3A0      #001=VWM$MOVE File=VWM$MOVE.:VMB6TSI                               WED 08/20/97 15:41 Page:256  
     19148--CALL    19167--CALL    19196--CALL    19225--CALL    19258--CALL    19304--CALL    19472--CALL
     19490--CALL    19499--CALL    19517--CALL    19523--CALL    19529--CALL    19547--CALL    19553--CALL
     19559--CALL    19597--CALL
XUR$ERRPTR
     14023**DCL-ENT 18141--CALL    18151--CALL
XUR$GETCMD
     14022**DCL-ENT 18139--CALL    18146--CALL
XUR$INIT
     14027**DCL-ENT 18089--CALL
XUR$SETDCBS
     14026**DCL-ENT 18099--CALL    18461--CALL
XUR$SETERRMSG
     14032**DCL-ENT 18098--CALL
XUR_INIT
     17909**DCL     18089<>CALL
XUR_INIT.WORKR_
     17923**DCL     17924--REDEF
YY IN PROCEDURE OPTIONS
     18972**DCL     19299<<CALLBLT 19301>>IF      19301>>IF      19301>>IF      19301>>IF      19307>>ASSIGN

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:257  
     1887        1        /*T***********************************************************/
     1888        2        /*T*                                                         */
     1889        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1890        4        /*T*                                                         */
     1891        5        /*T***********************************************************/
     1892        6
     1893        7        VWM$GET_MAILBOX: proc( MAILBOX, VM_IAM#, VM_ERR# ) altret;
     1894        8
     1895        9    1   dcl  MAILBOX     char(79);
     1896       10    1   dcl  MAP_BOX     char(79);
     1897       11    1   dcl  VM_IAM#     char(8);
     1898       12    1   dcl  VM_ERR#     sbin;
     1899       13
     1900       14    1   dcl  M$NAME         dcb;
     1901       15    1   dcl  M$GLOBAL       dcb;
     1902       16    1   dcl  M$DUMMY        dcb;
     1903       17
     1904       18        %include VM_MACRO_C;
     1905     1286
     1906     1287        %VM_KEYTYPES;
     1907     1308        %VM_ADDTYPES;
     1908     1312        %VM_RADDRESS (STCLASS="BASED(ADD$)");
     1909     1347        %VM_USERKEY  (STCLASS="");
     1910     1363        %VM_LISTKEY  (STCLASS="");
     1911     1379
     1912     1380        %include B$TABLES_C;
     1913     1488        %B$SR_NON_BLANK;
     1914     1492
     1915     1493        %include B$JIT;
     1916     2096    1   dcl  B$JIT$      ptr symref readonly;
     1917     2097
     1918     2098        %include CP_6_SUBS;
     1919     2638        %include CP_6;
     1920     8197        %F$DCB;
     1921     8254        %FPT_OPEN( FPTN     =  OPEN_NAME,
     1922     8255                   DCB      =  M$NAME,
     1923     8256                   ASN      =  FILE,
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:258  
     1924     8257                   FUN      =  IN,
     1925     8258                   SHARE    =  ALL,
     1926     8259                   SCRUB    =  YES,
     1927     8260                   NAME     =  VM_NAME_MAP_NAME,
     1928     8261                   ACCT     =  VM_MAIL_ACCT,
     1929     8262                   STCLASS  =  CONSTANT);
     1930     8371
     1931     8372        %FPT_OPEN( FPTN     =  OPEN_GLOBAL,
     1932     8373                   DCB      =  M$GLOBAL,
     1933     8374                   ASN      =  FILE,
     1934     8375                   FUN      =  IN,
     1935     8376                   SHARE    =  ALL,
     1936     8377                   SCRUB    =  YES,
     1937     8378                   NAME     =  VM_GLOBAL_NAME,
     1938     8379                   ACCT     =  VM_MAIL_ACCT,
     1939     8380                   STCLASS  =  CONSTANT);
     1940     8489
     1941     8490        %FPT_OPEN( FPTN     =  FPT_OPEN,
     1942     8491                   STCLASS  =  "");
     1943     8600
     1944     8601        %VLP_NAME( FPTN     =  VM_GLOBAL_NAME,
     1945     8602                   LEN      =  31,
     1946     8603                   NAME     =  ':MAIL_CENTRAL',
     1947     8604                   STCLASS  =  CONSTANT);
     1948     8631
     1949     8632        %VLP_NAME( FPTN     =  VM_NAME_MAP_NAME,
     1950     8633                   LEN      =  31,
     1951     8634                   NAME     =  ':NAME',
     1952     8635                   STCLASS  =  CONSTANT);
     1953     8662
     1954     8663        %VLP_ACCT( FPTN     =  VM_MAIL_ACCT,
     1955     8664                   ACCT     =  ':MAIL',
     1956     8665                   STCLASS  =  CONSTANT);
     1957     8678
     1958     8679
     1959     8680        %FPT_READ( FPTN     =  READ_NAME,
     1960     8681                   KEYS     =  YES,
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:259  
     1961     8682                   STCLASS  =  CONSTANT,
     1962     8683                   DCB      =  M$NAME);
     1963     8722
     1964     8723        %FPT_READ( FPTN     =  FPT_READ,
     1965     8724                   STCLASS  =  "");
     1966     8763
     1967     8764        %FPT_READ( FPTN     =  READ_GLOBAL,
     1968     8765                   KEYS     =  YES,
     1969     8766                   STCLASS  =  CONSTANT,
     1970     8767                   DCB      =  M$GLOBAL);
     1971     8806
     1972     8807        %VLP_NAME( FPTN     =  NAME_KEY,
     1973     8808                   STCLASS  =  "",
     1974     8809                   LEN      =  31);
     1975     8836
     1976     8837        %VLP_NAME( FPTN     =  GLOBAL_KEY,
     1977     8838                   STCLASS  =  "",
     1978     8839                   LEN      =  255);
     1979     8866
     1980     8867        %VLP_NAME( FPTN     =  NAME_BUFFER,
     1981     8868                   LEN      =  255,
     1982     8869                   STCLASS  =  "");
     1983     8896
     1984     8897        %VLP_ACCT( FPTN     =  USER_ACCT,
     1985     8898                   STCLASS  =  "");
     1986     8911
     1987     8912        %FPT_CLOSE(FPTN     =  FPT_CLOSE,
     1988     8913                   STCLASS  =  "");
     1989     8955
     1990     8956        %FPT_CLOSE(FPTN     =  CLOSE_CONSTANT,
     1991     8957                   STCLASS  =  CONSTANT);
     1992     8999
     1993     9000
     1994     9001    1   dcl  I        sbin;
     1995     9002    1   dcl  J        sbin;
     1996     9003    1   dcl  ADD$     ptr;
     1997     9004    1   dcl  FOLD_STRING             char(80);
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:260  
     1998     9005
     1999     9006    1   dcl 1  VM_BUFFER(0:39)      aligned,
     2000     9007    1         2  UPPER    ubin(18) haligned,
     2001     9008    1         2  LOWER    ubin(18) haligned;
     2002     9009
     2003     9010
     2004     9011    1           MAP_BOX = MAILBOX;
     2005     9012    1           FOLD_STRING = MAP_BOX;
     2006     9013    1           if dcbaddr(dcbnum(M$GLOBAL))->F$DCB.FCD# = '0'b
     2007     9014    1           then call M$OPEN(OPEN_GLOBAL) altret(BAD_OPEN);
     2008     9015
     2009     9016    1           if dcbaddr(dcbnum(M$NAME))->F$DCB.FCD# = '0'b
     2010     9017    1           then call M$OPEN(OPEN_NAME)   altret(BAD_OPEN);
     2011     9018
     2012     9019    1           FPT_CLOSE = CLOSE_CONSTANT;
     2013     9020    1           FPT_CLOSE.V_ = vector(FPT_CLOSE.V);
     2014     9021
     2015     9022    2           if MAP_BOX = ' ' then do;
     2016     9023    2              call MAP_ACCT_TO_REGISTERED_NAME altret(BAD_FOLDER);
     2017     9024    2              MAP_BOX = substr(NAME_BUFFER.NAME#,,NAME_BUFFER.L#);
     2018     9025    2              goto EXIT_NAME_SERVER;
     2019     9026    2              end;
     2020     9027
     2021     9028    1           if substr(MAP_BOX,0,1) = '/' then
     2022     9029    2           do;                   /**  Mailbox begins with folder specification  **/
     2023     9030    2              call index(J,' ',MAP_BOX);
     2024     9031    3              call index(I,'.',MAP_BOX) whenreturn do;
     2025     9032    3                 call VERIFY_FOLDER(MAP_BOX,J) altret(BAD_FOLDER);
     2026     9033    3                 goto LEAVE_AS_IS;
     2027     9034    3                 end;
     2028     9035
     2029     9036    2              call MAP_ACCT_TO_REGISTERED_NAME altret(BAD_FOLDER);
     2030     9037
     2031     9038    2              if substr(NAME_BUFFER.NAME#,0,1) ~= '.' then
     2032     9039    3              do;                /**  We found a registration for this user   **/
     2033     9040    3                 if NAME_BUFFER.L# + J < 80 then
     2034     9041    4                 do;                       /** Registered name will fit!  **/
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:261  
     2035     9042    4                    call concat(FOLD_STRING,
     2036     9043    4                      substr(MAP_BOX,,J),'.',substr(NAME_KEY.NAME#,,8));
     2037     9044    4                    substr(NAME_BUFFER.NAME#,NAME_BUFFER.L#) = substr(MAP_BOX,,J);
     2038     9045    4                    MAP_BOX = substr(NAME_BUFFER.NAME#,,NAME_BUFFER.L#+J);
     2039     9046    4                    J = J + 9;             /** Include the account **/
     2040     9047    4                    end;                   /*  Of if Registered name fits        */
     2041     9048    3                 else call concat(substr(MAP_BOX,,J),'.',USER_ACCT.ACCT#);
     2042     9049    3                 call VERIFY_FOLDER( FOLD_STRING, J) altret(BAD_FOLDER);
     2043     9050    3                 end;                      /*  Of Registered name found          */
     2044     9051    2              else substr(MAP_BOX,J) = substr(NAME_BUFFER.NAME#,,NAME_BUFFER.L#);
     2045     9052    2              end;          /**  Of mailbox starts with folder specification **/
     2046     9053
     2047     9054    1           else
     2048     9055
     2049     9056    2           do;
     2050     9057                                           /**  This must be a registered name!   **/
     2051     9058    2              call index(J,' ',MAP_BOX);
     2052     9059    3              call index(I,'.',MAP_BOX) whenreturn do;
     2053     9060    4                 if substr(MAP_BOX,,6) = ':MAIL_' and J>I then do;
     2054     9061    4                    call VERIFY_FOLDER(MAP_BOX,J) altret(BAD_FOLDER);
     2055     9062    4                    goto LEAVE_AS_IS;
     2056     9063    4                    end;
     2057     9064    3                 end;
     2058     9065
     2059     9066    2              call searchr(I,J,B$SR_NON_BLANK,MAP_BOX);
     2060     9067    3              call index(J,'/',MAP_BOX) whenaltreturn do; J = I; end;
     2061     9068
     2062     9069    2              call LOCATE_REGISTERED_NAME( MAP_BOX, J ) altret(BAD_FOLDER);
     2063     9070    2              if NAME_KEY.NAME# ~= ' ' then
     2064     9071    3              do;
     2065     9072    3                 call concat(FOLD_STRING,substr(MAP_BOX,J,maximum(0,I-J+1)),'.',
              9072                          NAME_KEY.NAME#);
     2066     9073    3                 call VERIFY_FOLDER( FOLD_STRING, maximum(0,I-J+1)+9) altret (
              9073                          BAD_FOLDER);
     2067     9074    3                 end;
     2068     9075
     2069     9076    2              end;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:262  
     2070     9077
     2071     9078    1   EXIT_NAME_SERVER:
     2072     9079    1           MAILBOX = MAP_BOX;
     2073     9080    1           return;
     2074     9081
     2075     9082
     2076     9083    1   BAD_FOLDER:
     2077     9084    1           altreturn;
     2078     9085
     2079     9086    1   BAD_OPEN:
     2080     9087    1           altreturn;
     2081     9088
     2082     9089    1   LEAVE_AS_IS:
     2083     9090    1           return;
     2084     9091
     2085     9092
     2086     9093    1   VWM$FIX_MAILBOX: entry(MAILBOX, VM_IAM#, VM_ERR#) altret;
     2087     9094
     2088     9095    1           MAP_BOX = MAILBOX;
     2089     9096    1           if MAP_BOX = ' ' then
     2090     9097    2           do;
     2091     9098    2              call concat(MAP_BOX,'.',VM_IAM#);
     2092     9099    2              end;
     2093     9100    1           else
     2094     9101    2           do;
     2095     9102    2              if substr(MAP_BOX,,1) = '/' then
     2096     9103    3              do;
     2097     9104    3                 call index(J,' ',MAP_BOX);
     2098     9105    4                 call index(I,'.',MAP_BOX) whenreturn do;
     2099     9106    4                    if substr(MAP_BOX,I+1,1) ~= ' ' then goto EXIT_NAME_SERVER;
     2100     9107    4                    J = minimum(I,J);
     2101     9108    4                    end;
     2102     9109    3                 call concat(substr(MAP_BOX,J),'.',VM_IAM#);
     2103     9110    3                 end;
     2104     9111    2              end;
     2105     9112    1           goto EXIT_NAME_SERVER;
     2106     9113
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:263  
     2107     9114        %eject;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:264  
     2108     9115    1   MAP_ACCT_TO_REGISTERED_NAME: proc altret;
     2109     9116
     2110     9117        /*I*    NAME:    MAP_ACCT_TO_REGISTERED_NAME
     2111     9118                PURPOSE: To turn the logon or filemanagement account
     2112     9119                         into a registered name.
     2113     9120                DESCRIPTION:   The :NAME file is accessed to determine
     2114     9121                            whether a registered name exists for this
     2115     9122                            account.  If it does not, then we look for
     2116     9123                            a mailbox in either the logon or file
     2117     9124                            management account to blame.
     2118     9125                                                                         */
     2119     9126
     2120     9127    2           FPT_READ = READ_NAME;
     2121     9128    2           FPT_READ.V_ = vector(FPT_READ.V);
     2122     9129    2           FPT_READ.KEY_ = vector(NAME_KEY);
     2123     9130    2           FPT_READ.BUF_ = vector(NAME_BUFFER.NAME#);
     2124     9131
     2125     9132    2           NAME_KEY.NAME# = B$JIT.ACCN;
     2126     9133    2           NAME_KEY.L# = 20;
     2127     9134
     2128     9135    2   LOOK_4_MAP:
     2129     9136    3           do I = 0 to 1 by 1;
     2130     9137
     2131     9138    3              if I = 1 then NAME_KEY.NAME# = B$JIT.FACCN;
     2132     9139    4              call M$READ( FPT_READ ) whenreturn do;
     2133     9140    4                 goto GOT_A_NAME_MAP;
     2134     9141    4                 end;
     2135     9142    3              substr(NAME_KEY.NAME#,8) = B$JIT.UNAME;
     2136     9143    4              call M$READ( FPT_READ ) whenreturn do;
     2137     9144    4                 goto GOT_A_NAME_MAP;
     2138     9145    4                 end;
     2139     9146
     2140     9147    3              end LOOK_4_MAP;
     2141     9148
     2142     9149        /**  Not registered, look for a mailbox in either the
     2143     9150         **  logon account or the file management account.
     2144     9151         **/
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:265  
     2145     9152    2           FPT_OPEN = OPEN_GLOBAL;
     2146     9153    2           FPT_OPEN.ACCT_ = vector(USER_ACCT);
     2147     9154    2           FPT_OPEN.V_ = vector(FPT_OPEN.V);
     2148     9155    2           FPT_OPEN.V.DCB# = dcbnum(M$DUMMY);
     2149     9156
     2150     9157    2           USER_ACCT.ACCT# = B$JIT.ACCN;
     2151     9158    3           call M$OPEN(FPT_OPEN) whenaltreturn do;
     2152     9159    3              USER_ACCT.ACCT# = B$JIT.FACCN;
     2153     9160    4              call M$OPEN(FPT_OPEN) whenaltreturn do;
     2154     9161    4                 altreturn;
     2155     9162    4                 end;
     2156     9163    3              end;
     2157     9164
     2158     9165    2           FPT_CLOSE.V.DCB# = dcbnum(M$DUMMY);
     2159     9166    3           call M$CLOSE(FPT_CLOSE) whenaltreturn do; end;
     2160     9167
     2161     9168    2           NAME_BUFFER.L# = 8;
     2162     9169    2           call concat(NAME_BUFFER.NAME#,'.',USER_ACCT.ACCT#);
     2163     9170    2           call index(I,' ',NAME_BUFFER.NAME#);
     2164     9171    2           NAME_BUFFER.L# = I;
     2165     9172    2           return;
     2166     9173
     2167     9174    2   GOT_A_NAME_MAP:
     2168     9175    2           NAME_BUFFER.L# = dcbaddr(dcbnum(M$NAME))->F$DCB.ARS#;
     2169     9176    2           return;
     2170     9177
     2171     9178    2   end MAP_ACCT_TO_REGISTERED_NAME;
     2172     9179        %eject;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:266  
     2173     9180    1   LOCATE_REGISTERED_NAME: proc( NAME#, L# ) altret;
     2174     9181
     2175     9182        /*I*    NAME:       LOCATE_REGISTERED_NAME
     2176     9183                PURPOSE:    To determine if the specified name is a
     2177     9184                            known registered name.
     2178     9185                DESCRIPTION:   The :MAIL_CENTRAL.:MAIL file is accessed
     2179     9186                            to determine if a given name is registered
     2180     9187                            or not.  If it does not exist, an alternate
     2181     9188                            return is made.
     2182     9189                                                                         */
     2183     9190    2   dcl  NAME#    char(20);
     2184     9191    2   dcl  L#       sbin;
     2185     9192    2   dcl  I        sbin;
     2186     9193    2   dcl  J        sbin;
     2187     9194
     2188     9195
     2189     9196    2           FPT_READ = READ_GLOBAL;
     2190     9197    2           FPT_READ.V_ = vector(FPT_READ.V);
     2191     9198    2           FPT_READ.BUF_ = vector(VM_BUFFER);
     2192     9199    2           FPT_READ.KEY_ = vector(VM_USERKEY);
     2193     9200
     2194     9201    2           VM_USERKEY.TEXT = substr(NAME#,,L#);
     2195     9202    2           call searchr(I,J,B$SR_NON_BLANK,VM_USERKEY.TEXT);
     2196     9203    2           VM_USERKEY.COUNT = I+2;
     2197     9204    2           VM_USERKEY.TYPE = %VM_TYPE_USER;
     2198     9205    2           VM_LISTKEY.TYPE = %VM_TYPE_LIST;
     2199     9206
     2200     9207    3           call M$READ(FPT_READ) whenreturn do;
     2201     9208    3              ADD$ = PINCRW(addr(VM_BUFFER),VM_BUFFER.UPPER(3));
     2202     9209    3              if VM_RADDRESS.SITENAME~=VM_IAM# and VM_RADDRESS.SITENAME~=' '
     2203     9210    3              then altreturn;
     2204     9211    3              NAME_KEY.NAME# = VM_RADDRESS.ACCT;
     2205     9212    3              return;
     2206     9213    3              end;
     2207     9214
     2208     9215    2           NAME_KEY.NAME# = ' ';
     2209     9216    2           VM_LISTKEY.TEXT = VM_USERKEY.TEXT;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:267  
     2210     9217    2           VM_LISTKEY.COUNT = I+1;
     2211     9218    3           call M$READ(FPT_READ) whenaltreturn do;
     2212     9219    3              altreturn;
     2213     9220    3              end;
     2214     9221    2           ADD$ = PINCRW(addr(VM_BUFFER),VM_BUFFER.UPPER(3)+2);
     2215     9222    2           if VM_RADDRESS.SITENAME~=VM_IAM# and VM_RADDRESS.SITENAME~=' '
     2216     9223    2           then altreturn;
     2217     9224
     2218     9225    2   end LOCATE_REGISTERED_NAME;
     2219     9226        %eject;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:268  
     2220     9227    1   VERIFY_FOLDER: proc(STRING#, L#) altret;
     2221     9228
     2222     9229        /*I*    NAME:       VERIFY_FOLDER
     2223     9230                PURPOSE:    To determine if the specified folder exists.
     2224     9231
     2225     9232                DESCRIPTION:   The argument contains a folder specification
     2226     9233                            of the form: :MAIL_?.acct or /?.acct.  This
     2227     9234                            routine maps this argument into the corresponding
     2228     9235                            CP-6 filename and tries to open the folder.
     2229     9236
     2230     9237                            An alternate return is taken if the open is
     2231     9238                            unsuccessfull.
     2232     9239                                                                            */
     2233     9240
     2234     9241    2   dcl  STRING#        char(L#);
     2235     9242    2   dcl  L#             sbin;
     2236     9243    2   dcl  I              sbin;
     2237     9244    2   dcl  DOT            sbin;
     2238     9245
     2239     9246        %VLP_ACCT( FPTN     =  OPEN_ACCT,
     2240     9247                   STCLASS  =  "");
     2241     9260
     2242     9261        %VLP_NAME( FPTN     =  OPEN_NAME,
     2243     9262                   STCLASS  =  "",
     2244     9263                   LEN      =  31);
     2245     9290
     2246     9291    2           FPT_OPEN =  OPEN_GLOBAL;
     2247     9292    2           FPT_OPEN.V_ = vector(FPT_OPEN.V);
     2248     9293    2           FPT_OPEN.NAME_ = vector(OPEN_NAME);
     2249     9294    2           FPT_OPEN.ACCT_ = vector(OPEN_ACCT);
     2250     9295    2           FPT_OPEN.V.DCB# = dcbnum(M$DUMMY);
     2251     9296
     2252     9297    2           call index(DOT,'.',STRING#);
     2253     9298    2           if substr(STRING#,,1) = '/' then
     2254     9299    3           do;
     2255     9300    3              OPEN_NAME.NAME# = ':MAIL_CENTRAL';
     2256     9301    3              if DOT > 1 then
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:269  
     2257     9302    4              do;
     2258     9303    4                 substr(OPEN_NAME.NAME#,6) = substr(STRING#,1,DOT-1);
     2259     9304    4                 I = DOT + 5;
     2260     9305    4                 end;
     2261     9306    3              else I = %lengthc(':MAIL_CENTRAL');
     2262     9307    3              end;
     2263     9308
     2264     9309    2           else
     2265     9310
     2266     9311    3           do;                             /***  A fid? ***/
     2267     9312    3              I = DOT;
     2268     9313    3              if substr(STRING#,,6)~= ':MAIL_' then
     2269     9314    4              do;
     2270     9315    4                 call concat(OPEN_NAME.NAME#,':MAIL_',substr(STRING#,,DOT-1));
     2271     9316    4                 I = I + 5;
     2272     9317    4                 end;
     2273     9318    3              else OPEN_NAME.NAME# = substr(STRING#,,I);
     2274     9319    3              end;
     2275     9320
     2276     9321    2           OPEN_NAME.L# = I;
     2277     9322    2           if (DOT+1) >= L#
     2278     9323    2           then OPEN_ACCT.ACCT# = B$JIT.ACCN;
     2279     9324    2           else OPEN_ACCT.ACCT# = substr(STRING#,DOT+1);
     2280     9325    2           if OPEN_ACCT.ACCT# = ' ' then OPEN_ACCT.ACCT# = B$JIT.ACCN;
     2281     9326
     2282     9327    3           call M$OPEN( FPT_OPEN ) whenreturn do; goto OKAY; end;
     2283     9328    2           if OPEN_ACCT.ACCT# = B$JIT.ACCN then
     2284     9329    3           do;
     2285     9330    3              OPEN_ACCT.ACCT# = B$JIT.FACCN;
     2286     9331    4              call M$OPEN( FPT_OPEN ) whenreturn do; goto OKAY; end;
     2287     9332    3              end;
     2288     9333
     2289     9334    2           altreturn;
     2290     9335
     2291     9336    2   OKAY:
     2292     9337    2           return;
     2293     9338
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:270  
     2294     9339    2   end VERIFY_FOLDER;
     2295     9340
     2296     9341    1   end VWM$GET_MAILBOX;

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:271  
--  Include file information  --

   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
      No diagnostics issued in procedure VWM$GET_MAILBOX.

   Procedure VWM$GET_MAILBOX requires 650 words for executable code.
   Procedure VWM$GET_MAILBOX requires 450 words of local(AUTO) storage.

    No errors detected in file VWM$MOVE.:VMB6TSI    .

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:272  

 Object Unit name= VWM$GET_MAILBOX                            File name= VWM$MOVE.:VMB6TOU
 UTS= AUG 20 '97 15:44:21.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$NAME
    1   DCB   even  none     0      0  M$GLOBAL
    2   DCB   even  none     0      0  M$DUMMY
    3   DCB   even  none     0      0  M$UC
    4  RoData even  UTS    198    306  VWM$GET_MAILBOX
    5   Proc  even  none   650   1212  VWM$GET_MAILBOX
    6  RoData even  none    13     15  VWM$GET_MAILBOX

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes    yes     yes      Std        3  VWM$GET_MAILBOX
     5    372          yes     yes      Std        3  VWM$FIX_MAILBOX

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:273  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$NAME                                M$GLOBAL                              M$DUMMY
r    B$SR_NON_BLANK$                  r    B$JIT$                                M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:274  


     1887        1        /*T***********************************************************/
     1888        2        /*T*                                                         */
     1889        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1890        4        /*T*                                                         */
     1891        5        /*T***********************************************************/
     1892        6
     1893        7        VWM$GET_MAILBOX: proc( MAILBOX, VM_IAM#, VM_ERR# ) altret;

      7  5 000000   000000 700200 xent  VWM$GET_MAI* TSX0  ! X66_AUTO_3
         5 000001   000702 000003                    ZERO    450,3

     1894        8
     1895        9    1   dcl  MAILBOX     char(79);
     1896       10    1   dcl  MAP_BOX     char(79);
     1897       11    1   dcl  VM_IAM#     char(8);
     1898       12    1   dcl  VM_ERR#     sbin;
     1899       13
     1900       14    1   dcl  M$NAME         dcb;
     1901       15    1   dcl  M$GLOBAL       dcb;
     1902       16    1   dcl  M$DUMMY        dcb;
     1903       17
     1904       18        %include VM_MACRO_C;
     1905     1286
     1906     1287        %VM_KEYTYPES;
     1907     1308        %VM_ADDTYPES;
     1908     1312        %VM_RADDRESS (STCLASS="BASED(ADD$)");
     1909     1347        %VM_USERKEY  (STCLASS="");
     1910     1363        %VM_LISTKEY  (STCLASS="");
     1911     1379
     1912     1380        %include B$TABLES_C;
     1913     1488        %B$SR_NON_BLANK;
     1914     1492
     1915     1493        %include B$JIT;
     1916     2096    1   dcl  B$JIT$      ptr symref readonly;
     1917     2097
     1918     2098        %include CP_6_SUBS;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:275  
     1919     2638        %include CP_6;
     1920     8197        %F$DCB;
     1921     8254        %FPT_OPEN( FPTN     =  OPEN_NAME,
     1922     8255                   DCB      =  M$NAME,
     1923     8256                   ASN      =  FILE,
     1924     8257                   FUN      =  IN,
     1925     8258                   SHARE    =  ALL,
     1926     8259                   SCRUB    =  YES,
     1927     8260                   NAME     =  VM_NAME_MAP_NAME,
     1928     8261                   ACCT     =  VM_MAIL_ACCT,
     1929     8262                   STCLASS  =  CONSTANT);
     1930     8371
     1931     8372        %FPT_OPEN( FPTN     =  OPEN_GLOBAL,
     1932     8373                   DCB      =  M$GLOBAL,
     1933     8374                   ASN      =  FILE,
     1934     8375                   FUN      =  IN,
     1935     8376                   SHARE    =  ALL,
     1936     8377                   SCRUB    =  YES,
     1937     8378                   NAME     =  VM_GLOBAL_NAME,
     1938     8379                   ACCT     =  VM_MAIL_ACCT,
     1939     8380                   STCLASS  =  CONSTANT);
     1940     8489
     1941     8490        %FPT_OPEN( FPTN     =  FPT_OPEN,
     1942     8491                   STCLASS  =  "");
     1943     8600
     1944     8601        %VLP_NAME( FPTN     =  VM_GLOBAL_NAME,
     1945     8602                   LEN      =  31,
     1946     8603                   NAME     =  ':MAIL_CENTRAL',
     1947     8604                   STCLASS  =  CONSTANT);
     1948     8631
     1949     8632        %VLP_NAME( FPTN     =  VM_NAME_MAP_NAME,
     1950     8633                   LEN      =  31,
     1951     8634                   NAME     =  ':NAME',
     1952     8635                   STCLASS  =  CONSTANT);
     1953     8662
     1954     8663        %VLP_ACCT( FPTN     =  VM_MAIL_ACCT,
     1955     8664                   ACCT     =  ':MAIL',
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:276  
     1956     8665                   STCLASS  =  CONSTANT);
     1957     8678
     1958     8679
     1959     8680        %FPT_READ( FPTN     =  READ_NAME,
     1960     8681                   KEYS     =  YES,
     1961     8682                   STCLASS  =  CONSTANT,
     1962     8683                   DCB      =  M$NAME);
     1963     8722
     1964     8723        %FPT_READ( FPTN     =  FPT_READ,
     1965     8724                   STCLASS  =  "");
     1966     8763
     1967     8764        %FPT_READ( FPTN     =  READ_GLOBAL,
     1968     8765                   KEYS     =  YES,
     1969     8766                   STCLASS  =  CONSTANT,
     1970     8767                   DCB      =  M$GLOBAL);
     1971     8806
     1972     8807        %VLP_NAME( FPTN     =  NAME_KEY,
     1973     8808                   STCLASS  =  "",
     1974     8809                   LEN      =  31);
     1975     8836
     1976     8837        %VLP_NAME( FPTN     =  GLOBAL_KEY,
     1977     8838                   STCLASS  =  "",
     1978     8839                   LEN      =  255);
     1979     8866
     1980     8867        %VLP_NAME( FPTN     =  NAME_BUFFER,
     1981     8868                   LEN      =  255,
     1982     8869                   STCLASS  =  "");
     1983     8896
     1984     8897        %VLP_ACCT( FPTN     =  USER_ACCT,
     1985     8898                   STCLASS  =  "");
     1986     8911
     1987     8912        %FPT_CLOSE(FPTN     =  FPT_CLOSE,
     1988     8913                   STCLASS  =  "");
     1989     8955
     1990     8956        %FPT_CLOSE(FPTN     =  CLOSE_CONSTANT,
     1991     8957                   STCLASS  =  CONSTANT);
     1992     8999
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:277  
     1993     9000
     1994     9001    1   dcl  I        sbin;
     1995     9002    1   dcl  J        sbin;
     1996     9003    1   dcl  ADD$     ptr;
     1997     9004    1   dcl  FOLD_STRING             char(80);
     1998     9005
     1999     9006    1   dcl 1  VM_BUFFER(0:39)      aligned,
     2000     9007    1         2  UPPER    ubin(18) haligned,
     2001     9008    1         2  LOWER    ubin(18) haligned;
     2002     9009
     2003     9010
     2004     9011    1           MAP_BOX = MAILBOX;

   9011  5 000002   200003 470500                    LDP0    @MAILBOX,,AUTO
         5 000003   040100 100500                    MLR     fill='040'O
         5 000004   000000 000117                    ADSC9   0,,PR0                   cn=0,n=79
         5 000005   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79

     2005     9012    1           FOLD_STRING = MAP_BOX;

   9012  5 000006   040100 100500                    MLR     fill='040'O
         5 000007   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000010   200563 000120                    ADSC9   FOLD_STRING,,AUTO        cn=0,n=80

     2006     9013    1           if dcbaddr(dcbnum(M$GLOBAL))->F$DCB.FCD# = '0'b

   9013  5 000011   000000 236007 xsym               LDQ     M$GLOBAL,DL
         5 000012   000000 471400 6                  LDP1    0
         5 000013   100000 473500                    LDP3    0,,PR1
         5 000014   300000 474506                    LDP4    0,QL,PR3
         5 000015   400031 236100                    LDQ     25,,PR4
         5 000016   020000 316007                    CANQ    8192,DL
         5 000017   000024 601000 5                  TNZ     s:9016

     2007     9014    1           then call M$OPEN(OPEN_GLOBAL) altret(BAD_OPEN);

   9014  5 000020   000072 630400 4                  EPPR0   OPEN_GLOBAL
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:278  
         5 000021   450000 713400                    CLIMB   alt,open
         5 000022   410400 401760                    pmme    nvectors=18
         5 000023   000370 702000 5                  TSX2    BAD_OPEN

     2008     9015
     2009     9016    1           if dcbaddr(dcbnum(M$NAME))->F$DCB.FCD# = '0'b

   9016  5 000024   000000 236007 xsym               LDQ     M$NAME,DL
         5 000025   000000 470400 6                  LDP0    0
         5 000026   000000 471500                    LDP1    0,,PR0
         5 000027   100000 473506                    LDP3    0,QL,PR1
         5 000030   300031 236100                    LDQ     25,,PR3
         5 000031   020000 316007                    CANQ    8192,DL
         5 000032   000037 601000 5                  TNZ     s:9019

     2010     9017    1           then call M$OPEN(OPEN_NAME)   altret(BAD_OPEN);

   9017  5 000033   000000 630400 4                  EPPR0   OPEN_NAME
         5 000034   450000 713400                    CLIMB   alt,open
         5 000035   410400 401760                    pmme    nvectors=18
         5 000036   000370 702000 5                  TSX2    BAD_OPEN

     2011     9018
     2012     9019    1           FPT_CLOSE = CLOSE_CONSTANT;

   9019  5 000037   000100 100400                    MLR     fill='000'O
         5 000040   000242 000170 4                  ADSC9   CLOSE_CONSTANT           cn=0,n=120
         5 000041   200522 000170                    ADSC9   FPT_CLOSE,,AUTO          cn=0,n=120

     2013     9020    1           FPT_CLOSE.V_ = vector(FPT_CLOSE.V);

   9020  5 000042   000001 235000 6                  LDA     1
         5 000043   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000044   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000045   000554 036003                    ADLQ    364,DU
         5 000046   200522 757100                    STAQ    FPT_CLOSE,,AUTO

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:279  
     2014     9021
     2015     9022    2           if MAP_BOX = ' ' then do;

   9022  5 000047   040000 106500                    CMPC    fill='040'O
         5 000050   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000051   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000052   000064 601000 5                  TNZ     s:9028

     2016     9023    2              call MAP_ACCT_TO_REGISTERED_NAME altret(BAD_FOLDER);

   9023  5 000053   000463 701000 5                  TSX1    MAP_ACCT_TO_REGISTERED_NAME
         5 000054   000367 702000 5                  TSX2    BAD_FOLDER

     2017     9024    2              MAP_BOX = substr(NAME_BUFFER.NAME#,,NAME_BUFFER.L#);

   9024  5 000055   200420 236100                    LDQ     NAME_BUFFER,,AUTO
         5 000056   000033 772000                    QRL     27
         5 000057   000000 620006                    EAX0    0,QL
         5 000060   040100 100540                    MLR     fill='040'O
         5 000061   200420 200010                    ADSC9   NAME_BUFFER,,AUTO        cn=1,n=*X0
         5 000062   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79

     2018     9025    2              goto EXIT_NAME_SERVER;

   9025  5 000063   000362 710000 5                  TRA     EXIT_NAME_SERVER

     2019     9026    2              end;
     2020     9027
     2021     9028    1           if substr(MAP_BOX,0,1) = '/' then

   9028  5 000064   200006 236100                    LDQ     MAP_BOX,,AUTO
         5 000065   777000 376003                    ANQ     -512,DU
         5 000066   057000 116003                    CMPQ    24064,DU
         5 000067   000226 601000 5                  TNZ     s:9058

     2022     9029    2           do;                   /**  Mailbox begins with folder specification  **/

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:280  
     2023     9030    2              call index(J,' ',MAP_BOX);

   9030  5 000070   000000 124500                    SCM     mask='000'O
         5 000071   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000072   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000073   200561 000100                    ARG     J,,AUTO

     2024     9031    3              call index(I,'.',MAP_BOX) whenreturn do;

   9031  5 000074   000000 124500                    SCM     mask='000'O
         5 000075   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000076   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000077   200560 000100                    ARG     I,,AUTO
         5 000100   000110 606400 5                  TTN     s:9036

     2025     9032    3                 call VERIFY_FOLDER(MAP_BOX,J) altret(BAD_FOLDER);

   9032  5 000101   200561 630500                    EPPR0   J,,AUTO
         5 000102   200662 450500                    STP0    @STRING#+1,,AUTO
         5 000103   200006 631500                    EPPR1   MAP_BOX,,AUTO
         5 000104   200661 451500                    STP1    VM_BUFFER+42,,AUTO
         5 000105   001017 701000 5                  TSX1    VERIFY_FOLDER
         5 000106   000367 702000 5                  TSX2    BAD_FOLDER

     2026     9033    3                 goto LEAVE_AS_IS;

   9033  5 000107   000371 710000 5                  TRA     LEAVE_AS_IS

     2027     9034    3                 end;
     2028     9035
     2029     9036    2              call MAP_ACCT_TO_REGISTERED_NAME altret(BAD_FOLDER);

   9036  5 000110   000463 701000 5                  TSX1    MAP_ACCT_TO_REGISTERED_NAME
         5 000111   000367 702000 5                  TSX2    BAD_FOLDER

     2030     9037
     2031     9038    2              if substr(NAME_BUFFER.NAME#,0,1) ~= '.' then
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:281  

   9038  5 000112   200420 236100                    LDQ     NAME_BUFFER,,AUTO
         5 000113   000777 376003                    ANQ     511,DU
         5 000114   000056 116003                    CMPQ    46,DU
         5 000115   000213 600000 5                  TZE     s:9051

     2032     9039    3              do;                /**  We found a registration for this user   **/

     2033     9040    3                 if NAME_BUFFER.L# + J < 80 then

   9040  5 000116   200420 236100                    LDQ     NAME_BUFFER,,AUTO
         5 000117   000033 772000                    QRL     27
         5 000120   200561 036100                    ADLQ    J,,AUTO
         5 000121   000120 116007                    CMPQ    80,DL
         5 000122   000171 605000 5                  TPL     s:9048

     2034     9041    4                 do;                       /** Registered name will fit!  **/

     2035     9042    4                    call concat(FOLD_STRING,

   9042  5 000123   200561 720100                    LXL0    J,,AUTO
         5 000124   040100 100540                    MLR     fill='040'O
         5 000125   200006 000010                    ADSC9   MAP_BOX,,AUTO            cn=0,n=*X0
         5 000126   200563 000120                    ADSC9   FOLD_STRING,,AUTO        cn=0,n=80
         5 000127   200561 236100                    LDQ     J,,AUTO
         5 000130   000120 116007                    CMPQ    80,DL
         5 000131   000147 605000 5                  TPL     s:9044
         5 000132   777657 621006                    EAX1    -81,QL
         5 000133   777777 661003                    ERX1    -1,DU
         5 000134   040146 100400                    MLR     fill='040'O
         5 000135   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000136   200563 000011                    ADSC9   FOLD_STRING,Q,AUTO       cn=0,n=*X1
         5 000137   200561 236100                    LDQ     J,,AUTO
         5 000140   000117 116007                    CMPQ    79,DL
         5 000141   000147 605000 5                  TPL     s:9044
         5 000142   777660 620006                    EAX0    -80,QL
         5 000143   777777 660003                    ERX0    -1,DU
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:282  
         5 000144   040146 100500                    MLR     fill='040'O
         5 000145   200310 200010                    ADSC9   NAME_KEY,,AUTO           cn=1,n=8
         5 000146   200563 200010                    ADSC9   FOLD_STRING,Q,AUTO       cn=1,n=*X0

     2036     9043    4                      substr(MAP_BOX,,J),'.',substr(NAME_KEY.NAME#,,8));
     2037     9044    4                    substr(NAME_BUFFER.NAME#,NAME_BUFFER.L#) = substr(MAP_BOX,,J);

   9044  5 000147   200420 236100                    LDQ     NAME_BUFFER,,AUTO
         5 000150   000033 772000                    QRL     27
         5 000151   777400 620006                    EAX0    -256,QL
         5 000152   777777 660003                    ERX0    -1,DU
         5 000153   200561 721100                    LXL1    J,,AUTO
         5 000154   040146 100540                    MLR     fill='040'O
         5 000155   200006 000011                    ADSC9   MAP_BOX,,AUTO            cn=0,n=*X1
         5 000156   200420 200010                    ADSC9   NAME_BUFFER,Q,AUTO       cn=1,n=*X0

     2038     9045    4                    MAP_BOX = substr(NAME_BUFFER.NAME#,,NAME_BUFFER.L#+J);

   9045  5 000157   200420 236100                    LDQ     NAME_BUFFER,,AUTO
         5 000160   000033 772000                    QRL     27
         5 000161   200561 036100                    ADLQ    J,,AUTO
         5 000162   000000 620006                    EAX0    0,QL
         5 000163   040100 100540                    MLR     fill='040'O
         5 000164   200420 200010                    ADSC9   NAME_BUFFER,,AUTO        cn=1,n=*X0
         5 000165   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79

     2039     9046    4                    J = J + 9;             /** Include the account **/

   9046  5 000166   000011 236007                    LDQ     9,DL
         5 000167   200561 056100                    ASQ     J,,AUTO

     2040     9047    4                    end;                   /*  Of if Registered name fits        */

   9047  5 000170   000204 710000 5                  TRA     s:9049

     2041     9048    3                 else call concat(substr(MAP_BOX,,J),'.',USER_ACCT.ACCT#);

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:283  
   9048  5 000171   200561 720100                    LXL0    J,,AUTO
         5 000172   040140 100400                    MLR     fill='040'O
         5 000173   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000174   200006 000010                    ADSC9   MAP_BOX,,AUTO            cn=0,n=*X0
         5 000175   200561 236100                    LDQ     J,,AUTO
         5 000176   000001 116007                    CMPQ    1,DL
         5 000177   000204 604400 5                  TMOZ    s:9049
         5 000200   777777 620006                    EAX0    -1,QL
         5 000201   040140 100500                    MLR     fill='040'O
         5 000202   200520 000010                    ADSC9   USER_ACCT,,AUTO          cn=0,n=8
         5 000203   200006 200010                    ADSC9   MAP_BOX,,AUTO            cn=1,n=*X0

     2042     9049    3                 call VERIFY_FOLDER( FOLD_STRING, J) altret(BAD_FOLDER);

   9049  5 000204   200561 630500                    EPPR0   J,,AUTO
         5 000205   200662 450500                    STP0    @STRING#+1,,AUTO
         5 000206   200563 631500                    EPPR1   FOLD_STRING,,AUTO
         5 000207   200661 451500                    STP1    VM_BUFFER+42,,AUTO
         5 000210   001017 701000 5                  TSX1    VERIFY_FOLDER
         5 000211   000367 702000 5                  TSX2    BAD_FOLDER

     2043     9050    3                 end;                      /*  Of Registered name found          */

   9050  5 000212   000362 710000 5                  TRA     EXIT_NAME_SERVER

     2044     9051    2              else substr(MAP_BOX,J) = substr(NAME_BUFFER.NAME#,,NAME_BUFFER.L#);

   9051  5 000213   200420 236100                    LDQ     NAME_BUFFER,,AUTO
         5 000214   000033 772000                    QRL     27
         5 000215   200561 720100                    LXL0    J,,AUTO
         5 000216   777660 620010                    EAX0    -80,X0
         5 000217   777777 660003                    ERX0    -1,DU
         5 000220   000000 621006                    EAX1    0,QL
         5 000221   200561 235100                    LDA     J,,AUTO
         5 000222   040145 100540                    MLR     fill='040'O
         5 000223   200420 200011                    ADSC9   NAME_BUFFER,,AUTO        cn=1,n=*X1
         5 000224   200006 000010                    ADSC9   MAP_BOX,A,AUTO           cn=0,n=*X0
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:284  

     2045     9052    2              end;          /**  Of mailbox starts with folder specification **/

   9052  5 000225   000362 710000 5                  TRA     EXIT_NAME_SERVER

     2046     9053
     2047     9054    1           else
     2048     9055
     2049     9056    2           do;

     2050     9057                                           /**  This must be a registered name!   **/
     2051     9058    2              call index(J,' ',MAP_BOX);

   9058  5 000226   000000 124500                    SCM     mask='000'O
         5 000227   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000230   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000231   200561 000100                    ARG     J,,AUTO

     2052     9059    3              call index(I,'.',MAP_BOX) whenreturn do;

   9059  5 000232   000000 124500                    SCM     mask='000'O
         5 000233   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000234   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000235   200560 000100                    ARG     I,,AUTO
         5 000236   000255 606400 5                  TTN     s:9066

     2053     9060    4                 if substr(MAP_BOX,,6) = ':MAIL_' and J>I then do;

   9060  5 000237   040000 106500                    CMPC    fill='040'O
         5 000240   200006 000006                    ADSC9   MAP_BOX,,AUTO            cn=0,n=6
         5 000241   000300 000006 4                  ADSC9   CLOSE_CONSTANT+30        cn=0,n=6
         5 000242   000255 601000 5                  TNZ     s:9066
         5 000243   200561 236100                    LDQ     J,,AUTO
         5 000244   200560 116100                    CMPQ    I,,AUTO
         5 000245   000255 604400 5                  TMOZ    s:9066

     2054     9061    4                    call VERIFY_FOLDER(MAP_BOX,J) altret(BAD_FOLDER);
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:285  

   9061  5 000246   200561 630500                    EPPR0   J,,AUTO
         5 000247   200662 450500                    STP0    @STRING#+1,,AUTO
         5 000250   200006 631500                    EPPR1   MAP_BOX,,AUTO
         5 000251   200661 451500                    STP1    VM_BUFFER+42,,AUTO
         5 000252   001017 701000 5                  TSX1    VERIFY_FOLDER
         5 000253   000367 702000 5                  TSX2    BAD_FOLDER

     2055     9062    4                    goto LEAVE_AS_IS;

   9062  5 000254   000371 710000 5                  TRA     LEAVE_AS_IS

     2056     9063    4                    end;
     2057     9064    3                 end;
     2058     9065
     2059     9066    2              call searchr(I,J,B$SR_NON_BLANK,MAP_BOX);

   9066  5 000255   000000 470400 xsym               LDP0    B$SR_NON_BLANK$
         5 000256   000000 165500                    TCTR
         5 000257   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000260   000000 000100                    ARG     0,,PR0
         5 000261   200560 000100                    ARG     I,,AUTO
         5 000262   200560 235100                    LDA     I,,AUTO
         5 000263   000033 771000                    ARL     27
         5 000264   200561 755100                    STA     J,,AUTO
         5 000265   200560 551140                    STBA    I,'40'O,AUTO
         5 000266   000271 606400 5                  TTN     s:9067
         5 000267   000116 236007                    LDQ     78,DL
         5 000270   200560 156100                    SSQ     I,,AUTO

     2060     9067    3              call index(J,'/',MAP_BOX) whenaltreturn do; J = I; end;

   9067  5 000271   000000 124500                    SCM     mask='000'O
         5 000272   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000273   000004 000001 6                  ADSC9   4                        cn=0,n=1
         5 000274   200561 000100                    ARG     J,,AUTO
         5 000275   000277 606400 5                  TTN     s:9067+6
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:286  
         5 000276   000301 710000 5                  TRA     s:9069

   9067  5 000277   200560 235100                    LDA     I,,AUTO
         5 000300   200561 755100                    STA     J,,AUTO

     2061     9068
     2062     9069    2              call LOCATE_REGISTERED_NAME( MAP_BOX, J ) altret(BAD_FOLDER);

   9069  5 000301   200561 630500                    EPPR0   J,,AUTO
         5 000302   200662 450500                    STP0    @STRING#+1,,AUTO
         5 000303   200006 631500                    EPPR1   MAP_BOX,,AUTO
         5 000304   200661 451500                    STP1    VM_BUFFER+42,,AUTO
         5 000305   000652 701000 5                  TSX1    LOCATE_REGISTERED_NAME
         5 000306   000367 702000 5                  TSX2    BAD_FOLDER

     2063     9070    2              if NAME_KEY.NAME# ~= ' ' then

   9070  5 000307   040000 106500                    CMPC    fill='040'O
         5 000310   200310 200037                    ADSC9   NAME_KEY,,AUTO           cn=1,n=31
         5 000311   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000312   000362 600000 5                  TZE     EXIT_NAME_SERVER

     2064     9071    3              do;

     2065     9072    3                 call concat(FOLD_STRING,substr(MAP_BOX,J,maximum(0,I-J+1)),'.',
              9072                          NAME_KEY.NAME#);

   9072  5 000313   200560 236100                    LDQ     I,,AUTO
         5 000314   200561 136100                    SBLQ    J,,AUTO
         5 000315   000001 036007                    ADLQ    1,DL
         5 000316   000000 116003                    CMPQ    0,DU
         5 000317   000321 605000 5                  TPL     s:9072+6
         5 000320   000000 236003                    LDQ     0,DU
         5 000321   000000 620006                    EAX0    0,QL
         5 000322   200561 235100                    LDA     J,,AUTO
         5 000323   040100 100545                    MLR     fill='040'O
         5 000324   200006 000010                    ADSC9   MAP_BOX,A,AUTO           cn=0,n=*X0
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:287  
         5 000325   200563 000120                    ADSC9   FOLD_STRING,,AUTO        cn=0,n=80
         5 000326   000120 116007                    CMPQ    80,DL
         5 000327   000344 605000 5                  TPL     s:9073
         5 000330   777657 620006                    EAX0    -81,QL
         5 000331   777777 660003                    ERX0    -1,DU
         5 000332   040146 100400                    MLR     fill='040'O
         5 000333   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000334   200563 000010                    ADSC9   FOLD_STRING,Q,AUTO       cn=0,n=*X0
         5 000335   000117 116007                    CMPQ    79,DL
         5 000336   000344 605000 5                  TPL     s:9073
         5 000337   777660 620006                    EAX0    -80,QL
         5 000340   777777 660003                    ERX0    -1,DU
         5 000341   040146 100500                    MLR     fill='040'O
         5 000342   200310 200037                    ADSC9   NAME_KEY,,AUTO           cn=1,n=31
         5 000343   200563 200010                    ADSC9   FOLD_STRING,Q,AUTO       cn=1,n=*X0

     2066     9073    3                 call VERIFY_FOLDER( FOLD_STRING, maximum(0,I-J+1)+9) altret (
              9073                          BAD_FOLDER);

   9073  5 000344   200560 236100                    LDQ     I,,AUTO
         5 000345   200561 136100                    SBLQ    J,,AUTO
         5 000346   000001 036007                    ADLQ    1,DL
         5 000347   000000 116003                    CMPQ    0,DU
         5 000350   000352 605000 5                  TPL     s:9073+6
         5 000351   000000 236003                    LDQ     0,DU
         5 000352   000011 036007                    ADLQ    9,DL
         5 000353   200701 756100                    STQ     OPEN_NAME+10,,AUTO
         5 000354   200701 630500                    EPPR0   OPEN_NAME+10,,AUTO
         5 000355   200662 450500                    STP0    @STRING#+1,,AUTO
         5 000356   200563 631500                    EPPR1   FOLD_STRING,,AUTO
         5 000357   200661 451500                    STP1    VM_BUFFER+42,,AUTO
         5 000360   001017 701000 5                  TSX1    VERIFY_FOLDER
         5 000361   000367 702000 5                  TSX2    BAD_FOLDER

     2067     9074    3                 end;

     2068     9075
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:288  
     2069     9076    2              end;

     2070     9077
     2071     9078    1   EXIT_NAME_SERVER:
     2072     9079    1           MAILBOX = MAP_BOX;

   9079  5 000362   200003 470500       EXIT_NAME_S* LDP0    @MAILBOX,,AUTO
         5 000363   040100 100500                    MLR     fill='040'O
         5 000364   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000365   000000 000117                    ADSC9   0,,PR0                   cn=0,n=79

     2073     9080    1           return;

   9080  5 000366   000000 702200 xent               TSX2  ! X66_ARET

     2074     9081
     2075     9082
     2076     9083    1   BAD_FOLDER:
     2077     9084    1           altreturn;

   9084  5 000367   000000 702200 xent  BAD_FOLDER   TSX2  ! X66_AALT

     2078     9085
     2079     9086    1   BAD_OPEN:
     2080     9087    1           altreturn;

   9087  5 000370   000000 702200 xent  BAD_OPEN     TSX2  ! X66_AALT

     2081     9088
     2082     9089    1   LEAVE_AS_IS:
     2083     9090    1           return;

   9090  5 000371   000000 702200 xent  LEAVE_AS_IS  TSX2  ! X66_ARET

     2084     9091
     2085     9092
     2086     9093    1   VWM$FIX_MAILBOX: entry(MAILBOX, VM_IAM#, VM_ERR#) altret;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:289  

   9093  5 000372   000000 700200 xent  VWM$FIX_MAI* TSX0  ! X66_AUTO_3
         5 000373   000702 000003                    ZERO    450,3

     2087     9094
     2088     9095    1           MAP_BOX = MAILBOX;

   9095  5 000374   200003 470500                    LDP0    @MAILBOX,,AUTO
         5 000375   040100 100500                    MLR     fill='040'O
         5 000376   000000 000117                    ADSC9   0,,PR0                   cn=0,n=79
         5 000377   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79

     2089     9096    1           if MAP_BOX = ' ' then

   9096  5 000400   040000 106500                    CMPC    fill='040'O
         5 000401   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000402   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000403   000413 601000 5                  TNZ     s:9102

     2090     9097    2           do;

     2091     9098    2              call concat(MAP_BOX,'.',VM_IAM#);

   9098  5 000404   056000 236003                    LDQ     23552,DU
         5 000405   200006 756100                    STQ     MAP_BOX,,AUTO
         5 000406   200004 471500                    LDP1    @VM_IAM#,,AUTO
         5 000407   040100 100500                    MLR     fill='040'O
         5 000410   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         5 000411   200006 200116                    ADSC9   MAP_BOX,,AUTO            cn=1,n=78

     2092     9099    2              end;

   9099  5 000412   000462 710000 5                  TRA     s:9112

     2093     9100    1           else
     2094     9101    2           do;

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:290  
     2095     9102    2              if substr(MAP_BOX,,1) = '/' then

   9102  5 000413   200006 236100                    LDQ     MAP_BOX,,AUTO
         5 000414   777000 376003                    ANQ     -512,DU
         5 000415   057000 116003                    CMPQ    24064,DU
         5 000416   000462 601000 5                  TNZ     s:9112

     2096     9103    3              do;

     2097     9104    3                 call index(J,' ',MAP_BOX);

   9104  5 000417   000000 124500                    SCM     mask='000'O
         5 000420   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000421   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000422   200561 000100                    ARG     J,,AUTO

     2098     9105    4                 call index(I,'.',MAP_BOX) whenreturn do;

   9105  5 000423   000000 124500                    SCM     mask='000'O
         5 000424   200006 000117                    ADSC9   MAP_BOX,,AUTO            cn=0,n=79
         5 000425   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000426   200560 000100                    ARG     I,,AUTO
         5 000427   000442 606400 5                  TTN     s:9109

     2099     9106    4                    if substr(MAP_BOX,I+1,1) ~= ' ' then goto EXIT_NAME_SERVER;

   9106  5 000430   200560 235100                    LDA     I,,AUTO
         5 000431   040000 106505                    CMPC    fill='040'O
         5 000432   200006 200001                    ADSC9   MAP_BOX,A,AUTO           cn=1,n=1
         5 000433   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000434   000362 601000 5                  TNZ     EXIT_NAME_SERVER

     2100     9107    4                    J = minimum(I,J);

   9107  5 000435   200561 236100                    LDQ     J,,AUTO
         5 000436   200560 116100                    CMPQ    I,,AUTO
         5 000437   000441 604400 5                  TMOZ    s:9107+4
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:291  
         5 000440   200560 236100                    LDQ     I,,AUTO
         5 000441   200561 756100                    STQ     J,,AUTO

     2101     9108    4                    end;

     2102     9109    3                 call concat(substr(MAP_BOX,J),'.',VM_IAM#);

   9109  5 000442   200561 720100                    LXL0    J,,AUTO
         5 000443   777660 620010                    EAX0    -80,X0
         5 000444   777777 660003                    ERX0    -1,DU
         5 000445   200561 235100                    LDA     J,,AUTO
         5 000446   040145 100400                    MLR     fill='040'O
         5 000447   000003 000001 6                  ADSC9   3                        cn=0,n=1
         5 000450   200006 000010                    ADSC9   MAP_BOX,A,AUTO           cn=0,n=*X0
         5 000451   200561 236100                    LDQ     J,,AUTO
         5 000452   000116 116007                    CMPQ    78,DL
         5 000453   000462 605000 5                  TPL     s:9112
         5 000454   777661 620006                    EAX0    -79,QL
         5 000455   777777 660003                    ERX0    -1,DU
         5 000456   200004 470500                    LDP0    @VM_IAM#,,AUTO
         5 000457   040146 100500                    MLR     fill='040'O
         5 000460   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         5 000461   200006 200010                    ADSC9   MAP_BOX,Q,AUTO           cn=1,n=*X0

     2103     9110    3                 end;

     2104     9111    2              end;

     2105     9112    1           goto EXIT_NAME_SERVER;

   9112  5 000462   000362 710000 5                  TRA     EXIT_NAME_SERVER

     2106     9113
     2107     9114        %eject;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:292  
     2108     9115    1   MAP_ACCT_TO_REGISTERED_NAME: proc altret;

   9115  5 000463   200660 741300       MAP_ACCT_TO* STX1  ! VM_BUFFER+41,,AUTO

     2109     9116
     2110     9117        /*I*    NAME:    MAP_ACCT_TO_REGISTERED_NAME
     2111     9118                PURPOSE: To turn the logon or filemanagement account
     2112     9119                         into a registered name.
     2113     9120                DESCRIPTION:   The :NAME file is accessed to determine
     2114     9121                            whether a registered name exists for this
     2115     9122                            account.  If it does not, then we look for
     2116     9123                            a mailbox in either the logon or file
     2117     9124                            management account to blame.
     2118     9125                                                                         */
     2119     9126
     2120     9127    2           FPT_READ = READ_NAME;

   9127  5 000464   000100 100400                    MLR     fill='000'O
         5 000465   000206 000070 4                  ADSC9   READ_NAME                cn=0,n=56
         5 000466   200272 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

     2121     9128    2           FPT_READ.V_ = vector(FPT_READ.V);

   9128  5 000467   000005 235000 6                  LDA     5
         5 000470   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000471   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000472   000302 036003                    ADLQ    194,DU
         5 000473   200272 757100                    STAQ    FPT_READ,,AUTO

     2122     9129    2           FPT_READ.KEY_ = vector(NAME_KEY);

   9129  5 000474   000006 235000 6                  LDA     6
         5 000475   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000476   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000477   000310 036003                    ADLQ    200,DU
         5 000500   200274 757100                    STAQ    FPT_READ+2,,AUTO

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:293  
     2123     9130    2           FPT_READ.BUF_ = vector(NAME_BUFFER.NAME#);

   9130  5 000501   000007 235000 6                  LDA     7
         5 000502   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000503   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000504   000010 036000 6                  ADLQ    8
         5 000505   200276 757100                    STAQ    FPT_READ+4,,AUTO

     2124     9131
     2125     9132    2           NAME_KEY.NAME# = B$JIT.ACCN;

   9132  5 000506   000000 470400 xsym               LDP0    B$JIT$
         5 000507   040100 100500                    MLR     fill='040'O
         5 000510   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         5 000511   200310 200037                    ADSC9   NAME_KEY,,AUTO           cn=1,n=31

     2126     9133    2           NAME_KEY.L# = 20;

   9133  5 000512   024000 236003                    LDQ     10240,DU
         5 000513   200310 552140                    STBQ    NAME_KEY,'40'O,AUTO

     2127     9134
     2128     9135    2   LOOK_4_MAP:
     2129     9136    3           do I = 0 to 1 by 1;

   9136  5 000514   200560 450100       LOOK_4_MAP   STZ     I,,AUTO

     2130     9137
     2131     9138    3              if I = 1 then NAME_KEY.NAME# = B$JIT.FACCN;

   9138  5 000515   200560 235100                    LDA     I,,AUTO
         5 000516   000001 115007                    CMPA    1,DL
         5 000517   000524 601000 5                  TNZ     s:9139

   9138  5 000520   000000 470400 xsym               LDP0    B$JIT$
         5 000521   040100 100500                    MLR     fill='040'O
         5 000522   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:294  
         5 000523   200310 200037                    ADSC9   NAME_KEY,,AUTO           cn=1,n=31

     2132     9139    4              call M$READ( FPT_READ ) whenreturn do;

   9139  5 000524   200272 630500                    EPPR0   FPT_READ,,AUTO
         5 000525   440000 713400                    CLIMB   alt,read
         5 000526   401400 401760                    pmme    nvectors=4
         5 000527   000531 702000 5                  TSX2    s:9142

     2133     9140    4                 goto GOT_A_NAME_MAP;

   9140  5 000530   000641 710000 5                  TRA     GOT_A_NAME_MAP

     2134     9141    4                 end;
     2135     9142    3              substr(NAME_KEY.NAME#,8) = B$JIT.UNAME;

   9142  5 000531   000000 470400 xsym               LDP0    B$JIT$
         5 000532   040100 100500                    MLR     fill='040'O
         5 000533   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         5 000534   200312 200027                    ADSC9   NAME_KEY+2,,AUTO         cn=1,n=23

     2136     9143    4              call M$READ( FPT_READ ) whenreturn do;

   9143  5 000535   200272 630500                    EPPR0   FPT_READ,,AUTO
         5 000536   440000 713400                    CLIMB   alt,read
         5 000537   401400 401760                    pmme    nvectors=4
         5 000540   000542 702000 5                  TSX2    s:9147

     2137     9144    4                 goto GOT_A_NAME_MAP;

   9144  5 000541   000641 710000 5                  TRA     GOT_A_NAME_MAP

     2138     9145    4                 end;
     2139     9146
     2140     9147    3              end LOOK_4_MAP;

   9147  5 000542   200560 054100                    AOS     I,,AUTO
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:295  
         5 000543   200560 235100                    LDA     I,,AUTO
         5 000544   000001 115007                    CMPA    1,DL
         5 000545   000515 604400 5                  TMOZ    s:9138

     2141     9148
     2142     9149        /**  Not registered, look for a mailbox in either the
     2143     9150         **  logon account or the file management account.
     2144     9151         **/
     2145     9152    2           FPT_OPEN = OPEN_GLOBAL;

   9152  5 000546   000100 100400                    MLR     fill='000'O
         5 000547   000072 000350 4                  ADSC9   OPEN_GLOBAL              cn=0,n=232
         5 000550   200200 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     2146     9153    2           FPT_OPEN.ACCT_ = vector(USER_ACCT);

   9153  5 000551   000011 235000 6                  LDA     9
         5 000552   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000553   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000554   000520 036003                    ADLQ    336,DU
         5 000555   200224 757100                    STAQ    FPT_OPEN+20,,AUTO

     2147     9154    2           FPT_OPEN.V_ = vector(FPT_OPEN.V);

   9154  5 000556   000012 235000 6                  LDA     10
         5 000557   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000560   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000561   000244 036003                    ADLQ    164,DU
         5 000562   200200 757100                    STAQ    FPT_OPEN,,AUTO

     2148     9155    2           FPT_OPEN.V.DCB# = dcbnum(M$DUMMY);

   9155  5 000563   000000 236007 xsym               LDQ     M$DUMMY,DL
         5 000564   000000 620006                    EAX0    0,QL
         5 000565   200244 740100                    STX0    FPT_OPEN+36,,AUTO

     2149     9156
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:296  
     2150     9157    2           USER_ACCT.ACCT# = B$JIT.ACCN;

   9157  5 000566   000000 470400 xsym               LDP0    B$JIT$
         5 000567   040100 100500                    MLR     fill='040'O
         5 000570   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         5 000571   200520 000010                    ADSC9   USER_ACCT,,AUTO          cn=0,n=8

     2151     9158    3           call M$OPEN(FPT_OPEN) whenaltreturn do;

   9158  5 000572   200200 630500                    EPPR0   FPT_OPEN,,AUTO
         5 000573   450000 713400                    CLIMB   alt,open
         5 000574   410400 401760                    pmme    nvectors=18
         5 000575   000577 702000 5                  TSX2    s:9159
         5 000576   000611 710000 5                  TRA     s:9165

     2152     9159    3              USER_ACCT.ACCT# = B$JIT.FACCN;

   9159  5 000577   000000 470400 xsym               LDP0    B$JIT$
         5 000600   000006 237100                    LDAQ    6,,PR0
         5 000601   200520 757100                    STAQ    USER_ACCT,,AUTO

     2153     9160    4              call M$OPEN(FPT_OPEN) whenaltreturn do;

   9160  5 000602   200200 630500                    EPPR0   FPT_OPEN,,AUTO
         5 000603   450000 713400                    CLIMB   alt,open
         5 000604   410400 401760                    pmme    nvectors=18
         5 000605   000607 702000 5                  TSX2    s:9161
         5 000606   000611 710000 5                  TRA     s:9165

     2154     9161    4                 altreturn;

   9161  5 000607   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 000610   000000 702211                    TSX2  ! 0,X1

     2155     9162    4                 end;
     2156     9163    3              end;

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:297  
     2157     9164
     2158     9165    2           FPT_CLOSE.V.DCB# = dcbnum(M$DUMMY);

   9165  5 000611   000000 236007 xsym               LDQ     M$DUMMY,DL
         5 000612   000000 620006                    EAX0    0,QL
         5 000613   200554 740100                    STX0    FPT_CLOSE+26,,AUTO

     2159     9166    3           call M$CLOSE(FPT_CLOSE) whenaltreturn do; end;

   9166  5 000614   200522 630500                    EPPR0   FPT_CLOSE,,AUTO
         5 000615   450001 713400                    CLIMB   alt,close
         5 000616   406000 401760                    pmme    nvectors=13
         5 000617   000621 702000 5                  TSX2    s:9168
         5 000620   000621 710000 5                  TRA     s:9168

     2160     9167
     2161     9168    2           NAME_BUFFER.L# = 8;

   9168  5 000621   010000 236003                    LDQ     4096,DU
         5 000622   200420 552140                    STBQ    NAME_BUFFER,'40'O,AUTO

     2162     9169    2           call concat(NAME_BUFFER.NAME#,'.',USER_ACCT.ACCT#);

   9169  5 000623   000056 236003                    LDQ     46,DU
         5 000624   200420 552120                    STBQ    NAME_BUFFER,'20'O,AUTO
         5 000625   040100 100500                    MLR     fill='040'O
         5 000626   200520 000010                    ADSC9   USER_ACCT,,AUTO          cn=0,n=8
         5 000627   200420 400376                    ADSC9   NAME_BUFFER,,AUTO        cn=2,n=254

     2163     9170    2           call index(I,' ',NAME_BUFFER.NAME#);

   9170  5 000630   000000 124500                    SCM     mask='000'O
         5 000631   200420 200377                    ADSC9   NAME_BUFFER,,AUTO        cn=1,n=255
         5 000632   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000633   200560 000100                    ARG     I,,AUTO

     2164     9171    2           NAME_BUFFER.L# = I;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:298  

   9171  5 000634   200560 236100                    LDQ     I,,AUTO
         5 000635   000033 736000                    QLS     27
         5 000636   200420 552140                    STBQ    NAME_BUFFER,'40'O,AUTO

     2165     9172    2           return;

   9172  5 000637   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 000640   000001 702211                    TSX2  ! 1,X1

     2166     9173
     2167     9174    2   GOT_A_NAME_MAP:
     2168     9175    2           NAME_BUFFER.L# = dcbaddr(dcbnum(M$NAME))->F$DCB.ARS#;

   9175  5 000641   000000 236007 xsym  GOT_A_NAME_* LDQ     M$NAME,DL
         5 000642   000000 470400 6                  LDP0    0
         5 000643   000000 471500                    LDP1    0,,PR0
         5 000644   100000 473506                    LDP3    0,QL,PR1
         5 000645   300000 236100                    LDQ     0,,PR3
         5 000646   000033 736000                    QLS     27
         5 000647   200420 552140                    STBQ    NAME_BUFFER,'40'O,AUTO

     2169     9176    2           return;

   9176  5 000650   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 000651   000001 702211                    TSX2  ! 1,X1

     2170     9177
     2171     9178    2   end MAP_ACCT_TO_REGISTERED_NAME;
     2172     9179        %eject;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:299  
     2173     9180    1   LOCATE_REGISTERED_NAME: proc( NAME#, L# ) altret;

   9180  5 000652   200660 741300       LOCATE_REGI* STX1  ! VM_BUFFER+41,,AUTO

     2174     9181
     2175     9182        /*I*    NAME:       LOCATE_REGISTERED_NAME
     2176     9183                PURPOSE:    To determine if the specified name is a
     2177     9184                            known registered name.
     2178     9185                DESCRIPTION:   The :MAIL_CENTRAL.:MAIL file is accessed
     2179     9186                            to determine if a given name is registered
     2180     9187                            or not.  If it does not exist, an alternate
     2181     9188                            return is made.
     2182     9189                                                                         */
     2183     9190    2   dcl  NAME#    char(20);
     2184     9191    2   dcl  L#       sbin;
     2185     9192    2   dcl  I        sbin;
     2186     9193    2   dcl  J        sbin;
     2187     9194
     2188     9195
     2189     9196    2           FPT_READ = READ_GLOBAL;

   9196  5 000653   000100 100400                    MLR     fill='000'O
         5 000654   000224 000070 4                  ADSC9   READ_GLOBAL              cn=0,n=56
         5 000655   200272 000070                    ADSC9   FPT_READ,,AUTO           cn=0,n=56

     2190     9197    2           FPT_READ.V_ = vector(FPT_READ.V);

   9197  5 000656   000005 235000 6                  LDA     5
         5 000657   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000660   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000661   000302 036003                    ADLQ    194,DU
         5 000662   200272 757100                    STAQ    FPT_READ,,AUTO

     2191     9198    2           FPT_READ.BUF_ = vector(VM_BUFFER);

   9198  5 000663   000013 235000 6                  LDA     11
         5 000664   200700 452500                    STP2    OPEN_NAME+9,,AUTO
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:300  
         5 000665   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000666   000607 036003                    ADLQ    391,DU
         5 000667   200276 757100                    STAQ    FPT_READ+4,,AUTO

     2192     9199    2           FPT_READ.KEY_ = vector(VM_USERKEY);

   9199  5 000670   000014 235000 6                  LDA     12
         5 000671   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 000672   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 000673   000032 036003                    ADLQ    26,DU
         5 000674   200274 757100                    STAQ    FPT_READ+2,,AUTO

     2193     9200
     2194     9201    2           VM_USERKEY.TEXT = substr(NAME#,,L#);

   9201  5 000675   200662 470500                    LDP0    @L#,,AUTO
         5 000676   000000 720100                    LXL0    0,,PR0
         5 000677   200661 471500                    LDP1    @NAME#,,AUTO
         5 000700   040100 100540                    MLR     fill='040'O
         5 000701   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
         5 000702   200032 400310                    ADSC9   VM_USERKEY,,AUTO         cn=2,n=200

     2195     9202    2           call searchr(I,J,B$SR_NON_BLANK,VM_USERKEY.TEXT);

   9202  5 000703   000000 473400 xsym               LDP3    B$SR_NON_BLANK$
         5 000704   000000 165500                    TCTR
         5 000705   200032 400310                    ADSC9   VM_USERKEY,,AUTO         cn=2,n=200
         5 000706   300000 000100                    ARG     0,,PR3
         5 000707   200663 000100                    ARG     I,,AUTO
         5 000710   200663 235100                    LDA     I,,AUTO
         5 000711   000033 771000                    ARL     27
         5 000712   200664 755100                    STA     J,,AUTO
         5 000713   200663 551140                    STBA    I,'40'O,AUTO
         5 000714   000717 606400 5                  TTN     s:9203
         5 000715   000307 236007                    LDQ     199,DL
         5 000716   200663 156100                    SSQ     I,,AUTO

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:301  
     2196     9203    2           VM_USERKEY.COUNT = I+2;

   9203  5 000717   200663 236100                    LDQ     I,,AUTO
         5 000720   000002 036007                    ADLQ    2,DL
         5 000721   000033 736000                    QLS     27
         5 000722   200032 552140                    STBQ    VM_USERKEY,'40'O,AUTO

     2197     9204    2           VM_USERKEY.TYPE = %VM_TYPE_USER;

   9204  5 000723   000120 236003                    LDQ     80,DU
         5 000724   200032 552120                    STBQ    VM_USERKEY,'20'O,AUTO

     2198     9205    2           VM_LISTKEY.TYPE = %VM_TYPE_LIST;

   9205  5 000725   000074 236003                    LDQ     60,DU
         5 000726   200115 552120                    STBQ    VM_LISTKEY,'20'O,AUTO

     2199     9206
     2200     9207    3           call M$READ(FPT_READ) whenreturn do;

   9207  5 000727   200272 630500                    EPPR0   FPT_READ,,AUTO
         5 000730   440000 713400                    CLIMB   alt,read
         5 000731   401400 401760                    pmme    nvectors=4
         5 000732   000756 702000 5                  TSX2    s:9215

     2201     9208    3              ADD$ = PINCRW(addr(VM_BUFFER),VM_BUFFER.UPPER(3));

   9208  5 000733   200612 220100                    LDX0    VM_BUFFER+3,,AUTO
         5 000734   200607 630510                    EPPR0   VM_BUFFER,X0,AUTO
         5 000735   200562 450500                    STP0    ADD$,,AUTO

     2202     9209    3              if VM_RADDRESS.SITENAME~=VM_IAM# and VM_RADDRESS.SITENAME~=' '

   9209  5 000736   200004 471500                    LDP1    @VM_IAM#,,AUTO
         5 000737   040100 106500                    CMPC    fill='040'O
         5 000740   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
         5 000741   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:302  
         5 000742   000751 600000 5                  TZE     s:9211
         5 000743   040000 106500                    CMPC    fill='040'O
         5 000744   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
         5 000745   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000746   000751 600000 5                  TZE     s:9211

     2203     9210    3              then altreturn;

   9210  5 000747   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 000750   000000 702211                    TSX2  ! 0,X1

     2204     9211    3              NAME_KEY.NAME# = VM_RADDRESS.ACCT;

   9211  5 000751   040100 100500                    MLR     fill='040'O
         5 000752   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
         5 000753   200310 200037                    ADSC9   NAME_KEY,,AUTO           cn=1,n=31

     2205     9212    3              return;

   9212  5 000754   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 000755   000001 702211                    TSX2  ! 1,X1

     2206     9213    3              end;
     2207     9214
     2208     9215    2           NAME_KEY.NAME# = ' ';

   9215  5 000756   040100 100400                    MLR     fill='040'O
         5 000757   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 000760   200310 200037                    ADSC9   NAME_KEY,,AUTO           cn=1,n=31

     2209     9216    2           VM_LISTKEY.TEXT = VM_USERKEY.TEXT;

   9216  5 000761   040100 100500                    MLR     fill='040'O
         5 000762   200032 400310                    ADSC9   VM_USERKEY,,AUTO         cn=2,n=200
         5 000763   200115 400310                    ADSC9   VM_LISTKEY,,AUTO         cn=2,n=200

     2210     9217    2           VM_LISTKEY.COUNT = I+1;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:303  

   9217  5 000764   200663 236100                    LDQ     I,,AUTO
         5 000765   000001 036007                    ADLQ    1,DL
         5 000766   000033 736000                    QLS     27
         5 000767   200115 552140                    STBQ    VM_LISTKEY,'40'O,AUTO

     2211     9218    3           call M$READ(FPT_READ) whenaltreturn do;

   9218  5 000770   200272 630500                    EPPR0   FPT_READ,,AUTO
         5 000771   440000 713400                    CLIMB   alt,read
         5 000772   401400 401760                    pmme    nvectors=4
         5 000773   000775 702000 5                  TSX2    s:9219
         5 000774   000777 710000 5                  TRA     s:9221

     2212     9219    3              altreturn;

   9219  5 000775   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 000776   000000 702211                    TSX2  ! 0,X1

     2213     9220    3              end;
     2214     9221    2           ADD$ = PINCRW(addr(VM_BUFFER),VM_BUFFER.UPPER(3)+2);

   9221  5 000777   200612 220100                    LDX0    VM_BUFFER+3,,AUTO
         5 001000   200611 630510                    EPPR0   VM_BUFFER+2,X0,AUTO
         5 001001   200562 450500                    STP0    ADD$,,AUTO

     2215     9222    2           if VM_RADDRESS.SITENAME~=VM_IAM# and VM_RADDRESS.SITENAME~=' '

   9222  5 001002   200004 471500                    LDP1    @VM_IAM#,,AUTO
         5 001003   040100 106500                    CMPC    fill='040'O
         5 001004   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
         5 001005   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         5 001006   001015 600000 5                  TZE     s:9225
         5 001007   040000 106500                    CMPC    fill='040'O
         5 001010   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
         5 001011   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 001012   001015 600000 5                  TZE     s:9225
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:304  

     2216     9223    2           then altreturn;

   9223  5 001013   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 001014   000000 702211                    TSX2  ! 0,X1

     2217     9224
     2218     9225    2   end LOCATE_REGISTERED_NAME;

   9225  5 001015   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 001016   000001 702211                    TSX2  ! 1,X1

     2219     9226        %eject;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:305  
     2220     9227    1   VERIFY_FOLDER: proc(STRING#, L#) altret;

   9227  5 001017   200660 741300       VERIFY_FOLD* STX1  ! VM_BUFFER+41,,AUTO

     2221     9228
     2222     9229        /*I*    NAME:       VERIFY_FOLDER
     2223     9230                PURPOSE:    To determine if the specified folder exists.
     2224     9231
     2225     9232                DESCRIPTION:   The argument contains a folder specification
     2226     9233                            of the form: :MAIL_?.acct or /?.acct.  This
     2227     9234                            routine maps this argument into the corresponding
     2228     9235                            CP-6 filename and tries to open the folder.
     2229     9236
     2230     9237                            An alternate return is taken if the open is
     2231     9238                            unsuccessfull.
     2232     9239                                                                            */
     2233     9240
     2234     9241    2   dcl  STRING#        char(L#);
     2235     9242    2   dcl  L#             sbin;
     2236     9243    2   dcl  I              sbin;
     2237     9244    2   dcl  DOT            sbin;
     2238     9245
     2239     9246        %VLP_ACCT( FPTN     =  OPEN_ACCT,
     2240     9247                   STCLASS  =  "");
     2241     9260
     2242     9261        %VLP_NAME( FPTN     =  OPEN_NAME,
     2243     9262                   STCLASS  =  "",
     2244     9263                   LEN      =  31);
     2245     9290
     2246     9291    2           FPT_OPEN =  OPEN_GLOBAL;

   9291  5 001020   000100 100400                    MLR     fill='000'O
         5 001021   000072 000350 4                  ADSC9   OPEN_GLOBAL              cn=0,n=232
         5 001022   200200 000350                    ADSC9   FPT_OPEN,,AUTO           cn=0,n=232

     2247     9292    2           FPT_OPEN.V_ = vector(FPT_OPEN.V);

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:306  
   9292  5 001023   000012 235000 6                  LDA     10
         5 001024   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 001025   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 001026   000244 036003                    ADLQ    164,DU
         5 001027   200200 757100                    STAQ    FPT_OPEN,,AUTO

     2248     9293    2           FPT_OPEN.NAME_ = vector(OPEN_NAME);

   9293  5 001030   000006 235000 6                  LDA     6
         5 001031   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 001032   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 001033   000667 036003                    ADLQ    439,DU
         5 001034   200206 757100                    STAQ    FPT_OPEN+6,,AUTO

     2249     9294    2           FPT_OPEN.ACCT_ = vector(OPEN_ACCT);

   9294  5 001035   000011 235000 6                  LDA     9
         5 001036   200700 452500                    STP2    OPEN_NAME+9,,AUTO
         5 001037   200700 236100                    LDQ     OPEN_NAME+9,,AUTO
         5 001040   000665 036003                    ADLQ    437,DU
         5 001041   200224 757100                    STAQ    FPT_OPEN+20,,AUTO

     2250     9295    2           FPT_OPEN.V.DCB# = dcbnum(M$DUMMY);

   9295  5 001042   000000 236007 xsym               LDQ     M$DUMMY,DL
         5 001043   000000 620006                    EAX0    0,QL
         5 001044   200244 740100                    STX0    FPT_OPEN+36,,AUTO

     2251     9296
     2252     9297    2           call index(DOT,'.',STRING#);

   9297  5 001045   200662 470500                    LDP0    @L#,,AUTO
         5 001046   000000 722100                    LXL2    0,,PR0
         5 001047   200661 471500                    LDP1    @STRING#,,AUTO
         5 001050   000000 124540                    SCM     mask='000'O
         5 001051   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
         5 001052   000003 000001 6                  ADSC9   3                        cn=0,n=1
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:307  
         5 001053   200664 000100                    ARG     DOT,,AUTO

     2253     9298    2           if substr(STRING#,,1) = '/' then

   9298  5 001054   040000 106500                    CMPC    fill='040'O
         5 001055   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 001056   000004 000001 6                  ADSC9   4                        cn=0,n=1
         5 001057   001101 601000 5                  TNZ     s:9312

     2254     9299    3           do;

     2255     9300    3              OPEN_NAME.NAME# = ':MAIL_CENTRAL';

   9300  5 001060   040100 100400                    MLR     fill='040'O
         5 001061   000302 000015 4                  ADSC9   CLOSE_CONSTANT+32        cn=0,n=13
         5 001062   200667 200037                    ADSC9   OPEN_NAME,,AUTO          cn=1,n=31

     2256     9301    3              if DOT > 1 then

   9301  5 001063   200664 236100                    LDQ     DOT,,AUTO
         5 001064   000001 116007                    CMPQ    1,DL
         5 001065   001076 604400 5                  TMOZ    s:9306

     2257     9302    4              do;

     2258     9303    4                 substr(OPEN_NAME.NAME#,6) = substr(STRING#,1,DOT-1);

   9303  5 001066   000000 722100                    LXL2    0,,PR0
         5 001067   777777 623006                    EAX3    -1,QL
         5 001070   040100 100540                    MLR     fill='040'O
         5 001071   100000 200013                    ADSC9   0,,PR1                   cn=1,n=*X3
         5 001072   200670 600031                    ADSC9   OPEN_NAME+1,,AUTO        cn=3,n=25

     2259     9304    4                 I = DOT + 5;

   9304  5 001073   000005 036007                    ADLQ    5,DL
         5 001074   200663 756100                    STQ     I,,AUTO
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:308  

     2260     9305    4                 end;

   9305  5 001075   001125 710000 5                  TRA     s:9321

     2261     9306    3              else I = %lengthc(':MAIL_CENTRAL');

   9306  5 001076   000015 235007                    LDA     13,DL
         5 001077   200663 755100                    STA     I,,AUTO

     2262     9307    3              end;

   9307  5 001100   001125 710000 5                  TRA     s:9321

     2263     9308
     2264     9309    2           else
     2265     9310
     2266     9311    3           do;                             /***  A fid? ***/

     2267     9312    3              I = DOT;

   9312  5 001101   200664 236100                    LDQ     DOT,,AUTO
         5 001102   200663 756100                    STQ     I,,AUTO

     2268     9313    3              if substr(STRING#,,6)~= ':MAIL_' then

   9313  5 001103   040000 106500                    CMPC    fill='040'O
         5 001104   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         5 001105   000300 000006 4                  ADSC9   CLOSE_CONSTANT+30        cn=0,n=6
         5 001106   001121 600000 5                  TZE     s:9318

     2269     9314    4              do;

     2270     9315    4                 call concat(OPEN_NAME.NAME#,':MAIL_',substr(STRING#,,DOT-1));

   9315  5 001107   040100 100400                    MLR     fill='040'O
         5 001110   000300 000006 4                  ADSC9   CLOSE_CONSTANT+30        cn=0,n=6
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:309  
         5 001111   200667 200006                    ADSC9   OPEN_NAME,,AUTO          cn=1,n=6
         5 001112   777777 622006                    EAX2    -1,QL
         5 001113   040100 100540                    MLR     fill='040'O
         5 001114   100000 000012                    ADSC9   0,,PR1                   cn=0,n=*X2
         5 001115   200670 600031                    ADSC9   OPEN_NAME+1,,AUTO        cn=3,n=25

     2271     9316    4                 I = I + 5;

   9316  5 001116   000005 236007                    LDQ     5,DL
         5 001117   200663 056100                    ASQ     I,,AUTO

     2272     9317    4                 end;

   9317  5 001120   001125 710000 5                  TRA     s:9321

     2273     9318    3              else OPEN_NAME.NAME# = substr(STRING#,,I);

   9318  5 001121   000000 623006                    EAX3    0,QL
         5 001122   040100 100540                    MLR     fill='040'O
         5 001123   100000 000013                    ADSC9   0,,PR1                   cn=0,n=*X3
         5 001124   200667 200037                    ADSC9   OPEN_NAME,,AUTO          cn=1,n=31

     2274     9319    3              end;

     2275     9320
     2276     9321    2           OPEN_NAME.L# = I;

   9321  5 001125   200663 236100                    LDQ     I,,AUTO
         5 001126   000033 736000                    QLS     27
         5 001127   200667 552140                    STBQ    OPEN_NAME,'40'O,AUTO

     2277     9322    2           if (DOT+1) >= L#

   9322  5 001130   200662 470500                    LDP0    @L#,,AUTO
         5 001131   200664 236100                    LDQ     DOT,,AUTO
         5 001132   000001 036007                    ADLQ    1,DL
         5 001133   000000 116100                    CMPQ    0,,PR0
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:310  
         5 001134   001142 604000 5                  TMI     s:9324

     2278     9323    2           then OPEN_ACCT.ACCT# = B$JIT.ACCN;

   9323  5 001135   000000 471400 xsym               LDP1    B$JIT$
         5 001136   040100 100500                    MLR     fill='040'O
         5 001137   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         5 001140   200665 000010                    ADSC9   OPEN_ACCT,,AUTO          cn=0,n=8
         5 001141   001154 710000 5                  TRA     s:9325

     2279     9324    2           else OPEN_ACCT.ACCT# = substr(STRING#,DOT+1);

   9324  5 001142   000000 720100                    LXL0    0,,PR0
         5 001143   000000 636010                    EAQ     0,X0
         5 001144   000022 732000                    QRS     18
         5 001145   200664 136100                    SBLQ    DOT,,AUTO
         5 001146   777777 621006                    EAX1    -1,QL
         5 001147   200661 471500                    LDP1    @STRING#,,AUTO
         5 001150   200664 235100                    LDA     DOT,,AUTO
         5 001151   040100 100545                    MLR     fill='040'O
         5 001152   100000 200011                    ADSC9   0,A,PR1                  cn=1,n=*X1
         5 001153   200665 000010                    ADSC9   OPEN_ACCT,,AUTO          cn=0,n=8

     2280     9325    2           if OPEN_ACCT.ACCT# = ' ' then OPEN_ACCT.ACCT# = B$JIT.ACCN;

   9325  5 001154   040000 106500                    CMPC    fill='040'O
         5 001155   200665 000010                    ADSC9   OPEN_ACCT,,AUTO          cn=0,n=8
         5 001156   000002 000001 6                  ADSC9   2                        cn=0,n=1
         5 001157   001164 601000 5                  TNZ     s:9327

   9325  5 001160   000000 471400 xsym               LDP1    B$JIT$
         5 001161   040100 100500                    MLR     fill='040'O
         5 001162   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8
         5 001163   200665 000010                    ADSC9   OPEN_ACCT,,AUTO          cn=0,n=8

     2281     9326
     2282     9327    3           call M$OPEN( FPT_OPEN ) whenreturn do; goto OKAY; end;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:311  

   9327  5 001164   200200 630500                    EPPR0   FPT_OPEN,,AUTO
         5 001165   450000 713400                    CLIMB   alt,open
         5 001166   410400 401760                    pmme    nvectors=18
         5 001167   001171 702000 5                  TSX2    s:9328

   9327  5 001170   001210 710000 5                  TRA     OKAY

     2283     9328    2           if OPEN_ACCT.ACCT# = B$JIT.ACCN then

   9328  5 001171   000000 470400 xsym               LDP0    B$JIT$
         5 001172   040100 106500                    CMPC    fill='040'O
         5 001173   200665 000010                    ADSC9   OPEN_ACCT,,AUTO          cn=0,n=8
         5 001174   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         5 001175   001206 601000 5                  TNZ     s:9334

     2284     9329    3           do;

     2285     9330    3              OPEN_ACCT.ACCT# = B$JIT.FACCN;

   9330  5 001176   000006 237100                    LDAQ    6,,PR0
         5 001177   200665 755100                    STA     OPEN_ACCT,,AUTO
         5 001200   200666 756100                    STQ     OPEN_ACCT+1,,AUTO

     2286     9331    4              call M$OPEN( FPT_OPEN ) whenreturn do; goto OKAY; end;

   9331  5 001201   200200 630500                    EPPR0   FPT_OPEN,,AUTO
         5 001202   450000 713400                    CLIMB   alt,open
         5 001203   410400 401760                    pmme    nvectors=18
         5 001204   001206 702000 5                  TSX2    s:9334

   9331  5 001205   001210 710000 5                  TRA     OKAY

     2287     9332    3              end;

     2288     9333
     2289     9334    2           altreturn;
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:312  

   9334  5 001206   200660 221300                    LDX1  ! VM_BUFFER+41,,AUTO
         5 001207   000000 702211                    TSX2  ! 0,X1

     2290     9335
     2291     9336    2   OKAY:
     2292     9337    2           return;

   9337  5 001210   200660 221300       OKAY         LDX1  ! VM_BUFFER+41,,AUTO
         5 001211   000001 702211                    TSX2  ! 1,X1

OPEN_NAME
 Sect OctLoc
   4     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
   4     004   000000 177640   000000 006014   000007 777640   000174 006000    .............|..
   4     010   000000 177640   000000 006014   000000 177640   000000 006014    ................
   4     024*  000001 777640   000204 006000   000000 177640   000000 006014    ................
   4     030   000000 177640   000000 006014   000000 177640   000000 006014    ................
   4     044*  000000 400052   000000 002001   252525 000000   000040 252520    ...*......... ..
   4     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   4     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     060   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   4     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
   4     070   000000 000000   ****** ******                                    ........

OPEN_GLOBAL
 Sect OctLoc
   4     072   000025 777640   000136 006000   000000 177640   000000 006014    .....^..........
   4     076   000000 177640   000000 006014   000007 777640   000164 006000    .............t..
   4     102   000000 177640   000000 006014   000000 177640   000000 006014    ................
   4     116*  000001 777640   000204 006000   000000 177640   000000 006014    ................
   4     122   000000 177640   000000 006014   000000 177640   000000 006014    ................
   4     136*  000000 400052   000000 002001   252525 000000   000040 252520    ...*......... ..
   4     142   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   4     146   000000 000000   000000 000000   000000 000000   000000 000000    ................
   4     152   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   4     156   040040 040040   000000 000000   000000 000000   000000 000000        ............
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:313  
   4     162   000000 000000   ****** ******                                    ........

VM_GLOBAL_NAME
 Sect OctLoc
   4     164   015072 115101   111114 137103   105116 124122   101114 040040    .:MAIL_CENTRAL
   4     170   040040 040040   040040 040040   040040 040040   040040 040040

VM_NAME_MAP_NAME
 Sect OctLoc
   4     174   005072 116101   115105 040040   040040 040040   040040 040040    .:NAME
   4     200   040040 040040   040040 040040   040040 040040   040040 040040

VM_MAIL_ACCT
 Sect OctLoc
   4     204   072115 101111   114040 040040                                    :MAIL

READ_NAME
 Sect OctLoc
   4     206   000005 777640   000216 006000   000000 177640   000000 006014    ................
   4     212   000000 177640   000000 006014   000000 177640   000000 006014    ................
   4     216   000000 600000   000000 000000   000000 000000   000000 000000    ................
   4     222   000000 000000   000000 000000                                    ........

READ_GLOBAL
 Sect OctLoc
   4     224   000005 777640   000234 006000   000000 177640   000000 006014    ................
   4     230   000000 177640   000000 006014   000000 177640   000000 006014    ................
   4     234   000000 600000   000000 000000   000000 000000   000000 000000    ................
   4     240   000000 000000   000000 000000                                    ........

CLOSE_CONSTANT
 Sect OctLoc
   4     242   000003 777640   000274 006000   000000 177640   000000 006014    ................
   4     246   000000 177640   000000 006014   000000 177640   000000 006014    ................
   4     272*  000000 177640   000000 006014   000000 000000   000000 000040    ...............
   4     276   000220 000000   000000 000000                                    ........

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:314  
(unnamed)
 Sect OctLoc
   4     300   072115 101111   114137 040040   072115 101111   114137 103105    :MAIL_  :MAIL_CE
   4     304   116124 122101   114040 040040                                    NTRAL

(unnamed)
 Sect OctLoc
   6     000   000000 006003   000003 777640   040040 040040   056040 040040    ........    .
   6     004   057040 040040   000005 777640   000007 777640   000077 577640    /   .........?..
   6     010   000420 200000   000001 777640   000025 777640   000047 777640    .............'..
   6     014   000062 377640                                                    .2..
     2293     9338
     2294     9339    2   end VERIFY_FOLDER;
     2295     9340
     2296     9341    1   end VWM$GET_MAILBOX;

PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:315  
--  Include file information  --

   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B$JIT_C.:LIB_E05  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
      No diagnostics issued in procedure VWM$GET_MAILBOX.
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:316  

 **** Variables and constants ****

  ****  Section 004 RoData VWM$GET_MAILBOX

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   242-0-0/d STRC(1080)  r     1 CLOSE_CONSTANT            72-0-0/d STRC(2088)  r     1 OPEN_GLOBAL
     0-0-0/d STRC(2088)  r     1 OPEN_NAME                224-0-0/d STRC(504)   r     1 READ_GLOBAL
   206-0-0/d STRC(504)   r     1 READ_NAME                164-0-0/c STRC(288)   r     1 VM_GLOBAL_NAME
   204-0-0/c STRC(72)    r     1 VM_MAIL_ACCT             174-0-0/c STRC(288)   r     1 VM_NAME_MAP_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   662-0-0/w PTR         r     1 @L#                      662-0-0/w PTR         r     1 @L#
     3-0-0/w PTR         r     1 @MAILBOX                 661-0-0/w PTR         r     1 @NAME#
   661-0-0/w PTR         r     1 @STRING#                   5-0-0/w PTR         r     1 @VM_ERR#
     4-0-0/w PTR         r     1 @VM_IAM#                 562-0-0/w PTR         r     1 ADD$
   664-0-0/w SBIN        r     1 DOT                      563-0-0/c CHAR(80)    r     1 FOLD_STRING
   522-0-0/d STRC(1080)  r     1 FPT_CLOSE                200-0-0/d STRC(2088)  r     1 FPT_OPEN
   272-0-0/d STRC(504)   r     1 FPT_READ                 320-0-0/c STRC(2304)        1 GLOBAL_KEY
   560-0-0/w SBIN        r     1 I                        663-0-0/w SBIN        r     1 I
   663-0-0/w SBIN        r     1 I                        561-0-0/w SBIN        r     1 J
   664-0-0/w SBIN        r     1 J                         *0-0-0/w SBIN        r     1 L#
    *0-0-0/w SBIN        r     1 L#                        *0-0-0/c CHAR(79)    r     1 MAILBOX
     6-0-0/c CHAR(79)    r     1 MAP_BOX                   *0-0-0/c CHAR(20)    r     1 NAME#
   420-0-0/c STRC(2304)  r     1 NAME_BUFFER              310-0-0/c STRC(288)   r     1 NAME_KEY
   665-0-0/c STRC(72)    r     1 OPEN_ACCT                667-0-0/c STRC(288)   r     1 OPEN_NAME
    *0-0-0/c ACHR        r     1 STRING#                  520-0-0/c STRC(72)    r     1 USER_ACCT
   607-0-0/w STRC        r     1 VM_BUFFER(0:39)
    *0-0-0/w SBIN        r     1 VM_ERR#                   *0-0-0/c CHAR(8)     r     1 VM_IAM#
   115-0-0/c STRC(1818)  r     1 VM_LISTKEY                32-0-0/c STRC(1818)  r     1 VM_USERKEY

  ****  SYMREF variables  ****
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:317  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$SR_NON_BLANK$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(4608)  r     1 B$SR_NON_BLANK
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DUMMY
     0-0-0N  NULL        r     1 M$GLOBAL                   0-0-0N  NULL        r     1 M$NAME
     0-0-0N  NULL        r     1 M$UC                       0-0-0/w STRC(711)   r     1 VM_RADDRESS


   Procedure VWM$GET_MAILBOX requires 650 words for executable code.
   Procedure VWM$GET_MAILBOX requires 450 words of local(AUTO) storage.

    No errors detected in file VWM$MOVE.:VMB6TSI    .
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:318  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:319  
          MINI XREF LISTING

ADD$
      9003**DCL      1322--IMP-PTR  9208<<ASSIGN   9209>>IF       9209>>IF       9211>>ASSIGN   9221<<ASSIGN
      9222>>IF       9222>>IF
B$JIT.ACCN
      1820**DCL      9132>>ASSIGN   9157>>ASSIGN   9323>>ASSIGN   9325>>ASSIGN   9328>>IF
B$JIT.CPFLAGS1.SLEAZE
      1914**DCL      1914--REDEF
B$JIT.ERR.MID
      1821**DCL      1821--REDEF
B$JIT.FACCN
      1820**DCL      9138>>ASSIGN   9159>>ASSIGN   9330>>ASSIGN
B$JIT.JRESPEAK
      1982**DCL      1983--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      2091**DCL      2091--REDEF    2092--REDEF
B$JIT.PNR
      1995**DCL      1995--REDEF
B$JIT.TSLINE
      2089**DCL      2090--REDEF
B$JIT.UNAME
      1820**DCL      9142>>ASSIGN
B$JIT$
      2096**DCL      1815--IMP-PTR  9132>>ASSIGN   9138>>ASSIGN   9142>>ASSIGN   9157>>ASSIGN   9159>>ASSIGN
      9323>>ASSIGN   9325>>ASSIGN   9328>>IF       9330>>ASSIGN
B$SR_NON_BLANK
      1490**DCL      9066>>CALLBLT  9202>>CALLBLT
B$SR_NON_BLANK$
      1489**DCL      1490--IMP-PTR  9066>>CALLBLT  9202>>CALLBLT
BAD_FOLDER
      9084**LABEL    9023--CALLALT  9032--CALLALT  9036--CALLALT  9049--CALLALT  9061--CALLALT  9069--CALLALT
      9073--CALLALT
BAD_OPEN
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:320  
      9087**LABEL    9014--CALLALT  9017--CALLALT
CLOSE_CONSTANT
      8980**DCL      9019>>ASSIGN
CLOSE_CONSTANT.SN_
      8980**DCL      8980--REDEF
CLOSE_CONSTANT.UTL_
      8981**DCL      8981--REDEF
CLOSE_CONSTANT.V
      8985**DCL      8980--DCLINIT
CLOSE_CONSTANT.V.EXPIRE#
      8995**DCL      8995--REDEF
CLOSE_CONSTANT.V.TYPE#
      8993**DCL      8993--REDEF
CLOSE_CONSTANT.V.XTNSIZE#
      8990**DCL      8990--REDEF    8992--REDEF
DOT IN PROCEDURE VERIFY_FOLDER
      9244**DCL      9297<<CALLBLT  9301>>IF       9303>>ASSIGN   9304>>ASSIGN   9312>>ASSIGN   9315>>CALLBLT
      9322>>IF       9324>>ASSIGN
EXIT_NAME_SERVER
      9079**LABEL    9025--GOTO     9106--GOTO     9112--GOTO
F$DCB.ACTPOS
      8230**DCL      8230--REDEF
F$DCB.ARS#
      8204**DCL      8204--REDEF    9175>>ASSIGN
F$DCB.ATTR
      8223**DCL      8224--REDEF
F$DCB.BORROW
      8238**DCL      8238--REDEF    8238--REDEF    8238--REDEF
F$DCB.DCBNAME.L
      8252**DCL      8252--IMP-SIZ
F$DCB.EOMCHAR#
      8208**DCL      8208--REDEF
F$DCB.FCD#
      8217**DCL      9013>>IF       9016>>IF
F$DCB.FLDID
      8233**DCL      8233--REDEF
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:321  
F$DCB.FORM$
      8227**DCL      8227--REDEF
F$DCB.FSECT
      8243**DCL      8243--REDEF
F$DCB.FSN#
      8220**DCL      8220--REDEF    8220--REDEF    8221--REDEF
F$DCB.HEADER$
      8226**DCL      8226--REDEF
F$DCB.IXTNSIZE#
      8224**DCL      8224--REDEF
F$DCB.LASTSTA$
      8213**DCL      8213--REDEF
F$DCB.LVL
      8239**DCL      8239--REDEF
F$DCB.NAME#.C
      8214**DCL      8214--REDEF
F$DCB.NOEOF
      8236**DCL      8236--REDEF
F$DCB.NRECS#
      8225**DCL      8225--REDEF
F$DCB.NRECX
      8244**DCL      8244--REDEF
F$DCB.OHDR
      8236**DCL      8236--REDEF
F$DCB.ORG#
      8219**DCL      8219--REDEF
F$DCB.PRECNO
      8242**DCL      8242--REDEF
F$DCB.RCSZ
      8248**DCL      8248--REDEF
F$DCB.RES#
      8215**DCL      8215--REDEF
F$DCB.SETX
      8227**DCL      8227--REDEF
F$DCB.TAB$
      8227**DCL      8227--REDEF
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:322  
F$DCB.TDA
      8241**DCL      8242--REDEF
F$DCB.WSN#
      8215**DCL      8215--REDEF
FOLD_STRING
      9004**DCL      9012<<ASSIGN   9042<<CALLBLT  9049<>CALL     9072<<CALLBLT  9073<>CALL
FPT_CLOSE
      8936**DCL      9019<<ASSIGN   9166<>CALL
FPT_CLOSE.SN_
      8936**DCL      8936--REDEF
FPT_CLOSE.UTL_
      8937**DCL      8937--REDEF
FPT_CLOSE.V
      8941**DCL      9020--ASSIGN
FPT_CLOSE.V.DCB#
      8942**DCL      9165<<ASSIGN
FPT_CLOSE.V.EXPIRE#
      8951**DCL      8951--REDEF
FPT_CLOSE.V.TYPE#
      8949**DCL      8949--REDEF
FPT_CLOSE.V.XTNSIZE#
      8946**DCL      8946--REDEF    8948--REDEF
FPT_CLOSE.V_
      8936**DCL      9020<<ASSIGN
FPT_OPEN
      8556**DCL      9152<<ASSIGN   9158<>CALL     9160<>CALL     9291<<ASSIGN   9327<>CALL     9331<>CALL
FPT_OPEN.ACCT_
      8560**DCL      9153<<ASSIGN   9294<<ASSIGN
FPT_OPEN.ACSVEH_
      8558**DCL      8559--REDEF
FPT_OPEN.ALTKEYS_
      8564**DCL      8565--REDEF    8565--REDEF
FPT_OPEN.HDR_
      8563**DCL      8564--REDEF
FPT_OPEN.NAME_
      8557**DCL      9293<<ASSIGN
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:323  
FPT_OPEN.TAB_
      8562**DCL      8563--REDEF
FPT_OPEN.UHL_
      8556**DCL      8557--REDEF    8557--REDEF
FPT_OPEN.V
      8565**DCL      9154--ASSIGN   9292--ASSIGN
FPT_OPEN.V.DCB#
      8565**DCL      9155<<ASSIGN   9295<<ASSIGN
FPT_OPEN.V.FSN#
      8596**DCL      8596--REDEF    8596--REDEF
FPT_OPEN.V_
      8556**DCL      9154<<ASSIGN   9292<<ASSIGN
FPT_OPEN.WSN_
      8562**DCL      8562--REDEF
FPT_READ
      8741**DCL      9127<<ASSIGN   9139<>CALL     9143<>CALL     9196<<ASSIGN   9207<>CALL     9218<>CALL
FPT_READ.BUF_
      8743**DCL      9130<<ASSIGN   9198<<ASSIGN
FPT_READ.KEY_
      8741**DCL      9129<<ASSIGN   9199<<ASSIGN
FPT_READ.STATION_
      8744**DCL      8745--REDEF
FPT_READ.V
      8745**DCL      9128--ASSIGN   9197--ASSIGN
FPT_READ.V.DVBYTE.REREAD#
      8756**DCL      8756--REDEF
FPT_READ.V.INDX#
      8754**DCL      8754--REDEF
FPT_READ.V_
      8741**DCL      9128<<ASSIGN   9197<<ASSIGN
GOT_A_NAME_MAP IN PROCEDURE MAP_ACCT_TO_REGISTERED_NAME
      9175**LABEL    9140--GOTO     9144--GOTO
I
      9001**DCL      9031<<CALLBLT  9059<<CALLBLT  9060>>IF       9066<<CALLBLT  9067>>ASSIGN   9072>>CALLBLT
      9073>>CALL     9105<<CALLBLT  9106>>IF       9107>>ASSIGN   9136<<DOINDEX  9138>>IF       9170<<CALLBLT
      9171>>ASSIGN
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:324  
I IN PROCEDURE LOCATE_REGISTERED_NAME
      9192**DCL      9202<<CALLBLT  9203>>ASSIGN   9217>>ASSIGN
I IN PROCEDURE VERIFY_FOLDER
      9243**DCL      9304<<ASSIGN   9306<<ASSIGN   9312<<ASSIGN   9316<<ASSIGN   9316>>ASSIGN   9318>>ASSIGN
      9321>>ASSIGN
J
      9002**DCL      9030<<CALLBLT  9032<>CALL     9040>>IF       9042>>CALLBLT  9044>>ASSIGN   9045>>ASSIGN
      9046<<ASSIGN   9046>>ASSIGN   9048>>CALLBLT  9049<>CALL     9051>>ASSIGN   9058<<CALLBLT  9060>>IF
      9061<>CALL     9066<<CALLBLT  9067<<CALLBLT  9067<<ASSIGN   9069<>CALL     9072>>CALLBLT  9072>>CALLBLT
      9073>>CALL     9104<<CALLBLT  9107<<ASSIGN   9107>>ASSIGN   9109>>CALLBLT
J IN PROCEDURE LOCATE_REGISTERED_NAME
      9193**DCL      9202<<CALLBLT
L# IN PROCEDURE LOCATE_REGISTERED_NAME
      9191**DCL      9180--PROC     9201>>ASSIGN
L# IN PROCEDURE VERIFY_FOLDER
      9242**DCL      9227--PROC     9241--IMP-SIZ  9297>>CALLBLT  9298>>IF       9303>>ASSIGN   9313>>IF
      9315>>CALLBLT  9318>>ASSIGN   9322>>IF       9324>>ASSIGN
LEAVE_AS_IS
      9090**LABEL    9033--GOTO     9062--GOTO
LOCATE_REGISTERED_NAME
      9180**PROC     9069--CALL
M$CLOSE
      8125**DCL-ENT  9166--CALL
M$DUMMY
        16**DCL      9155>>ASSIGN   9165>>ASSIGN   9295>>ASSIGN
M$GLOBAL
        15**DCL      9013--IF
M$NAME
        14**DCL      9016--IF       9175--ASSIGN
M$OPEN
      8125**DCL-ENT  9014--CALL     9017--CALL     9158--CALL     9160--CALL     9327--CALL     9331--CALL
M$READ
      8126**DCL-ENT  9139--CALL     9143--CALL     9207--CALL     9218--CALL
MAILBOX
         9**DCL         7--PROC     9011>>ASSIGN   9079<<ASSIGN   9093--ENTRY    9095>>ASSIGN
MAP_ACCT_TO_REGISTERED_NAME
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:325  
      9115**PROC     9023--CALL     9036--CALL
MAP_BOX
        10**DCL      9011<<ASSIGN   9012>>ASSIGN   9022>>IF       9024<<ASSIGN   9028>>IF       9030>>CALLBLT
      9031>>CALLBLT  9032<>CALL     9042>>CALLBLT  9044>>ASSIGN   9045<<ASSIGN   9048<<CALLBLT  9051<<ASSIGN
      9058>>CALLBLT  9059>>CALLBLT  9060>>IF       9061<>CALL     9066>>CALLBLT  9067>>CALLBLT  9069<>CALL
      9072>>CALLBLT  9079>>ASSIGN   9095<<ASSIGN   9096>>IF       9098<<CALLBLT  9102>>IF       9104>>CALLBLT
      9105>>CALLBLT  9106>>IF       9109<<CALLBLT
NAME# IN PROCEDURE LOCATE_REGISTERED_NAME
      9190**DCL      9180--PROC     9201>>ASSIGN
NAME_BUFFER.L#
      8894**DCL      9024>>ASSIGN   9040>>IF       9044>>ASSIGN   9045>>ASSIGN   9051>>ASSIGN   9168<<ASSIGN
      9171<<ASSIGN   9175<<ASSIGN
NAME_BUFFER.NAME#
      8894**DCL      9024>>ASSIGN   9038>>IF       9044<<ASSIGN   9045>>ASSIGN   9051>>ASSIGN   9130--ASSIGN
      9169<<CALLBLT  9170>>CALLBLT
NAME_KEY
      8834**DCL      9129--ASSIGN
NAME_KEY.L#
      8834**DCL      9133<<ASSIGN
NAME_KEY.NAME#
      8834**DCL      9042>>CALLBLT  9070>>IF       9072>>CALLBLT  9132<<ASSIGN   9138<<ASSIGN   9142<<ASSIGN
      9211<<ASSIGN   9215<<ASSIGN
OKAY IN PROCEDURE VERIFY_FOLDER
      9337**LABEL    9327--GOTO     9331--GOTO
OPEN_ACCT IN PROCEDURE VERIFY_FOLDER
      9258**DCL      9294--ASSIGN
OPEN_ACCT.ACCT# IN PROCEDURE VERIFY_FOLDER
      9258**DCL      9323<<ASSIGN   9324<<ASSIGN   9325>>IF       9325<<ASSIGN   9328>>IF       9330<<ASSIGN
OPEN_GLOBAL
      8445**DCL      9014<>CALL     9152>>ASSIGN   9291>>ASSIGN
OPEN_GLOBAL.ACSVEH_
      8447**DCL      8448--REDEF
OPEN_GLOBAL.ALTKEYS_
      8453**DCL      8454--REDEF    8454--REDEF
OPEN_GLOBAL.HDR_
      8452**DCL      8453--REDEF
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:326  
OPEN_GLOBAL.TAB_
      8451**DCL      8452--REDEF
OPEN_GLOBAL.UHL_
      8445**DCL      8446--REDEF    8446--REDEF
OPEN_GLOBAL.V
      8454**DCL      8445--DCLINIT
OPEN_GLOBAL.V.FSN#
      8485**DCL      8485--REDEF    8485--REDEF
OPEN_GLOBAL.WSN_
      8451**DCL      8451--REDEF
OPEN_NAME
      8327**DCL      9017<>CALL
OPEN_NAME.ACSVEH_
      8329**DCL      8330--REDEF
OPEN_NAME.ALTKEYS_
      8335**DCL      8336--REDEF    8336--REDEF
OPEN_NAME.HDR_
      8334**DCL      8335--REDEF
OPEN_NAME.TAB_
      8333**DCL      8334--REDEF
OPEN_NAME.UHL_
      8327**DCL      8328--REDEF    8328--REDEF
OPEN_NAME.V
      8336**DCL      8327--DCLINIT
OPEN_NAME.V.FSN#
      8367**DCL      8367--REDEF    8367--REDEF
OPEN_NAME.WSN_
      8333**DCL      8333--REDEF
OPEN_NAME IN PROCEDURE VERIFY_FOLDER
      9288**DCL      9293--ASSIGN
OPEN_NAME.L# IN PROCEDURE VERIFY_FOLDER
      9288**DCL      9321<<ASSIGN
OPEN_NAME.NAME# IN PROCEDURE VERIFY_FOLDER
      9288**DCL      9300<<ASSIGN   9303<<ASSIGN   9315<<CALLBLT  9318<<ASSIGN
READ_GLOBAL
      8784**DCL      9196>>ASSIGN
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:327  
READ_GLOBAL.STATION_
      8787**DCL      8788--REDEF
READ_GLOBAL.V
      8788**DCL      8784--DCLINIT
READ_GLOBAL.V.DVBYTE.REREAD#
      8799**DCL      8799--REDEF
READ_GLOBAL.V.INDX#
      8797**DCL      8797--REDEF
READ_NAME
      8700**DCL      9127>>ASSIGN
READ_NAME.STATION_
      8703**DCL      8704--REDEF
READ_NAME.V
      8704**DCL      8700--DCLINIT
READ_NAME.V.DVBYTE.REREAD#
      8715**DCL      8715--REDEF
READ_NAME.V.INDX#
      8713**DCL      8713--REDEF
STRING# IN PROCEDURE VERIFY_FOLDER
      9241**DCL      9227--PROC     9297>>CALLBLT  9298>>IF       9303>>ASSIGN   9313>>IF       9315>>CALLBLT
      9318>>ASSIGN   9324>>ASSIGN
USER_ACCT
      8909**DCL      9153--ASSIGN
USER_ACCT.ACCT#
      8909**DCL      9048>>CALLBLT  9157<<ASSIGN   9159<<ASSIGN   9169>>CALLBLT
VERIFY_FOLDER
      9227**PROC     9032--CALL     9049--CALL     9061--CALL     9073--CALL
VM_BUFFER
      9006**DCL      9198--ASSIGN   9208--ASSIGN   9221--ASSIGN
VM_BUFFER.UPPER
      9007**DCL      9208>>ASSIGN   9221>>ASSIGN
VM_ERR#
        12**DCL         7--PROC     9093--ENTRY
VM_GLOBAL_NAME
      8629**DCL      8446--DCLINIT
VM_IAM#
PL6.E3A0      #002=VWM$GET_MAILBOX File=VWM$MOVE.:VMB6TSI                        WED 08/20/97 15:44 Page:328  
        11**DCL         7--PROC     9093--ENTRY    9098>>CALLBLT  9109>>CALLBLT  9209>>IF       9222>>IF
VM_LISTKEY.COUNT
      1374**DCL      9217<<ASSIGN
VM_LISTKEY.TEXT
      1377**DCL      9216<<ASSIGN
VM_LISTKEY.TYPE
      1375**DCL      9205<<ASSIGN
VM_MAIL_ACCT
      8676**DCL      8332--DCLINIT  8450--DCLINIT
VM_NAME_MAP_NAME
      8660**DCL      8328--DCLINIT
VM_RADDRESS.ACCT
      1345**DCL      9211>>ASSIGN
VM_RADDRESS.FOLDER
      1337**DCL      1338--REDEF
VM_RADDRESS.SITENAME
      1344**DCL      9209>>IF       9209>>IF       9222>>IF       9222>>IF
VM_USERKEY
      1357**DCL      9199--ASSIGN
VM_USERKEY.COUNT
      1358**DCL      9203<<ASSIGN
VM_USERKEY.TEXT
      1361**DCL      9201<<ASSIGN   9202>>CALLBLT  9216>>ASSIGN
VM_USERKEY.TYPE
      1359**DCL      9204<<ASSIGN
