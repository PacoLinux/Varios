
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /****************************************************************/
        7        7        /*                                                              */
        8        8        /*    I-D-S/II  INTERFACE MODULE WITH APL/IDP USERS             */
        9        9        /*                                                              */
       10       10        /****************************************************************/
       11       11
       12       12        ZII$APL_IDP: PROC (A1,A2,A3) ALTRET AVOID($PR5,$PR6,$PR7);
       13       13
       14       14        %EQU PARAMETERS=20; /*  EVEN NUMBER PREFERED */
       15       15        %EQU PARAMETERS_TIMES_TWO=%PARAMETERS*2;
       16       16        %EQU PARAMETERS_TIMES_THREE=%PARAMETERS*3;
       17       17        %EQU PARAMS_PLUS_ONE=%PARAMETERS+1;
       18       18        %EQU RVA_TYPE_BITS=2;
       19       19
       20       20    1   DCL 1 A1 VECTOR;
       21       21    1   DCL 1 A2 VECTOR;
       22       22    1   DCL 1 A3 VECTOR;
       23       23        %EQU FPT_SIZE=10+%PARAMETERS_TIMES_TWO+10;
       24       24        %EQU RLCW_SIZE=1+%PARAMETERS/2;
       25       25        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:2    
       26       26        /*******************************************************************/
       27       27        /*                                                                 */
       28       28        /*      COMMON AREA WITH APL/IDP USERS TO PASS ARGUMENT LIST       */
       29       29        /*                                                                 */
       30       30        /*******************************************************************/
       31       31
       32       32    1   DCL ZII$INTEGER1 SBIN STATIC SYMDEF DALIGNED;
       33       33    1   DCL ZII$INTEGER2 SBIN STATIC SYMDEF DALIGNED;
       34       34    1   DCL ZII$CHARACTER30 CHAR(30) STATIC SYMDEF;
       35       35    1   DCL ZII$CHARACTER12 CHAR(12) STATIC SYMDEF;
       36       36    1   DCL 1 ZII$PARAMS(0:%PARAMS_PLUS_ONE) STATIC SYMDEF,
       37       37    1         2 OFFSET UBIN HALF UNAL,
       38       38    1         2 KEYWORD UBIN HALF UNAL;
       39       39    1   DCL 1 PARAMS(0:%PARAMS_PLUS_ONE) REDEF ZII$PARAMS SBIN;
       40       40        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:3    
       41       41        /******************************************************************/
       42       42        /*                                                                */
       43       43        /*    WORKING SPACE FOR INTERFACE MODULE (STATIC FOR EFFICICENT)  */
       44       44        /*                                                                */
       45       45        /******************************************************************/
       46       46
       47       47    1   DCL IA$ STATIC PTR;
       48       48    1   DCL UWA$ STATIC PTR;
       49       49    1   DCL RVA$ STATIC PTR;
       50       50    1   DCL USEP$ STATIC PTR;
       51       51    1   DCL ARG$ STATIC PTR;
       52       52    1   DCL FPT$ STATIC PTR;
       53       53    1   DCL NBF_CRPT_TRON$ PTR CONSTANT INIT(ADDR(FPT_SHORT));
       54       54    1   DCL RLCW$ STATIC PTR;
       55       55    1   DCL TYPE$ STATIC PTR;
       56       56
       57       57    1   DCL I SBIN STATIC;
       58       58    1   DCL J SBIN STATIC;
       59       59    1   DCL K SBIN STATIC;
       60       60    1   DCL II SBIN STATIC;
       61       61    1   DCL JJ SBIN STATIC;
       62       62    1   DCL KK SBIN STATIC;
       63       63    1   DCL IDSSYSERR SBIN STATIC SYMDEF; /* STORE MONITOR ERR_CODE IA(5) */
       64       64    1   DCL NULL_OFFSET SBIN STATIC;
       65       65    1   DCL RVA_SIZE SBIN STATIC;
       66       66    1   DCL BIT72 BIT(72) BASED ALIGNED;
       67       67    1   DCL CHAR12 CHAR(12) BASED;
       68       68    1   DCL CHAR7 CHAR(7) BASED;
       69       69    1   DCL SBIN36 SBIN BASED;
       70       70    1   DCL KEY_COUNT SBIN STATIC INIT(0);
       71       71    1   DCL RETAIN_SWITCH SBIN STATIC INIT(0);
       72       72
       73       73    1   DCL RVA(0:0) SBIN BASED(RVA$);
       74       74    1   DCL RVA_HALF(0:0) SBIN HALF UNAL BASED(RVA$);
       75       75    1   DCL IA_HALF(0:0) SBIN HALF UNAL BASED(IA$);
       76       76    1   DCL UWA(0:0) SBIN BASED(UWA$);
       77       77
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:4    
       78       78    1   DCL 1 PAGE_VECTOR STATIC,
       79       79    1         2 * BIT(36),
       80       80    1         2 ADR PTR INIT(ADDR(NIL));
       81       81    1   DCL 1 FPT_SHORT STATIC DALIGNED,
       82       82    1         2 VEC1 BIT(72) INIT(VECTOR(ZII$INTEGER1)),
       83       83    1         2 VEC2 BIT(72) INIT(VECTOR(ZII$INTEGER2));
       84       84    1   DCL PTR$ PTR STATIC;
       85       85        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:5    
       86       86        /****************************************************************/
       87       87        /*                                                              */
       88       88        /*    INCLUDE ZI_DBCS FOR I-D-S/II FPTS AND ENTRIES DEFS        */
       89       89        /*                                                              */
       90       90        /****************************************************************/
       91       91
       92       92        %INCLUDE ZI_DBCS;
       93      705        %ASL;
       94      719        %IPT_ACC(STCLASS="BASED(FPT$)");
       95      732        %IPT_ACN(STCLASS="BASED(FPT$)");
       96      746        %IPT_CHK(ERROR=ZII$INTEGER2,CHKPT_NUMBER=ZII$INTEGER1);
       97      756        %IPT_CALC(STCLASS="BASED(FPT$)");
       98      768        %IPT_CON(STCLASS="BASED(FPT$)");
       99      781        %IPT_CRPT(STCLASS="BASED(NBF_CRPT_TRON$)");
      100      790        %IPT_DIS(STCLASS="BASED(FPT$)");
      101      803        %IPT_ERS(STCLASS="BASED(FPT$)");
      102      815        %IPT_ETC(STCLASS="BASED(FPT$)");
      103      828        %IPT_FAA(STCLASS="BASED(FPT$)");
      104      845        %IPT_FAS(STCLASS="BASED(FPT$)");
      105      862        %IPT_FCD(STCLASS="BASED(FPT$)");
      106      877        %IPT_FCR(STCLASS="BASED(FPT$)");
      107      891        %IPT_FCT(STCLASS="BASED(FPT$)");
      108      906        %IPT_FDC(STCLASS="BASED(FPT$)");
      109      921        %IPT_FDP(STCLASS="BASED(FPT$)");
      110      937        %IPT_FDR(STCLASS="BASED(FPT$)");
      111      953        %IPT_FIN(STCLASS="BASED(FPT$)");
      112      966        %IPT_FKC(STCLASS="BASED(FPT$)");
      113      983        %IPT_FKY(STCLASS="BASED(FPT$)");
      114     1000        %IPT_FOR(STCLASS="BASED(FPT$)");
      115     1015        %IPT_FRA(STCLASS="BASED(FPT$)");
      116     1032        %IPT_FRI(STCLASS="BASED(FPT$)");
      117     1049        %IPT_FRS(STCLASS="BASED(FPT$)");
      118     1066        %IPT_FUI(STCLASS="BASED(FPT$)");
      119     1082        %IPT_GET(STCLASS="BASED(FPT$)");
      120     1094        %IPT_GTF(STCLASS="BASED(FPT$)");
      121     1107        %IPT_HIA(STCLASS="BASED(FPT$)");
      122     1118        %IPT_IFM(STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:6    
      123     1130        %IPT_IFT(STCLASS="BASED(FPT$)");
      124     1142        %IPT_INA(STCLASS="BASED(FPT$)");
      125     1156        %IPT_IST(STCLASS="BASED(FPT$)");
      126     1169        %IPT_MOD(STCLASS="BASED(FPT$)");
      127     1185        %IPT_NBF(STCLASS="BASED(NBF_CRPT_TRON$)");
      128     1195        %IPT_KEEP(STCLASS=STATIC);
      129     1204        %IPT_REDUCEQ(STCLASS="BASED(NBF_CRPT_TRON$)");
      130     1213        %IPT_RDY(STCLASS="BASED(FPT$)");
      131     1227        %IPT_ROL(ERROR=ZII$INTEGER1);
      132     1236        %IPT_STO(STCLASS="BASED(FPT$)");
      133     1251        %IPT_TRON(STCLASS="BASED(NBF_CRPT_TRON$)");
      134     1260        %IPT_TROFF(STCLASS="BASED(NBF_CRPT_TRON$)");
      135     1269        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:7    
      136     1270        /*****************************************************************/
      137     1271        /*                                                               */
      138     1272        /*    INCLUDE KEY_WORDS DEFINITIONS IN ZI$DESC                   */
      139     1273        /*                                                               */
      140     1274        /*****************************************************************/
      141     1275
      142     1276        %INCLUDE ZI$DESC;
      143     2126        %EQU APL_IDP=1;
      144     2127        %KEYWD_VAL;
      145     2174        %EQU AREA_NAME=2;
      146     2175        %EQU SET_NAME=3;
      147     2176        %EQU RECORD_NAME=4;
      148     2177        %EQU FIELD_NAME=5;
      149     2178        %EQU ON=1;
      150     2179        %EQU OFF=0;
      151     2180    1   DCL IDS_NAMES(0:6) UBIN HALF UNAL CONSTANT
      152     2181    1    INIT(%GET,%MODIFY,%STORE,%ERASE,%CONNECT,%FIND,%DISCONNECT);
      153     2182    1   DCL IDS_BIT9(0:6) BIT(9) CONSTANT CALIGNED
      154     2183    1    INIT('400'O,'200'O,'100'O,'040'O,'020'O,'004'O,'010'O);
      155     2184
      156     2185        /*****************************************************************/
      157     2186        /*                                                               */
      158     2187        /*    INCLUDE CP_6_C TO HAVE MONITOR SERVICES                    */
      159     2188        /*                                                               */
      160     2189        /*****************************************************************/
      161     2190
      162     2191        %INCLUDE CP_6;
      163     2272        %FPT_GDP(PAGES=1,STCLASS=CONSTANT,RESULTS=PAGE_VECTOR);
      164     2286        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:8    
      165     2287        /*****************************************************************/
      166     2288        /*                                                               */
      167     2289        /*    DEFINE THE BASE STRUCTURE INTO DYNAMIC PAGES               */
      168     2290        /*                                                               */
      169     2291        /*****************************************************************/
      170     2292
      171     2293    1   DCL TYPE_OF_ARG(0:0) SBIN(9) UNAL BASED(ARG$);
      172     2294
      173     2295    1   DCL 1 FPT BASED(FPT$) DALIGNED,
      174     2296    1         2 V_ BIT(72),
      175     2297    1         2 IA_ BIT(72),
      176     2298    1         2 UWA_ BIT(72),
      177     2299    1         2 RVA_ BIT(72),
      178     2300    1         2 USEP_ BIT(72),
      179     2301    1         2 V,
      180     2302    1           3 *(0:8) UBIN,
      181     2303    1           3 FPARA(0:%PARAMETERS_TIMES_TWO) UBIN;
      182     2304
      183     2305    1   DCL 1 RLCW_SAVE BASED(RLCW$),
      184     2306    1         2 * UBIN HALF UNAL,
      185     2307    1         2 AC_INDICATORS BIT(1) UNAL,
      186     2308    1         2 SC_INDICATORS BIT(1) UNAL,
      187     2309    1         2 RC_INDICATORS BIT(1) UNAL,
      188     2310    1         2 * BIT(7) UNAL,
      189     2311    1         2 N_SETS# UBIN(8) UNAL,
      190     2312    1         2 RETAIN_LIST(0:%PARAMETERS) UBIN HALF UNAL;
      191     2313
      192     2314    1   DCL KEY_SAVE(0:0) CHAR(12) BASED(FPT$) ALIGNED;
      193     2315
      194     2316    1   DCL 1 USEP BASED(USEP$) DALIGNED, /* MUST BE DALIGNED */
      195     2317    1         2 FLAG BIT(1) UNAL,
      196     2318    1         2 M UBIN(17) UNAL,
      197     2319    1         2 * UBIN HALF UNAL,
      198     2320    1         2 UC(0:200),
      199     2321    1           3 UCW_USE,
      200     2322    1             4 PT UBIN(9) UNAL,
      201     2323    1             4 STATUS_CODE UBIN(27) UNAL,
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:9    
      202     2324    1           3 UCW_PRV REDEF UCW_USE,
      203     2325    1             4 PT UBIN(9) UNAL,
      204     2326    1             4 PB BIT(9) UNAL,
      205     2327    1             4 A UBIN HALF UNAL,
      206     2328    1           3 ENT UBIN HALF UNAL,
      207     2329    1           3 MBZ UBIN HALF UNAL;
      208     2330
      209     2331    1   DCL RVA_TYPE(0:0) UBIN(%RVA_TYPE_BITS) UNAL BASED(TYPE$);
      210     2332         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:10   
      211     2333        /******************************************************************/
      212     2334        /*                                                                */
      213     2335        /*     EVERY CALL GOES HERE FIRST TO SETUP A ARRAY OF ARG_TYPE    */
      214     2336        /*                                                                */
      215     2337        /******************************************************************/
      216     2338    1   SET_ARGS: PROC;
      217     2339
      218     2340    3       DO I=1 TO PARAMS(0);
      219     2341    3           IF ZII$PARAMS.OFFSET(I)=0 THEN
      220     2342    3               TYPE_OF_ARG(I)=PARAMS(I);
      221     2343    3           ELSE
      222     2344    3               TYPE_OF_ARG(I)=RVA_TYPE(ZII$PARAMS.OFFSET(I))+%AREA_NAME;
      223     2345    3           END;
      224     2346    2   END SET_ARGS;
      225     2347        /****************************************************************/
      226     2348        /*                                                              */
      227     2349        /*    GET A PAGE OF DYNAMIC MEMORY AT THE VERY 1ST IDS CALL     */
      228     2350        /*                                                              */
      229     2351        /****************************************************************/
      230     2352    1   GET_A_PAGE: PROC ALTRET;
      231     2353
      232     2354    2       CALL M$GDP(FPT_GDP) ALTRET(OUT_OF_MEMORY);
      233     2355    2       FPT$=PAGE_VECTOR.ADR;
      234     2356    2       ARG$=ADDR(FPT.V.FPARA(0));
      235     2357    2       RLCW$=PINCRW(FPT$,%FPT_SIZE);
      236     2358    2       TYPE$=PINCRW(RLCW$,%RLCW_SIZE);
      237     2359    2       RETURN;
      238     2360    2   OUT_OF_MEMORY: ALTRETURN;
      239     2361    2   END GET_A_PAGE;
      240     2362         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:11   
      241     2363        /**************************************************************/
      242     2364        /*                                                            */
      243     2365        /*    CALL INVOKE(IA,UWA,RVA)                                 */
      244     2366        /*                                                            */
      245     2367        /*    1. REMEMBER UWA$ AND RVA$.  2.  DO A CLIMB TO 'HIA'     */
      246     2368        /*                                                            */
      247     2369        /**************************************************************/
      248     2370
      249     2371    1   ZII$INVOKE: ENTRY(A1,A2,A3) ALTRET;
      250     2372
      251     2373    1       IA$ = VBASE(A1);
      252     2374    1       UWA$ = VBASE(A2);
      253     2375    1       RVA$ = VBASE(A3);
      254     2376    1       IF RVA_HALF(0)>0 THEN /* FIRST INVOKE CALL */
      255     2377    2       DO;
      256     2378    2           IF PAGE_VECTOR.ADR=ADDR(NIL) THEN
      257     2379    2               CALL GET_A_PAGE ALTRET(OUT_OF_MEMORY);
      258     2380    2           RVA_SIZE=RVA_HALF(0);
      259     2381    3           DO I=1 TO RVA_SIZE; /* REMEMBER ALL TYPES */
      260     2382    3               RVA_TYPE(I)=RVA_HALF(2*I);
      261     2383    3               IF RVA_HALF(2*I)=4 THEN NULL_OFFSET=I;
      262     2384    3               END;
      263     2385    2           FPT.V_=VECTOR(FPT.V);
      264     2386    2           FPT.IA_=A1;
      265     2387    2           FPT.UWA_=A2;
      266     2388    2           FPT.RVA_=A3;
      267     2389    2           IPT_CHK.IA_=A1;
      268     2390    2           IPT_ROL.IA_=A1;
      269     2391    2           IPT_CHK.ERROR_=VECTOR(PINCRC(UWA$,1)->CHAR7);
      270     2392    2           IPT_ROL.ERROR_=IPT_CHK.ERROR_;
      271     2393    2           I=%FPT_SIZE+%RLCW_SIZE+RVA_SIZE/(36/%RVA_TYPE_BITS)+1;
      272     2394    2           IF MOD(I,2)=0 THEN
      273     2395    2               USEP$=PINCRW(FPT$,I);
      274     2396    2           ELSE /* TO MAKE SURE USEP$ IS DALIGNED */
      275     2397    2               USEP$=PINCRW(FPT$,I);
      276     2398    2           FPT.USEP_=VECTOR(USEP);
      277     2399    2           USEP.FLAG='0'B;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:12   
      278     2400    2           USEP.M=0;
      279     2401    2           KEY_COUNT=1024/3;
      280     2402    2           END;
      281     2403            %CLIMB(FCN=HIA);
      282     2417    1       GOTO COMMON_RETURN;
      283     2418
      284     2419    1   OUT_OF_MEMORY: ALTRETURN;
      285     2420        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:13   
      286     2421        /****************************************************************/
      287     2422        /*                                                              */
      288     2423        /*    CALL RETAIN( AREA                               )         */
      289     2424        /*                 SETS                                         */
      290     2425        /*                 RECORD                                       */
      291     2426        /*                 SET-NAME1,SET-NAME2,.....                    */
      292     2427        /*                                                              */
      293     2428        /*         1.  SAVE RETAINING CONTROL LIST.                     */
      294     2429        /*         2.  SET SWITCH ON, RETAINING LIST WILL BE USED ON    */
      295     2430        /*             NEXT IDS CALL WITH RETAIN CURRENCY OPTION        */
      296     2431        /*                                                              */
      297     2432        /****************************************************************/
      298     2433
      299     2434    1   ZII$RETAIN: ENTRY ALTRET;
      300     2435
      301     2436    1       CALL SET_ARGS;
      302     2437    1       ADDR(RLCW_SAVE)->SBIN36=0;
      303     2438    1       IF PARAMS(1)=%CURRENCY AND PARAMS(2)=%FOR THEN
      304     2439    1           K=3;
      305     2440    1       ELSE
      306     2441    1           IF PARAMS(1)=%CURRENCY THEN
      307     2442    1               K=2;
      308     2443    1           ELSE
      309     2444    1               K=1;
      310     2445    2       DO WHILE (K<=PARAMS(0));
      311     2446    2           IF TYPE_OF_ARG(K)=%SET_NAME THEN
      312     2447    3           DO;
      313     2448    3               RLCW_SAVE.RETAIN_LIST(RLCW_SAVE.N_SETS#)=ZII$PARAMS.OFFSET(K);
      314     2449    3               RLCW_SAVE.N_SETS#=RLCW_SAVE.N_SETS#+1;
      315     2450    3               END;
      316     2451    2           ELSE
      317     2452    2               IF TYPE_OF_ARG(K)=%REALM THEN
      318     2453    2                   RLCW_SAVE.AC_INDICATORS='1'B;
      319     2454    2               ELSE
      320     2455    2                   IF TYPE_OF_ARG(K)=%SETS THEN
      321     2456    2                       RLCW_SAVE.SC_INDICATORS='1'B;
      322     2457    2                   ELSE
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:14   
      323     2458    2                       IF TYPE_OF_ARG(K)=%RECORD THEN
      324     2459    2                           RLCW_SAVE.RC_INDICATORS='1'B;
      325     2460    2                       ELSE
      326     2461    2                           ALTRETURN;
      327     2462    2           K=K+1;
      328     2463    2           END;
      329     2464    1       RETAIN_SWITCH=%ON;
      330     2465    1       RETURN;
      331     2466
      332     2467        /**   INTERNAL SUBROUTINE TO SETUP RETAIN CONTROL LIST   **/
      333     2468
      334     2469    1   CHK_RETAIN: PROC(RLCW,N);
      335     2470
      336     2471    2   DCL 1 RLCW,
      337     2472    2         2 FLAGS SBIN WORD,
      338     2473    2         2 RETAIN_LIST (0:0),
      339     2474    2           3 OFFSET UBIN HALF UNAL,
      340     2475    2           3 * UBIN HALF UNAL;
      341     2476    2   DCL N UBIN HALF UNAL;
      342     2477
      343     2478    2       IF RETAIN_SWITCH=%OFF THEN
      344     2479    2           RLCW.FLAGS=0;
      345     2480    2       ELSE
      346     2481    3       DO;
      347     2482    3           RETAIN_SWITCH=%OFF;
      348     2483    3           RLCW.FLAGS=ADDR(RLCW_SAVE)->SBIN36;
      349     2484    4           DO J=N TO RLCW_SAVE.N_SETS#+N-1;
      350     2485    4               RLCW.RETAIN_LIST.OFFSET(J)=RLCW_SAVE.RETAIN_LIST(J-N);
      351     2486    4               END;
      352     2487    3           END;
      353     2488    2   END CHK_RETAIN;
      354     2489         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:15   
      355     2490        /**************************************************************/
      356     2491        /*                                                            */
      357     2492        /*    CALL READY([AREA-1[,AREA-2[,....]],FUN-OPT,[MODE-OPT])  */
      358     2493        /*                                                            */
      359     2494        /*    FUN-OPT: LOAD, UPDATE, OR RETRIEVAL                     */
      360     2495        /*    MODE-OPT: SHAREALL,NOSHARE, SHAREANY, OR SHAREIN.          */
      361     2496        /*                                                            */
      362     2497        /**************************************************************/
      363     2498
      364     2499    1   ZII$READY: ENTRY ALTRET;
      365     2500
      366     2501    1       CALL SET_ARGS;
      367     2502    1       J=2;
      368     2503    1       I=PARAMS(PARAMS(0));
      369     2504    1       IF I=%NOSHARE THEN
      370     2505                %CLIMB(FCN=SHNO,PARAMS=0);
      371     2519    1       ELSE
      372     2520    1           IF I=%SHAREALL THEN
      373     2521                    %CLIMB(FCN=SHALL,PARAMS=0);
      374     2535    1           ELSE
      375     2536    1               IF I=%SHAREIN THEN
      376     2537                        %CLIMB(FCN=SHIN,PARAMS=0);
      377     2551    1               ELSE
      378     2552    1                   IF I=%SHAREANY THEN
      379     2553                            %CLIMB(FCN=SHANY,PARAMS=0);
      380     2567    1                   ELSE
      381     2568    1                       IF I=%SHARECUR THEN
      382     2569                                %CLIMB(FCN=SHCUR,PARAMS=0);
      383     2583    1                       ELSE
      384     2584    1                           IF I=%SHAREINCUR THEN
      385     2585                                    %CLIMB(FCN=SHINCUR,PARAMS=0);
      386     2599    1                           ELSE
      387     2600    1                               J=1;
      388     2601
      389     2602    1       ADDR(IPT_RDY.V.RDCW)->SBIN36=0;
      390     2603    1       I=PARAMS(PARAMS(0)-J+1);
      391     2604
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:16   
      392     2605    1       IF I=%UPDATE THEN
      393     2606    1           IPT_RDY.V.RDCW.READY_OPTION#='010'B;
      394     2607    1       ELSE
      395     2608    1           IF I=%RETRIEVAL THEN
      396     2609    1               IPT_RDY.V.RDCW.READY_OPTION#='100'B;
      397     2610    1           ELSE
      398     2611    1               IF I=%LOAD THEN
      399     2612    1                   IPT_RDY.V.RDCW.READY_OPTION#='001'B;
      400     2613    1               ELSE
      401     2614    2               DO;
      402     2615    2                   IPT_RDY.V.RDCW.READY_OPTION#='100'B;
      403     2616    2                   J=0; /* DEFAULT IS RETRIEVAL IS NO MODE GIVEN */
      404     2617    2                   END;
      405     2618
      406     2619    1       J=PARAMS(0)-J;
      407     2620    1       IF J > 0 AND TYPE_OF_ARG(J)=%IS THEN J=J-1;
      408     2621    1       IF J > 0 AND TYPE_OF_ARG(J)=%USAGE THEN J=J-1;
      409     2622    2       DO I=1 TO J;
      410     2623    2           IF TYPE_OF_ARG(I)~=%AREA_NAME THEN ALTRETURN;
      411     2624    2           IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#(I-1)=ZII$PARAMS.OFFSET(I);
      412     2625    2           END;
      413     2626    1       IPT_RDY.V.RDCW.AREAS_TO_READY#=J;
      414     2627
      415     2628    1       IPT_RDY.V_ = VECTOR(IPT_RDY.V);
      416     2629    1       VBOUND(IPT_RDY.V_) = VBOUND(IPT_RDY.V_) + SIZEC(IPT_RDY.V.AC_OFFSETS) * I;
      417     2630            %CLIMB(FCN=RDY);
      418     2644
      419     2645    1       RETAIN_SWITCH=%OFF; /* RESET RETAIN CONTROL FLAG */
      420     2646    2       DO WHILE (IA_HALF(15)>0); /* IF PRIVACY KEY REQUESTED */
      421     2647    2           ADDR(UWA(27))->CHAR12=KEY_SAVE(IA_HALF(14));
      422     2648    2           IPT_ETC.V_ = VECTOR(IPT_ETC.V);
      423     2649                %CLIMB(FCN=ETC);
      424     2663    2           END;
      425     2664    1       GOTO COMMON_RETURN;
      426     2665         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:17   
      427     2666        /**************************************************************/
      428     2667        /*                                                            */
      429     2668        /*    CALL FINISH([AREA-1,[AREA-2,....,],])                   */
      430     2669        /*                                                            */
      431     2670        /**************************************************************/
      432     2671    1   ZII$FINISH: ENTRY ALTRET;
      433     2672
      434     2673    1       CALL SET_ARGS;
      435     2674    2       DO I=1 TO PARAMS(0);
      436     2675    2           IF TYPE_OF_ARG(I)~=%AREA_NAME THEN ALTRETURN;
      437     2676    2           IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#(I-1)=ZII$PARAMS.OFFSET(I);
      438     2677    2           END;
      439     2678    1       IPT_FIN.V_ = VECTOR(IPT_FIN.V);
      440     2679    1       VBOUND(IPT_FIN.V_) = VBOUND(IPT_FIN.V_) + SIZEC(IPT_FIN.V.AC_OFFSETS) * I;
      441     2680    1       IPT_FIN.V.ALCW.N_AREAS#=PARAMS(0);
      442     2681            %CLIMB(FCN=FIN);
      443     2695    1       GOTO COMMON_RETURN;
      444     2696
      445     2697    1   ZII$CALC: ENTRY ALTRET;
      446     2698
      447     2699    1       CALL SET_ARGS;
      448     2700    1       IF PARAMS(0)~=2 OR TYPE_OF_ARG(1)~=%RECORD_NAME THEN ALTRETURN;
      449     2701    1       IPT_CALC.V_=VECTOR(IPT_CALC.V);
      450     2702    1       IPT_CALC.DBK_=VECTOR(ZII$INTEGER1);
      451     2703    1       IPT_CALC.V.UWA_OFFSET=RVA_HALF(ZII$PARAMS.OFFSET(1)*2+1)/8;
      452     2704            %CLIMB(FCN=CALC);
      453     2718    1       IPT_CALC.V_=VECTOR(FPT.V);
      454     2719    1       GOTO COMMON_RETURN;
      455     2720         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:18   
      456     2721    1   ZII$ACCEPT: ENTRY ALTRET;
      457     2722
      458     2723    1       CALL SET_ARGS;
      459     2724    1       IF TYPE_OF_ARG(2)=%FROM THEN
      460     2725    1           I=3; /* KEYWORD FROM IS OPTIONAL */
      461     2726    1       ELSE I=2;
      462     2727        /*****************************************************************/
      463     2728        /*                                                               */
      464     2729        /*    CALL ACCEPT(IDENT-1[,FROM][,REC-NAME],AREANAME)            */
      465     2730        /*                                SET-NAME                       */
      466     2731        /*                                IDENT-2                        */
      467     2732        /*         IDENT-1: LOCATION TO RECEIVE THE AREA'S TEXT NAME     */
      468     2733        /*         IDENT-2: LOCATION CONTAINS A DBKEY TO IDENT THE AREA  */
      469     2734        /*                                                               */
      470     2735        /*****************************************************************/
      471     2736    1       J=PARAMS(0); /* GET THE INDEX OF LAST PARAM */
      472     2737    1       IF TYPE_OF_ARG(J)=%REALMNAME THEN
      473     2738    2       DO;
      474     2739    2           IPT_ACN.DBK_=VECTOR(ZII$INTEGER1);
      475     2740    2           IPT_ACN.ANAME_=VECTOR(ZII$CHARACTER30);
      476     2741    2           IPT_ACN.V.RVA_ITEM.OFFSET#=ZII$PARAMS.OFFSET(I);
      477     2742    2           IF TYPE_OF_ARG(I)=%RECORD_NAME THEN
      478     2743    2               IPT_ACN.V.NCW.CI#=1;
      479     2744    2           ELSE
      480     2745    2               IF TYPE_OF_ARG(I)=%SET_NAME THEN
      481     2746    2                   IPT_ACN.V.NCW.CI#=3;
      482     2747    2               ELSE
      483     2748    3               DO;
      484     2749    3                   IPT_ACN.V.RVA_ITEM.OFFSET#=NULL_OFFSET;
      485     2750    3                   IF TYPE_OF_ARG(I)=%REALMNAME THEN
      486     2751    3                       IPT_ACN.V.NCW.CI#=2;
      487     2752    3                   ELSE
      488     2753    3                       IF TYPE_OF_ARG(I)=%APL_IDP THEN
      489     2754    3                           IPT_ACN.V.NCW.CI#=0;
      490     2755    3                       ELSE
      491     2756    3                           ALTRETURN;
      492     2757    3                   END;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:19   
      493     2758    2           IPT_ACN.V.NCW.AREA_NME_SIZE#=30;
      494     2759    2           IPT_ACN.V_=VECTOR(IPT_ACN.V);
      495     2760                %CLIMB(FCN=ACN);
      496     2774    2           END;
      497     2775    1       ELSE
      498     2776         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:20   
      499     2777        /****************************************************************/
      500     2778        /*                                                              */
      501     2779        /*      CALL ACCEPT(IDENTIFIER[,FROM][,REC-NAME],CURRENCY)      */
      502     2780        /*                                     SET-NAME NEXT            */
      503     2781        /*                                     AREA-NAME PRIOR          */
      504     2782        /*                                      OWNER                   */
      505     2783        /*                                                              */
      506     2784        /****************************************************************/
      507     2785    2       DO;
      508     2786    2           IPT_ACC.DBK_=VECTOR(ZII$INTEGER1);
      509     2787    2           IPT_ACC.V.RVA_ITEM.OFFSET#=ZII$PARAMS.OFFSET(I);
      510     2788    2           IF TYPE_OF_ARG(J)=%CURRENCY THEN
      511     2789    3           DO;
      512     2790    3               IF TYPE_OF_ARG(I)=%RECORD_NAME THEN
      513     2791    3                   IPT_ACC.V.CCW.SCI#=1;
      514     2792    3               ELSE
      515     2793    3                   IF TYPE_OF_ARG(I)=%AREA_NAME THEN
      516     2794    3                       IPT_ACC.V.CCW.SCI#=2;
      517     2795    3                   ELSE
      518     2796    3                       IF TYPE_OF_ARG(I)=%SET_NAME THEN
      519     2797    3                           IPT_ACC.V.CCW.SCI#=3;
      520     2798    3                       ELSE
      521     2799    3                           IF PARAMS(0)=I THEN
      522     2800    4                           DO;
      523     2801    4                               IPT_ACC.V.CCW.SCI#=0;
      524     2802    4                               IPT_ACC.V.RVA_ITEM.OFFSET#=NULL_OFFSET;
      525     2803    4                               END;
      526     2804    3                           ELSE
      527     2805    3                               ALTRETURN;
      528     2806    3               END;
      529     2807    2           ELSE
      530     2808    3           DO;
      531     2809    3               IF TYPE_OF_ARG(I)~=%SET_NAME THEN ALTRETURN;
      532     2810    3               IF TYPE_OF_ARG(J)=%NEXT THEN
      533     2811    3                   IPT_ACC.V.CCW.SCI#=4;
      534     2812    3               ELSE
      535     2813    3                   IF TYPE_OF_ARG(J)=%PRIOR THEN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:21   
      536     2814    3                       IPT_ACC.V.CCW.SCI#=5;
      537     2815    3                   ELSE
      538     2816    3                       IF TYPE_OF_ARG(J)=%OWNER THEN
      539     2817    3                           IPT_ACC.V.CCW.SCI#=6;
      540     2818    3                       ELSE
      541     2819    3                           ALTRETURN;
      542     2820    3               END;
      543     2821    2           IPT_ACC.V_=VECTOR(IPT_ACC.V);
      544     2822                %CLIMB(FCN=ACC);
      545     2836    2           END;
      546     2837    1       FPT.V_=VECTOR(FPT.V);
      547     2838    1       GOTO COMMON_RETURN;
      548     2839         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:22   
      549     2840    1   ZII$STORE: ENTRY ALTRET;
      550     2841
      551     2842    1       CALL SET_ARGS;
      552     2843    1       IF PARAMS(0)~=1 OR TYPE_OF_ARG(1)~=%RECORD_NAME THEN ALTRETURN;
      553     2844    1       IPT_STO.V_ = VECTOR(IPT_STO.V);
      554     2845    1       IPT_STO.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
      555     2846    1       CALL CHK_RETAIN(IPT_STO.V.RLCW,0);
      556     2847            %CLIMB(FCN=STO);
      557     2861    1       GOTO COMMON_RETURN;
      558     2862
      559     2863
      560     2864    1   ZII$ERASER: ENTRY ALTRET;
      561     2865
      562     2866    1       CALL SET_ARGS;
      563     2867    1       IPT_ERS.V.RC.RC_OFFSET#=NULL_OFFSET;
      564     2868    1       ADDR(IPT_ERS.V.ECW)->SBIN36=0;
      565     2869    1       IF PARAMS(0)>0 THEN
      566     2870    2       DO;
      567     2871    2           IF TYPE_OF_ARG(1)=%RECORD_NAME THEN
      568     2872    2               IPT_ERS.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
      569     2873    2           ELSE IF TYPE_OF_ARG(1)=%ALL THEN
      570     2874    2                   IPT_ERS.V.ECW.EC_BIT#='1'B;
      571     2875    2               ELSE
      572     2876    2                   ALTRETURN;
      573     2877    2           IF PARAMS(0)>=2 AND PARAMS(2)=%ALL THEN
      574     2878    2               IPT_ERS.V.ECW.EC_BIT#='1'B;
      575     2879    2           ELSE
      576     2880    2               IF PARAMS(0)>2 THEN ALTRETURN;
      577     2881    2           END;
      578     2882    1       IPT_ERS.V_ = VECTOR(IPT_ERS.V);
      579     2883            %CLIMB(FCN=ERS);
      580     2897    1       GOTO COMMON_RETURN;
      581     2898         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:23   
      582     2899        /**   COMMON CALLING SEQUENCES FOR 'CALL FIND(DBKEY)'   **/
      583     2900
      584     2901    1   FINDBKEY: PROC;
      585     2902
      586     2903    2       IPT_FDR.DBK_ = VECTOR(ZII$INTEGER1);
      587     2904    2       CALL CHK_RETAIN (IPT_FDR.V.RLCW,0);
      588     2905    2       IPT_FDR.V_ = VECTOR(IPT_FDR.V);
      589     2906    2       VBOUND(IPT_FDR.V_) = VBOUND(IPT_FDR.V_) + SIZEC(IPT_FDR.V.RETENTION_LIST) *
              2906                RLCW_SAVE.N_SETS#;
      590     2907            %CLIMB(FCN=FDR);
      591     2921    2       FPT.V_=VECTOR(FPT.V);
      592     2922    2   END;
      593     2923
      594     2924    1   ZII$FIND: ENTRY ALTRET;
      595     2925
      596     2926    1       IF PARAMS(0)=1 AND PARAMS(1)=%CURRENT THEN
      597     2927    2       DO; /* FIND CURRENT OF RUN */
      598     2928    2           IPT_FCR.V_ = VECTOR(IPT_FCR.V);
      599     2929    2           CALL CHK_RETAIN(IPT_FCR.V.RLCW,0);
      600     2930                %CLIMB(FCN=FCR);
      601     2944    2           GOTO COMMON_RETURN;
      602     2945    2           END;
      603     2946    1       IF PARAMS(0)<2 OR PARAMS(0)>%PARAMETERS THEN ALTRETURN;
      604     2947    1       CALL SET_ARGS;
      605     2948    1       IF TYPE_OF_ARG(PARAMS(0)-1)=%USING AND
      606     2949    1          TYPE_OF_ARG(PARAMS(0))=%SET_NAME THEN
      607     2950
      608     2951        /**************************************************************/
      609     2952        /*                                                            */
      610     2953        /*     TYPE OF FIND: USING KEY (KEY IN INDEX)                 */
      611     2954        /*                                                            */
      612     2955        /*                FIRST[,REC-NAME]                            */
      613     2956        /*     CALL FIND(<NEXT [,REC-NAME]>,USING,KEY-NAME)           */
      614     2957        /*                       REC-NAME                             */
      615     2958        /*                                                            */
      616     2959        /**************************************************************/
      617     2960
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:24   
      618     2961    2       DO;
      619     2962    2           IF TYPE_OF_ARG(1)=%RECORD_NAME THEN
      620     2963    3           DO;
      621     2964    3               IPT_FUI.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
      622     2965    3               IPT_FUI.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(3);
      623     2966    3               IF TYPE_OF_ARG(3)~=%SET_NAME THEN ALTRETURN;
      624     2967    3               IPT_FUI.V_ = VECTOR(IPT_FUI.V);
      625     2968    3               VBOUND(IPT_FUI.V_) = VBOUND(IPT_FUI.V_) + SIZEC(IPT_FUI.V.RETENTION_LIST
              2968                        ) * RLCW_SAVE.N_SETS#;
      626     2969    3               CALL CHK_RETAIN(IPT_FUI.V.RLCW,0);
      627     2970                    %CLIMB(FCN=FUI);
      628     2984    3               END;
      629     2985    2           ELSE
      630     2986    3           DO;
      631     2987    3               IF PARAMS(1)=%FIRST THEN
      632     2988    3                   IPT_FRI.V.FCW.RECORD_LOCATION#=0;
      633     2989    3               ELSE
      634     2990    3                   IF PARAMS(1)=%NEXT THEN
      635     2991    3                       IPT_FRI.V.FCW.RECORD_LOCATION#=1;
      636     2992    3                   ELSE
      637     2993    3                       ALTRETURN;
      638     2994    3               IF PARAMS(3)=%USING THEN
      639     2995    4               DO;
      640     2996    4                   IF TYPE_OF_ARG(2)~=%RECORD_NAME OR
      641     2997    4                      TYPE_OF_ARG(4)~=%SET_NAME THEN ALTRETURN;
      642     2998    4                   IPT_FRI.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);
      643     2999    4                   IPT_FRI.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(4);
      644     3000    4                   END;
      645     3001    3               ELSE
      646     3002    4               DO;
      647     3003    4                   IF TYPE_OF_ARG(3)~=%SET_NAME THEN ALTRETURN;
      648     3004    4                   IPT_FRI.V.RC.RC_OFFSET#=NULL_OFFSET;
      649     3005    4                   IPT_FRI.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(3);
      650     3006    4                   END;
      651     3007    3               IPT_FRI.V_ = VECTOR(IPT_FRI.V);
      652     3008    3               VBOUND(IPT_FRI.V_) = VBOUND(IPT_FRI.V_) + SIZEC(IPT_FRI.V.RETENTION_LIST
              3008                        ) * RLCW_SAVE.N_SETS#;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:25   
      653     3009    3               CALL CHK_RETAIN(IPT_FRI.V.RLCW,0);
      654     3010                    %CLIMB(FCN=FRI);
      655     3024    3               END;
      656     3025    2           END;
      657     3026         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:26   
      658     3027    1       ELSE
      659     3028    2       DO;
      660     3029    3           DO CASE(TYPE_OF_ARG(1));
      661     3030
      662     3031    3           CASE(%RECORD_NAME);
      663     3032    3               IF PARAMS(2)=%DBKEY THEN
      664     3033    4               DO;
      665     3034
      666     3035        /****************************************************************/
      667     3036        /*                                                              */
      668     3037        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
      669     3038        /*                                                              */
      670     3039        /*            CALL FIND(REC-NAME,DBKEY[,IS],IDENTIFIER)         */
      671     3040        /*                                                              */
      672     3041        /****************************************************************/
      673     3042
      674     3043    4                   IPT_FDR.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
      675     3044    4                   IF TYPE_OF_ARG(3)~=%IS AND
      676     3045    4                      TYPE_OF_ARG(3)~=%APL_IDP THEN ALTRETURN;
      677     3046    4                   CALL FINDBKEY;
      678     3047    4                   END;
      679     3048    3               ELSE IF PARAMS(2)=%WITHIN THEN
      680     3049    4                   DO;
      681     3050
      682     3051        /***************************************************************/
      683     3052        /*                                                             */
      684     3053        /*            TYPE OF FIND: WITH KEY WITHIN CURRENT SET        */
      685     3054        /*                                                             */
      686     3055        /*            CALL FIND(REC-NAME,WITHIN,SET-NAME,[CURRENT]     */
      687     3056        /*                      [,USING][,IDENT-5],[IDENT-6],....])    */
      688     3057        /*                                                             */
      689     3058        /***************************************************************/
      690     3059
      691     3060    4                       ADDR(IPT_FKC.V.FLCW)->SBIN36=0;
      692     3061    4                       IF TYPE_OF_ARG(3)~=%SET_NAME THEN ALTRETURN;
      693     3062    4                       IPT_FKC.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
      694     3063    4                       IPT_FKC.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(3);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:27   
      695     3064    4                       IF PARAMS(0)>3 AND PARAMS(4)=%CURRENT THEN
      696     3065    4                           I=5; ELSE I=4;
      697     3066    4                       IF TYPE_OF_ARG(I)=%USING THEN
      698     3067    4                           K=I+1; ELSE K=I; /* KEYWORD USING IS OPTIONAL */
      699     3068    5                       DO J=K TO PARAMS(0);
      700     3069    5                           IF TYPE_OF_ARG(J)~=%FIELD_NAME THEN ALTRETURN;
      701     3070    5                           IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#(J-K)=ZII$PARAMS.OFFSET(J);
      702     3071    5                           IPT_FKC.V.FLCW.N_FIELDS#=IPT_FKC.V.FLCW.N_FIELDS#+1;
      703     3072    5                           END;
      704     3073    4                       CALL CHK_RETAIN(IPT_FKC.V.RLCW,IPT_FKC.V.FLCW.N_FIELDS#);
      705     3074    5                       DO CASE(I);
      706     3075    5                       CASE(4);
      707     3076    5                           IPT_FKY.V_ = VECTOR(IPT_FKY.V);
      708     3077                                %CLIMB(FCN=FKY);
      709     3091    5                       CASE(ELSE);
      710     3092    5                           IPT_FKC.V_ = VECTOR(IPT_FKC.V);
      711     3093                                %CLIMB(FCN=FKC);
      712     3107    5                           END;
      713     3108    4                       END;
      714     3109    3                   ELSE ALTRETURN;
      715     3110         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:28   
      716     3111    3           CASE(%DBKEY);
      717     3112
      718     3113        /****************************************************************/
      719     3114        /*                                                              */
      720     3115        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
      721     3116        /*                                                              */
      722     3117        /*            CALL FIND(DBKEY[,IS],IDENTIFIER)                  */
      723     3118        /*                                                              */
      724     3119        /****************************************************************/
      725     3120
      726     3121    3               IPT_FDR.V.RC.RC_OFFSET#=NULL_OFFSET;
      727     3122    3               IF TYPE_OF_ARG(2)~=%IS AND
      728     3123    3                  TYPE_OF_ARG(2)~=%APL_IDP THEN ALTRETURN;
      729     3124    3               CALL FINDBKEY;
      730     3125    3           CASE(%ANY,%DUPLICATE);
      731     3126        /**************************************************************/
      732     3127        /*                                                            */
      733     3128        /*       TYPE OF FIND: WITH CALC KEY                          */
      734     3129        /*                                                            */
      735     3130        /*       CALL FIND(ANY/DUPANY,REC-NAME)                       */
      736     3131        /*                                                            */
      737     3132        /**************************************************************/
      738     3133
      739     3134    3               IF TYPE_OF_ARG(2)=%RECORD_NAME THEN
      740     3135    4               DO;
      741     3136    4                   IPT_FDC.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);
      742     3137    4                   CALL CHK_RETAIN(IPT_FDC.V.RLCW,0);
      743     3138    5                   IF PARAMS(1)=%ANY THEN DO;
      744     3139    5                       IPT_FDC.V_ = VECTOR(IPT_FDC.V);
      745     3140    5                       VBOUND(IPT_FDC.V_) = VBOUND(IPT_FDC.V_) + SIZEC(IPT_FDC.V.
              3140                                RETENTION_LIST) * RLCW_SAVE.N_SETS#;
      746     3141                            %CLIMB(FCN=FDC);
      747     3155    5                       END;
      748     3156    5                   ELSE DO;
      749     3157    5                       IPT_FCD.V_ = VECTOR(IPT_FCD.V);
      750     3158                            %CLIMB(FCN=FCD);
      751     3172    5                       END;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:29   
      752     3173    4                   END;
      753     3174         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:30   
      754     3175    3               ELSE
      755     3176    4               DO;
      756     3177
      757     3178        /*************************************************************/
      758     3179        /*                                                             */
      759     3180        /*       TYPE OF FIND: DUPLICATE RECORD WITHIN A SET           */
      760     3181        /*                                                             */
      761     3182        /*       CALL FIND(DUPSET[,WITHIN],SET-NAME[,USING],IDENT..)   */
      762     3183        /*                                                             */
      763     3184        /*************************************************************/
      764     3185
      765     3186    4                   J=2;
      766     3187    4                   IF TYPE_OF_ARG(2)=%WITHIN THEN J=3;
      767     3188    4                   IF TYPE_OF_ARG(J)~=%SET_NAME THEN ALTRETURN;
      768     3189    4                   IPT_FDP.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(J);
      769     3190    4                   J=J+1;
      770     3191    4                   IF TYPE_OF_ARG(J)=%USING THEN J=J+1;
      771     3192    4                   ADDR(IPT_FDP.V.FLCW)->SBIN36=0;
      772     3193    5                   DO I=J TO PARAMS(0);
      773     3194    5                       IF TYPE_OF_ARG(I)~=%FIELD_NAME THEN ALTRETURN;
      774     3195    5                       IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#(I-J)=ZII$PARAMS.OFFSET(I);
      775     3196    5                       IPT_FDP.V.FLCW.N_FIELDS#=IPT_FDP.V.FLCW.N_FIELDS#+1;
      776     3197    5                       END;
      777     3198    4                   IPT_FDP.V_ = VECTOR(IPT_FDP.V);
      778     3199    4                   VBOUND(IPT_FDP.V_) = VBOUND(IPT_FDP.V_) +
      779     3200    4                      SIZEC(IPT_FDP.V.FL_RL_LIST) * (RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW
              3200                               .N_FIELDS# - 1);
      780     3201    4                   CALL CHK_RETAIN(IPT_FDP.V.RLCW,IPT_FDP.V.FLCW.N_FIELDS#);
      781     3202                        %CLIMB(FCN=FDP);
      782     3216    4                   END;
      783     3217         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:31   
      784     3218    3           CASE(%CURRENT,%NEXT,%PRIOR);
      785     3219    3               IF PARAMS(0)=2 AND TYPE_OF_ARG(2)=%RECORD_NAME AND
      786     3220    3                  PARAMS(1)=%CURRENT THEN
      787     3221
      788     3222        /******************************************************************/
      789     3223        /*                                                                */
      790     3224        /*       TYPE OF FIND: CURRENT OF RECORD                          */
      791     3225        /*                                                                */
      792     3226        /*       CALL FIND(CURRENT,REC-NAME)                              */
      793     3227        /*                                                                */
      794     3228        /******************************************************************/
      795     3229    4               DO;
      796     3230    4                   IPT_FCT.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);
      797     3231    4                   CALL CHK_RETAIN(IPT_FCT.V.RLCW,0);
      798     3232    4                   IPT_FCT.V_ = VECTOR(IPT_FCT.V);
      799     3233    4                   VBOUND(IPT_FCT.V_) = VBOUND(IPT_FCT.V_) + SIZEC(IPT_FCT.V.
              3233                            RETENTION_LIST) * RLCW_SAVE.N_SETS#;
      800     3234                        %CLIMB(FCN=FCT);
      801     3248    4                   END;
      802     3249    3               ELSE
      803     3250         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:32   
      804     3251        /****************************************************************/
      805     3252        /*                                                              */
      806     3253        /*       TYPE OF FIND: RELATIVE TO A SET OR A AREA              */
      807     3254        /*                                                              */
      808     3255        /*                 PRIOR                                        */
      809     3256        /*       CALL FIND(CURRENT,[REC-NAME],[WITHIN],SET-NAME)        */
      810     3257        /*                 NEXT               AREA-NAME                 */
      811     3258        /*                                                              */
      812     3259        /****************************************************************/
      813     3260    4               DO;
      814     3261    4                   IF PARAMS(1)=%PRIOR THEN
      815     3262    4                       IPT_FRS.V.FCW.RECORD_LOCATION#=0;
      816     3263    4                   ELSE
      817     3264    4                       IF PARAMS(1)=%CURRENT THEN
      818     3265    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=1;
      819     3266    4                       ELSE
      820     3267    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=2;
      821     3268    4                   IF TYPE_OF_ARG(2)=%RECORD_NAME THEN
      822     3269    5                   DO;
      823     3270    5                       I=3;
      824     3271    5                       IPT_FRS.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);
      825     3272    5                       END;
      826     3273    4                   ELSE
      827     3274    5                   DO;
      828     3275    5                       I=2;
      829     3276    5                       IPT_FRS.V.RC.RC_OFFSET#=NULL_OFFSET;
      830     3277    5                       END;
      831     3278    4                   IF PARAMS(0)>I AND TYPE_OF_ARG(I)~=%WITHIN THEN
      832     3279    4                       ALTRETURN;
      833     3280    4                   IPT_FRS.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));
      834     3281    4                   CALL CHK_RETAIN(IPT_FRS.V.RLCW,0);
      835     3282    5                   DO CASE(TYPE_OF_ARG(PARAMS(0)));
      836     3283
      837     3284    5                   CASE(%AREA_NAME);
      838     3285    5                       IPT_FRA.V_ = VECTOR(IPT_FRA.V);
      839     3286                            %CLIMB(FCN=FRA);
      840     3300    5                   CASE(%SET_NAME);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:33   
      841     3301    5                       IPT_FRS.V_ = VECTOR(IPT_FRS.V);
      842     3302    5                       VBOUND(IPT_FRS.V_) = VBOUND(IPT_FRS.V_) + SIZEC(IPT_FRS.V.
              3302                                RETENTION_LIST) * RLCW_SAVE.N_SETS#;
      843     3303                            %CLIMB(FCN=FRS);
      844     3317    5                   CASE(ELSE);
      845     3318    5                       ALTRETURN;
      846     3319    5                       END;
      847     3320    4                   END;
      848     3321    3           CASE(%OWNER);
      849     3322
      850     3323        /***************************************************************/
      851     3324        /*                                                             */
      852     3325        /*       TYPE OF FIND: OWNER OF A SET                          */
      853     3326        /*                                                             */
      854     3327        /*       CALL FIND(OWNER[,WITHIN],SET-NAME)                    */
      855     3328        /*                                                             */
      856     3329        /***************************************************************/
      857     3330
      858     3331    3               IF TYPE_OF_ARG(PARAMS(0))~=%SET_NAME THEN ALTRETURN;
      859     3332    3               IF PARAMS(0)>=3 AND TYPE_OF_ARG(2)~=%WITHIN
      860     3333    3               THEN ALTRETURN;
      861     3334    3               IPT_FOR.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));
      862     3335    3               IPT_FOR.V_ = VECTOR(IPT_FOR.V);
      863     3336    3               VBOUND(IPT_FOR.V_) = VBOUND(IPT_FOR.V_) + SIZEC(IPT_FOR.V.RETENTION_LIST
              3336                        ) * RLCW_SAVE.N_SETS#;
      864     3337    3               CALL CHK_RETAIN(IPT_FOR.V.RLCW,0);
      865     3338                    %CLIMB(FCN=FOR);
      866     3352    3           CASE(%FIRST,%LAST,%APL_IDP);
      867     3353         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:34   
      868     3354        /**************************************************************/
      869     3355        /*                                                            */
      870     3356        /*       TYPE OF FIND: I-TH NUMBER WITHIN A SET OR A AREA     */
      871     3357        /*                                                            */
      872     3358        /*       CALL FIND(FIRST,[REC-NAME],[WITHIN],SET-NAME )       */
      873     3359        /*                 LAST             AREA-NAME                 */
      874     3360        /*                 INTEGER                                    */
      875     3361        /*                 IDENTIFIER                                 */
      876     3362        /*                                                            */
      877     3363        /**************************************************************/
      878     3364
      879     3365    3               IPT_FAA.V.AC.AC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));
      880     3366    3               IF PARAMS(1)=%LAST THEN
      881     3367    3                   IPT_FAS.V.RECORD_NUMBER#=-1;
      882     3368    3               ELSE
      883     3369    3                   IF PARAMS(1)=%FIRST THEN
      884     3370    3                       IPT_FAS.V.RECORD_NUMBER#=1;
      885     3371    3                   ELSE
      886     3372    3                       IF PARAMS(1)=%APL_IDP THEN
      887     3373    3                           IPT_FAS.V.RECORD_NUMBER#=ZII$INTEGER1;
      888     3374    3                       ELSE
      889     3375    3                           ALTRETURN;
      890     3376
      891     3377    3               IF TYPE_OF_ARG(2)=%RECORD_NAME THEN
      892     3378    4               DO;
      893     3379    4                   I=3;
      894     3380    4                   IPT_FAS.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);
      895     3381    4                   END;
      896     3382    3               ELSE
      897     3383    4               DO;
      898     3384    4                   I=2;
      899     3385    4                   IPT_FAS.V.RC.RC_OFFSET#=NULL_OFFSET;
      900     3386    4                   END;
      901     3387    3               IF PARAMS(0)>I AND TYPE_OF_ARG(I)~=%WITHIN THEN
      902     3388    3                   ALTRETURN;
      903     3389    3               CALL CHK_RETAIN(IPT_FAS.V.RLCW,0);
      904     3390    4               DO CASE(TYPE_OF_ARG(PARAMS(0)));
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:35   
      905     3391
      906     3392    4               CASE(%AREA_NAME);
      907     3393    4                   IPT_FAA.V_ = VECTOR(IPT_FAA.V);
      908     3394    4                   VBOUND(IPT_FAA.V_) = VBOUND(IPT_FAA.V_) + SIZEC(IPT_FAA.V.
              3394                            RETENTION_LIST) * RLCW_SAVE.N_SETS#;
      909     3395                        %CLIMB(FCN=FAA);
      910     3409    4               CASE(%SET_NAME);
      911     3410    4                   IPT_FAS.V_ = VECTOR(IPT_FAS.V);
      912     3411                        %CLIMB(FCN=FAS);
      913     3425    4               CASE(ELSE);
      914     3426    4                   ALTRETURN;
      915     3427    4                   END;
      916     3428    3           CASE(ELSE);
      917     3429    3               ALTRETURN;
      918     3430    3               END;
      919     3431    2           END;
      920     3432    1       GOTO COMMON_RETURN;
      921     3433         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:36   
      922     3434        /***************************************************************/
      923     3435        /*                                                             */
      924     3436        /*     CALLING SEQUENCE FOR GET:                               */
      925     3437        /*          1. CALL GET                                        */
      926     3438        /*          2. CALL GET(REC-NAME)                              */
      927     3439        /*          3. CALL GET(FIELD-1,[FIELD-2],.....])              */
      928     3440        /*                                                             */
      929     3441        /***************************************************************/
      930     3442
      931     3443    1   ZII$GET: ENTRY ALTRET;
      932     3444
      933     3445    1       CALL SET_ARGS;
      934     3446    1       IF PARAMS(0)>0 AND TYPE_OF_ARG(1)=%FIELD_NAME THEN
      935     3447    2       DO;
      936     3448    2           ADDR(IPT_GTF.V.FLCW)->SBIN36=0;
      937     3449    2           IPT_GTF.V.FLCW.N_FIELDS#=PARAMS(0);
      938     3450    3           DO I=1 TO PARAMS(0);
      939     3451    3               IF TYPE_OF_ARG(I)~=%FIELD_NAME THEN ALTRETURN;
      940     3452    3               IPT_GTF.V.FIELD_LIST.RVA_OFFSET#(I-1)=ZII$PARAMS.OFFSET(I);
      941     3453    3               END;
      942     3454    2           IPT_GTF.V_ = VECTOR(IPT_GTF.V);
      943     3455                %CLIMB(FCN=GTF);
      944     3469    2           END;
      945     3470    1       ELSE
      946     3471    2       DO;
      947     3472    2           IF PARAMS(0)=0 THEN
      948     3473    2               IPT_GET.V.RC.RC_OFFSET#=NULL_OFFSET;
      949     3474    2           ELSE
      950     3475    2               IF PARAMS(0)=1 AND TYPE_OF_ARG(1)=%RECORD_NAME THEN
      951     3476    2                   IPT_GET.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
      952     3477    2               ELSE ALTRETURN;
      953     3478    2           IPT_GTF.V_ = VECTOR(IPT_GTF.V);
      954     3479    2           VBOUND(IPT_GTF.V_) = VBOUND(IPT_GTF.V_) + SIZEC(IPT_GTF.V.FIELD_LIST) *
              3479                    PARAMS(0);
      955     3480                %CLIMB(FCN=GET);
      956     3494    2           END;
      957     3495    1       GOTO COMMON_RETURN;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:37   
      958     3496         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:38   
      959     3497    1   ZII$MODIFY: ENTRY ALTRET;
      960     3498
      961     3499        /****************************************************************/
      962     3500        /*                                                              */
      963     3501        /*    CALL MODIFY([REC-NAME],[INCLUDING,ALL             ])        */
      964     3502        /*                           ONLY      SET-NAME1,[...]            */
      965     3503        /*                                                                */
      966     3504        /*    CALL MODIFY(IDENT-1,[IDENT-2],...,,[INCLUDING,ALL       ])  */
      967     3505        /*                                                SET-NAME-LIST   */
      968     3506        /*                                                                */
      969     3507        /******************************************************************/
      970     3508
      971     3509    1       CALL SET_ARGS;
      972     3510    1       IPT_MOD.V.RC.RC_OFFSET#=NULL_OFFSET;
      973     3511    1       ADDR(IPT_MOD.V.FLCW)->SBIN36=0;
      974     3512    1       ADDR(IPT_MOD.V.MCW)->SBIN36=0;
      975     3513    1       ADDR(IPT_MOD.V.SLCW)->SBIN36=0;
      976     3514    1       K = 0;
      977     3515    1       IF PARAMS(0)>0 THEN
      978     3516    2       DO;
      979     3517    2           K=1;
      980     3518    2           I=0;
      981     3519    2           IF TYPE_OF_ARG(1)=%RECORD_NAME THEN
      982     3520    3           DO;
      983     3521    3               K=2;
      984     3522    3               IPT_MOD.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
      985     3523    3               END;
      986     3524    2           ELSE
      987     3525    2               IF TYPE_OF_ARG(1)=%FIELD_NAME THEN
      988     3526    3               DO;
      989     3527    4                   DO WHILE(TYPE_OF_ARG(K)=%FIELD_NAME AND K<=PARAMS(0));
      990     3528    4                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(I)=ZII$PARAMS.OFFSET(K);
      991     3529    4                       I=I+1;
      992     3530    4                       K=K+1;
      993     3531    4                       END;
      994     3532    3                   IPT_MOD.V.FLCW.N_FIELDS#=I;
      995     3533    3                   END;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:39   
      996     3534    2           IF K<PARAMS(0) AND (PARAMS(K)=%INCLUDING OR PARAMS(K)=%ONLY) THEN
      997     3535    3           DO;
      998     3536    3               IF PARAMS(K)=%ONLY THEN
      999     3537    4               DO;
     1000     3538    4                   IPT_MOD.V.MCW.MC_BIT0#='1'B;
     1001     3539    4                   IF I>0 THEN ALTRETURN;
     1002     3540    4                   END;
     1003     3541    3               K=K+1;
     1004     3542    3               IF TYPE_OF_ARG(K)=%ALL THEN
     1005     3543    3                   IPT_MOD.V.MCW.MC_BIT1#='1'B;
     1006     3544    3               ELSE
     1007     3545    4               DO;
     1008     3546    4                   J=PARAMS(0);
     1009     3547    4                   IF TYPE_OF_ARG(J)=%MEMBERSHIP THEN J=J-1;
     1010     3548    5                   DO WHILE (K<=J);
     1011     3549    5                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(I)=ZII$PARAMS.OFFSET(K);
     1012     3550    5                       IF TYPE_OF_ARG(K)~=%SET_NAME THEN ALTRETURN;
     1013     3551    5                       I=I+1;
     1014     3552    5                       IPT_MOD.V.SLCW.N_SETS#=IPT_MOD.V.SLCW.N_SETS#+1;
     1015     3553    5                       K=K+1;
     1016     3554    5                       END;
     1017     3555    4                   END;
     1018     3556    3               END;
     1019     3557    2           ELSE
     1020     3558    2               IF K<=PARAMS(0) THEN ALTRETURN;
     1021     3559    2           END;
     1022     3560    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);
     1023     3561    1       VBOUND(IPT_MOD.V_) = VBOUND(IPT_MOD.V_) + SIZEC(IPT_MOD.V.FL_SL_LIST) * K;
     1024     3562            %CLIMB(FCN=MOD);
     1025     3576    1       GOTO COMMON_RETURN;
     1026     3577         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:40   
     1027     3578        /**   INTERNAL COMMON SUBROUTINE FOR CONNECT AND DISCONNECT   **/
     1028     3579
     1029     3580    1   CON_DIS: PROC(OPTION) ALTRET;
     1030     3581
     1031     3582    2   DCL OPTION UBIN;
     1032     3583
     1033     3584    2       CALL SET_ARGS;
     1034     3585
     1035     3586    2       IF TYPE_OF_ARG(PARAMS(0))~=%SET_NAME THEN ALTRETURN;
     1036     3587    2       IF PARAMS(0)=2 AND TYPE_OF_ARG(1)~=%RECORD_NAME AND
     1037     3588    2          TYPE_OF_ARG(1)~=OPTION THEN ALTRETURN;
     1038     3589    2       ELSE
     1039     3590    2           IF PARAMS(0)>=3 AND (TYPE_OF_ARG(1)~=%RECORD_NAME OR
     1040     3591    2              TYPE_OF_ARG(2)~=OPTION) THEN ALTRETURN;
     1041     3592    2       IF TYPE_OF_ARG(1)=%RECORD_NAME THEN
     1042     3593    2           IPT_CON.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);
     1043     3594    2       ELSE
     1044     3595    2           IPT_CON.V.RC.RC_OFFSET#=NULL_OFFSET;
     1045     3596    2       IPT_CON.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));
     1046     3597    2   END CON_DIS;
     1047     3598
     1048     3599    1   ARG_ERROR: ALTRETURN;
     1049     3600
     1050     3601    1   ZII$CONNECT: ENTRY ALTRET;
     1051     3602
     1052     3603    1       IPT_CON.V_ = VECTOR(IPT_CON.V);
     1053     3604    1       CALL CON_DIS(%TO) ALTRET(ARG_ERROR);
     1054     3605            %CLIMB(FCN=CON);
     1055     3619    1       GOTO COMMON_RETURN;
     1056     3620
     1057     3621    1   ZII$DISCONNECT: ENTRY ALTRET;
     1058     3622
     1059     3623    1       IPT_DIS.V_ = VECTOR(IPT_DIS.V);
     1060     3624    1       CALL CON_DIS(%FROM) ALTRET(ARG_ERROR);
     1061     3625            %CLIMB(FCN=DIS);
     1062     3639    1       GOTO COMMON_RETURN;
     1063     3640         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:41   
     1064     3641        /**   COMMON SUBROUTINE FOR IFT OR IST   **/
     1065     3642    1   DO_IF: PROC(A) ALTRET;
     1066     3643    2   DCL A BIT(2);
     1067     3644
     1068     3645    2       ADDR(IPT_IST.V.TDW)->SBIN36=0;
     1069     3646    2       IPT_IST.V.TDW=A;
     1070     3647    2       CALL SET_ARGS;
     1071     3648    3       DO CASE(PARAMS(0));
     1072     3649    3       CASE(1);
     1073     3650    3           IPT_IFT.V_ = VECTOR(IPT_IFT.V);
     1074     3651                %CLIMB(FCN=IFT);
     1075     3665    3       CASE(2);
     1076     3666    3           IF TYPE_OF_ARG(1)~=%SET_NAME THEN ALTRETURN;
     1077     3667    3           IPT_IST.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(1);
     1078     3668    3           IPT_IST.V_ = VECTOR(IPT_IST.V);
     1079     3669                %CLIMB(FCN=IST);
     1080     3683    3       CASE(ELSE);
     1081     3684    3           ALTRETURN;
     1082     3685    3           END;
     1083     3686    2       ZII$INTEGER1=UWA(0); /* UWA AT WORD 0 HAS THE RESULT */
     1084     3687    2   END DO_IF;
     1085     3688
     1086     3689    1   COMMON_RETURN: /* EVERY IDS CALL RETURNED FROM HERE */
     1087     3690    1       IDSSYSERR = PINCRW(IA$,5) -> SBIN36; /* MON ERR_CODE */
     1088     3691    1       RETURN; /* NOW RETURN TO USER */
     1089     3692         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:42   
     1090     3693    1   ZII$IFEMPTY: ENTRY ALTRET;
     1091     3694
     1092     3695    1       CALL SET_ARGS;
     1093     3696    1       IF TYPE_OF_ARG(1)~=%SET_NAME THEN ALTRETURN;
     1094     3697    1       IPT_IFM.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(1);
     1095     3698    1       IPT_IFM.V_ = VECTOR(IPT_IFM.V);
     1096     3699            %CLIMB(FCN=IFM);
     1097     3713    1       ZII$INTEGER1=UWA(0); /* UWA AT WORD 0 HAS THE RESULT */
     1098     3714    1       GOTO COMMON_RETURN;
     1099     3715
     1100     3716    1   ZII$IFMEMBER: ENTRY ALTRET;
     1101     3717
     1102     3718    1       CALL DO_IF('01'B) ALTRET(ARG_ERROR);
     1103     3719    1       GOTO COMMON_RETURN;
     1104     3720
     1105     3721    1   ZII$IFOWNER: ENTRY ALTRET;
     1106     3722
     1107     3723    1       CALL DO_IF('10'B) ALTRET(ARG_ERROR);
     1108     3724    1       GOTO COMMON_RETURN;
     1109     3725
     1110     3726    1   ZII$IFTENANT: ENTRY ALTRET;
     1111     3727
     1112     3728    1       CALL DO_IF('11'B) ALTRET(ARG_ERROR);
     1113     3729    1       GOTO COMMON_RETURN;
     1114     3730
     1115     3731    1   ZII$CHECK: ENTRY ALTRET;
     1116     3732
     1117     3733            %CLIMB(FCN=CHK);
     1118     3747    1       GOTO COMMON_RETURN;
     1119     3748
     1120     3749    1   ZII$BUFFERS: ENTRY ALTRET;
     1121     3750
     1122     3751            %CLIMB(FCN=NBF);
     1123     3765    1       GOTO COMMON_RETURN;
     1124     3766         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:43   
     1125     3767    1   ZII$CRPT: ENTRY ALTRET;
     1126     3768
     1127     3769            %CLIMB(FCN=CRPT);
     1128     3783    1       GOTO COMMON_RETURN;
     1129     3784
     1130     3785    1   ZII$ROLL: ENTRY ALTRET;
     1131     3786
     1132     3787            %CLIMB(FCN=ROL);
     1133     3801    1       GOTO COMMON_RETURN;
     1134     3802
     1135     3803    1   ZII$RPTSTATS: ENTRY ALTRET;
     1136     3804
     1137     3805            %CLIMB(FCN=RPT,PARAMS=0);
     1138     3819    1       GOTO COMMON_RETURN;
     1139     3820
     1140     3821    1   ZII$STATSON: ENTRY ALTRET;
     1141     3822
     1142     3823            %CLIMB(FCN=STON,PARAMS=0);
     1143     3837    1       GOTO COMMON_RETURN;
     1144     3838
     1145     3839    1   ZII$STATSOFF: ENTRY ALTRET;
     1146     3840
     1147     3841            %CLIMB(FCN=STOFF,PARAMS=0);
     1148     3855    1       GOTO COMMON_RETURN;
     1149     3856
     1150     3857    1   ZII$TRACEOFF: ENTRY ALTRET;
     1151     3858
     1152     3859    1       IF ZII$INTEGER1<0 AND ZII$INTEGER1>4 THEN
     1153     3860    1           ZII$INTEGER1=0; /* USE DEFAULT TO TRACE ALL */
     1154     3861            %CLIMB(FCN=TROFF);
     1155     3875    1       GOTO COMMON_RETURN;
     1156     3876
     1157     3877    1   ZII$TRACEON: ENTRY ALTRET;
     1158     3878
     1159     3879    1       IF ZII$INTEGER1<0 AND ZII$INTEGER1>4 THEN
     1160     3880    1           ZII$INTEGER1=0; /* USE DEFAULT TO TRACE ALL */
     1161     3881            %CLIMB(FCN=TRON);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:44   
     1162     3895    1       GOTO COMMON_RETURN;
     1163     3896
     1164     3897    1   ZII$KEEP: ENTRY ALTRET;
     1165     3898
     1166     3899    1       IPT_KEEP.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);
     1167     3900            %CLIMB(FCN=KEEP);
     1168     3914    1       GOTO COMMON_RETURN;
     1169     3915
     1170     3916    1   ZII$REDUCEQ: ENTRY ALTRET;
     1171     3917
     1172     3918            %CLIMB(FCN=REDUCEQ); /* NUM OF PAGES DEQED RETURNED TO ZII$INTEGER1 */
     1173     3932    1       GOTO COMMON_RETURN;
     1174     3933         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:45   
     1175     3934        /****************************************************************/
     1176     3935        /*                                                              */
     1177     3936        /*    CALL PRIVACY(RECORD,IDS-NAME1,PRIVACY-KEY,REC-NAME)       */
     1178     3937        /*                                                              */
     1179     3938        /*      IDS-NAME1: CONNECT,DISCONNECT,STORE,ERASE               */
     1180     3939        /*                 MODIFY,FIND,GET                              */
     1181     3940        /*                                                              */
     1182     3941        /*    CALL PRIVACY(SET,CONNECT,PRIVACY-KEY,SET-NAME1,....)      */
     1183     3942        /*                     DISCONNECT                               */
     1184     3943        /*                     FIND                                     */
     1185     3944        /*                                                              */
     1186     3945        /*    CALL PRIVACY(ITEM,MODIFY/GET,PRIVACY-KEY,ITEM-1,...)      */
     1187     3946        /*                                                              */
     1188     3947        /****************************************************************/
     1189     3948
     1190     3949    1   ZII$PRIVACY: ENTRY ALTRET;
     1191     3950
     1192     3951    1       CALL SET_ARGS;
     1193     3952    1       IF PARAMS(1)=%SET THEN
     1194     3953    1           K=1;
     1195     3954    1       ELSE
     1196     3955    1           IF PARAMS(1)=%RECORD THEN
     1197     3956    1               K=2;
     1198     3957    1           ELSE
     1199     3958    1               IF PARAMS(1)=%ITEM THEN
     1200     3959    1                   K=3;
     1201     3960    1               ELSE
     1202     3961    1                   ALTRETURN;
     1203     3962
     1204     3963    1       JJ=PARAMS(0);
     1205     3964    2       DO WHILE(TYPE_OF_ARG(JJ)-%SET_NAME+1=K);
     1206     3965    2           JJ=JJ-1;
     1207     3966    2           END;
     1208     3967    1       IF (K<3 AND JJ=PARAMS(0)) THEN
     1209     3968    2       DO;
     1210     3969    2           PARAMS(0)=PARAMS(0)+1;
     1211     3970    2           ZII$PARAMS.OFFSET(JJ+1)=0; /* MAKE A FAKE ARG */
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:46   
     1212     3971    2           END;
     1213     3972
     1214     3973    1       KK=USEP.M;
     1215     3974    2       DO I=2 TO JJ-1;
     1216     3975    2           J=0;
     1217     3976    3           DO WHILE(J<7 AND IDS_NAMES(J)~=PARAMS(I));
     1218     3977    3               J=J+1;
     1219     3978    3               END;
     1220     3979    2           IF J=7 THEN ALTRETURN; /* UNKNOWN IDS ROUTINE NAME */
     1221     3980    3           DO II=JJ+1 TO PARAMS(0);
     1222     3981    3               USEP.UC.UCW_PRV.PT(KK)=K;
     1223     3982    3               USEP.UC.UCW_PRV.PB(KK)=IDS_BIT9(J);
     1224     3983    3               USEP.UC.UCW_PRV.A(KK)=RVA_HALF(ZII$PARAMS.OFFSET(II)*2+1);
     1225     3984    3               USEP.UC.ENT(KK)=KEY_COUNT-1;
     1226     3985    3               KK=KK+1;
     1227     3986    3               END;
     1228     3987    2           END;
     1229     3988    1       USEP.M=KK;
     1230     3989    1       KEY_COUNT=KEY_COUNT-1;
     1231     3990    1       KEY_SAVE(KEY_COUNT)=ZII$CHARACTER12;
     1232     3991    1       RETURN;
     1233     3992    1   END ZII$APL_IDP;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:47   
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI_DBCS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$APL_IDP.

   Procedure ZII$APL_IDP requires 2565 words for executable code.
   Procedure ZII$APL_IDP requires 16 words of local(AUTO) storage.

    No errors detected in file ZII$APL_IDP.:ZIC0TSI    .

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:48   

 Object Unit name= ZII$APL_IDP                                File name= ZII$APL_IDP.:ZIC0TOU
 UTS= SEP 05 '97 12:25:07.00 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    76    114  ZII$APL_IDP
    1  RoData even  UTS     14     16  ZII$APL_IDP
    2   DCB   even  none     0      0  M$UC
    3   Proc  even  none  2565   5005  ZII$APL_IDP
    4  RoData even  none    28     34  ZII$APL_IDP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      XStd       3  ZII$APL_IDP
     3    107          yes     yes      XStd       3  ZII$INVOKE
     3    300          yes     yes      XStd       0  ZII$RETAIN
     3    563          yes     yes      XStd       0  ZII$READY
     3   1061          yes     yes      XStd       0  ZII$FINISH
     3   1142          yes     yes      XStd       0  ZII$CALC
     3   1215          yes     yes      XStd       0  ZII$ACCEPT
     3   1614          yes     yes      XStd       0  ZII$STORE
     3   1656          yes     yes      XStd       0  ZII$ERASER
     3   2010          yes     yes      XStd       0  ZII$FIND
     3   3530          yes     yes      XStd       0  ZII$GET
     3   3662          yes     yes      XStd       0  ZII$MODIFY
     3   4246          yes     yes      XStd       0  ZII$CONNECT
     3   4265          yes     yes      XStd       0  ZII$DISCONNECT
     3   4374          yes     yes      XStd       0  ZII$IFEMPTY
     3   4427          yes     yes      XStd       0  ZII$IFMEMBER
     3   4436          yes     yes      XStd       0  ZII$IFOWNER
     3   4445          yes     yes      XStd       0  ZII$IFTENANT
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:49   
     3   4454          yes     yes      XStd       0  ZII$CHECK
     3   4462          yes     yes      XStd       0  ZII$BUFFERS
     3   4470          yes     yes      XStd       0  ZII$CRPT
     3   4476          yes     yes      XStd       0  ZII$ROLL
     3   4504          yes     yes      XStd       0  ZII$RPTSTATS
     3   4511          yes     yes      XStd       0  ZII$STATSON
     3   4516          yes     yes      XStd       0  ZII$STATSOFF
     3   4523          yes     yes      XStd       0  ZII$TRACEOFF
     3   4536          yes     yes      XStd       0  ZII$TRACEON
     3   4551          yes     yes      XStd       0  ZII$KEEP
     3   4563          yes     yes      XStd       0  ZII$REDUCEQ
     3   4571          yes     yes      XStd       0  ZII$PRIVACY

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  ZII$INTEGER1                       0      2  ZII$INTEGER2
    0      4  ZII$CHARACTER30                    0     14  ZII$CHARACTER12
    0     17  ZII$PARAMS                         0     63  IDSSYSERR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:50   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     I$SHNO                                I$CALC                                I$FUI
     I$CRPT                                I$RDY                                 I$ACC
     I$FCR                                 I$FCT                                 I$IFM
     I$SHIN                                I$NBF                                 I$SHCUR
     I$ETC                                 I$FOR                                 I$GET
     I$CON                                 I$REDUCEQ                             I$GTF
     I$CHK                                 I$ACN                                 I$ERS
     I$TRON                                I$KEEP                                I$STON
     I$FRI                                 I$FRA                                 I$TROFF
     I$HIA                                 I$FAS                                 I$MOD
     I$DIS                                 I$ROL                                 I$SHALL
     I$SHANY                               I$SHINCUR                             I$FIN
     I$STO                                 I$FDP                                 I$FKY
     I$FRS                                 I$FKC                                 I$FAA
     I$RPT                                 I$STOFF                               I$FDC
     I$FCD                                 I$FDR                                 I$IST
     I$IFT                                 M$UC

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ASLENTSID
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:51   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        /****************************************************************/
        7        7        /*                                                              */
        8        8        /*    I-D-S/II  INTERFACE MODULE WITH APL/IDP USERS             */
        9        9        /*                                                              */
       10       10        /****************************************************************/
       11       11
       12       12        ZII$APL_IDP: PROC (A1,A2,A3) ALTRET AVOID($PR5,$PR6,$PR7);

     12  3 000000   000000 700200 xent  ZII$APL_IDP  TSX0  ! X66_AUTO_3
         3 000001   000020 000003                    ZERO    16,3
         3 000002   000106 710000 3                  TRA     OUT_OF_MEMORY+2

       13       13
       14       14        %EQU PARAMETERS=20; /*  EVEN NUMBER PREFERED */
       15       15        %EQU PARAMETERS_TIMES_TWO=%PARAMETERS*2;
       16       16        %EQU PARAMETERS_TIMES_THREE=%PARAMETERS*3;
       17       17        %EQU PARAMS_PLUS_ONE=%PARAMETERS+1;
       18       18        %EQU RVA_TYPE_BITS=2;
       19       19
       20       20    1   DCL 1 A1 VECTOR;
       21       21    1   DCL 1 A2 VECTOR;
       22       22    1   DCL 1 A3 VECTOR;
       23       23        %EQU FPT_SIZE=10+%PARAMETERS_TIMES_TWO+10;
       24       24        %EQU RLCW_SIZE=1+%PARAMETERS/2;
       25       25        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:52   
       26       26        /*******************************************************************/
       27       27        /*                                                                 */
       28       28        /*      COMMON AREA WITH APL/IDP USERS TO PASS ARGUMENT LIST       */
       29       29        /*                                                                 */
       30       30        /*******************************************************************/
       31       31
       32       32    1   DCL ZII$INTEGER1 SBIN STATIC SYMDEF DALIGNED;
       33       33    1   DCL ZII$INTEGER2 SBIN STATIC SYMDEF DALIGNED;
       34       34    1   DCL ZII$CHARACTER30 CHAR(30) STATIC SYMDEF;
       35       35    1   DCL ZII$CHARACTER12 CHAR(12) STATIC SYMDEF;
       36       36    1   DCL 1 ZII$PARAMS(0:%PARAMS_PLUS_ONE) STATIC SYMDEF,
       37       37    1         2 OFFSET UBIN HALF UNAL,
       38       38    1         2 KEYWORD UBIN HALF UNAL;
       39       39    1   DCL 1 PARAMS(0:%PARAMS_PLUS_ONE) REDEF ZII$PARAMS SBIN;
       40       40        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:53   
       41       41        /******************************************************************/
       42       42        /*                                                                */
       43       43        /*    WORKING SPACE FOR INTERFACE MODULE (STATIC FOR EFFICICENT)  */
       44       44        /*                                                                */
       45       45        /******************************************************************/
       46       46
       47       47    1   DCL IA$ STATIC PTR;
       48       48    1   DCL UWA$ STATIC PTR;
       49       49    1   DCL RVA$ STATIC PTR;
       50       50    1   DCL USEP$ STATIC PTR;
       51       51    1   DCL ARG$ STATIC PTR;
       52       52    1   DCL FPT$ STATIC PTR;
       53       53    1   DCL NBF_CRPT_TRON$ PTR CONSTANT INIT(ADDR(FPT_SHORT));
       54       54    1   DCL RLCW$ STATIC PTR;
       55       55    1   DCL TYPE$ STATIC PTR;
       56       56
       57       57    1   DCL I SBIN STATIC;
       58       58    1   DCL J SBIN STATIC;
       59       59    1   DCL K SBIN STATIC;
       60       60    1   DCL II SBIN STATIC;
       61       61    1   DCL JJ SBIN STATIC;
       62       62    1   DCL KK SBIN STATIC;
       63       63    1   DCL IDSSYSERR SBIN STATIC SYMDEF; /* STORE MONITOR ERR_CODE IA(5) */
       64       64    1   DCL NULL_OFFSET SBIN STATIC;
       65       65    1   DCL RVA_SIZE SBIN STATIC;
       66       66    1   DCL BIT72 BIT(72) BASED ALIGNED;
       67       67    1   DCL CHAR12 CHAR(12) BASED;
       68       68    1   DCL CHAR7 CHAR(7) BASED;
       69       69    1   DCL SBIN36 SBIN BASED;
       70       70    1   DCL KEY_COUNT SBIN STATIC INIT(0);
       71       71    1   DCL RETAIN_SWITCH SBIN STATIC INIT(0);
       72       72
       73       73    1   DCL RVA(0:0) SBIN BASED(RVA$);
       74       74    1   DCL RVA_HALF(0:0) SBIN HALF UNAL BASED(RVA$);
       75       75    1   DCL IA_HALF(0:0) SBIN HALF UNAL BASED(IA$);
       76       76    1   DCL UWA(0:0) SBIN BASED(UWA$);
       77       77
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:54   
       78       78    1   DCL 1 PAGE_VECTOR STATIC,
       79       79    1         2 * BIT(36),
       80       80    1         2 ADR PTR INIT(ADDR(NIL));
       81       81    1   DCL 1 FPT_SHORT STATIC DALIGNED,
       82       82    1         2 VEC1 BIT(72) INIT(VECTOR(ZII$INTEGER1)),
       83       83    1         2 VEC2 BIT(72) INIT(VECTOR(ZII$INTEGER2));
       84       84    1   DCL PTR$ PTR STATIC;
       85       85        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:55   
       86       86        /****************************************************************/
       87       87        /*                                                              */
       88       88        /*    INCLUDE ZI_DBCS FOR I-D-S/II FPTS AND ENTRIES DEFS        */
       89       89        /*                                                              */
       90       90        /****************************************************************/
       91       91
       92       92        %INCLUDE ZI_DBCS;
       93      705        %ASL;
       94      719        %IPT_ACC(STCLASS="BASED(FPT$)");
       95      732        %IPT_ACN(STCLASS="BASED(FPT$)");
       96      746        %IPT_CHK(ERROR=ZII$INTEGER2,CHKPT_NUMBER=ZII$INTEGER1);
       97      756        %IPT_CALC(STCLASS="BASED(FPT$)");
       98      768        %IPT_CON(STCLASS="BASED(FPT$)");
       99      781        %IPT_CRPT(STCLASS="BASED(NBF_CRPT_TRON$)");
      100      790        %IPT_DIS(STCLASS="BASED(FPT$)");
      101      803        %IPT_ERS(STCLASS="BASED(FPT$)");
      102      815        %IPT_ETC(STCLASS="BASED(FPT$)");
      103      828        %IPT_FAA(STCLASS="BASED(FPT$)");
      104      845        %IPT_FAS(STCLASS="BASED(FPT$)");
      105      862        %IPT_FCD(STCLASS="BASED(FPT$)");
      106      877        %IPT_FCR(STCLASS="BASED(FPT$)");
      107      891        %IPT_FCT(STCLASS="BASED(FPT$)");
      108      906        %IPT_FDC(STCLASS="BASED(FPT$)");
      109      921        %IPT_FDP(STCLASS="BASED(FPT$)");
      110      937        %IPT_FDR(STCLASS="BASED(FPT$)");
      111      953        %IPT_FIN(STCLASS="BASED(FPT$)");
      112      966        %IPT_FKC(STCLASS="BASED(FPT$)");
      113      983        %IPT_FKY(STCLASS="BASED(FPT$)");
      114     1000        %IPT_FOR(STCLASS="BASED(FPT$)");
      115     1015        %IPT_FRA(STCLASS="BASED(FPT$)");
      116     1032        %IPT_FRI(STCLASS="BASED(FPT$)");
      117     1049        %IPT_FRS(STCLASS="BASED(FPT$)");
      118     1066        %IPT_FUI(STCLASS="BASED(FPT$)");
      119     1082        %IPT_GET(STCLASS="BASED(FPT$)");
      120     1094        %IPT_GTF(STCLASS="BASED(FPT$)");
      121     1107        %IPT_HIA(STCLASS="BASED(FPT$)");
      122     1118        %IPT_IFM(STCLASS="BASED(FPT$)");
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:56   
      123     1130        %IPT_IFT(STCLASS="BASED(FPT$)");
      124     1142        %IPT_INA(STCLASS="BASED(FPT$)");
      125     1156        %IPT_IST(STCLASS="BASED(FPT$)");
      126     1169        %IPT_MOD(STCLASS="BASED(FPT$)");
      127     1185        %IPT_NBF(STCLASS="BASED(NBF_CRPT_TRON$)");
      128     1195        %IPT_KEEP(STCLASS=STATIC);
      129     1204        %IPT_REDUCEQ(STCLASS="BASED(NBF_CRPT_TRON$)");
      130     1213        %IPT_RDY(STCLASS="BASED(FPT$)");
      131     1227        %IPT_ROL(ERROR=ZII$INTEGER1);
      132     1236        %IPT_STO(STCLASS="BASED(FPT$)");
      133     1251        %IPT_TRON(STCLASS="BASED(NBF_CRPT_TRON$)");
      134     1260        %IPT_TROFF(STCLASS="BASED(NBF_CRPT_TRON$)");
      135     1269        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:57   
      136     1270        /*****************************************************************/
      137     1271        /*                                                               */
      138     1272        /*    INCLUDE KEY_WORDS DEFINITIONS IN ZI$DESC                   */
      139     1273        /*                                                               */
      140     1274        /*****************************************************************/
      141     1275
      142     1276        %INCLUDE ZI$DESC;
      143     2126        %EQU APL_IDP=1;
      144     2127        %KEYWD_VAL;
      145     2174        %EQU AREA_NAME=2;
      146     2175        %EQU SET_NAME=3;
      147     2176        %EQU RECORD_NAME=4;
      148     2177        %EQU FIELD_NAME=5;
      149     2178        %EQU ON=1;
      150     2179        %EQU OFF=0;
      151     2180    1   DCL IDS_NAMES(0:6) UBIN HALF UNAL CONSTANT
      152     2181    1    INIT(%GET,%MODIFY,%STORE,%ERASE,%CONNECT,%FIND,%DISCONNECT);
      153     2182    1   DCL IDS_BIT9(0:6) BIT(9) CONSTANT CALIGNED
      154     2183    1    INIT('400'O,'200'O,'100'O,'040'O,'020'O,'004'O,'010'O);
      155     2184
      156     2185        /*****************************************************************/
      157     2186        /*                                                               */
      158     2187        /*    INCLUDE CP_6_C TO HAVE MONITOR SERVICES                    */
      159     2188        /*                                                               */
      160     2189        /*****************************************************************/
      161     2190
      162     2191        %INCLUDE CP_6;
      163     2272        %FPT_GDP(PAGES=1,STCLASS=CONSTANT,RESULTS=PAGE_VECTOR);
      164     2286        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:58   
      165     2287        /*****************************************************************/
      166     2288        /*                                                               */
      167     2289        /*    DEFINE THE BASE STRUCTURE INTO DYNAMIC PAGES               */
      168     2290        /*                                                               */
      169     2291        /*****************************************************************/
      170     2292
      171     2293    1   DCL TYPE_OF_ARG(0:0) SBIN(9) UNAL BASED(ARG$);
      172     2294
      173     2295    1   DCL 1 FPT BASED(FPT$) DALIGNED,
      174     2296    1         2 V_ BIT(72),
      175     2297    1         2 IA_ BIT(72),
      176     2298    1         2 UWA_ BIT(72),
      177     2299    1         2 RVA_ BIT(72),
      178     2300    1         2 USEP_ BIT(72),
      179     2301    1         2 V,
      180     2302    1           3 *(0:8) UBIN,
      181     2303    1           3 FPARA(0:%PARAMETERS_TIMES_TWO) UBIN;
      182     2304
      183     2305    1   DCL 1 RLCW_SAVE BASED(RLCW$),
      184     2306    1         2 * UBIN HALF UNAL,
      185     2307    1         2 AC_INDICATORS BIT(1) UNAL,
      186     2308    1         2 SC_INDICATORS BIT(1) UNAL,
      187     2309    1         2 RC_INDICATORS BIT(1) UNAL,
      188     2310    1         2 * BIT(7) UNAL,
      189     2311    1         2 N_SETS# UBIN(8) UNAL,
      190     2312    1         2 RETAIN_LIST(0:%PARAMETERS) UBIN HALF UNAL;
      191     2313
      192     2314    1   DCL KEY_SAVE(0:0) CHAR(12) BASED(FPT$) ALIGNED;
      193     2315
      194     2316    1   DCL 1 USEP BASED(USEP$) DALIGNED, /* MUST BE DALIGNED */
      195     2317    1         2 FLAG BIT(1) UNAL,
      196     2318    1         2 M UBIN(17) UNAL,
      197     2319    1         2 * UBIN HALF UNAL,
      198     2320    1         2 UC(0:200),
      199     2321    1           3 UCW_USE,
      200     2322    1             4 PT UBIN(9) UNAL,
      201     2323    1             4 STATUS_CODE UBIN(27) UNAL,
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:59   
      202     2324    1           3 UCW_PRV REDEF UCW_USE,
      203     2325    1             4 PT UBIN(9) UNAL,
      204     2326    1             4 PB BIT(9) UNAL,
      205     2327    1             4 A UBIN HALF UNAL,
      206     2328    1           3 ENT UBIN HALF UNAL,
      207     2329    1           3 MBZ UBIN HALF UNAL;
      208     2330
      209     2331    1   DCL RVA_TYPE(0:0) UBIN(%RVA_TYPE_BITS) UNAL BASED(TYPE$);
      210     2332         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:60   
      211     2333        /******************************************************************/
      212     2334        /*                                                                */
      213     2335        /*     EVERY CALL GOES HERE FIRST TO SETUP A ARRAY OF ARG_TYPE    */
      214     2336        /*                                                                */
      215     2337        /******************************************************************/
      216     2338    1   SET_ARGS: PROC;

   2338  3 000003   200010 741300       SET_ARGS     STX1  ! @A+1,,AUTO

      217     2339
      218     2340    3       DO I=1 TO PARAMS(0);

   2340  3 000004   000001 235007                    LDA     1,DL
         3 000005   000055 755000 0                  STA     I
         3 000006   000057 710000 3                  TRA     s:2345+1

      219     2341    3           IF ZII$PARAMS.OFFSET(I)=0 THEN

   2341  3 000007   000055 720000 0                  LXL0    I
         3 000010   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 000011   000033 601000 3                  TNZ     s:2344

      220     2342    3               TYPE_OF_ARG(I)=PARAMS(I);

   2342  3 000012   000055 236000 0                  LDQ     I
         3 000013   000044 402007                    MPY     36,DL
         3 000014   000000 116003                    CMPQ    0,DU
         3 000015   000017 605000 3                  TPL     s:2342+5
         3 000016   000044 036003                    ADLQ    36,DU
         3 000017   200014 756100                    STQ     @N+2,,AUTO
         3 000020   000055 236000 0                  LDQ     I
         3 000021   000011 402007                    MPY     9,DL
         3 000022   000000 116003                    CMPQ    0,DU
         3 000023   000025 605000 3                  TPL     s:2342+11
         3 000024   000044 036003                    ADLQ    36,DU
         3 000025   200014 235100                    LDA     @N+2,,AUTO
         3 000026   000051 470400 0                  LDP0    ARG$
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:61   
         3 000027   003106 061405                    CSR     bolr='003'O
         3 000030   000017 000044 0                  BDSC    ZII$PARAMS,A             by=0,bit=0,n=36
         3 000031   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 000032   000056 710000 3                  TRA     s:2345

      221     2343    3           ELSE
      222     2344    3               TYPE_OF_ARG(I)=RVA_TYPE(ZII$PARAMS.OFFSET(I))+%AREA_NAME;

   2344  3 000033   000017 236010 0                  LDQ     ZII$PARAMS,X0
         3 000034   000021 772000                    QRL     17
         3 000035   000000 376000 4                  ANQ     0
         3 000036   000054 470400 0                  LDP0    TYPE$
         3 000037   003100 061506                    CSR     bolr='003'O
         3 000040   000000 000002                    BDSC    0,Q,PR0                  by=0,bit=0,n=2
         3 000041   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 000042   200015 236100                    LDQ     @N+3,,AUTO
         3 000043   000002 036007                    ADLQ    2,DL
         3 000044   200014 756100                    STQ     @N+2,,AUTO
         3 000045   000055 236000 0                  LDQ     I
         3 000046   000011 402007                    MPY     9,DL
         3 000047   000000 116003                    CMPQ    0,DU
         3 000050   000052 605000 3                  TPL     s:2344+15
         3 000051   000044 036003                    ADLQ    36,DU
         3 000052   000051 471400 0                  LDP1    ARG$
         3 000053   003106 061500                    CSR     bolr='003'O
         3 000054   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000055   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9

      223     2345    3           END;

   2345  3 000056   000055 054000 0                  AOS     I
         3 000057   000055 236000 0                  LDQ     I
         3 000060   000017 116000 0                  CMPQ    ZII$PARAMS
         3 000061   000007 604400 3                  TMOZ    s:2341

      224     2346    2   END SET_ARGS;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:62   
   2346  3 000062   200010 221300                    LDX1  ! @A+1,,AUTO
         3 000063   000001 702211                    TSX2  ! 1,X1

      225     2347        /****************************************************************/
      226     2348        /*                                                              */
      227     2349        /*    GET A PAGE OF DYNAMIC MEMORY AT THE VERY 1ST IDS CALL     */
      228     2350        /*                                                              */
      229     2351        /****************************************************************/
      230     2352    1   GET_A_PAGE: PROC ALTRET;

   2352  3 000064   200006 741300       GET_A_PAGE   STX1  ! @A3+1,,AUTO

      231     2353
      232     2354    2       CALL M$GDP(FPT_GDP) ALTRET(OUT_OF_MEMORY);

   2354  3 000065   000010 630400 1                  EPPR0   FPT_GDP
         3 000066   430003 713400                    CLIMB   alt,+12291
         3 000067   400400 401760                    pmme    nvectors=2
         3 000070   000104 702000 3                  TSX2    OUT_OF_MEMORY

      233     2355    2       FPT$=PAGE_VECTOR.ADR;

   2355  3 000071   000071 236000 0                  LDQ     PAGE_VECTOR+1
         3 000072   000052 756000 0                  STQ     FPT$

      234     2356    2       ARG$=ADDR(FPT.V.FPARA(0));

   2356  3 000073   000023 036003                    ADLQ    19,DU
         3 000074   000051 756000 0                  STQ     ARG$

      235     2357    2       RLCW$=PINCRW(FPT$,%FPT_SIZE);

   2357  3 000075   000052 236000 0                  LDQ     FPT$
         3 000076   000074 036003                    ADLQ    60,DU
         3 000077   000053 756000 0                  STQ     RLCW$

      236     2358    2       TYPE$=PINCRW(RLCW$,%RLCW_SIZE);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:63   

   2358  3 000100   000013 036003                    ADLQ    11,DU
         3 000101   000054 756000 0                  STQ     TYPE$

      237     2359    2       RETURN;

   2359  3 000102   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 000103   000001 702211                    TSX2  ! 1,X1

      238     2360    2   OUT_OF_MEMORY: ALTRETURN;

   2360  3 000104   200006 221300       OUT_OF_MEMO* LDX1  ! @A3+1,,AUTO
         3 000105   000000 702211                    TSX2  ! 0,X1
         3 000106   000111 710000 3                  TRA     s:2373

      239     2361    2   END GET_A_PAGE;
      240     2362         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:64   
      241     2363        /**************************************************************/
      242     2364        /*                                                            */
      243     2365        /*    CALL INVOKE(IA,UWA,RVA)                                 */
      244     2366        /*                                                            */
      245     2367        /*    1. REMEMBER UWA$ AND RVA$.  2.  DO A CLIMB TO 'HIA'     */
      246     2368        /*                                                            */
      247     2369        /**************************************************************/
      248     2370
      249     2371    1   ZII$INVOKE: ENTRY(A1,A2,A3) ALTRET;

   2371  3 000107   000000 700200 xent  ZII$INVOKE   TSX0  ! X66_AUTO_3
         3 000110   000020 000003                    ZERO    16,3

      250     2372
      251     2373    1       IA$ = VBASE(A1);

   2373  3 000111   200003 470500                    LDP0    @A1,,AUTO
         3 000112   000001 236100                    LDQ     1,,PR0
         3 000113   000045 756000 0                  STQ     IA$

      252     2374    1       UWA$ = VBASE(A2);

   2374  3 000114   200004 471500                    LDP1    @A2,,AUTO
         3 000115   100001 236100                    LDQ     1,,PR1
         3 000116   000046 756000 0                  STQ     UWA$

      253     2375    1       RVA$ = VBASE(A3);

   2375  3 000117   200005 473500                    LDP3    @A3,,AUTO
         3 000120   300001 236100                    LDQ     1,,PR3
         3 000121   000047 756000 0                  STQ     RVA$

      254     2376    1       IF RVA_HALF(0)>0 THEN /* FIRST INVOKE CALL */

   2376  3 000122   000047 474400 0                  LDP4    RVA$
         3 000123   003100 060500                    CSL     bolr='003'O
         3 000124   400000 000022                    BDSC    0,,PR4                   by=0,bit=0,n=18
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:65   
         3 000125   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000126   200014 236100                    LDQ     @N+2,,AUTO
         3 000127   000022 732000                    QRS     18
         3 000130   000000 116003                    CMPQ    0,DU
         3 000131   000273 604400 3                  TMOZ    s:2411

      255     2377    2       DO;

      256     2378    2           IF PAGE_VECTOR.ADR=ADDR(NIL) THEN

   2378  3 000132   000071 236000 0                  LDQ     PAGE_VECTOR+1
         3 000133   000001 116000 4                  CMPQ    1
         3 000134   000137 601000 3                  TNZ     s:2380

      257     2379    2               CALL GET_A_PAGE ALTRET(OUT_OF_MEMORY);

   2379  3 000135   000064 701000 3                  TSX1    GET_A_PAGE
         3 000136   000277 702000 3                  TSX2    OUT_OF_MEMORY

      258     2380    2           RVA_SIZE=RVA_HALF(0);

   2380  3 000137   000047 470400 0                  LDP0    RVA$
         3 000140   003100 060500                    CSL     bolr='003'O
         3 000141   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         3 000142   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000143   200014 236100                    LDQ     @N+2,,AUTO
         3 000144   000022 732000                    QRS     18
         3 000145   000065 756000 0                  STQ     RVA_SIZE

      259     2381    3           DO I=1 TO RVA_SIZE; /* REMEMBER ALL TYPES */

   2381  3 000146   000001 235007                    LDA     1,DL
         3 000147   000055 755000 0                  STA     I
         3 000150   000206 710000 3                  TRA     s:2384+1

      260     2382    3               RVA_TYPE(I)=RVA_HALF(2*I);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:66   
   2382  3 000151   000055 236000 0                  LDQ     I
         3 000152   000044 402007                    MPY     36,DL
         3 000153   000000 116003                    CMPQ    0,DU
         3 000154   000156 605000 3                  TPL     s:2382+5
         3 000155   000044 036003                    ADLQ    36,DU
         3 000156   000055 235000 0                  LDA     I
         3 000157   000001 735000                    ALS     1
         3 000160   000162 605000 3                  TPL     s:2382+9
         3 000161   000044 035003                    ADLA    36,DU
         3 000162   000047 470400 0                  LDP0    RVA$
         3 000163   000054 471400 0                  LDP1    TYPE$
         3 000164   003105 061506                    CSR     bolr='003'O
         3 000165   000000 000022                    BDSC    0,Q,PR0                  by=0,bit=0,n=18
         3 000166   100000 000002                    BDSC    0,A,PR1                  by=0,bit=0,n=2

      261     2383    3               IF RVA_HALF(2*I)=4 THEN NULL_OFFSET=I;

   2383  3 000167   000055 236000 0                  LDQ     I
         3 000170   000044 402007                    MPY     36,DL
         3 000171   000000 116003                    CMPQ    0,DU
         3 000172   000174 605000 3                  TPL     s:2383+5
         3 000173   000044 036003                    ADLQ    36,DU
         3 000174   003100 060506                    CSL     bolr='003'O
         3 000175   000000 000022                    BDSC    0,Q,PR0                  by=0,bit=0,n=18
         3 000176   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000177   200014 236100                    LDQ     @N+2,,AUTO
         3 000200   000022 732000                    QRS     18
         3 000201   000004 116007                    CMPQ    4,DL
         3 000202   000205 601000 3                  TNZ     s:2384

   2383  3 000203   000055 235000 0                  LDA     I
         3 000204   000064 755000 0                  STA     NULL_OFFSET

      262     2384    3               END;

   2384  3 000205   000055 054000 0                  AOS     I
         3 000206   000055 236000 0                  LDQ     I
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:67   
         3 000207   000065 116000 0                  CMPQ    RVA_SIZE
         3 000210   000151 604400 3                  TMOZ    s:2382

      263     2385    2           FPT.V_=VECTOR(FPT.V);

   2385  3 000211   000002 235000 4                  LDA     2
         3 000212   000052 236000 0                  LDQ     FPT$
         3 000213   000012 036003                    ADLQ    10,DU
         3 000214   000052 471400 0                  LDP1    FPT$
         3 000215   100000 757100                    STAQ    0,,PR1

      264     2386    2           FPT.IA_=A1;

   2386  3 000216   200003 473500                    LDP3    @A1,,AUTO
         3 000217   300000 237100                    LDAQ    0,,PR3
         3 000220   100002 757100                    STAQ    2,,PR1

      265     2387    2           FPT.UWA_=A2;

   2387  3 000221   200004 474500                    LDP4    @A2,,AUTO
         3 000222   400000 237100                    LDAQ    0,,PR4
         3 000223   100004 757100                    STAQ    4,,PR1

      266     2388    2           FPT.RVA_=A3;

   2388  3 000224   200005 470500                    LDP0    @A3,,AUTO
         3 000225   000000 237100                    LDAQ    0,,PR0
         3 000226   100006 757100                    STAQ    6,,PR1

      267     2389    2           IPT_CHK.IA_=A1;

   2389  3 000227   300000 237100                    LDAQ    0,,PR3
         3 000230   000102 757000 0                  STAQ    IPT_CHK+2

      268     2390    2           IPT_ROL.IA_=A1;

   2390  3 000231   300000 237100                    LDAQ    0,,PR3
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:68   
         3 000232   000112 757000 0                  STAQ    IPT_ROL+2

      269     2391    2           IPT_CHK.ERROR_=VECTOR(PINCRC(UWA$,1)->CHAR7);

   2391  3 000233   000003 235000 4                  LDA     3
         3 000234   000046 236000 0                  LDQ     UWA$
         3 000235   200000 036007                    ADLQ    65536,DL
         3 000236   000100 757000 0                  STAQ    IPT_CHK

      270     2392    2           IPT_ROL.ERROR_=IPT_CHK.ERROR_;

   2392  3 000237   000100 237000 0                  LDAQ    IPT_CHK
         3 000240   000110 757000 0                  STAQ    IPT_ROL

      271     2393    2           I=%FPT_SIZE+%RLCW_SIZE+RVA_SIZE/(36/%RVA_TYPE_BITS)+1;

   2393  3 000241   000065 236000 0                  LDQ     RVA_SIZE
         3 000242   000022 506007                    DIV     18,DL
         3 000243   000110 036007                    ADLQ    72,DL
         3 000244   000055 756000 0                  STQ     I

      272     2394    2           IF MOD(I,2)=0 THEN

   2394  3 000245   000002 506007                    DIV     2,DL
         3 000246   000044 733000                    LRS     36
         3 000247   000000 116003                    CMPQ    0,DU
         3 000250   000256 601000 3                  TNZ     s:2397

      273     2395    2               USEP$=PINCRW(FPT$,I);

   2395  3 000251   000055 236000 0                  LDQ     I
         3 000252   000022 736000                    QLS     18
         3 000253   000052 036000 0                  ADLQ    FPT$
         3 000254   000050 756000 0                  STQ     USEP$
         3 000255   000262 710000 3                  TRA     s:2398

      274     2396    2           ELSE /* TO MAKE SURE USEP$ IS DALIGNED */
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:69   
      275     2397    2               USEP$=PINCRW(FPT$,I);

   2397  3 000256   000055 236000 0                  LDQ     I
         3 000257   000022 736000                    QLS     18
         3 000260   000052 036000 0                  ADLQ    FPT$
         3 000261   000050 756000 0                  STQ     USEP$

      276     2398    2           FPT.USEP_=VECTOR(USEP);

   2398  3 000262   000004 235000 4                  LDA     4
         3 000263   100010 757100                    STAQ    8,,PR1

      277     2399    2           USEP.FLAG='0'B;

   2399  3 000264   000050 470400 0                  LDP0    USEP$
         3 000265   000005 236000 4                  LDQ     5
         3 000266   000000 356100                    ANSQ    0,,PR0

      278     2400    2           USEP.M=0;

   2400  3 000267   000006 236000 4                  LDQ     6
         3 000270   000000 356100                    ANSQ    0,,PR0

      279     2401    2           KEY_COUNT=1024/3;

   2401  3 000271   000525 235007                    LDA     341,DL
         3 000272   000066 755000 0                  STA     KEY_COUNT

      280     2402    2           END;

      281     2403            %CLIMB(FCN=HIA);

   2411  3 000273   000052 470400 0                  LDP0    FPT$
         3 000274   000000 713400 xsym               CLIMB   I$HIA
         3 000275   402000 600000 xsid               climb   nvectors=         5

      282     2417    1       GOTO COMMON_RETURN;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:70   

   2417  3 000276   004370 710000 3                  TRA     COMMON_RETURN

      283     2418
      284     2419    1   OUT_OF_MEMORY: ALTRETURN;

   2419  3 000277   000000 702200 xent  OUT_OF_MEMO* TSX2  ! X66_AALT

      285     2420        %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:71   
      286     2421        /****************************************************************/
      287     2422        /*                                                              */
      288     2423        /*    CALL RETAIN( AREA                               )         */
      289     2424        /*                 SETS                                         */
      290     2425        /*                 RECORD                                       */
      291     2426        /*                 SET-NAME1,SET-NAME2,.....                    */
      292     2427        /*                                                              */
      293     2428        /*         1.  SAVE RETAINING CONTROL LIST.                     */
      294     2429        /*         2.  SET SWITCH ON, RETAINING LIST WILL BE USED ON    */
      295     2430        /*             NEXT IDS CALL WITH RETAIN CURRENCY OPTION        */
      296     2431        /*                                                              */
      297     2432        /****************************************************************/
      298     2433
      299     2434    1   ZII$RETAIN: ENTRY ALTRET;

   2434  3 000300   000000 700200 xent  ZII$RETAIN   TSX0  ! X66_AUTO_3
         3 000301   000020 000003                    ZERO    16,3

      300     2435
      301     2436    1       CALL SET_ARGS;

   2436  3 000302   000003 701000 3                  TSX1    SET_ARGS
         3 000303   000000 011000                    NOP     0

      302     2437    1       ADDR(RLCW_SAVE)->SBIN36=0;

   2437  3 000304   000053 470400 0                  LDP0    RLCW$
         3 000305   000000 450100                    STZ     0,,PR0

      303     2438    1       IF PARAMS(1)=%CURRENCY AND PARAMS(2)=%FOR THEN

   2438  3 000306   000020 235000 0                  LDA     ZII$PARAMS+1
         3 000307   000012 115007                    CMPA    10,DL
         3 000310   000317 601000 3                  TNZ     s:2441
         3 000311   000021 236000 0                  LDQ     ZII$PARAMS+2
         3 000312   000042 116007                    CMPQ    34,DL
         3 000313   000317 601000 3                  TNZ     s:2441
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:72   

      304     2439    1           K=3;

   2439  3 000314   000003 235007                    LDA     3,DL
         3 000315   000057 755000 0                  STA     K
         3 000316   000326 710000 3                  TRA     s:2445

      305     2440    1       ELSE
      306     2441    1           IF PARAMS(1)=%CURRENCY THEN

   2441  3 000317   000012 115007                    CMPA    10,DL
         3 000320   000324 601000 3                  TNZ     s:2444

      307     2442    1               K=2;

   2442  3 000321   000002 236007                    LDQ     2,DL
         3 000322   000057 756000 0                  STQ     K
         3 000323   000326 710000 3                  TRA     s:2445

      308     2443    1           ELSE
      309     2444    1               K=1;

   2444  3 000324   000001 236007                    LDQ     1,DL
         3 000325   000057 756000 0                  STQ     K

      310     2445    2       DO WHILE (K<=PARAMS(0));

   2445  3 000326   000057 236000 0                  LDQ     K
         3 000327   000017 116000 0                  CMPQ    ZII$PARAMS
         3 000330   000472 605400 3                  TPNZ    s:2464

      311     2446    2           IF TYPE_OF_ARG(K)=%SET_NAME THEN

   2446  3 000331   000057 236000 0                  LDQ     K
         3 000332   000011 402007                    MPY     9,DL
         3 000333   000000 116003                    CMPQ    0,DU
         3 000334   000336 605000 3                  TPL     s:2446+5
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:73   
         3 000335   000044 036003                    ADLQ    36,DU
         3 000336   000051 470400 0                  LDP0    ARG$
         3 000337   003100 060506                    CSL     bolr='003'O
         3 000340   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 000341   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000342   200014 236100                    LDQ     @N+2,,AUTO
         3 000343   000033 732000                    QRS     27
         3 000344   000003 116007                    CMPQ    3,DL
         3 000345   000402 601000 3                  TNZ     s:2452

      312     2447    3           DO;

      313     2448    3               RLCW_SAVE.RETAIN_LIST(RLCW_SAVE.N_SETS#)=ZII$PARAMS.OFFSET(K);

   2448  3 000346   000053 471400 0                  LDP1    RLCW$
         3 000347   003100 061500                    CSR     bolr='003'O
         3 000350   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         3 000351   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000352   200014 236100                    LDQ     @N+2,,AUTO
         3 000353   200015 756100                    STQ     @N+3,,AUTO
         3 000354   000057 236000 0                  LDQ     K
         3 000355   000044 402007                    MPY     36,DL
         3 000356   000000 116003                    CMPQ    0,DU
         3 000357   000361 605000 3                  TPL     s:2448+11
         3 000360   000044 036003                    ADLQ    36,DU
         3 000361   200016 756100                    STQ     @N+4,,AUTO
         3 000362   200015 236100                    LDQ     @N+3,,AUTO
         3 000363   000022 402007                    MPY     18,DL
         3 000364   200016 235100                    LDA     @N+4,,AUTO
         3 000365   003106 060405                    CSL     bolr='003'O
         3 000366   000017 000022 0                  BDSC    ZII$PARAMS,A             by=0,bit=0,n=18
         3 000367   100001 000022                    BDSC    1,Q,PR1                  by=0,bit=0,n=18

      314     2449    3               RLCW_SAVE.N_SETS#=RLCW_SAVE.N_SETS#+1;

   2449  3 000370   003100 061500                    CSR     bolr='003'O
         3 000371   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:74   
         3 000372   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 000373   200015 236100                    LDQ     @N+3,,AUTO
         3 000374   000001 036007                    ADLQ    1,DL
         3 000375   200014 756100                    STQ     @N+2,,AUTO
         3 000376   003100 061500                    CSR     bolr='003'O
         3 000377   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000400   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8

      315     2450    3               END;

   2450  3 000401   000466 710000 3                  TRA     s:2462

      316     2451    2           ELSE
      317     2452    2               IF TYPE_OF_ARG(K)=%REALM THEN

   2452  3 000402   000057 236000 0                  LDQ     K
         3 000403   000011 402007                    MPY     9,DL
         3 000404   000000 116003                    CMPQ    0,DU
         3 000405   000407 605000 3                  TPL     s:2452+5
         3 000406   000044 036003                    ADLQ    36,DU
         3 000407   003100 060506                    CSL     bolr='003'O
         3 000410   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 000411   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000412   200014 236100                    LDQ     @N+2,,AUTO
         3 000413   000033 732000                    QRS     27
         3 000414   000011 116007                    CMPQ    9,DL
         3 000415   000423 601000 3                  TNZ     s:2455

      318     2453    2                   RLCW_SAVE.AC_INDICATORS='1'B;

   2453  3 000416   000053 471400 0                  LDP1    RLCW$
         3 000417   003100 060400                    CSL     bolr='003'O
         3 000420   000007 000001 4                  BDSC    7                        by=0,bit=0,n=1
         3 000421   100000 400001                    BDSC    0,,PR1                   by=2,bit=0,n=1
         3 000422   000466 710000 3                  TRA     s:2462

      319     2454    2               ELSE
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:75   
      320     2455    2                   IF TYPE_OF_ARG(K)=%SETS THEN

   2455  3 000423   000057 236000 0                  LDQ     K
         3 000424   000011 402007                    MPY     9,DL
         3 000425   000000 116003                    CMPQ    0,DU
         3 000426   000430 605000 3                  TPL     s:2455+5
         3 000427   000044 036003                    ADLQ    36,DU
         3 000430   003100 060506                    CSL     bolr='003'O
         3 000431   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 000432   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000433   200014 236100                    LDQ     @N+2,,AUTO
         3 000434   000033 732000                    QRS     27
         3 000435   000033 116007                    CMPQ    27,DL
         3 000436   000444 601000 3                  TNZ     s:2458

      321     2456    2                       RLCW_SAVE.SC_INDICATORS='1'B;

   2456  3 000437   000053 471400 0                  LDP1    RLCW$
         3 000440   003100 060400                    CSL     bolr='003'O
         3 000441   000007 000001 4                  BDSC    7                        by=0,bit=0,n=1
         3 000442   100000 410001                    BDSC    0,,PR1                   by=2,bit=1,n=1
         3 000443   000466 710000 3                  TRA     s:2462

      322     2457    2                   ELSE
      323     2458    2                       IF TYPE_OF_ARG(K)=%RECORD THEN

   2458  3 000444   000057 236000 0                  LDQ     K
         3 000445   000011 402007                    MPY     9,DL
         3 000446   000000 116003                    CMPQ    0,DU
         3 000447   000451 605000 3                  TPL     s:2458+5
         3 000450   000044 036003                    ADLQ    36,DU
         3 000451   003100 060506                    CSL     bolr='003'O
         3 000452   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 000453   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000454   200014 236100                    LDQ     @N+2,,AUTO
         3 000455   000033 732000                    QRS     27
         3 000456   000030 116007                    CMPQ    24,DL
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:76   
         3 000457   000465 601000 3                  TNZ     s:2461

      324     2459    2                           RLCW_SAVE.RC_INDICATORS='1'B;

   2459  3 000460   000053 471400 0                  LDP1    RLCW$
         3 000461   003100 060400                    CSL     bolr='003'O
         3 000462   000007 000001 4                  BDSC    7                        by=0,bit=0,n=1
         3 000463   100000 420001                    BDSC    0,,PR1                   by=2,bit=2,n=1
         3 000464   000466 710000 3                  TRA     s:2462

      325     2460    2                       ELSE
      326     2461    2                           ALTRETURN;

   2461  3 000465   000000 702200 xent               TSX2  ! X66_AALT

      327     2462    2           K=K+1;

   2462  3 000466   000057 054000 0                  AOS     K

      328     2463    2           END;

   2463  3 000467   000057 236000 0                  LDQ     K
         3 000470   000017 116000 0                  CMPQ    ZII$PARAMS
         3 000471   000331 604400 3                  TMOZ    s:2446

      329     2464    1       RETAIN_SWITCH=%ON;

   2464  3 000472   000001 235007                    LDA     1,DL
         3 000473   000067 755000 0                  STA     RETAIN_SWITCH

      330     2465    1       RETURN;

   2465  3 000474   000000 702200 xent               TSX2  ! X66_ARET

      331     2466
      332     2467        /**   INTERNAL SUBROUTINE TO SETUP RETAIN CONTROL LIST   **/
      333     2468
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:77   
      334     2469    1   CHK_RETAIN: PROC(RLCW,N);

   2469  3 000475   200010 741300       CHK_RETAIN   STX1  ! @A+1,,AUTO

      335     2470
      336     2471    2   DCL 1 RLCW,
      337     2472    2         2 FLAGS SBIN WORD,
      338     2473    2         2 RETAIN_LIST (0:0),
      339     2474    2           3 OFFSET UBIN HALF UNAL,
      340     2475    2           3 * UBIN HALF UNAL;
      341     2476    2   DCL N UBIN HALF UNAL;
      342     2477
      343     2478    2       IF RETAIN_SWITCH=%OFF THEN

   2478  3 000476   000067 235000 0                  LDA     RETAIN_SWITCH
         3 000477   000503 601000 3                  TNZ     s:2482

      344     2479    2           RLCW.FLAGS=0;

   2479  3 000500   200011 470500                    LDP0    @RLCW,,AUTO
         3 000501   000000 450100                    STZ     0,,PR0
         3 000502   000561 710000 3                  TRA     s:2488

      345     2480    2       ELSE
      346     2481    3       DO;

      347     2482    3           RETAIN_SWITCH=%OFF;

   2482  3 000503   000067 450000 0                  STZ     RETAIN_SWITCH

      348     2483    3           RLCW.FLAGS=ADDR(RLCW_SAVE)->SBIN36;

   2483  3 000504   000053 470400 0                  LDP0    RLCW$
         3 000505   200011 471500                    LDP1    @RLCW,,AUTO
         3 000506   000000 235100                    LDA     0,,PR0
         3 000507   100000 755100                    STA     0,,PR1

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:78   
      349     2484    4           DO J=N TO RLCW_SAVE.N_SETS#+N-1;

   2484  3 000510   200012 473500                    LDP3    @N,,AUTO
         3 000511   003000 061500                    CSR     bolr='003'O
         3 000512   300000 000022                    BDSC    0,,PR3                   by=0,bit=0,n=18
         3 000513   000056 000044 0                  BDSC    J                        by=0,bit=0,n=36
         3 000514   000544 710000 3                  TRA     s:2486+1

      350     2485    4               RLCW.RETAIN_LIST.OFFSET(J)=RLCW_SAVE.RETAIN_LIST(J-N);

   2485  3 000515   200012 470500                    LDP0    @N,,AUTO
         3 000516   003100 061500                    CSR     bolr='003'O
         3 000517   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         3 000520   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000521   000056 236000 0                  LDQ     J
         3 000522   200014 136100                    SBLQ    @N+2,,AUTO
         3 000523   000022 402007                    MPY     18,DL
         3 000524   000000 116003                    CMPQ    0,DU
         3 000525   000527 605000 3                  TPL     s:2485+10
         3 000526   000044 036003                    ADLQ    36,DU
         3 000527   200015 756100                    STQ     @N+3,,AUTO
         3 000530   000056 236000 0                  LDQ     J
         3 000531   000044 402007                    MPY     36,DL
         3 000532   000000 116003                    CMPQ    0,DU
         3 000533   000535 605000 3                  TPL     s:2485+16
         3 000534   000044 036003                    ADLQ    36,DU
         3 000535   000053 471400 0                  LDP1    RLCW$
         3 000536   200015 235100                    LDA     @N+3,,AUTO
         3 000537   200011 473500                    LDP3    @RLCW,,AUTO
         3 000540   003106 060505                    CSL     bolr='003'O
         3 000541   100001 000022                    BDSC    1,A,PR1                  by=0,bit=0,n=18
         3 000542   300001 000022                    BDSC    1,Q,PR3                  by=0,bit=0,n=18

      351     2486    4               END;

   2486  3 000543   000056 054000 0                  AOS     J
         3 000544   200012 470500                    LDP0    @N,,AUTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:79   
         3 000545   003100 061500                    CSR     bolr='003'O
         3 000546   000000 000022                    BDSC    0,,PR0                   by=0,bit=0,n=18
         3 000547   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000550   000053 471400 0                  LDP1    RLCW$
         3 000551   003100 061500                    CSR     bolr='003'O
         3 000552   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         3 000553   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 000554   200015 236100                    LDQ     @N+3,,AUTO
         3 000555   200014 036100                    ADLQ    @N+2,,AUTO
         3 000556   000515 604000 3                  TMI     s:2485
         3 000557   000056 116000 0                  CMPQ    J
         3 000560   000515 605400 3                  TPNZ    s:2485

      352     2487    3           END;

      353     2488    2   END CHK_RETAIN;

   2488  3 000561   200010 221300                    LDX1  ! @A+1,,AUTO
         3 000562   000001 702211                    TSX2  ! 1,X1

      354     2489         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:80   
      355     2490        /**************************************************************/
      356     2491        /*                                                            */
      357     2492        /*    CALL READY([AREA-1[,AREA-2[,....]],FUN-OPT,[MODE-OPT])  */
      358     2493        /*                                                            */
      359     2494        /*    FUN-OPT: LOAD, UPDATE, OR RETRIEVAL                     */
      360     2495        /*    MODE-OPT: SHAREALL,NOSHARE, SHAREANY, OR SHAREIN.          */
      361     2496        /*                                                            */
      362     2497        /**************************************************************/
      363     2498
      364     2499    1   ZII$READY: ENTRY ALTRET;

   2499  3 000563   000000 700200 xent  ZII$READY    TSX0  ! X66_AUTO_3
         3 000564   000020 000003                    ZERO    16,3

      365     2500
      366     2501    1       CALL SET_ARGS;

   2501  3 000565   000003 701000 3                  TSX1    SET_ARGS
         3 000566   000000 011000                    NOP     0

      367     2502    1       J=2;

   2502  3 000567   000002 235007                    LDA     2,DL
         3 000570   000056 755000 0                  STA     J

      368     2503    1       I=PARAMS(PARAMS(0));

   2503  3 000571   000017 720000 0                  LXL0    ZII$PARAMS
         3 000572   000017 235010 0                  LDA     ZII$PARAMS,X0
         3 000573   000055 755000 0                  STA     I

      369     2504    1       IF I=%NOSHARE THEN

   2504  3 000574   000024 115007                    CMPA    20,DL
         3 000575   000601 601000 3                  TNZ     s:2520

      370     2505                %CLIMB(FCN=SHNO,PARAMS=0);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:81   

   2516  3 000576   000000 713400 xsym               CLIMB   I$SHNO
         3 000577   000000 600000 xsid               climb   nvectors=         0
         3 000600   000634 710000 3                  TRA     s:2602

      371     2519    1       ELSE
      372     2520    1           IF I=%SHAREALL THEN

   2520  3 000601   000034 115007                    CMPA    28,DL
         3 000602   000606 601000 3                  TNZ     s:2536

      373     2521                    %CLIMB(FCN=SHALL,PARAMS=0);

   2532  3 000603   000000 713400 xsym               CLIMB   I$SHALL
         3 000604   000000 600000 xsid               climb   nvectors=         0
         3 000605   000634 710000 3                  TRA     s:2602

      374     2535    1           ELSE
      375     2536    1               IF I=%SHAREIN THEN

   2536  3 000606   000036 115007                    CMPA    30,DL
         3 000607   000613 601000 3                  TNZ     s:2552

      376     2537                        %CLIMB(FCN=SHIN,PARAMS=0);

   2548  3 000610   000000 713400 xsym               CLIMB   I$SHIN
         3 000611   000000 600000 xsid               climb   nvectors=         0
         3 000612   000634 710000 3                  TRA     s:2602

      377     2551    1               ELSE
      378     2552    1                   IF I=%SHAREANY THEN

   2552  3 000613   000035 115007                    CMPA    29,DL
         3 000614   000620 601000 3                  TNZ     s:2568

      379     2553                            %CLIMB(FCN=SHANY,PARAMS=0);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:82   
   2564  3 000615   000000 713400 xsym               CLIMB   I$SHANY
         3 000616   000000 600000 xsid               climb   nvectors=         0
         3 000617   000634 710000 3                  TRA     s:2602

      380     2567    1                   ELSE
      381     2568    1                       IF I=%SHARECUR THEN

   2568  3 000620   000060 115007                    CMPA    48,DL
         3 000621   000625 601000 3                  TNZ     s:2584

      382     2569                                %CLIMB(FCN=SHCUR,PARAMS=0);

   2580  3 000622   000000 713400 xsym               CLIMB   I$SHCUR
         3 000623   000000 600000 xsid               climb   nvectors=         0
         3 000624   000634 710000 3                  TRA     s:2602

      383     2583    1                       ELSE
      384     2584    1                           IF I=%SHAREINCUR THEN

   2584  3 000625   000061 115007                    CMPA    49,DL
         3 000626   000632 601000 3                  TNZ     s:2600

      385     2585                                    %CLIMB(FCN=SHINCUR,PARAMS=0);

   2596  3 000627   000000 713400 xsym               CLIMB   I$SHINCUR
         3 000630   000000 600000 xsid               climb   nvectors=         0
         3 000631   000634 710000 3                  TRA     s:2602

      386     2599    1                           ELSE
      387     2600    1                               J=1;

   2600  3 000632   000001 236007                    LDQ     1,DL
         3 000633   000056 756000 0                  STQ     J

      388     2601
      389     2602    1       ADDR(IPT_RDY.V.RDCW)->SBIN36=0;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:83   
   2602  3 000634   000052 470400 0                  LDP0    FPT$
         3 000635   000012 450100                    STZ     10,,PR0

      390     2603    1       I=PARAMS(PARAMS(0)-J+1);

   2603  3 000636   000017 236000 0                  LDQ     ZII$PARAMS
         3 000637   000056 136000 0                  SBLQ    J
         3 000640   000020 235006 0                  LDA     ZII$PARAMS+1,QL
         3 000641   000055 755000 0                  STA     I

      391     2604
      392     2605    1       IF I=%UPDATE THEN

   2605  3 000642   000037 115007                    CMPA    31,DL
         3 000643   000651 601000 3                  TNZ     s:2608

      393     2606    1           IPT_RDY.V.RDCW.READY_OPTION#='010'B;

   2606  3 000644   000012 236100                    LDQ     10,,PR0
         3 000645   000010 376000 4                  ANQ     8
         3 000646   000010 276003                    ORQ     8,DU
         3 000647   000012 756100                    STQ     10,,PR0
         3 000650   000674 710000 3                  TRA     s:2619

      394     2607    1       ELSE
      395     2608    1           IF I=%RETRIEVAL THEN

   2608  3 000651   000031 115007                    CMPA    25,DL
         3 000652   000660 601000 3                  TNZ     s:2611

      396     2609    1               IPT_RDY.V.RDCW.READY_OPTION#='100'B;

   2609  3 000653   000012 236100                    LDQ     10,,PR0
         3 000654   000010 376000 4                  ANQ     8
         3 000655   000020 276003                    ORQ     16,DU
         3 000656   000012 756100                    STQ     10,,PR0
         3 000657   000674 710000 3                  TRA     s:2619
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:84   

      397     2610    1           ELSE
      398     2611    1               IF I=%LOAD THEN

   2611  3 000660   000022 115007                    CMPA    18,DL
         3 000661   000667 601000 3                  TNZ     s:2615

      399     2612    1                   IPT_RDY.V.RDCW.READY_OPTION#='001'B;

   2612  3 000662   000012 236100                    LDQ     10,,PR0
         3 000663   000010 376000 4                  ANQ     8
         3 000664   000004 276003                    ORQ     4,DU
         3 000665   000012 756100                    STQ     10,,PR0
         3 000666   000674 710000 3                  TRA     s:2619

      400     2613    1               ELSE
      401     2614    2               DO;

      402     2615    2                   IPT_RDY.V.RDCW.READY_OPTION#='100'B;

   2615  3 000667   000012 236100                    LDQ     10,,PR0
         3 000670   000010 376000 4                  ANQ     8
         3 000671   000020 276003                    ORQ     16,DU
         3 000672   000012 756100                    STQ     10,,PR0

      403     2616    2                   J=0; /* DEFAULT IS RETRIEVAL IS NO MODE GIVEN */

   2616  3 000673   000056 450000 0                  STZ     J

      404     2617    2                   END;

      405     2618
      406     2619    1       J=PARAMS(0)-J;

   2619  3 000674   000017 236000 0                  LDQ     ZII$PARAMS
         3 000675   000056 136000 0                  SBLQ    J
         3 000676   000056 756000 0                  STQ     J
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:85   

      407     2620    1       IF J > 0 AND TYPE_OF_ARG(J)=%IS THEN J=J-1;

   2620  3 000677   000716 604400 3                  TMOZ    s:2621
         3 000700   000011 402007                    MPY     9,DL
         3 000701   000000 116003                    CMPQ    0,DU
         3 000702   000704 605000 3                  TPL     s:2620+5
         3 000703   000044 036003                    ADLQ    36,DU
         3 000704   000051 471400 0                  LDP1    ARG$
         3 000705   003100 060506                    CSL     bolr='003'O
         3 000706   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9
         3 000707   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000710   200014 236100                    LDQ     @N+2,,AUTO
         3 000711   000033 732000                    QRS     27
         3 000712   000044 116007                    CMPQ    36,DL
         3 000713   000716 601000 3                  TNZ     s:2621

   2620  3 000714   000001 336007                    LCQ     1,DL
         3 000715   000056 056000 0                  ASQ     J

      408     2621    1       IF J > 0 AND TYPE_OF_ARG(J)=%USAGE THEN J=J-1;

   2621  3 000716   000056 235000 0                  LDA     J
         3 000717   000737 604400 3                  TMOZ    s:2622
         3 000720   000056 236000 0                  LDQ     J
         3 000721   000011 402007                    MPY     9,DL
         3 000722   000000 116003                    CMPQ    0,DU
         3 000723   000725 605000 3                  TPL     s:2621+7
         3 000724   000044 036003                    ADLQ    36,DU
         3 000725   000051 471400 0                  LDP1    ARG$
         3 000726   003100 060506                    CSL     bolr='003'O
         3 000727   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9
         3 000730   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000731   200014 236100                    LDQ     @N+2,,AUTO
         3 000732   000033 732000                    QRS     27
         3 000733   000050 116007                    CMPQ    40,DL
         3 000734   000737 601000 3                  TNZ     s:2622
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:86   

   2621  3 000735   000001 336007                    LCQ     1,DL
         3 000736   000056 056000 0                  ASQ     J

      409     2622    2       DO I=1 TO J;

   2622  3 000737   000001 235007                    LDA     1,DL
         3 000740   000055 755000 0                  STA     I
         3 000741   000765 710000 3                  TRA     s:2625+1

      410     2623    2           IF TYPE_OF_ARG(I)~=%AREA_NAME THEN ALTRETURN;

   2623  3 000742   000055 236000 0                  LDQ     I
         3 000743   000011 402007                    MPY     9,DL
         3 000744   000000 116003                    CMPQ    0,DU
         3 000745   000747 605000 3                  TPL     s:2623+5
         3 000746   000044 036003                    ADLQ    36,DU
         3 000747   000051 470400 0                  LDP0    ARG$
         3 000750   003100 060506                    CSL     bolr='003'O
         3 000751   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 000752   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 000753   200014 236100                    LDQ     @N+2,,AUTO
         3 000754   000033 732000                    QRS     27
         3 000755   000002 116007                    CMPQ    2,DL
         3 000756   000760 600000 3                  TZE     s:2624

   2623  3 000757   000000 702200 xent               TSX2  ! X66_AALT

      411     2624    2           IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#(I-1)=ZII$PARAMS.OFFSET(I);

   2624  3 000760   000055 720000 0                  LXL0    I
         3 000761   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 000762   000052 471400 0                  LDP1    FPT$
         3 000763   100012 741110                    STX1    10,X0,PR1

      412     2625    2           END;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:87   
   2625  3 000764   000055 054000 0                  AOS     I
         3 000765   000055 236000 0                  LDQ     I
         3 000766   000056 116000 0                  CMPQ    J
         3 000767   000742 604400 3                  TMOZ    s:2623

      413     2626    1       IPT_RDY.V.RDCW.AREAS_TO_READY#=J;

   2626  3 000770   000056 720000 0                  LXL0    J
         3 000771   000052 470400 0                  LDP0    FPT$
         3 000772   000012 440100                    SXL0    10,,PR0

      414     2627
      415     2628    1       IPT_RDY.V_ = VECTOR(IPT_RDY.V);

   2628  3 000773   000011 235000 4                  LDA     9
         3 000774   000052 236000 0                  LDQ     FPT$
         3 000775   000012 036003                    ADLQ    10,DU
         3 000776   000000 757100                    STAQ    0,,PR0

      416     2629    1       VBOUND(IPT_RDY.V_) = VBOUND(IPT_RDY.V_) + SIZEC(IPT_RDY.V.AC_OFFSETS) * I;

   2629  3 000777   000000 236100                    LDQ     0,,PR0
         3 001000   000020 772000                    QRL     16
         3 001001   200014 756100                    STQ     @N+2,,AUTO
         3 001002   000055 236000 0                  LDQ     I
         3 001003   000002 736000                    QLS     2
         3 001004   200014 036100                    ADLQ    @N+2,,AUTO
         3 001005   000020 736000                    QLS     16
         3 001006   000000 676100                    ERQ     0,,PR0
         3 001007   000012 376000 4                  ANQ     10
         3 001010   000000 656100                    ERSQ    0,,PR0

      417     2630            %CLIMB(FCN=RDY);

   2638  3 001011   000000 713400 xsym               CLIMB   I$RDY
         3 001012   402000 600000 xsid               climb   nvectors=         5

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:88   
      418     2644
      419     2645    1       RETAIN_SWITCH=%OFF; /* RESET RETAIN CONTROL FLAG */

   2645  3 001013   000067 450000 0                  STZ     RETAIN_SWITCH

      420     2646    2       DO WHILE (IA_HALF(15)>0); /* IF PRIVACY KEY REQUESTED */

   2646  3 001014   000045 470400 0                  LDP0    IA$
         3 001015   003100 060500                    CSL     bolr='003'O
         3 001016   000007 400022                    BDSC    7,,PR0                   by=2,bit=0,n=18
         3 001017   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001020   200014 236100                    LDQ     @N+2,,AUTO
         3 001021   000022 732000                    QRS     18
         3 001022   000000 116003                    CMPQ    0,DU
         3 001023   001060 604400 3                  TMOZ    s:2664

      421     2647    2           ADDR(UWA(27))->CHAR12=KEY_SAVE(IA_HALF(14));

   2647  3 001024   000045 470400 0                  LDP0    IA$
         3 001025   003100 060500                    CSL     bolr='003'O
         3 001026   000007 000022                    BDSC    7,,PR0                   by=0,bit=0,n=18
         3 001027   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001030   200014 236100                    LDQ     @N+2,,AUTO
         3 001031   000022 732000                    QRS     18
         3 001032   000003 402007                    MPY     3,DL
         3 001033   000002 736000                    QLS     2
         3 001034   000052 471400 0                  LDP1    FPT$
         3 001035   000046 473400 0                  LDP3    UWA$
         3 001036   040100 100506                    MLR     fill='040'O
         3 001037   100000 000014                    ADSC9   0,Q,PR1                  cn=0,n=12
         3 001040   300033 000014                    ADSC9   27,,PR3                  cn=0,n=12

      422     2648    2           IPT_ETC.V_ = VECTOR(IPT_ETC.V);

   2648  3 001041   000011 235000 4                  LDA     9
         3 001042   000052 236000 0                  LDQ     FPT$
         3 001043   000012 036003                    ADLQ    10,DU
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:89   
         3 001044   100000 757100                    STAQ    0,,PR1

      423     2649                %CLIMB(FCN=ETC);

   2657  3 001045   100000 630500                    EPPR0   0,,PR1
         3 001046   000000 713400 xsym               CLIMB   I$ETC
         3 001047   402000 600000 xsid               climb   nvectors=         5

      424     2663    2           END;

   2663  3 001050   000045 470400 0                  LDP0    IA$
         3 001051   003100 060500                    CSL     bolr='003'O
         3 001052   000007 400022                    BDSC    7,,PR0                   by=2,bit=0,n=18
         3 001053   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001054   200014 236100                    LDQ     @N+2,,AUTO
         3 001055   000022 732000                    QRS     18
         3 001056   000000 116003                    CMPQ    0,DU
         3 001057   001024 605400 3                  TPNZ    s:2647

      425     2664    1       GOTO COMMON_RETURN;

   2664  3 001060   004370 710000 3                  TRA     COMMON_RETURN

      426     2665         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:90   
      427     2666        /**************************************************************/
      428     2667        /*                                                            */
      429     2668        /*    CALL FINISH([AREA-1,[AREA-2,....,],])                   */
      430     2669        /*                                                            */
      431     2670        /**************************************************************/
      432     2671    1   ZII$FINISH: ENTRY ALTRET;

   2671  3 001061   000000 700200 xent  ZII$FINISH   TSX0  ! X66_AUTO_3
         3 001062   000020 000003                    ZERO    16,3

      433     2672
      434     2673    1       CALL SET_ARGS;

   2673  3 001063   000003 701000 3                  TSX1    SET_ARGS
         3 001064   000000 011000                    NOP     0

      435     2674    2       DO I=1 TO PARAMS(0);

   2674  3 001065   000001 235007                    LDA     1,DL
         3 001066   000055 755000 0                  STA     I
         3 001067   001113 710000 3                  TRA     s:2677+1

      436     2675    2           IF TYPE_OF_ARG(I)~=%AREA_NAME THEN ALTRETURN;

   2675  3 001070   000055 236000 0                  LDQ     I
         3 001071   000011 402007                    MPY     9,DL
         3 001072   000000 116003                    CMPQ    0,DU
         3 001073   001075 605000 3                  TPL     s:2675+5
         3 001074   000044 036003                    ADLQ    36,DU
         3 001075   000051 470400 0                  LDP0    ARG$
         3 001076   003100 060506                    CSL     bolr='003'O
         3 001077   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001100   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001101   200014 236100                    LDQ     @N+2,,AUTO
         3 001102   000033 732000                    QRS     27
         3 001103   000002 116007                    CMPQ    2,DL
         3 001104   001106 600000 3                  TZE     s:2676
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:91   

   2675  3 001105   000000 702200 xent               TSX2  ! X66_AALT

      437     2676    2           IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#(I-1)=ZII$PARAMS.OFFSET(I);

   2676  3 001106   000055 720000 0                  LXL0    I
         3 001107   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 001110   000052 471400 0                  LDP1    FPT$
         3 001111   100012 741110                    STX1    10,X0,PR1

      438     2677    2           END;

   2677  3 001112   000055 054000 0                  AOS     I
         3 001113   000055 236000 0                  LDQ     I
         3 001114   000017 116000 0                  CMPQ    ZII$PARAMS
         3 001115   001070 604400 3                  TMOZ    s:2675

      439     2678    1       IPT_FIN.V_ = VECTOR(IPT_FIN.V);

   2678  3 001116   000011 235000 4                  LDA     9
         3 001117   000052 236000 0                  LDQ     FPT$
         3 001120   000012 036003                    ADLQ    10,DU
         3 001121   000052 470400 0                  LDP0    FPT$
         3 001122   000000 757100                    STAQ    0,,PR0

      440     2679    1       VBOUND(IPT_FIN.V_) = VBOUND(IPT_FIN.V_) + SIZEC(IPT_FIN.V.AC_OFFSETS) * I;

   2679  3 001123   000000 236100                    LDQ     0,,PR0
         3 001124   000020 772000                    QRL     16
         3 001125   200014 756100                    STQ     @N+2,,AUTO
         3 001126   000055 236000 0                  LDQ     I
         3 001127   000002 736000                    QLS     2
         3 001130   200014 036100                    ADLQ    @N+2,,AUTO
         3 001131   000020 736000                    QLS     16
         3 001132   000000 676100                    ERQ     0,,PR0
         3 001133   000012 376000 4                  ANQ     10
         3 001134   000000 656100                    ERSQ    0,,PR0
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:92   

      441     2680    1       IPT_FIN.V.ALCW.N_AREAS#=PARAMS(0);

   2680  3 001135   000017 720000 0                  LXL0    ZII$PARAMS
         3 001136   000012 740100                    STX0    10,,PR0

      442     2681            %CLIMB(FCN=FIN);

   2689  3 001137   000000 713400 xsym               CLIMB   I$FIN
         3 001140   402000 600000 xsid               climb   nvectors=         5

      443     2695    1       GOTO COMMON_RETURN;

   2695  3 001141   004370 710000 3                  TRA     COMMON_RETURN

      444     2696
      445     2697    1   ZII$CALC: ENTRY ALTRET;

   2697  3 001142   000000 700200 xent  ZII$CALC     TSX0  ! X66_AUTO_3
         3 001143   000020 000003                    ZERO    16,3

      446     2698
      447     2699    1       CALL SET_ARGS;

   2699  3 001144   000003 701000 3                  TSX1    SET_ARGS
         3 001145   000000 011000                    NOP     0

      448     2700    1       IF PARAMS(0)~=2 OR TYPE_OF_ARG(1)~=%RECORD_NAME THEN ALTRETURN;

   2700  3 001146   000017 235000 0                  LDA     ZII$PARAMS
         3 001147   000002 115007                    CMPA    2,DL
         3 001150   001161 601000 3                  TNZ     s:2700+11
         3 001151   000051 470400 0                  LDP0    ARG$
         3 001152   003100 060500                    CSL     bolr='003'O
         3 001153   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 001154   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001155   200014 236100                    LDQ     @N+2,,AUTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:93   
         3 001156   000033 732000                    QRS     27
         3 001157   000004 116007                    CMPQ    4,DL
         3 001160   001162 600000 3                  TZE     s:2701

   2700  3 001161   000000 702200 xent               TSX2  ! X66_AALT

      449     2701    1       IPT_CALC.V_=VECTOR(IPT_CALC.V);

   2701  3 001162   000011 235000 4                  LDA     9
         3 001163   000052 236000 0                  LDQ     FPT$
         3 001164   000014 036003                    ADLQ    12,DU
         3 001165   000052 471400 0                  LDP1    FPT$
         3 001166   100000 757100                    STAQ    0,,PR1

      450     2702    1       IPT_CALC.DBK_=VECTOR(ZII$INTEGER1);

   2702  3 001167   000014 237000 4                  LDAQ    12
         3 001170   100012 757100                    STAQ    10,,PR1

      451     2703    1       IPT_CALC.V.UWA_OFFSET=RVA_HALF(ZII$PARAMS.OFFSET(1)*2+1)/8;

   2703  3 001171   000020 236000 0                  LDQ     ZII$PARAMS+1
         3 001172   000022 772000                    QRL     18
         3 001173   000044 402007                    MPY     36,DL
         3 001174   000047 473400 0                  LDP3    RVA$
         3 001175   003100 060506                    CSL     bolr='003'O
         3 001176   300000 400022                    BDSC    0,Q,PR3                  by=2,bit=0,n=18
         3 001177   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001200   200014 236100                    LDQ     @N+2,,AUTO
         3 001201   000022 732000                    QRS     18
         3 001202   000010 506007                    DIV     8,DL
         3 001203   100014 756100                    STQ     12,,PR1

      452     2704            %CLIMB(FCN=CALC);

   2712  3 001204   100000 630500                    EPPR0   0,,PR1
         3 001205   000000 713400 xsym               CLIMB   I$CALC
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:94   
         3 001206   402400 600000 xsid               climb   nvectors=         6

      453     2718    1       IPT_CALC.V_=VECTOR(FPT.V);

   2718  3 001207   000002 235000 4                  LDA     2
         3 001210   000052 236000 0                  LDQ     FPT$
         3 001211   000012 036003                    ADLQ    10,DU
         3 001212   000052 470400 0                  LDP0    FPT$
         3 001213   000000 757100                    STAQ    0,,PR0

      454     2719    1       GOTO COMMON_RETURN;

   2719  3 001214   004370 710000 3                  TRA     COMMON_RETURN

      455     2720         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:95   
      456     2721    1   ZII$ACCEPT: ENTRY ALTRET;

   2721  3 001215   000000 700200 xent  ZII$ACCEPT   TSX0  ! X66_AUTO_3
         3 001216   000020 000003                    ZERO    16,3

      457     2722
      458     2723    1       CALL SET_ARGS;

   2723  3 001217   000003 701000 3                  TSX1    SET_ARGS
         3 001220   000000 011000                    NOP     0

      459     2724    1       IF TYPE_OF_ARG(2)=%FROM THEN

   2724  3 001221   000051 470400 0                  LDP0    ARG$
         3 001222   003100 060500                    CSL     bolr='003'O
         3 001223   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 001224   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001225   200014 236100                    LDQ     @N+2,,AUTO
         3 001226   000033 732000                    QRS     27
         3 001227   000043 116007                    CMPQ    35,DL
         3 001230   001234 601000 3                  TNZ     s:2726

      460     2725    1           I=3; /* KEYWORD FROM IS OPTIONAL */

   2725  3 001231   000003 235007                    LDA     3,DL
         3 001232   000055 755000 0                  STA     I
         3 001233   001236 710000 3                  TRA     s:2736

      461     2726    1       ELSE I=2;

   2726  3 001234   000002 235007                    LDA     2,DL
         3 001235   000055 755000 0                  STA     I

      462     2727        /*****************************************************************/
      463     2728        /*                                                               */
      464     2729        /*    CALL ACCEPT(IDENT-1[,FROM][,REC-NAME],AREANAME)            */
      465     2730        /*                                SET-NAME                       */
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:96   
      466     2731        /*                                IDENT-2                        */
      467     2732        /*         IDENT-1: LOCATION TO RECEIVE THE AREA'S TEXT NAME     */
      468     2733        /*         IDENT-2: LOCATION CONTAINS A DBKEY TO IDENT THE AREA  */
      469     2734        /*                                                               */
      470     2735        /*****************************************************************/
      471     2736    1       J=PARAMS(0); /* GET THE INDEX OF LAST PARAM */

   2736  3 001236   000017 236000 0                  LDQ     ZII$PARAMS
         3 001237   000056 756000 0                  STQ     J

      472     2737    1       IF TYPE_OF_ARG(J)=%REALMNAME THEN

   2737  3 001240   000011 402007                    MPY     9,DL
         3 001241   000000 116003                    CMPQ    0,DU
         3 001242   001244 605000 3                  TPL     s:2737+4
         3 001243   000044 036003                    ADLQ    36,DU
         3 001244   003100 060506                    CSL     bolr='003'O
         3 001245   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001246   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001247   200014 236100                    LDQ     @N+2,,AUTO
         3 001250   000033 732000                    QRS     27
         3 001251   000010 116007                    CMPQ    8,DL
         3 001252   001374 601000 3                  TNZ     s:2786

      473     2738    2       DO;

      474     2739    2           IPT_ACN.DBK_=VECTOR(ZII$INTEGER1);

   2739  3 001253   000014 237000 4                  LDAQ    12
         3 001254   000052 471400 0                  LDP1    FPT$
         3 001255   100014 757100                    STAQ    12,,PR1

      475     2740    2           IPT_ACN.ANAME_=VECTOR(ZII$CHARACTER30);

   2740  3 001256   000016 237000 4                  LDAQ    14
         3 001257   100012 757100                    STAQ    10,,PR1

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:97   
      476     2741    2           IPT_ACN.V.RVA_ITEM.OFFSET#=ZII$PARAMS.OFFSET(I);

   2741  3 001260   000055 720000 0                  LXL0    I
         3 001261   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 001262   100020 741100                    STX1    16,,PR1

      477     2742    2           IF TYPE_OF_ARG(I)=%RECORD_NAME THEN

   2742  3 001263   000055 236000 0                  LDQ     I
         3 001264   000011 402007                    MPY     9,DL
         3 001265   000000 116003                    CMPQ    0,DU
         3 001266   001270 605000 3                  TPL     s:2742+5
         3 001267   000044 036003                    ADLQ    36,DU
         3 001270   003100 060506                    CSL     bolr='003'O
         3 001271   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001272   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001273   200014 236100                    LDQ     @N+2,,AUTO
         3 001274   000033 732000                    QRS     27
         3 001275   000004 116007                    CMPQ    4,DL
         3 001276   001302 601000 3                  TNZ     s:2745

      478     2743    2               IPT_ACN.V.NCW.CI#=1;

   2743  3 001277   000001 222003                    LDX2    1,DU
         3 001300   100016 742100                    STX2    14,,PR1
         3 001301   001362 710000 3                  TRA     s:2758

      479     2744    2           ELSE
      480     2745    2               IF TYPE_OF_ARG(I)=%SET_NAME THEN

   2745  3 001302   000055 236000 0                  LDQ     I
         3 001303   000011 402007                    MPY     9,DL
         3 001304   000000 116003                    CMPQ    0,DU
         3 001305   001307 605000 3                  TPL     s:2745+5
         3 001306   000044 036003                    ADLQ    36,DU
         3 001307   003100 060506                    CSL     bolr='003'O
         3 001310   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:98   
         3 001311   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001312   200014 236100                    LDQ     @N+2,,AUTO
         3 001313   000033 732000                    QRS     27
         3 001314   000003 116007                    CMPQ    3,DL
         3 001315   001321 601000 3                  TNZ     s:2749

      481     2746    2                   IPT_ACN.V.NCW.CI#=3;

   2746  3 001316   000003 222003                    LDX2    3,DU
         3 001317   100016 742100                    STX2    14,,PR1
         3 001320   001362 710000 3                  TRA     s:2758

      482     2747    2               ELSE
      483     2748    3               DO;

      484     2749    3                   IPT_ACN.V.RVA_ITEM.OFFSET#=NULL_OFFSET;

   2749  3 001321   000064 722000 0                  LXL2    NULL_OFFSET
         3 001322   100020 742100                    STX2    16,,PR1

      485     2750    3                   IF TYPE_OF_ARG(I)=%REALMNAME THEN

   2750  3 001323   000055 236000 0                  LDQ     I
         3 001324   000011 402007                    MPY     9,DL
         3 001325   000000 116003                    CMPQ    0,DU
         3 001326   001330 605000 3                  TPL     s:2750+5
         3 001327   000044 036003                    ADLQ    36,DU
         3 001330   003100 060506                    CSL     bolr='003'O
         3 001331   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001332   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001333   200014 236100                    LDQ     @N+2,,AUTO
         3 001334   000033 732000                    QRS     27
         3 001335   000010 116007                    CMPQ    8,DL
         3 001336   001342 601000 3                  TNZ     s:2753

      486     2751    3                       IPT_ACN.V.NCW.CI#=2;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:99   
   2751  3 001337   000002 221003                    LDX1    2,DU
         3 001340   100016 741100                    STX1    14,,PR1
         3 001341   001362 710000 3                  TRA     s:2758

      487     2752    3                   ELSE
      488     2753    3                       IF TYPE_OF_ARG(I)=%APL_IDP THEN

   2753  3 001342   000055 236000 0                  LDQ     I
         3 001343   000011 402007                    MPY     9,DL
         3 001344   000000 116003                    CMPQ    0,DU
         3 001345   001347 605000 3                  TPL     s:2753+5
         3 001346   000044 036003                    ADLQ    36,DU
         3 001347   003100 060506                    CSL     bolr='003'O
         3 001350   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001351   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001352   200014 236100                    LDQ     @N+2,,AUTO
         3 001353   000033 732000                    QRS     27
         3 001354   000001 116007                    CMPQ    1,DL
         3 001355   001361 601000 3                  TNZ     s:2756

      489     2754    3                           IPT_ACN.V.NCW.CI#=0;

   2754  3 001356   000000 221003                    LDX1    0,DU
         3 001357   100016 741100                    STX1    14,,PR1
         3 001360   001362 710000 3                  TRA     s:2758

      490     2755    3                       ELSE
      491     2756    3                           ALTRETURN;

   2756  3 001361   000000 702200 xent               TSX2  ! X66_AALT

      492     2757    3                   END;
      493     2758    2           IPT_ACN.V.NCW.AREA_NME_SIZE#=30;

   2758  3 001362   000036 221003                    LDX1    30,DU
         3 001363   100016 441100                    SXL1    14,,PR1

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:100  
      494     2759    2           IPT_ACN.V_=VECTOR(IPT_ACN.V);

   2759  3 001364   000013 235000 4                  LDA     11
         3 001365   000052 236000 0                  LDQ     FPT$
         3 001366   000016 036003                    ADLQ    14,DU
         3 001367   100000 757100                    STAQ    0,,PR1

      495     2760                %CLIMB(FCN=ACN);

   2768  3 001370   100000 630500                    EPPR0   0,,PR1
         3 001371   000000 713400 xsym               CLIMB   I$ACN
         3 001372   403000 600000 xsid               climb   nvectors=         7

      496     2774    2           END;

   2774  3 001373   001606 710000 3                  TRA     s:2837

      497     2775    1       ELSE
      498     2776         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:101  
      499     2777        /****************************************************************/
      500     2778        /*                                                              */
      501     2779        /*      CALL ACCEPT(IDENTIFIER[,FROM][,REC-NAME],CURRENCY)      */
      502     2780        /*                                     SET-NAME NEXT            */
      503     2781        /*                                     AREA-NAME PRIOR          */
      504     2782        /*                                      OWNER                   */
      505     2783        /*                                                              */
      506     2784        /****************************************************************/
      507     2785    2       DO;

      508     2786    2           IPT_ACC.DBK_=VECTOR(ZII$INTEGER1);

   2786  3 001374   000014 237000 4                  LDAQ    12
         3 001375   000052 471400 0                  LDP1    FPT$
         3 001376   100012 757100                    STAQ    10,,PR1

      509     2787    2           IPT_ACC.V.RVA_ITEM.OFFSET#=ZII$PARAMS.OFFSET(I);

   2787  3 001377   000055 720000 0                  LXL0    I
         3 001400   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 001401   100016 741100                    STX1    14,,PR1

      510     2788    2           IF TYPE_OF_ARG(J)=%CURRENCY THEN

   2788  3 001402   000056 236000 0                  LDQ     J
         3 001403   000011 402007                    MPY     9,DL
         3 001404   000000 116003                    CMPQ    0,DU
         3 001405   001407 605000 3                  TPL     s:2788+5
         3 001406   000044 036003                    ADLQ    36,DU
         3 001407   003100 060506                    CSL     bolr='003'O
         3 001410   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001411   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001412   200014 236100                    LDQ     @N+2,,AUTO
         3 001413   000033 732000                    QRS     27
         3 001414   000012 116007                    CMPQ    10,DL
         3 001415   001504 601000 3                  TNZ     s:2809

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:102  
      511     2789    3           DO;

      512     2790    3               IF TYPE_OF_ARG(I)=%RECORD_NAME THEN

   2790  3 001416   000055 236000 0                  LDQ     I
         3 001417   000011 402007                    MPY     9,DL
         3 001420   000000 116003                    CMPQ    0,DU
         3 001421   001423 605000 3                  TPL     s:2790+5
         3 001422   000044 036003                    ADLQ    36,DU
         3 001423   003100 060506                    CSL     bolr='003'O
         3 001424   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001425   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001426   200014 236100                    LDQ     @N+2,,AUTO
         3 001427   000033 732000                    QRS     27
         3 001430   000004 116007                    CMPQ    4,DL
         3 001431   001435 601000 3                  TNZ     s:2793

      513     2791    3                   IPT_ACC.V.CCW.SCI#=1;

   2791  3 001432   000001 222003                    LDX2    1,DU
         3 001433   100014 742100                    STX2    12,,PR1
         3 001434   001577 710000 3                  TRA     s:2821

      514     2792    3               ELSE
      515     2793    3                   IF TYPE_OF_ARG(I)=%AREA_NAME THEN

   2793  3 001435   000055 236000 0                  LDQ     I
         3 001436   000011 402007                    MPY     9,DL
         3 001437   000000 116003                    CMPQ    0,DU
         3 001440   001442 605000 3                  TPL     s:2793+5
         3 001441   000044 036003                    ADLQ    36,DU
         3 001442   003100 060506                    CSL     bolr='003'O
         3 001443   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001444   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001445   200014 236100                    LDQ     @N+2,,AUTO
         3 001446   000033 732000                    QRS     27
         3 001447   000002 116007                    CMPQ    2,DL
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:103  
         3 001450   001454 601000 3                  TNZ     s:2796

      516     2794    3                       IPT_ACC.V.CCW.SCI#=2;

   2794  3 001451   000002 222003                    LDX2    2,DU
         3 001452   100014 742100                    STX2    12,,PR1
         3 001453   001577 710000 3                  TRA     s:2821

      517     2795    3                   ELSE
      518     2796    3                       IF TYPE_OF_ARG(I)=%SET_NAME THEN

   2796  3 001454   000055 236000 0                  LDQ     I
         3 001455   000011 402007                    MPY     9,DL
         3 001456   000000 116003                    CMPQ    0,DU
         3 001457   001461 605000 3                  TPL     s:2796+5
         3 001460   000044 036003                    ADLQ    36,DU
         3 001461   003100 060506                    CSL     bolr='003'O
         3 001462   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001463   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001464   200014 236100                    LDQ     @N+2,,AUTO
         3 001465   000033 732000                    QRS     27
         3 001466   000003 116007                    CMPQ    3,DL
         3 001467   001473 601000 3                  TNZ     s:2799

      519     2797    3                           IPT_ACC.V.CCW.SCI#=3;

   2797  3 001470   000003 222003                    LDX2    3,DU
         3 001471   100014 742100                    STX2    12,,PR1
         3 001472   001577 710000 3                  TRA     s:2821

      520     2798    3                       ELSE
      521     2799    3                           IF PARAMS(0)=I THEN

   2799  3 001473   000017 236000 0                  LDQ     ZII$PARAMS
         3 001474   000055 116000 0                  CMPQ    I
         3 001475   001503 601000 3                  TNZ     s:2805

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:104  
      522     2800    4                           DO;

      523     2801    4                               IPT_ACC.V.CCW.SCI#=0;

   2801  3 001476   000000 222003                    LDX2    0,DU
         3 001477   100014 742100                    STX2    12,,PR1

      524     2802    4                               IPT_ACC.V.RVA_ITEM.OFFSET#=NULL_OFFSET;

   2802  3 001500   000064 723000 0                  LXL3    NULL_OFFSET
         3 001501   100016 743100                    STX3    14,,PR1

      525     2803    4                               END;

   2803  3 001502   001577 710000 3                  TRA     s:2821

      526     2804    3                           ELSE
      527     2805    3                               ALTRETURN;

   2805  3 001503   000000 702200 xent               TSX2  ! X66_AALT

      528     2806    3               END;
      529     2807    2           ELSE
      530     2808    3           DO;

      531     2809    3               IF TYPE_OF_ARG(I)~=%SET_NAME THEN ALTRETURN;

   2809  3 001504   000055 236000 0                  LDQ     I
         3 001505   000011 402007                    MPY     9,DL
         3 001506   000000 116003                    CMPQ    0,DU
         3 001507   001511 605000 3                  TPL     s:2809+5
         3 001510   000044 036003                    ADLQ    36,DU
         3 001511   003100 060506                    CSL     bolr='003'O
         3 001512   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001513   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001514   200014 236100                    LDQ     @N+2,,AUTO
         3 001515   000033 732000                    QRS     27
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:105  
         3 001516   000003 116007                    CMPQ    3,DL
         3 001517   001521 600000 3                  TZE     s:2810

   2809  3 001520   000000 702200 xent               TSX2  ! X66_AALT

      532     2810    3               IF TYPE_OF_ARG(J)=%NEXT THEN

   2810  3 001521   000056 236000 0                  LDQ     J
         3 001522   000011 402007                    MPY     9,DL
         3 001523   000000 116003                    CMPQ    0,DU
         3 001524   001526 605000 3                  TPL     s:2810+5
         3 001525   000044 036003                    ADLQ    36,DU
         3 001526   003100 060506                    CSL     bolr='003'O
         3 001527   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001530   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001531   200014 236100                    LDQ     @N+2,,AUTO
         3 001532   000033 732000                    QRS     27
         3 001533   000023 116007                    CMPQ    19,DL
         3 001534   001540 601000 3                  TNZ     s:2813

      533     2811    3                   IPT_ACC.V.CCW.SCI#=4;

   2811  3 001535   000004 222003                    LDX2    4,DU
         3 001536   100014 742100                    STX2    12,,PR1
         3 001537   001577 710000 3                  TRA     s:2821

      534     2812    3               ELSE
      535     2813    3                   IF TYPE_OF_ARG(J)=%PRIOR THEN

   2813  3 001540   000056 236000 0                  LDQ     J
         3 001541   000011 402007                    MPY     9,DL
         3 001542   000000 116003                    CMPQ    0,DU
         3 001543   001545 605000 3                  TPL     s:2813+5
         3 001544   000044 036003                    ADLQ    36,DU
         3 001545   003100 060506                    CSL     bolr='003'O
         3 001546   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001547   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:106  
         3 001550   200014 236100                    LDQ     @N+2,,AUTO
         3 001551   000033 732000                    QRS     27
         3 001552   000027 116007                    CMPQ    23,DL
         3 001553   001557 601000 3                  TNZ     s:2816

      536     2814    3                       IPT_ACC.V.CCW.SCI#=5;

   2814  3 001554   000005 222003                    LDX2    5,DU
         3 001555   100014 742100                    STX2    12,,PR1
         3 001556   001577 710000 3                  TRA     s:2821

      537     2815    3                   ELSE
      538     2816    3                       IF TYPE_OF_ARG(J)=%OWNER THEN

   2816  3 001557   000056 236000 0                  LDQ     J
         3 001560   000011 402007                    MPY     9,DL
         3 001561   000000 116003                    CMPQ    0,DU
         3 001562   001564 605000 3                  TPL     s:2816+5
         3 001563   000044 036003                    ADLQ    36,DU
         3 001564   003100 060506                    CSL     bolr='003'O
         3 001565   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 001566   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001567   200014 236100                    LDQ     @N+2,,AUTO
         3 001570   000033 732000                    QRS     27
         3 001571   000026 116007                    CMPQ    22,DL
         3 001572   001576 601000 3                  TNZ     s:2819

      539     2817    3                           IPT_ACC.V.CCW.SCI#=6;

   2817  3 001573   000006 222003                    LDX2    6,DU
         3 001574   100014 742100                    STX2    12,,PR1
         3 001575   001577 710000 3                  TRA     s:2821

      540     2818    3                       ELSE
      541     2819    3                           ALTRETURN;

   2819  3 001576   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:107  

      542     2820    3               END;
      543     2821    2           IPT_ACC.V_=VECTOR(IPT_ACC.V);

   2821  3 001577   000013 235000 4                  LDA     11
         3 001600   000052 236000 0                  LDQ     FPT$
         3 001601   000014 036003                    ADLQ    12,DU
         3 001602   100000 757100                    STAQ    0,,PR1

      544     2822                %CLIMB(FCN=ACC);

   2830  3 001603   100000 630500                    EPPR0   0,,PR1
         3 001604   000000 713400 xsym               CLIMB   I$ACC
         3 001605   402400 600000 xsid               climb   nvectors=         6

      545     2836    2           END;

      546     2837    1       FPT.V_=VECTOR(FPT.V);

   2837  3 001606   000002 235000 4                  LDA     2
         3 001607   000052 236000 0                  LDQ     FPT$
         3 001610   000012 036003                    ADLQ    10,DU
         3 001611   000052 470400 0                  LDP0    FPT$
         3 001612   000000 757100                    STAQ    0,,PR0

      547     2838    1       GOTO COMMON_RETURN;

   2838  3 001613   004370 710000 3                  TRA     COMMON_RETURN

      548     2839         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:108  
      549     2840    1   ZII$STORE: ENTRY ALTRET;

   2840  3 001614   000000 700200 xent  ZII$STORE    TSX0  ! X66_AUTO_3
         3 001615   000020 000003                    ZERO    16,3

      550     2841
      551     2842    1       CALL SET_ARGS;

   2842  3 001616   000003 701000 3                  TSX1    SET_ARGS
         3 001617   000000 011000                    NOP     0

      552     2843    1       IF PARAMS(0)~=1 OR TYPE_OF_ARG(1)~=%RECORD_NAME THEN ALTRETURN;

   2843  3 001620   000017 235000 0                  LDA     ZII$PARAMS
         3 001621   000001 115007                    CMPA    1,DL
         3 001622   001633 601000 3                  TNZ     s:2843+11
         3 001623   000051 470400 0                  LDP0    ARG$
         3 001624   003100 060500                    CSL     bolr='003'O
         3 001625   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 001626   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001627   200014 236100                    LDQ     @N+2,,AUTO
         3 001630   000033 732000                    QRS     27
         3 001631   000004 116007                    CMPQ    4,DL
         3 001632   001634 600000 3                  TZE     s:2844

   2843  3 001633   000000 702200 xent               TSX2  ! X66_AALT

      553     2844    1       IPT_STO.V_ = VECTOR(IPT_STO.V);

   2844  3 001634   000013 235000 4                  LDA     11
         3 001635   000052 236000 0                  LDQ     FPT$
         3 001636   000012 036003                    ADLQ    10,DU
         3 001637   000052 471400 0                  LDP1    FPT$
         3 001640   100000 757100                    STAQ    0,,PR1

      554     2845    1       IPT_STO.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:109  
   2845  3 001641   000020 220000 0                  LDX0    ZII$PARAMS+1
         3 001642   100012 740100                    STX0    10,,PR1

      555     2846    1       CALL CHK_RETAIN(IPT_STO.V.RLCW,0);

   2846  3 001643   000021 236000 4                  LDQ     17
         3 001644   200012 756100                    STQ     @RLCW+1,,AUTO
         3 001645   000052 236000 0                  LDQ     FPT$
         3 001646   000013 036003                    ADLQ    11,DU
         3 001647   200011 756100                    STQ     @A+2,,AUTO
         3 001650   000475 701000 3                  TSX1    CHK_RETAIN
         3 001651   000000 011000                    NOP     0

      556     2847            %CLIMB(FCN=STO);

   2855  3 001652   000052 470400 0                  LDP0    FPT$
         3 001653   000000 713400 xsym               CLIMB   I$STO
         3 001654   402000 600000 xsid               climb   nvectors=         5

      557     2861    1       GOTO COMMON_RETURN;

   2861  3 001655   004370 710000 3                  TRA     COMMON_RETURN

      558     2862
      559     2863
      560     2864    1   ZII$ERASER: ENTRY ALTRET;

   2864  3 001656   000000 700200 xent  ZII$ERASER   TSX0  ! X66_AUTO_3
         3 001657   000020 000003                    ZERO    16,3

      561     2865
      562     2866    1       CALL SET_ARGS;

   2866  3 001660   000003 701000 3                  TSX1    SET_ARGS
         3 001661   000000 011000                    NOP     0

      563     2867    1       IPT_ERS.V.RC.RC_OFFSET#=NULL_OFFSET;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:110  

   2867  3 001662   000064 720000 0                  LXL0    NULL_OFFSET
         3 001663   000052 470400 0                  LDP0    FPT$
         3 001664   000012 740100                    STX0    10,,PR0

      564     2868    1       ADDR(IPT_ERS.V.ECW)->SBIN36=0;

   2868  3 001665   000013 450100                    STZ     11,,PR0

      565     2869    1       IF PARAMS(0)>0 THEN

   2869  3 001666   000017 235000 0                  LDA     ZII$PARAMS
         3 001667   001732 604400 3                  TMOZ    s:2882

      566     2870    2       DO;

      567     2871    2           IF TYPE_OF_ARG(1)=%RECORD_NAME THEN

   2871  3 001670   000051 471400 0                  LDP1    ARG$
         3 001671   003100 060500                    CSL     bolr='003'O
         3 001672   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9
         3 001673   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001674   200014 236100                    LDQ     @N+2,,AUTO
         3 001675   000033 732000                    QRS     27
         3 001676   000004 116007                    CMPQ    4,DL
         3 001677   001703 601000 3                  TNZ     s:2873

      568     2872    2               IPT_ERS.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

   2872  3 001700   000020 221000 0                  LDX1    ZII$PARAMS+1
         3 001701   000012 741100                    STX1    10,,PR0
         3 001702   001716 710000 3                  TRA     s:2877

      569     2873    2           ELSE IF TYPE_OF_ARG(1)=%ALL THEN

   2873  3 001703   003100 060500                    CSL     bolr='003'O
         3 001704   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:111  
         3 001705   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 001706   200014 236100                    LDQ     @N+2,,AUTO
         3 001707   000033 732000                    QRS     27
         3 001710   000006 116007                    CMPQ    6,DL
         3 001711   001715 601000 3                  TNZ     s:2876

      570     2874    2                   IPT_ERS.V.ECW.EC_BIT#='1'B;

   2874  3 001712   400000 236003                    LDQ     -131072,DU
         3 001713   000013 256100                    ORSQ    11,,PR0
         3 001714   001716 710000 3                  TRA     s:2877

      571     2875    2               ELSE
      572     2876    2                   ALTRETURN;

   2876  3 001715   000000 702200 xent               TSX2  ! X66_AALT

      573     2877    2           IF PARAMS(0)>=2 AND PARAMS(2)=%ALL THEN

   2877  3 001716   000017 235000 0                  LDA     ZII$PARAMS
         3 001717   000002 115007                    CMPA    2,DL
         3 001720   001727 604000 3                  TMI     s:2880
         3 001721   000021 236000 0                  LDQ     ZII$PARAMS+2
         3 001722   000006 116007                    CMPQ    6,DL
         3 001723   001727 601000 3                  TNZ     s:2880

      574     2878    2               IPT_ERS.V.ECW.EC_BIT#='1'B;

   2878  3 001724   400000 236003                    LDQ     -131072,DU
         3 001725   000013 256100                    ORSQ    11,,PR0
         3 001726   001732 710000 3                  TRA     s:2882

      575     2879    2           ELSE
      576     2880    2               IF PARAMS(0)>2 THEN ALTRETURN;

   2880  3 001727   000002 115007                    CMPA    2,DL
         3 001730   001732 604400 3                  TMOZ    s:2882
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:112  

   2880  3 001731   000000 702200 xent               TSX2  ! X66_AALT

      577     2881    2           END;
      578     2882    1       IPT_ERS.V_ = VECTOR(IPT_ERS.V);

   2882  3 001732   000011 235000 4                  LDA     9
         3 001733   000052 236000 0                  LDQ     FPT$
         3 001734   000012 036003                    ADLQ    10,DU
         3 001735   000000 757100                    STAQ    0,,PR0

      579     2883            %CLIMB(FCN=ERS);

   2891  3 001736   000000 713400 xsym               CLIMB   I$ERS
         3 001737   402000 600000 xsid               climb   nvectors=         5

      580     2897    1       GOTO COMMON_RETURN;

   2897  3 001740   004370 710000 3                  TRA     COMMON_RETURN

      581     2898         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:113  
      582     2899        /**   COMMON CALLING SEQUENCES FOR 'CALL FIND(DBKEY)'   **/
      583     2900
      584     2901    1   FINDBKEY: PROC;

   2901  3 001741   200006 741300       FINDBKEY     STX1  ! @A3+1,,AUTO

      585     2902
      586     2903    2       IPT_FDR.DBK_ = VECTOR(ZII$INTEGER1);

   2903  3 001742   000014 237000 4                  LDAQ    12
         3 001743   000052 470400 0                  LDP0    FPT$
         3 001744   000012 757100                    STAQ    10,,PR0

      587     2904    2       CALL CHK_RETAIN (IPT_FDR.V.RLCW,0);

   2904  3 001745   000021 236000 4                  LDQ     17
         3 001746   200012 756100                    STQ     @N,,AUTO
         3 001747   000052 236000 0                  LDQ     FPT$
         3 001750   000016 036003                    ADLQ    14,DU
         3 001751   200011 756100                    STQ     @RLCW,,AUTO
         3 001752   000475 701000 3                  TSX1    CHK_RETAIN
         3 001753   000000 011000                    NOP     0

      588     2905    2       IPT_FDR.V_ = VECTOR(IPT_FDR.V);

   2905  3 001754   000013 235000 4                  LDA     11
         3 001755   000052 236000 0                  LDQ     FPT$
         3 001756   000014 036003                    ADLQ    12,DU
         3 001757   000052 470400 0                  LDP0    FPT$
         3 001760   000000 757100                    STAQ    0,,PR0

      589     2906    2       VBOUND(IPT_FDR.V_) = VBOUND(IPT_FDR.V_) + SIZEC(IPT_FDR.V.RETENTION_LIST) *
              2906                RLCW_SAVE.N_SETS#;

   2906  3 001761   000000 236100                    LDQ     0,,PR0
         3 001762   000020 772000                    QRL     16
         3 001763   200014 756100                    STQ     @N+2,,AUTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:114  
         3 001764   000053 471400 0                  LDP1    RLCW$
         3 001765   003100 061500                    CSR     bolr='003'O
         3 001766   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         3 001767   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 001770   200015 236100                    LDQ     @N+3,,AUTO
         3 001771   000002 736000                    QLS     2
         3 001772   200014 036100                    ADLQ    @N+2,,AUTO
         3 001773   000020 736000                    QLS     16
         3 001774   000000 676100                    ERQ     0,,PR0
         3 001775   000012 376000 4                  ANQ     10
         3 001776   000000 656100                    ERSQ    0,,PR0

      590     2907            %CLIMB(FCN=FDR);

   2915  3 001777   000000 713400 xsym               CLIMB   I$FDR
         3 002000   402400 600000 xsid               climb   nvectors=         6

      591     2921    2       FPT.V_=VECTOR(FPT.V);

   2921  3 002001   000002 235000 4                  LDA     2
         3 002002   000052 236000 0                  LDQ     FPT$
         3 002003   000012 036003                    ADLQ    10,DU
         3 002004   000052 470400 0                  LDP0    FPT$
         3 002005   000000 757100                    STAQ    0,,PR0

      592     2922    2   END;

   2922  3 002006   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 002007   000001 702211                    TSX2  ! 1,X1

      593     2923
      594     2924    1   ZII$FIND: ENTRY ALTRET;

   2924  3 002010   000000 700200 xent  ZII$FIND     TSX0  ! X66_AUTO_3
         3 002011   000020 000003                    ZERO    16,3

      595     2925
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:115  
      596     2926    1       IF PARAMS(0)=1 AND PARAMS(1)=%CURRENT THEN

   2926  3 002012   000017 235000 0                  LDA     ZII$PARAMS
         3 002013   000001 115007                    CMPA    1,DL
         3 002014   002040 601000 3                  TNZ     s:2946
         3 002015   000020 236000 0                  LDQ     ZII$PARAMS+1
         3 002016   000013 116007                    CMPQ    11,DL
         3 002017   002040 601000 3                  TNZ     s:2946

      597     2927    2       DO; /* FIND CURRENT OF RUN */

      598     2928    2           IPT_FCR.V_ = VECTOR(IPT_FCR.V);

   2928  3 002020   000011 235000 4                  LDA     9
         3 002021   000052 236000 0                  LDQ     FPT$
         3 002022   000012 036003                    ADLQ    10,DU
         3 002023   000052 470400 0                  LDP0    FPT$
         3 002024   000000 757100                    STAQ    0,,PR0

      599     2929    2           CALL CHK_RETAIN(IPT_FCR.V.RLCW,0);

   2929  3 002025   000021 236000 4                  LDQ     17
         3 002026   200012 756100                    STQ     @RLCW+1,,AUTO
         3 002027   000052 236000 0                  LDQ     FPT$
         3 002030   000012 036003                    ADLQ    10,DU
         3 002031   200011 756100                    STQ     @A+2,,AUTO
         3 002032   000475 701000 3                  TSX1    CHK_RETAIN
         3 002033   000000 011000                    NOP     0

      600     2930                %CLIMB(FCN=FCR);

   2938  3 002034   000052 470400 0                  LDP0    FPT$
         3 002035   000000 713400 xsym               CLIMB   I$FCR
         3 002036   402000 600000 xsid               climb   nvectors=         5

      601     2944    2           GOTO COMMON_RETURN;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:116  
   2944  3 002037   004370 710000 3                  TRA     COMMON_RETURN

      602     2945    2           END;
      603     2946    1       IF PARAMS(0)<2 OR PARAMS(0)>%PARAMETERS THEN ALTRETURN;

   2946  3 002040   000002 115007                    CMPA    2,DL
         3 002041   002044 604000 3                  TMI     s:2946+4
         3 002042   000024 115007                    CMPA    20,DL
         3 002043   002045 604400 3                  TMOZ    s:2947

   2946  3 002044   000000 702200 xent               TSX2  ! X66_AALT

      604     2947    1       CALL SET_ARGS;

   2947  3 002045   000003 701000 3                  TSX1    SET_ARGS
         3 002046   000000 011000                    NOP     0

      605     2948    1       IF TYPE_OF_ARG(PARAMS(0)-1)=%USING AND

   2948  3 002047   000017 236000 0                  LDQ     ZII$PARAMS
         3 002050   000011 402007                    MPY     9,DL
         3 002051   000000 116003                    CMPQ    0,DU
         3 002052   002054 605000 3                  TPL     s:2948+5
         3 002053   000044 036003                    ADLQ    36,DU
         3 002054   000051 470400 0                  LDP0    ARG$
         3 002055   003100 060506                    CSL     bolr='003'O
         3 002056   077777 600011                    BDSC    -1,Q,PR0                 by=3,bit=0,n=9
         3 002057   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002060   200014 236100                    LDQ     @N+2,,AUTO
         3 002061   000033 732000                    QRS     27
         3 002062   000040 116007                    CMPQ    32,DL
         3 002063   002277 601000 3                  TNZ     s:3029
         3 002064   000017 236000 0                  LDQ     ZII$PARAMS
         3 002065   000011 402007                    MPY     9,DL
         3 002066   000000 116003                    CMPQ    0,DU
         3 002067   002071 605000 3                  TPL     s:2948+18
         3 002070   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:117  
         3 002071   003100 060506                    CSL     bolr='003'O
         3 002072   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 002073   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 002074   200015 236100                    LDQ     @N+3,,AUTO
         3 002075   000033 732000                    QRS     27
         3 002076   000003 116007                    CMPQ    3,DL
         3 002077   002277 601000 3                  TNZ     s:3029

      606     2949    1          TYPE_OF_ARG(PARAMS(0))=%SET_NAME THEN
      607     2950
      608     2951        /**************************************************************/
      609     2952        /*                                                            */
      610     2953        /*     TYPE OF FIND: USING KEY (KEY IN INDEX)                 */
      611     2954        /*                                                            */
      612     2955        /*                FIRST[,REC-NAME]                            */
      613     2956        /*     CALL FIND(<NEXT [,REC-NAME]>,USING,KEY-NAME)           */
      614     2957        /*                       REC-NAME                             */
      615     2958        /*                                                            */
      616     2959        /**************************************************************/
      617     2960
      618     2961    2       DO;

      619     2962    2           IF TYPE_OF_ARG(1)=%RECORD_NAME THEN

   2962  3 002100   003100 060500                    CSL     bolr='003'O
         3 002101   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 002102   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002103   200014 236100                    LDQ     @N+2,,AUTO
         3 002104   000033 732000                    QRS     27
         3 002105   000004 116007                    CMPQ    4,DL
         3 002106   002161 601000 3                  TNZ     s:2987

      620     2963    3           DO;

      621     2964    3               IPT_FUI.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

   2964  3 002107   000020 220000 0                  LDX0    ZII$PARAMS+1
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:118  
         3 002110   000052 471400 0                  LDP1    FPT$
         3 002111   100012 740100                    STX0    10,,PR1

      622     2965    3               IPT_FUI.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(3);

   2965  3 002112   000022 221000 0                  LDX1    ZII$PARAMS+3
         3 002113   100013 741100                    STX1    11,,PR1

      623     2966    3               IF TYPE_OF_ARG(3)~=%SET_NAME THEN ALTRETURN;

   2966  3 002114   003100 060500                    CSL     bolr='003'O
         3 002115   000000 600011                    BDSC    0,,PR0                   by=3,bit=0,n=9
         3 002116   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002117   200014 236100                    LDQ     @N+2,,AUTO
         3 002120   000033 732000                    QRS     27
         3 002121   000003 116007                    CMPQ    3,DL
         3 002122   002124 600000 3                  TZE     s:2967

   2966  3 002123   000000 702200 xent               TSX2  ! X66_AALT

      624     2967    3               IPT_FUI.V_ = VECTOR(IPT_FUI.V);

   2967  3 002124   000013 235000 4                  LDA     11
         3 002125   000052 236000 0                  LDQ     FPT$
         3 002126   000012 036003                    ADLQ    10,DU
         3 002127   100000 757100                    STAQ    0,,PR1

      625     2968    3              VBOUND(IPT_FUI.V_) = VBOUND(IPT_FUI.V_) + SIZEC(IPT_FUI.V.RETENTION_LIST
              2968                        ) * RLCW_SAVE.N_SETS#;

   2968  3 002130   100000 236100                    LDQ     0,,PR1
         3 002131   000020 772000                    QRL     16
         3 002132   200014 756100                    STQ     @N+2,,AUTO
         3 002133   000053 473400 0                  LDP3    RLCW$
         3 002134   003100 061500                    CSR     bolr='003'O
         3 002135   300000 610010                    BDSC    0,,PR3                   by=3,bit=1,n=8
         3 002136   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:119  
         3 002137   200015 236100                    LDQ     @N+3,,AUTO
         3 002140   000002 736000                    QLS     2
         3 002141   200014 036100                    ADLQ    @N+2,,AUTO
         3 002142   000020 736000                    QLS     16
         3 002143   100000 676100                    ERQ     0,,PR1
         3 002144   000012 376000 4                  ANQ     10
         3 002145   100000 656100                    ERSQ    0,,PR1

      626     2969    3               CALL CHK_RETAIN(IPT_FUI.V.RLCW,0);

   2969  3 002146   000021 236000 4                  LDQ     17
         3 002147   200012 756100                    STQ     @RLCW+1,,AUTO
         3 002150   000052 236000 0                  LDQ     FPT$
         3 002151   000014 036003                    ADLQ    12,DU
         3 002152   200011 756100                    STQ     @A+2,,AUTO
         3 002153   000475 701000 3                  TSX1    CHK_RETAIN
         3 002154   000000 011000                    NOP     0

      627     2970                    %CLIMB(FCN=FUI);

   2978  3 002155   000052 470400 0                  LDP0    FPT$
         3 002156   000000 713400 xsym               CLIMB   I$FUI
         3 002157   402000 600000 xsid               climb   nvectors=         5

      628     2984    3               END;

   2984  3 002160   003527 710000 3                  TRA     s:3432

      629     2985    2           ELSE
      630     2986    3           DO;

      631     2987    3               IF PARAMS(1)=%FIRST THEN

   2987  3 002161   000020 235000 0                  LDA     ZII$PARAMS+1
         3 002162   000016 115007                    CMPA    14,DL
         3 002163   002170 601000 3                  TNZ     s:2990

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:120  
      632     2988    3                   IPT_FRI.V.FCW.RECORD_LOCATION#=0;

   2988  3 002164   000000 220003                    LDX0    0,DU
         3 002165   000052 471400 0                  LDP1    FPT$
         3 002166   100012 740100                    STX0    10,,PR1
         3 002167   002177 710000 3                  TRA     s:2994

      633     2989    3               ELSE
      634     2990    3                   IF PARAMS(1)=%NEXT THEN

   2990  3 002170   000023 115007                    CMPA    19,DL
         3 002171   002176 601000 3                  TNZ     s:2993

      635     2991    3                       IPT_FRI.V.FCW.RECORD_LOCATION#=1;

   2991  3 002172   000001 220003                    LDX0    1,DU
         3 002173   000052 471400 0                  LDP1    FPT$
         3 002174   100012 740100                    STX0    10,,PR1
         3 002175   002177 710000 3                  TRA     s:2994

      636     2992    3                   ELSE
      637     2993    3                       ALTRETURN;

   2993  3 002176   000000 702200 xent               TSX2  ! X66_AALT

      638     2994    3               IF PARAMS(3)=%USING THEN

   2994  3 002177   000022 235000 0                  LDA     ZII$PARAMS+3
         3 002200   000040 115007                    CMPA    32,DL
         3 002201   002226 601000 3                  TNZ     s:3003

      639     2995    4               DO;

      640     2996    4                   IF TYPE_OF_ARG(2)~=%RECORD_NAME OR

   2996  3 002202   003100 060500                    CSL     bolr='003'O
         3 002203   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:121  
         3 002204   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002205   200014 236100                    LDQ     @N+2,,AUTO
         3 002206   000033 732000                    QRS     27
         3 002207   000004 116007                    CMPQ    4,DL
         3 002210   002220 601000 3                  TNZ     s:2997
         3 002211   003100 060500                    CSL     bolr='003'O
         3 002212   000001 000011                    BDSC    1,,PR0                   by=0,bit=0,n=9
         3 002213   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 002214   200015 236100                    LDQ     @N+3,,AUTO
         3 002215   000033 732000                    QRS     27
         3 002216   000003 116007                    CMPQ    3,DL
         3 002217   002221 600000 3                  TZE     s:2998

      641     2997    4                      TYPE_OF_ARG(4)~=%SET_NAME THEN ALTRETURN;

   2997  3 002220   000000 702200 xent               TSX2  ! X66_AALT

      642     2998    4                   IPT_FRI.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);

   2998  3 002221   000021 220000 0                  LDX0    ZII$PARAMS+2
         3 002222   100013 740100                    STX0    11,,PR1

      643     2999    4                   IPT_FRI.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(4);

   2999  3 002223   000023 221000 0                  LDX1    ZII$PARAMS+4
         3 002224   100014 741100                    STX1    12,,PR1

      644     3000    4                   END;

   3000  3 002225   002242 710000 3                  TRA     s:3007

      645     3001    3               ELSE
      646     3002    4               DO;

      647     3003    4                   IF TYPE_OF_ARG(3)~=%SET_NAME THEN ALTRETURN;

   3003  3 002226   003100 060500                    CSL     bolr='003'O
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:122  
         3 002227   000000 600011                    BDSC    0,,PR0                   by=3,bit=0,n=9
         3 002230   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002231   200014 236100                    LDQ     @N+2,,AUTO
         3 002232   000033 732000                    QRS     27
         3 002233   000003 116007                    CMPQ    3,DL
         3 002234   002236 600000 3                  TZE     s:3004

   3003  3 002235   000000 702200 xent               TSX2  ! X66_AALT

      648     3004    4                   IPT_FRI.V.RC.RC_OFFSET#=NULL_OFFSET;

   3004  3 002236   000064 720000 0                  LXL0    NULL_OFFSET
         3 002237   100013 740100                    STX0    11,,PR1

      649     3005    4                   IPT_FRI.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(3);

   3005  3 002240   000022 221000 0                  LDX1    ZII$PARAMS+3
         3 002241   100014 741100                    STX1    12,,PR1

      650     3006    4                   END;

      651     3007    3               IPT_FRI.V_ = VECTOR(IPT_FRI.V);

   3007  3 002242   000022 235000 4                  LDA     18
         3 002243   000052 236000 0                  LDQ     FPT$
         3 002244   000012 036003                    ADLQ    10,DU
         3 002245   100000 757100                    STAQ    0,,PR1

      652     3008    3              VBOUND(IPT_FRI.V_) = VBOUND(IPT_FRI.V_) + SIZEC(IPT_FRI.V.RETENTION_LIST
              3008                        ) * RLCW_SAVE.N_SETS#;

   3008  3 002246   100000 236100                    LDQ     0,,PR1
         3 002247   000020 772000                    QRL     16
         3 002250   200014 756100                    STQ     @N+2,,AUTO
         3 002251   000053 473400 0                  LDP3    RLCW$
         3 002252   003100 061500                    CSR     bolr='003'O
         3 002253   300000 610010                    BDSC    0,,PR3                   by=3,bit=1,n=8
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:123  
         3 002254   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 002255   200015 236100                    LDQ     @N+3,,AUTO
         3 002256   000002 736000                    QLS     2
         3 002257   200014 036100                    ADLQ    @N+2,,AUTO
         3 002260   000020 736000                    QLS     16
         3 002261   100000 676100                    ERQ     0,,PR1
         3 002262   000012 376000 4                  ANQ     10
         3 002263   100000 656100                    ERSQ    0,,PR1

      653     3009    3               CALL CHK_RETAIN(IPT_FRI.V.RLCW,0);

   3009  3 002264   000021 236000 4                  LDQ     17
         3 002265   200012 756100                    STQ     @RLCW+1,,AUTO
         3 002266   000052 236000 0                  LDQ     FPT$
         3 002267   000015 036003                    ADLQ    13,DU
         3 002270   200011 756100                    STQ     @A+2,,AUTO
         3 002271   000475 701000 3                  TSX1    CHK_RETAIN
         3 002272   000000 011000                    NOP     0

      654     3010                    %CLIMB(FCN=FRI);

   3018  3 002273   000052 470400 0                  LDP0    FPT$
         3 002274   000000 713400 xsym               CLIMB   I$FRI
         3 002275   402000 600000 xsid               climb   nvectors=         5

      655     3024    3               END;

      656     3025    2           END;

   3025  3 002276   003527 710000 3                  TRA     s:3432

      657     3026         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:124  
      658     3027    1       ELSE
      659     3028    2       DO;

      660     3029    3           DO CASE(TYPE_OF_ARG(1));

   3029  3 002277   003100 060500                    CSL     bolr='003'O
         3 002300   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 002301   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002302   200014 236100                    LDQ     @N+2,,AUTO
         3 002303   000033 732000                    QRS     27
         3 002304   000030 116007                    CMPQ    24,DL
         3 002305   002307 602006 3                  TNC     s:3029+8,QL
         3 002306   003526 710000 3                  TRA     s:3429
         3 002307   003526 710000 3                  TRA     s:3429
         3 002310   003347 710000 3                  TRA     s:3365
         3 002311   003526 710000 3                  TRA     s:3429
         3 002312   003526 710000 3                  TRA     s:3429
         3 002313   002337 710000 3                  TRA     s:3032
         3 002314   003526 710000 3                  TRA     s:3429
         3 002315   003526 710000 3                  TRA     s:3429
         3 002316   002565 710000 3                  TRA     s:3134
         3 002317   003526 710000 3                  TRA     s:3429
         3 002320   003526 710000 3                  TRA     s:3429
         3 002321   003526 710000 3                  TRA     s:3429
         3 002322   003025 710000 3                  TRA     s:3219
         3 002323   002540 710000 3                  TRA     s:3121
         3 002324   002565 710000 3                  TRA     s:3134
         3 002325   003347 710000 3                  TRA     s:3365
         3 002326   003526 710000 3                  TRA     s:3429
         3 002327   003526 710000 3                  TRA     s:3429
         3 002330   003347 710000 3                  TRA     s:3365
         3 002331   003526 710000 3                  TRA     s:3429
         3 002332   003025 710000 3                  TRA     s:3219
         3 002333   003526 710000 3                  TRA     s:3429
         3 002334   003526 710000 3                  TRA     s:3429
         3 002335   003257 710000 3                  TRA     s:3331
         3 002336   003025 710000 3                  TRA     s:3219
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:125  

      661     3030
      662     3031    3           CASE(%RECORD_NAME);

      663     3032    3               IF PARAMS(2)=%DBKEY THEN

   3032  3 002337   000021 235000 0                  LDA     ZII$PARAMS+2
         3 002340   000014 115007                    CMPA    12,DL
         3 002341   002367 601000 3                  TNZ     s:3048

      664     3033    4               DO;

      665     3034
      666     3035        /****************************************************************/
      667     3036        /*                                                              */
      668     3037        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
      669     3038        /*                                                              */
      670     3039        /*            CALL FIND(REC-NAME,DBKEY[,IS],IDENTIFIER)         */
      671     3040        /*                                                              */
      672     3041        /****************************************************************/
      673     3042
      674     3043    4                   IPT_FDR.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

   3043  3 002342   000020 220000 0                  LDX0    ZII$PARAMS+1
         3 002343   000052 471400 0                  LDP1    FPT$
         3 002344   100014 740100                    STX0    12,,PR1

      675     3044    4                   IF TYPE_OF_ARG(3)~=%IS AND

   3044  3 002345   003100 060500                    CSL     bolr='003'O
         3 002346   000000 600011                    BDSC    0,,PR0                   by=3,bit=0,n=9
         3 002347   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002350   200014 236100                    LDQ     @N+2,,AUTO
         3 002351   000033 732000                    QRS     27
         3 002352   000044 116007                    CMPQ    36,DL
         3 002353   002364 600000 3                  TZE     s:3046
         3 002354   003100 060500                    CSL     bolr='003'O
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:126  
         3 002355   000000 600011                    BDSC    0,,PR0                   by=3,bit=0,n=9
         3 002356   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 002357   200015 236100                    LDQ     @N+3,,AUTO
         3 002360   000033 732000                    QRS     27
         3 002361   000001 116007                    CMPQ    1,DL
         3 002362   002364 600000 3                  TZE     s:3046

      676     3045    4                      TYPE_OF_ARG(3)~=%APL_IDP THEN ALTRETURN;

   3045  3 002363   000000 702200 xent               TSX2  ! X66_AALT

      677     3046    4                   CALL FINDBKEY;

   3046  3 002364   001741 701000 3                  TSX1    FINDBKEY
         3 002365   000000 011000                    NOP     0

      678     3047    4                   END;

   3047  3 002366   003527 710000 3                  TRA     s:3432

      679     3048    3               ELSE IF PARAMS(2)=%WITHIN THEN

   3048  3 002367   000041 115007                    CMPA    33,DL
         3 002370   002537 601000 3                  TNZ     s:3109

      680     3049    4                   DO;

      681     3050
      682     3051        /***************************************************************/
      683     3052        /*                                                             */
      684     3053        /*            TYPE OF FIND: WITH KEY WITHIN CURRENT SET        */
      685     3054        /*                                                             */
      686     3055        /*            CALL FIND(REC-NAME,WITHIN,SET-NAME,[CURRENT]     */
      687     3056        /*                      [,USING][,IDENT-5],[IDENT-6],....])    */
      688     3057        /*                                                             */
      689     3058        /***************************************************************/
      690     3059
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:127  
      691     3060    4                       ADDR(IPT_FKC.V.FLCW)->SBIN36=0;

   3060  3 002371   000052 471400 0                  LDP1    FPT$
         3 002372   100014 450100                    STZ     12,,PR1

      692     3061    4                       IF TYPE_OF_ARG(3)~=%SET_NAME THEN ALTRETURN;

   3061  3 002373   003100 060500                    CSL     bolr='003'O
         3 002374   000000 600011                    BDSC    0,,PR0                   by=3,bit=0,n=9
         3 002375   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002376   200014 236100                    LDQ     @N+2,,AUTO
         3 002377   000033 732000                    QRS     27
         3 002400   000003 116007                    CMPQ    3,DL
         3 002401   002403 600000 3                  TZE     s:3062

   3061  3 002402   000000 702200 xent               TSX2  ! X66_AALT

      693     3062    4                       IPT_FKC.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

   3062  3 002403   000020 220000 0                  LDX0    ZII$PARAMS+1
         3 002404   100012 740100                    STX0    10,,PR1

      694     3063    4                       IPT_FKC.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(3);

   3063  3 002405   000022 221000 0                  LDX1    ZII$PARAMS+3
         3 002406   100013 741100                    STX1    11,,PR1

      695     3064    4                       IF PARAMS(0)>3 AND PARAMS(4)=%CURRENT THEN

   3064  3 002407   000017 235000 0                  LDA     ZII$PARAMS
         3 002410   000003 115007                    CMPA    3,DL
         3 002411   002420 604400 3                  TMOZ    s:3065+3
         3 002412   000023 236000 0                  LDQ     ZII$PARAMS+4
         3 002413   000013 116007                    CMPQ    11,DL
         3 002414   002420 601000 3                  TNZ     s:3065+3

      696     3065    4                           I=5; ELSE I=4;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:128  

   3065  3 002415   000005 235007                    LDA     5,DL
         3 002416   000055 755000 0                  STA     I
         3 002417   002422 710000 3                  TRA     s:3066

   3065  3 002420   000004 236007                    LDQ     4,DL
         3 002421   000055 756000 0                  STQ     I

      697     3066    4                       IF TYPE_OF_ARG(I)=%USING THEN

   3066  3 002422   000055 236000 0                  LDQ     I
         3 002423   000011 402007                    MPY     9,DL
         3 002424   000000 116003                    CMPQ    0,DU
         3 002425   002427 605000 3                  TPL     s:3066+5
         3 002426   000044 036003                    ADLQ    36,DU
         3 002427   003100 060506                    CSL     bolr='003'O
         3 002430   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 002431   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002432   200014 236100                    LDQ     @N+2,,AUTO
         3 002433   000033 732000                    QRS     27
         3 002434   000040 116007                    CMPQ    32,DL
         3 002435   002442 601000 3                  TNZ     s:3067+4

      698     3067    4                           K=I+1; ELSE K=I; /* KEYWORD USING IS OPTIONAL */

   3067  3 002436   000055 235000 0                  LDA     I
         3 002437   000001 035007                    ADLA    1,DL
         3 002440   000057 755000 0                  STA     K
         3 002441   002444 710000 3                  TRA     s:3068

   3067  3 002442   000055 235000 0                  LDA     I
         3 002443   000057 755000 0                  STA     K

      699     3068    5                       DO J=K TO PARAMS(0);

   3068  3 002444   000056 755000 0                  STA     J
         3 002445   002476 710000 3                  TRA     s:3072+1
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:129  

      700     3069    5                           IF TYPE_OF_ARG(J)~=%FIELD_NAME THEN ALTRETURN;

   3069  3 002446   000056 236000 0                  LDQ     J
         3 002447   000011 402007                    MPY     9,DL
         3 002450   000000 116003                    CMPQ    0,DU
         3 002451   002453 605000 3                  TPL     s:3069+5
         3 002452   000044 036003                    ADLQ    36,DU
         3 002453   000051 470400 0                  LDP0    ARG$
         3 002454   003100 060506                    CSL     bolr='003'O
         3 002455   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 002456   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002457   200014 236100                    LDQ     @N+2,,AUTO
         3 002460   000033 732000                    QRS     27
         3 002461   000005 116007                    CMPQ    5,DL
         3 002462   002464 600000 3                  TZE     s:3070

   3069  3 002463   000000 702200 xent               TSX2  ! X66_AALT

      701     3070    5                           IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#(J-K)=ZII$PARAMS.OFFSET(J);

   3070  3 002464   000056 236000 0                  LDQ     J
         3 002465   000057 136000 0                  SBLQ    K
         3 002466   000056 720000 0                  LXL0    J
         3 002467   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 002470   000052 471400 0                  LDP1    FPT$
         3 002471   100016 741106                    STX1    14,QL,PR1

      702     3071    5                           IPT_FKC.V.FLCW.N_FIELDS#=IPT_FKC.V.FLCW.N_FIELDS#+1;

   3071  3 002472   100014 221100                    LDX1    12,,PR1
         3 002473   000001 622011                    EAX2    1,X1
         3 002474   100014 742100                    STX2    12,,PR1

      703     3072    5                           END;

   3072  3 002475   000056 054000 0                  AOS     J
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:130  
         3 002476   000056 236000 0                  LDQ     J
         3 002477   000017 116000 0                  CMPQ    ZII$PARAMS
         3 002500   002446 604400 3                  TMOZ    s:3069

      704     3073    4                       CALL CHK_RETAIN(IPT_FKC.V.RLCW,IPT_FKC.V.FLCW.N_FIELDS#);

   3073  3 002501   000052 236000 0                  LDQ     FPT$
         3 002502   000014 036003                    ADLQ    12,DU
         3 002503   200012 756100                    STQ     @RLCW+1,,AUTO
         3 002504   000052 236000 0                  LDQ     FPT$
         3 002505   000015 036003                    ADLQ    13,DU
         3 002506   200011 756100                    STQ     @A+2,,AUTO
         3 002507   000475 701000 3                  TSX1    CHK_RETAIN
         3 002510   000000 011000                    NOP     0

      705     3074    5                       DO CASE(I);

   3074  3 002511   000055 235000 0                  LDA     I
         3 002512   000004 135007                    SBLA    4,DL
         3 002513   000001 115007                    CMPA    1,DL
         3 002514   002516 602005 3                  TNC     s:3074+5,AL
         3 002515   002527 710000 3                  TRA     s:3092
         3 002516   002517 710000 3                  TRA     s:3076

      706     3075    5                       CASE(4);

      707     3076    5                           IPT_FKY.V_ = VECTOR(IPT_FKY.V);

   3076  3 002517   000022 235000 4                  LDA     18
         3 002520   000052 236000 0                  LDQ     FPT$
         3 002521   000012 036003                    ADLQ    10,DU
         3 002522   000052 470400 0                  LDP0    FPT$
         3 002523   000000 757100                    STAQ    0,,PR0

      708     3077                                %CLIMB(FCN=FKY);

   3085  3 002524   000000 713400 xsym               CLIMB   I$FKY
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:131  
         3 002525   402000 600000 xsid               climb   nvectors=         5
         3 002526   003527 710000 3                  TRA     s:3432

      709     3091    5                       CASE(ELSE);

      710     3092    5                           IPT_FKC.V_ = VECTOR(IPT_FKC.V);

   3092  3 002527   000022 235000 4                  LDA     18
         3 002530   000052 236000 0                  LDQ     FPT$
         3 002531   000012 036003                    ADLQ    10,DU
         3 002532   000052 470400 0                  LDP0    FPT$
         3 002533   000000 757100                    STAQ    0,,PR0

      711     3093                                %CLIMB(FCN=FKC);

   3101  3 002534   000000 713400 xsym               CLIMB   I$FKC
         3 002535   402000 600000 xsid               climb   nvectors=         5

      712     3107    5                           END;

      713     3108    4                       END;

   3108  3 002536   003527 710000 3                  TRA     s:3432

      714     3109    3                   ELSE ALTRETURN;

   3109  3 002537   000000 702200 xent               TSX2  ! X66_AALT

      715     3110         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:132  
      716     3111    3           CASE(%DBKEY);

      717     3112
      718     3113        /****************************************************************/
      719     3114        /*                                                              */
      720     3115        /*            TYPE OF FIND: DIRECT BY GIVING DBKEY              */
      721     3116        /*                                                              */
      722     3117        /*            CALL FIND(DBKEY[,IS],IDENTIFIER)                  */
      723     3118        /*                                                              */
      724     3119        /****************************************************************/
      725     3120
      726     3121    3               IPT_FDR.V.RC.RC_OFFSET#=NULL_OFFSET;

   3121  3 002540   000064 720000 0                  LXL0    NULL_OFFSET
         3 002541   000052 471400 0                  LDP1    FPT$
         3 002542   100014 740100                    STX0    12,,PR1

      727     3122    3               IF TYPE_OF_ARG(2)~=%IS AND

   3122  3 002543   003100 060500                    CSL     bolr='003'O
         3 002544   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 002545   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002546   200014 236100                    LDQ     @N+2,,AUTO
         3 002547   000033 732000                    QRS     27
         3 002550   000044 116007                    CMPQ    36,DL
         3 002551   002562 600000 3                  TZE     s:3124
         3 002552   003100 060500                    CSL     bolr='003'O
         3 002553   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 002554   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 002555   200015 236100                    LDQ     @N+3,,AUTO
         3 002556   000033 732000                    QRS     27
         3 002557   000001 116007                    CMPQ    1,DL
         3 002560   002562 600000 3                  TZE     s:3124

      728     3123    3                  TYPE_OF_ARG(2)~=%APL_IDP THEN ALTRETURN;

   3123  3 002561   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:133  

      729     3124    3               CALL FINDBKEY;

   3124  3 002562   001741 701000 3                  TSX1    FINDBKEY
         3 002563   000000 011000                    NOP     0
         3 002564   003527 710000 3                  TRA     s:3432

      730     3125    3           CASE(%ANY,%DUPLICATE);

      731     3126        /**************************************************************/
      732     3127        /*                                                            */
      733     3128        /*       TYPE OF FIND: WITH CALC KEY                          */
      734     3129        /*                                                            */
      735     3130        /*       CALL FIND(ANY/DUPANY,REC-NAME)                       */
      736     3131        /*                                                            */
      737     3132        /**************************************************************/
      738     3133
      739     3134    3               IF TYPE_OF_ARG(2)=%RECORD_NAME THEN

   3134  3 002565   003100 060500                    CSL     bolr='003'O
         3 002566   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 002567   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002570   200014 236100                    LDQ     @N+2,,AUTO
         3 002571   000033 732000                    QRS     27
         3 002572   000004 116007                    CMPQ    4,DL
         3 002573   002647 601000 3                  TNZ     s:3186

      740     3135    4               DO;

      741     3136    4                   IPT_FDC.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);

   3136  3 002574   000021 220000 0                  LDX0    ZII$PARAMS+2
         3 002575   000052 471400 0                  LDP1    FPT$
         3 002576   100012 740100                    STX0    10,,PR1

      742     3137    4                   CALL CHK_RETAIN(IPT_FDC.V.RLCW,0);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:134  
   3137  3 002577   000021 236000 4                  LDQ     17
         3 002600   200012 756100                    STQ     @RLCW+1,,AUTO
         3 002601   000052 236000 0                  LDQ     FPT$
         3 002602   000013 036003                    ADLQ    11,DU
         3 002603   200011 756100                    STQ     @A+2,,AUTO
         3 002604   000475 701000 3                  TSX1    CHK_RETAIN
         3 002605   000000 011000                    NOP     0

      743     3138    5                   IF PARAMS(1)=%ANY THEN DO;

   3138  3 002606   000020 235000 0                  LDA     ZII$PARAMS+1
         3 002607   000007 115007                    CMPA    7,DL
         3 002610   002637 601000 3                  TNZ     s:3157

      744     3139    5                       IPT_FDC.V_ = VECTOR(IPT_FDC.V);

   3139  3 002611   000013 235000 4                  LDA     11
         3 002612   000052 236000 0                  LDQ     FPT$
         3 002613   000012 036003                    ADLQ    10,DU
         3 002614   000052 470400 0                  LDP0    FPT$
         3 002615   000000 757100                    STAQ    0,,PR0

      745     3140    5                       VBOUND(IPT_FDC.V_) = VBOUND(IPT_FDC.V_) + SIZEC(IPT_FDC.V.
              3140                                RETENTION_LIST) * RLCW_SAVE.N_SETS#;

   3140  3 002616   000000 236100                    LDQ     0,,PR0
         3 002617   000020 772000                    QRL     16
         3 002620   200014 756100                    STQ     @N+2,,AUTO
         3 002621   000053 471400 0                  LDP1    RLCW$
         3 002622   003100 061500                    CSR     bolr='003'O
         3 002623   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         3 002624   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 002625   200015 236100                    LDQ     @N+3,,AUTO
         3 002626   000002 736000                    QLS     2
         3 002627   200014 036100                    ADLQ    @N+2,,AUTO
         3 002630   000020 736000                    QLS     16
         3 002631   000000 676100                    ERQ     0,,PR0
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:135  
         3 002632   000012 376000 4                  ANQ     10
         3 002633   000000 656100                    ERSQ    0,,PR0

      746     3141                            %CLIMB(FCN=FDC);

   3149  3 002634   000000 713400 xsym               CLIMB   I$FDC
         3 002635   402000 600000 xsid               climb   nvectors=         5

      747     3155    5                       END;

   3155  3 002636   003527 710000 3                  TRA     s:3432

      748     3156    5                   ELSE DO;

      749     3157    5                       IPT_FCD.V_ = VECTOR(IPT_FCD.V);

   3157  3 002637   000013 235000 4                  LDA     11
         3 002640   000052 236000 0                  LDQ     FPT$
         3 002641   000012 036003                    ADLQ    10,DU
         3 002642   000052 470400 0                  LDP0    FPT$
         3 002643   000000 757100                    STAQ    0,,PR0

      750     3158                            %CLIMB(FCN=FCD);

   3166  3 002644   000000 713400 xsym               CLIMB   I$FCD
         3 002645   402000 600000 xsid               climb   nvectors=         5

      751     3172    5                       END;

      752     3173    4                   END;

   3173  3 002646   003527 710000 3                  TRA     s:3432

      753     3174         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:136  
      754     3175    3               ELSE
      755     3176    4               DO;

      756     3177
      757     3178        /*************************************************************/
      758     3179        /*                                                             */
      759     3180        /*       TYPE OF FIND: DUPLICATE RECORD WITHIN A SET           */
      760     3181        /*                                                             */
      761     3182        /*       CALL FIND(DUPSET[,WITHIN],SET-NAME[,USING],IDENT..)   */
      762     3183        /*                                                             */
      763     3184        /*************************************************************/
      764     3185
      765     3186    4                   J=2;

   3186  3 002647   000002 235007                    LDA     2,DL
         3 002650   000056 755000 0                  STA     J

      766     3187    4                   IF TYPE_OF_ARG(2)=%WITHIN THEN J=3;

   3187  3 002651   003100 060500                    CSL     bolr='003'O
         3 002652   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 002653   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002654   200014 236100                    LDQ     @N+2,,AUTO
         3 002655   000033 732000                    QRS     27
         3 002656   000041 116007                    CMPQ    33,DL
         3 002657   002662 601000 3                  TNZ     s:3188

   3187  3 002660   000003 236007                    LDQ     3,DL
         3 002661   000056 756000 0                  STQ     J

      767     3188    4                   IF TYPE_OF_ARG(J)~=%SET_NAME THEN ALTRETURN;

   3188  3 002662   000056 236000 0                  LDQ     J
         3 002663   000011 402007                    MPY     9,DL
         3 002664   000000 116003                    CMPQ    0,DU
         3 002665   002667 605000 3                  TPL     s:3188+5
         3 002666   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:137  
         3 002667   003100 060506                    CSL     bolr='003'O
         3 002670   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 002671   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002672   200014 236100                    LDQ     @N+2,,AUTO
         3 002673   000033 732000                    QRS     27
         3 002674   000003 116007                    CMPQ    3,DL
         3 002675   002677 600000 3                  TZE     s:3189

   3188  3 002676   000000 702200 xent               TSX2  ! X66_AALT

      768     3189    4                   IPT_FDP.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(J);

   3189  3 002677   000056 720000 0                  LXL0    J
         3 002700   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 002701   000052 471400 0                  LDP1    FPT$
         3 002702   100012 741100                    STX1    10,,PR1

      769     3190    4                   J=J+1;

   3190  3 002703   000056 054000 0                  AOS     J

      770     3191    4                   IF TYPE_OF_ARG(J)=%USING THEN J=J+1;

   3191  3 002704   000056 236000 0                  LDQ     J
         3 002705   000011 402007                    MPY     9,DL
         3 002706   000000 116003                    CMPQ    0,DU
         3 002707   002711 605000 3                  TPL     s:3191+5
         3 002710   000044 036003                    ADLQ    36,DU
         3 002711   003100 060506                    CSL     bolr='003'O
         3 002712   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 002713   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002714   200014 236100                    LDQ     @N+2,,AUTO
         3 002715   000033 732000                    QRS     27
         3 002716   000040 116007                    CMPQ    32,DL
         3 002717   002721 601000 3                  TNZ     s:3192

   3191  3 002720   000056 054000 0                  AOS     J
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:138  

      771     3192    4                   ADDR(IPT_FDP.V.FLCW)->SBIN36=0;

   3192  3 002721   100013 450100                    STZ     11,,PR1

      772     3193    5                   DO I=J TO PARAMS(0);

   3193  3 002722   000056 235000 0                  LDA     J
         3 002723   000055 755000 0                  STA     I
         3 002724   002755 710000 3                  TRA     s:3197+1

      773     3194    5                       IF TYPE_OF_ARG(I)~=%FIELD_NAME THEN ALTRETURN;

   3194  3 002725   000055 236000 0                  LDQ     I
         3 002726   000011 402007                    MPY     9,DL
         3 002727   000000 116003                    CMPQ    0,DU
         3 002730   002732 605000 3                  TPL     s:3194+5
         3 002731   000044 036003                    ADLQ    36,DU
         3 002732   000051 470400 0                  LDP0    ARG$
         3 002733   003100 060506                    CSL     bolr='003'O
         3 002734   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 002735   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 002736   200014 236100                    LDQ     @N+2,,AUTO
         3 002737   000033 732000                    QRS     27
         3 002740   000005 116007                    CMPQ    5,DL
         3 002741   002743 600000 3                  TZE     s:3195

   3194  3 002742   000000 702200 xent               TSX2  ! X66_AALT

      774     3195    5                       IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#(I-J)=ZII$PARAMS.OFFSET(I);

   3195  3 002743   000055 236000 0                  LDQ     I
         3 002744   000056 136000 0                  SBLQ    J
         3 002745   000055 720000 0                  LXL0    I
         3 002746   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 002747   000052 471400 0                  LDP1    FPT$
         3 002750   100015 741106                    STX1    13,QL,PR1
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:139  

      775     3196    5                       IPT_FDP.V.FLCW.N_FIELDS#=IPT_FDP.V.FLCW.N_FIELDS#+1;

   3196  3 002751   100013 221100                    LDX1    11,,PR1
         3 002752   000001 622011                    EAX2    1,X1
         3 002753   100013 742100                    STX2    11,,PR1

      776     3197    5                       END;

   3197  3 002754   000055 054000 0                  AOS     I
         3 002755   000055 236000 0                  LDQ     I
         3 002756   000017 116000 0                  CMPQ    ZII$PARAMS
         3 002757   002725 604400 3                  TMOZ    s:3194

      777     3198    4                   IPT_FDP.V_ = VECTOR(IPT_FDP.V);

   3198  3 002760   000013 235000 4                  LDA     11
         3 002761   000052 236000 0                  LDQ     FPT$
         3 002762   000012 036003                    ADLQ    10,DU
         3 002763   100000 757100                    STAQ    0,,PR1

      778     3199    4                   VBOUND(IPT_FDP.V_) = VBOUND(IPT_FDP.V_) +

   3199  3 002764   100013 236100                    LDQ     11,,PR1
         3 002765   000022 732000                    QRS     18
         3 002766   200014 756100                    STQ     @N+2,,AUTO
         3 002767   000053 473400 0                  LDP3    RLCW$
         3 002770   003100 061500                    CSR     bolr='003'O
         3 002771   300000 610010                    BDSC    0,,PR3                   by=3,bit=1,n=8
         3 002772   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 002773   200015 236100                    LDQ     @N+3,,AUTO
         3 002774   200014 036100                    ADLQ    @N+2,,AUTO
         3 002775   200016 756100                    STQ     @N+4,,AUTO
         3 002776   100000 236100                    LDQ     0,,PR1
         3 002777   000020 772000                    QRL     16
         3 003000   200017 756100                    STQ     @N+5,,AUTO
         3 003001   200016 236100                    LDQ     @N+4,,AUTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:140  
         3 003002   000002 736000                    QLS     2
         3 003003   200017 036100                    ADLQ    @N+5,,AUTO
         3 003004   000004 136007                    SBLQ    4,DL
         3 003005   000020 736000                    QLS     16
         3 003006   100000 676100                    ERQ     0,,PR1
         3 003007   000012 376000 4                  ANQ     10
         3 003010   100000 656100                    ERSQ    0,,PR1

      779     3200    4                     SIZEC(IPT_FDP.V.FL_RL_LIST) * (RLCW_SAVE.N_SETS# + IPT_FDP.V.FLCW
              3200                               .N_FIELDS# - 1);
      780     3201    4                   CALL CHK_RETAIN(IPT_FDP.V.RLCW,IPT_FDP.V.FLCW.N_FIELDS#);

   3201  3 003011   000052 236000 0                  LDQ     FPT$
         3 003012   000013 036003                    ADLQ    11,DU
         3 003013   200012 756100                    STQ     @RLCW+1,,AUTO
         3 003014   000052 236000 0                  LDQ     FPT$
         3 003015   000014 036003                    ADLQ    12,DU
         3 003016   200011 756100                    STQ     @A+2,,AUTO
         3 003017   000475 701000 3                  TSX1    CHK_RETAIN
         3 003020   000000 011000                    NOP     0

      781     3202                        %CLIMB(FCN=FDP);

   3210  3 003021   000052 470400 0                  LDP0    FPT$
         3 003022   000000 713400 xsym               CLIMB   I$FDP
         3 003023   402000 600000 xsid               climb   nvectors=         5

      782     3216    4                   END;

   3216  3 003024   003527 710000 3                  TRA     s:3432

      783     3217         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:141  
      784     3218    3           CASE(%CURRENT,%NEXT,%PRIOR);

      785     3219    3               IF PARAMS(0)=2 AND TYPE_OF_ARG(2)=%RECORD_NAME AND

   3219  3 003025   000017 235000 0                  LDA     ZII$PARAMS
         3 003026   000002 115007                    CMPA    2,DL
         3 003027   003102 601000 3                  TNZ     s:3261
         3 003030   003100 060500                    CSL     bolr='003'O
         3 003031   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 003032   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003033   200014 236100                    LDQ     @N+2,,AUTO
         3 003034   000033 732000                    QRS     27
         3 003035   000004 116007                    CMPQ    4,DL
         3 003036   003102 601000 3                  TNZ     s:3261
         3 003037   000020 236000 0                  LDQ     ZII$PARAMS+1
         3 003040   000013 116007                    CMPQ    11,DL
         3 003041   003102 601000 3                  TNZ     s:3261

      786     3220    3                  PARAMS(1)=%CURRENT THEN
      787     3221
      788     3222        /******************************************************************/
      789     3223        /*                                                                */
      790     3224        /*       TYPE OF FIND: CURRENT OF RECORD                          */
      791     3225        /*                                                                */
      792     3226        /*       CALL FIND(CURRENT,REC-NAME)                              */
      793     3227        /*                                                                */
      794     3228        /******************************************************************/
      795     3229    4               DO;

      796     3230    4                   IPT_FCT.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);

   3230  3 003042   000021 220000 0                  LDX0    ZII$PARAMS+2
         3 003043   000052 471400 0                  LDP1    FPT$
         3 003044   100012 740100                    STX0    10,,PR1

      797     3231    4                   CALL CHK_RETAIN(IPT_FCT.V.RLCW,0);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:142  
   3231  3 003045   000021 236000 4                  LDQ     17
         3 003046   200012 756100                    STQ     @RLCW+1,,AUTO
         3 003047   000052 236000 0                  LDQ     FPT$
         3 003050   000013 036003                    ADLQ    11,DU
         3 003051   200011 756100                    STQ     @A+2,,AUTO
         3 003052   000475 701000 3                  TSX1    CHK_RETAIN
         3 003053   000000 011000                    NOP     0

      798     3232    4                   IPT_FCT.V_ = VECTOR(IPT_FCT.V);

   3232  3 003054   000013 235000 4                  LDA     11
         3 003055   000052 236000 0                  LDQ     FPT$
         3 003056   000012 036003                    ADLQ    10,DU
         3 003057   000052 470400 0                  LDP0    FPT$
         3 003060   000000 757100                    STAQ    0,,PR0

      799     3233    4                   VBOUND(IPT_FCT.V_) = VBOUND(IPT_FCT.V_) + SIZEC(IPT_FCT.V.
              3233                            RETENTION_LIST) * RLCW_SAVE.N_SETS#;

   3233  3 003061   000000 236100                    LDQ     0,,PR0
         3 003062   000020 772000                    QRL     16
         3 003063   200014 756100                    STQ     @N+2,,AUTO
         3 003064   000053 471400 0                  LDP1    RLCW$
         3 003065   003100 061500                    CSR     bolr='003'O
         3 003066   100000 610010                    BDSC    0,,PR1                   by=3,bit=1,n=8
         3 003067   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 003070   200015 236100                    LDQ     @N+3,,AUTO
         3 003071   000002 736000                    QLS     2
         3 003072   200014 036100                    ADLQ    @N+2,,AUTO
         3 003073   000020 736000                    QLS     16
         3 003074   000000 676100                    ERQ     0,,PR0
         3 003075   000012 376000 4                  ANQ     10
         3 003076   000000 656100                    ERSQ    0,,PR0

      800     3234                        %CLIMB(FCN=FCT);

   3242  3 003077   000000 713400 xsym               CLIMB   I$FCT
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:143  
         3 003100   402000 600000 xsid               climb   nvectors=         5

      801     3248    4                   END;

   3248  3 003101   003527 710000 3                  TRA     s:3432

      802     3249    3               ELSE
      803     3250         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:144  
      804     3251        /****************************************************************/
      805     3252        /*                                                              */
      806     3253        /*       TYPE OF FIND: RELATIVE TO A SET OR A AREA              */
      807     3254        /*                                                              */
      808     3255        /*                 PRIOR                                        */
      809     3256        /*       CALL FIND(CURRENT,[REC-NAME],[WITHIN],SET-NAME)        */
      810     3257        /*                 NEXT               AREA-NAME                 */
      811     3258        /*                                                              */
      812     3259        /****************************************************************/
      813     3260    4               DO;

      814     3261    4                   IF PARAMS(1)=%PRIOR THEN

   3261  3 003102   000020 236000 0                  LDQ     ZII$PARAMS+1
         3 003103   000027 116007                    CMPQ    23,DL
         3 003104   003111 601000 3                  TNZ     s:3264

      815     3262    4                       IPT_FRS.V.FCW.RECORD_LOCATION#=0;

   3262  3 003105   000000 220003                    LDX0    0,DU
         3 003106   000052 471400 0                  LDP1    FPT$
         3 003107   100012 740100                    STX0    10,,PR1
         3 003110   003122 710000 3                  TRA     s:3268

      816     3263    4                   ELSE
      817     3264    4                       IF PARAMS(1)=%CURRENT THEN

   3264  3 003111   000013 116007                    CMPQ    11,DL
         3 003112   003117 601000 3                  TNZ     s:3267

      818     3265    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=1;

   3265  3 003113   000001 220003                    LDX0    1,DU
         3 003114   000052 471400 0                  LDP1    FPT$
         3 003115   100012 740100                    STX0    10,,PR1
         3 003116   003122 710000 3                  TRA     s:3268

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:145  
      819     3266    4                       ELSE
      820     3267    4                           IPT_FRS.V.FCW.RECORD_LOCATION#=2;

   3267  3 003117   000002 220003                    LDX0    2,DU
         3 003120   000052 471400 0                  LDP1    FPT$
         3 003121   100012 740100                    STX0    10,,PR1

      821     3268    4                   IF TYPE_OF_ARG(2)=%RECORD_NAME THEN

   3268  3 003122   003100 060500                    CSL     bolr='003'O
         3 003123   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 003124   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003125   200014 236100                    LDQ     @N+2,,AUTO
         3 003126   000033 732000                    QRS     27
         3 003127   000004 116007                    CMPQ    4,DL
         3 003130   003136 601000 3                  TNZ     s:3275

      822     3269    5                   DO;

      823     3270    5                       I=3;

   3270  3 003131   000003 235007                    LDA     3,DL
         3 003132   000055 755000 0                  STA     I

      824     3271    5                       IPT_FRS.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);

   3271  3 003133   000021 220000 0                  LDX0    ZII$PARAMS+2
         3 003134   100013 740100                    STX0    11,,PR1

      825     3272    5                       END;

   3272  3 003135   003142 710000 3                  TRA     s:3278

      826     3273    4                   ELSE
      827     3274    5                   DO;

      828     3275    5                       I=2;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:146  

   3275  3 003136   000002 235007                    LDA     2,DL
         3 003137   000055 755000 0                  STA     I

      829     3276    5                       IPT_FRS.V.RC.RC_OFFSET#=NULL_OFFSET;

   3276  3 003140   000064 720000 0                  LXL0    NULL_OFFSET
         3 003141   100013 740100                    STX0    11,,PR1

      830     3277    5                       END;

      831     3278    4                   IF PARAMS(0)>I AND TYPE_OF_ARG(I)~=%WITHIN THEN

   3278  3 003142   000017 236000 0                  LDQ     ZII$PARAMS
         3 003143   000055 116000 0                  CMPQ    I
         3 003144   003162 604400 3                  TMOZ    s:3280
         3 003145   000055 236000 0                  LDQ     I
         3 003146   000011 402007                    MPY     9,DL
         3 003147   000000 116003                    CMPQ    0,DU
         3 003150   003152 605000 3                  TPL     s:3278+8
         3 003151   000044 036003                    ADLQ    36,DU
         3 003152   003100 060506                    CSL     bolr='003'O
         3 003153   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 003154   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003155   200014 236100                    LDQ     @N+2,,AUTO
         3 003156   000033 732000                    QRS     27
         3 003157   000041 116007                    CMPQ    33,DL
         3 003160   003162 600000 3                  TZE     s:3280

      832     3279    4                       ALTRETURN;

   3279  3 003161   000000 702200 xent               TSX2  ! X66_AALT

      833     3280    4                   IPT_FRS.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));

   3280  3 003162   000017 720000 0                  LXL0    ZII$PARAMS
         3 003163   000017 221010 0                  LDX1    ZII$PARAMS,X0
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:147  
         3 003164   100014 741100                    STX1    12,,PR1

      834     3281    4                   CALL CHK_RETAIN(IPT_FRS.V.RLCW,0);

   3281  3 003165   000021 236000 4                  LDQ     17
         3 003166   200012 756100                    STQ     @RLCW+1,,AUTO
         3 003167   000052 236000 0                  LDQ     FPT$
         3 003170   000015 036003                    ADLQ    13,DU
         3 003171   200011 756100                    STQ     @A+2,,AUTO
         3 003172   000475 701000 3                  TSX1    CHK_RETAIN
         3 003173   000000 011000                    NOP     0

      835     3282    5                   DO CASE(TYPE_OF_ARG(PARAMS(0)));

   3282  3 003174   000017 236000 0                  LDQ     ZII$PARAMS
         3 003175   000011 402007                    MPY     9,DL
         3 003176   000000 116003                    CMPQ    0,DU
         3 003177   003201 605000 3                  TPL     s:3282+5
         3 003200   000044 036003                    ADLQ    36,DU
         3 003201   000051 470400 0                  LDP0    ARG$
         3 003202   003100 060506                    CSL     bolr='003'O
         3 003203   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 003204   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003205   200014 236100                    LDQ     @N+2,,AUTO
         3 003206   000033 732000                    QRS     27
         3 003207   000004 116007                    CMPQ    4,DL
         3 003210   003212 602006 3                  TNC     s:3282+14,QL
         3 003211   003256 710000 3                  TRA     s:3318
         3 003212   003256 710000 3                  TRA     s:3318
         3 003213   003256 710000 3                  TRA     s:3318
         3 003214   003216 710000 3                  TRA     s:3285
         3 003215   003227 710000 3                  TRA     s:3301

      836     3283
      837     3284    5                   CASE(%AREA_NAME);

      838     3285    5                       IPT_FRA.V_ = VECTOR(IPT_FRA.V);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:148  

   3285  3 003216   000022 235000 4                  LDA     18
         3 003217   000052 236000 0                  LDQ     FPT$
         3 003220   000012 036003                    ADLQ    10,DU
         3 003221   000052 471400 0                  LDP1    FPT$
         3 003222   100000 757100                    STAQ    0,,PR1

      839     3286                            %CLIMB(FCN=FRA);

   3294  3 003223   100000 630500                    EPPR0   0,,PR1
         3 003224   000000 713400 xsym               CLIMB   I$FRA
         3 003225   402000 600000 xsid               climb   nvectors=         5
         3 003226   003527 710000 3                  TRA     s:3432

      840     3300    5                   CASE(%SET_NAME);

      841     3301    5                       IPT_FRS.V_ = VECTOR(IPT_FRS.V);

   3301  3 003227   000022 235000 4                  LDA     18
         3 003230   000052 236000 0                  LDQ     FPT$
         3 003231   000012 036003                    ADLQ    10,DU
         3 003232   000052 471400 0                  LDP1    FPT$
         3 003233   100000 757100                    STAQ    0,,PR1

      842     3302    5                       VBOUND(IPT_FRS.V_) = VBOUND(IPT_FRS.V_) + SIZEC(IPT_FRS.V.
              3302                                RETENTION_LIST) * RLCW_SAVE.N_SETS#;

   3302  3 003234   100000 236100                    LDQ     0,,PR1
         3 003235   000020 772000                    QRL     16
         3 003236   200014 756100                    STQ     @N+2,,AUTO
         3 003237   000053 473400 0                  LDP3    RLCW$
         3 003240   003100 061500                    CSR     bolr='003'O
         3 003241   300000 610010                    BDSC    0,,PR3                   by=3,bit=1,n=8
         3 003242   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 003243   200015 236100                    LDQ     @N+3,,AUTO
         3 003244   000002 736000                    QLS     2
         3 003245   200014 036100                    ADLQ    @N+2,,AUTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:149  
         3 003246   000020 736000                    QLS     16
         3 003247   100000 676100                    ERQ     0,,PR1
         3 003250   000012 376000 4                  ANQ     10
         3 003251   100000 656100                    ERSQ    0,,PR1

      843     3303                            %CLIMB(FCN=FRS);

   3311  3 003252   100000 630500                    EPPR0   0,,PR1
         3 003253   000000 713400 xsym               CLIMB   I$FRS
         3 003254   402000 600000 xsid               climb   nvectors=         5
         3 003255   003527 710000 3                  TRA     s:3432

      844     3317    5                   CASE(ELSE);

      845     3318    5                       ALTRETURN;

   3318  3 003256   000000 702200 xent               TSX2  ! X66_AALT

      846     3319    5                       END;

      847     3320    4                   END;
      848     3321    3           CASE(%OWNER);

      849     3322
      850     3323        /***************************************************************/
      851     3324        /*                                                             */
      852     3325        /*       TYPE OF FIND: OWNER OF A SET                          */
      853     3326        /*                                                             */
      854     3327        /*       CALL FIND(OWNER[,WITHIN],SET-NAME)                    */
      855     3328        /*                                                             */
      856     3329        /***************************************************************/
      857     3330
      858     3331    3               IF TYPE_OF_ARG(PARAMS(0))~=%SET_NAME THEN ALTRETURN;

   3331  3 003257   000017 236000 0                  LDQ     ZII$PARAMS
         3 003260   000011 402007                    MPY     9,DL
         3 003261   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:150  
         3 003262   003264 605000 3                  TPL     s:3331+5
         3 003263   000044 036003                    ADLQ    36,DU
         3 003264   003100 060506                    CSL     bolr='003'O
         3 003265   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 003266   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003267   200014 236100                    LDQ     @N+2,,AUTO
         3 003270   000033 732000                    QRS     27
         3 003271   000003 116007                    CMPQ    3,DL
         3 003272   003274 600000 3                  TZE     s:3332

   3331  3 003273   000000 702200 xent               TSX2  ! X66_AALT

      859     3332    3               IF PARAMS(0)>=3 AND TYPE_OF_ARG(2)~=%WITHIN

   3332  3 003274   000017 235000 0                  LDA     ZII$PARAMS
         3 003275   000003 115007                    CMPA    3,DL
         3 003276   003307 604000 3                  TMI     s:3334
         3 003277   003100 060500                    CSL     bolr='003'O
         3 003300   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 003301   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003302   200014 236100                    LDQ     @N+2,,AUTO
         3 003303   000033 732000                    QRS     27
         3 003304   000041 116007                    CMPQ    33,DL
         3 003305   003307 600000 3                  TZE     s:3334

      860     3333    3               THEN ALTRETURN;

   3333  3 003306   000000 702200 xent               TSX2  ! X66_AALT

      861     3334    3               IPT_FOR.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));

   3334  3 003307   000017 220005 0                  LDX0    ZII$PARAMS,AL
         3 003310   000052 471400 0                  LDP1    FPT$
         3 003311   100012 740100                    STX0    10,,PR1

      862     3335    3               IPT_FOR.V_ = VECTOR(IPT_FOR.V);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:151  
   3335  3 003312   000013 235000 4                  LDA     11
         3 003313   000052 236000 0                  LDQ     FPT$
         3 003314   000012 036003                    ADLQ    10,DU
         3 003315   100000 757100                    STAQ    0,,PR1

      863     3336    3              VBOUND(IPT_FOR.V_) = VBOUND(IPT_FOR.V_) + SIZEC(IPT_FOR.V.RETENTION_LIST
              3336                        ) * RLCW_SAVE.N_SETS#;

   3336  3 003316   100000 236100                    LDQ     0,,PR1
         3 003317   000020 772000                    QRL     16
         3 003320   200014 756100                    STQ     @N+2,,AUTO
         3 003321   000053 473400 0                  LDP3    RLCW$
         3 003322   003100 061500                    CSR     bolr='003'O
         3 003323   300000 610010                    BDSC    0,,PR3                   by=3,bit=1,n=8
         3 003324   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 003325   200015 236100                    LDQ     @N+3,,AUTO
         3 003326   000002 736000                    QLS     2
         3 003327   200014 036100                    ADLQ    @N+2,,AUTO
         3 003330   000020 736000                    QLS     16
         3 003331   100000 676100                    ERQ     0,,PR1
         3 003332   000012 376000 4                  ANQ     10
         3 003333   100000 656100                    ERSQ    0,,PR1

      864     3337    3               CALL CHK_RETAIN(IPT_FOR.V.RLCW,0);

   3337  3 003334   000021 236000 4                  LDQ     17
         3 003335   200012 756100                    STQ     @RLCW+1,,AUTO
         3 003336   000052 236000 0                  LDQ     FPT$
         3 003337   000013 036003                    ADLQ    11,DU
         3 003340   200011 756100                    STQ     @A+2,,AUTO
         3 003341   000475 701000 3                  TSX1    CHK_RETAIN
         3 003342   000000 011000                    NOP     0

      865     3338                    %CLIMB(FCN=FOR);

   3346  3 003343   000052 470400 0                  LDP0    FPT$
         3 003344   000000 713400 xsym               CLIMB   I$FOR
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:152  
         3 003345   402000 600000 xsid               climb   nvectors=         5
         3 003346   003527 710000 3                  TRA     s:3432

      866     3352    3           CASE(%FIRST,%LAST,%APL_IDP);

      867     3353         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:153  
      868     3354        /**************************************************************/
      869     3355        /*                                                            */
      870     3356        /*       TYPE OF FIND: I-TH NUMBER WITHIN A SET OR A AREA     */
      871     3357        /*                                                            */
      872     3358        /*       CALL FIND(FIRST,[REC-NAME],[WITHIN],SET-NAME )       */
      873     3359        /*                 LAST             AREA-NAME                 */
      874     3360        /*                 INTEGER                                    */
      875     3361        /*                 IDENTIFIER                                 */
      876     3362        /*                                                            */
      877     3363        /**************************************************************/
      878     3364
      879     3365    3               IPT_FAA.V.AC.AC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));

   3365  3 003347   000017 720000 0                  LXL0    ZII$PARAMS
         3 003350   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 003351   000052 471400 0                  LDP1    FPT$
         3 003352   100014 741100                    STX1    12,,PR1

      880     3366    3               IF PARAMS(1)=%LAST THEN

   3366  3 003353   000020 235000 0                  LDA     ZII$PARAMS+1
         3 003354   000021 115007                    CMPA    17,DL
         3 003355   003361 601000 3                  TNZ     s:3369

      881     3367    3                   IPT_FAS.V.RECORD_NUMBER#=-1;

   3367  3 003356   000001 336007                    LCQ     1,DL
         3 003357   100012 756100                    STQ     10,,PR1
         3 003360   003374 710000 3                  TRA     s:3377

      882     3368    3               ELSE
      883     3369    3                   IF PARAMS(1)=%FIRST THEN

   3369  3 003361   000016 115007                    CMPA    14,DL
         3 003362   003366 601000 3                  TNZ     s:3372

      884     3370    3                       IPT_FAS.V.RECORD_NUMBER#=1;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:154  

   3370  3 003363   000001 236007                    LDQ     1,DL
         3 003364   100012 756100                    STQ     10,,PR1
         3 003365   003374 710000 3                  TRA     s:3377

      885     3371    3                   ELSE
      886     3372    3                       IF PARAMS(1)=%APL_IDP THEN

   3372  3 003366   000001 115007                    CMPA    1,DL
         3 003367   003373 601000 3                  TNZ     s:3375

      887     3373    3                           IPT_FAS.V.RECORD_NUMBER#=ZII$INTEGER1;

   3373  3 003370   000000 236000 0                  LDQ     ZII$INTEGER1
         3 003371   100012 756100                    STQ     10,,PR1
         3 003372   003374 710000 3                  TRA     s:3377

      888     3374    3                       ELSE
      889     3375    3                           ALTRETURN;

   3375  3 003373   000000 702200 xent               TSX2  ! X66_AALT

      890     3376
      891     3377    3               IF TYPE_OF_ARG(2)=%RECORD_NAME THEN

   3377  3 003374   003100 060500                    CSL     bolr='003'O
         3 003375   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 003376   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003377   200014 236100                    LDQ     @N+2,,AUTO
         3 003400   000033 732000                    QRS     27
         3 003401   000004 116007                    CMPQ    4,DL
         3 003402   003410 601000 3                  TNZ     s:3384

      892     3378    4               DO;

      893     3379    4                   I=3;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:155  
   3379  3 003403   000003 235007                    LDA     3,DL
         3 003404   000055 755000 0                  STA     I

      894     3380    4                   IPT_FAS.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(2);

   3380  3 003405   000021 220000 0                  LDX0    ZII$PARAMS+2
         3 003406   100013 740100                    STX0    11,,PR1

      895     3381    4                   END;

   3381  3 003407   003414 710000 3                  TRA     s:3387

      896     3382    3               ELSE
      897     3383    4               DO;

      898     3384    4                   I=2;

   3384  3 003410   000002 235007                    LDA     2,DL
         3 003411   000055 755000 0                  STA     I

      899     3385    4                   IPT_FAS.V.RC.RC_OFFSET#=NULL_OFFSET;

   3385  3 003412   000064 720000 0                  LXL0    NULL_OFFSET
         3 003413   100013 740100                    STX0    11,,PR1

      900     3386    4                   END;

      901     3387    3               IF PARAMS(0)>I AND TYPE_OF_ARG(I)~=%WITHIN THEN

   3387  3 003414   000017 236000 0                  LDQ     ZII$PARAMS
         3 003415   000055 116000 0                  CMPQ    I
         3 003416   003434 604400 3                  TMOZ    s:3389
         3 003417   000055 236000 0                  LDQ     I
         3 003420   000011 402007                    MPY     9,DL
         3 003421   000000 116003                    CMPQ    0,DU
         3 003422   003424 605000 3                  TPL     s:3387+8
         3 003423   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:156  
         3 003424   003100 060506                    CSL     bolr='003'O
         3 003425   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 003426   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003427   200014 236100                    LDQ     @N+2,,AUTO
         3 003430   000033 732000                    QRS     27
         3 003431   000041 116007                    CMPQ    33,DL
         3 003432   003434 600000 3                  TZE     s:3389

      902     3388    3                   ALTRETURN;

   3388  3 003433   000000 702200 xent               TSX2  ! X66_AALT

      903     3389    3               CALL CHK_RETAIN(IPT_FAS.V.RLCW,0);

   3389  3 003434   000021 236000 4                  LDQ     17
         3 003435   200012 756100                    STQ     @RLCW+1,,AUTO
         3 003436   000052 236000 0                  LDQ     FPT$
         3 003437   000015 036003                    ADLQ    13,DU
         3 003440   200011 756100                    STQ     @A+2,,AUTO
         3 003441   000475 701000 3                  TSX1    CHK_RETAIN
         3 003442   000000 011000                    NOP     0

      904     3390    4               DO CASE(TYPE_OF_ARG(PARAMS(0)));

   3390  3 003443   000017 236000 0                  LDQ     ZII$PARAMS
         3 003444   000011 402007                    MPY     9,DL
         3 003445   000000 116003                    CMPQ    0,DU
         3 003446   003450 605000 3                  TPL     s:3390+5
         3 003447   000044 036003                    ADLQ    36,DU
         3 003450   000051 470400 0                  LDP0    ARG$
         3 003451   003100 060506                    CSL     bolr='003'O
         3 003452   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 003453   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003454   200014 236100                    LDQ     @N+2,,AUTO
         3 003455   000033 732000                    QRS     27
         3 003456   000004 116007                    CMPQ    4,DL
         3 003457   003461 602006 3                  TNC     s:3390+14,QL
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:157  
         3 003460   003525 710000 3                  TRA     s:3426
         3 003461   003525 710000 3                  TRA     s:3426
         3 003462   003525 710000 3                  TRA     s:3426
         3 003463   003465 710000 3                  TRA     s:3393
         3 003464   003514 710000 3                  TRA     s:3410

      905     3391
      906     3392    4               CASE(%AREA_NAME);

      907     3393    4                   IPT_FAA.V_ = VECTOR(IPT_FAA.V);

   3393  3 003465   000022 235000 4                  LDA     18
         3 003466   000052 236000 0                  LDQ     FPT$
         3 003467   000012 036003                    ADLQ    10,DU
         3 003470   000052 471400 0                  LDP1    FPT$
         3 003471   100000 757100                    STAQ    0,,PR1

      908     3394    4                   VBOUND(IPT_FAA.V_) = VBOUND(IPT_FAA.V_) + SIZEC(IPT_FAA.V.
              3394                            RETENTION_LIST) * RLCW_SAVE.N_SETS#;

   3394  3 003472   100000 236100                    LDQ     0,,PR1
         3 003473   000020 772000                    QRL     16
         3 003474   200014 756100                    STQ     @N+2,,AUTO
         3 003475   000053 473400 0                  LDP3    RLCW$
         3 003476   003100 061500                    CSR     bolr='003'O
         3 003477   300000 610010                    BDSC    0,,PR3                   by=3,bit=1,n=8
         3 003500   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 003501   200015 236100                    LDQ     @N+3,,AUTO
         3 003502   000002 736000                    QLS     2
         3 003503   200014 036100                    ADLQ    @N+2,,AUTO
         3 003504   000020 736000                    QLS     16
         3 003505   100000 676100                    ERQ     0,,PR1
         3 003506   000012 376000 4                  ANQ     10
         3 003507   100000 656100                    ERSQ    0,,PR1

      909     3395                        %CLIMB(FCN=FAA);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:158  
   3403  3 003510   100000 630500                    EPPR0   0,,PR1
         3 003511   000000 713400 xsym               CLIMB   I$FAA
         3 003512   402000 600000 xsid               climb   nvectors=         5
         3 003513   003527 710000 3                  TRA     s:3432

      910     3409    4               CASE(%SET_NAME);

      911     3410    4                   IPT_FAS.V_ = VECTOR(IPT_FAS.V);

   3410  3 003514   000022 235000 4                  LDA     18
         3 003515   000052 236000 0                  LDQ     FPT$
         3 003516   000012 036003                    ADLQ    10,DU
         3 003517   000052 471400 0                  LDP1    FPT$
         3 003520   100000 757100                    STAQ    0,,PR1

      912     3411                        %CLIMB(FCN=FAS);

   3419  3 003521   100000 630500                    EPPR0   0,,PR1
         3 003522   000000 713400 xsym               CLIMB   I$FAS
         3 003523   402000 600000 xsid               climb   nvectors=         5
         3 003524   003527 710000 3                  TRA     s:3432

      913     3425    4               CASE(ELSE);

      914     3426    4                   ALTRETURN;

   3426  3 003525   000000 702200 xent               TSX2  ! X66_AALT

      915     3427    4                   END;

      916     3428    3           CASE(ELSE);

      917     3429    3               ALTRETURN;

   3429  3 003526   000000 702200 xent               TSX2  ! X66_AALT

      918     3430    3               END;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:159  

      919     3431    2           END;
      920     3432    1       GOTO COMMON_RETURN;

   3432  3 003527   004370 710000 3                  TRA     COMMON_RETURN

      921     3433         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:160  
      922     3434        /***************************************************************/
      923     3435        /*                                                             */
      924     3436        /*     CALLING SEQUENCE FOR GET:                               */
      925     3437        /*          1. CALL GET                                        */
      926     3438        /*          2. CALL GET(REC-NAME)                              */
      927     3439        /*          3. CALL GET(FIELD-1,[FIELD-2],.....])              */
      928     3440        /*                                                             */
      929     3441        /***************************************************************/
      930     3442
      931     3443    1   ZII$GET: ENTRY ALTRET;

   3443  3 003530   000000 700200 xent  ZII$GET      TSX0  ! X66_AUTO_3
         3 003531   000020 000003                    ZERO    16,3

      932     3444
      933     3445    1       CALL SET_ARGS;

   3445  3 003532   000003 701000 3                  TSX1    SET_ARGS
         3 003533   000000 011000                    NOP     0

      934     3446    1       IF PARAMS(0)>0 AND TYPE_OF_ARG(1)=%FIELD_NAME THEN

   3446  3 003534   000017 235000 0                  LDA     ZII$PARAMS
         3 003535   003613 604400 3                  TMOZ    s:3472
         3 003536   000051 470400 0                  LDP0    ARG$
         3 003537   003100 060500                    CSL     bolr='003'O
         3 003540   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 003541   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003542   200014 236100                    LDQ     @N+2,,AUTO
         3 003543   000033 732000                    QRS     27
         3 003544   000005 116007                    CMPQ    5,DL
         3 003545   003613 601000 3                  TNZ     s:3472

      935     3447    2       DO;

      936     3448    2           ADDR(IPT_GTF.V.FLCW)->SBIN36=0;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:161  
   3448  3 003546   000052 471400 0                  LDP1    FPT$
         3 003547   100012 450100                    STZ     10,,PR1

      937     3449    2           IPT_GTF.V.FLCW.N_FIELDS#=PARAMS(0);

   3449  3 003550   000017 720000 0                  LXL0    ZII$PARAMS
         3 003551   100012 740100                    STX0    10,,PR1

      938     3450    3           DO I=1 TO PARAMS(0);

   3450  3 003552   000001 235007                    LDA     1,DL
         3 003553   000055 755000 0                  STA     I
         3 003554   003600 710000 3                  TRA     s:3453+1

      939     3451    3               IF TYPE_OF_ARG(I)~=%FIELD_NAME THEN ALTRETURN;

   3451  3 003555   000055 236000 0                  LDQ     I
         3 003556   000011 402007                    MPY     9,DL
         3 003557   000000 116003                    CMPQ    0,DU
         3 003560   003562 605000 3                  TPL     s:3451+5
         3 003561   000044 036003                    ADLQ    36,DU
         3 003562   000051 470400 0                  LDP0    ARG$
         3 003563   003100 060506                    CSL     bolr='003'O
         3 003564   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 003565   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003566   200014 236100                    LDQ     @N+2,,AUTO
         3 003567   000033 732000                    QRS     27
         3 003570   000005 116007                    CMPQ    5,DL
         3 003571   003573 600000 3                  TZE     s:3452

   3451  3 003572   000000 702200 xent               TSX2  ! X66_AALT

      940     3452    3               IPT_GTF.V.FIELD_LIST.RVA_OFFSET#(I-1)=ZII$PARAMS.OFFSET(I);

   3452  3 003573   000055 720000 0                  LXL0    I
         3 003574   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 003575   000052 471400 0                  LDP1    FPT$
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:162  
         3 003576   100012 741110                    STX1    10,X0,PR1

      941     3453    3               END;

   3453  3 003577   000055 054000 0                  AOS     I
         3 003600   000055 236000 0                  LDQ     I
         3 003601   000017 116000 0                  CMPQ    ZII$PARAMS
         3 003602   003555 604400 3                  TMOZ    s:3451

      942     3454    2           IPT_GTF.V_ = VECTOR(IPT_GTF.V);

   3454  3 003603   000011 235000 4                  LDA     9
         3 003604   000052 236000 0                  LDQ     FPT$
         3 003605   000012 036003                    ADLQ    10,DU
         3 003606   100000 757100                    STAQ    0,,PR1

      943     3455                %CLIMB(FCN=GTF);

   3463  3 003607   100000 630500                    EPPR0   0,,PR1
         3 003610   000000 713400 xsym               CLIMB   I$GTF
         3 003611   402000 600000 xsid               climb   nvectors=         5

      944     3469    2           END;

   3469  3 003612   003661 710000 3                  TRA     s:3495

      945     3470    1       ELSE
      946     3471    2       DO;

      947     3472    2           IF PARAMS(0)=0 THEN

   3472  3 003613   000000 115003                    CMPA    0,DU
         3 003614   003621 601000 3                  TNZ     s:3475

      948     3473    2               IPT_GET.V.RC.RC_OFFSET#=NULL_OFFSET;

   3473  3 003615   000064 720000 0                  LXL0    NULL_OFFSET
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:163  
         3 003616   000052 470400 0                  LDP0    FPT$
         3 003617   000012 740100                    STX0    10,,PR0
         3 003620   003640 710000 3                  TRA     s:3478

      949     3474    2           ELSE
      950     3475    2               IF PARAMS(0)=1 AND TYPE_OF_ARG(1)=%RECORD_NAME THEN

   3475  3 003621   000001 115007                    CMPA    1,DL
         3 003622   003637 601000 3                  TNZ     s:3477
         3 003623   000051 470400 0                  LDP0    ARG$
         3 003624   003100 060500                    CSL     bolr='003'O
         3 003625   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 003626   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003627   200014 236100                    LDQ     @N+2,,AUTO
         3 003630   000033 732000                    QRS     27
         3 003631   000004 116007                    CMPQ    4,DL
         3 003632   003637 601000 3                  TNZ     s:3477

      951     3476    2                   IPT_GET.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

   3476  3 003633   000020 220000 0                  LDX0    ZII$PARAMS+1
         3 003634   000052 471400 0                  LDP1    FPT$
         3 003635   100012 740100                    STX0    10,,PR1
         3 003636   003640 710000 3                  TRA     s:3478

      952     3477    2               ELSE ALTRETURN;

   3477  3 003637   000000 702200 xent               TSX2  ! X66_AALT

      953     3478    2           IPT_GTF.V_ = VECTOR(IPT_GTF.V);

   3478  3 003640   000011 235000 4                  LDA     9
         3 003641   000052 236000 0                  LDQ     FPT$
         3 003642   000012 036003                    ADLQ    10,DU
         3 003643   000052 470400 0                  LDP0    FPT$
         3 003644   000000 757100                    STAQ    0,,PR0

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:164  
      954     3479    2           VBOUND(IPT_GTF.V_) = VBOUND(IPT_GTF.V_) + SIZEC(IPT_GTF.V.FIELD_LIST) *
              3479                    PARAMS(0);

   3479  3 003645   000000 236100                    LDQ     0,,PR0
         3 003646   000020 772000                    QRL     16
         3 003647   200014 756100                    STQ     @N+2,,AUTO
         3 003650   000017 236000 0                  LDQ     ZII$PARAMS
         3 003651   000002 736000                    QLS     2
         3 003652   200014 036100                    ADLQ    @N+2,,AUTO
         3 003653   000020 736000                    QLS     16
         3 003654   000000 676100                    ERQ     0,,PR0
         3 003655   000012 376000 4                  ANQ     10
         3 003656   000000 656100                    ERSQ    0,,PR0

      955     3480                %CLIMB(FCN=GET);

   3488  3 003657   000000 713400 xsym               CLIMB   I$GET
         3 003660   402000 600000 xsid               climb   nvectors=         5

      956     3494    2           END;

      957     3495    1       GOTO COMMON_RETURN;

   3495  3 003661   004370 710000 3                  TRA     COMMON_RETURN

      958     3496         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:165  
      959     3497    1   ZII$MODIFY: ENTRY ALTRET;

   3497  3 003662   000000 700200 xent  ZII$MODIFY   TSX0  ! X66_AUTO_3
         3 003663   000020 000003                    ZERO    16,3

      960     3498
      961     3499        /****************************************************************/
      962     3500        /*                                                              */
      963     3501        /*    CALL MODIFY([REC-NAME],[INCLUDING,ALL             ])        */
      964     3502        /*                           ONLY      SET-NAME1,[...]            */
      965     3503        /*                                                                */
      966     3504        /*    CALL MODIFY(IDENT-1,[IDENT-2],...,,[INCLUDING,ALL       ])  */
      967     3505        /*                                                SET-NAME-LIST   */
      968     3506        /*                                                                */
      969     3507        /******************************************************************/
      970     3508
      971     3509    1       CALL SET_ARGS;

   3509  3 003664   000003 701000 3                  TSX1    SET_ARGS
         3 003665   000000 011000                    NOP     0

      972     3510    1       IPT_MOD.V.RC.RC_OFFSET#=NULL_OFFSET;

   3510  3 003666   000064 720000 0                  LXL0    NULL_OFFSET
         3 003667   000052 470400 0                  LDP0    FPT$
         3 003670   000012 740100                    STX0    10,,PR0

      973     3511    1       ADDR(IPT_MOD.V.FLCW)->SBIN36=0;

   3511  3 003671   000014 450100                    STZ     12,,PR0

      974     3512    1       ADDR(IPT_MOD.V.MCW)->SBIN36=0;

   3512  3 003672   000013 450100                    STZ     11,,PR0

      975     3513    1       ADDR(IPT_MOD.V.SLCW)->SBIN36=0;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:166  
   3513  3 003673   000015 450100                    STZ     13,,PR0

      976     3514    1       K = 0;

   3514  3 003674   000057 450000 0                  STZ     K

      977     3515    1       IF PARAMS(0)>0 THEN

   3515  3 003675   000017 235000 0                  LDA     ZII$PARAMS
         3 003676   004106 604400 3                  TMOZ    s:3560

      978     3516    2       DO;

      979     3517    2           K=1;

   3517  3 003677   000001 236007                    LDQ     1,DL
         3 003700   000057 756000 0                  STQ     K

      980     3518    2           I=0;

   3518  3 003701   000055 450000 0                  STZ     I

      981     3519    2           IF TYPE_OF_ARG(1)=%RECORD_NAME THEN

   3519  3 003702   000051 471400 0                  LDP1    ARG$
         3 003703   003100 060500                    CSL     bolr='003'O
         3 003704   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9
         3 003705   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003706   200014 236100                    LDQ     @N+2,,AUTO
         3 003707   000033 732000                    QRS     27
         3 003710   000004 116007                    CMPQ    4,DL
         3 003711   003717 601000 3                  TNZ     s:3525

      982     3520    3           DO;

      983     3521    3               K=2;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:167  
   3521  3 003712   000002 236007                    LDQ     2,DL
         3 003713   000057 756000 0                  STQ     K

      984     3522    3               IPT_MOD.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

   3522  3 003714   000020 221000 0                  LDX1    ZII$PARAMS+1
         3 003715   000012 741100                    STX1    10,,PR0

      985     3523    3               END;

   3523  3 003716   003760 710000 3                  TRA     s:3534

      986     3524    2           ELSE
      987     3525    2               IF TYPE_OF_ARG(1)=%FIELD_NAME THEN

   3525  3 003717   003100 060500                    CSL     bolr='003'O
         3 003720   100000 200011                    BDSC    0,,PR1                   by=1,bit=0,n=9
         3 003721   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003722   200014 236100                    LDQ     @N+2,,AUTO
         3 003723   000033 732000                    QRS     27
         3 003724   000005 116007                    CMPQ    5,DL
         3 003725   003760 601000 3                  TNZ     s:3534

      988     3526    3               DO;

      989     3527    4                   DO WHILE(TYPE_OF_ARG(K)=%FIELD_NAME AND K<=PARAMS(0));

   3527  3 003726   003736 710000 3                  TRA     s:3531

      990     3528    4                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(I)=ZII$PARAMS.OFFSET(K);

   3528  3 003727   000057 720000 0                  LXL0    K
         3 003730   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 003731   000052 470400 0                  LDP0    FPT$
         3 003732   000055 722000 0                  LXL2    I
         3 003733   000016 741112                    STX1    14,X2,PR0

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:168  
      991     3529    4                       I=I+1;

   3529  3 003734   000055 054000 0                  AOS     I

      992     3530    4                       K=K+1;

   3530  3 003735   000057 054000 0                  AOS     K

      993     3531    4                       END;

   3531  3 003736   000057 236000 0                  LDQ     K
         3 003737   000011 402007                    MPY     9,DL
         3 003740   000000 116003                    CMPQ    0,DU
         3 003741   003743 605000 3                  TPL     s:3531+5
         3 003742   000044 036003                    ADLQ    36,DU
         3 003743   000051 471400 0                  LDP1    ARG$
         3 003744   003100 060506                    CSL     bolr='003'O
         3 003745   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9
         3 003746   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 003747   200014 236100                    LDQ     @N+2,,AUTO
         3 003750   000033 732000                    QRS     27
         3 003751   000005 116007                    CMPQ    5,DL
         3 003752   003756 601000 3                  TNZ     s:3532
         3 003753   000057 236000 0                  LDQ     K
         3 003754   000017 116000 0                  CMPQ    ZII$PARAMS
         3 003755   003727 604400 3                  TMOZ    s:3528

      994     3532    3                   IPT_MOD.V.FLCW.N_FIELDS#=I;

   3532  3 003756   000055 720000 0                  LXL0    I
         3 003757   000014 740100                    STX0    12,,PR0

      995     3533    3                   END;

      996     3534    2           IF K<PARAMS(0) AND (PARAMS(K)=%INCLUDING OR PARAMS(K)=%ONLY) THEN

   3534  3 003760   000057 236000 0                  LDQ     K
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:169  
         3 003761   000017 116000 0                  CMPQ    ZII$PARAMS
         3 003762   004102 605000 3                  TPL     s:3558
         3 003763   000017 235006 0                  LDA     ZII$PARAMS,QL
         3 003764   000017 115007                    CMPA    15,DL
         3 003765   003772 600000 3                  TZE     s:3536
         3 003766   000057 720000 0                  LXL0    K
         3 003767   000017 235010 0                  LDA     ZII$PARAMS,X0
         3 003770   000025 115007                    CMPA    21,DL
         3 003771   004102 601000 3                  TNZ     s:3558

      997     3535    3           DO;

      998     3536    3               IF PARAMS(K)=%ONLY THEN

   3536  3 003772   000057 720000 0                  LXL0    K
         3 003773   000017 235010 0                  LDA     ZII$PARAMS,X0
         3 003774   000025 115007                    CMPA    21,DL
         3 003775   004003 601000 3                  TNZ     s:3541

      999     3537    4               DO;

     1000     3538    4                   IPT_MOD.V.MCW.MC_BIT0#='1'B;

   3538  3 003776   400000 236003                    LDQ     -131072,DU
         3 003777   000013 256100                    ORSQ    11,,PR0

     1001     3539    4                   IF I>0 THEN ALTRETURN;

   3539  3 004000   000055 235000 0                  LDA     I
         3 004001   004003 604400 3                  TMOZ    s:3541

   3539  3 004002   000000 702200 xent               TSX2  ! X66_AALT

     1002     3540    4                   END;
     1003     3541    3               K=K+1;

   3541  3 004003   000057 054000 0                  AOS     K
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:170  

     1004     3542    3               IF TYPE_OF_ARG(K)=%ALL THEN

   3542  3 004004   000057 236000 0                  LDQ     K
         3 004005   000011 402007                    MPY     9,DL
         3 004006   000000 116003                    CMPQ    0,DU
         3 004007   004011 605000 3                  TPL     s:3542+5
         3 004010   000044 036003                    ADLQ    36,DU
         3 004011   003100 060506                    CSL     bolr='003'O
         3 004012   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9
         3 004013   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004014   200014 236100                    LDQ     @N+2,,AUTO
         3 004015   000033 732000                    QRS     27
         3 004016   000006 116007                    CMPQ    6,DL
         3 004017   004023 601000 3                  TNZ     s:3546

     1005     3543    3                   IPT_MOD.V.MCW.MC_BIT1#='1'B;

   3543  3 004020   200000 236003                    LDQ     65536,DU
         3 004021   000013 256100                    ORSQ    11,,PR0
         3 004022   004106 710000 3                  TRA     s:3560

     1006     3544    3               ELSE
     1007     3545    4               DO;

     1008     3546    4                   J=PARAMS(0);

   3546  3 004023   000017 235000 0                  LDA     ZII$PARAMS
         3 004024   000056 755000 0                  STA     J

     1009     3547    4                   IF TYPE_OF_ARG(J)=%MEMBERSHIP THEN J=J-1;

   3547  3 004025   000056 236000 0                  LDQ     J
         3 004026   000011 402007                    MPY     9,DL
         3 004027   000000 116003                    CMPQ    0,DU
         3 004030   004032 605000 3                  TPL     s:3547+5
         3 004031   000044 036003                    ADLQ    36,DU
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:171  
         3 004032   003100 060506                    CSL     bolr='003'O
         3 004033   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9
         3 004034   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004035   200014 236100                    LDQ     @N+2,,AUTO
         3 004036   000033 732000                    QRS     27
         3 004037   000046 116007                    CMPQ    38,DL
         3 004040   004043 601000 3                  TNZ     s:3548

   3547  3 004041   000001 336007                    LCQ     1,DL
         3 004042   000056 056000 0                  ASQ     J

     1010     3548    5                   DO WHILE (K<=J);

   3548  3 004043   000057 236000 0                  LDQ     K
         3 004044   000056 116000 0                  CMPQ    J
         3 004045   004106 605400 3                  TPNZ    s:3560

     1011     3549    5                       IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#(I)=ZII$PARAMS.OFFSET(K);

   3549  3 004046   000057 720000 0                  LXL0    K
         3 004047   000017 221010 0                  LDX1    ZII$PARAMS,X0
         3 004050   000052 470400 0                  LDP0    FPT$
         3 004051   000055 722000 0                  LXL2    I
         3 004052   000016 741112                    STX1    14,X2,PR0

     1012     3550    5                       IF TYPE_OF_ARG(K)~=%SET_NAME THEN ALTRETURN;

   3550  3 004053   000057 236000 0                  LDQ     K
         3 004054   000011 402007                    MPY     9,DL
         3 004055   000000 116003                    CMPQ    0,DU
         3 004056   004060 605000 3                  TPL     s:3550+5
         3 004057   000044 036003                    ADLQ    36,DU
         3 004060   000051 471400 0                  LDP1    ARG$
         3 004061   003100 060506                    CSL     bolr='003'O
         3 004062   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9
         3 004063   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004064   200014 236100                    LDQ     @N+2,,AUTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:172  
         3 004065   000033 732000                    QRS     27
         3 004066   000003 116007                    CMPQ    3,DL
         3 004067   004071 600000 3                  TZE     s:3551

   3550  3 004070   000000 702200 xent               TSX2  ! X66_AALT

     1013     3551    5                       I=I+1;

   3551  3 004071   000055 054000 0                  AOS     I

     1014     3552    5                       IPT_MOD.V.SLCW.N_SETS#=IPT_MOD.V.SLCW.N_SETS#+1;

   3552  3 004072   000015 221100                    LDX1    13,,PR0
         3 004073   000001 622011                    EAX2    1,X1
         3 004074   000015 742100                    STX2    13,,PR0

     1015     3553    5                       K=K+1;

   3553  3 004075   000057 054000 0                  AOS     K

     1016     3554    5                       END;

   3554  3 004076   000057 236000 0                  LDQ     K
         3 004077   000056 116000 0                  CMPQ    J
         3 004100   004046 604400 3                  TMOZ    s:3549

     1017     3555    4                   END;

     1018     3556    3               END;

   3556  3 004101   004106 710000 3                  TRA     s:3560

     1019     3557    2           ELSE
     1020     3558    2               IF K<=PARAMS(0) THEN ALTRETURN;

   3558  3 004102   000057 236000 0                  LDQ     K
         3 004103   000017 116000 0                  CMPQ    ZII$PARAMS
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:173  
         3 004104   004106 605400 3                  TPNZ    s:3560

   3558  3 004105   000000 702200 xent               TSX2  ! X66_AALT

     1021     3559    2           END;
     1022     3560    1       IPT_MOD.V_ = VECTOR(IPT_MOD.V);

   3560  3 004106   000022 235000 4                  LDA     18
         3 004107   000052 236000 0                  LDQ     FPT$
         3 004110   000012 036003                    ADLQ    10,DU
         3 004111   000000 757100                    STAQ    0,,PR0

     1023     3561    1       VBOUND(IPT_MOD.V_) = VBOUND(IPT_MOD.V_) + SIZEC(IPT_MOD.V.FL_SL_LIST) * K;

   3561  3 004112   000000 236100                    LDQ     0,,PR0
         3 004113   000020 772000                    QRL     16
         3 004114   200014 756100                    STQ     @N+2,,AUTO
         3 004115   000057 236000 0                  LDQ     K
         3 004116   000002 736000                    QLS     2
         3 004117   200014 036100                    ADLQ    @N+2,,AUTO
         3 004120   000020 736000                    QLS     16
         3 004121   000000 676100                    ERQ     0,,PR0
         3 004122   000012 376000 4                  ANQ     10
         3 004123   000000 656100                    ERSQ    0,,PR0

     1024     3562            %CLIMB(FCN=MOD);

   3570  3 004124   000000 713400 xsym               CLIMB   I$MOD
         3 004125   402000 600000 xsid               climb   nvectors=         5

     1025     3576    1       GOTO COMMON_RETURN;

   3576  3 004126   004370 710000 3                  TRA     COMMON_RETURN

     1026     3577         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:174  
     1027     3578        /**   INTERNAL COMMON SUBROUTINE FOR CONNECT AND DISCONNECT   **/
     1028     3579
     1029     3580    1   CON_DIS: PROC(OPTION) ALTRET;

   3580  3 004127   200006 741300       CON_DIS      STX1  ! @A3+1,,AUTO

     1030     3581
     1031     3582    2   DCL OPTION UBIN;
     1032     3583
     1033     3584    2       CALL SET_ARGS;

   3584  3 004130   000003 701000 3                  TSX1    SET_ARGS
         3 004131   000000 011000                    NOP     0

     1034     3585
     1035     3586    2       IF TYPE_OF_ARG(PARAMS(0))~=%SET_NAME THEN ALTRETURN;

   3586  3 004132   000017 236000 0                  LDQ     ZII$PARAMS
         3 004133   000011 402007                    MPY     9,DL
         3 004134   000000 116003                    CMPQ    0,DU
         3 004135   004137 605000 3                  TPL     s:3586+5
         3 004136   000044 036003                    ADLQ    36,DU
         3 004137   000051 470400 0                  LDP0    ARG$
         3 004140   003100 060506                    CSL     bolr='003'O
         3 004141   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 004142   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004143   200014 236100                    LDQ     @N+2,,AUTO
         3 004144   000033 732000                    QRS     27
         3 004145   000003 116007                    CMPQ    3,DL
         3 004146   004151 600000 3                  TZE     s:3587

   3586  3 004147   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 004150   000000 702211                    TSX2  ! 0,X1

     1036     3587    2       IF PARAMS(0)=2 AND TYPE_OF_ARG(1)~=%RECORD_NAME AND

   3587  3 004151   000017 235000 0                  LDA     ZII$PARAMS
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:175  
         3 004152   000002 115007                    CMPA    2,DL
         3 004153   004176 601000 3                  TNZ     s:3590
         3 004154   003100 060500                    CSL     bolr='003'O
         3 004155   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 004156   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004157   200014 236100                    LDQ     @N+2,,AUTO
         3 004160   000033 732000                    QRS     27
         3 004161   000004 116007                    CMPQ    4,DL
         3 004162   004176 600000 3                  TZE     s:3590
         3 004163   200007 471500                    LDP1    @OPTION,,AUTO
         3 004164   003100 060500                    CSL     bolr='003'O
         3 004165   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 004166   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 004167   200015 236100                    LDQ     @N+3,,AUTO
         3 004170   000033 732000                    QRS     27
         3 004171   004174 604000 3                  TMI     s:3588
         3 004172   100000 116100                    CMPQ    0,,PR1
         3 004173   004176 600000 3                  TZE     s:3590

     1037     3588    2          TYPE_OF_ARG(1)~=OPTION THEN ALTRETURN;

   3588  3 004174   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 004175   000000 702211                    TSX2  ! 0,X1

     1038     3589    2       ELSE
     1039     3590    2           IF PARAMS(0)>=3 AND (TYPE_OF_ARG(1)~=%RECORD_NAME OR

   3590  3 004176   000003 115007                    CMPA    3,DL
         3 004177   004222 604000 3                  TMI     s:3592
         3 004200   003100 060500                    CSL     bolr='003'O
         3 004201   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 004202   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004203   200014 236100                    LDQ     @N+2,,AUTO
         3 004204   000033 732000                    QRS     27
         3 004205   000004 116007                    CMPQ    4,DL
         3 004206   004220 601000 3                  TNZ     s:3591
         3 004207   200007 471500                    LDP1    @OPTION,,AUTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:176  
         3 004210   003100 060500                    CSL     bolr='003'O
         3 004211   000000 400011                    BDSC    0,,PR0                   by=2,bit=0,n=9
         3 004212   200015 000044                    BDSC    @N+3,,AUTO               by=0,bit=0,n=36
         3 004213   200015 236100                    LDQ     @N+3,,AUTO
         3 004214   000033 732000                    QRS     27
         3 004215   004220 604000 3                  TMI     s:3591
         3 004216   100000 116100                    CMPQ    0,,PR1
         3 004217   004222 600000 3                  TZE     s:3592

     1040     3591    2              TYPE_OF_ARG(2)~=OPTION) THEN ALTRETURN;

   3591  3 004220   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 004221   000000 702211                    TSX2  ! 0,X1

     1041     3592    2       IF TYPE_OF_ARG(1)=%RECORD_NAME THEN

   3592  3 004222   003100 060500                    CSL     bolr='003'O
         3 004223   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 004224   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004225   200014 236100                    LDQ     @N+2,,AUTO
         3 004226   000033 732000                    QRS     27
         3 004227   000004 116007                    CMPQ    4,DL
         3 004230   004235 601000 3                  TNZ     s:3595

     1042     3593    2           IPT_CON.V.RC.RC_OFFSET#=ZII$PARAMS.OFFSET(1);

   3593  3 004231   000020 220000 0                  LDX0    ZII$PARAMS+1
         3 004232   000052 471400 0                  LDP1    FPT$
         3 004233   100012 740100                    STX0    10,,PR1
         3 004234   004240 710000 3                  TRA     s:3596

     1043     3594    2       ELSE
     1044     3595    2           IPT_CON.V.RC.RC_OFFSET#=NULL_OFFSET;

   3595  3 004235   000064 720000 0                  LXL0    NULL_OFFSET
         3 004236   000052 471400 0                  LDP1    FPT$
         3 004237   100012 740100                    STX0    10,,PR1
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:177  

     1045     3596    2       IPT_CON.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(PARAMS(0));

   3596  3 004240   000017 721000 0                  LXL1    ZII$PARAMS
         3 004241   000017 222011 0                  LDX2    ZII$PARAMS,X1
         3 004242   100013 742100                    STX2    11,,PR1

     1046     3597    2   END CON_DIS;

   3597  3 004243   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 004244   000001 702211                    TSX2  ! 1,X1

     1047     3598
     1048     3599    1   ARG_ERROR: ALTRETURN;

   3599  3 004245   000000 702200 xent  ARG_ERROR    TSX2  ! X66_AALT

     1049     3600
     1050     3601    1   ZII$CONNECT: ENTRY ALTRET;

   3601  3 004246   000000 700200 xent  ZII$CONNECT  TSX0  ! X66_AUTO_3
         3 004247   000020 000003                    ZERO    16,3

     1051     3602
     1052     3603    1       IPT_CON.V_ = VECTOR(IPT_CON.V);

   3603  3 004250   000011 235000 4                  LDA     9
         3 004251   000052 236000 0                  LDQ     FPT$
         3 004252   000012 036003                    ADLQ    10,DU
         3 004253   000052 470400 0                  LDP0    FPT$
         3 004254   000000 757100                    STAQ    0,,PR0

     1053     3604    1       CALL CON_DIS(%TO) ALTRET(ARG_ERROR);

   3604  3 004255   000024 236000 4                  LDQ     20
         3 004256   200007 756100                    STQ     @A3+2,,AUTO
         3 004257   004127 701000 3                  TSX1    CON_DIS
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:178  
         3 004260   004245 702000 3                  TSX2    ARG_ERROR

     1054     3605            %CLIMB(FCN=CON);

   3613  3 004261   000052 470400 0                  LDP0    FPT$
         3 004262   000000 713400 xsym               CLIMB   I$CON
         3 004263   402000 600000 xsid               climb   nvectors=         5

     1055     3619    1       GOTO COMMON_RETURN;

   3619  3 004264   004370 710000 3                  TRA     COMMON_RETURN

     1056     3620
     1057     3621    1   ZII$DISCONNECT: ENTRY ALTRET;

   3621  3 004265   000000 700200 xent  ZII$DISCONN* TSX0  ! X66_AUTO_3
         3 004266   000020 000003                    ZERO    16,3

     1058     3622
     1059     3623    1       IPT_DIS.V_ = VECTOR(IPT_DIS.V);

   3623  3 004267   000011 235000 4                  LDA     9
         3 004270   000052 236000 0                  LDQ     FPT$
         3 004271   000012 036003                    ADLQ    10,DU
         3 004272   000052 470400 0                  LDP0    FPT$
         3 004273   000000 757100                    STAQ    0,,PR0

     1060     3624    1       CALL CON_DIS(%FROM) ALTRET(ARG_ERROR);

   3624  3 004274   000026 236000 4                  LDQ     22
         3 004275   200007 756100                    STQ     @A3+2,,AUTO
         3 004276   004127 701000 3                  TSX1    CON_DIS
         3 004277   004245 702000 3                  TSX2    ARG_ERROR

     1061     3625            %CLIMB(FCN=DIS);

   3633  3 004300   000052 470400 0                  LDP0    FPT$
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:179  
         3 004301   000000 713400 xsym               CLIMB   I$DIS
         3 004302   402000 600000 xsid               climb   nvectors=         5

     1062     3639    1       GOTO COMMON_RETURN;

   3639  3 004303   004370 710000 3                  TRA     COMMON_RETURN

     1063     3640         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:180  
     1064     3641        /**   COMMON SUBROUTINE FOR IFT OR IST   **/
     1065     3642    1   DO_IF: PROC(A) ALTRET;

   3642  3 004304   200006 741300       DO_IF        STX1  ! @A3+1,,AUTO

     1066     3643    2   DCL A BIT(2);
     1067     3644
     1068     3645    2       ADDR(IPT_IST.V.TDW)->SBIN36=0;

   3645  3 004305   000052 470400 0                  LDP0    FPT$
         3 004306   000012 450100                    STZ     10,,PR0

     1069     3646    2       IPT_IST.V.TDW=A;

   3646  3 004307   200007 471500                    LDP1    @A,,AUTO
         3 004310   003100 060500                    CSL     bolr='003'O
         3 004311   100000 000002                    BDSC    0,,PR1                   by=0,bit=0,n=2
         3 004312   000012 000044                    BDSC    10,,PR0                  by=0,bit=0,n=36

     1070     3647    2       CALL SET_ARGS;

   3647  3 004313   000003 701000 3                  TSX1    SET_ARGS
         3 004314   000000 011000                    NOP     0

     1071     3648    3       DO CASE(PARAMS(0));

   3648  3 004315   000017 235000 0                  LDA     ZII$PARAMS
         3 004316   000003 115007                    CMPA    3,DL
         3 004317   004321 602005 3                  TNC     s:3648+4,AL
         3 004320   004361 710000 3                  TRA     s:3684
         3 004321   004361 710000 3                  TRA     s:3684
         3 004322   004324 710000 3                  TRA     s:3650
         3 004323   004334 710000 3                  TRA     s:3666

     1072     3649    3       CASE(1);

     1073     3650    3           IPT_IFT.V_ = VECTOR(IPT_IFT.V);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:181  

   3650  3 004324   000011 235000 4                  LDA     9
         3 004325   000052 236000 0                  LDQ     FPT$
         3 004326   000012 036003                    ADLQ    10,DU
         3 004327   000052 470400 0                  LDP0    FPT$
         3 004330   000000 757100                    STAQ    0,,PR0

     1074     3651                %CLIMB(FCN=IFT);

   3659  3 004331   000000 713400 xsym               CLIMB   I$IFT
         3 004332   402000 600000 xsid               climb   nvectors=         5
         3 004333   004363 710000 3                  TRA     s:3686

     1075     3665    3       CASE(2);

     1076     3666    3           IF TYPE_OF_ARG(1)~=%SET_NAME THEN ALTRETURN;

   3666  3 004334   000051 470400 0                  LDP0    ARG$
         3 004335   003100 060500                    CSL     bolr='003'O
         3 004336   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 004337   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004340   200014 236100                    LDQ     @N+2,,AUTO
         3 004341   000033 732000                    QRS     27
         3 004342   000003 116007                    CMPQ    3,DL
         3 004343   004346 600000 3                  TZE     s:3667

   3666  3 004344   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 004345   000000 702211                    TSX2  ! 0,X1

     1077     3667    3           IPT_IST.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(1);

   3667  3 004346   000020 220000 0                  LDX0    ZII$PARAMS+1
         3 004347   000052 471400 0                  LDP1    FPT$
         3 004350   100013 740100                    STX0    11,,PR1

     1078     3668    3           IPT_IST.V_ = VECTOR(IPT_IST.V);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:182  
   3668  3 004351   000011 235000 4                  LDA     9
         3 004352   000052 236000 0                  LDQ     FPT$
         3 004353   000012 036003                    ADLQ    10,DU
         3 004354   100000 757100                    STAQ    0,,PR1

     1079     3669                %CLIMB(FCN=IST);

   3677  3 004355   100000 630500                    EPPR0   0,,PR1
         3 004356   000000 713400 xsym               CLIMB   I$IST
         3 004357   402000 600000 xsid               climb   nvectors=         5
         3 004360   004363 710000 3                  TRA     s:3686

     1080     3683    3       CASE(ELSE);

     1081     3684    3           ALTRETURN;

   3684  3 004361   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 004362   000000 702211                    TSX2  ! 0,X1

     1082     3685    3           END;

     1083     3686    2       ZII$INTEGER1=UWA(0); /* UWA AT WORD 0 HAS THE RESULT */

   3686  3 004363   000046 470400 0                  LDP0    UWA$
         3 004364   000000 235100                    LDA     0,,PR0
         3 004365   000000 755000 0                  STA     ZII$INTEGER1

     1084     3687    2   END DO_IF;

   3687  3 004366   200006 221300                    LDX1  ! @A3+1,,AUTO
         3 004367   000001 702211                    TSX2  ! 1,X1

     1085     3688
     1086     3689    1   COMMON_RETURN: /* EVERY IDS CALL RETURNED FROM HERE */
     1087     3690    1       IDSSYSERR = PINCRW(IA$,5) -> SBIN36; /* MON ERR_CODE */

   3690  3 004370   000045 470400 0     COMMON_RETU* LDP0    IA$
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:183  
         3 004371   000005 235100                    LDA     5,,PR0
         3 004372   000063 755000 0                  STA     IDSSYSERR

     1088     3691    1       RETURN; /* NOW RETURN TO USER */

   3691  3 004373   000000 702200 xent               TSX2  ! X66_ARET

     1089     3692         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:184  
     1090     3693    1   ZII$IFEMPTY: ENTRY ALTRET;

   3693  3 004374   000000 700200 xent  ZII$IFEMPTY  TSX0  ! X66_AUTO_3
         3 004375   000020 000003                    ZERO    16,3

     1091     3694
     1092     3695    1       CALL SET_ARGS;

   3695  3 004376   000003 701000 3                  TSX1    SET_ARGS
         3 004377   000000 011000                    NOP     0

     1093     3696    1       IF TYPE_OF_ARG(1)~=%SET_NAME THEN ALTRETURN;

   3696  3 004400   000051 470400 0                  LDP0    ARG$
         3 004401   003100 060500                    CSL     bolr='003'O
         3 004402   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         3 004403   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004404   200014 236100                    LDQ     @N+2,,AUTO
         3 004405   000033 732000                    QRS     27
         3 004406   000003 116007                    CMPQ    3,DL
         3 004407   004411 600000 3                  TZE     s:3697

   3696  3 004410   000000 702200 xent               TSX2  ! X66_AALT

     1094     3697    1       IPT_IFM.V.SC.SC_OFFSET#=ZII$PARAMS.OFFSET(1);

   3697  3 004411   000020 220000 0                  LDX0    ZII$PARAMS+1
         3 004412   000052 471400 0                  LDP1    FPT$
         3 004413   100012 740100                    STX0    10,,PR1

     1095     3698    1       IPT_IFM.V_ = VECTOR(IPT_IFM.V);

   3698  3 004414   000011 235000 4                  LDA     9
         3 004415   000052 236000 0                  LDQ     FPT$
         3 004416   000012 036003                    ADLQ    10,DU
         3 004417   100000 757100                    STAQ    0,,PR1

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:185  
     1096     3699            %CLIMB(FCN=IFM);

   3707  3 004420   100000 630500                    EPPR0   0,,PR1
         3 004421   000000 713400 xsym               CLIMB   I$IFM
         3 004422   402000 600000 xsid               climb   nvectors=         5

     1097     3713    1       ZII$INTEGER1=UWA(0); /* UWA AT WORD 0 HAS THE RESULT */

   3713  3 004423   000046 470400 0                  LDP0    UWA$
         3 004424   000000 235100                    LDA     0,,PR0
         3 004425   000000 755000 0                  STA     ZII$INTEGER1

     1098     3714    1       GOTO COMMON_RETURN;

   3714  3 004426   004370 710000 3                  TRA     COMMON_RETURN

     1099     3715
     1100     3716    1   ZII$IFMEMBER: ENTRY ALTRET;

   3716  3 004427   000000 700200 xent  ZII$IFMEMBER TSX0  ! X66_AUTO_3
         3 004430   000020 000003                    ZERO    16,3

     1101     3717
     1102     3718    1       CALL DO_IF('01'B) ALTRET(ARG_ERROR);

   3718  3 004431   000030 236000 4                  LDQ     24
         3 004432   200007 756100                    STQ     @A3+2,,AUTO
         3 004433   004304 701000 3                  TSX1    DO_IF
         3 004434   004245 702000 3                  TSX2    ARG_ERROR

     1103     3719    1       GOTO COMMON_RETURN;

   3719  3 004435   004370 710000 3                  TRA     COMMON_RETURN

     1104     3720
     1105     3721    1   ZII$IFOWNER: ENTRY ALTRET;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:186  
   3721  3 004436   000000 700200 xent  ZII$IFOWNER  TSX0  ! X66_AUTO_3
         3 004437   000020 000003                    ZERO    16,3

     1106     3722
     1107     3723    1       CALL DO_IF('10'B) ALTRET(ARG_ERROR);

   3723  3 004440   000031 236000 4                  LDQ     25
         3 004441   200007 756100                    STQ     @A3+2,,AUTO
         3 004442   004304 701000 3                  TSX1    DO_IF
         3 004443   004245 702000 3                  TSX2    ARG_ERROR

     1108     3724    1       GOTO COMMON_RETURN;

   3724  3 004444   004370 710000 3                  TRA     COMMON_RETURN

     1109     3725
     1110     3726    1   ZII$IFTENANT: ENTRY ALTRET;

   3726  3 004445   000000 700200 xent  ZII$IFTENANT TSX0  ! X66_AUTO_3
         3 004446   000020 000003                    ZERO    16,3

     1111     3727
     1112     3728    1       CALL DO_IF('11'B) ALTRET(ARG_ERROR);

   3728  3 004447   000033 236000 4                  LDQ     27
         3 004450   200007 756100                    STQ     @A3+2,,AUTO
         3 004451   004304 701000 3                  TSX1    DO_IF
         3 004452   004245 702000 3                  TSX2    ARG_ERROR

     1113     3729    1       GOTO COMMON_RETURN;

   3729  3 004453   004370 710000 3                  TRA     COMMON_RETURN

     1114     3730
     1115     3731    1   ZII$CHECK: ENTRY ALTRET;

   3731  3 004454   000000 700200 xent  ZII$CHECK    TSX0  ! X66_AUTO_3
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:187  
         3 004455   000020 000003                    ZERO    16,3

     1116     3732
     1117     3733            %CLIMB(FCN=CHK);

   3741  3 004456   000100 630400 0                  EPPR0   IPT_CHK
         3 004457   000000 713400 xsym               CLIMB   I$CHK
         3 004460   401000 600000 xsid               climb   nvectors=         3

     1118     3747    1       GOTO COMMON_RETURN;

   3747  3 004461   004370 710000 3                  TRA     COMMON_RETURN

     1119     3748
     1120     3749    1   ZII$BUFFERS: ENTRY ALTRET;

   3749  3 004462   000000 700200 xent  ZII$BUFFERS  TSX0  ! X66_AUTO_3
         3 004463   000020 000003                    ZERO    16,3

     1121     3750
     1122     3751            %CLIMB(FCN=NBF);

   3759  3 004464   000000 470400 1                  LDP0    NBF_CRPT_TRON$
         3 004465   000000 713400 xsym               CLIMB   I$NBF
         3 004466   400400 600000 xsid               climb   nvectors=         2

     1123     3765    1       GOTO COMMON_RETURN;

   3765  3 004467   004370 710000 3                  TRA     COMMON_RETURN

     1124     3766         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:188  
     1125     3767    1   ZII$CRPT: ENTRY ALTRET;

   3767  3 004470   000000 700200 xent  ZII$CRPT     TSX0  ! X66_AUTO_3
         3 004471   000020 000003                    ZERO    16,3

     1126     3768
     1127     3769            %CLIMB(FCN=CRPT);

   3777  3 004472   000000 470400 1                  LDP0    NBF_CRPT_TRON$
         3 004473   000000 713400 xsym               CLIMB   I$CRPT
         3 004474   400000 600000 xsid               climb   nvectors=         1

     1128     3783    1       GOTO COMMON_RETURN;

   3783  3 004475   004370 710000 3                  TRA     COMMON_RETURN

     1129     3784
     1130     3785    1   ZII$ROLL: ENTRY ALTRET;

   3785  3 004476   000000 700200 xent  ZII$ROLL     TSX0  ! X66_AUTO_3
         3 004477   000020 000003                    ZERO    16,3

     1131     3786
     1132     3787            %CLIMB(FCN=ROL);

   3795  3 004500   000110 630400 0                  EPPR0   IPT_ROL
         3 004501   000000 713400 xsym               CLIMB   I$ROL
         3 004502   400400 600000 xsid               climb   nvectors=         2

     1133     3801    1       GOTO COMMON_RETURN;

   3801  3 004503   004370 710000 3                  TRA     COMMON_RETURN

     1134     3802
     1135     3803    1   ZII$RPTSTATS: ENTRY ALTRET;

   3803  3 004504   000000 700200 xent  ZII$RPTSTATS TSX0  ! X66_AUTO_3
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:189  
         3 004505   000020 000003                    ZERO    16,3

     1136     3804
     1137     3805            %CLIMB(FCN=RPT,PARAMS=0);

   3816  3 004506   000000 713400 xsym               CLIMB   I$RPT
         3 004507   000000 600000 xsid               climb   nvectors=         0

     1138     3819    1       GOTO COMMON_RETURN;

   3819  3 004510   004370 710000 3                  TRA     COMMON_RETURN

     1139     3820
     1140     3821    1   ZII$STATSON: ENTRY ALTRET;

   3821  3 004511   000000 700200 xent  ZII$STATSON  TSX0  ! X66_AUTO_3
         3 004512   000020 000003                    ZERO    16,3

     1141     3822
     1142     3823            %CLIMB(FCN=STON,PARAMS=0);

   3834  3 004513   000000 713400 xsym               CLIMB   I$STON
         3 004514   000000 600000 xsid               climb   nvectors=         0

     1143     3837    1       GOTO COMMON_RETURN;

   3837  3 004515   004370 710000 3                  TRA     COMMON_RETURN

     1144     3838
     1145     3839    1   ZII$STATSOFF: ENTRY ALTRET;

   3839  3 004516   000000 700200 xent  ZII$STATSOFF TSX0  ! X66_AUTO_3
         3 004517   000020 000003                    ZERO    16,3

     1146     3840
     1147     3841            %CLIMB(FCN=STOFF,PARAMS=0);

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:190  
   3852  3 004520   000000 713400 xsym               CLIMB   I$STOFF
         3 004521   000000 600000 xsid               climb   nvectors=         0

     1148     3855    1       GOTO COMMON_RETURN;

   3855  3 004522   004370 710000 3                  TRA     COMMON_RETURN

     1149     3856
     1150     3857    1   ZII$TRACEOFF: ENTRY ALTRET;

   3857  3 004523   000000 700200 xent  ZII$TRACEOFF TSX0  ! X66_AUTO_3
         3 004524   000020 000003                    ZERO    16,3

     1151     3858
     1152     3859    1       IF ZII$INTEGER1<0 AND ZII$INTEGER1>4 THEN

   3859  3 004525   000000 235000 0                  LDA     ZII$INTEGER1
         3 004526   004532 605000 3                  TPL     s:3869
         3 004527   000004 115007                    CMPA    4,DL
         3 004530   004532 604400 3                  TMOZ    s:3869

     1153     3860    1           ZII$INTEGER1=0; /* USE DEFAULT TO TRACE ALL */

   3860  3 004531   000000 450000 0                  STZ     ZII$INTEGER1

     1154     3861            %CLIMB(FCN=TROFF);

   3869  3 004532   000000 470400 1                  LDP0    NBF_CRPT_TRON$
         3 004533   000000 713400 xsym               CLIMB   I$TROFF
         3 004534   400000 600000 xsid               climb   nvectors=         1

     1155     3875    1       GOTO COMMON_RETURN;

   3875  3 004535   004370 710000 3                  TRA     COMMON_RETURN

     1156     3876
     1157     3877    1   ZII$TRACEON: ENTRY ALTRET;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:191  

   3877  3 004536   000000 700200 xent  ZII$TRACEON  TSX0  ! X66_AUTO_3
         3 004537   000020 000003                    ZERO    16,3

     1158     3878
     1159     3879    1       IF ZII$INTEGER1<0 AND ZII$INTEGER1>4 THEN

   3879  3 004540   000000 235000 0                  LDA     ZII$INTEGER1
         3 004541   004545 605000 3                  TPL     s:3889
         3 004542   000004 115007                    CMPA    4,DL
         3 004543   004545 604400 3                  TMOZ    s:3889

     1160     3880    1           ZII$INTEGER1=0; /* USE DEFAULT TO TRACE ALL */

   3880  3 004544   000000 450000 0                  STZ     ZII$INTEGER1

     1161     3881            %CLIMB(FCN=TRON);

   3889  3 004545   000000 470400 1                  LDP0    NBF_CRPT_TRON$
         3 004546   000000 713400 xsym               CLIMB   I$TRON
         3 004547   400000 600000 xsid               climb   nvectors=         1

     1162     3895    1       GOTO COMMON_RETURN;

   3895  3 004550   004370 710000 3                  TRA     COMMON_RETURN

     1163     3896
     1164     3897    1   ZII$KEEP: ENTRY ALTRET;

   3897  3 004551   000000 700200 xent  ZII$KEEP     TSX0  ! X66_AUTO_3
         3 004552   000020 000003                    ZERO    16,3

     1165     3898
     1166     3899    1       IPT_KEEP.ERROR_=VECTOR(PINCRW(UWA$,1)->CHAR7);

   3899  3 004553   000003 235000 4                  LDA     3
         3 004554   000046 236000 0                  LDQ     UWA$
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:192  
         3 004555   000001 036003                    ADLQ    1,DU
         3 004556   000106 757000 0                  STAQ    IPT_KEEP

     1167     3900            %CLIMB(FCN=KEEP);

   3908  3 004557   000106 630400 0                  EPPR0   IPT_KEEP
         3 004560   000000 713400 xsym               CLIMB   I$KEEP
         3 004561   400000 600000 xsid               climb   nvectors=         1

     1168     3914    1       GOTO COMMON_RETURN;

   3914  3 004562   004370 710000 3                  TRA     COMMON_RETURN

     1169     3915
     1170     3916    1   ZII$REDUCEQ: ENTRY ALTRET;

   3916  3 004563   000000 700200 xent  ZII$REDUCEQ  TSX0  ! X66_AUTO_3
         3 004564   000020 000003                    ZERO    16,3

     1171     3917
     1172     3918            %CLIMB(FCN=REDUCEQ); /* NUM OF PAGES DEQED RETURNED TO ZII$INTEGER1 */

   3926  3 004565   000000 470400 1                  LDP0    NBF_CRPT_TRON$
         3 004566   000000 713400 xsym               CLIMB   I$REDUCEQ
         3 004567   400000 600000 xsid               climb   nvectors=         1

     1173     3932    1       GOTO COMMON_RETURN;

   3932  3 004570   004370 710000 3                  TRA     COMMON_RETURN

     1174     3933         %EJECT;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:193  
     1175     3934        /****************************************************************/
     1176     3935        /*                                                              */
     1177     3936        /*    CALL PRIVACY(RECORD,IDS-NAME1,PRIVACY-KEY,REC-NAME)       */
     1178     3937        /*                                                              */
     1179     3938        /*      IDS-NAME1: CONNECT,DISCONNECT,STORE,ERASE               */
     1180     3939        /*                 MODIFY,FIND,GET                              */
     1181     3940        /*                                                              */
     1182     3941        /*    CALL PRIVACY(SET,CONNECT,PRIVACY-KEY,SET-NAME1,....)      */
     1183     3942        /*                     DISCONNECT                               */
     1184     3943        /*                     FIND                                     */
     1185     3944        /*                                                              */
     1186     3945        /*    CALL PRIVACY(ITEM,MODIFY/GET,PRIVACY-KEY,ITEM-1,...)      */
     1187     3946        /*                                                              */
     1188     3947        /****************************************************************/
     1189     3948
     1190     3949    1   ZII$PRIVACY: ENTRY ALTRET;

   3949  3 004571   000000 700200 xent  ZII$PRIVACY  TSX0  ! X66_AUTO_3
         3 004572   000020 000003                    ZERO    16,3

     1191     3950
     1192     3951    1       CALL SET_ARGS;

   3951  3 004573   000003 701000 3                  TSX1    SET_ARGS
         3 004574   000000 011000                    NOP     0

     1193     3952    1       IF PARAMS(1)=%SET THEN

   3952  3 004575   000020 235000 0                  LDA     ZII$PARAMS+1
         3 004576   000032 115007                    CMPA    26,DL
         3 004577   004603 601000 3                  TNZ     s:3955

     1194     3953    1           K=1;

   3953  3 004600   000001 236007                    LDQ     1,DL
         3 004601   000057 756000 0                  STQ     K
         3 004602   004616 710000 3                  TRA     s:3963
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:194  

     1195     3954    1       ELSE
     1196     3955    1           IF PARAMS(1)=%RECORD THEN

   3955  3 004603   000030 115007                    CMPA    24,DL
         3 004604   004610 601000 3                  TNZ     s:3958

     1197     3956    1               K=2;

   3956  3 004605   000002 236007                    LDQ     2,DL
         3 004606   000057 756000 0                  STQ     K
         3 004607   004616 710000 3                  TRA     s:3963

     1198     3957    1           ELSE
     1199     3958    1               IF PARAMS(1)=%ITEM THEN

   3958  3 004610   000020 115007                    CMPA    16,DL
         3 004611   004615 601000 3                  TNZ     s:3961

     1200     3959    1                   K=3;

   3959  3 004612   000003 236007                    LDQ     3,DL
         3 004613   000057 756000 0                  STQ     K
         3 004614   004616 710000 3                  TRA     s:3963

     1201     3960    1               ELSE
     1202     3961    1                   ALTRETURN;

   3961  3 004615   000000 702200 xent               TSX2  ! X66_AALT

     1203     3962
     1204     3963    1       JJ=PARAMS(0);

   3963  3 004616   000017 235000 0                  LDA     ZII$PARAMS
         3 004617   000061 755000 0                  STA     JJ

     1205     3964    2       DO WHILE(TYPE_OF_ARG(JJ)-%SET_NAME+1=K);
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:195  

   3964  3 004620   004623 710000 3                  TRA     s:3966

     1206     3965    2           JJ=JJ-1;

   3965  3 004621   000001 336007                    LCQ     1,DL
         3 004622   000061 056000 0                  ASQ     JJ

     1207     3966    2           END;

   3966  3 004623   000061 236000 0                  LDQ     JJ
         3 004624   000011 402007                    MPY     9,DL
         3 004625   000000 116003                    CMPQ    0,DU
         3 004626   004630 605000 3                  TPL     s:3966+5
         3 004627   000044 036003                    ADLQ    36,DU
         3 004630   000051 470400 0                  LDP0    ARG$
         3 004631   003100 060506                    CSL     bolr='003'O
         3 004632   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 004633   200014 000044                    BDSC    @N+2,,AUTO               by=0,bit=0,n=36
         3 004634   200014 236100                    LDQ     @N+2,,AUTO
         3 004635   000033 732000                    QRS     27
         3 004636   000002 136007                    SBLQ    2,DL
         3 004637   000057 116000 0                  CMPQ    K
         3 004640   004621 600000 3                  TZE     s:3965

     1208     3967    1       IF (K<3 AND JJ=PARAMS(0)) THEN

   3967  3 004641   000057 235000 0                  LDA     K
         3 004642   000003 115007                    CMPA    3,DL
         3 004643   004652 605000 3                  TPL     s:3973
         3 004644   000061 236000 0                  LDQ     JJ
         3 004645   000017 116000 0                  CMPQ    ZII$PARAMS
         3 004646   004652 601000 3                  TNZ     s:3973

     1209     3968    2       DO;

     1210     3969    2           PARAMS(0)=PARAMS(0)+1;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:196  

   3969  3 004647   000017 054000 0                  AOS     ZII$PARAMS

     1211     3970    2           ZII$PARAMS.OFFSET(JJ+1)=0; /* MAKE A FAKE ARG */

   3970  3 004650   000000 220003                    LDX0    0,DU
         3 004651   000020 740006 0                  STX0    ZII$PARAMS+1,QL

     1212     3971    2           END;

     1213     3972
     1214     3973    1       KK=USEP.M;

   3973  3 004652   000050 471400 0                  LDP1    USEP$
         3 004653   100000 236100                    LDQ     0,,PR1
         3 004654   000022 772000                    QRL     18
         3 004655   377777 376007                    ANQ     131071,DL
         3 004656   000062 756000 0                  STQ     KK

     1215     3974    2       DO I=2 TO JJ-1;

   3974  3 004657   000002 235007                    LDA     2,DL
         3 004660   000055 755000 0                  STA     I
         3 004661   004763 710000 3                  TRA     s:3987+1

     1216     3975    2           J=0;

   3975  3 004662   000056 450000 0                  STZ     J

     1217     3976    3           DO WHILE(J<7 AND IDS_NAMES(J)~=PARAMS(I));

   3976  3 004663   004665 710000 3                  TRA     s:3978

     1218     3977    3               J=J+1;

   3977  3 004664   000056 054000 0                  AOS     J

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:197  
     1219     3978    3               END;

   3978  3 004665   000056 235000 0                  LDA     J
         3 004666   000007 115007                    CMPA    7,DL
         3 004667   004700 605000 3                  TPL     s:3979
         3 004670   000055 720000 0                  LXL0    I
         3 004671   000001 735000                    ALS     1
         3 004672   000100 101405                    MRL     fill='000'O
         3 004673   000001 000002 1                  ADSC9   IDS_NAMES,A              cn=0,n=2
         3 004674   200014 000004                    ADSC9   @N+2,,AUTO               cn=0,n=4
         3 004675   200014 236100                    LDQ     @N+2,,AUTO
         3 004676   000017 116010 0                  CMPQ    ZII$PARAMS,X0
         3 004677   004664 601000 3                  TNZ     s:3977

     1220     3979    2           IF J=7 THEN ALTRETURN; /* UNKNOWN IDS ROUTINE NAME */

   3979  3 004700   000056 235000 0                  LDA     J
         3 004701   000007 115007                    CMPA    7,DL
         3 004702   004704 601000 3                  TNZ     s:3980

   3979  3 004703   000000 702200 xent               TSX2  ! X66_AALT

     1221     3980    3           DO II=JJ+1 TO PARAMS(0);

   3980  3 004704   000061 236000 0                  LDQ     JJ
         3 004705   000001 036007                    ADLQ    1,DL
         3 004706   000060 756000 0                  STQ     II
         3 004707   004757 710000 3                  TRA     s:3986+1

     1222     3981    3               USEP.UC.UCW_PRV.PT(KK)=K;

   3981  3 004710   000062 235000 0                  LDA     KK
         3 004711   000001 735000                    ALS     1
         3 004712   000050 470400 0                  LDP0    USEP$
         3 004713   000057 236000 0                  LDQ     K
         3 004714   000033 736000                    QLS     27
         3 004715   000001 676105                    ERQ     1,AL,PR0
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:198  
         3 004716   777000 376003                    ANQ     -512,DU
         3 004717   000001 656105                    ERSQ    1,AL,PR0

     1223     3982    3               USEP.UC.UCW_PRV.PB(KK)=IDS_BIT9(J);

   3982  3 004720   000002 735000                    ALS     2
         3 004721   000056 236000 0                  LDQ     J
         3 004722   000105 100406                    MLR     fill='000'O
         3 004723   000005 000001 1                  ADSC9   IDS_BIT9,Q               cn=0,n=1
         3 004724   000001 200001                    ADSC9   1,A,PR0                  cn=1,n=1

     1224     3983    3               USEP.UC.UCW_PRV.A(KK)=RVA_HALF(ZII$PARAMS.OFFSET(II)*2+1);

   3983  3 004725   000062 235000 0                  LDA     KK
         3 004726   000001 735000                    ALS     1
         3 004727   000060 720000 0                  LXL0    II
         3 004730   000017 236010 0                  LDQ     ZII$PARAMS,X0
         3 004731   000022 772000                    QRL     18
         3 004732   000000 621005                    EAX1    0,AL
         3 004733   000044 402007                    MPY     36,DL
         3 004734   200014 756100                    STQ     @N+2,,AUTO
         3 004735   000000 636011                    EAQ     0,X1
         3 004736   000022 732000                    QRS     18
         3 004737   000044 402007                    MPY     36,DL
         3 004740   000000 116003                    CMPQ    0,DU
         3 004741   004743 605000 3                  TPL     s:3983+14
         3 004742   000044 036003                    ADLQ    36,DU
         3 004743   000047 471400 0                  LDP1    RVA$
         3 004744   200014 235100                    LDA     @N+2,,AUTO
         3 004745   003106 060505                    CSL     bolr='003'O
         3 004746   100000 400022                    BDSC    0,A,PR1                  by=2,bit=0,n=18
         3 004747   000001 400022                    BDSC    1,Q,PR0                  by=2,bit=0,n=18

     1225     3984    3               USEP.UC.ENT(KK)=KEY_COUNT-1;

   3984  3 004750   000062 235000 0                  LDA     KK
         3 004751   000001 735000                    ALS     1
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:199  
         3 004752   000066 721000 0                  LXL1    KEY_COUNT
         3 004753   777777 622011                    EAX2    -1,X1
         3 004754   000002 742105                    STX2    2,AL,PR0

     1226     3985    3               KK=KK+1;

   3985  3 004755   000062 054000 0                  AOS     KK

     1227     3986    3               END;

   3986  3 004756   000060 054000 0                  AOS     II
         3 004757   000060 236000 0                  LDQ     II
         3 004760   000017 116000 0                  CMPQ    ZII$PARAMS
         3 004761   004710 604400 3                  TMOZ    s:3981

     1228     3987    2           END;

   3987  3 004762   000055 054000 0                  AOS     I
         3 004763   000055 236000 0                  LDQ     I
         3 004764   000061 116000 0                  CMPQ    JJ
         3 004765   004662 604000 3                  TMI     s:3975

     1229     3988    1       USEP.M=KK;

   3988  3 004766   000050 470400 0                  LDP0    USEP$
         3 004767   000062 236000 0                  LDQ     KK
         3 004770   000022 736000                    QLS     18
         3 004771   000000 676100                    ERQ     0,,PR0
         3 004772   377777 376003                    ANQ     131071,DU
         3 004773   000000 656100                    ERSQ    0,,PR0

     1230     3989    1       KEY_COUNT=KEY_COUNT-1;

   3989  3 004774   000001 336007                    LCQ     1,DL
         3 004775   000066 056000 0                  ASQ     KEY_COUNT

     1231     3990    1       KEY_SAVE(KEY_COUNT)=ZII$CHARACTER12;
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:200  

   3990  3 004776   000066 236000 0                  LDQ     KEY_COUNT
         3 004777   000014 402007                    MPY     12,DL
         3 005000   000052 471400 0                  LDP1    FPT$
         3 005001   040106 100400                    MLR     fill='040'O
         3 005002   000014 000014 0                  ADSC9   ZII$CHARACTER12          cn=0,n=12
         3 005003   100000 000014                    ADSC9   0,Q,PR1                  cn=0,n=12

     1232     3991    1       RETURN;

   3991  3 005004   000000 702200 xent               TSX2  ! X66_ARET

ZII$CHARACTER30
 Sect OctLoc
   0     004   ****** ******   ****** ******   ****** ******   ****** ******    ................

ZII$PARAMS
 Sect OctLoc
   0     017   ****** ******   ****** ******   ****** ******   ****** ******    ................

KEY_COUNT
 Sect OctLoc
   0     066   000000 000000                                                    ....

RETAIN_SWITCH
 Sect OctLoc
   0     067   000000 000000                                                    ....

PAGE_VECTOR
 Sect OctLoc
   0     070   ****** ******   000000 006014                                    ........

FPT_SHORT
 Sect OctLoc
   0     072   000001 777640   000000 006000   000001 777640   000002 006000    ................

IPT_CHK
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:201  
 Sect OctLoc
   0     100   000001 777640   000002 006000   000000 177640   000000 006014    ................
   0     104   000001 777640   000000 006000                                    ........

IPT_KEEP
 Sect OctLoc
   0     106   000000 177640   000000 006014                                    ........

IPT_ROL
 Sect OctLoc
   0     110   000001 777640   000000 006000   000000 177640   000000 006014    ................

NBF_CRPT_TRON$
 Sect OctLoc
   1     000   000072 006000                                                    .:..

IDS_NAMES
 Sect OctLoc
   1     001   000057 000055   000053 000054   000051 000056   000052 ******    ./.-.+.,.)...*..

IDS_BIT9
 Sect OctLoc
   1     005   400200 100040   020004 010***                                    ..@ ....

FPT_GDP
 Sect OctLoc
   1     010   000001 777640   000014 006000   000001 777640   000070 006000    .............8..
   1     014   000000 000001   ****** ******                                    ........

(unnamed)
 Sect OctLoc
   4     000   000001 777776   000000 006014   000061 777640   000001 577640    .........1......
   4     004   000623 777640   377777 777777   400000 777777   400000 000000    ................
   4     010   777743 777777   000001 777640   777777 600000   000003 777640    ................
   4     014   000001 777640   000000 006000   000007 377640   000004 006000    ................
   4     020   000000 000000   000020 006000   000005 777640   000000 000047    ...............'
   4     024   000023 006000   000000 000043   000025 006000   200000 000000    .......#........
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:202  
   4     030   000027 006000   000007 006000   600000 000000   000032 006000    ................
     1233     3992    1   END ZII$APL_IDP;

PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:203  
--  Include file information  --

   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$DESC.:ZIC0TOU  is referenced.
   ZI_DBCS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZII$APL_IDP.

   Procedure ZII$APL_IDP requires 2565 words for executable code.
   Procedure ZII$APL_IDP requires 16 words of local(AUTO) storage.

    No errors detected in file ZII$APL_IDP.:ZIC0TSI    .
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:204  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:205  
          MINI XREF LISTING

A IN PROCEDURE DO_IF
      3643**DCL      3642--PROC     3646>>ASSIGN
A1
        20**DCL        12--PROC     2371--ENTRY    2373>>ASSIGN   2386>>ASSIGN   2389>>ASSIGN   2390>>ASSIGN
A2
        21**DCL        12--PROC     2371--ENTRY    2374>>ASSIGN   2387>>ASSIGN
A3
        22**DCL        12--PROC     2371--ENTRY    2375>>ASSIGN   2388>>ASSIGN
ARG$
        51**DCL      2293--IMP-PTR  2342>>ASSIGN   2344>>ASSIGN   2356<<ASSIGN   2446>>IF       2452>>IF
      2455>>IF       2458>>IF       2620>>IF       2621>>IF       2623>>IF       2675>>IF       2700>>IF
      2724>>IF       2737>>IF       2742>>IF       2745>>IF       2750>>IF       2753>>IF       2788>>IF
      2790>>IF       2793>>IF       2796>>IF       2809>>IF       2810>>IF       2813>>IF       2816>>IF
      2843>>IF       2871>>IF       2873>>IF       2948>>IF       2948>>IF       2962>>IF       2966>>IF
      2996>>IF       2996>>IF       3003>>IF       3029>>DOCASE   3044>>IF       3044>>IF       3061>>IF
      3066>>IF       3069>>IF       3122>>IF       3122>>IF       3134>>IF       3187>>IF       3188>>IF
      3191>>IF       3194>>IF       3219>>IF       3268>>IF       3278>>IF       3282>>DOCASE   3331>>IF
      3332>>IF       3377>>IF       3387>>IF       3390>>DOCASE   3446>>IF       3451>>IF       3475>>IF
      3519>>IF       3525>>IF       3527>>DOWHILE  3542>>IF       3547>>IF       3550>>IF       3586>>IF
      3587>>IF       3587>>IF       3590>>IF       3590>>IF       3592>>IF       3666>>IF       3696>>IF
      3964>>DOWHILE
ARG_ERROR
      3599**LABEL    3604--CALLALT  3624--CALLALT  3718--CALLALT  3723--CALLALT  3728--CALLALT
CHAR12
        67**DCL      2647<<ASSIGN
CHAR7
        68**DCL      2391--ASSIGN   3899--ASSIGN
CHK_RETAIN
      2469**PROC     2846--CALL     2904--CALL     2929--CALL     2969--CALL     3009--CALL     3073--CALL
      3137--CALL     3201--CALL     3231--CALL     3281--CALL     3337--CALL     3389--CALL
COMMON_RETURN
      3690**LABEL    2417--GOTO     2664--GOTO     2695--GOTO     2719--GOTO     2838--GOTO     2861--GOTO
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:206  
      2897--GOTO     2944--GOTO     3432--GOTO     3495--GOTO     3576--GOTO     3619--GOTO     3639--GOTO
      3714--GOTO     3719--GOTO     3724--GOTO     3729--GOTO     3747--GOTO     3765--GOTO     3783--GOTO
      3801--GOTO     3819--GOTO     3837--GOTO     3855--GOTO     3875--GOTO     3895--GOTO     3914--GOTO
      3932--GOTO
CON_DIS
      3580**PROC     3604--CALL     3624--CALL
DO_IF
      3642**PROC     3718--CALL     3723--CALL     3728--CALL
FINDBKEY
      2901**PROC     3046--CALL     3124--CALL
FPT.IA_
      2297**DCL      2386<<ASSIGN
FPT.RVA_
      2299**DCL      2388<<ASSIGN
FPT.USEP_
      2300**DCL      2398<<ASSIGN
FPT.UWA_
      2298**DCL      2387<<ASSIGN
FPT.V
      2301**DCL      2385--ASSIGN   2718--ASSIGN   2837--ASSIGN   2921--ASSIGN
FPT.V.FPARA
      2303**DCL      2356--ASSIGN
FPT.V_
      2296**DCL      2385<<ASSIGN   2837<<ASSIGN   2921<<ASSIGN
FPT$
        52**DCL       726--IMP-PTR   739--IMP-PTR   763--IMP-PTR   775--IMP-PTR   797--IMP-PTR   810--IMP-PTR
       822--IMP-PTR   835--IMP-PTR   852--IMP-PTR   869--IMP-PTR   884--IMP-PTR   898--IMP-PTR   913--IMP-PTR
       928--IMP-PTR   944--IMP-PTR   960--IMP-PTR   973--IMP-PTR   990--IMP-PTR  1007--IMP-PTR  1022--IMP-PTR
      1039--IMP-PTR  1056--IMP-PTR  1073--IMP-PTR  1089--IMP-PTR  1101--IMP-PTR  1114--IMP-PTR  1125--IMP-PTR
      1137--IMP-PTR  1149--IMP-PTR  1163--IMP-PTR  1176--IMP-PTR  1220--IMP-PTR  1243--IMP-PTR  2295--IMP-PTR
      2314--IMP-PTR  2355<<ASSIGN   2356>>ASSIGN   2357>>ASSIGN   2385>>ASSIGN   2385>>ASSIGN   2386>>ASSIGN
      2387>>ASSIGN   2388>>ASSIGN   2395>>ASSIGN   2397>>ASSIGN   2398>>ASSIGN   2411>>CALL     2602>>ASSIGN
      2606>>ASSIGN   2609>>ASSIGN   2612>>ASSIGN   2615>>ASSIGN   2624>>ASSIGN   2626>>ASSIGN   2628>>ASSIGN
      2628>>ASSIGN   2629>>ASSIGN   2629>>ASSIGN   2638>>CALL     2647>>ASSIGN   2648>>ASSIGN   2648>>ASSIGN
      2657>>CALL     2676>>ASSIGN   2678>>ASSIGN   2678>>ASSIGN   2679>>ASSIGN   2679>>ASSIGN   2680>>ASSIGN
      2689>>CALL     2701>>ASSIGN   2701>>ASSIGN   2702>>ASSIGN   2703>>ASSIGN   2712>>CALL     2718>>ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:207  
      2718>>ASSIGN   2739>>ASSIGN   2740>>ASSIGN   2741>>ASSIGN   2743>>ASSIGN   2746>>ASSIGN   2749>>ASSIGN
      2751>>ASSIGN   2754>>ASSIGN   2758>>ASSIGN   2759>>ASSIGN   2759>>ASSIGN   2768>>CALL     2786>>ASSIGN
      2787>>ASSIGN   2791>>ASSIGN   2794>>ASSIGN   2797>>ASSIGN   2801>>ASSIGN   2802>>ASSIGN   2811>>ASSIGN
      2814>>ASSIGN   2817>>ASSIGN   2821>>ASSIGN   2821>>ASSIGN   2830>>CALL     2837>>ASSIGN   2837>>ASSIGN
      2844>>ASSIGN   2844>>ASSIGN   2845>>ASSIGN   2846>>CALL     2855>>CALL     2867>>ASSIGN   2868>>ASSIGN
      2872>>ASSIGN   2874>>ASSIGN   2878>>ASSIGN   2882>>ASSIGN   2882>>ASSIGN   2891>>CALL     2903>>ASSIGN
      2904>>CALL     2905>>ASSIGN   2905>>ASSIGN   2906>>ASSIGN   2906>>ASSIGN   2915>>CALL     2921>>ASSIGN
      2921>>ASSIGN   2928>>ASSIGN   2928>>ASSIGN   2929>>CALL     2938>>CALL     2964>>ASSIGN   2965>>ASSIGN
      2967>>ASSIGN   2967>>ASSIGN   2968>>ASSIGN   2968>>ASSIGN   2969>>CALL     2978>>CALL     2988>>ASSIGN
      2991>>ASSIGN   2998>>ASSIGN   2999>>ASSIGN   3004>>ASSIGN   3005>>ASSIGN   3007>>ASSIGN   3007>>ASSIGN
      3008>>ASSIGN   3008>>ASSIGN   3009>>CALL     3018>>CALL     3043>>ASSIGN   3060>>ASSIGN   3062>>ASSIGN
      3063>>ASSIGN   3070>>ASSIGN   3071>>ASSIGN   3071>>ASSIGN   3073>>CALL     3073>>CALL     3076>>ASSIGN
      3076>>ASSIGN   3085>>CALL     3092>>ASSIGN   3092>>ASSIGN   3101>>CALL     3121>>ASSIGN   3136>>ASSIGN
      3137>>CALL     3139>>ASSIGN   3139>>ASSIGN   3140>>ASSIGN   3140>>ASSIGN   3149>>CALL     3157>>ASSIGN
      3157>>ASSIGN   3166>>CALL     3189>>ASSIGN   3192>>ASSIGN   3195>>ASSIGN   3196>>ASSIGN   3196>>ASSIGN
      3198>>ASSIGN   3198>>ASSIGN   3199>>ASSIGN   3199>>ASSIGN   3199>>ASSIGN   3201>>CALL     3201>>CALL
      3210>>CALL     3230>>ASSIGN   3231>>CALL     3232>>ASSIGN   3232>>ASSIGN   3233>>ASSIGN   3233>>ASSIGN
      3242>>CALL     3262>>ASSIGN   3265>>ASSIGN   3267>>ASSIGN   3271>>ASSIGN   3276>>ASSIGN   3280>>ASSIGN
      3281>>CALL     3285>>ASSIGN   3285>>ASSIGN   3294>>CALL     3301>>ASSIGN   3301>>ASSIGN   3302>>ASSIGN
      3302>>ASSIGN   3311>>CALL     3334>>ASSIGN   3335>>ASSIGN   3335>>ASSIGN   3336>>ASSIGN   3336>>ASSIGN
      3337>>CALL     3346>>CALL     3365>>ASSIGN   3367>>ASSIGN   3370>>ASSIGN   3373>>ASSIGN   3380>>ASSIGN
      3385>>ASSIGN   3389>>CALL     3393>>ASSIGN   3393>>ASSIGN   3394>>ASSIGN   3394>>ASSIGN   3403>>CALL
      3410>>ASSIGN   3410>>ASSIGN   3419>>CALL     3448>>ASSIGN   3449>>ASSIGN   3452>>ASSIGN   3454>>ASSIGN
      3454>>ASSIGN   3463>>CALL     3473>>ASSIGN   3476>>ASSIGN   3478>>ASSIGN   3478>>ASSIGN   3479>>ASSIGN
      3479>>ASSIGN   3488>>CALL     3510>>ASSIGN   3511>>ASSIGN   3512>>ASSIGN   3513>>ASSIGN   3522>>ASSIGN
      3528>>ASSIGN   3532>>ASSIGN   3538>>ASSIGN   3543>>ASSIGN   3549>>ASSIGN   3552>>ASSIGN   3552>>ASSIGN
      3560>>ASSIGN   3560>>ASSIGN   3561>>ASSIGN   3561>>ASSIGN   3570>>CALL     3593>>ASSIGN   3595>>ASSIGN
      3596>>ASSIGN   3603>>ASSIGN   3603>>ASSIGN   3613>>CALL     3623>>ASSIGN   3623>>ASSIGN   3633>>CALL
      3645>>ASSIGN   3646>>ASSIGN   3650>>ASSIGN   3650>>ASSIGN   3659>>CALL     3667>>ASSIGN   3668>>ASSIGN
      3668>>ASSIGN   3677>>CALL     3697>>ASSIGN   3698>>ASSIGN   3698>>ASSIGN   3707>>CALL     3990>>ASSIGN
FPT_GDP
      2283**DCL      2354<>CALL
FPT_GDP.V
      2283**DCL      2283--DCLINIT
FPT_SHORT
        81**DCL        53--DCLINIT
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:208  
GET_A_PAGE
      2352**PROC     2379--CALL
I
        57**DCL      2340<<DOINDEX  2341>>IF       2342>>ASSIGN   2342>>ASSIGN   2344>>ASSIGN   2344>>ASSIGN
      2381<<DOINDEX  2382>>ASSIGN   2382>>ASSIGN   2383>>IF       2383>>ASSIGN   2393<<ASSIGN   2394>>IF
      2395>>ASSIGN   2397>>ASSIGN   2503<<ASSIGN   2504>>IF       2520>>IF       2536>>IF       2552>>IF
      2568>>IF       2584>>IF       2603<<ASSIGN   2605>>IF       2608>>IF       2611>>IF       2622<<DOINDEX
      2623>>IF       2624>>ASSIGN   2624>>ASSIGN   2629>>ASSIGN   2674<<DOINDEX  2675>>IF       2676>>ASSIGN
      2676>>ASSIGN   2679>>ASSIGN   2725<<ASSIGN   2726<<ASSIGN   2741>>ASSIGN   2742>>IF       2745>>IF
      2750>>IF       2753>>IF       2787>>ASSIGN   2790>>IF       2793>>IF       2796>>IF       2799>>IF
      2809>>IF       3065<<ASSIGN   3065<<ASSIGN   3066>>IF       3067>>ASSIGN   3067>>ASSIGN   3074>>DOCASE
      3193<<DOINDEX  3194>>IF       3195>>ASSIGN   3195>>ASSIGN   3270<<ASSIGN   3275<<ASSIGN   3278>>IF
      3278>>IF       3379<<ASSIGN   3384<<ASSIGN   3387>>IF       3387>>IF       3450<<DOINDEX  3451>>IF
      3452>>ASSIGN   3452>>ASSIGN   3518<<ASSIGN   3528>>ASSIGN   3529<<ASSIGN   3529>>ASSIGN   3532>>ASSIGN
      3539>>IF       3549>>ASSIGN   3551<<ASSIGN   3551>>ASSIGN   3974<<DOINDEX  3976>>DOWHILE
I$ACC
       709**DCL-ENT  2830--CALL
I$ACN
       708**DCL-ENT  2768--CALL
I$CALC
       717**DCL-ENT  2712--CALL
I$CHK
       713**DCL-ENT  3741--CALL
I$CON
       708**DCL-ENT  3613--CALL
I$CRPT
       716**DCL-ENT  3777--CALL
I$DIS
       708**DCL-ENT  3633--CALL
I$ERS
       708**DCL-ENT  2891--CALL
I$ETC
       717**DCL-ENT  2657--CALL
I$FAA
       711**DCL-ENT  3403--CALL
I$FAS
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:209  
       711**DCL-ENT  3419--CALL
I$FCD
       710**DCL-ENT  3166--CALL
I$FCR
       711**DCL-ENT  2938--CALL
I$FCT
       711**DCL-ENT  3242--CALL
I$FDC
       710**DCL-ENT  3149--CALL
I$FDP
       710**DCL-ENT  3210--CALL
I$FDR
       712**DCL-ENT  2915--CALL
I$FIN
       707**DCL-ENT  2689--CALL
I$FKC
       710**DCL-ENT  3101--CALL
I$FKY
       710**DCL-ENT  3085--CALL
I$FOR
       711**DCL-ENT  3346--CALL
I$FRA
       712**DCL-ENT  3294--CALL
I$FRI
       713**DCL-ENT  3018--CALL
I$FRS
       712**DCL-ENT  3311--CALL
I$FUI
       712**DCL-ENT  2978--CALL
I$GET
       713**DCL-ENT  3488--CALL
I$GTF
       713**DCL-ENT  3463--CALL
I$HIA
       707**DCL-ENT  2411--CALL
I$IFM
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:210  
       709**DCL-ENT  3707--CALL
I$IFT
       709**DCL-ENT  3659--CALL
I$IST
       709**DCL-ENT  3677--CALL
I$KEEP
       716**DCL-ENT  3908--CALL
I$MOD
       708**DCL-ENT  3570--CALL
I$NBF
       717**DCL-ENT  3759--CALL
I$RDY
       707**DCL-ENT  2638--CALL
I$REDUCEQ
       716**DCL-ENT  3926--CALL
I$ROL
       707**DCL-ENT  3795--CALL
I$RPT
       716**DCL-ENT  3816--CALL
I$SHALL
       714**DCL-ENT  2532--CALL
I$SHANY
       715**DCL-ENT  2564--CALL
I$SHCUR
       715**DCL-ENT  2580--CALL
I$SHIN
       714**DCL-ENT  2548--CALL
I$SHINCUR
       715**DCL-ENT  2596--CALL
I$SHNO
       715**DCL-ENT  2516--CALL
I$STO
       707**DCL-ENT  2855--CALL
I$STOFF
       714**DCL-ENT  3852--CALL
I$STON
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:211  
       714**DCL-ENT  3834--CALL
I$TROFF
       714**DCL-ENT  3869--CALL
I$TRON
       713**DCL-ENT  3889--CALL
IA$
        47**DCL        75--IMP-PTR  2373<<ASSIGN   2646>>DOWHILE  2647>>ASSIGN   3690>>ASSIGN
IA_HALF
        75**DCL      2646>>DOWHILE  2647>>ASSIGN
IDSSYSERR
        63**DCL      3690<<ASSIGN
IDS_BIT9
      2182**DCL      3982>>ASSIGN
IDS_NAMES
      2180**DCL      3976>>DOWHILE
II
        60**DCL      3980<<DOINDEX  3983>>ASSIGN
IPT_ACC
       726**DCL      2830<>CALL
IPT_ACC.DBK_
       728**DCL      2786<<ASSIGN
IPT_ACC.V
       728**DCL      2821--ASSIGN
IPT_ACC.V.CCW.SCI#
       728**DCL      2791<<ASSIGN   2794<<ASSIGN   2797<<ASSIGN   2801<<ASSIGN   2811<<ASSIGN   2814<<ASSIGN
      2817<<ASSIGN
IPT_ACC.V.RVA_ITEM.OFFSET#
       729**DCL      2787<<ASSIGN   2802<<ASSIGN
IPT_ACC.V_
       726**DCL      2821<<ASSIGN
IPT_ACN
       739**DCL      2768<>CALL
IPT_ACN.ANAME_
       741**DCL      2740<<ASSIGN
IPT_ACN.DBK_
       741**DCL      2739<<ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:212  
IPT_ACN.V
       742**DCL      2759--ASSIGN
IPT_ACN.V.NCW.AREA_NME_SIZE#
       742**DCL      2758<<ASSIGN
IPT_ACN.V.NCW.CI#
       742**DCL      2743<<ASSIGN   2746<<ASSIGN   2751<<ASSIGN   2754<<ASSIGN
IPT_ACN.V.RVA_ITEM.OFFSET#
       743**DCL      2741<<ASSIGN   2749<<ASSIGN
IPT_ACN.V_
       739**DCL      2759<<ASSIGN
IPT_CALC
       763**DCL      2712<>CALL
IPT_CALC.DBK_
       765**DCL      2702<<ASSIGN
IPT_CALC.V
       765**DCL      2701--ASSIGN
IPT_CALC.V.UWA_OFFSET
       765**DCL      2703<<ASSIGN
IPT_CALC.V_
       763**DCL      2701<<ASSIGN   2718<<ASSIGN
IPT_CHK
       753**DCL      3741<>CALL
IPT_CHK.ERROR_
       753**DCL      2391<<ASSIGN   2392>>ASSIGN
IPT_CHK.IA_
       753**DCL      2389<<ASSIGN
IPT_CON
       775**DCL      3613<>CALL
IPT_CON.V
       777**DCL      3603--ASSIGN
IPT_CON.V.RC.RC_OFFSET#
       777**DCL      3593<<ASSIGN   3595<<ASSIGN
IPT_CON.V.SC.SC_OFFSET#
       778**DCL      3596<<ASSIGN
IPT_CON.V_
       775**DCL      3603<<ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:213  
IPT_CRPT
       788**DCL      3777<>CALL
IPT_DIS
       797**DCL      3633<>CALL
IPT_DIS.V
       799**DCL      3623--ASSIGN
IPT_DIS.V_
       797**DCL      3623<<ASSIGN
IPT_ERS
       810**DCL      2891<>CALL
IPT_ERS.V
       812**DCL      2882--ASSIGN
IPT_ERS.V.ECW
       813**DCL      2868--ASSIGN
IPT_ERS.V.ECW.EC_BIT#
       813**DCL      2874<<ASSIGN   2878<<ASSIGN
IPT_ERS.V.RC.RC_OFFSET#
       812**DCL      2867<<ASSIGN   2872<<ASSIGN
IPT_ERS.V_
       810**DCL      2882<<ASSIGN
IPT_ETC
       822**DCL      2657<>CALL
IPT_ETC.V
       824**DCL      2648--ASSIGN
IPT_ETC.V_
       822**DCL      2648<<ASSIGN
IPT_FAA
       835**DCL      3403<>CALL
IPT_FAA.V
       837**DCL      3393--ASSIGN
IPT_FAA.V.AC.AC_OFFSET#
       838**DCL      3365<<ASSIGN
IPT_FAA.V.RETENTION_LIST
       842**DCL      3394--ASSIGN
IPT_FAA.V_
       835**DCL      3393<<ASSIGN   3394<<ASSIGN   3394>>ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:214  
IPT_FAS
       852**DCL      3419<>CALL
IPT_FAS.V
       854**DCL      3410--ASSIGN
IPT_FAS.V.RC.RC_OFFSET#
       854**DCL      3380<<ASSIGN   3385<<ASSIGN
IPT_FAS.V.RECORD_NUMBER#
       854**DCL      3367<<ASSIGN   3370<<ASSIGN   3373<<ASSIGN
IPT_FAS.V.RLCW
       856**DCL      3389<>CALL
IPT_FAS.V_
       852**DCL      3410<<ASSIGN
IPT_FCD
       869**DCL      3166<>CALL
IPT_FCD.V
       871**DCL      3157--ASSIGN
IPT_FCD.V_
       869**DCL      3157<<ASSIGN
IPT_FCR
       884**DCL      2938<>CALL
IPT_FCR.V
       886**DCL      2928--ASSIGN
IPT_FCR.V.RLCW
       886**DCL      2929<>CALL
IPT_FCR.V_
       884**DCL      2928<<ASSIGN
IPT_FCT
       898**DCL      3242<>CALL
IPT_FCT.V
       900**DCL      3232--ASSIGN
IPT_FCT.V.RC.RC_OFFSET#
       900**DCL      3230<<ASSIGN
IPT_FCT.V.RETENTION_LIST
       903**DCL      3233--ASSIGN
IPT_FCT.V.RLCW
       901**DCL      3231<>CALL
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:215  
IPT_FCT.V_
       898**DCL      3232<<ASSIGN   3233<<ASSIGN   3233>>ASSIGN
IPT_FDC
       913**DCL      3149<>CALL
IPT_FDC.V
       915**DCL      3139--ASSIGN
IPT_FDC.V.RC.RC_OFFSET#
       915**DCL      3136<<ASSIGN
IPT_FDC.V.RETENTION_LIST
       918**DCL      3140--ASSIGN
IPT_FDC.V.RLCW
       916**DCL      3137<>CALL
IPT_FDC.V_
       913**DCL      3139<<ASSIGN   3140<<ASSIGN   3140>>ASSIGN
IPT_FDP
       928**DCL      3210<>CALL
IPT_FDP.V
       930**DCL      3198--ASSIGN
IPT_FDP.V.FLCW
       931**DCL      3192--ASSIGN
IPT_FDP.V.FLCW.N_FIELDS#
       931**DCL      3196<<ASSIGN   3196>>ASSIGN   3199>>ASSIGN   3201<>CALL
IPT_FDP.V.FL_RL_LIST
       934**DCL      3199--ASSIGN
IPT_FDP.V.FL_RL_LIST.RVA_OFFSET#
       934**DCL      3195<<ASSIGN
IPT_FDP.V.RLCW
       932**DCL      3201<>CALL
IPT_FDP.V.SC.SC_OFFSET#
       930**DCL      3189<<ASSIGN
IPT_FDP.V_
       928**DCL      3198<<ASSIGN   3199<<ASSIGN   3199>>ASSIGN
IPT_FDR
       944**DCL      2915<>CALL
IPT_FDR.DBK_
       946**DCL      2903<<ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:216  
IPT_FDR.V
       946**DCL      2905--ASSIGN
IPT_FDR.V.RC.RC_OFFSET#
       946**DCL      3043<<ASSIGN   3121<<ASSIGN
IPT_FDR.V.RETENTION_LIST
       950**DCL      2906--ASSIGN
IPT_FDR.V.RLCW
       947**DCL      2904<>CALL
IPT_FDR.V_
       944**DCL      2905<<ASSIGN   2906<<ASSIGN   2906>>ASSIGN
IPT_FIN
       960**DCL      2689<>CALL
IPT_FIN.V
       962**DCL      2678--ASSIGN
IPT_FIN.V.AC_OFFSETS
       963**DCL      2679--ASSIGN
IPT_FIN.V.AC_OFFSETS.RVA_OFFSET#
       963**DCL      2676<<ASSIGN
IPT_FIN.V.ALCW.N_AREAS#
       962**DCL      2680<<ASSIGN
IPT_FIN.V_
       960**DCL      2678<<ASSIGN   2679<<ASSIGN   2679>>ASSIGN
IPT_FKC
       973**DCL      3101<>CALL
IPT_FKC.V
       975**DCL      3092--ASSIGN
IPT_FKC.V.FLCW
       977**DCL      3060--ASSIGN
IPT_FKC.V.FLCW.N_FIELDS#
       977**DCL      3071<<ASSIGN   3071>>ASSIGN   3073<>CALL
IPT_FKC.V.FL_RL_LIST.RVA_OFFSET#
       980**DCL      3070<<ASSIGN
IPT_FKC.V.RC.RC_OFFSET#
       975**DCL      3062<<ASSIGN
IPT_FKC.V.RLCW
       977**DCL      3073<>CALL
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:217  
IPT_FKC.V.SC.SC_OFFSET#
       976**DCL      3063<<ASSIGN
IPT_FKC.V_
       973**DCL      3092<<ASSIGN
IPT_FKY
       990**DCL      3085<>CALL
IPT_FKY.V
       992**DCL      3076--ASSIGN
IPT_FKY.V_
       990**DCL      3076<<ASSIGN
IPT_FOR
      1007**DCL      3346<>CALL
IPT_FOR.V
      1009**DCL      3335--ASSIGN
IPT_FOR.V.RETENTION_LIST
      1012**DCL      3336--ASSIGN
IPT_FOR.V.RLCW
      1010**DCL      3337<>CALL
IPT_FOR.V.SC.SC_OFFSET#
      1009**DCL      3334<<ASSIGN
IPT_FOR.V_
      1007**DCL      3335<<ASSIGN   3336<<ASSIGN   3336>>ASSIGN
IPT_FRA
      1022**DCL      3294<>CALL
IPT_FRA.V
      1024**DCL      3285--ASSIGN
IPT_FRA.V_
      1022**DCL      3285<<ASSIGN
IPT_FRI
      1039**DCL      3018<>CALL
IPT_FRI.V
      1041**DCL      3007--ASSIGN
IPT_FRI.V.FCW.RECORD_LOCATION#
      1041**DCL      2988<<ASSIGN   2991<<ASSIGN
IPT_FRI.V.RC.RC_OFFSET#
      1042**DCL      2998<<ASSIGN   3004<<ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:218  
IPT_FRI.V.RETENTION_LIST
      1046**DCL      3008--ASSIGN
IPT_FRI.V.RLCW
      1043**DCL      3009<>CALL
IPT_FRI.V.SC.SC_OFFSET#
      1043**DCL      2999<<ASSIGN   3005<<ASSIGN
IPT_FRI.V_
      1039**DCL      3007<<ASSIGN   3008<<ASSIGN   3008>>ASSIGN
IPT_FRS
      1056**DCL      3311<>CALL
IPT_FRS.V
      1058**DCL      3301--ASSIGN
IPT_FRS.V.FCW.RECORD_LOCATION#
      1058**DCL      3262<<ASSIGN   3265<<ASSIGN   3267<<ASSIGN
IPT_FRS.V.RC.RC_OFFSET#
      1059**DCL      3271<<ASSIGN   3276<<ASSIGN
IPT_FRS.V.RETENTION_LIST
      1063**DCL      3302--ASSIGN
IPT_FRS.V.RLCW
      1060**DCL      3281<>CALL
IPT_FRS.V.SC.SC_OFFSET#
      1060**DCL      3280<<ASSIGN
IPT_FRS.V_
      1056**DCL      3301<<ASSIGN   3302<<ASSIGN   3302>>ASSIGN
IPT_FUI
      1073**DCL      2978<>CALL
IPT_FUI.V
      1075**DCL      2967--ASSIGN
IPT_FUI.V.RC.RC_OFFSET#
      1075**DCL      2964<<ASSIGN
IPT_FUI.V.RETENTION_LIST
      1079**DCL      2968--ASSIGN
IPT_FUI.V.RLCW
      1077**DCL      2969<>CALL
IPT_FUI.V.SC.SC_OFFSET#
      1076**DCL      2965<<ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:219  
IPT_FUI.V_
      1073**DCL      2967<<ASSIGN   2968<<ASSIGN   2968>>ASSIGN
IPT_GET
      1089**DCL      3488<>CALL
IPT_GET.V.RC.RC_OFFSET#
      1091**DCL      3473<<ASSIGN   3476<<ASSIGN
IPT_GTF
      1101**DCL      3463<>CALL
IPT_GTF.V
      1103**DCL      3454--ASSIGN   3478--ASSIGN
IPT_GTF.V.FIELD_LIST
      1104**DCL      3479--ASSIGN
IPT_GTF.V.FIELD_LIST.RVA_OFFSET#
      1104**DCL      3452<<ASSIGN
IPT_GTF.V.FLCW
      1103**DCL      3448--ASSIGN
IPT_GTF.V.FLCW.N_FIELDS#
      1103**DCL      3449<<ASSIGN
IPT_GTF.V_
      1101**DCL      3454<<ASSIGN   3478<<ASSIGN   3479<<ASSIGN   3479>>ASSIGN
IPT_HIA
      1114**DCL      2411<>CALL
IPT_IFM
      1125**DCL      3707<>CALL
IPT_IFM.V
      1127**DCL      3698--ASSIGN
IPT_IFM.V.SC.SC_OFFSET#
      1127**DCL      3697<<ASSIGN
IPT_IFM.V_
      1125**DCL      3698<<ASSIGN
IPT_IFT
      1137**DCL      3659<>CALL
IPT_IFT.V
      1139**DCL      3650--ASSIGN
IPT_IFT.V_
      1137**DCL      3650<<ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:220  
IPT_IST
      1163**DCL      3677<>CALL
IPT_IST.V
      1165**DCL      3668--ASSIGN
IPT_IST.V.SC.SC_OFFSET#
      1166**DCL      3667<<ASSIGN
IPT_IST.V.TDW
      1165**DCL      3645--ASSIGN   3646<<ASSIGN
IPT_IST.V_
      1163**DCL      3668<<ASSIGN
IPT_KEEP
      1202**DCL      3908<>CALL
IPT_KEEP.ERROR_
      1202**DCL      3899<<ASSIGN
IPT_MOD
      1176**DCL      3570<>CALL
IPT_MOD.V
      1178**DCL      3560--ASSIGN
IPT_MOD.V.FLCW
      1180**DCL      3511--ASSIGN
IPT_MOD.V.FLCW.N_FIELDS#
      1180**DCL      3532<<ASSIGN
IPT_MOD.V.FL_SL_LIST
      1181**DCL      3561--ASSIGN
IPT_MOD.V.FL_SL_LIST.RVA_OFFSET#
      1182**DCL      3528<<ASSIGN   3549<<ASSIGN
IPT_MOD.V.MCW
      1179**DCL      3512--ASSIGN
IPT_MOD.V.MCW.MC_BIT0#
      1179**DCL      3538<<ASSIGN
IPT_MOD.V.MCW.MC_BIT1#
      1179**DCL      3543<<ASSIGN
IPT_MOD.V.RC.RC_OFFSET#
      1178**DCL      3510<<ASSIGN   3522<<ASSIGN
IPT_MOD.V.SLCW
      1181**DCL      3513--ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:221  
IPT_MOD.V.SLCW.N_SETS#
      1181**DCL      3552<<ASSIGN   3552>>ASSIGN
IPT_MOD.V_
      1176**DCL      3560<<ASSIGN   3561<<ASSIGN   3561>>ASSIGN
IPT_NBF
      1192**DCL      3759<>CALL
IPT_RDY
      1220**DCL      2638<>CALL
IPT_RDY.V
      1222**DCL      2628--ASSIGN
IPT_RDY.V.AC_OFFSETS
      1223**DCL      2629--ASSIGN
IPT_RDY.V.AC_OFFSETS.RVA_OFFSET#
      1224**DCL      2624<<ASSIGN
IPT_RDY.V.RDCW
      1222**DCL      2602--ASSIGN
IPT_RDY.V.RDCW.AREAS_TO_READY#
      1223**DCL      2626<<ASSIGN
IPT_RDY.V.RDCW.READY_OPTION#
      1222**DCL      2606<<ASSIGN   2609<<ASSIGN   2612<<ASSIGN   2615<<ASSIGN
IPT_RDY.V_
      1220**DCL      2628<<ASSIGN   2629<<ASSIGN   2629>>ASSIGN
IPT_REDUCEQ
      1211**DCL      3926<>CALL
IPT_ROL
      1234**DCL      3795<>CALL
IPT_ROL.ERROR_
      1234**DCL      2392<<ASSIGN
IPT_ROL.IA_
      1234**DCL      2390<<ASSIGN
IPT_STO
      1243**DCL      2855<>CALL
IPT_STO.V
      1245**DCL      2844--ASSIGN
IPT_STO.V.RC.RC_OFFSET#
      1245**DCL      2845<<ASSIGN
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:222  
IPT_STO.V.RLCW
      1246**DCL      2846<>CALL
IPT_STO.V_
      1243**DCL      2844<<ASSIGN
IPT_TROFF
      1267**DCL      3869<>CALL
IPT_TRON
      1258**DCL      3889<>CALL
J
        58**DCL      2484<<DOINDEX  2485>>ASSIGN   2485>>ASSIGN   2502<<ASSIGN   2600<<ASSIGN   2603>>ASSIGN
      2616<<ASSIGN   2619<<ASSIGN   2619>>ASSIGN   2620>>IF       2620>>IF       2620<<ASSIGN   2620>>ASSIGN
      2621>>IF       2621>>IF       2621<<ASSIGN   2621>>ASSIGN   2622>>DOINDEX  2626>>ASSIGN   2736<<ASSIGN
      2737>>IF       2788>>IF       2810>>IF       2813>>IF       2816>>IF       3068<<DOINDEX  3069>>IF
      3070>>ASSIGN   3070>>ASSIGN   3186<<ASSIGN   3187<<ASSIGN   3188>>IF       3189>>ASSIGN   3190<<ASSIGN
      3190>>ASSIGN   3191>>IF       3191<<ASSIGN   3191>>ASSIGN   3193>>DOINDEX  3195>>ASSIGN   3546<<ASSIGN
      3547>>IF       3547<<ASSIGN   3547>>ASSIGN   3548>>DOWHILE  3975<<ASSIGN   3976>>DOWHILE  3976>>DOWHILE
      3977<<ASSIGN   3977>>ASSIGN   3979>>IF       3982>>ASSIGN
JJ
        61**DCL      3963<<ASSIGN   3964>>DOWHILE  3965<<ASSIGN   3965>>ASSIGN   3967>>IF       3970>>ASSIGN
      3974>>DOINDEX  3980>>DOINDEX
K
        59**DCL      2439<<ASSIGN   2442<<ASSIGN   2444<<ASSIGN   2445>>DOWHILE  2446>>IF       2448>>ASSIGN
      2452>>IF       2455>>IF       2458>>IF       2462<<ASSIGN   2462>>ASSIGN   3067<<ASSIGN   3067<<ASSIGN
      3068>>DOINDEX  3070>>ASSIGN   3514<<ASSIGN   3517<<ASSIGN   3521<<ASSIGN   3527>>DOWHILE  3527>>DOWHILE
      3528>>ASSIGN   3530<<ASSIGN   3530>>ASSIGN   3534>>IF       3534>>IF       3534>>IF       3536>>IF
      3541<<ASSIGN   3541>>ASSIGN   3542>>IF       3548>>DOWHILE  3549>>ASSIGN   3550>>IF       3553<<ASSIGN
      3553>>ASSIGN   3558>>IF       3561>>ASSIGN   3953<<ASSIGN   3956<<ASSIGN   3959<<ASSIGN   3964>>DOWHILE
      3967>>IF       3981>>ASSIGN
KEY_COUNT
        70**DCL      2401<<ASSIGN   3984>>ASSIGN   3989<<ASSIGN   3989>>ASSIGN   3990>>ASSIGN
KEY_SAVE
      2314**DCL      2647>>ASSIGN   3990<<ASSIGN
KK
        62**DCL      3973<<ASSIGN   3981>>ASSIGN   3982>>ASSIGN   3983>>ASSIGN   3984>>ASSIGN   3985<<ASSIGN
      3985>>ASSIGN   3988>>ASSIGN
M$GDP
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:223  
      2236**DCL-ENT  2354--CALL
N IN PROCEDURE CHK_RETAIN
      2476**DCL      2469--PROC     2484>>DOINDEX  2484>>DOINDEX  2485>>ASSIGN
NBF_CRPT_TRON$
        53**DCL       788--IMP-PTR  1192--IMP-PTR  1211--IMP-PTR  1258--IMP-PTR  1267--IMP-PTR  3759>>CALL
      3777>>CALL     3869>>CALL     3889>>CALL     3926>>CALL
NULL_OFFSET
        64**DCL      2383<<ASSIGN   2749>>ASSIGN   2802>>ASSIGN   2867>>ASSIGN   3004>>ASSIGN   3121>>ASSIGN
      3276>>ASSIGN   3385>>ASSIGN   3473>>ASSIGN   3510>>ASSIGN   3595>>ASSIGN
OPTION IN PROCEDURE CON_DIS
      3582**DCL      3580--PROC     3587>>IF       3590>>IF
OUT_OF_MEMORY
      2419**LABEL    2379--CALLALT
OUT_OF_MEMORY IN PROCEDURE GET_A_PAGE
      2360**LABEL    2354--CALLALT
PAGE_VECTOR
        78**DCL      2283--DCLINIT
PAGE_VECTOR.ADR
        80**DCL      2355>>ASSIGN   2378>>IF
PARAMS
        39**DCL      2340>>DOINDEX  2342>>ASSIGN   2438>>IF       2438>>IF       2441>>IF       2445>>DOWHILE
      2503>>ASSIGN   2503>>ASSIGN   2603>>ASSIGN   2603>>ASSIGN   2619>>ASSIGN   2674>>DOINDEX  2680>>ASSIGN
      2700>>IF       2736>>ASSIGN   2799>>IF       2843>>IF       2869>>IF       2877>>IF       2877>>IF
      2880>>IF       2926>>IF       2926>>IF       2946>>IF       2946>>IF       2948>>IF       2948>>IF
      2987>>IF       2990>>IF       2994>>IF       3032>>IF       3048>>IF       3064>>IF       3064>>IF
      3068>>DOINDEX  3138>>IF       3193>>DOINDEX  3219>>IF       3219>>IF       3261>>IF       3264>>IF
      3278>>IF       3280>>ASSIGN   3282>>DOCASE   3331>>IF       3332>>IF       3334>>ASSIGN   3365>>ASSIGN
      3366>>IF       3369>>IF       3372>>IF       3387>>IF       3390>>DOCASE   3446>>IF       3449>>ASSIGN
      3450>>DOINDEX  3472>>IF       3475>>IF       3479>>ASSIGN   3515>>IF       3527>>DOWHILE  3534>>IF
      3534>>IF       3534>>IF       3536>>IF       3546>>ASSIGN   3558>>IF       3586>>IF       3587>>IF
      3590>>IF       3596>>ASSIGN   3648>>DOCASE   3952>>IF       3955>>IF       3958>>IF       3963>>ASSIGN
      3967>>IF       3969<<ASSIGN   3969>>ASSIGN   3976>>DOWHILE  3980>>DOINDEX
RETAIN_SWITCH
        71**DCL      2464<<ASSIGN   2478>>IF       2482<<ASSIGN   2645<<ASSIGN
RLCW IN PROCEDURE CHK_RETAIN
      2471**DCL      2469--PROC
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:224  
RLCW.FLAGS IN PROCEDURE CHK_RETAIN
      2472**DCL      2479<<ASSIGN   2483<<ASSIGN
RLCW.RETAIN_LIST.OFFSET IN PROCEDURE CHK_RETAIN
      2474**DCL      2485<<ASSIGN
RLCW$
        54**DCL      2305--IMP-PTR  2357<<ASSIGN   2358>>ASSIGN   2437>>ASSIGN   2448>>ASSIGN   2448>>ASSIGN
      2449>>ASSIGN   2449>>ASSIGN   2453>>ASSIGN   2456>>ASSIGN   2459>>ASSIGN   2483>>ASSIGN   2484>>DOINDEX
      2485>>ASSIGN   2906>>ASSIGN   2968>>ASSIGN   3008>>ASSIGN   3140>>ASSIGN   3199>>ASSIGN   3233>>ASSIGN
      3302>>ASSIGN   3336>>ASSIGN   3394>>ASSIGN
RLCW_SAVE
      2305**DCL      2437--ASSIGN   2483--ASSIGN
RLCW_SAVE.AC_INDICATORS
      2307**DCL      2453<<ASSIGN
RLCW_SAVE.N_SETS#
      2311**DCL      2448>>ASSIGN   2449<<ASSIGN   2449>>ASSIGN   2484>>DOINDEX  2906>>ASSIGN   2968>>ASSIGN
      3008>>ASSIGN   3140>>ASSIGN   3199>>ASSIGN   3233>>ASSIGN   3302>>ASSIGN   3336>>ASSIGN   3394>>ASSIGN
RLCW_SAVE.RC_INDICATORS
      2309**DCL      2459<<ASSIGN
RLCW_SAVE.RETAIN_LIST
      2312**DCL      2448<<ASSIGN   2485>>ASSIGN
RLCW_SAVE.SC_INDICATORS
      2308**DCL      2456<<ASSIGN
RVA$
        49**DCL        73--IMP-PTR    74--IMP-PTR  2375<<ASSIGN   2376>>IF       2380>>ASSIGN   2382>>ASSIGN
      2383>>IF       2703>>ASSIGN   3983>>ASSIGN
RVA_HALF
        74**DCL      2376>>IF       2380>>ASSIGN   2382>>ASSIGN   2383>>IF       2703>>ASSIGN   3983>>ASSIGN
RVA_SIZE
        65**DCL      2380<<ASSIGN   2381>>DOINDEX  2393>>ASSIGN
RVA_TYPE
      2331**DCL      2344>>ASSIGN   2382<<ASSIGN
SBIN36
        69**DCL      2437<<ASSIGN   2483>>ASSIGN   2602<<ASSIGN   2868<<ASSIGN   3060<<ASSIGN   3192<<ASSIGN
      3448<<ASSIGN   3511<<ASSIGN   3512<<ASSIGN   3513<<ASSIGN   3645<<ASSIGN   3690>>ASSIGN
SET_ARGS
      2338**PROC     2436--CALL     2501--CALL     2673--CALL     2699--CALL     2723--CALL     2842--CALL
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:225  
      2866--CALL     2947--CALL     3445--CALL     3509--CALL     3584--CALL     3647--CALL     3695--CALL
      3951--CALL
TYPE$
        55**DCL      2331--IMP-PTR  2344>>ASSIGN   2358<<ASSIGN   2382>>ASSIGN
TYPE_OF_ARG
      2293**DCL      2342<<ASSIGN   2344<<ASSIGN   2446>>IF       2452>>IF       2455>>IF       2458>>IF
      2620>>IF       2621>>IF       2623>>IF       2675>>IF       2700>>IF       2724>>IF       2737>>IF
      2742>>IF       2745>>IF       2750>>IF       2753>>IF       2788>>IF       2790>>IF       2793>>IF
      2796>>IF       2809>>IF       2810>>IF       2813>>IF       2816>>IF       2843>>IF       2871>>IF
      2873>>IF       2948>>IF       2948>>IF       2962>>IF       2966>>IF       2996>>IF       2996>>IF
      3003>>IF       3029>>DOCASE   3044>>IF       3044>>IF       3061>>IF       3066>>IF       3069>>IF
      3122>>IF       3122>>IF       3134>>IF       3187>>IF       3188>>IF       3191>>IF       3194>>IF
      3219>>IF       3268>>IF       3278>>IF       3282>>DOCASE   3331>>IF       3332>>IF       3377>>IF
      3387>>IF       3390>>DOCASE   3446>>IF       3451>>IF       3475>>IF       3519>>IF       3525>>IF
      3527>>DOWHILE  3542>>IF       3547>>IF       3550>>IF       3586>>IF       3587>>IF       3587>>IF
      3590>>IF       3590>>IF       3592>>IF       3666>>IF       3696>>IF       3964>>DOWHILE
USEP
      2316**DCL      2398--ASSIGN
USEP.FLAG
      2317**DCL      2399<<ASSIGN
USEP.M
      2318**DCL      2400<<ASSIGN   3973>>ASSIGN   3988<<ASSIGN
USEP.UC.ENT
      2328**DCL      3984<<ASSIGN
USEP.UC.UCW_PRV.A
      2327**DCL      3983<<ASSIGN
USEP.UC.UCW_PRV.PB
      2326**DCL      3982<<ASSIGN
USEP.UC.UCW_PRV.PT
      2325**DCL      3981<<ASSIGN
USEP.UC.UCW_USE
      2321**DCL      2324--REDEF
USEP$
        50**DCL      2316--IMP-PTR  2395<<ASSIGN   2397<<ASSIGN   2398>>ASSIGN   2399>>ASSIGN   2400>>ASSIGN
      3973>>ASSIGN   3981>>ASSIGN   3982>>ASSIGN   3983>>ASSIGN   3984>>ASSIGN   3988>>ASSIGN
UWA
PL6.E3A0      #001=ZII$APL_IDP File=ZII$APL_IDP.:ZIC0TSI                         FRI 09/05/97 12:25 Page:226  
        76**DCL      2647--ASSIGN   3686>>ASSIGN   3713>>ASSIGN
UWA$
        48**DCL        76--IMP-PTR  2374<<ASSIGN   2391>>ASSIGN   2647>>ASSIGN   3686>>ASSIGN   3713>>ASSIGN
      3899>>ASSIGN
ZII$CHARACTER12
        35**DCL      3990>>ASSIGN
ZII$CHARACTER30
        34**DCL      2740--ASSIGN
ZII$INTEGER1
        32**DCL        82--DCLINIT   754--DCLINIT  1234--DCLINIT  2702--ASSIGN   2739--ASSIGN   2786--ASSIGN
      2903--ASSIGN   3373>>ASSIGN   3686<<ASSIGN   3713<<ASSIGN   3859>>IF       3859>>IF       3860<<ASSIGN
      3879>>IF       3879>>IF       3880<<ASSIGN
ZII$INTEGER2
        33**DCL        83--DCLINIT   753--DCLINIT
ZII$PARAMS
        36**DCL        39--REDEF
ZII$PARAMS.OFFSET
        37**DCL      2341>>IF       2344>>ASSIGN   2448>>ASSIGN   2624>>ASSIGN   2676>>ASSIGN   2703>>ASSIGN
      2741>>ASSIGN   2787>>ASSIGN   2845>>ASSIGN   2872>>ASSIGN   2964>>ASSIGN   2965>>ASSIGN   2998>>ASSIGN
      2999>>ASSIGN   3005>>ASSIGN   3043>>ASSIGN   3062>>ASSIGN   3063>>ASSIGN   3070>>ASSIGN   3136>>ASSIGN
      3189>>ASSIGN   3195>>ASSIGN   3230>>ASSIGN   3271>>ASSIGN   3280>>ASSIGN   3334>>ASSIGN   3365>>ASSIGN
      3380>>ASSIGN   3452>>ASSIGN   3476>>ASSIGN   3522>>ASSIGN   3528>>ASSIGN   3549>>ASSIGN   3593>>ASSIGN
      3596>>ASSIGN   3667>>ASSIGN   3697>>ASSIGN   3970<<ASSIGN   3983>>ASSIGN
