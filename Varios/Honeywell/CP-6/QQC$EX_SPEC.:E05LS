VERSION E05

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:1    
        1        1        /*M* QQC$EX_SPEC - Decompose specifier for CANCEL, HOLD ... */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQC$EX_SPEC:
        9        9                PROC(P_SPECIFIER$, P_VLP_SCGMA, P_VLP_CGMA) ALTRET;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QQ_MACROS_C;
       16      575        %INCLUDE QQ_DATA_R;
       17      821        %INCLUDE QQ_PERR_C;
       18      982        %INCLUDE Q_ERRCODE_C;
       19     1005        %INCLUDE XU_MACRO_C;
       20     4111        %INCLUDE QQ_SUBS_C;
       21     4303        %PAGE(ARG="Parameters");

              4320    1   /***************************************************************************
              4321    1    *                                                                         *
              4322    1    *                                 Parameters                              *
              4323    1    *                                                                         *
              4324    1    ***************************************************************************/

       22     4328        %VLP_CGMA(FPTN=P_VLP_CGMA, STCLASS=);
       23     4355        %VLP_SCGMA(FPTN=P_VLP_SCGMA, STCLASS=);
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:2    
       24     4372    1   DCL P_SPECIFIER$ PTR;
       25     4373        %PAGE(ARG="Externally defined routines");

              4390    1   /***************************************************************************
              4391    1    *                                                                         *
              4392    1    *                        Externally defined routines                      *
              4393    1    *                                                                         *
              4394    1    ***************************************************************************/

       26     4398    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       27     4399    1   DCL QQC$BLDMSG ENTRY(1);
       28     4400        %PAGE(ARG="Based");

              4417    1   /***************************************************************************
              4418    1    *                                                                         *
              4419    1    *                                   Based                                 *
              4420    1    *                                                                         *
              4421    1    ***************************************************************************/

       29     4425        %PARSE$OUT(STCLASS=BASED);
       30     4470        %PARSE$SYM(STCLASS=BASED);
       31     4508        %TP$STATION;
       32     4581        %PAGE(ARG="Constants");

              4598    1   /***************************************************************************
              4599    1    *                                                                         *
              4600    1    *                                 Constants                               *
              4601    1    *                                                                         *
              4602    1    ***************************************************************************/

       33     4606        %VLP_CGMA(FPTN=VLP_CGMA_C, STCLASS=CONSTANT);
       34     4633        %VLP_SCGMA(FPTN=VLP_SCGMA_C, STCLASS=CONSTANT, MSGTYP=YES);
       35     4650        %PAGE(ARG="Auto");

              4667    1   /***************************************************************************
              4668    1    *                                                                         *
              4669    1    *                                    Auto                                 *
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:3    
              4670    1    *                                                                         *
              4671    1    ***************************************************************************/

       36     4675    1   DCL STATION$ PTR;
       37     4676    1   DCL SUBLK$ PTR;
       38     4677    1   DCL TYPE$ PTR;
       39     4678    1   DCL TRANID$ PTR;
       40     4679
       41     4680    1   DCL I UBIN WORD;
       42     4681    1   DCL NSUBLKS UBIN WORD;
       43     4682    1   DCL POS UBIN WORD;
       44     4683
       45     4684    1   DCL WILD_FLAG BIT(1);
       46     4685
       47     4686        %MSGBLK;
       48     4776        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:4    
              4793    1   /***************************************************************************
              4794    1    *                                                                         *
              4795    1    *                                Error codes                              *
              4796    1    *                                                                         *
              4797    1    ***************************************************************************/

       49     4801        %ERRCODE(NAME=CODE_IWT, CODE#=%E$IWT, FCG#=%FCG_QQ, MID#=%MID_B);
       50     4808        %ERRCODE(NAME=CODE_IWS, CODE#=%E$IWS, FCG#=%FCG_QQ, MID#=%MID_C);
       51     4815        %ERRCODE(NAME=CODE_OYM, CODE#=%E$OYM, FCG#=%FCG_QQ, MID#=%MID_C);
       52     4822        /*E*       ERROR: QQC-E$IWS-C
       53     4823
       54     4824                 MESSAGE: The specified station name is invalid.
       55     4825                          Wildcarded stations may only have a ? as the last
       56     4826                          character of the transaction type,
       57     4827                          e. g., A?B? is illegal, ? or AB? are legal.
       58     4828             DESCRIPTION: Wild carded stations are more restrictive
       59     4829                          than generalized wild carding.  The rules are
       60     4830                          only one ?, and the ? must be the last character
       61     4831                          of the station group.  In addition ? may not
       62     4832                          be the only character E.G., ????.
       63     4833        */
       64     4834        /*E*       ERROR: QQC-E$OYM-S
       65     4835
       66     4836                 MESSAGE: As a non-privileged station you may only
       67     4837                          examine / modify your own messages.
       68     4838             DESCRIPTION: Non privileged stations may not use wild
       69     4839                          carded stations in the specifier and the
       70     4840                          station (if specified) must be their own.
       71     4841        */
       72     4842        %PAGE(ARG="QQC$EX_SPEC", PAGE=YES);

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:5    
              4859    1   /***************************************************************************
              4860    1    *                                                                         *
              4861    1    *                                QQC$EX_SPEC                              *
              4862    1    *                                                                         *
              4863    1    ***************************************************************************/

       73     4867    1           P_VLP_CGMA = VLP_CGMA_C;
       74     4868    1           P_VLP_SCGMA = VLP_SCGMA_C;
       75     4869    1           NSUBLKS = P_SPECIFIER$ -> OUT$BLK.NSUBLKS - 1;
       76     4870    1           P_VLP_CGMA.ORIGIN# = QQ_CMDBLK.S$ -> TP$STATION.ID;
       77     4871
       78     4872    2           DO I = 0 TO NSUBLKS;
       79     4873    2             SUBLK$ = P_SPECIFIER$ -> OUT$BLK.SUBLK$(I);
       80     4874    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);
       81     4875
       82     4876    3               CASE(1 /* OPT_STATION */);
       83     4877    3                 STATION$ = SUBLK$;
       84     4878    3                 WILD_FLAG = '0'B;
       85     4879    3                 CALL INDEX(POS, '?', STATION$ -> OUT$SYM.TEXT) ALTRET(NO_Q);
       86     4880    3                 WILD_FLAG = '1'B;
       87     4881
       88     4882    3                 IF STATION$ -> OUT$SYM.COUNT - 1 ~= POS THEN
       89     4883    4                   DO;
       90     4884    4                     QQ_CMDBLK.MINOR_ERR = CODE_IWS;
       91     4885    4                     GOTO PRINT_ERR;
       92     4886    4                   END;
       93     4887
       94     4888    3   NO_Q:
       95     4889    3                 IF NOT QQ_CMDBLK.S$ -> TP$STATION.FLAGS.PRIV AND
       96     4890    3                     STATION$ -> OUT$SYM.TEXT ~= QQ_CMDBLK.S$ -> TP$STATION.ID THEN
       97     4891    4                   DO;
       98     4892    4                     QQ_CMDBLK.MINOR_ERR = CODE_OYM;
       99     4893    4                     GOTO PRINT_ERR;
      100     4894    4                   END;
      101     4895
      102     4896    3                 P_VLP_CGMA.ORIGIN# = STATION$ -> OUT$SYM.TEXT;
      103     4897
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:6    
      104     4898    3               CASE(4 /* OPT_TYPE */);
      105     4899    3                 TYPE$ = SUBLK$;
      106     4900    3                 CALL INDEX(POS, '?', TYPE$ -> OUT$SYM.TEXT) ALTRET(NO_Q2);
      107     4901
      108     4902    3                 IF TYPE$ -> OUT$SYM.COUNT - 1 ~= POS THEN
      109     4903    4                   DO;
      110     4904    4                     QQ_CMDBLK.MINOR_ERR = CODE_IWT;
      111     4905    4                     GOTO PRINT_ERR;
      112     4906    4                   END;
      113     4907
      114     4908    3   NO_Q2:
      115     4909    3                 P_VLP_CGMA.MSGTYP# = TYPE$ -> OUT$SYM.TEXT;
      116     4910
      117     4911    3               CASE(5 /* OPT_TRANID */);
      118     4912    3                 TRANID$ = SUBLK$;
      119     4913
      120     4914    3                 P_VLP_SCGMA.MSGTYP# = '0'B;
      121     4915    3                 P_VLP_SCGMA.MSGID# = '1'B;
      122     4916    3                 CALL CHARBIN(P_VLP_CGMA.MSGID#,
      123     4917    3                     TRANID$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      124     4918
      125     4919    3                 IF TRANID$ -> OUT$BLK.NSUBLKS = 2 THEN
      126     4920    4                   DO;
      127     4921    4                     P_VLP_SCGMA.MSGIDXT# = 1;
      128     4922    4                     CALL CHARBIN(P_VLP_CGMA.MSGIDBXT,
      129     4923    4                         TRANID$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      130     4924    4                   END;
      131     4925
      132     4926    3             END /* CASE */;
      133     4927    2           END;
      134     4928
      135     4929    1           RETURN;
      136     4930
      137     4931    1   PRINT_ERR:
      138     4932    1           CALL QQC$BLDMSG_BLK(MSGBLK);
      139     4933    1           CALL QQC$BLDMSG(MSGBLK);
      140     4934
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:7    
      141     4935    1           ALTRETURN;
      142     4936
      143     4937    1   END QQC$EX_SPEC;

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:8    
--  Include file information  --

   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$EX_SPEC.

   Procedure QQC$EX_SPEC requires 159 words for executable code.
   Procedure QQC$EX_SPEC requires 38 words of local(AUTO) storage.

    No errors detected in file QQC$EX_SPEC.:E05TSI    .

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:9    

 Object Unit name= QQC$EX_SPEC                                File name= QQC$EX_SPEC.:E05TOU
 UTS= JUL 30 '97 05:40:13.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     21     25  QQC$EX_SPEC
    2   Proc  even  none   159    237  QQC$EX_SPEC
    3  RoData even  none     1      1  QQC$EX_SPEC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        3  QQC$EX_SPEC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 QQC$BLDMSG_BLK
         yes           Std       1 QQC$BLDMSG
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:10   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             B_VECTNIL
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:11   


        1        1        /*M* QQC$EX_SPEC - Decompose specifier for CANCEL, HOLD ... */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQC$EX_SPEC:
        9        9                PROC(P_SPECIFIER$, P_VLP_SCGMA, P_VLP_CGMA) ALTRET;

      9  2 000000   000000 700200 xent  QQC$EX_SPEC  TSX0  ! X66_AUTO_3
         2 000001   000046 000003                    ZERO    38,3

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QQ_MACROS_C;
       16      575        %INCLUDE QQ_DATA_R;
       17      821        %INCLUDE QQ_PERR_C;
       18      982        %INCLUDE Q_ERRCODE_C;
       19     1005        %INCLUDE XU_MACRO_C;
       20     4111        %INCLUDE QQ_SUBS_C;
       21     4303        %PAGE(ARG="Parameters");

              4320    1   /***************************************************************************
              4321    1    *                                                                         *
              4322    1    *                                 Parameters                              *
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:12   
              4323    1    *                                                                         *
              4324    1    ***************************************************************************/

       22     4328        %VLP_CGMA(FPTN=P_VLP_CGMA, STCLASS=);
       23     4355        %VLP_SCGMA(FPTN=P_VLP_SCGMA, STCLASS=);
       24     4372    1   DCL P_SPECIFIER$ PTR;
       25     4373        %PAGE(ARG="Externally defined routines");

              4390    1   /***************************************************************************
              4391    1    *                                                                         *
              4392    1    *                        Externally defined routines                      *
              4393    1    *                                                                         *
              4394    1    ***************************************************************************/

       26     4398    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       27     4399    1   DCL QQC$BLDMSG ENTRY(1);
       28     4400        %PAGE(ARG="Based");

              4417    1   /***************************************************************************
              4418    1    *                                                                         *
              4419    1    *                                   Based                                 *
              4420    1    *                                                                         *
              4421    1    ***************************************************************************/

       29     4425        %PARSE$OUT(STCLASS=BASED);
       30     4470        %PARSE$SYM(STCLASS=BASED);
       31     4508        %TP$STATION;
       32     4581        %PAGE(ARG="Constants");

              4598    1   /***************************************************************************
              4599    1    *                                                                         *
              4600    1    *                                 Constants                               *
              4601    1    *                                                                         *
              4602    1    ***************************************************************************/

       33     4606        %VLP_CGMA(FPTN=VLP_CGMA_C, STCLASS=CONSTANT);
       34     4633        %VLP_SCGMA(FPTN=VLP_SCGMA_C, STCLASS=CONSTANT, MSGTYP=YES);
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:13   
       35     4650        %PAGE(ARG="Auto");

              4667    1   /***************************************************************************
              4668    1    *                                                                         *
              4669    1    *                                    Auto                                 *
              4670    1    *                                                                         *
              4671    1    ***************************************************************************/

       36     4675    1   DCL STATION$ PTR;
       37     4676    1   DCL SUBLK$ PTR;
       38     4677    1   DCL TYPE$ PTR;
       39     4678    1   DCL TRANID$ PTR;
       40     4679
       41     4680    1   DCL I UBIN WORD;
       42     4681    1   DCL NSUBLKS UBIN WORD;
       43     4682    1   DCL POS UBIN WORD;
       44     4683
       45     4684    1   DCL WILD_FLAG BIT(1);
       46     4685
       47     4686        %MSGBLK;
       48     4776        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:14   
              4793    1   /***************************************************************************
              4794    1    *                                                                         *
              4795    1    *                                Error codes                              *
              4796    1    *                                                                         *
              4797    1    ***************************************************************************/

       49     4801        %ERRCODE(NAME=CODE_IWT, CODE#=%E$IWT, FCG#=%FCG_QQ, MID#=%MID_B);
       50     4808        %ERRCODE(NAME=CODE_IWS, CODE#=%E$IWS, FCG#=%FCG_QQ, MID#=%MID_C);
       51     4815        %ERRCODE(NAME=CODE_OYM, CODE#=%E$OYM, FCG#=%FCG_QQ, MID#=%MID_C);
       52     4822        /*E*       ERROR: QQC-E$IWS-C
       53     4823
       54     4824                 MESSAGE: The specified station name is invalid.
       55     4825                          Wildcarded stations may only have a ? as the last
       56     4826                          character of the transaction type,
       57     4827                          e. g., A?B? is illegal, ? or AB? are legal.
       58     4828             DESCRIPTION: Wild carded stations are more restrictive
       59     4829                          than generalized wild carding.  The rules are
       60     4830                          only one ?, and the ? must be the last character
       61     4831                          of the station group.  In addition ? may not
       62     4832                          be the only character E.G., ????.
       63     4833        */
       64     4834        /*E*       ERROR: QQC-E$OYM-S
       65     4835
       66     4836                 MESSAGE: As a non-privileged station you may only
       67     4837                          examine / modify your own messages.
       68     4838             DESCRIPTION: Non privileged stations may not use wild
       69     4839                          carded stations in the specifier and the
       70     4840                          station (if specified) must be their own.
       71     4841        */
       72     4842        %PAGE(ARG="QQC$EX_SPEC", PAGE=YES);

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:15   
              4859    1   /***************************************************************************
              4860    1    *                                                                         *
              4861    1    *                                QQC$EX_SPEC                              *
              4862    1    *                                                                         *
              4863    1    ***************************************************************************/

       73     4867    1           P_VLP_CGMA = VLP_CGMA_C;

   4867  2 000002   200005 470500                    LDP0    @P_VLP_CGMA,,AUTO
         2 000003   000100 100400                    MLR     fill='000'O
         2 000004   000000 000100 1                  ADSC9   VLP_CGMA_C               cn=0,n=64
         2 000005   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64

       74     4868    1           P_VLP_SCGMA = VLP_SCGMA_C;

   4868  2 000006   000020 237000 1                  LDAQ    VLP_SCGMA_C
         2 000007   200004 471500                    LDP1    @P_VLP_SCGMA,,AUTO
         2 000010   100000 757100                    STAQ    0,,PR1

       75     4869    1           NSUBLKS = P_SPECIFIER$ -> OUT$BLK.NSUBLKS - 1;

   4869  2 000011   200003 473500                    LDP3    @P_SPECIFIER$,,AUTO
         2 000012   300000 474500                    LDP4    0,,PR3
         2 000013   400001 236100                    LDQ     1,,PR4
         2 000014   000022 772000                    QRL     18
         2 000015   000001 136007                    SBLQ    1,DL
         2 000016   200014 756100                    STQ     NSUBLKS,,AUTO

       76     4870    1           P_VLP_CGMA.ORIGIN# = QQ_CMDBLK.S$ -> TP$STATION.ID;

   4870  2 000017   000004 475400 xsym               LDP5    QQ_CMDBLK+4
         2 000020   040100 100500                    MLR     fill='040'O
         2 000021   500000 000010                    ADSC9   0,,PR5                   cn=0,n=8
         2 000022   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8

       77     4871
       78     4872    2           DO I = 0 TO NSUBLKS;
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:16   

   4872  2 000023   200013 450100                    STZ     I,,AUTO
         2 000024   000216 710000 2                  TRA     s:4927+3

       79     4873    2             SUBLK$ = P_SPECIFIER$ -> OUT$BLK.SUBLK$(I);

   4873  2 000025   200003 470500                    LDP0    @P_SPECIFIER$,,AUTO
         2 000026   000000 471500                    LDP1    0,,PR0
         2 000027   200013 720100                    LXL0    I,,AUTO
         2 000030   100003 236110                    LDQ     3,X0,PR1
         2 000031   200010 756100                    STQ     SUBLK$,,AUTO

       80     4874    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);

   4874  2 000032   200010 473500                    LDP3    SUBLK$,,AUTO
         2 000033   300000 721100                    LXL1    0,,PR3
         2 000034   000006 101003                    CMPX1   6,DU
         2 000035   000037 602011 2                  TNC     s:4874+5,X1
         2 000036   000213 710000 2                  TRA     s:4927
         2 000037   000213 710000 2                  TRA     s:4927
         2 000040   000045 710000 2                  TRA     s:4877
         2 000041   000213 710000 2                  TRA     s:4927
         2 000042   000213 710000 2                  TRA     s:4927
         2 000043   000122 710000 2                  TRA     s:4899
         2 000044   000154 710000 2                  TRA     s:4912

       81     4875
       82     4876    3               CASE(1 /* OPT_STATION */);

       83     4877    3                 STATION$ = SUBLK$;

   4877  2 000045   200007 756100                    STQ     STATION$,,AUTO

       84     4878    3                 WILD_FLAG = '0'B;

   4878  2 000046   200016 450100                    STZ     WILD_FLAG,,AUTO

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:17   
       85     4879    3                 CALL INDEX(POS, '?', STATION$ -> OUT$SYM.TEXT) ALTRET(NO_Q);

   4879  2 000047   200007 474500                    LDP4    STATION$,,AUTO
         2 000050   400004 236100                    LDQ     4,,PR4
         2 000051   000033 772000                    QRL     27
         2 000052   000000 622006                    EAX2    0,QL
         2 000053   000000 124540                    SCM     mask='000'O
         2 000054   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         2 000055   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000056   200015 000100                    ARG     POS,,AUTO
         2 000057   000073 606400 2                  TTN     NO_Q

       86     4880    3                 WILD_FLAG = '1'B;

   4880  2 000060   400000 236003                    LDQ     -131072,DU
         2 000061   200016 756100                    STQ     WILD_FLAG,,AUTO

       87     4881
       88     4882    3                 IF STATION$ -> OUT$SYM.COUNT - 1 ~= POS THEN

   4882  2 000062   400004 236100                    LDQ     4,,PR4
         2 000063   000033 772000                    QRL     27
         2 000064   000001 136007                    SBLQ    1,DL
         2 000065   000070 604000 2                  TMI     s:4884
         2 000066   200015 116100                    CMPQ    POS,,AUTO
         2 000067   000073 600000 2                  TZE     NO_Q

       89     4883    4                   DO;

       90     4884    4                     QQ_CMDBLK.MINOR_ERR = CODE_IWS;

   4884  2 000070   000023 236000 1                  LDQ     CODE_IWS
         2 000071   000001 756000 xsym               STQ     QQ_CMDBLK+1

       91     4885    4                     GOTO PRINT_ERR;

   4885  2 000072   000222 710000 2                  TRA     PRINT_ERR
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:18   

       92     4886    4                   END;
       93     4887
       94     4888    3   NO_Q:
       95     4889    3                 IF NOT QQ_CMDBLK.S$ -> TP$STATION.FLAGS.PRIV AND

   4889  2 000073   000004 470400 xsym  NO_Q         LDP0    QQ_CMDBLK+4
         2 000074   000022 234100                    SZN     18,,PR0
         2 000075   000111 604000 2                  TMI     s:4896
         2 000076   200007 471500                    LDP1    STATION$,,AUTO
         2 000077   100004 236100                    LDQ     4,,PR1
         2 000100   000033 772000                    QRL     27
         2 000101   000000 620006                    EAX0    0,QL
         2 000102   040100 106540                    CMPC    fill='040'O
         2 000103   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000104   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         2 000105   000111 600000 2                  TZE     s:4896

       96     4890    3                     STATION$ -> OUT$SYM.TEXT ~= QQ_CMDBLK.S$ -> TP$STATION.ID THEN
       97     4891    4                   DO;

       98     4892    4                     QQ_CMDBLK.MINOR_ERR = CODE_OYM;

   4892  2 000106   000024 236000 1                  LDQ     CODE_OYM
         2 000107   000001 756000 xsym               STQ     QQ_CMDBLK+1

       99     4893    4                     GOTO PRINT_ERR;

   4893  2 000110   000222 710000 2                  TRA     PRINT_ERR

      100     4894    4                   END;
      101     4895
      102     4896    3                 P_VLP_CGMA.ORIGIN# = STATION$ -> OUT$SYM.TEXT;

   4896  2 000111   200007 471500                    LDP1    STATION$,,AUTO
         2 000112   100004 236100                    LDQ     4,,PR1
         2 000113   000033 772000                    QRL     27
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:19   
         2 000114   000000 620006                    EAX0    0,QL
         2 000115   200005 473500                    LDP3    @P_VLP_CGMA,,AUTO
         2 000116   040100 100540                    MLR     fill='040'O
         2 000117   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000120   300004 000010                    ADSC9   4,,PR3                   cn=0,n=8
         2 000121   000213 710000 2                  TRA     s:4927

      103     4897
      104     4898    3               CASE(4 /* OPT_TYPE */);

      105     4899    3                 TYPE$ = SUBLK$;

   4899  2 000122   200011 756100                    STQ     TYPE$,,AUTO

      106     4900    3                 CALL INDEX(POS, '?', TYPE$ -> OUT$SYM.TEXT) ALTRET(NO_Q2);

   4900  2 000123   200011 474500                    LDP4    TYPE$,,AUTO
         2 000124   400004 236100                    LDQ     4,,PR4
         2 000125   000033 772000                    QRL     27
         2 000126   000000 622006                    EAX2    0,QL
         2 000127   000000 124540                    SCM     mask='000'O
         2 000130   400004 200012                    ADSC9   4,,PR4                   cn=1,n=*X2
         2 000131   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000132   200015 000100                    ARG     POS,,AUTO
         2 000133   000143 606400 2                  TTN     NO_Q2

      107     4901
      108     4902    3                 IF TYPE$ -> OUT$SYM.COUNT - 1 ~= POS THEN

   4902  2 000134   000001 136007                    SBLQ    1,DL
         2 000135   000140 604000 2                  TMI     s:4904
         2 000136   200015 116100                    CMPQ    POS,,AUTO
         2 000137   000143 600000 2                  TZE     NO_Q2

      109     4903    4                   DO;

      110     4904    4                     QQ_CMDBLK.MINOR_ERR = CODE_IWT;
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:20   

   4904  2 000140   000022 236000 1                  LDQ     CODE_IWT
         2 000141   000001 756000 xsym               STQ     QQ_CMDBLK+1

      111     4905    4                     GOTO PRINT_ERR;

   4905  2 000142   000222 710000 2                  TRA     PRINT_ERR

      112     4906    4                   END;
      113     4907
      114     4908    3   NO_Q2:
      115     4909    3                 P_VLP_CGMA.MSGTYP# = TYPE$ -> OUT$SYM.TEXT;

   4909  2 000143   200011 470500       NO_Q2        LDP0    TYPE$,,AUTO
         2 000144   000004 236100                    LDQ     4,,PR0
         2 000145   000033 772000                    QRL     27
         2 000146   000000 620006                    EAX0    0,QL
         2 000147   200005 471500                    LDP1    @P_VLP_CGMA,,AUTO
         2 000150   040100 100540                    MLR     fill='040'O
         2 000151   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         2 000152   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         2 000153   000213 710000 2                  TRA     s:4927

      116     4910
      117     4911    3               CASE(5 /* OPT_TRANID */);

      118     4912    3                 TRANID$ = SUBLK$;

   4912  2 000154   200012 756100                    STQ     TRANID$,,AUTO

      119     4913
      120     4914    3                 P_VLP_SCGMA.MSGTYP# = '0'B;

   4914  2 000155   200004 474500                    LDP4    @P_VLP_SCGMA,,AUTO
         2 000156   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 000157   400000 356100                    ANSQ    0,,PR4

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:21   
      121     4915    3                 P_VLP_SCGMA.MSGID# = '1'B;

   4915  2 000160   010000 236003                    LDQ     4096,DU
         2 000161   400000 256100                    ORSQ    0,,PR4

      122     4916    3                 CALL CHARBIN(P_VLP_CGMA.MSGID#,

   4916  2 000162   200012 471500                    LDP1    TRANID$,,AUTO
         2 000163   100003 475500                    LDP5    3,,PR1
         2 000164   500004 236100                    LDQ     4,,PR5
         2 000165   000033 772000                    QRL     27
         2 000166   000000 621006                    EAX1    0,QL
         2 000167   000100 305540                    DTB
         2 000170   500004 230011                    NDSC9   4,,PR5                   cn=1,s=nosgn,sf=0,n=*X1
         2 000171   200044 000010                    NDSC9   MSGBLK+21,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 000172   200005 475500                    LDP5    @P_VLP_CGMA,,AUTO
         2 000173   200045 235100                    LDA     MSGBLK+22,,AUTO
         2 000174   500014 755100                    STA     12,,PR5

      123     4917    3                     TRANID$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT);
      124     4918
      125     4919    3                 IF TRANID$ -> OUT$BLK.NSUBLKS = 2 THEN

   4919  2 000175   100001 221100                    LDX1    1,,PR1
         2 000176   000002 101003                    CMPX1   2,DU
         2 000177   000213 601000 2                  TNZ     s:4927

      126     4920    4                   DO;

      127     4921    4                     P_VLP_SCGMA.MSGIDXT# = 1;

   4921  2 000200   000001 236003                    LDQ     1,DU
         2 000201   400000 552120                    STBQ    0,'20'O,PR4

      128     4922    4                     CALL CHARBIN(P_VLP_CGMA.MSGIDBXT,

   4922  2 000202   100004 476500                    LDP6    4,,PR1
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:22   
         2 000203   600004 236100                    LDQ     4,,PR6
         2 000204   000033 772000                    QRL     27
         2 000205   000000 621006                    EAX1    0,QL
         2 000206   000100 305540                    DTB
         2 000207   600004 230011                    NDSC9   4,,PR6                   cn=1,s=nosgn,sf=0,n=*X1
         2 000210   200044 000010                    NDSC9   MSGBLK+21,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 000211   200045 235100                    LDA     MSGBLK+22,,AUTO
         2 000212   500015 755100                    STA     13,,PR5

      129     4923    4                         TRANID$ -> OUT$BLK.SUBLK$(1) -> OUT$SYM.TEXT);
      130     4924    4                   END;

      131     4925
      132     4926    3             END /* CASE */;

      133     4927    2           END;

   4927  2 000213   200013 235100                    LDA     I,,AUTO
         2 000214   000001 035007                    ADLA    1,DL
         2 000215   200013 755100                    STA     I,,AUTO
         2 000216   200014 236100                    LDQ     NSUBLKS,,AUTO
         2 000217   200013 116100                    CMPQ    I,,AUTO
         2 000220   000025 603000 2                  TRC     s:4873

      134     4928
      135     4929    1           RETURN;

   4929  2 000221   000000 702200 xent               TSX2  ! X66_ARET

      136     4930
      137     4931    1   PRINT_ERR:
      138     4932    1           CALL QQC$BLDMSG_BLK(MSGBLK);

   4932  2 000222   200017 630500       PRINT_ERR    EPPR0   MSGBLK,,AUTO
         2 000223   200044 450500                    STP0    MSGBLK+21,,AUTO
         2 000224   200044 630500                    EPPR0   MSGBLK+21,,AUTO
         2 000225   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:23   
         2 000226   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         2 000227   000000 011000                    NOP     0

      139     4933    1           CALL QQC$BLDMSG(MSGBLK);

   4933  2 000230   200017 630500                    EPPR0   MSGBLK,,AUTO
         2 000231   200044 450500                    STP0    MSGBLK+21,,AUTO
         2 000232   200044 630500                    EPPR0   MSGBLK+21,,AUTO
         2 000233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000234   000000 701000 xent               TSX1    QQC$BLDMSG
         2 000235   000000 011000                    NOP     0

      140     4934
      141     4935    1           ALTRETURN;

   4935  2 000236   000000 702200 xent               TSX2  ! X66_AALT
      142     4936
      143     4937    1   END QQC$EX_SPEC;

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:24   
--  Include file information  --

   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$EX_SPEC.
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:25   

 **** Variables and constants ****

  ****  Section 001 RoData QQC$EX_SPEC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    23-0-0/b STRC        r     1 CODE_IWS                  22-0-0/b STRC        r     1 CODE_IWT
    24-0-0/b STRC        r     1 CODE_OYM                   0-0-0/w STRC(576)   r     1 VLP_CGMA_C
    20-0-0/d STRC(72)    r     1 VLP_SCGMA_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @P_SPECIFIER$              5-0-0/w PTR         r     1 @P_VLP_CGMA
     4-0-0/w PTR         r     1 @P_VLP_SCGMA              13-0-0/w UBIN        r     1 I
    17-0-0/w STRC(738)   r     1 MSGBLK                    14-0-0/w UBIN        r     1 NSUBLKS
    15-0-0/w UBIN        r     1 POS                       *0-0-0/w PTR         r     1 P_SPECIFIER$
    *0-0-0/w STRC(576)   r     1 P_VLP_CGMA                *0-0-0/d STRC(72)    r     1 P_VLP_SCGMA
     6-0-0/w PTR         r     1 S$                         7-0-0/w PTR         r     1 STATION$
    10-0-0/w PTR         r     1 SUBLK$                    12-0-0/w PTR         r     1 TRANID$
    11-0-0/w PTR         r     1 TYPE$                     16-0-0/b BIT         r     1 WILD_FLAG

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(315)   r     1 QQ_CMDBLK

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:26   
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQC$EX_SPEC requires 159 words for executable code.
   Procedure QQC$EX_SPEC requires 38 words of local(AUTO) storage.

    No errors detected in file QQC$EX_SPEC.:E05TSI    .
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:27   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:28   
          MINI XREF LISTING

CODE_IWS
      4809**DCL      4884>>ASSIGN
CODE_IWT
      4802**DCL      4904>>ASSIGN
CODE_OYM
      4816**DCL      4892>>ASSIGN
I
      4680**DCL      4872<<DOINDEX  4873>>ASSIGN
MSGBLK
      4687**DCL      4932<>CALL     4933<>CALL
NO_Q
      4889**LABEL    4879--CALLALT
NO_Q2
      4909**LABEL    4900--CALLALT
NSUBLKS
      4681**DCL      4869<<ASSIGN   4872>>DOINDEX
OUT$BLK.NSUBLKS
      4443**DCL      4869>>ASSIGN   4919>>IF
OUT$BLK.SUBLK$
      4464**DCL      4873>>ASSIGN   4916>>CALLBLT  4916>>CALLBLT  4922>>CALLBLT  4922>>CALLBLT
OUT$SYM.CODE
      4483**DCL      4874>>DOCASE
OUT$SYM.COUNT
      4500**DCL      4503--IMP-SIZ  4879>>CALLBLT  4882>>IF       4889>>IF       4896>>ASSIGN   4900>>CALLBLT
      4902>>IF       4909>>ASSIGN   4916>>CALLBLT  4922>>CALLBLT
OUT$SYM.TEXT
      4503**DCL      4879>>CALLBLT  4889>>IF       4896>>ASSIGN   4900>>CALLBLT  4909>>ASSIGN   4916>>CALLBLT
      4922>>CALLBLT
POS
      4682**DCL      4879<<CALLBLT  4882>>IF       4900<<CALLBLT  4902>>IF
PRINT_ERR
      4932**LABEL    4885--GOTO     4893--GOTO     4905--GOTO
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:29   
P_SPECIFIER$
      4372**DCL         8--PROC     4869>>ASSIGN   4873>>ASSIGN
P_VLP_CGMA
      4340**DCL         8--PROC     4867<<ASSIGN
P_VLP_CGMA.MSGID#
      4348**DCL      4916<<CALLBLT
P_VLP_CGMA.MSGIDBXT
      4352**DCL      4922<<CALLBLT
P_VLP_CGMA.MSGIDXT
      4349**DCL      4352--REDEF
P_VLP_CGMA.MSGTYP#
      4345**DCL      4909<<ASSIGN
P_VLP_CGMA.ORIGIN#
      4345**DCL      4870<<ASSIGN   4896<<ASSIGN
P_VLP_SCGMA
      4366**DCL         8--PROC     4868<<ASSIGN
P_VLP_SCGMA.MSGID#
      4367**DCL      4915<<ASSIGN
P_VLP_SCGMA.MSGIDXT#
      4369**DCL      4921<<ASSIGN
P_VLP_SCGMA.MSGTYP#
      4366**DCL      4914<<ASSIGN
QQC$BLDMSG
      4399**DCL-ENT  4933--CALL
QQC$BLDMSG_BLK
      4398**DCL-ENT  4932--CALL
QQ_CMDBLK.MINOR_ERR
       584**DCL      4884<<ASSIGN   4892<<ASSIGN   4904<<ASSIGN
QQ_CMDBLK.S$
       584**DCL      4870>>ASSIGN   4889>>IF       4889>>IF
QQ_GLOBAL.DS1$_BITS
       595**DCL       595--REDEF
QQ_GLOBAL.DS2$_BITS
       595**DCL       596--REDEF
QQ_GLOBAL.DS3$_BITS
       596**DCL       596--REDEF
PL6.E3A0      #001=QQC$EX_SPEC File=QQC$EX_SPEC.:E05TSI                          WED 07/30/97 05:40 Page:30   
QQ_GLOBAL.DS4$_BITS
       596**DCL       597--REDEF
S$
      4520**DCL      4522--IMP-PTR
STATION$
      4675**DCL      4877<<ASSIGN   4879>>CALLBLT  4879>>CALLBLT  4882>>IF       4889>>IF       4889>>IF
      4896>>ASSIGN   4896>>ASSIGN
SUBLK$
      4676**DCL      4873<<ASSIGN   4874>>DOCASE   4877>>ASSIGN   4899>>ASSIGN   4912>>ASSIGN
TP$STATION.FLAGS.PRIV
      4550**DCL      4889>>IF
TP$STATION.ID
      4523**DCL      4870>>ASSIGN   4889>>IF
TRANID$
      4678**DCL      4912<<ASSIGN   4916>>CALLBLT  4916>>CALLBLT  4919>>IF       4922>>CALLBLT  4922>>CALLBLT
TYPE$
      4677**DCL      4899<<ASSIGN   4900>>CALLBLT  4900>>CALLBLT  4902>>IF       4909>>ASSIGN   4909>>ASSIGN
VLP_CGMA_C
      4618**DCL      4867>>ASSIGN
VLP_CGMA_C.MSGIDXT
      4627**DCL      4630--REDEF
VLP_SCGMA_C
      4644**DCL      4868>>ASSIGN
WILD_FLAG
      4684**DCL      4878<<ASSIGN   4880<<ASSIGN
