VERSION E05

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:1    
        1        1        /*M*  DDK$PUTVAL - evaluates encoded address and stores a value */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        DDK$PUTVAL: PROC(VAL$, ITEM, SVALUE, DSIZE, RSIZE, INDXX,
       10       10               PNTR, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
       11       11               TRUNC_FLAG, EIS) ALTRET;
       12       12          /* Parms */
       13       13    1   DCL VAL$ PTR;                           /* Ptr for return value */
       14       14    1   DCL SVALUE SBIN;                        /* Value if user defined symbol */
       15       15    1   DCL DSIZE SBIN;                         /* Size of data item to get */
       16       16    1   DCL RSIZE SBIN;                         /* Size of value to return */
       17       17    1   DCL INDXX SBIN;                         /* Bit offset if indexed */
       18       18    1   DCL PNTR SBIN;                          /* Encoded pointer if based */
       19       19    1   DCL EXPR_VAL SBIN;                      /* Word offset if EXPR_OP > 0 */
       20       20    1   DCL EXPR_OP SBIN;        /* Address expression modification operator or 0 */
       21       21    1   DCL ADDR_TYPE SBIN;                     /* ADDR_TYPE from ITEM */
       22       22    1   DCL ARRAY_FLAG BIT(1) UNAL;             /* Set if ITEM is indexed */
       23       23    1   DCL TRUNC_FLAG BIT(1) UNAL; /* Set if final address is to be truncated to word */
       24       24    1   DCL EIS UBIN;                      /* Indicates how to move data from VAL$ */
       25       25                                                /* EIS = 0 ( GETVAL only ) CSR used */
       26       26                                                /*       1  MLR_EIS  char strng put */
       27       27                                                /*       2  CSL_EIS  bit string put */
       28       28                                                /*       3  CSR_EIS  numeric put */
       29       29          /* Locals - these must be in this order for DDK$GETV_A */
       30       30    1   DCL OFFSET SBIN;
       31       31    1   DCL DESCX BIT(72) DALIGNED;
       32       32    1   DCL TEMP1 SBIN;
       33       33    1   DCL TEMP2 SBIN;
       34       34    1   DCL TRUNC BIT(1);
       35       35    1   DCL POINTER SBIN;
       36       36    1   DCL POINTER$ REDEF POINTER PTR;
       37       37    1   DCL 1 P REDEF POINTER,
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:2    
       38       38    1         2 TYPE UBIN(6) UNAL,
       39       39    1         2 ID UBIN(9) UNAL,
       40       40    1         2 DISP UBIN(9) UNAL,
       41       41    1         2 S UBIN(2) UNAL,
       42       42    1         2 * UBIN(10) UNAL;
       43       43    1   DCL SZ SBIN;
       44       44    1   DCL WHAT UBIN;
       45       45    1   DCL TAR UBIN;
       46       46    1   DCL WSQ# UBIN;
       47       47    1   DCL PTW1 UBIN;
       48       48    1   DCL PTW2 UBIN;
       49       49    1   DCL MAPSZ UBIN;
       50       50    1   DCL PT# UBIN;
       51       51    1   DCL ERRCODE UBIN;
       52       52    1   DCL RET UBIN;
       53       53          /* Locals - all other locals go here */
       54       54    1   DCL ADDRESS UBIN;
       55       55    1   DCL SEG UBIN;
       56       56    1   DCL DESC# UBIN;
       57       57    1   DCL NOT_IS BIT(1) ALIGNED;
       58       58    1   DCL 1 PNTR1,
       59       59    1         2 * BIT(26) UNAL,
       60       60    1         2 SEGID UBIN(10) UNAL;
       61       61    1   DCL TPTR$ PTR;
       62       62    1   DCL VBSTART UBIN;
       63       63    1   DCL 1 PR,
       64       64    1         2 W UBIN(18) UNAL,
       65       65    1         2 C UBIN(2) UNAL,
       66       66    1         2 B UBIN(4) UNAL,
       67       67    1         2 S UBIN(2) UNAL,
       68       68    1         2 SEGID UBIN(10) UNAL;
       69       69    1   DCL UDR2$ PTR SYMREF;
       70       70    1   DCL UIS$ PTR SYMREF;
       71       71    1   DCL STACKIC UBIN;
       72       72    1   DCL STACKOFF UBIN;
       73       73    1   DCL RSTACKOFF UBIN;
       74       74    1   DCL RETADDR UBIN;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:3    
       75       75    1   DCL STACK$ PTR;
       76       76    1   DCL TEDEF$ PTR;
       77       77          /* Constants */
       78       78        %INCLUDE DD_ERR_C;
       79      475    1   DCL ERRCODE#(0:24) UBIN(9) UNAL CONSTANT INIT(
       80      476    1         68,                       /* E@OUTOFSEG */
       81      477    1         69,                    /* E@BADDESCTYPE */
       82      478    1         70,                     /* E@SEGNOTPRES */
       83      479    1         71,                       /* E@SEGEMPTY */
       84      480    1         72,                   /* E@CANTWRITESEG */
       85      481    1         73,                    /* E@CANTREADSEG */
       86      482    1         74,                        /* E@BADPTDW */
       87      483    1         75,                       /* E@OUTOFMAP */
       88      484    1         76,                         /* E@NOPAGE */
       89      485    1         77,                        /* E@NOPAGE2 */
       90      486    1         78,                   /* E@ACCESS_FAULT */
       91      487    1         502,                         /* E@DELBUG */
       92      488    1         38,                   /* E@USE_CONFLICT */
       93      489    1         40,                   /* E@ADDREXPG256K  */
       94      490    1         36,                        /* E@ADDRBAD */
       95      491    1         103,                  /* E@PACCESS_FAULT  */
       96      492    1         104,                         /* E@BADPTR */
       97      493    1         60,                       /* E@SEGIDERR */
       98      494    1         113,                      /* E@UDONLYSYM */
       99      495    1          111,                     /* E@XDONLYSYM */
      100      496    1          168,                        /* E@BADDEC */
      101      497    1          181,                         /* E@NOSAD */
      102      498    1          274,                    /* E@SYMNOTANLZ */
      103      499    1          325,                    /* E@CHARCALIGN */
      104      500    1          343);                    /* E@NOT_DPS90 */
      105      501          /* Misc */
      106      502    1   DCL VALUE SBIN BASED(VAL$) UNAL;
      107      503    1   DCL TEXTR CHAR(SZ) BASED;
      108      504    1   DCL CHAR4 CHAR(4) BASED;
      109      505    1   DCL UBIN36 UBIN(36) BASED;
      110      506    1   DCL BIT72 BIT(72) BASED DALIGNED;
      111      507    1   DCL BIT36 BIT(36) BASED ALIGNED;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:4    
      112      508    1   DCL 1 W BASED ALIGNED,
      113      509    1         2 LEFT UBIN HALF UNAL,
      114      510    1         2 RIGHT UBIN HALF UNAL;
      115      511    1   DCL RBIT BIT(RSIZE) BASED UNAL;
      116      512             %INCLUDE DD$DITEM;
       12+     615             %LIST;
       13+     616    1        DCL SDD$ PTR;
       14+     617    1        DCL ZITEM$ PTR;
       15+     618    1        DCL SDD_L6$ PTR;
       16+     619    1        DCL ZITEM_L6$ PTR;
      117     1193            %DITEM (NAME=ITEM, STCLASS=PARAM);
      118     1273             %INCLUDE B$OBJECT_C;
      119     4703             %B$EDEF;
      120     4773             %INCLUDE DD_DESC_R;
      121     4823             %INCLUDE XUH_MACRO_C;
      122     4907             %INCLUDE DD_SD_M;
      123     6243             %S_D;
      124     7561        %INCLUDE DD$BASED;
      125     8864        %LS (STCLASS=AUTO);
      126     8875        %INCLUDE IR_DATA_M;
      127     9039        %INCLUDE NI$TABLES;
      128     9255        %INCLUDE DD$DA;
      129     9336        %INCLUDE DD_DEBUG_C;
      130     9357        %RV_BUFF (NAME=RV_BUFF, STCLASS=BASED);
      131     9393        %RV_USRDIR (NAME=RV_USRDIR, STCLASS=BASED);
      132     9397          /* External routines */
      133     9398    1   DCL DDK$GETISR ENTRY(1);
      134     9399    1   DCL DDK$SEXTEND ENTRY(2);
      135     9400    1   DCL DDK$ADDEXPR ENTRY(3);
      136     9401    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      137     9402    1   DCL DDK$GETV_A ENTRY ALTRET;
      138     9403    1   DCL DDE$ERROR ENTRY;
      139     9404    1   DCL DDF$FIND_PEDEF ENTRY(2) ALTRET;
      140     9405    1   DCL DUL$GETVP2 ENTRY(3) ALTRET;
      141     9406                                                /**/
      142     9407    1        IF S_D.PROTECT
      143     9408    2        THEN DO;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:5    
      144     9409    2             S_D.ERROR = 185;        /* E@PROTECT */
      145     9410    2             ALTRETURN;
      146     9411    2           END;
      147     9412    1        WHAT = EIS;
      148     9413    1        GOTO ENTRANCE;
      149     9414                                                /**/
      150     9415    1   DDK$GETVAL: ENTRY(VAL$, ITEM, SVALUE, DSIZE, RSIZE, INDXX,
      151     9416    1          PNTR, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      152     9417    1          TRUNC_FLAG, EIS) ALTRET;
      153     9418                                                /**/
      154     9419    1        IF ADDR(EIS) = ADDR(NIL)
      155     9420    1        THEN WHAT = 0;                     /* Perform CSR get function */
      156     9421    1        ELSE WHAT = EIS;                   /* OR MVN (U,L,T) */
      157     9422                                                /**/
      158     9423    1   ENTRANCE:
      159     9424                                                /**/
      160     9425    1        TRUNC = TRUNC_FLAG;                /* Isolate ...           */
      161     9426    1        POINTER = PNTR;                    /*   ... Parms from args */
      162     9427                                                /**/
      163     9428    2        DO CASE( ADDR_TYPE );
      164     9429                                                /*
      165     9430        CONST_ACODE
      166     9431                                                */
      167     9432    2          CASE( %CONST_ACODE );
      168     9433    2             VALUE = ITEM.VALUE;
      169     9434    2             RETURN;
      170     9435                                                /*
      171     9436        SPEC_ACODE  (DON'T KNOW WHY WE'RE HERE )
      172     9437                                                */
      173     9438    2          CASE( %SPEC_ACODE );
      174     9439    2             S_D.ERROR = 502;         /* E@DELBUG */
      175     9440    2             CALL DDE$ERROR;
      176     9441    2             ALTRETURN;
      177     9442                                                /*
      178     9443        BIGBASED_ACODE, BIGSTATIC_ACODE
      179     9444                                                */
      180     9445    2          CASE( %BIGBASED_ACODE, %BIGSTATIC_ACODE);
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:6    
      181     9446    2             OFFSET = ITEM.VALUE * 36;
      182     9447    2             GOTO BASED_STATIC;
      183     9448                                                /*
      184     9449        VIRT_ACODE
      185     9450                                                */
      186     9451    2          CASE( %VIRT_ACODE );
      187     9452    2             ADDRESS = ITEM.ADDRESS.W;
      188     9453    2             SEG = 3;
      189     9454    2             DESC# = 0;
      190     9455    2             NOT_IS = '0'B;
      191     9456                                                /* Go get offset */
      192     9457    2             CALL DDK$GETMVAL(OFFSET, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(TRAP_VIRTUAL)
              9457                      ;
      193     9458    2             OFFSET = OFFSET * 36;
      194     9459    2             IF ARRAY_FLAG
      195     9460    2             THEN OFFSET = OFFSET + INDXX;
      196     9461    2             ADDRESS = ADDRESS + 1;
      197     9462                                                /* Go get descriptor */
      198     9463    2             CALL DDK$GETMVAL(PNTR1, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(TRAP_VIRTUAL);
      199     9464    2             POINTER = BITBIN(DESC.ITEM(%LS_DESC) &
      200     9465    2               '777777770000'O | '000000002000'O);
      201     9466    2             P.ID = 3;                     /* $LS */
      202     9467    2             P.DISP = PNTR1.SEGID * 2;     /* DESC# */
      203     9468    2             GOTO BASED_STATIC;
      204     9469                                                /*
      205     9470        BASED_ACODE, STATIC_ACODE, AUTO_ACODE, PARM_ACODE, SPARM_ACODE DCB_ACODE
      206     9471                                                */
      207     9472    2          CASE( %BASED_ACODE, %STATIC_ACODE, %AUTO_ACODE, %PARM_ACODE, %SPARM_ACODE, %
              9472                   DCB_ACODE );
      208     9473    2             OFFSET = ITEM.ADDRESS.W * 36 + ITEM.ADDRESS.C * 9 + ITEM.ADDRESS.B;
      209     9474    2             IF ARRAY_FLAG
      210     9475    2             THEN OFFSET = OFFSET + INDXX;
      211     9476    2   BASED_STATIC:
      212     9477    2             IF EXPR_OP > 0
      213     9478    3             THEN DO;
      214     9479    3                  TRUNC = '1'B;
      215     9480    3                  OFFSET = OFFSET / 36;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:7    
      216     9481    3                  CALL DDK$ADDEXPR(OFFSET, EXPR_VAL, EXPR_OP);
      217     9482    3                  OFFSET = OFFSET * 36;
      218     9483    3                END;
      219     9484    3             DO CASE( ADDR_TYPE );
      220     9485    3               CASE( %STATIC_ACODE, %BIGSTATIC_ACODE , %SPARM_ACODE );
      221     9486                                      /* STATIC_ACODE, BIGSTATIC_ACODE, SPARM_ACODE */
      222     9487    3                  IF S_D.ANLZ_FILE THEN POINTER = BITBIN('000000006000'O);
      223     9488    3                  ELSE CALL DDK$GETISR(POINTER);
      224     9489    3               CASE( %BASED_ACODE, %BIGBASED_ACODE, %DCB_ACODE, %VIRT_ACODE );
      225     9490                            /* BASED_ACODE, BIGBASED_ACODE, DCB_ACODE, VIRT_ACODE */
      226     9491                                                /* Do nothing (use pointer as given) */
      227     9492    3               CASE( %AUTO_ACODE );
      228     9493    3                  IF S_D.RUM
      229     9494    3                    OR S_D.ANLZ
      230     9495    4                  THEN DO;
      231     9496    4                       S_D.ERROR = 214; /* CANTAUTOMODE */
      232     9497    4                       ALTRETURN;
      233     9498    4                     END;
      234     9499    3                  POINTER = BITBIN(DESC.ITEM(%AUTO_DESC) &
      235     9500    3                    '777777770000'O | '000000002000'O);
      236     9501    3                  GOTO FINDSTACK;
      237     9502    3               CASE( %PARM_ACODE );
      238     9503    3   FINDSTACK:     ;
      239     9504        %IF '0'B;
      273     9538        %ENDIF;
      274     9539    3   GOTSTACK:      ;
      275     9540    3                  S_D.ACCESS = '0'B;
      276     9541    3                  S_D.ASTACKOFF = STACKOFF;
      277     9542    3               END;                        /* DO CASE( ADDR_TYPE ) */
      278     9543    2             IF S_D.RUM AND NOT S_D.DEBUGA (%DB@DOCMD)
      279     9544    3             THEN DO;
      280     9545    3                  S_D.ERROR = 211; /* E@EXP_MODE_ERR */
      281     9546    3                  ALTRETURN;
      282     9547    3                END;
      283     9548    2             ELSE IF S_D.ANLZ_FILE THEN GOTO ANLZ_PART;
      284     9549    2             CALL DDK$GETV_A ALTRET(ARET); /* Go to BMAP code */
      285     9550    2             RETURN;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:8    
      286     9551                                                /*
      287     9552        DESC_ACODE
      288     9553                                                */
      289     9554    2          CASE( %DESC_ACODE );
      290     9555    2             VALUE = BITBIN(ITEM.VALUEB & '777777770000'O | '000000002000'O);
      291     9556    2             RETURN;
      292     9557                                                /**/
      293     9558    2          CASE(ELSE);
      294     9559    2             S_D.ERROR = 502;         /* E@DELBUG */
      295     9560    2             CALL DDE$ERROR;
      296     9561    2             ALTRETURN;
      297     9562    2   ARET:
      298     9563    2             S_D.ERROR = ERRCODE#(ERRCODE);
      299     9564    2             ALTRETURN;
      300     9565                                                /**/
      301     9566    2          END;                             /* DO CASE( ADDR_TYPE ) */
      302     9567    1   ANLZ_PART:
      303     9568    1        IF P.S = 1                         /* ENCODED SYMBOL */
      304     9569    2        THEN DO;
      305     9570    3             DO CASE(P.TYPE);
      306     9571    3               CASE(0);
      307     9572    4                  DO CASE(P.ID);
      308     9573    4                    CASE(0);               /* SSR */
      309     9574    4                       IF OFFSET/36 > 63 THEN GOTO OUTOFSEG;
      310     9575    4                       VAL$->RBIT = PINCRB(S_D.USS$, OFFSET)->RBIT;
      311     9576    4                    CASE(1);               /* JIT */
      312     9577    4                       LS = PINCRW(DA.CURLS$, 1*2)->BIT72;
      313     9578    4                       GOTO LS_ENTRY;
      314     9579    4                    CASE(2);               /* HJIT */
      315     9580    4                       IF OFFSET/36 > 1024 THEN GOTO OUTOFSEG;
      316     9581    4                       CALL DUL$GETVP2(2, 2, TPTR$) ALTRET(ERROR_RETURN);
      317     9582    4                       VAL$->RBIT = PINCRB(TPTR$, OFFSET)->RBIT;
      318     9583    4                    CASE(4,7,8);           /* SAD ERR HEAD */
      319     9584    4                       S_D.ERROR = 34; /*E@NOTYET*/
      320     9585    4                       GOTO ERROR_RETURN;
      321     9586    4                    CASE(3);               /* TCB */
      322     9587    4                       LS = PINCRW(DA.CURLS$, 15*2)->BIT72;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:9    
      323     9588    4                       GOTO LS_ENTRY;
      324     9589    4                    CASE(5);               /* RVB */
      325     9590    4                       IF OFFSET/36 > SIZEW(RV_BUFF)-1 THEN GOTO OUTOFSEG;
      326     9591    4                       VAL$->RBIT = PINCRB(DA.RVBUFF$, OFFSET)->RBIT;
      327     9592    4                    CASE(6);               /* USD */
      328     9593    4                       IF OFFSET/36 > SIZEW(RV_USRDIR)-1 THEN GOTO OUTOFSEG;
      329     9594    4                       VAL$->RBIT = PINCRB(DA.USRDIR$, OFFSET)->RBIT;
      330     9595    4                    CASE(9);               /* $CGn */
      331     9596    4                       IF OFFSET/36 > 255*1024 THEN GOTO OUTOFSEG;
      332     9597    4                       CALL DUL$GETVP2(OFFSET/36/1024, (OFFSET+RSIZE)/36/1024, TPTR$)
              9597                                ALTRET(ERROR_RETURN);
      333     9598    4                       VAL$->RBIT = PINCRB(TPTR$, OFFSET)->RBIT;
      334     9599    4                    CASE(ELSE);
      335     9600    4                       S_D.ERROR = 502; /*E@DELBUG*/
      336     9601    4                       CALL DDE$ERROR;
      337     9602    4                       GOTO ERROR_RETURN;
      338     9603    4                    END;                   /* CASE ID*/
      339     9604    3               CASE(1,5,6,7);
      340     9605    3                  S_D.ERROR = 34;    /*E@NOTYET*/
      341     9606    3                  GOTO ERROR_RETURN;
      342     9607    3               CASE(2);
      343     9608    3                  IF P.ID > 0
      344     9609    4                  THEN DO;
      345     9610    4                       PR = PINCRW(S_D.USS$, P.ID)->BIT36;
      346     9611    4                       OFFSET = OFFSET + PR.W*36 + PR.C*9 + PR.B;
      347     9612    4                     END;
      348     9613    3                  LS = PINCRW(S_D.USS$, P.DISP)->BIT72;
      349     9614    3   LS_ENTRY:
      350     9615    3                  IF NOT LS.FLG.EMPTY
      351     9616    3                  THEN GOTO OUTOFSEG;
      352     9617    3                  IF LS.TYP ~= 0
      353     9618    4                  THEN DO;
      354     9619    4                       S_D.ERROR = 503; /*E@NOTIMP*/
      355     9620    4                       GOTO ERROR_RETURN;
      356     9621    4                     END;
      357     9622    3                  IF LS.WSR = 0
      358     9623    4                  THEN DO;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:10   
      359     9624    4                       DA.CURPT$ = DA.MONPT$;
      360     9625    4                       DA.CURKEY = DA.MONKEY;
      361     9626    4                     END;
      362     9627    3                  ELSE IF LS.WSR = 7
      363     9628    4                       THEN DO;
      364     9629    4                            DA.CURPT$ = DA.UPT$;
      365     9630    4                            DA.CURKEY = DA.UKEY;
      366     9631    4                          END;
      367     9632    4                       ELSE DO;
      368     9633    4                            S_D.ERROR = 503; /*E@NOTIMP*/
      369     9634    4                            GOTO ERROR_RETURN;
      370     9635    4                          END;
      371     9636    3                  IF OFFSET/9 + RSIZE/9 > LS.BOUND + 1 THEN GOTO OUTOFSEG;
      372     9637    3                  IF MOD(LS.BASE, 4) ~= 0
      373     9638    4                  THEN DO;
      374     9639    4                       S_D.ERROR = 503; /*E@NOTIMP*/
      375     9640    4                       GOTO ERROR_RETURN;
      376     9641    4                     END;
      377     9642    3                  VBSTART = OFFSET + LS.BASE*9;
      378     9643    3                  CALL DUL$GETVP2(VBSTART/36/1024, (VBSTART+RSIZE)/36/1024, TPTR$)
              9643                           ALTRET(ERROR_RETURN);
      379     9644    3                  IF RSIZE ~= DSIZE
      380     9645    3                  THEN RSIZE = DSIZE;
      381     9646    3                  VAL$->RBIT = PINCRB(TPTR$, MOD(VBSTART, 1024*36))->RBIT;
      382     9647    3               CASE(3);
      383     9648    3                  IF P.ID ~= 3             /* $LSN */
      384     9649    4                  THEN DO;
      385     9650    4                       S_D.ERROR = 503; /*E@NOTIMP*/
      386     9651    4                       GOTO ERROR_RETURN;
      387     9652    4                     END;
      388     9653    3                  LS = PINCRW(DA.CURLS$, P.DISP)->BIT72;
      389     9654    3                  GOTO LS_ENTRY;
      390     9655    3               CASE(4);
      391     9656    3                  S_D.ERROR = 503;    /* E@NOTIMP */
      392     9657    3                  GOTO ERROR_RETURN;
      393     9658    3               CASE(8,9);                  /* $ROSEG, $RDBR, $TSA, $Bn */
      394     9659    3                  S_D.ERROR = 304; /* E@SYMNOTHOST */
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:11   
      395     9660    3                  GOTO ERROR_RETURN;
      396     9661    3               CASE(ELSE);
      397     9662    3                  S_D.ERROR = 502;    /* E@DELBUG */
      398     9663    3                  CALL DDE$ERROR;
      399     9664    3                  GOTO ERROR_RETURN;
      400     9665    3               END;                        /* CASE TYPE */
      401     9666    2           END;                            /* IF */
      402     9667    2        ELSE DO;                           /* USER POINTER */
      403     9668    2             PR = P;
      404     9669    2             IF PR.S ~=3
      405     9670    3             THEN DO;
      406     9671    3                  S_D.ERROR = 503;    /*E@NOTIMP*/
      407     9672    3                  GOTO ERROR_RETURN;
      408     9673    3                END;
      409     9674    2             OFFSET = OFFSET + PR.W*36 + PR.C*9 + PR.B;
      410     9675    2             LS = PINCRW(DA.CURLS$, 2*PR.SEGID)-> BIT72;
      411     9676    2             GOTO LS_ENTRY;
      412     9677    2           END;
      413     9678    1        RETURN;
      414     9679    1   TRAP_VIRTUAL: ;
      415     9680    1        S_D.ERROR = 264;        /* E@TRAP_VIRTUAL */
      416     9681    1        ALTRETURN;
      417     9682    1   OUTOFSEG:
      418     9683    1        S_D.ERROR = 68;            /*E@OUTOFSEG*/
      419     9684    1   ERROR_RETURN:
      420     9685    1        ALTRETURN;
      421     9686    1   END DDK$PUTVAL;

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:12   
--  Include file information  --

   DD_DEBUG_C.:E05TOU  is referenced.
   DD$DA.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$PUTVAL.

   Procedure DDK$PUTVAL requires 749 words for executable code.
   Procedure DDK$PUTVAL requires 60 words of local(AUTO) storage.

    No errors detected in file DDK$GETVAL.:E05TSI    .

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:13   

 Object Unit name= DDK$PUTVAL                                 File name= DDK$GETVAL.:E05TOU
 UTS= JUL 29 '97 14:03:01.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     10     12  DDK$PUTVAL
    1   Proc  even  none   749   1355  DDK$PUTVAL
    2  RoData even  none     6      6  DDK$PUTVAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std       13  DDK$PUTVAL
     1     14          yes     yes      Std       13  DDK$GETVAL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 DDE$ERROR
 yes     yes           Std       5 DDK$GETMVAL
         yes           Std       3 DDK$ADDEXPR
         yes           Std       1 DDK$GETISR
 yes     yes           Std       3 DUL$GETVP2
 yes     yes           Std       0 DDK$GETV_A
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:14   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DESC                             r    S_D$                                  DD_ANLZSEG$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:15   


        1        1        /*M*  DDK$PUTVAL - evaluates encoded address and stores a value */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        DDK$PUTVAL: PROC(VAL$, ITEM, SVALUE, DSIZE, RSIZE, INDXX,

      9  1 000000   000000 700200 xent  DDK$PUTVAL   TSX0  ! X66_AUTO_N
         1 000001   000074 000015                    ZERO    60,13

       10       10               PNTR, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
       11       11               TRUNC_FLAG, EIS) ALTRET;
       12       12          /* Parms */
       13       13    1   DCL VAL$ PTR;                           /* Ptr for return value */
       14       14    1   DCL SVALUE SBIN;                        /* Value if user defined symbol */
       15       15    1   DCL DSIZE SBIN;                         /* Size of data item to get */
       16       16    1   DCL RSIZE SBIN;                         /* Size of value to return */
       17       17    1   DCL INDXX SBIN;                         /* Bit offset if indexed */
       18       18    1   DCL PNTR SBIN;                          /* Encoded pointer if based */
       19       19    1   DCL EXPR_VAL SBIN;                      /* Word offset if EXPR_OP > 0 */
       20       20    1   DCL EXPR_OP SBIN;        /* Address expression modification operator or 0 */
       21       21    1   DCL ADDR_TYPE SBIN;                     /* ADDR_TYPE from ITEM */
       22       22    1   DCL ARRAY_FLAG BIT(1) UNAL;             /* Set if ITEM is indexed */
       23       23    1   DCL TRUNC_FLAG BIT(1) UNAL; /* Set if final address is to be truncated to word */
       24       24    1   DCL EIS UBIN;                      /* Indicates how to move data from VAL$ */
       25       25                                                /* EIS = 0 ( GETVAL only ) CSR used */
       26       26                                                /*       1  MLR_EIS  char strng put */
       27       27                                                /*       2  CSL_EIS  bit string put */
       28       28                                                /*       3  CSR_EIS  numeric put */
       29       29          /* Locals - these must be in this order for DDK$GETV_A */
       30       30    1   DCL OFFSET SBIN;
       31       31    1   DCL DESCX BIT(72) DALIGNED;
       32       32    1   DCL TEMP1 SBIN;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:16   
       33       33    1   DCL TEMP2 SBIN;
       34       34    1   DCL TRUNC BIT(1);
       35       35    1   DCL POINTER SBIN;
       36       36    1   DCL POINTER$ REDEF POINTER PTR;
       37       37    1   DCL 1 P REDEF POINTER,
       38       38    1         2 TYPE UBIN(6) UNAL,
       39       39    1         2 ID UBIN(9) UNAL,
       40       40    1         2 DISP UBIN(9) UNAL,
       41       41    1         2 S UBIN(2) UNAL,
       42       42    1         2 * UBIN(10) UNAL;
       43       43    1   DCL SZ SBIN;
       44       44    1   DCL WHAT UBIN;
       45       45    1   DCL TAR UBIN;
       46       46    1   DCL WSQ# UBIN;
       47       47    1   DCL PTW1 UBIN;
       48       48    1   DCL PTW2 UBIN;
       49       49    1   DCL MAPSZ UBIN;
       50       50    1   DCL PT# UBIN;
       51       51    1   DCL ERRCODE UBIN;
       52       52    1   DCL RET UBIN;
       53       53          /* Locals - all other locals go here */
       54       54    1   DCL ADDRESS UBIN;
       55       55    1   DCL SEG UBIN;
       56       56    1   DCL DESC# UBIN;
       57       57    1   DCL NOT_IS BIT(1) ALIGNED;
       58       58    1   DCL 1 PNTR1,
       59       59    1         2 * BIT(26) UNAL,
       60       60    1         2 SEGID UBIN(10) UNAL;
       61       61    1   DCL TPTR$ PTR;
       62       62    1   DCL VBSTART UBIN;
       63       63    1   DCL 1 PR,
       64       64    1         2 W UBIN(18) UNAL,
       65       65    1         2 C UBIN(2) UNAL,
       66       66    1         2 B UBIN(4) UNAL,
       67       67    1         2 S UBIN(2) UNAL,
       68       68    1         2 SEGID UBIN(10) UNAL;
       69       69    1   DCL UDR2$ PTR SYMREF;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:17   
       70       70    1   DCL UIS$ PTR SYMREF;
       71       71    1   DCL STACKIC UBIN;
       72       72    1   DCL STACKOFF UBIN;
       73       73    1   DCL RSTACKOFF UBIN;
       74       74    1   DCL RETADDR UBIN;
       75       75    1   DCL STACK$ PTR;
       76       76    1   DCL TEDEF$ PTR;
       77       77          /* Constants */
       78       78        %INCLUDE DD_ERR_C;
       79      475    1   DCL ERRCODE#(0:24) UBIN(9) UNAL CONSTANT INIT(
       80      476    1         68,                       /* E@OUTOFSEG */
       81      477    1         69,                    /* E@BADDESCTYPE */
       82      478    1         70,                     /* E@SEGNOTPRES */
       83      479    1         71,                       /* E@SEGEMPTY */
       84      480    1         72,                   /* E@CANTWRITESEG */
       85      481    1         73,                    /* E@CANTREADSEG */
       86      482    1         74,                        /* E@BADPTDW */
       87      483    1         75,                       /* E@OUTOFMAP */
       88      484    1         76,                         /* E@NOPAGE */
       89      485    1         77,                        /* E@NOPAGE2 */
       90      486    1         78,                   /* E@ACCESS_FAULT */
       91      487    1         502,                         /* E@DELBUG */
       92      488    1         38,                   /* E@USE_CONFLICT */
       93      489    1         40,                   /* E@ADDREXPG256K  */
       94      490    1         36,                        /* E@ADDRBAD */
       95      491    1         103,                  /* E@PACCESS_FAULT  */
       96      492    1         104,                         /* E@BADPTR */
       97      493    1         60,                       /* E@SEGIDERR */
       98      494    1         113,                      /* E@UDONLYSYM */
       99      495    1          111,                     /* E@XDONLYSYM */
      100      496    1          168,                        /* E@BADDEC */
      101      497    1          181,                         /* E@NOSAD */
      102      498    1          274,                    /* E@SYMNOTANLZ */
      103      499    1          325,                    /* E@CHARCALIGN */
      104      500    1          343);                    /* E@NOT_DPS90 */
      105      501          /* Misc */
      106      502    1   DCL VALUE SBIN BASED(VAL$) UNAL;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:18   
      107      503    1   DCL TEXTR CHAR(SZ) BASED;
      108      504    1   DCL CHAR4 CHAR(4) BASED;
      109      505    1   DCL UBIN36 UBIN(36) BASED;
      110      506    1   DCL BIT72 BIT(72) BASED DALIGNED;
      111      507    1   DCL BIT36 BIT(36) BASED ALIGNED;
      112      508    1   DCL 1 W BASED ALIGNED,
      113      509    1         2 LEFT UBIN HALF UNAL,
      114      510    1         2 RIGHT UBIN HALF UNAL;
      115      511    1   DCL RBIT BIT(RSIZE) BASED UNAL;
      116      512             %INCLUDE DD$DITEM;
       12+     615             %LIST;
       13+     616    1        DCL SDD$ PTR;
       14+     617    1        DCL ZITEM$ PTR;
       15+     618    1        DCL SDD_L6$ PTR;
       16+     619    1        DCL ZITEM_L6$ PTR;
      117     1193            %DITEM (NAME=ITEM, STCLASS=PARAM);
      118     1273             %INCLUDE B$OBJECT_C;
      119     4703             %B$EDEF;
      120     4773             %INCLUDE DD_DESC_R;
      121     4823             %INCLUDE XUH_MACRO_C;
      122     4907             %INCLUDE DD_SD_M;
      123     6243             %S_D;
      124     7561        %INCLUDE DD$BASED;
      125     8864        %LS (STCLASS=AUTO);
      126     8875        %INCLUDE IR_DATA_M;
      127     9039        %INCLUDE NI$TABLES;
      128     9255        %INCLUDE DD$DA;
      129     9336        %INCLUDE DD_DEBUG_C;
      130     9357        %RV_BUFF (NAME=RV_BUFF, STCLASS=BASED);
      131     9393        %RV_USRDIR (NAME=RV_USRDIR, STCLASS=BASED);
      132     9397          /* External routines */
      133     9398    1   DCL DDK$GETISR ENTRY(1);
      134     9399    1   DCL DDK$SEXTEND ENTRY(2);
      135     9400    1   DCL DDK$ADDEXPR ENTRY(3);
      136     9401    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      137     9402    1   DCL DDK$GETV_A ENTRY ALTRET;
      138     9403    1   DCL DDE$ERROR ENTRY;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:19   
      139     9404    1   DCL DDF$FIND_PEDEF ENTRY(2) ALTRET;
      140     9405    1   DCL DUL$GETVP2 ENTRY(3) ALTRET;
      141     9406                                                /**/
      142     9407    1        IF S_D.PROTECT

   9407  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   005254 234100                    SZN     2732,,PR0
         1 000004   000010 605000 1                  TPL     s:9412

      143     9408    2        THEN DO;

      144     9409    2             S_D.ERROR = 185;        /* E@PROTECT */

   9409  1 000005   000271 235007                    LDA     185,DL
         1 000006   000013 755100                    STA     11,,PR0

      145     9410    2             ALTRETURN;

   9410  1 000007   000000 702200 xent               TSX2  ! X66_AALT

      146     9411    2           END;
      147     9412    1        WHAT = EIS;

   9412  1 000010   200017 471500                    LDP1    @EIS,,AUTO
         1 000011   100000 235100                    LDA     0,,PR1
         1 000012   200031 755100                    STA     WHAT,,AUTO

      148     9413    1        GOTO ENTRANCE;

   9413  1 000013   000026 710000 1                  TRA     ENTRANCE

      149     9414                                                /**/
      150     9415    1   DDK$GETVAL: ENTRY(VAL$, ITEM, SVALUE, DSIZE, RSIZE, INDXX,

   9415  1 000014   000000 700200 xent  DDK$GETVAL   TSX0  ! X66_AUTO_N
         1 000015   000074 000015                    ZERO    60,13

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:20   
      151     9416    1          PNTR, EXPR_VAL, EXPR_OP, ADDR_TYPE, ARRAY_FLAG,
      152     9417    1          TRUNC_FLAG, EIS) ALTRET;
      153     9418                                                /**/
      154     9419    1        IF ADDR(EIS) = ADDR(NIL)

   9419  1 000016   200017 236100                    LDQ     @EIS,,AUTO
         1 000017   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000020   000023 601000 1                  TNZ     s:9421

      155     9420    1        THEN WHAT = 0;                     /* Perform CSR get function */

   9420  1 000021   200031 450100                    STZ     WHAT,,AUTO
         1 000022   000026 710000 1                  TRA     ENTRANCE

      156     9421    1        ELSE WHAT = EIS;                   /* OR MVN (U,L,T) */

   9421  1 000023   200017 470500                    LDP0    @EIS,,AUTO
         1 000024   000000 235100                    LDA     0,,PR0
         1 000025   200031 755100                    STA     WHAT,,AUTO

      157     9422                                                /**/
      158     9423    1   ENTRANCE:
      159     9424                                                /**/
      160     9425    1        TRUNC = TRUNC_FLAG;                /* Isolate ...           */

   9425  1 000026   200016 470500       ENTRANCE     LDP0    @TRUNC_FLAG,,AUTO
         1 000027   003100 060500                    CSL     bolr='003'O
         1 000030   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 000031   200026 000001                    BDSC    TRUNC,,AUTO              by=0,bit=0,n=1

      161     9426    1        POINTER = PNTR;                    /*   ... Parms from args */

   9426  1 000032   200011 471500                    LDP1    @PNTR,,AUTO
         1 000033   100000 235100                    LDA     0,,PR1
         1 000034   200027 755100                    STA     POINTER,,AUTO

      162     9427                                                /**/
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:21   
      163     9428    2        DO CASE( ADDR_TYPE );

   9428  1 000035   200014 473500                    LDP3    @ADDR_TYPE,,AUTO
         1 000036   300000 235100                    LDA     0,,PR3
         1 000037   000105 115007                    CMPA    69,DL
         1 000040   000042 602005 1                  TNC     s:9428+5,AL
         1 000041   000554 710000 1                  TRA     s:9559
         1 000042   000274 710000 1                  TRA     s:9473
         1 000043   000274 710000 1                  TRA     s:9473
         1 000044   000274 710000 1                  TRA     s:9473
         1 000045   000274 710000 1                  TRA     s:9473
         1 000046   000274 710000 1                  TRA     s:9473
         1 000047   000554 710000 1                  TRA     s:9559
         1 000050   000274 710000 1                  TRA     s:9473
         1 000051   000554 710000 1                  TRA     s:9559
         1 000052   000172 710000 1                  TRA     s:9452
         1 000053   000554 710000 1                  TRA     s:9559
         1 000054   000554 710000 1                  TRA     s:9559
         1 000055   000554 710000 1                  TRA     s:9559
         1 000056   000554 710000 1                  TRA     s:9559
         1 000057   000554 710000 1                  TRA     s:9559
         1 000060   000554 710000 1                  TRA     s:9559
         1 000061   000554 710000 1                  TRA     s:9559
         1 000062   000554 710000 1                  TRA     s:9559
         1 000063   000554 710000 1                  TRA     s:9559
         1 000064   000554 710000 1                  TRA     s:9559
         1 000065   000554 710000 1                  TRA     s:9559
         1 000066   000554 710000 1                  TRA     s:9559
         1 000067   000554 710000 1                  TRA     s:9559
         1 000070   000554 710000 1                  TRA     s:9559
         1 000071   000554 710000 1                  TRA     s:9559
         1 000072   000554 710000 1                  TRA     s:9559
         1 000073   000554 710000 1                  TRA     s:9559
         1 000074   000554 710000 1                  TRA     s:9559
         1 000075   000554 710000 1                  TRA     s:9559
         1 000076   000554 710000 1                  TRA     s:9559
         1 000077   000554 710000 1                  TRA     s:9559
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:22   
         1 000100   000554 710000 1                  TRA     s:9559
         1 000101   000554 710000 1                  TRA     s:9559
         1 000102   000554 710000 1                  TRA     s:9559
         1 000103   000554 710000 1                  TRA     s:9559
         1 000104   000554 710000 1                  TRA     s:9559
         1 000105   000554 710000 1                  TRA     s:9559
         1 000106   000554 710000 1                  TRA     s:9559
         1 000107   000554 710000 1                  TRA     s:9559
         1 000110   000554 710000 1                  TRA     s:9559
         1 000111   000554 710000 1                  TRA     s:9559
         1 000112   000554 710000 1                  TRA     s:9559
         1 000113   000554 710000 1                  TRA     s:9559
         1 000114   000554 710000 1                  TRA     s:9559
         1 000115   000554 710000 1                  TRA     s:9559
         1 000116   000554 710000 1                  TRA     s:9559
         1 000117   000554 710000 1                  TRA     s:9559
         1 000120   000554 710000 1                  TRA     s:9559
         1 000121   000554 710000 1                  TRA     s:9559
         1 000122   000554 710000 1                  TRA     s:9559
         1 000123   000554 710000 1                  TRA     s:9559
         1 000124   000554 710000 1                  TRA     s:9559
         1 000125   000554 710000 1                  TRA     s:9559
         1 000126   000554 710000 1                  TRA     s:9559
         1 000127   000554 710000 1                  TRA     s:9559
         1 000130   000554 710000 1                  TRA     s:9559
         1 000131   000554 710000 1                  TRA     s:9559
         1 000132   000554 710000 1                  TRA     s:9559
         1 000133   000554 710000 1                  TRA     s:9559
         1 000134   000554 710000 1                  TRA     s:9559
         1 000135   000554 710000 1                  TRA     s:9559
         1 000136   000554 710000 1                  TRA     s:9559
         1 000137   000554 710000 1                  TRA     s:9559
         1 000140   000554 710000 1                  TRA     s:9559
         1 000141   000554 710000 1                  TRA     s:9559
         1 000142   000541 710000 1                  TRA     s:9555
         1 000143   000156 710000 1                  TRA     s:9439
         1 000144   000147 710000 1                  TRA     s:9433
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:23   
         1 000145   000165 710000 1                  TRA     s:9446
         1 000146   000165 710000 1                  TRA     s:9446

      164     9429                                                /*
      165     9430        CONST_ACODE
      166     9431                                                */
      167     9432    2          CASE( %CONST_ACODE );

      168     9433    2             VALUE = ITEM.VALUE;

   9433  1 000147   200003 474500                    LDP4    @VAL$,,AUTO
         1 000150   400000 475500                    LDP5    0,,PR4
         1 000151   200004 476500                    LDP6    @ITEM,,AUTO
         1 000152   003100 060500                    CSL     bolr='003'O
         1 000153   600001 000044                    BDSC    1,,PR6                   by=0,bit=0,n=36
         1 000154   500000 000044                    BDSC    0,,PR5                   by=0,bit=0,n=36

      169     9434    2             RETURN;

   9434  1 000155   000000 702200 xent               TSX2  ! X66_ARET

      170     9435                                                /*
      171     9436        SPEC_ACODE  (DON'T KNOW WHY WE'RE HERE )
      172     9437                                                */
      173     9438    2          CASE( %SPEC_ACODE );

      174     9439    2             S_D.ERROR = 502;         /* E@DELBUG */

   9439  1 000156   000766 236007                    LDQ     502,DL
         1 000157   000000 474400 xsym               LDP4    S_D$
         1 000160   400013 756100                    STQ     11,,PR4

      175     9440    2             CALL DDE$ERROR;

   9440  1 000161   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000162   000000 701000 xent               TSX1    DDE$ERROR
         1 000163   000000 011000                    NOP     0
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:24   

      176     9441    2             ALTRETURN;

   9441  1 000164   000000 702200 xent               TSX2  ! X66_AALT

      177     9442                                                /*
      178     9443        BIGBASED_ACODE, BIGSTATIC_ACODE
      179     9444                                                */
      180     9445    2          CASE( %BIGBASED_ACODE, %BIGSTATIC_ACODE);

      181     9446    2             OFFSET = ITEM.VALUE * 36;

   9446  1 000165   200004 474500                    LDP4    @ITEM,,AUTO
         1 000166   400001 236100                    LDQ     1,,PR4
         1 000167   000044 402007                    MPY     36,DL
         1 000170   200020 756100                    STQ     OFFSET,,AUTO

      182     9447    2             GOTO BASED_STATIC;

   9447  1 000171   000325 710000 1                  TRA     BASED_STATIC

      183     9448                                                /*
      184     9449        VIRT_ACODE
      185     9450                                                */
      186     9451    2          CASE( %VIRT_ACODE );

      187     9452    2             ADDRESS = ITEM.ADDRESS.W;

   9452  1 000172   200004 474500                    LDP4    @ITEM,,AUTO
         1 000173   400001 236100                    LDQ     1,,PR4
         1 000174   000014 772000                    QRL     12
         1 000175   200042 756100                    STQ     ADDRESS,,AUTO

      188     9453    2             SEG = 3;

   9453  1 000176   000003 235007                    LDA     3,DL
         1 000177   200043 755100                    STA     SEG,,AUTO
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:25   

      189     9454    2             DESC# = 0;

   9454  1 000200   200044 450100                    STZ     DESC#,,AUTO

      190     9455    2             NOT_IS = '0'B;

   9455  1 000201   200045 450100                    STZ     NOT_IS,,AUTO

      191     9456                                                /* Go get offset */
      192     9457    2            CALL DDK$GETMVAL(OFFSET, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(TRAP_VIRTUAL)
              9457                      ;

   9457  1 000202   200045 635500                    EPPR5   NOT_IS,,AUTO
         1 000203   200072 455500                    STP5    LS+6,,AUTO
         1 000204   200044 636500                    EPPR6   DESC#,,AUTO
         1 000205   200071 456500                    STP6    LS+5,,AUTO
         1 000206   200043 637500                    EPPR7   SEG,,AUTO
         1 000207   200070 457500                    STP7    LS+4,,AUTO
         1 000210   200042 630500                    EPPR0   ADDRESS,,AUTO
         1 000211   200067 450500                    STP0    LS+3,,AUTO
         1 000212   200020 630500                    EPPR0   OFFSET,,AUTO
         1 000213   200066 450500                    STP0    LS+2,,AUTO
         1 000214   200066 630500                    EPPR0   LS+2,,AUTO
         1 000215   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000216   000000 701000 xent               TSX1    DDK$GETMVAL
         1 000217   001345 702000 1                  TSX2    TRAP_VIRTUAL

      193     9458    2             OFFSET = OFFSET * 36;

   9458  1 000220   200020 236100                    LDQ     OFFSET,,AUTO
         1 000221   000044 402007                    MPY     36,DL
         1 000222   200020 756100                    STQ     OFFSET,,AUTO

      194     9459    2             IF ARRAY_FLAG

   9459  1 000223   200015 470500                    LDP0    @ARRAY_FLAG,,AUTO
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:26   
         1 000224   000000 066500                    CMPB    filb='0'B
         1 000225   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         1 000226   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000227   000233 600000 1                  TZE     s:9461

      195     9460    2             THEN OFFSET = OFFSET + INDXX;

   9460  1 000230   200010 471500                    LDP1    @INDXX,,AUTO
         1 000231   100000 036100                    ADLQ    0,,PR1
         1 000232   200020 756100                    STQ     OFFSET,,AUTO

      196     9461    2             ADDRESS = ADDRESS + 1;

   9461  1 000233   200042 235100                    LDA     ADDRESS,,AUTO
         1 000234   000001 035007                    ADLA    1,DL
         1 000235   200042 755100                    STA     ADDRESS,,AUTO

      197     9462                                                /* Go get descriptor */
      198     9463    2            CALL DDK$GETMVAL(PNTR1, ADDRESS, SEG, DESC#, NOT_IS) ALTRET(TRAP_VIRTUAL);

   9463  1 000236   200045 631500                    EPPR1   NOT_IS,,AUTO
         1 000237   200072 451500                    STP1    LS+6,,AUTO
         1 000240   200044 633500                    EPPR3   DESC#,,AUTO
         1 000241   200071 453500                    STP3    LS+5,,AUTO
         1 000242   200043 634500                    EPPR4   SEG,,AUTO
         1 000243   200070 454500                    STP4    LS+4,,AUTO
         1 000244   200042 635500                    EPPR5   ADDRESS,,AUTO
         1 000245   200067 455500                    STP5    LS+3,,AUTO
         1 000246   200046 636500                    EPPR6   PNTR1,,AUTO
         1 000247   200066 456500                    STP6    LS+2,,AUTO
         1 000250   200066 630500                    EPPR0   LS+2,,AUTO
         1 000251   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000252   000000 701000 xent               TSX1    DDK$GETMVAL
         1 000253   001345 702000 1                  TSX2    TRAP_VIRTUAL

      199     9464    2             POINTER = BITBIN(DESC.ITEM(%LS_DESC) &

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:27   
   9464  1 000254   000053 236000 xsym               LDQ     DESC+43
         1 000255   000007 376000 0                  ANQ     ERRCODE#+7
         1 000256   000010 276000 0                  ORQ     ERRCODE#+8
         1 000257   200027 756100                    STQ     POINTER,,AUTO

      200     9465    2               '777777770000'O | '000000002000'O);
      201     9466    2             P.ID = 3;                     /* $LS */

   9466  1 000260   200027 236100                    LDQ     POINTER,,AUTO
         1 000261   000000 376000 2                  ANQ     0
         1 000262   000030 276003                    ORQ     24,DU
         1 000263   200027 756100                    STQ     POINTER,,AUTO

      202     9467    2             P.DISP = PNTR1.SEGID * 2;     /* DESC# */

   9467  1 000264   200046 236100                    LDQ     PNTR1,,AUTO
         1 000265   000001 736000                    QLS     1
         1 000266   003776 376007                    ANQ     2046,DL
         1 000267   000014 736000                    QLS     12
         1 000270   200027 676100                    ERQ     POINTER,,AUTO
         1 000271   000001 376000 2                  ANQ     1
         1 000272   200027 656100                    ERSQ    POINTER,,AUTO

      203     9468    2             GOTO BASED_STATIC;

   9468  1 000273   000325 710000 1                  TRA     BASED_STATIC

      204     9469                                                /*
      205     9470        BASED_ACODE, STATIC_ACODE, AUTO_ACODE, PARM_ACODE, SPARM_ACODE DCB_ACODE
      206     9471                                                */
      207     9472    2          CASE( %BASED_ACODE, %STATIC_ACODE, %AUTO_ACODE, %PARM_ACODE, %SPARM_ACODE, %
              9472                   DCB_ACODE );

      208     9473    2             OFFSET = ITEM.ADDRESS.W * 36 + ITEM.ADDRESS.C * 9 + ITEM.ADDRESS.B;

   9473  1 000274   200004 474500                    LDP4    @ITEM,,AUTO
         1 000275   400001 236100                    LDQ     1,,PR4
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:28   
         1 000276   000006 772000                    QRL     6
         1 000277   000077 376007                    ANQ     63,DL
         1 000300   200066 756100                    STQ     LS+2,,AUTO
         1 000301   400001 236100                    LDQ     1,,PR4
         1 000302   000012 772000                    QRL     10
         1 000303   000002 376000 2                  ANQ     2
         1 000304   200066 036100                    ADLQ    LS+2,,AUTO
         1 000305   200067 756100                    STQ     LS+3,,AUTO
         1 000306   400001 236100                    LDQ     1,,PR4
         1 000307   000077 376007                    ANQ     63,DL
         1 000310   200070 756100                    STQ     LS+4,,AUTO
         1 000311   200067 236100                    LDQ     LS+3,,AUTO
         1 000312   000011 402007                    MPY     9,DL
         1 000313   200070 036100                    ADLQ    LS+4,,AUTO
         1 000314   200020 756100                    STQ     OFFSET,,AUTO

      209     9474    2             IF ARRAY_FLAG

   9474  1 000315   200015 475500                    LDP5    @ARRAY_FLAG,,AUTO
         1 000316   000000 066500                    CMPB    filb='0'B
         1 000317   500000 000001                    BDSC    0,,PR5                   by=0,bit=0,n=1
         1 000320   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000321   000325 600000 1                  TZE     BASED_STATIC

      210     9475    2             THEN OFFSET = OFFSET + INDXX;

   9475  1 000322   200010 476500                    LDP6    @INDXX,,AUTO
         1 000323   600000 036100                    ADLQ    0,,PR6
         1 000324   200020 756100                    STQ     OFFSET,,AUTO

      211     9476    2   BASED_STATIC:
      212     9477    2             IF EXPR_OP > 0

   9477  1 000325   200013 470500       BASED_STATIC LDP0    @EXPR_OP,,AUTO
         1 000326   000000 235100                    LDA     0,,PR0
         1 000327   000352 604400 1                  TMOZ    s:9484

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:29   
      213     9478    3             THEN DO;

      214     9479    3                  TRUNC = '1'B;

   9479  1 000330   400000 236003                    LDQ     -131072,DU
         1 000331   200026 756100                    STQ     TRUNC,,AUTO

      215     9480    3                  OFFSET = OFFSET / 36;

   9480  1 000332   200020 236100                    LDQ     OFFSET,,AUTO
         1 000333   000044 506007                    DIV     36,DL
         1 000334   200020 756100                    STQ     OFFSET,,AUTO

      216     9481    3                  CALL DDK$ADDEXPR(OFFSET, EXPR_VAL, EXPR_OP);

   9481  1 000335   200013 236100                    LDQ     @EXPR_OP,,AUTO
         1 000336   200070 756100                    STQ     LS+4,,AUTO
         1 000337   200012 236100                    LDQ     @EXPR_VAL,,AUTO
         1 000340   200067 756100                    STQ     LS+3,,AUTO
         1 000341   200020 631500                    EPPR1   OFFSET,,AUTO
         1 000342   200066 451500                    STP1    LS+2,,AUTO
         1 000343   200066 630500                    EPPR0   LS+2,,AUTO
         1 000344   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000345   000000 701000 xent               TSX1    DDK$ADDEXPR
         1 000346   000000 011000                    NOP     0

      217     9482    3                  OFFSET = OFFSET * 36;

   9482  1 000347   200020 236100                    LDQ     OFFSET,,AUTO
         1 000350   000044 402007                    MPY     36,DL
         1 000351   200020 756100                    STQ     OFFSET,,AUTO

      218     9483    3                END;

      219     9484    3             DO CASE( ADDR_TYPE );

   9484  1 000352   200014 470500                    LDP0    @ADDR_TYPE,,AUTO
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:30   
         1 000353   000000 235100                    LDA     0,,PR0
         1 000354   000105 115007                    CMPA    69,DL
         1 000355   000357 602005 1                  TNC     s:9484+5,AL
         1 000356   000522 710000 1                  TRA     s:9543
         1 000357   000464 710000 1                  TRA     s:9487
         1 000360   000501 710000 1                  TRA     s:9493
         1 000361   000522 710000 1                  TRA     s:9543
         1 000362   000522 710000 1                  TRA     s:9543
         1 000363   000516 710000 1                  TRA     FINDSTACK
         1 000364   000522 710000 1                  TRA     s:9543
         1 000365   000464 710000 1                  TRA     s:9487
         1 000366   000522 710000 1                  TRA     s:9543
         1 000367   000522 710000 1                  TRA     s:9543
         1 000370   000522 710000 1                  TRA     s:9543
         1 000371   000522 710000 1                  TRA     s:9543
         1 000372   000522 710000 1                  TRA     s:9543
         1 000373   000522 710000 1                  TRA     s:9543
         1 000374   000522 710000 1                  TRA     s:9543
         1 000375   000522 710000 1                  TRA     s:9543
         1 000376   000522 710000 1                  TRA     s:9543
         1 000377   000522 710000 1                  TRA     s:9543
         1 000400   000522 710000 1                  TRA     s:9543
         1 000401   000522 710000 1                  TRA     s:9543
         1 000402   000522 710000 1                  TRA     s:9543
         1 000403   000522 710000 1                  TRA     s:9543
         1 000404   000522 710000 1                  TRA     s:9543
         1 000405   000522 710000 1                  TRA     s:9543
         1 000406   000522 710000 1                  TRA     s:9543
         1 000407   000522 710000 1                  TRA     s:9543
         1 000410   000522 710000 1                  TRA     s:9543
         1 000411   000522 710000 1                  TRA     s:9543
         1 000412   000522 710000 1                  TRA     s:9543
         1 000413   000522 710000 1                  TRA     s:9543
         1 000414   000522 710000 1                  TRA     s:9543
         1 000415   000522 710000 1                  TRA     s:9543
         1 000416   000522 710000 1                  TRA     s:9543
         1 000417   000522 710000 1                  TRA     s:9543
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:31   
         1 000420   000522 710000 1                  TRA     s:9543
         1 000421   000522 710000 1                  TRA     s:9543
         1 000422   000522 710000 1                  TRA     s:9543
         1 000423   000522 710000 1                  TRA     s:9543
         1 000424   000522 710000 1                  TRA     s:9543
         1 000425   000522 710000 1                  TRA     s:9543
         1 000426   000522 710000 1                  TRA     s:9543
         1 000427   000522 710000 1                  TRA     s:9543
         1 000430   000522 710000 1                  TRA     s:9543
         1 000431   000522 710000 1                  TRA     s:9543
         1 000432   000522 710000 1                  TRA     s:9543
         1 000433   000522 710000 1                  TRA     s:9543
         1 000434   000522 710000 1                  TRA     s:9543
         1 000435   000522 710000 1                  TRA     s:9543
         1 000436   000522 710000 1                  TRA     s:9543
         1 000437   000522 710000 1                  TRA     s:9543
         1 000440   000522 710000 1                  TRA     s:9543
         1 000441   000522 710000 1                  TRA     s:9543
         1 000442   000522 710000 1                  TRA     s:9543
         1 000443   000522 710000 1                  TRA     s:9543
         1 000444   000522 710000 1                  TRA     s:9543
         1 000445   000522 710000 1                  TRA     s:9543
         1 000446   000522 710000 1                  TRA     s:9543
         1 000447   000522 710000 1                  TRA     s:9543
         1 000450   000522 710000 1                  TRA     s:9543
         1 000451   000522 710000 1                  TRA     s:9543
         1 000452   000522 710000 1                  TRA     s:9543
         1 000453   000522 710000 1                  TRA     s:9543
         1 000454   000522 710000 1                  TRA     s:9543
         1 000455   000522 710000 1                  TRA     s:9543
         1 000456   000522 710000 1                  TRA     s:9543
         1 000457   000522 710000 1                  TRA     s:9543
         1 000460   000522 710000 1                  TRA     s:9543
         1 000461   000522 710000 1                  TRA     s:9543
         1 000462   000522 710000 1                  TRA     s:9543
         1 000463   000464 710000 1                  TRA     s:9487

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:32   
      220     9485    3               CASE( %STATIC_ACODE, %BIGSTATIC_ACODE , %SPARM_ACODE );

      221     9486                                      /* STATIC_ACODE, BIGSTATIC_ACODE, SPARM_ACODE */
      222     9487    3                  IF S_D.ANLZ_FILE THEN POINTER = BITBIN('000000006000'O);

   9487  1 000464   000000 471400 xsym               LDP1    S_D$
         1 000465   105052 234100                    SZN     2602,,PR1
         1 000466   000472 605000 1                  TPL     s:9488

   9487  1 000467   000011 236000 0                  LDQ     ERRCODE#+9
         1 000470   200027 756100                    STQ     POINTER,,AUTO
         1 000471   000522 710000 1                  TRA     s:9543

      223     9488    3                  ELSE CALL DDK$GETISR(POINTER);

   9488  1 000472   200027 633500                    EPPR3   POINTER,,AUTO
         1 000473   200066 453500                    STP3    LS+2,,AUTO
         1 000474   200066 630500                    EPPR0   LS+2,,AUTO
         1 000475   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000476   000000 701000 xent               TSX1    DDK$GETISR
         1 000477   000000 011000                    NOP     0
         1 000500   000522 710000 1                  TRA     s:9543

      224     9489    3               CASE( %BASED_ACODE, %BIGBASED_ACODE, %DCB_ACODE, %VIRT_ACODE );

      225     9490                            /* BASED_ACODE, BIGBASED_ACODE, DCB_ACODE, VIRT_ACODE */
      226     9491                                                /* Do nothing (use pointer as given) */
      227     9492    3               CASE( %AUTO_ACODE );

      228     9493    3                  IF S_D.RUM

   9493  1 000501   000000 471400 xsym               LDP1    S_D$
         1 000502   104755 234100                    SZN     2541,,PR1
         1 000503   000506 604000 1                  TMI     s:9496
         1 000504   104756 234100                    SZN     2542,,PR1
         1 000505   000511 605000 1                  TPL     s:9499

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:33   
      229     9494    3                    OR S_D.ANLZ
      230     9495    4                  THEN DO;

      231     9496    4                       S_D.ERROR = 214; /* CANTAUTOMODE */

   9496  1 000506   000326 236007                    LDQ     214,DL
         1 000507   100013 756100                    STQ     11,,PR1

      232     9497    4                       ALTRETURN;

   9497  1 000510   000000 702200 xent               TSX2  ! X66_AALT

      233     9498    4                     END;
      234     9499    3                  POINTER = BITBIN(DESC.ITEM(%AUTO_DESC) &

   9499  1 000511   000017 236000 xsym               LDQ     DESC+15
         1 000512   000007 376000 0                  ANQ     ERRCODE#+7
         1 000513   000010 276000 0                  ORQ     ERRCODE#+8
         1 000514   200027 756100                    STQ     POINTER,,AUTO

      235     9500    3                    '777777770000'O | '000000002000'O);
      236     9501    3                  GOTO FINDSTACK;

   9501  1 000515   000516 710000 1                  TRA     FINDSTACK

      237     9502    3               CASE( %PARM_ACODE );

   9501  1 000516                       FINDSTACK    null
   9499  1 000516                       GOTSTACK     null
      238     9503    3   FINDSTACK:     ;
      239     9504        %IF '0'B;
      273     9538        %ENDIF;
      274     9539    3   GOTSTACK:      ;
      275     9540    3                  S_D.ACCESS = '0'B;

   9540  1 000516   000000 471400 xsym               LDP1    S_D$
         1 000517   100016 450100                    STZ     14,,PR1
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:34   

      276     9541    3                  S_D.ASTACKOFF = STACKOFF;

   9541  1 000520   200053 235100                    LDA     STACKOFF,,AUTO
         1 000521   104670 755100                    STA     2488,,PR1

      277     9542    3               END;                        /* DO CASE( ADDR_TYPE ) */

      278     9543    2             IF S_D.RUM AND NOT S_D.DEBUGA (%DB@DOCMD)

   9543  1 000522   000000 470400 xsym               LDP0    S_D$
         1 000523   004755 234100                    SZN     2541,,PR0
         1 000524   000533 605000 1                  TPL     s:9548
         1 000525   000053 236100                    LDQ     43,,PR0
         1 000526   004000 316007                    CANQ    2048,DL
         1 000527   000533 601000 1                  TNZ     s:9548

      279     9544    3             THEN DO;

      280     9545    3                  S_D.ERROR = 211; /* E@EXP_MODE_ERR */

   9545  1 000530   000323 235007                    LDA     211,DL
         1 000531   000013 755100                    STA     11,,PR0

      281     9546    3                  ALTRETURN;

   9546  1 000532   000000 702200 xent               TSX2  ! X66_AALT

      282     9547    3                END;
      283     9548    2             ELSE IF S_D.ANLZ_FILE THEN GOTO ANLZ_PART;

   9548  1 000533   005052 234100                    SZN     2602,,PR0
         1 000534   000571 604000 1                  TMI     ANLZ_PART

      284     9549    2             CALL DDK$GETV_A ALTRET(ARET); /* Go to BMAP code */

   9549  1 000535   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:35   
         1 000536   000000 701000 xent               TSX1    DDK$GETV_A
         1 000537   000563 702000 1                  TSX2    ARET

      285     9550    2             RETURN;

   9550  1 000540   000000 702200 xent               TSX2  ! X66_ARET

      286     9551                                                /*
      287     9552        DESC_ACODE
      288     9553                                                */
      289     9554    2          CASE( %DESC_ACODE );

      290     9555    2             VALUE = BITBIN(ITEM.VALUEB & '777777770000'O | '000000002000'O);

   9555  1 000541   200003 474500                    LDP4    @VAL$,,AUTO
         1 000542   400000 475500                    LDP5    0,,PR4
         1 000543   200004 476500                    LDP6    @ITEM,,AUTO
         1 000544   600001 236100                    LDQ     1,,PR6
         1 000545   000007 376000 0                  ANQ     ERRCODE#+7
         1 000546   000010 276000 0                  ORQ     ERRCODE#+8
         1 000547   200066 756100                    STQ     LS+2,,AUTO
         1 000550   003100 060500                    CSL     bolr='003'O
         1 000551   200066 000044                    BDSC    LS+2,,AUTO               by=0,bit=0,n=36
         1 000552   500000 000044                    BDSC    0,,PR5                   by=0,bit=0,n=36

      291     9556    2             RETURN;

   9556  1 000553   000000 702200 xent               TSX2  ! X66_ARET

      292     9557                                                /**/
      293     9558    2          CASE(ELSE);

      294     9559    2             S_D.ERROR = 502;         /* E@DELBUG */

   9559  1 000554   000766 236007                    LDQ     502,DL
         1 000555   000000 474400 xsym               LDP4    S_D$
         1 000556   400013 756100                    STQ     11,,PR4
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:36   

      295     9560    2             CALL DDE$ERROR;

   9560  1 000557   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000560   000000 701000 xent               TSX1    DDE$ERROR
         1 000561   000000 011000                    NOP     0

      296     9561    2             ALTRETURN;

   9561  1 000562   000000 702200 xent               TSX2  ! X66_AALT

      297     9562    2   ARET:
      298     9563    2             S_D.ERROR = ERRCODE#(ERRCODE);

   9563  1 000563   200040 235100       ARET         LDA     ERRCODE,,AUTO
         1 000564   000000 470400 xsym               LDP0    S_D$
         1 000565   000100 101405                    MRL     fill='000'O
         1 000566   000000 000001 0                  ADSC9   ERRCODE#,A               cn=0,n=1
         1 000567   000013 000004                    ADSC9   11,,PR0                  cn=0,n=4

      299     9564    2             ALTRETURN;

   9564  1 000570   000000 702200 xent               TSX2  ! X66_AALT

      300     9565                                                /**/
      301     9566    2          END;                             /* DO CASE( ADDR_TYPE ) */

      302     9567    1   ANLZ_PART:
      303     9568    1        IF P.S = 1                         /* ENCODED SYMBOL */

   9568  1 000571   200027 236100       ANLZ_PART    LDQ     POINTER,,AUTO
         1 000572   006000 376007                    ANQ     3072,DL
         1 000573   002000 116007                    CMPQ    1024,DL
         1 000574   001300 601000 1                  TNZ     s:9668

      304     9569    2        THEN DO;

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:37   
      305     9570    3             DO CASE(P.TYPE);

   9570  1 000575   200027 236100                    LDQ     POINTER,,AUTO
         1 000576   000036 772000                    QRL     30
         1 000577   000012 116007                    CMPQ    10,DL
         1 000600   000602 602006 1                  TNC     s:9570+5,QL
         1 000601   001272 710000 1                  TRA     s:9662
         1 000602   000614 710000 1                  TRA     s:9572
         1 000603   001037 710000 1                  TRA     s:9605
         1 000604   001042 710000 1                  TRA     s:9608
         1 000605   001243 710000 1                  TRA     s:9648
         1 000606   001264 710000 1                  TRA     s:9656
         1 000607   001037 710000 1                  TRA     s:9605
         1 000610   001037 710000 1                  TRA     s:9605
         1 000611   001037 710000 1                  TRA     s:9605
         1 000612   001267 710000 1                  TRA     s:9659
         1 000613   001267 710000 1                  TRA     s:9659

      306     9571    3               CASE(0);

      307     9572    4                  DO CASE(P.ID);

   9572  1 000614   200027 236100                    LDQ     POINTER,,AUTO
         1 000615   000025 772000                    QRL     21
         1 000616   000777 376007                    ANQ     511,DL
         1 000617   000012 116007                    CMPQ    10,DL
         1 000620   000622 602006 1                  TNC     s:9572+6,QL
         1 000621   001031 710000 1                  TRA     s:9600
         1 000622   000634 710000 1                  TRA     s:9574
         1 000623   000654 710000 1                  TRA     s:9577
         1 000624   000661 710000 1                  TRA     s:9580
         1 000625   000714 710000 1                  TRA     s:9587
         1 000626   000711 710000 1                  TRA     s:9584
         1 000627   000721 710000 1                  TRA     s:9590
         1 000630   000742 710000 1                  TRA     s:9593
         1 000631   000711 710000 1                  TRA     s:9584
         1 000632   000711 710000 1                  TRA     s:9584
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:38   
         1 000633   000763 710000 1                  TRA     s:9596

      308     9573    4                    CASE(0);               /* SSR */

      309     9574    4                       IF OFFSET/36 > 63 THEN GOTO OUTOFSEG;

   9574  1 000634   200020 236100                    LDQ     OFFSET,,AUTO
         1 000635   000044 506007                    DIV     36,DL
         1 000636   000077 116007                    CMPQ    63,DL
         1 000637   001351 605400 1                  TPNZ    OUTOFSEG

      310     9575    4                       VAL$->RBIT = PINCRB(S_D.USS$, OFFSET)->RBIT;

   9575  1 000640   200003 471500                    LDP1    @VAL$,,AUTO
         1 000641   100000 473500                    LDP3    0,,PR1
         1 000642   200007 474500                    LDP4    @RSIZE,,AUTO
         1 000643   400000 720100                    LXL0    0,,PR4
         1 000644   000005 475500                    LDP5    5,,PR0
         1 000645   200020 235100                    LDA     OFFSET,,AUTO
         1 000646   000650 605000 1                  TPL     s:9575+8
         1 000647   000044 035003                    ADLA    36,DU
         1 000650   003140 060545                    CSL     bolr='003'O
         1 000651   500000 000010                    BDSC    0,A,PR5                  by=0,bit=0,n=*X0
         1 000652   300000 000010                    BDSC    0,,PR3                   by=0,bit=0,n=*X0
         1 000653   001344 710000 1                  TRA     s:9678

      311     9576    4                    CASE(1);               /* JIT */

      312     9577    4                       LS = PINCRW(DA.CURLS$, 1*2)->BIT72;

   9577  1 000654   000000 471400 xsym               LDP1    DD_ANLZSEG$
         1 000655   100002 473500                    LDP3    2,,PR1
         1 000656   300002 237100                    LDAQ    2,,PR3
         1 000657   200064 757100                    STAQ    LS,,AUTO

      313     9578    4                       GOTO LS_ENTRY;

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:39   
   9578  1 000660   001105 710000 1                  TRA     LS_ENTRY

      314     9579    4                    CASE(2);               /* HJIT */

      315     9580    4                       IF OFFSET/36 > 1024 THEN GOTO OUTOFSEG;

   9580  1 000661   200020 236100                    LDQ     OFFSET,,AUTO
         1 000662   000044 506007                    DIV     36,DL
         1 000663   002000 116007                    CMPQ    1024,DL
         1 000664   001351 605400 1                  TPNZ    OUTOFSEG

      316     9581    4                       CALL DUL$GETVP2(2, 2, TPTR$) ALTRET(ERROR_RETURN);

   9581  1 000665   200047 631500                    EPPR1   TPTR$,,AUTO
         1 000666   200070 451500                    STP1    LS+4,,AUTO
         1 000667   000004 237000 2                  LDAQ    4
         1 000670   200066 757100                    STAQ    LS+2,,AUTO
         1 000671   200066 630500                    EPPR0   LS+2,,AUTO
         1 000672   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000673   000000 701000 xent               TSX1    DUL$GETVP2
         1 000674   001354 702000 1                  TSX2    ERROR_RETURN

      317     9582    4                       VAL$->RBIT = PINCRB(TPTR$, OFFSET)->RBIT;

   9582  1 000675   200003 470500                    LDP0    @VAL$,,AUTO
         1 000676   000000 471500                    LDP1    0,,PR0
         1 000677   200007 473500                    LDP3    @RSIZE,,AUTO
         1 000700   300000 720100                    LXL0    0,,PR3
         1 000701   200020 235100                    LDA     OFFSET,,AUTO
         1 000702   000704 605000 1                  TPL     s:9582+7
         1 000703   000044 035003                    ADLA    36,DU
         1 000704   200047 474500                    LDP4    TPTR$,,AUTO
         1 000705   003140 060545                    CSL     bolr='003'O
         1 000706   400000 000010                    BDSC    0,A,PR4                  by=0,bit=0,n=*X0
         1 000707   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=*X0
         1 000710   001344 710000 1                  TRA     s:9678

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:40   
      318     9583    4                    CASE(4,7,8);           /* SAD ERR HEAD */

      319     9584    4                       S_D.ERROR = 34; /*E@NOTYET*/

   9584  1 000711   000042 235007                    LDA     34,DL
         1 000712   000013 755100                    STA     11,,PR0

      320     9585    4                       GOTO ERROR_RETURN;

   9585  1 000713   001354 710000 1                  TRA     ERROR_RETURN

      321     9586    4                    CASE(3);               /* TCB */

      322     9587    4                       LS = PINCRW(DA.CURLS$, 15*2)->BIT72;

   9587  1 000714   000000 471400 xsym               LDP1    DD_ANLZSEG$
         1 000715   100002 473500                    LDP3    2,,PR1
         1 000716   300036 237100                    LDAQ    30,,PR3
         1 000717   200064 757100                    STAQ    LS,,AUTO

      323     9588    4                       GOTO LS_ENTRY;

   9588  1 000720   001105 710000 1                  TRA     LS_ENTRY

      324     9589    4                    CASE(5);               /* RVB */

      325     9590    4                       IF OFFSET/36 > SIZEW(RV_BUFF)-1 THEN GOTO OUTOFSEG;

   9590  1 000721   200020 236100                    LDQ     OFFSET,,AUTO
         1 000722   000044 506007                    DIV     36,DL
         1 000723   001777 116007                    CMPQ    1023,DL
         1 000724   001351 605400 1                  TPNZ    OUTOFSEG

      326     9591    4                       VAL$->RBIT = PINCRB(DA.RVBUFF$, OFFSET)->RBIT;

   9591  1 000725   200003 471500                    LDP1    @VAL$,,AUTO
         1 000726   100000 473500                    LDP3    0,,PR1
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:41   
         1 000727   200007 474500                    LDP4    @RSIZE,,AUTO
         1 000730   400000 720100                    LXL0    0,,PR4
         1 000731   000000 475400 xsym               LDP5    DD_ANLZSEG$
         1 000732   500011 476500                    LDP6    9,,PR5
         1 000733   200020 235100                    LDA     OFFSET,,AUTO
         1 000734   000736 605000 1                  TPL     s:9591+9
         1 000735   000044 035003                    ADLA    36,DU
         1 000736   003140 060545                    CSL     bolr='003'O
         1 000737   600000 000010                    BDSC    0,A,PR6                  by=0,bit=0,n=*X0
         1 000740   300000 000010                    BDSC    0,,PR3                   by=0,bit=0,n=*X0
         1 000741   001344 710000 1                  TRA     s:9678

      327     9592    4                    CASE(6);               /* USD */

      328     9593    4                       IF OFFSET/36 > SIZEW(RV_USRDIR)-1 THEN GOTO OUTOFSEG;

   9593  1 000742   200020 236100                    LDQ     OFFSET,,AUTO
         1 000743   000044 506007                    DIV     36,DL
         1 000744   001777 116007                    CMPQ    1023,DL
         1 000745   001351 605400 1                  TPNZ    OUTOFSEG

      329     9594    4                       VAL$->RBIT = PINCRB(DA.USRDIR$, OFFSET)->RBIT;

   9594  1 000746   200003 471500                    LDP1    @VAL$,,AUTO
         1 000747   100000 473500                    LDP3    0,,PR1
         1 000750   200007 474500                    LDP4    @RSIZE,,AUTO
         1 000751   400000 720100                    LXL0    0,,PR4
         1 000752   000000 475400 xsym               LDP5    DD_ANLZSEG$
         1 000753   500012 476500                    LDP6    10,,PR5
         1 000754   200020 235100                    LDA     OFFSET,,AUTO
         1 000755   000757 605000 1                  TPL     s:9594+9
         1 000756   000044 035003                    ADLA    36,DU
         1 000757   003140 060545                    CSL     bolr='003'O
         1 000760   600000 000010                    BDSC    0,A,PR6                  by=0,bit=0,n=*X0
         1 000761   300000 000010                    BDSC    0,,PR3                   by=0,bit=0,n=*X0
         1 000762   001344 710000 1                  TRA     s:9678

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:42   
      330     9595    4                    CASE(9);               /* $CGn */

      331     9596    4                       IF OFFSET/36 > 255*1024 THEN GOTO OUTOFSEG;

   9596  1 000763   200020 236100                    LDQ     OFFSET,,AUTO
         1 000764   000044 506007                    DIV     36,DL
         1 000765   776000 116007                    CMPQ    -1024,DL
         1 000766   001351 605400 1                  TPNZ    OUTOFSEG

      332     9597    4                       CALL DUL$GETVP2(OFFSET/36/1024, (OFFSET+RSIZE)/36/1024, TPTR$)
              9597                                ALTRET(ERROR_RETURN);

   9597  1 000767   200020 236100                    LDQ     OFFSET,,AUTO
         1 000770   000044 506007                    DIV     36,DL
         1 000771   002000 506007                    DIV     1024,DL
         1 000772   200007 471500                    LDP1    @RSIZE,,AUTO
         1 000773   200066 756100                    STQ     LS+2,,AUTO
         1 000774   200020 236100                    LDQ     OFFSET,,AUTO
         1 000775   100000 036100                    ADLQ    0,,PR1
         1 000776   000044 506007                    DIV     36,DL
         1 000777   002000 506007                    DIV     1024,DL
         1 001000   200066 235100                    LDA     LS+2,,AUTO
         1 001001   200067 755100                    STA     LS+3,,AUTO
         1 001002   200070 756100                    STQ     LS+4,,AUTO
         1 001003   200047 633500                    EPPR3   TPTR$,,AUTO
         1 001004   200073 453500                    STP3    LS+7,,AUTO
         1 001005   200070 634500                    EPPR4   LS+4,,AUTO
         1 001006   200072 454500                    STP4    LS+6,,AUTO
         1 001007   200067 635500                    EPPR5   LS+3,,AUTO
         1 001010   200071 455500                    STP5    LS+5,,AUTO
         1 001011   200071 630500                    EPPR0   LS+5,,AUTO
         1 001012   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001013   000000 701000 xent               TSX1    DUL$GETVP2
         1 001014   001354 702000 1                  TSX2    ERROR_RETURN

      333     9598    4                       VAL$->RBIT = PINCRB(TPTR$, OFFSET)->RBIT;

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:43   
   9598  1 001015   200003 470500                    LDP0    @VAL$,,AUTO
         1 001016   000000 471500                    LDP1    0,,PR0
         1 001017   200007 473500                    LDP3    @RSIZE,,AUTO
         1 001020   300000 720100                    LXL0    0,,PR3
         1 001021   200020 235100                    LDA     OFFSET,,AUTO
         1 001022   001024 605000 1                  TPL     s:9598+7
         1 001023   000044 035003                    ADLA    36,DU
         1 001024   200047 474500                    LDP4    TPTR$,,AUTO
         1 001025   003140 060545                    CSL     bolr='003'O
         1 001026   400000 000010                    BDSC    0,A,PR4                  by=0,bit=0,n=*X0
         1 001027   100000 000010                    BDSC    0,,PR1                   by=0,bit=0,n=*X0
         1 001030   001344 710000 1                  TRA     s:9678

      334     9599    4                    CASE(ELSE);

      335     9600    4                       S_D.ERROR = 502; /*E@DELBUG*/

   9600  1 001031   000766 235007                    LDA     502,DL
         1 001032   000013 755100                    STA     11,,PR0

      336     9601    4                       CALL DDE$ERROR;

   9601  1 001033   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001034   000000 701000 xent               TSX1    DDE$ERROR
         1 001035   000000 011000                    NOP     0

      337     9602    4                       GOTO ERROR_RETURN;

   9602  1 001036   001354 710000 1                  TRA     ERROR_RETURN

      338     9603    4                    END;                   /* CASE ID*/

      339     9604    3               CASE(1,5,6,7);

      340     9605    3                  S_D.ERROR = 34;    /*E@NOTYET*/

   9605  1 001037   000042 235007                    LDA     34,DL
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:44   
         1 001040   000013 755100                    STA     11,,PR0

      341     9606    3                  GOTO ERROR_RETURN;

   9606  1 001041   001354 710000 1                  TRA     ERROR_RETURN

      342     9607    3               CASE(2);

      343     9608    3                  IF P.ID > 0

   9608  1 001042   200027 236100                    LDQ     POINTER,,AUTO
         1 001043   007770 316003                    CANQ    4088,DU
         1 001044   001075 600000 1                  TZE     s:9613

      344     9609    4                  THEN DO;

      345     9610    4                       PR = PINCRW(S_D.USS$, P.ID)->BIT36;

   9610  1 001045   200027 236100                    LDQ     POINTER,,AUTO
         1 001046   000025 772000                    QRL     21
         1 001047   000777 376007                    ANQ     511,DL
         1 001050   000005 471500                    LDP1    5,,PR0
         1 001051   100000 236106                    LDQ     0,QL,PR1
         1 001052   200051 756100                    STQ     PR,,AUTO

      346     9611    4                       OFFSET = OFFSET + PR.W*36 + PR.C*9 + PR.B;

   9611  1 001053   200051 236100                    LDQ     PR,,AUTO
         1 001054   000022 772000                    QRL     18
         1 001055   000044 402007                    MPY     36,DL
         1 001056   200020 036100                    ADLQ    OFFSET,,AUTO
         1 001057   200066 756100                    STQ     LS+2,,AUTO
         1 001060   200051 236100                    LDQ     PR,,AUTO
         1 001061   000020 772000                    QRL     16
         1 001062   000003 376007                    ANQ     3,DL
         1 001063   000011 402007                    MPY     9,DL
         1 001064   200066 036100                    ADLQ    LS+2,,AUTO
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:45   
         1 001065   200067 756100                    STQ     LS+3,,AUTO
         1 001066   200051 236100                    LDQ     PR,,AUTO
         1 001067   000014 772000                    QRL     12
         1 001070   000017 376007                    ANQ     15,DL
         1 001071   200070 756100                    STQ     LS+4,,AUTO
         1 001072   200067 236100                    LDQ     LS+3,,AUTO
         1 001073   200070 036100                    ADLQ    LS+4,,AUTO
         1 001074   200020 756100                    STQ     OFFSET,,AUTO

      347     9612    4                     END;

      348     9613    3                  LS = PINCRW(S_D.USS$, P.DISP)->BIT72;

   9613  1 001075   200027 236100                    LDQ     POINTER,,AUTO
         1 001076   000014 772000                    QRL     12
         1 001077   000777 376007                    ANQ     511,DL
         1 001100   000005 471500                    LDP1    5,,PR0
         1 001101   000002 736000                    QLS     2
         1 001102   000100 100506                    MLR     fill='000'O
         1 001103   100000 000010                    ADSC9   0,Q,PR1                  cn=0,n=8
         1 001104   200064 000010                    ADSC9   LS,,AUTO                 cn=0,n=8

      349     9614    3   LS_ENTRY:
      350     9615    3                  IF NOT LS.FLG.EMPTY

   9615  1 001105   200064 236100       LS_ENTRY     LDQ     LS,,AUTO
         1 001106   000400 316007                    CANQ    256,DL
         1 001107   001351 600000 1                  TZE     OUTOFSEG

      351     9616    3                  THEN GOTO OUTOFSEG;
      352     9617    3                  IF LS.TYP ~= 0

   9617  1 001110   000017 316007                    CANQ    15,DL
         1 001111   001116 600000 1                  TZE     s:9622

      353     9618    4                  THEN DO;

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:46   
      354     9619    4                       S_D.ERROR = 503; /*E@NOTIMP*/

   9619  1 001112   000767 235007                    LDA     503,DL
         1 001113   000000 470400 xsym               LDP0    S_D$
         1 001114   000013 755100                    STA     11,,PR0

      355     9620    4                       GOTO ERROR_RETURN;

   9620  1 001115   001354 710000 1                  TRA     ERROR_RETURN

      356     9621    4                     END;
      357     9622    3                  IF LS.WSR = 0

   9622  1 001116   000160 316007                    CANQ    112,DL
         1 001117   001126 601000 1                  TNZ     s:9627

      358     9623    4                  THEN DO;

      359     9624    4                       DA.CURPT$ = DA.MONPT$;

   9624  1 001120   000000 470400 xsym               LDP0    DD_ANLZSEG$
         1 001121   000003 236100                    LDQ     3,,PR0
         1 001122   000005 756100                    STQ     5,,PR0

      360     9625    4                       DA.CURKEY = DA.MONKEY;

   9625  1 001123   000030 237100                    LDAQ    24,,PR0
         1 001124   000026 757100                    STAQ    22,,PR0

      361     9626    4                     END;

   9626  1 001125   001144 710000 1                  TRA     s:9636

      362     9627    3                  ELSE IF LS.WSR = 7

   9627  1 001126   200064 236100                    LDQ     LS,,AUTO
         1 001127   000160 376007                    ANQ     112,DL
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:47   
         1 001130   000160 116007                    CMPQ    112,DL
         1 001131   001140 601000 1                  TNZ     s:9633

      363     9628    4                       THEN DO;

      364     9629    4                            DA.CURPT$ = DA.UPT$;

   9629  1 001132   000000 470400 xsym               LDP0    DD_ANLZSEG$
         1 001133   000004 236100                    LDQ     4,,PR0
         1 001134   000005 756100                    STQ     5,,PR0

      365     9630    4                            DA.CURKEY = DA.UKEY;

   9630  1 001135   000032 237100                    LDAQ    26,,PR0
         1 001136   000026 757100                    STAQ    22,,PR0

      366     9631    4                          END;

   9631  1 001137   001144 710000 1                  TRA     s:9636

      367     9632    4                       ELSE DO;

      368     9633    4                            S_D.ERROR = 503; /*E@NOTIMP*/

   9633  1 001140   000767 235007                    LDA     503,DL
         1 001141   000000 470400 xsym               LDP0    S_D$
         1 001142   000013 755100                    STA     11,,PR0

      369     9634    4                            GOTO ERROR_RETURN;

   9634  1 001143   001354 710000 1                  TRA     ERROR_RETURN

      370     9635    4                          END;
      371     9636    3                  IF OFFSET/9 + RSIZE/9 > LS.BOUND + 1 THEN GOTO OUTOFSEG;

   9636  1 001144   200020 236100                    LDQ     OFFSET,,AUTO
         1 001145   000011 506007                    DIV     9,DL
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:48   
         1 001146   200007 471500                    LDP1    @RSIZE,,AUTO
         1 001147   200066 756100                    STQ     LS+2,,AUTO
         1 001150   100000 236100                    LDQ     0,,PR1
         1 001151   000011 506007                    DIV     9,DL
         1 001152   200066 036100                    ADLQ    LS+2,,AUTO
         1 001153   200067 756100                    STQ     LS+3,,AUTO
         1 001154   200064 236100                    LDQ     LS,,AUTO
         1 001155   000020 772000                    QRL     16
         1 001156   000001 036007                    ADLQ    1,DL
         1 001157   200067 116100                    CMPQ    LS+3,,AUTO
         1 001160   001351 604000 1                  TMI     OUTOFSEG

      372     9637    3                  IF MOD(LS.BASE, 4) ~= 0

   9637  1 001161   200065 236100                    LDQ     LS+1,,AUTO
         1 001162   000003 376007                    ANQ     3,DL
         1 001163   001170 600000 1                  TZE     s:9642

      373     9638    4                  THEN DO;

      374     9639    4                       S_D.ERROR = 503; /*E@NOTIMP*/

   9639  1 001164   000767 235007                    LDA     503,DL
         1 001165   000000 473400 xsym               LDP3    S_D$
         1 001166   300013 755100                    STA     11,,PR3

      375     9640    4                       GOTO ERROR_RETURN;

   9640  1 001167   001354 710000 1                  TRA     ERROR_RETURN

      376     9641    4                     END;
      377     9642    3                  VBSTART = OFFSET + LS.BASE*9;

   9642  1 001170   200065 236100                    LDQ     LS+1,,AUTO
         1 001171   000011 402007                    MPY     9,DL
         1 001172   200020 036100                    ADLQ    OFFSET,,AUTO
         1 001173   200050 756100                    STQ     VBSTART,,AUTO
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:49   

      378     9643    3                  CALL DUL$GETVP2(VBSTART/36/1024, (VBSTART+RSIZE)/36/1024, TPTR$)
              9643                           ALTRET(ERROR_RETURN);

   9643  1 001174   000001 772000                    QRL     1
         1 001175   000022 506007                    DIV     18,DL
         1 001176   000012 772000                    QRL     10
         1 001177   200066 756100                    STQ     LS+2,,AUTO
         1 001200   200050 236100                    LDQ     VBSTART,,AUTO
         1 001201   100000 036100                    ADLQ    0,,PR1
         1 001202   000044 506007                    DIV     36,DL
         1 001203   002000 506007                    DIV     1024,DL
         1 001204   200066 235100                    LDA     LS+2,,AUTO
         1 001205   200067 755100                    STA     LS+3,,AUTO
         1 001206   200070 756100                    STQ     LS+4,,AUTO
         1 001207   200047 633500                    EPPR3   TPTR$,,AUTO
         1 001210   200073 453500                    STP3    LS+7,,AUTO
         1 001211   200070 634500                    EPPR4   LS+4,,AUTO
         1 001212   200072 454500                    STP4    LS+6,,AUTO
         1 001213   200067 635500                    EPPR5   LS+3,,AUTO
         1 001214   200071 455500                    STP5    LS+5,,AUTO
         1 001215   200071 630500                    EPPR0   LS+5,,AUTO
         1 001216   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001217   000000 701000 xent               TSX1    DUL$GETVP2
         1 001220   001354 702000 1                  TSX2    ERROR_RETURN

      379     9644    3                  IF RSIZE ~= DSIZE

   9644  1 001221   200007 470500                    LDP0    @RSIZE,,AUTO
         1 001222   200006 471500                    LDP1    @DSIZE,,AUTO
         1 001223   000000 236100                    LDQ     0,,PR0
         1 001224   100000 116100                    CMPQ    0,,PR1
         1 001225   001230 600000 1                  TZE     s:9646

      380     9645    3                  THEN RSIZE = DSIZE;

   9645  1 001226   100000 235100                    LDA     0,,PR1
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:50   
         1 001227   000000 755100                    STA     0,,PR0

      381     9646    3                  VAL$->RBIT = PINCRB(TPTR$, MOD(VBSTART, 1024*36))->RBIT;

   9646  1 001230   200003 473500                    LDP3    @VAL$,,AUTO
         1 001231   300000 474500                    LDP4    0,,PR3
         1 001232   000000 720100                    LXL0    0,,PR0
         1 001233   200050 235100                    LDA     VBSTART,,AUTO
         1 001234   000043 773000                    LRL     35
         1 001235   110000 507007                    DVF     36864,DL
         1 001236   200047 475500                    LDP5    TPTR$,,AUTO
         1 001237   003140 060546                    CSL     bolr='003'O
         1 001240   500000 000010                    BDSC    0,Q,PR5                  by=0,bit=0,n=*X0
         1 001241   400000 000010                    BDSC    0,,PR4                   by=0,bit=0,n=*X0
         1 001242   001344 710000 1                  TRA     s:9678

      382     9647    3               CASE(3);

      383     9648    3                  IF P.ID ~= 3             /* $LSN */

   9648  1 001243   200027 236100                    LDQ     POINTER,,AUTO
         1 001244   007770 376003                    ANQ     4088,DU
         1 001245   000030 116003                    CMPQ    24,DU
         1 001246   001252 600000 1                  TZE     s:9653

      384     9649    4                  THEN DO;

      385     9650    4                       S_D.ERROR = 503; /*E@NOTIMP*/

   9650  1 001247   000767 235007                    LDA     503,DL
         1 001250   000013 755100                    STA     11,,PR0

      386     9651    4                       GOTO ERROR_RETURN;

   9651  1 001251   001354 710000 1                  TRA     ERROR_RETURN

      387     9652    4                     END;
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:51   
      388     9653    3                  LS = PINCRW(DA.CURLS$, P.DISP)->BIT72;

   9653  1 001252   200027 236100                    LDQ     POINTER,,AUTO
         1 001253   000014 772000                    QRL     12
         1 001254   000777 376007                    ANQ     511,DL
         1 001255   000000 471400 xsym               LDP1    DD_ANLZSEG$
         1 001256   100002 473500                    LDP3    2,,PR1
         1 001257   000002 736000                    QLS     2
         1 001260   000100 100506                    MLR     fill='000'O
         1 001261   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=8
         1 001262   200064 000010                    ADSC9   LS,,AUTO                 cn=0,n=8

      389     9654    3                  GOTO LS_ENTRY;

   9654  1 001263   001105 710000 1                  TRA     LS_ENTRY

      390     9655    3               CASE(4);

      391     9656    3                  S_D.ERROR = 503;    /* E@NOTIMP */

   9656  1 001264   000767 235007                    LDA     503,DL
         1 001265   000013 755100                    STA     11,,PR0

      392     9657    3                  GOTO ERROR_RETURN;

   9657  1 001266   001354 710000 1                  TRA     ERROR_RETURN

      393     9658    3               CASE(8,9);                  /* $ROSEG, $RDBR, $TSA, $Bn */

      394     9659    3                  S_D.ERROR = 304; /* E@SYMNOTHOST */

   9659  1 001267   000460 235007                    LDA     304,DL
         1 001270   000013 755100                    STA     11,,PR0

      395     9660    3                  GOTO ERROR_RETURN;

   9660  1 001271   001354 710000 1                  TRA     ERROR_RETURN
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:52   

      396     9661    3               CASE(ELSE);

      397     9662    3                  S_D.ERROR = 502;    /* E@DELBUG */

   9662  1 001272   000766 235007                    LDA     502,DL
         1 001273   000013 755100                    STA     11,,PR0

      398     9663    3                  CALL DDE$ERROR;

   9663  1 001274   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001275   000000 701000 xent               TSX1    DDE$ERROR
         1 001276   000000 011000                    NOP     0

      399     9664    3                  GOTO ERROR_RETURN;

   9664  1 001277   001354 710000 1                  TRA     ERROR_RETURN

      400     9665    3               END;                        /* CASE TYPE */

      401     9666    2           END;                            /* IF */
      402     9667    2        ELSE DO;                           /* USER POINTER */

      403     9668    2             PR = P;

   9668  1 001300   200027 236100                    LDQ     POINTER,,AUTO
         1 001301   200051 756100                    STQ     PR,,AUTO

      404     9669    2             IF PR.S ~=3

   9669  1 001302   200051 236100                    LDQ     PR,,AUTO
         1 001303   006000 376007                    ANQ     3072,DL
         1 001304   006000 116007                    CMPQ    3072,DL
         1 001305   001311 600000 1                  TZE     s:9674

      405     9670    3             THEN DO;

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:53   
      406     9671    3                  S_D.ERROR = 503;    /*E@NOTIMP*/

   9671  1 001306   000767 235007                    LDA     503,DL
         1 001307   000013 755100                    STA     11,,PR0

      407     9672    3                  GOTO ERROR_RETURN;

   9672  1 001310   001354 710000 1                  TRA     ERROR_RETURN

      408     9673    3                END;
      409     9674    2             OFFSET = OFFSET + PR.W*36 + PR.C*9 + PR.B;

   9674  1 001311   200051 236100                    LDQ     PR,,AUTO
         1 001312   000022 772000                    QRL     18
         1 001313   000044 402007                    MPY     36,DL
         1 001314   200020 036100                    ADLQ    OFFSET,,AUTO
         1 001315   200066 756100                    STQ     LS+2,,AUTO
         1 001316   200051 236100                    LDQ     PR,,AUTO
         1 001317   000020 772000                    QRL     16
         1 001320   000003 376007                    ANQ     3,DL
         1 001321   000011 402007                    MPY     9,DL
         1 001322   200066 036100                    ADLQ    LS+2,,AUTO
         1 001323   200067 756100                    STQ     LS+3,,AUTO
         1 001324   200051 236100                    LDQ     PR,,AUTO
         1 001325   000014 772000                    QRL     12
         1 001326   000017 376007                    ANQ     15,DL
         1 001327   200070 756100                    STQ     LS+4,,AUTO
         1 001330   200067 236100                    LDQ     LS+3,,AUTO
         1 001331   200070 036100                    ADLQ    LS+4,,AUTO
         1 001332   200020 756100                    STQ     OFFSET,,AUTO

      410     9675    2             LS = PINCRW(DA.CURLS$, 2*PR.SEGID)-> BIT72;

   9675  1 001333   200051 720100                    LXL0    PR,,AUTO
         1 001334   001777 360003                    ANX0    1023,DU
         1 001335   000000 471400 xsym               LDP1    DD_ANLZSEG$
         1 001336   100002 473500                    LDP3    2,,PR1
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:54   
         1 001337   000000 635010                    EAA     0,X0
         1 001340   000021 771000                    ARL     17
         1 001341   300000 237105                    LDAQ    0,AL,PR3
         1 001342   200064 757100                    STAQ    LS,,AUTO

      411     9676    2             GOTO LS_ENTRY;

   9676  1 001343   001105 710000 1                  TRA     LS_ENTRY

      412     9677    2           END;
      413     9678    1        RETURN;

   9678  1 001344   000000 702200 xent               TSX2  ! X66_ARET

   9676  1 001345                       TRAP_VIRTUAL null
      414     9679    1   TRAP_VIRTUAL: ;
      415     9680    1        S_D.ERROR = 264;        /* E@TRAP_VIRTUAL */

   9680  1 001345   000410 235007                    LDA     264,DL
         1 001346   000000 470400 xsym               LDP0    S_D$
         1 001347   000013 755100                    STA     11,,PR0

      416     9681    1        ALTRETURN;

   9681  1 001350   000000 702200 xent               TSX2  ! X66_AALT

      417     9682    1   OUTOFSEG:
      418     9683    1        S_D.ERROR = 68;            /*E@OUTOFSEG*/

   9683  1 001351   000104 235007       OUTOFSEG     LDA     68,DL
         1 001352   000000 470400 xsym               LDP0    S_D$
         1 001353   000013 755100                    STA     11,,PR0

      419     9684    1   ERROR_RETURN:
      420     9685    1        ALTRETURN;

   9685  1 001354   000000 702200 xent  ERROR_RETURN TSX2  ! X66_AALT
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:55   

ERRCODE#
 Sect OctLoc
   0     000   104105 106107   110111 112113   114115 116766   046050 044147    DEFGHIJKLMN.&($g
   0     004   150074 161157   250265 422505   527*** ******                    h<qo........

(unnamed)
 Sect OctLoc
   0     007   777777 770000   000000 002000   000000 006000                    ............

(unnamed)
 Sect OctLoc
   2     000   770007 777777   000007 770000   000377 777774   000000 000000    ................
   2     004   000004 006000   000004 006000                                    ........
      421     9686    1   END DDK$PUTVAL;

PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:56   
--  Include file information  --

   DD_DEBUG_C.:E05TOU  is referenced.
   DD$DA.:E05TOU  cannot be made into a system file and is referenced.
   NI$TABLES.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$PUTVAL.

   Procedure DDK$PUTVAL requires 749 words for executable code.
   Procedure DDK$PUTVAL requires 60 words of local(AUTO) storage.

    No errors detected in file DDK$GETVAL.:E05TSI    .
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:57   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:58   
          MINI XREF LISTING

ADDRESS
        54**DCL      9452<<ASSIGN   9457<>CALL     9461<<ASSIGN   9461>>ASSIGN   9463<>CALL
ADDR_TYPE
        21**DCL         9--PROC     9415--ENTRY    9428>>DOCASE   9484>>DOCASE
ANLZ_PART
      9568**LABEL    9548--GOTO
ARET
      9563**LABEL    9549--CALLALT
ARRAY_FLAG
        22**DCL         9--PROC     9415--ENTRY    9459>>IF       9474>>IF
B$EDEF.OU
      4721**DCL      4727--REDEF
BASED_STATIC
      9477**LABEL    9447--GOTO     9468--GOTO
BIT36
       507**DCL      9610>>ASSIGN
BIT72
       506**DCL      9577>>ASSIGN   9587>>ASSIGN   9613>>ASSIGN   9653>>ASSIGN   9675>>ASSIGN
DA.CURKEY
      9292**DCL      9625<<ASSIGN   9630<<ASSIGN
DA.CURLS$
      9266**DCL      9577>>ASSIGN   9587>>ASSIGN   9653>>ASSIGN   9675>>ASSIGN
DA.CURPT$
      9269**DCL      9624<<ASSIGN   9629<<ASSIGN
DA.MONKEY
      9310**DCL      9625>>ASSIGN
DA.MONPT$
      9267**DCL      9624>>ASSIGN
DA.RVBUFF$
      9271**DCL      9591>>ASSIGN
DA.UKEY
      9328**DCL      9630>>ASSIGN
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:59   
DA.UPT$
      9268**DCL      9629>>ASSIGN
DA.USRDIR$
      9272**DCL      9594>>ASSIGN
DDE$ERROR
      9403**DCL-ENT  9440--CALL     9560--CALL     9601--CALL     9663--CALL
DDK$ADDEXPR
      9400**DCL-ENT  9481--CALL
DDK$GETISR
      9398**DCL-ENT  9488--CALL
DDK$GETMVAL
      9401**DCL-ENT  9457--CALL     9463--CALL
DDK$GETV_A
      9402**DCL-ENT  9549--CALL
DD_ANLZSEG$
      9262**DCL      9263--IMP-PTR  9577>>ASSIGN   9587>>ASSIGN   9591>>ASSIGN   9594>>ASSIGN   9624>>ASSIGN
      9624>>ASSIGN   9625>>ASSIGN   9625>>ASSIGN   9629>>ASSIGN   9629>>ASSIGN   9630>>ASSIGN   9630>>ASSIGN
      9653>>ASSIGN   9675>>ASSIGN
DESC.ITEM
      4822**DCL      9464>>ASSIGN   9499>>ASSIGN
DESC#
        56**DCL      9454<<ASSIGN   9457<>CALL     9463<>CALL
DSIZE
        15**DCL         9--PROC     9415--ENTRY    9644>>IF       9645>>ASSIGN
DUL$GETVP2
      9405**DCL-ENT  9581--CALL     9597--CALL     9643--CALL
EIS
        24**DCL         9--PROC     9412>>ASSIGN   9415--ENTRY    9419--IF       9421>>ASSIGN
ENTRANCE
      9425**LABEL    9413--GOTO
ERRCODE
        51**DCL      9563>>ASSIGN
ERRCODE#
       475**DCL      9563>>ASSIGN
ERROR_RETURN
      9685**LABEL    9581--CALLALT  9585--GOTO     9597--CALLALT  9602--GOTO     9606--GOTO     9620--GOTO
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:60   
      9634--GOTO     9640--GOTO     9643--CALLALT  9651--GOTO     9657--GOTO     9660--GOTO     9664--GOTO
      9672--GOTO
EXPR_OP
        20**DCL         9--PROC     9415--ENTRY    9477>>IF       9481<>CALL
EXPR_VAL
        19**DCL         9--PROC     9415--ENTRY    9481<>CALL
FINDSTACK
      9501**LABEL    9501--GOTO
INDXX
        17**DCL         9--PROC     9415--ENTRY    9460>>ASSIGN   9475>>ASSIGN
ITEM
      1194**DCL         9--PROC     9415--ENTRY
ITEM.ADDRESS
      1215**DCL      1220--REDEF    1221--REDEF    1222--REDEF
ITEM.ADDRESS.B
      1219**DCL      9473>>ASSIGN
ITEM.ADDRESS.C
      1218**DCL      9473>>ASSIGN
ITEM.ADDRESS.W
      1217**DCL      9452>>ASSIGN   9473>>ASSIGN
ITEM.SP.VD
      1223**DCL      1227--REDEF    1230--REDEF
ITEM.VALUE
      1220**DCL      9433>>ASSIGN   9446>>ASSIGN
ITEM.VALUEB
      1221**DCL      9555>>ASSIGN
LS
      8865**DCL      9577<<ASSIGN   9587<<ASSIGN   9613<<ASSIGN   9653<<ASSIGN   9675<<ASSIGN
LS.BASE
      8873**DCL      9637>>IF       9642>>ASSIGN
LS.BOUND
      8866**DCL      9636>>IF
LS.FLG.EMPTY
      8869**DCL      9615>>IF
LS.TYP
      8872**DCL      9617>>IF
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:61   
LS.WSR
      8871**DCL      9622>>IF       9627>>IF
LS_ENTRY
      9615**LABEL    9578--GOTO     9588--GOTO     9654--GOTO     9676--GOTO
NOT_IS
        57**DCL      9455<<ASSIGN   9457<>CALL     9463<>CALL
OFFSET
        30**DCL      9446<<ASSIGN   9457<>CALL     9458<<ASSIGN   9458>>ASSIGN   9460<<ASSIGN   9460>>ASSIGN
      9473<<ASSIGN   9475<<ASSIGN   9475>>ASSIGN   9480<<ASSIGN   9480>>ASSIGN   9481<>CALL     9482<<ASSIGN
      9482>>ASSIGN   9574>>IF       9575>>ASSIGN   9580>>IF       9582>>ASSIGN   9590>>IF       9591>>ASSIGN
      9593>>IF       9594>>ASSIGN   9596>>IF       9597>>CALL     9597>>CALL     9598>>ASSIGN   9611<<ASSIGN
      9611>>ASSIGN   9636>>IF       9642>>ASSIGN   9674<<ASSIGN   9674>>ASSIGN
OUTOFSEG
      9683**LABEL    9574--GOTO     9580--GOTO     9590--GOTO     9593--GOTO     9596--GOTO     9616--GOTO
      9636--GOTO
P
        37**DCL      9668>>ASSIGN
P.DISP
        40**DCL      9467<<ASSIGN   9613>>ASSIGN   9653>>ASSIGN
P.ID
        39**DCL      9466<<ASSIGN   9572>>DOCASE   9608>>IF       9610>>ASSIGN   9648>>IF
P.S
        41**DCL      9568>>IF
P.TYPE
        38**DCL      9570>>DOCASE
PNTR
        18**DCL         9--PROC     9415--ENTRY    9426>>ASSIGN
PNTR1
        58**DCL      9463<>CALL
PNTR1.SEGID
        60**DCL      9467>>ASSIGN
POINTER
        35**DCL        36--REDEF      37--REDEF    9426<<ASSIGN   9464<<ASSIGN   9487<<ASSIGN   9488<>CALL
      9499<<ASSIGN
PR
        63**DCL      9610<<ASSIGN   9668<<ASSIGN
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:62   
PR.B
        66**DCL      9611>>ASSIGN   9674>>ASSIGN
PR.C
        65**DCL      9611>>ASSIGN   9674>>ASSIGN
PR.S
        67**DCL      9669>>IF
PR.SEGID
        68**DCL      9675>>ASSIGN
PR.W
        64**DCL      9611>>ASSIGN   9674>>ASSIGN
RBIT
       511**DCL      9575<<ASSIGN   9575>>ASSIGN   9582<<ASSIGN   9582>>ASSIGN   9591<<ASSIGN   9591>>ASSIGN
      9594<<ASSIGN   9594>>ASSIGN   9598<<ASSIGN   9598>>ASSIGN   9646<<ASSIGN   9646>>ASSIGN
RSIZE
        16**DCL         9--PROC      511--IMP-SIZ  9415--ENTRY    9575>>ASSIGN   9575>>ASSIGN   9582>>ASSIGN
      9582>>ASSIGN   9591>>ASSIGN   9591>>ASSIGN   9594>>ASSIGN   9594>>ASSIGN   9597>>CALL     9598>>ASSIGN
      9598>>ASSIGN   9636>>IF       9643>>CALL     9644>>IF       9645<<ASSIGN   9646>>ASSIGN   9646>>ASSIGN
RV_BUFF
      9358**DCL      9590--IF
RV_USRDIR
      9394**DCL      9593--IF
SEG
        55**DCL      9453<<ASSIGN   9457<>CALL     9463<>CALL
STACKOFF
        72**DCL      9541>>ASSIGN
SVALUE
        14**DCL         9--PROC     9415--ENTRY
SZ
        43**DCL       503--IMP-SIZ
S_D.ACCESS
      6282**DCL      9540<<ASSIGN
S_D.ANLZ
      6895**DCL      9493>>IF
S_D.ANLZ_FILE
      6959**DCL      9487>>IF       9548>>IF
S_D.ASTACKOFF
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:63   
      6773**DCL      9541<<ASSIGN
S_D.CURRENT_CHANNEL
      7195**DCL      7197--REDEF
S_D.DEBUGA
      6347**DCL      6349--REDEF    9543>>IF
S_D.EIS
      7305**DCL      7334--REDEF
S_D.ERROR
      6276**DCL      9409<<ASSIGN   9439<<ASSIGN   9496<<ASSIGN   9545<<ASSIGN   9559<<ASSIGN   9563<<ASSIGN
      9584<<ASSIGN   9600<<ASSIGN   9605<<ASSIGN   9619<<ASSIGN   9633<<ASSIGN   9639<<ASSIGN   9650<<ASSIGN
      9656<<ASSIGN   9659<<ASSIGN   9662<<ASSIGN   9671<<ASSIGN   9680<<ASSIGN   9683<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      7238**DCL      7239--REDEF    7253--REDEF
S_D.JDE
      6852**DCL      6853--REDEF
S_D.L$.VALUE
      6405**DCL      6411--REDEF    6419--REDEF    6422--REDEF    6425--REDEF    6428--REDEF
S_D.L$.VALUE.L
      6406**DCL      6407--REDEF    6408--REDEF
S_D.L6_MESSAGE_BUF
      7259**DCL      7261--REDEF
S_D.OUTPUT
      7225**DCL      7227--REDEF
S_D.PROTECT
      7102**DCL      9407>>IF
S_D.REMOTE_MSG.FNCC
      7244**DCL      7245--REDEF
S_D.REMOTE_MSG.STXC
      7240**DCL      7241--REDEF
S_D.REMOTE_MSG.SUBFNCC
      7248**DCL      7249--REDEF
S_D.RUM
      6893**DCL      9493>>IF       9543>>IF
S_D.SV
      6304**DCL      6325--REDEF
S_D.USS$
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:64   
      6264**DCL      9575>>ASSIGN   9610>>ASSIGN   9613>>ASSIGN
S_D$
      7556**DCL      6252--IMP-PTR  9407>>IF       9409>>ASSIGN   9439>>ASSIGN   9487>>IF       9493>>IF
      9493>>IF       9496>>ASSIGN   9540>>ASSIGN   9541>>ASSIGN   9543>>IF       9543>>IF       9545>>ASSIGN
      9548>>IF       9559>>ASSIGN   9563>>ASSIGN   9575>>ASSIGN   9584>>ASSIGN   9600>>ASSIGN   9605>>ASSIGN
      9610>>ASSIGN   9613>>ASSIGN   9619>>ASSIGN   9633>>ASSIGN   9639>>ASSIGN   9650>>ASSIGN   9656>>ASSIGN
      9659>>ASSIGN   9662>>ASSIGN   9671>>ASSIGN   9680>>ASSIGN   9683>>ASSIGN
TPTR$
        61**DCL      9581<>CALL     9582>>ASSIGN   9597<>CALL     9598>>ASSIGN   9643<>CALL     9646>>ASSIGN
TRAP_VIRTUAL
      9676**LABEL    9457--CALLALT  9463--CALLALT
TRUNC
        34**DCL      9425<<ASSIGN   9479<<ASSIGN
TRUNC_FLAG
        23**DCL         9--PROC     9415--ENTRY    9425>>ASSIGN
VAL$
        13**DCL         9--PROC      502--IMP-PTR  9415--ENTRY    9433>>ASSIGN   9555>>ASSIGN   9575>>ASSIGN
      9582>>ASSIGN   9591>>ASSIGN   9594>>ASSIGN   9598>>ASSIGN   9646>>ASSIGN
VALUE
       502**DCL      9433<<ASSIGN   9555<<ASSIGN
VBSTART
        62**DCL      9642<<ASSIGN   9643>>CALL     9643>>CALL     9646>>ASSIGN
WHAT
        44**DCL      9412<<ASSIGN   9420<<ASSIGN   9421<<ASSIGN
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:65   
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$PUTVAL File=DDK$GETVAL.:E05TSI                            TUE 07/29/97 14:03 Page:66   
              MINI UREF LISTING

CHAR4     504**DCL
DDF$FIND_PEDEF    9404**DCL-ENT
DDK$GETVAL    9415**ENTRY
DDK$PUTVAL       9**PROC
DDK$SEXTEND    9399**DCL-ENT
DESCX      31**DCL
GOTSTACK    9499**LABEL
MAPSZ      49**DCL
POINTER$      36**DCL
PT#      50**DCL
PTW1      47**DCL
PTW2      48**DCL
RET      52**DCL
RETADDR      74**DCL
RSTACKOFF      73**DCL
SDD$     616**DCL
SDD_L6$     618**DCL
STACK$      75**DCL
STACKIC      71**DCL
TAR      45**DCL
TEDEF$      76**DCL
TEMP1      32**DCL
TEMP2      33**DCL
TEXTR     503**DCL
UBIN36     505**DCL
UDR2$      69**DCL
UIS$      70**DCL
W     508**DCL
WSQ#      46**DCL
ZITEM$     617**DCL
ZITEM_L6$     619**DCL
