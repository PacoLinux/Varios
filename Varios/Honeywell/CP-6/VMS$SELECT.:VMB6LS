VERSION B06

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:1    
        1        1        /*M* VMS$SELECT - Routines to evaluate SELECTION CRITERIA for messages. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8        /*F*    NAME:          VMS$SELECT
        9        9                PURPOSE:       To evaluate MAIL selection criteria expressions.
       10       10                DESCRIPTION:   This RECURSIVE routine uses operator
       11       11                               precedence to parse expressions.
       12       12        */
       13       13        VMS$SELECT: PROC (TREE$,VM_SELECT,RESULT$) ALTRET;
       14       14        /***** Include files *****/
       15       15          %INCLUDE CP_6;
       16     5574          %INCLUDE CP_6_SUBS;
       17     6114          %INCLUDE B_ERRORS_C;
       18     7241          %INCLUDE XU_MACRO_C;
       19    10347          %INCLUDE XUW_MACRO_C;
       20    10482        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:2    
       21    10483
       22    10484        /***** Local Equates *****/
       23    10485        %INCLUDE XUD_UTS_M;
       24    10567             %XUD$UTS_ENTRIES;
       25    10599             %XUD_UTS_EQU;
       26    10610        %EQU MINS_PER_DAY = 1440;
       27    10611          %INCLUDE VM_PERR_C;
       28    10906          %INCLUDE VM_MACRO_C;
       29    12174          %INCLUDE VM_SUBS_C;
       30    12434          %INCLUDE VM_DATA_R;
       31    12865            %include B$TABLES_C;
       32    12973             %B$XL_UPPER(NAME=LOWER_UPPER);
       33    12977        /***** Parameters *****/
       34    12978    1   DCL TREE$ PTR;
       35    12979          %VM_SELECT (NAME=VM_SELECT,STCLASS=" ");
       36    13000    1   DCL RESULT$ PTR;
       37    13001        /***** Based structures *****/
       38    13002          %PARSE$OUT (NAME=P$B,STCLASS=BASED);
       39    13047          %PARSE$SYM (NAME=P$S,STCLASS=BASED);
       40    13085          %VM_HEADER;
       41    13214          %B$TCB(STCLASS="BASED(B$TCB$)");
       42    13217          %B$ALT;
       43    13225        /***** Ptr variables *****/
       44    13226    1   DCL VALUE$ PTR AUTO;
       45    13227    1   DCL TOKEN_PTR$ PTR AUTO;
       46    13228        /***** Word/array variables *****/
       47    13229    1   DCL MORE# BIT(1) AUTO;
       48    13230    1   DCL CHARPOS UBIN WORD AUTO;
       49    13231    1   DCL OP_PTR SBIN WORD AUTO;
       50    13232    1   DCL VAL_PTR SBIN WORD AUTO;
       51    13233    1   DCL NUM_ARGS SBIN WORD AUTO;
       52    13234    1   DCL TOKEN_INDX SBIN WORD AUTO;
       53    13235    1   DCL TOKEN UBIN WORD AUTO;
       54    13236        /***** Character variables *****/
       55    13237          %VLP_NAME (FPTN=WORK1,LEN=511,STCLASS=AUTO);
       56    13264          %VLP_NAME (FPTN=WORK2,LEN=511,STCLASS=AUTO);
       57    13291        /***** Stacks *****/
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:3    
       58    13292    1   DCL OP_STACK (0:%SEL_STACK_SIZE) UBIN AUTO;
       59    13293    1   DCL NUM_TO_POP_STACK (0:%SEL_STACK_SIZE) UBIN AUTO;
       60    13294    1   DCL VAL_STACK$ (0:%(SEL_STACK_SIZE*2)) PTR AUTO;
       61    13295    1   DCL VAL_TYPE (0:%(SEL_STACK_SIZE*2)) UBIN AUTO;
       62    13296    1   DCL CHARPOS_STACK (0:%(SEL_STACK_SIZE*2)) UBIN HALF AUTO;
       63    13297        /***** Constants *****/
       64    13298    1   DCL ZERO$ PTR CONSTANT INIT (ADDR(ZERO));
       65    13299    1   DCL 1  ZERO CONSTANT,
       66    13300    1         2  COUNT UBIN BYTE UNAL INIT (1),
       67    13301    1         2  TEXT CHAR(1) UNAL INIT('0');
       68    13302    1   DCL ONE$ PTR CONSTANT INIT (ADDR(ONE));
       69    13303    1   DCL 1  ONE CONSTANT,
       70    13304    1         2  COUNT UBIN BYTE UNAL INIT (1),
       71    13305    1         2  TEXT CHAR(1) UNAL INIT('1');
       72    13306        /***** External routines *****/
       73    13307    1   DCL X$DEC_CONVERT ENTRY(2) ALTRET;
       74    13308    1   DCL X$STRIP_BLANKS ENTRY(1);
       75    13309    1   DCL VMA$COMPRESS_BLANKS ENTRY(1);
       76    13310    1   DCL X$WILDCMP ENTRY(1) ALTRET;
       77    13311        /***** Fpts *****/
       78    13312          %XUW_WILDCARD (FPTN=VM_WILDCARD,STCLASS=STATIC,CONTAINS=YES);
       79    13408        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:4    
       80    13409        /***** Macros *****/
       81    13410          %MACRO ERR_CODE (NAME=JUNK,CODE=0,SEV=0);
       82    13411            %VLP_ERRCODE (FPTN=NAME,
       83    13412                          FCG="VM",
       84    13413                          MID="S",
       85    13414                          ERR#=CODE,
       86    13415                          STCLASS=CONSTANT);
       87    13416          %MEND;
       88    13417        /**/
       89    13418          %MACRO PUSH_VALUE (TYPE=511,CPOS=CHARPOS);
       90    13419            VAL_PTR = VAL_PTR + 1;
       91    13420            IF VAL_PTR > %SEL_STACK_SIZE
       92    13421            THEN
       93    13422            DO;                           /* Return error */
       94    13423                VM_SELECT.ERROR = E_STKOVFL;
       95    13424                VM_SELECT.ERR_POS# = CHARPOS;
       96    13425                ALTRETURN;
       97    13426            END;
       98    13427            ELSE
       99    13428            DO;                           /* Stash value, VAL_TYPE and charpos */
      100    13429                VAL_STACK$(VAL_PTR) = VALUE$;
      101    13430                VAL_TYPE(VAL_PTR) = TYPE;
      102    13431                CHARPOS_STACK(VAL_PTR) = CPOS;
      103    13432            END;
      104    13433          %MEND;
      105    13434        /**/
      106    13435        %MACRO PUSH_OPERATOR (NARGS=0);
      107    13436            OP_PTR = OP_PTR + 1;
      108    13437            IF OP_PTR > %SEL_STACK_SIZE
      109    13438            THEN
      110    13439            DO;                           /* Return error */
      111    13440                VM_SELECT.ERROR = E_STKOVFL;
      112    13441                VM_SELECT.ERR_POS# = CHARPOS;
      113    13442                ALTRETURN;
      114    13443            END;
      115    13444            ELSE
      116    13445            DO;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:5    
      117    13446                OP_STACK(OP_PTR) = TOKEN;
      118    13447                NUM_TO_POP_STACK(OP_PTR) = NARGS;
      119    13448            END;
      120    13449        %MEND;
      121    13450        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:6    
      122    13451        /***** Error codes *****/
      123    13452            %ERR_CODE (NAME=E_STKOVFL,CODE=%E$STKOVFL);
      124    13503          /*E*    ERROR: VMS-E$STKOVFL-0
      125    13504                  MESSAGE: Stack overflow. Expression too complex.
      126    13505                  MESSAGE1: Grouping with extra parenthesis may help.
      127    13506          */
      128    13507              %ERR_CODE (NAME=E_NONDECIMAL,CODE=%E$NONDECIMAL);
      129    13558          /*E*    ERROR: VMS-E$NONDECIMAL-0
      130    13559                  MESSAGE: Valid DECIMAL value required here.
      131    13560                  MESSAGE1: The specified value may have been too large to process,
      132    13561           or it may have had illegal characters imbeded.
      133    13562          */
      134    13563              %ERR_CODE (NAME=E_STKFLT,CODE=%E$STKFLT);
      135    13614          /*E*    ERROR: VMS-E$STKFLT-0
      136    13615                  MESSAGE: Evaluation of this expression is not possible.
      137    13616                  MESSAGE1: The expression is meaningless.
      138    13617          */
      139    13618              %ERR_CODE (NAME=E_ILLEGALNULL,CODE=%E$ILLEGALNULL);
      140    13669          /*E*    ERROR: VMS-E$ILLEGALNULL-0
      141    13670                  MESSAGE: Null string not allowed here.
      142    13671        */
      143    13672        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:7    
      144    13673        /*
      145    13674             ***** Precidence array ...
      146    13675        */
      147    13676    1   DCL PRECIDENCE (0:%SEL_OPTAB_SIZE)
      148    13677    1        UBIN CONSTANT INIT (
      149    13678    1        0, 0, 3, 2, 1, 4, 4, 4, 4, 4, 4,
      150    13679    1        99*0);
      151    13680        /*
      152    13681             ***** NUM_TO_POP specifies how many operands an operator
      153    13682                   or function may have. Where a function may have an
      154    13683                   arbirtray number of arguments this table will have
      155    13684                   511. The actual number will be contained in the
      156    13685                   stack NUM_TO_POP_STACK. This stack is parallel to OP_STACK.
      157    13686                   NOTE: The max number of args is determined by the size
      158    13687                         of VAL_STACK$.
      159    13688        */
      160    13689    1   DCL NUM_TO_POP (0:%SEL_OPTAB_SIZE)
      161    13690    1        UBIN CONSTANT INIT (
      162    13691                                                /* Operators */
      163    13692    1        0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
      164    13693                                                /* Functions */
      165    13694    1        0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1);
      166    13695        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:8    
      167    13696    1   LEX: PROC (TOKEN,VALUE$) ALTRET;
      168    13697        /***** Parameters *****/
      169    13698    2   DCL TOKEN UBIN WORD;
      170    13699    2   DCL VALUE$ PTR;
      171    13700        /***** Auto variables *****/
      172    13701    2   DCL NAME$ PTR AUTO;
      173    13702    2       TOKEN_INDX = TOKEN_INDX + 1;
      174    13703    2       IF TOKEN_INDX = TREE$ -> P$B.NSUBLKS
      175    13704    2       THEN                            /* End of the expression */
      176    13705    2           TOKEN = %SEL_END_MARKER;
      177    13706    2       ELSE
      178    13707    3       DO;
      179    13708    3           TOKEN_PTR$ = TREE$->P$B.SUBLK$(TOKEN_INDX);
      180    13709    3           TOKEN = TOKEN_PTR$ -> P$B.CODE; /* Current lexical token */
      181    13710    3           CHARPOS = TOKEN_PTR$ -> P$B.CPOS; /* Charpos of token */
      182    13711    4           DO CASE (TREE$->P$B.SUBLK$(TOKEN_INDX)->P$B.CODE);
      183    13712    4           CASE (%SEL_EXP);
      184    13713    4               CALL VMS$SELECT (TOKEN_PTR$,VM_SELECT,VALUE$) ALTRET(E_LEX);
      185    13714    4           CASE (%SEL_DECIMAL);
      186    13715    4               VALUE$ = TOKEN_PTR$ -> P$S.TEXTC$;
      187    13716    4           CASE (%SEL_QUOTE);
      188    13717    4               VALUE$ = TOKEN_PTR$ -> P$S.TEXTC$;
      189    13718    4               IF VALUE$ -> X$STRING.SIZ = 0
      190    13719    4               THEN             /* Error!!! */
      191    13720    5               DO;
      192    13721    5                   VM_SELECT.ERROR = E_ILLEGALNULL;
      193    13722    5                   VM_SELECT.ERR_POS# = CHARPOS;
      194    13723    5                   ALTRETURN;
      195    13724    5               END;
      196    13725    4           CASE (ELSE);
      197    13726                                                /* Functions, operators */
      198    13727    4           END;                   /* Do case ... end */
      199    13728    3       END;                       /* Do ... end */
      200    13729    2       RETURN;
      201    13730        /**/
      202    13731    2   E_LEX:
      203    13732    2       ALTRETURN;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:9    
      204    13733    2   END LEX;
      205    13734        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:10   
      206    13735    1   GET_ARGS: PROC (NUM_ARGS) ALTRET;
      207    13736        /***** Parameters *****/
      208    13737    2   DCL NUM_ARGS SBIN WORD;
      209    13738        /***** Local variables *****/
      210    13739    2   DCL ARG_INDX SBIN WORD AUTO;
      211    13740    2   DCL ARG_PTR$ PTR AUTO;
      212    13741    2   DCL VALUE$ PTR AUTO;
      213    13742        /**/
      214    13743    2       NUM_ARGS = NUM_TO_POP(TOKEN);
      215    13744    3       DO ARG_INDX = 0 TO TOKEN_PTR$ -> P$B.NSUBLKS - 1;
      216    13745    3           VALUE$ = TOKEN_PTR$ -> P$B.SUBLK$(ARG_INDX);
      217    13746        /*
      218    13747             ***** For the moment, only quote strings (i.e. no expressions)
      219    13748                   are valid arguments to a function ...
      220    13749                   Push pointer to operator, which precedes the value, onto stack
      221    13750        */
      222    13751                %PUSH_VALUE (CPOS="VALUE$ -> P$B.CPOS");
      223    13767    3       END;                            /* Do ARG_INDX ... end */
      224    13768    2   END GET_ARGS;
      225    13769        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:11   
      226    13770    1   REDUCE: PROC ALTRET;
      227    13771        /***** Auto variables *****/
      228    13772    2   DCL STRING$ PTR;
      229    13773    2   DCL TEMP1 SBIN WORD AUTO;
      230    13774    2   DCL DATE1 REDEF TEMP1 UBIN WORD;
      231    13775    2   DCL TEMP2 SBIN WORD AUTO;
      232    13776    2   DCL DATE2 REDEF TEMP2 UBIN WORD;
      233    13777    2   DCL DATE3 UBIN WORD;
      234    13778    2   DCL K UBIN AUTO;
      235    13779        /***** Ptrs *****/
      236    13780    2   DCL VALUE$ PTR AUTO;
      237    13781        /***** Character variables *****/
      238    13782        /***** Constants *****/
      239    13783        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:12   
      240    13784        /***** Initialization *****/
      241    13785    2       VALUE$ = ZERO$;
      242    13786        /*
      243    13787             ***** Make sure that there are enough entries in the
      244    13788                   operand stack for this operator to operate upon ...
      245    13789        */
      246    13790    2       IF NUM_TO_POP_STACK(OP_PTR) > VAL_PTR+1
      247    13791    2       THEN                            /* Stacks are not right */
      248    13792    3       DO;
      249    13793    3           VM_SELECT.ERROR = E_STKFLT;
      250    13794    3           VM_SELECT.ERR_POS# = CHARPOS_STACK(0);
      251    13795    3           GOTO E_REDUCE;
      252    13796    3       END;
      253    13797        /*
      254    13798             ***** Reduce the operator and value stacks as necessary ...
      255    13799        */
      256    13800    3       DO CASE (OP_STACK(OP_PTR));
      257    13801    3       CASE (%SEL_NOT);
      258    13802    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR),TEMP1) ALTRET(E_DEC2);
      259    13803    3           IF TEMP1 > 0
      260    13804    3           THEN
      261    13805    3               VALUE$ = ZERO$;
      262    13806    3           ELSE
      263    13807    3               VALUE$ = ONE$;
      264    13808    3       CASE (%SEL_AND);
      265    13809    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR-1),TEMP1) ALTRET(E_DEC1);
      266    13810    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR),TEMP2) ALTRET(E_DEC2);
      267    13811    3           IF TEMP1 > 0
      268    13812    3             AND TEMP2 > 0
      269    13813    3           THEN
      270    13814    3               VALUE$ = ONE$;
      271    13815    3       CASE (%SEL_OR);
      272    13816    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR-1),TEMP1) ALTRET(E_DEC1);
      273    13817    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR),TEMP2) ALTRET(E_DEC2);
      274    13818    3           IF TEMP1 > 0
      275    13819    3             OR TEMP2 > 0
      276    13820    3           THEN
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:13   
      277    13821    3               VALUE$ = ONE$;
      278    13822    3       CASE (%SEL_ACKNOWLEDGMENT);
      279    13823    3           IF VM_HEADER.STATUS.ACK
      280    13824    3           THEN
      281    13825    3               VALUE$ = ONE$;
      282    13826    3       CASE (%SEL_ANSWER);
      283    13827    3           IF VM_HEADER.STATUS.ANSWER
      284    13828    3           THEN
      285    13829    3               VALUE$ = ONE$;
      286    13830    3       CASE (%SEL_BROADCAST);
      287    13831    3           IF VM_HEADER.STATUS.BROADCAST
      288    13832    3           THEN
      289    13833    3               VALUE$ = ONE$;
      290    13834    3       CASE (%SEL_DATE_RCVD);
      291    13835    3           DATE1 = VM_HEADER.DELIVERY_DATE;
      292    13836    3           GOTO DATE_COMPARER;
      293    13837    3       CASE (%SEL_DATE_SENT);
      294    13838    3           DATE1 = VM_HEADER.CREATION_DATE;
      295    13839    3   DATE_COMPARER:
      296    13840    3           CALL DATE_INIT (VAL_STACK$(VAL_PTR) -> P$B.SUBLK$(0)) ALTRET(E_DATE);
      297    13841    3           K = VAL_STACK$(VAL_PTR)->P$B.SUBLK$(0)->P$B.SCRITCH * %UTS_25TH_MIN#;
      298    13842    3           DATE2 = VAL_STACK$(VAL_PTR)->P$B.SUBLK$(0)->P$B.CPOS;
      299    13843    3           CALL XUD$UTS_ADJ_25TH (DATE3, DATE2, K);
      300    13844    4           DO CASE (VAL_STACK$(VAL_PTR) -> P$B.CODE);
      301    13845    4           CASE (%OPTION_EQ);
      302    13846    4               IF (DATE1 >= DATE2) AND (DATE1 < DATE3)
      303    13847    4               THEN
      304    13848    4                   VALUE$ = ONE$;
      305    13849    4           CASE (%OPTION_NE);
      306    13850    4               IF (DATE1 < DATE2) OR (DATE1 >= DATE3)
      307    13851    4               THEN
      308    13852    4                   VALUE$ = ONE$;
      309    13853    4           CASE (%OPTION_GT);
      310    13854    4               IF DATE1 >= DATE3
      311    13855    4               THEN
      312    13856    4                   VALUE$ = ONE$;
      313    13857    4           CASE (%OPTION_GE);
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:14   
      314    13858    4               IF DATE1 >= DATE2
      315    13859    4               THEN
      316    13860    4                   VALUE$ = ONE$;
      317    13861    4           CASE (%OPTION_LT);
      318    13862    4               IF DATE1 < DATE2
      319    13863    4               THEN
      320    13864    4                   VALUE$ = ONE$;
      321    13865    4           CASE (%OPTION_LE);
      322    13866    4               IF DATE1 < DATE3
      323    13867    4               THEN
      324    13868    4                   VALUE$ = ONE$;
      325    13869    4           END;
      326    13870    3       CASE (%SEL_DELETED);
      327    13871    3           IF VM_HEADER.STATUS.DEL
      328    13872    3           THEN
      329    13873    3               VALUE$ = ONE$;
      330    13874    3       CASE (%SEL_DELIVERY);
      331    13875    3           IF VM_HEADER.STATUS.DELIVERY
      332    13876    3           THEN
      333    13877    3               VALUE$ = ONE$;
      334    13878    3       CASE (%SEL_ERROR);
      335    13879    3           IF VM_HEADER.STATUS.ERR
      336    13880    3           THEN
      337    13881    3               VALUE$ = ONE$;
      338    13882    3       CASE (%SEL_EXAMINED);
      339    13883    3           IF VM_HEADER.STATUS.EXAM
      340    13884    3           THEN
      341    13885    3               VALUE$ = ONE$;
      342    13886    3       CASE (%SEL_FCOPY);
      343    13887    3           IF VM_HEADER.STATUS.FCOPY
      344    13888    3           THEN
      345    13889    3               VALUE$ = ONE$;
      346    13890    3       CASE (%SEL_FROM);
      347    13891    3           STRING$ = VM_HEADER.FROM$;
      348    13892    3           GOTO STRING_COMPARER;
      349    13893    3       CASE (%SEL_FWD);
      350    13894    3           IF VM_HEADER.STATUS.FORWARDED
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:15   
      351    13895    3           THEN
      352    13896    3               VALUE$ = ONE$;
      353    13897    3       CASE (%SEL_MARKED);
      354    13898    3           IF VM_HEADER.STATUS.MARK
      355    13899    3           THEN
      356    13900    3               VALUE$ = ONE$;
      357    13901    3       CASE (%SEL_NEW);
      358    13902    3           IF VM_HEADER.STATUS.OLD = %NO#
      359    13903    3           THEN
      360    13904    3               VALUE$ = ONE$;
      361    13905    3       CASE (%SEL_OLD);
      362    13906    3           IF VM_HEADER.STATUS.OLD
      363    13907    3           THEN
      364    13908    3               VALUE$ = ONE$;
      365    13909    3       CASE (%SEL_REFERENCE);
      366    13910    3           STRING$ = VM_HEADER.REFERENCE$;
      367    13911    3           GOTO STRING_COMPARER;
      368    13912    3       CASE (%SEL_REPLY_TO);
      369    13913    3           STRING$ = VM_HEADER.REPLY_TO$;
      370    13914    3           GOTO STRING_COMPARER;
      371    13915    3       CASE (%SEL_RR);
      372    13916    3           IF VM_HEADER.STATUS.RRACK
      373    13917    3           THEN
      374    13918    3               VALUE$ = ONE$;
      375    13919    3       CASE (%SEL_SUBJECT);
      376    13920    3           STRING$ = VM_HEADER.SUBJECT$;
      377    13921    3           GOTO STRING_COMPARER;
      378    13922    3       CASE (%SEL_TO);
      379    13923    3           STRING$ = VM_HEADER.TO$;
      380    13924    3   STRING_COMPARER:
      381    13925    3           IF STRING$ = ADDR(NIL)
      382    13926    3           THEN                       /* Cannot make this comparison */
      383    13927    3               GOTO NO_MATCH;
      384    13928    3           IF STRING$ -> X$STRING.SIZ = 0
      385    13929    3           THEN                       /* Cannot make this comparison */
      386    13930    3               GOTO NO_MATCH;
      387    13931    3           CALL XLATE (WORK1.NAME#,LOWER_UPPER,VAL_STACK$(VAL_PTR) ->
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:16   
      388    13932    3             P$B.SUBLK$(0) -> P$S.TEXT);
      389    13933    3           WORK1.L# = VAL_STACK$(VAL_PTR) -> P$B.SUBLK$(0) -> P$S.COUNT;
      390    13934    3           CALL XLATE (SUBSTR(WORK2.NAME#,2),LOWER_UPPER,STRING$ ->X$STRING.TEXT);
      391    13935    3           SUBSTR(WORK2.NAME#,0,2) = '. '; /* dummy word to reserve two spaces */
      392    13936    3           WORK2.L# = LENGTHC(WORK2.NAME#);
      393    13937    3           CALL VMA$COMPRESS_BLANKS (ADDR(WORK2));
      394    13938    3           IF WORK2.L# < 2 THEN          /* Cannot make this comparison */
      395    13939    3               GOTO NO_MATCH;
      396    13940    3           WORK2.L# = WORK2.L# + 2; /* add two spaces at end, too */
      397    13941    3           SUBSTR(WORK2.NAME#,0,1) = ' '; /* start with two spaces */
      398    13942    3           VM_WILDCARD.PATTERN_ = VECTOR(SUBSTR(WORK1.NAME#,0,WORK1.L#));
      399    13943    3           VM_WILDCARD.INPUT_ = VECTOR(SUBSTR(WORK2.NAME#,0,WORK2.L#));
      400    13944    3           CALL X$WILDCMP (VM_WILDCARD)
      401    13945    3           WHENRETURN
      402    13946    4           DO;
      403    13947    4               IF VAL_STACK$(VAL_PTR) -> P$B.CODE = %OPTION_EQ THEN
      404    13948    4                   VALUE$ = ONE$;
      405    13949    4               ELSE
      406    13950    4                   VALUE$ = ZERO$;
      407    13951    4           END;
      408    13952    3           WHENALTRETURN
      409    13953    4           DO;
      410    13954    4   NO_MATCH:
      411    13955    4               IF VAL_STACK$(VAL_PTR) -> P$B.CODE = %OPTION_NE THEN
      412    13956    4                   VALUE$ = ONE$;
      413    13957    4               ELSE
      414    13958    4                   VALUE$ = ZERO$;
      415    13959    4           END;
      416    13960    3       CASE (%SEL_UNEXAMINED);
      417    13961    3           IF VM_HEADER.STATUS.EXAM = %NO#
      418    13962    3           THEN
      419    13963    3               VALUE$ = ONE$;
      420    13964    3       CASE (ELSE);
      421    13965    3       END;                             /* Do case ... end */
      422    13966        /*
      423    13967             ***** Reduce the value stack...
      424    13968        */
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:17   
      425    13969    2       VAL_PTR = VAL_PTR - NUM_TO_POP_STACK(OP_PTR);
      426    13970        /*
      427    13971             ***** Push the result of this reduction
      428    13972                   onto the value stack (VAL_STACK$) ...
      429    13973        */
      430    13974            %PUSH_VALUE;
      431    13990        /*
      432    13991             ***** Remove the reduced operator from
      433    13992                   the operator stack (OP_STK) ...
      434    13993        */
      435    13994    2       OP_PTR = OP_PTR - 1;
      436    13995    2       RETURN;
      437    13996        /**/
      438    13997    2   E_REDUCE:
      439    13998    2       ALTRETURN;
      440    13999        /**/
      441    14000    2   E_DATE:
      442    14001    2       VM_SELECT.ERROR = B$TCB.ALT$->B$ALT.ERR;
      443    14002    2       VM_SELECT.ERR_POS# = CHARPOS_STACK(VAL_PTR);
      444    14003    2       ALTRETURN;
      445    14004    2   E_DEC1:
      446    14005    2       VM_SELECT.ERROR = E_NONDECIMAL;
      447    14006    2       VM_SELECT.ERR_POS# = CHARPOS_STACK(VAL_PTR-1);
      448    14007    2       ALTRETURN;
      449    14008        /**/
      450    14009    2   E_DEC2:
      451    14010    2       VM_SELECT.ERROR = E_NONDECIMAL;
      452    14011    2       VM_SELECT.ERR_POS# = CHARPOS_STACK(VAL_PTR);
      453    14012    2       ALTRETURN;
      454    14013    2   END REDUCE;
      455    14014        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:18   
      456    14015    1   DATE_INIT: PROC (OUT$) ALTRET;
      457    14016        /***** Parameters *****/
      458    14017    2   DCL OUT$ PTR;
      459    14018        /***** Local Variables *****/
      460    14019    2   DCL P$ PTR;
      461    14020    2   DCL I SBIN;
      462    14021    2   DCL J SBIN;
      463    14022    2   DCL 1 WORK_DATE,
      464    14023    2         2 MONTH CHAR(2),
      465    14024    2         2 * CHAR(1),
      466    14025    2         2 DAY CHAR(2),
      467    14026    2         2 * CHAR(1),
      468    14027    2         2 YEAR CHAR(2);
      469    14028    2   DCL 1 WORK_TIME,
      470    14029    2         2 HOUR CHAR(2),
      471    14030    2         2 * CHAR(1),
      472    14031    2         2 MIN CHAR(2);
      473    14032    2   DCL WORK_TIMEC REDEF WORK_TIME CHAR(5);
      474    14033    2   DCL INIT_TIMEC CHAR(5) CONSTANT INIT('00:00');
      475    14034
      476    14035        %FPT_TIME (FPTN=FPT_TIME_C, STCLASS=CONSTANT,
      477    14036                   SOURCE=CLOCK,
      478    14037                   DEST=LOCAL);
      479    14056        %FPT_TIME (FPTN=FPT_TIME, STCLASS=AUTO);
      480    14075        /*
      481    14076                If the timestamp has been initialized, P$B.SCRITCH has been
      482    14077                set to the resolution of the timestamp (in minutes), and
      483    14078                P$B.CPOS has been replaced with the UTS for the timestamp.
      484    14079        */
      485    14080    2       IF OUT$ -> P$B.SCRITCH > 0
      486    14081    2       THEN
      487    14082    2           RETURN;
      488    14083        /*
      489    14084                Start with current date, time of midnight.
      490    14085        */
      491    14086    2       FPT_TIME = FPT_TIME_C;
      492    14087    2       FPT_TIME.V_ = VECTOR(FPT_TIME.V);
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:19   
      493    14088    2       FPT_TIME.DATE_ = VECTOR(WORK_DATE);
      494    14089    2       CALL M$TIME (FPT_TIME);
      495    14090    2       WORK_TIMEC = INIT_TIMEC;
      496    14091        /*
      497    14092                Setup to get timestamp specified for nodes.
      498    14093        */
      499    14094    2       FPT_TIME.V.SOURCE# = %LOCAL#;
      500    14095    2       FPT_TIME.V.DEST# = %UTS#;
      501    14096    2       FPT_TIME.TSTAMP_ = VECTOR(OUT$ -> P$B.CPOS);
      502    14097    2       OUT$ -> P$B.SCRITCH = %MINS_PER_DAY;
      503    14098    3       DO I = OUT$ -> P$B.NSUBLKS - 1 DOWNTO 0;
      504    14099    3           P$ = OUT$ -> P$B.SUBLK$(I);
      505    14100    4           DO CASE (P$ -> P$B.CODE);
      506    14101    4           CASE (%OPTION_DATE);
      507    14102    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(0) -> P$S.TEXT);
      508    14103    4               CALL BINCHAR(WORK_DATE.MONTH, J);
      509    14104    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(1) -> P$S.TEXT);
      510    14105    4               CALL BINCHAR (WORK_DATE.DAY, J);
      511    14106    4               IF P$ -> P$B.NSUBLKS = 3
      512    14107    5               THEN DO;         /* A year specified */
      513    14108    5                   CALL CHARBIN (J, P$ -> P$B.SUBLK$(2) -> P$S.TEXT);
      514    14109    5                   CALL BINCHAR (WORK_DATE.YEAR, J);
      515    14110    5               END;
      516    14111    4           CASE (%OPTION_TIME);
      517    14112    4               OUT$ -> P$B.SCRITCH = 1;
      518    14113    4               FPT_TIME.TIME_ = VECTOR(WORK_TIME);
      519    14114    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(0) -> P$S.TEXT);
      520    14115    4               CALL BINCHAR (WORK_TIME.HOUR, J);
      521    14116    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(1) -> P$S.TEXT);
      522    14117    4               CALL BINCHAR (WORK_TIME.MIN, J);
      523    14118    4           END;
      524    14119    3       END;
      525    14120        /*
      526    14121              ***** Now convert the timestamp into a uts ...
      527    14122        */
      528    14123    2       CALL M$TIME (FPT_TIME) ALTRET(BAD_TIME);
      529    14124    2       RETURN;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:20   
      530    14125
      531    14126    2   BAD_TIME: ;
      532    14127    2       ALTRETURN;
      533    14128    2   END DATE_INIT;
      534    14129        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:21   
      535    14130        /*
      536    14131             ***** Main routine for evaluating expressions.
      537    14132                   Handles stacking/reduction decisions and
      538    14133                   calls such routines as needed to perform
      539    14134                   reduction and lexical analysis.
      540    14135                   This routine is called recursively...
      541    14136        */
      542    14137    1       OP_PTR = 0;
      543    14138    1       VAL_PTR = -1;
      544    14139    1       OP_STACK(0) = %SEL_BEGIN_MARKER;
      545    14140    1       TOKEN_INDX = -1;
      546    14141        /*
      547    14142             ***** Get the first token to start processing ...
      548    14143        */
      549    14144    1       CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);
      550    14145        /*
      551    14146             ***** Main LOOP...
      552    14147                   Loop here while there are operators to process...
      553    14148        */
      554    14149    2       DO WHILE (%YES#);
      555    14150    3           DO CASE (TOKEN);
      556    14151    3           CASE (%SEL_DECIMAL,
      557    14152    3             %SEL_EXP,
      558    14153    3             %SEL_QUOTE);
      559    14154                    %PUSH_VALUE;
      560    14170    3               CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);
      561    14171    3           CASE (%SEL_END_MARKER);
      562    14172    4               DO WHILE (%YES#);
      563    14173    4                   IF OP_STACK(OP_PTR) = %SEL_BEGIN_MARKER
      564    14174    4                   THEN
      565    14175    5                   DO;
      566    14176    5                       RESULT$ = VAL_STACK$(VAL_PTR);
      567    14177    5                       RETURN;
      568    14178    5                   END;
      569    14179    4                   ELSE
      570    14180    4                       CALL REDUCE ALTRET(E_EVAL);
      571    14181    4               END;                  /* Shrink stacks loop                 */
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:22   
      572    14182    3           CASE (%SEL_AND,
      573    14183    3                 %SEL_OR,
      574    14184    3                 %SEL_NOT,
      575    14185    3                 %SEL_EQUAL,
      576    14186    3                 %SEL_NEQUAL,
      577    14187    3                 %SEL_GTHAN,
      578    14188    3                 %SEL_GEQUAL,
      579    14189    3                 %SEL_LTHAN,
      580    14190    3                 %SEL_LEQUAL);
      581    14191    3               MORE# = %YES#;
      582    14192    4               DO WHILE (MORE#);
      583    14193        /*
      584    14194             ***** Decide whether to stack or reduce ...
      585    14195        */
      586    14196    4                   IF PRECIDENCE(TOKEN) > PRECIDENCE(OP_STACK(OP_PTR))
      587    14197    4                   THEN
      588    14198    5                   DO;
      589    14199                            %PUSH_OPERATOR (NARGS="NUM_TO_POP(TOKEN)");
      590    14214    5                       MORE# = %NO#;
      591    14215    5                       CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);
      592    14216    5                   END;
      593    14217    4                   ELSE             /* Reduce                             */
      594    14218    4                       CALL REDUCE ALTRET(E_EVAL);
      595    14219    4               END;                  /* Do while (MORE#) ... end */
      596    14220    3           CASE (ELSE);
      597    14221        /*
      598    14222             ***** Built-in functions ...
      599    14223        */
      600    14224    3               MORE# = %YES#;
      601    14225    4               DO WHILE (MORE#);
      602    14226        /*
      603    14227             ***** If this is a function with arguments,
      604    14228                   then get those args onto the VAL_STACK$ ...
      605    14229        */
      606    14230    4                   NUM_ARGS = 0;
      607    14231    4                   IF NUM_TO_POP(TOKEN) > 0
      608    14232    4                   THEN        /* Get the arguments for this function     */
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:23   
      609    14233    4                       CALL GET_ARGS (NUM_ARGS) ALTRET(E_EVAL);
      610    14234        /*
      611    14235             ***** Since functions have the highest precidence,
      612    14236                   they are always applied as soon as found ...
      613    14237        */
      614    14238                        %PUSH_OPERATOR (NARGS="NUM_ARGS");
      615    14253    4                   MORE# = %NO#;
      616    14254    4                   CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);
      617    14255    4               END;                  /* Do while (MORE#) ... end */
      618    14256    3           END;                        /* Do case ... end */
      619    14257    2       END;                            /* Do while (yes) ... end */
      620    14258    1   E_EVAL:
      621    14259    1       ALTRETURN;
      622    14260    1   END VMS$SELECT;
      623    14261        %EOD;

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:24   
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   XUD_UTS_M.:LIB_E05  is referenced.
   XUW_MACRO_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMS$SELECT.

   Procedure VMS$SELECT requires 875 words for executable code.
   Procedure VMS$SELECT requires 510 words of local(AUTO) storage.

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:25   

 Object Unit name= VMS$SELECT                                 File name= VMS$SELECT.:VMB6TOU
 UTS= AUG 20 '97 15:24:55.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11  RoData even  UTS     93    135  VMS$SELECT
   12   Data  even  none    12     14  VMS$SELECT
   13   Proc  even  none   875   1553  VMS$SELECT
   14  RoData even  none     9     11  VMS$SELECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes    yes     yes      Std        3  VMS$SELECT
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:26   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       2 X$DEC_CONVERT
 yes     yes           Std       3 XUD$UTS_ADJ_25TH
         yes           Std       1 VMA$COMPRESS_BLANKS
 yes     yes           Std       1 X$WILDCMP
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                 r    B$XL_UPPER$
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:27   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:28   


        1        1        /*M* VMS$SELECT - Routines to evaluate SELECTION CRITERIA for messages. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8        /*F*    NAME:          VMS$SELECT
        9        9                PURPOSE:       To evaluate MAIL selection criteria expressions.
       10       10                DESCRIPTION:   This RECURSIVE routine uses operator
       11       11                               precedence to parse expressions.
       12       12        */
       13       13        VMS$SELECT: PROC (TREE$,VM_SELECT,RESULT$) ALTRET;

     13 13 000000   000000 700200 xent  VMS$SELECT   TSX0  ! X66_AUTO_3
        13 000001   000776 000003                    ZERO    510,3
        13 000002   001314 710000 13                 TRA     s:14137

       14       14        /***** Include files *****/
       15       15          %INCLUDE CP_6;
       16     5574          %INCLUDE CP_6_SUBS;
       17     6114          %INCLUDE B_ERRORS_C;
       18     7241          %INCLUDE XU_MACRO_C;
       19    10347          %INCLUDE XUW_MACRO_C;
       20    10482        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:29   
       21    10483
       22    10484        /***** Local Equates *****/
       23    10485        %INCLUDE XUD_UTS_M;
       24    10567             %XUD$UTS_ENTRIES;
       25    10599             %XUD_UTS_EQU;
       26    10610        %EQU MINS_PER_DAY = 1440;
       27    10611          %INCLUDE VM_PERR_C;
       28    10906          %INCLUDE VM_MACRO_C;
       29    12174          %INCLUDE VM_SUBS_C;
       30    12434          %INCLUDE VM_DATA_R;
       31    12865            %include B$TABLES_C;
       32    12973             %B$XL_UPPER(NAME=LOWER_UPPER);
       33    12977        /***** Parameters *****/
       34    12978    1   DCL TREE$ PTR;
       35    12979          %VM_SELECT (NAME=VM_SELECT,STCLASS=" ");
       36    13000    1   DCL RESULT$ PTR;
       37    13001        /***** Based structures *****/
       38    13002          %PARSE$OUT (NAME=P$B,STCLASS=BASED);
       39    13047          %PARSE$SYM (NAME=P$S,STCLASS=BASED);
       40    13085          %VM_HEADER;
       41    13214          %B$TCB(STCLASS="BASED(B$TCB$)");
       42    13217          %B$ALT;
       43    13225        /***** Ptr variables *****/
       44    13226    1   DCL VALUE$ PTR AUTO;
       45    13227    1   DCL TOKEN_PTR$ PTR AUTO;
       46    13228        /***** Word/array variables *****/
       47    13229    1   DCL MORE# BIT(1) AUTO;
       48    13230    1   DCL CHARPOS UBIN WORD AUTO;
       49    13231    1   DCL OP_PTR SBIN WORD AUTO;
       50    13232    1   DCL VAL_PTR SBIN WORD AUTO;
       51    13233    1   DCL NUM_ARGS SBIN WORD AUTO;
       52    13234    1   DCL TOKEN_INDX SBIN WORD AUTO;
       53    13235    1   DCL TOKEN UBIN WORD AUTO;
       54    13236        /***** Character variables *****/
       55    13237          %VLP_NAME (FPTN=WORK1,LEN=511,STCLASS=AUTO);
       56    13264          %VLP_NAME (FPTN=WORK2,LEN=511,STCLASS=AUTO);
       57    13291        /***** Stacks *****/
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:30   
       58    13292    1   DCL OP_STACK (0:%SEL_STACK_SIZE) UBIN AUTO;
       59    13293    1   DCL NUM_TO_POP_STACK (0:%SEL_STACK_SIZE) UBIN AUTO;
       60    13294    1   DCL VAL_STACK$ (0:%(SEL_STACK_SIZE*2)) PTR AUTO;
       61    13295    1   DCL VAL_TYPE (0:%(SEL_STACK_SIZE*2)) UBIN AUTO;
       62    13296    1   DCL CHARPOS_STACK (0:%(SEL_STACK_SIZE*2)) UBIN HALF AUTO;
       63    13297        /***** Constants *****/
       64    13298    1   DCL ZERO$ PTR CONSTANT INIT (ADDR(ZERO));
       65    13299    1   DCL 1  ZERO CONSTANT,
       66    13300    1         2  COUNT UBIN BYTE UNAL INIT (1),
       67    13301    1         2  TEXT CHAR(1) UNAL INIT('0');
       68    13302    1   DCL ONE$ PTR CONSTANT INIT (ADDR(ONE));
       69    13303    1   DCL 1  ONE CONSTANT,
       70    13304    1         2  COUNT UBIN BYTE UNAL INIT (1),
       71    13305    1         2  TEXT CHAR(1) UNAL INIT('1');
       72    13306        /***** External routines *****/
       73    13307    1   DCL X$DEC_CONVERT ENTRY(2) ALTRET;
       74    13308    1   DCL X$STRIP_BLANKS ENTRY(1);
       75    13309    1   DCL VMA$COMPRESS_BLANKS ENTRY(1);
       76    13310    1   DCL X$WILDCMP ENTRY(1) ALTRET;
       77    13311        /***** Fpts *****/
       78    13312          %XUW_WILDCARD (FPTN=VM_WILDCARD,STCLASS=STATIC,CONTAINS=YES);
       79    13408        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:31   
       80    13409        /***** Macros *****/
       81    13410          %MACRO ERR_CODE (NAME=JUNK,CODE=0,SEV=0);
       82    13411            %VLP_ERRCODE (FPTN=NAME,
       83    13412                          FCG="VM",
       84    13413                          MID="S",
       85    13414                          ERR#=CODE,
       86    13415                          STCLASS=CONSTANT);
       87    13416          %MEND;
       88    13417        /**/
       89    13418          %MACRO PUSH_VALUE (TYPE=511,CPOS=CHARPOS);
       90    13419            VAL_PTR = VAL_PTR + 1;
       91    13420            IF VAL_PTR > %SEL_STACK_SIZE
       92    13421            THEN
       93    13422            DO;                           /* Return error */
       94    13423                VM_SELECT.ERROR = E_STKOVFL;
       95    13424                VM_SELECT.ERR_POS# = CHARPOS;
       96    13425                ALTRETURN;
       97    13426            END;
       98    13427            ELSE
       99    13428            DO;                           /* Stash value, VAL_TYPE and charpos */
      100    13429                VAL_STACK$(VAL_PTR) = VALUE$;
      101    13430                VAL_TYPE(VAL_PTR) = TYPE;
      102    13431                CHARPOS_STACK(VAL_PTR) = CPOS;
      103    13432            END;
      104    13433          %MEND;
      105    13434        /**/
      106    13435        %MACRO PUSH_OPERATOR (NARGS=0);
      107    13436            OP_PTR = OP_PTR + 1;
      108    13437            IF OP_PTR > %SEL_STACK_SIZE
      109    13438            THEN
      110    13439            DO;                           /* Return error */
      111    13440                VM_SELECT.ERROR = E_STKOVFL;
      112    13441                VM_SELECT.ERR_POS# = CHARPOS;
      113    13442                ALTRETURN;
      114    13443            END;
      115    13444            ELSE
      116    13445            DO;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:32   
      117    13446                OP_STACK(OP_PTR) = TOKEN;
      118    13447                NUM_TO_POP_STACK(OP_PTR) = NARGS;
      119    13448            END;
      120    13449        %MEND;
      121    13450        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:33   
      122    13451        /***** Error codes *****/
      123    13452            %ERR_CODE (NAME=E_STKOVFL,CODE=%E$STKOVFL);
      124    13503          /*E*    ERROR: VMS-E$STKOVFL-0
      125    13504                  MESSAGE: Stack overflow. Expression too complex.
      126    13505                  MESSAGE1: Grouping with extra parenthesis may help.
      127    13506          */
      128    13507              %ERR_CODE (NAME=E_NONDECIMAL,CODE=%E$NONDECIMAL);
      129    13558          /*E*    ERROR: VMS-E$NONDECIMAL-0
      130    13559                  MESSAGE: Valid DECIMAL value required here.
      131    13560                  MESSAGE1: The specified value may have been too large to process,
      132    13561           or it may have had illegal characters imbeded.
      133    13562          */
      134    13563              %ERR_CODE (NAME=E_STKFLT,CODE=%E$STKFLT);
      135    13614          /*E*    ERROR: VMS-E$STKFLT-0
      136    13615                  MESSAGE: Evaluation of this expression is not possible.
      137    13616                  MESSAGE1: The expression is meaningless.
      138    13617          */
      139    13618              %ERR_CODE (NAME=E_ILLEGALNULL,CODE=%E$ILLEGALNULL);
      140    13669          /*E*    ERROR: VMS-E$ILLEGALNULL-0
      141    13670                  MESSAGE: Null string not allowed here.
      142    13671        */
      143    13672        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:34   
      144    13673        /*
      145    13674             ***** Precidence array ...
      146    13675        */
      147    13676    1   DCL PRECIDENCE (0:%SEL_OPTAB_SIZE)
      148    13677    1        UBIN CONSTANT INIT (
      149    13678    1        0, 0, 3, 2, 1, 4, 4, 4, 4, 4, 4,
      150    13679    1        99*0);
      151    13680        /*
      152    13681             ***** NUM_TO_POP specifies how many operands an operator
      153    13682                   or function may have. Where a function may have an
      154    13683                   arbirtray number of arguments this table will have
      155    13684                   511. The actual number will be contained in the
      156    13685                   stack NUM_TO_POP_STACK. This stack is parallel to OP_STACK.
      157    13686                   NOTE: The max number of args is determined by the size
      158    13687                         of VAL_STACK$.
      159    13688        */
      160    13689    1   DCL NUM_TO_POP (0:%SEL_OPTAB_SIZE)
      161    13690    1        UBIN CONSTANT INIT (
      162    13691                                                /* Operators */
      163    13692    1        0, 0, 1, 2, 2, 2, 2, 2, 2, 2, 2,
      164    13693                                                /* Functions */
      165    13694    1        0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1);
      166    13695        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:35   
      167    13696    1   LEX: PROC (TOKEN,VALUE$) ALTRET;

  13696 13 000003   200734 741300       LEX          STX1  ! CHARPOS_STACK+51,,AUTO

      168    13697        /***** Parameters *****/
      169    13698    2   DCL TOKEN UBIN WORD;
      170    13699    2   DCL VALUE$ PTR;
      171    13700        /***** Auto variables *****/
      172    13701    2   DCL NAME$ PTR AUTO;
      173    13702    2       TOKEN_INDX = TOKEN_INDX + 1;

  13702 13 000004   200015 054100                    AOS     TOKEN_INDX,,AUTO

      174    13703    2       IF TOKEN_INDX = TREE$ -> P$B.NSUBLKS

  13703 13 000005   200003 470500                    LDP0    @TREE$,,AUTO
        13 000006   000000 471500                    LDP1    0,,PR0
        13 000007   100001 236100                    LDQ     1,,PR1
        13 000010   000022 772000                    QRL     18
        13 000011   200015 116100                    CMPQ    TOKEN_INDX,,AUTO
        13 000012   000017 601000 13                 TNZ     s:13708

      175    13704    2       THEN                            /* End of the expression */
      176    13705    2           TOKEN = %SEL_END_MARKER;

  13705 13 000013   000001 235007                    LDA     1,DL
        13 000014   200735 473500                    LDP3    @TOKEN,,AUTO
        13 000015   300000 755100                    STA     0,,PR3
        13 000016   000104 710000 13                 TRA     s:13729

      177    13706    2       ELSE
      178    13707    3       DO;

      179    13708    3           TOKEN_PTR$ = TREE$->P$B.SUBLK$(TOKEN_INDX);

  13708 13 000017   200015 720100                    LXL0    TOKEN_INDX,,AUTO
        13 000020   100003 236110                    LDQ     3,X0,PR1
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:36   
        13 000021   200007 756100                    STQ     TOKEN_PTR$,,AUTO

      180    13709    3           TOKEN = TOKEN_PTR$ -> P$B.CODE; /* Current lexical token */

  13709 13 000022   200007 471500                    LDP1    TOKEN_PTR$,,AUTO
        13 000023   100000 236100                    LDQ     0,,PR1
        13 000024   777777 376007                    ANQ     -1,DL
        13 000025   200735 473500                    LDP3    @TOKEN,,AUTO
        13 000026   300000 756100                    STQ     0,,PR3

      181    13710    3           CHARPOS = TOKEN_PTR$ -> P$B.CPOS; /* Charpos of token */

  13710 13 000027   200007 471500                    LDP1    TOKEN_PTR$,,AUTO
        13 000030   100002 235100                    LDA     2,,PR1
        13 000031   200011 755100                    STA     CHARPOS,,AUTO

      182    13711    4           DO CASE (TREE$->P$B.SUBLK$(TOKEN_INDX)->P$B.CODE);

  13711 13 000032   000000 474500                    LDP4    0,,PR0
        13 000033   400003 475510                    LDP5    3,X0,PR4
        13 000034   500000 236100                    LDQ     0,,PR5
        13 000035   777777 376007                    ANQ     -1,DL
        13 000036   000036 136007                    SBLQ    30,DL
        13 000037   000003 116007                    CMPQ    3,DL
        13 000040   000042 602006 13                 TNC     s:13711+8,QL
        13 000041   000104 710000 13                 TRA     s:13729
        13 000042   000045 710000 13                 TRA     s:13713
        13 000043   000060 710000 13                 TRA     s:13715
        13 000044   000064 710000 13                 TRA     s:13717

      183    13712    4           CASE (%SEL_EXP);

      184    13713    4               CALL VMS$SELECT (TOKEN_PTR$,VM_SELECT,VALUE$) ALTRET(E_LEX);

  13713 13 000045   200736 236100                    LDQ     @VALUE$,,AUTO
        13 000046   200774 756100                    STQ     FPT_TIME+14,,AUTO
        13 000047   200004 236100                    LDQ     @VM_SELECT,,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:37   
        13 000050   200773 756100                    STQ     FPT_TIME+13,,AUTO
        13 000051   200007 634500                    EPPR4   TOKEN_PTR$,,AUTO
        13 000052   200772 454500                    STP4    FPT_TIME+12,,AUTO
        13 000053   200772 630500                    EPPR0   FPT_TIME+12,,AUTO
        13 000054   000000 631400 14                 EPPR1   0
        13 000055   000000 701000 13                 TSX1    s:13
        13 000056   000106 702000 13                 TSX2    E_LEX
        13 000057   000104 710000 13                 TRA     s:13729

      185    13714    4           CASE (%SEL_DECIMAL);

      186    13715    4               VALUE$ = TOKEN_PTR$ -> P$S.TEXTC$;

  13715 13 000060   100003 236100                    LDQ     3,,PR1
        13 000061   200736 476500                    LDP6    @VALUE$,,AUTO
        13 000062   600000 756100                    STQ     0,,PR6
        13 000063   000104 710000 13                 TRA     s:13729

      187    13716    4           CASE (%SEL_QUOTE);

      188    13717    4               VALUE$ = TOKEN_PTR$ -> P$S.TEXTC$;

  13717 13 000064   100003 236100                    LDQ     3,,PR1
        13 000065   200736 476500                    LDP6    @VALUE$,,AUTO
        13 000066   600000 756100                    STQ     0,,PR6

      189    13718    4               IF VALUE$ -> X$STRING.SIZ = 0

  13718 13 000067   600000 471500                    LDP1    0,,PR6
        13 000070   000100 101500                    MRL     fill='000'O
        13 000071   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000072   200772 000004                    ADSC9   FPT_TIME+12,,AUTO        cn=0,n=4
        13 000073   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 000074   000000 116003                    CMPQ    0,DU
        13 000075   000104 601000 13                 TNZ     s:13729

      190    13719    4               THEN             /* Error!!! */
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:38   
      191    13720    5               DO;

      192    13721    5                   VM_SELECT.ERROR = E_ILLEGALNULL;

  13721 13 000076   000007 236000 11                 LDQ     E_ILLEGALNULL
        13 000077   200004 471500                    LDP1    @VM_SELECT,,AUTO
        13 000100   100000 756100                    STQ     0,,PR1

      193    13722    5                   VM_SELECT.ERR_POS# = CHARPOS;

  13722 13 000101   100001 755100                    STA     1,,PR1

      194    13723    5                   ALTRETURN;

  13723 13 000102   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 000103   000000 702211                    TSX2  ! 0,X1

      195    13724    5               END;
      196    13725    4           CASE (ELSE);

      197    13726                                                /* Functions, operators */
      198    13727    4           END;                   /* Do case ... end */

      199    13728    3       END;                       /* Do ... end */
      200    13729    2       RETURN;

  13729 13 000104   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 000105   000001 702211                    TSX2  ! 1,X1

      201    13730        /**/
      202    13731    2   E_LEX:
      203    13732    2       ALTRETURN;

  13732 13 000106   200734 221300       E_LEX        LDX1  ! CHARPOS_STACK+51,,AUTO
        13 000107   000000 702211                    TSX2  ! 0,X1

      204    13733    2   END LEX;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:39   
      205    13734        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:40   
      206    13735    1   GET_ARGS: PROC (NUM_ARGS) ALTRET;

  13735 13 000110   200734 741300       GET_ARGS     STX1  ! CHARPOS_STACK+51,,AUTO

      207    13736        /***** Parameters *****/
      208    13737    2   DCL NUM_ARGS SBIN WORD;
      209    13738        /***** Local variables *****/
      210    13739    2   DCL ARG_INDX SBIN WORD AUTO;
      211    13740    2   DCL ARG_PTR$ PTR AUTO;
      212    13741    2   DCL VALUE$ PTR AUTO;
      213    13742        /**/
      214    13743    2       NUM_ARGS = NUM_TO_POP(TOKEN);

  13743 13 000111   200016 720100                    LXL0    TOKEN,,AUTO
        13 000112   000053 235010 11                 LDA     NUM_TO_POP,X0
        13 000113   200735 470500                    LDP0    @NUM_ARGS,,AUTO
        13 000114   000000 755100                    STA     0,,PR0

      215    13744    3       DO ARG_INDX = 0 TO TOKEN_PTR$ -> P$B.NSUBLKS - 1;

  13744 13 000115   200736 450100                    STZ     ARG_INDX,,AUTO
        13 000116   000146 710000 13                 TRA     s:13767+1

      216    13745    3           VALUE$ = TOKEN_PTR$ -> P$B.SUBLK$(ARG_INDX);

  13745 13 000117   200007 470500                    LDP0    TOKEN_PTR$,,AUTO
        13 000120   200736 720100                    LXL0    ARG_INDX,,AUTO
        13 000121   000003 236110                    LDQ     3,X0,PR0
        13 000122   200740 756100                    STQ     VALUE$,,AUTO

      217    13746        /*
      218    13747             ***** For the moment, only quote strings (i.e. no expressions)
      219    13748                   are valid arguments to a function ...
      220    13749                   Push pointer to operator, which precedes the value, onto stack
      221    13750        */
      222    13751                %PUSH_VALUE (CPOS="VALUE$ -> P$B.CPOS");

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:41   
  13752 13 000123   200013 054100                    AOS     VAL_PTR,,AUTO

  13753 13 000124   200013 235100                    LDA     VAL_PTR,,AUTO
        13 000125   000031 115007                    CMPA    25,DL
        13 000126   000136 604400 13                 TMOZ    s:13762

  13756 13 000127   000004 236000 11                 LDQ     E_STKOVFL
        13 000130   200004 471500                    LDP1    @VM_SELECT,,AUTO
        13 000131   100000 756100                    STQ     0,,PR1

  13757 13 000132   200011 235100                    LDA     CHARPOS,,AUTO
        13 000133   100001 755100                    STA     1,,PR1

  13758 13 000134   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 000135   000000 702211                    TSX2  ! 0,X1

  13762 13 000136   200503 756105                    STQ     VAL_STACK$,AL,AUTO

  13763 13 000137   000777 235007                    LDA     511,DL
        13 000140   200013 721100                    LXL1    VAL_PTR,,AUTO
        13 000141   200566 755111                    STA     VAL_TYPE,X1,AUTO

  13764 13 000142   200740 470500                    LDP0    VALUE$,,AUTO
        13 000143   000002 722100                    LXL2    2,,PR0
        13 000144   200651 742111                    STX2    CHARPOS_STACK,X1,AUTO

      223    13767    3       END;                            /* Do ARG_INDX ... end */

  13767 13 000145   200736 054100                    AOS     ARG_INDX,,AUTO
        13 000146   200007 470500                    LDP0    TOKEN_PTR$,,AUTO
        13 000147   000001 236100                    LDQ     1,,PR0
        13 000150   000022 772000                    QRL     18
        13 000151   200736 116100                    CMPQ    ARG_INDX,,AUTO
        13 000152   000117 605400 13                 TPNZ    s:13745

      224    13768    2   END GET_ARGS;

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:42   
  13768 13 000153   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 000154   000001 702211                    TSX2  ! 1,X1

      225    13769        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:43   
      226    13770    1   REDUCE: PROC ALTRET;

  13770 13 000155   200734 741300       REDUCE       STX1  ! CHARPOS_STACK+51,,AUTO

      227    13771        /***** Auto variables *****/
      228    13772    2   DCL STRING$ PTR;
      229    13773    2   DCL TEMP1 SBIN WORD AUTO;
      230    13774    2   DCL DATE1 REDEF TEMP1 UBIN WORD;
      231    13775    2   DCL TEMP2 SBIN WORD AUTO;
      232    13776    2   DCL DATE2 REDEF TEMP2 UBIN WORD;
      233    13777    2   DCL DATE3 UBIN WORD;
      234    13778    2   DCL K UBIN AUTO;
      235    13779        /***** Ptrs *****/
      236    13780    2   DCL VALUE$ PTR AUTO;
      237    13781        /***** Character variables *****/
      238    13782        /***** Constants *****/
      239    13783        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:44   
      240    13784        /***** Initialization *****/
      241    13785    2       VALUE$ = ZERO$;

  13785 13 000156   000000 236000 11                 LDQ     ZERO$
        13 000157   200742 756100                    STQ     VALUE$,,AUTO

      242    13786        /*
      243    13787             ***** Make sure that there are enough entries in the
      244    13788                   operand stack for this operator to operate upon ...
      245    13789        */
      246    13790    2       IF NUM_TO_POP_STACK(OP_PTR) > VAL_PTR+1

  13790 13 000160   200012 720100                    LXL0    OP_PTR,,AUTO
        13 000161   200013 236100                    LDQ     VAL_PTR,,AUTO
        13 000162   000001 036007                    ADLQ    1,DL
        13 000163   000166 604000 13                 TMI     s:13793
        13 000164   200451 116110                    CMPQ    NUM_TO_POP_STACK,X0,AUTO
        13 000165   000175 603000 13                 TRC     s:13800

      247    13791    2       THEN                            /* Stacks are not right */
      248    13792    3       DO;

      249    13793    3           VM_SELECT.ERROR = E_STKFLT;

  13793 13 000166   000006 236000 11                 LDQ     E_STKFLT
        13 000167   200004 470500                    LDP0    @VM_SELECT,,AUTO
        13 000170   000000 756100                    STQ     0,,PR0

      250    13794    3           VM_SELECT.ERR_POS# = CHARPOS_STACK(0);

  13794 13 000171   200651 235100                    LDA     CHARPOS_STACK,,AUTO
        13 000172   000022 771000                    ARL     18
        13 000173   000001 755100                    STA     1,,PR0

      251    13795    3           GOTO E_REDUCE;

  13795 13 000174   001052 710000 13                 TRA     E_REDUCE
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:45   

      252    13796    3       END;
      253    13797        /*
      254    13798             ***** Reduce the operator and value stacks as necessary ...
      255    13799        */
      256    13800    3       DO CASE (OP_STACK(OP_PTR));

  13800 13 000175   200417 235110                    LDA     OP_STACK,X0,AUTO
        13 000176   000043 115007                    CMPA    35,DL
        13 000177   000201 602005 13                 TNC     s:13800+4,AL
        13 000200   001020 710000 13                 TRA     s:13969
        13 000201   001020 710000 13                 TRA     s:13969
        13 000202   001020 710000 13                 TRA     s:13969
        13 000203   000244 710000 13                 TRA     s:13802
        13 000204   000265 710000 13                 TRA     s:13809
        13 000205   000316 710000 13                 TRA     s:13816
        13 000206   001020 710000 13                 TRA     s:13969
        13 000207   001020 710000 13                 TRA     s:13969
        13 000210   001020 710000 13                 TRA     s:13969
        13 000211   001020 710000 13                 TRA     s:13969
        13 000212   001020 710000 13                 TRA     s:13969
        13 000213   001020 710000 13                 TRA     s:13969
        13 000214   000347 710000 13                 TRA     s:13823
        13 000215   000356 710000 13                 TRA     s:13827
        13 000216   000555 710000 13                 TRA     s:13887
        13 000217   000523 710000 13                 TRA     s:13871
        13 000220   000541 710000 13                 TRA     s:13879
        13 000221   000547 710000 13                 TRA     s:13883
        13 000222   000564 710000 13                 TRA     s:13891
        13 000223   000577 710000 13                 TRA     s:13898
        13 000224   000606 710000 13                 TRA     s:13902
        13 000225   000615 710000 13                 TRA     s:13906
        13 000226   000624 710000 13                 TRA     s:13910
        13 000227   000643 710000 13                 TRA     s:13920
        13 000230   001012 710000 13                 TRA     s:13961
        13 000231   000570 710000 13                 TRA     s:13894
        13 000232   000634 710000 13                 TRA     s:13916
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:46   
        13 000233   000647 710000 13                 TRA     s:13923
        13 000234   000630 710000 13                 TRA     s:13913
        13 000235   000532 710000 13                 TRA     s:13875
        13 000236   000365 710000 13                 TRA     s:13831
        13 000237   001020 710000 13                 TRA     s:13969
        13 000240   001020 710000 13                 TRA     s:13969
        13 000241   001020 710000 13                 TRA     s:13969
        13 000242   000400 710000 13                 TRA     s:13838
        13 000243   000374 710000 13                 TRA     s:13835

      257    13801    3       CASE (%SEL_NOT);

      258    13802    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR),TEMP1) ALTRET(E_DEC2);

  13802 13 000244   200736 630500                    EPPR0   TEMP1,,AUTO
        13 000245   200773 450500                    STP0    FPT_TIME+13,,AUTO
        13 000246   200013 722100                    LXL2    VAL_PTR,,AUTO
        13 000247   200503 631512                    EPPR1   VAL_STACK$,X2,AUTO
        13 000250   200772 451500                    STP1    FPT_TIME+12,,AUTO
        13 000251   200772 630500                    EPPR0   FPT_TIME+12,,AUTO
        13 000252   000001 631400 14                 EPPR1   1
        13 000253   000000 701000 xent               TSX1    X$DEC_CONVERT
        13 000254   001100 702000 13                 TSX2    E_DEC2

      259    13803    3           IF TEMP1 > 0

  13803 13 000255   200736 235100                    LDA     TEMP1,,AUTO
        13 000256   000262 604400 13                 TMOZ    s:13807

      260    13804    3           THEN
      261    13805    3               VALUE$ = ZERO$;

  13805 13 000257   000000 236000 11                 LDQ     ZERO$
        13 000260   200742 756100                    STQ     VALUE$,,AUTO
        13 000261   001020 710000 13                 TRA     s:13969

      262    13806    3           ELSE
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:47   
      263    13807    3               VALUE$ = ONE$;

  13807 13 000262   000002 236000 11                 LDQ     ONE$
        13 000263   200742 756100                    STQ     VALUE$,,AUTO
        13 000264   001020 710000 13                 TRA     s:13969

      264    13808    3       CASE (%SEL_AND);

      265    13809    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR-1),TEMP1) ALTRET(E_DEC1);

  13809 13 000265   200736 630500                    EPPR0   TEMP1,,AUTO
        13 000266   200773 450500                    STP0    FPT_TIME+13,,AUTO
        13 000267   200013 722100                    LXL2    VAL_PTR,,AUTO
        13 000270   200502 631512                    EPPR1   NUM_TO_POP_STACK+25,X2,AUTO
        13 000271   200772 451500                    STP1    FPT_TIME+12,,AUTO
        13 000272   200772 630500                    EPPR0   FPT_TIME+12,,AUTO
        13 000273   000001 631400 14                 EPPR1   1
        13 000274   000000 701000 xent               TSX1    X$DEC_CONVERT
        13 000275   001067 702000 13                 TSX2    E_DEC1

      266    13810    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR),TEMP2) ALTRET(E_DEC2);

  13810 13 000276   200737 630500                    EPPR0   TEMP2,,AUTO
        13 000277   200773 450500                    STP0    FPT_TIME+13,,AUTO
        13 000300   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 000301   200503 631510                    EPPR1   VAL_STACK$,X0,AUTO
        13 000302   200772 451500                    STP1    FPT_TIME+12,,AUTO
        13 000303   200772 630500                    EPPR0   FPT_TIME+12,,AUTO
        13 000304   000001 631400 14                 EPPR1   1
        13 000305   000000 701000 xent               TSX1    X$DEC_CONVERT
        13 000306   001100 702000 13                 TSX2    E_DEC2

      267    13811    3           IF TEMP1 > 0

  13811 13 000307   200736 235100                    LDA     TEMP1,,AUTO
        13 000310   001020 604400 13                 TMOZ    s:13969
        13 000311   200737 236100                    LDQ     TEMP2,,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:48   
        13 000312   001020 604400 13                 TMOZ    s:13969

      268    13812    3             AND TEMP2 > 0
      269    13813    3           THEN
      270    13814    3               VALUE$ = ONE$;

  13814 13 000313   000002 236000 11                 LDQ     ONE$
        13 000314   200742 756100                    STQ     VALUE$,,AUTO
        13 000315   001020 710000 13                 TRA     s:13969

      271    13815    3       CASE (%SEL_OR);

      272    13816    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR-1),TEMP1) ALTRET(E_DEC1);

  13816 13 000316   200736 630500                    EPPR0   TEMP1,,AUTO
        13 000317   200773 450500                    STP0    FPT_TIME+13,,AUTO
        13 000320   200013 722100                    LXL2    VAL_PTR,,AUTO
        13 000321   200502 631512                    EPPR1   NUM_TO_POP_STACK+25,X2,AUTO
        13 000322   200772 451500                    STP1    FPT_TIME+12,,AUTO
        13 000323   200772 630500                    EPPR0   FPT_TIME+12,,AUTO
        13 000324   000001 631400 14                 EPPR1   1
        13 000325   000000 701000 xent               TSX1    X$DEC_CONVERT
        13 000326   001067 702000 13                 TSX2    E_DEC1

      273    13817    3           CALL X$DEC_CONVERT (VAL_STACK$(VAL_PTR),TEMP2) ALTRET(E_DEC2);

  13817 13 000327   200737 630500                    EPPR0   TEMP2,,AUTO
        13 000330   200773 450500                    STP0    FPT_TIME+13,,AUTO
        13 000331   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 000332   200503 631510                    EPPR1   VAL_STACK$,X0,AUTO
        13 000333   200772 451500                    STP1    FPT_TIME+12,,AUTO
        13 000334   200772 630500                    EPPR0   FPT_TIME+12,,AUTO
        13 000335   000001 631400 14                 EPPR1   1
        13 000336   000000 701000 xent               TSX1    X$DEC_CONVERT
        13 000337   001100 702000 13                 TSX2    E_DEC2

      274    13818    3           IF TEMP1 > 0
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:49   

  13818 13 000340   200736 235100                    LDA     TEMP1,,AUTO
        13 000341   000344 605400 13                 TPNZ    s:13821
        13 000342   200737 236100                    LDQ     TEMP2,,AUTO
        13 000343   001020 604400 13                 TMOZ    s:13969

      275    13819    3             OR TEMP2 > 0
      276    13820    3           THEN
      277    13821    3               VALUE$ = ONE$;

  13821 13 000344   000002 236000 11                 LDQ     ONE$
        13 000345   200742 756100                    STQ     VALUE$,,AUTO
        13 000346   001020 710000 13                 TRA     s:13969

      278    13822    3       CASE (%SEL_ACKNOWLEDGMENT);

      279    13823    3           IF VM_HEADER.STATUS.ACK

  13823 13 000347   000000 470400 xsym               LDP0    VM_HEADER$
        13 000350   000012 236100                    LDQ     10,,PR0
        13 000351   100000 316003                    CANQ    32768,DU
        13 000352   001020 600000 13                 TZE     s:13969

      280    13824    3           THEN
      281    13825    3               VALUE$ = ONE$;

  13825 13 000353   000002 236000 11                 LDQ     ONE$
        13 000354   200742 756100                    STQ     VALUE$,,AUTO
        13 000355   001020 710000 13                 TRA     s:13969

      282    13826    3       CASE (%SEL_ANSWER);

      283    13827    3           IF VM_HEADER.STATUS.ANSWER

  13827 13 000356   000000 470400 xsym               LDP0    VM_HEADER$
        13 000357   000012 236100                    LDQ     10,,PR0
        13 000360   200000 316003                    CANQ    65536,DU
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:50   
        13 000361   001020 600000 13                 TZE     s:13969

      284    13828    3           THEN
      285    13829    3               VALUE$ = ONE$;

  13829 13 000362   000002 236000 11                 LDQ     ONE$
        13 000363   200742 756100                    STQ     VALUE$,,AUTO
        13 000364   001020 710000 13                 TRA     s:13969

      286    13830    3       CASE (%SEL_BROADCAST);

      287    13831    3           IF VM_HEADER.STATUS.BROADCAST

  13831 13 000365   000000 470400 xsym               LDP0    VM_HEADER$
        13 000366   000012 236100                    LDQ     10,,PR0
        13 000367   000001 316003                    CANQ    1,DU
        13 000370   001020 600000 13                 TZE     s:13969

      288    13832    3           THEN
      289    13833    3               VALUE$ = ONE$;

  13833 13 000371   000002 236000 11                 LDQ     ONE$
        13 000372   200742 756100                    STQ     VALUE$,,AUTO
        13 000373   001020 710000 13                 TRA     s:13969

      290    13834    3       CASE (%SEL_DATE_RCVD);

      291    13835    3           DATE1 = VM_HEADER.DELIVERY_DATE;

  13835 13 000374   000000 470400 xsym               LDP0    VM_HEADER$
        13 000375   000002 235100                    LDA     2,,PR0
        13 000376   200736 755100                    STA     TEMP1,,AUTO

      292    13836    3           GOTO DATE_COMPARER;

  13836 13 000377   000403 710000 13                 TRA     DATE_COMPARER

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:51   
      293    13837    3       CASE (%SEL_DATE_SENT);

      294    13838    3           DATE1 = VM_HEADER.CREATION_DATE;

  13838 13 000400   000000 470400 xsym               LDP0    VM_HEADER$
        13 000401   000001 235100                    LDA     1,,PR0
        13 000402   200736 755100                    STA     TEMP1,,AUTO

      295    13839    3   DATE_COMPARER:
      296    13840    3           CALL DATE_INIT (VAL_STACK$(VAL_PTR) -> P$B.SUBLK$(0)) ALTRET(E_DATE);

  13840 13 000403   200013 722100       DATE_COMPAR* LXL2    VAL_PTR,,AUTO
        13 000404   200503 471512                    LDP1    VAL_STACK$,X2,AUTO
        13 000405   100003 633500                    EPPR3   3,,PR1
        13 000406   200745 453500                    STP3    VALUE$+3,,AUTO
        13 000407   001111 701000 13                 TSX1    DATE_INIT
        13 000410   001054 702000 13                 TSX2    E_DATE

      297    13841    3           K = VAL_STACK$(VAL_PTR)->P$B.SUBLK$(0)->P$B.SCRITCH * %UTS_25TH_MIN#;

  13841 13 000411   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 000412   200503 470510                    LDP0    VAL_STACK$,X0,AUTO
        13 000413   000003 471500                    LDP1    3,,PR0
        13 000414   100001 236100                    LDQ     1,,PR1
        13 000415   777777 376007                    ANQ     -1,DL
        13 000416   002734 402007                    MPY     1500,DL
        13 000417   200741 756100                    STQ     K,,AUTO

      298    13842    3           DATE2 = VAL_STACK$(VAL_PTR)->P$B.SUBLK$(0)->P$B.CPOS;

  13842 13 000420   200503 470510                    LDP0    VAL_STACK$,X0,AUTO
        13 000421   000003 471500                    LDP1    3,,PR0
        13 000422   100002 235100                    LDA     2,,PR1
        13 000423   200737 755100                    STA     TEMP2,,AUTO

      299    13843    3           CALL XUD$UTS_ADJ_25TH (DATE3, DATE2, K);

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:52   
  13843 13 000424   200741 630500                    EPPR0   K,,AUTO
        13 000425   200774 450500                    STP0    FPT_TIME+14,,AUTO
        13 000426   200737 631500                    EPPR1   TEMP2,,AUTO
        13 000427   200773 451500                    STP1    FPT_TIME+13,,AUTO
        13 000430   200740 633500                    EPPR3   DATE3,,AUTO
        13 000431   200772 453500                    STP3    FPT_TIME+12,,AUTO
        13 000432   200772 630500                    EPPR0   FPT_TIME+12,,AUTO
        13 000433   000000 631400 14                 EPPR1   0
        13 000434   000000 701000 xent               TSX1    XUD$UTS_ADJ_25TH
        13 000435   000000 011000                    NOP     0

      300    13844    4           DO CASE (VAL_STACK$(VAL_PTR) -> P$B.CODE);

  13844 13 000436   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 000437   200503 470510                    LDP0    VAL_STACK$,X0,AUTO
        13 000440   000000 721100                    LXL1    0,,PR0
        13 000441   000007 101003                    CMPX1   7,DU
        13 000442   000444 602011 13                 TNC     s:13844+6,X1
        13 000443   001020 710000 13                 TRA     s:13969
        13 000444   000522 710000 13                 TRA     s:13869
        13 000445   000463 710000 13                 TRA     s:13850
        13 000446   000453 710000 13                 TRA     s:13846
        13 000447   000473 710000 13                 TRA     s:13854
        13 000450   000501 710000 13                 TRA     s:13858
        13 000451   000507 710000 13                 TRA     s:13862
        13 000452   000515 710000 13                 TRA     s:13866

      301    13845    4           CASE (%OPTION_EQ);

      302    13846    4               IF (DATE1 >= DATE2) AND (DATE1 < DATE3)

  13846 13 000453   200736 236100                    LDQ     TEMP1,,AUTO
        13 000454   200737 116100                    CMPQ    TEMP2,,AUTO
        13 000455   001020 602000 13                 TNC     s:13969
        13 000456   200740 116100                    CMPQ    DATE3,,AUTO
        13 000457   001020 603000 13                 TRC     s:13969

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:53   
      303    13847    4               THEN
      304    13848    4                   VALUE$ = ONE$;

  13848 13 000460   000002 236000 11                 LDQ     ONE$
        13 000461   200742 756100                    STQ     VALUE$,,AUTO
        13 000462   001020 710000 13                 TRA     s:13969

      305    13849    4           CASE (%OPTION_NE);

      306    13850    4               IF (DATE1 < DATE2) OR (DATE1 >= DATE3)

  13850 13 000463   200736 236100                    LDQ     TEMP1,,AUTO
        13 000464   200737 116100                    CMPQ    TEMP2,,AUTO
        13 000465   000470 602000 13                 TNC     s:13852
        13 000466   200740 116100                    CMPQ    DATE3,,AUTO
        13 000467   001020 602000 13                 TNC     s:13969

      307    13851    4               THEN
      308    13852    4                   VALUE$ = ONE$;

  13852 13 000470   000002 236000 11                 LDQ     ONE$
        13 000471   200742 756100                    STQ     VALUE$,,AUTO
        13 000472   001020 710000 13                 TRA     s:13969

      309    13853    4           CASE (%OPTION_GT);

      310    13854    4               IF DATE1 >= DATE3

  13854 13 000473   200736 236100                    LDQ     TEMP1,,AUTO
        13 000474   200740 116100                    CMPQ    DATE3,,AUTO
        13 000475   001020 602000 13                 TNC     s:13969

      311    13855    4               THEN
      312    13856    4                   VALUE$ = ONE$;

  13856 13 000476   000002 236000 11                 LDQ     ONE$
        13 000477   200742 756100                    STQ     VALUE$,,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:54   
        13 000500   001020 710000 13                 TRA     s:13969

      313    13857    4           CASE (%OPTION_GE);

      314    13858    4               IF DATE1 >= DATE2

  13858 13 000501   200736 236100                    LDQ     TEMP1,,AUTO
        13 000502   200737 116100                    CMPQ    TEMP2,,AUTO
        13 000503   001020 602000 13                 TNC     s:13969

      315    13859    4               THEN
      316    13860    4                   VALUE$ = ONE$;

  13860 13 000504   000002 236000 11                 LDQ     ONE$
        13 000505   200742 756100                    STQ     VALUE$,,AUTO
        13 000506   001020 710000 13                 TRA     s:13969

      317    13861    4           CASE (%OPTION_LT);

      318    13862    4               IF DATE1 < DATE2

  13862 13 000507   200736 236100                    LDQ     TEMP1,,AUTO
        13 000510   200737 116100                    CMPQ    TEMP2,,AUTO
        13 000511   001020 603000 13                 TRC     s:13969

      319    13863    4               THEN
      320    13864    4                   VALUE$ = ONE$;

  13864 13 000512   000002 236000 11                 LDQ     ONE$
        13 000513   200742 756100                    STQ     VALUE$,,AUTO
        13 000514   001020 710000 13                 TRA     s:13969

      321    13865    4           CASE (%OPTION_LE);

      322    13866    4               IF DATE1 < DATE3

  13866 13 000515   200736 236100                    LDQ     TEMP1,,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:55   
        13 000516   200740 116100                    CMPQ    DATE3,,AUTO
        13 000517   001020 603000 13                 TRC     s:13969

      323    13867    4               THEN
      324    13868    4                   VALUE$ = ONE$;

  13868 13 000520   000002 236000 11                 LDQ     ONE$
        13 000521   200742 756100                    STQ     VALUE$,,AUTO

      325    13869    4           END;

  13869 13 000522   001020 710000 13                 TRA     s:13969

      326    13870    3       CASE (%SEL_DELETED);

      327    13871    3           IF VM_HEADER.STATUS.DEL

  13871 13 000523   000000 470400 xsym               LDP0    VM_HEADER$
        13 000524   000012 236100                    LDQ     10,,PR0
        13 000525   000400 316003                    CANQ    256,DU
        13 000526   001020 600000 13                 TZE     s:13969

      328    13872    3           THEN
      329    13873    3               VALUE$ = ONE$;

  13873 13 000527   000002 236000 11                 LDQ     ONE$
        13 000530   200742 756100                    STQ     VALUE$,,AUTO
        13 000531   001020 710000 13                 TRA     s:13969

      330    13874    3       CASE (%SEL_DELIVERY);

      331    13875    3           IF VM_HEADER.STATUS.DELIVERY

  13875 13 000532   000000 470400 xsym               LDP0    VM_HEADER$
        13 000533   000012 236100                    LDQ     10,,PR0
        13 000534   000002 316003                    CANQ    2,DU
        13 000535   001020 600000 13                 TZE     s:13969
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:56   

      332    13876    3           THEN
      333    13877    3               VALUE$ = ONE$;

  13877 13 000536   000002 236000 11                 LDQ     ONE$
        13 000537   200742 756100                    STQ     VALUE$,,AUTO
        13 000540   001020 710000 13                 TRA     s:13969

      334    13878    3       CASE (%SEL_ERROR);

      335    13879    3           IF VM_HEADER.STATUS.ERR

  13879 13 000541   000000 470400 xsym               LDP0    VM_HEADER$
        13 000542   000012 234100                    SZN     10,,PR0
        13 000543   001020 605000 13                 TPL     s:13969

      336    13880    3           THEN
      337    13881    3               VALUE$ = ONE$;

  13881 13 000544   000002 236000 11                 LDQ     ONE$
        13 000545   200742 756100                    STQ     VALUE$,,AUTO
        13 000546   001020 710000 13                 TRA     s:13969

      338    13882    3       CASE (%SEL_EXAMINED);

      339    13883    3           IF VM_HEADER.STATUS.EXAM

  13883 13 000547   000000 470400 xsym               LDP0    VM_HEADER$
        13 000550   000012 430100                    FSZN    10,,PR0
        13 000551   001020 605000 13                 TPL     s:13969

      340    13884    3           THEN
      341    13885    3               VALUE$ = ONE$;

  13885 13 000552   000002 236000 11                 LDQ     ONE$
        13 000553   200742 756100                    STQ     VALUE$,,AUTO
        13 000554   001020 710000 13                 TRA     s:13969
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:57   

      342    13886    3       CASE (%SEL_FCOPY);

      343    13887    3           IF VM_HEADER.STATUS.FCOPY

  13887 13 000555   000000 470400 xsym               LDP0    VM_HEADER$
        13 000556   000012 236100                    LDQ     10,,PR0
        13 000557   000200 316003                    CANQ    128,DU
        13 000560   001020 600000 13                 TZE     s:13969

      344    13888    3           THEN
      345    13889    3               VALUE$ = ONE$;

  13889 13 000561   000002 236000 11                 LDQ     ONE$
        13 000562   200742 756100                    STQ     VALUE$,,AUTO
        13 000563   001020 710000 13                 TRA     s:13969

      346    13890    3       CASE (%SEL_FROM);

      347    13891    3           STRING$ = VM_HEADER.FROM$;

  13891 13 000564   000000 470400 xsym               LDP0    VM_HEADER$
        13 000565   000023 236100                    LDQ     19,,PR0
        13 000566   200735 756100                    STQ     STRING$,,AUTO

      348    13892    3           GOTO STRING_COMPARER;

  13892 13 000567   000652 710000 13                 TRA     STRING_COMPARER

      349    13893    3       CASE (%SEL_FWD);

      350    13894    3           IF VM_HEADER.STATUS.FORWARDED

  13894 13 000570   000000 470400 xsym               LDP0    VM_HEADER$
        13 000571   000012 236100                    LDQ     10,,PR0
        13 000572   000020 316003                    CANQ    16,DU
        13 000573   001020 600000 13                 TZE     s:13969
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:58   

      351    13895    3           THEN
      352    13896    3               VALUE$ = ONE$;

  13896 13 000574   000002 236000 11                 LDQ     ONE$
        13 000575   200742 756100                    STQ     VALUE$,,AUTO
        13 000576   001020 710000 13                 TRA     s:13969

      353    13897    3       CASE (%SEL_MARKED);

      354    13898    3           IF VM_HEADER.STATUS.MARK

  13898 13 000577   000000 470400 xsym               LDP0    VM_HEADER$
        13 000600   000012 236100                    LDQ     10,,PR0
        13 000601   000100 316003                    CANQ    64,DU
        13 000602   001020 600000 13                 TZE     s:13969

      355    13899    3           THEN
      356    13900    3               VALUE$ = ONE$;

  13900 13 000603   000002 236000 11                 LDQ     ONE$
        13 000604   200742 756100                    STQ     VALUE$,,AUTO
        13 000605   001020 710000 13                 TRA     s:13969

      357    13901    3       CASE (%SEL_NEW);

      358    13902    3           IF VM_HEADER.STATUS.OLD = %NO#

  13902 13 000606   000000 470400 xsym               LDP0    VM_HEADER$
        13 000607   000012 236100                    LDQ     10,,PR0
        13 000610   004000 316003                    CANQ    2048,DU
        13 000611   001020 601000 13                 TNZ     s:13969

      359    13903    3           THEN
      360    13904    3               VALUE$ = ONE$;

  13904 13 000612   000002 236000 11                 LDQ     ONE$
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:59   
        13 000613   200742 756100                    STQ     VALUE$,,AUTO
        13 000614   001020 710000 13                 TRA     s:13969

      361    13905    3       CASE (%SEL_OLD);

      362    13906    3           IF VM_HEADER.STATUS.OLD

  13906 13 000615   000000 470400 xsym               LDP0    VM_HEADER$
        13 000616   000012 236100                    LDQ     10,,PR0
        13 000617   004000 316003                    CANQ    2048,DU
        13 000620   001020 600000 13                 TZE     s:13969

      363    13907    3           THEN
      364    13908    3               VALUE$ = ONE$;

  13908 13 000621   000002 236000 11                 LDQ     ONE$
        13 000622   200742 756100                    STQ     VALUE$,,AUTO
        13 000623   001020 710000 13                 TRA     s:13969

      365    13909    3       CASE (%SEL_REFERENCE);

      366    13910    3           STRING$ = VM_HEADER.REFERENCE$;

  13910 13 000624   000000 470400 xsym               LDP0    VM_HEADER$
        13 000625   000024 236100                    LDQ     20,,PR0
        13 000626   200735 756100                    STQ     STRING$,,AUTO

      367    13911    3           GOTO STRING_COMPARER;

  13911 13 000627   000652 710000 13                 TRA     STRING_COMPARER

      368    13912    3       CASE (%SEL_REPLY_TO);

      369    13913    3           STRING$ = VM_HEADER.REPLY_TO$;

  13913 13 000630   000000 470400 xsym               LDP0    VM_HEADER$
        13 000631   000025 236100                    LDQ     21,,PR0
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:60   
        13 000632   200735 756100                    STQ     STRING$,,AUTO

      370    13914    3           GOTO STRING_COMPARER;

  13914 13 000633   000652 710000 13                 TRA     STRING_COMPARER

      371    13915    3       CASE (%SEL_RR);

      372    13916    3           IF VM_HEADER.STATUS.RRACK

  13916 13 000634   000000 470400 xsym               LDP0    VM_HEADER$
        13 000635   000012 236100                    LDQ     10,,PR0
        13 000636   020000 316007                    CANQ    8192,DL
        13 000637   001020 600000 13                 TZE     s:13969

      373    13917    3           THEN
      374    13918    3               VALUE$ = ONE$;

  13918 13 000640   000002 236000 11                 LDQ     ONE$
        13 000641   200742 756100                    STQ     VALUE$,,AUTO
        13 000642   001020 710000 13                 TRA     s:13969

      375    13919    3       CASE (%SEL_SUBJECT);

      376    13920    3           STRING$ = VM_HEADER.SUBJECT$;

  13920 13 000643   000000 470400 xsym               LDP0    VM_HEADER$
        13 000644   000030 236100                    LDQ     24,,PR0
        13 000645   200735 756100                    STQ     STRING$,,AUTO

      377    13921    3           GOTO STRING_COMPARER;

  13921 13 000646   000652 710000 13                 TRA     STRING_COMPARER

      378    13922    3       CASE (%SEL_TO);

      379    13923    3           STRING$ = VM_HEADER.TO$;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:61   

  13923 13 000647   000000 470400 xsym               LDP0    VM_HEADER$
        13 000650   000031 236100                    LDQ     25,,PR0
        13 000651   200735 756100                    STQ     STRING$,,AUTO

      380    13924    3   STRING_COMPARER:
      381    13925    3           IF STRING$ = ADDR(NIL)

  13925 13 000652   000002 116000 14    STRING_COMP* CMPQ    2
        13 000653   000777 600000 13                 TZE     NO_MATCH

      382    13926    3           THEN                       /* Cannot make this comparison */
      383    13927    3               GOTO NO_MATCH;
      384    13928    3           IF STRING$ -> X$STRING.SIZ = 0

  13928 13 000654   200735 471500                    LDP1    STRING$,,AUTO
        13 000655   000100 101500                    MRL     fill='000'O
        13 000656   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000657   200772 000004                    ADSC9   FPT_TIME+12,,AUTO        cn=0,n=4
        13 000660   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 000661   000000 116003                    CMPQ    0,DU
        13 000662   000777 600000 13                 TZE     NO_MATCH

      385    13929    3           THEN                       /* Cannot make this comparison */
      386    13930    3               GOTO NO_MATCH;
      387    13931    3           CALL XLATE (WORK1.NAME#,LOWER_UPPER,VAL_STACK$(VAL_PTR) ->

  13931 13 000663   200013 722100                    LXL2    VAL_PTR,,AUTO
        13 000664   200503 473512                    LDP3    VAL_STACK$,X2,AUTO
        13 000665   300003 474500                    LDP4    3,,PR3
        13 000666   400004 236100                    LDQ     4,,PR4
        13 000667   000033 772000                    QRL     27
        13 000670   000000 623006                    EAX3    0,QL
        13 000671   000000 475400 xsym               LDP5    B$XL_UPPER$
        13 000672   040100 160540                    MVT     fill='040'O
        13 000673   400004 200013                    ADSC9   4,,PR4                   cn=1,n=*X3
        13 000674   200017 200777                    ADSC9   WORK1,,AUTO              cn=1,n=511
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:62   
        13 000675   500000 000100                    ARG     0,,PR5

      388    13932    3             P$B.SUBLK$(0) -> P$S.TEXT);
      389    13933    3           WORK1.L# = VAL_STACK$(VAL_PTR) -> P$B.SUBLK$(0) -> P$S.COUNT;

  13933 13 000676   200503 473512                    LDP3    VAL_STACK$,X2,AUTO
        13 000677   300003 474500                    LDP4    3,,PR3
        13 000700   400004 236100                    LDQ     4,,PR4
        13 000701   200017 552140                    STBQ    WORK1,'40'O,AUTO

      390    13934    3           CALL XLATE (SUBSTR(WORK2.NAME#,2),LOWER_UPPER,STRING$ ->X$STRING.TEXT);

  13934 13 000702   000100 101500                    MRL     fill='000'O
        13 000703   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000704   200772 000002                    ADSC9   FPT_TIME+12,,AUTO        cn=0,n=2
        13 000705   200772 223100                    LDX3    FPT_TIME+12,,AUTO
        13 000706   040100 160540                    MVT     fill='040'O
        13 000707   100000 200013                    ADSC9   0,,PR1                   cn=1,n=*X3
        13 000710   200217 600775                    ADSC9   WORK2,,AUTO              cn=3,n=509
        13 000711   500000 000100                    ARG     0,,PR5

      391    13935    3           SUBSTR(WORK2.NAME#,0,2) = '. '; /* dummy word to reserve two spaces */

  13935 13 000712   000134 236000 11                 LDQ     FPT_TIME_C+12
        13 000713   000011 772000                    QRL     9
        13 000714   200217 552130                    STBQ    WORK2,'30'O,AUTO

      392    13936    3           WORK2.L# = LENGTHC(WORK2.NAME#);

  13936 13 000715   777000 236003                    LDQ     -512,DU
        13 000716   200217 552140                    STBQ    WORK2,'40'O,AUTO

      393    13937    3           CALL VMA$COMPRESS_BLANKS (ADDR(WORK2));

  13937 13 000717   200217 633500                    EPPR3   WORK2,,AUTO
        13 000720   200772 453500                    STP3    FPT_TIME+12,,AUTO
        13 000721   200772 634500                    EPPR4   FPT_TIME+12,,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:63   
        13 000722   200773 454500                    STP4    FPT_TIME+13,,AUTO
        13 000723   200773 630500                    EPPR0   FPT_TIME+13,,AUTO
        13 000724   000003 631400 14                 EPPR1   3
        13 000725   000000 701000 xent               TSX1    VMA$COMPRESS_BLANKS
        13 000726   000000 011000                    NOP     0

      394    13938    3           IF WORK2.L# < 2 THEN          /* Cannot make this comparison */

  13938 13 000727   200217 236100                    LDQ     WORK2,,AUTO
        13 000730   777000 376003                    ANQ     -512,DU
        13 000731   002000 116003                    CMPQ    1024,DU
        13 000732   000777 602000 13                 TNC     NO_MATCH

      395    13939    3               GOTO NO_MATCH;
      396    13940    3           WORK2.L# = WORK2.L# + 2; /* add two spaces at end, too */

  13940 13 000733   200217 236100                    LDQ     WORK2,,AUTO
        13 000734   002000 036003                    ADLQ    1024,DU
        13 000735   200217 552140                    STBQ    WORK2,'40'O,AUTO

      397    13941    3           SUBSTR(WORK2.NAME#,0,1) = ' '; /* start with two spaces */

  13941 13 000736   000040 236003                    LDQ     32,DU
        13 000737   200217 552120                    STBQ    WORK2,'20'O,AUTO

      398    13942    3           VM_WILDCARD.PATTERN_ = VECTOR(SUBSTR(WORK1.NAME#,0,WORK1.L#));

  13942 13 000740   200017 236100                    LDQ     WORK1,,AUTO
        13 000741   000033 772000                    QRL     27
        13 000742   000064 737000                    LLS     52
        13 000743   000140 135007                    SBLA    96,DL
        13 000744   200772 452500                    STP2    FPT_TIME+12,,AUTO
        13 000745   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 000746   000004 036000 14                 ADLQ    4
        13 000747   000000 757000 12                 STAQ    VM_WILDCARD

      399    13943    3           VM_WILDCARD.INPUT_ = VECTOR(SUBSTR(WORK2.NAME#,0,WORK2.L#));
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:64   

  13943 13 000750   200217 236100                    LDQ     WORK2,,AUTO
        13 000751   000033 772000                    QRL     27
        13 000752   000064 737000                    LLS     52
        13 000753   000140 135007                    SBLA    96,DL
        13 000754   200772 452500                    STP2    FPT_TIME+12,,AUTO
        13 000755   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 000756   000005 036000 14                 ADLQ    5
        13 000757   000002 757000 12                 STAQ    VM_WILDCARD+2

      400    13944    3           CALL X$WILDCMP (VM_WILDCARD)

  13944 13 000760   000006 630400 14                 EPPR0   6
        13 000761   000003 631400 14                 EPPR1   3
        13 000762   000000 701000 xent               TSX1    X$WILDCMP
        13 000763   000777 702000 13                 TSX2    NO_MATCH

      401    13945    3           WHENRETURN
      402    13946    4           DO;

      403    13947    4               IF VAL_STACK$(VAL_PTR) -> P$B.CODE = %OPTION_EQ THEN

  13947 13 000764   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 000765   200503 470510                    LDP0    VAL_STACK$,X0,AUTO
        13 000766   000000 721100                    LXL1    0,,PR0
        13 000767   000002 101003                    CMPX1   2,DU
        13 000770   000774 601000 13                 TNZ     s:13950

      404    13948    4                   VALUE$ = ONE$;

  13948 13 000771   000002 236000 11                 LDQ     ONE$
        13 000772   200742 756100                    STQ     VALUE$,,AUTO
        13 000773   000776 710000 13                 TRA     s:13951

      405    13949    4               ELSE
      406    13950    4                   VALUE$ = ZERO$;

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:65   
  13950 13 000774   000000 236000 11                 LDQ     ZERO$
        13 000775   200742 756100                    STQ     VALUE$,,AUTO

      407    13951    4           END;

  13951 13 000776   001011 710000 13                 TRA     s:13959

      408    13952    3           WHENALTRETURN
      409    13953    4           DO;

      410    13954    4   NO_MATCH:
      411    13955    4               IF VAL_STACK$(VAL_PTR) -> P$B.CODE = %OPTION_NE THEN

  13955 13 000777   200013 720100       NO_MATCH     LXL0    VAL_PTR,,AUTO
        13 001000   200503 470510                    LDP0    VAL_STACK$,X0,AUTO
        13 001001   000000 721100                    LXL1    0,,PR0
        13 001002   000001 101003                    CMPX1   1,DU
        13 001003   001007 601000 13                 TNZ     s:13958

      412    13956    4                   VALUE$ = ONE$;

  13956 13 001004   000002 236000 11                 LDQ     ONE$
        13 001005   200742 756100                    STQ     VALUE$,,AUTO
        13 001006   001011 710000 13                 TRA     s:13959

      413    13957    4               ELSE
      414    13958    4                   VALUE$ = ZERO$;

  13958 13 001007   000000 236000 11                 LDQ     ZERO$
        13 001010   200742 756100                    STQ     VALUE$,,AUTO

      415    13959    4           END;

  13959 13 001011   001020 710000 13                 TRA     s:13969

      416    13960    3       CASE (%SEL_UNEXAMINED);

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:66   
      417    13961    3           IF VM_HEADER.STATUS.EXAM = %NO#

  13961 13 001012   000000 470400 xsym               LDP0    VM_HEADER$
        13 001013   000012 430100                    FSZN    10,,PR0
        13 001014   001020 604000 13                 TMI     s:13969

      418    13962    3           THEN
      419    13963    3               VALUE$ = ONE$;

  13963 13 001015   000002 236000 11                 LDQ     ONE$
        13 001016   200742 756100                    STQ     VALUE$,,AUTO
        13 001017   001020 710000 13                 TRA     s:13969

      420    13964    3       CASE (ELSE);

      421    13965    3       END;                             /* Do case ... end */

      422    13966        /*
      423    13967             ***** Reduce the value stack...
      424    13968        */
      425    13969    2       VAL_PTR = VAL_PTR - NUM_TO_POP_STACK(OP_PTR);

  13969 13 001020   200012 720100                    LXL0    OP_PTR,,AUTO
        13 001021   200013 236100                    LDQ     VAL_PTR,,AUTO
        13 001022   200451 136110                    SBLQ    NUM_TO_POP_STACK,X0,AUTO
        13 001023   200013 756100                    STQ     VAL_PTR,,AUTO

      426    13970        /*
      427    13971             ***** Push the result of this reduction
      428    13972                   onto the value stack (VAL_STACK$) ...
      429    13973        */
      430    13974            %PUSH_VALUE;

  13975 13 001024   200013 054100                    AOS     VAL_PTR,,AUTO

  13976 13 001025   200013 235100                    LDA     VAL_PTR,,AUTO
        13 001026   000031 115007                    CMPA    25,DL
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:67   
        13 001027   001037 604400 13                 TMOZ    s:13985

  13979 13 001030   000004 236000 11                 LDQ     E_STKOVFL
        13 001031   200004 470500                    LDP0    @VM_SELECT,,AUTO
        13 001032   000000 756100                    STQ     0,,PR0

  13980 13 001033   200011 235100                    LDA     CHARPOS,,AUTO
        13 001034   000001 755100                    STA     1,,PR0

  13981 13 001035   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 001036   000000 702211                    TSX2  ! 0,X1

  13985 13 001037   200742 236100                    LDQ     VALUE$,,AUTO
        13 001040   200503 756105                    STQ     VAL_STACK$,AL,AUTO

  13986 13 001041   000777 235007                    LDA     511,DL
        13 001042   200013 721100                    LXL1    VAL_PTR,,AUTO
        13 001043   200566 755111                    STA     VAL_TYPE,X1,AUTO

  13987 13 001044   200011 722100                    LXL2    CHARPOS,,AUTO
        13 001045   200651 742111                    STX2    CHARPOS_STACK,X1,AUTO

      431    13990        /*
      432    13991             ***** Remove the reduced operator from
      433    13992                   the operator stack (OP_STK) ...
      434    13993        */
      435    13994    2       OP_PTR = OP_PTR - 1;

  13994 13 001046   000001 336007                    LCQ     1,DL
        13 001047   200012 056100                    ASQ     OP_PTR,,AUTO

      436    13995    2       RETURN;

  13995 13 001050   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 001051   000001 702211                    TSX2  ! 1,X1

      437    13996        /**/
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:68   
      438    13997    2   E_REDUCE:
      439    13998    2       ALTRETURN;

  13998 13 001052   200734 221300       E_REDUCE     LDX1  ! CHARPOS_STACK+51,,AUTO
        13 001053   000000 702211                    TSX2  ! 0,X1

      440    13999        /**/
      441    14000    2   E_DATE:
      442    14001    2       VM_SELECT.ERROR = B$TCB.ALT$->B$ALT.ERR;

  14001 13 001054   000000 470400 xsym  E_DATE       LDP0    B$TCB$
        13 001055   000000 471500                    LDP1    0,,PR0
        13 001056   100102 236100                    LDQ     66,,PR1
        13 001057   200004 473500                    LDP3    @VM_SELECT,,AUTO
        13 001060   300000 756100                    STQ     0,,PR3

      443    14002    2       VM_SELECT.ERR_POS# = CHARPOS_STACK(VAL_PTR);

  14002 13 001061   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 001062   200651 236110                    LDQ     CHARPOS_STACK,X0,AUTO
        13 001063   000022 772000                    QRL     18
        13 001064   300001 756100                    STQ     1,,PR3

      444    14003    2       ALTRETURN;

  14003 13 001065   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 001066   000000 702211                    TSX2  ! 0,X1

      445    14004    2   E_DEC1:
      446    14005    2       VM_SELECT.ERROR = E_NONDECIMAL;

  14005 13 001067   000005 236000 11    E_DEC1       LDQ     E_NONDECIMAL
        13 001070   200004 470500                    LDP0    @VM_SELECT,,AUTO
        13 001071   000000 756100                    STQ     0,,PR0

      447    14006    2       VM_SELECT.ERR_POS# = CHARPOS_STACK(VAL_PTR-1);

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:69   
  14006 13 001072   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 001073   200650 236110                    LDQ     VAL_TYPE+50,X0,AUTO
        13 001074   000022 772000                    QRL     18
        13 001075   000001 756100                    STQ     1,,PR0

      448    14007    2       ALTRETURN;

  14007 13 001076   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 001077   000000 702211                    TSX2  ! 0,X1

      449    14008        /**/
      450    14009    2   E_DEC2:
      451    14010    2       VM_SELECT.ERROR = E_NONDECIMAL;

  14010 13 001100   000005 236000 11    E_DEC2       LDQ     E_NONDECIMAL
        13 001101   200004 470500                    LDP0    @VM_SELECT,,AUTO
        13 001102   000000 756100                    STQ     0,,PR0

      452    14011    2       VM_SELECT.ERR_POS# = CHARPOS_STACK(VAL_PTR);

  14011 13 001103   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 001104   200651 236110                    LDQ     CHARPOS_STACK,X0,AUTO
        13 001105   000022 772000                    QRL     18
        13 001106   000001 756100                    STQ     1,,PR0

      453    14012    2       ALTRETURN;

  14012 13 001107   200734 221300                    LDX1  ! CHARPOS_STACK+51,,AUTO
        13 001110   000000 702211                    TSX2  ! 0,X1

      454    14013    2   END REDUCE;
      455    14014        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:70   
      456    14015    1   DATE_INIT: PROC (OUT$) ALTRET;

  14015 13 001111   200744 741300       DATE_INIT    STX1  ! VALUE$+2,,AUTO

      457    14016        /***** Parameters *****/
      458    14017    2   DCL OUT$ PTR;
      459    14018        /***** Local Variables *****/
      460    14019    2   DCL P$ PTR;
      461    14020    2   DCL I SBIN;
      462    14021    2   DCL J SBIN;
      463    14022    2   DCL 1 WORK_DATE,
      464    14023    2         2 MONTH CHAR(2),
      465    14024    2         2 * CHAR(1),
      466    14025    2         2 DAY CHAR(2),
      467    14026    2         2 * CHAR(1),
      468    14027    2         2 YEAR CHAR(2);
      469    14028    2   DCL 1 WORK_TIME,
      470    14029    2         2 HOUR CHAR(2),
      471    14030    2         2 * CHAR(1),
      472    14031    2         2 MIN CHAR(2);
      473    14032    2   DCL WORK_TIMEC REDEF WORK_TIME CHAR(5);
      474    14033    2   DCL INIT_TIMEC CHAR(5) CONSTANT INIT('00:00');
      475    14034
      476    14035        %FPT_TIME (FPTN=FPT_TIME_C, STCLASS=CONSTANT,
      477    14036                   SOURCE=CLOCK,
      478    14037                   DEST=LOCAL);
      479    14056        %FPT_TIME (FPTN=FPT_TIME, STCLASS=AUTO);
      480    14075        /*
      481    14076                If the timestamp has been initialized, P$B.SCRITCH has been
      482    14077                set to the resolution of the timestamp (in minutes), and
      483    14078                P$B.CPOS has been replaced with the UTS for the timestamp.
      484    14079        */
      485    14080    2       IF OUT$ -> P$B.SCRITCH > 0

  14080 13 001112   200745 470500                    LDP0    @OUT$,,AUTO
        13 001113   000000 471500                    LDP1    0,,PR0
        13 001114   100001 720100                    LXL0    1,,PR1
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:71   
        13 001115   001117 600000 13                 TZE     s:14086

      486    14081    2       THEN
      487    14082    2           RETURN;

  14082 13 001116   000001 702211                    TSX2  ! 1,X1

      488    14083        /*
      489    14084                Start with current date, time of midnight.
      490    14085        */
      491    14086    2       FPT_TIME = FPT_TIME_C;

  14086 13 001117   000100 100400                    MLR     fill='000'O
        13 001120   000120 000060 11                 ADSC9   FPT_TIME_C               cn=0,n=48
        13 001121   200756 000060                    ADSC9   FPT_TIME,,AUTO           cn=0,n=48

      492    14087    2       FPT_TIME.V_ = VECTOR(FPT_TIME.V);

  14087 13 001122   000007 235000 14                 LDA     7
        13 001123   200772 452500                    STP2    FPT_TIME+12,,AUTO
        13 001124   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 001125   000770 036003                    ADLQ    504,DU
        13 001126   200756 757100                    STAQ    FPT_TIME,,AUTO

      493    14088    2       FPT_TIME.DATE_ = VECTOR(WORK_DATE);

  14088 13 001127   000007 235000 14                 LDA     7
        13 001130   200772 452500                    STP2    FPT_TIME+12,,AUTO
        13 001131   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 001132   000751 036003                    ADLQ    489,DU
        13 001133   200760 757100                    STAQ    FPT_TIME+2,,AUTO

      494    14089    2       CALL M$TIME (FPT_TIME);

  14089 13 001134   200756 630500                    EPPR0   FPT_TIME,,AUTO
        13 001135   020004 713400                    CLIMB   8196
        13 001136   402000 401760                    pmme    nvectors=5
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:72   

      495    14090    2       WORK_TIMEC = INIT_TIMEC;

  14090 13 001137   040100 100400                    MLR     fill='040'O
        13 001140   000116 000005 11                 ADSC9   INIT_TIMEC               cn=0,n=5
        13 001141   200753 000005                    ADSC9   WORK_TIME,,AUTO          cn=0,n=5

      496    14091        /*
      497    14092                Setup to get timestamp specified for nodes.
      498    14093        */
      499    14094    2       FPT_TIME.V.SOURCE# = %LOCAL#;

  14094 13 001142   003000 236003                    LDQ     1536,DU
        13 001143   200770 552140                    STBQ    FPT_TIME+10,'40'O,AUTO

      500    14095    2       FPT_TIME.V.DEST# = %UTS#;

  14095 13 001144   000004 236003                    LDQ     4,DU
        13 001145   200770 552120                    STBQ    FPT_TIME+10,'20'O,AUTO

      501    14096    2       FPT_TIME.TSTAMP_ = VECTOR(OUT$ -> P$B.CPOS);

  14096 13 001146   200745 470500                    LDP0    @OUT$,,AUTO
        13 001147   000000 471500                    LDP1    0,,PR0
        13 001150   777640 235007                    LDA     -96,DL
        13 001151   200772 451500                    STP1    FPT_TIME+12,,AUTO
        13 001152   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 001153   000002 036003                    ADLQ    2,DU
        13 001154   200766 757100                    STAQ    FPT_TIME+8,,AUTO

      502    14097    2       OUT$ -> P$B.SCRITCH = %MINS_PER_DAY;

  14097 13 001155   000000 471500                    LDP1    0,,PR0
        13 001156   002640 220003                    LDX0    1440,DU
        13 001157   100001 440100                    SXL0    1,,PR1

      503    14098    3       DO I = OUT$ -> P$B.NSUBLKS - 1 DOWNTO 0;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:73   

  14098 13 001160   000000 471500                    LDP1    0,,PR0
        13 001161   100001 236100                    LDQ     1,,PR1
        13 001162   000022 772000                    QRL     18
        13 001163   000001 136007                    SBLQ    1,DL
        13 001164   200747 756100                    STQ     I,,AUTO
        13 001165   001302 710000 13                 TRA     s:14119+2

      504    14099    3           P$ = OUT$ -> P$B.SUBLK$(I);

  14099 13 001166   200745 470500                    LDP0    @OUT$,,AUTO
        13 001167   000000 471500                    LDP1    0,,PR0
        13 001170   200747 720100                    LXL0    I,,AUTO
        13 001171   100003 236110                    LDQ     3,X0,PR1
        13 001172   200746 756100                    STQ     P$,,AUTO

      505    14100    4           DO CASE (P$ -> P$B.CODE);

  14100 13 001173   200746 473500                    LDP3    P$,,AUTO
        13 001174   300000 721100                    LXL1    0,,PR3
        13 001175   000003 101003                    CMPX1   3,DU
        13 001176   001200 602011 13                 TNC     s:14100+5,X1
        13 001177   001300 710000 13                 TRA     s:14119
        13 001200   001300 710000 13                 TRA     s:14119
        13 001201   001203 710000 13                 TRA     s:14102
        13 001202   001245 710000 13                 TRA     s:14112

      506    14101    4           CASE (%OPTION_DATE);

      507    14102    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(0) -> P$S.TEXT);

  14102 13 001203   300003 474500                    LDP4    3,,PR3
        13 001204   400004 236100                    LDQ     4,,PR4
        13 001205   000033 772000                    QRL     27
        13 001206   000000 622006                    EAX2    0,QL
        13 001207   000100 305540                    DTB
        13 001210   400004 230012                    NDSC9   4,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:74   
        13 001211   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      508    14103    4               CALL BINCHAR(WORK_DATE.MONTH, J);

  14103 13 001212   000100 301500                    BTD
        13 001213   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
        13 001214   200751 030002                    NDSC9   WORK_DATE,,AUTO          cn=0,s=nosgn,sf=0,n=2

      509    14104    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(1) -> P$S.TEXT);

  14104 13 001215   300004 471500                    LDP1    4,,PR3
        13 001216   100004 236100                    LDQ     4,,PR1
        13 001217   000033 772000                    QRL     27
        13 001220   000000 621006                    EAX1    0,QL
        13 001221   000100 305540                    DTB
        13 001222   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
        13 001223   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      510    14105    4               CALL BINCHAR (WORK_DATE.DAY, J);

  14105 13 001224   000100 301500                    BTD
        13 001225   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
        13 001226   200751 630002                    NDSC9   WORK_DATE,,AUTO          cn=3,s=nosgn,sf=0,n=2

      511    14106    4               IF P$ -> P$B.NSUBLKS = 3

  14106 13 001227   300001 221100                    LDX1    1,,PR3
        13 001230   000003 101003                    CMPX1   3,DU
        13 001231   001300 601000 13                 TNZ     s:14119

      512    14107    5               THEN DO;         /* A year specified */

      513    14108    5                   CALL CHARBIN (J, P$ -> P$B.SUBLK$(2) -> P$S.TEXT);

  14108 13 001232   300005 471500                    LDP1    5,,PR3
        13 001233   100004 236100                    LDQ     4,,PR1
        13 001234   000033 772000                    QRL     27
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:75   
        13 001235   000000 622006                    EAX2    0,QL
        13 001236   000100 305540                    DTB
        13 001237   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
        13 001240   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      514    14109    5                   CALL BINCHAR (WORK_DATE.YEAR, J);

  14109 13 001241   000100 301500                    BTD
        13 001242   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
        13 001243   200752 430002                    NDSC9   WORK_DATE+1,,AUTO        cn=2,s=nosgn,sf=0,n=2

      515    14110    5               END;

  14110 13 001244   001300 710000 13                 TRA     s:14119

      516    14111    4           CASE (%OPTION_TIME);

      517    14112    4               OUT$ -> P$B.SCRITCH = 1;

  14112 13 001245   000001 222003                    LDX2    1,DU
        13 001246   100001 442100                    SXL2    1,,PR1

      518    14113    4               FPT_TIME.TIME_ = VECTOR(WORK_TIME);

  14113 13 001247   000010 235000 14                 LDA     8
        13 001250   200772 452500                    STP2    FPT_TIME+12,,AUTO
        13 001251   200772 236100                    LDQ     FPT_TIME+12,,AUTO
        13 001252   000753 036003                    ADLQ    491,DU
        13 001253   200762 757100                    STAQ    FPT_TIME+4,,AUTO

      519    14114    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(0) -> P$S.TEXT);

  14114 13 001254   300003 471500                    LDP1    3,,PR3
        13 001255   100004 236100                    LDQ     4,,PR1
        13 001256   000033 772000                    QRL     27
        13 001257   000000 621006                    EAX1    0,QL
        13 001260   000100 305540                    DTB
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:76   
        13 001261   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
        13 001262   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      520    14115    4               CALL BINCHAR (WORK_TIME.HOUR, J);

  14115 13 001263   000100 301500                    BTD
        13 001264   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
        13 001265   200753 030002                    NDSC9   WORK_TIME,,AUTO          cn=0,s=nosgn,sf=0,n=2

      521    14116    4               CALL CHARBIN (J, P$ -> P$B.SUBLK$(1) -> P$S.TEXT);

  14116 13 001266   300004 471500                    LDP1    4,,PR3
        13 001267   100004 236100                    LDQ     4,,PR1
        13 001270   000033 772000                    QRL     27
        13 001271   000000 621006                    EAX1    0,QL
        13 001272   000100 305540                    DTB
        13 001273   100004 230011                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X1
        13 001274   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      522    14117    4               CALL BINCHAR (WORK_TIME.MIN, J);

  14117 13 001275   000100 301500                    BTD
        13 001276   200750 000004                    NDSC9   J,,AUTO                  cn=0,s=lsgnf,sf=0,n=4
        13 001277   200753 630002                    NDSC9   WORK_TIME,,AUTO          cn=3,s=nosgn,sf=0,n=2

      523    14118    4           END;

      524    14119    3       END;

  14119 13 001300   000001 336007                    LCQ     1,DL
        13 001301   200747 056100                    ASQ     I,,AUTO
        13 001302   200747 235100                    LDA     I,,AUTO
        13 001303   001166 605000 13                 TPL     s:14099

      525    14120        /*
      526    14121              ***** Now convert the timestamp into a uts ...
      527    14122        */
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:77   
      528    14123    2       CALL M$TIME (FPT_TIME) ALTRET(BAD_TIME);

  14123 13 001304   200756 630500                    EPPR0   FPT_TIME,,AUTO
        13 001305   420004 713400                    CLIMB   alt,+8196
        13 001306   402000 401760                    pmme    nvectors=5
        13 001307   001312 702000 13                 TSX2    BAD_TIME

      529    14124    2       RETURN;

  14124 13 001310   200744 221300                    LDX1  ! VALUE$+2,,AUTO
        13 001311   000001 702211                    TSX2  ! 1,X1

  14117 13 001312                       BAD_TIME     null
      530    14125
      531    14126    2   BAD_TIME: ;
      532    14127    2       ALTRETURN;

  14127 13 001312   200744 221300                    LDX1  ! VALUE$+2,,AUTO
        13 001313   000000 702211                    TSX2  ! 0,X1

      533    14128    2   END DATE_INIT;
      534    14129        %EJECT;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:78   
      535    14130        /*
      536    14131             ***** Main routine for evaluating expressions.
      537    14132                   Handles stacking/reduction decisions and
      538    14133                   calls such routines as needed to perform
      539    14134                   reduction and lexical analysis.
      540    14135                   This routine is called recursively...
      541    14136        */
      542    14137    1       OP_PTR = 0;

  14137 13 001314   200012 450100                    STZ     OP_PTR,,AUTO

      543    14138    1       VAL_PTR = -1;

  14138 13 001315   000001 335007                    LCA     1,DL
        13 001316   200013 755100                    STA     VAL_PTR,,AUTO

      544    14139    1       OP_STACK(0) = %SEL_BEGIN_MARKER;

  14139 13 001317   200417 450100                    STZ     OP_STACK,,AUTO

      545    14140    1       TOKEN_INDX = -1;

  14140 13 001320   200015 755100                    STA     TOKEN_INDX,,AUTO

      546    14141        /*
      547    14142             ***** Get the first token to start processing ...
      548    14143        */
      549    14144    1       CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);

  14144 13 001321   200006 630500                    EPPR0   VALUE$,,AUTO
        13 001322   200736 450500                    STP0    STRING$+1,,AUTO
        13 001323   200016 631500                    EPPR1   TOKEN,,AUTO
        13 001324   200735 451500                    STP1    CHARPOS_STACK+52,,AUTO
        13 001325   000003 701000 13                 TSX1    LEX
        13 001326   001552 702000 13                 TSX2    E_EVAL

      550    14145        /*
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:79   
      551    14146             ***** Main LOOP...
      552    14147                   Loop here while there are operators to process...
      553    14148        */
      554    14149    2       DO WHILE (%YES#);

      555    14150    3           DO CASE (TOKEN);

  14150 13 001327   200016 235100                    LDA     TOKEN,,AUTO
        13 001330   000041 115007                    CMPA    33,DL
        13 001331   001333 602005 13                 TNC     s:14150+4,AL
        13 001332   001505 710000 13                 TRA     s:14224
        13 001333   001505 710000 13                 TRA     s:14224
        13 001334   001424 710000 13                 TRA     s:14173
        13 001335   001437 710000 13                 TRA     s:14191
        13 001336   001437 710000 13                 TRA     s:14191
        13 001337   001437 710000 13                 TRA     s:14191
        13 001340   001437 710000 13                 TRA     s:14191
        13 001341   001437 710000 13                 TRA     s:14191
        13 001342   001437 710000 13                 TRA     s:14191
        13 001343   001437 710000 13                 TRA     s:14191
        13 001344   001437 710000 13                 TRA     s:14191
        13 001345   001437 710000 13                 TRA     s:14191
        13 001346   001505 710000 13                 TRA     s:14224
        13 001347   001505 710000 13                 TRA     s:14224
        13 001350   001505 710000 13                 TRA     s:14224
        13 001351   001505 710000 13                 TRA     s:14224
        13 001352   001505 710000 13                 TRA     s:14224
        13 001353   001505 710000 13                 TRA     s:14224
        13 001354   001505 710000 13                 TRA     s:14224
        13 001355   001505 710000 13                 TRA     s:14224
        13 001356   001505 710000 13                 TRA     s:14224
        13 001357   001505 710000 13                 TRA     s:14224
        13 001360   001505 710000 13                 TRA     s:14224
        13 001361   001505 710000 13                 TRA     s:14224
        13 001362   001505 710000 13                 TRA     s:14224
        13 001363   001505 710000 13                 TRA     s:14224
        13 001364   001505 710000 13                 TRA     s:14224
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:80   
        13 001365   001505 710000 13                 TRA     s:14224
        13 001366   001505 710000 13                 TRA     s:14224
        13 001367   001505 710000 13                 TRA     s:14224
        13 001370   001505 710000 13                 TRA     s:14224
        13 001371   001374 710000 13                 TRA     s:14155
        13 001372   001374 710000 13                 TRA     s:14155
        13 001373   001374 710000 13                 TRA     s:14155

      556    14151    3           CASE (%SEL_DECIMAL,

      557    14152    3             %SEL_EXP,
      558    14153    3             %SEL_QUOTE);
      559    14154                    %PUSH_VALUE;

  14155 13 001374   200013 054100                    AOS     VAL_PTR,,AUTO

  14156 13 001375   200013 236100                    LDQ     VAL_PTR,,AUTO
        13 001376   000031 116007                    CMPQ    25,DL
        13 001377   001406 604400 13                 TMOZ    s:14165

  14159 13 001400   000004 236000 11                 LDQ     E_STKOVFL
        13 001401   200004 470500                    LDP0    @VM_SELECT,,AUTO
        13 001402   000000 756100                    STQ     0,,PR0

  14160 13 001403   200011 235100                    LDA     CHARPOS,,AUTO
        13 001404   000001 755100                    STA     1,,PR0

  14161 13 001405   000000 702200 xent               TSX2  ! X66_AALT

  14165 13 001406   200006 236100                    LDQ     VALUE$,,AUTO
        13 001407   200013 720100                    LXL0    VAL_PTR,,AUTO
        13 001410   200503 756110                    STQ     VAL_STACK$,X0,AUTO

  14166 13 001411   000777 235007                    LDA     511,DL
        13 001412   200566 755110                    STA     VAL_TYPE,X0,AUTO

  14167 13 001413   200011 721100                    LXL1    CHARPOS,,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:81   
        13 001414   200651 741110                    STX1    CHARPOS_STACK,X0,AUTO

      560    14170    3               CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);

  14170 13 001415   200006 630500                    EPPR0   VALUE$,,AUTO
        13 001416   200736 450500                    STP0    STRING$+1,,AUTO
        13 001417   200016 631500                    EPPR1   TOKEN,,AUTO
        13 001420   200735 451500                    STP1    CHARPOS_STACK+52,,AUTO
        13 001421   000003 701000 13                 TSX1    LEX
        13 001422   001552 702000 13                 TSX2    E_EVAL
        13 001423   001327 710000 13                 TRA     s:14150

      561    14171    3           CASE (%SEL_END_MARKER);

      562    14172    4               DO WHILE (%YES#);

      563    14173    4                   IF OP_STACK(OP_PTR) = %SEL_BEGIN_MARKER

  14173 13 001424   200012 720100                    LXL0    OP_PTR,,AUTO
        13 001425   200417 235110                    LDA     OP_STACK,X0,AUTO
        13 001426   001434 601000 13                 TNZ     s:14180

      564    14174    4                   THEN
      565    14175    5                   DO;

      566    14176    5                       RESULT$ = VAL_STACK$(VAL_PTR);

  14176 13 001427   200013 721100                    LXL1    VAL_PTR,,AUTO
        13 001430   200503 236111                    LDQ     VAL_STACK$,X1,AUTO
        13 001431   200005 470500                    LDP0    @RESULT$,,AUTO
        13 001432   000000 756100                    STQ     0,,PR0

      567    14177    5                       RETURN;

  14177 13 001433   000000 702200 xent               TSX2  ! X66_ARET

      568    14178    5                   END;
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:82   
      569    14179    4                   ELSE
      570    14180    4                       CALL REDUCE ALTRET(E_EVAL);

  14180 13 001434   000155 701000 13                 TSX1    REDUCE
        13 001435   001552 702000 13                 TSX2    E_EVAL

      571    14181    4               END;                  /* Shrink stacks loop                 */

  14181 13 001436   001424 710000 13                 TRA     s:14173

      572    14182    3           CASE (%SEL_AND,

      573    14183    3                 %SEL_OR,
      574    14184    3                 %SEL_NOT,
      575    14185    3                 %SEL_EQUAL,
      576    14186    3                 %SEL_NEQUAL,
      577    14187    3                 %SEL_GTHAN,
      578    14188    3                 %SEL_GEQUAL,
      579    14189    3                 %SEL_LTHAN,
      580    14190    3                 %SEL_LEQUAL);
      581    14191    3               MORE# = %YES#;

  14191 13 001437   400000 236003                    LDQ     -131072,DU
        13 001440   200010 756100                    STQ     MORE#,,AUTO

      582    14192    4               DO WHILE (MORE#);

  14192 13 001441   200010 234100                    SZN     MORE#,,AUTO
        13 001442   001327 605000 13                 TPL     s:14150

      583    14193        /*
      584    14194             ***** Decide whether to stack or reduce ...
      585    14195        */
      586    14196    4                   IF PRECIDENCE(TOKEN) > PRECIDENCE(OP_STACK(OP_PTR))

  14196 13 001443   200012 720100                    LXL0    OP_PTR,,AUTO
        13 001444   200417 721110                    LXL1    OP_STACK,X0,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:83   
        13 001445   200016 722100                    LXL2    TOKEN,,AUTO
        13 001446   000010 236011 11                 LDQ     PRECIDENCE,X1
        13 001447   000010 116012 11                 CMPQ    PRECIDENCE,X2
        13 001450   001500 603000 13                 TRC     s:14218

      587    14197    4                   THEN
      588    14198    5                   DO;

      589    14199                            %PUSH_OPERATOR (NARGS="NUM_TO_POP(TOKEN)");

  14200 13 001451   200012 054100                    AOS     OP_PTR,,AUTO

  14201 13 001452   200012 235100                    LDA     OP_PTR,,AUTO
        13 001453   000031 115007                    CMPA    25,DL
        13 001454   001463 604400 13                 TMOZ    s:14210

  14204 13 001455   000004 236000 11                 LDQ     E_STKOVFL
        13 001456   200004 470500                    LDP0    @VM_SELECT,,AUTO
        13 001457   000000 756100                    STQ     0,,PR0

  14205 13 001460   200011 235100                    LDA     CHARPOS,,AUTO
        13 001461   000001 755100                    STA     1,,PR0

  14206 13 001462   000000 702200 xent               TSX2  ! X66_AALT

  14210 13 001463   200016 236100                    LDQ     TOKEN,,AUTO
        13 001464   200417 756105                    STQ     OP_STACK,AL,AUTO

  14211 13 001465   200012 720100                    LXL0    OP_PTR,,AUTO
        13 001466   000053 235012 11                 LDA     NUM_TO_POP,X2
        13 001467   200451 755110                    STA     NUM_TO_POP_STACK,X0,AUTO

      590    14214    5                       MORE# = %NO#;

  14214 13 001470   200010 450100                    STZ     MORE#,,AUTO

      591    14215    5                       CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:84   

  14215 13 001471   200006 630500                    EPPR0   VALUE$,,AUTO
        13 001472   200736 450500                    STP0    STRING$+1,,AUTO
        13 001473   200016 631500                    EPPR1   TOKEN,,AUTO
        13 001474   200735 451500                    STP1    CHARPOS_STACK+52,,AUTO
        13 001475   000003 701000 13                 TSX1    LEX
        13 001476   001552 702000 13                 TSX2    E_EVAL

      592    14216    5                   END;

  14216 13 001477   001502 710000 13                 TRA     s:14219

      593    14217    4                   ELSE             /* Reduce                             */
      594    14218    4                       CALL REDUCE ALTRET(E_EVAL);

  14218 13 001500   000155 701000 13                 TSX1    REDUCE
        13 001501   001552 702000 13                 TSX2    E_EVAL

      595    14219    4               END;                  /* Do while (MORE#) ... end */

  14219 13 001502   200010 234100                    SZN     MORE#,,AUTO
        13 001503   001443 604000 13                 TMI     s:14196
        13 001504   001327 710000 13                 TRA     s:14150

      596    14220    3           CASE (ELSE);

      597    14221        /*
      598    14222             ***** Built-in functions ...
      599    14223        */
      600    14224    3               MORE# = %YES#;

  14224 13 001505   400000 236003                    LDQ     -131072,DU
        13 001506   200010 756100                    STQ     MORE#,,AUTO

      601    14225    4               DO WHILE (MORE#);

  14225 13 001507   200010 234100                    SZN     MORE#,,AUTO
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:85   
        13 001510   001327 605000 13                 TPL     s:14150

      602    14226        /*
      603    14227             ***** If this is a function with arguments,
      604    14228                   then get those args onto the VAL_STACK$ ...
      605    14229        */
      606    14230    4                   NUM_ARGS = 0;

  14230 13 001511   200014 450100                    STZ     NUM_ARGS,,AUTO

      607    14231    4                   IF NUM_TO_POP(TOKEN) > 0

  14231 13 001512   200016 720100                    LXL0    TOKEN,,AUTO
        13 001513   000053 235010 11                 LDA     NUM_TO_POP,X0
        13 001514   001521 600000 13                 TZE     s:14239

      608    14232    4                   THEN        /* Get the arguments for this function     */
      609    14233    4                       CALL GET_ARGS (NUM_ARGS) ALTRET(E_EVAL);

  14233 13 001515   200014 630500                    EPPR0   NUM_ARGS,,AUTO
        13 001516   200735 450500                    STP0    CHARPOS_STACK+52,,AUTO
        13 001517   000110 701000 13                 TSX1    GET_ARGS
        13 001520   001552 702000 13                 TSX2    E_EVAL

      610    14234        /*
      611    14235             ***** Since functions have the highest precidence,
      612    14236                   they are always applied as soon as found ...
      613    14237        */
      614    14238                        %PUSH_OPERATOR (NARGS="NUM_ARGS");

  14239 13 001521   200012 054100                    AOS     OP_PTR,,AUTO

  14240 13 001522   200012 235100                    LDA     OP_PTR,,AUTO
        13 001523   000031 115007                    CMPA    25,DL
        13 001524   001533 604400 13                 TMOZ    s:14249

  14243 13 001525   000004 236000 11                 LDQ     E_STKOVFL
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:86   
        13 001526   200004 470500                    LDP0    @VM_SELECT,,AUTO
        13 001527   000000 756100                    STQ     0,,PR0

  14244 13 001530   200011 235100                    LDA     CHARPOS,,AUTO
        13 001531   000001 755100                    STA     1,,PR0

  14245 13 001532   000000 702200 xent               TSX2  ! X66_AALT

  14249 13 001533   200016 236100                    LDQ     TOKEN,,AUTO
        13 001534   200417 756105                    STQ     OP_STACK,AL,AUTO

  14250 13 001535   200014 235100                    LDA     NUM_ARGS,,AUTO
        13 001536   200012 720100                    LXL0    OP_PTR,,AUTO
        13 001537   200451 755110                    STA     NUM_TO_POP_STACK,X0,AUTO

      615    14253    4                   MORE# = %NO#;

  14253 13 001540   200010 450100                    STZ     MORE#,,AUTO

      616    14254    4                   CALL LEX (TOKEN,VALUE$) ALTRET(E_EVAL);

  14254 13 001541   200006 630500                    EPPR0   VALUE$,,AUTO
        13 001542   200736 450500                    STP0    STRING$+1,,AUTO
        13 001543   200016 631500                    EPPR1   TOKEN,,AUTO
        13 001544   200735 451500                    STP1    CHARPOS_STACK+52,,AUTO
        13 001545   000003 701000 13                 TSX1    LEX
        13 001546   001552 702000 13                 TSX2    E_EVAL

      617    14255    4               END;                  /* Do while (MORE#) ... end */

  14255 13 001547   200010 234100                    SZN     MORE#,,AUTO
        13 001550   001511 604000 13                 TMI     s:14230

      618    14256    3           END;                        /* Do case ... end */

      619    14257    2       END;                            /* Do while (yes) ... end */

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:87   
  14257 13 001551   001327 710000 13                 TRA     s:14150

      620    14258    1   E_EVAL:
      621    14259    1       ALTRETURN;

  14259 13 001552   000000 702200 xent  E_EVAL       TSX2  ! X66_AALT

ZERO$
 Sect OctLoc
  11     000   000001 006000                                                    ....

ZERO
 Sect OctLoc
  11     001   001060 ******                                                    .0..

ONE$
 Sect OctLoc
  11     002   000003 006000                                                    ....

ONE
 Sect OctLoc
  11     003   001061 ******                                                    .1..

E_STKOVFL
 Sect OctLoc
  11     004   261523 000350                                                    ....

E_NONDECIMAL
 Sect OctLoc
  11     005   261523 000360                                                    ....

E_STKFLT
 Sect OctLoc
  11     006   261523 000370                                                    ....

E_ILLEGALNULL
 Sect OctLoc
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:88   
  11     007   261523 010130                                                    ...X

PRECIDENCE
 Sect OctLoc
  11     010   000000 000000   000000 000000   000000 000003   000000 000002    ................
  11     014   000000 000001   000000 000004   000000 000004   000000 000004    ................
  11     020   000000 000004   000000 000004   000000 000004   000000 000143    ...............c
  11     024   000000 000143   000000 000143   000000 000143   000000 000143    ...c...c...c...c
  11     050*  000000 000143   000000 000143   000000 000143                    ...c...c...c

NUM_TO_POP
 Sect OctLoc
  11     053   000000 000000   000000 000000   000000 000001   000000 000002    ................
  11     057   000000 000002   000000 000002   000000 000002   000000 000002    ................
  11     063   000000 000002   000000 000002   000000 000002   000000 000000    ................
  11     067   000000 000000   000000 000000   000000 000000   000000 000000    ................
  11     073   000000 000000   000000 000001   000000 000000   000000 000000    ................
  11     077   000000 000000   000000 000001   000000 000001   000000 000000    ................
  11     103   000000 000000   000000 000000   000000 000001   000000 000001    ................
  11     107   000000 000000   000000 000000   000000 000000   000000 000000    ................
  11     113   000000 000000   000000 000001   000000 000001                    ............

INIT_TIMEC
 Sect OctLoc
  11     116   060060 072060   060*** ******                                    00:00...

FPT_TIME_C
 Sect OctLoc
  11     120   000001 777640   000132 006000   000000 177640   000000 006014    .....Z..........
  11     124   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     130   000000 177640   000000 006014   000003 000000   ****** ******    ................

(unnamed)
 Sect OctLoc
  11     134   056040 040040                                                    .

VM_WILDCARD
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:89   
 Sect OctLoc
  12     000   000000 177640   000000 006014   000000 177640   000000 006014    ................
  12     010*  000000 000000   077400 000000   000000 000000   000000 000000    ....?...........

(unnamed)
 Sect OctLoc
  14     000   000003 000000   000002 000000   000000 006014   000001 000000    ................
  14     004   000017 200000   000217 200000   000000 006000   000001 777640    ................
  14     010   000001 177640                                                    ....
      622    14260    1   END VMS$SELECT;
      623    14261        %EOD;

PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:90   
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   XUD_UTS_M.:LIB_E05  is referenced.
   XUW_MACRO_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMS$SELECT.
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:91   

 **** Variables and constants ****

  ****  Section 011 RoData VMS$SELECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w STRC        r     1 E_ILLEGALNULL              5-0-0/w STRC        r     1 E_NONDECIMAL
     6-0-0/w STRC        r     1 E_STKFLT                   4-0-0/w STRC        r     1 E_STKOVFL
   120-0-0/d STRC(432)   r     1 FPT_TIME_C               116-0-0/c CHAR(5)     r     1 INIT_TIMEC
    53-0-0/w UBIN        r     1 NUM_TO_POP(0:34)
     3-0-0/c STRC(18)    r     1 ONE                        2-0-0/w PTR         r     1 ONE$
    10-0-0/w UBIN        r     1 PRECIDENCE(0:34)
     1-0-0/c STRC(18)    r     1 ZERO                       0-0-0/w PTR         r     1 ZERO$

  ****  Section 012  Data  VMS$SELECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 VM_WILDCARD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   735-0-0/w PTR         r     1 @NUM_ARGS                745-0-0/w PTR         r     1 @OUT$
     5-0-0/w PTR         r     1 @RESULT$                 735-0-0/w PTR         r     1 @TOKEN
     3-0-0/w PTR         r     1 @TREE$                   736-0-0/w PTR         r     1 @VALUE$
     4-0-0/w PTR         r     1 @VM_SELECT               736-0-0/w SBIN        r     1 ARG_INDX
   737-0-0/w PTR               1 ARG_PTR$                  11-0-0/w UBIN        r     1 CHARPOS
   651-0-0/w UBIN(18)    r     1 CHARPOS_STACK(0:50)
   736-0-0/w UBIN        r     1 DATE1                    737-0-0/w UBIN        r     1 DATE2
   740-0-0/w UBIN        r     1 DATE3                    756-0-0/d STRC(432)   r     1 FPT_TIME
   747-0-0/w SBIN        r     1 I                        750-0-0/w SBIN        r     1 J
   741-0-0/w UBIN        r     1 K                         10-0-0/b BIT         r     1 MORE#
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:92   
   737-0-0/w PTR               1 NAME$                     14-0-0/w SBIN        r     1 NUM_ARGS
    *0-0-0/w SBIN        r     1 NUM_ARGS
   451-0-0/w UBIN        r     1 NUM_TO_POP_STACK(0:25)
    12-0-0/w SBIN        r     1 OP_PTR
   417-0-0/w UBIN        r     1 OP_STACK(0:25)
    *0-0-0/w PTR         r     1 OUT$                     746-0-0/w PTR         r     1 P$
    *0-0-0/w PTR         r     1 RESULT$                  735-0-0/w PTR         r     1 STRING$
   736-0-0/w SBIN        r     1 TEMP1                    737-0-0/w SBIN        r     1 TEMP2
    16-0-0/w UBIN        r     1 TOKEN                     *0-0-0/w UBIN        r     1 TOKEN
    15-0-0/w SBIN        r     1 TOKEN_INDX                 7-0-0/w PTR         r     1 TOKEN_PTR$
    *0-0-0/w PTR         r     1 TREE$                      6-0-0/w PTR         r     1 VALUE$
    *0-0-0/w PTR         r     1 VALUE$                   740-0-0/w PTR         r     1 VALUE$
   742-0-0/w PTR         r     1 VALUE$                    13-0-0/w SBIN        r     1 VAL_PTR
   503-0-0/w PTR         r     1 VAL_STACK$(0:50)
   566-0-0/w UBIN        r     1 VAL_TYPE(0:50)
    *0-0-0/w STRC(72)    r     1 VM_SELECT                 17-0-0/c STRC(4608)  r     1 WORK1
   217-0-0/c STRC(4608)  r     1 WORK2                    751-0-0/c STRC(72)    r     1 WORK_DATE
   753-0-0/c STRC(45)    r     1 WORK_TIME                753-0-0/c CHAR(5)     r     1 WORK_TIMEC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w PTR         r     1 B$XL_UPPER$                0-0-0/c ASTR(9)     r     1 ERRMSG_FID
     0-0-0/w UBIN              1 M$DO_NUM                   0-0-0/w UBIN              1 M$LO_NUM
     0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM         0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM
     0-0-0/w UBIN              1 M$MAIL_FILE_NUM            0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM
     0-0-0/w UBIN              1 M$ME_NUM                   0-0-0/w UBIN              1 M$NODE_NUM
     0-0-0/w UBIN              1 M$SI_NUM                   0-0-0/w UBIN              1 M$WORK_NUM
     0-0-0/w PTR               1 VM_ADDLIST$                0-0-0/d VECT              1 VM_ADDLIST_
     0-0-0/w PTR               1 VM_ADDREC$                 0-0-0/d VECT              1 VM_ADDREC_
     0-0-0/w PTR               1 VM_COPY$                   0-0-0/d VECT              1 VM_COPY_
     0-0-0/w PTR               1 VM_ENCLLIST$               0-0-0/d VECT              1 VM_ENCLLIST_
     0-0-0/w PTR               1 VM_ENCLREC$                0-0-0/d VECT              1 VM_ENCLREC_
     0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME       0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:93   
     0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS       0-0-0/w PTR         r     1 VM_HEADER$
     0-0-0/d VECT              1 VM_HEADER_                 0-0-0/d VECT              1 VM_HEADER_INIT_
     0-0-0/w PTR               1 VM_INPUT$                  0-0-0/d VECT              1 VM_INPUT_
     0-0-0/c STRC(72)          1 VM_MAILCG_NAME             0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA
     0-0-0/c STRC(72)          1 VM_MAIL_ACCT               0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME
     0-0-0/w PTR               1 VM_PARSEAREA$              0-0-0/d VECT              1 VM_PARSEAREA_
     0-0-0/w PTR               1 VM_PROFILE$                0-0-0/d VECT              1 VM_PROFILE_
     0-0-0/w PTR               1 VM_SELECT$                 0-0-0/d VECT              1 VM_SELECT_
     0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME          0-0-0/c CHAR(8)           1 VM_SITENAME
     0-0-0/w PTR               1 VM_WORK$                   0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC(4608)  r     1 LOWER_UPPER                0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$MAIL_CENTRAL
     0-0-0N  NULL        r     1 M$MAIL_COMGROUP            0-0-0N  NULL        r     1 M$MAIL_FILE
     0-0-0N  NULL        r     1 M$MAIL_GLOBAL              0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$NODE                     0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$WORK
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S
     0-0-0/w STRC(1332)  r     1 VM_HEADER                  0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMS$SELECT requires 875 words for executable code.
   Procedure VMS$SELECT requires 510 words of local(AUTO) storage.
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:94   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:95   
          MINI XREF LISTING

ARG_INDX IN PROCEDURE GET_ARGS
     13739**DCL     13744<<DOINDEX 13745>>ASSIGN
B$ALT.CODE
     13219**DCL     13219--REDEF   13220--REDEF   13220--REDEF
B$ALT.ERR
     13220**DCL     14001>>ASSIGN
B$ALT.ERR.ERR#
     13221**DCL     13221--REDEF
B$ALT.EVID
     13220**DCL     13220--REDEF   13220--REDEF
B$TCB.ALT$
     13215**DCL     14001>>ASSIGN
B$TCB$
     12642**DCL     13215--IMP-PTR 14001>>ASSIGN
B$XL_UPPER$
     12974**DCL     12975--IMP-PTR 13931>>CALLBLT 13934>>CALLBLT
BAD_TIME IN PROCEDURE DATE_INIT
     14117**LABEL   14123--CALLALT
CHARPOS
     13230**DCL     13710<<ASSIGN  13722>>ASSIGN  13757>>ASSIGN  13980>>ASSIGN  13987>>ASSIGN  14160>>ASSIGN
     14167>>ASSIGN  14205>>ASSIGN  14244>>ASSIGN
CHARPOS_STACK
     13296**DCL     13764<<ASSIGN  13794>>ASSIGN  13987<<ASSIGN  14002>>ASSIGN  14006>>ASSIGN  14011>>ASSIGN
     14167<<ASSIGN
DATE1 IN PROCEDURE REDUCE
     13774**DCL     13835<<ASSIGN  13838<<ASSIGN  13846>>IF      13846>>IF      13850>>IF      13850>>IF
     13854>>IF      13858>>IF      13862>>IF      13866>>IF
DATE2 IN PROCEDURE REDUCE
     13776**DCL     13842<<ASSIGN  13843<>CALL    13846>>IF      13850>>IF      13858>>IF      13862>>IF
DATE3 IN PROCEDURE REDUCE
     13777**DCL     13843<>CALL    13846>>IF      13850>>IF      13854>>IF      13866>>IF
DATE_COMPARER IN PROCEDURE REDUCE
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:96   
     13840**LABEL   13836--GOTO
DATE_INIT
     14015**PROC    13840--CALL
ERRMSG_FID.L#
     12710**DCL     12710--IMP-SIZ
E_DATE IN PROCEDURE REDUCE
     14001**LABEL   13840--CALLALT
E_DEC1 IN PROCEDURE REDUCE
     14005**LABEL   13809--CALLALT 13816--CALLALT
E_DEC2 IN PROCEDURE REDUCE
     14010**LABEL   13802--CALLALT 13810--CALLALT 13817--CALLALT
E_EVAL
     14259**LABEL   14144--CALLALT 14170--CALLALT 14180--CALLALT 14215--CALLALT 14218--CALLALT 14233--CALLALT
     14254--CALLALT
E_ILLEGALNULL
     13635**DCL     13721>>ASSIGN
E_LEX IN PROCEDURE LEX
     13732**LABEL   13713--CALLALT
E_NONDECIMAL
     13524**DCL     14005>>ASSIGN  14010>>ASSIGN
E_REDUCE IN PROCEDURE REDUCE
     13998**LABEL   13795--GOTO
E_STKFLT
     13580**DCL     13793>>ASSIGN
E_STKOVFL
     13469**DCL     13756>>ASSIGN  13979>>ASSIGN  14159>>ASSIGN  14204>>ASSIGN  14243>>ASSIGN
FPT_TIME IN PROCEDURE DATE_INIT
     14067**DCL     14086<<ASSIGN  14089<>CALL    14123<>CALL
FPT_TIME.DATE_ IN PROCEDURE DATE_INIT
     14067**DCL     14088<<ASSIGN
FPT_TIME.TIME_ IN PROCEDURE DATE_INIT
     14069**DCL     14113<<ASSIGN
FPT_TIME.TSTAMP_ IN PROCEDURE DATE_INIT
     14070**DCL     14096<<ASSIGN
FPT_TIME.V IN PROCEDURE DATE_INIT
     14071**DCL     14087--ASSIGN
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:97   
FPT_TIME.V.DEST# IN PROCEDURE DATE_INIT
     14071**DCL     14095<<ASSIGN
FPT_TIME.V.SOURCE# IN PROCEDURE DATE_INIT
     14071**DCL     14094<<ASSIGN
FPT_TIME.V_ IN PROCEDURE DATE_INIT
     14067**DCL     14087<<ASSIGN
FPT_TIME_C IN PROCEDURE DATE_INIT
     14048**DCL     14086>>ASSIGN
FPT_TIME_C.V IN PROCEDURE DATE_INIT
     14052**DCL     14048--DCLINIT
GET_ARGS
     13735**PROC    14233--CALL
I IN PROCEDURE DATE_INIT
     14020**DCL     14098<<DOINDEX 14099>>ASSIGN
INIT_TIMEC IN PROCEDURE DATE_INIT
     14033**DCL     14090>>ASSIGN
J IN PROCEDURE DATE_INIT
     14021**DCL     14102<<CALLBLT 14103>>CALLBLT 14104<<CALLBLT 14105>>CALLBLT 14108<<CALLBLT 14109>>CALLBLT
     14114<<CALLBLT 14115>>CALLBLT 14116<<CALLBLT 14117>>CALLBLT
K IN PROCEDURE REDUCE
     13778**DCL     13841<<ASSIGN  13843<>CALL
LEX
     13696**PROC    14144--CALL    14170--CALL    14215--CALL    14254--CALL
LOWER_UPPER
     12975**DCL     13931>>CALLBLT 13934>>CALLBLT
M$TIME
      5569**DCL-ENT 14089--CALL    14123--CALL
MORE#
     13229**DCL     14191<<ASSIGN  14192>>DOWHILE 14214<<ASSIGN  14224<<ASSIGN  14225>>DOWHILE 14253<<ASSIGN
NO_MATCH IN PROCEDURE REDUCE
     13955**LABEL   13927--GOTO    13930--GOTO    13939--GOTO
NUM_ARGS
     13233**DCL     14230<<ASSIGN  14233<>CALL    14250>>ASSIGN
NUM_ARGS IN PROCEDURE GET_ARGS
     13737**DCL     13735--PROC    13743<<ASSIGN
NUM_TO_POP
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:98   
     13689**DCL     13743>>ASSIGN  14211>>ASSIGN  14231>>IF
NUM_TO_POP_STACK
     13293**DCL     13790>>IF      13969>>ASSIGN  14211<<ASSIGN  14250<<ASSIGN
ONE
     13303**DCL     13302--DCLINIT
ONE$
     13302**DCL     13807>>ASSIGN  13814>>ASSIGN  13821>>ASSIGN  13825>>ASSIGN  13829>>ASSIGN  13833>>ASSIGN
     13848>>ASSIGN  13852>>ASSIGN  13856>>ASSIGN  13860>>ASSIGN  13864>>ASSIGN  13868>>ASSIGN  13873>>ASSIGN
     13877>>ASSIGN  13881>>ASSIGN  13885>>ASSIGN  13889>>ASSIGN  13896>>ASSIGN  13900>>ASSIGN  13904>>ASSIGN
     13908>>ASSIGN  13918>>ASSIGN  13948>>ASSIGN  13956>>ASSIGN  13963>>ASSIGN
OP_PTR
     13231**DCL     13790>>IF      13800>>DOCASE  13969>>ASSIGN  13994<<ASSIGN  13994>>ASSIGN  14137<<ASSIGN
     14173>>IF      14196>>IF      14200<<ASSIGN  14200>>ASSIGN  14201>>IF      14210>>ASSIGN  14211>>ASSIGN
     14239<<ASSIGN  14239>>ASSIGN  14240>>IF      14249>>ASSIGN  14250>>ASSIGN
OP_STACK
     13292**DCL     13800>>DOCASE  14139<<ASSIGN  14173>>IF      14196>>IF      14210<<ASSIGN  14249<<ASSIGN
OUT$ IN PROCEDURE DATE_INIT
     14017**DCL     14015--PROC    14080>>IF      14096>>ASSIGN  14097>>ASSIGN  14098>>DOINDEX 14099>>ASSIGN
     14112>>ASSIGN
P$ IN PROCEDURE DATE_INIT
     14019**DCL     14099<<ASSIGN  14100>>DOCASE  14102>>CALLBLT 14102>>CALLBLT 14104>>CALLBLT 14104>>CALLBLT
     14106>>IF      14108>>CALLBLT 14108>>CALLBLT 14114>>CALLBLT 14114>>CALLBLT 14116>>CALLBLT 14116>>CALLBLT
P$B.CODE
     13016**DCL     13709>>ASSIGN  13711>>DOCASE  13844>>DOCASE  13947>>IF      13955>>IF      14100>>DOCASE
P$B.CPOS
     13034**DCL     13710>>ASSIGN  13764>>ASSIGN  13842>>ASSIGN  14096--ASSIGN
P$B.NSUBLKS
     13020**DCL     13703>>IF      13744>>DOINDEX 14098>>DOINDEX 14106>>IF
P$B.SCRITCH
     13024**DCL     13841>>ASSIGN  14080>>IF      14097<<ASSIGN  14112<<ASSIGN
P$B.SUBLK$
     13041**DCL     13708>>ASSIGN  13711>>DOCASE  13745>>ASSIGN  13840<>CALL    13841>>ASSIGN  13842>>ASSIGN
     13931>>CALLBLT 13931>>CALLBLT 13933>>ASSIGN  14099>>ASSIGN  14102>>CALLBLT 14102>>CALLBLT 14104>>CALLBLT
     14104>>CALLBLT 14108>>CALLBLT 14108>>CALLBLT 14114>>CALLBLT 14114>>CALLBLT 14116>>CALLBLT 14116>>CALLBLT
P$S.COUNT
     13077**DCL     13080--IMP-SIZ 13931>>CALLBLT 13933>>ASSIGN  14102>>CALLBLT 14104>>CALLBLT 14108>>CALLBLT
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:99   
     14114>>CALLBLT 14116>>CALLBLT
P$S.TEXT
     13080**DCL     13931>>CALLBLT 14102>>CALLBLT 14104>>CALLBLT 14108>>CALLBLT 14114>>CALLBLT 14116>>CALLBLT
P$S.TEXTC$
     13072**DCL     13715>>ASSIGN  13717>>ASSIGN
PRECIDENCE
     13676**DCL     14196>>IF      14196>>IF
REDUCE
     13770**PROC    14180--CALL    14218--CALL
RESULT$
     13000**DCL        13--PROC    14176<<ASSIGN
STRING$ IN PROCEDURE REDUCE
     13772**DCL     13891<<ASSIGN  13910<<ASSIGN  13913<<ASSIGN  13920<<ASSIGN  13923<<ASSIGN  13925>>IF
     13928>>IF      13934>>CALLBLT 13934>>CALLBLT
STRING_COMPARER IN PROCEDURE REDUCE
     13925**LABEL   13892--GOTO    13911--GOTO    13914--GOTO    13921--GOTO
TEMP1 IN PROCEDURE REDUCE
     13773**DCL     13774--REDEF   13802<>CALL    13803>>IF      13809<>CALL    13811>>IF      13816<>CALL
     13818>>IF
TEMP2 IN PROCEDURE REDUCE
     13775**DCL     13776--REDEF   13810<>CALL    13811>>IF      13817<>CALL    13818>>IF
TOKEN
     13235**DCL     13743>>ASSIGN  14144<>CALL    14150>>DOCASE  14170<>CALL    14196>>IF      14210>>ASSIGN
     14211>>ASSIGN  14215<>CALL    14231>>IF      14249>>ASSIGN  14254<>CALL
TOKEN IN PROCEDURE LEX
     13698**DCL     13696--PROC    13705<<ASSIGN  13709<<ASSIGN
TOKEN_INDX
     13234**DCL     13702<<ASSIGN  13702>>ASSIGN  13703>>IF      13708>>ASSIGN  13711>>DOCASE  14140<<ASSIGN
TOKEN_PTR$
     13227**DCL     13708<<ASSIGN  13709>>ASSIGN  13710>>ASSIGN  13713<>CALL    13715>>ASSIGN  13717>>ASSIGN
     13744>>DOINDEX 13745>>ASSIGN
TREE$
     12978**DCL        13--PROC    13703>>IF      13708>>ASSIGN  13711>>DOCASE
VALUE$
     13226**DCL     14144<>CALL    14165>>ASSIGN  14170<>CALL    14215<>CALL    14254<>CALL
VALUE$ IN PROCEDURE GET_ARGS
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:100  
     13741**DCL     13745<<ASSIGN  13762>>ASSIGN  13764>>ASSIGN
VALUE$ IN PROCEDURE LEX
     13699**DCL     13696--PROC    13713<>CALL    13715<<ASSIGN  13717<<ASSIGN  13718>>IF
VALUE$ IN PROCEDURE REDUCE
     13780**DCL     13785<<ASSIGN  13805<<ASSIGN  13807<<ASSIGN  13814<<ASSIGN  13821<<ASSIGN  13825<<ASSIGN
     13829<<ASSIGN  13833<<ASSIGN  13848<<ASSIGN  13852<<ASSIGN  13856<<ASSIGN  13860<<ASSIGN  13864<<ASSIGN
     13868<<ASSIGN  13873<<ASSIGN  13877<<ASSIGN  13881<<ASSIGN  13885<<ASSIGN  13889<<ASSIGN  13896<<ASSIGN
     13900<<ASSIGN  13904<<ASSIGN  13908<<ASSIGN  13918<<ASSIGN  13948<<ASSIGN  13950<<ASSIGN  13956<<ASSIGN
     13958<<ASSIGN  13963<<ASSIGN  13985>>ASSIGN
VAL_PTR
     13232**DCL     13752<<ASSIGN  13752>>ASSIGN  13753>>IF      13762>>ASSIGN  13763>>ASSIGN  13764>>ASSIGN
     13790>>IF      13802>>CALL    13809>>CALL    13810>>CALL    13816>>CALL    13817>>CALL    13840>>CALL
     13841>>ASSIGN  13842>>ASSIGN  13844>>DOCASE  13931>>CALLBLT 13931>>CALLBLT 13933>>ASSIGN  13947>>IF
     13955>>IF      13969<<ASSIGN  13969>>ASSIGN  13975<<ASSIGN  13975>>ASSIGN  13976>>IF      13985>>ASSIGN
     13986>>ASSIGN  13987>>ASSIGN  14002>>ASSIGN  14006>>ASSIGN  14011>>ASSIGN  14138<<ASSIGN  14155<<ASSIGN
     14155>>ASSIGN  14156>>IF      14165>>ASSIGN  14166>>ASSIGN  14167>>ASSIGN  14176>>ASSIGN
VAL_STACK$
     13294**DCL     13762<<ASSIGN  13802<>CALL    13809<>CALL    13810<>CALL    13816<>CALL    13817<>CALL
     13840>>CALL    13841>>ASSIGN  13842>>ASSIGN  13844>>DOCASE  13931>>CALLBLT 13931>>CALLBLT 13933>>ASSIGN
     13947>>IF      13955>>IF      13985<<ASSIGN  14165<<ASSIGN  14176>>ASSIGN
VAL_TYPE
     13295**DCL     13763<<ASSIGN  13986<<ASSIGN  14166<<ASSIGN
VMA$COMPRESS_BLANKS
     13309**DCL-ENT 13937--CALL
VMS$SELECT
        13**PROC    13713--CALL
VM_HEADER.CREATION_DATE
     13098**DCL     13838>>ASSIGN
VM_HEADER.DELIVERY_DATE
     13100**DCL     13835>>ASSIGN
VM_HEADER.FROM$
     13187**DCL     13891>>ASSIGN
VM_HEADER.REFERENCE$
     13189**DCL     13910>>ASSIGN
VM_HEADER.REPLY_TO$
     13191**DCL     13913>>ASSIGN
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:101  
VM_HEADER.STATUS.ACK
     13114**DCL     13823>>IF
VM_HEADER.STATUS.ANSWER
     13112**DCL     13827>>IF
VM_HEADER.STATUS.BROADCAST
     13146**DCL     13831>>IF
VM_HEADER.STATUS.DEL
     13130**DCL     13871>>IF
VM_HEADER.STATUS.DELIVERY
     13144**DCL     13875>>IF
VM_HEADER.STATUS.ERR
     13109**DCL     13879>>IF
VM_HEADER.STATUS.EXAM
     13128**DCL     13883>>IF      13961>>IF
VM_HEADER.STATUS.FCOPY
     13132**DCL     13887>>IF
VM_HEADER.STATUS.FORWARDED
     13138**DCL     13894>>IF
VM_HEADER.STATUS.MARK
     13134**DCL     13898>>IF
VM_HEADER.STATUS.OLD
     13122**DCL     13902>>IF      13906>>IF
VM_HEADER.STATUS.RRACK
     13156**DCL     13916>>IF
VM_HEADER.SUBJECT$
     13197**DCL     13920>>ASSIGN
VM_HEADER.TO$
     13199**DCL     13923>>ASSIGN
VM_HEADER$
     12560**DCL     13095--IMP-PTR 13823>>IF      13827>>IF      13831>>IF      13835>>ASSIGN  13838>>ASSIGN
     13871>>IF      13875>>IF      13879>>IF      13883>>IF      13887>>IF      13891>>ASSIGN  13894>>IF
     13898>>IF      13902>>IF      13906>>IF      13910>>ASSIGN  13913>>ASSIGN  13916>>IF      13920>>ASSIGN
     13923>>ASSIGN  13961>>IF
VM_SELECT
     12989**DCL        13--PROC    13713<>CALL
VM_SELECT.ERROR
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:102  
     12990**DCL     13721<<ASSIGN  13756<<ASSIGN  13793<<ASSIGN  13979<<ASSIGN  14001<<ASSIGN  14005<<ASSIGN
     14010<<ASSIGN  14159<<ASSIGN  14204<<ASSIGN  14243<<ASSIGN
VM_SELECT.ERR_POS#
     12997**DCL     13722<<ASSIGN  13757<<ASSIGN  13794<<ASSIGN  13980<<ASSIGN  14002<<ASSIGN  14006<<ASSIGN
     14011<<ASSIGN  14160<<ASSIGN  14205<<ASSIGN  14244<<ASSIGN
VM_WILDCARD
     13374**DCL     13944<>CALL
VM_WILDCARD.INPUT_
     13380**DCL     13943<<ASSIGN
VM_WILDCARD.PATTERN_
     13375**DCL     13942<<ASSIGN
WORK1.L#
     13262**DCL     13933<<ASSIGN  13942>>ASSIGN
WORK1.NAME#
     13262**DCL     13931<<CALLBLT 13942--ASSIGN
WORK2
     13289**DCL     13937--CALL
WORK2.L#
     13289**DCL     13936<<ASSIGN  13938>>IF      13940<<ASSIGN  13940>>ASSIGN  13943>>ASSIGN
WORK2.NAME#
     13289**DCL     13934<<CALLBLT 13935<<ASSIGN  13936--ASSIGN  13941<<ASSIGN  13943--ASSIGN
WORK_DATE IN PROCEDURE DATE_INIT
     14022**DCL     14088--ASSIGN
WORK_DATE.DAY IN PROCEDURE DATE_INIT
     14025**DCL     14105<<CALLBLT
WORK_DATE.MONTH IN PROCEDURE DATE_INIT
     14023**DCL     14103<<CALLBLT
WORK_DATE.YEAR IN PROCEDURE DATE_INIT
     14027**DCL     14109<<CALLBLT
WORK_TIME IN PROCEDURE DATE_INIT
     14028**DCL     14032--REDEF   14113--ASSIGN
WORK_TIME.HOUR IN PROCEDURE DATE_INIT
     14029**DCL     14115<<CALLBLT
WORK_TIME.MIN IN PROCEDURE DATE_INIT
     14031**DCL     14117<<CALLBLT
WORK_TIMEC IN PROCEDURE DATE_INIT
PL6.E3A0      #001=VMS$SELECT File=VMS$SELECT.:VMB6TSI                           WED 08/20/97 15:24 Page:103  
     14032**DCL     14090<<ASSIGN
X$DEC_CONVERT
     13307**DCL-ENT 13802--CALL    13809--CALL    13810--CALL    13816--CALL    13817--CALL
X$STRING.SIZ
     12556**DCL     12557--IMP-SIZ 13718>>IF      13928>>IF      13934>>CALLBLT
X$STRING.TEXT
     12557**DCL     13934>>CALLBLT
X$WILDCMP
     13310**DCL-ENT 13944--CALL
XUD$UTS_ADJ_25TH
     10592**DCL-ENT 13843--CALL
ZERO
     13299**DCL     13298--DCLINIT
ZERO$
     13298**DCL     13785>>ASSIGN  13805>>ASSIGN  13950>>ASSIGN  13958>>ASSIGN

PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:104  
      624        1        /*T***********************************************************/
      625        2        /*T*                                                         */
      626        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      627        4        /*T*                                                         */
      628        5        /*T***********************************************************/
      629        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      630        7        /*F*
      631        8             NAME: VMS$MOVE_SELECT
      632        9             PURPOSE:
      633       10                  To copy a parse tree to another address space.
      634       11             DESCRIPTION:
      635       12                  This routine has three parameters.
      636       13
      637       14                   MCB      - info describing work space for allocation.
      638       15                   OLD_PTR$ - ptr to P$B or P$S structure to be moved.
      639       16                   NEW_PTR$ - ptr to newly moved structure (return value).
      640       17
      641       18                  This routine will allocate the required space for either
      642       19                  a P$B or a P$S structure. It will then copy the structure
      643       20                  into the new space. If the structure is a P$B structure with
      644       21                  one or more NSUBLKS then this routine will call itself
      645       22                  recursively to process those blocks. When this routine returns,
      646       23                  the ptr, NEW_PTR$, will contain the new address of the just
      647       24                  moved structure. This must be stuffed into the SUBLK$ ptr
      648       25                  that originally pointed to the subnode that was just processed.
      649       26                  Or, in the case of the return to the original caller, it will
      650       27                  point to the newly moved structure.
      651       28        */
      652       29        VMS$MOVE_SELECT: PROC (MCB,OLD_PTR$,NEW_PTR$) ALTRET;
      653       30        /***** Include files *****/
      654       31          %INCLUDE XUM_MACRO_C;
      655       58          %INCLUDE XU_MACRO_C;
      656     3164          %INCLUDE XU_SUBS_C;
      657     3256        /***** Parameters *****/
      658     3257          %XUM$MCB (NAME=MCB,STCLASS=" ");
      659     3261    1   DCL OLD_PTR$ PTR;
      660     3262    1   DCL NEW_PTR$ PTR;
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:105  
      661     3263        /***** Local variables *****/
      662     3264    1   DCL INDX SBIN WORD AUTO;
      663     3265    1   DCL WORK_PTR$ PTR AUTO;
      664     3266    1   DCL MOVE_PTR$ PTR AUTO;
      665     3267        /***** External routines *****/
      666     3268    1   DCL X$ALLOCATE ENTRY(1) ALTRET;
      667     3269        /***** Based structures *****/
      668     3270          %PARSE$OUT (NAME=P$B,STCLASS=BASED);
      669     3315          %PARSE$SYM (NAME=P$S,STCLASS=BASED);
      670     3353        %EJECT;
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:106  
      671     3354        /*
      672     3355             ***** Determine the size of this node ...
      673     3356        */
      674     3357    2       DO CASE (OLD_PTR$ -> P$B.NDTYPE);
      675     3358    2       CASE (%DSTRING#,
      676     3359    2         %OCT#,
      677     3360    2         %DEC#,
      678     3361    2         %ALPHA#,
      679     3362    2         %ALNUM#,
      680     3363    2         %SYM#,
      681     3364    2         %FID#,
      682     3365    2         %ASYM#,
      683     3366    2         %PL6SYM#);
      684     3367    2           MCB.SIZE = LENGTHC(OLD_PTR$ -> P$S) + OLD_PTR$ -> P$S.COUNT - 2;
      685     3368        /*
      686     3369             ***** Allocate the required space ...
      687     3370        */
      688     3371    2           CALL X$ALLOCATE (MCB) ALTRET(E_ALLOCATE);
      689     3372        /*
      690     3373             ***** Copy the structure into the newly allocated space ...
      691     3374        */
      692     3375    2           NEW_PTR$ = MCB.ADDRESS$;
      693     3376    2           NEW_PTR$ -> P$S = OLD_PTR$ -> P$S;
      694     3377    2           NEW_PTR$ -> P$S.TEXTC$ = ADDR(NEW_PTR$ -> P$S.COUNT);
      695     3378    2           NEW_PTR$ -> P$S.COUNT = OLD_PTR$ -> P$S.COUNT;
      696     3379    2           NEW_PTR$ -> P$S.TEXT = OLD_PTR$ -> P$S.TEXT;
      697     3380    2           RETURN;
      698     3381    2       CASE (ELSE);
      699     3382    2           MCB.SIZE = LENGTHC(OLD_PTR$ -> P$B) + (OLD_PTR$ -> P$B.NSUBLKS-1) * 4;
      700     3383        /*
      701     3384             ***** Allocate the required space ...
      702     3385        */
      703     3386    2           CALL X$ALLOCATE (MCB) ALTRET(E_ALLOCATE);
      704     3387        /*
      705     3388             ***** Copy the structure into the newly allocated space ...
      706     3389        */
      707     3390    2           NEW_PTR$ = MCB.ADDRESS$;
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:107  
      708     3391    2           NEW_PTR$ -> P$B = OLD_PTR$ -> P$B;
      709     3392    2           IF OLD_PTR$ -> P$B.NSUBLKS > 0
      710     3393    2           THEN
      711     3394    3           DO INDX = 0 TO OLD_PTR$ -> P$B.NSUBLKS - 1;
      712     3395    3               WORK_PTR$ = OLD_PTR$ -> P$B.SUBLK$(INDX);
      713     3396    3               CALL VMS$MOVE_SELECT (MCB,WORK_PTR$,MOVE_PTR$) ALTRET(E_ALLOCATE);
      714     3397    3               NEW_PTR$ -> P$B.SUBLK$(INDX) = MOVE_PTR$;
      715     3398    3           END;
      716     3399    2       END;                             /* Do case ... end */
      717     3400    1       RETURN;
      718     3401        /**/
      719     3402    1   E_ALLOCATE:
      720     3403    1       ALTRETURN;
      721     3404    1   END VMS$MOVE_SELECT;
      722     3405        %EOD;

PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:108  
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   XUM_MACRO_C.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMS$MOVE_SELECT.

   Procedure VMS$MOVE_SELECT requires 134 words for executable code.
   Procedure VMS$MOVE_SELECT requires 14 words of local(AUTO) storage.

PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:109  

 Object Unit name= VMS$MOVE_SELECT                            File name= VMS$SELECT.:VMB6TOU
 UTS= AUG 20 '97 15:25:31.08 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   134    206  VMS$MOVE_SELECT
    1  RoData even  none     3      3  VMS$MOVE_SELECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes    yes     yes      Std        3  VMS$MOVE_SELECT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 X$ALLOCATE
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:110  


      624        1        /*T***********************************************************/
      625        2        /*T*                                                         */
      626        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      627        4        /*T*                                                         */
      628        5        /*T***********************************************************/
      629        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      630        7        /*F*
      631        8             NAME: VMS$MOVE_SELECT
      632        9             PURPOSE:
      633       10                  To copy a parse tree to another address space.
      634       11             DESCRIPTION:
      635       12                  This routine has three parameters.
      636       13
      637       14                   MCB      - info describing work space for allocation.
      638       15                   OLD_PTR$ - ptr to P$B or P$S structure to be moved.
      639       16                   NEW_PTR$ - ptr to newly moved structure (return value).
      640       17
      641       18                  This routine will allocate the required space for either
      642       19                  a P$B or a P$S structure. It will then copy the structure
      643       20                  into the new space. If the structure is a P$B structure with
      644       21                  one or more NSUBLKS then this routine will call itself
      645       22                  recursively to process those blocks. When this routine returns,
      646       23                  the ptr, NEW_PTR$, will contain the new address of the just
      647       24                  moved structure. This must be stuffed into the SUBLK$ ptr
      648       25                  that originally pointed to the subnode that was just processed.
      649       26                  Or, in the case of the return to the original caller, it will
      650       27                  point to the newly moved structure.
      651       28        */
      652       29        VMS$MOVE_SELECT: PROC (MCB,OLD_PTR$,NEW_PTR$) ALTRET;

     29  0 000000   000000 700200 xent  VMS$MOVE_SE* TSX0  ! X66_AUTO_3
         0 000001   000016 000003                    ZERO    14,3

      653       30        /***** Include files *****/
      654       31          %INCLUDE XUM_MACRO_C;
      655       58          %INCLUDE XU_MACRO_C;
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:111  
      656     3164          %INCLUDE XU_SUBS_C;
      657     3256        /***** Parameters *****/
      658     3257          %XUM$MCB (NAME=MCB,STCLASS=" ");
      659     3261    1   DCL OLD_PTR$ PTR;
      660     3262    1   DCL NEW_PTR$ PTR;
      661     3263        /***** Local variables *****/
      662     3264    1   DCL INDX SBIN WORD AUTO;
      663     3265    1   DCL WORK_PTR$ PTR AUTO;
      664     3266    1   DCL MOVE_PTR$ PTR AUTO;
      665     3267        /***** External routines *****/
      666     3268    1   DCL X$ALLOCATE ENTRY(1) ALTRET;
      667     3269        /***** Based structures *****/
      668     3270          %PARSE$OUT (NAME=P$B,STCLASS=BASED);
      669     3315          %PARSE$SYM (NAME=P$S,STCLASS=BASED);
      670     3353        %EJECT;
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:112  
      671     3354        /*
      672     3355             ***** Determine the size of this node ...
      673     3356        */
      674     3357    2       DO CASE (OLD_PTR$ -> P$B.NDTYPE);

   3357  0 000002   200004 470500                    LDP0    @OLD_PTR$,,AUTO
         0 000003   000000 471500                    LDP1    0,,PR0
         0 000004   100000 236100                    LDQ     0,,PR1
         0 000005   000022 772000                    QRL     18
         0 000006   000077 376007                    ANQ     63,DL
         0 000007   000005 136007                    SBLQ    5,DL
         0 000010   000024 116007                    CMPQ    20,DL
         0 000011   000013 602006 0                  TNC     s:3357+9,QL
         0 000012   000120 710000 0                  TRA     s:3382
         0 000013   000037 710000 0                  TRA     s:3367
         0 000014   000120 710000 0                  TRA     s:3382
         0 000015   000120 710000 0                  TRA     s:3382
         0 000016   000120 710000 0                  TRA     s:3382
         0 000017   000120 710000 0                  TRA     s:3382
         0 000020   000120 710000 0                  TRA     s:3382
         0 000021   000120 710000 0                  TRA     s:3382
         0 000022   000120 710000 0                  TRA     s:3382
         0 000023   000120 710000 0                  TRA     s:3382
         0 000024   000120 710000 0                  TRA     s:3382
         0 000025   000120 710000 0                  TRA     s:3382
         0 000026   000120 710000 0                  TRA     s:3382
         0 000027   000037 710000 0                  TRA     s:3367
         0 000030   000037 710000 0                  TRA     s:3367
         0 000031   000037 710000 0                  TRA     s:3367
         0 000032   000037 710000 0                  TRA     s:3367
         0 000033   000037 710000 0                  TRA     s:3367
         0 000034   000037 710000 0                  TRA     s:3367
         0 000035   000037 710000 0                  TRA     s:3367
         0 000036   000037 710000 0                  TRA     s:3367

      675     3358    2       CASE (%DSTRING#,

PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:113  
      676     3359    2         %OCT#,
      677     3360    2         %DEC#,
      678     3361    2         %ALPHA#,
      679     3362    2         %ALNUM#,
      680     3363    2         %SYM#,
      681     3364    2         %FID#,
      682     3365    2         %ASYM#,
      683     3366    2         %PL6SYM#);
      684     3367    2           MCB.SIZE = LENGTHC(OLD_PTR$ -> P$S) + OLD_PTR$ -> P$S.COUNT - 2;

   3367  0 000037   100004 236100                    LDQ     4,,PR1
         0 000040   000033 772000                    QRL     27
         0 000041   000021 620006                    EAX0    17,QL
         0 000042   200012 756100                    STQ     MOVE_PTR$+2,,AUTO
         0 000043   000000 636010                    EAQ     0,X0
         0 000044   000022 772000                    QRL     18
         0 000045   200012 036100                    ADLQ    MOVE_PTR$+2,,AUTO
         0 000046   000002 136007                    SBLQ    2,DL
         0 000047   200003 471500                    LDP1    @MCB,,AUTO
         0 000050   100006 756100                    STQ     6,,PR1

      685     3368        /*
      686     3369             ***** Allocate the required space ...
      687     3370        */
      688     3371    2           CALL X$ALLOCATE (MCB) ALTRET(E_ALLOCATE);

   3371  0 000051   200003 630500                    EPPR0   @MCB,,AUTO
         0 000052   000000 631400 1                  EPPR1   0
         0 000053   000000 701000 xent               TSX1    X$ALLOCATE
         0 000054   000205 702000 0                  TSX2    E_ALLOCATE

      689     3372        /*
      690     3373             ***** Copy the structure into the newly allocated space ...
      691     3374        */
      692     3375    2           NEW_PTR$ = MCB.ADDRESS$;

   3375  0 000055   200003 470500                    LDP0    @MCB,,AUTO
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:114  
         0 000056   000000 236100                    LDQ     0,,PR0
         0 000057   200005 471500                    LDP1    @NEW_PTR$,,AUTO
         0 000060   100000 756100                    STQ     0,,PR1

      693     3376    2           NEW_PTR$ -> P$S = OLD_PTR$ -> P$S;

   3376  0 000061   100000 473500                    LDP3    0,,PR1
         0 000062   300004 236100                    LDQ     4,,PR3
         0 000063   000033 772000                    QRL     27
         0 000064   000021 620006                    EAX0    17,QL
         0 000065   200004 474500                    LDP4    @OLD_PTR$,,AUTO
         0 000066   400000 475500                    LDP5    0,,PR4
         0 000067   500004 236100                    LDQ     4,,PR5
         0 000070   000033 772000                    QRL     27
         0 000071   000021 621006                    EAX1    17,QL
         0 000072   000140 100540                    MLR     fill='000'O
         0 000073   500000 000011                    ADSC9   0,,PR5                   cn=0,n=*X1
         0 000074   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0

      694     3377    2           NEW_PTR$ -> P$S.TEXTC$ = ADDR(NEW_PTR$ -> P$S.COUNT);

   3377  0 000075   100000 473500                    LDP3    0,,PR1
         0 000076   300004 635500                    EPPR5   4,,PR3
         0 000077   300003 455500                    STP5    3,,PR3

      695     3378    2           NEW_PTR$ -> P$S.COUNT = OLD_PTR$ -> P$S.COUNT;

   3378  0 000100   100000 473500                    LDP3    0,,PR1
         0 000101   400000 475500                    LDP5    0,,PR4
         0 000102   500004 236100                    LDQ     4,,PR5
         0 000103   300004 552140                    STBQ    4,'40'O,PR3

      696     3379    2           NEW_PTR$ -> P$S.TEXT = OLD_PTR$ -> P$S.TEXT;

   3379  0 000104   100000 473500                    LDP3    0,,PR1
         0 000105   300004 236100                    LDQ     4,,PR3
         0 000106   000033 772000                    QRL     27
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:115  
         0 000107   400000 475500                    LDP5    0,,PR4
         0 000110   000000 620006                    EAX0    0,QL
         0 000111   500004 236100                    LDQ     4,,PR5
         0 000112   000033 772000                    QRL     27
         0 000113   000000 621006                    EAX1    0,QL
         0 000114   040140 100540                    MLR     fill='040'O
         0 000115   500004 200011                    ADSC9   4,,PR5                   cn=1,n=*X1
         0 000116   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0

      697     3380    2           RETURN;

   3380  0 000117   000000 702200 xent               TSX2  ! X66_ARET

      698     3381    2       CASE (ELSE);

      699     3382    2           MCB.SIZE = LENGTHC(OLD_PTR$ -> P$B) + (OLD_PTR$ -> P$B.NSUBLKS-1) * 4;

   3382  0 000120   100001 236100                    LDQ     1,,PR1
         0 000121   000020 772000                    QRL     16
         0 000122   000001 376000 1                  ANQ     1
         0 000123   000014 036007                    ADLQ    12,DL
         0 000124   200003 473500                    LDP3    @MCB,,AUTO
         0 000125   300006 756100                    STQ     6,,PR3

      700     3383        /*
      701     3384             ***** Allocate the required space ...
      702     3385        */
      703     3386    2           CALL X$ALLOCATE (MCB) ALTRET(E_ALLOCATE);

   3386  0 000126   200003 630500                    EPPR0   @MCB,,AUTO
         0 000127   000000 631400 1                  EPPR1   0
         0 000130   000000 701000 xent               TSX1    X$ALLOCATE
         0 000131   000205 702000 0                  TSX2    E_ALLOCATE

      704     3387        /*
      705     3388             ***** Copy the structure into the newly allocated space ...
      706     3389        */
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:116  
      707     3390    2           NEW_PTR$ = MCB.ADDRESS$;

   3390  0 000132   200003 470500                    LDP0    @MCB,,AUTO
         0 000133   000000 236100                    LDQ     0,,PR0
         0 000134   200005 471500                    LDP1    @NEW_PTR$,,AUTO
         0 000135   100000 756100                    STQ     0,,PR1

      708     3391    2           NEW_PTR$ -> P$B = OLD_PTR$ -> P$B;

   3391  0 000136   100000 473500                    LDP3    0,,PR1
         0 000137   200004 474500                    LDP4    @OLD_PTR$,,AUTO
         0 000140   400000 475500                    LDP5    0,,PR4
         0 000141   000100 100500                    MLR     fill='000'O
         0 000142   500000 000020                    ADSC9   0,,PR5                   cn=0,n=16
         0 000143   300000 000020                    ADSC9   0,,PR3                   cn=0,n=16

      709     3392    2           IF OLD_PTR$ -> P$B.NSUBLKS > 0

   3392  0 000144   400000 473500                    LDP3    0,,PR4
         0 000145   300001 220100                    LDX0    1,,PR3
         0 000146   000204 600000 0                  TZE     s:3400

      710     3393    2           THEN
      711     3394    3           DO INDX = 0 TO OLD_PTR$ -> P$B.NSUBLKS - 1;

   3394  0 000147   200006 450100                    STZ     INDX,,AUTO
         0 000150   000176 710000 0                  TRA     s:3398+1

      712     3395    3               WORK_PTR$ = OLD_PTR$ -> P$B.SUBLK$(INDX);

   3395  0 000151   200004 470500                    LDP0    @OLD_PTR$,,AUTO
         0 000152   000000 471500                    LDP1    0,,PR0
         0 000153   200006 720100                    LXL0    INDX,,AUTO
         0 000154   100003 236110                    LDQ     3,X0,PR1
         0 000155   200007 756100                    STQ     WORK_PTR$,,AUTO

      713     3396    3               CALL VMS$MOVE_SELECT (MCB,WORK_PTR$,MOVE_PTR$) ALTRET(E_ALLOCATE);
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:117  

   3396  0 000156   200010 631500                    EPPR1   MOVE_PTR$,,AUTO
         0 000157   200014 451500                    STP1    MOVE_PTR$+4,,AUTO
         0 000160   200007 633500                    EPPR3   WORK_PTR$,,AUTO
         0 000161   200013 453500                    STP3    MOVE_PTR$+3,,AUTO
         0 000162   200003 236100                    LDQ     @MCB,,AUTO
         0 000163   200012 756100                    STQ     MOVE_PTR$+2,,AUTO
         0 000164   200012 630500                    EPPR0   MOVE_PTR$+2,,AUTO
         0 000165   000002 631400 1                  EPPR1   2
         0 000166   000000 701000 0                  TSX1    s:29
         0 000167   000205 702000 0                  TSX2    E_ALLOCATE

      714     3397    3               NEW_PTR$ -> P$B.SUBLK$(INDX) = MOVE_PTR$;

   3397  0 000170   200005 470500                    LDP0    @NEW_PTR$,,AUTO
         0 000171   000000 471500                    LDP1    0,,PR0
         0 000172   200010 236100                    LDQ     MOVE_PTR$,,AUTO
         0 000173   200006 720100                    LXL0    INDX,,AUTO
         0 000174   100003 756110                    STQ     3,X0,PR1

      715     3398    3           END;

   3398  0 000175   200006 054100                    AOS     INDX,,AUTO
         0 000176   200004 470500                    LDP0    @OLD_PTR$,,AUTO
         0 000177   000000 471500                    LDP1    0,,PR0
         0 000200   100001 236100                    LDQ     1,,PR1
         0 000201   000022 772000                    QRL     18
         0 000202   200006 116100                    CMPQ    INDX,,AUTO
         0 000203   000151 605400 0                  TPNZ    s:3395

      716     3399    2       END;                             /* Do case ... end */

      717     3400    1       RETURN;

   3400  0 000204   000000 702200 xent               TSX2  ! X66_ARET

      718     3401        /**/
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:118  
      719     3402    1   E_ALLOCATE:
      720     3403    1       ALTRETURN;

   3403  0 000205   000000 702200 xent  E_ALLOCATE   TSX2  ! X66_AALT

(unnamed)
 Sect OctLoc
   1     000   000001 000000   000003 777774   000003 000000                    ............
      721     3404    1   END VMS$MOVE_SELECT;
      722     3405        %EOD;

PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:119  
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   XUM_MACRO_C.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMS$MOVE_SELECT.
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:120  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @MCB                       5-0-0/w PTR         r     1 @NEW_PTR$
     4-0-0/w PTR         r     1 @OLD_PTR$                  6-0-0/w SBIN        r     1 INDX
    *0-0-0/w STRC(324)   r     1 MCB                       10-0-0/w PTR         r     1 MOVE_PTR$
    *0-0-0/w PTR         r     1 NEW_PTR$                  *0-0-0/w PTR         r     1 OLD_PTR$
     7-0-0/w PTR         r     1 WORK_PTR$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S


   Procedure VMS$MOVE_SELECT requires 134 words for executable code.
   Procedure VMS$MOVE_SELECT requires 14 words of local(AUTO) storage.
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:121  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:122  
          MINI XREF LISTING

E_ALLOCATE
      3403**LABEL    3371--CALLALT  3386--CALLALT  3396--CALLALT
INDX
      3264**DCL      3394<<DOINDEX  3395>>ASSIGN   3397>>ASSIGN
MCB
      3258**DCL        29--PROC     3371<>CALL     3386<>CALL     3396<>CALL
MCB.ADDRESS$
      3258**DCL      3375>>ASSIGN   3390>>ASSIGN
MCB.SIZE
      3258**DCL      3367<<ASSIGN   3382<<ASSIGN
MOVE_PTR$
      3266**DCL      3396<>CALL     3397>>ASSIGN
NEW_PTR$
      3262**DCL        29--PROC     3375<<ASSIGN   3376>>ASSIGN   3376>>ASSIGN   3377>>ASSIGN   3377>>ASSIGN
      3378>>ASSIGN   3379>>ASSIGN   3379>>ASSIGN   3390<<ASSIGN   3391>>ASSIGN   3397>>ASSIGN
OLD_PTR$
      3261**DCL        29--PROC     3357>>DOCASE   3367>>ASSIGN   3367>>ASSIGN   3367>>ASSIGN   3376>>ASSIGN
      3376>>ASSIGN   3378>>ASSIGN   3379>>ASSIGN   3379>>ASSIGN   3382>>ASSIGN   3382>>ASSIGN   3391>>ASSIGN
      3392>>IF       3394>>DOINDEX  3395>>ASSIGN
P$B
      3276**DCL      3382--ASSIGN   3391<<ASSIGN   3391>>ASSIGN
P$B.NDTYPE
      3279**DCL      3357>>DOCASE
P$B.NSUBLKS
      3288**DCL      3382>>ASSIGN   3392>>IF       3394>>DOINDEX
P$B.SUBLK$
      3309**DCL      3395>>ASSIGN   3397<<ASSIGN
P$S
      3322**DCL      3367--ASSIGN   3376<<ASSIGN   3376>>ASSIGN
P$S.COUNT
      3345**DCL      3348--IMP-SIZ  3367>>ASSIGN   3367>>ASSIGN   3376>>ASSIGN   3376>>ASSIGN   3377--ASSIGN
      3378<<ASSIGN   3378>>ASSIGN   3379>>ASSIGN   3379>>ASSIGN
PL6.E3A0      #002=VMS$MOVE_SELECT File=VMS$SELECT.:VMB6TSI                      WED 08/20/97 15:25 Page:123  
P$S.TEXT
      3348**DCL      3379<<ASSIGN   3379>>ASSIGN
P$S.TEXTC$
      3340**DCL      3377<<ASSIGN
VMS$MOVE_SELECT
        29**PROC     3396--CALL
WORK_PTR$
      3265**DCL      3395<<ASSIGN   3396<>CALL
X$ALLOCATE
      3268**DCL-ENT  3371--CALL     3386--CALL

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:124  
      723        1        /*T***********************************************************/
      724        2        /*T*                                                         */
      725        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      726        4        /*T*                                                         */
      727        5        /*T***********************************************************/
      728        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      729        7        /*********************************************************************/
      730        8        /*F*
      731        9             NAME: VMS$FMT_SELECT
      732       10             PURPOSE:
      733       11                   To produce a text string describing a SELECTION CRITERIA.
      734       12             DESCRIPTION:
      735       13                   This routine takes the information contained in the
      736       14                   VM_CONTEXT structure and produces a textc string.
      737       15
      738       16                   This routine has 2 parameters:
      739       17                      VM_CONTEXT   - structure describing the SELECTION CRITERIA.
      740       18                      TEXTC        - textc string of length 511.
      741       19        */
      742       20        /*********************************************************************/
      743       21        VMS$FMT_SELECT: PROC (VM_CONTEXT,TEXTC);
      744       22        /***** Include files *****/
      745       23          %INCLUDE CP_6;
      746     5582          %INCLUDE CP_6_SUBS;
      747     6122          %INCLUDE VM_MACRO_C;
      748     7390          %INCLUDE VM_SUBS_C;
      749     7650          %INCLUDE VM_PERR_C;
      750     7945          %INCLUDE VM_DATA_R;
      751     8376        /***** Parameters *****/
      752     8377          %VM_CONTEXT (STCLASS=" ");
      753     8410          %TEXTC (NAME=TEXTC,STCLASS=" ");
      754     8415        /***** Local variables *****/
      755     8416    1   DCL INDX1 SBIN WORD AUTO;
      756     8417    1   DCL INDX2 SBIN WORD AUTO;
      757     8418    1   DCL INDX3 SBIN WORD AUTO;
      758     8419    1   DCL CHARPOS SBIN WORD AUTO;
      759     8420    1   DCL CONVERT_BUF CHAR(12) AUTO;
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:125  
      760     8421        /***** External routines *****/
      761     8422    1   DCL VMS$FMT_EXP ENTRY(3);
      762     8423        %INIT_STR (DODCL=YES);
      763     8446        %VLP_NAME (FPTN=VM_CHAR_ERROR_MSG, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      764     8473        %VLP_ERRCODE (FPTN=E_CHAR_ERROR_MSG,   STCLASS="CONSTANT SYMDEF",
      765     8474                       ERR#=%E$CHAR_ERROR_MSG,           FCG=VM,MID=S);
      766     8519        /*E*  ERROR:VMS-E$CHAR_ERROR_MSG-0
      767     8520              MESSAGE:***** Error *****
      768     8521        */
      769     8522              %VLP_NAMEV(FPTN=VM_CHAR_NEXT,    STCLASS=SYMREF);
      770     8529        %VLP_NAMEV(FPTN=VM_CHAR_PREVIOUS,      STCLASS=SYMREF);
      771     8536        %VLP_NAMEV(FPTN=VM_CHAR_WHEN,          STCLASS=SYMREF);
      772     8543        %VLP_ERRCODE (FPTN=E_CHAR_WHEN,        STCLASS="SYMREF READONLY");
      773     8588              %VLP_ERRCODE (FPTN=E_CHAR_NEXT,  STCLASS="SYMREF READONLY");
      774     8633              %VLP_ERRCODE (FPTN=E_CHAR_PREVIOUS, STCLASS="SYMREF READONLY");
      775     8678        %EJECT;
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:126  
      776     8679        /*
      777     8680             ***** Initialization ...
      778     8681        */
      779     8682    1         TEXTC.TEXT = ' ';
      780     8683    1       CHARPOS = 0;
      781     8684        /*
      782     8685             ***** If next or previous specified, then
      783     8686                   only display that ...
      784     8687        */
      785     8688    1       IF VM_CONTEXT.FLAGS ~= '0'B
      786     8689    1       THEN
      787     8690    2       DO;
      788     8691    2           IF VM_CONTEXT.FLAGS.PREV
      789     8692    2           THEN
      790     8693    3           DO;
      791     8694                    %INIT_STR (CODE=E_CHAR_PREVIOUS, STR=VM_CHAR_PREVIOUS, TEST=YES);
      792     8717    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_PREVIOUS.NAME#;
      793     8718    3               CHARPOS = CHARPOS + VM_CHAR_PREVIOUS.L#;
      794     8719    3           END;
      795     8720    2           IF VM_CONTEXT.FLAGS.NEXT
      796     8721    2           THEN
      797     8722    3           DO;
      798     8723                    %INIT_STR (CODE=E_CHAR_NEXT, STR=VM_CHAR_NEXT, TEST=YES);
      799     8746    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_NEXT.NAME#;
      800     8747    3               CHARPOS = CHARPOS + VM_CHAR_NEXT.L#;
      801     8748    3           END;
      802     8749    2           GOTO BUILD_EXP;
      803     8750    2       END;
      804     8751        %EJECT;
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:127  
      805     8752        /*
      806     8753             ***** Build the message set text ...
      807     8754        */
      808     8755    2       DO INDX1 = 0 TO VM_CONTEXT.NUM_ENTRIES - 1;
      809     8756    2           CALL BINCHAR (CONVERT_BUF,VM_CONTEXT.MESSAGE_SET.LOW(INDX1));
      810     8757        /*
      811     8758             ***** Strip leading blanks ...
      812     8759        */
      813     8760    3           DO INDX2 = 0 TO LENGTHC(CONVERT_BUF) - 1;
      814     8761    3               IF SUBSTR(CONVERT_BUF,INDX2,1) ~= '0'
      815     8762    3               THEN
      816     8763    3                   GOTO INSERT_LOW;
      817     8764    3           END;
      818     8765    2           INDX2 = LENGTHC(CONVERT_BUF) - 1;
      819     8766    2   INSERT_LOW:
      820     8767    2           INDX3 = LENGTHC(CONVERT_BUF) - INDX2;
      821     8768    2           CALL INSERT (TEXTC.TEXT,CHARPOS,,SUBSTR(CONVERT_BUF,INDX2,INDX3));
      822     8769    2           CHARPOS = CHARPOS + INDX3;
      823     8770        /*
      824     8771             ***** Range ???
      825     8772        */
      826     8773    2           IF VM_CONTEXT.MESSAGE_SET.HIGH(INDX1) ~=
      827     8774    2             VM_CONTEXT.MESSAGE_SET.LOW(INDX1)
      828     8775    2           THEN
      829     8776    3           DO;
      830     8777    3               CALL BINCHAR (CONVERT_BUF,VM_CONTEXT.MESSAGE_SET.HIGH(INDX1));
      831     8778    4               DO INDX2 = 0 TO LENGTHC(CONVERT_BUF) - 1;
      832     8779    4                   IF SUBSTR(CONVERT_BUF,INDX2,1) ~= '0'
      833     8780    4                   THEN
      834     8781    4                       GOTO INSERT_HIGH;
      835     8782    4               END;
      836     8783    3               INDX2 = LENGTHC(CONVERT_BUF) - 1;
      837     8784    3   INSERT_HIGH:
      838     8785    3               INDX3 = LENGTHC(CONVERT_BUF) - INDX2;
      839     8786    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,'-',
      840     8787    3                 SUBSTR(CONVERT_BUF,INDX2,INDX3));
      841     8788    3               CHARPOS = CHARPOS + LENGTHC('-') + INDX3;
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:128  
      842     8789    3           END;
      843     8790    2           IF INDX1 ~= VM_CONTEXT.NUM_ENTRIES -1
      844     8791    2           THEN                       /* More to come */
      845     8792    3           DO;                      /* Add a comma */
      846     8793    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,',');
      847     8794    3               CHARPOS = CHARPOS + LENGTHC(',');
      848     8795    3           END;
      849     8796    2       END;                            /* Do INDX1 = ... end */
      850     8797        /*
      851     8798             ***** Now build the truth expression ...
      852     8799        */
      853     8800    1   BUILD_EXP:
      854     8801    1       IF VM_CONTEXT.TRUTH_TREE$ ~= ADDR(NIL)
      855     8802    1       THEN
      856     8803    2       DO;
      857     8804                %INIT_STR (CODE=E_CHAR_WHEN, STR=VM_CHAR_WHEN, TEST=YES);
      858     8827    2           substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_WHEN.NAME#;
      859     8828    2           CHARPOS = CHARPOS + VM_CHAR_WHEN.L#;
      860     8829    2           CALL VMS$FMT_EXP (VM_CONTEXT.TRUTH_TREE$,TEXTC,CHARPOS);
      861     8830    2       END;
      862     8831    1       IF CHARPOS > 511
      863     8832    1       THEN
      864     8833    2       DO;
      865     8834                %INIT_STR (CODE=E_CHAR_ERROR_MSG, STR=VM_CHAR_ERROR_MSG, TEST=YES);
      866     8857    2           TEXTC.TEXT= VM_CHAR_ERROR_MSG.NAME#;
      867     8858    2           TEXTC.SIZ = VM_CHAR_ERROR_MSG.L#;
      868     8859    2       END;
      869     8860    1       ELSE
      870     8861    1           TEXTC.SIZ = CHARPOS;
      871     8862    1       RETURN;
      872     8863    1   END VMS$FMT_SELECT;
      873     8864        %EOD;

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:129  
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMS$FMT_SELECT.

   Procedure VMS$FMT_SELECT requires 279 words for executable code.
   Procedure VMS$FMT_SELECT requires 16 words of local(AUTO) storage.

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:130  

 Object Unit name= VMS$FMT_SELECT                             File name= VMS$SELECT.:VMB6TOU
 UTS= AUG 20 '97 15:25:36.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none     4      4  VMS$FMT_SELECT
   12  RoData even  UTS      1      1  VMS$FMT_SELECT
   13   Proc  even  none   279    427  VMS$FMT_SELECT
   14  RoData even  none    15     17  VMS$FMT_SELECT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        2  VMS$FMT_SELECT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
   11      0  VM_CHAR_ERROR_MSG                 12      0  E_CHAR_ERROR_MSG
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:131  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 VMD$ERRMSG
         yes           Std       3 VMS$FMT_EXP
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                      VM_CHAR_NEXT
     VM_CHAR_PREVIOUS                      VM_CHAR_WHEN                     r    E_CHAR_WHEN
r    E_CHAR_NEXT                      r    E_CHAR_PREVIOUS
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:132  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:133  


      723        1        /*T***********************************************************/
      724        2        /*T*                                                         */
      725        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      726        4        /*T*                                                         */
      727        5        /*T***********************************************************/
      728        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      729        7        /*********************************************************************/
      730        8        /*F*
      731        9             NAME: VMS$FMT_SELECT
      732       10             PURPOSE:
      733       11                   To produce a text string describing a SELECTION CRITERIA.
      734       12             DESCRIPTION:
      735       13                   This routine takes the information contained in the
      736       14                   VM_CONTEXT structure and produces a textc string.
      737       15
      738       16                   This routine has 2 parameters:
      739       17                      VM_CONTEXT   - structure describing the SELECTION CRITERIA.
      740       18                      TEXTC        - textc string of length 511.
      741       19        */
      742       20        /*********************************************************************/
      743       21        VMS$FMT_SELECT: PROC (VM_CONTEXT,TEXTC);

     21 13 000000   000000 700200 xent  VMS$FMT_SEL* TSX0  ! X66_AUTO_2
        13 000001   000020 000002                    ZERO    16,2

      744       22        /***** Include files *****/
      745       23          %INCLUDE CP_6;
      746     5582          %INCLUDE CP_6_SUBS;
      747     6122          %INCLUDE VM_MACRO_C;
      748     7390          %INCLUDE VM_SUBS_C;
      749     7650          %INCLUDE VM_PERR_C;
      750     7945          %INCLUDE VM_DATA_R;
      751     8376        /***** Parameters *****/
      752     8377          %VM_CONTEXT (STCLASS=" ");
      753     8410          %TEXTC (NAME=TEXTC,STCLASS=" ");
      754     8415        /***** Local variables *****/
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:134  
      755     8416    1   DCL INDX1 SBIN WORD AUTO;
      756     8417    1   DCL INDX2 SBIN WORD AUTO;
      757     8418    1   DCL INDX3 SBIN WORD AUTO;
      758     8419    1   DCL CHARPOS SBIN WORD AUTO;
      759     8420    1   DCL CONVERT_BUF CHAR(12) AUTO;
      760     8421        /***** External routines *****/
      761     8422    1   DCL VMS$FMT_EXP ENTRY(3);
      762     8423        %INIT_STR (DODCL=YES);
      763     8446       %VLP_NAME (FPTN=VM_CHAR_ERROR_MSG, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      764     8473        %VLP_ERRCODE (FPTN=E_CHAR_ERROR_MSG,   STCLASS="CONSTANT SYMDEF",
      765     8474                       ERR#=%E$CHAR_ERROR_MSG,           FCG=VM,MID=S);
      766     8519        /*E*  ERROR:VMS-E$CHAR_ERROR_MSG-0
      767     8520              MESSAGE:***** Error *****
      768     8521        */
      769     8522              %VLP_NAMEV(FPTN=VM_CHAR_NEXT,    STCLASS=SYMREF);
      770     8529        %VLP_NAMEV(FPTN=VM_CHAR_PREVIOUS,      STCLASS=SYMREF);
      771     8536        %VLP_NAMEV(FPTN=VM_CHAR_WHEN,          STCLASS=SYMREF);
      772     8543        %VLP_ERRCODE (FPTN=E_CHAR_WHEN,        STCLASS="SYMREF READONLY");
      773     8588              %VLP_ERRCODE (FPTN=E_CHAR_NEXT,  STCLASS="SYMREF READONLY");
      774     8633              %VLP_ERRCODE (FPTN=E_CHAR_PREVIOUS, STCLASS="SYMREF READONLY");
      775     8678        %EJECT;
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:135  
      776     8679        /*
      777     8680             ***** Initialization ...
      778     8681        */
      779     8682    1         TEXTC.TEXT = ' ';

   8682 13 000002   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000003   000100 101500                    MRL     fill='000'O
        13 000004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000005   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000006   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000007   040140 100400                    MLR     fill='040'O
        13 000010   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000011   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      780     8683    1       CHARPOS = 0;

   8683 13 000012   200010 450100                    STZ     CHARPOS,,AUTO

      781     8684        /*
      782     8685             ***** If next or previous specified, then
      783     8686                   only display that ...
      784     8687        */
      785     8688    1       IF VM_CONTEXT.FLAGS ~= '0'B

   8688 13 000013   200003 471500                    LDP1    @VM_CONTEXT,,AUTO
        13 000014   100004 235100                    LDA     4,,PR1
        13 000015   000126 600000 13                 TZE     s:8755

      786     8689    1       THEN
      787     8690    2       DO;

      788     8691    2           IF VM_CONTEXT.FLAGS.PREV

   8691 13 000016   100004 236100                    LDQ     4,,PR1
        13 000017   100000 316003                    CANQ    32768,DU
        13 000020   000061 600000 13                 TZE     s:8720

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:136  
      789     8692    2           THEN
      790     8693    3           DO;

      791     8694                    %INIT_STR (CODE=E_CHAR_PREVIOUS, STR=VM_CHAR_PREVIOUS, TEST=YES);

   8701 13 000021   000000 236000 xsym               LDQ     VM_CHAR_PREVIOUS
        13 000022   000033 772000                    QRL     27
        13 000023   000000 620006                    EAX0    0,QL
        13 000024   040000 106440                    CMPC    fill='040'O
        13 000025   000000 200010 xsym               ADSC9   VM_CHAR_PREVIOUS         cn=1,n=*X0
        13 000026   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000027   000034 601000 13                 TNZ     s:8717

   8703 13 000030   000002 630400 14                 EPPR0   2
        13 000031   000001 631400 14                 EPPR1   1
        13 000032   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000033   000000 011000                    NOP     0

      792     8717    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_PREVIOUS.NAME#;

   8717 13 000034   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000035   000100 101500                    MRL     fill='000'O
        13 000036   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000037   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000040   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000041   000000 636010                    EAQ     0,X0
        13 000042   000022 772000                    QRL     18
        13 000043   200010 136100                    SBLQ    CHARPOS,,AUTO
        13 000044   200015 756100                    STQ     CONVERT_BUF+4,,AUTO
        13 000045   000000 236000 xsym               LDQ     VM_CHAR_PREVIOUS
        13 000046   000033 772000                    QRL     27
        13 000047   000000 621006                    EAX1    0,QL
        13 000050   200015 722100                    LXL2    CONVERT_BUF+4,,AUTO
        13 000051   200010 235100                    LDA     CHARPOS,,AUTO
        13 000052   040145 100440                    MLR     fill='040'O
        13 000053   000000 200011 xsym               ADSC9   VM_CHAR_PREVIOUS         cn=1,n=*X1
        13 000054   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:137  

      793     8718    3               CHARPOS = CHARPOS + VM_CHAR_PREVIOUS.L#;

   8718 13 000055   000000 236000 xsym               LDQ     VM_CHAR_PREVIOUS
        13 000056   000033 772000                    QRL     27
        13 000057   200010 036100                    ADLQ    CHARPOS,,AUTO
        13 000060   200010 756100                    STQ     CHARPOS,,AUTO

      794     8719    3           END;

      795     8720    2           IF VM_CONTEXT.FLAGS.NEXT

   8720 13 000061   200003 471500                    LDP1    @VM_CONTEXT,,AUTO
        13 000062   100004 236100                    LDQ     4,,PR1
        13 000063   200000 316003                    CANQ    65536,DU
        13 000064   000125 600000 13                 TZE     s:8749

      796     8721    2           THEN
      797     8722    3           DO;

      798     8723                    %INIT_STR (CODE=E_CHAR_NEXT, STR=VM_CHAR_NEXT, TEST=YES);

   8730 13 000065   000000 236000 xsym               LDQ     VM_CHAR_NEXT
        13 000066   000033 772000                    QRL     27
        13 000067   000000 620006                    EAX0    0,QL
        13 000070   040000 106440                    CMPC    fill='040'O
        13 000071   000000 200010 xsym               ADSC9   VM_CHAR_NEXT             cn=1,n=*X0
        13 000072   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000073   000100 601000 13                 TNZ     s:8746

   8732 13 000074   000004 630400 14                 EPPR0   4
        13 000075   000001 631400 14                 EPPR1   1
        13 000076   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000077   000000 011000                    NOP     0

      799     8746    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_NEXT.NAME#;

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:138  
   8746 13 000100   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000101   000100 101500                    MRL     fill='000'O
        13 000102   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000103   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000104   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000105   000000 636010                    EAQ     0,X0
        13 000106   000022 772000                    QRL     18
        13 000107   200010 136100                    SBLQ    CHARPOS,,AUTO
        13 000110   200015 756100                    STQ     CONVERT_BUF+4,,AUTO
        13 000111   000000 236000 xsym               LDQ     VM_CHAR_NEXT
        13 000112   000033 772000                    QRL     27
        13 000113   000000 621006                    EAX1    0,QL
        13 000114   200015 722100                    LXL2    CONVERT_BUF+4,,AUTO
        13 000115   200010 235100                    LDA     CHARPOS,,AUTO
        13 000116   040145 100440                    MLR     fill='040'O
        13 000117   000000 200011 xsym               ADSC9   VM_CHAR_NEXT             cn=1,n=*X1
        13 000120   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

      800     8747    3               CHARPOS = CHARPOS + VM_CHAR_NEXT.L#;

   8747 13 000121   000000 236000 xsym               LDQ     VM_CHAR_NEXT
        13 000122   000033 772000                    QRL     27
        13 000123   200010 036100                    ADLQ    CHARPOS,,AUTO
        13 000124   200010 756100                    STQ     CHARPOS,,AUTO

      801     8748    3           END;

      802     8749    2           GOTO BUILD_EXP;

   8749 13 000125   000314 710000 13                 TRA     BUILD_EXP

      803     8750    2       END;
      804     8751        %EJECT;
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:139  
      805     8752        /*
      806     8753             ***** Build the message set text ...
      807     8754        */
      808     8755    2       DO INDX1 = 0 TO VM_CONTEXT.NUM_ENTRIES - 1;

   8755 13 000126   200005 450100                    STZ     INDX1,,AUTO
        13 000127   000310 710000 13                 TRA     s:8796+1

      809     8756    2           CALL BINCHAR (CONVERT_BUF,VM_CONTEXT.MESSAGE_SET.LOW(INDX1));

   8756 13 000130   200005 235100                    LDA     INDX1,,AUTO
        13 000131   000003 735000                    ALS     3
        13 000132   200003 470500                    LDP0    @VM_CONTEXT,,AUTO
        13 000133   000100 301505                    BTD
        13 000134   000005 000004                    NDSC9   5,A,PR0                  cn=0,s=lsgnf,sf=0,n=4
        13 000135   200011 030014                    NDSC9   CONVERT_BUF,,AUTO        cn=0,s=nosgn,sf=0,n=12

      810     8757        /*
      811     8758             ***** Strip leading blanks ...
      812     8759        */
      813     8760    3           DO INDX2 = 0 TO LENGTHC(CONVERT_BUF) - 1;

   8760 13 000136   200006 450100                    STZ     INDX2,,AUTO
        13 000137   000146 710000 13                 TRA     s:8764+1

      814     8761    3               IF SUBSTR(CONVERT_BUF,INDX2,1) ~= '0'

   8761 13 000140   200006 235100                    LDA     INDX2,,AUTO
        13 000141   040000 106505                    CMPC    fill='040'O
        13 000142   200011 000001                    ADSC9   CONVERT_BUF,A,AUTO       cn=0,n=1
        13 000143   000006 000001 14                 ADSC9   6                        cn=0,n=1
        13 000144   000153 601000 13                 TNZ     INSERT_LOW

      815     8762    3               THEN
      816     8763    3                   GOTO INSERT_LOW;
      817     8764    3           END;

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:140  
   8764 13 000145   200006 054100                    AOS     INDX2,,AUTO
        13 000146   200006 235100                    LDA     INDX2,,AUTO
        13 000147   000013 115007                    CMPA    11,DL
        13 000150   000140 604400 13                 TMOZ    s:8761

      818     8765    2           INDX2 = LENGTHC(CONVERT_BUF) - 1;

   8765 13 000151   000013 236007                    LDQ     11,DL
        13 000152   200006 756100                    STQ     INDX2,,AUTO

      819     8766    2   INSERT_LOW:
      820     8767    2           INDX3 = LENGTHC(CONVERT_BUF) - INDX2;

   8767 13 000153   000014 235007       INSERT_LOW   LDA     12,DL
        13 000154   200006 135100                    SBLA    INDX2,,AUTO
        13 000155   200007 755100                    STA     INDX3,,AUTO

      821     8768    2           CALL INSERT (TEXTC.TEXT,CHARPOS,,SUBSTR(CONVERT_BUF,INDX2,INDX3));

   8768 13 000156   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000157   000100 101500                    MRL     fill='000'O
        13 000160   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000161   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000162   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000163   000000 636010                    EAQ     0,X0
        13 000164   000022 772000                    QRL     18
        13 000165   200010 136100                    SBLQ    CHARPOS,,AUTO
        13 000166   000000 621005                    EAX1    0,AL
        13 000167   200006 235100                    LDA     INDX2,,AUTO
        13 000170   000000 622006                    EAX2    0,QL
        13 000171   200010 236100                    LDQ     CHARPOS,,AUTO
        13 000172   040146 100545                    MLR     fill='040'O
        13 000173   200011 000011                    ADSC9   CONVERT_BUF,A,AUTO       cn=0,n=*X1
        13 000174   000000 200012                    ADSC9   0,Q,PR0                  cn=1,n=*X2

      822     8769    2           CHARPOS = CHARPOS + INDX3;

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:141  
   8769 13 000175   200010 236100                    LDQ     CHARPOS,,AUTO
        13 000176   200007 036100                    ADLQ    INDX3,,AUTO
        13 000177   200010 756100                    STQ     CHARPOS,,AUTO

      823     8770        /*
      824     8771             ***** Range ???
      825     8772        */
      826     8773    2           IF VM_CONTEXT.MESSAGE_SET.HIGH(INDX1) ~=

   8773 13 000200   200005 235100                    LDA     INDX1,,AUTO
        13 000201   000001 735000                    ALS     1
        13 000202   200003 471500                    LDP1    @VM_CONTEXT,,AUTO
        13 000203   100006 236105                    LDQ     6,AL,PR1
        13 000204   100005 116105                    CMPQ    5,AL,PR1
        13 000205   000265 600000 13                 TZE     s:8790

      827     8774    2             VM_CONTEXT.MESSAGE_SET.LOW(INDX1)
      828     8775    2           THEN
      829     8776    3           DO;

      830     8777    3               CALL BINCHAR (CONVERT_BUF,VM_CONTEXT.MESSAGE_SET.HIGH(INDX1));

   8777 13 000206   200005 235100                    LDA     INDX1,,AUTO
        13 000207   000003 735000                    ALS     3
        13 000210   000100 301505                    BTD
        13 000211   100006 000004                    NDSC9   6,A,PR1                  cn=0,s=lsgnf,sf=0,n=4
        13 000212   200011 030014                    NDSC9   CONVERT_BUF,,AUTO        cn=0,s=nosgn,sf=0,n=12

      831     8778    4               DO INDX2 = 0 TO LENGTHC(CONVERT_BUF) - 1;

   8778 13 000213   200006 450100                    STZ     INDX2,,AUTO
        13 000214   000223 710000 13                 TRA     s:8782+1

      832     8779    4                   IF SUBSTR(CONVERT_BUF,INDX2,1) ~= '0'

   8779 13 000215   200006 235100                    LDA     INDX2,,AUTO
        13 000216   040000 106505                    CMPC    fill='040'O
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:142  
        13 000217   200011 000001                    ADSC9   CONVERT_BUF,A,AUTO       cn=0,n=1
        13 000220   000006 000001 14                 ADSC9   6                        cn=0,n=1
        13 000221   000230 601000 13                 TNZ     INSERT_HIGH

      833     8780    4                   THEN
      834     8781    4                       GOTO INSERT_HIGH;
      835     8782    4               END;

   8782 13 000222   200006 054100                    AOS     INDX2,,AUTO
        13 000223   200006 235100                    LDA     INDX2,,AUTO
        13 000224   000013 115007                    CMPA    11,DL
        13 000225   000215 604400 13                 TMOZ    s:8779

      836     8783    3               INDX2 = LENGTHC(CONVERT_BUF) - 1;

   8783 13 000226   000013 236007                    LDQ     11,DL
        13 000227   200006 756100                    STQ     INDX2,,AUTO

      837     8784    3   INSERT_HIGH:
      838     8785    3               INDX3 = LENGTHC(CONVERT_BUF) - INDX2;

   8785 13 000230   000014 235007       INSERT_HIGH  LDA     12,DL
        13 000231   200006 135100                    SBLA    INDX2,,AUTO
        13 000232   200007 755100                    STA     INDX3,,AUTO

      839     8786    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,'-',

   8786 13 000233   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000234   000100 101500                    MRL     fill='000'O
        13 000235   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000236   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000237   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000240   000000 636010                    EAQ     0,X0
        13 000241   000022 772000                    QRL     18
        13 000242   200010 136100                    SBLQ    CHARPOS,,AUTO
        13 000243   000000 621006                    EAX1    0,QL
        13 000244   200010 235100                    LDA     CHARPOS,,AUTO
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:143  
        13 000245   040145 100400                    MLR     fill='040'O
        13 000246   000007 000001 14                 ADSC9   7                        cn=0,n=1
        13 000247   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1
        13 000250   000001 116007                    CMPQ    1,DL
        13 000251   000261 604400 13                 TMOZ    s:8788
        13 000252   777777 621006                    EAX1    -1,QL
        13 000253   200007 722100                    LXL2    INDX3,,AUTO
        13 000254   200006 235100                    LDA     INDX2,,AUTO
        13 000255   200010 236100                    LDQ     CHARPOS,,AUTO
        13 000256   040146 100545                    MLR     fill='040'O
        13 000257   200011 000012                    ADSC9   CONVERT_BUF,A,AUTO       cn=0,n=*X2
        13 000260   000000 400011                    ADSC9   0,Q,PR0                  cn=2,n=*X1

      840     8787    3                 SUBSTR(CONVERT_BUF,INDX2,INDX3));
      841     8788    3               CHARPOS = CHARPOS + LENGTHC('-') + INDX3;

   8788 13 000261   200010 236100                    LDQ     CHARPOS,,AUTO
        13 000262   200007 036100                    ADLQ    INDX3,,AUTO
        13 000263   000001 036007                    ADLQ    1,DL
        13 000264   200010 756100                    STQ     CHARPOS,,AUTO

      842     8789    3           END;

      843     8790    2           IF INDX1 ~= VM_CONTEXT.NUM_ENTRIES -1

   8790 13 000265   200003 471500                    LDP1    @VM_CONTEXT,,AUTO
        13 000266   100002 236100                    LDQ     2,,PR1
        13 000267   000001 136007                    SBLQ    1,DL
        13 000270   200005 116100                    CMPQ    INDX1,,AUTO
        13 000271   000307 600000 13                 TZE     s:8796

      844     8791    2           THEN                       /* More to come */
      845     8792    3           DO;                      /* Add a comma */

      846     8793    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,',');

   8793 13 000272   000100 101500                    MRL     fill='000'O
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:144  
        13 000273   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000274   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000275   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000276   000000 636010                    EAQ     0,X0
        13 000277   000022 772000                    QRL     18
        13 000300   200010 136100                    SBLQ    CHARPOS,,AUTO
        13 000301   000000 621006                    EAX1    0,QL
        13 000302   200010 235100                    LDA     CHARPOS,,AUTO
        13 000303   040145 100400                    MLR     fill='040'O
        13 000304   000010 000001 14                 ADSC9   8                        cn=0,n=1
        13 000305   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

      847     8794    3               CHARPOS = CHARPOS + LENGTHC(',');

   8794 13 000306   200010 054100                    AOS     CHARPOS,,AUTO

      848     8795    3           END;

      849     8796    2       END;                            /* Do INDX1 = ... end */

   8796 13 000307   200005 054100                    AOS     INDX1,,AUTO
        13 000310   200005 236100                    LDQ     INDX1,,AUTO
        13 000311   000130 604000 13                 TMI     s:8756
        13 000312   100002 116100                    CMPQ    2,,PR1
        13 000313   000130 602000 13                 TNC     s:8756

      850     8797        /*
      851     8798             ***** Now build the truth expression ...
      852     8799        */
      853     8800    1   BUILD_EXP:
      854     8801    1       IF VM_CONTEXT.TRUTH_TREE$ ~= ADDR(NIL)

   8801 13 000314   200003 471500       BUILD_EXP    LDP1    @VM_CONTEXT,,AUTO
        13 000315   100001 236100                    LDQ     1,,PR1
        13 000316   000011 116000 14                 CMPQ    9
        13 000317   000373 600000 13                 TZE     s:8831

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:145  
      855     8802    1       THEN
      856     8803    2       DO;

      857     8804                %INIT_STR (CODE=E_CHAR_WHEN, STR=VM_CHAR_WHEN, TEST=YES);

   8811 13 000320   000000 236000 xsym               LDQ     VM_CHAR_WHEN
        13 000321   000033 772000                    QRL     27
        13 000322   000000 620006                    EAX0    0,QL
        13 000323   040000 106440                    CMPC    fill='040'O
        13 000324   000000 200010 xsym               ADSC9   VM_CHAR_WHEN             cn=1,n=*X0
        13 000325   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000326   000333 601000 13                 TNZ     s:8827

   8813 13 000327   000012 630400 14                 EPPR0   10
        13 000330   000001 631400 14                 EPPR1   1
        13 000331   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000332   000000 011000                    NOP     0

      858     8827    2           substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_WHEN.NAME#;

   8827 13 000333   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000334   000100 101500                    MRL     fill='000'O
        13 000335   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000336   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000337   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000340   000000 636010                    EAQ     0,X0
        13 000341   000022 772000                    QRL     18
        13 000342   200010 136100                    SBLQ    CHARPOS,,AUTO
        13 000343   200015 756100                    STQ     CONVERT_BUF+4,,AUTO
        13 000344   000000 236000 xsym               LDQ     VM_CHAR_WHEN
        13 000345   000033 772000                    QRL     27
        13 000346   000000 621006                    EAX1    0,QL
        13 000347   200015 722100                    LXL2    CONVERT_BUF+4,,AUTO
        13 000350   200010 235100                    LDA     CHARPOS,,AUTO
        13 000351   040145 100440                    MLR     fill='040'O
        13 000352   000000 200011 xsym               ADSC9   VM_CHAR_WHEN             cn=1,n=*X1
        13 000353   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:146  

      859     8828    2           CHARPOS = CHARPOS + VM_CHAR_WHEN.L#;

   8828 13 000354   000000 236000 xsym               LDQ     VM_CHAR_WHEN
        13 000355   000033 772000                    QRL     27
        13 000356   200010 036100                    ADLQ    CHARPOS,,AUTO
        13 000357   200010 756100                    STQ     CHARPOS,,AUTO

      860     8829    2           CALL VMS$FMT_EXP (VM_CONTEXT.TRUTH_TREE$,TEXTC,CHARPOS);

   8829 13 000360   200010 631500                    EPPR1   CHARPOS,,AUTO
        13 000361   200016 451500                    STP1    CONVERT_BUF+5,,AUTO
        13 000362   200004 236100                    LDQ     @TEXTC,,AUTO
        13 000363   200015 756100                    STQ     CONVERT_BUF+4,,AUTO
        13 000364   200003 236100                    LDQ     @VM_CONTEXT,,AUTO
        13 000365   000001 036003                    ADLQ    1,DU
        13 000366   200014 756100                    STQ     CONVERT_BUF+3,,AUTO
        13 000367   200014 630500                    EPPR0   CONVERT_BUF+3,,AUTO
        13 000370   000014 631400 14                 EPPR1   12
        13 000371   000000 701000 xent               TSX1    VMS$FMT_EXP
        13 000372   000000 011000                    NOP     0

      861     8830    2       END;

      862     8831    1       IF CHARPOS > 511

   8831 13 000373   200010 235100                    LDA     CHARPOS,,AUTO
        13 000374   000777 115007                    CMPA    511,DL
        13 000375   000422 604400 13                 TMOZ    s:8861

      863     8832    1       THEN
      864     8833    2       DO;

      865     8834                %INIT_STR (CODE=E_CHAR_ERROR_MSG, STR=VM_CHAR_ERROR_MSG, TEST=YES);

   8841 13 000376   040000 106400                    CMPC    fill='040'O
        13 000377   000000 200017 11                 ADSC9   VM_CHAR_ERROR_MSG        cn=1,n=15
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:147  
        13 000400   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000401   000406 601000 13                 TNZ     s:8857

   8843 13 000402   000015 630400 14                 EPPR0   13
        13 000403   000001 631400 14                 EPPR1   1
        13 000404   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000405   000000 011000                    NOP     0

      866     8857    2           TEXTC.TEXT= VM_CHAR_ERROR_MSG.NAME#;

   8857 13 000406   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000407   000100 101500                    MRL     fill='000'O
        13 000410   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000411   200014 000002                    ADSC9   CONVERT_BUF+3,,AUTO      cn=0,n=2
        13 000412   200014 220100                    LDX0    CONVERT_BUF+3,,AUTO
        13 000413   040140 100400                    MLR     fill='040'O
        13 000414   000000 200017 11                 ADSC9   VM_CHAR_ERROR_MSG        cn=1,n=15
        13 000415   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0

      867     8858    2           TEXTC.SIZ = VM_CHAR_ERROR_MSG.L#;

   8858 13 000416   000100 100400                    MLR     fill='000'O
        13 000417   000000 000001 11                 ADSC9   VM_CHAR_ERROR_MSG        cn=0,n=1
        13 000420   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

      868     8859    2       END;

   8859 13 000421   000426 710000 13                 TRA     s:8862

      869     8860    1       ELSE
      870     8861    1           TEXTC.SIZ = CHARPOS;

   8861 13 000422   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000423   000100 101500                    MRL     fill='000'O
        13 000424   200010 000004                    ADSC9   CHARPOS,,AUTO            cn=0,n=4
        13 000425   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:148  
      871     8862    1       RETURN;

   8862 13 000426   000000 702200 xent               TSX2  ! X66_ARET

VM_CHAR_ERROR_MSG
 Sect OctLoc
  11     000   017040 040040   040040 040040   040040 040040   040040 040040    .

E_CHAR_ERROR_MSG
 Sect OctLoc
  12     000   261523 022600                                                    ....

(unnamed)
 Sect OctLoc
  14     000   040040 040040   000002 000000   000000 006000   000000 006000        ............
  14     004   000000 006000   000000 006000   060040 040040   055040 040040    ........0   -
  14     010   054040 040040   000000 006014   000000 006000   000000 006000    ,   ............
  14     014   000003 000000   000000 006000   000000 006000                    ............
      872     8863    1   END VMS$FMT_SELECT;
      873     8864        %EOD;

PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:149  
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMS$FMT_SELECT.
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:150  

 **** Variables and constants ****

  ****  Section 011  Data  VMS$FMT_SELECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 VM_CHAR_ERROR_MSG

  ****  Section 012 RoData VMS$FMT_SELECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 E_CHAR_ERROR_MSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @TEXTC                     3-0-0/w PTR         r     1 @VM_CONTEXT
    10-0-0/w SBIN        r     1 CHARPOS                   11-0-0/c CHAR(12)    r     1 CONVERT_BUF
     5-0-0/w SBIN        r     1 INDX1                      6-0-0/w SBIN        r     1 INDX2
     7-0-0/w SBIN        r     1 INDX3                     *0-0-0/c ASTR(9)     r     1 TEXTC
    *0-0-0/w STRC(252)   r     1 VM_CONTEXT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR               1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/w STRC        r     1 E_CHAR_NEXT
     0-0-0/w STRC        r     1 E_CHAR_PREVIOUS            0-0-0/w STRC        r     1 E_CHAR_WHEN
     0-0-0/w UBIN              1 M$DO_NUM                   0-0-0/w UBIN              1 M$LO_NUM
     0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM         0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:151  
     0-0-0/w UBIN              1 M$MAIL_FILE_NUM            0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM
     0-0-0/w UBIN              1 M$ME_NUM                   0-0-0/w UBIN              1 M$NODE_NUM
     0-0-0/w UBIN              1 M$SI_NUM                   0-0-0/w UBIN              1 M$WORK_NUM
     0-0-0/w PTR               1 VM_ADDLIST$                0-0-0/d VECT              1 VM_ADDLIST_
     0-0-0/w PTR               1 VM_ADDREC$                 0-0-0/d VECT              1 VM_ADDREC_
     0-0-0/c ASTR(9)     r     1 VM_CHAR_NEXT               0-0-0/c ASTR(9)     r     1 VM_CHAR_PREVIOUS
     0-0-0/c ASTR(9)     r     1 VM_CHAR_WHEN               0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
     0-0-0/w PTR               1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)          1 VM_MAIL_ACCT
     0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$MAIL_CENTRAL             0-0-0N  NULL        r     1 M$MAIL_COMGROUP
     0-0-0N  NULL        r     1 M$MAIL_FILE                0-0-0N  NULL        r     1 M$MAIL_GLOBAL
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$NODE
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC
     0-0-0N  NULL        r     1 M$WORK                     0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMS$FMT_SELECT requires 279 words for executable code.
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:152  
   Procedure VMS$FMT_SELECT requires 16 words of local(AUTO) storage.
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:153  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:154  
          MINI XREF LISTING

BUILD_EXP
      8801**LABEL    8749--GOTO
CHARPOS
      8419**DCL      8683<<ASSIGN   8717>>ASSIGN   8718<<ASSIGN   8718>>ASSIGN   8746>>ASSIGN   8747<<ASSIGN
      8747>>ASSIGN   8768>>CALLBLT  8769<<ASSIGN   8769>>ASSIGN   8786>>CALLBLT  8788<<ASSIGN   8788>>ASSIGN
      8793>>CALLBLT  8794<<ASSIGN   8794>>ASSIGN   8827>>ASSIGN   8828<<ASSIGN   8828>>ASSIGN   8829<>CALL
      8831>>IF       8861>>ASSIGN
CONVERT_BUF
      8420**DCL      8756<<CALLBLT  8760--DOINDEX  8761>>IF       8765--ASSIGN   8767--ASSIGN   8768>>CALLBLT
      8777<<CALLBLT  8778--DOINDEX  8779>>IF       8783--ASSIGN   8785--ASSIGN   8786>>CALLBLT
ERRMSG_FID.L#
      8221**DCL      8221--IMP-SIZ
E_CHAR_ERROR_MSG
      8486**DCL      8843<>CALL
E_CHAR_NEXT
      8600**DCL      8732<>CALL
E_CHAR_PREVIOUS
      8645**DCL      8703<>CALL
E_CHAR_WHEN
      8555**DCL      8813<>CALL
INDX1
      8416**DCL      8755<<DOINDEX  8756>>CALLBLT  8773>>IF       8773>>IF       8777>>CALLBLT  8790>>IF
INDX2
      8417**DCL      8760<<DOINDEX  8761>>IF       8765<<ASSIGN   8767>>ASSIGN   8768>>CALLBLT  8778<<DOINDEX
      8779>>IF       8783<<ASSIGN   8785>>ASSIGN   8786>>CALLBLT
INDX3
      8418**DCL      8767<<ASSIGN   8768>>CALLBLT  8769>>ASSIGN   8785<<ASSIGN   8786>>CALLBLT  8788>>ASSIGN
INSERT_HIGH
      8785**LABEL    8781--GOTO
INSERT_LOW
      8767**LABEL    8763--GOTO
TEXTC
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:155  
      8411**DCL        21--PROC     8829<>CALL
TEXTC.SIZ
      8412**DCL      8413--IMP-SIZ  8682>>ASSIGN   8717>>ASSIGN   8746>>ASSIGN   8768>>CALLBLT  8786>>CALLBLT
      8793>>CALLBLT  8827>>ASSIGN   8829>>CALL     8857>>ASSIGN   8858<<ASSIGN   8861<<ASSIGN
TEXTC.TEXT
      8413**DCL      8682<<ASSIGN   8717<<ASSIGN   8746<<ASSIGN   8768<<CALLBLT  8786<<CALLBLT  8793<<CALLBLT
      8827<<ASSIGN   8857<<ASSIGN
VMD$ERRMSG
      8426**DCL-ENT  8703--CALL     8732--CALL     8813--CALL     8843--CALL
VMS$FMT_EXP
      8422**DCL-ENT  8829--CALL
VM_CHAR_ERROR_MSG
      8471**DCL      8843<>CALL
VM_CHAR_ERROR_MSG.L#
      8471**DCL      8858>>ASSIGN
VM_CHAR_ERROR_MSG.NAME#
      8471**DCL      8841>>IF       8857>>ASSIGN
VM_CHAR_NEXT
      8527**DCL      8732<>CALL
VM_CHAR_NEXT.L#
      8527**DCL      8527--IMP-SIZ  8730>>IF       8732>>CALL     8746>>ASSIGN   8747>>ASSIGN
VM_CHAR_NEXT.NAME#
      8527**DCL      8730>>IF       8746>>ASSIGN
VM_CHAR_PREVIOUS
      8534**DCL      8703<>CALL
VM_CHAR_PREVIOUS.L#
      8534**DCL      8534--IMP-SIZ  8701>>IF       8703>>CALL     8717>>ASSIGN   8718>>ASSIGN
VM_CHAR_PREVIOUS.NAME#
      8534**DCL      8701>>IF       8717>>ASSIGN
VM_CHAR_WHEN
      8541**DCL      8813<>CALL
VM_CHAR_WHEN.L#
      8541**DCL      8541--IMP-SIZ  8811>>IF       8813>>CALL     8827>>ASSIGN   8828>>ASSIGN
VM_CHAR_WHEN.NAME#
      8541**DCL      8811>>IF       8827>>ASSIGN
VM_CONTEXT
PL6.E3A0      #003=VMS$FMT_SELECT File=VMS$SELECT.:VMB6TSI                       WED 08/20/97 15:25 Page:156  
      8387**DCL        21--PROC
VM_CONTEXT.FLAGS
      8396**DCL      8688>>IF
VM_CONTEXT.FLAGS.NEXT
      8399**DCL      8720>>IF
VM_CONTEXT.FLAGS.PREV
      8401**DCL      8691>>IF
VM_CONTEXT.MESSAGE_SET.HIGH
      8407**DCL      8773>>IF       8777>>CALLBLT
VM_CONTEXT.MESSAGE_SET.LOW
      8405**DCL      8756>>CALLBLT  8773>>IF
VM_CONTEXT.NUM_ENTRIES
      8392**DCL      8755>>DOINDEX  8790>>IF
VM_CONTEXT.TRUTH_TREE$
      8390**DCL      8801>>IF       8829<>CALL
X$STRING.SIZ
      8067**DCL      8068--IMP-SIZ

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:157  
      874        1        /*T***********************************************************/
      875        2        /*T*                                                         */
      876        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      877        4        /*T*                                                         */
      878        5        /*T***********************************************************/
      879        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      880        7        /*********************************************************************/
      881        8        /*F*
      882        9             NAME: VMS$FMT_EXP
      883       10             PURPOSE:
      884       11                   To take a sub tree and create a text representation.
      885       12             DESCRIPTION:
      886       13                   This routine is called by VMS$FMT_SELECT and recursively
      887       14                   by itself. Not to be called by any other routines!!!
      888       15        */
      889       16        /*********************************************************************/
      890       17        VMS$FMT_EXP: PROC (TREE$,TEXTC,CHARPOS);
      891       18        /***** Include files *****/
      892       19          %INCLUDE CP_6;
      893     5578          %INCLUDE CP_6_SUBS;
      894     6118          %INCLUDE VM_MACRO_C;
      895     7386          %INCLUDE VM_SUBS_C;
      896     7646          %INCLUDE VM_DATA_R;
      897     8077          %INCLUDE VM_PERR_C;
      898     8372          %INCLUDE XU_MACRO_C;
      899    11478          %INCLUDE XU_SUBS_C;
      900    11570        /***** Parameters *****/
      901    11571    1   DCL TREE$ PTR;
      902    11572          %TEXTC (NAME=TEXTC,STCLASS=" ");
      903    11577    1   DCL CHARPOS SBIN WORD;
      904    11578        %INIT_STR (DODCL=YES);
      905    11601        /***** Local variables *****/
      906    11602    1   DCL INDX1 SBIN WORD AUTO;
      907    11603    1   DCL INDX2 SBIN WORD AUTO;
      908    11604    1   DCL INDX3 SBIN WORD AUTO;
      909    11605    1   DCL PTR1$ PTR AUTO;
      910    11606    1   DCL PTR2$ PTR AUTO;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:158  
      911    11607    1   DCL PTR3$ PTR AUTO;
      912    11608    1   DCL DELIM CHAR(1) AUTO;
      913    11609    1   DCL END1 SBIN WORD AUTO;
      914    11610    1   DCL END2 SBIN WORD AUTO;
      915    11611    1   DCL END3 SBIN WORD AUTO;
      916    11612        /***** Based structures *****/
      917    11613          %PARSE$OUT (NAME=P$B,STCLASS=BASED);
      918    11658          %PARSE$SYM (NAME=P$S,STCLASS=BASED);
      919    11696        %VLP_NAME(FPTN=VM_CHAR_WHEN, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      920    11723        %VLP_ERRCODE (FPTN=E_CHAR_WHEN,        STCLASS="CONSTANT SYMDEF",
      921    11724                       ERR#=%E$CHAR_WHEN,      FCG=VM,MID=S);
      922    11769        /*E*  ERROR:VMS-E$CHAR_WHEN-0
      923    11770              MESSAGE: when&
      924    11771        */
      925    11772              %VLP_NAME (FPTN=VM_CHAR_BROADCAST, LEN=15, L=15, NAME=' ', STCLASS=
             11772                  "STATIC SYMDEF");
      926    11799        %VLP_ERRCODE (FPTN=E_CHAR_BROADCAST,   STCLASS="CONSTANT SYMDEF",
      927    11800                       ERR#=%E$CHAR_BROADCAST,           FCG=VM,MID=S);
      928    11845        /*E*  ERROR:VMS-E$CHAR_BROADCAST-0
      929    11846              MESSAGE:Broadcast
      930    11847        */
      931    11848              %VLP_NAME (FPTN=VM_CHAR_DELIVERY, LEN=15, L=15, NAME=' ', STCLASS=
             11848                  "STATIC SYMDEF");
      932    11875        %VLP_ERRCODE (FPTN=E_CHAR_DELIVERY,    STCLASS="CONSTANT SYMDEF",
      933    11876                       ERR#=%E$CHAR_DELIVERY,            FCG=VM,MID=S);
      934    11921        /*E*  ERROR:VMS-E$CHAR_DELIVERY-0
      935    11922              MESSAGE:Delivery
      936    11923        */
      937    11924              %VLP_NAME (FPTN=VM_CHAR_DELETED, LEN=15, L=15, NAME=' ', STCLASS=
             11924                  "STATIC SYMDEF");
      938    11951        %VLP_ERRCODE (FPTN=E_CHAR_DELETED,     STCLASS="CONSTANT SYMDEF",
      939    11952                       ERR#=%E$CHAR_DELETED,             FCG=VM,MID=S);
      940    11997        /*E*  ERROR:VMS-E$CHAR_DELETED-0
      941    11998              MESSAGE:Deleted
      942    11999        */
      943    12000              %VLP_NAME (FPTN=VM_CHAR_ERROR, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF"
             12000                  );
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:159  
      944    12027        %VLP_ERRCODE (FPTN=E_CHAR_ERROR,       STCLASS="CONSTANT SYMDEF",
      945    12028                       ERR#=%E$CHAR_ERROR,               FCG=VM,MID=S);
      946    12073        /*E*  ERROR:VMS-E$CHAR_ERROR-0
      947    12074              MESSAGE:Error
      948    12075        */
      949    12076              %VLP_NAME (FPTN=VM_CHAR_FCOPY, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF"
             12076                  );
      950    12103        %VLP_ERRCODE (FPTN=E_CHAR_FCOPY,       STCLASS="CONSTANT SYMDEF",
      951    12104                       ERR#=%E$CHAR_FCOPY,               FCG=VM,MID=S);
      952    12149        /*E*  ERROR:VMS-E$CHAR_FCOPY-0
      953    12150              MESSAGE:FCopy
      954    12151        */
      955    12152              %VLP_NAME (FPTN=VM_CHAR_FROM, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             12152                  ;
      956    12179        %VLP_ERRCODE (FPTN=E_CHAR_FROM,        STCLASS="CONSTANT SYMDEF",
      957    12180                       ERR#=%E$CHAR_FROM,                FCG=VM,MID=S);
      958    12225        /*E*  ERROR:VMS-E$CHAR_FROM-0
      959    12226              MESSAGE:From
      960    12227        */
      961    12228              %VLP_NAME (FPTN=VM_CHAR_MARKED, LEN=15, L=15, NAME=' ', STCLASS=
             12228                  "STATIC SYMDEF");
      962    12255        %VLP_ERRCODE (FPTN=E_CHAR_MARKED,      STCLASS="CONSTANT SYMDEF",
      963    12256                       ERR#=%E$CHAR_MARKED,              FCG=VM,MID=S);
      964    12301        /*E*  ERROR:VMS-E$CHAR_MARKED-0
      965    12302              MESSAGE:Marked
      966    12303        */
      967    12304              %VLP_NAME (FPTN=VM_CHAR_NEW, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      968    12331        %VLP_ERRCODE (FPTN=E_CHAR_NEW,         STCLASS="CONSTANT SYMDEF",
      969    12332                       ERR#=%E$CHAR_NEW,                 FCG=VM,MID=S);
      970    12377        /*E*  ERROR:VMS-E$CHAR_NEW-0
      971    12378              MESSAGE:New
      972    12379        */
      973    12380              %VLP_NAME (FPTN=VM_CHAR_OLD, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      974    12407        %VLP_ERRCODE (FPTN=E_CHAR_OLD,         STCLASS="CONSTANT SYMDEF",
      975    12408                       ERR#=%E$CHAR_OLD,                 FCG=VM,MID=S);
      976    12453        /*E*  ERROR:VMS-E$CHAR_OLD-0
      977    12454              MESSAGE:Old&
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:160  
      978    12455        */
      979    12456              %VLP_NAME (FPTN=VM_CHAR_AND, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      980    12483        %VLP_ERRCODE (FPTN=E_CHAR_AND,         STCLASS="CONSTANT SYMDEF",
      981    12484                       ERR#=%E$CHAR_AND,                 FCG=VM,MID=S);
      982    12529        /*E*  ERROR:VMS-E$CHAR_AND-0
      983    12530              MESSAGE:&and&
      984    12531        */
      985    12532              %VLP_NAME (FPTN=VM_CHAR_OR, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      986    12559        %VLP_ERRCODE (FPTN=E_CHAR_OR,          STCLASS="CONSTANT SYMDEF",
      987    12560                       ERR#=%E$CHAR_OR,                  FCG=VM,MID=S);
      988    12605        /*E*  ERROR:VMS-E$CHAR_OR-0
      989    12606              MESSAGE:&or&
      990    12607        */
      991    12608              %VLP_NAME (FPTN=VM_CHAR_NOT, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      992    12635        %VLP_ERRCODE (FPTN=E_CHAR_NOT,         STCLASS="CONSTANT SYMDEF",
      993    12636                       ERR#=%E$CHAR_NOT,                 FCG=VM,MID=S);
      994    12681        /*E*  ERROR:VMS-E$CHAR_NOT-0
      995    12682              MESSAGE:&not&
      996    12683        */
      997    12684              %VLP_NAME (FPTN=VM_CHAR_REFERENCE, LEN=15, L=15, NAME=' ', STCLASS=
             12684                  "STATIC SYMDEF");
      998    12711        %VLP_ERRCODE (FPTN=E_CHAR_REFERENCE,         STCLASS="CONSTANT SYMDEF",
      999    12712                       ERR#=%E$CHAR_REFERENCE,                 FCG=VM,MID=S);
     1000    12757        /*E*  ERROR:VMS-E$CHAR_REFERENCE-0
     1001    12758              MESSAGE:Reference
     1002    12759        */
     1003    12760              %VLP_NAME (FPTN=VM_CHAR_REPLYTO, LEN=15, L=15, NAME=' ', STCLASS=
             12760                  "STATIC SYMDEF");
     1004    12787        %VLP_ERRCODE (FPTN=E_CHAR_REPLYTO,         STCLASS="CONSTANT SYMDEF",
     1005    12788                       ERR#=%E$CHAR_REPLYTO,                 FCG=VM,MID=S);
     1006    12833        /*E*  ERROR:VMS-E$CHAR_REPLYTO-0
     1007    12834              MESSAGE:Reply To
     1008    12835        */
     1009    12836              %VLP_NAME (FPTN=VM_CHAR_SUBJECT, LEN=15, L=15, NAME=' ', STCLASS=
             12836                  "STATIC SYMDEF");
     1010    12863        %VLP_ERRCODE (FPTN=E_CHAR_SUBJECT,         STCLASS="CONSTANT SYMDEF",
     1011    12864                       ERR#=%E$CHAR_SUBJECT,                 FCG=VM,MID=S);
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:161  
     1012    12909        /*E*  ERROR:VMS-E$CHAR_SUBJECT-0
     1013    12910              MESSAGE:Subject
     1014    12911        */
     1015    12912              %VLP_NAME (FPTN=VM_CHAR_TO, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
     1016    12939        %VLP_ERRCODE (FPTN=E_CHAR_TO,         STCLASS="CONSTANT SYMDEF",
     1017    12940                       ERR#=%E$CHAR_TO,                 FCG=VM,MID=S);
     1018    12985        /*E*  ERROR:VMS-E$CHAR_TO-0
     1019    12986              MESSAGE:To
     1020    12987        */
     1021    12988              %VLP_NAME (FPTN=VM_CHAR_FWD, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
     1022    13015        %VLP_ERRCODE (FPTN=E_CHAR_FWD,         STCLASS="CONSTANT SYMDEF",
     1023    13016                       ERR#=%E$CHAR_FWD,                 FCG=VM,MID=S);
     1024    13061        /*E*  ERROR:VMS-E$CHAR_FWD-0
     1025    13062              MESSAGE:Fwd
     1026    13063        */
     1027    13064              %VLP_NAME (FPTN=VM_CHAR_ANSWER, LEN=15, L=15, NAME=' ', STCLASS=
             13064                  "STATIC SYMDEF");
     1028    13091        %VLP_ERRCODE (FPTN=E_CHAR_ANSWER,         STCLASS="CONSTANT SYMDEF",
     1029    13092                       ERR#=%E$CHAR_ANSWER,                 FCG=VM,MID=S);
     1030    13137        /*E*  ERROR:VMS-E$CHAR_ANSWER-0
     1031    13138              MESSAGE:Answer
     1032    13139        */
     1033    13140              %VLP_NAME (FPTN=VM_CHAR_ACKNOWLEDGMENT, LEN=15, L=15, NAME=' ', STCLASS=
             13140                  "STATIC SYMDEF");
     1034    13167        %VLP_ERRCODE (FPTN=E_CHAR_ACKNOWLEDGMENT,         STCLASS="CONSTANT SYMDEF",
     1035    13168                       ERR#=%E$CHAR_ACKNOWLEDGMENT,                 FCG=VM,MID=S);
     1036    13213        /*E*  ERROR:VMS-E$CHAR_ACKNOWLEDGMENT-0
     1037    13214              MESSAGE:Acknowledgement
     1038    13215        */
     1039    13216              %VLP_NAME (FPTN=VM_CHAR_NEXT, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             13216                  ;
     1040    13243        %VLP_ERRCODE (FPTN=E_CHAR_NEXT,         STCLASS="CONSTANT SYMDEF",
     1041    13244                       ERR#=%E$CHAR_NEXT,                 FCG=VM,MID=S);
     1042    13289        /*E*  ERROR:VMS-E$CHAR_NEXT-0
     1043    13290              MESSAGE:Next
     1044    13291        */
     1045    13292              %VLP_NAME (FPTN=VM_CHAR_PREVIOUS, LEN=15, L=15, NAME=' ', STCLASS=
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:162  
             13292                  "STATIC SYMDEF");
     1046    13319        %VLP_ERRCODE (FPTN=E_CHAR_PREVIOUS,         STCLASS="CONSTANT SYMDEF",
     1047    13320                       ERR#=%E$CHAR_PREVIOUS,                 FCG=VM,MID=S);
     1048    13365        /*E*  ERROR:VMS-E$CHAR_PREVIOUS-0
     1049    13366              MESSAGE:Previous
     1050    13367        */
     1051    13368              %VLP_NAME (FPTN=VM_CHAR_UNEXAMINED, LEN=15, L=15, NAME=' ', STCLASS=
             13368                  "STATIC SYMDEF");
     1052    13395        %VLP_ERRCODE (FPTN=E_CHAR_UNEXAMINED,         STCLASS="CONSTANT SYMDEF",
     1053    13396                       ERR#=%E$CHAR_UNEXAMINED,                 FCG=VM,MID=S);
     1054    13441        /*E*  ERROR:VMS-E$CHAR_UNEXAMINED-0
     1055    13442              MESSAGE:Unexamined
     1056    13443        */
     1057    13444              %VLP_NAME (FPTN=VM_CHAR_EXAMINED, LEN=15, L=15, NAME=' ', STCLASS=
             13444                  "STATIC SYMDEF");
     1058    13471        %VLP_ERRCODE (FPTN=E_CHAR_EXAMINED,         STCLASS="CONSTANT SYMDEF",
     1059    13472                       ERR#=%E$CHAR_EXAMINED,                 FCG=VM,MID=S);
     1060    13517        /*E*  ERROR:VMS-E$CHAR_EXAMINED-0
     1061    13518              MESSAGE:Examined
     1062    13519        */
     1063    13520              %VLP_NAME (FPTN=VM_CHAR_RR, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
     1064    13547        %VLP_ERRCODE (FPTN=E_CHAR_RR,         STCLASS="CONSTANT SYMDEF",
     1065    13548                       ERR#=%E$CHAR_RR,                 FCG=VM,MID=S);
     1066    13593        /*E*  ERROR:VMS-E$CHAR_RR-0
     1067    13594              MESSAGE:RR
     1068    13595        */
     1069    13596              %VLP_NAME (FPTN=VM_CHAR_SENT, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             13596                  ;
     1070    13623        %VLP_ERRCODE (FPTN=E_CHAR_SENT,         STCLASS="CONSTANT SYMDEF",
     1071    13624                       ERR#=%E$CHAR_SENT,                 FCG=VM,MID=S);
     1072    13669        /*E*  ERROR:VMS-E$CHAR_SENT-0
     1073    13670              MESSAGE:Date Sent
     1074    13671        */
     1075    13672              %VLP_NAME (FPTN=VM_CHAR_RCVD, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             13672                  ;
     1076    13699        %VLP_ERRCODE (FPTN=E_CHAR_RCVD,         STCLASS="CONSTANT SYMDEF",
     1077    13700                       ERR#=%E$CHAR_RCVD,                 FCG=VM,MID=S);
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:163  
     1078    13745        /*E*  ERROR:VMS-E$CHAR_RCVD-0
     1079    13746              MESSAGE:Date Rcvd
     1080    13747        */
     1081    13748        %EJECT;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:164  
     1082    13749    1         END1 = TREE$ -> P$B.NSUBLKS - 1;
     1083    13750    2       DO INDX1 = 0 TO END1;
     1084    13751    2           PTR1$ = TREE$ -> P$B.SUBLK$(INDX1);
     1085    13752    3           DO CASE (PTR1$ -> P$B.CODE);
     1086    13753    3           CASE (%SEL_EXP);
     1087    13754    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,'(');
     1088    13755    3               CHARPOS = CHARPOS + 1;
     1089    13756    3               CALL VMS$FMT_EXP (PTR1$,TEXTC,CHARPOS);
     1090    13757    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,')');
     1091    13758    3               CHARPOS = CHARPOS + 1;
     1092    13759    3           CASE (%SEL_ACKNOWLEDGMENT);
     1093    13760                    %INIT_STR (CODE=E_CHAR_ACKNOWLEDGMENT, TEST=YES,
     1094    13761                    STR=VM_CHAR_ACKNOWLEDGMENT);
     1095    13784    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_ACKNOWLEDGMENT.NAME#;
     1096    13785    3               CHARPOS = CHARPOS + VM_CHAR_ACKNOWLEDGMENT.L#;
     1097    13786    3           CASE (%SEL_ANSWER);
     1098    13787                    %INIT_STR (CODE=E_CHAR_ANSWER, STR=VM_CHAR_ANSWER, TEST=YES);
     1099    13810    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_ANSWER.NAME#;
     1100    13811    3               CHARPOS = CHARPOS + VM_CHAR_ANSWER.L#;
     1101    13812    3           CASE (%SEL_BROADCAST);
     1102    13813                    %INIT_STR (CODE=E_CHAR_BROADCAST, STR=VM_CHAR_BROADCAST, TEST=YES);
     1103    13836    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_BROADCAST.NAME#;
     1104    13837    3               CHARPOS = CHARPOS + VM_CHAR_BROADCAST.L#;
     1105    13838    3           CASE (%SEL_DELETED);
     1106    13839                    %INIT_STR (CODE=E_CHAR_DELETED, STR=VM_CHAR_DELETED, TEST=YES);
     1107    13862    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_DELETED.NAME#;
     1108    13863    3               CHARPOS = CHARPOS + VM_CHAR_DELETED.L#;
     1109    13864    3           CASE (%SEL_DELIVERY);
     1110    13865                    %INIT_STR (CODE=E_CHAR_DELIVERY, STR=VM_CHAR_DELIVERY, TEST=YES);
     1111    13888    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_DELIVERY.NAME#;
     1112    13889    3               CHARPOS = CHARPOS + VM_CHAR_DELIVERY.L#;
     1113    13890    3           CASE (%SEL_ERROR);
     1114    13891                    %INIT_STR (CODE=E_CHAR_ERROR, STR=VM_CHAR_ERROR, TEST=YES);
     1115    13914    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_ERROR.NAME#;
     1116    13915    3               CHARPOS = CHARPOS + VM_CHAR_ERROR.L#;
     1117    13916    3           CASE (%SEL_EXAMINED);
     1118    13917                    %INIT_STR (CODE=E_CHAR_EXAMINED, STR=VM_CHAR_EXAMINED, TEST=YES);
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:165  
     1119    13940    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_EXAMINED.NAME#;
     1120    13941    3               CHARPOS = CHARPOS + VM_CHAR_EXAMINED.L#;
     1121    13942    3           CASE (%SEL_FCOPY);
     1122    13943                    %INIT_STR (CODE=E_CHAR_FCOPY, STR=VM_CHAR_FCOPY, TEST=YES);
     1123    13966    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_FCOPY.NAME#;
     1124    13967    3               CHARPOS = CHARPOS + VM_CHAR_FCOPY.L#;
     1125    13968    3           CASE (%SEL_FWD);
     1126    13969                    %INIT_STR (CODE=E_CHAR_FWD, STR=VM_CHAR_FWD, TEST=YES);
     1127    13992    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_FWD.NAME#;
     1128    13993    3               CHARPOS = CHARPOS + VM_CHAR_FWD.L#;
     1129    13994    3           CASE (%SEL_MARKED);
     1130    13995                    %INIT_STR (CODE=E_CHAR_MARKED, STR=VM_CHAR_MARKED, TEST=YES);
     1131    14018    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_MARKED.NAME#;
     1132    14019    3               CHARPOS = CHARPOS + VM_CHAR_MARKED.L#;
     1133    14020    3           CASE (%SEL_NEW);
     1134    14021                    %INIT_STR (CODE=E_CHAR_NEW, STR=VM_CHAR_NEW, TEST=YES);
     1135    14044    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_NEW.NAME#;
     1136    14045    3               CHARPOS = CHARPOS + VM_CHAR_NEW.L#;
     1137    14046    3           CASE (%SEL_NEXT);
     1138    14047                    %INIT_STR (CODE=E_CHAR_NEXT, STR=VM_CHAR_NEXT, TEST=YES);
     1139    14070    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_NEXT.NAME#;
     1140    14071    3               CHARPOS = CHARPOS + VM_CHAR_NEXT.L#;
     1141    14072    3           CASE (%SEL_PREVIOUS);
     1142    14073                    %INIT_STR (CODE=E_CHAR_PREVIOUS, STR=VM_CHAR_PREVIOUS, TEST=YES);
     1143    14096    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_PREVIOUS.NAME#;
     1144    14097    3               CHARPOS = CHARPOS + VM_CHAR_PREVIOUS.L#;
     1145    14098    3           CASE (%SEL_OLD);
     1146    14099                    %INIT_STR (CODE=E_CHAR_OLD, STR=VM_CHAR_OLD, TEST=YES);
     1147    14122    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_OLD.NAME#;
     1148    14123    3               CHARPOS = CHARPOS + VM_CHAR_OLD.L#;
     1149    14124    3           CASE (%SEL_UNEXAMINED);
     1150    14125                    %INIT_STR (CODE=E_CHAR_UNEXAMINED, STR=VM_CHAR_UNEXAMINED, TEST=YES);
     1151    14148    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_UNEXAMINED.NAME#;
     1152    14149    3               CHARPOS = CHARPOS + VM_CHAR_UNEXAMINED.L#;
     1153    14150    3           CASE (%SEL_AND);
     1154    14151                    %INIT_STR (CODE=E_CHAR_AND, STR=VM_CHAR_AND, TEST=YES);
     1155    14174    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_AND.NAME#;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:166  
     1156    14175    3               CHARPOS = CHARPOS + VM_CHAR_AND.L#;
     1157    14176    3           CASE (%SEL_OR);
     1158    14177                    %INIT_STR (CODE=E_CHAR_OR, STR=VM_CHAR_OR, TEST=YES);
     1159    14200    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_OR.NAME#;
     1160    14201    3               CHARPOS = CHARPOS + VM_CHAR_OR.L#;
     1161    14202    3           CASE (%SEL_NOT);
     1162    14203                    %INIT_STR (CODE=E_CHAR_NOT, STR=VM_CHAR_NOT, TEST=YES);
     1163    14226    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_NOT.NAME#;
     1164    14227    3               CHARPOS = CHARPOS + VM_CHAR_NOT.L#;
     1165    14228    3           CASE (%SEL_RR);
     1166    14229                    %INIT_STR (CODE=E_CHAR_RR, STR=VM_CHAR_RR, TEST=YES);
     1167    14252    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_RR.NAME#;
     1168    14253    3               CHARPOS = CHARPOS + VM_CHAR_RR.L#;
     1169    14254    3           CASE (%SEL_FROM);
     1170    14255                    %INIT_STR (CODE=E_CHAR_FROM, STR=VM_CHAR_FROM, TEST=YES);
     1171    14278    3               call insert(TEXTC.TEXT, CHARPOS,,substr(VM_CHAR_FROM.NAME#,,VM_CHAR_FROM
             14278                        .L#));
     1172    14279    3               CHARPOS = CHARPOS + VM_CHAR_FROM.L# ;
     1173    14280    3               GOTO CMPR_STR;
     1174    14281    3           CASE (%SEL_REFERENCE);
     1175    14282                    %INIT_STR (CODE=E_CHAR_REFERENCE, STR=VM_CHAR_REFERENCE, TEST=YES);
     1176    14305    3               call insert(TEXTC.TEXT,CHARPOS,,substr(VM_CHAR_REFERENCE.NAME#,,
             14305                        VM_CHAR_REFERENCE.L#));
     1177    14306    3               CHARPOS = CHARPOS + VM_CHAR_REFERENCE.L#;
     1178    14307    3               GOTO CMPR_STR;
     1179    14308    3           CASE (%SEL_REPLY_TO);
     1180    14309                    %INIT_STR (CODE=E_CHAR_REPLYTO, STR=VM_CHAR_REPLYTO, TEST=YES);
     1181    14332    3               call insert(TEXTC.TEXT,CHARPOS,, substr(VM_CHAR_REPLYTO.NAME#,,
             14332                        VM_CHAR_REPLYTO.L#));
     1182    14333    3               CHARPOS = CHARPOS + VM_CHAR_REPLYTO.L#;
     1183    14334    3               GOTO CMPR_STR;
     1184    14335    3           CASE (%SEL_SUBJECT);
     1185    14336                    %INIT_STR (CODE=E_CHAR_SUBJECT, STR=VM_CHAR_SUBJECT, TEST=YES);
     1186    14359    3               call insert(TEXTC.TEXT,CHARPOS,, substr(VM_CHAR_SUBJECT.NAME#,,
             14359                        VM_CHAR_SUBJECT.L#));
     1187    14360    3               CHARPOS = CHARPOS + VM_CHAR_SUBJECT.L#;
     1188    14361    3               GOTO CMPR_STR;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:167  
     1189    14362    3           CASE (%SEL_TO);
     1190    14363                    %INIT_STR (CODE=E_CHAR_TO, STR=VM_CHAR_TO, TEST=YES);
     1191    14386    3               call insert(TEXTC.TEXT, CHARPOS,, substr(VM_CHAR_TO.NAME#,,VM_CHAR_TO.L#
             14386                        ));
     1192    14387    3               CHARPOS = CHARPOS + VM_CHAR_TO.L#;
     1193    14388    3   CMPR_STR:   ;
     1194    14389    4               DO CASE (PTR1$ -> P$B.SUBLK$(0) -> P$B.CODE);
     1195    14390    4               CASE (%OPTION_EQ);
     1196    14391    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '=''');
     1197    14392    4                   CHARPOS = CHARPOS + LENGTHC('=''');
     1198    14393    4               CASE (%OPTION_NE);
     1199    14394    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '~=''');
     1200    14395    4                   CHARPOS = CHARPOS + LENGTHC('~=''');
     1201    14396    4               END;
     1202    14397    3               PTR2$ = PTR1$ -> P$B.SUBLK$(0)->P$B.SUBLK$(0);
     1203    14398    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,PTR2$ -> P$S.TEXT);
     1204    14399    3               CHARPOS = CHARPOS + PTR2$ -> P$S.COUNT;
     1205    14400    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,'''');
     1206    14401    3               CHARPOS = CHARPOS + LENGTHC('''');
     1207    14402    3           CASE (%SEL_DATE_SENT);
     1208    14403                    %INIT_STR (CODE=E_CHAR_SENT, STR=VM_CHAR_SENT, TEST=YES);
     1209    14426    3               call insert(TEXTC.TEXT, CHARPOS,, substr(VM_CHAR_SENT.NAME#,,
             14426                        VM_CHAR_SENT.L#));
     1210    14427    3               CHARPOS = CHARPOS + VM_CHAR_SENT.L#;
     1211    14428    3               GOTO CMPR_DATE;
     1212    14429    3           CASE (%SEL_DATE_RCVD);
     1213    14430                    %INIT_STR (CODE=E_CHAR_RCVD, STR=VM_CHAR_RCVD, TEST=YES);
     1214    14453    3               call insert(TEXTC.TEXT, CHARPOS,, substr(VM_CHAR_RCVD.NAME#,,
             14453                        VM_CHAR_RCVD.L#));
     1215    14454    3               CHARPOS = CHARPOS + VM_CHAR_RCVD.L#;
     1216    14455    3   CMPR_DATE:  ;
     1217    14456    4               DO CASE (PTR1$ -> P$B.SUBLK$(0) -> P$B.CODE);
     1218    14457    4               CASE (%OPTION_EQ);
     1219    14458    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '=');
     1220    14459    4                   CHARPOS = CHARPOS + LENGTHC('=');
     1221    14460    4               CASE (%OPTION_NE);
     1222    14461    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '~=');
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:168  
     1223    14462    4                   CHARPOS = CHARPOS + LENGTHC('~=');
     1224    14463    4               CASE (%OPTION_GT);
     1225    14464    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '>');
     1226    14465    4                   CHARPOS = CHARPOS + LENGTHC('>');
     1227    14466    4               CASE (%OPTION_GE);
     1228    14467    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '>=');
     1229    14468    4                   CHARPOS = CHARPOS + LENGTHC('>=');
     1230    14469    4               CASE (%OPTION_LT);
     1231    14470    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '<');
     1232    14471    4                   CHARPOS = CHARPOS + LENGTHC('<');
     1233    14472    4               CASE (%OPTION_LE);
     1234    14473    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '<=');
     1235    14474    4                   CHARPOS = CHARPOS + LENGTHC('<=');
     1236    14475    4               END;
     1237    14476    3               PTR2$ = PTR1$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0);
     1238    14477    3               END2 = PTR2$ -> P$B.NSUBLKS - 1;
     1239    14478    4               DO INDX2 = 0 TO END2;
     1240    14479    4                   PTR3$ = PTR2$ -> P$B.SUBLK$(INDX2);
     1241    14480    5                   DO CASE (PTR3$ -> P$B.CODE);
     1242    14481    5                   CASE (%OPTION_DATE);
     1243    14482    5                       DELIM = '/';
     1244    14483    5                   CASE (%OPTION_TIME);
     1245    14484    5                       DELIM = ':';
     1246    14485    5                   END;
     1247    14486    4                   END3 = PTR3$ -> P$B.NSUBLKS - 1;
     1248    14487    5                   DO INDX3 = 0 TO END3;
     1249    14488    5                       CALL INSERT(TEXTC.TEXT, CHARPOS,, PTR3$ -> P$B.SUBLK$(INDX3) ->
             14488                                P$S.TEXT);
     1250    14489    5                       CHARPOS = CHARPOS + PTR3$ -> P$B.SUBLK$(INDX3) -> P$S.COUNT;
     1251    14490    5                       IF INDX3 < END3
     1252    14491    6                       THEN DO;
     1253    14492    6                           CALL INSERT(TEXTC.TEXT, CHARPOS,, DELIM);
     1254    14493    6                           CHARPOS = CHARPOS + 1;
     1255    14494    6                       END;
     1256    14495    5                   END;
     1257    14496    4                   IF INDX2 < END2
     1258    14497    5                   THEN DO;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:169  
     1259    14498    5                       CALL INSERT(TEXTC.TEXT, CHARPOS,, ',');
     1260    14499    5                       CHARPOS = CHARPOS + 1;
     1261    14500    5                   END;
     1262    14501    4               END;
     1263    14502    3           END;                        /* Do case ... end */
     1264    14503    2           IF CHARPOS > 511
     1265    14504    2           THEN
     1266    14505    3           DO;
     1267    14506    3               CHARPOS = 511;
     1268    14507    3               RETURN;
     1269    14508    3           END;
     1270    14509    2       END;                            /* Do INDX1 = ... end */
     1271    14510    1       RETURN;
     1272    14511    1   END VMS$FMT_EXP;

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:170  
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMS$FMT_EXP.

   Procedure VMS$FMT_EXP requires 1186 words for executable code.
   Procedure VMS$FMT_EXP requires 20 words of local(AUTO) storage.

    No errors detected in file VMS$SELECT.:VMB6TSI    .

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:171  

 Object Unit name= VMS$FMT_EXP                                File name= VMS$SELECT.:VMB6TOU
 UTS= AUG 20 '97 15:25:53.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none   108    154  VMS$FMT_EXP
   12  RoData even  UTS     31     37  VMS$FMT_EXP
   13   Proc  even  none  1186   2242  VMS$FMT_EXP
   14  RoData even  none    62     76  VMS$FMT_EXP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        3  VMS$FMT_EXP
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:172  

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
   11      0  VM_CHAR_WHEN                      12      0  E_CHAR_WHEN
   11      4  VM_CHAR_BROADCAST                 12      1  E_CHAR_BROADCAST
   11     10  VM_CHAR_DELIVERY                  12      2  E_CHAR_DELIVERY
   11     14  VM_CHAR_DELETED                   12      3  E_CHAR_DELETED
   11     20  VM_CHAR_ERROR                     12      4  E_CHAR_ERROR
   11     24  VM_CHAR_FCOPY                     12      5  E_CHAR_FCOPY
   11     30  VM_CHAR_FROM                      12      6  E_CHAR_FROM
   11     34  VM_CHAR_MARKED                    12      7  E_CHAR_MARKED
   11     40  VM_CHAR_NEW                       12     10  E_CHAR_NEW
   11     44  VM_CHAR_OLD                       12     11  E_CHAR_OLD
   11     50  VM_CHAR_AND                       12     12  E_CHAR_AND
   11     54  VM_CHAR_OR                        12     13  E_CHAR_OR
   11     60  VM_CHAR_NOT                       12     14  E_CHAR_NOT
   11     64  VM_CHAR_REFERENCE                 12     15  E_CHAR_REFERENCE
   11     70  VM_CHAR_REPLYTO                   12     16  E_CHAR_REPLYTO
   11     74  VM_CHAR_SUBJECT                   12     17  E_CHAR_SUBJECT
   11    100  VM_CHAR_TO                        12     20  E_CHAR_TO
   11    104  VM_CHAR_FWD                       12     21  E_CHAR_FWD
   11    110  VM_CHAR_ANSWER                    12     22  E_CHAR_ANSWER
   11    114  VM_CHAR_ACKNOWLEDGMENT            12     23  E_CHAR_ACKNOWLEDGMENT
   11    120  VM_CHAR_NEXT                      12     24  E_CHAR_NEXT
   11    124  VM_CHAR_PREVIOUS                  12     25  E_CHAR_PREVIOUS
   11    130  VM_CHAR_UNEXAMINED                12     26  E_CHAR_UNEXAMINED
   11    134  VM_CHAR_EXAMINED                  12     27  E_CHAR_EXAMINED
   11    140  VM_CHAR_RR                        12     30  E_CHAR_RR
   11    144  VM_CHAR_SENT                      12     31  E_CHAR_SENT
   11    150  VM_CHAR_RCVD                      12     32  E_CHAR_RCVD
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:173  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 VMD$ERRMSG
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:174  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:175  


      874        1        /*T***********************************************************/
      875        2        /*T*                                                         */
      876        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      877        4        /*T*                                                         */
      878        5        /*T***********************************************************/
      879        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      880        7        /*********************************************************************/
      881        8        /*F*
      882        9             NAME: VMS$FMT_EXP
      883       10             PURPOSE:
      884       11                   To take a sub tree and create a text representation.
      885       12             DESCRIPTION:
      886       13                   This routine is called by VMS$FMT_SELECT and recursively
      887       14                   by itself. Not to be called by any other routines!!!
      888       15        */
      889       16        /*********************************************************************/
      890       17        VMS$FMT_EXP: PROC (TREE$,TEXTC,CHARPOS);

     17 13 000000   000000 700200 xent  VMS$FMT_EXP  TSX0  ! X66_AUTO_3
        13 000001   000024 000003                    ZERO    20,3

      891       18        /***** Include files *****/
      892       19          %INCLUDE CP_6;
      893     5578          %INCLUDE CP_6_SUBS;
      894     6118          %INCLUDE VM_MACRO_C;
      895     7386          %INCLUDE VM_SUBS_C;
      896     7646          %INCLUDE VM_DATA_R;
      897     8077          %INCLUDE VM_PERR_C;
      898     8372          %INCLUDE XU_MACRO_C;
      899    11478          %INCLUDE XU_SUBS_C;
      900    11570        /***** Parameters *****/
      901    11571    1   DCL TREE$ PTR;
      902    11572          %TEXTC (NAME=TEXTC,STCLASS=" ");
      903    11577    1   DCL CHARPOS SBIN WORD;
      904    11578        %INIT_STR (DODCL=YES);
      905    11601        /***** Local variables *****/
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:176  
      906    11602    1   DCL INDX1 SBIN WORD AUTO;
      907    11603    1   DCL INDX2 SBIN WORD AUTO;
      908    11604    1   DCL INDX3 SBIN WORD AUTO;
      909    11605    1   DCL PTR1$ PTR AUTO;
      910    11606    1   DCL PTR2$ PTR AUTO;
      911    11607    1   DCL PTR3$ PTR AUTO;
      912    11608    1   DCL DELIM CHAR(1) AUTO;
      913    11609    1   DCL END1 SBIN WORD AUTO;
      914    11610    1   DCL END2 SBIN WORD AUTO;
      915    11611    1   DCL END3 SBIN WORD AUTO;
      916    11612        /***** Based structures *****/
      917    11613          %PARSE$OUT (NAME=P$B,STCLASS=BASED);
      918    11658          %PARSE$SYM (NAME=P$S,STCLASS=BASED);
      919    11696        %VLP_NAME(FPTN=VM_CHAR_WHEN, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      920    11723        %VLP_ERRCODE (FPTN=E_CHAR_WHEN,        STCLASS="CONSTANT SYMDEF",
      921    11724                       ERR#=%E$CHAR_WHEN,      FCG=VM,MID=S);
      922    11769        /*E*  ERROR:VMS-E$CHAR_WHEN-0
      923    11770              MESSAGE: when&
      924    11771        */
      925    11772              %VLP_NAME (FPTN=VM_CHAR_BROADCAST, LEN=15, L=15, NAME=' ', STCLASS=
             11772                  "STATIC SYMDEF");
      926    11799        %VLP_ERRCODE (FPTN=E_CHAR_BROADCAST,   STCLASS="CONSTANT SYMDEF",
      927    11800                       ERR#=%E$CHAR_BROADCAST,           FCG=VM,MID=S);
      928    11845        /*E*  ERROR:VMS-E$CHAR_BROADCAST-0
      929    11846              MESSAGE:Broadcast
      930    11847        */
      931    11848              %VLP_NAME (FPTN=VM_CHAR_DELIVERY, LEN=15, L=15, NAME=' ', STCLASS=
             11848                  "STATIC SYMDEF");
      932    11875        %VLP_ERRCODE (FPTN=E_CHAR_DELIVERY,    STCLASS="CONSTANT SYMDEF",
      933    11876                       ERR#=%E$CHAR_DELIVERY,            FCG=VM,MID=S);
      934    11921        /*E*  ERROR:VMS-E$CHAR_DELIVERY-0
      935    11922              MESSAGE:Delivery
      936    11923        */
      937    11924              %VLP_NAME (FPTN=VM_CHAR_DELETED, LEN=15, L=15, NAME=' ', STCLASS=
             11924                  "STATIC SYMDEF");
      938    11951        %VLP_ERRCODE (FPTN=E_CHAR_DELETED,     STCLASS="CONSTANT SYMDEF",
      939    11952                       ERR#=%E$CHAR_DELETED,             FCG=VM,MID=S);
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:177  
      940    11997        /*E*  ERROR:VMS-E$CHAR_DELETED-0
      941    11998              MESSAGE:Deleted
      942    11999        */
      943    12000             %VLP_NAME (FPTN=VM_CHAR_ERROR, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF"
             12000                  );
      944    12027        %VLP_ERRCODE (FPTN=E_CHAR_ERROR,       STCLASS="CONSTANT SYMDEF",
      945    12028                       ERR#=%E$CHAR_ERROR,               FCG=VM,MID=S);
      946    12073        /*E*  ERROR:VMS-E$CHAR_ERROR-0
      947    12074              MESSAGE:Error
      948    12075        */
      949    12076             %VLP_NAME (FPTN=VM_CHAR_FCOPY, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF"
             12076                  );
      950    12103        %VLP_ERRCODE (FPTN=E_CHAR_FCOPY,       STCLASS="CONSTANT SYMDEF",
      951    12104                       ERR#=%E$CHAR_FCOPY,               FCG=VM,MID=S);
      952    12149        /*E*  ERROR:VMS-E$CHAR_FCOPY-0
      953    12150              MESSAGE:FCopy
      954    12151        */
      955    12152             %VLP_NAME (FPTN=VM_CHAR_FROM, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             12152                  ;
      956    12179        %VLP_ERRCODE (FPTN=E_CHAR_FROM,        STCLASS="CONSTANT SYMDEF",
      957    12180                       ERR#=%E$CHAR_FROM,                FCG=VM,MID=S);
      958    12225        /*E*  ERROR:VMS-E$CHAR_FROM-0
      959    12226              MESSAGE:From
      960    12227        */
      961    12228              %VLP_NAME (FPTN=VM_CHAR_MARKED, LEN=15, L=15, NAME=' ', STCLASS=
             12228                  "STATIC SYMDEF");
      962    12255        %VLP_ERRCODE (FPTN=E_CHAR_MARKED,      STCLASS="CONSTANT SYMDEF",
      963    12256                       ERR#=%E$CHAR_MARKED,              FCG=VM,MID=S);
      964    12301        /*E*  ERROR:VMS-E$CHAR_MARKED-0
      965    12302              MESSAGE:Marked
      966    12303        */
      967    12304             %VLP_NAME (FPTN=VM_CHAR_NEW, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      968    12331        %VLP_ERRCODE (FPTN=E_CHAR_NEW,         STCLASS="CONSTANT SYMDEF",
      969    12332                       ERR#=%E$CHAR_NEW,                 FCG=VM,MID=S);
      970    12377        /*E*  ERROR:VMS-E$CHAR_NEW-0
      971    12378              MESSAGE:New
      972    12379        */
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:178  
      973    12380             %VLP_NAME (FPTN=VM_CHAR_OLD, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      974    12407        %VLP_ERRCODE (FPTN=E_CHAR_OLD,         STCLASS="CONSTANT SYMDEF",
      975    12408                       ERR#=%E$CHAR_OLD,                 FCG=VM,MID=S);
      976    12453        /*E*  ERROR:VMS-E$CHAR_OLD-0
      977    12454              MESSAGE:Old&
      978    12455        */
      979    12456             %VLP_NAME (FPTN=VM_CHAR_AND, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      980    12483        %VLP_ERRCODE (FPTN=E_CHAR_AND,         STCLASS="CONSTANT SYMDEF",
      981    12484                       ERR#=%E$CHAR_AND,                 FCG=VM,MID=S);
      982    12529        /*E*  ERROR:VMS-E$CHAR_AND-0
      983    12530              MESSAGE:&and&
      984    12531        */
      985    12532              %VLP_NAME (FPTN=VM_CHAR_OR, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      986    12559        %VLP_ERRCODE (FPTN=E_CHAR_OR,          STCLASS="CONSTANT SYMDEF",
      987    12560                       ERR#=%E$CHAR_OR,                  FCG=VM,MID=S);
      988    12605        /*E*  ERROR:VMS-E$CHAR_OR-0
      989    12606              MESSAGE:&or&
      990    12607        */
      991    12608             %VLP_NAME (FPTN=VM_CHAR_NOT, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
      992    12635        %VLP_ERRCODE (FPTN=E_CHAR_NOT,         STCLASS="CONSTANT SYMDEF",
      993    12636                       ERR#=%E$CHAR_NOT,                 FCG=VM,MID=S);
      994    12681        /*E*  ERROR:VMS-E$CHAR_NOT-0
      995    12682              MESSAGE:&not&
      996    12683        */
      997    12684              %VLP_NAME (FPTN=VM_CHAR_REFERENCE, LEN=15, L=15, NAME=' ', STCLASS=
             12684                  "STATIC SYMDEF");
      998    12711        %VLP_ERRCODE (FPTN=E_CHAR_REFERENCE,         STCLASS="CONSTANT SYMDEF",
      999    12712                       ERR#=%E$CHAR_REFERENCE,                 FCG=VM,MID=S);
     1000    12757        /*E*  ERROR:VMS-E$CHAR_REFERENCE-0
     1001    12758              MESSAGE:Reference
     1002    12759        */
     1003    12760              %VLP_NAME (FPTN=VM_CHAR_REPLYTO, LEN=15, L=15, NAME=' ', STCLASS=
             12760                  "STATIC SYMDEF");
     1004    12787        %VLP_ERRCODE (FPTN=E_CHAR_REPLYTO,         STCLASS="CONSTANT SYMDEF",
     1005    12788                       ERR#=%E$CHAR_REPLYTO,                 FCG=VM,MID=S);
     1006    12833        /*E*  ERROR:VMS-E$CHAR_REPLYTO-0
     1007    12834              MESSAGE:Reply To
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:179  
     1008    12835        */
     1009    12836              %VLP_NAME (FPTN=VM_CHAR_SUBJECT, LEN=15, L=15, NAME=' ', STCLASS=
             12836                  "STATIC SYMDEF");
     1010    12863        %VLP_ERRCODE (FPTN=E_CHAR_SUBJECT,         STCLASS="CONSTANT SYMDEF",
     1011    12864                       ERR#=%E$CHAR_SUBJECT,                 FCG=VM,MID=S);
     1012    12909        /*E*  ERROR:VMS-E$CHAR_SUBJECT-0
     1013    12910              MESSAGE:Subject
     1014    12911        */
     1015    12912              %VLP_NAME (FPTN=VM_CHAR_TO, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
     1016    12939        %VLP_ERRCODE (FPTN=E_CHAR_TO,         STCLASS="CONSTANT SYMDEF",
     1017    12940                       ERR#=%E$CHAR_TO,                 FCG=VM,MID=S);
     1018    12985        /*E*  ERROR:VMS-E$CHAR_TO-0
     1019    12986              MESSAGE:To
     1020    12987        */
     1021    12988             %VLP_NAME (FPTN=VM_CHAR_FWD, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
     1022    13015        %VLP_ERRCODE (FPTN=E_CHAR_FWD,         STCLASS="CONSTANT SYMDEF",
     1023    13016                       ERR#=%E$CHAR_FWD,                 FCG=VM,MID=S);
     1024    13061        /*E*  ERROR:VMS-E$CHAR_FWD-0
     1025    13062              MESSAGE:Fwd
     1026    13063        */
     1027    13064              %VLP_NAME (FPTN=VM_CHAR_ANSWER, LEN=15, L=15, NAME=' ', STCLASS=
             13064                  "STATIC SYMDEF");
     1028    13091        %VLP_ERRCODE (FPTN=E_CHAR_ANSWER,         STCLASS="CONSTANT SYMDEF",
     1029    13092                       ERR#=%E$CHAR_ANSWER,                 FCG=VM,MID=S);
     1030    13137        /*E*  ERROR:VMS-E$CHAR_ANSWER-0
     1031    13138              MESSAGE:Answer
     1032    13139        */
     1033    13140              %VLP_NAME (FPTN=VM_CHAR_ACKNOWLEDGMENT, LEN=15, L=15, NAME=' ', STCLASS=
             13140                  "STATIC SYMDEF");
     1034    13167        %VLP_ERRCODE (FPTN=E_CHAR_ACKNOWLEDGMENT,         STCLASS="CONSTANT SYMDEF",
     1035    13168                       ERR#=%E$CHAR_ACKNOWLEDGMENT,                 FCG=VM,MID=S);
     1036    13213        /*E*  ERROR:VMS-E$CHAR_ACKNOWLEDGMENT-0
     1037    13214              MESSAGE:Acknowledgement
     1038    13215        */
     1039    13216             %VLP_NAME (FPTN=VM_CHAR_NEXT, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             13216                  ;
     1040    13243        %VLP_ERRCODE (FPTN=E_CHAR_NEXT,         STCLASS="CONSTANT SYMDEF",
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:180  
     1041    13244                       ERR#=%E$CHAR_NEXT,                 FCG=VM,MID=S);
     1042    13289        /*E*  ERROR:VMS-E$CHAR_NEXT-0
     1043    13290              MESSAGE:Next
     1044    13291        */
     1045    13292              %VLP_NAME (FPTN=VM_CHAR_PREVIOUS, LEN=15, L=15, NAME=' ', STCLASS=
             13292                  "STATIC SYMDEF");
     1046    13319        %VLP_ERRCODE (FPTN=E_CHAR_PREVIOUS,         STCLASS="CONSTANT SYMDEF",
     1047    13320                       ERR#=%E$CHAR_PREVIOUS,                 FCG=VM,MID=S);
     1048    13365        /*E*  ERROR:VMS-E$CHAR_PREVIOUS-0
     1049    13366              MESSAGE:Previous
     1050    13367        */
     1051    13368              %VLP_NAME (FPTN=VM_CHAR_UNEXAMINED, LEN=15, L=15, NAME=' ', STCLASS=
             13368                  "STATIC SYMDEF");
     1052    13395        %VLP_ERRCODE (FPTN=E_CHAR_UNEXAMINED,         STCLASS="CONSTANT SYMDEF",
     1053    13396                       ERR#=%E$CHAR_UNEXAMINED,                 FCG=VM,MID=S);
     1054    13441        /*E*  ERROR:VMS-E$CHAR_UNEXAMINED-0
     1055    13442              MESSAGE:Unexamined
     1056    13443        */
     1057    13444              %VLP_NAME (FPTN=VM_CHAR_EXAMINED, LEN=15, L=15, NAME=' ', STCLASS=
             13444                  "STATIC SYMDEF");
     1058    13471        %VLP_ERRCODE (FPTN=E_CHAR_EXAMINED,         STCLASS="CONSTANT SYMDEF",
     1059    13472                       ERR#=%E$CHAR_EXAMINED,                 FCG=VM,MID=S);
     1060    13517        /*E*  ERROR:VMS-E$CHAR_EXAMINED-0
     1061    13518              MESSAGE:Examined
     1062    13519        */
     1063    13520              %VLP_NAME (FPTN=VM_CHAR_RR, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF");
     1064    13547        %VLP_ERRCODE (FPTN=E_CHAR_RR,         STCLASS="CONSTANT SYMDEF",
     1065    13548                       ERR#=%E$CHAR_RR,                 FCG=VM,MID=S);
     1066    13593        /*E*  ERROR:VMS-E$CHAR_RR-0
     1067    13594              MESSAGE:RR
     1068    13595        */
     1069    13596             %VLP_NAME (FPTN=VM_CHAR_SENT, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             13596                  ;
     1070    13623        %VLP_ERRCODE (FPTN=E_CHAR_SENT,         STCLASS="CONSTANT SYMDEF",
     1071    13624                       ERR#=%E$CHAR_SENT,                 FCG=VM,MID=S);
     1072    13669        /*E*  ERROR:VMS-E$CHAR_SENT-0
     1073    13670              MESSAGE:Date Sent
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:181  
     1074    13671        */
     1075    13672             %VLP_NAME (FPTN=VM_CHAR_RCVD, LEN=15, L=15, NAME=' ', STCLASS="STATIC SYMDEF")
             13672                  ;
     1076    13699        %VLP_ERRCODE (FPTN=E_CHAR_RCVD,         STCLASS="CONSTANT SYMDEF",
     1077    13700                       ERR#=%E$CHAR_RCVD,                 FCG=VM,MID=S);
     1078    13745        /*E*  ERROR:VMS-E$CHAR_RCVD-0
     1079    13746              MESSAGE:Date Rcvd
     1080    13747        */
     1081    13748        %EJECT;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:182  
     1082    13749    1         END1 = TREE$ -> P$B.NSUBLKS - 1;

  13749 13 000002   200003 470500                    LDP0    @TREE$,,AUTO
        13 000003   000000 471500                    LDP1    0,,PR0
        13 000004   100001 236100                    LDQ     1,,PR1
        13 000005   000022 772000                    QRL     18
        13 000006   000001 136007                    SBLQ    1,DL
        13 000007   200015 756100                    STQ     END1,,AUTO

     1083    13750    2       DO INDX1 = 0 TO END1;

  13750 13 000010   200006 450100                    STZ     INDX1,,AUTO
        13 000011   002236 710000 13                 TRA     s:14509+1

     1084    13751    2           PTR1$ = TREE$ -> P$B.SUBLK$(INDX1);

  13751 13 000012   200003 470500                    LDP0    @TREE$,,AUTO
        13 000013   000000 471500                    LDP1    0,,PR0
        13 000014   200006 720100                    LXL0    INDX1,,AUTO
        13 000015   100003 236110                    LDQ     3,X0,PR1
        13 000016   200011 756100                    STQ     PTR1$,,AUTO

     1085    13752    3           DO CASE (PTR1$ -> P$B.CODE);

  13752 13 000017   200011 471500                    LDP1    PTR1$,,AUTO
        13 000020   100000 721100                    LXL1    0,,PR1
        13 000021   000164 101003                    CMPX1   116,DU
        13 000022   000024 602011 13                 TNC     s:13752+5,X1
        13 000023   002226 710000 13                 TRA     s:14503
        13 000024   002226 710000 13                 TRA     s:14503
        13 000025   002226 710000 13                 TRA     s:14503
        13 000026   001174 710000 13                 TRA     s:14210
        13 000027   001106 710000 13                 TRA     s:14158
        13 000030   001141 710000 13                 TRA     s:14184
        13 000031   002226 710000 13                 TRA     s:14503
        13 000032   002226 710000 13                 TRA     s:14503
        13 000033   002226 710000 13                 TRA     s:14503
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:183  
        13 000034   002226 710000 13                 TRA     s:14503
        13 000035   002226 710000 13                 TRA     s:14503
        13 000036   002226 710000 13                 TRA     s:14503
        13 000037   000261 710000 13                 TRA     s:13768
        13 000040   000314 710000 13                 TRA     s:13794
        13 000041   000556 710000 13                 TRA     s:13950
        13 000042   000402 710000 13                 TRA     s:13846
        13 000043   000470 710000 13                 TRA     s:13898
        13 000044   000523 710000 13                 TRA     s:13924
        13 000045   001262 710000 13                 TRA     s:14262
        13 000046   000644 710000 13                 TRA     s:14002
        13 000047   000677 710000 13                 TRA     s:14028
        13 000050   001020 710000 13                 TRA     s:14106
        13 000051   001320 710000 13                 TRA     s:14289
        13 000052   001414 710000 13                 TRA     s:14343
        13 000053   001053 710000 13                 TRA     s:14132
        13 000054   000611 710000 13                 TRA     s:13976
        13 000055   001227 710000 13                 TRA     s:14236
        13 000056   001452 710000 13                 TRA     s:14370
        13 000057   001356 710000 13                 TRA     s:14316
        13 000060   000435 710000 13                 TRA     s:13872
        13 000061   000347 710000 13                 TRA     s:13820
        13 000062   000210 710000 13                 TRA     s:13754
        13 000063   002226 710000 13                 TRA     s:14503
        13 000064   002226 710000 13                 TRA     s:14503
        13 000065   001623 710000 13                 TRA     s:14410
        13 000066   001661 710000 13                 TRA     s:14437
        13 000067   002226 710000 13                 TRA     s:14503
        13 000070   002226 710000 13                 TRA     s:14503
        13 000071   002226 710000 13                 TRA     s:14503
        13 000072   002226 710000 13                 TRA     s:14503
        13 000073   002226 710000 13                 TRA     s:14503
        13 000074   002226 710000 13                 TRA     s:14503
        13 000075   002226 710000 13                 TRA     s:14503
        13 000076   002226 710000 13                 TRA     s:14503
        13 000077   002226 710000 13                 TRA     s:14503
        13 000100   002226 710000 13                 TRA     s:14503
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:184  
        13 000101   002226 710000 13                 TRA     s:14503
        13 000102   002226 710000 13                 TRA     s:14503
        13 000103   002226 710000 13                 TRA     s:14503
        13 000104   002226 710000 13                 TRA     s:14503
        13 000105   002226 710000 13                 TRA     s:14503
        13 000106   002226 710000 13                 TRA     s:14503
        13 000107   002226 710000 13                 TRA     s:14503
        13 000110   002226 710000 13                 TRA     s:14503
        13 000111   002226 710000 13                 TRA     s:14503
        13 000112   002226 710000 13                 TRA     s:14503
        13 000113   002226 710000 13                 TRA     s:14503
        13 000114   002226 710000 13                 TRA     s:14503
        13 000115   002226 710000 13                 TRA     s:14503
        13 000116   002226 710000 13                 TRA     s:14503
        13 000117   002226 710000 13                 TRA     s:14503
        13 000120   002226 710000 13                 TRA     s:14503
        13 000121   002226 710000 13                 TRA     s:14503
        13 000122   002226 710000 13                 TRA     s:14503
        13 000123   002226 710000 13                 TRA     s:14503
        13 000124   002226 710000 13                 TRA     s:14503
        13 000125   002226 710000 13                 TRA     s:14503
        13 000126   002226 710000 13                 TRA     s:14503
        13 000127   002226 710000 13                 TRA     s:14503
        13 000130   002226 710000 13                 TRA     s:14503
        13 000131   002226 710000 13                 TRA     s:14503
        13 000132   002226 710000 13                 TRA     s:14503
        13 000133   002226 710000 13                 TRA     s:14503
        13 000134   002226 710000 13                 TRA     s:14503
        13 000135   002226 710000 13                 TRA     s:14503
        13 000136   002226 710000 13                 TRA     s:14503
        13 000137   002226 710000 13                 TRA     s:14503
        13 000140   002226 710000 13                 TRA     s:14503
        13 000141   002226 710000 13                 TRA     s:14503
        13 000142   002226 710000 13                 TRA     s:14503
        13 000143   002226 710000 13                 TRA     s:14503
        13 000144   002226 710000 13                 TRA     s:14503
        13 000145   002226 710000 13                 TRA     s:14503
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:185  
        13 000146   002226 710000 13                 TRA     s:14503
        13 000147   002226 710000 13                 TRA     s:14503
        13 000150   002226 710000 13                 TRA     s:14503
        13 000151   002226 710000 13                 TRA     s:14503
        13 000152   002226 710000 13                 TRA     s:14503
        13 000153   002226 710000 13                 TRA     s:14503
        13 000154   002226 710000 13                 TRA     s:14503
        13 000155   002226 710000 13                 TRA     s:14503
        13 000156   002226 710000 13                 TRA     s:14503
        13 000157   002226 710000 13                 TRA     s:14503
        13 000160   002226 710000 13                 TRA     s:14503
        13 000161   002226 710000 13                 TRA     s:14503
        13 000162   002226 710000 13                 TRA     s:14503
        13 000163   002226 710000 13                 TRA     s:14503
        13 000164   002226 710000 13                 TRA     s:14503
        13 000165   002226 710000 13                 TRA     s:14503
        13 000166   002226 710000 13                 TRA     s:14503
        13 000167   002226 710000 13                 TRA     s:14503
        13 000170   002226 710000 13                 TRA     s:14503
        13 000171   002226 710000 13                 TRA     s:14503
        13 000172   002226 710000 13                 TRA     s:14503
        13 000173   002226 710000 13                 TRA     s:14503
        13 000174   002226 710000 13                 TRA     s:14503
        13 000175   002226 710000 13                 TRA     s:14503
        13 000176   002226 710000 13                 TRA     s:14503
        13 000177   002226 710000 13                 TRA     s:14503
        13 000200   002226 710000 13                 TRA     s:14503
        13 000201   002226 710000 13                 TRA     s:14503
        13 000202   002226 710000 13                 TRA     s:14503
        13 000203   002226 710000 13                 TRA     s:14503
        13 000204   002226 710000 13                 TRA     s:14503
        13 000205   002226 710000 13                 TRA     s:14503
        13 000206   000732 710000 13                 TRA     s:14054
        13 000207   000765 710000 13                 TRA     s:14080

     1086    13753    3           CASE (%SEL_EXP);

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:186  
     1087    13754    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,'(');

  13754 13 000210   200004 473500                    LDP3    @TEXTC,,AUTO
        13 000211   000100 101500                    MRL     fill='000'O
        13 000212   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 000213   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000214   200020 221100                    LDX1    END3+1,,AUTO
        13 000215   200005 474500                    LDP4    @CHARPOS,,AUTO
        13 000216   000000 636011                    EAQ     0,X1
        13 000217   000022 772000                    QRL     18
        13 000220   400000 136100                    SBLQ    0,,PR4
        13 000221   400000 235100                    LDA     0,,PR4
        13 000222   000000 622006                    EAX2    0,QL
        13 000223   040145 100400                    MLR     fill='040'O
        13 000224   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000225   300000 200012                    ADSC9   0,A,PR3                  cn=1,n=*X2

     1088    13755    3               CHARPOS = CHARPOS + 1;

  13755 13 000226   400000 054100                    AOS     0,,PR4

     1089    13756    3               CALL VMS$FMT_EXP (PTR1$,TEXTC,CHARPOS);

  13756 13 000227   200005 236100                    LDQ     @CHARPOS,,AUTO
        13 000230   200022 756100                    STQ     END3+3,,AUTO
        13 000231   200004 236100                    LDQ     @TEXTC,,AUTO
        13 000232   200021 756100                    STQ     END3+2,,AUTO
        13 000233   200011 631500                    EPPR1   PTR1$,,AUTO
        13 000234   200020 451500                    STP1    END3+1,,AUTO
        13 000235   200020 630500                    EPPR0   END3+1,,AUTO
        13 000236   000001 631400 14                 EPPR1   1
        13 000237   000000 701000 13                 TSX1    s:17
        13 000240   000000 011000                    NOP     0

     1090    13757    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,')');

  13757 13 000241   200004 470500                    LDP0    @TEXTC,,AUTO
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:187  
        13 000242   000100 101500                    MRL     fill='000'O
        13 000243   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000244   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000245   200020 220100                    LDX0    END3+1,,AUTO
        13 000246   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000247   000000 636010                    EAQ     0,X0
        13 000250   000022 772000                    QRL     18
        13 000251   100000 136100                    SBLQ    0,,PR1
        13 000252   100000 235100                    LDA     0,,PR1
        13 000253   000000 621006                    EAX1    0,QL
        13 000254   040145 100400                    MLR     fill='040'O
        13 000255   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000256   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1091    13758    3               CHARPOS = CHARPOS + 1;

  13758 13 000257   100000 054100                    AOS     0,,PR1
        13 000260   002226 710000 13                 TRA     s:14503

     1092    13759    3           CASE (%SEL_ACKNOWLEDGMENT);

     1093    13760                    %INIT_STR (CODE=E_CHAR_ACKNOWLEDGMENT, TEST=YES,
     1094    13761                    STR=VM_CHAR_ACKNOWLEDGMENT);

  13768 13 000261   040000 106400                    CMPC    fill='040'O
        13 000262   000114 200017 11                 ADSC9   VM_CHAR_ACKNOWLEDGMENT   cn=1,n=15
        13 000263   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000264   000271 601000 13                 TNZ     s:13784

  13770 13 000265   000005 630400 14                 EPPR0   5
        13 000266   000004 631400 14                 EPPR1   4
        13 000267   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000270   000000 011000                    NOP     0

     1095    13784    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_ACKNOWLEDGMENT.NAME#;

  13784 13 000271   200004 470500                    LDP0    @TEXTC,,AUTO
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:188  
        13 000272   000100 101500                    MRL     fill='000'O
        13 000273   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000274   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000275   200020 220100                    LDX0    END3+1,,AUTO
        13 000276   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000277   000000 636010                    EAQ     0,X0
        13 000300   000022 772000                    QRL     18
        13 000301   100000 136100                    SBLQ    0,,PR1
        13 000302   100000 235100                    LDA     0,,PR1
        13 000303   000000 621006                    EAX1    0,QL
        13 000304   040145 100400                    MLR     fill='040'O
        13 000305   000114 200017 11                 ADSC9   VM_CHAR_ACKNOWLEDGMENT   cn=1,n=15
        13 000306   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1096    13785    3               CHARPOS = CHARPOS + VM_CHAR_ACKNOWLEDGMENT.L#;

  13785 13 000307   000114 236000 11                 LDQ     VM_CHAR_ACKNOWLEDGMENT
        13 000310   000033 772000                    QRL     27
        13 000311   100000 036100                    ADLQ    0,,PR1
        13 000312   100000 756100                    STQ     0,,PR1
        13 000313   002226 710000 13                 TRA     s:14503

     1097    13786    3           CASE (%SEL_ANSWER);

     1098    13787                    %INIT_STR (CODE=E_CHAR_ANSWER, STR=VM_CHAR_ANSWER, TEST=YES);

  13794 13 000314   040000 106400                    CMPC    fill='040'O
        13 000315   000110 200017 11                 ADSC9   VM_CHAR_ANSWER           cn=1,n=15
        13 000316   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000317   000324 601000 13                 TNZ     s:13810

  13796 13 000320   000007 630400 14                 EPPR0   7
        13 000321   000004 631400 14                 EPPR1   4
        13 000322   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000323   000000 011000                    NOP     0

     1099    13810    3               substr(TEXTC.TEXT,CHARPOS)=VM_CHAR_ANSWER.NAME#;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:189  

  13810 13 000324   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000325   000100 101500                    MRL     fill='000'O
        13 000326   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000327   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000330   200020 220100                    LDX0    END3+1,,AUTO
        13 000331   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000332   000000 636010                    EAQ     0,X0
        13 000333   000022 772000                    QRL     18
        13 000334   100000 136100                    SBLQ    0,,PR1
        13 000335   100000 235100                    LDA     0,,PR1
        13 000336   000000 621006                    EAX1    0,QL
        13 000337   040145 100400                    MLR     fill='040'O
        13 000340   000110 200017 11                 ADSC9   VM_CHAR_ANSWER           cn=1,n=15
        13 000341   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1100    13811    3               CHARPOS = CHARPOS + VM_CHAR_ANSWER.L#;

  13811 13 000342   000110 236000 11                 LDQ     VM_CHAR_ANSWER
        13 000343   000033 772000                    QRL     27
        13 000344   100000 036100                    ADLQ    0,,PR1
        13 000345   100000 756100                    STQ     0,,PR1
        13 000346   002226 710000 13                 TRA     s:14503

     1101    13812    3           CASE (%SEL_BROADCAST);

     1102    13813                    %INIT_STR (CODE=E_CHAR_BROADCAST, STR=VM_CHAR_BROADCAST, TEST=YES);

  13820 13 000347   040000 106400                    CMPC    fill='040'O
        13 000350   000004 200017 11                 ADSC9   VM_CHAR_BROADCAST        cn=1,n=15
        13 000351   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000352   000357 601000 13                 TNZ     s:13836

  13822 13 000353   000011 630400 14                 EPPR0   9
        13 000354   000004 631400 14                 EPPR1   4
        13 000355   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000356   000000 011000                    NOP     0
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:190  

     1103    13836    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_BROADCAST.NAME#;

  13836 13 000357   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000360   000100 101500                    MRL     fill='000'O
        13 000361   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000362   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000363   200020 220100                    LDX0    END3+1,,AUTO
        13 000364   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000365   000000 636010                    EAQ     0,X0
        13 000366   000022 772000                    QRL     18
        13 000367   100000 136100                    SBLQ    0,,PR1
        13 000370   100000 235100                    LDA     0,,PR1
        13 000371   000000 621006                    EAX1    0,QL
        13 000372   040145 100400                    MLR     fill='040'O
        13 000373   000004 200017 11                 ADSC9   VM_CHAR_BROADCAST        cn=1,n=15
        13 000374   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1104    13837    3               CHARPOS = CHARPOS + VM_CHAR_BROADCAST.L#;

  13837 13 000375   000004 236000 11                 LDQ     VM_CHAR_BROADCAST
        13 000376   000033 772000                    QRL     27
        13 000377   100000 036100                    ADLQ    0,,PR1
        13 000400   100000 756100                    STQ     0,,PR1
        13 000401   002226 710000 13                 TRA     s:14503

     1105    13838    3           CASE (%SEL_DELETED);

     1106    13839                    %INIT_STR (CODE=E_CHAR_DELETED, STR=VM_CHAR_DELETED, TEST=YES);

  13846 13 000402   040000 106400                    CMPC    fill='040'O
        13 000403   000014 200017 11                 ADSC9   VM_CHAR_DELETED          cn=1,n=15
        13 000404   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000405   000412 601000 13                 TNZ     s:13862

  13848 13 000406   000013 630400 14                 EPPR0   11
        13 000407   000004 631400 14                 EPPR1   4
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:191  
        13 000410   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000411   000000 011000                    NOP     0

     1107    13862    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_DELETED.NAME#;

  13862 13 000412   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000413   000100 101500                    MRL     fill='000'O
        13 000414   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000415   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000416   200020 220100                    LDX0    END3+1,,AUTO
        13 000417   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000420   000000 636010                    EAQ     0,X0
        13 000421   000022 772000                    QRL     18
        13 000422   100000 136100                    SBLQ    0,,PR1
        13 000423   100000 235100                    LDA     0,,PR1
        13 000424   000000 621006                    EAX1    0,QL
        13 000425   040145 100400                    MLR     fill='040'O
        13 000426   000014 200017 11                 ADSC9   VM_CHAR_DELETED          cn=1,n=15
        13 000427   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1108    13863    3               CHARPOS = CHARPOS + VM_CHAR_DELETED.L#;

  13863 13 000430   000014 236000 11                 LDQ     VM_CHAR_DELETED
        13 000431   000033 772000                    QRL     27
        13 000432   100000 036100                    ADLQ    0,,PR1
        13 000433   100000 756100                    STQ     0,,PR1
        13 000434   002226 710000 13                 TRA     s:14503

     1109    13864    3           CASE (%SEL_DELIVERY);

     1110    13865                    %INIT_STR (CODE=E_CHAR_DELIVERY, STR=VM_CHAR_DELIVERY, TEST=YES);

  13872 13 000435   040000 106400                    CMPC    fill='040'O
        13 000436   000010 200017 11                 ADSC9   VM_CHAR_DELIVERY         cn=1,n=15
        13 000437   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000440   000445 601000 13                 TNZ     s:13888

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:192  
  13874 13 000441   000015 630400 14                 EPPR0   13
        13 000442   000004 631400 14                 EPPR1   4
        13 000443   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000444   000000 011000                    NOP     0

     1111    13888    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_DELIVERY.NAME#;

  13888 13 000445   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000446   000100 101500                    MRL     fill='000'O
        13 000447   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000450   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000451   200020 220100                    LDX0    END3+1,,AUTO
        13 000452   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000453   000000 636010                    EAQ     0,X0
        13 000454   000022 772000                    QRL     18
        13 000455   100000 136100                    SBLQ    0,,PR1
        13 000456   100000 235100                    LDA     0,,PR1
        13 000457   000000 621006                    EAX1    0,QL
        13 000460   040145 100400                    MLR     fill='040'O
        13 000461   000010 200017 11                 ADSC9   VM_CHAR_DELIVERY         cn=1,n=15
        13 000462   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1112    13889    3               CHARPOS = CHARPOS + VM_CHAR_DELIVERY.L#;

  13889 13 000463   000010 236000 11                 LDQ     VM_CHAR_DELIVERY
        13 000464   000033 772000                    QRL     27
        13 000465   100000 036100                    ADLQ    0,,PR1
        13 000466   100000 756100                    STQ     0,,PR1
        13 000467   002226 710000 13                 TRA     s:14503

     1113    13890    3           CASE (%SEL_ERROR);

     1114    13891                    %INIT_STR (CODE=E_CHAR_ERROR, STR=VM_CHAR_ERROR, TEST=YES);

  13898 13 000470   040000 106400                    CMPC    fill='040'O
        13 000471   000020 200017 11                 ADSC9   VM_CHAR_ERROR            cn=1,n=15
        13 000472   000003 000001 14                 ADSC9   3                        cn=0,n=1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:193  
        13 000473   000500 601000 13                 TNZ     s:13914

  13900 13 000474   000017 630400 14                 EPPR0   15
        13 000475   000004 631400 14                 EPPR1   4
        13 000476   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000477   000000 011000                    NOP     0

     1115    13914    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_ERROR.NAME#;

  13914 13 000500   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000501   000100 101500                    MRL     fill='000'O
        13 000502   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000503   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000504   200020 220100                    LDX0    END3+1,,AUTO
        13 000505   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000506   000000 636010                    EAQ     0,X0
        13 000507   000022 772000                    QRL     18
        13 000510   100000 136100                    SBLQ    0,,PR1
        13 000511   100000 235100                    LDA     0,,PR1
        13 000512   000000 621006                    EAX1    0,QL
        13 000513   040145 100400                    MLR     fill='040'O
        13 000514   000020 200017 11                 ADSC9   VM_CHAR_ERROR            cn=1,n=15
        13 000515   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1116    13915    3               CHARPOS = CHARPOS + VM_CHAR_ERROR.L#;

  13915 13 000516   000020 236000 11                 LDQ     VM_CHAR_ERROR
        13 000517   000033 772000                    QRL     27
        13 000520   100000 036100                    ADLQ    0,,PR1
        13 000521   100000 756100                    STQ     0,,PR1
        13 000522   002226 710000 13                 TRA     s:14503

     1117    13916    3           CASE (%SEL_EXAMINED);

     1118    13917                    %INIT_STR (CODE=E_CHAR_EXAMINED, STR=VM_CHAR_EXAMINED, TEST=YES);

  13924 13 000523   040000 106400                    CMPC    fill='040'O
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:194  
        13 000524   000134 200017 11                 ADSC9   VM_CHAR_EXAMINED         cn=1,n=15
        13 000525   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000526   000533 601000 13                 TNZ     s:13940

  13926 13 000527   000021 630400 14                 EPPR0   17
        13 000530   000004 631400 14                 EPPR1   4
        13 000531   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000532   000000 011000                    NOP     0

     1119    13940    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_EXAMINED.NAME#;

  13940 13 000533   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000534   000100 101500                    MRL     fill='000'O
        13 000535   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000536   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000537   200020 220100                    LDX0    END3+1,,AUTO
        13 000540   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000541   000000 636010                    EAQ     0,X0
        13 000542   000022 772000                    QRL     18
        13 000543   100000 136100                    SBLQ    0,,PR1
        13 000544   100000 235100                    LDA     0,,PR1
        13 000545   000000 621006                    EAX1    0,QL
        13 000546   040145 100400                    MLR     fill='040'O
        13 000547   000134 200017 11                 ADSC9   VM_CHAR_EXAMINED         cn=1,n=15
        13 000550   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1120    13941    3               CHARPOS = CHARPOS + VM_CHAR_EXAMINED.L#;

  13941 13 000551   000134 236000 11                 LDQ     VM_CHAR_EXAMINED
        13 000552   000033 772000                    QRL     27
        13 000553   100000 036100                    ADLQ    0,,PR1
        13 000554   100000 756100                    STQ     0,,PR1
        13 000555   002226 710000 13                 TRA     s:14503

     1121    13942    3           CASE (%SEL_FCOPY);

     1122    13943                    %INIT_STR (CODE=E_CHAR_FCOPY, STR=VM_CHAR_FCOPY, TEST=YES);
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:195  

  13950 13 000556   040000 106400                    CMPC    fill='040'O
        13 000557   000024 200017 11                 ADSC9   VM_CHAR_FCOPY            cn=1,n=15
        13 000560   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000561   000566 601000 13                 TNZ     s:13966

  13952 13 000562   000023 630400 14                 EPPR0   19
        13 000563   000004 631400 14                 EPPR1   4
        13 000564   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000565   000000 011000                    NOP     0

     1123    13966    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_FCOPY.NAME#;

  13966 13 000566   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000567   000100 101500                    MRL     fill='000'O
        13 000570   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000571   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000572   200020 220100                    LDX0    END3+1,,AUTO
        13 000573   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000574   000000 636010                    EAQ     0,X0
        13 000575   000022 772000                    QRL     18
        13 000576   100000 136100                    SBLQ    0,,PR1
        13 000577   100000 235100                    LDA     0,,PR1
        13 000600   000000 621006                    EAX1    0,QL
        13 000601   040145 100400                    MLR     fill='040'O
        13 000602   000024 200017 11                 ADSC9   VM_CHAR_FCOPY            cn=1,n=15
        13 000603   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1124    13967    3               CHARPOS = CHARPOS + VM_CHAR_FCOPY.L#;

  13967 13 000604   000024 236000 11                 LDQ     VM_CHAR_FCOPY
        13 000605   000033 772000                    QRL     27
        13 000606   100000 036100                    ADLQ    0,,PR1
        13 000607   100000 756100                    STQ     0,,PR1
        13 000610   002226 710000 13                 TRA     s:14503

     1125    13968    3           CASE (%SEL_FWD);
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:196  

     1126    13969                    %INIT_STR (CODE=E_CHAR_FWD, STR=VM_CHAR_FWD, TEST=YES);

  13976 13 000611   040000 106400                    CMPC    fill='040'O
        13 000612   000104 200017 11                 ADSC9   VM_CHAR_FWD              cn=1,n=15
        13 000613   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000614   000621 601000 13                 TNZ     s:13992

  13978 13 000615   000025 630400 14                 EPPR0   21
        13 000616   000004 631400 14                 EPPR1   4
        13 000617   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000620   000000 011000                    NOP     0

     1127    13992    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_FWD.NAME#;

  13992 13 000621   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000622   000100 101500                    MRL     fill='000'O
        13 000623   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000624   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000625   200020 220100                    LDX0    END3+1,,AUTO
        13 000626   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000627   000000 636010                    EAQ     0,X0
        13 000630   000022 772000                    QRL     18
        13 000631   100000 136100                    SBLQ    0,,PR1
        13 000632   100000 235100                    LDA     0,,PR1
        13 000633   000000 621006                    EAX1    0,QL
        13 000634   040145 100400                    MLR     fill='040'O
        13 000635   000104 200017 11                 ADSC9   VM_CHAR_FWD              cn=1,n=15
        13 000636   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1128    13993    3               CHARPOS = CHARPOS + VM_CHAR_FWD.L#;

  13993 13 000637   000104 236000 11                 LDQ     VM_CHAR_FWD
        13 000640   000033 772000                    QRL     27
        13 000641   100000 036100                    ADLQ    0,,PR1
        13 000642   100000 756100                    STQ     0,,PR1
        13 000643   002226 710000 13                 TRA     s:14503
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:197  

     1129    13994    3           CASE (%SEL_MARKED);

     1130    13995                    %INIT_STR (CODE=E_CHAR_MARKED, STR=VM_CHAR_MARKED, TEST=YES);

  14002 13 000644   040000 106400                    CMPC    fill='040'O
        13 000645   000034 200017 11                 ADSC9   VM_CHAR_MARKED           cn=1,n=15
        13 000646   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000647   000654 601000 13                 TNZ     s:14018

  14004 13 000650   000027 630400 14                 EPPR0   23
        13 000651   000004 631400 14                 EPPR1   4
        13 000652   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000653   000000 011000                    NOP     0

     1131    14018    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_MARKED.NAME#;

  14018 13 000654   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000655   000100 101500                    MRL     fill='000'O
        13 000656   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000657   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000660   200020 220100                    LDX0    END3+1,,AUTO
        13 000661   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000662   000000 636010                    EAQ     0,X0
        13 000663   000022 772000                    QRL     18
        13 000664   100000 136100                    SBLQ    0,,PR1
        13 000665   100000 235100                    LDA     0,,PR1
        13 000666   000000 621006                    EAX1    0,QL
        13 000667   040145 100400                    MLR     fill='040'O
        13 000670   000034 200017 11                 ADSC9   VM_CHAR_MARKED           cn=1,n=15
        13 000671   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1132    14019    3               CHARPOS = CHARPOS + VM_CHAR_MARKED.L#;

  14019 13 000672   000034 236000 11                 LDQ     VM_CHAR_MARKED
        13 000673   000033 772000                    QRL     27
        13 000674   100000 036100                    ADLQ    0,,PR1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:198  
        13 000675   100000 756100                    STQ     0,,PR1
        13 000676   002226 710000 13                 TRA     s:14503

     1133    14020    3           CASE (%SEL_NEW);

     1134    14021                    %INIT_STR (CODE=E_CHAR_NEW, STR=VM_CHAR_NEW, TEST=YES);

  14028 13 000677   040000 106400                    CMPC    fill='040'O
        13 000700   000040 200017 11                 ADSC9   VM_CHAR_NEW              cn=1,n=15
        13 000701   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000702   000707 601000 13                 TNZ     s:14044

  14030 13 000703   000031 630400 14                 EPPR0   25
        13 000704   000004 631400 14                 EPPR1   4
        13 000705   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000706   000000 011000                    NOP     0

     1135    14044    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_NEW.NAME#;

  14044 13 000707   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000710   000100 101500                    MRL     fill='000'O
        13 000711   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000712   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000713   200020 220100                    LDX0    END3+1,,AUTO
        13 000714   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000715   000000 636010                    EAQ     0,X0
        13 000716   000022 772000                    QRL     18
        13 000717   100000 136100                    SBLQ    0,,PR1
        13 000720   100000 235100                    LDA     0,,PR1
        13 000721   000000 621006                    EAX1    0,QL
        13 000722   040145 100400                    MLR     fill='040'O
        13 000723   000040 200017 11                 ADSC9   VM_CHAR_NEW              cn=1,n=15
        13 000724   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1136    14045    3               CHARPOS = CHARPOS + VM_CHAR_NEW.L#;

  14045 13 000725   000040 236000 11                 LDQ     VM_CHAR_NEW
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:199  
        13 000726   000033 772000                    QRL     27
        13 000727   100000 036100                    ADLQ    0,,PR1
        13 000730   100000 756100                    STQ     0,,PR1
        13 000731   002226 710000 13                 TRA     s:14503

     1137    14046    3           CASE (%SEL_NEXT);

     1138    14047                    %INIT_STR (CODE=E_CHAR_NEXT, STR=VM_CHAR_NEXT, TEST=YES);

  14054 13 000732   040000 106400                    CMPC    fill='040'O
        13 000733   000120 200017 11                 ADSC9   VM_CHAR_NEXT             cn=1,n=15
        13 000734   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000735   000742 601000 13                 TNZ     s:14070

  14056 13 000736   000033 630400 14                 EPPR0   27
        13 000737   000004 631400 14                 EPPR1   4
        13 000740   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000741   000000 011000                    NOP     0

     1139    14070    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_NEXT.NAME#;

  14070 13 000742   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000743   000100 101500                    MRL     fill='000'O
        13 000744   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 000745   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 000746   200020 220100                    LDX0    END3+1,,AUTO
        13 000747   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 000750   000000 636010                    EAQ     0,X0
        13 000751   000022 772000                    QRL     18
        13 000752   100000 136100                    SBLQ    0,,PR1
        13 000753   100000 235100                    LDA     0,,PR1
        13 000754   000000 621006                    EAX1    0,QL
        13 000755   040145 100400                    MLR     fill='040'O
        13 000756   000120 200017 11                 ADSC9   VM_CHAR_NEXT             cn=1,n=15
        13 000757   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1140    14071    3               CHARPOS = CHARPOS + VM_CHAR_NEXT.L#;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:200  

  14071 13 000760   000120 236000 11                 LDQ     VM_CHAR_NEXT
        13 000761   000033 772000                    QRL     27
        13 000762   100000 036100                    ADLQ    0,,PR1
        13 000763   100000 756100                    STQ     0,,PR1
        13 000764   002226 710000 13                 TRA     s:14503

     1141    14072    3           CASE (%SEL_PREVIOUS);

     1142    14073                    %INIT_STR (CODE=E_CHAR_PREVIOUS, STR=VM_CHAR_PREVIOUS, TEST=YES);

  14080 13 000765   040000 106400                    CMPC    fill='040'O
        13 000766   000124 200017 11                 ADSC9   VM_CHAR_PREVIOUS         cn=1,n=15
        13 000767   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 000770   000775 601000 13                 TNZ     s:14096

  14082 13 000771   000035 630400 14                 EPPR0   29
        13 000772   000004 631400 14                 EPPR1   4
        13 000773   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000774   000000 011000                    NOP     0

     1143    14096    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_PREVIOUS.NAME#;

  14096 13 000775   200004 470500                    LDP0    @TEXTC,,AUTO
        13 000776   000100 101500                    MRL     fill='000'O
        13 000777   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001000   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001001   200020 220100                    LDX0    END3+1,,AUTO
        13 001002   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001003   000000 636010                    EAQ     0,X0
        13 001004   000022 772000                    QRL     18
        13 001005   100000 136100                    SBLQ    0,,PR1
        13 001006   100000 235100                    LDA     0,,PR1
        13 001007   000000 621006                    EAX1    0,QL
        13 001010   040145 100400                    MLR     fill='040'O
        13 001011   000124 200017 11                 ADSC9   VM_CHAR_PREVIOUS         cn=1,n=15
        13 001012   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:201  

     1144    14097    3               CHARPOS = CHARPOS + VM_CHAR_PREVIOUS.L#;

  14097 13 001013   000124 236000 11                 LDQ     VM_CHAR_PREVIOUS
        13 001014   000033 772000                    QRL     27
        13 001015   100000 036100                    ADLQ    0,,PR1
        13 001016   100000 756100                    STQ     0,,PR1
        13 001017   002226 710000 13                 TRA     s:14503

     1145    14098    3           CASE (%SEL_OLD);

     1146    14099                    %INIT_STR (CODE=E_CHAR_OLD, STR=VM_CHAR_OLD, TEST=YES);

  14106 13 001020   040000 106400                    CMPC    fill='040'O
        13 001021   000044 200017 11                 ADSC9   VM_CHAR_OLD              cn=1,n=15
        13 001022   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001023   001030 601000 13                 TNZ     s:14122

  14108 13 001024   000037 630400 14                 EPPR0   31
        13 001025   000004 631400 14                 EPPR1   4
        13 001026   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001027   000000 011000                    NOP     0

     1147    14122    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_OLD.NAME#;

  14122 13 001030   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001031   000100 101500                    MRL     fill='000'O
        13 001032   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001033   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001034   200020 220100                    LDX0    END3+1,,AUTO
        13 001035   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001036   000000 636010                    EAQ     0,X0
        13 001037   000022 772000                    QRL     18
        13 001040   100000 136100                    SBLQ    0,,PR1
        13 001041   100000 235100                    LDA     0,,PR1
        13 001042   000000 621006                    EAX1    0,QL
        13 001043   040145 100400                    MLR     fill='040'O
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:202  
        13 001044   000044 200017 11                 ADSC9   VM_CHAR_OLD              cn=1,n=15
        13 001045   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1148    14123    3               CHARPOS = CHARPOS + VM_CHAR_OLD.L#;

  14123 13 001046   000044 236000 11                 LDQ     VM_CHAR_OLD
        13 001047   000033 772000                    QRL     27
        13 001050   100000 036100                    ADLQ    0,,PR1
        13 001051   100000 756100                    STQ     0,,PR1
        13 001052   002226 710000 13                 TRA     s:14503

     1149    14124    3           CASE (%SEL_UNEXAMINED);

     1150    14125                    %INIT_STR (CODE=E_CHAR_UNEXAMINED, STR=VM_CHAR_UNEXAMINED, TEST=YES);

  14132 13 001053   040000 106400                    CMPC    fill='040'O
        13 001054   000130 200017 11                 ADSC9   VM_CHAR_UNEXAMINED       cn=1,n=15
        13 001055   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001056   001063 601000 13                 TNZ     s:14148

  14134 13 001057   000041 630400 14                 EPPR0   33
        13 001060   000004 631400 14                 EPPR1   4
        13 001061   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001062   000000 011000                    NOP     0

     1151    14148    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_UNEXAMINED.NAME#;

  14148 13 001063   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001064   000100 101500                    MRL     fill='000'O
        13 001065   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001066   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001067   200020 220100                    LDX0    END3+1,,AUTO
        13 001070   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001071   000000 636010                    EAQ     0,X0
        13 001072   000022 772000                    QRL     18
        13 001073   100000 136100                    SBLQ    0,,PR1
        13 001074   100000 235100                    LDA     0,,PR1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:203  
        13 001075   000000 621006                    EAX1    0,QL
        13 001076   040145 100400                    MLR     fill='040'O
        13 001077   000130 200017 11                 ADSC9   VM_CHAR_UNEXAMINED       cn=1,n=15
        13 001100   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1152    14149    3               CHARPOS = CHARPOS + VM_CHAR_UNEXAMINED.L#;

  14149 13 001101   000130 236000 11                 LDQ     VM_CHAR_UNEXAMINED
        13 001102   000033 772000                    QRL     27
        13 001103   100000 036100                    ADLQ    0,,PR1
        13 001104   100000 756100                    STQ     0,,PR1
        13 001105   002226 710000 13                 TRA     s:14503

     1153    14150    3           CASE (%SEL_AND);

     1154    14151                    %INIT_STR (CODE=E_CHAR_AND, STR=VM_CHAR_AND, TEST=YES);

  14158 13 001106   040000 106400                    CMPC    fill='040'O
        13 001107   000050 200017 11                 ADSC9   VM_CHAR_AND              cn=1,n=15
        13 001110   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001111   001116 601000 13                 TNZ     s:14174

  14160 13 001112   000043 630400 14                 EPPR0   35
        13 001113   000004 631400 14                 EPPR1   4
        13 001114   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001115   000000 011000                    NOP     0

     1155    14174    3               substr(TEXTC.TEXT,CHARPOS) =  VM_CHAR_AND.NAME#;

  14174 13 001116   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001117   000100 101500                    MRL     fill='000'O
        13 001120   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001121   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001122   200020 220100                    LDX0    END3+1,,AUTO
        13 001123   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001124   000000 636010                    EAQ     0,X0
        13 001125   000022 772000                    QRL     18
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:204  
        13 001126   100000 136100                    SBLQ    0,,PR1
        13 001127   100000 235100                    LDA     0,,PR1
        13 001130   000000 621006                    EAX1    0,QL
        13 001131   040145 100400                    MLR     fill='040'O
        13 001132   000050 200017 11                 ADSC9   VM_CHAR_AND              cn=1,n=15
        13 001133   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1156    14175    3               CHARPOS = CHARPOS + VM_CHAR_AND.L#;

  14175 13 001134   000050 236000 11                 LDQ     VM_CHAR_AND
        13 001135   000033 772000                    QRL     27
        13 001136   100000 036100                    ADLQ    0,,PR1
        13 001137   100000 756100                    STQ     0,,PR1
        13 001140   002226 710000 13                 TRA     s:14503

     1157    14176    3           CASE (%SEL_OR);

     1158    14177                    %INIT_STR (CODE=E_CHAR_OR, STR=VM_CHAR_OR, TEST=YES);

  14184 13 001141   040000 106400                    CMPC    fill='040'O
        13 001142   000054 200017 11                 ADSC9   VM_CHAR_OR               cn=1,n=15
        13 001143   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001144   001151 601000 13                 TNZ     s:14200

  14186 13 001145   000045 630400 14                 EPPR0   37
        13 001146   000004 631400 14                 EPPR1   4
        13 001147   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001150   000000 011000                    NOP     0

     1159    14200    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_OR.NAME#;

  14200 13 001151   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001152   000100 101500                    MRL     fill='000'O
        13 001153   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001154   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001155   200020 220100                    LDX0    END3+1,,AUTO
        13 001156   200005 471500                    LDP1    @CHARPOS,,AUTO
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:205  
        13 001157   000000 636010                    EAQ     0,X0
        13 001160   000022 772000                    QRL     18
        13 001161   100000 136100                    SBLQ    0,,PR1
        13 001162   100000 235100                    LDA     0,,PR1
        13 001163   000000 621006                    EAX1    0,QL
        13 001164   040145 100400                    MLR     fill='040'O
        13 001165   000054 200017 11                 ADSC9   VM_CHAR_OR               cn=1,n=15
        13 001166   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1160    14201    3               CHARPOS = CHARPOS + VM_CHAR_OR.L#;

  14201 13 001167   000054 236000 11                 LDQ     VM_CHAR_OR
        13 001170   000033 772000                    QRL     27
        13 001171   100000 036100                    ADLQ    0,,PR1
        13 001172   100000 756100                    STQ     0,,PR1
        13 001173   002226 710000 13                 TRA     s:14503

     1161    14202    3           CASE (%SEL_NOT);

     1162    14203                    %INIT_STR (CODE=E_CHAR_NOT, STR=VM_CHAR_NOT, TEST=YES);

  14210 13 001174   040000 106400                    CMPC    fill='040'O
        13 001175   000060 200017 11                 ADSC9   VM_CHAR_NOT              cn=1,n=15
        13 001176   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001177   001204 601000 13                 TNZ     s:14226

  14212 13 001200   000047 630400 14                 EPPR0   39
        13 001201   000004 631400 14                 EPPR1   4
        13 001202   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001203   000000 011000                    NOP     0

     1163    14226    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_NOT.NAME#;

  14226 13 001204   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001205   000100 101500                    MRL     fill='000'O
        13 001206   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001207   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:206  
        13 001210   200020 220100                    LDX0    END3+1,,AUTO
        13 001211   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001212   000000 636010                    EAQ     0,X0
        13 001213   000022 772000                    QRL     18
        13 001214   100000 136100                    SBLQ    0,,PR1
        13 001215   100000 235100                    LDA     0,,PR1
        13 001216   000000 621006                    EAX1    0,QL
        13 001217   040145 100400                    MLR     fill='040'O
        13 001220   000060 200017 11                 ADSC9   VM_CHAR_NOT              cn=1,n=15
        13 001221   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1164    14227    3               CHARPOS = CHARPOS + VM_CHAR_NOT.L#;

  14227 13 001222   000060 236000 11                 LDQ     VM_CHAR_NOT
        13 001223   000033 772000                    QRL     27
        13 001224   100000 036100                    ADLQ    0,,PR1
        13 001225   100000 756100                    STQ     0,,PR1
        13 001226   002226 710000 13                 TRA     s:14503

     1165    14228    3           CASE (%SEL_RR);

     1166    14229                    %INIT_STR (CODE=E_CHAR_RR, STR=VM_CHAR_RR, TEST=YES);

  14236 13 001227   040000 106400                    CMPC    fill='040'O
        13 001230   000140 200017 11                 ADSC9   VM_CHAR_RR               cn=1,n=15
        13 001231   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001232   001237 601000 13                 TNZ     s:14252

  14238 13 001233   000051 630400 14                 EPPR0   41
        13 001234   000004 631400 14                 EPPR1   4
        13 001235   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001236   000000 011000                    NOP     0

     1167    14252    3               substr(TEXTC.TEXT,CHARPOS) = VM_CHAR_RR.NAME#;

  14252 13 001237   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001240   000100 101500                    MRL     fill='000'O
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:207  
        13 001241   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001242   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001243   200020 220100                    LDX0    END3+1,,AUTO
        13 001244   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001245   000000 636010                    EAQ     0,X0
        13 001246   000022 772000                    QRL     18
        13 001247   100000 136100                    SBLQ    0,,PR1
        13 001250   100000 235100                    LDA     0,,PR1
        13 001251   000000 621006                    EAX1    0,QL
        13 001252   040145 100400                    MLR     fill='040'O
        13 001253   000140 200017 11                 ADSC9   VM_CHAR_RR               cn=1,n=15
        13 001254   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1168    14253    3               CHARPOS = CHARPOS + VM_CHAR_RR.L#;

  14253 13 001255   000140 236000 11                 LDQ     VM_CHAR_RR
        13 001256   000033 772000                    QRL     27
        13 001257   100000 036100                    ADLQ    0,,PR1
        13 001260   100000 756100                    STQ     0,,PR1
        13 001261   002226 710000 13                 TRA     s:14503

     1169    14254    3           CASE (%SEL_FROM);

     1170    14255                    %INIT_STR (CODE=E_CHAR_FROM, STR=VM_CHAR_FROM, TEST=YES);

  14262 13 001262   040000 106400                    CMPC    fill='040'O
        13 001263   000030 200017 11                 ADSC9   VM_CHAR_FROM             cn=1,n=15
        13 001264   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001265   001272 601000 13                 TNZ     s:14278

  14264 13 001266   000053 630400 14                 EPPR0   43
        13 001267   000004 631400 14                 EPPR1   4
        13 001270   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001271   000000 011000                    NOP     0

     1171    14278    3              call insert(TEXTC.TEXT, CHARPOS,,substr(VM_CHAR_FROM.NAME#,,VM_CHAR_FROM
             14278                        .L#));
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:208  

  14278 13 001272   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001273   000100 101500                    MRL     fill='000'O
        13 001274   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001275   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001276   200020 220100                    LDX0    END3+1,,AUTO
        13 001277   000030 236000 11                 LDQ     VM_CHAR_FROM
        13 001300   000033 772000                    QRL     27
        13 001301   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001302   000000 621006                    EAX1    0,QL
        13 001303   000000 636010                    EAQ     0,X0
        13 001304   000022 772000                    QRL     18
        13 001305   100000 136100                    SBLQ    0,,PR1
        13 001306   100000 235100                    LDA     0,,PR1
        13 001307   000000 622006                    EAX2    0,QL
        13 001310   040145 100440                    MLR     fill='040'O
        13 001311   000030 200011 11                 ADSC9   VM_CHAR_FROM             cn=1,n=*X1
        13 001312   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

     1172    14279    3               CHARPOS = CHARPOS + VM_CHAR_FROM.L# ;

  14279 13 001313   000030 236000 11                 LDQ     VM_CHAR_FROM
        13 001314   000033 772000                    QRL     27
        13 001315   100000 036100                    ADLQ    0,,PR1
        13 001316   100000 756100                    STQ     0,,PR1

     1173    14280    3               GOTO CMPR_STR;

  14280 13 001317   001507 710000 13                 TRA     CMPR_STR

     1174    14281    3           CASE (%SEL_REFERENCE);

     1175    14282                    %INIT_STR (CODE=E_CHAR_REFERENCE, STR=VM_CHAR_REFERENCE, TEST=YES);

  14289 13 001320   040000 106400                    CMPC    fill='040'O
        13 001321   000064 200017 11                 ADSC9   VM_CHAR_REFERENCE        cn=1,n=15
        13 001322   000003 000001 14                 ADSC9   3                        cn=0,n=1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:209  
        13 001323   001330 601000 13                 TNZ     s:14305

  14291 13 001324   000055 630400 14                 EPPR0   45
        13 001325   000004 631400 14                 EPPR1   4
        13 001326   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001327   000000 011000                    NOP     0

     1176    14305    3               call insert(TEXTC.TEXT,CHARPOS,,substr(VM_CHAR_REFERENCE.NAME#,,
             14305                        VM_CHAR_REFERENCE.L#));

  14305 13 001330   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001331   000100 101500                    MRL     fill='000'O
        13 001332   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001333   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001334   200020 220100                    LDX0    END3+1,,AUTO
        13 001335   000064 236000 11                 LDQ     VM_CHAR_REFERENCE
        13 001336   000033 772000                    QRL     27
        13 001337   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001340   000000 621006                    EAX1    0,QL
        13 001341   000000 636010                    EAQ     0,X0
        13 001342   000022 772000                    QRL     18
        13 001343   100000 136100                    SBLQ    0,,PR1
        13 001344   100000 235100                    LDA     0,,PR1
        13 001345   000000 622006                    EAX2    0,QL
        13 001346   040145 100440                    MLR     fill='040'O
        13 001347   000064 200011 11                 ADSC9   VM_CHAR_REFERENCE        cn=1,n=*X1
        13 001350   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

     1177    14306    3               CHARPOS = CHARPOS + VM_CHAR_REFERENCE.L#;

  14306 13 001351   000064 236000 11                 LDQ     VM_CHAR_REFERENCE
        13 001352   000033 772000                    QRL     27
        13 001353   100000 036100                    ADLQ    0,,PR1
        13 001354   100000 756100                    STQ     0,,PR1

     1178    14307    3               GOTO CMPR_STR;

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:210  
  14307 13 001355   001507 710000 13                 TRA     CMPR_STR

     1179    14308    3           CASE (%SEL_REPLY_TO);

     1180    14309                    %INIT_STR (CODE=E_CHAR_REPLYTO, STR=VM_CHAR_REPLYTO, TEST=YES);

  14316 13 001356   040000 106400                    CMPC    fill='040'O
        13 001357   000070 200017 11                 ADSC9   VM_CHAR_REPLYTO          cn=1,n=15
        13 001360   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001361   001366 601000 13                 TNZ     s:14332

  14318 13 001362   000057 630400 14                 EPPR0   47
        13 001363   000004 631400 14                 EPPR1   4
        13 001364   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001365   000000 011000                    NOP     0

     1181    14332    3               call insert(TEXTC.TEXT,CHARPOS,, substr(VM_CHAR_REPLYTO.NAME#,,
             14332                        VM_CHAR_REPLYTO.L#));

  14332 13 001366   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001367   000100 101500                    MRL     fill='000'O
        13 001370   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001371   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001372   200020 220100                    LDX0    END3+1,,AUTO
        13 001373   000070 236000 11                 LDQ     VM_CHAR_REPLYTO
        13 001374   000033 772000                    QRL     27
        13 001375   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001376   000000 621006                    EAX1    0,QL
        13 001377   000000 636010                    EAQ     0,X0
        13 001400   000022 772000                    QRL     18
        13 001401   100000 136100                    SBLQ    0,,PR1
        13 001402   100000 235100                    LDA     0,,PR1
        13 001403   000000 622006                    EAX2    0,QL
        13 001404   040145 100440                    MLR     fill='040'O
        13 001405   000070 200011 11                 ADSC9   VM_CHAR_REPLYTO          cn=1,n=*X1
        13 001406   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:211  
     1182    14333    3               CHARPOS = CHARPOS + VM_CHAR_REPLYTO.L#;

  14333 13 001407   000070 236000 11                 LDQ     VM_CHAR_REPLYTO
        13 001410   000033 772000                    QRL     27
        13 001411   100000 036100                    ADLQ    0,,PR1
        13 001412   100000 756100                    STQ     0,,PR1

     1183    14334    3               GOTO CMPR_STR;

  14334 13 001413   001507 710000 13                 TRA     CMPR_STR

     1184    14335    3           CASE (%SEL_SUBJECT);

     1185    14336                    %INIT_STR (CODE=E_CHAR_SUBJECT, STR=VM_CHAR_SUBJECT, TEST=YES);

  14343 13 001414   040000 106400                    CMPC    fill='040'O
        13 001415   000074 200017 11                 ADSC9   VM_CHAR_SUBJECT          cn=1,n=15
        13 001416   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001417   001424 601000 13                 TNZ     s:14359

  14345 13 001420   000061 630400 14                 EPPR0   49
        13 001421   000004 631400 14                 EPPR1   4
        13 001422   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001423   000000 011000                    NOP     0

     1186    14359    3               call insert(TEXTC.TEXT,CHARPOS,, substr(VM_CHAR_SUBJECT.NAME#,,
             14359                        VM_CHAR_SUBJECT.L#));

  14359 13 001424   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001425   000100 101500                    MRL     fill='000'O
        13 001426   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001427   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001430   200020 220100                    LDX0    END3+1,,AUTO
        13 001431   000074 236000 11                 LDQ     VM_CHAR_SUBJECT
        13 001432   000033 772000                    QRL     27
        13 001433   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001434   000000 621006                    EAX1    0,QL
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:212  
        13 001435   000000 636010                    EAQ     0,X0
        13 001436   000022 772000                    QRL     18
        13 001437   100000 136100                    SBLQ    0,,PR1
        13 001440   100000 235100                    LDA     0,,PR1
        13 001441   000000 622006                    EAX2    0,QL
        13 001442   040145 100440                    MLR     fill='040'O
        13 001443   000074 200011 11                 ADSC9   VM_CHAR_SUBJECT          cn=1,n=*X1
        13 001444   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

     1187    14360    3               CHARPOS = CHARPOS + VM_CHAR_SUBJECT.L#;

  14360 13 001445   000074 236000 11                 LDQ     VM_CHAR_SUBJECT
        13 001446   000033 772000                    QRL     27
        13 001447   100000 036100                    ADLQ    0,,PR1
        13 001450   100000 756100                    STQ     0,,PR1

     1188    14361    3               GOTO CMPR_STR;

  14361 13 001451   001507 710000 13                 TRA     CMPR_STR

     1189    14362    3           CASE (%SEL_TO);

     1190    14363                    %INIT_STR (CODE=E_CHAR_TO, STR=VM_CHAR_TO, TEST=YES);

  14370 13 001452   040000 106400                    CMPC    fill='040'O
        13 001453   000100 200017 11                 ADSC9   VM_CHAR_TO               cn=1,n=15
        13 001454   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001455   001462 601000 13                 TNZ     s:14386

  14372 13 001456   000063 630400 14                 EPPR0   51
        13 001457   000004 631400 14                 EPPR1   4
        13 001460   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001461   000000 011000                    NOP     0

     1191    14386    3              call insert(TEXTC.TEXT, CHARPOS,, substr(VM_CHAR_TO.NAME#,,VM_CHAR_TO.L#
             14386                        ));

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:213  
  14386 13 001462   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001463   000100 101500                    MRL     fill='000'O
        13 001464   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001465   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001466   200020 220100                    LDX0    END3+1,,AUTO
        13 001467   000100 236000 11                 LDQ     VM_CHAR_TO
        13 001470   000033 772000                    QRL     27
        13 001471   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001472   000000 621006                    EAX1    0,QL
        13 001473   000000 636010                    EAQ     0,X0
        13 001474   000022 772000                    QRL     18
        13 001475   100000 136100                    SBLQ    0,,PR1
        13 001476   100000 235100                    LDA     0,,PR1
        13 001477   000000 622006                    EAX2    0,QL
        13 001500   040145 100440                    MLR     fill='040'O
        13 001501   000100 200011 11                 ADSC9   VM_CHAR_TO               cn=1,n=*X1
        13 001502   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

     1192    14387    3               CHARPOS = CHARPOS + VM_CHAR_TO.L#;

  14387 13 001503   000100 236000 11                 LDQ     VM_CHAR_TO
        13 001504   000033 772000                    QRL     27
        13 001505   100000 036100                    ADLQ    0,,PR1
        13 001506   100000 756100                    STQ     0,,PR1

  14387 13 001507                       CMPR_STR     null
     1193    14388    3   CMPR_STR:   ;
     1194    14389    4               DO CASE (PTR1$ -> P$B.SUBLK$(0) -> P$B.CODE);

  14389 13 001507   200011 473500                    LDP3    PTR1$,,AUTO
        13 001510   300003 474500                    LDP4    3,,PR3
        13 001511   400000 720100                    LXL0    0,,PR4
        13 001512   000003 100003                    CMPX0   3,DU
        13 001513   001515 602010 13                 TNC     CMPR_STR+6,X0
        13 001514   001555 710000 13                 TRA     s:14397
        13 001515   001555 710000 13                 TRA     s:14397
        13 001516   001537 710000 13                 TRA     s:14394
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:214  
        13 001517   001520 710000 13                 TRA     s:14391

     1195    14390    4               CASE (%OPTION_EQ);

     1196    14391    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '=''');

  14391 13 001520   000100 101500                    MRL     fill='000'O
        13 001521   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001522   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001523   200020 220100                    LDX0    END3+1,,AUTO
        13 001524   000000 636010                    EAQ     0,X0
        13 001525   000022 772000                    QRL     18
        13 001526   100000 136100                    SBLQ    0,,PR1
        13 001527   100000 235100                    LDA     0,,PR1
        13 001530   000000 621006                    EAX1    0,QL
        13 001531   040145 100400                    MLR     fill='040'O
        13 001532   000033 000002 12                 ADSC9   E_CHAR_RCVD+1            cn=0,n=2
        13 001533   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1197    14392    4                   CHARPOS = CHARPOS + LENGTHC('=''');

  14392 13 001534   000002 236007                    LDQ     2,DL
        13 001535   100000 056100                    ASQ     0,,PR1
        13 001536   001555 710000 13                 TRA     s:14397

     1198    14393    4               CASE (%OPTION_NE);

     1199    14394    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '~=''');

  14394 13 001537   000100 101500                    MRL     fill='000'O
        13 001540   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001541   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001542   200020 220100                    LDX0    END3+1,,AUTO
        13 001543   000000 636010                    EAQ     0,X0
        13 001544   000022 772000                    QRL     18
        13 001545   100000 136100                    SBLQ    0,,PR1
        13 001546   100000 235100                    LDA     0,,PR1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:215  
        13 001547   000000 621006                    EAX1    0,QL
        13 001550   040145 100400                    MLR     fill='040'O
        13 001551   000034 000003 12                 ADSC9   E_CHAR_RCVD+2            cn=0,n=3
        13 001552   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1200    14395    4                   CHARPOS = CHARPOS + LENGTHC('~=''');

  14395 13 001553   000003 236007                    LDQ     3,DL
        13 001554   100000 056100                    ASQ     0,,PR1

     1201    14396    4               END;

     1202    14397    3               PTR2$ = PTR1$ -> P$B.SUBLK$(0)->P$B.SUBLK$(0);

  14397 13 001555   200011 473500                    LDP3    PTR1$,,AUTO
        13 001556   300003 474500                    LDP4    3,,PR3
        13 001557   400003 236100                    LDQ     3,,PR4
        13 001560   200012 756100                    STQ     PTR2$,,AUTO

     1203    14398    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,PTR2$ -> P$S.TEXT);

  14398 13 001561   000100 101500                    MRL     fill='000'O
        13 001562   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001563   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001564   200020 220100                    LDX0    END3+1,,AUTO
        13 001565   200012 474500                    LDP4    PTR2$,,AUTO
        13 001566   400004 236100                    LDQ     4,,PR4
        13 001567   000033 772000                    QRL     27
        13 001570   000000 621006                    EAX1    0,QL
        13 001571   000000 636010                    EAQ     0,X0
        13 001572   000022 772000                    QRL     18
        13 001573   100000 136100                    SBLQ    0,,PR1
        13 001574   100000 235100                    LDA     0,,PR1
        13 001575   000000 622006                    EAX2    0,QL
        13 001576   040145 100540                    MLR     fill='040'O
        13 001577   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
        13 001600   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:216  

     1204    14399    3               CHARPOS = CHARPOS + PTR2$ -> P$S.COUNT;

  14399 13 001601   400004 236100                    LDQ     4,,PR4
        13 001602   000033 772000                    QRL     27
        13 001603   100000 036100                    ADLQ    0,,PR1
        13 001604   100000 756100                    STQ     0,,PR1

     1205    14400    3               CALL INSERT (TEXTC.TEXT,CHARPOS,,'''');

  14400 13 001605   000100 101500                    MRL     fill='000'O
        13 001606   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001607   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001610   200020 220100                    LDX0    END3+1,,AUTO
        13 001611   000000 636010                    EAQ     0,X0
        13 001612   000022 772000                    QRL     18
        13 001613   100000 136100                    SBLQ    0,,PR1
        13 001614   100000 235100                    LDA     0,,PR1
        13 001615   000000 621006                    EAX1    0,QL
        13 001616   040145 100400                    MLR     fill='040'O
        13 001617   000065 000001 14                 ADSC9   53                       cn=0,n=1
        13 001620   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1206    14401    3               CHARPOS = CHARPOS + LENGTHC('''');

  14401 13 001621   100000 054100                    AOS     0,,PR1
        13 001622   002226 710000 13                 TRA     s:14503

     1207    14402    3           CASE (%SEL_DATE_SENT);

     1208    14403                    %INIT_STR (CODE=E_CHAR_SENT, STR=VM_CHAR_SENT, TEST=YES);

  14410 13 001623   040000 106400                    CMPC    fill='040'O
        13 001624   000144 200017 11                 ADSC9   VM_CHAR_SENT             cn=1,n=15
        13 001625   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001626   001633 601000 13                 TNZ     s:14426

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:217  
  14412 13 001627   000066 630400 14                 EPPR0   54
        13 001630   000004 631400 14                 EPPR1   4
        13 001631   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001632   000000 011000                    NOP     0

     1209    14426    3               call insert(TEXTC.TEXT, CHARPOS,, substr(VM_CHAR_SENT.NAME#,,
             14426                        VM_CHAR_SENT.L#));

  14426 13 001633   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001634   000100 101500                    MRL     fill='000'O
        13 001635   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001636   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001637   200020 220100                    LDX0    END3+1,,AUTO
        13 001640   000144 236000 11                 LDQ     VM_CHAR_SENT
        13 001641   000033 772000                    QRL     27
        13 001642   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001643   000000 621006                    EAX1    0,QL
        13 001644   000000 636010                    EAQ     0,X0
        13 001645   000022 772000                    QRL     18
        13 001646   100000 136100                    SBLQ    0,,PR1
        13 001647   100000 235100                    LDA     0,,PR1
        13 001650   000000 622006                    EAX2    0,QL
        13 001651   040145 100440                    MLR     fill='040'O
        13 001652   000144 200011 11                 ADSC9   VM_CHAR_SENT             cn=1,n=*X1
        13 001653   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

     1210    14427    3               CHARPOS = CHARPOS + VM_CHAR_SENT.L#;

  14427 13 001654   000144 236000 11                 LDQ     VM_CHAR_SENT
        13 001655   000033 772000                    QRL     27
        13 001656   100000 036100                    ADLQ    0,,PR1
        13 001657   100000 756100                    STQ     0,,PR1

     1211    14428    3               GOTO CMPR_DATE;

  14428 13 001660   001716 710000 13                 TRA     CMPR_DATE

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:218  
     1212    14429    3           CASE (%SEL_DATE_RCVD);

     1213    14430                    %INIT_STR (CODE=E_CHAR_RCVD, STR=VM_CHAR_RCVD, TEST=YES);

  14437 13 001661   040000 106400                    CMPC    fill='040'O
        13 001662   000150 200017 11                 ADSC9   VM_CHAR_RCVD             cn=1,n=15
        13 001663   000003 000001 14                 ADSC9   3                        cn=0,n=1
        13 001664   001671 601000 13                 TNZ     s:14453

  14439 13 001665   000070 630400 14                 EPPR0   56
        13 001666   000004 631400 14                 EPPR1   4
        13 001667   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001670   000000 011000                    NOP     0

     1214    14453    3               call insert(TEXTC.TEXT, CHARPOS,, substr(VM_CHAR_RCVD.NAME#,,
             14453                        VM_CHAR_RCVD.L#));

  14453 13 001671   200004 470500                    LDP0    @TEXTC,,AUTO
        13 001672   000100 101500                    MRL     fill='000'O
        13 001673   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001674   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001675   200020 220100                    LDX0    END3+1,,AUTO
        13 001676   000150 236000 11                 LDQ     VM_CHAR_RCVD
        13 001677   000033 772000                    QRL     27
        13 001700   200005 471500                    LDP1    @CHARPOS,,AUTO
        13 001701   000000 621006                    EAX1    0,QL
        13 001702   000000 636010                    EAQ     0,X0
        13 001703   000022 772000                    QRL     18
        13 001704   100000 136100                    SBLQ    0,,PR1
        13 001705   100000 235100                    LDA     0,,PR1
        13 001706   000000 622006                    EAX2    0,QL
        13 001707   040145 100440                    MLR     fill='040'O
        13 001710   000150 200011 11                 ADSC9   VM_CHAR_RCVD             cn=1,n=*X1
        13 001711   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

     1215    14454    3               CHARPOS = CHARPOS + VM_CHAR_RCVD.L#;

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:219  
  14454 13 001712   000150 236000 11                 LDQ     VM_CHAR_RCVD
        13 001713   000033 772000                    QRL     27
        13 001714   100000 036100                    ADLQ    0,,PR1
        13 001715   100000 756100                    STQ     0,,PR1

  14454 13 001716                       CMPR_DATE    null
     1216    14455    3   CMPR_DATE:  ;
     1217    14456    4               DO CASE (PTR1$ -> P$B.SUBLK$(0) -> P$B.CODE);

  14456 13 001716   200011 473500                    LDP3    PTR1$,,AUTO
        13 001717   300003 474500                    LDP4    3,,PR3
        13 001720   400000 720100                    LXL0    0,,PR4
        13 001721   000007 100003                    CMPX0   7,DU
        13 001722   001724 602010 13                 TNC     CMPR_DATE+6,X0
        13 001723   002061 710000 13                 TRA     s:14476
        13 001724   002061 710000 13                 TRA     s:14476
        13 001725   001751 710000 13                 TRA     s:14461
        13 001726   001733 710000 13                 TRA     s:14458
        13 001727   001770 710000 13                 TRA     s:14464
        13 001730   002006 710000 13                 TRA     s:14467
        13 001731   002025 710000 13                 TRA     s:14470
        13 001732   002043 710000 13                 TRA     s:14473

     1218    14457    4               CASE (%OPTION_EQ);

     1219    14458    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '=');

  14458 13 001733   000100 101500                    MRL     fill='000'O
        13 001734   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001735   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001736   200020 220100                    LDX0    END3+1,,AUTO
        13 001737   000000 636010                    EAQ     0,X0
        13 001740   000022 772000                    QRL     18
        13 001741   100000 136100                    SBLQ    0,,PR1
        13 001742   100000 235100                    LDA     0,,PR1
        13 001743   000000 621006                    EAX1    0,QL
        13 001744   040145 100400                    MLR     fill='040'O
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:220  
        13 001745   000072 000001 14                 ADSC9   58                       cn=0,n=1
        13 001746   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1220    14459    4                   CHARPOS = CHARPOS + LENGTHC('=');

  14459 13 001747   100000 054100                    AOS     0,,PR1
        13 001750   002061 710000 13                 TRA     s:14476

     1221    14460    4               CASE (%OPTION_NE);

     1222    14461    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '~=');

  14461 13 001751   000100 101500                    MRL     fill='000'O
        13 001752   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 001753   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001754   200020 220100                    LDX0    END3+1,,AUTO
        13 001755   000000 636010                    EAQ     0,X0
        13 001756   000022 772000                    QRL     18
        13 001757   100000 136100                    SBLQ    0,,PR1
        13 001760   100000 235100                    LDA     0,,PR1
        13 001761   000000 621006                    EAX1    0,QL
        13 001762   040145 100400                    MLR     fill='040'O
        13 001763   000034 000002 12                 ADSC9   E_CHAR_RCVD+2            cn=0,n=2
        13 001764   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1223    14462    4                   CHARPOS = CHARPOS + LENGTHC('~=');

  14462 13 001765   000002 236007                    LDQ     2,DL
        13 001766   100000 056100                    ASQ     0,,PR1
        13 001767   002061 710000 13                 TRA     s:14476

     1224    14463    4               CASE (%OPTION_GT);

     1225    14464    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '>');

  14464 13 001770   000100 101500                    MRL     fill='000'O
        13 001771   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:221  
        13 001772   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 001773   200020 220100                    LDX0    END3+1,,AUTO
        13 001774   000000 636010                    EAQ     0,X0
        13 001775   000022 772000                    QRL     18
        13 001776   100000 136100                    SBLQ    0,,PR1
        13 001777   100000 235100                    LDA     0,,PR1
        13 002000   000000 621006                    EAX1    0,QL
        13 002001   040145 100400                    MLR     fill='040'O
        13 002002   000073 000001 14                 ADSC9   59                       cn=0,n=1
        13 002003   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1226    14465    4                   CHARPOS = CHARPOS + LENGTHC('>');

  14465 13 002004   100000 054100                    AOS     0,,PR1
        13 002005   002061 710000 13                 TRA     s:14476

     1227    14466    4               CASE (%OPTION_GE);

     1228    14467    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '>=');

  14467 13 002006   000100 101500                    MRL     fill='000'O
        13 002007   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002010   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 002011   200020 220100                    LDX0    END3+1,,AUTO
        13 002012   000000 636010                    EAQ     0,X0
        13 002013   000022 772000                    QRL     18
        13 002014   100000 136100                    SBLQ    0,,PR1
        13 002015   100000 235100                    LDA     0,,PR1
        13 002016   000000 621006                    EAX1    0,QL
        13 002017   040145 100400                    MLR     fill='040'O
        13 002020   000035 000002 12                 ADSC9   E_CHAR_RCVD+3            cn=0,n=2
        13 002021   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1229    14468    4                   CHARPOS = CHARPOS + LENGTHC('>=');

  14468 13 002022   000002 236007                    LDQ     2,DL
        13 002023   100000 056100                    ASQ     0,,PR1
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:222  
        13 002024   002061 710000 13                 TRA     s:14476

     1230    14469    4               CASE (%OPTION_LT);

     1231    14470    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '<');

  14470 13 002025   000100 101500                    MRL     fill='000'O
        13 002026   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002027   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 002030   200020 220100                    LDX0    END3+1,,AUTO
        13 002031   000000 636010                    EAQ     0,X0
        13 002032   000022 772000                    QRL     18
        13 002033   100000 136100                    SBLQ    0,,PR1
        13 002034   100000 235100                    LDA     0,,PR1
        13 002035   000000 621006                    EAX1    0,QL
        13 002036   040145 100400                    MLR     fill='040'O
        13 002037   000074 000001 14                 ADSC9   60                       cn=0,n=1
        13 002040   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1232    14471    4                   CHARPOS = CHARPOS + LENGTHC('<');

  14471 13 002041   100000 054100                    AOS     0,,PR1
        13 002042   002061 710000 13                 TRA     s:14476

     1233    14472    4               CASE (%OPTION_LE);

     1234    14473    4                   CALL INSERT(TEXTC.TEXT, CHARPOS,, '<=');

  14473 13 002043   000100 101500                    MRL     fill='000'O
        13 002044   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002045   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 002046   200020 220100                    LDX0    END3+1,,AUTO
        13 002047   000000 636010                    EAQ     0,X0
        13 002050   000022 772000                    QRL     18
        13 002051   100000 136100                    SBLQ    0,,PR1
        13 002052   100000 235100                    LDA     0,,PR1
        13 002053   000000 621006                    EAX1    0,QL
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:223  
        13 002054   040145 100400                    MLR     fill='040'O
        13 002055   000036 000002 12                 ADSC9   E_CHAR_RCVD+4            cn=0,n=2
        13 002056   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1235    14474    4                   CHARPOS = CHARPOS + LENGTHC('<=');

  14474 13 002057   000002 236007                    LDQ     2,DL
        13 002060   100000 056100                    ASQ     0,,PR1

     1236    14475    4               END;

     1237    14476    3               PTR2$ = PTR1$ -> P$B.SUBLK$(0) -> P$B.SUBLK$(0);

  14476 13 002061   200011 473500                    LDP3    PTR1$,,AUTO
        13 002062   300003 474500                    LDP4    3,,PR3
        13 002063   400003 236100                    LDQ     3,,PR4
        13 002064   200012 756100                    STQ     PTR2$,,AUTO

     1238    14477    3               END2 = PTR2$ -> P$B.NSUBLKS - 1;

  14477 13 002065   200012 475500                    LDP5    PTR2$,,AUTO
        13 002066   500001 236100                    LDQ     1,,PR5
        13 002067   000022 772000                    QRL     18
        13 002070   000001 136007                    SBLQ    1,DL
        13 002071   200016 756100                    STQ     END2,,AUTO

     1239    14478    4               DO INDX2 = 0 TO END2;

  14478 13 002072   200007 450100                    STZ     INDX2,,AUTO
        13 002073   002223 710000 13                 TRA     s:14501+1

     1240    14479    4                   PTR3$ = PTR2$ -> P$B.SUBLK$(INDX2);

  14479 13 002074   200012 470500                    LDP0    PTR2$,,AUTO
        13 002075   200007 720100                    LXL0    INDX2,,AUTO
        13 002076   000003 236110                    LDQ     3,X0,PR0
        13 002077   200013 756100                    STQ     PTR3$,,AUTO
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:224  

     1241    14480    5                   DO CASE (PTR3$ -> P$B.CODE);

  14480 13 002100   200013 471500                    LDP1    PTR3$,,AUTO
        13 002101   100000 721100                    LXL1    0,,PR1
        13 002102   000003 101003                    CMPX1   3,DU
        13 002103   002105 602011 13                 TNC     s:14480+5,X1
        13 002104   002115 710000 13                 TRA     s:14486
        13 002105   002115 710000 13                 TRA     s:14486
        13 002106   002110 710000 13                 TRA     s:14482
        13 002107   002113 710000 13                 TRA     s:14484

     1242    14481    5                   CASE (%OPTION_DATE);

     1243    14482    5                       DELIM = '/';

  14482 13 002110   057000 236003                    LDQ     24064,DU
        13 002111   200014 756100                    STQ     DELIM,,AUTO
        13 002112   002115 710000 13                 TRA     s:14486

     1244    14483    5                   CASE (%OPTION_TIME);

     1245    14484    5                       DELIM = ':';

  14484 13 002113   072000 236003                    LDQ     29696,DU
        13 002114   200014 756100                    STQ     DELIM,,AUTO

     1246    14485    5                   END;

     1247    14486    4                   END3 = PTR3$ -> P$B.NSUBLKS - 1;

  14486 13 002115   100001 236100                    LDQ     1,,PR1
        13 002116   000022 772000                    QRL     18
        13 002117   000001 136007                    SBLQ    1,DL
        13 002120   200017 756100                    STQ     END3,,AUTO

     1248    14487    5                   DO INDX3 = 0 TO END3;
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:225  

  14487 13 002121   200010 450100                    STZ     INDX3,,AUTO
        13 002122   002175 710000 13                 TRA     s:14495+1

     1249    14488    5                       CALL INSERT(TEXTC.TEXT, CHARPOS,, PTR3$ -> P$B.SUBLK$(INDX3) ->
             14488                                P$S.TEXT);

  14488 13 002123   200004 470500                    LDP0    @TEXTC,,AUTO
        13 002124   000100 101500                    MRL     fill='000'O
        13 002125   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002126   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 002127   200020 220100                    LDX0    END3+1,,AUTO
        13 002130   200013 471500                    LDP1    PTR3$,,AUTO
        13 002131   200010 721100                    LXL1    INDX3,,AUTO
        13 002132   100003 473511                    LDP3    3,X1,PR1
        13 002133   300004 236100                    LDQ     4,,PR3
        13 002134   000033 772000                    QRL     27
        13 002135   200005 474500                    LDP4    @CHARPOS,,AUTO
        13 002136   000000 622006                    EAX2    0,QL
        13 002137   000000 636010                    EAQ     0,X0
        13 002140   000022 772000                    QRL     18
        13 002141   400000 136100                    SBLQ    0,,PR4
        13 002142   400000 235100                    LDA     0,,PR4
        13 002143   000000 623006                    EAX3    0,QL
        13 002144   040145 100540                    MLR     fill='040'O
        13 002145   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
        13 002146   000000 200013                    ADSC9   0,A,PR0                  cn=1,n=*X3

     1250    14489    5                       CHARPOS = CHARPOS + PTR3$ -> P$B.SUBLK$(INDX3) -> P$S.COUNT;

  14489 13 002147   100003 473511                    LDP3    3,X1,PR1
        13 002150   300004 236100                    LDQ     4,,PR3
        13 002151   000033 772000                    QRL     27
        13 002152   400000 036100                    ADLQ    0,,PR4
        13 002153   400000 756100                    STQ     0,,PR4

     1251    14490    5                       IF INDX3 < END3
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:226  

  14490 13 002154   200010 236100                    LDQ     INDX3,,AUTO
        13 002155   200017 116100                    CMPQ    END3,,AUTO
        13 002156   002174 605000 13                 TPL     s:14495

     1252    14491    6                       THEN DO;

     1253    14492    6                           CALL INSERT(TEXTC.TEXT, CHARPOS,, DELIM);

  14492 13 002157   000100 101500                    MRL     fill='000'O
        13 002160   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002161   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 002162   200020 220100                    LDX0    END3+1,,AUTO
        13 002163   000000 636010                    EAQ     0,X0
        13 002164   000022 772000                    QRL     18
        13 002165   400000 136100                    SBLQ    0,,PR4
        13 002166   400000 235100                    LDA     0,,PR4
        13 002167   000000 622006                    EAX2    0,QL
        13 002170   040145 100500                    MLR     fill='040'O
        13 002171   200014 000001                    ADSC9   DELIM,,AUTO              cn=0,n=1
        13 002172   000000 200012                    ADSC9   0,A,PR0                  cn=1,n=*X2

     1254    14493    6                           CHARPOS = CHARPOS + 1;

  14493 13 002173   400000 054100                    AOS     0,,PR4

     1255    14494    6                       END;

     1256    14495    5                   END;

  14495 13 002174   200010 054100                    AOS     INDX3,,AUTO
        13 002175   200010 236100                    LDQ     INDX3,,AUTO
        13 002176   200017 116100                    CMPQ    END3,,AUTO
        13 002177   002123 604400 13                 TMOZ    s:14488

     1257    14496    4                   IF INDX2 < END2

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:227  
  14496 13 002200   200007 236100                    LDQ     INDX2,,AUTO
        13 002201   200016 116100                    CMPQ    END2,,AUTO
        13 002202   002222 605000 13                 TPL     s:14501

     1258    14497    5                   THEN DO;

     1259    14498    5                       CALL INSERT(TEXTC.TEXT, CHARPOS,, ',');

  14498 13 002203   200004 470500                    LDP0    @TEXTC,,AUTO
        13 002204   000100 101500                    MRL     fill='000'O
        13 002205   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002206   200020 000002                    ADSC9   END3+1,,AUTO             cn=0,n=2
        13 002207   200020 220100                    LDX0    END3+1,,AUTO
        13 002210   200005 473500                    LDP3    @CHARPOS,,AUTO
        13 002211   000000 636010                    EAQ     0,X0
        13 002212   000022 772000                    QRL     18
        13 002213   300000 136100                    SBLQ    0,,PR3
        13 002214   300000 235100                    LDA     0,,PR3
        13 002215   000000 621006                    EAX1    0,QL
        13 002216   040145 100400                    MLR     fill='040'O
        13 002217   000075 000001 14                 ADSC9   61                       cn=0,n=1
        13 002220   000000 200011                    ADSC9   0,A,PR0                  cn=1,n=*X1

     1260    14499    5                       CHARPOS = CHARPOS + 1;

  14499 13 002221   300000 054100                    AOS     0,,PR3

     1261    14500    5                   END;

     1262    14501    4               END;

  14501 13 002222   200007 054100                    AOS     INDX2,,AUTO
        13 002223   200007 236100                    LDQ     INDX2,,AUTO
        13 002224   200016 116100                    CMPQ    END2,,AUTO
        13 002225   002074 604400 13                 TMOZ    s:14479

     1263    14502    3           END;                        /* Do case ... end */
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:228  

     1264    14503    2           IF CHARPOS > 511

  14503 13 002226   200005 470500                    LDP0    @CHARPOS,,AUTO
        13 002227   000000 235100                    LDA     0,,PR0
        13 002230   000777 115007                    CMPA    511,DL
        13 002231   002235 604400 13                 TMOZ    s:14509

     1265    14504    2           THEN
     1266    14505    3           DO;

     1267    14506    3               CHARPOS = 511;

  14506 13 002232   000777 236007                    LDQ     511,DL
        13 002233   000000 756100                    STQ     0,,PR0

     1268    14507    3               RETURN;

  14507 13 002234   000000 702200 xent               TSX2  ! X66_ARET

     1269    14508    3           END;
     1270    14509    2       END;                            /* Do INDX1 = ... end */

  14509 13 002235   200006 054100                    AOS     INDX1,,AUTO
        13 002236   200006 236100                    LDQ     INDX1,,AUTO
        13 002237   200015 116100                    CMPQ    END1,,AUTO
        13 002240   000012 604400 13                 TMOZ    s:13751

     1271    14510    1       RETURN;

  14510 13 002241   000000 702200 xent               TSX2  ! X66_ARET

VM_CHAR_WHEN
 Sect OctLoc
  11     000   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_BROADCAST
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:229  
 Sect OctLoc
  11     004   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_DELIVERY
 Sect OctLoc
  11     010   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_DELETED
 Sect OctLoc
  11     014   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_ERROR
 Sect OctLoc
  11     020   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_FCOPY
 Sect OctLoc
  11     024   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_FROM
 Sect OctLoc
  11     030   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_MARKED
 Sect OctLoc
  11     034   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_NEW
 Sect OctLoc
  11     040   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_OLD
 Sect OctLoc
  11     044   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_AND
 Sect OctLoc
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:230  
  11     050   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_OR
 Sect OctLoc
  11     054   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_NOT
 Sect OctLoc
  11     060   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_REFERENCE
 Sect OctLoc
  11     064   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_REPLYTO
 Sect OctLoc
  11     070   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_SUBJECT
 Sect OctLoc
  11     074   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_TO
 Sect OctLoc
  11     100   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_FWD
 Sect OctLoc
  11     104   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_ANSWER
 Sect OctLoc
  11     110   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_ACKNOWLEDGMENT
 Sect OctLoc
  11     114   017040 040040   040040 040040   040040 040040   040040 040040    .
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:231  

VM_CHAR_NEXT
 Sect OctLoc
  11     120   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_PREVIOUS
 Sect OctLoc
  11     124   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_UNEXAMINED
 Sect OctLoc
  11     130   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_EXAMINED
 Sect OctLoc
  11     134   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_RR
 Sect OctLoc
  11     140   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_SENT
 Sect OctLoc
  11     144   017040 040040   040040 040040   040040 040040   040040 040040    .

VM_CHAR_RCVD
 Sect OctLoc
  11     150   017040 040040   040040 040040   040040 040040   040040 040040    .

E_CHAR_WHEN
 Sect OctLoc
  12     000   261523 022610                                                    ....

E_CHAR_BROADCAST
 Sect OctLoc
  12     001   261523 022620                                                    ....

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:232  
E_CHAR_DELIVERY
 Sect OctLoc
  12     002   261523 022630                                                    ....

E_CHAR_DELETED
 Sect OctLoc
  12     003   261523 022640                                                    ....

E_CHAR_ERROR
 Sect OctLoc
  12     004   261523 022650                                                    ....

E_CHAR_FCOPY
 Sect OctLoc
  12     005   261523 022660                                                    ....

E_CHAR_FROM
 Sect OctLoc
  12     006   261523 022670                                                    ....

E_CHAR_MARKED
 Sect OctLoc
  12     007   261523 022700                                                    ....

E_CHAR_NEW
 Sect OctLoc
  12     010   261523 022710                                                    ....

E_CHAR_OLD
 Sect OctLoc
  12     011   261523 023070                                                    ...8

E_CHAR_AND
 Sect OctLoc
  12     012   261523 022720                                                    ....

E_CHAR_OR
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:233  
 Sect OctLoc
  12     013   261523 022730                                                    ....

E_CHAR_NOT
 Sect OctLoc
  12     014   261523 022740                                                    ....

E_CHAR_REFERENCE
 Sect OctLoc
  12     015   261523 022760                                                    ....

E_CHAR_REPLYTO
 Sect OctLoc
  12     016   261523 023120                                                    ...P

E_CHAR_SUBJECT
 Sect OctLoc
  12     017   261523 023000                                                    ....

E_CHAR_TO
 Sect OctLoc
  12     020   261523 023010                                                    ....

E_CHAR_FWD
 Sect OctLoc
  12     021   261523 023020                                                    ....

E_CHAR_ANSWER
 Sect OctLoc
  12     022   261523 023030                                                    ....

E_CHAR_ACKNOWLEDGMENT
 Sect OctLoc
  12     023   261523 023040                                                    ...

E_CHAR_NEXT
 Sect OctLoc
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:234  
  12     024   261523 023050                                                    ...(

E_CHAR_PREVIOUS
 Sect OctLoc
  12     025   261523 023060                                                    ...0

E_CHAR_UNEXAMINED
 Sect OctLoc
  12     026   261523 023100                                                    ...@

E_CHAR_EXAMINED
 Sect OctLoc
  12     027   261523 022750                                                    ....

E_CHAR_RR
 Sect OctLoc
  12     030   261523 023110                                                    ...H

E_CHAR_SENT
 Sect OctLoc
  12     031   261523 023130                                                    ...X

E_CHAR_RCVD
 Sect OctLoc
  12     032   261523 023140                                                    ...`

(unnamed)
 Sect OctLoc
  12     033   075047 040040   176075 047040   076075 040040   074075 040040    ='  ~=' >=  <=

(unnamed)
 Sect OctLoc
  14     000   050040 040040   000003 000000   051040 040040   040040 040040    (   ....)
  14     004   000002 000000   000023 006000   000114 006000   000022 006000    .........L......
  14     010   000110 006000   000001 006000   000004 006000   000003 006000    .H..............
  14     014   000014 006000   000002 006000   000010 006000   000004 006000    ................
  14     020   000020 006000   000027 006000   000134 006000   000005 006000    .........\......
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:235  
  14     024   000024 006000   000021 006000   000104 006000   000007 006000    .........D......
  14     030   000034 006000   000010 006000   000040 006000   000024 006000    ......... ......
  14     034   000120 006000   000025 006000   000124 006000   000011 006000    .P.......T......
  14     040   000044 006000   000026 006000   000130 006000   000012 006000    .$.......X......
  14     044   000050 006000   000013 006000   000054 006000   000014 006000    .(.......,......
  14     050   000060 006000   000030 006000   000140 006000   000006 006000    .0.......`......
  14     054   000030 006000   000015 006000   000064 006000   000016 006000    .........4......
  14     060   000070 006000   000017 006000   000074 006000   000020 006000    .8.......<......
  14     064   000100 006000   047040 040040   000031 006000   000144 006000    .@..'   .....d..
  14     070   000032 006000   000150 006000   075040 040040   076040 040040    .....h..=   >
  14     074   074040 040040   054040 040040                                    <   ,
     1272    14511    1   END VMS$FMT_EXP;

PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:236  
--  Include file information  --

   XU_SUBS_C.:LIB_E05  is referenced.
   XU_MACRO_C.:LIB_E05  is referenced.
   VM_PERR_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMS$FMT_EXP.
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:237  

 **** Variables and constants ****

  ****  Section 011  Data  VMS$FMT_EXP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   114-0-0/c STRC(144)   r     1 VM_CHAR_ACKNOWLEDGMENT
    50-0-0/c STRC(144)   r     1 VM_CHAR_AND              110-0-0/c STRC(144)   r     1 VM_CHAR_ANSWER
     4-0-0/c STRC(144)   r     1 VM_CHAR_BROADCAST         14-0-0/c STRC(144)   r     1 VM_CHAR_DELETED
    10-0-0/c STRC(144)   r     1 VM_CHAR_DELIVERY          20-0-0/c STRC(144)   r     1 VM_CHAR_ERROR
   134-0-0/c STRC(144)   r     1 VM_CHAR_EXAMINED          24-0-0/c STRC(144)   r     1 VM_CHAR_FCOPY
    30-0-0/c STRC(144)   r     1 VM_CHAR_FROM             104-0-0/c STRC(144)   r     1 VM_CHAR_FWD
    34-0-0/c STRC(144)   r     1 VM_CHAR_MARKED            40-0-0/c STRC(144)   r     1 VM_CHAR_NEW
   120-0-0/c STRC(144)   r     1 VM_CHAR_NEXT              60-0-0/c STRC(144)   r     1 VM_CHAR_NOT
    44-0-0/c STRC(144)   r     1 VM_CHAR_OLD               54-0-0/c STRC(144)   r     1 VM_CHAR_OR
   124-0-0/c STRC(144)   r     1 VM_CHAR_PREVIOUS         150-0-0/c STRC(144)   r     1 VM_CHAR_RCVD
    64-0-0/c STRC(144)   r     1 VM_CHAR_REFERENCE         70-0-0/c STRC(144)   r     1 VM_CHAR_REPLYTO
   140-0-0/c STRC(144)   r     1 VM_CHAR_RR               144-0-0/c STRC(144)   r     1 VM_CHAR_SENT
    74-0-0/c STRC(144)   r     1 VM_CHAR_SUBJECT          100-0-0/c STRC(144)   r     1 VM_CHAR_TO
   130-0-0/c STRC(144)   r     1 VM_CHAR_UNEXAMINED         0-0-0/c STRC(144)         1 VM_CHAR_WHEN

  ****  Section 012 RoData VMS$FMT_EXP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    23-0-0/w STRC        r     1 E_CHAR_ACKNOWLEDGMENT
    12-0-0/w STRC        r     1 E_CHAR_AND                22-0-0/w STRC        r     1 E_CHAR_ANSWER
     1-0-0/w STRC        r     1 E_CHAR_BROADCAST           3-0-0/w STRC        r     1 E_CHAR_DELETED
     2-0-0/w STRC        r     1 E_CHAR_DELIVERY            4-0-0/w STRC        r     1 E_CHAR_ERROR
    27-0-0/w STRC        r     1 E_CHAR_EXAMINED            5-0-0/w STRC        r     1 E_CHAR_FCOPY
     6-0-0/w STRC        r     1 E_CHAR_FROM               21-0-0/w STRC        r     1 E_CHAR_FWD
     7-0-0/w STRC        r     1 E_CHAR_MARKED             10-0-0/w STRC        r     1 E_CHAR_NEW
    24-0-0/w STRC        r     1 E_CHAR_NEXT               14-0-0/w STRC        r     1 E_CHAR_NOT
    11-0-0/w STRC        r     1 E_CHAR_OLD                13-0-0/w STRC        r     1 E_CHAR_OR
    25-0-0/w STRC        r     1 E_CHAR_PREVIOUS           32-0-0/w STRC        r     1 E_CHAR_RCVD
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:238  
    15-0-0/w STRC        r     1 E_CHAR_REFERENCE          16-0-0/w STRC        r     1 E_CHAR_REPLYTO
    30-0-0/w STRC        r     1 E_CHAR_RR                 31-0-0/w STRC        r     1 E_CHAR_SENT
    17-0-0/w STRC        r     1 E_CHAR_SUBJECT            20-0-0/w STRC        r     1 E_CHAR_TO
    26-0-0/w STRC        r     1 E_CHAR_UNEXAMINED          0-0-0/w STRC              1 E_CHAR_WHEN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @CHARPOS                   4-0-0/w PTR         r     1 @TEXTC
     3-0-0/w PTR         r     1 @TREE$                    *0-0-0/w SBIN        r     1 CHARPOS
    14-0-0/c CHAR        r     1 DELIM                     15-0-0/w SBIN        r     1 END1
    16-0-0/w SBIN        r     1 END2                      17-0-0/w SBIN        r     1 END3
     6-0-0/w SBIN        r     1 INDX1                      7-0-0/w SBIN        r     1 INDX2
    10-0-0/w SBIN        r     1 INDX3                     11-0-0/w PTR         r     1 PTR1$
    12-0-0/w PTR         r     1 PTR2$                     13-0-0/w PTR         r     1 PTR3$
    *0-0-0/c ASTR(9)     r     1 TEXTC                     *0-0-0/w PTR         r     1 TREE$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR               1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/w UBIN              1 M$DO_NUM
     0-0-0/w UBIN              1 M$LO_NUM                   0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM
     0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM        0-0-0/w UBIN              1 M$MAIL_FILE_NUM
     0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM          0-0-0/w UBIN              1 M$ME_NUM
     0-0-0/w UBIN              1 M$NODE_NUM                 0-0-0/w UBIN              1 M$SI_NUM
     0-0-0/w UBIN              1 M$WORK_NUM                 0-0-0/w PTR               1 VM_ADDLIST$
     0-0-0/d VECT              1 VM_ADDLIST_                0-0-0/w PTR               1 VM_ADDREC$
     0-0-0/d VECT              1 VM_ADDREC_                 0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:239  
     0-0-0/w PTR               1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)          1 VM_MAIL_ACCT
     0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$MAIL_CENTRAL             0-0-0N  NULL        r     1 M$MAIL_COMGROUP
     0-0-0N  NULL        r     1 M$MAIL_FILE                0-0-0N  NULL        r     1 M$MAIL_GLOBAL
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$NODE
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC
     0-0-0N  NULL        r     1 M$WORK                     0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S                        0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMS$FMT_EXP requires 1186 words for executable code.
   Procedure VMS$FMT_EXP requires 20 words of local(AUTO) storage.

    No errors detected in file VMS$SELECT.:VMB6TSI    .
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:240  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:241  
          MINI XREF LISTING

CHARPOS
     11577**DCL        17--PROC    13754>>CALLBLT 13755<<ASSIGN  13755>>ASSIGN  13756<>CALL    13757>>CALLBLT
     13758<<ASSIGN  13758>>ASSIGN  13784>>ASSIGN  13785<<ASSIGN  13785>>ASSIGN  13810>>ASSIGN  13811<<ASSIGN
     13811>>ASSIGN  13836>>ASSIGN  13837<<ASSIGN  13837>>ASSIGN  13862>>ASSIGN  13863<<ASSIGN  13863>>ASSIGN
     13888>>ASSIGN  13889<<ASSIGN  13889>>ASSIGN  13914>>ASSIGN  13915<<ASSIGN  13915>>ASSIGN  13940>>ASSIGN
     13941<<ASSIGN  13941>>ASSIGN  13966>>ASSIGN  13967<<ASSIGN  13967>>ASSIGN  13992>>ASSIGN  13993<<ASSIGN
     13993>>ASSIGN  14018>>ASSIGN  14019<<ASSIGN  14019>>ASSIGN  14044>>ASSIGN  14045<<ASSIGN  14045>>ASSIGN
     14070>>ASSIGN  14071<<ASSIGN  14071>>ASSIGN  14096>>ASSIGN  14097<<ASSIGN  14097>>ASSIGN  14122>>ASSIGN
     14123<<ASSIGN  14123>>ASSIGN  14148>>ASSIGN  14149<<ASSIGN  14149>>ASSIGN  14174>>ASSIGN  14175<<ASSIGN
     14175>>ASSIGN  14200>>ASSIGN  14201<<ASSIGN  14201>>ASSIGN  14226>>ASSIGN  14227<<ASSIGN  14227>>ASSIGN
     14252>>ASSIGN  14253<<ASSIGN  14253>>ASSIGN  14278>>CALLBLT 14279<<ASSIGN  14279>>ASSIGN  14305>>CALLBLT
     14306<<ASSIGN  14306>>ASSIGN  14332>>CALLBLT 14333<<ASSIGN  14333>>ASSIGN  14359>>CALLBLT 14360<<ASSIGN
     14360>>ASSIGN  14386>>CALLBLT 14387<<ASSIGN  14387>>ASSIGN  14391>>CALLBLT 14392<<ASSIGN  14392>>ASSIGN
     14394>>CALLBLT 14395<<ASSIGN  14395>>ASSIGN  14398>>CALLBLT 14399<<ASSIGN  14399>>ASSIGN  14400>>CALLBLT
     14401<<ASSIGN  14401>>ASSIGN  14426>>CALLBLT 14427<<ASSIGN  14427>>ASSIGN  14453>>CALLBLT 14454<<ASSIGN
     14454>>ASSIGN  14458>>CALLBLT 14459<<ASSIGN  14459>>ASSIGN  14461>>CALLBLT 14462<<ASSIGN  14462>>ASSIGN
     14464>>CALLBLT 14465<<ASSIGN  14465>>ASSIGN  14467>>CALLBLT 14468<<ASSIGN  14468>>ASSIGN  14470>>CALLBLT
     14471<<ASSIGN  14471>>ASSIGN  14473>>CALLBLT 14474<<ASSIGN  14474>>ASSIGN  14488>>CALLBLT 14489<<ASSIGN
     14489>>ASSIGN  14492>>CALLBLT 14493<<ASSIGN  14493>>ASSIGN  14498>>CALLBLT 14499<<ASSIGN  14499>>ASSIGN
     14503>>IF      14506<<ASSIGN
CMPR_DATE
     14454**LABEL   14428--GOTO
CMPR_STR
     14387**LABEL   14280--GOTO    14307--GOTO    14334--GOTO    14361--GOTO
DELIM
     11608**DCL     14482<<ASSIGN  14484<<ASSIGN  14492>>CALLBLT
END1
     11609**DCL     13749<<ASSIGN  13750>>DOINDEX
END2
     11610**DCL     14477<<ASSIGN  14478>>DOINDEX 14496>>IF
END3
     11611**DCL     14486<<ASSIGN  14487>>DOINDEX 14490>>IF
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:242  
ERRMSG_FID.L#
      7922**DCL      7922--IMP-SIZ
E_CHAR_ACKNOWLEDGMENT
     13180**DCL     13770<>CALL
E_CHAR_AND
     12496**DCL     14160<>CALL
E_CHAR_ANSWER
     13104**DCL     13796<>CALL
E_CHAR_BROADCAST
     11812**DCL     13822<>CALL
E_CHAR_DELETED
     11964**DCL     13848<>CALL
E_CHAR_DELIVERY
     11888**DCL     13874<>CALL
E_CHAR_ERROR
     12040**DCL     13900<>CALL
E_CHAR_EXAMINED
     13484**DCL     13926<>CALL
E_CHAR_FCOPY
     12116**DCL     13952<>CALL
E_CHAR_FROM
     12192**DCL     14264<>CALL
E_CHAR_FWD
     13028**DCL     13978<>CALL
E_CHAR_MARKED
     12268**DCL     14004<>CALL
E_CHAR_NEW
     12344**DCL     14030<>CALL
E_CHAR_NEXT
     13256**DCL     14056<>CALL
E_CHAR_NOT
     12648**DCL     14212<>CALL
E_CHAR_OLD
     12420**DCL     14108<>CALL
E_CHAR_OR
     12572**DCL     14186<>CALL
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:243  
E_CHAR_PREVIOUS
     13332**DCL     14082<>CALL
E_CHAR_RCVD
     13712**DCL     14439<>CALL
E_CHAR_REFERENCE
     12724**DCL     14291<>CALL
E_CHAR_REPLYTO
     12800**DCL     14318<>CALL
E_CHAR_RR
     13560**DCL     14238<>CALL
E_CHAR_SENT
     13636**DCL     14412<>CALL
E_CHAR_SUBJECT
     12876**DCL     14345<>CALL
E_CHAR_TO
     12952**DCL     14372<>CALL
E_CHAR_UNEXAMINED
     13408**DCL     14134<>CALL
INDX1
     11602**DCL     13750<<DOINDEX 13751>>ASSIGN
INDX2
     11603**DCL     14478<<DOINDEX 14479>>ASSIGN  14496>>IF
INDX3
     11604**DCL     14487<<DOINDEX 14488>>CALLBLT 14488>>CALLBLT 14489>>ASSIGN  14490>>IF
P$B.CODE
     11627**DCL     13752>>DOCASE  14389>>DOCASE  14456>>DOCASE  14480>>DOCASE
P$B.NSUBLKS
     11631**DCL     13749>>ASSIGN  14477>>ASSIGN  14486>>ASSIGN
P$B.SUBLK$
     11652**DCL     13751>>ASSIGN  14389>>DOCASE  14397>>ASSIGN  14397>>ASSIGN  14456>>DOCASE  14476>>ASSIGN
     14476>>ASSIGN  14479>>ASSIGN  14488>>CALLBLT 14488>>CALLBLT 14489>>ASSIGN
P$S.COUNT
     11688**DCL     11691--IMP-SIZ 14398>>CALLBLT 14399>>ASSIGN  14488>>CALLBLT 14489>>ASSIGN
P$S.TEXT
     11691**DCL     14398>>CALLBLT 14488>>CALLBLT
PTR1$
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:244  
     11605**DCL     13751<<ASSIGN  13752>>DOCASE  13756<>CALL    14389>>DOCASE  14397>>ASSIGN  14456>>DOCASE
     14476>>ASSIGN
PTR2$
     11606**DCL     14397<<ASSIGN  14398>>CALLBLT 14398>>CALLBLT 14399>>ASSIGN  14476<<ASSIGN  14477>>ASSIGN
     14479>>ASSIGN
PTR3$
     11607**DCL     14479<<ASSIGN  14480>>DOCASE  14486>>ASSIGN  14488>>CALLBLT 14488>>CALLBLT 14489>>ASSIGN
TEXTC
     11573**DCL        17--PROC    13756<>CALL
TEXTC.SIZ
     11574**DCL     11575--IMP-SIZ 13754>>CALLBLT 13756>>CALL    13757>>CALLBLT 13784>>ASSIGN  13810>>ASSIGN
     13836>>ASSIGN  13862>>ASSIGN  13888>>ASSIGN  13914>>ASSIGN  13940>>ASSIGN  13966>>ASSIGN  13992>>ASSIGN
     14018>>ASSIGN  14044>>ASSIGN  14070>>ASSIGN  14096>>ASSIGN  14122>>ASSIGN  14148>>ASSIGN  14174>>ASSIGN
     14200>>ASSIGN  14226>>ASSIGN  14252>>ASSIGN  14278>>CALLBLT 14305>>CALLBLT 14332>>CALLBLT 14359>>CALLBLT
     14386>>CALLBLT 14391>>CALLBLT 14394>>CALLBLT 14398>>CALLBLT 14400>>CALLBLT 14426>>CALLBLT 14453>>CALLBLT
     14458>>CALLBLT 14461>>CALLBLT 14464>>CALLBLT 14467>>CALLBLT 14470>>CALLBLT 14473>>CALLBLT 14488>>CALLBLT
     14492>>CALLBLT 14498>>CALLBLT
TEXTC.TEXT
     11575**DCL     13754<<CALLBLT 13757<<CALLBLT 13784<<ASSIGN  13810<<ASSIGN  13836<<ASSIGN  13862<<ASSIGN
     13888<<ASSIGN  13914<<ASSIGN  13940<<ASSIGN  13966<<ASSIGN  13992<<ASSIGN  14018<<ASSIGN  14044<<ASSIGN
     14070<<ASSIGN  14096<<ASSIGN  14122<<ASSIGN  14148<<ASSIGN  14174<<ASSIGN  14200<<ASSIGN  14226<<ASSIGN
     14252<<ASSIGN  14278<<CALLBLT 14305<<CALLBLT 14332<<CALLBLT 14359<<CALLBLT 14386<<CALLBLT 14391<<CALLBLT
     14394<<CALLBLT 14398<<CALLBLT 14400<<CALLBLT 14426<<CALLBLT 14453<<CALLBLT 14458<<CALLBLT 14461<<CALLBLT
     14464<<CALLBLT 14467<<CALLBLT 14470<<CALLBLT 14473<<CALLBLT 14488<<CALLBLT 14492<<CALLBLT 14498<<CALLBLT
TREE$
     11571**DCL        17--PROC    13749>>ASSIGN  13751>>ASSIGN
VMD$ERRMSG
     11581**DCL-ENT 13770--CALL    13796--CALL    13822--CALL    13848--CALL    13874--CALL    13900--CALL
     13926--CALL    13952--CALL    13978--CALL    14004--CALL    14030--CALL    14056--CALL    14082--CALL
     14108--CALL    14134--CALL    14160--CALL    14186--CALL    14212--CALL    14238--CALL    14264--CALL
     14291--CALL    14318--CALL    14345--CALL    14372--CALL    14412--CALL    14439--CALL
VMS$FMT_EXP
        17**PROC    13756--CALL
VM_CHAR_ACKNOWLEDGMENT
     13165**DCL     13770<>CALL
VM_CHAR_ACKNOWLEDGMENT.L#
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:245  
     13165**DCL     13785>>ASSIGN
VM_CHAR_ACKNOWLEDGMENT.NAME#
     13165**DCL     13768>>IF      13784>>ASSIGN
VM_CHAR_AND
     12481**DCL     14160<>CALL
VM_CHAR_AND.L#
     12481**DCL     14175>>ASSIGN
VM_CHAR_AND.NAME#
     12481**DCL     14158>>IF      14174>>ASSIGN
VM_CHAR_ANSWER
     13089**DCL     13796<>CALL
VM_CHAR_ANSWER.L#
     13089**DCL     13811>>ASSIGN
VM_CHAR_ANSWER.NAME#
     13089**DCL     13794>>IF      13810>>ASSIGN
VM_CHAR_BROADCAST
     11797**DCL     13822<>CALL
VM_CHAR_BROADCAST.L#
     11797**DCL     13837>>ASSIGN
VM_CHAR_BROADCAST.NAME#
     11797**DCL     13820>>IF      13836>>ASSIGN
VM_CHAR_DELETED
     11949**DCL     13848<>CALL
VM_CHAR_DELETED.L#
     11949**DCL     13863>>ASSIGN
VM_CHAR_DELETED.NAME#
     11949**DCL     13846>>IF      13862>>ASSIGN
VM_CHAR_DELIVERY
     11873**DCL     13874<>CALL
VM_CHAR_DELIVERY.L#
     11873**DCL     13889>>ASSIGN
VM_CHAR_DELIVERY.NAME#
     11873**DCL     13872>>IF      13888>>ASSIGN
VM_CHAR_ERROR
     12025**DCL     13900<>CALL
VM_CHAR_ERROR.L#
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:246  
     12025**DCL     13915>>ASSIGN
VM_CHAR_ERROR.NAME#
     12025**DCL     13898>>IF      13914>>ASSIGN
VM_CHAR_EXAMINED
     13469**DCL     13926<>CALL
VM_CHAR_EXAMINED.L#
     13469**DCL     13941>>ASSIGN
VM_CHAR_EXAMINED.NAME#
     13469**DCL     13924>>IF      13940>>ASSIGN
VM_CHAR_FCOPY
     12101**DCL     13952<>CALL
VM_CHAR_FCOPY.L#
     12101**DCL     13967>>ASSIGN
VM_CHAR_FCOPY.NAME#
     12101**DCL     13950>>IF      13966>>ASSIGN
VM_CHAR_FROM
     12177**DCL     14264<>CALL
VM_CHAR_FROM.L#
     12177**DCL     14278>>CALLBLT 14279>>ASSIGN
VM_CHAR_FROM.NAME#
     12177**DCL     14262>>IF      14278>>CALLBLT
VM_CHAR_FWD
     13013**DCL     13978<>CALL
VM_CHAR_FWD.L#
     13013**DCL     13993>>ASSIGN
VM_CHAR_FWD.NAME#
     13013**DCL     13976>>IF      13992>>ASSIGN
VM_CHAR_MARKED
     12253**DCL     14004<>CALL
VM_CHAR_MARKED.L#
     12253**DCL     14019>>ASSIGN
VM_CHAR_MARKED.NAME#
     12253**DCL     14002>>IF      14018>>ASSIGN
VM_CHAR_NEW
     12329**DCL     14030<>CALL
VM_CHAR_NEW.L#
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:247  
     12329**DCL     14045>>ASSIGN
VM_CHAR_NEW.NAME#
     12329**DCL     14028>>IF      14044>>ASSIGN
VM_CHAR_NEXT
     13241**DCL     14056<>CALL
VM_CHAR_NEXT.L#
     13241**DCL     14071>>ASSIGN
VM_CHAR_NEXT.NAME#
     13241**DCL     14054>>IF      14070>>ASSIGN
VM_CHAR_NOT
     12633**DCL     14212<>CALL
VM_CHAR_NOT.L#
     12633**DCL     14227>>ASSIGN
VM_CHAR_NOT.NAME#
     12633**DCL     14210>>IF      14226>>ASSIGN
VM_CHAR_OLD
     12405**DCL     14108<>CALL
VM_CHAR_OLD.L#
     12405**DCL     14123>>ASSIGN
VM_CHAR_OLD.NAME#
     12405**DCL     14106>>IF      14122>>ASSIGN
VM_CHAR_OR
     12557**DCL     14186<>CALL
VM_CHAR_OR.L#
     12557**DCL     14201>>ASSIGN
VM_CHAR_OR.NAME#
     12557**DCL     14184>>IF      14200>>ASSIGN
VM_CHAR_PREVIOUS
     13317**DCL     14082<>CALL
VM_CHAR_PREVIOUS.L#
     13317**DCL     14097>>ASSIGN
VM_CHAR_PREVIOUS.NAME#
     13317**DCL     14080>>IF      14096>>ASSIGN
VM_CHAR_RCVD
     13697**DCL     14439<>CALL
VM_CHAR_RCVD.L#
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:248  
     13697**DCL     14453>>CALLBLT 14454>>ASSIGN
VM_CHAR_RCVD.NAME#
     13697**DCL     14437>>IF      14453>>CALLBLT
VM_CHAR_REFERENCE
     12709**DCL     14291<>CALL
VM_CHAR_REFERENCE.L#
     12709**DCL     14305>>CALLBLT 14306>>ASSIGN
VM_CHAR_REFERENCE.NAME#
     12709**DCL     14289>>IF      14305>>CALLBLT
VM_CHAR_REPLYTO
     12785**DCL     14318<>CALL
VM_CHAR_REPLYTO.L#
     12785**DCL     14332>>CALLBLT 14333>>ASSIGN
VM_CHAR_REPLYTO.NAME#
     12785**DCL     14316>>IF      14332>>CALLBLT
VM_CHAR_RR
     13545**DCL     14238<>CALL
VM_CHAR_RR.L#
     13545**DCL     14253>>ASSIGN
VM_CHAR_RR.NAME#
     13545**DCL     14236>>IF      14252>>ASSIGN
VM_CHAR_SENT
     13621**DCL     14412<>CALL
VM_CHAR_SENT.L#
     13621**DCL     14426>>CALLBLT 14427>>ASSIGN
VM_CHAR_SENT.NAME#
     13621**DCL     14410>>IF      14426>>CALLBLT
VM_CHAR_SUBJECT
     12861**DCL     14345<>CALL
VM_CHAR_SUBJECT.L#
     12861**DCL     14359>>CALLBLT 14360>>ASSIGN
VM_CHAR_SUBJECT.NAME#
     12861**DCL     14343>>IF      14359>>CALLBLT
VM_CHAR_TO
     12937**DCL     14372<>CALL
VM_CHAR_TO.L#
PL6.E3A0      #004=VMS$FMT_EXP File=VMS$SELECT.:VMB6TSI                          WED 08/20/97 15:25 Page:249  
     12937**DCL     14386>>CALLBLT 14387>>ASSIGN
VM_CHAR_TO.NAME#
     12937**DCL     14370>>IF      14386>>CALLBLT
VM_CHAR_UNEXAMINED
     13393**DCL     14134<>CALL
VM_CHAR_UNEXAMINED.L#
     13393**DCL     14149>>ASSIGN
VM_CHAR_UNEXAMINED.NAME#
     13393**DCL     14132>>IF      14148>>ASSIGN
X$STRING.SIZ
      7768**DCL      7769--IMP-SIZ
