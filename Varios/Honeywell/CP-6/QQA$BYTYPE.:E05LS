VERSION E05

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:1    
        1        1        /*M* QQA$BYTYPE - Translate TYPE to QT_FORM */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$BYTYPE
        9        9             PURPOSE:     To translate a load-by-type type into a QT_FORM
       10       10        */
       11       11        /*D* NAME:        QQA$BYTYPE
       12       12             CALL:        CALL QQA$BYTYPE(STA$,QT_FORM,TYPE,ERR) ALTRET(LBL);
       13       13             INPUT:       STA$ - Pointer to the station's TP$STATION block
       14       14                          TYPE - The type to find a QT$FORM TRADER record for
       15       15             OUTPUT:      QT_FORM - Filled in with TYPE's QT$FORM record
       16       16                          ERR     - The %FPERR_xxx error if QQA$BYTYPE ALTRETs
       17       17             DESCRIPTION: The BEGIN and DEBUG commands, as well as the FPL
       18       18                          LOAD-BY-TYPE command require translation of a type
       19       19                          into a TRADER QT$FORM record which contains the
       20       20                          requested rununit's NAME, ACCT, PASSWORD and PSN.
       21       21                          This procedure provides that service.
       22       22
       23       23                          If all is successful, QQA$BYTYPE will RETURN with
       24       24                          QT_FORM filled in.
       25       25
       26       26                          If all is not successful, we create a message and
       27       27                          write it to both the station requesting this service
       28       28                          and the MCT. We also stuff ERR with an appropriate
       29       29                          %FPERR_xxx and then ALTRETURN.
       30       30
       31       31                          Forms program security adds the only comp-
       32       32                          lications to this module.  The scheme for
       33       33                          access controls is as follows.  The eight
       34       34                          character device name that the TP station
       35       35                          connected with is used as an account against
       36       36                          which normal file management access control
       37       37                          checks are made (NOTE: this check is meaningless
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:2    
       38       38                          for devices created with the new SUPER DEVICE
       39       39                          syntax  CR TP acct,stationname where both acct and
       40       40                          stationname are specified). The checks are made by the
       41       41                          file management system when the test M$OPEN
       42       42                          is performed.  To force file management to
       43       43                          do the checking for us we insert the eight
       44       44                          character device name into B$JIT.ACCN of TPA
       45       45                          and do a M$SETFMA.  The M$SETFMA only serves
       46       46                          the following purpose.  It resets some bits
       47       47                          in the JIT which tell file management that
       48       48                          it must not take the 'short cut' through
       49       49                          opens for this guy.
       50       50        */
       51       51        %EJECT;
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:3    
       52       52        QQA$BYTYPE: PROC(STA$,QT_FORM,TYPE,ERR) ALTRET;
       53       53        %INCLUDE Q_PAGE_C;
       54       85        %SET LISTEXP = '1'B;
       55       86        %PAGE(ARG="Includes");

               103        /***************************************************************************
               104         *                                                                         *
               105         *                                  Includes                               *
               106         *                                                                         *
               107         ***************************************************************************/

       56      111        %INCLUDE CP_6;
       57      192        %INCLUDE QQ_MACROS_C;
       58      617        %INCLUDE QQ_DATA_R;
       59      863        %INCLUDE QQ_SUBS_C;
       60     1055        %INCLUDE B$JIT;
       61     1345        %INCLUDE B_ERRORS_C;
       62     2472        %INCLUDE QQ_PERR_C;
       63     2633        %INCLUDE Q_ERRCODE_C;
       64     2656        %INCLUDE QT_MACROS_C;
       65     2814        %PAGE(ARG="Parameters");

              2831    1   /***************************************************************************
              2832    1    *                                                                         *
              2833    1    *                                 Parameters                              *
              2834    1    *                                                                         *
              2835    1    ***************************************************************************/

       66     2839    1   DCL STA$ PTR;
       67     2840        %QT$FORM(FPTN=QT_FORM, STCLASS=PARAM);
       68     2879    1   DCL ERR UBIN;
       69     2880        %PAGE(ARG="EQUs");

              2897    1   /***************************************************************************
              2898    1    *                                                                         *
              2899    1    *                                    EQUs                                 *
              2900    1    *                                                                         *
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:4    
              2901    1    ***************************************************************************/

       70     2905        %FPERR;
       71     2911    1   DCL TYPE CHAR(8);
       72     2912        %PAGE(ARG="Externally defined routines");

              2929    1   /***************************************************************************
              2930    1    *                                                                         *
              2931    1    *                        Externally defined routines                      *
              2932    1    *                                                                         *
              2933    1    ***************************************************************************/

       73     2937    1   DCL QQC$BLDMSG ENTRY(1);
       74     2938    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       75     2939    1   DCL QQC$SCREECH ENTRY;
       76     2940    1   DCL QQC$DISAB_CHK ENTRY(2) ALTRET;
       77     2941        %PAGE(ARG="Symrefs");

              2958    1   /***************************************************************************
              2959    1    *                                                                         *
              2960    1    *                                  Symrefs                                *
              2961    1    *                                                                         *
              2962    1    ***************************************************************************/

       78     2966    1   DCL B$TCB$ PTR SYMREF;
       79     2967    1   DCL B$JIT$ PTR SYMREF;
       80     2968        %PAGE(ARG="DCBs");

              2985    1   /***************************************************************************
              2986    1    *                                                                         *
              2987    1    *                                    DCBs                                 *
              2988    1    *                                                                         *
              2989    1    ***************************************************************************/

       81     2993    1   DCL M$CG DCB;
       82     2994    1   DCL M$TRADER DCB;
       83     2995    1   DCL M$FPRG DCB;
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:5    
       84     2996        %PAGE(ARG="Based");

              3013    1   /***************************************************************************
              3014    1    *                                                                         *
              3015    1    *                                   Based                                 *
              3016    1    *                                                                         *
              3017    1    ***************************************************************************/

       85     3021        %B$TCB;
       86     3024        %B$ALT;
       87     3032        %TP$STATION;
       88     3105        %PAGE(ARG="Static");

              3122    1   /***************************************************************************
              3123    1    *                                                                         *
              3124    1    *                                   Static                                *
              3125    1    *                                                                         *
              3126    1    ***************************************************************************/

       89     3130    1   DCL 1 KEY STATIC,
       90     3131    1         2 COUNT UBIN(9) UNAL INIT(10),
       91     3132    1         2 MSGTYP CHAR(8),
       92     3133    1         2 SUFFIX CHAR(2) INIT('_F');
       93     3134    1   DCL UNFID_SIZE UBIN WORD STATIC;
       94     3135    1   DCL FID CHAR(100) STATIC;
       95     3136        %PAGE(ARG="Constants");

              3153    1   /***************************************************************************
              3154    1    *                                                                         *
              3155    1    *                                 Constants                               *
              3156    1    *                                                                         *
              3157    1    ***************************************************************************/

       96     3161        %PAGE(ARG="Auto");

              3178    1   /***************************************************************************
              3179    1    *                                                                         *
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:6    
              3180    1    *                                    Auto                                 *
              3181    1    *                                                                         *
              3182    1    ***************************************************************************/

       97     3186    1   DCL TYP CHAR(8);
       98     3187    1   DCL COMMAND_FP_FLAG BIT(1) ALIGNED;
       99     3188
      100     3189        %MSGBLK;
      101     3279        %VLP_NAME(FPTN=TEXTC_STATION, STCLASS=AUTO, LEN=8);
      102     3306        %VLP_NAME(FPTN=TEXTC_MSGTYP, STCLASS=AUTO, LEN=8);
      103     3333        %VLP_NAME(FPTN=TEXTC_FID, STCLASS=AUTO, LEN=100);
      104     3360        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:7    
              3377    1   /***************************************************************************
              3378    1    *                                                                         *
              3379    1    *                                Error codes                              *
              3380    1    *                                                                         *
              3381    1    ***************************************************************************/

      105     3385        %ERRCODE(NAME=CODE_UTLCFP, CODE#=%E$UTLCFP, FCG#=%FCG_QQ, MID#=%MID_A);
      106     3392        %ERRCODE(NAME=CODE_UTLFP, CODE#=%E$UTLFP, FCG#=%FCG_QQ, MID#=%MID_A);
      107     3399        %ERRCODE(NAME=CODE_UFT, CODE#=%E$UFT, FCG#=%FCG_QQ, MID#=%MID_A);
      108     3406        %ERRCODE(NAME=CODE_DISF, CODE#=%E$DISF, FCG#=%FCG_QQ, MID#=%MID_A);
      109     3413        /*E*       ERROR: QQA-E$UTLCFP-C
      110     3414                 MESSAGE: Unable to load the Command Forms Program
      111     3415                          for station %U1.
      112     3416             DESCRIPTION: For the reason which follows we were unable
      113     3417                          to load the command forms program for this
      114     3418                          station.  The station has been disconnected.
      115     3419        */
      116     3420        /*E*       ERROR: QQA-E$UTLFP-C
      117     3421                 MESSAGE: Unable to load a Forms Program
      118     3422                          for station %U1. %Msgtyp %U2.%
      119     3423                          %File name is %U3.%
      120     3424             DESCRIPTION: For the reason which follows we were unable
      121     3425                          to load a forms program for this
      122     3426                          station.
      123     3427        */
      124     3428        /*E*       ERROR: QQA-E$UFT-C
      125     3429                 MESSAGE: Form is not defined in TRADER file
      126     3430             DESCRIPTION: This form type is unknown to TRADER.  A altret
      127     3431                          of E$NOKEY specified from a read of TRADER.
      128     3432        */
      129     3433        /*E*       ERROR: QQA-E$DISF-C
      130     3434                 MESSAGE: Form %U1 has been disabled
      131     3435             DESCRIPTION: The form has been disabled by use of the DISABLE
      132     3436                          command.
      133     3437        */
      134     3438        %PAGE(ARG="FPTs",PAGE=YES);

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:8    
              3455    1   /***************************************************************************
              3456    1    *                                                                         *
              3457    1    *                                    FPTs                                 *
              3458    1    *                                                                         *
              3459    1    ***************************************************************************/

      135     3463        %FPT_READ(DCB=M$TRADER, KEYS=YES, KEY=KEY);
      136     3502        %FPT_ACTIVATE(FPTN=FPT_DEACTIVATE, DCB=M$CG, DISCONNECT=YES);
      137     3525        %FPT_OPEN(DCB=M$FPRG,ASN=FILE,FUN=IN,SCRUB=YES,TEST=YES,
      138     3526                  NAME=VLP_NAME,ACCT=VLP_ACCT,PASS=VLP_PASS,SN=VLP_SN);
      139     3635        %FPT_UNFID(TEXTFID=FID, NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS,
      140     3636        ASN="FPT_OPEN.V.ASN#", SN=VLP_SN, WSN=VLP_WSN,
      141     3637        RES="FPT_OPEN.V.RES#", LEN=UNFID_SIZE);
      142     3655        %FPT_SETFMA;
      143     3668        %PAGE(ARG="VLPs");

              3685    1   /***************************************************************************
              3686    1    *                                                                         *
              3687    1    *                                    VLPs                                 *
              3688    1    *                                                                         *
              3689    1    ***************************************************************************/

      144     3693        %VLP_NAME;
      145     3720        %VLP_ACCT;
      146     3733        %VLP_PASS;
      147     3746        %VLP_SN;
      148     3759        %VLP_WSN;
      149     3772        %PAGE(ARG="QQA$BYTYPE",PAGE=YES);

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:9    
              3789    1   /***************************************************************************
              3790    1    *                                                                         *
              3791    1    *                                 QQA$BYTYPE                              *
              3792    1    *                                                                         *
              3793    1    ***************************************************************************/

      150     3797    1           S$ = STA$;
      151     3798    1           COMMAND_FP_FLAG = '0'B;
      152     3799    1           QQ_GLOBAL.FPREQ_CNT = QQ_GLOBAL.FPREQ_CNT + 1;
      153     3800    1           ERR = 0;
      154     3801    1           FPT_SETFMA.ACCT_ = VECTOR(B$JIT.FACCN);
      155     3802    1           FPT_SETFMA.PSN_ = VECTOR(B$JIT.FPSN);
      156     3803    1           IF TYPE = '*DFLT' THEN
      157     3804    2             DO;
      158     3805    2               IF TP$STATION.DFLT_FP = '*DFLT' THEN
      159     3806    3                 DO;
      160     3807    3                   QT_FORM.FP.ACCT = QQ_GLOBAL.CFP_RU.ACCT;
      161     3808    3                   QT_FORM.FP.NAME = QQ_GLOBAL.CFP_RU.NAME;
      162     3809    3                   QT_FORM.FP.PASS = QQ_GLOBAL.CFP_RU.PASS;
      163     3810    3                   QT_FORM.FP.SN   = QQ_GLOBAL.CFP_RU.PSN;
      164     3811    3                   TP$STATION.PEND_FP='*DFLT';
      165     3812    3                   RETURN;
      166     3813    3                 END;
      167     3814    2               ELSE
      168     3815    2                 TYP = TP$STATION.DFLT_FP;
      169     3816    2               COMMAND_FP_FLAG = '1'B;
      170     3817    2             END;
      171     3818    1           ELSE
      172     3819    1             TYP = TYPE;
      173     3820    2           CALL QQC$DISAB_CHK(TYP, 2 /* OPT_FP */) WHENALTRETURN DO;
      174     3821    2               ERR = 3;
      175     3822    2               GOTO ERR_OUT;
      176     3823    2             END;
      177     3824    1           KEY.MSGTYP = TYP;
      178     3825    1           FPT_READ.BUF_ = VECTOR(QT_FORM);
      179     3826    2           CALL M$READ(FPT_READ) WHENALTRETURN DO;
      180     3827    2               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 66 /* E$NOKEY */ THEN
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:10   
      181     3828    3                 DO;
      182     3829    3                   ERR = 2;
      183     3830    3                   GOTO ERR_OUT;
      184     3831    3                 END;
      185     3832    2               GOTO MON_ERR;
      186     3833    2             END;
      187     3834    1           IF QT_FORM.FP.ACCT = ' '
      188     3835    1           THEN QT_FORM.FP.ACCT = QQ_GLOBAL.INSTANCE_NAME;
      189     3836    1           VLP_NAME.L# = QT_FORM.FP.NAME.COUNT;
      190     3837    1           VLP_NAME.NAME# = QT_FORM.FP.NAME.TEXT;
      191     3838    1           VLP_ACCT.ACCT# = QT_FORM.FP.ACCT;
      192     3839    1           VLP_PASS.PASS# = QT_FORM.FP.PASS;
      193     3840    1           VLP_SN.SN#(0) = QT_FORM.FP.SN;
      194     3841    1           B$JIT.ACCN = TP$STATION.ID;
      195     3842    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(MON_ERR);
      196     3843    1           CALL M$OPEN(FPT_OPEN) ALTRET(ERR_OUT);
      197     3844    1           B$JIT.ACCN = QQ_GLOBAL.INSTANCE_NAME;
      198     3845    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(MON_ERR);
      199     3846    1           TP$STATION.PEND_FP = TYP;
      200     3847    1           RETURN;
      201     3848                %PAGE(ARG="Error processing");

              3865    1   /***************************************************************************
              3866    1    *                                                                         *
              3867    1    *                              Error processing                           *
              3868    1    *                                                                         *
              3869    1    ***************************************************************************/

      202     3873    1   ERR_OUT: ;
      203     3874    1           B$JIT.ACCN = QQ_GLOBAL.INSTANCE_NAME;
      204     3875    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(MON_ERR);
      205     3876    1           IF ERR=0
      206     3877    1           THEN ERR=1;
      207     3878    1           IF COMMAND_FP_FLAG THEN
      208     3879    2             DO;
      209     3880    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      210     3881    2               MSGBLK.ERRINFO.ERR(0) = CODE_UTLCFP;
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:11   
      211     3882    2               MSGBLK.ERRINFO.ERR(1) = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      212     3883    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      213     3884    2               TEXTC_STATION.L# = 8;
      214     3885    2               TEXTC_STATION.NAME# = TP$STATION.ID;
      215     3886    2               CALL QQC$BLDMSG(MSGBLK);
      216     3887    2               FPT_DEACTIVATE.STATION_ = VECTOR(TP$STATION.ID);
      217     3888    3               CALL M$DEACTIVATE(FPT_DEACTIVATE) WHENALTRETURN DO;
      218     3889    3                   IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */
      219     3890    3                   THEN GOTO MON_ERR;
      220     3891    3                 END;
      221     3892    2             END;
      222     3893    2           ELSE DO;
      223     3894    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);
      224     3895    2               IF TP$STATION.DFLT_FP = '*DFLT' OR
      225     3896    2                   (TP$STATION.FP = '(name)' AND TP$STATION.FPLDTRC$ = ADDR(NIL)) THEN
      226     3897    2                 MSGBLK.FLAGS.DEST.STATION = '1'B;
      227     3898    2               MSGBLK.ID = TP$STATION.ID;
      228     3899    2               MSGBLK.ERRINFO.ERR(0) = CODE_UTLFP;
      229     3900    3               DO CASE(ERR);
      230     3901    3                 CASE(1 /* Not authorized */);
      231     3902
      232     3903    3                   VLP_NAME.L# = QT_FORM.FP.NAME.COUNT;
      233     3904    3                   VLP_NAME.NAME# = QT_FORM.FP.NAME.TEXT;
      234     3905    3                   VLP_ACCT.ACCT# = QT_FORM.FP.ACCT;
      235     3906    3                   VLP_PASS.PASS# = QT_FORM.FP.PASS;
      236     3907    3                   VLP_SN.SN#(0) = QT_FORM.FP.SN;
      237     3908    3                   CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);
      238     3909    3                   TEXTC_FID.L# = UNFID_SIZE;
      239     3910    3                   TEXTC_FID.NAME# = FID;
      240     3911    3                   MSGBLK.ERRINFO.FIELD3(0) = VECTOR(TEXTC_FID);
      241     3912    3                   MSGBLK.ERRINFO.ERR(1) = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      242     3913    3                   ERR = BITBIN(B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR); /* FPL       */
      243     3914
      244     3915    3                 CASE(2 /* Unknown form type */);
      245     3916
      246     3917    3                   MSGBLK.ERRINFO.ERR(1) = CODE_UFT;
      247     3918    3                   ERR = BITBIN(CODE_UFT); /* send FPL appropriate code          */
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:12   
      248     3919
      249     3920    3                 CASE(3 /* form disabled */);
      250     3921
      251     3922    3                   MSGBLK.ERRINFO.ERR(1) = CODE_DISF;
      252     3923    3                   ERR = BITBIN(CODE_DISF); /* send FPL error code               */
      253     3924    3                   MSGBLK.ERRINFO.FIELD1(1) = VECTOR(TEXTC_MSGTYP);
      254     3925
      255     3926    3               END;                        /* Case                               */
      256     3927    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);
      257     3928    2               TEXTC_STATION.L# = 8;
      258     3929    2               TEXTC_STATION.NAME# = TP$STATION.ID;
      259     3930    2               TEXTC_MSGTYP.L# = 8;
      260     3931    2               TEXTC_MSGTYP.NAME# = TYP;
      261     3932    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_MSGTYP);
      262     3933    2               CALL QQC$BLDMSG(MSGBLK);
      263     3934    2             END;
      264     3935    1           ALTRETURN;
      265     3936    1   MON_ERR:
      266     3937    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      267     3938    1           B$JIT.ACCN = QQ_GLOBAL.INSTANCE_NAME;
      268     3939    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(SCR);
      269     3940    1   SCR:    CALL QQC$SCREECH;
      270     3941    1   END QQA$BYTYPE;

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:13   
--  Include file information  --

   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$BYTYPE.

   Procedure QQA$BYTYPE requires 346 words for executable code.
   Procedure QQA$BYTYPE requires 68 words of local(AUTO) storage.

    No errors detected in file QQA$BYTYPE.:E05TSI    .

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:14   

 Object Unit name= QQA$BYTYPE                                 File name= QQA$BYTYPE.:E05TOU
 UTS= JUL 30 '97 05:20:25.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2   DCB   even  none     0      0  M$TRADER
    3   DCB   even  none     0      0  M$FPRG
    4   Data  even  none   162    242  QQA$BYTYPE
    5  RoData even  UTS      8     10  QQA$BYTYPE
    6   Proc  even  none   346    532  QQA$BYTYPE
    7  RoData even  none     6      6  QQA$BYTYPE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes    yes     yes      Std        4  QQA$BYTYPE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 QQC$DISAB_CHK
         yes           Std       1 QQC$BLDMSG
         yes           Std       0 QQC$SCREECH
         yes           Std       1 QQC$BLDMSG_ERRBLK
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:15   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_GLOBAL                             B$TCB$
     B$JIT$                                M$CG                                  M$TRADER
     M$FPRG                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:16   


        1        1        /*M* QQA$BYTYPE - Translate TYPE to QT_FORM */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQA$BYTYPE
        9        9             PURPOSE:     To translate a load-by-type type into a QT_FORM
       10       10        */
       11       11        /*D* NAME:        QQA$BYTYPE
       12       12             CALL:        CALL QQA$BYTYPE(STA$,QT_FORM,TYPE,ERR) ALTRET(LBL);
       13       13             INPUT:       STA$ - Pointer to the station's TP$STATION block
       14       14                          TYPE - The type to find a QT$FORM TRADER record for
       15       15             OUTPUT:      QT_FORM - Filled in with TYPE's QT$FORM record
       16       16                          ERR     - The %FPERR_xxx error if QQA$BYTYPE ALTRETs
       17       17             DESCRIPTION: The BEGIN and DEBUG commands, as well as the FPL
       18       18                          LOAD-BY-TYPE command require translation of a type
       19       19                          into a TRADER QT$FORM record which contains the
       20       20                          requested rununit's NAME, ACCT, PASSWORD and PSN.
       21       21                          This procedure provides that service.
       22       22
       23       23                          If all is successful, QQA$BYTYPE will RETURN with
       24       24                          QT_FORM filled in.
       25       25
       26       26                          If all is not successful, we create a message and
       27       27                          write it to both the station requesting this service
       28       28                          and the MCT. We also stuff ERR with an appropriate
       29       29                          %FPERR_xxx and then ALTRETURN.
       30       30
       31       31                          Forms program security adds the only comp-
       32       32                          lications to this module.  The scheme for
       33       33                          access controls is as follows.  The eight
       34       34                          character device name that the TP station
       35       35                          connected with is used as an account against
       36       36                          which normal file management access control
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:17   
       37       37                          checks are made (NOTE: this check is meaningless
       38       38                          for devices created with the new SUPER DEVICE
       39       39                          syntax  CR TP acct,stationname where both acct and
       40       40                          stationname are specified). The checks are made by the
       41       41                          file management system when the test M$OPEN
       42       42                          is performed.  To force file management to
       43       43                          do the checking for us we insert the eight
       44       44                          character device name into B$JIT.ACCN of TPA
       45       45                          and do a M$SETFMA.  The M$SETFMA only serves
       46       46                          the following purpose.  It resets some bits
       47       47                          in the JIT which tell file management that
       48       48                          it must not take the 'short cut' through
       49       49                          opens for this guy.
       50       50        */
       51       51        %EJECT;
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:18   
       52       52        QQA$BYTYPE: PROC(STA$,QT_FORM,TYPE,ERR) ALTRET;

     52  6 000000   000000 700200 xent  QQA$BYTYPE   TSX0  ! X66_AUTO_4
         6 000001   000104 000004                    ZERO    68,4

       53       53        %INCLUDE Q_PAGE_C;
       54       85        %SET LISTEXP = '1'B;
       55       86        %PAGE(ARG="Includes");

               103        /***************************************************************************
               104         *                                                                         *
               105         *                                  Includes                               *
               106         *                                                                         *
               107         ***************************************************************************/

       56      111        %INCLUDE CP_6;
       57      192        %INCLUDE QQ_MACROS_C;
       58      617        %INCLUDE QQ_DATA_R;
       59      863        %INCLUDE QQ_SUBS_C;
       60     1055        %INCLUDE B$JIT;
       61     1345        %INCLUDE B_ERRORS_C;
       62     2472        %INCLUDE QQ_PERR_C;
       63     2633        %INCLUDE Q_ERRCODE_C;
       64     2656        %INCLUDE QT_MACROS_C;
       65     2814        %PAGE(ARG="Parameters");

              2831    1   /***************************************************************************
              2832    1    *                                                                         *
              2833    1    *                                 Parameters                              *
              2834    1    *                                                                         *
              2835    1    ***************************************************************************/

       66     2839    1   DCL STA$ PTR;
       67     2840        %QT$FORM(FPTN=QT_FORM, STCLASS=PARAM);
       68     2879    1   DCL ERR UBIN;
       69     2880        %PAGE(ARG="EQUs");

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:19   
              2897    1   /***************************************************************************
              2898    1    *                                                                         *
              2899    1    *                                    EQUs                                 *
              2900    1    *                                                                         *
              2901    1    ***************************************************************************/

       70     2905        %FPERR;
       71     2911    1   DCL TYPE CHAR(8);
       72     2912        %PAGE(ARG="Externally defined routines");

              2929    1   /***************************************************************************
              2930    1    *                                                                         *
              2931    1    *                        Externally defined routines                      *
              2932    1    *                                                                         *
              2933    1    ***************************************************************************/

       73     2937    1   DCL QQC$BLDMSG ENTRY(1);
       74     2938    1   DCL QQC$BLDMSG_ERRBLK ENTRY(1);
       75     2939    1   DCL QQC$SCREECH ENTRY;
       76     2940    1   DCL QQC$DISAB_CHK ENTRY(2) ALTRET;
       77     2941        %PAGE(ARG="Symrefs");

              2958    1   /***************************************************************************
              2959    1    *                                                                         *
              2960    1    *                                  Symrefs                                *
              2961    1    *                                                                         *
              2962    1    ***************************************************************************/

       78     2966    1   DCL B$TCB$ PTR SYMREF;
       79     2967    1   DCL B$JIT$ PTR SYMREF;
       80     2968        %PAGE(ARG="DCBs");

              2985    1   /***************************************************************************
              2986    1    *                                                                         *
              2987    1    *                                    DCBs                                 *
              2988    1    *                                                                         *
              2989    1    ***************************************************************************/
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:20   

       81     2993    1   DCL M$CG DCB;
       82     2994    1   DCL M$TRADER DCB;
       83     2995    1   DCL M$FPRG DCB;
       84     2996        %PAGE(ARG="Based");

              3013    1   /***************************************************************************
              3014    1    *                                                                         *
              3015    1    *                                   Based                                 *
              3016    1    *                                                                         *
              3017    1    ***************************************************************************/

       85     3021        %B$TCB;
       86     3024        %B$ALT;
       87     3032        %TP$STATION;
       88     3105        %PAGE(ARG="Static");

              3122    1   /***************************************************************************
              3123    1    *                                                                         *
              3124    1    *                                   Static                                *
              3125    1    *                                                                         *
              3126    1    ***************************************************************************/

       89     3130    1   DCL 1 KEY STATIC,
       90     3131    1         2 COUNT UBIN(9) UNAL INIT(10),
       91     3132    1         2 MSGTYP CHAR(8),
       92     3133    1         2 SUFFIX CHAR(2) INIT('_F');
       93     3134    1   DCL UNFID_SIZE UBIN WORD STATIC;
       94     3135    1   DCL FID CHAR(100) STATIC;
       95     3136        %PAGE(ARG="Constants");

              3153    1   /***************************************************************************
              3154    1    *                                                                         *
              3155    1    *                                 Constants                               *
              3156    1    *                                                                         *
              3157    1    ***************************************************************************/

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:21   
       96     3161        %PAGE(ARG="Auto");

              3178    1   /***************************************************************************
              3179    1    *                                                                         *
              3180    1    *                                    Auto                                 *
              3181    1    *                                                                         *
              3182    1    ***************************************************************************/

       97     3186    1   DCL TYP CHAR(8);
       98     3187    1   DCL COMMAND_FP_FLAG BIT(1) ALIGNED;
       99     3188
      100     3189        %MSGBLK;
      101     3279        %VLP_NAME(FPTN=TEXTC_STATION, STCLASS=AUTO, LEN=8);
      102     3306        %VLP_NAME(FPTN=TEXTC_MSGTYP, STCLASS=AUTO, LEN=8);
      103     3333        %VLP_NAME(FPTN=TEXTC_FID, STCLASS=AUTO, LEN=100);
      104     3360        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:22   
              3377    1   /***************************************************************************
              3378    1    *                                                                         *
              3379    1    *                                Error codes                              *
              3380    1    *                                                                         *
              3381    1    ***************************************************************************/

      105     3385        %ERRCODE(NAME=CODE_UTLCFP, CODE#=%E$UTLCFP, FCG#=%FCG_QQ, MID#=%MID_A);
      106     3392        %ERRCODE(NAME=CODE_UTLFP, CODE#=%E$UTLFP, FCG#=%FCG_QQ, MID#=%MID_A);
      107     3399        %ERRCODE(NAME=CODE_UFT, CODE#=%E$UFT, FCG#=%FCG_QQ, MID#=%MID_A);
      108     3406        %ERRCODE(NAME=CODE_DISF, CODE#=%E$DISF, FCG#=%FCG_QQ, MID#=%MID_A);
      109     3413        /*E*       ERROR: QQA-E$UTLCFP-C
      110     3414                 MESSAGE: Unable to load the Command Forms Program
      111     3415                          for station %U1.
      112     3416             DESCRIPTION: For the reason which follows we were unable
      113     3417                          to load the command forms program for this
      114     3418                          station.  The station has been disconnected.
      115     3419        */
      116     3420        /*E*       ERROR: QQA-E$UTLFP-C
      117     3421                 MESSAGE: Unable to load a Forms Program
      118     3422                          for station %U1. %Msgtyp %U2.%
      119     3423                          %File name is %U3.%
      120     3424             DESCRIPTION: For the reason which follows we were unable
      121     3425                          to load a forms program for this
      122     3426                          station.
      123     3427        */
      124     3428        /*E*       ERROR: QQA-E$UFT-C
      125     3429                 MESSAGE: Form is not defined in TRADER file
      126     3430             DESCRIPTION: This form type is unknown to TRADER.  A altret
      127     3431                          of E$NOKEY specified from a read of TRADER.
      128     3432        */
      129     3433        /*E*       ERROR: QQA-E$DISF-C
      130     3434                 MESSAGE: Form %U1 has been disabled
      131     3435             DESCRIPTION: The form has been disabled by use of the DISABLE
      132     3436                          command.
      133     3437        */
      134     3438        %PAGE(ARG="FPTs",PAGE=YES);

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:23   
              3455    1   /***************************************************************************
              3456    1    *                                                                         *
              3457    1    *                                    FPTs                                 *
              3458    1    *                                                                         *
              3459    1    ***************************************************************************/

      135     3463        %FPT_READ(DCB=M$TRADER, KEYS=YES, KEY=KEY);
      136     3502        %FPT_ACTIVATE(FPTN=FPT_DEACTIVATE, DCB=M$CG, DISCONNECT=YES);
      137     3525        %FPT_OPEN(DCB=M$FPRG,ASN=FILE,FUN=IN,SCRUB=YES,TEST=YES,
      138     3526                  NAME=VLP_NAME,ACCT=VLP_ACCT,PASS=VLP_PASS,SN=VLP_SN);
      139     3635        %FPT_UNFID(TEXTFID=FID, NAME=VLP_NAME, ACCT=VLP_ACCT, PASS=VLP_PASS,
      140     3636        ASN="FPT_OPEN.V.ASN#", SN=VLP_SN, WSN=VLP_WSN,
      141     3637        RES="FPT_OPEN.V.RES#", LEN=UNFID_SIZE);
      142     3655        %FPT_SETFMA;
      143     3668        %PAGE(ARG="VLPs");

              3685    1   /***************************************************************************
              3686    1    *                                                                         *
              3687    1    *                                    VLPs                                 *
              3688    1    *                                                                         *
              3689    1    ***************************************************************************/

      144     3693        %VLP_NAME;
      145     3720        %VLP_ACCT;
      146     3733        %VLP_PASS;
      147     3746        %VLP_SN;
      148     3759        %VLP_WSN;
      149     3772        %PAGE(ARG="QQA$BYTYPE",PAGE=YES);

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:24   
              3789    1   /***************************************************************************
              3790    1    *                                                                         *
              3791    1    *                                 QQA$BYTYPE                              *
              3792    1    *                                                                         *
              3793    1    ***************************************************************************/

      150     3797    1           S$ = STA$;

   3797  6 000002   200003 470500                    LDP0    @STA$,,AUTO
         6 000003   000000 236100                    LDQ     0,,PR0
         6 000004   200007 756100                    STQ     S$,,AUTO

      151     3798    1           COMMAND_FP_FLAG = '0'B;

   3798  6 000005   200012 450100                    STZ     COMMAND_FP_FLAG,,AUTO

      152     3799    1           QQ_GLOBAL.FPREQ_CNT = QQ_GLOBAL.FPREQ_CNT + 1;

   3799  6 000006   000041 235000 xsym               LDA     QQ_GLOBAL+33
         6 000007   000001 035007                    ADLA    1,DL
         6 000010   000041 755000 xsym               STA     QQ_GLOBAL+33

      153     3800    1           ERR = 0;

   3800  6 000011   200006 471500                    LDP1    @ERR,,AUTO
         6 000012   100000 450100                    STZ     0,,PR1

      154     3801    1           FPT_SETFMA.ACCT_ = VECTOR(B$JIT.FACCN);

   3801  6 000013   000000 235000 7                  LDA     0
         6 000014   000000 236000 xsym               LDQ     B$JIT$
         6 000015   000006 036003                    ADLQ    6,DU
         6 000016   000214 757000 4                  STAQ    FPT_SETFMA

      155     3802    1           FPT_SETFMA.PSN_ = VECTOR(B$JIT.FPSN);

   3802  6 000017   000001 235000 7                  LDA     1
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:25   
         6 000020   000000 236000 xsym               LDQ     B$JIT$
         6 000021   000021 036003                    ADLQ    17,DU
         6 000022   000216 757000 4                  STAQ    FPT_SETFMA+2

      156     3803    1           IF TYPE = '*DFLT' THEN

   3803  6 000023   200005 473500                    LDP3    @TYPE,,AUTO
         6 000024   040000 106500                    CMPC    fill='040'O
         6 000025   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         6 000026   000004 000005 5                  ADSC9   CODE_DISF+1              cn=0,n=5
         6 000027   000064 601000 6                  TNZ     s:3819

      157     3804    2             DO;

      158     3805    2               IF TP$STATION.DFLT_FP = '*DFLT' THEN

   3805  6 000030   200007 474500                    LDP4    S$,,AUTO
         6 000031   040000 106500                    CMPC    fill='040'O
         6 000032   400004 000010                    ADSC9   4,,PR4                   cn=0,n=8
         6 000033   000004 000005 5                  ADSC9   CODE_DISF+1              cn=0,n=5
         6 000034   000056 601000 6                  TNZ     s:3815

      159     3806    3                 DO;

      160     3807    3                   QT_FORM.FP.ACCT = QQ_GLOBAL.CFP_RU.ACCT;

   3807  6 000035   200004 475500                    LDP5    @QT_FORM,,AUTO
         6 000036   040100 100400                    MLR     fill='040'O
         6 000037   000367 000010 xsym               ADSC9   QQ_GLOBAL+247            cn=0,n=8
         6 000040   500012 000010                    ADSC9   10,,PR5                  cn=0,n=8

      161     3808    3                   QT_FORM.FP.NAME = QQ_GLOBAL.CFP_RU.NAME;

   3808  6 000041   000100 100400                    MLR     fill='000'O
         6 000042   000357 000040 xsym               ADSC9   QQ_GLOBAL+239            cn=0,n=32
         6 000043   500002 000040                    ADSC9   2,,PR5                   cn=0,n=32

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:26   
      162     3809    3                   QT_FORM.FP.PASS = QQ_GLOBAL.CFP_RU.PASS;

   3809  6 000044   040100 100400                    MLR     fill='040'O
         6 000045   000371 000010 xsym               ADSC9   QQ_GLOBAL+249            cn=0,n=8
         6 000046   500014 000010                    ADSC9   12,,PR5                  cn=0,n=8

      163     3810    3                   QT_FORM.FP.SN   = QQ_GLOBAL.CFP_RU.PSN;

   3810  6 000047   040100 100400                    MLR     fill='040'O
         6 000050   000373 000006 xsym               ADSC9   QQ_GLOBAL+251            cn=0,n=6
         6 000051   500016 000006                    ADSC9   14,,PR5                  cn=0,n=6

      164     3811    3                   TP$STATION.PEND_FP='*DFLT';

   3811  6 000052   040100 100400                    MLR     fill='040'O
         6 000053   000004 000005 5                  ADSC9   CODE_DISF+1              cn=0,n=5
         6 000054   400006 000010                    ADSC9   6,,PR4                   cn=0,n=8

      165     3812    3                   RETURN;

   3812  6 000055   000000 702200 xent               TSX2  ! X66_ARET

      166     3813    3                 END;
      167     3814    2               ELSE
      168     3815    2                 TYP = TP$STATION.DFLT_FP;

   3815  6 000056   040100 100500                    MLR     fill='040'O
         6 000057   400004 000010                    ADSC9   4,,PR4                   cn=0,n=8
         6 000060   200010 000010                    ADSC9   TYP,,AUTO                cn=0,n=8

      169     3816    2               COMMAND_FP_FLAG = '1'B;

   3816  6 000061   400000 236003                    LDQ     -131072,DU
         6 000062   200012 756100                    STQ     COMMAND_FP_FLAG,,AUTO

      170     3817    2             END;

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:27   
   3817  6 000063   000067 710000 6                  TRA     s:3820

      171     3818    1           ELSE
      172     3819    1             TYP = TYPE;

   3819  6 000064   040100 100500                    MLR     fill='040'O
         6 000065   300000 000010                    ADSC9   0,,PR3                   cn=0,n=8
         6 000066   200010 000010                    ADSC9   TYP,,AUTO                cn=0,n=8

      173     3820    2           CALL QQC$DISAB_CHK(TYP, 2 /* OPT_FP */) WHENALTRETURN DO;

   3820  6 000067   000002 236000 7                  LDQ     2
         6 000070   200101 756100                    STQ     TEXTC_FID+27,,AUTO
         6 000071   200010 634500                    EPPR4   TYP,,AUTO
         6 000072   200100 454500                    STP4    TEXTC_FID+26,,AUTO
         6 000073   200100 630500                    EPPR0   TEXTC_FID+26,,AUTO
         6 000074   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000075   000000 701000 xent               TSX1    QQC$DISAB_CHK
         6 000076   000100 702000 6                  TSX2    s:3821
         6 000077   000104 710000 6                  TRA     s:3824

      174     3821    2               ERR = 3;

   3821  6 000100   000003 235007                    LDA     3,DL
         6 000101   200006 470500                    LDP0    @ERR,,AUTO
         6 000102   000000 755100                    STA     0,,PR0

      175     3822    2               GOTO ERR_OUT;

   3822  6 000103   000212 710000 6                  TRA     ERR_OUT

      176     3823    2             END;
      177     3824    1           KEY.MSGTYP = TYP;

   3824  6 000104   040000 100500                    MLR     fill='040'O
         6 000105   200010 000010                    ADSC9   TYP,,AUTO                cn=0,n=8
         6 000106   000000 200010 4                  ADSC9   KEY                      cn=1,n=8
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:28   

      178     3825    1           FPT_READ.BUF_ = VECTOR(QT_FORM);

   3825  6 000107   000003 235000 7                  LDA     3
         6 000110   200004 236100                    LDQ     @QT_FORM,,AUTO
         6 000111   000042 757000 4                  STAQ    FPT_READ+4

      179     3826    2           CALL M$READ(FPT_READ) WHENALTRETURN DO;

   3826  6 000112   000036 630400 4                  EPPR0   FPT_READ
         6 000113   440000 713400                    CLIMB   alt,read
         6 000114   401400 401760                    pmme    nvectors=4
         6 000115   000117 702000 6                  TSX2    s:3827
         6 000116   000132 710000 6                  TRA     s:3834

      180     3827    2               IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 66 /* E$NOKEY */ THEN

   3827  6 000117   000000 470400 xsym               LDP0    B$TCB$
         6 000120   000000 471500                    LDP1    0,,PR0
         6 000121   100102 236100                    LDQ     66,,PR1
         6 000122   377770 376007                    ANQ     131064,DL
         6 000123   001020 116007                    CMPQ    528,DL
         6 000124   000131 601000 6                  TNZ     s:3832

      181     3828    3                 DO;

      182     3829    3                   ERR = 2;

   3829  6 000125   000002 235007                    LDA     2,DL
         6 000126   200006 473500                    LDP3    @ERR,,AUTO
         6 000127   300000 755100                    STA     0,,PR3

      183     3830    3                   GOTO ERR_OUT;

   3830  6 000130   000212 710000 6                  TRA     ERR_OUT

      184     3831    3                 END;
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:29   
      185     3832    2               GOTO MON_ERR;

   3832  6 000131   000512 710000 6                  TRA     MON_ERR

      186     3833    2             END;
      187     3834    1           IF QT_FORM.FP.ACCT = ' '

   3834  6 000132   200004 470500                    LDP0    @QT_FORM,,AUTO
         6 000133   040000 106500                    CMPC    fill='040'O
         6 000134   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8
         6 000135   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 000136   000142 601000 6                  TNZ     s:3836

      188     3835    1           THEN QT_FORM.FP.ACCT = QQ_GLOBAL.INSTANCE_NAME;

   3835  6 000137   040100 100400                    MLR     fill='040'O
         6 000140   000325 000010 xsym               ADSC9   QQ_GLOBAL+213            cn=0,n=8
         6 000141   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8

      189     3836    1           VLP_NAME.L# = QT_FORM.FP.NAME.COUNT;

   3836  6 000142   000002 236100                    LDQ     2,,PR0
         6 000143   000220 552040 4                  STBQ    VLP_NAME,'40'O

      190     3837    1           VLP_NAME.NAME# = QT_FORM.FP.NAME.TEXT;

   3837  6 000144   040000 100500                    MLR     fill='040'O
         6 000145   000002 200037                    ADSC9   2,,PR0                   cn=1,n=31
         6 000146   000220 200037 4                  ADSC9   VLP_NAME                 cn=1,n=31

      191     3838    1           VLP_ACCT.ACCT# = QT_FORM.FP.ACCT;

   3838  6 000147   040000 100500                    MLR     fill='040'O
         6 000150   000012 000010                    ADSC9   10,,PR0                  cn=0,n=8
         6 000151   000230 000010 4                  ADSC9   VLP_ACCT                 cn=0,n=8

      192     3839    1           VLP_PASS.PASS# = QT_FORM.FP.PASS;
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:30   

   3839  6 000152   040000 100500                    MLR     fill='040'O
         6 000153   000014 000010                    ADSC9   12,,PR0                  cn=0,n=8
         6 000154   000232 000010 4                  ADSC9   VLP_PASS                 cn=0,n=8

      193     3840    1           VLP_SN.SN#(0) = QT_FORM.FP.SN;

   3840  6 000155   040000 100500                    MLR     fill='040'O
         6 000156   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
         6 000157   000235 000006 4                  ADSC9   VLP_SN+1                 cn=0,n=6

      194     3841    1           B$JIT.ACCN = TP$STATION.ID;

   3841  6 000160   200007 471500                    LDP1    S$,,AUTO
         6 000161   000000 473400 xsym               LDP3    B$JIT$
         6 000162   040100 100500                    MLR     fill='040'O
         6 000163   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 000164   300001 000010                    ADSC9   1,,PR3                   cn=0,n=8

      195     3842    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(MON_ERR);

   3842  6 000165   000214 630400 4                  EPPR0   FPT_SETFMA
         6 000166   460001 713400                    CLIMB   alt,+24577
         6 000167   400400 401760                    pmme    nvectors=2
         6 000170   000512 702000 6                  TSX2    MON_ERR

      196     3843    1           CALL M$OPEN(FPT_OPEN) ALTRET(ERR_OUT);

   3843  6 000171   000074 630400 4                  EPPR0   FPT_OPEN
         6 000172   450000 713400                    CLIMB   alt,open
         6 000173   410400 401760                    pmme    nvectors=18
         6 000174   000212 702000 6                  TSX2    ERR_OUT

      197     3844    1           B$JIT.ACCN = QQ_GLOBAL.INSTANCE_NAME;

   3844  6 000175   000000 470400 xsym               LDP0    B$JIT$
         6 000176   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:31   
         6 000177   000325 000010 xsym               ADSC9   QQ_GLOBAL+213            cn=0,n=8
         6 000200   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

      198     3845    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(MON_ERR);

   3845  6 000201   000214 630400 4                  EPPR0   FPT_SETFMA
         6 000202   460001 713400                    CLIMB   alt,+24577
         6 000203   400400 401760                    pmme    nvectors=2
         6 000204   000512 702000 6                  TSX2    MON_ERR

      199     3846    1           TP$STATION.PEND_FP = TYP;

   3846  6 000205   200007 470500                    LDP0    S$,,AUTO
         6 000206   200010 237100                    LDAQ    TYP,,AUTO
         6 000207   000006 755100                    STA     6,,PR0
         6 000210   000007 756100                    STQ     7,,PR0

      200     3847    1           RETURN;

   3847  6 000211   000000 702200 xent               TSX2  ! X66_ARET

   3846  6 000212                       ERR_OUT      null
      201     3848                %PAGE(ARG="Error processing");

              3865    1   /***************************************************************************
              3866    1    *                                                                         *
              3867    1    *                              Error processing                           *
              3868    1    *                                                                         *
              3869    1    ***************************************************************************/

      202     3873    1   ERR_OUT: ;
      203     3874    1           B$JIT.ACCN = QQ_GLOBAL.INSTANCE_NAME;

   3874  6 000212   000000 470400 xsym               LDP0    B$JIT$
         6 000213   040100 100400                    MLR     fill='040'O
         6 000214   000325 000010 xsym               ADSC9   QQ_GLOBAL+213            cn=0,n=8
         6 000215   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:32   

      204     3875    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(MON_ERR);

   3875  6 000216   000214 630400 4                  EPPR0   FPT_SETFMA
         6 000217   460001 713400                    CLIMB   alt,+24577
         6 000220   400400 401760                    pmme    nvectors=2
         6 000221   000512 702000 6                  TSX2    MON_ERR

      205     3876    1           IF ERR=0

   3876  6 000222   200006 470500                    LDP0    @ERR,,AUTO
         6 000223   000000 235100                    LDA     0,,PR0
         6 000224   000227 601000 6                  TNZ     s:3878

      206     3877    1           THEN ERR=1;

   3877  6 000225   000001 236007                    LDQ     1,DL
         6 000226   000000 756100                    STQ     0,,PR0

      207     3878    1           IF COMMAND_FP_FLAG THEN

   3878  6 000227   200012 234100                    SZN     COMMAND_FP_FLAG,,AUTO
         6 000230   000311 605000 6                  TPL     s:3894

      208     3879    2             DO;

      209     3880    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3880  6 000231   200013 631500                    EPPR1   MSGBLK,,AUTO
         6 000232   200100 451500                    STP1    TEXTC_FID+26,,AUTO
         6 000233   200100 630500                    EPPR0   TEXTC_FID+26,,AUTO
         6 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000235   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         6 000236   000000 011000                    NOP     0

      210     3881    2               MSGBLK.ERRINFO.ERR(0) = CODE_UTLCFP;

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:33   
   3881  6 000237   000000 236000 5                  LDQ     CODE_UTLCFP
         6 000240   200021 756100                    STQ     MSGBLK+6,,AUTO

      211     3882    2               MSGBLK.ERRINFO.ERR(1) = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   3882  6 000241   000000 470400 xsym               LDP0    B$TCB$
         6 000242   000000 471500                    LDP1    0,,PR0
         6 000243   000100 100500                    MLR     fill='000'O
         6 000244   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         6 000245   200030 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      212     3883    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   3883  6 000246   000004 235000 7                  LDA     4
         6 000247   200100 452500                    STP2    TEXTC_FID+26,,AUTO
         6 000250   200100 236100                    LDQ     TEXTC_FID+26,,AUTO
         6 000251   000040 036003                    ADLQ    32,DU
         6 000252   200102 757100                    STAQ    TEXTC_FID+28,,AUTO
         6 000253   000100 100500                    MLR     fill='000'O
         6 000254   200102 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         6 000255   200022 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      213     3884    2               TEXTC_STATION.L# = 8;

   3884  6 000256   010000 236003                    LDQ     4096,DU
         6 000257   200040 552140                    STBQ    TEXTC_STATION,'40'O,AUTO

      214     3885    2               TEXTC_STATION.NAME# = TP$STATION.ID;

   3885  6 000260   200007 471500                    LDP1    S$,,AUTO
         6 000261   040100 100500                    MLR     fill='040'O
         6 000262   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         6 000263   200040 200010                    ADSC9   TEXTC_STATION,,AUTO      cn=1,n=8

      215     3886    2               CALL QQC$BLDMSG(MSGBLK);

   3886  6 000264   200013 633500                    EPPR3   MSGBLK,,AUTO
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:34   
         6 000265   200100 453500                    STP3    TEXTC_FID+26,,AUTO
         6 000266   200100 630500                    EPPR0   TEXTC_FID+26,,AUTO
         6 000267   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000270   000000 701000 xent               TSX1    QQC$BLDMSG
         6 000271   000000 011000                    NOP     0

      216     3887    2               FPT_DEACTIVATE.STATION_ = VECTOR(TP$STATION.ID);

   3887  6 000272   000000 235000 7                  LDA     0
         6 000273   200007 236100                    LDQ     S$,,AUTO
         6 000274   000056 757000 4                  STAQ    FPT_DEACTIVATE+2

      217     3888    3               CALL M$DEACTIVATE(FPT_DEACTIVATE) WHENALTRETURN DO;

   3888  6 000275   000054 630400 4                  EPPR0   FPT_DEACTIVATE
         6 000276   500001 713400                    CLIMB   alt,+32769
         6 000277   401400 401760                    pmme    nvectors=4
         6 000300   000302 702000 6                  TSX2    s:3889
         6 000301   000310 710000 6                  TRA     s:3892

      218     3889    3                   IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1154 /* E$CGAFNS */

   3889  6 000302   000000 470400 xsym               LDP0    B$TCB$
         6 000303   000000 471500                    LDP1    0,,PR0
         6 000304   100102 236100                    LDQ     66,,PR1
         6 000305   377770 376007                    ANQ     131064,DL
         6 000306   022020 116007                    CMPQ    9232,DL
         6 000307   000512 601000 6                  TNZ     MON_ERR

      219     3890    3                   THEN GOTO MON_ERR;
      220     3891    3                 END;

      221     3892    2             END;

   3892  6 000310   000511 710000 6                  TRA     s:3935

      222     3893    2           ELSE DO;
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:35   

      223     3894    2               CALL QQC$BLDMSG_ERRBLK(MSGBLK);

   3894  6 000311   200013 631500                    EPPR1   MSGBLK,,AUTO
         6 000312   200100 451500                    STP1    TEXTC_FID+26,,AUTO
         6 000313   200100 630500                    EPPR0   TEXTC_FID+26,,AUTO
         6 000314   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000315   000000 701000 xent               TSX1    QQC$BLDMSG_ERRBLK
         6 000316   000000 011000                    NOP     0

      224     3895    2               IF TP$STATION.DFLT_FP = '*DFLT' OR

   3895  6 000317   200007 470500                    LDP0    S$,,AUTO
         6 000320   040000 106500                    CMPC    fill='040'O
         6 000321   000004 000010                    ADSC9   4,,PR0                   cn=0,n=8
         6 000322   000004 000005 5                  ADSC9   CODE_DISF+1              cn=0,n=5
         6 000323   000333 600000 6                  TZE     s:3897
         6 000324   040000 106500                    CMPC    fill='040'O
         6 000325   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8
         6 000326   000006 000006 5                  ADSC9   CODE_DISF+3              cn=0,n=6
         6 000327   000335 601000 6                  TNZ     s:3898
         6 000330   000017 236100                    LDQ     15,,PR0
         6 000331   000001 116000 xsym               CMPQ    B_VECTNIL+1
         6 000332   000335 601000 6                  TNZ     s:3898

      225     3896    2                   (TP$STATION.FP = '(name)' AND TP$STATION.FPLDTRC$ = ADDR(NIL)) THEN
      226     3897    2                 MSGBLK.FLAGS.DEST.STATION = '1'B;

   3897  6 000333   000100 236003                    LDQ     64,DU
         6 000334   200015 256100                    ORSQ    MSGBLK+2,,AUTO

      227     3898    2               MSGBLK.ID = TP$STATION.ID;

   3898  6 000335   040100 100500                    MLR     fill='040'O
         6 000336   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000337   200013 000010                    ADSC9   MSGBLK,,AUTO             cn=0,n=8

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:36   
      228     3899    2               MSGBLK.ERRINFO.ERR(0) = CODE_UTLFP;

   3899  6 000340   000001 236000 5                  LDQ     CODE_UTLFP
         6 000341   200021 756100                    STQ     MSGBLK+6,,AUTO

      229     3900    3               DO CASE(ERR);

   3900  6 000342   200006 471500                    LDP1    @ERR,,AUTO
         6 000343   100000 235100                    LDA     0,,PR1
         6 000344   000004 115007                    CMPA    4,DL
         6 000345   000347 602005 6                  TNC     s:3900+5,AL
         6 000346   000451 710000 6                  TRA     s:3927
         6 000347   000451 710000 6                  TRA     s:3927
         6 000350   000353 710000 6                  TRA     s:3903
         6 000351   000426 710000 6                  TRA     s:3917
         6 000352   000434 710000 6                  TRA     s:3922

      230     3901    3                 CASE(1 /* Not authorized */);

      231     3902
      232     3903    3                   VLP_NAME.L# = QT_FORM.FP.NAME.COUNT;

   3903  6 000353   200004 473500                    LDP3    @QT_FORM,,AUTO
         6 000354   300002 236100                    LDQ     2,,PR3
         6 000355   000220 552040 4                  STBQ    VLP_NAME,'40'O

      233     3904    3                   VLP_NAME.NAME# = QT_FORM.FP.NAME.TEXT;

   3904  6 000356   040000 100500                    MLR     fill='040'O
         6 000357   300002 200037                    ADSC9   2,,PR3                   cn=1,n=31
         6 000360   000220 200037 4                  ADSC9   VLP_NAME                 cn=1,n=31

      234     3905    3                   VLP_ACCT.ACCT# = QT_FORM.FP.ACCT;

   3905  6 000361   040000 100500                    MLR     fill='040'O
         6 000362   300012 000010                    ADSC9   10,,PR3                  cn=0,n=8
         6 000363   000230 000010 4                  ADSC9   VLP_ACCT                 cn=0,n=8
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:37   

      235     3906    3                   VLP_PASS.PASS# = QT_FORM.FP.PASS;

   3906  6 000364   040000 100500                    MLR     fill='040'O
         6 000365   300014 000010                    ADSC9   12,,PR3                  cn=0,n=8
         6 000366   000232 000010 4                  ADSC9   VLP_PASS                 cn=0,n=8

      236     3907    3                   VLP_SN.SN#(0) = QT_FORM.FP.SN;

   3907  6 000367   040000 100500                    MLR     fill='040'O
         6 000370   300016 000006                    ADSC9   14,,PR3                  cn=0,n=6
         6 000371   000235 000006 4                  ADSC9   VLP_SN+1                 cn=0,n=6

      237     3908    3                   CALL M$UNFID(FPT_UNFID) ALTRET(MON_ERR);

   3908  6 000372   000166 630400 4                  EPPR0   FPT_UNFID
         6 000373   420021 713400                    CLIMB   alt,+8209
         6 000374   404400 401760                    pmme    nvectors=10
         6 000375   000512 702000 6                  TSX2    MON_ERR

      238     3909    3                   TEXTC_FID.L# = UNFID_SIZE;

   3909  6 000376   000003 236000 4                  LDQ     UNFID_SIZE
         6 000377   000033 736000                    QLS     27
         6 000400   200046 552140                    STBQ    TEXTC_FID,'40'O,AUTO

      239     3910    3                   TEXTC_FID.NAME# = FID;

   3910  6 000401   040100 100400                    MLR     fill='040'O
         6 000402   000004 000144 4                  ADSC9   FID                      cn=0,n=100
         6 000403   200046 200144                    ADSC9   TEXTC_FID,,AUTO          cn=1,n=100

      240     3911    3                   MSGBLK.ERRINFO.FIELD3(0) = VECTOR(TEXTC_FID);

   3911  6 000404   000005 235000 7                  LDA     5
         6 000405   200100 452500                    STP2    TEXTC_FID+26,,AUTO
         6 000406   200100 236100                    LDQ     TEXTC_FID+26,,AUTO
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:38   
         6 000407   000046 036003                    ADLQ    38,DU
         6 000410   200102 757100                    STAQ    TEXTC_FID+28,,AUTO
         6 000411   000100 100500                    MLR     fill='000'O
         6 000412   200102 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         6 000413   200026 200010                    ADSC9   MSGBLK+11,,AUTO          cn=1,n=8

      241     3912    3                   MSGBLK.ERRINFO.ERR(1) = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   3912  6 000414   000000 470400 xsym               LDP0    B$TCB$
         6 000415   000000 471500                    LDP1    0,,PR0
         6 000416   000100 100500                    MLR     fill='000'O
         6 000417   100102 000004                    ADSC9   66,,PR1                  cn=0,n=4
         6 000420   200030 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      242     3913    3                   ERR = BITBIN(B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR); /* FPL       */

   3913  6 000421   000000 471500                    LDP1    0,,PR0
         6 000422   200006 473500                    LDP3    @ERR,,AUTO
         6 000423   100102 235100                    LDA     66,,PR1
         6 000424   300000 755100                    STA     0,,PR3
         6 000425   000451 710000 6                  TRA     s:3927

      243     3914
      244     3915    3                 CASE(2 /* Unknown form type */);

      245     3916
      246     3917    3                   MSGBLK.ERRINFO.ERR(1) = CODE_UFT;

   3917  6 000426   000100 100400                    MLR     fill='000'O
         6 000427   000002 000004 5                  ADSC9   CODE_UFT                 cn=0,n=4
         6 000430   200030 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      247     3918    3                   ERR = BITBIN(CODE_UFT); /* send FPL appropriate code          */

   3918  6 000431   000002 235000 5                  LDA     CODE_UFT
         6 000432   100000 755100                    STA     0,,PR1
         6 000433   000451 710000 6                  TRA     s:3927
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:39   

      248     3919
      249     3920    3                 CASE(3 /* form disabled */);

      250     3921
      251     3922    3                   MSGBLK.ERRINFO.ERR(1) = CODE_DISF;

   3922  6 000434   000100 100400                    MLR     fill='000'O
         6 000435   000003 000004 5                  ADSC9   CODE_DISF                cn=0,n=4
         6 000436   200030 200004                    ADSC9   MSGBLK+13,,AUTO          cn=1,n=4

      252     3923    3                   ERR = BITBIN(CODE_DISF); /* send FPL error code               */

   3923  6 000437   000003 235000 5                  LDA     CODE_DISF
         6 000440   100000 755100                    STA     0,,PR1

      253     3924    3                   MSGBLK.ERRINFO.FIELD1(1) = VECTOR(TEXTC_MSGTYP);

   3924  6 000441   000004 235000 7                  LDA     4
         6 000442   200100 452500                    STP2    TEXTC_FID+26,,AUTO
         6 000443   200100 236100                    LDQ     TEXTC_FID+26,,AUTO
         6 000444   000043 036003                    ADLQ    35,DU
         6 000445   200102 757100                    STAQ    TEXTC_FID+28,,AUTO
         6 000446   000100 100500                    MLR     fill='000'O
         6 000447   200102 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         6 000450   200031 400010                    ADSC9   MSGBLK+14,,AUTO          cn=2,n=8

      254     3925
      255     3926    3               END;                        /* Case                               */

      256     3927    2               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STATION);

   3927  6 000451   000004 235000 7                  LDA     4
         6 000452   200100 452500                    STP2    TEXTC_FID+26,,AUTO
         6 000453   200100 236100                    LDQ     TEXTC_FID+26,,AUTO
         6 000454   000040 036003                    ADLQ    32,DU
         6 000455   200102 757100                    STAQ    TEXTC_FID+28,,AUTO
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:40   
         6 000456   000100 100500                    MLR     fill='000'O
         6 000457   200102 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         6 000460   200022 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      257     3928    2               TEXTC_STATION.L# = 8;

   3928  6 000461   010000 236003                    LDQ     4096,DU
         6 000462   200040 552140                    STBQ    TEXTC_STATION,'40'O,AUTO

      258     3929    2               TEXTC_STATION.NAME# = TP$STATION.ID;

   3929  6 000463   200007 470500                    LDP0    S$,,AUTO
         6 000464   040100 100500                    MLR     fill='040'O
         6 000465   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 000466   200040 200010                    ADSC9   TEXTC_STATION,,AUTO      cn=1,n=8

      259     3930    2               TEXTC_MSGTYP.L# = 8;

   3930  6 000467   200043 552140                    STBQ    TEXTC_MSGTYP,'40'O,AUTO

      260     3931    2               TEXTC_MSGTYP.NAME# = TYP;

   3931  6 000470   040100 100500                    MLR     fill='040'O
         6 000471   200010 000010                    ADSC9   TYP,,AUTO                cn=0,n=8
         6 000472   200043 200010                    ADSC9   TEXTC_MSGTYP,,AUTO       cn=1,n=8

      261     3932    2               MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_MSGTYP);

   3932  6 000473   000004 235000 7                  LDA     4
         6 000474   200100 452500                    STP2    TEXTC_FID+26,,AUTO
         6 000475   200100 236100                    LDQ     TEXTC_FID+26,,AUTO
         6 000476   000043 036003                    ADLQ    35,DU
         6 000477   200102 757100                    STAQ    TEXTC_FID+28,,AUTO
         6 000500   000100 100500                    MLR     fill='000'O
         6 000501   200102 000010                    ADSC9   TEXTC_FID+28,,AUTO       cn=0,n=8
         6 000502   200024 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:41   
      262     3933    2               CALL QQC$BLDMSG(MSGBLK);

   3933  6 000503   200013 631500                    EPPR1   MSGBLK,,AUTO
         6 000504   200100 451500                    STP1    TEXTC_FID+26,,AUTO
         6 000505   200100 630500                    EPPR0   TEXTC_FID+26,,AUTO
         6 000506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000507   000000 701000 xent               TSX1    QQC$BLDMSG
         6 000510   000000 011000                    NOP     0

      263     3934    2             END;

      264     3935    1           ALTRETURN;

   3935  6 000511   000000 702200 xent               TSX2  ! X66_AALT

      265     3936    1   MON_ERR:
      266     3937    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   3937  6 000512   000000 470400 xsym  MON_ERR      LDP0    B$TCB$
         6 000513   000000 471500                    LDP1    0,,PR0
         6 000514   100102 236100                    LDQ     66,,PR1
         6 000515   000000 756000 xsym               STQ     QQ_GLOBAL

      267     3938    1           B$JIT.ACCN = QQ_GLOBAL.INSTANCE_NAME;

   3938  6 000516   000000 471400 xsym               LDP1    B$JIT$
         6 000517   040100 100400                    MLR     fill='040'O
         6 000520   000325 000010 xsym               ADSC9   QQ_GLOBAL+213            cn=0,n=8
         6 000521   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

      268     3939    1           CALL M$SETFMA(FPT_SETFMA) ALTRET(SCR);

   3939  6 000522   000214 630400 4                  EPPR0   FPT_SETFMA
         6 000523   460001 713400                    CLIMB   alt,+24577
         6 000524   400400 401760                    pmme    nvectors=2
         6 000525   000526 702000 6                  TSX2    SCR

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:42   
      269     3940    1   SCR:    CALL QQC$SCREECH;

   3940  6 000526   000002 631400 xsym  SCR          EPPR1   B_VECTNIL+2
         6 000527   000000 701000 xent               TSX1    QQC$SCREECH
         6 000530   000000 011000                    NOP     0

      270     3941    1   END QQA$BYTYPE;

   3941  6 000531   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:43   
--  Include file information  --

   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQA$BYTYPE.
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:44   

 **** Variables and constants ****

  ****  Section 004  Data  QQA$BYTYPE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/c CHAR(100)   r     1 FID                       54-0-0/d STRC(576)   r     1 FPT_DEACTIVATE
    74-0-0/d STRC(2088)  r     1 FPT_OPEN                  36-0-0/d STRC(504)   r     1 FPT_READ
   214-0-0/d STRC(144)   r     1 FPT_SETFMA               166-0-0/d STRC(792)   r     1 FPT_UNFID
     0-0-0/c STRC(99)    r     1 KEY                        3-0-0/w UBIN        r     1 UNFID_SIZE
   230-0-0/c STRC(72)    r     1 VLP_ACCT                 220-0-0/c STRC(288)   r     1 VLP_NAME
   232-0-0/c STRC(72)    r     1 VLP_PASS                 234-0-0/d STRC(90)    r     1 VLP_SN
   240-0-0/c STRC(72)    r     1 VLP_WSN

  ****  Section 005 RoData QQA$BYTYPE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b STRC        r     1 CODE_DISF                  2-0-0/b STRC        r     1 CODE_UFT
     0-0-0/b STRC        r     1 CODE_UTLCFP                1-0-0/b STRC        r     1 CODE_UTLFP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @ERR                       4-0-0/w PTR         r     1 @QT_FORM
     3-0-0/w PTR         r     1 @STA$                      5-0-0/w PTR         r     1 @TYPE
    12-0-0/w BIT         r     1 COMMAND_FP_FLAG           *0-0-0/w UBIN        r     1 ERR
    13-0-0/w STRC(738)   r     1 MSGBLK                    *0-0-0/w STRC(828)   r     1 QT_FORM
     7-0-0/w PTR         r     1 S$                        *0-0-0/w PTR         r     1 STA$
    46-0-0/c STRC(909)   r     1 TEXTC_FID                 43-0-0/c STRC(81)    r     1 TEXTC_MSGTYP
    40-0-0/c STRC(81)    r     1 TEXTC_STATION             10-0-0/c CHAR(8)     r     1 TYP
    *0-0-0/c CHAR(8)     r     1 TYPE

PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:45   
  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0N  NULL        r     1 M$CG
     0-0-0N  NULL        r     1 M$FPRG                     0-0-0N  NULL        r     1 M$TRADER
     0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQA$BYTYPE requires 346 words for executable code.
   Procedure QQA$BYTYPE requires 68 words of local(AUTO) storage.

    No errors detected in file QQA$BYTYPE.:E05TSI    .
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:46   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:47   
          MINI XREF LISTING

B$ALT.CODE
      3026**DCL      3026--REDEF    3027--REDEF    3027--REDEF
B$ALT.ERR
      3027**DCL      3882>>ASSIGN   3912>>ASSIGN   3913>>ASSIGN   3937>>ASSIGN
B$ALT.ERR.CODE
      3028**DCL      3827>>IF       3889>>IF
B$ALT.ERR.ERR#
      3028**DCL      3028--REDEF
B$ALT.EVID
      3027**DCL      3027--REDEF    3027--REDEF
B$JIT.ACCN
      1069**DCL      3841<<ASSIGN   3844<<ASSIGN   3874<<ASSIGN   3938<<ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      1163**DCL      1163--REDEF
B$JIT.ERR.MID
      1070**DCL      1070--REDEF
B$JIT.FACCN
      1069**DCL      3801--ASSIGN
B$JIT.FPSN
      1150**DCL      3802--ASSIGN
B$JIT.JRESPEAK
      1231**DCL      1232--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1340**DCL      1340--REDEF    1341--REDEF
B$JIT.PNR
      1244**DCL      1244--REDEF
B$JIT.TSLINE
      1338**DCL      1339--REDEF
B$JIT$
      2967**DCL      1064--IMP-PTR  3801>>ASSIGN   3802>>ASSIGN   3841>>ASSIGN   3844>>ASSIGN   3874>>ASSIGN
      3938>>ASSIGN
B$TCB.ALT$
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:48   
      3022**DCL      3827>>IF       3882>>ASSIGN   3889>>IF       3912>>ASSIGN   3913>>ASSIGN   3937>>ASSIGN
B$TCB$
      2966**DCL      3827>>IF       3882>>ASSIGN   3889>>IF       3912>>ASSIGN   3913>>ASSIGN   3937>>ASSIGN
CODE_DISF
      3407**DCL      3922>>ASSIGN   3923>>ASSIGN
CODE_UFT
      3400**DCL      3917>>ASSIGN   3918>>ASSIGN
CODE_UTLCFP
      3386**DCL      3881>>ASSIGN
CODE_UTLFP
      3393**DCL      3899>>ASSIGN
COMMAND_FP_FLAG
      3187**DCL      3798<<ASSIGN   3816<<ASSIGN   3878>>IF
ERR
      2879**DCL        52--PROC     3800<<ASSIGN   3821<<ASSIGN   3829<<ASSIGN   3876>>IF       3877<<ASSIGN
      3900>>DOCASE   3913<<ASSIGN   3918<<ASSIGN   3923<<ASSIGN
ERR_OUT
      3846**LABEL    3822--GOTO     3830--GOTO     3843--CALLALT
FID
      3135**DCL      3648--DCLINIT  3910>>ASSIGN
FPT_DEACTIVATE
      3513**DCL      3888<>CALL
FPT_DEACTIVATE.STATION_
      3513**DCL      3887<<ASSIGN
FPT_DEACTIVATE.V
      3514**DCL      3513--DCLINIT
FPT_DEACTIVATE.V.DVBYTE.REREAD#
      3516**DCL      3516--REDEF
FPT_OPEN
      3591**DCL      3843<>CALL
FPT_OPEN.ACSVEH_
      3593**DCL      3594--REDEF
FPT_OPEN.ALTKEYS_
      3599**DCL      3600--REDEF    3600--REDEF
FPT_OPEN.HDR_
      3598**DCL      3599--REDEF
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:49   
FPT_OPEN.TAB_
      3597**DCL      3598--REDEF
FPT_OPEN.UHL_
      3591**DCL      3592--REDEF    3592--REDEF
FPT_OPEN.V
      3600**DCL      3591--DCLINIT
FPT_OPEN.V.ASN#
      3610**DCL      3651--DCLINIT
FPT_OPEN.V.FSN#
      3631**DCL      3631--REDEF    3631--REDEF
FPT_OPEN.V.RES#
      3615**DCL      3651--DCLINIT
FPT_OPEN.WSN_
      3597**DCL      3597--REDEF
FPT_READ
      3480**DCL      3826<>CALL
FPT_READ.BUF_
      3482**DCL      3825<<ASSIGN
FPT_READ.STATION_
      3483**DCL      3484--REDEF
FPT_READ.V
      3484**DCL      3480--DCLINIT
FPT_READ.V.DVBYTE.REREAD#
      3495**DCL      3495--REDEF
FPT_READ.V.INDX#
      3493**DCL      3493--REDEF
FPT_SETFMA
      3666**DCL      3842<>CALL     3845<>CALL     3875<>CALL     3939<>CALL
FPT_SETFMA.ACCT_
      3666**DCL      3801<<ASSIGN
FPT_SETFMA.PSN_
      3666**DCL      3802<<ASSIGN
FPT_UNFID
      3648**DCL      3908<>CALL
FPT_UNFID.V
      3652**DCL      3648--DCLINIT
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:50   
KEY
      3130**DCL      3480--DCLINIT  3481--DCLINIT
KEY.MSGTYP
      3132**DCL      3824<<ASSIGN
M$DEACTIVATE
       140**DCL-ENT  3888--CALL
M$OPEN
       120**DCL-ENT  3843--CALL
M$READ
       121**DCL-ENT  3826--CALL
M$SETFMA
       120**DCL-ENT  3842--CALL     3845--CALL     3875--CALL     3939--CALL
M$UNFID
       183**DCL-ENT  3908--CALL
MON_ERR
      3937**LABEL    3832--GOTO     3842--CALLALT  3845--CALLALT  3875--CALLALT  3890--GOTO     3908--CALLALT
MSGBLK
      3190**DCL      3880<>CALL     3886<>CALL     3894<>CALL     3933<>CALL
MSGBLK.ERRINFO.ERR
      3268**DCL      3881<<ASSIGN   3882<<ASSIGN   3899<<ASSIGN   3912<<ASSIGN   3917<<ASSIGN   3922<<ASSIGN
MSGBLK.ERRINFO.FIELD1
      3272**DCL      3883<<ASSIGN   3924<<ASSIGN   3927<<ASSIGN
MSGBLK.ERRINFO.FIELD2
      3274**DCL      3932<<ASSIGN
MSGBLK.ERRINFO.FIELD3
      3276**DCL      3911<<ASSIGN
MSGBLK.FLAGS.DEST.STATION
      3232**DCL      3897<<ASSIGN
MSGBLK.ID
      3191**DCL      3898<<ASSIGN
QQC$BLDMSG
      2937**DCL-ENT  3886--CALL     3933--CALL
QQC$BLDMSG_ERRBLK
      2938**DCL-ENT  3880--CALL     3894--CALL
QQC$DISAB_CHK
      2940**DCL-ENT  3820--CALL
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:51   
QQC$SCREECH
      2939**DCL-ENT  3940--CALL
QQ_GLOBAL.CFP_RU.ACCT
       715**DCL      3807>>ASSIGN
QQ_GLOBAL.CFP_RU.NAME
       715**DCL      3808>>ASSIGN
QQ_GLOBAL.CFP_RU.PASS
       715**DCL      3809>>ASSIGN
QQ_GLOBAL.CFP_RU.PSN
       715**DCL      3810>>ASSIGN
QQ_GLOBAL.DS1$_BITS
       637**DCL       637--REDEF
QQ_GLOBAL.DS2$_BITS
       637**DCL       638--REDEF
QQ_GLOBAL.DS3$_BITS
       638**DCL       638--REDEF
QQ_GLOBAL.DS4$_BITS
       638**DCL       639--REDEF
QQ_GLOBAL.ERR
       627**DCL      3937<<ASSIGN
QQ_GLOBAL.FPREQ_CNT
       633**DCL      3799<<ASSIGN   3799>>ASSIGN
QQ_GLOBAL.INSTANCE_NAME
       714**DCL      3835>>ASSIGN   3844>>ASSIGN   3874>>ASSIGN   3938>>ASSIGN
QT_FORM
      2851**DCL        52--PROC     3825--ASSIGN
QT_FORM.FP.ACCT
      2868**DCL      3807<<ASSIGN   3834>>IF       3835<<ASSIGN   3838>>ASSIGN   3905>>ASSIGN
QT_FORM.FP.NAME
      2864**DCL      3808<<ASSIGN
QT_FORM.FP.NAME.COUNT
      2866**DCL      3836>>ASSIGN   3903>>ASSIGN
QT_FORM.FP.NAME.TEXT
      2867**DCL      3837>>ASSIGN   3904>>ASSIGN
QT_FORM.FP.PASS
      2870**DCL      3809<<ASSIGN   3839>>ASSIGN   3906>>ASSIGN
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:52   
QT_FORM.FP.SN
      2872**DCL      3810<<ASSIGN   3840>>ASSIGN   3907>>ASSIGN
S$
      3044**DCL      3046--IMP-PTR  3797<<ASSIGN   3805>>IF       3811>>ASSIGN   3815>>ASSIGN   3841>>ASSIGN
      3846>>ASSIGN   3885>>ASSIGN   3887>>ASSIGN   3895>>IF       3895>>IF       3895>>IF       3898>>ASSIGN
      3929>>ASSIGN
SCR
      3940**LABEL    3939--CALLALT
STA$
      2839**DCL        52--PROC     3797>>ASSIGN
TEXTC_FID
      3358**DCL      3911--ASSIGN
TEXTC_FID.L#
      3358**DCL      3909<<ASSIGN
TEXTC_FID.NAME#
      3358**DCL      3910<<ASSIGN
TEXTC_MSGTYP
      3331**DCL      3924--ASSIGN   3932--ASSIGN
TEXTC_MSGTYP.L#
      3331**DCL      3930<<ASSIGN
TEXTC_MSGTYP.NAME#
      3331**DCL      3931<<ASSIGN
TEXTC_STATION
      3304**DCL      3883--ASSIGN   3927--ASSIGN
TEXTC_STATION.L#
      3304**DCL      3884<<ASSIGN   3928<<ASSIGN
TEXTC_STATION.NAME#
      3304**DCL      3885<<ASSIGN   3929<<ASSIGN
TP$STATION.DFLT_FP
      3051**DCL      3805>>IF       3815>>ASSIGN   3895>>IF
TP$STATION.FP
      3049**DCL      3895>>IF
TP$STATION.FPLDTRC$
      3066**DCL      3895>>IF
TP$STATION.ID
      3047**DCL      3841>>ASSIGN   3885>>ASSIGN   3887--ASSIGN   3898>>ASSIGN   3929>>ASSIGN
PL6.E3A0      #001=QQA$BYTYPE File=QQA$BYTYPE.:E05TSI                            WED 07/30/97 05:20 Page:53   
TP$STATION.PEND_FP
      3053**DCL      3811<<ASSIGN   3846<<ASSIGN
TYP
      3186**DCL      3815<<ASSIGN   3819<<ASSIGN   3820<>CALL     3824>>ASSIGN   3846>>ASSIGN   3931>>ASSIGN
TYPE
      2911**DCL        52--PROC     3803>>IF       3819>>ASSIGN
UNFID_SIZE
      3134**DCL      3652--DCLINIT  3909>>ASSIGN
VLP_ACCT
      3731**DCL      3596--DCLINIT  3649--DCLINIT
VLP_ACCT.ACCT#
      3731**DCL      3838<<ASSIGN   3905<<ASSIGN
VLP_NAME
      3718**DCL      3592--DCLINIT  3649--DCLINIT
VLP_NAME.L#
      3718**DCL      3836<<ASSIGN   3903<<ASSIGN
VLP_NAME.NAME#
      3718**DCL      3837<<ASSIGN   3904<<ASSIGN
VLP_PASS
      3744**DCL      3593--DCLINIT  3650--DCLINIT
VLP_PASS.PASS#
      3744**DCL      3839<<ASSIGN   3906<<ASSIGN
VLP_SN
      3757**DCL      3591--DCLINIT  3650--DCLINIT
VLP_SN.SN#
      3757**DCL      3840<<ASSIGN   3907<<ASSIGN
VLP_WSN
      3770**DCL      3650--DCLINIT
