VERSION E05

PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:1    
        1        1        /*M* KSX$ROUTECON - Main module for ROUTECON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0,MEC,MOC      */
        8        8
        9        9        ROUTECON: PROC MAIN;
       10       10
       11       11        %INCLUDE CP_6;
       12     5570        %INCLUDE B$JIT;
       13     6173        %INCLUDE XU_MACRO_C;
       14     9279        %INCLUDE KL_MACRO_C;
       15    12631        %INCLUDE B_ERRORS_C;
       16    13758        %INCLUDE KSX_NODES_E;
       17    13798        %INCLUDE KS_PERR_C;
       18    13865
       19    13866    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
       20    13867    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       21    13868    1   DCL XUR$SETERRMSG ENTRY(1) ALTRET;
       22    13869    1   DCL XUR$BREAK ENTRY ASYNC;
       23    13870    1   DCL XUR$INIT ENTRY(3) ALTRET;
       24    13871
       25    13872    1   DCL BREAK ENTRY;
       26    13873    1   DCL ROUTE_COMMAND ENTRY(1) ALTRET;
       27    13874    1   DCL ROUTE_WRITE ENTRY(11);
       28    13875
       29    13876    1   DCL ROUTE_CMD SBIN SYMREF;
       30    13877    1   DCL B$JIT$ PTR SYMREF;
       31    13878    1   DCL B$TCB$ PTR SYMREF;
       32    13879        %B$ALT;
       33    13887        %B$TCB(STCLASS="BASED(B$TCB$)");
       34    13890
       35    13891    1   DCL 1 HI_FMT STATIC,
       36    13892    1         2 C_ UBIN BYTE CALIGNED,
       37    13893    1         2 T_ CHAR (20) CALIGNED;
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:2    
       38    13894    1   DCL B_VERSION CHAR(1) SYMREF;
       39    13895    1   DCL 1 B$VERSIONB BASED,
       40    13896    1         2 C_ UBIN BYTE CALIGNED,
       41    13897    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
       42    13898
       43    13899        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
       44    13944        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
       45    13982
       46    13983    1   DCL HI_VEC BIT(72) STATIC DALIGNED INIT(VECTOR(HI_FMT));
       47    13984    1   DCL P_PCB$ PTR STATIC SYMDEF INIT(ADDR(P_PCB));
       48    13985    1   DCL ROUTE_END_FLG BIT(1) STATIC SYMDEF INIT('0'B);
       49    13986        %P_PCB;
       50    14185    1   DCL 1 PROMPT STATIC  SYMDEF,
       51    14186    1         2 STAR CHAR(1) INIT('*');
       52    14187    1   DCL ERROR_RETURN REMEMBER STATIC SYMDEF;
       53    14188    1   DCL MSGBUF CHAR(400) STATIC SYMDEF INIT(' ');
       54    14189    1   DCL LASTMSG# UBIN STATIC SYMDEF INIT(0);
       55    14190    1   DCL 1 MYSTATION STATIC SYMDEF ALIGNED,
       56    14191    1         2 * CHAR(2) UNAL INIT('RT'),
       57    14192    1         2 SYSID CHAR(6) UNAL INIT('000000');
       58    14193    1   DCL MYSTATION_C REDEF MYSTATION CHAR(8);
       59    14194
       60    14195        %VLP_ACCT(FPTN=ROUTEACCT,STCLASS="CONSTANT SYMDEF",ACCT=':SYS');
       61    14208        %VLP_ACCT   (FPTN=SYSACCT,STCLASS="CONSTANT SYMDEF",ACCT=':SYS');
       62    14221
       63    14222        %FPT_MONINFO (MONINFO=VLR_MONINFO, SITEINFO=VLR_SITEINFO);
       64    14237        %VLR_MONINFO (FPTN=VLR_MONINFO, STCLASS=STATIC SYMDEF);
       65    14255        %VLR_SITEINFO (FPTN=VLR_SITEINFO, STCLASS=STATIC);
       66    14274
       67    14275        %VLP_ERRCODE(FPTN=ERR_C,STCLASS=CONSTANT,FCG=KS,MID=X,MON='0'B,SEV=0,ERR#=0);
       68    14320        %FPT_PRIV (AUTH=YES, PRIV="%(PR_MFEP# | PR_FMSEC# | PR_SPCLMM#)");
       69    14335        %FPT_PRIV (FPTN = PPR_ROUTECON, PPRIV = YES, PRIV= %PPR_NETCON#);
       70    14350
       71    14351        %XUR_INIT (ABORT=BREAK,PCB=P_PCB,PASS=MODE,GOODCMD=YES,SYNTAX=YES,COMMANDS=YES);
       72    14450
       73    14451        %FPT_INT (UENTRY=XUR$BREAK,
       74    14452                  STCLASS=CONSTANT);
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:3    
       75    14466
       76    14467        %FPT_OPEN (FPTN=OPEN_ROUTES,
       77    14468                   DCB=M$ROUTE,
       78    14469                   NAME=ROUTES,
       79    14470                   ACCT=ROUTEACCT,
       80    14471                   ORG=KEYED,
       81    14472                   SHARE=ALL,
       82    14473                   ASN=FILE,
       83    14474                   FUN=CREATE,
       84    14475                   EXIST=OLDFILE,
       85    14476                   CTG=YES,
       86    14477                   ACS=DIRECT,
       87    14478                   ACSVEH=ROUTES_ACSVEH);
       88    14587
       89    14588        %FPT_OPEN (FPTN=OPEN_HLPCG,
       90    14589                   DCB=M$HLPCG,
       91    14590                   NAME=HLPCG,
       92    14591                   ACCT=SYSACCT,
       93    14592                   ASN=COMGROUP,
       94    14593                   SETSTA=VLP_SETSTA,
       95    14594                   FUN=UPDATE,
       96    14595                   ORG=CONSEC,
       97    14596                   SHARE=ALL);
       98    14705
       99    14706        %FPT_OPEN(FPTN=OPEN_LO,FUN=CREATE,EXIST=NEWFILE,DCB=M$LO);
      100    14815        %FPT_CLOSE (FPTN=CLOSE_ROUTES,
      101    14816                    DCB=M$ROUTE);
      102    14858        %FPT_CLOSE (FPTN=CLOSE_LO,DISP=SAVE,DCB=M$LO);
      103    14900
      104    14901        %VLP_ATTR (FPTN=ROUTES_ACSVEH);
      105    14915        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='NETCON?');
      106    14932        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='SUPER?');
      107    14949        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='PIGETTE?');
      108    14966        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='ROUTECON?');
      109    14983        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='SLUG',LAST=";");
      110    15000
      111    15001        %VLP_NAME (FPTN=ROUTES,NAME=':ROUTES');
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:4    
      112    15028        %VLP_NAME (FPTN=ERRMSG,NAME=':KSERRMSG.:SYS');
      113    15055        %VLP_NAME (FPTN=HLPCG,NAME='HLPCG');
      114    15082
      115    15083        %VLP_SETSTA;
      116    15111
      117    15112    1   DCL I UBIN;
      118    15113    1   DCL TOP$ PTR;
      119    15114        %VLP_ERRCODE (STCLASS = "REDEF TOP$");
      120    15159    1   DCL PARSE_CODE REDEF TOP$ BIT(36);
      121    15160    1   DCL M$LO DCB;
      122    15161    1   DCL M$HLPCG DCB;
      123    15162    1   DCL M$ROUTE DCB;
      124    15163
      125    15164        %EJECT;
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:5    
      126    15165        /* Begin program initialization.
      127    15166        */
      128    15167    2      CALL XUR$INIT(XUR_INIT,P_PCB$) WHENALTRETURN DO;
      129    15168    2           CALL M$XXX;
      130    15169    2           END;
      131    15170
      132    15171    1      CALL XUR$SETERRMSG(ERRMSG)
      133    15172    2      WHENALTRETURN DO;
      134    15173    2           CALL M$XXX;
      135    15174    2           END;
      136    15175
      137    15176    1      CALL M$SPRIV (FPT_PRIV);             /* mfep and fmsec                     */
      138    15177
      139    15178    1      CALL M$MONINFO(FPT_MONINFO)
      140    15179    2      WHENALTRETURN DO;
      141    15180    2           CALL M$MERC;
      142    15181    2           END;
      143    15182
      144    15183    1      CALL M$SPRIV(PPR_ROUTECON)           /* netcon                             */
      145    15184    2      WHENALTRETURN DO;
      146    15185    2           VLP_ERRCODE.ERR# = %E$NO_PRIV;
      147    15186    2           CALL XUR$ERRMSG(VLP_ERRCODE);
      148    15187    2           RETURN;
      149    15188    2           END/*altreturn*/;
      150    15189
      151    15190        /*E* ERROR: KSX-E$NO_PRIV-0
      152    15191             MESSAGE: Insufficient privilege to run ROUTECON.
      153    15192             MESSAGE1: User must have NETCON processor privilege to use ROUTECON.
      154    15193        */
      155    15194
      156    15195    1      CALL BINCHAR(MYSTATION.SYSID,B$JIT.SYSID);
      157    15196    1      VLP_SETSTA.MYSTATION# = MYSTATION_C;
      158    15197
      159    15198    1      CALL M$OPEN(OPEN_HLPCG)
      160    15199    2      WHENALTRETURN DO;
      161    15200    2           VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      162    15201    2           CALL XUR$ERRMSG(VLP_ERRCODE);
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:6    
      163    15202    2           END;
      164    15203
      165    15204    1      CALL M$OPEN(OPEN_ROUTES)
      166    15205    2      WHENALTRETURN DO;
      167    15206    2           VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      168    15207    2           CALL XUR$ERRMSG(VLP_ERRCODE);
      169    15208    2           GOTO BAG_IT;
      170    15209    2           END;
      171    15210
      172    15211
      173    15212    1      CALL M$OPEN(OPEN_LO);
      174    15213    1      CALL CONCAT(HI_FMT.T_,'ROUTECON ',ADDR(B_VERSION)->B$VERSIONB.T_,' HERE');
      175    15214    1      CALL ROUTE_WRITE(HI_VEC);
      176    15215
      177    15216
      178    15217    1      REMEMBER ERR_RETURN IN ERROR_RETURN;
      179    15218    1      CALL M$INT(FPT_INT);
      180    15219
      181    15220
      182    15221
      183    15222        /* Read and parse the commands.
      184    15223        */
      185    15224    1      ROUTE_END_FLG = '0'B;
      186    15225
      187    15226    2      DO WHILE(NOT ROUTE_END_FLG);
      188    15227    2           CALL XUR$GETCMD(ROUTE_CMD,TOP$,VECTOR(PROMPT))
      189    15228    3           WHENRETURN DO;
      190    15229    3                CALL ROUTE_COMMAND(TOP$)
      191    15230    4                WHENALTRETURN DO;
      192    15231
      193    15232    4                     END;
      194    15233    3                END/*getcmd return*/;
      195    15234    3           WHENALTRETURN DO;
      196    15235    3                CALL XUR$ERRMSG(TOP$);
      197    15236    3                IF VLP_ERRCODE.ERR# = %E$EOF OR VLP_ERRCODE.ERR# = %E$NOFILE
      198    15237    3                THEN GOTO BAG_IT;
      199    15238    3                UNWIND TO ERROR_RETURN;
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:7    
      200    15239    3                END/*getcmd altret*/;
      201    15240    2   ERR_RETURN:;
      202    15241    2           END/*do while not route_end_flg*/;
      203    15242
      204    15243    1   BAG_IT:;
      205    15244    1      CALL M$CLOSE(CLOSE_ROUTES);
      206    15245    1      CALL M$CLOSE(CLOSE_LO);
      207    15246    1      RETURN;
      208    15247    1   END ROUTECON;
      209    15248        %EOD;

PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:8    
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KSX_NODES_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ROUTECON.

   Procedure ROUTECON requires 157 words for executable code.
   Procedure ROUTECON requires 10 words of local(AUTO) storage.

PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:9    

 Object Unit name= ROUTECON                                   File name= KSX$ROUTECON.:E05TOU
 UTS= JUL 30 '97 01:48:30.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   538   1032  ROUTECON
    2  RoData even  UTS     15     17  ROUTECON
    3   DCB   even  none     0      0  M$LO
    4   DCB   even  none     0      0  M$HLPCG
    5   DCB   even  none     0      0  M$ROUTE
    6   Proc  even  none   157    235  ROUTECON
    7  RoData even  none    10     12  ROUTECON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Main       0  ROUTECON
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:10   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     10  P_PCB$                             1     11  ROUTE_END_FLG
    1     12  P_PCB                              1     30  PROMPT
    1     32  ERROR_RETURN                       1     34  MSGBUF
    1    200  LASTMSG#                           1    201  MYSTATION
    2      0  ROUTEACCT                          2      2  SYSACCT
    1    220  VLR_MONINFO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 BREAK
 yes     yes           Std       2 XTX$ADAPT
         yes          Async      0 XUR$BREAK
 yes     yes           Std       6 XUR$GETCMD
 yes     yes           Std       1 ROUTE_COMMAND
 yes     yes           Std       3 XUR$INIT
         yes           Std      11 ROUTE_WRITE
 yes     yes           Std       1 XUR$SETERRMSG
 yes     yes           Std       7 XUR$ERRMSG
                       nStd      0 X66_MAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MARET
                       nStd      0 X66_MAUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  ROUTE_CMD                             B$JIT$
     B$TCB$                                B_VERSION                             M$LO
     M$HLPCG                               M$ROUTE                               B_VECTNIL
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:11   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:12   


        1        1        /*M* KSX$ROUTECON - Main module for ROUTECON */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0,MEC,MOC      */
        8        8
        9        9        ROUTECON: PROC MAIN;

      9  6 000000   000000 700200 xent  ROUTECON     TSX0  ! X66_MAUTO
         6 000001   000012 000000                    ZERO    10,0

       10       10
       11       11        %INCLUDE CP_6;
       12     5570        %INCLUDE B$JIT;
       13     6173        %INCLUDE XU_MACRO_C;
       14     9279        %INCLUDE KL_MACRO_C;
       15    12631        %INCLUDE B_ERRORS_C;
       16    13758        %INCLUDE KSX_NODES_E;
       17    13798        %INCLUDE KS_PERR_C;
       18    13865
       19    13866    1   DCL XUR$GETCMD ENTRY(6) ALTRET;
       20    13867    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       21    13868    1   DCL XUR$SETERRMSG ENTRY(1) ALTRET;
       22    13869    1   DCL XUR$BREAK ENTRY ASYNC;
       23    13870    1   DCL XUR$INIT ENTRY(3) ALTRET;
       24    13871
       25    13872    1   DCL BREAK ENTRY;
       26    13873    1   DCL ROUTE_COMMAND ENTRY(1) ALTRET;
       27    13874    1   DCL ROUTE_WRITE ENTRY(11);
       28    13875
       29    13876    1   DCL ROUTE_CMD SBIN SYMREF;
       30    13877    1   DCL B$JIT$ PTR SYMREF;
       31    13878    1   DCL B$TCB$ PTR SYMREF;
       32    13879        %B$ALT;
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:13   
       33    13887        %B$TCB(STCLASS="BASED(B$TCB$)");
       34    13890
       35    13891    1   DCL 1 HI_FMT STATIC,
       36    13892    1         2 C_ UBIN BYTE CALIGNED,
       37    13893    1         2 T_ CHAR (20) CALIGNED;
       38    13894    1   DCL B_VERSION CHAR(1) SYMREF;
       39    13895    1   DCL 1 B$VERSIONB BASED,
       40    13896    1         2 C_ UBIN BYTE CALIGNED,
       41    13897    1         2 T_ CHAR(B$VERSIONB.C_) CALIGNED;
       42    13898
       43    13899        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
       44    13944        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
       45    13982
       46    13983    1   DCL HI_VEC BIT(72) STATIC DALIGNED INIT(VECTOR(HI_FMT));
       47    13984    1   DCL P_PCB$ PTR STATIC SYMDEF INIT(ADDR(P_PCB));
       48    13985    1   DCL ROUTE_END_FLG BIT(1) STATIC SYMDEF INIT('0'B);
       49    13986        %P_PCB;
       50    14185    1   DCL 1 PROMPT STATIC  SYMDEF,
       51    14186    1         2 STAR CHAR(1) INIT('*');
       52    14187    1   DCL ERROR_RETURN REMEMBER STATIC SYMDEF;
       53    14188    1   DCL MSGBUF CHAR(400) STATIC SYMDEF INIT(' ');
       54    14189    1   DCL LASTMSG# UBIN STATIC SYMDEF INIT(0);
       55    14190    1   DCL 1 MYSTATION STATIC SYMDEF ALIGNED,
       56    14191    1         2 * CHAR(2) UNAL INIT('RT'),
       57    14192    1         2 SYSID CHAR(6) UNAL INIT('000000');
       58    14193    1   DCL MYSTATION_C REDEF MYSTATION CHAR(8);
       59    14194
       60    14195        %VLP_ACCT(FPTN=ROUTEACCT,STCLASS="CONSTANT SYMDEF",ACCT=':SYS');
       61    14208        %VLP_ACCT   (FPTN=SYSACCT,STCLASS="CONSTANT SYMDEF",ACCT=':SYS');
       62    14221
       63    14222        %FPT_MONINFO (MONINFO=VLR_MONINFO, SITEINFO=VLR_SITEINFO);
       64    14237        %VLR_MONINFO (FPTN=VLR_MONINFO, STCLASS=STATIC SYMDEF);
       65    14255        %VLR_SITEINFO (FPTN=VLR_SITEINFO, STCLASS=STATIC);
       66    14274
       67    14275        %VLP_ERRCODE(FPTN=ERR_C,STCLASS=CONSTANT,FCG=KS,MID=X,MON='0'B,SEV=0,ERR#=0);
       68    14320        %FPT_PRIV (AUTH=YES, PRIV="%(PR_MFEP# | PR_FMSEC# | PR_SPCLMM#)");
       69    14335        %FPT_PRIV (FPTN = PPR_ROUTECON, PPRIV = YES, PRIV= %PPR_NETCON#);
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:14   
       70    14350
       71    14351        %XUR_INIT (ABORT=BREAK,PCB=P_PCB,PASS=MODE,GOODCMD=YES,SYNTAX=YES,COMMANDS=YES);
       72    14450
       73    14451        %FPT_INT (UENTRY=XUR$BREAK,
       74    14452                  STCLASS=CONSTANT);
       75    14466
       76    14467        %FPT_OPEN (FPTN=OPEN_ROUTES,
       77    14468                   DCB=M$ROUTE,
       78    14469                   NAME=ROUTES,
       79    14470                   ACCT=ROUTEACCT,
       80    14471                   ORG=KEYED,
       81    14472                   SHARE=ALL,
       82    14473                   ASN=FILE,
       83    14474                   FUN=CREATE,
       84    14475                   EXIST=OLDFILE,
       85    14476                   CTG=YES,
       86    14477                   ACS=DIRECT,
       87    14478                   ACSVEH=ROUTES_ACSVEH);
       88    14587
       89    14588        %FPT_OPEN (FPTN=OPEN_HLPCG,
       90    14589                   DCB=M$HLPCG,
       91    14590                   NAME=HLPCG,
       92    14591                   ACCT=SYSACCT,
       93    14592                   ASN=COMGROUP,
       94    14593                   SETSTA=VLP_SETSTA,
       95    14594                   FUN=UPDATE,
       96    14595                   ORG=CONSEC,
       97    14596                   SHARE=ALL);
       98    14705
       99    14706        %FPT_OPEN(FPTN=OPEN_LO,FUN=CREATE,EXIST=NEWFILE,DCB=M$LO);
      100    14815        %FPT_CLOSE (FPTN=CLOSE_ROUTES,
      101    14816                    DCB=M$ROUTE);
      102    14858        %FPT_CLOSE (FPTN=CLOSE_LO,DISP=SAVE,DCB=M$LO);
      103    14900
      104    14901        %VLP_ATTR (FPTN=ROUTES_ACSVEH);
      105    14915        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,DELR=YES,VEHICLE='NETCON?');
      106    14932        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='SUPER?');
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:15   
      107    14949        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='PIGETTE?');
      108    14966        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='ROUTECON?');
      109    14983        %VLP_ACSVEH (READ=YES,UPD=YES,WNEW=YES,VEHICLE='SLUG',LAST=";");
      110    15000
      111    15001        %VLP_NAME (FPTN=ROUTES,NAME=':ROUTES');
      112    15028        %VLP_NAME (FPTN=ERRMSG,NAME=':KSERRMSG.:SYS');
      113    15055        %VLP_NAME (FPTN=HLPCG,NAME='HLPCG');
      114    15082
      115    15083        %VLP_SETSTA;
      116    15111
      117    15112    1   DCL I UBIN;
      118    15113    1   DCL TOP$ PTR;
      119    15114        %VLP_ERRCODE (STCLASS = "REDEF TOP$");
      120    15159    1   DCL PARSE_CODE REDEF TOP$ BIT(36);
      121    15160    1   DCL M$LO DCB;
      122    15161    1   DCL M$HLPCG DCB;
      123    15162    1   DCL M$ROUTE DCB;
      124    15163
      125    15164        %EJECT;
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:16   
      126    15165        /* Begin program initialization.
      127    15166        */
      128    15167    2      CALL XUR$INIT(XUR_INIT,P_PCB$) WHENALTRETURN DO;

  15167  6 000002   000000 630400 7                  EPPR0   0
         6 000003   000020 631400 xsym               EPPR1   B_VECTNIL+16
         6 000004   000000 701000 xent               TSX1    XUR$INIT
         6 000005   000007 702000 6                  TSX2    s:15168
         6 000006   000011 710000 6                  TRA     s:15171

      129    15168    2           CALL M$XXX;

  15168  6 000007   000003 713400                    CLIMB   3
         6 000010   000000 401760                    pmme    nvectors=0

      130    15169    2           END;

      131    15170
      132    15171    1      CALL XUR$SETERRMSG(ERRMSG)

  15171  6 000011   000002 630400 7                  EPPR0   2
         6 000012   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000013   000000 701000 xent               TSX1    XUR$SETERRMSG
         6 000014   000016 702000 6                  TSX2    s:15173
         6 000015   000020 710000 6                  TRA     s:15176

      133    15172    2      WHENALTRETURN DO;

      134    15173    2           CALL M$XXX;

  15173  6 000016   000003 713400                    CLIMB   3
         6 000017   000000 401760                    pmme    nvectors=0

      135    15174    2           END;

      136    15175
      137    15176    1      CALL M$SPRIV (FPT_PRIV);             /* mfep and fmsec                     */
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:17   

  15176  6 000020   000336 630400 1                  EPPR0   FPT_PRIV
         6 000021   020012 713400                    CLIMB   8202
         6 000022   400000 401760                    pmme    nvectors=1

      138    15177
      139    15178    1      CALL M$MONINFO(FPT_MONINFO)

  15178  6 000023   000204 630400 1                  EPPR0   FPT_MONINFO
         6 000024   420023 713400                    CLIMB   alt,+8211
         6 000025   402400 401760                    pmme    nvectors=6
         6 000026   000030 702000 6                  TSX2    s:15180
         6 000027   000032 710000 6                  TRA     s:15183

      140    15179    2      WHENALTRETURN DO;

      141    15180    2           CALL M$MERC;

  15180  6 000030   010007 713400                    CLIMB   4103
         6 000031   000000 401760                    pmme    nvectors=0

      142    15181    2           END;

      143    15182
      144    15183    1      CALL M$SPRIV(PPR_ROUTECON)           /* netcon                             */

  15183  6 000032   000342 630400 1                  EPPR0   PPR_ROUTECON
         6 000033   420012 713400                    CLIMB   alt,+8202
         6 000034   400000 401760                    pmme    nvectors=1
         6 000035   000037 702000 6                  TSX2    s:15185
         6 000036   000052 710000 6                  TRA     s:15195

      145    15184    2      WHENALTRETURN DO;

      146    15185    2           VLP_ERRCODE.ERR# = %E$NO_PRIV;

  15185  6 000037   200004 236100                    LDQ     TOP$,,AUTO
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:18   
         6 000040   000003 376000 7                  ANQ     3
         6 000041   001450 276007                    ORQ     808,DL
         6 000042   200004 756100                    STQ     TOP$,,AUTO

      147    15186    2           CALL XUR$ERRMSG(VLP_ERRCODE);

  15186  6 000043   200004 630500                    EPPR0   TOP$,,AUTO
         6 000044   200006 450500                    STP0    TOP$+2,,AUTO
         6 000045   200006 630500                    EPPR0   TOP$+2,,AUTO
         6 000046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000047   000000 701000 xent               TSX1    XUR$ERRMSG
         6 000050   000000 011000                    NOP     0

      148    15187    2           RETURN;

  15187  6 000051   000000 702200 xent               TSX2  ! X66_MARET

      149    15188    2           END/*altreturn*/;
      150    15189
      151    15190        /*E* ERROR: KSX-E$NO_PRIV-0
      152    15191             MESSAGE: Insufficient privilege to run ROUTECON.
      153    15192             MESSAGE1: User must have NETCON processor privilege to use ROUTECON.
      154    15193        */
      155    15194
      156    15195    1      CALL BINCHAR(MYSTATION.SYSID,B$JIT.SYSID);

  15195  6 000052   000000 470400 xsym               LDP0    B$JIT$
         6 000053   000000 236100                    LDQ     0,,PR0
         6 000054   777777 376007                    ANQ     -1,DL
         6 000055   000000 235003                    LDA     0,DU
         6 000056   200006 757100                    STAQ    TOP$+2,,AUTO
         6 000057   000000 301500                    BTD
         6 000060   200006 000010                    NDSC9   TOP$+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         6 000061   000201 430006 1                  NDSC9   MYSTATION                cn=2,s=nosgn,sf=0,n=6

      157    15196    1      VLP_SETSTA.MYSTATION# = MYSTATION_C;

PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:19   
  15196  6 000062   040000 100400                    MLR     fill='040'O
         6 000063   000201 000010 1                  ADSC9   MYSTATION                cn=0,n=8
         6 000064   001016 000010 1                  ADSC9   VLP_SETSTA               cn=0,n=8

      158    15197
      159    15198    1      CALL M$OPEN(OPEN_HLPCG)

  15198  6 000065   000510 630400 1                  EPPR0   OPEN_HLPCG
         6 000066   450000 713400                    CLIMB   alt,open
         6 000067   410400 401760                    pmme    nvectors=18
         6 000070   000072 702000 6                  TSX2    s:15200
         6 000071   000104 710000 6                  TRA     s:15204

      160    15199    2      WHENALTRETURN DO;

      161    15200    2           VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  15200  6 000072   000000 470400 xsym               LDP0    B$TCB$
         6 000073   000000 471500                    LDP1    0,,PR0
         6 000074   100102 236100                    LDQ     66,,PR1
         6 000075   200004 756100                    STQ     TOP$,,AUTO

      162    15201    2           CALL XUR$ERRMSG(VLP_ERRCODE);

  15201  6 000076   200004 631500                    EPPR1   TOP$,,AUTO
         6 000077   200006 451500                    STP1    TOP$+2,,AUTO
         6 000100   200006 630500                    EPPR0   TOP$+2,,AUTO
         6 000101   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000102   000000 701000 xent               TSX1    XUR$ERRMSG
         6 000103   000000 011000                    NOP     0

      163    15202    2           END;

      164    15203
      165    15204    1      CALL M$OPEN(OPEN_ROUTES)

  15204  6 000104   000416 630400 1                  EPPR0   OPEN_ROUTES
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:20   
         6 000105   450000 713400                    CLIMB   alt,open
         6 000106   410400 401760                    pmme    nvectors=18
         6 000107   000111 702000 6                  TSX2    s:15206
         6 000110   000124 710000 6                  TRA     s:15212

      166    15205    2      WHENALTRETURN DO;

      167    15206    2           VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

  15206  6 000111   000000 470400 xsym               LDP0    B$TCB$
         6 000112   000000 471500                    LDP1    0,,PR0
         6 000113   100102 236100                    LDQ     66,,PR1
         6 000114   200004 756100                    STQ     TOP$,,AUTO

      168    15207    2           CALL XUR$ERRMSG(VLP_ERRCODE);

  15207  6 000115   200004 631500                    EPPR1   TOP$,,AUTO
         6 000116   200006 451500                    STP1    TOP$+2,,AUTO
         6 000117   200006 630500                    EPPR0   TOP$+2,,AUTO
         6 000120   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000121   000000 701000 xent               TSX1    XUR$ERRMSG
         6 000122   000000 011000                    NOP     0

      169    15208    2           GOTO BAG_IT;

  15208  6 000123   000226 710000 6                  TRA     BAG_IT

      170    15209    2           END;
      171    15210
      172    15211
      173    15212    1      CALL M$OPEN(OPEN_LO);

  15212  6 000124   000602 630400 1                  EPPR0   OPEN_LO
         6 000125   050000 713400                    CLIMB   open
         6 000126   410400 401760                    pmme    nvectors=18

      174    15213    1      CALL CONCAT(HI_FMT.T_,'ROUTECON ',ADDR(B_VERSION)->B$VERSIONB.T_,' HERE');
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:21   

  15213  6 000127   000000 236000 xsym               LDQ     B_VERSION
         6 000130   000033 772000                    QRL     27
         6 000131   040000 100400                    MLR     fill='040'O
         6 000132   000012 000011 2                  ADSC9   FPT_INT+4                cn=0,n=9
         6 000133   000000 200011 1                  ADSC9   HI_FMT                   cn=1,n=9
         6 000134   000000 620006                    EAX0    0,QL
         6 000135   040000 100440                    MLR     fill='040'O
         6 000136   000000 200010 xsym               ADSC9   B_VERSION                cn=1,n=*X0
         6 000137   000002 400013 1                  ADSC9   HI_FMT+2                 cn=2,n=11
         6 000140   000013 116007                    CMPQ    11,DL
         6 000141   000147 603000 6                  TRC     s:15214
         6 000142   777764 621006                    EAX1    -12,QL
         6 000143   777777 661003                    ERX1    -1,DU
         6 000144   040046 100400                    MLR     fill='040'O
         6 000145   000015 000005 2                  ADSC9   FPT_INT+7                cn=0,n=5
         6 000146   000002 400011 1                  ADSC9   HI_FMT+2,Q               cn=2,n=*X1

      175    15214    1      CALL ROUTE_WRITE(HI_VEC);

  15214  6 000147   000004 630400 7                  EPPR0   4
         6 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000151   000000 701000 xent               TSX1    ROUTE_WRITE
         6 000152   000000 011000                    NOP     0

      176    15215
      177    15216
      178    15217    1      REMEMBER ERR_RETURN IN ERROR_RETURN;

  15217  6 000153   000224 635000 6                  EAA     ERR_RETURN
         6 000154   000032 452400 1                  STP2    ERROR_RETURN
         6 000155   000033 755000 1                  STA     ERROR_RETURN+1

      179    15218    1      CALL M$INT(FPT_INT);

  15218  6 000156   000006 630400 2                  EPPR0   FPT_INT
         6 000157   010002 713400                    CLIMB   4098
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:22   
         6 000160   400000 401760                    pmme    nvectors=1

      180    15219
      181    15220
      182    15221
      183    15222        /* Read and parse the commands.
      184    15223        */
      185    15224    1      ROUTE_END_FLG = '0'B;

  15224  6 000161   000011 450000 1                  STZ     ROUTE_END_FLG

      186    15225
      187    15226    2      DO WHILE(NOT ROUTE_END_FLG);

  15226  6 000162   000224 710000 6                  TRA     ERR_RETURN

      188    15227    2           CALL XUR$GETCMD(ROUTE_CMD,TOP$,VECTOR(PROMPT))

  15227  6 000163   000010 236000 7                  LDQ     8
         6 000164   200010 756100                    STQ     TOP$+4,,AUTO
         6 000165   200004 630500                    EPPR0   TOP$,,AUTO
         6 000166   200007 450500                    STP0    TOP$+3,,AUTO
         6 000167   000011 236000 7                  LDQ     9
         6 000170   200006 756100                    STQ     TOP$+2,,AUTO
         6 000171   200006 630500                    EPPR0   TOP$+2,,AUTO
         6 000172   000021 631400 xsym               EPPR1   B_VECTNIL+17
         6 000173   000000 701000 xent               TSX1    XUR$GETCMD
         6 000174   000205 702000 6                  TSX2    s:15235

      189    15228    3           WHENRETURN DO;

      190    15229    3                CALL ROUTE_COMMAND(TOP$)

  15229  6 000175   200004 630500                    EPPR0   TOP$,,AUTO
         6 000176   200006 450500                    STP0    TOP$+2,,AUTO
         6 000177   200006 630500                    EPPR0   TOP$+2,,AUTO
         6 000200   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:23   
         6 000201   000000 701000 xent               TSX1    ROUTE_COMMAND
         6 000202   000204 702000 6                  TSX2    s:15233
         6 000203   000204 710000 6                  TRA     s:15233

      191    15230    4                WHENALTRETURN DO;

      192    15231
      193    15232    4                     END;

      194    15233    3                END/*getcmd return*/;

  15233  6 000204   000224 710000 6                  TRA     ERR_RETURN

      195    15234    3           WHENALTRETURN DO;

      196    15235    3                CALL XUR$ERRMSG(TOP$);

  15235  6 000205   200004 630500                    EPPR0   TOP$,,AUTO
         6 000206   200006 450500                    STP0    TOP$+2,,AUTO
         6 000207   200006 630500                    EPPR0   TOP$+2,,AUTO
         6 000210   000017 631400 xsym               EPPR1   B_VECTNIL+15
         6 000211   000000 701000 xent               TSX1    XUR$ERRMSG
         6 000212   000000 011000                    NOP     0

      197    15236    3                IF VLP_ERRCODE.ERR# = %E$EOF OR VLP_ERRCODE.ERR# = %E$NOFILE

  15236  6 000213   200004 236100                    LDQ     TOP$,,AUTO
         6 000214   377770 376007                    ANQ     131064,DL
         6 000215   000060 116007                    CMPQ    48,DL
         6 000216   000226 600000 6                  TZE     BAG_IT
         6 000217   001610 116007                    CMPQ    904,DL
         6 000220   000226 600000 6                  TZE     BAG_IT

      198    15237    3                THEN GOTO BAG_IT;
      199    15238    3                UNWIND TO ERROR_RETURN;

  15238  6 000221   000032 237200 1                  LDAQ  ! ERROR_RETURN
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:24   
         6 000222   000000 700200 xent               TSX0  ! X66_MAUNWIND
         6 000223   000000 000200                    ZERO    0,128

  15228  6 000224                       ERR_RETURN   null
      200    15239    3                END/*getcmd altret*/;
      201    15240    2   ERR_RETURN:;
      202    15241    2           END/*do while not route_end_flg*/;

  15241  6 000224   000011 234000 1                  SZN     ROUTE_END_FLG
         6 000225   000163 605000 6                  TPL     s:15227

  15237  6 000226                       BAG_IT       null
      203    15242
      204    15243    1   BAG_IT:;
      205    15244    1      CALL M$CLOSE(CLOSE_ROUTES);

  15244  6 000226   000674 630400 1                  EPPR0   CLOSE_ROUTES
         6 000227   050001 713400                    CLIMB   close
         6 000230   406000 401760                    pmme    nvectors=13

      206    15245    1      CALL M$CLOSE(CLOSE_LO);

  15245  6 000231   000732 630400 1                  EPPR0   CLOSE_LO
         6 000232   050001 713400                    CLIMB   close
         6 000233   406000 401760                    pmme    nvectors=13

      207    15246    1      RETURN;

  15246  6 000234   000000 702200 xent               TSX2  ! X66_MARET
      208    15247    1   END ROUTECON;
      209    15248        %EOD;

PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:25   
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KSX_NODES_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ROUTECON.
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:26   

 **** Variables and constants ****

  ****  Section 001  Data  ROUTECON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   732-0-0/d STRC(1080)  r     1 CLOSE_LO                 674-0-0/d STRC(1080)  r     1 CLOSE_ROUTES
  1010-0-0/c STRC(135)   r     1 ERRMSG                    32-0-0/d REMB        r     1 ERROR_RETURN
   204-0-0/d STRC(432)   r     1 FPT_MONINFO              336-0-0/d STRC(144)   r     1 FPT_PRIV
     0-0-0/c STRC(189)   r     1 HI_FMT                     6-0-0/d BIT (72)    r     1 HI_VEC
  1014-0-0/c STRC(54)    r     1 HLPCG                    201-0-0/w STRC(72)    r     1 MYSTATION
   201-0-0/w CHAR(8)     r     1 MYSTATION_C              510-0-0/d STRC(2088)  r     1 OPEN_HLPCG
   602-0-0/d STRC(2088)  r     1 OPEN_LO                  416-0-0/d STRC(2088)  r     1 OPEN_ROUTES
   342-0-0/d STRC(144)   r     1 PPR_ROUTECON              30-0-0/c STRC(9)     r     1 PROMPT
    12-0-0/w STRC(504)   r     1 P_PCB                     10-0-0/w PTR         r     1 P_PCB$
  1006-0-0/c STRC(72)    r     1 ROUTES                   770-0-0/w STRC(477)   r     1 ROUTES_ACSVEH
    11-0-0/b BIT         r     1 ROUTE_END_FLG           1016-0-0/w STRC(432)   r     1 VLP_SETSTA
   220-0-0/d STRC(540)   r     1 VLR_MONINFO              240-0-0/d STRC(2232)  r     1 VLR_SITEINFO
   346-0-0/d STRC(1404)  r     1 XUR_INIT

  ****  Section 002 RoData ROUTECON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/d STRC(144)   r     1 FPT_INT                    0-0-0/c STRC(72)    r     1 ROUTEACCT
     2-0-0/c STRC(72)    r     1 SYSACCT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 TOP$                       4-0-0/w STRC        r     1 VLP_ERRCODE

  ****  SYMREF variables  ****
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:27   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c CHAR        r     1 B_VERSION                  0-0-0/w SBIN        r     1 ROUTE_CMD

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c ASTR(9)     r     1 B$VERSIONB
     0-0-0N  NULL        r     1 M$HLPCG                    0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$ROUTE                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure ROUTECON requires 157 words for executable code.
   Procedure ROUTECON requires 10 words of local(AUTO) storage.
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:28   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:29   
          MINI XREF LISTING

B$ALT.CODE
     13881**DCL     13881--REDEF   13882--REDEF   13882--REDEF
B$ALT.ERR
     13882**DCL     15200>>ASSIGN  15206>>ASSIGN
B$ALT.ERR.ERR#
     13883**DCL     13883--REDEF
B$ALT.EVID
     13882**DCL     13882--REDEF   13882--REDEF
B$JIT.CPFLAGS1.SLEAZE
      5991**DCL      5991--REDEF
B$JIT.ERR.MID
      5898**DCL      5898--REDEF
B$JIT.JRESPEAK
      6059**DCL      6060--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6168**DCL      6168--REDEF    6169--REDEF
B$JIT.PNR
      6072**DCL      6072--REDEF
B$JIT.SYSID
      5897**DCL     15195>>CALLBLT
B$JIT.TSLINE
      6166**DCL      6167--REDEF
B$JIT$
     13877**DCL      5892--IMP-PTR 15195>>CALLBLT
B$TCB.ALT$
     13888**DCL     15200>>ASSIGN  15206>>ASSIGN
B$TCB$
     13878**DCL     13888--IMP-PTR 15200>>ASSIGN  15206>>ASSIGN
B$VERSIONB.C_
     13896**DCL     13897--IMP-SIZ 15213>>CALLBLT
B$VERSIONB.T_
     13897**DCL     15213>>CALLBLT
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:30   
BAG_IT
     15237**LABEL   15208--GOTO    15237--GOTO
BREAK
     13872**DCL-ENT 14383--DCLINIT
B_VERSION
     13894**DCL     15213--CALLBLT 15213--CALLBLT
CLOSE_LO
     14881**DCL     15245<>CALL
CLOSE_LO.SN_
     14881**DCL     14881--REDEF
CLOSE_LO.UTL_
     14882**DCL     14882--REDEF
CLOSE_LO.V
     14886**DCL     14881--DCLINIT
CLOSE_LO.V.EXPIRE#
     14896**DCL     14896--REDEF
CLOSE_LO.V.TYPE#
     14894**DCL     14894--REDEF
CLOSE_LO.V.XTNSIZE#
     14891**DCL     14891--REDEF   14893--REDEF
CLOSE_ROUTES
     14839**DCL     15244<>CALL
CLOSE_ROUTES.SN_
     14839**DCL     14839--REDEF
CLOSE_ROUTES.UTL_
     14840**DCL     14840--REDEF
CLOSE_ROUTES.V
     14844**DCL     14839--DCLINIT
CLOSE_ROUTES.V.EXPIRE#
     14854**DCL     14854--REDEF
CLOSE_ROUTES.V.TYPE#
     14852**DCL     14852--REDEF
CLOSE_ROUTES.V.XTNSIZE#
     14849**DCL     14849--REDEF   14851--REDEF
ERRMSG
     15053**DCL     15171<>CALL
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:31   
ERROR_RETURN
     14187**DCL     15217<<REMEMBR 15238>>UNWIND
ERR_RETURN
     15228**LABEL   15217--REMEMBR
FPT_INT
     14463**DCL     15218<>CALL
FPT_INT.V
     14463**DCL     14463--DCLINIT
FPT_MONINFO
     14233**DCL     15178<>CALL
FPT_PRIV
     14331**DCL     15176<>CALL
FPT_PRIV.V
     14331**DCL     14331--DCLINIT
HI_FMT
     13891**DCL     13983--DCLINIT
HI_FMT.T_
     13893**DCL     15213<<CALLBLT
HI_VEC
     13983**DCL     15214<>CALL
HLPCG
     15080**DCL     14662--DCLINIT
M$CLOSE
      5498**DCL-ENT 15244--CALL    15245--CALL
M$INT
      5553**DCL-ENT 15218--CALL
M$MERC
      5554**DCL-ENT 15180--CALL
M$MONINFO
      5566**DCL-ENT 15178--CALL
M$OPEN
      5498**DCL-ENT 15198--CALL    15204--CALL    15212--CALL
M$SPRIV
      5557**DCL-ENT 15176--CALL    15183--CALL
M$XXX
      5510**DCL-ENT 15168--CALL    15173--CALL
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:32   
MYSTATION
     14190**DCL     14193--REDEF
MYSTATION.SYSID
     14192**DCL     15195<<CALLBLT
MYSTATION_C
     14193**DCL     15196>>ASSIGN
OPEN_HLPCG
     14661**DCL     15198<>CALL
OPEN_HLPCG.ACSVEH_
     14663**DCL     14664--REDEF
OPEN_HLPCG.ALTKEYS_
     14669**DCL     14670--REDEF   14670--REDEF
OPEN_HLPCG.HDR_
     14668**DCL     14669--REDEF
OPEN_HLPCG.TAB_
     14667**DCL     14668--REDEF
OPEN_HLPCG.UHL_
     14661**DCL     14662--REDEF   14662--REDEF
OPEN_HLPCG.V
     14670**DCL     14661--DCLINIT
OPEN_HLPCG.V.FSN#
     14701**DCL     14701--REDEF   14701--REDEF
OPEN_HLPCG.WSN_
     14667**DCL     14667--REDEF
OPEN_LO
     14771**DCL     15212<>CALL
OPEN_LO.ACSVEH_
     14773**DCL     14774--REDEF
OPEN_LO.ALTKEYS_
     14779**DCL     14780--REDEF   14780--REDEF
OPEN_LO.HDR_
     14778**DCL     14779--REDEF
OPEN_LO.TAB_
     14777**DCL     14778--REDEF
OPEN_LO.UHL_
     14771**DCL     14772--REDEF   14772--REDEF
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:33   
OPEN_LO.V
     14780**DCL     14771--DCLINIT
OPEN_LO.V.FSN#
     14811**DCL     14811--REDEF   14811--REDEF
OPEN_LO.WSN_
     14777**DCL     14777--REDEF
OPEN_ROUTES
     14543**DCL     15204<>CALL
OPEN_ROUTES.ACSVEH_
     14545**DCL     14546--REDEF
OPEN_ROUTES.ALTKEYS_
     14551**DCL     14552--REDEF   14552--REDEF
OPEN_ROUTES.HDR_
     14550**DCL     14551--REDEF
OPEN_ROUTES.TAB_
     14549**DCL     14550--REDEF
OPEN_ROUTES.UHL_
     14543**DCL     14544--REDEF   14544--REDEF
OPEN_ROUTES.V
     14552**DCL     14543--DCLINIT
OPEN_ROUTES.V.FSN#
     14583**DCL     14583--REDEF   14583--REDEF
OPEN_ROUTES.WSN_
     14549**DCL     14549--REDEF
OUT$SYM.COUNT
     13974**DCL     13977--IMP-SIZ
PPR_ROUTECON
     14346**DCL     15183<>CALL
PPR_ROUTECON.V
     14346**DCL     14346--DCLINIT
PROMPT
     14185**DCL     15227--CALL
P_PCB
     14004**DCL     13984--DCLINIT 14386--DCLINIT
P_PCB$
     13984**DCL     15167<>CALL
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:34   
ROUTEACCT
     14206**DCL     14548--DCLINIT
ROUTES
     15026**DCL     14544--DCLINIT
ROUTES_ACSVEH
     14912**DCL     14546--DCLINIT
ROUTES_ACSVEH.Q
     14913**DCL     14912--DCLINIT
ROUTE_CMD
     13876**DCL     15227<>CALL
ROUTE_COMMAND
     13873**DCL-ENT 15229--CALL
ROUTE_END_FLG
     13985**DCL     15224<<ASSIGN  15226>>DOWHILE
ROUTE_WRITE
     13874**DCL-ENT 15214--CALL
SYSACCT
     14219**DCL     14666--DCLINIT
TOP$
     15113**DCL     13905--IMP-PTR 13951--IMP-PTR 15126--REDEF   15159--REDEF   15227<>CALL    15229<>CALL
     15235<>CALL
VLP_ERRCODE
     15126**DCL     15186<>CALL    15200<<ASSIGN  15201<>CALL    15206<<ASSIGN  15207<>CALL
VLP_ERRCODE.ERR#
     15156**DCL     15185<<ASSIGN  15236>>IF      15236>>IF
VLP_SETSTA
     15095**DCL     14662--DCLINIT
VLP_SETSTA.MYSTATION#
     15099**DCL     15196<<ASSIGN
VLR_MONINFO
     14248**DCL     14233--DCLINIT
VLR_SITEINFO
     14266**DCL     14233--DCLINIT
XTX$ADAPT
     14368**DCL-ENT 14447--DCLINIT
XUR$BREAK
PL6.E3A0      #001=ROUTECON File=KSX$ROUTECON.:E05TSI                            WED 07/30/97 01:48 Page:35   
     13869**DCL-ENT 14463--DCLINIT
XUR$ERRMSG
     13867**DCL-ENT 15186--CALL    15201--CALL    15207--CALL    15235--CALL
XUR$GETCMD
     13866**DCL-ENT 15227--CALL
XUR$INIT
     13870**DCL-ENT 15167--CALL
XUR$SETERRMSG
     13868**DCL-ENT 15171--CALL
XUR_INIT
     14373**DCL     15167<>CALL
XUR_INIT.WORKR_
     14387**DCL     14388--REDEF

PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:36   
      210        1        /*T***********************************************************/
      211        2        /*T*                                                         */
      212        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      213        4        /*T*                                                         */
      214        5        /*T***********************************************************/
      215        6
      216        7        /*F* NAME: BREAK
      217        8        */
      218        9
      219       10        BREAK: PROC;
      220       11
      221       12        %INCLUDE CP_6;
      222     5571        %INCLUDE KL_MACRO_C;
      223     8923    1   DCL ERROR_RETURN REMEMBER SYMREF;
      224     8924    1      CALL M$CLRSTK;
      225     8925    1      UNWIND TO ERROR_RETURN;
      226     8926    1   END BREAK;
      227     8927        %EOD;

PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:37   
--  Include file information  --

   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure BREAK.

   Procedure BREAK requires 7 words for executable code.
   Procedure BREAK requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:38   

 Object Unit name= BREAK                                      File name= KSX$ROUTECON.:E05TOU
 UTS= JUL 30 '97 01:49:56.52 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none     7      7  BREAK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  BREAK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  ERROR_RETURN
PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:39   


      210        1        /*T***********************************************************/
      211        2        /*T*                                                         */
      212        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      213        4        /*T*                                                         */
      214        5        /*T***********************************************************/
      215        6
      216        7        /*F* NAME: BREAK
      217        8        */
      218        9
      219       10        BREAK: PROC;

     10  1 000000   000000 700200 xent  BREAK        TSX0  ! X66_AUTO_0
         1 000001   000004 000000                    ZERO    4,0

      220       11
      221       12        %INCLUDE CP_6;
      222     5571        %INCLUDE KL_MACRO_C;
      223     8923    1   DCL ERROR_RETURN REMEMBER SYMREF;
      224     8924    1      CALL M$CLRSTK;

   8924  1 000002   010013 713400                    CLIMB   4107
         1 000003   000000 401760                    pmme    nvectors=0

      225     8925    1      UNWIND TO ERROR_RETURN;

   8925  1 000004   000000 237200 xsym               LDAQ  ! ERROR_RETURN
         1 000005   000000 700200 xent               TSX0  ! X66_AUNWIND
         1 000006   000000 000200                    ZERO    0,128
      226     8926    1   END BREAK;
      227     8927        %EOD;

PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:40   
--  Include file information  --

   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure BREAK.
PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:41   

 **** Variables and constants ****

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d REMB        r     1 ERROR_RETURN


   Procedure BREAK requires 7 words for executable code.
   Procedure BREAK requires 4 words of local(AUTO) storage.
PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:42   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=BREAK File=KSX$ROUTECON.:E05TSI                               WED 07/30/97 01:49 Page:43   
          MINI XREF LISTING

ERROR_RETURN
      8923**DCL      8925>>UNWIND
M$CLRSTK
      5557**DCL-ENT  8924--CALL

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:44   
      228        1        /*T***********************************************************/
      229        2        /*T*                                                         */
      230        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      231        4        /*T*                                                         */
      232        5        /*T***********************************************************/
      233        6
      234        7
      235        8        ROUTE_COMMAND: PROC(TOP$) ALTRET;
      236        9
      237       10
      238       11        %INCLUDE CP_6;
      239     5570        %INCLUDE CP_6_SUBS;
      240     6110        %INCLUDE B$JIT;
      241     6713        %INCLUDE XU_MACRO_C;
      242     9819        %INCLUDE KL_MACRO_C;
      243    13171        %INCLUDE KL_AFCN_C;
      244    13272        %INCLUDE K_ADDRESS_M;
      245    13775        %INCLUDE B_ERRORS_C;
      246    14902        %INCLUDE KSX_NODES_E;
      247    14942        %INCLUDE KS_PERR_C;
      248    15009    1   DCL TOP$ PTR;
      249    15010
      250    15011    1   DCL ROUTE_WRITE ENTRY(11);
      251    15012    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      252    15013    1   DCL WRHLPCG ENTRY(1) ALTRET;
      253    15014
      254    15015    1   DCL ROUTE_END_FLG BIT(1) SYMREF;
      255    15016    1   DCL B$JIT$ PTR SYMREF;
      256    15017    1   DCL B$TCB$ PTR SYMREF;
      257    15018        %B$ALT;
      258    15026        %B$TCB(STCLASS="BASED(B$TCB$)");
      259    15029
      260    15030        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      261    15075        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
      262    15113    1   DCL ADDRESS CHAR(LEN) BASED ALIGNED;
      263    15114
      264    15115        %VLR_MONINFO (FPTN=VLR_MONINFO, STCLASS=SYMREF);
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:45   
      265    15133
      266    15134        %VLP_ERRCODE(FPTN=ERR_C,STCLASS=CONSTANT,FCG=KS,MID=X,MON='0'B,SEV=0,ERR#=0);
      267    15179
      268    15180    1   DCL NSAPNAME_FMT CHAR(0) CONSTANT INIT('%2/nsap id     : %8.8..A');
      269    15181
      270    15182    1   DCL NSAPTYPE_FMT CHAR(0) CONSTANT INIT('
      271    15183    1   %...10Pnsap type   :%1.@4N[ local%2? remote%? unknown%]%10P');
      272    15184
      273    15185    1   DCL NWTYPE_FMT CHAR(0) CONSTANT INIT('
      274    15186    1   %...14Pnetwork type:%1.@4N[ x25_80%2? x25_84%3? iso_8348%? unknown%]%1Q');
      275    15187
      276    15188    1   DCL HOST_NODE_FMT CHAR(0) CONSTANT INIT('
      277    15189    1   %...18Phost node   :%3@.8D%..27P %1Q');
      278    15190
      279    15191    1   DCL FEP_NODE_FMT CHAR(0) CONSTANT INIT('
      280    15192    1   %...27Pfep node    :%3@.8D%/%10P%1Q');
      281    15193
      282    15194    1   DCL NSAP_FMT2 CHAR(0) CONSTANT  INIT(
             15194            '%1...72Pnsap  :  bytes : %@8N=%3.#KD addr: .%#...(%2@.8ZH%)%10P');
      283    15195
      284    15196    1   DCL NSAP_FMT3 CHAR(0) CONSTANT INIT(
             15196            '%1...270Plnsap :  bytes : %@8N=%3.#KD addr: .%#...(%2@.8ZH%)%10P');
      285    15197
      286    15198    1   DCL NSAP_FMT4 CHAR(0) CONSTANT INIT(
             15198            '%1...468Px.25  :  digits: %@8N=%1...468P%3@.8D addr: .%#...(%1@.4ZH%)%10P');
      287    15199
      288    15200
      289    15201        /*  formats to report afi and snpa
      290    15202
      291    15203        DCL NSAP_FMT2 CHAR(0) CONSTANT INIT('%1...72Pnsap :  len: %@8N=%1...72P%3@.8D afi :
             15203        .%2@.8H addr: .%#:1-...(%2@.8ZH%)%10P');
      292    15204
      293    15205        DCL NSAP_FMT3 CHAR(0) CONSTANT INIT('%1...270Plnsap:  len: %@8N=%1...270P%3@.8D afi
             15205        : .%2@.8H addr: .%#:1-...(%2@.8ZH%)%10P');
      294    15206
      295    15207        DCL NSAP_FMT4 CHAR(0) CONSTANT INIT('%1...468Psnpa :  len: %@8N=%1...468P%3@.8D addr
             15207        : .%#...(%1@.4ZH%)%10P');
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:46   
      296    15208
      297    15209        */
      298    15210
      299    15211    1   DCL HEX_DIGITS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
      300    15212
      301    15213    1   DCL 1 NSAP_KEY_C CONSTANT ALIGNED,
      302    15214    1         2 LEN UBIN BYTE UNAL INIT(8),
      303    15215    1         2 NSAPNAME CHAR(8) CALIGNED INIT(' ');
      304    15216
      305    15217    1   DCL 1 NSAP_KEY ALIGNED STATIC,
      306    15218    1         2 LEN UBIN BYTE UNAL,
      307    15219    1         2 NSAPNAME CHAR(8) CALIGNED;
      308    15220
      309    15221    1   DCL 1 LNSAP_KEY ALIGNED STATIC,
      310    15222    1         2 LEN UBIN BYTE UNAL,
      311    15223    1         2 NSAPNAME CHAR(8) CALIGNED;
      312    15224
      313    15225        %VLP_ERRCODE(FPTN=ERRCODE,STCLASS=AUTO);
      314    15270    1   DCL SUBLK$ PTR;
      315    15271    1   DCL SUBOPT$ PTR;
      316    15272    1   DCL OPTIONS$ PTR;
      317    15273    1   DCL I UBIN;
      318    15274    1   DCL J UBIN;
      319    15275    1   DCL K UBIN;
      320    15276    1   DCL L UBIN;
      321    15277    1   DCL LEN UBIN;
      322    15278    1   DCL HEX_CHAR CHAR(1);
      323    15279    1   DCL HEX_DIGIT UBIN WORD ALIGNED;
      324    15280
      325    15281    1   DCL FMT_VEC_ VECTOR DALIGNED;
      326    15282    1   DCL DAT_VEC1_ VECTOR DALIGNED;
      327    15283    1   DCL DAT_VEC2_ VECTOR DALIGNED;
      328    15284
      329    15285    1   DCL 1 ADDR_TMPLT ALIGNED,
      330    15286    1         2 BYT(0:20) UNAL,
      331    15287    1           3 * BIT(1),
      332    15288    1           3 HIGH_NIBBLE UBIN(4) UNAL,
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:47   
      333    15289    1           3 LOW_NIBBLE UBIN(4) UNAL;
      334    15290    1   DCL ENDOFILE BIT(1);
      335    15291
      336    15292        %KL_UPDOSI(FPTN=NSAP_DATA,STCLASS=STATIC);
      337    15501        %KL_UPDOSI(FPTN=LNSAP_DATA,STCLASS=AUTO);
      338    15710
      339    15711    1   DCL M$ROUTE DCB;
      340    15712
      341    15713        %FPT_READ(FPTN=READ_ROUTE,
      342    15714                  DCB=M$ROUTE,
      343    15715                  KEY=NSAP_KEY,
      344    15716                  KEYS=YES,
      345    15717                  BUF=NSAP_DATA,
      346    15718                  STCLASS=STATIC);
      347    15757
      348    15758        %FPT_WRITE(FPTN=WRITE_ROUTE,
      349    15759                  DCB=M$ROUTE,
      350    15760                  KEY=NSAP_KEY,
      351    15761                  BUF=NSAP_DATA,
      352    15762                  STCLASS=STATIC);
      353    15793
      354    15794        %FPT_PRECORD(FPTN=PRECORD_ROUTE,
      355    15795                   KEYS=YES,
      356    15796                   KEYR=YES,
      357    15797                   KEY=NSAP_KEY,
      358    15798                   DCB=M$ROUTE,
      359    15799                   STCLASS=STATIC);
      360    15820
      361    15821        %FPT_DELREC(FPTN=DELREC_ROUTE,
      362    15822                   KEY=NSAP_KEY,
      363    15823                   DCB=M$ROUTE,
      364    15824                   STCLASS=STATIC);
      365    15843        /*E*
      366    15844             ERROR: KSX-E$NSAP_ALREADY_DEFINED-0
      367    15845             MESSAGE: That nsap has all ready been defined, use delete
      368    15846        */
      369    15847
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:48   
      370    15848        /*E*
      371    15849             ERROR: KSX-E$NOT_DEFINED-0
      372    15850             MESSAGE: That nsap has not been defined
      373    15851        */
      374    15852        /*E*
      375    15853             ERROR: KSX-E$PADDED_WITH_ZEROS-0
      376    15854             MESSAGE: The pai has been padded with zeros by default.
      377    15855             MESSAGE1: Some afis require padding with 'F'.
      378    15856             MESSAGE2: This processor doesn't do that for you.
      379    15857        */
      380    15858        /*E*
      381    15859             ERROR: KSX-E$LNSAP_NOT_DEFINED-0
      382    15860             MESSAGE: The specified LNSAP has not been defined.
      383    15861        */
      384    15862        /*E*
      385    15863             ERROR: KSX-E$NOT_LNSAP-0
      386    15864             MESSAGE: The local nsap specifed is, in fact, not a local nsap.
      387    15865        */
      388    15866        /*E*
      389    15867             ERROR: KSX-E$NSAPDEFINEDOK-0
      390    15868             MESSAGE: Nsap %U1 defined.
      391    15869        */
      392    15870        /*E*
      393    15871             ERROR: KSX-E$NSAPDELETEDOK-0
      394    15872             MESSAGE: Nsap %U1 deleted.
      395    15873        */
      396    15874        %EJECT;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:49   
      397    15875
      398    15876    1      NSAP_KEY = NSAP_KEY_C;
      399    15877    1      ERRCODE = ERR_C;
      400    15878
      401    15879    2      DO CASE(OUT$BLK.CODE);
      402    15880
      403    15881    2       CASE(0);                            /* MULTIPLE COMMANDS                  */
      404    15882    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;
      405    15883    3              CALL ROUTE_COMMAND(OUT$BLK.SUBLK$(I));
      406    15884    3              END;
      407    15885
      408    15886    2       CASE(%ROUTE_DISPLAY#);
      409    15887    2         IF OUT$BLK.NSUBLKS ~= 0
      410    15888    3         THEN DO;
      411    15889    3              READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);
      412    15890    3              READ_ROUTE.BUF_ = VECTOR(NSAP_DATA);
      413    15891    3              NSAP_KEY.NSAPNAME = OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      414    15892    3              CALL M$READ(READ_ROUTE)
      415    15893    4              WHENALTRETURN DO;
      416    15894    4                   ERRCODE.ERR# = %E$NOT_DEFINED;
      417    15895    4                   CALL XUR$ERRMSG(ERRCODE);
      418    15896    4                   ALTRETURN;
      419    15897    4                   END;
      420    15898
      421    15899    3              CALL DISPLAY_NSAP_INFO;
      422    15900
      423    15901    3              END/*display single nsap*/;
      424    15902    3         ELSE DO;
      425    15903    3              NSAP_KEY = '0'B;
      426    15904    3              NSAP_DATA = '0'B;
      427    15905    3              NSAP_KEY.LEN = NSAP_KEY_C.LEN;
      428    15906    3              PRECORD_ROUTE.V.N# = 0;
      429    15907    3              READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);
      430    15908    3              READ_ROUTE.BUF_ = VECTOR(NSAP_DATA);
      431    15909    3              CALL M$PRECORD(PRECORD_ROUTE)
      432    15910    4              WHENALTRETURN DO;
      433    15911                                                /* expected*/
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:50   
      434    15912    4                   END;
      435    15913
      436    15914    3              ENDOFILE = '0'B;
      437    15915    3              PRECORD_ROUTE.V.N# = 1;
      438    15916    4              DO WHILE NOT(ENDOFILE);
      439    15917    4                   CALL M$READ(READ_ROUTE)
      440    15918    5                   WHENALTRETURN DO;
      441    15919    5                        RETURN;
      442    15920    5                        END;
      443    15921
      444    15922    4                   CALL DISPLAY_NSAP_INFO;
      445    15923
      446    15924    4                   CALL M$PRECORD(PRECORD_ROUTE)
      447    15925    5                   WHENALTRETURN DO;
      448    15926    5                        ENDOFILE = '1'B;
      449    15927    5                        END;
      450    15928    4                   END/*while not eof*/;
      451    15929    3              END/*display all*/;
      452    15930
      453    15931
      454    15932    2       CASE(%ROUTE_DEFINE#);
      455    15933    2         NSAP_DATA = '0'B;
      456    15934    2         NSAP_DATA.NW_TYPE = %K_NWTYPE_X2584;
      457    15935
      458    15936    2         NSAP_KEY = NSAP_KEY_C;
      459    15937    2         NSAP_KEY.NSAPNAME = OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      460    15938    2         READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);
      461    15939
      462    15940    2         CALL M$READ(READ_ROUTE)
      463    15941    3         WHENRETURN DO;                    /* nsap is all ready defined*/
      464    15942    3              ERRCODE.ERR# = %E$NSAP_ALREADY_DEFINED;
      465    15943    3              CALL XUR$ERRMSG(ERRCODE);
      466    15944    3              RETURN;
      467    15945    3              END;
      468    15946
      469    15947    2         NSAP_DATA.FCN = IGA_UPDOSI;
      470    15948
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:51   
      471    15949        /* Determine if this is a local or remote NSAP id.
      472    15950        */
      473    15951    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE = %ROUTE_LNSAP#
      474    15952    2         THEN NSAP_DATA.NS_TYPE = %K_TYPE_LNSAP;
      475    15953    2         ELSE NSAP_DATA.NS_TYPE = %K_TYPE_RNSAP;
      476    15954
      477    15955    2         I = OUT$BLK.SUBLK$(1)->OUT$BLK.NSUBLKS;
      478    15956    2         OPTIONS$ = OUT$BLK.SUBLK$(1);
      479    15957    3         DO J = 0 TO I-1;
      480    15958    3              SUBOPT$ = OPTIONS$->OUT$BLK.SUBLK$(J);
      481    15959    4              DO CASE (SUBOPT$->OUT$BLK.CODE);
      482    15960
      483    15961    4               CASE(%ROUTE_PAI#, %ROUTE_NSAP#);
      484    15962    4                 ADDR_TMPLT = '0'B;
      485    15963    4                 NSAP_DATA.NSAP.LEN = SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
      486    15964
      487    15965    4                 IF MOD(NSAP_DATA.NSAP.LEN,2) ~= 0
      488    15966    4                 THEN LEN = NSAP_DATA.NSAP.LEN - 1;
      489    15967    4                 ELSE LEN = NSAP_DATA.NSAP.LEN;
      490    15968
      491    15969    4                 L = 0;
      492    15970    5                 DO K = 0 TO LEN - 1 BY 2;
      493    15971    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K,1);
      494    15972    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);
      495    15973    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;
      496    15974    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K+1,1)
             15974                               ;
      497    15975    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);
      498    15976    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = HEX_DIGIT;
      499    15977    5                      L = L + 1;
      500    15978    5                      END;
      501    15979
      502    15980    4                 IF LEN ~= NSAP_DATA.NSAP.LEN
      503    15981    5                 THEN DO;
      504    15982    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,LEN,1)
             15982                               ;
      505    15983    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:52   
      506    15984    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;
      507    15985    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = 0; /* pad the address       */
      508    15986    5                      ERRCODE.ERR# = %E$PADDED_WITH_ZEROS;
      509    15987    5                      CALL XUR$ERRMSG(ERRCODE);
      510    15988    5                      END;
      511    15989
      512    15990    4                 LEN = (NSAP_DATA.NSAP.LEN + 1)/2;
      513    15991    4                 ADDR(NSAP_DATA.NSAP.AFI)->ADDRESS = ADDR(ADDR_TMPLT)->ADDRESS;
      514    15992    4                 NSAP_DATA.NSAP.LEN = LEN; /* store address in terms of bytes*/
      515    15993
      516    15994    4               CASE(%ROUTE_LOCAL_NSAP#);
      517    15995    4                 LNSAP_DATA = '0'B;
      518    15996    4                 LNSAP_KEY = NSAP_KEY_C;
      519    15997    4                 LNSAP_KEY.NSAPNAME = SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
             15997                          OUT$SYM.TEXT;
      520    15998    4                 READ_ROUTE.KEY_ = VECTOR(LNSAP_KEY);
      521    15999    4                 READ_ROUTE.BUF_ = VECTOR(LNSAP_DATA);
      522    16000
      523    16001    4                 CALL M$READ(READ_ROUTE)
      524    16002    5                 WHENALTRETURN DO;
      525    16003    5                      ERRCODE.ERR# = %E$LNSAP_NOT_DEFINED;
      526    16004    5                      CALL XUR$ERRMSG(ERRCODE);
      527    16005    5                      ALTRETURN;
      528    16006    5                      END;
      529    16007
      530    16008    4                 IF LNSAP_DATA.NS_TYPE ~= %K_TYPE_LNSAP
      531    16009    5                 THEN DO;
      532    16010    5                      ERRCODE.ERR# = %E$NOT_LNSAP;
      533    16011    5                      CALL XUR$ERRMSG(ERRCODE);
      534    16012    5                      RETURN;
      535    16013    5                      END;
      536    16014    4                 NSAP_DATA.LNSAP = LNSAP_DATA.NSAP;
      537    16015
      538    16016    4               CASE(%ROUTE_SNPA#, %ROUTE_X25#);
      539    16017    4                 ADDR_TMPLT = '0'B;
      540    16018    4                 NSAP_DATA.SNPA.LEN = SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;
      541    16019
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:53   
      542    16020    4                 IF MOD(NSAP_DATA.SNPA.LEN,2) ~= 0
      543    16021    4                 THEN LEN = NSAP_DATA.SNPA.LEN - 1;
      544    16022    4                 ELSE LEN = NSAP_DATA.SNPA.LEN;
      545    16023
      546    16024    4                 L = 0;
      547    16025    5                 DO K = 0 TO LEN - 1 BY 2;
      548    16026    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K,1);
      549    16027    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);
      550    16028    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;
      551    16029    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K+1,1)
             16029                               ;
      552    16030    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);
      553    16031    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = HEX_DIGIT;
      554    16032    5                      L = L + 1;
      555    16033    5                      END;
      556    16034
      557    16035    4                 IF LEN ~= NSAP_DATA.SNPA.LEN
      558    16036    5                 THEN DO;
      559    16037    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,LEN,1)
             16037                               ;
      560    16038    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);
      561    16039    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;
      562    16040    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = 0;/* just to be sure        */
      563    16041    5                      END;
      564    16042
      565    16043    4                 LEN = (NSAP_DATA.SNPA.LEN+1)/2;
      566    16044    4                 ADDR(NSAP_DATA.SNPA.ADDRESS)->ADDRESS = ADDR(ADDR_TMPLT)->ADDRESS;
      567    16045
      568    16046    4               CASE(%ROUTE_NW_TYPE#);
      569    16047    4                 IF SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.CODE = %ROUTE_NW_ISO8348#
      570    16048    4                 THEN NSAP_DATA.NW_TYPE = %K_NWTYPE_ISO8348;
      571    16049    4                 ELSE IF SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.CODE = %ROUTE_NW_1984#
      572    16050    4                      THEN NSAP_DATA.NW_TYPE = %K_NWTYPE_X2584;
      573    16051    4                      ELSE NSAP_DATA.NW_TYPE = %K_NWTYPE_X2580;
      574    16052
      575    16053    4               CASE(%ROUTE_FEP#);
      576    16054    4                 CALL CHARBIN(K,SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:54   
      577    16055    4                 NSAP_DATA.FEP# = K;
      578    16056
      579    16057    4               CASE(%ROUTE_HOST#);
      580    16058    4                 CALL CHARBIN(K,SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);
      581    16059    4                 NSAP_DATA.HOST# = K;
      582    16060
      583    16061    4                 END;                      /* do case options                    */
      584    16062    3              END;                         /* do j                               */
      585    16063
      586    16064    2         IF NSAP_DATA.NS_TYPE=%K_TYPE_LNSAP AND NSAP_DATA.HOST#=0
      587    16065    2         THEN NSAP_DATA.HOST# = VLR_MONINFO.NODE#;
      588    16066
      589    16067    2         WRITE_ROUTE.KEY_ = VECTOR(NSAP_KEY);
      590    16068    2         WRITE_ROUTE.BUF_ = VECTOR(NSAP_DATA);
      591    16069    3         CALL M$WRITE(WRITE_ROUTE) WHENALTRETURN DO;
      592    16070    3              CALL XUR$ERRMSG(B$TCB.ALT$->B$ALT.ERR);
      593    16071    3              ALTRETURN;
      594    16072    3              END;
      595    16073    2         NSAP_DATA.FCN = IGA_UPDOSI;
      596    16074    2         CALL WRHLPCG(VECTOR(NSAP_DATA))
      597    16075    3         WHENALTRETURN DO;
      598    16076    3              ALTRETURN;                   /* error message written by wrhlpcg*/
      599    16077    3              END;
      600    16078
      601    16079        /* Indicate nsap_id definition was successful.
      602    16080        */
      603    16081    2         ERRCODE = ERR_C;
      604    16082    2         ERRCODE.ERR# = %E$NSAPDEFINEDOK;
      605    16083    2         CALL XUR$ERRMSG(ERRCODE,,,VECTOR(NSAP_KEY));
      606    16084
      607    16085    2       CASE(%ROUTE_DELETE#);
      608    16086    2         NSAP_KEY = NSAP_KEY_C;
      609    16087    2         NSAP_KEY.NSAPNAME = OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;
      610    16088    2         READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);
      611    16089    2         READ_ROUTE.BUF_ = VECTOR(NSAP_DATA);
      612    16090
      613    16091    2         CALL M$READ(READ_ROUTE)
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:55   
      614    16092    3         WHENRETURN DO;
      615    16093    3              CALL M$DELREC(DELREC_ROUTE) ALTRET(NOT_DEFINED);
      616    16094    3              NSAP_DATA.FCN = IGA_DELOSI;
      617    16095    3              CALL WRHLPCG(VECTOR(NSAP_DATA))
      618    16096    4              WHENALTRETURN DO;
      619    16097    4                   RETURN;                 /* error written by rdhlpcg           */
      620    16098    4                   END;
      621    16099    3              END/*read_route return*/;
      622    16100
      623    16101    3         WHENALTRETURN DO;
      624    16102    3   NOT_DEFINED:
      625    16103    3              ERRCODE.ERR# = %E$NOT_DEFINED;
      626    16104    3              CALL XUR$ERRMSG(ERRCODE);
      627    16105    3              ALTRETURN;
      628    16106    3              END/*read_route altreturn*/;
      629    16107
      630    16108        /* Indicate delete was successful.
      631    16109        */
      632    16110    2         ERRCODE = ERR_C;
      633    16111    2         ERRCODE.ERR# = %E$NSAPDELETEDOK;
      634    16112    2         CALL XUR$ERRMSG(ERRCODE,,,VECTOR(NSAP_KEY));
      635    16113
      636    16114
      637    16115
      638    16116    2       CASE(%ROUTE_END#);
      639    16117    2         ROUTE_END_FLG = '1'B;
      640    16118
      641    16119
      642    16120    2       CASE(%ROUTE_NULL#);
      643    16121                                                /* allows blank lines                 */
      644    16122    2         END/*do case*/;
      645    16123        %EJECT;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:56   
      646    16124
      647    16125    1   DISPLAY_NSAP_INFO: PROC;
      648    16126    2      FMT_VEC_ = VECTOR(NSAPNAME_FMT);     /*NSAP_name:                          */
      649    16127    2      DAT_VEC1_ = VECTOR(NSAP_KEY.NSAPNAME);
      650    16128    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      651    16129
      652    16130    2      DAT_VEC1_ = VECTOR(NSAP_DATA);
      653    16131
      654    16132    2      FMT_VEC_ = VECTOR(NSAPTYPE_FMT);     /*nsap type*/
      655    16133    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      656    16134
      657    16135    2      IF NSAP_DATA.NS_TYPE = %K_TYPE_RNSAP
      658    16136    3      THEN DO;
      659    16137    3           FMT_VEC_ = VECTOR(NWTYPE_FMT);  /*network type*/
      660    16138    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      661    16139    3           END;
      662    16140    3      ELSE DO;
      663    16141    3           FMT_VEC_ = VECTOR(HOST_NODE_FMT); /*host#:                            */
      664    16142    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      665    16143    3           END;
      666    16144
      667    16145    2      FMT_VEC_ = VECTOR(FEP_NODE_FMT);     /*fep#:                               */
      668    16146    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      669    16147
      670    16148    2      FMT_VEC_ = VECTOR(NSAP_FMT2);        /*nsap:                               */
      671    16149    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      672    16150
      673    16151    2      IF NSAP_DATA.NS_TYPE = %K_TYPE_RNSAP
      674    16152    3      THEN DO;
      675    16153    3           FMT_VEC_ = VECTOR(NSAP_FMT3);   /*lnsap:                              */
      676    16154    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      677    16155
      678    16156    3           FMT_VEC_ = VECTOR(NSAP_FMT4);   /*x.25                                */
      679    16157    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);
      680    16158    3           END;
      681    16159
      682    16160    2      RETURN;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:57   
      683    16161    2   END DISPLAY_NSAP_INFO;
      684    16162
      685    16163    1   END ROUTE_COMMAND;
      686    16164        %EOD;

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:58   
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KSX_NODES_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ROUTE_COMMAND.

   Procedure ROUTE_COMMAND requires 741 words for executable code.
   Procedure ROUTE_COMMAND requires 50 words of local(AUTO) storage.

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:59   

 Object Unit name= ROUTE_COMMAND                              File name= KSX$ROUTECON.:E05TOU
 UTS= JUL 30 '97 01:50:23.40 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    116    164  ROUTE_COMMAND
    2   Data  even  none    68    104  ROUTE_COMMAND
    3   DCB   even  none     0      0  M$ROUTE
    4   Proc  even  none   741   1345  ROUTE_COMMAND
    5  RoData even  none    30     36  ROUTE_COMMAND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes    yes     yes      Std        1  ROUTE_COMMAND

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 WRHLPCG
 yes     yes           Std       7 XUR$ERRMSG
         yes           Std      11 ROUTE_WRITE
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:60   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  ROUTE_END_FLG                         B$JIT$
     B$TCB$                                VLR_MONINFO                           M$ROUTE
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:61   


      228        1        /*T***********************************************************/
      229        2        /*T*                                                         */
      230        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      231        4        /*T*                                                         */
      232        5        /*T***********************************************************/
      233        6
      234        7
      235        8        ROUTE_COMMAND: PROC(TOP$) ALTRET;

      8  4 000000   000000 700200 xent  ROUTE_COMMA* TSX0  ! X66_AUTO_1
         4 000001   000062 000001                    ZERO    50,1

      236        9
      237       10
      238       11        %INCLUDE CP_6;
      239     5570        %INCLUDE CP_6_SUBS;
      240     6110        %INCLUDE B$JIT;
      241     6713        %INCLUDE XU_MACRO_C;
      242     9819        %INCLUDE KL_MACRO_C;
      243    13171        %INCLUDE KL_AFCN_C;
      244    13272        %INCLUDE K_ADDRESS_M;
      245    13775        %INCLUDE B_ERRORS_C;
      246    14902        %INCLUDE KSX_NODES_E;
      247    14942        %INCLUDE KS_PERR_C;
      248    15009    1   DCL TOP$ PTR;
      249    15010
      250    15011    1   DCL ROUTE_WRITE ENTRY(11);
      251    15012    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      252    15013    1   DCL WRHLPCG ENTRY(1) ALTRET;
      253    15014
      254    15015    1   DCL ROUTE_END_FLG BIT(1) SYMREF;
      255    15016    1   DCL B$JIT$ PTR SYMREF;
      256    15017    1   DCL B$TCB$ PTR SYMREF;
      257    15018        %B$ALT;
      258    15026        %B$TCB(STCLASS="BASED(B$TCB$)");
      259    15029
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:62   
      260    15030        %PARSE$OUT (NAME=OUT$BLK,STCLASS="BASED(TOP$)");
      261    15075        %PARSE$SYM(NAME=OUT$SYM,STCLASS="BASED(TOP$)");
      262    15113    1   DCL ADDRESS CHAR(LEN) BASED ALIGNED;
      263    15114
      264    15115        %VLR_MONINFO (FPTN=VLR_MONINFO, STCLASS=SYMREF);
      265    15133
      266    15134        %VLP_ERRCODE(FPTN=ERR_C,STCLASS=CONSTANT,FCG=KS,MID=X,MON='0'B,SEV=0,ERR#=0);
      267    15179
      268    15180    1   DCL NSAPNAME_FMT CHAR(0) CONSTANT INIT('%2/nsap id     : %8.8..A');
      269    15181
      270    15182    1   DCL NSAPTYPE_FMT CHAR(0) CONSTANT INIT('
      271    15183    1   %...10Pnsap type   :%1.@4N[ local%2? remote%? unknown%]%10P');
      272    15184
      273    15185    1   DCL NWTYPE_FMT CHAR(0) CONSTANT INIT('
      274    15186    1   %...14Pnetwork type:%1.@4N[ x25_80%2? x25_84%3? iso_8348%? unknown%]%1Q');
      275    15187
      276    15188    1   DCL HOST_NODE_FMT CHAR(0) CONSTANT INIT('
      277    15189    1   %...18Phost node   :%3@.8D%..27P %1Q');
      278    15190
      279    15191    1   DCL FEP_NODE_FMT CHAR(0) CONSTANT INIT('
      280    15192    1   %...27Pfep node    :%3@.8D%/%10P%1Q');
      281    15193
      282    15194    1   DCL NSAP_FMT2 CHAR(0) CONSTANT  INIT(
             15194            '%1...72Pnsap  :  bytes : %@8N=%3.#KD addr: .%#...(%2@.8ZH%)%10P');
      283    15195
      284    15196    1   DCL NSAP_FMT3 CHAR(0) CONSTANT INIT(
             15196            '%1...270Plnsap :  bytes : %@8N=%3.#KD addr: .%#...(%2@.8ZH%)%10P');
      285    15197
      286    15198    1   DCL NSAP_FMT4 CHAR(0) CONSTANT INIT(
             15198            '%1...468Px.25  :  digits: %@8N=%1...468P%3@.8D addr: .%#...(%1@.4ZH%)%10P');
      287    15199
      288    15200
      289    15201        /*  formats to report afi and snpa
      290    15202
      291    15203        DCL NSAP_FMT2 CHAR(0) CONSTANT INIT('%1...72Pnsap :  len: %@8N=%1...72P%3@.8D afi :
             15203        .%2@.8H addr: .%#:1-...(%2@.8ZH%)%10P');
      292    15204
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:63   
      293    15205        DCL NSAP_FMT3 CHAR(0) CONSTANT INIT('%1...270Plnsap:  len: %@8N=%1...270P%3@.8D afi
             15205        : .%2@.8H addr: .%#:1-...(%2@.8ZH%)%10P');
      294    15206
      295    15207        DCL NSAP_FMT4 CHAR(0) CONSTANT INIT('%1...468Psnpa : len: %@8N=%1...468P%3@.8D addr
             15207        : .%#...(%1@.4ZH%)%10P');
      296    15208
      297    15209        */
      298    15210
      299    15211    1   DCL HEX_DIGITS CHAR(0) CONSTANT INIT('0123456789ABCDEF');
      300    15212
      301    15213    1   DCL 1 NSAP_KEY_C CONSTANT ALIGNED,
      302    15214    1         2 LEN UBIN BYTE UNAL INIT(8),
      303    15215    1         2 NSAPNAME CHAR(8) CALIGNED INIT(' ');
      304    15216
      305    15217    1   DCL 1 NSAP_KEY ALIGNED STATIC,
      306    15218    1         2 LEN UBIN BYTE UNAL,
      307    15219    1         2 NSAPNAME CHAR(8) CALIGNED;
      308    15220
      309    15221    1   DCL 1 LNSAP_KEY ALIGNED STATIC,
      310    15222    1         2 LEN UBIN BYTE UNAL,
      311    15223    1         2 NSAPNAME CHAR(8) CALIGNED;
      312    15224
      313    15225        %VLP_ERRCODE(FPTN=ERRCODE,STCLASS=AUTO);
      314    15270    1   DCL SUBLK$ PTR;
      315    15271    1   DCL SUBOPT$ PTR;
      316    15272    1   DCL OPTIONS$ PTR;
      317    15273    1   DCL I UBIN;
      318    15274    1   DCL J UBIN;
      319    15275    1   DCL K UBIN;
      320    15276    1   DCL L UBIN;
      321    15277    1   DCL LEN UBIN;
      322    15278    1   DCL HEX_CHAR CHAR(1);
      323    15279    1   DCL HEX_DIGIT UBIN WORD ALIGNED;
      324    15280
      325    15281    1   DCL FMT_VEC_ VECTOR DALIGNED;
      326    15282    1   DCL DAT_VEC1_ VECTOR DALIGNED;
      327    15283    1   DCL DAT_VEC2_ VECTOR DALIGNED;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:64   
      328    15284
      329    15285    1   DCL 1 ADDR_TMPLT ALIGNED,
      330    15286    1         2 BYT(0:20) UNAL,
      331    15287    1           3 * BIT(1),
      332    15288    1           3 HIGH_NIBBLE UBIN(4) UNAL,
      333    15289    1           3 LOW_NIBBLE UBIN(4) UNAL;
      334    15290    1   DCL ENDOFILE BIT(1);
      335    15291
      336    15292        %KL_UPDOSI(FPTN=NSAP_DATA,STCLASS=STATIC);
      337    15501        %KL_UPDOSI(FPTN=LNSAP_DATA,STCLASS=AUTO);
      338    15710
      339    15711    1   DCL M$ROUTE DCB;
      340    15712
      341    15713        %FPT_READ(FPTN=READ_ROUTE,
      342    15714                  DCB=M$ROUTE,
      343    15715                  KEY=NSAP_KEY,
      344    15716                  KEYS=YES,
      345    15717                  BUF=NSAP_DATA,
      346    15718                  STCLASS=STATIC);
      347    15757
      348    15758        %FPT_WRITE(FPTN=WRITE_ROUTE,
      349    15759                  DCB=M$ROUTE,
      350    15760                  KEY=NSAP_KEY,
      351    15761                  BUF=NSAP_DATA,
      352    15762                  STCLASS=STATIC);
      353    15793
      354    15794        %FPT_PRECORD(FPTN=PRECORD_ROUTE,
      355    15795                   KEYS=YES,
      356    15796                   KEYR=YES,
      357    15797                   KEY=NSAP_KEY,
      358    15798                   DCB=M$ROUTE,
      359    15799                   STCLASS=STATIC);
      360    15820
      361    15821        %FPT_DELREC(FPTN=DELREC_ROUTE,
      362    15822                   KEY=NSAP_KEY,
      363    15823                   DCB=M$ROUTE,
      364    15824                   STCLASS=STATIC);
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:65   
      365    15843        /*E*
      366    15844             ERROR: KSX-E$NSAP_ALREADY_DEFINED-0
      367    15845             MESSAGE: That nsap has all ready been defined, use delete
      368    15846        */
      369    15847
      370    15848        /*E*
      371    15849             ERROR: KSX-E$NOT_DEFINED-0
      372    15850             MESSAGE: That nsap has not been defined
      373    15851        */
      374    15852        /*E*
      375    15853             ERROR: KSX-E$PADDED_WITH_ZEROS-0
      376    15854             MESSAGE: The pai has been padded with zeros by default.
      377    15855             MESSAGE1: Some afis require padding with 'F'.
      378    15856             MESSAGE2: This processor doesn't do that for you.
      379    15857        */
      380    15858        /*E*
      381    15859             ERROR: KSX-E$LNSAP_NOT_DEFINED-0
      382    15860             MESSAGE: The specified LNSAP has not been defined.
      383    15861        */
      384    15862        /*E*
      385    15863             ERROR: KSX-E$NOT_LNSAP-0
      386    15864             MESSAGE: The local nsap specifed is, in fact, not a local nsap.
      387    15865        */
      388    15866        /*E*
      389    15867             ERROR: KSX-E$NSAPDEFINEDOK-0
      390    15868             MESSAGE: Nsap %U1 defined.
      391    15869        */
      392    15870        /*E*
      393    15871             ERROR: KSX-E$NSAPDELETEDOK-0
      394    15872             MESSAGE: Nsap %U1 deleted.
      395    15873        */
      396    15874        %EJECT;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:66   
      397    15875
      398    15876    1      NSAP_KEY = NSAP_KEY_C;

  15876  4 000002   000000 100400                    MLR     fill='000'O
         4 000003   000161 000011 1                  ADSC9   NSAP_KEY_C               cn=0,n=9
         4 000004   000000 000011 2                  ADSC9   NSAP_KEY                 cn=0,n=9

      399    15877    1      ERRCODE = ERR_C;

  15877  4 000005   000000 236000 1                  LDQ     ERR_C
         4 000006   200004 756100                    STQ     ERRCODE,,AUTO

      400    15878
      401    15879    2      DO CASE(OUT$BLK.CODE);

  15879  4 000007   200003 470500                    LDP0    @TOP$,,AUTO
         4 000010   000000 471500                    LDP1    0,,PR0
         4 000011   100000 720100                    LXL0    0,,PR1
         4 000012   000017 100003                    CMPX0   15,DU
         4 000013   000015 602010 4                  TNC     s:15879+6,X0
         4 000014   001203 710000 4                  TRA     s:16122
         4 000015   000034 710000 4                  TRA     s:15882
         4 000016   001200 710000 4                  TRA     s:16117
         4 000017   001203 710000 4                  TRA     s:16122
         4 000020   001203 710000 4                  TRA     s:16122
         4 000021   001103 710000 4                  TRA     s:16086
         4 000022   001203 710000 4                  TRA     s:16122
         4 000023   001203 710000 4                  TRA     s:16122
         4 000024   001203 710000 4                  TRA     s:16122
         4 000025   001203 710000 4                  TRA     s:16122
         4 000026   001203 710000 4                  TRA     s:16122
         4 000027   001203 710000 4                  TRA     s:16122
         4 000030   001203 710000 4                  TRA     s:16122
         4 000031   001203 710000 4                  TRA     s:16122
         4 000032   000062 710000 4                  TRA     s:15887
         4 000033   000174 710000 4                  TRA     s:15933

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:67   
      402    15880
      403    15881    2       CASE(0);                            /* MULTIPLE COMMANDS                  */

      404    15882    3         DO I = 0 TO OUT$BLK.NSUBLKS - 1;

  15882  4 000034   200010 450100                    STZ     I,,AUTO
         4 000035   000052 710000 4                  TRA     s:15884+3

      405    15883    3              CALL ROUTE_COMMAND(OUT$BLK.SUBLK$(I));

  15883  4 000036   200003 470500                    LDP0    @TOP$,,AUTO
         4 000037   000000 471500                    LDP1    0,,PR0
         4 000040   200010 720100                    LXL0    I,,AUTO
         4 000041   100003 633510                    EPPR3   3,X0,PR1
         4 000042   200056 453500                    STP3    LNSAP_DATA+17,,AUTO
         4 000043   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 000044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000045   000000 701000 4                  TSX1    s:8
         4 000046   000000 011000                    NOP     0

      406    15884    3              END;

  15884  4 000047   200010 235100                    LDA     I,,AUTO
         4 000050   000001 035007                    ADLA    1,DL
         4 000051   200010 755100                    STA     I,,AUTO
         4 000052   200003 470500                    LDP0    @TOP$,,AUTO
         4 000053   000000 471500                    LDP1    0,,PR0
         4 000054   100001 236100                    LDQ     1,,PR1
         4 000055   000022 772000                    QRL     18
         4 000056   200010 116100                    CMPQ    I,,AUTO
         4 000057   000061 600000 4                  TZE     s:15884+10
         4 000060   000036 603000 4                  TRC     s:15883
         4 000061   001203 710000 4                  TRA     s:16122

      407    15885
      408    15886    2       CASE(%ROUTE_DISPLAY#);

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:68   
      409    15887    2         IF OUT$BLK.NSUBLKS ~= 0

  15887  4 000062   100001 221100                    LDX1    1,,PR1
         4 000063   000124 600000 4                  TZE     s:15903

      410    15888    3         THEN DO;

      411    15889    3              READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);

  15889  4 000064   000000 237000 5                  LDAQ    0
         4 000065   000030 757000 2                  STAQ    READ_ROUTE+2

      412    15890    3              READ_ROUTE.BUF_ = VECTOR(NSAP_DATA);

  15890  4 000066   000002 237000 5                  LDAQ    2
         4 000067   000032 757000 2                  STAQ    READ_ROUTE+4

      413    15891    3              NSAP_KEY.NSAPNAME = OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  15891  4 000070   000000 471500                    LDP1    0,,PR0
         4 000071   100003 473500                    LDP3    3,,PR1
         4 000072   300003 474500                    LDP4    3,,PR3
         4 000073   400004 236100                    LDQ     4,,PR4
         4 000074   000033 772000                    QRL     27
         4 000075   000000 620006                    EAX0    0,QL
         4 000076   040000 100540                    MLR     fill='040'O
         4 000077   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         4 000100   000000 200010 2                  ADSC9   NSAP_KEY                 cn=1,n=8

      414    15892    3              CALL M$READ(READ_ROUTE)

  15892  4 000101   000026 630400 2                  EPPR0   READ_ROUTE
         4 000102   440000 713400                    CLIMB   alt,read
         4 000103   401400 401760                    pmme    nvectors=4
         4 000104   000106 702000 4                  TSX2    s:15894
         4 000105   000121 710000 4                  TRA     s:15899

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:69   
      415    15893    4              WHENALTRETURN DO;

      416    15894    4                   ERRCODE.ERR# = %E$NOT_DEFINED;

  15894  4 000106   200004 236100                    LDQ     ERRCODE,,AUTO
         4 000107   000004 376000 5                  ANQ     4
         4 000110   001470 276007                    ORQ     824,DL
         4 000111   200004 756100                    STQ     ERRCODE,,AUTO

      417    15895    4                   CALL XUR$ERRMSG(ERRCODE);

  15895  4 000112   200004 630500                    EPPR0   ERRCODE,,AUTO
         4 000113   200056 450500                    STP0    LNSAP_DATA+17,,AUTO
         4 000114   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 000115   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000116   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000117   000000 011000                    NOP     0

      418    15896    4                   ALTRETURN;

  15896  4 000120   000000 702200 xent               TSX2  ! X66_AALT

      419    15897    4                   END;
      420    15898
      421    15899    3              CALL DISPLAY_NSAP_INFO;

  15899  4 000121   001204 701000 4                  TSX1    DISPLAY_NSAP_INFO
         4 000122   000000 011000                    NOP     0

      422    15900
      423    15901    3              END/*display single nsap*/;

  15901  4 000123   001203 710000 4                  TRA     s:16122

      424    15902    3         ELSE DO;

      425    15903    3              NSAP_KEY = '0'B;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:70   

  15903  4 000124   000000 100400                    MLR     fill='000'O
         4 000125   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000126   000000 000011 2                  ADSC9   NSAP_KEY                 cn=0,n=9

      426    15904    3              NSAP_DATA = '0'B;

  15904  4 000127   000000 100400                    MLR     fill='000'O
         4 000130   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000131   000006 000074 2                  ADSC9   NSAP_DATA                cn=0,n=60

      427    15905    3              NSAP_KEY.LEN = NSAP_KEY_C.LEN;

  15905  4 000132   000161 236000 1                  LDQ     NSAP_KEY_C
         4 000133   000000 552040 2                  STBQ    NSAP_KEY,'40'O

      428    15906    3              PRECORD_ROUTE.V.N# = 0;

  15906  4 000134   000067 450000 2                  STZ     PRECORD_ROUTE+7

      429    15907    3              READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);

  15907  4 000135   000000 237000 5                  LDAQ    0
         4 000136   000030 757000 2                  STAQ    READ_ROUTE+2

      430    15908    3              READ_ROUTE.BUF_ = VECTOR(NSAP_DATA);

  15908  4 000137   000002 237000 5                  LDAQ    2
         4 000140   000032 757000 2                  STAQ    READ_ROUTE+4

      431    15909    3              CALL M$PRECORD(PRECORD_ROUTE)

  15909  4 000141   000060 630400 2                  EPPR0   PRECORD_ROUTE
         4 000142   440003 713400                    CLIMB   alt,+16387
         4 000143   401000 401760                    pmme    nvectors=3
         4 000144   000146 702000 4                  TSX2    s:15914
         4 000145   000146 710000 4                  TRA     s:15914
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:71   

      432    15910    4              WHENALTRETURN DO;

      433    15911                                                /* expected*/
      434    15912    4                   END;

      435    15913
      436    15914    3              ENDOFILE = '0'B;

  15914  4 000146   200034 450100                    STZ     ENDOFILE,,AUTO

      437    15915    3              PRECORD_ROUTE.V.N# = 1;

  15915  4 000147   000001 235007                    LDA     1,DL
         4 000150   000067 755000 2                  STA     PRECORD_ROUTE+7

      438    15916    4              DO WHILE NOT(ENDOFILE);

  15916  4 000151   000171 710000 4                  TRA     s:15928

      439    15917    4                   CALL M$READ(READ_ROUTE)

  15917  4 000152   000026 630400 2                  EPPR0   READ_ROUTE
         4 000153   440000 713400                    CLIMB   alt,read
         4 000154   401400 401760                    pmme    nvectors=4
         4 000155   000157 702000 4                  TSX2    s:15919
         4 000156   000160 710000 4                  TRA     s:15922

      440    15918    5                   WHENALTRETURN DO;

      441    15919    5                        RETURN;

  15919  4 000157   000000 702200 xent               TSX2  ! X66_ARET

      442    15920    5                        END;
      443    15921
      444    15922    4                   CALL DISPLAY_NSAP_INFO;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:72   

  15922  4 000160   001204 701000 4                  TSX1    DISPLAY_NSAP_INFO
         4 000161   000000 011000                    NOP     0

      445    15923
      446    15924    4                   CALL M$PRECORD(PRECORD_ROUTE)

  15924  4 000162   000060 630400 2                  EPPR0   PRECORD_ROUTE
         4 000163   440003 713400                    CLIMB   alt,+16387
         4 000164   401000 401760                    pmme    nvectors=3
         4 000165   000167 702000 4                  TSX2    s:15926
         4 000166   000171 710000 4                  TRA     s:15928

      447    15925    5                   WHENALTRETURN DO;

      448    15926    5                        ENDOFILE = '1'B;

  15926  4 000167   400000 236003                    LDQ     -131072,DU
         4 000170   200034 756100                    STQ     ENDOFILE,,AUTO

      449    15927    5                        END;

      450    15928    4                   END/*while not eof*/;

  15928  4 000171   200034 234100                    SZN     ENDOFILE,,AUTO
         4 000172   000152 605000 4                  TPL     s:15917

      451    15929    3              END/*display all*/;

  15929  4 000173   001203 710000 4                  TRA     s:16122

      452    15930
      453    15931
      454    15932    2       CASE(%ROUTE_DEFINE#);

      455    15933    2         NSAP_DATA = '0'B;

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:73   
  15933  4 000174   000000 100400                    MLR     fill='000'O
         4 000175   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000176   000006 000074 2                  ADSC9   NSAP_DATA                cn=0,n=60

      456    15934    2         NSAP_DATA.NW_TYPE = %K_NWTYPE_X2584;

  15934  4 000177   000006 236000 2                  LDQ     NSAP_DATA
         4 000200   000005 376000 5                  ANQ     5
         4 000201   000002 276003                    ORQ     2,DU
         4 000202   000006 756000 2                  STQ     NSAP_DATA

      457    15935
      458    15936    2         NSAP_KEY = NSAP_KEY_C;

  15936  4 000203   000000 100400                    MLR     fill='000'O
         4 000204   000161 000011 1                  ADSC9   NSAP_KEY_C               cn=0,n=9
         4 000205   000000 000011 2                  ADSC9   NSAP_KEY                 cn=0,n=9

      459    15937    2         NSAP_KEY.NSAPNAME = OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  15937  4 000206   000000 471500                    LDP1    0,,PR0
         4 000207   100003 473500                    LDP3    3,,PR1
         4 000210   300003 474500                    LDP4    3,,PR3
         4 000211   400004 236100                    LDQ     4,,PR4
         4 000212   000033 772000                    QRL     27
         4 000213   000000 620006                    EAX0    0,QL
         4 000214   040000 100540                    MLR     fill='040'O
         4 000215   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         4 000216   000000 200010 2                  ADSC9   NSAP_KEY                 cn=1,n=8

      460    15938    2         READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);

  15938  4 000217   000000 237000 5                  LDAQ    0
         4 000220   000030 757000 2                  STAQ    READ_ROUTE+2

      461    15939
      462    15940    2         CALL M$READ(READ_ROUTE)
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:74   

  15940  4 000221   000026 630400 2                  EPPR0   READ_ROUTE
         4 000222   440000 713400                    CLIMB   alt,read
         4 000223   401400 401760                    pmme    nvectors=4
         4 000224   000240 702000 4                  TSX2    s:15947

      463    15941    3         WHENRETURN DO;                    /* nsap is all ready defined*/

      464    15942    3              ERRCODE.ERR# = %E$NSAP_ALREADY_DEFINED;

  15942  4 000225   200004 236100                    LDQ     ERRCODE,,AUTO
         4 000226   000004 376000 5                  ANQ     4
         4 000227   001460 276007                    ORQ     816,DL
         4 000230   200004 756100                    STQ     ERRCODE,,AUTO

      465    15943    3              CALL XUR$ERRMSG(ERRCODE);

  15943  4 000231   200004 630500                    EPPR0   ERRCODE,,AUTO
         4 000232   200056 450500                    STP0    LNSAP_DATA+17,,AUTO
         4 000233   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000235   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000236   000000 011000                    NOP     0

      466    15944    3              RETURN;

  15944  4 000237   000000 702200 xent               TSX2  ! X66_ARET

      467    15945    3              END;
      468    15946
      469    15947    2         NSAP_DATA.FCN = IGA_UPDOSI;

  15947  4 000240   126000 236003                    LDQ     44032,DU
         4 000241   000006 552040 2                  STBQ    NSAP_DATA,'40'O

      470    15948
      471    15949        /* Determine if this is a local or remote NSAP id.
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:75   
      472    15950        */
      473    15951    2         IF OUT$BLK.SUBLK$(1)->OUT$BLK.CODE = %ROUTE_LNSAP#

  15951  4 000242   200003 470500                    LDP0    @TOP$,,AUTO
         4 000243   000000 471500                    LDP1    0,,PR0
         4 000244   100004 473500                    LDP3    4,,PR1
         4 000245   300000 720100                    LXL0    0,,PR3
         4 000246   000017 100003                    CMPX0   15,DU
         4 000247   000255 601000 4                  TNZ     s:15953

      474    15952    2         THEN NSAP_DATA.NS_TYPE = %K_TYPE_LNSAP;

  15952  4 000250   000006 236000 2                  LDQ     NSAP_DATA
         4 000251   000006 376000 5                  ANQ     6
         4 000252   000020 276003                    ORQ     16,DU
         4 000253   000006 756000 2                  STQ     NSAP_DATA
         4 000254   000261 710000 4                  TRA     s:15955

      475    15953    2         ELSE NSAP_DATA.NS_TYPE = %K_TYPE_RNSAP;

  15953  4 000255   000006 236000 2                  LDQ     NSAP_DATA
         4 000256   000006 376000 5                  ANQ     6
         4 000257   000040 276003                    ORQ     32,DU
         4 000260   000006 756000 2                  STQ     NSAP_DATA

      476    15954
      477    15955    2         I = OUT$BLK.SUBLK$(1)->OUT$BLK.NSUBLKS;

  15955  4 000261   000000 471500                    LDP1    0,,PR0
         4 000262   100004 473500                    LDP3    4,,PR1
         4 000263   300001 236100                    LDQ     1,,PR3
         4 000264   000022 772000                    QRL     18
         4 000265   200010 756100                    STQ     I,,AUTO

      478    15956    2         OPTIONS$ = OUT$BLK.SUBLK$(1);

  15956  4 000266   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:76   
         4 000267   200007 756100                    STQ     OPTIONS$,,AUTO

      479    15957    3         DO J = 0 TO I-1;

  15957  4 000270   200011 450100                    STZ     J,,AUTO
         4 000271   001013 710000 4                  TRA     s:16062+3

      480    15958    3              SUBOPT$ = OPTIONS$->OUT$BLK.SUBLK$(J);

  15958  4 000272   200007 470500                    LDP0    OPTIONS$,,AUTO
         4 000273   200011 720100                    LXL0    J,,AUTO
         4 000274   000003 236110                    LDQ     3,X0,PR0
         4 000275   200006 756100                    STQ     SUBOPT$,,AUTO

      481    15959    4              DO CASE (SUBOPT$->OUT$BLK.CODE);

  15959  4 000276   200006 471500                    LDP1    SUBOPT$,,AUTO
         4 000277   100000 236100                    LDQ     0,,PR1
         4 000300   777777 376007                    ANQ     -1,DL
         4 000301   000021 136007                    SBLQ    17,DL
         4 000302   000015 116007                    CMPQ    13,DL
         4 000303   000305 602006 4                  TNC     s:15959+7,QL
         4 000304   001010 710000 4                  TRA     s:16062
         4 000305   000322 710000 4                  TRA     s:15962
         4 000306   000760 710000 4                  TRA     s:16054
         4 000307   000774 710000 4                  TRA     s:16058
         4 000310   000571 710000 4                  TRA     s:16017
         4 000311   000501 710000 4                  TRA     s:15995
         4 000312   001010 710000 4                  TRA     s:16062
         4 000313   001010 710000 4                  TRA     s:16062
         4 000314   001010 710000 4                  TRA     s:16062
         4 000315   001010 710000 4                  TRA     s:16062
         4 000316   001010 710000 4                  TRA     s:16062
         4 000317   000322 710000 4                  TRA     s:15962
         4 000320   000571 710000 4                  TRA     s:16017
         4 000321   000733 710000 4                  TRA     s:16047

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:77   
      482    15960
      483    15961    4               CASE(%ROUTE_PAI#, %ROUTE_NSAP#);

      484    15962    4                 ADDR_TMPLT = '0'B;

  15962  4 000322   000100 100400                    MLR     fill='000'O
         4 000323   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000324   200026 000025                    ADSC9   ADDR_TMPLT,,AUTO         cn=0,n=21

      485    15963    4                 NSAP_DATA.NSAP.LEN = SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;

  15963  4 000325   100003 473500                    LDP3    3,,PR1
         4 000326   300004 236100                    LDQ     4,,PR3
         4 000327   000010 552040 2                  STBQ    NSAP_DATA+2,'40'O

      486    15964
      487    15965    4                 IF MOD(NSAP_DATA.NSAP.LEN,2) ~= 0

  15965  4 000330   000010 236000 2                  LDQ     NSAP_DATA+2
         4 000331   000033 772000                    QRL     27
         4 000332   000001 376007                    ANQ     1,DL
         4 000333   000341 600000 4                  TZE     s:15967

      488    15966    4                 THEN LEN = NSAP_DATA.NSAP.LEN - 1;

  15966  4 000334   000010 236000 2                  LDQ     NSAP_DATA+2
         4 000335   000033 772000                    QRL     27
         4 000336   000001 136007                    SBLQ    1,DL
         4 000337   200014 756100                    STQ     LEN,,AUTO
         4 000340   000344 710000 4                  TRA     s:15969

      489    15967    4                 ELSE LEN = NSAP_DATA.NSAP.LEN;

  15967  4 000341   000010 236000 2                  LDQ     NSAP_DATA+2
         4 000342   000033 772000                    QRL     27
         4 000343   200014 756100                    STQ     LEN,,AUTO

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:78   
      490    15968
      491    15969    4                 L = 0;

  15969  4 000344   200013 450100                    STZ     L,,AUTO

      492    15970    5                 DO K = 0 TO LEN - 1 BY 2;

  15970  4 000345   200012 450100                    STZ     K,,AUTO
         4 000346   000416 710000 4                  TRA     s:15978+3

      493    15971    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K,1);

  15971  4 000347   200006 470500                    LDP0    SUBOPT$,,AUTO
         4 000350   000003 471500                    LDP1    3,,PR0
         4 000351   100004 236100                    LDQ     4,,PR1
         4 000352   000033 772000                    QRL     27
         4 000353   200012 235100                    LDA     K,,AUTO
         4 000354   040100 100505                    MLR     fill='040'O
         4 000355   100004 200001                    ADSC9   4,A,PR1                  cn=1,n=1
         4 000356   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1

      494    15972    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);

  15972  4 000357   000100 124400                    SCM     mask='000'O
         4 000360   000155 000020 1                  ADSC9   HEX_DIGITS               cn=0,n=16
         4 000361   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
         4 000362   200016 000100                    ARG     HEX_DIGIT,,AUTO

      495    15973    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;

  15973  4 000363   200013 236100                    LDQ     L,,AUTO
         4 000364   000011 402007                    MPY     9,DL
         4 000365   003106 061500                    CSR     bolr='003'O
         4 000366   200016 000044                    BDSC    HEX_DIGIT,,AUTO          by=0,bit=0,n=36
         4 000367   200026 010004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=1,n=4

      496    15974    5                     HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K+1,1)
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:79   
             15974                               ;

  15974  4 000370   000003 471500                    LDP1    3,,PR0
         4 000371   100004 236100                    LDQ     4,,PR1
         4 000372   000033 772000                    QRL     27
         4 000373   200012 235100                    LDA     K,,AUTO
         4 000374   040100 100505                    MLR     fill='040'O
         4 000375   100004 400001                    ADSC9   4,A,PR1                  cn=2,n=1
         4 000376   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1

      497    15975    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);

  15975  4 000377   000100 124400                    SCM     mask='000'O
         4 000400   000155 000020 1                  ADSC9   HEX_DIGITS               cn=0,n=16
         4 000401   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
         4 000402   200016 000100                    ARG     HEX_DIGIT,,AUTO

      498    15976    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = HEX_DIGIT;

  15976  4 000403   200013 236100                    LDQ     L,,AUTO
         4 000404   000011 402007                    MPY     9,DL
         4 000405   003106 061500                    CSR     bolr='003'O
         4 000406   200016 000044                    BDSC    HEX_DIGIT,,AUTO          by=0,bit=0,n=36
         4 000407   200026 050004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=5,n=4

      499    15977    5                      L = L + 1;

  15977  4 000410   200013 235100                    LDA     L,,AUTO
         4 000411   000001 035007                    ADLA    1,DL
         4 000412   200013 755100                    STA     L,,AUTO

      500    15978    5                      END;

  15978  4 000413   200012 236100                    LDQ     K,,AUTO
         4 000414   000002 036007                    ADLQ    2,DL
         4 000415   200012 756100                    STQ     K,,AUTO
         4 000416   200012 236100                    LDQ     K,,AUTO
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:80   
         4 000417   200014 116100                    CMPQ    LEN,,AUTO
         4 000420   000347 602000 4                  TNC     s:15971

      501    15979
      502    15980    4                 IF LEN ~= NSAP_DATA.NSAP.LEN

  15980  4 000421   000010 236000 2                  LDQ     NSAP_DATA+2
         4 000422   000033 772000                    QRL     27
         4 000423   200014 116100                    CMPQ    LEN,,AUTO
         4 000424   000463 600000 4                  TZE     s:15990

      503    15981    5                 THEN DO;

      504    15982    5                     HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,LEN,1)
             15982                               ;

  15982  4 000425   200006 470500                    LDP0    SUBOPT$,,AUTO
         4 000426   000003 471500                    LDP1    3,,PR0
         4 000427   100004 236100                    LDQ     4,,PR1
         4 000430   000033 772000                    QRL     27
         4 000431   200014 235100                    LDA     LEN,,AUTO
         4 000432   040100 100505                    MLR     fill='040'O
         4 000433   100004 200001                    ADSC9   4,A,PR1                  cn=1,n=1
         4 000434   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1

      505    15983    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);

  15983  4 000435   000100 124400                    SCM     mask='000'O
         4 000436   000155 000020 1                  ADSC9   HEX_DIGITS               cn=0,n=16
         4 000437   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
         4 000440   200016 000100                    ARG     HEX_DIGIT,,AUTO

      506    15984    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;

  15984  4 000441   200013 236100                    LDQ     L,,AUTO
         4 000442   000011 402007                    MPY     9,DL
         4 000443   003106 061500                    CSR     bolr='003'O
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:81   
         4 000444   200016 000044                    BDSC    HEX_DIGIT,,AUTO          by=0,bit=0,n=36
         4 000445   200026 010004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=1,n=4

      507    15985    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = 0; /* pad the address       */

  15985  4 000446   003106 061400                    CSR     bolr='003'O
         4 000447   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         4 000450   200026 050004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=5,n=4

      508    15986    5                      ERRCODE.ERR# = %E$PADDED_WITH_ZEROS;

  15986  4 000451   200004 236100                    LDQ     ERRCODE,,AUTO
         4 000452   000004 376000 5                  ANQ     4
         4 000453   001510 276007                    ORQ     840,DL
         4 000454   200004 756100                    STQ     ERRCODE,,AUTO

      509    15987    5                      CALL XUR$ERRMSG(ERRCODE);

  15987  4 000455   200004 631500                    EPPR1   ERRCODE,,AUTO
         4 000456   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 000457   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 000460   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000461   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000462   000000 011000                    NOP     0

      510    15988    5                      END;

      511    15989
      512    15990    4                 LEN = (NSAP_DATA.NSAP.LEN + 1)/2;

  15990  4 000463   000010 236000 2                  LDQ     NSAP_DATA+2
         4 000464   000033 772000                    QRL     27
         4 000465   000001 036007                    ADLQ    1,DL
         4 000466   000001 772000                    QRL     1
         4 000467   200014 756100                    STQ     LEN,,AUTO

      513    15991    4                 ADDR(NSAP_DATA.NSAP.AFI)->ADDRESS = ADDR(ADDR_TMPLT)->ADDRESS;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:82   

  15991  4 000470   000000 620006                    EAX0    0,QL
         4 000471   200014 721100                    LXL1    LEN,,AUTO
         4 000472   040040 100540                    MLR     fill='040'O
         4 000473   200026 000010                    ADSC9   ADDR_TMPLT,,AUTO         cn=0,n=*X0
         4 000474   000010 200011 2                  ADSC9   NSAP_DATA+2              cn=1,n=*X1

      514    15992    4                 NSAP_DATA.NSAP.LEN = LEN; /* store address in terms of bytes*/

  15992  4 000475   200014 236100                    LDQ     LEN,,AUTO
         4 000476   000033 736000                    QLS     27
         4 000477   000010 552040 2                  STBQ    NSAP_DATA+2,'40'O
         4 000500   001010 710000 4                  TRA     s:16062

      515    15993
      516    15994    4               CASE(%ROUTE_LOCAL_NSAP#);

      517    15995    4                 LNSAP_DATA = '0'B;

  15995  4 000501   000100 100400                    MLR     fill='000'O
         4 000502   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000503   200035 000074                    ADSC9   LNSAP_DATA,,AUTO         cn=0,n=60

      518    15996    4                 LNSAP_KEY = NSAP_KEY_C;

  15996  4 000504   000000 100400                    MLR     fill='000'O
         4 000505   000161 000011 1                  ADSC9   NSAP_KEY_C               cn=0,n=9
         4 000506   000003 000011 2                  ADSC9   LNSAP_KEY                cn=0,n=9

      519    15997    4                 LNSAP_KEY.NSAPNAME = SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->
             15997                          OUT$SYM.TEXT;

  15997  4 000507   100003 473500                    LDP3    3,,PR1
         4 000510   300003 474500                    LDP4    3,,PR3
         4 000511   400004 236100                    LDQ     4,,PR4
         4 000512   000033 772000                    QRL     27
         4 000513   000000 621006                    EAX1    0,QL
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:83   
         4 000514   040000 100540                    MLR     fill='040'O
         4 000515   400004 200011                    ADSC9   4,,PR4                   cn=1,n=*X1
         4 000516   000003 200010 2                  ADSC9   LNSAP_KEY                cn=1,n=8

      520    15998    4                 READ_ROUTE.KEY_ = VECTOR(LNSAP_KEY);

  15998  4 000517   000010 237000 5                  LDAQ    8
         4 000520   000030 757000 2                  STAQ    READ_ROUTE+2

      521    15999    4                 READ_ROUTE.BUF_ = VECTOR(LNSAP_DATA);

  15999  4 000521   000002 235000 5                  LDA     2
         4 000522   200056 452500                    STP2    LNSAP_DATA+17,,AUTO
         4 000523   200056 236100                    LDQ     LNSAP_DATA+17,,AUTO
         4 000524   000035 036003                    ADLQ    29,DU
         4 000525   000032 757000 2                  STAQ    READ_ROUTE+4

      522    16000
      523    16001    4                 CALL M$READ(READ_ROUTE)

  16001  4 000526   000026 630400 2                  EPPR0   READ_ROUTE
         4 000527   440000 713400                    CLIMB   alt,read
         4 000530   401400 401760                    pmme    nvectors=4
         4 000531   000533 702000 4                  TSX2    s:16003
         4 000532   000546 710000 4                  TRA     s:16008

      524    16002    5                 WHENALTRETURN DO;

      525    16003    5                      ERRCODE.ERR# = %E$LNSAP_NOT_DEFINED;

  16003  4 000533   200004 236100                    LDQ     ERRCODE,,AUTO
         4 000534   000004 376000 5                  ANQ     4
         4 000535   001500 276007                    ORQ     832,DL
         4 000536   200004 756100                    STQ     ERRCODE,,AUTO

      526    16004    5                      CALL XUR$ERRMSG(ERRCODE);

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:84   
  16004  4 000537   200004 630500                    EPPR0   ERRCODE,,AUTO
         4 000540   200056 450500                    STP0    LNSAP_DATA+17,,AUTO
         4 000541   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 000542   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000543   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000544   000000 011000                    NOP     0

      527    16005    5                      ALTRETURN;

  16005  4 000545   000000 702200 xent               TSX2  ! X66_AALT

      528    16006    5                      END;
      529    16007
      530    16008    4                 IF LNSAP_DATA.NS_TYPE ~= %K_TYPE_LNSAP

  16008  4 000546   200035 236100                    LDQ     LNSAP_DATA,,AUTO
         4 000547   000360 376003                    ANQ     240,DU
         4 000550   000020 116003                    CMPQ    16,DU
         4 000551   000565 600000 4                  TZE     s:16014

      531    16009    5                 THEN DO;

      532    16010    5                      ERRCODE.ERR# = %E$NOT_LNSAP;

  16010  4 000552   200004 236100                    LDQ     ERRCODE,,AUTO
         4 000553   000004 376000 5                  ANQ     4
         4 000554   001520 276007                    ORQ     848,DL
         4 000555   200004 756100                    STQ     ERRCODE,,AUTO

      533    16011    5                      CALL XUR$ERRMSG(ERRCODE);

  16011  4 000556   200004 630500                    EPPR0   ERRCODE,,AUTO
         4 000557   200056 450500                    STP0    LNSAP_DATA+17,,AUTO
         4 000560   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 000561   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000562   000000 701000 xent               TSX1    XUR$ERRMSG
         4 000563   000000 011000                    NOP     0
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:85   

      534    16012    5                      RETURN;

  16012  4 000564   000000 702200 xent               TSX2  ! X66_ARET

      535    16013    5                      END;
      536    16014    4                 NSAP_DATA.LNSAP = LNSAP_DATA.NSAP;

  16014  4 000565   000000 100500                    MLR     fill='000'O
         4 000566   200037 000026                    ADSC9   LNSAP_DATA+2,,AUTO       cn=0,n=22
         4 000567   000015 400026 2                  ADSC9   NSAP_DATA+7              cn=2,n=22
         4 000570   001010 710000 4                  TRA     s:16062

      537    16015
      538    16016    4               CASE(%ROUTE_SNPA#, %ROUTE_X25#);

      539    16017    4                 ADDR_TMPLT = '0'B;

  16017  4 000571   000100 100400                    MLR     fill='000'O
         4 000572   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000573   200026 000025                    ADSC9   ADDR_TMPLT,,AUTO         cn=0,n=21

      540    16018    4                 NSAP_DATA.SNPA.LEN = SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.COUNT;

  16018  4 000574   100003 473500                    LDP3    3,,PR1
         4 000575   300004 236100                    LDQ     4,,PR3
         4 000576   000023 552040 2                  STBQ    NSAP_DATA+13,'40'O

      541    16019
      542    16020    4                 IF MOD(NSAP_DATA.SNPA.LEN,2) ~= 0

  16020  4 000577   000023 236000 2                  LDQ     NSAP_DATA+13
         4 000600   000033 772000                    QRL     27
         4 000601   000001 376007                    ANQ     1,DL
         4 000602   000610 600000 4                  TZE     s:16022

      543    16021    4                 THEN LEN = NSAP_DATA.SNPA.LEN - 1;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:86   

  16021  4 000603   000023 236000 2                  LDQ     NSAP_DATA+13
         4 000604   000033 772000                    QRL     27
         4 000605   000001 136007                    SBLQ    1,DL
         4 000606   200014 756100                    STQ     LEN,,AUTO
         4 000607   000613 710000 4                  TRA     s:16024

      544    16022    4                 ELSE LEN = NSAP_DATA.SNPA.LEN;

  16022  4 000610   000023 236000 2                  LDQ     NSAP_DATA+13
         4 000611   000033 772000                    QRL     27
         4 000612   200014 756100                    STQ     LEN,,AUTO

      545    16023
      546    16024    4                 L = 0;

  16024  4 000613   200013 450100                    STZ     L,,AUTO

      547    16025    5                 DO K = 0 TO LEN - 1 BY 2;

  16025  4 000614   200012 450100                    STZ     K,,AUTO
         4 000615   000665 710000 4                  TRA     s:16033+3

      548    16026    5                      HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K,1);

  16026  4 000616   200006 470500                    LDP0    SUBOPT$,,AUTO
         4 000617   000003 471500                    LDP1    3,,PR0
         4 000620   100004 236100                    LDQ     4,,PR1
         4 000621   000033 772000                    QRL     27
         4 000622   200012 235100                    LDA     K,,AUTO
         4 000623   040100 100505                    MLR     fill='040'O
         4 000624   100004 200001                    ADSC9   4,A,PR1                  cn=1,n=1
         4 000625   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1

      549    16027    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);

  16027  4 000626   000100 124400                    SCM     mask='000'O
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:87   
         4 000627   000155 000020 1                  ADSC9   HEX_DIGITS               cn=0,n=16
         4 000630   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
         4 000631   200016 000100                    ARG     HEX_DIGIT,,AUTO

      550    16028    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;

  16028  4 000632   200013 236100                    LDQ     L,,AUTO
         4 000633   000011 402007                    MPY     9,DL
         4 000634   003106 061500                    CSR     bolr='003'O
         4 000635   200016 000044                    BDSC    HEX_DIGIT,,AUTO          by=0,bit=0,n=36
         4 000636   200026 010004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=1,n=4

      551    16029    5                     HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,K+1,1)
             16029                               ;

  16029  4 000637   000003 471500                    LDP1    3,,PR0
         4 000640   100004 236100                    LDQ     4,,PR1
         4 000641   000033 772000                    QRL     27
         4 000642   200012 235100                    LDA     K,,AUTO
         4 000643   040100 100505                    MLR     fill='040'O
         4 000644   100004 400001                    ADSC9   4,A,PR1                  cn=2,n=1
         4 000645   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1

      552    16030    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);

  16030  4 000646   000100 124400                    SCM     mask='000'O
         4 000647   000155 000020 1                  ADSC9   HEX_DIGITS               cn=0,n=16
         4 000650   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
         4 000651   200016 000100                    ARG     HEX_DIGIT,,AUTO

      553    16031    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = HEX_DIGIT;

  16031  4 000652   200013 236100                    LDQ     L,,AUTO
         4 000653   000011 402007                    MPY     9,DL
         4 000654   003106 061500                    CSR     bolr='003'O
         4 000655   200016 000044                    BDSC    HEX_DIGIT,,AUTO          by=0,bit=0,n=36
         4 000656   200026 050004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=5,n=4
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:88   

      554    16032    5                      L = L + 1;

  16032  4 000657   200013 235100                    LDA     L,,AUTO
         4 000660   000001 035007                    ADLA    1,DL
         4 000661   200013 755100                    STA     L,,AUTO

      555    16033    5                      END;

  16033  4 000662   200012 236100                    LDQ     K,,AUTO
         4 000663   000002 036007                    ADLQ    2,DL
         4 000664   200012 756100                    STQ     K,,AUTO
         4 000665   200012 236100                    LDQ     K,,AUTO
         4 000666   200014 116100                    CMPQ    LEN,,AUTO
         4 000667   000616 602000 4                  TNC     s:16026

      556    16034
      557    16035    4                 IF LEN ~= NSAP_DATA.SNPA.LEN

  16035  4 000670   000023 236000 2                  LDQ     NSAP_DATA+13
         4 000671   000033 772000                    QRL     27
         4 000672   200014 116100                    CMPQ    LEN,,AUTO
         4 000673   000720 600000 4                  TZE     s:16043

      558    16036    5                 THEN DO;

      559    16037    5                     HEX_CHAR = SUBSTR(SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT,LEN,1)
             16037                               ;

  16037  4 000674   200006 470500                    LDP0    SUBOPT$,,AUTO
         4 000675   000003 471500                    LDP1    3,,PR0
         4 000676   100004 236100                    LDQ     4,,PR1
         4 000677   000033 772000                    QRL     27
         4 000700   200014 235100                    LDA     LEN,,AUTO
         4 000701   040100 100505                    MLR     fill='040'O
         4 000702   100004 200001                    ADSC9   4,A,PR1                  cn=1,n=1
         4 000703   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:89   

      560    16038    5                      CALL INDEX(HEX_DIGIT,HEX_CHAR,HEX_DIGITS);

  16038  4 000704   000100 124400                    SCM     mask='000'O
         4 000705   000155 000020 1                  ADSC9   HEX_DIGITS               cn=0,n=16
         4 000706   200015 000001                    ADSC9   HEX_CHAR,,AUTO           cn=0,n=1
         4 000707   200016 000100                    ARG     HEX_DIGIT,,AUTO

      561    16039    5                      ADDR_TMPLT.BYT.HIGH_NIBBLE(L) = HEX_DIGIT;

  16039  4 000710   200013 236100                    LDQ     L,,AUTO
         4 000711   000011 402007                    MPY     9,DL
         4 000712   003106 061500                    CSR     bolr='003'O
         4 000713   200016 000044                    BDSC    HEX_DIGIT,,AUTO          by=0,bit=0,n=36
         4 000714   200026 010004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=1,n=4

      562    16040    5                      ADDR_TMPLT.BYT.LOW_NIBBLE(L) = 0;/* just to be sure        */

  16040  4 000715   003106 061400                    CSR     bolr='003'O
         4 000716   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         4 000717   200026 050004                    BDSC    ADDR_TMPLT,Q,AUTO        by=0,bit=5,n=4

      563    16041    5                      END;

      564    16042
      565    16043    4                 LEN = (NSAP_DATA.SNPA.LEN+1)/2;

  16043  4 000720   000023 236000 2                  LDQ     NSAP_DATA+13
         4 000721   000033 772000                    QRL     27
         4 000722   000001 036007                    ADLQ    1,DL
         4 000723   000001 772000                    QRL     1
         4 000724   200014 756100                    STQ     LEN,,AUTO

      566    16044    4                 ADDR(NSAP_DATA.SNPA.ADDRESS)->ADDRESS = ADDR(ADDR_TMPLT)->ADDRESS;

  16044  4 000725   000000 620006                    EAX0    0,QL
         4 000726   200014 721100                    LXL1    LEN,,AUTO
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:90   
         4 000727   040040 100540                    MLR     fill='040'O
         4 000730   200026 000010                    ADSC9   ADDR_TMPLT,,AUTO         cn=0,n=*X0
         4 000731   000023 200011 2                  ADSC9   NSAP_DATA+13             cn=1,n=*X1
         4 000732   001010 710000 4                  TRA     s:16062

      567    16045
      568    16046    4               CASE(%ROUTE_NW_TYPE#);

      569    16047    4                 IF SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.CODE = %ROUTE_NW_ISO8348#

  16047  4 000733   100003 473500                    LDP3    3,,PR1
         4 000734   300000 721100                    LXL1    0,,PR3
         4 000735   000040 101003                    CMPX1   32,DU
         4 000736   000744 601000 4                  TNZ     s:16049

      570    16048    4                 THEN NSAP_DATA.NW_TYPE = %K_NWTYPE_ISO8348;

  16048  4 000737   000006 236000 2                  LDQ     NSAP_DATA
         4 000740   000005 376000 5                  ANQ     5
         4 000741   000003 276003                    ORQ     3,DU
         4 000742   000006 756000 2                  STQ     NSAP_DATA
         4 000743   001010 710000 4                  TRA     s:16062

      571    16049    4                 ELSE IF SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.CODE = %ROUTE_NW_1984#

  16049  4 000744   000037 101003                    CMPX1   31,DU
         4 000745   000753 601000 4                  TNZ     s:16051

      572    16050    4                      THEN NSAP_DATA.NW_TYPE = %K_NWTYPE_X2584;

  16050  4 000746   000006 236000 2                  LDQ     NSAP_DATA
         4 000747   000005 376000 5                  ANQ     5
         4 000750   000002 276003                    ORQ     2,DU
         4 000751   000006 756000 2                  STQ     NSAP_DATA
         4 000752   001010 710000 4                  TRA     s:16062

      573    16051    4                      ELSE NSAP_DATA.NW_TYPE = %K_NWTYPE_X2580;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:91   

  16051  4 000753   000006 236000 2                  LDQ     NSAP_DATA
         4 000754   000005 376000 5                  ANQ     5
         4 000755   000001 276003                    ORQ     1,DU
         4 000756   000006 756000 2                  STQ     NSAP_DATA
         4 000757   001010 710000 4                  TRA     s:16062

      574    16052
      575    16053    4               CASE(%ROUTE_FEP#);

      576    16054    4                 CALL CHARBIN(K,SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  16054  4 000760   100003 473500                    LDP3    3,,PR1
         4 000761   300004 236100                    LDQ     4,,PR3
         4 000762   000033 772000                    QRL     27
         4 000763   000000 621006                    EAX1    0,QL
         4 000764   000100 305540                    DTB
         4 000765   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 000766   200056 000010                    NDSC9   LNSAP_DATA+17,,AUTO      cn=0,s=lsgnf,sf=0,n=8
         4 000767   200057 235100                    LDA     LNSAP_DATA+18,,AUTO
         4 000770   200012 755100                    STA     K,,AUTO

      577    16055    4                 NSAP_DATA.FEP# = K;

  16055  4 000771   200012 236100                    LDQ     K,,AUTO
         4 000772   000006 552004 2                  STBQ    NSAP_DATA,'04'O
         4 000773   001010 710000 4                  TRA     s:16062

      578    16056
      579    16057    4               CASE(%ROUTE_HOST#);

      580    16058    4                 CALL CHARBIN(K,SUBOPT$->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT);

  16058  4 000774   100003 473500                    LDP3    3,,PR1
         4 000775   300004 236100                    LDQ     4,,PR3
         4 000776   000033 772000                    QRL     27
         4 000777   000000 621006                    EAX1    0,QL
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:92   
         4 001000   000100 305540                    DTB
         4 001001   300004 230011                    NDSC9   4,,PR3                   cn=1,s=nosgn,sf=0,n=*X1
         4 001002   200056 000010                    NDSC9   LNSAP_DATA+17,,AUTO      cn=0,s=lsgnf,sf=0,n=8
         4 001003   200057 235100                    LDA     LNSAP_DATA+18,,AUTO
         4 001004   200012 755100                    STA     K,,AUTO

      581    16059    4                 NSAP_DATA.HOST# = K;

  16059  4 001005   200012 236100                    LDQ     K,,AUTO
         4 001006   000011 736000                    QLS     9
         4 001007   000006 552010 2                  STBQ    NSAP_DATA,'10'O

      582    16060
      583    16061    4                 END;                      /* do case options                    */

      584    16062    3              END;                         /* do j                               */

  16062  4 001010   200011 235100                    LDA     J,,AUTO
         4 001011   000001 035007                    ADLA    1,DL
         4 001012   200011 755100                    STA     J,,AUTO
         4 001013   200011 236100                    LDQ     J,,AUTO
         4 001014   200010 116100                    CMPQ    I,,AUTO
         4 001015   000272 602000 4                  TNC     s:15958

      585    16063
      586    16064    2         IF NSAP_DATA.NS_TYPE=%K_TYPE_LNSAP AND NSAP_DATA.HOST#=0

  16064  4 001016   000006 236000 2                  LDQ     NSAP_DATA
         4 001017   000360 376003                    ANQ     240,DU
         4 001020   000020 116003                    CMPQ    16,DU
         4 001021   001030 601000 4                  TNZ     s:16067
         4 001022   000006 236000 2                  LDQ     NSAP_DATA
         4 001023   777000 316007                    CANQ    -512,DL
         4 001024   001030 601000 4                  TNZ     s:16067

      587    16065    2         THEN NSAP_DATA.HOST# = VLR_MONINFO.NODE#;

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:93   
  16065  4 001025   000011 236000 xsym               LDQ     VLR_MONINFO+9
         4 001026   000011 736000                    QLS     9
         4 001027   000006 552010 2                  STBQ    NSAP_DATA,'10'O

      588    16066
      589    16067    2         WRITE_ROUTE.KEY_ = VECTOR(NSAP_KEY);

  16067  4 001030   000000 237000 5                  LDAQ    0
         4 001031   000046 757000 2                  STAQ    WRITE_ROUTE+2

      590    16068    2         WRITE_ROUTE.BUF_ = VECTOR(NSAP_DATA);

  16068  4 001032   000002 237000 5                  LDAQ    2
         4 001033   000050 757000 2                  STAQ    WRITE_ROUTE+4

      591    16069    3         CALL M$WRITE(WRITE_ROUTE) WHENALTRETURN DO;

  16069  4 001034   000044 630400 2                  EPPR0   WRITE_ROUTE
         4 001035   440001 713400                    CLIMB   alt,write
         4 001036   401400 401760                    pmme    nvectors=4
         4 001037   001041 702000 4                  TSX2    s:16070
         4 001040   001052 710000 4                  TRA     s:16073

      592    16070    3              CALL XUR$ERRMSG(B$TCB.ALT$->B$ALT.ERR);

  16070  4 001041   000000 470400 xsym               LDP0    B$TCB$
         4 001042   000000 471500                    LDP1    0,,PR0
         4 001043   100102 633500                    EPPR3   66,,PR1
         4 001044   200056 453500                    STP3    LNSAP_DATA+17,,AUTO
         4 001045   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001047   000000 701000 xent               TSX1    XUR$ERRMSG
         4 001050   000000 011000                    NOP     0

      593    16071    3              ALTRETURN;

  16071  4 001051   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:94   

      594    16072    3              END;
      595    16073    2         NSAP_DATA.FCN = IGA_UPDOSI;

  16073  4 001052   126000 236003                    LDQ     44032,DU
         4 001053   000006 552040 2                  STBQ    NSAP_DATA,'40'O

      596    16074    2         CALL WRHLPCG(VECTOR(NSAP_DATA))

  16074  4 001054   000007 630400 5                  EPPR0   7
         4 001055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001056   000000 701000 xent               TSX1    WRHLPCG
         4 001057   001061 702000 4                  TSX2    s:16076
         4 001060   001062 710000 4                  TRA     s:16081

      597    16075    3         WHENALTRETURN DO;

      598    16076    3              ALTRETURN;                   /* error message written by wrhlpcg*/

  16076  4 001061   000000 702200 xent               TSX2  ! X66_AALT

      599    16077    3              END;
      600    16078
      601    16079        /* Indicate nsap_id definition was successful.
      602    16080        */
      603    16081    2         ERRCODE = ERR_C;

  16081  4 001062   000000 236000 1                  LDQ     ERR_C
         4 001063   200004 756100                    STQ     ERRCODE,,AUTO

      604    16082    2         ERRCODE.ERR# = %E$NSAPDEFINEDOK;

  16082  4 001064   000004 376000 5                  ANQ     4
         4 001065   017700 276007                    ORQ     8128,DL
         4 001066   200004 756100                    STQ     ERRCODE,,AUTO

      605    16083    2         CALL XUR$ERRMSG(ERRCODE,,,VECTOR(NSAP_KEY));
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:95   

  16083  4 001067   000012 236000 5                  LDQ     10
         4 001070   000001 235000 xsym               LDA     B_VECTNIL+1
         4 001071   200060 757100                    STAQ    LNSAP_DATA+19,,AUTO
         4 001072   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001073   200057 756100                    STQ     LNSAP_DATA+18,,AUTO
         4 001074   200004 630500                    EPPR0   ERRCODE,,AUTO
         4 001075   200056 450500                    STP0    LNSAP_DATA+17,,AUTO
         4 001076   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001077   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001100   000000 701000 xent               TSX1    XUR$ERRMSG
         4 001101   000000 011000                    NOP     0
         4 001102   001203 710000 4                  TRA     s:16122

      606    16084
      607    16085    2       CASE(%ROUTE_DELETE#);

      608    16086    2         NSAP_KEY = NSAP_KEY_C;

  16086  4 001103   000000 100400                    MLR     fill='000'O
         4 001104   000161 000011 1                  ADSC9   NSAP_KEY_C               cn=0,n=9
         4 001105   000000 000011 2                  ADSC9   NSAP_KEY                 cn=0,n=9

      609    16087    2         NSAP_KEY.NSAPNAME = OUT$BLK.SUBLK$(0)->OUT$BLK.SUBLK$(0)->OUT$SYM.TEXT;

  16087  4 001106   000000 471500                    LDP1    0,,PR0
         4 001107   100003 473500                    LDP3    3,,PR1
         4 001110   300003 474500                    LDP4    3,,PR3
         4 001111   400004 236100                    LDQ     4,,PR4
         4 001112   000033 772000                    QRL     27
         4 001113   000000 620006                    EAX0    0,QL
         4 001114   040000 100540                    MLR     fill='040'O
         4 001115   400004 200010                    ADSC9   4,,PR4                   cn=1,n=*X0
         4 001116   000000 200010 2                  ADSC9   NSAP_KEY                 cn=1,n=8

      610    16088    2         READ_ROUTE.KEY_ = VECTOR(NSAP_KEY);

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:96   
  16088  4 001117   000000 237000 5                  LDAQ    0
         4 001120   000030 757000 2                  STAQ    READ_ROUTE+2

      611    16089    2         READ_ROUTE.BUF_ = VECTOR(NSAP_DATA);

  16089  4 001121   000002 237000 5                  LDAQ    2
         4 001122   000032 757000 2                  STAQ    READ_ROUTE+4

      612    16090
      613    16091    2         CALL M$READ(READ_ROUTE)

  16091  4 001123   000026 630400 2                  EPPR0   READ_ROUTE
         4 001124   440000 713400                    CLIMB   alt,read
         4 001125   401400 401760                    pmme    nvectors=4
         4 001126   001144 702000 4                  TSX2    NOT_DEFINED

      614    16092    3         WHENRETURN DO;

      615    16093    3              CALL M$DELREC(DELREC_ROUTE) ALTRET(NOT_DEFINED);

  16093  4 001127   000072 630400 2                  EPPR0   DELREC_ROUTE
         4 001130   440002 713400                    CLIMB   alt,+16386
         4 001131   401400 401760                    pmme    nvectors=4
         4 001132   001144 702000 4                  TSX2    NOT_DEFINED

      616    16094    3              NSAP_DATA.FCN = IGA_DELOSI;

  16094  4 001133   127000 236003                    LDQ     44544,DU
         4 001134   000006 552040 2                  STBQ    NSAP_DATA,'40'O

      617    16095    3              CALL WRHLPCG(VECTOR(NSAP_DATA))

  16095  4 001135   000007 630400 5                  EPPR0   7
         4 001136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001137   000000 701000 xent               TSX1    WRHLPCG
         4 001140   001142 702000 4                  TSX2    s:16097
         4 001141   001143 710000 4                  TRA     s:16099
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:97   

      618    16096    4              WHENALTRETURN DO;

      619    16097    4                   RETURN;                 /* error written by rdhlpcg           */

  16097  4 001142   000000 702200 xent               TSX2  ! X66_ARET

      620    16098    4                   END;
      621    16099    3              END/*read_route return*/;

  16099  4 001143   001157 710000 4                  TRA     s:16110

      622    16100
      623    16101    3         WHENALTRETURN DO;

      624    16102    3   NOT_DEFINED:
      625    16103    3              ERRCODE.ERR# = %E$NOT_DEFINED;

  16103  4 001144   200004 236100       NOT_DEFINED  LDQ     ERRCODE,,AUTO
         4 001145   000004 376000 5                  ANQ     4
         4 001146   001470 276007                    ORQ     824,DL
         4 001147   200004 756100                    STQ     ERRCODE,,AUTO

      626    16104    3              CALL XUR$ERRMSG(ERRCODE);

  16104  4 001150   200004 630500                    EPPR0   ERRCODE,,AUTO
         4 001151   200056 450500                    STP0    LNSAP_DATA+17,,AUTO
         4 001152   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001153   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001154   000000 701000 xent               TSX1    XUR$ERRMSG
         4 001155   000000 011000                    NOP     0

      627    16105    3              ALTRETURN;

  16105  4 001156   000000 702200 xent               TSX2  ! X66_AALT

      628    16106    3              END/*read_route altreturn*/;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:98   
      629    16107
      630    16108        /* Indicate delete was successful.
      631    16109        */
      632    16110    2         ERRCODE = ERR_C;

  16110  4 001157   000000 236000 1                  LDQ     ERR_C
         4 001160   200004 756100                    STQ     ERRCODE,,AUTO

      633    16111    2         ERRCODE.ERR# = %E$NSAPDELETEDOK;

  16111  4 001161   000004 376000 5                  ANQ     4
         4 001162   017710 276007                    ORQ     8136,DL
         4 001163   200004 756100                    STQ     ERRCODE,,AUTO

      634    16112    2         CALL XUR$ERRMSG(ERRCODE,,,VECTOR(NSAP_KEY));

  16112  4 001164   000012 236000 5                  LDQ     10
         4 001165   000001 235000 xsym               LDA     B_VECTNIL+1
         4 001166   200060 757100                    STAQ    LNSAP_DATA+19,,AUTO
         4 001167   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001170   200057 756100                    STQ     LNSAP_DATA+18,,AUTO
         4 001171   200004 630500                    EPPR0   ERRCODE,,AUTO
         4 001172   200056 450500                    STP0    LNSAP_DATA+17,,AUTO
         4 001173   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001174   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001175   000000 701000 xent               TSX1    XUR$ERRMSG
         4 001176   000000 011000                    NOP     0
         4 001177   001203 710000 4                  TRA     s:16122

      635    16113
      636    16114
      637    16115
      638    16116    2       CASE(%ROUTE_END#);

      639    16117    2         ROUTE_END_FLG = '1'B;

  16117  4 001200   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:99   
         4 001201   000000 756000 xsym               STQ     ROUTE_END_FLG
         4 001202   001203 710000 4                  TRA     s:16122

      640    16118
      641    16119
      642    16120    2       CASE(%ROUTE_NULL#);

      643    16121                                                /* allows blank lines                 */
      644    16122    2         END/*do case*/;

  16122  4 001203   001344 710000 4                  TRA     s:16163

      645    16123        %EJECT;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:100  
      646    16124
      647    16125    1   DISPLAY_NSAP_INFO: PROC;

  16125  4 001204   200054 741300       DISPLAY_NSA* STX1  ! LNSAP_DATA+15,,AUTO

      648    16126    2      FMT_VEC_ = VECTOR(NSAPNAME_FMT);     /*NSAP_name:                          */

  16126  4 001205   000014 237000 5                  LDAQ    12
         4 001206   200020 757100                    STAQ    FMT_VEC_,,AUTO

      649    16127    2      DAT_VEC1_ = VECTOR(NSAP_KEY.NSAPNAME);

  16127  4 001207   000016 237000 5                  LDAQ    14
         4 001210   200022 757100                    STAQ    DAT_VEC1_,,AUTO

      650    16128    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16128  4 001211   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001212   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001213   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001214   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 001215   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001216   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001217   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001220   000000 011000                    NOP     0

      651    16129
      652    16130    2      DAT_VEC1_ = VECTOR(NSAP_DATA);

  16130  4 001221   000002 237000 5                  LDAQ    2
         4 001222   200022 757100                    STAQ    DAT_VEC1_,,AUTO

      653    16131
      654    16132    2      FMT_VEC_ = VECTOR(NSAPTYPE_FMT);     /*nsap type*/

  16132  4 001223   000020 237000 5                  LDAQ    16
         4 001224   200020 757100                    STAQ    FMT_VEC_,,AUTO
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:101  

      655    16133    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16133  4 001225   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001226   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001227   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001230   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 001231   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001232   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001233   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001234   000000 011000                    NOP     0

      656    16134
      657    16135    2      IF NSAP_DATA.NS_TYPE = %K_TYPE_RNSAP

  16135  4 001235   000006 236000 2                  LDQ     NSAP_DATA
         4 001236   000360 376003                    ANQ     240,DU
         4 001237   000040 116003                    CMPQ    32,DU
         4 001240   001254 601000 4                  TNZ     s:16141

      658    16136    3      THEN DO;

      659    16137    3           FMT_VEC_ = VECTOR(NWTYPE_FMT);  /*network type*/

  16137  4 001241   000022 237000 5                  LDAQ    18
         4 001242   200020 757100                    STAQ    FMT_VEC_,,AUTO

      660    16138    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16138  4 001243   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001244   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001245   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001246   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 001247   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001250   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001251   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001252   000000 011000                    NOP     0
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:102  

      661    16139    3           END;

  16139  4 001253   001266 710000 4                  TRA     s:16145

      662    16140    3      ELSE DO;

      663    16141    3           FMT_VEC_ = VECTOR(HOST_NODE_FMT); /*host#:                            */

  16141  4 001254   000024 237000 5                  LDAQ    20
         4 001255   200020 757100                    STAQ    FMT_VEC_,,AUTO

      664    16142    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16142  4 001256   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001257   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001260   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001261   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 001262   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001263   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001264   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001265   000000 011000                    NOP     0

      665    16143    3           END;

      666    16144
      667    16145    2      FMT_VEC_ = VECTOR(FEP_NODE_FMT);     /*fep#:                               */

  16145  4 001266   000026 237000 5                  LDAQ    22
         4 001267   200020 757100                    STAQ    FMT_VEC_,,AUTO

      668    16146    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16146  4 001270   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001271   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001272   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001273   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:103  
         4 001274   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001275   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001276   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001277   000000 011000                    NOP     0

      669    16147
      670    16148    2      FMT_VEC_ = VECTOR(NSAP_FMT2);        /*nsap:                               */

  16148  4 001300   000030 237000 5                  LDAQ    24
         4 001301   200020 757100                    STAQ    FMT_VEC_,,AUTO

      671    16149    2      CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16149  4 001302   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001303   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001304   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001305   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 001306   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001307   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001310   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001311   000000 011000                    NOP     0

      672    16150
      673    16151    2      IF NSAP_DATA.NS_TYPE = %K_TYPE_RNSAP

  16151  4 001312   000006 236000 2                  LDQ     NSAP_DATA
         4 001313   000360 376003                    ANQ     240,DU
         4 001314   000040 116003                    CMPQ    32,DU
         4 001315   001342 601000 4                  TNZ     s:16160

      674    16152    3      THEN DO;

      675    16153    3           FMT_VEC_ = VECTOR(NSAP_FMT3);   /*lnsap:                              */

  16153  4 001316   000032 237000 5                  LDAQ    26
         4 001317   200020 757100                    STAQ    FMT_VEC_,,AUTO

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:104  
      676    16154    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16154  4 001320   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001321   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001322   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001323   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 001324   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001325   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001326   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001327   000000 011000                    NOP     0

      677    16155
      678    16156    3           FMT_VEC_ = VECTOR(NSAP_FMT4);   /*x.25                                */

  16156  4 001330   000034 237000 5                  LDAQ    28
         4 001331   200020 757100                    STAQ    FMT_VEC_,,AUTO

      679    16157    3           CALL ROUTE_WRITE(FMT_VEC_,DAT_VEC1_);

  16157  4 001332   200022 630500                    EPPR0   DAT_VEC1_,,AUTO
         4 001333   200057 450500                    STP0    LNSAP_DATA+18,,AUTO
         4 001334   200020 631500                    EPPR1   FMT_VEC_,,AUTO
         4 001335   200056 451500                    STP1    LNSAP_DATA+17,,AUTO
         4 001336   200056 630500                    EPPR0   LNSAP_DATA+17,,AUTO
         4 001337   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001340   000000 701000 xent               TSX1    ROUTE_WRITE
         4 001341   000000 011000                    NOP     0

      680    16158    3           END;

      681    16159
      682    16160    2      RETURN;

  16160  4 001342   200054 221300                    LDX1  ! LNSAP_DATA+15,,AUTO
         4 001343   000001 702211                    TSX2  ! 1,X1

      683    16161    2   END DISPLAY_NSAP_INFO;
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:105  
      684    16162
      685    16163    1   END ROUTE_COMMAND;

  16163  4 001344   000000 702200 xent               TSX2  ! X66_ARET
      686    16164        %EOD;

PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:106  
--  Include file information  --

   KS_PERR_C.:E05TOU  is referenced.
   KSX_NODES_E.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   K_ADDRESS_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ROUTE_COMMAND.
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:107  

 **** Variables and constants ****

  ****  Section 001 RoData ROUTE_COMMAND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 ERR_C                     61-0-0/c CHAR(35)    r     1 FEP_NODE_FMT
   155-0-0/c CHAR(16)    r     1 HEX_DIGITS                50-0-0/c CHAR        r     1 HOST_NODE_FMT
     1-0-0/c CHAR(24)    r     1 NSAPNAME_FMT               7-0-0/c CHAR(59)    r     1 NSAPTYPE_FMT
    72-0-0/c CHAR(63)    r     1 NSAP_FMT2                112-0-0/c CHAR(64)    r     1 NSAP_FMT3
   132-0-0/c CHAR(73)    r     1 NSAP_FMT4                161-0-0/w STRC(81)    r     1 NSAP_KEY_C
    26-0-0/c CHAR(71)    r     1 NWTYPE_FMT

  ****  Section 002  Data  ROUTE_COMMAND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/d STRC(360)   r     1 DELREC_ROUTE               3-0-0/w STRC(81)    r     1 LNSAP_KEY
     6-0-0/w STRC(540)   r     1 NSAP_DATA                  0-0-0/w STRC(81)    r     1 NSAP_KEY
    60-0-0/d STRC(360)   r     1 PRECORD_ROUTE             26-0-0/d STRC(504)   r     1 READ_ROUTE
    44-0-0/d STRC(432)   r     1 WRITE_ROUTE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @TOP$                     26-0-0/w STRC(189)   r     1 ADDR_TMPLT
    22-0-0/d VECT        r     1 DAT_VEC1_                 34-0-0/b BIT         r     1 ENDOFILE
     4-0-0/w STRC        r     1 ERRCODE                   20-0-0/d VECT        r     1 FMT_VEC_
    15-0-0/c CHAR        r     1 HEX_CHAR                  16-0-0/w UBIN        r     1 HEX_DIGIT
    10-0-0/w UBIN        r     1 I                         11-0-0/w UBIN        r     1 J
    12-0-0/w UBIN        r     1 K                         13-0-0/w UBIN        r     1 L
    14-0-0/w UBIN        r     1 LEN                       35-0-0/w STRC(540)   r     1 LNSAP_DATA
     7-0-0/w PTR         r     1 OPTIONS$                   6-0-0/w PTR         r     1 SUBOPT$
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:108  
    *0-0-0/w PTR         r     1 TOP$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/b BIT         r     1 ROUTE_END_FLG              0-0-0/d STRC(540)   r     1 VLR_MONINFO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ACHR        r     1 ADDRESS                    0-0-0/w STRC(2448)  r     1 B$ALT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0N  NULL        r     1 M$ROUTE
     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM


   Procedure ROUTE_COMMAND requires 741 words for executable code.
   Procedure ROUTE_COMMAND requires 50 words of local(AUTO) storage.
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:109  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:110  
          MINI XREF LISTING

ADDRESS
     15113**DCL     15991<<ASSIGN  15991>>ASSIGN  16044<<ASSIGN  16044>>ASSIGN
ADDR_TMPLT
     15285**DCL     15962<<ASSIGN  15991--ASSIGN  16017<<ASSIGN  16044--ASSIGN
ADDR_TMPLT.BYT.HIGH_NIBBLE
     15288**DCL     15973<<ASSIGN  15984<<ASSIGN  16028<<ASSIGN  16039<<ASSIGN
ADDR_TMPLT.BYT.LOW_NIBBLE
     15289**DCL     15976<<ASSIGN  15985<<ASSIGN  16031<<ASSIGN  16040<<ASSIGN
B$ALT.CODE
     15020**DCL     15020--REDEF   15021--REDEF   15021--REDEF
B$ALT.ERR
     15021**DCL     16070<>CALL
B$ALT.ERR.ERR#
     15022**DCL     15022--REDEF
B$ALT.EVID
     15021**DCL     15021--REDEF   15021--REDEF
B$JIT.CPFLAGS1.SLEAZE
      6531**DCL      6531--REDEF
B$JIT.ERR.MID
      6438**DCL      6438--REDEF
B$JIT.JRESPEAK
      6599**DCL      6600--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      6708**DCL      6708--REDEF    6709--REDEF
B$JIT.PNR
      6612**DCL      6612--REDEF
B$JIT.TSLINE
      6706**DCL      6707--REDEF
B$JIT$
     15016**DCL      6432--IMP-PTR
B$TCB.ALT$
     15027**DCL     16070>>CALL
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:111  
B$TCB$
     15017**DCL     15027--IMP-PTR 16070>>CALL
DAT_VEC1_
     15282**DCL     16127<<ASSIGN  16128<>CALL    16130<<ASSIGN  16133<>CALL    16138<>CALL    16142<>CALL
     16146<>CALL    16149<>CALL    16154<>CALL    16157<>CALL
DELREC_ROUTE
     15835**DCL     16093<>CALL
DELREC_ROUTE.V
     15838**DCL     15835--DCLINIT
DISPLAY_NSAP_INFO
     16125**PROC    15899--CALL    15922--CALL
ENDOFILE
     15290**DCL     15914<<ASSIGN  15916>>DOWHILE 15926<<ASSIGN
ERRCODE
     15237**DCL     15877<<ASSIGN  15895<>CALL    15943<>CALL    15987<>CALL    16004<>CALL    16011<>CALL
     16081<<ASSIGN  16083<>CALL    16104<>CALL    16110<<ASSIGN  16112<>CALL
ERRCODE.ERR#
     15267**DCL     15894<<ASSIGN  15942<<ASSIGN  15986<<ASSIGN  16003<<ASSIGN  16010<<ASSIGN  16082<<ASSIGN
     16103<<ASSIGN  16111<<ASSIGN
ERR_C
     15146**DCL     15877>>ASSIGN  16081>>ASSIGN  16110>>ASSIGN
FEP_NODE_FMT
     15191**DCL     16145--ASSIGN
FMT_VEC_
     15281**DCL     16126<<ASSIGN  16128<>CALL    16132<<ASSIGN  16133<>CALL    16137<<ASSIGN  16138<>CALL
     16141<<ASSIGN  16142<>CALL    16145<<ASSIGN  16146<>CALL    16148<<ASSIGN  16149<>CALL    16153<<ASSIGN
     16154<>CALL    16156<<ASSIGN  16157<>CALL
HEX_CHAR
     15278**DCL     15971<<ASSIGN  15972>>CALLBLT 15974<<ASSIGN  15975>>CALLBLT 15982<<ASSIGN  15983>>CALLBLT
     16026<<ASSIGN  16027>>CALLBLT 16029<<ASSIGN  16030>>CALLBLT 16037<<ASSIGN  16038>>CALLBLT
HEX_DIGIT
     15279**DCL     15972<<CALLBLT 15973>>ASSIGN  15975<<CALLBLT 15976>>ASSIGN  15983<<CALLBLT 15984>>ASSIGN
     16027<<CALLBLT 16028>>ASSIGN  16030<<CALLBLT 16031>>ASSIGN  16038<<CALLBLT 16039>>ASSIGN
HEX_DIGITS
     15211**DCL     15972>>CALLBLT 15975>>CALLBLT 15983>>CALLBLT 16027>>CALLBLT 16030>>CALLBLT 16038>>CALLBLT
HOST_NODE_FMT
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:112  
     15188**DCL     16141--ASSIGN
I
     15273**DCL     15882<<DOINDEX 15883>>CALL    15955<<ASSIGN  15957>>DOINDEX
J
     15274**DCL     15957<<DOINDEX 15958>>ASSIGN
K
     15275**DCL     15970<<DOINDEX 15971>>ASSIGN  15974>>ASSIGN  16025<<DOINDEX 16026>>ASSIGN  16029>>ASSIGN
     16054<<CALLBLT 16055>>ASSIGN  16058<<CALLBLT 16059>>ASSIGN
L
     15276**DCL     15969<<ASSIGN  15973>>ASSIGN  15976>>ASSIGN  15977<<ASSIGN  15977>>ASSIGN  15984>>ASSIGN
     15985>>ASSIGN  16024<<ASSIGN  16028>>ASSIGN  16031>>ASSIGN  16032<<ASSIGN  16032>>ASSIGN  16039>>ASSIGN
     16040>>ASSIGN
LEN
     15277**DCL     15113--IMP-SIZ 15966<<ASSIGN  15967<<ASSIGN  15970>>DOINDEX 15980>>IF      15982>>ASSIGN
     15990<<ASSIGN  15991>>ASSIGN  15991>>ASSIGN  15992>>ASSIGN  16021<<ASSIGN  16022<<ASSIGN  16025>>DOINDEX
     16035>>IF      16037>>ASSIGN  16043<<ASSIGN  16044>>ASSIGN  16044>>ASSIGN
LNSAP_DATA
     15518**DCL     15995<<ASSIGN  15999--ASSIGN
LNSAP_DATA.LNSAP.ADDRESS_N
     15672**DCL     15673--REDEF
LNSAP_DATA.MYNODE#
     15553**DCL     15555--REDEF
LNSAP_DATA.NODE#
     15556**DCL     15558--REDEF
LNSAP_DATA.NSAP
     15586**DCL     16014>>ASSIGN
LNSAP_DATA.NSAP.ADDRESS_N
     15616**DCL     15617--REDEF
LNSAP_DATA.NS_TYPE
     15541**DCL     16008>>IF
LNSAP_KEY
     15221**DCL     15996<<ASSIGN  15998--ASSIGN
LNSAP_KEY.NSAPNAME
     15223**DCL     15997<<ASSIGN
M$DELREC
      5500**DCL-ENT 16093--CALL
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:113  
M$PRECORD
      5502**DCL-ENT 15909--CALL    15924--CALL
M$READ
      5499**DCL-ENT 15892--CALL    15917--CALL    15940--CALL    16001--CALL    16091--CALL
M$WRITE
      5499**DCL-ENT 16069--CALL
NOT_DEFINED
     16103**LABEL   16093--CALLALT
NSAPNAME_FMT
     15180**DCL     16126--ASSIGN
NSAPTYPE_FMT
     15182**DCL     16132--ASSIGN
NSAP_DATA
     15309**DCL     15737--DCLINIT 15738--DCLINIT 15780--DCLINIT 15781--DCLINIT 15890--ASSIGN  15904<<ASSIGN
     15908--ASSIGN  15933<<ASSIGN  16068--ASSIGN  16074--CALL    16089--ASSIGN  16095--CALL    16130--ASSIGN
NSAP_DATA.FCN
     15320**DCL     15947<<ASSIGN  16073<<ASSIGN  16094<<ASSIGN
NSAP_DATA.FEP#
     15349**DCL     16055<<ASSIGN
NSAP_DATA.HOST#
     15346**DCL     16059<<ASSIGN  16064>>IF      16065<<ASSIGN
NSAP_DATA.LNSAP
     15433**DCL     16014<<ASSIGN
NSAP_DATA.LNSAP.ADDRESS_N
     15463**DCL     15464--REDEF
NSAP_DATA.MYNODE#
     15344**DCL     15346--REDEF
NSAP_DATA.NODE#
     15347**DCL     15349--REDEF
NSAP_DATA.NSAP.ADDRESS_N
     15407**DCL     15408--REDEF
NSAP_DATA.NSAP.AFI
     15384**DCL     15991--ASSIGN
NSAP_DATA.NSAP.LEN
     15379**DCL     15963<<ASSIGN  15965>>IF      15966>>ASSIGN  15967>>ASSIGN  15980>>IF      15990>>ASSIGN
     15992<<ASSIGN
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:114  
NSAP_DATA.NS_TYPE
     15332**DCL     15952<<ASSIGN  15953<<ASSIGN  16064>>IF      16135>>IF      16151>>IF
NSAP_DATA.NW_TYPE
     15338**DCL     15934<<ASSIGN  16048<<ASSIGN  16050<<ASSIGN  16051<<ASSIGN
NSAP_DATA.SNPA.ADDRESS
     15494**DCL     16044--ASSIGN
NSAP_DATA.SNPA.LEN
     15489**DCL     16018<<ASSIGN  16020>>IF      16021>>ASSIGN  16022>>ASSIGN  16035>>IF      16043>>ASSIGN
NSAP_FMT2
     15194**DCL     16148--ASSIGN
NSAP_FMT3
     15196**DCL     16153--ASSIGN
NSAP_FMT4
     15198**DCL     16156--ASSIGN
NSAP_KEY
     15217**DCL     15735--DCLINIT 15736--DCLINIT 15779--DCLINIT 15810--DCLINIT 15811--DCLINIT 15835--DCLINIT
     15836--DCLINIT 15876<<ASSIGN  15889--ASSIGN  15903<<ASSIGN  15907--ASSIGN  15936<<ASSIGN  15938--ASSIGN
     16067--ASSIGN  16083--CALL    16086<<ASSIGN  16088--ASSIGN  16112--CALL
NSAP_KEY.LEN
     15218**DCL     15905<<ASSIGN
NSAP_KEY.NSAPNAME
     15219**DCL     15891<<ASSIGN  15937<<ASSIGN  16087<<ASSIGN  16127--ASSIGN
NSAP_KEY_C
     15213**DCL     15876>>ASSIGN  15936>>ASSIGN  15996>>ASSIGN  16086>>ASSIGN
NSAP_KEY_C.LEN
     15214**DCL     15905>>ASSIGN
NWTYPE_FMT
     15185**DCL     16137--ASSIGN
OPTIONS$
     15272**DCL     15956<<ASSIGN  15958>>ASSIGN
OUT$BLK.CODE
     15044**DCL     15879>>DOCASE  15951>>IF      15959>>DOCASE
OUT$BLK.NSUBLKS
     15048**DCL     15882>>DOINDEX 15887>>IF      15955>>ASSIGN
OUT$BLK.SUBLK$
     15069**DCL     15883<>CALL    15891>>ASSIGN  15891>>ASSIGN  15891>>ASSIGN  15891>>ASSIGN  15937>>ASSIGN
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:115  
     15937>>ASSIGN  15937>>ASSIGN  15937>>ASSIGN  15951>>IF      15955>>ASSIGN  15956>>ASSIGN  15958>>ASSIGN
     15963>>ASSIGN  15971>>ASSIGN  15971>>ASSIGN  15974>>ASSIGN  15974>>ASSIGN  15982>>ASSIGN  15982>>ASSIGN
     15997>>ASSIGN  15997>>ASSIGN  15997>>ASSIGN  15997>>ASSIGN  16018>>ASSIGN  16026>>ASSIGN  16026>>ASSIGN
     16029>>ASSIGN  16029>>ASSIGN  16037>>ASSIGN  16037>>ASSIGN  16047>>IF      16049>>IF      16054>>CALLBLT
     16054>>CALLBLT 16058>>CALLBLT 16058>>CALLBLT 16087>>ASSIGN  16087>>ASSIGN  16087>>ASSIGN  16087>>ASSIGN
OUT$SYM.CODE
     15088**DCL     16047>>IF      16049>>IF
OUT$SYM.COUNT
     15105**DCL     15108--IMP-SIZ 15891>>ASSIGN  15937>>ASSIGN  15963>>ASSIGN  15971>>ASSIGN  15974>>ASSIGN
     15982>>ASSIGN  15997>>ASSIGN  16018>>ASSIGN  16026>>ASSIGN  16029>>ASSIGN  16037>>ASSIGN  16054>>CALLBLT
     16058>>CALLBLT 16087>>ASSIGN
OUT$SYM.TEXT
     15108**DCL     15891>>ASSIGN  15937>>ASSIGN  15971>>ASSIGN  15974>>ASSIGN  15982>>ASSIGN  15997>>ASSIGN
     16026>>ASSIGN  16029>>ASSIGN  16037>>ASSIGN  16054>>CALLBLT 16058>>CALLBLT 16087>>ASSIGN
PRECORD_ROUTE
     15810**DCL     15909<>CALL    15924<>CALL
PRECORD_ROUTE.V
     15812**DCL     15810--DCLINIT
PRECORD_ROUTE.V.N#
     15816**DCL     15906<<ASSIGN  15915<<ASSIGN
READ_ROUTE
     15735**DCL     15892<>CALL    15917<>CALL    15940<>CALL    16001<>CALL    16091<>CALL
READ_ROUTE.BUF_
     15737**DCL     15890<<ASSIGN  15908<<ASSIGN  15999<<ASSIGN  16089<<ASSIGN
READ_ROUTE.KEY_
     15735**DCL     15889<<ASSIGN  15907<<ASSIGN  15938<<ASSIGN  15998<<ASSIGN  16088<<ASSIGN
READ_ROUTE.STATION_
     15738**DCL     15739--REDEF
READ_ROUTE.V
     15739**DCL     15735--DCLINIT
READ_ROUTE.V.DVBYTE.REREAD#
     15750**DCL     15750--REDEF
READ_ROUTE.V.INDX#
     15748**DCL     15748--REDEF
ROUTE_COMMAND
         8**PROC    15883--CALL
PL6.E3A0      #003=ROUTE_COMMAND File=KSX$ROUTECON.:E05TSI                       WED 07/30/97 01:50 Page:116  
ROUTE_END_FLG
     15015**DCL     16117<<ASSIGN
ROUTE_WRITE
     15011**DCL-ENT 16128--CALL    16133--CALL    16138--CALL    16142--CALL    16146--CALL    16149--CALL
     16154--CALL    16157--CALL
SUBOPT$
     15271**DCL     15958<<ASSIGN  15959>>DOCASE  15963>>ASSIGN  15971>>ASSIGN  15971>>ASSIGN  15974>>ASSIGN
     15974>>ASSIGN  15982>>ASSIGN  15982>>ASSIGN  15997>>ASSIGN  15997>>ASSIGN  16018>>ASSIGN  16026>>ASSIGN
     16026>>ASSIGN  16029>>ASSIGN  16029>>ASSIGN  16037>>ASSIGN  16037>>ASSIGN  16047>>IF      16049>>IF
     16054>>CALLBLT 16054>>CALLBLT 16058>>CALLBLT 16058>>CALLBLT
TOP$
     15009**DCL         8--PROC    15036--IMP-PTR 15082--IMP-PTR 15879>>DOCASE  15882>>DOINDEX 15883>>CALL
     15887>>IF      15891>>ASSIGN  15891>>ASSIGN  15937>>ASSIGN  15937>>ASSIGN  15951>>IF      15955>>ASSIGN
     15956>>ASSIGN  16087>>ASSIGN  16087>>ASSIGN
VLR_MONINFO.NODE#
     15129**DCL     16065>>ASSIGN
WRHLPCG
     15013**DCL-ENT 16074--CALL    16095--CALL
WRITE_ROUTE
     15779**DCL     16069<>CALL
WRITE_ROUTE.BUF_
     15779**DCL     16068<<ASSIGN
WRITE_ROUTE.KEY_
     15779**DCL     16067<<ASSIGN
WRITE_ROUTE.STATION_
     15781**DCL     15781--REDEF
WRITE_ROUTE.V
     15782**DCL     15779--DCLINIT
WRITE_ROUTE.V.DVBYTE.VFC#
     15788**DCL     15788--REDEF
XUR$ERRMSG
     15012**DCL-ENT 15895--CALL    15943--CALL    15987--CALL    16004--CALL    16011--CALL    16070--CALL
     16083--CALL    16104--CALL    16112--CALL

PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:117  
      687        1        /*T***********************************************************/
      688        2        /*T*                                                         */
      689        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      690        4        /*T*                                                         */
      691        5        /*T***********************************************************/
      692        6
      693        7        /*F* NAME: ROUTE_WRITE
      694        8        */
      695        9
      696       10        ROUTE_WRITE: PROC(FORMAT_VEC,DV1,DV2,DV3,DV4,DV5,DV6,DV7,DV8,DV9,DV10);
      697       11
      698       12                                                /* Parameters                         */
      699       13    1   DCL FORMAT_VEC DALIGNED VECTOR;
      700       14    1   DCL DV1 DALIGNED BIT(72);
      701       15    1   DCL DV2 DALIGNED BIT(72);
      702       16    1   DCL DV3 DALIGNED BIT(72);
      703       17    1   DCL DV4 DALIGNED BIT(72);
      704       18    1   DCL DV5 DALIGNED BIT(72);
      705       19    1   DCL DV6 DALIGNED BIT(72);
      706       20    1   DCL DV7 DALIGNED BIT(72);
      707       21    1   DCL DV8 DALIGNED BIT(72);
      708       22    1   DCL DV9 DALIGNED BIT(72);
      709       23    1   DCL DV10 DALIGNED BIT(72);
      710       24
      711       25                                                /* Include Files                      */
      712       26        %INCLUDE CP_6;
      713     5585        %INCLUDE XU_FORMAT_C;
      714     5747
      715     5748                                                /* DCBs                               */
      716     5749    1   DCL M$LO DCB;
      717     5750
      718     5751    1   DCL OUTBUF CHAR(100) STATIC SYMDEF INIT(' ');
      719     5752    1   DCL I UBIN;
      720     5753    1   DCL M$LO$ PTR;
      721     5754    1   DCL DATA_VEC(0:9) DALIGNED BIT(72) STATIC INIT(VECTOR(NIL)*0);
      722     5755
      723     5756    1   DCL X$FORMAT ENTRY(1);
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:118  
      724     5757
      725     5758        %F_FDS (NAME=FDS,
      726     5759                DCB=M$LO,
      727     5760                TRUNC=NO,
      728     5761                BUF=OUTBUF,
      729     5762                VECTR=DATA_VEC);
      730     5875
      731     5876        /* BASED Data
      732     5877        */
      733     5878        %INCLUDE F$DCB;
      734     5927
      735     5928        %EJECT;
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:119  
      736     5929    1      M$LO$ = DCBADDR(DCBNUM(M$LO));
      737     5930    1      FDS.FMT_ = FORMAT_VEC;
      738     5931
      739     5932    1      IF ADDR(DV1) ~= ADDR(NIL)
      740     5933    1      THEN DATA_VEC(0) = DV1;
      741     5934
      742     5935    1      IF ADDR(DV2) ~= ADDR(NIL)
      743     5936    1      THEN DATA_VEC(1) = DV2;
      744     5937    1      IF ADDR(DV3) ~= ADDR(NIL)
      745     5938    1      THEN DATA_VEC(2) = DV3;
      746     5939    1      IF ADDR(DV4) ~= ADDR(NIL)
      747     5940    1      THEN DATA_VEC(3) = DV4;
      748     5941    1      IF ADDR(DV5) ~= ADDR(NIL)
      749     5942    1      THEN DATA_VEC(4) = DV5;
      750     5943    1      IF ADDR(DV6) ~= ADDR(NIL)
      751     5944    1      THEN DATA_VEC(5) = DV6;
      752     5945    1      IF ADDR(DV7) ~= ADDR(NIL)
      753     5946    1      THEN DATA_VEC(6) = DV7;
      754     5947    1      IF ADDR(DV8) ~= ADDR(NIL)
      755     5948    1      THEN DATA_VEC(7) = DV8;
      756     5949    1      IF ADDR(DV9) ~= ADDR(NIL)
      757     5950    1      THEN DATA_VEC(8) = DV9;
      758     5951    1      IF ADDR(DV10) ~= ADDR(NIL)
      759     5952    1      THEN DATA_VEC(9) = DV10;
      760     5953
      761     5954    1      I = 0;
      762     5955    2      DO WHILE(DATA_VEC(I) ~= VECTOR(NIL) AND I < 10);
      763     5956    2           I = I + 1;
      764     5957    2           END/*do while*/;
      765     5958
      766     5959    1      FDS.NVECS# = I;
      767     5960    1      FDS.BUF_.BOUND = M$LO$->F$DCB.WIDTH;
      768     5961    1      IF (FDS.BUF_.BOUND = 0 OR FDS.BUF_.BOUND > 100)
      769     5962    1      THEN FDS.BUF_.BOUND = 100;
      770     5963
      771     5964    1      CALL X$FORMAT(FDS);
      772     5965    1   END ROUTE_WRITE;
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:120  
      773     5966        %EOD;

PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:121  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ROUTE_WRITE.

   Procedure ROUTE_WRITE requires 108 words for executable code.
   Procedure ROUTE_WRITE requires 16 words of local(AUTO) storage.

PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:122  

 Object Unit name= ROUTE_WRITE                                File name= KSX$ROUTECON.:E05TOU
 UTS= JUL 30 '97 01:51:38.16 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    76    114  ROUTE_WRITE
    3   Proc  even  none   108    154  ROUTE_WRITE
    4  RoData even  none     6      6  ROUTE_WRITE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std       11  ROUTE_WRITE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    2      0  OUTBUF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_N
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:123  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$LO                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:124  


      687        1        /*T***********************************************************/
      688        2        /*T*                                                         */
      689        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      690        4        /*T*                                                         */
      691        5        /*T***********************************************************/
      692        6
      693        7        /*F* NAME: ROUTE_WRITE
      694        8        */
      695        9
      696       10        ROUTE_WRITE: PROC(FORMAT_VEC,DV1,DV2,DV3,DV4,DV5,DV6,DV7,DV8,DV9,DV10);

     10  3 000000   000000 700200 xent  ROUTE_WRITE  TSX0  ! X66_AUTO_N
         3 000001   000020 000013                    ZERO    16,11

      697       11
      698       12                                                /* Parameters                         */
      699       13    1   DCL FORMAT_VEC DALIGNED VECTOR;
      700       14    1   DCL DV1 DALIGNED BIT(72);
      701       15    1   DCL DV2 DALIGNED BIT(72);
      702       16    1   DCL DV3 DALIGNED BIT(72);
      703       17    1   DCL DV4 DALIGNED BIT(72);
      704       18    1   DCL DV5 DALIGNED BIT(72);
      705       19    1   DCL DV6 DALIGNED BIT(72);
      706       20    1   DCL DV7 DALIGNED BIT(72);
      707       21    1   DCL DV8 DALIGNED BIT(72);
      708       22    1   DCL DV9 DALIGNED BIT(72);
      709       23    1   DCL DV10 DALIGNED BIT(72);
      710       24
      711       25                                                /* Include Files                      */
      712       26        %INCLUDE CP_6;
      713     5585        %INCLUDE XU_FORMAT_C;
      714     5747
      715     5748                                                /* DCBs                               */
      716     5749    1   DCL M$LO DCB;
      717     5750
      718     5751    1   DCL OUTBUF CHAR(100) STATIC SYMDEF INIT(' ');
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:125  
      719     5752    1   DCL I UBIN;
      720     5753    1   DCL M$LO$ PTR;
      721     5754    1   DCL DATA_VEC(0:9) DALIGNED BIT(72) STATIC INIT(VECTOR(NIL)*0);
      722     5755
      723     5756    1   DCL X$FORMAT ENTRY(1);
      724     5757
      725     5758        %F_FDS (NAME=FDS,
      726     5759                DCB=M$LO,
      727     5760                TRUNC=NO,
      728     5761                BUF=OUTBUF,
      729     5762                VECTR=DATA_VEC);
      730     5875
      731     5876        /* BASED Data
      732     5877        */
      733     5878        %INCLUDE F$DCB;
      734     5927
      735     5928        %EJECT;
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:126  
      736     5929    1      M$LO$ = DCBADDR(DCBNUM(M$LO));

   5929  3 000002   000000 236007 xsym               LDQ     M$LO,DL
         3 000003   000000 470400 4                  LDP0    0
         3 000004   000000 471500                    LDP1    0,,PR0
         3 000005   100000 236106                    LDQ     0,QL,PR1
         3 000006   200017 756100                    STQ     M$LO$,,AUTO

      737     5930    1      FDS.FMT_ = FORMAT_VEC;

   5930  3 000007   200003 473500                    LDP3    @FORMAT_VEC,,AUTO
         3 000010   300000 237100                    LDAQ    0,,PR3
         3 000011   000056 757000 2                  STAQ    FDS

      738     5931
      739     5932    1      IF ADDR(DV1) ~= ADDR(NIL)

   5932  3 000012   200004 236100                    LDQ     @DV1,,AUTO
         3 000013   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000014   000020 600000 3                  TZE     s:5935

      740     5933    1      THEN DATA_VEC(0) = DV1;

   5933  3 000015   200004 474500                    LDP4    @DV1,,AUTO
         3 000016   400000 237100                    LDAQ    0,,PR4
         3 000017   000032 757000 2                  STAQ    DATA_VEC

      741     5934
      742     5935    1      IF ADDR(DV2) ~= ADDR(NIL)

   5935  3 000020   200005 236100                    LDQ     @DV2,,AUTO
         3 000021   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000022   000026 600000 3                  TZE     s:5937

      743     5936    1      THEN DATA_VEC(1) = DV2;

   5936  3 000023   200005 474500                    LDP4    @DV2,,AUTO
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:127  
         3 000024   400000 237100                    LDAQ    0,,PR4
         3 000025   000034 757000 2                  STAQ    DATA_VEC+2

      744     5937    1      IF ADDR(DV3) ~= ADDR(NIL)

   5937  3 000026   200006 236100                    LDQ     @DV3,,AUTO
         3 000027   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000030   000034 600000 3                  TZE     s:5939

      745     5938    1      THEN DATA_VEC(2) = DV3;

   5938  3 000031   200006 474500                    LDP4    @DV3,,AUTO
         3 000032   400000 237100                    LDAQ    0,,PR4
         3 000033   000036 757000 2                  STAQ    DATA_VEC+4

      746     5939    1      IF ADDR(DV4) ~= ADDR(NIL)

   5939  3 000034   200007 236100                    LDQ     @DV4,,AUTO
         3 000035   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000036   000042 600000 3                  TZE     s:5941

      747     5940    1      THEN DATA_VEC(3) = DV4;

   5940  3 000037   200007 474500                    LDP4    @DV4,,AUTO
         3 000040   400000 237100                    LDAQ    0,,PR4
         3 000041   000040 757000 2                  STAQ    DATA_VEC+6

      748     5941    1      IF ADDR(DV5) ~= ADDR(NIL)

   5941  3 000042   200010 236100                    LDQ     @DV5,,AUTO
         3 000043   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000044   000050 600000 3                  TZE     s:5943

      749     5942    1      THEN DATA_VEC(4) = DV5;

   5942  3 000045   200010 474500                    LDP4    @DV5,,AUTO
         3 000046   400000 237100                    LDAQ    0,,PR4
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:128  
         3 000047   000042 757000 2                  STAQ    DATA_VEC+8

      750     5943    1      IF ADDR(DV6) ~= ADDR(NIL)

   5943  3 000050   200011 236100                    LDQ     @DV6,,AUTO
         3 000051   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000052   000056 600000 3                  TZE     s:5945

      751     5944    1      THEN DATA_VEC(5) = DV6;

   5944  3 000053   200011 474500                    LDP4    @DV6,,AUTO
         3 000054   400000 237100                    LDAQ    0,,PR4
         3 000055   000044 757000 2                  STAQ    DATA_VEC+10

      752     5945    1      IF ADDR(DV7) ~= ADDR(NIL)

   5945  3 000056   200012 236100                    LDQ     @DV7,,AUTO
         3 000057   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000060   000064 600000 3                  TZE     s:5947

      753     5946    1      THEN DATA_VEC(6) = DV7;

   5946  3 000061   200012 474500                    LDP4    @DV7,,AUTO
         3 000062   400000 237100                    LDAQ    0,,PR4
         3 000063   000046 757000 2                  STAQ    DATA_VEC+12

      754     5947    1      IF ADDR(DV8) ~= ADDR(NIL)

   5947  3 000064   200013 236100                    LDQ     @DV8,,AUTO
         3 000065   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000066   000072 600000 3                  TZE     s:5949

      755     5948    1      THEN DATA_VEC(7) = DV8;

   5948  3 000067   200013 474500                    LDP4    @DV8,,AUTO
         3 000070   400000 237100                    LDAQ    0,,PR4
         3 000071   000050 757000 2                  STAQ    DATA_VEC+14
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:129  

      756     5949    1      IF ADDR(DV9) ~= ADDR(NIL)

   5949  3 000072   200014 236100                    LDQ     @DV9,,AUTO
         3 000073   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000074   000100 600000 3                  TZE     s:5951

      757     5950    1      THEN DATA_VEC(8) = DV9;

   5950  3 000075   200014 474500                    LDP4    @DV9,,AUTO
         3 000076   400000 237100                    LDAQ    0,,PR4
         3 000077   000052 757000 2                  STAQ    DATA_VEC+16

      758     5951    1      IF ADDR(DV10) ~= ADDR(NIL)

   5951  3 000100   200015 236100                    LDQ     @DV10,,AUTO
         3 000101   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000102   000106 600000 3                  TZE     s:5954

      759     5952    1      THEN DATA_VEC(9) = DV10;

   5952  3 000103   200015 474500                    LDP4    @DV10,,AUTO
         3 000104   400000 237100                    LDAQ    0,,PR4
         3 000105   000054 757000 2                  STAQ    DATA_VEC+18

      760     5953
      761     5954    1      I = 0;

   5954  3 000106   200016 450100                    STZ     I,,AUTO

      762     5955    2      DO WHILE(DATA_VEC(I) ~= VECTOR(NIL) AND I < 10);

   5955  3 000107   000113 710000 3                  TRA     s:5957

      763     5956    2           I = I + 1;

   5956  3 000110   200016 235100                    LDA     I,,AUTO
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:130  
         3 000111   000001 035007                    ADLA    1,DL
         3 000112   200016 755100                    STA     I,,AUTO

      764     5957    2           END/*do while*/;

   5957  3 000113   200016 235100                    LDA     I,,AUTO
         3 000114   000001 735000                    ALS     1
         3 000115   000032 237005 2                  LDAQ    DATA_VEC,AL
         3 000116   000002 117000 4                  CMPAQ   2
         3 000117   000123 600000 3                  TZE     s:5959
         3 000120   200016 235100                    LDA     I,,AUTO
         3 000121   000012 115007                    CMPA    10,DL
         3 000122   000110 602000 3                  TNC     s:5956

      765     5958
      766     5959    1      FDS.NVECS# = I;

   5959  3 000123   200016 235100                    LDA     I,,AUTO
         3 000124   000067 755000 2                  STA     FDS+9

      767     5960    1      FDS.BUF_.BOUND = M$LO$->F$DCB.WIDTH;

   5960  3 000125   200017 470500                    LDP0    M$LO$,,AUTO
         3 000126   000004 236100                    LDQ     4,,PR0
         3 000127   000777 376007                    ANQ     511,DL
         3 000130   000020 736000                    QLS     16
         3 000131   000063 676000 2                  ERQ     FDS+5
         3 000132   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000133   000063 656000 2                  ERSQ    FDS+5

      768     5961    1      IF (FDS.BUF_.BOUND = 0 OR FDS.BUF_.BOUND > 100)

   5961  3 000134   000063 236000 2                  LDQ     FDS+5
         3 000135   000034 316000 xsym               CANQ    B_VECTNIL+28
         3 000136   000143 600000 3                  TZE     s:5962
         3 000137   000063 236000 2                  LDQ     FDS+5
         3 000140   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:131  
         3 000141   000004 116000 4                  CMPQ    4
         3 000142   000147 602000 3                  TNC     s:5964

      769     5962    1      THEN FDS.BUF_.BOUND = 100;

   5962  3 000143   000063 236000 2                  LDQ     FDS+5
         3 000144   177777 376007                    ANQ     65535,DL
         3 000145   000031 276003                    ORQ     25,DU
         3 000146   000063 756000 2                  STQ     FDS+5

      770     5963
      771     5964    1      CALL X$FORMAT(FDS);

   5964  3 000147   000005 630400 4                  EPPR0   5
         3 000150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000151   000000 701000 xent               TSX1    X$FORMAT
         3 000152   000000 011000                    NOP     0

      772     5965    1   END ROUTE_WRITE;

   5965  3 000153   000000 702200 xent               TSX2  ! X66_ARET
      773     5966        %EOD;

PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:132  
--  Include file information  --

   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ROUTE_WRITE.
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:133  

 **** Variables and constants ****

  ****  Section 002  Data  ROUTE_WRITE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    32-0-0/d BIT (72)    r     1 DATA_VEC(0:9)
    56-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(100)   r     1 OUTBUF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DV1                      15-0-0/w PTR         r     1 @DV10
     5-0-0/w PTR         r     1 @DV2                       6-0-0/w PTR         r     1 @DV3
     7-0-0/w PTR         r     1 @DV4                      10-0-0/w PTR         r     1 @DV5
    11-0-0/w PTR         r     1 @DV6                      12-0-0/w PTR         r     1 @DV7
    13-0-0/w PTR         r     1 @DV8                      14-0-0/w PTR         r     1 @DV9
     3-0-0/w PTR         r     1 @FORMAT_VEC               *0-0-0/d BIT (72)    r     1 DV1
    *0-0-0/d BIT (72)    r     1 DV10                      *0-0-0/d BIT (72)    r     1 DV2
    *0-0-0/d BIT (72)    r     1 DV3                       *0-0-0/d BIT (72)    r     1 DV4
    *0-0-0/d BIT (72)    r     1 DV5                       *0-0-0/d BIT (72)    r     1 DV6
    *0-0-0/d BIT (72)    r     1 DV7                       *0-0-0/d BIT (72)    r     1 DV8
    *0-0-0/d BIT (72)    r     1 DV9                       *0-0-0/d VECT        r     1 FORMAT_VEC
    16-0-0/w UBIN        r     1 I                         17-0-0/w PTR         r     1 M$LO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$LO

PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:134  

   Procedure ROUTE_WRITE requires 108 words for executable code.
   Procedure ROUTE_WRITE requires 16 words of local(AUTO) storage.
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:135  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:136  
          MINI XREF LISTING

DATA_VEC
      5754**DCL      5806--DCLINIT  5933<<ASSIGN   5936<<ASSIGN   5938<<ASSIGN   5940<<ASSIGN   5942<<ASSIGN
      5944<<ASSIGN   5946<<ASSIGN   5948<<ASSIGN   5950<<ASSIGN   5952<<ASSIGN   5955>>DOWHILE
DV1
        14**DCL        10--PROC     5932--IF       5933>>ASSIGN
DV10
        23**DCL        10--PROC     5951--IF       5952>>ASSIGN
DV2
        15**DCL        10--PROC     5935--IF       5936>>ASSIGN
DV3
        16**DCL        10--PROC     5937--IF       5938>>ASSIGN
DV4
        17**DCL        10--PROC     5939--IF       5940>>ASSIGN
DV5
        18**DCL        10--PROC     5941--IF       5942>>ASSIGN
DV6
        19**DCL        10--PROC     5943--IF       5944>>ASSIGN
DV7
        20**DCL        10--PROC     5945--IF       5946>>ASSIGN
DV8
        21**DCL        10--PROC     5947--IF       5948>>ASSIGN
DV9
        22**DCL        10--PROC     5949--IF       5950>>ASSIGN
F$DCB.ACTPOS
      5904**DCL      5904--REDEF
F$DCB.ARS
      5879**DCL      5879--REDEF
F$DCB.ATTR
      5897**DCL      5898--REDEF
F$DCB.BORROW
      5912**DCL      5912--REDEF    5912--REDEF    5912--REDEF
F$DCB.DCBNAME.L
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:137  
      5926**DCL      5926--IMP-SIZ
F$DCB.EOMCHAR
      5883**DCL      5883--REDEF
F$DCB.FLDID
      5907**DCL      5907--REDEF
F$DCB.FORM$
      5901**DCL      5901--REDEF
F$DCB.FSECT
      5917**DCL      5917--REDEF
F$DCB.FSN
      5894**DCL      5894--REDEF    5894--REDEF    5895--REDEF
F$DCB.HEADER$
      5900**DCL      5900--REDEF
F$DCB.IXTNSIZE
      5898**DCL      5898--REDEF
F$DCB.LASTSTA$
      5888**DCL      5888--REDEF
F$DCB.LVL
      5913**DCL      5913--REDEF
F$DCB.NAME.C
      5888**DCL      5888--REDEF
F$DCB.NOEOF
      5909**DCL      5909--REDEF
F$DCB.NRECS
      5899**DCL      5899--REDEF
F$DCB.NRECX
      5918**DCL      5918--REDEF
F$DCB.OHDR
      5910**DCL      5910--REDEF
F$DCB.ORG
      5893**DCL      5893--REDEF
F$DCB.PRECNO
      5916**DCL      5916--REDEF
F$DCB.RCSZ
      5921**DCL      5921--REDEF
F$DCB.RES
PL6.E3A0      #004=ROUTE_WRITE File=KSX$ROUTECON.:E05TSI                         WED 07/30/97 01:51 Page:138  
      5889**DCL      5889--REDEF
F$DCB.SETX
      5901**DCL      5901--REDEF
F$DCB.TAB$
      5900**DCL      5901--REDEF
F$DCB.TDA
      5915**DCL      5915--REDEF
F$DCB.WIDTH
      5886**DCL      5960>>ASSIGN
F$DCB.WSN
      5890**DCL      5890--REDEF
FDS
      5776**DCL      5964<>CALL
FDS.BUF_.BOUND
      5794**DCL      5960<<ASSIGN   5961>>IF       5961>>IF       5962<<ASSIGN
FDS.FMT_
      5780**DCL      5930<<ASSIGN
FDS.NVECS#
      5804**DCL      5959<<ASSIGN
FORMAT_VEC
        13**DCL        10--PROC     5930>>ASSIGN
I
      5752**DCL      5954<<ASSIGN   5955>>DOWHILE  5955>>DOWHILE  5956<<ASSIGN   5956>>ASSIGN   5959>>ASSIGN
M$LO
      5749**DCL      5929--ASSIGN
M$LO$
      5753**DCL      5929<<ASSIGN   5960>>ASSIGN
OUTBUF
      5751**DCL      5794--DCLINIT  5796--DCLINIT
X$FORMAT
      5756**DCL-ENT  5964--CALL

PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:139  
      774        1        /*T***********************************************************/
      775        2        /*T*                                                         */
      776        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      777        4        /*T*                                                         */
      778        5        /*T***********************************************************/
      779        6
      780        7        /*F* NAME: WRHLPCG
      781        8        */
      782        9
      783       10        WRHLPCG: PROC(BUF_VEC) ALTRET;
      784       11
      785       12    1   DCL BUF_VEC VECTOR;
      786       13
      787       14                                                /* Include Files                      */
      788       15        %INCLUDE CP_6;
      789     5574        %INCLUDE CP_6_SUBS;
      790     6114        %INCLUDE KL_MACRO_C;
      791     9466        %INCLUDE B_ERRORS_C;
      792    10593        %INCLUDE B$JIT_C;
      793    10907        %INCLUDE K_ADDRESS_M;
      794    11410
      795    11411    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      796    11412
      797    11413        %B$TCB;
      798    11416        %B$ALT;
      799    11424
      800    11425    1   DCL M$HLPCG DCB;
      801    11426    1   DCL HLPADMIN CHAR(8) STATIC INIT('HLPADMIN');
      802    11427    1   DCL BUF$ PTR;
      803    11428
      804    11429    1   DCL B$TCB$ PTR SYMREF;
      805    11430
      806    11431    1   DCL 1 MYSTATION SYMREF ALIGNED,
      807    11432    1         2 * CHAR(2) UNAL,
      808    11433    1         2 SYSID CHAR(6) UNAL;
      809    11434    1   DCL MYSTATION_C REDEF MYSTATION CHAR(8);
      810    11435    1   DCL LASTMSG# UBIN SYMREF;
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:140  
      811    11436
      812    11437        %FPT_WRITE (FPTN=WRITE_HLPCG,
      813    11438                    DCB=M$HLPCG,
      814    11439                    STATION=VLP_STATION);
      815    11470        %VLP_STATION;
      816    11497        %KL_HDR (FPTN=HDR,STCLASS="BASED(BUF$)");
      817    11577
      818    11578        %EJECT;
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:141  
      819    11579    1      BUF$ = VBASE(BUF_VEC);
      820    11580    1      VLP_STATION.STATION# = HLPADMIN;
      821    11581    1      LASTMSG# = LASTMSG# + 1;
      822    11582
      823    11583    1      IF LASTMSG# >= 255
      824    11584    1      THEN LASTMSG# = 0;
      825    11585
      826    11586    1      WRITE_HLPCG.BUF_ = BUF_VEC;
      827    11587    1      CALL M$WRITE(WRITE_HLPCG)
      828    11588    2      WHENALTRETURN DO;
      829    11589    2           CALL XUR$ERRMSG(B$TCB$->B$TCB.ALT$->B$ALT.ERR);
      830    11590    2           END;
      831    11591    1      RETURN;
      832    11592
      833    11593    1   END WRHLPCG;

PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:142  
--  Include file information  --

   K_ADDRESS_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure WRHLPCG.

   Procedure WRHLPCG requires 29 words for executable code.
   Procedure WRHLPCG requires 8 words of local(AUTO) storage.

    No errors detected in file KSX$ROUTECON.:E05TSI    .

PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:143  

 Object Unit name= WRHLPCG                                    File name= KSX$ROUTECON.:E05TOU
 UTS= JUL 30 '97 01:52:09.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$HLPCG
    2   Data  even  none    22     26  WRHLPCG
    3   Proc  even  none    29     35  WRHLPCG

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        1  WRHLPCG

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       7 XUR$ERRMSG
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$HLPCG                               B$TCB$
     MYSTATION                             LASTMSG#                              B_VECTNIL
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:144  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:145  


      774        1        /*T***********************************************************/
      775        2        /*T*                                                         */
      776        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      777        4        /*T*                                                         */
      778        5        /*T***********************************************************/
      779        6
      780        7        /*F* NAME: WRHLPCG
      781        8        */
      782        9
      783       10        WRHLPCG: PROC(BUF_VEC) ALTRET;

     10  3 000000   000000 700200 xent  WRHLPCG      TSX0  ! X66_AUTO_1
         3 000001   000010 000001                    ZERO    8,1

      784       11
      785       12    1   DCL BUF_VEC VECTOR;
      786       13
      787       14                                                /* Include Files                      */
      788       15        %INCLUDE CP_6;
      789     5574        %INCLUDE CP_6_SUBS;
      790     6114        %INCLUDE KL_MACRO_C;
      791     9466        %INCLUDE B_ERRORS_C;
      792    10593        %INCLUDE B$JIT_C;
      793    10907        %INCLUDE K_ADDRESS_M;
      794    11410
      795    11411    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
      796    11412
      797    11413        %B$TCB;
      798    11416        %B$ALT;
      799    11424
      800    11425    1   DCL M$HLPCG DCB;
      801    11426    1   DCL HLPADMIN CHAR(8) STATIC INIT('HLPADMIN');
      802    11427    1   DCL BUF$ PTR;
      803    11428
      804    11429    1   DCL B$TCB$ PTR SYMREF;
      805    11430
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:146  
      806    11431    1   DCL 1 MYSTATION SYMREF ALIGNED,
      807    11432    1         2 * CHAR(2) UNAL,
      808    11433    1         2 SYSID CHAR(6) UNAL;
      809    11434    1   DCL MYSTATION_C REDEF MYSTATION CHAR(8);
      810    11435    1   DCL LASTMSG# UBIN SYMREF;
      811    11436
      812    11437        %FPT_WRITE (FPTN=WRITE_HLPCG,
      813    11438                    DCB=M$HLPCG,
      814    11439                    STATION=VLP_STATION);
      815    11470        %VLP_STATION;
      816    11497        %KL_HDR (FPTN=HDR,STCLASS="BASED(BUF$)");
      817    11577
      818    11578        %EJECT;
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:147  
      819    11579    1      BUF$ = VBASE(BUF_VEC);

  11579  3 000002   200003 470500                    LDP0    @BUF_VEC,,AUTO
         3 000003   000001 236100                    LDQ     1,,PR0
         3 000004   200004 756100                    STQ     BUF$,,AUTO

      820    11580    1      VLP_STATION.STATION# = HLPADMIN;

  11580  3 000005   000000 237000 2                  LDAQ    HLPADMIN
         3 000006   000016 757000 2                  STAQ    VLP_STATION

      821    11581    1      LASTMSG# = LASTMSG# + 1;

  11581  3 000007   000000 235000 xsym               LDA     LASTMSG#
         3 000010   000001 035007                    ADLA    1,DL
         3 000011   000000 755000 xsym               STA     LASTMSG#

      822    11582
      823    11583    1      IF LASTMSG# >= 255

  11583  3 000012   000377 115007                    CMPA    255,DL
         3 000013   000015 602000 3                  TNC     s:11586

      824    11584    1      THEN LASTMSG# = 0;

  11584  3 000014   000000 450000 xsym               STZ     LASTMSG#

      825    11585
      826    11586    1      WRITE_HLPCG.BUF_ = BUF_VEC;

  11586  3 000015   000000 237100                    LDAQ    0,,PR0
         3 000016   000006 757000 2                  STAQ    WRITE_HLPCG+4

      827    11587    1      CALL M$WRITE(WRITE_HLPCG)

  11587  3 000017   000002 630400 2                  EPPR0   WRITE_HLPCG
         3 000020   440001 713400                    CLIMB   alt,write
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:148  
         3 000021   401400 401760                    pmme    nvectors=4
         3 000022   000024 702000 3                  TSX2    s:11589
         3 000023   000034 710000 3                  TRA     s:11591

      828    11588    2      WHENALTRETURN DO;

      829    11589    2           CALL XUR$ERRMSG(B$TCB$->B$TCB.ALT$->B$ALT.ERR);

  11589  3 000024   000000 470400 xsym               LDP0    B$TCB$
         3 000025   000000 471500                    LDP1    0,,PR0
         3 000026   100102 633500                    EPPR3   66,,PR1
         3 000027   200006 453500                    STP3    BUF$+2,,AUTO
         3 000030   200006 630500                    EPPR0   BUF$+2,,AUTO
         3 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000032   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000033   000000 011000                    NOP     0

      830    11590    2           END;

      831    11591    1      RETURN;

  11591  3 000034   000000 702200 xent               TSX2  ! X66_ARET
      832    11592
      833    11593    1   END WRHLPCG;

PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:149  
--  Include file information  --

   K_ADDRESS_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure WRHLPCG.
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:150  

 **** Variables and constants ****

  ****  Section 002  Data  WRHLPCG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(8)     r     1 HLPADMIN                  16-0-0/w STRC(288)   r     1 VLP_STATION
     2-0-0/d STRC(432)   r     1 WRITE_HLPCG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUF_VEC                   4-0-0/w PTR         r     1 BUF$
    *0-0-0/d VECT        r     1 BUF_VEC

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w UBIN        r     1 LASTMSG#

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0N  NULL        r     1 M$HLPCG


   Procedure WRHLPCG requires 29 words for executable code.
   Procedure WRHLPCG requires 8 words of local(AUTO) storage.
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:151  

    No errors detected in file KSX$ROUTECON.:E05TSI    .
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:152  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:153  
          MINI XREF LISTING

B$ALT.CODE
     11418**DCL     11418--REDEF   11419--REDEF   11419--REDEF
B$ALT.ERR
     11419**DCL     11589<>CALL
B$ALT.ERR.ERR#
     11420**DCL     11420--REDEF
B$ALT.EVID
     11419**DCL     11419--REDEF   11419--REDEF
B$TCB.ALT$
     11414**DCL     11589>>CALL
B$TCB$
     11429**DCL     11589>>CALL
BUF$
     11427**DCL     11513--IMP-PTR 11579<<ASSIGN
BUF_VEC
        12**DCL        10--PROC    11579>>ASSIGN  11586>>ASSIGN
HLPADMIN
     11426**DCL     11580>>ASSIGN
LASTMSG#
     11435**DCL     11581<<ASSIGN  11581>>ASSIGN  11583>>IF      11584<<ASSIGN
M$WRITE
      5503**DCL-ENT 11587--CALL
MYSTATION
     11431**DCL     11434--REDEF
VLP_STATION
     11482**DCL     11458--DCLINIT
VLP_STATION.MSGIDXT
     11492**DCL     11495--REDEF
VLP_STATION.STATION#
     11486**DCL     11580<<ASSIGN
WRITE_HLPCG
     11456**DCL     11587<>CALL
PL6.E3A0      #005=WRHLPCG File=KSX$ROUTECON.:E05TSI                             WED 07/30/97 01:52 Page:154  
WRITE_HLPCG.BUF_
     11456**DCL     11586<<ASSIGN
WRITE_HLPCG.STATION_
     11458**DCL     11458--REDEF
WRITE_HLPCG.V
     11459**DCL     11456--DCLINIT
WRITE_HLPCG.V.DVBYTE.VFC#
     11465**DCL     11465--REDEF
XUR$ERRMSG
     11411**DCL-ENT 11589--CALL
