
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI                                                                  1    BMAP - B00     
                                         1  *M*    ZIG$DBAU
                                         2  *T***********************************************************
                                         3  *T*                                                         *
                                         4  *T* Copyright (c) Bull HN Information Systems Inc., 1997    *
                                         5  *T*                                                         *
                                         6  *T***********************************************************

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       H6600H2.893   IDS/II PA UPDATE PRIMITIVES     790907DBAU   2    BMAP - B00     
                                         7         TTL     H6600H2.893   IDS/II PA UPDATE PRIMITIVES     790907DBAU
                                         8         CPR     1977
                                         9         PMC     OFF
                                        10        ENTDEF  ZIM$DBAU               USE MODULE NAME AS DEBUG SCHEMA
                                        11         ENTDEF  ZIG$DBADE,ZIG$DBADR
                                        12         ENTDEF  ZIG$DBACE,ZIG$DBAIS
                                        13         ENTREF  ZIG$DBPFD,ZIG$DBAVO
                                        14         ENTREF  ZIG$DBPFP,ZIG$DBPDR
                                        15         ENTREF  ZIG$DBABS,ZIQ$DBIOL
                                        16         ENTREF  ZIG$DBPFS,ZIG$DBPFN
                                        17         ENTREF  ZIG$DBPFO
                                        18         ENTREF  ZIQ$DBPR3
                                        19         ENTREF  ZIQ$DBIOA,ZIG$DBPR2
                                        20         ENTREF  ZIG$DBAFN
                                        21        ENTREF   ZIM$DBPLK,ZIM$DBPUL,ZIM$DBPMR
                                        22         ENTREF  ZIG$DBXCI
                                        23         ENTREF  ZIM$PCON,ZIM$PDIS
                                        24        ENTREF  ZIM$JSTO,ZIM$JBEFPA,ZIM$JAFTPA
                                        25        ENTREF  ZIM$JPASET,ZIM$JPAMEM,ZIM$JDEL
                                        26        ENTREF  ZIM$JPAFIL,ZIM$JPALIL
                                        27         LODM    Q2MA
                                        28         Q2SYM
 0 000000                               29  ZIM$DBAU NULL                        USE MODULE NAME AS DEBUG SCHEMA

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CORRECT PA POINTERS IN MEMBER RECORDS                      3    BMAP - B00     
                                        30         TTLS    CORRECT PA POINTERS IN MEMBER RECORDS
                                        31  *
                                        32  *  THIS ROUTINE WILL UPDATE THE PA OWNER POINTERS
                                        33  *  IN MEMBER RECORDS WHICH WERE CHANGED BECAUSE OF
                                        34  *  A SPLIT IN A PA RECORD
                                        35  *
                                        36  *  INPUT ARGUMENTS:
                                        37  *      RVPA -  DBK OF PA RECORD
                                        38  *              BUFFER ADDRESS OF PA RECORD
                                        39  *              RECORD ADDRESS
                                        40  *              RC PTR
                                        41  *              RS PTR
                                        42  *              AC PTR
                                        43  *        (MUST BE LOCKED)
                                        44  *      PRSC -  SC PTR FOR PA SET
                                        45  *
                                        46  *  OUTPUT ARGUMENTS:
                                        47  *      ALL MEMBER RECORDS WHICH HAVE AN ENTRY IN THE
                                        48  *      PA RECORD ARE ACCESSED AND THE OWNER PA POINTER
                                        49  *      UPDATED
                                        50  *
                                        51  *  EXCEPTION: NONE
                                        52  *
   000000                               53  ZIG$DBACM NULL
   000000  X 000000 7000 00             54         DBSAV
   000001    000004 000000
   000002    7 00513 2231 00            55         LDX     X3,RVPA,,PR7
   000003    7 00520 2261 00            56         LDX     X6,PRSC,,PR7    SET X6 = SC FOR PA SET
   000004    7 00006 2271 13            57         LDX     X7,RCPTR,X3,PR7  SET X7 = RC FOR PA RECORD
   000005    7 00004 7251 13            58         LXL     X5,RSPTR,X3,PR7  SET X5 = RS PTR FOR PA REC IN PA SET
   000006    7 00002 4735 13            59         LDP     PR3,RADDR,X3,PR7  GET ADDRESS OF PA RECORD
                                        60  *  FIND OUT THE NUMBER OF ENTRIES IN THE PA REC
   000007    000 1 100 1005 00          61         MLR     (1),(1),,1         * MOVE
   000010    3 00001 0 0 0 0002         62         ADSC9   PACW,0,2,PR3         *  PA BITS AND NO. OF ENTRIES
   000011    7 00721 0 0 0 0002         63         ADSC9   UPACW,0,2,PR7        *   TO WORKSPACE
   000012    7 00721 2211 00            64         LDX     X1,UPACW,,PR7   GET NO. OF ENTRIES
   000013    017777 3610 03             65         ANX     X1,.NOENT,DU    ISOLATE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CORRECT PA POINTERS IN MEMBER RECORDS                      4    BMAP - B00     
   000014    7 00726 7411 00            66         STX     X1,NUMENT,,PR7  SAVE
                                        67  *  CALCULATE SIZE OF PTR GROUP ENTRY
   000015    6 00007 7211 15            68         LXL     X1,CSMPP,X5,PR6  GET PTR SIZE FROM EIS DESCRIP IN RS
   000016    007777 3610 03             69         ANX     X1,=O7777,DU    ISOLATE
   000017    000002 0210 03             70         ADLX    X1,=O2,DU       ADD 2 FOR TYPE FIELD
   000020    7 00724 7411 00            71         STX     X1,PTRESZ,,PR7  SAVE
   000021    6 77776 7211 17            72         LXL     X1,CSPES,X7,PR6  GET ENTRY SIZE
   000022    7 00725 7411 00            73         STX     X1,ESZ,,PR7     SAVE FOR COMPARES
   000023    000000 6210 00             74         EAX     X1,0            INIT ENTRY NUMBER
   000024    6 77776 2221 17            75         LDX     X2,CSPSB,X7,PR6  INIT ENTRY OFFSET = STARTING BYTE
                                        76  *  IF PA SET IS A LOCAL SET,CONVERT DBK OF OWNER PA REC TO A LOCAL
                                        77  *  POINTER
   000025    7 00000 2361 13            78         LDQ     DBKEY,X3,PR7    GET DBK OF OWNER PA
   000026    6 00000 7201 16            79         LXL     X0,DEF,X6,PR6   GET DEF BITS FROM SC
   000027    001000 3000 03             80         CANX    X0,.LG,DU       IS IT A GLOBAL SET
   000030 (0)000033 6010 00             81         TNZ     HPTR            YES-DONT NEED TO ADJUST
   000031    7 00005 2201 13            82         LDX     X0,ACPTR,X3,PR7  GET AC PTR
   000032    6 00002 1361 10            83         SBLQ    ABAS,X0,PR6     ADJUST DBK OF PA REC TO LOCAL PTR
   000033                               84  HPTR   NULL
   000033    7 00731 7561 00            85         STQ     PAOPTR,,PR7     SAVE
   000034                               86  CMLP1  NULL
   000034    7 00726 1011 00            87         CMPX    X1,NUMENT,,PR7  ARE THE ENTRIES DONE
   000035 (0)000216 6030 00             88         TRC     CMRET           YES - RETURN
   000036    7 00513 2231 00            89         LDX     X3,RVPA,,PR7
   000037    7 00004 7251 13            90         LXL     X5,RSPTR,X3,PR7  GET RS PTR FOR PA REC
   000040    7 00002 4735 13            91         LDP     PR3,RADDR,X3,PR7  NO - RESET PR3 = ADDR OF PA REC
   000041    3 00000 5005 12            92         A9BD    ,X2,PR3         SET PR3 = ADDR OF NEXT ENTRY
   000042    000 1 100 1005 00          93         MLR     (1),(1),,1         * MOVE
   000043    3 00000 0 0 0 0002         94         ADSC9   0,0,2,PR3            *  TYPE FIELD AND INDIC FROM PA ENTRY
   000044    7 00727 4 0 0 0002         95         ADSC9   MEMTYP,2,2,PR7       *   TO WORKSPACE
   000045    000 1 100 1015 20          96         MRL     (1,,1),(1),,1      * MOVE
   000046    6 00007 0001 15            97         ARG     CSMPP,X5,PR6       *  POINTER FROM PA ENTRY
   000047    7 00730 0 0 0 0004         98         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   000050    7 00727 7201 00            99         LXL     X0,MEMTYP,,PR7  GET PTR INDICATOR FROM ENTRY
   000051 (0)000060 6040 00            100         TMI     PGRP            POINTER GROUP PRESENT
   000052    000000 6200 00            101         EAX     X0,0
   000053    7 00727 7401 00           102         STX     X0,NUMPTR,,PR7  SET NUMBER OF PTRS =0
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CORRECT PA POINTERS IN MEMBER RECORDS                      5    BMAP - B00     
   000054    7 00723 7401 00           103         STX     X0,CPTRN,,PR7   SET CURRENT PTR NUMBER =0
   000055    7 00722 7411 00           104         STX     X1,CENTRN,,PR7  SAVE CURRENT ENTRY NUMBER
   000056    7 00722 4421 00           105         SXL     X2,CENTRO,,PR7  SAVE CURRENT ENTRY OFFSET
   000057 (0)000110 7100 00            106         TRA     GMEMR           GO GET MEMBER RECORD
   000060                              107  PGRP   NULL
   000060    7 00730 7201 00           108         LXL     X0,MEMPTR,,PR7  GET OFST TO PTR GRP
   000061    7 00002 4735 13           109         LDP     PR3,RADDR,X3,PR7  RESET PR3 = ADDRESS OF PA REC
   000062    3 00000 5005 10           110         A9BD    ,X0,PR3         SET PR3 = ADDR OF PTR GROUP
   000063    000 1 100 1005 00         111         MLR     (1),(1),,1         * MOVE
   000064    3 00000 0 0 0 0002        112         ADSC9   0,0,2,PR3            *  NO. OF PTRS IN PTR GROUP
   000065    7 00727 0 0 0 0002        113         ADSC9   NUMPTR,0,2,PR7       *   TO WORKSPACE
   000066    7 00722 7411 00           114         STX     X1,CENTRN,,PR7  SAVE CURRENT ENTRY NUMBER
   000067    7 00722 4421 00           115         SXL     X2,CENTRO,,PR7  SAVE CURRENT ENTRY OFFSET
   000070    000000 6210 00            116         EAX     X1,0            INIT CURRENT PTR NUMBER
   000071    000002 6220 10            117         EAX     X2,2,X0         INIT CURRENT PTR OFST = 1ST PTR IN GROUP
   000072                              118  CMLP2  NULL
   000072    7 00727 1011 00           119         CMPX    X1,NUMPTR,,PR7  ARE ALL THE PTRS IN THE PTR GRP DONE
   000073 (0)000211 6030 00            120         TRC     GNENT           YES - GET NEXT ENTRY
   000074    7 00513 2231 00           121         LDX     X3,RVPA,,PR7
   000075    7 00002 4735 13           122         LDP     PR3,RADDR,X3,PR7  NO- RESET PR3 = ADDR OF PA REC
   000076    3 00000 5005 12           123         A9BD    ,X2,PR3         SET PR3 = ADDR OF NEXT ENTRY
   000077    000 1 100 1005 00         124         MLR     (1),(1),,1         * MOVE
   000100    3 00000 0 0 0 0002        125         ADSC9   0,0,2,PR3            *  TYPE FIELD OF MEM REC TO
   000101    7 00727 4 0 0 0002        126         ADSC9   MEMTYP,2,2,PR7       *   WORKSPACE
   000102    7 00004 7251 13           127         LXL     X5,RSPTR,X3,PR7  GET RS PTR FOR PA REC
   000103    000 1 100 1015 20         128         MRL     (1,,1),(1),,1      * MOVE
   000104    6 00007 0001 15           129         ARG     CSMPP,X5,PR6       *  MEMBER PTR FROM PA ENTRY
   000105    7 00730 0 0 0 0004        130         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   000106    7 00723 7411 00           131         STX     X1,CPTRN,,PR7   SAVE NUMBER OF CURRENT PTR IN GRP
   000107    7 00723 4421 00           132         SXL     X2,CPTRO,,PR7   SAVE OFFSET OF CURRENT PTR IN GRP
   000110                              133  GMEMR  NULL
                                       134  *  GET MEMBER RECORD AND UPDATE PA OWNER PTR
   000110    7 00730 2361 00           135         LDQ     MEMPTR,,PR7     GET MEMBER PTR
   000111 (0)000217 6000 00            136         TZE     PNER            ERROR- NULL PTR
                                       137  *  ADJUST PTR IF SET IS LOCAL
   000112    7 00520 2261 00           138         LDX     X6,PRSC,,PR7    GET SC PTR
   000113    6 00000 7211 16           139         LXL     X1,DEF,X6,PR6   GET DEF BITS FROM SC
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CORRECT PA POINTERS IN MEMBER RECORDS                      6    BMAP - B00     
   000114    001000 3010 03            140         CANX    X1,.LG,DU       IS IT A GLOBAL SET
   000115 (0)000120 6010 00            141         TNZ     GSETM           YES - DONT NEED TO ADJUST
   000116    7 00005 2201 13           142         LDX     X0,ACPTR,X3,PR7  GET AC PTR
   000117    6 00002 0361 10           143         ADLQ    ABAS,X0,PR6     MAKE PTR A GLOBAL DBK
   000120                              144  GSETM  NULL
   000120    7 00512 2221 00           145         LDX     X2,RVT,,PR7
   000121    7 00000 7561 12           146         STQ     DBKEY,X2,PR7
   000122  X 000000 7010 00            147         ICCAL   ZIQ$DBIOL,,PAGE1 GET THE RECORD
   000123 (0)000243 7020 00
   000124    5 00006 2341 00
   000125    777776 6010 04
   000126    7 00512 2221 00           148         LDX     X2,RVT,,PR7
   000127    5 00020 2351 00           149        LDA     GIOAWS,,PR5         AREA WORK SPACE POINTER
   000130    7 00013 7551 12           150        STA     AWS$,X2,PR7         SAVE IN REC VAR
   000131    7 00002 4535 12           151         STP     PR3,RADDR,X2,PR7  SAVE RECORD ADDRESS
   000132    7 00001 4545 12           152         STP     PR4,BADDR,X2,PR7  SAVE BUFFER ADDRESS
   000133    7 00005 7401 12           153         STX     X0,ACPTR,X2,PR7  SAVE AC PTR
                                       154  *  GET RECORD TYPE
   000134    000 1 100 1005 00         155         MLR     (1),(1),,1         * MOVE
   000135    3 00000 0 0 0 0004        156         ADSC9   ,,4,PR3              *  REC TYPE, SIZE TO
   000136    7 00632 0 0 0 0004        157         ADSC9   RSZTP,0,4,PR7        *   WORKSPACE
   000137    7 00632 2351 00           158         LDA     RSZTP,,PR7
   000140    000022 7750 00            159         ALR     18              INTO POSITION
   000141    7 00003 7551 12           160         STA     RTP,X2,PR7      SAVE IN REC VAR
                                       161  *  GET RS PTR
   000142    7 00520 2261 00           162         LDX     X6,PRSC,,PR7
   000143  X 000000 7010 00            163         ICCAL   ZIG$DBPR2,,MRSNF   FIND RS FOR MEMBER RECORD
   000144 (0)000241 7020 00
   000145    5 00006 2341 00
   000146    777776 6010 04
   000147    7 00512 2221 00           164         LDX     X2,RVT,,PR7
   000150    7 00006 7471 12           165         STX     X7,RCPTR,X2,PR7  SAVE RC PTR
   000151    7 00004 7461 12           166         STX     X6,SCPTR,X2,PR7  SAVE SC PTR
   000152    7 00004 4451 12           167         SXL     X5,RSPTR,X2,PR7  SAVE RS PTR
                                       168  *  CHECK IF RECORD TYPE MATCHES TYPE IN PA REC
   000153    7 00057 2361 00           169         LDQ     CTMASK,,PR7     LOAD TYPE MASK
   000154    7 00727 2111 00           170         CMK     MEMTYP,,PR7     ARE THE TYPES THE SAME
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CORRECT PA POINTERS IN MEMBER RECORDS                      7    BMAP - B00     
   000155 (0)000225 6010 00            171         TNZ     RTYPE           NO - ERROR
                                       172  *  CHECK RECORD SIZE
                                       173         IFE     E,1,%CKSZ
   000156    6 00003 2211 17           174         LDX     X1,RSIZ,X7,PR6  GET SIZE FROM RC
   000157    6 00000 2351 17           175         LDA     DEF,X7,PR6      GET DEFINITION
   000160    040000 3750 07            176         ANA     .FVR,DL         IS IT A VARIABLE RECORD
   000161 (0)000165 6000 00            177         TZE     *+4             NO
   000162    7 00003 1011 12           178         CMPX    X1,RECSZ,X2,PR7  IS MAX SIZE >= SIZE IN REC
   000163 (0)000233 6020 00            179         TNC     SZE1            NO - ERROR
   000164 (0)000167 7100 00            180         TRA     *+3
   000165    7 00003 1011 12           181         CMPX    X1,RECSZ,X2,PR7  IS IT EQUAL SIZE FROM REC
   000166 (0)000233 6010 00            182         TNZ     SZE2            NO - ERROR
                                       183  CKSZ   MARK
                                       184  *  IF THIS RECORD IS CURRENT OF THE PA SET,
                                       185  *  CHANGE THE PA OWNER POINTER AND OFFSET INFO
                                       186  *  IN THE SET CURRENCY WORKSPACE.
   000167    7 00000 2361 12           187         LDQ     DBKEY,X2,PR7    GET DBK OF THIS RECORD
   000170    6 00001 2211 16           188         LDX     X1,SCWSO,X6,PR6  GET WORKSPACE OFFSET OF SET
   000171    7 00001 1161 11           189         CMPQ    CURR,X1,PR7     IS THIS REC CURR OF SET
   000172 (0)000177 6010 00            190         TNZ     SMWS            NO - GO SET MUST WRITE SWITCH
   000173    7 00513 2231 00           191         LDX     X3,RVPA,,PR7    YES - CHANGE DBK OF PA OWNER IN SET WS
   000174    7 00000 2361 13           192         LDQ     DBKEY,X3,PR7    GET DBK OF OWNER PA
   000175    7 00003 7561 11           193         STQ     CBCPA,X1,PR7    SAVE DBK OF OWNER PA IN SET WS
   000176    7 00002 4501 11           194         STZ     CBENO,X1,PR7    ZERO OFST INFO
   000177                              195  SMWS   NULL                    SET MUST WRITE
                                       196  *  SET THE MUST WRITE SWITCH FOR THE MEMBER RECORD
   000177    7 00512 2231 00           197        LDX     X3,RVT,,PR7
   000200  X 000000 7010 00            198        DBCAL   ZIM$DBPMR,NOEXC,SMWER1   SET MUST WRITE THRU RVT
   000201 (0)000243 7020 00
                                       199  *  UPDATE THE PA OWNER PTR IN THE MEMBER RECORD
   000202  X 000000 7010 00            200        DBCAL   ZIM$JPASET,,NOALT  UPDATE AND JOURNAL IT
   000203    000000 0020 00
   000204                              201  GNPTR  NULL
   000204    7 00723 2211 00           202         LDX     X1,CPTRN,,PR7   GET CURRENT PTR NUMBER
   000205    000001 6210 11            203         EAX     X1,1,X1         INCREMENT TO GET NEXT
   000206    7 00723 7221 00           204         LXL     X2,CPTRO,,PR7   GET CURRENT PTR OFFSET
   000207    7 00724 0221 00           205         ADLX    X2,PTRESZ,,PR7  INCREMENT TO NEXT PTR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CORRECT PA POINTERS IN MEMBER RECORDS                      8    BMAP - B00     
   000210 (0)000072 7100 00            206         TRA     CMLP2           GO GET NEXT PTR
   000211                              207  GNENT  NULL
   000211    7 00722 2211 00           208         LDX     X1,CENTRN,,PR7  GET CURRENT ENTRY NUMBER
   000212    000001 6210 11            209         EAX     X1,1,X1         INCREMENT TO GET NEXT
   000213    7 00722 7221 00           210         LXL     X2,CENTRO,,PR7  GET CURRENT ENTRY OFFSET
   000214    7 00725 0221 00           211         ADLX    X2,ESZ,,PR7     INCR BY ENTRY SIZE TO GET OFST OF NEXT
   000215 (0)000034 7100 00            212         TRA     CMLP1           GO GET NEXT ENTRY
                                       213  *  NORMAL RETURN
   000216                              214  CMRET  NULL
   000216  X 000000 7020 00            215         DBRET                   NORMAL RETURN
                                       216  *
                                       217  *  ERRORS DETECTED IN THIS PRIMITIVE
                                       218  *
   000217                              219  PNER   NULL                    NULL PTR IN PA REC
   000217    303336 2350 07            220         LDA     PAER1,DL
   000220    000000 6200 00            221         EAX     X0,0            NULL SC
   000221    7 00513 2211 00           222         LDX     X1,RVPA,,PR7
   000222    7 00006 2271 11           223         LDX     X7,RCPTR,X1,PR7  GET RC PTR FOR PA REC
   000223    7 00520 2261 00           224         LDX     X6,PRSC,,PR7    GET SC PTR
   000224 (0)000245 7100 00            225         TRA     CMCER
   000225                              226  RTYPE  NULL                    REC TYPE OF MEMBER REC NOT SAME TYPE
                                       227  *                                AS IN PA RECORD
   000225    303340 2350 07            228         LDA     PAER3,DL
   000226    000000 6200 00            229         EAX     X0,0            NULL AC
   000227    7 00512 2211 00           230         LDX     X1,RVT,,PR7
   000230    7 00006 2271 11           231         LDX     X7,RCPTR,X1,PR7  GET RC FOR PA MEMBER
   000231    7 00520 2261 00           232         LDX     X6,PRSC,,PR7    GET SC FOR PA SET
   000232 (0)000245 7100 00            233         TRA     CMCER
   000233                              234  SZE1   NULL                    REC SIZE ERROR-VARIABLE LENGTH RECORD
   000233                              235  SZE2   NULL                    REC SIZE ERROR-FIXED LENGTH RECORD
   000233    210574 2350 07            236         LDA     RSZER,DL
   000234    7 00512 2211 00           237         LDX     X1,RVT,,PR7
   000235    7 00005 2201 11           238         LDX     X0,ACPTR,X1,PR7  GET AC PTR
   000236    7 00006 2271 11           239         LDX     X7,RCPTR,X1,PR7  GET RC PTR
   000237    000000 6260 00            240         EAX     X6,0            NULL SC
   000240 (0)000245 7100 00            241         TRA     CMCER
                                       242  *
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CORRECT PA POINTERS IN MEMBER RECORDS                      9    BMAP - B00     
                                       243  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                       244  *
   000241                              245  MRSNF  NULL                    ERROR FINDING RS PTR FOR MEM REC
   000241    000000 6200 00            246         EAX     X0,0            NULLIFY AC POINTER
   000242 (0)000245 7100 00            247         TRA     CMCER
                                       248  *
                                       249  *  ERRORS DETECTED IN I/O ROUTINES
                                       250  *
   000243                              251  PAGE1  NULL                    PAGE ERROR - FIND MEMBER REC
   000243                              252  SMWER1 NULL                    ERROR SETTING MW SWITCH
   000243    000000 6260 00            253         EAX     X6,0            NULL SC
   000244    000000 6270 00            254         EAX     X7,0            NULL RC
                                       255  *  COMMON ERROR RETURN
   000245                              256  CMCER  NULL
   000245  X 000000 7020 00            257         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       INSERT RECORD INTO PA SET                                  10   BMAP - B00     
                                       258         TTLS    INSERT RECORD INTO PA SET
                                       259  *
                                       260  *  THIS ROUTINE WILL STORE TWO OWNER POINTERS IN A
                                       261  *  RECORD WHICH IS A MEMBER OF A POINTER ARRAY SET.
                                       262  *  ONE OF THESE IS A POINTER TO THE OWNER OF THE
                                       263  *  POINTER ARRAY SET OCCURRENCE. THE OTHER IS A
                                       264  *  POINTER TO THE LOWEST LEVEL POINTER ARRAY RECORD
                                       265  *  WHICH CONTAINS THE POINTER ARRAY ENTRY FOR THE
                                       266  *  MEMBER RECORD.
                                       267  *
                                       268  *  INPUT ARGUMENTS:
                                       269  *      RVT -   DBK OF NEW REC
                                       270  *              RECORD ADDRESS
                                       271  *              BUFFER ADDRESS
                                       272  *              RC PTR
                                       273  *              RS PTR
                                       274  *              AC PTR
                                       275  *              DBK OF OWNER PA RECORD
                                       276  *              PA ENTRY OFFSET
                                       277  *              PA POINTER OFFSET
                                       278  *
                                       279  *      PRSC -  SC PTR FOR PA SET
                                       280  *
                                       281  *      PROPA - DBK OF OWNER OF SET
                                       282  *
                                       283  *  OUTPUT ARGUMENTS:
                                       284  *      OWNER PTR AND PA PTR UPDATED IN MEMBER RECORD
                                       285  *
                                       286  *  EXCEPTION: NONE
                                       287  *
   000246                              288  ZIG$DBAIS NULL
   000246  X 000000 7000 00            289         DBSAV
   000247    000004 000000
   000250    7 00512 2211 00           290         LDX     X1,RVT,,PR7
   000251    7 00015 2361 11           291         LDQ     CBRPA,X1,PR7    GET DBK OF OWNER PA
   000252    7 00731 7561 00           292         STQ     PAOPTR,,PR7     SAVE
   000253    7 00526 2361 00           293         LDQ     PROPA,,PR7      GET DBK OF OWNER OF SET
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       INSERT RECORD INTO PA SET                                  11   BMAP - B00     
   000254    7 00631 7561 00           294         STQ     PTR,,PR7        SAVE
                                       295  *  SET MUST WRITE SWITCH
   000255    7 00512 2231 00           296        LDX     X3,RVT,,PR7
   000256  X 000000 7010 00            297        DBCAL   ZIM$DBPMR,NOEXC,SMWER2   SET MUST WRITE
   000257 (0)000314 7020 00
                                       298  *  ADJUST PTRS IF SET IS LOCAL
   000260    7 00512 2211 00           299         LDX     X1,RVT,,PR7
   000261    7 00520 2261 00           300         LDX     X6,PRSC,,PR7    GET SC FOR PA SET
   000262    6 00000 7201 16           301         LXL     X0,DEF,X6,PR6
   000263    001000 3000 03            302         CANX    X0,.LG,DU       IS SET LOCAL
   000264 (0)000303 6010 00            303         TNZ     NOTLC           NO - DONT NEED TO ADJUST
   000265    7 00526 2361 00           304         LDQ     PROPA,,PR7      GET DBK OF OWNER
   000266  X 000000 7010 00            305         ICCAL   ZIQ$DBIOA,,FACE1   GET AC OF OWNER
   000267 (0)000314 7020 00
   000270    5 00006 2341 00
   000271    777776 6010 04
   000272    7 00512 2211 00           306         LDX     X1,RVT,,PR7     IS SET OCCURRENCE RESTRICTED
   000273    7 00005 1001 11           307         CMPX    X0,ACPTR,X1,PR7    TO SINGLE AREA
   000274 (0)000306 6010 00            308         TNZ     LPER1           NO - ERROR MUST BE IF HAVE LOCAL PTRS
   000275    7 00731 2361 00           309         LDQ     PAOPTR,,PR7     *
   000276    6 00002 1361 10           310         SBLQ    ABAS,X0,PR6     *  ADJUST DBK OF PA OWNER
   000277    7 00731 7561 00           311         STQ     PAOPTR,,PR7     *
   000300    7 00631 2361 00           312         LDQ     PTR,,PR7        *
   000301    6 00002 1361 10           313         SBLQ    ABAS,X0,PR6     *  ADJUST DBK OF OWNER OF SET
   000302    7 00631 7561 00           314         STQ     PTR,,PR7        *
   000303                              315  NOTLC  NULL
                                       316  *  PUT THE PA OWNER PTR IN MEMBER RECORD
   000303  X 000000 7010 00            317        DBCAL   ZIM$JPAMEM,,NOALT  UPDATE AND JOURNAL THEM
   000304    000000 0020 00
                                       318  *  NORMAL RETURN
   000305                              319  ISRET  NULL
   000305  X 000000 7020 00            320         DBRET
                                       321  *
                                       322  *  ERRORS DETECTED IN THIS PRIMITIVE
                                       323  *
   000306                              324  LPER1  NULL                    PTRS LOCAL & SET OCCUR NOT IN SINGLE AREA
   000306    020630 2350 07            325         LDA     SORSA,DL
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       INSERT RECORD INTO PA SET                                  12   BMAP - B00     
   000307    000000 6200 00            326         EAX     X0,0            NULL AC
   000310    7 00512 2211 00           327         LDX     X1,RVT,,PR7
   000311    7 00006 2271 11           328         LDX     X7,RCPTR,X1,PR7  GET RC PTR
   000312    7 00520 2261 00           329         LDX     X6,PRSC,,PR7    GET SC PTR
   000313 (0)000316 7100 00            330         TRA     ISCER
                                       331  *
                                       332  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                       333  *
                                       334  *
                                       335  *
                                       336  *
                                       337  *  ERRORS DETECTED IN I/O ROUTINES
                                       338  *
   000314                              339  SMWER2 NULL                    ERROR SETTING MUST WRITE
   000314                              340  FACE1  NULL                    ERROR FINDING AC DEF FOR OWNER
   000314    000000 6260 00            341         EAX     X6,0            NULL SC
   000315    000000 6270 00            342         EAX     X7,0            NULL RC
                                       343  *  COMMON ERROR RETURN
   000316                              344  ISCER  NULL
   000316  X 000000 7020 00            345         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       STORE ENTRY OCCURRENCE                                     13   BMAP - B00     
                                       346         TTLS    STORE ENTRY OCCURRENCE
                                       347  *
                                       348  *  THIS ROUTINE WILL CREATE A NEW ENTRY IN A POINTER
                                       349  *  ARRAY RECORD AT THE GIVEN OFFSET.
                                       350  *
                                       351  *  INPUT ARGUMENTS:
                                       352  *      RVT -   DBK OF MEMBER RECORD
                                       353  *              DBK OF PA OWNER
                                       354  *              PA ENTRY OFFSET OF WHERE ENTRY SHOULD GO
                                       355  *              RECORD TYPE
                                       356  *              AC PTR
                                       357  *
                                       358  *      RVPA -  DBK OF PA RECORD
                                       359  *              BUFFER ADDRESS
                                       360  *              RECORD ADDRESS
                                       361  *              RC PTR
                                       362  *              AC PTR
                                       363  *              RS PTR
                                       364  *
                                       365  *      PRSC -  SC PTR FOR PA SET
                                       366  *
                                       367  *      ALL PA FIELDS IN KEY PROCESS AREA
                                       368  *
                                       369  *  OUTPUT ARGUMENTS:
                                       370  *      ENTRY MADE IN POINTER ARRAY RECORD
                                       371  *
                                       372  *  EXCEPTION: NONE
                                       373  *
   000317                              374  ZIG$DBACO NULL
   000317  X 000000 7000 00            375         DBSAV
   000320    000004 000000
   000321    7 00513 2211 00           376         LDX     X1,RVPA,,PR7
   000322    7 00002 4735 11           377         LDP     PR3,RADDR,X1,PR7  GET ADDRESS OF PA REC
                                       378  *  MOVE POINTER ARRAY CONTROL WORD TO WORKSPACE
   000323    000 1 100 1005 00         379         MLR     (1),(1),,1         * MOVE
   000324    3 00001 0 0 0 0004        380         ADSC9   PACW,0,4,PR3         *  POINTER ARRAY CONTROL WORD
   000325    7 00714 0 0 0 0004        381         ADSC9   PARCW,0,4,PR7        *   TO WORKSPACE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       STORE ENTRY OCCURRENCE                                     14   BMAP - B00     
   000326    7 00006 2271 11           382         LDX     X7,RCPTR,X1,PR7  GET RC PTR FOR PA REC
   000327    7 00520 2261 00           383         LDX     X6,PRSC,,PR7    GET SC PTR FOR PA SET
   000330    6 77776 2351 17           384         LDA     CSPES,X7,PR6    GET ENTRY SIZE
   000331    777777 3750 07            385         ANA     -1,DL           ISOLATE
   000332    7 00717 7551 00           386         STA     ENTSZ,,PR7      SAVE
                                       387  *  IF POINTERS ARE LOCAL CONVERT MEMBER DBK TO A LOCAL POINTER
   000333    7 00512 2221 00           388         LDX     X2,RVT,,PR7
   000334    7 00000 2361 12           389         LDQ     DBKEY,X2,PR7    GET DBK OF MEMBER RECORD
   000335    6 00000 7201 16           390         LXL     X0,DEF,X6,PR6   GET DEF BITS FROM SC
   000336    001000 3000 03            391         CANX    X0,.LG,DU       IS IT A GLOBAL SET
   000337 (0)000342 6010 00            392         TNZ     DAP             YES - DONT ADJUST PTR
   000340    7 00005 2201 12           393         LDX     X0,ACPTR,X2,PR7  NO - GET AC PTR
   000341    6 00002 1361 10           394         SBLQ    ABAS,X0,PR6     MAKE MEMBER DBK A LOCAL PTR
                                       395  *  SAVE RECORD TYPE FOR MOVE
   000342                              396  DAP    NULL
   000342    7 00730 7561 00           397         STQ     MEMPTR,,PR7     SAVE
   000343    7 00003 2361 12           398         LDQ     RTP,X2,PR7      GET RECORD TYPE
   000344    7 00056 3761 00           399         ANQ     TMASK,,PR7      ISOLATE
   000345    7 00727 5521 14           400         STBQ    MEMTYP,14,PR7   SAVE
                                       401  *  UPDATE NO. OF ENTRIES AND SPACE AVAILABLE IN POINTER ARRAY CONTROL
                                       402  *  WORD
   000346    7 00714 2361 00           403         LDQ     PARCW,,PR7      GET NO OF ENTRIES
   000347    000001 6200 02            404         EAX     X0,1,QU         INCREMENT BY 1
   000350    7 00714 7401 00           405         STX     X0,PARCW,,PR7   SAVE IN PA CW WORKSPACE
   000351    7 00714 2351 00           406         LDA     PARCW,,PR7      GET SPACE AVAILABLE
   000352    777777 3750 07            407         ANA     -1,DL           ISOLATE
   000353    7 00717 1351 00           408         SBLA    ENTSZ,,PR7      DECREMENT BY ENTRY SIZE
   000354    7 00714 5511 14           409         STBA    PARCW,14,PR7    SAVE IN PA CW WORKSPACE
   000355    017777 3760 03            410         ANQ     .NOENT,DU       ISOLATE NO OF ENTRIES FOR MULTIPLY
   000356    000022 7720 00            411         QRL     18              PUT INTO QL FOR MULTIPLY
   000357    7 00717 4021 00           412         MPY     ENTSZ,,PR7      MULTIPLY NO. OF ENTRIES BY ENTRY SIZE
   000360    000000 6220 06            413         EAX     X2,,QL
   000361    7 00512 2351 00           414         LDA     RVT,,PR7
   000362    6 77776 0221 17           415         ADLX    X2,CSPSB,X7,PR6  ADD STARTING BYTE
   000363    7 00014 1221 01           416         SBLX    X2,CBRCE,AU,PR7  SUB NEW ENTRY OFST TO GET SIZE OF MOVE
   000364    7 00014 2361 01           417         LDQ     CBRCE,AU,PR7    QU = BEGINNING CHARACTER OF MOVE ("FROM")
   000365    7 00717 7201 00           418         LXL     X0,ENTSZ,,PR7
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       STORE ENTRY OCCURRENCE                                     15   BMAP - B00     
   000366    7 00014 0201 01           419         ADLX    X0,CBRCE,AU,PR7  X0 = OFST OF DESTINATION FOR MOVE ("TO")
                                       420  *  MOVE RECORD TYPE OF MEMBER RECORD TO KEY PROCESS AREA
   000367    7 00010 4735 00           421         LDP     PR3,KEYPA,,PR7  SET PR3 = ADDRESS OF KEY PROCESS AREA
   000370    000 1 100 1005 00         422         MLR     (1),(1),,1         * MOVE
   000371    7 00727 4 0 0 0002        423         ADSC9   MEMTYP,2,2,PR7       *  RECORD TYPE OF MEMBER RECORD
   000372    3 00000 0 0 0 0002        424         ADSC9   0,0,2,PR3            *   TO KEY PROCESS
                                       425  *  MOVE MEMBER PTR TO KEY PROCESS AREA
   000373    7 00004 7251 11           426         LXL     X5,RSPTR,X1,PR7  GET RS PTR FOR PA REC
   000374    000 0 120 1015 00         427         MRL     (1),(1,,1),,0      * MOVE
   000375    7 00730 0 0 0 0004        428         ADSC9   MEMPTR,0,4,PR7       *  MEMBER PTR TO
   000376    6 00007 0001 15           429         ARG     CSMPP,X5,PR6       *   KEY PROCESS
                                       430  *  THE RECORD TYPE OF THE MEMBER, THE PTR TO THE MEMBER RECORD
                                       431  *  AND THE PA KEY ARE IN THE KEY PROCESS AREA. NOW ONLY NEED
                                       432  *  TO MAKE ROOM FOR THE NEW ENTRY IN THE PA RECORD AND THEN MOVE
                                       433  *  THE PA ENTRY FROM THE KEY PROCESS AREA TO THE PA RECORD. IF
                                       434  *  MAKE ROOM IN PA RECORD FOR NEW ENTRY
   000377    7 00002 4735 11           435         LDP     PR3,RADDR,X1,PR7  RESET PR3 = ADDRESS OF PA RECORD
   000400    000 1 150 1015 42         436         MRL     (1,1,,QU),(1,1,,0),,1  * MOVE
   000401    3 00000 0 0 0 0012        437         ADSC9   0,0,X2,PR3               *  ENTRIES FROM ENTRY OFST OF NEW
   000402    3 00000 0 0 0 0012        438         ADSC9   0,0,X2,PR3               *   TO ENTRY OFST + ENTRY SIZE
                                       439  *  MOVE NEW PA ENTRY FROM KEY PROCESS AREA TO PA RECORD
   000403    7 00717 7221 00           440         LXL     X2,ENTSZ,,PR7   SET SIZE OF MOVE = ENTRY SIZE
   000404    7 00010 4745 00           441         LDP     PR4,KEYPA,,PR7  SET PR4 = ADDRESS OF KEY PROCESS AREA
   000405    000 1 142 1005 40         442         MLR     (1,1),(1,1,,QU),,1  * MOVE
   000406    4 00000 0 0 0 0012        443         ADSC9   0,0,X2,PR4           *  NEW ENTRY FROM KEY PROCESS AREA
   000407    3 00000 0 0 0 0012        444         ADSC9   0,0,X2,PR3           *   TO PA RECORD
                                       445  *  MOVE PA CONTROL WORD FROM WORKSPACE TO BUFFER
   000410    000 1 100 1005 00         446         MLR     (1),(1),,1         * MOVE
   000411    7 00714 0 0 0 0004        447         ADSC9   PARCW,0,4,PR7        *  PA CONTROL WORD
   000412    3 00001 0 0 0 0004        448         ADSC9   PACW,0,4,PR3         *   TO PA RECORD
                                       449  *  NORMAL RETURN
   000413                              450  CORET  NULL
   000413  X 000000 7020 00            451         DBRET
                                       452  *
                                       453  *  ERRORS DETECTED IN THIS PRIMITIVE
                                       454  *
                                       455  *
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       STORE ENTRY OCCURRENCE                                     16   BMAP - B00     
                                       456  *
                                       457  *
                                       458  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                       459  *
                                       460  *
                                       461  *
                                       462  *
                                       463  *  ERRORS DETECTED IN I/O ROUTINES
                                       464  *
   000414                              465  MFLE17 NULL                    ERROR PUTTING ENTRY IN MOD CI LIST
   000414                              466  MFLE18 NULL                    ERROR PUTTING ENTRY IN MOD CI LIST
   000414                              467  MFLE19 NULL                    ERROR PUTTING ENTRY IN MODIFY FIELD LIST
   000414                              468  MDFE10 NULL                    MODIFY CI ERROR
   000414    000000 6260 00            469         EAX     X6,0            NULL SC PTR
   000415    000000 6270 00            470         EAX     X7,0            NULL RC PTR
                                       471  *
                                       472  *
                                       473  *  COMMON ERROR RETURN
   000416                              474  COCER  NULL
   000416  X 000000 7020 00            475         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA RECORD                                           17   BMAP - B00     
                                       476         TTLS    CREATE PA RECORD
                                       477  *
                                       478  *  THIS ROUTINE WILL FIND SPACE FOR A NEW POINTER
                                       479  *  ARRAY RECORD AND CONNECT IT INTO THE PA CHAIN.
                                       480  *
                                       481  *  INPUT ARGUMENTS:
                                       482  *      RVI -   DBK OF RECORD WHICH WILL BE PRIOR TO NEW PA REC
                                       483  *              ADDRESS OF BUFFER OF PRIOR
                                       484  *              ADDRESS OF RECORD
                                       485  *              RECORD TYPE
                                       486  *
                                       487  *      PRSC -  SC PTR FOR PA SET
                                       488  *
                                       489  *      PRRC -  RC PTR FOR PA REC
                                       490  *
                                       491  *      RVPA -  BASE DBK FOR NEW PA RECORD
                                       492  *
                                       493  *  OUTPUT ARGUMENTS:
                                       494  *      RVPA -  DBK OF SPACE FOUND FOR PA REC
                                       495  *              BUFFER ADDRESS
                                       496  *              RECORD ADDRESS
                                       497  *
                                       498  *  EXCEPTION: NONE
                                       499  *
   000417                              500  ZIG$DBACR NULL
   000417  X 000000 7000 00            501         DBSAV
   000420    000004 000000
   000421    7 00517 2271 00           502         LDX     X7,PRRC,,PR7    GET RC FOR PA REC
   000422    7 00520 2261 00           503         LDX     X6,PRSC,,PR7    GET SC FOR PA SET
   000423    7 00513 2211 00           504         LDX     X1,RVPA,,PR7
   000424    6 00003 2351 17           505         LDA     RSIZ,X7,PR6     GET SIZE AND TYPE OF PA REC FROM RC
   000425    7 00055 3751 00           506         ANA     STMASK,,PR7     ISOLATE
   000426    7 00003 7551 11           507         STA     RECSZ,X1,PR7    SAVE IN RVPA
   000427    7 00510 2201 00           508         LDX     X0,RVI,,PR7
   000430    7 00005 2201 10           509         LDX     X0,ACPTR,X0,PR7  GET AC PTR OF PRIOR
   000431    7 00005 7401 11           510         STX     X0,ACPTR,X1,PR7  SAVE AS AC PTR OF NEW
   000432    7 00006 7471 11           511         STX     X7,RCPTR,X1,PR7  SAVE RC PTR IN REC VAR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA RECORD                                           18   BMAP - B00     
   000433    7 00004 7461 11           512         STX     X6,SCPTR,X1,PR7  SAVE SC PTR
   000434    6 00002 7251 17           513         LXL     X5,RCRSN,X7,PR6  GET RS PTR FOR PA REC
   000435    7 00004 4451 11           514         SXL     X5,RSPTR,X1,PR7  SAVE RS PTR
                                       515  *  FIND RA PTR FOR PA REC
   000436  X 000000 7010 00            516         ICCAL  ZIQ$DBPR3,,FRAE1         FIND RA
   000437 (0)000543 7020 00
   000440    5 00006 2341 00
   000441    777776 6010 04
   000442    7 00513 2211 00           517         LDX     X1,RVPA,,PR7
   000443    7 00005 4441 11           518         SXL     X4,RAPTR,X1,PR7  SAVE RA PTR IN REC VAR
   000444    7 00512 2371 00           519         LDAQ    RVT,,PR7        * REVERSE
   000445    7 00513 7551 00           520         STA     RVPA,,PR7       *  RVT AND RVPA
   000446    7 00512 7561 00           521         STQ     RVT,,PR7        *   RECORD VARIABLES
                                       522  *  LOCK BUFFER FOR PRIOR REC
   000447    7 00510 2231 00           523        LOCK    RVI
   000450  X 000000 7010 00
   000451    000000 0020 00
                                       524  *  FIND SPACE FOR NEW PA RECORD
   000452  X 000000 7010 00            525         DBCAL   ZIG$DBPFS,,FSER1   FIND SPACE
   000453 (0)000530 7020 00
   000454    5 00006 2341 00
   000455    777776 6010 04
   000456    7 00512 2231 00           526        LOCK    RVT
   000457  X 000000 7010 00
   000460    000000 0020 00
   000461    400000 2270 03            527         LDX     X7,.B0,DU       SET RC TO GET ANY REC
   000462    7 00517 7471 00           528         STX     X7,PRRC,,PR7
                                       529  *  FIND THE REC WHICH WILL GO AFTER THE NEW REC
   000463  X 000000 7010 00            530         DBCAL   ZIG$DBPFN,OWNF1,FNER1  FIND NEXT REC IN CHAIN
   000464 (0)000530 7020 00
   000465    5 00006 2341 00
   000466    000003 6000 04
   000467    5 00006 4501 00
   000470 (0)000471 7020 00
   000471                              531  OWNF1  NULL
   000471    7 00512 2231 00           532        LDX     X3,RVT,,PR7         * RVT HAS THE NEW PA REC
                                       533  *  SET UP RECORD CONTROL WORD FOR NEW PA RECORD
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA RECORD                                           19   BMAP - B00     
   000472    7 00006 2271 13           534        LDX     X7,RCPTR,X3,PR7     GET ITS RC PTR
   000473    7 00517 7471 00           535         STX     X7,PRRC,,PR7    SAVE
   000474    6 00003 2361 17           536         LDQ     RECSZ,X7,PR6    GET REC SIZE AND TYPE
   000475    7 00055 3761 00           537         ANQ     STMASK,,PR7     ISOLATE
   000476    000022 7760 00            538         QLR     18              TYPE TO UPPER, SIZE TO LOWER
   000477    7 00736 7561 00           539         STQ     RCW1,,PR7       SAVE IN WORKSPACE
                                       540  *  SET UP POINTER ARRAY RECORD CONTROL WORD FOR PA REC
   000500    7 00737 4501 00           541         STZ     RCW2,,PR7       SET NO. OF ENTRIES = 0
   000501    000000 6210 06            542         EAX     X1,,QL          SET SPACE AVAIL =
   000502    6 77776 1211 17           543         SBLX    X1,CSPSB,X7,PR6  REC SIZE - STARTING BYTE
   000503    7 00737 4411 00           544         SXL     X1,RCW2,,PR7    SAVE IN WORKSPACE
                                       545  *  MOVE RECORD CONTROL WORDS TO BUFFER.  IF TDS,
                                       546  *  NEED TO SET UP DESCRIPTORS FOR MOVE.
   000504    7 00002 4735 13           547        LDP     PR3,RADDR,X3,PR7    GET PA REC ADDR
   000505    000 1 100 1005 00         548         MLR     (1),(1),,1         * MOVE
   000506    7 00736 0 0 0 0010        549         ADSC9   RCW1,0,8,PR7         *  REC CONTROL WORDS TO
   000507    3 00000 0 0 0 0010        550         ADSC9   0,0,8,PR3            *   BUFFER
   000510  X 000000 7010 00            551        DBCAL   ZIM$JSTO,,NOALT        JOURNAL PA_REC STORED
   000511    000000 0020 00
                                       552  *  CONNECT RECORD INTO PA CHAIN
   000512  X 000000 7010 00            553         DBCAL  ZIM$PCON,,CNER1          CONNECT RECORD
   000513 (0)000530 7020 00
   000514    5 00006 2341 00
   000515    777776 6010 04
                                       554  *  UNLOCK BUFFER FOR PRIOR
   000516    7 00510 2231 00           555        UNLOCK  RVI                 UNLOCK PRIOR
   000517  X 000000 7010 00
   000520    000000 0020 00
   000521    7 00512 2231 00           556        UNLOCK  RVT                 UNLOCK NEW PA
   000522  X 000000 7010 00
   000523    000000 0020 00
   000524    7 00512 2371 00           557        LDAQ    RVT,,PR7            * REVERSE
   000525    7 00513 7551 00           558        STA     RVPA,,PR7           *  RVT AND RVPA
   000526    7 00512 7561 00           559        STQ     RVT,,PR7            *  RECORD VARIBALES
   000527                              560  CRRET  NULL
                                       561  *  NORMAL RETURN
   000527  X 000000 7020 00            562         DBRET
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA RECORD                                           20   BMAP - B00     
                                       563  *
                                       564  *  ERRORS DETECTED BY THIS PRIMITIVE
                                       565  *
                                       566  *
                                       567  *
                                       568  *
                                       569  *  ERRORS DETECTED BY SUBORDINATE PRIMITIVES
                                       570  *      (WHILE INPUT BUFFER IS LOCKED)
                                       571  *
   000530                              572  FSER1  NULL                    ERROR FINDING SPACE FOR PA REC
   000530                              573  FNER1  NULL                    ERROR FINDING NEXT IN PA CHAIN
   000530                              574  CNER1  NULL                    ERROR CONNECTING REC INTO PA CHAIN
   000530    7 00644 7551 00           575         STA     PRSTS,,PR7      SAVE STATUS
   000531    7 00510 2231 00           576        UNLOCK  RVI
   000532  X 000000 7010 00
   000533    000000 0020 00
   000534    7 00512 2231 00           577        UNLOCK  RVT,IFLOCKED
   000535    7 00007 2241 13
   000536 (0)000541 6000 00
   000537  X 000000 7010 00
   000540    000000 0020 00
   000541    7 00644 2351 00           578         LDA     PRSTS,,PR7      GET STATUS
   000542                              579  ULKRE4 NULL
   000542 (0)000546 7100 00            580         TRA     CRCER
                                       581  *
                                       582  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                       583  *    (WHILE BUFFER IS UNLOCKED)
                                       584  *
   000543                              585  FRAE1  NULL                    ERROR FINDING RA PTR FOR PA REC
   000543 (0)000546 7100 00            586         TRA     CRCER
                                       587  *
                                       588  *  ERRORS DETECTED IN I/O ROUTINES
                                       589  *
   000544                              590  LKRE3  NULL                    ERROR LOCKING PRIOR REC
   000544                              591  ULKRE3 NULL                    ERROR UNLOCKING PRIOR REC
   000544    000000 6260 00            592         EAX     X6,0            NULL SC PTR
   000545    000000 6270 00            593         EAX     X7,0            NULL RC PTR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA RECORD                                           21   BMAP - B00     
                                       594  *
                                       595  *
                                       596  *  COMMON ERROR RETURN
   000546                              597  CRCER  NULL
   000546  X 000000 7020 00            598         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            22   BMAP - B00     
                                       599         TTLS    CREATE PA ENTRY
                                       600  *
                                       601  *  THIS ROUTINE WILL STORE AN ENTRY OF A POINTER ARRAY
                                       602  *  MEMBER RECORD IN A POINTER ARRAY RECORD. IF THE PA
                                       603  *  KEY VALUE IS UNIQUE, THE PA KEY, THE MEMBER RECORD
                                       604  *  TYPE AND A POINTER TO THE MEMBER WILL BE STORED IN
                                       605  *  THE PA RECORD. IF THE KEY VALUE IS NOT UNIQUE, ONLY
                                       606  *  THE MEMBER RECORD TYPE AND A POINTER TO THE MEMBER
                                       607  *  WILL BE STORED IN THE PA RECORD. IF THE KEY VALUE
                                       608  *  IS UNIQUE OR IF THE KEY VALUE IS A DUPLICATE OF THE
                                       609  *  PRIOR, THE ROUTINE WILL ATTEMPT TO STORE THE NEW
                                       610  *  ENTRY IN THE OWNER PA RECORD OF THE PRIOR. IF THE
                                       611  *  KEY VALUE IS A DUPLICATE OF THE NEXT, THE OWNER PA
                                       612  *  OF THE NEXT WILL BE USED. IF THERE IS INSUFFICIENT
                                       613  *  SPACE IN THE IDENTIFIED PA RECORD, A NEW PA RECORD
                                       614  *  WILL BE CREATED WITH APPROXIMATELY HALF OF THE ENTRIES
                                       615  *  BEING MOVED FROM THE OLD PA RECORD TO THE NEW.
                                       616  *
                                       617  *  INPUT ARGUMENTS:
                                       618  *      RVI -   DBK OF PRIOR REC
                                       619  *              DBK OF OWNER PA REC OF PRIOR(IF PRIOR OF SET IS A MEMB.)
                                       620  *              PA ENTRY OFFSET OF PRIOR
                                       621  *              PA POINTER OFFSET OF PRIOR
                                       622  *
                                       623  *      RVT -   DBK OF NEW RECORD
                                       624  *              RECORD ADDRESS
                                       625  *              BUFFER ADDRESS
                                       626  *              RS FOR RECORD IN SET
                                       627  *              AC PTR
                                       628  *              RC PTR
                                       629  *         (MUST BE LOCKED)
                                       630  *
                                       631  *      PRSC -  SC PTR FOR PA SET
                                       632  *
                                       633  *      PROPA - DBK OF OWNER RECORD OF THE SET
                                       634  *
                                       635  *      PADUP - PA KEY DUPLICATE INDICATOR:
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            23   BMAP - B00     
                                       636  *                   0 = PA KEY VALUE OF NEW IS UNIQUE
                                       637  *                 NEG = PA KEY VALUE OF NEW IS A DUPLICATE OF THE
                                       638  *                            PRIOR OF THE SET
                                       639  *                 POS = PA KEY VALUE OF NEW IS A DUPLICATE OF NEXT
                                       640  *                            AND NOT A DUPLICATE OF THE PRIOR
                                       641  *
                                       642  *      PA KEY OF NEW IS IN KEY PROCESS AREA.
                                       643  *
                                       644  *
                                       645  *  OUTPUT ARGUMENTS:
                                       646  *      RVT -   DBK OF NEW RECORD
                                       647  *              RECORD ADDRESS
                                       648  *              BUFFER ADDRESS
                                       649  *              RS FOR RECORD IN SET
                                       650  *              AC PTR
                                       651  *              RC PTR
                                       652  *              DBK OF PA OWNER
                                       653  *              PA ENTRY OFFSET
                                       654  *              PA POINTER OFFSET
                                       655  *
                                       656  *      ENTRY STORED IN PA RECORD
                                       657  *      RVO & RVPA USED
                                       658  *  EXCEPTION: NONE
                                       659  *
                                       660  *
                                       661  *
                                       662  *  THIS IS THE POINTER ARRAY STACK.  IT HOLDS
                                       663  *  INFORMATION ABOUT PA RECORD SPLITS.  EACH
                                       664  *  ENTRY IS 4 WORDS.  THE FORMAT IS:
                                       665  *
                                       666  *    WORD 0 - DBK OF NEW PA RECORD
                                       667  *         1 - DBK OF PRIOR PA RECORD
                                       668  *         2 - DBK OF PA OWNER OF PRIOR
                                       669  *         3 - PA ENTRY AND POINTER OFFSETS OF PRIOR
                                       670  *
                                       671  *  ENTRIES IN THIS PA STACK ARE NEW PA RECORDS
                                       672  *  CREATED DURING A SPLIT.  THEY NEED TO HAVE ENTRIES
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            24   BMAP - B00     
                                       673  *  CREATED FOR THEM IN THE HIGHER LEVEL PA RECORDS.
                                       674  *
                                       675  *  ***** NOTE *****
                                       676  *    THE PA STACK IS USING A TEMPORARY LOCATION WHICH IS
                                       677  *    THE SCHEMA FILE WORK SPACE (SFWS) SINCE THIS WAS
                                       678  *    ADDED TOO LATE TO EXTEND THE DBCB TO INCLUDE ANOTHER
                                       679  *    STACK.  IF THE DBCB IS EXTENDED IN A FUTURE RELEASE,
                                       680  *    A SEPARATE STACK SHOULD BE CREATED FOR THIS PA INFO.
                                       681  *    SINCE THE SFWS IS ONLY 8 WORDS, AT THIS TIME ONLY 2
                                       682  *    ENTRIES MAY BE STORED IN THE STACK.  THIS , HOWEVER, IS
                                       683  *    MOST LIKELY SUFFICIENT.
             000000001225              684  PASTK  EQU     SFWS
             000000000010              685  PASTSZ EQU     8               SIZE OF PA STACK
             000000000004              686  PAMVSZ EQU     PASTSZ-4        SIZE OF MOVE TO UPDATE PA STACK
   000547                              687  ZIG$DBACE NULL
   000547  X 000000 7000 00            688         DBSAV
   000550    000004 000000
   000551    7 00512 2211 00           689         LDX     X1,RVT,,PR7
   000552    7 00000 2351 11           690         LDA     DBKEY,X1,PR7    GET DBK OF NEW
   000553    7 00003 2361 11           691         LDQ     RTP,X1,PR7      GET REC TYPE OF  NEW
   000554    7 00704 7571 00           692         STAQ    KCREG+4,,PR7    SAVE IN TEMP LOCATION
   000555    7 00006 2351 11           693         LDA     RCPTR,X1,PR7    GET RC PTR FOR NEW
   000556    7 00004 2361 11           694         LDQ     SCPTR,X1,PR7    GET SC & RS PTRS OF NEW
   000557    7 00706 7571 00           695         STAQ    KCREG+6,,PR7    SAVE IN TEMP LOCATION
   000560    000000 6200 00            696         EAX     X0,0
   000561    7 00724 4401 00           697         SXL     X0,PASPLT,,PR7  INIT INDIC = NO PA REC SPLIT
   000562                              698  ZIG$DBCLP NULL                    LOOP
                                       699  *  LOCK THE CURR RECORD
   000562    7 00512 2231 00           700        LOCK    RVT
   000563  X 000000 7010 00
   000564    000000 0020 00
                                       701  *  IF CURR IS A DUPLICATE OF NEXT, FIND THE NEXT RECORD
                                       702  *  IN THE PA SET
   000565    7 00740 7211 00           703         LXL     X1,PADUP,,PR7   IS CURR A DUP OF NEXT
   000566 (0)000633 6044 00            704         TMOZ    SINFO           NO - GO SAVE INFO ON RECS
   000567    7 00510 2211 00           705         LDX     X1,RVI,,PR7     REC VAR FOR PRIOR
   000570    7 00520 2261 00           706         LDX     X6,PRSC,,PR7    GET SC PTR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            25   BMAP - B00     
   000571    7 00003 2351 11           707         LDA     RTP,X1,PR7      GET REC TYPE OF PRIOR
   000572  X 000000 7010 00            708         ICCAL   ZIG$DBPR2,,FRCE1   GET RC & RS PTRS FOR PRIOR
   000573 (0)001505 7020 00
   000574    5 00006 2341 00
   000575    777776 6010 04
   000576    7 00510 2211 00           709         LDX     X1,RVI,,PR7
   000577    7 00006 7471 11           710         STX     X7,RCPTR,X1,PR7  SAVE RC PTR
   000600    7 00004 7461 11           711         STX     X6,SCPTR,X1,PR7  SAVE SC PTR
   000601    7 00004 4451 11           712         SXL     X5,RSPTR,X1,PR7  SAVE RS PTR
                                       713  *   If the first level is empty, RVI should contain
                                       714  *   the DBK of PA owner.  Due to asumptions being made
                                       715  *   earlier the record and buffer addresses are in a
                                       716  *   state inconsistant with the DBK (in the RVI).  Refresh
                                       717  *   the owner and udpate the relevant fields.
   000602    7 00740 7211 00           718      LXL  X1,PADUP,,PR7
   000603    000002 1010 03            719      CMPX X1,2,DU             Check ind if first in
   000604 (0)000624 6010 00            720      TNZ FNXT                 No so get out
   000605    6 00000 2211 15           721      LDX X1,DEF,X5,PR6        Check is PA set owner
   000606    010000 3010 03            722      CANX X1,.SO,DU
   000607 (0)000624 6000 00            723      TZE FNXT
   000610    7 00510 2211 00           724      LDX X1,RVI,,PR7          Get DB key currently in RVI
   000611    7 00000 2361 11           725      LDQ DBKEY,X1,PR7
   000612  X 000000 7010 00            726      ICCAL ZIQ$DBIOL,FOER1,FOER1
   000613 (0)002313 7020 00
   000614    5 00006 2341 00
   000615    000003 6000 04
   000616    5 00006 4501 00
   000617 (0)002313 7020 00
   000620    7 00510 2211 00           727      LDX X1,RVI,,PR7          we can bring DB key
   000621    7 00002 4735 11           728      LDP PR3,RADDR,X1,PR7     and record address
   000622    7 00001 4745 11           729      LDP PR4,BADDR,X1,PR7     and buffer address
   000623    7 00005 7401 11           730      STX X0,ACPTR,X1,PR7      back in synch
   000624                              731  FNXT NULL
   000624  X 000000 7010 00            732         DBCAL   ZIG$DBAFN,,FNPAE   FIND NEXT IN PA SET
   000625 (0)001506 7020 00
   000626    5 00006 2341 00
   000627    777776 6010 04
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            26   BMAP - B00     
   000630    7 00510 2371 00           733         LDAQ    RVI,,PR7        * REVERSE
   000631    7 00511 7551 00           734         STA     RVO,,PR7        *  INPUT AND OUTPUT
   000632    7 00510 7561 00           735         STQ     RVI,,PR7        *   RECORD VARIABLES
   000633                              736  SINFO  NULL
                                       737  *  SAVE INFO ON CURRENT AND PRIOR RECORDS IN SET.
                                       738  *  THERE ARE NOT ENOUGH RECORD VARIABLES TO KEEP
                                       739  *  TRACK OF ALL RECORDS WHEN A POINTER ARRAY RECORD
                                       740  *  MUST BE SPLIT.  IF A POINTER ARRAY RECORD MUST
                                       741  *  BE SPLIT, THIS INFO WILL BE USED TO RE-RETRIEVE
                                       742  *  THE CURRENT AND PRIOR RECORDS.
   000633    7 00510 2211 00           743         LDX     X1,RVI,,PR7     REC VARIABLE FOR PRIOR
   000634    7 00000 2351 11           744         LDA     DBKEY,X1,PR7    GET DBK OF PRIOR
   000635    7 00700 7551 00           745         STA     KCREG,,PR7      SAVE IN TEMP LOCATION
   000636    7 00015 2351 11           746         LDA     CBRPA,X1,PR7    GET DBK OF PA OWNER
   000637    7 00512 2211 00           747         LDX     X1,RVT,,PR7     REC VARIABLE FOR CURRENT
   000640    7 00000 2361 11           748         LDQ     DBKEY,X1,PR7    GET DBK OF CURRENT
   000641    7 00702 7571 00           749         STAQ    KCREG+2,,PR7    SAVE IN TEMP LOCATION
   000642    7 00510 2211 00           750         LDX     X1,RVI,,PR7     REC VARIABLE FOR PRIOR
   000643    7 00520 2261 00           751         LDX     X6,PRSC,,PR7    GET SC
   000644    7 00003 2351 11           752         LDA     RTP,X1,PR7      GET REC TYPE
   000645  X 000000 7010 00            753         ICCAL   ZIG$DBPR2,,FRCE2   GET RC & RS PTRS
   000646 (0)001505 7020 00
   000647    5 00006 2341 00
   000650    777776 6010 04
   000651    7 00510 2211 00           754         LDX     X1,RVI,,PR7
   000652    7 00006 7471 11           755         STX     X7,RCPTR,X1,PR7  SAVE RC PTR
   000653    7 00004 7461 11           756         STX     X6,SCPTR,X1,PR7  SAVE SC PTR
   000654    7 00004 4451 11           757         SXL     X5,RSPTR,X1,PR7  SAVE RS PTR
                                       758  *  FIND RS AND RC FOR PA RECORD
   000655                              759  FRS    NULL
   000655    000000 6250 16            760         EAX     X5,,X6
   000656                              761  FRCLP  NULL
   000656    6 00002 2251 15           762         LDX     X5,SCRSN,X5,PR6  GET NEXT RS
   000657 (0)001470 6000 00            763         TZE     NRCE1           NO-DONE-RC FOR PA NOT FOUND
   000660    6 00000 2201 15           764         LDX     X0,DEF,X5,PR6   GET MEMBER TYPE
   000661    000007 3600 03            765         ANX     X0,.MEMT,DU     ISOLATE
   000662    000002 1000 03            766         CMPX    X0,=O2,DU       IS IT AN RS FOR A PA REC
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            27   BMAP - B00     
   000663 (0)000656 6010 00            767         TNZ     FRCLP           NO - GET NEXT RS
   000664    6 00003 2271 15           768         LDX     X7,RCRSH,X5,PR6  YES - NOW GET RC PTR FOR PA REC
   000665    7 00517 7471 00           769         STX     X7,PRRC,,PR7    SAVE RC FOR LATER CALLS
                                       770  *  CHECK DUPLICATE INDICATOR
   000666                              771  CDI    NULL
   000666    7 00740 7201 00           772         LXL     X0,PADUP,,PR7   GET DUPLICATE INDICATOR
   000667 (0)000724 6010 00            773         TNZ     NOWN            IT IS A DUPLICATE
   000670                              774  UODOP  NULL
   000670    7 00004 7251 11           775         LXL     X5,RSPTR,X1,PR7  GET RS FOR PRIOR
   000671    6 00000 2201 15           776         LDX     X0,DEF,X5,PR6
   000672    010000 3000 03            777         CANX    X0,.SO,DU       IS IT A SET OWNER RS
   000673 (0)000724 6000 00            778         TZE     NOWN            NO
                                       779  *  PRIOR OF SET IS SET OWNER
   000674    7 00002 4735 11           780         LDP     PR3,RADDR,X1,PR7  SET PR3 = ADDRESS OF OWNER REC
   000675    000 1 100 1015 20         781         MRL     (1,,1),(1),,1      * MOVE
   000676    6 00004 0001 15           782         ARG     NPOS,X5,PR6        *  OWNERS NEXT PTR TO
   000677    7 00631 0 0 0 0004        783         ADSC9   PTR,0,4,PR7          *   WORKSPACE
   000700    7 00631 2361 00           784         LDQ     PTR,,PR7        GET PTR
                                       785  *  IF SET IS LOCAL, ADJUST NEXT PTR
   000701    6 00000 7201 16           786         LXL     X0,DEF,X6,PR6   GET DEF BITS FROM SC
   000702    001000 3000 03            787         CANX    X0,.LG,DU       IS IT A GLOBAL SET
   000703 (0)000706 6010 00            788         TNZ     CISE            YES - DONT NEED TO ADJUST
   000704    7 00005 2201 11           789         LDX     X0,ACPTR,X1,PR7  GET AC PTR
   000705    6 00002 0361 10           790         ADLQ    ABAS,X0,PR6     MAKE LOCAL PTR A GLOBAL DBK
   000706                              791  CISE   NULL
   000706    7 00000 1161 11           792         CMPQ    DBKEY,X1,PR7    IS THE SET EMPTY(NEXT PTR = OWNER PTR)
   000707 (0)000724 6010 00            793         TNZ     NOWN            NO
                                       794  *  SET IS EMPTY. THIS IS THE FIRST ENTRY TO BE STORED IN THE PA
                                       795  *  SET. NEED TO CREATE A PA RECORD AND INSERT A DUMMY PA ENTRY
                                       796  *  AS THE FIRST ENTRY IN THE SET.
   000710    7 00000 2361 11           797         LDQ     DBKEY,X1,PR7    GET DBK OF OWNER OF SET
   000711    7 00513 2201 00           798         LDX     X0,RVPA,,PR7
   000712    7 00000 7561 10           799         STQ     DBKEY,X0,PR7    SAVE AS BASE DBK FOR NEW PA REC
                                       800  *  CREATE NEW PA RECORD
   000713 (0)000417 7010 00            801         DBCAL   ZIG$DBACR,,CPAE1   CREATE PA RECORD
   000714 (0)001506 7020 00
   000715    5 00006 2341 00
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            28   BMAP - B00     
   000716    777776 6010 04
   000717 (0)003057 7010 00            802         DBCAL   ZIG$DBAID,,IDER1   INSERT DUMMY PA ENTRY
   000720 (0)001506 7020 00
   000721    5 00006 2341 00
   000722    777776 6010 04
   000723 (0)000762 7100 00            803        TRA     BYPS
   000724                              804  NOWN   NULL
                                       805  *  ENTRY IS NOT THE FIRST ENTRY TO BE STORED IN PA SET.  IT
                                       806  *  IS EITHER A UNIQUE KEY OR IS A DUP OF THE PRIOR
   000724    7 00015 2361 11           807         LDQ     CBRPA,X1,PR7    GET DBK OF OWNER PA OF PRIOR
   000725    7 00513 2201 00           808         LDX     X0,RVPA,,PR7
   000726    7 00000 7561 10           809         STQ     DBKEY,X0,PR7
   000727    7 00510 2351 00           810         LDA     RVI,,PR7        *
   000730    7 00513 2361 00           811         LDQ     RVPA,,PR7       * REVERSE RVI & RVPA
   000731    7 00513 7551 00           812         STA     RVPA,,PR7       *  RECORD VARIABLES
   000732    7 00510 7561 00           813         STQ     RVI,,PR7        *
                                       814  *  FIND PA RECORD
   000733  X 000000 7010 00            815         DBCAL   ZIG$DBPFD,PANP,PGER4   FIND PA RECORD
   000734 (0)001506 7020 00
   000735    5 00006 2341 00
   000736    000003 6000 04
   000737    5 00006 4501 00
   000740 (0)001506 7020 00
   000741    7 00510 2351 00           816         LDA     RVI,,PR7        *
   000742    7 00513 2361 00           817         LDQ     RVPA,,PR7       * REVERSE RVI & RVPA
   000743    7 00513 7551 00           818         STA     RVPA,,PR7       *  RECORD VARIABLES
   000744    7 00510 7561 00           819         STQ     RVI,,PR7        *
                                       820  *  SAVE RC AND RS PTRS FOR PA REC IN PA REC VAR
   000745    7 00517 2271 00           821         LDX     X7,PRRC,,PR7    GET RC FOR PA REC
   000746    6 00002 7251 17           822         LXL     X5,RCRSN,X7,PR6  GET RS FOR PA REC
   000747    7 00006 7471 01           823         STX     X7,RCPTR,AU,PR7  SAVE RC PTR IN PA REC VAR
   000750    7 00004 4451 01           824         SXL     X5,RSPTR,AU,PR7  SAVE RS PTR IN PA REC VAR
                                       825  *  THIS PA IS FOR SURE TO BE UPDATED, SO SET MUST WRITE SWITCH
                                       826  *       AND JOURNALIZE ITS BEFORE IMAGE
   000751    7 00513 2231 00           827        LDX     X3,RVPA,,PR7
   000752  X 000000 7010 00            828        DBCAL   ZIM$DBPMR,NOEXC,SMWER6   SET MUST WRITE
   000753 (0)001506 7020 00
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            29   BMAP - B00     
   000754  X 000000 7010 00            829        DBCAL   ZIM$JBEFPA,,NOALT  JOURNAL THE BEFORE IMAGE
   000755    000000 0020 00
                                       830  *  VERIFY OFFSETS OF PRIOR
   000756  X 000000 7010 00            831        DBCAL   ZIG$DBAVO,,VOER1
   000757 (0)001506 7020 00
   000760    5 00006 2341 00
   000761    777776 6010 04
   000762                              832  BYPS  NULL
   000762    7 00513 2231 00           833        LOCK    RVPA                RVPA CONTAINS PRIOR
   000763  X 000000 7010 00
   000764    000000 0020 00
   000765    7 00510 2211 00           834         LDX     X1,RVI,,PR7
   000766    7 00015 2361 11           835         LDQ     CBRPA,X1,PR7    GET DBK OF PA REC OF PRIOR
   000767    7 00733 7561 00           836         STQ     PADBK,,PR7      SAVE
   000770    7 00014 2361 11           837         LDQ     CBRCE,X1,PR7    GET ENTRY & PTR OFFSET OF PRIOR
   000771    7 00734 5521 60           838         STBQ    PAEOF,60,PR7    SAVE ENTRY OFFSET
   000772    7 00734 5521 14           839         STBQ    PAPOF,14,PR7    SAVE POINTER OFFSET
                                       840  *  IF THE CURRENT RECORD IS A PA RECORD, NEED TO
                                       841  *  DETERMINE IF ITS LOW KEY VALUE IS A DUPLICATE OR IS
                                       842  *  UNIQUE.  THE LOW KEY VALUE IS IN THE KEY PROCESS AREA
                                       843  *  SO WILL COMPARE THE KEY PROCESS AREA WITH THE ENTRY FOR
                                       844  *  THE PRIOR PA RECORD.  IF IT IS A DUPLICATE, THE ROUTINE
                                       845  *  WILL SET THE PA DUPLICATE INDICATOR (PADUP) TO A
                                       846  *  NEGATIVE VALUE INDICATING THAT THE CURR IS A DUPLICATE OF
                                       847  *  THE PRIOR.
   000773    7 00512 2201 00           848         LDX     X0,RVT,,PR7     REC VAR FOR REC TO CREATE PA ENTRY FOR
   000774    7 00004 7251 10           849         LXL     X5,RSPTR,X0,PR7  GET RS PTR
   000775    6 00000 2221 15           850         LDX     X2,DEF,X5,PR6   GET MEMBER TYPE
   000776    000007 3620 03            851         ANX     X2,.MEMT,DU     ISOLATE
   000777    000002 1020 03            852         CMPX    X2,=O02,DU      IS IT A PA RECORD
   001000 (0)001030 6010 00            853         TNZ     CSNED           NO - GO CALCULATE SPACE NEEDED
                                       854  *
                                       855  *  REC TO CREATE PA ENTRY FOR IS A PA RECORD.
                                       856  *
                                       857  *    SET UP ADDRESS REGISTERS FOR CALL TO KEY COMPARE ROUTINE
   001001    7 00010 4745 00           858         LDP     PR4,KEYPA,,PR7  SET PR4 = ADDRESS OF KEY COMPARE
   001002    7 00513 2221 00           859         LDX     X2,RVPA,,PR7    REC VAR FOR OWNER PA RECORD
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            30   BMAP - B00     
   001003    7 00002 4735 12           860         LDP     PR3,RADDR,X2,PR7  GET ADDRESS OF OWNER PA REC
   001004    3 00000 5005 02           861         A9BD    ,QU,PR3         SET PR3 = ADDRESS OF PRIOR'S ENTRY IN PA
                                       862  *    CHECK IF LOW KEY VALUE FOR CURR PA RECORD IS A DUPLICATE.
   001005    7 00642 7451 00           863         STX     X5,PCD,,PR7     SAVE RS PTR FOR PA AS CURR CD
   001006                              864  CKVLP  NULL
   001006    7 00642 2201 00           865         LDX     X0,PCD,,PR7     GET CURR CD
   001007    6 00001 2201 10           866         LDX     X0,RSCDN,X0,PR6  GET NEXT CD
   001010 (0)001024 6000 00            867         TZE     STIND           NO-DONE-GO SET INDICATOR = DUP OF PRIOR
   001011    7 00642 7401 00           868         STX     X0,PCD,,PR7     SAVE AS CURR CD
   001012    6 00002 2241 10           869         LDX     X4,CDSH,X0,PR6  GET FR FOR THIS CD
   001013    7 00521 7441 00           870         STX     X4,PRFR,,PR7    SAVE AS FR FOR 1ST OPERAND
   001014    7 00521 4441 00           871         SXL     X4,PRFR2,,PR7   SAVE AS FR FOR 2ND OPERAND
   001015  X 000000 7010 00            872         DBCAL   ZIG$DBXCI,CKVLP,CKER1   COMPARE PA KEY
   001016 (0)001506 7020 00
   001017    5 00006 2341 00
   001020    000003 6000 04
   001021    5 00006 4501 00
   001022 (0)001006 7020 00
   001023 (0)001026 7100 00            873         TRA     CSN             PA KEY UNIQUE
   001024                              874  STIND  NULL
                                       875  *    PA KEY VALUE MATCHES KEY VALUE OF PRIOR PA RECORD.
                                       876  *    SET PA DUPLICATE INDICATOR TO NEGATIVE.
   001024    777777 6210 00            877         EAX     X1,-1
   001025    7 00740 4411 00           878         SXL     X1,PADUP,,PR7   SET PA DUPLICATE INDIC. = DUP OF PRIOR
   001026                              879  CSN    NULL
   001026    7 00510 2211 00           880         LDX     X1,RVI,,PR7     REC VAR FOR PRIOR/NEXT
   001027    7 00014 2361 11           881         LDQ     CBRCE,X1,PR7    GET ENTRY & PTR OFFSET OF PRIOR
                                       882  *  CALCULATE SPACE NEEDED FOR STORING NEW ENTRY
   001030                              883  CSNED  NULL
   001030    7 00701 7561 00           884         STQ     KCREG+1,,PR7    SAVE VERIFIED ENTRY AND PTR OFSTS
   001031    7 00513 2231 00           885      LDX X3,RVPA,,PR7
   001032    7 00002 4735 13           886      LDP PR3,RADDR,X3,PR7
   001033    001 0 100 1005 00         887      MLR (1),(1),1
   001034    3 00001 0 0 0 0004        888      ADSC9 PACW,0,4,PR3  get PA control word
   001035    7 00714 0 0 0 0004        889      ADSC9 PARCW,0,4,PR7
   001036    7 00714 2231 00           890      LDX X3,PARCW,,PR7
   001037 (0)001042 6050 00            891      TPL CSNED1
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            31   BMAP - B00     
   001040    7 00740 7201 00           892      LXL X0,PADUP,,PR7   get duplicate indicator
   001041 (0)001045 6010 00            893      TNZ ENUNQ
   001042                              894  CSNED1 NULL
                                       895  *  ENTRY UNIQUE - SET SPACE NEEDED = ENTRY SIZE
   001042    7 00517 2271 00           896         LDX     X7,PRRC,,PR7    GET RC FOR PA RECORD
   001043    6 77776 7201 17           897         LXL     X0,CSPES,X7,PR6  GET ENTRY SIZE
   001044 (0)001056 7100 00            898         TRA     GSPAV           GO GET SPACE AVAILABLE IN PA
                                       899  *  ENTRY IS NOT UNIQUE. IF A POINTER GROUP ALREADY EXISTS, THE
                                       900  *  SPACE NEEDED = 2+POINTER SIZE (2 = SIZE OF REC TYPE FIELD).
                                       901  *  IF A POINTER GROUP DOES NOT ALREADY EXIST, THE SPACE
                                       902  *  NEEDED = 2 + 2(2 + PTR SIZE).
   001045                              903  ENUNQ  NULL
   001045    7 00004 7251 11           904         LXL     X5,RSPTR,X1,PR7  GET RS TO CALCULATE SIZE OF PTRS
   001046    6 00004 2351 15           905         LDA     NPOS,X5,PR6     GET SIZE OF PTR
   001047    007777 3750 07            906         ANA     =O7777,DL       ISOLATE
   001050    000002 0350 07            907         ADLA    2,DL            ADD 2 FOR TYPE FIELD
   001051    7 00014 7201 11           908         LXL     X0,CBRCP,X1,PR7  IS THERE A PTR GROUP ALREADY
   001052 (0)001055 6010 00            909         TNZ     *+3             YES
   001053    000001 7350 00            910         ALS     1               NO - NEED TO CREATE 2 ENTRIES IN PTR GRP
   001054    000002 0350 07            911         ADLA    2,DL            ADD 2 FOR NO OF PTRS FIELD
   001055    000000 6200 05            912         EAX     X0,,AL
   001056                              913  GSPAV  NULL
   001056    7 00735 7401 00           914         STX     X0,SNPAE,,PR7   SAVE SPACE NEEDED
   001057                              915  GSPAV2 NULL
   001057    7 00513 2231 00           916         LDX     X3,RVPA,,PR7
   001060    7 00002 4735 13           917         LDP     PR3,RADDR,X3,PR7  SET PR3 = ADDRESS OF PA REC
                                       918  *  MOVE PA RECORD CONTROL WORD TO WORKSPACE TO FIND OUT HOW
                                       919  *  MUCH SPACE IS AVAILABLE IN PA REC.
   001061    000 1 100 1005 00         920         MLR     (1),(1),,1         * MOVE
   001062    3 00001 0 0 0 0004        921         ADSC9   PACW,0,4,PR3         *  POINTER ARRAY CONTROL WORD
   001063    7 00714 0 0 0 0004        922         ADSC9   PARCW,0,4,PR7        *   TO WORKSPACE
   001064                              923  CKSPC  NULL
   001064    7 00714 7201 00           924         LXL     X0,PARCW,,PR7   GET SPACE AVAILABLE
   001065    7 00735 1201 00           925         SBLX    X0,SNPAE,,PR7   IS THERE ENOUGH SPACE
   001066 (0)001244 6050 00            926         TPL     ISSPC           YES
                                       927  *  NOT ENOUGH SPACE AVAILABLE IN PA RECORD.  NEED TO CREATE
                                       928  *  A NEW POINTER ARRAY RECORD AND MOVE SOME OF THE ENTRIES FROM
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            32   BMAP - B00     
                                       929  *  THE OLD PA RECORD TO THE NEW PA RECORD.
                                       930  *
                                       931  *  GET THE DBK OF THE OWNER OF THE SET.  THIS WILL BE THE BASE
                                       932  *  DBK TO FIND SPACE FOR THE NEW PA RECORD.
   001067    7 00526 2361 00           933         LDQ     PROPA,,PR7      GET DBK OF OWNER OF SET
   001070    7 00511 2201 00           934         LDX     X0,RVO,,PR7
   001071    7 00000 7561 10           935         STQ     DBKEY,X0,PR7    SAVE DBK OF OWNER AS BASE DBK OF PA
   001072 (0)001606 7010 00            936         DBCAL   ZIG$DBASP,,SPAE1   SPLIT PA RECORDS
   001073 (0)001506 7020 00
   001074    5 00006 2341 00
   001075    777776 6010 04
                                       937  *  RESET RVI AND RVT RECORD VARIABLES TO CONTAIN
                                       938  *  INFORMATION ON PRIOR AND CURRENT RECORDS
                                       939  *  RESPECTIVELY.
   001076    7 00510 2211 00           940         LDX     X1,RVI,,PR7     REC VAR FOR PRIOR
   001077    7 00700 2351 00           941         LDA     KCREG,,PR7      GET DBK OF PRIOR
   001100    7 00000 7551 11           942         STA     DBKEY,X1,PR7    PUT IN REC VAR
   001101    7 00510 2211 00           943         LDX     X1,RVI,,PR7
   001102    7 00701 2351 00           944         LDA     KCREG+1,,PR7    GET PA OFSTS OF PRIOR
   001103    7 00702 2361 00           945         LDQ     KCREG+2,,PR7    GET PA OWNER PTR OF PRIOR
   001104    7 00014 7571 11           946         STAQ    CBRCE,X1,PR7    PUT IN REC VAR
   001105    7 00510 2351 00           947         LDA     RVI,,PR7        *
   001106    7 00512 2361 00           948         LDQ     RVT,,PR7        *  REVERSE
   001107    7 00512 7551 00           949         STA     RVT,,PR7        *   INPUT AND TEMP
   001110    7 00510 7561 00           950         STQ     RVI,,PR7        *    REC VARIABLES
   001111    7 00510 2211 00           951         LDX     X1,RVI,,PR7
   001112    7 00703 2361 00           952         LDQ     KCREG+3,,PR7    GET DBK OF CURR
   001113    7 00000 7561 11           953         STQ     DBKEY,X1,PR7    PUT IN REC VAR
   001114  X 000000 7010 00            954         DBCAL   ZIG$DBPFD,PNPE2,FDER2  GET CURRENT
   001115 (0)001506 7020 00
   001116    5 00006 2341 00
   001117    000003 6000 04
   001120    5 00006 4501 00
   001121 (0)001506 7020 00
   001122    7 00510 2351 00           955         LDA     RVI,,PR7        *
   001123    7 00512 2361 00           956         LDQ     RVT,,PR7        *  REVERSE
   001124    7 00512 7551 00           957         STA     RVT,,PR7        *   INPUT AND TEMP
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            33   BMAP - B00     
   001125    7 00510 7561 00           958         STQ     RVI,,PR7        *   RECORD VARIABLES
   001126    7 00513 2231 00           959         LDX     X3,RVPA,,PR7    REC VAR FOR OLD PA REC
   001127    7 00511 2221 00           960         LDX     X2,RVO,,PR7     REC VAR FOR NEW PA REC
                                       961  *  SET PA STACK COUNTER AND PUT INFO ABOUT PA SPLIT IN
                                       962  *  THE PA STACK.
   001130    7 00724 7211 00           963         LXL     X1,PASPLT,,PR7  GET PA SPLIT INDICATOR/COUNT
   001131    000002 1010 03            964         CMPX    X1,2,DU         STACK ONLY CONTAINS ROOM FOR 2 SPLITS
   001132 (0)001476 6030 00            965         TRC     PASKOE          PA STACK OVERFLOW ERROR - MORE
                                       966  *                                THAN 2 SPLITS AT ONE TIME
   001133    000000 6350 11            967         EAA     ,X1
   001134    000002 7350 00            968         ALS     2               EACH ENTRY = 4 WORDS
   001135    001225 6350 01            969           EAA      PASTK,AU             AU= address of entry in stack
   001136    7 00000 2361 12           970         LDQ     DBKEY,X2,PR7    DBK OF NEW PA RECORD
   001137    7 00000 7561 01           971           STQ      0,AU,PR7             Put in PA stack
   001140    7 00000 2361 13           972         LDQ     DBKEY,X3,PR7    DBK OF PRIOR PA REC
   001141    7 00001 7561 01           973           STQ      1,AU,PR7             Put in PA stack
   001142    7 00002 4735 13           974         LDP     PR3,RADDR,X3,PR7  GET REC ADDR OF OLD PA
   001143    7 00004 7251 13           975         LXL     X5,RSPTR,X3,PR7  GET RS PTR OF OLD PA
   001144    7 00004 2261 13           976         LDX     X6,SCPTR,X3,PR7  GET SC PTR OF OLD PA
                                       977  *  MOVE PA OWNER POINTER OF PRIOR TO STACK
   001145    000 1 100 1015 20         978         MRL     (1,,1),(1),,1      * MOVE
   001146    6 00006 0001 15           979         ARG     HPOS,X5,PR6        *  PA OWNER PTR OF PRIOR
   001147    7 00631 0 0 0 0004        980         ADSC9   PTR,0,4,PR7          *   TO WORKSPACE
   001150    7 00631 2361 00           981         LDQ     PTR,,PR7        GET PTR
                                       982  *  IF SET IS LOCAL, CONVERT PTR TO GLOBAL DBK
   001151    6 00000 7201 16           983         LXL     X0,DEF,X6,PR6   GET DEF BITS FROM SC
   001152    001000 3000 03            984         CANX    X0,.LG,DU       IS IT A LOCAL SET
   001153 (0)001156 6010 00            985         TNZ     SPTR            NO - GO STORE PTR IN STACK
   001154    7 00005 2201 13           986         LDX     X0,ACPTR,X3,PR7  YES - GET AC PTR
   001155    6 00002 0361 10           987         ADLQ    ABAS,X0,PR6     ADD BASE FOR LOCAL PTRS
   001156                              988  SPTR   NULL
   001156    7 00002 7561 01           989           STQ      2,AU,PR7             Put in stackA
   001157    7 00003 4501 01           990           STZ      3,AU,PR7             Zero entry & pointer v of v ff v fset
   001160    000001 6210 11            991         EAX     X1,1,X1         INCREMENT PA COUNT
   001161    7 00724 4411 00           992         SXL     X1,PASPLT,,PR7  SAVE IN PA SPLIT INDICATOR/COUNT
                                       993  *  GET NEW NO. OF ENTRIES IN OLD PA
   001162    7 00002 4735 13           994         LDP     PR3,RADDR,X3,PR7  SET PR3 = ADDRESS OF PA REC
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            34   BMAP - B00     
   001163    000 1 100 1005 00         995         MLR     (1),(1),,1         * MOVE
   001164    3 00001 0 0 0 0004        996         ADSC9   PACW,0,4,PR3         *  POINTER ARRAY CONTROL WORD
   001165    7 00714 0 0 0 0004        997         ADSC9   PARCW,0,4,PR7        *   TO WORKSPACE
                                       998  *  INITIALIZE INDICATOR = OLD PA REC IS IN RVPA
   001166    000000 6210 00            999         EAX     X1,0
   001167    7 00726 4411 00          1000         SXL     X1,PARVPA,,PR7
                                      1001  *  CALCULATE OFFSET OF NEW HIGHEST ENTRY IN OLD PA
   001170    7 00714 2361 00          1002         LDQ     PARCW,,PR7      GET NO. OF ENTRIES
   001171    017777 3760 03           1003         ANQ     .NOENT,DU       ISOLATE
   001172    777777 6360 02           1004         EAQ     -1,QU
   001173    000022 7720 00           1005         QRL     18              INTO QL FOR MULTIPLY
   001174    7 00717 4021 00          1006         MPY     ENTSZ,,PR7      MULTIPLY NO. OF ENTRIES BY ENTRY SIZE
   001175    7 00006 2271 13          1007         LDX     X7,RCPTR,X3,PR7  GET RC PTR FOR PA REC
   001176    000000 6210 06           1008         EAX     X1,,QL
   001177    6 77776 0211 17          1009         ADLX    X1,CSPSB,X7,PR6  SET X1 = OFST OF LAST ENTRY IN OLD PA
   001200    7 00510 2201 00          1010         LDX     X0,RVI,,PR7     REC VAR FOR PRIOR
   001201    7 00014 2221 10          1011         LDX     X2,CBRCE,X0,PR7    IS PRIOR THE OWNER OF SET? (IF 0)
   001202 (0)001057 6000 00           1012         TZE     GSPAV2             YES - DONT VERIFY OFFSET(RS IS GONE)
   001203    7 00014 1011 10          1013         CMPX    X1,CBRCE,X0,PR7  IS PRIOR IN OLD OR NEW PA NOW
   001204 (0)001224 6020 00           1014         TNC     NPMV            IN NEW
   001205 (0)001207 6000 00           1015         TZE     *+2             DONT KNOW-NEED TO CHECK IF PTR GRP WAS SP
   001206 (0)001237 7100 00           1016         TRA     VNP             ITS STILL IN OLD
   001207    7 00641 7221 00          1017         LXL     X2,PGSPLT,,PR7  WAS THERE A PTR GRP SPLIT
   001210 (0)001237 6000 00           1018         TZE     VNP             NO
                                      1019  *  A PTR GROUP WAS SPLIT - DETERMINE IF THE PTR FOR THE
                                      1020  *  NEXT/PRIOR WAS MOVED TO THE NEW PA
   001211    7 00511 2221 00          1021         LDX     X2,RVO,,PR7     REC VAR FOR NEW PA
   001212    7 00002 4735 12          1022         LDP     PR3,RADDR,X2,PR7  GET REC ADDRESS FOR NEW PA
   001213    3 00000 5005 11          1023         A9BD    ,X1,PR3         SET PR3 = ADDRESS OF ENTRY
   001214    7 00004 7251 12          1024         LXL     X5,RSPTR,X2,PR7  GET RS PTR FOR PA REC
   001215    000 1 100 1015 20        1025         MRL     (1,,1),(1),,1      * MOVE
   001216    6 00007 0001 15          1026         ARG     CSMPP,X5,PR6       *  PTR GRP OFFSET
   001217    7 00730 0 0 0 0004       1027         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   001220    7 00014 2351 10          1028         LDA     CBRCP,X0,PR7    GET PTR OFST OF NEXT PRIOR
   001221    777777 3750 07           1029         ANA     -1,DL           ISOLATE
   001222    7 00730 1151 00          1030         CMPA    MEMPTR,,PR7     WAS PTR FOR PRIOR/NEXT MOVED TO NEW PA
   001223 (0)001237 6020 00           1031         TNC     VNP             NO - ITS STILL IN OLD PA
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            35   BMAP - B00     
   001224                             1032  NPMV   NULL
                                      1033  *
                                      1034  *  THE ENTRY FOR THE NEXT/PRIOR RECORD WAS MOVED TO
                                      1035  *  THE NEW PA WHICH WAS CREATED DURING THE SPLITTING OF THE
                                      1036  *  OLD PA RECORD.  THUS NEED TO UPDATE THE PA PTR AND PA
                                      1037  *  OFFSETS IN THE REC VAR FOR THE NEXT/PRIOR.
                                      1038  *  SET INDICATOR = OLD PA REC NOT IN PA REC VARIABLE
   001224    000001 6210 00           1039         EAX     X1,1
   001225    7 00726 4411 00          1040         SXL     X1,PARVPA,,PR7
   001226    7 00511 2351 00          1041         LDA     RVO,,PR7        *
   001227    7 00513 2361 00          1042         LDQ     RVPA,,PR7       *  REVERSE
   001230    7 00513 7551 00          1043         STA     RVPA,,PR7       *   OUT REC VAR AND
   001231    7 00511 7561 00          1044         STQ     RVO,,PR7        *    PA REC VAR
   001232    7 00510 2201 00          1045         LDX     X0,RVI,,PR7     REC VAR FOR PRIOR
   001233    7 00513 2231 00          1046         LDX     X3,RVPA,,PR7
   001234    7 00000 2361 13          1047         LDQ     DBKEY,X3,PR7    GET DBK OF NEW PA
   001235    000000 6350 00           1048         EAA     0               SET PA ENTRY AND PTR OFSTS TO ZERO
   001236    7 00014 7571 10          1049         STAQ    CBRCE,X0,PR7    SAVE IN REC VAR FOR NEXT/PRIOR
   001237                             1050  VNP    NULL
   001237  X 000000 7010 00           1051         DBCAL   ZIG$DBAVO,,VOER2   GET NEW OFSTS OF NEXT/PRIOR
   001240 (0)001506 7020 00
   001241    5 00006 2341 00
   001242    777776 6010 04
   001243 (0)001057 7100 00           1052         TRA     GSPAV2          GO CHECK SPACE IN NEW PA REC
   001244                             1053  ISSPC  NULL
                                      1054  *  THERE IS ENOUGH SPACE AVAILABLE IN PA RECORD
   001244    7 00740 7201 00          1055         LXL     X0,PADUP,,PR7   GET PA DUPLICATE INDICATOR
   001245 (0)001272 6040 00           1056         TMI     DPRIR           DUP OF PRIOR
   001246 (0)001272 6010 00           1057         TNZ     DNEXT           DUP OF NEXT
                                      1058  *  ENTRY TO BE STORED IS UNIQUE-SET OFST OF NEW = OFST OF PRIOR
                                      1059  *  + ENTRY SIZE
   001247    7 00510 2211 00          1060         LDX     X1,RVI,,PR7     REC VAR OF PRIOR
   001250    7 00513 2231 00          1061         LDX     X3,RVPA,,PR7
   001251    7 00006 2271 13          1062         LDX     X7,RCPTR,X3,PR7  GET RC PTR FOR PA REC
   001252    6 77776 7201 17          1063         LXL     X0,CSPES,X7,PR6  GET ENTRY SIZE
   001253    7 00014 2251 11          1064        LDX     X5,CBRCE,X1,PR7     GET ENTRY OFFSET
   001254 (0)001257 6010 00           1065        TNZ     *+3                 NON-ZERO IF PRIOR NOT OWNER
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            36   BMAP - B00     
   001255    6 77776 2201 17          1066        LDX     X0,CSPSB,X7,PR6     USE THE FIRST ENTRY LOCATION
   001256 (0)001260 7100 00           1067        TRA     *+2
   001257    7 00014 0201 11          1068         ADLX    X0,CBRCE,X1,PR7  ADD ENTRY OFST OF PRIOR
   001260    7 00000 2361 13          1069         LDQ     DBKEY,X3,PR7    GET DBK OF PA REC
   001261    7 00512 2231 00          1070         LDX     X3,RVT,,PR7     REC VAR OF NEW MEMBER
   001262    7 00014 4501 13          1071         STZ     CBRCP,X3,PR7    SET PTR OFST = 0
   001263    7 00014 7401 13          1072         STX     X0,CBRCE,X3,PR7  SAVE CALCULATED ENTRY OFFSET OF NEW
   001264    7 00015 7561 13          1073         STQ     CBRPA,X3,PR7    SAVE AS DBK OF PA OF NEW
                                      1074  *  STORE ENTRY OCCURRENCE
   001265 (0)000317 7010 00           1075         DBCAL   ZIG$DBACO,,SEOE1   STORE ENTRY IN PA RECORD
   001266 (0)001506 7020 00
   001267    5 00006 2341 00
   001270    777776 6010 04
   001271 (0)001276 7100 00           1076         TRA     COCLVL          GO CHECK LEVEL
   001272                             1077  DPRIR  NULL
   001272                             1078  DNEXT  NULL
   001272 (0)002320 7010 00           1079         DBCAL   ZIG$DBCDP,,CDPER1  CREATE DUPLICATE ENTRY
   001273 (0)001506 7020 00
   001274    5 00006 2341 00
   001275    777776 6010 04
   001276                             1080  COCLVL NULL
                                      1081  *  UNLOCK THE BUFFER FOR THE CURRENT RECORD
   001276    7 00512 2231 00          1082        UNLOCK  RVT                 UNLOCK CURR REC
   001277  X 000000 7010 00
   001300    000000 0020 00
   001301    7 00513 2231 00          1083        UNLOCK  RVPA                UNLOCK OLD PA IN RVPA
   001302  X 000000 7010 00
   001303    000000 0020 00
   001304    7 00724 7211 00          1084        LXL     X1,PASPLT,,PR7      HAS PA SPILT OCCURED?
   001305 (0)001311 6000 00           1085        TZE     NOSPLT              NO -
   001306    7 00511 2231 00          1086        UNLOCK  RVO                 OLD PA IN RVO, NEW PA IN RVPA
   001307  X 000000 7010 00
   001310    000000 0020 00
   001311                             1087  NOSPLT NULL
   001311  X 000000 7010 00           1088        DBCAL   ZIM$JAFTPA,,NOALT  JOURNAL THE PA REC AFTER IMAGES
   001312    000000 0020 00
   001313    7 00512 2231 00          1089         LDX     X3,RVT,,PR7     REC VAR FOR CURR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            37   BMAP - B00     
   001314    7 00000 2361 13          1090         LDQ     DBKEY,X3,PR7    GET DBK OF CURR
   001315    7 00704 1161 00          1091         CMPQ    KCREG+4,,PR7    IS IT THE NEW PA MEMBER
   001316 (0)001324 6010 00           1092         TNZ     AOP             NO - A PA REC - GO ADJST OWNER PTR
   001317    7 00014 2351 13          1093         LDA     CBRCE,X3,PR7    GET ENTRY & PTR OFFSETS
   001320    7 00523 7551 00          1094         STA     KCARG0,,PR7     SAVE
   001321    7 00015 2361 13          1095         LDQ     CBRPA,X3,PR7    GET DBK OF PA REC
   001322    7 00525 7561 00          1096         STQ     KCARG4,,PR7     SAVE
   001323 (0)001335 7100 00           1097         TRA     CIPAS           GO CHECK IF PA REC HAS BEEN SPLIT
                                      1098  *  THE CURRENT RECORD IS A PA RECORD.  THE OWNER PTR HAS
                                      1099  *  ALREADY BEEN STORED.  IF THE ENTRY FOR THIS PA RECORD WAS
                                      1100  *  MOVED TO THE NEW PA RECORD DURING THE SPLITTING OF THE
                                      1101  *  HIGHER LEVEL PA RECORDS, THE OWNER PTR NEEDS TO
                                      1102  *  BE ADJUSTED.
   001324                             1103  AOP    NULL
   001324    7 00724 7211 00          1104         LXL     X1,PASPLT,,PR7  WAS THE PA SPLIT
   001325 (0)001430 6000 00           1105         TZE     DCR             NO - DONE CREATING PA ENTRIES
   001326    7 00726 7211 00          1106         LXL     X1,PARVPA,,PR7  WAS ENTRY MOVED
   001327 (0)001345 6000 00           1107         TZE     OPAIPA          NO
   001330 (0)003170 7010 00           1108         DBCAL   ZIG$DBAAO,,AOER1   YES - ADJUST OWNER PTR
   001331 (0)001503 7020 00
   001332    5 00006 2341 00
   001333    777776 6010 04
   001334 (0)001341 7100 00           1109         TRA     RVREC           GO REVERSE REC VARIABLES
   001335                             1110  CIPAS  NULL
   001335    7 00724 7211 00          1111         LXL     X1,PASPLT,,PR7  HAS A PA REC BEEN SPLIT
   001336 (0)001430 6000 00           1112         TZE     DCR             NO - DONE CREATING PA ENTRIES
   001337    7 00726 7211 00          1113         LXL     X1,PARVPA,,PR7  IS OLD PA REC IN PA REC VAR
   001340 (0)001345 6000 00           1114         TZE     OPAIPA          YES
   001341                             1115  RVREC  NULL
   001341    7 00511 2351 00          1116         LDA     RVO,,PR7        NO - OLD PA IS IN RVO-PUT IN RVPA
   001342    7 00513 2361 00          1117         LDQ     RVPA,,PR7       * REVERSE
   001343    7 00513 7551 00          1118         STA     RVPA,,PR7       *  OUTPUT AND PA
   001344    7 00511 7561 00          1119         STQ     RVO,,PR7        *    RECORD VARIABLES
   001345                             1120  OPAIPA NULL
                                      1121  *  DECREMENT PA STACK COUNT
   001345    7 00724 7211 00          1122         LXL     X1,PASPLT,,PR7  PA STACK COUNT
   001346    777777 6210 11           1123         EAX     X1,-1,X1        DECREMENT BY 1
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            38   BMAP - B00     
   001347    7 00724 4411 00          1124         SXL     X1,PASPLT,,PR7  SAVE
                                      1125  *  CALCULATE ADDRESS OF ENTRY IN PA STACK
   001350    001225 6350 00           1126           EAA      PASTK                AU= address of entry in stack
                                      1127  *  REMOVE INFO FROM STACK AND PUT IN RECORD VARIABLES
   001351    7 00001 2361 01          1128           LDQ      1,AU,PR7             Get DBKEY of prior
   001352    7 00512 2221 00          1129         LDX     X2,RVT,,PR7
   001353    7 00000 7561 12          1130         STQ     DBKEY,X2,PR7    PUT DBK OF PRIOR IN REC VAR
   001354    7 00002 2361 01          1131           LDQ      2,AU,PR7             Get PA owner of prior
   001355    7 00015 7561 12          1132         STQ     CBRPA,X2,PR7    PUT IN REC VAR
   001356    7 00003 2361 01          1133           LDQ      3,AU,PR7             Get PA entry & pointer offset
   001357    7 00014 7561 12          1134         STQ     CBRCE,X2,PR7    PUT IN REC VAR
   001360    7 00510 2221 00          1135         LDX     X2,RVI,,PR7
   001361    7 00000 2361 01          1136           LDQ      0,AU,PR7 7                Get DBKEY of current
   001362    7 00000 7561 12          1137         STQ     DBKEY,X2,PR7    PUT IN REC VAR
                                      1138  *  UPDATE PA STACK BY MOVING ENTRIES UP TO OVERLAY 1ST
                                      1139  *  ENTRY WHICH HAS ALREADY BEEN REMOVED.
   001363    000004 6350 00           1140         EAA     PAMVSZ          AU = SIZE OF MOVE IN WORDS
   001364    000002 7350 00           1141         ALS     2               AU = SIZE OF MOVE IN BYTES
   001365    000 0 140 1005 40        1142         MLR     (1,1),(1,1)        * MOVE
   001366    7 01231 0 0 0 0001       1143         ADSC9   PASTK+4,0,AU,PR7     * STACK ENTRIES UP
   001367    7 01225 0 0 0 0001       1144         ADSC9   PASTK,0,AU,PR7    *   TO OVERLAY 1ST ENTRY
   001370  X 000000 7010 00           1145         DBCAL   ZIG$DBPFD,PNPE6,FDER6  FIND THE REC
   001371 (0)001503 7020 00
   001372    5 00006 2341 00
   001373    000003 6000 04
   001374    5 00006 4501 00
   001375 (0)001503 7020 00
                                      1146  *  PUT PRIOR IN RVI AND CURRENT IN RVT
   001376    7 00510 2351 00          1147         LDA     RVI,,PR7        *
   001377    7 00512 2361 00          1148         LDQ     RVT,,PR7        * REVERSE
   001400    7 00512 7551 00          1149         STA     RVT,,PR7        *  INPUT AND TEMP
   001401    7 00510 7561 00          1150         STQ     RVI,,PR7        *   RECORD VARIABLES
   001402    7 00520 2261 00          1151         LDX     X6,PRSC,,PR7    GET SC PTR
   001403    7 00003 2351 01          1152         LDA     RTP,AU,PR7      GET RECORD TYPE
   001404  X 000000 7010 00           1153         ICCAL   ZIG$DBPR2,,FRCE3   FIND RC & RS FOR CURR
   001405 (0)001503 7020 00
   001406    5 00006 2341 00
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            39   BMAP - B00     
   001407    777776 6010 04
   001410    7 00512 2211 00          1154         LDX     X1,RVT,,PR7
   001411    7 00004 7461 11          1155         STX     X6,SCPTR,X1,PR7  SAVE SC PTR
   001412    7 00006 7471 11          1156         STX     X7,RCPTR,X1,PR7  SAVE RC PTR
   001413    7 00004 4451 11          1157         SXL     X5,RSPTR,X1,PR7  SAVE RS PTR
                                      1158  *  MOVE PA KEY VALUE TO KEY PROCESS AREA
   001414    7 00512 2231 00          1159         LDX     X3,RVT,,PR7
   001415    7 00002 4735 13          1160         LDP     PR3,RADDR,X3,PR7  GET ADDRESS OF NEW PA
   001416    7 00006 2271 13          1161         LDX     X7,RCPTR,X3,PR7  GET RC PTR FOR PA REC
   001417    7 00717 7221 00          1162         LXL     X2,ENTSZ,,PR7   SET X2 = SIZE OF MOVE(ENTRY SIZE)
   001420    6 77776 2351 17          1163         LDA     CSPSB,X7,PR6    SET AU = OFST OF 1ST ENTRY IN PA REC
   001421    7 00010 4745 00          1164         LDP     PR4,KEYPA,,PR7
   001422    000 1 140 1005 41        1165         MLR     (1,1,,AU),(1,1),,1  * MOVE
   001423    3 00000 0 0 0 0012       1166         ADSC9   0,0,X2,PR3           *  PA KEY VALUE OF 1ST ENTRY IN PA
   001424    4 00000 0 0 0 0012       1167         ADSC9   0,0,X2,PR4           *   TO KEY PROCESS AREA
                                      1168  *  STORE ENTRY FOR NEW PA REC IN HIGHER LEVEL PA REC
   001425    000000 6210 00           1169         EAX     X1,0
   001426    7 00740 4411 00          1170         SXL     X1,PADUP,,PR7   SET DUP INDIC = NONDUP
   001427 (0)000562 7100 00           1171         TRA     ZIG$DBCLP
                                      1172  *
                                      1173  *
                                      1174  *  DONE CREATING NEW PA ENTRIES.  CHECK TO MAKE
                                      1175  *  SURE NEW PA MEMBER RECORD IS IN THE TEMP
                                      1176  *  RECORD VARIABLE.  IF NOT, MUST RESET INFO IN
                                      1177  *  THE TEMP RECORD VARIABLE.
   001430                             1178  DCR    NULL
   001430    7 00512 2211 00          1179         LDX     X1,RVT,,PR7
   001431    7 00704 2361 00          1180         LDQ     KCREG+4,,PR7
   001432    7 00000 1161 11          1181         CMPQ    DBKEY,X1,PR7    IS NEW PA MEMBER IN TEMP REC VAR
   001433 (0)001467 6000 00           1182         TZE     CERET           YES - RETURN
                                      1183  *  NEW PA MEMBER IS NO LONGER IN TEMP REC VAR BECAUSE OF
                                      1184  *  SPLITTING OF PA RECORDS.  RESET TEMP REC VAR = INFO ON
                                      1185  *  NEW PA MEMBER RECORD.
   001434    7 00510 2351 00          1186         LDA     RVI,,PR7        *
   001435    7 00512 2361 00          1187         LDQ     RVT,,PR7        * REVERSE
   001436    7 00512 7551 00          1188         STA     RVT,,PR7        *  INPUT AND TEMP
   001437    7 00510 7561 00          1189         STQ     RVI,,PR7        *   RECORD VARIABLES
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            40   BMAP - B00     
   001440    7 00510 2211 00          1190         LDX     X1,RVI,,PR7
   001441    7 00704 2361 00          1191         LDQ     KCREG+4,,PR7
   001442    7 00000 7561 11          1192         STQ     DBKEY,X1,PR7
   001443  X 000000 7010 00           1193         DBCAL   ZIG$DBPFD,PNPE1,FDER1  FIND NEW PA MEMBER
   001444 (0)001503 7020 00
   001445    5 00006 2341 00
   001446    000003 6000 04
   001447    5 00006 4501 00
   001450 (0)001503 7020 00
   001451    7 00510 2211 00          1194         LDX     X1,RVI,,PR7
   001452    7 00705 2351 00          1195         LDA     KCREG+5,,PR7
   001453    7 00003 7551 11          1196         STA     RTP,X1,PR7      RESTORE REC TYPE OF NEW
   001454    7 00706 2371 00          1197         LDAQ    KCREG+6,,PR7
   001455    7 00006 7551 11          1198         STA     RCPTR,X1,PR7    RESTORE RC PTR FOR NEW
   001456    7 00004 7561 11          1199         STQ     SCPTR,X1,PR7    RESTORE SC & RS PTRS FOR NEW
   001457    7 00523 2351 00          1200         LDA     KCARG0,,PR7     RESTORE ENTRY & PTR OFFSETS
   001460    7 00014 7551 11          1201         STA     CBRCE,X1,PR7
   001461    7 00525 2361 00          1202         LDQ     KCARG4,,PR7     RESTORE DBK OF PA REC
   001462    7 00015 7561 11          1203         STQ     CBRPA,X1,PR7
                                      1204  *  PUT CURRENT BACK INTO TEMP REC VAR
   001463    7 00510 2351 00          1205         LDA     RVI,,PR7        *
   001464    7 00512 2361 00          1206         LDQ     RVT,,PR7        * REVERSE
   001465    7 00512 7551 00          1207         STA     RVT,,PR7        *  INPUT AND TEMP
   001466    7 00510 7561 00          1208         STQ     RVI,,PR7        *   RECORD VARIABLES
   001467                             1209  CERET  NULL
                                      1210  *  RETURN
   001467  X 000000 7020 00           1211         DBRET
                                      1212  *
                                      1213  *  ERRORS DETECTED IN THIS PRIMITIVE
                                      1214  *    (WHILE BUFFER OF CURR REC IS LOCKED)
                                      1215  *
   001470                             1216  NRCE1  NULL                    RS FOR PA REC NOT FOUND
   001470    303243 2350 07           1217         LDA     SSER,DL
   001471    7 00005 2201 11          1218         LDX     X0,ACPTR,X1,PR7  GET AC PTR
   001472    7 00004 2261 11          1219         LDX     X6,SCPTR,X1,PR7  GET SC PTR
   001473    000000 6270 00           1220         EAX     X7,0            NULL RC
   001474    000001 6210 00           1221         EAX     X1,1            SET X1 = LOCK INDICATOR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            41   BMAP - B00     
   001475 (0)001513 7100 00           1222         TRA     CECER
   001476                             1223  PASKOE NULL                    PA STACK OVERFLOW
   001476    234654 2350 07           1224         LDA     NSCS,DL         GET ERROR CODE
   001477    000000 6200 00           1225         EAX     X0,0            NULL AC PTR
   001500    7 00520 2261 00          1226         LDX     X6,PRSC,,PR7    SET X6 = SC PTR
   001501    000000 6270 00           1227         EAX     X7,0            NULL RC PTR
   001502    000001 6210 00           1228         EAX     X1,1            SET X1 = LOCK INDICATOR
                                      1229  *
                                      1230  *
                                      1231  *
                                      1232  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                      1233  *    (WHILE BUFFER OF CURR REC IS LOCKED)
                                      1234  *
   001503                             1235  PNPE1  NULL                    NEW PA MEMBER NOT FOUND
   001503                             1236  FDER1  NULL                    ERROR FINDING NEW PA MEMBER
   001503                             1237  AOER1  NULL                    ERROR ADJUSTING OWNER PTR IN PA REC
   001503                             1238  PNPE6  NULL                    CURR PA REC NOT FOUND
   001503                             1239  FDER6  NULL                    ERROR FINDING CURR PA
   001503                             1240  FRCE3  NULL                    ERROR FINDING RC & RS PTR OF CURR
   001503    000000 6210 00           1241         EAX     X1,0            SET X1 = INDICATOR FOR UNLOCK
   001504 (0)001513 7100 00           1242         TRA     CECER
                                      1243  *
                                      1244  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                      1245  *    (WHILE BUFFER OF CURR REC IS LOCKED)
                                      1246  *
   001505                             1247  FRCE2  NULL                    ERROR FINDING RC PTR
   001505                             1248  FRCE1  NULL                    ERROR FIND RC & RS PTRS FOR PRIOR
   001505    000000 6200 00           1249         EAX     X0,0            NULLIFY AC POINTERS
   001506                             1250  CPAE1  NULL                    ERROR CREATING PA RECORD
   001506                             1251  IDER1  NULL                    ERROR INSERTING DUMMY PA ENTRY
   001506                             1252  PANP   NULL                    PA RECORD NOT FOUND
   001506                             1253  PGER4  NULL                    PAGE ERROR - FINDING PA RECORD
   001506                             1254  VOER1  NULL                    ERROR VERIFYING OFSTS OF PRIOR OF PA
   001506                             1255  SEOE1  NULL                    ERROR STORING ENTRY IN PA REC
   001506                             1256  SPAE1  NULL                    ERROR SPLITTING PA RECORD
   001506                             1257  VOER2  NULL                    EROR FIND ING NEW OFSTS OF NEXT/PRIOR
   001506                             1258  PNPE2  NULL                    CURRENT REC NOT FOUND
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            42   BMAP - B00     
   001506                             1259  FDER2  NULL                    ERROR FINDING CURRENT  RECORD
   001506                             1260  FNPAE  NULL                    ERROR FINDING NEXT IN PA SET
   001506                             1261  CDPER1 NULL                    ERROR CREATING DUPLICATE ENTRY
   001506                             1262  CKER1  NULL                    ERROR COMPARING PA KEY VALUE
   001506                             1263  SMWER6 NULL                       SET MUST WRITE ERROR
   001506    000001 6210 00           1264         EAX     X1,1            SET X1 = LOCK INDICATOR
   001507 (0)001513 7100 00           1265         TRA     CECER
                                      1266  *
                                      1267  *  ERRORS DETECTED IN I/O ROUTINES
                                      1268  *
   001510                             1269  LKRE5  NULL                    ERROR LOCKING BUF OF CURR
   001510                             1270  ULKRE7 NULL                    ERROR UNLOCKING BUF OF CURR
   001510    000000 6200 00           1271        EAX     X0,0                SET X1 = NOT LOCK IND
   001511    000000 6260 00           1272         EAX     X6,0            NULL SC PTR
   001512    000000 6270 00           1273         EAX     X7,0            NULL RC PTR
                                      1274  *
                                      1275  *
                                      1276  *  COMMON ERROR RETURN
   001513                             1277  CECER  NULL
   001513    7 00064 7551 00          1278         STA     EXCCD,,PR7      SAVE ERROR CODE
   001514    5 00010 4401 00          1279         SXL     X0,GRETAC,,PR5  TEMP SOLUTION
   001515    5 00012 4461 00          1280         SXL     X6,GRETSC,,PR5  TEMP SOLUTION
   001516    5 00013 4471 00          1281         SXL     X7,GRETRC,,PR5  TEMP SOLUTION
   001517    7 00510 2351 00          1282         LDA     RVI,,PR7        *
   001520    7 00512 2361 00          1283         LDQ     RVT,,PR7        * REVERSE
   001521    7 00512 7551 00          1284         STA     RVT,,PR7        *  INPUT AND TEMP
   001522    7 00510 7561 00          1285         STQ     RVI,,PR7        *   REC VARIABLES
   001523    000001 1010 03           1286         CMPX    X1,=O1,DU       IS CURR REC LOCKED
   001524 (0)001553 6010 00           1287         TNZ     NTLCK           NO
                                      1288  *  REFIND CURR RECORD AND UNLOCK BUFFER
   001525    7 00510 2211 00          1289         LDX     X1,RVI,,PR7
   001526    7 00703 2361 00          1290         LDQ     KCREG+3,,PR7    GET DBK OF CURR REC
   001527    7 00000 7561 11          1291         STQ     DBKEY,X1,PR7    PUT IN INPUT REC VAR
   001530  X 000000 7010 00           1292         DBCAL   ZIG$DBPFD,PNPE4,FDER4
   001531 (0)001605 7020 00
   001532    5 00006 2341 00
   001533    000003 6000 04
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            43   BMAP - B00     
   001534    5 00006 4501 00
   001535 (0)001605 7020 00
   001536    7 00510 2231 00          1293        UNLOCK  RVI                 UNLOCK CURR
   001537  X 000000 7010 00
   001540    000000 0020 00
   001541    7 00513 2231 00          1294        UNLOCK  RVPA,IFLOCKED       UNLOCK PA CONTAINING PRIOR
   001542    7 00007 2241 13
   001543 (0)001546 6000 00
   001544  X 000000 7010 00
   001545    000000 0020 00
   001546    7 00511 2231 00          1295        UNLOCK  RVO,IFLOCKED        UNLOCK NEW PA IF CREATED
   001547    7 00007 2241 13
   001550 (0)001553 6000 00
   001551  X 000000 7010 00
   001552    000000 0020 00
                                      1296  *  RESET TEMP REC VAR = INFO ON NEW PA MEMBER
   001553                             1297  NTLCK  NULL
   001553    7 00510 2211 00          1298         LDX     X1,RVI,,PR7
   001554    7 00704 2361 00          1299         LDQ     KCREG+4,,PR7    GET DBK OF NEW PA MEMBER
   001555    7 00000 7561 11          1300         STQ     DBKEY,X1,PR7
   001556  X 000000 7010 00           1301         DBCAL   ZIG$DBPFD,PNPE5,FDER5  GET NEW PA MEMBER
   001557 (0)001605 7020 00
   001560    5 00006 2341 00
   001561    000003 6000 04
   001562    5 00006 4501 00
   001563 (0)001605 7020 00
   001564    7 00510 2211 00          1302         LDX     X1,RVI,,PR7
   001565    7 00705 2351 00          1303         LDA     KCREG+5,,PR7
   001566    7 00003 7551 11          1304         STA     RTP,X1,PR7      RESTORE REC TYPE OF NEW
   001567    7 00706 2371 00          1305         LDAQ    KCREG+6,,PR7
   001570    7 00006 7551 11          1306         STA     RCPTR,X1,PR7    RESTORE RC PTR OF CURR
   001571    7 00004 7561 11          1307         STQ     SCPTR,X1,PR7    RESTORE SC & RS PTRS OF CURR
   001572    7 00510 2351 00          1308         LDA     RVI,,PR7        *
   001573    7 00512 2361 00          1309         LDQ     RVT,,PR7        * REVERSE
   001574    7 00512 7551 00          1310         STA     RVT,,PR7        *  INPUT AND TEMP
   001575    7 00510 7561 00          1311         STQ     RVI,,PR7        *   REC VARIABLES
   001576    7 00064 2351 00          1312         LDA     EXCCD,,PR7      GET ERROR CODE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE PA ENTRY                                            44   BMAP - B00     
   001577    5 00010 7201 00          1313         LXL     X0,GRETAC,,PR5  TEMP SOLUTION
   001600    5 00012 7261 00          1314         LXL     X6,GRETSC,,PR5  TEMP SOLUTION
   001601    5 00013 7271 00          1315         LXL     X7,GRETRC,,PR5  TEMP SOLUTION
   001602                             1316  CECER2 NULL
   001602  X 000000 7020 00           1317         DBALT
   001603                             1318  ULKRE8 NULL
   001603    000000 6260 00           1319         EAX     X6,0            NULL SC PTR
   001604    000000 6270 00           1320         EAX     X7,0            NULL RC PTR
   001605                             1321  PNPE4  NULL                    CURR NOT FOUND
   001605                             1322  FDER4  NULL                    ERROR FINDING CURR REC
   001605                             1323  PNPE5  NULL                    NEW PA MEMBER NOT FOUND
   001605                             1324  FDER5  NULL                    ERROR FINDING NEW PA MEMBER
   001605 (0)001602 7100 00           1325         TRA     CECER2

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               45   BMAP - B00     
                                      1326         TTLS    SPLIT A POINTER ARRAY RECORD
                                      1327  *
                                      1328  *  THIS ROUTINE WILL SPLIT A POINTER ARRAY RECORD BY
                                      1329  *  CREATING A NEW POINTER ARRAY RECORD AND MOVING
                                      1330  *  APPROXIMATELY HALF OF THE ENTRIES FROM THE OLD
                                      1331  *  POINTER ARRAY RECORD TO THE NEW POINTER ARRAY RECORD.
                                      1332  *  (IT WILL MOVE ENTRIES FROM THE OLD TO THE NEW WHILE
                                      1333  *   SPACE AVAILABLE IN THE NEW PA RECORD > SPACE
                                      1334  *   AVAILABLE IN THE OLD PA RECORD.)
                                      1335  *
                                      1336  *  INPUT ARGUMENTS:
                                      1337  *    RVPA - DBK OF PA RECORD
                                      1338  *           BUFFER ADDRESS
                                      1339  *           RECORD ADDRESS
                                      1340  *           REC TYPE
                                      1341  *           RC PTR
                                      1342  *           RS PTR
                                      1343  *           (LOCKED IN AND OUT)
                                      1344  *
                                      1345  *    RVO  - BASE DBK FOR NEW PA REC
                                      1346  *
                                      1347  *    PRSC - SC PTR FOR PA SET
                                      1348  *
                                      1349  *  OUTPUT ARGUMENTS:
                                      1350  *    RVO  - DBK OF NEW PA RECORD
                                      1351  *           BUFFER ADDRESS
                                      1352  *           RECORD ADDRESS
                                      1353  *           REC TYPE
                                      1354  *           RC PTR
                                      1355  *           RS PTR
                                      1356  *
                                      1357  *  EXCEPTION: NONE
                                      1358  *
   001606                             1359  ZIG$DBASP NULL
   001606  X 000000 7000 00           1360         DBSAV
   001607    000004 000000
                                      1361  *  SET INDICATOR TO NOT USE PA SET AS A PA SET BUT AS A REGULAR SET
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               46   BMAP - B00     
   001610    000001 6210 00           1362         EAX     X1,1
   001611    7 00735 4411 00          1363         SXL     X1,DUSEPA,,PR7  SET INDIC. TO NOT USE PA
   001612    000000 6210 00           1364         EAX     X1,0
   001613    7 00641 4411 00          1365         SXL     X1,PGSPLT,,PR7  SET INDIC.= PTR GRP NOT SPLIT
   001614    7 00511 2351 00          1366         LDA     RVO,,PR7        *
   001615    7 00513 2361 00          1367         LDQ     RVPA,,PR7       * SWITCH
   001616    7 00513 7551 00          1368         STA     RVPA,,PR7       *  OUT REC VAR AND PA REC VAR
   001617    7 00511 7561 00          1369         STQ     RVO,,PR7        *
   001620    7 00510 2371 00          1370         LDAQ    RVI,,PR7        *
   001621    7 00511 7551 00          1371         STA     RVO,,PR7        * SWITCH
   001622    7 00510 7561 00          1372         STQ     RVI,,PR7        *  IN REC VAR AND OUT REC VAR
                                      1373  *     THE PA TO BE SPLIT IS CURRENTLY LOCKED
                                      1374  *  IF THE PA RECORD TO BE SPLIT IS THE CURRENT HIGHEST
                                      1375  *  LEVEL PA, NEED TO CREATE ANOTHER LEVEL OF PA RECORDS.
   001623    7 00510 2211 00          1376         LDX     X1,RVI,,PR7
   001624    7 00002 4735 11          1377         LDP     PR3,RADDR,X1,PR7  GET ADDRESS OF OLD PA
   001625    7 00004 7251 11          1378         LXL     X5,RSPTR,X1,PR7  GET RS PTR
   001626    000 1 100 1015 20        1379         MRL     (1,,1),(1),,1      * MOVE
   001627    6 00004 0001 15          1380         ARG     NPOS,X5,PR6        *  NEXT PTR
   001630    7 00631 0 0 0 0004       1381         ADSC9   PTR,0,4,PR7          *   TO WORKSPACE
   001631    7 00631 2361 00          1382         LDQ     PTR,,PR7        GET NEXT PTR
   001632    000 1 100 1015 20        1383         MRL     (1,,1),(1),,1      * MOVE
   001633    6 00006 0001 15          1384         ARG     HPOS,X5,PR6        *  OWNER PTR
   001634    7 00631 0 0 0 0004       1385         ADSC9   PTR,0,4,PR7          *   TO WORKSPACE
   001635    7 00631 1161 00          1386         CMPQ    PTR,,PR7        IS THIS THE HIGH LEVEL PA REC
                                      1387  *                                 (NEXT PTR = OWNER PTR)
   001636 (0)001734 6010 00           1388         TNZ     SPAR1           NO - GO SPLIT PA RECORD
                                      1389  *  PA RECORD TO SPLIT IS HIGH LEVEL PA.  NEED TO
                                      1390  *  CREATE ANOTHER LEVEL OF PA RECORDS.  THIS
                                      1391  *  WILL BE DONE BY DISCONNECTING CURRENT HIGH LEVEL
                                      1392  *  PA RECORD FROM THE SET, CREATING A NEW PA
                                      1393  *  RECORD AND INSERTING IT AS THE NEW HIGH LEVEL PA.
   001637  X 000000 7010 00           1394        DBCAL   ZIG$DBPFO,NOEXC,FOER1
   001640 (0)002313 7020 00
   001641    7 00511 2351 00          1395         LDA     RVO,,PR7        *
   001642    7 00512 2361 00          1396         LDQ     RVT,,PR7        *  REVERSE
   001643    7 00512 7551 00          1397         STA     RVT,,PR7        *   OUT AND TEMP REC VARIABLES
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               47   BMAP - B00     
   001644    7 00511 7561 00          1398         STQ     RVO,,PR7        *
                                      1399  *  DISCONNECT OLD PA FROM SET - IT WILL NO LONGER
                                      1400  *  BE THE HIGH LEVEL PA.
   001645  X 000000 7010 00           1401         DBCAL  ZIM$PDIS,,DPAE2          DISCONNECT PA REC
   001646 (0)002313 7020 00
   001647    5 00006 2341 00
   001650    777776 6010 04
                                      1402  *  CREATE NEW HIGH LEVEL PA RECORD AND CONNECT IT
                                      1403  *  INTO THE SET.
   001651    7 00510 2211 00          1404         LDX     X1,RVI,,PR7
   001652    7 00006 2271 11          1405         LDX     X7,RCPTR,X1,PR7  GET RC PTR FOR PA REC
   001653    7 00517 7471 00          1406         STX     X7,PRRC,,PR7    RESTORE RC PTR(WAS CHANGED IN .DBPDS)
   001654    7 00510 2351 00          1407         LDA     RVI,,PR7        *
   001655    7 00512 2361 00          1408         LDQ     RVT,,PR7        *  REVERSE
   001656    7 00512 7551 00          1409         STA     RVT,,PR7        *   IN AND TEMP REC VARIABLES
   001657    7 00510 7561 00          1410         STQ     RVI,,PR7        *
   001660    7 00513 2211 00          1411         LDX     X1,RVPA,,PR7
   001661    7 00511 2221 00          1412         LDX     X2,RVO,,PR7
   001662    7 00000 2361 11          1413         LDQ     DBKEY,X1,PR7    GET BASE DBK FOR NEW PA REC
   001663    7 00000 7561 12          1414         STQ     DBKEY,X2,PR7    SAVE IN OUT REC VAR
   001664 (0)000417 7010 00           1415         DBCAL   ZIG$DBACR,,CPAE3   CREATE NEW HIGH LEVEL PA
   001665 (0)002313 7020 00
   001666    5 00006 2341 00
   001667    777776 6010 04
   001670    7 00510 2351 00          1416         LDA     RVI,,PR7        *
   001671    7 00512 2361 00          1417         LDQ     RVT,,PR7        *  REVERSE
   001672    7 00512 7551 00          1418         STA     RVT,,PR7        *   IN AND TEMP REC VARIABLES
   001673    7 00510 7561 00          1419         STQ     RVI,,PR7        *
                                      1420  *  INSERT DUMMY ENTRY IN NEW HIGH LEVEL PA RECORD
   001674 (0)003057 7010 00           1421         DBCAL   ZIG$DBAID,,IDER2   INSERT DUMMY ENTRY
   001675 (0)002313 7020 00
   001676    5 00006 2341 00
   001677    777776 6010 04
   001700    7 00511 2351 00          1422         LDA     RVO,,PR7        *
   001701    7 00513 2361 00          1423         LDQ     RVPA,,PR7       *  REVERSE
   001702    7 00513 7551 00          1424         STA     RVPA,,PR7       *   OUT REC VAR
   001703    7 00511 7561 00          1425         STQ     RVO,,PR7        *    AND PA REC VAR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               48   BMAP - B00     
                                      1426  *
                                      1427  *  UPDATE POINTERS IN OLD PA RECORD
                                      1428  *  SET OWNER PTR TO NEW HIGH LEVEL PA RECORD.
                                      1429  *  SET NEXT AND PRIOR PTRS TO ITSELF.
                                      1430  *
   001704    7 00510 2211 00          1431         LDX     X1,RVI,,PR7     SET X1 TO INPUT REC VAR(OLD PA)
   001705    7 00511 2221 00          1432         LDX     X2,RVO,,PR7     SET X2 TO OUTPUT REC VAR(NEW HI LEVEL PA)
   001706    7 00000 2351 11          1433         LDA     DBKEY,X1,PR7    GET DBK OF THE OLD PA REC
   001707    7 00000 2361 12          1434         LDQ     DBKEY,X2,PR7    GET DBK OF THE NEW HIGH LEVEL PA
                                      1435  *
                                      1436  *  ADJUST PTRS IF SET IS LOCAL
   001710    7 00520 2261 00          1437         LDX     X6,PRSC,,PR7    GET SC FOR PA SET
   001711    6 00000 7201 16          1438         LXL     X0,DEF,X6,PR6
   001712    001000 3000 03           1439         CANX    X0,.LG,DU       IS SET LOCAL
   001713 (0)001717 6010 00           1440         TNZ     POK             NO - DONT NEED TO ADJUST PTRS
   001714    7 00005 2201 11          1441         LDX     X0,ACPTR,X1,PR7  GET AC PTR
   001715    6 00002 1361 10          1442         SBLQ    ABAS,X0,PR6     MAKE OWNER PTR GLOBAL
   001716    6 00002 1351 10          1443         SBLA    ABAS,X0,PR6     MAKE NEXT AND PRIOR PTR LOCAL
   001717                             1444  POK    NULL
   001717    7 00631 7551 00          1445         STA     PTR,,PR7        SAVE NEXT AND PRIOR PTR
   001720    7 00731 7561 00          1446         STQ     PAOPTR,,PR7     SAVE NEW OWNER PTR
                                      1447  *
                                      1448  *  UPDATE THE OWNER PTR  TO PT TO THE NEW HIGH LEVEL PA
   001721    7 00002 4735 11          1449         LDP     PR3,RADDR,X1,PR7  SET PR3 = ADDRESS OF OLD PA
   001722    7 00004 7251 11          1450         LXL     X5,RSPTR,X1,PR7  SET X5 = RS PTR FOR PA REC
   001723    000 0 120 1015 00        1451         MRL     (1),(1,,1),,0      * MOVE
   001724    7 00731 0 0 0 0004       1452         ADSC9   PAOPTR,0,4,PR7       *  PTR TO HIGH LEVEL PA
   001725    6 00006 0001 15          1453         ARG     HPOS,X5,PR6        *   TO THE OWNER PTR POS
                                      1454  *  UPDATE THE NEXT PTR TO PT TO ITSELF
   001726    000 0 120 1015 00        1455         MRL     (1),(1,,1),,0      * MOVE
   001727    7 00631 0 0 0 0004       1456         ADSC9   PTR,0,4,PR7          *  DBK OF REC
   001730    6 00004 0001 15          1457         ARG     NPOS,X5,PR6        *   TO NEXT PTR POS
                                      1458  *  UPDATE THE PRIOR PTR TO PT TO ITSELF
   001731    000 0 120 1015 00        1459         MRL     (1),(1,,1),,0      * MOVE
   001732    7 00631 0 0 0 0004       1460         ADSC9   PTR,0,4,PR7          *  DBK OF REC
   001733    6 00005 0001 15          1461         ARG     PPOS,X5,PR6        *   TO PRIOR PTR POS
   001734                             1462  SPAR2  NULL
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               49   BMAP - B00     
   001734                             1463  SPAR1  NULL
                                      1464  *
                                      1465  *
                                      1466  *  SPLIT THE PA RECORD
                                      1467  *
                                      1468  *  RVI CONTAINS PRIOR PA REC IN LEVEL.
                                      1469  *  RVPA CONTAINS BASE DBK OF NEW PA RECORD.
                                      1470  *
   001734    7 00510 2211 00          1471         LDX     X1,RVI,,PR7
   001735    7 00006 2271 11          1472         LDX     X7,RCPTR,X1,PR7  GET RC PTR FOR PA REC
   001736    7 00517 7471 00          1473         STX     X7,PRRC,,PR7    SAVE FOR CALL
   001737 (0)000417 7010 00           1474         DBCAL   ZIG$DBACR,,CPAE2   CREATE NEW PA RECORD
   001740 (0)002313 7020 00
   001741    5 00006 2341 00
   001742    777776 6010 04
                                      1475  *  MOVE THE POINTER ARRAY CONTROL WORDS OF THE OLD AND THE
                                      1476  *  NEW PA RECORDS TO WORKSPACES.
   001743    7 00513 2211 00          1477         LDX     X1,RVPA,,PR7    SET X1 TO PA REC VAR (NEW PA)
   001744    7 00510 2221 00          1478         LDX     X2,RVI,,PR7     SET X2 TO IN REC VAR (OLD PA)
   001745    7 00002 4735 12          1479         LDP     PR3,RADDR,X2,PR7  GET ADDRESS OF OLD PA REC
   001746    000 1 100 1005 00        1480         MLR     (1),(1),,1         * MOVE
   001747    3 00001 0 0 0 0004       1481         ADSC9   PACW,0,4,PR3         *  PA CONTROL WORD OF OLD PA REC
   001750    7 00741 0 0 0 0004       1482         ADSC9   OPARCW,0,4,PR7       *   TO WORKSPACE
   001751    7 00002 4735 11          1483         LDP     PR3,RADDR,X1,PR7  GET ADDRESS OF NEW PA REC
   001752    000 1 100 1005 00        1484         MLR     (1),(1),,1         * MOVE
   001753    3 00001 0 0 0 0004       1485         ADSC9   PACW,0,4,PR3         *  PA CONTROL WORD OF NEW PA
   001754    7 00742 0 0 0 0004       1486         ADSC9   NPARCW,0,4,PR7       *   TO WORKSPACE
                                      1487  *  UPDATE RC AND RS PTRS IN OUT REC VAR FOR NEW PA
   001755    7 00006 2271 12          1488         LDX     X7,RCPTR,X2,PR7  GET RC PTR OF OLD PA
   001756    7 00006 7471 11          1489         STX     X7,RCPTR,X1,PR7  SAVE IN REC VAR FOR NEW PA
   001757    7 00004 7251 12          1490         LXL     X5,RSPTR,X2,PR7  GET RS PTR OF OLD PA
   001760    7 00004 4451 11          1491         SXL     X5,RSPTR,X1,PR7  SAVE IN REC VAR FOR NEW
                                      1492  *  CALCULATE SIZE OF AN ENTRY IN A POINTER GROUP
   001761    6 00007 2351 15          1493         LDA     CSMPP,X5,PR6    GET PTR SIZE FROM EIS DESCRIP IN RS
   001762    007777 3750 07           1494         ANA     =O7777,DL       ISOLATE
   001763    000002 0350 07           1495         ADLA    =O2,DL          ADD 2 FOR TYPE FIELD
   001764    7 00725 7551 00          1496         STA     ESZ,,PR7        SAVE - NEED IT LATER FOR MOVING PTR GROUP
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               50   BMAP - B00     
                                      1497  *  KEEP COUNT OF NEW NO. OF ENTRIES IN EACH PA REC
   001765    7 00741 2231 00          1498         LDX     X3,OPARCW,,PR7  GET NO OF ENTRIES IN OLD PA
   001766    000000 6240 13           1499         EAX     X4,0,X3         SET X4 = NO. OF ENTRIES IN OLD
   001767    7 00742 2261 00          1500         LDX     X6,NPARCW,,PR7  SET X6 = NO. OF ENTRIES IN NEW
   001770    017777 3630 03           1501         ANX     X3,.NOENT,DU    ISOLATE
   001771    000001 1030 03           1502         CMPX    X3,1,DU         IS THERE ONLY 1 ENTRY IN PA REC TO BE SPL
   001772 (0)002002 6010 00           1503         TNZ     MTONE           NO
   001773 (0)002653 7010 00           1504         DBCAL   ZIG$DBSPG,,SPGE1   YES - GO SPLIT PTR GRP IF THERE IS ONE
   001774 (0)002313 7020 00
   001775    5 00006 2341 00
   001776    777776 6010 04
   001777    000001 6210 00           1505         EAX     X1,1
   002000    7 00641 4411 00          1506         SXL     X1,PGSPLT,,PR7  SET INDIC. = PTR GRP SPLIT OCCURRED
   002001 (0)002262 7100 00           1507         TRA     CMR
   002002                             1508  MTONE  NULL
   002002    000000 6360 13           1509         EAQ     0,X3
   002003    000001 6230 13           1510         EAX     X3,1,X3         INCREMENT NO. OF ENTRIES BY 1
                                      1511  *  CALCULATE OFFSET OF LAST ENTRY +1 IN PA REC
   002004    6 77776 2351 17          1512         LDA     CSPES,X7,PR6    GET SIZE OF ENTRY
   002005    777777 3750 07           1513         ANA     -1,DL           ISOLATE
   002006    7 00717 7551 00          1514         STA     ENTSZ,,PR7      SAVE
   002007    000022 7350 00           1515         ALS     18
   002010    7 00743 5511 60          1516         STBA    SOE,60,PR7
   002011    000022 7720 00           1517         QRL     18
   002012    7 00717 4021 00          1518         MPY     ENTSZ,,PR7      MULTIPLY NO. OF ENTRIES BY ENTRY SIZE
   002013    000000 6210 06           1519         EAX     X1,,QL
   002014    6 77776 0211 17          1520         ADLX    X1,CSPSB,X7,PR6  SET X1 = OFFSET OF LAST ENTRY +1 IN PA
                                      1521  *  CALCULATE NO. OF ENTRIES TO MOVE FROM OLD TO NEW
   002015    7 00742 7201 00          1522         LXL     X0,NPARCW,,PR7  GET SPACE AVAIL IN NEW PA
   002016    7 00744 7401 00          1523         STX     X0,SPCAVN,,PR7  SAVE
   002017    7 00741 7201 00          1524         LXL     X0,OPARCW,,PR7  GET SPACE AVAIL IN OLD PA
   002020    7 00744 4401 00          1525         SXL     X0,SPCAVO,,PR7  SAVE
   002021                             1526  CLP    NULL                    LOOP TO CALCULATE THE NO. OF ENTRIES TO M
   002021    000002 1030 03           1527         CMPX    X3,2,DU         IS THERE ONLY 1 ENTRY LEFT IN OLD
   002022 (0)002073 6000 00           1528         TZE     MVENT           YES - DONT MOVE IT
   002023    7 00744 7201 00          1529         LXL     X0,SPCAVO,,PR7  GET CURRENT SPACE AVAILABLE IN OLD
   002024    7 00744 1001 00          1530         CMPX    X0,SPCAVN,,PR7  COMPARE SPACE AVAIL IN OLD AGAINST
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               51   BMAP - B00     
                                      1531  *                                 SPACE AVAIL IN NEW
   002025 (0)002073 6050 00           1532         TPL     MVENT           SPACE IN OLD >= SPACE IN NEW
                                      1533  *                                THUS CUT OFF PT IS FOUND
   002026    7 00743 0201 00          1534         ADLX    X0,SOE,,PR7     ADD ENTRY SIZE TO SPACE AVAIL IN OLD
   002027    7 00744 4401 00          1535         SXL     X0,SPCAVO,,PR7  SAVE AS CURR SPACE AVAIL IN OLD PA
   002030    7 00744 2201 00          1536         LDX     X0,SPCAVN,,PR7  GET SPACE AVAIL IN NEW PA REC
   002031    7 00743 1201 00          1537         SBLX    X0,SOE,,PR7     SUB ENTRY SIZE FROM SPACE AVAIL IN NEW
   002032 (0)002303 6040 00           1538         TMI     PASPE           ERROR
   002033    7 00744 7401 00          1539         STX     X0,SPCAVN,,PR7  SAVE AS CURR SPACE AVAIL IN NEW PA
   002034    7 00743 1211 00          1540         SBLX    X1,SOE,,PR7     X1 = OFST OF CURRENT ENTRY
   002035    7 00002 4735 12          1541         LDP     PR3,RADDR,X2,PR7  RESET PR3 = ADDRESS OF OLD PA
   002036    3 00000 5005 11          1542         A9BD    ,X1,PR3         SET PR3 = ADDRESS OF ENTRY
                                      1543  *  MOVE ENTRY INDICATOR TYPE TO WORKSPACE
   002037    000 1 100 1005 00        1544         MLR     (1),(1),,1         * MOVE
   002040    3 00000 0 0 0 0002       1545         ADSC9   0,0,2,PR3            *  INDICATOR
   002041    7 00716 4 0 0 0002       1546         ADSC9   ENIND,2,2,PR7        *   TO WORKSPACE
   002042    7 00716 7201 00          1547         LXL     X0,ENIND,,PR7   GET INDICATOR
   002043 (0)002067 6050 00           1548         TPL     NPG
                                      1549  *
                                      1550  *
                                      1551  *
                                      1552  *  POINTER GROUP PRESENT - NEED TO CALCULATE SIZE OF GROUP
                                      1553  *
                                      1554  *  MOVE PTR GROUP OFFSET TO WORKSPACE
   002044    000 1 100 1015 20        1555         MRL     (1,,1),(1),,1      * MOVE
   002045    6 00007 0001 15          1556         ARG     CSMPP,X5,PR6       *   OFFSET OF PTR GROUP
   002046    7 00730 0 0 0 0004       1557         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   002047    7 00730 2351 00          1558         LDA     MEMPTR,,PR7
                                      1559  *  MOVE NO. OF PTRS IN PTR GROUP TO WORKSPACE
   002050    7 00002 4735 12          1560         LDP     PR3,RADDR,X2,PR7  RESET PR3 = ADDRESS OF PA
   002051    000 1 100 1005 05        1561         MLR     (1,,,AL),(1),,1    * MOVE
   002052    3 00000 0 0 0 0002       1562         ADSC9   0,0,2,PR3            *  NO. OF PTRS IN PTR GROUP
   002053    7 00711 0 0 0 0002       1563         ADSC9   NOPTRS,0,2,PR7       *   TO WORKSPACE
   002054    7 00711 2361 00          1564         LDQ     NOPTRS,,PR7     GET NO. OF PTRS IN GROUP
   002055    000022 7720 00           1565         QRL     18              INTO QL FOR MULTIPLY
   002056    7 00725 4021 00          1566         MPY     ESZ,,PR7        MULTIPLY BY SIZE OF ENTRY IN GROUP
   002057    000002 6360 06           1567         EAQ     2,QL            ADD 2 FOR NO. OF PTRS FLD
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               52   BMAP - B00     
   002060    7 00724 5521 60          1568         STBQ    PTRESZ,60,PR7   SAVE
   002061    7 00744 7201 00          1569         LXL     X0,SPCAVO,,PR7  GET SPACE AVAIL IN OLD PA
   002062    7 00724 0201 00          1570         ADLX    X0,PTRESZ,,PR7  ADD SIZE OF PTR GROUP
   002063    7 00744 4401 00          1571         SXL     X0,SPCAVO,,PR7  SAVE
   002064    7 00744 2201 00          1572         LDX     X0,SPCAVN,,PR7  GET SPACE AVAIL IN NEW PA
   002065    7 00724 1201 00          1573         SBLX    X0,PTRESZ,,PR7  SUBTRACT SIZE OF PTR GROUP
   002066    7 00744 7401 00          1574         STX     X0,SPCAVN,,PR7  SAVE
   002067                             1575  NPG    NULL
   002067    777777 6240 14           1576         EAX     X4,-1,X4        DECREMENT CNT OF ENTRIES IN OLD PA
   002070    000001 6260 16           1577         EAX     X6,1,X6         INCREMENT CNT OF ENTRIES IN NEW PA
   002071    777777 6230 13           1578         EAX     X3,-1,X3        X3 = 1ST ENTRY NO. TO MOVE TO NEW PA
   002072 (0)002021 7100 00           1579         TRA     CLP             GO CHECK IF PREVIOS ENTRY CAN BE MOVED
   002073                             1580  MVENT  NULL
                                      1581  *
                                      1582  *  MOVE ENTRIES FROM OLD PA TO NEW PA
                                      1583  *
                                      1584  *  X3 CONTAINS THE FIRST ENTRY NUMBER TO BE MOVED TO NEW PA.
                                      1585  *  X1 IS THE OFFSET OF THE FIRST ENTRY TO BE MOVED.
   002073    7 00740 7431 00          1586         STX     X3,FETM,,PR7    SAVE ENTRY NO. OF FIRST TO MOVE
                                      1587  *  CALCULATE SIZE OF MOVE
                                      1588  *     SIZE = (PREVIOUS NO. OF ENTRIES IN OLD PA - 1ST
                                      1589  *             ENTRY NO. TO MOVE - 1)(ENTRY SIZE)
   002074    7 00741 2231 00          1590         LDX     X3,OPARCW,,PR7  GET NO. OF ENTRIES IN OLD
   002075    017777 3630 03           1591         ANX     X3,.NOENT,DU    ISOLATE
   002076    7 00740 1231 00          1592         SBLX    X3,FETM,,PR7    SUB ENTRY NO. OF FIRST TO MOVE
   002077    000001 6360 13           1593         EAQ     1,X3
   002100    000022 7720 00           1594         QRL     18              INTO QL FOR MULTIPLY
   002101    7 00717 4021 00          1595         MPY     ENTSZ,,PR7      MULT BY ENTRY SIZE TO GET SIZE OF MOVE
                                      1596  *  UPDATE THE PA CONTROL WORD FOR BOTH OLD AND NEW PA RECORDS
   002102    7 00741 7441 00          1597         STX     X4,OPARCW,,PR7  SAVE NO. OF ENTRIES LEFT IN OLD PA
   002103    7 00742 7461 00          1598         STX     X6,NPARCW,,PR7  SAVE NO. OF ENTRIES MOVED TO NEW
   002104    7 00744 2241 00          1599         LDX     X4,SPCAVN,,PR7  GET SPACE AVAIL LEFT IN NEW PA
   002105    7 00742 4441 00          1600         SXL     X4,NPARCW,,PR7  SAVE IN TEMP SPACE FOR CONTROL WORD
   002106    7 00744 7241 00          1601         LXL     X4,SPCAVO,,PR7  GET NEW SPACE AVAIL IN OLD PA
   002107    7 00741 4441 00          1602         SXL     X4,OPARCW,,PR7  SAVE IN TEMP SPACE FOR CONTROL WORD
                                      1603  *  MOVE LAST IN LEVEL INDICATOR FROM OLD PA REC
                                      1604  *  TO NEW PA REC
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               53   BMAP - B00     
   002110    0 00 03 1 100 0605 00    1605         CSL     (1),(1),03,,1      * MOVE
   002111    7 00741 0 03 0001        1606         BDSC    OPARCW,1,0,3,PR7     *  LAST IN LEVEL INDIC.
   002112    7 00742 0 03 0001        1607         BDSC    NPARCW,1,0,3,PR7     *   TO NEW PA REC
                                      1608  *  MOVE NOT LOWEST LEVEL INDICATOR FROM OLD PA
                                      1609  *  REC TO NEW PA REC
   002113    0 00 03 1 100 0605 00    1610         CSL     (1),(1),03,,1      * MOVE
   002114    7 00741 0 00 0001        1611         BDSC    OPARCW,1,0,0,PR7     *  NOT LOWEST LEVEL INDIC.
   002115    7 00742 0 00 0001        1612         BDSC    NPARCW,1,0,0,PR7     *   TO NEW PA REC
                                      1613  *  CLEAR LAST IN LEVEL INDICATOR IN OLD PA REC -
                                      1614  *  BECAUSE OF THE SPLIT IT IS NO LONGER LAST IN
                                      1615  *  LEVEL
   002116    0 00 00 0 100 0604 00    1616         CSL     ,(1),00            * CLEAR
   002117    000000 0 00 0000         1617         BDSC    0,0,0              *  LAST IN LEVEL INDIC.
   002120    7 00741 0 03 0001        1618         BDSC    OPARCW,1,0,3,PR7     *   IN OLD PA REC
                                      1619  *  MOVE NO. OF ENTRIES FROM OLD PA REC TO NEW PA REC.
   002121    7 00513 2201 00          1620         LDX     X0,RVPA,,PR7
   002122    7 00510 2221 00          1621         LDX     X2,RVI,,PR7
   002123    7 00002 4735 12          1622         LDP     PR3,RADDR,X2,PR7  GET ADDRESS OF OLD PA REC
   002124    7 00002 4745 10          1623         LDP     PR4,RADDR,X0,PR7  GET ADDRESS OF NEW PA REC
   002125    6 77776 2231 17          1624         LDX     X3,CSPSB,X7,PR6  STARTING BYTE (OFST OF WHERE TO MOVE
                                      1625  *                                  ENTRIES TO IN NEW PA REC)
   002126    000 1 153 1005 51        1626         MLR     (1,1,,1),(1,1,,3),,1  * MOVE
   002127    3 00000 0 0 0 0006       1627         ADSC9   0,0,QL,PR3              *  PA ENTRIES FROM OLD PA REC
   002130    4 00000 0 0 0 0006       1628         ADSC9   0,0,QL,PR4              *   TO NEW
                                      1629  *  CHECK EACH ENTRY MOVED TO DETERMINE IF A POINTER GROUP
                                      1630  *  IS PRESENT.  IF IT IS, NEED TO MOVE THE POINTER GROUP
                                      1631  *  TO THE NEW PA RECORD ALSO AND UPDATE THE OFFSETS TO THE
                                      1632  *  POINTERS IN THE ENTRY.
   002131                             1633  CEFPG  NULL
   002131    000000 6360 11           1634         EAQ     ,X1             INIT QR = ENTRY OFFSET IN OLD PA
   002132    000022 7720 00           1635         QRL     18              INTO QL
   002133    7 00742 2211 00          1636         LDX     X1,NPARCW,,PR7  GET NO. OF ENTRIES IN NEW PA
   002134    017777 3610 03           1637         ANX     X1,.NOENT,DU    ISOLATE
   002135    7 00726 7411 00          1638         STX     X1,NUMENT,,PR7  SAVE
   002136    7 00513 2231 00          1639         LDX     X3,RVPA,,PR7
   002137    7 00003 2241 13          1640         LDX     X4,RECSZ,X3,PR7  INIT OFST OF NEXT PTR GROUP IN NEW PA
   002140    7 00006 2271 13          1641         LDX     X7,RCPTR,X3,PR7  GET RC PTR FOR PA REC
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               54   BMAP - B00     
   002141    000000 6210 00           1642         EAX     X1,0            INIT ENTRY NO.
   002142    6 77776 2351 17          1643         LDA     CSPSB,X7,PR6    INIT ENTRY OFST IN NEW = STARTING BYTE
   002143    000022 7710 00           1644         ARL     18
   002144                             1645  MPTRSL NULL
   002144    7 00726 1011 00          1646         CMPX    X1,NUMENT,,PR7  ARE THE ENTRIES DONE
   002145 (0)002250 6030 00           1647         TRC     MUPACW          YES - GO MOVE UPDATED PA CONTROL WORD
   002146    7 00510 2231 00          1648         LDX     X3,RVI,,PR7
   002147    7 00004 7251 13          1649         LXL     X5,RSPTR,X3,PR7  GET RS PTR
   002150    7 00002 4735 13          1650         LDP     PR3,RADDR,X3,PR7  RESET PR3 = ADDR OF OLD PA REC
   002151    3 00000 5005 06          1651         A9BD    ,QL,PR3         SET PR3 = ADDR OF NEXT ENTRY IN OLD
                                      1652  *  MOVE TYPE FIELD AND PTR GROUP INDICATOR TO WORKSPACE
   002152    000 1 100 1005 00        1653         MLR     (1),(1),,1         * MOVE
   002153    3 00000 0 0 0 0002       1654         ADSC9   0,0,2,PR3            *  TYPE FIELD AND INDIC. FROM PA ENTRY
   002154    7 00727 4 0 0 0002       1655         ADSC9   MEMTYP,2,2,PR7       *   TO WORKSPACE
   002155    7 00727 7201 00          1656         LXL     X0,MEMTYP,,PR7  GET PTR INDIC. FROM ENTRY
   002156 (0)002163 6040 00           1657         TMI     PGRPP           POINTER GROUP PRESENT - GO MOVE IT
                                      1658  *  NO POINTER GROUP IS PRESENT.  INCREMENT ENTRY NO. AND
                                      1659  *  ENTRY OFFSET TO POINT TO NEXT ENTYR IN NEW PA RECORD
                                      1660  *  THEN GO CHECK NEXT ENTRY FOR A POINTER GROUP.
   002157                             1661  NPGP   NULL
   002157    000001 6210 11           1662         EAX     X1,1,X1         INCREMENT ENTRY NO. BY 1
   002160    7 00717 0351 00          1663         ADLA    ENTSZ,,PR7      INCREMENT ENTRY OFFSET IN NEW BY ENTRY SI
   002161    7 00717 0361 00          1664         ADLQ    ENTSZ,,PR7      INCREMENT ENTRY OFST IN OLD BY ENTRY SIZE
   002162 (0)002144 7100 00           1665         TRA     MPTRSL
                                      1666  *
                                      1667  *
                                      1668  *  THERE IS A POINTER GROUP PRESENT FOR THE CURRENT ENTRY.
                                      1669  *  NEED TO MOVE THE POINTER GROUP FROM THE OLD PA RECORD
                                      1670  *  TO THE NEW PA RECORD, CHANGE THE OFFSET TO THE POINTER
                                      1671  *  GROUP IN THE NEW PA RECORD, AND THEN REMOVE THE POINTER
                                      1672  *  GROUP OCCURRENCE FROM THE OLD PA RECORD.
   002163                             1673  PGRPP  NULL
   002163    7 00723 5511 14          1674         STBA    CPTRO,14,PR7    SAVE OFFSET OF ENTRY IN NEW
   002164    7 00722 5521 14          1675         STBQ    CENTRO,14,PR7   SAVE OFFSET OF ENTRY IN OLD
   002165    7 00510 2201 00          1676         LDX     X0,RVI,,PR7
   002166    7 00002 4745 10          1677         LDP     PR4,RADDR,X0,PR7  SET PR4 = ADDR OF OLD PA
   002167    000 1 100 1015 20        1678         MRL     (1,,1),(1),,1      * MOVE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               55   BMAP - B00     
   002170    6 00007 0001 15          1679         ARG     CSMPP,X5,PR6       *  OFFSET OF POINTER GROUP FROM PA ENT
   002171    7 00730 0 0 0 0004       1680         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   002172    7 00730 7221 00          1681         LXL     X2,MEMPTR,,PR7  GET OFFSET OF PTR GROUP IN OLD PA
                                      1682  *  CALCULATE SIZE OF PTR GROUP
   002173    000 1 100 1005 12        1683         MLR     (1,,,2),(1),,1     * MOVE
   002174    4 00000 0 0 0 0002       1684         ADSC9   0,0,2,PR4            *  NO. OF PTRS IN PTR GROUP
   002175    7 00711 0 0 0 0002       1685         ADSC9   NOPTRS,0,2,PR7       *   TO WORKSPACE
   002176    7 00711 2361 00          1686         LDQ     NOPTRS,,PR7     GET NO. OF PTRS IN GROUP
   002177    000022 7720 00           1687         QRL     18              INTO QL FOR MULTIPLY
   002200    7 00725 4021 00          1688         MPY     ESZ,,PR7        MULTIPLY BY SIZE OF ENTRY IN A PTR GRP
   002201    000002 6360 06           1689         EAQ     2,QL            ADD 2 FOR NO. OF PTRS FLD
   002202    7 00724 5521 60          1690         STBQ    PTRESZ,60,PR7   SAVE
   002203    7 00724 1241 00          1691         SBLX    X4,PTRESZ,,PR7  SET X4 = OFST IN NEW PA REC FOR PTR GRP
   002204    7 00730 4501 00          1692         STZ     MEMPTR,,PR7
   002205    7 00730 4441 00          1693         SXL     X4,MEMPTR,,PR7
                                      1694  *
                                      1695  *
                                      1696  *  UPDATE OFFSET OF POINTER GROUP IN ENTRY OF NEW PA
                                      1697  *  RECORD AND MOVE POINTER GROUP FROM OLD PA
                                      1698  *  RECORD TO NEW PA RECORD.  IF TDS, NEED TO SET UP
                                      1699  *  DESCRIPTORS TO PERFORM THESE MODIFICATIONS.
                                      1700  *
                                      1701  *
                                      1702  *
                                      1703  *  BATCH - DO MOVES DIRECTLY
                                      1704  *
                                      1705  *  MOVE POINTER GROUP FROM OLD PA RECORD TO NEW
                                      1706  *  PA RECORD
   002206    7 00513 2231 00          1707         LDX     X3,RVPA,,PR7
   002207    7 00002 4735 13          1708         LDP     PR3,RADDR,X3,PR7  GET ADDRESS OF NEW PA RECORD
   002210    000 1 154 1005 52        1709         MLR     (1,1,,2),(1,1,,4),,1  * MOVE
   002211    4 00000 0 0 0 0002       1710         ADSC9   0,0,QU,PR4              *  PTR GROUP FROM OLD PA REC
   002212    3 00000 0 0 0 0002       1711         ADSC9   0,0,QU,PR3              *   TO NEW PA REC
                                      1712  *  UPDATE OFFSET OF PTR GROUP IN NEW PA RECORD SINCE
                                      1713  *  THE POINTER GROUP HAS BEEN MOVED AND IS PROBABLY NOT
                                      1714  *  IN THE SAME LOCATION AS IT WAS IN THE OLD PA RECORD
   002213    7 00723 7201 00          1715         LXL     X0,CPTRO,,PR7   GET OFFSET OF ENTRY
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               56   BMAP - B00     
   002214    3 00000 5005 10          1716         A9BD    ,X0,PR3         SET PR3 = ADDR OF CURR ENTRY
   002215    000 0 120 1015 00        1717         MRL     (1),(1,,1),,0      * MOVE
   002216    7 00730 0 0 0 0004       1718         ADSC9   MEMPTR,0,4,PR7       *  NEW OFST OF PTR GROUP
   002217    6 00007 0001 15          1719         ARG     CSMPP,X5,PR6       *   TO PA ENTRY IN NEW
                                      1720  *
                                      1721  *
                                      1722  *  DELETE POINTER GROUP FROM OLD PA RECORD
   002220                             1723  DPGOP  NULL
   002220    7 00723 7411 00          1724         STX     X1,CPTRN,,PR7   SAVE CURRENT ENTRY NO.
   002221    7 00510 2351 00          1725         LDA     RVI,,PR7        *
   002222    7 00513 2361 00          1726         LDQ     RVPA,,PR7       *  REVERSE
   002223    7 00513 7551 00          1727         STA     RVPA,,PR7       *   INPUT AND PA RECORD VARIABLES
   002224    7 00510 7561 00          1728         STQ     RVI,,PR7        *
                                      1729  *  SET AP ARGUMENTS FOR CALL
   002225    7 00724 2361 00          1730         LDQ     PTRESZ,,PR7     SET QR = SIZE OF PTR GROUP TO DELETE
   002226    000022 7720 00           1731         QRL     18              INTO QL
   002227    7 00746 7561 00          1732         STQ     PGSIZE,,PR7     SAVE SIZE OF PTR GROUP
   002230    000000 6350 12           1733         EAA     ,X2             SET AR = OFFSET OF PTR GROUP TO DELETE
   002231    000022 7710 00           1734         ARL     18              INTO AL
   002232 (0)004047 7010 00           1735         ICCAL   ZIG$DBADP,,DPER2   DELETE PTR GROUP
   002233 (0)002313 7020 00
   002234    5 00006 2341 00
   002235    777776 6010 04
   002236    7 00510 2351 00          1736         LDA     RVI,,PR7        *
   002237    7 00513 2361 00          1737         LDQ     RVPA,,PR7       *  REVERSE
   002240    7 00513 7551 00          1738         STA     RVPA,,PR7       *   INPUT AND PA RECORD VARIABLES
   002241    7 00510 7561 00          1739         STQ     RVI,,PR7        *
   002242    7 00723 2211 00          1740         LDX     X1,CPTRN,,PR7   GET CURRENT ENTRY NUMBER
   002243    7 00723 2351 00          1741         LDA     CPTRO,,PR7      GET CURRENT ENTRY OFFSET IN NEW
   002244    777777 3750 07           1742         ANA     -1,DL           ISOLATE
   002245    7 00722 2361 00          1743         LDQ     CENTRO,,PR7     GET CURRENT OFST IN OLD
   002246    777777 3760 07           1744         ANQ     -1,DL           ISOLATE
   002247 (0)002157 7100 00           1745         TRA     NPGP            GO UPDATE CURR ENTRY NO. & OFST
                                      1746  *
                                      1747  *
   002250                             1748  MUPACW NULL
                                      1749  *  MOVE UPDATED PA CONTROL WORDS TO THE PA RECORDS IN THE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               57   BMAP - B00     
                                      1750  *  PAGE BUFFERS.
   002250    7 00510 2201 00          1751         LDX     X0,RVI,,PR7
   002251    7 00002 4735 10          1752         LDP     PR3,RADDR,X0,PR7  GET ADDRESS OF OLD PA RECORD
   002252    7 00513 2211 00          1753         LDX     X1,RVPA,,PR7
   002253    7 00002 4745 11          1754         LDP     PR4,RADDR,X1,PR7  GET ADDRESS OF NEW PA REC
   002254    000 1 100 1005 00        1755         MLR     (1),(1),,1         * MOVE
   002255    7 00741 0 0 0 0004       1756         ADSC9   OPARCW,0,4,PR7       *  UPDATED PA CONTROL WORD OF OLD PA
   002256    3 00001 0 0 0 0004       1757         ADSC9   PACW,0,4,PR3         *   TO OLD PA RECORD
   002257    000 1 100 1005 00        1758         MLR     (1),(1),,1         * MOVE
   002260    7 00742 0 0 0 0004       1759         ADSC9   NPARCW,0,4,PR7       *  UPDATED PA CONTROL WORD OF NEW PA
   002261    4 00001 0 0 0 0004       1760         ADSC9   PACW,0,4,PR4         *   TO NEW PA REC
                                      1761  *
                                      1762  *
                                      1763  *  CORRECT THE PA PTR IN ALL MEMBER RECORDS WHOSE ENTRIES WERE
                                      1764  *  MOVED TO THE NEW PA RECORD
   002262                             1765  CMR    NULL
                                      1766  *  LOCK BUFFER OF NEW PA RECORD
   002262    7 00513 2231 00          1767        LOCK    RVPA
   002263  X 000000 7010 00
   002264    000000 0020 00
   002265 (0)000000 7010 00           1768         DBCAL   ZIG$DBACM,,CMER1   CORRECT PA PTRS IN MEMBER RECORDS
   002266 (0)002311 7020 00
   002267    5 00006 2341 00
   002270    777776 6010 04
                                      1769  *
                                      1770  *     NOTE: NEW PA REC STILL LOCKED
                                      1771  *     IT WILL BE UNLOCKED LATER AFTER ZIG$DBPFD CALLED
                                      1772  *
   002271    7 00510 2371 00          1773         LDAQ    RVI,,PR7        *
   002272    7 00511 7551 00          1774         STA     RVO,,PR7        *  SWITCH
   002273    7 00510 7561 00          1775         STQ     RVI,,PR7        *   IN REC VAR AND OUT REC VAR
   002274    7 00511 2351 00          1776         LDA     RVO,,PR7        *
   002275    7 00513 2361 00          1777         LDQ     RVPA,,PR7       *  SWITCH
   002276    7 00513 7551 00          1778         STA     RVPA,,PR7       *   OUT REC VAR AND PA REC VAR
   002277    7 00511 7561 00          1779         STQ     RVO,,PR7        *
                                      1780  *
                                      1781  *     NOTE: OLD PA REC STILL REMAINED UNLOCKED
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               58   BMAP - B00     
                                      1782  *     IT WILL BE UNLOCKED UNTIL THE NEW ENTRY IS STORED
                                      1783  *
                                      1784  * RESET INDICATOR TO USE PA RECORDS IF PA SET
   002300    000000 6210 00           1785         EAX     X1,0
   002301    7 00735 4411 00          1786         SXL     X1,DUSEPA,,PR7  RESET INDIC. TO USE PA
                                      1787  *  RETURN
   002302  X 000000 7020 00           1788         DBRET                   NORMAL RETURN
                                      1789  *
                                      1790  *  ERRORS DETECTED IN THIS PRIMITIVE
                                      1791  *
   002303                             1792  PASPE  NULL                    SPACE AVAILABLE ERROR IN PA REC
   002303    303343 2350 07           1793         LDA     PAER6,DL
   002304    7 00513 2271 00          1794         LDX     X7,RVPA,,PR7
   002305    7 00006 2271 10          1795         LDX     X7,RCPTR,X0,PR7  GET RC PTR
   002306    000000 6200 00           1796         EAX     X0,0            NULL AC PTR
   002307    000000 6260 00           1797         EAX     X6,0            NULL SC PTR
   002310 (0)002317 7100 00           1798         TRA     SPCER
                                      1799  *  ERRORS DETECTED IN SUBORDINATE ROUTINES
   002311                             1800  CMER1  NULL                    ERROR UPDATING PA PTRS IN MEMBER RECS
   002311    7 00644 7551 00          1801         STA     PRSTS,,PR7      SAVE STATUS
   002312                             1802  ULKRE6 NULL
   002312 (0)002317 7100 00           1803         TRA     SPCER
                                      1804  *
                                      1805  *  ERRORS DETECTED IN SUBORDINATE ROUTINES
                                      1806  *    (WHILE BUFFER OF NEW PA REC IS UNLOCKED)
                                      1807  *
   002313                             1808  CPAE2  NULL                    ERROR CREATING NEW PA RECORD
   002313                             1809  CPAE3  NULL                    ERROR CREATING NEW PA RECORD
   002313                             1810  FOER1  NULL                    ERROR FINDING OWNER OF PA SET
   002313                             1811  DPAE2  NULL                    ERROR DISCONNECTING OLD HI LEVEL PA
   002313                             1812  IDER2  NULL                    ERROR INSERTING DUMMY ENTRY IN NEW HI LEV
   002313                             1813  DPER2  NULL                    ERROR DELETING PTR GROUP FROM OLD PA REC
   002313                             1814  SPGE1  NULL                    ERROR SPLITTING PTR GROUP
   002313 (0)002317 7100 00           1815         TRA     SPCER
                                      1816  *
                                      1817  *  ERRORS DETECTED IN I/O ROUTINES
                                      1818  *
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT A POINTER ARRAY RECORD                               59   BMAP - B00     
   002314                             1819  LKRE2  NULL                    ERROR LOCKING BUFFER OF OLD PA
   002314                             1820  ULKRE2 NULL                    ERROR UNLOCKING BUFFER OF OLD PA
   002314                             1821  LKRE4  NULL                    ERROR LOCKING BUF OF NEW PA
   002314                             1822  ULKRE5 NULL                    ERROR UNLOCKING BUF OF NEW PA
   002314    000000 6260 00           1823         EAX     X6,0            NULL SC PTR
   002315    000000 6270 00           1824         EAX     X7,0            NULL RC PTR
   002316 (0)002317 7100 00           1825         TRA     SPCER
                                      1826  *
                                      1827  *
                                      1828  *  COMMON ERROR RETURN
   002317                             1829  SPCER  NULL
   002317  X 000000 7020 00           1830         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     60   BMAP - B00     
                                      1831         TTLS    CREATE DUPLICATE ENTRY
                                      1832  *
                                      1833  *  CREATE DUPLICATE ENTRY
                                      1834  *
                                      1835  *
                                      1836  *    THIS ROUTINE WILL STORE A PTR IN A POINTER GROUP
                                      1837  *    FOR THE CURRENT RECORD WHICH IS EITHER A DUPLICATE
                                      1838  *    OF THE NEXT OR PRIOR RECORD IN THE PA SET.  IF A
                                      1839  *    POINTER GROUP DOES NOT CURRENTLY EXIST FOR THE
                                      1840  *    NEXT/PRIOR RECORD, THE ROUTINE WILL CREATE A NEW
                                      1841  *    POINTER GROUP HAVING TWO POINTERS.  IF A POINTER
                                      1842  *    GROUP ALREADY EXISTS FOR THE NEXT/PRIOR, IT WILL ADD
                                      1843  *    ANOTHER POINTER TO THE GROUP FOR THE CURRENT RECORD.
                                      1844  *
                                      1845  *    THE ROUTINE WILL INSERT THE POINTERS IN THE CORRECT
                                      1846  *    SEQUENCE DEPENDING ON WHETHER THE CURRENT IS A DUPLICATE
                                      1847  *    OF THE NEXT OR PRIOR.  IF THE CURR IS A DUPLICATE OF
                                      1848  *    THE PRIOR, IT WILL INSERT THE PTR FOR THE CURR AFTER
                                      1849  *    THE PRIOR'S PTR IN THE PTR GROUP.  IF THE CURR IS A
                                      1850  *    DUPLICATE OF THE NEXT,  IT WILL INSERT THE PTR FOR
                                      1851  *    THE CURR BEFORE THE NEXT'S PTR IN THE POINTER GROUP.
                                      1852  *
                                      1853  *    INPUT ARGUMENTS:
                                      1854  *      RVPA - (PA REC IN WHICH TO CREATE DUPLICATE)
                                      1855  *             DBK
                                      1856  *             RECORD ADDRESS
                                      1857  *             BUFFER ADDRESS
                                      1858  *             AC PTR
                                      1859  *             RC PTR
                                      1860  *             RS PTR
                                      1861  *             SC PTR
                                      1862  *
                                      1863  *      RVI - PRIOR OR NEXT RECORD IN PA SET
                                      1864  *            DBK
                                      1865  *            DBK OF PA OWNER
                                      1866  *            PA ENTRY OFFSET
                                      1867  *            PA POINTER OFFSET
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     61   BMAP - B00     
                                      1868  *
                                      1869  *      RVT - CURR REC (REC TO CREATE DUPLICATE FOR)
                                      1870  *            DBK
                                      1871  *
                                      1872  *      PADUP - PA DUPLICATE INDICATOR
                                      1873  *              NEGATIVE = CURR IS A DUPLICATE OF PRIOR
                                      1874  *              POSITIVE = CURR IS A DUPLICATE OF NEXT
                                      1875  *
                                      1876  *    OUTPUT ARGUMENTS:
                                      1877  *      RVT - DBK OF CURR
                                      1878  *            DBK OF PA OWNER
                                      1879  *            PA ENTRY OFFSET
                                      1880  *            PA POINTER OFFSET
                                      1881  *
                                      1882  *      DUPLICATE PTR (PTR TO CURR) IS PUT IN PA REC
                                      1883  *
   002320                             1884  ZIG$DBCDP NULL
   002320  X 000000 7000 00           1885         DBSAV
   002321    000004 000000
                                      1886  *  MOVE POINTER ARRAY CONTROL WORD TO WORKSPACE
   002322    7 00513 2221 00          1887         LDX     X2,RVPA,,PR7
   002323    7 00002 4735 12          1888         LDP     PR3,RADDR,X2,PR7  GET ADDRESS OF PA REC
   002324    000 1 100 1005 00        1889         MLR     (1),(1),,1         * MOVE
   002325    3 00001 0 0 0 0004       1890         ADSC9   PACW,0,4,PR3         *  POINTER ARRAY CONTROL WORD
   002326    7 00714 0 0 0 0004       1891         ADSC9   PARCW,0,4,PR7        *   TO WORKSPACE
                                      1892  *  CALCULATE SIZE OF PTR IN PTR GROUP
   002327    7 00512 2211 00          1893         LDX     X1,RVT,,PR7
   002330    7 00004 7251 12          1894         LXL     X5,RSPTR,X2,PR7  GET RS PTR FOR PA REC
   002331    6 00007 2351 15          1895         LDA     CSMPP,X5,PR6    GET PTR SIZE FROM EIS DESCRIP
   002332    007777 3750 07           1896         ANA     =O7777,DL       ISOLATE
   002333    000002 0350 07           1897         ADLA    =O2,DL          ADD 2 FOR TYPE FIELD
   002334    000000 6200 05           1898         EAX     X0,,AL
   002335    7 00724 7401 00          1899         STX     X0,PTRESZ,,PR7  SAVE
                                      1900  *  SET ENTRY OFST OF CURR = ENTRY OFST OF NEXT/PRIOR
   002336    7 00510 2231 00          1901         LDX     X3,RVI,,PR7
   002337    7 00014 2201 13          1902         LDX     X0,CBRCE,X3,PR7  ENTRY OFST OF NEXT/PRIOR
   002340    7 00014 7401 11          1903         STX     X0,CBRCE,X1,PR7  SAVE AS ENTRY OFST OF CURR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     62   BMAP - B00     
                                      1904  *  SET PA REC OF NEW = PA REC OF NEXT/PRIOR
   002341    7 00000 2361 12          1905         LDQ     DBKEY,X2,PR7    GET DBK OF OWNER PA REC OF NEXT/PRIOR
   002342    7 00015 7561 11          1906         STQ     CBRPA,X1,PR7    SAVE AS OWNER PA REC OF CURR
                                      1907  *  TEST IF A POINTER GROUP ALREADY EXISTS.  IF IT DOES,
                                      1908  *  ONLY NEED TO ADD POINTER TO IT AND INCREMENT THE
                                      1909  *  NO. OF PTRS IN THE POINTER GROUP.  IF A POINTER GROUP
                                      1910  *  DOES NOT ALREADY EXIST,  NEED TO MODIFY ENTRY TO POINT
                                      1911  *  TO A PTR GROUP RATHER THAN A MEMBER AND CREATE A NEW
                                      1912  *  PTR GROUP HAVING TWO MEMBER PTRS.
   002343    7 00014 7211 13          1913         LXL     X1,CBRCP,X3,PR7  IS THERE A PTR GRP ALREADY
   002344 (0)002503 6010 00           1914         TNZ     ADPTR           YES - GO ADD ANOTHER PTR TO GROUP
                                      1915  *  PA KEY WAS UNIQUE.  NEED TO CREATE A NEW POINTER GROUP
                                      1916  *
                                      1917  *  CALCULATE SIZE OF PTR GROUP = 2 + 2(2 + PTR SIZE)
   002345    000001 7350 00           1918         ALS     1               MULTIPLY BY 2 SINCE 2 PTRS IN GROUP
   002346    000002 0350 07           1919         ADLA    2,DL            ADD 2 FOR NO. OF PTRS FLD
   002347    7 00720 7551 00          1920         STA     PTESZ,,PR7      SAVE
                                      1921  *  CALCULATE OFST OF NEW PTR GROUP
                                      1922  *    (OFST = STARTING BYTE + NO. OF ENTRIES * (ENTRY SIZE) + SPACE
                                      1923  *     AVAIL - SIZE OF PTR GROUP)
   002350    7 00006 2271 12          1924         LDX     X7,RCPTR,X2,PR7  GET RC PTR FOR PA REC
   002351    6 77776 2351 17          1925         LDA     CSPES,X7,PR6    GET ENTRY SIZE
   002352    777777 3750 07           1926         ANA     -1,DL           ISOLATE
   002353    7 00717 7551 00          1927         STA     ENTSZ,,PR7      SAVE
   002354    7 00714 2361 00          1928         LDQ     PARCW,,PR7      GET NO. OF ENTRIES
   002355    017777 3760 03           1929         ANQ     .NOENT,DU       ISOLATE NO. OF ENTRIES
   002356    000022 7720 00           1930         QRL     18              INTO QL FOR MULTIPLY
   002357    7 00717 4021 00          1931         MPY     ENTSZ,,PR7      MULTIPLY BY ENTRY SIZE
   002360    7 00720 1361 00          1932         SBLQ    PTESZ,,PR7      SUB SIZE OF PTR GROUP
   002361    000000 6210 06           1933         EAX     X1,,QL
   002362    6 77776 0211 17          1934         ADLX    X1,CSPSB,X7,PR6  ADD STARTING BYTE
   002363    7 00714 7231 00          1935         LXL     X3,PARCW,,PR7   GET SPACE AVAIL
   002364    7 00744 7431 00          1936         STX     X3,SPCAVN,,PR7  SAVE IN TEMP LOC
   002365    7 00744 0211 00          1937         ADLX    X1,SPCAVN,,PR7  ADD SPACE AVAIL
                                      1938  *  SET UP FIELDS FOR NEW ENTRY
   002366    7 00730 4501 00          1939         STZ     MEMPTR,,PR7
   002367    7 00730 4411 00          1940         SXL     X1,MEMPTR,,PR7  SAVE AS PTR IN ENTRY
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     63   BMAP - B00     
   002370    400000 6200 00           1941         EAX     X0,.B0          SET 1ST BIT ON TO INDICATE PTR GROUP
   002371    7 00727 4401 00          1942         SXL     X0,MEMTYP,,PR7  SAVE AS REC TYPE FIELD IN ENTRY
                                      1943  *  UPDATE OFFSET OF PRIOR REC
                                      1944  *    (NEW OFST OF PRIOR = OFST OF PTR GROUP + 2)
   002372    000002 0210 03           1945         ADLX    X1,2,DU
   002373    7 00510 2201 00          1946         LDX     X0,RVI,,PR7
   002374    7 00510 2231 00          1947         LDX     X3,RVI,,PR7
   002375    7 00014 4411 13          1948         SXL     X1,CBRCP,X3,PR7  SAVE NEW PTR OFST OF NEXT/PRIOR
                                      1949  *    (OFST OF NEW = OFST OF PTR GROUP + 2 + SIZE OF ENTRY IN PTR GRP)
   002376    7 00512 2201 00          1950         LDX     X0,RVT,,PR7
   002377    7 00724 0211 00          1951         ADLX    X1,PTRESZ,,PR7
   002400    7 00014 4411 10          1952         SXL     X1,CBRCP,X0,PR7  SAVE OFST OF CURR
                                      1953  *  SET NO. OF PTRS FIELD = 2
                                      1954  *  IF CURR IS A DUP OF NEXT, NEED TO SWITCH PTR OFFSETS
                                      1955  *  OF CURR AND NEXT SINCE CURR WILL BE FIRST IN PTR GROUP
   002401    7 00740 7211 00          1956         LXL     X1,PADUP,,PR7   IS CURR A DUP OF NEXT
   002402 (0)002407 6044 00           1957         TMOZ    SNOPF           NO - GO SET UP NO. OF PTRS FLD
   002403    7 00014 2351 13          1958         LDA     CBRCP,X3,PR7    * REVERSE
   002404    7 00014 2361 10          1959         LDQ     CBRCP,X0,PR7    *  PTR OFSTS OF
   002405    7 00014 7561 13          1960         STQ     CBRCP,X3,PR7    *   CURR AND NEXT
   002406    7 00014 7551 10          1961         STA     CBRCP,X0,PR7    *
   002407                             1962  SNOPF  NULL
   002407    000002 6210 00           1963         EAX     X1,2
   002410    7 00711 7411 00          1964         STX     X1,NOPTRS,,PR7
                                      1965  *  UPDATE SPACE AVAILABLE IN PA CONTROL WORD
   002411    7 00714 2351 00          1966         LDA     PARCW,,PR7      GET SPACE AVAIL
   002412    777777 3750 07           1967         ANA     -1,DL           ISOLATE
   002413    7 00720 1351 00          1968         SBLA    PTESZ,,PR7      SUBTRACT SIZE OF NEW PTR GROUP
   002414    7 00714 5511 14          1969         STBA    PARCW,14,PR7    SAVE IN PA CONTROL WORD
                                      1970  *
                                      1971  *
                                      1972  *  SET UP NEW PTR GROUP
                                      1973  *      SET NO. OF PTRS IN PTR GROUP = 2
                                      1974  *      MOVE REC TYPE AND PTR OF PRIOR TO NEW PTR GROUP
                                      1975  *
                                      1976  *
                                      1977  *    BATCH
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     64   BMAP - B00     
   002415    7 00002 4745 12          1978         LDP     PR4,RADDR,X2,PR7  SET PR4 = ADDRESS OF PA REC
   002416    7 00002 4735 12          1979         LDP     PR3,RADDR,X2,PR7  SET PR3 = ADDRESS OF PA REC
                                      1980  *      SET NO. OF PTRS IN PTR GROUP = 2
   002417    7 00730 7211 00          1981         LXL     X1,MEMPTR,,PR7
   002420    000 1 111 1005 00        1982         MLR     (1),(1,,,1),,1     * MOVE
   002421    7 00711 0 0 0 0002       1983         ADSC9   NOPTRS,0,2,PR7       *  NO. OF PTRS FLD
   002422    3 00000 0 0 0 0002       1984         ADSC9   0,0,2,PR3            *   TO PTR GRP IN PA REC
                                      1985  *      MOVE REC TYPE AND PTR TO PRIOR FROM ENTRY TO PTR GROUP
   002423    7 00510 2231 00          1986         LDX     X3,RVI,,PR7
   002424    7 00014 2201 13          1987         LDX     X0,CBRCE,X3,PR7  SET X0 = ENTRY OFST
   002425    7 00014 7211 13          1988         LXL     X1,CBRCP,X3,PR7  SET X1 = PTR OFST OF PRIOR/NEXT
   002426    000 1 111 1005 10        1989         MLR     (1,,,0),(1,,,1),,1  * MOVE
   002427    4 00000 0 0 0 0002       1990         ADSC9   0,0,2,PR4            *  RECORD TYPE OF PRIOR
   002430    3 00000 0 0 0 0002       1991         ADSC9   0,0,2,PR3            *   TO NEW PTR GROUP
                                      1992  *      MOVE PTR TO PRIOR TO PTR GROUP
   002431    3 00000 5005 11          1993         A9BD    ,X1,PR3         SET PR3 = ADDRESS OF FIRST ENTRY IN PTR G
   002432    4 00000 5005 10          1994         A9BD    ,X0,PR4         SET PR4 = ADDRESS OF ENTRY
   002433    6 00007 2351 15          1995         LDA     CSMPP,X5,PR6    GET DESCRIPTOR
   002434    100000 0350 03           1996         ADLA    =O100000,DU     CHANGE PR3 TO PR4 MOD
   002435    7 00640 7551 00          1997         STA     TFLD,,PR7       PUT IN TEMP FLD DESCRIPTOR
   002436    000 0 120 1015 20        1998         MRL     (1,,1),(1,,1),,0    * MOVE
   002437    7 00640 0001 00          1999         ARG     TFLD,,PR7          *  PRIOR MEMBER PTR FROM ENTRY
   002440    6 00007 0001 15          2000         ARG     CSMPP,X5,PR6       *   TO PTR GROUP
   002441    7 00021 2341 00          2001         SZN     TSI,,PR7        IS IT TDS
   002442 (0)002445 6050 00           2002         TPL     *+3             NO
   002443    7 00016 4745 00          2003         LDP     PR4,PABUF,,PR7  YES-SET PR4 = ADDR OF TEMP PA BUF
   002444    4 00000 5005 10          2004         A9BD    ,X0,PR4         SET PR4 = ENTRY IN TEMP PA REC BUF
                                      2005  *  UPDATE ENTRY
                                      2006  *      SET REC TYPE = 0 WITH BIT 0 ON INDICATING PTR GROUP PRESENT
                                      2007  *      SET PTR = OFST TO PTR GROUP
   002445    000 1 100 1005 00        2008         MLR     (1),(1),,1         * UPDATE
   002446    7 00727 4 0 0 0002       2009         ADSC9   MEMTYP,2,2,PR7       *  REC TYPE FIELD
   002447    4 00000 0 0 0 0002       2010         ADSC9   0,0,2,PR4            *   IN ENTRY
   002450    000 0 120 1015 00        2011         MRL     (1),(1,,1)         * SET
   002451    7 00730 0 0 0 0004       2012         ADSC9   MEMPTR,0,4,PR7       *  PTR IN ENTRY TO
   002452    7 00640 0001 00          2013         ARG     TFLD,,PR7          *   OFST OF NEW PTR GROUP
                                      2014  *
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     65   BMAP - B00     
                                      2015  *
                                      2016  *  SET UP FIELDS FOR NEW PA MEMBER
   002453                             2017  SFNEW  NULL
   002453    7 00513 2221 00          2018         LDX     X2,RVPA,,PR7
   002454    7 00512 2211 00          2019         LDX     X1,RVT,,PR7     REC TYPE FOR NEW PA MEMBER
   002455    7 00003 2351 11          2020         LDA     RTP,X1,PR7      GET REC TYPE OF NEW
   002456    7 00056 3751 00          2021         ANA     TMASK,,PR7      ISOLATE
   002457    7 00727 5511 14          2022         STBA    MEMTYP,14,PR7   SAVE TO PUT IN PTR GROUP
                                      2023  *  ADJUST PTR IF SET IS LOCAL
   002460    7 00000 2361 11          2024         LDQ     DBKEY,X1,PR7    GET DBK OF CURR
   002461    7 00520 2261 00          2025         LDX     X6,PRSC,,PR7    GET SC PTR FOR PA SET
   002462    6 00000 7201 16          2026         LXL     X0,DEF,X6,PR6   GET DEF BITS FROM SC
   002463    001000 3000 03           2027         CANX    X0,.LG,DU       IS IT A GLOBAL SET
   002464 (0)002467 6010 00           2028         TNZ     DADJ            YES - DONT NEED TO ADJUST
   002465    7 00005 2201 11          2029         LDX     X0,ACPTR,X1,PR7  GET AC PTR
   002466    6 00002 1361 10          2030         SBLQ    ABAS,X0,PR6     MAKE DBK OF CURR A LOCAL PTR
   002467                             2031  DADJ   NULL
   002467    7 00730 7201 00          2032         LXL     X0,MEMPTR,,PR7  OFFSET TO PTR GROUP
   002470    7 00730 7561 00          2033         STQ     MEMPTR,,PR7     SAVE TO PUT IN PTR GROUP
                                      2034  *  PUT INFO ON NEW PA MEMBER IN PTR GROUP
                                      2035  *
                                      2036  *
                                      2037  *    BATCH
   002471    7 00014 7211 11          2038         LXL     X1,CBRCP,X1,PR7  GET PTR OFST OF NEW
   002472    7 00002 4735 12          2039         LDP     PR3,RADDR,X2,PR7  RESET PR3 = ADDRESS OF PA REC
   002473    3 00000 5005 11          2040         A9BD    ,X1,PR3         SET PR3 = ADDRESS OF PLACE IN PTR GRP FOR
                                      2041  *      MOVE RECORD TYPE OF NEW TO PTR GROUP
   002474    000 1 100 1005 00        2042         MLR     (1),(1),,1         * MOVE
   002475    7 00727 4 0 0 0002       2043         ADSC9   MEMTYP,2,2,PR7       *  REC TYPE OF NEW
   002476    3 00000 0 0 0 0002       2044         ADSC9   0,0,2,PR3            *   TO PTR GROUP
                                      2045  *      MOVE PTR TO NEW MEMBER TO PTR GROUP
   002477    000 0 120 1015 00        2046         MRL     (1),(1,,1)         * MOVE
   002500    7 00730 0 0 0 0004       2047         ADSC9   MEMPTR,0,4,PR7       *  MEMBER PTR OF NEW
   002501    6 00007 0001 15          2048         ARG     CSMPP,X5,PR6       *   TO PTR GROUP
   002502 (0)002641 7100 00           2049         TRA     USPCA           GO UPDATE SPACE AVAIL IN PA CW
                                      2050  *
                                      2051  *
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     66   BMAP - B00     
                                      2052  *  A PTR GROUP ALREADY EXISTS.  ADD ANOTHER PTR FOR CURR TO
                                      2053  *  THE PTR GROUP.
   002503                             2054  ADPTR  NULL
                                      2055  *  SET PTR OFST OF NEW = PTR OFST OF PRIOR
                                      2056  *  UPDATE PTR OFST OF PRIOR = PTR OFST OF PRIOR - 2 - PTR SIZE
   002503    7 00720 4501 00          2057         STZ     PTESZ,,PR7      SET TO INDICATE NOT NEW PTR GRP
   002504    7 00512 2201 00          2058         LDX     X0,RVT,,PR7
   002505    7 00014 4411 10          2059         SXL     X1,CBRCP,X0,PR7  SAVE PTR OFST OF CURR
   002506    7 00724 1211 00          2060         SBLX    X1,PTRESZ,,PR7  NEW PTR OFST OF PRIOR
   002507    7 00510 2231 00          2061         LDX     X3,RVI,,PR7
   002510    7 00014 4411 13          2062         SXL     X1,CBRCP,X3,PR7  SAVE IN REC VAR FOR PRIOR
                                      2063  *  IF CURR IS A DUP OF NEXT, NEED TO SWITCH PTR OFFSETS.
                                      2064  *  THE PTR FOR THE CURR WILL COME BEFORE THE PTR FOR THE
                                      2065  *  NEXT IN THE POINTER GROUP.
   002511    7 00740 7211 00          2066         LXL     X1,PADUP,,PR7   IS CURR A DUP OF NEXT
   002512 (0)002517 6044 00           2067         TMOZ    SHFPG           NO - GO SHIFT PTR GROUPS
   002513    7 00014 2351 13          2068         LDA     CBRCP,X3,PR7    * REVERSE
   002514    7 00014 2361 10          2069         LDQ     CBRCP,X0,PR7    *  PTR OFFSETS OF
   002515    7 00014 7561 13          2070         STQ     CBRCP,X3,PR7    *   CURR AND NEXT
   002516    7 00014 7551 10          2071         STA     CBRCP,X0,PR7    *
   002517                             2072  SHFPG  NULL
                                      2073  *
                                      2074  *  NEED TO SHIFT ALL POINTER GROUPS WHICH ARE LOCATED BEFORE
                                      2075  *  THIS CURR PTR GROUP IN THE PA RECORD IN ORDER TO MAKE ROOM FOR THE
                                      2076  *  NEW PTR TO BE ADDED TO THE GROUP.
                                      2077  *
                                      2078  *      CALCULATE OFFSET OF SOURCE = SPACE AVAILABLE + STARTING BYTE
                                      2079  *        + (NO. OF ENTRIES) * ENTRY SIZE
   002517    7 00006 2271 12          2080         LDX     X7,RCPTR,X2,PR7  GET RC PTR FOR PA REC
   002520    6 77776 2351 17          2081         LDA     CSPES,X7,PR6    GET ENTRY SIZE
   002521    777777 3750 07           2082         ANA     -1,DL           ISOLATE
   002522    7 00717 7551 00          2083         STA     ENTSZ,,PR7      SAVE
   002523    7 00714 2361 00          2084         LDQ     PARCW,,PR7      GET NO. OF ENTRIES
   002524    017777 3760 03           2085         ANQ     .NOENT,DU       ISOLATE NO. OF ENTRIES
   002525    000022 7720 00           2086         QRL     18              INTO QL FOR MULTIPLY
   002526    7 00717 4021 00          2087         MPY     ENTSZ,,PR7      MULTIPLY BY ENTRY SIZE
   002527    000000 6210 06           2088         EAX     X1,,QL
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     67   BMAP - B00     
   002530    6 77776 0211 17          2089         ADLX    X1,CSPSB,X7,PR6  ADD STARTING BYTE
   002531    7 00714 7231 00          2090         LXL     X3,PARCW,,PR7   GET SPACE AVAIL IN PA REC
   002532    7 00744 7431 00          2091         STX     X3,SPCAVN,,PR7  SAVE TEMPORARILY
   002533    7 00744 0211 00          2092         ADLX    X1,SPCAVN,,PR7  ADD SPACE AVAIL IN PA REC
   002534    000000 6230 11           2093         EAX     X3,,X1
   002535    7 00724 1231 00          2094         SBLX    X3,PTRESZ,,PR7  SUBTRACT SIZE OF ENTRY IN PTR GRP TO GET
   002536    7 00744 7411 00          2095         STX     X1,SPCAVN,,PR7
   002537    7 00014 7221 10          2096         LXL     X2,CBRCP,X0,PR7  SET X2 = SIZE OF MOVE
                                      2097  *  IF CURR IS A DUP OF NEXT, NEED TO USE THE PTR OFFSET
                                      2098  *  OF THE NEXT REC IN THE SIZE CALCULATION.
   002540    7 00740 7201 00          2099         LXL     X0,PADUP,,PR7   IS CURR A DUP OF NEXT
   002541 (0)002544 6044 00           2100         TMOZ    *+3             NO
   002542    7 00510 2201 00          2101         LDX     X0,RVI,,PR7     YES - SET SIZE OF MOVE = PTR OFST
   002543    7 00014 7221 10          2102         LXL     X2,CBRCP,X0,PR7   OF NEXT - SOURCE OF MOVE
   002544    7 00724 0221 00          2103         ADLX    X2,PTRESZ,,PR7
   002545    7 00744 1221 00          2104         SBLX    X2,SPCAVN,,PR7    = OFST OF CURR - SOURCE OF MOVE
                                      2105  *  MOVE PREVIOUS PTR GROUPS TO MAKE ROOM FOR NEW PTR
   002546    7 00513 2201 00          2106         LDX     X0,RVPA,,PR7
   002547    7 00002 4735 10          2107         LDP     PR3,RADDR,X0,PR7  GET ADDRESS OF PA REC
   002550    000 1 153 1005 51        2108         MLR     (1,1,,1),(1,1,,3),,1  * MOVE
   002551    3 00000 0 0 0 0012       2109         ADSC9   0,0,X2,PR3              *  PREVIOS PTR GROUPS
   002552    3 00000 0 0 0 0012       2110         ADSC9   0,0,X2,PR3              *   TO MAKE ROOM FOR NEW PTR
   002553                             2111  UOTPG  NULL
   002553    7 00714 2211 00          2112         LDX     X1,PARCW,,PR7   GET NO. OF ENTRIES
   002554    017777 3610 03           2113         ANX     X1,.NOENT,DU    ISOLATE
   002555    7 00726 7411 00          2114         STX     X1,NUMENT,,PR7  SAVE
                                      2115  *  UPDATE SPACE AVAILABLE IN PA CONTROL WORD
   002556    7 00714 7211 00          2116         LXL     X1,PARCW,,PR7   GET SPACE AVAILABLE
   002557    7 00724 1211 00          2117         SBLX    X1,PTRESZ,,PR7  SUB SIZE OF ENTRY IN PTR GROUP
   002560    7 00714 4411 00          2118         SXL     X1,PARCW,,PR7   SAVE IN PA CONTROL WORD
                                      2119  *  UPDATE OFFSETS TO PTR GROUPS IN PA ENTRIES IF OFFSETS CHANGED
   002561    000000 6210 00           2120         EAX     X1,0            INIT ENTRY NUMBER
   002562    7 00513 2201 00          2121         LDX     X0,RVPA,,PR7
   002563    7 00006 2271 10          2122         LDX     X7,RCPTR,X0,PR7  GET RC PTR FOR PA REC
   002564    6 77776 2221 17          2123         LDX     X2,CSPSB,X7,PR6  INIT ENTRY OFFSET = STARTING BYTE
   002565    7 00004 7251 10          2124         LXL     X5,RSPTR,X0,PR7  GET RS PTR FOR PA REC
   002566                             2125  UOPGLP NULL                    LOOP TO UPDATE OFFSETS TO PTR GROUPS
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     68   BMAP - B00     
   002566    7 00726 1011 00          2126         CMPX    X1,NUMENT,,PR7  ARE THE ENTRIES DONE
   002567 (0)002453 6030 00           2127         TRC     SFNEW           YES-GO SET UP FLDS IN PTR GRP FOR NEW PA
   002570    7 00002 4735 10          2128         LDP     PR3,RADDR,X0,PR7  SET PR3 = ADDR OF NEXT ENTRY
   002571    7 00002 4745 10          2129         LDP     PR4,RADDR,X0,PR7  SET PR4 = ADDRESS OF PA ALSO
   002572    3 00000 5005 12          2130         A9BD    ,X2,PR3         SET PR3 = ADDR OF NEXT ENTRY
   002573    7 00510 2241 00          2131         LDX     X4,RVI,,PR7
   002574    000 1 100 1005 00        2132         MLR     (1),(1),,1         * MOVE
   002575    3 00000 0 0 0 0002       2133         ADSC9   0,0,2,PR3            *  TYPE FIELD AND INDIC. FROM PA ENTRY
   002576    7 00727 4 0 0 0002       2134         ADSC9   MEMTYP,2,2,PR7       *  TO WORKSPACE
   002577    000 1 100 1015 20        2135         MRL     (1,,1),(1),,1      * MOVE
   002600    6 00007 0001 15          2136         ARG     CSMPP,X5,PR6       *  POINTER FROM PA ENTRY
   002601    7 00730 0 0 0 0004       2137         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   002602    7 00727 7231 00          2138         LXL     X3,MEMTYP,,PR7  GET PTR INDICATOR FROM ENTRY
   002603 (0)002633 6050 00           2139         TPL     INCRE           NO  PTR GROUP PRESENT - GET NEXT ENTRY
   002604    7 00014 2351 14          2140         LDA     CBRCP,X4,PR7    GET PTR OFST OF NEXT/PRIOR
   002605    777777 3750 07           2141         ANA     -1,DL           ISOLATE
   002606    7 00730 1151 00          2142         CMPA    MEMPTR,,PR7     HAS OFST CHANGED DUE TO ADDING NEW PTR
   002607 (0)002612 6030 00           2143         TRC     UOFPG           YES - UPDATE OFFSETS
   002610    7 00014 1021 14          2144         CMPX    X2,CBRCE,X4,PR7  IS THIS THE ENTRY OFST OF CURR
   002611 (0)002633 6010 00           2145         TNZ     INCRE           NO - GO GET NEXT ENTRY
   002612                             2146  UOFPG  NULL
   002612    7 00730 7231 00          2147         LXL     X3,MEMPTR,,PR7  YES - UPDATE OFFSET
   002613    7 00724 1231 00          2148         SBLX    X3,PTRESZ,,PR7  NEW OFSET OF PTR GRP = OLD OFST - SIZE
   002614    7 00730 4431 00          2149         SXL     X3,MEMPTR,,PR7     OF ENTRY IN PTR GRP
   002615    000 0 120 1015 00        2150         MRL     (1),(1,,1)         * MOVE
   002616    7 00730 0 0 0 0004       2151         ADSC9   MEMPTR,0,4,PR7       *  NEW OFST OF PTR GROUP
   002617    6 00007 0001 15          2152         ARG     CSMPP,X5,PR6       *   TO ENTRY
                                      2153  *    IF THIS IS THE ENTRY OFFSET OF CURRENT, INCREMENT NO. OF
                                      2154  *    PTRS FLD BY 1.
   002620    7 00014 1021 14          2155         CMPX    X2,CBRCE,X4,PR7  IS THIS THE ENTRY OFST OF CURR
   002621 (0)002633 6010 00           2156         TNZ     INCRE           NO - CONTINUE
   002622    000 1 100 1005 13        2157         MLR     (1,,,3),(1),,1     * MOVE
   002623    4 00000 0 0 0 0002       2158         ADSC9   0,0,2,PR4            *  NO. OF PTRS FLD
   002624    7 00711 0 0 0 0002       2159         ADSC9   NOPTRS,0,2,PR7       *   TO WORKSPACE
   002625    7 00711 2241 00          2160         LDX     X4,NOPTRS,,PR7  GET NO. OF PTRS
   002626    000001 6240 14           2161         EAX     X4,1,X4         INCREMENT BY 1
   002627    7 00711 7441 00          2162         STX     X4,NOPTRS,,PR7  SAVE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     69   BMAP - B00     
   002630    000 1 113 1005 00        2163         MLR     (1),(1,,,3),,1     * MOVE
   002631    7 00711 0 0 0 0002       2164         ADSC9   NOPTRS,0,2,PR7       *  UPDATED NO. OF PTRS FLD
   002632    4 00000 0 0 0 0002       2165         ADSC9   0,0,2,PR4            *   TO PTR GROUP OF CURR ENTRY
   002633                             2166  INCRE  NULL
   002633    000001 6210 11           2167         EAX     X1,1,X1         INCREMENT TO NEXT ENTRY
   002634    000000 6350 12           2168         EAA     ,X2
   002635    000022 7710 00           2169         ARL     18
   002636    7 00717 0351 00          2170         ADLA    ENTSZ,,PR7
   002637    000000 6220 05           2171         EAX     X2,,AL          INCREMENT TO NEXT ENTRY OFFSET
   002640 (0)002566 7100 00           2172         TRA     UOPGLP          GET NEXT ENTRY
                                      2173  *
                                      2174  *
                                      2175  *  UPDATE POINTER ARRAY CONTROL WORD IN PA REC
   002641                             2176  USPCA  NULL
   002641                             2177  USPCA2 NULL
   002641    7 00513 2201 00          2178         LDX     X0,RVPA,,PR7
   002642    7 00002 4735 10          2179         LDP     PR3,RADDR,X0,PR7  RESET PR3 = ADDRESS OF PA REC
   002643    000 1 100 1005 00        2180         MLR     (1),(1),,1         * MOVE
   002644    7 00714 0 0 0 0004       2181         ADSC9   PARCW,0,4,PR7        *  PA CONTROL WORD
   002645    3 00001 0 0 0 0004       2182         ADSC9   PACW,0,4,PR3         *   TO PA RECORD
                                      2183  *
                                      2184  *
                                      2185  *  RETURN
   002646                             2186  CDPRET NULL
   002646  X 000000 7020 00           2187         DBRET
                                      2188  *
                                      2189  *  ERRORS DETECTED IN THIS ROUTINE
                                      2190  *
                                      2191  *
                                      2192  *
                                      2193  *
                                      2194  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                      2195  *
                                      2196  *
                                      2197  *
                                      2198  *
                                      2199  *  ERRORS DETECTED IN I/O ROUTINES
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       CREATE DUPLICATE ENTRY                                     70   BMAP - B00     
                                      2200  *
                                      2201  *
                                      2202  *
   002647    000000 6260 00           2203         EAX     X6,0            NULL SC PTR
   002650    000000 6270 00           2204         EAX     X7,0            NULL RC PTR
   002651 (0)002652 7100 00           2205         TRA     CDPCER
                                      2206  *  COMMON ERROR RETURN
   002652                             2207  CDPCER NULL
   002652  X 000000 7020 00           2208         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT POINTER GROUP ROUTINE                                71   BMAP - B00     
                                      2209         TTLS    SPLIT POINTER GROUP ROUTINE
                                      2210  *
                                      2211  *  SPLIT POINTER GROUP ROUTINE
                                      2212  *
                                      2213  *    THIS ROUTINE IS CALLED WHEN A PA RECORD HAS TO BE SPLIT
                                      2214  *    AND THERE IS ONLY 1 ENTRY IN THE PA RECORD.  IF THE ENTRY
                                      2215  *    CONTAINS A POINTER GROUP, THIS ROUTINE WILL SPLIT THE
                                      2216  *    POINTER GROUP BETWEEN THE OLD AND THE NEW PA RECORDS.
                                      2217  *    IF THE ENTRY DOES NOT CONTAIN A POINTER GROUP, THE ROUTINE
                                      2218  *    RETURNS AND DOES NOT MOVE THE ENTRY TO THE NEW PA RECORD.
                                      2219  *
                                      2220  *    INPUT ARGUMENTS:
                                      2221  *      RVPA - (NEW PA RECORD)
                                      2222  *             DBK
                                      2223  *             RECORD ADDRESS
                                      2224  *             BUFFER ADDRESS
                                      2225  *             RC PTR
                                      2226  *             AC PTR
                                      2227  *             SC PTR
                                      2228  *             RS PTR
                                      2229  *             RECORD SIZE AND TYPE
                                      2230  *
                                      2231  *      RVI  - (OLD PA RECORD)
                                      2232  *             DBK
                                      2233  *             RECORD ADDRESS
                                      2234  *             BUFFER ADDRESS
                                      2235  *             RC PTR
                                      2236  *             AC PTR
                                      2237  *             SC PTR
                                      2238  *             RS PTR
                                      2239  *             RECORD SIZE AND TYPE
                                      2240  *
                                      2241  *      OPARCW - PA CONTROL WORD OF OLD PA REC
                                      2242  *
                                      2243  *      NPARCW - PA CONTROL WORD OF NEW PA RECORD
                                      2244  *
                                      2245  *      ESZ - SIZE OF AN ENTRY IN A PTR GROUP
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT POINTER GROUP ROUTINE                                72   BMAP - B00     
                                      2246  *
                                      2247  *    OUTPUT ARGUMENTS:
                                      2248  *      IF ENTRY IS A POINTER GROUP IT IS SPLIT BETWEEN THE
                                      2249  *      TWO PA RECORDS AND THE PA CONTROL WORDS ARE UPDATED.
                                      2250  *      ALSO,
                                      2251  *          OPARCW - UPDATED TO REFLECT NEW PA CONTROL WORD OF
                                      2252  *                   OLD PA REC
                                      2253  *          NPARCW - UPDATED TO REFLECT NEW PA CONTROL WORD OF
                                      2254  *                   NEW PA REC
                                      2255  *
                                      2256  *    EXCEPTION: NONE
                                      2257  *
   002653                             2258  ZIG$DBSPG NULL
   002653  X 000000 7000 00           2259         DBSAV
   002654    000004 000000
                                      2260  *  MOVE ENTRY INDICATOR IN OLD PA REC TO WORKSPACE
   002655    7 00510 2211 00          2261         LDX     X1,RVI,,PR7     REC VAR FOR OLD PA REC
   002656    7 00002 4735 11          2262         LDP     PR3,RADDR,X1,PR7  GET ADDRESS OF OLD PA
   002657    7 00002 4745 11          2263         LDP     PR4,RADDR,X1,PR7  SET PR4 = ADDRESS OF OLD PA ALSO
   002660    7 00006 2271 11          2264         LDX     X7,RCPTR,X1,PR7  GET RC PTR FOR PA
   002661    6 77776 2231 17          2265         LDX     X3,CSPSB,X7,PR6  GET OFST OF ENTRY ( = STARTING BYTE)
   002662    3 00000 5005 13          2266         A9BD    ,X3,PR3         SET PR3 = ADDRESS OF ENTRY
   002663    000 1 100 1005 00        2267         MLR     (1),(1),,1         * MOVE
   002664    3 00000 0 0 0 0002       2268         ADSC9   0,0,2,PR3            *  ENTRY INDICATOR
   002665    7 00716 4 0 0 0002       2269         ADSC9   ENIND,2,2,PR7        *   TO WORKSPACE
   002666    7 00716 7201 00          2270         LXL     X0,ENIND,,PR7   IS A PTR GRP PRESENT
   002667 (0)003055 6050 00           2271         TPL     SPGRT           NO - RETURN
                                      2272  *  POINTER GROUP PRESENT - DETERMINE OFST OF PTR GRP
   002670    7 00004 7251 11          2273         LXL     X5,RSPTR,X1,PR7  GET RS PTR FOR PA
   002671    000 1 100 1015 20        2274         MRL     (1,,1),(1),,1      * MOVE
   002672    6 00007 0001 15          2275         ARG     CSMPP,X5,PR6       *  OFFSET OF PTR GROUP
   002673    7 00730 0 0 0 0004       2276         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   002674    7 00730 2351 00          2277         LDA     MEMPTR,,PR7     GET OFFSET
                                      2278  *  MOVE NO. OF PTRS IN PTR GROUP TO WORKSPACE
   002675    000 1 100 1005 05        2279         MLR     (1,,,AL),(1),,1    * MOVE
   002676    4 00000 0 0 0 0002       2280         ADSC9   0,0,2,PR4            *  NO. OF PTRS IN PTR GROUP
   002677    7 00711 0 0 0 0002       2281         ADSC9   NOPTRS,0,2,PR7       *   TO WORKSPACE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT POINTER GROUP ROUTINE                                73   BMAP - B00     
   002700    6 77776 7201 17          2282         LXL     X0,CSPES,X7,PR6  GET ENTRY SIZE
   002701    7 00743 7401 00          2283         STX     X0,SOE,,PR7     SAVE
   002702    7 00742 7221 00          2284         LXL     X2,NPARCW,,PR7  GET SPACE AVAIL IN NEW PA REC
   002703    7 00743 1221 00          2285         SBLX    X2,SOE,,PR7     SUBTRACT SIZE OF ENTRY
   002704    7 00742 4421 00          2286         SXL     X2,NPARCW,,PR7  SAVE UPDATED SPACE AVAIL
                                      2287  *  MOVE ENTRY FROM OLD PA TO NEW
   002705    7 00513 2221 00          2288         LDX     X2,RVPA,,PR7    REC VAR FOR NEW PA
   002706    7 00002 4745 12          2289         LDP     PR4,RADDR,X2,PR7  GET ADDRESS OF NEW PA REC
   002707    000 1 153 1005 40        2290         MLR     (1,1),(1,1,,3),,1  * MOVE
   002710    3 00000 0 0 0 0010       2291         ADSC9   0,0,X0,PR3           *  ENTRY FROM OLD PA REC
   002711    4 00000 0 0 0 0010       2292         ADSC9   0,0,X0,PR4           *   TO NEW PA REC
                                      2293  *
                                      2294  *
                                      2295  *
                                      2296  *  MOVE HALF OF THE POINTERS IN THE PTR GROUP FROM OLD PA
                                      2297  *  TO NEW PA
                                      2298  *
   002712                             2299  MVPG   NULL
                                      2300  *  CALCULATE SIZE OF PTR GROUP
   002712    7 00711 2361 00          2301         LDQ     NOPTRS,,PR7     GET NO. OF PTRS IN GROUP
   002713    000022 7720 00           2302         QRL     18              INTO QL FOR MULTIPLY
   002714    7 00725 4021 00          2303         MPY     ESZ,,PR7        MULTIPLY BY SIZE OF ENTRY IN A PTR GRP
   002715    000002 6220 06           2304         EAX     X2,2,QL         ADD 2 FOR NO. OF PTRS FLD
                                      2305  *    CALCULATE SOURCE FOR MOVE = (NO. OF PTRS IN PTR GRP/2)
                                      2306  *    (PTR ENTRY SIZE) + 2 + OFST OF PTR GRP
   002716    7 00711 2361 00          2307         LDQ     NOPTRS,,PR7     GET NO OF PTRS IN GROUP
   002717    000023 7720 00           2308         QRL     19              DIVIDE BY 2
   002720    7 00725 4021 00          2309         MPY     ESZ,,PR7        MULTIPLY BY PTR ENTRY SIZE
   002721    000002 0360 07           2310         ADLQ    2,DL            ADD 2 FOR NO. OF PTRS FLD
   002722    000000 6200 06           2311         EAX     X0,,QL          SAVE TO CALCULATE SIZE OF MOVE
   002723    7 00724 7401 00          2312         STX     X0,PTRESZ,,PR7
   002724    7 00730 0361 00          2313         ADLQ    MEMPTR,,PR7     ADD OFST OF PTR GRP
   002725    000000 6210 06           2314         EAX     X1,,QL          X1 = SOURCE OF MOVE
                                      2315  *    CALCULATE SIZE OF MOVE = PTR GRP SIZE - ((NO. OF PTRS
                                      2316  *    IN PTR GRP/2)*PTR ENTRY SIZE + 2)
   002726    7 00724 1621 00          2317         SBX     X2,PTRESZ,,PR7  X2 = SIZE OF MOVE
                                      2318  *    CALCULATE DESTINATION OF MOVE IN NEW PA RECORD:
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT POINTER GROUP ROUTINE                                74   BMAP - B00     
                                      2319  *      = SIZE OF PA REC - SIZE OF MOVE
   002727    7 00724 7421 00          2320         STX     X2,PTRESZ,,PR7  SAVE SIZE OF MOVE
   002730    7 00510 2201 00          2321         LDX     X0,RVI,,PR7
   002731    7 00003 2241 10          2322         LDX     X4,RECSZ,X0,PR7  GET SIZE OF PA REC
   002732    7 00724 1241 00          2323         SBLX    X4,PTRESZ,,PR7  SET X4 = DESTINATION OF PTRS IN NEW PA
   002733    7 00741 7231 00          2324         LXL     X3,OPARCW,,PR7  GET SPACE AVAIL IN OLD PA REC
   002734    7 00724 0231 00          2325         ADLX    X3,PTRESZ,,PR7  ADD SIZE OF PTRS MOVED TO NEW PA
   002735    7 00741 4431 00          2326         SXL     X3,OPARCW,,PR7  PUT BACK IN PA CONTROL WORD FOR OLD PA
   002736    7 00742 7231 00          2327         LXL     X3,NPARCW,,PR7  GET SPACE AVAIL IN NEW PA
   002737    7 00724 1231 00          2328         SBLX    X3,PTRESZ,,PR7  SUBTRACT SIZE OF PTRS MOVED TO NEW PA
   002740    000002 1230 03           2329         SBLX    X3,2,DU         SUBTRACT 2 BYTES FOR NO. OF PTRS FLD
   002741    7 00742 4431 00          2330         SXL     X3,NPARCW,,PR7  PUT BACK IN PA CONTROL WORD FOR NEW PA
   002742    7 00742 2231 00          2331         LDX     X3,NPARCW,,PR7
   002743    000001 6230 13           2332         EAX     X3,1,X3         UPDATE NO. OF ENTRIES IN NEW PA BY 1
   002744    7 00742 7431 00          2333         STX     X3,NPARCW,,PR7  PUT BACK IN PA CONTROL WORD
                                      2334  *    CALCULATE NO. OF PTRS IN PTR GROUP IN NEW PA REC
   002745    7 00711 2361 00          2335         LDQ     NOPTRS,,PR7     GET NO. OF PTRS IN GRP
   002746    000021 7370 00           2336         LLS     17              DIVIDE BY 2
   002747    000000 7720 00           2337         QRL     0               ANY REMAINDER
   002750 (0)002752 6050 00           2338         TPL     *+2             NO
   002751    000001 0350 07           2339         ADLA    1,DL            YES - ADD 1 TO NO. OF PTRS
   002752    000022 7350 00           2340         ALS     18              PUT INTO AU
   002753    7 00726 5511 60          2341         STBA    NUMENT,60,PR7   SAVE
                                      2342  *
                                      2343  *
                                      2344  *    BATCH - MOVE APPROX. HALF OF PTRS IN PTR GROUP TO NEW PA REC
   002754    7 00513 2231 00          2345         LDX     X3,RVPA,,PR7    REC VAR FOR NEW PA
   002755    7 00002 4745 10          2346         LDP     PR4,RADDR,X0,PR7  GET ADDRESS OF OLD PA
   002756    7 00002 4735 13          2347         LDP     PR3,RADDR,X3,PR7  GET ADDRESS OF NEW PA
   002757    000 1 154 1005 51        2348         MLR     (1,1,,1),(1,1,,4),,1  * MOVE
   002760    4 00000 0 0 0 0012       2349         ADSC9   0,0,X2,PR4           *  HALF OF THE PTRS IN PTR GRP
   002761    3 00000 0 0 0 0012       2350         ADSC9   0,0,X2,PR3           *   TO NEW PA REC
                                      2351  *      MOVE NO. OF PTRS FLD TO PTR GRP IN NEW PA REC
   002762    777776 6240 14           2352         EAX     X4,-2,X4
   002763    000 1 114 1005 00        2353         MLR     (1),(1,,,4),,1     * MOVE
   002764    7 00726 0 0 0 0002       2354         ADSC9   NUMENT,0,2,PR7       *  NO. OF PTRS FLD TO PTR GRP
   002765    3 00000 0 0 0 0002       2355         ADSC9   0,0,2,PR3            *   IN NEW PA REC
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT POINTER GROUP ROUTINE                                75   BMAP - B00     
                                      2356  *      UPDATE OFFSET TO PTR GRP IN ENTRY IN NEW PA REC
   002766    7 00727 4441 00          2357         SXL     X4,MEMTYP,,PR7  SAVE OFST OF PTR GRP
   002767    6 77776 2231 17          2358         LDX     X3,CSPSB,X7,PR6  GET OFST OF ENTRY
   002770    3 00000 5005 13          2359         A9BD    ,X3,PR3         SET PR3 = ADDRESS OF ENTRY IN NEW PA
   002771    000 0 120 1015 00        2360         MRL     (1),(1,,1),,0      * MOVE
   002772    7 00727 4 0 0 0002       2361         ADSC9   MEMTYP,2,2,PR7       *  OFFSET OF PTR GRP
   002773    6 00007 0001 15          2362         ARG     CSMPP,X5,PR6       *   TO PA ENTRY IN NEW
                                      2363  *
                                      2364  *
                                      2365  *
                                      2366  *  COMPACT PTRS IN PTR GROUP IN OLD PA REC:
                                      2367  *      SOURCE = OFFSET OF PTR GROUP IN OLD PA
                                      2368  *      SIZE OF MOVE = SOURCE OF PREVIOUS MOVE - OFST OF PTR GRP
                                      2369  *      DESTINATION = SIZE OF PA RECORD - SIZE OF MOVE
                                      2370  *
   002774                             2371  CPOPA  NULL
   002774    000000 6350 11           2372         EAA     ,X1             GET SOURCE OF PREVIOUS MOVE
   002775    000022 7710 00           2373         ARL     18              INTO AL
   002776    7 00730 1351 00          2374         SBLA    MEMPTR,,PR7     SUB OFST OF PTR GRP TO GET SIZE OF MOVE
                                      2375  *  DETERMINE DESTINATION OFFSET OF MOVE
   002777    000000 6210 05           2376         EAX     X1,,AL          SET X1 = SIZE OF MOVE
   003000    7 00724 7411 00          2377         STX     X1,PTRESZ,,PR7  SAVE SIZE OF MOVE
   003001    7 00510 2211 00          2378         LDX     X1,RVI,,PR7
   003002    7 00003 2241 11          2379         LDX     X4,RECSZ,X1,PR7  GET SIZE OF PA RECORD
   003003    7 00724 1241 00          2380         SBLX    X4,PTRESZ,,PR7  SET X4 = DESTINATION OF PTRS IN OLD PA
                                      2381  *      DETERMINE NEW NO. OF PTRS IN PTR GRP
   003004    7 00711 2361 00          2382         LDQ     NOPTRS,,PR7     GET NO. OF PTRS IN OLD PTR GRP
   003005    000001 7720 00           2383         QRL     1               DIVIDE BY 2
   003006    7 00726 5521 60          2384         STBQ    NUMENT,60,PR7   SAVE NEW NO. OF PTRS
   003007    7 00730 2361 00          2385         LDQ     MEMPTR,,PR7     SOURCE OF MOVE
   003010    7 00002 4735 10          2386         LDP     PR3,RADDR,X0,PR7  SET PR3 = ADDRESS OF OLD PA
   003011    000 1 154 1015 46        2387         MRL     (1,1,,QL),(1,1,,4),,1   * COMPACT
   003012    3 00000 0 0 0 0005       2388         ADSC9   0,0,AL,PR3           *  PTRS IN PTR GRP
   003013    3 00000 0 0 0 0005       2389         ADSC9   0,0,AL,PR3           *   IN OLD PA REC
                                      2390  *      UPDATE NO. OF PTRS FLD IN PTR GROUP
   003014    000 1 114 1005 00        2391         MLR     (1),(1,,,4),,1     * MOVE
   003015    7 00726 0 0 0 0002       2392         ADSC9   NUMENT,0,2,PR7       *  NO. OF PTRS FLD
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT POINTER GROUP ROUTINE                                76   BMAP - B00     
   003016    3 00000 0 0 0 0002       2393         ADSC9   0,0,2,PR3            *   TO PTR GRP
   003017    7 00727 4441 00          2394         SXL     X4,MEMTYP,,PR7  SAVE NEW OFST OF PTR GRP
                                      2395  *      UPDATE OFFSET TO PTR GROUP IN ENTRY
   003020    3 00000 5005 13          2396         A9BD    ,X3,PR3         SET PR3 = ADDRESS OF ENTRY IN OLD PA
   003021    000 0 120 1015 00        2397         MRL     (1),(1,,1),,0      * MOVE
   003022    7 00727 4 0 0 0002       2398         ADSC9   MEMTYP,2,2,PR7       *  OFFSET OF PTR GRP
   003023    6 00007 0001 15          2399         ARG     CSMPP,X5,PR6       *   TO PA ENTRY IN OLD
                                      2400  *
                                      2401  *
                                      2402  *
                                      2403  *  UPDATE CONTROL BITS IN PA CONTROL WORDS
                                      2404  *
                                      2405  *  MOVE LAST IN LEVEL INDICATOR FROM OLD PA REC TO NEW
   003024                             2406  UCW    NULL
   003024    0 00 03 1 100 0605 00    2407         CSL     (1),(1),03,,1      * MOVE
   003025    7 00741 0 03 0001        2408         BDSC    OPARCW,1,0,3,PR7     *  LAST IN LEVEL INDIC.
   003026    7 00742 0 03 0001        2409         BDSC    NPARCW,1,0,3,PR7     *   TO NEW PA REC
                                      2410  *  MOVE NOT LOWEST LEVEL INDICATOR FROM OLD PA REC TO NEW
   003027    0 00 03 1 100 0605 00    2411         CSL     (1),(1),03,,1      * MOVE
   003030    7 00741 0 00 0002        2412           BDSC      OPARCW,2,0,0,PR7    * NOT LOWEST LEVEL INDIC.
   003031    7 00742 0 00 0002        2413           BDSC      NPARCW,2,0,0,PR7    * AND HIGHEST KEY REP INDIC.
                                      2414  *  CLEAR LAST IN LEVEL INDICATOR IN OLD PA REC -
                                      2415  *  BECAUSE OF THE SPLIT IT IS NO LONGER LAST IN LEVEL
   003032    0 00 00 0 100 0604 00    2416         CSL     ,(1),00            * CLEAR
   003033    000000 0 00 0000         2417         BDSC    0,0,0              *  LAST IN LEVEL INDIC.
   003034    7 00741 0 03 0001        2418         BDSC    OPARCW,1,0,3,PR7     *   IN OLD PA REC
                                      2419  *  SET HIGHEST KEY VALUE REPEATED BIT IN OLD PA
   003035    7 00741 2201 00          2420         LDX     X0,OPARCW,,PR7
   003036    200000 2600 03           2421         ORX     X0,.PAHVR,DU
   003037    7 00741 7401 00          2422         STX     X0,OPARCW,,PR7
                                      2423  *  SET LOWEST KEY VALUE REPEATED BIT IN NEW PA
   003040    7 00742 2201 00          2424         LDX     X0,NPARCW,,PR7
   003041    020000 2600 03           2425         ORX     X0,.PALVR,DU
   003042    7 00742 7401 00          2426         STX     X0,NPARCW,,PR7
                                      2427  *
                                      2428  *  MOVE UPDATED PA CONTROL WORDS TO THE PA RECORDS
                                      2429  *  IN THE PAGE BUFFERS
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SPLIT POINTER GROUP ROUTINE                                77   BMAP - B00     
                                      2430  *
   003043    7 00510 2201 00          2431         LDX     X0,RVI,,PR7
   003044    7 00002 4735 10          2432         LDP     PR3,RADDR,X0,PR7  GET ADDRESS OF OLD PA REC
   003045    7 00513 2211 00          2433         LDX     X1,RVPA,,PR7
   003046    7 00002 4745 11          2434         LDP     PR4,RADDR,X1,PR7  GET ADDRESS OF NEW PA REC
   003047    000 1 100 1005 00        2435         MLR     (1),(1),,1         * MOVE
   003050    7 00741 0 0 0 0004       2436         ADSC9   OPARCW,0,4,PR7       *  UPDATED PA CONTROL WORD OF OLD PA
   003051    3 00001 0 0 0 0004       2437         ADSC9   PACW,0,4,PR3         *   TO OLD PA REC
   003052    000 1 100 1005 00        2438         MLR     (1),(1),,1         * MOVE
   003053    7 00742 0 0 0 0004       2439         ADSC9   NPARCW,0,4,PR7       *  UPDATED PA CONTROL WORD OF NEW PA
   003054    4 00001 0 0 0 0004       2440         ADSC9   PACW,0,4,PR4         *   TO NEW PA REC
                                      2441  *
                                      2442  *
                                      2443  *  NORMAL RETURN
   003055                             2444  SPGRT  NULL
   003055  X 000000 7020 00           2445         DBRET
   003056  X 000000 7020 00           2446         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       INSERT DUMMY PA ENTRY                                      78   BMAP - B00     
                                      2447         TTLS    INSERT DUMMY PA ENTRY
                                      2448  *
                                      2449  *  THIS ROUTINE WILL STORE THE SPECIAL POINTER ARRAY
                                      2450  *  ENTRY IN THE POINTER ARRAY RECORD.
                                      2451  *
                                      2452  *  THE FOLLOWING WILL BE PUT IN THE ENTRY:
                                      2453  *      TYPE CODE - TYPE CODE OF THE OWNER OF THE SET
                                      2454  *
                                      2455  *      PA KEY - ALL ZEROES
                                      2456  *
                                      2457  *      MEMBER PTR - PTR TO THE OWNER OF THE SET
                                      2458  *
                                      2459  *
                                      2460  *  INPUT ARGUMENTS:
                                      2461  *      RVI  -  DBK OF OWNER OF SET
                                      2462  *                OR DBK OF FIRST PA REC IN NEXT LOWEST LEVEL
                                      2463  *              BUFFER ADDRESS
                                      2464  *              RECORD ADDRESS
                                      2465  *              REC ORD TYPE
                                      2466  *              RC PTR
                                      2467  *              AC PTR
                                      2468  *              RS PTR
                                      2469  *              SC PTR
                                      2470  *
                                      2471  *      RVPA    DBK OF PA REC
                                      2472  *              BUFFER ADDRESS
                                      2473  *              RECORD ADDRESS
                                      2474  *
                                      2475  *      PRRC  - RC FOR PA RECORD
                                      2476  *
                                      2477  *      PRSC  - SC FOR PA SET
                                      2478  *
                                      2479  *      DUMMY PA ENTRY CREATED IN PA RECORD
                                      2480  *
                                      2481  *  EXCEPTION: NONE
                                      2482  *
   003057                             2483  ZIG$DBAID NULL
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       INSERT DUMMY PA ENTRY                                      79   BMAP - B00     
   003057  X 000000 7000 00           2484         DBSAV
   003060    000004 000000
   003061    7 00513 2231 00          2485        LDX     X3,RVPA,,PR7
   003062  X 000000 7010 00           2486        DBCAL   ZIM$DBPMR,NOEXC,SMWER5
   003063 (0)003164 7020 00
   003064    7 00513 2231 00          2487         LDX     X3,RVPA,,PR7
   003065    7 00002 4735 13          2488         LDP     PR3,RADDR,X3,PR7  RESET PR3 = ADDR OF PA REC
   003066    7 00510 2211 00          2489         LDX     X1,RVI,,PR7
                                      2490  *  MOVE PA CONTROL WORD TO WORKSPACE
   003067    000 1 100 1005 00        2491         MLR     (1),(1),,1         * MOVE
   003070    3 00001 0 0 0 0004       2492         ADSC9   PACW,0,4,PR3         *  POINTER ARRAY CONTROL WORD
   003071    7 00721 0 0 0 0004       2493         ADSC9   UPACW,0,4,PR7        *   TO WORKSPACE
   003072    7 00721 2201 00          2494         LDX     X0,UPACW,,PR7   GET NO OF ENTRIES
   003073    017777 3600 03           2495         ANX     X0,.NOENT,DU    ISOLATE
   003074 (0)003157 6010 00           2496         TNZ     NOEIE           NOT ZERO - ERROR
   003075    140000 2600 03           2497         ORX     X0,.PAFIL+.PALIL,DU  SET PA RECORD = FIRST & LAST IN LEVEL
                                      2498  *  IF THE DBK IN RVI IS FOR A PA RECORD, SET BIT IN PA
                                      2499  *  CONTROL WORD INDICATING REC IS NOT LOWEST LEVEL PA
   003076    7 00004 7251 11          2500         LXL     X5,RSPTR,X1,PR7  GET RS  FOR REC IN RVI
   003077    6 00000 2221 15          2501         LDX     X2,DEF,X5,PR6
   003100    010000 3020 03           2502         CANX    X2,.SO,DU       IS IT THE SET OWNER
   003101    7 00721 7401 00          2503        STX     X0,UPACW,,PR7       SAVE UPDATED CONTROL WORD
   003102    7 00014 4501 11          2504        STZ     CBRCE,X1,PR7        SET ENT OFST TO ZERO(UNKNOWN)
   003103 (0)003150 6010 00           2505        TNZ     SCWR                YES - DONE. GO SET CONTROL BIT
   003104    000001 0200 03           2506        ADLX    X0,1,DU             SET NO OF ENTRIES TO 1
   003105    400000 2600 03           2507         ORX     X0,.PANLL,DU    NO-RS FOR PA REC-SET BIT
   003106    7 00721 7401 00          2508         STX     X0,UPACW,,PR7   UPDATE NO. OF ENTRIES & CONTROL BITS
                                      2509  *  DECREMENT SPACE AVAILABLE
   003107    7 00517 2271 00          2510         LDX     X7,PRRC,,PR7    GET RC FOR PA ENTRY
   003110    6 77776 7201 17          2511         LXL     X0,CSPES,X7,PR6  GET ENTRY SIZE
   003111    7 00725 7401 00          2512         STX     X0,ESZ,,PR7     SAVE
   003112    7 00721 7201 00          2513         LXL     X0,UPACW,,PR7   GET SPACE AVAIL
   003113    7 00725 1201 00          2514         SBLX    X0,ESZ,,PR7     DECREMENT BY ENTRY SIZE
   003114    7 00721 4401 00          2515         SXL     X0,UPACW,,PR7   SAVE AS NEW SPACE AVAIL
                                      2516  *  SAVE RECORD TYPE OF OWNER RECORD
   003115    7 00003 2351 11          2517         LDA     RTP,X1,PR7      GET RECORD TYPE OF OWNER
   003116    7 00056 3751 00          2518         ANA     TMASK,,PR7      ISOLATE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       INSERT DUMMY PA ENTRY                                      80   BMAP - B00     
   003117    7 00727 5511 14          2519         STBA    MEMTYP,14,PR7   SAVE
                                      2520  *  GET DBK OF OWNER AND ADJUST TO LOCAL PTR IF SET IS LOCAL
   003120    7 00000 2361 11          2521         LDQ     DBKEY,X1,PR7    GET DBK OF OWNER
   003121    7 00520 2261 00          2522         LDX     X6,PRSC,,PR7    GET SC PTR
   003122    6 00000 7201 16          2523         LXL     X0,DEF,X6,PR6   GET DEF BITS FROM SC
   003123    001000 3000 03           2524         CANX    X0,.LG,DU       IS IT A GLOBAL SET
   003124 (0)003127 6010 00           2525         TNZ     SVOP            YES - DONT NEED TO ADJUST
   003125    7 00005 2201 11          2526         LDX     X0,ACPTR,X1,PR7  GET AC PTR
   003126    6 00002 1361 10          2527         SBLQ    ABAS,X0,PR6     MAKE GLOBAL DBK A LOCAL PTR
   003127                             2528  SVOP   NULL
   003127    7 00730 7561 00          2529         STQ     MEMPTR,,PR7     SAVE
                                      2530  *  NOW NEED TO SET THE KEY VALUE IN THE ENTRY = 0, AND MOVE
                                      2531  *  THE RECORD TYPE AND THE MEMBER PTR TO THE ENTRY. ALSO,
                                      2532  *  THE PA CONTROL WORD NEEDS TO BE UPDATED IN THE PA RECORD.
                                      2533  *  IF TDS, ALL OF THESE MOVES MUST BE DONE BY SETTING UP
                                      2534  *  MODIFY FIELD LISTS AND CALLING TDS TO MODIFY THE CI.
                                      2535  *  ZERO OUT THE PA KEY IN THE ENTRY
   003130    7 00725 2221 00          2536         LDX     X2,ESZ,,PR7     SIZE OF MOVE = SIZE OF ENTRY
   003131    6 77776 2201 17          2537         LDX     X0,CSPSB,X7,PR6  OFST OF ENTRY = STARTING BYTE
   003132    3 00000 5005 10          2538         A9BD    ,X0,PR3         SET PR3 = ADDRESS OF ENTRY
   003133    7 00002 4745 11          2539        LDP     PR4,RADDR,X1,PR7    PR4 = ADDR OF PA_REC IN RVI
   003134    4 00000 5005 10          2540        A9BD    ,X0,PR4             SET TO ITS FIRST ENTRY LOCATION
   003135    7 00014 7401 11          2541        STX     X0,CBRCE,X1,PR7     LET PA IN RVI(LOWER LEVEL) REMEMB OWNER
   003136    000 0 140 1005 40        2542        MLR     (1,1),(1,1)         MOVE LOWEST KEY IN RVI TO NEW PA
   003137    4 00000 0 0 0 0012       2543        ADSC9   0,0,X2,PR4
   003140    3 00000 0 0 0 0012       2544         ADSC9   0,0,X2,PR3           *   SPACE FOR ENTRY
                                      2545  *  MOVE RECORD TYPE OF OWNER TO PA ENTRY
   003141    000 1 100 1005 00        2546         MLR     (1),(1),,1         * MOVE
   003142    7 00727 4 0 0 0002       2547         ADSC9   MEMTYP,2,2,PR7       *  RECORD TYPE TO
   003143    3 00000 0 0 0 0002       2548         ADSC9   0,0,2,PR3            *   PA ENTRY
                                      2549  *  MOVE OWNER PTR TO PA ENTRY
   003144    7 00004 7251 13          2550         LXL     X5,RSPTR,X3,PR7  GET RS PTR FOR PA RECORD
   003145    000 0 120 1015 00        2551         MRL     (1),(1,,1)         * MOVE
   003146    7 00730 0 0 0 0004       2552         ADSC9   MEMPTR,0,4,PR7       *  MEMBER PTR
   003147    6 00007 0001 15          2553         ARG     CSMPP,X5,PR6       *   TO PA ENTRY
                                      2554  *  MOVE CONTROL WORD TO PA RECORD
   003150                             2555  SCWR  NULL
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       INSERT DUMMY PA ENTRY                                      81   BMAP - B00     
   003150    7 00002 4735 13          2556         LDP     PR3,RADDR,X3,PR7  RESET PR3 TO ADDRESS OF PA REC
   003151    000 1 100 1005 00        2557         MLR     (1),(1),,1         * MOVE
   003152    7 00721 0 0 0 0004       2558         ADSC9   UPACW,0,4,PR7        *  PA CONTROL WORD FROM WORKSPACE
   003153    3 00001 0 0 0 0004       2559         ADSC9   PACW,0,4,PR3         *   TO PA RECORD
                                      2560  *  NORMAL RETURN
   003154                             2561  IDRET  NULL
   003154    7 00000 2351 13          2562         LDA     DBKEY,X3,PR7    GET DBK OF PA REC
   003155    7 00015 7551 11          2563         STA     CBRPA,X1,PR7    SAVE
   003156  X 000000 7020 00           2564         DBRET
                                      2565  *
                                      2566  *  ERRORS DETECTED BY THIS PRIMITIVE
                                      2567  *
   003157                             2568  NOEIE  NULL                    NO OF ENTRIES IN PA NOT ZERO
   003157    303340 2350 07           2569         LDA     PAER3,DL
   003160    7 00517 2271 00          2570         LDX     X7,PRRC,,PR7    GET RC FOR PA REC
   003161    000000 6200 00           2571         EAX     X0,0            NULL AC
   003162    000000 6260 00           2572         EAX     X6,0            NULL SC
   003163 (0)003167 7100 00           2573         TRA     IDCER
                                      2574  *
                                      2575  *  ERRORS DETECTED IN SUBORDINATE ROUTINES
                                      2576  *
                                      2577  *
                                      2578  *
                                      2579  *
                                      2580  *  ERRORS DETECTED IN I/O ROUTINES
                                      2581  *
   003164                             2582  SMWER5 NULL
   003164    000000 6260 00           2583         EAX     X6,0            NULL SC
   003165    000000 6270 00           2584         EAX     X7,0            NULL RC
   003166 (0)003167 7100 00           2585         TRA     IDCER
                                      2586  *  COMMON ERROR RETURN
   003167                             2587  IDCER  NULL
   003167  X 000000 7020 00           2588         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       ADJUST OWNER PTR IN PA RECORD                              82   BMAP - B00     
                                      2589         TTLS    ADJUST OWNER PTR IN PA RECORD
                                      2590  *
                                      2591  *  ADJUST OWNER PTR IN PA RECORD
                                      2592  *
                                      2593  *    THIS ROUTINE WILL MODIFY THE OWNER PTR IN
                                      2594  *    A PA RECORD.  THE POINTER IS NO LONGER CORRECT BECAUSE
                                      2595  *    OF A SPLIT IN THE HIGHER LEVEL PA RECORDS.  THE CORRECT
                                      2596  *    PA OWNER RECORD IS IN RVPA.
                                      2597  *
                                      2598  *  INPUT ARGUMENTS:
                                      2599  *      RVT - DBK OF PA RECORD TO MODIFY
                                      2600  *            ADDRESS OF RECORD
                                      2601  *            ADDRESS OF BUFFER
                                      2602  *            AC PTR
                                      2603  *            RS PTR
                                      2604  *            RC PTR
                                      2605  *            SC PTR
                                      2606  *
                                      2607  *      RVPA - DBK OF PA RECORD
                                      2608  *
                                      2609  *  OUTPUT ARGUMENTS:
                                      2610  *      OWNER PTR UPDATED
                                      2611  *
                                      2612  *  EXCEPTION:  NONE
                                      2613  *
   003170                             2614  ZIG$DBAAO NULL
   003170  X 000000 7000 00           2615         DBSAV
   003171    000004 000000
   003172    7 00512 2231 00          2616        LDX     X3,RVT,,PR7
   003173  X 000000 7010 00           2617        DBCAL   ZIM$DBPMR,NOEXC,SMWE11
   003174 (0)003215 7020 00
                                      2618  *  ADJUST PA OWNER PTR IF SET IS LOCAL
   003175    7 00512 2211 00          2619         LDX     X1,RVT,,PR7
   003176    7 00513 2221 00          2620         LDX     X2,RVPA,,PR7
   003177    7 00000 2361 12          2621         LDQ     DBKEY,X2,PR7    GET DBK OF PA OWNER
   003200    7 00520 2261 00          2622         LDX     X6,PRSC,,PR7    GET SC FOR PA SET
   003201    6 00000 7201 16          2623         LXL     X0,DEF,X6,PR6
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       ADJUST OWNER PTR IN PA RECORD                              83   BMAP - B00     
   003202    001000 3000 03           2624         CANX    X0,.LG,DU       IS SET LOCAL
   003203 (0)003206 6010 00           2625         TNZ     DADST           NO - DONT ADJUST
   003204    7 00005 2201 11          2626         LDX     X0,ACPTR,X1,PR7  GET AC PTR
   003205    6 00002 1361 10          2627         SBLQ    ABAS,X0,PR6     MAKE DBK OF PA OWNER A LOCAL PTR
   003206                             2628  DADST  NULL
   003206    7 00631 7561 00          2629         STQ     PTR,,PR7        SAVE PTR
   003207    7 00002 4735 11          2630         LDP     PR3,RADDR,X1,PR7  GET RECORD ADDRESS
   003210    7 00004 7251 12          2631         LXL     X5,RSPTR,X2,PR7  GET RS PTR
   003211    000 0 120 1015 00        2632         MRL     (1),(1,,1),,0      * MOVE
   003212    7 00631 0 0 0 0004       2633         ADSC9   PTR,0,4,PR7          *  PA OWNER PTR
   003213    6 00006 0001 15          2634         ARG     HPOS,X5,PR6        *   TO PA RECORD
                                      2635  *
                                      2636  *
                                      2637  *  NORMAL RETURN
   003214                             2638  AORET  NULL
   003214  X 000000 7020 00           2639         DBRET
                                      2640  *
                                      2641  *  ERRORS DETECTED IN THIS PRIMITIVE
                                      2642  *
                                      2643  *
                                      2644  *
                                      2645  *
                                      2646  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                      2647  *
                                      2648  *
                                      2649  *
                                      2650  *
                                      2651  *  ERRORS DETECTED IN I/O ROUTINES
                                      2652  *
   003215                             2653  SMWE11 NULL                    ERROR SETTING MUST WRITE FOR PA
   003215    000000 6260 00           2654         EAX     X6,0            NULL SC PTR
   003216    000000 6270 00           2655         EAX     X7,0            NULL RC PTR
                                      2656  *
                                      2657  *
                                      2658  *  COMMON ERROR RETURN
   003217                             2659  AOCER  NULL
   003217  X 000000 7020 00           2660         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 84   BMAP - B00     
                                      2661         TTLS    DELETE PA ENTRY AND DELINK
                                      2662  *
                                      2663  *  DELETE PA ENTRY AND DELINK
                                      2664  *
                                      2665  *    THIS ROUTINE WILL DELETE AN ENTRY OF A POINTER ARRAY MEMBER
                                      2666  *  FROM A POINTER ARRAY RECORD.  IF THERE IS NO POINTER GROUP
                                      2667  *  PRESENT FOR THIS ENTRY, THE ENTIRE ENTRY OCCURRANCE WILL BE
                                      2668  *  DELETED.  OR, IF THERE IS NO POINTER GROUP PRESENT AND THE ENTRY
                                      2669  *  TO BE DELETED IS THE ONLY ENTRY IN THE POINTER ARRAY RECORD,
                                      2670  *  THE ENTIRE POINTER ARRAY RECORD WILL BE DELETED.
                                      2671  *    IF THERE IS A POINTER GROUP PRESENT FOR THE ENTRY, THE RECORD
                                      2672  *  TYPE OF THE PA MEMBER AND THE POINTER TO THE PA MEMBER WILL BE
                                      2673  *  DELETED FROM THE POINTER GROUP OCCURRANCE.  ALSO, THE NUMBER
                                      2674  *  OF PTRS FLD CONTAINED IN THE POINTER GROUP OCCURRANCE WILL BE
                                      2675  *  DECREMENTED BY ONE.  IF THERE ARE NO POINTERS LEFT IN THE
                                      2676  *  POINTER GROUP OCCURRANCE, THE POINTER GROUP OCCURRANCE AS WELL
                                      2677  *  AS THE ENTRY OCCURRANCE WILL BE DELETED.  AND AGAIN, IF THERE
                                      2678  *  ARE NO ENTRIES REMAINING IN THE POINTER ARRAY RECORD, THE
                                      2679  *  POINTER ARRAY RECORD WILL BE DELETED.  IF THERE IS ONLY ONE
                                      2680  *  POINTER LEFT IN THE POINTER GROUP OCCURRANCE, THE POINTER GROUP
                                      2681  *  WILL NOT BE DELETED AND THE ENTRY OCCURRANCE CHANGED.  THUS,
                                      2682  *  THE PRESENCE OF A POINTER GROUP OCCURRANCE DOES NOT INDICATE
                                      2683  *  THAT THE POINTER ARRAY KEY VALUE IS NOT UNIQUE.
                                      2684  *
                                      2685  *  INPUT ARGUMENTS:
                                      2686  *    RVI - DBK OF RECORD WHOSE ENTRY IS TO BE DELETED FROM
                                      2687  *              THE POINTER ARRAY RECORD
                                      2688  *          DBK OF PA RECORD
                                      2689  *          PA ENTRY OFFSET
                                      2690  *          PA POINTER OFFSET
                                      2691  *     (BUFFER MUST BE LOCKED)
                                      2692  *
                                      2693  *      RVT - DBK OF PRIOR OF SET
                                      2694  *            DBK OF PA OWNER
                                      2695  *            PA ENTRY OFFSET
                                      2696  *            PA POINTER OFFSET
                                      2697  *
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 85   BMAP - B00     
                                      2698  *    PRSC - SC PTR FOR PA SET
                                      2699  *
                                      2700  *    NOTE:  THE DBK OF THE PA RECORD MUST BE THE CORRECT
                                      2701  *    POINTER ARRAY OWNER FOR THE GIVEN MEMBER.  HOWEVER,
                                      2702  *    THE PA ENTRY AND POINTER OFFSETS MAY NOT BE CORRECT.
                                      2703  *    IF THEY ARE INCORRECT, THE POINTER ARRAY RECORD WILL BE
                                      2704  *    SEARCHED TO FIND A MATCH ON THE MEMBER POINTER.
                                      2705  *
                                      2706  *  OUTPUT ARGUMENTS:
                                      2707  *    ENTRY IS DELETED FROM THE PA RECORD
                                      2708  *
                                      2709  *  EXCEPTION: NONE
                                      2710  *
   003220                             2711  ZIG$DBADE NULL
   003220  X 000000 7000 00           2712         DBSAV
   003221    000004 000000
                                      2713  *  SAVE INFO ON CURR AND PRIOR RECORDS.  IF A PA RECORD IS
                                      2714  *  DELETED, THE REC VARIABLES FOR THE CURR AND PRIOR WILL
                                      2715  *  BE USED FOR PA RECORD INFO
   003222    7 00510 2211 00          2716         LDX     X1,RVI,,PR7
   003223    7 00000 2351 11          2717         LDA     DBKEY,X1,PR7    GET DBK OF CURR
   003224    7 00003 2361 11          2718         LDQ     RTP,X1,PR7      GET REC TYPE OF CURR
   003225    7 00704 7571 00          2719         STAQ    KCREG+4,,PR7    SAVE IN TEMP LOC
   003226    7 00006 2351 11          2720         LDA     RCPTR,X1,PR7    GET RC PTR FOR NEW
   003227    7 00004 2361 11          2721         LDQ     SCPTR,X1,PR7    GET SC & RS PTRS FOR NEW
   003230    7 00706 7571 00          2722         STAQ    KCREG+6,,PR7    SAVE IN TEMP LOC
   003231    7 00512 2221 00          2723         LDX     X2,RVT,,PR7     REC VAR FOR PRIOR
   003232    7 00000 2351 12          2724         LDA     DBKEY,X2,PR7    GET DBK OF PRIOR
   003233    7 00014 2361 12          2725         LDQ     CBRCE,X2,PR7    GET ENTRY & PTR OFST OF PRIOR
   003234    7 00700 7571 00          2726         STAQ    KCREG,,PR7      SAVE IN TEMP
   003235    7 00015 2351 12          2727         LDA     CBRPA,X2,PR7    GET DBK OF PA OWNER
   003236    7 00702 7551 00          2728         STA     KCREG+2,,PR7    SAVE IN TEMP
   003237                             2729  ZIG$DBALP NULL
   003237    7 00510 2211 00          2730         LDX     X1,RVI,,PR7
   003240    7 00015 2361 11          2731         LDQ     CBRPA,X1,PR7    GET DBK OF PA REC CONTAINING ENTRY TO BE
                                      2732  *                                 DELETED
   003241    7 00513 2221 00          2733         LDX     X2,RVPA,,PR7
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 86   BMAP - B00     
   003242    7 00000 7561 12          2734         STQ     DBKEY,X2,PR7    SAVE IN PA REC VAR
   003243    7 00510 2351 00          2735         LDA     RVI,,PR7        *
   003244    7 00513 2361 00          2736         LDQ     RVPA,,PR7       *  REVERSE
   003245    7 00513 7551 00          2737         STA     RVPA,,PR7       *   INPUT AND PA RECORD VARIABLES
   003246    7 00510 7561 00          2738         STQ     RVI,,PR7        *
                                      2739  *  FIND PA RECORD CONTAINING ENTRY TO BE DELETED
   003247  X 000000 7010 00           2740         DBCAL   ZIG$DBPFD,PANP2,PGER5    FIND PA RECORD
   003250 (0)003620 7020 00
   003251    5 00006 2341 00
   003252    000003 6000 04
   003253    5 00006 4501 00
   003254 (0)003620 7020 00
   003255    7 00510 2351 00          2741         LDA     RVI,,PR7        *
   003256    7 00513 2361 00          2742         LDQ     RVPA,,PR7       *  REVERSE
   003257    7 00513 7551 00          2743         STA     RVPA,,PR7       *   INPUT AND PA RECORD VARIABLES
   003260    7 00510 7561 00          2744         STQ     RVI,,PR7        *
                                      2745  *  FIND RC AND RS PTRS FOR PA REC
   003261    7 00520 2261 00          2746         LDX     X6,PRSC,,PR7    GET SC PTR FOR PA SET
   003262    000000 6250 16           2747         EAX     X5,,X6
   003263                             2748  FRCL   NULL
   003263    6 00002 2251 15          2749         LDX     X5,SCRSN,X5,PR6  GET NEXT RS
   003264 (0)003614 6000 00           2750         TZE     NRCE2           NO-DONE-RC FOR PA NOT FOUND
   003265    6 00000 2201 15          2751         LDX     X0,DEF,X5,PR6   GET MEMBER TYPE
   003266    000007 3600 03           2752         ANX     X0,.MEMT,DU     ISOLATE
   003267    000002 1000 03           2753         CMPX    X0,=O02,DU      IS IT AN RS FOR A PA REC
   003270 (0)003263 6010 00           2754         TNZ     FRCL            NO - GET NEXT RS
   003271    6 00003 2271 15          2755         LDX     X7,RCRSH,X5,PR6  YES - NOW GET RC PTR FOR PA REC
   003272    7 00006 7471 01          2756         STX     X7,RCPTR,AU,PR7  SAVE RC IN REC VAR FOR PA IN $AU
   003273    7 00004 4451 01          2757         SXL     X5,RSPTR,AU,PR7  SAVE RS IN REC VAR FOR PA IN $AU
   003274    7 00004 7461 01          2758         STX     X6,SCPTR,AU,PR7  SAVE SC IN REC VAR FOR PA IN $AU
                                      2759  *  VERIFY PA ENTRY AND POINTER OFFSETS
   003275  X 000000 7010 00           2760         DBCAL   ZIG$DBAVO,,VOER3   VERIFY OFSTS OF MEMBER TO BE DELETED
   003276 (0)003620 7020 00
   003277    5 00006 2341 00
   003300    777776 6010 04
                                      2761  *  SET MUST WRITE SWITCH FOR PA RECORD
   003301    7 00513 2231 00          2762        LDX     X3,RVPA,,PR7
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 87   BMAP - B00     
   003302  X 000000 7010 00           2763        DBCAL   ZIM$DBPMR,NOEXC,SMWER8
   003303 (0)003621 7020 00
   003304  X 000000 7010 00           2764        DBCAL   ZIM$JBEFPA,,NOALT  JOURNAL THE BEFORE IMAGE
   003305    000000 0020 00
                                      2765  *  MOVE PA CONTROL WORD TO WORKSPACE
   003306    7 00513 2221 00          2766         LDX     X2,RVPA,,PR7
   003307    7 00002 4735 12          2767         LDP     PR3,RADDR,X2,PR7  GET ADDRESS OF PA RECORD
   003310    000 1 100 1005 00        2768         MLR     (1),(1),,1         * MOVE
   003311    3 00001 0 0 0 0004       2769         ADSC9   PACW,0,4,PR3         *  PA CONTROL WORD FROM PA REC
   003312    7 00714 0 0 0 0004       2770         ADSC9   PARCW,0,4,PR7        *   TO WORKSPACE
                                      2771  *  CONVERT ENTRY OFFSET OF CURR TO ENTRY NUMBER
   003313    7 00510 2211 00          2772         LDX     X1,RVI,,PR7
   003314    7 00006 2271 12          2773         LDX     X7,RCPTR,X2,PR7  GET RC PTR FOR PA REC
   003315    6 77776 2351 17          2774         LDA     CSPES,X7,PR6    GET ENTRY SIZE
   003316    777777 3750 07           2775         ANA     -1,DL           ISOLATE
   003317    7 00725 7551 00          2776         STA     ESZ,,PR7        SAVE
   003320    7 00014 2201 11          2777         LDX     X0,CBRCE,X1,PR7  GET ENTRY OFST OF ENTRY TO DELETE
   003321    6 77776 1201 17          2778         SBLX    X0,CSPSB,X7,PR6  SUBTRACT STARTING BYTE OF ENTRIES
   003322    000000 6360 10           2779         EAQ     ,X0
   003323    000022 7720 00           2780         QRL     18              INTO FOR QL FOR DIVIDE
   003324    7 00725 5061 00          2781         DIV     ESZ,,PR7        DIVIDE BY ENTRY SIZE
   003325    000001 6200 06           2782         EAX     X0,1,QL         X0 = ENTRY NUMBER
                                      2783  *  CONVERT POINTER OFFSET OF CURR TO POINTER NUMBER
   003326    7 00014 2361 11          2784         LDQ     CBRCP,X1,PR7    GET POINTER OFFSET
   003327    777777 3760 07           2785         ANQ     -1,DL           ISOLATE
   003330 (0)003370 6000 00           2786         TZE     NPGRP           CURR NOT PART OF A POINTER GROUP
                                      2787  *  POINTER GROUP PRESENT
   003331    7 00004 7251 12          2788         LXL     X5,RSPTR,X2,PR7  GET RS PTR FOR PA REC
   003332    7 00014 2351 11          2789         LDA     CBRCE,X1,PR7    GET ENTRY OFSET OF CURR
   003333    3 00000 5005 01          2790         A9BD    ,AU,PR3         SET PR3 = ADDRESS OF CURR ENTRY
   003334    000 1 100 1015 20        2791         MRL     (1,,1),(1),,1       * MOVE
   003335    6 00007 0001 15          2792         ARG     CSMPP,X5,PR6       *  OFST OF POINTER GROUP FROM PA ENTRY
   003336    7 00712 0 0 0 0004       2793         ADSC9   ENTPTR,0,4,PR7       *   TO WORKSPACE
   003337    6 00007 2351 15          2794         LDA     CSMPP,X5,PR6    GET PTR SIZE FROM EIS DESCRIPTOR
   003340    007777 3750 07           2795         ANA     =O7777,DL       ISOLATE
   003341    000002 0350 07           2796         ADLA    2,DL            ADD 2 FOR RECORD TYPE FIELD
   003342    7 00720 7551 00          2797         STA     PTESZ,,PR7      SAVE FOR DIVIDE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 88   BMAP - B00     
   003343    7 00712 1361 00          2798         SBLQ    ENTPTR,,PR7     SUBTRACT OFST OF PTR GROUP
   003344    000002 1360 07           2799         SBLQ    2,DL            SUBTRACT 2 FOR NO. OF PTRS FLD
   003345    7 00720 5061 00          2800         DIV     PTESZ,,PR7      DIVIDE BY SIZE OF A PTR GROUP ENTRY
   003346    000000 6230 06           2801         EAX     X3,,QL          X3 = PTR NUMBER
   003347    7 00712 2351 00          2802         LDA     ENTPTR,,PR7
   003350    7 00002 4735 12          2803         LDP     PR3,RADDR,X2,PR7  RESET PR3 = ADDRESS OF PA
   003351    000 1 100 1005 05        2804         MLR     (1,,,AL),(1),,1    * MOVE
   003352    3 00000 0 0 0 0002       2805         ADSC9   0,0,2,PR3             *  NO. OF PTRS IN PTR GROUP
   003353    7 00711 0 0 0 0002       2806         ADSC9   NOPTRS,0,2,PR7       *   TO WORKSPACE
   003354    7 00711 2211 00          2807         LDX     X1,NOPTRS,,PR7  GET NO. OF PTRS IN PTR GROUP
   003355    000001 1010 03           2808         CMPX    X1,1,DU
   003356 (0)003443 6010 00           2809         TNZ     DPFPG           MORE THAN 1 PTR IN PTR GROUP
                                      2810  *
                                      2811  *  ONLY 1 PTR IN PTR GROUP.  DELETE WHOLE GROUP.
   003357    7 00745 7401 00          2812         STX     X0,PAEN,,PR7    SAVE ENTRY NO. TO DELETE
                                      2813  *  SET UP ARGUMENTS FOR CALL: QR = SIZE OF PTR GRP TO DELETE
                                      2814  *                             AR = OFST OF PTR GRP TO DELETE
                                      2815  *                               (AR ALREADY SET UP)
   003360    7 00720 2361 00          2816         LDQ     PTESZ,,PR7      SET QR = SIZE OF PTR GROUP FOR CALL
   003361    000002 0360 07           2817         ADLQ    2,DL              SIZE=SIZE OF ENTRY IN PTR GROUP + 2 FOR
   003362    7 00746 7561 00          2818         STQ     PGSIZE,,PR7     SAVE SIZE OF PTR GROUP
                                      2819  *                                OF PTRS FLD
   003363 (0)004047 7010 00           2820         ICCAL   ZIG$DBADP,,DPER1   DELETE PTR GROUP
   003364 (0)003620 7020 00
   003365    5 00006 2341 00
   003366    777776 6010 04
   003367    7 00745 2201 00          2821         LDX     X0,PAEN,,PR7    GET ENTRY NUMBER
   003370                             2822  NPGRP  NULL
                                      2823  *  DELETE ENTRY OCCURRANCE
   003370    7 00714 2211 00          2824         LDX     X1,PARCW,,PR7   GET NO. OF ENTRIES IN PA
   003371    017777 3610 03           2825         ANX     X1,.NOENT,DU    ISOLATE
   003372    000001 1010 03           2826         CMPX    X1,1,DU
   003373 (0)003405 6000 00           2827         TZE     DPARC           ONLY 1 ENTRY IN PA-GO DELETE ENTIRE REC
   003374    7 00510 2221 00          2828         LDX     X2,RVI,,PR7
   003375    7 00014 2351 12          2829         LDA     CBRCE,X2,PR7    SET AR = PA ENTRY OFST TO DELETE
   003376    000022 7710 00           2830         ARL     18              INTO AL
   003377    7 00745 7401 00          2831         STX     X0,PAEN,,PR7    PAEN = PA ENTRY NO. TO DELETE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 89   BMAP - B00     
   003400 (0)003625 7010 00           2832         ICCAL   ZIG$DBADO,,DEOE1   DELETE ENTRY OCCURRENCE
   003401 (0)003620 7020 00
   003402    5 00006 2341 00
   003403    777776 6010 04
   003404 (0)003560 7100 00           2833        TRA     DEJAFP              GO TO JOURNAL AFTER IMAGE
                                      2834  *
                                      2835  *
                                      2836  *  ONLY 1 ENTRY IN PA RECORD SO DELETE ENTIRE RECORD
                                      2837  *  (SAVE NEXT AND OWNER PTRS FROM PA REC BEFORE DELETING IT)
   003405                             2838  DPARC  NULL
   003405    7 00513 2221 00          2839         LDX     X2,RVPA,,PR7
   003406    7 00002 4735 12          2840         LDP     PR3,RADDR,X2,PR7  GET ADDRESS OF PA REC
   003407    7 00004 7251 12          2841         LXL     X5,RSPTR,X2,PR7  GET RS PTR FOR PA REC
   003410    000 1 100 1015 20        2842         MRL     (1,,1),(1),,1      * MOVE
   003411    6 00004 0001 15          2843         ARG     NPOS,X5,PR6        *  NEXT PTR
   003412    7 00631 0 0 0 0004       2844         ADSC9   PTR,0,4,PR7          *   TO WORKSPACE
                                      2845  *
   003413    000 1 100 1015 20        2846         MRL     (1,,1),(1),,1      * MOVE
   003414    6 00006 0001 15          2847         ARG     HPOS,X5,PR6        *  OWNER PTR
   003415    7 00731 0 0 0 0004       2848         ADSC9   PAOPTR,0,4,PR7       *   TO WORKSPACE
   003416 (0)003716 7010 00           2849         DBCAL   ZIG$DBADR,,DPAE1   DELETE PA RECORD
   003417 (0)003620 7020 00
   003420    5 00006 2341 00
   003421    777776 6010 04
   003422    7 00731 2361 00          2850         LDQ     PAOPTR,,PR7     GET OWNER PTR
   003423    7 00631 1161 00          2851         CMPQ    PTR,,PR7        IS IT TOP LEVEL PA(NEXT = OWNER)
   003424 (0)003564 6000 00           2852         TZE     DERET           YES - DONE
                                      2853  *
                                      2854  *  ADJUST PTRS IF SET IS LOCAL
   003425    7 00513 2221 00          2855         LDX     X2,RVPA,,PR7
   003426    7 00520 2261 00          2856         LDX     X6,PRSC,,PR7    GET SC PTR
   003427    6 00000 7201 16          2857         LXL     X0,DEF,X6,PR6
   003430    001000 3000 03           2858         CANX    X0,.LG,DU       IS SET LOCAL
   003431 (0)003434 6010 00           2859         TNZ     SVPTR           NO - DONT NEED TO ADJUST PTRS
   003432    7 00005 2201 12          2860         LDX     X0,ACPTR,X2,PR7  GET AC PTR
   003433    6 00002 0361 10          2861         ADLQ    ABAS,X0,PR6     MAKE OWNER PTR GLOBAL
   003434                             2862  SVPTR  NULL
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 90   BMAP - B00     
   003434    7 00015 7561 12          2863         STQ     CBRPA,X2,PR7    SAVE AS NEW PA OWNER PTR
   003435    7 00014 4501 12          2864         STZ     CBRCE,X2,PR7    ZERO PA ENTRY & PTR OFSTS
   003436    7 00510 2351 00          2865         LDA     RVI,,PR7        *
   003437    7 00513 2361 00          2866         LDQ     RVPA,,PR7       * REVERSE
   003440    7 00513 7551 00          2867         STA     RVPA,,PR7       *  INPUT AND PA RECORD VARIABLES
   003441    7 00510 7561 00          2868         STQ     RVI,,PR7        *
   003442 (0)003237 7100 00           2869         TRA     ZIG$DBALP
                                      2870  *
                                      2871  *
                                      2872  *  CURRENT ENTRY IS PART OF A POINTER GROUP - DELETE THE REC TYPE
                                      2873  *  FIELD AND PTR TO MEMBER FROM THE PTR GROUP
   003443                             2874  DPFPG  NULL
   003443    777777 6210 11           2875         EAX     X1,-1,X1        DECREMENT NO. OF PTRS BY 1
   003444    7 00711 7411 00          2876         STX     X1,NOPTRS,,PR7  SAVE
                                      2877  *  UPDATE NO. OF PTRS FIELD IN THE POINTER GROUP
   003445    7 00712 2351 00          2878         LDA     ENTPTR,,PR7     SET AL = OFFSET OF POINTER GROUP
   003446    000 1 105 1005 00        2879         MLR     (1),(1,,,AL),,1    * MOVE
   003447    7 00711 0 0 0 0002       2880         ADSC9   NOPTRS,0,2,PR7       *  UPDATED NO. OF PTRS IN PTR GROUP
   003450    3 00000 0 0 0 0002       2881         ADSC9   0,0,2,PR3            *   TO WORKSPACE
                                      2882  *
                                      2883  *
                                      2884  *  DETERMINE SIZE OF MOVE TO COMPACT PTR GROUPS:
                                      2885  *    SIZE = PTR OFST - SPACE AVAIL - 1ST STARTING BYTE
                                      2886  *           - NO. OF ENTRIES (* ENTRY SIZE)
   003451                             2887  CPG    NULL
   003451    7 00714 2361 00          2888         LDQ     PARCW,,PR7      GET PA CONTROL WORD
   003452    017777 3760 03           2889         ANQ     .NOENT,DU       ISOLATE NO. OF ENTRIES IN PA
   003453    000022 7720 00           2890         QRL     18              INTO QL FOR MULTIPLY
   003454    7 00725 4021 00          2891         MPY     ESZ,,PR7        MULTIPLY NO. OF ENTRIES BY ENTRY SIZE
   003455    000044 7370 00           2892         LLS     36
   003456    000000 6230 05           2893         EAX     X3,,AL          SET X3 = NO. OF ENTRIES * ENTRY SIZE
   003457    000000 5310 00           2894         NEG                     MAKE NEGATIVE
   003460    000000 6210 05           2895         EAX     X1,,AL          SET X1 = -(NO. OF ENTRIES * ENTRY SIZE)
   003461    7 00510 2201 00          2896         LDX     X0,RVI,,PR7
   003462    7 00014 7241 10          2897         LXL     X4,CBRCP,X0,PR7
   003463    7 00744 7441 00          2898         STX     X4,SPCAVN,,PR7
   003464    7 00744 0611 00          2899         ADX     X1,SPCAVN,,PR7  ADD PTR OFST OF CURR
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 91   BMAP - B00     
   003465    7 00714 7241 00          2900         LXL     X4,PARCW,,PR7
   003466    7 00744 7441 00          2901         STX     X4,SPCAVN,,PR7
   003467    7 00744 1611 00          2902         SBX     X1,SPCAVN,,PR7  SUBTRACT SPACE AVAIL IN PA
   003470    7 00006 2271 12          2903         LDX     X7,RCPTR,X2,PR7
   003471    6 77776 1611 17          2904         SBX     X1,CSPSB,X7,PR6  SUBTRACT STARTING BYTE
                                      2905  *                              X1 = SIZE OF MOVE
                                      2906  *  SET SOURCE OFFSET OF MOVE = BEGINNING OF PTR GROUPS IN PA
                                      2907  *     (STARTING BYTE +  NO. OF ENTRIES * ENTRY SIZE  + SPACE AVAIL)
   003472    6 77776 0231 17          2908         ADLX    X3,CSPSB,X7,PR6  ADD STARTING BYTE
   003473    7 00744 0231 00          2909         ADLX    X3,SPCAVN,,PR7  ADD SPACE AVAIL
                                      2910  *  SET DESTINATION OFFSET OF MOVE = SOURCE OFFSET + SIZE OF AN ENTRY
                                      2911  *     IN A PTR GROUP
   003474    000000 6350 13           2912         EAA     ,X3             GET OFFSET OF SOURCE
   003475    000022 7710 00           2913         ARL     18              INTO AL
   003476    7 00720 0351 00          2914         ADLA    PTESZ,,PR7      ADD SIZE OF ENTRY IN PTR GRP
                                      2915  *  UPDATE SPACE AVAILABLE IN PA CONTROL WORD
   003477    7 00714 2361 00          2916         LDQ     PARCW,,PR7      GET SPAVE AVAILABLE IN PA
   003500    777777 3760 07           2917         ANQ     -1,DL           ISOLATE
   003501    7 00720 0361 00          2918         ADLQ    PTESZ,,PR7      ADD SIZE OF ENTRY IN PTR GROUP
   003502    7 00714 5521 14          2919         STBQ    PARCW,14,PR7    PUT IN PA CONTROL WORD
                                      2920  *
                                      2921  *  COMPACT PTR GROUPS & UPDATE PA CONTROL WORD
                                      2922  *    X1 = SIZE OF MOVE
                                      2923  *    X3 = SOURCE
                                      2924  *    AL = DESTINATION
                                      2925  *
   003503    000 1 145 1015 53        2926         MRL     (1,1,,3),(1,1,,AL),,1  * COMPACT
   003504    3 00000 0 0 0 0011       2927         ADSC9   0,0,1,PR3               *  PTR GROUPS IN
   003505    3 00000 0 0 0 0011       2928         ADSC9   0,0,1,PR3               *   PA RECORD
   003506    000 1 100 1005 00        2929         MLR     (1),(1),,1         * MOVE
   003507    7 00714 0 0 0 0004       2930         ADSC9   PARCW,0,4,PR7        *  UPDATED PA CONTROL WORD
   003510    3 00001 0 0 0 0004       2931         ADSC9   PACW,0,4,PR3         *   TO PA RECORD
                                      2932  *  UPDATE OFFSETS TO POINTER GROUPS WHICH WERE CHANGED
                                      2933  *  DUE TO COMPACTION
   003511                             2934  UOPG   NULL
   003511    7 00714 2211 00          2935         LDX     X1,PARCW,,PR7   GET NO. OF ENTRIES IN PA REC
   003512    017777 3610 03           2936         ANX     X1,.NOENT,DU    ISOLATE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 92   BMAP - B00     
   003513    7 00726 7411 00          2937         STX     X1,NUMENT,,PR7  SAVE
   003514    7 00513 2221 00          2938         LDX     X2,RVPA,,PR7
   003515    7 00006 2271 12          2939         LDX     X7,RCPTR,X2,PR7  GET RC PTR FOR PA REC
   003516    6 77776 2231 17          2940         LDX     X3,CSPSB,X7,PR6  INIT ENTRY OFFSET = STARTING BYTE
   003517    000000 6210 00           2941         EAX     X1,0            INIT ENTRY NUMBER
   003520                             2942  UOPGL  NULL
   003520    7 00726 1011 00          2943         CMPX    X1,NUMENT,,PR7  ARE THE ENTRIES DONE
   003521 (0)003560 6030 00           2944        TRC     DEJAFP              DONE - GOTO JOURNAL AFTER IMAGE
   003522    7 00513 2221 00          2945         LDX     X2,RVPA,,PR7
   003523    7 00004 7251 12          2946         LXL     X5,RSPTR,X2,PR7  GET RS PTR FOR PA REC
   003524    7 00002 4735 12          2947         LDP     PR3,RADDR,X2,PR7  GET ADDRESS OF PA REC
   003525    3 00000 5005 13          2948         A9BD    ,X3,PR3         SET PR3 = ADDR OF ENTRY
   003526    000 1 100 1005 00        2949         MLR     (1),(1),,1         * MOVE
   003527    3 00000 0 0 0 0002       2950         ADSC9   0,0,2,PR3            *  TYPE FIELD AND INDIC. FROM PA ENTRY
   003530    7 00727 4 0 0 0002       2951         ADSC9   MEMTYP,2,2,PR7       *   TO WORKSPACE
   003531    7 00727 7221 00          2952         LXL     X2,MEMTYP,,PR7  IS THERE A POINTER GROUP PRESENT
   003532 (0)003541 6040 00           2953         TMI     PTGRP           YES - GO CHECK IF OFSTS HAVE CHANGED
                                      2954  *
                                      2955  *  NO POINTER GROUP.  INCREMENT ENTRY OFFSET AND ENTRY
                                      2956  *  NUMBER TO NEXT
                                      2957  *
   003533                             2958  GNXTE  NULL
   003533    000001 6210 11           2959         EAX     X1,1,X1         INCREMENT ENTRY NUMBER BY 1
   003534    000000 6350 13           2960         EAA     ,X3
   003535    000022 7710 00           2961         ARL     18
   003536    7 00725 0351 00          2962         ADLA    ESZ,,PR7
   003537    000000 6230 05           2963         EAX     X3,,AL          INCREMENT X3 BY SIZE OF ENTRY
   003540 (0)003520 7100 00           2964         TRA     UOPGL           GO CHECK NEXT ENTRY
                                      2965  *
                                      2966  *  POINTER GROUP PRESENT.  UPDATE OFFSET OF PTR GROUP
                                      2967  *  IF THE POINTER GROUP MOVED DURING COMPACTION.
                                      2968  *
                                      2969  *    MOVE OFFSET OF POINTER GROUP TO WORKSPACE
   003541                             2970  PTGRP  NULL
   003541    000 1 100 1015 20        2971         MRL     (1,,1),(1),,1      * MOVE
   003542    6 00007 0001 15          2972         ARG     CSMPP,X5,PR6       *  OFFSET OF PTR GROUP
   003543    7 00730 0 0 0 0004       2973         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 93   BMAP - B00     
   003544    7 00510 2201 00          2974         LDX     X0,RVI,,PR7
   003545    7 00014 2351 10          2975         LDA     CBRCP,X0,PR7    GET PTR OFFSET OF DELETED
   003546    777777 3750 07           2976         ANA     -1,DL           ISOLATE
   003547    7 00730 1151 00          2977         CMPA    MEMPTR,,PR7     HAS OFFSET OF CURR PTR GROUP CHANGED
   003550 (0)003533 6020 00           2978         TNC     GNXTE           NO - GO GET NEXT ENTRY & PTR GROUP
   003551    7 00730 2351 00          2979         LDA     MEMPTR,,PR7     GET PTR GROUP OFFSET OF CURR
   003552    7 00720 0351 00          2980         ADLA    PTESZ,,PR7      ADD SIZE OF PTR DELETED
   003553    7 00730 7551 00          2981         STA     MEMPTR,,PR7     SAVE AS NEW OFFSET
   003554    000 0 120 1015 00        2982         MRL     (1),(1,,1),,0      * MOVE
   003555    7 00730 0 0 0 0004       2983         ADSC9   MEMPTR,0,4,PR7       *  UPDATED OFFSET OF PTR GROUP
   003556    6 00007 0001 15          2984         ARG     CSMPP,X5,PR6       *   TO CURR ENTRY
   003557 (0)003533 7100 00           2985         TRA     GNXTE           GO GET NEXT
                                      2986  *
                                      2987  *
                                      2988  *  NORMAL RETURN
   003560                             2989  DEJAFP NULL
   003560    000000 2210 03           2990        LDX     X1,0,DU
   003561    7 00724 4411 00          2991        SXL     X1,PASPLT,,PR7      ZERO IND IN CASE NOT INITILED
   003562  X 000000 7010 00           2992        DBCAL   ZIM$JAFTPA,,NOALT  JOURNALIZE AFTER IMAGE
   003563    000000 0020 00
   003564                             2993  DERET  NULL
                                      2994  *  RESET INFORMATION ON CURR AND PRIOR RECORDS IF INFO
                                      2995  *  IS NO LONGER IN REC VARIABLES (DUE TO DELETING PA RECS)
   003564    7 00510 2211 00          2996         LDX     X1,RVI,,PR7
   003565    7 00704 2361 00          2997         LDQ     KCREG+4,,PR7
   003566    7 00000 1161 11          2998         CMPQ    DBKEY,X1,PR7    IS CURR IN INPUT REC VAR
   003567 (0)003613 6000 00           2999         TZE     DERET2          YES - RETURN
                                      3000  *  RESET REC VAR FOR CURRENT
   003570    7 00000 7561 11          3001         STQ     DBKEY,X1,PR7
   003571  X 000000 7010 00           3002         DBCAL   ZIG$DBPFD,PNPE3,FDER3    FIND CURR REC
   003572 (0)003620 7020 00
   003573    5 00006 2341 00
   003574    000003 6000 04
   003575    5 00006 4501 00
   003576 (0)003620 7020 00
   003577    7 00510 2211 00          3003         LDX     X1,RVI,,PR7
   003600    7 00705 2351 00          3004         LDA     KCREG+5,,PR7
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 94   BMAP - B00     
   003601    7 00003 7551 11          3005         STA     RTP,X1,PR7      RESTORE REC TYPE OF CURR
   003602    7 00706 2371 00          3006         LDAQ    KCREG+6,,PR7
   003603    7 00006 7551 11          3007         STA     RCPTR,X1,PR7    RESTORE RC PTR FOR CURR
   003604    7 00004 7561 11          3008         STQ     SCPTR,X1,PR7    RESTORE SC & RS PTRS FOR NEW
                                      3009  *  RESET REC VAR FOR PRIOR
   003605    7 00512 2221 00          3010         LDX     X2,RVT,,PR7
   003606    7 00700 2371 00          3011         LDAQ    KCREG,,PR7
   003607    7 00000 7551 12          3012         STA     DBKEY,X2,PR7    RESTORE DBK OF PRIOR
   003610    7 00014 7561 12          3013         STQ     CBRCE,X2,PR7    RESTORE ENTRY & PTR OFSTS OF PRIOR
   003611    7 00702 2351 00          3014         LDA     KCREG+2,,PR7
   003612    7 00015 7551 12          3015         STA     CBRPA,X2,PR7    RESTORE DBK OF PA OWNER FOR PRIOR
   003613                             3016  DERET2 NULL
   003613  X 000000 7020 00           3017         DBRET
                                      3018  *
                                      3019  *  ERRORS DETECTED IN THIS PRIMITIVE
                                      3020  *
   003614                             3021  NRCE2  NULL                    RS FOR PA REC NOT FOUND
   003614    303243 2350 07           3022         LDA     SSER,DL
   003615    000000 6200 00           3023         EAX     X0,0            NULL AC PTR
   003616    000000 6270 00           3024         EAX     X7,0            NULL RC PTR
   003617 (0)003624 7100 00           3025         TRA     DECER
                                      3026  *
                                      3027  *
                                      3028  *
                                      3029  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                      3030  *
   003620                             3031  PANP2  NULL                    PA REC NOT FOUND
   003620                             3032  PGER5  NULL                    ERROR FINDING PA RECORD
   003620                             3033  VOER3  NULL                    ERROR VERIFYING OFFSETS OF CURR
   003620                             3034  DPER1  NULL                    ERROR DELETING PTR GROUP
   003620                             3035  DEOE1  NULL                    ERROR DELETING ENTRY OCCURRENCE
   003620                             3036  DPAE1  NULL                    ERROR DELETING PA RECORD
   003620                             3037  PNPE3  NULL                    CURR REC NOT FOUND
   003620                             3038  FDER3  NULL                    ERROR FINDING CURR REC
   003620 (0)003624 7100 00           3039         TRA     DECER
                                      3040  *
                                      3041  *   ERRORS DETECTED IN I/O ROUTINES
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE PA ENTRY AND DELINK                                 95   BMAP - B00     
                                      3042  *
   003621                             3043  SMWER8 NULL                    ERROR SETTING MUST WRITE SWITCH
   003621    000000 6260 00           3044         EAX     X6,0            NULL SC PTR
   003622    000000 6270 00           3045         EAX     X7,0            NULL RC PTR
   003623 (0)003624 7100 00           3046         TRA     DECER
                                      3047  *  COMMON ERROR RETURN
   003624                             3048  DECER  NULL
   003624  X 000000 7020 00           3049         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE ENTRY OCCURRANCE                                    96   BMAP - B00     
                                      3050         TTLS    DELETE ENTRY OCCURRANCE
                                      3051  *
                                      3052  *  DELETE ENTRY OCCURRANCE IN A PA RECORD
                                      3053  *
                                      3054  *    INPUT ARGUMENTS:
                                      3055  *      RVPA - DBK OF PA RECORD
                                      3056  *             RECORD ADDRESS
                                      3057  *             BUFFER ADDRESS
                                      3058  *             RC PTR
                                      3059  *             SC PTR
                                      3060  *
                                      3061  *      ESZ  - SIZE OF A PA ENTRY
                                      3062  *
                                      3063  *      PAEN-  PA ENTRY NUMBER IN DBCB
                                      3064  *
                                      3065  *      AR  -  PA ENTRY OFFSET
                                      3066  *
                                      3067  *    OUTPUT ARGUMENTS:
                                      3068  *      ENTRY DELETED FROM PA RECORD AND POINTER ARRAY
                                      3069  *      CONTROL WORD UPDATED
                                      3070  *
                                      3071  *    EXCEPTION: NONE
                                      3072  *
   003625                             3073  ZIG$DBADO NULL
   003625    7 00470 7411 56          3074         ICSAV
   003626    7 00513 2211 00          3075         LDX     X1,RVPA,,PR7
   003627    7 00745 5511 14          3076         STBA    PAEO,14,PR7     SAVE PA ENTRY OFFSET
                                      3077  *  SET MUST WRITE SWITCH
   003630    7 00513 2231 00          3078        LDX     X3,RVPA,,PR7
   003631  X 000000 7010 00           3079        DBCAL   ZIM$DBPMR,NOEXC,SMWER7
   003632 (0)003713 7020 00
                                      3080  *  MOVE PA CONTROL WORD TO WORKSPACE
   003633    7 00513 2211 00          3081         LDX     X1,RVPA,,PR7
   003634    7 00002 4735 11          3082         LDP     PR3,RADDR,X1,PR7  GET ADDRESS OF PA REC
   003635    000 1 100 1005 00        3083         MLR     (1),(1),,1         * MOVE
   003636    3 00001 0 0 0 0004       3084         ADSC9   PACW,0,4,PR3         *  POINTER ARRAY CONTROL WORD
   003637    7 00732 0 0 0 0004       3085         ADSC9   DEPCW,0,4,PR7        *   TO WORKSPACE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE ENTRY OCCURRANCE                                    97   BMAP - B00     
   003640    7 00732 2241 00          3086      LDX X4,DEPCW,,PR7        get PARCW
   003641    400000 3640 03           3087      ANX X4,.PANLL,DU         see if lowest
   003642 (0)003662 6000 00           3088      TZE NMVKEY               no
   003643    7 00745 2221 00          3089      LDX X2,PAEN,,PR7         get PA entry number
   003644    000001 1020 03           3090      CMPX X2,.B17,DU          is it first entry?
   003645 (0)003662 6010 00           3091      TNZ NMVKEY               not 1st
   003646    7 00725 7241 00          3092      LXL X4,ESZ,,PR7          get size of PA ENTRY
   003647    7 00720 1241 00          3093      SBLX X4,PTESZ,,PR7       subtract out type and ptr
   003650    7 00745 2351 00          3094      LDA PAEO,,PR7            get PA entry ofset
   003651    777777 3750 07           3095      ANA -1,DL                isolate
   003652    000022 7350 00           3096      ALS 18                   position AR
   003653    7 00720 0351 00          3097      ADLA PTESZ,,PR7          increase by amt of size + ptr
   003654    000000 6220 01           3098      EAX X2,,AU               store start location in X2
   003655    000022 7710 00           3099      ARL 18                   position AR
   003656    7 00725 0351 00          3100      ADLA ESZ,,PR7            increase to start of destination
   003657    000 1 145 1005 52        3101      MLR (1,1,,2),(1,1,,AL),,1   *move key
   003660    3 00000 0 0 0 0014       3102      ADSC9 0,0,4,PR3             *from 1st entry
   003661    3 00000 0 0 0 0014       3103      ADSC9 0,0,4,PR3             *to 2nd
   003662                             3104  NMVKEY NULL
                                      3105  *  CALCULATE SIZE OF MOVE TO COMPACT ENTRIES
   003662    7 00732 2221 00          3106         LDX     X2,DEPCW,,PR7   GET NO. OF ENTRIES IN PA REC
   003663    017777 3620 03           3107         ANX     X2,.NOENT,DU    ISOLATE
   003664    7 00745 1221 00          3108         SBLX    X2,PAEN,,PR7    SUBTRACT ENTRY NO. TO BE DELETED
   003665    000000 6360 12           3109         EAQ     ,X2             INTO QR
   003666    000022 7720 00           3110         QRL     18              INTO QL FOR MULTIPLY
   003667    7 00725 4021 00          3111         MPY     ESZ,,PR7        QR = SIZE OF MOVE
                                      3112  *  UPDATE PA CONTROL WORD
                                      3113  *    INCREMENT SPACE AVAILABLE BY ENTRY SIZE AND
                                      3114  *    DECREMENT NO. OF ENTRIES BY 1.
   003670    7 00732 2231 00          3115         LDX     X3,DEPCW,,PR7   GET NO. OF ENTRIES
   003671    000001 1230 03           3116         SBLX    X3,1,DU         DECREMENT BY 1
   003672    7 00732 7431 00          3117         STX     X3,DEPCW,,PR7   SAVE IN PA CONTROL WORD
   003673    7 00732 2351 00          3118         LDA     DEPCW,,PR7      GET SPACE AVAIL IN PA REC
   003674    777777 3750 07           3119         ANA     -1,DL           ISOLATE
   003675    7 00725 0351 00          3120         ADLA    ESZ,,PR7        INCREMENT BY ENTRY SIZE
   003676    7 00732 5511 14          3121         STBA    DEPCW,14,PR7    SAVE IN PA CONTROL WORD
   003677    7 00745 2351 00          3122         LDA     PAEO,,PR7       GET OFST OF ENTRY TO BE DELETED
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE ENTRY OCCURRANCE                                    98   BMAP - B00     
   003700    777777 3750 07           3123         ANA     -1,DL           ISOLATE
   003701    000000 6220 05           3124         EAX     X2,,AL          SET X2 = DESTINATION OF MOVE
   003702    7 00725 0351 00          3125         ADLA    ESZ,,PR7        SET AR = SOURCE OF MOVE (START LOC)
                                      3126  *  COMPACT PA ENTRIES:
                                      3127  *    QL = SIZE OF MOVE
                                      3128  *    AL = SOURCE
                                      3129  *    X2 = DESTINATION
                                      3130  *
   003703    000 1 152 1005 45        3131         MLR     (1,1,,AL),(1,1,,2),,1   * COMPACT
   003704    3 00000 0 0 0 0006       3132         ADSC9   0,0,QL,PR3            *  ENTRIES
   003705    3 00000 0 0 0 0006       3133         ADSC9   0,0,QL,PR3            *   IN PA RECORD
                                      3134  *  MOVE UPDATED PA CONTROL WORD TO PA RECORD
   003706    000 1 100 1005 00        3135         MLR     (1),(1),,1         * MOVE
   003707    7 00732 0 0 0 0004       3136         ADSC9   DEPCW,0,4,PR7        *  UPDATED PA CONTROL WORD
   003710    3 00001 0 0 0 0004       3137         ADSC9   PACW,0,4,PR3         *   TO WORKSPACE
                                      3138  *  NORMAL RETURN
   003711                             3139  DORET  NULL
   003711    7 00470 2211 54          3140         ICRET
   003712    000001 7100 11
                                      3141  *
                                      3142  *  ERRORS DETECTED BY THIS PRIMITIVE
                                      3143  *
                                      3144  *
                                      3145  *
                                      3146  *
                                      3147  *  ERRORS DETECTED BY SUBORDINATE ROUTINES
                                      3148  *
                                      3149  *
                                      3150  *
                                      3151  *
                                      3152  *  ERRORS DETECTED BY I/O ROUTINES
                                      3153  *
   003713                             3154  SMWER7 NULL                    ERROR SETTING MUST WRITE
   003713    000000 6260 00           3155         EAX     X6,0            NULL SC PTR
   003714    000000 6270 00           3156         EAX     X7,0            NULL RC PTR
                                      3157  *  COMMON ERROR RETURN
   003715                             3158  DOCER  NULL
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE ENTRY OCCURRANCE                                    99   BMAP - B00     
   003715  X 000000 7020 00           3159         ICALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER ARRAY RECORD                                100  BMAP - B00     
                                      3160         TTLS    DELETE POINTER ARRAY RECORD
                                      3161  *
                                      3162  *  DELETE POINTER ARRAY RECORD
                                      3163  *
                                      3164  *    THIS ROUTINE WILL DISCONNECT A POINTER ARRAY
                                      3165  *    RECORD FROM THE POINTER ARRAY CHAIN AND
                                      3166  *    DELETE THE POINTER ARRAY RECORD.
                                      3167  *
                                      3168  *  INPUT ARGUMENTS:
                                      3169  *    RVPA - DBK OF PA RECORD
                                      3170  *           ADDRESS OF BUFFER
                                      3171  *           ADDRESS OF RECORD
                                      3172  *           AC PTR
                                      3173  *
                                      3174  *  OUTPUT ARGUMENTS:
                                      3175  *    PA RECORD DELETED
                                      3176  *
                                      3177  *  EXCEPTION: NONE
                                      3178  *
   003716                             3179  ZIG$DBADR NULL
   003716  X 000000 7000 00           3180         DBSAV
   003717    000004 000000
                                      3181  *  SET INDICATOR TO NOT USE PA RECORDS IF PA SET
   003720    000001 6210 00           3182         EAX     X1,1
   003721    7 00735 4411 00          3183         SXL     X1,DUSEPA,,PR7  SET INDIC. TO NOT USE PA
   003722    7 00510 2351 00          3184         LDA     RVI,,PR7        * REVERSE
   003723    7 00513 2361 00          3185         LDQ     RVPA,,PR7       *  IN AND
   003724    7 00513 7551 00          3186         STA     RVPA,,PR7       *   PA
   003725    7 00510 7561 00          3187         STQ     RVI,,PR7        *    RECORD VARIABLES
                                      3188  *  LOCK BUFFER FOR PA RECORD TO DELETE
   003726    7 00510 2231 00          3189        LOCK    RVI
   003727  X 000000 7010 00
   003730    000000 0020 00
                                      3190  *  FIND PRIOR RECORD IN SET
   003731  X 000000 7010 00           3191         DBCAL   ZIG$DBPFP,ORFND,FPER1  FIND PRIOR PA RECORD
   003732 (0)004043 7020 00
   003733    5 00006 2341 00
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER ARRAY RECORD                                101  BMAP - B00     
   003734    000003 6000 04
   003735    5 00006 4501 00
   003736 (0)003766 7020 00
   003737    7 00511 2351 00          3192         LDA     RVO,,PR7        * REVERSE
   003740    7 00512 2361 00          3193         LDQ     RVT,,PR7        *  OUTPUT
   003741    7 00512 7551 00          3194         STA     RVT,,PR7        *   AND TEMP
   003742    7 00511 7561 00          3195         STQ     RVO,,PR7        *    RECORD VARIABLES
   003743    7 00714 2211 00          3196         LDX     X1,PARCW,,PR7       GET CONTROL WORD AGAIN
   003744    140000 3610 03           3197         ANX     X1,.PAFIL+.PALIL,DU GET PAFIL AND PALIL BITS
   003745    140000 1010 03           3198         CMPX    X1,.PAFIL+.PALIL,DU BOTH BITS SET?
   003746 (0)003776 6000 00           3199         TZE     DELIT               YES - REC IS FIRST AND LAST, JUST DEL IT
   003747  X 000000 7010 00           3200         DBCAL   ZIM$PDIS,,DSPAE     EITHER PRIOR OR NEXT EXISTS
   003750 (0)004043 7020 00
   003751    5 00006 2341 00
   003752    777776 6010 04
   003753    7 00714 2211 00          3201         LDX     X1,PARCW,,PR7
   003754    100000 3010 03           3202         CANX    X1,.PAFIL,DU        IS THE REC FIRST IN ITS LEVEL?
   003755 (0)003761 6000 00           3203         TZE     CHKLIL              NO - CHK IF LAST IN LEVEL
                                      3204  *  REC TO BE DELETED IS FIRST IN LEVEL. SO SET ITS NEXT REC PAFIL BIT
   003756  X 000000 7010 00           3205        DBCAL   ZIM$JPAFIL,,NOALT   UPDATE THE PAFIL BIT AND JOURNAL IT
   003757    000000 0020 00
   003760    7 00714 2211 00          3206        LDX     X1,PARCW,,PR7       RESTORE $X1
   003761                             3207  CHKLIL NULL
   003761    040000 3010 03           3208         CANX    X1,.PALIL,DU        IS THIS REC LAST IN LEVEL?
   003762 (0)003776 6000 00           3209         TZE     DELIT               NO - NO NEED SET PALIL FOR PRIOR
                                      3210  *  REC TO BE DELETED IS LAST IN LEVEL. SO SET ITS PRIOR REC PALIL
   003763  X 000000 7010 00           3211        DBCAL   ZIM$JPALIL,,NOALT   UPDATE THE PALIL BIT AND JOURNAL IT
   003764    000000 0020 00
   003765 (0)003776 7100 00           3212         TRA     DELIT               THEN DELETE THE RECORD
                                      3213  *  DISCONNECT RECORD FROM SET
   003766                             3214  ORFND  NULL
   003766    7 00511 2351 00          3215        LDA    RVO,,PR7
   003767    7 00512 2361 00          3216        LDQ    RVT,,PR7
   003770    7 00512 7551 00          3217        STA    RVT,,PR7            RVT HAS THE PRIOR REC
   003771    7 00511 7561 00          3218        STQ    RVO,,PR7
   003772  X 000000 7010 00           3219        DBCAL  ZIM$PDIS,,DSPAE     DISCONNECT PA REC
   003773 (0)004043 7020 00
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER ARRAY RECORD                                102  BMAP - B00     
   003774    5 00006 2341 00
   003775    777776 6010 04
   003776                             3220  DELIT NULL
   003776  X 000000 7010 00           3221        DBCAL   ZIM$JDEL,,NOALT       JOURNAL DELETED RECORD
   003777    000000 0020 00
   004000    7 00510 2211 00          3222        LDX     X1,RVI,,PR7
   004001    7 00003 2361 11          3223        LDQ     RECSZ,X1,PR7        GET REC SIZE
   004002    000022 7720 00           3224        QRL     18                  CLEAR OUT LOWER HALF
   004003    000020 7360 00           3225        QLS     16                  MAKE IT POINTER FORMAT
   004004    7 00730 7561 00          3226        STQ     MEMPTR,,PR7
                                      3227  *  DELETE PA RECORD
   004005  X 000000 7010 00           3228         DBCAL   ZIG$DBPDR,,DLPAE   DELETE PA
   004006 (0)004043 7020 00
   004007    5 00006 2341 00
   004010    777776 6010 04
                                      3229  *  UNLOCK BUFFER
   004011    7 00510 2211 00          3230         LDX     X1,RVI,,PR7
   004012    7 00001 2351 11          3231        LDA     BADDR,X1,PR7        GET PAGE CONTAINING DELETED PA_REC
   004013    7 00513 2231 00          3232        LDX     X3,RVPA,,PR7        CHECK PA MEMBER ADDR
   004014 (0)004021 7020 00           3233        TSX     X2,CHKSUB
   004015    7 00511 2231 00          3234        LDX     X3,RVO,,PR7         CHECK REC IN RVO
   004016 (0)004021 7020 00           3235        TSX     X2,CHKSUB
   004017    7 00512 2231 00          3236        LDX     X3,RVT,,PR7         CHECK REC ADDR IN RVT
   004020 (0)004031 6220 00           3237        EAX     X2,CHKRET
   004021                             3238  CHKSUB NULL                       INTERNAL SUBROUTINE
   004021    7 00001 1151 13          3239        CMPA    BADDR,X3,PR7        ARE THEY IN THE SAME PAGE
   004022    000000 6010 12           3240        TNZ     0,X2                NO - THEN OK
   004023    7 00002 2361 13          3241        LDQ     RADDR,X3,PR7        GET REC ADDR
   004024    7 00002 1161 11          3242        CMPQ    RADDR,X1,PR7        IS IT IN LOWER ADDR THEN DELETED REC
   004025    000000 6040 12           3243        TMI     0,X2                YES - THEN ADDR STILL GOOD
   004026    7 00730 1361 00          3244        SBLQ    MEMPTR,,PR7         ADJ TO NEW ADDR BY DELETED REC LEN
   004027    7 00002 7561 13          3245        STQ     RADDR,X3,PR7
   004030    000000 7100 12           3246        TRA     0,X2                RETURN
   004031                             3247  CHKRET NULL
   004031    7 00510 2231 00          3248        UNLOCK  RVI
   004032  X 000000 7010 00
   004033    000000 0020 00
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER ARRAY RECORD                                103  BMAP - B00     
   004034    7 00510 2351 00          3249         LDA     RVI,,PR7        * REVERSE
   004035    7 00513 2361 00          3250         LDQ     RVPA,,PR7       *  INPUT
   004036    7 00513 7551 00          3251         STA     RVPA,,PR7       *   AND PA
   004037    7 00510 7561 00          3252         STQ     RVI,,PR7        *    RECORD VARIABLES
                                      3253  *  RESET INDICATOR TO USE PA RECORDS
   004040    000000 6210 00           3254         EAX     X1,0
   004041    7 00735 4411 00          3255         SXL     X1,DUSEPA,,PR7  RESET INDIC. TO USE PA
                                      3256  *  RETURN
   004042  X 000000 7020 00           3257         DBRET                   NORMAL RETURN
                                      3258  *
                                      3259  *  ERRORS DETECTED IN THIS PRIMITIVE
                                      3260  *
                                      3261  *
                                      3262  *
                                      3263  *
                                      3264  *  ERRORS DETECTED BY SUBORDINATE ROUTINES
                                      3265  *
   004043                             3266  FPER1  NULL                    ERROR FINDING PRIOR REC
   004043                             3267  DSPAE  NULL                    ERROR DISCONNECTING PA FROM SET
   004043                             3268  DLPAE  NULL                    ERROR DELETING PA RECORD
   004043 (0)004046 7100 00           3269         TRA     DRCER
                                      3270  *
                                      3271  *  ERRORS DETECTED IN I/O ROUTINES
                                      3272  *
   004044                             3273  LKBE1  NULL                    ERROR LOCKING BUFFER OF PA TO DELETE
   004044                             3274  ULKBE1 NULL                    ERROR UNLOCKING BUFFER OF PA
   004044    000000 6260 00           3275         EAX     X6,0            NULL SC PTR
   004045    000000 6270 00           3276         EAX     X7,0            NULL RC PTR
                                      3277  *  COMMON ERROR RETURN
   004046                             3278  DRCER  NULL
   004046  X 000000 7020 00           3279         DBALT

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER GROUP OCCURRENCE                            104  BMAP - B00     
                                      3280         TTLS    DELETE POINTER GROUP OCCURRENCE
                                      3281  *
                                      3282  *  DELETE POINTER GROUP OCCURRENCE
                                      3283  *
                                      3284  *    THIS ROUTINE WILL DELETE AN ENTIRE POINTER GROUP OCCURRENCE
                                      3285  *    FROM A POINTER ARRAY RECORD.  IT WILL ALSO MOVE OTHER POINTER
                                      3286  *    GROUPS, IF NECESSARY, IN ORDER TO MAINTAIN THE SPACE AVAILABLE
                                      3287  *    BETWEEN THE ENTRY OCCURRENCES AND THE POINTER GROUP OCCURRENCES.
                                      3288  *    IF POINTER GROUPS ARE MOVED, THE OFFSETS TO THESE GROUPS IN
                                      3289  *    THE CORRESPONDING ENTRY OCCURRENCES WILL BE UPDATED.  ALSO,
                                      3290  *    SPACE AVAILABLE WILL BE INCREMENTED IN THE POINTER ARRAY
                                      3291  *    CONTROL WORD.
                                      3292  *
                                      3293  *    INPUT ARGUMENTS:
                                      3294  *      RVPA - DBK OF PA
                                      3295  *             ADDRESS OF PA REC
                                      3296  *             BUFFER ADDRESS OF PA REC
                                      3297  *             AC PTR
                                      3298  *             RC PTR
                                      3299  *             SC PTR
                                      3300  *             RS PTR
                                      3301  *
                                      3302  *      AR = OFFSET WITHIN PA REC OF THE POINTER GROUP TO DELETE
                                      3303  *
                                      3304  *      PGSIZE = SIZE (IN BYTES) OF THE POINTER GROUP TO DELETE
                                      3305  *
                                      3306  *
                                      3307  *    OUTPUT ARGUMENTS:
                                      3308  *      PTR GROUP DELETED & SPACE AVAILABLE UPDATED
                                      3309  *
                                      3310  *
                                      3311  *    EXCEPTION: NONE
                                      3312  *
   004047                             3313  ZIG$DBADP NULL
   004047    7 00470 7411 56          3314         ICSAV
   004050    000000 6210 05           3315         EAX     X1,,AL
   004051    7 00734 7411 00          3316         STX     X1,PAPOF,,PR7   SAVE OFFSET OF PTR GROUP
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER GROUP OCCURRENCE                            105  BMAP - B00     
                                      3317  *  SET MUST WRITE FOR PA RECORD
   004052    7 00513 2231 00          3318        LDX     X3,RVPA,,PR7
   004053  X 000000 7010 00           3319        DBCAL   ZIM$DBPMR,NOEXC,SMWE10
   004054 (0)004156 7020 00
                                      3320  *  MOVE POINTER ARRAY CONTROL WORD TO WORKSPACE
   004055    7 00513 2201 00          3321         LDX     X0,RVPA,,PR7
   004056    7 00002 4735 10          3322         LDP     PR3,RADDR,X0,PR7  GET ADDRESS OF PA REC
   004057    000 1 100 1005 00        3323         MLR     (1),(1),,1         * MOVE
   004060    3 00001 0 0 0 0004       3324         ADSC9   PACW,0,4,PR3         *  POINTER ARRAY CONTROL WORD
   004061    7 00732 0 0 0 0004       3325         ADSC9   DEPCW,0,4,PR7        *   TO WORKSPACE
                                      3326  *  UPDATE SPACE AVAILABLE IN PA CONTROL WORD
   004062    7 00732 2361 00          3327         LDQ     DEPCW,,PR7      GET SPACE AVAILABLE
   004063    000000 6230 06           3328         EAX     X3,,QL          SET X3 = SPACE AVAIL
   004064    7 00676 7431 00          3329         STX     X3,TMPPA,,PR7   SAVE IN TEMP LOC FOR LATER
   004065    777777 3760 07           3330         ANQ     -1,DL           ISOLATE
   004066    7 00746 0361 00          3331         ADLQ    PGSIZE,,PR7     ADD SIZE OF PTR GROUP
   004067    7 00732 5521 14          3332         STBQ    DEPCW,14,PR7    SAVE AS NEW SPACE AVAIL
                                      3333  *  DELETE POINTER GROUP BY COMPACTING PTR GROUPS IN PA REC
                                      3334  *    CALCULATE X1 = OFSET OF SOURCE FOR COMPACTION = STARTING BYTE +
                                      3335  *                   (NO. OF ENTRIES * ENTRY SIZE) + SPACE AVAILABLE.
                                      3336  *
                                      3337  *                   THIS IS THE OFFSET OF THE START OF POINTER GROUPS IN
                                      3338  *                   PA RECORD.
   004070    7 00006 2271 10          3339         LDX     X7,RCPTR,X0,PR7  GET RC PTR FOR PA REC
   004071    6 77776 2351 17          3340         LDA     CSPES,X7,PR6    GET ENTRY SIZE
   004072    777777 3750 07           3341         ANA     -1,DL           ISOLATE
   004073    7 00747 7551 00          3342         STA     PAESZ,,PR7      SAVE
   004074    7 00732 2361 00          3343         LDQ     DEPCW,,PR7      GET NO. OF ENTRIES IN PA REC
   004075    017777 3760 03           3344         ANQ     .NOENT,DU       ISOLATE NO. OF ENTRIES
   004076    000022 7720 00           3345         QRL     18              INTO QL FOR MULTIPLY
   004077    7 00747 4021 00          3346         MPY     PAESZ,,PR7      MULTIPLY BY ENTRY SIZE
   004100    000000 6210 06           3347         EAX     X1,,QL
   004101    6 77776 0211 17          3348         ADLX    X1,CSPSB,X7,PR6  ADD STARTING BYTE
   004102    7 00676 0211 00          3349         ADLX    X1,TMPPA,,PR7   ADD SPACE AVAIL
                                      3350  *    CALCULATE AR = OFFSET OF DESTINATION FOR COMPACTION =
                                      3351  *                   SOURCE + SIZE OF PTR GROUP
   004103    000000 6350 11           3352         EAA     ,X1             SET AR = SOURCE
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER GROUP OCCURRENCE                            106  BMAP - B00     
   004104    000022 7710 00           3353         ARL     18              INTO AL
   004105    7 00746 0351 00          3354         ADLA    PGSIZE,,PR7     ADD SIZE OF PTR GROUP
                                      3355  *    CALCULATE X3 = SIZE OF COMPACTION MOVE =
                                      3356  *                   OFFSET OF PTR GROUP - OFFSET OF SOURCE
   004106    7 00676 7411 00          3357         STX     X1,TMPPA,,PR7   PUT SOURCE OFFSET IN TEMP LOC
   004107    7 00734 2231 00          3358         LDX     X3,PAPOF,,PR7   GET OFFSET OF PTR GROUP
   004110    7 00676 1231 00          3359         SBLX    X3,TMPPA,,PR7   SUBTRACT OFFSET OF BEGIN OF PTR GRPS TO G
   004111    000 1 145 1015 51        3360         MRL     (1,1,,1),(1,1,,AL),,1   * COMPACT
   004112    3 00000 0 0 0 0013       3361         ADSC9   0,0,X3,PR3                *  PTR GROUPS
   004113    3 00000 0 0 0 0013       3362         ADSC9   0,0,X3,PR3                *   IN PA RECORD
                                      3363  *  MOVE UPDATED PA CONTROL WORD TO PA RECORD
                                      3364  *
                                      3365  *
                                      3366  *  UPDATE OFFSETS TO PTR GROUPS IF OFFSETS CHANGED
   004114                             3367  UOFF   NULL
   004114    7 00732 2211 00          3368         LDX     X1,DEPCW,,PR7   GET NO. OF ENTRIES IN PA REC
   004115    017777 3610 03           3369         ANX     X1,.NOENT,DU    ISOLATE
   004116    7 00513 2201 00          3370         LDX     X0,RVPA,,PR7
   004117    7 00006 2271 10          3371         LDX     X7,RCPTR,X0,PR7  GET RC PTR FOR PA REC
   004120    6 77776 2221 17          3372         LDX     X2,CSPSB,X7,PR6  INIT ENTRY OFFSET = STARTING BYTE
   004121    7 00004 7251 10          3373         LXL     X5,RSPTR,X0,PR7  GET RS PTR FOR PA REC
   004122                             3374  UOLP   NULL                    UPDATE OFFSETS LOOP
   004122    777777 6210 11           3375         EAX     X1,-1,X1        DECREMENT ENTRY COUNT
   004123 (0)004154 6040 00           3376         TMI     DPRET           DONE
   004124    7 00002 4735 10          3377         LDP     PR3,RADDR,X0,PR7  SET PR3 = ADDR OF PA REC
   004125    3 00000 5005 12          3378         A9BD    ,X2,PR3         SET PR3 = ADDR OF NEXT ENTRY
   004126    000 1 100 1005 00        3379         MLR     (1),(1),,1         * MOVE
   004127    3 00000 0 0 0 0002       3380         ADSC9   0,0,2,PR3            *  TYPE FIELD & INDIC. FROM PA ENTRY
   004130    7 00727 4 0 0 0002       3381         ADSC9   MEMTYP,2,2,PR7       *   TO WORKSPACE
   004131    000 1 100 1015 20        3382         MRL     (1,,1),(1),,1      * MOVE
   004132    6 00007 0001 15          3383         ARG     CSMPP,X5,PR6       *  POINTER FROM PA ENTRY
   004133    7 00730 0 0 0 0004       3384         ADSC9   MEMPTR,0,4,PR7       *   TO WORKSPACE
   004134    7 00727 7231 00          3385         LXL     X3,MEMTYP,,PR7  GET PTR INDICATOR FROM ENTRY
   004135 (0)004147 6050 00           3386         TPL     ITNE            NO PTR GRP PRESENT - GO INCREMENT TO NEXT
   004136    7 00730 2351 00          3387         LDA     MEMPTR,,PR7     GET OFFSET OF CURRENT ENTRY
   004137    000000 6230 05           3388         EAX     X3,,AL          PUT OFST INTO X3
   004140    7 00734 1031 00          3389         CMPX    X3,PAPOF,,PR7   HAS OFST CHANGED DUE TO DELETION OF PTR G
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER GROUP OCCURRENCE                            107  BMAP - B00     
   004141 (0)004147 6030 00           3390         TRC     ITNE            NO - GET NEXT ENTRY
   004142    7 00746 0351 00          3391         ADLA    PGSIZE,,PR7     YES - ADD SIZE OF PTR GROUP
   004143    7 00730 7551 00          3392         STA     MEMPTR,,PR7     SAVE NEW OFFSET OF PTR GROUP
   004144    000 0 120 1015 00        3393         MRL     (1),(1,,1)         * MOVE
   004145    7 00730 0 0 0 0004       3394         ADSC9   MEMPTR,0,4,PR7       *  NEW OFFSET OF PTR GROUP
   004146    6 00007 0001 15          3395         ARG     CSMPP,X5,PR6       *   TO ENTRY
   004147                             3396  ITNE   NULL                    INCREMENT TO NEXT ENTRY
   004147    000000 6350 12           3397         EAA     ,X2
   004150    000022 7710 00           3398         ARL     18
   004151    7 00747 0351 00          3399         ADLA    PAESZ,,PR7      INCREMENT CURR ENTRY OFST BY ENTRY SIZE
   004152    000000 6220 05           3400         EAX     X2,,AL
   004153 (0)004122 7100 00           3401         TRA     UOLP            GET NEXT ENTRY
                                      3402  *
                                      3403  *
                                      3404  *  RETURN
   004154                             3405  DPRET  NULL
   004154    7 00470 2211 54          3406         ICRET
   004155    000001 7100 11
                                      3407  *
                                      3408  *
                                      3409  *
                                      3410  *  ERRORS DETECTED BY THIS ROUTINE
                                      3411  *
                                      3412  *
                                      3413  *
                                      3414  *
                                      3415  *  ERRORS DETECTED IN SUBORDINATE PRIMITIVES
                                      3416  *
                                      3417  *
                                      3418  *
                                      3419  *
                                      3420  *  ERRORS DETECTED IN I/O ROUTINES
                                      3421  *
   004156                             3422  SMWE10 NULL                    ERROR SETTING MUST WRITE FOR PA REC
   004156    000000 6260 00           3423         EAX     X6,0            NULL SC PTR
   004157    000000 6270 00           3424         EAX     X7,0            NULL RC PTR
                                      3425  *
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       DELETE POINTER GROUP OCCURRENCE                            108  BMAP - B00     
                                      3426  *
                                      3427  *  COMMON ERROR RETURN
   004160                             3428  DPCER  NULL
   004160  X 000000 7020 00           3429         ICALT
                                      3430         END

  CONTROL SECTION TABLE

   0 CODE   EVEN  004161
   1 RODATA EVEN  000000 LITERALS

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               109  BMAP - B00     
 40000000 000000200000 .AC            *28
 40000000 000000000100 .AG            *28
 40000000 000000002000 .ALTO          *28
 40000000 000000000077 .ANL           *28
 40000000 000000200000 .APDN          *28
 40000000 000000000100 .ATMP          *28
 40000000 000000400000 .AV            *28
 41000000 000000400000 .B0            *28       527      1941
 40000000 000000200000 .B1            *28
 40000000 000000000200 .B10           *28
 40000000 000000000100 .B11           *28
 40000000 000000000040 .B12           *28
 40000000 000000000020 .B13           *28
 40000000 000000000010 .B14           *28
 40000000 000000000004 .B15           *28
 40000000 000000000002 .B16           *28
 41000000 000000000001 .B17           *28      3090
 40000000 000000400000 .B18           *28
 40000000 000000200000 .B19           *28
 40000000 000000100000 .B2            *28
 40000000 000000100000 .B20           *28
 40000000 000000040000 .B21           *28
 40000000 000000020000 .B22           *28
 40000000 000000010000 .B23           *28
 40000000 000000004000 .B24           *28
 40000000 000000002000 .B25           *28
 40000000 000000001000 .B26           *28
 40000000 000000000400 .B27           *28
 40000000 000000000200 .B28           *28
 40000000 000000000100 .B29           *28
 40000000 000000040000 .B3            *28
 40000000 000000000040 .B30           *28
 40000000 000000000020 .B31           *28
 40000000 000000000010 .B32           *28
 40000000 000000000004 .B33           *28
 40000000 000000000002 .B34           *28
 40000000 000000000001 .B35           *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               110  BMAP - B00     
 40000000 000000020000 .B4            *28
 40000000 000000010000 .B5            *28
 40000000 000000004000 .B6            *28
 40000000 000000002000 .B7            *28
 40000000 000000001000 .B8            *28
 40000000 000000000400 .B9            *28
 40000000 000000000001 .BREAK         *28
 40000000 000000010000 .BRK           *28
 40000000 000000020000 .BTB           *28
 40000000 000000000001 .CAC           *28
 40000000 000000000000 .CAE           *28
 40000000 000000000200 .CANSSS        *28
 40000000 000000000400 .CD            *28
 40000000 000000040000 .CFLC          *28
 40000000 000000400000 .CHKSUM        *28
 40000000 000000100000 .CJRNL         *28
 40000000 000000000077 .CNSZ          *28
 40000000 000000160000 .COMC          *28
 40000000 000000000020 .CONT          *28
 40000000 000000000000 .CSE           *28
 40000000 000000700000 .CTYP          *28
 41000000 000000000270 .DBEST         *28
 41000000 000000000470 .DBIC          *28      3074      3140      3314      3406
 40000000 000000077777 .DBPT          *28
 41000000 000000000370 .DBSTK         *28
 40000000 000000020000 .DELM          *28
 40000000 000000002000 .DIDP          *28
 40000000 000000000077 .DNDX          *28
 40000000 000000600000 .DORD          *28
 40000000 000000000200 .DP            *28
 40000000 000000100000 .DPS           *28
 40000000 000000200000 .DPSA          *28
 40000000 000000400000 .DPST          *28
 40000000 000000000002 .DUMP          *28
 40000000 000000002000 .DUPC          *28
 40000000 000000010000 .DUPP          *28
 40000000 000000200000 .EBCL          *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               111  BMAP - B00     
 40000000 000000400000 .EBCM          *28
 40000000 000000200000 .ENCRP         *28
 40000000 000000000077 .ENDX          *28
 40000000 000000000400 .ENQ           *28
 40000000 000000004000 .ETC           *28
 40000000 000000000400 .EXIT          *28
 40000000 000000000200 .FMOD          *28
 40000000 000000000077 .FNL           *28
 40000000 000000000074 .FORG          *28
 40000000 000000002000 .FR            *28
 40000000 000000000100 .FSR           *28
 40000000 000000003400 .FUSE          *28
 40000000 000000010000 .FVF           *28
 41000000 000000040000 .FVR           *28       176
 40000000 000000000010 .INDEXED       *28
 40000000 000000777777 .IXID          *28
 40000000 000000001777 .IXNUM         *28
 40000000 000000000004 .KEYED         *28
 40000000 000000010000 .LCK           *28
 40000000 000000400000 .LEIL          *28
 41000000 000000001000 .LG            *28        80       140       302       391       787       984
                                     1439      2027      2524      2624      2858
 40000000 000000000002 .LOAD          *28
 40000000 000000020000 .MAR           *28
 41000000 000000000007 .MEMT          *28       765       851      2752
 40000000 000000010000 .MRL           *28
 40000000 000000040000 .MSM           *28
 60000000 000000000001 .N6685         *28
 40000000 000000100000 .NAI           *28
 40000000 000000200000 .NBI           *28
 40000000 000000000002 .NCIA          *28
 40000000 000000040000 .NMV           *28
 41000000 000000017777 .NOENT         *28        65       410      1003      1501      1591      1637
                                     1929      2085      2113      2495      2825      2889      2936
                                     3107      3344      3369
 40000000 000000400000 .OA            *28
 40000000 000000740000 .OPEV          *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               112  BMAP - B00     
 40000000 000000100000 .OSM           *28
 41000000 000000100000 .PAFIL         *28      2497      3197      3198      3202
 41000000 000000200000 .PAHVR         *28      2421
 40000000 000000000001 .PAIA          *28
 41000000 000000040000 .PALIL         *28      2497      3197      3198      3208
 41000000 000000020000 .PALVR         *28      2425
 41000000 000000400000 .PANLL         *28      2507      3087
 40000000 000000400000 .PCKD          *28
 40000000 000000001600 .PMOD          *28
 40000000 000000000520 .PRCSE         *28
 40000000 000000000007 .PSTO          *28
 40000000 000000006040 .PTAS          *28
 40000000 000000010100 .PTCHK         *28
 40000000 000000010200 .PTDEC         *28
 40000000 000000010140 .PTENC         *28
 40000000 000000020000 .RA            *28
 40000000 000000100000 .RC            *28
 40000000 000000400000 .RELEASE       *28
 40000000 000000000017 .RELT          *28
 40000000 000000004000 .RERA          *28
 40000000 000000400000 .RERS          *28
 40000000 000000010000 .RKEY          *28
 40000000 000000000077 .RNL           *28
 40000000 000000200000 .RSTO          *28
 40000000 000000007777 .RTYP          *28
 40000000 000000040000 .SC            *28
 40000000 000000000070 .SETM          *28
 40000000 000000740000 .SETO          *28
 40000000 000000000700 .SETT          *28
 40000000 000000040000 .SFNP          *28
 40000000 000000004000 .SM            *28
 40000000 000000020000 .SMOD          *28
 40000000 000000000077 .SNL           *28
 40000000 000000020000 .SNSS          *28
 41000000 000000010000 .SO            *28       722       777      2502
 40000000 000000100000 .SR            *28
 40000000 000000004000 .SRCR          *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               113  BMAP - B00     
 40000000 000000001000 .SS            *28
 40000000 000000000007 .SSTP          *28
 40000000 000000004000 .SYN           *28
 40000000 000000000040 .SYNC          *28
 40000000 000000020000 .TJRNL         *28
 40000000 000000040000 .TMPLT         *28
 40000000 000000040000 .TRACE         *28
 40000000 000000000001 .TRENTRY       *28
 40000000 000000000012 .TRIDEL        *28
 40000000 000000000021 .TRIDELENQ     *28
 40000000 000000000024 .TRIDEQ        *28
 40000000 000000000013 .TRIMOD        *28
 40000000 000000000022 .TRIMODENQ     *28
 40000000 000000000014 .TRIREAD       *28
 40000000 000000000023 .TRIREADENQ    *28
 40000000 000000000011 .TRISTO        *28
 40000000 000000000020 .TRISTOENQ     *28
 40000000 000000000017 .TRPDEQ        *28
 40000000 000000000004 .TRPMOD        *28
 40000000 000000000016 .TRPMODENQ     *28
 40000000 000000000002 .TRPREAD       *28
 40000000 000000000015 .TRPREADENQ    *28
 40000000 000000000003 .TRPWRITE      *28
 40000000 000000000010 .TRRACC        *28
 40000000 000000000006 .TRRDEL        *28
 40000000 000000000007 .TRRMOD        *28
 40000000 000000000005 .TRRSTO        *28
 40000000 000000004000 .ULCK          *28
 40000000 000000400000 .UPDT          *28
 40000000 000000000040 .VIA           *28
 60000000 000000000001 A              *28
 41000000 000000000002 ABAS           *28        83       143       310       313       394       790
                                      987      1442      1443      2030      2527      2627      2861
 40000000 000000000001 AC             *28
 40000000 777777777760 ACDEF          *28
 40000000 000000211070 ACDNL          *28
 40000000 000000000003 ACID           *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               114  BMAP - B00     
 40000000 000000001016 ACOPN          *28
 40000000 000000000002 ACP            *28
 41000000 000000000005 ACPTR          *28        82       142       153       238       307       393
                                      509       510       730       789       986      1218      1441
                                     2029      2526      2626      2860
 40000000 000000000002 ACRAH          *28
 40000000 000000000001 ACRAN          *28
 40000000 000000001003 ACREC          *28
 40000000 000000000001 ACTDBCB        *28
 40000000 000000000002 ACTDBNO        *28
 40000000 000000001017 ACTP           *28
 40000000 000000000000 ACTSSS         *28
 40000000 000000000000 ACTSZ          *28
 01101000 000000002503 ADPTR         1914     *2054
 40000000 000000210565 AFNP           *28
 40000000 000000000635 AFT            *28
 40000000 000000022124 AIR            *28
 40000000 000000000016 AMAX           *28
 40000000 000000000026 ANAM           *28
 40000000 000000021614 ANR            *28
 00101000 000000003217 AOCER        *2659
 01101000 000000001503 AOER1         1108     *1237
 01101000 000000001324 AOP           1092     *1103
 00101000 000000003214 AORET        *2638
 40000000 000000000001 APNO           *28
 40000000 000000210562 ARGER          *28
 41000000 000000000020 ARGS           *28
 40000000 000000000077 ARGS2          *28
 40000000 000000210713 ARNAF          *28
 40000000 000000000003 ATBL           *28
 40000000 000000000000 ATRIB          *28
 40000000 000000000002 AVLN           *28
 41000000 000000000013 AWS$           *28       150
 40000000 000000000010 AWSZ           *28
 60000000 000000000001 B              *28
 40000000 000000001006 B32N           *28
 40000000 000000001007 B36N           *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               115  BMAP - B00     
 40000000 000000001056 B72N           *28
 41000000 000000000001 BADDR          *28       152       729      3231      3239
 40000000 000000210712 BADSEED        *28
 40000000 777777777765 BDCW           *28
 40000000 000000000633 BEF            *28
 40000000 000000020000 BEFW           *28
 40000000 000000000751 BEMT           *28
 40000000 777777777761 BID            *28
 40000000 777777777762 BIND           *28
 41000000 000000000007 BLKD           *28       577      1294      1295
 40000000 000000303331 BME02          *28
 41000000 000000001203 BMPB           *28
 40000000 000000000652 BN1            *28
 40000000 000000000654 BN2            *28
 40000000 000000000004 BPL            *28
 40000000 000000000015 BPLDBK         *28
 40000000 000000000034 BSPG           *28
 40000000 777777777763 BSTAT          *28
 40000000 000000000750 BTX0           *28
 41000000 000000001160 BUF4           *28
 41000000 000000001170 BUF6           *28
 41000000 000000000000 BUFORG         *28
 40000000 000000001060 BUFRQ          *28
 40000000 000000000006 BURRID         *28
 41000000 000000000020 BWASZ          *28
 01101000 000000000762 BYPS           803      *832
 60000000 000000000001 C              *28
 40000000 000000000050 CAAC           *28
 40000000 000000000050 CACD           *28
 40000000 000000000111 CAG            *28
 40000000 000000001033 CAL            *28
 40000000 000000000026 CALLPM0        *28
 40000000 000000000003 CANSSS         *28
 41000000 000000000003 CBCPA          *28       193
 40000000 000000000002 CBCPO          *28
 41000000 000000000002 CBENO          *28       194
 40000000 000000000014 CBFSZ          *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               116  BMAP - B00     
 40000000 000000000753 CBIB           *28
 40000000 000000001030 CBID           *28
 41000000 000000000014 CBRCE          *28       416       417       419       837       881       946
                                     1011      1013      1049      1064      1068      1072      1093
                                     1134      1201      1902      1903      1987      2144      2155
                                     2504      2541      2725      2777      2789      2829      2864
                                     3013
 41000000 000000000014 CBRCP          *28       908      1028      1071      1913      1948      1952
                                     1958      1959      1960      1961      1988      2038      2059
                                     2062      2068      2069      2070      2071      2096      2102
                                     2140      2784      2897      2975
 40000000 000000001033 CBRID          *28
 41000000 000000000015 CBRPA          *28       291       746       807       835      1073      1095
                                     1132      1203      1906      2563      2727      2731      2863
                                     3015
 40000000 000000000031 CCHAR          *28
 40000000 000000000040 CDBK           *28
 40000000 000000000030 CDES           *28
 00101000 000000000666 CDI           *771
 40000000 000000000110 CDP            *28
 01101000 000000002652 CDPCER        2205     *2207
 01101000 000000001506 CDPER1        1079     *1261
 00101000 000000002646 CDPRET       *2186
 40000000 000000001044 CDPSI          *28
 40000000 000000000002 CDRH           *28
 40000000 000000000003 CDRN           *28
 41000000 000000000002 CDSH           *28       869
 40000000 000000000003 CDSN           *28
 01101000 000000001513 CECER         1222      1242      1265     *1277
 01101000 000000001602 CECER2       *1316      1325
 00101000 000000002131 CEFPG        *1633
 41000000 000000000722 CENTRN         *28       104       114       208
 41000000 000000000722 CENTRO         *28       105       115       210      1675      1743
 40000000 000000000716 CENTRY         *28
 01101000 000000001467 CERET         1182     *1209
 41000000 000000001053 CFCT           *28
 40000000 000000000670 CFLPT1         *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               117  BMAP - B00     
 40000000 000000000672 CFLPT2         *28
 40000000 000000000015 CFSA           *28
 40000000 000000000646 CHDBK          *28
 01101000 000000003761 CHKLIL        3203     *3207
 01101000 000000004031 CHKRET        3237     *3247
 01101000 000000004021 CHKSUB        3233      3235     *3238
 40000000 000000000773 CHR            *28
 40000000 000000000006 CHRD           *28
 40000000 000000000772 CHRO           *28
 40000000 000000007640 CHRTP          *28
 40000000 000000001043 CIAC           *28
 40000000 000000000012 CIAWS          *28
 40000000 000000001051 CIBSI          *28
 40000000 000000000516 CIND           *28
 40000000 000000001041 CINVSZ         *28
 01101000 000000001335 CIPAS         1097     *1110
 40000000 000000001042 CIPG           *28
 40000000 000000001050 CIPSI          *28
 40000000 000000000000 CIRUN          *28
 40000000 000000000002 CIRWS          *28
 01101000 000000000706 CISE           788      *791
 40000000 000000000002 CISWS          *28
 40000000 000000000014 CIWSOF         *28
 01101000 000000001506 CKER1          872     *1262
 40000000 000000303374 CKSM           *28
 00101000 000000001064 CKSPC         *923
 01101000 000000001006 CKVLP         *864       872
 40000000 000000000022 CLCN           *28
 40000000 000000000023 CLCP           *28
 40000000 000000000003 CLCRC          *28
 40000000 000000000003 CLCSC          *28
 40000000 000000000237 CLI            *28
 40000000 000000000026 CLNG           *28
 01101000 000000002021 CLP          *1526      1579
 01101000 000000000245 CMCER          225       233       241       247      *256
 01101000 000000002311 CMER1         1768     *1800
 01101000 000000000034 CMLP1          *86       212
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               118  BMAP - B00     
 01101000 000000000072 CMLP2         *118       206
 40000000 000000000052 CMPL           *28
 01101000 000000002262 CMR           1507     *1765
 01101000 000000000216 CMRET           88      *214
 40000000 000000000002 CN             *28
 40000000 000000303315 CNE1           *28
 01101000 000000000530 CNER1          553      *574
 40000000 000000006034 CNUL           *28
 40000000 000000100000 COB74          *28
 00101000 000000000416 COCER         *474
 01101000 000000001276 COCLVL        1076     *1080
 40000000 000000000001 COFS           *28
 40000000 000000000045 CONCD          *28
 00101000 000000000413 CORET         *450
 40000000 000000007764 CP6PGSZB       *28
 41000000 000000001775 CP6PGSZW       *28
 01101000 000000001506 CPAE1          801     *1250
 01101000 000000002313 CPAE2         1474     *1808
 01101000 000000002313 CPAE3         1415     *1809
 00101000 000000003451 CPG          *2887
 40000000 000000001000 CPGR           *28
 00101000 000000002774 CPOPA        *2371
 41000000 000000000723 CPTRN          *28       103       131       202      1724      1740
 41000000 000000000723 CPTRO          *28       132       204      1674      1715      1741
 60000000 000000000004 CPW            *28
 40000000 000000000112 CRA            *28
 01101000 000000000546 CRCER          580       586      *597
 40000000 000000001004 CRD            *28
 40000000 000000000764 CREC           *28
 40000000 000000006344 CRIT           *28
 40000000 000000006200 CRNUL          *28
 00101000 000000000527 CRRET         *560
 40000000 000000007330 CRST           *28
 41000000 000000001223 CRUN           *28
 41000000 000000000000 CSECT          *28
 41000000 000000000007 CSMPP          *28        68        97       129       429      1026      1493
                                     1556      1679      1719      1895      1995      2000      2048
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               119  BMAP - B00     
                                     2136      2152      2275      2362      2399      2553      2792
                                     2794      2972      2984      3383      3395
 01101000 000000001026 CSN            873      *879
 01101000 000000001030 CSNED          853      *883
 01101000 000000001042 CSNED1         891      *894
 40000000 000000001000 CSPAC          *28
 40000000 000000000004 CSPAH          *28
 41000000 777777777776 CSPES          *28        72       384       897      1063      1512      1925
                                     2081      2282      2511      2774      3340
 41000000 777777777776 CSPSB          *28        75       415       543      1009      1066      1163
                                     1520      1624      1643      1934      2089      2123      2265
                                     2358      2537      2778      2904      2908      2940      3348
                                     3372
 40000000 000000000115 CSTS           *28
 40000000 000000000071 CSUB           *28
 40000000 000000000017 CSZ            *28
 41000000 000000000057 CTMASK         *28       169
 40000000 000000000774 CTPAI          *28
 40000000 000000000240 CURLN          *28
 40000000 000000000236 CURLT          *28
 40000000 000000000770 CURPG          *28
 41000000 000000000001 CURR           *28       189
 40000000 000000000035 CURRS          *28
 40000000 000000000037 CURSS          *28
 40000000 000000001005 CWRT           *28
 40000000 000000000237 CWSOF          *28
 60000000 000000000001 D              *28
 01101000 000000002467 DADJ          2028     *2031
 01101000 000000003206 DADST         2625     *2628
 01101000 000000000342 DAP            392      *396
 40000000 000000000003 DBAN           *28
 40000000 000000000036 DBDR           *28
 40000000 000000000037 DBFN           *28
 40000000 000000000754 DBK            *28
 40000000 000000000777 DBKAC          *28
 41000000 000000000000 DBKEY          *28        78       146       187       192       389       690
                                      725       744       748       792       797       799       809
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               120  BMAP - B00     
                                      935       942       953       970       972      1047      1069
                                     1090      1130      1137      1181      1192      1291      1300
                                     1413      1414      1433      1434      1905      2024      2521
                                     2562      2621      2717      2724      2734      2998      3001
                                     3012
 40000000 000000000000 DBKL           *28
 40000000 000000007474 DBKN           *28
 41000000 000000000776 DBKR           *28
 40000000 000000000777 DBKRQ          *28
 40000000 000000000234 DBKSI          *28
 40000000 000000000651 DBKSR          *28
 40000000 000000000047 DBKYN          *28
 40000000 000000210652 DBLC01         *28
 40000000 000000210653 DBLC05         *28
 40000000 000000303334 DBLC07         *28
 40000000 000000210655 DBLD01         *28
 40000000 000000000010 DBLIM          *28
 40000000 000000000033 DBPKY          *28
 40000000 000000000023 DBRN           *28
 40000000 000000000013 DBSN           *28
 40000000 000000000001 DBST           *28
 40000000 000000000757 DCDSR          *28
 40000000 000000210650 DCE1           *28
 40000000 000000001053 DCPR           *28
 40000000 000000001053 DCPW           *28
 01101000 000000001430 DCR           1105      1112     *1178
 40000000 000000000015 DCTBL          *28
 40000000 000000000032 DDBK           *28
 40000000 000000000006 DDCB           *28
 40000000 000000011754 DDI            *28
 01101000 000000003624 DECER         3025      3039      3046     *3048
 41000000 000000000000 DEF            *28        79       139       175       301       390       721
                                      764       776       786       850       983      1438      2026
                                     2501      2523      2623      2751      2857
 40000000 000000000014 DEF2           *28
 01101000 000000003560 DEJAFP        2833      2944     *2989
 40000000 000000303413 DELAK          *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               121  BMAP - B00     
 01101000 000000003776 DELIT         3199      3209      3212     *3220
 40000000 000000000036 DELRS          *28
 01101000 000000003620 DEOE1         2832     *3035
 41000000 000000000732 DEPCW          *28      3085      3086      3106      3115      3117      3118
                                     3121      3136      3325      3327      3332      3343      3368
 01101000 000000003564 DERET         2852     *2993
 01101000 000000003613 DERET2        2999     *3016
 40000000 000000303414 DLDBK          *28
 40000000 000000210627 DLE1           *28
 40000000 000000303310 DLE2           *28
 40000000 000000210631 DLE3           *28
 01101000 000000004043 DLPAE         3228     *3268
 40000000 000000016040 DNES           *28
 01101000 000000001272 DNEXT         1057     *1078
 00101000 000000003715 DOCER        *3158
 00101000 000000003711 DORET        *3139
 01101000 000000003620 DPAE1         2849     *3036
 01101000 000000002313 DPAE2         1401     *1811
 40000000 777777777777 DPAGN          *28
 01101000 000000003405 DPARC         2827     *2838
 00101000 000000004160 DPCER        *3428
 01101000 000000003620 DPER1         2820     *3034
 01101000 000000002313 DPER2         1735     *1813
 01101000 000000003443 DPFPG         2809     *2874
 00101000 000000002220 DPGOP        *1723
 40000000 000000000020 DPPI           *28
 01101000 000000004154 DPRET         3376     *3405
 01101000 000000001272 DPRIR         1056     *1077
 40000000 000000000053 DPSLW          *28
 01101000 000000004046 DRCER         3269     *3278
 40000000 000000000003 DS             *28
 40000000 000000001063 DSDES          *28
 40000000 000000303316 DSE1           *28
 01101000 000000004043 DSPAE         3200      3219     *3267
 41000000 000000000735 DUSEPA         *28      1363      1786      3183      3255
 61000000 000000000001 E              *28       173
 40000000 000000303251 EDPER          *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               122  BMAP - B00     
 40000000 000000000026 EEIND          *28
 40000000 000000000713 EFIND          *28
 40000000 000000001030 ELO            *28
 40000000 000000210711 ENCPNA         *28
 40000000 000000000007 ENCRP          *28
 40000000 000000000752 ENDSR          *28
 40000000 000000210647 ENE1           *28
 41000000 000000000716 ENIND          *28      1546      1547      2269      2270
 40000000 000000000013 ENTBL          *28
 40000000 000000000710 ENTNO          *28
 41000000 000000000712 ENTPTR         *28      2793      2798      2802      2878
 41000000 000000000717 ENTSZ          *28       386       408       412       418       440      1006
                                     1162      1514      1518      1595      1663      1664      1927
                                     1931      2083      2087      2170
 40000000 000000000711 ENTTYP         *28
 01101000 000000001045 ENUNQ          893      *903
 40000000 000000004064 EOSR           *28
 40000000 000000000004 ES             *28
 41000000 000000000100 ESTSZ          *28
 41000000 000000000725 ESZ            *28        73       211      1496      1566      1688      2303
                                     2309      2512      2514      2536      2776      2781      2891
                                     2962      3092      3100      3111      3120      3125
 40000000 000000000005 ETCADR         *28
 40000000 000000000005 ETCDBNO        *28
 41000000 000000000064 EXCCD          *28      1278      1312
 01101000 000000000314 FACE1          305      *340
 40000000 000000234534 FALRT          *28
 40000000 000000001055 FBF72          *28
 40000000 000000001025 FBU61          *28
 40000000 000000001020 FBUF           *28
 40000000 000000001026 FBUF1          *28
 40000000 000000001027 FBUF4          *28
 40000000 000000001024 FBUF6          *28
 40000000 000000001022 FBUFM          *28
 40000000 000000001021 FBUFU          *28
 40000000 000000001023 FBUMD          *28
 40000000 000000000004 FCN            *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               123  BMAP - B00     
 40000000 000000000051 FCNT           *28
 40000000 000000000002 FCP            *28
 40000000 000000000047 FCSS           *28
 40000000 000000000005 FD             *28
 40000000 000000210637 FDE1           *28
 40000000 000000303320 FDE2           *28
 40000000 000000303321 FDE3           *28
 40000000 000000210642 FDE4           *28
 40000000 000000210643 FDE5           *28
 40000000 000000210644 FDE6           *28
 40000000 000000303325 FDE7           *28
 40000000 000000303326 FDE8           *28
 01101000 000000001503 FDER1         1193     *1236
 01101000 000000001506 FDER2          954     *1259
 01101000 000000003620 FDER3         3002     *3038
 01101000 000000001605 FDER4         1292     *1322
 01101000 000000001605 FDER5         1301     *1324
 01101000 000000001503 FDER6         1145     *1239
 40000000 000000000021 FEASZ          *28
 41000000 000000000740 FETM           *28      1586      1592
 40000000 000000000006 FI             *28
 40000000 000000000103 FIAC           *28
 41000000 000000001100 FIB1           *28
 41000000 000000001130 FIBP           *28
 40000000 000000000000 FIBX           *28
 40000000 000000000102 FICNT          *28
 40000000 000000000005 FIPN           *28
 40000000 000000000054 FKIND          *28
 40000000 000000000015 FLAGS          *28
 40000000 000000000244 FLDDSC         *28
 40000000 000000000046 FLDTL          *28
 40000000 000000000020 FMSBF          *28
 40000000 000000000006 FNAM           *28
 01101000 000000000530 FNER1          530      *573
 40000000 000000000250 FNIND          *28
 40000000 000000000004 FNL            *28
 01101000 000000001506 FNPAE          732     *1260
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               124  BMAP - B00     
 01101000 000000000624 FNXT           720       723      *731
 01101000 000000002313 FOER1          726      1394     *1810
 01101000 000000004043 FPER1         3191     *3266
 40000000 000000000101 FRAC           *28
 01101000 000000000543 FRAE1          516      *585
 40000000 000000000002 FRANGE         *28
 01101000 000000001505 FRCE1          708     *1248
 01101000 000000001505 FRCE2          753     *1247
 01101000 000000001503 FRCE3         1153     *1240
 01101000 000000003263 FRCL         *2748      2754
 01101000 000000000656 FRCLP         *761       767
 40000000 000000211400 FRDNL          *28
 00101000 000000000655 FRS           *759
 40000000 000000200000 FRTRN          *28
 40000000 000000000005 FRWSO          *28
 01101000 000000000530 FSER1          525      *572
 40000000 000000000767 FSLN           *28
 40000000 000000000766 FSOF           *28
 40000000 000000000060 FTIND          *28
 40000000 000000303240 FTLINCR        *28
 40000000 000000000021 FWSSZ          *28
 40000000 000000000246 GACDK          *28
 40000000 000000000014 GDCB           *28
 41000000 000000000006 GERROR         *28       147       163       305       516       525       530
                                      553       708       726       732       753       801       802
                                      815       831       872       936       954      1051      1075
                                     1079      1108      1145      1153      1193      1292      1301
                                     1401      1415      1421      1474      1504      1735      1768
                                     2740      2760      2820      2832      2849      3002      3191
                                     3200      3219      3228
 40000000 000000000016 GINHIB         *28
 41000000 000000000020 GIOAWS         *28       149
 40000000 000000000022 GIOBUF         *28
 40000000 000000000021 GIOPGNO        *28
 01101000 000000000110 GMEMR          106      *133
 01101000 000000000211 GNENT          120      *207
 00101000 000000000204 GNPTR         *201
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               125  BMAP - B00     
 01101000 000000003533 GNXTE        *2958      2978      2985
 40000000 000000000015 GPAGE          *28
 41000000 000000000010 GRETAC         *28      1279      1313
 40000000 000000000011 GRETFR         *28
 41000000 000000000013 GRETRC         *28      1281      1315
 41000000 000000000012 GRETSC         *28      1280      1314
 40000000 000000000025 GRLCW          *28
 01101000 000000000120 GSETM          141      *144
 01101000 000000001056 GSPAV          898      *913
 01101000 000000001057 GSPAV2        *915      1012      1052
 40000000 000000000014 GSTCD          *28
 40000000 000000000007 GSYSERR        *28
 40000000 000000000010 GT             *28
 40000000 000000000046 GTRNAME        *28
 40000000 000000000055 GTRPDCB        *28
 40000000 000000000056 GTRPNO         *28
 40000000 000000000057 GTRRDBK        *28
 40000000 000000000060 GTRRTYPE       *28
 40000000 000000000060 GTRTYPE        *28
 40000000 000000000027 HASH           *28
 40000000 000000000022 HIA            *28
 40000000 000000000775 HIDB           *28
 40000000 000000000003 HIGHDBK        *28
 40000000 000000000004 HIGHPG         *28
 40000000 000000001037 HIL            *28
 40000000 000000000002 HILN           *28
 41000000 000000000006 HPOS           *28       979      1384      1453      2634      2847
 01101000 000000000033 HPTR            81       *84
 40000000 000000000756 IAAC           *28
 40000000 000000001011 IACLN          *28
 40000000 000000001010 IALC           *28
 40000000 000000010314 IAN            *28
 40000000 000000001012 IANLN          *28
 40000000 000000000001 IASID          *27
 40000000 000000020320 ICA            *28
 40000000 000000000023 ICKSMP         *28
 40000000 000000000024 ICKSMV         *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               126  BMAP - B00     
 40000000 000000210742 ICNR           *28
 41000000 000000000020 ICSIZ          *28
 40000000 000000010004 IDBK           *28
 01101000 000000003167 IDCER         2573      2585     *2587
 01101000 000000001506 IDER1          802     *1251
 01101000 000000002313 IDER2         1421     *1812
 40000000 000000012120 IDI            *28
 00101000 000000003154 IDRET        *2561
 40000000 000000000023 IDS            *28
 40000000 000000000011 IF             *28
 40000000 000000000021 IFIPN          *28
 40000000 000000000000 IFR            *28
 40000000 000000234546 IKSEQ          *28
 40000000 000000000113 INAFLAG        *28
 40000000 000000000016 INCHA          *28
 01101000 000000002633 INCRE         2139      2145      2156     *2166
 40000000 000000210566 INNM           *28
 40000000 000000210567 INSS           *28
 40000000 000000210575 INSST          *28
 40000000 000000303241 INTER          *28
 40000000 000000400000 INTII          *28
 40000000 000000000013 INTVL          *28
 40000000 000000001060 INVFLG         *28
 40000000 000000001043 INVOF          *28
 40000000 000000000014 INVT           *28
 40000000 000000000034 IOBLK          *28
 40000000 000000303354 IOCLSD         *28
 40000000 000000303355 IOCLSK         *28
 40000000 000000303257 IOE1           *28
 40000000 000000303264 IOE11          *28
 40000000 000000303265 IOE12          *28
 40000000 000000303266 IOE18          *28
 40000000 000000303260 IOE2           *28
 40000000 000000303261 IOE3           *28
 40000000 000000303262 IOE7           *28
 40000000 000000303263 IOE8           *28
 40000000 000000303363 IOFLSH         *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               127  BMAP - B00     
 40000000 000000210676 IOGDCB         *28
 40000000 000000001002 IOINC          *28
 40000000 000000305160 IOINI          *28
 40000000 000000305155 IONOTIDS       *28
 40000000 000000305154 IONOTKEY       *28
 40000000 000000210677 IOOPND         *28
 40000000 000000210700 IOOPNK         *28
 40000000 000000303361 IORDD          *28
 40000000 000000305156 IOSCHEMA       *28
 40000000 000000001052 IOSTS          *28
 40000000 000000303362 IOWRTD         *28
 41000000 000000000750 IOWS           *28
 40000000 000000000647 IPC            *28
 40000000 000000000650 IPCF           *28
 40000000 000000000006 IROLLFLAG      *28
 40000000 000000010150 IRSN           *28
 01101000 000000000316 ISCER          330      *344
 00101000 000000000305 ISRET         *319
 01101000 000000001244 ISSPC          926     *1053
 40000000 000000000004 ISYSDCB        *28
 40000000 000000000005 ISYSERR        *28
 01101000 000000004147 ITNE          3386      3390     *3396
 40000000 000000000061 ITPTR          *28
 40000000 000000000060 ITRS           *28
 40000000 000000021760 IUM            *28
 40000000 000000000017 IUSZ           *28
 40000000 000000234522 IVDBK          *28
 40000000 000000000011 IXBUF$         *28
 40000000 000000000046 IXFBSZ         *28
 40000000 777777777776 IXID           *28
 40000000 777777777777 IXPLL          *28
 41000000 000000000523 KCARG0         *28      1094      1200
 40000000 000000000524 KCARG3         *28
 41000000 000000000525 KCARG4         *28      1096      1202
 41000000 000000000700 KCREG          *28       692       695       745       749       884       941
                                      944       945       952      1091      1180      1191      1195
                                     1197      1290      1299      1303      1305      2719      2722
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               128  BMAP - B00     
                                     2726      2728      2997      3004      3006      3011      3014
 40000000 000000000006 KDCB           *28
 40000000 000000000666 KEYDS          *28
 41000000 000000000010 KEYPA          *28       421       441       858      1164
 40000000 777777777776 KLNG           *28
 40000000 000000000022 KPASZ          *28
 40000000 000000000006 KWSZ           *28
 40000000 000000000052 LANGC          *28
 40000000 000000001014 LAS            *28
 40000000 000000700000 LCODM          *28
 40000000 000000001045 LDPSI          *28
 40000000 000000001071 LINPT          *28
 00101000 000000004044 LKBE1        *3273
 00101000 000000002314 LKRE2        *1819
 00101000 000000000544 LKRE3         *590
 00101000 000000002314 LKRE4        *1821
 00101000 000000001510 LKRE5        *1269
 40000000 000000001017 LNCNT          *28
 40000000 000000000762 LNNO           *28
 40000000 000000001036 LOL            *28
 40000000 000000000715 LOLIM          *28
 40000000 000000000023 LPASZ          *28
 01101000 000000000306 LPER1          308      *324
 40000000 000000000012 LPP            *28
 40000000 000000257764 LR             *28
 40000000 000000301270 LRA            *28
 40000000 000000000017 LRSZ           *28
 40000000 000000001035 LSPC           *28
 40000000 000000000750 LUPD           *28
 61000000 000000000001 M9             *28
 40000000 000000000013 MD             *28
 00101000 000000000414 MDFE10        *468
 40000000 000000300000 MDQS           *28
 41000000 000000000730 MEMPTR         *28        98       108       130       135       397       428
                                     1027      1030      1557      1558      1680      1681      1692
                                     1693      1718      1939      1940      1981      2012      2032
                                     2033      2047      2137      2142      2147      2149      2151
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               129  BMAP - B00     
                                     2276      2277      2313      2374      2385      2529      2552
                                     2973      2977      2979      2981      2983      3226      3244
                                     3384      3387      3392      3394
 41000000 000000000727 MEMTYP         *28        95        99       126       170       400       423
                                     1655      1656      1942      2009      2022      2043      2134
                                     2138      2357      2361      2394      2398      2519      2547
                                     2951      2952      3381      3385
 00101000 000000000414 MFLE17        *465
 00101000 000000000414 MFLE18        *466
 00101000 000000000414 MFLE19        *467
 40000000 000000000045 MODCD          *28
 41000000 000000001207 MODFL          *28
 40000000 000000000042 MODFR          *28
 40000000 000000000044 MODIN          *28
 40000000 000000000044 MODRS          *28
 40000000 000000000043 MODSC          *28
 01101000 000000002144 MPTRSL       *1645      1665
 40000000 000000000047 MRBKI          *28
 40000000 000000210632 MRE4           *28
 40000000 000000303313 MRE5           *28
 40000000 000000210634 MRE7           *28
 01101000 000000000241 MRSNF          163      *245
 01101000 000000002002 MTONE         1503     *1508
 01101000 000000002250 MUPACW        1647     *1748
 01101000 000000002073 MVENT         1528      1532     *1580
 00101000 000000002712 MVPG         *2299
 40000000 000000400000 MW             *28
 40000000 000000000025 NCH            *28
 40000000 000000000002 NCHA           *28
 40000000 000000000005 NCHRS          *28
 40000000 000000000014 NDCD           *28
 40000000 000000000012 NENC           *28
 40000000 000000000634 NEW            *28
 40000000 000000001072 NEWSIZ         *28
 40000000 000000235164 NKA            *28
 40000000 000000235020 NKDB           *28
 40000000 000000303415 NLDBK          *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               130  BMAP - B00     
 40000000 777777777777 NLIND          *28
 40000000 000000001040 NLN            *28
 40000000 000000400000 NLNSA          *28
 01101000 000000003662 NMVKEY        3088      3091     *3104
 41000000 000000001053 NOBF           *28
 01101000 000000003157 NOEIE         2496     *2568
 41000000 000000000711 NOPTRS         *28      1563      1564      1685      1686      1964      1983
                                     2159      2160      2162      2164      2281      2301      2307
                                     2335      2382      2806      2807      2876      2880
 01101000 000000001311 NOSPLT        1085     *1087
 01101000 000000000303 NOTLC          303      *315
 01101000 000000000724 NOWN           773       778       793      *804
 41000000 000000000742 NPARCW         *28      1486      1500      1522      1598      1600      1607
                                     1612      1636      1759      2284      2286      2327      2330
                                     2331      2333      2409      2413      2424      2426      2439
 01101000 000000002067 NPG           1548     *1575
 01101000 000000002157 NPGP         *1661      1745
 01101000 000000003370 NPGRP         2786     *2822
 40000000 000000000630 NPIND          *28
 01101000 000000001224 NPMV          1014     *1032
 41000000 000000000004 NPOS           *28       782       905      1380      1457      2843
 01101000 000000001470 NRCE1          763     *1216
 01101000 000000003614 NRCE2         2750     *3021
 40000000 000000234510 NSA            *28
 41000000 000000234654 NSCS           *28      1224
 40000000 000000234344 NSDB           *28
 40000000 000000000001 NSTS           *28
 01101000 000000001553 NTLCK         1287     *1297
 41000000 000000000726 NUMENT         *28        66        87      1638      1646      2114      2126
                                     2341      2354      2384      2392      2937      2943
 41000000 000000000727 NUMPTR         *28       102       113       119
 40000000 777777777760 NXBUF          *28
 40000000 000000000713 NXPRI          *28
 40000000 000000000771 NXTC           *28
 40000000 000000000001 OAACN          *28
 40000000 000000000022 OACIWSOF       *28
 40000000 000000000001 OAOFST         *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               131  BMAP - B00     
 40000000 000000000002 OARCN          *28
 40000000 000000000001 OASCN          *28
 40000000 000000000014 OD             *28
 40000000 000000000074 ODBK           *28
 40000000 000000001072 OLDSIZ         *28
 40000000 000000000101 OPADP          *28
 01101000 000000001345 OPAIPA        1107      1114     *1120
 41000000 000000000741 OPARCW         *28      1482      1498      1524      1590      1597      1602
                                     1606      1611      1618      1756      2324      2326      2408
                                     2412      2418      2420      2422      2436
 40000000 000000210570 ORDNI          *28
 01101000 000000003766 ORFND         3191     *3214
 40000000 777777777777 OTVL           *28
 01101000 000000000471 OWNF1          530      *531
 40000000 000000000252 OWNPTR         *28
 41000000 000000000016 PABUF          *28      2003
 40000000 000000001041 PACD           *28
 41000000 000000000001 PACW           *28        62       380       448       888       921       996
                                     1481      1485      1757      1760      1890      2182      2437
                                     2440      2492      2559      2769      2931      3084      3137
                                     3324
 41000000 000000000733 PADBK          *28       836
 41000000 000000000740 PADUP          *28       703       718       772       878       892      1055
                                     1170      1956      2066      2099
 41000000 000000000745 PAEN           *28      2812      2821      2831      3089      3108
 41000000 000000000745 PAEO           *28      3076      3094      3122
 41000000 000000000734 PAEOF          *28       838
 41000000 000000303336 PAER1          *28       220
 40000000 000000303337 PAER2          *28
 41000000 000000303340 PAER3          *28       228      2569
 40000000 000000303341 PAER4          *28
 40000000 000000303342 PAER5          *28
 41000000 000000303343 PAER6          *28      1793
 41000000 000000000747 PAESZ          *28      3342      3346      3399
 40000000 000000001060 PAFLG          *28
 01101000 000000000243 PAGE1          147      *251
 41000000 000000000004 PAMVSZ        *686      1140
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               132  BMAP - B00     
 01101000 000000001506 PANP           815     *1252
 01101000 000000003620 PANP2         2740     *3031
 41000000 000000000731 PAOPTR         *28        85       292       309       311      1446      1452
                                     2848      2850
 41000000 000000000734 PAPOF          *28       839      3316      3358      3389
 41000000 000000000714 PARCW          *28       381       403       405       406       409       447
                                      889       890       922       924       997      1002      1891
                                     1928      1935      1966      1969      2084      2090      2112
                                     2116      2118      2181      2770      2824      2888      2900
                                     2916      2919      2930      2935      3196      3201      3206
 41000000 000000000726 PARVPA         *28      1000      1040      1106      1113
 01101000 000000001476 PASKOE         965     *1223
 01101000 000000002303 PASPE         1538     *1792
 41000000 000000000724 PASPLT         *28       697       963       992      1084      1104      1111
                                     1122      1124      2991
 41000000 000000001225 PASTK         *684       969      1126      1143      1144
 41000000 000000000010 PASTSZ        *685       686
 40000000 000000000004 PAWSZ          *28
 40000000 777777777762 PBUF           *28
 40000000 000000000020 PC             *28
 41000000 000000000510 PCB            *28
 41000000 000000000642 PCD            *28       863       865       868
 40000000 000000000642 PCD2           *28
 40000000 000000000247 PCEXI          *28
 40000000 000000000675 PCMIN          *28
 40000000 000000004541 PCOMP          *28
 40000000 000000000010 PD             *28
 40000000 000000000040 PE             *28
 40000000 000000000017 PENDING        *28
 40000000 000000000004 PF             *28
 40000000 000000000400 PFG            *28
 40000000 000000000200 PFM            *28
 40000000 000000000100 PFS            *28
 40000000 000000000400 PG             *28
 01101000 000000001506 PGER4          815     *1253
 01101000 000000003620 PGER5         2740     *3032
 40000000 000000001064 PGHD           *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               133  BMAP - B00     
 40000000 000000000006 PGLIM          *28
 40000000 000000000003 PGRNG          *28
 01101000 000000000060 PGRP           100      *107
 01101000 000000002163 PGRPP         1657     *1673
 41000000 000000000746 PGSIZE         *28      1732      2818      3331      3354      3391
 41000000 000000000641 PGSPLT         *28      1017      1365      1506
 40000000 000000000100 PKAW           *28
 40000000 000000001034 PLO            *28
 40000000 000000000004 PLSEP          *28
 40000000 000000000200 PM             *28
 40000000 000000001054 PNEOO          *28
 01101000 000000000217 PNER           136      *219
 01101000 000000001503 PNPE1         1193     *1235
 01101000 000000001506 PNPE2          954     *1258
 01101000 000000003620 PNPE3         3002     *3037
 01101000 000000001605 PNPE4         1292     *1321
 01101000 000000001605 PNPE5         1301     *1323
 01101000 000000001503 PNPE6         1145     *1238
 40000000 000000001047 POFSI          *28
 01101000 000000001717 POK           1440     *1444
 41000000 000000000005 PPOS           *28      1461
 40000000 000000000000 PR0            *27
 40000000 000000000001 PR1            *27
 40000000 000000000002 PR2            *27
 41000000 000000000003 PR3            *27        59        62        91        92        94       109
                                      110       112       122       123       125       151       156
                                      377       380       421       424       435       437       438
                                      444       448       547       550       728       780       860
                                      861       886       888       917       921       974       994
                                      996      1022      1023      1160      1166      1377      1449
                                     1479      1481      1483      1485      1541      1542      1545
                                     1560      1562      1622      1627      1650      1651      1654
                                     1708      1711      1716      1752      1757      1888      1890
                                     1979      1984      1991      1993      2039      2040      2044
                                     2107      2109      2110      2128      2130      2133      2179
                                     2182      2262      2266      2268      2291      2347      2350
                                     2355      2359      2386      2388      2389      2393      2396
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               134  BMAP - B00     
                                     2432      2437      2488      2492      2538      2544      2548
                                     2556      2559      2630      2767      2769      2790      2803
                                     2805      2840      2881      2927      2928      2931      2947
                                     2948      2950      3082      3084      3102      3103      3132
                                     3133      3137      3322      3324      3361      3362      3377
                                     3378      3380
 41000000 000000000004 PR4            *27       152       441       443       729       858      1164
                                     1167      1623      1628      1677      1684      1710      1754
                                     1760      1978      1990      1994      2003      2004      2010
                                     2129      2158      2165      2263      2280      2289      2292
                                     2346      2349      2434      2440      2539      2540      2543
 41000000 000000000005 PR5            *27       147       149       163       305       516       525
                                      530       553       708       726       732       753       801
                                      802       815       831       872       936       954      1051
                                     1075      1079      1108      1145      1153      1193      1279
                                     1280      1281      1292      1301      1313      1314      1315
                                     1401      1415      1421      1474      1504      1735      1768
                                     2740      2760      2820      2832      2849      3002      3191
                                     3200      3219      3228
 41000000 000000000006 PR6            *27        68        72        75        79        83        97
                                      129       139       143       174       175       188       301
                                      310       313       384       390       394       415       429
                                      505       513       536       543       721       762       764
                                      768       776       782       786       790       822       850
                                      866       869       897       905       979       983       987
                                     1009      1026      1063      1066      1163      1380      1384
                                     1438      1442      1443      1453      1457      1461      1493
                                     1512      1520      1556      1624      1643      1679      1719
                                     1895      1925      1934      1995      2000      2026      2030
                                     2048      2081      2089      2123      2136      2152      2265
                                     2275      2282      2358      2362      2399      2501      2511
                                     2523      2527      2537      2553      2623      2627      2634
                                     2749      2751      2755      2774      2778      2792      2794
                                     2843      2847      2857      2861      2904      2908      2940
                                     2972      2984      3340      3348      3372      3383      3395
 41000000 000000000007 PR7            *27        55        56        57        58        59        63
                                       64        66        71        73        78        82        85
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               135  BMAP - B00     
                                       87        89        90        91        95        98        99
                                      102       103       104       105       108       109       113
                                      114       115       119       121       122       126       127
                                      130       131       132       135       138       142       145
                                      146       148       150       151       152       153       157
                                      158       160       162       164       165       166       167
                                      169       170       178       181       187       189       191
                                      192       193       194       197       202       204       205
                                      208       210       211       222       223       224       230
                                      231       232       237       238       239       290       291
                                      292       293       294       296       299       300       304
                                      306       307       309       311       312       314       327
                                      328       329       376       377       381       382       383
                                      386       388       389       393       397       398       399
                                      400       403       405       406       408       409       412
                                      414       416       417       418       419       421       423
                                      426       428       435       440       441       447       502
                                      503       504       506       507       508       509       510
                                      511       512       514       517       518       519       520
                                      521       523       526       528       532       534       535
                                      537       539       541       544       547       549       555
                                      556       557       558       559       575       576       577
                                      578       689       690       691       692       693       694
                                      695       697       700       703       705       706       707
                                      709       710       711       712       718       724       725
                                      727       728       729       730       733       734       735
                                      743       744       745       746       747       748       749
                                      750       751       752       754       755       756       757
                                      769       772       775       780       783       784       789
                                      792       797       798       799       807       808       809
                                      810       811       812       813       816       817       818
                                      819       821       823       824       827       833       834
                                      835       836       837       838       839       848       849
                                      858       859       860       863       865       868       870
                                      871       878       880       881       884       885       886
                                      889       890       892       896       904       908       914
                                      916       917       922       924       925       933       934
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               136  BMAP - B00     
                                      935       940       941       942       943       944       945
                                      946       947       948       949       950       951       952
                                      953       955       956       957       958       959       960
                                      963       970       971       972       973       974       975
                                      976       980       981       986       989       990       992
                                      994       997      1000      1002      1006      1007      1010
                                     1011      1013      1017      1021      1022      1024      1027
                                     1028      1030      1040      1041      1042      1043      1044
                                     1045      1046      1047      1049      1055      1060      1061
                                     1062      1064      1068      1069      1070      1071      1072
                                     1073      1082      1083      1084      1086      1089      1090
                                     1091      1093      1094      1095      1096      1104      1106
                                     1111      1113      1116      1117      1118      1119      1122
                                     1124      1128      1129      1130      1131      1132      1133
                                     1134      1135      1136      1137      1143      1144      1147
                                     1148      1149      1150      1151      1152      1154      1155
                                     1156      1157      1159      1160      1161      1162      1164
                                     1170      1179      1180      1181      1186      1187      1188
                                     1189      1190      1191      1192      1194      1195      1196
                                     1197      1198      1199      1200      1201      1202      1203
                                     1205      1206      1207      1208      1218      1219      1226
                                     1278      1282      1283      1284      1285      1289      1290
                                     1291      1293      1294      1295      1298      1299      1300
                                     1302      1303      1304      1305      1306      1307      1308
                                     1309      1310      1311      1312      1363      1365      1366
                                     1367      1368      1369      1370      1371      1372      1376
                                     1377      1378      1381      1382      1385      1386      1395
                                     1396      1397      1398      1404      1405      1406      1407
                                     1408      1409      1410      1411      1412      1413      1414
                                     1416      1417      1418      1419      1422      1423      1424
                                     1425      1431      1432      1433      1434      1437      1441
                                     1445      1446      1449      1450      1452      1456      1460
                                     1471      1472      1473      1477      1478      1479      1482
                                     1483      1486      1488      1489      1490      1491      1496
                                     1498      1500      1506      1514      1516      1518      1522
                                     1523      1524      1525      1529      1530      1534      1535
                                     1536      1537      1539      1540      1541      1546      1547
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               137  BMAP - B00     
                                     1557      1558      1560      1563      1564      1566      1568
                                     1569      1570      1571      1572      1573      1574      1586
                                     1590      1592      1595      1597      1598      1599      1600
                                     1601      1602      1606      1607      1611      1612      1618
                                     1620      1621      1622      1623      1636      1638      1639
                                     1640      1641      1646      1648      1649      1650      1655
                                     1656      1663      1664      1674      1675      1676      1677
                                     1680      1681      1685      1686      1688      1690      1691
                                     1692      1693      1707      1708      1715      1718      1724
                                     1725      1726      1727      1728      1730      1732      1736
                                     1737      1738      1739      1740      1741      1743      1751
                                     1752      1753      1754      1756      1759      1767      1773
                                     1774      1775      1776      1777      1778      1779      1786
                                     1794      1795      1801      1887      1888      1891      1893
                                     1894      1899      1901      1902      1903      1905      1906
                                     1913      1920      1924      1927      1928      1931      1932
                                     1935      1936      1937      1939      1940      1942      1946
                                     1947      1948      1950      1951      1952      1956      1958
                                     1959      1960      1961      1964      1966      1968      1969
                                     1978      1979      1981      1983      1986      1987      1988
                                     1997      1999      2001      2003      2009      2012      2013
                                     2018      2019      2020      2021      2022      2024      2025
                                     2029      2032      2033      2038      2039      2043      2047
                                     2057      2058      2059      2060      2061      2062      2066
                                     2068      2069      2070      2071      2080      2083      2084
                                     2087      2090      2091      2092      2094      2095      2096
                                     2099      2101      2102      2103      2104      2106      2107
                                     2112      2114      2116      2117      2118      2121      2122
                                     2124      2126      2128      2129      2131      2134      2137
                                     2138      2140      2142      2144      2147      2148      2149
                                     2151      2155      2159      2160      2162      2164      2170
                                     2178      2179      2181      2261      2262      2263      2264
                                     2269      2270      2273      2276      2277      2281      2283
                                     2284      2285      2286      2288      2289      2301      2303
                                     2307      2309      2312      2313      2317      2320      2321
                                     2322      2323      2324      2325      2326      2327      2328
                                     2330      2331      2333      2335      2341      2345      2346
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               138  BMAP - B00     
                                     2347      2354      2357      2361      2374      2377      2378
                                     2379      2380      2382      2384      2385      2386      2392
                                     2394      2398      2408      2409      2412      2413      2418
                                     2420      2422      2424      2426      2431      2432      2433
                                     2434      2436      2439      2485      2487      2488      2489
                                     2493      2494      2500      2503      2504      2508      2510
                                     2512      2513      2514      2515      2517      2518      2519
                                     2521      2522      2526      2529      2536      2539      2541
                                     2547      2550      2552      2556      2558      2562      2563
                                     2570      2616      2619      2620      2621      2622      2626
                                     2629      2630      2631      2633      2716      2717      2718
                                     2719      2720      2721      2722      2723      2724      2725
                                     2726      2727      2728      2730      2731      2733      2734
                                     2735      2736      2737      2738      2741      2742      2743
                                     2744      2746      2756      2757      2758      2762      2766
                                     2767      2770      2772      2773      2776      2777      2781
                                     2784      2788      2789      2793      2797      2798      2800
                                     2802      2803      2806      2807      2812      2816      2818
                                     2821      2824      2828      2829      2831      2839      2840
                                     2841      2844      2848      2850      2851      2855      2856
                                     2860      2863      2864      2865      2866      2867      2868
                                     2876      2878      2880      2888      2891      2896      2897
                                     2898      2899      2900      2901      2902      2903      2909
                                     2914      2916      2918      2919      2930      2935      2937
                                     2938      2939      2943      2945      2946      2947      2951
                                     2952      2962      2973      2974      2975      2977      2979
                                     2980      2981      2983      2991      2996      2997      2998
                                     3001      3003      3004      3005      3006      3007      3008
                                     3010      3011      3012      3013      3014      3015      3074
                                     3075      3076      3078      3081      3082      3085      3086
                                     3089      3092      3093      3094      3097      3100      3106
                                     3108      3111      3115      3117      3118      3120      3121
                                     3122      3125      3136      3140      3183      3184      3185
                                     3186      3187      3189      3192      3193      3194      3195
                                     3196      3201      3206      3215      3216      3217      3218
                                     3222      3223      3226      3230      3231      3232      3234
                                     3236      3239      3241      3242      3244      3245      3248
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               139  BMAP - B00     
                                     3249      3250      3251      3252      3255      3314      3316
                                     3318      3321      3322      3325      3327      3329      3331
                                     3332      3339      3342      3343      3346      3349      3354
                                     3357      3358      3359      3368      3370      3371      3373
                                     3377      3381      3384      3385      3387      3389      3391
                                     3392      3394      3399      3406
 40000000 000000303267 PRE1           *28
 40000000 000000303277 PRE10          *28
 40000000 000000303270 PRE3           *28
 40000000 000000303271 PRE4           *28
 40000000 000000303272 PRE5           *28
 40000000 000000210613 PRE6           *28
 40000000 000000210614 PRE7           *28
 40000000 000000210615 PRE8           *28
 40000000 000000303276 PRE9           *28
 40000000 000000000522 PREXC          *28
 41000000 000000000521 PRFR           *28       870
 41000000 000000000521 PRFR2          *28       871
 40000000 000000000000 PRIV           *28
 41000000 000000000526 PROPA          *28       293       304       933
 41000000 000000000517 PRRC           *28       502       528       535       769       821       896
                                     1406      1473      2510      2570
 40000000 000000000517 PRRS           *28
 41000000 000000000520 PRSC           *28        56       138       162       224       232       300
                                      329       383       503       706       751      1151      1226
                                     1437      2025      2522      2622      2746      2856
 40000000 000000000516 PRSS           *28
 41000000 000000000644 PRSTS          *28       575       578      1801
 40000000 000000000100 PS             *28
 41000000 000000000000 PS0SID         *27
 41000000 000000000001 PS1SID         *27
 41000000 000000000002 PS2SID         *27
 41000000 000000000003 PS3SID         *27
 41000000 000000000004 PS4SID         *27
 40000000 000000000005 PS5SID         *27
 40000000 000000000006 PS6SID         *27
 40000000 000000303416 PSA            *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               140  BMAP - B00     
 40000000 000000000020 PSC            *28
 40000000 000000000010 PSD            *28
 40000000 000000000004 PSF            *28
 40000000 000000000400 PSO            *28
 41000000 000000000720 PTESZ          *28      1920      1932      1968      2057      2797      2800
                                     2816      2914      2918      2980      3093      3097
 01101000 000000003541 PTGRP         2953     *2970
 41000000 000000000631 PTR            *28       294       312       314       783       784       980
                                      981      1381      1382      1385      1386      1445      1456
                                     1460      2629      2633      2844      2851
 41000000 000000000724 PTRESZ         *28        71       205      1568      1570      1573      1690
                                     1691      1730      1899      1951      2060      2094      2103
                                     2117      2148      2312      2317      2320      2323      2325
                                     2328      2377      2380
 40000000 000000000710 PTRNO          *28
 41000000 000000000630 PWS            *28
 41000000 000000000002 RADDR          *28        59        91       109       122       151       377
                                      435       547       728       780       860       886       917
                                      974       994      1022      1160      1377      1449      1479
                                     1483      1541      1560      1622      1623      1650      1677
                                     1708      1752      1754      1888      1978      1979      2039
                                     2107      2128      2129      2179      2262      2263      2289
                                     2346      2347      2386      2432      2434      2488      2539
                                     2556      2630      2767      2803      2840      2947      3082
                                     3241      3242      3245      3322      3377
 40000000 000000000010 RADIX          *28
 41000000 000000000005 RAPTR          *28       518
 40000000 000000000004 RAWSOF         *28
 40000000 777777777766 RBA            *28
 40000000 000000023432 RCBI           *28
 40000000 000000211234 RCDNL          *28
 40000000 000000000005 RCFRH          *28
 40000000 000000000004 RCFRN          *28
 40000000 000000001075 RCHD           *28
 40000000 000000000001 RCID           *28
 41000000 000000000006 RCPTR          *28        57       165       223       231       239       328
                                      382       511       534       693       710       755       823
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               141  BMAP - B00     
                                     1007      1062      1156      1161      1198      1306      1405
                                     1472      1488      1489      1641      1795      1924      2080
                                     2122      2264      2720      2756      2773      2903      2939
                                     3007      3339      3371
 40000000 000000000002 RCRAH          *28
 40000000 000000000001 RCRAN          *28
 41000000 000000000003 RCRSH          *28       768      2755
 41000000 000000000002 RCRSN          *28       513       822
 40000000 000000210667 RCVER1         *28
 40000000 000000210670 RCVER2         *28
 40000000 000000210671 RCVER4         *28
 40000000 000000210672 RCVER5         *28
 40000000 000000210673 RCVER6         *28
 41000000 000000000736 RCW1           *28       539       549
 41000000 000000000737 RCW2           *28       541       544
 40000000 000000000004 RCWSO          *28
 40000000 000000000077 RDAC           *28
 40000000 000000000076 RDCNT          *28
 40000000 000000040000 RDI            *28
 40000000 000000015674 RDLT           *28
 40000000 000000000075 RDYCW          *28
 40000000 000000000066 RECAC          *28
 40000000 000000000065 RECFR          *28
 40000000 000000000070 RECRC          *28
 40000000 000000000067 RECSC          *28
 41000000 000000000003 RECSZ          *28       178       181       507       536      1640      2322
                                     2379      3223
 40000000 000000000235 REMLT          *28
 40000000 000000000062 REM_RECOVER    *28
 40000000 000000000251 RETFR          *28
 40000000 000000210724 RFDNL          *28
 40000000 000000017644 RIM            *28
 40000000 000000000005 RNAM           *28
 40000000 000000015706 RNDLT          *28
 40000000 000000000662 RNG1           *28
 40000000 000000000664 RNG2           *28
 40000000 000000000073 RNGD           *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               142  BMAP - B00     
 40000000 000000000072 RNGO           *28
 40000000 000000000660 RNGTAL         *28
 40000000 000000020154 RNM            *28
 40000000 000000000041 ROCUR          *28
 40000000 000000000001 ROFST          *28
 40000000 000000002114 ROLL           *28
 40000000 000000020010 RPM            *28
 40000000 000000000001 RSCDH          *28
 41000000 000000000001 RSCDN          *28       866
 40000000 000000211710 RSDNL          *28
 40000000 000000004540 RSEE           *28
 41000000 000000000003 RSIZ           *28       174       505
 40000000 000000000110 RSPAM          *28
 41000000 000000000004 RSPTR          *28        58        90       127       167       426       514
                                      712       757       775       824       849       904       975
                                     1024      1157      1378      1450      1490      1491      1649
                                     1894      2124      2273      2500      2550      2631      2757
                                     2788      2841      2946      3373
 40000000 000000000037 RSREQ          *28
 40000000 000000000002 RSSSH          *28
 40000000 000000000001 RSSSN          *28
 41000000 000000210574 RSZER          *28       236
 41000000 000000000632 RSZTP          *28       157       158
 41000000 000000000003 RTP            *28       160       398       691       707       752      1152
                                     1196      1304      2020      2517      2718      3005
 40000000 000000000003 RTYP           *28
 01101000 000000000225 RTYPE          171      *226
 40000000 000000000530 RV1            *28
 40000000 000000000550 RV2            *28
 40000000 000000000570 RV3            *28
 40000000 000000000610 RV4            *28
 40000000 000000000003 RVASID         *27
 41000000 000000000510 RVI            *28       508       523       555       576       705       709
                                      724       727       733       735       743       750       754
                                      810       813       816       819       834       880       940
                                      943       947       950       951       955       958      1010
                                     1045      1060      1135      1147      1150      1186      1189
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               143  BMAP - B00     
                                     1190      1194      1205      1208      1282      1285      1289
                                     1293      1298      1302      1308      1311      1370      1372
                                     1376      1404      1407      1410      1416      1419      1431
                                     1471      1478      1621      1648      1676      1725      1728
                                     1736      1739      1751      1773      1775      1901      1946
                                     1947      1986      2061      2101      2131      2261      2321
                                     2378      2431      2489      2716      2730      2735      2738
                                     2741      2744      2772      2828      2865      2868      2896
                                     2974      2996      3003      3184      3187      3189      3222
                                     3230      3248      3249      3252
 41000000 000000000511 RVO            *28       734       934       960      1021      1041      1044
                                     1086      1116      1119      1295      1366      1369      1371
                                     1395      1398      1412      1422      1425      1432      1774
                                     1776      1779      3192      3195      3215      3218      3234
 41000000 000000000513 RVPA           *28        55        89       121       191       222       376
                                      504       517       520       558       798       808       811
                                      812       817       818       827       833       859       885
                                      916       959      1042      1043      1046      1061      1083
                                     1117      1118      1294      1367      1368      1411      1423
                                     1424      1477      1620      1639      1707      1726      1727
                                     1737      1738      1753      1767      1777      1778      1794
                                     1887      2018      2106      2121      2178      2288      2345
                                     2433      2485      2487      2620      2733      2736      2737
                                     2742      2743      2762      2766      2839      2855      2866
                                     2867      2938      2945      3075      3078      3081      3185
                                     3186      3232      3250      3251      3318      3321      3370
 01101000 000000001341 RVREC         1109     *1115
 41000000 000000000512 RVT            *28       145       148       164       197       230       237
                                      290       296       299       306       327       388       414
                                      519       521       526       532       556       557       559
                                      577       689       700       747       848       948       949
                                      956       957      1070      1082      1089      1129      1148
                                     1149      1154      1159      1179      1187      1188      1206
                                     1207      1283      1284      1309      1310      1396      1397
                                     1408      1409      1417      1418      1893      1950      2019
                                     2058      2616      2619      2723      3010      3193      3194
                                     3216      3217      3236
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               144  BMAP - B00     
 40000000 000000000022 RVTAL          *28
 40000000 000000000002 RWSZ           *28
 40000000 000000000015 RY             *28
 40000000 000000210620 RYE1           *28
 40000000 000000210621 RYE4           *28
 40000000 777777777767 SA             *28
 40000000 000000000005 SANAM          *28
 40000000 000000001062 SCDES          *28
 40000000 000000211544 SCDNL          *28
 40000000 000000000024 SCFC           *28
 40000000 000000000002 SCID           *28
 40000000 000000000024 SCLST          *28
 40000000 000000000004 SCNAM          *28
 41000000 000000000004 SCPTR          *28       166       512       694       711       756       976
                                     1155      1199      1219      1307      2721      2758      3008
 40000000 000000000003 SCRSH          *28
 41000000 000000000002 SCRSN          *28       762      2749
 01101000 000000003150 SCWR          2505     *2555
 41000000 000000000001 SCWSO          *28       188
 01101000 000000001506 SEOE1         1075     *1255
 01101000 000000002453 SFNEW        *2017      2127
 41000000 000000001225 SFWS           *28       684
 01101000 000000002517 SHFPG         2067     *2072
 01101000 000000000633 SINFO          704      *736
 40000000 000000001073 SIZCHG         *28
 40000000 000000000645 SKFLG          *28
 40000000 000000000643 SKIND          *28
 40000000 000000000641 SKTYP          *28
 40000000 000000020464 SMCR           *28
 01101000 000000004156 SMWE10        3319     *3422
 01101000 000000003215 SMWE11        2617     *2653
 01101000 000000000243 SMWER1         198      *252
 01101000 000000000314 SMWER2         297      *339
 01101000 000000003164 SMWER5        2486     *2582
 01101000 000000001506 SMWER6         828     *1263
 01101000 000000003713 SMWER7        3079     *3154
 01101000 000000003621 SMWER8        2763     *3043
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               145  BMAP - B00     
 01101000 000000000177 SMWS           190      *195
 40000000 000000000003 SNAM           *28
 40000000 000000000107 SNIND          *28
 01101000 000000002407 SNOPF         1957     *1962
 41000000 000000000735 SNPAE          *28       914       925
 40000000 000000001046 SNSI           *28
 41000000 000000000743 SOE            *28      1516      1534      1537      1540      2283      2285
 41000000 000000020630 SORSA          *28       325
 40000000 000000004374 SOSE           *28
 01101000 000000001506 SPAE1          936     *1256
 01101000 000000001734 SPAR1         1388     *1463
 00101000 000000001734 SPAR2        *1462
 40000000 000000000000 SPAV           *28
 41000000 000000000744 SPCAVN         *28      1523      1530      1536      1539      1572      1574
                                     1599      1936      1937      2091      2092      2095      2104
                                     2898      2899      2901      2902      2909
 41000000 000000000744 SPCAVO         *28      1525      1529      1535      1569      1571      1601
 01101000 000000002317 SPCER         1798      1803      1815      1825     *1829
 01101000 000000002313 SPGE1         1504     *1814
 01101000 000000003055 SPGRT         2271     *2444
 40000000 000000000765 SPLF           *28
 41000000 000000000765 SPND           *28
 01101000 000000001156 SPTR           985      *988
 40000000 000000000006 SSDT           *28
 41000000 000000303243 SSER           *28      1217      3022
 40000000 000000303244 SSER1          *28
 40000000 000000000002 SSH            *28
 40000000 000000000005 SSNAM          *28
 40000000 000000210573 SSNF           *28
 40000000 000000210576 SSNV           *28
 40000000 000000000020 SSSPTR         *28
 40000000 000000000010 SSVDT          *28
 40000000 000000000033 SSZTP          *28
 40000000 000000000017 ST             *28
 40000000 000000000104 STBIN          *28
 40000000 000000000105 STDEC          *28
 40000000 000000303302 STE1           *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               146  BMAP - B00     
 40000000 000000303303 STE2           *28
 40000000 000000210624 STE3           *28
 40000000 000000303305 STE4           *28
 40000000 000000303306 STE5           *28
 01101000 000000001024 STIND          867      *874
 41000000 000000000100 STKSIZ         *28
 41000000 000000000055 STMASK         *28       506       537
 40000000 000000000062 SUST           *28
 01101000 000000003127 SVOP          2525     *2528
 01101000 000000003434 SVPTR         2859     *2862
 41000000 000000000020 SWS            *28
 40000000 000000000000 SWSAC          *28
 40000000 000000000002 SWSZ           *28
 40000000 000000000000 SYSSF          *28
 01101000 000000000233 SZE1           179      *234
 01101000 000000000233 SZE2           182      *235
 40000000 000000000765 SZREQ          *28
 40000000 000000000004 TBUF           *28
 40000000 000000001061 TCTRS          *28
 60000000 000000000000 TDS            *28
 41000000 000000000113 TEMP           *28
 41000000 000000000640 TFLD           *28      1997      1999      2013
 40000000 000000000657 TFLD2          *28
 41000000 000000000056 TMASK          *28       399      2021      2518
 40000000 000000000061 TMODE          *28
 41000000 000000000676 TMPPA          *28      3329      3349      3357      3359
 40000000 000000000003 TPAI           *28
 40000000 000000500000 TPRCOD         *28
 40000000 000000001031 TSFN           *28
 41000000 000000000021 TSI            *28      2001
 40000000 000000001013 UBRD2          *28
 41000000 000000001223 UBSZ           *28
 40000000 000000000667 UCADR          *28
 40000000 000000000036 UCRS           *28
 00101000 000000003024 UCW          *2406
 40000000 000000000024 UFSPK          *28
 40000000 000000000024 UFSPK2         *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               147  BMAP - B00     
 40000000 000000000715 ULIM           *28
 00101000 000000004044 ULKBE1       *3274
 00101000 000000002314 ULKRE2       *1820
 00101000 000000000544 ULKRE3        *591
 00101000 000000000542 ULKRE4        *579
 00101000 000000002314 ULKRE5       *1822
 00101000 000000002312 ULKRE6       *1802
 00101000 000000001510 ULKRE7       *1270
 00101000 000000001603 ULKRE8       *1318
 40000000 000000004230 UNA            *28
 40000000 000000303417 UNIM           *28
 00101000 000000000670 UODOP         *774
 00101000 000000004114 UOFF         *3367
 01101000 000000002612 UOFPG         2143     *2146
 40000000 000000000002 UOFST          *28
 01101000 000000004122 UOLP         *3374      3401
 00101000 000000003511 UOPG         *2934
 01101000 000000003520 UOPGL        *2942      2964
 01101000 000000002566 UOPGLP       *2125      2172
 00101000 000000002553 UOTPG        *2111
 40000000 000000001035 UPACD          *28
 41000000 000000000721 UPACW          *28        63        64      2493      2494      2503      2508
                                     2513      2515      2558
 40000000 000000000007 UPFLAG         *28
 40000000 000000000103 UPPAI          *28
 40000000 000000000004 UPTSID         *27
 01101000 000000002641 USPCA         2049     *2176
 00101000 000000002641 USPCA2       *2177
 40000000 000000000674 USTAT          *28
 40000000 000000000002 UWASID         *27
 40000000 000000000002 UWSSZ          *28
 40000000 000000000020 UWSZ           *28
 40000000 000000000243 VFDSC          *28
 40000000 000000001070 VFDSR          *28
 40000000 000000000656 VFLD           *28
 40000000 000000001074 VFLNG          *28
 40000000 000000001124 VIB1           *28
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               148  BMAP - B00     
 40000000 000000001154 VIBP           *28
 40000000 000000000000 VLPSID         *27
 01101000 000000001237 VNP           1016      1018      1031     *1050
 01101000 000000001506 VOER1          831     *1254
 01101000 000000001506 VOER2         1051     *1257
 01101000 000000003620 VOER3         2760     *3033
 40000000 000000001074 VRSIZ          *28
 40000000 000000001067 WLOA           *28
 40000000 000000100000 WRTI           *28
 40000000 000000000000 WSBID          *28
 40000000 000000000003 WSOF           *28
 41000000 000000000000 X0             *27        79        80        82        99       101       102
                                      103       108       142       153       221       229       238
                                      246       301       302       307       326       390       391
                                      393       404       405       418       419       508       509
                                      510       696       697       730       764       765       766
                                      772       776       777       786       787       789       798
                                      808       848       865       866       868       892       897
                                      908       912       914       924       925       934       983
                                      984       986      1010      1045      1055      1063      1066
                                     1068      1072      1218      1225      1249      1271      1279
                                     1313      1438      1439      1441      1522      1523      1524
                                     1525      1529      1530      1534      1535      1536      1537
                                     1539      1547      1569      1570      1571      1572      1573
                                     1574      1620      1656      1676      1715      1751      1796
                                     1898      1899      1902      1903      1941      1942      1946
                                     1950      1987      2026      2027      2029      2032      2058
                                     2099      2101      2106      2121      2178      2270      2282
                                     2283      2311      2312      2321      2420      2421      2422
                                     2424      2425      2426      2431      2494      2495      2497
                                     2503      2506      2507      2508      2511      2512      2513
                                     2514      2515      2523      2524      2526      2537      2541
                                     2571      2623      2624      2626      2751      2752      2753
                                     2777      2778      2782      2812      2821      2831      2857
                                     2858      2860      2896      2974      3023      3321      3370
 41000000 000000000001 X1             *27        64        65        66        68        69        70
                                       71        72        73        74        87       104       114
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               149  BMAP - B00     
                                      116       119       131       139       140       147       163
                                      174       178       181       188       198       200       202
                                      203       208       209       222       230       237       290
                                      297       299       305       306       317       327       376
                                      504       516       517       523       525       526       530
                                      542       543       544       551       553       555       556
                                      576       577       689       700       703       705       708
                                      709       718       719       721       722       724       726
                                      727       732       743       747       750       753       754
                                      801       802       815       828       829       831       833
                                      834       872       877       878       880       936       940
                                      943       951       954       963       964       991       992
                                      999      1000      1008      1009      1013      1039      1040
                                     1051      1060      1075      1079      1082      1083      1084
                                     1086      1088      1104      1106      1108      1111      1113
                                     1122      1123      1124      1145      1153      1154      1169
                                     1170      1179      1190      1193      1194      1221      1228
                                     1241      1264      1286      1289      1292      1293      1294
                                     1295      1298      1301      1302      1362      1363      1364
                                     1365      1376      1394      1401      1404      1411      1415
                                     1421      1431      1471      1474      1477      1504      1505
                                     1506      1519      1520      1540      1636      1637      1638
                                     1642      1646      1662      1724      1735      1740      1753
                                     1767      1768      1785      1786      1893      1913      1933
                                     1934      1937      1940      1945      1948      1951      1952
                                     1956      1963      1964      1981      1988      2019      2038
                                     2059      2060      2062      2066      2088      2089      2092
                                     2095      2112      2113      2114      2116      2117      2118
                                     2120      2126      2167      2261      2314      2376      2377
                                     2378      2433      2486      2489      2617      2619      2716
                                     2730      2740      2760      2763      2764      2772      2807
                                     2808      2820      2824      2825      2826      2832      2849
                                     2875      2876      2895      2899      2902      2904      2935
                                     2936      2937      2941      2943      2959      2990      2991
                                     2992      2996      3002      3003      3074      3075      3079
                                     3081      3140      3182      3183      3189      3191      3196
                                     3197      3198      3200      3201      3202      3205      3206
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               150  BMAP - B00     
                                     3208      3211      3219      3221      3222      3228      3230
                                     3248      3254      3255      3314      3315      3316      3319
                                     3347      3348      3349      3357      3368      3369      3375
                                     3406
 41000000 000000000002 X2             *27        75       105       115       117       132       145
                                      148       164       204       205       210       211       388
                                      413       415       416       440       850       851       852
                                      859       960      1011      1017      1021      1129      1135
                                     1162      1412      1432      1478      1621      1681      1887
                                     2018      2096      2102      2103      2104      2123      2144
                                     2155      2171      2284      2285      2286      2288      2304
                                     2317      2320      2501      2502      2536      2620      2723
                                     2733      2766      2828      2839      2855      2938      2945
                                     2952      3010      3089      3090      3098      3106      3107
                                     3108      3124      3233      3235      3237      3372      3400
 41000000 000000000003 X3             *27        55        89       121       191       197       296
                                      523       526       532       555       556       576       577
                                      700       827       833       885       890       916       959
                                     1046      1061      1070      1082      1083      1086      1089
                                     1159      1293      1294      1295      1498      1501      1502
                                     1510      1527      1578      1586      1590      1591      1592
                                     1624      1639      1648      1707      1767      1901      1935
                                     1936      1947      1986      2061      2090      2091      2093
                                     2094      2138      2147      2148      2149      2265      2324
                                     2325      2326      2327      2328      2329      2330      2331
                                     2332      2333      2345      2358      2485      2487      2616
                                     2762      2801      2893      2908      2909      2940      2963
                                     3078      3115      3116      3117      3189      3232      3234
                                     3236      3248      3318      3328      3329      3358      3359
                                     3385      3388      3389
 41000000 000000000004 X4             *27       518       577       869       870       871      1294
                                     1295      1499      1576      1597      1599      1600      1601
                                     1602      1640      1691      1693      2131      2160      2161
                                     2162      2322      2323      2352      2357      2379      2380
                                     2394      2897      2898      2900      2901      3086      3087
                                     3092      3093
 41000000 000000000005 X5             *27        58        90       127       167       426       513
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               151  BMAP - B00     
                                      514       712       757       760       762       775       822
                                      824       849       863       904       975      1024      1064
                                     1157      1378      1450      1490      1491      1649      1894
                                     2124      2273      2500      2550      2631      2747      2749
                                     2757      2788      2841      2946      3373
 41000000 000000000006 X6             *27        56       138       162       166       224       232
                                      240       253       300       329       341       383       469
                                      503       512       592       706       711       751       756
                                      976      1151      1155      1219      1226      1272      1280
                                     1314      1319      1437      1500      1577      1598      1797
                                     1823      2025      2203      2522      2572      2583      2622
                                     2654      2746      2758      2856      3044      3155      3275
                                     3423
 03201028 000000000000 X66_ARET       *27       215       320       451       562      1211      1788
                                     2187      2445      2564      2639      3017      3257
 03201027 000000000000 X66_AUTO_0     *27        54       289       375       501       688      1360
                                     1885      2259      2484      2615      2712      3180
 41000000 000000000007 X7             *27        57       165       223       231       239       254
                                      328       342       382       470       502       511       527
                                      528       534       535       593       710       755       768
                                      769       821       823       896      1007      1062      1156
                                     1161      1220      1227      1273      1281      1315      1320
                                     1405      1406      1472      1473      1488      1489      1641
                                     1794      1795      1824      1924      2080      2122      2204
                                     2264      2510      2570      2584      2655      2755      2756
                                     2773      2903      2939      3024      3045      3156      3276
                                     3339      3371      3424
 40000000 000000210665 XASL           *28
 40000000 000000303420 XLD            *28
 40000000 000000303421 XPD            *28
 40000000 000000000676 XPRS           *28
 40000000 000000210666 XROLL          *28
 40000000 000000210664 XUNEX          *28
 40000000 777777777777 XXDPN          *28
 03201029 000000000000 ZIB$DBALT     *257      *345      *475      *598     *1317     *1830     *2208
                                    *2446     *2588     *2660     *3049     *3279
 03201030 000000000000 ZIB$ICALT    *3159     *3429
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               152  BMAP - B00     
 01101000 000000003170 ZIG$DBAAO     1108     *2614
 02201004 000000000000 ZIG$DBABS      *15
 12101000 000000000547 ZIG$DBACE       12      *687
 01101000 000000000000 ZIG$DBACM      *53      1768
 01101000 000000000317 ZIG$DBACO     *374      1075
 01101000 000000000417 ZIG$DBACR     *500       801      1415      1474
 12101000 000000003220 ZIG$DBADE       11     *2711
 01101000 000000003625 ZIG$DBADO     2832     *3073
 01101000 000000004047 ZIG$DBADP     1735      2820     *3313
 13101000 000000003716 ZIG$DBADR       11      2849     *3179
 03201012 000000000000 ZIG$DBAFN      *20       732
 01101000 000000003057 ZIG$DBAID      802      1421     *2483
 12101000 000000000246 ZIG$DBAIS       12      *288
 01101000 000000003237 ZIG$DBALP    *2729      2869
 01101000 000000001606 ZIG$DBASP      936     *1359
 03201001 000000000000 ZIG$DBAVO      *13       831      1051      2760
 01101000 000000002320 ZIG$DBCDP     1079     *1884
 01101000 000000000562 ZIG$DBCLP     *698      1171
 03201003 000000000000 ZIG$DBPDR      *14      3228
 03201000 000000000000 ZIG$DBPFD      *13       815       954      1145      1193      1292      1301
                                     2740      3002
 03201007 000000000000 ZIG$DBPFN      *16       530
 03201008 000000000000 ZIG$DBPFO      *17      1394
 03201002 000000000000 ZIG$DBPFP      *14      3191
 03201006 000000000000 ZIG$DBPFS      *16       525
 03201011 000000000000 ZIG$DBPR2      *19       163       708       753      1153
 01101000 000000002653 ZIG$DBSPG     1504     *2258
 03201016 000000000000 ZIG$DBXCI      *22       872
 12101000 000000000000 ZIM$DBAU        10       *29
 03201013 000000000000 ZIM$DBPLK      *21       523       526       700       833      1767      3189
 03201015 000000000000 ZIM$DBPMR      *21       198       297       828      2486      2617      2763
                                     3079      3319
 03201014 000000000000 ZIM$DBPUL      *21       555       556       576       577      1082      1083
                                     1086      1293      1294      1295      3248
 03201021 000000000000 ZIM$JAFTPA     *24      1088      2992
 03201020 000000000000 ZIM$JBEFPA     *24       829      2764
 03201024 000000000000 ZIM$JDEL       *25      3221
 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       SYMBOL TABLE                                               153  BMAP - B00     
 03201025 000000000000 ZIM$JPAFIL     *26      3205
 03201026 000000000000 ZIM$JPALIL     *26      3211
 03201023 000000000000 ZIM$JPAMEM     *25       317
 03201022 000000000000 ZIM$JPASET     *25       200
 03201019 000000000000 ZIM$JSTO       *24       551
 03201017 000000000000 ZIM$PCON       *23       553
 03201018 000000000000 ZIM$PDIS       *23      1401      3200      3219
 03201010 000000000000 ZIQ$DBIOA      *19       305
 03201005 000000000000 ZIQ$DBIOL      *15       147       726
 03201009 000000000000 ZIQ$DBPR3      *18       516

    1179 SYMBOLS

 12:40 09/05/97  FILE=ZIM$DBAU.:ZIC0TSI       MACRO TABLE                                                154  BMAP - B00     
 CBSYM           28
 DBALT          257       345       475       598      1317      1830      2208      2446      2588
               2660      3049      3279
 DBCAL          147       163       198       200       297       305       317       516       523
                525       526       530       551       553       700       708       726       732
                753       801       802       815       828       829       831       833       872
                936       954      1051      1075      1079      1088      1108      1145      1153
               1193      1292      1301      1394      1401      1415      1421      1474      1504
               1735      1767      1768      2486      2617      2740      2760      2763      2764
               2820      2832      2849      2992      3002      3079      3189      3191      3200
               3205      3211      3219      3221      3228      3319
 DBRET          215       320       451       562      1211      1788      2187      2445      2564
               2639      3017      3257
 DBSAV           54       289       375       501       688      1360      1885      2259      2484
               2615      2712      3180
 ICALT         3159      3429
 ICCAL          147       163       305       516       708       726       753      1153      1735
               2820      2832
 ICRET         3140      3406
 ICSAV         3074      3314
 LOCK           523       526       700       833      1767      3189
 Q2SYM           28
 SSSYM           28
 UNLOCK         555       556       576       577      1082      1083      1086      1293      1294
               1295      3248

      37 MACROS

    SYMBOL SPACE USED 18876 WORDS
     MACRO SPACE USED 13057 WORDS
   INPUT RECORDS READ  8662
 STATEMENTS PROCESSED  5735
         ELAPSED TIME  0:40.12
             CPU TIME    37.80 SEC.
        ASSEMBLY RATE  9103 STATEMENTS/CPU MIN.

      NO ERRORS

