VERSION B06

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:1    
        1        1        /*M* VMD$DISPLAY Display subroutines  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8
        9        9        /*P* NAME: VMD$DI_HEADER
       10       10             DESCRIPTION: THIS ROUINE WILL LIST THE CURRENT HEADER
       11       11        */
       12       12
       13       13        VMD$DI_HEADER: PROC (VM_HEADER,MESSAGE_NUMBER,DCB#);
       14       14
       15       15        /***** Include files *****/
       16       16        %INCLUDE CP_6_SUBS;
       17      556        %INCLUDE XU_FORMAT_C;
       18      718        %INCLUDE CP_6;
       19     6277        %INCLUDE VM_MACRO_C;
       20     7545        %INCLUDE VM_SUBS_C;
       21     7805        %INCLUDE VM_DATA_R;
       22     8236        %include VM_PERR_C;
       23     8531        /***** Parameters *****/
       24     8532        %VM_HEADER (STCLASS=" ");
       25     8661    1   DCL MESSAGE_NUMBER UBIN WORD;
       26     8662    1   DCL DCB# UBIN WORD;
       27     8663
       28     8664        %F_FDS(    VECTR = VECT_ARRAY );
       29     8777
       30     8778              %F$DCB;
       31     8835
       32     8836        %FPT_OPEN( FPTN=DEFAULT_OPEN_CONST, FUN=CREATE, DISP=NAMED, STCLASS=CONSTANT);
       33     8945        %FPT_OPEN( FPTN=DEFAULT_OPEN, STCLASS="");
       34     9054
       35     9055        %FPT_TIME  (FPTN=CONVERT_TIME,
       36     9056                    DEST=LOCAL,
       37     9057                    TSTAMP=UTS,
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:2    
       38     9058                    DATE=DATE_STRING,
       39     9059                    TIME=TIME_STRING);
       40     9078
       41     9079
       42     9080        %VLP_NAME( FPTN=VM_HEADER_FMT, LEN=60,L=60, NAME=' ', STCLASS=STATIC);
       43     9107        %VLP_NAME( FPTN=VM_TITLE_FMT,  LEN=60,L=60, NAME=' ', STCLASS=STATIC);
       44     9134        %VLP_NAME( FPTN=VM_STATUS1,    LEN=16,L=16, NAME=' ', STCLASS=STATIC);
       45     9161        %VLP_NAME( FPTN=VM_STATUS2,    LEN=27,L=27, NAME=' ', STCLASS=STATIC);
       46     9188
       47     9189        %VLP_ERRCODE( FPTN=E_HEADER_FMT, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       48     9190                      ERR#=%E$HEADER_FMT );
       49     9235        /*E* ERROR:   VMD-E$HEADER_FMT-0
       50     9236             MESSAGE0:"4D "A "A "A"4*D "xxx.0<>MA "A
       51     9237             DESCRIPTION:   '"' is mapped into %.  This is a format phrase.
       52     9238                            "xxx is modified at run time (field width).
       53     9239        */
       54     9240              %VLP_ERRCODE( FPTN=E_TITLE_FMT, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       55     9241              ERR#=%E$TITLE_FMT );
       56     9286        /*E* ERROR:   VMD-E$TITLE_FMT-0
       57     9287             MESSAGE:msg#    when sent      recs"xxx.0<>MA "Asubject
       58     9288             DESCRIPTION: '"' is mapped into %.  This is a format phrase.
       59     9289                          "xxx is modified at run time to be a field width
       60     9290                          for the name.
       61     9291        */
       62     9292              %VLP_ERRCODE( FPTN=E_STATUS1, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       63     9293              ERR#=%E$STATUS1  );
       64     9338        /*E* ERROR:   VMD-E$STATUS1-0
       65     9339             MESSAGE:dnum am pm(from)
       66     9340             DESCRIPTION: Codes associated with message displays.
       67     9341                          d -  deleted              0,1
       68     9342                          n -  new                  1,1
       69     9343                          u -  unexamined           2,1
       70     9344                          m -  marked               3,1
       71     9345                     (from) -  header display      10,6
       72     9346        */
       73     9347              %VLP_ERRCODE( FPTN=E_STATUS2, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       74     9348              ERR#=%E$STATUS2   );
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:3    
       75     9393        /*E* ERROR: VMD-E$STATUS2-0
       76     9394             MESSAGE:errackdlvfc ansfwdbrdrr enc
       77     9395             DESCRIPTION: More codes associated with message displays:
       78     9396                        err -  error             2  0,3
       79     9397                        ack -  acknowledgement   2  3,3
       80     9398                        dlv -  delivery report   2  6,3
       81     9399                         fc -  file copy         2  9,3
       82     9400                        ans -  answer            2 12,3
       83     9401                        fwd -  forward           2 15,3
       84     9402                        brd -  broadcast         2 18,3
       85     9403                         rr -  return receipt    2 21,3
       86     9404                        enc -  enclosures        2 24,3
       87     9405        */
       88     9406              %VLP_NAME( FPTN=VM_DATE_NUMBER_FMT, LEN=80,L=80, NAME=' ',
       89     9407              STCLASS="STATIC SYMDEF");
       90     9434        %VLP_ERRCODE( FPTN=E_DATE_NUMBER_FMT, STCLASS="CONSTANT SYMDEF",
       91     9435                      ERR#=%E$DATE_NUMBER_FMT, FCG=VM,MID=D     );
       92     9480        /*E* ERROR: VMD-E$DATE_NUMBER_FMT-0
       93     9481             MESSAGE:    Sent:"11-"L15..3U Rcvd: "L15..3U"49-Number:"57-"5LD
       94     9482        */
       95     9483
       96     9484              %VLP_NAME( FPTN=VM_TO_FROM_FMT, LEN=59,L=59, NAME=' ',
       97     9485              STCLASS="STATIC SYMDEF");
       98     9512        %VLP_ERRCODE( FPTN=E_TO_FROM_FMT,      STCLASS="CONSTANT SYMDEF",
       99     9513                      ERR#=%E$TO_FROM_FMT,      FCG=VM,MID=D        );
      100     9558        /*E* ERROR: VMD-E$TO_FROM_FMT-0
      101     9559             MESSAGE:      To:"11-"L35A"N("51-From:"57-"LA")
      102     9560        */
      103     9561
      104     9562              %VLP_NAME( FPTN=VM_SUBJECT_FMT, LEN=39,L=39, NAME=' ',
      105     9563              STCLASS="STATIC SYMDEF");
      106     9590        %VLP_NAME(  FPTN=VM_SUBJECT_FMT1,   LEN=39,L=39, NAME=' ',
      107     9591                    STCLASS="STATIC SYMDEF");
      108     9618        %VLP_ERRCODE( FPTN=E_SUBJECT_FMT,   STCLASS="CONSTANT SYMDEF",
      109     9619                      ERR#=%E$SUBJECT_FMT,  FCG=VM,MID=D    );
      110     9664              %VLP_ERRCODE( FPTN=E_SUBJECT_FMT1, STCLASS="CONSTANT SYMDEF",
      111     9665              ERR#=%E$SUBJECT_FMT,  FCG=VM,MID=D,   SEV=1 );
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:4    
      112     9710        /*E* ERROR:  VMD-E$SUBJECT_FMT-0
      113     9711             MESSAGE: Subject:"11-"L70<A
      114     9712             MESSAGE1:Subject:"10-"L<A
      115     9713             DESCRIPTION:
      116     9714                      When displaying a message, MESSAGE0 is used,
      117     9715                      when displaying a particular item at the options
      118     9716                      prompt in SEND, MESSAGE1 is used.
      119     9717        */
      120     9718
      121     9719              %VLP_NAME( FPTN=VM_REPLY_TO_FMT, LEN=39,L=39, NAME=' ',
      122     9720              STCLASS="STATIC SYMDEF");
      123     9747        %VLP_ERRCODE( FPTN=E_REPLY_TO_FMT,  STCLASS="CONSTANT SYMDEF",
      124     9748                      ERR#=%E$REPLY_TO_FMT, FCG=VM,MID=D    );
      125     9793        /*E* ERROR: VMD-E$REPLY_TO_FMT-0
      126     9794             MESSAGE:Reply To:"11-"LA
      127     9795        */
      128     9796
      129     9797              %VLP_NAME( FPTN=VM_REFERENCE_FMT, LEN=39,L=39, NAME=' ',
      130     9798              STCLASS="STATIC SYMDEF");
      131     9825        %VLP_NAME(    FPTN=VM_REFERENCE_FMT1,LEN=39,L=39, NAME=' ',
      132     9826                      STCLASS="STATIC SYMDEF");
      133     9853        %VLP_ERRCODE( FPTN=E_REFERENCE_FMT, STCLASS="CONSTANT SYMDEF",
      134     9854                      ERR#=%E$REFERENCE_FMT,FCG=VM,MID=D    );
      135     9899              %VLP_ERRCODE( FPTN=E_REFERENCE_FMT1, STCLASS="CONSTANT SYMDEF",
      136     9900              ERR#=%E$REFERENCE_FMT, FCG=VM,MID=D,  SEV=1);
      137     9945        /*E* ERROR: VMD-E$REFERENCE_FMT-0
      138     9946             MESSAGE:      Re:"11-"LA
      139     9947             MESSAGE1:     Re:"10-"LA
      140     9948        */
      141     9949
      142     9950              %VLP_NAME( FPTN=VM_REFERENCE_AND_ID_FMT,LEN=23,L=23,NAME=' ',
      143     9951              STCLASS="STATIC SYMDEF");
      144     9978        %VLP_ERRCODE( FPTN=E_REFERENCE_AND_ID_FMT,STCLASS="CONSTANT SYMDEF",
      145     9979                      ERR#=%E$REFERENCE_AND_ID_FMT, FCG=VM,MID=D);
      146    10024        /*E* ERROR: VMD-E$REFERENCE_AND_ID_FMT-0
      147    10025             MESSAGE:"A #"D: "LA
      148    10026        */
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:5    
      149    10027
      150    10028              %VLP_NAME( FPTN=VM_RE_STRING, LEN=23,L=23, NAME=' ',
      151    10029              STCLASS="STATIC SYMDEF");
      152    10056        %VLP_ERRCODE( FPTN=E_RE_STRING,     STCLASS="CONSTANT SYMDEF",
      153    10057                      ERR#=%E$RE_STRING,    FCG=VM,MID=D        );
      154    10102        /*E* ERROR: VMD-E$RE_STRING-0
      155    10103             MESSAGE:   Re
      156    10104             DESCRIPTION:
      157    10105                    E_RE_STRING is used with E_REFERENCE_AND_ID_FMT.  When
      158    10106                    translating it, don't make it longer than 3 characters.  If
      159    10107                    you want it longer than that, the whole header display will
      160    10108                    have to be shifted to the right.  In any case, make sure that
      161    10109                    it is right justified.
      162    10110        */
      163    10111
      164    10112              %VLP_NAME( FPTN=VM_COPY_FMT,  LEN=23,L=23, NAME=' ',
      165    10113              STCLASS="STATIC SYMDEF");
      166    10140        %VLP_NAME(    FPTN=VM_COPY_FMT1,    LEN=23,L=23, NAME=' ',
      167    10141                      STCLASS="STATIC SYMDEF");
      168    10168        %VLP_ERRCODE( FPTN=E_COPY_FMT,     STCLASS="CONSTANT SYMDEF",
      169    10169                      ERR#=%E$COPY_FMT,     FCG=VM,MID=D         );
      170    10214              %VLP_ERRCODE( FPTN=E_COPY_FMT1, STCLASS="CONSTANT SYMDEF",
      171    10215              ERR#=%E$COPY_FMT,    FCG=VM,MID=D,     SEV=1   );
      172    10260        /*E* ERROR: VMD-E$COPY_FMT-0
      173    10261             MESSAGE:       C:"11-"LA
      174    10262             MESSAGE1:      C:"10-"LA
      175    10263        */
      176    10264
      177    10265              %VLP_NAME( FPTN=VM_BLIND_COPY_FMT, LEN=23,L=23,NAME=' ',
      178    10266              STCLASS="STATIC SYMDEF");
      179    10293        %VLP_NAME(    FPTN=VM_BLIND_COPY_FMT1,LEN=23,L=23,NAME=' ',
      180    10294                      STCLASS="STATIC SYMDEF");
      181    10321        %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT, STCLASS="CONSTANT SYMDEF",
      182    10322                      ERR#=%E$BLIND_COPY_FMT,FCG=VM,MID=D       );
      183    10367              %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT1, STCLASS="CONSTANT SYMDEF",
      184    10368              ERR#=%E$BLIND_COPY_FMT, FCG=VM,MID=D,     SEV=1    );
      185    10413        /*E* ERROR: VMD-E$BLIND_COPY_FMT-0
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:6    
      186    10414             MESSAGE:      Bc:"11-"LA
      187    10415             MESSAGE1:     Bc:"10-"LA
      188    10416        */
      189    10417
      190    10418              %VLP_NAME( FPTN=VM_CONTINUATION_FMT,LEN=19,L=19,NAME=' ',
      191    10419              STCLASS="STATIC SYMDEF");
      192    10446        %VLP_ERRCODE( FPTN=E_CONTINUATION_FMT,STCLASS="CONSTANT SYMDEF",
      193    10447                      ERR#=%E$CONTINUATION_FMT,FCG=VM,MID=D      );
      194    10492        /*E* ERROR: VMD-E$CONTINUATION_FMT-0
      195    10493             MESSAGE:"11-"<A
      196    10494        */
      197    10495
      198    10496              %VLP_NAME( FPTN=VM_ERROR_ADDRESS_FMT,LEN=43,L=43,NAME=' ',
      199    10497              STCLASS="STATIC SYMDEF");
      200    10524        %VLP_ERRCODE( FPTN=E_ERROR_ADDRESS_FMT,STCLASS="CONSTANT SYMDEF",
      201    10525                      ERR#=%E$ERROR_ADDRESS_FMT, FCG=VM,MID=D     );
      202    10570        /*E* ERROR: VMD-E$ERROR_ADDRESS_FMT-0
      203    10571             MESSAGE:  Address in question: "LA
      204    10572        */
      205    10573
      206    10574
      207    10575              %VLP_NAME( FPTN=VM_TO_FMT,    LEN=23,L=23, NAME=' ',
      208    10576              STCLASS="STATIC SYMDEF");
      209    10603        %VLP_ERRCODE( FPTN=E_TO_FMT,       STCLASS="CONSTANT SYMDEF",
      210    10604                      ERR#=%E$TO_FMT,       FCG=VM,MID=D          );
      211    10649        /*E* ERROR: VMD-E$TO_FMT-0
      212    10650             MESSAGE:     To:"10-"LA
      213    10651        */
      214    10652
      215    10653              %VLP_NAME( FPTN=VM_FCOPY_FMT, LEN=23,L=23, NAME=' ',
      216    10654              STCLASS="STATIC SYMDEF");
      217    10681        %VLP_ERRCODE( FPTN=E_FCOPY_FMT,     STCLASS="CONSTANT SYMDEF",
      218    10682                      ERR#=%E$FCOPY_FMT,    FCG=VM,MID=D         );
      219    10727        /*E* ERROR: VMD-E$FCOPY_FMT-0
      220    10728             MESSAGE: FCOPY ="10-"LA
      221    10729        */
      222    10730
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:7    
      223    10731              %VLP_NAME( FPTN=VM_SIGNED_FMT, LEN=23,L=23, NAME=' ',
      224    10732              STCLASS="STATIC SYMDEF");
      225    10759        %VLP_ERRCODE( FPTN=E_SIGNED_FMT,    STCLASS="CONSTANT SYMDEF",
      226    10760                      ERR#=%E$SIGNED_FMT,   FCG=VM,MID=D         );
      227    10805        /*E* ERROR: VMD-E$SIGNED_FMT-0
      228    10806             MESSAGE:Signed ="10-"LA
      229    10807        */
      230    10808
      231    10809              %VLP_NAME( FPTN=VM_RR_FMT,    LEN=39,L=39, NAME=' ',
      232    10810              STCLASS="STATIC SYMDEF");
      233    10837        %VLP_ERRCODE( FPTN=E_RR_FMT,        STCLASS="CONSTANT SYMDEF",
      234    10838                      ERR#=%E$RR_FMT,       FCG=VM,MID=D         );
      235    10883        /*E* ERROR: VMD-E$RR_FMT-0
      236    10884             MESSAGE: Return Receipt = "19-"LA
      237    10885        */
      238    10886
      239    10887
      240    10888              %VLP_NAME( FPTN=VM_RTO_FMT,   LEN=39,L=39, NAME=' ',
      241    10889              STCLASS="STATIC SYMDEF");
      242    10916        %VLP_ERRCODE( FPTN=E_RTO_FMT,       STCLASS="CONSTANT SYMDEF",
      243    10917                      ERR#=%E$RTO_FMT,      FCG=VM,MID=D             );
      244    10962        /*E* ERROR: VMD-E$RTO_FMT-0
      245    10963             MESSAGE:Reply To = "12-"LA
      246    10964        */
      247    10965
      248    10966              %VLP_NAME( FPTN=VM_DEFER_FMT, LEN=39,L=39, NAME=' ',
      249    10967              STCLASS="STATIC SYMDEF");
      250    10994        %VLP_ERRCODE( FPTN=E_DEFER_FMT,     STCLASS="CONSTANT SYMDEF",
      251    10995                      ERR#=%E$DEFER_FMT,    FCG=VM,MID=D             );
      252    11040        /*E* ERROR: VMD-E$DEFER_FMT-0
      253    11041             MESSAGE: Defer ="10-"L15..3U
      254    11042        */
      255    11043
      256    11044              %VLP_NAME( FPTN=VM_DEFER_FMT1, LEN=39,L=39, NAME=' ',
      257    11045              STCLASS="STATIC SYMDEF");
      258    11072        %VLP_ERRCODE( FPTN=E_DEFER_FMT1,    STCLASS="CONSTANT SYMDEF",
      259    11073                      ERR#=%E$DEFER_FMT1,   FCG=VM,MID=D             );
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:8    
      260    11118        /*E* ERROR: VMD-E$DEFER_FMT1-0
      261    11119             MESSAGE: Defer ="10-"LA
      262    11120        */
      263    11121
      264    11122              %VLP_NAME( FPTN=VM_OPTS_FMT,  LEN=83,L=83, NAME=' ',
      265    11123              STCLASS="STATIC SYMDEF");
      266    11150        %VLP_ERRCODE( FPTN=E_OPTS_FMT,      STCLASS="CONSTANT SYMDEF",
      267    11151                      ERR#=%E$OPTS_FMT,     FCG=VM,MID=D              );
      268    11196        /*E* ERROR: VMD-E$OPTS_FMT-0
      269    11197             MESSAGE:Options: Delivery Receipt = "A, Return Receipt = "A, Defer = "L15..3U
      270    11198        */
      271    11199
      272    11200              %VLP_NAME( FPTN=VM_OPTS_FMT1, LEN=83,L=83, NAME=' ',
      273    11201              STCLASS="STATIC SYMDEF");
      274    11228        %VLP_ERRCODE( FPTN=E_OPTS_FMT1,     STCLASS="CONSTANT SYMDEF",
      275    11229                      ERR#=%E$OPTS_FMT1,    FCG=VM,MID=D              );
      276    11274        /*E* ERROR: VMD-E$OPTS_FMT1-0
      277    11275             MESSAGE:Options: Delivery Receipt = "A, Return Receipt = "A
      278    11276        */
      279    11277
      280    11278              %VLP_NAME( FPTN=VM_OPTS_FMT2, LEN=83,L=83, NAME=' ',
      281    11279              STCLASS="STATIC SYMDEF");
      282    11306        %VLP_ERRCODE( FPTN=E_OPTS_FMT2,     STCLASS="CONSTANT SYMDEF",
      283    11307                      ERR#=%E$OPTS_FMT2,    FCG=VM,MID=D              );
      284    11352        /*E* ERROR: VMD-E$OPTS_FMT2-0
      285    11353             MESSAGE:         Broadcast = "A,        File Copy = "A
      286    11354        */
      287    11355
      288    11356              %VLP_NAME( FPTN=VM_DR_FMT,   LEN=39,L=39, NAME=' ',
      289    11357              STCLASS="STATIC SYMDEF" );
      290    11384        %VLP_ERRCODE( FPTN=E_DR_FMT,       STCLASS="CONSTANT SYMDEF",
      291    11385                      ERR#=%E$DR_FMT,      FCG=VM,MID=D               );
      292    11430        /*E* ERROR: VMD-E$DR_FMT-0
      293    11431             MESSAGE:Delivery Receipt = "20-"LA
      294    11432        */
      295    11433
      296    11434              %VLP_NAME( FPTN=VM_BROADCAST_FMT,LEN=39,L=39, NAME=' ',
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:9    
      297    11435              STCLASS="STATIC SYMDEF"                         );
      298    11462        %VLP_ERRCODE( FPTN=E_BROADCAST_FMT, STCLASS="CONSTANT SYMDEF",
      299    11463                      ERR#=%E$BROADCAST_FMT,FCG=VM,MID=D              );
      300    11508        /*E* ERROR:  VMD-E$BROADCAST_FMT-0
      301    11509             MESSAGE:Broadcast = "13-"LA
      302    11510        */
      303    11511              %VLP_NAME( FPTN=VM_ENCL_1_FMT,   LEN=60,L=60,NAME=' ',
      304    11512              STCLASS="STATIC SYMDEF");
      305    11539        %VLP_ERRCODE( FPTN=E_ENCL_1_FMT,       STCLASS="CONSTANT SYMDEF",
      306    11540                      ERR#=%E$ENCL_1_FMT,       FCG=VM,MID=D               );
      307    11585        /*E* ERROR: VMD-E$ENCL_1_FMT-0
      308    11586             MESSAGE:    Encl: encl#   recs        Title
      309    11587        */
      310    11588              %VLP_NAME( FPTN=VM_ENCL_2_FMT,   LEN=60,L=60,NAME=' ',
      311    11589              STCLASS="STATIC SYMDEF");
      312    11616        %VLP_ERRCODE( FPTN=E_ENCL_2_FMT,       STCLASS="CONSTANT SYMDEF",
      313    11617                      ERR#=%E$ENCL_2_FMT,       FCG=VM,MID=D               );
      314    11662        /*E* ERROR: VMD-E$ENCL_2_FMT-0
      315    11663             MESSAGE:"12-"2D"A"17-"A"20-"11LD"31-"LT
      316    11664        */
      317    11665              %VLP_NAME( FPTN=VM_ENCL_FWD_FMT,  LEN=60,L=60,NAME=' ',
      318    11666              STCLASS="STATIC SYMDEF");
      319    11693        %VLP_ERRCODE( FPTN=E_ENCL_FWD_FMT,      STCLASS="CONSTANT SYMDEF",
      320    11694                      ERR#=%E$ENCL_FWD_FMT,      FCG=VM,MID=D              );
      321    11739        /*E* ERROR: VMD-E$ENCL_FWD_FMT-0
      322    11740             MESSAGE:    Encl: moved to enclosing mailgram
      323    11741        */
      324    11742
      325    11743
      326    11744    1   DCL NEED_TITLE_BAR BIT (1) STATIC SYMDEF INIT ('0'B);
      327    11745    1   DCL VECT_ARRAY (0:7) STATIC VECTOR;
      328    11746
      329    11747    1   DCL WORK_BUF CHAR(50);
      330    11748    1   DCL TEMPBUF CHAR(256);
      331    11749    1   DCL I SBIN WORD;
      332    11750    1   dcl IX sbin;
      333    11751    1   DCL FLAG_CHAR CHAR (1);
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:10   
      334    11752    1   DCL MSG_TYPE CHAR (3);
      335    11753    1   DCL NAME_WIDTH UBIN;
      336    11754    1   DCL LEN SBIN WORD;
      337    11755    1   DCL SPACE CHAR(1) CONSTANT INIT(' ');
      338    11756    1   DCL UTS UBIN WORD STATIC;
      339    11757    1   DCL DATE_STRING CHAR (8) STATIC;
      340    11758    1   DCL TODAYS_DATE_STRING CHAR (8);
      341    11759    1   DCL TIME_STRING CHAR (11) STATIC;
      342    11760    1   DCL FORMATTED_DATE CHAR (11);
      343    11761
      344    11762    1   DCL VMD$WRITE_BUF_TRUNCATED ENTRY(1);
      345    11763        %INIT_STR(DODCL=YES);
      346    11786    1   dcl X$STRIP_BLANKS entry(1);
      347    11787
      348    11788        %SET LISTSUB='0'B;
      349    11789        %SET LISTMAC='0'B;
      350    11790        /***** Fpts *****/
      351    11791        %EJECT;
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:11   
      352    11792
      353    11793    1       IF NOT DCBADDR(DCB#) -> F$DCB.FCD#
      354    11794    2       THEN DO;
      355    11795
      356    11796    2           DEFAULT_OPEN      = DEFAULT_OPEN_CONST;
      357    11797    2           DEFAULT_OPEN.V_   = vector(DEFAULT_OPEN.V);
      358    11798    2           DEFAULT_OPEN.V.DCB# = DCB#;
      359    11799    2           DEFAULT_OPEN.V.DCB# = DCB#;
      360    11800    3           CALL M$OPEN (DEFAULT_OPEN) WHENALTRETURN DO; END;
      361    11801    2       END;
      362    11802
      363    11803    1       IF DCBADDR(DCB#) -> F$DCB.WIDTH# > 0
      364    11804    1       THEN
      365    11805    1           NAME_WIDTH = MAXIMUM (10, DCBADDR(DCB#) -> F$DCB.WIDTH#/5);
      366    11806    1       ELSE
      367    11807    1           NAME_WIDTH = 20;
      368    11808
      369    11809            %INIT_STR( STR=VM_HEADER_FMT, CODE=E_HEADER_FMT, TEST=YES );
      370    11832    1       call index(IX,'.', VM_HEADER_FMT.NAME#);
      371    11833    1       call binchar( substr(VM_HEADER_FMT.NAME#,IX-3,3), NAME_WIDTH);
      372    11834
      373    11835            %INIT_STR( STR=VM_TITLE_FMT, CODE=E_TITLE_FMT,TEST=YES, VECT="F_FDS.FMT_");
      374    11858
      375    11859    1       call index(IX,'.', VM_TITLE_FMT.NAME#);
      376    11860    1       call binchar( substr(VM_TITLE_FMT.NAME#,IX-3,3), NAME_WIDTH);
      377    11861
      378    11862            %INIT_STR( STR=VM_STATUS1, CODE=E_STATUS1, TEST=YES );
      379    11885            %INIT_STR( STR=VM_STATUS2, CODE=E_STATUS2, TEST=YES );
      380    11908
      381    11909    1       F_FDS.DCB# = DCB#;
      382    11910
      383    11911    1       IF NEED_TITLE_BAR
      384    11912    2       THEN DO;
      385    11913
      386    11914    2           NEED_TITLE_BAR = %NO#;
      387    11915    2           VECT_ARRAY(0) = VECTOR (TEMPBUF);
      388    11916    2           TEMPBUF = substr(VM_STATUS1.NAME#,10,6);
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:12   
      389    11917    2           F_FDS.NVECS# = 1;
      390    11918
      391    11919    2           CALL VMD$WRITE_BUF_TRUNCATED (F_FDS);
      392    11920
      393    11921    2       END;
      394    11922
      395    11923    1       VECT_ARRAY(0) = VECTOR(MESSAGE_NUMBER);
      396    11924
      397    11925    1       FLAG_CHAR = ' ';
      398    11926    1       IX = -1;
      399    11927    1       IF VM_HEADER.STATUS.DEL
      400    11928    1       then IX= 0;
      401    11929    1       else if not VM_HEADER.STATUS.OLD and not VM_HEADER.STATUS.MAKE_OLD
      402    11930    1           then IX = 1;
      403    11931    1           else if not VM_HEADER.STATUS.EXAM
      404    11932    1               then IX = 2;
      405    11933    1               else if VM_HEADER.STATUS.MARK
      406    11934    1                   then IX = 3;
      407    11935
      408    11936    1       if IX >= 0 then FLAG_CHAR = substr(VM_STATUS1.NAME#,IX,1);
      409    11937
      410    11938    1       VECT_ARRAY(1) = VECTOR(FLAG_CHAR);
      411    11939
      412    11940    1       CONVERT_TIME.V.SOURCE# = %CLOCK#;
      413    11941    1       CALL M$TIME (CONVERT_TIME);
      414    11942    1       TODAYS_DATE_STRING = DATE_STRING;
      415    11943
      416    11944    1       CONVERT_TIME.V.SOURCE# = %UTS#;
      417    11945    1       UTS = VM_HEADER.CREATION_DATE;
      418    11946    1       CALL M$TIME (CONVERT_TIME);
      419    11947
      420    11948    1       IF SUBSTR (DATE_STRING, 6, 2) = SUBSTR (TODAYS_DATE_STRING, 6, 2)
      421    11949    1       THEN
      422    11950    1           CALL CONCAT (FORMATTED_DATE, SUBSTR (DATE_STRING, 0, 5), ' ',
      423    11951    1             SUBSTR (TIME_STRING, 0, 5));
      424    11952    1       ELSE
      425    11953    2       do;
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:13   
      426    11954    2           IX = 7;
      427    11955    2           if TIME_STRING < '12:00:00.00' then IX = 4;
      428    11956    2           call concat(FORMATTED_DATE, DATE_STRING, substr(VM_STATUS1.NAME#,IX,3));
      429    11957    2       end;
      430    11958
      431    11959    1       VECT_ARRAY(2) = VECTOR(FORMATTED_DATE);
      432    11960
      433    11961    1       IX = -1;
      434    11962    1       MSG_TYPE = ' ';
      435    11963    1       IF VM_HEADER.STATUS.ERR
      436    11964    1       then IX = 0;
      437    11965    1       else if VM_HEADER.STATUS.ACK
      438    11966    1           then IX = 3;
      439    11967    1           else if VM_HEADER.STATUS.DELIVERY
      440    11968    1               then IX = 6;
      441    11969    1               else if VM_HEADER.STATUS.FCOPY
      442    11970    1                   then IX = 9;
      443    11971    1                   else if VM_HEADER.STATUS.ANSWER
      444    11972    1                       then IX = 12;
      445    11973    1                       else if VM_HEADER.STATUS.FORWARDED
      446    11974    1                           then IX = 15;
      447    11975    1                           else if VM_HEADER.STATUS.BROADCAST
      448    11976    1                               then IX = 18;
      449    11977    1                               else if VM_HEADER.STATUS.RRACK
      450    11978    1                                   then IX = 21;
      451    11979    1                                   else if VM_HEADER.STATUS.ENCL
      452    11980    1                                       then IX = 24;
      453    11981    1       if IX >= 0
      454    11982    1       then MSG_TYPE = substr( VM_STATUS2.NAME#, IX, 3);
      455    11983
      456    11984    1       VECT_ARRAY(3) = VECTOR(MSG_TYPE);
      457    11985    1       VECT_ARRAY(4) = VECTOR(VM_HEADER.NUM_RECORDS);
      458    11986
      459    11987    1       IF VM_HEADER.FROM$ ~= ADDR(NIL)
      460    11988    1       THEN
      461    11989    2       DO;
      462    11990    2           CALL INDEX1R (I, '@', VM_HEADER.FROM$ -> X$STRING.TEXT);
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:14   
      463    11991    2           CALL INDEX (I, ' /', SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, 0, I));
      464    11992    3           DO WHILE I > 0;
      465    11993    3               IF SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, I-1, 1) = ' '
      466    11994    3               THEN
      467    11995    3                   I = I - 1;
      468    11996    3               ELSE
      469    11997    3                   EXIT;
      470    11998    3           END;
      471    11999    2           IF I + 2 <= NAME_WIDTH
      472    12000    3           THEN DO;
      473    12001    3               CALL CONCAT (TEMPBUF, '(', SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, 0,
             12001                        I), ')');
      474    12002    3               LEN = I + 2;
      475    12003    3           END;
      476    12004    3           ELSE DO;
      477    12005    3               CALL CONCAT (TEMPBUF, '(', SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, 0,
             12005                        NAME_WIDTH - 2), '>');
      478    12006    3               LEN = NAME_WIDTH;
      479    12007    3           END;
      480    12008    2           VECT_ARRAY(5) = VECTOR(SUBSTR(TEMPBUF,0,LEN));
      481    12009    2       END;
      482    12010    1       ELSE
      483    12011    1           VECT_ARRAY(5) = VECTOR(SPACE);
      484    12012
      485    12013    1       IF VM_HEADER.SUBJECT$ ~= ADDR(NIL)
      486    12014    1         AND VM_HEADER.SUBJECT$ -> X$STRING.SIZ > 0
      487    12015    2       THEN DO;
      488    12016    2           CALL X$STRIP_BLANKS(VM_HEADER.SUBJECT$); /*strip blanks */
      489    12017    2           VECT_ARRAY(6) = VECTOR(VM_HEADER.SUBJECT$ -> X$STRING.TEXT);
      490    12018    2       END;
      491    12019    1       ELSE
      492    12020    1           VECT_ARRAY(6) = VECTOR(SPACE);
      493    12021
      494    12022    1       F_FDS.FMT_ = vector( substr(VM_HEADER_FMT.NAME#,,VM_HEADER_FMT.L#) );
      495    12023    1       F_FDS.NVECS# = 7;
      496    12024    1       CALL VMD$WRITE_BUF_TRUNCATED(F_FDS);
      497    12025    1       RETURN;
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:15   
      498    12026
      499    12027    1   END VMD$DI_HEADER;
      500    12028        %EOD;

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:16   
--  Include file information  --

   VM_PERR_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMD$DI_HEADER.

   Procedure VMD$DI_HEADER requires 428 words for executable code.
   Procedure VMD$DI_HEADER requires 154 words of local(AUTO) storage.

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:17   

 Object Unit name= VMD$DI_HEADER                              File name= VMD$DISPLAY.:VMB6TOU
 UTS= AUG 20 '97 15:08:08.44 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none   436    664  VMD$DI_HEADER
   12  RoData even  UTS     97    141  VMD$DI_HEADER
   13   Proc  even  none   428    654  VMD$DI_HEADER
   14  RoData even  none    27     33  VMD$DI_HEADER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        3  VMD$DI_HEADER
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:18   

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
   12     72  E_HEADER_FMT                      12     73  E_TITLE_FMT
   12     74  E_STATUS1                         12     75  E_STATUS2
   11    126  VM_DATE_NUMBER_FMT                12     76  E_DATE_NUMBER_FMT
   11    153  VM_TO_FROM_FMT                    12     77  E_TO_FROM_FMT
   11    172  VM_SUBJECT_FMT                    11    204  VM_SUBJECT_FMT1
   12    100  E_SUBJECT_FMT                     12    101  E_SUBJECT_FMT1
   11    216  VM_REPLY_TO_FMT                   12    102  E_REPLY_TO_FMT
   11    230  VM_REFERENCE_FMT                  11    242  VM_REFERENCE_FMT1
   12    103  E_REFERENCE_FMT                   12    104  E_REFERENCE_FMT1
   11    254  VM_REFERENCE_AND_ID_FMT           12    105  E_REFERENCE_AND_ID_FMT
   11    262  VM_RE_STRING                      12    106  E_RE_STRING
   11    270  VM_COPY_FMT                       11    276  VM_COPY_FMT1
   12    107  E_COPY_FMT                        12    110  E_COPY_FMT1
   11    304  VM_BLIND_COPY_FMT                 11    312  VM_BLIND_COPY_FMT1
   12    111  E_BLIND_COPY_FMT                  12    112  E_BLIND_COPY_FMT1
   11    320  VM_CONTINUATION_FMT               12    113  E_CONTINUATION_FMT
   11    325  VM_ERROR_ADDRESS_FMT              12    114  E_ERROR_ADDRESS_FMT
   11    340  VM_TO_FMT                         12    115  E_TO_FMT
   11    346  VM_FCOPY_FMT                      12    116  E_FCOPY_FMT
   11    354  VM_SIGNED_FMT                     12    117  E_SIGNED_FMT
   11    362  VM_RR_FMT                         12    120  E_RR_FMT
   11    374  VM_RTO_FMT                        12    121  E_RTO_FMT
   11    406  VM_DEFER_FMT                      12    122  E_DEFER_FMT
   11    420  VM_DEFER_FMT1                     12    123  E_DEFER_FMT1
   11    432  VM_OPTS_FMT                       12    124  E_OPTS_FMT
   11    457  VM_OPTS_FMT1                      12    125  E_OPTS_FMT1
   11    504  VM_OPTS_FMT2                      12    126  E_OPTS_FMT2
   11    531  VM_DR_FMT                         12    127  E_DR_FMT
   11    543  VM_BROADCAST_FMT                  12    130  E_BROADCAST_FMT
   11    555  VM_ENCL_1_FMT                     12    131  E_ENCL_1_FMT
   11    575  VM_ENCL_2_FMT                     12    132  E_ENCL_2_FMT
   11    615  VM_ENCL_FWD_FMT                   12    133  E_ENCL_FWD_FMT
   11    635  NEED_TITLE_BAR
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:19   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 VMD$ERRMSG
         yes           Std       1 X$STRIP_BLANKS
         yes           Std       1 VMD$WRITE_BUF_TRUNCATED
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:20   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:21   


        1        1        /*M* VMD$DISPLAY Display subroutines  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
        8        8
        9        9        /*P* NAME: VMD$DI_HEADER
       10       10             DESCRIPTION: THIS ROUINE WILL LIST THE CURRENT HEADER
       11       11        */
       12       12
       13       13        VMD$DI_HEADER: PROC (VM_HEADER,MESSAGE_NUMBER,DCB#);

     13 13 000000   000000 700200 xent  VMD$DI_HEAD* TSX0  ! X66_AUTO_3
        13 000001   000232 000003                    ZERO    154,3

       14       14
       15       15        /***** Include files *****/
       16       16        %INCLUDE CP_6_SUBS;
       17      556        %INCLUDE XU_FORMAT_C;
       18      718        %INCLUDE CP_6;
       19     6277        %INCLUDE VM_MACRO_C;
       20     7545        %INCLUDE VM_SUBS_C;
       21     7805        %INCLUDE VM_DATA_R;
       22     8236        %include VM_PERR_C;
       23     8531        /***** Parameters *****/
       24     8532        %VM_HEADER (STCLASS=" ");
       25     8661    1   DCL MESSAGE_NUMBER UBIN WORD;
       26     8662    1   DCL DCB# UBIN WORD;
       27     8663
       28     8664        %F_FDS(    VECTR = VECT_ARRAY );
       29     8777
       30     8778              %F$DCB;
       31     8835
       32     8836        %FPT_OPEN( FPTN=DEFAULT_OPEN_CONST, FUN=CREATE, DISP=NAMED, STCLASS=CONSTANT);
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:22   
       33     8945        %FPT_OPEN( FPTN=DEFAULT_OPEN, STCLASS="");
       34     9054
       35     9055        %FPT_TIME  (FPTN=CONVERT_TIME,
       36     9056                    DEST=LOCAL,
       37     9057                    TSTAMP=UTS,
       38     9058                    DATE=DATE_STRING,
       39     9059                    TIME=TIME_STRING);
       40     9078
       41     9079
       42     9080        %VLP_NAME( FPTN=VM_HEADER_FMT, LEN=60,L=60, NAME=' ', STCLASS=STATIC);
       43     9107        %VLP_NAME( FPTN=VM_TITLE_FMT,  LEN=60,L=60, NAME=' ', STCLASS=STATIC);
       44     9134        %VLP_NAME( FPTN=VM_STATUS1,    LEN=16,L=16, NAME=' ', STCLASS=STATIC);
       45     9161        %VLP_NAME( FPTN=VM_STATUS2,    LEN=27,L=27, NAME=' ', STCLASS=STATIC);
       46     9188
       47     9189        %VLP_ERRCODE( FPTN=E_HEADER_FMT, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       48     9190                      ERR#=%E$HEADER_FMT );
       49     9235        /*E* ERROR:   VMD-E$HEADER_FMT-0
       50     9236             MESSAGE0:"4D "A "A "A"4*D "xxx.0<>MA "A
       51     9237             DESCRIPTION:   '"' is mapped into %.  This is a format phrase.
       52     9238                            "xxx is modified at run time (field width).
       53     9239        */
       54     9240              %VLP_ERRCODE( FPTN=E_TITLE_FMT, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       55     9241              ERR#=%E$TITLE_FMT );
       56     9286        /*E* ERROR:   VMD-E$TITLE_FMT-0
       57     9287             MESSAGE:msg#    when sent      recs"xxx.0<>MA "Asubject
       58     9288             DESCRIPTION: '"' is mapped into %.  This is a format phrase.
       59     9289                          "xxx is modified at run time to be a field width
       60     9290                          for the name.
       61     9291        */
       62     9292              %VLP_ERRCODE( FPTN=E_STATUS1, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       63     9293              ERR#=%E$STATUS1  );
       64     9338        /*E* ERROR:   VMD-E$STATUS1-0
       65     9339             MESSAGE:dnum am pm(from)
       66     9340             DESCRIPTION: Codes associated with message displays.
       67     9341                          d -  deleted              0,1
       68     9342                          n -  new                  1,1
       69     9343                          u -  unexamined           2,1
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:23   
       70     9344                          m -  marked               3,1
       71     9345                     (from) -  header display      10,6
       72     9346        */
       73     9347              %VLP_ERRCODE( FPTN=E_STATUS2, FCG=VM,MID=D, STCLASS="CONSTANT SYMDEF",
       74     9348              ERR#=%E$STATUS2   );
       75     9393        /*E* ERROR: VMD-E$STATUS2-0
       76     9394             MESSAGE:errackdlvfc ansfwdbrdrr enc
       77     9395             DESCRIPTION: More codes associated with message displays:
       78     9396                        err -  error             2  0,3
       79     9397                        ack -  acknowledgement   2  3,3
       80     9398                        dlv -  delivery report   2  6,3
       81     9399                         fc -  file copy         2  9,3
       82     9400                        ans -  answer            2 12,3
       83     9401                        fwd -  forward           2 15,3
       84     9402                        brd -  broadcast         2 18,3
       85     9403                         rr -  return receipt    2 21,3
       86     9404                        enc -  enclosures        2 24,3
       87     9405        */
       88     9406              %VLP_NAME( FPTN=VM_DATE_NUMBER_FMT, LEN=80,L=80, NAME=' ',
       89     9407              STCLASS="STATIC SYMDEF");
       90     9434        %VLP_ERRCODE( FPTN=E_DATE_NUMBER_FMT, STCLASS="CONSTANT SYMDEF",
       91     9435                      ERR#=%E$DATE_NUMBER_FMT, FCG=VM,MID=D     );
       92     9480        /*E* ERROR: VMD-E$DATE_NUMBER_FMT-0
       93     9481             MESSAGE:    Sent:"11-"L15..3U Rcvd: "L15..3U"49-Number:"57-"5LD
       94     9482        */
       95     9483
       96     9484              %VLP_NAME( FPTN=VM_TO_FROM_FMT, LEN=59,L=59, NAME=' ',
       97     9485              STCLASS="STATIC SYMDEF");
       98     9512        %VLP_ERRCODE( FPTN=E_TO_FROM_FMT,      STCLASS="CONSTANT SYMDEF",
       99     9513                      ERR#=%E$TO_FROM_FMT,      FCG=VM,MID=D        );
      100     9558        /*E* ERROR: VMD-E$TO_FROM_FMT-0
      101     9559             MESSAGE:      To:"11-"L35A"N("51-From:"57-"LA")
      102     9560        */
      103     9561
      104     9562              %VLP_NAME( FPTN=VM_SUBJECT_FMT, LEN=39,L=39, NAME=' ',
      105     9563              STCLASS="STATIC SYMDEF");
      106     9590        %VLP_NAME(  FPTN=VM_SUBJECT_FMT1,   LEN=39,L=39, NAME=' ',
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:24   
      107     9591                    STCLASS="STATIC SYMDEF");
      108     9618        %VLP_ERRCODE( FPTN=E_SUBJECT_FMT,   STCLASS="CONSTANT SYMDEF",
      109     9619                      ERR#=%E$SUBJECT_FMT,  FCG=VM,MID=D    );
      110     9664              %VLP_ERRCODE( FPTN=E_SUBJECT_FMT1, STCLASS="CONSTANT SYMDEF",
      111     9665              ERR#=%E$SUBJECT_FMT,  FCG=VM,MID=D,   SEV=1 );
      112     9710        /*E* ERROR:  VMD-E$SUBJECT_FMT-0
      113     9711             MESSAGE: Subject:"11-"L70<A
      114     9712             MESSAGE1:Subject:"10-"L<A
      115     9713             DESCRIPTION:
      116     9714                      When displaying a message, MESSAGE0 is used,
      117     9715                      when displaying a particular item at the options
      118     9716                      prompt in SEND, MESSAGE1 is used.
      119     9717        */
      120     9718
      121     9719              %VLP_NAME( FPTN=VM_REPLY_TO_FMT, LEN=39,L=39, NAME=' ',
      122     9720              STCLASS="STATIC SYMDEF");
      123     9747        %VLP_ERRCODE( FPTN=E_REPLY_TO_FMT,  STCLASS="CONSTANT SYMDEF",
      124     9748                      ERR#=%E$REPLY_TO_FMT, FCG=VM,MID=D    );
      125     9793        /*E* ERROR: VMD-E$REPLY_TO_FMT-0
      126     9794             MESSAGE:Reply To:"11-"LA
      127     9795        */
      128     9796
      129     9797              %VLP_NAME( FPTN=VM_REFERENCE_FMT, LEN=39,L=39, NAME=' ',
      130     9798              STCLASS="STATIC SYMDEF");
      131     9825        %VLP_NAME(    FPTN=VM_REFERENCE_FMT1,LEN=39,L=39, NAME=' ',
      132     9826                      STCLASS="STATIC SYMDEF");
      133     9853        %VLP_ERRCODE( FPTN=E_REFERENCE_FMT, STCLASS="CONSTANT SYMDEF",
      134     9854                      ERR#=%E$REFERENCE_FMT,FCG=VM,MID=D    );
      135     9899              %VLP_ERRCODE( FPTN=E_REFERENCE_FMT1, STCLASS="CONSTANT SYMDEF",
      136     9900              ERR#=%E$REFERENCE_FMT, FCG=VM,MID=D,  SEV=1);
      137     9945        /*E* ERROR: VMD-E$REFERENCE_FMT-0
      138     9946             MESSAGE:      Re:"11-"LA
      139     9947             MESSAGE1:     Re:"10-"LA
      140     9948        */
      141     9949
      142     9950              %VLP_NAME( FPTN=VM_REFERENCE_AND_ID_FMT,LEN=23,L=23,NAME=' ',
      143     9951              STCLASS="STATIC SYMDEF");
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:25   
      144     9978        %VLP_ERRCODE( FPTN=E_REFERENCE_AND_ID_FMT,STCLASS="CONSTANT SYMDEF",
      145     9979                      ERR#=%E$REFERENCE_AND_ID_FMT, FCG=VM,MID=D);
      146    10024        /*E* ERROR: VMD-E$REFERENCE_AND_ID_FMT-0
      147    10025             MESSAGE:"A #"D: "LA
      148    10026        */
      149    10027
      150    10028              %VLP_NAME( FPTN=VM_RE_STRING, LEN=23,L=23, NAME=' ',
      151    10029              STCLASS="STATIC SYMDEF");
      152    10056        %VLP_ERRCODE( FPTN=E_RE_STRING,     STCLASS="CONSTANT SYMDEF",
      153    10057                      ERR#=%E$RE_STRING,    FCG=VM,MID=D        );
      154    10102        /*E* ERROR: VMD-E$RE_STRING-0
      155    10103             MESSAGE:   Re
      156    10104             DESCRIPTION:
      157    10105                    E_RE_STRING is used with E_REFERENCE_AND_ID_FMT.  When
      158    10106                    translating it, don't make it longer than 3 characters.  If
      159    10107                    you want it longer than that, the whole header display will
      160    10108                    have to be shifted to the right.  In any case, make sure that
      161    10109                    it is right justified.
      162    10110        */
      163    10111
      164    10112              %VLP_NAME( FPTN=VM_COPY_FMT,  LEN=23,L=23, NAME=' ',
      165    10113              STCLASS="STATIC SYMDEF");
      166    10140        %VLP_NAME(    FPTN=VM_COPY_FMT1,    LEN=23,L=23, NAME=' ',
      167    10141                      STCLASS="STATIC SYMDEF");
      168    10168        %VLP_ERRCODE( FPTN=E_COPY_FMT,     STCLASS="CONSTANT SYMDEF",
      169    10169                      ERR#=%E$COPY_FMT,     FCG=VM,MID=D         );
      170    10214              %VLP_ERRCODE( FPTN=E_COPY_FMT1, STCLASS="CONSTANT SYMDEF",
      171    10215              ERR#=%E$COPY_FMT,    FCG=VM,MID=D,     SEV=1   );
      172    10260        /*E* ERROR: VMD-E$COPY_FMT-0
      173    10261             MESSAGE:       C:"11-"LA
      174    10262             MESSAGE1:      C:"10-"LA
      175    10263        */
      176    10264
      177    10265              %VLP_NAME( FPTN=VM_BLIND_COPY_FMT, LEN=23,L=23,NAME=' ',
      178    10266              STCLASS="STATIC SYMDEF");
      179    10293        %VLP_NAME(    FPTN=VM_BLIND_COPY_FMT1,LEN=23,L=23,NAME=' ',
      180    10294                      STCLASS="STATIC SYMDEF");
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:26   
      181    10321        %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT, STCLASS="CONSTANT SYMDEF",
      182    10322                      ERR#=%E$BLIND_COPY_FMT,FCG=VM,MID=D       );
      183    10367              %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT1, STCLASS="CONSTANT SYMDEF",
      184    10368              ERR#=%E$BLIND_COPY_FMT, FCG=VM,MID=D,     SEV=1    );
      185    10413        /*E* ERROR: VMD-E$BLIND_COPY_FMT-0
      186    10414             MESSAGE:      Bc:"11-"LA
      187    10415             MESSAGE1:     Bc:"10-"LA
      188    10416        */
      189    10417
      190    10418              %VLP_NAME( FPTN=VM_CONTINUATION_FMT,LEN=19,L=19,NAME=' ',
      191    10419              STCLASS="STATIC SYMDEF");
      192    10446        %VLP_ERRCODE( FPTN=E_CONTINUATION_FMT,STCLASS="CONSTANT SYMDEF",
      193    10447                      ERR#=%E$CONTINUATION_FMT,FCG=VM,MID=D      );
      194    10492        /*E* ERROR: VMD-E$CONTINUATION_FMT-0
      195    10493             MESSAGE:"11-"<A
      196    10494        */
      197    10495
      198    10496              %VLP_NAME( FPTN=VM_ERROR_ADDRESS_FMT,LEN=43,L=43,NAME=' ',
      199    10497              STCLASS="STATIC SYMDEF");
      200    10524        %VLP_ERRCODE( FPTN=E_ERROR_ADDRESS_FMT,STCLASS="CONSTANT SYMDEF",
      201    10525                      ERR#=%E$ERROR_ADDRESS_FMT, FCG=VM,MID=D     );
      202    10570        /*E* ERROR: VMD-E$ERROR_ADDRESS_FMT-0
      203    10571             MESSAGE:  Address in question: "LA
      204    10572        */
      205    10573
      206    10574
      207    10575              %VLP_NAME( FPTN=VM_TO_FMT,    LEN=23,L=23, NAME=' ',
      208    10576              STCLASS="STATIC SYMDEF");
      209    10603        %VLP_ERRCODE( FPTN=E_TO_FMT,       STCLASS="CONSTANT SYMDEF",
      210    10604                      ERR#=%E$TO_FMT,       FCG=VM,MID=D          );
      211    10649        /*E* ERROR: VMD-E$TO_FMT-0
      212    10650             MESSAGE:     To:"10-"LA
      213    10651        */
      214    10652
      215    10653              %VLP_NAME( FPTN=VM_FCOPY_FMT, LEN=23,L=23, NAME=' ',
      216    10654              STCLASS="STATIC SYMDEF");
      217    10681        %VLP_ERRCODE( FPTN=E_FCOPY_FMT,     STCLASS="CONSTANT SYMDEF",
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:27   
      218    10682                      ERR#=%E$FCOPY_FMT,    FCG=VM,MID=D         );
      219    10727        /*E* ERROR: VMD-E$FCOPY_FMT-0
      220    10728             MESSAGE: FCOPY ="10-"LA
      221    10729        */
      222    10730
      223    10731              %VLP_NAME( FPTN=VM_SIGNED_FMT, LEN=23,L=23, NAME=' ',
      224    10732              STCLASS="STATIC SYMDEF");
      225    10759        %VLP_ERRCODE( FPTN=E_SIGNED_FMT,    STCLASS="CONSTANT SYMDEF",
      226    10760                      ERR#=%E$SIGNED_FMT,   FCG=VM,MID=D         );
      227    10805        /*E* ERROR: VMD-E$SIGNED_FMT-0
      228    10806             MESSAGE:Signed ="10-"LA
      229    10807        */
      230    10808
      231    10809              %VLP_NAME( FPTN=VM_RR_FMT,    LEN=39,L=39, NAME=' ',
      232    10810              STCLASS="STATIC SYMDEF");
      233    10837        %VLP_ERRCODE( FPTN=E_RR_FMT,        STCLASS="CONSTANT SYMDEF",
      234    10838                      ERR#=%E$RR_FMT,       FCG=VM,MID=D         );
      235    10883        /*E* ERROR: VMD-E$RR_FMT-0
      236    10884             MESSAGE: Return Receipt = "19-"LA
      237    10885        */
      238    10886
      239    10887
      240    10888              %VLP_NAME( FPTN=VM_RTO_FMT,   LEN=39,L=39, NAME=' ',
      241    10889              STCLASS="STATIC SYMDEF");
      242    10916        %VLP_ERRCODE( FPTN=E_RTO_FMT,       STCLASS="CONSTANT SYMDEF",
      243    10917                      ERR#=%E$RTO_FMT,      FCG=VM,MID=D             );
      244    10962        /*E* ERROR: VMD-E$RTO_FMT-0
      245    10963             MESSAGE:Reply To = "12-"LA
      246    10964        */
      247    10965
      248    10966              %VLP_NAME( FPTN=VM_DEFER_FMT, LEN=39,L=39, NAME=' ',
      249    10967              STCLASS="STATIC SYMDEF");
      250    10994        %VLP_ERRCODE( FPTN=E_DEFER_FMT,     STCLASS="CONSTANT SYMDEF",
      251    10995                      ERR#=%E$DEFER_FMT,    FCG=VM,MID=D             );
      252    11040        /*E* ERROR: VMD-E$DEFER_FMT-0
      253    11041             MESSAGE: Defer ="10-"L15..3U
      254    11042        */
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:28   
      255    11043
      256    11044              %VLP_NAME( FPTN=VM_DEFER_FMT1, LEN=39,L=39, NAME=' ',
      257    11045              STCLASS="STATIC SYMDEF");
      258    11072        %VLP_ERRCODE( FPTN=E_DEFER_FMT1,    STCLASS="CONSTANT SYMDEF",
      259    11073                      ERR#=%E$DEFER_FMT1,   FCG=VM,MID=D             );
      260    11118        /*E* ERROR: VMD-E$DEFER_FMT1-0
      261    11119             MESSAGE: Defer ="10-"LA
      262    11120        */
      263    11121
      264    11122              %VLP_NAME( FPTN=VM_OPTS_FMT,  LEN=83,L=83, NAME=' ',
      265    11123              STCLASS="STATIC SYMDEF");
      266    11150        %VLP_ERRCODE( FPTN=E_OPTS_FMT,      STCLASS="CONSTANT SYMDEF",
      267    11151                      ERR#=%E$OPTS_FMT,     FCG=VM,MID=D              );
      268    11196        /*E* ERROR: VMD-E$OPTS_FMT-0
      269    11197             MESSAGE:Options: Delivery Receipt = "A, Return Receipt = "A, Defer = "L15..3U
      270    11198        */
      271    11199
      272    11200              %VLP_NAME( FPTN=VM_OPTS_FMT1, LEN=83,L=83, NAME=' ',
      273    11201              STCLASS="STATIC SYMDEF");
      274    11228        %VLP_ERRCODE( FPTN=E_OPTS_FMT1,     STCLASS="CONSTANT SYMDEF",
      275    11229                      ERR#=%E$OPTS_FMT1,    FCG=VM,MID=D              );
      276    11274        /*E* ERROR: VMD-E$OPTS_FMT1-0
      277    11275             MESSAGE:Options: Delivery Receipt = "A, Return Receipt = "A
      278    11276        */
      279    11277
      280    11278              %VLP_NAME( FPTN=VM_OPTS_FMT2, LEN=83,L=83, NAME=' ',
      281    11279              STCLASS="STATIC SYMDEF");
      282    11306        %VLP_ERRCODE( FPTN=E_OPTS_FMT2,     STCLASS="CONSTANT SYMDEF",
      283    11307                      ERR#=%E$OPTS_FMT2,    FCG=VM,MID=D              );
      284    11352        /*E* ERROR: VMD-E$OPTS_FMT2-0
      285    11353             MESSAGE:         Broadcast = "A,        File Copy = "A
      286    11354        */
      287    11355
      288    11356              %VLP_NAME( FPTN=VM_DR_FMT,   LEN=39,L=39, NAME=' ',
      289    11357              STCLASS="STATIC SYMDEF" );
      290    11384        %VLP_ERRCODE( FPTN=E_DR_FMT,       STCLASS="CONSTANT SYMDEF",
      291    11385                      ERR#=%E$DR_FMT,      FCG=VM,MID=D               );
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:29   
      292    11430        /*E* ERROR: VMD-E$DR_FMT-0
      293    11431             MESSAGE:Delivery Receipt = "20-"LA
      294    11432        */
      295    11433
      296    11434              %VLP_NAME( FPTN=VM_BROADCAST_FMT,LEN=39,L=39, NAME=' ',
      297    11435              STCLASS="STATIC SYMDEF"                         );
      298    11462        %VLP_ERRCODE( FPTN=E_BROADCAST_FMT, STCLASS="CONSTANT SYMDEF",
      299    11463                      ERR#=%E$BROADCAST_FMT,FCG=VM,MID=D              );
      300    11508        /*E* ERROR:  VMD-E$BROADCAST_FMT-0
      301    11509             MESSAGE:Broadcast = "13-"LA
      302    11510        */
      303    11511              %VLP_NAME( FPTN=VM_ENCL_1_FMT,   LEN=60,L=60,NAME=' ',
      304    11512              STCLASS="STATIC SYMDEF");
      305    11539        %VLP_ERRCODE( FPTN=E_ENCL_1_FMT,       STCLASS="CONSTANT SYMDEF",
      306    11540                      ERR#=%E$ENCL_1_FMT,       FCG=VM,MID=D               );
      307    11585        /*E* ERROR: VMD-E$ENCL_1_FMT-0
      308    11586             MESSAGE:    Encl: encl#   recs        Title
      309    11587        */
      310    11588              %VLP_NAME( FPTN=VM_ENCL_2_FMT,   LEN=60,L=60,NAME=' ',
      311    11589              STCLASS="STATIC SYMDEF");
      312    11616        %VLP_ERRCODE( FPTN=E_ENCL_2_FMT,       STCLASS="CONSTANT SYMDEF",
      313    11617                      ERR#=%E$ENCL_2_FMT,       FCG=VM,MID=D               );
      314    11662        /*E* ERROR: VMD-E$ENCL_2_FMT-0
      315    11663             MESSAGE:"12-"2D"A"17-"A"20-"11LD"31-"LT
      316    11664        */
      317    11665              %VLP_NAME( FPTN=VM_ENCL_FWD_FMT,  LEN=60,L=60,NAME=' ',
      318    11666              STCLASS="STATIC SYMDEF");
      319    11693        %VLP_ERRCODE( FPTN=E_ENCL_FWD_FMT,      STCLASS="CONSTANT SYMDEF",
      320    11694                      ERR#=%E$ENCL_FWD_FMT,      FCG=VM,MID=D              );
      321    11739        /*E* ERROR: VMD-E$ENCL_FWD_FMT-0
      322    11740             MESSAGE:    Encl: moved to enclosing mailgram
      323    11741        */
      324    11742
      325    11743
      326    11744    1   DCL NEED_TITLE_BAR BIT (1) STATIC SYMDEF INIT ('0'B);
      327    11745    1   DCL VECT_ARRAY (0:7) STATIC VECTOR;
      328    11746
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:30   
      329    11747    1   DCL WORK_BUF CHAR(50);
      330    11748    1   DCL TEMPBUF CHAR(256);
      331    11749    1   DCL I SBIN WORD;
      332    11750    1   dcl IX sbin;
      333    11751    1   DCL FLAG_CHAR CHAR (1);
      334    11752    1   DCL MSG_TYPE CHAR (3);
      335    11753    1   DCL NAME_WIDTH UBIN;
      336    11754    1   DCL LEN SBIN WORD;
      337    11755    1   DCL SPACE CHAR(1) CONSTANT INIT(' ');
      338    11756    1   DCL UTS UBIN WORD STATIC;
      339    11757    1   DCL DATE_STRING CHAR (8) STATIC;
      340    11758    1   DCL TODAYS_DATE_STRING CHAR (8);
      341    11759    1   DCL TIME_STRING CHAR (11) STATIC;
      342    11760    1   DCL FORMATTED_DATE CHAR (11);
      343    11761
      344    11762    1   DCL VMD$WRITE_BUF_TRUNCATED ENTRY(1);
      345    11763        %INIT_STR(DODCL=YES);
      346    11786    1   dcl X$STRIP_BLANKS entry(1);
      347    11787
      348    11788        %SET LISTSUB='0'B;
      349    11789        %SET LISTMAC='0'B;
      350    11790        /***** Fpts *****/
      351    11791        %EJECT;
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:31   
      352    11792
      353    11793    1       IF NOT DCBADDR(DCB#) -> F$DCB.FCD#

  11793 13 000002   000000 470400 14                 LDP0    0
        13 000003   000000 471500                    LDP1    0,,PR0
        13 000004   200005 473500                    LDP3    @DCB#,,AUTO
        13 000005   300000 720100                    LXL0    0,,PR3
        13 000006   100000 474510                    LDP4    0,X0,PR1
        13 000007   400031 236100                    LDQ     25,,PR4
        13 000010   020000 316007                    CANQ    8192,DL
        13 000011   000033 601000 13                 TNZ     s:11803

      354    11794    2       THEN DO;

      355    11795
      356    11796    2           DEFAULT_OPEN      = DEFAULT_OPEN_CONST;

  11796 13 000012   000100 100400                    MLR     fill='000'O
        13 000013   000000 000350 12                 ADSC9   DEFAULT_OPEN_CONST       cn=0,n=232
        13 000014   200006 000350                    ADSC9   DEFAULT_OPEN,,AUTO       cn=0,n=232

      357    11797    2           DEFAULT_OPEN.V_   = vector(DEFAULT_OPEN.V);

  11797 13 000015   000001 235000 14                 LDA     1
        13 000016   200230 452500                    STP2    FORMATTED_DATE+3,,AUTO
        13 000017   200230 236100                    LDQ     FORMATTED_DATE+3,,AUTO
        13 000020   000052 036003                    ADLQ    42,DU
        13 000021   200006 757100                    STAQ    DEFAULT_OPEN,,AUTO

      358    11798    2           DEFAULT_OPEN.V.DCB# = DCB#;

  11798 13 000022   300000 720100                    LXL0    0,,PR3
        13 000023   200052 740100                    STX0    DEFAULT_OPEN+36,,AUTO

      359    11799    2           DEFAULT_OPEN.V.DCB# = DCB#;

  11799 13 000024   300000 721100                    LXL1    0,,PR3
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:32   
        13 000025   200052 741100                    STX1    DEFAULT_OPEN+36,,AUTO

      360    11800    3           CALL M$OPEN (DEFAULT_OPEN) WHENALTRETURN DO; END;

  11800 13 000026   200006 630500                    EPPR0   DEFAULT_OPEN,,AUTO
        13 000027   450000 713400                    CLIMB   alt,open
        13 000030   410400 401760                    pmme    nvectors=18
        13 000031   000033 702000 13                 TSX2    s:11803
        13 000032   000033 710000 13                 TRA     s:11803

      361    11801    2       END;

      362    11802
      363    11803    1       IF DCBADDR(DCB#) -> F$DCB.WIDTH# > 0

  11803 13 000033   000000 470400 14                 LDP0    0
        13 000034   000000 471500                    LDP1    0,,PR0
        13 000035   200005 473500                    LDP3    @DCB#,,AUTO
        13 000036   300000 720100                    LXL0    0,,PR3
        13 000037   100000 474510                    LDP4    0,X0,PR1
        13 000040   400004 236100                    LDQ     4,,PR4
        13 000041   000777 316007                    CANQ    511,DL
        13 000042   000053 600000 13                 TZE     s:11807

      364    11804    1       THEN
      365    11805    1           NAME_WIDTH = MAXIMUM (10, DCBADDR(DCB#) -> F$DCB.WIDTH#/5);

  11805 13 000043   400004 236100                    LDQ     4,,PR4
        13 000044   000777 376007                    ANQ     511,DL
        13 000045   000005 506007                    DIV     5,DL
        13 000046   000012 116007                    CMPQ    10,DL
        13 000047   000051 603000 13                 TRC     s:11805+6
        13 000050   000012 236007                    LDQ     10,DL
        13 000051   200221 756100                    STQ     NAME_WIDTH,,AUTO
        13 000052   000055 710000 13                 TRA     s:11816

      366    11806    1       ELSE
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:33   
      367    11807    1           NAME_WIDTH = 20;

  11807 13 000053   000024 235007                    LDA     20,DL
        13 000054   200221 755100                    STA     NAME_WIDTH,,AUTO

      368    11808
      369    11809            %INIT_STR( STR=VM_HEADER_FMT, CODE=E_HEADER_FMT, TEST=YES );

  11816 13 000055   040000 106400                    CMPC    fill='040'O
        13 000056   000052 200074 11                 ADSC9   VM_HEADER_FMT            cn=1,n=60
        13 000057   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000060   000065 601000 13                 TNZ     s:11832

  11818 13 000061   000004 630400 14                 EPPR0   4
        13 000062   000003 631400 14                 EPPR1   3
        13 000063   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000064   000000 011000                    NOP     0

      370    11832    1       call index(IX,'.', VM_HEADER_FMT.NAME#);

  11832 13 000065   000000 124400                    SCM     mask='000'O
        13 000066   000052 200074 11                 ADSC9   VM_HEADER_FMT            cn=1,n=60
        13 000067   000006 000001 14                 ADSC9   6                        cn=0,n=1
        13 000070   200216 000100                    ARG     IX,,AUTO

      371    11833    1       call binchar( substr(VM_HEADER_FMT.NAME#,IX-3,3), NAME_WIDTH);

  11833 13 000071   200221 235100                    LDA     NAME_WIDTH,,AUTO
        13 000072   000044 773000                    LRL     36
        13 000073   200230 757100                    STAQ    FORMATTED_DATE+3,,AUTO
        13 000074   200216 235100                    LDA     IX,,AUTO
        13 000075   000005 301500                    BTD
        13 000076   200230 000010                    NDSC9   FORMATTED_DATE+3,,AUTO   cn=0,s=lsgnf,sf=0,n=8
        13 000077   000051 430003 11                 NDSC9   CONVERT_TIME+11,A        cn=2,s=nosgn,sf=0,n=3

      372    11834
      373    11835            %INIT_STR( STR=VM_TITLE_FMT, CODE=E_TITLE_FMT,TEST=YES, VECT="F_FDS.FMT_");
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:34   

  11842 13 000100   040000 106400                    CMPC    fill='040'O
        13 000101   000072 200074 11                 ADSC9   VM_TITLE_FMT             cn=1,n=60
        13 000102   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000103   000111 601000 13                 TNZ     s:11847

  11844 13 000104   000010 630400 14                 EPPR0   8
        13 000105   000007 631400 14                 EPPR1   7
        13 000106   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000107   000000 011000                    NOP     0

  11845 13 000110   000117 710000 13                 TRA     s:11859

  11847 13 000111   000072 236000 11                 LDQ     VM_TITLE_FMT
        13 000112   000033 772000                    QRL     27
        13 000113   000064 737000                    LLS     52
        13 000114   000140 135007                    SBLA    96,DL
        13 000115   000013 236000 14                 LDQ     11
        13 000116   000000 757000 11                 STAQ    F_FDS

      374    11858
      375    11859    1       call index(IX,'.', VM_TITLE_FMT.NAME#);

  11859 13 000117   000000 124400                    SCM     mask='000'O
        13 000120   000072 200074 11                 ADSC9   VM_TITLE_FMT             cn=1,n=60
        13 000121   000006 000001 14                 ADSC9   6                        cn=0,n=1
        13 000122   200216 000100                    ARG     IX,,AUTO

      376    11860    1       call binchar( substr(VM_TITLE_FMT.NAME#,IX-3,3), NAME_WIDTH);

  11860 13 000123   200221 235100                    LDA     NAME_WIDTH,,AUTO
        13 000124   000044 773000                    LRL     36
        13 000125   200230 757100                    STAQ    FORMATTED_DATE+3,,AUTO
        13 000126   200216 235100                    LDA     IX,,AUTO
        13 000127   000005 301500                    BTD
        13 000130   200230 000010                    NDSC9   FORMATTED_DATE+3,,AUTO   cn=0,s=lsgnf,sf=0,n=8
        13 000131   000071 430003 11                 NDSC9   VM_HEADER_FMT+15,A       cn=2,s=nosgn,sf=0,n=3
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:35   

      377    11861
      378    11862            %INIT_STR( STR=VM_STATUS1, CODE=E_STATUS1, TEST=YES );

  11869 13 000132   040000 106400                    CMPC    fill='040'O
        13 000133   000112 200020 11                 ADSC9   VM_STATUS1               cn=1,n=16
        13 000134   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000135   000142 601000 13                 TNZ     s:11892

  11871 13 000136   000014 630400 14                 EPPR0   12
        13 000137   000003 631400 14                 EPPR1   3
        13 000140   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000141   000000 011000                    NOP     0

      379    11885            %INIT_STR( STR=VM_STATUS2, CODE=E_STATUS2, TEST=YES );

  11892 13 000142   040000 106400                    CMPC    fill='040'O
        13 000143   000117 200033 11                 ADSC9   VM_STATUS2               cn=1,n=27
        13 000144   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000145   000152 601000 13                 TNZ     s:11909

  11894 13 000146   000016 630400 14                 EPPR0   14
        13 000147   000003 631400 14                 EPPR1   3
        13 000150   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000151   000000 011000                    NOP     0

      380    11908
      381    11909    1       F_FDS.DCB# = DCB#;

  11909 13 000152   200005 470500                    LDP0    @DCB#,,AUTO
        13 000153   000000 720100                    LXL0    0,,PR0
        13 000154   000013 740000 11                 STX0    F_FDS+11

      382    11910
      383    11911    1       IF NEED_TITLE_BAR

  11911 13 000155   000635 234000 11                 SZN     NEED_TITLE_BAR
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:36   
        13 000156   000176 605000 13                 TPL     s:11923

      384    11912    2       THEN DO;

      385    11913
      386    11914    2           NEED_TITLE_BAR = %NO#;

  11914 13 000157   000635 450000 11                 STZ     NEED_TITLE_BAR

      387    11915    2           VECT_ARRAY(0) = VECTOR (TEMPBUF);

  11915 13 000160   000020 235000 14                 LDA     16
        13 000161   200230 452500                    STP2    FORMATTED_DATE+3,,AUTO
        13 000162   200230 236100                    LDQ     FORMATTED_DATE+3,,AUTO
        13 000163   000115 036003                    ADLQ    77,DU
        13 000164   000636 757000 11                 STAQ    VECT_ARRAY

      388    11916    2           TEMPBUF = substr(VM_STATUS1.NAME#,10,6);

  11916 13 000165   040100 100400                    MLR     fill='040'O
        13 000166   000114 600006 11                 ADSC9   VM_STATUS1+2             cn=3,n=6
        13 000167   200115 000400                    ADSC9   TEMPBUF,,AUTO            cn=0,n=256

      389    11917    2           F_FDS.NVECS# = 1;

  11917 13 000170   000001 235007                    LDA     1,DL
        13 000171   000011 755000 11                 STA     F_FDS+9

      390    11918
      391    11919    2           CALL VMD$WRITE_BUF_TRUNCATED (F_FDS);

  11919 13 000172   000012 630400 14                 EPPR0   10
        13 000173   000021 631400 14                 EPPR1   17
        13 000174   000000 701000 xent               TSX1    VMD$WRITE_BUF_TRUNCATED
        13 000175   000000 011000                    NOP     0

      392    11920
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:37   
      393    11921    2       END;

      394    11922
      395    11923    1       VECT_ARRAY(0) = VECTOR(MESSAGE_NUMBER);

  11923 13 000176   777640 235007                    LDA     -96,DL
        13 000177   200004 236100                    LDQ     @MESSAGE_NUMBER,,AUTO
        13 000200   000636 757000 11                 STAQ    VECT_ARRAY

      396    11924
      397    11925    1       FLAG_CHAR = ' ';

  11925 13 000201   040000 236003                    LDQ     16384,DU
        13 000202   200217 756100                    STQ     FLAG_CHAR,,AUTO

      398    11926    1       IX = -1;

  11926 13 000203   000001 335007                    LCA     1,DL
        13 000204   200216 755100                    STA     IX,,AUTO

      399    11927    1       IF VM_HEADER.STATUS.DEL

  11927 13 000205   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000206   000012 236100                    LDQ     10,,PR0
        13 000207   000400 316003                    CANQ    256,DU
        13 000210   000213 600000 13                 TZE     s:11929

      400    11928    1       then IX= 0;

  11928 13 000211   200216 450100                    STZ     IX,,AUTO
        13 000212   000233 710000 13                 TRA     s:11936

      401    11929    1       else if not VM_HEADER.STATUS.OLD and not VM_HEADER.STATUS.MAKE_OLD

  11929 13 000213   004000 316003                    CANQ    2048,DU
        13 000214   000222 601000 13                 TNZ     s:11931
        13 000215   002000 316003                    CANQ    1024,DU
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:38   
        13 000216   000222 601000 13                 TNZ     s:11931

      402    11930    1           then IX = 1;

  11930 13 000217   000001 235007                    LDA     1,DL
        13 000220   200216 755100                    STA     IX,,AUTO
        13 000221   000233 710000 13                 TRA     s:11936

      403    11931    1           else if not VM_HEADER.STATUS.EXAM

  11931 13 000222   000012 430100                    FSZN    10,,PR0
        13 000223   000227 604000 13                 TMI     s:11933

      404    11932    1               then IX = 2;

  11932 13 000224   000002 235007                    LDA     2,DL
        13 000225   200216 755100                    STA     IX,,AUTO
        13 000226   000233 710000 13                 TRA     s:11936

      405    11933    1               else if VM_HEADER.STATUS.MARK

  11933 13 000227   000100 316003                    CANQ    64,DU
        13 000230   000233 600000 13                 TZE     s:11936

      406    11934    1                   then IX = 3;

  11934 13 000231   000003 235007                    LDA     3,DL
        13 000232   200216 755100                    STA     IX,,AUTO

      407    11935
      408    11936    1       if IX >= 0 then FLAG_CHAR = substr(VM_STATUS1.NAME#,IX,1);

  11936 13 000233   200216 235100                    LDA     IX,,AUTO
        13 000234   000240 604000 13                 TMI     s:11938

  11936 13 000235   040100 100405                    MLR     fill='040'O
        13 000236   000112 200001 11                 ADSC9   VM_STATUS1,A             cn=1,n=1
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:39   
        13 000237   200217 000001                    ADSC9   FLAG_CHAR,,AUTO          cn=0,n=1

      409    11937
      410    11938    1       VECT_ARRAY(1) = VECTOR(FLAG_CHAR);

  11938 13 000240   177640 235007                    LDA     65440,DL
        13 000241   200230 452500                    STP2    FORMATTED_DATE+3,,AUTO
        13 000242   200230 236100                    LDQ     FORMATTED_DATE+3,,AUTO
        13 000243   000217 036003                    ADLQ    143,DU
        13 000244   000640 757000 11                 STAQ    VECT_ARRAY+2

      411    11939
      412    11940    1       CONVERT_TIME.V.SOURCE# = %CLOCK#;

  11940 13 000245   000000 236003                    LDQ     0,DU
        13 000246   000050 552040 11                 STBQ    CONVERT_TIME+10,'40'O

      413    11941    1       CALL M$TIME (CONVERT_TIME);

  11941 13 000247   000036 630400 11                 EPPR0   CONVERT_TIME
        13 000250   020004 713400                    CLIMB   8196
        13 000251   402000 401760                    pmme    nvectors=5

      414    11942    1       TODAYS_DATE_STRING = DATE_STRING;

  11942 13 000252   040100 100400                    MLR     fill='040'O
        13 000253   000657 000010 11                 ADSC9   DATE_STRING              cn=0,n=8
        13 000254   200223 000010                    ADSC9   TODAYS_DATE_STRING,,AUTO cn=0,n=8

      415    11943
      416    11944    1       CONVERT_TIME.V.SOURCE# = %UTS#;

  11944 13 000255   004000 236003                    LDQ     2048,DU
        13 000256   000050 552040 11                 STBQ    CONVERT_TIME+10,'40'O

      417    11945    1       UTS = VM_HEADER.CREATION_DATE;

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:40   
  11945 13 000257   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000260   000001 235100                    LDA     1,,PR0
        13 000261   000656 755000 11                 STA     UTS

      418    11946    1       CALL M$TIME (CONVERT_TIME);

  11946 13 000262   000036 630400 11                 EPPR0   CONVERT_TIME
        13 000263   020004 713400                    CLIMB   8196
        13 000264   402000 401760                    pmme    nvectors=5

      419    11947
      420    11948    1       IF SUBSTR (DATE_STRING, 6, 2) = SUBSTR (TODAYS_DATE_STRING, 6, 2)

  11948 13 000265   000660 236000 11                 LDQ     DATE_STRING+1
        13 000266   200224 676100                    ERQ     TODAYS_DATE_STRING+1,,AUTO
        13 000267   777777 376007                    ANQ     -1,DL
        13 000270   000302 601000 13                 TNZ     s:11954

      421    11949    1       THEN
      422    11950    1           CALL CONCAT (FORMATTED_DATE, SUBSTR (DATE_STRING, 0, 5), ' ',

  11950 13 000271   040100 100400                    MLR     fill='040'O
        13 000272   000657 000005 11                 ADSC9   DATE_STRING              cn=0,n=5
        13 000273   200225 000005                    ADSC9   FORMATTED_DATE,,AUTO     cn=0,n=5
        13 000274   000040 236003                    LDQ     32,DU
        13 000275   200226 552120                    STBQ    FORMATTED_DATE+1,'20'O,AUTO
        13 000276   040100 100400                    MLR     fill='040'O
        13 000277   000661 000005 11                 ADSC9   TIME_STRING              cn=0,n=5
        13 000300   200226 400005                    ADSC9   FORMATTED_DATE+1,,AUTO   cn=2,n=5
        13 000301   000321 710000 13                 TRA     s:11959

      423    11951    1             SUBSTR (TIME_STRING, 0, 5));
      424    11952    1       ELSE
      425    11953    2       do;

      426    11954    2           IX = 7;

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:41   
  11954 13 000302   000007 235007                    LDA     7,DL
        13 000303   200216 755100                    STA     IX,,AUTO

      427    11955    2           if TIME_STRING < '12:00:00.00' then IX = 4;

  11955 13 000304   040000 106400                    CMPC    fill='040'O
        13 000305   000661 000013 11                 ADSC9   TIME_STRING              cn=0,n=11
        13 000306   000135 000013 12                 ADSC9   SPACE+1                  cn=0,n=11
        13 000307   000312 603000 13                 TRC     s:11956

  11955 13 000310   000004 236007                    LDQ     4,DL
        13 000311   200216 756100                    STQ     IX,,AUTO

      428    11956    2           call concat(FORMATTED_DATE, DATE_STRING, substr(VM_STATUS1.NAME#,IX,3));

  11956 13 000312   040100 100400                    MLR     fill='040'O
        13 000313   000657 000010 11                 ADSC9   DATE_STRING              cn=0,n=8
        13 000314   200225 000010                    ADSC9   FORMATTED_DATE,,AUTO     cn=0,n=8
        13 000315   200216 236100                    LDQ     IX,,AUTO
        13 000316   040100 100406                    MLR     fill='040'O
        13 000317   000112 200003 11                 ADSC9   VM_STATUS1,Q             cn=1,n=3
        13 000320   200227 000003                    ADSC9   FORMATTED_DATE+2,,AUTO   cn=0,n=3

      429    11957    2       end;

      430    11958
      431    11959    1       VECT_ARRAY(2) = VECTOR(FORMATTED_DATE);

  11959 13 000321   000022 235000 14                 LDA     18
        13 000322   200230 452500                    STP2    FORMATTED_DATE+3,,AUTO
        13 000323   200230 236100                    LDQ     FORMATTED_DATE+3,,AUTO
        13 000324   000225 036003                    ADLQ    149,DU
        13 000325   000642 757000 11                 STAQ    VECT_ARRAY+4

      432    11960
      433    11961    1       IX = -1;

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:42   
  11961 13 000326   000001 335007                    LCA     1,DL
        13 000327   200216 755100                    STA     IX,,AUTO

      434    11962    1       MSG_TYPE = ' ';

  11962 13 000330   000023 236000 14                 LDQ     19
        13 000331   200220 756100                    STQ     MSG_TYPE,,AUTO

      435    11963    1       IF VM_HEADER.STATUS.ERR

  11963 13 000332   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000333   000012 234100                    SZN     10,,PR0
        13 000334   000337 605000 13                 TPL     s:11965

      436    11964    1       then IX = 0;

  11964 13 000335   200216 450100                    STZ     IX,,AUTO
        13 000336   000407 710000 13                 TRA     s:11981

      437    11965    1       else if VM_HEADER.STATUS.ACK

  11965 13 000337   000012 236100                    LDQ     10,,PR0
        13 000340   100000 316003                    CANQ    32768,DU
        13 000341   000345 600000 13                 TZE     s:11967

      438    11966    1           then IX = 3;

  11966 13 000342   000003 235007                    LDA     3,DL
        13 000343   200216 755100                    STA     IX,,AUTO
        13 000344   000407 710000 13                 TRA     s:11981

      439    11967    1           else if VM_HEADER.STATUS.DELIVERY

  11967 13 000345   000002 316003                    CANQ    2,DU
        13 000346   000352 600000 13                 TZE     s:11969

      440    11968    1               then IX = 6;
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:43   

  11968 13 000347   000006 235007                    LDA     6,DL
        13 000350   200216 755100                    STA     IX,,AUTO
        13 000351   000407 710000 13                 TRA     s:11981

      441    11969    1               else if VM_HEADER.STATUS.FCOPY

  11969 13 000352   000200 316003                    CANQ    128,DU
        13 000353   000357 600000 13                 TZE     s:11971

      442    11970    1                   then IX = 9;

  11970 13 000354   000011 235007                    LDA     9,DL
        13 000355   200216 755100                    STA     IX,,AUTO
        13 000356   000407 710000 13                 TRA     s:11981

      443    11971    1                   else if VM_HEADER.STATUS.ANSWER

  11971 13 000357   200000 316003                    CANQ    65536,DU
        13 000360   000364 600000 13                 TZE     s:11973

      444    11972    1                       then IX = 12;

  11972 13 000361   000014 235007                    LDA     12,DL
        13 000362   200216 755100                    STA     IX,,AUTO
        13 000363   000407 710000 13                 TRA     s:11981

      445    11973    1                       else if VM_HEADER.STATUS.FORWARDED

  11973 13 000364   000020 316003                    CANQ    16,DU
        13 000365   000371 600000 13                 TZE     s:11975

      446    11974    1                           then IX = 15;

  11974 13 000366   000017 235007                    LDA     15,DL
        13 000367   200216 755100                    STA     IX,,AUTO
        13 000370   000407 710000 13                 TRA     s:11981
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:44   

      447    11975    1                           else if VM_HEADER.STATUS.BROADCAST

  11975 13 000371   000001 316003                    CANQ    1,DU
        13 000372   000376 600000 13                 TZE     s:11977

      448    11976    1                               then IX = 18;

  11976 13 000373   000022 235007                    LDA     18,DL
        13 000374   200216 755100                    STA     IX,,AUTO
        13 000375   000407 710000 13                 TRA     s:11981

      449    11977    1                               else if VM_HEADER.STATUS.RRACK

  11977 13 000376   020000 316007                    CANQ    8192,DL
        13 000377   000403 600000 13                 TZE     s:11979

      450    11978    1                                   then IX = 21;

  11978 13 000400   000025 235007                    LDA     21,DL
        13 000401   200216 755100                    STA     IX,,AUTO
        13 000402   000407 710000 13                 TRA     s:11981

      451    11979    1                                   else if VM_HEADER.STATUS.ENCL

  11979 13 000403   004000 316007                    CANQ    2048,DL
        13 000404   000407 600000 13                 TZE     s:11981

      452    11980    1                                       then IX = 24;

  11980 13 000405   000030 235007                    LDA     24,DL
        13 000406   200216 755100                    STA     IX,,AUTO

      453    11981    1       if IX >= 0

  11981 13 000407   200216 235100                    LDA     IX,,AUTO
        13 000410   000414 604000 13                 TMI     s:11984
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:45   

      454    11982    1       then MSG_TYPE = substr( VM_STATUS2.NAME#, IX, 3);

  11982 13 000411   040100 100405                    MLR     fill='040'O
        13 000412   000117 200003 11                 ADSC9   VM_STATUS2,A             cn=1,n=3
        13 000413   200220 000003                    ADSC9   MSG_TYPE,,AUTO           cn=0,n=3

      455    11983
      456    11984    1       VECT_ARRAY(3) = VECTOR(MSG_TYPE);

  11984 13 000414   577640 235007                    LDA     -65632,DL
        13 000415   200230 452500                    STP2    FORMATTED_DATE+3,,AUTO
        13 000416   200230 236100                    LDQ     FORMATTED_DATE+3,,AUTO
        13 000417   000220 036003                    ADLQ    144,DU
        13 000420   000644 757000 11                 STAQ    VECT_ARRAY+6

      457    11985    1       VECT_ARRAY(4) = VECTOR(VM_HEADER.NUM_RECORDS);

  11985 13 000421   777640 235007                    LDA     -96,DL
        13 000422   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000423   000011 036003                    ADLQ    9,DU
        13 000424   000646 757000 11                 STAQ    VECT_ARRAY+8

      458    11986
      459    11987    1       IF VM_HEADER.FROM$ ~= ADDR(NIL)

  11987 13 000425   000023 236100                    LDQ     19,,PR0
        13 000426   000024 116000 14                 CMPQ    20
        13 000427   000574 600000 13                 TZE     s:12011

      460    11988    1       THEN
      461    11989    2       DO;

      462    11990    2           CALL INDEX1R (I, '@', VM_HEADER.FROM$ -> X$STRING.TEXT);

  11990 13 000430   000023 471500                    LDP1    19,,PR0
        13 000431   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:46   
        13 000432   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000433   200230 000002                    ADSC9   FORMATTED_DATE+3,,AUTO   cn=0,n=2
        13 000434   200230 220100                    LDX0    FORMATTED_DATE+3,,AUTO
        13 000435   000000 636010                    EAQ     0,X0
        13 000436   000022 772000                    QRL     18
        13 000437   000000 125540                    SCMR    mask='000'O
        13 000440   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        13 000441   000025 000001 14                 ADSC9   21                       cn=0,n=1
        13 000442   200215 000100                    ARG     I,,AUTO
        13 000443   000446 606400 13                 TTN     s:11991
        13 000444   200215 054100                    AOS     I,,AUTO
        13 000445   200215 156100                    SSQ     I,,AUTO

      463    11991    2           CALL INDEX (I, ' /', SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, 0, I));

  11991 13 000446   000023 471500                    LDP1    19,,PR0
        13 000447   000100 101500                    MRL     fill='000'O
        13 000450   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000451   200230 000002                    ADSC9   FORMATTED_DATE+3,,AUTO   cn=0,n=2
        13 000452   200230 220100                    LDX0    FORMATTED_DATE+3,,AUTO
        13 000453   200215 721100                    LXL1    I,,AUTO
        13 000454   000000 120540                    SCD
        13 000455   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 000456   000140 000002 12                 ADSC9   SPACE+4                  cn=0,n=2
        13 000457   200215 000100                    ARG     I,,AUTO
        13 000460   000462 607000 13                 TTF     s:11992
        13 000461   200215 054100                    AOS     I,,AUTO

      464    11992    3           DO WHILE I > 0;

  11992 13 000462   200215 236100                    LDQ     I,,AUTO
        13 000463   000503 604400 13                 TMOZ    s:11999

      465    11993    3               IF SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, I-1, 1) = ' '

  11993 13 000464   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000465   000023 471500                    LDP1    19,,PR0
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:47   
        13 000466   000100 101500                    MRL     fill='000'O
        13 000467   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000470   200230 000002                    ADSC9   FORMATTED_DATE+3,,AUTO   cn=0,n=2
        13 000471   200230 220100                    LDX0    FORMATTED_DATE+3,,AUTO
        13 000472   200215 235100                    LDA     I,,AUTO
        13 000473   040000 106505                    CMPC    fill='040'O
        13 000474   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
        13 000475   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000476   000503 601000 13                 TNZ     s:11999

      466    11994    3               THEN
      467    11995    3                   I = I - 1;

  11995 13 000477   000001 336007                    LCQ     1,DL
        13 000500   200215 056100                    ASQ     I,,AUTO
        13 000501   000502 710000 13                 TRA     s:11998

      468    11996    3               ELSE
      469    11997    3                   EXIT;
      470    11998    3           END;

  11998 13 000502   000464 605400 13                 TPNZ    s:11993

      471    11999    2           IF I + 2 <= NAME_WIDTH

  11999 13 000503   200215 236100                    LDQ     I,,AUTO
        13 000504   000002 036007                    ADLQ    2,DL
        13 000505   000511 604000 13                 TMI     s:12001
        13 000506   200221 116100                    CMPQ    NAME_WIDTH,,AUTO
        13 000507   000511 600000 13                 TZE     s:12001
        13 000510   000537 603000 13                 TRC     s:12005

      472    12000    3           THEN DO;

      473    12001    3               CALL CONCAT (TEMPBUF, '(', SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, 0,
             12001                        I), ')');

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:48   
  12001 13 000511   000023 471500                    LDP1    19,,PR0
        13 000512   000100 101500                    MRL     fill='000'O
        13 000513   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000514   200230 000002                    ADSC9   FORMATTED_DATE+3,,AUTO   cn=0,n=2
        13 000515   200230 220100                    LDX0    FORMATTED_DATE+3,,AUTO
        13 000516   050000 236003                    LDQ     20480,DU
        13 000517   200115 756100                    STQ     TEMPBUF,,AUTO
        13 000520   200215 721100                    LXL1    I,,AUTO
        13 000521   040100 100540                    MLR     fill='040'O
        13 000522   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 000523   200115 200377                    ADSC9   TEMPBUF,,AUTO            cn=1,n=255
        13 000524   200215 236100                    LDQ     I,,AUTO
        13 000525   000377 116007                    CMPQ    255,DL
        13 000526   000534 605000 13                 TPL     s:12002
        13 000527   777400 622006                    EAX2    -256,QL
        13 000530   777777 662003                    ERX2    -1,DU
        13 000531   040146 100400                    MLR     fill='040'O
        13 000532   000026 000001 14                 ADSC9   22                       cn=0,n=1
        13 000533   200115 200012                    ADSC9   TEMPBUF,Q,AUTO           cn=1,n=*X2

      474    12002    3               LEN = I + 2;

  12002 13 000534   000002 036007                    ADLQ    2,DL
        13 000535   200222 756100                    STQ     LEN,,AUTO

      475    12003    3           END;

  12003 13 000536   000564 710000 13                 TRA     s:12008

      476    12004    3           ELSE DO;

      477    12005    3               CALL CONCAT (TEMPBUF, '(', SUBSTR (VM_HEADER.FROM$ -> X$STRING.TEXT, 0,
             12005                        NAME_WIDTH - 2), '>');

  12005 13 000537   000023 471500                    LDP1    19,,PR0
        13 000540   000100 101500                    MRL     fill='000'O
        13 000541   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:49   
        13 000542   200230 000002                    ADSC9   FORMATTED_DATE+3,,AUTO   cn=0,n=2
        13 000543   200230 220100                    LDX0    FORMATTED_DATE+3,,AUTO
        13 000544   050000 236003                    LDQ     20480,DU
        13 000545   200115 756100                    STQ     TEMPBUF,,AUTO
        13 000546   200221 721100                    LXL1    NAME_WIDTH,,AUTO
        13 000547   777776 622011                    EAX2    -2,X1
        13 000550   040100 100540                    MLR     fill='040'O
        13 000551   100000 200012                    ADSC9   0,,PR1                   cn=1,n=*X2
        13 000552   200115 200377                    ADSC9   TEMPBUF,,AUTO            cn=1,n=255
        13 000553   200221 236100                    LDQ     NAME_WIDTH,,AUTO
        13 000554   000401 116007                    CMPQ    257,DL
        13 000555   000563 603000 13                 TRC     s:12006
        13 000556   777376 623006                    EAX3    -258,QL
        13 000557   777777 663003                    ERX3    -1,DU
        13 000560   040146 100400                    MLR     fill='040'O
        13 000561   000027 000001 14                 ADSC9   23                       cn=0,n=1
        13 000562   200114 600013                    ADSC9   WORK_BUF+12,Q,AUTO       cn=3,n=*X3

      478    12006    3               LEN = NAME_WIDTH;

  12006 13 000563   200222 756100                    STQ     LEN,,AUTO

      479    12007    3           END;

      480    12008    2           VECT_ARRAY(5) = VECTOR(SUBSTR(TEMPBUF,0,LEN));

  12008 13 000564   200222 235100                    LDA     LEN,,AUTO
        13 000565   000020 735000                    ALS     16
        13 000566   000140 135007                    SBLA    96,DL
        13 000567   200230 452500                    STP2    FORMATTED_DATE+3,,AUTO
        13 000570   200230 236100                    LDQ     FORMATTED_DATE+3,,AUTO
        13 000571   000115 036003                    ADLQ    77,DU
        13 000572   000650 757000 11                 STAQ    VECT_ARRAY+10

      481    12009    2       END;

  12009 13 000573   000576 710000 13                 TRA     s:12013
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:50   

      482    12010    1       ELSE
      483    12011    1           VECT_ARRAY(5) = VECTOR(SPACE);

  12011 13 000574   000030 237000 14                 LDAQ    24
        13 000575   000650 757000 11                 STAQ    VECT_ARRAY+10

      484    12012
      485    12013    1       IF VM_HEADER.SUBJECT$ ~= ADDR(NIL)

  12013 13 000576   000030 236100                    LDQ     24,,PR0
        13 000577   000024 116000 14                 CMPQ    20
        13 000600   000635 600000 13                 TZE     s:12020
        13 000601   000030 471500                    LDP1    24,,PR0
        13 000602   000100 101500                    MRL     fill='000'O
        13 000603   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000604   200230 000004                    ADSC9   FORMATTED_DATE+3,,AUTO   cn=0,n=4
        13 000605   200230 236100                    LDQ     FORMATTED_DATE+3,,AUTO
        13 000606   000000 116003                    CMPQ    0,DU
        13 000607   000635 600000 13                 TZE     s:12020

      486    12014    1         AND VM_HEADER.SUBJECT$ -> X$STRING.SIZ > 0
      487    12015    2       THEN DO;

      488    12016    2           CALL X$STRIP_BLANKS(VM_HEADER.SUBJECT$); /*strip blanks */

  12016 13 000610   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000611   000030 036003                    ADLQ    24,DU
        13 000612   200230 756100                    STQ     FORMATTED_DATE+3,,AUTO
        13 000613   200230 630500                    EPPR0   FORMATTED_DATE+3,,AUTO
        13 000614   000021 631400 14                 EPPR1   17
        13 000615   000000 701000 xent               TSX1    X$STRIP_BLANKS
        13 000616   000000 011000                    NOP     0

      489    12017    2           VECT_ARRAY(6) = VECTOR(VM_HEADER.SUBJECT$ -> X$STRING.TEXT);

  12017 13 000617   200003 470500                    LDP0    @VM_HEADER,,AUTO
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:51   
        13 000620   000030 471500                    LDP1    24,,PR0
        13 000621   000100 101500                    MRL     fill='000'O
        13 000622   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000623   200230 000002                    ADSC9   FORMATTED_DATE+3,,AUTO   cn=0,n=2
        13 000624   200230 220100                    LDX0    FORMATTED_DATE+3,,AUTO
        13 000625   000000 635010                    EAA     0,X0
        13 000626   000002 771000                    ARL     2
        13 000627   000140 135007                    SBLA    96,DL
        13 000630   200231 451500                    STP1    FORMATTED_DATE+4,,AUTO
        13 000631   200231 236100                    LDQ     FORMATTED_DATE+4,,AUTO
        13 000632   200000 036007                    ADLQ    65536,DL
        13 000633   000652 757000 11                 STAQ    VECT_ARRAY+12

      490    12018    2       END;

  12018 13 000634   000637 710000 13                 TRA     s:12022

      491    12019    1       ELSE
      492    12020    1           VECT_ARRAY(6) = VECTOR(SPACE);

  12020 13 000635   000030 237000 14                 LDAQ    24
        13 000636   000652 757000 11                 STAQ    VECT_ARRAY+12

      493    12021
      494    12022    1       F_FDS.FMT_ = vector( substr(VM_HEADER_FMT.NAME#,,VM_HEADER_FMT.L#) );

  12022 13 000637   000052 236000 11                 LDQ     VM_HEADER_FMT
        13 000640   000033 772000                    QRL     27
        13 000641   000064 737000                    LLS     52
        13 000642   000140 135007                    SBLA    96,DL
        13 000643   000032 236000 14                 LDQ     26
        13 000644   000000 757000 11                 STAQ    F_FDS

      495    12023    1       F_FDS.NVECS# = 7;

  12023 13 000645   000007 235007                    LDA     7,DL
        13 000646   000011 755000 11                 STA     F_FDS+9
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:52   

      496    12024    1       CALL VMD$WRITE_BUF_TRUNCATED(F_FDS);

  12024 13 000647   000012 630400 14                 EPPR0   10
        13 000650   000021 631400 14                 EPPR1   17
        13 000651   000000 701000 xent               TSX1    VMD$WRITE_BUF_TRUNCATED
        13 000652   000000 011000                    NOP     0

      497    12025    1       RETURN;

  12025 13 000653   000000 702200 xent               TSX2  ! X66_ARET

F_FDS
 Sect OctLoc
  11     000   000000 177640   000000 006014   000000 000000   000000 000000    ................
  11     004   000000 000000   000000 177640   000000 006014   000000 000001    ................
  11     010   000000 000000   000000 000000   000636 006000   000000 101500    ..............A.
  11     014   000000 000000   000000 000000   000000 000001   000000 000012    ................
  11     020   000000 000000   ****** ******   ****** ******   000000 000000    ................
  11     024   000000 000000   000000 000000   000000 000000   000000 006014    ................
  11     030   000000 006014   000000 006014   000000 006014   000000 000000    ................
  11     034   000000 000000   000000 000000                                    ........

CONVERT_TIME
 Sect OctLoc
  11     036   000001 777640   000050 006000   000001 777640   000657 006000    .....(..........
  11     042   000002 577640   000661 006000   000000 177640   000000 006014    ................
  11     046   000000 777640   000656 006000   000003 000000   ****** ******    ................

VM_HEADER_FMT
 Sect OctLoc
  11     052   074040 040040   040040 040040   040040 040040   040040 040040    <
  11     056   040040 040040   040040 040040   040040 040040   040040 040040
  11     066*  040040 040040   040040 040040   040040 040040   040*** ******                 ...

VM_TITLE_FMT
 Sect OctLoc
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:53   
  11     072   074040 040040   040040 040040   040040 040040   040040 040040    <
  11     076   040040 040040   040040 040040   040040 040040   040040 040040
  11     106*  040040 040040   040040 040040   040040 040040   040*** ******                 ...

VM_STATUS1
 Sect OctLoc
  11     112   020040 040040   040040 040040   040040 040040   040040 040040    .
  11     116   040*** ******                                                     ...

VM_STATUS2
 Sect OctLoc
  11     117   033040 040040   040040 040040   040040 040040   040040 040040    .
  11     123   040040 040040   040040 040040   040040 040040

VM_DATE_NUMBER_FMT
 Sect OctLoc
  11     126   120040 040040   040040 040040   040040 040040   040040 040040    P
  11     132   040040 040040   040040 040040   040040 040040   040040 040040
  11     152*  040*** ******                                                     ...

VM_TO_FROM_FMT
 Sect OctLoc
  11     153   073040 040040   040040 040040   040040 040040   040040 040040    ;
  11     157   040040 040040   040040 040040   040040 040040   040040 040040
  11     167*  040040 040040   040040 040040   040040 040040

VM_SUBJECT_FMT
 Sect OctLoc
  11     172   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     176   040040 040040   040040 040040   040040 040040   040040 040040
  11     202   040040 040040   040040 040040

VM_SUBJECT_FMT1
 Sect OctLoc
  11     204   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     210   040040 040040   040040 040040   040040 040040   040040 040040
  11     214   040040 040040   040040 040040
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:54   

VM_REPLY_TO_FMT
 Sect OctLoc
  11     216   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     222   040040 040040   040040 040040   040040 040040   040040 040040
  11     226   040040 040040   040040 040040

VM_REFERENCE_FMT
 Sect OctLoc
  11     230   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     234   040040 040040   040040 040040   040040 040040   040040 040040
  11     240   040040 040040   040040 040040

VM_REFERENCE_FMT1
 Sect OctLoc
  11     242   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     246   040040 040040   040040 040040   040040 040040   040040 040040
  11     252   040040 040040   040040 040040

VM_REFERENCE_AND_ID_FMT
 Sect OctLoc
  11     254   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     260   040040 040040   040040 040040

VM_RE_STRING
 Sect OctLoc
  11     262   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     266   040040 040040   040040 040040

VM_COPY_FMT
 Sect OctLoc
  11     270   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     274   040040 040040   040040 040040

VM_COPY_FMT1
 Sect OctLoc
  11     276   027040 040040   040040 040040   040040 040040   040040 040040    .
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:55   
  11     302   040040 040040   040040 040040

VM_BLIND_COPY_FMT
 Sect OctLoc
  11     304   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     310   040040 040040   040040 040040

VM_BLIND_COPY_FMT1
 Sect OctLoc
  11     312   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     316   040040 040040   040040 040040

VM_CONTINUATION_FMT
 Sect OctLoc
  11     320   023040 040040   040040 040040   040040 040040   040040 040040    .
  11     324   040040 040040

VM_ERROR_ADDRESS_FMT
 Sect OctLoc
  11     325   053040 040040   040040 040040   040040 040040   040040 040040    +
  11     331   040040 040040   040040 040040   040040 040040   040040 040040
  11     335   040040 040040   040040 040040   040040 040040

VM_TO_FMT
 Sect OctLoc
  11     340   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     344   040040 040040   040040 040040

VM_FCOPY_FMT
 Sect OctLoc
  11     346   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     352   040040 040040   040040 040040

VM_SIGNED_FMT
 Sect OctLoc
  11     354   027040 040040   040040 040040   040040 040040   040040 040040    .
  11     360   040040 040040   040040 040040
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:56   

VM_RR_FMT
 Sect OctLoc
  11     362   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     366   040040 040040   040040 040040   040040 040040   040040 040040
  11     372   040040 040040   040040 040040

VM_RTO_FMT
 Sect OctLoc
  11     374   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     400   040040 040040   040040 040040   040040 040040   040040 040040
  11     404   040040 040040   040040 040040

VM_DEFER_FMT
 Sect OctLoc
  11     406   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     412   040040 040040   040040 040040   040040 040040   040040 040040
  11     416   040040 040040   040040 040040

VM_DEFER_FMT1
 Sect OctLoc
  11     420   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     424   040040 040040   040040 040040   040040 040040   040040 040040
  11     430   040040 040040   040040 040040

VM_OPTS_FMT
 Sect OctLoc
  11     432   123040 040040   040040 040040   040040 040040   040040 040040    S
  11     436   040040 040040   040040 040040   040040 040040   040040 040040
  11     456*  040040 040040

VM_OPTS_FMT1
 Sect OctLoc
  11     457   123040 040040   040040 040040   040040 040040   040040 040040    S
  11     463   040040 040040   040040 040040   040040 040040   040040 040040
  11     503*  040040 040040

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:57   
VM_OPTS_FMT2
 Sect OctLoc
  11     504   123040 040040   040040 040040   040040 040040   040040 040040    S
  11     510   040040 040040   040040 040040   040040 040040   040040 040040
  11     530*  040040 040040

VM_DR_FMT
 Sect OctLoc
  11     531   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     535   040040 040040   040040 040040   040040 040040   040040 040040
  11     541   040040 040040   040040 040040

VM_BROADCAST_FMT
 Sect OctLoc
  11     543   047040 040040   040040 040040   040040 040040   040040 040040    '
  11     547   040040 040040   040040 040040   040040 040040   040040 040040
  11     553   040040 040040   040040 040040

VM_ENCL_1_FMT
 Sect OctLoc
  11     555   074040 040040   040040 040040   040040 040040   040040 040040    <
  11     561   040040 040040   040040 040040   040040 040040   040040 040040
  11     571*  040040 040040   040040 040040   040040 040040   040*** ******                 ...

VM_ENCL_2_FMT
 Sect OctLoc
  11     575   074040 040040   040040 040040   040040 040040   040040 040040    <
  11     601   040040 040040   040040 040040   040040 040040   040040 040040
  11     611*  040040 040040   040040 040040   040040 040040   040*** ******                 ...

VM_ENCL_FWD_FMT
 Sect OctLoc
  11     615   074040 040040   040040 040040   040040 040040   040040 040040    <
  11     621   040040 040040   040040 040040   040040 040040   040040 040040
  11     631*  040040 040040   040040 040040   040040 040040   040*** ******                 ...

NEED_TITLE_BAR
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:58   
 Sect OctLoc
  11     635   0***** ******                                                    ....

VECT_ARRAY
 Sect OctLoc
  11     636   ****** ******   ****** ******   ****** ******   ****** ******    ................

DEFAULT_OPEN_CONST
 Sect OctLoc
  12     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
  12     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
  12     044*  000000 000042   000000 003000   252525 000000   000040 252520    ..."......... ..
  12     050   000040 040040   000000 000002   000000 777777   000000 000000    .   ............
  12     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  12     060   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
  12     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
  12     070   000000 000000   ****** ******                                    ........

E_HEADER_FMT
 Sect OctLoc
  12     072   261504 014430                                                    ....

E_TITLE_FMT
 Sect OctLoc
  12     073   261504 014400                                                    ....

E_STATUS1
 Sect OctLoc
  12     074   261504 014410                                                    ....

E_STATUS2
 Sect OctLoc
  12     075   261504 014420                                                    ....

E_DATE_NUMBER_FMT
 Sect OctLoc
  12     076   261504 014440                                                    ....
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:59   

E_TO_FROM_FMT
 Sect OctLoc
  12     077   261504 014450                                                    ....

E_SUBJECT_FMT
 Sect OctLoc
  12     100   261504 014460                                                    ....

E_SUBJECT_FMT1
 Sect OctLoc
  12     101   261504 014461                                                    ....

E_REPLY_TO_FMT
 Sect OctLoc
  12     102   261504 014470                                                    ....

E_REFERENCE_FMT
 Sect OctLoc
  12     103   261504 014500                                                    ....

E_REFERENCE_FMT1
 Sect OctLoc
  12     104   261504 014501                                                    ....

E_REFERENCE_AND_ID_FMT
 Sect OctLoc
  12     105   261504 014510                                                    ....

E_RE_STRING
 Sect OctLoc
  12     106   261504 014370                                                    ....

E_COPY_FMT
 Sect OctLoc
  12     107   261504 014520                                                    ....

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:60   
E_COPY_FMT1
 Sect OctLoc
  12     110   261504 014521                                                    ....

E_BLIND_COPY_FMT
 Sect OctLoc
  12     111   261504 014530                                                    ....

E_BLIND_COPY_FMT1
 Sect OctLoc
  12     112   261504 014531                                                    ....

E_CONTINUATION_FMT
 Sect OctLoc
  12     113   261504 014540                                                    ....

E_ERROR_ADDRESS_FMT
 Sect OctLoc
  12     114   261504 014550                                                    ....

E_TO_FMT
 Sect OctLoc
  12     115   261504 014560                                                    ....

E_FCOPY_FMT
 Sect OctLoc
  12     116   261504 014570                                                    ....

E_SIGNED_FMT
 Sect OctLoc
  12     117   261504 014600                                                    ....

E_RR_FMT
 Sect OctLoc
  12     120   261504 014610                                                    ....

E_RTO_FMT
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:61   
 Sect OctLoc
  12     121   261504 014620                                                    ....

E_DEFER_FMT
 Sect OctLoc
  12     122   261504 014630                                                    ....

E_DEFER_FMT1
 Sect OctLoc
  12     123   261504 014640                                                    ....

E_OPTS_FMT
 Sect OctLoc
  12     124   261504 014650                                                    ....

E_OPTS_FMT1
 Sect OctLoc
  12     125   261504 014660                                                    ....

E_OPTS_FMT2
 Sect OctLoc
  12     126   261504 014670                                                    ....

E_DR_FMT
 Sect OctLoc
  12     127   261504 014700                                                    ....

E_BROADCAST_FMT
 Sect OctLoc
  12     130   261504 014710                                                    ....

E_ENCL_1_FMT
 Sect OctLoc
  12     131   261504 014720                                                    ....

E_ENCL_2_FMT
 Sect OctLoc
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:62   
  12     132   261504 014730                                                    ....

E_ENCL_FWD_FMT
 Sect OctLoc
  12     133   261504 014740                                                    ....

SPACE
 Sect OctLoc
  12     134   040*** ******                                                     ...

(unnamed)
 Sect OctLoc
  12     135   061062 072060   060072 060060   056060 060040   040057 040040    12:00:00.00  /

(unnamed)
 Sect OctLoc
  14     000   000000 006003   000025 777640   040040 040040   000002 000000    ........    ....
  14     004   000072 006000   000052 006000   056040 040040   000003 000000    .:...*...   ....
  14     010   000073 006000   000072 006000   000000 006000   000072 206000    .;...:.......:..
  14     014   000074 006000   000112 006000   000075 006000   000117 006000    .<...J...=...O..
  14     020   000077 777640   000001 000000   000002 577640   040040 040000    .?..........   .
  14     024   000000 006014   100040 040040   051040 040040   076040 040040    ....@   )   >
  14     030   000000 177640   000134 006000   000052 206000                    .....\...*..
      498    12026
      499    12027    1   END VMD$DI_HEADER;
      500    12028        %EOD;

PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:63   
--  Include file information  --

   VM_PERR_C.:VMB6TOU  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMD$DI_HEADER.
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:64   

 **** Variables and constants ****

  ****  Section 011  Data  VMD$DI_HEADER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/d STRC(432)   r     1 CONVERT_TIME             657-0-0/c CHAR(8)     r     1 DATE_STRING
     0-0-0/w STRC(1080)  r     1 F_FDS                    635-0-0/b BIT         r     1 NEED_TITLE_BAR
   661-0-0/c CHAR(11)    r     1 TIME_STRING              656-0-0/w UBIN        r     1 UTS
   636-0-0/d VECT        r     1 VECT_ARRAY(0:7)
   304-0-0/c STRC(216)         1 VM_BLIND_COPY_FMT        312-0-0/c STRC(216)         1 VM_BLIND_COPY_FMT1
   543-0-0/c STRC(360)         1 VM_BROADCAST_FMT         320-0-0/c STRC(180)         1 VM_CONTINUATION_FMT
   270-0-0/c STRC(216)         1 VM_COPY_FMT              276-0-0/c STRC(216)         1 VM_COPY_FMT1
   126-0-0/c STRC(729)         1 VM_DATE_NUMBER_FMT       406-0-0/c STRC(360)         1 VM_DEFER_FMT
   420-0-0/c STRC(360)         1 VM_DEFER_FMT1            531-0-0/c STRC(360)         1 VM_DR_FMT
   555-0-0/c STRC(549)         1 VM_ENCL_1_FMT            575-0-0/c STRC(549)         1 VM_ENCL_2_FMT
   615-0-0/c STRC(549)         1 VM_ENCL_FWD_FMT          325-0-0/c STRC(396)         1 VM_ERROR_ADDRESS_FMT
   346-0-0/c STRC(216)         1 VM_FCOPY_FMT              52-0-0/c STRC(549)   r     1 VM_HEADER_FMT
   432-0-0/c STRC(756)         1 VM_OPTS_FMT              457-0-0/c STRC(756)         1 VM_OPTS_FMT1
   504-0-0/c STRC(756)         1 VM_OPTS_FMT2
   254-0-0/c STRC(216)         1 VM_REFERENCE_AND_ID_FMT
   230-0-0/c STRC(360)         1 VM_REFERENCE_FMT         242-0-0/c STRC(360)         1 VM_REFERENCE_FMT1
   216-0-0/c STRC(360)         1 VM_REPLY_TO_FMT          262-0-0/c STRC(216)         1 VM_RE_STRING
   362-0-0/c STRC(360)         1 VM_RR_FMT                374-0-0/c STRC(360)         1 VM_RTO_FMT
   354-0-0/c STRC(216)         1 VM_SIGNED_FMT            112-0-0/c STRC(153)   r     1 VM_STATUS1
   117-0-0/c STRC(252)   r     1 VM_STATUS2               172-0-0/c STRC(360)         1 VM_SUBJECT_FMT
   204-0-0/c STRC(360)         1 VM_SUBJECT_FMT1           72-0-0/c STRC(549)   r     1 VM_TITLE_FMT
   340-0-0/c STRC(216)         1 VM_TO_FMT                153-0-0/c STRC(540)         1 VM_TO_FROM_FMT

  ****  Section 012 RoData VMD$DI_HEADER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(2088)  r     1 DEFAULT_OPEN_CONST       111-0-0/w STRC              1 E_BLIND_COPY_FMT
   112-0-0/w STRC              1 E_BLIND_COPY_FMT1        130-0-0/w STRC              1 E_BROADCAST_FMT
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:65   
   113-0-0/w STRC              1 E_CONTINUATION_FMT       107-0-0/w STRC              1 E_COPY_FMT
   110-0-0/w STRC              1 E_COPY_FMT1               76-0-0/w STRC              1 E_DATE_NUMBER_FMT
   122-0-0/w STRC              1 E_DEFER_FMT              123-0-0/w STRC              1 E_DEFER_FMT1
   127-0-0/w STRC              1 E_DR_FMT                 131-0-0/w STRC              1 E_ENCL_1_FMT
   132-0-0/w STRC              1 E_ENCL_2_FMT             133-0-0/w STRC              1 E_ENCL_FWD_FMT
   114-0-0/w STRC              1 E_ERROR_ADDRESS_FMT      116-0-0/w STRC              1 E_FCOPY_FMT
    72-0-0/w STRC        r     1 E_HEADER_FMT             124-0-0/w STRC              1 E_OPTS_FMT
   125-0-0/w STRC              1 E_OPTS_FMT1              126-0-0/w STRC              1 E_OPTS_FMT2
   105-0-0/w STRC              1 E_REFERENCE_AND_ID_FMT
   103-0-0/w STRC              1 E_REFERENCE_FMT          104-0-0/w STRC              1 E_REFERENCE_FMT1
   102-0-0/w STRC              1 E_REPLY_TO_FMT           106-0-0/w STRC              1 E_RE_STRING
   120-0-0/w STRC              1 E_RR_FMT                 121-0-0/w STRC              1 E_RTO_FMT
   117-0-0/w STRC              1 E_SIGNED_FMT              74-0-0/w STRC        r     1 E_STATUS1
    75-0-0/w STRC        r     1 E_STATUS2                100-0-0/w STRC              1 E_SUBJECT_FMT
   101-0-0/w STRC              1 E_SUBJECT_FMT1            73-0-0/w STRC        r     1 E_TITLE_FMT
   115-0-0/w STRC              1 E_TO_FMT                  77-0-0/w STRC              1 E_TO_FROM_FMT
   134-0-0/c CHAR        r     1 SPACE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @DCB#                      4-0-0/w PTR         r     1 @MESSAGE_NUMBER
     3-0-0/w PTR         r     1 @VM_HEADER                *0-0-0/w UBIN        r     1 DCB#
     6-0-0/d STRC(2088)  r     1 DEFAULT_OPEN             217-0-0/c CHAR        r     1 FLAG_CHAR
   225-0-0/c CHAR(11)    r     1 FORMATTED_DATE           215-0-0/w SBIN        r     1 I
   216-0-0/w SBIN        r     1 IX                       222-0-0/w SBIN        r     1 LEN
    *0-0-0/w UBIN        r     1 MESSAGE_NUMBER           220-0-0/c CHAR(3)     r     1 MSG_TYPE
   221-0-0/w UBIN        r     1 NAME_WIDTH               115-0-0/c CHAR(256)   r     1 TEMPBUF
   223-0-0/c CHAR(8)     r     1 TODAYS_DATE_STRING        *0-0-0/w STRC(1332)  r     1 VM_HEADER
   100-0-0/c CHAR(50)          1 WORK_BUF

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:66   

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR               1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/w UBIN              1 M$DO_NUM
     0-0-0/w UBIN              1 M$LO_NUM                   0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM
     0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM        0-0-0/w UBIN              1 M$MAIL_FILE_NUM
     0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM          0-0-0/w UBIN              1 M$ME_NUM
     0-0-0/w UBIN              1 M$NODE_NUM                 0-0-0/w UBIN              1 M$SI_NUM
     0-0-0/w UBIN              1 M$WORK_NUM                 0-0-0/w PTR               1 VM_ADDLIST$
     0-0-0/d VECT              1 VM_ADDLIST_                0-0-0/w PTR               1 VM_ADDREC$
     0-0-0/d VECT              1 VM_ADDREC_                 0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
     0-0-0/w PTR               1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)          1 VM_MAIL_ACCT
     0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$MAIL_CENTRAL
     0-0-0N  NULL        r     1 M$MAIL_COMGROUP            0-0-0N  NULL        r     1 M$MAIL_FILE
     0-0-0N  NULL        r     1 M$MAIL_GLOBAL              0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$NODE                     0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$WORK
     0-0-0/c ASTR(9)     r     1 X$STRING
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:67   


   Procedure VMD$DI_HEADER requires 428 words for executable code.
   Procedure VMD$DI_HEADER requires 154 words of local(AUTO) storage.
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:68   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:69   
          MINI XREF LISTING

CONVERT_TIME
      9070**DCL     11941<>CALL    11946<>CALL
CONVERT_TIME.V
      9074**DCL      9070--DCLINIT
CONVERT_TIME.V.SOURCE#
      9074**DCL     11940<<ASSIGN  11944<<ASSIGN
DATE_STRING
     11757**DCL      9070--DCLINIT  9071--DCLINIT 11942>>ASSIGN  11948>>IF      11950>>CALLBLT 11956>>CALLBLT
DCB#
      8662**DCL        13--PROC    11793--IF      11798>>ASSIGN  11799>>ASSIGN  11803--IF      11805--ASSIGN
     11909>>ASSIGN
DEFAULT_OPEN
      9010**DCL     11796<<ASSIGN  11800<>CALL
DEFAULT_OPEN.ACSVEH_
      9012**DCL      9013--REDEF
DEFAULT_OPEN.ALTKEYS_
      9018**DCL      9019--REDEF    9019--REDEF
DEFAULT_OPEN.HDR_
      9017**DCL      9018--REDEF
DEFAULT_OPEN.TAB_
      9016**DCL      9017--REDEF
DEFAULT_OPEN.UHL_
      9010**DCL      9011--REDEF    9011--REDEF
DEFAULT_OPEN.V
      9019**DCL     11797--ASSIGN
DEFAULT_OPEN.V.DCB#
      9019**DCL     11798<<ASSIGN  11799<<ASSIGN
DEFAULT_OPEN.V.FSN#
      9050**DCL      9050--REDEF    9050--REDEF
DEFAULT_OPEN.V_
      9010**DCL     11797<<ASSIGN
DEFAULT_OPEN.WSN_
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:70   
      9016**DCL      9016--REDEF
DEFAULT_OPEN_CONST
      8901**DCL     11796>>ASSIGN
DEFAULT_OPEN_CONST.ACSVEH_
      8903**DCL      8904--REDEF
DEFAULT_OPEN_CONST.ALTKEYS_
      8909**DCL      8910--REDEF    8910--REDEF
DEFAULT_OPEN_CONST.HDR_
      8908**DCL      8909--REDEF
DEFAULT_OPEN_CONST.TAB_
      8907**DCL      8908--REDEF
DEFAULT_OPEN_CONST.UHL_
      8901**DCL      8902--REDEF    8902--REDEF
DEFAULT_OPEN_CONST.V
      8910**DCL      8901--DCLINIT
DEFAULT_OPEN_CONST.V.FSN#
      8941**DCL      8941--REDEF    8941--REDEF
DEFAULT_OPEN_CONST.WSN_
      8907**DCL      8907--REDEF
ERRMSG_FID.L#
      8081**DCL      8081--IMP-SIZ
E_HEADER_FMT
      9202**DCL     11818<>CALL
E_STATUS1
      9305**DCL     11871<>CALL
E_STATUS2
      9360**DCL     11894<>CALL
E_TITLE_FMT
      9253**DCL     11844<>CALL
F$DCB.ACTPOS
      8811**DCL      8811--REDEF
F$DCB.ARS#
      8785**DCL      8785--REDEF
F$DCB.ATTR
      8804**DCL      8805--REDEF
F$DCB.BORROW
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:71   
      8819**DCL      8819--REDEF    8819--REDEF    8819--REDEF
F$DCB.DCBNAME.L
      8833**DCL      8833--IMP-SIZ
F$DCB.EOMCHAR#
      8789**DCL      8789--REDEF
F$DCB.FCD#
      8798**DCL     11793>>IF
F$DCB.FLDID
      8814**DCL      8814--REDEF
F$DCB.FORM$
      8808**DCL      8808--REDEF
F$DCB.FSECT
      8824**DCL      8824--REDEF
F$DCB.FSN#
      8801**DCL      8801--REDEF    8801--REDEF    8802--REDEF
F$DCB.HEADER$
      8807**DCL      8807--REDEF
F$DCB.IXTNSIZE#
      8805**DCL      8805--REDEF
F$DCB.LASTSTA$
      8794**DCL      8794--REDEF
F$DCB.LVL
      8820**DCL      8820--REDEF
F$DCB.NAME#.C
      8795**DCL      8795--REDEF
F$DCB.NOEOF
      8817**DCL      8817--REDEF
F$DCB.NRECS#
      8806**DCL      8806--REDEF
F$DCB.NRECX
      8825**DCL      8825--REDEF
F$DCB.OHDR
      8817**DCL      8817--REDEF
F$DCB.ORG#
      8800**DCL      8800--REDEF
F$DCB.PRECNO
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:72   
      8823**DCL      8823--REDEF
F$DCB.RCSZ
      8829**DCL      8829--REDEF
F$DCB.RES#
      8796**DCL      8796--REDEF
F$DCB.SETX
      8808**DCL      8808--REDEF
F$DCB.TAB$
      8808**DCL      8808--REDEF
F$DCB.TDA
      8822**DCL      8823--REDEF
F$DCB.WIDTH#
      8792**DCL     11803>>IF      11805>>ASSIGN
F$DCB.WSN#
      8796**DCL      8796--REDEF
FLAG_CHAR
     11751**DCL     11925<<ASSIGN  11936<<ASSIGN  11938--ASSIGN
FORMATTED_DATE
     11760**DCL     11950<<CALLBLT 11956<<CALLBLT 11959--ASSIGN
F_FDS
      8678**DCL     11919<>CALL    12024<>CALL
F_FDS.DCB#
      8711**DCL     11909<<ASSIGN
F_FDS.FMT_
      8682**DCL     11844<>CALL    11847<<ASSIGN  12022<<ASSIGN
F_FDS.NVECS#
      8706**DCL     11917<<ASSIGN  12023<<ASSIGN
I
     11749**DCL     11990<<CALLBLT 11991<<CALLBLT 11991>>CALLBLT 11992>>DOWHILE 11993>>IF      11995<<ASSIGN
     11995>>ASSIGN  11999>>IF      12001>>CALLBLT 12002>>ASSIGN
IX
     11750**DCL     11832<<CALLBLT 11833>>CALLBLT 11859<<CALLBLT 11860>>CALLBLT 11926<<ASSIGN  11928<<ASSIGN
     11930<<ASSIGN  11932<<ASSIGN  11934<<ASSIGN  11936>>IF      11936>>ASSIGN  11954<<ASSIGN  11955<<ASSIGN
     11956>>CALLBLT 11961<<ASSIGN  11964<<ASSIGN  11966<<ASSIGN  11968<<ASSIGN  11970<<ASSIGN  11972<<ASSIGN
     11974<<ASSIGN  11976<<ASSIGN  11978<<ASSIGN  11980<<ASSIGN  11981>>IF      11982>>ASSIGN
LEN
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:73   
     11754**DCL     12002<<ASSIGN  12006<<ASSIGN  12008>>ASSIGN
M$OPEN
      6205**DCL-ENT 11800--CALL
M$TIME
      6272**DCL-ENT 11941--CALL    11946--CALL
MESSAGE_NUMBER
      8661**DCL        13--PROC    11923--ASSIGN
MSG_TYPE
     11752**DCL     11962<<ASSIGN  11982<<ASSIGN  11984--ASSIGN
NAME_WIDTH
     11753**DCL     11805<<ASSIGN  11807<<ASSIGN  11833>>CALLBLT 11860>>CALLBLT 11999>>IF      12005>>CALLBLT
     12006>>ASSIGN
NEED_TITLE_BAR
     11744**DCL     11911>>IF      11914<<ASSIGN
SPACE
     11755**DCL     12011--ASSIGN  12020--ASSIGN
TEMPBUF
     11748**DCL     11915--ASSIGN  11916<<ASSIGN  12001<<CALLBLT 12005<<CALLBLT 12008--ASSIGN
TIME_STRING
     11759**DCL      9072--DCLINIT  9073--DCLINIT 11950>>CALLBLT 11955>>IF
TODAYS_DATE_STRING
     11758**DCL     11942<<ASSIGN  11948>>IF
UTS
     11756**DCL      9074--DCLINIT 11945<<ASSIGN
VECT_ARRAY
     11745**DCL      8708--DCLINIT 11915<<ASSIGN  11923<<ASSIGN  11938<<ASSIGN  11959<<ASSIGN  11984<<ASSIGN
     11985<<ASSIGN  12008<<ASSIGN  12011<<ASSIGN  12017<<ASSIGN  12020<<ASSIGN
VMD$ERRMSG
     11766**DCL-ENT 11818--CALL    11844--CALL    11871--CALL    11894--CALL
VMD$WRITE_BUF_TRUNCATED
     11762**DCL-ENT 11919--CALL    12024--CALL
VM_HEADER
      8542**DCL        13--PROC
VM_HEADER.CREATION_DATE
      8545**DCL     11945>>ASSIGN
VM_HEADER.FROM$
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:74   
      8634**DCL     11987>>IF      11990>>CALLBLT 11990>>CALLBLT 11991>>CALLBLT 11991>>CALLBLT 11993>>IF
     11993>>IF      12001>>CALLBLT 12001>>CALLBLT 12005>>CALLBLT 12005>>CALLBLT
VM_HEADER.NUM_RECORDS
      8553**DCL     11985--ASSIGN
VM_HEADER.STATUS.ACK
      8561**DCL     11965>>IF
VM_HEADER.STATUS.ANSWER
      8559**DCL     11971>>IF
VM_HEADER.STATUS.BROADCAST
      8593**DCL     11975>>IF
VM_HEADER.STATUS.DEL
      8577**DCL     11927>>IF
VM_HEADER.STATUS.DELIVERY
      8591**DCL     11967>>IF
VM_HEADER.STATUS.ENCL
      8607**DCL     11979>>IF
VM_HEADER.STATUS.ERR
      8556**DCL     11963>>IF
VM_HEADER.STATUS.EXAM
      8575**DCL     11931>>IF
VM_HEADER.STATUS.FCOPY
      8579**DCL     11969>>IF
VM_HEADER.STATUS.FORWARDED
      8585**DCL     11973>>IF
VM_HEADER.STATUS.MAKE_OLD
      8572**DCL     11929>>IF
VM_HEADER.STATUS.MARK
      8581**DCL     11933>>IF
VM_HEADER.STATUS.OLD
      8569**DCL     11929>>IF
VM_HEADER.STATUS.RRACK
      8603**DCL     11977>>IF
VM_HEADER.SUBJECT$
      8644**DCL     12013>>IF      12013>>IF      12016<>CALL    12017>>ASSIGN  12017>>ASSIGN
VM_HEADER_FMT
      9105**DCL     11818<>CALL
PL6.E3A0      #001=VMD$DI_HEADER File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:08 Page:75   
VM_HEADER_FMT.L#
      9105**DCL     12022>>ASSIGN
VM_HEADER_FMT.NAME#
      9105**DCL     11816>>IF      11832>>CALLBLT 11833<<CALLBLT 12022--ASSIGN
VM_STATUS1
      9159**DCL     11871<>CALL
VM_STATUS1.NAME#
      9159**DCL     11869>>IF      11916>>ASSIGN  11936>>ASSIGN  11956>>CALLBLT
VM_STATUS2
      9186**DCL     11894<>CALL
VM_STATUS2.NAME#
      9186**DCL     11892>>IF      11982>>ASSIGN
VM_TITLE_FMT
      9132**DCL     11844<>CALL
VM_TITLE_FMT.L#
      9132**DCL     11847>>ASSIGN
VM_TITLE_FMT.NAME#
      9132**DCL     11842>>IF      11847--ASSIGN  11859>>CALLBLT 11860<<CALLBLT
X$STRING.SIZ
      7927**DCL      7928--IMP-SIZ 11990>>CALLBLT 11991>>CALLBLT 11993>>IF      12001>>CALLBLT 12005>>CALLBLT
     12013>>IF      12017>>ASSIGN
X$STRING.TEXT
      7928**DCL     11990>>CALLBLT 11991>>CALLBLT 11993>>IF      12001>>CALLBLT 12005>>CALLBLT 12017--ASSIGN
X$STRIP_BLANKS
     11786**DCL-ENT 12016--CALL

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:76   
      501        1        /*T***********************************************************/
      502        2        /*T*                                                         */
      503        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      504        4        /*T*                                                         */
      505        5        /*T***********************************************************/
      506        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      507        7
      508        8        /*P* NAME: VMD$DI_MESSAGE
      509        9             DESCRIPTION: This routine will display a specified message.
      510       10        */
      511       11
      512       12        VMD$DI_MESSAGE: PROC (MESSAGE_NUMBER,OUT_DCB#,MAIL_DCB#,SEED,TRACE,ENTRY_REASON#)
                12            ALTRET;
      513       13
      514       14        /***** Include files *****/
      515       15        %INCLUDE B_ERRORS_C;
      516     1142        %INCLUDE CP_6_SUBS;
      517     1682        %INCLUDE CP_6;
      518     7241        %INCLUDE VM_MACRO_C;
      519     8509        %INCLUDE VM_SUBS_C;
      520     8769        %INCLUDE VM_DATA_R;
      521     9200        %INCLUDE XU_FORMAT_C;
      522     9362        %INCLUDE XUR_ENTRY;
      523     9394        %include B$TABLES_C;
      524     9502          %B$XL_UPPER(NAME=LOWER_UPPER);
      525     9506        /***** Parameters *****/
      526     9507    1   DCL MESSAGE_NUMBER UBIN WORD;
      527     9508    1   DCL OUT_DCB# SBIN WORD;
      528     9509    1   DCL MAIL_DCB# UBIN WORD;
      529     9510    1   DCL SEED BIT(36) ALIGNED;
      530     9511    1   DCL TRACE BIT (1);
      531     9512    1   DCL ENTRY_REASON# SBIN WORD;
      532     9513        /***** Fpts/macros *****/
      533     9514        %FPT_TIME  (FPTN=CONVERT_TIME,
      534     9515                    SOURCE=UTS,
      535     9516                    DEST=LOCAL);
      536     9535
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:77   
      537     9536        %FPT_ERRMSG   (FPTN=FETCH_ERROR_TEXT,
      538     9537                       RESULTS=VLR_ERRMSG);
      539     9564
      540     9565        %VLR_ERRMSG;
      541     9587
      542     9588        %VLP_NAME (FPTN=ERRMSG_FILE_NAME, STCLASS=AUTO);
      543     9615        %VLP_ACCT (FPTN=ERRMSG_FILE_ACCT, STCLASS=AUTO);
      544     9628
      545     9629        %F_FDS (VECTR=VECT_ARRAY);
      546     9742              %F_FDS (NAME=SPACE_LINE,VECTR=VECT_ARRAY,FMT=BLANK_LINE_FMT,NVECS=0);
      547     9855              %FPT_WRITE (FPTN=BODY_WRITE, STCLASS=STATIC);
      548     9886    1   DCL VECT_ARRAY(0:6) VECTOR DALIGNED STATIC;
      549     9887        /***** Based structures *****/
      550     9888        %VM_HEADER;
      551    10017        %VM_PROFILE;
      552    10104        %B$TCB (STCLASS="BASED(B$TCB$)");
      553    10107        %B$ALT;
      554    10115        %F$DCB;
      555    10172        /***** External routines *****/
      556    10173    1   DCL VMD$WRITE_BUF ENTRY(1);
      557    10174    1   DCL VMD$GET_BODY ENTRY (9) ALTRET;
      558    10175    1   DCL VMD$GET_TRACE ENTRY (7) ALTRET;
      559    10176    1   DCL VMD$GET_ID ENTRY (3) ALTRET;
      560    10177    1   DCL VMA$GET_ADD_RECORD ENTRY(4) ALTRET;
      561    10178    1   DCL VMA$GET_NEXT_ENTRY ENTRY(4) ALTRET;
      562    10179        %INIT_STR(DODCL=YES);
      563    10202        /***** Other variables *****/
      564    10203    1   DCL I SBIN WORD;
      565    10204    1   DCL PTR$ PTR;
      566    10205    1   DCL ENCL$ PTR;
      567    10206    1   DCL LEN SBIN WORD;
      568    10207    1   DCL INDX SBIN WORD;
      569    10208    1   DCL INDX1 SBIN WORD;
      570    10209    1   DCL REFERENCE_ID SBIN;
      571    10210    1   DCL DUMMY SBIN WORD;
      572    10211    1   DCL TEMPBUF CHAR(512) STATIC;
      573    10212    1   DCL TEMPBUF1 CHAR(256) STATIC;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:78   
      574    10213    1   DCL TEMPBUF2 CHAR(256) STATIC;
      575    10214    1   DCL 1 CODE,
      576    10215    1         2 FCG BIT (12),
      577    10216    1         2 MID BIT (6),
      578    10217    1         2 MON BIT (1),
      579    10218    1         2 ERR# UBIN (14) UNAL,
      580    10219    1         2 SEV UBIN (3) UNAL;
      581    10220    1   DCL UTS UBIN WORD;
      582    10221    1   DCL 1 TEXTC,
      583    10222    1         2 COUNT UBIN BYTE CALIGNED,
      584    10223    1         2 TEXT CHAR (511);
      585    10224    1   DCL 1 TEXTC2,
      586    10225    1         2 COUNT UBIN BYTE CALIGNED,
      587    10226    1         2 TEXT CHAR (511);
      588    10227    1   DCL 1 BASED_TEXTC BASED,
      589    10228    1         2 COUNT UBIN BYTE CALIGNED,
      590    10229    1         2 TEXT CHAR (BASED_TEXTC.COUNT);
      591    10230    1   DCL 1 TIMEBUF,
      592    10231    1         2 DATE CHAR (8),
      593    10232    1         2 TIME CHAR (11),
      594    10233    1         2 DAY CHAR (3);
      595    10234    1   DCL 1 TIME_TEXTC,
      596    10235    1         2 COUNT UBIN BYTE CALIGNED,
      597    10236    1         2 TEXT CHAR (11);
      598    10237    1   DCL ERRMSG_BUF (0:9) CHAR (120);
      599    10238        %VM_BODYTYPES;
      600    10244        %VM_BODYREC (STCLASS=STATIC,VARYLEN=NO);
      601    10276        %VM_ADD_HEAD;
      602    10305        %VM_ADDTYPES;
      603    10309        %VM_KEYTYPES;
      604    10330        %VM_RADDRESS (NAME=VM$RADDRESS,STCLASS=BASED);
      605    10365        %VM_UADDRESS (NAME=VM$UADDRESS,STCLASS=BASED);
      606    10402        %VM_ENCLOS (STCLASS="BASED(ENCL$)");
      607    10433        %VM_ADD_HEAD (NAME=VM_ENCL_HEAD,STCLASS="BASED(VM_ENCLLIST$)");
      608    10462    1   DCL COUNT SBIN WORD;
      609    10463    1   DCL SITENAME CHAR(8);
      610    10464    1   DCL SPACE CHAR(1) CONSTANT INIT(' ');
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:79   
      611    10465    1   DCL ONE UBIN WORD CONSTANT INIT (1);
      612    10466    1   DCL ZERO UBIN WORD CONSTANT INIT (0);
      613    10467    1   DCL DEL_FLAG CHAR(1) CONSTANT INIT('d');
      614    10468    1   DCL FWD_FLAG CHAR(1) CONSTANT INIT('f');
      615    10469    1   DCL ENCL_NUM SBIN WORD STATIC;
      616    10470    1   DCL PAGESIZE SBIN WORD STATIC INIT(4096);
      617    10471        /***** Constants *****/
      618    10472    1   DCL DELIMITER_TABLE(0:511) UBIN BYTE UNAL CONSTANT INIT
      619    10473    1     (0*32,1,0*12,1*2,0*465);
      620    10474        /***** Formats *****/
      621    10475        %VLP_NAMEV( FPTN=VM_DATE_NUMBER_FMT,       STCLASS=SYMREF );
      622    10482        %VLP_NAMEV( FPTN=VM_TO_FROM_FMT,           STCLASS=SYMREF );
      623    10489        %VLP_NAMEV( FPTN=VM_SUBJECT_FMT,           STCLASS=SYMREF );
      624    10496        %VLP_NAMEV( FPTN=VM_REPLY_TO_FMT,          STCLASS=SYMREF );
      625    10503        %VLP_NAMEV( FPTN=VM_REFERENCE_FMT,         STCLASS=SYMREF );
      626    10510        %VLP_NAMEV( FPTN=VM_REFERENCE_AND_ID_FMT,  STCLASS=SYMREF );
      627    10517        %VLP_NAMEV( FPTN=VM_COPY_FMT,              STCLASS=SYMREF );
      628    10524        %VLP_NAMEV( FPTN=VM_BLIND_COPY_FMT,        STCLASS=SYMREF );
      629    10531        %VLP_NAMEV( FPTN=VM_CONTINUATION_FMT,      STCLASS=SYMREF );
      630    10538        %VLP_NAMEV( FPTN=VM_ERROR_ADDRESS_FMT,     STCLASS=SYMREF );
      631    10545        %VLP_NAMEV( FPTN=VM_RE_STRING,             STCLASS=SYMREF );
      632    10552        %VLP_NAMEV (FPTN=VM_ENCL_1_FMT, STCLASS=SYMREF);
      633    10559        %VLP_NAMEV (FPTN=VM_ENCL_2_FMT, STCLASS=SYMREF);
      634    10566        %VLP_NAMEV (FPTN=VM_ENCL_FWD_FMT, STCLASS=SYMREF);
      635    10573
      636    10574        %VLP_ERRCODE( FPTN=E_DATE_NUMBER_FMT,      STCLASS="SYMREF READONLY");
      637    10619              %VLP_ERRCODE( FPTN=E_TO_FROM_FMT,    STCLASS="SYMREF READONLY");
      638    10664              %VLP_ERRCODE( FPTN=E_SUBJECT_FMT,    STCLASS="SYMREF READONLY");
      639    10709              %VLP_ERRCODE( FPTN=E_REPLY_TO_FMT,   STCLASS="SYMREF READONLY");
      640    10754              %VLP_ERRCODE( FPTN=E_REFERENCE_FMT,  STCLASS="SYMREF READONLY");
      641    10799              %VLP_ERRCODE( FPTN=E_REFERENCE_AND_ID_FMT, STCLASS="SYMREF READONLY");
      642    10844              %VLP_ERRCODE( FPTN=E_COPY_FMT,       STCLASS="SYMREF READONLY");
      643    10889              %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT, STCLASS="SYMREF READONLY");
      644    10934              %VLP_ERRCODE( FPTN=E_CONTINUATION_FMT, STCLASS="SYMREF READONLY");
      645    10979              %VLP_ERRCODE( FPTN=E_ERROR_ADDRESS_FMT, STCLASS="SYMREF READONLY");
      646    11024              %VLP_ERRCODE( FPTN=E_RE_STRING,      STCLASS="SYMREF READONLY");
      647    11069              %VLP_ERRCODE (FPTN=E_ENCL_1_FMT, STCLASS="SYMREF READONLY");
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:80   
      648    11114              %VLP_ERRCODE (FPTN=E_ENCL_2_FMT, STCLASS="SYMREF READONLY");
      649    11159              %VLP_ERRCODE (FPTN=E_ENCL_FWD_FMT, STCLASS="SYMREF READONLY");
      650    11204
      651    11205    1   DCL BODY_FMT CHAR(0) CONSTANT INIT
      652    11206    1        ('%A');
      653    11207        /**/
      654    11208    1   DCL SIGNED_FMT CHAR(0) CONSTANT INIT
      655    11209    1        ('%40X%<>A');
      656    11210        /**/
      657    11211    1   DCL BLANK_LINE_FMT CHAR(0) CONSTANT INIT
      658    11212    1        ('%1X');
      659    11213
      660    11214    1   dcl  BSD      sbin based;
      661    11215
      662    11216    1   dcl 1  SPACEC   constant,
      663    11217    1         2 L#   ubin(9) caligned init(1),
      664    11218    1         2 NAME# char(1)         init(' ');
      665    11219
      666    11220        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:81   
      667    11221    1       SPACE_LINE.DCB# = OUT_DCB#;
      668    11222    1       F_FDS.DCB# = OUT_DCB#;
      669    11223    1       CALL VMD$WRITE_BUF (SPACE_LINE);
      670    11224        /*
      671    11225             ***** Date: ... Number: ...
      672    11226        */
      673    11227    1       VECT_ARRAY(0) = VECTOR(VM_HEADER.CREATION_DATE);
      674    11228    1       VECT_ARRAY(1) = VECTOR(VM_HEADER.DELIVERY_DATE);
      675    11229    1       VECT_ARRAY(2) = VECTOR(MESSAGE_NUMBER);
      676    11230    1       F_FDS.NVECS#=3;
      677    11231            %INIT_STR(STR=VM_DATE_NUMBER_FMT, CODE=E_DATE_NUMBER_FMT, TEST=YES, VECT=
             11231                "F_FDS.FMT_");
      678    11254    1       CALL VMD$WRITE_BUF(F_FDS);
      679    11255        /*
      680    11256             ***** To: ... FROM: ...
      681    11257        */
      682    11258    1       TEMPBUF = ' ';
      683    11259        /*
      684    11260             ***** Handle long TO: field ...
      685    11261        */
      686    11262    2       IF VM_PROFILE.OPT.EXT_ADDR_DISP = %NO# THEN DO;
      687    11263    2           IF VM_HEADER.TO$ ~= ADDR(NIL)
      688    11264    2           THEN
      689    11265    3           DO;
      690    11266                    %INIT_STR(STR=VM_TO_FROM_FMT, CODE=E_TO_FROM_FMT, TEST=YES, VECT=
             11266                        "F_FDS.FMT_");
      691    11289    3               IF VM_HEADER.FROM$ ~= ADDR(NIL)
      692    11290    3               THEN
      693    11291    4               DO;           /* Append to end */
      694    11292    4                   TEMPBUF1 = VM_HEADER.FROM$ -> X$STRING.TEXT;
             11292                            /* Remove the sitename */
      695    11293    4                   CALL INDEX1R(INDX1,'@',SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,0,
             11293                            VM_HEADER.FROM$ -> X$STRING.SIZ))
      696    11294    5                   WHENRETURN DO;
      697    11295    5                       LEN = VM_HEADER.FROM$ -> X$STRING.SIZ - INDX1 - 1;
      698    11296    5                       CALL XLATE (SITENAME, LOWER_UPPER, SUBSTR(TEMPBUF1,INDX1+1,LEN))
             11296                                ;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:82   
      699    11297    5                       IF SITENAME ~= VM_SITENAME
      700    11298    5                       THEN
      701    11299    5                           INDX1 = VM_HEADER.FROM$ -> X$STRING.SIZ;
      702    11300    5                   END;
      703    11301    4                   VECT_ARRAY(1) = VECTOR(ONE);
      704    11302    4                   VECT_ARRAY(2) = VECTOR(SUBSTR(TEMPBUF1,0,INDX1));
      705    11303    4                   F_FDS.NVECS# = 3;
      706    11304    4               END;
      707    11305    3               ELSE
      708    11306    4               DO;           /* Don't print 'FROM:' */
      709    11307    4                   VECT_ARRAY(1) = VECTOR(ZERO);
      710    11308    4                   F_FDS.NVECS# = 2;
      711    11309    4               END;
      712    11310    3               call WRITE_CONTINUATION( VM_HEADER.TO$->BSD, 35, '1'b );
      713    11311    3           END;
      714    11312    2       END;
      715    11313    2       ELSE DO;
      716    11314    2           CALL DISPLAY_ADDREC(%VM_TYPE_TO, MESSAGE_NUMBER);
      717    11315    2       END;
      718    11316
      719    11317        /*
      720    11318             ***** Reply to: ...
      721    11319             ***** Display reply to only if reply to different than sender.
      722    11320        */
      723    11321    1   REPLY_TO:
      724    11322    1       IF VM_HEADER.REPLY_TO$ ~= ADDR(NIL)
      725    11323    1       THEN
      726    11324    2       DO;
      727    11325    2           CALL INDEX (INDX,',',VM_HEADER.REPLY_TO$ -> X$STRING.TEXT)
      728    11326    3           WHENRETURN DO;
      729    11327    3               GOTO PRINT_REPLYTO; /* Print if multiple addresses */
      730    11328    3           END;
      731    11329    2           CALL XLATE (TEMPBUF1,LOWER_UPPER,SUBSTR(VM_HEADER.REPLY_TO$ -> X$STRING.TEXT
             11329                    ,0,VM_HEADER.REPLY_TO$ -> X$STRING.SIZ));
      732    11330        /*
      733    11331            *****      Remove blanks preceding the @ so valid comparison made.
      734    11332        */
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:83   
      735    11333    2           CALL INDEX1R (INDX,'@',VM_HEADER.REPLY_TO$ -> X$STRING.TEXT)
      736    11334    3           WHENRETURN DO;
      737    11335    3               LEN = VM_HEADER.REPLY_TO$ -> X$STRING.SIZ - INDX;
      738    11336    3               TEMPBUF = SUBSTR(TEMPBUF1,INDX,LEN);
      739    11337    4               DO WHILE (SUBSTR(VM_HEADER.REPLY_TO$ -> X$STRING.TEXT, INDX-1,1) = ' ');
      740    11338    4                   CALL INSERT (TEMPBUF1,INDX-1,,SUBSTR(TEMPBUF,0,LEN));
      741    11339    4                   INDX = INDX -1;
      742    11340    4               END;
      743    11341    3               CALL XLATE (TEMPBUF,LOWER_UPPER,SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,
             11341                        0, VM_HEADER.FROM$ -> X$STRING.SIZ));
      744    11342
      745    11343    3               CALL INDEX1R (INDX,'@',VM_HEADER.FROM$ -> X$STRING.TEXT)
      746    11344    4               WHENRETURN DO;
      747    11345    4                   LEN = VM_HEADER.FROM$ -> X$STRING.SIZ - INDX;
      748    11346    4                   TEMPBUF2 = SUBSTR(TEMPBUF,INDX,LEN);
      749    11347    5                   DO WHILE (SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT, INDX-1,1) = ' ');
      750    11348    5                       CALL INSERT (TEMPBUF,INDX-1,,SUBSTR(TEMPBUF2,0,LEN));
      751    11349    5                       INDX = INDX -1;
      752    11350    5                   END;
      753    11351    4               END;
      754    11352    3           END;
      755    11353    3           WHENALTRETURN DO;     /* Remove site name from address */
      756    11354    3               CALL INDEX1R (INDX,'@',SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,0,
             11354                        VM_HEADER.FROM$ -> X$STRING.SIZ));
      757    11355    3               CALL XLATE (TEMPBUF,LOWER_UPPER,SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,
             11355                        0,INDX));
      758    11356    3           END;
      759    11357    2           IF TEMPBUF = TEMPBUF1
      760    11358    2           THEN                  /* Dont bother */
      761    11359    2               GOTO PRINT_SUBJECT;
      762    11360        /**/
      763    11361    2   PRINT_REPLYTO:
      764    11362    2           F_FDS.NVECS# = 1;
      765    11363                %INIT_STR(STR=VM_REPLY_TO_FMT, CODE=E_REPLY_TO_FMT, TEST=YES, VECT=
             11363                    "F_FDS.FMT_");
      766    11386    2           call WRITE_CONTINUATION( VM_HEADER.REPLY_TO$->BSD, 70, '1'b );
      767    11387    2       END;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:84   
      768    11388
      769    11389        /*
      770    11390             ***** Subject: ...
      771    11391        */
      772    11392    1   PRINT_SUBJECT:
      773    11393    1       if VM_HEADER.SUBJECT$ ~= addr(nil) then
      774    11394    2       do;
      775    11395    2           F_FDS.NVECS# = 1;
      776    11396                %INIT_STR(STR=VM_SUBJECT_FMT, CODE=E_SUBJECT_FMT, TEST=YES, VECT=
             11396                    "F_FDS.FMT_");
      777    11419    2           call WRITE_CONTINUATION( VM_HEADER.SUBJECT$->BSD, 70 );
      778    11420    2       end;
      779    11421        /*
      780    11422             ***** Re: ...
      781    11423        */
      782    11424    1       REFERENCE_ID = -1;
      783    11425    1       IF VM_HEADER.REFERS_TO_ID$ ~= ADDR(NIL)
      784    11426    1       THEN
      785    11427    1           CALL VMD$GET_ID (VM_HEADER.REFERS_TO_ID$ -> BASED_TEXTC, MAIL_DCB#,
             11427                    REFERENCE_ID);
      786    11428    1       IF VM_HEADER.REFERENCE$ ~= ADDR(NIL) OR REFERENCE_ID ~= -1
      787    11429    2       THEN DO;
      788    11430    2           IF REFERENCE_ID = -1
      789    11431    3           THEN DO;
      790    11432    3               F_FDS.NVECS# = 1;
      791    11433                    %INIT_STR(STR=VM_REFERENCE_FMT, CODE=E_REFERENCE_FMT, TEST=YES, VECT=
             11433                        "F_FDS.FMT_");
      792    11456    3               INDX1 = 0;
      793    11457    3           END;
      794    11458    3           ELSE DO;
      795    11459    3               F_FDS.NVECS# = 3;
      796    11460                    %INIT_STR(STR=VM_REFERENCE_AND_ID_FMT, CODE=E_REFERENCE_AND_ID_FMT, TEST
             11460                        =YES, VECT="F_FDS.FMT_");
      797    11483                    %INIT_STR(STR=VM_RE_STRING, CODE=E_RE_STRING, TEST=YES);
      798    11506    3               DUMMY = MINIMUM(REFERENCE_ID,9999);
      799    11507    3               INDX1 = 0;
      800    11508    4               DO WHILE DUMMY >= 10;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:85   
      801    11509    4                   INDX1 = INDX1 + 1;
      802    11510    4                   DUMMY = DUMMY / 10;
      803    11511    4               END;
      804    11512    3               VECT_ARRAY(0) = vector (substr(VM_RE_STRING.NAME#, INDX1, VM_RE_STRING.
             11512                        L# - INDX1));
      805    11513    3               VECT_ARRAY(1) = VECTOR (REFERENCE_ID);
      806    11514    3               INDX1 = 2;
      807    11515    3           END;
      808    11516    2           if VM_HEADER.REFERENCE$ = addr(nil)
      809    11517    2           then call WRITE_CONTINUATION( SPACEC, 70,, INDX1 );
      810    11518    2           else call WRITE_CONTINUATION( VM_HEADER.REFERENCE$->BSD, 70,, INDX1 );
      811    11519    2       END;
      812    11520
      813    11521        /*
      814    11522             ***** C: ...
      815    11523        */
      816    11524    1       IF VM_HEADER.COPY$ ~= ADDR(NIL)
      817    11525    1       THEN
      818    11526    2       DO;
      819    11527    3           IF VM_PROFILE.OPT.EXT_ADDR_DISP = %NO# THEN DO;
      820    11528                    %INIT_STR(STR=VM_COPY_FMT, CODE=E_COPY_FMT, TEST=YES, VECT="F_FDS.FMT_")
             11528                        ;
      821    11551    3               F_FDS.NVECS# = 1;
      822    11552    3               call WRITE_CONTINUATION( VM_HEADER.COPY$->BSD, 70, '1'b );
      823    11553    3           END;
      824    11554    2           ELSE
      825    11555    2               CALL DISPLAY_ADDREC(%VM_TYPE_C,MESSAGE_NUMBER);
      826    11556    2       END;
      827    11557    1   NO_C : ;
      828    11558        /*
      829    11559             ***** Bc: ...
      830    11560        */
      831    11561    1       IF VM_HEADER.BLIND$ ~= ADDR(NIL)
      832    11562    1       THEN
      833    11563    2       DO;
      834    11564    3           IF VM_PROFILE.OPT.EXT_ADDR_DISP = %NO# THEN DO;
      835    11565                    %INIT_STR(STR=VM_BLIND_COPY_FMT, CODE=E_BLIND_COPY_FMT, TEST=YES, VECT=
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:86   
             11565                        "F_FDS.FMT_");
      836    11588    3               F_FDS.NVECS# = 1;
      837    11589    3               call WRITE_CONTINUATION( VM_HEADER.BLIND$->BSD, 70, '1'b );
      838    11590    3           END;
      839    11591    2           ELSE
      840    11592    2               CALL DISPLAY_ADDREC(%VM_TYPE_BC,MESSAGE_NUMBER);
      841    11593
      842    11594    2       END;
      843    11595    1   NO_BC:;
      844    11596
      845    11597                                                /* Blank line */
      846    11598        /*
      847    11599             ***** Encl:
      848    11600        */
      849    11601    1       IF VM_HEADER.STATUS.ENCL = %YES# THEN
      850    11602    2   DI_ENCL:DO;
      851    11603    2           CALL VMA$GET_ADD_RECORD(%VM_TYPE_ENCL,VM_ENCLLIST_,MAIL_DCB#,MESSAGE_NUMBER)
      852    11604    3           WHENALTRETURN DO;
      853    11605    4               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$LD THEN DO;
      854    11606    4                   VBOUND(VM_ENCLLIST_) = VBOUND(VM_ENCLLIST_) + PAGESIZE;
      855    11607    4                   GOTO DI_ENCL;
      856    11608    4               END;
      857    11609    3               ELSE GOTO OLD_ENCL;
      858    11610    3           END;
      859    11611
      860    11612    2           IF ADDR(ENTRY_REASON#) ~= ADDR(NIL) AND
      861    11613    3             ENTRY_REASON# = %MAIL_FORWARD_ENCL THEN DO;
      862    11614                    %INIT_STR(STR=VM_ENCL_FWD_FMT, CODE=E_ENCL_FWD_FMT, TEST=YES,VECT=
             11614                        "F_FDS.FMT_");
      863    11637    3               F_FDS.NVECS# = 0;
      864    11638    3               CALL VMD$WRITE_BUF(F_FDS);
      865    11639    3               EXIT DI_ENCL;
      866    11640    3           END; /* IF ENTRY_REASON */
      867    11641
      868    11642                %INIT_STR(STR=VM_ENCL_1_FMT, CODE=E_ENCL_1_FMT, TEST=YES,VECT="F_FDS.FMT_");
      869    11665    2           F_FDS.NVECS# = 0;
      870    11666    2           CALL VMD$WRITE_BUF (F_FDS);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:87   
      871    11667                %INIT_STR(STR=VM_ENCL_2_FMT, CODE=E_ENCL_2_FMT, TEST=YES,VECT="F_FDS.FMT_");
      872    11690    2           ENCL$ = VM_ENCL_HEAD.HEAD$;
      873    11691
      874    11692    3           DO I = 0 TO VM_ENCL_HEAD.NUM_ENTRIES - 1;
      875    11693
      876    11694    3               ENCL_NUM = VM_ENCLOS.TYPE - %VM_TYPE_ENCL;
      877    11695    3               VECT_ARRAY(0) = VECTOR(ENCL_NUM);
      878    11696
      879    11697    3               IF VM_ENCLOS.FLAGS.FORWARD = %YES# THEN
      880    11698    3                   VECT_ARRAY(1) = VECTOR(FWD_FLAG);
      881    11699    3               ELSE
      882    11700    3                   VECT_ARRAY(1) = VECTOR(SPACE);
      883    11701
      884    11702    3               IF VM_ENCLOS.FLAGS.DELETED = %YES# THEN
      885    11703    3                   VECT_ARRAY(2) = VECTOR(DEL_FLAG);
      886    11704    3               ELSE
      887    11705    3                   VECT_ARRAY(2) = VECTOR(SPACE);
      888    11706
      889    11707    3               VECT_ARRAY(3) = VECTOR(VM_ENCLOS.NRECS);
      890    11708
      891    11709    4               IF VM_ENCLOS.TITLE$ = ADDR(NIL) THEN DO;
      892    11710    4                   TEXTC.COUNT = 1;
      893    11711    4                   TEXTC.TEXT = ' ';
      894    11712    4                   PTR$ = ADDR(TEXTC);
      895    11713    4                   VECT_ARRAY(4) = VECTOR(PTR$->BASED_TEXTC);
      896    11714    4               END;
      897    11715    3               ELSE
      898    11716    3                   VECT_ARRAY(4) = VECTOR(VM_ENCLOS.TITLE$->BASED_TEXTC);
      899    11717
      900    11718    3               F_FDS.NVECS# = 5;
      901    11719
      902    11720    3               CALL VMD$WRITE_BUF (F_FDS);
      903    11721
      904    11722    3               ENCL$ = VM_ENCLOS.NEXT$;
      905    11723
      906    11724    3           END;
      907    11725
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:88   
      908    11726    2       END;
      909    11727        /*
      910    11728             ***** Trace:
      911    11729        */
      912    11730
      913    11731    1   OLD_ENCL:
      914    11732    1       BODY_WRITE.V.DCB# = OUT_DCB#;
      915    11733    1       F_FDS.FMT_ = VECTOR(BODY_FMT);
      916    11734    1       F_FDS.NVECS# = 1;
      917    11735    1       IF VM_PROFILE.OPT.DISPTRACE OR (ADDR(TRACE)~=ADDR(NIL) AND TRACE)
      918    11736    1       THEN
      919    11737    2       DO INDX = 0 TO VM_HEADER.NUM_TRACE_RECORDS - 1;
      920    11738    2           VM_BODYREC.VALUE.COUNT = LENGTHC(VM_BODYREC.VALUE.DATA);
      921    11739    2           CALL VMD$GET_TRACE (MESSAGE_NUMBER,MAIL_DCB#,INDX,COUNT,SEED,
      922    11740    2             VM_BODYREC,BODY_WRITE.V.DVBYTE) ALTRET(E_TRACE);
      923    11741    2           CALL CRYPT_CHECK
      924    11742    3           WHENALTRETURN DO;
      925    11743    3               CALL VMD$GET_TRACE (MESSAGE_NUMBER,MAIL_DCB#,INDX,COUNT,,
      926    11744    3                 VM_BODYREC,BODY_WRITE.V.DVBYTE) ALTRET(E_TRACE);
      927    11745    3               CALL CRYPT_CHECK ALTRET(E_CRYPT);
      928    11746    3           END;
      929    11747    2           CALL DISPLAY_BODY_RECORD;
      930    11748    2       END;
      931    11749    1   E_TRACE:
      932    11750
      933    11751    1       CALL VMD$WRITE_BUF (SPACE_LINE);
      934    11752
      935    11753        /*
      936    11754             ***** If errors then report them ...
      937    11755        */
      938    11756    1       IF VM_HEADER.STATUS.ERR AND VM_HEADER.ERROR ~= '0'B
      939    11757    1       THEN
      940    11758    2       DO;
      941    11759    2           CODE = VM_HEADER.ERROR;
      942    11760    2           UTS = 0;
      943    11761    2           IF VM_HEADER.BAD_ADDRESS$ = ADDR(NIL)
      944    11762    2           THEN
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:89   
      945    11763    2               TEXTC.COUNT = 0;
      946    11764    3           ELSE DO;
      947    11765    3               TEXTC.COUNT = VM_HEADER.BAD_ADDRESS$ -> X$STRING.SIZ;
      948    11766    3               TEXTC.TEXT = VM_HEADER.BAD_ADDRESS$ -> X$STRING.TEXT;
      949    11767    3           END;
      950    11768    2           TEXTC2.COUNT = 0;
      951    11769    2           CALL DISPLAY_ENCODED_ERROR;
      952    11770    2           IF VM_HEADER.NUM_RECORDS > 0
      953    11771    3           THEN DO;
      954    11772    3               F_FDS.NVECS# = 0;
      955    11773    3               F_FDS.FMT_ = VECTOR (SPACE);
      956    11774    3               CALL VMD$WRITE_BUF (F_FDS);
      957    11775    3           END;
      958    11776    2       END;                       /* Error address */
      959    11777        /*
      960    11778             ***** Body: ...
      961    11779        */
      962    11780
      963    11781    1       BODY_WRITE.V.DCB# = OUT_DCB#;
      964    11782    2       DO INDX = 0 TO VM_HEADER.NUM_RECORDS - 1;
      965    11783    2           VM_BODYREC.VALUE.COUNT = LENGTHC(VM_BODYREC.VALUE.DATA);
      966    11784    2           CALL VMD$GET_BODY (MESSAGE_NUMBER,MAIL_DCB#,INDX,COUNT,SEED,VM_BODYREC,
      967    11785    2             BODY_WRITE.V.DVBYTE) ALTRET(E_BODY);
      968    11786    2           CALL CRYPT_CHECK ALTRET(E_CRYPT);
      969    11787    2           CALL DISPLAY_BODY_RECORD;
      970    11788    2       END;
      971    11789    1   E_BODY:
      972    11790    1       CALL VMD$WRITE_BUF (SPACE_LINE);
      973    11791
      974    11792    1       RETURN;
      975    11793
      976    11794    1   E_CRYPT:
      977    11795    1       ALTRETURN;
      978    11796        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:90   
      979    11797        /*I* NAME: CRYPT_CHECK
      980    11798             PURPOSE: To check for proper decryption.
      981    11799             DESCRIPTION:
      982    11800                This routine does some simple checks to ensure the decryption
      983    11801                seed specified is not obviously wrong, and altreturn if it is.
      984    11802                It verifies that the record type is legal, and that the count
      985    11803                in the record agrees with the ARS.  This isn't foolproof, but
      986    11804                the intent is only to avoid spewing out an obviously garbled
      987    11805                message; even if a few could slip through, it's still better
      988    11806                than nothing.
      989    11807
      990    11808                This checking is complicated by a couple of bugs in pre-B03
      991    11809                MAIL.  It doesn't use the CRYPT flag in the header to tell if
      992    11810                a message is encrypted, because this flag wasn't being set.
      993    11811                Also, the count was sometimes the just the length of the data,
      994    11812                and sometimes the length of the entire record, so it has to be
      995    11813                checked both ways.
      996    11814        */
      997    11815    1   CRYPT_CHECK: PROC ALTRET;
      998    11816
      999    11817    2       IF ADDR(SEED) = ADDR(NIL)
     1000    11818    2       THEN
     1001    11819    2           RETURN;
     1002    11820    3       DO CASE (VM_BODYREC.TYPE);
     1003    11821    3       CASE (%VM_BODY_TEXT, %VM_BODY_GRAPHICS, %VM_BODY_ENCODED_ERR);
     1004    11822    3       CASE(ELSE);
     1005    11823    3           ALTRETURN;
     1006    11824    3       END;
     1007    11825    2       IF COUNT = VM_BODYREC.VALUE.COUNT
     1008    11826    2         OR COUNT = VM_BODYREC.VALUE.COUNT +
     1009    11827    2         (LENGTHC(VM_BODYREC) - LENGTHC(VM_BODYREC.VALUE.DATA)) /* pre B03 */
     1010    11828    2         OR VM_HEADER.STATUS.PRE_B00
     1011    11829    2       THEN
     1012    11830    2           RETURN;
     1013    11831    2       ELSE
     1014    11832    2           ALTRETURN;
     1015    11833
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:91   
     1016    11834    2   END CRYPT_CHECK;
     1017    11835        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:92   
     1018    11836    1   DISPLAY_ENCODED_ERROR: PROC;
     1019    11837
     1020    11838    2   DCL HIT BIT (1);
     1021    11839    2   DCL INDX SBIN;
     1022    11840    2   DCL INDX1 SBIN;
     1023    11841    2   DCL INDX2 SBIN;
     1024    11842    2   DCL INDX3 SBIN;
     1025    11843
     1026    11844    2       FETCH_ERROR_TEXT.BUF_ = VECTOR (ERRMSG_BUF);
     1027    11845    2       FETCH_ERROR_TEXT.CODE_ = VECTOR (CODE);
     1028    11846    2       FETCH_ERROR_TEXT.V.INCLCODE# = CODE.MON;
     1029    11847
     1030    11848    2       CALL INDEX1 (INDX, '.', ERRMSG_FID.NAME#);
     1031    11849    2       ERRMSG_FILE_NAME.L# = INDX;
     1032    11850    2       ERRMSG_FILE_NAME.NAME# = SUBSTR (ERRMSG_FID.NAME#, 0, INDX);
     1033    11851    2       IF INDX >= ERRMSG_FID.L# - 1
     1034    11852    2       THEN
     1035    11853    2           ERRMSG_FILE_ACCT.ACCT# = ':SYS';
     1036    11854    2       ELSE
     1037    11855    2           ERRMSG_FILE_ACCT.ACCT# = SUBSTR (ERRMSG_FID.NAME#, INDX+1);
     1038    11856
     1039    11857    2       FETCH_ERROR_TEXT.FILENAME_ = VECTOR (ERRMSG_FILE_NAME);
     1040    11858    2       FETCH_ERROR_TEXT.FILEACCT_ = VECTOR (ERRMSG_FILE_ACCT);
     1041    11859
     1042    11860    2       FETCH_ERROR_TEXT.FIELD1_ = VECTOR (NIL);
     1043    11861
     1044    11862    2       IF UTS ~= 0
     1045    11863    3       THEN DO;
     1046    11864
     1047    11865    3           CONVERT_TIME.TSTAMP_ = VECTOR (UTS);
     1048    11866    3           CONVERT_TIME.DATE_ = VECTOR (TIMEBUF.DATE);
     1049    11867    3           CONVERT_TIME.TIME_ = VECTOR (TIMEBUF.TIME);
     1050    11868    3           CONVERT_TIME.DAY_ = VECTOR (TIMEBUF.DAY);
     1051    11869
     1052    11870    3           CALL M$TIME (CONVERT_TIME)
     1053    11871    4           WHENRETURN DO;
     1054    11872
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:93   
     1055    11873    4               TIME_TEXTC.COUNT = LENGTHC(TIME_TEXTC.TEXT);
     1056    11874
     1057    11875    4               CALL CONCAT (TIME_TEXTC.TEXT, SUBSTR (TIMEBUF.DATE, 0, 5), ' ',
     1058    11876    4                 SUBSTR (TIMEBUF.TIME, 0, 5));
     1059    11877
     1060    11878    4               FETCH_ERROR_TEXT.FIELD1_ = VECTOR (TIME_TEXTC);
     1061    11879
     1062    11880    4           END;
     1063    11881
     1064    11882    3       END;
     1065    11883
     1066    11884    2       IF TEXTC2.COUNT = 0
     1067    11885    2       THEN
     1068    11886    2           FETCH_ERROR_TEXT.FIELD2_ = VECTOR(NIL);
     1069    11887    2       ELSE
     1070    11888    2           FETCH_ERROR_TEXT.FIELD2_ = VECTOR (TEXTC2);
     1071    11889
     1072    11890    3       CALL M$ERRMSG (FETCH_ERROR_TEXT) WHENALTRETURN DO; END;
     1073    11891
     1074    11892    2       HIT = %NO#;
     1075    11893    2       F_FDS.NVECS# = 1;
     1076    11894    2       F_FDS.FMT_ = VECTOR (BODY_FMT);
     1077    11895
     1078    11896    3       DO INDX1 = 0 TO VLR_ERRMSG.RECCNT - 1;
     1079    11897
     1080    11898    3           CALL INDEX (INDX, '<>', ERRMSG_BUF(INDX1))
     1081    11899    4           WHENRETURN DO;
     1082    11900
     1083    11901    4               CALL INDEX (INDX2, '<', ERRMSG_BUF(INDX1));
     1084    11902    4               CALL INDEX1R (INDX3, '>', ERRMSG_BUF(INDX1));
     1085    11903
     1086    11904    4               IF TEXTC.COUNT = 0
     1087    11905    4               THEN
     1088    11906    4                   CALL CONCAT (TEMPBUF,
     1089    11907    4                     SUBSTR (ERRMSG_BUF(INDX1), 0, INDX2),
     1090    11908    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX3+1));
     1091    11909    4               ELSE
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:94   
     1092    11910    4                   CALL CONCAT (TEMPBUF,
     1093    11911    4                     SUBSTR (ERRMSG_BUF(INDX1), 0, INDX2),
     1094    11912    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX2+1, MAXIMUM (0, INDX-INDX2-1)),
     1095    11913    4                     SUBSTR (TEXTC.TEXT, 0, TEXTC.COUNT),
     1096    11914    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX+2, MAXIMUM (0, INDX3-INDX-2)),
     1097    11915    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX3+1));
     1098    11916
     1099    11917    4               ERRMSG_BUF(INDX1) = TEMPBUF;
     1100    11918
     1101    11919    4               HIT = %YES#;
     1102    11920
     1103    11921    4           END;
     1104    11922
     1105    11923    3           INDX = LENGTHC (ERRMSG_BUF(INDX1));
     1106    11924
     1107    11925    4           DO WHILE INDX > 1;
     1108    11926    4               IF SUBSTR (ERRMSG_BUF(INDX1), INDX-1, 1) ~= ' '
     1109    11927    4               THEN
     1110    11928    4                   EXIT;
     1111    11929    4               INDX = INDX - 1;
     1112    11930    4           END;
     1113    11931
     1114    11932    3           VECT_ARRAY(0) = VECTOR(SUBSTR(ERRMSG_BUF(INDX1), 0, INDX));
     1115    11933
     1116    11934    3           CALL VMD$WRITE_BUF (F_FDS);
     1117    11935
     1118    11936    3       END;
     1119    11937
     1120    11938    2       IF TEXTC.COUNT > 0 AND NOT HIT
     1121    11939    3       THEN DO;
     1122    11940
     1123    11941    3           VECT_ARRAY(0) = VECTOR (SUBSTR(TEXTC.TEXT,0,TEXTC.COUNT));
     1124    11942                %INIT_STR(STR=VM_ERROR_ADDRESS_FMT, CODE=E_ERROR_ADDRESS_FMT, TEST=YES, VECT
             11942                    ="F_FDS.FMT_");
     1125    11965
     1126    11966    3           CALL VMD$WRITE_BUF (F_FDS);
     1127    11967
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:95   
     1128    11968    3       END;
     1129    11969
     1130    11970    2       RETURN;
     1131    11971
     1132    11972    2   END DISPLAY_ENCODED_ERROR;
     1133    11973
     1134    11974        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:96   
     1135    11975    1   DISPLAY_BODY_RECORD: PROC;
     1136    11976
     1137    11977    2   DCL I UBIN;
     1138    11978    2   DCL ID# UBIN;
     1139    11979    2   DCL ID#TEXT CHAR (10);
     1140    11980    2   DCL BODYREC$ PTR;
     1141    11981    2   DCL REF$ PTR;
     1142    11982    2   DCL CHAR_RMNG SBIN;
     1143    11983    2   DCL SIZE_BUF  UBIN;
     1144    11984    2   DCL DEVC_WIDTH UBIN;
     1145    11985        %VM_BODYREC (NAME=VM_BODYREC_ENCODED, STCLASS="BASED(BODYREC$)",
     1146    11986                     ERR_FORMAT=YES);
     1147    12018
     1148    12019    3       DO CASE (VM_BODYREC.TYPE);
     1149    12020    3       CASE (ELSE, %VM_BODY_TEXT);
     1150    12021    3           IF COUNT = 0
     1151    12022    4           THEN DO;                   /* Print a blank line */
     1152    12023    4               CALL VMD$WRITE_BUF (SPACE_LINE);
     1153    12024    4           END;
     1154    12025    4           ELSE DO;                   /* Print the data */
     1155    12026    4               DEVC_WIDTH = DCBADDR(OUT_DCB#)->F$DCB.WIDTH#;
     1156    12027    4               IF DEVC_WIDTH = 0 THEN DEVC_WIDTH=COUNT;
     1157    12028    4               CHAR_RMNG = COUNT;
     1158    12029    4               BODY_WRITE.BUF_.BUF$ = ADDR( VM_BODYREC.VALUE.DATA);
     1159    12030
     1160    12031    5               DO UNTIL (CHAR_RMNG <= 0);
     1161    12032    5                   SIZE_BUF = MINIMUM( CHAR_RMNG, DEVC_WIDTH);
     1162    12033    5                   BODY_WRITE.BUF_.BOUND = SIZE_BUF - 1;
     1163    12034    5                   CALL M$WRITE (BODY_WRITE)
     1164    12035    6                   WHENALTRETURN DO;
     1165    12036    6                       IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$INVVFC
     1166    12037    7                       THEN DO;
     1167    12038    7                           BODY_WRITE.V.DVBYTE.VFC# = %NO#;
     1168    12039    7                           CALL M$RETRY;
     1169    12040    7                       END;
     1170    12041    6                       IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$CANTBIN
     1171    12042    7                       THEN DO;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:97   
     1172    12043    7                           BODY_WRITE.V.DVBYTE.BIN# = %NO#;
     1173    12044    7                           CALL M$RETRY;
     1174    12045    7                       END;
     1175    12046    6                   END;
     1176    12047    5                   BODY_WRITE.BUF_.BUF$ = PINCRC( BODY_WRITE.BUF_.BUF$, SIZE_BUF);
     1177    12048    5                   CHAR_RMNG = CHAR_RMNG - SIZE_BUF;
     1178    12049    5                   BODY_WRITE.V.DVBYTE.VFC# = %NO#;
     1179    12050    5               END;  /* DO UNTIL */
     1180    12051    4           END;
     1181    12052    3       CASE (%VM_BODY_GRAPHICS);
     1182    12053              /*N* Implement this someday if we ever start shipping graphics */
     1183    12054    3       CASE (%VM_BODY_ENCODED_ERR);
     1184    12055    3           BODYREC$ = ADDR(VM_BODYREC);
     1185    12056    3           CODE = VM_BODYREC_ENCODED.VALUE.DATA.ERR;
     1186    12057    3           UTS = VM_BODYREC_ENCODED.VALUE.DATA.UTS;
     1187    12058    3           TEXTC = ADDR(VM_BODYREC_ENCODED.VALUE.DATA.STUFF) -> BASED_TEXTC;
     1188    12059    3           TEXTC2.COUNT = 0;
     1189    12060    3           REF$ = PINCRC(ADDR(VM_BODYREC_ENCODED.VALUE.DATA.STUFF), TEXTC.COUNT + 1);
     1190    12061    3           IF REF$ -> BASED_TEXTC.COUNT ~= 0
     1191    12062    4           THEN DO;
     1192    12063    4               CALL VMD$GET_ID (REF$ -> BASED_TEXTC, MAIL_DCB#, ID#) ALTRET (NO_ID);
     1193    12064    4               CALL BINCHAR (ID#TEXT, ID#);
     1194    12065    4               I = 0;
     1195    12066    5               DO WHILE I < LENGTHC(ID#TEXT);
     1196    12067    5                   IF SUBSTR(ID#TEXT,I,1) ~= '0'
     1197    12068    5                   THEN
     1198    12069    5                       EXIT;
     1199    12070    5                   I = I + 1;
     1200    12071    5               END;
     1201    12072    4               TEXTC2.COUNT = LENGTHC(ID#TEXT) - I;
     1202    12073    4               TEXTC2.TEXT = SUBSTR(ID#TEXT, I);
     1203    12074    4           END;
     1204    12075    3   NO_ID:
     1205    12076    3           CALL DISPLAY_ENCODED_ERROR;
     1206    12077    3       END;
     1207    12078    2       RETURN;
     1208    12079
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:98   
     1209    12080    2   END DISPLAY_BODY_RECORD;
     1210    12081
     1211    12082        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:99   
     1212    12083        /*I* NAME:    VMD$WRITE_CONTINUATION
     1213    12084             PURPOSE: To continue (wrap) output lines if necessary.
     1214    12085
     1215    12086             DESCRIPTION: There are two input parameters, the first defines
     1216    12087                      a TEXTC string that is to be wrapped and the second
     1217    12088                      is the maximum width that that string may have.
     1218    12089        */
     1219    12090
     1220    12091    1   WRITE_CONTINUATION: proc(STRING, WIDTH, QUOTES, VNUM);
     1221    12092
     1222    12093        %VLP_NAMEV( FPTN=STRING, STCLASS="");
     1223    12100
     1224    12101    2   dcl  WIDTH    sbin;
     1225    12102    2   dcl  QUOTES   bit(1) aligned;   /** Optional flag to delete quotes **/
     1226    12103    2   dcl  VNUM     sbin;    /**  Optional index in VECT_ARRAY  **/
     1227    12104
     1228    12105    2   dcl  LWIDTH   sbin;
     1229    12106    2   dcl  LQUOTES  bit(1);
     1230    12107    2   dcl  LVNUM    sbin;
     1231    12108    2   dcl  LEN      sbin;
     1232    12109    2   dcl  INDX     sbin;
     1233    12110    2   dcl  CPOS     sbin;
     1234    12111
     1235    12112    2       LVNUM = 0;
     1236    12113    2       if addr(VNUM) ~= addr(NIL) then LVNUM = VNUM;
     1237    12114    2       LQUOTES = '0'b;       /**  Don't strip quotes from strings **/
     1238    12115    2       if addr(QUOTES) ~= addr(nil) then LQUOTES = QUOTES;
     1239    12116    2       LEN = STRING.L#;
     1240    12117    2       LWIDTH = WIDTH;
     1241    12118    2       CPOS = 0;
     1242    12119
     1243    12120    3       do while LEN > (CPOS + LWIDTH);
     1244    12121        /***     Output lines must be wrapped!    ***/
     1245    12122    3           call searchr(INDX, DUMMY, DELIMITER_TABLE, STRING.NAME#,CPOS+LWIDTH);
     1246    12123    3           if INDX <= CPOS then INDX = CPOS+LWIDTH;
     1247    12124    3           INDX = minimum( LWIDTH, INDX-CPOS );
     1248    12125    3           IF SUBSTR(STRING.NAME#,CPOS,INDX) ~= ' ' THEN
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:100  
     1249    12126    3               VECT_ARRAY(LVNUM) = vector( substr(STRING.NAME#,CPOS,INDX) );
     1250    12127    3           ELSE
     1251    12128    3               GOTO NEXT_CPOS;
     1252    12129    3           if LQUOTES = '1'b
     1253    12130    3           then call BREAKER( VECT_ARRAY(LVNUM) );
     1254    12131    3           call VMD$WRITE_BUF( F_FDS );
     1255    12132    3   NEXT_CPOS:
     1256    12133    3           CPOS = CPOS + INDX;
     1257    12134    3           F_FDS.NVECS# = 1;
     1258    12135    3           LVNUM = 0;
     1259    12136                %INIT_STR( STR = VM_CONTINUATION_FMT,
     1260    12137                CODE = E_CONTINUATION_FMT,
     1261    12138                TEST = YES,
     1262    12139                VECT ="F_FDS.FMT_" );
     1263    12162
     1264    12163    3       end; /** Of wrapping long output lines!  **/
     1265    12164
     1266    12165    2       if LEN = 0
     1267    12166    2       then VECT_ARRAY(LVNUM) = vector(SPACE);
     1268    12167    2       else VECT_ARRAY(LVNUM) = vector( substr(STRING.NAME#,CPOS,LEN-CPOS) );
     1269    12168
     1270    12169    2       if LQUOTES
     1271    12170    2       then call BREAKER( VECT_ARRAY(LVNUM) );
     1272    12171    2       call VMD$WRITE_BUF( F_FDS );
     1273    12172    2       return;
     1274    12173
     1275    12174    2   end WRITE_CONTINUATION;
     1276    12175        %eject;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:101  
     1277    12176        /*I*    NAME:       VMD$BREAKER
     1278    12177                PURPOSE:    To remove Quotes and replace double quotes with
     1279    12178                            single quotes.
     1280    12179                DESCRIPTION:
     1281    12180                            If the input string does not contain a quote,
     1282    12181                            this subroutine does nothing.  Otherwise, the
     1283    12182                            string is copied into TEMPBUF removing the quotes.
     1284    12183        */
     1285    12184    1   BREAKER: proc( VECT );
     1286    12185
     1287    12186    2   dcl  VECT        vector;
     1288    12187
     1289    12188    2   dcl  STR$        ptr;
     1290    12189    2   dcl  STRLEN      sbin;
     1291    12190    2   dcl  STR         char(STRLEN) based(STR$);
     1292    12191
     1293    12192    2   dcl  IPOS        sbin;    /**  Insertion point in TEMPBUF  **/
     1294    12193    2   dcl  CPOS        sbin;    /**  current position in STR     **/
     1295    12194    2   dcl  I           sbin;
     1296    12195
     1297    12196
     1298    12197    2       STR$ = vbase(VECT);
     1299    12198    2       STRLEN= vbound(VECT)+1;
     1300    12199
     1301    12200    3       call index(I,'''',STR) whenaltreturn do;
     1302    12201    3           return;
     1303    12202    3       end;
     1304    12203
     1305    12204    2       IPOS = 0;
     1306    12205    2       CPOS = 0;
     1307    12206    2       if I = 0 then CPOS = CPOS + 1;
     1308    12207
     1309    12208    2   DEL_QUOTES:
     1310    12209    3       do while( CPOS < STRLEN );
     1311    12210    4           call index(I,'''',STR,CPOS+1) whenaltreturn do;
     1312    12211                /**  No more quotes  **/
     1313    12212    4               substr(TEMPBUF,IPOS) = substr(STR,CPOS);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:102  
     1314    12213    4               IPOS = IPOS + STRLEN - CPOS;
     1315    12214    4               exit DEL_QUOTES;
     1316    12215    4           end;
     1317    12216
     1318    12217    3           I = I - CPOS;   /** Length of this portion **/
     1319    12218    3           substr(TEMPBUF,IPOS,I) = substr(STR,CPOS,I);
     1320    12219    3           IPOS = IPOS + I; /** New insertion point    **/
     1321    12220    3           CPOS = CPOS + I + 1;
     1322    12221    3       end; /** Of do while CPOS < STRLEN **/
     1323    12222
     1324    12223    2       VECT = vector(substr(TEMPBUF,,IPOS));
     1325    12224    2       return;
     1326    12225
     1327    12226    2   end BREAKER;
     1328    12227        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:103  
     1329    12228        /*I*     NAME:         DISPLAY_ADDREC
     1330    12229                 PURPOSE:      To display contents of an address record when
     1331    12230                               a message is displayed.
     1332    12231                 DESCRIPTION:  Read the appropriate address record into the
     1333    12232                               appropriate data segment, then display each
     1334    12233                               entry in the address list.
     1335    12234        */
     1336    12235    1   DISPLAY_ADDREC: PROC(TYPE, NUMBER);
     1337    12236
     1338    12237    2   DCL TYPE UBIN WORD;
     1339    12238    2   DCL NUMBER UBIN WORD;
     1340    12239
     1341    12240    2   DCL FMT_STR_LEN SBIN WORD;
     1342    12241    2       CALL VMA$GET_ADD_RECORD (TYPE, VM_ADDLIST_,MAIL_DCB#,NUMBER) ALTRET (
             12241                NO_ADDRECORD);
     1343    12242    2       PTR$ = PINCRW(ADDR(VM_ADD_HEAD),SIZEW(VM_ADD_HEAD));
     1344    12243    3       DO I = 0 TO VM_ADD_HEAD.NUM_ENTRIES - 1;
     1345    12244    4           IF I = 0 THEN DO;
     1346    12245    5               DO SELECT (TYPE);
     1347    12246    5                   SELECT(%VM_TYPE_TO);
     1348    12247    6                   DO;
     1349    12248    6                       FMT_STR_LEN = 35;
     1350    12249                            %INIT_STR(STR=VM_TO_FROM_FMT,CODE=E_TO_FROM_FMT,TEST=YES,VECT=
             12249                                "F_FDS.FMT_");
     1351    12272    6                       IF VM_HEADER.FROM$ ~= ADDR(NIL)
     1352    12273    6                       THEN
     1353    12274    7                       DO;   /* Append to end */
     1354    12275    7                           TEMPBUF1 = VM_HEADER.FROM$ -> X$STRING.TEXT;
             12275                                    /* Remove the sitename */
     1355    12276    7                           CALL INDEX1R(INDX1,'@',SUBSTR(VM_HEADER.FROM$ -> X$STRING.
             12276                                    TEXT,0,VM_HEADER.FROM$ -> X$STRING.SIZ))
     1356    12277    8                           WHENRETURN DO;
     1357    12278    8                               LEN = VM_HEADER.FROM$ -> X$STRING.SIZ - INDX1 - 1;
     1358    12279    8                               CALL XLATE (SITENAME, LOWER_UPPER, SUBSTR(TEMPBUF1,INDX1
             12279                                        +1,LEN));
     1359    12280    8                               IF SITENAME ~= VM_SITENAME
     1360    12281    8                               THEN
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:104  
     1361    12282    8                                   INDX1 = VM_HEADER.FROM$ -> X$STRING.SIZ;
     1362    12283    8                           END;
     1363    12284    7                           VECT_ARRAY(1) = VECTOR(ONE);
     1364    12285    7                           VECT_ARRAY(2) = VECTOR(SUBSTR(TEMPBUF1,0,INDX1));
     1365    12286    7                           F_FDS.NVECS# = 3;
     1366    12287    7                       END;
     1367    12288    6                       ELSE
     1368    12289    7                       DO;   /* Don't print 'FROM:' */
     1369    12290    7                           VECT_ARRAY(1) = VECTOR(ZERO);
     1370    12291    7                           F_FDS.NVECS# = 2;
     1371    12292    7                       END;
     1372    12293    6                   END; /* SELECT %VM_TYPE_TO */
     1373    12294    5                   SELECT (%VM_TYPE_C);
     1374    12295    6                   DO;
     1375    12296    6                       FMT_STR_LEN = 70;
     1376    12297                            %INIT_STR(STR=VM_COPY_FMT, CODE=E_COPY_FMT, TEST=YES,
     1377    12298                            VECT="F_FDS.FMT_");
     1378    12321    6                       F_FDS.NVECS# = 1;
     1379    12322
     1380    12323    6                   END; /* SELECT %VM_TYPE_C */
     1381    12324    5                   SELECT (%VM_TYPE_BC);
     1382    12325    6                   DO;
     1383    12326    6                       FMT_STR_LEN = 70;
     1384    12327                            %INIT_STR(STR=VM_BLIND_COPY_FMT, CODE=E_BLIND_COPY_FMT,
     1385    12328                            TEST= YES,VECT="F_FDS.FMT_");
     1386    12351    6                       F_FDS.NVECS# = 1;
     1387    12352
     1388    12353    6                   END; /* SELECT %VM_TYPE_BC */
     1389    12354    5               END; /* DO SELECT */
     1390    12355    4           END;
     1391    12356    4           ELSE DO; /* IF I ~= 0 */
     1392    12357                    %INIT_STR(STR=VM_CONTINUATION_FMT,CODE=E_CONTINUATION_FMT,TEST=YES,VECT=
             12357                        "F_FDS.FMT_");
     1393    12380    4               F_FDS.NVECS# = 1;
     1394    12381    4           END;
     1395    12382    4           IF PTR$->VM$RADDRESS.TYPE = %VM_ADD_UNRESOLVED THEN DO;
     1396    12383    5               IF PTR$->VM$UADDRESS.SITENAME ~= VM_SITENAME THEN DO;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:105  
     1397    12384    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
             12384                            THEN DO;
     1398    12385    6                       CALL INDEX(INDX,' ',PTR$->VM$UADDRESS.SITENAME);
     1399    12386    6                       CALL CONCAT(TEXTC.TEXT,
     1400    12387    6                         SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,PTR$->VM$UADDRESS.
             12387                                  USER_NAME.COUNT),
     1401    12388    6                         '@',SUBSTR(PTR$->VM$UADDRESS.SITENAME,0,INDX),',');
     1402    12389    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT + INDX + 2;
     1403    12390    6                   END;
     1404    12391    6                   ELSE DO;
     1405    12392    6                       CALL INDEX(INDX,' ',PTR$->VM$UADDRESS.SITENAME);
     1406    12393    6                       CALL CONCAT(TEXTC.TEXT,
     1407    12394    6                         SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,PTR$->VM$UADDRESS.
             12394                                  USER_NAME.COUNT),
     1408    12395    6                         '@',SUBSTR(PTR$->VM$UADDRESS.SITENAME,0,INDX));
     1409    12396    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT + INDX + 1;
     1410    12397    6                   END;
     1411    12398    5               END;
     1412    12399    5               ELSE DO;
     1413    12400    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
             12400                            THEN DO;
     1414    12401    6                       CALL CONCAT(TEXTC.TEXT,
     1415    12402    6                         SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,PTR$->VM$UADDRESS.
             12402                                  USER_NAME.COUNT),',');
     1416    12403    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT + 1;
     1417    12404    6                   END;
     1418    12405    6                   ELSE DO;
     1419    12406    6                       TEXTC.TEXT = SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,
     1420    12407    6                         PTR$->VM$UADDRESS.USER_NAME.COUNT);
     1421    12408    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT;
     1422    12409    6                   END;
     1423    12410    5               END;
     1424    12411    4           END;
     1425    12412    4           ELSE DO;
     1426    12413    5               IF PTR$->VM$RADDRESS.SITENAME ~= VM_SITENAME THEN DO;
     1427    12414    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
             12414                            THEN DO;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:106  
     1428    12415    6                       CALL INDEX(INDX,' ',PTR$->VM$RADDRESS.SITENAME);
     1429    12416    6                       CALL CONCAT(TEXTC.TEXT,
     1430    12417    6                         PTR$->VM$RADDRESS.ACCT,
     1431    12418    6                         '@',SUBSTR(PTR$->VM$RADDRESS.SITENAME,0,INDX),',');
     1432    12419    6                       TEXTC.COUNT = INDX + 8 + 2;
     1433    12420    6                   END;
     1434    12421    6                   ELSE DO;
     1435    12422    6                       CALL INDEX(INDX,' ',PTR$->VM$RADDRESS.SITENAME);
     1436    12423    6                       CALL CONCAT(TEXTC.TEXT,
     1437    12424    6                         PTR$->VM$RADDRESS.ACCT,
     1438    12425    6                         '@',SUBSTR(PTR$->VM$RADDRESS.SITENAME,0,INDX));
     1439    12426    6                       TEXTC.COUNT = INDX + 8 + 1;
     1440    12427    6                   END;
     1441    12428    5               END;
     1442    12429    5               ELSE DO;
     1443    12430    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
             12430                            THEN DO;
     1444    12431    6                       CALL CONCAT(TEXTC.TEXT,
     1445    12432    6                         PTR$->VM$RADDRESS.ACCT,',');
     1446    12433    6                       TEXTC.COUNT = 9;
     1447    12434    6                   END;
     1448    12435    6                   ELSE DO;
     1449    12436    6                       TEXTC.TEXT = PTR$->VM$RADDRESS.ACCT;
     1450    12437    6                       TEXTC.COUNT = 8;
     1451    12438    6                   END;
     1452    12439    5               END;
     1453    12440    4           END;
     1454    12441
     1455    12442    3           CALL WRITE_CONTINUATION(TEXTC, FMT_STR_LEN, '1'b );
     1456    12443              /* Back up one word to get the size of the current entry, then
     1457    12444                 move forward by that number of words to the next entry. */
     1458    12445    3           PTR$ = PINCRW(PTR$, -1);
     1459    12446    3           PTR$ = PINCRW(PTR$, PTR$->BSD + 1);
     1460    12447    3       END;
     1461    12448    2   NO_ADDRECORD:
     1462    12449    2       RETURN;
     1463    12450    2   END DISPLAY_ADDREC;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:107  
     1464    12451    1   END VMD$DI_MESSAGE;
     1465    12452        %EOD;

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:108  
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   XUR_ENTRY.:LIB_E05  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMD$DI_MESSAGE.

   Procedure VMD$DI_MESSAGE requires 2129 words for executable code.
   Procedure VMD$DI_MESSAGE requires 632 words of local(AUTO) storage.

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:109  

 Object Unit name= VMD$DI_MESSAGE                             File name= VMD$DISPLAY.:VMB6TOU
 UTS= AUG 20 '97 15:08:48.56 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none   463    717  VMD$DI_MESSAGE
   12  RoData even  UTS    140    214  VMD$DI_MESSAGE
   13   Proc  even  none  2129   4121  VMD$DI_MESSAGE
   14  RoData even  none   127    177  VMD$DI_MESSAGE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes    yes     yes      Std        6  VMD$DI_MESSAGE
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:110  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       4 VMA$GET_ADD_RECORD
         yes           Std       1 VMD$WRITE_BUF
 yes     yes           Std       3 VMD$ERRMSG
 yes     yes           Std       3 VMD$GET_ID
 yes     yes           Std       7 VMD$GET_TRACE
 yes     yes           Std       9 VMD$GET_BODY
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:111  
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                 r    B$XL_UPPER$
     VM_DATE_NUMBER_FMT                    VM_TO_FROM_FMT                        VM_SUBJECT_FMT
     VM_REPLY_TO_FMT                       VM_REFERENCE_FMT                      VM_REFERENCE_AND_ID_FMT
     VM_COPY_FMT                           VM_BLIND_COPY_FMT                     VM_CONTINUATION_FMT
     VM_ERROR_ADDRESS_FMT                  VM_RE_STRING                          VM_ENCL_1_FMT
     VM_ENCL_2_FMT                         VM_ENCL_FWD_FMT                  r    E_DATE_NUMBER_FMT
r    E_TO_FROM_FMT                    r    E_SUBJECT_FMT                    r    E_REPLY_TO_FMT
r    E_REFERENCE_FMT                  r    E_REFERENCE_AND_ID_FMT           r    E_COPY_FMT
r    E_BLIND_COPY_FMT                 r    E_CONTINUATION_FMT               r    E_ERROR_ADDRESS_FMT
r    E_RE_STRING                      r    E_ENCL_1_FMT                     r    E_ENCL_2_FMT
r    E_ENCL_FWD_FMT

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:112  


      501        1        /*T***********************************************************/
      502        2        /*T*                                                         */
      503        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      504        4        /*T*                                                         */
      505        5        /*T***********************************************************/
      506        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
      507        7
      508        8        /*P* NAME: VMD$DI_MESSAGE
      509        9             DESCRIPTION: This routine will display a specified message.
      510       10        */
      511       11
      512       12        VMD$DI_MESSAGE: PROC (MESSAGE_NUMBER,OUT_DCB#,MAIL_DCB#,SEED,TRACE,ENTRY_REASON#)
                12            ALTRET;

     12 13 000000   000000 700200 xent  VMD$DI_MESS* TSX0  ! X66_AUTO_N
        13 000001   001170 000006                    ZERO    632,6

      513       13
      514       14        /***** Include files *****/
      515       15        %INCLUDE B_ERRORS_C;
      516     1142        %INCLUDE CP_6_SUBS;
      517     1682        %INCLUDE CP_6;
      518     7241        %INCLUDE VM_MACRO_C;
      519     8509        %INCLUDE VM_SUBS_C;
      520     8769        %INCLUDE VM_DATA_R;
      521     9200        %INCLUDE XU_FORMAT_C;
      522     9362        %INCLUDE XUR_ENTRY;
      523     9394        %include B$TABLES_C;
      524     9502          %B$XL_UPPER(NAME=LOWER_UPPER);
      525     9506        /***** Parameters *****/
      526     9507    1   DCL MESSAGE_NUMBER UBIN WORD;
      527     9508    1   DCL OUT_DCB# SBIN WORD;
      528     9509    1   DCL MAIL_DCB# UBIN WORD;
      529     9510    1   DCL SEED BIT(36) ALIGNED;
      530     9511    1   DCL TRACE BIT (1);
      531     9512    1   DCL ENTRY_REASON# SBIN WORD;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:113  
      532     9513        /***** Fpts/macros *****/
      533     9514        %FPT_TIME  (FPTN=CONVERT_TIME,
      534     9515                    SOURCE=UTS,
      535     9516                    DEST=LOCAL);
      536     9535
      537     9536        %FPT_ERRMSG   (FPTN=FETCH_ERROR_TEXT,
      538     9537                       RESULTS=VLR_ERRMSG);
      539     9564
      540     9565        %VLR_ERRMSG;
      541     9587
      542     9588        %VLP_NAME (FPTN=ERRMSG_FILE_NAME, STCLASS=AUTO);
      543     9615        %VLP_ACCT (FPTN=ERRMSG_FILE_ACCT, STCLASS=AUTO);
      544     9628
      545     9629        %F_FDS (VECTR=VECT_ARRAY);
      546     9742              %F_FDS (NAME=SPACE_LINE,VECTR=VECT_ARRAY,FMT=BLANK_LINE_FMT,NVECS=0);
      547     9855              %FPT_WRITE (FPTN=BODY_WRITE, STCLASS=STATIC);
      548     9886    1   DCL VECT_ARRAY(0:6) VECTOR DALIGNED STATIC;
      549     9887        /***** Based structures *****/
      550     9888        %VM_HEADER;
      551    10017        %VM_PROFILE;
      552    10104        %B$TCB (STCLASS="BASED(B$TCB$)");
      553    10107        %B$ALT;
      554    10115        %F$DCB;
      555    10172        /***** External routines *****/
      556    10173    1   DCL VMD$WRITE_BUF ENTRY(1);
      557    10174    1   DCL VMD$GET_BODY ENTRY (9) ALTRET;
      558    10175    1   DCL VMD$GET_TRACE ENTRY (7) ALTRET;
      559    10176    1   DCL VMD$GET_ID ENTRY (3) ALTRET;
      560    10177    1   DCL VMA$GET_ADD_RECORD ENTRY(4) ALTRET;
      561    10178    1   DCL VMA$GET_NEXT_ENTRY ENTRY(4) ALTRET;
      562    10179        %INIT_STR(DODCL=YES);
      563    10202        /***** Other variables *****/
      564    10203    1   DCL I SBIN WORD;
      565    10204    1   DCL PTR$ PTR;
      566    10205    1   DCL ENCL$ PTR;
      567    10206    1   DCL LEN SBIN WORD;
      568    10207    1   DCL INDX SBIN WORD;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:114  
      569    10208    1   DCL INDX1 SBIN WORD;
      570    10209    1   DCL REFERENCE_ID SBIN;
      571    10210    1   DCL DUMMY SBIN WORD;
      572    10211    1   DCL TEMPBUF CHAR(512) STATIC;
      573    10212    1   DCL TEMPBUF1 CHAR(256) STATIC;
      574    10213    1   DCL TEMPBUF2 CHAR(256) STATIC;
      575    10214    1   DCL 1 CODE,
      576    10215    1         2 FCG BIT (12),
      577    10216    1         2 MID BIT (6),
      578    10217    1         2 MON BIT (1),
      579    10218    1         2 ERR# UBIN (14) UNAL,
      580    10219    1         2 SEV UBIN (3) UNAL;
      581    10220    1   DCL UTS UBIN WORD;
      582    10221    1   DCL 1 TEXTC,
      583    10222    1         2 COUNT UBIN BYTE CALIGNED,
      584    10223    1         2 TEXT CHAR (511);
      585    10224    1   DCL 1 TEXTC2,
      586    10225    1         2 COUNT UBIN BYTE CALIGNED,
      587    10226    1         2 TEXT CHAR (511);
      588    10227    1   DCL 1 BASED_TEXTC BASED,
      589    10228    1         2 COUNT UBIN BYTE CALIGNED,
      590    10229    1         2 TEXT CHAR (BASED_TEXTC.COUNT);
      591    10230    1   DCL 1 TIMEBUF,
      592    10231    1         2 DATE CHAR (8),
      593    10232    1         2 TIME CHAR (11),
      594    10233    1         2 DAY CHAR (3);
      595    10234    1   DCL 1 TIME_TEXTC,
      596    10235    1         2 COUNT UBIN BYTE CALIGNED,
      597    10236    1         2 TEXT CHAR (11);
      598    10237    1   DCL ERRMSG_BUF (0:9) CHAR (120);
      599    10238        %VM_BODYTYPES;
      600    10244        %VM_BODYREC (STCLASS=STATIC,VARYLEN=NO);
      601    10276        %VM_ADD_HEAD;
      602    10305        %VM_ADDTYPES;
      603    10309        %VM_KEYTYPES;
      604    10330        %VM_RADDRESS (NAME=VM$RADDRESS,STCLASS=BASED);
      605    10365        %VM_UADDRESS (NAME=VM$UADDRESS,STCLASS=BASED);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:115  
      606    10402        %VM_ENCLOS (STCLASS="BASED(ENCL$)");
      607    10433        %VM_ADD_HEAD (NAME=VM_ENCL_HEAD,STCLASS="BASED(VM_ENCLLIST$)");
      608    10462    1   DCL COUNT SBIN WORD;
      609    10463    1   DCL SITENAME CHAR(8);
      610    10464    1   DCL SPACE CHAR(1) CONSTANT INIT(' ');
      611    10465    1   DCL ONE UBIN WORD CONSTANT INIT (1);
      612    10466    1   DCL ZERO UBIN WORD CONSTANT INIT (0);
      613    10467    1   DCL DEL_FLAG CHAR(1) CONSTANT INIT('d');
      614    10468    1   DCL FWD_FLAG CHAR(1) CONSTANT INIT('f');
      615    10469    1   DCL ENCL_NUM SBIN WORD STATIC;
      616    10470    1   DCL PAGESIZE SBIN WORD STATIC INIT(4096);
      617    10471        /***** Constants *****/
      618    10472    1   DCL DELIMITER_TABLE(0:511) UBIN BYTE UNAL CONSTANT INIT
      619    10473    1     (0*32,1,0*12,1*2,0*465);
      620    10474        /***** Formats *****/
      621    10475        %VLP_NAMEV( FPTN=VM_DATE_NUMBER_FMT,       STCLASS=SYMREF );
      622    10482        %VLP_NAMEV( FPTN=VM_TO_FROM_FMT,           STCLASS=SYMREF );
      623    10489        %VLP_NAMEV( FPTN=VM_SUBJECT_FMT,           STCLASS=SYMREF );
      624    10496        %VLP_NAMEV( FPTN=VM_REPLY_TO_FMT,          STCLASS=SYMREF );
      625    10503        %VLP_NAMEV( FPTN=VM_REFERENCE_FMT,         STCLASS=SYMREF );
      626    10510        %VLP_NAMEV( FPTN=VM_REFERENCE_AND_ID_FMT,  STCLASS=SYMREF );
      627    10517        %VLP_NAMEV( FPTN=VM_COPY_FMT,              STCLASS=SYMREF );
      628    10524        %VLP_NAMEV( FPTN=VM_BLIND_COPY_FMT,        STCLASS=SYMREF );
      629    10531        %VLP_NAMEV( FPTN=VM_CONTINUATION_FMT,      STCLASS=SYMREF );
      630    10538        %VLP_NAMEV( FPTN=VM_ERROR_ADDRESS_FMT,     STCLASS=SYMREF );
      631    10545        %VLP_NAMEV( FPTN=VM_RE_STRING,             STCLASS=SYMREF );
      632    10552        %VLP_NAMEV (FPTN=VM_ENCL_1_FMT, STCLASS=SYMREF);
      633    10559        %VLP_NAMEV (FPTN=VM_ENCL_2_FMT, STCLASS=SYMREF);
      634    10566        %VLP_NAMEV (FPTN=VM_ENCL_FWD_FMT, STCLASS=SYMREF);
      635    10573
      636    10574        %VLP_ERRCODE( FPTN=E_DATE_NUMBER_FMT,      STCLASS="SYMREF READONLY");
      637    10619              %VLP_ERRCODE( FPTN=E_TO_FROM_FMT,    STCLASS="SYMREF READONLY");
      638    10664              %VLP_ERRCODE( FPTN=E_SUBJECT_FMT,    STCLASS="SYMREF READONLY");
      639    10709              %VLP_ERRCODE( FPTN=E_REPLY_TO_FMT,   STCLASS="SYMREF READONLY");
      640    10754              %VLP_ERRCODE( FPTN=E_REFERENCE_FMT,  STCLASS="SYMREF READONLY");
      641    10799              %VLP_ERRCODE( FPTN=E_REFERENCE_AND_ID_FMT, STCLASS="SYMREF READONLY");
      642    10844              %VLP_ERRCODE( FPTN=E_COPY_FMT,       STCLASS="SYMREF READONLY");
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:116  
      643    10889              %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT, STCLASS="SYMREF READONLY");
      644    10934              %VLP_ERRCODE( FPTN=E_CONTINUATION_FMT, STCLASS="SYMREF READONLY");
      645    10979              %VLP_ERRCODE( FPTN=E_ERROR_ADDRESS_FMT, STCLASS="SYMREF READONLY");
      646    11024              %VLP_ERRCODE( FPTN=E_RE_STRING,      STCLASS="SYMREF READONLY");
      647    11069              %VLP_ERRCODE (FPTN=E_ENCL_1_FMT, STCLASS="SYMREF READONLY");
      648    11114              %VLP_ERRCODE (FPTN=E_ENCL_2_FMT, STCLASS="SYMREF READONLY");
      649    11159              %VLP_ERRCODE (FPTN=E_ENCL_FWD_FMT, STCLASS="SYMREF READONLY");
      650    11204
      651    11205    1   DCL BODY_FMT CHAR(0) CONSTANT INIT
      652    11206    1        ('%A');
      653    11207        /**/
      654    11208    1   DCL SIGNED_FMT CHAR(0) CONSTANT INIT
      655    11209    1        ('%40X%<>A');
      656    11210        /**/
      657    11211    1   DCL BLANK_LINE_FMT CHAR(0) CONSTANT INIT
      658    11212    1        ('%1X');
      659    11213
      660    11214    1   dcl  BSD      sbin based;
      661    11215
      662    11216    1   dcl 1  SPACEC   constant,
      663    11217    1         2 L#   ubin(9) caligned init(1),
      664    11218    1         2 NAME# char(1)         init(' ');
      665    11219
      666    11220        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:117  
      667    11221    1       SPACE_LINE.DCB# = OUT_DCB#;

  11221 13 000002   200004 470500                    LDP0    @OUT_DCB#,,AUTO
        13 000003   000000 720100                    LXL0    0,,PR0
        13 000004   000123 740000 11                 STX0    SPACE_LINE+11

      668    11222    1       F_FDS.DCB# = OUT_DCB#;

  11222 13 000005   000000 721100                    LXL1    0,,PR0
        13 000006   000065 741000 11                 STX1    F_FDS+11

      669    11223    1       CALL VMD$WRITE_BUF (SPACE_LINE);

  11223 13 000007   000001 630400 14                 EPPR0   1
        13 000010   000000 631400 14                 EPPR1   0
        13 000011   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 000012   000000 011000                    NOP     0

      670    11224        /*
      671    11225             ***** Date: ... Number: ...
      672    11226        */
      673    11227    1       VECT_ARRAY(0) = VECTOR(VM_HEADER.CREATION_DATE);

  11227 13 000013   777640 235007                    LDA     -96,DL
        13 000014   000000 236000 xsym               LDQ     VM_HEADER$
        13 000015   000001 036003                    ADLQ    1,DU
        13 000016   000162 757000 11                 STAQ    VECT_ARRAY

      674    11228    1       VECT_ARRAY(1) = VECTOR(VM_HEADER.DELIVERY_DATE);

  11228 13 000017   777640 235007                    LDA     -96,DL
        13 000020   000000 236000 xsym               LDQ     VM_HEADER$
        13 000021   000002 036003                    ADLQ    2,DU
        13 000022   000164 757000 11                 STAQ    VECT_ARRAY+2

      675    11229    1       VECT_ARRAY(2) = VECTOR(MESSAGE_NUMBER);

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:118  
  11229 13 000023   777640 235007                    LDA     -96,DL
        13 000024   200003 236100                    LDQ     @MESSAGE_NUMBER,,AUTO
        13 000025   000166 757000 11                 STAQ    VECT_ARRAY+4

      676    11230    1       F_FDS.NVECS#=3;

  11230 13 000026   000003 235007                    LDA     3,DL
        13 000027   000063 755000 11                 STA     F_FDS+9

      677    11231            %INIT_STR(STR=VM_DATE_NUMBER_FMT, CODE=E_DATE_NUMBER_FMT, TEST=YES, VECT=
             11231                "F_FDS.FMT_");

  11238 13 000030   000000 236000 xsym               LDQ     VM_DATE_NUMBER_FMT
        13 000031   000033 772000                    QRL     27
        13 000032   000000 620006                    EAX0    0,QL
        13 000033   040000 106440                    CMPC    fill='040'O
        13 000034   000000 200010 xsym               ADSC9   VM_DATE_NUMBER_FMT       cn=1,n=*X0
        13 000035   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000036   000044 601000 13                 TNZ     s:11243

  11240 13 000037   000004 630400 14                 EPPR0   4
        13 000040   000003 631400 14                 EPPR1   3
        13 000041   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000042   000000 011000                    NOP     0

  11241 13 000043   000051 710000 13                 TRA     s:11254

  11243 13 000044   000000 635010                    EAA     0,X0
        13 000045   000002 771000                    ARL     2
        13 000046   000140 135007                    SBLA    96,DL
        13 000047   000007 236000 14                 LDQ     7
        13 000050   000052 757000 11                 STAQ    F_FDS

      678    11254    1       CALL VMD$WRITE_BUF(F_FDS);

  11254 13 000051   000006 630400 14                 EPPR0   6
        13 000052   000000 631400 14                 EPPR1   0
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:119  
        13 000053   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 000054   000000 011000                    NOP     0

      679    11255        /*
      680    11256             ***** To: ... FROM: ...
      681    11257        */
      682    11258    1       TEMPBUF = ' ';

  11258 13 000055   040000 100400                    MLR     fill='040'O
        13 000056   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000057   000200 001000 11                 ADSC9   TEMPBUF                  cn=0,n=512

      683    11259        /*
      684    11260             ***** Handle long TO: field ...
      685    11261        */
      686    11262    2       IF VM_PROFILE.OPT.EXT_ADDR_DISP = %NO# THEN DO;

  11262 13 000060   000000 470400 xsym               LDP0    VM_PROFILE$
        13 000061   000001 236100                    LDQ     1,,PR0
        13 000062   100000 316003                    CANQ    32768,DU
        13 000063   000227 601000 13                 TNZ     s:11314

      687    11263    2           IF VM_HEADER.TO$ ~= ADDR(NIL)

  11263 13 000064   000000 471400 xsym               LDP1    VM_HEADER$
        13 000065   100031 236100                    LDQ     25,,PR1
        13 000066   000010 116000 14                 CMPQ    8
        13 000067   000235 600000 13                 TZE     REPLY_TO

      688    11264    2           THEN
      689    11265    3           DO;

      690    11266                    %INIT_STR(STR=VM_TO_FROM_FMT, CODE=E_TO_FROM_FMT, TEST=YES, VECT=
             11266                        "F_FDS.FMT_");

  11273 13 000070   000000 236000 xsym               LDQ     VM_TO_FROM_FMT
        13 000071   000033 772000                    QRL     27
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:120  
        13 000072   000000 620006                    EAX0    0,QL
        13 000073   040000 106440                    CMPC    fill='040'O
        13 000074   000000 200010 xsym               ADSC9   VM_TO_FROM_FMT           cn=1,n=*X0
        13 000075   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000076   000104 601000 13                 TNZ     s:11278

  11275 13 000077   000011 630400 14                 EPPR0   9
        13 000100   000003 631400 14                 EPPR1   3
        13 000101   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000102   000000 011000                    NOP     0

  11276 13 000103   000111 710000 13                 TRA     s:11289

  11278 13 000104   000000 635010                    EAA     0,X0
        13 000105   000002 771000                    ARL     2
        13 000106   000140 135007                    SBLA    96,DL
        13 000107   000014 236000 14                 LDQ     12
        13 000110   000052 757000 11                 STAQ    F_FDS

      691    11289    3               IF VM_HEADER.FROM$ ~= ADDR(NIL)

  11289 13 000111   000000 470400 xsym               LDP0    VM_HEADER$
        13 000112   000023 236100                    LDQ     19,,PR0
        13 000113   000010 116000 14                 CMPQ    8
        13 000114   000211 600000 13                 TZE     s:11307

      692    11290    3               THEN
      693    11291    4               DO;           /* Append to end */

      694    11292    4                   TEMPBUF1 = VM_HEADER.FROM$ -> X$STRING.TEXT;
             11292                            /* Remove the sitename */

  11292 13 000115   000023 471500                    LDP1    19,,PR0
        13 000116   000100 101500                    MRL     fill='000'O
        13 000117   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000120   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000121   201156 220100                    LDX0    I+2,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:121  
        13 000122   040000 100540                    MLR     fill='040'O
        13 000123   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        13 000124   000400 000400 11                 ADSC9   TEMPBUF1                 cn=0,n=256

      695    11293    4                   CALL INDEX1R(INDX1,'@',SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,0,
             11293                            VM_HEADER.FROM$ -> X$STRING.SIZ))

  11293 13 000125   000023 471500                    LDP1    19,,PR0
        13 000126   000100 101500                    MRL     fill='000'O
        13 000127   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000130   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000131   201156 220100                    LDX0    I+2,,AUTO
        13 000132   000023 473500                    LDP3    19,,PR0
        13 000133   000100 101500                    MRL     fill='000'O
        13 000134   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 000135   201157 000002                    ADSC9   I+3,,AUTO                cn=0,n=2
        13 000136   201157 221100                    LDX1    I+3,,AUTO
        13 000137   000000 636011                    EAQ     0,X1
        13 000140   000022 772000                    QRL     18
        13 000141   000000 125540                    SCMR    mask='000'O
        13 000142   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 000143   000015 000001 14                 ADSC9   13                       cn=0,n=1
        13 000144   200030 000100                    ARG     INDX1,,AUTO
        13 000145   000177 606400 13                 TTN     s:11301
        13 000146   200030 054100                    AOS     INDX1,,AUTO
        13 000147   200030 156100                    SSQ     INDX1,,AUTO

      696    11294    5                   WHENRETURN DO;

      697    11295    5                       LEN = VM_HEADER.FROM$ -> X$STRING.SIZ - INDX1 - 1;

  11295 13 000150   000023 471500                    LDP1    19,,PR0
        13 000151   000100 101500                    MRL     fill='000'O
        13 000152   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000153   201156 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
        13 000154   201156 236100                    LDQ     I+2,,AUTO
        13 000155   200030 136100                    SBLQ    INDX1,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:122  
        13 000156   000001 136007                    SBLQ    1,DL
        13 000157   200026 756100                    STQ     LEN,,AUTO

      698    11296    5                      CALL XLATE (SITENAME, LOWER_UPPER, SUBSTR(TEMPBUF1,INDX1+1,LEN))
             11296                                ;

  11296 13 000160   000000 620006                    EAX0    0,QL
        13 000161   200030 235100                    LDA     INDX1,,AUTO
        13 000162   000000 471400 xsym               LDP1    B$XL_UPPER$
        13 000163   040100 160445                    MVT     fill='040'O
        13 000164   000400 200010 11                 ADSC9   TEMPBUF1,A               cn=1,n=*X0
        13 000165   201123 000010                    ADSC9   SITENAME,,AUTO           cn=0,n=8
        13 000166   100000 000100                    ARG     0,,PR1

      699    11297    5                       IF SITENAME ~= VM_SITENAME

  11297 13 000167   040000 106500                    CMPC    fill='040'O
        13 000170   201123 000010                    ADSC9   SITENAME,,AUTO           cn=0,n=8
        13 000171   000000 000010 xsym               ADSC9   VM_SITENAME              cn=0,n=8
        13 000172   000177 600000 13                 TZE     s:11301

      700    11298    5                       THEN
      701    11299    5                           INDX1 = VM_HEADER.FROM$ -> X$STRING.SIZ;

  11299 13 000173   000023 473500                    LDP3    19,,PR0
        13 000174   000100 101500                    MRL     fill='000'O
        13 000175   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 000176   200030 000004                    ADSC9   INDX1,,AUTO              cn=0,n=4

      702    11300    5                   END;

      703    11301    4                   VECT_ARRAY(1) = VECTOR(ONE);

  11301 13 000177   000016 237000 14                 LDAQ    14
        13 000200   000164 757000 11                 STAQ    VECT_ARRAY+2

      704    11302    4                   VECT_ARRAY(2) = VECTOR(SUBSTR(TEMPBUF1,0,INDX1));
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:123  

  11302 13 000201   200030 235100                    LDA     INDX1,,AUTO
        13 000202   000020 735000                    ALS     16
        13 000203   000140 135007                    SBLA    96,DL
        13 000204   000020 236000 14                 LDQ     16
        13 000205   000166 757000 11                 STAQ    VECT_ARRAY+4

      705    11303    4                   F_FDS.NVECS# = 3;

  11303 13 000206   000003 235007                    LDA     3,DL
        13 000207   000063 755000 11                 STA     F_FDS+9

      706    11304    4               END;

  11304 13 000210   000215 710000 13                 TRA     s:11310

      707    11305    3               ELSE
      708    11306    4               DO;           /* Don't print 'FROM:' */

      709    11307    4                   VECT_ARRAY(1) = VECTOR(ZERO);

  11307 13 000211   000022 237000 14                 LDAQ    18
        13 000212   000164 757000 11                 STAQ    VECT_ARRAY+2

      710    11308    4                   F_FDS.NVECS# = 2;

  11308 13 000213   000002 235007                    LDA     2,DL
        13 000214   000063 755000 11                 STA     F_FDS+9

      711    11309    4               END;

      712    11310    3               call WRITE_CONTINUATION( VM_HEADER.TO$->BSD, 35, '1'b );

  11310 13 000215   000000 470400 xsym               LDP0    VM_HEADER$
        13 000216   000031 471500                    LDP1    25,,PR0
        13 000217   000010 236000 14                 LDQ     8
        13 000220   201136 756100                    STQ     @QUOTES+1,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:124  
        13 000221   000026 237000 14                 LDAQ    22
        13 000222   201134 757100                    STAQ    @STRING+1,,AUTO
        13 000223   201133 451500                    STP1    FMT_STR_LEN+2,,AUTO
        13 000224   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 000225   000000 011000                    NOP     0

      713    11311    3           END;

      714    11312    2       END;

  11312 13 000226   000235 710000 13                 TRA     REPLY_TO

      715    11313    2       ELSE DO;

      716    11314    2           CALL DISPLAY_ADDREC(%VM_TYPE_TO, MESSAGE_NUMBER);

  11314 13 000227   200003 236100                    LDQ     @MESSAGE_NUMBER,,AUTO
        13 000230   201130 756100                    STQ     @TYPE+1,,AUTO
        13 000231   000031 236000 14                 LDQ     25
        13 000232   201127 756100                    STQ     SITENAME+4,,AUTO
        13 000233   003242 701000 13                 TSX1    DISPLAY_ADDREC
        13 000234   000000 011000                    NOP     0

      717    11315    2       END;

      718    11316
      719    11317        /*
      720    11318             ***** Reply to: ...
      721    11319             ***** Display reply to only if reply to different than sender.
      722    11320        */
      723    11321    1   REPLY_TO:
      724    11322    1       IF VM_HEADER.REPLY_TO$ ~= ADDR(NIL)

  11322 13 000235   000000 470400 xsym  REPLY_TO     LDP0    VM_HEADER$
        13 000236   000025 236100                    LDQ     21,,PR0
        13 000237   000010 116000 14                 CMPQ    8
        13 000240   000553 600000 13                 TZE     PRINT_SUBJECT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:125  

      725    11323    1       THEN
      726    11324    2       DO;

      727    11325    2           CALL INDEX (INDX,',',VM_HEADER.REPLY_TO$ -> X$STRING.TEXT)

  11325 13 000241   000025 471500                    LDP1    21,,PR0
        13 000242   000100 101500                    MRL     fill='000'O
        13 000243   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000244   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000245   201156 220100                    LDX0    I+2,,AUTO
        13 000246   000000 124540                    SCM     mask='000'O
        13 000247   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        13 000250   000032 000001 14                 ADSC9   26                       cn=0,n=1
        13 000251   200027 000100                    ARG     INDX,,AUTO
        13 000252   000254 606400 13                 TTN     s:11329

      728    11326    3           WHENRETURN DO;

      729    11327    3               GOTO PRINT_REPLYTO; /* Print if multiple addresses */

  11327 13 000253   000517 710000 13                 TRA     PRINT_REPLYTO

      730    11328    3           END;
      731    11329    2          CALL XLATE (TEMPBUF1,LOWER_UPPER,SUBSTR(VM_HEADER.REPLY_TO$ -> X$STRING.TEXT
             11329                    ,0,VM_HEADER.REPLY_TO$ -> X$STRING.SIZ));

  11329 13 000254   000000 470400 xsym               LDP0    VM_HEADER$
        13 000255   000025 471500                    LDP1    21,,PR0
        13 000256   000100 101500                    MRL     fill='000'O
        13 000257   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000260   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000261   201156 220100                    LDX0    I+2,,AUTO
        13 000262   000025 473500                    LDP3    21,,PR0
        13 000263   000100 101500                    MRL     fill='000'O
        13 000264   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 000265   201157 000002                    ADSC9   I+3,,AUTO                cn=0,n=2
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:126  
        13 000266   201157 221100                    LDX1    I+3,,AUTO
        13 000267   000000 473400 xsym               LDP3    B$XL_UPPER$
        13 000270   040000 160540                    MVT     fill='040'O
        13 000271   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 000272   000400 000400 11                 ADSC9   TEMPBUF1                 cn=0,n=256
        13 000273   300000 000100                    ARG     0,,PR3

      732    11330        /*
      733    11331            *****      Remove blanks preceding the @ so valid comparison made.
      734    11332        */
      735    11333    2           CALL INDEX1R (INDX,'@',VM_HEADER.REPLY_TO$ -> X$STRING.TEXT)

  11333 13 000274   000025 471500                    LDP1    21,,PR0
        13 000275   000100 101500                    MRL     fill='000'O
        13 000276   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000277   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000300   201156 220100                    LDX0    I+2,,AUTO
        13 000301   000000 636010                    EAQ     0,X0
        13 000302   000022 772000                    QRL     18
        13 000303   000000 125540                    SCMR    mask='000'O
        13 000304   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        13 000305   000015 000001 14                 ADSC9   13                       cn=0,n=1
        13 000306   200027 000100                    ARG     INDX,,AUTO
        13 000307   000454 606400 13                 TTN     s:11354
        13 000310   200027 054100                    AOS     INDX,,AUTO
        13 000311   200027 156100                    SSQ     INDX,,AUTO

      736    11334    3           WHENRETURN DO;

      737    11335    3               LEN = VM_HEADER.REPLY_TO$ -> X$STRING.SIZ - INDX;

  11335 13 000312   000025 471500                    LDP1    21,,PR0
        13 000313   000100 101500                    MRL     fill='000'O
        13 000314   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000315   201156 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
        13 000316   201156 236100                    LDQ     I+2,,AUTO
        13 000317   200027 136100                    SBLQ    INDX,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:127  
        13 000320   200026 756100                    STQ     LEN,,AUTO

      738    11336    3               TEMPBUF = SUBSTR(TEMPBUF1,INDX,LEN);

  11336 13 000321   000000 620006                    EAX0    0,QL
        13 000322   200027 235100                    LDA     INDX,,AUTO
        13 000323   040000 100445                    MLR     fill='040'O
        13 000324   000400 000010 11                 ADSC9   TEMPBUF1,A               cn=0,n=*X0
        13 000325   000200 001000 11                 ADSC9   TEMPBUF                  cn=0,n=512

      739    11337    4              DO WHILE (SUBSTR(VM_HEADER.REPLY_TO$ -> X$STRING.TEXT, INDX-1,1) = ' ');

  11337 13 000326   000341 710000 13                 TRA     s:11340

      740    11338    4                   CALL INSERT (TEMPBUF1,INDX-1,,SUBSTR(TEMPBUF,0,LEN));

  11338 13 000327   200027 720100                    LXL0    INDX,,AUTO
        13 000330   777376 620010                    EAX0    -258,X0
        13 000331   777777 660003                    ERX0    -1,DU
        13 000332   200026 721100                    LXL1    LEN,,AUTO
        13 000333   200027 235100                    LDA     INDX,,AUTO
        13 000334   040045 100440                    MLR     fill='040'O
        13 000335   000200 000011 11                 ADSC9   TEMPBUF                  cn=0,n=*X1
        13 000336   000377 600010 11                 ADSC9   TEMPBUF+127,A            cn=3,n=*X0

      741    11339    4                   INDX = INDX -1;

  11339 13 000337   000001 336007                    LCQ     1,DL
        13 000340   200027 056100                    ASQ     INDX,,AUTO

      742    11340    4               END;

  11340 13 000341   000000 470400 xsym               LDP0    VM_HEADER$
        13 000342   000025 471500                    LDP1    21,,PR0
        13 000343   000100 101500                    MRL     fill='000'O
        13 000344   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000345   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:128  
        13 000346   201156 220100                    LDX0    I+2,,AUTO
        13 000347   200027 235100                    LDA     INDX,,AUTO
        13 000350   040000 106505                    CMPC    fill='040'O
        13 000351   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
        13 000352   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000353   000327 600000 13                 TZE     s:11338

      743    11341    3              CALL XLATE (TEMPBUF,LOWER_UPPER,SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,
             11341                        0, VM_HEADER.FROM$ -> X$STRING.SIZ));

  11341 13 000354   000023 471500                    LDP1    19,,PR0
        13 000355   000100 101500                    MRL     fill='000'O
        13 000356   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000357   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000360   201156 220100                    LDX0    I+2,,AUTO
        13 000361   000023 473500                    LDP3    19,,PR0
        13 000362   000100 101500                    MRL     fill='000'O
        13 000363   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 000364   201157 000002                    ADSC9   I+3,,AUTO                cn=0,n=2
        13 000365   201157 221100                    LDX1    I+3,,AUTO
        13 000366   000000 473400 xsym               LDP3    B$XL_UPPER$
        13 000367   040000 160540                    MVT     fill='040'O
        13 000370   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 000371   000200 001000 11                 ADSC9   TEMPBUF                  cn=0,n=512
        13 000372   300000 000100                    ARG     0,,PR3

      744    11342
      745    11343    3               CALL INDEX1R (INDX,'@',VM_HEADER.FROM$ -> X$STRING.TEXT)

  11343 13 000373   000023 471500                    LDP1    19,,PR0
        13 000374   000100 101500                    MRL     fill='000'O
        13 000375   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000376   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000377   201156 220100                    LDX0    I+2,,AUTO
        13 000400   000000 636010                    EAQ     0,X0
        13 000401   000022 772000                    QRL     18
        13 000402   000000 125540                    SCMR    mask='000'O
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:129  
        13 000403   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        13 000404   000015 000001 14                 ADSC9   13                       cn=0,n=1
        13 000405   200027 000100                    ARG     INDX,,AUTO
        13 000406   000453 606400 13                 TTN     s:11352
        13 000407   200027 054100                    AOS     INDX,,AUTO
        13 000410   200027 156100                    SSQ     INDX,,AUTO

      746    11344    4               WHENRETURN DO;

      747    11345    4                   LEN = VM_HEADER.FROM$ -> X$STRING.SIZ - INDX;

  11345 13 000411   000023 471500                    LDP1    19,,PR0
        13 000412   000100 101500                    MRL     fill='000'O
        13 000413   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000414   201156 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
        13 000415   201156 236100                    LDQ     I+2,,AUTO
        13 000416   200027 136100                    SBLQ    INDX,,AUTO
        13 000417   200026 756100                    STQ     LEN,,AUTO

      748    11346    4                   TEMPBUF2 = SUBSTR(TEMPBUF,INDX,LEN);

  11346 13 000420   000000 620006                    EAX0    0,QL
        13 000421   200027 235100                    LDA     INDX,,AUTO
        13 000422   040000 100445                    MLR     fill='040'O
        13 000423   000200 000010 11                 ADSC9   TEMPBUF,A                cn=0,n=*X0
        13 000424   000500 000400 11                 ADSC9   TEMPBUF2                 cn=0,n=256

      749    11347    5                  DO WHILE (SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT, INDX-1,1) = ' ');

  11347 13 000425   000440 710000 13                 TRA     s:11350

      750    11348    5                       CALL INSERT (TEMPBUF,INDX-1,,SUBSTR(TEMPBUF2,0,LEN));

  11348 13 000426   200027 720100                    LXL0    INDX,,AUTO
        13 000427   776776 620010                    EAX0    -514,X0
        13 000430   777777 660003                    ERX0    -1,DU
        13 000431   200026 721100                    LXL1    LEN,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:130  
        13 000432   200027 235100                    LDA     INDX,,AUTO
        13 000433   040045 100440                    MLR     fill='040'O
        13 000434   000500 000011 11                 ADSC9   TEMPBUF2                 cn=0,n=*X1
        13 000435   000177 600010 11                 ADSC9   VECT_ARRAY+13,A          cn=3,n=*X0

      751    11349    5                       INDX = INDX -1;

  11349 13 000436   000001 336007                    LCQ     1,DL
        13 000437   200027 056100                    ASQ     INDX,,AUTO

      752    11350    5                   END;

  11350 13 000440   000000 470400 xsym               LDP0    VM_HEADER$
        13 000441   000023 471500                    LDP1    19,,PR0
        13 000442   000100 101500                    MRL     fill='000'O
        13 000443   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000444   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000445   201156 220100                    LDX0    I+2,,AUTO
        13 000446   200027 235100                    LDA     INDX,,AUTO
        13 000447   040000 106505                    CMPC    fill='040'O
        13 000450   100000 000001                    ADSC9   0,A,PR1                  cn=0,n=1
        13 000451   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000452   000426 600000 13                 TZE     s:11348

      753    11351    4               END;

      754    11352    3           END;

  11352 13 000453   000513 710000 13                 TRA     s:11357

      755    11353    3           WHENALTRETURN DO;     /* Remove site name from address */

      756    11354    3               CALL INDEX1R (INDX,'@',SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,0,
             11354                        VM_HEADER.FROM$ -> X$STRING.SIZ));

  11354 13 000454   000000 470400 xsym               LDP0    VM_HEADER$
        13 000455   000023 471500                    LDP1    19,,PR0
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:131  
        13 000456   000100 101500                    MRL     fill='000'O
        13 000457   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000460   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000461   201156 220100                    LDX0    I+2,,AUTO
        13 000462   000023 473500                    LDP3    19,,PR0
        13 000463   000100 101500                    MRL     fill='000'O
        13 000464   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 000465   201157 000002                    ADSC9   I+3,,AUTO                cn=0,n=2
        13 000466   201157 221100                    LDX1    I+3,,AUTO
        13 000467   000000 636011                    EAQ     0,X1
        13 000470   000022 772000                    QRL     18
        13 000471   000000 125540                    SCMR    mask='000'O
        13 000472   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 000473   000015 000001 14                 ADSC9   13                       cn=0,n=1
        13 000474   200027 000100                    ARG     INDX,,AUTO
        13 000475   000500 606400 13                 TTN     s:11355
        13 000476   200027 054100                    AOS     INDX,,AUTO
        13 000477   200027 156100                    SSQ     INDX,,AUTO

      757    11355    3              CALL XLATE (TEMPBUF,LOWER_UPPER,SUBSTR(VM_HEADER.FROM$ -> X$STRING.TEXT,
             11355                        0,INDX));

  11355 13 000500   000023 471500                    LDP1    19,,PR0
        13 000501   000100 101500                    MRL     fill='000'O
        13 000502   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 000503   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 000504   201156 220100                    LDX0    I+2,,AUTO
        13 000505   200027 721100                    LXL1    INDX,,AUTO
        13 000506   000000 473400 xsym               LDP3    B$XL_UPPER$
        13 000507   040000 160540                    MVT     fill='040'O
        13 000510   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 000511   000200 001000 11                 ADSC9   TEMPBUF                  cn=0,n=512
        13 000512   300000 000100                    ARG     0,,PR3

      758    11356    3           END;

      759    11357    2           IF TEMPBUF = TEMPBUF1
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:132  

  11357 13 000513   040000 106400                    CMPC    fill='040'O
        13 000514   000200 001000 11                 ADSC9   TEMPBUF                  cn=0,n=512
        13 000515   000400 000400 11                 ADSC9   TEMPBUF1                 cn=0,n=256
        13 000516   000553 600000 13                 TZE     PRINT_SUBJECT

      760    11358    2           THEN                  /* Dont bother */
      761    11359    2               GOTO PRINT_SUBJECT;
      762    11360        /**/
      763    11361    2   PRINT_REPLYTO:
      764    11362    2           F_FDS.NVECS# = 1;

  11362 13 000517   000001 235007       PRINT_REPLY* LDA     1,DL
        13 000520   000063 755000 11                 STA     F_FDS+9

      765    11363                %INIT_STR(STR=VM_REPLY_TO_FMT, CODE=E_REPLY_TO_FMT, TEST=YES, VECT=
             11363                    "F_FDS.FMT_");

  11370 13 000521   000000 236000 xsym               LDQ     VM_REPLY_TO_FMT
        13 000522   000033 772000                    QRL     27
        13 000523   000000 620006                    EAX0    0,QL
        13 000524   040000 106440                    CMPC    fill='040'O
        13 000525   000000 200010 xsym               ADSC9   VM_REPLY_TO_FMT          cn=1,n=*X0
        13 000526   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000527   000535 601000 13                 TNZ     s:11375

  11372 13 000530   000033 630400 14                 EPPR0   27
        13 000531   000003 631400 14                 EPPR1   3
        13 000532   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000533   000000 011000                    NOP     0

  11373 13 000534   000542 710000 13                 TRA     s:11386

  11375 13 000535   000000 635010                    EAA     0,X0
        13 000536   000002 771000                    ARL     2
        13 000537   000140 135007                    SBLA    96,DL
        13 000540   000036 236000 14                 LDQ     30
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:133  
        13 000541   000052 757000 11                 STAQ    F_FDS

      766    11386    2           call WRITE_CONTINUATION( VM_HEADER.REPLY_TO$->BSD, 70, '1'b );

  11386 13 000542   000000 470400 xsym               LDP0    VM_HEADER$
        13 000543   000025 471500                    LDP1    21,,PR0
        13 000544   000010 236000 14                 LDQ     8
        13 000545   201136 756100                    STQ     @QUOTES+1,,AUTO
        13 000546   000040 237000 14                 LDAQ    32
        13 000547   201134 757100                    STAQ    @STRING+1,,AUTO
        13 000550   201133 451500                    STP1    FMT_STR_LEN+2,,AUTO
        13 000551   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 000552   000000 011000                    NOP     0

      767    11387    2       END;

      768    11388
      769    11389        /*
      770    11390             ***** Subject: ...
      771    11391        */
      772    11392    1   PRINT_SUBJECT:
      773    11393    1       if VM_HEADER.SUBJECT$ ~= addr(nil) then

  11393 13 000553   000000 470400 xsym  PRINT_SUBJE* LDP0    VM_HEADER$
        13 000554   000030 236100                    LDQ     24,,PR0
        13 000555   000010 116000 14                 CMPQ    8
        13 000556   000613 600000 13                 TZE     s:11424

      774    11394    2       do;

      775    11395    2           F_FDS.NVECS# = 1;

  11395 13 000557   000001 235007                    LDA     1,DL
        13 000560   000063 755000 11                 STA     F_FDS+9

      776    11396                %INIT_STR(STR=VM_SUBJECT_FMT, CODE=E_SUBJECT_FMT, TEST=YES, VECT=
             11396                    "F_FDS.FMT_");
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:134  

  11403 13 000561   000000 236000 xsym               LDQ     VM_SUBJECT_FMT
        13 000562   000033 772000                    QRL     27
        13 000563   000000 620006                    EAX0    0,QL
        13 000564   040000 106440                    CMPC    fill='040'O
        13 000565   000000 200010 xsym               ADSC9   VM_SUBJECT_FMT           cn=1,n=*X0
        13 000566   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000567   000575 601000 13                 TNZ     s:11408

  11405 13 000570   000042 630400 14                 EPPR0   34
        13 000571   000003 631400 14                 EPPR1   3
        13 000572   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000573   000000 011000                    NOP     0

  11406 13 000574   000602 710000 13                 TRA     s:11419

  11408 13 000575   000000 635010                    EAA     0,X0
        13 000576   000002 771000                    ARL     2
        13 000577   000140 135007                    SBLA    96,DL
        13 000600   000045 236000 14                 LDQ     37
        13 000601   000052 757000 11                 STAQ    F_FDS

      777    11419    2           call WRITE_CONTINUATION( VM_HEADER.SUBJECT$->BSD, 70 );

  11419 13 000602   000000 470400 xsym               LDP0    VM_HEADER$
        13 000603   000030 471500                    LDP1    24,,PR0
        13 000604   000010 236000 14                 LDQ     8
        13 000605   201136 756100                    STQ     @QUOTES+1,,AUTO
        13 000606   000040 235000 14                 LDA     32
        13 000607   201134 757100                    STAQ    @STRING+1,,AUTO
        13 000610   201133 451500                    STP1    FMT_STR_LEN+2,,AUTO
        13 000611   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 000612   000000 011000                    NOP     0

      778    11420    2       end;

      779    11421        /*
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:135  
      780    11422             ***** Re: ...
      781    11423        */
      782    11424    1       REFERENCE_ID = -1;

  11424 13 000613   000001 335007                    LCA     1,DL
        13 000614   200031 755100                    STA     REFERENCE_ID,,AUTO

      783    11425    1       IF VM_HEADER.REFERS_TO_ID$ ~= ADDR(NIL)

  11425 13 000615   000000 470400 xsym               LDP0    VM_HEADER$
        13 000616   000033 236100                    LDQ     27,,PR0
        13 000617   000010 116000 14                 CMPQ    8
        13 000620   000633 600000 13                 TZE     s:11428

      784    11426    1       THEN
      785    11427    1           CALL VMD$GET_ID (VM_HEADER.REFERS_TO_ID$ -> BASED_TEXTC, MAIL_DCB#,
             11427                    REFERENCE_ID);

  11427 13 000621   000033 471500                    LDP1    27,,PR0
        13 000622   200031 633500                    EPPR3   REFERENCE_ID,,AUTO
        13 000623   201160 453500                    STP3    I+4,,AUTO
        13 000624   200005 236100                    LDQ     @MAIL_DCB#,,AUTO
        13 000625   201157 756100                    STQ     I+3,,AUTO
        13 000626   201156 451500                    STP1    I+2,,AUTO
        13 000627   201156 630500                    EPPR0   I+2,,AUTO
        13 000630   000003 631400 14                 EPPR1   3
        13 000631   000000 701000 xent               TSX1    VMD$GET_ID
        13 000632   000000 011000                    NOP     0

      786    11428    1       IF VM_HEADER.REFERENCE$ ~= ADDR(NIL) OR REFERENCE_ID ~= -1

  11428 13 000633   000000 470400 xsym               LDP0    VM_HEADER$
        13 000634   000024 236100                    LDQ     20,,PR0
        13 000635   000010 116000 14                 CMPQ    8
        13 000636   000642 601000 13                 TNZ     s:11430
        13 000637   200031 235100                    LDA     REFERENCE_ID,,AUTO
        13 000640   000046 115000 14                 CMPA    38
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:136  
        13 000641   001017 600000 13                 TZE     s:11524

      787    11429    2       THEN DO;

      788    11430    2           IF REFERENCE_ID = -1

  11430 13 000642   200031 235100                    LDA     REFERENCE_ID,,AUTO
        13 000643   000046 115000 14                 CMPA    38
        13 000644   000672 601000 13                 TNZ     s:11459

      789    11431    3           THEN DO;

      790    11432    3               F_FDS.NVECS# = 1;

  11432 13 000645   000001 235007                    LDA     1,DL
        13 000646   000063 755000 11                 STA     F_FDS+9

      791    11433                    %INIT_STR(STR=VM_REFERENCE_FMT, CODE=E_REFERENCE_FMT, TEST=YES, VECT=
             11433                        "F_FDS.FMT_");

  11440 13 000647   000000 236000 xsym               LDQ     VM_REFERENCE_FMT
        13 000650   000033 772000                    QRL     27
        13 000651   000000 620006                    EAX0    0,QL
        13 000652   040000 106440                    CMPC    fill='040'O
        13 000653   000000 200010 xsym               ADSC9   VM_REFERENCE_FMT         cn=1,n=*X0
        13 000654   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000655   000663 601000 13                 TNZ     s:11445

  11442 13 000656   000047 630400 14                 EPPR0   39
        13 000657   000003 631400 14                 EPPR1   3
        13 000660   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000661   000000 011000                    NOP     0

  11443 13 000662   000670 710000 13                 TRA     s:11456

  11445 13 000663   000000 635010                    EAA     0,X0
        13 000664   000002 771000                    ARL     2
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:137  
        13 000665   000140 135007                    SBLA    96,DL
        13 000666   000052 236000 14                 LDQ     42
        13 000667   000052 757000 11                 STAQ    F_FDS

      792    11456    3               INDX1 = 0;

  11456 13 000670   200030 450100                    STZ     INDX1,,AUTO

      793    11457    3           END;

  11457 13 000671   000770 710000 13                 TRA     s:11516

      794    11458    3           ELSE DO;

      795    11459    3               F_FDS.NVECS# = 3;

  11459 13 000672   000003 235007                    LDA     3,DL
        13 000673   000063 755000 11                 STA     F_FDS+9

      796    11460                   %INIT_STR(STR=VM_REFERENCE_AND_ID_FMT, CODE=E_REFERENCE_AND_ID_FMT, TEST
             11460                        =YES, VECT="F_FDS.FMT_");

  11467 13 000674   000000 236000 xsym               LDQ     VM_REFERENCE_AND_ID_FMT
        13 000675   000033 772000                    QRL     27
        13 000676   000000 620006                    EAX0    0,QL
        13 000677   040000 106440                    CMPC    fill='040'O
        13 000700   000000 200010 xsym               ADSC9   VM_REFERENCE_AND_ID_FMT  cn=1,n=*X0
        13 000701   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000702   000710 601000 13                 TNZ     s:11472

  11469 13 000703   000053 630400 14                 EPPR0   43
        13 000704   000003 631400 14                 EPPR1   3
        13 000705   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000706   000000 011000                    NOP     0

  11470 13 000707   000715 710000 13                 TRA     s:11490

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:138  
  11472 13 000710   000000 635010                    EAA     0,X0
        13 000711   000002 771000                    ARL     2
        13 000712   000140 135007                    SBLA    96,DL
        13 000713   000056 236000 14                 LDQ     46
        13 000714   000052 757000 11                 STAQ    F_FDS

      797    11483                    %INIT_STR(STR=VM_RE_STRING, CODE=E_RE_STRING, TEST=YES);

  11490 13 000715   000000 236000 xsym               LDQ     VM_RE_STRING
        13 000716   000033 772000                    QRL     27
        13 000717   000000 620006                    EAX0    0,QL
        13 000720   040000 106440                    CMPC    fill='040'O
        13 000721   000000 200010 xsym               ADSC9   VM_RE_STRING             cn=1,n=*X0
        13 000722   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 000723   000730 601000 13                 TNZ     s:11506

  11492 13 000724   000060 630400 14                 EPPR0   48
        13 000725   000057 631400 14                 EPPR1   47
        13 000726   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000727   000000 011000                    NOP     0

      798    11506    3               DUMMY = MINIMUM(REFERENCE_ID,9999);

  11506 13 000730   023417 236007                    LDQ     9999,DL
        13 000731   000734 604000 13                 TMI     s:11506+4
        13 000732   200031 116100                    CMPQ    REFERENCE_ID,,AUTO
        13 000733   000735 604400 13                 TMOZ    s:11506+5
        13 000734   200031 236100                    LDQ     REFERENCE_ID,,AUTO
        13 000735   200032 756100                    STQ     DUMMY,,AUTO

      799    11507    3               INDX1 = 0;

  11507 13 000736   200030 450100                    STZ     INDX1,,AUTO

      800    11508    4               DO WHILE DUMMY >= 10;

  11508 13 000737   000012 116007                    CMPQ    10,DL
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:139  
        13 000740   000747 604000 13                 TMI     s:11512

      801    11509    4                   INDX1 = INDX1 + 1;

  11509 13 000741   200030 054100                    AOS     INDX1,,AUTO

      802    11510    4                   DUMMY = DUMMY / 10;

  11510 13 000742   200032 236100                    LDQ     DUMMY,,AUTO
        13 000743   000012 506007                    DIV     10,DL
        13 000744   200032 756100                    STQ     DUMMY,,AUTO

      803    11511    4               END;

  11511 13 000745   000012 116007                    CMPQ    10,DL
        13 000746   000741 605000 13                 TPL     s:11509

      804    11512    3               VECT_ARRAY(0) = vector (substr(VM_RE_STRING.NAME#, INDX1, VM_RE_STRING.
             11512                        L# - INDX1));

  11512 13 000747   000000 236000 xsym               LDQ     VM_RE_STRING
        13 000750   000033 772000                    QRL     27
        13 000751   000000 620006                    EAX0    0,QL
        13 000752   200030 136100                    SBLQ    INDX1,,AUTO
        13 000753   000064 737000                    LLS     52
        13 000754   000140 135007                    SBLA    96,DL
        13 000755   200030 236100                    LDQ     INDX1,,AUTO
        13 000756   000020 736000                    QLS     16
        13 000757   000062 036000 14                 ADLQ    50
        13 000760   000162 757000 11                 STAQ    VECT_ARRAY

      805    11513    3               VECT_ARRAY(1) = VECTOR (REFERENCE_ID);

  11513 13 000761   777640 235007                    LDA     -96,DL
        13 000762   201156 452500                    STP2    I+2,,AUTO
        13 000763   201156 236100                    LDQ     I+2,,AUTO
        13 000764   000031 036003                    ADLQ    25,DU
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:140  
        13 000765   000164 757000 11                 STAQ    VECT_ARRAY+2

      806    11514    3               INDX1 = 2;

  11514 13 000766   000002 235007                    LDA     2,DL
        13 000767   200030 755100                    STA     INDX1,,AUTO

      807    11515    3           END;

      808    11516    2           if VM_HEADER.REFERENCE$ = addr(nil)

  11516 13 000770   000000 470400 xsym               LDP0    VM_HEADER$
        13 000771   000024 236100                    LDQ     20,,PR0
        13 000772   000010 116000 14                 CMPQ    8
        13 000773   001006 601000 13                 TNZ     s:11518

      809    11517    2           then call WRITE_CONTINUATION( SPACEC, 70,, INDX1 );

  11517 13 000774   200030 631500                    EPPR1   INDX1,,AUTO
        13 000775   201136 451500                    STP1    @QUOTES+1,,AUTO
        13 000776   000010 236000 14                 LDQ     8
        13 000777   000040 235000 14                 LDA     32
        13 001000   201134 757100                    STAQ    @STRING+1,,AUTO
        13 001001   000063 236000 14                 LDQ     51
        13 001002   201133 756100                    STQ     FMT_STR_LEN+2,,AUTO
        13 001003   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 001004   000000 011000                    NOP     0
        13 001005   001017 710000 13                 TRA     s:11524

      810    11518    2           else call WRITE_CONTINUATION( VM_HEADER.REFERENCE$->BSD, 70,, INDX1 );

  11518 13 001006   000024 471500                    LDP1    20,,PR0
        13 001007   200030 633500                    EPPR3   INDX1,,AUTO
        13 001010   201136 453500                    STP3    @QUOTES+1,,AUTO
        13 001011   000010 236000 14                 LDQ     8
        13 001012   000040 235000 14                 LDA     32
        13 001013   201134 757100                    STAQ    @STRING+1,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:141  
        13 001014   201133 451500                    STP1    FMT_STR_LEN+2,,AUTO
        13 001015   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 001016   000000 011000                    NOP     0

      811    11519    2       END;

      812    11520
      813    11521        /*
      814    11522             ***** C: ...
      815    11523        */
      816    11524    1       IF VM_HEADER.COPY$ ~= ADDR(NIL)

  11524 13 001017   000000 470400 xsym               LDP0    VM_HEADER$
        13 001020   000021 236100                    LDQ     17,,PR0
        13 001021   000010 116000 14                 CMPQ    8
        13 001022   001072 600000 13                 TZE     NO_C

      817    11525    1       THEN
      818    11526    2       DO;

      819    11527    3           IF VM_PROFILE.OPT.EXT_ADDR_DISP = %NO# THEN DO;

  11527 13 001023   000000 471400 xsym               LDP1    VM_PROFILE$
        13 001024   100001 236100                    LDQ     1,,PR1
        13 001025   100000 316003                    CANQ    32768,DU
        13 001026   001064 601000 13                 TNZ     s:11555

      820    11528                   %INIT_STR(STR=VM_COPY_FMT, CODE=E_COPY_FMT, TEST=YES, VECT="F_FDS.FMT_")
             11528                        ;

  11535 13 001027   000000 236000 xsym               LDQ     VM_COPY_FMT
        13 001030   000033 772000                    QRL     27
        13 001031   000000 620006                    EAX0    0,QL
        13 001032   040000 106440                    CMPC    fill='040'O
        13 001033   000000 200010 xsym               ADSC9   VM_COPY_FMT              cn=1,n=*X0
        13 001034   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 001035   001043 601000 13                 TNZ     s:11540
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:142  

  11537 13 001036   000064 630400 14                 EPPR0   52
        13 001037   000003 631400 14                 EPPR1   3
        13 001040   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001041   000000 011000                    NOP     0

  11538 13 001042   001050 710000 13                 TRA     s:11551

  11540 13 001043   000000 635010                    EAA     0,X0
        13 001044   000002 771000                    ARL     2
        13 001045   000140 135007                    SBLA    96,DL
        13 001046   000067 236000 14                 LDQ     55
        13 001047   000052 757000 11                 STAQ    F_FDS

      821    11551    3               F_FDS.NVECS# = 1;

  11551 13 001050   000001 235007                    LDA     1,DL
        13 001051   000063 755000 11                 STA     F_FDS+9

      822    11552    3               call WRITE_CONTINUATION( VM_HEADER.COPY$->BSD, 70, '1'b );

  11552 13 001052   000000 470400 xsym               LDP0    VM_HEADER$
        13 001053   000021 471500                    LDP1    17,,PR0
        13 001054   000010 236000 14                 LDQ     8
        13 001055   201136 756100                    STQ     @QUOTES+1,,AUTO
        13 001056   000040 237000 14                 LDAQ    32
        13 001057   201134 757100                    STAQ    @STRING+1,,AUTO
        13 001060   201133 451500                    STP1    FMT_STR_LEN+2,,AUTO
        13 001061   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 001062   000000 011000                    NOP     0

      823    11553    3           END;

  11553 13 001063   001072 710000 13                 TRA     NO_C

      824    11554    2           ELSE
      825    11555    2               CALL DISPLAY_ADDREC(%VM_TYPE_C,MESSAGE_NUMBER);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:143  

  11555 13 001064   200003 236100                    LDQ     @MESSAGE_NUMBER,,AUTO
        13 001065   201130 756100                    STQ     @TYPE+1,,AUTO
        13 001066   000071 236000 14                 LDQ     57
        13 001067   201127 756100                    STQ     SITENAME+4,,AUTO
        13 001070   003242 701000 13                 TSX1    DISPLAY_ADDREC
        13 001071   000000 011000                    NOP     0

      826    11556    2       END;

      827    11557    1   NO_C : ;

  11557 13 001072                       NO_C         null
      828    11558        /*
      829    11559             ***** Bc: ...
      830    11560        */
      831    11561    1       IF VM_HEADER.BLIND$ ~= ADDR(NIL)

  11561 13 001072   000000 470400 xsym               LDP0    VM_HEADER$
        13 001073   000020 236100                    LDQ     16,,PR0
        13 001074   000010 116000 14                 CMPQ    8
        13 001075   001145 600000 13                 TZE     NO_BC

      832    11562    1       THEN
      833    11563    2       DO;

      834    11564    3           IF VM_PROFILE.OPT.EXT_ADDR_DISP = %NO# THEN DO;

  11564 13 001076   000000 471400 xsym               LDP1    VM_PROFILE$
        13 001077   100001 236100                    LDQ     1,,PR1
        13 001100   100000 316003                    CANQ    32768,DU
        13 001101   001137 601000 13                 TNZ     s:11592

      835    11565                    %INIT_STR(STR=VM_BLIND_COPY_FMT, CODE=E_BLIND_COPY_FMT, TEST=YES, VECT=
             11565                        "F_FDS.FMT_");

  11572 13 001102   000000 236000 xsym               LDQ     VM_BLIND_COPY_FMT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:144  
        13 001103   000033 772000                    QRL     27
        13 001104   000000 620006                    EAX0    0,QL
        13 001105   040000 106440                    CMPC    fill='040'O
        13 001106   000000 200010 xsym               ADSC9   VM_BLIND_COPY_FMT        cn=1,n=*X0
        13 001107   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 001110   001116 601000 13                 TNZ     s:11577

  11574 13 001111   000072 630400 14                 EPPR0   58
        13 001112   000003 631400 14                 EPPR1   3
        13 001113   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001114   000000 011000                    NOP     0

  11575 13 001115   001123 710000 13                 TRA     s:11588

  11577 13 001116   000000 635010                    EAA     0,X0
        13 001117   000002 771000                    ARL     2
        13 001120   000140 135007                    SBLA    96,DL
        13 001121   000075 236000 14                 LDQ     61
        13 001122   000052 757000 11                 STAQ    F_FDS

      836    11588    3               F_FDS.NVECS# = 1;

  11588 13 001123   000001 235007                    LDA     1,DL
        13 001124   000063 755000 11                 STA     F_FDS+9

      837    11589    3               call WRITE_CONTINUATION( VM_HEADER.BLIND$->BSD, 70, '1'b );

  11589 13 001125   000000 470400 xsym               LDP0    VM_HEADER$
        13 001126   000020 471500                    LDP1    16,,PR0
        13 001127   000010 236000 14                 LDQ     8
        13 001130   201136 756100                    STQ     @QUOTES+1,,AUTO
        13 001131   000040 237000 14                 LDAQ    32
        13 001132   201134 757100                    STAQ    @STRING+1,,AUTO
        13 001133   201133 451500                    STP1    FMT_STR_LEN+2,,AUTO
        13 001134   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 001135   000000 011000                    NOP     0

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:145  
      838    11590    3           END;

  11590 13 001136   001145 710000 13                 TRA     NO_BC

      839    11591    2           ELSE
      840    11592    2               CALL DISPLAY_ADDREC(%VM_TYPE_BC,MESSAGE_NUMBER);

  11592 13 001137   200003 236100                    LDQ     @MESSAGE_NUMBER,,AUTO
        13 001140   201130 756100                    STQ     @TYPE+1,,AUTO
        13 001141   000077 236000 14                 LDQ     63
        13 001142   201127 756100                    STQ     SITENAME+4,,AUTO
        13 001143   003242 701000 13                 TSX1    DISPLAY_ADDREC
        13 001144   000000 011000                    NOP     0

      841    11593
      842    11594    2       END;

      843    11595    1   NO_BC:;

  11595 13 001145                       NO_BC        null
      844    11596
      845    11597                                                /* Blank line */
      846    11598        /*
      847    11599             ***** Encl:
      848    11600        */
      849    11601    1       IF VM_HEADER.STATUS.ENCL = %YES# THEN

  11601 13 001145   000000 470400 xsym               LDP0    VM_HEADER$
        13 001146   000012 236100                    LDQ     10,,PR0
        13 001147   004000 316007                    CANQ    2048,DL
        13 001150   001426 600000 13                 TZE     OLD_ENCL

      850    11602    2   DI_ENCL:DO;

  11602 13 001151                       DI_ENCL      null
      851    11603    2          CALL VMA$GET_ADD_RECORD(%VM_TYPE_ENCL,VM_ENCLLIST_,MAIL_DCB#,MESSAGE_NUMBER)

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:146  
  11603 13 001151   200003 236100                    LDQ     @MESSAGE_NUMBER,,AUTO
        13 001152   200005 235100                    LDA     @MAIL_DCB#,,AUTO
        13 001153   201160 757100                    STAQ    I+4,,AUTO
        13 001154   000102 237000 14                 LDAQ    66
        13 001155   201156 757100                    STAQ    I+2,,AUTO
        13 001156   201156 630500                    EPPR0   I+2,,AUTO
        13 001157   000100 631400 14                 EPPR1   64
        13 001160   000000 701000 xent               TSX1    VMA$GET_ADD_RECORD
        13 001161   001163 702000 13                 TSX2    s:11605
        13 001162   001201 710000 13                 TRA     s:11612

      852    11604    3           WHENALTRETURN DO;

      853    11605    4               IF B$TCB.ALT$->B$ALT.ERR.CODE = %E$LD THEN DO;

  11605 13 001163   000000 470400 xsym               LDP0    B$TCB$
        13 001164   000000 471500                    LDP1    0,,PR0
        13 001165   100102 236100                    LDQ     66,,PR1
        13 001166   377770 376007                    ANQ     131064,DL
        13 001167   000070 116007                    CMPQ    56,DL
        13 001170   001426 601000 13                 TNZ     OLD_ENCL

      854    11606    4                   VBOUND(VM_ENCLLIST_) = VBOUND(VM_ENCLLIST_) + PAGESIZE;

  11606 13 001171   000000 236000 xsym               LDQ     VM_ENCLLIST_
        13 001172   000020 772000                    QRL     16
        13 001173   000716 036000 11                 ADLQ    PAGESIZE
        13 001174   000020 736000                    QLS     16
        13 001175   000000 676000 xsym               ERQ     VM_ENCLLIST_
        13 001176   000104 376000 14                 ANQ     68
        13 001177   000000 656000 xsym               ERSQ    VM_ENCLLIST_

      855    11607    4                   GOTO DI_ENCL;

  11607 13 001200   001151 710000 13                 TRA     DI_ENCL

      856    11608    4               END;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:147  
      857    11609    3               ELSE GOTO OLD_ENCL;
      858    11610    3           END;
      859    11611
      860    11612    2           IF ADDR(ENTRY_REASON#) ~= ADDR(NIL) AND

  11612 13 001201   200010 236100                    LDQ     @ENTRY_REASON#,,AUTO
        13 001202   000010 116000 14                 CMPQ    8
        13 001203   001237 600000 13                 TZE     s:11649
        13 001204   200010 470500                    LDP0    @ENTRY_REASON#,,AUTO
        13 001205   000000 235100                    LDA     0,,PR0
        13 001206   000006 115007                    CMPA    6,DL
        13 001207   001237 601000 13                 TNZ     s:11649

      861    11613    3             ENTRY_REASON# = %MAIL_FORWARD_ENCL THEN DO;

      862    11614                    %INIT_STR(STR=VM_ENCL_FWD_FMT, CODE=E_ENCL_FWD_FMT, TEST=YES,VECT=
             11614                        "F_FDS.FMT_");

  11621 13 001210   000000 236000 xsym               LDQ     VM_ENCL_FWD_FMT
        13 001211   000033 772000                    QRL     27
        13 001212   000000 620006                    EAX0    0,QL
        13 001213   040000 106440                    CMPC    fill='040'O
        13 001214   000000 200010 xsym               ADSC9   VM_ENCL_FWD_FMT          cn=1,n=*X0
        13 001215   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 001216   001224 601000 13                 TNZ     s:11626

  11623 13 001217   000105 630400 14                 EPPR0   69
        13 001220   000003 631400 14                 EPPR1   3
        13 001221   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001222   000000 011000                    NOP     0

  11624 13 001223   001231 710000 13                 TRA     s:11637

  11626 13 001224   000000 635010                    EAA     0,X0
        13 001225   000002 771000                    ARL     2
        13 001226   000140 135007                    SBLA    96,DL
        13 001227   000110 236000 14                 LDQ     72
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:148  
        13 001230   000052 757000 11                 STAQ    F_FDS

      863    11637    3               F_FDS.NVECS# = 0;

  11637 13 001231   000063 450000 11                 STZ     F_FDS+9

      864    11638    3               CALL VMD$WRITE_BUF(F_FDS);

  11638 13 001232   000006 630400 14                 EPPR0   6
        13 001233   000000 631400 14                 EPPR1   0
        13 001234   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 001235   000000 011000                    NOP     0

      865    11639    3               EXIT DI_ENCL;

  11639 13 001236   001426 710000 13                 TRA     OLD_ENCL

      866    11640    3           END; /* IF ENTRY_REASON */
      867    11641
      868    11642               %INIT_STR(STR=VM_ENCL_1_FMT, CODE=E_ENCL_1_FMT, TEST=YES,VECT="F_FDS.FMT_");

  11649 13 001237   000000 236000 xsym               LDQ     VM_ENCL_1_FMT
        13 001240   000033 772000                    QRL     27
        13 001241   000000 620006                    EAX0    0,QL
        13 001242   040000 106440                    CMPC    fill='040'O
        13 001243   000000 200010 xsym               ADSC9   VM_ENCL_1_FMT            cn=1,n=*X0
        13 001244   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 001245   001253 601000 13                 TNZ     s:11654

  11651 13 001246   000111 630400 14                 EPPR0   73
        13 001247   000003 631400 14                 EPPR1   3
        13 001250   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001251   000000 011000                    NOP     0

  11652 13 001252   001260 710000 13                 TRA     s:11665

  11654 13 001253   000000 635010                    EAA     0,X0
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:149  
        13 001254   000002 771000                    ARL     2
        13 001255   000140 135007                    SBLA    96,DL
        13 001256   000114 236000 14                 LDQ     76
        13 001257   000052 757000 11                 STAQ    F_FDS

      869    11665    2           F_FDS.NVECS# = 0;

  11665 13 001260   000063 450000 11                 STZ     F_FDS+9

      870    11666    2           CALL VMD$WRITE_BUF (F_FDS);

  11666 13 001261   000006 630400 14                 EPPR0   6
        13 001262   000000 631400 14                 EPPR1   0
        13 001263   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 001264   000000 011000                    NOP     0

      871    11667               %INIT_STR(STR=VM_ENCL_2_FMT, CODE=E_ENCL_2_FMT, TEST=YES,VECT="F_FDS.FMT_");

  11674 13 001265   000000 236000 xsym               LDQ     VM_ENCL_2_FMT
        13 001266   000033 772000                    QRL     27
        13 001267   000000 620006                    EAX0    0,QL
        13 001270   040000 106440                    CMPC    fill='040'O
        13 001271   000000 200010 xsym               ADSC9   VM_ENCL_2_FMT            cn=1,n=*X0
        13 001272   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 001273   001301 601000 13                 TNZ     s:11679

  11676 13 001274   000115 630400 14                 EPPR0   77
        13 001275   000003 631400 14                 EPPR1   3
        13 001276   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001277   000000 011000                    NOP     0

  11677 13 001300   001306 710000 13                 TRA     s:11690

  11679 13 001301   000000 635010                    EAA     0,X0
        13 001302   000002 771000                    ARL     2
        13 001303   000140 135007                    SBLA    96,DL
        13 001304   000120 236000 14                 LDQ     80
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:150  
        13 001305   000052 757000 11                 STAQ    F_FDS

      872    11690    2           ENCL$ = VM_ENCL_HEAD.HEAD$;

  11690 13 001306   000000 470400 xsym               LDP0    VM_ENCLLIST$
        13 001307   000003 236100                    LDQ     3,,PR0
        13 001310   200025 756100                    STQ     ENCL$,,AUTO

      873    11691
      874    11692    3           DO I = 0 TO VM_ENCL_HEAD.NUM_ENTRIES - 1;

  11692 13 001311   200023 450100                    STZ     I,,AUTO
        13 001312   001421 710000 13                 TRA     s:11724+1

      875    11693
      876    11694    3               ENCL_NUM = VM_ENCLOS.TYPE - %VM_TYPE_ENCL;

  11694 13 001313   200025 470500                    LDP0    ENCL$,,AUTO
        13 001314   000012 236100                    LDQ     10,,PR0
        13 001315   000033 772000                    QRL     27
        13 001316   000144 136007                    SBLQ    100,DL
        13 001317   000715 756000 11                 STQ     ENCL_NUM

      877    11695    3               VECT_ARRAY(0) = VECTOR(ENCL_NUM);

  11695 13 001320   000122 237000 14                 LDAQ    82
        13 001321   000162 757000 11                 STAQ    VECT_ARRAY

      878    11696
      879    11697    3               IF VM_ENCLOS.FLAGS.FORWARD = %YES# THEN

  11697 13 001322   000002 236100                    LDQ     2,,PR0
        13 001323   200000 316003                    CANQ    65536,DU
        13 001324   001330 600000 13                 TZE     s:11700

      880    11698    3                   VECT_ARRAY(1) = VECTOR(FWD_FLAG);

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:151  
  11698 13 001325   000124 237000 14                 LDAQ    84
        13 001326   000164 757000 11                 STAQ    VECT_ARRAY+2
        13 001327   001332 710000 13                 TRA     s:11702

      881    11699    3               ELSE
      882    11700    3                   VECT_ARRAY(1) = VECTOR(SPACE);

  11700 13 001330   000126 237000 14                 LDAQ    86
        13 001331   000164 757000 11                 STAQ    VECT_ARRAY+2

      883    11701
      884    11702    3               IF VM_ENCLOS.FLAGS.DELETED = %YES# THEN

  11702 13 001332   000002 234100                    SZN     2,,PR0
        13 001333   001337 605000 13                 TPL     s:11705

      885    11703    3                   VECT_ARRAY(2) = VECTOR(DEL_FLAG);

  11703 13 001334   000130 237000 14                 LDAQ    88
        13 001335   000166 757000 11                 STAQ    VECT_ARRAY+4
        13 001336   001341 710000 13                 TRA     s:11707

      886    11704    3               ELSE
      887    11705    3                   VECT_ARRAY(2) = VECTOR(SPACE);

  11705 13 001337   000126 237000 14                 LDAQ    86
        13 001340   000166 757000 11                 STAQ    VECT_ARRAY+4

      888    11706
      889    11707    3               VECT_ARRAY(3) = VECTOR(VM_ENCLOS.NRECS);

  11707 13 001341   777640 235007                    LDA     -96,DL
        13 001342   200025 236100                    LDQ     ENCL$,,AUTO
        13 001343   000011 036003                    ADLQ    9,DU
        13 001344   000170 757000 11                 STAQ    VECT_ARRAY+6

      890    11708
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:152  
      891    11709    4               IF VM_ENCLOS.TITLE$ = ADDR(NIL) THEN DO;

  11709 13 001345   000013 236100                    LDQ     11,,PR0
        13 001346   000010 116000 14                 CMPQ    8
        13 001347   001372 601000 13                 TNZ     s:11716

      892    11710    4                   TEXTC.COUNT = 1;

  11710 13 001350   001000 236003                    LDQ     512,DU
        13 001351   200035 552140                    STBQ    TEXTC,'40'O,AUTO

      893    11711    4                   TEXTC.TEXT = ' ';

  11711 13 001352   040100 100400                    MLR     fill='040'O
        13 001353   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 001354   200035 200777                    ADSC9   TEXTC,,AUTO              cn=1,n=511

      894    11712    4                   PTR$ = ADDR(TEXTC);

  11712 13 001355   200035 631500                    EPPR1   TEXTC,,AUTO
        13 001356   200024 451500                    STP1    PTR$,,AUTO

      895    11713    4                   VECT_ARRAY(4) = VECTOR(PTR$->BASED_TEXTC);

  11713 13 001357   000100 101500                    MRL     fill='000'O
        13 001360   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 001361   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 001362   201156 220100                    LDX0    I+2,,AUTO
        13 001363   000001 621010                    EAX1    1,X0
        13 001364   000000 635011                    EAA     0,X1
        13 001365   000002 771000                    ARL     2
        13 001366   000140 135007                    SBLA    96,DL
        13 001367   200024 236100                    LDQ     PTR$,,AUTO
        13 001370   000172 757000 11                 STAQ    VECT_ARRAY+8

      896    11714    4               END;

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:153  
  11714 13 001371   001407 710000 13                 TRA     s:11718

      897    11715    3               ELSE
      898    11716    3                   VECT_ARRAY(4) = VECTOR(VM_ENCLOS.TITLE$->BASED_TEXTC);

  11716 13 001372   000013 471500                    LDP1    11,,PR0
        13 001373   000100 101500                    MRL     fill='000'O
        13 001374   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 001375   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 001376   201156 220100                    LDX0    I+2,,AUTO
        13 001377   000001 621010                    EAX1    1,X0
        13 001400   000000 636011                    EAQ     0,X1
        13 001401   000022 772000                    QRL     18
        13 001402   000064 737000                    LLS     52
        13 001403   000140 135007                    SBLA    96,DL
        13 001404   201157 451500                    STP1    I+3,,AUTO
        13 001405   201157 236100                    LDQ     I+3,,AUTO
        13 001406   000172 757000 11                 STAQ    VECT_ARRAY+8

      899    11717
      900    11718    3               F_FDS.NVECS# = 5;

  11718 13 001407   000005 235007                    LDA     5,DL
        13 001410   000063 755000 11                 STA     F_FDS+9

      901    11719
      902    11720    3               CALL VMD$WRITE_BUF (F_FDS);

  11720 13 001411   000006 630400 14                 EPPR0   6
        13 001412   000000 631400 14                 EPPR1   0
        13 001413   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 001414   000000 011000                    NOP     0

      903    11721
      904    11722    3               ENCL$ = VM_ENCLOS.NEXT$;

  11722 13 001415   200025 470500                    LDP0    ENCL$,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:154  
        13 001416   000000 236100                    LDQ     0,,PR0
        13 001417   200025 756100                    STQ     ENCL$,,AUTO

      905    11723
      906    11724    3           END;

  11724 13 001420   200023 054100                    AOS     I,,AUTO
        13 001421   000000 470400 xsym               LDP0    VM_ENCLLIST$
        13 001422   200023 236100                    LDQ     I,,AUTO
        13 001423   001313 604000 13                 TMI     s:11694
        13 001424   000001 116100                    CMPQ    1,,PR0
        13 001425   001313 602000 13                 TNC     s:11694

      907    11725
      908    11726    2       END;

      909    11727        /*
      910    11728             ***** Trace:
      911    11729        */
      912    11730
      913    11731    1   OLD_ENCL:
      914    11732    1       BODY_WRITE.V.DCB# = OUT_DCB#;

  11732 13 001426   200004 470500       OLD_ENCL     LDP0    @OUT_DCB#,,AUTO
        13 001427   000000 720100                    LXL0    0,,PR0
        13 001430   000156 740000 11                 STX0    BODY_WRITE+8

      915    11733    1       F_FDS.FMT_ = VECTOR(BODY_FMT);

  11733 13 001431   000132 237000 14                 LDAQ    90
        13 001432   000052 757000 11                 STAQ    F_FDS

      916    11734    1       F_FDS.NVECS# = 1;

  11734 13 001433   000001 235007                    LDA     1,DL
        13 001434   000063 755000 11                 STA     F_FDS+9

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:155  
      917    11735    1       IF VM_PROFILE.OPT.DISPTRACE OR (ADDR(TRACE)~=ADDR(NIL) AND TRACE)

  11735 13 001435   000000 471400 xsym               LDP1    VM_PROFILE$
        13 001436   100000 236100                    LDQ     0,,PR1
        13 001437   000004 316007                    CANQ    4,DL
        13 001440   001451 601000 13                 TNZ     s:11737
        13 001441   200007 236100                    LDQ     @TRACE,,AUTO
        13 001442   000010 116000 14                 CMPQ    8
        13 001443   001532 600000 13                 TZE     E_TRACE
        13 001444   200007 473500                    LDP3    @TRACE,,AUTO
        13 001445   000000 066500                    CMPB    filb='0'B
        13 001446   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
        13 001447   000134 000022 14                 BDSC    92                       by=0,bit=0,n=18
        13 001450   001532 600000 13                 TZE     E_TRACE

      918    11736    1       THEN
      919    11737    2       DO INDX = 0 TO VM_HEADER.NUM_TRACE_RECORDS - 1;

  11737 13 001451   200027 450100                    STZ     INDX,,AUTO
        13 001452   001525 710000 13                 TRA     s:11748+1

      920    11738    2           VM_BODYREC.VALUE.COUNT = LENGTHC(VM_BODYREC.VALUE.DATA);

  11738 13 001453   000454 235007                    LDA     300,DL
        13 001454   000601 755000 11                 STA     VM_BODYREC+1

      921    11739    2           CALL VMD$GET_TRACE (MESSAGE_NUMBER,MAIL_DCB#,INDX,COUNT,SEED,

  11739 13 001455   000136 236000 14                 LDQ     94
        13 001456   201164 756100                    STQ     I+8,,AUTO
        13 001457   000137 236000 14                 LDQ     95
        13 001460   200006 235100                    LDA     @SEED,,AUTO
        13 001461   201162 757100                    STAQ    I+6,,AUTO
        13 001462   201122 630500                    EPPR0   COUNT,,AUTO
        13 001463   201161 450500                    STP0    I+5,,AUTO
        13 001464   200027 631500                    EPPR1   INDX,,AUTO
        13 001465   201160 451500                    STP1    I+4,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:156  
        13 001466   200005 236100                    LDQ     @MAIL_DCB#,,AUTO
        13 001467   200003 235100                    LDA     @MESSAGE_NUMBER,,AUTO
        13 001470   201156 757100                    STAQ    I+2,,AUTO
        13 001471   201156 630500                    EPPR0   I+2,,AUTO
        13 001472   000135 631400 14                 EPPR1   93
        13 001473   000000 701000 xent               TSX1    VMD$GET_TRACE
        13 001474   001532 702000 13                 TSX2    E_TRACE

      922    11740    2             VM_BODYREC,BODY_WRITE.V.DVBYTE) ALTRET(E_TRACE);
      923    11741    2           CALL CRYPT_CHECK

  11741 13 001475   001655 701000 13                 TSX1    CRYPT_CHECK
        13 001476   001500 702000 13                 TSX2    s:11743
        13 001477   001522 710000 13                 TRA     s:11747

      924    11742    3           WHENALTRETURN DO;

      925    11743    3               CALL VMD$GET_TRACE (MESSAGE_NUMBER,MAIL_DCB#,INDX,COUNT,,

  11743 13 001500   000136 236000 14                 LDQ     94
        13 001501   201164 756100                    STQ     I+8,,AUTO
        13 001502   000137 236000 14                 LDQ     95
        13 001503   000010 235000 14                 LDA     8
        13 001504   201162 757100                    STAQ    I+6,,AUTO
        13 001505   201122 630500                    EPPR0   COUNT,,AUTO
        13 001506   201161 450500                    STP0    I+5,,AUTO
        13 001507   200027 631500                    EPPR1   INDX,,AUTO
        13 001510   201160 451500                    STP1    I+4,,AUTO
        13 001511   200005 236100                    LDQ     @MAIL_DCB#,,AUTO
        13 001512   200003 235100                    LDA     @MESSAGE_NUMBER,,AUTO
        13 001513   201156 757100                    STAQ    I+2,,AUTO
        13 001514   201156 630500                    EPPR0   I+2,,AUTO
        13 001515   000135 631400 14                 EPPR1   93
        13 001516   000000 701000 xent               TSX1    VMD$GET_TRACE
        13 001517   001532 702000 13                 TSX2    E_TRACE

      926    11744    3                 VM_BODYREC,BODY_WRITE.V.DVBYTE) ALTRET(E_TRACE);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:157  
      927    11745    3               CALL CRYPT_CHECK ALTRET(E_CRYPT);

  11745 13 001520   001655 701000 13                 TSX1    CRYPT_CHECK
        13 001521   001654 702000 13                 TSX2    E_CRYPT

      928    11746    3           END;

      929    11747    2           CALL DISPLAY_BODY_RECORD;

  11747 13 001522   002440 701000 13                 TSX1    DISPLAY_BODY_RECORD
        13 001523   000000 011000                    NOP     0

      930    11748    2       END;

  11748 13 001524   200027 054100                    AOS     INDX,,AUTO
        13 001525   000000 470400 xsym               LDP0    VM_HEADER$
        13 001526   200027 236100                    LDQ     INDX,,AUTO
        13 001527   001453 604000 13                 TMI     s:11738
        13 001530   000034 116100                    CMPQ    28,,PR0
        13 001531   001453 602000 13                 TNC     s:11738

      931    11749    1   E_TRACE:
      932    11750
      933    11751    1       CALL VMD$WRITE_BUF (SPACE_LINE);

  11751 13 001532   000001 630400 14    E_TRACE      EPPR0   1
        13 001533   000000 631400 14                 EPPR1   0
        13 001534   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 001535   000000 011000                    NOP     0

      934    11752
      935    11753        /*
      936    11754             ***** If errors then report them ...
      937    11755        */
      938    11756    1       IF VM_HEADER.STATUS.ERR AND VM_HEADER.ERROR ~= '0'B

  11756 13 001536   000000 470400 xsym               LDP0    VM_HEADER$
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:158  
        13 001537   000012 234100                    SZN     10,,PR0
        13 001540   001606 605000 13                 TPL     s:11781
        13 001541   000014 235100                    LDA     12,,PR0
        13 001542   001606 600000 13                 TZE     s:11781

      939    11757    1       THEN
      940    11758    2       DO;

      941    11759    2           CODE = VM_HEADER.ERROR;

  11759 13 001543   000014 236100                    LDQ     12,,PR0
        13 001544   200033 756100                    STQ     CODE,,AUTO

      942    11760    2           UTS = 0;

  11760 13 001545   200034 450100                    STZ     UTS,,AUTO

      943    11761    2           IF VM_HEADER.BAD_ADDRESS$ = ADDR(NIL)

  11761 13 001546   000017 236100                    LDQ     15,,PR0
        13 001547   000010 116000 14                 CMPQ    8
        13 001550   001554 601000 13                 TNZ     s:11765

      944    11762    2           THEN
      945    11763    2               TEXTC.COUNT = 0;

  11763 13 001551   000000 236003                    LDQ     0,DU
        13 001552   200035 552140                    STBQ    TEXTC,'40'O,AUTO
        13 001553   001570 710000 13                 TRA     s:11768

      946    11764    3           ELSE DO;

      947    11765    3               TEXTC.COUNT = VM_HEADER.BAD_ADDRESS$ -> X$STRING.SIZ;

  11765 13 001554   000017 471500                    LDP1    15,,PR0
        13 001555   000100 100500                    MLR     fill='000'O
        13 001556   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:159  
        13 001557   200035 000001                    ADSC9   TEXTC,,AUTO              cn=0,n=1

      948    11766    3               TEXTC.TEXT = VM_HEADER.BAD_ADDRESS$ -> X$STRING.TEXT;

  11766 13 001560   000017 471500                    LDP1    15,,PR0
        13 001561   000100 101500                    MRL     fill='000'O
        13 001562   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 001563   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 001564   201156 220100                    LDX0    I+2,,AUTO
        13 001565   040100 100540                    MLR     fill='040'O
        13 001566   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        13 001567   200035 200777                    ADSC9   TEXTC,,AUTO              cn=1,n=511

      949    11767    3           END;

      950    11768    2           TEXTC2.COUNT = 0;

  11768 13 001570   000000 236003                    LDQ     0,DU
        13 001571   200235 552140                    STBQ    TEXTC2,'40'O,AUTO

      951    11769    2           CALL DISPLAY_ENCODED_ERROR;

  11769 13 001572   001713 701000 13                 TSX1    DISPLAY_ENCODED_ERROR
        13 001573   000000 011000                    NOP     0

      952    11770    2           IF VM_HEADER.NUM_RECORDS > 0

  11770 13 001574   000000 470400 xsym               LDP0    VM_HEADER$
        13 001575   000011 235100                    LDA     9,,PR0
        13 001576   001606 600000 13                 TZE     s:11781

      953    11771    3           THEN DO;

      954    11772    3               F_FDS.NVECS# = 0;

  11772 13 001577   000063 450000 11                 STZ     F_FDS+9

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:160  
      955    11773    3               F_FDS.FMT_ = VECTOR (SPACE);

  11773 13 001600   000126 237000 14                 LDAQ    86
        13 001601   000052 757000 11                 STAQ    F_FDS

      956    11774    3               CALL VMD$WRITE_BUF (F_FDS);

  11774 13 001602   000006 630400 14                 EPPR0   6
        13 001603   000000 631400 14                 EPPR1   0
        13 001604   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 001605   000000 011000                    NOP     0

      957    11775    3           END;

      958    11776    2       END;                       /* Error address */

      959    11777        /*
      960    11778             ***** Body: ...
      961    11779        */
      962    11780
      963    11781    1       BODY_WRITE.V.DCB# = OUT_DCB#;

  11781 13 001606   200004 470500                    LDP0    @OUT_DCB#,,AUTO
        13 001607   000000 720100                    LXL0    0,,PR0
        13 001610   000156 740000 11                 STX0    BODY_WRITE+8

      964    11782    2       DO INDX = 0 TO VM_HEADER.NUM_RECORDS - 1;

  11782 13 001611   200027 450100                    STZ     INDX,,AUTO
        13 001612   001642 710000 13                 TRA     s:11788+1

      965    11783    2           VM_BODYREC.VALUE.COUNT = LENGTHC(VM_BODYREC.VALUE.DATA);

  11783 13 001613   000454 235007                    LDA     300,DL
        13 001614   000601 755000 11                 STA     VM_BODYREC+1

      966    11784    2           CALL VMD$GET_BODY (MESSAGE_NUMBER,MAIL_DCB#,INDX,COUNT,SEED,VM_BODYREC,
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:161  

  11784 13 001615   000136 236000 14                 LDQ     94
        13 001616   201164 756100                    STQ     I+8,,AUTO
        13 001617   000137 236000 14                 LDQ     95
        13 001620   200006 235100                    LDA     @SEED,,AUTO
        13 001621   201162 757100                    STAQ    I+6,,AUTO
        13 001622   201122 630500                    EPPR0   COUNT,,AUTO
        13 001623   201161 450500                    STP0    I+5,,AUTO
        13 001624   200027 631500                    EPPR1   INDX,,AUTO
        13 001625   201160 451500                    STP1    I+4,,AUTO
        13 001626   200005 236100                    LDQ     @MAIL_DCB#,,AUTO
        13 001627   200003 235100                    LDA     @MESSAGE_NUMBER,,AUTO
        13 001630   201156 757100                    STAQ    I+2,,AUTO
        13 001631   201156 630500                    EPPR0   I+2,,AUTO
        13 001632   000135 631400 14                 EPPR1   93
        13 001633   000000 701000 xent               TSX1    VMD$GET_BODY
        13 001634   001647 702000 13                 TSX2    E_BODY

      967    11785    2             BODY_WRITE.V.DVBYTE) ALTRET(E_BODY);
      968    11786    2           CALL CRYPT_CHECK ALTRET(E_CRYPT);

  11786 13 001635   001655 701000 13                 TSX1    CRYPT_CHECK
        13 001636   001654 702000 13                 TSX2    E_CRYPT

      969    11787    2           CALL DISPLAY_BODY_RECORD;

  11787 13 001637   002440 701000 13                 TSX1    DISPLAY_BODY_RECORD
        13 001640   000000 011000                    NOP     0

      970    11788    2       END;

  11788 13 001641   200027 054100                    AOS     INDX,,AUTO
        13 001642   000000 470400 xsym               LDP0    VM_HEADER$
        13 001643   200027 236100                    LDQ     INDX,,AUTO
        13 001644   001613 604000 13                 TMI     s:11783
        13 001645   000011 116100                    CMPQ    9,,PR0
        13 001646   001613 602000 13                 TNC     s:11783
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:162  

      971    11789    1   E_BODY:
      972    11790    1       CALL VMD$WRITE_BUF (SPACE_LINE);

  11790 13 001647   000001 630400 14    E_BODY       EPPR0   1
        13 001650   000000 631400 14                 EPPR1   0
        13 001651   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 001652   000000 011000                    NOP     0

      973    11791
      974    11792    1       RETURN;

  11792 13 001653   000000 702200 xent               TSX2  ! X66_ARET

      975    11793
      976    11794    1   E_CRYPT:
      977    11795    1       ALTRETURN;

  11795 13 001654   000000 702200 xent  E_CRYPT      TSX2  ! X66_AALT

      978    11796        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:163  
      979    11797        /*I* NAME: CRYPT_CHECK
      980    11798             PURPOSE: To check for proper decryption.
      981    11799             DESCRIPTION:
      982    11800                This routine does some simple checks to ensure the decryption
      983    11801                seed specified is not obviously wrong, and altreturn if it is.
      984    11802                It verifies that the record type is legal, and that the count
      985    11803                in the record agrees with the ARS.  This isn't foolproof, but
      986    11804                the intent is only to avoid spewing out an obviously garbled
      987    11805                message; even if a few could slip through, it's still better
      988    11806                than nothing.
      989    11807
      990    11808                This checking is complicated by a couple of bugs in pre-B03
      991    11809                MAIL.  It doesn't use the CRYPT flag in the header to tell if
      992    11810                a message is encrypted, because this flag wasn't being set.
      993    11811                Also, the count was sometimes the just the length of the data,
      994    11812                and sometimes the length of the entire record, so it has to be
      995    11813                checked both ways.
      996    11814        */
      997    11815    1   CRYPT_CHECK: PROC ALTRET;

  11815 13 001655   201126 741300       CRYPT_CHECK  STX1  ! SITENAME+3,,AUTO

      998    11816
      999    11817    2       IF ADDR(SEED) = ADDR(NIL)

  11817 13 001656   200006 236100                    LDQ     @SEED,,AUTO
        13 001657   000010 116000 14                 CMPQ    8
        13 001660   001662 601000 13                 TNZ     s:11820

     1000    11818    2       THEN
     1001    11819    2           RETURN;

  11819 13 001661   000001 702211                    TSX2  ! 1,X1

     1002    11820    3       DO CASE (VM_BODYREC.TYPE);

  11820 13 001662   000600 236000 11                 LDQ     VM_BODYREC
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:164  
        13 001663   000033 772000                    QRL     27
        13 001664   000004 116007                    CMPQ    4,DL
        13 001665   001667 602006 13                 TNC     s:11820+5,QL
        13 001666   001673 710000 13                 TRA     s:11823
        13 001667   001673 710000 13                 TRA     s:11823
        13 001670   001674 710000 13                 TRA     s:11825
        13 001671   001674 710000 13                 TRA     s:11825
        13 001672   001674 710000 13                 TRA     s:11825

     1003    11821    3       CASE (%VM_BODY_TEXT, %VM_BODY_GRAPHICS, %VM_BODY_ENCODED_ERR);

     1004    11822    3       CASE(ELSE);

     1005    11823    3           ALTRETURN;

  11823 13 001673   000000 702211                    TSX2  ! 0,X1

     1006    11824    3       END;

     1007    11825    2       IF COUNT = VM_BODYREC.VALUE.COUNT

  11825 13 001674   201122 236100                    LDQ     COUNT,,AUTO
        13 001675   001700 604000 13                 TMI     s:11825+4
        13 001676   000601 116000 11                 CMPQ    VM_BODYREC+1
        13 001677   001711 600000 13                 TZE     s:11830
        13 001700   000601 236000 11                 LDQ     VM_BODYREC+1
        13 001701   000010 036007                    ADLQ    8,DL
        13 001702   001705 604000 13                 TMI     s:11825+9
        13 001703   201122 116100                    CMPQ    COUNT,,AUTO
        13 001704   001711 600000 13                 TZE     s:11830
        13 001705   000000 470400 xsym               LDP0    VM_HEADER$
        13 001706   000012 236100                    LDQ     10,,PR0
        13 001707   010000 316007                    CANQ    4096,DL
        13 001710   001712 600000 13                 TZE     s:11832

     1008    11826    2         OR COUNT = VM_BODYREC.VALUE.COUNT +
     1009    11827    2         (LENGTHC(VM_BODYREC) - LENGTHC(VM_BODYREC.VALUE.DATA)) /* pre B03 */
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:165  
     1010    11828    2         OR VM_HEADER.STATUS.PRE_B00
     1011    11829    2       THEN
     1012    11830    2           RETURN;

  11830 13 001711   000001 702211                    TSX2  ! 1,X1

     1013    11831    2       ELSE
     1014    11832    2           ALTRETURN;

  11832 13 001712   000000 702211                    TSX2  ! 0,X1

     1015    11833
     1016    11834    2   END CRYPT_CHECK;
     1017    11835        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:166  
     1018    11836    1   DISPLAY_ENCODED_ERROR: PROC;

  11836 13 001713   201142 741300       DISPLAY_ENC* STX1  ! LVNUM+1,,AUTO

     1019    11837
     1020    11838    2   DCL HIT BIT (1);
     1021    11839    2   DCL INDX SBIN;
     1022    11840    2   DCL INDX1 SBIN;
     1023    11841    2   DCL INDX2 SBIN;
     1024    11842    2   DCL INDX3 SBIN;
     1025    11843
     1026    11844    2       FETCH_ERROR_TEXT.BUF_ = VECTOR (ERRMSG_BUF);

  11844 13 001714   000140 235000 14                 LDA     96
        13 001715   201156 452500                    STP2    I+2,,AUTO
        13 001716   201156 236100                    LDQ     I+2,,AUTO
        13 001717   000446 036003                    ADLQ    294,DU
        13 001720   000020 757000 11                 STAQ    FETCH_ERROR_TEXT+4

     1027    11845    2       FETCH_ERROR_TEXT.CODE_ = VECTOR (CODE);

  11845 13 001721   777640 235007                    LDA     -96,DL
        13 001722   201156 452500                    STP2    I+2,,AUTO
        13 001723   201156 236100                    LDQ     I+2,,AUTO
        13 001724   000033 036003                    ADLQ    27,DU
        13 001725   000016 757000 11                 STAQ    FETCH_ERROR_TEXT+2

     1028    11846    2       FETCH_ERROR_TEXT.V.INCLCODE# = CODE.MON;

  11846 13 001726   200033 236100                    LDQ     CODE,,AUTO
        13 001727   000014 736000                    QLS     12
        13 001730   000044 676000 11                 ERQ     FETCH_ERROR_TEXT+24
        13 001731   004000 376003                    ANQ     2048,DU
        13 001732   000044 656000 11                 ERSQ    FETCH_ERROR_TEXT+24

     1029    11847
     1030    11848    2       CALL INDEX1 (INDX, '.', ERRMSG_FID.NAME#);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:167  

  11848 13 001733   000000 236000 xsym               LDQ     ERRMSG_FID
        13 001734   000033 772000                    QRL     27
        13 001735   000000 620006                    EAX0    0,QL
        13 001736   000000 124440                    SCM     mask='000'O
        13 001737   000000 200010 xsym               ADSC9   ERRMSG_FID               cn=1,n=*X0
        13 001740   000141 000001 14                 ADSC9   97                       cn=0,n=1
        13 001741   201144 000100                    ARG     INDX,,AUTO

     1031    11849    2       ERRMSG_FILE_NAME.L# = INDX;

  11849 13 001742   201144 236100                    LDQ     INDX,,AUTO
        13 001743   000033 736000                    QLS     27
        13 001744   200011 552140                    STBQ    ERRMSG_FILE_NAME,'40'O,AUTO

     1032    11850    2       ERRMSG_FILE_NAME.NAME# = SUBSTR (ERRMSG_FID.NAME#, 0, INDX);

  11850 13 001745   201144 722100                    LXL2    INDX,,AUTO
        13 001746   040100 100440                    MLR     fill='040'O
        13 001747   000000 200012 xsym               ADSC9   ERRMSG_FID               cn=1,n=*X2
        13 001750   200011 200037                    ADSC9   ERRMSG_FILE_NAME,,AUTO   cn=1,n=31

     1033    11851    2       IF INDX >= ERRMSG_FID.L# - 1

  11851 13 001751   000000 236000 xsym               LDQ     ERRMSG_FID
        13 001752   000033 772000                    QRL     27
        13 001753   000001 136007                    SBLQ    1,DL
        13 001754   201144 116100                    CMPQ    INDX,,AUTO
        13 001755   001762 605400 13                 TPNZ    s:11855

     1034    11852    2       THEN
     1035    11853    2           ERRMSG_FILE_ACCT.ACCT# = ':SYS';

  11853 13 001756   040100 100400                    MLR     fill='040'O
        13 001757   000212 000004 12                 ADSC9   SPACEC+1                 cn=0,n=4
        13 001760   200021 000010                    ADSC9   ERRMSG_FILE_ACCT,,AUTO   cn=0,n=8
        13 001761   001772 710000 13                 TRA     s:11857
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:168  

     1036    11854    2       ELSE
     1037    11855    2           ERRMSG_FILE_ACCT.ACCT# = SUBSTR (ERRMSG_FID.NAME#, INDX+1);

  11855 13 001762   000000 636010                    EAQ     0,X0
        13 001763   000022 772000                    QRL     18
        13 001764   201144 136100                    SBLQ    INDX,,AUTO
        13 001765   777777 623006                    EAX3    -1,QL
        13 001766   201144 236100                    LDQ     INDX,,AUTO
        13 001767   040100 100446                    MLR     fill='040'O
        13 001770   000000 400013 xsym               ADSC9   ERRMSG_FID,Q             cn=2,n=*X3
        13 001771   200021 000010                    ADSC9   ERRMSG_FILE_ACCT,,AUTO   cn=0,n=8

     1038    11856
     1039    11857    2       FETCH_ERROR_TEXT.FILENAME_ = VECTOR (ERRMSG_FILE_NAME);

  11857 13 001772   000142 235000 14                 LDA     98
        13 001773   201156 452500                    STP2    I+2,,AUTO
        13 001774   201156 236100                    LDQ     I+2,,AUTO
        13 001775   000011 036003                    ADLQ    9,DU
        13 001776   000022 757000 11                 STAQ    FETCH_ERROR_TEXT+6

     1040    11858    2       FETCH_ERROR_TEXT.FILEACCT_ = VECTOR (ERRMSG_FILE_ACCT);

  11858 13 001777   000143 235000 14                 LDA     99
        13 002000   201156 452500                    STP2    I+2,,AUTO
        13 002001   201156 236100                    LDQ     I+2,,AUTO
        13 002002   000021 036003                    ADLQ    17,DU
        13 002003   000024 757000 11                 STAQ    FETCH_ERROR_TEXT+8

     1041    11859
     1042    11860    2       FETCH_ERROR_TEXT.FIELD1_ = VECTOR (NIL);

  11860 13 002004   000144 237000 14                 LDAQ    100
        13 002005   000030 757000 11                 STAQ    FETCH_ERROR_TEXT+12

     1043    11861
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:169  
     1044    11862    2       IF UTS ~= 0

  11862 13 002006   200034 235100                    LDA     UTS,,AUTO
        13 002007   002057 600000 13                 TZE     s:11884

     1045    11863    3       THEN DO;

     1046    11864
     1047    11865    3           CONVERT_TIME.TSTAMP_ = VECTOR (UTS);

  11865 13 002010   777640 235007                    LDA     -96,DL
        13 002011   201156 452500                    STP2    I+2,,AUTO
        13 002012   201156 236100                    LDQ     I+2,,AUTO
        13 002013   000034 036003                    ADLQ    28,DU
        13 002014   000010 757000 11                 STAQ    CONVERT_TIME+8

     1048    11866    3           CONVERT_TIME.DATE_ = VECTOR (TIMEBUF.DATE);

  11866 13 002015   000143 235000 14                 LDA     99
        13 002016   201156 452500                    STP2    I+2,,AUTO
        13 002017   201156 236100                    LDQ     I+2,,AUTO
        13 002020   000435 036003                    ADLQ    285,DU
        13 002021   000002 757000 11                 STAQ    CONVERT_TIME+2

     1049    11867    3           CONVERT_TIME.TIME_ = VECTOR (TIMEBUF.TIME);

  11867 13 002022   000146 235000 14                 LDA     102
        13 002023   201156 452500                    STP2    I+2,,AUTO
        13 002024   201156 236100                    LDQ     I+2,,AUTO
        13 002025   000437 036003                    ADLQ    287,DU
        13 002026   000004 757000 11                 STAQ    CONVERT_TIME+4

     1050    11868    3           CONVERT_TIME.DAY_ = VECTOR (TIMEBUF.DAY);

  11868 13 002027   577640 235007                    LDA     -65632,DL
        13 002030   201156 452500                    STP2    I+2,,AUTO
        13 002031   201156 236100                    LDQ     I+2,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:170  
        13 002032   000147 036000 14                 ADLQ    103
        13 002033   000006 757000 11                 STAQ    CONVERT_TIME+6

     1051    11869
     1052    11870    3           CALL M$TIME (CONVERT_TIME)

  11870 13 002034   000000 630400 11                 EPPR0   CONVERT_TIME
        13 002035   420004 713400                    CLIMB   alt,+8196
        13 002036   402000 401760                    pmme    nvectors=5
        13 002037   002057 702000 13                 TSX2    s:11884

     1053    11871    4           WHENRETURN DO;

     1054    11872
     1055    11873    4               TIME_TEXTC.COUNT = LENGTHC(TIME_TEXTC.TEXT);

  11873 13 002040   013000 236003                    LDQ     5632,DU
        13 002041   200443 552140                    STBQ    TIME_TEXTC,'40'O,AUTO

     1056    11874
     1057    11875    4               CALL CONCAT (TIME_TEXTC.TEXT, SUBSTR (TIMEBUF.DATE, 0, 5), ' ',

  11875 13 002042   040100 100500                    MLR     fill='040'O
        13 002043   200435 000005                    ADSC9   TIMEBUF,,AUTO            cn=0,n=5
        13 002044   200443 200005                    ADSC9   TIME_TEXTC,,AUTO         cn=1,n=5
        13 002045   040000 236007                    LDQ     16384,DL
        13 002046   200444 552110                    STBQ    TIME_TEXTC+1,'10'O,AUTO
        13 002047   040100 100500                    MLR     fill='040'O
        13 002050   200437 000005                    ADSC9   TIMEBUF+2,,AUTO          cn=0,n=5
        13 002051   200444 600005                    ADSC9   TIME_TEXTC+1,,AUTO       cn=3,n=5

     1058    11876    4                 SUBSTR (TIMEBUF.TIME, 0, 5));
     1059    11877
     1060    11878    4               FETCH_ERROR_TEXT.FIELD1_ = VECTOR (TIME_TEXTC);

  11878 13 002052   000150 235000 14                 LDA     104
        13 002053   201156 452500                    STP2    I+2,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:171  
        13 002054   201156 236100                    LDQ     I+2,,AUTO
        13 002055   000443 036003                    ADLQ    291,DU
        13 002056   000030 757000 11                 STAQ    FETCH_ERROR_TEXT+12

     1061    11879
     1062    11880    4           END;

     1063    11881
     1064    11882    3       END;

     1065    11883
     1066    11884    2       IF TEXTC2.COUNT = 0

  11884 13 002057   200235 236100                    LDQ     TEXTC2,,AUTO
        13 002060   777000 316003                    CANQ    -512,DU
        13 002061   002065 601000 13                 TNZ     s:11888

     1067    11885    2       THEN
     1068    11886    2           FETCH_ERROR_TEXT.FIELD2_ = VECTOR(NIL);

  11886 13 002062   000144 237000 14                 LDAQ    100
        13 002063   000032 757000 11                 STAQ    FETCH_ERROR_TEXT+14
        13 002064   002072 710000 13                 TRA     s:11890

     1069    11887    2       ELSE
     1070    11888    2           FETCH_ERROR_TEXT.FIELD2_ = VECTOR (TEXTC2);

  11888 13 002065   000151 235000 14                 LDA     105
        13 002066   201156 452500                    STP2    I+2,,AUTO
        13 002067   201156 236100                    LDQ     I+2,,AUTO
        13 002070   000235 036003                    ADLQ    157,DU
        13 002071   000032 757000 11                 STAQ    FETCH_ERROR_TEXT+14

     1071    11889
     1072    11890    3       CALL M$ERRMSG (FETCH_ERROR_TEXT) WHENALTRETURN DO; END;

  11890 13 002072   000014 630400 11                 EPPR0   FETCH_ERROR_TEXT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:172  
        13 002073   420000 713400                    CLIMB   alt,+8192
        13 002074   405000 401760                    pmme    nvectors=11
        13 002075   002077 702000 13                 TSX2    s:11892
        13 002076   002077 710000 13                 TRA     s:11892

     1073    11891
     1074    11892    2       HIT = %NO#;

  11892 13 002077   201143 450100                    STZ     HIT,,AUTO

     1075    11893    2       F_FDS.NVECS# = 1;

  11893 13 002100   000001 235007                    LDA     1,DL
        13 002101   000063 755000 11                 STA     F_FDS+9

     1076    11894    2       F_FDS.FMT_ = VECTOR (BODY_FMT);

  11894 13 002102   000132 237000 14                 LDAQ    90
        13 002103   000052 757000 11                 STAQ    F_FDS

     1077    11895
     1078    11896    3       DO INDX1 = 0 TO VLR_ERRMSG.RECCNT - 1;

  11896 13 002104   201145 450100                    STZ     INDX1,,AUTO
        13 002105   002370 710000 13                 TRA     s:11936+1

     1079    11897
     1080    11898    3           CALL INDEX (INDX, '<>', ERRMSG_BUF(INDX1))

  11898 13 002106   201145 236100                    LDQ     INDX1,,AUTO
        13 002107   000170 402007                    MPY     120,DL
        13 002110   000000 120506                    SCD
        13 002111   200446 000170                    ADSC9   ERRMSG_BUF,Q,AUTO        cn=0,n=120
        13 002112   000213 000002 12                 ADSC9   SPACEC+2                 cn=0,n=2
        13 002113   201144 000100                    ARG     INDX,,AUTO
        13 002114   002117 607000 13                 TTF     s:11901
        13 002115   201144 054100                    AOS     INDX,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:173  
        13 002116   002330 710000 13                 TRA     s:11923

     1081    11899    4           WHENRETURN DO;

     1082    11900
     1083    11901    4               CALL INDEX (INDX2, '<', ERRMSG_BUF(INDX1));

  11901 13 002117   000000 124506                    SCM     mask='000'O
        13 002120   200446 000170                    ADSC9   ERRMSG_BUF,Q,AUTO        cn=0,n=120
        13 002121   000152 000001 14                 ADSC9   106                      cn=0,n=1
        13 002122   201146 000100                    ARG     INDX2,,AUTO

     1084    11902    4               CALL INDEX1R (INDX3, '>', ERRMSG_BUF(INDX1));

  11902 13 002123   000000 125506                    SCMR    mask='000'O
        13 002124   200446 000170                    ADSC9   ERRMSG_BUF,Q,AUTO        cn=0,n=120
        13 002125   000153 000001 14                 ADSC9   107                      cn=0,n=1
        13 002126   201147 000100                    ARG     INDX3,,AUTO
        13 002127   002132 606400 13                 TTN     s:11904
        13 002130   000167 236007                    LDQ     119,DL
        13 002131   201147 156100                    SSQ     INDX3,,AUTO

     1085    11903
     1086    11904    4               IF TEXTC.COUNT = 0

  11904 13 002132   200035 236100                    LDQ     TEXTC,,AUTO
        13 002133   777000 316003                    CANQ    -512,DU
        13 002134   002164 601000 13                 TNZ     s:11910

     1087    11905    4               THEN
     1088    11906    4                   CALL CONCAT (TEMPBUF,

  11906 13 002135   201145 236100                    LDQ     INDX1,,AUTO
        13 002136   000170 402007                    MPY     120,DL
        13 002137   201147 036100                    ADLQ    INDX3,,AUTO
        13 002140   201156 756100                    STQ     I+2,,AUTO
        13 002141   201145 236100                    LDQ     INDX1,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:174  
        13 002142   000170 402007                    MPY     120,DL
        13 002143   201146 720100                    LXL0    INDX2,,AUTO
        13 002144   040000 100546                    MLR     fill='040'O
        13 002145   200446 000010                    ADSC9   ERRMSG_BUF,Q,AUTO        cn=0,n=*X0
        13 002146   000200 001000 11                 ADSC9   TEMPBUF                  cn=0,n=512
        13 002147   201146 236100                    LDQ     INDX2,,AUTO
        13 002150   001000 116007                    CMPQ    512,DL
        13 002151   002163 605000 13                 TPL     s:11906+22
        13 002152   201147 721100                    LXL1    INDX3,,AUTO
        13 002153   777610 621011                    EAX1    -120,X1
        13 002154   777777 661003                    ERX1    -1,DU
        13 002155   776777 622006                    EAX2    -513,QL
        13 002156   777777 662003                    ERX2    -1,DU
        13 002157   201156 235100                    LDA     I+2,,AUTO
        13 002160   040046 100545                    MLR     fill='040'O
        13 002161   200446 200011                    ADSC9   ERRMSG_BUF,A,AUTO        cn=1,n=*X1
        13 002162   000200 000012 11                 ADSC9   TEMPBUF,Q                cn=0,n=*X2
        13 002163   002321 710000 13                 TRA     s:11917

     1089    11907    4                     SUBSTR (ERRMSG_BUF(INDX1), 0, INDX2),
     1090    11908    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX3+1));
     1091    11909    4               ELSE
     1092    11910    4                   CALL CONCAT (TEMPBUF,

  11910 13 002164   201144 236100                    LDQ     INDX,,AUTO
        13 002165   201146 136100                    SBLQ    INDX2,,AUTO
        13 002166   000001 136007                    SBLQ    1,DL
        13 002167   000000 116003                    CMPQ    0,DU
        13 002170   002172 605000 13                 TPL     s:11910+6
        13 002171   000000 236003                    LDQ     0,DU
        13 002172   201156 756100                    STQ     I+2,,AUTO
        13 002173   201145 236100                    LDQ     INDX1,,AUTO
        13 002174   000170 402007                    MPY     120,DL
        13 002175   201146 036100                    ADLQ    INDX2,,AUTO
        13 002176   201157 756100                    STQ     I+3,,AUTO
        13 002177   200035 236100                    LDQ     TEXTC,,AUTO
        13 002200   000033 772000                    QRL     27
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:175  
        13 002201   000000 620006                    EAX0    0,QL
        13 002202   201147 236100                    LDQ     INDX3,,AUTO
        13 002203   201144 136100                    SBLQ    INDX,,AUTO
        13 002204   000002 136007                    SBLQ    2,DL
        13 002205   000000 116003                    CMPQ    0,DU
        13 002206   002210 605000 13                 TPL     s:11910+20
        13 002207   000000 236003                    LDQ     0,DU
        13 002210   201160 756100                    STQ     I+4,,AUTO
        13 002211   201145 236100                    LDQ     INDX1,,AUTO
        13 002212   000170 402007                    MPY     120,DL
        13 002213   201144 036100                    ADLQ    INDX,,AUTO
        13 002214   201161 756100                    STQ     I+5,,AUTO
        13 002215   201145 236100                    LDQ     INDX1,,AUTO
        13 002216   000170 402007                    MPY     120,DL
        13 002217   201147 036100                    ADLQ    INDX3,,AUTO
        13 002220   201162 756100                    STQ     I+6,,AUTO
        13 002221   201145 236100                    LDQ     INDX1,,AUTO
        13 002222   000170 402007                    MPY     120,DL
        13 002223   201146 721100                    LXL1    INDX2,,AUTO
        13 002224   040000 100546                    MLR     fill='040'O
        13 002225   200446 000011                    ADSC9   ERRMSG_BUF,Q,AUTO        cn=0,n=*X1
        13 002226   000200 001000 11                 ADSC9   TEMPBUF                  cn=0,n=512
        13 002227   201146 236100                    LDQ     INDX2,,AUTO
        13 002230   001000 116007                    CMPQ    512,DL
        13 002231   002321 605000 13                 TPL     s:11917
        13 002232   776777 622006                    EAX2    -513,QL
        13 002233   777777 662003                    ERX2    -1,DU
        13 002234   201156 723100                    LXL3    I+2,,AUTO
        13 002235   201157 235100                    LDA     I+3,,AUTO
        13 002236   040046 100545                    MLR     fill='040'O
        13 002237   200446 200013                    ADSC9   ERRMSG_BUF,A,AUTO        cn=1,n=*X3
        13 002240   000200 000012 11                 ADSC9   TEMPBUF,Q                cn=0,n=*X2
        13 002241   201156 036100                    ADLQ    I+2,,AUTO
        13 002242   001000 116007                    CMPQ    512,DL
        13 002243   002321 605000 13                 TPL     s:11917
        13 002244   201163 756100                    STQ     I+7,,AUTO
        13 002245   201146 236100                    LDQ     INDX2,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:176  
        13 002246   201156 036100                    ADLQ    I+2,,AUTO
        13 002247   201163 724100                    LXL4    I+7,,AUTO
        13 002250   776777 624014                    EAX4    -513,X4
        13 002251   777777 664003                    ERX4    -1,DU
        13 002252   040046 100540                    MLR     fill='040'O
        13 002253   200035 200010                    ADSC9   TEXTC,,AUTO              cn=1,n=*X0
        13 002254   000200 000014 11                 ADSC9   TEMPBUF,Q                cn=0,n=*X4
        13 002255   201164 756100                    STQ     I+8,,AUTO
        13 002256   000000 636010                    EAQ     0,X0
        13 002257   000022 772000                    QRL     18
        13 002260   201163 036100                    ADLQ    I+7,,AUTO
        13 002261   001000 116007                    CMPQ    512,DL
        13 002262   002321 605000 13                 TPL     s:11917
        13 002263   201165 756100                    STQ     I+9,,AUTO
        13 002264   000000 636010                    EAQ     0,X0
        13 002265   000022 772000                    QRL     18
        13 002266   201164 036100                    ADLQ    I+8,,AUTO
        13 002267   201165 720100                    LXL0    I+9,,AUTO
        13 002270   776777 620010                    EAX0    -513,X0
        13 002271   777777 660003                    ERX0    -1,DU
        13 002272   201160 725100                    LXL5    I+4,,AUTO
        13 002273   201161 235100                    LDA     I+5,,AUTO
        13 002274   040046 100545                    MLR     fill='040'O
        13 002275   200446 400015                    ADSC9   ERRMSG_BUF,A,AUTO        cn=2,n=*X5
        13 002276   000200 000010 11                 ADSC9   TEMPBUF,Q                cn=0,n=*X0
        13 002277   201166 756100                    STQ     I+10,,AUTO
        13 002300   201165 236100                    LDQ     I+9,,AUTO
        13 002301   201160 036100                    ADLQ    I+4,,AUTO
        13 002302   001000 116007                    CMPQ    512,DL
        13 002303   002321 605000 13                 TPL     s:11917
        13 002304   201167 756100                    STQ     I+11,,AUTO
        13 002305   201166 236100                    LDQ     I+10,,AUTO
        13 002306   201160 036100                    ADLQ    I+4,,AUTO
        13 002307   201147 726100                    LXL6    INDX3,,AUTO
        13 002310   777610 626016                    EAX6    -120,X6
        13 002311   777777 666003                    ERX6    -1,DU
        13 002312   201167 727100                    LXL7    I+11,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:177  
        13 002313   776777 627017                    EAX7    -513,X7
        13 002314   777777 667003                    ERX7    -1,DU
        13 002315   201162 235100                    LDA     I+6,,AUTO
        13 002316   040046 100545                    MLR     fill='040'O
        13 002317   200446 200016                    ADSC9   ERRMSG_BUF,A,AUTO        cn=1,n=*X6
        13 002320   000200 000017 11                 ADSC9   TEMPBUF,Q                cn=0,n=*X7

     1093    11911    4                     SUBSTR (ERRMSG_BUF(INDX1), 0, INDX2),
     1094    11912    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX2+1, MAXIMUM (0, INDX-INDX2-1)),
     1095    11913    4                     SUBSTR (TEXTC.TEXT, 0, TEXTC.COUNT),
     1096    11914    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX+2, MAXIMUM (0, INDX3-INDX-2)),
     1097    11915    4                     SUBSTR (ERRMSG_BUF(INDX1), INDX3+1));
     1098    11916
     1099    11917    4               ERRMSG_BUF(INDX1) = TEMPBUF;

  11917 13 002321   201145 236100                    LDQ     INDX1,,AUTO
        13 002322   000170 402007                    MPY     120,DL
        13 002323   040106 100400                    MLR     fill='040'O
        13 002324   000200 000170 11                 ADSC9   TEMPBUF                  cn=0,n=120
        13 002325   200446 000170                    ADSC9   ERRMSG_BUF,Q,AUTO        cn=0,n=120

     1100    11918
     1101    11919    4               HIT = %YES#;

  11919 13 002326   400000 236003                    LDQ     -131072,DU
        13 002327   201143 756100                    STQ     HIT,,AUTO

     1102    11920
     1103    11921    4           END;

     1104    11922
     1105    11923    3           INDX = LENGTHC (ERRMSG_BUF(INDX1));

  11923 13 002330   000170 235007                    LDA     120,DL
        13 002331   201144 755100                    STA     INDX,,AUTO

     1106    11924
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:178  
     1107    11925    4           DO WHILE INDX > 1;

  11925 13 002332   000001 115007                    CMPA    1,DL
        13 002333   002350 604400 13                 TMOZ    s:11932

     1108    11926    4               IF SUBSTR (ERRMSG_BUF(INDX1), INDX-1, 1) ~= ' '

  11926 13 002334   201145 236100                    LDQ     INDX1,,AUTO
        13 002335   000170 402007                    MPY     120,DL
        13 002336   201144 036100                    ADLQ    INDX,,AUTO
        13 002337   040000 106506                    CMPC    fill='040'O
        13 002340   200445 600001                    ADSC9   TIME_TEXTC+2,Q,AUTO      cn=3,n=1
        13 002341   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 002342   002350 601000 13                 TNZ     s:11932

     1109    11927    4               THEN
     1110    11928    4                   EXIT;
     1111    11929    4               INDX = INDX - 1;

  11929 13 002343   000001 336007                    LCQ     1,DL
        13 002344   201144 056100                    ASQ     INDX,,AUTO

     1112    11930    4           END;

  11930 13 002345   201144 235100                    LDA     INDX,,AUTO
        13 002346   000001 115007                    CMPA    1,DL
        13 002347   002334 605400 13                 TPNZ    s:11926

     1113    11931
     1114    11932    3           VECT_ARRAY(0) = VECTOR(SUBSTR(ERRMSG_BUF(INDX1), 0, INDX));

  11932 13 002350   201144 235100                    LDA     INDX,,AUTO
        13 002351   000020 735000                    ALS     16
        13 002352   000140 135007                    SBLA    96,DL
        13 002353   201156 452500                    STP2    I+2,,AUTO
        13 002354   201145 236100                    LDQ     INDX1,,AUTO
        13 002355   201157 755100                    STA     I+3,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:179  
        13 002356   000036 402003                    MPY     30,DU
        13 002357   000446 036003                    ADLQ    294,DU
        13 002360   201156 036100                    ADLQ    I+2,,AUTO
        13 002361   201157 235100                    LDA     I+3,,AUTO
        13 002362   000162 757000 11                 STAQ    VECT_ARRAY

     1115    11933
     1116    11934    3           CALL VMD$WRITE_BUF (F_FDS);

  11934 13 002363   000006 630400 14                 EPPR0   6
        13 002364   000000 631400 14                 EPPR1   0
        13 002365   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 002366   000000 011000                    NOP     0

     1117    11935
     1118    11936    3       END;

  11936 13 002367   201145 054100                    AOS     INDX1,,AUTO
        13 002370   000046 236000 11                 LDQ     VLR_ERRMSG
        13 002371   000777 376007                    ANQ     511,DL
        13 002372   201145 116100                    CMPQ    INDX1,,AUTO
        13 002373   002106 605400 13                 TPNZ    s:11898

     1119    11937
     1120    11938    2       IF TEXTC.COUNT > 0 AND NOT HIT

  11938 13 002374   200035 236100                    LDQ     TEXTC,,AUTO
        13 002375   777000 316003                    CANQ    -512,DU
        13 002376   002436 600000 13                 TZE     s:11970
        13 002377   201143 234100                    SZN     HIT,,AUTO
        13 002400   002436 604000 13                 TMI     s:11970

     1121    11939    3       THEN DO;

     1122    11940
     1123    11941    3           VECT_ARRAY(0) = VECTOR (SUBSTR(TEXTC.TEXT,0,TEXTC.COUNT));

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:180  
  11941 13 002401   200035 236100                    LDQ     TEXTC,,AUTO
        13 002402   000033 772000                    QRL     27
        13 002403   000064 737000                    LLS     52
        13 002404   000140 135007                    SBLA    96,DL
        13 002405   201156 452500                    STP2    I+2,,AUTO
        13 002406   201156 236100                    LDQ     I+2,,AUTO
        13 002407   000154 036000 14                 ADLQ    108
        13 002410   000162 757000 11                 STAQ    VECT_ARRAY

     1124    11942               %INIT_STR(STR=VM_ERROR_ADDRESS_FMT, CODE=E_ERROR_ADDRESS_FMT, TEST=YES, VECT
             11942                    ="F_FDS.FMT_");

  11949 13 002411   000000 236000 xsym               LDQ     VM_ERROR_ADDRESS_FMT
        13 002412   000033 772000                    QRL     27
        13 002413   000000 620006                    EAX0    0,QL
        13 002414   040000 106440                    CMPC    fill='040'O
        13 002415   000000 200010 xsym               ADSC9   VM_ERROR_ADDRESS_FMT     cn=1,n=*X0
        13 002416   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 002417   002425 601000 13                 TNZ     s:11954

  11951 13 002420   000155 630400 14                 EPPR0   109
        13 002421   000003 631400 14                 EPPR1   3
        13 002422   000000 701000 xent               TSX1    VMD$ERRMSG
        13 002423   000000 011000                    NOP     0

  11952 13 002424   002432 710000 13                 TRA     s:11966

  11954 13 002425   000000 635010                    EAA     0,X0
        13 002426   000002 771000                    ARL     2
        13 002427   000140 135007                    SBLA    96,DL
        13 002430   000160 236000 14                 LDQ     112
        13 002431   000052 757000 11                 STAQ    F_FDS

     1125    11965
     1126    11966    3           CALL VMD$WRITE_BUF (F_FDS);

  11966 13 002432   000006 630400 14                 EPPR0   6
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:181  
        13 002433   000000 631400 14                 EPPR1   0
        13 002434   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 002435   000000 011000                    NOP     0

     1127    11967
     1128    11968    3       END;

     1129    11969
     1130    11970    2       RETURN;

  11970 13 002436   201142 221300                    LDX1  ! LVNUM+1,,AUTO
        13 002437   000001 702211                    TSX2  ! 1,X1

     1131    11971
     1132    11972    2   END DISPLAY_ENCODED_ERROR;
     1133    11973
     1134    11974        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:182  
     1135    11975    1   DISPLAY_BODY_RECORD: PROC;

  11975 13 002440   201126 741300       DISPLAY_BOD* STX1  ! SITENAME+3,,AUTO

     1136    11976
     1137    11977    2   DCL I UBIN;
     1138    11978    2   DCL ID# UBIN;
     1139    11979    2   DCL ID#TEXT CHAR (10);
     1140    11980    2   DCL BODYREC$ PTR;
     1141    11981    2   DCL REF$ PTR;
     1142    11982    2   DCL CHAR_RMNG SBIN;
     1143    11983    2   DCL SIZE_BUF  UBIN;
     1144    11984    2   DCL DEVC_WIDTH UBIN;
     1145    11985        %VM_BODYREC (NAME=VM_BODYREC_ENCODED, STCLASS="BASED(BODYREC$)",
     1146    11986                     ERR_FORMAT=YES);
     1147    12018
     1148    12019    3       DO CASE (VM_BODYREC.TYPE);

  12019 13 002441   000600 236000 11                 LDQ     VM_BODYREC
        13 002442   000033 772000                    QRL     27
        13 002443   000004 116007                    CMPQ    4,DL
        13 002444   002446 602006 13                 TNC     s:12019+5,QL
        13 002445   002452 710000 13                 TRA     s:12021
        13 002446   002452 710000 13                 TRA     s:12021
        13 002447   002452 710000 13                 TRA     s:12021
        13 002450   002660 710000 13                 TRA     s:12078
        13 002451   002556 710000 13                 TRA     s:12055

     1149    12020    3       CASE (ELSE, %VM_BODY_TEXT);

     1150    12021    3           IF COUNT = 0

  12021 13 002452   201122 235100                    LDA     COUNT,,AUTO
        13 002453   002461 601000 13                 TNZ     s:12026

     1151    12022    4           THEN DO;                   /* Print a blank line */

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:183  
     1152    12023    4               CALL VMD$WRITE_BUF (SPACE_LINE);

  12023 13 002454   000001 630400 14                 EPPR0   1
        13 002455   000000 631400 14                 EPPR1   0
        13 002456   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 002457   000000 011000                    NOP     0

     1153    12024    4           END;

  12024 13 002460   002660 710000 13                 TRA     s:12078

     1154    12025    4           ELSE DO;                   /* Print the data */

     1155    12026    4               DEVC_WIDTH = DCBADDR(OUT_DCB#)->F$DCB.WIDTH#;

  12026 13 002461   000161 470400 14                 LDP0    113
        13 002462   000000 471500                    LDP1    0,,PR0
        13 002463   200004 473500                    LDP3    @OUT_DCB#,,AUTO
        13 002464   300000 720100                    LXL0    0,,PR3
        13 002465   100000 474510                    LDP4    0,X0,PR1
        13 002466   400004 236100                    LDQ     4,,PR4
        13 002467   000777 376007                    ANQ     511,DL
        13 002470   201140 756100                    STQ     DEVC_WIDTH,,AUTO

     1156    12027    4               IF DEVC_WIDTH = 0 THEN DEVC_WIDTH=COUNT;

  12027 13 002471   002473 601000 13                 TNZ     s:12028

  12027 13 002472   201140 755100                    STA     DEVC_WIDTH,,AUTO

     1157    12028    4               CHAR_RMNG = COUNT;

  12028 13 002473   201136 755100                    STA     CHAR_RMNG,,AUTO

     1158    12029    4               BODY_WRITE.BUF_.BUF$ = ADDR( VM_BODYREC.VALUE.DATA);

  12029 13 002474   000162 236000 14                 LDQ     114
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:184  
        13 002475   000153 756000 11                 STQ     BODY_WRITE+5

     1159    12030
     1160    12031    5               DO UNTIL (CHAR_RMNG <= 0);

     1161    12032    5                   SIZE_BUF = MINIMUM( CHAR_RMNG, DEVC_WIDTH);

  12032 13 002476   201140 236100                    LDQ     DEVC_WIDTH,,AUTO
        13 002477   002502 604000 13                 TMI     s:12032+4
        13 002500   201136 116100                    CMPQ    CHAR_RMNG,,AUTO
        13 002501   002503 604400 13                 TMOZ    s:12032+5
        13 002502   201136 236100                    LDQ     CHAR_RMNG,,AUTO
        13 002503   201137 756100                    STQ     SIZE_BUF,,AUTO

     1162    12033    5                   BODY_WRITE.BUF_.BOUND = SIZE_BUF - 1;

  12033 13 002504   000001 136007                    SBLQ    1,DL
        13 002505   000020 736000                    QLS     16
        13 002506   000152 676000 11                 ERQ     BODY_WRITE+4
        13 002507   000104 376000 14                 ANQ     68
        13 002510   000152 656000 11                 ERSQ    BODY_WRITE+4

     1163    12034    5                   CALL M$WRITE (BODY_WRITE)

  12034 13 002511   000146 630400 11                 EPPR0   BODY_WRITE
        13 002512   440001 713400                    CLIMB   alt,write
        13 002513   401400 401760                    pmme    nvectors=4
        13 002514   002516 702000 13                 TSX2    s:12036
        13 002515   002542 710000 13                 TRA     s:12047

     1164    12035    6                   WHENALTRETURN DO;

     1165    12036    6                       IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$INVVFC

  12036 13 002516   000000 470400 xsym               LDP0    B$TCB$
        13 002517   000000 471500                    LDP1    0,,PR0
        13 002520   100102 236100                    LDQ     66,,PR1
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:185  
        13 002521   377770 376007                    ANQ     131064,DL
        13 002522   014140 116007                    CMPQ    6240,DL
        13 002523   002530 601000 13                 TNZ     s:12041

     1166    12037    7                       THEN DO;

     1167    12038    7                           BODY_WRITE.V.DVBYTE.VFC# = %NO#;

  12038 13 002524   000163 236000 14                 LDQ     115
        13 002525   000161 356000 11                 ANSQ    BODY_WRITE+11

     1168    12039    7                           CALL M$RETRY;

  12039 13 002526   010010 713400                    CLIMB   4104
        13 002527   000000 401760                    pmme    nvectors=0

     1169    12040    7                       END;

     1170    12041    6                       IF B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$CANTBIN

  12041 13 002530   000000 470400 xsym               LDP0    B$TCB$
        13 002531   000000 471500                    LDP1    0,,PR0
        13 002532   100102 236100                    LDQ     66,,PR1
        13 002533   377770 376007                    ANQ     131064,DL
        13 002534   014150 116007                    CMPQ    6248,DL
        13 002535   002542 601000 13                 TNZ     s:12047

     1171    12042    7                       THEN DO;

     1172    12043    7                           BODY_WRITE.V.DVBYTE.BIN# = %NO#;

  12043 13 002536   000164 236000 14                 LDQ     116
        13 002537   000161 356000 11                 ANSQ    BODY_WRITE+11

     1173    12044    7                           CALL M$RETRY;

  12044 13 002540   010010 713400                    CLIMB   4104
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:186  
        13 002541   000000 401760                    pmme    nvectors=0

     1174    12045    7                       END;

     1175    12046    6                   END;

     1176    12047    5                   BODY_WRITE.BUF_.BUF$ = PINCRC( BODY_WRITE.BUF_.BUF$, SIZE_BUF);

  12047 13 002542   201137 236100                    LDQ     SIZE_BUF,,AUTO
        13 002543   000020 736000                    QLS     16
        13 002544   000153 036000 11                 ADLQ    BODY_WRITE+5
        13 002545   000153 756000 11                 STQ     BODY_WRITE+5

     1177    12048    5                   CHAR_RMNG = CHAR_RMNG - SIZE_BUF;

  12048 13 002546   201136 236100                    LDQ     CHAR_RMNG,,AUTO
        13 002547   201137 136100                    SBLQ    SIZE_BUF,,AUTO
        13 002550   201136 756100                    STQ     CHAR_RMNG,,AUTO

     1178    12049    5                   BODY_WRITE.V.DVBYTE.VFC# = %NO#;

  12049 13 002551   000163 236000 14                 LDQ     115
        13 002552   000161 356000 11                 ANSQ    BODY_WRITE+11

     1179    12050    5               END;  /* DO UNTIL */

  12050 13 002553   201136 235100                    LDA     CHAR_RMNG,,AUTO
        13 002554   002476 605400 13                 TPNZ    s:12032

     1180    12051    4           END;

  12051 13 002555   002660 710000 13                 TRA     s:12078

     1181    12052    3       CASE (%VM_BODY_GRAPHICS);

     1182    12053              /*N* Implement this someday if we ever start shipping graphics */
     1183    12054    3       CASE (%VM_BODY_ENCODED_ERR);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:187  

     1184    12055    3           BODYREC$ = ADDR(VM_BODYREC);

  12055 13 002556   000137 236000 14                 LDQ     95
        13 002557   201134 756100                    STQ     BODYREC$,,AUTO

     1185    12056    3           CODE = VM_BODYREC_ENCODED.VALUE.DATA.ERR;

  12056 13 002560   201134 470500                    LDP0    BODYREC$,,AUTO
        13 002561   000002 236100                    LDQ     2,,PR0
        13 002562   200033 756100                    STQ     CODE,,AUTO

     1186    12057    3           UTS = VM_BODYREC_ENCODED.VALUE.DATA.UTS;

  12057 13 002563   000003 235100                    LDA     3,,PR0
        13 002564   200034 755100                    STA     UTS,,AUTO

     1187    12058    3           TEXTC = ADDR(VM_BODYREC_ENCODED.VALUE.DATA.STUFF) -> BASED_TEXTC;

  12058 13 002565   000004 236100                    LDQ     4,,PR0
        13 002566   000033 772000                    QRL     27
        13 002567   000001 620006                    EAX0    1,QL
        13 002570   000100 100540                    MLR     fill='000'O
        13 002571   000004 000010                    ADSC9   4,,PR0                   cn=0,n=*X0
        13 002572   200035 001000                    ADSC9   TEXTC,,AUTO              cn=0,n=512

     1188    12059    3           TEXTC2.COUNT = 0;

  12059 13 002573   000000 236003                    LDQ     0,DU
        13 002574   200235 552140                    STBQ    TEXTC2,'40'O,AUTO

     1189    12060    3           REF$ = PINCRC(ADDR(VM_BODYREC_ENCODED.VALUE.DATA.STUFF), TEXTC.COUNT + 1);

  12060 13 002575   200035 236100                    LDQ     TEXTC,,AUTO
        13 002576   000033 772000                    QRL     27
        13 002577   000020 736000                    QLS     16
        13 002600   000165 036000 14                 ADLQ    117
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:188  
        13 002601   201134 036100                    ADLQ    BODYREC$,,AUTO
        13 002602   201135 756100                    STQ     REF$,,AUTO

     1190    12061    3           IF REF$ -> BASED_TEXTC.COUNT ~= 0

  12061 13 002603   201135 471500                    LDP1    REF$,,AUTO
        13 002604   000100 101500                    MRL     fill='000'O
        13 002605   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 002606   201156 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
        13 002607   201156 236100                    LDQ     I+2,,AUTO
        13 002610   000000 116003                    CMPQ    0,DU
        13 002611   002656 600000 13                 TZE     NO_ID

     1191    12062    4           THEN DO;

     1192    12063    4               CALL VMD$GET_ID (REF$ -> BASED_TEXTC, MAIL_DCB#, ID#) ALTRET (NO_ID);

  12063 13 002612   201130 633500                    EPPR3   ID#,,AUTO
        13 002613   201160 453500                    STP3    I+4,,AUTO
        13 002614   200005 236100                    LDQ     @MAIL_DCB#,,AUTO
        13 002615   201135 235100                    LDA     REF$,,AUTO
        13 002616   201156 757100                    STAQ    I+2,,AUTO
        13 002617   201156 630500                    EPPR0   I+2,,AUTO
        13 002620   000003 631400 14                 EPPR1   3
        13 002621   000000 701000 xent               TSX1    VMD$GET_ID
        13 002622   002656 702000 13                 TSX2    NO_ID

     1193    12064    4               CALL BINCHAR (ID#TEXT, ID#);

  12064 13 002623   201130 235100                    LDA     ID#,,AUTO
        13 002624   000044 773000                    LRL     36
        13 002625   201156 757100                    STAQ    I+2,,AUTO
        13 002626   000100 301500                    BTD
        13 002627   201156 000010                    NDSC9   I+2,,AUTO                cn=0,s=lsgnf,sf=0,n=8
        13 002630   201131 030012                    NDSC9   ID#TEXT,,AUTO            cn=0,s=nosgn,sf=0,n=10

     1194    12065    4               I = 0;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:189  

  12065 13 002631   201127 450100                    STZ     I,,AUTO

     1195    12066    5               DO WHILE I < LENGTHC(ID#TEXT);

  12066 13 002632   002642 710000 13                 TRA     s:12071

     1196    12067    5                   IF SUBSTR(ID#TEXT,I,1) ~= '0'

  12067 13 002633   201127 235100                    LDA     I,,AUTO
        13 002634   040000 106505                    CMPC    fill='040'O
        13 002635   201131 000001                    ADSC9   ID#TEXT,A,AUTO           cn=0,n=1
        13 002636   000166 000001 14                 ADSC9   118                      cn=0,n=1
        13 002637   002645 601000 13                 TNZ     s:12072

     1197    12068    5                   THEN
     1198    12069    5                       EXIT;
     1199    12070    5                   I = I + 1;

  12070 13 002640   000001 035007                    ADLA    1,DL
        13 002641   201127 755100                    STA     I,,AUTO

     1200    12071    5               END;

  12071 13 002642   201127 235100                    LDA     I,,AUTO
        13 002643   000012 115007                    CMPA    10,DL
        13 002644   002633 602000 13                 TNC     s:12067

     1201    12072    4               TEXTC2.COUNT = LENGTHC(ID#TEXT) - I;

  12072 13 002645   000012 236007                    LDQ     10,DL
        13 002646   201127 136100                    SBLQ    I,,AUTO
        13 002647   000033 736000                    QLS     27
        13 002650   200235 552140                    STBQ    TEXTC2,'40'O,AUTO

     1202    12073    4               TEXTC2.TEXT = SUBSTR(ID#TEXT, I);

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:190  
  12073 13 002651   777765 620005                    EAX0    -11,AL
        13 002652   777777 660003                    ERX0    -1,DU
        13 002653   040100 100545                    MLR     fill='040'O
        13 002654   201131 000010                    ADSC9   ID#TEXT,A,AUTO           cn=0,n=*X0
        13 002655   200235 200777                    ADSC9   TEXTC2,,AUTO             cn=1,n=511

     1203    12074    4           END;

     1204    12075    3   NO_ID:
     1205    12076    3           CALL DISPLAY_ENCODED_ERROR;

  12076 13 002656   001713 701000 13    NO_ID        TSX1    DISPLAY_ENCODED_ERROR
        13 002657   000000 011000                    NOP     0

     1206    12077    3       END;

     1207    12078    2       RETURN;

  12078 13 002660   201126 221300                    LDX1  ! SITENAME+3,,AUTO
        13 002661   000001 702211                    TSX2  ! 1,X1

     1208    12079
     1209    12080    2   END DISPLAY_BODY_RECORD;
     1210    12081
     1211    12082        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:191  
     1212    12083        /*I* NAME:    VMD$WRITE_CONTINUATION
     1213    12084             PURPOSE: To continue (wrap) output lines if necessary.
     1214    12085
     1215    12086             DESCRIPTION: There are two input parameters, the first defines
     1216    12087                      a TEXTC string that is to be wrapped and the second
     1217    12088                      is the maximum width that that string may have.
     1218    12089        */
     1219    12090
     1220    12091    1   WRITE_CONTINUATION: proc(STRING, WIDTH, QUOTES, VNUM);

  12091 13 002662   201132 741300       WRITE_CONTI* STX1  ! FMT_STR_LEN+1,,AUTO

     1221    12092
     1222    12093        %VLP_NAMEV( FPTN=STRING, STCLASS="");
     1223    12100
     1224    12101    2   dcl  WIDTH    sbin;
     1225    12102    2   dcl  QUOTES   bit(1) aligned;   /** Optional flag to delete quotes **/
     1226    12103    2   dcl  VNUM     sbin;    /**  Optional index in VECT_ARRAY  **/
     1227    12104
     1228    12105    2   dcl  LWIDTH   sbin;
     1229    12106    2   dcl  LQUOTES  bit(1);
     1230    12107    2   dcl  LVNUM    sbin;
     1231    12108    2   dcl  LEN      sbin;
     1232    12109    2   dcl  INDX     sbin;
     1233    12110    2   dcl  CPOS     sbin;
     1234    12111
     1235    12112    2       LVNUM = 0;

  12112 13 002663   201141 450100                    STZ     LVNUM,,AUTO

     1236    12113    2       if addr(VNUM) ~= addr(NIL) then LVNUM = VNUM;

  12113 13 002664   201136 236100                    LDQ     @VNUM,,AUTO
        13 002665   000010 116000 14                 CMPQ    8
        13 002666   002672 600000 13                 TZE     s:12114

  12113 13 002667   201136 470500                    LDP0    @VNUM,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:192  
        13 002670   000000 235100                    LDA     0,,PR0
        13 002671   201141 755100                    STA     LVNUM,,AUTO

     1237    12114    2       LQUOTES = '0'b;       /**  Don't strip quotes from strings **/

  12114 13 002672   201140 450100                    STZ     LQUOTES,,AUTO

     1238    12115    2       if addr(QUOTES) ~= addr(nil) then LQUOTES = QUOTES;

  12115 13 002673   201135 236100                    LDQ     @QUOTES,,AUTO
        13 002674   000010 116000 14                 CMPQ    8
        13 002675   002702 600000 13                 TZE     s:12116

  12115 13 002676   201135 470500                    LDP0    @QUOTES,,AUTO
        13 002677   000000 236100                    LDQ     0,,PR0
        13 002700   400000 376003                    ANQ     -131072,DU
        13 002701   201140 756100                    STQ     LQUOTES,,AUTO

     1239    12116    2       LEN = STRING.L#;

  12116 13 002702   201133 470500                    LDP0    @STRING,,AUTO
        13 002703   000100 101500                    MRL     fill='000'O
        13 002704   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002705   201142 000004                    ADSC9   LEN,,AUTO                cn=0,n=4

     1240    12117    2       LWIDTH = WIDTH;

  12117 13 002706   201134 471500                    LDP1    @WIDTH,,AUTO
        13 002707   100000 235100                    LDA     0,,PR1
        13 002710   201137 755100                    STA     LWIDTH,,AUTO

     1241    12118    2       CPOS = 0;

  12118 13 002711   201144 450100                    STZ     CPOS,,AUTO

     1242    12119
     1243    12120    3       do while LEN > (CPOS + LWIDTH);
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:193  

  12120 13 002712   003046 710000 13                 TRA     s:12163

     1244    12121        /***     Output lines must be wrapped!    ***/
     1245    12122    3           call searchr(INDX, DUMMY, DELIMITER_TABLE, STRING.NAME#,CPOS+LWIDTH);

  12122 13 002713   201133 470500                    LDP0    @STRING,,AUTO
        13 002714   000100 101500                    MRL     fill='000'O
        13 002715   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002716   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 002717   201156 220100                    LDX0    I+2,,AUTO
        13 002720   201144 236100                    LDQ     CPOS,,AUTO
        13 002721   201137 036100                    ADLQ    LWIDTH,,AUTO
        13 002722   000000 621006                    EAX1    0,QL
        13 002723   000000 165540                    TCTR
        13 002724   000000 200011                    ADSC9   0,,PR0                   cn=1,n=*X1
        13 002725   000005 000000 12                 ARG     DELIMITER_TABLE
        13 002726   201143 000100                    ARG     INDX,,AUTO
        13 002727   201143 235100                    LDA     INDX,,AUTO
        13 002730   000033 771000                    ARL     27
        13 002731   200032 755100                    STA     DUMMY,,AUTO
        13 002732   201143 551140                    STBA    INDX,'40'O,AUTO
        13 002733   002736 606400 13                 TTN     s:12123
        13 002734   201143 054100                    AOS     INDX,,AUTO
        13 002735   201143 156100                    SSQ     INDX,,AUTO

     1246    12123    3           if INDX <= CPOS then INDX = CPOS+LWIDTH;

  12123 13 002736   201143 236100                    LDQ     INDX,,AUTO
        13 002737   201144 116100                    CMPQ    CPOS,,AUTO
        13 002740   002744 605400 13                 TPNZ    s:12124

  12123 13 002741   201144 236100                    LDQ     CPOS,,AUTO
        13 002742   201137 036100                    ADLQ    LWIDTH,,AUTO
        13 002743   201143 756100                    STQ     INDX,,AUTO

     1247    12124    3           INDX = minimum( LWIDTH, INDX-CPOS );
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:194  

  12124 13 002744   201144 136100                    SBLQ    CPOS,,AUTO
        13 002745   201137 116100                    CMPQ    LWIDTH,,AUTO
        13 002746   002750 604400 13                 TMOZ    s:12124+4
        13 002747   201137 236100                    LDQ     LWIDTH,,AUTO
        13 002750   201143 756100                    STQ     INDX,,AUTO

     1248    12125    3           IF SUBSTR(STRING.NAME#,CPOS,INDX) ~= ' ' THEN

  12125 13 002751   000100 101500                    MRL     fill='000'O
        13 002752   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002753   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 002754   201156 220100                    LDX0    I+2,,AUTO
        13 002755   000000 621006                    EAX1    0,QL
        13 002756   201144 236100                    LDQ     CPOS,,AUTO
        13 002757   040000 106546                    CMPC    fill='040'O
        13 002760   000000 200011                    ADSC9   0,Q,PR0                  cn=1,n=*X1
        13 002761   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 002762   003017 600000 13                 TZE     NEXT_CPOS

     1249    12126    3               VECT_ARRAY(LVNUM) = vector( substr(STRING.NAME#,CPOS,INDX) );

  12126 13 002763   201141 235100                    LDA     LVNUM,,AUTO
        13 002764   000001 735000                    ALS     1
        13 002765   000100 101500                    MRL     fill='000'O
        13 002766   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 002767   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 002770   201156 220100                    LDX0    I+2,,AUTO
        13 002771   201143 236100                    LDQ     INDX,,AUTO
        13 002772   000000 621005                    EAX1    0,AL
        13 002773   000064 737000                    LLS     52
        13 002774   000140 135007                    SBLA    96,DL
        13 002775   201144 236100                    LDQ     CPOS,,AUTO
        13 002776   000020 736000                    QLS     16
        13 002777   200000 036007                    ADLQ    65536,DL
        13 003000   201133 036100                    ADLQ    @STRING,,AUTO
        13 003001   000162 757011 11                 STAQ    VECT_ARRAY,X1
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:195  
        13 003002   003003 710000 13                 TRA     s:12129

     1250    12127    3           ELSE
     1251    12128    3               GOTO NEXT_CPOS;
     1252    12129    3           if LQUOTES = '1'b

  12129 13 003003   201140 234100                    SZN     LQUOTES,,AUTO
        13 003004   003013 605000 13                 TPL     s:12131

     1253    12130    3           then call BREAKER( VECT_ARRAY(LVNUM) );

  12130 13 003005   201141 236100                    LDQ     LVNUM,,AUTO
        13 003006   000023 736000                    QLS     19
        13 003007   000167 036000 14                 ADLQ    119
        13 003010   201147 756100                    STQ     INDX3,,AUTO
        13 003011   003121 701000 13                 TSX1    BREAKER
        13 003012   000000 011000                    NOP     0

     1254    12131    3           call VMD$WRITE_BUF( F_FDS );

  12131 13 003013   000006 630400 14                 EPPR0   6
        13 003014   000000 631400 14                 EPPR1   0
        13 003015   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 003016   000000 011000                    NOP     0

     1255    12132    3   NEXT_CPOS:
     1256    12133    3           CPOS = CPOS + INDX;

  12133 13 003017   201144 236100       NEXT_CPOS    LDQ     CPOS,,AUTO
        13 003020   201143 036100                    ADLQ    INDX,,AUTO
        13 003021   201144 756100                    STQ     CPOS,,AUTO

     1257    12134    3           F_FDS.NVECS# = 1;

  12134 13 003022   000001 235007                    LDA     1,DL
        13 003023   000063 755000 11                 STA     F_FDS+9

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:196  
     1258    12135    3           LVNUM = 0;

  12135 13 003024   201141 450100                    STZ     LVNUM,,AUTO

     1259    12136                %INIT_STR( STR = VM_CONTINUATION_FMT,
     1260    12137                CODE = E_CONTINUATION_FMT,
     1261    12138                TEST = YES,
     1262    12139                VECT ="F_FDS.FMT_" );

  12146 13 003025   000000 236000 xsym               LDQ     VM_CONTINUATION_FMT
        13 003026   000033 772000                    QRL     27
        13 003027   000000 620006                    EAX0    0,QL
        13 003030   040000 106440                    CMPC    fill='040'O
        13 003031   000000 200010 xsym               ADSC9   VM_CONTINUATION_FMT      cn=1,n=*X0
        13 003032   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 003033   003041 601000 13                 TNZ     s:12151

  12148 13 003034   000170 630400 14                 EPPR0   120
        13 003035   000003 631400 14                 EPPR1   3
        13 003036   000000 701000 xent               TSX1    VMD$ERRMSG
        13 003037   000000 011000                    NOP     0

  12149 13 003040   003046 710000 13                 TRA     s:12163

  12151 13 003041   000000 635010                    EAA     0,X0
        13 003042   000002 771000                    ARL     2
        13 003043   000140 135007                    SBLA    96,DL
        13 003044   000173 236000 14                 LDQ     123
        13 003045   000052 757000 11                 STAQ    F_FDS

     1263    12162
     1264    12163    3       end; /** Of wrapping long output lines!  **/

  12163 13 003046   201144 236100                    LDQ     CPOS,,AUTO
        13 003047   201137 036100                    ADLQ    LWIDTH,,AUTO
        13 003050   201142 116100                    CMPQ    LEN,,AUTO
        13 003051   002713 604000 13                 TMI     s:12122
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:197  

     1265    12164
     1266    12165    2       if LEN = 0

  12165 13 003052   201142 235100                    LDA     LEN,,AUTO
        13 003053   003062 601000 13                 TNZ     s:12167

     1267    12166    2       then VECT_ARRAY(LVNUM) = vector(SPACE);

  12166 13 003054   201141 236100                    LDQ     LVNUM,,AUTO
        13 003055   000001 736000                    QLS     1
        13 003056   000000 620006                    EAX0    0,QL
        13 003057   000126 237000 14                 LDAQ    86
        13 003060   000162 757010 11                 STAQ    VECT_ARRAY,X0
        13 003061   003103 710000 13                 TRA     s:12169

     1268    12167    2       else VECT_ARRAY(LVNUM) = vector( substr(STRING.NAME#,CPOS,LEN-CPOS) );

  12167 13 003062   201141 236100                    LDQ     LVNUM,,AUTO
        13 003063   000001 736000                    QLS     1
        13 003064   201133 470500                    LDP0    @STRING,,AUTO
        13 003065   000100 101500                    MRL     fill='000'O
        13 003066   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
        13 003067   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 003070   201156 220100                    LDX0    I+2,,AUTO
        13 003071   000000 621006                    EAX1    0,QL
        13 003072   201142 236100                    LDQ     LEN,,AUTO
        13 003073   201144 136100                    SBLQ    CPOS,,AUTO
        13 003074   000064 737000                    LLS     52
        13 003075   000140 135007                    SBLA    96,DL
        13 003076   201144 236100                    LDQ     CPOS,,AUTO
        13 003077   000020 736000                    QLS     16
        13 003100   200000 036007                    ADLQ    65536,DL
        13 003101   201133 036100                    ADLQ    @STRING,,AUTO
        13 003102   000162 757011 11                 STAQ    VECT_ARRAY,X1

     1269    12168
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:198  
     1270    12169    2       if LQUOTES

  12169 13 003103   201140 234100                    SZN     LQUOTES,,AUTO
        13 003104   003113 605000 13                 TPL     s:12171

     1271    12170    2       then call BREAKER( VECT_ARRAY(LVNUM) );

  12170 13 003105   201141 236100                    LDQ     LVNUM,,AUTO
        13 003106   000023 736000                    QLS     19
        13 003107   000167 036000 14                 ADLQ    119
        13 003110   201147 756100                    STQ     INDX3,,AUTO
        13 003111   003121 701000 13                 TSX1    BREAKER
        13 003112   000000 011000                    NOP     0

     1272    12171    2       call VMD$WRITE_BUF( F_FDS );

  12171 13 003113   000006 630400 14                 EPPR0   6
        13 003114   000000 631400 14                 EPPR1   0
        13 003115   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 003116   000000 011000                    NOP     0

     1273    12172    2       return;

  12172 13 003117   201132 221300                    LDX1  ! FMT_STR_LEN+1,,AUTO
        13 003120   000001 702211                    TSX2  ! 1,X1

     1274    12173
     1275    12174    2   end WRITE_CONTINUATION;
     1276    12175        %eject;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:199  
     1277    12176        /*I*    NAME:       VMD$BREAKER
     1278    12177                PURPOSE:    To remove Quotes and replace double quotes with
     1279    12178                            single quotes.
     1280    12179                DESCRIPTION:
     1281    12180                            If the input string does not contain a quote,
     1282    12181                            this subroutine does nothing.  Otherwise, the
     1283    12182                            string is copied into TEMPBUF removing the quotes.
     1284    12183        */
     1285    12184    1   BREAKER: proc( VECT );

  12184 13 003121   201146 741300       BREAKER      STX1  ! INDX2,,AUTO

     1286    12185
     1287    12186    2   dcl  VECT        vector;
     1288    12187
     1289    12188    2   dcl  STR$        ptr;
     1290    12189    2   dcl  STRLEN      sbin;
     1291    12190    2   dcl  STR         char(STRLEN) based(STR$);
     1292    12191
     1293    12192    2   dcl  IPOS        sbin;    /**  Insertion point in TEMPBUF  **/
     1294    12193    2   dcl  CPOS        sbin;    /**  current position in STR     **/
     1295    12194    2   dcl  I           sbin;
     1296    12195
     1297    12196
     1298    12197    2       STR$ = vbase(VECT);

  12197 13 003122   201147 470500                    LDP0    @VECT,,AUTO
        13 003123   000001 236100                    LDQ     1,,PR0
        13 003124   201150 756100                    STQ     STR$,,AUTO

     1299    12198    2       STRLEN= vbound(VECT)+1;

  12198 13 003125   000000 236100                    LDQ     0,,PR0
        13 003126   000020 772000                    QRL     16
        13 003127   000001 036007                    ADLQ    1,DL
        13 003130   201151 756100                    STQ     STRLEN,,AUTO

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:200  
     1300    12199
     1301    12200    3       call index(I,'''',STR) whenaltreturn do;

  12200 13 003131   201150 471500                    LDP1    STR$,,AUTO
        13 003132   000000 620006                    EAX0    0,QL
        13 003133   000000 124540                    SCM     mask='000'O
        13 003134   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0
        13 003135   000174 000001 14                 ADSC9   124                      cn=0,n=1
        13 003136   201154 000100                    ARG     I,,AUTO
        13 003137   003141 606400 13                 TTN     s:12201
        13 003140   003143 710000 13                 TRA     s:12204

     1302    12201    3           return;

  12201 13 003141   201146 221300                    LDX1  ! INDX2,,AUTO
        13 003142   000001 702211                    TSX2  ! 1,X1

     1303    12202    3       end;
     1304    12203
     1305    12204    2       IPOS = 0;

  12204 13 003143   201152 450100                    STZ     IPOS,,AUTO

     1306    12205    2       CPOS = 0;

  12205 13 003144   201153 450100                    STZ     CPOS,,AUTO

     1307    12206    2       if I = 0 then CPOS = CPOS + 1;

  12206 13 003145   201154 235100                    LDA     I,,AUTO
        13 003146   003150 601000 13                 TNZ     DEL_QUOTES

  12206 13 003147   201153 054100                    AOS     CPOS,,AUTO

     1308    12207
     1309    12208    2   DEL_QUOTES:
     1310    12209    3       do while( CPOS < STRLEN );
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:201  

  12209 13 003150   201153 236100       DEL_QUOTES   LDQ     CPOS,,AUTO
        13 003151   201151 116100                    CMPQ    STRLEN,,AUTO
        13 003152   003232 605000 13                 TPL     s:12223

     1311    12210    4           call index(I,'''',STR,CPOS+1) whenaltreturn do;

  12210 13 003153   201151 236100                    LDQ     STRLEN,,AUTO
        13 003154   201153 136100                    SBLQ    CPOS,,AUTO
        13 003155   777777 620006                    EAX0    -1,QL
        13 003156   201153 236100                    LDQ     CPOS,,AUTO
        13 003157   000001 036007                    ADLQ    1,DL
        13 003160   201150 470500                    LDP0    STR$,,AUTO
        13 003161   201153 235100                    LDA     CPOS,,AUTO
        13 003162   000000 124545                    SCM     mask='000'O
        13 003163   000000 200010                    ADSC9   0,A,PR0                  cn=1,n=*X0
        13 003164   000174 000001 14                 ADSC9   124                      cn=0,n=1
        13 003165   201154 000100                    ARG     I,,AUTO
        13 003166   201154 056100                    ASQ     I,,AUTO
        13 003167   003171 606400 13                 TTN     s:12212
        13 003170   003211 710000 13                 TRA     s:12217

     1312    12211                /**  No more quotes  **/
     1313    12212    4               substr(TEMPBUF,IPOS) = substr(STR,CPOS);

  12212 13 003171   201151 236100                    LDQ     STRLEN,,AUTO
        13 003172   201153 136100                    SBLQ    CPOS,,AUTO
        13 003173   201152 720100                    LXL0    IPOS,,AUTO
        13 003174   776777 620010                    EAX0    -513,X0
        13 003175   777777 660003                    ERX0    -1,DU
        13 003176   201150 470500                    LDP0    STR$,,AUTO
        13 003177   000000 621006                    EAX1    0,QL
        13 003200   201153 235100                    LDA     CPOS,,AUTO
        13 003201   201152 236100                    LDQ     IPOS,,AUTO
        13 003202   040046 100545                    MLR     fill='040'O
        13 003203   000000 000011                    ADSC9   0,A,PR0                  cn=0,n=*X1
        13 003204   000200 000010 11                 ADSC9   TEMPBUF,Q                cn=0,n=*X0
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:202  

     1314    12213    4               IPOS = IPOS + STRLEN - CPOS;

  12213 13 003205   201151 036100                    ADLQ    STRLEN,,AUTO
        13 003206   201153 136100                    SBLQ    CPOS,,AUTO
        13 003207   201152 756100                    STQ     IPOS,,AUTO

     1315    12214    4               exit DEL_QUOTES;

  12214 13 003210   003232 710000 13                 TRA     s:12223

     1316    12215    4           end;
     1317    12216
     1318    12217    3           I = I - CPOS;   /** Length of this portion **/

  12217 13 003211   201154 236100                    LDQ     I,,AUTO
        13 003212   201153 136100                    SBLQ    CPOS,,AUTO
        13 003213   201154 756100                    STQ     I,,AUTO

     1319    12218    3           substr(TEMPBUF,IPOS,I) = substr(STR,CPOS,I);

  12218 13 003214   000000 620006                    EAX0    0,QL
        13 003215   201154 721100                    LXL1    I,,AUTO
        13 003216   201152 236100                    LDQ     IPOS,,AUTO
        13 003217   040046 100545                    MLR     fill='040'O
        13 003220   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
        13 003221   000200 000011 11                 ADSC9   TEMPBUF,Q                cn=0,n=*X1

     1320    12219    3           IPOS = IPOS + I; /** New insertion point    **/

  12219 13 003222   201154 036100                    ADLQ    I,,AUTO
        13 003223   201152 756100                    STQ     IPOS,,AUTO

     1321    12220    3           CPOS = CPOS + I + 1;

  12220 13 003224   201153 236100                    LDQ     CPOS,,AUTO
        13 003225   201154 036100                    ADLQ    I,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:203  
        13 003226   000001 036007                    ADLQ    1,DL
        13 003227   201153 756100                    STQ     CPOS,,AUTO

     1322    12221    3       end; /** Of do while CPOS < STRLEN **/

  12221 13 003230   201151 116100                    CMPQ    STRLEN,,AUTO
        13 003231   003153 604000 13                 TMI     s:12210

     1323    12222
     1324    12223    2       VECT = vector(substr(TEMPBUF,,IPOS));

  12223 13 003232   201152 235100                    LDA     IPOS,,AUTO
        13 003233   000020 735000                    ALS     16
        13 003234   000140 135007                    SBLA    96,DL
        13 003235   000175 236000 14                 LDQ     125
        13 003236   201147 470500                    LDP0    @VECT,,AUTO
        13 003237   000000 757100                    STAQ    0,,PR0

     1325    12224    2       return;

  12224 13 003240   201146 221300                    LDX1  ! INDX2,,AUTO
        13 003241   000001 702211                    TSX2  ! 1,X1

     1326    12225
     1327    12226    2   end BREAKER;
     1328    12227        %EJECT;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:204  
     1329    12228        /*I*     NAME:         DISPLAY_ADDREC
     1330    12229                 PURPOSE:      To display contents of an address record when
     1331    12230                               a message is displayed.
     1332    12231                 DESCRIPTION:  Read the appropriate address record into the
     1333    12232                               appropriate data segment, then display each
     1334    12233                               entry in the address list.
     1335    12234        */
     1336    12235    1   DISPLAY_ADDREC: PROC(TYPE, NUMBER);

  12235 13 003242   201126 741300       DISPLAY_ADD* STX1  ! SITENAME+3,,AUTO

     1337    12236
     1338    12237    2   DCL TYPE UBIN WORD;
     1339    12238    2   DCL NUMBER UBIN WORD;
     1340    12239
     1341    12240    2   DCL FMT_STR_LEN SBIN WORD;
     1342    12241    2       CALL VMA$GET_ADD_RECORD (TYPE, VM_ADDLIST_,MAIL_DCB#,NUMBER) ALTRET (
             12241                NO_ADDRECORD);

  12241 13 003243   201130 236100                    LDQ     @NUMBER,,AUTO
        13 003244   200005 235100                    LDA     @MAIL_DCB#,,AUTO
        13 003245   201160 757100                    STAQ    I+4,,AUTO
        13 003246   000176 236000 14                 LDQ     126
        13 003247   201127 235100                    LDA     @TYPE,,AUTO
        13 003250   201156 757100                    STAQ    I+2,,AUTO
        13 003251   201156 630500                    EPPR0   I+2,,AUTO
        13 003252   000100 631400 14                 EPPR1   64
        13 003253   000000 701000 xent               TSX1    VMA$GET_ADD_RECORD
        13 003254   004117 702000 13                 TSX2    NO_ADDRECORD

     1343    12242    2       PTR$ = PINCRW(ADDR(VM_ADD_HEAD),SIZEW(VM_ADD_HEAD));

  12242 13 003255   000000 236000 xsym               LDQ     VM_ADDLIST$
        13 003256   000007 036003                    ADLQ    7,DU
        13 003257   200024 756100                    STQ     PTR$,,AUTO

     1344    12243    3       DO I = 0 TO VM_ADD_HEAD.NUM_ENTRIES - 1;
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:205  

  12243 13 003260   200023 450100                    STZ     I,,AUTO
        13 003261   004112 710000 13                 TRA     s:12447+1

     1345    12244    4           IF I = 0 THEN DO;

  12244 13 003262   200023 235100                    LDA     I,,AUTO
        13 003263   003503 601000 13                 TNZ     s:12364

     1346    12245    5               DO SELECT (TYPE);

  12245 13 003264   201127 470500                    LDP0    @TYPE,,AUTO
        13 003265   000000 236100                    LDQ     0,,PR0
        13 003266   000030 116007                    CMPQ    24,DL
        13 003267   003274 602000 13                 TNC     s:12245+8
        13 003270   003427 600000 13                 TZE     s:12296
        13 003271   000040 116007                    CMPQ    32,DL
        13 003272   003526 601000 13                 TNZ     s:12382
        13 003273   003455 710000 13                 TRA     s:12326
        13 003274   000020 116007                    CMPQ    16,DL
        13 003275   003526 601000 13                 TNZ     s:12382
        13 003276   003277 710000 13                 TRA     s:12248

     1347    12246    5                   SELECT(%VM_TYPE_TO);

     1348    12247    6                   DO;

     1349    12248    6                       FMT_STR_LEN = 35;

  12248 13 003277   000043 235007                    LDA     35,DL
        13 003300   201131 755100                    STA     FMT_STR_LEN,,AUTO

     1350    12249                            %INIT_STR(STR=VM_TO_FROM_FMT,CODE=E_TO_FROM_FMT,TEST=YES,VECT=
             12249                                "F_FDS.FMT_");

  12256 13 003301   000000 236000 xsym               LDQ     VM_TO_FROM_FMT
        13 003302   000033 772000                    QRL     27
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:206  
        13 003303   000000 620006                    EAX0    0,QL
        13 003304   040000 106440                    CMPC    fill='040'O
        13 003305   000000 200010 xsym               ADSC9   VM_TO_FROM_FMT           cn=1,n=*X0
        13 003306   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 003307   003315 601000 13                 TNZ     s:12261

  12258 13 003310   000011 630400 14                 EPPR0   9
        13 003311   000003 631400 14                 EPPR1   3
        13 003312   000000 701000 xent               TSX1    VMD$ERRMSG
        13 003313   000000 011000                    NOP     0

  12259 13 003314   003322 710000 13                 TRA     s:12272

  12261 13 003315   000000 635010                    EAA     0,X0
        13 003316   000002 771000                    ARL     2
        13 003317   000140 135007                    SBLA    96,DL
        13 003320   000014 236000 14                 LDQ     12
        13 003321   000052 757000 11                 STAQ    F_FDS

     1351    12272    6                       IF VM_HEADER.FROM$ ~= ADDR(NIL)

  12272 13 003322   000000 470400 xsym               LDP0    VM_HEADER$
        13 003323   000023 236100                    LDQ     19,,PR0
        13 003324   000010 116000 14                 CMPQ    8
        13 003325   003422 600000 13                 TZE     s:12290

     1352    12273    6                       THEN
     1353    12274    7                       DO;   /* Append to end */

     1354    12275    7                           TEMPBUF1 = VM_HEADER.FROM$ -> X$STRING.TEXT;
             12275                                    /* Remove the sitename */

  12275 13 003326   000023 471500                    LDP1    19,,PR0
        13 003327   000100 101500                    MRL     fill='000'O
        13 003330   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 003331   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 003332   201156 220100                    LDX0    I+2,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:207  
        13 003333   040000 100540                    MLR     fill='040'O
        13 003334   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        13 003335   000400 000400 11                 ADSC9   TEMPBUF1                 cn=0,n=256

     1355    12276    7                           CALL INDEX1R(INDX1,'@',SUBSTR(VM_HEADER.FROM$ -> X$STRING.
             12276                                    TEXT,0,VM_HEADER.FROM$ -> X$STRING.SIZ))

  12276 13 003336   000023 471500                    LDP1    19,,PR0
        13 003337   000100 101500                    MRL     fill='000'O
        13 003340   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 003341   201156 000002                    ADSC9   I+2,,AUTO                cn=0,n=2
        13 003342   201156 220100                    LDX0    I+2,,AUTO
        13 003343   000023 473500                    LDP3    19,,PR0
        13 003344   000100 101500                    MRL     fill='000'O
        13 003345   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 003346   201157 000002                    ADSC9   I+3,,AUTO                cn=0,n=2
        13 003347   201157 221100                    LDX1    I+3,,AUTO
        13 003350   000000 636011                    EAQ     0,X1
        13 003351   000022 772000                    QRL     18
        13 003352   000000 125540                    SCMR    mask='000'O
        13 003353   100000 200011                    ADSC9   0,,PR1                   cn=1,n=*X1
        13 003354   000015 000001 14                 ADSC9   13                       cn=0,n=1
        13 003355   200030 000100                    ARG     INDX1,,AUTO
        13 003356   003410 606400 13                 TTN     s:12284
        13 003357   200030 054100                    AOS     INDX1,,AUTO
        13 003360   200030 156100                    SSQ     INDX1,,AUTO

     1356    12277    8                           WHENRETURN DO;

     1357    12278    8                               LEN = VM_HEADER.FROM$ -> X$STRING.SIZ - INDX1 - 1;

  12278 13 003361   000023 471500                    LDP1    19,,PR0
        13 003362   000100 101500                    MRL     fill='000'O
        13 003363   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 003364   201156 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
        13 003365   201156 236100                    LDQ     I+2,,AUTO
        13 003366   200030 136100                    SBLQ    INDX1,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:208  
        13 003367   000001 136007                    SBLQ    1,DL
        13 003370   200026 756100                    STQ     LEN,,AUTO

     1358    12279    8                              CALL XLATE (SITENAME, LOWER_UPPER, SUBSTR(TEMPBUF1,INDX1
             12279                                        +1,LEN));

  12279 13 003371   000000 620006                    EAX0    0,QL
        13 003372   200030 235100                    LDA     INDX1,,AUTO
        13 003373   000000 471400 xsym               LDP1    B$XL_UPPER$
        13 003374   040100 160445                    MVT     fill='040'O
        13 003375   000400 200010 11                 ADSC9   TEMPBUF1,A               cn=1,n=*X0
        13 003376   201123 000010                    ADSC9   SITENAME,,AUTO           cn=0,n=8
        13 003377   100000 000100                    ARG     0,,PR1

     1359    12280    8                               IF SITENAME ~= VM_SITENAME

  12280 13 003400   040000 106500                    CMPC    fill='040'O
        13 003401   201123 000010                    ADSC9   SITENAME,,AUTO           cn=0,n=8
        13 003402   000000 000010 xsym               ADSC9   VM_SITENAME              cn=0,n=8
        13 003403   003410 600000 13                 TZE     s:12284

     1360    12281    8                               THEN
     1361    12282    8                                   INDX1 = VM_HEADER.FROM$ -> X$STRING.SIZ;

  12282 13 003404   000023 473500                    LDP3    19,,PR0
        13 003405   000100 101500                    MRL     fill='000'O
        13 003406   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
        13 003407   200030 000004                    ADSC9   INDX1,,AUTO              cn=0,n=4

     1362    12283    8                           END;

     1363    12284    7                           VECT_ARRAY(1) = VECTOR(ONE);

  12284 13 003410   000016 237000 14                 LDAQ    14
        13 003411   000164 757000 11                 STAQ    VECT_ARRAY+2

     1364    12285    7                           VECT_ARRAY(2) = VECTOR(SUBSTR(TEMPBUF1,0,INDX1));
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:209  

  12285 13 003412   200030 235100                    LDA     INDX1,,AUTO
        13 003413   000020 735000                    ALS     16
        13 003414   000140 135007                    SBLA    96,DL
        13 003415   000020 236000 14                 LDQ     16
        13 003416   000166 757000 11                 STAQ    VECT_ARRAY+4

     1365    12286    7                           F_FDS.NVECS# = 3;

  12286 13 003417   000003 235007                    LDA     3,DL
        13 003420   000063 755000 11                 STA     F_FDS+9

     1366    12287    7                       END;

  12287 13 003421   003526 710000 13                 TRA     s:12382

     1367    12288    6                       ELSE
     1368    12289    7                       DO;   /* Don't print 'FROM:' */

     1369    12290    7                           VECT_ARRAY(1) = VECTOR(ZERO);

  12290 13 003422   000022 237000 14                 LDAQ    18
        13 003423   000164 757000 11                 STAQ    VECT_ARRAY+2

     1370    12291    7                           F_FDS.NVECS# = 2;

  12291 13 003424   000002 235007                    LDA     2,DL
        13 003425   000063 755000 11                 STA     F_FDS+9

     1371    12292    7                       END;

     1372    12293    6                   END; /* SELECT %VM_TYPE_TO */

  12293 13 003426   003526 710000 13                 TRA     s:12382

     1373    12294    5                   SELECT (%VM_TYPE_C);

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:210  
     1374    12295    6                   DO;

     1375    12296    6                       FMT_STR_LEN = 70;

  12296 13 003427   000106 235007                    LDA     70,DL
        13 003430   201131 755100                    STA     FMT_STR_LEN,,AUTO

     1376    12297                            %INIT_STR(STR=VM_COPY_FMT, CODE=E_COPY_FMT, TEST=YES,
     1377    12298                            VECT="F_FDS.FMT_");

  12305 13 003431   000000 236000 xsym               LDQ     VM_COPY_FMT
        13 003432   000033 772000                    QRL     27
        13 003433   000000 620006                    EAX0    0,QL
        13 003434   040000 106440                    CMPC    fill='040'O
        13 003435   000000 200010 xsym               ADSC9   VM_COPY_FMT              cn=1,n=*X0
        13 003436   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 003437   003445 601000 13                 TNZ     s:12310

  12307 13 003440   000064 630400 14                 EPPR0   52
        13 003441   000003 631400 14                 EPPR1   3
        13 003442   000000 701000 xent               TSX1    VMD$ERRMSG
        13 003443   000000 011000                    NOP     0

  12308 13 003444   003452 710000 13                 TRA     s:12321

  12310 13 003445   000000 635010                    EAA     0,X0
        13 003446   000002 771000                    ARL     2
        13 003447   000140 135007                    SBLA    96,DL
        13 003450   000067 236000 14                 LDQ     55
        13 003451   000052 757000 11                 STAQ    F_FDS

     1378    12321    6                       F_FDS.NVECS# = 1;

  12321 13 003452   000001 235007                    LDA     1,DL
        13 003453   000063 755000 11                 STA     F_FDS+9

     1379    12322
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:211  
     1380    12323    6                   END; /* SELECT %VM_TYPE_C */

  12323 13 003454   003526 710000 13                 TRA     s:12382

     1381    12324    5                   SELECT (%VM_TYPE_BC);

     1382    12325    6                   DO;

     1383    12326    6                       FMT_STR_LEN = 70;

  12326 13 003455   000106 235007                    LDA     70,DL
        13 003456   201131 755100                    STA     FMT_STR_LEN,,AUTO

     1384    12327                            %INIT_STR(STR=VM_BLIND_COPY_FMT, CODE=E_BLIND_COPY_FMT,
     1385    12328                            TEST= YES,VECT="F_FDS.FMT_");

  12335 13 003457   000000 236000 xsym               LDQ     VM_BLIND_COPY_FMT
        13 003460   000033 772000                    QRL     27
        13 003461   000000 620006                    EAX0    0,QL
        13 003462   040000 106440                    CMPC    fill='040'O
        13 003463   000000 200010 xsym               ADSC9   VM_BLIND_COPY_FMT        cn=1,n=*X0
        13 003464   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 003465   003473 601000 13                 TNZ     s:12340

  12337 13 003466   000072 630400 14                 EPPR0   58
        13 003467   000003 631400 14                 EPPR1   3
        13 003470   000000 701000 xent               TSX1    VMD$ERRMSG
        13 003471   000000 011000                    NOP     0

  12338 13 003472   003500 710000 13                 TRA     s:12351

  12340 13 003473   000000 635010                    EAA     0,X0
        13 003474   000002 771000                    ARL     2
        13 003475   000140 135007                    SBLA    96,DL
        13 003476   000075 236000 14                 LDQ     61
        13 003477   000052 757000 11                 STAQ    F_FDS

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:212  
     1386    12351    6                       F_FDS.NVECS# = 1;

  12351 13 003500   000001 235007                    LDA     1,DL
        13 003501   000063 755000 11                 STA     F_FDS+9

     1387    12352
     1388    12353    6                   END; /* SELECT %VM_TYPE_BC */

     1389    12354    5               END; /* DO SELECT */

     1390    12355    4           END;

  12355 13 003502   003526 710000 13                 TRA     s:12382

     1391    12356    4           ELSE DO; /* IF I ~= 0 */

     1392    12357                   %INIT_STR(STR=VM_CONTINUATION_FMT,CODE=E_CONTINUATION_FMT,TEST=YES,VECT=
             12357                        "F_FDS.FMT_");

  12364 13 003503   000000 236000 xsym               LDQ     VM_CONTINUATION_FMT
        13 003504   000033 772000                    QRL     27
        13 003505   000000 620006                    EAX0    0,QL
        13 003506   040000 106440                    CMPC    fill='040'O
        13 003507   000000 200010 xsym               ADSC9   VM_CONTINUATION_FMT      cn=1,n=*X0
        13 003510   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 003511   003517 601000 13                 TNZ     s:12369

  12366 13 003512   000170 630400 14                 EPPR0   120
        13 003513   000003 631400 14                 EPPR1   3
        13 003514   000000 701000 xent               TSX1    VMD$ERRMSG
        13 003515   000000 011000                    NOP     0

  12367 13 003516   003524 710000 13                 TRA     s:12380

  12369 13 003517   000000 635010                    EAA     0,X0
        13 003520   000002 771000                    ARL     2
        13 003521   000140 135007                    SBLA    96,DL
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:213  
        13 003522   000173 236000 14                 LDQ     123
        13 003523   000052 757000 11                 STAQ    F_FDS

     1393    12380    4               F_FDS.NVECS# = 1;

  12380 13 003524   000001 235007                    LDA     1,DL
        13 003525   000063 755000 11                 STA     F_FDS+9

     1394    12381    4           END;

     1395    12382    4           IF PTR$->VM$RADDRESS.TYPE = %VM_ADD_UNRESOLVED THEN DO;

  12382 13 003526   200024 470500                    LDP0    PTR$,,AUTO
        13 003527   000002 236100                    LDQ     2,,PR0
        13 003530   000777 376003                    ANQ     511,DU
        13 003531   000002 116003                    CMPQ    2,DU
        13 003532   003750 601000 13                 TNZ     s:12413

     1396    12383    5               IF PTR$->VM$UADDRESS.SITENAME ~= VM_SITENAME THEN DO;

  12383 13 003533   040000 106500                    CMPC    fill='040'O
        13 003534   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        13 003535   000000 000010 xsym               ADSC9   VM_SITENAME              cn=0,n=8
        13 003536   003700 600000 13                 TZE     s:12400

     1397    12384    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
             12384                            THEN DO;

  12384 13 003537   000000 471400 xsym               LDP1    VM_ADDLIST$
        13 003540   100001 235100                    LDA     1,,PR1
        13 003541   000002 115007                    CMPA    2,DL
        13 003542   003632 602000 13                 TNC     s:12392
        13 003543   100001 236100                    LDQ     1,,PR1
        13 003544   000001 136007                    SBLQ    1,DL
        13 003545   200023 116100                    CMPQ    I,,AUTO
        13 003546   003632 604400 13                 TMOZ    s:12392

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:214  
     1398    12385    6                       CALL INDEX(INDX,' ',PTR$->VM$UADDRESS.SITENAME);

  12385 13 003547   000000 124500                    SCM     mask='000'O
        13 003550   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        13 003551   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 003552   200027 000100                    ARG     INDX,,AUTO

     1399    12386    6                       CALL CONCAT(TEXTC.TEXT,

  12386 13 003553   000021 720100                    LXL0    17,,PR0
        13 003554   000777 360003                    ANX0    511,DU
        13 003555   040100 100540                    MLR     fill='040'O
        13 003556   000022 000010                    ADSC9   18,,PR0                  cn=0,n=*X0
        13 003557   200035 200777                    ADSC9   TEXTC,,AUTO              cn=1,n=511
        13 003560   000000 636010                    EAQ     0,X0
        13 003561   000022 772000                    QRL     18
        13 003562   000777 116007                    CMPQ    511,DL
        13 003563   003623 603000 13                 TRC     s:12389
        13 003564   201156 740100                    STX0    I+2,,AUTO
        13 003565   777000 620010                    EAX0    -512,X0
        13 003566   777777 660003                    ERX0    -1,DU
        13 003567   201156 235100                    LDA     I+2,,AUTO
        13 003570   000022 771000                    ARL     18
        13 003571   040145 100400                    MLR     fill='040'O
        13 003572   000015 000001 14                 ADSC9   13                       cn=0,n=1
        13 003573   200035 200010                    ADSC9   TEXTC,A,AUTO             cn=1,n=*X0
        13 003574   201156 236100                    LDQ     I+2,,AUTO
        13 003575   000022 772000                    QRL     18
        13 003576   000776 116007                    CMPQ    510,DL
        13 003577   003623 603000 13                 TRC     s:12389
        13 003600   777001 620006                    EAX0    -511,QL
        13 003601   777777 660003                    ERX0    -1,DU
        13 003602   200027 721100                    LXL1    INDX,,AUTO
        13 003603   040146 100540                    MLR     fill='040'O
        13 003604   000017 600011                    ADSC9   15,,PR0                  cn=3,n=*X1
        13 003605   200035 400010                    ADSC9   TEXTC,Q,AUTO             cn=2,n=*X0
        13 003606   200027 036100                    ADLQ    INDX,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:215  
        13 003607   000776 116007                    CMPQ    510,DL
        13 003610   003623 605000 13                 TPL     s:12389
        13 003611   201157 756100                    STQ     I+3,,AUTO
        13 003612   201156 236100                    LDQ     I+2,,AUTO
        13 003613   000022 772000                    QRL     18
        13 003614   200027 036100                    ADLQ    INDX,,AUTO
        13 003615   201157 721100                    LXL1    I+3,,AUTO
        13 003616   777001 621011                    EAX1    -511,X1
        13 003617   777777 661003                    ERX1    -1,DU
        13 003620   040146 100400                    MLR     fill='040'O
        13 003621   000032 000001 14                 ADSC9   26                       cn=0,n=1
        13 003622   200035 400011                    ADSC9   TEXTC,Q,AUTO             cn=2,n=*X1

     1400    12387    6                         SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,PTR$->VM$UADDRESS.
             12387                                  USER_NAME.COUNT),
     1401    12388    6                         '@',SUBSTR(PTR$->VM$UADDRESS.SITENAME,0,INDX),',');
     1402    12389    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT + INDX + 2;

  12389 13 003623   000021 236100                    LDQ     17,,PR0
        13 003624   000777 376007                    ANQ     511,DL
        13 003625   200027 036100                    ADLQ    INDX,,AUTO
        13 003626   000002 036007                    ADLQ    2,DL
        13 003627   000033 736000                    QLS     27
        13 003630   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1403    12390    6                   END;

  12390 13 003631   004066 710000 13                 TRA     s:12442

     1404    12391    6                   ELSE DO;

     1405    12392    6                       CALL INDEX(INDX,' ',PTR$->VM$UADDRESS.SITENAME);

  12392 13 003632   000000 124500                    SCM     mask='000'O
        13 003633   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        13 003634   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 003635   200027 000100                    ARG     INDX,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:216  

     1406    12393    6                       CALL CONCAT(TEXTC.TEXT,

  12393 13 003636   000021 720100                    LXL0    17,,PR0
        13 003637   000777 360003                    ANX0    511,DU
        13 003640   040100 100540                    MLR     fill='040'O
        13 003641   000022 000010                    ADSC9   18,,PR0                  cn=0,n=*X0
        13 003642   200035 200777                    ADSC9   TEXTC,,AUTO              cn=1,n=511
        13 003643   000000 636010                    EAQ     0,X0
        13 003644   000022 772000                    QRL     18
        13 003645   000777 116007                    CMPQ    511,DL
        13 003646   003671 603000 13                 TRC     s:12396
        13 003647   201156 740100                    STX0    I+2,,AUTO
        13 003650   777000 620010                    EAX0    -512,X0
        13 003651   777777 660003                    ERX0    -1,DU
        13 003652   201156 235100                    LDA     I+2,,AUTO
        13 003653   000022 771000                    ARL     18
        13 003654   040145 100400                    MLR     fill='040'O
        13 003655   000015 000001 14                 ADSC9   13                       cn=0,n=1
        13 003656   200035 200010                    ADSC9   TEXTC,A,AUTO             cn=1,n=*X0
        13 003657   201156 236100                    LDQ     I+2,,AUTO
        13 003660   000022 772000                    QRL     18
        13 003661   000776 116007                    CMPQ    510,DL
        13 003662   003671 603000 13                 TRC     s:12396
        13 003663   777001 620006                    EAX0    -511,QL
        13 003664   777777 660003                    ERX0    -1,DU
        13 003665   200027 721100                    LXL1    INDX,,AUTO
        13 003666   040146 100540                    MLR     fill='040'O
        13 003667   000017 600011                    ADSC9   15,,PR0                  cn=3,n=*X1
        13 003670   200035 400010                    ADSC9   TEXTC,Q,AUTO             cn=2,n=*X0

     1407    12394    6                         SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,PTR$->VM$UADDRESS.
             12394                                  USER_NAME.COUNT),
     1408    12395    6                         '@',SUBSTR(PTR$->VM$UADDRESS.SITENAME,0,INDX));
     1409    12396    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT + INDX + 1;

  12396 13 003671   000021 236100                    LDQ     17,,PR0
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:217  
        13 003672   000777 376007                    ANQ     511,DL
        13 003673   200027 036100                    ADLQ    INDX,,AUTO
        13 003674   000001 036007                    ADLQ    1,DL
        13 003675   000033 736000                    QLS     27
        13 003676   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1410    12397    6                   END;

     1411    12398    5               END;

  12398 13 003677   004066 710000 13                 TRA     s:12442

     1412    12399    5               ELSE DO;

     1413    12400    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
             12400                            THEN DO;

  12400 13 003700   000000 471400 xsym               LDP1    VM_ADDLIST$
        13 003701   100001 235100                    LDA     1,,PR1
        13 003702   000002 115007                    CMPA    2,DL
        13 003703   003737 602000 13                 TNC     s:12406
        13 003704   100001 236100                    LDQ     1,,PR1
        13 003705   000001 136007                    SBLQ    1,DL
        13 003706   200023 116100                    CMPQ    I,,AUTO
        13 003707   003737 604400 13                 TMOZ    s:12406

     1414    12401    6                       CALL CONCAT(TEXTC.TEXT,

  12401 13 003710   000021 720100                    LXL0    17,,PR0
        13 003711   000777 360003                    ANX0    511,DU
        13 003712   040100 100540                    MLR     fill='040'O
        13 003713   000022 000010                    ADSC9   18,,PR0                  cn=0,n=*X0
        13 003714   200035 200777                    ADSC9   TEXTC,,AUTO              cn=1,n=511
        13 003715   000000 636010                    EAQ     0,X0
        13 003716   000022 772000                    QRL     18
        13 003717   000777 116007                    CMPQ    511,DL
        13 003720   003731 603000 13                 TRC     s:12403
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:218  
        13 003721   201156 740100                    STX0    I+2,,AUTO
        13 003722   777000 620010                    EAX0    -512,X0
        13 003723   777777 660003                    ERX0    -1,DU
        13 003724   201156 235100                    LDA     I+2,,AUTO
        13 003725   000022 771000                    ARL     18
        13 003726   040145 100400                    MLR     fill='040'O
        13 003727   000032 000001 14                 ADSC9   26                       cn=0,n=1
        13 003730   200035 200010                    ADSC9   TEXTC,A,AUTO             cn=1,n=*X0

     1415    12402    6                         SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,PTR$->VM$UADDRESS.
             12402                                  USER_NAME.COUNT),',');
     1416    12403    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT + 1;

  12403 13 003731   000021 236100                    LDQ     17,,PR0
        13 003732   000777 376007                    ANQ     511,DL
        13 003733   000001 036007                    ADLQ    1,DL
        13 003734   000033 736000                    QLS     27
        13 003735   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1417    12404    6                   END;

  12404 13 003736   004066 710000 13                 TRA     s:12442

     1418    12405    6                   ELSE DO;

     1419    12406    6                       TEXTC.TEXT = SUBSTR(PTR$->VM$UADDRESS.USER_NAME.TEXT,0,

  12406 13 003737   000021 720100                    LXL0    17,,PR0
        13 003740   000777 360003                    ANX0    511,DU
        13 003741   040100 100540                    MLR     fill='040'O
        13 003742   000022 000010                    ADSC9   18,,PR0                  cn=0,n=*X0
        13 003743   200035 200777                    ADSC9   TEXTC,,AUTO              cn=1,n=511

     1420    12407    6                         PTR$->VM$UADDRESS.USER_NAME.COUNT);
     1421    12408    6                       TEXTC.COUNT = PTR$->VM$UADDRESS.USER_NAME.COUNT;

  12408 13 003744   000021 236100                    LDQ     17,,PR0
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:219  
        13 003745   000033 736000                    QLS     27
        13 003746   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1422    12409    6                   END;

     1423    12410    5               END;

     1424    12411    4           END;

  12411 13 003747   004066 710000 13                 TRA     s:12442

     1425    12412    4           ELSE DO;

     1426    12413    5               IF PTR$->VM$RADDRESS.SITENAME ~= VM_SITENAME THEN DO;

  12413 13 003750   040000 106500                    CMPC    fill='040'O
        13 003751   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        13 003752   000000 000010 xsym               ADSC9   VM_SITENAME              cn=0,n=8
        13 003753   004040 600000 13                 TZE     s:12430

     1427    12414    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
             12414                            THEN DO;

  12414 13 003754   000000 471400 xsym               LDP1    VM_ADDLIST$
        13 003755   100001 235100                    LDA     1,,PR1
        13 003756   000002 115007                    CMPA    2,DL
        13 003757   004016 602000 13                 TNC     s:12422
        13 003760   100001 236100                    LDQ     1,,PR1
        13 003761   000001 136007                    SBLQ    1,DL
        13 003762   200023 116100                    CMPQ    I,,AUTO
        13 003763   004016 604400 13                 TMOZ    s:12422

     1428    12415    6                       CALL INDEX(INDX,' ',PTR$->VM$RADDRESS.SITENAME);

  12415 13 003764   000000 124500                    SCM     mask='000'O
        13 003765   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        13 003766   000002 000001 14                 ADSC9   2                        cn=0,n=1
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:220  
        13 003767   200027 000100                    ARG     INDX,,AUTO

     1429    12416    6                       CALL CONCAT(TEXTC.TEXT,

  12416 13 003770   040100 100500                    MLR     fill='040'O
        13 003771   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
        13 003772   200035 200010                    ADSC9   TEXTC,,AUTO              cn=1,n=8
        13 003773   000100 236003                    LDQ     64,DU
        13 003774   200037 552120                    STBQ    TEXTC+2,'20'O,AUTO
        13 003775   200027 720100                    LXL0    INDX,,AUTO
        13 003776   040100 100540                    MLR     fill='040'O
        13 003777   000017 600010                    ADSC9   15,,PR0                  cn=3,n=*X0
        13 004000   200037 400766                    ADSC9   TEXTC+2,,AUTO            cn=2,n=502
        13 004001   200027 236100                    LDQ     INDX,,AUTO
        13 004002   000766 116007                    CMPQ    502,DL
        13 004003   004011 605000 13                 TPL     s:12419
        13 004004   777011 621006                    EAX1    -503,QL
        13 004005   777777 661003                    ERX1    -1,DU
        13 004006   040146 100400                    MLR     fill='040'O
        13 004007   000032 000001 14                 ADSC9   26                       cn=0,n=1
        13 004010   200037 400011                    ADSC9   TEXTC+2,Q,AUTO           cn=2,n=*X1

     1430    12417    6                         PTR$->VM$RADDRESS.ACCT,
     1431    12418    6                         '@',SUBSTR(PTR$->VM$RADDRESS.SITENAME,0,INDX),',');
     1432    12419    6                       TEXTC.COUNT = INDX + 8 + 2;

  12419 13 004011   200027 236100                    LDQ     INDX,,AUTO
        13 004012   000012 036007                    ADLQ    10,DL
        13 004013   000033 736000                    QLS     27
        13 004014   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1433    12420    6                   END;

  12420 13 004015   004066 710000 13                 TRA     s:12442

     1434    12421    6                   ELSE DO;

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:221  
     1435    12422    6                       CALL INDEX(INDX,' ',PTR$->VM$RADDRESS.SITENAME);

  12422 13 004016   000000 124500                    SCM     mask='000'O
        13 004017   000017 600010                    ADSC9   15,,PR0                  cn=3,n=8
        13 004020   000002 000001 14                 ADSC9   2                        cn=0,n=1
        13 004021   200027 000100                    ARG     INDX,,AUTO

     1436    12423    6                       CALL CONCAT(TEXTC.TEXT,

  12423 13 004022   040100 100500                    MLR     fill='040'O
        13 004023   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
        13 004024   200035 200010                    ADSC9   TEXTC,,AUTO              cn=1,n=8
        13 004025   000100 236003                    LDQ     64,DU
        13 004026   200037 552120                    STBQ    TEXTC+2,'20'O,AUTO
        13 004027   200027 720100                    LXL0    INDX,,AUTO
        13 004030   040100 100540                    MLR     fill='040'O
        13 004031   000017 600010                    ADSC9   15,,PR0                  cn=3,n=*X0
        13 004032   200037 400766                    ADSC9   TEXTC+2,,AUTO            cn=2,n=502

     1437    12424    6                         PTR$->VM$RADDRESS.ACCT,
     1438    12425    6                         '@',SUBSTR(PTR$->VM$RADDRESS.SITENAME,0,INDX));
     1439    12426    6                       TEXTC.COUNT = INDX + 8 + 1;

  12426 13 004033   200027 236100                    LDQ     INDX,,AUTO
        13 004034   000011 036007                    ADLQ    9,DL
        13 004035   000033 736000                    QLS     27
        13 004036   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1440    12427    6                   END;

     1441    12428    5               END;

  12428 13 004037   004066 710000 13                 TRA     s:12442

     1442    12429    5               ELSE DO;

     1443    12430    6                   IF VM_ADD_HEAD.NUM_ENTRIES > 1 AND I < VM_ADD_HEAD.NUM_ENTRIES - 1
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:222  
             12430                            THEN DO;

  12430 13 004040   000000 471400 xsym               LDP1    VM_ADDLIST$
        13 004041   100001 235100                    LDA     1,,PR1
        13 004042   000002 115007                    CMPA    2,DL
        13 004043   004061 602000 13                 TNC     s:12436
        13 004044   100001 236100                    LDQ     1,,PR1
        13 004045   000001 136007                    SBLQ    1,DL
        13 004046   200023 116100                    CMPQ    I,,AUTO
        13 004047   004061 604400 13                 TMOZ    s:12436

     1444    12431    6                       CALL CONCAT(TEXTC.TEXT,

  12431 13 004050   040100 100500                    MLR     fill='040'O
        13 004051   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
        13 004052   200035 200010                    ADSC9   TEXTC,,AUTO              cn=1,n=8
        13 004053   040100 100400                    MLR     fill='040'O
        13 004054   000032 000001 14                 ADSC9   26                       cn=0,n=1
        13 004055   200037 200767                    ADSC9   TEXTC+2,,AUTO            cn=1,n=503

     1445    12432    6                         PTR$->VM$RADDRESS.ACCT,',');
     1446    12433    6                       TEXTC.COUNT = 9;

  12433 13 004056   011000 236003                    LDQ     4608,DU
        13 004057   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1447    12434    6                   END;

  12434 13 004060   004066 710000 13                 TRA     s:12442

     1448    12435    6                   ELSE DO;

     1449    12436    6                       TEXTC.TEXT = PTR$->VM$RADDRESS.ACCT;

  12436 13 004061   040100 100500                    MLR     fill='040'O
        13 004062   000021 600010                    ADSC9   17,,PR0                  cn=3,n=8
        13 004063   200035 200777                    ADSC9   TEXTC,,AUTO              cn=1,n=511
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:223  

     1450    12437    6                       TEXTC.COUNT = 8;

  12437 13 004064   010000 236003                    LDQ     4096,DU
        13 004065   200035 552140                    STBQ    TEXTC,'40'O,AUTO

     1451    12438    6                   END;

     1452    12439    5               END;

     1453    12440    4           END;

     1454    12441
     1455    12442    3           CALL WRITE_CONTINUATION(TEXTC, FMT_STR_LEN, '1'b );

  12442 13 004066   000010 236000 14                 LDQ     8
        13 004067   201136 756100                    STQ     @VNUM,,AUTO
        13 004070   000027 236000 14                 LDQ     23
        13 004071   201135 756100                    STQ     @QUOTES,,AUTO
        13 004072   201131 630500                    EPPR0   FMT_STR_LEN,,AUTO
        13 004073   201134 450500                    STP0    @WIDTH,,AUTO
        13 004074   200035 631500                    EPPR1   TEXTC,,AUTO
        13 004075   201133 451500                    STP1    @STRING,,AUTO
        13 004076   002662 701000 13                 TSX1    WRITE_CONTINUATION
        13 004077   000000 011000                    NOP     0

     1456    12443              /* Back up one word to get the size of the current entry, then
     1457    12444                 move forward by that number of words to the next entry. */
     1458    12445    3           PTR$ = PINCRW(PTR$, -1);

  12445 13 004100   200024 236100                    LDQ     PTR$,,AUTO
        13 004101   777777 036003                    ADLQ    -1,DU
        13 004102   200024 756100                    STQ     PTR$,,AUTO

     1459    12446    3           PTR$ = PINCRW(PTR$, PTR$->BSD + 1);

  12446 13 004103   200024 470500                    LDP0    PTR$,,AUTO
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:224  
        13 004104   000000 236100                    LDQ     0,,PR0
        13 004105   000022 736000                    QLS     18
        13 004106   000001 036003                    ADLQ    1,DU
        13 004107   200024 036100                    ADLQ    PTR$,,AUTO
        13 004110   200024 756100                    STQ     PTR$,,AUTO

     1460    12447    3       END;

  12447 13 004111   200023 054100                    AOS     I,,AUTO
        13 004112   000000 470400 xsym               LDP0    VM_ADDLIST$
        13 004113   200023 236100                    LDQ     I,,AUTO
        13 004114   003262 604000 13                 TMI     s:12244
        13 004115   000001 116100                    CMPQ    1,,PR0
        13 004116   003262 602000 13                 TNC     s:12244

     1461    12448    2   NO_ADDRECORD:
     1462    12449    2       RETURN;

  12449 13 004117   201126 221300       NO_ADDRECORD LDX1  ! SITENAME+3,,AUTO
        13 004120   000001 702211                    TSX2  ! 1,X1

CONVERT_TIME
 Sect OctLoc
  11     000   000001 777640   000012 006000   000000 177640   000000 006014    ................
  11     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     010   000000 177640   000000 006014   004003 000000   ****** ******    ................

FETCH_ERROR_TEXT
 Sect OctLoc
  11     014   000003 777640   000042 006000   000000 177640   000000 006014    ....."..........
  11     020   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     034*  000000 177640   000000 006014   000003 777640   000046 006000    .............&..
  11     040   000000 177640   000000 006014   000000 000000   000000 000000    ................
  11     044   375000 030001   040000 000000                                    .... ...

VLR_ERRMSG
 Sect OctLoc
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:225  
  11     046   00000* ***000   000000 000000   000000 000000   ****** ******    ................

F_FDS
 Sect OctLoc
  11     052   000000 177640   000000 006014   000000 000000   000000 000000    ................
  11     056   000000 000000   000000 177640   000000 006014   000000 000001    ................
  11     062   000000 000000   000000 000000   000162 006000   000000 101500    .........r....A.
  11     066   000000 000000   000000 000000   000000 000001   000000 000012    ................
  11     072   000000 000000   ****** ******   ****** ******   000000 000000    ................
  11     076   000000 000000   000000 000000   000000 000000   000000 006014    ................
  11     102   000000 006014   000000 006014   000000 006014   000000 000000    ................
  11     106   000000 000000   000000 000000                                    ........

SPACE_LINE
 Sect OctLoc
  11     110   000000 577640   000210 006000   000000 000000   000000 000000    ................
  11     114   000000 000000   000000 177640   000000 006014   000000 000001    ................
  11     120   000000 000000   000000 000000   000162 006000   000000 101500    .........r....A.
  11     124   000000 000000   000000 000000   000000 000001   000000 000012    ................
  11     130   000000 000000   ****** ******   ****** ******   000000 000000    ................
  11     134   000000 000000   000000 000000   000000 000000   000000 006014    ................
  11     140   000000 006014   000000 006014   000000 006014   000000 000000    ................
  11     144   000000 000000   000000 000000                                    ........

BODY_WRITE
 Sect OctLoc
  11     146   000003 777640   000156 006000   000000 177640   000000 006014    .....n..........
  11     152   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     156   000000 400400   000000 000000   000000 000000   000000 000000    ................

VECT_ARRAY
 Sect OctLoc
  11     162   ****** ******   ****** ******   ****** ******   ****** ******    ................

TEMPBUF
 Sect OctLoc
  11     200   ****** ******   ****** ******   ****** ******   ****** ******    ................
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:226  

TEMPBUF1
 Sect OctLoc
  11     400   ****** ******   ****** ******   ****** ******   ****** ******    ................

TEMPBUF2
 Sect OctLoc
  11     500   ****** ******   ****** ******   ****** ******   ****** ******    ................

VM_BODYREC
 Sect OctLoc
  11     600   001000 000000   ****** ******   ****** ******   ****** ******    ................
  11     714*  ****** ******                                                    ....

PAGESIZE
 Sect OctLoc
  11     716   000000 010000                                                    ....

SPACE
 Sect OctLoc
  12     000   040*** ******                                                     ...

ONE
 Sect OctLoc
  12     001   000000 000001                                                    ....

ZERO
 Sect OctLoc
  12     002   000000 000000                                                    ....

DEL_FLAG
 Sect OctLoc
  12     003   144*** ******                                                    d...

FWD_FLAG
 Sect OctLoc
  12     004   146*** ******                                                    f...
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:227  

DELIMITER_TABLE
 Sect OctLoc
  12     005   000000 000000   000000 000000   000000 000000   000000 000000    ................
  12     015*  001000 000000   000000 000000   000000 000000   000001 001000    ................
  12     021   000000 000000   000000 000000   000000 000000   000000 000000    ................
  12     201*  000000 000000   000000 000000   000000 000000   000000 000000    ................

BODY_FMT
 Sect OctLoc
  12     205   045101 ******                                                    %A..

SIGNED_FMT
 Sect OctLoc
  12     206   045064 060130   045074 076101                                    %40X%<>A

BLANK_LINE_FMT
 Sect OctLoc
  12     210   045061 130***                                                    %1X.

SPACEC
 Sect OctLoc
  12     211   001040 ******                                                    . ..

(unnamed)
 Sect OctLoc
  12     212   072123 131123   074076 040040                                    :SYS<>

(unnamed)
 Sect OctLoc
  14     000   000001 000000   000110 006000   040040 040040   000003 000000    .....H..    ....
  14     004   000000 006000   000000 006000   000052 006000   000000 206000    .........*......
  14     010   000000 006014   000000 006000   000000 006000   000052 006000    .............*..
  14     014   000000 206000   100040 040040   000000 777640   000001 006000    ....@   ........
  14     020   000400 006000   000000 000000   000000 777640   000002 006000    ................
  14     024   000000 000043   400000 000000   000024 006000   000025 006000    ...#............
  14     030   000000 000020   000030 006000   054040 040040   000000 006000    ........,   ....
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:228  
  14     034   000000 006000   000052 006000   000000 206000   000000 000106    .....*.........F
  14     040   000037 006000   000025 006000   000000 006000   000000 006000    ................
  14     044   000052 006000   000000 206000   777777 777777   000000 006000    .*..............
  14     050   000000 006000   000052 006000   000000 206000   000000 006000    .....*..........
  14     054   000000 006000   000052 006000   000000 206000   000002 000000    .....*..........
  14     060   000000 006000   000000 006000   000000 206000   000211 006000    ................
  14     064   000000 006000   000000 006000   000052 006000   000000 206000    .........*......
  14     070   000000 000030   000070 006000   000000 006000   000000 006000    .....8..........
  14     074   000052 006000   000000 206000   000000 000040   000076 006000    .*......... .>..
  14     100   000004 000000   000000 000144   000101 006000   000000 006000    .......d.A......
  14     104   777777 600000   000000 006000   000000 006000   000052 006000    .............*..
  14     110   000000 206000   000000 006000   000000 006000   000052 006000    .............*..
  14     120*  000000 206000   000000 000000   000000 777640   000715 006000    ................
  14     124   000000 177640   000004 006000   000000 177640   000000 006000    ................
  14     130   000000 177640   000003 006000   000000 377640   000205 006000    ................
  14     134   000000 000000   000007 000000   000161 006000   000600 006000    .........q......
  14     140   000453 777640   056040 040040   000007 777640   000001 777640    .....   ........
  14     144   000000 177640   000000 006014   000002 577640   000441 600000    ................
  14     150   000002 777640   000177 777640   074040 040040   076040 040040    ........<   >
  14     154   000035 200000   000000 006000   000000 006000   000052 006000    .............*..
  14     160   000000 206000   000000 006003   000602 006000   677777 777777    ................
  14     164   737777 777777   000004 200000   060040 040040   000162 006000    ........0   .r..
  14     170   000000 006000   000000 006000   000052 006000   000000 206000    .........*......
  14     174   047040 040040   000200 006000   000000 006000                    '   ........
     1463    12450    2   END DISPLAY_ADDREC;
     1464    12451    1   END VMD$DI_MESSAGE;
     1465    12452        %EOD;

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:229  
--  Include file information  --

   B$TABLES_C.:LIB_E05  cannot be made into a system file and is referenced.
   XUR_ENTRY.:LIB_E05  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMD$DI_MESSAGE.
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:230  

 **** Variables and constants ****

  ****  Section 011  Data  VMD$DI_MESSAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   146-0-0/d STRC(432)   r     1 BODY_WRITE                 0-0-0/d STRC(432)   r     1 CONVERT_TIME
   715-0-0/w SBIN        r     1 ENCL_NUM                  14-0-0/d STRC(936)   r     1 FETCH_ERROR_TEXT
    52-0-0/w STRC(1080)  r     1 F_FDS                    716-0-0/w SBIN        r     1 PAGESIZE
   110-0-0/w STRC(1080)  r     1 SPACE_LINE               200-0-0/c CHAR(512)   r     1 TEMPBUF
   400-0-0/c CHAR(256)   r     1 TEMPBUF1                 500-0-0/c CHAR(256)   r     1 TEMPBUF2
   162-0-0/d VECT        r     1 VECT_ARRAY(0:6)
    46-0-0/d STRC(144)   r     1 VLR_ERRMSG               600-0-0/w STRC(2772)  r     1 VM_BODYREC

  ****  Section 012 RoData VMD$DI_MESSAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   210-0-0/c CHAR(3)     r     1 BLANK_LINE_FMT           205-0-0/c CHAR(2)     r     1 BODY_FMT
     5-0-0/b UBIN(9)     r     1 DELIMITER_TABLE(0:511)
     3-0-0/c CHAR        r     1 DEL_FLAG                   4-0-0/c CHAR        r     1 FWD_FLAG
     1-0-0/w UBIN        r     1 ONE                      206-0-0/c CHAR(8)           1 SIGNED_FMT
     0-0-0/c CHAR        r     1 SPACE                    211-0-0/c STRC(18)    r     1 SPACEC
     2-0-0/w UBIN        r     1 ZERO

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    10-0-0/w PTR         r     1 @ENTRY_REASON#             5-0-0/w PTR         r     1 @MAIL_DCB#
     3-0-0/w PTR         r     1 @MESSAGE_NUMBER         1130-0-0/w PTR         r     1 @NUMBER
     4-0-0/w PTR         r     1 @OUT_DCB#               1135-0-0/w PTR         r     1 @QUOTES
     6-0-0/w PTR         r     1 @SEED                   1133-0-0/w PTR         r     1 @STRING
     7-0-0/w PTR         r     1 @TRACE                  1127-0-0/w PTR         r     1 @TYPE
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:231  
  1147-0-0/w PTR         r     1 @VECT                   1136-0-0/w PTR         r     1 @VNUM
  1134-0-0/w PTR         r     1 @WIDTH                  1134-0-0/w PTR         r     1 BODYREC$
  1136-0-0/w SBIN        r     1 CHAR_RMNG                 33-0-0/b STRC        r     1 CODE
  1122-0-0/w SBIN        r     1 COUNT                   1144-0-0/w SBIN        r     1 CPOS
  1153-0-0/w SBIN        r     1 CPOS                    1140-0-0/w UBIN        r     1 DEVC_WIDTH
    32-0-0/w SBIN        r     1 DUMMY                     25-0-0/w PTR         r     1 ENCL$
    *0-0-0/w SBIN        r     1 ENTRY_REASON#
   446-0-0/c CHAR(120)   r     1 ERRMSG_BUF(0:9)
    21-0-0/c STRC(72)    r     1 ERRMSG_FILE_ACCT          11-0-0/c STRC(288)   r     1 ERRMSG_FILE_NAME
  1131-0-0/w SBIN        r     1 FMT_STR_LEN             1143-0-0/b BIT         r     1 HIT
    23-0-0/w SBIN        r     1 I                       1127-0-0/w UBIN        r     1 I
  1154-0-0/w SBIN        r     1 I                       1130-0-0/w UBIN        r     1 ID#
  1131-0-0/c CHAR(10)    r     1 ID#TEXT                   27-0-0/w SBIN        r     1 INDX
  1144-0-0/w SBIN        r     1 INDX                    1143-0-0/w SBIN        r     1 INDX
    30-0-0/w SBIN        r     1 INDX1                   1145-0-0/w SBIN        r     1 INDX1
  1146-0-0/w SBIN        r     1 INDX2                   1147-0-0/w SBIN        r     1 INDX3
  1152-0-0/w SBIN        r     1 IPOS                      26-0-0/w SBIN        r     1 LEN
  1142-0-0/w SBIN        r     1 LEN                     1140-0-0/b BIT         r     1 LQUOTES
  1141-0-0/w SBIN        r     1 LVNUM                   1137-0-0/w SBIN        r     1 LWIDTH
    *0-0-0/w UBIN        r     1 MAIL_DCB#                 *0-0-0/w UBIN        r     1 MESSAGE_NUMBER
    *0-0-0/w UBIN        r     1 NUMBER                    *0-0-0/w SBIN        r     1 OUT_DCB#
    24-0-0/w PTR         r     1 PTR$                      *0-0-0/w BIT         r     1 QUOTES
  1135-0-0/w PTR         r     1 REF$                      31-0-0/w SBIN        r     1 REFERENCE_ID
    *0-0-0/w BIT         r     1 SEED                    1123-0-0/c CHAR(8)     r     1 SITENAME
  1137-0-0/w UBIN        r     1 SIZE_BUF                1150-0-0/w PTR         r     1 STR$
    *0-0-0/c ASTR(9)     r     1 STRING                  1151-0-0/w SBIN        r     1 STRLEN
    35-0-0/c STRC(4608)  r     1 TEXTC                    235-0-0/c STRC(4608)  r     1 TEXTC2
   435-0-0/c STRC(198)   r     1 TIMEBUF                  443-0-0/c STRC(108)   r     1 TIME_TEXTC
    *0-0-0/b BIT         r     1 TRACE                     *0-0-0/w UBIN        r     1 TYPE
    34-0-0/w UBIN        r     1 UTS                       *0-0-0/d VECT        r     1 VECT
    *0-0-0/w SBIN        r     1 VNUM                      *0-0-0/w SBIN        r     1 WIDTH

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:232  
     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/w PTR         r     1 B$XL_UPPER$                0-0-0/c ASTR(9)     r     1 ERRMSG_FID
     0-0-0/w STRC        r     1 E_BLIND_COPY_FMT           0-0-0/w STRC        r     1 E_CONTINUATION_FMT
     0-0-0/w STRC        r     1 E_COPY_FMT                 0-0-0/w STRC        r     1 E_DATE_NUMBER_FMT
     0-0-0/w STRC        r     1 E_ENCL_1_FMT               0-0-0/w STRC        r     1 E_ENCL_2_FMT
     0-0-0/w STRC        r     1 E_ENCL_FWD_FMT             0-0-0/w STRC        r     1 E_ERROR_ADDRESS_FMT
     0-0-0/w STRC        r     1 E_REFERENCE_AND_ID_FMT
     0-0-0/w STRC        r     1 E_REFERENCE_FMT            0-0-0/w STRC        r     1 E_REPLY_TO_FMT
     0-0-0/w STRC        r     1 E_RE_STRING                0-0-0/w STRC        r     1 E_SUBJECT_FMT
     0-0-0/w STRC        r     1 E_TO_FROM_FMT              0-0-0/w UBIN              1 M$DO_NUM
     0-0-0/w UBIN              1 M$LO_NUM                   0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM
     0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM        0-0-0/w UBIN              1 M$MAIL_FILE_NUM
     0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM          0-0-0/w UBIN              1 M$ME_NUM
     0-0-0/w UBIN              1 M$NODE_NUM                 0-0-0/w UBIN              1 M$SI_NUM
     0-0-0/w UBIN              1 M$WORK_NUM                 0-0-0/w PTR         r     1 VM_ADDLIST$
     0-0-0/d VECT        r     1 VM_ADDLIST_                0-0-0/w PTR               1 VM_ADDREC$
     0-0-0/d VECT              1 VM_ADDREC_                 0-0-0/c ASTR(9)     r     1 VM_BLIND_COPY_FMT
     0-0-0/c ASTR(9)     r     1 VM_CONTINUATION_FMT        0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/c ASTR(9)     r     1 VM_COPY_FMT
     0-0-0/c ASTR(9)     r     1 VM_DATE_NUMBER_FMT         0-0-0/w PTR         r     1 VM_ENCLLIST$
     0-0-0/d VECT        r     1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c ASTR(9)     r     1 VM_ENCL_1_FMT
     0-0-0/c ASTR(9)     r     1 VM_ENCL_2_FMT              0-0-0/c ASTR(9)     r     1 VM_ENCL_FWD_FMT
     0-0-0/c ASTR(9)     r     1 VM_ERROR_ADDRESS_FMT       0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
     0-0-0/w PTR         r     1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)          1 VM_MAIL_ACCT
     0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR         r     1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_
     0-0-0/c ASTR(9)     r     1 VM_REFERENCE_AND_ID_FMT
     0-0-0/c ASTR(9)     r     1 VM_REFERENCE_FMT           0-0-0/c ASTR(9)     r     1 VM_REPLY_TO_FMT
     0-0-0/c ASTR(9)     r     1 VM_RE_STRING               0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)     r     1 VM_SITENAME                0-0-0/c ASTR(9)     r     1 VM_SUBJECT_FMT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:233  
     0-0-0/c ASTR(9)     r     1 VM_TO_FROM_FMT             0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c ASTR(9)     r     1 BASED_TEXTC                0-0-0/w SBIN        r     1 BSD
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(4608)  r     1 LOWER_UPPER
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$MAIL_CENTRAL             0-0-0N  NULL        r     1 M$MAIL_COMGROUP
     0-0-0N  NULL        r     1 M$MAIL_FILE                0-0-0N  NULL        r     1 M$MAIL_GLOBAL
     0-0-0N  NULL        r     1 M$ME                       0-0-0N  NULL        r     1 M$NODE
     0-0-0N  NULL        r     1 M$SI                       0-0-0N  NULL        r     1 M$UC
     0-0-0N  NULL        r     1 M$WORK                     0-0-0/c ACHR        r     1 STR
     0-0-0/w STRC(711)   r     1 VM$RADDRESS                0-0-0/w STRC(2448)  r     1 VM$UADDRESS
     0-0-0/w STRC(252)   r     1 VM_ADD_HEAD                0-0-0/w STRC(2772)  r     1 VM_BODYREC_ENCODED
     0-0-0/w STRC(432)   r     1 VM_ENCLOS                  0-0-0/w STRC(252)   r     1 VM_ENCL_HEAD
     0-0-0/w STRC(1332)  r     1 VM_HEADER                  0-0-0/w STRC(4068)  r     1 VM_PROFILE
     0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMD$DI_MESSAGE requires 2129 words for executable code.
   Procedure VMD$DI_MESSAGE requires 632 words of local(AUTO) storage.
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:234  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:235  
          MINI XREF LISTING

B$ALT.CODE
     10109**DCL     10109--REDEF   10110--REDEF   10110--REDEF
B$ALT.ERR.CODE
     10111**DCL     11605>>IF      12036>>IF      12041>>IF
B$ALT.ERR.ERR#
     10111**DCL     10111--REDEF
B$ALT.EVID
     10110**DCL     10110--REDEF   10110--REDEF
B$TCB.ALT$
     10105**DCL     11605>>IF      12036>>IF      12041>>IF
B$TCB$
      8977**DCL     10105--IMP-PTR 11605>>IF      12036>>IF      12041>>IF
B$XL_UPPER$
      9503**DCL      9504--IMP-PTR 11296>>CALLBLT 11329>>CALLBLT 11341>>CALLBLT 11355>>CALLBLT 12279>>CALLBLT
BASED_TEXTC
     10227**DCL     11427<>CALL    11713--ASSIGN  11716--ASSIGN  12058>>ASSIGN  12063<>CALL
BASED_TEXTC.COUNT
     10228**DCL     10229--IMP-SIZ 11427>>CALL    11713>>ASSIGN  11716>>ASSIGN  12058>>ASSIGN  12061>>IF
     12063>>CALL
BLANK_LINE_FMT
     11211**DCL      9761--DCLINIT  9763--DCLINIT
BODYREC$ IN PROCEDURE DISPLAY_BODY_RECORD
     11980**DCL     11996--IMP-PTR 12055<<ASSIGN  12056>>ASSIGN  12057>>ASSIGN  12058>>ASSIGN  12058>>ASSIGN
     12060>>ASSIGN
BODY_FMT
     11205**DCL     11733--ASSIGN  11894--ASSIGN
BODY_WRITE
      9872**DCL     12034<>CALL
BODY_WRITE.BUF_.BOUND
      9872**DCL     12033<<ASSIGN
BODY_WRITE.BUF_.BUF$
      9874**DCL     12029<<ASSIGN  12047<<ASSIGN  12047>>ASSIGN
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:236  
BODY_WRITE.STATION_
      9874**DCL      9874--REDEF
BODY_WRITE.V
      9875**DCL      9872--DCLINIT
BODY_WRITE.V.DCB#
      9875**DCL     11732<<ASSIGN  11781<<ASSIGN
BODY_WRITE.V.DVBYTE
      9880**DCL     11739<>CALL    11743<>CALL    11784<>CALL
BODY_WRITE.V.DVBYTE.BIN#
      9881**DCL     12043<<ASSIGN
BODY_WRITE.V.DVBYTE.VFC#
      9881**DCL      9881--REDEF   12038<<ASSIGN  12049<<ASSIGN
BREAKER
     12184**PROC    12130--CALL    12170--CALL
BSD
     11214**DCL     11310<>CALL    11386<>CALL    11419<>CALL    11518<>CALL    11552<>CALL    11589<>CALL
     12446>>ASSIGN
CHAR_RMNG IN PROCEDURE DISPLAY_BODY_RECORD
     11982**DCL     12028<<ASSIGN  12031>>DOUNTIL 12032>>ASSIGN  12048<<ASSIGN  12048>>ASSIGN
CODE
     10214**DCL     11759<<ASSIGN  11845--ASSIGN  12056<<ASSIGN
CODE.MON
     10217**DCL     11846>>ASSIGN
CONVERT_TIME
      9527**DCL     11870<>CALL
CONVERT_TIME.DATE_
      9527**DCL     11866<<ASSIGN
CONVERT_TIME.DAY_
      9530**DCL     11868<<ASSIGN
CONVERT_TIME.TIME_
      9529**DCL     11867<<ASSIGN
CONVERT_TIME.TSTAMP_
      9530**DCL     11865<<ASSIGN
CONVERT_TIME.V
      9531**DCL      9527--DCLINIT
COUNT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:237  
     10462**DCL     11739<>CALL    11743<>CALL    11784<>CALL    11825>>IF      11825>>IF      12021>>IF
     12027>>ASSIGN  12028>>ASSIGN
CPOS IN PROCEDURE BREAKER
     12193**DCL     12205<<ASSIGN  12206<<ASSIGN  12206>>ASSIGN  12209>>DOWHILE 12210>>CALLBLT 12212>>ASSIGN
     12213>>ASSIGN  12217>>ASSIGN  12218>>ASSIGN  12220<<ASSIGN  12220>>ASSIGN
CPOS IN PROCEDURE WRITE_CONTINUATION
     12110**DCL     12118<<ASSIGN  12120>>DOWHILE 12122>>CALLBLT 12123>>IF      12123>>ASSIGN  12124>>ASSIGN
     12125>>IF      12126>>ASSIGN  12133<<ASSIGN  12133>>ASSIGN  12167>>ASSIGN  12167>>ASSIGN
CRYPT_CHECK
     11815**PROC    11741--CALL    11745--CALL    11786--CALL
DELIMITER_TABLE
     10472**DCL     12122>>CALLBLT
DEL_FLAG
     10467**DCL     11703--ASSIGN
DEL_QUOTES IN PROCEDURE BREAKER
     12209**LABEL   12214--EXIT
DEVC_WIDTH IN PROCEDURE DISPLAY_BODY_RECORD
     11984**DCL     12026<<ASSIGN  12027>>IF      12027<<ASSIGN  12032>>ASSIGN
DISPLAY_ADDREC
     12235**PROC    11314--CALL    11555--CALL    11592--CALL
DISPLAY_BODY_RECORD
     11975**PROC    11747--CALL    11787--CALL
DISPLAY_ENCODED_ERROR
     11836**PROC    11769--CALL    12076--CALL
DI_ENCL
     11602**LABEL   11607--GOTO    11639--EXIT
DUMMY
     10210**DCL     11506<<ASSIGN  11508>>DOWHILE 11510<<ASSIGN  11510>>ASSIGN  12122<<CALLBLT
ENCL$
     10205**DCL     10412--IMP-PTR 11690<<ASSIGN  11694>>ASSIGN  11697>>IF      11702>>IF      11707>>ASSIGN
     11709>>IF      11716>>ASSIGN  11716>>ASSIGN  11722<<ASSIGN  11722>>ASSIGN
ENCL_NUM
     10469**DCL     11694<<ASSIGN  11695--ASSIGN
ENTRY_REASON#
      9512**DCL        12--PROC    11612--IF      11612>>IF
ERRMSG_BUF
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:238  
     10237**DCL     11844--ASSIGN  11898>>CALLBLT 11901>>CALLBLT 11902>>CALLBLT 11906>>CALLBLT 11906>>CALLBLT
     11910>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT 11917<<ASSIGN  11923--ASSIGN  11926>>IF
     11932--ASSIGN
ERRMSG_FID.L#
      9045**DCL      9045--IMP-SIZ 11848>>CALLBLT 11850>>ASSIGN  11851>>IF      11855>>ASSIGN
ERRMSG_FID.NAME#
      9045**DCL     11848>>CALLBLT 11850>>ASSIGN  11855>>ASSIGN
ERRMSG_FILE_ACCT
      9626**DCL     11858--ASSIGN
ERRMSG_FILE_ACCT.ACCT#
      9626**DCL     11853<<ASSIGN  11855<<ASSIGN
ERRMSG_FILE_NAME
      9613**DCL     11857--ASSIGN
ERRMSG_FILE_NAME.L#
      9613**DCL     11849<<ASSIGN
ERRMSG_FILE_NAME.NAME#
      9613**DCL     11850<<ASSIGN
E_BLIND_COPY_FMT
     10901**DCL     11574<>CALL    12337<>CALL
E_BODY
     11790**LABEL   11784--CALLALT
E_CONTINUATION_FMT
     10946**DCL     12148<>CALL    12366<>CALL
E_COPY_FMT
     10856**DCL     11537<>CALL    12307<>CALL
E_CRYPT
     11795**LABEL   11745--CALLALT 11786--CALLALT
E_DATE_NUMBER_FMT
     10586**DCL     11240<>CALL
E_ENCL_1_FMT
     11081**DCL     11651<>CALL
E_ENCL_2_FMT
     11126**DCL     11676<>CALL
E_ENCL_FWD_FMT
     11171**DCL     11623<>CALL
E_ERROR_ADDRESS_FMT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:239  
     10991**DCL     11951<>CALL
E_REFERENCE_AND_ID_FMT
     10811**DCL     11469<>CALL
E_REFERENCE_FMT
     10766**DCL     11442<>CALL
E_REPLY_TO_FMT
     10721**DCL     11372<>CALL
E_RE_STRING
     11036**DCL     11492<>CALL
E_SUBJECT_FMT
     10676**DCL     11405<>CALL
E_TO_FROM_FMT
     10631**DCL     11275<>CALL    12258<>CALL
E_TRACE
     11751**LABEL   11739--CALLALT 11743--CALLALT
F$DCB.ACTPOS
     10148**DCL     10148--REDEF
F$DCB.ARS#
     10122**DCL     10122--REDEF
F$DCB.ATTR
     10141**DCL     10142--REDEF
F$DCB.BORROW
     10156**DCL     10156--REDEF   10156--REDEF   10156--REDEF
F$DCB.DCBNAME.L
     10170**DCL     10170--IMP-SIZ
F$DCB.EOMCHAR#
     10126**DCL     10126--REDEF
F$DCB.FLDID
     10151**DCL     10151--REDEF
F$DCB.FORM$
     10145**DCL     10145--REDEF
F$DCB.FSECT
     10161**DCL     10161--REDEF
F$DCB.FSN#
     10138**DCL     10138--REDEF   10138--REDEF   10139--REDEF
F$DCB.HEADER$
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:240  
     10144**DCL     10144--REDEF
F$DCB.IXTNSIZE#
     10142**DCL     10142--REDEF
F$DCB.LASTSTA$
     10131**DCL     10131--REDEF
F$DCB.LVL
     10157**DCL     10157--REDEF
F$DCB.NAME#.C
     10132**DCL     10132--REDEF
F$DCB.NOEOF
     10154**DCL     10154--REDEF
F$DCB.NRECS#
     10143**DCL     10143--REDEF
F$DCB.NRECX
     10162**DCL     10162--REDEF
F$DCB.OHDR
     10154**DCL     10154--REDEF
F$DCB.ORG#
     10137**DCL     10137--REDEF
F$DCB.PRECNO
     10160**DCL     10160--REDEF
F$DCB.RCSZ
     10166**DCL     10166--REDEF
F$DCB.RES#
     10133**DCL     10133--REDEF
F$DCB.SETX
     10145**DCL     10145--REDEF
F$DCB.TAB$
     10145**DCL     10145--REDEF
F$DCB.TDA
     10159**DCL     10160--REDEF
F$DCB.WIDTH#
     10129**DCL     12026>>ASSIGN
F$DCB.WSN#
     10133**DCL     10133--REDEF
FETCH_ERROR_TEXT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:241  
      9548**DCL     11890<>CALL
FETCH_ERROR_TEXT.BUF_
      9548**DCL     11844<<ASSIGN
FETCH_ERROR_TEXT.CODE_
      9548**DCL     11845<<ASSIGN
FETCH_ERROR_TEXT.FIELD1_
      9550**DCL     11860<<ASSIGN  11878<<ASSIGN
FETCH_ERROR_TEXT.FIELD2_
      9551**DCL     11886<<ASSIGN  11888<<ASSIGN
FETCH_ERROR_TEXT.FILEACCT_
      9549**DCL     11858<<ASSIGN
FETCH_ERROR_TEXT.FILENAME_
      9549**DCL     11857<<ASSIGN
FETCH_ERROR_TEXT.V
      9552**DCL      9548--DCLINIT
FETCH_ERROR_TEXT.V.INCLCODE#
      9557**DCL     11846<<ASSIGN
FMT_STR_LEN IN PROCEDURE DISPLAY_ADDREC
     12240**DCL     12248<<ASSIGN  12296<<ASSIGN  12326<<ASSIGN  12442<>CALL
FWD_FLAG
     10468**DCL     11698--ASSIGN
F_FDS
      9643**DCL     11254<>CALL    11638<>CALL    11666<>CALL    11720<>CALL    11774<>CALL    11934<>CALL
     11966<>CALL    12131<>CALL    12171<>CALL
F_FDS.DCB#
      9676**DCL     11222<<ASSIGN
F_FDS.FMT_
      9647**DCL     11240<>CALL    11243<<ASSIGN  11275<>CALL    11278<<ASSIGN  11372<>CALL    11375<<ASSIGN
     11405<>CALL    11408<<ASSIGN  11442<>CALL    11445<<ASSIGN  11469<>CALL    11472<<ASSIGN  11537<>CALL
     11540<<ASSIGN  11574<>CALL    11577<<ASSIGN  11623<>CALL    11626<<ASSIGN  11651<>CALL    11654<<ASSIGN
     11676<>CALL    11679<<ASSIGN  11733<<ASSIGN  11773<<ASSIGN  11894<<ASSIGN  11951<>CALL    11954<<ASSIGN
     12148<>CALL    12151<<ASSIGN  12258<>CALL    12261<<ASSIGN  12307<>CALL    12310<<ASSIGN  12337<>CALL
     12340<<ASSIGN  12366<>CALL    12369<<ASSIGN
F_FDS.NVECS#
      9671**DCL     11230<<ASSIGN  11303<<ASSIGN  11308<<ASSIGN  11362<<ASSIGN  11395<<ASSIGN  11432<<ASSIGN
     11459<<ASSIGN  11551<<ASSIGN  11588<<ASSIGN  11637<<ASSIGN  11665<<ASSIGN  11718<<ASSIGN  11734<<ASSIGN
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:242  
     11772<<ASSIGN  11893<<ASSIGN  12134<<ASSIGN  12286<<ASSIGN  12291<<ASSIGN  12321<<ASSIGN  12351<<ASSIGN
     12380<<ASSIGN
HIT IN PROCEDURE DISPLAY_ENCODED_ERROR
     11838**DCL     11892<<ASSIGN  11919<<ASSIGN  11938>>IF
I
     10203**DCL     11692<<DOINDEX 12243<<DOINDEX 12244>>IF      12384>>IF      12400>>IF      12414>>IF
     12430>>IF
I IN PROCEDURE BREAKER
     12194**DCL     12200<<CALLBLT 12206>>IF      12210<<CALLBLT 12217<<ASSIGN  12217>>ASSIGN  12218>>ASSIGN
     12218>>ASSIGN  12219>>ASSIGN  12220>>ASSIGN
I IN PROCEDURE DISPLAY_BODY_RECORD
     11977**DCL     12065<<ASSIGN  12066>>DOWHILE 12067>>IF      12070<<ASSIGN  12070>>ASSIGN  12072>>ASSIGN
     12073>>ASSIGN
ID# IN PROCEDURE DISPLAY_BODY_RECORD
     11978**DCL     12063<>CALL    12064>>CALLBLT
ID#TEXT IN PROCEDURE DISPLAY_BODY_RECORD
     11979**DCL     12064<<CALLBLT 12066--DOWHILE 12067>>IF      12072--ASSIGN  12073>>ASSIGN
INDX
     10207**DCL     11325<<CALLBLT 11333<<CALLBLT 11335>>ASSIGN  11336>>ASSIGN  11337>>DOWHILE 11338>>CALLBLT
     11339<<ASSIGN  11339>>ASSIGN  11343<<CALLBLT 11345>>ASSIGN  11346>>ASSIGN  11347>>DOWHILE 11348>>CALLBLT
     11349<<ASSIGN  11349>>ASSIGN  11354<<CALLBLT 11355>>CALLBLT 11737<<DOINDEX 11739<>CALL    11743<>CALL
     11782<<DOINDEX 11784<>CALL    12385<<CALLBLT 12386>>CALLBLT 12389>>ASSIGN  12392<<CALLBLT 12393>>CALLBLT
     12396>>ASSIGN  12415<<CALLBLT 12416>>CALLBLT 12419>>ASSIGN  12422<<CALLBLT 12423>>CALLBLT 12426>>ASSIGN
INDX IN PROCEDURE DISPLAY_ENCODED_ERROR
     11839**DCL     11848<<CALLBLT 11849>>ASSIGN  11850>>ASSIGN  11851>>IF      11855>>ASSIGN  11898<<CALLBLT
     11910>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT 11923<<ASSIGN  11925>>DOWHILE 11926>>IF      11929<<ASSIGN
     11929>>ASSIGN  11932>>ASSIGN
INDX IN PROCEDURE WRITE_CONTINUATION
     12109**DCL     12122<<CALLBLT 12123>>IF      12123<<ASSIGN  12124<<ASSIGN  12124>>ASSIGN  12125>>IF
     12126>>ASSIGN  12133>>ASSIGN
INDX1
     10208**DCL     11293<<CALLBLT 11295>>ASSIGN  11296>>CALLBLT 11299<<ASSIGN  11302>>ASSIGN  11456<<ASSIGN
     11507<<ASSIGN  11509<<ASSIGN  11509>>ASSIGN  11512>>ASSIGN  11512>>ASSIGN  11514<<ASSIGN  11517<>CALL
     11518<>CALL    12276<<CALLBLT 12278>>ASSIGN  12279>>CALLBLT 12282<<ASSIGN  12285>>ASSIGN
INDX1 IN PROCEDURE DISPLAY_ENCODED_ERROR
     11840**DCL     11896<<DOINDEX 11898>>CALLBLT 11901>>CALLBLT 11902>>CALLBLT 11906>>CALLBLT 11906>>CALLBLT
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:243  
     11910>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT 11917>>ASSIGN  11923>>ASSIGN  11926>>IF
     11932>>ASSIGN
INDX2 IN PROCEDURE DISPLAY_ENCODED_ERROR
     11841**DCL     11901<<CALLBLT 11906>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT
INDX3 IN PROCEDURE DISPLAY_ENCODED_ERROR
     11842**DCL     11902<<CALLBLT 11906>>CALLBLT 11910>>CALLBLT 11910>>CALLBLT
IPOS IN PROCEDURE BREAKER
     12192**DCL     12204<<ASSIGN  12212>>ASSIGN  12213<<ASSIGN  12213>>ASSIGN  12218>>ASSIGN  12219<<ASSIGN
     12219>>ASSIGN  12223>>ASSIGN
LEN
     10206**DCL     11295<<ASSIGN  11296>>CALLBLT 11335<<ASSIGN  11336>>ASSIGN  11338>>CALLBLT 11345<<ASSIGN
     11346>>ASSIGN  11348>>CALLBLT 12278<<ASSIGN  12279>>CALLBLT
LEN IN PROCEDURE WRITE_CONTINUATION
     12108**DCL     12116<<ASSIGN  12120>>DOWHILE 12165>>IF      12167>>ASSIGN
LOWER_UPPER
      9504**DCL     11296>>CALLBLT 11329>>CALLBLT 11341>>CALLBLT 11355>>CALLBLT 12279>>CALLBLT
LQUOTES IN PROCEDURE WRITE_CONTINUATION
     12106**DCL     12114<<ASSIGN  12115<<ASSIGN  12129>>IF      12169>>IF
LVNUM IN PROCEDURE WRITE_CONTINUATION
     12107**DCL     12112<<ASSIGN  12113<<ASSIGN  12126>>ASSIGN  12130>>CALL    12135<<ASSIGN  12166>>ASSIGN
     12167>>ASSIGN  12170>>CALL
LWIDTH IN PROCEDURE WRITE_CONTINUATION
     12105**DCL     12117<<ASSIGN  12120>>DOWHILE 12122>>CALLBLT 12123>>ASSIGN  12124>>ASSIGN
M$ERRMSG
      7232**DCL-ENT 11890--CALL
M$RETRY
      7226**DCL-ENT 12039--CALL    12044--CALL
M$TIME
      7236**DCL-ENT 11870--CALL
M$WRITE
      7170**DCL-ENT 12034--CALL
MAIL_DCB#
      9509**DCL        12--PROC    11427<>CALL    11603<>CALL    11739<>CALL    11743<>CALL    11784<>CALL
     12063<>CALL    12241<>CALL
MESSAGE_NUMBER
      9507**DCL        12--PROC    11229--ASSIGN  11314<>CALL    11555<>CALL    11592<>CALL    11603<>CALL
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:244  
     11739<>CALL    11743<>CALL    11784<>CALL
NEXT_CPOS IN PROCEDURE WRITE_CONTINUATION
     12133**LABEL   12128--GOTO
NO_ADDRECORD IN PROCEDURE DISPLAY_ADDREC
     12449**LABEL   12241--CALLALT
NO_ID IN PROCEDURE DISPLAY_BODY_RECORD
     12076**LABEL   12063--CALLALT
NUMBER IN PROCEDURE DISPLAY_ADDREC
     12238**DCL     12235--PROC    12241<>CALL
OLD_ENCL
     11732**LABEL   11609--GOTO
ONE
     10465**DCL     11301--ASSIGN  12284--ASSIGN
OUT_DCB#
      9508**DCL        12--PROC    11221>>ASSIGN  11222>>ASSIGN  11732>>ASSIGN  11781>>ASSIGN  12026--ASSIGN
PAGESIZE
     10470**DCL     11606>>ASSIGN
PRINT_REPLYTO
     11362**LABEL   11327--GOTO
PRINT_SUBJECT
     11393**LABEL   11359--GOTO
PTR$
     10204**DCL     11712<<ASSIGN  11713>>ASSIGN  11713>>ASSIGN  12242<<ASSIGN  12382>>IF      12383>>IF
     12385>>CALLBLT 12386>>CALLBLT 12386>>CALLBLT 12386>>CALLBLT 12389>>ASSIGN  12392>>CALLBLT 12393>>CALLBLT
     12393>>CALLBLT 12393>>CALLBLT 12396>>ASSIGN  12401>>CALLBLT 12401>>CALLBLT 12403>>ASSIGN  12406>>ASSIGN
     12406>>ASSIGN  12408>>ASSIGN  12413>>IF      12415>>CALLBLT 12416>>CALLBLT 12416>>CALLBLT 12422>>CALLBLT
     12423>>CALLBLT 12423>>CALLBLT 12431>>CALLBLT 12436>>ASSIGN  12445<<ASSIGN  12445>>ASSIGN  12446<<ASSIGN
     12446>>ASSIGN  12446>>ASSIGN
QUOTES IN PROCEDURE WRITE_CONTINUATION
     12102**DCL     12091--PROC    12115--IF      12115>>ASSIGN
REF$ IN PROCEDURE DISPLAY_BODY_RECORD
     11981**DCL     12060<<ASSIGN  12061>>IF      12063>>CALL    12063>>CALL
REFERENCE_ID
     10209**DCL     11424<<ASSIGN  11427<>CALL    11428>>IF      11430>>IF      11506>>ASSIGN  11513--ASSIGN
SEED
      9510**DCL        12--PROC    11739<>CALL    11784<>CALL    11817--IF
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:245  
SITENAME
     10463**DCL     11296<<CALLBLT 11297>>IF      12279<<CALLBLT 12280>>IF
SIZE_BUF IN PROCEDURE DISPLAY_BODY_RECORD
     11983**DCL     12032<<ASSIGN  12033>>ASSIGN  12047>>ASSIGN  12048>>ASSIGN
SPACE
     10464**DCL     11700--ASSIGN  11705--ASSIGN  11773--ASSIGN  12166--ASSIGN
SPACEC
     11216**DCL     11517<>CALL
SPACE_LINE
      9756**DCL     11223<>CALL    11751<>CALL    11790<>CALL    12023<>CALL
SPACE_LINE.DCB#
      9789**DCL     11221<<ASSIGN
STR IN PROCEDURE BREAKER
     12190**DCL     12200>>CALLBLT 12210>>CALLBLT 12212>>ASSIGN  12218>>ASSIGN
STR$ IN PROCEDURE BREAKER
     12188**DCL     12190--IMP-PTR 12197<<ASSIGN  12200>>CALLBLT 12210>>CALLBLT 12212>>ASSIGN  12218>>ASSIGN
STRING IN PROCEDURE WRITE_CONTINUATION
     12098**DCL     12091--PROC
STRING.L# IN PROCEDURE WRITE_CONTINUATION
     12098**DCL     12098--IMP-SIZ 12116>>ASSIGN  12122>>CALLBLT 12125>>IF      12126>>ASSIGN  12167>>ASSIGN
STRING.NAME# IN PROCEDURE WRITE_CONTINUATION
     12098**DCL     12122>>CALLBLT 12125>>IF      12126--ASSIGN  12167--ASSIGN
STRLEN IN PROCEDURE BREAKER
     12189**DCL     12190--IMP-SIZ 12198<<ASSIGN  12200>>CALLBLT 12209>>DOWHILE 12210>>CALLBLT 12212>>ASSIGN
     12213>>ASSIGN  12218>>ASSIGN
TEMPBUF
     10211**DCL     11258<<ASSIGN  11336<<ASSIGN  11338>>CALLBLT 11341<<CALLBLT 11346>>ASSIGN  11348<<CALLBLT
     11355<<CALLBLT 11357>>IF      11906<<CALLBLT 11910<<CALLBLT 11917>>ASSIGN  12212<<ASSIGN  12218<<ASSIGN
     12223--ASSIGN
TEMPBUF1
     10212**DCL     11292<<ASSIGN  11296>>CALLBLT 11302--ASSIGN  11329<<CALLBLT 11336>>ASSIGN  11338<<CALLBLT
     11357>>IF      12275<<ASSIGN  12279>>CALLBLT 12285--ASSIGN
TEMPBUF2
     10213**DCL     11346<<ASSIGN  11348>>CALLBLT
TEXTC
     10221**DCL     11712--ASSIGN  12058<<ASSIGN  12442<>CALL
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:246  
TEXTC.COUNT
     10222**DCL     11710<<ASSIGN  11763<<ASSIGN  11765<<ASSIGN  11904>>IF      11910>>CALLBLT 11938>>IF
     11941>>ASSIGN  12060>>ASSIGN  12389<<ASSIGN  12396<<ASSIGN  12403<<ASSIGN  12408<<ASSIGN  12419<<ASSIGN
     12426<<ASSIGN  12433<<ASSIGN  12437<<ASSIGN
TEXTC.TEXT
     10223**DCL     11711<<ASSIGN  11766<<ASSIGN  11910>>CALLBLT 11941--ASSIGN  12386<<CALLBLT 12393<<CALLBLT
     12401<<CALLBLT 12406<<ASSIGN  12416<<CALLBLT 12423<<CALLBLT 12431<<CALLBLT 12436<<ASSIGN
TEXTC2
     10224**DCL     11888--ASSIGN
TEXTC2.COUNT
     10225**DCL     11768<<ASSIGN  11884>>IF      12059<<ASSIGN  12072<<ASSIGN
TEXTC2.TEXT
     10226**DCL     12073<<ASSIGN
TIMEBUF.DATE
     10231**DCL     11866--ASSIGN  11875>>CALLBLT
TIMEBUF.DAY
     10233**DCL     11868--ASSIGN
TIMEBUF.TIME
     10232**DCL     11867--ASSIGN  11875>>CALLBLT
TIME_TEXTC
     10234**DCL     11878--ASSIGN
TIME_TEXTC.COUNT
     10235**DCL     11873<<ASSIGN
TIME_TEXTC.TEXT
     10236**DCL     11873--ASSIGN  11875<<CALLBLT
TRACE
      9511**DCL        12--PROC    11735--IF      11735>>IF
TYPE IN PROCEDURE DISPLAY_ADDREC
     12237**DCL     12235--PROC    12241<>CALL    12245>>DOSELCT
UTS
     10220**DCL     11760<<ASSIGN  11862>>IF      11865--ASSIGN  12057<<ASSIGN
VECT IN PROCEDURE BREAKER
     12186**DCL     12184--PROC    12197>>ASSIGN  12198>>ASSIGN  12223<<ASSIGN
VECT_ARRAY
      9886**DCL      9673--DCLINIT  9786--DCLINIT 11227<<ASSIGN  11228<<ASSIGN  11229<<ASSIGN  11301<<ASSIGN
     11302<<ASSIGN  11307<<ASSIGN  11512<<ASSIGN  11513<<ASSIGN  11695<<ASSIGN  11698<<ASSIGN  11700<<ASSIGN
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:247  
     11703<<ASSIGN  11705<<ASSIGN  11707<<ASSIGN  11713<<ASSIGN  11716<<ASSIGN  11932<<ASSIGN  11941<<ASSIGN
     12126<<ASSIGN  12130<>CALL    12166<<ASSIGN  12167<<ASSIGN  12170<>CALL    12284<<ASSIGN  12285<<ASSIGN
     12290<<ASSIGN
VLR_ERRMSG
      9576**DCL      9552--DCLINIT
VLR_ERRMSG.RECCNT
      9580**DCL     11896>>DOINDEX
VM$RADDRESS.ACCT
     10363**DCL     12416>>CALLBLT 12423>>CALLBLT 12431>>CALLBLT 12436>>ASSIGN
VM$RADDRESS.FOLDER
     10355**DCL     10356--REDEF
VM$RADDRESS.SITENAME
     10362**DCL     12413>>IF      12415>>CALLBLT 12416>>CALLBLT 12422>>CALLBLT 12423>>CALLBLT
VM$RADDRESS.TYPE
     10352**DCL     12382>>IF
VM$UADDRESS.FOLDER
     10390**DCL     10391--REDEF
VM$UADDRESS.SITENAME
     10397**DCL     12383>>IF      12385>>CALLBLT 12386>>CALLBLT 12392>>CALLBLT 12393>>CALLBLT
VM$UADDRESS.USER_NAME.COUNT
     10399**DCL     12386>>CALLBLT 12389>>ASSIGN  12393>>CALLBLT 12396>>ASSIGN  12401>>CALLBLT 12403>>ASSIGN
     12406>>ASSIGN  12408>>ASSIGN
VM$UADDRESS.USER_NAME.TEXT
     10400**DCL     12386>>CALLBLT 12393>>CALLBLT 12401>>CALLBLT 12406>>ASSIGN
VMA$GET_ADD_RECORD
     10177**DCL-ENT 11603--CALL    12241--CALL
VMD$ERRMSG
     10182**DCL-ENT 11240--CALL    11275--CALL    11372--CALL    11405--CALL    11442--CALL    11469--CALL
     11492--CALL    11537--CALL    11574--CALL    11623--CALL    11651--CALL    11676--CALL    11951--CALL
     12148--CALL    12258--CALL    12307--CALL    12337--CALL    12366--CALL
VMD$GET_BODY
     10174**DCL-ENT 11784--CALL
VMD$GET_ID
     10176**DCL-ENT 11427--CALL    12063--CALL
VMD$GET_TRACE
     10175**DCL-ENT 11739--CALL    11743--CALL
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:248  
VMD$WRITE_BUF
     10173**DCL-ENT 11223--CALL    11254--CALL    11638--CALL    11666--CALL    11720--CALL    11751--CALL
     11774--CALL    11790--CALL    11934--CALL    11966--CALL    12023--CALL    12131--CALL    12171--CALL
VM_ADDLIST$
      8899**DCL     10286--IMP-PTR 12242>>ASSIGN  12243>>DOINDEX 12384>>IF      12384>>IF      12400>>IF
     12400>>IF      12414>>IF      12414>>IF      12430>>IF      12430>>IF
VM_ADDLIST_
      8923**DCL     12241<>CALL
VM_ADD_HEAD
     10286**DCL     12242--ASSIGN  12242--ASSIGN
VM_ADD_HEAD.NUM_ENTRIES
     10289**DCL     12243>>DOINDEX 12384>>IF      12384>>IF      12400>>IF      12400>>IF      12414>>IF
     12414>>IF      12430>>IF      12430>>IF
VM_BLIND_COPY_FMT
     10529**DCL     11574<>CALL    12337<>CALL
VM_BLIND_COPY_FMT.L#
     10529**DCL     10529--IMP-SIZ 11572>>IF      11574>>CALL    11577>>ASSIGN  11577>>ASSIGN  12335>>IF
     12337>>CALL    12340>>ASSIGN  12340>>ASSIGN
VM_BLIND_COPY_FMT.NAME#
     10529**DCL     11572>>IF      11577--ASSIGN  12335>>IF      12340--ASSIGN
VM_BODYREC
     10254**DCL     11739<>CALL    11743<>CALL    11784<>CALL    11825--IF      12055--ASSIGN
VM_BODYREC.TYPE
     10255**DCL     11820>>DOCASE  12019>>DOCASE
VM_BODYREC.VALUE.COUNT
     10260**DCL     11738<<ASSIGN  11783<<ASSIGN  11825>>IF      11825>>IF
VM_BODYREC.VALUE.DATA
     10272**DCL     11738--ASSIGN  11783--ASSIGN  11825--IF      12029--ASSIGN
VM_BODYREC_ENCODED.VALUE.DATA.ERR IN PROCEDURE DISPLAY_BODY_RECORD
     12006**DCL     12056>>ASSIGN
VM_BODYREC_ENCODED.VALUE.DATA.STUFF IN PROCEDURE DISPLAY_BODY_RECORD
     12008**DCL     12058--ASSIGN  12058--ASSIGN  12060--ASSIGN
VM_BODYREC_ENCODED.VALUE.DATA.UTS IN PROCEDURE DISPLAY_BODY_RECORD
     12007**DCL     12057>>ASSIGN
VM_CONTINUATION_FMT
     10536**DCL     12148<>CALL    12366<>CALL
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:249  
VM_CONTINUATION_FMT.L#
     10536**DCL     10536--IMP-SIZ 12146>>IF      12148>>CALL    12151>>ASSIGN  12151>>ASSIGN  12364>>IF
     12366>>CALL    12369>>ASSIGN  12369>>ASSIGN
VM_CONTINUATION_FMT.NAME#
     10536**DCL     12146>>IF      12151--ASSIGN  12364>>IF      12369--ASSIGN
VM_COPY_FMT
     10522**DCL     11537<>CALL    12307<>CALL
VM_COPY_FMT.L#
     10522**DCL     10522--IMP-SIZ 11535>>IF      11537>>CALL    11540>>ASSIGN  11540>>ASSIGN  12305>>IF
     12307>>CALL    12310>>ASSIGN  12310>>ASSIGN
VM_COPY_FMT.NAME#
     10522**DCL     11535>>IF      11540--ASSIGN  12305>>IF      12310--ASSIGN
VM_DATE_NUMBER_FMT
     10480**DCL     11240<>CALL
VM_DATE_NUMBER_FMT.L#
     10480**DCL     10480--IMP-SIZ 11238>>IF      11240>>CALL    11243>>ASSIGN  11243>>ASSIGN
VM_DATE_NUMBER_FMT.NAME#
     10480**DCL     11238>>IF      11243--ASSIGN
VM_ENCLLIST$
      8914**DCL     10443--IMP-PTR 11690>>ASSIGN  11692>>DOINDEX
VM_ENCLLIST_
      8930**DCL     11603<>CALL    11606<<ASSIGN  11606>>ASSIGN
VM_ENCLOS.FLAGS.DELETED
     10418**DCL     11702>>IF
VM_ENCLOS.FLAGS.FORWARD
     10420**DCL     11697>>IF
VM_ENCLOS.NEXT$
     10413**DCL     11722>>ASSIGN
VM_ENCLOS.NRECS
     10426**DCL     11707--ASSIGN
VM_ENCLOS.TITLE$
     10430**DCL     11709>>IF      11716>>ASSIGN  11716>>ASSIGN
VM_ENCLOS.TYPE
     10428**DCL     11694>>ASSIGN
VM_ENCL_1_FMT
     10557**DCL     11651<>CALL
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:250  
VM_ENCL_1_FMT.L#
     10557**DCL     10557--IMP-SIZ 11649>>IF      11651>>CALL    11654>>ASSIGN  11654>>ASSIGN
VM_ENCL_1_FMT.NAME#
     10557**DCL     11649>>IF      11654--ASSIGN
VM_ENCL_2_FMT
     10564**DCL     11676<>CALL
VM_ENCL_2_FMT.L#
     10564**DCL     10564--IMP-SIZ 11674>>IF      11676>>CALL    11679>>ASSIGN  11679>>ASSIGN
VM_ENCL_2_FMT.NAME#
     10564**DCL     11674>>IF      11679--ASSIGN
VM_ENCL_FWD_FMT
     10571**DCL     11623<>CALL
VM_ENCL_FWD_FMT.L#
     10571**DCL     10571--IMP-SIZ 11621>>IF      11623>>CALL    11626>>ASSIGN  11626>>ASSIGN
VM_ENCL_FWD_FMT.NAME#
     10571**DCL     11621>>IF      11626--ASSIGN
VM_ENCL_HEAD.HEAD$
     10453**DCL     11690>>ASSIGN
VM_ENCL_HEAD.NUM_ENTRIES
     10446**DCL     11692>>DOINDEX
VM_ERROR_ADDRESS_FMT
     10543**DCL     11951<>CALL
VM_ERROR_ADDRESS_FMT.L#
     10543**DCL     10543--IMP-SIZ 11949>>IF      11951>>CALL    11954>>ASSIGN  11954>>ASSIGN
VM_ERROR_ADDRESS_FMT.NAME#
     10543**DCL     11949>>IF      11954--ASSIGN
VM_HEADER.BAD_ADDRESS$
      9982**DCL     11761>>IF      11765>>ASSIGN  11766>>ASSIGN  11766>>ASSIGN
VM_HEADER.BLIND$
      9984**DCL     11561>>IF      11589>>CALL
VM_HEADER.COPY$
      9986**DCL     11524>>IF      11552>>CALL
VM_HEADER.CREATION_DATE
      9901**DCL     11227--ASSIGN
VM_HEADER.DELIVERY_DATE
      9903**DCL     11228--ASSIGN
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:251  
VM_HEADER.ERROR
      9971**DCL     11756>>IF      11759>>ASSIGN
VM_HEADER.FROM$
      9990**DCL     11289>>IF      11292>>ASSIGN  11292>>ASSIGN  11293>>CALLBLT 11293>>CALLBLT 11293>>CALLBLT
     11295>>ASSIGN  11299>>ASSIGN  11341>>CALLBLT 11341>>CALLBLT 11341>>CALLBLT 11343>>CALLBLT 11343>>CALLBLT
     11345>>ASSIGN  11347>>DOWHILE 11347>>DOWHILE 11354>>CALLBLT 11354>>CALLBLT 11354>>CALLBLT 11355>>CALLBLT
     11355>>CALLBLT 12272>>IF      12275>>ASSIGN  12275>>ASSIGN  12276>>CALLBLT 12276>>CALLBLT 12276>>CALLBLT
     12278>>ASSIGN  12282>>ASSIGN
VM_HEADER.NUM_RECORDS
      9909**DCL     11770>>IF      11782>>DOINDEX
VM_HEADER.NUM_TRACE_RECORDS
     10008**DCL     11737>>DOINDEX
VM_HEADER.REFERENCE$
      9992**DCL     11428>>IF      11516>>IF      11518>>CALL
VM_HEADER.REFERS_TO_ID$
     10006**DCL     11425>>IF      11427>>CALL    11427>>CALL
VM_HEADER.REPLY_TO$
      9994**DCL     11322>>IF      11325>>CALLBLT 11325>>CALLBLT 11329>>CALLBLT 11329>>CALLBLT 11329>>CALLBLT
     11333>>CALLBLT 11333>>CALLBLT 11335>>ASSIGN  11337>>DOWHILE 11337>>DOWHILE 11386>>CALL
VM_HEADER.STATUS.ENCL
      9963**DCL     11601>>IF
VM_HEADER.STATUS.ERR
      9912**DCL     11756>>IF
VM_HEADER.STATUS.PRE_B00
      9961**DCL     11825>>IF
VM_HEADER.SUBJECT$
     10000**DCL     11393>>IF      11419>>CALL
VM_HEADER.TO$
     10002**DCL     11263>>IF      11310>>CALL
VM_HEADER$
      8895**DCL      9898--IMP-PTR 11227>>ASSIGN  11228>>ASSIGN  11263>>IF      11289>>IF      11292>>ASSIGN
     11292>>ASSIGN  11293>>CALLBLT 11293>>CALLBLT 11293>>CALLBLT 11295>>ASSIGN  11299>>ASSIGN  11310>>CALL
     11322>>IF      11325>>CALLBLT 11325>>CALLBLT 11329>>CALLBLT 11329>>CALLBLT 11329>>CALLBLT 11333>>CALLBLT
     11333>>CALLBLT 11335>>ASSIGN  11337>>DOWHILE 11337>>DOWHILE 11341>>CALLBLT 11341>>CALLBLT 11341>>CALLBLT
     11343>>CALLBLT 11343>>CALLBLT 11345>>ASSIGN  11347>>DOWHILE 11347>>DOWHILE 11354>>CALLBLT 11354>>CALLBLT
     11354>>CALLBLT 11355>>CALLBLT 11355>>CALLBLT 11386>>CALL    11393>>IF      11419>>CALL    11425>>IF
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:252  
     11427>>CALL    11427>>CALL    11428>>IF      11516>>IF      11518>>CALL    11524>>IF      11552>>CALL
     11561>>IF      11589>>CALL    11601>>IF      11737>>DOINDEX 11756>>IF      11756>>IF      11759>>ASSIGN
     11761>>IF      11765>>ASSIGN  11766>>ASSIGN  11766>>ASSIGN  11770>>IF      11782>>DOINDEX 11825>>IF
     12272>>IF      12275>>ASSIGN  12275>>ASSIGN  12276>>CALLBLT 12276>>CALLBLT 12276>>CALLBLT 12278>>ASSIGN
     12282>>ASSIGN
VM_PROFILE.OPT.DISPTRACE
     10043**DCL     11735>>IF
VM_PROFILE.OPT.EXT_ADDR_DISP
     10053**DCL     11262>>IF      11527>>IF      11564>>IF
VM_PROFILE$
      8897**DCL     10027--IMP-PTR 11262>>IF      11527>>IF      11564>>IF      11735>>IF
VM_REFERENCE_AND_ID_FMT
     10515**DCL     11469<>CALL
VM_REFERENCE_AND_ID_FMT.L#
     10515**DCL     10515--IMP-SIZ 11467>>IF      11469>>CALL    11472>>ASSIGN  11472>>ASSIGN
VM_REFERENCE_AND_ID_FMT.NAME#
     10515**DCL     11467>>IF      11472--ASSIGN
VM_REFERENCE_FMT
     10508**DCL     11442<>CALL
VM_REFERENCE_FMT.L#
     10508**DCL     10508--IMP-SIZ 11440>>IF      11442>>CALL    11445>>ASSIGN  11445>>ASSIGN
VM_REFERENCE_FMT.NAME#
     10508**DCL     11440>>IF      11445--ASSIGN
VM_REPLY_TO_FMT
     10501**DCL     11372<>CALL
VM_REPLY_TO_FMT.L#
     10501**DCL     10501--IMP-SIZ 11370>>IF      11372>>CALL    11375>>ASSIGN  11375>>ASSIGN
VM_REPLY_TO_FMT.NAME#
     10501**DCL     11370>>IF      11375--ASSIGN
VM_RE_STRING
     10550**DCL     11492<>CALL
VM_RE_STRING.L#
     10550**DCL     10550--IMP-SIZ 11490>>IF      11492>>CALL    11512>>ASSIGN  11512>>ASSIGN
VM_RE_STRING.NAME#
     10550**DCL     11490>>IF      11512--ASSIGN
VM_SITENAME
PL6.E3A0      #002=VMD$DI_MESSAGE File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:08 Page:253  
      9168**DCL     11297>>IF      12280>>IF      12383>>IF      12413>>IF
VM_SUBJECT_FMT
     10494**DCL     11405<>CALL
VM_SUBJECT_FMT.L#
     10494**DCL     10494--IMP-SIZ 11403>>IF      11405>>CALL    11408>>ASSIGN  11408>>ASSIGN
VM_SUBJECT_FMT.NAME#
     10494**DCL     11403>>IF      11408--ASSIGN
VM_TO_FROM_FMT
     10487**DCL     11275<>CALL    12258<>CALL
VM_TO_FROM_FMT.L#
     10487**DCL     10487--IMP-SIZ 11273>>IF      11275>>CALL    11278>>ASSIGN  11278>>ASSIGN  12256>>IF
     12258>>CALL    12261>>ASSIGN  12261>>ASSIGN
VM_TO_FROM_FMT.NAME#
     10487**DCL     11273>>IF      11278--ASSIGN  12256>>IF      12261--ASSIGN
VNUM IN PROCEDURE WRITE_CONTINUATION
     12103**DCL     12091--PROC    12113--IF      12113>>ASSIGN
WIDTH IN PROCEDURE WRITE_CONTINUATION
     12101**DCL     12091--PROC    12117>>ASSIGN
WRITE_CONTINUATION
     12091**PROC    11310--CALL    11386--CALL    11419--CALL    11517--CALL    11518--CALL    11552--CALL
     11589--CALL    12442--CALL
X$STRING.SIZ
      8891**DCL      8892--IMP-SIZ 11292>>ASSIGN  11293>>CALLBLT 11293>>CALLBLT 11295>>ASSIGN  11299>>ASSIGN
     11325>>CALLBLT 11329>>CALLBLT 11329>>CALLBLT 11333>>CALLBLT 11335>>ASSIGN  11337>>DOWHILE 11341>>CALLBLT
     11341>>CALLBLT 11343>>CALLBLT 11345>>ASSIGN  11347>>DOWHILE 11354>>CALLBLT 11354>>CALLBLT 11355>>CALLBLT
     11765>>ASSIGN  11766>>ASSIGN  12275>>ASSIGN  12276>>CALLBLT 12276>>CALLBLT 12278>>ASSIGN  12282>>ASSIGN
X$STRING.TEXT
      8892**DCL     11292>>ASSIGN  11293>>CALLBLT 11325>>CALLBLT 11329>>CALLBLT 11333>>CALLBLT 11337>>DOWHILE
     11341>>CALLBLT 11343>>CALLBLT 11347>>DOWHILE 11354>>CALLBLT 11355>>CALLBLT 11766>>ASSIGN  12275>>ASSIGN
     12276>>CALLBLT
ZERO
     10466**DCL     11307--ASSIGN  12290--ASSIGN

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:254  
     1466        1        /*T***********************************************************/
     1467        2        /*T*                                                         */
     1468        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1469        4        /*T*                                                         */
     1470        5        /*T***********************************************************/
     1471        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
     1472        7        /*P*
     1473        8             NAME: VMD$DI_SUBJECT
     1474        9             DESCRIPTION: This routine will display the current SUBJECT field
     1475       10        */
     1476       11
     1477       12        VMD$DI_SUBJECT: PROC (VM_HEADER,DCB#);
     1478       13
     1479       14        /***** Include files *****/
     1480       15        %INCLUDE CP_6_SUBS;
     1481      555        %INCLUDE XU_FORMAT_C;
     1482      717        %INCLUDE CP_6;
     1483     6276        %INCLUDE VM_MACRO_C;
     1484     7544        %INCLUDE VM_SUBS_C;
     1485     7804        %INCLUDE VM_DATA_R;
     1486     8235        /***** Parameters *****/
     1487     8236        %VM_HEADER (STCLASS=" ");
     1488     8365    1   DCL DCB# UBIN WORD;
     1489     8366
     1490     8367        %F_FDS    (VECTR=VECT_ARRAY,
     1491     8368                   NVECS="1");
     1492     8481
     1493     8482    1   dcl VECT_ARRAY (0:2) vector daligned static;
     1494     8483
     1495     8484    1   dcl VM_NO_OR_YES$(0:1)    ptr symref readonly;
     1496     8485    1   dcl BSD                   sbin based;
     1497     8486
     1498     8487
     1499     8488
     1500     8489        %VLP_NAMEV( FPTN=VM_SUBJECT_FMT1,     STCLASS=SYMREF );
     1501     8496        %VLP_NAMEV( FPTN=VM_REFERENCE_FMT1,   STCLASS=SYMREF );
     1502     8503        %VLP_NAMEV( FPTN=VM_COPY_FMT1,        STCLASS=SYMREF );
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:255  
     1503     8510        %VLP_NAMEV( FPTN=VM_BLIND_COPY_FMT1,  STCLASS=SYMREF );
     1504     8517        %VLP_NAMEV( FPTN=VM_TO_FMT,           STCLASS=SYMREF );
     1505     8524        %VLP_NAMEV( FPTN=VM_FCOPY_FMT,        STCLASS=SYMREF );
     1506     8531        %VLP_NAMEV( FPTN=VM_SIGNED_FMT,       STCLASS=SYMREF );
     1507     8538        %VLP_NAMEV( FPTN=VM_RR_FMT,           STCLASS=SYMREF );
     1508     8545        %VLP_NAMEV( FPTN=VM_RTO_FMT,          STCLASS=SYMREF );
     1509     8552        %VLP_NAMEV( FPTN=VM_DEFER_FMT,        STCLASS=SYMREF );
     1510     8559        %VLP_NAMEV( FPTN=VM_DEFER_FMT1,       STCLASS=SYMREF );
     1511     8566        %VLP_NAMEV( FPTN=VM_OPTS_FMT,         STCLASS=SYMREF );
     1512     8573        %VLP_NAMEV( FPTN=VM_OPTS_FMT1,        STCLASS=SYMREF );
     1513     8580        %VLP_NAMEV( FPTN=VM_OPTS_FMT2,        STCLASS=SYMREF );
     1514     8587        %VLP_NAMEV( FPTN=VM_DR_FMT,           STCLASS=SYMREF );
     1515     8594        %VLP_NAMEV( FPTN=VM_BROADCAST_FMT,    STCLASS=SYMREF );
     1516     8601        %VLP_NAMEV( FPTN=VN_NO_CHAR,          STCLASS=SYMREF );
     1517     8608        %VLP_NAMEV( FPTN=VN_YES_CHAR,         STCLASS=SYMREF );
     1518     8615
     1519     8616        %VLP_ERRCODE( FPTN=E_SUBJECT_FMT1,    STCLASS="SYMREF READONLY" );
     1520     8661              %VLP_ERRCODE( FPTN=E_REFERENCE_FMT1, STCLASS="SYMREF READONLY" );
     1521     8706              %VLP_ERRCODE( FPTN=E_COPY_FMT1, STCLASS="SYMREF READONLY" );
     1522     8751              %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT1, STCLASS="SYMREF READONLY" );
     1523     8796              %VLP_ERRCODE( FPTN=E_TO_FMT,    STCLASS="SYMREF READONLY" );
     1524     8841              %VLP_ERRCODE( FPTN=E_FCOPY_FMT, STCLASS="SYMREF READONLY" );
     1525     8886              %VLP_ERRCODE( FPTN=E_SIGNED_FMT, STCLASS="SYMREF READONLY" );
     1526     8931              %VLP_ERRCODE( FPTN=E_RR_FMT,    STCLASS="SYMREF READONLY" );
     1527     8976              %VLP_ERRCODE( FPTN=E_RTO_FMT,   STCLASS="SYMREF READONLY" );
     1528     9021              %VLP_ERRCODE( FPTN=E_DEFER_FMT, STCLASS="SYMREF READONLY" );
     1529     9066              %VLP_ERRCODE( FPTN=E_DEFER_FMT1, STCLASS="SYMREF READONLY" );
     1530     9111              %VLP_ERRCODE( FPTN=E_OPTS_FMT,  STCLASS="SYMREF READONLY" );
     1531     9156              %VLP_ERRCODE( FPTN=E_OPTS_FMT1, STCLASS="SYMREF READONLY" );
     1532     9201              %VLP_ERRCODE( FPTN=E_OPTS_FMT2, STCLASS="SYMREF READONLY" );
     1533     9246              %VLP_ERRCODE( FPTN=E_DR_FMT,    STCLASS="SYMREF READONLY" );
     1534     9291              %VLP_ERRCODE( FPTN=E_BROADCAST_FMT, STCLASS="SYMREF READONLY" );
     1535     9336              %VLP_ERRCODE( FPTN=E_NO_CHAR,   STCLASS="SYMREF READONLY" );
     1536     9381              %VLP_ERRCODE( FPTN=E_YES_CHAR,  STCLASS="SYMREF READONLY" );
     1537     9426
     1538     9427
     1539     9428
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:256  
     1540     9429
     1541     9430    1   DCL SPACE CHAR(1) CONSTANT INIT(' ');
     1542     9431
     1543     9432    1   DCL VMD$WRITE_BUF ENTRY(1);
     1544     9433        %INIT_STR(DODCL=YES);
     1545     9456
     1546     9457        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:257  
     1547     9458
     1548     9459            %INIT_STR(STR=VM_SUBJECT_FMT1, CODE=E_SUBJECT_FMT1, TEST=YES, VECT="F_FDS.FMT_")
              9459                ;
     1549     9482    1       IF VM_HEADER.SUBJECT$ ~= ADDR(NIL) THEN
     1550     9483    1           CALL DISPLAY_FIELD (VM_HEADER.SUBJECT$);
     1551     9484    1       ELSE CALL DISPLAY_FIELD (VM_HEADER.REFERENCE$);
     1552     9485    1       RETURN;
     1553     9486        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:258  
     1554     9487        /*F*
     1555     9488             NAME: VMD$DI_TO
     1556     9489             PURPOSE: To display the TO field of the current message.
     1557     9490        */
     1558     9491    1   VMD$DI_TO: ENTRY (VM_HEADER,DCB#);
     1559     9492            %INIT_STR(STR=VM_TO_FMT, CODE=E_TO_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1560     9515    1       CALL DISPLAY_FIELD (VM_HEADER.TO$);
     1561     9516    1       RETURN;
     1562     9517        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:259  
     1563     9518        /*F*
     1564     9519             NAME: VMD$DI_COPY
     1565     9520             PURPOSE: To display the COPY field of the current message.
     1566     9521        */
     1567     9522    1   VMD$DI_COPY: ENTRY (VM_HEADER,DCB#);
     1568     9523            %INIT_STR(STR=VM_COPY_FMT1, CODE=E_COPY_FMT1, TEST=YES, VECT="F_FDS.FMT_");
     1569     9546    1       CALL DISPLAY_FIELD (VM_HEADER.COPY$);
     1570     9547    1       RETURN;
     1571     9548        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:260  
     1572     9549        /*F*
     1573     9550             NAME: VMD$DI_BLIND
     1574     9551             PURPOSE: To display the BLIND COPY FIELD of the current message.
     1575     9552        */
     1576     9553    1   VMD$DI_BLIND: ENTRY (VM_HEADER,DCB#);
     1577     9554            %INIT_STR(STR=VM_BLIND_COPY_FMT1, CODE=E_BLIND_COPY_FMT1, TEST=YES, VECT=
              9554                "F_FDS.FMT_");
     1578     9577    1       CALL DISPLAY_FIELD (VM_HEADER.BLIND$);
     1579     9578    1       RETURN;
     1580     9579        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:261  
     1581     9580        /*F*
     1582     9581             NAME: VMD$DI_REFERENCE
     1583     9582             PURPOSE: To display the REFERENCE field of the current message.
     1584     9583        */
     1585     9584    1   VMD$DI_REFERENCE: ENTRY (VM_HEADER,DCB#);
     1586     9585            %INIT_STR(STR=VM_REFERENCE_FMT1, CODE=E_REFERENCE_FMT1, TEST=YES, VECT=
              9585                "F_FDS.FMT_");
     1587     9608    1       CALL DISPLAY_FIELD (VM_HEADER.REFERENCE$);
     1588     9609    1       RETURN;
     1589     9610        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:262  
     1590     9611        /*F*
     1591     9612             NAME: VMD$DI_FCOPY
     1592     9613             PURPOSE: To display the FILE COPY flag of the currnet message.
     1593     9614        */
     1594     9615    1   VMD$DI_FCOPY: ENTRY (VM_HEADER,DCB#);
     1595     9616            %INIT_STR(STR=VM_FCOPY_FMT, CODE=E_FCOPY_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1596     9639            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);
     1597     9662            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);
     1598     9685    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.FCOPY) ) );
     1599     9686    1       RETURN;
     1600     9687        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:263  
     1601     9688        /*F*
     1602     9689             NAME: VMD$DI_SIGNED
     1603     9690             PURPOSE: To display the signed field of the current message.
     1604     9691        */
     1605     9692    1   VMD$DI_SIGNED: ENTRY (VM_HEADER,DCB#);
     1606     9693            %INIT_STR(STR=VM_SIGNED_FMT, CODE=E_SIGNED_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1607     9716    1       CALL DISPLAY_FIELD (VM_HEADER.SIGNED$);
     1608     9717    1       RETURN;
     1609     9718        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:264  
     1610     9719        /*F*
     1611     9720             NAME: VMD$DI_RR
     1612     9721             PURPOSE: To display the RETURN RECEIPT flag of the current message.
     1613     9722        */
     1614     9723    1   VMD$DI_RR: ENTRY (VM_HEADER,DCB#);
     1615     9724            %INIT_STR(STR=VM_RR_FMT, CODE=E_RR_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1616     9747            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);
     1617     9770            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);
     1618     9793    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.RR) ) );
     1619     9794    1       RETURN;
     1620     9795        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:265  
     1621     9796        /*F*
     1622     9797             NAME: VMD$DI_RTO
     1623     9798             PURPOSE: To display the REPLY TO field of the current message.
     1624     9799        */
     1625     9800    1   VMD$DI_RTO: ENTRY (VM_HEADER,DCB#);
     1626     9801            %INIT_STR(STR=VM_RTO_FMT, CODE=E_RTO_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1627     9824    1       CALL DISPLAY_FIELD (VM_HEADER.REPLY_TO$);
     1628     9825    1       RETURN;
     1629     9826        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:266  
     1630     9827        /*F*
     1631     9828             NAME: VMD$DI_DEFER
     1632     9829             PURPOSE: To display the DELIVERY DATE of the current message.
     1633     9830        */
     1634     9831    1   VMD$DI_DEFER: ENTRY (VM_HEADER,DCB#);
     1635     9832    1       F_FDS.DCB# = DCB#;
     1636     9833    1       VECT_ARRAY(0) = VECTOR(VM_HEADER.DELIVERY_DATE);
     1637     9834    1       IF VM_HEADER.DELIVERY_DATE > 0
     1638     9835    1       THEN
     1639     9836                %INIT_STR(STR=VM_DEFER_FMT, CODE=E_DEFER_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1640     9859    1       ELSE
     1641     9860                %INIT_STR(STR=VM_DEFER_FMT1, CODE=E_DEFER_FMT1, TEST=YES, VECT="F_FDS.FMT_")
              9860                    ;
     1642     9883    1       CALL VMD$WRITE_BUF (F_FDS);
     1643     9884    1       RETURN;
     1644     9885        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:267  
     1645     9886        /*F*
     1646     9887             NAME: VMD$DI_OPTS
     1647     9888             PURPOSE: To display various SEND options.
     1648     9889        */
     1649     9890    1   VMD$DI_OPTS: ENTRY (VM_HEADER,DCB#);
     1650     9891    1       F_FDS.DCB# = DCB#;
     1651     9892            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);
     1652     9915            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);
     1653     9938    1       VECT_ARRAY(0) = vector(VN_YES_CHAR.NAME#);
     1654     9939    1       VECT_ARRAY(1) = vector(VN_YES_CHAR.NAME#);
     1655     9940    1       vbase(VECT_ARRAY(0)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.DR) ),1);
     1656     9941    1       vbase(VECT_ARRAY(1)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.RR) ),1);
     1657     9942    1       IF VM_HEADER.DELIVERY_DATE > 0
     1658     9943    2       THEN DO;
     1659     9944    2           VECT_ARRAY(2) = VECTOR(VM_HEADER.DELIVERY_DATE);
     1660     9945    2           F_FDS.NVECS# = 3;
     1661     9946                %INIT_STR(STR=VM_OPTS_FMT, CODE=E_OPTS_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1662     9969    2       END;
     1663     9970    1       ELSE
     1664     9971    2       DO;
     1665     9972    2           F_FDS.NVECS# = 2;
     1666     9973                %INIT_STR(STR=VM_OPTS_FMT1, CODE=E_OPTS_FMT1, TEST=YES, VECT="F_FDS.FMT_");
     1667     9996    2       END;
     1668     9997    1       CALL VMD$WRITE_BUF (F_FDS);
     1669     9998    1       VECT_ARRAY(0) = vector(VN_YES_CHAR.NAME#);
     1670     9999    1       VECT_ARRAY(1) = vector(VN_YES_CHAR.NAME#);
     1671    10000    1       vbase(VECT_ARRAY(0)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.BROADCAST)
             10000                ),1);
     1672    10001    1       vbase(VECT_ARRAY(1)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.FCOPY) ),1)
             10001                ;
     1673    10002    1       F_FDS.NVECS# = 2;
     1674    10003            %INIT_STR(STR=VM_OPTS_FMT2, CODE=E_OPTS_FMT2, TEST=YES, VECT="F_FDS.FMT_");
     1675    10026    1       CALL VMD$WRITE_BUF (F_FDS);
     1676    10027    1       F_FDS.NVECS# = 1;
     1677    10028    1       RETURN;
     1678    10029        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:268  
     1679    10030        /*F*
     1680    10031             NAME: VMD$DI_DR
     1681    10032             PURPOSE: To display the DELIVERY RECEIPT flag of the current message.
     1682    10033        */
     1683    10034    1   VMD$DI_DR: ENTRY (VM_HEADER,DCB#);
     1684    10035
     1685    10036            %INIT_STR(STR=VM_DR_FMT, CODE=E_DR_FMT, TEST=YES, VECT="F_FDS.FMT_");
     1686    10059            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);
     1687    10082            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);
     1688    10105    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.DR) ) );
     1689    10106    1       return;
     1690    10107        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:269  
     1691    10108        /*F*
     1692    10109             NAME: VMD$DI_BROADCAST
     1693    10110             PURPOSE: To display the BROADCAST flag of the current message.
     1694    10111        */
     1695    10112    1   VMD$DI_BROADCAST: ENTRY (VM_HEADER,DCB#);
     1696    10113
     1697    10114            %INIT_STR(STR=VM_BROADCAST_FMT, CODE=E_BROADCAST_FMT, TEST=YES, VECT=
             10114                "F_FDS.FMT_");
     1698    10137            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);
     1699    10160            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);
     1700    10183    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.BROADCAST) ) );
     1701    10184    1       return;
     1702    10185        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:270  
     1703    10186    1   DISPLAY_FIELD: PROC (PTR$);
     1704    10187        /*
     1705    10188             ***** This routine does the hard work.
     1706    10189                   PTR$ points to the field to display.
     1707    10190                   Assume that F_FDS.FMT_ is setup ...
     1708    10191        */
     1709    10192    2   DCL PTR$ PTR;
     1710    10193        /**/
     1711    10194    2       IF PTR$ ~= ADDR(NIL)
     1712    10195    2       THEN
     1713    10196    2           VECT_ARRAY(0) = VECTOR(PTR$ -> X$STRING.TEXT);
     1714    10197    2       ELSE
     1715    10198    2           VECT_ARRAY(0) = VECTOR(SPACE);
     1716    10199    2       F_FDS.DCB# = DCB#;
     1717    10200    2       CALL VMD$WRITE_BUF (F_FDS);
     1718    10201    2       RETURN;
     1719    10202    2   END DISPLAY_FIELD;
     1720    10203    1   END VMD$DI_SUBJECT;
     1721    10204        %EOD;

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:271  
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMD$DI_SUBJECT.

   Procedure VMD$DI_SUBJECT requires 618 words for executable code.
   Procedure VMD$DI_SUBJECT requires 10 words of local(AUTO) storage.

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:272  

 Object Unit name= VMD$DI_SUBJECT                             File name= VMD$DISPLAY.:VMB6TOU
 UTS= AUG 20 '97 15:09:42.12 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none    36     44  VMD$DI_SUBJECT
   12  RoData even  UTS      1      1  VMD$DI_SUBJECT
   13   Proc  even  none   618   1152  VMD$DI_SUBJECT
   14  RoData even  none    76    114  VMD$DI_SUBJECT
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:273  

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    13      0   yes            yes      Std        2  VMD$DI_SUBJECT
    13     43                  yes      Std        2  VMD$DI_TO
    13     74                  yes      Std        2  VMD$DI_COPY
    13    125                  yes      Std        2  VMD$DI_BLIND
    13    156                  yes      Std        2  VMD$DI_REFERENCE
    13    207                  yes      Std        2  VMD$DI_FCOPY
    13    271                  yes      Std        2  VMD$DI_SIGNED
    13    322                  yes      Std        2  VMD$DI_RR
    13    404                  yes      Std        2  VMD$DI_RTO
    13    435                  yes      Std        2  VMD$DI_DEFER
    13    521                  yes      Std        2  VMD$DI_OPTS
    13    751                  yes      Std        2  VMD$DI_DR
    13   1033                  yes      Std        2  VMD$DI_BROADCAST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 VMD$ERRMSG
         yes           Std       1 VMD$WRITE_BUF
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:274  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA                 r    VM_NO_OR_YES$
     VM_SUBJECT_FMT1                       VM_REFERENCE_FMT1                     VM_COPY_FMT1
     VM_BLIND_COPY_FMT1                    VM_TO_FMT                             VM_FCOPY_FMT
     VM_SIGNED_FMT                         VM_RR_FMT                             VM_RTO_FMT
     VM_DEFER_FMT                          VM_DEFER_FMT1                         VM_OPTS_FMT
     VM_OPTS_FMT1                          VM_OPTS_FMT2                          VM_DR_FMT
     VM_BROADCAST_FMT                      VN_NO_CHAR                            VN_YES_CHAR
r    E_SUBJECT_FMT1                   r    E_REFERENCE_FMT1                 r    E_COPY_FMT1
r    E_BLIND_COPY_FMT1                r    E_TO_FMT                         r    E_FCOPY_FMT
r    E_SIGNED_FMT                     r    E_RR_FMT                         r    E_RTO_FMT
r    E_DEFER_FMT                      r    E_DEFER_FMT1                     r    E_OPTS_FMT
r    E_OPTS_FMT1                      r    E_OPTS_FMT2                      r    E_DR_FMT
r    E_BROADCAST_FMT                  r    E_NO_CHAR                        r    E_YES_CHAR
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:275  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:276  


     1466        1        /*T***********************************************************/
     1467        2        /*T*                                                         */
     1468        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1469        4        /*T*                                                         */
     1470        5        /*T***********************************************************/
     1471        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
     1472        7        /*P*
     1473        8             NAME: VMD$DI_SUBJECT
     1474        9             DESCRIPTION: This routine will display the current SUBJECT field
     1475       10        */
     1476       11
     1477       12        VMD$DI_SUBJECT: PROC (VM_HEADER,DCB#);

     12 13 000000   000000 700200 xent  VMD$DI_SUBJ* TSX0  ! X66_AUTO_2
        13 000001   000012 000002                    ZERO    10,2

     1478       13
     1479       14        /***** Include files *****/
     1480       15        %INCLUDE CP_6_SUBS;
     1481      555        %INCLUDE XU_FORMAT_C;
     1482      717        %INCLUDE CP_6;
     1483     6276        %INCLUDE VM_MACRO_C;
     1484     7544        %INCLUDE VM_SUBS_C;
     1485     7804        %INCLUDE VM_DATA_R;
     1486     8235        /***** Parameters *****/
     1487     8236        %VM_HEADER (STCLASS=" ");
     1488     8365    1   DCL DCB# UBIN WORD;
     1489     8366
     1490     8367        %F_FDS    (VECTR=VECT_ARRAY,
     1491     8368                   NVECS="1");
     1492     8481
     1493     8482    1   dcl VECT_ARRAY (0:2) vector daligned static;
     1494     8483
     1495     8484    1   dcl VM_NO_OR_YES$(0:1)    ptr symref readonly;
     1496     8485    1   dcl BSD                   sbin based;
     1497     8486
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:277  
     1498     8487
     1499     8488
     1500     8489        %VLP_NAMEV( FPTN=VM_SUBJECT_FMT1,     STCLASS=SYMREF );
     1501     8496        %VLP_NAMEV( FPTN=VM_REFERENCE_FMT1,   STCLASS=SYMREF );
     1502     8503        %VLP_NAMEV( FPTN=VM_COPY_FMT1,        STCLASS=SYMREF );
     1503     8510        %VLP_NAMEV( FPTN=VM_BLIND_COPY_FMT1,  STCLASS=SYMREF );
     1504     8517        %VLP_NAMEV( FPTN=VM_TO_FMT,           STCLASS=SYMREF );
     1505     8524        %VLP_NAMEV( FPTN=VM_FCOPY_FMT,        STCLASS=SYMREF );
     1506     8531        %VLP_NAMEV( FPTN=VM_SIGNED_FMT,       STCLASS=SYMREF );
     1507     8538        %VLP_NAMEV( FPTN=VM_RR_FMT,           STCLASS=SYMREF );
     1508     8545        %VLP_NAMEV( FPTN=VM_RTO_FMT,          STCLASS=SYMREF );
     1509     8552        %VLP_NAMEV( FPTN=VM_DEFER_FMT,        STCLASS=SYMREF );
     1510     8559        %VLP_NAMEV( FPTN=VM_DEFER_FMT1,       STCLASS=SYMREF );
     1511     8566        %VLP_NAMEV( FPTN=VM_OPTS_FMT,         STCLASS=SYMREF );
     1512     8573        %VLP_NAMEV( FPTN=VM_OPTS_FMT1,        STCLASS=SYMREF );
     1513     8580        %VLP_NAMEV( FPTN=VM_OPTS_FMT2,        STCLASS=SYMREF );
     1514     8587        %VLP_NAMEV( FPTN=VM_DR_FMT,           STCLASS=SYMREF );
     1515     8594        %VLP_NAMEV( FPTN=VM_BROADCAST_FMT,    STCLASS=SYMREF );
     1516     8601        %VLP_NAMEV( FPTN=VN_NO_CHAR,          STCLASS=SYMREF );
     1517     8608        %VLP_NAMEV( FPTN=VN_YES_CHAR,         STCLASS=SYMREF );
     1518     8615
     1519     8616        %VLP_ERRCODE( FPTN=E_SUBJECT_FMT1,    STCLASS="SYMREF READONLY" );
     1520     8661              %VLP_ERRCODE( FPTN=E_REFERENCE_FMT1, STCLASS="SYMREF READONLY" );
     1521     8706              %VLP_ERRCODE( FPTN=E_COPY_FMT1, STCLASS="SYMREF READONLY" );
     1522     8751              %VLP_ERRCODE( FPTN=E_BLIND_COPY_FMT1, STCLASS="SYMREF READONLY" );
     1523     8796              %VLP_ERRCODE( FPTN=E_TO_FMT,    STCLASS="SYMREF READONLY" );
     1524     8841              %VLP_ERRCODE( FPTN=E_FCOPY_FMT, STCLASS="SYMREF READONLY" );
     1525     8886              %VLP_ERRCODE( FPTN=E_SIGNED_FMT, STCLASS="SYMREF READONLY" );
     1526     8931              %VLP_ERRCODE( FPTN=E_RR_FMT,    STCLASS="SYMREF READONLY" );
     1527     8976              %VLP_ERRCODE( FPTN=E_RTO_FMT,   STCLASS="SYMREF READONLY" );
     1528     9021              %VLP_ERRCODE( FPTN=E_DEFER_FMT, STCLASS="SYMREF READONLY" );
     1529     9066              %VLP_ERRCODE( FPTN=E_DEFER_FMT1, STCLASS="SYMREF READONLY" );
     1530     9111              %VLP_ERRCODE( FPTN=E_OPTS_FMT,  STCLASS="SYMREF READONLY" );
     1531     9156              %VLP_ERRCODE( FPTN=E_OPTS_FMT1, STCLASS="SYMREF READONLY" );
     1532     9201              %VLP_ERRCODE( FPTN=E_OPTS_FMT2, STCLASS="SYMREF READONLY" );
     1533     9246              %VLP_ERRCODE( FPTN=E_DR_FMT,    STCLASS="SYMREF READONLY" );
     1534     9291              %VLP_ERRCODE( FPTN=E_BROADCAST_FMT, STCLASS="SYMREF READONLY" );
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:278  
     1535     9336              %VLP_ERRCODE( FPTN=E_NO_CHAR,   STCLASS="SYMREF READONLY" );
     1536     9381              %VLP_ERRCODE( FPTN=E_YES_CHAR,  STCLASS="SYMREF READONLY" );
     1537     9426
     1538     9427
     1539     9428
     1540     9429
     1541     9430    1   DCL SPACE CHAR(1) CONSTANT INIT(' ');
     1542     9431
     1543     9432    1   DCL VMD$WRITE_BUF ENTRY(1);
     1544     9433        %INIT_STR(DODCL=YES);
     1545     9456
     1546     9457        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:279  
     1547     9458
     1548     9459           %INIT_STR(STR=VM_SUBJECT_FMT1, CODE=E_SUBJECT_FMT1, TEST=YES, VECT="F_FDS.FMT_")
              9459                ;

   9466 13 000002   000000 236000 xsym               LDQ     VM_SUBJECT_FMT1
        13 000003   000033 772000                    QRL     27
        13 000004   000000 620006                    EAX0    0,QL
        13 000005   040000 106440                    CMPC    fill='040'O
        13 000006   000000 200010 xsym               ADSC9   VM_SUBJECT_FMT1          cn=1,n=*X0
        13 000007   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000010   000016 601000 13                 TNZ     s:9471

   9468 13 000011   000002 630400 14                 EPPR0   2
        13 000012   000001 631400 14                 EPPR1   1
        13 000013   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000014   000000 011000                    NOP     0

   9469 13 000015   000023 710000 13                 TRA     s:9482

   9471 13 000016   000000 635010                    EAA     0,X0
        13 000017   000002 771000                    ARL     2
        13 000020   000140 135007                    SBLA    96,DL
        13 000021   000005 236000 14                 LDQ     5
        13 000022   000000 757000 11                 STAQ    F_FDS

     1549     9482    1       IF VM_HEADER.SUBJECT$ ~= ADDR(NIL) THEN

   9482 13 000023   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000024   000030 236100                    LDQ     24,,PR0
        13 000025   000006 116000 14                 CMPQ    6
        13 000026   000035 600000 13                 TZE     s:9484

     1550     9483    1           CALL DISPLAY_FIELD (VM_HEADER.SUBJECT$);

   9483 13 000027   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000030   000030 036003                    ADLQ    24,DU
        13 000031   200007 756100                    STQ     @DCB#+3,,AUTO
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:280  
        13 000032   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000033   000000 011000                    NOP     0
        13 000034   000042 710000 13                 TRA     s:9485

     1551     9484    1       ELSE CALL DISPLAY_FIELD (VM_HEADER.REFERENCE$);

   9484 13 000035   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000036   000024 036003                    ADLQ    20,DU
        13 000037   200007 756100                    STQ     @DCB#+3,,AUTO
        13 000040   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000041   000000 011000                    NOP     0

     1552     9485    1       RETURN;

   9485 13 000042   000000 702200 xent               TSX2  ! X66_ARET

     1553     9486        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:281  
     1554     9487        /*F*
     1555     9488             NAME: VMD$DI_TO
     1556     9489             PURPOSE: To display the TO field of the current message.
     1557     9490        */
     1558     9491    1   VMD$DI_TO: ENTRY (VM_HEADER,DCB#);

   9491 13 000043   000000 700200 xent  VMD$DI_TO    TSX0  ! X66_AUTO_2
        13 000044   000012 000002                    ZERO    10,2

     1559     9492            %INIT_STR(STR=VM_TO_FMT, CODE=E_TO_FMT, TEST=YES, VECT="F_FDS.FMT_");

   9499 13 000045   000000 236000 xsym               LDQ     VM_TO_FMT
        13 000046   000033 772000                    QRL     27
        13 000047   000000 620006                    EAX0    0,QL
        13 000050   040000 106440                    CMPC    fill='040'O
        13 000051   000000 200010 xsym               ADSC9   VM_TO_FMT                cn=1,n=*X0
        13 000052   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000053   000061 601000 13                 TNZ     s:9504

   9501 13 000054   000007 630400 14                 EPPR0   7
        13 000055   000001 631400 14                 EPPR1   1
        13 000056   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000057   000000 011000                    NOP     0

   9502 13 000060   000066 710000 13                 TRA     s:9515

   9504 13 000061   000000 635010                    EAA     0,X0
        13 000062   000002 771000                    ARL     2
        13 000063   000140 135007                    SBLA    96,DL
        13 000064   000012 236000 14                 LDQ     10
        13 000065   000000 757000 11                 STAQ    F_FDS

     1560     9515    1       CALL DISPLAY_FIELD (VM_HEADER.TO$);

   9515 13 000066   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000067   000031 036003                    ADLQ    25,DU
        13 000070   200007 756100                    STQ     @DCB#+3,,AUTO
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:282  
        13 000071   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000072   000000 011000                    NOP     0

     1561     9516    1       RETURN;

   9516 13 000073   000000 702200 xent               TSX2  ! X66_ARET

     1562     9517        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:283  
     1563     9518        /*F*
     1564     9519             NAME: VMD$DI_COPY
     1565     9520             PURPOSE: To display the COPY field of the current message.
     1566     9521        */
     1567     9522    1   VMD$DI_COPY: ENTRY (VM_HEADER,DCB#);

   9522 13 000074   000000 700200 xent  VMD$DI_COPY  TSX0  ! X66_AUTO_2
        13 000075   000012 000002                    ZERO    10,2

     1568     9523            %INIT_STR(STR=VM_COPY_FMT1, CODE=E_COPY_FMT1, TEST=YES, VECT="F_FDS.FMT_");

   9530 13 000076   000000 236000 xsym               LDQ     VM_COPY_FMT1
        13 000077   000033 772000                    QRL     27
        13 000100   000000 620006                    EAX0    0,QL
        13 000101   040000 106440                    CMPC    fill='040'O
        13 000102   000000 200010 xsym               ADSC9   VM_COPY_FMT1             cn=1,n=*X0
        13 000103   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000104   000112 601000 13                 TNZ     s:9535

   9532 13 000105   000013 630400 14                 EPPR0   11
        13 000106   000001 631400 14                 EPPR1   1
        13 000107   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000110   000000 011000                    NOP     0

   9533 13 000111   000117 710000 13                 TRA     s:9546

   9535 13 000112   000000 635010                    EAA     0,X0
        13 000113   000002 771000                    ARL     2
        13 000114   000140 135007                    SBLA    96,DL
        13 000115   000016 236000 14                 LDQ     14
        13 000116   000000 757000 11                 STAQ    F_FDS

     1569     9546    1       CALL DISPLAY_FIELD (VM_HEADER.COPY$);

   9546 13 000117   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000120   000021 036003                    ADLQ    17,DU
        13 000121   200007 756100                    STQ     @DCB#+3,,AUTO
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:284  
        13 000122   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000123   000000 011000                    NOP     0

     1570     9547    1       RETURN;

   9547 13 000124   000000 702200 xent               TSX2  ! X66_ARET

     1571     9548        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:285  
     1572     9549        /*F*
     1573     9550             NAME: VMD$DI_BLIND
     1574     9551             PURPOSE: To display the BLIND COPY FIELD of the current message.
     1575     9552        */
     1576     9553    1   VMD$DI_BLIND: ENTRY (VM_HEADER,DCB#);

   9553 13 000125   000000 700200 xent  VMD$DI_BLIND TSX0  ! X66_AUTO_2
        13 000126   000012 000002                    ZERO    10,2

     1577     9554            %INIT_STR(STR=VM_BLIND_COPY_FMT1, CODE=E_BLIND_COPY_FMT1, TEST=YES, VECT=
              9554                "F_FDS.FMT_");

   9561 13 000127   000000 236000 xsym               LDQ     VM_BLIND_COPY_FMT1
        13 000130   000033 772000                    QRL     27
        13 000131   000000 620006                    EAX0    0,QL
        13 000132   040000 106440                    CMPC    fill='040'O
        13 000133   000000 200010 xsym               ADSC9   VM_BLIND_COPY_FMT1       cn=1,n=*X0
        13 000134   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000135   000143 601000 13                 TNZ     s:9566

   9563 13 000136   000017 630400 14                 EPPR0   15
        13 000137   000001 631400 14                 EPPR1   1
        13 000140   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000141   000000 011000                    NOP     0

   9564 13 000142   000150 710000 13                 TRA     s:9577

   9566 13 000143   000000 635010                    EAA     0,X0
        13 000144   000002 771000                    ARL     2
        13 000145   000140 135007                    SBLA    96,DL
        13 000146   000022 236000 14                 LDQ     18
        13 000147   000000 757000 11                 STAQ    F_FDS

     1578     9577    1       CALL DISPLAY_FIELD (VM_HEADER.BLIND$);

   9577 13 000150   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000151   000020 036003                    ADLQ    16,DU
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:286  
        13 000152   200007 756100                    STQ     @DCB#+3,,AUTO
        13 000153   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000154   000000 011000                    NOP     0

     1579     9578    1       RETURN;

   9578 13 000155   000000 702200 xent               TSX2  ! X66_ARET

     1580     9579        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:287  
     1581     9580        /*F*
     1582     9581             NAME: VMD$DI_REFERENCE
     1583     9582             PURPOSE: To display the REFERENCE field of the current message.
     1584     9583        */
     1585     9584    1   VMD$DI_REFERENCE: ENTRY (VM_HEADER,DCB#);

   9584 13 000156   000000 700200 xent  VMD$DI_REFE* TSX0  ! X66_AUTO_2
        13 000157   000012 000002                    ZERO    10,2

     1586     9585            %INIT_STR(STR=VM_REFERENCE_FMT1, CODE=E_REFERENCE_FMT1, TEST=YES, VECT=
              9585                "F_FDS.FMT_");

   9592 13 000160   000000 236000 xsym               LDQ     VM_REFERENCE_FMT1
        13 000161   000033 772000                    QRL     27
        13 000162   000000 620006                    EAX0    0,QL
        13 000163   040000 106440                    CMPC    fill='040'O
        13 000164   000000 200010 xsym               ADSC9   VM_REFERENCE_FMT1        cn=1,n=*X0
        13 000165   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000166   000174 601000 13                 TNZ     s:9597

   9594 13 000167   000023 630400 14                 EPPR0   19
        13 000170   000001 631400 14                 EPPR1   1
        13 000171   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000172   000000 011000                    NOP     0

   9595 13 000173   000201 710000 13                 TRA     s:9608

   9597 13 000174   000000 635010                    EAA     0,X0
        13 000175   000002 771000                    ARL     2
        13 000176   000140 135007                    SBLA    96,DL
        13 000177   000026 236000 14                 LDQ     22
        13 000200   000000 757000 11                 STAQ    F_FDS

     1587     9608    1       CALL DISPLAY_FIELD (VM_HEADER.REFERENCE$);

   9608 13 000201   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000202   000024 036003                    ADLQ    20,DU
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:288  
        13 000203   200007 756100                    STQ     @DCB#+3,,AUTO
        13 000204   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000205   000000 011000                    NOP     0

     1588     9609    1       RETURN;

   9609 13 000206   000000 702200 xent               TSX2  ! X66_ARET

     1589     9610        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:289  
     1590     9611        /*F*
     1591     9612             NAME: VMD$DI_FCOPY
     1592     9613             PURPOSE: To display the FILE COPY flag of the currnet message.
     1593     9614        */
     1594     9615    1   VMD$DI_FCOPY: ENTRY (VM_HEADER,DCB#);

   9615 13 000207   000000 700200 xent  VMD$DI_FCOPY TSX0  ! X66_AUTO_2
        13 000210   000012 000002                    ZERO    10,2

     1595     9616            %INIT_STR(STR=VM_FCOPY_FMT, CODE=E_FCOPY_FMT, TEST=YES, VECT="F_FDS.FMT_");

   9623 13 000211   000000 236000 xsym               LDQ     VM_FCOPY_FMT
        13 000212   000033 772000                    QRL     27
        13 000213   000000 620006                    EAX0    0,QL
        13 000214   040000 106440                    CMPC    fill='040'O
        13 000215   000000 200010 xsym               ADSC9   VM_FCOPY_FMT             cn=1,n=*X0
        13 000216   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000217   000225 601000 13                 TNZ     s:9628

   9625 13 000220   000027 630400 14                 EPPR0   23
        13 000221   000001 631400 14                 EPPR1   1
        13 000222   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000223   000000 011000                    NOP     0

   9626 13 000224   000232 710000 13                 TRA     s:9646

   9628 13 000225   000000 635010                    EAA     0,X0
        13 000226   000002 771000                    ARL     2
        13 000227   000140 135007                    SBLA    96,DL
        13 000230   000032 236000 14                 LDQ     26
        13 000231   000000 757000 11                 STAQ    F_FDS

     1596     9639            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);

   9646 13 000232   000000 236000 xsym               LDQ     VN_NO_CHAR
        13 000233   000033 772000                    QRL     27
        13 000234   000000 620006                    EAX0    0,QL
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:290  
        13 000235   040000 106440                    CMPC    fill='040'O
        13 000236   000000 200010 xsym               ADSC9   VN_NO_CHAR               cn=1,n=*X0
        13 000237   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000240   000245 601000 13                 TNZ     s:9669

   9648 13 000241   000034 630400 14                 EPPR0   28
        13 000242   000033 631400 14                 EPPR1   27
        13 000243   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000244   000000 011000                    NOP     0

     1597     9662            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);

   9669 13 000245   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 000246   000033 772000                    QRL     27
        13 000247   000000 620006                    EAX0    0,QL
        13 000250   040000 106440                    CMPC    fill='040'O
        13 000251   000000 200010 xsym               ADSC9   VN_YES_CHAR              cn=1,n=*X0
        13 000252   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000253   000260 601000 13                 TNZ     s:9685

   9671 13 000254   000036 630400 14                 EPPR0   30
        13 000255   000033 631400 14                 EPPR1   27
        13 000256   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000257   000000 011000                    NOP     0

     1598     9685    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.FCOPY) ) );

   9685 13 000260   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000261   000012 236100                    LDQ     10,,PR0
        13 000262   000031 772000                    QRL     25
        13 000263   000001 376007                    ANQ     1,DL
        13 000264   000000 631406 xsym               EPPR1   VM_NO_OR_YES$,QL
        13 000265   200007 451500                    STP1    @DCB#+3,,AUTO
        13 000266   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000267   000000 011000                    NOP     0

     1599     9686    1       RETURN;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:291  

   9686 13 000270   000000 702200 xent               TSX2  ! X66_ARET

     1600     9687        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:292  
     1601     9688        /*F*
     1602     9689             NAME: VMD$DI_SIGNED
     1603     9690             PURPOSE: To display the signed field of the current message.
     1604     9691        */
     1605     9692    1   VMD$DI_SIGNED: ENTRY (VM_HEADER,DCB#);

   9692 13 000271   000000 700200 xent  VMD$DI_SIGN* TSX0  ! X66_AUTO_2
        13 000272   000012 000002                    ZERO    10,2

     1606     9693            %INIT_STR(STR=VM_SIGNED_FMT, CODE=E_SIGNED_FMT, TEST=YES, VECT="F_FDS.FMT_");

   9700 13 000273   000000 236000 xsym               LDQ     VM_SIGNED_FMT
        13 000274   000033 772000                    QRL     27
        13 000275   000000 620006                    EAX0    0,QL
        13 000276   040000 106440                    CMPC    fill='040'O
        13 000277   000000 200010 xsym               ADSC9   VM_SIGNED_FMT            cn=1,n=*X0
        13 000300   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000301   000307 601000 13                 TNZ     s:9705

   9702 13 000302   000040 630400 14                 EPPR0   32
        13 000303   000001 631400 14                 EPPR1   1
        13 000304   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000305   000000 011000                    NOP     0

   9703 13 000306   000314 710000 13                 TRA     s:9716

   9705 13 000307   000000 635010                    EAA     0,X0
        13 000310   000002 771000                    ARL     2
        13 000311   000140 135007                    SBLA    96,DL
        13 000312   000043 236000 14                 LDQ     35
        13 000313   000000 757000 11                 STAQ    F_FDS

     1607     9716    1       CALL DISPLAY_FIELD (VM_HEADER.SIGNED$);

   9716 13 000314   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000315   000027 036003                    ADLQ    23,DU
        13 000316   200007 756100                    STQ     @DCB#+3,,AUTO
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:293  
        13 000317   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000320   000000 011000                    NOP     0

     1608     9717    1       RETURN;

   9717 13 000321   000000 702200 xent               TSX2  ! X66_ARET

     1609     9718        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:294  
     1610     9719        /*F*
     1611     9720             NAME: VMD$DI_RR
     1612     9721             PURPOSE: To display the RETURN RECEIPT flag of the current message.
     1613     9722        */
     1614     9723    1   VMD$DI_RR: ENTRY (VM_HEADER,DCB#);

   9723 13 000322   000000 700200 xent  VMD$DI_RR    TSX0  ! X66_AUTO_2
        13 000323   000012 000002                    ZERO    10,2

     1615     9724            %INIT_STR(STR=VM_RR_FMT, CODE=E_RR_FMT, TEST=YES, VECT="F_FDS.FMT_");

   9731 13 000324   000000 236000 xsym               LDQ     VM_RR_FMT
        13 000325   000033 772000                    QRL     27
        13 000326   000000 620006                    EAX0    0,QL
        13 000327   040000 106440                    CMPC    fill='040'O
        13 000330   000000 200010 xsym               ADSC9   VM_RR_FMT                cn=1,n=*X0
        13 000331   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000332   000340 601000 13                 TNZ     s:9736

   9733 13 000333   000044 630400 14                 EPPR0   36
        13 000334   000001 631400 14                 EPPR1   1
        13 000335   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000336   000000 011000                    NOP     0

   9734 13 000337   000345 710000 13                 TRA     s:9754

   9736 13 000340   000000 635010                    EAA     0,X0
        13 000341   000002 771000                    ARL     2
        13 000342   000140 135007                    SBLA    96,DL
        13 000343   000047 236000 14                 LDQ     39
        13 000344   000000 757000 11                 STAQ    F_FDS

     1616     9747            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);

   9754 13 000345   000000 236000 xsym               LDQ     VN_NO_CHAR
        13 000346   000033 772000                    QRL     27
        13 000347   000000 620006                    EAX0    0,QL
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:295  
        13 000350   040000 106440                    CMPC    fill='040'O
        13 000351   000000 200010 xsym               ADSC9   VN_NO_CHAR               cn=1,n=*X0
        13 000352   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000353   000360 601000 13                 TNZ     s:9777

   9756 13 000354   000034 630400 14                 EPPR0   28
        13 000355   000033 631400 14                 EPPR1   27
        13 000356   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000357   000000 011000                    NOP     0

     1617     9770            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);

   9777 13 000360   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 000361   000033 772000                    QRL     27
        13 000362   000000 620006                    EAX0    0,QL
        13 000363   040000 106440                    CMPC    fill='040'O
        13 000364   000000 200010 xsym               ADSC9   VN_YES_CHAR              cn=1,n=*X0
        13 000365   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000366   000373 601000 13                 TNZ     s:9793

   9779 13 000367   000036 630400 14                 EPPR0   30
        13 000370   000033 631400 14                 EPPR1   27
        13 000371   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000372   000000 011000                    NOP     0

     1618     9793    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.RR) ) );

   9793 13 000373   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000374   000012 236100                    LDQ     10,,PR0
        13 000375   000037 772000                    QRL     31
        13 000376   000001 376007                    ANQ     1,DL
        13 000377   000000 631406 xsym               EPPR1   VM_NO_OR_YES$,QL
        13 000400   200007 451500                    STP1    @DCB#+3,,AUTO
        13 000401   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000402   000000 011000                    NOP     0

     1619     9794    1       RETURN;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:296  

   9794 13 000403   000000 702200 xent               TSX2  ! X66_ARET

     1620     9795        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:297  
     1621     9796        /*F*
     1622     9797             NAME: VMD$DI_RTO
     1623     9798             PURPOSE: To display the REPLY TO field of the current message.
     1624     9799        */
     1625     9800    1   VMD$DI_RTO: ENTRY (VM_HEADER,DCB#);

   9800 13 000404   000000 700200 xent  VMD$DI_RTO   TSX0  ! X66_AUTO_2
        13 000405   000012 000002                    ZERO    10,2

     1626     9801            %INIT_STR(STR=VM_RTO_FMT, CODE=E_RTO_FMT, TEST=YES, VECT="F_FDS.FMT_");

   9808 13 000406   000000 236000 xsym               LDQ     VM_RTO_FMT
        13 000407   000033 772000                    QRL     27
        13 000410   000000 620006                    EAX0    0,QL
        13 000411   040000 106440                    CMPC    fill='040'O
        13 000412   000000 200010 xsym               ADSC9   VM_RTO_FMT               cn=1,n=*X0
        13 000413   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000414   000422 601000 13                 TNZ     s:9813

   9810 13 000415   000050 630400 14                 EPPR0   40
        13 000416   000001 631400 14                 EPPR1   1
        13 000417   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000420   000000 011000                    NOP     0

   9811 13 000421   000427 710000 13                 TRA     s:9824

   9813 13 000422   000000 635010                    EAA     0,X0
        13 000423   000002 771000                    ARL     2
        13 000424   000140 135007                    SBLA    96,DL
        13 000425   000053 236000 14                 LDQ     43
        13 000426   000000 757000 11                 STAQ    F_FDS

     1627     9824    1       CALL DISPLAY_FIELD (VM_HEADER.REPLY_TO$);

   9824 13 000427   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000430   000025 036003                    ADLQ    21,DU
        13 000431   200007 756100                    STQ     @DCB#+3,,AUTO
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:298  
        13 000432   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 000433   000000 011000                    NOP     0

     1628     9825    1       RETURN;

   9825 13 000434   000000 702200 xent               TSX2  ! X66_ARET

     1629     9826        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:299  
     1630     9827        /*F*
     1631     9828             NAME: VMD$DI_DEFER
     1632     9829             PURPOSE: To display the DELIVERY DATE of the current message.
     1633     9830        */
     1634     9831    1   VMD$DI_DEFER: ENTRY (VM_HEADER,DCB#);

   9831 13 000435   000000 700200 xent  VMD$DI_DEFER TSX0  ! X66_AUTO_2
        13 000436   000012 000002                    ZERO    10,2

     1635     9832    1       F_FDS.DCB# = DCB#;

   9832 13 000437   200004 470500                    LDP0    @DCB#,,AUTO
        13 000440   000000 720100                    LXL0    0,,PR0
        13 000441   000013 740000 11                 STX0    F_FDS+11

     1636     9833    1       VECT_ARRAY(0) = VECTOR(VM_HEADER.DELIVERY_DATE);

   9833 13 000442   777640 235007                    LDA     -96,DL
        13 000443   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000444   000002 036003                    ADLQ    2,DU
        13 000445   000036 757000 11                 STAQ    VECT_ARRAY

     1637     9834    1       IF VM_HEADER.DELIVERY_DATE > 0

   9834 13 000446   200003 471500                    LDP1    @VM_HEADER,,AUTO
        13 000447   100002 235100                    LDA     2,,PR1
        13 000450   000473 600000 13                 TZE     s:9867

     1638     9835    1       THEN
     1639     9836                %INIT_STR(STR=VM_DEFER_FMT, CODE=E_DEFER_FMT, TEST=YES, VECT="F_FDS.FMT_");

   9843 13 000451   000000 236000 xsym               LDQ     VM_DEFER_FMT
        13 000452   000033 772000                    QRL     27
        13 000453   000000 621006                    EAX1    0,QL
        13 000454   040000 106440                    CMPC    fill='040'O
        13 000455   000000 200011 xsym               ADSC9   VM_DEFER_FMT             cn=1,n=*X1
        13 000456   000000 000001 14                 ADSC9   0                        cn=0,n=1
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:300  
        13 000457   000465 601000 13                 TNZ     s:9848

   9845 13 000460   000054 630400 14                 EPPR0   44
        13 000461   000001 631400 14                 EPPR1   1
        13 000462   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000463   000000 011000                    NOP     0

   9846 13 000464   000514 710000 13                 TRA     s:9883

   9848 13 000465   000000 635011                    EAA     0,X1
        13 000466   000002 771000                    ARL     2
        13 000467   000140 135007                    SBLA    96,DL
        13 000470   000057 236000 14                 LDQ     47
        13 000471   000000 757000 11                 STAQ    F_FDS

   9856 13 000472   000514 710000 13                 TRA     s:9883

     1640     9859    1       ELSE
     1641     9860               %INIT_STR(STR=VM_DEFER_FMT1, CODE=E_DEFER_FMT1, TEST=YES, VECT="F_FDS.FMT_")
              9860                    ;

   9867 13 000473   000000 236000 xsym               LDQ     VM_DEFER_FMT1
        13 000474   000033 772000                    QRL     27
        13 000475   000000 621006                    EAX1    0,QL
        13 000476   040000 106440                    CMPC    fill='040'O
        13 000477   000000 200011 xsym               ADSC9   VM_DEFER_FMT1            cn=1,n=*X1
        13 000500   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000501   000507 601000 13                 TNZ     s:9872

   9869 13 000502   000060 630400 14                 EPPR0   48
        13 000503   000001 631400 14                 EPPR1   1
        13 000504   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000505   000000 011000                    NOP     0

   9870 13 000506   000514 710000 13                 TRA     s:9883

   9872 13 000507   000000 635011                    EAA     0,X1
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:301  
        13 000510   000002 771000                    ARL     2
        13 000511   000140 135007                    SBLA    96,DL
        13 000512   000063 236000 14                 LDQ     51
        13 000513   000000 757000 11                 STAQ    F_FDS

     1642     9883    1       CALL VMD$WRITE_BUF (F_FDS);

   9883 13 000514   000004 630400 14                 EPPR0   4
        13 000515   000064 631400 14                 EPPR1   52
        13 000516   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 000517   000000 011000                    NOP     0

     1643     9884    1       RETURN;

   9884 13 000520   000000 702200 xent               TSX2  ! X66_ARET

     1644     9885        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:302  
     1645     9886        /*F*
     1646     9887             NAME: VMD$DI_OPTS
     1647     9888             PURPOSE: To display various SEND options.
     1648     9889        */
     1649     9890    1   VMD$DI_OPTS: ENTRY (VM_HEADER,DCB#);

   9890 13 000521   000000 700200 xent  VMD$DI_OPTS  TSX0  ! X66_AUTO_2
        13 000522   000012 000002                    ZERO    10,2

     1650     9891    1       F_FDS.DCB# = DCB#;

   9891 13 000523   200004 470500                    LDP0    @DCB#,,AUTO
        13 000524   000000 720100                    LXL0    0,,PR0
        13 000525   000013 740000 11                 STX0    F_FDS+11

     1651     9892            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);

   9899 13 000526   000000 236000 xsym               LDQ     VN_NO_CHAR
        13 000527   000033 772000                    QRL     27
        13 000530   000000 621006                    EAX1    0,QL
        13 000531   040000 106440                    CMPC    fill='040'O
        13 000532   000000 200011 xsym               ADSC9   VN_NO_CHAR               cn=1,n=*X1
        13 000533   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000534   000541 601000 13                 TNZ     s:9922

   9901 13 000535   000034 630400 14                 EPPR0   28
        13 000536   000033 631400 14                 EPPR1   27
        13 000537   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000540   000000 011000                    NOP     0

     1652     9915            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);

   9922 13 000541   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 000542   000033 772000                    QRL     27
        13 000543   000000 620006                    EAX0    0,QL
        13 000544   040000 106440                    CMPC    fill='040'O
        13 000545   000000 200010 xsym               ADSC9   VN_YES_CHAR              cn=1,n=*X0
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:303  
        13 000546   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000547   000554 601000 13                 TNZ     s:9938

   9924 13 000550   000036 630400 14                 EPPR0   30
        13 000551   000033 631400 14                 EPPR1   27
        13 000552   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000553   000000 011000                    NOP     0

     1653     9938    1       VECT_ARRAY(0) = vector(VN_YES_CHAR.NAME#);

   9938 13 000554   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 000555   000033 772000                    QRL     27
        13 000556   000064 737000                    LLS     52
        13 000557   000140 135007                    SBLA    96,DL
        13 000560   000065 236000 14                 LDQ     53
        13 000561   000036 757000 11                 STAQ    VECT_ARRAY

     1654     9939    1       VECT_ARRAY(1) = vector(VN_YES_CHAR.NAME#);

   9939 13 000562   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 000563   000033 772000                    QRL     27
        13 000564   000064 737000                    LLS     52
        13 000565   000140 135007                    SBLA    96,DL
        13 000566   000065 236000 14                 LDQ     53
        13 000567   000040 757000 11                 STAQ    VECT_ARRAY+2

     1655     9940    1       vbase(VECT_ARRAY(0)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.DR) ),1);

   9940 13 000570   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000571   000012 236100                    LDQ     10,,PR0
        13 000572   000024 772000                    QRL     20
        13 000573   000001 376007                    ANQ     1,DL
        13 000574   000000 236006 xsym               LDQ     VM_NO_OR_YES$,QL
        13 000575   200000 036007                    ADLQ    65536,DL
        13 000576   000037 756000 11                 STQ     VECT_ARRAY+1

     1656     9941    1       vbase(VECT_ARRAY(1)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.RR) ),1);
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:304  

   9941 13 000577   000012 236100                    LDQ     10,,PR0
        13 000600   000037 772000                    QRL     31
        13 000601   000001 376007                    ANQ     1,DL
        13 000602   000000 236006 xsym               LDQ     VM_NO_OR_YES$,QL
        13 000603   200000 036007                    ADLQ    65536,DL
        13 000604   000041 756000 11                 STQ     VECT_ARRAY+3

     1657     9942    1       IF VM_HEADER.DELIVERY_DATE > 0

   9942 13 000605   000002 235100                    LDA     2,,PR0
        13 000606   000637 600000 13                 TZE     s:9972

     1658     9943    2       THEN DO;

     1659     9944    2           VECT_ARRAY(2) = VECTOR(VM_HEADER.DELIVERY_DATE);

   9944 13 000607   777640 235007                    LDA     -96,DL
        13 000610   200003 236100                    LDQ     @VM_HEADER,,AUTO
        13 000611   000002 036003                    ADLQ    2,DU
        13 000612   000042 757000 11                 STAQ    VECT_ARRAY+4

     1660     9945    2           F_FDS.NVECS# = 3;

   9945 13 000613   000003 235007                    LDA     3,DL
        13 000614   000011 755000 11                 STA     F_FDS+9

     1661     9946                %INIT_STR(STR=VM_OPTS_FMT, CODE=E_OPTS_FMT, TEST=YES, VECT="F_FDS.FMT_");

   9953 13 000615   000000 236000 xsym               LDQ     VM_OPTS_FMT
        13 000616   000033 772000                    QRL     27
        13 000617   000000 620006                    EAX0    0,QL
        13 000620   040000 106440                    CMPC    fill='040'O
        13 000621   000000 200010 xsym               ADSC9   VM_OPTS_FMT              cn=1,n=*X0
        13 000622   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000623   000631 601000 13                 TNZ     s:9958

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:305  
   9955 13 000624   000066 630400 14                 EPPR0   54
        13 000625   000001 631400 14                 EPPR1   1
        13 000626   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000627   000000 011000                    NOP     0

   9956 13 000630   000662 710000 13                 TRA     s:9997

   9958 13 000631   000000 635010                    EAA     0,X0
        13 000632   000002 771000                    ARL     2
        13 000633   000140 135007                    SBLA    96,DL
        13 000634   000071 236000 14                 LDQ     57
        13 000635   000000 757000 11                 STAQ    F_FDS

     1662     9969    2       END;

   9969 13 000636   000662 710000 13                 TRA     s:9997

     1663     9970    1       ELSE
     1664     9971    2       DO;

     1665     9972    2           F_FDS.NVECS# = 2;

   9972 13 000637   000002 235007                    LDA     2,DL
        13 000640   000011 755000 11                 STA     F_FDS+9

     1666     9973                %INIT_STR(STR=VM_OPTS_FMT1, CODE=E_OPTS_FMT1, TEST=YES, VECT="F_FDS.FMT_");

   9980 13 000641   000000 236000 xsym               LDQ     VM_OPTS_FMT1
        13 000642   000033 772000                    QRL     27
        13 000643   000000 620006                    EAX0    0,QL
        13 000644   040000 106440                    CMPC    fill='040'O
        13 000645   000000 200010 xsym               ADSC9   VM_OPTS_FMT1             cn=1,n=*X0
        13 000646   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000647   000655 601000 13                 TNZ     s:9985

   9982 13 000650   000072 630400 14                 EPPR0   58
        13 000651   000001 631400 14                 EPPR1   1
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:306  
        13 000652   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000653   000000 011000                    NOP     0

   9983 13 000654   000662 710000 13                 TRA     s:9997

   9985 13 000655   000000 635010                    EAA     0,X0
        13 000656   000002 771000                    ARL     2
        13 000657   000140 135007                    SBLA    96,DL
        13 000660   000075 236000 14                 LDQ     61
        13 000661   000000 757000 11                 STAQ    F_FDS

     1667     9996    2       END;

     1668     9997    1       CALL VMD$WRITE_BUF (F_FDS);

   9997 13 000662   000004 630400 14                 EPPR0   4
        13 000663   000064 631400 14                 EPPR1   52
        13 000664   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 000665   000000 011000                    NOP     0

     1669     9998    1       VECT_ARRAY(0) = vector(VN_YES_CHAR.NAME#);

   9998 13 000666   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 000667   000033 772000                    QRL     27
        13 000670   000064 737000                    LLS     52
        13 000671   000140 135007                    SBLA    96,DL
        13 000672   000065 236000 14                 LDQ     53
        13 000673   000036 757000 11                 STAQ    VECT_ARRAY

     1670     9999    1       VECT_ARRAY(1) = vector(VN_YES_CHAR.NAME#);

   9999 13 000674   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 000675   000033 772000                    QRL     27
        13 000676   000064 737000                    LLS     52
        13 000677   000140 135007                    SBLA    96,DL
        13 000700   000065 236000 14                 LDQ     53
        13 000701   000040 757000 11                 STAQ    VECT_ARRAY+2
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:307  

     1671    10000    1       vbase(VECT_ARRAY(0)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.BROADCAST)
             10000                ),1);

  10000 13 000702   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 000703   000012 236100                    LDQ     10,,PR0
        13 000704   000022 772000                    QRL     18
        13 000705   000001 376007                    ANQ     1,DL
        13 000706   000000 236006 xsym               LDQ     VM_NO_OR_YES$,QL
        13 000707   200000 036007                    ADLQ    65536,DL
        13 000710   000037 756000 11                 STQ     VECT_ARRAY+1

     1672    10001    1      vbase(VECT_ARRAY(1)) = pincrc(VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.FCOPY) ),1)
             10001                ;

  10001 13 000711   000012 236100                    LDQ     10,,PR0
        13 000712   000031 772000                    QRL     25
        13 000713   000001 376007                    ANQ     1,DL
        13 000714   000000 236006 xsym               LDQ     VM_NO_OR_YES$,QL
        13 000715   200000 036007                    ADLQ    65536,DL
        13 000716   000041 756000 11                 STQ     VECT_ARRAY+3

     1673    10002    1       F_FDS.NVECS# = 2;

  10002 13 000717   000002 235007                    LDA     2,DL
        13 000720   000011 755000 11                 STA     F_FDS+9

     1674    10003            %INIT_STR(STR=VM_OPTS_FMT2, CODE=E_OPTS_FMT2, TEST=YES, VECT="F_FDS.FMT_");

  10010 13 000721   000000 236000 xsym               LDQ     VM_OPTS_FMT2
        13 000722   000033 772000                    QRL     27
        13 000723   000000 620006                    EAX0    0,QL
        13 000724   040000 106440                    CMPC    fill='040'O
        13 000725   000000 200010 xsym               ADSC9   VM_OPTS_FMT2             cn=1,n=*X0
        13 000726   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000727   000735 601000 13                 TNZ     s:10015

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:308  
  10012 13 000730   000076 630400 14                 EPPR0   62
        13 000731   000001 631400 14                 EPPR1   1
        13 000732   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000733   000000 011000                    NOP     0

  10013 13 000734   000742 710000 13                 TRA     s:10026

  10015 13 000735   000000 635010                    EAA     0,X0
        13 000736   000002 771000                    ARL     2
        13 000737   000140 135007                    SBLA    96,DL
        13 000740   000101 236000 14                 LDQ     65
        13 000741   000000 757000 11                 STAQ    F_FDS

     1675    10026    1       CALL VMD$WRITE_BUF (F_FDS);

  10026 13 000742   000004 630400 14                 EPPR0   4
        13 000743   000064 631400 14                 EPPR1   52
        13 000744   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 000745   000000 011000                    NOP     0

     1676    10027    1       F_FDS.NVECS# = 1;

  10027 13 000746   000001 235007                    LDA     1,DL
        13 000747   000011 755000 11                 STA     F_FDS+9

     1677    10028    1       RETURN;

  10028 13 000750   000000 702200 xent               TSX2  ! X66_ARET

     1678    10029        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:309  
     1679    10030        /*F*
     1680    10031             NAME: VMD$DI_DR
     1681    10032             PURPOSE: To display the DELIVERY RECEIPT flag of the current message.
     1682    10033        */
     1683    10034    1   VMD$DI_DR: ENTRY (VM_HEADER,DCB#);

  10034 13 000751   000000 700200 xent  VMD$DI_DR    TSX0  ! X66_AUTO_2
        13 000752   000012 000002                    ZERO    10,2

     1684    10035
     1685    10036            %INIT_STR(STR=VM_DR_FMT, CODE=E_DR_FMT, TEST=YES, VECT="F_FDS.FMT_");

  10043 13 000753   000000 236000 xsym               LDQ     VM_DR_FMT
        13 000754   000033 772000                    QRL     27
        13 000755   000000 620006                    EAX0    0,QL
        13 000756   040000 106440                    CMPC    fill='040'O
        13 000757   000000 200010 xsym               ADSC9   VM_DR_FMT                cn=1,n=*X0
        13 000760   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 000761   000767 601000 13                 TNZ     s:10048

  10045 13 000762   000102 630400 14                 EPPR0   66
        13 000763   000001 631400 14                 EPPR1   1
        13 000764   000000 701000 xent               TSX1    VMD$ERRMSG
        13 000765   000000 011000                    NOP     0

  10046 13 000766   000774 710000 13                 TRA     s:10066

  10048 13 000767   000000 635010                    EAA     0,X0
        13 000770   000002 771000                    ARL     2
        13 000771   000140 135007                    SBLA    96,DL
        13 000772   000105 236000 14                 LDQ     69
        13 000773   000000 757000 11                 STAQ    F_FDS

     1686    10059            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);

  10066 13 000774   000000 236000 xsym               LDQ     VN_NO_CHAR
        13 000775   000033 772000                    QRL     27
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:310  
        13 000776   000000 620006                    EAX0    0,QL
        13 000777   040000 106440                    CMPC    fill='040'O
        13 001000   000000 200010 xsym               ADSC9   VN_NO_CHAR               cn=1,n=*X0
        13 001001   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 001002   001007 601000 13                 TNZ     s:10089

  10068 13 001003   000034 630400 14                 EPPR0   28
        13 001004   000033 631400 14                 EPPR1   27
        13 001005   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001006   000000 011000                    NOP     0

     1687    10082            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);

  10089 13 001007   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 001010   000033 772000                    QRL     27
        13 001011   000000 620006                    EAX0    0,QL
        13 001012   040000 106440                    CMPC    fill='040'O
        13 001013   000000 200010 xsym               ADSC9   VN_YES_CHAR              cn=1,n=*X0
        13 001014   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 001015   001022 601000 13                 TNZ     s:10105

  10091 13 001016   000036 630400 14                 EPPR0   30
        13 001017   000033 631400 14                 EPPR1   27
        13 001020   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001021   000000 011000                    NOP     0

     1688    10105    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.DR) ) );

  10105 13 001022   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 001023   000012 236100                    LDQ     10,,PR0
        13 001024   000024 772000                    QRL     20
        13 001025   000001 376007                    ANQ     1,DL
        13 001026   000000 631406 xsym               EPPR1   VM_NO_OR_YES$,QL
        13 001027   200007 451500                    STP1    @DCB#+3,,AUTO
        13 001030   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 001031   000000 011000                    NOP     0

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:311  
     1689    10106    1       return;

  10106 13 001032   000000 702200 xent               TSX2  ! X66_ARET

     1690    10107        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:312  
     1691    10108        /*F*
     1692    10109             NAME: VMD$DI_BROADCAST
     1693    10110             PURPOSE: To display the BROADCAST flag of the current message.
     1694    10111        */
     1695    10112    1   VMD$DI_BROADCAST: ENTRY (VM_HEADER,DCB#);

  10112 13 001033   000000 700200 xent  VMD$DI_BROA* TSX0  ! X66_AUTO_2
        13 001034   000012 000002                    ZERO    10,2

     1696    10113
     1697    10114            %INIT_STR(STR=VM_BROADCAST_FMT, CODE=E_BROADCAST_FMT, TEST=YES, VECT=
             10114                "F_FDS.FMT_");

  10121 13 001035   000000 236000 xsym               LDQ     VM_BROADCAST_FMT
        13 001036   000033 772000                    QRL     27
        13 001037   000000 620006                    EAX0    0,QL
        13 001040   040000 106440                    CMPC    fill='040'O
        13 001041   000000 200010 xsym               ADSC9   VM_BROADCAST_FMT         cn=1,n=*X0
        13 001042   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 001043   001051 601000 13                 TNZ     s:10126

  10123 13 001044   000106 630400 14                 EPPR0   70
        13 001045   000001 631400 14                 EPPR1   1
        13 001046   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001047   000000 011000                    NOP     0

  10124 13 001050   001056 710000 13                 TRA     s:10144

  10126 13 001051   000000 635010                    EAA     0,X0
        13 001052   000002 771000                    ARL     2
        13 001053   000140 135007                    SBLA    96,DL
        13 001054   000111 236000 14                 LDQ     73
        13 001055   000000 757000 11                 STAQ    F_FDS

     1698    10137            %INIT_STR(STR=VN_NO_CHAR, CODE=E_NO_CHAR, TEST=YES);

  10144 13 001056   000000 236000 xsym               LDQ     VN_NO_CHAR
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:313  
        13 001057   000033 772000                    QRL     27
        13 001060   000000 620006                    EAX0    0,QL
        13 001061   040000 106440                    CMPC    fill='040'O
        13 001062   000000 200010 xsym               ADSC9   VN_NO_CHAR               cn=1,n=*X0
        13 001063   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 001064   001071 601000 13                 TNZ     s:10167

  10146 13 001065   000034 630400 14                 EPPR0   28
        13 001066   000033 631400 14                 EPPR1   27
        13 001067   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001070   000000 011000                    NOP     0

     1699    10160            %INIT_STR(STR=VN_YES_CHAR, CODE=E_YES_CHAR, TEST=YES);

  10167 13 001071   000000 236000 xsym               LDQ     VN_YES_CHAR
        13 001072   000033 772000                    QRL     27
        13 001073   000000 620006                    EAX0    0,QL
        13 001074   040000 106440                    CMPC    fill='040'O
        13 001075   000000 200010 xsym               ADSC9   VN_YES_CHAR              cn=1,n=*X0
        13 001076   000000 000001 14                 ADSC9   0                        cn=0,n=1
        13 001077   001104 601000 13                 TNZ     s:10183

  10169 13 001100   000036 630400 14                 EPPR0   30
        13 001101   000033 631400 14                 EPPR1   27
        13 001102   000000 701000 xent               TSX1    VMD$ERRMSG
        13 001103   000000 011000                    NOP     0

     1700    10183    1       call DISPLAY_FIELD( VM_NO_OR_YES$( bitbin(VM_HEADER.STATUS.BROADCAST) ) );

  10183 13 001104   200003 470500                    LDP0    @VM_HEADER,,AUTO
        13 001105   000012 236100                    LDQ     10,,PR0
        13 001106   000022 772000                    QRL     18
        13 001107   000001 376007                    ANQ     1,DL
        13 001110   000000 631406 xsym               EPPR1   VM_NO_OR_YES$,QL
        13 001111   200007 451500                    STP1    @DCB#+3,,AUTO
        13 001112   001115 701000 13                 TSX1    DISPLAY_FIELD
        13 001113   000000 011000                    NOP     0
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:314  

     1701    10184    1       return;

  10184 13 001114   000000 702200 xent               TSX2  ! X66_ARET

     1702    10185        %EJECT;
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:315  
     1703    10186    1   DISPLAY_FIELD: PROC (PTR$);

  10186 13 001115   200006 741300       DISPLAY_FIE* STX1  ! @DCB#+2,,AUTO

     1704    10187        /*
     1705    10188             ***** This routine does the hard work.
     1706    10189                   PTR$ points to the field to display.
     1707    10190                   Assume that F_FDS.FMT_ is setup ...
     1708    10191        */
     1709    10192    2   DCL PTR$ PTR;
     1710    10193        /**/
     1711    10194    2       IF PTR$ ~= ADDR(NIL)

  10194 13 001116   200007 470500                    LDP0    @PTR$,,AUTO
        13 001117   000000 236100                    LDQ     0,,PR0
        13 001120   000006 116000 14                 CMPQ    6
        13 001121   001137 600000 13                 TZE     s:10198

     1712    10195    2       THEN
     1713    10196    2           VECT_ARRAY(0) = VECTOR(PTR$ -> X$STRING.TEXT);

  10196 13 001122   000000 471500                    LDP1    0,,PR0
        13 001123   000100 101500                    MRL     fill='000'O
        13 001124   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
        13 001125   200010 000002                    ADSC9   @PTR$+1,,AUTO            cn=0,n=2
        13 001126   200010 220100                    LDX0    @PTR$+1,,AUTO
        13 001127   000000 635010                    EAA     0,X0
        13 001130   000002 771000                    ARL     2
        13 001131   000140 135007                    SBLA    96,DL
        13 001132   200011 451500                    STP1    @PTR$+2,,AUTO
        13 001133   200011 236100                    LDQ     @PTR$+2,,AUTO
        13 001134   200000 036007                    ADLQ    65536,DL
        13 001135   000036 757000 11                 STAQ    VECT_ARRAY
        13 001136   001141 710000 13                 TRA     s:10199

     1714    10197    2       ELSE
     1715    10198    2           VECT_ARRAY(0) = VECTOR(SPACE);
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:316  

  10198 13 001137   000112 237000 14                 LDAQ    74
        13 001140   000036 757000 11                 STAQ    VECT_ARRAY

     1716    10199    2       F_FDS.DCB# = DCB#;

  10199 13 001141   200004 471500                    LDP1    @DCB#,,AUTO
        13 001142   100000 720100                    LXL0    0,,PR1
        13 001143   000013 740000 11                 STX0    F_FDS+11

     1717    10200    2       CALL VMD$WRITE_BUF (F_FDS);

  10200 13 001144   000004 630400 14                 EPPR0   4
        13 001145   000064 631400 14                 EPPR1   52
        13 001146   000000 701000 xent               TSX1    VMD$WRITE_BUF
        13 001147   000000 011000                    NOP     0

     1718    10201    2       RETURN;

  10201 13 001150   200006 221300                    LDX1  ! @DCB#+2,,AUTO
        13 001151   000001 702211                    TSX2  ! 1,X1

F_FDS
 Sect OctLoc
  11     000   000000 177640   000000 006014   000000 000000   000000 000000    ................
  11     004   000000 000000   000000 177640   000000 006014   000000 000001    ................
  11     010   000000 000000   000000 000001   000036 006000   000000 101500    ..............A.
  11     014   000000 000000   000000 000000   000000 000001   000000 000012    ................
  11     020   000000 000000   ****** ******   ****** ******   000000 000000    ................
  11     024   000000 000000   000000 000000   000000 000000   000000 006014    ................
  11     030   000000 006014   000000 006014   000000 006014   000000 000000    ................
  11     034   000000 000000   000000 000000                                    ........

VECT_ARRAY
 Sect OctLoc
  11     036   ****** ******   ****** ******   ****** ******   ****** ******    ................

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:317  
SPACE
 Sect OctLoc
  12     000   040*** ******                                                     ...

(unnamed)
 Sect OctLoc
  14     000   040040 040040   000003 000000   000000 006000   000000 006000        ............
  14     004   000000 006000   000000 206000   000000 006014   000000 006000    ................
  14     010   000000 006000   000000 006000   000000 206000   000000 006000    ................
  14     030*  000000 006000   000000 006000   000000 206000   000002 000000    ................
  14     034   000000 006000   000000 006000   000000 006000   000000 006000    ................
  14     040   000000 006000   000000 006000   000000 006000   000000 206000    ................
  14     064*  000001 000000   000000 206000   000000 006000   000000 006000    ................
  14     070   000000 006000   000000 206000   000000 006000   000000 006000    ................
  14     110*  000000 006000   000000 206000   000000 177640   000000 006000    ................
     1719    10202    2   END DISPLAY_FIELD;
     1720    10203    1   END VMD$DI_SUBJECT;
     1721    10204        %EOD;

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:318  
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   VM_SUBS_C.:VMB6TOU  is referenced.
   VM_MACRO_C.:VMB6TOU  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
      No diagnostics issued in procedure VMD$DI_SUBJECT.
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:319  

 **** Variables and constants ****

  ****  Section 011  Data  VMD$DI_SUBJECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 F_FDS
    36-0-0/d VECT        r     1 VECT_ARRAY(0:2)

  ****  Section 012 RoData VMD$DI_SUBJECT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 SPACE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DCB#                      7-0-0/w PTR         r     1 @PTR$
     3-0-0/w PTR         r     1 @VM_HEADER                *0-0-0/w UBIN        r     1 DCB#
    *0-0-0/w PTR         r     1 PTR$                      *0-0-0/w STRC(1332)  r     1 VM_HEADER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR               1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/w STRC        r     1 E_BLIND_COPY_FMT1
     0-0-0/w STRC        r     1 E_BROADCAST_FMT            0-0-0/w STRC        r     1 E_COPY_FMT1
     0-0-0/w STRC        r     1 E_DEFER_FMT                0-0-0/w STRC        r     1 E_DEFER_FMT1
     0-0-0/w STRC        r     1 E_DR_FMT                   0-0-0/w STRC        r     1 E_FCOPY_FMT
     0-0-0/w STRC        r     1 E_NO_CHAR                  0-0-0/w STRC        r     1 E_OPTS_FMT
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:320  
     0-0-0/w STRC        r     1 E_OPTS_FMT1                0-0-0/w STRC        r     1 E_OPTS_FMT2
     0-0-0/w STRC        r     1 E_REFERENCE_FMT1           0-0-0/w STRC        r     1 E_RR_FMT
     0-0-0/w STRC        r     1 E_RTO_FMT                  0-0-0/w STRC        r     1 E_SIGNED_FMT
     0-0-0/w STRC        r     1 E_SUBJECT_FMT1             0-0-0/w STRC        r     1 E_TO_FMT
     0-0-0/w STRC        r     1 E_YES_CHAR                 0-0-0/w UBIN              1 M$DO_NUM
     0-0-0/w UBIN              1 M$LO_NUM                   0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM
     0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM        0-0-0/w UBIN              1 M$MAIL_FILE_NUM
     0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM          0-0-0/w UBIN              1 M$ME_NUM
     0-0-0/w UBIN              1 M$NODE_NUM                 0-0-0/w UBIN              1 M$SI_NUM
     0-0-0/w UBIN              1 M$WORK_NUM                 0-0-0/w PTR               1 VM_ADDLIST$
     0-0-0/d VECT              1 VM_ADDLIST_                0-0-0/w PTR               1 VM_ADDREC$
     0-0-0/d VECT              1 VM_ADDREC_                 0-0-0/c ASTR(9)     r     1 VM_BLIND_COPY_FMT1
     0-0-0/c ASTR(9)     r     1 VM_BROADCAST_FMT           0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/c ASTR(9)     r     1 VM_COPY_FMT1
     0-0-0/c ASTR(9)     r     1 VM_DEFER_FMT               0-0-0/c ASTR(9)     r     1 VM_DEFER_FMT1
     0-0-0/c ASTR(9)     r     1 VM_DR_FMT                  0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c ASTR(9)     r     1 VM_FCOPY_FMT
     0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME       0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME
     0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS       0-0-0/w PTR               1 VM_HEADER$
     0-0-0/d VECT              1 VM_HEADER_                 0-0-0/d VECT              1 VM_HEADER_INIT_
     0-0-0/w PTR               1 VM_INPUT$                  0-0-0/d VECT              1 VM_INPUT_
     0-0-0/c STRC(72)          1 VM_MAILCG_NAME             0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA
     0-0-0/c STRC(72)          1 VM_MAIL_ACCT               0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME
     0-0-0/w PTR         r     1 VM_NO_OR_YES$(0:1)
     0-0-0/c ASTR(9)     r     1 VM_OPTS_FMT                0-0-0/c ASTR(9)     r     1 VM_OPTS_FMT1
     0-0-0/c ASTR(9)     r     1 VM_OPTS_FMT2               0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/c ASTR(9)     r     1 VM_REFERENCE_FMT1
     0-0-0/c ASTR(9)     r     1 VM_RR_FMT                  0-0-0/c ASTR(9)     r     1 VM_RTO_FMT
     0-0-0/w PTR               1 VM_SELECT$                 0-0-0/d VECT              1 VM_SELECT_
     0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME          0-0-0/c ASTR(9)     r     1 VM_SIGNED_FMT
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/c ASTR(9)     r     1 VM_SUBJECT_FMT1
     0-0-0/c ASTR(9)     r     1 VM_TO_FMT                  0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_                   0-0-0/c ASTR(9)     r     1 VN_NO_CHAR
     0-0-0/c ASTR(9)     r     1 VN_YES_CHAR

PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:321  
  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 BSD                        0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$MAIL_CENTRAL
     0-0-0N  NULL        r     1 M$MAIL_COMGROUP            0-0-0N  NULL        r     1 M$MAIL_FILE
     0-0-0N  NULL        r     1 M$MAIL_GLOBAL              0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$NODE                     0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$WORK
     0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMD$DI_SUBJECT requires 618 words for executable code.
   Procedure VMD$DI_SUBJECT requires 10 words of local(AUTO) storage.
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:322  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:323  
          MINI XREF LISTING

DCB#
      8365**DCL        12--PROC     9491--ENTRY    9522--ENTRY    9553--ENTRY    9584--ENTRY    9615--ENTRY
      9692--ENTRY    9723--ENTRY    9800--ENTRY    9831--ENTRY    9832>>ASSIGN   9890--ENTRY    9891>>ASSIGN
     10034--ENTRY   10112--ENTRY   10199>>ASSIGN
DISPLAY_FIELD
     10186**PROC     9483--CALL     9484--CALL     9515--CALL     9546--CALL     9577--CALL     9608--CALL
      9685--CALL     9716--CALL     9793--CALL     9824--CALL    10105--CALL    10183--CALL
ERRMSG_FID.L#
      8080**DCL      8080--IMP-SIZ
E_BLIND_COPY_FMT1
      8763**DCL      9563<>CALL
E_BROADCAST_FMT
      9303**DCL     10123<>CALL
E_COPY_FMT1
      8718**DCL      9532<>CALL
E_DEFER_FMT
      9033**DCL      9845<>CALL
E_DEFER_FMT1
      9078**DCL      9869<>CALL
E_DR_FMT
      9258**DCL     10045<>CALL
E_FCOPY_FMT
      8853**DCL      9625<>CALL
E_NO_CHAR
      9348**DCL      9648<>CALL     9756<>CALL     9901<>CALL    10068<>CALL    10146<>CALL
E_OPTS_FMT
      9123**DCL      9955<>CALL
E_OPTS_FMT1
      9168**DCL      9982<>CALL
E_OPTS_FMT2
      9213**DCL     10012<>CALL
E_REFERENCE_FMT1
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:324  
      8673**DCL      9594<>CALL
E_RR_FMT
      8943**DCL      9733<>CALL
E_RTO_FMT
      8988**DCL      9810<>CALL
E_SIGNED_FMT
      8898**DCL      9702<>CALL
E_SUBJECT_FMT1
      8628**DCL      9468<>CALL
E_TO_FMT
      8808**DCL      9501<>CALL
E_YES_CHAR
      9393**DCL      9671<>CALL     9779<>CALL     9924<>CALL    10091<>CALL    10169<>CALL
F_FDS
      8382**DCL      9883<>CALL     9997<>CALL    10026<>CALL    10200<>CALL
F_FDS.DCB#
      8415**DCL      9832<<ASSIGN   9891<<ASSIGN  10199<<ASSIGN
F_FDS.FMT_
      8386**DCL      9468<>CALL     9471<<ASSIGN   9501<>CALL     9504<<ASSIGN   9532<>CALL     9535<<ASSIGN
      9563<>CALL     9566<<ASSIGN   9594<>CALL     9597<<ASSIGN   9625<>CALL     9628<<ASSIGN   9702<>CALL
      9705<<ASSIGN   9733<>CALL     9736<<ASSIGN   9810<>CALL     9813<<ASSIGN   9845<>CALL     9848<<ASSIGN
      9869<>CALL     9872<<ASSIGN   9955<>CALL     9958<<ASSIGN   9982<>CALL     9985<<ASSIGN  10012<>CALL
     10015<<ASSIGN  10045<>CALL    10048<<ASSIGN  10123<>CALL    10126<<ASSIGN
F_FDS.NVECS#
      8410**DCL      9945<<ASSIGN   9972<<ASSIGN  10002<<ASSIGN  10027<<ASSIGN
PTR$ IN PROCEDURE DISPLAY_FIELD
     10192**DCL     10186--PROC    10194>>IF      10196>>ASSIGN  10196>>ASSIGN
SPACE
      9430**DCL     10198--ASSIGN
VECT_ARRAY
      8482**DCL      8412--DCLINIT  9833<<ASSIGN   9938<<ASSIGN   9939<<ASSIGN   9940<<ASSIGN   9941<<ASSIGN
      9944<<ASSIGN   9998<<ASSIGN   9999<<ASSIGN  10000<<ASSIGN  10001<<ASSIGN  10196<<ASSIGN  10198<<ASSIGN
VMD$ERRMSG
      9436**DCL-ENT  9468--CALL     9501--CALL     9532--CALL     9563--CALL     9594--CALL     9625--CALL
      9648--CALL     9671--CALL     9702--CALL     9733--CALL     9756--CALL     9779--CALL     9810--CALL
      9845--CALL     9869--CALL     9901--CALL     9924--CALL     9955--CALL     9982--CALL    10012--CALL
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:325  
     10045--CALL    10068--CALL    10091--CALL    10123--CALL    10146--CALL    10169--CALL
VMD$WRITE_BUF
      9432**DCL-ENT  9883--CALL     9997--CALL    10026--CALL    10200--CALL
VM_BLIND_COPY_FMT1
      8515**DCL      9563<>CALL
VM_BLIND_COPY_FMT1.L#
      8515**DCL      8515--IMP-SIZ  9561>>IF       9563>>CALL     9566>>ASSIGN   9566>>ASSIGN
VM_BLIND_COPY_FMT1.NAME#
      8515**DCL      9561>>IF       9566--ASSIGN
VM_BROADCAST_FMT
      8599**DCL     10123<>CALL
VM_BROADCAST_FMT.L#
      8599**DCL      8599--IMP-SIZ 10121>>IF      10123>>CALL    10126>>ASSIGN  10126>>ASSIGN
VM_BROADCAST_FMT.NAME#
      8599**DCL     10121>>IF      10126--ASSIGN
VM_COPY_FMT1
      8508**DCL      9532<>CALL
VM_COPY_FMT1.L#
      8508**DCL      8508--IMP-SIZ  9530>>IF       9532>>CALL     9535>>ASSIGN   9535>>ASSIGN
VM_COPY_FMT1.NAME#
      8508**DCL      9530>>IF       9535--ASSIGN
VM_DEFER_FMT
      8557**DCL      9845<>CALL
VM_DEFER_FMT.L#
      8557**DCL      8557--IMP-SIZ  9843>>IF       9845>>CALL     9848>>ASSIGN   9848>>ASSIGN
VM_DEFER_FMT.NAME#
      8557**DCL      9843>>IF       9848--ASSIGN
VM_DEFER_FMT1
      8564**DCL      9869<>CALL
VM_DEFER_FMT1.L#
      8564**DCL      8564--IMP-SIZ  9867>>IF       9869>>CALL     9872>>ASSIGN   9872>>ASSIGN
VM_DEFER_FMT1.NAME#
      8564**DCL      9867>>IF       9872--ASSIGN
VM_DR_FMT
      8592**DCL     10045<>CALL
VM_DR_FMT.L#
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:326  
      8592**DCL      8592--IMP-SIZ 10043>>IF      10045>>CALL    10048>>ASSIGN  10048>>ASSIGN
VM_DR_FMT.NAME#
      8592**DCL     10043>>IF      10048--ASSIGN
VM_FCOPY_FMT
      8529**DCL      9625<>CALL
VM_FCOPY_FMT.L#
      8529**DCL      8529--IMP-SIZ  9623>>IF       9625>>CALL     9628>>ASSIGN   9628>>ASSIGN
VM_FCOPY_FMT.NAME#
      8529**DCL      9623>>IF       9628--ASSIGN
VM_HEADER
      8246**DCL        12--PROC     9491--ENTRY    9522--ENTRY    9553--ENTRY    9584--ENTRY    9615--ENTRY
      9692--ENTRY    9723--ENTRY    9800--ENTRY    9831--ENTRY    9890--ENTRY   10034--ENTRY   10112--ENTRY
VM_HEADER.BLIND$
      8332**DCL      9577<>CALL
VM_HEADER.COPY$
      8334**DCL      9546<>CALL
VM_HEADER.DELIVERY_DATE
      8251**DCL      9833--ASSIGN   9834>>IF       9942>>IF       9944--ASSIGN
VM_HEADER.REFERENCE$
      8340**DCL      9484<>CALL     9608<>CALL
VM_HEADER.REPLY_TO$
      8342**DCL      9824<>CALL
VM_HEADER.SIGNED$
      8346**DCL      9716<>CALL
VM_HEADER.STATUS.BROADCAST
      8297**DCL     10000>>ASSIGN  10183>>CALL
VM_HEADER.STATUS.DR
      8293**DCL      9940>>ASSIGN  10105>>CALL
VM_HEADER.STATUS.FCOPY
      8283**DCL      9685>>CALL    10001>>ASSIGN
VM_HEADER.STATUS.RR
      8269**DCL      9793>>CALL     9941>>ASSIGN
VM_HEADER.SUBJECT$
      8348**DCL      9482>>IF       9483<>CALL
VM_HEADER.TO$
      8350**DCL      9515<>CALL
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:327  
VM_NO_OR_YES$
      8484**DCL      9685<>CALL     9793<>CALL     9940>>ASSIGN   9941>>ASSIGN  10000>>ASSIGN  10001>>ASSIGN
     10105<>CALL    10183<>CALL
VM_OPTS_FMT
      8571**DCL      9955<>CALL
VM_OPTS_FMT.L#
      8571**DCL      8571--IMP-SIZ  9953>>IF       9955>>CALL     9958>>ASSIGN   9958>>ASSIGN
VM_OPTS_FMT.NAME#
      8571**DCL      9953>>IF       9958--ASSIGN
VM_OPTS_FMT1
      8578**DCL      9982<>CALL
VM_OPTS_FMT1.L#
      8578**DCL      8578--IMP-SIZ  9980>>IF       9982>>CALL     9985>>ASSIGN   9985>>ASSIGN
VM_OPTS_FMT1.NAME#
      8578**DCL      9980>>IF       9985--ASSIGN
VM_OPTS_FMT2
      8585**DCL     10012<>CALL
VM_OPTS_FMT2.L#
      8585**DCL      8585--IMP-SIZ 10010>>IF      10012>>CALL    10015>>ASSIGN  10015>>ASSIGN
VM_OPTS_FMT2.NAME#
      8585**DCL     10010>>IF      10015--ASSIGN
VM_REFERENCE_FMT1
      8501**DCL      9594<>CALL
VM_REFERENCE_FMT1.L#
      8501**DCL      8501--IMP-SIZ  9592>>IF       9594>>CALL     9597>>ASSIGN   9597>>ASSIGN
VM_REFERENCE_FMT1.NAME#
      8501**DCL      9592>>IF       9597--ASSIGN
VM_RR_FMT
      8543**DCL      9733<>CALL
VM_RR_FMT.L#
      8543**DCL      8543--IMP-SIZ  9731>>IF       9733>>CALL     9736>>ASSIGN   9736>>ASSIGN
VM_RR_FMT.NAME#
      8543**DCL      9731>>IF       9736--ASSIGN
VM_RTO_FMT
      8550**DCL      9810<>CALL
VM_RTO_FMT.L#
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:328  
      8550**DCL      8550--IMP-SIZ  9808>>IF       9810>>CALL     9813>>ASSIGN   9813>>ASSIGN
VM_RTO_FMT.NAME#
      8550**DCL      9808>>IF       9813--ASSIGN
VM_SIGNED_FMT
      8536**DCL      9702<>CALL
VM_SIGNED_FMT.L#
      8536**DCL      8536--IMP-SIZ  9700>>IF       9702>>CALL     9705>>ASSIGN   9705>>ASSIGN
VM_SIGNED_FMT.NAME#
      8536**DCL      9700>>IF       9705--ASSIGN
VM_SUBJECT_FMT1
      8494**DCL      9468<>CALL
VM_SUBJECT_FMT1.L#
      8494**DCL      8494--IMP-SIZ  9466>>IF       9468>>CALL     9471>>ASSIGN   9471>>ASSIGN
VM_SUBJECT_FMT1.NAME#
      8494**DCL      9466>>IF       9471--ASSIGN
VM_TO_FMT
      8522**DCL      9501<>CALL
VM_TO_FMT.L#
      8522**DCL      8522--IMP-SIZ  9499>>IF       9501>>CALL     9504>>ASSIGN   9504>>ASSIGN
VM_TO_FMT.NAME#
      8522**DCL      9499>>IF       9504--ASSIGN
VN_NO_CHAR
      8606**DCL      9648<>CALL     9756<>CALL     9901<>CALL    10068<>CALL    10146<>CALL
VN_NO_CHAR.L#
      8606**DCL      8606--IMP-SIZ  9646>>IF       9648>>CALL     9754>>IF       9756>>CALL     9899>>IF
      9901>>CALL    10066>>IF      10068>>CALL    10144>>IF      10146>>CALL
VN_NO_CHAR.NAME#
      8606**DCL      9646>>IF       9754>>IF       9899>>IF      10066>>IF      10144>>IF
VN_YES_CHAR
      8613**DCL      9671<>CALL     9779<>CALL     9924<>CALL    10091<>CALL    10169<>CALL
VN_YES_CHAR.L#
      8613**DCL      8613--IMP-SIZ  9669>>IF       9671>>CALL     9777>>IF       9779>>CALL     9922>>IF
      9924>>CALL     9938>>ASSIGN   9939>>ASSIGN   9998>>ASSIGN   9999>>ASSIGN  10089>>IF      10091>>CALL
     10167>>IF      10169>>CALL
VN_YES_CHAR.NAME#
      8613**DCL      9669>>IF       9777>>IF       9922>>IF       9938--ASSIGN   9939--ASSIGN   9998--ASSIGN
PL6.E3A0      #003=VMD$DI_SUBJECT File=VMD$DISPLAY.:VMB6TSI                      WED 08/20/97 15:09 Page:329  
      9999--ASSIGN  10089>>IF      10167>>IF
X$STRING.SIZ
      7926**DCL      7927--IMP-SIZ 10196>>ASSIGN
X$STRING.TEXT
      7927**DCL     10196--ASSIGN

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:330  
     1722        1        /*T***********************************************************/
     1723        2        /*T*                                                         */
     1724        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1725        4        /*T*                                                         */
     1726        5        /*T***********************************************************/
     1727        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
     1728        7        /*P*
     1729        8            NAME: VMD$WRITE_BUF
     1730        9            PURPOSE:
     1731       10                  To perform the write for all calls to X$FORMAT.
     1732       11            DESCRIPTION:
     1733       12                  Primary function is to catch and report errors.
     1734       13        */
     1735       14        VMD$WRITE_BUF: PROC (F_FDS);
     1736       15        /***** Include files *****/
     1737       16        %INCLUDE CP_6;
     1738     5575        %INCLUDE CP_6_SUBS;
     1739     6115        %INCLUDE XU_FORMAT_C;
     1740     6277        %INCLUDE VM_DATA_R;
     1741     6708        /***** Parameters *****/
     1742     6709        %F_FDS (STCLASS=" ");
     1743     6822        /***** Fpts *****/
     1744     6823              %FPT_WRITE (FPTN=WRITE_BUF,STCLASS=STATIC);
     1745     6854        %F$DCB;
     1746     6911        /***** Local variables *****/
     1747     6912    1   DCL DISPLAY_BUF CHAR(512) STATIC;
     1748     6913    1   DCL HOLD_DCB# UBIN WORD STATIC;
     1749     6914    1   DCL TRUNCATE BIT (1);
     1750     6915    1   DCL WIDTH UBIN;
     1751     6916        /***** Based structures *****/
     1752     6917        %B$TCB (STCLASS="BASED(B$TCB$)");
     1753     6920        %B$ALT;
     1754     6928        /***** External routines *****/
     1755     6929    1   DCL X$FORMAT ENTRY(1);
     1756     6930    1   DCL VMA$ERRMSG ENTRY(5);
     1757     6931        %EJECT;
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:331  
     1758     6932    1       TRUNCATE = %NO#;
     1759     6933    1       GOTO FORMATTER;
     1760     6934
     1761     6935    1   VMD$WRITE_BUF_TRUNCATED: ENTRY (F_FDS);
     1762     6936
     1763     6937        /*D*  ENTRY:   VMD$WRITE_BUF_TRUNCATED
     1764     6938              DESCRIPTION: Identical to VMD$WRITE_BUF, save that if the output buffer
     1765     6939                 string is longer than the width of the output DCB's platen it is
     1766     6940                 truncated.
     1767     6941        */
     1768     6942
     1769     6943    1       TRUNCATE = %YES#;
     1770     6944
     1771     6945    1   FORMATTER:
     1772     6946
     1773     6947    1       IF DCBADDR(F_FDS.DCB#) -> F$DCB.WIDTH# > 0
     1774     6948    1       THEN
     1775     6949    1           WIDTH = MINIMUM(MAXIMUM(DCBADDR(F_FDS.DCB#) -> F$DCB.WIDTH#, 40),
     1776     6950    1             LENGTHC(DISPLAY_BUF));
     1777     6951    1       ELSE
     1778     6952    1           WIDTH = 255;
     1779     6953        /*
     1780     6954             ***** Remember the DCB# to write thru.
     1781     6955                   Do not let X$FORMAT do the write ...
     1782     6956        */
     1783     6957    1       HOLD_DCB# = F_FDS.DCB#;
     1784     6958    1       F_FDS.DCB# = 0;
     1785     6959        /*
     1786     6960             ***** Format the buffer ...
     1787     6961        */
     1788     6962    1       F_FDS.BUF_ = VECTOR(DISPLAY_BUF);
     1789     6963    1       CALL X$FORMAT (F_FDS);
     1790     6964        /*
     1791     6965             ***** Strip vfc ???
     1792     6966        */
     1793     6967    1       IF SUBSTR (DISPLAY_BUF,0,1) = 'A'
     1794     6968    2       THEN DO;
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:332  
     1795     6969    2           F_FDS.BUFX = F_FDS.BUFX - 1;
     1796     6970    2           WRITE_BUF.BUF_ = VECTOR(SUBSTR(DISPLAY_BUF,1,F_FDS.BUFX));
     1797     6971    2           WRITE_BUF.V.DVBYTE.VFC# = %NO#;
     1798     6972    2       END;
     1799     6973    2       ELSE DO;
     1800     6974    2           WIDTH = WIDTH + 1; /* allow for VFC */
     1801     6975    2           WRITE_BUF.BUF_ = VECTOR(SUBSTR(DISPLAY_BUF,0,F_FDS.BUFX));
     1802     6976    2           WRITE_BUF.V.DVBYTE.VFC# = %YES#;
     1803     6977    2       END;
     1804     6978        /*
     1805     6979             ***** If the buffer is to be truncated to the output device's width,
     1806     6980                   then clip the size in the fds appropriately.
     1807     6981        */
     1808     6982    1       IF TRUNCATE AND F_FDS.BUFX > WIDTH
     1809     6983    1       THEN
     1810     6984    1           WRITE_BUF.BUF_.BOUND = WIDTH - 1;
     1811     6985        /*
     1812     6986             ***** Write the buffer ...
     1813     6987        */
     1814     6988    1       WRITE_BUF.V.DCB# = HOLD_DCB#;
     1815     6989    1       F_FDS.DCB# = HOLD_DCB#;           /* Replace the DCB# for later use */
     1816     6990    1       CALL M$WRITE (WRITE_BUF) ALTRET(E_WRITE);
     1817     6991    1       RETURN;
     1818     6992        /**/
     1819     6993    1   E_WRITE:
     1820     6994    1       CALL VMA$ERRMSG (B$TCB.ALT$->B$ALT.ERR, B$TCB.ALT$->B$ALT.DCB#);
     1821     6995    1       RETURN;
     1822     6996    1   END VMD$WRITE_BUF;

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:333  
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMD$WRITE_BUF.

   Procedure VMD$WRITE_BUF requires 100 words for executable code.
   Procedure VMD$WRITE_BUF requires 8 words of local(AUTO) storage.

    No errors detected in file VMD$DISPLAY.:VMB6TSI    .

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:334  

 Object Unit name= VMD$WRITE_BUF                              File name= VMD$DISPLAY.:VMB6TOU
 UTS= AUG 20 '97 15:10:07.72 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$MAIL_FILE
    2   DCB   even  none     0      0  M$MAIL_CENTRAL
    3   DCB   even  none     0      0  M$MAIL_GLOBAL
    4   DCB   even  none     0      0  M$WORK
    5   DCB   even  none     0      0  M$MAIL_COMGROUP
    6   DCB   even  none     0      0  M$DO
    7   DCB   even  none     0      0  M$LO
    8   DCB   even  none     0      0  M$ME
    9   DCB   even  none     0      0  M$NODE
   10   DCB   even  none     0      0  M$SI
   11   Data  even  none   141    215  VMD$WRITE_BUF
   12   Proc  even  none   100    144  VMD$WRITE_BUF
   13  RoData even  none     9     11  VMD$WRITE_BUF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    12      0   yes            yes      Std        1  VMD$WRITE_BUF
    12      4                  yes      Std        1  VMD$WRITE_BUF_TRUNCATED
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:335  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 X$FORMAT
         yes           Std       5 VMA$ERRMSG
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    VM_HEADER$                       r    VM_PROFILE$
r    VM_ADDLIST$                      r    VM_ADDREC$                       r    VM_WORK$
r    VM_SELECT$                       r    VM_PARSEAREA$                    r    VM_INPUT$
r    VM_COPY$                              VM_ENCLLIST$                          VM_ENCLREC$
     VM_HEADER_                            VM_HEADER_INIT_                       VM_PROFILE_
     VM_ADDLIST_                           VM_ADDREC_                            VM_WORK_
     VM_SELECT_                            VM_PARSEAREA_                         VM_INPUT_
     VM_COPY_                              VM_ENCLLIST_                          VM_ENCLREC_
     M$MAIL_FILE                           M$MAIL_CENTRAL                        M$MAIL_GLOBAL
     M$WORK                                M$MAIL_COMGROUP                       M$DO
     M$LO                                  M$ME                                  M$NODE
     M$SI                                  M$MAIL_FILE_NUM                       M$MAIL_CENTRAL_NUM
     M$MAIL_GLOBAL_NUM                     M$WORK_NUM                            M$MAIL_COMGROUP_NUM
     M$DO_NUM                              M$ME_NUM                              M$LO_NUM
     M$SI_NUM                              M$NODE_NUM                       r    B$JIT$
r    B$TCB$                                VM_MAIL_ACCT                          VM_NAME_MAP_NAME
     ERRMSG_FID                            VM_SEND_FILE_NAME                     VM_FORWARD_FILE_NAME
     VM_FORWARD_ENCL_NAME                  VM_FORWARD_FILE_PASS                  VM_MAILCG_NAME
     VM_SITENAME                           VM_MAILCG_SETSTA
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:336  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:337  


     1722        1        /*T***********************************************************/
     1723        2        /*T*                                                         */
     1724        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1725        4        /*T*                                                         */
     1726        5        /*T***********************************************************/
     1727        6        /*X* DMC,PLM=4,IND=4,CTI=2,DTI=0,ENI=0,ECI=0,CSI=0,DCI=4 */
     1728        7        /*P*
     1729        8            NAME: VMD$WRITE_BUF
     1730        9            PURPOSE:
     1731       10                  To perform the write for all calls to X$FORMAT.
     1732       11            DESCRIPTION:
     1733       12                  Primary function is to catch and report errors.
     1734       13        */
     1735       14        VMD$WRITE_BUF: PROC (F_FDS);

     14 12 000000   000000 700200 xent  VMD$WRITE_B* TSX0  ! X66_AUTO_1
        12 000001   000010 000001                    ZERO    8,1

     1736       15        /***** Include files *****/
     1737       16        %INCLUDE CP_6;
     1738     5575        %INCLUDE CP_6_SUBS;
     1739     6115        %INCLUDE XU_FORMAT_C;
     1740     6277        %INCLUDE VM_DATA_R;
     1741     6708        /***** Parameters *****/
     1742     6709        %F_FDS (STCLASS=" ");
     1743     6822        /***** Fpts *****/
     1744     6823              %FPT_WRITE (FPTN=WRITE_BUF,STCLASS=STATIC);
     1745     6854        %F$DCB;
     1746     6911        /***** Local variables *****/
     1747     6912    1   DCL DISPLAY_BUF CHAR(512) STATIC;
     1748     6913    1   DCL HOLD_DCB# UBIN WORD STATIC;
     1749     6914    1   DCL TRUNCATE BIT (1);
     1750     6915    1   DCL WIDTH UBIN;
     1751     6916        /***** Based structures *****/
     1752     6917        %B$TCB (STCLASS="BASED(B$TCB$)");
     1753     6920        %B$ALT;
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:338  
     1754     6928        /***** External routines *****/
     1755     6929    1   DCL X$FORMAT ENTRY(1);
     1756     6930    1   DCL VMA$ERRMSG ENTRY(5);
     1757     6931        %EJECT;
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:339  
     1758     6932    1       TRUNCATE = %NO#;

   6932 12 000002   200004 450100                    STZ     TRUNCATE,,AUTO

     1759     6933    1       GOTO FORMATTER;

   6933 12 000003   000010 710000 12                 TRA     FORMATTER

     1760     6934
     1761     6935    1   VMD$WRITE_BUF_TRUNCATED: ENTRY (F_FDS);

   6935 12 000004   000000 700200 xent  VMD$WRITE_B* TSX0  ! X66_AUTO_1
        12 000005   000010 000001                    ZERO    8,1

     1762     6936
     1763     6937        /*D*  ENTRY:   VMD$WRITE_BUF_TRUNCATED
     1764     6938              DESCRIPTION: Identical to VMD$WRITE_BUF, save that if the output buffer
     1765     6939                 string is longer than the width of the output DCB's platen it is
     1766     6940                 truncated.
     1767     6941        */
     1768     6942
     1769     6943    1       TRUNCATE = %YES#;

   6943 12 000006   400000 236003                    LDQ     -131072,DU
        12 000007   200004 756100                    STQ     TRUNCATE,,AUTO

     1770     6944
     1771     6945    1   FORMATTER:
     1772     6946
     1773     6947    1       IF DCBADDR(F_FDS.DCB#) -> F$DCB.WIDTH# > 0

   6947 12 000010   000000 470400 13    FORMATTER    LDP0    0
        12 000011   000000 471500                    LDP1    0,,PR0
        12 000012   200003 473500                    LDP3    @F_FDS,,AUTO
        12 000013   300013 220100                    LDX0    11,,PR3
        12 000014   100000 474510                    LDP4    0,X0,PR1
        12 000015   400004 236100                    LDQ     4,,PR4
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:340  
        12 000016   000777 316007                    CANQ    511,DL
        12 000017   000033 600000 12                 TZE     s:6952

     1774     6948    1       THEN
     1775     6949    1           WIDTH = MINIMUM(MAXIMUM(DCBADDR(F_FDS.DCB#) -> F$DCB.WIDTH#, 40),

   6949 12 000020   400004 236100                    LDQ     4,,PR4
        12 000021   000777 376007                    ANQ     511,DL
        12 000022   000050 116007                    CMPQ    40,DL
        12 000023   000025 603000 12                 TRC     s:6949+5
        12 000024   000050 236007                    LDQ     40,DL
        12 000025   001000 116007                    CMPQ    512,DL
        12 000026   000031 602000 12                 TNC     s:6949+9
        12 000027   000031 600000 12                 TZE     s:6949+9
        12 000030   001000 236007                    LDQ     512,DL
        12 000031   200005 756100                    STQ     WIDTH,,AUTO
        12 000032   000035 710000 12                 TRA     s:6957

     1776     6950    1             LENGTHC(DISPLAY_BUF));
     1777     6951    1       ELSE
     1778     6952    1           WIDTH = 255;

   6952 12 000033   000377 235007                    LDA     255,DL
        12 000034   200005 755100                    STA     WIDTH,,AUTO

     1779     6953        /*
     1780     6954             ***** Remember the DCB# to write thru.
     1781     6955                   Do not let X$FORMAT do the write ...
     1782     6956        */
     1783     6957    1       HOLD_DCB# = F_FDS.DCB#;

   6957 12 000035   300013 236100                    LDQ     11,,PR3
        12 000036   000022 732000                    QRS     18
        12 000037   000214 756000 11                 STQ     HOLD_DCB#

     1784     6958    1       F_FDS.DCB# = 0;

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:341  
   6958 12 000040   000000 221003                    LDX1    0,DU
        12 000041   300013 741100                    STX1    11,,PR3

     1785     6959        /*
     1786     6960             ***** Format the buffer ...
     1787     6961        */
     1788     6962    1       F_FDS.BUF_ = VECTOR(DISPLAY_BUF);

   6962 12 000042   000002 237000 13                 LDAQ    2
        12 000043   300005 755100                    STA     5,,PR3
        12 000044   300006 756100                    STQ     6,,PR3

     1789     6963    1       CALL X$FORMAT (F_FDS);

   6963 12 000045   200003 630500                    EPPR0   @F_FDS,,AUTO
        12 000046   000004 631400 13                 EPPR1   4
        12 000047   000000 701000 xent               TSX1    X$FORMAT
        12 000050   000000 011000                    NOP     0

     1790     6964        /*
     1791     6965             ***** Strip vfc ???
     1792     6966        */
     1793     6967    1       IF SUBSTR (DISPLAY_BUF,0,1) = 'A'

   6967 12 000051   000014 236000 11                 LDQ     DISPLAY_BUF
        12 000052   777000 376003                    ANQ     -512,DU
        12 000053   101000 116003                    CMPQ    33280,DU
        12 000054   000071 601000 12                 TNZ     s:6974

     1794     6968    2       THEN DO;

     1795     6969    2           F_FDS.BUFX = F_FDS.BUFX - 1;

   6969 12 000055   200003 470500                    LDP0    @F_FDS,,AUTO
        12 000056   000001 336007                    LCQ     1,DL
        12 000057   000007 056100                    ASQ     7,,PR0

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:342  
     1796     6970    2           WRITE_BUF.BUF_ = VECTOR(SUBSTR(DISPLAY_BUF,1,F_FDS.BUFX));

   6970 12 000060   000007 720100                    LXL0    7,,PR0
        12 000061   000000 635010                    EAA     0,X0
        12 000062   000002 771000                    ARL     2
        12 000063   000140 135007                    SBLA    96,DL
        12 000064   000005 236000 13                 LDQ     5
        12 000065   000004 757000 11                 STAQ    WRITE_BUF+4

     1797     6971    2           WRITE_BUF.V.DVBYTE.VFC# = %NO#;

   6971 12 000066   000006 236000 13                 LDQ     6
        12 000067   000013 356000 11                 ANSQ    WRITE_BUF+11

     1798     6972    2       END;

   6972 12 000070   000106 710000 12                 TRA     s:6982

     1799     6973    2       ELSE DO;

     1800     6974    2           WIDTH = WIDTH + 1; /* allow for VFC */

   6974 12 000071   200005 235100                    LDA     WIDTH,,AUTO
        12 000072   000001 035007                    ADLA    1,DL
        12 000073   200005 755100                    STA     WIDTH,,AUTO

     1801     6975    2           WRITE_BUF.BUF_ = VECTOR(SUBSTR(DISPLAY_BUF,0,F_FDS.BUFX));

   6975 12 000074   200003 470500                    LDP0    @F_FDS,,AUTO
        12 000075   000007 720100                    LXL0    7,,PR0
        12 000076   000000 636010                    EAQ     0,X0
        12 000077   000022 772000                    QRL     18
        12 000100   000064 737000                    LLS     52
        12 000101   000140 135007                    SBLA    96,DL
        12 000102   000003 236000 13                 LDQ     3
        12 000103   000004 757000 11                 STAQ    WRITE_BUF+4

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:343  
     1802     6976    2           WRITE_BUF.V.DVBYTE.VFC# = %YES#;

   6976 12 000104   100000 236003                    LDQ     32768,DU
        12 000105   000013 256000 11                 ORSQ    WRITE_BUF+11

     1803     6977    2       END;

     1804     6978        /*
     1805     6979             ***** If the buffer is to be truncated to the output device's width,
     1806     6980                   then clip the size in the fds appropriately.
     1807     6981        */
     1808     6982    1       IF TRUNCATE AND F_FDS.BUFX > WIDTH

   6982 12 000106   200004 234100                    SZN     TRUNCATE,,AUTO
        12 000107   000121 605000 12                 TPL     s:6988
        12 000110   200005 236100                    LDQ     WIDTH,,AUTO
        12 000111   000121 604000 12                 TMI     s:6988
        12 000112   000007 116100                    CMPQ    7,,PR0
        12 000113   000121 605000 12                 TPL     s:6988

     1809     6983    1       THEN
     1810     6984    1           WRITE_BUF.BUF_.BOUND = WIDTH - 1;

   6984 12 000114   000001 136007                    SBLQ    1,DL
        12 000115   000020 736000                    QLS     16
        12 000116   000004 676000 11                 ERQ     WRITE_BUF+4
        12 000117   000007 376000 13                 ANQ     7
        12 000120   000004 656000 11                 ERSQ    WRITE_BUF+4

     1811     6985        /*
     1812     6986             ***** Write the buffer ...
     1813     6987        */
     1814     6988    1       WRITE_BUF.V.DCB# = HOLD_DCB#;

   6988 12 000121   000214 720000 11                 LXL0    HOLD_DCB#
        12 000122   000010 740000 11                 STX0    WRITE_BUF+8

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:344  
     1815     6989    1       F_FDS.DCB# = HOLD_DCB#;           /* Replace the DCB# for later use */

   6989 12 000123   000013 740100                    STX0    11,,PR0

     1816     6990    1       CALL M$WRITE (WRITE_BUF) ALTRET(E_WRITE);

   6990 12 000124   000000 630400 11                 EPPR0   WRITE_BUF
        12 000125   440001 713400                    CLIMB   alt,write
        12 000126   401400 401760                    pmme    nvectors=4
        12 000127   000131 702000 12                 TSX2    E_WRITE

     1817     6991    1       RETURN;

   6991 12 000130   000000 702200 xent               TSX2  ! X66_ARET

     1818     6992        /**/
     1819     6993    1   E_WRITE:
     1820     6994    1       CALL VMA$ERRMSG (B$TCB.ALT$->B$ALT.ERR, B$TCB.ALT$->B$ALT.DCB#);

   6994 12 000131   000000 470400 xsym  E_WRITE      LDP0    B$TCB$
        12 000132   000000 471500                    LDP1    0,,PR0
        12 000133   100101 633500                    EPPR3   65,,PR1
        12 000134   200007 453500                    STP3    WIDTH+2,,AUTO
        12 000135   100102 634500                    EPPR4   66,,PR1
        12 000136   200006 454500                    STP4    WIDTH+1,,AUTO
        12 000137   200006 630500                    EPPR0   WIDTH+1,,AUTO
        12 000140   000010 631400 13                 EPPR1   8
        12 000141   000000 701000 xent               TSX1    VMA$ERRMSG
        12 000142   000000 011000                    NOP     0

     1821     6995    1       RETURN;

   6995 12 000143   000000 702200 xent               TSX2  ! X66_ARET

WRITE_BUF
 Sect OctLoc
  11     000   000003 777640   000010 006000   000000 177640   000000 006014    ................
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:345  
  11     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
  11     010   000000 400400   000000 000000   000000 000000   000000 000000    ................

DISPLAY_BUF
 Sect OctLoc
  11     014   ****** ******   ****** ******   ****** ******   ****** ******    ................

(unnamed)
 Sect OctLoc
  13     000   000000 006003   000000 000000   000177 777640   000014 006000    ................
  13     004   000001 000000   000014 206000   677777 777777   777777 600000    ................
  13     010   000002 000000                                                    ....
     1822     6996    1   END VMD$WRITE_BUF;

PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:346  
--  Include file information  --

   B_MACROS_C.:LIB_E05  is referenced.
   VM_DATA_R.:VMB6TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VMD$WRITE_BUF.
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:347  

 **** Variables and constants ****

  ****  Section 011  Data  VMD$WRITE_BUF

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/c CHAR(512)   r     1 DISPLAY_BUF              214-0-0/w UBIN        r     1 HOLD_DCB#
     0-0-0/d STRC(432)   r     1 WRITE_BUF

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @F_FDS                    *0-0-0/w STRC(1080)  r     1 F_FDS
     4-0-0/b BIT         r     1 TRUNCATE                   5-0-0/w UBIN        r     1 WIDTH

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c ASTR(9)     r     1 ERRMSG_FID                 0-0-0/w UBIN              1 M$DO_NUM
     0-0-0/w UBIN              1 M$LO_NUM                   0-0-0/w UBIN              1 M$MAIL_CENTRAL_NUM
     0-0-0/w UBIN              1 M$MAIL_COMGROUP_NUM        0-0-0/w UBIN              1 M$MAIL_FILE_NUM
     0-0-0/w UBIN              1 M$MAIL_GLOBAL_NUM          0-0-0/w UBIN              1 M$ME_NUM
     0-0-0/w UBIN              1 M$NODE_NUM                 0-0-0/w UBIN              1 M$SI_NUM
     0-0-0/w UBIN              1 M$WORK_NUM                 0-0-0/w PTR               1 VM_ADDLIST$
     0-0-0/d VECT              1 VM_ADDLIST_                0-0-0/w PTR               1 VM_ADDREC$
     0-0-0/d VECT              1 VM_ADDREC_                 0-0-0/w PTR               1 VM_COPY$
     0-0-0/d VECT              1 VM_COPY_                   0-0-0/w PTR               1 VM_ENCLLIST$
     0-0-0/d VECT              1 VM_ENCLLIST_               0-0-0/w PTR               1 VM_ENCLREC$
     0-0-0/d VECT              1 VM_ENCLREC_                0-0-0/c STRC(270)         1 VM_FORWARD_ENCL_NAME
     0-0-0/c STRC(270)         1 VM_FORWARD_FILE_NAME       0-0-0/c STRC(72)          1 VM_FORWARD_FILE_PASS
     0-0-0/w PTR               1 VM_HEADER$                 0-0-0/d VECT              1 VM_HEADER_
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:348  
     0-0-0/d VECT              1 VM_HEADER_INIT_            0-0-0/w PTR               1 VM_INPUT$
     0-0-0/d VECT              1 VM_INPUT_                  0-0-0/c STRC(72)          1 VM_MAILCG_NAME
     0-0-0/w STRC(432)         1 VM_MAILCG_SETSTA           0-0-0/c STRC(72)          1 VM_MAIL_ACCT
     0-0-0/c STRC(54)          1 VM_NAME_MAP_NAME           0-0-0/w PTR               1 VM_PARSEAREA$
     0-0-0/d VECT              1 VM_PARSEAREA_              0-0-0/w PTR               1 VM_PROFILE$
     0-0-0/d VECT              1 VM_PROFILE_                0-0-0/w PTR               1 VM_SELECT$
     0-0-0/d VECT              1 VM_SELECT_                 0-0-0/c STRC(288)         1 VM_SEND_FILE_NAME
     0-0-0/c CHAR(8)           1 VM_SITENAME                0-0-0/w PTR               1 VM_WORK$
     0-0-0/d VECT              1 VM_WORK_

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0N  NULL        r     1 M$DO
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$MAIL_CENTRAL
     0-0-0N  NULL        r     1 M$MAIL_COMGROUP            0-0-0N  NULL        r     1 M$MAIL_FILE
     0-0-0N  NULL        r     1 M$MAIL_GLOBAL              0-0-0N  NULL        r     1 M$ME
     0-0-0N  NULL        r     1 M$NODE                     0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$UC                       0-0-0N  NULL        r     1 M$WORK
     0-0-0/c ASTR(9)     r     1 X$STRING


   Procedure VMD$WRITE_BUF requires 100 words for executable code.
   Procedure VMD$WRITE_BUF requires 8 words of local(AUTO) storage.

    No errors detected in file VMD$DISPLAY.:VMB6TSI    .
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:349  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:350  
          MINI XREF LISTING

B$ALT.CODE
      6922**DCL      6922--REDEF    6923--REDEF    6923--REDEF
B$ALT.DCB#
      6923**DCL      6994<>CALL
B$ALT.ERR
      6923**DCL      6994<>CALL
B$ALT.ERR.ERR#
      6924**DCL      6924--REDEF
B$ALT.EVID
      6923**DCL      6923--REDEF    6923--REDEF
B$TCB.ALT$
      6918**DCL      6994>>CALL     6994>>CALL
B$TCB$
      6485**DCL      6918--IMP-PTR  6994>>CALL     6994>>CALL
DISPLAY_BUF
      6912**DCL      6949--ASSIGN   6962--ASSIGN   6967>>IF       6970--ASSIGN   6975--ASSIGN
ERRMSG_FID.L#
      6553**DCL      6553--IMP-SIZ
E_WRITE
      6994**LABEL    6990--CALLALT
F$DCB.ACTPOS
      6887**DCL      6887--REDEF
F$DCB.ARS#
      6861**DCL      6861--REDEF
F$DCB.ATTR
      6880**DCL      6881--REDEF
F$DCB.BORROW
      6895**DCL      6895--REDEF    6895--REDEF    6895--REDEF
F$DCB.DCBNAME.L
      6909**DCL      6909--IMP-SIZ
F$DCB.EOMCHAR#
      6865**DCL      6865--REDEF
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:351  
F$DCB.FLDID
      6890**DCL      6890--REDEF
F$DCB.FORM$
      6884**DCL      6884--REDEF
F$DCB.FSECT
      6900**DCL      6900--REDEF
F$DCB.FSN#
      6877**DCL      6877--REDEF    6877--REDEF    6878--REDEF
F$DCB.HEADER$
      6883**DCL      6883--REDEF
F$DCB.IXTNSIZE#
      6881**DCL      6881--REDEF
F$DCB.LASTSTA$
      6870**DCL      6870--REDEF
F$DCB.LVL
      6896**DCL      6896--REDEF
F$DCB.NAME#.C
      6871**DCL      6871--REDEF
F$DCB.NOEOF
      6893**DCL      6893--REDEF
F$DCB.NRECS#
      6882**DCL      6882--REDEF
F$DCB.NRECX
      6901**DCL      6901--REDEF
F$DCB.OHDR
      6893**DCL      6893--REDEF
F$DCB.ORG#
      6876**DCL      6876--REDEF
F$DCB.PRECNO
      6899**DCL      6899--REDEF
F$DCB.RCSZ
      6905**DCL      6905--REDEF
F$DCB.RES#
      6872**DCL      6872--REDEF
F$DCB.SETX
      6884**DCL      6884--REDEF
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:352  
F$DCB.TAB$
      6884**DCL      6884--REDEF
F$DCB.TDA
      6898**DCL      6899--REDEF
F$DCB.WIDTH#
      6868**DCL      6947>>IF       6949>>ASSIGN
F$DCB.WSN#
      6872**DCL      6872--REDEF
FORMATTER
      6947**LABEL    6933--GOTO
F_FDS
      6723**DCL        14--PROC     6935--ENTRY    6963<>CALL
F_FDS.BUFX
      6747**DCL      6969<<ASSIGN   6969>>ASSIGN   6970>>ASSIGN   6975>>ASSIGN   6982>>IF
F_FDS.BUF_
      6740**DCL      6962<<ASSIGN
F_FDS.DCB#
      6756**DCL      6947--IF       6949--ASSIGN   6957>>ASSIGN   6958<<ASSIGN   6989<<ASSIGN
HOLD_DCB#
      6913**DCL      6957<<ASSIGN   6988>>ASSIGN   6989>>ASSIGN
M$WRITE
      5504**DCL-ENT  6990--CALL
TRUNCATE
      6914**DCL      6932<<ASSIGN   6943<<ASSIGN   6982>>IF
VMA$ERRMSG
      6930**DCL-ENT  6994--CALL
WIDTH
      6915**DCL      6949<<ASSIGN   6952<<ASSIGN   6974<<ASSIGN   6974>>ASSIGN   6982>>IF       6984>>ASSIGN
WRITE_BUF
      6840**DCL      6990<>CALL
WRITE_BUF.BUF_
      6840**DCL      6970<<ASSIGN   6975<<ASSIGN
WRITE_BUF.BUF_.BOUND
      6840**DCL      6984<<ASSIGN
WRITE_BUF.STATION_
      6842**DCL      6842--REDEF
PL6.E3A0      #004=VMD$WRITE_BUF File=VMD$DISPLAY.:VMB6TSI                       WED 08/20/97 15:10 Page:353  
WRITE_BUF.V
      6843**DCL      6840--DCLINIT
WRITE_BUF.V.DCB#
      6843**DCL      6988<<ASSIGN
WRITE_BUF.V.DVBYTE.VFC#
      6849**DCL      6849--REDEF    6971<<ASSIGN   6976<<ASSIGN
X$FORMAT
      6929**DCL-ENT  6963--CALL
X$STRING.SIZ
      6399**DCL      6400--IMP-SIZ
