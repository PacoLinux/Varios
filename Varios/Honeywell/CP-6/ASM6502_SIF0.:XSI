C*T***********************************************************  
C*T*                                                         *  
C*T* Copyright (c) Bull HN Information Systems Inc., 1989    *  
C*T*                                                         *  
C*T***********************************************************  
      BLOCK DATA
      IMPLICIT INTEGER(A-Z)
      INCLUDE ASM6502_C1,LIST
C-----------------------------------------------------------------------
C
C     OPTBL CONTAINS THE LIST OF ALL LEGAL OPCODES (8 BYTES EACH); IT
C     IS INDEXED BY OPIDX AND RANGES FROM 1 TO OPLIM.  56 MACHINE
C     INSTRUCTIONS AND 37 ASSEMBLER DIRECTIVES ARE PRE-DEFINED.  THE
C     REMAINING 105 SLOTS CAN BE USED BY USER-DEFINED MACROS.
C
      DATA ((OPTBL(I,J),I=1,2),J=1,96)/
     1  'ADC ','    ','AND ','    ','CMP ','    ','EOR ','    ',
     2  'LDA ','    ','ORA ','    ','SBC ','    ','STA ','    ',
     3  'ASL ','    ','LSR ','    ','ROL ','    ','ROR ','    ',
     4  'BCC ','    ','BCS ','    ','BEQ ','    ','BMI ','    ',
     5  'BNE ','    ','BPL ','    ','BVC ','    ','BVS ','    ',
     6  'BIT ','    ','CPX ','    ','CPY ','    ','DEC ','    ',
     7  'INC ','    ','JMP ','    ','JSR ','    ','LDX ','    ',
     8  'LDY ','    ','STX ','    ','STY ','    ','BRK ','    ',
     9  'CLC ','    ','CLD ','    ','CLI ','    ','CLV ','    ',
     A  'DEX ','    ','DEY ','    ','INX ','    ','INY ','    ',
     1  'NOP ','    ','PHA ','    ','PHP ','    ','PLA ','    ',
     2  'PLP ','    ','RTI ','    ','RTS ','    ','SEC ','    ',
     3  'SED ','    ','SEI ','    ','TAX ','    ','TAY ','    ',
     4  'TSX ','    ','TXA ','    ','TXS ','    ','TYA ','    ',
     5  'DATA','    ','WORD','    ','BYTE','    ','TEXT','    ',
     6  'ADDR','    ','EQU ','    ','ORG ','    ','RES ','    ',
     7  'BSS ','    ','ENT ','    ','DEF ','    ','EXT ','    ',
     8  'REF ','    ','END ','    ','NAME','    ','TITL','E   ',
     9  'PAGE','    ','EJEC','T   ','SKIP','    ','SPAC','E   ',
     A  'INCL','    ','IF  ','    ','ELSE','    ','FI  ','    ',
     1  'GOTO','    ','LIST','    ','NLIS','T   ','MAC ','    ',
     2  'MEND','    ','SET ','    ','OPTS','    ','EXTL','    ',
     3  'REFL','    ','EXTS','    ','REFS','    ','DEFS','    ',
     4  'DEFB','    ','DEFW','    ','DEFM','    ','BOUN','D   '/
C
C     OPTYPE IS PARALLEL TO THE SECOND DIMENSION OF OPTBL.  IT
C     SPECIFIES THE TYPE OF OPCODE AND IS USED AS AN BRANCH INDEX
C     TO GO TO THE PROPER PROCESSING CODE.  CODES 1-13 ARE MACHINE
C     INSTRUCTIONS; 21-44 ARE ASSEMBLER DIRECTIVES; 101 SPECIFIES
C     A USER-DEFINED MACRO.
C
      DATA (OPTYPE(I),I=1,96)/
     1   1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3,
     2   4, 5, 5, 6, 6, 7, 8, 9,10,11,12,13,13,13,13,13,13,13,13,13,
     3  13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,21,22,23,21,
     4  25,26,27,28,28,29,29,30,30,31,32,32,33,33,34,34,35,36,37,38,
     5  39,40,41,42,43,24,44,30,30,45,45,28,23,25,21,46/
C
C     OPBASE IS THE BASE FOR THE OPCODE DEVELOPMENT PROCESS;
C     IT IS PARALLEL TO THE SECOND DIMENSION OF OPTBL.  ASSEMBLER
C     DIRECTIVES USE OPBASE AS A PROCESS LABEL(1)/DO NOT PROCESS LABEL
C     (0) FLAG; OPBASE IS THE RECORD NUMBER OF THE BEGINNING OF THE
C     MACRO IN THE MC FILE FOR MACROS.
C
      DATA (OPBASE(I),I=1,96)/
     1   97, 33,193, 65,161,  1,225,129,  0, 64, 32, 96,144,176,240, 48,
     2  208, 16, 80,112, 36, 32,  0,  0, 32, 76, 32,162,160,134,132,  0,
     3   24,216, 88,184,202,136,232,200,234, 72,  8,104, 40, 64, 96, 56,
     4  248,120,170,168,186,138,154,152,  1,  1,  1,  1,  1,  0,  0,  1,
     5    1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,
     6    0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  1,  1,  1,  1,  0/
C
C     OPTIME CONTAINS THE BASE TIME FOR THIS INSTRUCTION; IT IS
C     PARALLEL TO THE SECOND DIMENSION OF OPTBL.
C
      DATA (OPTIME(I),I=1,56)/
     1  2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,2,2,5,5,3,6,2,
     2  2,3,3,7,2,2,2,2,2,2,2,2,2,3,3,4,4,6,6,2,2,2,2,2,2,2,2,2/
C
C     OPCODE HOLDS THE OPCODE IN TEXT DURING DEVELOPMENT; OPLIM IS THE
C     INDEX OF THE LAST USED VALUE IN OPTBL; OPIDX IS A WORKING CELL
C     POINTING TO THE OPXXX ENTRIES FOR THE CURRENT OPCODE.
C
      DATA OPCODE/0,0/,OPLIM/96/,OPIDX/0/
C-----------------------------------------------------------------------
C
C     SYMBOL CONTAINS SYMBOLS WHICH HAVE BEEN DEFINED OR REFERENCED
C     IN THE PROGRAM.  THE FIRST TWO WORDS ARE USED FOR THE NAME IN
C     TEXT FORM; THE THIRD WORD HOLDS FLAGS DESCRIBING THE SYMBOL
C     (1=DEFINED,2=SET,4=ENT/DEF,8=EXT/REF,16=RELOCATABLE); THE
C     FOURTH WORD CONTAINS THE VALUE OF THE SYMBOL IN 16-BIT FORMAT.
C     THE FIFTH WORD CONTAINS THE RECORD NUMBER OF THE LAST REFERENCE
C     IN THE XR FILE.
C
      DATA (SYMBOL(I,1),I=1,5)/0,0,0,0,0/
C
C     LABEL CONTAINS THE LABEL ON THE CURRENT INSTRUCTION OR 0 IF THE
C     STATEMENT IS UNLABELED.  NOTE THAT LABEL IS PADDED ON THE RIGHT
C     WITH BINARY ZEROS RATHER THAN SPACES.
C
      DATA LABEL/0,0/
C
C     HISYM POINTS TO THE LAST DEFINED SYMBOL IN SYMBOL
C
      DATA HISYM/0/
C-----------------------------------------------------------------------
C
C     ARGMAT IS INDEXED BY ARGTYP+1 AND OPTYPE; IT GIVES THE MODIFIER
C     TO BE ADDED TO OPBASE TO FORM THE COMPLETE OPCODE WITH ADDRESSING.
C     ARGMAT IS ONLY USED WITH MACHINE INSTRUCTIONS.
C
      DATA ARGMAT/
     1   -1,  8,  0, 16, -1, -1, 20, -1,  4, 28, 24, 12,
     2   -1, -1, -1, -1, -1, 10, 22, -1,  6, 30, -1, 14,
     3   -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1, -1,
     4   -1, -1, -1, -1, -1, -1, -1, -1,  0, -1, -1,  8,
     5   -1,192, -1, -1, -1, -1, -1, -1,196, -1, -1,204,
     6   -1, -1, -1, -1, -1, -1,214, -1,198,222, -1,206,
     7   -1, -1, -1, -1, 32, -1, -1, -1, -1, -1, -1,  0,
     8   -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,  0,
     9   -1,  0, -1, -1, -1, -1, -1, 20,  4, -1, 28, 12,
     A   -1,  0, -1, -1, -1, -1, 20, -1,  4, 28, -1, 12,
     1   -1, -1, -1, -1, -1, -1, -1, 16,  0, -1, -1,  8,
     2   -1, -1, -1, -1, -1, -1, 16, -1,  0, -1, -1,  8,
     3    0, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1/
C
C     ARGTIM HOLDS THE ADDITIONAL CLOCK PERIODS TO BE ADDED TO THE
C     BASE TIME TO COMPUTE THE TIME FOR THIS INSTRUCTION.
C
      DATA ARGTIM/
     1  0,0,4,3,0,0,2,0,1,2,2,2,
     2  0,0,0,0,0,0,4,0,3,5,0,4,
     3  0,0,0,0,0,0,0,0,0,0,0,0,
     4  0,0,0,0,0,0,0,0,0,0,0,1,
     5  0,0,0,0,0,0,0,0,1,0,0,2,
     6  0,0,0,0,0,0,1,0,0,2,0,1,
     7  0,0,0,0,2,0,0,0,0,0,0,0,
     8  0,0,0,0,0,0,0,0,0,0,0,0,
     9  0,0,0,0,0,0,0,2,1,0,2,2,
     A  0,0,0,0,0,0,2,0,1,2,0,2,
     1  0,0,0,0,0,0,0,1,0,0,0,1,
     2  0,0,0,0,0,0,1,0,0,0,0,1,
     3  0,0,0,0,0,0,0,0,0,0,0,0/
C
C     ARGBGN HOLDS THE INDEX TO THE FIRST CHARACTER OF THE ARGUMENT
C     FIELD; ARGEND HOLDS THE INDEX TO THE LAST CHARACTER; ARGCNT
C     HOLDS A COUNT OF COMMAS IN THE ARGUMENT FIELD NOT ENCLOSED IN
C     QUOTED STRINGS; ARGTYP CONTAINS THE ASSUMED ADDRESSING MODE
C     (ARGUMENT TYPE), 0-12 OR -1 IF "UNKNOWN".
C
      DATA ARGBGN/0/,ARGEND/0/,ARGCNT/0/,ARGTYP/0/
C-----------------------------------------------------------------------
C
C     INPBUF HOLDS AN INPUT IMAGE FROM EITHER SI OR IN OR MC, ONE
C     CHARACTER (LEFT-JUSTIFIED) PER CELL
C
      DATA INPBUF(1)/0/
C
C     LOBUF HOLDS ONE PRINT LINE
C
      DATA LOBUF(1)/0/
C
C     XRBUF CONTAINS CROSS-REFERENCE INFORMATION; THE FIRST TWO
C     WORDS HOLD THE LINE NUMBER REFERENCE FOR A SYMBOL, THE
C     THIRD WORD CONTAINS THE RECORD NUMBER OF THE PREVIOUS
C     REFERENCE RECORD IN THE XR FILE; WORDS 4 AND 5 HOLD THE OPCODE ON
C     THE REFERENCE LINE.
C
      DATA XRBUF/0,0,0,0,0/
C
C     IUSTK CONTAINS THE UNIT NUMBER THAT WAS LAST USED FOR INPUT;
C     LNSTK CONTAINS THE LAST RECORD NUMBER LAST USED FOR INPUT.  BOTH
C     ARE USED DURING MACRO EXPANSION.  MACROS CAN NEST TO 9 DEEP.
C
      DATA IUSTK/0,0,0,0,0,0,0,0,0,0/,LNSTK/0,0,0,0,0,0,0,0,0,0/
C
C     IUNIT CONTAINS THE CURRENT 'INPUT' UNIT NUMBER (SI, IN, MC,
C     OR TM FILE).
C     SIUNIT IS THE USER'S SOURCE FILE INPUT UNIT NUMBER.
C     INUNIT IS THE INCLUDE FILE I/O UNIT NUMBER.
C     MCUNIT IS THE MACRO FILE I/O UNIT NUMBER.
C     XRUNIT IS THE CROSS-REFERENCE FILE I/O UNIT NUMBER.
C     OUUNIT IS THE OBJECT UNIT FILE I/O UNIT NUMBER.
C     LOUNIT IS THE LISTING FILE I/O UNIT NUMBER.
C     TMUNIT IS THE TEMPORARY FILE I/O UNIT NUMBER.
C     CURPOS POINTS TO THE NEXT CHARACTER TO BE EXAMINED IN INPBUF.
C     XRREC IS THE NEXT RECORD TO BE WRITTEN/READ TO/FROM XR FILE.
C     ARS IS THE NUMBER OF SIGNIFICANT CHARACTERS IN INPBUF.
C     MCREC IS THE NEXT RECORD TO BE WRITTEN/READ TO/FROM MC FILE.
C
      DATA IUNIT/105/,SIUNIT/105/,INUNIT/11/,MCUNIT/12/,XRUNIT/13/,
     1  OUUNIT/107/,LOUNIT/106/,TMUNIT/15/,CURPOS/0/,XRREC/1/,ARS/0/,
     2  MCREC/1/
C-----------------------------------------------------------------------
C
C     K-CONSTANTS ARE INTERNAL FORMS OF CHARACTERS
C
      DATA KMLT/1/,KDIV/2/,KMOD/3/,KADD/4/,KSUB/5/,KASL/6/,KASR/7/,
     1  KLSS/8/,KLEQ/9/,KEQL/10/,KNEQ/11/,KGEQ/12/,KGTR/13/,KNOT/14/,
     2  KAND/15/,KIOR/16/,KEOR/17/,KEOC/18/,KPMI/19/,KLPR/20/,KRPR/21/
C
C     E-CONSTANTS ARE ERROR FLAGS IOR'D INTO ERRORS
C
      DATA ERRA/1/,ERRD/8/,ERRL/2048/,ERRM/4096/,ERRO/16384/,
     1  ERRP/32768/,ERRR/131072/,ERRS/262144/,ERRT/524288/,
     2  ERRU/1048576/,ERRX/8388608/
C
C     OPT-CONSTANTS ARE OPTION FLAGS
C
      DATA OPTLS/1/,OPTXR/2/,OPTOU/4/,OPTSC/8/,OPTREL/16/,OPTOC/32/,
     1  OPTAO/64/
C
C     BLANK CONTAINS A BLANK.
C     LOLINE CONTAINS THE LAST LINE PRINTED ON THE LOUNIT.
C     LOPAGE CONTAINS THE LAST PAGE PRINTED ON THE LOUNIT.
C     LOLIM CONTAINS THE MAXIMUM NUMBER OF LINES TO PRINT PER PAGE.
C     FLAGLS CONTAINS THE RESULT OF THE LIST OPERAND.
C     DIDMAC INDICATES IF A MACRO HAS BEEN INVOKED OR NOT.
C     LOWID CONTAINS THE NUMBER OF COLUMNS PER PRINT LINE.
C
      DATA BLANK/'    '/,LOLINE/99999999/,LOPAGE/0/,LOLIM/39/,
     1  FLAGLS/1/,DIDMAC/0/,LOWID/72/
C-----------------------------------------------------------------------
C
C     PASS CONTAINS THE CURRENT ASSEMBLER PASS NUMBER, 0-2.
C     NBITS IS THE NUMBER OF BITS IN A BYTE.
C     LOCCTR IS THE CURRENT VALUE OF THE LOCATION COUNTER.
C     TEXT HOLDS TEXT CONSTANTS AS FOUND BY EVE.
C     FLAGIF COUNTS THE NUMBER OF IF/ELSE/FI STATEMENTS NESTED.
C     GO2LBL IS THE 0-PADDED TARGET OF A 'GOTO' DIRECTIVE.
C     OBJCNT COUNTS THE NUMBER OF SIGNIFICANT BYTES IN OBJECT.
C     OBJECT HOLDS THE OBJECT CODE GENERATED BY THIS STATEMENT,
C     ONE BYTE PER CELL.
C     ERRORS CONTAINS ERROR FLAGS FOR THIS STATEMENT.
C     LNCNT HOLDS THE CURRENT LINE NUMBER FOR THE CURRENT INPUT FILE.
C     OPTION HOLDS THE OPTION FLAGS.
C     ERRCNT COUNTS THE NUMBER OF ERROR LINES.
C     SRACCT HOLDS THE SEARCH ACCOUNT NAMES FOR INCL FILES.
C     TIME HOLDS THE CURRENT TIME OF DAY.
C     DATE HOLDS THE CURRENT DATE.
C     CPU1 HOLDS THE START CPU TIME.
C     CPU2 HOLDS THE STOP CPU TIME.
C     TITLE HOLDS THE LATEST TITLE FROM THE TITLE COMMAND.
C     CLOCK HOLDS THE CLOCK FREQUENCY IN MEGAHERTZ FOR TIMINGS.
C     FLAGMC IS NON-ZERO WHEN A MACRO IS BEING DEFINED.
C     PARITY IS: 0-NONE,1-EVEN,2-ODD,3-MARK.
C     REFCNT IS THE LAST REF COUNTER USED (STARTS AT 1).
C     RELOC IS A RELOCATION COUNTER (-1, 0, OR 1).
C     RELBAS IS THE BASE FOR RELOCATION, 0-127.
C
      DATA PASS/0/,NBITS/9/,LOCCTR/512/,TEXT(1)/0/,FLAGIF/0/,
     1  GO2LBL/0,0/,OBJCNT/0/,OBJECT(1)/0/,ERRORS/0/,LNCNT/0/,
     2  ERRCNT/0/,SRACCT/0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0/,
     3  OPTION/5/,TIME/'    ','    '/,DATE/'    ','    '/,CPU1/0.0/,
     4  CPU2/0.0/,TITLE/120*'    '/,CLOCK/100/,FLAGMC/0/,PARITY/0/,
     5  REFCNT/1/,RELOC/0/,RELBAS/0/
C-----------------------------------------------------------------------
C
C     MCHEAD CONTAINS THE INVOCATION IMAGE FOR A MACRO.
C     MCDUM CONTAINS THE DUMMY ARGUMENTS ON THE MAC LINE.
C     MCPTR CONTAINS POINTERS TO MCHEAD FOR THE ARGUMENTS AND MCCNT
C     CONTAINS THE COUNT OF THE TEXT FOR SUBSTITUTION.
C
C-----------------------------------------------------------------------
C
C     COMMON OBJ HOLD OBJECT UNIT BUFFERS.
C
C     OUBUF0 IS USED TO HOLD THE CURRENT TYPE 0 RECORD BEING FORMED.
C     OUBUF3 IS USED TO HOLD THE CURRENT TYPE 3 RECORD BEING FORMED.
C     OUBUF4 IS USED TO HOLD THE CURRENT TYPE 4 RECORD BEING FORMED.
C     OUBUF5 IS USED TO HOLD THE CURRENT TYPE 5 RECORD BEING FORMED.
C
C     OUBUF0 IS ALSO USED FOR TYPE 1, X'80', X'81', AND X'82' RECORDS.
C
C     AN IS USED TO HOLD THE CURRENT A-FIELD FOR BUFFER N.
C     BN IS USED TO HOLD THE BASE B-FIELD FOR BUFFER N.
C     CN IS USED TO HOLD THE COMMAND FOR BUFFER N.
C     EN IS USED TO HOLD THE CURRENT E-FIELD FOR BUFFER N.
C
C     BUFFER FORMAT:
C
C     AABBBBCC[DD]...EE
C
C     AA IS THE COUNT OF DD BYTES THAT FOLLOW.
C     BBBB IS THE ADDRESS TO WHICH THE DD BYTES APPLY, MSB FIRST.
C     CC IS THE COMMAND (SEE BELOW).
C     DD ARE THE DATA BYTES.
C     EE IS THE ARITHMETIC INVERSE OF THE SUM OF ALL THE PRECEDING
C       BYTES, AA THROUGH THE LAST DD.
C
C     COMMAND DESCRIPTIONS:
C
C     00 - LOAD DATA.  AA BYTES (DD) ARE LOADED AT LOCATION BBBB
C       AND UP.
C     01 - DEFINE ENTRY.  BBBB IS THE ENTRY ADDRESS.  AA=0.
C     03 - RELOCATE LONG.  DD INDICATES LOCATION TO BE RELOCATED
C       (SEE BELOW).
C     04 - RELOCATE SHORT.  DD INDICATES LOCATION TO BE RELOCATED.
C     05 - RESERVE MEMORY.  DDDD INDICATES HOW MUCH.
C     80 - DEFINE SYMBOL.  AA=9, DD CONTAINS THE HOST'S REPRESENTATION
C       OF THE SYMBOL IN CHARACTERS, BBBB CONTAINS ITS VALUE.
C     81 - DEFINE ENTRY SYMBOL.  AA=9, DD CONTAINS THE HOST'S
C       REPRESENTATION OF THE SYMBOL IN CHARACTERS, BBBB CONTAINS ITS
C       VALUE.
C     82 - DEFINE REFERENCED SYMBOL.  AA=9, DD CONTAINS THE HOST'S
C       REPRESENTATION OF THE SYMBOL IN CHARACTERS, BBBB CONTAINS THE
C       EXTERNAL SYMBOL NUMBER ASSIGNED BY ASM (2-127).
C
C     IN TYPE 80, 81, AND 82 RECORDS, THE 9TH BYTE IN THE DD FIELD
C     CONTAINS THE ASSEMBLER'S FLAGS:  16=RELOCATABLE, 8=EXT/REF,
C     4=ENT/DEF, 2=SET, 1=DEFINED.
C
C     RELOCATION FIELDS IN TYPE 03 AND 04 RECORDS ARE FORMATTED
C     AS FOLLOWS:
C
C       DDDDXX
C
C       DDDD IS THE MEMORY LOCATION TO BE RELOCATED; IF THE COMMAND
C         IS 03 (RELOCATE LONG), DDDD POINTS TO THE LEFTMOST (LSB)
C         BYTE.
C       XX DEFINES THE RELOCATION BASE (0-127) AND WHETHER THE
C         VALUE OF THE BASE IS TO BE ADDED (+0) OR SUBTRACTED (+128)
C         FROM THE CONTENTS OF MEMORY.  RELOCATION BASE 0 IS PAGE
C         ZERO; BASE 1 IS NON-PAGE ZERO; 2-127 ARE EXTERNAL SYMBOL
C         NUMBERS REFERRING TO CORRESPONDING TYPE 82 RECORDS.
C
      DATA A0/0/,A3/0/,A4/0/,B0/-1/,B3/0/,B4/0/,C0/0/,C3/3/,C4/4/,
     1  A5/0/,B5/-1/,C5/5/
C-----------------------------------------------------------------------
C
C     COMMON BREAK CONTROLS BREAK KEY STUFF
C
      DATA BREAK/0/
      END 
