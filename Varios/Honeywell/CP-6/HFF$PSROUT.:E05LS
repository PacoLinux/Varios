VERSION E05

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 1    BMAP - B00     
                                         1  *M*    HFF$PSROUT  ROUTINES TO MANIPULATE PARAMETER SEGMENT
                                         2  *T***********************************************************
                                         3  *T*                                                         *
                                         4  *T* Copyright (c) Bull HN Information Systems Inc., 1997    *
                                         5  *T*                                                         *
                                         6  *T***********************************************************
                                         7  *
                                         8  *
                                         9  **P*   HFF$PSROUT  PURPOSE: TO PROVIDE VARIOUS MANIPULATION FUNCTIONS OF
                                        10  *      DESCRIPTORS IN THE PARAMETER SEGMENT.
                                        11  *
                                        12  *
                                        13  **F*   HFF$DSIZ CALL HFF$DSIZ(PNO,DSIZE) PNO IS PTR SPECIFYING THE
                                        14  *      DESIRED DESCRIPTOR ON THE PS --0,1,2,  ETC.  DSIZE IS SBIN WORD
                                        15  *      WHICH WILL CONTAIN THE NUMBER OF BYTES CONTAINED IN THE DESCRIBED
                                        16  *      SEGMENT --I.E. THE DESC BOUND+1.
                                        17  *
                                        18  *      CALL HFF$RET_PS_DESC (P$ , DESC) ALTRET(NOT_HERE);
                                        19  *      P$ IS A PTR SPECIFYING WHICH PARAMETER SEGMENT DESCRIPTOR
                                        20  *      IS DESIRED TO BE RETURNED AS DATA.
                                        21  *      DESC IS A BIT(72) ALIGNED VARIABLE INTO WHICH WILL BE RETURNED
                                        22  *      THE DESIRED DESCRIPTOR AS DATA TO BE EXAMINED AS NECESSARY.
                                        23  *      IF THE SPECIFIED DESCRIPTOR DOES NOT EXIST OR IS NIL OR ERASE,
                                        24  *      THE ALTRET IS TAKEN AND NOTHING IS RETURNED.
                                        25  *
                                        26  *      CALL HFF$NIL(PNO)
                                        27  *
                                        28  *      CALL HFF$ERASE(PNO) THESE TWO ROUTINES CHECK THE DESCRIPTOR
                                        29  *      LOCATED BY PNO(PTR) TO SEE IF IT IS THE NIL OR ERASE DESCRIPTOR
                                        30  *      RESPECTIVELY.  IF IT IS NOT THE TESTED SPECIAL DESCRIPTOR, THE
                                        31  *      NORMAL RETURN IS TAKEN.  IF IT IS THE ALT RETURN IS TAKEN.
                                        32  *      ALSO, DESC'S WITH FLAGS WHICH SPECIFY EMPTY OR NOT PRESENT
                                        33  *      OR WHICH ARE NOT ON THE PS WILL BE CONSIDERED NIL BUT NOT ERASE.
                                        34  *      IN ADDITION, SYMDEFS ARE PROVIDED FOR 72 BIT DATA ITEMS ON DOUBLE
                                        35  *      WORD BOUNDS AS FOLLOWS:
                                        36  *      B_NIL     A CONSTANT WITH THE VALUE OF THE NIL DESCRIPTOR.
                                        37  *      B_ERASE   A CONSTANT WITH THE VALUE OF THE ERASE DESCRIPTOR.
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 2    BMAP - B00     
                                        38  *
                                        39  *       CALL HFF$NILERASE(PNO) CHECKS FOR EITHER- NORMAL IF NEITHER.
                                        40  *
                                        41  *
                                        42  *
                                        43  *      ENTRY DEFS FOR THE MODULE:
                                        44         ENTDEF  HFF$DSIZ
                                        45         ENTDEF  HFF$RET_PS_DESC
                                        46         ENTDEF  HFF$NIL
                                        47         ENTDEF  HFF$ERASE
                                        48         ENTDEF  HFF$NILERASE
                                        49         ENTDEF  HFF$WRITE,HFF$WRITE1
                                        50  *
                                        51  *      SYMDEFS FOR THE MODULE:
                                        52         SYMREF  BHF_TEMP
                                        53         SYMREF  S_NSCPUA
                                        54         SYMREF  H_GATECNT
                                        55         SYMREF  NI$DS
                                        56         SYMREF  S_TRO_SS
                                        57  *
                                        58  *      ENTRY REFS FOR THE MODULE:
                                        59  *
                                        60  *      LAYOUT OF AUTO STORAGE FOR THE MODULE:
                                        61  *
                                        62  *      DEFINITION OF SEGID'S,DR'S,ETC.
             000000000000               63  DR0    EQU     0
             000000000002               64  AUTO   EQU     2
             000000000001               65  DRX    EQU     1
             000000000003               66  DR3    EQU     3
                                        67         SEGREF  ISRSID,PSRSID,CDTFSID
             000000000103               68  NILFLG BOOL    103
                                        69  *
             000000000001               70  AUTOLOC  EQU 1
             000000000001               71  PMMELOC  EQU 1
             000000000007               72  CLNUPLOC EQU 7
                                        73  *
                                        74  *
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 3    BMAP - B00     
                                        75  *

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 4    BMAP - B00     
                                        76           EJECT
                                        77  ALIGN    MACRO
                                        78  _1       SET       *-HFF$DSIZ
                                        79  _2       SET       _1/4*4
                                        80  _2       SET       _1-_2
                                        81  _2       SET       4+#1-_2
                                        82           IFE       _2,1
                                        83           BSS       1
                                        84           IFE       _2,2
                                        85           BSS       2
                                        86           IFE       _2,3
                                        87           BSS       3
                                        88           IFE       _2,5
                                        89           BSS       1
                                        90           IFE       _2,6
                                        91           BSS       2
                                        92           IFE       _2,7
                                        93           BSS       3
                                        94           ENDM

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 5    BMAP - B00     
                                        95           EJECT
 0 000000                               96           USE       HFF$PROC,1
                                        97           INHIB     ON
                                        98           EIGHT
   000000                               99  HFF$DSIZ NULL
   000000    0 00001 4737 00           100           LDP3      1,,0                PLACE FOR SIZE
   000001  X 000000 7516 00            101           STPS      BHF_TEMP
   000002    0 00000 4717 00           102           LDP1      0,,0                GET PS PTR
   000003  X 000000 2362 00            103           LDQ       BHF_TEMP
   000004    200000 0362 07            104           ADLQ      =O200000,DL
   000005    000023 7722 00            105           QRL       19                  DWRD SIZE OF PS
   000006    1 00000 1163 00           106           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000007 (0)000024 6046 00            107           TMOZ      DSIZ1               IT'S NOT THERE
   000010    1 00000 4707 00           108           LDP0      0,,1
   000011  X 000000 0506 00            109           STD0      BHF_TEMP            STORE DESC AS DATA
   000012  X 000000 2362 00            110           LDQ       BHF_TEMP
   000013    000020 7722 00            111           QRL       16                  ISOLATE BOUND
   000014    000001 0762 07            112           ADQ       1,DL                ADJUST TO SIZE
   000015    3 00000 7563 00           113           STQ       0,,3
   000016    100600 2352 07            114           LDA       =O100600,DL
   000017  X 000000 2152 00            115           CNAA      BHF_TEMP
   000020    000001 6002 11            116           TZE       1,1                    ALL OF RD,NE,PR SET
   000021  X 000000 2362 00            117           LDQ       BHF_TEMP            MUST CHECK FOR WSQ TYPE (2,3)
   000022    000016 3162 07            118           CANQ      =O16,DL
   000023 (0)000026 6012 00            119           TNZ       DSIZ2
                                       120  *
   000024                              121  DSIZ1    NULL
   000024    3 00000 4503 00           122           STZ       0,,3                NIL, RETURN ZERO
   000025    000000 7102 11            123           TRA       0,1                 AND ALTRET
   000026                              124  DSIZ2    NULL
   000026    100000 3762 07            125           ANQ       =O100000,DL         MUST BE READABLE
   000027    000001 6012 11            126           TNZ       1,1
   000030 (0)000024 7102 00            127           TRA       DSIZ1
   000031    000000 0112 00            128           EVEN
   000032
   000032    0000001 103 7 00          129  B_ERASE  VFD       20/1,9/NILFLG,3/7,4/0,36/0
   000033    000000000000

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 6    BMAP - B00     
                                       130           EJECT
                                       131  *
   000034                              132  HFF$RET_PS_DESC NULL
   000034    0 00001 4737 00           133           LDP3      1,,0      PLACE FOR DESCRIPTOR
   000035  X 000000 7516 00            134           STPS      BHF_TEMP
   000036    0 00000 4717 00           135           LDP1      0,,0                GET PS PTR
   000037  X 000000 2362 00            136           LDQ       BHF_TEMP
   000040    200000 0362 07            137           ADLQ      =O200000,DL
   000041    000023 7722 00            138           QRL       19                  DWRD SIZE OF PS
   000042    1 00000 1163 00           139           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000043    000000 6046 11            140           TMOZ      0,1                 IT'S NOT THERE
   000044    1 00000 4707 00           141           LDP0      0,,1
   000045  X 000000 0506 00            142           STD0      BHF_TEMP            STORE DESC AS DATA
   000046    100600 2352 07            143           LDA       =O100600,DL
   000047  X 000000 2152 00            144           CNAA      BHF_TEMP
   000050 (0)000055 6012 00            145           TNZ       PSDESC1             NOT ALL OF RD,NE,PR SET
   000051                              146  PSDESC2  NULL
   000051  X 000000 2372 00            147           LDAQ      BHF_TEMP
   000052    3 00000 7553 00           148           STA       0,,3
   000053    3 00001 7563 00           149           STQ       1,,3
   000054    000001 7102 11            150           TRA       1,1
   000055                              151  PSDESC1  NULL
   000055  X 000000 2362 00            152           LDQ       BHF_TEMP
   000056    000016 3162 07            153           CANQ      =O16,DL
   000057    000000 6002 11            154           TZE       0,1                 NOT TYPE 2 OR >
   000060    100000 3762 07            155           ANQ       =O100000,DL         MUST BE READABLE
   000061 (0)000051 6012 00            156           TNZ       PSDESC2
   000062    000000 7102 11            157           TRA       0,1

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 7    BMAP - B00     
                                       158           EJECT
                                       159  *
                                       160           ALIGN     4
   000064                              161  HFF$NIL  NULL
   000064  X 000000 7516 00            162           STPS      BHF_TEMP
   000065    0 00000 4717 00           163           LDP1      0,,0                GET PS PTR
   000066  X 000000 2362 00            164           LDQ       BHF_TEMP
   000067    200000 0362 07            165           ADLQ      =O200000,DL
   000070    000023 7722 00            166           QRL       19                  DWRD SIZE OF PS
   000071    1 00000 1163 00           167           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000072    000000 6046 11            168           TMOZ      0,1                 IT'S NOT THERE
   000073    1 00000 4707 00           169           LDP0      0,,1
   000074  X 000000 0506 00            170           STD0      BHF_TEMP            STORE DESC AS DATA
   000075    100600 2352 07            171           LDA       =O100600,DL
   000076  X 000000 2152 00            172           CNAA      BHF_TEMP
   000077    000001 6002 11            173           TZE       1,1
                                       174  *                                        NOT ALL OF RD,NE,PR SET
   000100  X 000000 2362 00            175           LDQ       BHF_TEMP
   000101    000016 3162 07            176           CANQ      =O16,DL
   000102 (0)000105 6002 00            177           TZE       NIL1
   000103    100000 3762 07            178           ANQ       =O100000,DL
   000104    000001 6012 11            179           TNZ       1,1
   000105                              180  NIL1     NULL
                                       181  *
   000105  X 000000 2372 00            182           LDAQ      BHF_TEMP            ANY BUT ERASE IS NIL
   000106 (0)000032 1172 00            183           CMPAQ     B_ERASE
   000107    000000 6012 11            184           TNZ       0,1
   000110    000001 7102 11            185           TRA       1,1

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 8    BMAP - B00     
                                       186           EJECT
                                       187  *
                                       188           ALIGN     4
   000114                              189  HFF$ERASE NULL
   000114  X 000000 7516 00            190           STPS      BHF_TEMP
   000115    0 00000 4717 00           191           LDP1      0,,0                GET PS PTR
   000116  X 000000 2362 00            192           LDQ       BHF_TEMP
   000117    200000 0362 07            193           ADLQ      =O200000,DL
   000120    000023 7722 00            194           QRL       19                  DWRD SIZE OF PS
   000121    1 00000 1163 00           195           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000122    000001 6046 11            196           TMOZ      1,1                 IT'S NOT THERE
   000123    1 00000 4707 00           197           LDP0      0,,1
   000124  X 000000 0506 00            198           STD0      BHF_TEMP            STORE DESC AS DATA
   000125    100600 2352 07            199           LDA       =O100600,DL
   000126  X 000000 2152 00            200           CNAA      BHF_TEMP
   000127    000001 6002 11            201           TZE       1,1
                                       202  *
   000130  X 000000 2362 00            203           LDQ       BHF_TEMP
   000131    000016 3162 07            204           CANQ      =O16,DL
   000132 (0)000135 6002 00            205           TZE       ERASE1
   000133    100000 3762 07            206           ANQ       =O100000,DL
   000134    000001 6012 11            207           TNZ       1,1
   000135                              208  ERASE1   NULL
                                       209  *                                          NOT ALL OF RD,NE,PR SET
                                       210  *                                      ONLY ERASE IS ERASE
   000135  X 000000 2372 00            211           LDAQ      BHF_TEMP
   000136 (0)000032 1172 00            212           CMPAQ     B_ERASE
   000137    000001 6012 11            213           TNZ       1,1
   000140    000000 7102 11            214           TRA       0,1

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 9    BMAP - B00     
                                       215           EJECT
                                       216  *
                                       217           ALIGN     4
   000144                              218  HFF$NILERASE NULL
   000144  X 000000 7516 00            219           STPS      BHF_TEMP
   000145    0 00000 4717 00           220           LDP1      0,,0                GET PS PTR
   000146  X 000000 2362 00            221           LDQ       BHF_TEMP
   000147    200000 0362 07            222           ADLQ      =O200000,DL
   000150    000023 7722 00            223           QRL       19                  DWRD SIZE OF PS
   000151    1 00000 1163 00           224           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000152    000000 6046 11            225           TMOZ      0,1                 IT'S NOT THERE
   000153    1 00000 4707 00           226           LDP0      0,,1
   000154  X 000000 0506 00            227           STD0      BHF_TEMP            STORE DESC AS DATA
   000155    100600 2352 07            228           LDA       =O100600,DL
   000156  X 000000 2152 00            229           CNAA      BHF_TEMP
   000157    000001 6002 11            230           TZE       1,1
   000160  X 000000 2362 00            231           LDQ       BHF_TEMP
   000161    000016 3162 07            232           CANQ      =O16,DL
   000162    000000 6002 11            233           TZE       0,1
   000163    100000 3762 07            234           ANQ       =O100000,DL
   000164    000001 6012 11            235           TNZ       1,1
   000165    000000 7102 11            236           TRA       0,1                  NOT ALL OF RD,NE,PR SET

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 10   BMAP - B00     
                                       237           EJECT
                                       238  *
                                       239           ALIGN     4
   000170                              240  HFF$WRITE NULL
   000170  X 000000 7516 00            241           STPS      BHF_TEMP
   000171    0 00000 4717 00           242           LDP1      0,,0                GET PS PTR
   000172  X 000000 2362 00            243           LDQ       BHF_TEMP
   000173    200000 0362 07            244           ADLQ      =O200000,DL
   000174    000023 7722 00            245           QRL       19                  DWRD SIZE OF PS
   000175    1 00000 1163 00           246           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000176    000000 6046 11            247           TMOZ      0,1                 IT'S NOT THERE
   000177    1 00000 4707 00           248           LDP0      0,,1
   000200  X 000000 0506 00            249           STD0      BHF_TEMP            STORE DESC AS DATA
   000201    140600 2352 07            250           LDA       =O140600,DL
   000202  X 000000 2152 00            251           CNAA      BHF_TEMP
   000203    000001 6002 11            252           TZE       1,1
   000204  X 000000 2362 00            253           LDQ       BHF_TEMP
   000205    000016 3162 07            254           CANQ      =O16,DL
   000206    000000 6002 11            255           TZE       0,1
   000207    140000 3762 07            256           ANQ       =O140000,DL
   000210    000001 6012 11            257           TNZ       1,1
   000211    000000 7102 11            258           TRA       0,1                  NOT ALL OF RD,WR,NE,PR SET

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 11   BMAP - B00     
                                       259         EJECT
                                       260         ENTDEF  HFF$PTPRES
                                       261  *
   000212                              262  HFF$PTPRES NULL
   000212  X 000000 7516 00            263           STPS      BHF_TEMP
   000213    0 00000 4717 00           264           LDP1      0,,0                GET PS PTR
   000214  X 000000 2362 00            265           LDQ       BHF_TEMP
   000215    200000 0362 07            266           ADLQ      =O200000,DL
   000216    000023 7722 00            267           QRL       19                  DWRD SIZE OF PS
   000217    1 00000 1163 00           268           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000220    000000 6046 11            269           TMOZ      0,1                 IT'S NOT THERE
   000221    1 00000 4707 00           270           LDP0      0,,1
   000222  X 000000 0506 00            271           STD0      BHF_TEMP            STORE DESC AS DATA
   000223    100600 2352 07            272           LDA       =O100600,DL
   000224  X 000000 2152 00            273           CNAA      BHF_TEMP
   000225 (0)000233 6002 00            274           TZE       PTPRES1
   000226  X 000000 2362 00            275           LDQ       BHF_TEMP
   000227    000016 3162 07            276           CANQ      =O16,DL
   000230    000000 6002 11            277           TZE       0,1
   000231    100000 3762 07            278           ANQ       =O100000,DL
   000232    000000 6002 11            279           TZE       0,1
   000233                              280  PTPRES1  NULL
   000233    000040 2362 07            281           LDQ     =O40,DL
   000234 (0)000260 7102 00            282           TRA       PTCHK
                                       283  *
   000235                              284  HFF$WRITE1 NULL
   000235    000000 2272 03            285           LDX7    0,DU
   000236  X 000000 7516 00            286           STPS      BHF_TEMP
   000237    0 00000 4717 00           287           LDP1      0,,0                GET PS PTR
   000240  X 000000 2362 00            288           LDQ       BHF_TEMP
   000241    200000 0362 07            289           ADLQ      =O200000,DL
   000242    000023 7722 00            290           QRL       19                  DWRD SIZE OF PS
   000243    1 00000 1163 00           291           CMPQ      0,,1                SEE IF LDP WOULD TRAP
   000244    000000 6046 11            292           TMOZ      0,1                 IT'S NOT THERE
   000245    1 00000 4707 00           293           LDP0      0,,1
   000246  X 000000 0506 00            294           STD0      BHF_TEMP            STORE DESC AS DATA
   000247    140600 2352 07            295           LDA       =O140600,DL
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 12   BMAP - B00     
   000250  X 000000 2152 00            296           CNAA      BHF_TEMP
   000251 (0)000257 6002 00            297           TZE       WRITE11
   000252  X 000000 2362 00            298           LDQ       BHF_TEMP
   000253    000016 3162 07            299           CANQ      =O16,DL
   000254    000000 6002 11            300           TZE       0,1
   000255    140000 3762 07            301           ANQ       =O140000,DL
   000256    000000 6002 11            302           TZE       0,1
   000257                              303  WRITE11  NULL
   000257    000060 2362 07            304           LDQ     =O60,DL
   000260                              305  PTCHK    NULL
   000260  X 000000 2352 00            306         LDA     BHF_TEMP        BOUND
   000261    000020 7712 00            307         ARL     16
   000262  X 000001 0752 00            308         ADA     BHF_TEMP+1      +BASE=LAST BYTE IN SEG
   000263    000006 7352 00            309         ALS     6               ALIGN FOR COMPARISON
   000264  X 000000 7552 00            310         STA     BHF_TEMP
   000265  X 000001 2352 00            311         LDA     BHF_TEMP+1      BASE
   000266    000006 7352 00            312         ALS     6
   000267    000000 6352 01            313         EAA     0,AU            1ST PAGE # TO AU, 0 TO AL
                                       314         SYMREF  B$UPT$
   000270  X 000000 4706 00            315         LDP0    B$UPT$
   000271    0 00000 2163 01           316  PTLOOP CNAQ    0,AU,0          PAGE TABLE WORD
   000272 (0)000304 6002 00            317         TZE     PTWOK           PAGE TABLE ENTRY HAS CORRECT ACCESS
   000273    0 00000 7223 01           318         LXL2    0,AU,0          INCORRECT ACCESS: IS VALID IFF
   000274 (0)000313 6012 00            319         TNZ     CKNOWR            PAGE IS UNALLOCATED AND
   000275    0 00000 2223 01           320         LDX2    0,AU,0            .
   000276    757061 1022 03            321         CMPX2   =0777777,DU       .
   000277 (0)000313 6012 00            322         TNZ     CKNOWR            .
   000300    001130 1152 03            323         CMPA    =600,DU           PAGE IS INSIDE OF USER DS SPACE
   000301 (0)000313 6042 00            324         TMI     CKNOWR
   000302    003777 1152 03            325         CMPA    =2047,DU
   000303 (0)000313 6056 00            326         TPNZ    CKNOWR
   000304    0 00000 7223 01           327  PTWOK    LXL2      0,AU,0
   000305    000010 3622 03            328           ANX2      =O10,DU
   000306    000000 6012 11            329           TNZ       0,1                 HOUSEKEEPING NOT ALLOWED
   000307    000001 0752 03            330         ADA     1,DU
   000310  X 000000 1152 00            331         CMPA    BHF_TEMP
   000311 (0)000271 6046 00            332         TMOZ    PTLOOP
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 13   BMAP - B00     
   000312    000001 7102 11            333         TRA     1,1
                                       334  *
   000313                              335  CKNOWR NULL
   000313    000060 1162 07            336         CMPQ    =O60,DL         WERE WE CHECKING WRITE?
   000314    000000 6012 11            337         TNZ     0,1              NO
   000315    0 00000 2363 01           338         LDQ     0,AU,DR0        PT WORD AGAIN
   000316    400000 3162 07            339         CANQ    =O400000,DL     WAS IT DATA BRK PAGE?
   000317    000000 6002 11            340         TZE     0,1           NO
                                       341  *
                                       342  *              TURN OFF ALL DBRK, SET BIT IN USERT, THEN IF CALLED
                                       343  *              BY FPTCHK, RETRY; ELSE CONTINUE CHECKING.
                                       344  *
   000320    001777 2222 03            345         LDX2    1023,DU         PT SIZE
   000321    0 00000 2363 12           346  DBRKLP LDQ     0,2,0           PT WRD
   000322    400000 3162 07            347         CANQ    =O400000,DL
   000323 (0)000326 6002 00            348         TZE     NODBRK
   000324    000020 2762 07            349         ORQ     =O20,DL         SET WRITEABLE
   000325    0 00000 7563 12           350         STQ     0,2,0
   000326    777777 0622 03            351  NODBRK ADX2    -1,DU
   000327 (0)000321 6052 00            352         TPL     DBRKLP
                                       353  *
                                       354  *                  DATA BREAKS ALL TURNED OFF, NOW CONTINUE
                                       355  *
   000330    000002 5326 00            356         CAMP    2               ACTIVATE NEW WRITE BITS
                                       357         SYMREF  S$CU$
   000331  X 000000 4706 00            358         LDP0    S$CU$
   000332    010000 2362 07            359         LDQ     =O10000,DL
   000333    0 00000 2563 00           360         ORSQ    0,,0
   000334  X 000000 4706 00            361         LDP0    B$UPT$
                                       362  *                  RESTORE Q AND CONTINUE IF NOT UDE
   000335    000060 2362 07            363         LDQ     =O60,DL
   000336    000000 0672 03            364         ADX7    0,DU
   000337 (0)000271 6002 00            365         TZE     PTLOOP          NOT UDE, KEEP CHECKING
   000340 (1)000000 6316 00            366         EPPR    DRX,=-1
   000341 (0)000414 7102 00            367         TRA     CLNUP+1
                                       368  *
                                       369         ENTDEF  HFF$CHKDBRK
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 14   BMAP - B00     
   000342                              370  HFF$CHKDBRK NULL
   000342    777777 2272 03            371         LDX7    -1,DU
   000343 (0)000236 7102 00            372         TRA     HFF$WRITE1+1

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 15   BMAP - B00     
                                       373         EJECT
                                       374         ENTDEF  HFF$GETCLNUP
                                       375  *
   000344                              376  HFF$GETCLNUP NULL
   000344    0 00000 4717 00           377         LDP1    0,,0
   000345    0 00001 4737 00           378         LDP3    1,,0
   000346    001764 4706 07            379         LDP0    =O1764,DL       SSR
   000347  X 000000 4706 07            380         LDP0    CDTFSID,DL      MAKE TYPE 0
                                       381  *
                                       382  *      0=TYPE 0 FOR CUR FRAME
                                       383  *      5=TYPE 0 FOR PREV FRAME
                                       384  *      6=TYPE 1 FOR CUR FRAME
                                       385  *
                                       386         INHIB   ON
   000350    001764 4766 07            387         LDP6    =O1764,DL       SSR AGAIN, TYPE 1
   000351    0 00016 7717 00           388         LDPS    14,,DR0         SET UP PSR PROPERLY
   000352    0 00016 0507 00           389         STD0    14,,DR0         STORE IN PSR PLACE
   000353    0 00017 2363 00           390         LDQ     15,,DR0         GET BASE TO ADJUST
   000354    000100 1762 07            391         SBQ     64,DL           BACK UP WEE FRAME
   000355    030000 2352 07            392         LDA     =O30000,DL
   000356    0 00005 3753 00           393         ANA     5,,DR0          ISOLATE SCR
   000357 (0)000364 6002 00            394         TZE     *+5             WE'RE ALL SET
   000360    000300 1762 07            395         SBQ     192,DL          BACK UP BIG FRAME
   000361    030000 1152 07            396         CMPA    =O30000,DL
   000362 (0)000364 6002 00            397         TZE     *+2             IT'S A BIG ONE
   000363    000240 0762 07            398         ADQ     160,DL          MEDIUM
   000364    0 00017 7563 00           399         STQ     15,,DR0         ADJUSTED
   000365    6 00016 6757 00           400         LDD5    14,,6           NOW POINTS TO PMME FRAME
   000366    0 00016 7517 00           401         STPS    14,,DR0
   000367    5 00007 2353 00           402         LDA     CLNUPLOC,,5     TRAPALT AND AUTOPR
   000370    0 00007 7553 00           403         STA     CLNUPLOC,,0     PUT AWAY IN CUR FRAME
   000371 (0)000413 6352 00            404         EAA     CLNUP
   000372    1 00000 7553 00           405         STA     0,,DRX          AND RETURN IT
   000373    5 00001 2353 00           406         LDA     PMMELOC,,5      FPT CODE + AUTO BASE
   000374 (1)000001 3752 00            407         ANA     =O775777777777  TURN OFF UDE BIT
   000375    3 00000 7553 00           408         STA     0,,DR3          AND RETURN IT
   000376    5 00001 2203 00           409         LDX0    PMMELOC,,5      GET FPTCODE+AUTO BASE
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 16   BMAP - B00     
   000377    002000 3602 03            410         ANX0    =O2000,DU       IT FPT CHECKER BIT ON
   000400 (0)000404 6002 00            411         TZE     NO_FPTCHECKER   NO
   000401    0 00007 2363 00           412         LDQ     CLNUPLOC,,DR0   GET THE CLEAN UP LOCATION AND AUTOPTR
   000402    777777 3762 03            413         ANQ     =O777777,DU     SET CLEAN UP LOC TO ZERO
   000403    0 00007 7563 00           414         STQ     CLNUPLOC,,DR0   STORE CLEAN UP AND AUTOPTR
   000404                              415  NO_FPTCHECKER NULL
   000404    002000 2752 03            416         ORA     =O2000,DU       SET IT SO WE WONT FIND IT AGAIN
   000405    5 00001 7553 00           417         STA     PMMELOC,,5
   000406    5 00010 2353 00           418         LDA     8,,5            ISR
   000407    000160 3752 07            419         ANA     =O160,DL        ISR.WSR
   000410    000020 1152 07            420         CMPA    =O20,DL
   000411    000000 6046 11            421         TMOZ    0,1             ALTRET IF INTERNAL PMME
   000412    000001 7102 11            422         TRA     1,1             EXIT, STAY PRIV
                                       423  *
   000413                              424  CLNUP  NULL
   000413    0 00000 4717 00           425         LDP1    0,,0
   000414    001764 4706 07            426         LDP0    =O1764,DL       SSR
   000415  X 000000 4706 07            427         LDP0    CDTFSID,DL      MAKE TYPE 0
   000416    000041 3362 07            428         LCQ     =O41,DL         TURN OFF
   000417    0 00004 3563 00           429         ANSQ    4,,DR0          MID INST INT BIT
   000420    0 00001 2353 00           430         LDA     AUTOLOC,,0      NEG BASE -1
   000421    2 00001 5276 05           431         SWDX    1,AL,AUTO       BASE OF FAULT ENTRY
   000422    2 00001 7553 05           432         STA     1,AL,AUTO       BACK FOR NEXT FAULT/INT
                                       433  *
                                       434  *              RETRY AND SAVE ADDRESS, INST
                                       435  *              IF PARAM=-1
                                       436  *
   000423    1 00000 3353 00           437         LCA     0,,DRX
   000424    000001 1152 07            438         CMPA    1,DL            IS IT A MONITOR TRAP AND GOOD FPT?
   000425 (0)000430 6012 00            439         TNZ     NOTRETRY        NO
   000426    000000 7134 00            440         EXIT                    CONTINUE PMME IF DBRK
   000427    0 000 000 01 0000
   000430                              441  NOTRETRY NULL
   000430    0 00007 2353 00           442         LDA     CLNUPLOC,,0     GET TRAPALT AND AUTOPR
                                       443  *
                                       444         ENTREF  UDB$PMMEXIT
   000431  X 000000 6202 00            445         EAX0    UDB$PMMEXIT     IF NO ALT
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 17   BMAP - B00     
   000432    000000 6222 05            446         EAX2    0,AL
   000433 (0)000455 6002 00            447         TZE     NOALT
   000434    000000 2222 12            448         LDX2    0,2             WAS ADDR FIELD 0
   000435 (0)000455 6002 00            449         TZE     NOALT
   000436    000000 6222 01            450         EAX2    0,AU
   000437    0 00022 1023 00           451         CMPX2   18,,DR0         IS THE FRAME ACTIVE
   000440 (0)000455 6056 00            452         TPNZ    NOALT           NO
   000441    000 0 000 1007 00         453         MLR     (1)
   000442    0 00000 0 0 0 0400        454         ADSC9   0,,256,0
   000443  X 000000 0 0 0 0400         455         ADSC9   S_TRO_SS,,256
   000444    0 00022 7423 00           456         STX2    18,,DR0         SET 'UNWIND' AUTO PTR
                                       457         SYMREF  B$TSTACK$
   000445  X 000000 4716 00            458         LDP1    B$TSTACK$
   000446    000000 6202 05            459         EAX0    0,AL            TRAPALT UNWIND ADDRESS
   000447    0 00007 3353 00           460         LCA     CLNUPLOC,,0
   000450    000022 7312 00            461         ARS     18
   000451    1 00000 7553 00           462         STA     0,,1            FIX BASE OF USER STACK
   000452    0 00004 7403 00           463         STX0    4,,DR0          SET IC
   000453    000000 7134 00            464         EXIT                    ADIOS
   000454    0 000 000 01 0000
                                       465  *
   000455                              466  NOALT  NULL
   000455  X 000000 2352 00            467         LDA     H_GATECNT
   000456    000000 6012 11            468         TNZ     0,1             MUST CRASH IF GATES LOCKED AND NO TRAPALT
   000457  X 000000 2342 00            469         SZN     S_NSCPUA
   000460    000003 6012 04            470         TNZ     3,IC
   000461  X 000000 2352 00            471         LDA     NI$DS
   000462    000000 6012 11            472         TNZ     0,1             ALSO IF MASTER AND DISABLED
   000463    0 00004 7403 00           473         STX0    4,,DR0          SET IC
   000464    000000 7134 00            474         EXIT
   000465    0 000 000 01 0000
                                       475         INHIB   OFF
                                       476  *
                                       477         ENTDEF  HFF$TRAPALT
                                       478         ALIGN   4
   000470                              479  HFF$TRAPALT NULL
   000470    001764 4704 07            480         LDP0    =O1764,DL       SSR
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI                                                                 18   BMAP - B00     
   000471  X 000000 4704 07            481         LDP0    CDTFSID,DL      MAKE TYPE 0
   000472    0 00007 7425 00           482         SAR2    CLNUPLOC,,0     AUTO OFFSET
   000473    0 00007 4411 00           483         SXL1    CLNUPLOC,,0     AND ALT RET TO SS
   000474    000001 7100 11            484         TRA 1,1
                                       485  *
                                       486         END
 1 000000    777777777777
   000001    775777777777

  CONTROL SECTION TABLE

   0 CODE   EIGHT 000475 HFF$PROC
   1 RODATA EVEN  000002 LITERALS

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI      SYMBOL TABLE                                               19   BMAP - B00     
 41000000 000000000002 AUTO           *64       431       432
 41000000 000000000001 AUTOLOC        *70       430
 03301007 000000000000 B$TSTACK$     *457       458
 03301005 000000000000 B$UPT$        *314       315       361
 03301000 000000000000 BHF_TEMP       *52       101       103       109       110       115       117
                                      134       136       142       144       147       152       162
                                      164       170       172       175       182       190       192
                                      198       200       203       211       219       221       227
                                      229       231       241       243       249       251       253
                                      263       265       271       273       275       286       288
                                      294       296       298       306       308       310       311
                                      331
 01101000 000000000032 B_ERASE       *129       183       212
 03601002 000000000000 CDTFSID        *67       380       427       481
 01101000 000000000313 CKNOWR         319       322       324       326      *335
 01101000 000000000413 CLNUP          367       404      *424
 41000000 000000000007 CLNUPLOC       *72       402       403       412       414       442       460
                                      482       483
 01101000 000000000321 DBRKLP        *346       352
 41000000 000000000000 DR0            *63       338       388       389       390       393       399
                                      401       412       414       429       451       456       463
                                      473
 41000000 000000000003 DR3            *66       408
 41000000 000000000001 DRX            *65       366       405       437
 01101000 000000000024 DSIZ1          107      *121       127
 01101000 000000000026 DSIZ2          119      *124
 01101000 000000000135 ERASE1         205      *208
 12101000 000000000342 HFF$CHKDBRK    369      *370
 13101000 000000000000 HFF$DSIZ        44       *99       160       188       217       239       478
 12101000 000000000114 HFF$ERASE       47      *189
 12101000 000000000344 HFF$GETCLNUP   374      *376
 12101000 000000000064 HFF$NIL         46      *161
 12101000 000000000144 HFF$NILERASE    48      *218
 12101000 000000000212 HFF$PTPRES     260      *262
 12101000 000000000034 HFF$RET_PS_DESC           45      *132
 12101000 000000000470 HFF$TRAPALT    477      *479
 12101000 000000000170 HFF$WRITE       49      *240
 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI      SYMBOL TABLE                                               20   BMAP - B00     
 13101000 000000000235 HFF$WRITE1      49      *284       372
 03301002 000000000000 H_GATECNT      *54       467
 02601000 000000000000 ISRSID         *67
 03301003 000000000000 NI$DS          *55       471
 01101000 000000000105 NIL1           177      *180
 41000000 000000000103 NILFLG         *68       129
 01101000 000000000455 NOALT          447       449       452      *466
 01101000 000000000326 NODBRK         348      *351
 01101000 000000000430 NOTRETRY       439      *441
 01101000 000000000404 NO_FPTCHECKER  411      *415
 41000000 000000000001 PMMELOC        *71       406       409       417
 01101000 000000000055 PSDESC1        145      *151
 01101000 000000000051 PSDESC2       *146       156
 02601001 000000000000 PSRSID         *67
 01101000 000000000260 PTCHK          282      *305
 01101000 000000000271 PTLOOP        *316       332       365
 01101000 000000000233 PTPRES1        274      *280
 01101000 000000000304 PTWOK          317      *327
 03301006 000000000000 S$CU$         *357       358
 03301001 000000000000 S_NSCPUA       *53       469
 03301004 000000000000 S_TRO_SS       *56       455
 03201000 000000000000 UDB$PMMEXIT   *444       445
 01101000 000000000257 WRITE11        297      *303
 61000000 000000000466 _1            *160      *188      *217      *239      *478
 61000000 000000000006 _2            *160      *188      *217      *239      *478

      52 SYMBOLS

 22:24 07/29/97  FILE=HFF$PSROUT.:E05TSI      MACRO TABLE                                                21   BMAP - B00     
 ALIGN          160       188       217       239       478

       1 MACRO

    SYMBOL SPACE USED   814 WORDS
     MACRO SPACE USED    65 WORDS
   INPUT RECORDS READ   972
 STATEMENTS PROCESSED   530
         ELAPSED TIME  0:11.32
             CPU TIME     3.52 SEC.
        ASSEMBLY RATE  9034 STATEMENTS/CPU MIN.

      NO ERRORS

