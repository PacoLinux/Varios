VERSION E05

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:1    
        1        1        /*M* ASC$EXT_OPTS: Handles BUDGET and SETUP options, and CONFIG. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*   ASC$EXT_OPTS - this module consists of procedures:
       11       11                            ASC$BUDGET
       12       12                            ASC$CONFIG
       13       13        */
       14       14        /********************************************************************/
       15       15        /*                                                                   */
       16       16        /*                   ASC$BUDGET          proc                        */
       17       17        /*                                                                   */
       18       18        /*********************************************************************/
       19       19                                                              /**/
       20       20        ASC$BUDGET: PROC(CR_MOD_KEY) ;
       21       21                                                              /**/
       22       22        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:2    
       23       23        /********************************************************************/
       24       24        /*   Parameters      parameters      parameters      parameters      */
       25       25        /*********************************************************************/
       26       26                                                              /**/
       27       27    1   DCL 1 CR_MOD_KEY ALIGNED ,
       28       28    1          2 CNT UBIN(9) UNAL ,
       29       29    1          2 TEXT CHAR(20) UNAL ;
       30       30                                                              /**/
       31       31        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:3    
       32       32        /********************************************************************/
       33       33        /*   Include files   include files   include files   include files   */
       34       34        /*********************************************************************/
       35       35                                                              /**/
       36       36        %INCLUDE      XU_MACRO_C ;
       37     3142        %INCLUDE      XU_FORMAT_C ;
       38     3304        %INCLUDE      KL_SUPER_C ;
       39     6206        %INCLUDE      AS_SUPER_C ;
       40     6641        %INCLUDE      AS_MAC_C ;
       41     6721        %INCLUDE      AS_SUBS_C ;
       42     8135        %INCLUDE      AS_PERR_C;
       43     8737        %INCLUDE      AS_ENTRIES_M ;
       44     9787        %INCLUDE      CP_6 ;
       45    15346        %INCLUDE      CP_6_SUBS ;
       46    15886        %INCLUDE      AS_SUPER_R ;
       47    18902                                                              /**/
       48    18903        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:4    
       49    18904        /********************************************************************/
       50    18905        /*   Local based     local based     local based     local based     */
       51    18906        /*********************************************************************/
       52    18907                                                              /**/
       53    18908    1   DCL 1 VARY$STR ALIGNED BASED,
       54    18909    1          2 CNT UBIN BYTE UNAL,
       55    18910    1          2 TEXT CHAR(VARY$STR.CNT) UNAL;
       56    18911            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       57    18912                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       58    18957                                                              /**/
       59    18958        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:5    
       60    18959        /********************************************************************/
       61    18960        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       62    18961        /*********************************************************************/
       63    18962                                                              /**/
       64    18963    1   DCL X$PARSE ENTRY(1) ALTRET ;
       65    18964        %ASB$READ_SI ;
       66    18967        %ASB$SET_PROMPT ;
       67    18970        %ASH$HELP ;
       68    18973        %ASH$DQUEST ;
       69    18976        %ASH$QUEST ;
       70    18979        %ASH$ERROR ;
       71    18982                                                              /**/
       72    18983        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:6    
       73    18984        /********************************************************************/
       74    18985        /*   Auto data       auto data       auto data       auto data       */
       75    18986        /*********************************************************************/
       76    18987                                                              /**/
       77    18988    1   DCL ARS UBIN ;
       78    18989    1   DCL I SBIN ;
       79    18990    1   DCL SUBNODES SBIN ;
       80    18991    1   DCL MORE BIT(1) ;
       81    18992    1   DCL DUMMY BIT(1) ;
       82    18993    1   DCL P1$ PTR ;
       83    18994    1   DCL P2$ PTR;
       84    18995    1   DCL P3$ PTR ;
       85    18996    1   DCL SIGN SBIN;
       86    18997    1   DCL SUB_CODE SBIN ;
       87    18998    1   DCL VALUE(0:1) SBIN ;
       88    18999    1   DCL SUBS UBIN WORD ;
       89    19000                                                              /**/
       90    19001        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:7    
       91    19002        /********************************************************************/
       92    19003        /*   Constant data   constant data   constant data   constant data   */
       93    19004        /*********************************************************************/
       94    19005                                                              /**/
       95    19006    1   DCL 1 TEXTC(0:2) CONSTANT,
       96    19007    1          2 CNT UBIN BYTE UNAL INIT( 4, 6, 17 ),
       97    19008    1          2 TEXT CHAR(17) INIT( 'user', 'project', 'user in a project' );
       98    19009        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:8    
       99    19010        /********************************************************************/
      100    19011        /*   Procedure       procedure       procedure       procedure       */
      101    19012        /*********************************************************************/
      102    19013                                                              /**/
      103    19014        /*
      104    19015            ***            Begin procedure                    ***
      105    19016        */
      106    19017    1   P_PCB.ROOT$ = ADDR(BUDGET_S_OPT) ;
      107    19018    1   MORE = AS_TRUE ;
      108    19019    1   DUMMY = AS_TRUE ;
      109    19020                                                              /**/
      110    19021    2   DO WHILE (DUMMY) ;
      111    19022    2   BUDGET_LOOP: ;
      112    19023    3      DO WHILE (MORE) ;
      113    19024    3         REMEMBER BUDGET_LOOP IN REMEM_VAR ;
      114    19025                                                              /*  Set prompt  */
      115    19026    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;
      116    19027    3         CALL ASB$READ_SI(IN_BUF, ARS) ;         /* Read option line */
      117    19028    3         IF IN_BUF = ' '
      118    19029    3         THEN                                /* Blank input line */
      119    19030    4         DO ;
      120    19031    4            P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;
      121    19032    4            RETURN ;
      122    19033    4            END ;
      123    19034    3         P_PCB.NCHARS = ARS ;
      124    19035    3         CALL X$PARSE(P_PCB) ALTRET (BUDGET_ERR) ;
      125    19036    3         NODE$ = P_PCB.OUT$ ;
      126    19037    3         SUBNODES = P$NODE.SUBNODES ;
      127    19038    4         DO I = 0 TO SUBNODES-1 ;
      128    19039                                                              /* Check for end */
      129    19040    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;
      130    19041    4            P1$ = P$NODE.SUBLK$(I) ;
      131    19042                                                              /**/
      132    19043    5            DO SELECT (CODE) ;
      133    19044                                                              /**/
      134    19045    5               SELECT (END_VAL, BLANK_LINE_VAL) ; /* End or blank line */
      135    19046    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:9    
      136    19047    5               RETURN ;
      137    19048                                                              /**/
      138    19049    5               SELECT(HELP_VAL) ;
      139    19050    5               CALL ASH$HELP ;
      140    19051                                                              /**/
      141    19052    5               SELECT(DQUESTION_VAL) ;
      142    19053    5               CALL ASH$DQUEST ;
      143    19054                                                              /**/
      144    19055    5               SELECT(QUESTION_VAL) ;
      145    19056    5               CALL ASH$QUEST ;
      146    19057                                                              /**/
      147    19058    5               SELECT (MCHARGES_OPT_VAL) ;
      148    19059    5               ERR_CODE.CODE = 0 ;
      149    19060    5               CALL MCHARGE ;
      150    19061                                                              /**/
      151    19062    5               SELECT (ACHARGES_OPT_VAL) ;
      152    19063    5               ERR_CODE.CODE = 0 ;
      153    19064    5               CALL ACHARGE ;
      154    19065        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:10   
      155    19066    5               SELECT( PCHARGE_OPT_VAL );
      156    19067    5               IF P1$ -> P$NODE.SUBNODES = 0
      157    19068    5               THEN
      158    19069    5                  SUB_CODE = YES_VAL;
      159    19070    5               ELSE
      160    19071    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      161    19072    5               IF SUB_CODE = YES_VAL
      162    19073    6               THEN DO;
      163    19074    6                  AS_USERS.BUDGET.PCHARGES = AS_TRUE;
      164    19075    6                  AS_MOD_USER.BUDGET.PCHARGES = AS_TRUE;
      165    19076    6                  END;
      166    19077    5               ELSE
      167    19078    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.PCHARGES
      168    19079    6                  THEN DO;
      169    19080        /*E* ERROR:   ASC-E$PCHARGE_REQUIRED-C
      170    19081             MESSAGE: PCHARGES = YES is required for a %U1 you create.
      171    19082             MESSAGE1: Your project requires that PCHARGES = YES for a %U1 you create.
      172    19083        */
      173    19084    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      174    19085                          %SCREAM( ERR#=E$PCHARGE_REQUIRED,
      175    19086                          LEVEL=ERROR, MID='C' );
      176    19101    6                     END;
      177    19102    6                  ELSE DO;
      178    19103    6                     AS_USERS.BUDGET.PCHARGES = AS_FALSE;
      179    19104    6                     AS_MOD_USER.BUDGET.PCHARGES = AS_TRUE;
      180    19105    6                     END;
      181    19106        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:11   
      182    19107    5               SELECT( ICHARGE_OPT_VAL );
      183    19108    5               IF P1$ -> P$NODE.SUBNODES = 0
      184    19109    5               THEN
      185    19110    5                  SUB_CODE = YES_VAL;
      186    19111    5               ELSE
      187    19112    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      188    19113    5               IF SUB_CODE = YES_VAL
      189    19114    6               THEN DO;
      190    19115    6                  AS_USERS.BUDGET.ICHARGES = AS_TRUE;
      191    19116    6                  AS_MOD_USER.BUDGET.ICHARGES = AS_TRUE;
      192    19117    6                  END;
      193    19118    5               ELSE
      194    19119    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.ICHARGES
      195    19120    6                  THEN DO;
      196    19121        /*E* ERROR:   ASC-E$ICHARGE_REQUIRED-C
      197    19122             MESSAGE: ICHARGES = YES is required for a %U1 you create.
      198    19123             MESSAGE1: Your project requires that ICHARGES = YES for a %U1 you create.
      199    19124        */
      200    19125    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      201    19126                          %SCREAM( ERR#=E$ICHARGE_REQUIRED,
      202    19127                          LEVEL=ERROR, MID='C' );
      203    19142    6                     END;
      204    19143    6                  ELSE DO;
      205    19144    6                     AS_USERS.BUDGET.ICHARGES = AS_FALSE;
      206    19145    6                     AS_MOD_USER.BUDGET.ICHARGES = AS_TRUE;
      207    19146    6                     END;
      208    19147        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:12   
      209    19148    5               SELECT( BKACCESS_OPT_VAL );
      210    19149    5               IF P1$ -> P$NODE.SUBNODES = 0
      211    19150    5               THEN
      212    19151    5                  SUB_CODE = YES_VAL;
      213    19152    5               ELSE
      214    19153    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      215    19154    5               IF SUB_CODE = NO_VAL
      216    19155    6               THEN DO;
      217    19156    6                  AS_USERS.BUDGET.BKACC = AS_FALSE;
      218    19157    6                  AS_MOD_USER.BUDGET.BKACC = AS_TRUE;
      219    19158    6                  END;
      220    19159    5               ELSE
      221    19160    5                  IF AS_CR_MOD_PROJ > 0  AND  NOT AS_DFLT.BUDGET.BKACC
      222    19161    6                  THEN DO;
      223    19162        /*E* ERROR:   ASC-E$BKACCESS_REQUIRED-C
      224    19163             MESSAGE: BKACCESS = NO is required for a %U1 you create.
      225    19164             MESSAGE1: Your project requires that BKACCESS = NO for a %U1 you create.
      226    19165        */
      227    19166    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      228    19167                          %SCREAM( ERR#=E$BKACCESS_REQUIRED,
      229    19168                          LEVEL=ERROR, MID='C' );
      230    19183    6                     END;
      231    19184    6                  ELSE DO;
      232    19185    6                     AS_USERS.BUDGET.BKACC = AS_TRUE;
      233    19186    6                     AS_MOD_USER.BUDGET.BKACC = AS_TRUE;
      234    19187    6                     END;
      235    19188        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:13   
      236    19189    5               SELECT( BUDLIM_OPT_VAL );
      237    19190    5               IF P1$ -> P$NODE.SUBNODES = 0
      238    19191    5               THEN
      239    19192    5                  SUB_CODE = YES_VAL;
      240    19193    5               ELSE
      241    19194    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      242    19195    5               IF SUB_CODE = YES_VAL
      243    19196    6               THEN DO;
      244    19197    6                  AS_USERS.BUDGET.BUDLIM = AS_TRUE;
      245    19198    6                  AS_MOD_USER.BUDGET.BUDLIM = AS_TRUE;
      246    19199    6                  END;
      247    19200    5               ELSE
      248    19201    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.BUDLIM
      249    19202    6                  THEN DO;
      250    19203        /*E* ERROR:   ASC-E$BUDLIM_REQUIRED-C
      251    19204             MESSAGE: BUDLIM = YES is required for a %U1 you create.
      252    19205             MESSAGE1: Your project requires that BUDLIM = YES for a %U1 you create.
      253    19206        */
      254    19207    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      255    19208                          %SCREAM( ERR#=E$BUDLIM_REQUIRED,
      256    19209                          LEVEL=ERROR, MID='C' );
      257    19224    6                     END;
      258    19225    6                  ELSE DO;
      259    19226    6                     AS_USERS.BUDGET.BUDLIM = AS_FALSE;
      260    19227    6                     AS_MOD_USER.BUDGET.BUDLIM = AS_TRUE;
      261    19228    6                     END;
      262    19229        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:14   
      263    19230    5               SELECT( BLINDACCTNG_OPT_VAL );
      264    19231    5               IF P1$ -> P$NODE.SUBNODES = 0
      265    19232    5               THEN
      266    19233    5                  SUB_CODE = YES_VAL;
      267    19234    5               ELSE
      268    19235    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;
      269    19236    5               IF SUB_CODE = YES_VAL
      270    19237    6               THEN DO;
      271    19238    6                  AS_USERS.BUDGET.BLINDACCTNG = AS_TRUE;
      272    19239    6                  AS_MOD_USER.BUDGET.BLINDACCTNG = AS_TRUE;
      273    19240    6                  END;
      274    19241    5               ELSE
      275    19242    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.BLINDACCTNG
      276    19243    6                  THEN DO;
      277    19244        /*E* ERROR:   ASC-E$BLINDACCTNG_REQUIRED-C
      278    19245             MESSAGE: BLINDACCOUNTING = YES is required for a %U1 you create.
      279    19246        MESSAGE1: Your project requires that BLINDACCOUNTING = YES for a %U1 you create.
      280    19247        */
      281    19248    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      282    19249                          %SCREAM( ERR#=E$BLINDACCTNG_REQUIRED,LEVEL=ERROR,MID='C');
      283    19264    6                     END;
      284    19265    6                  ELSE DO;
      285    19266    6                     AS_USERS.BUDGET.BLINDACCTNG = AS_FALSE;
      286    19267    6                     AS_MOD_USER.BUDGET.BLINDACCTNG = AS_TRUE;
      287    19268    6                     END;
      288    19269                                                              /**/
      289    19270    5               END ;   /* Do case (code) */
      290    19271    4            END ; /* Do i */
      291    19272    3         END ; /* Do while (more) */
      292    19273                                                              /**/
      293    19274        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:15   
      294    19275    2   BUDGET_ERR: ;
      295    19276    2      CALL ASH$ERROR( P_PCB.ERROR );
      296    19277    2      END ; /* Do while (dummy) */
      297    19278                                                              /**/
      298    19279        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:16   
      299    19280                                                              /**/
      300    19281        /********************************************************************/
      301    19282        /*                                                                   */
      302    19283        /*                   Mcharge             proc                        */
      303    19284        /*                                                                   */
      304    19285        /*********************************************************************/
      305    19286                                                              /**/
      306    19287    1   MCHARGE: PROC ;
      307    19288                                                              /**/
      308    19289        /*
      309    19290            If the value input on the mcharges option line has a sign
      310    19291            associated with it,  the value is treated relative to the
      311    19292            current maxc value, or the default maxc value.  If the input
      312    19293            value does not have a sign it is treated as an absolute
      313    19294            replacement value for either the current maxc, if there is
      314    19295            one, or it replaces the default maxc.
      315    19296        */
      316    19297    2   DCL SUBNODES UBIN ;
      317    19298    2   DCL VAL SBIN;
      318    19299                                                              /**/
      319    19300                                                              /**/
      320    19301        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:17   
      321    19302        /********************************************************************/
      322    19303        /*   Procedure       procedure       procedure       procedure       */
      323    19304        /*********************************************************************/
      324    19305                                                              /**/
      325    19306        /*
      326    19307            ***            Begin procedure                    ***
      327    19308        */
      328    19309    2   AS_MOD_USER.BUDGET.MAXC = AS_TRUE;
      329    19310    2   IF P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = NONE_VAL
      330    19311    3   THEN DO;
      331    19312    3      AS_USERS.BUDGET.MAXC = -1;
      332    19313    3      AS_WILD_MVAL = -1;
      333    19314    3      AS_MOD_USER.BUDGET.SIGN = %NO#;
      334    19315    3      END;
      335    19316    3   ELSE DO;
      336    19317    4      IF P1$ -> P$NODE.SUBNODES = 1 THEN DO;
      337    19318    4         SIGN = 0;   /*  no sign on the input  */
      338    19319    4         P3$ = P1$ -> P$NODE.SUBLK$(0);
      339    19320    4         AS_MOD_USER.BUDGET.SIGN = %NO#;
      340    19321    4         END;
      341    19322    4      ELSE DO;   /*  we have a sign  */
      342    19323    4         P2$ = P1$ -> P$NODE.SUBLK$(0);  /* pts to sign node */
      343    19324    4         P3$ = P1$ -> P$NODE.SUBLK$(1); /* pts to mcharges value node */
      344    19325    4         IF P2$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = MINUS_VAL
      345    19326    4         THEN SIGN = -1;
      346    19327    4         ELSE SIGN = 1;
      347    19328    4         AS_MOD_USER.BUDGET.SIGN = %YES#;
      348    19329    4         END;
      349    19330    3      CALL CHARBIN( VALUE(0), P3$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0)->VARY$STR.TEXT );
      350    19331    3      IF P3$ -> P$NODE.SUBNODES = 1 THEN
      351    19332    3         VALUE(1) = 0;
      352    19333    4      ELSE DO;
      353    19334    4         IF P3$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->VARY$STR.CNT = 1
      354    19335    5         THEN DO;
      355    19336    5            CALL CHARBIN( VALUE(1), P3$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->VARY$STR.
             19336                     TEXT);
      356    19337    5            VALUE(1) = VALUE(1) * 10;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:18   
      357    19338    5            END;
      358    19339    4         ELSE
      359    19340    4            CALL CHARBIN(VALUE(1),SUBSTR(P3$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->
             19340                     VARY$STR.TEXT,0,2));
      360    19341    4         END;
      361    19342    3      VAL = VALUE(0) * 10000 + VALUE(1) * 100 ;
      362    19343    3      AS_WILD_MVAL = VAL ;
      363    19344    3      IF SIGN ~= 0 THEN
      364    19345    3         AS_WILD_MVAL = VAL * SIGN ;
      365    19346    4      IF VAL > 34359738300 THEN DO;
      366    19347    5         IF SIGN = -1 THEN DO;
      367    19348        /*E*   ERROR: ASC-E$MCHARGES_TOO_SML-C
      368    19349             MESSAGE: Mcharges too small.
      369    19350             MESSAGE1: Mcharges cannot be less than -3435973.83.
      370    19351        */
      371    19352                 %SCREAM( ERR#=E$MCHARGES_TOO_SML, LEVEL=ERROR, MID='C' );
      372    19367    5            END;
      373    19368    5         ELSE DO;
      374    19369        /*E*   ERROR: ASC-E$MCHARGES_TOO_BIG-C
      375    19370             MESSAGE: Mcharges too large.
      376    19371             MESSAGE1: Mcharges cannot be greater than 3435973.83.
      377    19372        */
      378    19373                 %SCREAM( ERR#=E$MCHARGES_TOO_BIG, LEVEL=ERROR, MID='C' );
      379    19388    5            END;
      380    19389    4         RETURN;
      381    19390    4         END;
      382    19391    3      IF AS_USERS.BUDGET.MAXC = -1 AND SIGN = -1
      383    19392    4      THEN DO;
      384    19393        /*E* ERROR: ASC-E$MCHARGES_ILL_VAL-C
      385    19394             MESSAGE: MCHARGES cannot be negative.
      386    19395             MESSAGE1: MCHARGES cannot be negative when previously set to NONE.
      387    19396        */
      388    19397              %SCREAM( ERR#=E$MCHARGES_ILL_VAL,LEVEL=ERROR,MID='C');
      389    19412    4         RETURN;
      390    19413    4         END;
      391    19414    3      IF SIGN = 0 THEN
      392    19415    3         AS_USERS.BUDGET.MAXC = VAL ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:19   
      393    19416    3      IF AS_USERS.BUDGET.MAXC = -1 AND SIGN = 1
      394    19417    3      THEN AS_USERS.BUDGET.MAXC = VAL;
      395    19418    4      ELSE DO;
      396    19419    4         VAL = (SIGN * VAL) + AS_USERS.BUDGET.MAXC ;
      397    19420    4         IF VAL >= 0 THEN
      398    19421    4            AS_USERS.BUDGET.MAXC = VAL ;
      399    19422    5         ELSE DO;
      400    19423        /*E*  ERROR: ASC-E$MCHARGES_NEG_VAL-C
      401    19424              MESSAGE: MCHARGES is a negative value.
      402    19425              MESSAGE1: MCHARGES cannot have a negative value.
      403    19426        */
      404    19427                 %SCREAM(ERR#=E$MCHARGES_NEG_VAL,LEVEL=ERROR,MID='C') ;
      405    19442    5            END;
      406    19443    4         END;
      407    19444    3      END;
      408    19445
      409    19446    2   IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.MAXC > 0
      410    19447    2   THEN
      411    19448    2      IF AS_USERS.BUDGET.MAXC > AS_DFLT.BUDGET.MAXC
      412    19449    3      THEN DO;
      413    19450        /*E* ERROR:   ASC-E$MCHARGES_TOO_LARGE-C
      414    19451             MESSAGE: MCHARGES greater than the maximum allowed for a %U1 you create.
      415    19452             MESSAGE1: MCHARGES = %U2.%U3 is the maximum allowed for a %U1 you create.
      416    19453                       Setting MCHARGE to %U2.%U3.
      417    19454        */
      418    19455    3         AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);
      419    19456    3         VALUE(0) = AS_DFLT.BUDGET.MAXC / 10000;
      420    19457    3         VALUE(1) = MOD( AS_DFLT.BUDGET.MAXC, 10000 ) / 100;
      421    19458              %NUMBER( NUM2="VALUE(0)", NUM3="VALUE(1)" );
             19474    3         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VALUE(0) );
             19482    3         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, VALUE(1) );
      422    19488    3         IF AS_FIELD3.COUNT = 1
      423    19489    4         THEN DO;
      424    19490    4            AS_FIELD3.COUNT = 2;
      425    19491    4            CALL INSERT( AS_FIELD3.TEXT, 1, 1, '0' );
      426    19492    4            END;
      427    19493              %SCREAM( ERR#=E$MCHARGES_TOO_LARGE, LEVEL=ERROR, MID='C' );
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:20   
      428    19508    3         AS_USERS.BUDGET.MAXC = AS_DFLT.BUDGET.MAXC;
      429    19509    3         END;
      430    19510
      431    19511    2   RETURN ;
      432    19512                                                              /**/
      433    19513    2   END   MCHARGE ;
      434    19514        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:21   
      435    19515                                                              /**/
      436    19516        /********************************************************************/
      437    19517        /*                                                                   */
      438    19518        /*                   Acharge             proc                        */
      439    19519        /*                                                                   */
      440    19520        /*********************************************************************/
      441    19521                                                              /**/
      442    19522    1   ACHARGE: PROC ;
      443    19523                                                              /**/
      444    19524    2   DCL SUBNODES UBIN ;
      445    19525    2   DCL VAL SBIN;
      446    19526    2   DCL UBIN_VAL REDEF VAL UBIN;
      447    19527    2   DCL DELTA SBIN;
      448    19528        %AS_USERS( STR_NAME=USERS_REC, STCLASS=AUTO );
      449    19706        %ASB$ENQ_USERS ;
      450    19709        %ASB$READ_USERS ;
      451    19712        %ASB$WRITE_USERS ;
      452    19715        %ASA$ERROR ;
      453    19718                                                              /**/
      454    19719                                                              /**/
      455    19720    2   IF NOT SUPERAUTH
      456    19721    3   THEN DO;
      457    19722        /*E* ERROR:   ASC-E$ACHARGES_NOT_ALLOWED-C
      458    19723        MESSAGE: The SUPERAUTH pprivilege is required to use the ACHARGES sub-option.
      459    19724        */
      460    19725           %SCREAM( ERR#=E$ACHARGES_NOT_ALLOWED, LEVEL=ERROR, MID='C' );
      461    19740    3      RETURN;
      462    19741    3      END;
      463    19742
      464    19743    2   IF P1$ -> P$NODE.SUBNODES = 1
      465    19744    3   THEN DO;
      466    19745    3      SIGN = 1;
      467    19746    3      P2$ = P1$ -> P$NODE.SUBLK$(0);
      468    19747    3      END;
      469    19748    3   ELSE DO;
      470    19749    3      IF P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = MINUS_VAL
      471    19750    3      THEN
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:22   
      472    19751    3         SIGN = -1;
      473    19752    3      ELSE
      474    19753    3         SIGN = 1;
      475    19754    3      P2$ = P1$ -> P$NODE.SUBLK$(1);
      476    19755    3      END;
      477    19756
      478    19757    2   CALL CHARBIN( VALUE(0), P2$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) -> VARY$STR.TEXT
             19757            );
      479    19758    2   IF P2$ -> P$NODE.SUBNODES = 1
      480    19759    2   THEN
      481    19760    2      VALUE(1) = 0;
      482    19761    3   ELSE DO;
      483    19762    3      P3$ = P2$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0);
      484    19763    3      IF P3$ -> VARY$STR.CNT = 1
      485    19764    4      THEN DO;
      486    19765    4         CALL CHARBIN( VALUE(1), P3$ -> VARY$STR.TEXT );
      487    19766    4         VALUE(1) = VALUE(1) * 10;
      488    19767    4         END;
      489    19768    3      ELSE
      490    19769    3         CALL CHARBIN( VALUE(1), SUBSTR(P3$->VARY$STR.TEXT,0,2) );
      491    19770    3      END;
      492    19771    2   VAL = VALUE(0) * 10000 + VALUE(1) * 100 ;
      493    19772    3   IF UBIN_VAL > 34359738300 THEN DO;
      494    19773    4      IF SIGN = -1 THEN DO;
      495    19774        /*E* ERROR: ASC-E$ACCUM_TOO_SMALL-C
      496    19775             MESSAGE: ACHARGES too small.
      497    19776             MESSAGE1: ACHARGES cannot be less than -3435973.83.
      498    19777        */
      499    19778              %SCREAM( ERR#=E$ACCUM_TOO_SMALL, LEVEL=ERROR, MID='C' );
      500    19793    4         END;
      501    19794    4      ELSE DO;
      502    19795        /*E* ERROR: ASC-E$ACCUM_TOO_BIG-C
      503    19796             MESSAGE: ACHARGES too large.
      504    19797             MESSAGE1: ACHARGES cannot be greater than 3435973.83.
      505    19798        */
      506    19799              %SCREAM( ERR#=E$ACCUM_TOO_BIG, LEVEL=ERROR, MID='C' );
      507    19814    4         END;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:23   
      508    19815    3      RETURN;
      509    19816    3      END;
      510    19817    2   VAL = SIGN * VAL;
      511    19818    2   DELTA = VAL - AS_USERS.BUDGET.ACCUM;
      512    19819    2   AS_USERS.BUDGET.ACCUM = VAL;
      513    19820    2   USERS_REC = AS_USERS;
      514    19821    3   DO WHILE(USERS_REC.BUDGET.PCHARGES AND USERS_REC.BUDGET.MACCT ~= AS_NONE);
      515    19822    3      USERS_KEY = USERS_REC.BUDGET.MACCT;
      516    19823    3      CALL ASB$ENQ_USERS ALTRET(ENQ_ERR);
      517    19824    3      CALL ASB$READ_USERS( USERS_REC ) ALTRET(READ_ERR);
      518    19825    3      USERS_REC.BUDGET.ACCUM = USERS_REC.BUDGET.ACCUM + DELTA;
      519    19826    3      CALL ASB$WRITE_USERS( USERS_REC );
      520    19827    3      END;
      521    19828    3   DO WHILE( '0'B );
      522    19829    3   READ_ERR:
      523    19830    3      CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS );
      524    19831    3      END;
      525    19832    3   DO WHILE( '0'B );
      526    19833    3   ENQ_ERR:
      527    19834    3      CALL ASH$ERROR( ERR_CODE );
      528    19835    3      END;
      529    19836    2   AS_MOD_USER.BUDGET.ACCUM = AS_TRUE;
      530    19837    2   RETURN ;
      531    19838                                                              /**/
      532    19839    2   END   ACHARGE ;
      533    19840    1   END ASC$BUDGET ;

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:24   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ASC$BUDGET.

   Procedure ASC$BUDGET requires 717 words for executable code.
   Procedure ASC$BUDGET requires 542 words of local(AUTO) storage.

    No errors detected in file ASC$BUDGET.:E05TSI    .

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:25   

 Object Unit name= ASC$BUDGET                                 File name= ASC$BUDGET.:E05TOU
 UTS= JUL 29 '97 09:30:34.52 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS     27     33  ASC$BUDGET
    3   Proc  even  none   717   1315  ASC$BUDGET
    4  RoData even  none    35     43  ASC$BUDGET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  ASC$BUDGET
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:26   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$READ_SI
 yes     yes           Std       3 ASB$SET_PROMPT
         yes           Std       0 ASH$HELP
         yes           Std       0 ASH$QUEST
         yes           Std       2 ASH$ERROR
 yes     yes           Std       1 X$PARSE
         yes           Std       0 ASH$DQUEST
         yes           Std       4 ASB$BINCHAR
 yes     yes           Std       0 ASB$ENQ_USERS
 yes     yes           Std       1 ASB$WRITE_USERS
 yes     yes           Std       1 ASB$READ_USERS
         yes           Std       3 ASA$ERROR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  CR_MOD_TREE                           BUDGET_S_OPT
r    AS_TRUE                          r    AS_FALSE                         r    AS_NONE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             IN_BUF                                NODE$
     CODE                                  SUPERAUTH                             ERR_CODE
     AS_FIELD1                             AS_FIELD2                             AS_FIELD3
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     AS_CR_MOD_PROJ                        AS_WILD_MVAL                          P_PCB
     AS_USERS                              AS_DFLT                               AS_MOD_USER
     B_VECTNIL
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:27   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:28   


        1        1        /*M* ASC$EXT_OPTS: Handles BUDGET and SETUP options, and CONFIG. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        /*   ASC$EXT_OPTS - this module consists of procedures:
       11       11                            ASC$BUDGET
       12       12                            ASC$CONFIG
       13       13        */
       14       14        /********************************************************************/
       15       15        /*                                                                   */
       16       16        /*                   ASC$BUDGET          proc                        */
       17       17        /*                                                                   */
       18       18        /*********************************************************************/
       19       19                                                              /**/
       20       20        ASC$BUDGET: PROC(CR_MOD_KEY) ;

     20  3 000000   000000 700200 xent  ASC$BUDGET   TSX0  ! X66_AUTO_1
         3 000001   001036 000001                    ZERO    542,1

       21       21                                                              /**/
       22       22        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:29   
       23       23        /********************************************************************/
       24       24        /*   Parameters      parameters      parameters      parameters      */
       25       25        /*********************************************************************/
       26       26                                                              /**/
       27       27    1   DCL 1 CR_MOD_KEY ALIGNED ,
       28       28    1          2 CNT UBIN(9) UNAL ,
       29       29    1          2 TEXT CHAR(20) UNAL ;
       30       30                                                              /**/
       31       31        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:30   
       32       32        /********************************************************************/
       33       33        /*   Include files   include files   include files   include files   */
       34       34        /*********************************************************************/
       35       35                                                              /**/
       36       36        %INCLUDE      XU_MACRO_C ;
       37     3142        %INCLUDE      XU_FORMAT_C ;
       38     3304        %INCLUDE      KL_SUPER_C ;
       39     6206        %INCLUDE      AS_SUPER_C ;
       40     6641        %INCLUDE      AS_MAC_C ;
       41     6721        %INCLUDE      AS_SUBS_C ;
       42     8135        %INCLUDE      AS_PERR_C;
       43     8737        %INCLUDE      AS_ENTRIES_M ;
       44     9787        %INCLUDE      CP_6 ;
       45    15346        %INCLUDE      CP_6_SUBS ;
       46    15886        %INCLUDE      AS_SUPER_R ;
       47    18902                                                              /**/
       48    18903        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:31   
       49    18904        /********************************************************************/
       50    18905        /*   Local based     local based     local based     local based     */
       51    18906        /*********************************************************************/
       52    18907                                                              /**/
       53    18908    1   DCL 1 VARY$STR ALIGNED BASED,
       54    18909    1          2 CNT UBIN BYTE UNAL,
       55    18910    1          2 TEXT CHAR(VARY$STR.CNT) UNAL;
       56    18911            %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       57    18912                        NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       58    18957                                                              /**/
       59    18958        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:32   
       60    18959        /********************************************************************/
       61    18960        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       62    18961        /*********************************************************************/
       63    18962                                                              /**/
       64    18963    1   DCL X$PARSE ENTRY(1) ALTRET ;
       65    18964        %ASB$READ_SI ;
       66    18967        %ASB$SET_PROMPT ;
       67    18970        %ASH$HELP ;
       68    18973        %ASH$DQUEST ;
       69    18976        %ASH$QUEST ;
       70    18979        %ASH$ERROR ;
       71    18982                                                              /**/
       72    18983        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:33   
       73    18984        /********************************************************************/
       74    18985        /*   Auto data       auto data       auto data       auto data       */
       75    18986        /*********************************************************************/
       76    18987                                                              /**/
       77    18988    1   DCL ARS UBIN ;
       78    18989    1   DCL I SBIN ;
       79    18990    1   DCL SUBNODES SBIN ;
       80    18991    1   DCL MORE BIT(1) ;
       81    18992    1   DCL DUMMY BIT(1) ;
       82    18993    1   DCL P1$ PTR ;
       83    18994    1   DCL P2$ PTR;
       84    18995    1   DCL P3$ PTR ;
       85    18996    1   DCL SIGN SBIN;
       86    18997    1   DCL SUB_CODE SBIN ;
       87    18998    1   DCL VALUE(0:1) SBIN ;
       88    18999    1   DCL SUBS UBIN WORD ;
       89    19000                                                              /**/
       90    19001        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:34   
       91    19002        /********************************************************************/
       92    19003        /*   Constant data   constant data   constant data   constant data   */
       93    19004        /*********************************************************************/
       94    19005                                                              /**/
       95    19006    1   DCL 1 TEXTC(0:2) CONSTANT,
       96    19007    1          2 CNT UBIN BYTE UNAL INIT( 4, 6, 17 ),
       97    19008    1          2 TEXT CHAR(17) INIT( 'user', 'project', 'user in a project' );
       98    19009        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:35   
       99    19010        /********************************************************************/
      100    19011        /*   Procedure       procedure       procedure       procedure       */
      101    19012        /*********************************************************************/
      102    19013                                                              /**/
      103    19014        /*
      104    19015            ***            Begin procedure                    ***
      105    19016        */
      106    19017    1   P_PCB.ROOT$ = ADDR(BUDGET_S_OPT) ;

  19017  3 000002   000000 236000 4                  LDQ     0
         3 000003   000001 756000 xsym               STQ     P_PCB+1

      107    19018    1   MORE = AS_TRUE ;

  19018  3 000004   000000 236000 xsym               LDQ     AS_TRUE
         3 000005   400000 376003                    ANQ     -131072,DU
         3 000006   200007 756100                    STQ     MORE,,AUTO

      108    19019    1   DUMMY = AS_TRUE ;

  19019  3 000007   200010 756100                    STQ     DUMMY,,AUTO

      109    19020                                                              /**/
      110    19021    2   DO WHILE (DUMMY) ;

  19021  3 000010   200010 234100                    SZN     DUMMY,,AUTO
         3 000011   000571 605000 3                  TPL     s:19277+2

  19017  3 000012                       BUDGET_LOOP  null
      111    19022    2   BUDGET_LOOP: ;
      112    19023    3      DO WHILE (MORE) ;

  19023  3 000012   200007 234100                    SZN     MORE,,AUTO
         3 000013   000563 605000 3                  TPL     BUDGET_ERR

      113    19024    3         REMEMBER BUDGET_LOOP IN REMEM_VAR ;

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:36   
  19024  3 000014   000012 635000 3                  EAA     BUDGET_LOOP
         3 000015   000000 452400 xsym               STP2    REMEM_VAR
         3 000016   000001 755000 xsym               STA     REMEM_VAR+1

      114    19025                                                              /*  Set prompt  */
      115    19026    3         CALL ASB$SET_PROMPT ( %PROMPT_SUB ) ;

  19026  3 000017   000001 630400 4                  EPPR0   1
         3 000020   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000021   000000 701000 xent               TSX1    ASB$SET_PROMPT
         3 000022   000000 011000                    NOP     0

      116    19027    3         CALL ASB$READ_SI(IN_BUF, ARS) ;         /* Read option line */

  19027  3 000023   200004 630500                    EPPR0   ARS,,AUTO
         3 000024   201033 450500                    STP0    USERS_REC+517,,AUTO
         3 000025   000002 236000 4                  LDQ     2
         3 000026   201032 756100                    STQ     USERS_REC+516,,AUTO
         3 000027   201032 630500                    EPPR0   USERS_REC+516,,AUTO
         3 000030   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000031   000000 701000 xent               TSX1    ASB$READ_SI
         3 000032   000000 011000                    NOP     0

      117    19028    3         IF IN_BUF = ' '

  19028  3 000033   040000 106400                    CMPC    fill='040'O
         3 000034   000000 000377 xsym               ADSC9   IN_BUF                   cn=0,n=255
         3 000035   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000036   000042 601000 3                  TNZ     s:19034

      118    19029    3         THEN                                /* Blank input line */
      119    19030    4         DO ;

      120    19031    4            P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;

  19031  3 000037   000003 236000 4                  LDQ     3
         3 000040   000001 756000 xsym               STQ     P_PCB+1
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:37   

      121    19032    4            RETURN ;

  19032  3 000041   000000 702200 xent               TSX2  ! X66_ARET

      122    19033    4            END ;
      123    19034    3         P_PCB.NCHARS = ARS ;

  19034  3 000042   200004 235100                    LDA     ARS,,AUTO
         3 000043   000011 755000 xsym               STA     P_PCB+9

      124    19035    3         CALL X$PARSE(P_PCB) ALTRET (BUDGET_ERR) ;

  19035  3 000044   000004 630400 4                  EPPR0   4
         3 000045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000046   000000 701000 xent               TSX1    X$PARSE
         3 000047   000563 702000 3                  TSX2    BUDGET_ERR

      125    19036    3         NODE$ = P_PCB.OUT$ ;

  19036  3 000050   000003 236000 xsym               LDQ     P_PCB+3
         3 000051   000000 756000 xsym               STQ     NODE$

      126    19037    3         SUBNODES = P$NODE.SUBNODES ;

  19037  3 000052   000000 470400 xsym               LDP0    NODE$
         3 000053   000001 236100                    LDQ     1,,PR0
         3 000054   000022 772000                    QRL     18
         3 000055   200006 756100                    STQ     SUBNODES,,AUTO

      127    19038    4         DO I = 0 TO SUBNODES-1 ;

  19038  3 000056   200005 450100                    STZ     I,,AUTO
         3 000057   000556 710000 3                  TRA     s:19271+1

      128    19039                                                              /* Check for end */
      129    19040    4            CODE = P$NODE.SUBLK$(I) -> P$NODE.CODE ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:38   

  19040  3 000060   000000 470400 xsym               LDP0    NODE$
         3 000061   200005 720100                    LXL0    I,,AUTO
         3 000062   000003 471510                    LDP1    3,X0,PR0
         3 000063   100000 236100                    LDQ     0,,PR1
         3 000064   777777 376007                    ANQ     -1,DL
         3 000065   000000 756000 xsym               STQ     CODE

      130    19041    4            P1$ = P$NODE.SUBLK$(I) ;

  19041  3 000066   000003 236110                    LDQ     3,X0,PR0
         3 000067   200011 756100                    STQ     P1$,,AUTO

      131    19042                                                              /**/
      132    19043    5            DO SELECT (CODE) ;

  19043  3 000070   000000 236000 xsym               LDQ     CODE
         3 000071   000150 116007                    CMPQ    104,DL
         3 000072   000116 602000 3                  TNC     s:19043+22
         3 000073   000166 600000 3                  TZE     s:19067
         3 000074   000454 116007                    CMPQ    300,DL
         3 000075   000105 602000 3                  TNC     s:19043+13
         3 000076   000144 600000 3                  TZE     s:19053
         3 000077   000455 116007                    CMPQ    301,DL
         3 000100   000555 602000 3                  TNC     s:19271
         3 000101   000150 600000 3                  TZE     s:19056
         3 000102   000456 116007                    CMPQ    302,DL
         3 000103   000555 601000 3                  TNZ     s:19271
         3 000104   000140 710000 3                  TRA     s:19050
         3 000105   000153 116007                    CMPQ    107,DL
         3 000106   000113 602000 3                  TNC     s:19043+19
         3 000107   000414 600000 3                  TZE     s:19190
         3 000110   000154 116007                    CMPQ    108,DL
         3 000111   000555 601000 3                  TNZ     s:19271
         3 000112   000474 710000 3                  TRA     s:19231
         3 000113   000152 116007                    CMPQ    106,DL
         3 000114   000555 601000 3                  TNZ     s:19271
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:39   
         3 000115   000332 710000 3                  TRA     s:19149
         3 000116   000144 116007                    CMPQ    100,DL
         3 000117   000124 602000 3                  TNC     s:19043+28
         3 000120   000161 600000 3                  TZE     s:19063
         3 000121   000147 116007                    CMPQ    103,DL
         3 000122   000555 601000 3                  TNZ     s:19271
         3 000123   000250 710000 3                  TRA     s:19108
         3 000124   000032 116007                    CMPQ    26,DL
         3 000125   000132 602000 3                  TNC     s:19043+34
         3 000126   000135 600000 3                  TZE     s:19046
         3 000127   000141 116007                    CMPQ    97,DL
         3 000130   000555 601000 3                  TNZ     s:19271
         3 000131   000154 710000 3                  TRA     s:19059
         3 000132   000014 116007                    CMPQ    12,DL
         3 000133   000555 601000 3                  TNZ     s:19271
         3 000134   000135 710000 3                  TRA     s:19046

      133    19044                                                              /**/
      134    19045    5               SELECT (END_VAL, BLANK_LINE_VAL) ; /* End or blank line */

      135    19046    5               P_PCB.ROOT$ = ADDR(CR_MOD_TREE) ;

  19046  3 000135   000003 236000 4                  LDQ     3
         3 000136   000001 756000 xsym               STQ     P_PCB+1

      136    19047    5               RETURN ;

  19047  3 000137   000000 702200 xent               TSX2  ! X66_ARET

      137    19048                                                              /**/
      138    19049    5               SELECT(HELP_VAL) ;

      139    19050    5               CALL ASH$HELP ;

  19050  3 000140   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000141   000000 701000 xent               TSX1    ASH$HELP
         3 000142   000000 011000                    NOP     0
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:40   
         3 000143   000555 710000 3                  TRA     s:19271

      140    19051                                                              /**/
      141    19052    5               SELECT(DQUESTION_VAL) ;

      142    19053    5               CALL ASH$DQUEST ;

  19053  3 000144   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000145   000000 701000 xent               TSX1    ASH$DQUEST
         3 000146   000000 011000                    NOP     0
         3 000147   000555 710000 3                  TRA     s:19271

      143    19054                                                              /**/
      144    19055    5               SELECT(QUESTION_VAL) ;

      145    19056    5               CALL ASH$QUEST ;

  19056  3 000150   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000151   000000 701000 xent               TSX1    ASH$QUEST
         3 000152   000000 011000                    NOP     0
         3 000153   000555 710000 3                  TRA     s:19271

      146    19057                                                              /**/
      147    19058    5               SELECT (MCHARGES_OPT_VAL) ;

      148    19059    5               ERR_CODE.CODE = 0 ;

  19059  3 000154   000005 236000 4                  LDQ     5
         3 000155   000000 356000 xsym               ANSQ    ERR_CODE

      149    19060    5               CALL MCHARGE ;

  19060  3 000156   000572 701000 3                  TSX1    MCHARGE
         3 000157   000000 011000                    NOP     0
         3 000160   000555 710000 3                  TRA     s:19271

      150    19061                                                              /**/
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:41   
      151    19062    5               SELECT (ACHARGES_OPT_VAL) ;

      152    19063    5               ERR_CODE.CODE = 0 ;

  19063  3 000161   000005 236000 4                  LDQ     5
         3 000162   000000 356000 xsym               ANSQ    ERR_CODE

      153    19064    5               CALL ACHARGE ;

  19064  3 000163   001075 701000 3                  TSX1    ACHARGE
         3 000164   000000 011000                    NOP     0
         3 000165   000555 710000 3                  TRA     s:19271

      154    19065        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:42   
      155    19066    5               SELECT( PCHARGE_OPT_VAL );

      156    19067    5               IF P1$ -> P$NODE.SUBNODES = 0

  19067  3 000166   200011 471500                    LDP1    P1$,,AUTO
         3 000167   100001 221100                    LDX1    1,,PR1
         3 000170   000174 601000 3                  TNZ     s:19071

      157    19068    5               THEN
      158    19069    5                  SUB_CODE = YES_VAL;

  19069  3 000171   000001 235007                    LDA     1,DL
         3 000172   200015 755100                    STA     SUB_CODE,,AUTO
         3 000173   000200 710000 3                  TRA     s:19072

      159    19070    5               ELSE
      160    19071    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  19071  3 000174   100003 473500                    LDP3    3,,PR1
         3 000175   300000 236100                    LDQ     0,,PR3
         3 000176   777777 376007                    ANQ     -1,DL
         3 000177   200015 756100                    STQ     SUB_CODE,,AUTO

      161    19072    5               IF SUB_CODE = YES_VAL

  19072  3 000200   200015 235100                    LDA     SUB_CODE,,AUTO
         3 000201   000001 115007                    CMPA    1,DL
         3 000202   000216 601000 3                  TNZ     s:19078

      162    19073    6               THEN DO;

      163    19074    6                  AS_USERS.BUDGET.PCHARGES = AS_TRUE;

  19074  3 000203   000000 236000 xsym               LDQ     AS_TRUE
         3 000204   000013 772000                    QRL     11
         3 000205   000017 676000 xsym               ERQ     AS_USERS+15
         3 000206   000100 376003                    ANQ     64,DU
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:43   
         3 000207   000017 656000 xsym               ERSQ    AS_USERS+15

      164    19075    6                  AS_MOD_USER.BUDGET.PCHARGES = AS_TRUE;

  19075  3 000210   000000 236000 xsym               LDQ     AS_TRUE
         3 000211   000041 772000                    QRL     33
         3 000212   000021 676000 xsym               ERQ     AS_MOD_USER+17
         3 000213   000004 376007                    ANQ     4,DL
         3 000214   000021 656000 xsym               ERSQ    AS_MOD_USER+17

      165    19076    6                  END;

  19076  3 000215   000555 710000 3                  TRA     s:19271

      166    19077    5               ELSE
      167    19078    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.PCHARGES

  19078  3 000216   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000217   000235 604400 3                  TMOZ    s:19103
         3 000220   000017 236000 xsym               LDQ     AS_DFLT+15
         3 000221   000100 316003                    CANQ    64,DU
         3 000222   000235 600000 3                  TZE     s:19103

      168    19079    6                  THEN DO;

      169    19080        /*E* ERROR:   ASC-E$PCHARGE_REQUIRED-C
      170    19081             MESSAGE: PCHARGES = YES is required for a %U1 you create.
      171    19082             MESSAGE1: Your project requires that PCHARGES = YES for a %U1 you create.
      172    19083        */
      173    19084    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  19084  3 000223   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000224   000022 402007                    MPY     18,DL
         3 000225   000000 100406                    MLR     fill='000'O
         3 000226   777773 400022 2                  ADSC9   TEXTC-5,Q                cn=2,n=18
         3 000227   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:44   
      174    19085                          %SCREAM( ERR#=E$PCHARGE_REQUIRED,
      175    19086                          LEVEL=ERROR, MID='C' );

  19098  3 000230   000006 630400 4                  EPPR0   6
         3 000231   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000232   000000 701000 xent               TSX1    ASH$ERROR
         3 000233   000000 011000                    NOP     0

      176    19101    6                     END;

  19101  3 000234   000555 710000 3                  TRA     s:19271

      177    19102    6                  ELSE DO;

      178    19103    6                     AS_USERS.BUDGET.PCHARGES = AS_FALSE;

  19103  3 000235   000000 236000 xsym               LDQ     AS_FALSE
         3 000236   000013 772000                    QRL     11
         3 000237   000017 676000 xsym               ERQ     AS_USERS+15
         3 000240   000100 376003                    ANQ     64,DU
         3 000241   000017 656000 xsym               ERSQ    AS_USERS+15

      179    19104    6                     AS_MOD_USER.BUDGET.PCHARGES = AS_TRUE;

  19104  3 000242   000000 236000 xsym               LDQ     AS_TRUE
         3 000243   000041 772000                    QRL     33
         3 000244   000021 676000 xsym               ERQ     AS_MOD_USER+17
         3 000245   000004 376007                    ANQ     4,DL
         3 000246   000021 656000 xsym               ERSQ    AS_MOD_USER+17

      180    19105    6                     END;

  19105  3 000247   000555 710000 3                  TRA     s:19271

      181    19106        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:45   
      182    19107    5               SELECT( ICHARGE_OPT_VAL );

      183    19108    5               IF P1$ -> P$NODE.SUBNODES = 0

  19108  3 000250   200011 471500                    LDP1    P1$,,AUTO
         3 000251   100001 221100                    LDX1    1,,PR1
         3 000252   000256 601000 3                  TNZ     s:19112

      184    19109    5               THEN
      185    19110    5                  SUB_CODE = YES_VAL;

  19110  3 000253   000001 235007                    LDA     1,DL
         3 000254   200015 755100                    STA     SUB_CODE,,AUTO
         3 000255   000262 710000 3                  TRA     s:19113

      186    19111    5               ELSE
      187    19112    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  19112  3 000256   100003 473500                    LDP3    3,,PR1
         3 000257   300000 236100                    LDQ     0,,PR3
         3 000260   777777 376007                    ANQ     -1,DL
         3 000261   200015 756100                    STQ     SUB_CODE,,AUTO

      188    19113    5               IF SUB_CODE = YES_VAL

  19113  3 000262   200015 235100                    LDA     SUB_CODE,,AUTO
         3 000263   000001 115007                    CMPA    1,DL
         3 000264   000300 601000 3                  TNZ     s:19119

      189    19114    6               THEN DO;

      190    19115    6                  AS_USERS.BUDGET.ICHARGES = AS_TRUE;

  19115  3 000265   000000 236000 xsym               LDQ     AS_TRUE
         3 000266   000014 772000                    QRL     12
         3 000267   000017 676000 xsym               ERQ     AS_USERS+15
         3 000270   000040 376003                    ANQ     32,DU
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:46   
         3 000271   000017 656000 xsym               ERSQ    AS_USERS+15

      191    19116    6                  AS_MOD_USER.BUDGET.ICHARGES = AS_TRUE;

  19116  3 000272   000000 236000 xsym               LDQ     AS_TRUE
         3 000273   000042 772000                    QRL     34
         3 000274   000021 676000 xsym               ERQ     AS_MOD_USER+17
         3 000275   000002 376007                    ANQ     2,DL
         3 000276   000021 656000 xsym               ERSQ    AS_MOD_USER+17

      192    19117    6                  END;

  19117  3 000277   000555 710000 3                  TRA     s:19271

      193    19118    5               ELSE
      194    19119    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.ICHARGES

  19119  3 000300   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000301   000317 604400 3                  TMOZ    s:19144
         3 000302   000017 236000 xsym               LDQ     AS_DFLT+15
         3 000303   000040 316003                    CANQ    32,DU
         3 000304   000317 600000 3                  TZE     s:19144

      195    19120    6                  THEN DO;

      196    19121        /*E* ERROR:   ASC-E$ICHARGE_REQUIRED-C
      197    19122             MESSAGE: ICHARGES = YES is required for a %U1 you create.
      198    19123             MESSAGE1: Your project requires that ICHARGES = YES for a %U1 you create.
      199    19124        */
      200    19125    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  19125  3 000305   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000306   000022 402007                    MPY     18,DL
         3 000307   000000 100406                    MLR     fill='000'O
         3 000310   777773 400022 2                  ADSC9   TEXTC-5,Q                cn=2,n=18
         3 000311   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:47   
      201    19126                          %SCREAM( ERR#=E$ICHARGE_REQUIRED,
      202    19127                          LEVEL=ERROR, MID='C' );

  19139  3 000312   000007 630400 4                  EPPR0   7
         3 000313   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000314   000000 701000 xent               TSX1    ASH$ERROR
         3 000315   000000 011000                    NOP     0

      203    19142    6                     END;

  19142  3 000316   000555 710000 3                  TRA     s:19271

      204    19143    6                  ELSE DO;

      205    19144    6                     AS_USERS.BUDGET.ICHARGES = AS_FALSE;

  19144  3 000317   000000 236000 xsym               LDQ     AS_FALSE
         3 000320   000014 772000                    QRL     12
         3 000321   000017 676000 xsym               ERQ     AS_USERS+15
         3 000322   000040 376003                    ANQ     32,DU
         3 000323   000017 656000 xsym               ERSQ    AS_USERS+15

      206    19145    6                     AS_MOD_USER.BUDGET.ICHARGES = AS_TRUE;

  19145  3 000324   000000 236000 xsym               LDQ     AS_TRUE
         3 000325   000042 772000                    QRL     34
         3 000326   000021 676000 xsym               ERQ     AS_MOD_USER+17
         3 000327   000002 376007                    ANQ     2,DL
         3 000330   000021 656000 xsym               ERSQ    AS_MOD_USER+17

      207    19146    6                     END;

  19146  3 000331   000555 710000 3                  TRA     s:19271

      208    19147        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:48   
      209    19148    5               SELECT( BKACCESS_OPT_VAL );

      210    19149    5               IF P1$ -> P$NODE.SUBNODES = 0

  19149  3 000332   200011 471500                    LDP1    P1$,,AUTO
         3 000333   100001 221100                    LDX1    1,,PR1
         3 000334   000340 601000 3                  TNZ     s:19153

      211    19150    5               THEN
      212    19151    5                  SUB_CODE = YES_VAL;

  19151  3 000335   000001 235007                    LDA     1,DL
         3 000336   200015 755100                    STA     SUB_CODE,,AUTO
         3 000337   000344 710000 3                  TRA     s:19154

      213    19152    5               ELSE
      214    19153    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  19153  3 000340   100003 473500                    LDP3    3,,PR1
         3 000341   300000 236100                    LDQ     0,,PR3
         3 000342   777777 376007                    ANQ     -1,DL
         3 000343   200015 756100                    STQ     SUB_CODE,,AUTO

      215    19154    5               IF SUB_CODE = NO_VAL

  19154  3 000344   200015 235100                    LDA     SUB_CODE,,AUTO
         3 000345   000002 115007                    CMPA    2,DL
         3 000346   000362 601000 3                  TNZ     s:19160

      216    19155    6               THEN DO;

      217    19156    6                  AS_USERS.BUDGET.BKACC = AS_FALSE;

  19156  3 000347   000000 236000 xsym               LDQ     AS_FALSE
         3 000350   000011 772000                    QRL     9
         3 000351   000017 676000 xsym               ERQ     AS_USERS+15
         3 000352   000400 376003                    ANQ     256,DU
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:49   
         3 000353   000017 656000 xsym               ERSQ    AS_USERS+15

      218    19157    6                  AS_MOD_USER.BUDGET.BKACC = AS_TRUE;

  19157  3 000354   000000 236000 xsym               LDQ     AS_TRUE
         3 000355   000043 772000                    QRL     35
         3 000356   000021 676000 xsym               ERQ     AS_MOD_USER+17
         3 000357   000001 376007                    ANQ     1,DL
         3 000360   000021 656000 xsym               ERSQ    AS_MOD_USER+17

      219    19158    6                  END;

  19158  3 000361   000555 710000 3                  TRA     s:19271

      220    19159    5               ELSE
      221    19160    5                  IF AS_CR_MOD_PROJ > 0  AND  NOT AS_DFLT.BUDGET.BKACC

  19160  3 000362   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000363   000401 604400 3                  TMOZ    s:19185
         3 000364   000017 236000 xsym               LDQ     AS_DFLT+15
         3 000365   000400 316003                    CANQ    256,DU
         3 000366   000401 601000 3                  TNZ     s:19185

      222    19161    6                  THEN DO;

      223    19162        /*E* ERROR:   ASC-E$BKACCESS_REQUIRED-C
      224    19163             MESSAGE: BKACCESS = NO is required for a %U1 you create.
      225    19164             MESSAGE1: Your project requires that BKACCESS = NO for a %U1 you create.
      226    19165        */
      227    19166    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  19166  3 000367   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000370   000022 402007                    MPY     18,DL
         3 000371   000000 100406                    MLR     fill='000'O
         3 000372   777773 400022 2                  ADSC9   TEXTC-5,Q                cn=2,n=18
         3 000373   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:50   
      228    19167                          %SCREAM( ERR#=E$BKACCESS_REQUIRED,
      229    19168                          LEVEL=ERROR, MID='C' );

  19180  3 000374   000010 630400 4                  EPPR0   8
         3 000375   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000376   000000 701000 xent               TSX1    ASH$ERROR
         3 000377   000000 011000                    NOP     0

      230    19183    6                     END;

  19183  3 000400   000555 710000 3                  TRA     s:19271

      231    19184    6                  ELSE DO;

      232    19185    6                     AS_USERS.BUDGET.BKACC = AS_TRUE;

  19185  3 000401   000000 236000 xsym               LDQ     AS_TRUE
         3 000402   000011 772000                    QRL     9
         3 000403   000017 676000 xsym               ERQ     AS_USERS+15
         3 000404   000400 376003                    ANQ     256,DU
         3 000405   000017 656000 xsym               ERSQ    AS_USERS+15

      233    19186    6                     AS_MOD_USER.BUDGET.BKACC = AS_TRUE;

  19186  3 000406   000000 236000 xsym               LDQ     AS_TRUE
         3 000407   000043 772000                    QRL     35
         3 000410   000021 676000 xsym               ERQ     AS_MOD_USER+17
         3 000411   000001 376007                    ANQ     1,DL
         3 000412   000021 656000 xsym               ERSQ    AS_MOD_USER+17

      234    19187    6                     END;

  19187  3 000413   000555 710000 3                  TRA     s:19271

      235    19188        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:51   
      236    19189    5               SELECT( BUDLIM_OPT_VAL );

      237    19190    5               IF P1$ -> P$NODE.SUBNODES = 0

  19190  3 000414   200011 471500                    LDP1    P1$,,AUTO
         3 000415   100001 221100                    LDX1    1,,PR1
         3 000416   000422 601000 3                  TNZ     s:19194

      238    19191    5               THEN
      239    19192    5                  SUB_CODE = YES_VAL;

  19192  3 000417   000001 235007                    LDA     1,DL
         3 000420   200015 755100                    STA     SUB_CODE,,AUTO
         3 000421   000426 710000 3                  TRA     s:19195

      240    19193    5               ELSE
      241    19194    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  19194  3 000422   100003 473500                    LDP3    3,,PR1
         3 000423   300000 236100                    LDQ     0,,PR3
         3 000424   777777 376007                    ANQ     -1,DL
         3 000425   200015 756100                    STQ     SUB_CODE,,AUTO

      242    19195    5               IF SUB_CODE = YES_VAL

  19195  3 000426   200015 235100                    LDA     SUB_CODE,,AUTO
         3 000427   000001 115007                    CMPA    1,DL
         3 000430   000443 601000 3                  TNZ     s:19201

      243    19196    6               THEN DO;

      244    19197    6                  AS_USERS.BUDGET.BUDLIM = AS_TRUE;

  19197  3 000431   000000 236000 xsym               LDQ     AS_TRUE
         3 000432   000012 772000                    QRL     10
         3 000433   000017 676000 xsym               ERQ     AS_USERS+15
         3 000434   000200 376003                    ANQ     128,DU
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:52   
         3 000435   000017 656000 xsym               ERSQ    AS_USERS+15

      245    19198    6                  AS_MOD_USER.BUDGET.BUDLIM = AS_TRUE;

  19198  3 000436   000000 236000 xsym               LDQ     AS_TRUE
         3 000437   000022 676000 xsym               ERQ     AS_MOD_USER+18
         3 000440   400000 376003                    ANQ     -131072,DU
         3 000441   000022 656000 xsym               ERSQ    AS_MOD_USER+18

      246    19199    6                  END;

  19199  3 000442   000555 710000 3                  TRA     s:19271

      247    19200    5               ELSE
      248    19201    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.BUDLIM

  19201  3 000443   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000444   000462 604400 3                  TMOZ    s:19226
         3 000445   000017 236000 xsym               LDQ     AS_DFLT+15
         3 000446   000200 316003                    CANQ    128,DU
         3 000447   000462 600000 3                  TZE     s:19226

      249    19202    6                  THEN DO;

      250    19203        /*E* ERROR:   ASC-E$BUDLIM_REQUIRED-C
      251    19204             MESSAGE: BUDLIM = YES is required for a %U1 you create.
      252    19205             MESSAGE1: Your project requires that BUDLIM = YES for a %U1 you create.
      253    19206        */
      254    19207    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  19207  3 000450   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000451   000022 402007                    MPY     18,DL
         3 000452   000000 100406                    MLR     fill='000'O
         3 000453   777773 400022 2                  ADSC9   TEXTC-5,Q                cn=2,n=18
         3 000454   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      255    19208                          %SCREAM( ERR#=E$BUDLIM_REQUIRED,
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:53   
      256    19209                          LEVEL=ERROR, MID='C' );

  19221  3 000455   000011 630400 4                  EPPR0   9
         3 000456   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000457   000000 701000 xent               TSX1    ASH$ERROR
         3 000460   000000 011000                    NOP     0

      257    19224    6                     END;

  19224  3 000461   000555 710000 3                  TRA     s:19271

      258    19225    6                  ELSE DO;

      259    19226    6                     AS_USERS.BUDGET.BUDLIM = AS_FALSE;

  19226  3 000462   000000 236000 xsym               LDQ     AS_FALSE
         3 000463   000012 772000                    QRL     10
         3 000464   000017 676000 xsym               ERQ     AS_USERS+15
         3 000465   000200 376003                    ANQ     128,DU
         3 000466   000017 656000 xsym               ERSQ    AS_USERS+15

      260    19227    6                     AS_MOD_USER.BUDGET.BUDLIM = AS_TRUE;

  19227  3 000467   000000 236000 xsym               LDQ     AS_TRUE
         3 000470   000022 676000 xsym               ERQ     AS_MOD_USER+18
         3 000471   400000 376003                    ANQ     -131072,DU
         3 000472   000022 656000 xsym               ERSQ    AS_MOD_USER+18

      261    19228    6                     END;

  19228  3 000473   000555 710000 3                  TRA     s:19271

      262    19229        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:54   
      263    19230    5               SELECT( BLINDACCTNG_OPT_VAL );

      264    19231    5               IF P1$ -> P$NODE.SUBNODES = 0

  19231  3 000474   200011 471500                    LDP1    P1$,,AUTO
         3 000475   100001 221100                    LDX1    1,,PR1
         3 000476   000502 601000 3                  TNZ     s:19235

      265    19232    5               THEN
      266    19233    5                  SUB_CODE = YES_VAL;

  19233  3 000477   000001 235007                    LDA     1,DL
         3 000500   200015 755100                    STA     SUB_CODE,,AUTO
         3 000501   000506 710000 3                  TRA     s:19236

      267    19234    5               ELSE
      268    19235    5                  SUB_CODE = P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE;

  19235  3 000502   100003 473500                    LDP3    3,,PR1
         3 000503   300000 236100                    LDQ     0,,PR3
         3 000504   777777 376007                    ANQ     -1,DL
         3 000505   200015 756100                    STQ     SUB_CODE,,AUTO

      269    19236    5               IF SUB_CODE = YES_VAL

  19236  3 000506   200015 235100                    LDA     SUB_CODE,,AUTO
         3 000507   000001 115007                    CMPA    1,DL
         3 000510   000524 601000 3                  TNZ     s:19242

      270    19237    6               THEN DO;

      271    19238    6                  AS_USERS.BUDGET.BLINDACCTNG = AS_TRUE;

  19238  3 000511   000000 236000 xsym               LDQ     AS_TRUE
         3 000512   000015 772000                    QRL     13
         3 000513   000017 676000 xsym               ERQ     AS_USERS+15
         3 000514   000020 376003                    ANQ     16,DU
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:55   
         3 000515   000017 656000 xsym               ERSQ    AS_USERS+15

      272    19239    6                  AS_MOD_USER.BUDGET.BLINDACCTNG = AS_TRUE;

  19239  3 000516   000000 236000 xsym               LDQ     AS_TRUE
         3 000517   000001 772000                    QRL     1
         3 000520   000022 676000 xsym               ERQ     AS_MOD_USER+18
         3 000521   200000 376003                    ANQ     65536,DU
         3 000522   000022 656000 xsym               ERSQ    AS_MOD_USER+18

      273    19240    6                  END;

  19240  3 000523   000555 710000 3                  TRA     s:19271

      274    19241    5               ELSE
      275    19242    5                  IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.BLINDACCTNG

  19242  3 000524   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000525   000543 604400 3                  TMOZ    s:19266
         3 000526   000017 236000 xsym               LDQ     AS_DFLT+15
         3 000527   000020 316003                    CANQ    16,DU
         3 000530   000543 600000 3                  TZE     s:19266

      276    19243    6                  THEN DO;

      277    19244        /*E* ERROR:   ASC-E$BLINDACCTNG_REQUIRED-C
      278    19245             MESSAGE: BLINDACCOUNTING = YES is required for a %U1 you create.
      279    19246        MESSAGE1: Your project requires that BLINDACCOUNTING = YES for a %U1 you create.
      280    19247        */
      281    19248    6                     AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  19248  3 000531   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 000532   000022 402007                    MPY     18,DL
         3 000533   000000 100406                    MLR     fill='000'O
         3 000534   777773 400022 2                  ADSC9   TEXTC-5,Q                cn=2,n=18
         3 000535   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:56   
      282    19249                          %SCREAM( ERR#=E$BLINDACCTNG_REQUIRED,LEVEL=ERROR,MID='C');

  19261  3 000536   000012 630400 4                  EPPR0   10
         3 000537   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000540   000000 701000 xent               TSX1    ASH$ERROR
         3 000541   000000 011000                    NOP     0

      283    19264    6                     END;

  19264  3 000542   000555 710000 3                  TRA     s:19271

      284    19265    6                  ELSE DO;

      285    19266    6                     AS_USERS.BUDGET.BLINDACCTNG = AS_FALSE;

  19266  3 000543   000000 236000 xsym               LDQ     AS_FALSE
         3 000544   000015 772000                    QRL     13
         3 000545   000017 676000 xsym               ERQ     AS_USERS+15
         3 000546   000020 376003                    ANQ     16,DU
         3 000547   000017 656000 xsym               ERSQ    AS_USERS+15

      286    19267    6                     AS_MOD_USER.BUDGET.BLINDACCTNG = AS_TRUE;

  19267  3 000550   000000 236000 xsym               LDQ     AS_TRUE
         3 000551   000001 772000                    QRL     1
         3 000552   000022 676000 xsym               ERQ     AS_MOD_USER+18
         3 000553   200000 376003                    ANQ     65536,DU
         3 000554   000022 656000 xsym               ERSQ    AS_MOD_USER+18

      287    19268    6                     END;

      288    19269                                                              /**/
      289    19270    5               END ;   /* Do case (code) */

      290    19271    4            END ; /* Do i */

  19271  3 000555   200005 054100                    AOS     I,,AUTO
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:57   
         3 000556   200005 236100                    LDQ     I,,AUTO
         3 000557   200006 116100                    CMPQ    SUBNODES,,AUTO
         3 000560   000060 604000 3                  TMI     s:19040

      291    19272    3         END ; /* Do while (more) */

  19272  3 000561   200007 234100                    SZN     MORE,,AUTO
         3 000562   000014 604000 3                  TMI     s:19024

  19266  3 000563                       BUDGET_ERR   null
      292    19273                                                              /**/
      293    19274        %EJECT;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:58   
      294    19275    2   BUDGET_ERR: ;
      295    19276    2      CALL ASH$ERROR( P_PCB.ERROR );

  19276  3 000563   000013 630400 4                  EPPR0   11
         3 000564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000565   000000 701000 xent               TSX1    ASH$ERROR
         3 000566   000000 011000                    NOP     0

      296    19277    2      END ; /* Do while (dummy) */

  19277  3 000567   200010 234100                    SZN     DUMMY,,AUTO
         3 000570   000012 604000 3                  TMI     BUDGET_LOOP
         3 000571   001314 710000 3                  TRA     s:19840

      297    19278                                                              /**/
      298    19279        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:59   
      299    19280                                                              /**/
      300    19281        /********************************************************************/
      301    19282        /*                                                                   */
      302    19283        /*                   Mcharge             proc                        */
      303    19284        /*                                                                   */
      304    19285        /*********************************************************************/
      305    19286                                                              /**/
      306    19287    1   MCHARGE: PROC ;

  19287  3 000572   200022 741300       MCHARGE      STX1  ! VALUE+4,,AUTO

      307    19288                                                              /**/
      308    19289        /*
      309    19290            If the value input on the mcharges option line has a sign
      310    19291            associated with it,  the value is treated relative to the
      311    19292            current maxc value, or the default maxc value.  If the input
      312    19293            value does not have a sign it is treated as an absolute
      313    19294            replacement value for either the current maxc, if there is
      314    19295            one, or it replaces the default maxc.
      315    19296        */
      316    19297    2   DCL SUBNODES UBIN ;
      317    19298    2   DCL VAL SBIN;
      318    19299                                                              /**/
      319    19300                                                              /**/
      320    19301        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:60   
      321    19302        /********************************************************************/
      322    19303        /*   Procedure       procedure       procedure       procedure       */
      323    19304        /*********************************************************************/
      324    19305                                                              /**/
      325    19306        /*
      326    19307            ***            Begin procedure                    ***
      327    19308        */
      328    19309    2   AS_MOD_USER.BUDGET.MAXC = AS_TRUE;

  19309  3 000573   000000 236000 xsym               LDQ     AS_TRUE
         3 000574   000002 772000                    QRL     2
         3 000575   000022 676000 xsym               ERQ     AS_MOD_USER+18
         3 000576   100000 376003                    ANQ     32768,DU
         3 000577   000022 656000 xsym               ERSQ    AS_MOD_USER+18

      329    19310    2   IF P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = NONE_VAL

  19310  3 000600   200011 470500                    LDP0    P1$,,AUTO
         3 000601   000003 471500                    LDP1    3,,PR0
         3 000602   100000 720100                    LXL0    0,,PR1
         3 000603   000007 100003                    CMPX0   7,DU
         3 000604   000613 601000 3                  TNZ     s:19317

      330    19311    3   THEN DO;

      331    19312    3      AS_USERS.BUDGET.MAXC = -1;

  19312  3 000605   000001 335007                    LCA     1,DL
         3 000606   000006 755000 xsym               STA     AS_USERS+6

      332    19313    3      AS_WILD_MVAL = -1;

  19313  3 000607   000000 755000 xsym               STA     AS_WILD_MVAL

      333    19314    3      AS_MOD_USER.BUDGET.SIGN = %NO#;

  19314  3 000610   000014 236000 4                  LDQ     12
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:61   
         3 000611   000022 356000 xsym               ANSQ    AS_MOD_USER+18

      334    19315    3      END;

  19315  3 000612   001006 710000 3                  TRA     s:19446

      335    19316    3   ELSE DO;

      336    19317    4      IF P1$ -> P$NODE.SUBNODES = 1 THEN DO;

  19317  3 000613   000001 222100                    LDX2    1,,PR0
         3 000614   000001 102003                    CMPX2   1,DU
         3 000615   000624 601000 3                  TNZ     s:19323

      337    19318    4         SIGN = 0;   /*  no sign on the input  */

  19318  3 000616   200014 450100                    STZ     SIGN,,AUTO

      338    19319    4         P3$ = P1$ -> P$NODE.SUBLK$(0);

  19319  3 000617   000003 236100                    LDQ     3,,PR0
         3 000620   200013 756100                    STQ     P3$,,AUTO

      339    19320    4         AS_MOD_USER.BUDGET.SIGN = %NO#;

  19320  3 000621   000014 236000 4                  LDQ     12
         3 000622   000022 356000 xsym               ANSQ    AS_MOD_USER+18

      340    19321    4         END;

  19321  3 000623   000644 710000 3                  TRA     s:19330

      341    19322    4      ELSE DO;   /*  we have a sign  */

      342    19323    4         P2$ = P1$ -> P$NODE.SUBLK$(0);  /* pts to sign node */

  19323  3 000624   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:62   
         3 000625   200012 756100                    STQ     P2$,,AUTO

      343    19324    4         P3$ = P1$ -> P$NODE.SUBLK$(1); /* pts to mcharges value node */

  19324  3 000626   000004 236100                    LDQ     4,,PR0
         3 000627   200013 756100                    STQ     P3$,,AUTO

      344    19325    4         IF P2$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = MINUS_VAL

  19325  3 000630   200012 473500                    LDP3    P2$,,AUTO
         3 000631   300003 474500                    LDP4    3,,PR3
         3 000632   400000 723100                    LXL3    0,,PR4
         3 000633   000001 103003                    CMPX3   1,DU
         3 000634   000640 601000 3                  TNZ     s:19327

      345    19326    4         THEN SIGN = -1;

  19326  3 000635   000001 335007                    LCA     1,DL
         3 000636   200014 755100                    STA     SIGN,,AUTO
         3 000637   000642 710000 3                  TRA     s:19328

      346    19327    4         ELSE SIGN = 1;

  19327  3 000640   000001 235007                    LDA     1,DL
         3 000641   200014 755100                    STA     SIGN,,AUTO

      347    19328    4         AS_MOD_USER.BUDGET.SIGN = %YES#;

  19328  3 000642   040000 236003                    LDQ     16384,DU
         3 000643   000022 256000 xsym               ORSQ    AS_MOD_USER+18

      348    19329    4         END;

      349    19330    3     CALL CHARBIN( VALUE(0), P3$->P$NODE.SUBLK$(0)->P$NODE.SUBLK$(0)->VARY$STR.TEXT );

  19330  3 000644   200013 471500                    LDP1    P3$,,AUTO
         3 000645   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:63   
         3 000646   300003 474500                    LDP4    3,,PR3
         3 000647   400000 236100                    LDQ     0,,PR4
         3 000650   000033 772000                    QRL     27
         3 000651   000000 620006                    EAX0    0,QL
         3 000652   000100 305540                    DTB
         3 000653   400000 230010                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X0
         3 000654   200016 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      350    19331    3      IF P3$ -> P$NODE.SUBNODES = 1 THEN

  19331  3 000655   100001 220100                    LDX0    1,,PR1
         3 000656   000001 100003                    CMPX0   1,DU
         3 000657   000662 601000 3                  TNZ     s:19334

      351    19332    3         VALUE(1) = 0;

  19332  3 000660   200017 450100                    STZ     VALUE+1,,AUTO
         3 000661   000707 710000 3                  TRA     s:19342

      352    19333    4      ELSE DO;

      353    19334    4         IF P3$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->VARY$STR.CNT = 1

  19334  3 000662   100004 473500                    LDP3    4,,PR1
         3 000663   300003 474500                    LDP4    3,,PR3
         3 000664   400000 236100                    LDQ     0,,PR4
         3 000665   777000 376003                    ANQ     -512,DU
         3 000666   001000 116003                    CMPQ    512,DU
         3 000667   000702 601000 3                  TNZ     s:19340

      354    19335    5         THEN DO;

      355    19336    5            CALL CHARBIN( VALUE(1), P3$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->VARY$STR.
             19336                     TEXT);

  19336  3 000670   400000 236100                    LDQ     0,,PR4
         3 000671   000033 772000                    QRL     27
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:64   
         3 000672   000000 622006                    EAX2    0,QL
         3 000673   000100 305540                    DTB
         3 000674   400000 230012                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         3 000675   200017 000004                    NDSC9   VALUE+1,,AUTO            cn=0,s=lsgnf,sf=0,n=4

      356    19337    5            VALUE(1) = VALUE(1) * 10;

  19337  3 000676   200017 236100                    LDQ     VALUE+1,,AUTO
         3 000677   000012 402007                    MPY     10,DL
         3 000700   200017 756100                    STQ     VALUE+1,,AUTO

      357    19338    5            END;

  19338  3 000701   000707 710000 3                  TRA     s:19342

      358    19339    4         ELSE
      359    19340    4            CALL CHARBIN(VALUE(1),SUBSTR(P3$->P$NODE.SUBLK$(1)->P$NODE.SUBLK$(0)->
             19340                     VARY$STR.TEXT,0,2));

  19340  3 000702   400000 236100                    LDQ     0,,PR4
         3 000703   000033 772000                    QRL     27
         3 000704   000100 305500                    DTB
         3 000705   400000 230002                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=2
         3 000706   200017 000004                    NDSC9   VALUE+1,,AUTO            cn=0,s=lsgnf,sf=0,n=4

      360    19341    4         END;

      361    19342    3      VAL = VALUE(0) * 10000 + VALUE(1) * 100 ;

  19342  3 000707   200016 236100                    LDQ     VALUE,,AUTO
         3 000710   000144 402007                    MPY     100,DL
         3 000711   200017 036100                    ADLQ    VALUE+1,,AUTO
         3 000712   000144 402007                    MPY     100,DL
         3 000713   200024 756100                    STQ     VAL,,AUTO

      362    19343    3      AS_WILD_MVAL = VAL ;

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:65   
  19343  3 000714   000000 756000 xsym               STQ     AS_WILD_MVAL

      363    19344    3      IF SIGN ~= 0 THEN

  19344  3 000715   200014 235100                    LDA     SIGN,,AUTO
         3 000716   000721 600000 3                  TZE     s:19346

      364    19345    3         AS_WILD_MVAL = VAL * SIGN ;

  19345  3 000717   200014 402100                    MPY     SIGN,,AUTO
         3 000720   000000 756000 xsym               STQ     AS_WILD_MVAL

      365    19346    4      IF VAL > 34359738300 THEN DO;

  19346  3 000721   200024 235100                    LDA     VAL,,AUTO
         3 000722   000015 115000 4                  CMPA    13
         3 000723   000742 604400 3                  TMOZ    s:19391

      366    19347    5         IF SIGN = -1 THEN DO;

  19347  3 000724   200014 235100                    LDA     SIGN,,AUTO
         3 000725   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 000726   000734 601000 3                  TNZ     s:19385

      367    19348        /*E*   ERROR: ASC-E$MCHARGES_TOO_SML-C
      368    19349             MESSAGE: Mcharges too small.
      369    19350             MESSAGE1: Mcharges cannot be less than -3435973.83.
      370    19351        */
      371    19352                 %SCREAM( ERR#=E$MCHARGES_TOO_SML, LEVEL=ERROR, MID='C' );

  19364  3 000727   000016 630400 4                  EPPR0   14
         3 000730   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000731   000000 701000 xent               TSX1    ASH$ERROR
         3 000732   000000 011000                    NOP     0

      372    19367    5            END;

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:66   
  19367  3 000733   000740 710000 3                  TRA     s:19389

      373    19368    5         ELSE DO;

      374    19369        /*E*   ERROR: ASC-E$MCHARGES_TOO_BIG-C
      375    19370             MESSAGE: Mcharges too large.
      376    19371             MESSAGE1: Mcharges cannot be greater than 3435973.83.
      377    19372        */
      378    19373                 %SCREAM( ERR#=E$MCHARGES_TOO_BIG, LEVEL=ERROR, MID='C' );

  19385  3 000734   000017 630400 4                  EPPR0   15
         3 000735   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000736   000000 701000 xent               TSX1    ASH$ERROR
         3 000737   000000 011000                    NOP     0

      379    19388    5            END;

      380    19389    4         RETURN;

  19389  3 000740   200022 221300                    LDX1  ! VALUE+4,,AUTO
         3 000741   000001 702211                    TSX2  ! 1,X1

      381    19390    4         END;
      382    19391    3      IF AS_USERS.BUDGET.MAXC = -1 AND SIGN = -1

  19391  3 000742   000006 235000 xsym               LDA     AS_USERS+6
         3 000743   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 000744   000756 601000 3                  TNZ     s:19414
         3 000745   200014 235100                    LDA     SIGN,,AUTO
         3 000746   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 000747   000756 601000 3                  TNZ     s:19414

      383    19392    4      THEN DO;

      384    19393        /*E* ERROR: ASC-E$MCHARGES_ILL_VAL-C
      385    19394             MESSAGE: MCHARGES cannot be negative.
      386    19395             MESSAGE1: MCHARGES cannot be negative when previously set to NONE.
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:67   
      387    19396        */
      388    19397              %SCREAM( ERR#=E$MCHARGES_ILL_VAL,LEVEL=ERROR,MID='C');

  19409  3 000750   000020 630400 4                  EPPR0   16
         3 000751   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000752   000000 701000 xent               TSX1    ASH$ERROR
         3 000753   000000 011000                    NOP     0

      389    19412    4         RETURN;

  19412  3 000754   200022 221300                    LDX1  ! VALUE+4,,AUTO
         3 000755   000001 702211                    TSX2  ! 1,X1

      390    19413    4         END;
      391    19414    3      IF SIGN = 0 THEN

  19414  3 000756   200014 235100                    LDA     SIGN,,AUTO
         3 000757   000762 601000 3                  TNZ     s:19416

      392    19415    3         AS_USERS.BUDGET.MAXC = VAL ;

  19415  3 000760   200024 235100                    LDA     VAL,,AUTO
         3 000761   000006 755000 xsym               STA     AS_USERS+6

      393    19416    3      IF AS_USERS.BUDGET.MAXC = -1 AND SIGN = 1

  19416  3 000762   000006 235000 xsym               LDA     AS_USERS+6
         3 000763   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 000764   000773 601000 3                  TNZ     s:19419
         3 000765   200014 235100                    LDA     SIGN,,AUTO
         3 000766   000001 115007                    CMPA    1,DL
         3 000767   000773 601000 3                  TNZ     s:19419

      394    19417    3      THEN AS_USERS.BUDGET.MAXC = VAL;

  19417  3 000770   200024 235100                    LDA     VAL,,AUTO
         3 000771   000006 755000 xsym               STA     AS_USERS+6
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:68   
         3 000772   001006 710000 3                  TRA     s:19446

      395    19418    4      ELSE DO;

      396    19419    4         VAL = (SIGN * VAL) + AS_USERS.BUDGET.MAXC ;

  19419  3 000773   200014 236100                    LDQ     SIGN,,AUTO
         3 000774   200024 402100                    MPY     VAL,,AUTO
         3 000775   000006 036000 xsym               ADLQ    AS_USERS+6
         3 000776   200024 756100                    STQ     VAL,,AUTO

      397    19420    4         IF VAL >= 0 THEN

  19420  3 000777   001002 604000 3                  TMI     s:19439

      398    19421    4            AS_USERS.BUDGET.MAXC = VAL ;

  19421  3 001000   000006 756000 xsym               STQ     AS_USERS+6
         3 001001   001006 710000 3                  TRA     s:19446

      399    19422    5         ELSE DO;

      400    19423        /*E*  ERROR: ASC-E$MCHARGES_NEG_VAL-C
      401    19424              MESSAGE: MCHARGES is a negative value.
      402    19425              MESSAGE1: MCHARGES cannot have a negative value.
      403    19426        */
      404    19427                 %SCREAM(ERR#=E$MCHARGES_NEG_VAL,LEVEL=ERROR,MID='C') ;

  19439  3 001002   000021 630400 4                  EPPR0   17
         3 001003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001004   000000 701000 xent               TSX1    ASH$ERROR
         3 001005   000000 011000                    NOP     0

      405    19442    5            END;

      406    19443    4         END;

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:69   
      407    19444    3      END;

      408    19445
      409    19446    2   IF AS_CR_MOD_PROJ > 0  AND  AS_DFLT.BUDGET.MAXC > 0

  19446  3 001006   000000 235000 xsym               LDA     AS_CR_MOD_PROJ
         3 001007   001073 604400 3                  TMOZ    s:19511
         3 001010   000006 236000 xsym               LDQ     AS_DFLT+6
         3 001011   001073 604400 3                  TMOZ    s:19511

      410    19447    2   THEN
      411    19448    2      IF AS_USERS.BUDGET.MAXC > AS_DFLT.BUDGET.MAXC

  19448  3 001012   000006 116000 xsym               CMPQ    AS_USERS+6
         3 001013   001073 605000 3                  TPL     s:19511

      412    19449    3      THEN DO;

      413    19450        /*E* ERROR:   ASC-E$MCHARGES_TOO_LARGE-C
      414    19451             MESSAGE: MCHARGES greater than the maximum allowed for a %U1 you create.
      415    19452             MESSAGE1: MCHARGES = %U2.%U3 is the maximum allowed for a %U1 you create.
      416    19453                       Setting MCHARGE to %U2.%U3.
      417    19454        */
      418    19455    3         AS_FIELD1 = TEXTC(AS_CR_MOD_PROJ-1);

  19455  3 001014   000000 236000 xsym               LDQ     AS_CR_MOD_PROJ
         3 001015   000022 402007                    MPY     18,DL
         3 001016   000000 100406                    MLR     fill='000'O
         3 001017   777773 400022 2                  ADSC9   TEXTC-5,Q                cn=2,n=18
         3 001020   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      419    19456    3         VALUE(0) = AS_DFLT.BUDGET.MAXC / 10000;

  19456  3 001021   000006 236000 xsym               LDQ     AS_DFLT+6
         3 001022   023420 506007                    DIV     10000,DL
         3 001023   200016 756100                    STQ     VALUE,,AUTO

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:70   
      420    19457    3         VALUE(1) = MOD( AS_DFLT.BUDGET.MAXC, 10000 ) / 100;

  19457  3 001024   000006 236000 xsym               LDQ     AS_DFLT+6
         3 001025   023420 506007                    DIV     10000,DL
         3 001026   000044 733000                    LRS     36
         3 001027   000144 506007                    DIV     100,DL
         3 001030   200017 756100                    STQ     VALUE+1,,AUTO

      421    19458              %NUMBER( NUM2="VALUE(0)", NUM3="VALUE(1)" );
             19474    3         CALL ASB$BINCHAR( AS_FIELD2.TEXT, 0, -2, VALUE(0) );

  19474  3 001031   200016 630500                    EPPR0   VALUE,,AUTO
         3 001032   201035 450500                    STP0    USERS_REC+519,,AUTO
         3 001033   000023 236000 4                  LDQ     19
         3 001034   201034 756100                    STQ     USERS_REC+518,,AUTO
         3 001035   000024 237000 4                  LDAQ    20
         3 001036   201032 757100                    STAQ    USERS_REC+516,,AUTO
         3 001037   201032 630500                    EPPR0   USERS_REC+516,,AUTO
         3 001040   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001041   000000 701000 xent               TSX1    ASB$BINCHAR
         3 001042   000000 011000                    NOP     0

             19482    3         CALL ASB$BINCHAR( AS_FIELD3.TEXT, 0, -3, VALUE(1) );

  19482  3 001043   200017 630500                    EPPR0   VALUE+1,,AUTO
         3 001044   201035 450500                    STP0    USERS_REC+519,,AUTO
         3 001045   000027 236000 4                  LDQ     23
         3 001046   201034 756100                    STQ     USERS_REC+518,,AUTO
         3 001047   000030 237000 4                  LDAQ    24
         3 001050   201032 757100                    STAQ    USERS_REC+516,,AUTO
         3 001051   201032 630500                    EPPR0   USERS_REC+516,,AUTO
         3 001052   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001053   000000 701000 xent               TSX1    ASB$BINCHAR
         3 001054   000000 011000                    NOP     0

      422    19488    3         IF AS_FIELD3.COUNT = 1

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:71   
  19488  3 001055   000000 236000 xsym               LDQ     AS_FIELD3
         3 001056   777000 376003                    ANQ     -512,DU
         3 001057   001000 116003                    CMPQ    512,DU
         3 001060   001065 601000 3                  TNZ     s:19505

      423    19489    4         THEN DO;

      424    19490    4            AS_FIELD3.COUNT = 2;

  19490  3 001061   002000 236003                    LDQ     1024,DU
         3 001062   000000 552040 xsym               STBQ    AS_FIELD3,'40'O

      425    19491    4            CALL INSERT( AS_FIELD3.TEXT, 1, 1, '0' );

  19491  3 001063   060000 236007                    LDQ     24576,DL
         3 001064   000000 552010 xsym               STBQ    AS_FIELD3,'10'O

      426    19492    4            END;

      427    19493              %SCREAM( ERR#=E$MCHARGES_TOO_LARGE, LEVEL=ERROR, MID='C' );

  19505  3 001065   000032 630400 4                  EPPR0   26
         3 001066   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001067   000000 701000 xent               TSX1    ASH$ERROR
         3 001070   000000 011000                    NOP     0

      428    19508    3         AS_USERS.BUDGET.MAXC = AS_DFLT.BUDGET.MAXC;

  19508  3 001071   000006 235000 xsym               LDA     AS_DFLT+6
         3 001072   000006 755000 xsym               STA     AS_USERS+6

      429    19509    3         END;

      430    19510
      431    19511    2   RETURN ;

  19511  3 001073   200022 221300                    LDX1  ! VALUE+4,,AUTO
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:72   
         3 001074   000001 702211                    TSX2  ! 1,X1

      432    19512                                                              /**/
      433    19513    2   END   MCHARGE ;
      434    19514        %EJECT ;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:73   
      435    19515                                                              /**/
      436    19516        /********************************************************************/
      437    19517        /*                                                                   */
      438    19518        /*                   Acharge             proc                        */
      439    19519        /*                                                                   */
      440    19520        /*********************************************************************/
      441    19521                                                              /**/
      442    19522    1   ACHARGE: PROC ;

  19522  3 001075   200022 741300       ACHARGE      STX1  ! VALUE+4,,AUTO

      443    19523                                                              /**/
      444    19524    2   DCL SUBNODES UBIN ;
      445    19525    2   DCL VAL SBIN;
      446    19526    2   DCL UBIN_VAL REDEF VAL UBIN;
      447    19527    2   DCL DELTA SBIN;
      448    19528        %AS_USERS( STR_NAME=USERS_REC, STCLASS=AUTO );
      449    19706        %ASB$ENQ_USERS ;
      450    19709        %ASB$READ_USERS ;
      451    19712        %ASB$WRITE_USERS ;
      452    19715        %ASA$ERROR ;
      453    19718                                                              /**/
      454    19719                                                              /**/
      455    19720    2   IF NOT SUPERAUTH

  19720  3 001076   000000 234000 xsym               SZN     SUPERAUTH
         3 001077   001106 604000 3                  TMI     s:19743

      456    19721    3   THEN DO;

      457    19722        /*E* ERROR:   ASC-E$ACHARGES_NOT_ALLOWED-C
      458    19723        MESSAGE: The SUPERAUTH pprivilege is required to use the ACHARGES sub-option.
      459    19724        */
      460    19725           %SCREAM( ERR#=E$ACHARGES_NOT_ALLOWED, LEVEL=ERROR, MID='C' );

  19737  3 001100   000033 630400 4                  EPPR0   27
         3 001101   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:74   
         3 001102   000000 701000 xent               TSX1    ASH$ERROR
         3 001103   000000 011000                    NOP     0

      461    19740    3      RETURN;

  19740  3 001104   200022 221300                    LDX1  ! VALUE+4,,AUTO
         3 001105   000001 702211                    TSX2  ! 1,X1

      462    19741    3      END;
      463    19742
      464    19743    2   IF P1$ -> P$NODE.SUBNODES = 1

  19743  3 001106   200011 470500                    LDP0    P1$,,AUTO
         3 001107   000001 220100                    LDX0    1,,PR0
         3 001110   000001 100003                    CMPX0   1,DU
         3 001111   001117 601000 3                  TNZ     s:19749

      465    19744    3   THEN DO;

      466    19745    3      SIGN = 1;

  19745  3 001112   000001 235007                    LDA     1,DL
         3 001113   200014 755100                    STA     SIGN,,AUTO

      467    19746    3      P2$ = P1$ -> P$NODE.SUBLK$(0);

  19746  3 001114   000003 236100                    LDQ     3,,PR0
         3 001115   200012 756100                    STQ     P2$,,AUTO

      468    19747    3      END;

  19747  3 001116   001132 710000 3                  TRA     s:19757

      469    19748    3   ELSE DO;

      470    19749    3      IF P1$ -> P$NODE.SUBLK$(0) -> P$NODE.CODE = MINUS_VAL

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:75   
  19749  3 001117   000003 471500                    LDP1    3,,PR0
         3 001120   100000 722100                    LXL2    0,,PR1
         3 001121   000001 102003                    CMPX2   1,DU
         3 001122   001126 601000 3                  TNZ     s:19753

      471    19750    3      THEN
      472    19751    3         SIGN = -1;

  19751  3 001123   000001 335007                    LCA     1,DL
         3 001124   200014 755100                    STA     SIGN,,AUTO
         3 001125   001130 710000 3                  TRA     s:19754

      473    19752    3      ELSE
      474    19753    3         SIGN = 1;

  19753  3 001126   000001 235007                    LDA     1,DL
         3 001127   200014 755100                    STA     SIGN,,AUTO

      475    19754    3      P2$ = P1$ -> P$NODE.SUBLK$(1);

  19754  3 001130   000004 236100                    LDQ     4,,PR0
         3 001131   200012 756100                    STQ     P2$,,AUTO

      476    19755    3      END;

      477    19756
      478    19757    2  CALL CHARBIN( VALUE(0), P2$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) -> VARY$STR.TEXT
             19757            );

  19757  3 001132   200012 471500                    LDP1    P2$,,AUTO
         3 001133   100003 473500                    LDP3    3,,PR1
         3 001134   300003 474500                    LDP4    3,,PR3
         3 001135   400000 236100                    LDQ     0,,PR4
         3 001136   000033 772000                    QRL     27
         3 001137   000000 622006                    EAX2    0,QL
         3 001140   000100 305540                    DTB
         3 001141   400000 230012                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:76   
         3 001142   200016 000004                    NDSC9   VALUE,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      479    19758    2   IF P2$ -> P$NODE.SUBNODES = 1

  19758  3 001143   100001 220100                    LDX0    1,,PR1
         3 001144   000001 100003                    CMPX0   1,DU
         3 001145   001150 601000 3                  TNZ     s:19762

      480    19759    2   THEN
      481    19760    2      VALUE(1) = 0;

  19760  3 001146   200017 450100                    STZ     VALUE+1,,AUTO
         3 001147   001177 710000 3                  TRA     s:19771

      482    19761    3   ELSE DO;

      483    19762    3      P3$ = P2$ -> P$NODE.SUBLK$(1) -> P$NODE.SUBLK$(0);

  19762  3 001150   100004 473500                    LDP3    4,,PR1
         3 001151   300003 236100                    LDQ     3,,PR3
         3 001152   200013 756100                    STQ     P3$,,AUTO

      484    19763    3      IF P3$ -> VARY$STR.CNT = 1

  19763  3 001153   200013 474500                    LDP4    P3$,,AUTO
         3 001154   400000 236100                    LDQ     0,,PR4
         3 001155   777000 376003                    ANQ     -512,DU
         3 001156   001000 116003                    CMPQ    512,DU
         3 001157   001172 601000 3                  TNZ     s:19769

      485    19764    4      THEN DO;

      486    19765    4         CALL CHARBIN( VALUE(1), P3$ -> VARY$STR.TEXT );

  19765  3 001160   400000 236100                    LDQ     0,,PR4
         3 001161   000033 772000                    QRL     27
         3 001162   000000 622006                    EAX2    0,QL
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:77   
         3 001163   000100 305540                    DTB
         3 001164   400000 230012                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=*X2
         3 001165   200017 000004                    NDSC9   VALUE+1,,AUTO            cn=0,s=lsgnf,sf=0,n=4

      487    19766    4         VALUE(1) = VALUE(1) * 10;

  19766  3 001166   200017 236100                    LDQ     VALUE+1,,AUTO
         3 001167   000012 402007                    MPY     10,DL
         3 001170   200017 756100                    STQ     VALUE+1,,AUTO

      488    19767    4         END;

  19767  3 001171   001177 710000 3                  TRA     s:19771

      489    19768    3      ELSE
      490    19769    3         CALL CHARBIN( VALUE(1), SUBSTR(P3$->VARY$STR.TEXT,0,2) );

  19769  3 001172   400000 236100                    LDQ     0,,PR4
         3 001173   000033 772000                    QRL     27
         3 001174   000100 305500                    DTB
         3 001175   400000 230002                    NDSC9   0,,PR4                   cn=1,s=nosgn,sf=0,n=2
         3 001176   200017 000004                    NDSC9   VALUE+1,,AUTO            cn=0,s=lsgnf,sf=0,n=4

      491    19770    3      END;

      492    19771    2   VAL = VALUE(0) * 10000 + VALUE(1) * 100 ;

  19771  3 001177   200016 236100                    LDQ     VALUE,,AUTO
         3 001200   000144 402007                    MPY     100,DL
         3 001201   200017 036100                    ADLQ    VALUE+1,,AUTO
         3 001202   000144 402007                    MPY     100,DL
         3 001203   200024 756100                    STQ     VAL,,AUTO

      493    19772    3   IF UBIN_VAL > 34359738300 THEN DO;

  19772  3 001204   200024 235100                    LDA     VAL,,AUTO
         3 001205   000034 115000 4                  CMPA    28
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:78   
         3 001206   001225 602000 3                  TNC     s:19817

      494    19773    4      IF SIGN = -1 THEN DO;

  19773  3 001207   200014 235100                    LDA     SIGN,,AUTO
         3 001210   000027 115000 xsym               CMPA    B_VECTNIL+23
         3 001211   001217 601000 3                  TNZ     s:19811

      495    19774        /*E* ERROR: ASC-E$ACCUM_TOO_SMALL-C
      496    19775             MESSAGE: ACHARGES too small.
      497    19776             MESSAGE1: ACHARGES cannot be less than -3435973.83.
      498    19777        */
      499    19778              %SCREAM( ERR#=E$ACCUM_TOO_SMALL, LEVEL=ERROR, MID='C' );

  19790  3 001212   000035 630400 4                  EPPR0   29
         3 001213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001214   000000 701000 xent               TSX1    ASH$ERROR
         3 001215   000000 011000                    NOP     0

      500    19793    4         END;

  19793  3 001216   001223 710000 3                  TRA     s:19815

      501    19794    4      ELSE DO;

      502    19795        /*E* ERROR: ASC-E$ACCUM_TOO_BIG-C
      503    19796             MESSAGE: ACHARGES too large.
      504    19797             MESSAGE1: ACHARGES cannot be greater than 3435973.83.
      505    19798        */
      506    19799              %SCREAM( ERR#=E$ACCUM_TOO_BIG, LEVEL=ERROR, MID='C' );

  19811  3 001217   000036 630400 4                  EPPR0   30
         3 001220   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001221   000000 701000 xent               TSX1    ASH$ERROR
         3 001222   000000 011000                    NOP     0

      507    19814    4         END;
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:79   

      508    19815    3      RETURN;

  19815  3 001223   200022 221300                    LDX1  ! VALUE+4,,AUTO
         3 001224   000001 702211                    TSX2  ! 1,X1

      509    19816    3      END;
      510    19817    2   VAL = SIGN * VAL;

  19817  3 001225   200014 402100                    MPY     SIGN,,AUTO
         3 001226   200024 756100                    STQ     VAL,,AUTO

      511    19818    2   DELTA = VAL - AS_USERS.BUDGET.ACCUM;

  19818  3 001227   000007 136000 xsym               SBLQ    AS_USERS+7
         3 001230   200025 756100                    STQ     DELTA,,AUTO

      512    19819    2   AS_USERS.BUDGET.ACCUM = VAL;

  19819  3 001231   200024 235100                    LDA     VAL,,AUTO
         3 001232   000007 755000 xsym               STA     AS_USERS+7

      513    19820    2   USERS_REC = AS_USERS;

  19820  3 001233   000100 100400                    MLR     fill='000'O
         3 001234   000000 004020 xsym               ADSC9   AS_USERS                 cn=0,n=2064
         3 001235   200026 004020                    ADSC9   USERS_REC,,AUTO          cn=0,n=2064

      514    19821    3   DO WHILE(USERS_REC.BUDGET.PCHARGES AND USERS_REC.BUDGET.MACCT ~= AS_NONE);

  19821  3 001236   001264 710000 3                  TRA     s:19827

      515    19822    3      USERS_KEY = USERS_REC.BUDGET.MACCT;

  19822  3 001237   000000 100500                    MLR     fill='000'O
         3 001240   200040 000025                    ADSC9   USERS_REC+10,,AUTO       cn=0,n=21
         3 001241   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:80   

      516    19823    3      CALL ASB$ENQ_USERS ALTRET(ENQ_ERR);

  19823  3 001242   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 001243   000000 701000 xent               TSX1    ASB$ENQ_USERS
         3 001244   001301 702000 3                  TSX2    ENQ_ERR

      517    19824    3      CALL ASB$READ_USERS( USERS_REC ) ALTRET(READ_ERR);

  19824  3 001245   200026 630500                    EPPR0   USERS_REC,,AUTO
         3 001246   201032 450500                    STP0    USERS_REC+516,,AUTO
         3 001247   201032 630500                    EPPR0   USERS_REC+516,,AUTO
         3 001250   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001251   000000 701000 xent               TSX1    ASB$READ_USERS
         3 001252   001274 702000 3                  TSX2    READ_ERR

      518    19825    3      USERS_REC.BUDGET.ACCUM = USERS_REC.BUDGET.ACCUM + DELTA;

  19825  3 001253   200035 236100                    LDQ     USERS_REC+7,,AUTO
         3 001254   200025 036100                    ADLQ    DELTA,,AUTO
         3 001255   200035 756100                    STQ     USERS_REC+7,,AUTO

      519    19826    3      CALL ASB$WRITE_USERS( USERS_REC );

  19826  3 001256   200026 630500                    EPPR0   USERS_REC,,AUTO
         3 001257   201032 450500                    STP0    USERS_REC+516,,AUTO
         3 001260   201032 630500                    EPPR0   USERS_REC+516,,AUTO
         3 001261   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001262   000000 701000 xent               TSX1    ASB$WRITE_USERS
         3 001263   000000 011000                    NOP     0

      520    19827    3      END;

  19827  3 001264   200045 236100                    LDQ     USERS_REC+15,,AUTO
         3 001265   000100 316003                    CANQ    64,DU
         3 001266   001273 600000 3                  TZE     s:19828
         3 001267   000000 106500                    CMPC    fill='000'O
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:81   
         3 001270   200040 000025                    ADSC9   USERS_REC+10,,AUTO       cn=0,n=21
         3 001271   000000 000025 xsym               ADSC9   AS_NONE                  cn=0,n=21
         3 001272   001237 601000 3                  TNZ     s:19822

      521    19828    3   DO WHILE( '0'B );

  19828  3 001273   001300 710000 3                  TRA     s:19832

      522    19829    3   READ_ERR:
      523    19830    3      CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_USERS );

  19830  3 001274   000040 630400 4     READ_ERR     EPPR0   32
         3 001275   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001276   000000 701000 xent               TSX1    ASA$ERROR
         3 001277   000000 011000                    NOP     0

      524    19831    3      END;

      525    19832    3   DO WHILE( '0'B );

  19832  3 001300   001305 710000 3                  TRA     s:19836

      526    19833    3   ENQ_ERR:
      527    19834    3      CALL ASH$ERROR( ERR_CODE );

  19834  3 001301   000042 630400 4     ENQ_ERR      EPPR0   34
         3 001302   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001303   000000 701000 xent               TSX1    ASH$ERROR
         3 001304   000000 011000                    NOP     0

      528    19835    3      END;

      529    19836    2   AS_MOD_USER.BUDGET.ACCUM = AS_TRUE;

  19836  3 001305   000000 236000 xsym               LDQ     AS_TRUE
         3 001306   000005 772000                    QRL     5
         3 001307   000022 676000 xsym               ERQ     AS_MOD_USER+18
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:82   
         3 001310   010000 376003                    ANQ     4096,DU
         3 001311   000022 656000 xsym               ERSQ    AS_MOD_USER+18

      530    19837    2   RETURN ;

  19837  3 001312   200022 221300                    LDX1  ! VALUE+4,,AUTO
         3 001313   000001 702211                    TSX2  ! 1,X1

      531    19838                                                              /**/
      532    19839    2   END   ACHARGE ;
      533    19840    1   END ASC$BUDGET ;

  19840  3 001314   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:83   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ASC$BUDGET.
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:84   

 **** Variables and constants ****

  ****  Section 002 RoData ASC$BUDGET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(162)   r     1 TEXTC(0:2)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CR_MOD_KEY                4-0-0/w UBIN        r     1 ARS
    *0-0-0/w STRC(189)   r     1 CR_MOD_KEY                25-0-0/w SBIN        r     1 DELTA
    10-0-0/b BIT         r     1 DUMMY                      5-0-0/w SBIN        r     1 I
     7-0-0/b BIT         r     1 MORE                      11-0-0/w PTR         r     1 P1$
    12-0-0/w PTR         r     1 P2$                       13-0-0/w PTR         r     1 P3$
    14-0-0/w SBIN        r     1 SIGN                       6-0-0/w SBIN        r     1 SUBNODES
    15-0-0/w SBIN        r     1 SUB_CODE                  24-0-0/w UBIN        r     1 UBIN_VAL
    26-0-0/w STRC(18576) r     1 USERS_REC                 24-0-0/w SBIN        r     1 VAL
    24-0-0/w SBIN        r     1 VAL                       16-0-0/w SBIN        r     1 VALUE(0:1)

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 AS_CR_MOD_PROJ             0-0-0/w STRC(18576) r     1 AS_DFLT
     0-0-0/b BIT         r     1 AS_FALSE                   0-0-0/w STRC(369)   r     1 AS_FIELD1
     0-0-0/w STRC(369)   r     1 AS_FIELD2                  0-0-0/w STRC(369)   r     1 AS_FIELD3
     0-0-0/w STRC(1483)  r     1 AS_MOD_USER                0-0-0/c STRC(189)   r     1 AS_NONE
     0-0-0/b BIT         r     1 AS_TRUE                    0-0-0/w STRC(18576) r     1 AS_USERS
     0-0-0/w SBIN        r     1 AS_WILD_MVAL               0-0-0/w UBIN        r     1 BUDGET_S_OPT
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w UBIN        r     1 CR_MOD_TREE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c CHAR(255)   r     1 IN_BUF
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:85   
     0-0-0/w PTR         r     1 NODE$                      0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/d REMB        r     1 REMEM_VAR                  0-0-0/b BIT         r     1 SUPERAUTH
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 P$NODE                     0-0-0/w ASTR(9)     r     1 VARY$STR


   Procedure ASC$BUDGET requires 717 words for executable code.
   Procedure ASC$BUDGET requires 542 words of local(AUTO) storage.

    No errors detected in file ASC$BUDGET.:E05TSI    .
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:86   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:87   
          MINI XREF LISTING

ACHARGE
     19522**PROC    19064--CALL
ARS
     18988**DCL     19027<>CALL    19034>>ASSIGN
ASA$ERROR IN PROCEDURE ACHARGE
     19716**DCL-ENT 19830--CALL
ASA_BRKS_LOC
     16050**DCL     16050--REDEF
ASB$BINCHAR
      6719**DCL-ENT 19474--CALL    19482--CALL
ASB$ENQ_USERS IN PROCEDURE ACHARGE
     19707**DCL-ENT 19823--CALL
ASB$READ_SI
     18965**DCL-ENT 19027--CALL
ASB$READ_USERS IN PROCEDURE ACHARGE
     19710**DCL-ENT 19824--CALL
ASB$SET_PROMPT
     18968**DCL-ENT 19026--CALL
ASB$WRITE_USERS IN PROCEDURE ACHARGE
     19713**DCL-ENT 19826--CALL
ASH$DQUEST
     18974**DCL-ENT 19053--CALL
ASH$ERROR
     18980**DCL-ENT 19098--CALL    19139--CALL    19180--CALL    19221--CALL    19261--CALL    19276--CALL
     19364--CALL    19385--CALL    19409--CALL    19439--CALL    19505--CALL    19737--CALL    19790--CALL
     19811--CALL    19834--CALL
ASH$HELP
     18971**DCL-ENT 19050--CALL
ASH$QUEST
     18977**DCL-ENT 19056--CALL
AS_CR_MOD_PROJ
     16058**DCL     19078>>IF      19084>>ASSIGN  19119>>IF      19125>>ASSIGN  19160>>IF      19166>>ASSIGN
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:88   
     19201>>IF      19207>>ASSIGN  19242>>IF      19248>>ASSIGN  19446>>IF      19455>>ASSIGN
AS_DEFAULT.BANNER_PERM
     16743**DCL     16744--REDEF
AS_DEFAULT.BUDGET.MACCT
     16648**DCL     16652--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     16661**DCL     16664--REDEF
AS_DEFAULT.BUDGET.PACCUM
     16644**DCL     16646--REDEF
AS_DEFAULT.BUDGET.PMAXC
     16639**DCL     16641--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     16759**DCL     16760--REDEF   16761--REDEF
AS_DEFAULT_DREC.PASSWORD
     18013**DCL     18017--REDEF
AS_DEFAULT_DREC.RENAME
     18036**DCL     18037--REDEF
AS_DFLT.BANNER_PERM
     16565**DCL     16566--REDEF
AS_DFLT.BUDGET.BKACC
     16477**DCL     19160>>IF
AS_DFLT.BUDGET.BLINDACCTNG
     16481**DCL     19242>>IF
AS_DFLT.BUDGET.BUDLIM
     16478**DCL     19201>>IF
AS_DFLT.BUDGET.ICHARGES
     16480**DCL     19119>>IF
AS_DFLT.BUDGET.MACCT
     16470**DCL     16474--REDEF
AS_DFLT.BUDGET.MAXC
     16459**DCL     19446>>IF      19448>>IF      19456>>ASSIGN  19457>>ASSIGN  19508>>ASSIGN
AS_DFLT.BUDGET.MAX_PROJECTS
     16483**DCL     16486--REDEF
AS_DFLT.BUDGET.PACCUM
     16466**DCL     16468--REDEF
AS_DFLT.BUDGET.PCHARGES
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:89   
     16479**DCL     19078>>IF
AS_DFLT.BUDGET.PMAXC
     16461**DCL     16463--REDEF
AS_DFLT.SETUP_CHRA.TXT
     16581**DCL     16582--REDEF   16583--REDEF
AS_FALSE
     15910**DCL     19103>>ASSIGN  19144>>ASSIGN  19156>>ASSIGN  19226>>ASSIGN  19266>>ASSIGN
AS_FE_MODE
     15916**DCL     15917--REDEF
AS_FIELD1
     16046**DCL     19084<<ASSIGN  19125<<ASSIGN  19166<<ASSIGN  19207<<ASSIGN  19248<<ASSIGN  19455<<ASSIGN
AS_FIELD2.TEXT
     16047**DCL     19474<>CALL
AS_FIELD3.COUNT
     16048**DCL     19488>>IF      19490<<ASSIGN
AS_FIELD3.TEXT
     16048**DCL     19482<>CALL    19491<<CALLBLT
AS_MODE
     15913**DCL     15915--REDEF
AS_MOD_USER.ACCESS
     18778**DCL     18779--REDEF
AS_MOD_USER.BANNER
     18765**DCL     18766--REDEF
AS_MOD_USER.BANNER_PERM
     18767**DCL     18768--REDEF
AS_MOD_USER.BILL
     18773**DCL     18774--REDEF
AS_MOD_USER.BUDGET.ACCUM
     18801**DCL     19836<<ASSIGN
AS_MOD_USER.BUDGET.BKACC
     18795**DCL     19157<<ASSIGN  19186<<ASSIGN
AS_MOD_USER.BUDGET.BLINDACCTNG
     18797**DCL     19239<<ASSIGN  19267<<ASSIGN
AS_MOD_USER.BUDGET.BUDLIM
     18796**DCL     19198<<ASSIGN  19227<<ASSIGN
AS_MOD_USER.BUDGET.ICHARGES
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:90   
     18794**DCL     19116<<ASSIGN  19145<<ASSIGN
AS_MOD_USER.BUDGET.MAXC
     18798**DCL     19309<<ASSIGN
AS_MOD_USER.BUDGET.PCHARGES
     18793**DCL     19075<<ASSIGN  19104<<ASSIGN
AS_MOD_USER.BUDGET.SIGN
     18799**DCL     19314<<ASSIGN  19320<<ASSIGN  19328<<ASSIGN
AS_MOD_USER.CPROC
     18769**DCL     18770--REDEF
AS_MOD_USER.FEBILL
     18849**DCL     18850--REDEF
AS_MOD_USER.FECXTMEM
     18866**DCL     18867--REDEF
AS_MOD_USER.FEMINTS
     18851**DCL     18852--REDEF
AS_MOD_USER.FEMMEM
     18862**DCL     18863--REDEF
AS_MOD_USER.FEMTIME
     18860**DCL     18861--REDEF
AS_MOD_USER.FEPPRIV
     18857**DCL     18859--REDEF
AS_MOD_USER.FEPRIV
     18854**DCL     18856--REDEF
AS_MOD_USER.FORCE_BIT
     18763**DCL     18764--REDEF
AS_MOD_USER.KEY
     18845**DCL     18847--REDEF
AS_MOD_USER.LASTCPROC
     18771**DCL     18772--REDEF
AS_MOD_USER.LIMITS.DO_
     18819**DCL     18820--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     18835**DCL     18836--REDEF
AS_MOD_USER.LIMITS.LO
     18815**DCL     18816--REDEF
AS_MOD_USER.LIMITS.MEM
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:91   
     18811**DCL     18812--REDEF
AS_MOD_USER.LIMITS.MPRIO
     18839**DCL     18840--REDEF
AS_MOD_USER.LIMITS.PDIS
     18827**DCL     18828--REDEF
AS_MOD_USER.LIMITS.PO
     18823**DCL     18824--REDEF
AS_MOD_USER.LIMITS.TDIS
     18831**DCL     18832--REDEF
AS_MOD_USER.LIMITS.TIME
     18807**DCL     18808--REDEF
AS_MOD_USER.MAXENQ
     18788**DCL     18789--REDEF
AS_MOD_USER.PERM_BIT
     18761**DCL     18762--REDEF
AS_MOD_USER.PPRIV
     18783**DCL     18785--REDEF
AS_MOD_USER.PRIOB
     18790**DCL     18791--REDEF
AS_MOD_USER.PRIV
     18780**DCL     18782--REDEF
AS_MOD_USER.QUAN
     18786**DCL     18787--REDEF
AS_MOD_USER.SETUP
     18759**DCL     18760--REDEF
AS_NONE
     15911**DCL     19821>>DOWHILE
AS_PROJECT.BANNER_PERM
     17099**DCL     17100--REDEF
AS_PROJECT.BUDGET.MACCT
     17004**DCL     17008--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     17017**DCL     17020--REDEF
AS_PROJECT.BUDGET.PACCUM
     17000**DCL     17002--REDEF
AS_PROJECT.BUDGET.PMAXC
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:92   
     16995**DCL     16997--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     17115**DCL     17116--REDEF   17117--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     17277**DCL     17278--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     17182**DCL     17186--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     17195**DCL     17198--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     17178**DCL     17180--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     17173**DCL     17175--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     17293**DCL     17294--REDEF   17295--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     18499**DCL     18503--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     18522**DCL     18523--REDEF
AS_PROJECT_DREC.PASSWORD
     18337**DCL     18341--REDEF
AS_PROJECT_DREC.RENAME
     18360**DCL     18361--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     16921**DCL     16922--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     16826**DCL     16830--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     16839**DCL     16842--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     16822**DCL     16824--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     16817**DCL     16819--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     16937**DCL     16938--REDEF   16939--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:93   
     18175**DCL     18179--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     18198**DCL     18199--REDEF
AS_TRUE
     15910**DCL     19018>>ASSIGN  19019>>ASSIGN  19074>>ASSIGN  19075>>ASSIGN  19104>>ASSIGN  19115>>ASSIGN
     19116>>ASSIGN  19145>>ASSIGN  19157>>ASSIGN  19185>>ASSIGN  19186>>ASSIGN  19197>>ASSIGN  19198>>ASSIGN
     19227>>ASSIGN  19238>>ASSIGN  19239>>ASSIGN  19267>>ASSIGN  19309>>ASSIGN  19836>>ASSIGN
AS_USERS
     16272**DCL     19820>>ASSIGN
AS_USERS.BANNER_PERM
     16387**DCL     16388--REDEF
AS_USERS.BUDGET.ACCUM
     16282**DCL     19818>>ASSIGN  19819<<ASSIGN
AS_USERS.BUDGET.BKACC
     16299**DCL     19156<<ASSIGN  19185<<ASSIGN
AS_USERS.BUDGET.BLINDACCTNG
     16303**DCL     19238<<ASSIGN  19266<<ASSIGN
AS_USERS.BUDGET.BUDLIM
     16300**DCL     19197<<ASSIGN  19226<<ASSIGN
AS_USERS.BUDGET.ICHARGES
     16302**DCL     19115<<ASSIGN  19144<<ASSIGN
AS_USERS.BUDGET.MACCT
     16292**DCL     16296--REDEF
AS_USERS.BUDGET.MAXC
     16281**DCL     19312<<ASSIGN  19391>>IF      19415<<ASSIGN  19416>>IF      19417<<ASSIGN  19419>>ASSIGN
     19421<<ASSIGN  19448>>IF      19508<<ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS
     16305**DCL     16308--REDEF
AS_USERS.BUDGET.PACCUM
     16288**DCL     16290--REDEF
AS_USERS.BUDGET.PCHARGES
     16301**DCL     19074<<ASSIGN  19103<<ASSIGN
AS_USERS.BUDGET.PMAXC
     16283**DCL     16285--REDEF
AS_USERS.SETUP_CHRA.TXT
     16403**DCL     16404--REDEF   16405--REDEF
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:94   
AS_USERS_CONSTANT.BANNER_PERM
     17455**DCL     17456--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     17360**DCL     17364--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     17373**DCL     17376--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     17356**DCL     17358--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     17351**DCL     17353--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     17471**DCL     17472--REDEF   17473--REDEF
AS_WILD_MVAL
     16059**DCL     19313<<ASSIGN  19343<<ASSIGN  19345<<ASSIGN
BUDGET_ERR
     19266**LABEL   19035--CALLALT
BUDGET_LOOP
     19017**LABEL   19024--REMEMBR
BUDGET_S_OPT
     15903**DCL     19017--ASSIGN
CODE
     16043**DCL     19040<<ASSIGN  19043>>DOSELCT
CR_MOD_KEY
        27**DCL        20--PROC
CR_MOD_TREE
     15902**DCL     19031--ASSIGN  19046--ASSIGN
DELTA IN PROCEDURE ACHARGE
     19527**DCL     19818<<ASSIGN  19825>>ASSIGN
DUMMY
     18992**DCL     19019<<ASSIGN  19021>>DOWHILE
ENQ_ERR IN PROCEDURE ACHARGE
     19834**LABEL   19823--CALLALT
ERR_CODE
     16045**DCL     16046--REDEF   19834<>CALL
ERR_CODE.CODE
     16045**DCL     19059<<ASSIGN  19063<<ASSIGN
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:95   
I
     18989**DCL     19038<<DOINDEX 19040>>ASSIGN  19041>>ASSIGN
IN_BUF
     16041**DCL     19027<>CALL    19028>>IF
KL_DEFAULT.PASSWORD
     18661**DCL     18665--REDEF
KL_DEFAULT.RENAME
     18684**DCL     18685--REDEF
KL_DFLT.PASSWORD
     17851**DCL     17855--REDEF
KL_DFLT.RENAME
     17874**DCL     17875--REDEF
KL_DREC.PASSWORD
     17689**DCL     17693--REDEF
KL_DREC.RENAME
     17712**DCL     17713--REDEF
KL_DREC_CNT.PASSWORD
     17576**DCL     17580--REDEF
KL_DREC_CNT.RENAME
     17599**DCL     17600--REDEF
MCHARGE
     19287**PROC    19060--CALL
MORE
     18991**DCL     19018<<ASSIGN  19023>>DOWHILE
NODE$
     16043**DCL     18918--IMP-PTR 19036<<ASSIGN  19037>>ASSIGN  19040>>ASSIGN  19041>>ASSIGN
P$NODE.CODE
     18926**DCL     19040>>ASSIGN  19071>>ASSIGN  19112>>ASSIGN  19153>>ASSIGN  19194>>ASSIGN  19235>>ASSIGN
     19310>>IF      19325>>IF      19749>>IF
P$NODE.SUBLK$
     18951**DCL     19040>>ASSIGN  19041>>ASSIGN  19071>>ASSIGN  19112>>ASSIGN  19153>>ASSIGN  19194>>ASSIGN
     19235>>ASSIGN  19310>>IF      19319>>ASSIGN  19323>>ASSIGN  19324>>ASSIGN  19325>>IF      19330>>CALLBLT
     19330>>CALLBLT 19330>>CALLBLT 19330>>CALLBLT 19334>>IF      19334>>IF      19336>>CALLBLT 19336>>CALLBLT
     19336>>CALLBLT 19336>>CALLBLT 19340>>CALLBLT 19340>>CALLBLT 19340>>CALLBLT 19340>>CALLBLT 19746>>ASSIGN
     19749>>IF      19754>>ASSIGN  19757>>CALLBLT 19757>>CALLBLT 19757>>CALLBLT 19757>>CALLBLT 19762>>ASSIGN
     19762>>ASSIGN
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:96   
P$NODE.SUBNODES
     18930**DCL     19037>>ASSIGN  19067>>IF      19108>>IF      19149>>IF      19190>>IF      19231>>IF
     19317>>IF      19331>>IF      19743>>IF      19758>>IF
P1$
     18993**DCL     19041<<ASSIGN  19067>>IF      19071>>ASSIGN  19108>>IF      19112>>ASSIGN  19149>>IF
     19153>>ASSIGN  19190>>IF      19194>>ASSIGN  19231>>IF      19235>>ASSIGN  19310>>IF      19317>>IF
     19319>>ASSIGN  19323>>ASSIGN  19324>>ASSIGN  19743>>IF      19746>>ASSIGN  19749>>IF      19754>>ASSIGN
P2$
     18994**DCL     19323<<ASSIGN  19325>>IF      19746<<ASSIGN  19754<<ASSIGN  19757>>CALLBLT 19757>>CALLBLT
     19758>>IF      19762>>ASSIGN
P3$
     18995**DCL     19319<<ASSIGN  19324<<ASSIGN  19330>>CALLBLT 19330>>CALLBLT 19331>>IF      19334>>IF
     19336>>CALLBLT 19336>>CALLBLT 19340>>CALLBLT 19340>>CALLBLT 19762<<ASSIGN  19763>>IF      19765>>CALLBLT
     19765>>CALLBLT 19769>>CALLBLT 19769>>CALLBLT
PROJ_KEY.TEXT
     15923**DCL     15923--REDEF
PROJ_KEY.TXT.PROJECT
     15923**DCL     15923--REDEF
P_PCB
     16078**DCL     19035<>CALL
P_PCB.ERROR
     16182**DCL     19276<>CALL
P_PCB.NCHARS
     16225**DCL     19034<<ASSIGN
P_PCB.OUT$
     16091**DCL     19036>>ASSIGN
P_PCB.ROOT$
     16083**DCL     19017<<ASSIGN  19031<<ASSIGN  19046<<ASSIGN
READ_ERR IN PROCEDURE ACHARGE
     19830**LABEL   19824--CALLALT
REMEM_VAR
     16049**DCL     16049--REDEF   19024<<REMEMBR
REM_FCMD
     16049**DCL     16050--REDEF
SIGN
     18996**DCL     19318<<ASSIGN  19326<<ASSIGN  19327<<ASSIGN  19344>>IF      19345>>ASSIGN  19347>>IF
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:97   
     19391>>IF      19414>>IF      19416>>IF      19419>>ASSIGN  19745<<ASSIGN  19751<<ASSIGN  19753<<ASSIGN
     19773>>IF      19817>>ASSIGN
SUBNODES
     18990**DCL     19037<<ASSIGN  19038>>DOINDEX
SUB_CODE
     18997**DCL     19069<<ASSIGN  19071<<ASSIGN  19072>>IF      19110<<ASSIGN  19112<<ASSIGN  19113>>IF
     19151<<ASSIGN  19153<<ASSIGN  19154>>IF      19192<<ASSIGN  19194<<ASSIGN  19195>>IF      19233<<ASSIGN
     19235<<ASSIGN  19236>>IF
SUPERAUTH
     16044**DCL     19720>>IF
TEXTC
     19006**DCL     19084>>ASSIGN  19125>>ASSIGN  19166>>ASSIGN  19207>>ASSIGN  19248>>ASSIGN  19455>>ASSIGN
UBIN_VAL IN PROCEDURE ACHARGE
     19526**DCL     19772>>IF
USERS_KEY
     15920**DCL     19822<<ASSIGN  19830<>CALL
USERS_KEY.TEXT
     15920**DCL     15921--REDEF   15921--REDEF   15921--REDEF   15922--REDEF
USERS_REC IN PROCEDURE ACHARGE
     19541**DCL     19820<<ASSIGN  19824<>CALL    19826<>CALL
USERS_REC.BANNER_PERM IN PROCEDURE ACHARGE
     19656**DCL     19657--REDEF
USERS_REC.BUDGET.ACCUM IN PROCEDURE ACHARGE
     19551**DCL     19825<<ASSIGN  19825>>ASSIGN
USERS_REC.BUDGET.MACCT IN PROCEDURE ACHARGE
     19561**DCL     19565--REDEF   19821>>DOWHILE 19822>>ASSIGN
USERS_REC.BUDGET.MAX_PROJECTS IN PROCEDURE ACHARGE
     19574**DCL     19577--REDEF
USERS_REC.BUDGET.PACCUM IN PROCEDURE ACHARGE
     19557**DCL     19559--REDEF
USERS_REC.BUDGET.PCHARGES IN PROCEDURE ACHARGE
     19570**DCL     19821>>DOWHILE
USERS_REC.BUDGET.PMAXC IN PROCEDURE ACHARGE
     19552**DCL     19554--REDEF
USERS_REC.SETUP_CHRA.TXT IN PROCEDURE ACHARGE
     19672**DCL     19673--REDEF   19674--REDEF
PL6.E3A0      #001=ASC$BUDGET File=ASC$BUDGET.:E05TSI                            TUE 07/29/97 09:30 Page:98   
VAL IN PROCEDURE ACHARGE
     19525**DCL     19526--REDEF   19771<<ASSIGN  19817<<ASSIGN  19817>>ASSIGN  19818>>ASSIGN  19819>>ASSIGN
VAL IN PROCEDURE MCHARGE
     19298**DCL     19342<<ASSIGN  19343>>ASSIGN  19345>>ASSIGN  19346>>IF      19415>>ASSIGN  19417>>ASSIGN
     19419<<ASSIGN  19419>>ASSIGN  19420>>IF      19421>>ASSIGN
VALUE
     18998**DCL     19330<<CALLBLT 19332<<ASSIGN  19336<<CALLBLT 19337<<ASSIGN  19337>>ASSIGN  19340<<CALLBLT
     19342>>ASSIGN  19342>>ASSIGN  19456<<ASSIGN  19457<<ASSIGN  19474<>CALL    19482<>CALL    19757<<CALLBLT
     19760<<ASSIGN  19765<<CALLBLT 19766<<ASSIGN  19766>>ASSIGN  19769<<CALLBLT 19771>>ASSIGN  19771>>ASSIGN
VARY$STR.CNT
     18909**DCL     18910--IMP-SIZ 19330>>CALLBLT 19334>>IF      19336>>CALLBLT 19340>>CALLBLT 19757>>CALLBLT
     19763>>IF      19765>>CALLBLT 19769>>CALLBLT
VARY$STR.TEXT
     18910**DCL     19330>>CALLBLT 19336>>CALLBLT 19340>>CALLBLT 19757>>CALLBLT 19765>>CALLBLT 19769>>CALLBLT
X$PARSE
     18963**DCL-ENT 19035--CALL
