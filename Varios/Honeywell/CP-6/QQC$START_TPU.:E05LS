VERSION E05

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:1    
        1        1        /*M* QQC$START_TPU - Start a new TP user */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQC$START_TPU
        9        9
       10       10             PURPOSE:     To start a new TP user
       11       11        */
       12       12        /*D* NAME:        QQC$START_TPU
       13       13
       14       14             CALL:        CALL QQC$START_TPU(MSGTYP,ERR,NOW_FLAG,TIMEOUT)
       15       15
       16       16             INPUT:       MSGTYP - If this TPU is to be a permanent TPU i.e.,
       17       17                                   it will always process transactions of a
       18       18                                   given type then MSGTYP is the name of
       19       19                                   the transaction that it will process.
       20       20                                   Blanks must be passed down for MSGTYP
       21       21                                   for the TPU to be started and be able
       22       22                                   to process any transaction.
       23       23
       24       24                          ERR    - Error returned to calling routine as the
       25       25                                   result of either CONTROL limit for TPUs in
       26       26                                   this instance being exceeded or a problem
       27       27                                   doing an M$GJOB PMME.
       28       28
       29       29                          NOW_FLAG - Indicates that this TPU is to be started
       30       30                                   immediately  (ie dont hang on the read).
       31       31
       32       32                          TIMEOUT - Indicates that this TPU is to be started
       33       33                                   with TIMEOUT set (note 0 is passed if no
       34       34                                   TIMEOUT specified on the TRANS command --
       35       35                                   the default).
       36       36
       37       37             INTERFACE:   QQC$GET_BLK
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:2    
       38       38                          QQC$BLDMSG
       39       39                          QQC$SCREECH
       40       40
       41       41             DESCRIPTION: This routine starts a new TPU to process
       42       42                          transactions with an M$GJOB PMME.  Before the PMME
       43       43                          can be issued two things have to be done.  First,
       44       44                          the CCBUF of the new TPU must be built.  The
       45       45                          TPU's CCBUF will contain the following:
       46       46
       47       47                             1) Fid of the TRADER file
       48       48                             2) Accounting flag do/don't do processor
       49       49                                accounting at step time
       50       50                             3) Testmode flag this instance is/isn't a
       51       51                                TESTMODE instance.
       52       52                             4) MSGTYP if this is a permanent TPU then this
       53       53                                will be the name of the transaction that it
       54       54                                will process.
       55       55
       56       56                          Second, a TPU information block must be built
       57       57                          so we can keep track of all the TPU's that are
       58       58                          running for us.  The TPU information block will
       59       59                          constain the following:
       60       60
       61       61                             1) UTS at M$GJOB time
       62       62                             2) Sysid of the TPU
       63       63                             3) TPU number i.e., 1 for TPCP0001
       64       64                             4) MSGTYP
       65       65                             5) TIMEOUT
       66       66
       67       67                          When everything has been set up an M$GJOB is
       68       68                          issued.
       69       69        */
       70       70        %EJECT;
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:3    
       71       71        QQC$START_TPU:
       72       72                PROC(P_MSGTYP,P_ERR,P_NOW_FLAG,TIMEOUT) ALTRET;
       73       73
       74       74        %INCLUDE Q_PAGE_C;
       75      106        %SET LISTEXP = '1'B;
       76      107        %PAGE(ARG="Includes");

               124        /***************************************************************************
               125         *                                                                         *
               126         *                                  Includes                               *
               127         *                                                                         *
               128         ***************************************************************************/

       77      132        %INCLUDE CP_6;
       78      213        %INCLUDE B_ERRORS_C;
       79     1340        %INCLUDE PC_MACRO_C;
       80     1366        %INCLUDE QQ_MACROS_C;
       81     1791        %INCLUDE QQ_PERR_C;
       82     1952        %INCLUDE Q_ERRCODE_C;
       83     1975        %INCLUDE QQ_DATA_R;
       84     2221        %PAGE(ARG="Parameters");

              2238    1   /***************************************************************************
              2239    1    *                                                                         *
              2240    1    *                                 Parameters                              *
              2241    1    *                                                                         *
              2242    1    ***************************************************************************/

       85     2246    1   DCL P_MSGTYP CHAR(8) ALIGNED;
       86     2247    1   DCL P_ERR BIT(36) ALIGNED;
       87     2248    1   DCL P_NOW_FLAG BIT(1) ALIGNED;
       88     2249    1   DCL TIMEOUT UBIN WORD ALIGNED;          /*  for EOFTIME in VLP_SETSTA         */
       89     2250        %PAGE(ARG="Externally defined routines");

              2267    1   /***************************************************************************
              2268    1    *                                                                         *
              2269    1    *                        Externally defined routines                      *
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:4    
              2270    1    *                                                                         *
              2271    1    ***************************************************************************/

       90     2275    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       91     2276    1   DCL QQC$RLS_BLK ENTRY(2);
       92     2277    1   DCL QQC$SCREECH ENTRY;
       93     2278        %PAGE(ARG="Symrefs");

              2295    1   /***************************************************************************
              2296    1    *                                                                         *
              2297    1    *                                  Symrefs                                *
              2298    1    *                                                                         *
              2299    1    ***************************************************************************/

       94     2303    1   DCL B$TCB$ PTR SYMREF;
       95     2304        %PAGE(ARG="Based");

              2321    1   /***************************************************************************
              2322    1    *                                                                         *
              2323    1    *                                   Based                                 *
              2324    1    *                                                                         *
              2325    1    ***************************************************************************/

       96     2329        %B$TCB;
       97     2332        %F$DCB;
       98     2389        %B$ALT;
       99     2397        %TPU$INFO;
      100     2426        %PC$INSTANCE(STCLASS="BASED(QQ_GLOBAL.PC$INSTANCE$)");
      101     2476
      102     2477    1   DCL BYTTE SBIN(9) UNAL BASED;
      103     2478    1   DCL WORRD SBIN(36) UNAL BASED;
      104     2479
      105     2480    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
      106     2481        %PAGE(ARG="Auto");

              2498    1   /***************************************************************************
              2499    1    *                                                                         *
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:5    
              2500    1    *                                    Auto                                 *
              2501    1    *                                                                         *
              2502    1    ***************************************************************************/

      107     2506    1   DCL P$ PTR;                             /* temp                               */
      108     2507    1   DCL TAIL$ PTR;                          /* ptr -> last TPU$INFO block         */
      109     2508
      110     2509    1   DCL CCBUF CHAR(80);                     /* B$JIT.CCBUF for the new TPU        */
      111     2510
      112     2511    1   DCL CHAR_STRING_SIZE UBIN WORD;
      113     2512    1   DCL CHAR_SYSID CHAR(7);
      114     2513
      115     2514        %MSGBLK;
      116     2604        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:6    
              2621    1   /***************************************************************************
              2622    1    *                                                                         *
              2623    1    *                                Error codes                              *
              2624    1    *                                                                         *
              2625    1    ***************************************************************************/

      117     2629        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
      118     2636        %ERRCODE(NAME=CODE_CLE, CODE#=%E$CLE, FCG#=%FCG_QQ, MID#=%MID_C);
      119     2643        /*E*       ERROR: QQC-E$CLE-C
      120     2644
      121     2645                 MESSAGE: CONTROL limit for TPUs in this instance of TP
      122     2646                          reached.  Unable to start any more TPUs.
      123     2647             DESCRIPTION: See the system manager and have him change
      124     2648                          the TPU limit with CONTROL.
      125     2649        */
      126     2650        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:7    
              2667    1   /***************************************************************************
              2668    1    *                                                                         *
              2669    1    *                                    FPTs                                 *
              2670    1    *                                                                         *
              2671    1    ***************************************************************************/

      127     2675        %FPT_GJOB(TPU=YES, RESULTS=VLR_GJOB);
      128     2692        %PAGE(ARG="VLRs");

              2709    1   /***************************************************************************
              2710    1    *                                                                         *
              2711    1    *                                    VLRs                                 *
              2712    1    *                                                                         *
              2713    1    ***************************************************************************/

      129     2717        %VLR_GJOB;
      130     2730        %PAGE(ARG="QQC$START_TPU", PAGE=YES);

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:8    
              2747    1   /***************************************************************************
              2748    1    *                                                                         *
              2749    1    *                               QQC$START_TPU                             *
              2750    1    *                                                                         *
              2751    1    ***************************************************************************/

      131     2755    1           IF QQ_GLOBAL.TPU_CNT >= PC$INSTANCE.MAXTPU THEN
      132     2756    2             DO;
      133     2757    2               P_ERR = CODE_CLE;
      134     2758    2               GOTO ALT;
      135     2759    2             END;
      136     2760
      137     2761    1           CCBUF = '!';
      138     2762    1           P$ = PINCRC(ADDR(CCBUF), 1);
      139     2763
      140     2764    1           CHAR_STRING_SIZE = QQ_GLOBAL.TPCP_RU.L#;
      141     2765    1           P$ -> CHAR$STRING = QQ_GLOBAL.TPCP_RU.NAME#;
      142     2766
      143     2767    1           P$ = PINCRC(P$, QQ_GLOBAL.TPCP_RU.L# + 1);
      144     2768    1           CHAR_STRING_SIZE = 1;
      145     2769    1           P$ -> CHAR$STRING = '(';
      146     2770
      147     2771    1           P$ = PINCRC(P$, 1);
      148     2772    1           CHAR_STRING_SIZE = 1 + QQ_GLOBAL.TRADER_FID.L# + SIZEC(F$DCB.PASS#);
      149     2773    1           P$ -> CHAR$STRING =
      150     2774    1               ADDR(QQ_GLOBAL.TRADER_FID) -> CHAR$STRING;
      151     2775
      152     2776    1           P$ = PINCRC(P$, CHAR_STRING_SIZE);
      153     2777    1           IF QQ_GLOBAL.ACCOUNTING THEN
      154     2778    2             DO;
      155     2779    2               P$ -> BYTTE = -1;
      156     2780    2             END;
      157     2781    1           ELSE
      158     2782    2             DO;
      159     2783    2               P$ -> BYTTE = 0;
      160     2784    2             END;
      161     2785
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:9    
      162     2786    1           P$ = PINCRC(P$, 1);
      163     2787    1           IF QQ_GLOBAL.TESTMODE THEN
      164     2788    2             DO;
      165     2789    2               P$ -> BYTTE = -1;
      166     2790    2             END;
      167     2791    1           ELSE
      168     2792    2             DO;
      169     2793    2               P$ -> BYTTE = 0;
      170     2794    2             END;
      171     2795
      172     2796    1           P$ = PINCRC(P$, 1);
      173     2797    1           CHAR_STRING_SIZE = 8;
      174     2798    1           P$ -> CHAR$STRING = P_MSGTYP;
      175     2799
      176     2800    1           P$ = PINCRC(P$,CHAR_STRING_SIZE);
      177     2801    1           IF P_NOW_FLAG THEN
      178     2802    2             DO;
      179     2803    2               P$ -> BYTTE = -1;
      180     2804    2             END;
      181     2805    1           ELSE
      182     2806    2             DO;
      183     2807    2               P$ -> BYTTE = 0;
      184     2808    2             END;
      185     2809
      186     2810    1           P$ = PINCRC(P$, 1);             /*  set starting point for TIMEOUT    */
      187     2811    1           P$ -> WORRD = TIMEOUT;
      188     2812    1           CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(TPU$INFO), T$) ALTRET(NO_MEM);
      189     2813
      190     2814    1           TPU$INFO.FLAGS = '0'B;
      191     2815    1           TPU$INFO.MSGTYP = P_MSGTYP;
      192     2816    1           TPU$INFO.FLAGS.TPU = '1'B;
      193     2817    1           TPU$INFO.TIMEOUT = TIMEOUT;     /* stick TIMEOUT in for DISPLAY       */
      194     2818
      195     2819    1           FPT_GJOB.CCBUF_ = VECTOR(CCBUF);
      196     2820    1           CALL M$GJOB(FPT_GJOB) ALTRET(GJOB_ERR);
      197     2821    1           TPU$INFO.SYSID = VLR_GJOB.SYSID;
      198     2822    1           CALL BINCHAR(CHAR_SYSID, VLR_GJOB.SYSID);
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:10   
      199     2823    1           CALL CONCAT(TPU$INFO.STATION, '&', CHAR_SYSID);
      200     2824    1           TAIL$ = QQ_GLOBAL.TPU$ -> TPU$INFO.BLINK$;
      201     2825    1           TPU$INFO.FLINK$ = TAIL$;
      202     2826    1           TPU$INFO.BLINK$ = TAIL$ -> TPU$INFO.BLINK$;
      203     2827    1           TAIL$ -> TPU$INFO.BLINK$ -> TPU$INFO.FLINK$ = T$;
      204     2828    1           TAIL$ -> TPU$INFO.BLINK$ = T$;
      205     2829    1           QQ_GLOBAL.TPU_CNT = QQ_GLOBAL.TPU_CNT + 1;
      206     2830    1           RETURN;
      207     2831
      208     2832    1   GJOB_ERR:
      209     2833    1           IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1126 /* E$NGHUSR */ AND
      210     2834    1               B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1131 /* E$NGAUTH */ AND
      211     2835    1               B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1125 /* E$NGHMEM */ THEN
      212     2836    2             DO;
      213     2837    2               GOTO MON_ERR;
      214     2838    2             END;
      215     2839
      216     2840    1           P_ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      217     2841    1           CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, T$);
      218     2842
      219     2843    1   ALT:
      220     2844    1           ALTRETURN;
      221     2845
      222     2846    1   NO_MEM:
      223     2847    1           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;
      224     2848    1           GOTO SCREECH;
      225     2849
      226     2850    1   MON_ERR:
      227     2851    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      228     2852
      229     2853    1   SCREECH:
      230     2854    1           CALL QQC$SCREECH;
      231     2855    1   END QQC$START_TPU;

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:11   
--  Include file information  --

   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$START_TPU.

   Procedure QQC$START_TPU requires 209 words for executable code.
   Procedure QQC$START_TPU requires 58 words of local(AUTO) storage.

    No errors detected in file QQC$START_TPU.:E05TSI    .

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:12   

 Object Unit name= QQC$START_TPU                              File name= QQC$START_TPU.:E05TOU
 UTS= JUL 30 '97 05:42:11.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      2      2  QQC$START_TPU
    2   Data  even  none    16     20  QQC$START_TPU
    3   Proc  even  none   209    321  QQC$START_TPU
    4  RoData even  none     7      7  QQC$START_TPU

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        4  QQC$START_TPU

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 QQC$GET_BLK
         yes           Std       2 QQC$RLS_BLK
         yes           Std       0 QQC$SCREECH
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_GLOBAL                             B$TCB$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:14   


        1        1        /*M* QQC$START_TPU - Start a new TP user */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        /*P* NAME:        QQC$START_TPU
        9        9
       10       10             PURPOSE:     To start a new TP user
       11       11        */
       12       12        /*D* NAME:        QQC$START_TPU
       13       13
       14       14             CALL:        CALL QQC$START_TPU(MSGTYP,ERR,NOW_FLAG,TIMEOUT)
       15       15
       16       16             INPUT:       MSGTYP - If this TPU is to be a permanent TPU i.e.,
       17       17                                   it will always process transactions of a
       18       18                                   given type then MSGTYP is the name of
       19       19                                   the transaction that it will process.
       20       20                                   Blanks must be passed down for MSGTYP
       21       21                                   for the TPU to be started and be able
       22       22                                   to process any transaction.
       23       23
       24       24                          ERR    - Error returned to calling routine as the
       25       25                                   result of either CONTROL limit for TPUs in
       26       26                                   this instance being exceeded or a problem
       27       27                                   doing an M$GJOB PMME.
       28       28
       29       29                          NOW_FLAG - Indicates that this TPU is to be started
       30       30                                   immediately  (ie dont hang on the read).
       31       31
       32       32                          TIMEOUT - Indicates that this TPU is to be started
       33       33                                   with TIMEOUT set (note 0 is passed if no
       34       34                                   TIMEOUT specified on the TRANS command --
       35       35                                   the default).
       36       36
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:15   
       37       37             INTERFACE:   QQC$GET_BLK
       38       38                          QQC$BLDMSG
       39       39                          QQC$SCREECH
       40       40
       41       41             DESCRIPTION: This routine starts a new TPU to process
       42       42                          transactions with an M$GJOB PMME.  Before the PMME
       43       43                          can be issued two things have to be done.  First,
       44       44                          the CCBUF of the new TPU must be built.  The
       45       45                          TPU's CCBUF will contain the following:
       46       46
       47       47                             1) Fid of the TRADER file
       48       48                             2) Accounting flag do/don't do processor
       49       49                                accounting at step time
       50       50                             3) Testmode flag this instance is/isn't a
       51       51                                TESTMODE instance.
       52       52                             4) MSGTYP if this is a permanent TPU then this
       53       53                                will be the name of the transaction that it
       54       54                                will process.
       55       55
       56       56                          Second, a TPU information block must be built
       57       57                          so we can keep track of all the TPU's that are
       58       58                          running for us.  The TPU information block will
       59       59                          constain the following:
       60       60
       61       61                             1) UTS at M$GJOB time
       62       62                             2) Sysid of the TPU
       63       63                             3) TPU number i.e., 1 for TPCP0001
       64       64                             4) MSGTYP
       65       65                             5) TIMEOUT
       66       66
       67       67                          When everything has been set up an M$GJOB is
       68       68                          issued.
       69       69        */
       70       70        %EJECT;
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:16   
       71       71        QQC$START_TPU:
       72       72                PROC(P_MSGTYP,P_ERR,P_NOW_FLAG,TIMEOUT) ALTRET;

     72  3 000000   000000 700200 xent  QQC$START_T* TSX0  ! X66_AUTO_4
         3 000001   000072 000004                    ZERO    58,4

       73       73
       74       74        %INCLUDE Q_PAGE_C;
       75      106        %SET LISTEXP = '1'B;
       76      107        %PAGE(ARG="Includes");

               124        /***************************************************************************
               125         *                                                                         *
               126         *                                  Includes                               *
               127         *                                                                         *
               128         ***************************************************************************/

       77      132        %INCLUDE CP_6;
       78      213        %INCLUDE B_ERRORS_C;
       79     1340        %INCLUDE PC_MACRO_C;
       80     1366        %INCLUDE QQ_MACROS_C;
       81     1791        %INCLUDE QQ_PERR_C;
       82     1952        %INCLUDE Q_ERRCODE_C;
       83     1975        %INCLUDE QQ_DATA_R;
       84     2221        %PAGE(ARG="Parameters");

              2238    1   /***************************************************************************
              2239    1    *                                                                         *
              2240    1    *                                 Parameters                              *
              2241    1    *                                                                         *
              2242    1    ***************************************************************************/

       85     2246    1   DCL P_MSGTYP CHAR(8) ALIGNED;
       86     2247    1   DCL P_ERR BIT(36) ALIGNED;
       87     2248    1   DCL P_NOW_FLAG BIT(1) ALIGNED;
       88     2249    1   DCL TIMEOUT UBIN WORD ALIGNED;          /*  for EOFTIME in VLP_SETSTA         */
       89     2250        %PAGE(ARG="Externally defined routines");
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:17   

              2267    1   /***************************************************************************
              2268    1    *                                                                         *
              2269    1    *                        Externally defined routines                      *
              2270    1    *                                                                         *
              2271    1    ***************************************************************************/

       90     2275    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       91     2276    1   DCL QQC$RLS_BLK ENTRY(2);
       92     2277    1   DCL QQC$SCREECH ENTRY;
       93     2278        %PAGE(ARG="Symrefs");

              2295    1   /***************************************************************************
              2296    1    *                                                                         *
              2297    1    *                                  Symrefs                                *
              2298    1    *                                                                         *
              2299    1    ***************************************************************************/

       94     2303    1   DCL B$TCB$ PTR SYMREF;
       95     2304        %PAGE(ARG="Based");

              2321    1   /***************************************************************************
              2322    1    *                                                                         *
              2323    1    *                                   Based                                 *
              2324    1    *                                                                         *
              2325    1    ***************************************************************************/

       96     2329        %B$TCB;
       97     2332        %F$DCB;
       98     2389        %B$ALT;
       99     2397        %TPU$INFO;
      100     2426        %PC$INSTANCE(STCLASS="BASED(QQ_GLOBAL.PC$INSTANCE$)");
      101     2476
      102     2477    1   DCL BYTTE SBIN(9) UNAL BASED;
      103     2478    1   DCL WORRD SBIN(36) UNAL BASED;
      104     2479
      105     2480    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:18   
      106     2481        %PAGE(ARG="Auto");

              2498    1   /***************************************************************************
              2499    1    *                                                                         *
              2500    1    *                                    Auto                                 *
              2501    1    *                                                                         *
              2502    1    ***************************************************************************/

      107     2506    1   DCL P$ PTR;                             /* temp                               */
      108     2507    1   DCL TAIL$ PTR;                          /* ptr -> last TPU$INFO block         */
      109     2508
      110     2509    1   DCL CCBUF CHAR(80);                     /* B$JIT.CCBUF for the new TPU        */
      111     2510
      112     2511    1   DCL CHAR_STRING_SIZE UBIN WORD;
      113     2512    1   DCL CHAR_SYSID CHAR(7);
      114     2513
      115     2514        %MSGBLK;
      116     2604        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:19   
              2621    1   /***************************************************************************
              2622    1    *                                                                         *
              2623    1    *                                Error codes                              *
              2624    1    *                                                                         *
              2625    1    ***************************************************************************/

      117     2629        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
      118     2636        %ERRCODE(NAME=CODE_CLE, CODE#=%E$CLE, FCG#=%FCG_QQ, MID#=%MID_C);
      119     2643        /*E*       ERROR: QQC-E$CLE-C
      120     2644
      121     2645                 MESSAGE: CONTROL limit for TPUs in this instance of TP
      122     2646                          reached.  Unable to start any more TPUs.
      123     2647             DESCRIPTION: See the system manager and have him change
      124     2648                          the TPU limit with CONTROL.
      125     2649        */
      126     2650        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:20   
              2667    1   /***************************************************************************
              2668    1    *                                                                         *
              2669    1    *                                    FPTs                                 *
              2670    1    *                                                                         *
              2671    1    ***************************************************************************/

      127     2675        %FPT_GJOB(TPU=YES, RESULTS=VLR_GJOB);
      128     2692        %PAGE(ARG="VLRs");

              2709    1   /***************************************************************************
              2710    1    *                                                                         *
              2711    1    *                                    VLRs                                 *
              2712    1    *                                                                         *
              2713    1    ***************************************************************************/

      129     2717        %VLR_GJOB;
      130     2730        %PAGE(ARG="QQC$START_TPU", PAGE=YES);

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:21   
              2747    1   /***************************************************************************
              2748    1    *                                                                         *
              2749    1    *                               QQC$START_TPU                             *
              2750    1    *                                                                         *
              2751    1    ***************************************************************************/

      131     2755    1           IF QQ_GLOBAL.TPU_CNT >= PC$INSTANCE.MAXTPU THEN

   2755  3 000002   000154 470400 xsym               LDP0    QQ_GLOBAL+108
         3 000003   000036 236000 xsym               LDQ     QQ_GLOBAL+30
         3 000004   000002 116100                    CMPQ    2,,PR0
         3 000005   000012 602000 3                  TNC     s:2761

      132     2756    2             DO;

      133     2757    2               P_ERR = CODE_CLE;

   2757  3 000006   000001 236000 1                  LDQ     CODE_CLE
         3 000007   200004 471500                    LDP1    @P_ERR,,AUTO
         3 000010   100000 756100                    STQ     0,,PR1

      134     2758    2               GOTO ALT;

   2758  3 000011   000307 710000 3                  TRA     ALT

      135     2759    2             END;
      136     2760
      137     2761    1           CCBUF = '!';

   2761  3 000012   040100 100400                    MLR     fill='040'O
         3 000013   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000014   200012 000120                    ADSC9   CCBUF,,AUTO              cn=0,n=80

      138     2762    1           P$ = PINCRC(ADDR(CCBUF), 1);

   2762  3 000015   200066 452500                    STP2    CHAR_SYSID+23,,AUTO
         3 000016   200066 236100                    LDQ     CHAR_SYSID+23,,AUTO
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:22   
         3 000017   000001 036000 4                  ADLQ    1
         3 000020   200010 756100                    STQ     P$,,AUTO

      139     2763
      140     2764    1           CHAR_STRING_SIZE = QQ_GLOBAL.TPCP_RU.L#;

   2764  3 000021   000354 236000 xsym               LDQ     QQ_GLOBAL+236
         3 000022   000033 772000                    QRL     27
         3 000023   200036 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      141     2765    1           P$ -> CHAR$STRING = QQ_GLOBAL.TPCP_RU.NAME#;

   2765  3 000024   200010 471500                    LDP1    P$,,AUTO
         3 000025   000000 620006                    EAX0    0,QL
         3 000026   040140 100400                    MLR     fill='040'O
         3 000027   000354 200013 xsym               ADSC9   QQ_GLOBAL+236            cn=1,n=11
         3 000030   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      142     2766
      143     2767    1           P$ = PINCRC(P$, QQ_GLOBAL.TPCP_RU.L# + 1);

   2767  3 000031   000354 236000 xsym               LDQ     QQ_GLOBAL+236
         3 000032   000033 772000                    QRL     27
         3 000033   000020 736000                    QLS     16
         3 000034   200000 036007                    ADLQ    65536,DL
         3 000035   200010 036100                    ADLQ    P$,,AUTO
         3 000036   200010 756100                    STQ     P$,,AUTO

      144     2768    1           CHAR_STRING_SIZE = 1;

   2768  3 000037   000001 235007                    LDA     1,DL
         3 000040   200036 755100                    STA     CHAR_STRING_SIZE,,AUTO

      145     2769    1           P$ -> CHAR$STRING = '(';

   2769  3 000041   200010 470500                    LDP0    P$,,AUTO
         3 000042   000000 620005                    EAX0    0,AL
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:23   
         3 000043   040140 100400                    MLR     fill='040'O
         3 000044   000002 000001 4                  ADSC9   2                        cn=0,n=1
         3 000045   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0

      146     2770
      147     2771    1           P$ = PINCRC(P$, 1);

   2771  3 000046   200000 036007                    ADLQ    65536,DL
         3 000047   200010 756100                    STQ     P$,,AUTO

      148     2772    1           CHAR_STRING_SIZE = 1 + QQ_GLOBAL.TRADER_FID.L# + SIZEC(F$DCB.PASS#);

   2772  3 000050   000327 236000 xsym               LDQ     QQ_GLOBAL+215
         3 000051   000033 772000                    QRL     27
         3 000052   000011 036007                    ADLQ    9,DL
         3 000053   200036 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      149     2773    1           P$ -> CHAR$STRING =

   2773  3 000054   000000 620006                    EAX0    0,QL
         3 000055   200010 470500                    LDP0    P$,,AUTO
         3 000056   200036 721100                    LXL1    CHAR_STRING_SIZE,,AUTO
         3 000057   040140 100440                    MLR     fill='040'O
         3 000060   000327 000010 xsym               ADSC9   QQ_GLOBAL+215            cn=0,n=*X0
         3 000061   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1

      150     2774    1               ADDR(QQ_GLOBAL.TRADER_FID) -> CHAR$STRING;
      151     2775
      152     2776    1           P$ = PINCRC(P$, CHAR_STRING_SIZE);

   2776  3 000062   200036 236100                    LDQ     CHAR_STRING_SIZE,,AUTO
         3 000063   000020 736000                    QLS     16
         3 000064   200010 036100                    ADLQ    P$,,AUTO
         3 000065   200010 756100                    STQ     P$,,AUTO

      153     2777    1           IF QQ_GLOBAL.ACCOUNTING THEN

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:24   
   2777  3 000066   000002 234000 xsym               SZN     QQ_GLOBAL+2
         3 000067   000075 605000 3                  TPL     s:2783

      154     2778    2             DO;

      155     2779    2               P$ -> BYTTE = -1;

   2779  3 000070   200010 470500                    LDP0    P$,,AUTO
         3 000071   003100 061400                    CSR     bolr='003'O
         3 000072   000027 000044 xsym               BDSC    B_VECTNIL+23             by=0,bit=0,n=36
         3 000073   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      156     2780    2             END;

   2780  3 000074   000101 710000 3                  TRA     s:2786

      157     2781    1           ELSE
      158     2782    2             DO;

      159     2783    2               P$ -> BYTTE = 0;

   2783  3 000075   200010 470500                    LDP0    P$,,AUTO
         3 000076   003100 061400                    CSR     bolr='003'O
         3 000077   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         3 000100   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      160     2784    2             END;

      161     2785
      162     2786    1           P$ = PINCRC(P$, 1);

   2786  3 000101   200000 036007                    ADLQ    65536,DL
         3 000102   200010 756100                    STQ     P$,,AUTO

      163     2787    1           IF QQ_GLOBAL.TESTMODE THEN

   2787  3 000103   000006 234000 xsym               SZN     QQ_GLOBAL+6
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:25   
         3 000104   000112 605000 3                  TPL     s:2793

      164     2788    2             DO;

      165     2789    2               P$ -> BYTTE = -1;

   2789  3 000105   200010 470500                    LDP0    P$,,AUTO
         3 000106   003100 061400                    CSR     bolr='003'O
         3 000107   000027 000044 xsym               BDSC    B_VECTNIL+23             by=0,bit=0,n=36
         3 000110   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      166     2790    2             END;

   2790  3 000111   000116 710000 3                  TRA     s:2796

      167     2791    1           ELSE
      168     2792    2             DO;

      169     2793    2               P$ -> BYTTE = 0;

   2793  3 000112   200010 470500                    LDP0    P$,,AUTO
         3 000113   003100 061400                    CSR     bolr='003'O
         3 000114   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         3 000115   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9

      170     2794    2             END;

      171     2795
      172     2796    1           P$ = PINCRC(P$, 1);

   2796  3 000116   200000 036007                    ADLQ    65536,DL
         3 000117   200010 756100                    STQ     P$,,AUTO

      173     2797    1           CHAR_STRING_SIZE = 8;

   2797  3 000120   000010 235007                    LDA     8,DL
         3 000121   200036 755100                    STA     CHAR_STRING_SIZE,,AUTO
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:26   

      174     2798    1           P$ -> CHAR$STRING = P_MSGTYP;

   2798  3 000122   200003 470500                    LDP0    @P_MSGTYP,,AUTO
         3 000123   200010 471500                    LDP1    P$,,AUTO
         3 000124   000000 620005                    EAX0    0,AL
         3 000125   040140 100500                    MLR     fill='040'O
         3 000126   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         3 000127   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      175     2799
      176     2800    1           P$ = PINCRC(P$,CHAR_STRING_SIZE);

   2800  3 000130   200036 236100                    LDQ     CHAR_STRING_SIZE,,AUTO
         3 000131   000020 736000                    QLS     16
         3 000132   200010 036100                    ADLQ    P$,,AUTO
         3 000133   200010 756100                    STQ     P$,,AUTO

      177     2801    1           IF P_NOW_FLAG THEN

   2801  3 000134   200005 471500                    LDP1    @P_NOW_FLAG,,AUTO
         3 000135   100000 234100                    SZN     0,,PR1
         3 000136   000144 605000 3                  TPL     s:2807

      178     2802    2             DO;

      179     2803    2               P$ -> BYTTE = -1;

   2803  3 000137   200010 473500                    LDP3    P$,,AUTO
         3 000140   003100 061400                    CSR     bolr='003'O
         3 000141   000027 000044 xsym               BDSC    B_VECTNIL+23             by=0,bit=0,n=36
         3 000142   300000 000011                    BDSC    0,,PR3                   by=0,bit=0,n=9

      180     2804    2             END;

   2804  3 000143   000150 710000 3                  TRA     s:2810

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:27   
      181     2805    1           ELSE
      182     2806    2             DO;

      183     2807    2               P$ -> BYTTE = 0;

   2807  3 000144   200010 473500                    LDP3    P$,,AUTO
         3 000145   003100 061400                    CSR     bolr='003'O
         3 000146   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         3 000147   300000 000011                    BDSC    0,,PR3                   by=0,bit=0,n=9

      184     2808    2             END;

      185     2809
      186     2810    1           P$ = PINCRC(P$, 1);             /*  set starting point for TIMEOUT    */

   2810  3 000150   200000 036007                    ADLQ    65536,DL
         3 000151   200010 756100                    STQ     P$,,AUTO

      187     2811    1           P$ -> WORRD = TIMEOUT;

   2811  3 000152   200006 473500                    LDP3    @TIMEOUT,,AUTO
         3 000153   200010 474500                    LDP4    P$,,AUTO
         3 000154   003100 060500                    CSL     bolr='003'O
         3 000155   300000 000044                    BDSC    0,,PR3                   by=0,bit=0,n=36
         3 000156   400000 000044                    BDSC    0,,PR4                   by=0,bit=0,n=36

      188     2812    1           CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, SIZEW(TPU$INFO), T$) ALTRET(NO_MEM);

   2812  3 000157   200007 635500                    EPPR5   T$,,AUTO
         3 000160   200070 455500                    STP5    CHAR_SYSID+25,,AUTO
         3 000161   000004 237000 4                  LDAQ    4
         3 000162   200066 757100                    STAQ    CHAR_SYSID+23,,AUTO
         3 000163   200066 630500                    EPPR0   CHAR_SYSID+23,,AUTO
         3 000164   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000165   000000 701000 xent               TSX1    QQC$GET_BLK
         3 000166   000310 702000 3                  TSX2    NO_MEM

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:28   
      189     2813
      190     2814    1           TPU$INFO.FLAGS = '0'B;

   2814  3 000167   200007 470500                    LDP0    T$,,AUTO
         3 000170   000003 236000 4                  LDQ     3
         3 000171   000011 356100                    ANSQ    9,,PR0

      191     2815    1           TPU$INFO.MSGTYP = P_MSGTYP;

   2815  3 000172   200003 471500                    LDP1    @P_MSGTYP,,AUTO
         3 000173   040100 100500                    MLR     fill='040'O
         3 000174   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         3 000175   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8

      192     2816    1           TPU$INFO.FLAGS.TPU = '1'B;

   2816  3 000176   200007 470500                    LDP0    T$,,AUTO
         3 000177   100000 236003                    LDQ     32768,DU
         3 000200   000011 256100                    ORSQ    9,,PR0

      193     2817    1           TPU$INFO.TIMEOUT = TIMEOUT;     /* stick TIMEOUT in for DISPLAY       */

   2817  3 000201   200006 473500                    LDP3    @TIMEOUT,,AUTO
         3 000202   300000 235100                    LDA     0,,PR3
         3 000203   000010 755100                    STA     8,,PR0

      194     2818
      195     2819    1           FPT_GJOB.CCBUF_ = VECTOR(CCBUF);

   2819  3 000204   000006 235000 4                  LDA     6
         3 000205   200066 452500                    STP2    CHAR_SYSID+23,,AUTO
         3 000206   200066 236100                    LDQ     CHAR_SYSID+23,,AUTO
         3 000207   000012 036003                    ADLQ    10,DU
         3 000210   000010 757000 2                  STAQ    FPT_GJOB+8

      196     2820    1           CALL M$GJOB(FPT_GJOB) ALTRET(GJOB_ERR);

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:29   
   2820  3 000211   000000 630400 2                  EPPR0   FPT_GJOB
         3 000212   420022 713400                    CLIMB   alt,+8210
         3 000213   402400 401760                    pmme    nvectors=6
         3 000214   000261 702000 3                  TSX2    GJOB_ERR

      197     2821    1           TPU$INFO.SYSID = VLR_GJOB.SYSID;

   2821  3 000215   000016 235000 2                  LDA     VLR_GJOB
         3 000216   000022 771000                    ARL     18
         3 000217   200007 470500                    LDP0    T$,,AUTO
         3 000220   000002 755100                    STA     2,,PR0

      198     2822    1           CALL BINCHAR(CHAR_SYSID, VLR_GJOB.SYSID);

   2822  3 000221   000016 235000 2                  LDA     VLR_GJOB
         3 000222   000022 771000                    ARL     18
         3 000223   000044 773000                    LRL     36
         3 000224   200066 757100                    STAQ    CHAR_SYSID+23,,AUTO
         3 000225   000100 301500                    BTD
         3 000226   200066 000010                    NDSC9   CHAR_SYSID+23,,AUTO      cn=0,s=lsgnf,sf=0,n=8
         3 000227   200037 030007                    NDSC9   CHAR_SYSID,,AUTO         cn=0,s=nosgn,sf=0,n=7

      199     2823    1           CALL CONCAT(TPU$INFO.STATION, '&', CHAR_SYSID);

   2823  3 000230   200007 470500                    LDP0    T$,,AUTO
         3 000231   046000 236003                    LDQ     19456,DU
         3 000232   000004 552140                    STBQ    4,'40'O,PR0
         3 000233   200007 470500                    LDP0    T$,,AUTO
         3 000234   040100 100500                    MLR     fill='040'O
         3 000235   200037 000007                    ADSC9   CHAR_SYSID,,AUTO         cn=0,n=7
         3 000236   000004 200007                    ADSC9   4,,PR0                   cn=1,n=7

      200     2824    1           TAIL$ = QQ_GLOBAL.TPU$ -> TPU$INFO.BLINK$;

   2824  3 000237   000155 470400 xsym               LDP0    QQ_GLOBAL+109
         3 000240   000000 236100                    LDQ     0,,PR0
         3 000241   200011 756100                    STQ     TAIL$,,AUTO
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:30   

      201     2825    1           TPU$INFO.FLINK$ = TAIL$;

   2825  3 000242   200007 471500                    LDP1    T$,,AUTO
         3 000243   100001 756100                    STQ     1,,PR1

      202     2826    1           TPU$INFO.BLINK$ = TAIL$ -> TPU$INFO.BLINK$;

   2826  3 000244   200011 470500                    LDP0    TAIL$,,AUTO
         3 000245   000000 236100                    LDQ     0,,PR0
         3 000246   200007 471500                    LDP1    T$,,AUTO
         3 000247   100000 756100                    STQ     0,,PR1

      203     2827    1           TAIL$ -> TPU$INFO.BLINK$ -> TPU$INFO.FLINK$ = T$;

   2827  3 000250   000000 471500                    LDP1    0,,PR0
         3 000251   200007 236100                    LDQ     T$,,AUTO
         3 000252   100001 756100                    STQ     1,,PR1

      204     2828    1           TAIL$ -> TPU$INFO.BLINK$ = T$;

   2828  3 000253   200007 236100                    LDQ     T$,,AUTO
         3 000254   000000 756100                    STQ     0,,PR0

      205     2829    1           QQ_GLOBAL.TPU_CNT = QQ_GLOBAL.TPU_CNT + 1;

   2829  3 000255   000036 235000 xsym               LDA     QQ_GLOBAL+30
         3 000256   000001 035007                    ADLA    1,DL
         3 000257   000036 755000 xsym               STA     QQ_GLOBAL+30

      206     2830    1           RETURN;

   2830  3 000260   000000 702200 xent               TSX2  ! X66_ARET

      207     2831
      208     2832    1   GJOB_ERR:
      209     2833    1           IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1126 /* E$NGHUSR */ AND
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:31   

   2833  3 000261   000000 470400 xsym  GJOB_ERR     LDP0    B$TCB$
         3 000262   000000 471500                    LDP1    0,,PR0
         3 000263   100102 236100                    LDQ     66,,PR1
         3 000264   377770 376007                    ANQ     131064,DL
         3 000265   021460 116007                    CMPQ    9008,DL
         3 000266   000274 600000 3                  TZE     s:2840
         3 000267   021530 116007                    CMPQ    9048,DL
         3 000270   000274 600000 3                  TZE     s:2840
         3 000271   021450 116007                    CMPQ    9000,DL
         3 000272   000274 600000 3                  TZE     s:2840

      210     2834    1               B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1131 /* E$NGAUTH */ AND
      211     2835    1               B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 1125 /* E$NGHMEM */ THEN
      212     2836    2             DO;

      213     2837    2               GOTO MON_ERR;

   2837  3 000273   000313 710000 3                  TRA     MON_ERR

      214     2838    2             END;
      215     2839
      216     2840    1           P_ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   2840  3 000274   100102 236100                    LDQ     66,,PR1
         3 000275   200004 473500                    LDP3    @P_ERR,,AUTO
         3 000276   300000 756100                    STQ     0,,PR3

      217     2841    1           CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, T$);

   2841  3 000277   200007 630500                    EPPR0   T$,,AUTO
         3 000300   200067 450500                    STP0    CHAR_SYSID+24,,AUTO
         3 000301   000004 236000 4                  LDQ     4
         3 000302   200066 756100                    STQ     CHAR_SYSID+23,,AUTO
         3 000303   200066 630500                    EPPR0   CHAR_SYSID+23,,AUTO
         3 000304   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000305   000000 701000 xent               TSX1    QQC$RLS_BLK
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:32   
         3 000306   000000 011000                    NOP     0

      218     2842
      219     2843    1   ALT:
      220     2844    1           ALTRETURN;

   2844  3 000307   000000 702200 xent  ALT          TSX2  ! X66_AALT

      221     2845
      222     2846    1   NO_MEM:
      223     2847    1           QQ_GLOBAL.ERR = CODE_NO_POOLMEM;

   2847  3 000310   000000 236000 1     NO_MEM       LDQ     CODE_NO_POOLMEM
         3 000311   000000 756000 xsym               STQ     QQ_GLOBAL

      224     2848    1           GOTO SCREECH;

   2848  3 000312   000315 710000 3                  TRA     SCREECH

      225     2849
      226     2850    1   MON_ERR:
      227     2851    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   2851  3 000313   100102 236100       MON_ERR      LDQ     66,,PR1
         3 000314   000000 756000 xsym               STQ     QQ_GLOBAL

      228     2852
      229     2853    1   SCREECH:
      230     2854    1           CALL QQC$SCREECH;

   2854  3 000315   000002 631400 xsym  SCREECH      EPPR1   B_VECTNIL+2
         3 000316   000000 701000 xent               TSX1    QQC$SCREECH
         3 000317   000000 011000                    NOP     0

      231     2855    1   END QQC$START_TPU;

   2855  3 000320   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:33   

PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:34   
--  Include file information  --

   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQC$START_TPU.
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:35   

 **** Variables and constants ****

  ****  Section 001 RoData QQC$START_TPU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/b STRC        r     1 CODE_CLE                   0-0-0/b STRC        r     1 CODE_NO_POOLMEM

  ****  Section 002  Data  QQC$START_TPU

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(504)   r     1 FPT_GJOB                  16-0-0/d STRC(72)    r     1 VLR_GJOB

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @P_ERR                     3-0-0/w PTR         r     1 @P_MSGTYP
     5-0-0/w PTR         r     1 @P_NOW_FLAG                6-0-0/w PTR         r     1 @TIMEOUT
    12-0-0/c CHAR(80)    r     1 CCBUF                     36-0-0/w UBIN        r     1 CHAR_STRING_SIZE
    37-0-0/c CHAR(7)     r     1 CHAR_SYSID                10-0-0/w PTR         r     1 P$
    *0-0-0/w BIT         r     1 P_ERR                     *0-0-0/w CHAR(8)     r     1 P_MSGTYP
    *0-0-0/w BIT         r     1 P_NOW_FLAG                 7-0-0/w PTR         r     1 T$
    11-0-0/w PTR         r     1 TAIL$                     *0-0-0/w UBIN        r     1 TIMEOUT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:36   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/b SBIN(9)     r     1 BYTTE                      0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(2700)  r     1 PC$INSTANCE
     0-0-0/w STRC(361)   r     1 TPU$INFO                   0-0-0/b SBIN        r     1 WORRD


   Procedure QQC$START_TPU requires 209 words for executable code.
   Procedure QQC$START_TPU requires 58 words of local(AUTO) storage.

    No errors detected in file QQC$START_TPU.:E05TSI    .
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:37   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:38   
          MINI XREF LISTING

ALT
      2844**LABEL    2758--GOTO
B$ALT.CODE
      2391**DCL      2391--REDEF    2392--REDEF    2392--REDEF
B$ALT.ERR
      2392**DCL      2840>>ASSIGN   2851>>ASSIGN
B$ALT.ERR.CODE
      2393**DCL      2833>>IF       2833>>IF       2833>>IF
B$ALT.ERR.ERR#
      2393**DCL      2393--REDEF
B$ALT.EVID
      2392**DCL      2392--REDEF    2392--REDEF
B$TCB.ALT$
      2330**DCL      2833>>IF       2833>>IF       2833>>IF       2840>>ASSIGN   2851>>ASSIGN
B$TCB$
      2303**DCL      2833>>IF       2833>>IF       2833>>IF       2840>>ASSIGN   2851>>ASSIGN
BYTTE
      2477**DCL      2779<<ASSIGN   2783<<ASSIGN   2789<<ASSIGN   2793<<ASSIGN   2803<<ASSIGN   2807<<ASSIGN
CCBUF
      2509**DCL      2761<<ASSIGN   2762--ASSIGN   2819--ASSIGN
CHAR$STRING
      2480**DCL      2765<<ASSIGN   2769<<ASSIGN   2773<<ASSIGN   2773>>ASSIGN   2798<<ASSIGN
CHAR_STRING_SIZE
      2511**DCL      2480--IMP-SIZ  2764<<ASSIGN   2765>>ASSIGN   2768<<ASSIGN   2769>>ASSIGN   2772<<ASSIGN
      2773>>ASSIGN   2773>>ASSIGN   2776>>ASSIGN   2797<<ASSIGN   2798>>ASSIGN   2800>>ASSIGN
CHAR_SYSID
      2512**DCL      2822<<CALLBLT  2823>>CALLBLT
CODE_CLE
      2637**DCL      2757>>ASSIGN
CODE_NO_POOLMEM
      2630**DCL      2847>>ASSIGN
F$DCB.ACTPOS
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:39   
      2365**DCL      2365--REDEF
F$DCB.ARS#
      2339**DCL      2339--REDEF
F$DCB.ATTR
      2358**DCL      2359--REDEF
F$DCB.BORROW
      2373**DCL      2373--REDEF    2373--REDEF    2373--REDEF
F$DCB.DCBNAME.L
      2387**DCL      2387--IMP-SIZ
F$DCB.EOMCHAR#
      2343**DCL      2343--REDEF
F$DCB.FLDID
      2368**DCL      2368--REDEF
F$DCB.FORM$
      2362**DCL      2362--REDEF
F$DCB.FSECT
      2378**DCL      2378--REDEF
F$DCB.FSN#
      2355**DCL      2355--REDEF    2355--REDEF    2356--REDEF
F$DCB.HEADER$
      2361**DCL      2361--REDEF
F$DCB.IXTNSIZE#
      2359**DCL      2359--REDEF
F$DCB.LASTSTA$
      2348**DCL      2348--REDEF
F$DCB.LVL
      2374**DCL      2374--REDEF
F$DCB.NAME#.C
      2349**DCL      2349--REDEF
F$DCB.NOEOF
      2371**DCL      2371--REDEF
F$DCB.NRECS#
      2360**DCL      2360--REDEF
F$DCB.NRECX
      2379**DCL      2379--REDEF
F$DCB.OHDR
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:40   
      2371**DCL      2371--REDEF
F$DCB.ORG#
      2354**DCL      2354--REDEF
F$DCB.PASS#
      2349**DCL      2772--ASSIGN
F$DCB.PRECNO
      2377**DCL      2377--REDEF
F$DCB.RCSZ
      2383**DCL      2383--REDEF
F$DCB.RES#
      2350**DCL      2350--REDEF
F$DCB.SETX
      2362**DCL      2362--REDEF
F$DCB.TAB$
      2362**DCL      2362--REDEF
F$DCB.TDA
      2376**DCL      2377--REDEF
F$DCB.WSN#
      2350**DCL      2350--REDEF
FPT_GJOB
      2686**DCL      2820<>CALL
FPT_GJOB.CCBUF_
      2687**DCL      2819<<ASSIGN
FPT_GJOB.V
      2688**DCL      2686--DCLINIT
GJOB_ERR
      2833**LABEL    2820--CALLALT
M$GJOB
       206**DCL-ENT  2820--CALL
MON_ERR
      2851**LABEL    2837--GOTO
NO_MEM
      2847**LABEL    2812--CALLALT
P$
      2506**DCL      2762<<ASSIGN   2765>>ASSIGN   2767<<ASSIGN   2767>>ASSIGN   2769>>ASSIGN   2771<<ASSIGN
      2771>>ASSIGN   2773>>ASSIGN   2776<<ASSIGN   2776>>ASSIGN   2779>>ASSIGN   2783>>ASSIGN   2786<<ASSIGN
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:41   
      2786>>ASSIGN   2789>>ASSIGN   2793>>ASSIGN   2796<<ASSIGN   2796>>ASSIGN   2798>>ASSIGN   2800<<ASSIGN
      2800>>ASSIGN   2803>>ASSIGN   2807>>ASSIGN   2810<<ASSIGN   2810>>ASSIGN   2811>>ASSIGN
PC$INSTANCE.MAXTPU
      2429**DCL      2755>>IF
P_ERR
      2247**DCL        71--PROC     2757<<ASSIGN   2840<<ASSIGN
P_MSGTYP
      2246**DCL        71--PROC     2798>>ASSIGN   2815>>ASSIGN
P_NOW_FLAG
      2248**DCL        71--PROC     2801>>IF
QQC$GET_BLK
      2275**DCL-ENT  2812--CALL
QQC$RLS_BLK
      2276**DCL-ENT  2841--CALL
QQC$SCREECH
      2277**DCL-ENT  2854--CALL
QQ_GLOBAL.ACCOUNTING
      1985**DCL      2777>>IF
QQ_GLOBAL.DS1$_BITS
      1995**DCL      1995--REDEF
QQ_GLOBAL.DS2$_BITS
      1995**DCL      1996--REDEF
QQ_GLOBAL.DS3$_BITS
      1996**DCL      1996--REDEF
QQ_GLOBAL.DS4$_BITS
      1996**DCL      1997--REDEF
QQ_GLOBAL.ERR
      1985**DCL      2847<<ASSIGN   2851<<ASSIGN
QQ_GLOBAL.PC$INSTANCE$
      1997**DCL      2427--IMP-PTR  2755>>IF
QQ_GLOBAL.POOL$
      1996**DCL      2812<>CALL     2841<>CALL
QQ_GLOBAL.TESTMODE
      1986**DCL      2787>>IF
QQ_GLOBAL.TPCP_RU.L#
      2072**DCL      2764>>ASSIGN   2767>>ASSIGN
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:42   
QQ_GLOBAL.TPCP_RU.NAME#
      2072**DCL      2765>>ASSIGN
QQ_GLOBAL.TPU$
      1997**DCL      2824>>ASSIGN
QQ_GLOBAL.TPU_CNT
      1990**DCL      2755>>IF       2829<<ASSIGN   2829>>ASSIGN
QQ_GLOBAL.TRADER_FID
      2072**DCL      2773--ASSIGN
QQ_GLOBAL.TRADER_FID.L#
      2072**DCL      2772>>ASSIGN
SCREECH
      2854**LABEL    2848--GOTO
T$
      2398**DCL      2399--IMP-PTR  2812<>CALL     2814>>ASSIGN   2815>>ASSIGN   2816>>ASSIGN   2817>>ASSIGN
      2821>>ASSIGN   2823>>CALLBLT  2825>>ASSIGN   2826>>ASSIGN   2827>>ASSIGN   2828>>ASSIGN   2841<>CALL
TAIL$
      2507**DCL      2824<<ASSIGN   2825>>ASSIGN   2826>>ASSIGN   2827>>ASSIGN   2828>>ASSIGN
TIMEOUT
      2249**DCL        71--PROC     2811>>ASSIGN   2817>>ASSIGN
TPU$INFO
      2399**DCL      2812--CALL
TPU$INFO.BLINK$
      2400**DCL      2824>>ASSIGN   2826<<ASSIGN   2826>>ASSIGN   2827>>ASSIGN   2828<<ASSIGN
TPU$INFO.FLAGS
      2414**DCL      2814<<ASSIGN
TPU$INFO.FLAGS.TPU
      2420**DCL      2816<<ASSIGN
TPU$INFO.FLINK$
      2402**DCL      2825<<ASSIGN   2827<<ASSIGN
TPU$INFO.MSGTYP
      2410**DCL      2815<<ASSIGN
TPU$INFO.STATION
      2408**DCL      2823<<CALLBLT
TPU$INFO.SYSID
      2404**DCL      2821<<ASSIGN
TPU$INFO.TIMEOUT
PL6.E3A0      #001=QQC$START_TPU File=QQC$START_TPU.:E05TSI                      WED 07/30/97 05:42 Page:43   
      2412**DCL      2817<<ASSIGN
VLR_GJOB
      2728**DCL      2688--DCLINIT
VLR_GJOB.SYSID
      2728**DCL      2821>>ASSIGN   2822>>CALLBLT
WORRD
      2478**DCL      2811<<ASSIGN
